System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///GeneralUtils-3880c2fd.js",["cc","./rollupPluginModLoBabelHelpers-0ce78aec.js"],(function(e){var t,n,r,a,i,o,s,l,u,c,d,p,h,v,f,m,g,y,b,_,w,E,k,C,S,x,T,L,A,P,R,D,I,N,O,M,B,F,U,V,G,H,j,K,J,W,q,Y,z;return{setters:[function(e){t=e.cclegacy,n=e.JsonAsset,r=e.Prefab,a=e.AnimationClip,i=e.ImageAsset,o=e.SpriteFrame,s=e.Font,l=e.assetManager,u=e.AudioClip,c=e.sp,d=e.ccenum,p=e.tween,h=e.Animation,v=e.find,f=e.UITransform,m=e.view,g=e.screen,y=e.math,b=e.game,_=e.isCCObject,w=e._decorator,E=e.Color,k=e.UIOpacity,C=e.Label,S=e.Sprite,x=e.Input,T=e.director,L=e.Director,A=e.sys,P=e.Component},function(e){R=e.g,D=e.h,I=e.f,N=e.c,O=e.i,M=e.j,B=e.l,F=e.a,U=e.b,V=e.n,G=e.m,H=e.o,j=e.e,K=e.p,J=e.q,W=e.k,q=e.r,Y=e._,z=e.d}],execute:function(){e("Y",bl),t._RF.push({},"244e9OHsmpDnpHQKeLzgiiX","GameEvents",void 0);var Q=e("G",{WIDGET_RESIZED:"widget-resized",VIEW_RESIZED:"view-resized",REQUEST_VIEW_RESIZE:"request-view-resize",PRELOAD_SCREEN:"preload-screen",LAYOUT_CHANGED:"layout-changed",GAMEPLAY_UPDATE_CONFIG:"gameplay-update-config",UPGRADE_DYNAMIC_ATLAS:"upgrade-dynamic-atlas",ASSET_QUALITY_CHANGE:"asset-quality-change",REQUEST_UPGRADE_ASSET:"request-upgrade-asset",CLEAR_HYBRID_FILE_CACHE:"clear-hybrid-file-cache",PRELOAD_LANGUAGE:"preload-language",CHOOSE_LANGUAGE:"choose-language",LOCALIZE_APPLIED:"localize-applied",ERROR_OPEN_SCREEN:"error-open-screen"});t._RF.pop(),t._RF.push({},"5c76fxO2ppOqYp4WNO+Kavm","GameWorld",void 0);var X=e("a",{Layout:{Portrait:"portrait",Landscape:"landscape"},DesignSize:{Portrait:{WIDTH:1080,HEIGHT:2164},Landscape:{WIDTH:2732,HEIGHT:2164},Resolution:2.88},AcceptPortraitRatio:600/900,PRIMARY_LAYOUT:"auto",FULL_PORTRAIT_SIZE:!0,FULL_LANDSCAPE_SIZE:!0});t._RF.pop(),t._RF.push({},"358fdIqjFdNzZGa95REWt2F","Ads",void 0);var Z=e("a4",{MAX_BOTTOM_BANNER_RATIO:1/6});t._RF.pop();e("E",!1);t._RF.push({},"27101Dr1C9IFq4Thv9mNLal","Locales",void 0);e("d",["en","ru","es","de","fr","pt","it","zh","id","ja","tr"]);var $=e("w",{en:"fonts/Gabarito.fnt",ru:"fonts/Gabarito.fnt",es:"fonts/Gabarito.fnt",de:"fonts/Gabarito.fnt",fr:"fonts/Gabarito.fnt",pt:"fonts/Gabarito.fnt",it:"fonts/Gabarito.fnt",zh:"fonts/Gabarito.fnt",id:"fonts/Gabarito.fnt",ja:"fonts/Gabarito.fnt",tr:"fonts/Gabarito.fnt"}),ee=e("v",{en:"fonts/Gabarito-VariableFont_wght.ttf",ru:"fonts/MYRIADPRO-REGULAR.ttf",es:"fonts/Gabarito-VariableFont_wght.ttf",de:"fonts/Gabarito-VariableFont_wght.ttf",fr:"fonts/Gabarito-VariableFont_wght.ttf",pt:"fonts/Gabarito-VariableFont_wght.ttf",it:"fonts/Gabarito-VariableFont_wght.ttf",zh:"fonts/Gabarito-VariableFont_wght.ttf",id:"fonts/Gabarito-VariableFont_wght.ttf",ja:"fonts/Gabarito-VariableFont_wght.ttf",tr:"fonts/Gabarito-VariableFont_wght.ttf"});e("L",{ru:"locales/ru",es:"locales/es",de:"locales/de",fr:"locales/fr",pt:"locales/pt",it:"locales/it",zh:"locales/zh",id:"locales/id",ja:"locales/ja",tr:"locales/tr"});t._RF.pop(),t._RF.push({},"d3c2a0dCmhOoKinH6/Rr9Tk","ResourceUtils",void 0);var te=Ludex.Utils,ne=te.Function,re=te.Time,ae=te.Device,ie=["loadable","animations"],oe=function(){var e=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.prev=2,t=ie.map((function(e){return se.loadBundle(e)})),e.next=6,Promise.all(t);case 6:e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),console.warn("ResourceUtils: initBundles failed",e.t0),e.next=13,re.sleepAsync(500);case 13:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}}(),se=e("R",function(){function e(){N(this,e),this.bundles={loadable:null,animations:null},this.loadedPrefabDictionary={}}var t,d,p,h,v,f,m,g,y,b,_,w,E,k,C,S,x;return I(e,[{key:"getBundleNameByType",value:function(e){switch(e){case a:return"animations";default:return"loadable"}}},{key:"loadBundleByType",value:(x=R(D().mark((function t(n){var r;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getBundleNameByType(n),t.abrupt("return",e.loadBundle(r));case 2:case"end":return t.stop()}}),t,this)}))),function(e){return x.apply(this,arguments)})},{key:"getBundleByType",value:function(e){var t,n=this.getBundleNameByType(e);return null!==(t=this.bundles[n])&&void 0!==t?t:null}},{key:"preloadAsset",value:(S=R(D().mark((function e(t,n,r){var a,i=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBundleByType(n);case 2:if(a=this.getBundleByType(n)){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",new Promise((function(e,o){a.preload(t,n,(function(a){if(a)return console.warn("Failed to preload asset at path: ".concat(t),a),void o(a);r?i.loadAssetAsync(t,n).finally(e):e()}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return S.apply(this,arguments)})},{key:"loadAssetAsync",value:(C=R(D().mark((function e(t,n){var r,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBundleByType(n);case 2:if(r=this.getBundleByType(n)){e.next=5;break}return e.abrupt("return",null);case 5:if(!(a=this.getAsset(t,n))){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new Promise((function(e,a){r.load(t,n,(function(n,r){r?e(r):(console.warn("[ResourceUtils] Failed to load asset at path: ".concat(t),n),a(null))}))})));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"loadAssetsAsync",value:(k=R(D().mark((function e(t,n){var r,a,i,o,s,l,u;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBundleByType(n);case 2:if(r=this.getBundleByType(n)){e.next=5;break}return e.abrupt("return",null);case 5:for(a=[],i=[],o=0,s=t.length;o<s;o++)l=t[o],(u=this.getAsset(l,n))?a.push({index:o,asset:u}):i.push({index:o,path:l});if(0!==i.length){e.next=10;break}return e.abrupt("return",Promise.resolve(a.map((function(e){return e.asset}))));case 10:return e.abrupt("return",new Promise((function(e){r.load(i.map((function(e){return e.path})),n,(function(t,n){if(t||n.length!==i.length)e(null);else{for(var r=0,o=n.length;r<o;r++){var s,l=n[r];if(l){var u=null===(s=i[r])||void 0===s?void 0:s.index;if(!u)return;a.splice(u,0,{index:u,asset:l})}}e(a.map((function(e){return e.asset})))}}))})));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"loadDirAsync",value:(E=R(D().mark((function e(t,n){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBundleByType(n);case 2:if(r=this.getBundleByType(n)){e.next=5;break}return e.abrupt("return",Promise.resolve([]));case 5:return e.abrupt("return",new Promise((function(e){r.loadDir(t,n,(function(n,r){r?e(r):(console.warn("Failed to load assets at path: ".concat(t),n),e([]))}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return E.apply(this,arguments)})},{key:"preloadDirAsync",value:(w=R(D().mark((function e(t,n,r){var a,i=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBundleByType(n);case 2:if(a=this.getBundleByType(n)){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",new Promise((function(e,o){a.preloadDir(t,n,(function(a){if(a)return console.warn("Failed to preload assets at path: ".concat(t),a),void o(a);r?i.loadDirAsync(t,n).finally(e):e()}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"getAsset",value:function(t,n){var r=this.getBundleByType(n);if(!r)return null;var a=e.getAssetInfo(t,n);return a?r.get(a.path,n):null}},{key:"loadFontAsync",value:function(e,t){var n=$[e];switch(t){case"fnt":n=$[e];break;case"ttf":n=ee[e]}var r=n.replace(/\.[^.]+$/,"");return this.loadAssetAsync(r,s)}},{key:"loadSpriteFramesAsync",value:(_=R(D().mark((function e(t){var n,r,a,i,s=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],e.next=3,this.loadAssetsAsync(t,o);case 3:if(r=e.sent){a=O(r);try{for(a.s();!(i=a.n()).done;)i.value.packable=n}catch(e){a.e(e)}finally{a.f()}}return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"loadBundle",value:(b=R(D().mark((function e(t){var n=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(!this.inst.bundles[t]){e.next=4;break}return e.abrupt("return",!0);case 4:if(!l.bundles.get(t)){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",new Promise((function(e,r){var a=setTimeout((function(){console.warn("[ResourceUtils] load bundle timeout (15s): ".concat(t)),r(!1)}),15e3);l.loadBundle(t,null,(function(i,o){clearTimeout(a);var s=n.inst.bundles[t];s||!i&&o?(n.inst.bundles[t]=null!=s?s:o,e(!0)):r(i)}))})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"loadAudioAsync",value:(y=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.inst.loadAssetAsync(t,u));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"loadJsonAsync",value:(g=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.inst.loadAssetAsync(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"isPrefabLoaded",value:function(e){return!!this.inst.loadedPrefabDictionary[e]}},{key:"getPrefab",value:function(e){return this.isPrefabLoaded(e)?this.inst.loadedPrefabDictionary[e]:null}},{key:"loadPrefabAsync",value:(m=R(D().mark((function e(t){var n,a,i=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],e.next=3,this.inst.loadAssetAsync(t,r);case 3:return(a=e.sent)&&n&&(this.inst.loadedPrefabDictionary[t]=a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"loadAnimClipAsync",value:(f=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.inst.loadAssetAsync(t,a));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"loadSkeletonDataAsync",value:(v=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.inst.loadAssetAsync(t,c.SkeletonData));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"loadImageSpriteFrameAsync",value:(h=R(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inst.loadAssetAsync(t,i);case 2:return n=e.sent,e.abrupt("return",n?o.createWithImage(n):null);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"loadSpriteFrameAsync",value:(p=R(D().mark((function e(t){var n,r,a=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.inst.loadAssetAsync(t,o);case 3:return(r=e.sent)&&(r.packable=n),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"loadSpriteFramesDirAsync",value:(d=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.inst.loadDirAsync(t,o));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"preloadJson",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,n,t)}},{key:"preloadPrefab",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,r,t)}},{key:"preloadAnimClip",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,a,t)}},{key:"preloadImageSpriteFrame",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,i,t)}},{key:"preloadSpriteFrame",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,o,t)}},{key:"preloadSpriteFramesDir",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadDirAsync(e,o,t)}},{key:"getAssetInfo",value:function(e,t){var n=this.inst.getBundleByType(t);return n?n.getInfoWithPath(e,t):null}},{key:"loadFontAsync",value:function(e,t){return this.inst.loadFontAsync(e,t)}},{key:"loadSpriteFramesAsync",value:(t=R(D().mark((function e(t){var n,r=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],e.abrupt("return",this.inst.loadSpriteFramesAsync(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getImageScale",value:function(){var e=ae.pixelRatio();return e=e>2.5?3:e>1.5?2:1}}]),e}());ne.retryAsync(oe,oe),t._RF.pop(),t._RF.push({},"ddc38QKdbBJopxEXU4f64/0","LevelManager",void 0);var le=Ludex.Utils.Time,ue="levels-compress/",ce=3120,de=!1,pe=3,he=2e3,ve=30,fe=!0,me=e("i",function(){function e(){N(this,e),this.level=1,this.maxLevel=1,this.promisePreloadLevel={},this.loadedLevel={},this.stepLevel=ve,this.tryCount=0,this.levelStartTimes=0,this.seedsByLevel={}}var t,n,r,a,i,o;return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"init",value:function(){var e,t,n=null!==(e=null===(t=codex.player.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1;this.setLevel(n),this.setMaxLevel(n)}},{key:"getLevel",value:function(){return this.inst.level}},{key:"getMaxLevel",value:function(){return this.inst.maxLevel}},{key:"getPlayerLevel",value:function(){var e,t;return null!==(e=null===(t=codex.player.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1}},{key:"getStepLevel",value:function(){return this.inst.stepLevel}},{key:"increaseTryCount",value:function(){this.inst.tryCount+=1}},{key:"getTryCount",value:function(){return this.inst.tryCount}},{key:"resetTryCount",value:function(){this.inst.tryCount=0}},{key:"getLevelStartTimes",value:function(){return this.inst.levelStartTimes}},{key:"increaseLevelStartTimes",value:function(){this.inst.levelStartTimes+=1}},{key:"setLevel",value:function(e){this.inst.level=e,this.resetTryCount()}},{key:"setMaxLevel",value:function(e){this.inst.maxLevel=e,codex.player.setGameData({level:this.inst.maxLevel})}},{key:"nextLevel",value:function(){var e=this.getLevel();this.setLevel(e+1),this.setMaxLevel(e+1),this.preloadCurrentLevel()}},{key:"preloadCurrentLevel",value:(o=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadLevelDataAsync(this.getLevel());case 2:return e.next=4,this.preloadLevelDataAsync(this.getLevel()+1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getKeyLevel",value:function(e){var t=this.getCorrectLoopLevel(e),n=Ludex.Utils.Number.padStart(t,6);return"level_".concat(n)}},{key:"getCurrentKeyLevel",value:function(){return this.getKeyLevel(this.getLevel())}},{key:"getLevelPath",value:function(e){var t=this.getCorrectLoopLevel(e),n=Math.floor((t-1)/this.inst.stepLevel),r=Ludex.Utils.Number.padStart(n*this.inst.stepLevel+1,6);return"level_".concat(r,"-").concat(this.inst.stepLevel)}},{key:"getCorrectLoopLevel",value:function(e){if(e>ce&&fe){return 121+(e-(ce+1))%(ce-121+1)}return e>ce?ce:e}},{key:"preloadLevelDataAsync",value:(i=R(D().mark((function e(t){var n,r,a,i,o,s,l,u,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t||this.getLevel(),r=this.getKeyLevel(n),a=this.getLevelPath(n),!(i=this.inst.loadedLevel[r])){e.next=7;break}return console.log("has loaded level",{currentLevel:n,levelKey:r,levelPath:a}),e.abrupt("return",i);case 7:return o=!Object.keys(this.inst.promisePreloadLevel).includes(a)||de,console.log("should preload level",a,o),o&&(this.inst.promisePreloadLevel[a]=this.preloadLevelWithRetry(n,pe,he)),e.next=12,this.inst.promisePreloadLevel[a];case 12:if(s=e.sent){e.next=17;break}delete this.inst.promisePreloadLevel[a],e.next=29;break;case 17:l=1;case 18:if(!(l<=s.length)){e.next=27;break}if(void 0!==(u=s[l-1])){e.next=22;break}return e.abrupt("continue",24);case 22:c=Math.floor((n-1)/this.inst.stepLevel)*this.inst.stepLevel+l,this.inst.loadedLevel[this.getKeyLevel(c)]=u;case 24:l++,e.next=18;break;case 27:return console.log("preload success",{levelKey:r}),e.abrupt("return",this.inst.loadedLevel[r]);case 29:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"preloadLevelWithRetry",value:(a=R(D().mark((function e(t){var n,r,a,i=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=i.length>2&&void 0!==i[2]?i[2]:2e3,!(n<0)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.preloadLevel(t);case 6:if(a=e.sent){e.next=11;break}return e.next=10,le.sleepAsync(r);case 10:return e.abrupt("return",this.preloadLevelWithRetry(t,n-1));case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"preloadLevel",value:(r=R(D().mark((function e(t){var n,r,a,i,o,s,l,u,c,d,p,h,v,f,m,g,y;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=this.getLevelPath(t),r="".concat(ue).concat(n),e.next=6,se.loadJsonAsync(r);case 6:if(a=e.sent){e.next=9;break}return e.abrupt("return");case 9:for(i=a.json,o=1;o<=i.length;o++)if(null!==i[o-1]){s=i[o-1],l=this.getKeyLevel(Math.floor((t-1)/this.inst.stepLevel)*this.inst.stepLevel+o),u=0,c=O(s.layers);try{for(c.s();!(d=c.n()).done;)p=d.value,u+=p.tiles.length}catch(e){c.e(e)}finally{c.f()}h=s.seeds,v=[],f=O(h);try{for(f.s();!(m=f.n()).done;)g=m.value,y=this.decodePacked(g,u),v.push(y)}catch(e){f.e(e)}finally{f.f()}this.inst.seedsByLevel[l]=v}return console.log("preloadLevel success",t),e.abrupt("return",i);case 15:return e.prev=15,e.t0=e.catch(0),e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(e){return r.apply(this,arguments)})},{key:"getLevelDataAsync",value:(n=R(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.preloadLevelDataAsync(t||this.getLevel());case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return n.apply(this,arguments)})},{key:"getLevelData",value:function(e){var t=this.getKeyLevel(e||this.getLevel());return this.inst.loadedLevel[t]}},{key:"getSeedByLevel",value:function(e){console.log("asasas Try count",this.getTryCount());var t=this.getKeyLevel(e||this.getLevel()),n=this.inst.seedsByLevel[t];if(n)return M(n[0])}},{key:"hasLevelData",value:function(e){var t=this.getKeyLevel(null!=e?e:this.getLevel());return void 0!==this.inst.loadedLevel[t]}},{key:"getBitLength",value:function(e){return Math.ceil(Math.log2(e))}},{key:"base64ToArray",value:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<e.length;r+=4){var a=t.indexOf(e.charAt(r)),i=t.indexOf(e.charAt(r+1)),o="="===e.charAt(r+2)?0:t.indexOf(e.charAt(r+2)),s=a<<2|i>>4,l=(15&i)<<4|o>>2,u=(3&o)<<6|("="===e.charAt(r+3)?0:t.indexOf(e.charAt(r+3)));n.push(s),"="!==e.charAt(r+2)&&n.push(l),"="!==e.charAt(r+3)&&n.push(u)}return n}},{key:"decodePacked",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this.getBitLength(n),a=this.base64ToArray(e),i=[],o=0,s=0;s<t;s++){for(var l=0,u=0;u<r;u++){var c=Math.floor(o/8),d=o%8,p=a[c]>>d&1;l|=p<<u,o++}i.push(l)}return i}},{key:"setCustomLevelData",value:(t=R(D().mark((function e(t,n){var r,a,i,o,s,l,u,c,d,p,h;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading custom level data..."),r=this.getKeyLevel(n||this.getLevel()),this.inst.loadedLevel[r]=t,a=0,i=O(t.layers);try{for(i.s();!(o=i.n()).done;)s=o.value,a+=s.tiles.length}catch(e){i.e(e)}finally{i.f()}l=t.seeds,u=[],c=O(l);try{for(c.s();!(d=c.n()).done;)p=d.value,h=this.decodePacked(p,a),u.push(h)}catch(e){c.e(e)}finally{c.f()}this.inst.seedsByLevel[r]=u;case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}());t._RF.pop(),t._RF.push({},"d159egaUVVLHKLg1UL865ub","SoundKeys",void 0);var ge=Ludex.Utils.Object,ye="sounds/",be=e("t",{BG_MUSIC:"".concat(ye,"bg-music"),BUTTON_CLICK:"".concat(ye,"button-click"),HAND_CLAP:"".concat(ye,"hand-clap"),LEVEL_FAIL:"".concat(ye,"level-fail"),LEVEL_PASS:"".concat(ye,"level-pass"),LOST_STAR_IN_GAMEPLAY:"".concat(ye,"lost-star-in-gameplay"),RAISE_STAR:"".concat(ye,"raise-star"),SPAWN_COINS:"".concat(ye,"spawn-coins"),STAR_RAISE:"".concat(ye,"star-raise"),TOUCH_START:"".concat(ye,"touch-start"),POPUP_SHOW:"".concat(ye,"popup-show"),POPUP_HIDE:"".concat(ye,"popup-off"),TILE_CLICK:"".concat(ye,"tile-click"),TILE_SHOW:"".concat(ye,"tile-show"),TILE_DESELECT:"".concat(ye,"tile-deselect"),TILE_MATCH_1:"".concat(ye,"tile-match-1"),TILE_MATCH_2:"".concat(ye,"tile-match-2"),TILE_MATCH_3:"".concat(ye,"tile-match-3"),TILE_MATCH_4:"".concat(ye,"tile-match-4"),TILE_MATCH_5:"".concat(ye,"tile-match-5"),ENCOURAGE_GOOD:"".concat(ye,"good"),ENCOURAGE_GREAT:"".concat(ye,"great"),ENCOURAGE_AMAZING:"".concat(ye,"amazing"),ENCOURAGE_AWESOME:"".concat(ye,"awesome"),USE_HINT:"".concat(ye,"use-hint"),USE_UNDO:"".concat(ye,"use-undo"),USE_SHUFFLE:"".concat(ye,"use-shuffle"),YOU_WIN:"".concat(ye,"you-win"),YOU_LOSE:"".concat(ye,"you-lose")}),_e=ge.vals(be),we=e("q",_e.reduce((function(e,t,n){return ge.assign(e,B({},t,n))}),{}));d(we);e("r",ge.invert(we));t._RF.pop(),t._RF.push({},"2113dSiFcdKCJK3F10MNHVP","AnimAbortSignalAdapter",void 0);var Ee=Ludex.Utils.Signal,ke=function(){function e(t){N(this,e),this.oldCallbacks=[],this.newCallbacks=[],this.signal=t}return I(e,[{key:"once",value:function(e){var t=this,n=function(){return e(new Error(t.signal.reason))};this.oldCallbacks.push(n),this.newCallbacks.push(e),this.signal.addAbortListener(n)}},{key:"off",value:function(e){var t=this.newCallbacks.indexOf(e);if(-1!==t){var n=this.oldCallbacks[t];this.signal.removeAbortListener(n),this.oldCallbacks.splice(t,1),this.newCallbacks.splice(t,1)}}},{key:"abort",value:function(e){var t=e instanceof Error?e.message:e;this.signal.abort(t)}},{key:"aborted",get:function(){return this.signal.aborted}},{key:"reason",get:function(){return"string"==typeof this.signal.reason?new Error(this.signal.reason):void 0}},{key:"wrap",value:function(e){if(!this.aborted)return e}},{key:"chain",value:function(e){var t=this;e instanceof Ee.Signal?e.once((function(){return t.abort()})):e.addEventListener("abort",(function(){return t.abort()}))}},{key:"promise",value:function(){var e=this;return this.aborted?Promise.resolve(this.reason):new Promise((function(t){e.once((function(e){return t(e)}))}))}}]),e}();t._RF.pop(),t._RF.push({},"c7c0e+0tjZA7aG6a9yUNytM","AnimUtils",void 0);var Ce=Ludex.Utils.Signal;function Se(e){return e instanceof Ce.Signal?e:new ke(e)}var xe,Te=e("u",function(){function e(){N(this,e)}return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"elasticOut",value:function(e,t,n){var r=t||.1,a=n||.1;if(0===e)return 0;if(1===e)return 1;var i=a/4;return r<1?r=1:i=a*Math.asin(1/t)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-i)*(2*Math.PI)/a)+1}},{key:"easeOutExpo",value:function(e){return 1===e?1:1-Math.pow(2,-10*e)}},{key:"easeInExpo",value:function(e){return 0===e?0:Math.pow(2,10*e-10)}},{key:"runTweenAsync",value:function(e,t){if(void 0===t)return new Promise((function(t){e.call((function(){return t({tween:e})})).start()}));var n=Se(t);return n.aborted?Promise.resolve({tween:e}):new Promise((function(t){var r=function(){e.stop(),t({tween:e})};n.once(r),e.call((function(){n.off(r),t({tween:e})})).start()}))}},{key:"runOnUpdateAsync",value:function(e,t,n,r){return new Promise((function(a,i){var o=p(e).to(t,{},{onUpdate:function(e,t){if(void 0!==t)try{n(t)}catch(e){i(e instanceof Error?e:new Error(String(e)))}}});if(void 0!==r){var s=Se(r);if(s.aborted)a({tween:o});else{var l=function(){o.stop(),a({tween:o})};s.once(l),o.call((function(){s.off(l),a({tween:o})})).start()}}else o.call((function(){return a({tween:o})})).start()}))}},{key:"waitTweenAsync",value:function(e,t){return new Promise((function(n){var r=p({}).delay(e);if(void 0!==t){var a=Se(t);if(a.aborted)n();else{var i=function(){r.stop(),n()};a.once(i),r.call((function(){a.off(i),n()})).start()}}else r.call((function(){return n()})).start()}))}},{key:"runAnimationAsync",value:function(e,t,n){if(void 0===n)return new Promise((function(n){e.once(h.EventType.FINISHED,n),e.play(t)}));var r=Se(n);return r.aborted?Promise.resolve():new Promise((function(n){var a=function(){e.stop(),n()};r.once(a),e.once(h.EventType.FINISHED,(function(){r.off(a),n()})),e.play(t)}))}}]),e}());t._RF.pop(),t._RF.push({},"31871PLRYRJu7yCCX5F6lWK","AudioUtils",void 0);var Le=Ludex.Utils,Ae=Le.Signal,Pe=Le.Device,Re=e("s",function(){function e(){N(this,e),this.signalController=new Ae.SignalController}var t,n,r,a,i;return I(e,[{key:"sound",get:function(){var e;return null===(e=v("Sound"))||void 0===e?void 0:e.getComponent("Sound")}},{key:"music",get:function(){var e;return null===(e=v("Music"))||void 0===e?void 0:e.getComponent("Music")}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"muteAudio",value:function(e){this.muteMusic(e),this.muteSound(e)}},{key:"playSound",value:(i=R(D().mark((function e(t,n){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.inst.sound)||void 0===r?void 0:r.play(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"pauseSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.pause(e)}},{key:"resumeSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.resume(e)}},{key:"stopSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.stop(e)}},{key:"stopAllSounds",value:function(){var e;null===(e=this.inst.sound)||void 0===e||e.stopAll()}},{key:"muteSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.mute(e)}},{key:"playMusic",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.inst.music&&(!e&&this.inst.music.playing(be.BG_MUSIC)||this.inst.music.play(be.BG_MUSIC))}},{key:"pauseMusic",value:function(){var e;null===(e=this.inst.music)||void 0===e||e.pause(be.BG_MUSIC)}},{key:"muteMusic",value:function(e){var t;null===(t=this.inst.music)||void 0===t||t.mute(e)}},{key:"turnUpMusic",value:(a=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null!==(t=null===(n=this.inst.music)||void 0===n?void 0:n.getVolume())&&void 0!==t?t:0)>.8)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.setVolumeMusic(.8,!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"turnDownMusic",value:(r=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null!==(t=null===(n=this.inst.music)||void 0===n?void 0:n.getVolume())&&void 0!==t?t:0)<.3)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.setVolumeMusic(.3,!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"turnOffMusic",value:(n=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setVolumeMusic(0);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getVolumeMusic",value:function(){var e,t;return null!==(e=null===(t=this.inst.music)||void 0===t?void 0:t.getVolume())&&void 0!==e?e:0}},{key:"setVolumeMusic",value:(t=R(D().mark((function e(t){var n,r,a,i,o,s=this,l=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]&&l[1],this.inst.music){e.next=3;break}return e.abrupt("return");case 3:if(r=this.inst.signalController.renew(),n){e.next=7;break}return null===(a=this.inst.music)||void 0===a||a.setVolume(t),e.abrupt("return");case 7:return i=this.inst.music.getVolume(),o=i,e.next=11,Te.runOnUpdateAsync(this.inst.music.node,1,(function(e){s.inst.music&&(o=i+(t-i)*e,s.inst.music.setVolume(o))}),r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"fixAudioForIOSOnFocus",value:function(){try{if(Pe.isIOS()){var e=document.getElementById("GameCanvas");if(!e)return;e.removeEventListener("mousedown",this.resetAudioContext),e.removeEventListener("touchstart",this.resetAudioContext),e.addEventListener("mousedown",this.resetAudioContext,{once:!0}),e.addEventListener("touchstart",this.resetAudioContext,{once:!0})}}catch(e){console.error("error",e)}}}]),e}());xe=Re,Re.resetAudioContext=R(D().mark((function e(){var t,n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=window.globalAudioContext)||void 0===t?void 0:t.suspend();case 3:return e.next=5,null===(n=window.globalAudioContext)||void 0===n?void 0:n.resume();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("error",e.t0);case 10:return e.prev=10,(r=document.getElementById("GameCanvas"))&&(r.removeEventListener("mousedown",xe.resetAudioContext),r.removeEventListener("touchstart",xe.resetAudioContext)),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[0,7,10,14]])}))),t._RF.pop(),t._RF.push({},"05faedSJ2NHFqLe9b3g4RIl","CocosUtils",void 0);var De,Ie,Ne=Ludex.Utils.Device,Oe=X.DesignSize.Resolution,Me=e("C",function(){function e(){N(this,e)}return I(e,[{key:"getBoundingBoxTo",value:function(e,t){var n=y.mat4();y.Mat4.fromSRT(n,t.getRotation(),t.getPosition(),t.getScale());var r=t.getComponent(f);if(!r)throw new Error("Node must have UITransform component");var a=r.anchorPoint,i=r.contentSize,o=i.width,s=i.height,l=new y.Rect(-a.x*o,-a.y*s,o,s),u=y.mat4();if(y.Mat4.multiply(u,e,n),l.transformMat4(u),!t.children||0===t.children.length)return l;var c,d=t.children,p=t.getWorldMatrix(),h=O(d);try{for(h.s();!(c=h.n()).done;){var v=c.value;if(null!=v&&v.active)if(v.getComponent(f)){var m=this.getBoundingBoxTo(p,v);m&&y.Rect.union(l,l,m)}}}catch(e){h.e(e)}finally{h.f()}return l}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"getBoundingBoxToWorld",value:function(e){if(e.parent){var t=e.parent.getWorldMatrix();return this.inst.getBoundingBoxTo(t,e)}var n=e.getComponent(f);if(!n)throw new Error("Node must have UITransform component");return n.getBoundingBox()}},{key:"worldSizeToCssSize",value:function(e){var t=Math.min(Ne.pixelRatio(),Oe);return Math.round(e*t)}},{key:"cssSizeToWorldSize",value:function(e){var t=m.getScaleX(),n=g.devicePixelRatio;return Math.round(e/t*n)}},{key:"getScreenWidthCss",value:function(){var e=document,t=e.body,n=e.documentElement,r=t.clientWidth,a=n.clientWidth;return Math.max(a,r)||0}},{key:"getScreenHeightCss",value:function(){var e=document,t=e.body,n=e.documentElement,r=t.clientHeight,a=n.clientHeight;return Math.max(a,r)||0}},{key:"getGameZoomCustom",value:function(){return this.cssSizeToWorldSize(1)}}]),e}());t._RF.pop(),t._RF.push({},"0eeb868JeVE67iFwhbkRCmE","ScreenKeys",void 0);var Be=e("l",function(e){return e[e.LOADING_SCREEN=1]="LOADING_SCREEN",e[e.SETTINGS_SCREEN=2]="SETTINGS_SCREEN",e[e.NOTIFICATION_SCREEN=3]="NOTIFICATION_SCREEN",e[e.LOSE_SCREEN=4]="LOSE_SCREEN",e[e.WINNING_SCREEN=5]="WINNING_SCREEN",e[e.CONGRATULATION_SCREEN=6]="CONGRATULATION_SCREEN",e[e.OPTIONS_SCREEN=7]="OPTIONS_SCREEN",e[e.FREE_ITEM_SCREEN=8]="FREE_ITEM_SCREEN",e[e.THEME_SCREEN=9]="THEME_SCREEN",e[e.SHOP_SCREEN=10]="SHOP_SCREEN",e[e.TOURNAMENT_POPUP_SCREEN=11]="TOURNAMENT_POPUP_SCREEN",e[e.TOURNAMENT_LEADERBOARD_SCREEN=12]="TOURNAMENT_LEADERBOARD_SCREEN",e[e.TOURNAMENT_INFO_SCREEN=13]="TOURNAMENT_INFO_SCREEN",e[e.ITEM_WARN_SCREEN=14]="ITEM_WARN_SCREEN",e[e.REWARD_SCREEN=15]="REWARD_SCREEN",e[e.CHALLENGE_FRIEND_COMPLETE_SCREEN=16]="CHALLENGE_FRIEND_COMPLETE_SCREEN",e[e.TOURNAMENT_COMPLETE_SCREEN=17]="TOURNAMENT_COMPLETE_SCREEN",e[e.LANGUAGES_SCREEN=18]="LANGUAGES_SCREEN",e[e.DAILY_QUEST_SCREEN=19]="DAILY_QUEST_SCREEN",e[e.DAILY_REWARD_SCREEN=20]="DAILY_REWARD_SCREEN",e[e.DAILY_CHALLENGE_SCREEN=21]="DAILY_CHALLENGE_SCREEN",e[e.BADGES_SCREEN=22]="BADGES_SCREEN",e[e.JOURNEY_LEVEL_SCREEN=23]="JOURNEY_LEVEL_SCREEN",e[e.JOURNEY_WINNING_SCREEN=24]="JOURNEY_WINNING_SCREEN",e[e.BADGE_REWARD_SCREEN=25]="BADGE_REWARD_SCREEN",e}(Be||{})),Fe=(e("a8",{NOTIFICATION_SCREEN:1001,LOADING_SCREEN:1e3,OTHERS_SCREEN:1}),e("m",(B(De={},Be.LOADING_SCREEN,"LoadingScreen"),B(De,Be.SETTINGS_SCREEN,"SettingsScreen"),B(De,Be.NOTIFICATION_SCREEN,"NotificationScreen"),B(De,Be.LOSE_SCREEN,"LoseScreen"),B(De,Be.WINNING_SCREEN,"WinningScreen"),B(De,Be.CONGRATULATION_SCREEN,"CongratulationScreen"),B(De,Be.OPTIONS_SCREEN,"OptionsScreen"),B(De,Be.FREE_ITEM_SCREEN,"FreeItemScreen"),B(De,Be.THEME_SCREEN,"ThemeScreen"),B(De,Be.SHOP_SCREEN,"ShopScreen"),B(De,Be.TOURNAMENT_POPUP_SCREEN,"TournamentPopupScreen"),B(De,Be.TOURNAMENT_LEADERBOARD_SCREEN,"TournamentLeaderboardScreen"),B(De,Be.TOURNAMENT_INFO_SCREEN,"TournamentInfoScreen"),B(De,Be.ITEM_WARN_SCREEN,"ItemWarnScreen"),B(De,Be.REWARD_SCREEN,"RewardScreen"),B(De,Be.CHALLENGE_FRIEND_COMPLETE_SCREEN,"ChallengeFriendCompleteScreen"),B(De,Be.TOURNAMENT_COMPLETE_SCREEN,"TournamentCompleteScreen"),B(De,Be.LANGUAGES_SCREEN,"LanguagesScreen"),B(De,Be.DAILY_QUEST_SCREEN,"DailyQuestScreen"),B(De,Be.DAILY_REWARD_SCREEN,"DailyRewardScreen"),B(De,Be.DAILY_CHALLENGE_SCREEN,"DailyChallengeScreen"),B(De,Be.BADGES_SCREEN,"BadgesScreen"),B(De,Be.JOURNEY_LEVEL_SCREEN,"JourneyLevelScreen"),B(De,Be.JOURNEY_WINNING_SCREEN,"JourneyWinningScreen"),B(De,Be.BADGE_REWARD_SCREEN,"BadgeRewardScreen"),De))),Ue=(B(Ie={},Fe[Be.LOADING_SCREEN],Be.LOADING_SCREEN),B(Ie,Fe[Be.SETTINGS_SCREEN],Be.SETTINGS_SCREEN),B(Ie,Fe[Be.NOTIFICATION_SCREEN],Be.NOTIFICATION_SCREEN),B(Ie,Fe[Be.LOSE_SCREEN],Be.LOSE_SCREEN),B(Ie,Fe[Be.WINNING_SCREEN],Be.WINNING_SCREEN),B(Ie,Fe[Be.CONGRATULATION_SCREEN],Be.CONGRATULATION_SCREEN),B(Ie,Fe[Be.OPTIONS_SCREEN],Be.OPTIONS_SCREEN),B(Ie,Fe[Be.FREE_ITEM_SCREEN],Be.FREE_ITEM_SCREEN),B(Ie,Fe[Be.THEME_SCREEN],Be.THEME_SCREEN),B(Ie,Fe[Be.SHOP_SCREEN],Be.SHOP_SCREEN),B(Ie,Fe[Be.TOURNAMENT_POPUP_SCREEN],Be.TOURNAMENT_POPUP_SCREEN),B(Ie,Fe[Be.TOURNAMENT_LEADERBOARD_SCREEN],Be.TOURNAMENT_LEADERBOARD_SCREEN),B(Ie,Fe[Be.TOURNAMENT_INFO_SCREEN],Be.TOURNAMENT_INFO_SCREEN),B(Ie,Fe[Be.REWARD_SCREEN],Be.REWARD_SCREEN),B(Ie,Fe[Be.ITEM_WARN_SCREEN],Be.ITEM_WARN_SCREEN),B(Ie,Fe[Be.CHALLENGE_FRIEND_COMPLETE_SCREEN],Be.CHALLENGE_FRIEND_COMPLETE_SCREEN),B(Ie,Fe[Be.TOURNAMENT_COMPLETE_SCREEN],Be.TOURNAMENT_COMPLETE_SCREEN),B(Ie,Fe[Be.LANGUAGES_SCREEN],Be.LANGUAGES_SCREEN),B(Ie,Fe[Be.DAILY_QUEST_SCREEN],Be.DAILY_QUEST_SCREEN),B(Ie,Fe[Be.DAILY_REWARD_SCREEN],Be.DAILY_REWARD_SCREEN),B(Ie,Fe[Be.DAILY_CHALLENGE_SCREEN],Be.DAILY_CHALLENGE_SCREEN),B(Ie,Fe[Be.BADGES_SCREEN],Be.BADGES_SCREEN),B(Ie,Fe[Be.JOURNEY_LEVEL_SCREEN],Be.JOURNEY_LEVEL_SCREEN),B(Ie,Fe[Be.JOURNEY_WINNING_SCREEN],Be.JOURNEY_WINNING_SCREEN),B(Ie,Fe[Be.BADGE_REWARD_SCREEN],Be.BADGE_REWARD_SCREEN),[Fe[Be.NOTIFICATION_SCREEN],Fe[Be.LOADING_SCREEN]]);t._RF.pop(),t._RF.push({},"a0dcdDZxhZImZ8Cfg4Dc7SJ","ScreenUtils",void 0);var Ve=codex.event,Ge=Ludex,He=Ge.Events,je=Ge.Utils.Array,Ke=e("S",function(){function e(){N(this,e),this.showedScreens=[],this.loadedScreens={}}var t,n;return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"preloadScreen",value:function(e){var t=Fe[e];t&&Ve.emit(Q.PRELOAD_SCREEN,{screenName:t})}},{key:"preloadScreens",value:function(){Ve.emit(He.PRELOAD_SCREENS)}},{key:"openScreen",value:function(e,t){var n=Fe[e];console.log("ScreenUtils: Opening screen:",n,t),Ve.emit(He.OPEN_SCREEN,{screenName:n,screenData:t})}},{key:"closeScreen",value:function(e,t){var n=Fe[e];console.log("ScreenUtils: Closing screen:",n,t),t?Ve.emit(He.CLOSE_SCREEN,{screenName:n,screenData:t}):Ve.emit(He.CLOSE_SCREEN,{screenName:n})}},{key:"openScreenAndWaitForClose",value:function(e,t){var n=this;return new Promise((function(r){n.openScreen(e,t);Ve.on(He.CLOSE_SCREEN,(function t(n){n.screenName===Fe[e]&&(Ve.off(He.CLOSE_SCREEN,t),r(n))}))}))}},{key:"openScreenAndWaitForClosed",value:function(e,t){var n=this;return new Promise((function(r){n.openScreen(e,t);Ve.on(He.CLOSED_SCREEN,(function t(n){n.screenName===Fe[e]&&(Ve.off(He.CLOSED_SCREEN,t),r(n))}))}))}},{key:"showLoadingScreen",value:function(e){this.isScreenLoaded(Fe[Be.LOADING_SCREEN])&&this.openScreen(Be.LOADING_SCREEN,{duration:e})}},{key:"closeLoadingScreen",value:function(){this.isScreenLoaded(Fe[Be.LOADING_SCREEN])&&this.closeScreen(Be.LOADING_SCREEN)}},{key:"showNotificationScreen",value:function(e,t){this.openScreen(Be.NOTIFICATION_SCREEN,{message:e,duration:t})}},{key:"closeNotificationScreen",value:function(){this.closeScreen(Be.NOTIFICATION_SCREEN)}},{key:"addShowedScene",value:function(e){je.has(this.inst.showedScreens,e)||this.inst.showedScreens.push(e)}},{key:"showLoadingFullScreen",value:(n=R(D().mark((function e(t){var n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!je.has(this.inst.showedScreens,t)){e.next=2;break}return e.abrupt("return");case 2:if(this.addShowedScene(t),n=v("Loading")){e.next=6;break}return e.abrupt("return");case 6:return n.active=!0,r=n.getComponent("Loading"),e.next=10,r.show(t);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"hideLoadingFullScreen",value:(t=R(D().mark((function e(t){var n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!je.has(this.inst.showedScreens,t)){e.next=2;break}return e.abrupt("return");case 2:return r=null===(n=v("Loading"))||void 0===n?void 0:n.getComponent("Loading"),e.next=5,null==r?void 0:r.hide(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"showLoadingNotificationScreen",value:function(){this.openScreen(Be.NOTIFICATION_SCREEN,{message:"Loading",enableCloseOnTouch:!1})}},{key:"isScreenLoaded",value:function(e){var t;return null!==(t=this.inst.loadedScreens[e])&&void 0!==t&&t}},{key:"markIsScreenLoaded",value:function(e){this.inst.loadedScreens[e]=!0}}]),e}());t._RF.pop(),t._RF.push({},"ba77cUVKIVES7OzU5CC+5pq","AdsUtils",void 0);var Je=Ludex,We=Je.Configs,qe=We.Ads,Ye=qe.Enabled,ze=qe.InterstitialAdOptions,Qe=qe.RewardedVideoAdOptions,Xe=qe.RewardedInterstitialAdOptions,Ze=qe.BannerDisplayAdOptions,$e=We.Gameplay.StartAdAtLevel,et=Je.Plugins.Ads,tt=et.Types,nt=et.Status,rt=Je.Utils,at=rt.Array,it=rt.Function,ot=codex,st=ot.ads,lt=ot.event,ut=function(e){F(n,e);var t=U(n);function n(e){return N(this,n),t.call(this,"AdsUtils.loadAdAsync: Timed out after ".concat(e,"ms"))}return I(n)}(V(Error)),ct=e("A",function(){function e(){N(this,e),this.isAvoidBannerShowed=!1,this.isInterstitialRemoved=!1}var t,n,r,a,i;return I(e,[{key:"getAdReady",value:function(e,t){if(Ye)if(t){if(st.getAdStatus(e,t)===nt.FILLED)return t}else{var n,r=st.getAdsByType(e),a=O(r);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.instance.status===nt.FILLED)return i.placementId}}catch(e){a.e(e)}finally{a.f()}}}},{key:"getPlacementIdByService",value:function(e,t){var n,r,a,i;if(!t)return!1;switch(e){case tt.BANNER:return(null===(n=at.search(Ze,(function(e){return e.AdService===t})))||void 0===n?void 0:n.PlacementId)||!1;case tt.INTERSTITIAL:return(null===(r=at.search(ze,(function(e){return e.AdService===t})))||void 0===r?void 0:r.PlacementId)||!1;case tt.REWARDED_VIDEO:return(null===(a=at.search(Qe,(function(e){return e.AdService===t})))||void 0===a?void 0:a.PlacementId)||!1;case tt.REWARDED_INTERSTITIAL:return(null===(i=at.search(Xe,(function(e){return e.AdService===t})))||void 0===i?void 0:i.PlacementId)||!1;default:return!1}}},{key:"getAdIdByPayload",value:function(e,t){var n=t||{},r=n.adService,a=n.placementId;return this.getPlacementIdByService(e,r)||a}},{key:"getAdErrorMessage",value:function(e,t){switch(e){case tt.REWARDED_VIDEO:case tt.REWARDED_INTERSTITIAL:return this.isUserCancelledAdError(t)?"noReward":"noAdsError";default:return null}}},{key:"showAdWithType",value:(i=R(D().mark((function t(n,r){var a,i,o,s,l,u,c,d,p,h,v,f,m,g;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(a=r||{}).placementId,o=a.includeSDK,s=a.excludeSDK,l=a.forceLoad,u=a.adService,c=a.timeout,d=void 0===c?5e3:c,this.canShowInSDK(o,s)){t.next=3;break}return t.abrupt("return",!1);case 3:if(p=this.getAdIdByPayload(n,r),h=!1,v=!1,t.prev=6,Re.muteAudio(!0),!l){t.next=15;break}return Ke.showLoadingScreen(),t.next=12,it.timeOut(st.loadAdAsync(n,p),d);case 12:if("timeout"!==(f=t.sent).status){t.next=15;break}throw new ut(f.duration);case 15:if(h){t.next=39;break}if(t.prev=16,m=this.getAdReady(n,p)){t.next=20;break}return t.abrupt("return",!1);case 20:return p=m,t.next=23,st.showAdAsync(n,p);case 23:h=!0,t.next=37;break;case 26:if(t.prev=26,t.t0=t.catch(16),!u){t.next=30;break}throw t.t0;case 30:if(!this.isUserCancelledAdError(t.t0)){t.next=32;break}throw t.t0;case 32:if(!this.isRequestAdTimeoutError(t.t0)){t.next=34;break}throw t.t0;case 34:p=void 0,h=!1,v=!0;case 37:t.next=15;break;case 39:return t.abrupt("return",!0);case 42:return t.prev=42,t.t1=t.catch(6),v=!0,(g=this.getAdErrorMessage(n,t.t1))&&Ke.showNotificationScreen(g,2),t.abrupt("return",!1);case 48:return t.prev=48,Re.muteAudio(!1),Re.fixAudioForIOSOnFocus(),l&&Ke.closeLoadingScreen(),v&&(p=i),e.preloadAdsByType(n,p),lt.emit(Q.REQUEST_VIEW_RESIZE),t.finish(48);case 56:case"end":return t.stop()}}),t,this,[[6,42,48,56],[16,26]])}))),function(e,t){return i.apply(this,arguments)})},{key:"canShowInSDK",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=GameSDK.getSDKName();return(null==t||!t.length||!at.has(t,n))&&!(null!=e&&e.length&&!at.has(e,n))}},{key:"isUserCancelledAdError",value:function(e){return e instanceof Object&&"code"in e&&"USER_INPUT"===e.code}},{key:"isRequestAdTimeoutError",value:function(e){return e instanceof ut||e instanceof Object&&"code"in e&&"SHOW_ADS_TIMEOUT"===e.code}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"preloadAds",value:(a=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.preloadAdsByType(tt.INTERSTITIAL),this.preloadAdsByType(tt.REWARDED_VIDEO);case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"isServiceDegraded",value:function(){return st.isServiceDegraded()}},{key:"preloadAdsByType",value:function(e,t){if(Ye){var n,r=st.getAdsByType(e),a=O(r);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(!t||i.placementId===t)i.instance.status===nt.FILLED||st.loadAdAsync(e,i.placementId).catch((function(){}))}}catch(e){a.e(e)}finally{a.f()}}}},{key:"setAvoidBannerShowed",value:function(e){this.inst.isAvoidBannerShowed=e}},{key:"showBannerAds",value:function(){var e=this;if(Ye&&(this.checkRemoveAdEndTime(),!this.inst.isAvoidBannerShowed)){var t=m.getVisibleSize(),n=Me.worldSizeToCssSize(t.height*Z.MAX_BOTTOM_BANNER_RATIO);Ze.forEach((function(t){var r=t.PlacementId,a=t.Position,i=t.BannerHeight;"bottom"===a&&i>n||e.showBannerAd(r)}))}}},{key:"hideBannerAds",value:function(){var e=this;Ye&&st.getAdsByType(tt.BANNER).forEach((function(t){t.instance.status!==nt.IDLE&&e.hideBannerAd(t.placementId)}))}},{key:"showBannerAd",value:function(e){this.inst.isAvoidBannerShowed||st.showBannerAdAsync(e).catch((function(e){}))}},{key:"hideBannerAd",value:function(e){st.hideBannerAdAsync(e).catch((function(e){}))}},{key:"isReadyAdShowable",value:function(e,t){var n=this.inst.getAdReady(e,t);return!!n&&st.canShowAd(e,n)}},{key:"showInterstitialAdAsync",value:(r=R(D().mark((function e(t){var n,r,a,i,o,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t||{}).forLevel,r=n.contextType,a=n.forceLoad,!($e>=me.getPlayerLevel())){e.next=3;break}return e.abrupt("return",!1);case 3:if(!this.inst.isInterstitialRemoved){e.next=5;break}return e.abrupt("return",!1);case 5:return r&&(null===(i=window.GoogleAds)||void 0===i||i.setInterstitialType(r),null===(o=window.TranssionH5Ads)||void 0===o||o.setInterstitialType(r)),s=a,"MsGames"===GameSDK.getSDKName()&&(s=!0),e.abrupt("return",this.inst.showAdWithType(tt.INTERSTITIAL,G(G({},t),{},{forceLoad:s})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"showRewardVideoAdAsync",value:(n=R(D().mark((function e(t){var n,r,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=(t||{}).contextType)&&(null===(r=window.GoogleAds)||void 0===r||r.setRewardType(n),null===(a=window.TranssionH5Ads)||void 0===a||a.setRewardType(n)),e.abrupt("return",this.inst.showAdWithType(tt.REWARDED_VIDEO,G(G({},t),{},{forceLoad:!0})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"showRewardedInterstitialAdAsync",value:(t=R(D().mark((function e(t){var n,r,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=(t||{}).contextType)&&(null===(r=window.GoogleAds)||void 0===r||r.setRewardType(n),null===(a=window.TranssionH5Ads)||void 0===a||a.setRewardType(n)),e.abrupt("return",this.inst.showAdWithType(tt.REWARDED_INTERSTITIAL,G(G({},t),{},{forceLoad:!0})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getBannerAdsHeight",value:function(){if(!Ye||this.isInterstitialRemoved())return 0;try{var e=Me.getGameZoomCustom();return st.getBannerHeight(Ludex.Configs.Ads.BannerDisplayAdOptions[0].PlacementId,e,!0)}catch(e){return 0}}},{key:"checkRemoveAdEndTime",value:function(){if(!this.inst.isInterstitialRemoved){var t=codex.player.getGameData().removeAdEndTime;if(t)t>Date.now()&&(e.setAvoidBannerShowed(!0),this.inst.isInterstitialRemoved=!0,e.hideBannerAds())}}},{key:"isInterstitialRemoved",value:function(){return this.inst.isInterstitialRemoved}},{key:"getRemoveAdDayLeft",value:function(){if(!this.inst.isInterstitialRemoved)return 0;var e=codex.player.getGameData().removeAdEndTime;if(!e||e<Date.now())return 0;var t=Date.now(),n=Math.ceil((e-t)/864e5);return n>0?n:1}}]),e}());t._RF.pop(),t._RF.push({},"32598ObpVZK/pecmWIdcs+7","SceneKeys",void 0);var dt=e("k",{TEST_SCENE:"TestScene",BOOT_SCENE:"BootScene",DASHBOARD_SCENE:"DashboardScene",GAME_SCENE:"GameScene",ENDLESS_SCENE:"EndlessScene",DRAFT_SCENE:"DraftScene",TEST_LAYOUT_SCENE:"TestLayoutScene",TEST_PERFORMANCE_SCENE:"TestPerformanceScene",TEST_PARTICLE_SYSTEM_SCENE:"TestParticleSystemScene",TEST_TEXT_PERFORMANCE_SCENE:"TestTextPerformanceScene"});t._RF.pop(),t._RF.push({},"97ca9J9nzNCeIjC1l+ZT/Hm","SceneUtils",void 0);var pt=codex.event,ht=Ludex.Events,vt=e("j",function(){function e(){N(this,e),this.loadedScenes={}}var t,n;return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"switchScene",value:function(e,t){pt.emit(ht.SWITCH_SCENE,{sceneName:e,sceneData:t})}},{key:"preloadScene",value:function(e){pt.emit(ht.PRELOAD_SCENE,{sceneName:e})}},{key:"isSceneLoaded",value:function(e){var t;return null!==(t=this.inst.loadedScenes[e])&&void 0!==t&&t}},{key:"markIsSceneLoaded",value:function(e){this.inst.loadedScenes[e]=!0}},{key:"markIsTestScene",value:function(e){pt.emit(ht.MARK_IS_TEST_SCENE,{sceneName:e})}},{key:"preloadDashboardScene",value:function(){this.preloadScene(dt.DASHBOARD_SCENE)}},{key:"switchToDashboardScene",value:function(e){this.switchScene(dt.DASHBOARD_SCENE,e)}},{key:"preloadGameScene",value:(n=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.preloadScene(dt.GAME_SCENE);case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"switchToGameScene",value:(t=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.switchScene(dt.GAME_SCENE,t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"switchToEndlessScene",value:function(e){this.switchScene(dt.ENDLESS_SCENE,e)}},{key:"getSceneData",value:function(e){return"data"in e.scene&&e.scene.data||{}}}]),e}());t._RF.pop(),t._RF.push({},"adb272QtfxDGZ+87PwkWEiN","GameSettings",void 0);var ft,mt,gt=e("a3",{MaxLevel:325,WaitForPassSecs:6});t._RF.pop(),t._RF.push({},"0cad13CYsZKPaWdXt+Su+Im","ItemKeys",void 0);var yt,bt=e("N",function(e){return e[e.UNDO=1]="UNDO",e[e.HINT=2]="HINT",e[e.SHUFFLE=3]="SHUFFLE",e}(bt||{})),_t=e("Q",function(e){return e[e.DISABLE=1]="DISABLE",e[e.ENABLE=2]="ENABLE",e[e.INFINITE=3]="INFINITE",e}(_t||{})),wt=e("I",(B(ft={},bt.UNDO,"UndoItem"),B(ft,bt.HINT,"HintItem"),B(ft,bt.SHUFFLE,"ShuffleItem"),ft));B(mt={},wt[bt.UNDO],bt.UNDO),B(mt,wt[bt.HINT],bt.HINT),B(mt,wt[bt.SHUFFLE],bt.SHUFFLE);t._RF.pop(),t._RF.push({},"f8533KH/fxOfYqya9sgLrSj","GameData",void 0);var Et=e("c",{level:1,coins:0,totalLevel:gt.MaxLevel,passAllLevels:!1,levelProgress:{},endlessScore:0,items:(yt={},B(yt,wt[bt.UNDO],{count:1,isFirstUse:!0}),B(yt,wt[bt.HINT],{count:1,isFirstUse:!0}),B(yt,wt[bt.SHUFFLE],{count:1,isFirstUse:!0}),yt),removeAdEndTime:0,tournamentData:{tournamentId:"",leaderboardId:"",endTime:0,bestScore:0,lastTournamentRankReward:0,isPlayerJoined:!1,isFirstTimeJoinedTournament:!0},dailyQuest:{currentStage:1,quests:[],rewarded:[]},journeyData:{lastSeason:1,currentLevel:1,claimBadges:[]},lastClaimDailyReward:0,dailyChallenge:[],limitAds:{shuffleItem:0,hintItem:0,lastWatchedAdTime:0},social:{createPlayerTournament:{success:0,failed:0},playWithFriend:{success:0,failed:0},joinGlobalTournament:{success:0,failed:0}},lastLoginTime:Date.now()});t._RF.pop(),t._RF.push({},"81357D/nvZMwbk3RGzw68tq","AnalyticsEvents",void 0);var kt=e("h",{LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",LEVEL_RETRY:"level_retry",LEVEL_PROGRESS:"level_progress",LEVEL_AUTO_FINISH:"level_auto_finish",EARN_ITEM:"earn_item",USE_ITEM:"use_item",CANT_SHUFFLE:"cant_shuffle",TOURNAMENT_START:"tournament_start",TOURNAMENT_END:"tournament_end",TOURNAMENT_REWARDED:"tournament_rewarded",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_POST_SCORE:"tournament_post_score",TOURNAMENT_REFUSE:"tournament_refuse",TOURNAMENT_REJOIN:"tournament_rejoin",VIEW_ITEM_LIST:"view_item_list",SELECT_ITEM:"select_item",PURCHASE:"purchase",PURCHASE_CANCEL:"purchase_cancel",PAGE_FOLLOW:"page_follow",GROUP_JOIN:"group_join",TUTORIAL_START:"tutorial_start",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",THEME_TILE_CHANGE:"theme_tile_change",THEME_BACKGROUND_CHANGE:"theme_background_change",THEME_ENTRY_POINT_CHANGE:"theme_entry_point_change",DAILY_QUEST_GET_REWARD:"daily_quest_get_reward",DAILY_QUEST_GET_OLD_REWARD:"daily_quest_get_old_reward",DAILY_CHALLENGE_START:"daily_challenge_start",JOURNEY_START_LEVEL:"journey_start_level",JOURNEY_COMPLETE_LEVEL:"journey_complete_level",JOURNEY_GET_BADGE:"journey_get_badge",OPEN_POPUP_PLAYER_TOURNAMENT:"open_popup_player_tournament",OPEN_POPUP_CHALLENGE_FRIEND:"open_popup_challenge_friend",OPEN_POPUP_GLOBAL_TOURNAMENT:"open_popup_global_tournament",SOCIAL_CUSTOM_CONFIG:"social_custom_config"});t._RF.pop(),t._RF.push({},"a6e4bjV/RVH17qBEx1mZaFg","ResourcePaths",void 0);var Ct,St=e("x",function(e){return e.WATER_SURFACE_FRAME="sprites/water-surface/spriteFrame",e.IC_HAND_FRAME="sprites/ic-hand/spriteFrame",e.POISON_CIRCLE_FRAME="sprites/poison-circle/spriteFrame",e.DASHBOARD_CURTAIN_PREFIX="prefabs/dashboard-curtains/",e.POISON_BUBBLE_PREFAB="prefabs/PoisonBubble",e.DUST_PARTICLE_SPINE="spines/dust-particle/siwang_texiao",e.MAP_JSON_PREFIX="maps-json/",e.TILE_PREFIX="gameplay/tiles/",e.THEME_BACKGROUND_PREFIX="gameplay/background/",e.DAILY_BADGE_PREFIX="sprites/badges/daily/",e.JOURNEY_BADGE_PREFIX="sprites/badges/journey/",e.JOURNEY_UI_PREFIX="sprites/ui/journey/",e.CHALLENGE_BLOCK_PREFAB="gameplay/prefabs/ChallengeBlock",e.DAILY_QUEST_HEADER_PREFAB="gameplay/prefabs/DailyQuestHeader",e.CHALLENGE_PREPARE_PREFAB="gameplay/prefabs/ChallengePrepare",e.JOURNEY_BLOCK_PREFAB="gameplay/prefabs/JourneyBlock",e.BACKGROUND_PREFIX="sprites/background/",e.LEADERBOARD_PORTRAIT_BACKGROUND="tournament-portrait/spriteFrame",e.LEADERBOARD_LANDSCAPE_BACKGROUND="tournament-landscape/spriteFrame",e.DAILY_CHALLENGE_PORTRAIT_BACKGROUND="daily-challenge-portrait/spriteFrame",e.BADGE_PORTRAIT_BACKGROUND="badge-portrait/spriteFrame",e.JOURNEY_PORTRAIT_BACKGROUND="journey-portrait/spriteFrame",e.LOCALIZE_PREFIX="localized-sprites/",e}(St||{}));t._RF.pop(),t._RF.push({},"de1b7wbRJtDb5SdClqZPOi5","LayoutUtils",void 0);var xt=X.Layout,Tt=e("p",function(){function e(){N(this,e),this.currentLayout=xt.Portrait,this.portraitBackground=null,this.landscapeBackground=null,this.dashboardPortraitCurtainPrefab=null,this.leaderboardPortraitBackground=null,this.leaderboardLandscapeBackground=null,this.dailyChallengePortraitBackground=null,this.badgePortraitBackground=null,this.journeyPortraitBackground=null,this.dayTimeCode=-1,b.off(Q.LAYOUT_CHANGED,e.onLayoutChanged),b.on(Q.LAYOUT_CHANGED,e.onLayoutChanged)}var t,n,r,a,i,o,s,l,u,c,d,p;return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"getCurrentLayout",value:function(){return this.inst.currentLayout}},{key:"isPortrait",value:function(){return this.inst.currentLayout===xt.Portrait}},{key:"isLandscape",value:function(){return this.inst.currentLayout===xt.Landscape}},{key:"loadCurrentBackground",value:(p=R(D().mark((function e(){var t,n,r,a,i,o,s=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getCurrentLayout(),n=this.isDayTime(),r=[],t!==xt.Portrait||this.inst.portraitBackground?t!==xt.Landscape||this.inst.landscapeBackground||(i=this.getBackgroundPath(t,n),r.push(se.loadSpriteFrameAsync(i).then((function(e){s.inst.landscapeBackground=e,e.packable=!1})))):(a=this.getBackgroundPath(t,n),r.push(se.loadSpriteFrameAsync(a).then((function(e){s.inst.portraitBackground=e,e.packable=!1})))),t===xt.Portrait&&null===this.inst.dashboardPortraitCurtainPrefab&&(o=this.getCurtainPath(n),r.push(se.loadPrefabAsync(o).then((function(e){s.inst.dashboardPortraitCurtainPrefab=e})))),e.next=7,Promise.all(r);case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getBackgroundPath",value:function(e,t){var n=e===xt.Portrait?"portrait":"landscape",r=t?"day":"night",a=se.getImageScale();return"".concat(St.BACKGROUND_PREFIX).concat(a,"x/dashboard-").concat(n,"-").concat(r,"/spriteFrame")}},{key:"getCurtainPath",value:function(e){var t=e?"Day":"Night";return"".concat(St.DASHBOARD_CURTAIN_PREFIX,"Dashboard").concat("Portrait","Curtain").concat(t)}},{key:"loadCurrentLeaderboardBackground",value:(d=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getCurrentLayout(),n=se.getImageScale(),t!==xt.Portrait||this.inst.leaderboardPortraitBackground){e.next=9;break}return e.next=5,se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(n,"x/").concat(St.LEADERBOARD_PORTRAIT_BACKGROUND));case 5:this.inst.leaderboardPortraitBackground=e.sent,this.inst.leaderboardPortraitBackground.packable=!1,e.next=14;break;case 9:if(t!==xt.Landscape||this.inst.leaderboardLandscapeBackground){e.next=14;break}return e.next=12,se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(n,"x/").concat(St.LEADERBOARD_LANDSCAPE_BACKGROUND));case 12:this.inst.leaderboardLandscapeBackground=e.sent,this.inst.leaderboardLandscapeBackground.packable=!1;case 14:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"loadCurrentDailyChallengeBackground",value:(c=R(D().mark((function e(){var t,n=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=se.getImageScale(),e.abrupt("return",se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(t,"x/").concat(St.DAILY_CHALLENGE_PORTRAIT_BACKGROUND)).then((function(e){n.inst.dailyChallengePortraitBackground=e,n.inst.dailyChallengePortraitBackground.packable=!1})));case 2:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"loadCurrentBadgeBackground",value:(u=R(D().mark((function e(){var t,n=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=se.getImageScale(),e.abrupt("return",se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(t,"x/").concat(St.BADGE_PORTRAIT_BACKGROUND)).then((function(e){n.inst.badgePortraitBackground=e,n.inst.badgePortraitBackground.packable=!1})));case 2:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"loadCurrentJourneyBackground",value:(l=R(D().mark((function e(){var t,n=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=se.getImageScale(),e.abrupt("return",se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(t,"x/").concat(St.JOURNEY_PORTRAIT_BACKGROUND)).then((function(e){n.inst.journeyPortraitBackground=e,n.inst.journeyPortraitBackground.packable=!1})));case 2:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"preloadBackgrounds",value:(s=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inst.portraitBackground||!this.inst.landscapeBackground){e.next=2;break}return e.abrupt("return");case 2:return t=se.getImageScale(),e.next=5,se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(t,"x/portrait/spriteFrame"));case 5:return this.inst.portraitBackground=e.sent,this.inst.portraitBackground.packable=!1,e.next=9,se.loadSpriteFrameAsync("".concat(St.BACKGROUND_PREFIX).concat(t,"x/landscape/spriteFrame"));case 9:this.inst.landscapeBackground=e.sent,this.inst.landscapeBackground.packable=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"isDayTime",value:function(){if(-1===this.inst.dayTimeCode){var e=(new Date).getHours();this.inst.dayTimeCode=e<14&&e>=2?1:0}return 1===this.inst.dayTimeCode}},{key:"getCurrentBackground",value:(o=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getCurrentLayout(),n=null,n=t===xt.Portrait?this.inst.portraitBackground:this.inst.landscapeBackground){e.next=7;break}return e.next=6,this.loadCurrentBackground();case 6:return e.abrupt("return",this.getCurrentBackground());case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getCurrentDashboardCurtain",value:(i=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getCurrentLayout(),n=null,t===xt.Portrait&&(n=this.inst.dashboardPortraitCurtainPrefab),t!==xt.Landscape){e.next=5;break}return e.abrupt("return",null);case 5:if(n){e.next=9;break}return e.next=8,this.loadCurrentBackground();case 8:return e.abrupt("return",this.getCurrentDashboardCurtain());case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getCurrentLeaderboardBackground",value:(a=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getCurrentLayout(),n=null,n=t===xt.Portrait?this.inst.leaderboardPortraitBackground:this.inst.leaderboardLandscapeBackground){e.next=7;break}return e.next=6,this.loadCurrentLeaderboardBackground();case 6:return e.abrupt("return",this.getCurrentLeaderboardBackground());case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getCurrentDailyChallengeBackground",value:(r=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,t=this.inst.dailyChallengePortraitBackground){e.next=6;break}return e.next=5,this.loadCurrentDailyChallengeBackground();case 5:return e.abrupt("return",this.getCurrentDailyChallengeBackground());case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getCurrentBadgeBackground",value:(n=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,t=this.inst.badgePortraitBackground){e.next=6;break}return e.next=5,this.loadCurrentBadgeBackground();case 5:return e.abrupt("return",this.getCurrentBadgeBackground());case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getCurrentJourneyBackground",value:(t=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,t=this.inst.journeyPortraitBackground){e.next=6;break}return e.next=5,this.loadCurrentJourneyBackground();case 5:return e.abrupt("return",this.getCurrentJourneyBackground());case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getCurrentLayoutLeaderboardBackground",value:function(){return this.getCurrentLayout()===xt.Portrait?this.inst.leaderboardPortraitBackground:this.inst.leaderboardLandscapeBackground}},{key:"getCurrentLayoutBackgroundByKey",value:function(e){var t=this.getCurrentLayout();switch(e){case"DailyChallenge":return this.inst.dailyChallengePortraitBackground;case"Badge":return this.inst.badgePortraitBackground;case"Journey":return this.inst.journeyPortraitBackground;case"Leaderboard":return t===xt.Portrait?this.inst.leaderboardPortraitBackground:this.inst.leaderboardLandscapeBackground;default:return console.warn("Unknown background key: ".concat(e)),null}}},{key:"isLoadedBackground",value:function(e){var t=this.getCurrentLayout();switch(e){case"DailyChallenge":return t===xt.Portrait?!!this.inst.dailyChallengePortraitBackground:!!this.inst.dailyChallengePortraitBackground&&!!this.inst.leaderboardLandscapeBackground;case"Badge":return t===xt.Portrait?!!this.inst.badgePortraitBackground:!!this.inst.badgePortraitBackground&&!!this.inst.leaderboardLandscapeBackground;default:return console.warn("Unknown background type: ".concat(e)),!1}}}]),e}());Ct=Tt,Tt.onLayoutChanged=function(e){Ct.inst.currentLayout!==e&&(Ct.inst.currentLayout=e)};try{new Tt}catch(e){console.error("LayoutUtils",e)}t._RF.pop(),t._RF.push({},"a8a96ku4x9M/YJFCNioSqOn","ThemeUtils",void 0);var Lt=codex.player,At=e("a0",function(e){return e.BG1="bg_1",e.BG2="bg_2",e.BG3="bg_3",e.BG4="bg_4",e.BG5="bg_5",e.BG6="bg_6",e}({})),Pt=e("ab",function(e){return e.CLASSIC="classic",e.ANTIQUE="antique",e.SIMPLE="simple",e.VIOLET="violet",e.FLOWER="flower",e}({})),Rt={background:At.BG1,tileset:Pt.CLASSIC},Dt=e("T",function(){function e(){N(this,e),this.backgroundSprites=new Map,this.spriteFrameMap=new Map,this.loadedTileThemes=new Set,this.currentTheme=Rt}var t,n,r,a,i,o;return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initTheme",value:function(){var e=Lt.getPlayerSetting("theme");e||(e=Rt,Lt.setSetting("theme",e)),console.log("load current theme",e),this.inst.currentTheme=e,this.validateTheme()}},{key:"loadCurrentTheme",value:(o=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleEntryPointDataTheme(),t=[],n=Tt.getCurrentLayout(),t.push(this.loadBackgroundSprite(this.inst.currentTheme.background,n),this.loadTileThemeSpriteFrames(this.inst.currentTheme.tileset)),e.next=6,Promise.all(t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"handleEntryPointDataTheme",value:function(){var e=this;try{var t=codex.context.getContextData(),n=t.theme,r=t.background,a=!1;void 0!==n&&Object.values(Pt).includes(n)&&(this.inst.currentTheme.tileset=n,a=!0),void 0!==r&&Object.values(At).includes(r)&&(this.inst.currentTheme.background=r,a=!0),a&&(console.log("Check theme entryPointData",t,n,r),setTimeout((function(){e.logEntryPointTheme()}),2e3),Lt.setSetting("theme",this.inst.currentTheme))}catch(e){console.error("Error handling entryPointData theme",e)}}},{key:"getBackgroundMapOrientationKey",value:function(e,t){return"".concat(t,"-").concat(e)}},{key:"getBackgroundURL",value:function(e,t){var n=se.getImageScale();return"".concat(St.THEME_BACKGROUND_PREFIX).concat(n,"x/").concat(t,"/").concat(e,"/spriteFrame")}},{key:"getTilesetFolderURL",value:function(e){return"".concat(St.TILE_PREFIX).concat(e,"/")}},{key:"validateTheme",value:function(){var e=this.inst.currentTheme.background,t=this.inst.currentTheme.tileset,n=!0;Object.values(At).includes(e)||(this.inst.currentTheme.background=At.BG1,n=!1),Object.values(Pt).includes(t)||(this.inst.currentTheme.tileset=Pt.CLASSIC,n=!1),n||Lt.setSetting("theme",this.inst.currentTheme)}},{key:"getCurrentBackgroundSprite",value:function(){var e=Tt.getCurrentLayout();return this.inst.backgroundSprites.get(this.getBackgroundMapOrientationKey(this.inst.currentTheme.background,e))}},{key:"getCurrentTileBackgroundSprite",value:function(){var e=this.inst.currentTheme.tileset,t=this.getSpriteKey("tile-background",e);return this.inst.spriteFrameMap.get(t)}},{key:"getCurrentTileHiddenSprite",value:function(){var e=this.inst.currentTheme.tileset,t=this.getSpriteKey("hidden",e);return this.inst.spriteFrameMap.get(t)}},{key:"getCurrentItemTileSprite",value:function(e){return this.inst.spriteFrameMap.get(this.getSpriteKey(e,this.getCurrentThemeTileset()))||null}},{key:"getTileSpriteFramePath",value:function(e){return"".concat(St.TILE_PREFIX).concat(this.inst.currentTheme.tileset,"/").concat(e,"/spriteFrame")}},{key:"getCurrentThemeTileset",value:function(){return this.inst.currentTheme.tileset}},{key:"getCurrentThemeBackground",value:function(){return this.inst.currentTheme.background}},{key:"getSpriteKey",value:function(e,t){var n=t||this.getCurrentThemeTileset();return"".concat(n,"-").concat(e)}},{key:"loadCurrentBackgroundSprite",value:(i=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.inst.currentTheme.background,n=Tt.getCurrentLayout(),this.inst.backgroundSprites.has(this.getBackgroundMapOrientationKey(t,n))){e.next=7;break}return Ke.showLoadingScreen(),e.next=6,this.loadBackgroundSprite(t,n);case 6:Ke.closeLoadingScreen();case 7:return e.abrupt("return",this.inst.backgroundSprites.get(this.getBackgroundMapOrientationKey(t,n)));case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"loadBackgroundSprite",value:(a=R(D().mark((function e(t,n){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.loadSpriteFrameAsync(this.getBackgroundURL(t,n));case 2:(r=e.sent)&&(r.packable=!1),this.inst.backgroundSprites.set(this.getBackgroundMapOrientationKey(t,n),r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"loadTileThemeSpriteFrames",value:(r=R(D().mark((function e(t){var n,r,a,i,o;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t||this.getCurrentThemeTileset(),e.next=3,se.loadSpriteFramesDirAsync(this.getTilesetFolderURL(n));case 3:r=e.sent,a=O(r);try{for(a.s();!(i=a.n()).done;)o=i.value,this.inst.spriteFrameMap.set(this.getSpriteKey(o.name,n),o)}catch(e){a.e(e)}finally{a.f()}this.inst.loadedTileThemes.add(n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getTileIcon",value:function(e){return this.inst.spriteFrameMap.get(this.getSpriteKey(e))||null}},{key:"getEffectSpriteFrame",value:function(e){return this.inst.spriteFrameMap.get(this.getSpriteKey(e))||null}},{key:"updateBackgroundKey",value:(n=R(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inst.currentTheme.background=t,Lt.setSetting("theme",this.inst.currentTheme),n=Tt.getCurrentLayout(),this.inst.backgroundSprites.has(this.getBackgroundMapOrientationKey(t,n))){e.next=8;break}return Ke.showLoadingScreen(),e.next=7,this.loadBackgroundSprite(t,n);case 7:Ke.closeLoadingScreen();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateTilesetKey",value:(t=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inst.currentTheme.tileset=t,Lt.setSetting("theme",this.inst.currentTheme),this.isLoadedTileTheme(t)){e.next=7;break}return Ke.showLoadingScreen(),e.next=6,this.loadTileThemeSpriteFrames(t);case 6:Ke.closeLoadingScreen();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isLoadedTileTheme",value:function(e){return this.inst.loadedTileThemes.has(e)}},{key:"isLoadedCurrentTileTheme",value:function(){return this.isLoadedTileTheme(this.getCurrentThemeTileset())}},{key:"logThemeTileChange",value:function(e){codex.analytics.event(kt.THEME_TILE_CHANGE,{theme_idx:e})}},{key:"logThemeBackgroundChange",value:function(e){codex.analytics.event(kt.THEME_BACKGROUND_CHANGE,{bg_idx:e})}},{key:"logEntryPointTheme",value:function(){codex.analytics.event(kt.THEME_ENTRY_POINT_CHANGE,{theme_idx:this.inst.currentTheme.tileset,bg_idx:this.inst.currentTheme.background})}}]),e}());t._RF.pop(),t._RF.push({},"05cdcnITThGR4l1JaZw+XbM","PlayerSetting",void 0);var It=e("b",{sound:!0,music:!0,vibrate:!0,language:"en",highLight:!1,autoZoom:!0,theme:{background:At.BG1,tileset:Pt.CLASSIC}});t._RF.pop(),t._RF.push({},"074c4KXFZ1Pq6d+66PrLd2+","PlayerData",void 0);var Nt=e("P",{score:0,settings:It,gameData:Et,isFirstLogin:!0,dailyRewardedData:{logDays:[],firstReward:0,lastReward:0},lastCallSwitchGame:0,notificationData:{},missionsData:{process:{}}});t._RF.pop(),t._RF.push({},"52b52FNwvhBKY/becAy420o","Leaderboard",void 0);e("e",{GLOBAL:"global-leaderboard-key",FRIENDS:"friends-leaderboard-key"}),e("f",{GLOBAL:"global-leaderboard-id",FRIENDS:"friends-leaderboard-id"});t._RF.pop(),t._RF.push({},"ed7cczyWCpForeLyfwiLhHb","Journey",void 0);var Ot=Math.ceil(3.64),Mt=new Date(2025,7,7,17).getTime(),Bt=e("a1",{REWARD_1_LEVEL:7,REWARD_2_LEVEL:41,REWARD_3_LEVEL:91,REWARD_LEVELS:[7,11,31,41,61,81,91],JOURNEY_LEVEL_COUNT:91,JOURNEY_SET_SELECT:Ot,JOURNEY_SET_LEVEL_COUNT:25,JOURNEY_BADGE_KEYS:["1","2","3"],LEVEL_PATH:"levels-journey/",MIN_GAME_LEVEL_TO_UNLOCK_JOURNEY:12,MIN_GAME_LEVEL:3001,MAX_GAME_LEVEL:3120,SEASON_START_AT:Mt,SEASON_DURATION:12096e5});t._RF.pop(),t._RF.push({},"640b6po6qpOmJv7ADI1i/fv","Tile",void 0);e("z",{MAX_TILES:42,SIZE:{WIDTH:80,HEIGHT:99},ZOOM:{MIN_COLUMNS:0,MIN_ROWS:0,STEP_COLUMNS:0,STEP_ROWS:0},ANIMATION_CONFIGS:{SHUFFLE:{FIRST_SCALE:1.3,SECOND_SCALE:1.04},SHAKE:{SHAKE_DURATION:.08,SHAKE_OFFSET:8},OPEN_DURATION:{LANDSCAPE_TOTAL:.6,MIN_PORTRAIT_TOTAL:.3,MAX_PORTRAIT_TOTAL:.6,MAX_DELAY:.3,INIT_DELAY:.5},AUTO_FINISH:{SHINE_DELAY_INTERVAL:.4,MATCH_DELAY_PER_TILE:.1,MAX_MATCH_DELAY_TOTAL_TIME:3.2},ZOOM:{DURATION:.4}}}),e("y",function(e){return e[e.PRELOADING=0]="PRELOADING",e[e.ALREADY=1]="ALREADY",e[e.CHOOSING=2]="CHOOSING",e[e.MOVING_TO_MATCH=3]="MOVING_TO_MATCH",e[e.MATCHED=4]="MATCHED",e[e.DESTROYED=5]="DESTROYED",e}({}));var Ft=e("F",45),Ut=e("$",[46,47,48]);e("H",{bamboo:[1,2,3,4,5,6,7,8,9],characters:[10,11,12,13,14,15,16,17,18],dots:[19,20,21,22,23,24,25,26,27],winds:[28,29,30,31],dragons:[32,33,34],flowers:[35,36,37,38],seasons:[39,40,41,42],golden:[Ft],artifact:Ut});t._RF.pop(),t._RF.push({},"8689aJvd7RJQIlpVCAG11h0","Journey",void 0);var Vt=e("W",function(e){return e.HIDDEN_TILE="hidden-title",e.TARGET_TILE="target-tile",e.FIND_ARTIFACT="find-artifact",e}({}));t._RF.pop(),t._RF.push({},"be1a9KpyYVPOZshgN+uUxGr","DateTimeUtils",void 0);var Gt=e("_",(function(e){return new Promise((function(t){return setTimeout(t,e)}))})),Ht=(e("a2",(function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()})),e("aa",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Date(e).toISOString();return t?n.slice(11,-5):n.slice(14,-5)}))),jt=function(e){var t=Date.now(),n=Math.max(1e3*e-t,0);return{remainingTimeInDays:Math.round(n/864e5),remainingTimeInMs:n}};function Kt(e){return null==e}function Jt(e){return null!==e&&"object"===H(e)}function Wt(e){return null!==e&&"object"===H(e)}function qt(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Yt(e,t){return Array.from(new Set([].concat(M(Object.keys(e)),M(Object.keys(t))))).reduce((function(n,r){var a=e[r],i=t[r];return Wt(a)&&Wt(i)?Object.assign(Object.assign({},n),B({},r,Yt(a,i))):Object.assign(Object.assign({},n),B({},r,r in t?i:a))}),{})}function zt(e){return!!Jt(e)&&"target"in e}t._RF.pop();var Qt={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(e){return"Invalid parameters for '".concat(e.name,"'")},nomatchingcontroller:function(e){return"No matching controller for '".concat(e.key,"'")},nomatchingview:function(e){return"No matching view for '".concat(JSON.stringify(e.params),"'")},notbindable:function(){return"Value is not bindable"},notcompatible:function(e){return"Not compatible with  plugin '".concat(e.id,"'")},propertynotfound:function(e){return"Property '".concat(e.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},Xt=function(){function e(t){var n;N(this,e),this.message=null!==(n=Qt[t.type](t.context))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}return I(e,[{key:"toString",value:function(){return this.message}}],[{key:"alreadyDisposed",value:function(){return new e({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new e({type:"notbindable"})}},{key:"notCompatible",value:function(t,n){return new e({type:"notcompatible",context:{id:"".concat(t,".").concat(n)}})}},{key:"propertyNotFound",value:function(t){return new e({type:"propertynotfound",context:{name:t}})}},{key:"shouldNeverHappen",value:function(){return new e({type:"shouldneverhappen"})}}]),e}(),Zt=function(){function e(t,n){N(this,e),this.obj_=t,this.key=n}return I(e,[{key:"read",value:function(){return this.obj_[this.key]}},{key:"write",value:function(e){this.obj_[this.key]=e}},{key:"writeProperty",value:function(t,n){var r=this.read();if(!e.isBindable(r))throw Xt.notBindable();if(!(t in r))throw Xt.propertyNotFound(t);r[t]=n}}],[{key:"isBindable",value:function(e){return null!==e&&("object"===H(e)||"function"==typeof e)}}]),e}(),$t=function(){function e(){N(this,e),this.observers_={}}return I(e,[{key:"on",value:function(e,t,n){var r,a=this.observers_[e];return a||(a=this.observers_[e]=[]),a.push({handler:t,key:null!==(r=null==n?void 0:n.key)&&void 0!==r?r:t}),this}},{key:"off",value:function(e,t){var n=this.observers_[e];return n&&(this.observers_[e]=n.filter((function(e){return e.key!==t}))),this}},{key:"emit",value:function(e,t){var n=this.observers_[e];n&&n.forEach((function(e){e.handler(t)}))}}]),e}(),en=function(){function e(t,n){var r;N(this,e),this.constraint_=null==n?void 0:n.constraint,this.equals_=null!==(r=null==n?void 0:n.equals)&&void 0!==r?r:function(e,t){return e===t},this.emitter=new $t,this.rawValue_=t}return I(e,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(e,t){var n=null!=t?t:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(e):e,a=this.rawValue_;(!this.equals_(a,r)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,previousRawValue:a,rawValue:r,sender:this}))}}]),e}(),tn=function(){function e(t){N(this,e),this.emitter=new $t,this.value_=t}return I(e,[{key:"rawValue",get:function(){return this.value_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(e,t){var n=null!=t?t:{forceEmit:!1,last:!0},r=this.value_;(r!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:this.value_,sender:this}))}}]),e}(),nn=function(){function e(t){N(this,e),this.emitter=new $t,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}return I(e,[{key:"rawValue",get:function(){return this.value_.rawValue}},{key:"onValueBeforeChange_",value:function(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}},{key:"onValueChange_",value:function(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}]),e}();function rn(e,t){var n=null==t?void 0:t.constraint,r=null==t?void 0:t.equals;return n||r?new en(e,t):new tn(e)}var an=function(){function e(t){var n=this;N(this,e),this.emitter=new $t,this.valMap_=t;var r=function(e){n.valMap_[e].emitter.on("change",(function(){n.emitter.emit("change",{key:e,sender:n})}))};for(var a in this.valMap_)r(a)}return I(e,[{key:"get",value:function(e){return this.valMap_[e].rawValue}},{key:"set",value:function(e,t){this.valMap_[e].rawValue=t}},{key:"value",value:function(e){return this.valMap_[e]}}],[{key:"createCore",value:function(e){return Object.keys(e).reduce((function(t,n){return Object.assign(t,B({},n,rn(e[n])))}),{})}},{key:"fromObject",value:function(t){return new e(this.createCore(t))}}]),e}(),on=function(){function e(t){N(this,e),this.values=an.fromObject({max:t.max,min:t.min})}return I(e,[{key:"constrain",value:function(e){var t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}]),e}(),sn=function(){function e(t){N(this,e),this.values=an.fromObject({max:t.max,min:t.min})}return I(e,[{key:"constrain",value:function(e){var t=this.values.get("max"),n=this.values.get("min"),r=e;return Kt(n)||(r=Math.max(r,n)),Kt(t)||(r=Math.min(r,t)),r}}]),e}(),ln=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;N(this,e),this.step=t,this.origin=n}return I(e,[{key:"constrain",value:function(e){var t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}]),e}(),un=function(){function e(t){N(this,e),this.text=t}return I(e,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),e}(),cn={"**":function(e,t){return Math.pow(e,t)},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<<":function(e,t){return e<<t},">>":function(e,t){return e>>t},">>>":function(e,t){return e>>>t},"&":function(e,t){return e&t},"^":function(e,t){return e^t},"|":function(e,t){return e|t}},dn=function(){function e(t,n,r){N(this,e),this.left=n,this.operator=t,this.right=r}return I(e,[{key:"evaluate",value:function(){var e=cn[this.operator];if(!e)throw new Error("unexpected binary operator: '".concat(this.operator));return e(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),e}(),pn={"+":function(e){return e},"-":function(e){return-e},"~":function(e){return~e}},hn=function(){function e(t,n){N(this,e),this.operator=t,this.expression=n}return I(e,[{key:"evaluate",value:function(){var e=pn[this.operator];if(!e)throw new Error("unexpected unary operator: '".concat(this.operator));return e(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),e}();function vn(e){return function(t,n){for(var r=0;r<e.length;r++){var a=e[r](t,n);if(""!==a)return a}return""}}function fn(e,t){var n,r=e.substr(t).match(/^\s+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function mn(e,t){var n,r=e.substr(t).match(/^[0-9]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function gn(e,t){var n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";var r=function(e,t){var n=mn(e,t);if(""!==n)return n;var r=e.substr(t,1);if("-"!==r&&"+"!==r)return"";var a=mn(e,t+=1);return""===a?"":r+a}(e,t);return""===r?"":n+r}function yn(e,t){var n=e.substr(t,1);if("0"===n)return n;var r=function(e,t){var n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=r.length,""===r?"":r+mn(e,t)}var bn=vn([function(e,t){var n=yn(e,t);if(t+=n.length,""===n)return"";var r=e.substr(t,1);if(t+=r.length,"."!==r)return"";var a=mn(e,t);return n+r+a+gn(e,t+=a.length)},function(e,t){var n=e.substr(t,1);if(t+=n.length,"."!==n)return"";var r=mn(e,t);return t+=r.length,""===r?"":n+r+gn(e,t)},function(e,t){var n=yn(e,t);return t+=n.length,""===n?"":n+gn(e,t)}]);var _n=vn([function(e,t){var n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";var r=function(e,t){var n,r=e.substr(t).match(/^[01]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r},function(e,t){var n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";var r=function(e,t){var n,r=e.substr(t).match(/^[0-7]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r},function(e,t){var n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";var r=function(e,t){var n,r=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r}]),wn=vn([_n,bn]);function En(e,t){var n;return null!==(n=function(e,t){var n=wn(e,t);return t+=n.length,""===n?null:{evaluable:new un(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){var n=e.substr(t,1);if(t+=n.length,"("!==n)return null;var r=Sn(e,t);if(!r)return null;t=r.cursor,t+=fn(e,t).length;var a=e.substr(t,1);return t+=a.length,")"!==a?null:{evaluable:r.evaluable,cursor:t}}(e,t)}function kn(e,t,n){n+=fn(t,n).length;var r=e.filter((function(e){return t.startsWith(e,n)}))[0];return r?(n+=r.length,{cursor:n+=fn(t,n).length,operator:r}):null}var Cn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(e,t){return function(e,t){return function(n,r){var a=e(n,r);if(!a)return null;r=a.cursor;for(var i=a.evaluable;;){var o=kn(t,n,r);if(!o)break;r=o.cursor;var s=e(n,r);if(!s)return null;r=s.cursor,i=new dn(o.operator,i,s.evaluable)}return i?{cursor:r,evaluable:i}:null}}(e,t)}),(function e(t,n){var r=En(t,n);if(r)return r;var a=t.substr(n,1);if(n+=a.length,"+"!==a&&"-"!==a&&"~"!==a)return null;var i=e(t,n);return i?{cursor:n=i.cursor,evaluable:new hn(a,i.evaluable)}:null}));function Sn(e,t){return t+=fn(e,t).length,Cn(e,t)}function xn(e){var t,n=function(e){var t=Sn(e,0);return t?t.cursor+fn(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function Tn(e){if("number"==typeof e)return e;if("string"==typeof e){var t=xn(e);if(!Kt(t))return t}return 0}function Ln(e){return String(e)}function An(e){return function(t){return t.toFixed(Math.max(Math.min(e,20),0))}}function Pn(e,t,n,r,a){return r+(e-t)/(n-t)*(a-r)}function Rn(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Dn(e,t,n){return Math.min(Math.max(e,t),n)}function In(e,t){return(e%t+t)%t}function Nn(e,t){return Kt(e.step)?Math.max(Rn(t),2):Rn(e.step)}function On(e){var t;return null!==(t=e.step)&&void 0!==t?t:1}function Mn(e,t){var n,r=Math.abs(null!==(n=e.step)&&void 0!==n?n:t);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}function Bn(e,t){return Kt(e.step)?null:new ln(e.step,t)}function Fn(e){return Kt(e.max)||Kt(e.min)?Kt(e.max)&&Kt(e.min)?null:new sn({max:e.max,min:e.min}):new on({max:e.max,min:e.min})}function Un(e,t){var n,r,a;return{formatter:null!==(n=e.format)&&void 0!==n?n:An(Nn(e,t)),keyScale:null!==(r=e.keyScale)&&void 0!==r?r:On(e),pointerScale:null!==(a=e.pointerScale)&&void 0!==a?a:Mn(e,t)}}function Vn(e){return{format:e.optional.function,keyScale:e.optional.number,max:e.optional.number,min:e.optional.number,pointerScale:e.optional.number,step:e.optional.number}}function Gn(e){return{constraint:e.constraint,textProps:an.fromObject(Un(e.params,e.initialValue))}}var Hn=function(){function e(t){N(this,e),this.controller=t}return I(e,[{key:"element",get:function(){return this.controller.view.element}},{key:"disabled",get:function(){return this.controller.viewProps.get("disabled")},set:function(e){this.controller.viewProps.set("disabled",e)}},{key:"hidden",get:function(){return this.controller.viewProps.get("hidden")},set:function(e){this.controller.viewProps.set("hidden",e)}},{key:"dispose",value:function(){this.controller.viewProps.set("disposed",!0)}},{key:"importState",value:function(e){return this.controller.importState(e)}},{key:"exportState",value:function(){return this.controller.exportState()}}]),e}(),jn=I((function e(t){N(this,e),this.target=t})),Kn=function(e){F(n,e);var t=U(n);function n(e,r,a){var i;return N(this,n),(i=t.call(this,e)).value=r,i.last=null==a||a,i}return I(n)}(jn),Jn=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e)).expanded=r,a}return I(n)}(jn),Wn=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e)).index=r,a}return I(n)}(jn),qn=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e)).native=r,a}return I(n)}(jn),Yn=function(e){F(n,e);var t=U(n);function n(e){var r;return N(this,n),(r=t.call(this,e)).onValueChange_=r.onValueChange_.bind(j(r)),r.emitter_=new $t,r.controller.value.emitter.on("change",r.onValueChange_),r}return I(n,[{key:"label",get:function(){return this.controller.labelController.props.get("label")},set:function(e){this.controller.labelController.props.set("label",e)}},{key:"key",get:function(){return this.controller.value.binding.target.key}},{key:"tag",get:function(){return this.controller.tag},set:function(e){this.controller.tag=e}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}},{key:"refresh",value:function(){this.controller.value.fetch()}},{key:"onValueChange_",value:function(e){var t=this.controller.value;this.emitter_.emit("change",new Kn(this,t.binding.target.read(),e.options.last))}}]),n}(Hn),zn=function(){function e(t,n){N(this,e),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=n,this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new $t}return I(e,[{key:"rawValue",get:function(){return this.value_.rawValue},set:function(e){this.value_.rawValue=e}},{key:"setRawValue",value:function(e,t){this.value_.setRawValue(e,t)}},{key:"fetch",value:function(){this.value_.rawValue=this.binding.read()}},{key:"push",value:function(){this.binding.write(this.value_.rawValue)}},{key:"onValueBeforeChange_",value:function(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}},{key:"onValueChange_",value:function(e){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}]),e}();function Qn(e){return function(t){return function(n){if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};var r=e(n);return void 0!==r?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}}function Xn(e){return{custom:function(t){return Qn(t)(e)},boolean:Qn((function(e){return"boolean"==typeof e?e:void 0}))(e),number:Qn((function(e){return"number"==typeof e?e:void 0}))(e),string:Qn((function(e){return"string"==typeof e?e:void 0}))(e),function:Qn((function(e){return"function"==typeof e?e:void 0}))(e),constant:function(t){return Qn((function(e){return e===t?t:void 0}))(e)},raw:Qn((function(e){return e}))(e),object:function(t){return Qn((function(e){var n;if(null!==(n=e)&&"object"===H(n))return function(e,t){return Object.keys(t).reduce((function(n,r){if(void 0!==n){var a=(0,t[r])(e[r]);return a.succeeded?Object.assign(Object.assign({},n),B({},r,a.value)):void 0}}),{})}(e,t)}))(e)},array:function(t){return Qn((function(e){var n;if(Array.isArray(e))return n=t,e.reduce((function(e,t){if(void 0!==e){var r=n(t);if(r.succeeded&&void 0!==r.value)return[].concat(M(e),[r.value])}}),[])}))(e)}}}var Zn={optional:Xn(!0),required:Xn(!1)};function $n(e,t){var n=t(Zn),r=Zn.required.object(n)(e);return r.succeeded?r.value:void 0}function er(e,t,n,r){if(t&&!t(e))return!1;var a=$n(e,n);return!!a&&r(a)}function tr(e,t){var n;return Yt(null!==(n=null==e?void 0:e())&&void 0!==n?n:{},t)}function nr(e){return"value"in e}function rr(e){return!(!Jt(e)||!("binding"in e))&&zt(e.binding)}var ar="http://www.w3.org/2000/svg";function ir(e){e.offsetHeight}function or(e){return void 0!==e.ontouchstart}function sr(){return globalThis.document}var lr={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function ur(e,t){var n=e.createElementNS(ar,"svg");return n.innerHTML=lr[t],n}function cr(e,t,n){e.insertBefore(t,e.children[n])}function dr(e){e.parentElement&&e.parentElement.removeChild(e)}function pr(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function hr(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}function vr(e,t){e.emitter.on("change",(function(e){t(e.rawValue)})),t(e.rawValue)}function fr(e,t,n){vr(e.value(t),n)}var mr="tp";function gr(e){return function(t,n){return[mr,"-",e,"v",t?"_".concat(t):"",n?"-".concat(n):""].join("")}}var yr=gr("lbl");var br=I((function e(t,n){var r=this;N(this,e),this.element=t.createElement("div"),this.element.classList.add(yr()),n.viewProps.bindClassModifiers(this.element);var a=t.createElement("div");a.classList.add(yr("l")),fr(n.props,"label",(function(e){Kt(e)?r.element.classList.add(yr(void 0,"nol")):(r.element.classList.remove(yr(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(a),a.appendChild(function(e,t){var n=e.createDocumentFragment();return t.split("\n").map((function(t){return e.createTextNode(t)})).forEach((function(t,r){r>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(t,e)))})),this.element.appendChild(a),this.labelElement=a;var i=t.createElement("div");i.classList.add(yr("v")),this.element.appendChild(i),this.valueElement=i})),_r=function(){function e(t,n){N(this,e),this.props=n.props,this.valueController=n.valueController,this.viewProps=n.valueController.viewProps,this.view=new br(t,{props:n.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}return I(e,[{key:"importProps",value:function(e){var t=this;return er(e,null,(function(e){return{label:e.optional.string}}),(function(e){return t.props.set("label",e.label),!0}))}},{key:"exportProps",value:function(){return tr(null,{label:this.props.get("label")})}}]),e}();var wr=gr(""),Er={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},kr=function(){function e(t){var n=this;N(this,e),this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;var r=this.view.element;this.blade.value("positions").emitter.on("change",(function(){["veryfirst","first","last","verylast"].forEach((function(e){r.classList.remove(wr(void 0,Er[e]))})),n.blade.get("positions").forEach((function(e){r.classList.add(wr(void 0,Er[e]))}))})),this.viewProps.handleDispose((function(){dr(r)}))}return I(e,[{key:"parent",get:function(){return this.parent_},set:function(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}},{key:"importState",value:function(e){var t=this;return er(e,null,(function(e){return{disabled:e.required.boolean,hidden:e.required.boolean}}),(function(e){return t.viewProps.importState(e),!0}))}},{key:"exportState",value:function(){return tr(null,Object.assign({},this.viewProps.exportState()))}}]),e}(),Cr=function(e){F(n,e);var t=U(n);function n(e,r){var a;if(N(this,n),r.value!==r.valueController.value)throw Xt.shouldNeverHappen();var i=r.valueController.viewProps,o=new _r(e,{blade:r.blade,props:r.props,valueController:r.valueController});return(a=t.call(this,Object.assign(Object.assign({},r),{view:new br(e,{props:r.props,viewProps:i}),viewProps:i}))).labelController=o,a.value=r.value,a.valueController=r.valueController,a.view.valueElement.appendChild(a.valueController.view.element),a}return I(n,[{key:"importState",value:function(e){var t=this;return er(e,(function(r){var a,i,o;return K(J(n.prototype),"importState",t).call(t,r)&&t.labelController.importProps(r)&&(null===(o=null===(i=(a=t.valueController).importProps)||void 0===i?void 0:i.call(a,e))||void 0===o||o)}),(function(e){return{value:e.optional.raw}}),(function(e){return e.value&&(t.value.rawValue=e.value),!0}))}},{key:"exportState",value:function(){var e,t,r,a=this;return tr((function(){return K(J(n.prototype),"exportState",a).call(a)}),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(r=null===(t=(e=this.valueController).exportProps)||void 0===t?void 0:t.call(e))&&void 0!==r?r:{}))}}]),n}(kr);function Sr(e){var t=Object.assign({},e);return delete t.value,t}var xr=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e,r)).tag=r.tag,a}return I(n,[{key:"importState",value:function(e){var t=this;return er(e,(function(r){return K(J(n.prototype),"importState",t).call(t,Sr(e))}),(function(e){return{tag:e.optional.string}}),(function(e){return t.tag=e.tag,!0}))}},{key:"exportState",value:function(){var e=this;return tr((function(){return Sr(K(J(n.prototype),"exportState",e).call(e))}),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}]),n}(Cr);var Tr=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"importState",value:function(e){var t=this;return er(e,(function(e){return K(J(n.prototype),"importState",t).call(t,e)}),(function(e){return{binding:e.required.object({value:e.required.raw})}}),(function(e){return t.value.binding.inject(e.binding.value),t.value.fetch(),!0}))}}]),n}(xr);function Lr(e){return nr(e)&&function(e){if(!("binding"in e))return!1;var t=e.binding;return zt(t)&&"read"in t&&"write"in t}(e.value)}function Ar(e,t){for(;e.length<t;)e.push(void 0)}var Pr=function(){function e(t){var n,r;N(this,e),this.emitter=new $t,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t.binding,this.value_=rn((n=t.bufferSize,Ar(r=[],n),r)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}return I(e,[{key:"rawValue",get:function(){return this.value_.rawValue},set:function(e){this.value_.rawValue=e}},{key:"setRawValue",value:function(e,t){this.value_.setRawValue(e,t)}},{key:"fetch",value:function(){var e,t,n;this.value_.rawValue=(e=this.value_.rawValue,t=this.binding.read(),(n=[].concat(M(function(e){var t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}(e)),[t])).length>e.length?n.splice(0,n.length-e.length):Ar(n,e.length),n)}},{key:"onTick_",value:function(){this.fetch()}},{key:"onValueBeforeChange_",value:function(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}},{key:"onValueChange_",value:function(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}]),e}();var Rr=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"exportState",value:function(){var e=this;return tr((function(){return K(J(n.prototype),"exportState",e).call(e)}),{binding:{readonly:!0}})}}]),n}(xr);function Dr(e){return nr(e)&&function(e){if(!("binding"in e))return!1;var t=e.binding;return zt(t)&&"read"in t&&!("write"in t)}(e.value)}var Ir=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"label",get:function(){return this.controller.labelController.props.get("label")},set:function(e){this.controller.labelController.props.set("label",e)}},{key:"title",get:function(){var e;return null!==(e=this.controller.buttonController.props.get("title"))&&void 0!==e?e:""},set:function(e){this.controller.buttonController.props.set("title",e)}},{key:"on",value:function(e,t){var n=this,r=t.bind(this);return this.controller.buttonController.emitter.on(e,(function(e){r(new qn(n,e.nativeEvent))})),this}},{key:"off",value:function(e,t){return this.controller.buttonController.emitter.off(e,t),this}}]),n}(Hn);function Nr(e,t){return function(n){!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function Or(e,t){vr(e,(function(e){t.textContent=null!=e?e:""}))}var Mr=gr("btn"),Br=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(Mr()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("button");r.classList.add(Mr("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var a=t.createElement("div");a.classList.add(Mr("t")),Or(n.props.value("title"),a),this.buttonElement.appendChild(a)})),Fr=function(){function e(t,n){N(this,e),this.emitter=new $t,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new Br(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return I(e,[{key:"importProps",value:function(e){var t=this;return er(e,null,(function(e){return{title:e.optional.string}}),(function(e){return t.props.set("title",e.title),!0}))}},{key:"exportProps",value:function(){return tr(null,{title:this.props.get("title")})}},{key:"onClick_",value:function(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}]),e}(),Ur=function(e){F(n,e);var t=U(n);function n(e,r){var a;N(this,n);var i=new Fr(e,{props:r.buttonProps,viewProps:r.viewProps}),o=new _r(e,{blade:r.blade,props:r.labelProps,valueController:i});return(a=t.call(this,{blade:r.blade,view:o.view,viewProps:r.viewProps})).buttonController=i,a.labelController=o,a}return I(n,[{key:"importState",value:function(e){var t=this;return er(e,(function(e){return K(J(n.prototype),"importState",t).call(t,e)&&t.buttonController.importProps(e)&&t.labelController.importProps(e)}),(function(){return{}}),(function(){return!0}))}},{key:"exportState",value:function(){var e=this;return tr((function(){return K(J(n.prototype),"exportState",e).call(e)}),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}]),n}(kr),Vr=function(){function e(t){N(this,e);var n=t.split("-"),r=W(n,2),a=r[0],i=r[1],o=a.split(".");this.major=parseInt(o[0],10),this.minor=parseInt(o[1],10),this.patch=parseInt(o[2],10),this.prerelease=null!=i?i:null}return I(e,[{key:"toString",value:function(){var e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}]),e}(),Gr=new Vr("2.0.5");function Hr(e){return Object.assign({core:Gr},e)}var jr=Hr({id:"button",type:"blade",accept:function(e){var t=$n(e,(function(e){return{title:e.required.string,view:e.required.constant("button"),label:e.optional.string}}));return t?{params:t}:null},controller:function(e){return new Ur(e.document,{blade:e.blade,buttonProps:an.fromObject({title:e.params.title}),labelProps:an.fromObject({label:e.params.label}),viewProps:e.viewProps})},api:function(e){return e.controller instanceof Ur?new Ir(e.controller):null}});var Kr=function(){function e(t,n){N(this,e),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=t,this.emitter_=new $t,this.pool_=n,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}return I(e,[{key:"children",get:function(){var e=this;return this.controller_.rack.children.map((function(t){return e.pool_.createApi(t)}))}},{key:"addBinding",value:function(e,t,n){var r=null!=n?n:{},a=this.controller_.element.ownerDocument,i=this.pool_.createBinding(a,function(e,t){if(!Zt.isBindable(e))throw Xt.notBindable();return new Zt(e,t)}(e,t),r),o=this.pool_.createBindingApi(i);return this.add(o,r.index)}},{key:"addFolder",value:function(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}},{key:"addButton",value:function(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}},{key:"addTab",value:function(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}},{key:"add",value:function(e,t){var n=e.controller;return this.controller_.rack.add(n,t),e}},{key:"remove",value:function(e){this.controller_.rack.remove(e.controller)}},{key:"addBlade",value:function(e){var t=this.controller_.element.ownerDocument,n=this.pool_.createBlade(t,e),r=this.pool_.createApi(n);return this.add(r,e.index)}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}},{key:"refresh",value:function(){this.children.forEach((function(e){var t;Jt(t=e)&&"refresh"in t&&"function"==typeof t.refresh&&e.refresh()}))}},{key:"onRackValueChange_",value:function(e){var t=e.bladeController,n=this.pool_.createApi(t),r=rr(t.value)?t.value.binding:null;this.emitter_.emit("change",new Kn(n,r?r.target.read():t.value.rawValue,e.options.last))}}]),e}(),Jr=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e)).rackApi_=new Kr(e.rackController,r),a}return I(n,[{key:"refresh",value:function(){this.rackApi_.refresh()}}]),n}(Hn),Wr=function(e){F(n,e);var t=U(n);function n(e){var r;return N(this,n),(r=t.call(this,{blade:e.blade,view:e.view,viewProps:e.rackController.viewProps})).rackController=e.rackController,r}return I(n,[{key:"importState",value:function(e){var t=this;return er(e,(function(e){return K(J(n.prototype),"importState",t).call(t,e)}),(function(e){return{children:e.required.array(e.required.raw)}}),(function(e){return t.rackController.rack.children.every((function(t,n){return t.importState(e.children[n])}))}))}},{key:"exportState",value:function(){var e=this;return tr((function(){return K(J(n.prototype),"exportState",e).call(e)}),{children:this.rackController.rack.children.map((function(e){return e.exportState()}))})}}]),n}(kr);function qr(e){return"rackController"in e}var Yr=function(){function e(t){N(this,e),this.emitter=new $t,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}return I(e,[{key:"items",get:function(){return this.items_}},{key:"allItems",value:function(){return Array.from(this.cache_)}},{key:"find",value:function(e){var t,n=O(this.allItems());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"includes",value:function(e){return this.cache_.has(e)}},{key:"add",value:function(e,t){var n=this;if(this.includes(e))throw Xt.shouldNeverHappen();var r=void 0!==t?t:this.items_.length;this.items_.splice(r,0,e),this.cache_.add(e);var a=this.extract_(e);a&&(a.emitter.on("add",this.onSubListAdd_),a.emitter.on("remove",this.onSubListRemove_),a.allItems().forEach((function(e){n.cache_.add(e)}))),this.emitter.emit("add",{index:r,item:e,root:this,target:this})}},{key:"remove",value:function(e){var t=this,n=this.items_.indexOf(e);if(!(n<0)){this.items_.splice(n,1),this.cache_.delete(e);var r=this.extract_(e);r&&(r.allItems().forEach((function(e){t.cache_.delete(e)})),r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:n,item:e,root:this,target:this})}}},{key:"onSubListAdd_",value:function(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}},{key:"onSubListRemove_",value:function(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}]),e}();function zr(e){return qr(e)?e.rackController.rack.bcSet_:null}var Qr=function(){function e(t){var n,r;N(this,e),this.emitter=new $t,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(n=t.blade)&&void 0!==n?n:null,null===(r=this.blade_)||void 0===r||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new Yr(zr),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return I(e,[{key:"children",get:function(){return this.bcSet_.items}},{key:"add",value:function(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),e.parent=this,this.bcSet_.add(e,t)}},{key:"remove",value:function(e){e.parent=null,this.bcSet_.remove(e)}},{key:"find",value:function(e){return this.bcSet_.allItems().filter(e)}},{key:"onSetAdd_",value:function(e){this.updatePositions_();var t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),t){var n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),nr(n))n.value.emitter.on("change",this.onChildValueChange_);else if(qr(n)){var r=n.rackController.rack;if(r){var a=r.emitter;a.on("layout",this.onRackLayout_),a.on("valuechange",this.onRackValueChange_)}}}}},{key:"onSetRemove_",value:function(e){this.updatePositions_();var t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),t){var n=e.item;if(nr(n))n.value.emitter.off("change",this.onChildValueChange_);else if(qr(n)){var r=n.rackController.rack;if(r){var a=r.emitter;a.off("layout",this.onRackLayout_),a.off("valuechange",this.onRackValueChange_)}}}}},{key:"updatePositions_",value:function(){var e=this,t=this.bcSet_.items.filter((function(e){return!e.viewProps.get("hidden")})),n=t[0],r=t[t.length-1];this.bcSet_.items.forEach((function(t){var a=[];t===n&&(a.push("first"),e.blade_&&!e.blade_.get("positions").includes("veryfirst")||a.push("veryfirst")),t===r&&(a.push("last"),e.blade_&&!e.blade_.get("positions").includes("verylast")||a.push("verylast")),t.blade.set("positions",a)}))}},{key:"onChildPositionsChange_",value:function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildViewPropsChange_",value:function(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildDispose_",value:function(){var e=this;this.bcSet_.items.filter((function(e){return e.viewProps.get("disposed")})).forEach((function(t){e.bcSet_.remove(t)}))}},{key:"onChildValueChange_",value:function(e){var t=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(nr(r)&&r.value===t)return r}return null}(this.find(nr),e.sender);if(!t)throw Xt.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}},{key:"onRackLayout_",value:function(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onRackValueChange_",value:function(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}},{key:"onBladePositionsChange_",value:function(){this.updatePositions_()}}]),e}(),Xr=function(){function e(t){var n=this;N(this,e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=t.element,this.viewProps=t.viewProps;var r=new Qr({blade:t.root?void 0:t.blade,viewProps:t.viewProps});r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.rack=r,this.viewProps.handleDispose((function(){for(var e=n.rack.children.length-1;e>=0;e--){n.rack.children[e].viewProps.set("disposed",!0)}}))}return I(e,[{key:"onRackAdd_",value:function(e){e.root&&cr(this.element,e.bladeController.view.element,e.index)}},{key:"onRackRemove_",value:function(e){e.root&&dr(e.bladeController.view.element)}}]),e}();function Zr(){return new an({positions:rn([],{equals:qt})})}var $r=function(e){F(n,e);var t=U(n);function n(e){return N(this,n),t.call(this,e)}return I(n,[{key:"styleExpanded",get:function(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Kt(e)?"".concat(e,"px"):"auto"}},{key:"bindExpandedClass",value:function(e,t){var n=this,r=function(){n.styleExpanded?e.classList.add(t):e.classList.remove(t)};fr(this,"expanded",r),fr(this,"temporaryExpanded",r)}},{key:"cleanUpTransition",value:function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}],[{key:"create",value:function(e){var t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(an.createCore(t))}}]),n}(an);function ea(e,t){t.style.height=e.styleHeight}function ta(e,t){e.value("expanded").emitter.on("beforechange",(function(){if(e.set("completed",!1),Kt(e.get("expandedHeight"))){var n=(r=e,l=0,o=function(){r.set("expandedHeight",null),r.set("temporaryExpanded",!0),ir(a),l=a.clientHeight,r.set("temporaryExpanded",null),ir(a)},s=(i=a=t).style.transition,i.style.transition="none",o(),i.style.transition=s,l);n>0&&e.set("expandedHeight",n)}var r,a,i,o,s,l;e.set("shouldFixHeight",!0),ir(t)})),e.emitter.on("change",(function(){ea(e,t)})),ea(e,t),t.addEventListener("transitionend",(function(t){"height"===t.propertyName&&e.cleanUpTransition()}))}var na=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e,r)).emitter_=new $t,a.controller.foldable.value("expanded").emitter.on("change",(function(e){a.emitter_.emit("fold",new Jn(j(a),e.sender.rawValue))})),a.rackApi_.on("change",(function(e){a.emitter_.emit("change",e)})),a}return I(n,[{key:"expanded",get:function(){return this.controller.foldable.get("expanded")},set:function(e){this.controller.foldable.set("expanded",e)}},{key:"title",get:function(){return this.controller.props.get("title")},set:function(e){this.controller.props.set("title",e)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addBinding",value:function(e,t,n){return this.rackApi_.addBinding(e,t,n)}},{key:"addFolder",value:function(e){return this.rackApi_.addFolder(e)}},{key:"addButton",value:function(e){return this.rackApi_.addButton(e)}},{key:"addTab",value:function(e){return this.rackApi_.addTab(e)}},{key:"add",value:function(e,t){return this.rackApi_.add(e,t)}},{key:"remove",value:function(e){this.rackApi_.remove(e)}},{key:"addBlade",value:function(e){return this.rackApi_.addBlade(e)}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}}]),n}(Jr),ra=gr("cnt"),aa=I((function e(t,n){var r,a=this;N(this,e),this.className_=gr(null!==(r=n.viewName)&&void 0!==r?r:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),ra()),n.viewProps.bindClassModifiers(this.element),this.foldable_=n.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),fr(this.foldable_,"completed",Nr(this.element,this.className_(void 0,"cpl")));var i=t.createElement("button");i.classList.add(this.className_("b")),fr(n.props,"title",(function(e){Kt(e)?a.element.classList.add(a.className_(void 0,"not")):a.element.classList.remove(a.className_(void 0,"not"))})),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var o=t.createElement("div");o.classList.add(this.className_("i")),this.element.appendChild(o);var s=t.createElement("div");s.classList.add(this.className_("t")),Or(n.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s;var l=t.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);var u=t.createElement("div");u.classList.add(this.className_("c")),this.element.appendChild(u),this.containerElement=u})),ia=function(e){F(n,e);var t=U(n);function n(e,r){var a,i;N(this,n);var o=$r.create(null===(i=r.expanded)||void 0===i||i),s=new aa(e,{foldable:o,props:r.props,viewName:r.root?"rot":void 0,viewProps:r.viewProps});return(a=t.call(this,Object.assign(Object.assign({},r),{rackController:new Xr({blade:r.blade,element:s.containerElement,root:r.root,viewProps:r.viewProps}),view:s}))).onTitleClick_=a.onTitleClick_.bind(j(a)),a.props=r.props,a.foldable=o,ta(a.foldable,a.view.containerElement),a.rackController.rack.emitter.on("add",(function(){a.foldable.cleanUpTransition()})),a.rackController.rack.emitter.on("remove",(function(){a.foldable.cleanUpTransition()})),a.view.buttonElement.addEventListener("click",a.onTitleClick_),a}return I(n,[{key:"document",get:function(){return this.view.element.ownerDocument}},{key:"importState",value:function(e){var t=this;return er(e,(function(e){return K(J(n.prototype),"importState",t).call(t,e)}),(function(e){return{expanded:e.required.boolean,title:e.optional.string}}),(function(e){return t.foldable.set("expanded",e.expanded),t.props.set("title",e.title),!0}))}},{key:"exportState",value:function(){var e=this;return tr((function(){return K(J(n.prototype),"exportState",e).call(e)}),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}},{key:"onTitleClick_",value:function(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}]),n}(Wr),oa=Hr({id:"folder",type:"blade",accept:function(e){var t=$n(e,(function(e){return{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean}}));return t?{params:t}:null},controller:function(e){return new ia(e.document,{blade:e.blade,expanded:e.params.expanded,props:an.fromObject({title:e.params.title}),viewProps:e.viewProps})},api:function(e){return e.controller instanceof ia?new na(e.controller,e.pool):null}}),sa=gr("");function la(e,t){return Nr(e,sa(void 0,t))}var ua=function(e){F(n,e);var t=U(n);function n(e){var r,a;N(this,n),(r=t.call(this,e)).onDisabledChange_=r.onDisabledChange_.bind(j(r)),r.onParentChange_=r.onParentChange_.bind(j(r)),r.onParentGlobalDisabledChange_=r.onParentGlobalDisabledChange_.bind(j(r));var i,o=(i=rn(r.getGlobalDisabled_()),[new nn(i),function(e,t){i.setRawValue(e,t)}]),s=W(o,2);return r.globalDisabled_=s[0],r.setGlobalDisabled_=s[1],r.value("disabled").emitter.on("change",r.onDisabledChange_),r.value("parent").emitter.on("change",r.onParentChange_),null===(a=r.get("parent"))||void 0===a||a.globalDisabled.emitter.on("change",r.onParentGlobalDisabledChange_),r}return I(n,[{key:"globalDisabled",get:function(){return this.globalDisabled_}},{key:"bindClassModifiers",value:function(e){vr(this.globalDisabled_,la(e,"disabled")),fr(this,"hidden",la(e,"hidden"))}},{key:"bindDisabled",value:function(e){vr(this.globalDisabled_,(function(t){e.disabled=t}))}},{key:"bindTabIndex",value:function(e){vr(this.globalDisabled_,(function(t){e.tabIndex=t?-1:0}))}},{key:"handleDispose",value:function(e){this.value("disposed").emitter.on("change",(function(t){t&&e()}))}},{key:"importState",value:function(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}},{key:"exportState",value:function(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}},{key:"getGlobalDisabled_",value:function(){var e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}},{key:"updateGlobalDisabled_",value:function(){this.setGlobalDisabled_(this.getGlobalDisabled_())}},{key:"onDisabledChange_",value:function(){this.updateGlobalDisabled_()}},{key:"onParentGlobalDisabledChange_",value:function(){this.updateGlobalDisabled_()}},{key:"onParentChange_",value:function(e){var t,n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}],[{key:"create",value:function(e){var t,r,a,i=null!=e?e:{};return new n(an.createCore({disabled:null!==(t=i.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(r=i.hidden)&&void 0!==r&&r,parent:null!==(a=i.parent)&&void 0!==a?a:null}))}}]),n}(an),ca=gr("tbp"),da=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(ca()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(ca("c")),this.element.appendChild(r),this.containerElement=r})),pa=gr("tbi"),ha=I((function e(t,n){var r=this;N(this,e),this.element=t.createElement("div"),this.element.classList.add(pa()),n.viewProps.bindClassModifiers(this.element),fr(n.props,"selected",(function(e){e?r.element.classList.add(pa(void 0,"sel")):r.element.classList.remove(pa(void 0,"sel"))}));var a=t.createElement("button");a.classList.add(pa("b")),n.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a;var i=t.createElement("div");i.classList.add(pa("t")),Or(n.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i})),va=function(){function e(t,n){N(this,e),this.emitter=new $t,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new ha(t,{props:n.props,viewProps:n.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return I(e,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),e}(),fa=function(e){F(n,e);var t=U(n);function n(e,r){var a;N(this,n);var i=new da(e,{viewProps:r.viewProps});return(a=t.call(this,Object.assign(Object.assign({},r),{rackController:new Xr({blade:r.blade,element:i.containerElement,viewProps:r.viewProps}),view:i}))).onItemClick_=a.onItemClick_.bind(j(a)),a.ic_=new va(e,{props:r.itemProps,viewProps:ua.create()}),a.ic_.emitter.on("click",a.onItemClick_),a.props=r.props,fr(a.props,"selected",(function(e){a.itemController.props.set("selected",e),a.viewProps.set("hidden",!e)})),a}return I(n,[{key:"itemController",get:function(){return this.ic_}},{key:"importState",value:function(e){var t=this;return er(e,(function(e){return K(J(n.prototype),"importState",t).call(t,e)}),(function(e){return{selected:e.required.boolean,title:e.required.string}}),(function(e){return t.ic_.props.set("selected",e.selected),t.ic_.props.set("title",e.title),!0}))}},{key:"exportState",value:function(){var e=this;return tr((function(){return K(J(n.prototype),"exportState",e).call(e)}),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}},{key:"onItemClick_",value:function(){this.props.set("selected",!0)}}]),n}(Wr),ma=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,e,r)).emitter_=new $t,a.onSelect_=a.onSelect_.bind(j(a)),a.pool_=r,a.rackApi_.on("change",(function(e){a.emitter_.emit("change",e)})),a.controller.tab.selectedIndex.emitter.on("change",a.onSelect_),a}return I(n,[{key:"pages",get:function(){return this.rackApi_.children}},{key:"addPage",value:function(e){var t=this.controller.view.element.ownerDocument,n=new fa(t,{blade:Zr(),itemProps:an.fromObject({selected:!1,title:e.title}),props:an.fromObject({selected:!1}),viewProps:ua.create()}),r=this.pool_.createApi(n);return this.rackApi_.add(r,e.index)}},{key:"removePage",value:function(e){this.rackApi_.remove(this.rackApi_.children[e])}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}},{key:"onSelect_",value:function(e){this.emitter_.emit("select",new Wn(this,e.rawValue))}}]),n}(Jr),ga=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"title",get:function(){var e;return null!==(e=this.controller.itemController.props.get("title"))&&void 0!==e?e:""},set:function(e){this.controller.itemController.props.set("title",e)}},{key:"selected",get:function(){return this.controller.props.get("selected")},set:function(e){this.controller.props.set("selected",e)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addButton",value:function(e){return this.rackApi_.addButton(e)}},{key:"addFolder",value:function(e){return this.rackApi_.addFolder(e)}},{key:"addTab",value:function(e){return this.rackApi_.addTab(e)}},{key:"add",value:function(e,t){this.rackApi_.add(e,t)}},{key:"remove",value:function(e){this.rackApi_.remove(e)}},{key:"addBinding",value:function(e,t,n){return this.rackApi_.addBinding(e,t,n)}},{key:"addBlade",value:function(e){return this.rackApi_.addBlade(e)}}]),n}(Jr),ya=function(){function e(){N(this,e),this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=rn(!0),this.selectedIndex=rn(-1),this.items_=[]}return I(e,[{key:"add",value:function(e,t){var n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}},{key:"remove",value:function(e){var t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}},{key:"keepSelection_",value:function(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);var e=this.items_.findIndex((function(e){return e.rawValue}));e<0?(this.items_.forEach((function(e,t){e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach((function(t,n){t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}},{key:"onItemSelectedChange_",value:function(e){if(e.rawValue){var t=this.items_.findIndex((function(t){return t===e.sender}));this.items_.forEach((function(e,n){e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}]),e}(),ba=gr("tab"),_a=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(ba(),ra()),n.viewProps.bindClassModifiers(this.element),vr(n.empty,Nr(this.element,ba(void 0,"nop")));var r=t.createElement("div");r.classList.add(ba("t")),this.element.appendChild(r),this.itemsElement=r;var a=t.createElement("div");a.classList.add(ba("i")),this.element.appendChild(a);var i=t.createElement("div");i.classList.add(ba("c")),this.element.appendChild(i),this.contentsElement=i})),wa=function(e){F(n,e);var t=U(n);function n(e,r){var a;N(this,n);var i=new ya,o=new _a(e,{empty:i.empty,viewProps:r.viewProps});(a=t.call(this,{blade:r.blade,rackController:new Xr({blade:r.blade,element:o.contentsElement,viewProps:r.viewProps}),view:o})).onRackAdd_=a.onRackAdd_.bind(j(a)),a.onRackRemove_=a.onRackRemove_.bind(j(a));var s=a.rackController.rack;return s.emitter.on("add",a.onRackAdd_),s.emitter.on("remove",a.onRackRemove_),a.tab=i,a}return I(n,[{key:"add",value:function(e,t){this.rackController.rack.add(e,t)}},{key:"remove",value:function(e){this.rackController.rack.remove(this.rackController.rack.children[e])}},{key:"onRackAdd_",value:function(e){if(e.root){var t=e.bladeController;cr(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}}},{key:"onRackRemove_",value:function(e){if(e.root){var t=e.bladeController;dr(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}}]),n}(Wr),Ea=Hr({id:"tab",type:"blade",accept:function(e){var t=$n(e,(function(e){return{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")}}));return t&&0!==t.pages.length?{params:t}:null},controller:function(e){var t=new wa(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((function(n){var r=new fa(e.document,{blade:Zr(),itemProps:an.fromObject({selected:!1,title:n.title}),props:an.fromObject({selected:!1}),viewProps:ua.create()});t.add(r)})),t},api:function(e){return e.controller instanceof wa?new ma(e.controller,e.pool):e.controller instanceof fa?new ga(e.controller,e.pool):null}});function ka(e,t){var n=e.accept(t.params);if(!n)return null;var r=$n(t.params,(function(e){return{disabled:e.optional.boolean,hidden:e.optional.boolean}}));return e.controller({blade:Zr(),document:t.document,params:Object.assign(Object.assign({},n.params),{disabled:null==r?void 0:r.disabled,hidden:null==r?void 0:r.hidden}),viewProps:ua.create({disabled:null==r?void 0:r.disabled,hidden:null==r?void 0:r.hidden})})}var Ca=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"options",get:function(){return this.controller.valueController.props.get("options")},set:function(e){this.controller.valueController.props.set("options",e)}}]),n}(Yn),Sa=function(){function e(){N(this,e),this.disabled=!1,this.emitter=new $t}return I(e,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),e}(),xa=function(){function e(t,n){N(this,e),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new $t,this.interval_=n,this.setTimer_()}return I(e,[{key:"disabled",get:function(){return this.disabled_},set:function(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),e}(),Ta=function(){function e(t){N(this,e),this.constraints=t}return I(e,[{key:"constrain",value:function(e){return this.constraints.reduce((function(e,t){return t.constrain(e)}),e)}}]),e}();function La(e,t){if(e instanceof t)return e;if(e instanceof Ta){var n=e.constraints.reduce((function(e,n){return e||(n instanceof t?n:null)}),null);if(n)return n}return null}var Aa=function(){function e(t){N(this,e),this.values=an.fromObject({options:t})}return I(e,[{key:"constrain",value:function(e){var t=this.values.get("options");return 0===t.length||t.filter((function(t){return t.value===e})).length>0?e:t[0].value}}]),e}();function Pa(e){var t,n=Zn;return Array.isArray(e)?null===(t=$n({items:e},(function(e){return{items:e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))}})))||void 0===t?void 0:t.items:"object"===H(e)?n.required.raw(e).value:void 0}function Ra(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach((function(n){t.push({text:n,value:e[n]})})),t}function Da(e){return Kt(e)?null:new Aa(Ra(e))}var Ia=gr("lst"),Na=function(){function e(t,n){var r=this;N(this,e),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.element=t.createElement("div"),this.element.classList.add(Ia()),n.viewProps.bindClassModifiers(this.element);var a=t.createElement("select");a.classList.add(Ia("s")),n.viewProps.bindDisabled(a),this.element.appendChild(a),this.selectElement=a;var i=t.createElement("div");i.classList.add(Ia("m")),i.appendChild(ur(t,"dropdown")),this.element.appendChild(i),n.value.emitter.on("change",this.onValueChange_),this.value_=n.value,fr(this.props_,"options",(function(e){pr(r.selectElement),e.forEach((function(e){var n=t.createElement("option");n.textContent=e.text,r.selectElement.appendChild(n)})),r.update_()}))}return I(e,[{key:"update_",value:function(){var e=this.props_.get("options").map((function(e){return e.value}));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),Oa=function(){function e(t,n){N(this,e),this.onSelectChange_=this.onSelectChange_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Na(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return I(e,[{key:"onSelectChange_",value:function(e){var t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}},{key:"importProps",value:function(e){var t=this;return er(e,null,(function(e){return{options:e.required.custom(Pa)}}),(function(e){return t.props.set("options",Ra(e.options)),!0}))}},{key:"exportProps",value:function(){return tr(null,{options:this.props.get("options")})}}]),e}(),Ma=gr("pop"),Ba=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(Ma()),n.viewProps.bindClassModifiers(this.element),vr(n.shows,Nr(this.element,Ma(void 0,"v")))})),Fa=I((function e(t,n){N(this,e),this.shows=rn(!1),this.viewProps=n.viewProps,this.view=new Ba(t,{shows:this.shows,viewProps:this.viewProps})})),Ua=gr("txt"),Va=function(){function e(t,n){N(this,e),this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ua()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var r=t.createElement("input");r.classList.add(Ua("i")),r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return I(e,[{key:"refresh",value:function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),e}(),Ga=function(){function e(t,n){N(this,e),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Va(t,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return I(e,[{key:"onInputChange_",value:function(e){var t=e.currentTarget.value,n=this.parser_(t);Kt(n)||(this.value.rawValue=n),this.view.refresh()}}]),e}();function Ha(e){return"false"!==e&&!!e}function ja(e){return function(e){return String(e)}(e)}var Ka=An(0);function Ja(e){return Ka(e)+"%"}function Wa(e){return String(e)}function qa(e){return e}function Ya(e){var t=e.primary,n=e.secondary,r=e.forward,a=e.backward,i=!1;function o(e){i||(i=!0,e(),i=!1)}t.emitter.on("change",(function(e){o((function(){n.setRawValue(r(t.rawValue,n.rawValue),e.options)}))})),n.emitter.on("change",(function(e){o((function(){t.setRawValue(a(t.rawValue,n.rawValue),e.options)})),o((function(){n.setRawValue(r(t.rawValue,n.rawValue),e.options)}))})),o((function(){n.setRawValue(r(t.rawValue,n.rawValue),{forceEmit:!1,last:!0})}))}function za(e,t){var n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function Qa(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function Xa(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function Za(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function $a(e,t){var n,r,a=t.ownerDocument.defaultView,i=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=a&&a.scrollX)&&void 0!==n?n:0)+i.left),y:e.pageY-((null!==(r=a&&a.scrollY)&&void 0!==r?r:0)+i.top)}}var ei=function(){function e(t){N(this,e),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new $t,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}return I(e,[{key:"computePosition_",value:function(e){var t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}},{key:"onMouseDown_",value:function(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_($a(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}},{key:"onDocumentMouseMove_",value:function(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_($a(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}},{key:"onDocumentMouseUp_",value:function(e){var t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_($a(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}},{key:"onTouchStart_",value:function(e){e.preventDefault();var t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}},{key:"onTouchMove_",value:function(e){var t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}},{key:"onTouchEnd_",value:function(e){var t,n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey})}}]),e}(),ti=gr("txt"),ni=function(){function e(t,n){N(this,e),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ti(),ti(void 0,"num")),n.arrayPosition&&this.element.classList.add(ti(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("input");r.classList.add(ti("i")),r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ti()),this.inputElement.classList.add(ti("i"));var a=t.createElement("div");a.classList.add(ti("k")),this.element.appendChild(a),this.knobElement=a;var i=t.createElementNS(ar,"svg");i.classList.add(ti("g")),this.knobElement.appendChild(i);var o=t.createElementNS(ar,"path");o.classList.add(ti("gb")),i.appendChild(o),this.guideBodyElem_=o;var s=t.createElementNS(ar,"path");s.classList.add(ti("gh")),i.appendChild(s),this.guideHeadElem_=s;var l=t.createElement("div");l.classList.add(gr("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return I(e,[{key:"onDraggingChange_",value:function(e){if(null!==e.rawValue){this.element.classList.add(ti(void 0,"drg"));var t=e.rawValue/this.props_.get("pointerScale"),n=t+(t>0?-1:t<0?1:0),r=Dn(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+r,",0 L").concat(n,",4 L").concat(n+r,",8"),"M ".concat(t,",-1 L").concat(t,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(t,",4"));var a=this.props_.get("formatter");this.tooltipElem_.textContent=a(this.value.rawValue),this.tooltipElem_.style.left="".concat(t,"px")}else this.element.classList.remove(ti(void 0,"drg"))}},{key:"refresh",value:function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),e}(),ri=function(){function e(t,n){var r;N(this,e),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=n.parser,this.props=n.props,this.sliderProps_=null!==(r=n.sliderProps)&&void 0!==r?r:null,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=rn(null),this.view=new ni(t,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var a=new ei(this.view.knobElement);a.emitter.on("down",this.onPointerDown_),a.emitter.on("move",this.onPointerMove_),a.emitter.on("up",this.onPointerUp_)}return I(e,[{key:"constrainValue_",value:function(e){var t,n,r=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("min"),a=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("max"),i=e;return void 0!==r&&(i=Math.max(i,r)),void 0!==a&&(i=Math.min(i,a)),i}},{key:"onInputChange_",value:function(e){var t=e.currentTarget.value,n=this.parser_(t);Kt(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}},{key:"onInputKeyDown_",value:function(e){var t=za(this.props.get("keyScale"),Qa(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(e){0!==za(this.props.get("keyScale"),Qa(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(e){if(!e.point)return null;var t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}},{key:"onPointerMove_",value:function(e){var t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(e){var t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),e}(),ai=gr("sld"),ii=function(){function e(t,n){N(this,e),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ai()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(ai("t")),n.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;var a=t.createElement("div");a.classList.add(ai("k")),this.trackElement.appendChild(a),this.knobElement=a,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.update_()}return I(e,[{key:"update_",value:function(){var e=Dn(Pn(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width="".concat(e,"%")}},{key:"onChange_",value:function(){this.update_()}}]),e}(),oi=function(){function e(t,n){N(this,e),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.props=n.props,this.view=new ii(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new ei(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return I(e,[{key:"handlePointerEvent_",value:function(e,t){e.point&&this.value.setRawValue(Pn(Dn(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}},{key:"onPointerDownOrMove_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(e){var t=za(this.props.get("keyScale"),Xa(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(e){0!==za(this.props.get("keyScale"),Xa(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),e}(),si=gr("sldtxt"),li=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(si());var r=t.createElement("div");r.classList.add(si("s")),this.sliderView_=n.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);var a=t.createElement("div");a.classList.add(si("t")),this.textView_=n.textView,a.appendChild(this.textView_.element),this.element.appendChild(a)})),ui=function(){function e(t,n){N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.sliderC_=new oi(t,{props:n.sliderProps,value:n.value,viewProps:this.viewProps}),this.textC_=new ri(t,{parser:n.parser,props:n.textProps,sliderProps:n.sliderProps,value:n.value,viewProps:n.viewProps}),this.view=new li(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return I(e,[{key:"sliderController",get:function(){return this.sliderC_}},{key:"textController",get:function(){return this.textC_}},{key:"importProps",value:function(e){var t=this;return er(e,null,(function(e){return{max:e.required.number,min:e.required.number}}),(function(e){var n=t.sliderC_.props;return n.set("max",e.max),n.set("min",e.min),!0}))}},{key:"exportProps",value:function(){var e=this.sliderC_.props;return tr(null,{max:e.get("max"),min:e.get("min")})}}]),e}();function ci(e){return{sliderProps:new an({keyScale:e.keyScale,max:e.max,min:e.min}),textProps:new an({formatter:rn(e.formatter),keyScale:e.keyScale,pointerScale:rn(e.pointerScale)})}}var di={containerUnitSize:"cnt-usz"};function pi(e){return"--".concat(di[e])}function hi(e){return Vn(e)}function vi(e){if(Wt(e))return $n(e,hi)}function fi(e,t){if(e){var n=[],r=Bn(e,t);r&&n.push(r);var a=Fn(e);return a&&n.push(a),new Ta(n)}}function mi(e){if("inline"===e||"popup"===e)return e}function gi(e,t){e.write(t)}var yi=gr("ckb"),bi=function(){function e(t,n){N(this,e),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(yi()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("label");r.classList.add(yi("l")),this.element.appendChild(r),this.labelElement=r;var a=t.createElement("input");a.classList.add(yi("i")),a.type="checkbox",this.labelElement.appendChild(a),this.inputElement=a,n.viewProps.bindDisabled(this.inputElement);var i=t.createElement("div");i.classList.add(yi("w")),this.labelElement.appendChild(i);var o=ur(t,"check");i.appendChild(o),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return I(e,[{key:"update_",value:function(){this.inputElement.checked=this.value.rawValue}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),_i=function(){function e(t,n){N(this,e),this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new bi(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}return I(e,[{key:"onInputChange_",value:function(e){var t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}},{key:"onLabelMouseDown_",value:function(e){e.preventDefault()}}]),e}();var wi=Hr({id:"input-bool",type:"input",accept:function(e,t){if("boolean"!=typeof e)return null;var n=$n(t,(function(e){return{options:e.optional.custom(Pa),readonly:e.optional.constant(!1)}}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Ha},constraint:function(e){return t=e.params,n=[],(r=Da(t.options))&&n.push(r),new Ta(n);var t,n,r},writer:function(e){return gi}},controller:function(e){var t=e.document,n=e.value,r=e.constraint,a=r&&La(r,Aa);return a?new Oa(t,{props:new an({options:a.values.value("options")}),value:n,viewProps:e.viewProps}):new _i(t,{value:n,viewProps:e.viewProps})},api:function(e){return"boolean"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Oa?new Ca(e.controller):null}}),Ei=gr("col"),ki=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(Ei()),n.foldable.bindExpandedClass(this.element,Ei(void 0,"expanded")),fr(n.foldable,"completed",Nr(this.element,Ei(void 0,"cpl")));var r=t.createElement("div");r.classList.add(Ei("h")),this.element.appendChild(r);var a=t.createElement("div");a.classList.add(Ei("s")),r.appendChild(a),this.swatchElement=a;var i=t.createElement("div");if(i.classList.add(Ei("t")),r.appendChild(i),this.textElement=i,"inline"===n.pickerLayout){var o=t.createElement("div");o.classList.add(Ei("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}));function Ci(e,t,n){var r,a,i,o=In(e,360),s=Dn(t/100,0,1),l=Dn(n/100,0,1),u=l*s,c=u*(1-Math.abs(o/60%2-1)),d=l-u;return o>=0&&o<60?(r=u,a=c,i=0):o>=60&&o<120?(r=c,a=u,i=0):o>=120&&o<180?(r=0,a=u,i=c):o>=180&&o<240?(r=0,a=c,i=u):o>=240&&o<300?(r=c,a=0,i=u):(r=u,a=0,i=c),[255*(r+d),255*(a+d),255*(i+d)]}function Si(e){return[e[0],e[1],e[2]]}function xi(e,t){return[e[0],e[1],e[2],t]}var Ti={hsl:{hsl:function(e,t,n){return[e,t,n]},hsv:function(e,t,n){var r=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==r?t*(100-Math.abs(2*n-100))/r:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){var r,a,i,o=(e%360+360)%360,s=Dn(t/100,0,1),l=Dn(n/100,0,1),u=(1-Math.abs(2*l-1))*s,c=u*(1-Math.abs(o/60%2-1)),d=l-u/2;return o>=0&&o<60?(r=u,a=c,i=0):o>=60&&o<120?(r=c,a=u,i=0):o>=120&&o<180?(r=0,a=u,i=c):o>=180&&o<240?(r=0,a=c,i=u):o>=240&&o<300?(r=c,a=0,i=u):(r=u,a=0,i=c),[255*(r+d),255*(a+d),255*(i+d)]}},hsv:{hsl:function(e,t,n){var r=100-Math.abs(n*(200-t)/100-100);return[e,0!==r?t*n/r:0,n*(200-t)/200]},hsv:function(e,t,n){return[e,t,n]},rgb:Ci},rgb:{hsl:function(e,t,n){var r=Dn(e/255,0,1),a=Dn(t/255,0,1),i=Dn(n/255,0,1),o=Math.max(r,a,i),s=Math.min(r,a,i),l=o-s,u=0,c=0,d=(s+o)/2;return 0!==l&&(c=l/(1-Math.abs(o+s-1)),u=(u=r===o?(a-i)/l:a===o?2+(i-r)/l:4+(r-a)/l)/6+(u<0?1:0)),[360*u,100*c,100*d]},hsv:function(e,t,n){var r=Dn(e/255,0,1),a=Dn(t/255,0,1),i=Dn(n/255,0,1),o=Math.max(r,a,i),s=o-Math.min(r,a,i);return[0===s?0:o===r?((a-i)/s%6+6)%6*60:o===a?60*((i-r)/s+2):60*((r-a)/s+4),100*(0===o?0:s/o),100*o]},rgb:function(e,t,n){return[e,t,n]}}};function Li(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function Ai(e,t,n){var r,a,i,o=Li(t,n);return["rgb"===t?Dn(e[0],0,o[0]):(a=e[0],i=o[0],a===i?i:In(a,i)),Dn(e[1],0,o[1]),Dn(e[2],0,o[2]),Dn(null!==(r=e[3])&&void 0!==r?r:1,0,1)]}function Pi(e,t,n,r){var a=Li(t,n),i=Li(t,r);return e.map((function(e,t){return e/a[t]*i[t]}))}function Ri(e,t,n){var r,a=Pi(e,t.mode,t.type,"int");return Pi((r=Ti[t.mode])[n.mode].apply(r,M(a)),n.mode,"int",n.type)}var Di=function(){function e(t,n){N(this,e),this.type="int",this.mode=n,this.comps_=Ai(t,n,this.type)}return I(e,[{key:"getComponents",value:function(e){return xi(Ri(Si(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}},{key:"toRgbaObject",value:function(){var e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}],[{key:"black",value:function(){return new e([0,0,0],"rgb")}}]),e}(),Ii=gr("colp"),Ni=function(){function e(t,n){N(this,e),this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Ii()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(Ii("hsv"));var a=t.createElement("div");a.classList.add(Ii("sv")),this.svPaletteView_=n.svPaletteView,a.appendChild(this.svPaletteView_.element),r.appendChild(a);var i=t.createElement("div");i.classList.add(Ii("h")),this.hPaletteView_=n.hPaletteView,i.appendChild(this.hPaletteView_.element),r.appendChild(i),this.element.appendChild(r);var o=t.createElement("div");if(o.classList.add(Ii("rgb")),this.textsView_=n.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),n.alphaViews){this.alphaViews_={palette:n.alphaViews.palette,text:n.alphaViews.text};var s=t.createElement("div");s.classList.add(Ii("a"));var l=t.createElement("div");l.classList.add(Ii("ap")),l.appendChild(this.alphaViews_.palette.element),s.appendChild(l);var u=t.createElement("div");u.classList.add(Ii("at")),u.appendChild(this.alphaViews_.text.element),s.appendChild(u),this.element.appendChild(s)}}return I(e,[{key:"allFocusableElements",get:function(){var e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement].concat(M(this.textsView_.inputViews.map((function(e){return e.inputElement}))));return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}]),e}();function Oi(e){return"int"===e?"int":"float"===e?"float":void 0}function Mi(e){return $n(e,(function(e){return{color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Oi)}),expanded:e.optional.boolean,picker:e.optional.custom(mi),readonly:e.optional.constant(!1)}}))}function Bi(e){return e?.1:1}function Fi(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}var Ui=function(){function e(t,n){N(this,e),this.type="float",this.mode=n,this.comps_=Ai(t,n,this.type)}return I(e,[{key:"getComponents",value:function(e){return xi(Ri(Si(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}},{key:"toRgbaObject",value:function(){var e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}]),e}(),Vi={int:function(e,t){return new Di(e,t)},float:function(e,t){return new Ui(e,t)}};function Gi(e,t,n){return Vi[n](e,t)}function Hi(e,t){if(e.type===t)return e;if(function(e){return"int"===e.type}(e)&&"float"===t)return r=(n=e).getComponents(),a=Li(n.mode,"int"),new Ui([Pn(r[0],0,a[0],0,1),Pn(r[1],0,a[1],0,1),Pn(r[2],0,a[2],0,1),r[3]],n.mode);var n,r,a;if(function(e){return"float"===e.type}(e)&&"int"===t)return function(e){var t=e.getComponents(),n=Li(e.mode,"int");return new Di([Math.round(Pn(t[0],0,1,0,n[0])),Math.round(Pn(t[1],0,1,0,n[1])),Math.round(Pn(t[2],0,1,0,n[2])),t[3]],e.mode)}(e);throw Xt.shouldNeverHappen()}function ji(e,t){var n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}var Ki={deg:function(e){return e},grad:function(e){return 360*e/400},rad:function(e){return 360*e/(2*Math.PI)},turn:function(e){return 360*e}};function Ji(e){var t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);var n=parseFloat(t[1]),r=t[2];return Ki[r](n)}function Wi(e){var t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;var n=[ji(t[1],255),ji(t[2],255),ji(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function qi(e){var t=Wi(e);return t?new Di(t,"rgb"):null}function Yi(e){var t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;var n=[ji(t[1],255),ji(t[2],255),ji(t[3],255),ji(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function zi(e){var t=Yi(e);return t?new Di(t,"rgb"):null}function Qi(e){var t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;var n=[Ji(t[1]),ji(t[2],100),ji(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Xi(e){var t=Qi(e);return t?new Di(t,"hsl"):null}function Zi(e){var t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;var n=[Ji(t[1]),ji(t[2],100),ji(t[3],100),ji(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function $i(e){var t=Zi(e);return t?new Di(t,"hsl"):null}function eo(e){var t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];var n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function to(e){var t=eo(e);return t?new Di(t,"rgb"):null}function no(e){var t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),Pn(parseInt(t[4]+t[4],16),0,255,0,1)];var n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Pn(parseInt(n[4],16),0,255,0,1)]:null}function ro(e){var t=no(e);return t?new Di(t,"rgb"):null}function ao(e){var t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;var n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function io(e){return function(t){var n=ao(t);return n?Gi(n,"rgb",e):null}}function oo(e){var t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;var n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function so(e){return function(t){var n=oo(t);return n?Gi(n,"rgb",e):null}}var lo=[{parser:eo,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:no,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Wi,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Yi,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Qi,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Zi,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:ao,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:oo,result:{alpha:!0,mode:"rgb",notation:"object"}}];function uo(e){return lo.reduce((function(t,n){var r=n.parser,a=n.result;return t||(r(e)?a:null)}),null)}function co(e){var t=[to,ro,qi,zi,Xi,$i];"int"===e&&t.push(io("int"),so("int")),"float"===e&&t.push(io("float"),so("float"));var n=function(e){return function(t){return e.reduce((function(e,n){return null!==e?e:n(t)}),null)}}(t);return function(t){var r=n(t);return r?Hi(r,e):null}}function po(e){var t=co("int");if("string"!=typeof e)return Di.black();var n=t(e);return null!=n?n:Di.black()}function ho(e){var t=Dn(Math.floor(e),0,255).toString(16);return 1===t.length?"0".concat(t):t}function vo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=Si(e.getComponents("rgb")).map(ho).join("");return"".concat(t).concat(n)}function fo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=e.getComponents("rgb"),r=[n[0],n[1],n[2],255*n[3]].map(ho).join("");return"".concat(t).concat(r)}function mo(e){var t=An(0),n=Si(Hi(e,"int").getComponents("rgb")).map((function(e){return t(e)}));return"rgb(".concat(n.join(", "),")")}function go(e){var t=An(2),n=An(0),r=Hi(e,"int").getComponents("rgb").map((function(e,r){return(3===r?t:n)(e)}));return"rgba(".concat(r.join(", "),")")}function yo(e,t){var n=An("float"===t?2:0),r=["r","g","b"],a=Si(Hi(e,t).getComponents("rgb")).map((function(e,t){return"".concat(r[t],": ").concat(n(e))}));return"{".concat(a.join(", "),"}")}function bo(e){return function(t){return yo(t,e)}}function _o(e,t){var n=An(2),r=An("float"===t?2:0),a=["r","g","b","a"],i=Hi(e,t).getComponents("rgb").map((function(e,t){var i=3===t?n:r;return"".concat(a[t],": ").concat(i(e))}));return"{".concat(i.join(", "),"}")}function wo(e){return function(t){return _o(t,e)}}var Eo=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:vo},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:fo},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:mo},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:go},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){var t=[An(0),Ja,Ja],n=Si(Hi(e,"int").getComponents("hsl")).map((function(e,n){return t[n](e)}));return"hsl(".concat(n.join(", "),")")}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){var t=[An(0),Ja,Ja,An(2)],n=Hi(e,"int").getComponents("hsl").map((function(e,n){return t[n](e)}));return"hsla(".concat(n.join(", "),")")}}].concat(M(["int","float"].reduce((function(e,t){return[].concat(M(e),[{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:bo(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:wo(t)}])}),[])));function ko(e){return Eo.reduce((function(t,n){return t||(r=n.format,a=e,r.alpha===a.alpha&&r.mode===a.mode&&r.notation===a.notation&&r.type===a.type?n.stringifier:null);var r,a}),null)}var Co=gr("apl"),So=function(){function e(t,n){N(this,e),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Co()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=t.createElement("div");r.classList.add(Co("b")),this.element.appendChild(r);var a=t.createElement("div");a.classList.add(Co("c")),r.appendChild(a),this.colorElem_=a;var i=t.createElement("div");i.classList.add(Co("m")),this.element.appendChild(i),this.markerElem_=i;var o=t.createElement("div");o.classList.add(Co("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return I(e,[{key:"update_",value:function(){var e=this.value.rawValue,t=e.getComponents("rgb"),n=new Di([t[0],t[1],t[2],0],"rgb"),r=new Di([t[0],t[1],t[2],255],"rgb"),a=["to right",go(n),go(r)];this.colorElem_.style.background="linear-gradient(".concat(a.join(","),")"),this.previewElem_.style.backgroundColor=go(e);var i=Pn(t[3],0,1,0,100);this.markerElem_.style.left="".concat(i,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),xo=function(){function e(t,n){N(this,e),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new So(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new ei(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return I(e,[{key:"handlePointerEvent_",value:function(e,t){if(e.point){var n=e.point.x/e.bounds.width,r=this.value.rawValue.getComponents("hsv"),a=W(r,3),i=a[0],o=a[1],s=a[2];this.value.setRawValue(new Di([i,o,s,n],"hsv"),t)}}},{key:"onPointerDown_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(e){var t=za(Bi(!0),Xa(e));if(0!==t){var n=this.value.rawValue.getComponents("hsv"),r=W(n,4),a=r[0],i=r[1],o=r[2],s=r[3];this.value.setRawValue(new Di([a,i,o,s+t],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(e){0!==za(Bi(!0),Xa(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),e}(),To=gr("coltxt");var Lo=function(){function e(t,n){var r=this;N(this,e),this.element=t.createElement("div"),this.element.classList.add(To()),n.viewProps.bindClassModifiers(this.element);var a=t.createElement("div");a.classList.add(To("m")),this.modeElem_=function(e){var t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce((function(t,n){var r=e.createElement("option");return r.textContent=n.text,r.value=n.value,t.appendChild(r),t}),e.createDocumentFragment())),t}(t),this.modeElem_.classList.add(To("ms")),a.appendChild(this.modeSelectElement),n.viewProps.bindDisabled(this.modeElem_);var i=t.createElement("div");i.classList.add(To("mm")),i.appendChild(ur(t,"dropdown")),a.appendChild(i),this.element.appendChild(a);var o=t.createElement("div");o.classList.add(To("w")),this.element.appendChild(o),this.inputsElem_=o,this.inputViews_=n.inputViews,this.applyInputViews_(),vr(n.mode,(function(e){r.modeElem_.value=e}))}return I(e,[{key:"modeSelectElement",get:function(){return this.modeElem_}},{key:"inputViews",get:function(){return this.inputViews_},set:function(e){this.inputViews_=e,this.applyInputViews_()}},{key:"applyInputViews_",value:function(){var e=this;pr(this.inputsElem_);var t=this.element.ownerDocument;this.inputViews_.forEach((function(n){var r=t.createElement("div");r.classList.add(To("c")),r.appendChild(n.element),e.inputsElem_.appendChild(r)}))}}]),e}();function Ao(e,t,n){var r=Li(e,t)[n];return new on({min:0,max:r})}function Po(e,t){var n={colorMode:t.colorMode,colorType:t.colorType,parser:xn,viewProps:t.viewProps};return[0,1,2].map((function(r){var a=function(e,t,n){return new ri(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",parser:t.parser,props:an.fromObject({formatter:(r=t.colorType,An("float"===r?2:0)),keyScale:Bi(!1),pointerScale:"float"===t.colorType?.01:1}),value:rn(0,{constraint:Ao(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var r}(e,n,r);return Ya({primary:t.value,secondary:a.value,forward:function(e){return Hi(e,t.colorType).getComponents(t.colorMode)[r]},backward:function(e,n){var a=t.colorMode,i=Hi(e,t.colorType).getComponents(a);return i[r]=n,Hi(Gi(xi(Si(i),i[3]),a,t.colorType),"int")}}),a}))}var Ro=function(){function e(t,n){N(this,e),this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=n.colorType,this.value=n.value,this.viewProps=n.viewProps,this.colorMode=rn(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new Lo(t,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return I(e,[{key:"createComponentControllers_",value:function(e){var t=this.colorMode.rawValue;return function(e){return"hex"!==e}(t)?Po(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(e,t){var n=new Ga(e,{parser:co("int"),props:an.fromObject({formatter:vo}),value:rn(Di.black()),viewProps:t.viewProps});return Ya({primary:t.value,secondary:n.value,forward:function(e){return new Di(Si(e.getComponents()),e.mode)},backward:function(e,t){return new Di(xi(Si(t.getComponents(e.mode)),e.getComponents()[3]),e.mode)}}),[n]}(e,{value:this.value,viewProps:this.viewProps})}},{key:"onModeSelectChange_",value:function(e){var t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((function(e){return e.view}))}}]),e}(),Do=gr("hpl"),Io=function(){function e(t,n){N(this,e),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Do()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=t.createElement("div");r.classList.add(Do("c")),this.element.appendChild(r);var a=t.createElement("div");a.classList.add(Do("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}return I(e,[{key:"update_",value:function(){var e=this.value.rawValue.getComponents("hsv"),t=W(e,1)[0];this.markerElem_.style.backgroundColor=mo(new Di([t,100,100],"hsv"));var n=Pn(t,0,360,0,100);this.markerElem_.style.left="".concat(n,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),No=function(){function e(t,n){N(this,e),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Io(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new ei(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return I(e,[{key:"handlePointerEvent_",value:function(e,t){if(e.point){var n=Pn(Dn(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),r=this.value.rawValue.getComponents("hsv"),a=W(r,4),i=a[1],o=a[2],s=a[3];this.value.setRawValue(new Di([n,i,o,s],"hsv"),t)}}},{key:"onPointerDown_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(e){var t=za(Bi(!1),Xa(e));if(0!==t){var n=this.value.rawValue.getComponents("hsv"),r=W(n,4),a=r[0],i=r[1],o=r[2],s=r[3];this.value.setRawValue(new Di([a+t,i,o,s],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(e){0!==za(Bi(!1),Xa(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),e}(),Oo=gr("svp"),Mo=function(){function e(t,n){N(this,e),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Oo()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=t.createElement("canvas");r.height=64,r.width=64,r.classList.add(Oo("c")),this.element.appendChild(r),this.canvasElement=r;var a=t.createElement("div");a.classList.add(Oo("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}return I(e,[{key:"update_",value:function(){var e,t,n=(e=this.canvasElement,(t=e.ownerDocument.defaultView)&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null);if(n){for(var r=this.value.rawValue.getComponents("hsv"),a=this.canvasElement.width,i=this.canvasElement.height,o=n.getImageData(0,0,a,i),s=o.data,l=0;l<i;l++)for(var u=0;u<a;u++){var c=Pn(u,0,a,0,100),d=Pn(l,0,i,100,0),p=Ci(r[0],c,d),h=4*(l*a+u);s[h]=p[0],s[h+1]=p[1],s[h+2]=p[2],s[h+3]=255}n.putImageData(o,0,0);var v=Pn(r[1],0,100,0,100);this.markerElem_.style.left="".concat(v,"%");var f=Pn(r[2],0,100,100,0);this.markerElem_.style.top="".concat(f,"%")}}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),Bo=function(){function e(t,n){N(this,e),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Mo(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new ei(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return I(e,[{key:"handlePointerEvent_",value:function(e,t){if(e.point){var n=Pn(e.point.x,0,e.bounds.width,0,100),r=Pn(e.point.y,0,e.bounds.height,100,0),a=this.value.rawValue.getComponents("hsv"),i=W(a,4),o=i[0],s=i[3];this.value.setRawValue(new Di([o,n,r,s],"hsv"),t)}}},{key:"onPointerDown_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(e){Za(e.key)&&e.preventDefault();var t=this.value.rawValue.getComponents("hsv"),n=W(t,4),r=n[0],a=n[1],i=n[2],o=n[3],s=Bi(!1),l=za(s,Xa(e)),u=za(s,Qa(e));0===l&&0===u||this.value.setRawValue(new Di([r,a+l,i+u,o],"hsv"),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(e){var t=Bi(!1),n=za(t,Xa(e)),r=za(t,Qa(e));0===n&&0===r||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),e}(),Fo=function(){function e(t,n){N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.hPaletteC_=new No(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Bo(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=n.supportsAlpha?{palette:new xo(t,{value:this.value,viewProps:this.viewProps}),text:new ri(t,{parser:xn,props:an.fromObject({pointerScale:.01,keyScale:.1,formatter:An(2)}),value:rn(0,{constraint:new on({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ya({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(e){return e.getComponents()[3]},backward:function(e,t){var n=e.getComponents();return n[3]=t,new Di(n,e.mode)}}),this.textsC_=new Ro(t,{colorType:n.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Ni(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:n.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}return I(e,[{key:"textsController",get:function(){return this.textsC_}}]),e}(),Uo=gr("colsw"),Vo=function(){function e(t,n){N(this,e),this.onValueChange_=this.onValueChange_.bind(this),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.element=t.createElement("div"),this.element.classList.add(Uo()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(Uo("sw")),this.element.appendChild(r),this.swatchElem_=r;var a=t.createElement("button");a.classList.add(Uo("b")),n.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a,this.update_()}return I(e,[{key:"update_",value:function(){var e=this.value.rawValue;this.swatchElem_.style.backgroundColor=fo(e)}},{key:"onValueChange_",value:function(){this.update_()}}]),e}(),Go=I((function e(t,n){N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.view=new Vo(t,{value:this.value,viewProps:this.viewProps})})),Ho=function(){function e(t,n){var r=this;N(this,e),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=$r.create(n.expanded),this.swatchC_=new Go(t,{value:this.value,viewProps:this.viewProps});var a=this.swatchC_.view.buttonElement;a.addEventListener("blur",this.onButtonBlur_),a.addEventListener("click",this.onButtonClick_),this.textC_=new Ga(t,{parser:n.parser,props:an.fromObject({formatter:n.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new ki(t,{foldable:this.foldable_,pickerLayout:n.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===n.pickerLayout?new Fa(t,{viewProps:this.viewProps}):null;var i=new Fo(t,{colorType:n.colorType,supportsAlpha:n.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((function(e){e.addEventListener("blur",r.onPopupChildBlur_),e.addEventListener("keydown",r.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Ya({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(e){return e},backward:function(e,t){return t}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ta(this.foldable_,this.view.pickerElement))}return I(e,[{key:"textController",get:function(){return this.textC_}},{key:"onButtonBlur_",value:function(e){if(this.popC_){var t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(e){if(this.popC_){var t=this.popC_.view.element,n=hr(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!or(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}]),e}();function jo(e){return Si(e.getComponents("rgb")).reduce((function(e,t){return e<<8|255&Math.floor(t)}),0)}function Ko(e){return e.getComponents("rgb").reduce((function(e,t,n){return e<<8|255&Math.floor(3===n?255*t:t)}),0)>>>0}function Jo(e){return"number"!=typeof e?Di.black():new Di([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function Wo(e){return"number"!=typeof e?Di.black():new Di([(t=e)>>24&255,t>>16&255,t>>8&255,Pn(255&t,0,255,0,1)],"rgb");var t}function qo(e,t){return"object"===H(e)&&!Kt(e)&&(t in e&&"number"==typeof e[t])}function Yo(e){return qo(e,"r")&&qo(e,"g")&&qo(e,"b")}function zo(e){return Yo(e)&&qo(e,"a")}function Qo(e){return Yo(e)}function Xo(e,t){if(e.mode!==t.mode)return!1;if(e.type!==t.type)return!1;for(var n=e.getComponents(),r=t.getComponents(),a=0;a<n.length;a++)if(n[a]!==r[a])return!1;return!0}function Zo(e){return"a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b]}function $o(e,t){return function(n,r){e?function(e,t,n){var r=Hi(t,n).toRgbaObject();e.writeProperty("r",r.r),e.writeProperty("g",r.g),e.writeProperty("b",r.b),e.writeProperty("a",r.a)}(n,r,t):function(e,t,n){var r=Hi(t,n).toRgbaObject();e.writeProperty("r",r.r),e.writeProperty("g",r.g),e.writeProperty("b",r.b)}(n,r,t)}}var es=Hr({id:"input-color-number",type:"input",accept:function(e,t){if("number"!=typeof e)return null;if(!function(e){return"color"in e||"color"===e.view}(t))return null;var n,r,a=Mi(t);return a?{initialValue:e,params:Object.assign(Object.assign({},a),{supportsAlpha:(n=t,!!(null===(r=null==n?void 0:n.color)||void 0===r?void 0:r.alpha))})}:null},binding:{reader:function(e){return e.params.supportsAlpha?Wo:Jo},equals:Xo,writer:function(e){return t=e.params.supportsAlpha,n=t?Ko:jo,function(e,t){gi(e,n(t))};var t,n}},controller:function(e){var t,n,r;return new Ho(e.document,{colorType:"int",expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:(r=e.params.supportsAlpha,r?function(e){return fo(e,"0x")}:function(e){return vo(e,"0x")}),parser:co("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.supportsAlpha,value:e.value,viewProps:e.viewProps})}});function ts(e){return function(t){var n=function(e,t){if(!Qo(e))return Hi(Di.black(),t);if("int"===t){var n=Zo(e);return new Di(n,"rgb")}if("float"===t){var r=Zo(e);return new Ui(r,"rgb")}return Hi(Di.black(),"int")}(t,e);return Hi(n,"int")}}function ns(e,t){return function(n){return e?_o(n,t):yo(n,t)}}var rs=Hr({id:"input-color-object",type:"input",accept:function(e,t){var n;if(!Qo(e))return null;var r=Mi(t);return r?{initialValue:e,params:Object.assign(Object.assign({},r),{colorType:null!==(n=Fi(t))&&void 0!==n?n:"int"})}:null},binding:{reader:function(e){return ts(e.params.colorType)},equals:Xo,writer:function(e){return $o(zo(e.initialValue),e.params.colorType)}},controller:function(e){var t,n,r=zo(e.initialValue);return new Ho(e.document,{colorType:e.params.colorType,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:ns(r,e.params.colorType),parser:co("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:r,value:e.value,viewProps:e.viewProps})}}),as=Hr({id:"input-color-string",type:"input",accept:function(e,t){if("string"!=typeof e)return null;if("text"===t.view)return null;var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int",n=uo(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}(e,Fi(t));if(!n)return null;var r=ko(n);if(!r)return null;var a=Mi(t);return a?{initialValue:e,params:Object.assign(Object.assign({},a),{format:n,stringifier:r})}:null},binding:{reader:function(){return po},equals:Xo,writer:function(e){var t,n,r=(t=e.params.format,(n=ko(t))?function(e,t){gi(e,n(t))}:null);if(!r)throw Xt.notBindable();return r}},controller:function(e){var t,n;return new Ho(e.document,{colorType:e.params.format.type,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:e.params.stringifier,parser:co("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.format.alpha,value:e.value,viewProps:e.viewProps})}}),is=function(){function e(t){N(this,e),this.components=t.components,this.asm_=t.assembly}return I(e,[{key:"constrain",value:function(e){var t=this,n=this.asm_.toComponents(e).map((function(e,n){var r,a;return null!==(a=null===(r=t.components[n])||void 0===r?void 0:r.constrain(e))&&void 0!==a?a:e}));return this.asm_.fromComponents(n)}}]),e}(),os=gr("pndtxt"),ss=I((function e(t,n){var r=this;N(this,e),this.textViews=n.textViews,this.element=t.createElement("div"),this.element.classList.add(os()),this.textViews.forEach((function(e){var n=t.createElement("div");n.classList.add(os("a")),n.appendChild(e.element),r.element.appendChild(n)}))}));var ls=function(){function e(t,n){var r=this;N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(e,r){return function(e,t,n){return new ri(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[n].textProps,value:rn(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(t,n,r)})),this.acs_.forEach((function(e,t){Ya({primary:r.value,secondary:e.value,forward:function(e){return n.assembly.toComponents(e)[t]},backward:function(e,r){var a=n.assembly.toComponents(e);return a[t]=r,n.assembly.fromComponents(a)}})})),this.view=new ss(t,{textViews:this.acs_.map((function(e){return e.view}))})}return I(e,[{key:"textControllers",get:function(){return this.acs_}}]),e}(),us=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"max",get:function(){return this.controller.valueController.sliderController.props.get("max")},set:function(e){this.controller.valueController.sliderController.props.set("max",e)}},{key:"min",get:function(){return this.controller.valueController.sliderController.props.get("min")},set:function(e){this.controller.valueController.sliderController.props.set("min",e)}}]),n}(Yn);var cs=Hr({id:"input-number",type:"input",accept:function(e,t){if("number"!=typeof e)return null;var n=$n(t,(function(e){return Object.assign(Object.assign({},Vn(e)),{options:e.optional.custom(Pa),readonly:e.optional.constant(!1)})}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Tn},constraint:function(e){return function(e,t){var n=[],r=Bn(e,t);r&&n.push(r);var a=Fn(e);a&&n.push(a);var i=Da(e.options);return i&&n.push(i),new Ta(n)}(e.params,e.initialValue)},writer:function(e){return gi}},controller:function(e){var t=e.value,n=e.constraint,r=n&&La(n,Aa);if(r)return new Oa(e.document,{props:new an({options:r.values.value("options")}),value:t,viewProps:e.viewProps});var a=Un(e.params,t.rawValue),i=n&&La(n,on);return i?new ui(e.document,Object.assign(Object.assign({},ci(Object.assign(Object.assign({},a),{keyScale:rn(a.keyScale),max:i.values.value("max"),min:i.values.value("min")}))),{parser:xn,value:t,viewProps:e.viewProps})):new ri(e.document,{parser:xn,props:an.fromObject(a),value:t,viewProps:e.viewProps})},api:function(e){return"number"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof ui?new us(e.controller):e.controller.valueController instanceof Oa?new Ca(e.controller):null}}),ds=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;N(this,e),this.x=t,this.y=n}return I(e,[{key:"getComponents",value:function(){return[this.x,this.y]}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}],[{key:"isObject",value:function(e){if(Kt(e))return!1;var t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}},{key:"equals",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),e}(),ps={toComponents:function(e){return e.getComponents()},fromComponents:function(e){return q(ds,M(e))}},hs=gr("p2d"),vs=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(hs()),n.viewProps.bindClassModifiers(this.element),vr(n.expanded,Nr(this.element,hs(void 0,"expanded")));var r=t.createElement("div");r.classList.add(hs("h")),this.element.appendChild(r);var a=t.createElement("button");a.classList.add(hs("b")),a.appendChild(ur(t,"p2dpad")),n.viewProps.bindDisabled(a),r.appendChild(a),this.buttonElement=a;var i=t.createElement("div");if(i.classList.add(hs("t")),r.appendChild(i),this.textElement=i,"inline"===n.pickerLayout){var o=t.createElement("div");o.classList.add(hs("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null})),fs=gr("p2dp"),ms=function(){function e(t,n){N(this,e),this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=t.createElement("div"),this.element.classList.add(fs()),"popup"===n.layout&&this.element.classList.add(fs(void 0,"p")),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(fs("p")),n.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;var a=t.createElementNS(ar,"svg");a.classList.add(fs("g")),this.padElement.appendChild(a),this.svgElem_=a;var i=t.createElementNS(ar,"line");i.classList.add(fs("ax")),i.setAttributeNS(null,"x1","0"),i.setAttributeNS(null,"y1","50%"),i.setAttributeNS(null,"x2","100%"),i.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(i);var o=t.createElementNS(ar,"line");o.classList.add(fs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var s=t.createElementNS(ar,"line");s.classList.add(fs("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;var l=t.createElement("div");l.classList.add(fs("m")),this.padElement.appendChild(l),this.markerElem_=l,n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return I(e,[{key:"allFocusableElements",get:function(){return[this.padElement]}},{key:"update_",value:function(){var e=this.value.rawValue.getComponents(),t=W(e,2),n=t[0],r=t[1],a=this.props_.get("max"),i=Pn(n,-a,+a,0,100),o=Pn(r,-a,+a,0,100),s=this.props_.get("invertsY")?100-o:o;this.lineElem_.setAttributeNS(null,"x2","".concat(i,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(s,"%")),this.markerElem_.style.left="".concat(i,"%"),this.markerElem_.style.top="".concat(s,"%")}},{key:"onValueChange_",value:function(){this.update_()}},{key:"onPropsChange_",value:function(){this.update_()}},{key:"onFoldableChange_",value:function(){this.update_()}}]),e}();function gs(e,t,n){return[za(t[0],Xa(e)),za(t[1],Qa(e))*(n?1:-1)]}var ys=function(){function e(t,n){N(this,e),this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new ms(t,{layout:n.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new ei(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return I(e,[{key:"handlePointerEvent_",value:function(e,t){if(e.point){var n=this.props.get("max"),r=Pn(e.point.x,0,e.bounds.width,-n,+n),a=Pn(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new ds(r,a),t)}}},{key:"onPointerDown_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}},{key:"onPadKeyDown_",value:function(e){Za(e.key)&&e.preventDefault();var t=gs(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY")),n=W(t,2),r=n[0],a=n[1];0===r&&0===a||this.value.setRawValue(new ds(this.value.rawValue.x+r,this.value.rawValue.y+a),{forceEmit:!1,last:!1})}},{key:"onPadKeyUp_",value:function(e){var t=gs(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY")),n=W(t,2),r=n[0],a=n[1];0===r&&0===a||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),e}(),bs=function(){function e(t,n){var r,a,i=this;N(this,e),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=$r.create(n.expanded),this.popC_="popup"===n.pickerLayout?new Fa(t,{viewProps:this.viewProps}):null;var o=new ys(t,{layout:n.pickerLayout,props:new an({invertsY:rn(n.invertsY),max:rn(n.max),xKeyScale:n.axes[0].textProps.value("keyScale"),yKeyScale:n.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach((function(e){e.addEventListener("blur",i.onPopupChildBlur_),e.addEventListener("keydown",i.onPopupChildKeydown_)})),this.pickerC_=o,this.textC_=new ls(t,{assembly:ps,axes:n.axes,parser:n.parser,value:this.value,viewProps:this.viewProps}),this.view=new vs(t,{expanded:this.foldable_.value("expanded"),pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("blur",this.onPadButtonBlur_),null===(a=this.view.buttonElement)||void 0===a||a.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ya({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(e){return e},backward:function(e,t){return t}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ta(this.foldable_,this.view.pickerElement))}return I(e,[{key:"textController",get:function(){return this.textC_}},{key:"onPadButtonBlur_",value:function(e){if(this.popC_){var t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onPadButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(e){if(this.popC_){var t=this.popC_.view.element,n=hr(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!or(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}]),e}();function _s(e){return ds.isObject(e)?new ds(e.x,e.y):new ds}function ws(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function Es(e,t){var n,r;if(!Kt(e.min)||!Kt(e.max))return Math.max(Math.abs(null!==(n=e.min)&&void 0!==n?n:0),Math.abs(null!==(r=e.max)&&void 0!==r?r:0));var a=On(e);return Math.max(10*Math.abs(a),10*Math.abs(t))}function ks(e,t){var n,r,a=Es(Yt(e,null!==(n=e.x)&&void 0!==n?n:{}),t.x),i=Es(Yt(e,null!==(r=e.y)&&void 0!==r?r:{}),t.y);return Math.max(a,i)}function Cs(e){if(!("y"in e))return!1;var t=e.y;return!!t&&("inverted"in t&&!!t.inverted)}var Ss=Hr({id:"input-point2d",type:"input",accept:function(e,t){if(!ds.isObject(e))return null;var n=$n(t,(function(e){return Object.assign(Object.assign({},hi(e)),{expanded:e.optional.boolean,picker:e.optional.custom(mi),readonly:e.optional.constant(!1),x:e.optional.custom(vi),y:e.optional.object(Object.assign(Object.assign({},hi(e)),{inverted:e.optional.boolean}))})}));return n?{initialValue:e,params:n}:null},binding:{reader:function(){return _s},constraint:function(e){return t=e.params,n=e.initialValue,new is({assembly:ps,components:[fi(Object.assign(Object.assign({},t),t.x),n.x),fi(Object.assign(Object.assign({},t),t.y),n.y)]});var t,n},equals:ds.equals,writer:function(){return ws}},controller:function(e){var t,n,r=e.document,a=e.value,i=e.constraint,o=[e.params.x,e.params.y];return new bs(r,{axes:a.rawValue.getComponents().map((function(t,n){var r;return Gn({constraint:i.components[n],initialValue:t,params:Yt(e.params,null!==(r=o[n])&&void 0!==r?r:{})})})),expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,invertsY:Cs(e.params),max:ks(e.params,a.rawValue),parser:xn,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:a,viewProps:e.viewProps})}}),xs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;N(this,e),this.x=t,this.y=n,this.z=r}return I(e,[{key:"getComponents",value:function(){return[this.x,this.y,this.z]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z}}}],[{key:"isObject",value:function(e){if(Kt(e))return!1;var t=e.x,n=e.y,r=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof r}},{key:"equals",value:function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}}]),e}(),Ts={toComponents:function(e){return e.getComponents()},fromComponents:function(e){return q(xs,M(e))}};function Ls(e){return xs.isObject(e)?new xs(e.x,e.y,e.z):new xs}function As(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}var Ps=Hr({id:"input-point3d",type:"input",accept:function(e,t){if(!xs.isObject(e))return null;var n=$n(t,(function(e){return Object.assign(Object.assign({},hi(e)),{readonly:e.optional.constant(!1),x:e.optional.custom(vi),y:e.optional.custom(vi),z:e.optional.custom(vi)})}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Ls},constraint:function(e){return t=e.params,n=e.initialValue,new is({assembly:Ts,components:[fi(Object.assign(Object.assign({},t),t.x),n.x),fi(Object.assign(Object.assign({},t),t.y),n.y),fi(Object.assign(Object.assign({},t),t.z),n.z)]});var t,n},equals:xs.equals,writer:function(e){return As}},controller:function(e){var t=e.value,n=e.constraint,r=[e.params.x,e.params.y,e.params.z];return new ls(e.document,{assembly:Ts,axes:t.rawValue.getComponents().map((function(t,a){var i;return Gn({constraint:n.components[a],initialValue:t,params:Yt(e.params,null!==(i=r[a])&&void 0!==i?i:{})})})),parser:xn,value:t,viewProps:e.viewProps})}}),Rs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;N(this,e),this.x=t,this.y=n,this.z=r,this.w=a}return I(e,[{key:"getComponents",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}],[{key:"isObject",value:function(e){if(Kt(e))return!1;var t=e.x,n=e.y,r=e.z,a=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof r&&"number"==typeof a}},{key:"equals",value:function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}}]),e}(),Ds={toComponents:function(e){return e.getComponents()},fromComponents:function(e){return q(Rs,M(e))}};function Is(e){return Rs.isObject(e)?new Rs(e.x,e.y,e.z,e.w):new Rs}function Ns(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}var Os=Hr({id:"input-point4d",type:"input",accept:function(e,t){if(!Rs.isObject(e))return null;var n=$n(t,(function(e){return Object.assign(Object.assign({},hi(e)),{readonly:e.optional.constant(!1),w:e.optional.custom(vi),x:e.optional.custom(vi),y:e.optional.custom(vi),z:e.optional.custom(vi)})}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Is},constraint:function(e){return t=e.params,n=e.initialValue,new is({assembly:Ds,components:[fi(Object.assign(Object.assign({},t),t.x),n.x),fi(Object.assign(Object.assign({},t),t.y),n.y),fi(Object.assign(Object.assign({},t),t.z),n.z),fi(Object.assign(Object.assign({},t),t.w),n.w)]});var t,n},equals:Rs.equals,writer:function(e){return Ns}},controller:function(e){var t=e.value,n=e.constraint,r=[e.params.x,e.params.y,e.params.z,e.params.w];return new ls(e.document,{assembly:Ds,axes:t.rawValue.getComponents().map((function(t,a){var i;return Gn({constraint:n.components[a],initialValue:t,params:Yt(e.params,null!==(i=r[a])&&void 0!==i?i:{})})})),parser:xn,value:t,viewProps:e.viewProps})}});var Ms=Hr({id:"input-string",type:"input",accept:function(e,t){if("string"!=typeof e)return null;var n=$n(t,(function(e){return{readonly:e.optional.constant(!1),options:e.optional.custom(Pa)}}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Wa},constraint:function(e){return t=e.params,n=[],(r=Da(t.options))&&n.push(r),new Ta(n);var t,n,r},writer:function(e){return gi}},controller:function(e){var t=e.document,n=e.value,r=e.constraint,a=r&&La(r,Aa);return a?new Oa(t,{props:new an({options:a.values.value("options")}),value:n,viewProps:e.viewProps}):new Ga(t,{parser:function(e){return e},props:an.fromObject({formatter:qa}),value:n,viewProps:e.viewProps})},api:function(e){return"string"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Oa?new Ca(e.controller):null}}),Bs={defaultInterval:200,defaultRows:3},Fs=gr("mll"),Us=function(){function e(t,n){N(this,e),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=t.createElement("div"),this.element.classList.add(Fs()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("textarea");r.classList.add(Fs("i")),r.style.height="calc(var(".concat(pi("containerUnitSize"),") * ").concat(n.rows,")"),r.readOnly=!0,n.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return I(e,[{key:"update_",value:function(){var e=this,t=this.textareaElem_,n=t.scrollTop===t.scrollHeight-t.clientHeight,r=[];this.value.rawValue.forEach((function(t){void 0!==t&&r.push(e.formatter_(t))})),t.textContent=r.join("\n"),n&&(t.scrollTop=t.scrollHeight)}},{key:"onValueUpdate_",value:function(){this.update_()}}]),e}(),Vs=I((function e(t,n){N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.view=new Us(t,{formatter:n.formatter,rows:n.rows,value:this.value,viewProps:this.viewProps})})),Gs=gr("sgl"),Hs=function(){function e(t,n){N(this,e),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=t.createElement("div"),this.element.classList.add(Gs()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("input");r.classList.add(Gs("i")),r.readOnly=!0,r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return I(e,[{key:"update_",value:function(){var e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}},{key:"onValueUpdate_",value:function(){this.update_()}}]),e}(),js=I((function e(t,n){N(this,e),this.value=n.value,this.viewProps=n.viewProps,this.view=new Hs(t,{formatter:n.formatter,value:this.value,viewProps:this.viewProps})})),Ks=Hr({id:"monitor-bool",type:"monitor",accept:function(e,t){if("boolean"!=typeof e)return null;var n=$n(t,(function(e){return{readonly:e.required.constant(!0),rows:e.optional.number}}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Ha}},controller:function(e){var t;return 1===e.value.rawValue.length?new js(e.document,{formatter:ja,value:e.value,viewProps:e.viewProps}):new Vs(e.document,{formatter:ja,rows:null!==(t=e.params.rows)&&void 0!==t?t:Bs.defaultRows,value:e.value,viewProps:e.viewProps})}}),Js=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n,[{key:"max",get:function(){return this.controller.valueController.props.get("max")},set:function(e){this.controller.valueController.props.set("max",e)}},{key:"min",get:function(){return this.controller.valueController.props.get("min")},set:function(e){this.controller.valueController.props.set("min",e)}}]),n}(Yn),Ws=gr("grl"),qs=function(){function e(t,n){N(this,e),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ws()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.props_=n.props,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var r=t.createElementNS(ar,"svg");r.classList.add(Ws("g")),r.style.height="calc(var(".concat(pi("containerUnitSize"),") * ").concat(n.rows,")"),this.element.appendChild(r),this.svgElem_=r;var a=t.createElementNS(ar,"polyline");this.svgElem_.appendChild(a),this.lineElem_=a;var i=t.createElement("div");i.classList.add(Ws("t"),gr("tt")()),this.element.appendChild(i),this.tooltipElem_=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return I(e,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var e=this.element,t=e.clientWidth,n=e.clientHeight,r=this.value.rawValue.length-1,a=this.props_.get("min"),i=this.props_.get("max"),o=[];this.value.rawValue.forEach((function(e,s){if(void 0!==e){var l=Pn(s,0,r,0,t),u=Pn(e,a,i,n,0);o.push([l,u].join(","))}})),this.lineElem_.setAttributeNS(null,"points",o.join(" "));var s=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(void 0!==l){var u=Pn(this.cursor_.rawValue,0,r,0,t),c=Pn(l,a,i,n,0);s.style.left="".concat(u,"px"),s.style.top="".concat(c,"px"),s.textContent="".concat(this.formatter_(l)),s.classList.contains(Ws("t","a"))||(s.classList.add(Ws("t","a"),Ws("t","in")),ir(s),s.classList.remove(Ws("t","in")))}else s.classList.remove(Ws("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),e}(),Ys=function(){function e(t,n){if(N(this,e),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.cursor_=rn(-1),this.view=new qs(t,{cursor:this.cursor_,formatter:n.formatter,rows:n.rows,props:this.props,value:this.value,viewProps:this.viewProps}),or(t)){var r=new ei(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return I(e,[{key:"importProps",value:function(e){var t=this;return er(e,null,(function(e){return{max:e.required.number,min:e.required.number}}),(function(e){return t.props.set("max",e.max),t.props.set("min",e.min),!0}))}},{key:"exportProps",value:function(){return tr(null,{max:this.props.get("max"),min:this.props.get("min")})}},{key:"onGraphMouseLeave_",value:function(){this.cursor_.rawValue=-1}},{key:"onGraphMouseMove_",value:function(e){var t=this.view.element.clientWidth;this.cursor_.rawValue=Math.floor(Pn(e.offsetX,0,t,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(e){this.onGraphPointerMove_(e)}},{key:"onGraphPointerMove_",value:function(e){e.data.point?this.cursor_.rawValue=Math.floor(Pn(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.rawValue=-1}}]),e}();function zs(e){return Kt(e.format)?An(2):e.format}function Qs(e){return"graph"===e.view}var Xs=Hr({id:"monitor-number",type:"monitor",accept:function(e,t){if("number"!=typeof e)return null;var n=$n(t,(function(e){return{format:e.optional.function,max:e.optional.number,min:e.optional.number,readonly:e.required.constant(!0),rows:e.optional.number,view:e.optional.string}}));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:function(e){return Qs(e)?64:1},reader:function(e){return Tn}},controller:function(e){return Qs(e.params)?function(e){var t,n,r;return new Ys(e.document,{formatter:zs(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Bs.defaultRows,props:an.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:100,min:null!==(r=e.params.min)&&void 0!==r?r:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new js(e.document,{formatter:zs(e.params),value:e.value,viewProps:e.viewProps}):new Vs(e.document,{formatter:zs(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Bs.defaultRows,value:e.value,viewProps:e.viewProps})}(e)},api:function(e){return e.controller.valueController instanceof Ys?new Js(e.controller):null}}),Zs=Hr({id:"monitor-string",type:"monitor",accept:function(e,t){if("string"!=typeof e)return null;var n=$n(t,(function(e){return{multiline:e.optional.boolean,readonly:e.required.constant(!0),rows:e.optional.number}}));return n?{initialValue:e,params:n}:null},binding:{reader:function(e){return Wa}},controller:function(e){var t,n=e.value;return n.rawValue.length>1||e.params.multiline?new Vs(e.document,{formatter:qa,rows:null!==(t=e.params.rows)&&void 0!==t?t:Bs.defaultRows,value:n,viewProps:e.viewProps}):new js(e.document,{formatter:qa,value:n,viewProps:e.viewProps})}}),$s=function(){function e(){N(this,e),this.map_=new Map}return I(e,[{key:"get",value:function(e){var t;return null!==(t=this.map_.get(e))&&void 0!==t?t:null}},{key:"has",value:function(e){return this.map_.has(e)}},{key:"add",value:function(e,t){var n=this;return this.map_.set(e,t),e.viewProps.handleDispose((function(){n.map_.delete(e)})),t}}]),e}(),el=function(){function e(t){N(this,e),this.target=t.target,this.reader_=t.reader,this.writer_=t.writer}return I(e,[{key:"read",value:function(){return this.reader_(this.target.read())}},{key:"write",value:function(e){this.writer_(this.target,e)}},{key:"inject",value:function(e){this.write(this.reader_(e))}}]),e}();var tl=function(){function e(t){N(this,e),this.target=t.target,this.reader_=t.reader}return I(e,[{key:"read",value:function(){return this.reader_(this.target.read())}}]),e}();function nl(e,t){return 0===t?new Sa:new xa(e,null!=t?t:Bs.defaultInterval)}var rl=function(){function e(t){N(this,e),this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=t}return I(e,[{key:"getAll",value:function(){return[].concat(M(this.pluginsMap_.blades),M(this.pluginsMap_.inputs),M(this.pluginsMap_.monitors))}},{key:"register",value:function(e,t){if(!(n=t.core)||n.major!==Gr.major)throw Xt.notCompatible(e,t.id);var n;"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}},{key:"createInput_",value:function(e,t,n){return this.pluginsMap_.inputs.reduce((function(r,a){return null!=r?r:function(e,t){var n,r=e.accept(t.target.read(),t.params);if(Kt(r))return null;var a={target:t.target,initialValue:r.initialValue,params:r.params},i=$n(t.params,(function(e){return{disabled:e.optional.boolean,hidden:e.optional.boolean,label:e.optional.string,tag:e.optional.string}})),o=e.binding.reader(a),s=e.binding.constraint?e.binding.constraint(a):void 0,l=new el({reader:o,target:t.target,writer:e.binding.writer(a)}),u=new zn(rn(o(r.initialValue),{constraint:s,equals:e.binding.equals}),l),c=e.controller({constraint:s,document:t.document,initialValue:r.initialValue,params:r.params,value:u,viewProps:ua.create({disabled:null==i?void 0:i.disabled,hidden:null==i?void 0:i.hidden})});return new Tr(t.document,{blade:Zr(),props:an.fromObject({label:"label"in t.params?null!==(n=null==i?void 0:i.label)&&void 0!==n?n:null:t.target.key}),tag:null==i?void 0:i.tag,value:u,valueController:c})}(a,{document:e,target:t,params:n})}),null)}},{key:"createMonitor_",value:function(e,t,n){return this.pluginsMap_.monitors.reduce((function(r,a){return null!=r?r:function(e,t){var n,r,a,i=e.accept(t.target.read(),t.params);if(Kt(i))return null;var o={target:t.target,initialValue:i.initialValue,params:i.params},s=$n(t.params,(function(e){return{bufferSize:e.optional.number,disabled:e.optional.boolean,hidden:e.optional.boolean,interval:e.optional.number,label:e.optional.string}})),l=e.binding.reader(o),u=null!==(r=null!==(n=null==s?void 0:s.bufferSize)&&void 0!==n?n:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(i.params))&&void 0!==r?r:1,c=new Pr({binding:new tl({reader:l,target:t.target}),bufferSize:u,ticker:nl(t.document,null==s?void 0:s.interval)}),d=e.controller({document:t.document,params:i.params,value:c,viewProps:ua.create({disabled:null==s?void 0:s.disabled,hidden:null==s?void 0:s.hidden})});return d.viewProps.bindDisabled(c.ticker),d.viewProps.handleDispose((function(){c.ticker.dispose()})),new Rr(t.document,{blade:Zr(),props:an.fromObject({label:"label"in t.params?null!==(a=null==s?void 0:s.label)&&void 0!==a?a:null:t.target.key}),value:c,valueController:d})}(a,{document:e,params:n,target:t})}),null)}},{key:"createBinding",value:function(e,t,n){if(Kt(t.read()))throw new Xt({context:{key:t.key},type:"nomatchingcontroller"});var r=this.createInput_(e,t,n);if(r)return r;var a=this.createMonitor_(e,t,n);if(a)return a;throw new Xt({context:{key:t.key},type:"nomatchingcontroller"})}},{key:"createBlade",value:function(e,t){var n=this.pluginsMap_.blades.reduce((function(n,r){return null!=n?n:ka(r,{document:e,params:t})}),null);if(!n)throw new Xt({type:"nomatchingview",context:{params:t}});return n}},{key:"createInputBindingApi_",value:function(e){var t=this.pluginsMap_.inputs.reduce((function(t,n){var r,a;return t||(null!==(a=null===(r=n.api)||void 0===r?void 0:r.call(n,{controller:e}))&&void 0!==a?a:null)}),null);return this.apiCache_.add(e,null!=t?t:new Yn(e))}},{key:"createMonitorBindingApi_",value:function(e){var t=this.pluginsMap_.monitors.reduce((function(t,n){var r,a;return t||(null!==(a=null===(r=n.api)||void 0===r?void 0:r.call(n,{controller:e}))&&void 0!==a?a:null)}),null);return this.apiCache_.add(e,null!=t?t:new Yn(e))}},{key:"createBindingApi",value:function(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(Lr(e))return this.createInputBindingApi_(e);if(Dr(e))return this.createMonitorBindingApi_(e);throw Xt.shouldNeverHappen()}},{key:"createApi",value:function(e){var t=this;if(this.apiCache_.has(e))return this.apiCache_.get(e);if(function(e){return nr(e)&&rr(e.value)}(e))return this.createBindingApi(e);var n=this.pluginsMap_.blades.reduce((function(n,r){return null!=n?n:r.api({controller:e,pool:t})}),null);if(!n)throw Xt.shouldNeverHappen();return this.apiCache_.add(e,n)}}]),e}(),al=new $s;var il=function(e){F(n,e);var t=U(n);function n(e){var r;return N(this,n),(r=t.call(this,e)).emitter_=new $t,r.controller.value.emitter.on("change",(function(e){r.emitter_.emit("change",new Kn(j(r),e.rawValue))})),r}return I(n,[{key:"label",get:function(){return this.controller.labelController.props.get("label")},set:function(e){this.controller.labelController.props.set("label",e)}},{key:"options",get:function(){return this.controller.valueController.props.get("options")},set:function(e){this.controller.valueController.props.set("options",e)}},{key:"value",get:function(){return this.controller.value.rawValue},set:function(e){this.controller.value.rawValue=e}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}}]),n}(Hn),ol=function(e){F(n,e);var t=U(n);function n(){return N(this,n),t.apply(this,arguments)}return I(n)}(Hn),sl=function(e){F(n,e);var t=U(n);function n(e){var r;return N(this,n),(r=t.call(this,e)).emitter_=new $t,r.controller.value.emitter.on("change",(function(e){r.emitter_.emit("change",new Kn(j(r),e.rawValue))})),r}return I(n,[{key:"label",get:function(){return this.controller.labelController.props.get("label")},set:function(e){this.controller.labelController.props.set("label",e)}},{key:"max",get:function(){return this.controller.valueController.sliderController.props.get("max")},set:function(e){this.controller.valueController.sliderController.props.set("max",e)}},{key:"min",get:function(){return this.controller.valueController.sliderController.props.get("min")},set:function(e){this.controller.valueController.sliderController.props.set("min",e)}},{key:"value",get:function(){return this.controller.value.rawValue},set:function(e){this.controller.value.rawValue=e}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}}]),n}(Hn),ll=function(e){F(n,e);var t=U(n);function n(e){var r;return N(this,n),(r=t.call(this,e)).emitter_=new $t,r.controller.value.emitter.on("change",(function(e){r.emitter_.emit("change",new Kn(j(r),e.rawValue))})),r}return I(n,[{key:"label",get:function(){return this.controller.labelController.props.get("label")},set:function(e){this.controller.labelController.props.set("label",e)}},{key:"formatter",get:function(){return this.controller.valueController.props.get("formatter")},set:function(e){this.controller.valueController.props.set("formatter",e)}},{key:"value",get:function(){return this.controller.value.rawValue},set:function(e){this.controller.value.rawValue=e}},{key:"on",value:function(e,t){var n=t.bind(this);return this.emitter_.on(e,(function(e){n(e)}),{key:t}),this}},{key:"off",value:function(e,t){return this.emitter_.off(e,t),this}}]),n}(Hn),ul={id:"list",type:"blade",core:Gr,accept:function(e){var t=$n(e,(function(e){return{options:e.required.custom(Pa),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string}}));return t?{params:t}:null},controller:function(e){var t=new Aa(Ra(e.params.options)),n=rn(e.params.value,{constraint:t}),r=new Oa(e.document,{props:new an({options:t.values.value("options")}),value:n,viewProps:e.viewProps});return new Cr(e.document,{blade:e.blade,props:an.fromObject({label:e.params.label}),value:n,valueController:r})},api:function(e){return e.controller instanceof Cr&&e.controller.valueController instanceof Oa?new il(e.controller):null}},cl=function(e){F(n,e);var t=U(n);function n(e,r){return N(this,n),t.call(this,e,r)}return I(n,[{key:"element",get:function(){return this.controller.view.element}}]),n}(na),dl=function(e){F(n,e);var t=U(n);function n(e,r){return N(this,n),t.call(this,e,{expanded:r.expanded,blade:r.blade,props:r.props,root:!0,viewProps:r.viewProps})}return I(n)}(ia),pl=gr("spr"),hl=I((function e(t,n){N(this,e),this.element=t.createElement("div"),this.element.classList.add(pl()),n.viewProps.bindClassModifiers(this.element);var r=t.createElement("hr");r.classList.add(pl("r")),this.element.appendChild(r)})),vl=function(e){F(n,e);var t=U(n);function n(e,r){return N(this,n),t.call(this,Object.assign(Object.assign({},r),{view:new hl(e,{viewProps:r.viewProps})}))}return I(n)}(kr),fl={id:"separator",type:"blade",core:Gr,accept:function(e){var t=$n(e,(function(e){return{view:e.required.constant("separator")}}));return t?{params:t}:null},controller:function(e){return new vl(e.document,{blade:e.blade,viewProps:e.viewProps})},api:function(e){return e.controller instanceof vl?new ol(e.controller):null}},ml={id:"slider",type:"blade",core:Gr,accept:function(e){var t=$n(e,(function(e){return{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number}}));return t?{params:t}:null},controller:function(e){var t,n,r=null!==(t=e.params.value)&&void 0!==t?t:0,a=new on({max:e.params.max,min:e.params.min}),i=rn(r,{constraint:a}),o=new ui(e.document,Object.assign(Object.assign({},ci({formatter:null!==(n=e.params.format)&&void 0!==n?n:Ln,keyScale:rn(1),max:a.values.value("max"),min:a.values.value("min"),pointerScale:Mn(e.params,r)})),{parser:xn,value:i,viewProps:e.viewProps}));return new Cr(e.document,{blade:e.blade,props:an.fromObject({label:e.params.label}),value:i,valueController:o})},api:function(e){return e.controller instanceof Cr&&e.controller.valueController instanceof ui?new sl(e.controller):null}},gl={id:"text",type:"blade",core:Gr,accept:function(e){var t=$n(e,(function(e){return{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string}}));return t?{params:t}:null},controller:function(e){var t,n=rn(e.params.value),r=new Ga(e.document,{parser:e.params.parse,props:an.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:function(e){return String(e)}}),value:n,viewProps:e.viewProps});return new Cr(e.document,{blade:e.blade,props:an.fromObject({label:e.params.label}),value:n,valueController:r})},api:function(e){return e.controller instanceof Cr&&e.controller.valueController instanceof Ga?new ll(e.controller):null}};var yl=function(e){F(n,e);var t=U(n);function n(e){var r,a,i;N(this,n);var o=null!=e?e:{},s=null!==(a=o.document)&&void 0!==a?a:sr(),l=function(){var e=new rl(al);return[Ss,Ps,Os,Ms,cs,as,rs,es,wi,Ks,Zs,Xs,jr,oa,Ea].forEach((function(t){e.register("core",t)})),e}(),u=new dl(s,{expanded:o.expanded,blade:Zr(),props:an.fromObject({title:o.title}),viewProps:ua.create()});return(r=t.call(this,u,l)).pool_=l,r.containerElem_=null!==(i=o.container)&&void 0!==i?i:function(e){var t=e.createElement("div");return t.classList.add(gr("dfw")()),e.body&&e.body.appendChild(t),t}(s),r.containerElem_.appendChild(r.element),r.doc_=s,r.usesDefaultWrapper_=!o.container,r.setUpDefaultPlugins_(),r}return I(n,[{key:"document",get:function(){if(!this.doc_)throw Xt.alreadyDisposed();return this.doc_}},{key:"dispose",value:function(){var e=this.containerElem_;if(!e)throw Xt.alreadyDisposed();if(this.usesDefaultWrapper_){var t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,K(J(n.prototype),"dispose",this).call(this)}},{key:"registerPlugin",value:function(e){var t=this;e.css&&function(e,t,n){if(!e.querySelector("style[data-tp-style=".concat(t,"]"))){var r=e.createElement("style");r.dataset.tpStyle=t,r.textContent=n,e.head.appendChild(r)}}(this.document,"plugin-".concat(e.id),e.css),("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((function(n){t.pool_.register(e.id,n)}))}},{key:"setUpDefaultPlugins_",value:function(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:"";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:"";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[ul,fl,ml,Ea,gl]})}}]),n}(cl);new Vr("4.0.5");function bl(e,t,n){var r;if("object"!==H(e)||void 0===t||void 0===n)return r=e,function(e,t,n){var a=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(r.call(this))return null==a?void 0:a.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}};!function(e,t,n){var r=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return null==r?void 0:r.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}(0,t,n)}function _l(e,t,n){var r;if("object"!==H(e)||void 0===t||void 0===n)return r=e,function(e,t,n){var a=n.value,i=function(){var e=R(D().mark((function e(){var n,i,o,s=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,i=new Array(n),o=0;o<n;o++)i[o]=s[o];if(!r.call(this)){e.next=5;break}return e.next=4,null==a?void 0:a.apply(this,i);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();n.value=i};!function(e,t,n){var r=n.value,a=function(){var e=R(D().mark((function e(){var n,a,i,o=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=o.length,a=new Array(n),i=0;i<n;i++)a[i]=o[i];if(!this.isValid){e.next=5;break}return e.next=4,null==r?void 0:r.apply(this,a);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();n.value=a}(0,t,n)}t._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),t._RF.pop(),t._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),t._RF.pop(),t._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),t._RF.pop(),t._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var wl=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,"".concat(e," is missing these required properties: [").concat(r.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,a.errors=r,a}return I(n)}(V(Error));t._RF.pop(),t._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var El=function(e){F(n,e);var t=U(n);function n(e,r){var a;return N(this,n),(a=t.call(this,"".concat(e," is missing the required property: <").concat(r,">"))).className=e,a.propertyName=r,a}return I(n)}(V(Error));t._RF.pop(),t._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var kl=Ludex.Utils,Cl=kl.String,Sl=kl.Valid,xl=codex.monitorError,Tl="_compUtils_ReqPropsMap";function Ll(e){return null===e}function Al(e){return void 0===e}function Pl(e){return Ll(e)||Al(e)}function Rl(e){if("function"==typeof e)return e;switch(e){case"null-check":return Ll;case"undefined-check":return Al;default:return Pl}}function Dl(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var r,a=t.constructor.name,i=(r=n,"".concat("_compUtils_ReqPropsMethod","_").concat(Cl.capitalize(r)));if(void 0!==t[i])throw new Error("The required decorator found that property name ".concat(i," already exists. The reserved method name ").concat(i," is used already or the decorator was applied multiple times."));t[i]=function(t){if(e(this[n]))throw new El(t,n)},void 0===t[Tl]&&(t[Tl]={}),void 0===t[Tl][a]&&(t[Tl][a]=[]),t[Tl][a].push(i)}}function Il(e,t){if("string"!=typeof t)return Dl(Rl(e));var n=e;Dl(Rl())(n,t)}t._RF.pop(),t._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),t._RF.pop(),t._RF.push({},"bfa55FbayJE75F0wBdnknTr","ComponentUtils",void 0);var Nl=Ludex.Utils,Ol=Nl.Array,Ml=Nl.Object,Bl=Nl.Valid,Fl=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],Ul=e("o",function(){function e(){N(this,e),this.validComponentCalled={}}return I(e,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,r=e.constructor,a=this.getRequiredComponentNames(r),i=O(a);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(!e.getComponent(o))throw new Error("".concat(n,": Missing required ").concat(o," component"))}}catch(e){i.e(e)}finally{i.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,r=e.constructor,a=this.getRequiredPropNames(r),i=O(a);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(!Ml.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var s=this.getProperty(o,e);if(!_(s))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){i.e(e)}finally{i.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,r=this.getCustomPropNames(e),a=O(r);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!Ml.hasOwn(e,i))throw new Error("".concat(n,": Missing required ").concat(i," property"));var o=this.getProperty(i,e);if(!_(o))throw new Error("".concat(n,": ").concat(i," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"getProperty",value:function(e,t){var n;if(Ml.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!Ml.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!Ml.hasOwn(e,t)&&(!!_(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=Fl;t<n.length;t++){var r=n[t];if(r.indexOf(e)>=0)return r}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!Ml.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),r=this.getProps(e.constructor);return Ol.difference(n,r).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!Ml.hasOwn(e,n))return!1;var r=t.getProperty(n,e);return!(!Bl.isObject(r)||!_(r))}))}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"required",value:function(e,t){return"string"==typeof t?Il(e,t):Il(e)}},{key:"onlyRunInLifeCycle",value:function(e,t,n){return"object"===H(e)&&void 0!==t&&void 0!==n?bl(e,t,n):bl(e)}},{key:"onlyRunInLifeCycleAsync",value:function(e,t,n){return"object"===H(e)&&void 0!==t&&void 0!==n?_l(e,t,n):_l(e)}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,r,a=t?t.name:e.constructor.name,i=t?t.prototype[Tl]:e.constructor.prototype[Tl],o=null!==(n=null==i?void 0:i[a])&&void 0!==n?n:[],s=[],l=e,u=O(o);try{for(u.s();!(r=u.n()).done;){var c=r.value;if("function"==typeof l[c])try{l[c](a)}catch(d){if(!(d instanceof El))throw d;s.push(d)}}}catch(e){u.e(e)}finally{u.f()}if(0!==s.length){var d=new wl(a,s);if(Sl.isDebugger())throw d;console.error(d),null==xl||xl.sendException(d)}}(e,t)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,r=n.name;if(!this.inst.validComponentCalled[r])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled[r]=!0}}}}]),e}());t._RF.pop(),t._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var Vl,Gl,Hl,jl,Kl,Jl,Wl,ql,Yl,zl,Ql,Xl,Zl,$l,eu,tu,nu,ru,au,iu,ou,su,lu,uu,cu,du,pu,hu,vu,fu,mu,gu,yu,bu,_u,wu,Eu,ku,Cu,Su,xu,Tu,Lu=function(){function e(){N(this,e),this.time=0,this._value=0,this.time=0,this._value=0}return I(e,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),e}();t._RF.pop(),t._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var Au=w.ccclass,Pu=w.executionOrder,Ru=w.property,Du=w.requireComponent,Iu=Ludex,Nu=Iu.Utils,Ou=Nu.Valid,Mu=Nu.Array,Bu=Nu.Device,Fu=Iu.Configs.Debugger.ListPlayerDevIds,Uu=codex.player,Vu=E.RED,Gu=E.YELLOW,Hu=E.WHITE,ju=E.BLACK,Ku=(Vl=Au("GameStats"),Gl=Pu(-1e3),Hl=Du([k]),jl=Ul.required(),Kl=Ru(C),Jl=Ul.required(),Wl=Ru(C),ql=Ul.required(),Yl=Ru(C),zl=Ul.required(),Ql=Ru(C),Xl=Ul.required(),Zl=Ru(C),$l=Ul.required(),eu=Ru(C),tu=Ul.required(),nu=Ru(C),ru=Ul.required(),au=Ru(C),iu=Ul.required(),ou=Ru(C),su=Ul.required(),lu=Ru(C),uu=Ul.required(),cu=Ru(C),du=Ul.required(),pu=Ul.required(),Vl(hu=Gl(hu=Hl((fu=Y((vu=function(e){F(n,e);var t=U(n);function n(){var e;N(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),z(e,"dprLabel",fu,j(e)),z(e,"fpsLabel",mu,j(e)),z(e,"fpsRawLabel",gu,j(e)),z(e,"drawCountLabel",yu,j(e)),z(e,"rafTimeLabel",bu,j(e)),z(e,"deltaTimeLabel",_u,j(e)),z(e,"logicTimeLabel",wu,j(e)),z(e,"physicTimeLabel",Eu,j(e)),z(e,"renderTimeLabel",ku,j(e)),z(e,"objectMemoryUsageLabel",Cu,j(e)),z(e,"textureMemoryUsageLabel",Su,j(e)),z(e,"bg",xu,j(e)),z(e,"opacity",Tu,j(e)),e.lastRafTime=0,e.slowRefreshInterval=1,e.mediumRefreshInterval=.5,e.fastRefreshInterval=.16,e.isBackgroundEnabled=!1,e.touchMs=0,e.isDragging=!1,e.handleTouchStart=function(t){t.touch&&(e.isDragging=!1,Date.now()-e.touchMs<300?e.opacity&&(e.opacity.opacity=0):e.opacity&&(e.opacity.opacity=255),e.touchMs=Date.now())},e.handleTouchMove=function(t){var n=t.touch;if(n){var r=n.getUIDelta();!e.isDragging&&r.length()>10&&(e.isDragging=!0),e.isDragging&&e.node.setPosition(e.node.position.x+r.x,e.node.position.y+r.y)}},e.handleTouchEnd=function(){e.isDragging||(e.bg.enabled=!e.bg.enabled,e.isBackgroundEnabled=e.bg.enabled),e.isDragging=!1},e.updateFastStats=function(){e.updateFpsRaw(),e.updateRafTime(),e.updateDeltaTime()},e.updateSlowStats=function(){e.updateDPR(),e.updateDrawCalls(),e.updateObjectMemoryUsage(),e.updateTextureMemoryUsage()},e.updateMediumStats=function(){e.updateFps(),e.updateLogicTime(),e.updatePhysicTime(),e.updateRenderTime()},e.calcRafTime=function(t){var n;null!==(n=e.node)&&void 0!==n&&n.isValid&&(e.rafTimeCounter.end(t),e.lastRafTime=t,e.handleRequestAnimationFrame())},e.handleRequestAnimationFrame=function(){e.node.active&&(e.rafTimeCounter.start(e.lastRafTime),requestAnimationFrame(e.calcRafTime))},e}return I(n,[{key:"__preload",value:function(){this.bg=this.getComponent(S),this.opacity=this.getComponent(k)}},{key:"onLoad",value:function(){Ul.validateRequiredProperties(this)}},{key:"listenInputEvents",value:function(){this.node.on(x.EventType.TOUCH_START,this.handleTouchStart),this.node.on(x.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.on(x.EventType.TOUCH_END,this.handleTouchEnd),this.node.on(x.EventType.TOUCH_CANCEL,this.handleTouchEnd)}},{key:"start",value:function(){this.bg.enabled=!1,this.canDisplayStats()?(this.enableGameStats(),this.node.active=!0):this.node.active=!1}},{key:"enableGameStats",value:function(){this.node.active=!0,this.checkAndCreatePerfCounters(),this.reset(),T.on(L.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),T.on(L.EVENT_AFTER_UPDATE,this.afterUpdate,this),T.on(L.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),T.on(L.EVENT_AFTER_PHYSICS,this.afterPhysics,this),T.on(L.EVENT_BEFORE_DRAW,this.beforeDraw,this),T.on(L.EVENT_AFTER_DRAW,this.afterDraw,this),this.startUpdateStats(),this.listenInputEvents()}},{key:"disableGameStats",value:function(){this.node.active=!1,T.off(L.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),T.off(L.EVENT_AFTER_UPDATE,this.afterUpdate,this),T.off(L.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),T.off(L.EVENT_AFTER_PHYSICS,this.afterPhysics,this),T.off(L.EVENT_BEFORE_DRAW,this.beforeDraw,this),T.off(L.EVENT_AFTER_DRAW,this.afterDraw,this),this.unschedule(this.updateSlowStats),this.unschedule(this.updateFastStats),this.unschedule(this.updateMediumStats),this.node.off(x.EventType.TOUCH_START,this.handleTouchStart),this.node.off(x.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.off(x.EventType.TOUCH_END,this.handleTouchEnd),this.node.off(x.EventType.TOUCH_CANCEL,this.handleTouchEnd)}},{key:"checkAndCreatePerfCounters",value:function(){this.rafTimeCounter||(this.rafTimeCounter=new Lu),this.logicTimeCounter||(this.logicTimeCounter=new Lu),this.physicTimeCounter||(this.physicTimeCounter=new Lu),this.renderTimeCounter||(this.renderTimeCounter=new Lu)}},{key:"reset",value:function(){this.isDragging=!1,this.touchMs=0,this.lastRafTime=0}},{key:"onDestroy",value:function(){this.canDisplayStats()&&(T.off(L.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),T.off(L.EVENT_AFTER_UPDATE,this.afterUpdate,this),T.off(L.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),T.off(L.EVENT_AFTER_PHYSICS,this.afterPhysics,this),T.off(L.EVENT_BEFORE_DRAW,this.beforeDraw,this),T.off(L.EVENT_AFTER_DRAW,this.afterDraw,this),this.unschedule(this.updateSlowStats),this.unschedule(this.updateFastStats),this.unschedule(this.updateMediumStats),this.node.off(x.EventType.TOUCH_START,this.handleTouchStart),this.node.off(x.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.off(x.EventType.TOUCH_END,this.handleTouchEnd),this.node.off(x.EventType.TOUCH_CANCEL,this.handleTouchEnd))}},{key:"canDisplayStats",value:function(){return Ou.isDebugger()||Mu.has(Fu,Uu.getPlayerId())||hc.isCanShowGameStats()}},{key:"startUpdateStats",value:function(){this.schedule(this.updateFastStats,this.fastRefreshInterval),this.schedule(this.updateSlowStats,this.slowRefreshInterval),this.schedule(this.updateMediumStats,this.mediumRefreshInterval),requestAnimationFrame(this.handleRequestAnimationFrame)}},{key:"updateFps",value:function(){var e=this.getFps();this.updateFpsColor(e),this.fpsLabel.string="FPS: ".concat(e)}},{key:"updateFpsColor",value:function(e){e<30?this.fpsLabel.color=Vu:e<48?this.fpsLabel.color=Gu:this.setColorWithBackground(this.fpsLabel)}},{key:"updateFpsRaw",value:function(){var e=this.getFpsRaw();this.updateFpsRawColor(e),this.fpsRawLabel.string="FPS Raw: ".concat(e)}},{key:"updateFpsRawColor",value:function(e){e<30?this.fpsRawLabel.color=Vu:e<48?this.fpsRawLabel.color=Gu:this.setColorWithBackground(this.fpsRawLabel)}},{key:"updateDrawCalls",value:function(){var e=this.getDrawCalls();this.updateDrawCallsColor(e),this.drawCountLabel.string="Draw Calls: ".concat(e)}},{key:"updateDrawCallsColor",value:function(e){var t=A.os===A.OS.IOS,n=t?60:25;e>(t?80:40)?this.drawCountLabel.color=Vu:e>n?this.drawCountLabel.color=Gu:this.setColorWithBackground(this.drawCountLabel)}},{key:"updateRafTime",value:function(){var e=this.getRafTime();this.updateRafTimeColor(e),this.rafTimeLabel.string="RAF Time: ".concat(e,"ms")}},{key:"updateRafTimeColor",value:function(e){e>32?this.rafTimeLabel.color=Vu:e>16?this.rafTimeLabel.color=Gu:this.setColorWithBackground(this.rafTimeLabel)}},{key:"updateDeltaTime",value:function(){var e=this.getDeltaTime();this.updateDeltaTimeColor(e),this.deltaTimeLabel.string="Delta Time: ".concat(e,"ms")}},{key:"updateDeltaTimeColor",value:function(e){e>32?this.deltaTimeLabel.color=Vu:e>16?this.deltaTimeLabel.color=Gu:this.setColorWithBackground(this.deltaTimeLabel)}},{key:"updateLogicTime",value:function(){var e=this.getLogicTime();this.updateLogicTimeColor(e),this.logicTimeLabel.string="Logic Time: ".concat(e,"ms")}},{key:"updateLogicTimeColor",value:function(e){e>10?this.logicTimeLabel.color=Vu:e>5?this.logicTimeLabel.color=Gu:this.setColorWithBackground(this.logicTimeLabel)}},{key:"updatePhysicTime",value:function(){var e=this.getPhysicTime();this.updatePhysicTimeColor(e),this.physicTimeLabel.string="Physic Time: ".concat(e,"ms")}},{key:"updatePhysicTimeColor",value:function(e){e>10?this.physicTimeLabel.color=Vu:e>5?this.physicTimeLabel.color=Gu:this.setColorWithBackground(this.physicTimeLabel)}},{key:"updateRenderTime",value:function(){var e=this.getRenderTime();this.updateRenderTimeColor(e),this.renderTimeLabel.string="Render Time: ".concat(e,"ms")}},{key:"updateRenderTimeColor",value:function(e){e>10?this.renderTimeLabel.color=Vu:e>5?this.renderTimeLabel.color=Gu:this.setColorWithBackground(this.renderTimeLabel)}},{key:"updateObjectMemoryUsage",value:function(){var e=this.getObjectMemoryUsage();this.updateObjectMemoryUsageColor(e),this.objectMemoryUsageLabel.string="Object Mem: ".concat(e,"MB")}},{key:"updateObjectMemoryUsageColor",value:function(e){e>40?this.objectMemoryUsageLabel.color=Vu:e>25?this.objectMemoryUsageLabel.color=Gu:this.setColorWithBackground(this.objectMemoryUsageLabel)}},{key:"updateTextureMemoryUsage",value:function(){var e=this.getTextureMemoryUsage();this.updateTextureMemoryUsageColor(e),this.textureMemoryUsageLabel.string="Texture Mem: ".concat(e,"MB")}},{key:"updateTextureMemoryUsageColor",value:function(e){e>200?this.textureMemoryUsageLabel.color=Vu:e>100?this.textureMemoryUsageLabel.color=Gu:this.setColorWithBackground(this.textureMemoryUsageLabel)}},{key:"updateDPR",value:function(){var e=Bu.pixelRatio();this.updateDPRColor(e),this.dprLabel.string="DPR: ".concat(e)}},{key:"updateDPRColor",value:function(e){e>2?this.dprLabel.color=Vu:e<=1?this.dprLabel.color=Gu:this.setColorWithBackground(this.dprLabel)}},{key:"setColorWithBackground",value:function(e){e.color=this.isBackgroundEnabled?Hu:ju}},{key:"getFps",value:function(){if(!T.root)return 0;var e=T.root.fps;return Math.round(e)||0}},{key:"getDrawCalls",value:function(){return T.root&&T.root.device.numDrawCalls||0}},{key:"toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(t))||0}},{key:"getFpsRaw",value:function(){return this.toFixed(1e3/this.rafTimeCounter.value,0)}},{key:"getRafTime",value:function(){return this.toFixed(this.rafTimeCounter.value)}},{key:"getDeltaTime",value:function(){return this.toFixed(1e3*b.deltaTime)}},{key:"getLogicTime",value:function(){return this.toFixed(this.logicTimeCounter.value)}},{key:"getPhysicTime",value:function(){return this.toFixed(this.physicTimeCounter.value)}},{key:"getRenderTime",value:function(){return this.toFixed(this.renderTimeCounter.value)}},{key:"getObjectMemoryUsage",value:function(){if(!T.root)return 0;var e=T.root.device.memoryStatus;return this.toFixed(e.bufferSize/1048576,4)||0}},{key:"getTextureMemoryUsage",value:function(){if(!T.root)return 0;var e=T.root.device.memoryStatus;return this.toFixed(e.textureSize/1048576,4)||0}},{key:"beforeUpdate",value:function(){var e=performance.now();this.logicTimeCounter.start(e)}},{key:"afterUpdate",value:function(){var e=performance.now();this.logicTimeCounter.end(e)}},{key:"beforePhysics",value:function(){var e=performance.now();this.physicTimeCounter.start(e)}},{key:"afterPhysics",value:function(){var e=performance.now();this.physicTimeCounter.end(e)}},{key:"beforeDraw",value:function(){var e=performance.now();this.renderTimeCounter.start(e)}},{key:"afterDraw",value:function(){var e=performance.now();this.renderTimeCounter.end(e)}}]),n}(P)).prototype,"dprLabel",[jl,Kl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=Y(vu.prototype,"fpsLabel",[Jl,Wl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=Y(vu.prototype,"fpsRawLabel",[ql,Yl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu=Y(vu.prototype,"drawCountLabel",[zl,Ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bu=Y(vu.prototype,"rafTimeLabel",[Xl,Zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_u=Y(vu.prototype,"deltaTimeLabel",[$l,eu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wu=Y(vu.prototype,"logicTimeLabel",[tu,nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eu=Y(vu.prototype,"physicTimeLabel",[ru,au],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ku=Y(vu.prototype,"renderTimeLabel",[iu,ou],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cu=Y(vu.prototype,"objectMemoryUsageLabel",[su,lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=Y(vu.prototype,"textureMemoryUsageLabel",[uu,cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu=Y(vu.prototype,"bg",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=Y(vu.prototype,"opacity",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hu=vu))||hu)||hu)||hu);t._RF.pop(),t._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Ju=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(Ju||{}),Wu=e("a9",{Events:Ju,UNLOCK_SEQUENCE:"101023231010"});t._RF.pop(),t._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var qu=e("B",function(e){return e.NEXT_LEVEL="next-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.AUTO_FINISH_LEVEL="auto-finish-level",e.SWITCH_SCENE="switch-scene",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.GAME_RESCUE="game-rescue",e.USE_ITEM="use-item",e.SHOW_HINT="show-hint",e.HIDE_HINT="hide-hint",e.START_UNDO="start-undo",e.START_SHUFFLE="start-shuffle",e.END_SHUFFLE="end-shuffle",e.ITEM_CONFIG_CHANGE="item-config-change",e.ITEM_COUNT_CHANGE="item-count-change",e.THEME_BACKGROUND_CHANGE="theme-background-change",e.THEME_TILE_CHANGE="theme-tile-change",e.GAMEOBJECT_WIDGET_UPDATE="gameobject-widget-update",e.AUTO_ZOOM_UPDATE="auto-zoom-update",e.SKIP_LEVEL="skip-level",e.TIME_OUT="time-out",e.ALL_TILE_READY="all-tile-ready",e.ALL_TILE_DESTROYED="all-tile-destroyed",e.ALL_TILE_COVERED="all-tile-covered",e.TILE_CLICKED="tile-clicked",e.TILE_MOVING="tile-moving",e.TILE_DROPPED="tile-dropped",e.TILE_COVERED_CLICKED="tile-covered-clicked",e.TILE_CREATED="tile-created",e.TILE_DESTROYED="tile-destroyed",e.TILE_RELEASE="tile-release",e.TILE_START_SORT="tile-start-sort",e.TWO_TILES_MATCHED="two-tiles-matched",e.TWO_TILES_UNDONE="two-tiles-undone",e.TILE_BLOCKED="tile-blocked",e.TILES_STATE_UPDATED="tiles-state-updated",e.JOURNEY_MISSION_COMPLETE_CHECK="journey-mission-complete-check",e.MISSION_TILE_SET_COLLECT="mission-tile-set-collect",e.MISSION_TILE_SET_UPDATE="mission-tile-set-update",e}(qu||{}));t._RF.pop(),t._RF.push({},"6e50aRjxGVCAbRnH5TLU35R","DailyQuest",void 0);var Yu=function(e){var t=e.split("-");if(0!==t.length){if("CompleteLevel"===t[0]&&3===t.length){var n=W(t,3),r=(n[0],n[1]),a=n[2];return G(G({},function(e){return{description:"winXLevels",type:{name:"CompleteLevel"},target:e}}(parseInt(r))),{},{current:parseInt(a)})}if("UseItem"===t[0]&&3===t.length){var i=W(t,3),o=(i[0],i[1]),s=i[2];return G(G({},function(e){return{description:"useXItems",type:{name:"UseItem",items:[wt[bt.HINT],wt[bt.SHUFFLE]]},target:e}}(parseInt(o))),{},{current:parseInt(s)})}if("ReachCombo"===t[0]&&3===t.length){var l=W(t,3),u=(l[0],l[1]),c=l[2];return G(G({},function(e){return{description:"reachComboX",type:{name:"ReachCombo",minCombo:e},target:1}}(parseInt(u))),{},{current:parseInt(c)})}}},zu=function(e){switch(e.type.name){case"CompleteLevel":return"CompleteLevel-".concat(e.target,"-").concat(e.current||0);case"UseItem":return"UseItem-".concat(e.target,"-").concat(e.current||0);case"ReachCombo":return"ReachCombo-".concat(e.type.minCombo,"-").concat(e.current||0);default:return}};t._RF.pop(),t._RF.push({},"fc102DnnDVPELVz7+fkxRMD","DailyQuestManager",void 0);var Qu=[["CompleteLevel-10-0","UseItem-3-0","ReachCombo-15-0"],["CompleteLevel-20-0","UseItem-6-0","ReachCombo-30-0"],["CompleteLevel-30-0","UseItem-9-0","ReachCombo-45-0"]],Xu=[{ShuffleItem:1,HintItem:1},{ShuffleItem:2,HintItem:2},{HintItem:3,ShuffleItem:3}],Zu=e("Z",{COMPLETE_QUEST:"daily-quest-event-complete-quest"}),$u=codex.event,ec=e("U",function(){function e(){N(this,e),this.exp=0,this.currentStage=1,this.rewardList=[],this.quests=[],this.rewarded=[],this.questShowingInPopup=void 0;var t=window.codex.player.getPlayerData().gameData,n=t.dailyQuest,r=t.lastLoginTime;if(this.currentStage=n.currentStage||1,void 0===n.quests||0===n.quests.length||0===n.quests[0].length||"string"!=typeof n.quests[0][0]?this.initQuests():this.loadQuestsFromPlayerData(n),this.rewardList=Xu.map((function(e){return e})),this.currentStage<=3){var a=this.quests[this.currentStage-1].filter((function(e){return e.current>=e.target})).length;this.exp=a+3*(this.currentStage-1)}else this.exp=9;if(n.rewarded&&3!==n.rewarded.length){this.rewarded=[];for(var i=0;i<3;i++)this.rewarded.push(!1)}else this.rewarded=n.rewarded;var o={UndoItem:0,HintItem:0,ShuffleItem:0},s=new Date(r||0),l=new Date;if(s.getDate()!==l.getDate()||s.getMonth()!==l.getMonth()||s.getFullYear()!==l.getFullYear()){for(var u=0;u<this.rewarded.length;u++)u+1<this.currentStage&&!this.rewarded[u]&&(o.UndoItem+=0|this.rewardList[u].UndoItem,o.HintItem+=0|this.rewardList[u].HintItem,o.ShuffleItem+=0|this.rewardList[u].ShuffleItem);3!==this.currentStage||this.rewarded[2]||9!==this.exp||(o.UndoItem+=0|this.rewardList[2].UndoItem,o.HintItem+=0|this.rewardList[2].HintItem,o.ShuffleItem+=0|this.rewardList[2].ShuffleItem),this.reset()}this.rewardIsNotClaimed=o,this.updateQuestPlayerData(),this.addDebugContent()}return I(e,[{key:"addDebugContent",value:function(){var e=this,t=hc.addLiveOpsFolder("Daily Quest");t&&(hc.addLiveOpsButton(t,"Reset Daily Quests",(function(){e.reset()})),hc.addLiveOpsButton(t,"Progress All Daily Quests",(function(){e.progressAllQuests()})))}},{key:"loadQuestsFromPlayerData",value:function(e){var t=e.quests;this.quests=[];var n,r=O(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.quests.push([]);var i,o=O(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=Yu(s);l?this.quests[this.quests.length-1].push(l):console.warn("DailyQuestManager: quest ".concat(s," not found"))}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}}},{key:"initQuests",value:function(){var e=[].concat(Qu);this.quests=[];var t,n=O(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.quests.push([]);var a,i=O(r);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=Yu(o);s?this.quests[this.quests.length-1].push(s):console.warn("DailyQuestManager: quest ".concat(o," not found"))}}catch(e){i.e(e)}finally{i.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateQuestPlayerData",value:function(){for(var e=[],t=0;t<this.quests.length;t++){e.push([]);for(var n=0;n<this.quests.length;n++){var r=zu(this.quests[t][n]);void 0!==r&&"string"==typeof r?e[t].push(r):console.warn("DailyQuestManager: quest ".concat(this.quests[t][n]," not found"))}}var a={currentStage:this.currentStage,quests:e,rewarded:M(this.rewarded)};window.codex.player.setGameData({dailyQuest:a})}},{key:"reset",value:function(){this.exp=0,this.currentStage=1,this.rewardList=Xu.map((function(e){return e})),this.rewarded=[];for(var e=0;e<3;e++)this.rewarded.push(!1);this.rewardIsNotClaimed={UndoItem:0,HintItem:0,ShuffleItem:0},this.initQuests(),this.updateQuestPlayerData()}},{key:"progressAllQuests",value:function(){e.finishGame(),e.useItem({HintItem:1,ShuffleItem:1});for(var t=45;t>0;t--)e.reachCombo(t)}},{key:"handleQuestCompleteLevel",value:function(){if(!(this.currentStage>3)){var e,t=this.quests[this.currentStage-1].filter((function(e){return"CompleteLevel"===e.type.name&&e.current<e.target})),n=O(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.current++,r.current>=r.target)r.current=r.target,this.exp+=1,codex.player.getPlayerData().gameData.level>1&&(this.questShowingInPopup=r)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"handleQuestUseItem",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(e){return"UseItem"===e.type.name&&e.current<e.target})),r=O(n);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=i.type.items,s=O(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;e[l]&&(i.current+=e[l])}}catch(e){s.e(e)}finally{s.f()}i.current>=i.target&&(i.current=i.target,this.exp+=1,$u.emit(Zu.COMPLETE_QUEST,i))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"handleQuestMatch",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(e){return"Match"===e.type.name&&e.current<e.target})),r=O(n);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.type.tiles;if(0===i.length)a.current+=1;else{var o,s=O(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;e[l]&&(a.current+=e[l])}}catch(e){s.e(e)}finally{s.f()}}a.current>=a.target&&(a.current=a.target,this.exp+=1,$u.emit(Zu.COMPLETE_QUEST,a))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"handleQuestReachCombo",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(t){return"ReachCombo"===t.type.name&&t.current<t.target&&e===t.type.minCombo})),r=O(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.current++,a.current>=a.target)a.current=a.target,this.exp+=1,codex.player.getPlayerData().gameData.level>1&&$u.emit(Zu.COMPLETE_QUEST,a)}}catch(e){r.e(e)}finally{r.f()}}}}],[{key:"initData",value:function(){e.getInstance()}},{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"finishGame",value:function(){var t=e.getInstance();t.handleQuestCompleteLevel(),e.checkAllLevelsCompleted(),t.updateQuestPlayerData()}},{key:"useItem",value:function(t){var n=e.getInstance();n.handleQuestUseItem(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"matchTile",value:function(t){var n=e.getInstance();n.handleQuestMatch(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"reachCombo",value:function(t){var n=e.getInstance();n.handleQuestReachCombo(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"checkAllLevelsCompleted",value:function(){var t=e.getInstance();t.currentStage>3||t.quests[t.currentStage-1].every((function(e){return e.current>=e.target}))&&t.currentStage<3&&t.currentStage++}},{key:"getExp",value:function(){return e.getInstance().exp}},{key:"getMaxExp",value:function(){return 3*e.getInstance().rewardList.length}},{key:"getCurrentStage",value:function(){var t=e.getInstance();return t.currentStage>3?3:t.currentStage}},{key:"getCurrentQuestsInStage",value:function(t){var n=e.getInstance(),r=void 0===t?n.currentStage:t;return r>3&&(r=3),r-1<n.quests.length?n.quests[r-1]:(console.warn("DailyQuestManager: current stage out of range"),[])}},{key:"getRewards",value:function(){return e.getInstance().rewardList}},{key:"getRewarded",value:function(){return e.getInstance().rewarded}},{key:"updateGetChestReward",value:function(t){var n=e.getInstance();t>=n.rewarded.length?console.warn("DailyQuestManager: index out of range"):(n.rewarded[t]=!0,n.updateQuestPlayerData())}},{key:"canGetReward",value:function(t){return t+1<e.getInstance().currentStage||3===e.getInstance().currentStage&&this.getExp()===this.getMaxExp()}},{key:"getRewardIsNotClaimed",value:function(){return e.getInstance().rewardIsNotClaimed}},{key:"resetRewardIsNotClaimed",value:function(){e.getInstance().rewardIsNotClaimed={UndoItem:0,HintItem:0,ShuffleItem:0}}},{key:"showCompleteQuestPopupIfReady",value:function(){this.instance.questShowingInPopup&&($u.emit(Zu.COMPLETE_QUEST,this.instance.questShowingInPopup),this.instance.questShowingInPopup=void 0)}}]),e}());t._RF.pop(),t._RF.push({},"a4b9amW8vpEPJQAJqCTMQL7","ItemUtils",void 0);var tc=codex.player,nc=e("O",function(){function e(){N(this,e)}return I(e,null,[{key:"getPlayerItems",value:function(){var e=tc.getGameData();return null!=e&&e.items?e.items:{}}},{key:"setPlayerItems",value:function(e){var t=tc.getGameData();if(t){var n=G({},t);n.items=e,tc.setGameData(n)}}},{key:"getPlayerItem",value:function(e){return this.getPlayerItems()[e]||null}},{key:"setPlayerItem",value:function(e,t){var n=this.getPlayerItems();n[e]=t,this.setPlayerItems(n)}},{key:"getItemCount",value:function(e){var t=this.getPlayerItem(e);return(null==t?void 0:t.count)||0}},{key:"setItemCount",value:function(e,t){var n=this.getPlayerItem(e);n&&(n.count=t,this.setPlayerItem(e,n))}},{key:"isItemFirstUse",value:function(e){var t=this.getPlayerItem(e);return(null==t?void 0:t.isFirstUse)||!1}},{key:"setItemFirstUse",value:function(e,t){var n=this.getPlayerItem(e);n&&(n.isFirstUse=t,this.setPlayerItem(e,n))}},{key:"useItem",value:function(e){var t={};t[e]=1,ec.useItem(t);var n=this.getPlayerItem(e);return n?0===n.count?0:(n.count--,this.setPlayerItem(e,n),n.count):0}},{key:"addItem",value:function(e,t){var n=this.getPlayerItem(e);return n?(n.count+=t,this.setPlayerItem(e,n),n.count):0}},{key:"removeAllItem",value:function(){var e=this;Object.values(bt).forEach((function(t){"number"==typeof t&&e.setItemCount(wt[t],0)}))}}]),e}());t._RF.pop(),t._RF.push({},"00c2dnXxOpJa5420SvRFrFD","DebugUtils",void 0);var rc=Ludex,ac=rc.Utils,ic=ac.Valid,oc=ac.Array,sc=rc.Plugins.Ads.Types,lc=rc.Configs.Debugger.ListPlayerDevIds,uc=rc.Configs,cc=codex.event,dc=!0,pc=["Gameplay","General","Ads","LiveOps"],hc=e("X",function(){function e(){N(this,e),this.pane=null,this.toggleButton=null,this.showStats=!1,this.autoPlay=!1,this.autoPlayInterval=null,this.liveOpsTab=null}return I(e,[{key:"listenUnlockEvent",value:function(){var t=this;cc.on(Wu.Events.UNLOCK_DEV_TOOLS,(function(){"none"===t.toggleButton.style.display?(t.toggleButton.style.display="flex",e.unlockDebugger()):(t.toggleButton.style.display="none",e.lockDebugger())}))}},{key:"addToggleButton",value:function(){var t=this,n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="50px",n.style.height="50px",n.style.zIndex="1000",n.style.background="rgba(0,0,0,0.5)",n.style.borderRadius="8px",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.cursor="pointer",n.style.color="#fff",n.style.fontWeight="bold",n.innerText="",n.addEventListener("click",(function(){t.pane&&!0===t.pane.hidden?e.unlockDebugger():e.lockDebugger()})),document.body.appendChild(n),this.toggleButton=n}},{key:"addDebugPane",value:function(){var e=new yl,t=pc,n=e.addTab({pages:t.map((function(e){return{title:e}}))});this.liveOpsTab=n.pages[t.indexOf("LiveOps")],this.addGeneralDebugContent(n.pages[t.indexOf("General")]),this.addGameplayDebugContent(n.pages[t.indexOf("Gameplay")]),this.addAdsDebugContent(n.pages[t.indexOf("Ads")]),this.pane=e,this.addOpacityControl(n)}},{key:"addOpacityControl",value:function(e){var t=this;if(this.pane){var n,r=O(e.pages);try{for(r.s();!(n=r.n()).done;){n.value.addBinding({opacity:1},"opacity",{min:0,max:1,step:.01,label:"Pane Opacity"}).on("change",(function(e){t.pane&&(t.pane.element.style.opacity=e.value.toString())}))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"addGeneralDebugContent",value:function(t){var n=this,r=t.addFolder({title:"Game Stats"});this.showStats=ic.isDebugger()||oc.has(lc,codex.player.getPlayerId()),r.addBinding({value:this.showStats},"value",{label:"Show Game Stats"}).on("change",(function(e){var t=T.getScene().getComponentInChildren(Ku);e.value?null==t||t.enableGameStats():null==t||t.disableGameStats(),n.showStats=e.value})),t.addButton({title:"Reset Player Data"}).on("click",(function(){var e=Nt;codex.player.setPlayerData(e),console.log("Player data:",codex.player.getPlayerData())})),t.addButton({title:"Disable Debugger"}).on("click",(function(){n.toggleButton.style.display="none",e.lockDebugger()})),t.addFolder({title:"Other",expanded:!1}).addBinding({value:codex.getBuildVersion()},"value",{readonly:!0,label:"Build Version",step:1})}},{key:"addGameplayDebugContent",value:function(e){this.addGameplayLevelDebugContent(e),this.addItemDebugContent(e),this.addGameBoardDebugContent(e)}},{key:"getGameplay",value:function(){return T.getScene().getComponentInChildren("Gameplay")}},{key:"emitSceneEvent",value:function(e,t){t?T.getScene().emit(e,t):T.getScene().emit(e)}},{key:"addGameplayLevelDebugContent",value:function(e){var t=this,n=e.addFolder({title:"Level",expanded:!1});n.addButton({title:"Win Level"}).on("click",(function(){var e=t.getGameplay();null==e||e.handleGameWin()})),n.addButton({title:"Lose Level"}).on("click",(function(){var e=t.getGameplay();null==e||e.handleGameOver()})),n.addBinding({Level:1},"Level",{step:1}).on("change",(function(e){var n=e.value;if(t.emitSceneEvent(qu.SELECT_LEVEL,{level:n}),!t.getGameplay()){var r=Math.max(n,1);me.setLevel(r),me.setMaxLevel(r)}})),n.addButton({title:"Next Level"}).on("click",(function(){var e=me.getLevel();e&&t.emitSceneEvent(qu.SELECT_LEVEL,{level:e+1})})),n.addButton({title:"Previous Level"}).on("click",(function(){var e=me.getLevel();e&&t.emitSceneEvent(qu.SELECT_LEVEL,{level:e-1})}))}},{key:"addItemDebugContent",value:function(e){var t=this,n=e.addFolder({title:"Items",expanded:!1});n.addButton({title:"Remove All Items"}).on("click",(function(){t.debugAddItem(0,!0)})),n.addButton({title:"+1 Item"}).on("click",(function(){t.debugAddItem(1)})),n.addButton({title:"+10 Item"}).on("click",(function(){t.debugAddItem(10)}))}},{key:"debugAddItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];nc.addItem(wt[bt.HINT],e),nc.addItem(wt[bt.UNDO],e),nc.addItem(wt[bt.SHUFFLE],e),t&&nc.removeAllItem();var n=T.getScene();n.emit(qu.ITEM_COUNT_CHANGE,bt.HINT,nc.getItemCount(wt[bt.HINT])),n.emit(qu.ITEM_COUNT_CHANGE,bt.UNDO,nc.getItemCount(wt[bt.UNDO])),n.emit(qu.ITEM_COUNT_CHANGE,bt.SHUFFLE,nc.getItemCount(wt[bt.SHUFFLE]))}},{key:"addGameBoardDebugContent",value:function(e){var t=this,n=e.addFolder({title:"GameBoard",expanded:!1});n.addButton({title:"Auto Play"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&(t.autoPlay?(clearInterval(t.autoPlayInterval),t.autoPlay=!1):(t.autoPlay=!0,t.autoPlayInterval=setInterval((function(){if(!e.isGamePlaying())return clearInterval(t.autoPlayInterval),void(t.autoPlay=!1);e.tileManager.handleAutoPlay()}),800)))})),n.addButton({title:"Auto Step"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&(null==e||e.tileManager.handleAutoPlay())})),n.addButton({title:"Auto Finish Level"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&T.getScene().emit(qu.AUTO_FINISH_LEVEL)})),n.addButton({title:"Shuffle Board"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&t.emitSceneEvent(qu.START_SHUFFLE)})),n.addButton({title:"Hint"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&t.emitSceneEvent(qu.SHOW_HINT,{noAd:!0})})),n.addButton({title:"Undo"}).on("click",(function(){var e=t.getGameplay();null!=e&&e.isGamePlaying()&&t.emitSceneEvent(qu.START_UNDO)}))}},{key:"addAdsDebugContent",value:function(e){this.addBannerAdsDebugContent(e),this.addInterstitialAdsDebugContent(e),this.addRewardedAdsDebugContent(e),this.addAdsConfigDebugContent(e)}},{key:"addBannerAdsDebugContent",value:function(e){var t=e.addFolder({title:"Banner Ads",expanded:!1});t.addButton({title:"Show Banner Ads"}).on("click",(function(){ct.showBannerAds()})),t.addButton({title:"Hide Banner Ads"}).on("click",(function(){ct.hideBannerAds()}))}},{key:"addInterstitialAdsDebugContent",value:function(e){var t=e.addFolder({title:"Interstitial Ads",expanded:!1});t.addButton({title:"Remove Ads 30 days"}).on("click",R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Date.now()+2592e6,codex.player.setGameData({removeAdEndTime:t}),ct.checkRemoveAdEndTime();case 3:case"end":return e.stop()}}),e)})))),t.addButton({title:"Cancel Remove Ads"}).on("click",R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:codex.player.setGameData({removeAdEndTime:0}),ct.checkRemoveAdEndTime();case 2:case"end":return e.stop()}}),e)})))),t.addButton({title:"Load Inter Ads"}).on("click",R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ct.preloadAdsByType(sc.INTERSTITIAL,"interstitial_demo");case 1:case"end":return e.stop()}}),e)})))),t.addButton({title:"Show Inter Ads"}).on("click",R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ct.isReadyAdShowable(sc.INTERSTITIAL)){e.next=3;break}return e.next=3,ct.showInterstitialAdAsync();case 3:case"end":return e.stop()}}),e)}))))}},{key:"addRewardedAdsDebugContent",value:function(e){var t=e.addFolder({title:"Rewarded Ads",expanded:!1});t.addButton({title:"Load Reward Ads"}).on("click",R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ct.preloadAdsByType(sc.REWARDED_INTERSTITIAL,"rewarded_interstitial_demo");case 1:case"end":return e.stop()}}),e)})))),t.addButton({title:"Show Reward Inter Ads"}).on("click",R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ct.isReadyAdShowable(sc.REWARDED_INTERSTITIAL)){e.next=5;break}return e.next=3,ct.showRewardedInterstitialAdAsync();case 3:e.sent&&(t={items:[{item:bt.HINT,count:1},{item:bt.SHUFFLE,count:1}],watchAdsDoubleReward:!0,successCallback:function(){},earnFrom:"Debugger"},Ke.openScreen(Be.REWARD_SCREEN,t));case 5:case"end":return e.stop()}}),e)})))),t.addButton({title:"Show Reward Video Ads"}).on("click",R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ct.isReadyAdShowable(sc.REWARDED_VIDEO)){e.next=5;break}return e.next=3,ct.showRewardVideoAdAsync();case 3:e.sent&&(t={items:[{item:bt.HINT,count:1},{item:bt.SHUFFLE,count:1}],watchAdsDoubleReward:!0,successCallback:function(){},earnFrom:"Debugger"},Ke.openScreen(Be.REWARD_SCREEN,t));case 5:case"end":return e.stop()}}),e)}))))}},{key:"addAdsConfigDebugContent",value:function(e){var t,n=e.addFolder({title:"Ad Configs",expanded:!1}),r=uc.Ads.InterstitialAdOptions,a=O(r);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.addBinding({PlacementId:i.PlacementId},"PlacementId",{label:"Placement ID",readonly:!0}),n.addBinding({Interval:i.SecondsBetweenAds},"Interval",{label:"Ad Interval (s)",readonly:!0}),n.addBinding({FirstAdTime:i.SecondsFirstTime},"FirstAdTime",{label:"First Ad Time (s)",readonly:!0}),n.addBlade({view:"separator"})}}catch(e){a.e(e)}finally{a.f()}}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initDebugger",value:function(){try{if(this.inst.pane||!dc)return;this.inst.addDebugPane(),this.inst.addToggleButton(),ic.isDebugger()?(this.inst.toggleButton.style.display="flex",this.unlockDebugger()):(this.inst.toggleButton.style.display="none",this.lockDebugger()),this.inst.listenUnlockEvent()}catch(e){console.error("Error initializing DebugUtils",e)}}},{key:"unlockDebugger",value:function(){this.inst.pane&&(this.inst.pane.hidden=!1,this.inst.pane.element.style.opacity="1")}},{key:"lockDebugger",value:function(){this.inst.pane&&(this.inst.pane.hidden=!0)}},{key:"isCanShowGameStats",value:function(){return this.inst.showStats}},{key:"isEnabled",value:function(){return this.inst.pane&&!this.inst.pane.hidden}},{key:"addLiveOpsFolder",value:function(e){var t;if(this.inst.liveOpsTab)return null===(t=this.inst.liveOpsTab)||void 0===t?void 0:t.addFolder({title:e,expanded:!1})}},{key:"addLiveOpsButton",value:function(e,t,n){var r=e;null==r||r.addButton({title:t}).on("click",n)}},{key:"addLiveOpsBinding",value:function(e,t,n,r,a){var i=e;null==i||i.addBinding(t,n,r).on("change",(function(e){a&&a(e)}))}}]),e}());t._RF.pop(),t._RF.push({},"2e5d33KoHNIZr8OFwu9AMl9","JourneyThemeHandler",void 0);var vc,fc=e("a5",function(e){return e.SPRING_DOLLS="spring-dolls",e.TEA_CEREMONY="tea-ceremony",e.CHERRY_BLOSSOM="cherry-blossom",e.HALLOWEEN="halloween",e.THANKSGIVING="thanksgiving",e}({})),mc=[{theme:fc.SPRING_DOLLS,addedAtSeason:0},{theme:fc.TEA_CEREMONY,addedAtSeason:0},{theme:fc.CHERRY_BLOSSOM,addedAtSeason:0},{theme:fc.HALLOWEEN,addedAtSeason:5},{theme:fc.THANKSGIVING,addedAtSeason:7}],gc="journey-button",yc="footer-landscape",bc="footer-portrait",_c=function(){function e(){N(this,e),this.journeyTheme=fc.CHERRY_BLOSSOM,this.spriteDictionary={},this.loadedTileThemes=new Set}var t,n,r;return I(e,[{key:"setSeasonTheme",value:function(e){this.journeyTheme=this.getSeasonThemeById(e)}},{key:"getSeasonThemeById",value:function(e){if(e<=0)return console.warn("Season id should be greater than 0"),fc.CHERRY_BLOSSOM;for(var t=mc.map((function(e){return e.addedAtSeason})),n=e,r=0,a=[],i=-1,o=0;o<t.length&&!(n<=t[o]);o++)a.push(mc[o].theme),o>0&&t[o]===t[o-1]||(r=t[o]+1,i=o);return-1===i?a[e%a.length]:a[(n-r+i)%a.length]}},{key:"getJourneyTheme",value:function(){return this.journeyTheme}},{key:"isNeedLoadCurrentJourneyBadge",value:function(){var e,t=this.getJourneyTheme(),n=O(Bt.JOURNEY_BADGE_KEYS);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!this.getSpriteFrame({theme:t,key:r}))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"loadSpritesOnly",value:(r=R(D().mark((function e(t){var n,r,a,i,o=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=O(t),e.prev=2,i=D().mark((function e(){var t,r,i,s,l,u,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.value,r=t.theme,i=t.key,s=t.prefix,l=void 0===s?St.JOURNEY_BADGE_PREFIX:s,u="".concat(l).concat(r,"/").concat(i,"/spriteFrame"),(c=se.loadSpriteFrameAsync(u)).then((function(e){e&&(o.spriteDictionary["".concat(r,"/").concat(i)]=e)})),n.push(c);case 6:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=9;break}return e.delegateYield(i(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),r.e(e.t1);case 14:return e.prev=14,r.f(),e.finish(14);case 17:return e.next=19,Promise.all(n);case 19:case"end":return e.stop()}}),e,null,[[2,11,14,17]])}))),function(e){return r.apply(this,arguments)})},{key:"loadSprites",value:(n=R(D().mark((function e(t){var n,r,a,i,o,s,l=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadSpritesOnly(t);case 2:n=[],r=O(t);try{for(r.s();!(a=r.n()).done;)i=a.value,o=i.theme,s=i.key,this.spriteDictionary["".concat(o,"/").concat(s)]||(console.warn("Badge not loaded: ".concat(o,"/").concat(s)),n.push(i))}catch(e){r.e(e)}finally{r.f()}n.length>0&&Gt(500).then((function(){l.loadSpritesOnly(n)}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getSpriteFrame",value:function(e){var t=e.theme,n=e.key,r=this.spriteDictionary["".concat(t,"/").concat(n)];return r||null}},{key:"loadJourneyTileThemeSpriteFrames",value:(t=R(D().mark((function e(t){var n,r,a,i,o;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t||this.getJourneyTheme(),!this.loadedTileThemes.has(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,se.loadSpriteFramesDirAsync("".concat(St.TILE_PREFIX).concat(n,"/"));case 5:r=e.sent,a=O(r);try{for(a.s();!(i=a.n()).done;)o=i.value,this.spriteDictionary["".concat(n,"/tile-").concat(o.name)]=o}catch(e){a.e(e)}finally{a.f()}this.loadedTileThemes.add(n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"loadJourneyButtonSpriteFrame",value:function(e){var t=e||this.getJourneyTheme();if(!this.getSpriteFrame({theme:t,key:gc}))return this.loadSprites([{theme:t,key:gc,prefix:St.JOURNEY_UI_PREFIX}])}},{key:"loadJourneyFooterSpriteFrame",value:function(e){var t=e||this.getJourneyTheme(),n=Tt.isLandscape()?yc:bc;if(!this.getSpriteFrame({theme:t,key:n}))return this.loadSprites([{theme:t,key:n,prefix:St.JOURNEY_UI_PREFIX}])}},{key:"getJourneyFooterSpriteFrame",value:function(e){var t=e||this.getJourneyTheme(),n=Tt.isLandscape()?yc:bc;return this.getSpriteFrame({theme:t,key:n})||null}},{key:"getJourneyButtonSpriteFrame",value:function(e){var t=e||this.getJourneyTheme();return this.getSpriteFrame({theme:t,key:gc})||null}},{key:"getCurrentArtifactTileSprite",value:function(e){return this.getSpriteFrame({theme:this.getJourneyTheme(),key:"tile-".concat(e)})||null}},{key:"getJourneyBadgeSpriteFrame",value:function(e,t){return this.getSpriteFrame({theme:t||this.getJourneyTheme(),key:e})||null}},{key:"isLoadedCurrentJourneyTileTheme",value:function(){return this.loadedTileThemes.has(this.getJourneyTheme())}}]),e}();t._RF.pop(),t._RF.push({},"d9055/fQMJA1IROHPh96rOA","JourneyUtils",void 0);var wc,Ec=codex.player,kc={journeyLevel:1,gameLevel:1200,type:Vt.HIDDEN_TILE,seed:123456789,key:"mock-complete-game"},Cc=e("a7",function(e){return e.BADGE_1="1",e.BADGE_2="2",e.BADGE_3="3",e.CHEST="chest",e}({})),Sc=e("J",function(){function e(){N(this,e),this.currentLevel=1,this.season=1,this.seasonIds=[],this.badgeDictionary={},this.playingCurrentLevel=!1,this.loadedSeason={},this.config={season:1,count:Bt.JOURNEY_LEVEL_COUNT,startTime:new Date(Bt.SEASON_START_AT),endTime:new Date(Bt.SEASON_START_AT+Bt.SEASON_DURATION)}}var t,n;return I(e,[{key:"validateSeasonId",value:function(e){return e>=1&&!1===Number.isNaN(e)}},{key:"expandDateString",value:function(e){var t=e.slice(4,6),n=e.slice(2,4),r="20".concat(e.slice(0,2));return"".concat(r,"/").concat(n,"/").concat(t)}},{key:"shortenDateString",value:function(e){var t=e.split("/"),n=W(t,3),r=n[0],a=n[1],i=n[2];return"".concat(r.slice(2)).concat(a).concat(i)}},{key:"updateSeasonsHaveBadges",value:function(){var e=[];for(var t in this.badgeDictionary){var n=t.split("/"),r=W(n,2),a=r[0];r[1];e.includes(parseInt(a))||e.push(parseInt(a))}e.sort((function(e,t){return e-t})),this.seasonIds=e}},{key:"updatePlayerData",value:function(){var e,t=[],n=O(this.seasonIds);try{for(n.s();!(e=n.n()).done;){var r=e.value,a="".concat(r,"/").concat(Cc.BADGE_1),i="".concat(r,"/").concat(Cc.BADGE_2),o="".concat(r,"/").concat(Cc.BADGE_3),s=this.badgeDictionary[a],l=this.badgeDictionary[i],u=this.badgeDictionary[o];if(s||l||u){var c="".concat(r);c+=s?"-".concat(this.shortenDateString(s)):"",c+=l?"-".concat(this.shortenDateString(l)):"",c+=u?"-".concat(this.shortenDateString(u)):"",t.push(c)}}}catch(e){n.e(e)}finally{n.f()}Ec.setGameData({journeyData:{lastSeason:this.season,currentLevel:this.currentLevel,claimBadges:t}})}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initAsync",value:(n=R(D().mark((function e(){var t,n,r,a,i,o,s,l,u,c,d,p,h,v,f,m,g,y;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inst.badgeDictionary={},t=Ec.getGameData().journeyData,n=t.lastSeason,r=t.currentLevel,a=t.claimBadges,i=this.inst.validateSeasonId(n)?n:1,this.inst.season=i,this.inst.currentLevel=r||1,o=O(a),e.prev=6,o.s();case 8:if((s=o.n()).done){e.next=21;break}if(l=s.value,u=l.split("-"),c=W(u,4),d=c[0],p=c[1],h=c[2],v=c[3],void 0!==d){e.next=13;break}return e.abrupt("continue",19);case 13:f="".concat(d,"/").concat(Cc.BADGE_1),m="".concat(d,"/").concat(Cc.BADGE_2),g="".concat(d,"/").concat(Cc.BADGE_3),p&&(this.inst.badgeDictionary[f]=this.inst.expandDateString(p)),h&&(this.inst.badgeDictionary[m]=this.inst.expandDateString(h)),v&&(this.inst.badgeDictionary[g]=this.inst.expandDateString(v));case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),o.e(e.t0);case 26:return e.prev=26,o.f(),e.finish(26);case 29:return this.inst.updateSeasonsHaveBadges(),y=this.createConfig(1),this.inst.config=this.getSeasonConfigPlayerCurrentlyIn(new Date)||y,this.setSeason(this.inst.config.season),i!==this.inst.config.season&&this.resetNewSeason(),this.updateGetBadges(),e.next=37,this.themeHandler.loadJourneyButtonSpriteFrame();case 37:this.addDebugContent();case 38:case"end":return e.stop()}}),e,this,[[6,23,26,29]])}))),function(){return n.apply(this,arguments)})},{key:"addDebugContent",value:function(){var t=hc.addLiveOpsFolder("Journey");t&&(hc.addLiveOpsButton(t,"Restart Journey",(function(){e.resetNewSeason();var t=T.getScene().getComponentInChildren("JourneyLevelScreen");null==t||t.scrollToTargetLevel(e.getCurrentLevel())})),hc.addLiveOpsButton(t,"End Journey in 5s",(function(){var t=(new Date).getTime()+5e3;e.setEndTime(new Date(t))})),hc.addLiveOpsButton(t,"End Journey in 30s",(function(){var t=(new Date).getTime()+3e4;e.setEndTime(new Date(t))})),hc.addLiveOpsButton(t,"Advance to Next Level",(function(){e.increaseLevel();var t=T.getScene().getComponentInChildren("JourneyLevelScreen");null==t||t.processIncreaseLevel()})),hc.addLiveOpsBinding(t,{Level:1},"Level",{min:1,max:e.getLevelCount(),step:1},(function(t){var n=t.value;e.setCurrentLevel(n);var r=T.getScene().getComponentInChildren("JourneyLevelScreen");null==r||r.loadJourneyData(),null==r||r.updatePlayButton(),null==r||r.scrollToTargetLevel(e.getCurrentLevel()),null==r||r.runScrollerAnimation(!1),null==r||r.reusableScroller.scrollToTargetLevel(n)})),hc.addLiveOpsBinding(t,{Season:e.getSeason()},"Season",{min:e.getSeason(),step:1},function(){var t=R(D().mark((function t(n){var r,a;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.value,e.setSeason(r),e.resetNewSeason(),null==(a=T.getScene().getComponentInChildren("JourneyLevelScreen"))||a.loadJourneyData(),null==a||a.updatePlayButton(),null==a||a.reusableScroller.scrollToTargetLevel(e.getCurrentLevel()),Ke.showLoadingScreen(),t.next=10,e.loadJourneyButtonSpriteFrame();case 10:Ke.closeLoadingScreen(),Ke.closeScreen(Be.JOURNEY_LEVEL_SCREEN);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},{key:"updateGetBadges",value:function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear(),a="".concat(r,"/").concat(n.toString().padStart(2,"0"),"/").concat(t.toString().padStart(2,"0")),i=this.inst.season,o="".concat(i,"/").concat(Cc.BADGE_1),s="".concat(i,"/").concat(Cc.BADGE_2),l="".concat(i,"/").concat(Cc.BADGE_3),u=void 0!==this.inst.badgeDictionary[o],c=void 0!==this.inst.badgeDictionary[s],d=void 0!==this.inst.badgeDictionary[l],p=!1;this.inst.currentLevel>Bt.REWARD_1_LEVEL&&!u&&(this.inst.badgeDictionary[o]=a,p=!0),this.inst.currentLevel>Bt.REWARD_2_LEVEL&&!c&&(this.inst.badgeDictionary[s]=a,p=!0),this.inst.currentLevel>Bt.REWARD_3_LEVEL&&!d&&(this.inst.badgeDictionary[l]=a,p=!0),p&&this.inst.updateSeasonsHaveBadges()}},{key:"createLevelData",value:function(){for(var t=this.getCurrentSeasonConfig(),n=[],r=Bt.MIN_GAME_LEVEL,a=Bt.MAX_GAME_LEVEL,i=me.getStepLevel(),o=this.themeHandler.getJourneyTheme().toString(),s=e.xmur3(o),l=[],u=r;u<=a;u+=i)l.push(u);for(var c=this.seededShuffle(l,s),d=c.slice(0,Bt.JOURNEY_SET_SELECT),p=[Vt.HIDDEN_TILE,Vt.TARGET_TILE,Vt.FIND_ARTIFACT],h=[[0,2,1],[2,0,1],[0,1,2],[1,2,0],[2,1,0],[1,0,2]],v=[],f=c.length-1,m=0;m<i;m++)v.push(d[f]+m);for(var g=0,y=1;y<=t.count;y++){if(g>=Bt.JOURNEY_SET_LEVEL_COUNT){f--,g=0,v=[];for(var b=0;b<i;b++)v.push(d[f]+b)}var _=y-1,w=p[h[Math.floor(_/p.length)%6][(_+p.length)%p.length]],E=this.createRandomJourneyMission(v,y,w);n.push(E);var k=v.indexOf(E.gameLevel);-1!==k?(v.splice(k,1),g++):console.error("Level mission not found in allLevelsInSet:",E)}this.inst.loadedSeason[t.season]=n}},{key:"canUpdateNewSeason",value:function(e){var t=this.getSeasonConfigPlayerCurrentlyIn(e);return!!t&&t.season!==this.getSeason()}},{key:"canUpdateIncreaseSeason",value:function(){var e=this.getSeasonConfigPlayerCurrentlyIn(new Date);if(!e)return!1;var t=jt(this.inst.config.endTime.getTime()/1e3).remainingTimeInMs;return e.season>this.getSeason()||t<=0}},{key:"getSeasonConfigPlayerCurrentlyIn",value:function(e){var t=Bt.SEASON_START_AT,n=Bt.SEASON_DURATION,r=e.getTime(),a=Math.ceil((r-t)/n);return this.createConfig(a)}},{key:"createConfig",value:function(e){var t=Bt.SEASON_START_AT,n=Bt.SEASON_DURATION,r=t+n*(e-1),a=r+n;return{season:e,count:this.getLevelCount(),startTime:new Date(r),endTime:new Date(a)}}},{key:"resetNewSeason",value:function(){this.setCurrentLevel(1)}},{key:"getSeason",value:function(){return this.inst.season=this.inst.config.season,this.inst.season}},{key:"getCurrentSeasonConfig",value:function(){return this.inst.config}},{key:"increaseSeason",value:function(){var e=this.getSeason()+1,t=this.setSeason(e);return t&&this.resetNewSeason(),t}},{key:"setSeason",value:function(e){return!this.isPlayingCurrentLevel()&&(this.inst.config=this.createConfig(e),this.inst.season=e,this.inst.updatePlayerData(),this.themeHandler.setSeasonTheme(e),this.createLevelData(),!0)}},{key:"setEndTime",value:function(e){this.inst.config.endTime=e}},{key:"getTimeStart",value:function(){return this.inst.config.startTime.getTime()/1e3}},{key:"getTimeEnd",value:function(){return this.inst.config.endTime.getTime()/1e3}},{key:"getMinLevelToUnlockJourney",value:function(){return Bt.MIN_GAME_LEVEL_TO_UNLOCK_JOURNEY}},{key:"checkJourneyUnlock",value:function(){var e=this.getMinLevelToUnlockJourney();return me.getMaxLevel()>=e}},{key:"checkJourneyComplete",value:function(){var e=this.getLevelCount();return this.getCurrentLevel()>e}},{key:"getJourneyEndTime",value:function(){var t=e.getTimeEnd();if(!t)return{key:"customString",params:[Ht(0,!0)],remainingTime:0};var n=jt(t),r=n.remainingTimeInMs,a=Math.floor(r/864e5);if(r<864e5)return{key:"customString",params:[Ht(r,!0)],remainingTime:r};var i=function(e){if(e<=0)return{days:0,hours:0,minutes:0,seconds:0};var t=e,n=Math.floor(t/864e5);t-=864e5*n;var r=Math.floor(t/36e5);t-=36e5*r;var a=Math.floor(t/6e4);return t-=6e4*a,{days:n,hours:r,minutes:a,seconds:Math.floor(t/1e3)}}(n.remainingTimeInMs);return{key:"dhm",params:[a.toString(),i.hours.toString(),i.minutes.toString()],remainingTime:r}}},{key:"isCurrentLevelTheLast",value:function(){return this.getCurrentLevel()===this.getLevelCount()}},{key:"getCurrentLevel",value:function(){return this.inst.currentLevel}},{key:"getCompletedLevel",value:function(){return this.inst.currentLevel-1}},{key:"getCurrentRewardLevel",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?this.getCurrentLevel():this.getCompletedLevel(),n=0;n<Bt.REWARD_LEVELS.length;n++)if(t<=Bt.REWARD_LEVELS[n]&&t>(Bt.REWARD_LEVELS[n-1]||0))return Bt.REWARD_LEVELS[n];return Bt.REWARD_LEVELS[Bt.REWARD_LEVELS.length-1]}},{key:"getCurrentRewardType",value:function(e){return e===Bt.REWARD_1_LEVEL?Cc.BADGE_1:e===Bt.REWARD_2_LEVEL?Cc.BADGE_2:e===Bt.REWARD_3_LEVEL?Cc.BADGE_3:Cc.CHEST}},{key:"setCurrentLevel",value:function(e){if(!Number.isInteger(e))return!1;var t=this.getLevelCount();return console.log(t,e),!(e<1)&&(this.inst.currentLevel=e,this.updateGetBadges(),this.inst.updatePlayerData(),!0)}},{key:"getLevelCount",value:function(){var e,t=(null!==(e=this.inst.config)&&void 0!==e?e:{}).count;return void 0===t?Bt.REWARD_LEVELS[Bt.REWARD_LEVELS.length-1]:t}},{key:"increaseLevel",value:function(){return this.setCurrentLevel(this.inst.currentLevel+1)}},{key:"getConfig",value:function(){return this.inst.config}},{key:"isPlayingCurrentLevel",value:function(){return this.inst.playingCurrentLevel}},{key:"setIsPlayingCurrentLevel",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.inst.playingCurrentLevel!==e&&(this.inst.playingCurrentLevel=e)}},{key:"getCurrentSeasonMissions",value:function(){var e=this.getSeason(),t=this.inst.loadedSeason[e];return null!=t?t:[]}},{key:"getCurrentMission",value:function(){var e;return null!==(e=this.getCurrentSeasonMissions()[this.getCurrentLevel()-1])&&void 0!==e?e:kc}},{key:"getLastMission",value:function(){var e;return null!==(e=this.getCurrentSeasonMissions()[this.getCurrentLevel()-2])&&void 0!==e?e:kc}},{key:"getJourneyName",value:function(){var e=this.inst.config.season;return"Journey Season ".concat(e)}},{key:"createRandomJourneyMission",value:function(t,n,r){var a="".concat(n," "),i=e.xmur3(a);return{journeyLevel:n,gameLevel:t[i%t.length],type:r,seed:i}}},{key:"xmur3",value:function(e){for(var t=1779033703^e.length,n=0;n<e.length;n++)t=(t=Math.imul(t^e.charCodeAt(n),3432918353))<<13|t>>>19;return(t^t>>>16)>>>0}},{key:"separateSeedsToParts",value:function(e,t){for(var n=[],r=e,a=0;a<t;a++){var i=r%1e3;n.push(i),r=Math.floor(r/1e3)}return n}},{key:"getJourneyTileSkinIdx",value:function(t){var n=t.seed,r=e.separateSeedsToParts(n,3)[0],a=M(Ut);return a[Math.floor(r%a.length)]}},{key:"seededShuffle",value:function(e,t){var n,r,a=e.slice(),i=a.length,o=t;for(;i;)r=Math.floor((o=(9301*o+49297)%233280)/233280*i--),n=a[i],a[i]=a[r],a[r]=n;return a}},{key:"getSeasonIds",value:function(){return this.inst.seasonIds}},{key:"isNeedClaimedBadges",value:function(){for(var e in this.inst.badgeDictionary){var t=e.split("/"),n=W(t,2),r=n[0],a=n[1],i=this.getSeasonThemeById(parseInt(r));if(!this.themeHandler.getSpriteFrame({theme:i,key:a}))return!0}return!1}},{key:"getClaimedBadgesBySeasonId",value:function(e){var t=[];for(var n in this.inst.badgeDictionary){var r=n.split("/"),a=W(r,2),i=a[0],o=a[1];i===e.toString()&&this.inst.badgeDictionary[n]&&t.push(o)}return t}},{key:"isLevelWithBadges",value:function(){var e=this.getCurrentLevel();return e===Bt.REWARD_1_LEVEL||(e===Bt.REWARD_2_LEVEL||e===Bt.REWARD_3_LEVEL)}},{key:"getRewardByLevel",value:function(t){if(!Bt.REWARD_LEVELS.includes(t))return null;var n=e.getCurrentRewardType(t);switch(n){case Cc.BADGE_1:case Cc.BADGE_2:case Cc.BADGE_3:return{type:"Badge",key:n}}var r,a=0,i=O(Bt.REWARD_LEVELS);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o===t)break;o!==Bt.REWARD_1_LEVEL&&o!==Bt.REWARD_2_LEVEL&&o!==Bt.REWARD_3_LEVEL&&a++}}catch(e){i.e(e)}finally{i.f()}return{type:"Chest",chestIdx:a}}},{key:"getBadgeDate",value:function(e){var t=e.seasonId,n=e.key,r=this.inst.badgeDictionary["".concat(t,"/").concat(n)];return r||""}},{key:"getJourneyTheme",value:function(){return this.themeHandler.getJourneyTheme()}},{key:"isNeedPreloadJourney",value:function(){return this.themeHandler.isNeedLoadCurrentJourneyBadge()}},{key:"isNeedLoadCurrentJourneyBadge",value:function(){return this.themeHandler.isNeedLoadCurrentJourneyBadge()}},{key:"loadCurrentJourneyBadge",value:function(){return new Promise((function(t){if(e.isNeedLoadCurrentJourneyBadge()){var n,r=e.getJourneyTheme(),a=[],i=O(Bt.JOURNEY_BADGE_KEYS);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push({theme:r,key:o})}}catch(e){i.e(e)}finally{i.f()}e.themeHandler.loadSprites(a).then((function(){t()}))}else t()}))}},{key:"loadJourneyTileThemeSpriteFrames",value:(t=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.themeHandler.loadJourneyTileThemeSpriteFrames(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getJourneyFooterSpriteFrame",value:function(e){return this.themeHandler.getJourneyFooterSpriteFrame(e)}},{key:"getJourneyButtonSpriteFrame",value:function(e){return this.themeHandler.getJourneyButtonSpriteFrame(e)}},{key:"getCurrentArtifactTileSprite",value:function(e){return this.themeHandler.getCurrentArtifactTileSprite(e)}},{key:"getJourneyBadgeSpriteFrame",value:function(e,t){return this.themeHandler.getJourneyBadgeSpriteFrame(e,t)}},{key:"isLoadedCurrentJourneyTileTheme",value:function(){return this.themeHandler.isLoadedCurrentJourneyTileTheme()}},{key:"getSeasonThemeById",value:function(e){return this.themeHandler.getSeasonThemeById(e)}},{key:"logJourneyStartLevel",value:function(){codex.analytics.event(kt.JOURNEY_START_LEVEL,{level:this.getCurrentLevel(),season:this.getSeason()})}},{key:"logJourneyCompleteLevel",value:function(){codex.analytics.event(kt.JOURNEY_COMPLETE_LEVEL,{level:this.getCurrentLevel(),season:this.getSeason()})}},{key:"logJourneyGetBadge",value:function(e){codex.analytics.event(kt.JOURNEY_GET_BADGE,{item_name:e,season:this.getSeason()})}}]),e}());vc=Sc,Sc.themeHandler=new _c,Sc.loadClaimedBadges=function(){return new Promise((function(e){if(vc.isNeedClaimedBadges()){var t=[];for(var n in vc.inst.badgeDictionary){var r=n.split("/"),a=W(r,2),i=a[0],o=a[1],s=vc.getSeasonThemeById(parseInt(i));console.log({seasonId:i,theme:s}),t.push({theme:s,key:o})}vc.themeHandler.loadSprites(t).then((function(){e()}))}else e()}))},Sc.loadJourneyButtonSpriteFrame=function(e){return vc.themeHandler.loadJourneyButtonSpriteFrame(e)},Sc.loadJourneyFooterSpriteFrame=function(e){return vc.themeHandler.loadJourneyFooterSpriteFrame(e)},t._RF.pop(),t._RF.push({},"cedfajYJypBX4mKSbPz5pXd","TournamentUtils",void 0);var xc=Ludex,Tc=xc.Events,Lc=(xc.Utils,xc.Match),Ac=xc.Configs.Mockup.Leaderboards;function Pc(){var e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e||"[::1]"===e||/^192\.168\.\d+\.\d+$/.test(e)||/^10\.\d+\.\d+\.\d+$/.test(e)}var Rc=e("ac",[1,2,3,4,5]),Dc=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),Ic=e("ae",10),Nc=codex,Oc=Nc.player,Mc=Nc.event,Bc=Nc.leaderboard,Fc=e("V",function(){function e(){N(this,e),this.playerRank=0,this.leaderboardEntries=[],this.cachedLeaderAvatar=new Map,this.viewedRank=-1,this.playerTournaments=void 0,this.addedRealPlayers={}}var t,n,r,a,i,o,s,l,u;return I(e,[{key:"fetchTournamentData",value:(u=R(D().mark((function t(){var n,r,a,i,o,s,l;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.tournamentData,r=n.tournamentId,a=n.leaderboardId,t.next=3,Bc.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"});case 3:if(i=t.sent.filter((function(e){return e._id===a&&JSON.parse(e.description).tournamentID===r})),console.log("globalTournament",i),!(i.length>0)){t.next=19;break}return Bc.addLeaderboard({type:"tournament",name:a,autoSortRank:!0,leaderboardId:a}),t.next=9,e.getLeaderboardAsync(a,Ic);case 9:return t.next=11,e.getTournamentPlayerInfo();case 11:l=t.sent,this.playerRank=(null===(o=l[0])||void 0===o?void 0:o.rank)||0,this.tournamentData.bestScore=(null===(s=l[0])||void 0===s?void 0:s.score)||0,Oc.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!0,this.status=Dc.HAPPENING,t.next=20;break;case 19:this.isHasValidTournament=!1;case 20:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"checkTimeOut",value:(l=R(D().mark((function t(){var n,r,a,i;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.tournamentData,r=n.tournamentId,a=n.leaderboardId,i=n.endTime,!(r&&a&&i)){t.next=13;break}if(!(Date.now()/1e3>i&&this.status!==Dc.FINISHED)){t.next=11;break}return this.status=Dc.FINISHED,this.isHasValidTournament=!1,t.next=7,this.progressPreviousTournamentReward();case 7:return e.logTournamentEnd(),t.next=10,this.chooseNewTournament();case 10:e.updateCurrentLeaderboard();case 11:t.next=16;break;case 13:return t.next=15,this.chooseNewTournament();case 15:e.updateCurrentLeaderboard();case 16:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"chooseNewTournament",value:(s=R(D().mark((function t(){var n,r,a,i,o,s,l,u,c,d,p,h,v,f=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isPlayerJoined=!1,this.tournamentData.tournamentId="",this.tournamentData.leaderboardId="",this.tournamentData.endTime=0,this.tournamentData.bestScore=0,this.tournamentData.isPlayerJoined=!1,this.leaderboardEntries=[],!Ac.Enabled){t.next=36;break}return t.next=11,GameSDK.tournament.getTournamentsAsync();case 11:if(!((n=t.sent.filter((function(e){return e.getEndTime()-Date.now()/1e3>3600}))).length>0)){t.next=32;break}return i=n[0],o={id:i.getID().toString(),endTime:i.getEndTime(),contextId:i.getContextID(),payload:JSON.parse(i.getPayload()),tournamentType:"PAGE_HOSTED"},this.tournamentData.tournamentId=o.id,this.tournamentData.leaderboardId=o.payload.leaderboardId,this.tournamentData.endTime=o.endTime,t.next=20,e.getTournamentPlayerInfo();case 20:return s=t.sent,this.playerRank=(null===(r=s[0])||void 0===r?void 0:r.rank)||0,this.tournamentData.bestScore=(null===(a=s[0])||void 0===a?void 0:a.score)||0,Oc.setGameData({tournamentData:this.tournamentData}),Bc.addLeaderboard({type:"tournament",name:o.payload.leaderboardId,autoSortRank:!0,leaderboardId:o.payload.leaderboardId}),t.next=27,e.getLeaderboardAsync(this.tournamentData.leaderboardId,Ic);case 27:console.log("New tournament found:",i),this.isHasValidTournament=!0,this.status=Dc.WAITING,t.next=35;break;case 32:console.warn("No valid tournament found"),Oc.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!1;case 35:return t.abrupt("return");case 36:return t.next=38,Bc.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"});case 38:if(l=t.sent.filter((function(e){return f.getTournamentEndTime(e)-Date.now()/1e3>3600})),console.log("validTournament",l),!(l.length>0)){t.next=60;break}return d=l[0],p=JSON.parse(d.description),h={id:p.tournamentID,endTime:this.getTournamentEndTime(d),contextId:p.contextID,payload:{playerId:"global",playerName:"global",leaderboardId:d._id},tournamentType:"PAGE_HOSTED"},this.tournamentData.tournamentId=h.id,this.tournamentData.leaderboardId=h.payload.leaderboardId,this.tournamentData.endTime=h.endTime,t.next=49,e.getTournamentPlayerInfo();case 49:return v=t.sent,this.playerRank=(null===(u=v[0])||void 0===u?void 0:u.rank)||0,this.tournamentData.bestScore=(null===(c=v[0])||void 0===c?void 0:c.score)||0,Oc.setGameData({tournamentData:this.tournamentData}),Bc.addLeaderboard({type:"tournament",name:h.payload.leaderboardId,autoSortRank:!0,leaderboardId:h.payload.leaderboardId}),t.next=56,e.getLeaderboardAsync(this.tournamentData.leaderboardId,Ic);case 56:console.log("New tournament found:",d),this.isHasValidTournament=!0,t.next=63;break;case 60:console.warn("No valid tournament found"),Oc.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!1;case 63:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getTournamentEndTime",value:function(e){var t=new Date(e.createdAt).getTime();return Math.round(604800+t/1e3)}},{key:"progressPreviousTournamentReward",value:(o=R(D().mark((function t(){var n,r,a,i,o;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.tournamentData,r=n.tournamentId,a=n.leaderboardId,r&&a){t.next=3;break}return t.abrupt("return");case 3:i=e.getTournamentRank(),Rc.includes(i)?(o=Rc.indexOf(i)+1,console.log("Player ".concat(Oc.getPlayerId()," received reward ").concat(o," for rank ").concat(i)),this.tournamentData.lastTournamentRankReward=o,Oc.setGameData({tournamentData:this.tournamentData})):(this.tournamentData.lastTournamentRankReward=0,Oc.setGameData({tournamentData:this.tournamentData}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:(i=R(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this.inst.leaderboard=null,this.inst.isNewSession=!0,this.inst.tournamentData=Oc.getGameData().tournamentData,this.inst.isPlayerJoined=this.inst.tournamentData.isPlayerJoined,this.inst.status=Dc.WAITING,Mc.catchUp(Tc.GAME_SDK_READY,e.handleGameSDKReady),this.addDebugContent()}catch(e){console.error("Error initData TournamentUtils",e)}case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"addDebugContent",value:function(){var t=hc.addLiveOpsFolder("Tournament");t&&(hc.addLiveOpsButton(t,"End Tournament in 30s",(function(){var t=Date.now();e.inst.tournamentData.endTime=t/1e3+30})),hc.addLiveOpsButton(t,"End Tournament in 5s",(function(){var t=Date.now();e.inst.tournamentData.endTime=t/1e3+5})),hc.addLiveOpsButton(t,"Join Global Tournament",(function(){Qc.openPopupJoinGlobalTournament()})))}},{key:"updateData",value:function(){this.isHasValidTournament()&&this.inst.checkTimeOut()}},{key:"handleJoinFromPost",value:function(){this.inst.isPlayerJoined?console.log("TournamentUtils: Player already joined the tournament"):(this.inst.isPlayerJoined=!0,this.inst.tournamentData.isPlayerJoined=!0,Oc.setGameData({tournamentData:this.inst.tournamentData}),this.inst.status=Dc.HAPPENING,this.updateData())}},{key:"updateCurrentLeaderboard",value:(a=R(D().mark((function t(){var n,r,a,i,o,s,l,u,c,d,p,h,v=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(null===(n=this.inst.leaderboard)||void 0===n?void 0:n.leaders)||{},console.log("TournamentUtils: updateCurrentLeaderboard",r),a=D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=r[i])&&!v.inst.leaderboardEntries.some((function(e){return e.playerId===t.playerId}))&&v.inst.leaderboardEntries.push({playerId:t.playerId,score:t.score,name:t.name,avatarUrl:t.photo});case 2:case"end":return e.stop()}}),e)})),t.t0=D().keys(r);case 4:if((t.t1=t.t0()).done){t.next=9;break}return i=t.t1.value,t.delegateYield(a(),"t2",7);case 7:t.next=4;break;case 9:if(o=Oc.getPlayerId(),s=this.inst.tournamentData.bestScore,(l=this.inst.leaderboardEntries.find((function(e){return e.playerId===o})))||!(s>0)){t.next=26;break}u=!1,c=0;case 15:if(!(c<this.inst.leaderboardEntries.length)){t.next=23;break}if(!(this.inst.leaderboardEntries[c].score<s)){t.next=20;break}return this.inst.leaderboardEntries.push({playerId:o,score:s,name:Oc.getPlayer().name||"You",avatarUrl:Oc.getPlayer().photo||""}),u=!0,t.abrupt("break",23);case 20:c++,t.next=15;break;case 23:!u&&this.inst.leaderboardEntries.length<Ic&&this.inst.leaderboardEntries.push({playerId:o,score:s,name:Oc.getPlayer().name||"You",avatarUrl:Oc.getPlayer().photo||""}),t.next=27;break;case 26:l&&(l.score=s);case 27:this.inst.leaderboardEntries.sort((function(e,t){return t.score-e.score})),this.inst.leaderboardEntries.length>Ic&&this.inst.leaderboardEntries.pop(),d=0;case 30:if(!(d<this.inst.leaderboardEntries.length)){t.next=38;break}if(this.inst.leaderboardEntries[d].playerId!==Oc.getPlayerId()){t.next=35;break}return this.inst.playerRank=d+1,t.abrupt("break",38);case 35:d++,t.next=30;break;case 38:if(console.log("TournamentUtils: playerRank",this.inst.playerRank),!(this.inst.playerRank<=0&&s>0)){t.next=44;break}return t.next=42,e.getTournamentPlayerInfo();case 42:h=t.sent,this.inst.playerRank=Math.max((null===(p=h[0])||void 0===p?void 0:p.rank)||0,this.inst.leaderboardEntries.length+1);case 44:console.log("TournamentUtils: updateCurrentLeaderboard",this.inst.leaderboardEntries);case 45:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"updateLeaderboard",value:(r=R(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inst.leaderboard){t.next=3;break}return t.next=3,e.getLeaderboardAsync(e.getLeaderboardId(),Ic);case 3:e.updateCurrentLeaderboard();case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"resetRewardData",value:function(){this.inst.tournamentData.lastTournamentRankReward=0,Oc.setGameData({tournamentData:this.inst.tournamentData})}},{key:"getLeaderboard",value:function(){return console.log("Returning cached leaderboard data"),this.inst.leaderboardEntries}},{key:"getLeaderboardAsync",value:(n=R(D().mark((function t(n,r){var a,i,o,s,l,u,c,d,p,h,v,f;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Bc.getLeaderboardName(n)){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,Bc.requestLeaderboardAsync(a,r);case 5:for(i=Bc.getLeaderboard(a),e.useRealLeaderBoard&&i||(i={limit:r,offset:0,leaders:{},isRequesting:!1,amountPlayer:0,resettable:"manually"}),o=Object.values(this.inst.addedRealPlayers),s=0,l=o;s<l.length;s++)u=l[s],i.leaders[u.playerId]=u,console.log(u);return c=Oc.getPlayerId(),d=this.inst.tournamentData.bestScore||0,!i.leaders[c]&&d>0&&(h=Object.keys(this.inst.addedRealPlayers).length,v=(null===(p=this.inst.leaderboard)||void 0===p?void 0:p.leaders[c])||{},i.leaders[c]={playerId:c,score:this.inst.tournamentData.bestScore,name:Oc.getPlayer().name||"Guest",photo:Oc.getPlayer().photo||"https://picsum.photos/seed/%1/300/300",rank:v.rank||h+1}),(f=Object.values(i.leaders).sort((function(e,t){return t.score===e.score?e.rank-t.rank:t.score-e.score}))).forEach((function(e,t){e.rank=t+1})),i.leaders=f.slice(0,r).reduce((function(e,t){return e[t.playerId]=t,e}),{}),console.log("TournamentUtils: getLeaderboardAsync",i),this.inst.leaderboard=i,t.abrupt("return",this.inst.leaderboard);case 18:case"end":return t.stop()}}),t,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"isHasReward",value:function(){return this.inst.tournamentData.lastTournamentRankReward>0}},{key:"getLastTournamentRankRewardQuantity",value:function(){return Math.ceil((6-e.inst.tournamentData.lastTournamentRankReward)/2)}},{key:"getLastTournamentRankReward",value:function(){return e.inst.tournamentData.lastTournamentRankReward}},{key:"getTournamentEndTime",value:function(){var t=e.inst.tournamentData.endTime;if(!t)return{key:"customString",params:[Ht(0,!0)]};var n=jt(t),r=n.remainingTimeInDays,a=n.remainingTimeInMs;return a<864e5?{key:"customString",params:[Ht(a,!0)]}:r>1?{key:"vDays",params:[r.toString()]}:{key:"1day",params:[]}}},{key:"getTournamentId",value:function(){return e.inst.tournamentData.tournamentId}},{key:"getLeaderboardId",value:function(){return e.inst.tournamentData.leaderboardId}},{key:"getTournamentPlayerInfo",value:(t=R(D().mark((function t(){var n,r=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Pc()?new Promise((function(t){Gt(300).then((function(){var n,a=Oc.getPlayerId(),i=(null===(n=r.inst.leaderboard)||void 0===n?void 0:n.leaders)||{};if(i[a])t([i[a]]);else{var o=e.inst.tournamentData.bestScore||0;if(o>0){var s=1;for(var l in e.inst.addedRealPlayers)e.inst.addedRealPlayers[l].score>o&&s++;t([{playerId:a,score:o,name:Oc.getPlayer().name||"Guest",photo:Oc.getPlayer().photo||"https://picsum.photos/seed/%1/300/300",rank:s}])}else t([])}}))})):Bc.getLeadersByPlayerIdsAsync(e.getLeaderboardId(),[Oc.getPlayerId()]),t.abrupt("return",n);case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})},{key:"getIsNewSession",value:function(){return this.inst.isNewSession}},{key:"setIsNewSession",value:function(e){this.inst.isNewSession=e}},{key:"getTournamentRank",value:function(){return e.inst.playerRank||(e.inst.playerRank=-1),e.inst.playerRank}},{key:"getCachedLeaderAvatar",value:function(e){return this.inst.cachedLeaderAvatar.has(e)&&this.inst.cachedLeaderAvatar.get(e)||null}},{key:"setCachedLeaderAvatar",value:function(e,t){this.inst.cachedLeaderAvatar.set(e,t)}},{key:"isHasValidTournament",value:function(){return this.inst.isHasValidTournament}},{key:"isTournamentHappening",value:function(){return this.inst.isPlayerJoined&&this.inst.tournamentData.endTime>Date.now()/1e3}},{key:"getTournamentData",value:function(){return this.inst.tournamentData}},{key:"getGoldenTilesPerLevel",value:function(){return 4}},{key:"updateTournamentData",value:function(e){this.inst.tournamentData=G(G({},this.inst.tournamentData),e),Oc.setGameData({tournamentData:this.inst.tournamentData})}},{key:"logTournamentEnd",value:function(){codex.analytics.event(kt.TOURNAMENT_END,{rank:e.getLastTournamentRankReward(),level:me.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentRewarded",value:function(){codex.analytics.event(kt.TOURNAMENT_REWARDED,{rank:e.getLastTournamentRankReward(),level:me.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentStart",value:function(){codex.analytics.event(kt.TOURNAMENT_START,{level:me.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentRejoin",value:function(){codex.analytics.event(kt.TOURNAMENT_REJOIN)}},{key:"logTournamentRefuse",value:function(e){codex.analytics.event(kt.TOURNAMENT_REFUSE,{value:e})}},{key:"logTournamentShare",value:function(){codex.analytics.event(kt.TOURNAMENT_SHARE)}},{key:"logTournamentPostScore",value:function(){codex.analytics.event(kt.TOURNAMENT_POST_SCORE)}},{key:"updatePlayerJoined",value:function(e){this.inst.isPlayerJoined=e,this.inst.tournamentData.isPlayerJoined=e,this.inst.status=Dc.HAPPENING}},{key:"isInContextGlobalTournament",value:function(){var e=codex.match.getMatchState();if(e.mode!==Lc.Modes.TOURNAMENT)return!1;var t=e.customData.tournamentId;return!!t&&t===this.inst.tournamentData.tournamentId}},{key:"addRealPlayers",value:function(e){for(var t=Object.keys(this.inst.addedRealPlayers).length,n=0;n<e;n++){var r="real-player-".concat(t+n);this.inst.addedRealPlayers[r]={playerId:r,score:4*Math.floor(25*Math.random())+4,name:"Player ".concat(t+n),photo:"https://fastly.picsum.photos/id/866/200/300.jpg?hmac=rcadCENKh4rD6MAp6V_ma-AyWv641M4iiOpe1RyFHeI",rank:t+n+2}}}},{key:"addRealPlayer",value:function(e,t){var n=Object.keys(this.inst.addedRealPlayers).length,r="real-player-".concat(n);this.inst.addedRealPlayers[r]={playerId:r,score:t,name:e,photo:"https://fastly.picsum.photos/id/866/200/300.jpg?hmac=rcadCENKh4rD6MAp6V_ma-AyWv641M4iiOpe1RyFHeI",rank:n+2}}}]),e}());wc=Fc,Fc.useRealLeaderBoard=!0,Fc.completeLevelPromise=void 0,Fc.handleGameSDKReady=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wc.inst.fetchTournamentData();case 2:if(wc.isHasValidTournament()){e.next=5;break}return e.next=5,wc.inst.chooseNewTournament();case 5:return Pc()&&(wc.useRealLeaderBoard=!1),Ludex.Utils.Valid.isDebugger()||(wc.useRealLeaderBoard=!0),e.next=9,wc.updateLeaderboard();case 9:return wc.updateData(),e.next=12,GameSDK.tournament.getTournamentsAsync();case 12:wc.inst.playerTournaments=e.sent;case 13:case"end":return e.stop()}}),e)})));e("ad",["Patrice Remy","Gellie Hinton","Codle De Pablo","Roger Dumagat","Bud Franklin","Burl Drake","Jan Retallack","Donna E French","Ahmet Karatay","Ann Hamilton","Jodie Williams","Debbie Drumm","Tommy Johnson","Shirley Jeane Reigles","Ron Richard","Dot Dennis","Joan Gaetano","Pat Waclawsky","Arton Hoxha","Lulzim Kosumi","Amir Berisha","Rosemarie Gilbert","Bernard Dube","Solange Rocher","Fay Grouiou","James Jhon","Ken Ewing","Carmel Mccormack","Kay Pike","Coco Zenou","Theodore Crevon"]);t._RF.pop(),t._RF.push({},"9046etpNclOb7EjoNvbF/aZ","MatchUtils",void 0);var Uc=Ludex,Vc=Uc.Match,Gc=Uc.Utils,Hc=Gc.Object,jc=Gc.Valid,Kc=Gc.String,Jc=codex,Wc=Jc.match,qc=Jc.player,Yc=Jc.leaderboard,zc=e("K",function(e){return e.DAILY_CHALLENGE="daily_challenge",e.JOURNEY="journey",e}({})),Qc=e("M",function(){function e(){N(this,e),this.sessionPlayerConnected=[]}var t,n,r,a,i,o,s,l,u,c,d,p,h,v,f,m,g,y,b,_,w,E,k,C,S;return I(e,[{key:"processStartSingleModeAsync",value:(S=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=qc.getPlayerId(),e.next=3,Wc.single.start.processAsync({playerId:t});case 3:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"processFinishSingleModeAsync",value:(C=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wc.single.finish.processAsync();case 2:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"processStartTournamentModeAsync",value:(k=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=qc.getPlayerId(),n=GameSDK.context.getID(),e.next=4,Wc.tournament.continue.processAsync({playerId:t,contextId:n});case 4:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})},{key:"processFinishTournamentModeAsync",value:(E=R(D().mark((function e(){var t,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=qc.getPlayerId(),n=qc.getGameData().tournamentData.bestScore,e.next=4,Wc.tournament.finish.processAsync({playerId:t,bestScore:n});case 4:case"end":return e.stop()}}),e)}))),function(){return E.apply(this,arguments)})},{key:"processStartChallengeModeAsync",value:(w=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.processContinueChallengeAsync();case 3:e.next=15;break;case 5:if(e.prev=5,e.t0=e.catch(0),Hc.hasOwn(e.t0,"name")&&!jc.isString(e.t0.name)){e.next=9;break}throw e.t0;case 9:if("PlayerHasFinishedMatch"!==e.t0.name){e.next=12;break}return e.next=12,this.processChallengeNewOpponentAsync();case 12:if("PlayerNotJoinInMatch"!==e.t0.name){e.next=15;break}return e.next=15,this.processJoinChallengeAsync();case 15:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return w.apply(this,arguments)})},{key:"processFinishChallengeModeAsync",value:(_=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wc.challenge.finish.processAsync({extraData:{level:t}});case 2:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})},{key:"processContinueChallengeAsync",value:(b=R(D().mark((function e(){var t,n,r,a,i,o;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getMatchState(),n=t.id,r=t.customData,a=r.playerId,i=r.opponentId,jc.isString(n)){e.next=4;break}throw new Error("Invalid match id");case 4:if(jc.isString(a)){e.next=6;break}throw new Error("Invalid player id");case 6:if(jc.isString(i)){e.next=8;break}throw new Error("Invalid opponent id");case 8:if(o=GameSDK.context.getID()){e.next=11;break}throw new Error("Cannot get contextId");case 11:return e.next=13,Wc.challenge.continue.processAsync({matchId:n,contextId:o,playerId:a,opponentId:i});case 13:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"processChallengeNewOpponentAsync",value:(y=R(D().mark((function e(){var t,n,r,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=qc.getConnectedPlayerIds(100,0),n=Math.floor(Math.random()*t.length),r=qc.getPlayerId(),a=t[n],jc.isString(a)&&!jc.isEmpty(a)){e.next=6;break}throw new Error("Invalid opponent id");case 6:return e.next=8,Wc.challenge.friend.processAsync({playerId:r,opponentId:a});case 8:case"end":return e.stop()}}),e)}))),function(){return y.apply(this,arguments)})},{key:"processJoinChallengeAsync",value:(g=R(D().mark((function e(){var t,n,r,a,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getMatchState(),n=t.id,r=t.customData,a=r.playerId,i=r.opponentId,jc.isString(n)){e.next=4;break}throw new Error("Invalid match id");case 4:if(jc.isString(a)){e.next=6;break}throw new Error("Invalid player id");case 6:if(jc.isString(i)){e.next=8;break}throw new Error("Invalid opponent id");case 8:return e.next=10,Wc.challenge.join.processAsync({matchId:n,playerId:a,opponentId:i});case 10:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getMatchState",value:function(){var e=Wc.getMatchState();if(!e)throw new Error("Match state not found");return e}},{key:"getMatchMode",value:function(){var e=this.getMatchState();return jc.isString(e.mode)?e.mode:null}},{key:"getTournamentsAsync",value:(m=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.tournament.getTournamentsAsync();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return m.apply(this,arguments)})},{key:"createTournamentPayload",value:function(){var e,t,n=Kc.generateObjectId(),r=qc.getPlayerId(),a=this.getMatchState().profiles;return{score:null!==(e=null===(t=(void 0===a?{}:a)[r])||void 0===t?void 0:t.score)&&void 0!==e?e:0,playerId:r,mode:Vc.Modes.TOURNAMENT,name:this.createTournamentName(),leaderboardId:n,payload:{playerId:r,leaderboardId:n}}}},{key:"createTournamentName",value:function(){var e=qc.getPlayer().name,t=void 0===e?null:e;if(t){var n=t.substring(0,7),r="".concat(n.split(" ")[0]||n,"'s Tournament"),a=Kc.removeDiacritics(r);return"".concat(a)}return"Tournament"}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"startMatchAsync",value:(f=R(D().mark((function t(n){var r,a;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=Vc.Modes,a=null!=n?n:this.inst.getMatchMode(),e.isForceSingleMode&&(a=r.SINGLE,e.isForceSingleMode=!1),t.t0=a,t.next=t.t0===r.SINGLE?7:t.t0===r.TOURNAMENT?10:t.t0===r.CHALLENGE_FRIEND?13:16;break;case 7:return t.next=9,this.inst.processStartSingleModeAsync();case 9:return t.abrupt("break",18);case 10:return t.next=12,this.inst.processStartTournamentModeAsync();case 12:return t.abrupt("break",18);case 13:return t.next=15,this.inst.processStartChallengeModeAsync();case 15:return t.abrupt("break",18);case 16:return t.next=18,this.inst.processStartSingleModeAsync();case 18:t.next=23;break;case 20:t.prev=20,t.t1=t.catch(0),console.warn("startMatchAsync",t.t1);case 23:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(e){return f.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(v=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wc.handler.setProfileData(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setProfileMatchDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return v.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(h=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wc.handler.setMatchCustomData(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setMatchCustomDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return h.apply(this,arguments)})},{key:"getMatchCustomDataAsync",value:(p=R(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wc.handler.getMatchCustomData();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("getMatchCustomDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return p.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(d=R(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wc.handler.setLeaderboardScore(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setLeaderboardScoreAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return d.apply(this,arguments)})},{key:"finishMatchAsync",value:(c=R(D().mark((function e(t){var n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=this.inst.getMatchMode(),r=Ludex.Match.Modes,e.t0=n,e.next=e.t0===r.SINGLE?6:e.t0===r.TOURNAMENT?9:e.t0===r.CHALLENGE_FRIEND?12:15;break;case 6:return e.next=8,this.inst.processFinishSingleModeAsync();case 8:return e.abrupt("break",17);case 9:return e.next=11,this.inst.processFinishTournamentModeAsync();case 11:return e.abrupt("break",17);case 12:return e.next=14,this.inst.processFinishChallengeModeAsync(t);case 14:return e.abrupt("break",17);case 15:return e.next=17,this.inst.processFinishSingleModeAsync();case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(0),console.warn("finishMatchAsync",e.t1);case 22:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e){return c.apply(this,arguments)})},{key:"createTournamentAsync",value:(u=R(D().mark((function e(){var t,n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,this.inst.getTournamentsAsync();case 3:if(!e.sent.find((function(e){var t=JSON.parse(e.getPayload());return"DEFAULT"===e.getTournamentType()&&t.playerId===qc.getPlayerId()}))){e.next=7;break}return e.abrupt("return",!1);case 7:return n=this.inst.createTournamentPayload(),e.prev=8,e.next=11,Wc.tournament.create.processAsync(n);case 11:r=n.leaderboardId,Yc.addLeaderboard({name:r,type:"tournament",autoSortRank:!0,leaderboardId:r}),t=!0,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),console.warn("processCreateTournament",e.t0);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this,[[8,16]])}))),function(){return u.apply(this,arguments)})},{key:"joinTournamentAsync",value:(l=R(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=qc.getPlayerId(),e.next=3,Wc.tournament.join.processAsync({tournamentId:t,playerId:n});case 3:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"continueTournamentAsync",value:(s=R(D().mark((function e(t){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=qc.getPlayerId(),e.next=3,Wc.tournament.continue.processAsync({playerId:n,contextId:t});case 3:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"switchToSoloContext",value:function(){e.isForceSingleMode=!0}},{key:"switchToNormal",value:function(){e.specialMode=void 0,e.specialModeInfo=void 0}},{key:"switchToDailyChallenge",value:function(t,n,r){e.specialMode=zc.DAILY_CHALLENGE,e.specialModeInfo={day:t,month:n,year:r}}},{key:"switchToJourney",value:function(t,n){e.specialMode=zc.JOURNEY,e.specialModeInfo={season:t,level:n}}},{key:"getCurrentMatchMode",value:function(){if(e.isForceSingleMode)return Vc.Modes.SINGLE;var t=e.inst.getMatchMode();return null!=t?t:Vc.Modes.SINGLE}},{key:"getSpecialMode",value:function(){return e.specialMode}},{key:"getSpecialModeInfo",value:function(){return e.specialModeInfo}},{key:"handleChoosePlayWithFriend",value:(o=R(D().mark((function t(){var n,r,a,i;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!0,t.prev=1,t.next=4,Wc.context.choose.processAsync({playerId:qc.getPlayerId(),fallbackSingleMode:!1,extraData:{level:me.getLevel()}});case 4:this.isForceSingleMode=!1,e.switchToNormal(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),n=!1,"USER_INPUT"===t.t0.code?e.switchToSoloContext():console.warn("Error while finding opponent:",t.t0);case 12:return t.prev=12,r=Ludex.Utils.Valid.isDebugger(),a=codex.match.getMatchState(),i=qc.getPlayerId(),r&&!a.profiles[i]&&(console.log("[MatchUtils] Player ".concat(i," is not in match, creating a new profile.")),a.profiles[i]={id:i,name:"Guest",photo:"",score:123,bestScore:0,finished:!1},a.customData.opponentId="mock-opponent-id",a.profiles["mock-opponent-id"]={id:"mock-opponent-id",name:"Guest",photo:"",score:0,bestScore:0,finished:!1}),t.next=19,vt.switchToGameScene();case 19:return t.finish(12);case 20:return t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,this,[[1,8,12,20]])}))),function(){return o.apply(this,arguments)})},{key:"openPopupRandomFriend",value:(i=R(D().mark((function t(){var n,r,a,i,o,s=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!0,Ke.showLoadingScreen(),t.prev=2,t.next=5,FBInstant.player.getConnectedPlayersAsync();case 5:if(r=t.sent,a=r.map((function(e){return e.getID()})),!((i=a.filter((function(e){return!s.inst.sessionPlayerConnected.includes(e)}))).length>0)){t.next=15;break}return o=i[Math.floor(Math.random()*i.length)],this.inst.sessionPlayerConnected.push(o),t.next=13,Wc.challenge.friend.processAsync({playerId:codex.player.getPlayerId(),opponentId:o});case 13:t.next=18;break;case 15:return t.next=17,e.handleChoosePlayWithFriend();case 17:n=t.sent;case 18:this.isForceSingleMode=!1,t.next=25;break;case 21:t.prev=21,t.t0=t.catch(2),n=!1,"USER_INPUT"===t.t0.code?console.log("User cancelled the context selection."):console.warn("Error selecting context:",t.t0);case 25:return t.prev=25,codex.analytics.event(kt.OPEN_POPUP_CHALLENGE_FRIEND,{success:n}),Ke.closeLoadingScreen(),t.finish(25);case 29:return t.abrupt("return",n);case 30:case"end":return t.stop()}}),t,this,[[2,21,25,29]])}))),function(){return i.apply(this,arguments)})},{key:"openPopupChooseFriend",value:(a=R(D().mark((function t(){return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ke.showLoadingScreen(),t.next=3,e.handleChoosePlayWithFriend();case 3:Ke.closeLoadingScreen();case 4:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"handleJoinGlobalTournament",value:(r=R(D().mark((function t(){var n,r;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!0,t.prev=1,r=Fc.inst.tournamentData.tournamentId,t.next=5,e.joinTournamentAsync(r);case 5:this.isForceSingleMode=!1,e.switchToNormal(),Fc.updatePlayerJoined(!0),qc.setGameData({tournamentData:Fc.inst.tournamentData}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.error("TournamentUtils: handleJoinTournament",t.t0),n=!1;case 15:return t.prev=15,codex.analytics.event(kt.OPEN_POPUP_GLOBAL_TOURNAMENT,{success:n}),t.finish(15);case 18:return t.abrupt("return",n);case 19:case"end":return t.stop()}}),t,this,[[1,11,15,18]])}))),function(){return r.apply(this,arguments)})},{key:"openPopupJoinGlobalTournament",value:(n=R(D().mark((function t(){var n;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ke.showLoadingScreen(),t.next=3,e.handleJoinGlobalTournament();case 3:return n=t.sent,Ke.closeLoadingScreen(),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"openPopupSharePlayerTournament",value:(t=R(D().mark((function e(t){var n,r,a,i,o,s;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.score,r=Math.floor(Date.now()/1e3)+604800,a=codex.player.getPlayerId(),i=codex.player.getPlayer().name,o=Ludex.Utils.String.generateObjectId(),s=!0,e.prev=6,e.next=9,GameSDK.tournament.createAsync({initialScore:n,data:{playerName:i,playerId:a,leaderboardId:o,isPlayerTournament:!0},config:{title:"".concat(i,"'s Tournament"),tournamentTitle:"".concat(i,"'s Tournament"),sortOrder:"HIGHER_IS_BETTER",scoreFormat:"NUMERIC",endTime:r}});case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(6),s=!1,"USER_INPUT"===e.t0.code?console.log("User cancelled the context selection."):console.warn("Error selecting context:",e.t0);case 15:return e.prev=15,codex.analytics.event(kt.OPEN_POPUP_PLAYER_TOURNAMENT,{success:s}),Ke.closeLoadingScreen(),e.finish(15);case 19:return e.abrupt("return",s);case 20:case"end":return e.stop()}}),e,null,[[6,11,15,19]])}))),function(e){return t.apply(this,arguments)})}]),e}());Qc.isForceSingleMode=!1,Qc.specialMode=void 0,Qc.specialModeInfo=void 0,t._RF.pop(),t._RF.push({},"09bc071ZcpI978b1NdKUaqD","AnalyticsUtils",void 0);var Xc,Zc=Ludex.Utils.Array,$c=codex.analytics;function ed(e){return Math.ceil(Math.log2(e+1))}function td(e,t){var n,r=ed(t),a=e.length*r,i=Math.ceil(a/8),o=new Array(i).fill(0),s=0,l=O(e);try{for(l.s();!(n=l.n()).done;)for(var u=n.value,c=0;c<r;c++){var d=Math.floor(s/8),p=s%8,h=u>>c&1;o[d]|=h<<p,s++}}catch(e){l.e(e)}finally{l.f()}return function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=0;r<e.length;){var a=e[r++],i=r<e.length?e[r++]:0,o=r<e.length?e[r++]:0,s=(3&a)<<4|i>>4,l=(15&i)<<2|o>>6,u=63&o;n+=t.charAt(a>>2)+t.charAt(s)+(r<=e.length+1?t.charAt(l):"=")+(r<=e.length?t.charAt(u):"=")}return n}(o)}function nd(e,t,n){for(var r=ed(n),a=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<e.length;r+=4){var a=t.indexOf(e.charAt(r)),i=t.indexOf(e.charAt(r+1)),o="="===e.charAt(r+2)?0:t.indexOf(e.charAt(r+2)),s=a<<2|i>>4,l=(15&i)<<4|o>>2,u=(3&o)<<6|("="===e.charAt(r+3)?0:t.indexOf(e.charAt(r+3)));n.push(s),"="!==e.charAt(r+2)&&n.push(l),"="!==e.charAt(r+3)&&n.push(u)}return n}(e),i=[],o=0,s=0;s<t;s++){for(var l=0,u=0;u<r;u++){var c=o%8;l|=(a[Math.floor(o/8)]>>c&1)<<u,o++}i.push(l)}return i}e("g",function(){function e(){N(this,e)}return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"gameScene",get:function(){var e,t=null===(e=v("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"trackCurrentPage",value:function(e,t){if(!Zc.has(Ue,e)&&(t||Zc.has(this.trackingPages,e))){this.trackingPages=this.trackingPages.filter((function(t){return t!==e})),t&&this.trackingPages.push(e);var n=this.getCurrentPage();$c.pageview(n)}}},{key:"switchSceneTracking",value:function(){this.trackingPages=[];var e=this.getCurrentPage();$c.pageview(e)}},{key:"getCurrentPage",value:function(){var e,t;return this.trackingPages.length>0?this.trackingPages[this.trackingPages.length-1]||"Unknown Page":null!==(e=null===(t=T.getScene())||void 0===t?void 0:t.name)&&void 0!==e?e:"Unknown Scene"}},{key:"logLevelEnd",value:function(e,t,n){var r=this.buildCommonPayload();r.success=n,r.score=t,this.appendLevelToPayload(r,e,n),$c.event(kt.LEVEL_END,r)}},{key:"logLevelStart",value:function(){var e,t=this.gameScene.gameplay,n=t.gameModeManager,r=t.hasGoldenTiles,a={level_try_count:me.getTryCount(),game_mode:n.getGameMode(),is_highlight:null!==(e=codex.player.getPlayerSetting("highLight"))&&void 0!==e&&e,has_golden_tiles:r};this.appendLevelToPayload(a),$c.event(kt.LEVEL_START,a)}},{key:"logLevelRescue",value:function(){var e=this.buildCommonPayload();this.appendLevelToPayload(e),$c.event(kt.LEVEL_RESCUE,e)}},{key:"logLevelRetry",value:function(e){var t=this.buildCommonPayload();t.screen_name=e,this.appendLevelToPayload(t),$c.event(kt.LEVEL_RETRY,t)}},{key:"logLevelAutoFinish",value:function(){var e=this.buildCommonPayload();this.appendLevelToPayload(e),$c.event(kt.LEVEL_AUTO_FINISH,e)}},{key:"logUseItem",value:function(e){var t={item_name:wt[e]};this.appendLevelToPayload(t),$c.event(kt.USE_ITEM,t)}},{key:"buildCommonPayload",value:function(){var e,t=this.gameScene.gameplay,n=t.scoreManager,r=t.gameModeManager,a=t.tileManager,i=t.itemManager,o=t.hasGoldenTiles,s=Dt.getCurrentThemeTileset(),l=Dt.getCurrentThemeBackground();return{level_try_count:me.getTryCount(),time_played:n.getCurrentPlayTime(),score:n.getCurrentScore(),combo:n.getCurrentCombo(),game_mode:r.getGameMode(),leftover_pairs:a.getLeftoverPairCount(),match_count:a.getMatchedPairCount(),match_failed_count:a.getMatchedPairFailedCount(),use_shuffle_count:i.getUseShuffleCount(),use_undo_count:i.getUseUndoCount(),use_hint_count:i.getUseHintCount(),is_highlight:null!==(e=codex.player.getPlayerSetting("highLight"))&&void 0!==e&&e,has_golden_tiles:o,theme_idx:s,bg_idx:l}}},{key:"appendLevelToPayload",value:function(e,t,n){switch(Qc.getSpecialMode()){case zc.JOURNEY:e.level_2=n?Sc.getCompletedLevel():Sc.getCompletedLevel()+1;break;case zc.DAILY_CHALLENGE:e.level_3=null!=t?t:me.getLevel();break;default:e.level=null!=t?t:me.getLevel()}}}]),e}()).trackingPages=[],t._RF.pop(),t._RF.push({},"69771rpnOpHv7uoHCmzgP1X","Base64Utils",void 0),t._RF.pop(),t._RF.push({},"a615d6Weo1L7pb2JJy+isJA","DailyChallengeUtils",void 0);var rd=2025,ad=e("a6",2025),id=e("D",function(){function e(){N(this,e),this.years=[],this.completeDictionary={},this.badges={},this.badgeList=[],this.badgeSprites=new Map,this.debugDate={day:1,month:2,year:2025}}var t,n;return I(e,[{key:"encodeCompleteChallenge",value:function(){var e=[];this.years.sort((function(e,t){return e-t}));var t,n=0,r=O(this.years);try{for(r.s();!(t=r.n()).done;){for(var a=t.value,i=this.isLeapYear(a)?366:365,o=[],s=!1,l=0;l<i;l++){var u=n+l,c=this.completeDictionary[u]?1:0;o.push(c),c&&(s=!0)}if(!s)break;var d=td(o,1);e.push("".concat(a,"-").concat(d)),n+=i}}catch(e){r.e(e)}finally{r.f()}return e}},{key:"decodeCompleteChallenge",value:function(e){if(this.completeDictionary={},this.years=[],e&&0!==e.length)try{var t,n=O(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.indexOf("-");if(-1!==a){var i=parseInt(r.slice(0,a));this.years.push(i);for(var o=r.slice(a+1),s=this.isLeapYear(i)?366:365,l=nd(o,s,1),u=this.getOffsetFromBaseYear(i),c=0;c<s;c++){var d=u+c;1===l[c]&&(this.completeDictionary[d]=!0)}}}}catch(e){n.e(e)}finally{n.f()}}catch(e){console.error("Error decoding daily challenges:",e),this.completeDictionary={}}}},{key:"isLeapYear",value:function(e){return e%4==0&&e%100!=0||e%400==0}},{key:"getOffsetFromBaseYear",value:function(e){for(var t=0,n=rd;n<e;n++)t+=this.isLeapYear(n)?366:365;return t}},{key:"updatePlayerData",value:function(){var e=this.encodeCompleteChallenge();window.codex.player.setGameData({dailyChallenge:e})}},{key:"getBadgeKey",value:function(e){var t=e.month-1+12*(e.year-ad);return t<0?(console.warn("Invalid badge data:",e),"1"):(t%12+1).toString()}},{key:"loadBadgesOnly",value:(n=R(D().mark((function e(t){var n,r,a,i,o=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=O(t),e.prev=2,i=D().mark((function e(){var t,r,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,r=o.getBadgeKey(t),!o.badgeSprites.has(r)){e.next=4;break}return e.abrupt("return",1);case 4:(i=se.loadSpriteFrameAsync("".concat(St.DAILY_BADGE_PREFIX).concat(r,"/spriteFrame"))).then((function(e){o.badgeSprites.set(r,e)})),n.push(i);case 7:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=11;break}return e.delegateYield(i(),"t0",7);case 7:if(!e.t0){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(2),r.e(e.t1);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.next=21,Promise.all(n);case 21:case"end":return e.stop()}}),e,null,[[2,13,16,19]])}))),function(e){return n.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:function(){var e=window.codex.player.getPlayerData().gameData.dailyChallenge;for(var t in this.inst.completeDictionary={},this.inst.badges={},this.inst.decodeCompleteChallenge(e),this.inst.completeDictionary){var n=parseInt(t),r=new Date(rd,0,1+n),a=r.getMonth()+1,i=r.getFullYear(),o="".concat(a,"-").concat(i);this.inst.badges[o]=(this.inst.badges[o]||0)+1,this.inst.badges[o]===new Date(i,a,0).getDate()&&this.inst.badgeList.push({month:a,year:i})}this.inst.updatePlayerData(),this.addDebugContent()}},{key:"addDebugContent",value:function(){var t=this,n=hc.addLiveOpsFolder("Daily Challenge");n&&(hc.addLiveOpsBinding(n,{day:this.inst.debugDate.day},"day",{step:1,label:"Day"},(function(e){t.inst.debugDate.day=e.value})),hc.addLiveOpsBinding(n,{month:this.inst.debugDate.month},"month",{step:1,label:"Month"},(function(e){t.inst.debugDate.month=e.value})),hc.addLiveOpsBinding(n,{year:this.inst.debugDate.year},"year",{step:1,label:"Year"},(function(e){t.inst.debugDate.year=e.value})),hc.addLiveOpsButton(n,"Complete Daily Challenge",(function(){var n=t.inst.debugDate,r=n.day,a=n.month,i=n.year;e.completeChallenge({day:r,month:a,year:i})})),hc.addLiveOpsButton(n,"Uncomplete Daily Challenge",(function(){var n=(new Date(t.inst.debugDate.year,t.inst.debugDate.month-1,t.inst.debugDate.day).getTime()-new Date(2025,0,1).getTime())/864e5;e.uncompleteChallenge(n)})))}},{key:"completeChallenge",value:function(e){var t=e.day,n=e.month,r=e.year,a=new Date(rd,0,1),i=new Date(r,n-1,t).getTime()-a.getTime(),o=Math.floor(i/864e5);if(o<0)console.warn("Invalid challenge date:",e);else if(this.inst.completeDictionary[o])console.log("Challenge already completed:",e);else{this.inst.years.includes(r)||this.inst.years.push(r),this.inst.completeDictionary[o]=!0;var s="".concat(n,"-").concat(r);this.inst.badges[s]=(this.inst.badges[s]||0)+1;var l=new Date(r,n,0).getDate();this.inst.badges[s]===l&&this.inst.badgeList.push({month:n,year:r}),this.inst.updatePlayerData()}}},{key:"uncompleteChallenge",value:function(e){this.inst.completeDictionary[e]=!1}},{key:"isCompletedChallenge",value:function(e){var t=e.day,n=e.month,r=e.year,a=new Date(rd,0,1),i=new Date(r,n-1,t).getTime()-a.getTime(),o=Math.floor(i/864e5);return o<0?(console.warn("Invalid challenge date:",e),!1):this.inst.completeDictionary[o]}},{key:"getBadges",value:function(){return this.inst.badgeList}},{key:"isCompletedMonth",value:function(e){var t=e.month,n=e.year,r="".concat(t,"-").concat(n);return this.inst.badges[r]===new Date(n,t,0).getDate()}},{key:"loadBadges",value:(t=R(D().mark((function e(t){var n,r,a,i,o,s=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inst.loadBadgesOnly(t);case 2:n=[],r=O(t);try{for(r.s();!(a=r.n()).done;)i=a.value,o=this.inst.getBadgeKey(i),this.inst.badgeSprites.has(o)||(console.warn("Badge not loaded: ".concat(o)),n.push(i))}catch(e){r.e(e)}finally{r.f()}return n.length>0&&Gt(500).then((function(){s.inst.loadBadgesOnly(n)})),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getBadgeSpriteFrame",value:function(e){var t=this.inst.getBadgeKey(e);return this.inst.badgeSprites.has(t)&&this.inst.badgeSprites.get(t)||null}},{key:"getRandomLevel",value:function(e,t,n){var r=new Date(2e3,0,1),a=(new Date(n,t-1,e).getTime()-r.getTime())/1e3/3600/24+n%100*97+59*t+43*e;return Math.floor(a%2e3+1001)}},{key:"isNeedLoadDailyChallenge",value:function(e){var t=e||{},n=t.month,r=t.year;if(!n||!r){var a=new Date;n=a.getMonth()+1,r=a.getFullYear()}return!this.getBadgeSpriteFrame({month:n,year:r})}},{key:"isNeedLoadBadge",value:function(){return!e.getBadges().reduce((function(t,n){var r=null!==e.getBadgeSpriteFrame(n);return t&&r}),!0)}},{key:"calculateNextDay",value:function(t){for(var n=t.day,r=t.month,a=t.year,i=-1,o=(new Date).getFullYear(),s=(new Date).getMonth()+1,l=a===o&&r===s?(new Date).getDate():new Date(a,r,0).getDate(),u=n+1;u<=l;u++)if(!e.isCompletedChallenge({day:u,month:r,year:a})){i=u;break}if(-1===i)for(var c=n-1;c>=1;c--)if(!e.isCompletedChallenge({day:c,month:r,year:a})){i=c;break}return-1===i&&(i=l),{day:i,month:r,year:a}}}]),e}());Xc=id,id.loadingTextureBeforeOpenDailyChallenge=function(){var e=R(D().mark((function e(t){var n,r,a,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t||{}).month,a=n.year,r&&a||(i=new Date,r=i.getMonth()+1,a=i.getFullYear()),Xc.isNeedLoadDailyChallenge(t)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Xc.loadBadges([{month:r,year:a}]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),id.loadingTextureBeforeOpenBadgeScreen=R(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Xc.getBadges(),Xc.isNeedLoadBadge()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Xc.loadBadges(t);case 5:case"end":return e.stop()}}),e)}))),t._RF.pop(),t._RF.push({},"688b9uHmGxIzor34fF2fnWU","GeneralUtils",void 0);e("n",function(){function e(){N(this,e)}return I(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"setBlockInput",value:function(e){var t=v("Canvas/InputBlocker");t&&(t.active=e)}},{key:"getBlockInput",value:function(){var e=v("Canvas/InputBlocker");return!!e&&e.active}}]),e}());t._RF.pop()}}}));

System.register("chunks:///rollupPluginModLoBabelHelpers-0ce78aec.js",[],(function(t){return{execute:function(){function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(e){return(r=t("o","function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}))(e)}function n(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function i(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(e){return(a=t("q",Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)}))(e)}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(e,r,n){return(f=c()?t("r",Reflect.construct.bind()):t("r",(function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&u(o,r.prototype),o}))).apply(null,arguments)}function l(e){var r="function"==typeof Map?new Map:void 0;return(l=t("n",(function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return f(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,t)})))(e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}function y(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?t("p",Reflect.get.bind()):t("p",(function(t,e,r){var n=y(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}))).apply(this,arguments)}function v(t,e,r,n){return(v="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,r,n){var o,a=y(t,e);if(a){if((o=Object.getOwnPropertyDescriptor(a,e)).set)return o.set.call(n,r),!0;if(!o.writable)return!1}if(o=Object.getOwnPropertyDescriptor(n,e)){if(!o.writable)return!1;o.value=r,Object.defineProperty(n,e,o)}else i(n,e,r);return!0})(t,e,r,n)}function b(t,e){if(t){if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}t({_:function(t,e,r,n,o){var i={};Object.keys(n).forEach((function(t){i[t]=n[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0);i=r.slice().reverse().reduce((function(r,n){return n(t,e,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0);void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null);return i},a:function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)},b:function(t){var e=c();return function(){var r,n=a(t);if(e){var o=a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}},c:function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},d:function(t,e,r,n){if(!r)return;Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})},e:s,f:function(t,e,r){e&&o(t.prototype,e);r&&o(t,r);return Object.defineProperty(t,"prototype",{writable:!1}),t},g:function(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,c,"next",t)}function c(t){n(a,o,i,u,c,"throw",t)}u(void 0)}))}},h:function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t("h",(function(){return r}));var e,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(e){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),u=new k(n||[]);return i(a,"_invoke",{value:S(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var y="suspendedStart",h="executing",v="completed",b={};function d(){}function g(){}function m(){}var w={};l(w,u,(function(){return this}));var O=Object.getPrototypeOf,j=O&&O(O(A([])));j&&j!==n&&o.call(j,u)&&(w=j);var P=m.prototype=d.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function r(n,i,a,u){var c=p(t[n],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==typeof l&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function S(t,r,n){var o=y;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=L(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var f=p(t,r,n);if("normal"===f.type){if(o=n.done?v:"suspendedYield",f.arg===b)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=v,n.method="throw",n.arg=f.arg)}}}function L(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,L(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return g.prototype=m,i(P,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:g,configurable:!0}),g.displayName=l(m,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,f,"GeneratorFunction")),t.prototype=Object.create(P),t},r.awrap=function(t){return{__await:t}},E(x.prototype),l(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new x(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(P),l(P,f,"Generator"),l(P,u,(function(){return this})),l(P,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=A,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),f=o.call(a,"finallyLoc");if(c&&f){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),b}},r},i:function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=b(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}},j:function(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},k:function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){f=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(f)throw o}}return u}}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},l:i,m:function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t},n:l,o:r,p:h,q:a,r:f,s:function(t,e,r,n,o){if(!v(t,e,r,n||t)&&o)throw new TypeError("failed to set property");return r}})}}}));

} }; });