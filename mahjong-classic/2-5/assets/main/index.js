System.register("chunks:///main.js",["./rollupPluginModLoBabelHelpers-0ce78aec.js","cc","./GeneralUtils-042f562d.js"],(function(){var e,t,n,i,a,r,o,s,l,u,c,h,p,d,f,y,v,g,m,b,S,w,k,T,C,E,L,x,I,A,R,P,_,N,O,B,D,F,M,z,U,G,H,W,V,j,q,K,Y,J,Z,X,Q,$,ee,te,ne,ie,ae,re,oe,se,le,ue,ce,he,pe,de,fe,ye,ve,ge,me,be,Se,we,ke,Te,Ce,Ee,Le,xe,Ie,Ae,Re,Pe,_e,Ne,Oe,Be,De,Fe,Me,ze,Ue,Ge,He,We,Ve,je,qe,Ke,Ye,Je,Ze,Xe,Qe,$e,et,tt,nt,it,at,rt,ot,st,lt,ut,ct,ht,pt,dt,ft,yt,vt,gt,mt,bt,St,wt,kt,Tt,Ct,Et,Lt,xt,It,At,Rt,Pt,_t,Nt,Ot,Bt,Dt,Ft,Mt;return{setters:[function(g){e=g._,t=g.a,n=g.b,i=g.c,a=g.d,r=g.e,o=g.f,s=g.g,l=g.h,u=g.l,c=g.s,h=g.q,p=g.p,d=g.i,f=g.j,y=g.k,v=g.m},function(e){g=e.cclegacy,m=e._decorator,b=e.Animation,S=e.CCString,w=e.CCInteger,k=e.Component,T=e.AudioSource,C=e.director,E=e.Sprite,L=e.UITransform,x=e.game,I=e.view,A=e.Node,R=e.CCBoolean,P=e.UIOpacity,_=e.EventHandler,N=e.Button,O=e.Input,B=e.tween,D=e.Color,F=e.Vec3,M=e.EventTouch,z=e.Widget,U=e.View,G=e.Graphics,H=e.ProgressBar,W=e.Enum,V=e.CCFloat,j=e.Vec2,q=e.Prefab,K=e.instantiate,Y=e.math,J=e.ScrollView,Z=e.ccenum,X=e.Label,Q=e.Director,$=e.Layers,ee=e.ParticleSystem2D,te=e.v3,ne=e.find,ie=e.Tween,ae=e.SpriteFrame,re=e.easing,oe=e.Layout,se=e.MotionStreak,le=e.repeat,ue=e.lerp,ce=e.approx,he=e.EPSILON,pe=e.RealCurve,de=e.Gradient,fe=e.bits,ye=e.random,ve=e.randomRange,ge=e.randomRangeInt,me=e.js,be=e.misc,Se=e.MeshRenderData,we=e.pseudoRandom,ke=e.toRadian,Te=e.CCClass,Ce=e.UIRenderer,Ee=e.Material,Le=e.BlockInputEvents,xe=e.sp,Ie=e.Mask,Ae=e.Canvas},function(e){Re=e.o,Pe=e.R,_e=e.G,Ne=e.T,Oe=e.p,Be=e.a,De=e.q,Fe=e.r,Me=e.s,ze=e.t,Ue=e.m,Ge=e.l,He=e.C,We=e.g,Ve=e.u,je=e.A,qe=e.d,Ke=e.E,Ye=e.v,Je=e.w,Ze=e.x,Xe=e.y,Qe=e.z,$e=e.B,et=e.F,tt=e.J,nt=e.i,it=e.H,at=e.n,rt=e.M,ot=e.K,st=e.N,lt=e.O,ut=e.Q,ct=e.I,ht=e.U,pt=e.S,dt=e.V,ft=e.W,yt=e.X,vt=e.Y,gt=e.h,mt=e.D,bt=e.Z,St=e.k,wt=e._,kt=e.$,Tt=e.j,Ct=e.a0,Et=e.a1,Lt=e.a2,xt=e.a3,It=e.a4,At=e.a5,Rt=e.a6,Pt=e.a7,_t=e.a8,Nt=e.a9,Ot=e.aa,Bt=e.ab,Dt=e.ac,Ft=e.ad,Mt=e.ae}],execute:function(){var zt,Ut,Gt,Ht,Wt,Vt,jt,qt,Kt;g._RF.push({},"60ac3vor0dMT5bXi8D3VSJN","BubbleAnimation",void 0);var Yt=m.ccclass,Jt=m.property;zt=Yt("BubbleAnimation"),Ut=Jt(b),Gt=Jt(S),Ht=Jt(w),zt((jt=e((Vt=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"animation",jt,r(e)),a(e,"clipName",qt,r(e)),a(e,"repeat",Kt,r(e)),e.currentRepeat=-1,e}return o(l,[{key:"__preload",value:function(){this.animation=this.getComponent(b),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"play",value:function(){var e=this;this.animation&&(this.animation.clips.find((function(t){return(null==t?void 0:t.name)===e.clipName}))?(this.currentRepeat=-1,this.animation.play(this.clipName)):console.warn("BubbleAnimation: Animation component must have ".concat(this.clipName," clip")))}},{key:"onBubbleAnimationLoop",value:function(){this.animation&&-1!==this.repeat&&(this.currentRepeat++,this.currentRepeat>this.repeat&&this.animation.stop())}}]),l}(k)).prototype,"animation",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=e(Vt.prototype,"clipName",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Bubble"}}),Kt=e(Vt.prototype,"repeat",[Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),Wt=Vt));g._RF.pop(),g._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var Zt,Xt,Qt=function(e){t(r,e);var a=n(r);function r(e,t){var n;return i(this,r),(n=a.call(this,e)).audioSource=t,n}return o(r,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,a=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=a}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===T.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),r}(Ludex.Plugins.Audio.BaseAudioPlayer);g._RF.pop(),g._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var $t,en,tn,nn,an,rn=Ludex,on=rn.Plugins.Audio.BaseChannelManager,sn=rn.Utils,ln=sn.Array,un=(Zt=sn.Decorator.tryCatch(),e((Xt=function(e){t(u,e);var a,r=n(u);function u(e,t){var n;return i(this,u),(n=r.call(this,t)).allowMultipleTracking={},n.handleLoadedAudio=function(e,t){var i=n.node.addComponent(T);return i.clip=t,i.playOnAwake=!1,new Qt(e,i)},n.node=e,n}return o(u,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof Qt)&&n.getAudioSource().state===T.AudioState.PLAYING}},{key:"onLoadAudio",value:(a=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe.loadAudioAsync(t);case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(this.node.isValid){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",this.handleLoadedAudio(t,i));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,a=t.allowMultiple,r=void 0!==a&&a;if(t.volume=this.getVolume()*i,r){var o=e.getAudioSource().clip;if(!o)return;return void this.requestDuplicateAudioPlayer(e.getKey(),o,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof Qt)return i.getAudioSource().state===T.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var a=i.key,r=n.volume,o=void 0===r?1:r;this.setAudioClip(a,{volume:o})}return i.audioPlayer}var s=this.allowMultipleTracking[e];if(!s)throw new Error("Allow multiple tracking is not found");var l="".concat(e,"_").concat(s.currentPostFix),u=this.handleLoadedAudio(l,t);return s.list.push({audioPlayer:u,key:l}),s.currentPostFix+=1,this.setAudioClip(l,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=ln.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==T.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),u}(on)).prototype,"onLoadAudio",[Zt],Object.getOwnPropertyDescriptor(Xt.prototype,"onLoadAudio"),Xt.prototype),Xt);g._RF.pop(),g._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var cn,hn,pn,dn,fn,yn=m.ccclass,vn=m.property,gn=codex,mn=gn.audio,bn=gn.player,Sn=($t=yn("Music"),en=vn(S),$t((an=e((nn=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"channelId",an,r(e)),e.channel=null,e}return o(l,[{key:"__preload",value:function(){this.makePersistent(),this.channel=new un(this.node,this.channelId),mn.addChannel(this.channel)}},{key:"makePersistent",value:function(){C.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),mn.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!bn.getPlayerSetting("music")}},{key:"setVolume",value:function(e){mn.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return mn.getVolume(this.channelId)}},{key:"pause",value:function(e){mn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&mn.resume(e,this.channelId)}},{key:"stop",value:function(e){mn.stop(e,this.channelId)}},{key:"mute",value:function(e){e?mn.mute(this.channelId):mn.unmute(this.channelId)}}]),l}(k)).prototype,"channelId",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),tn=nn))||tn);g._RF.pop(),g._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var wn,kn,Tn,Cn,En,Ln,xn,In,An=m.ccclass,Rn=m.property,Pn=codex,_n=Pn.audio,Nn=Pn.player,On=(cn=An("Sound"),hn=Rn(S),cn((fn=e((dn=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"channelId",fn,r(e)),e.channel=null,e}return o(l,[{key:"__preload",value:function(){this.channel=new un(this.node,this.channelId),_n.addChannel(this.channel)}},{key:"onLoad",value:function(){""===this.channelId&&(this.channelId=this.node.uuid)}},{key:"makePersistent",value:function(){C.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){C.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){this.isSoundEnable()&&_n.play(e,t,this.channelId)}},{key:"isSoundEnable",value:function(){return!!Nn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){_n.setVolume(e,this.channelId)}},{key:"pause",value:function(e){_n.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&_n.resume(e,this.channelId)}},{key:"stop",value:function(e){_n.stop(e,this.channelId)}},{key:"stopAll",value:function(){_n.stopAll(this.channelId)}},{key:"mute",value:function(e){e?_n.mute(this.channelId):_n.unmute(this.channelId)}}]),l}(k)).prototype,"channelId",[hn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),pn=dn))||pn);g._RF.pop(),g._RF.push({},"ca427NpeqpC3bUoGTd9I/BM","Background",void 0);var Bn,Dn,Fn,Mn,zn,Un,Gn,Hn,Wn,Vn,jn,qn,Kn,Yn,Jn,Zn=m.ccclass,Xn=Ludex.Utils.Decorator,Qn=Be.Layout,$n=(u(wn={},Qn.Portrait,{"3x":{width:1080,height:2520},"2x":{width:1080,height:2279.52},"1x":{width:1080,height:2278.08}}),u(wn,Qn.Landscape,{"3x":{width:2732,height:1583},"2x":{width:1920*1.44,height:1555.2},"1x":{width:960*2.88,height:1555.2}}),wn),ei=(kn=Zn("Background"),Tn=Re.required(),Cn=Xn.debounce(100),kn((xn=e((Ln=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"sprite",xn,r(e)),a(e,"handleViewResized",In,r(e)),e}return o(l,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),Re.validateRequiredProperties(this),this.listenGameEvents()}},{key:"start",value:function(){this.handleViewResized()}},{key:"onLoad",value:function(){this.updateBackgroundSprite()}},{key:"listenGameEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"onDestroy",value:function(){x.off(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"updateBackgroundSprite",value:function(){var e=this;Ne.loadCurrentBackgroundSprite().then((function(t){t&&e.setBackgroundSprite(t)}))}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e,this.updateBackgroundSize())}},{key:"updateBackgroundSize",value:function(){if(this.sprite){var e=I.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=Pe.getImageScale(),a=1===i?"1x":2===i?"2x":"3x",r=$n[Oe.getCurrentLayout()][a],o=r.width,s=r.height;this.uiTransform.setContentSize(o,s);var l=t/o,u=n/s,c=Math.max(l,u);this.sprite.node.setScale(c,c)}}}}]),l}(k)).prototype,"sprite",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=e(Ln.prototype,"handleViewResized",[Cn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite()}}}),En=Ln))||En);g._RF.pop(),g._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var ti,ni,ii,ai,ri,oi,si,li,ui,ci,hi,pi,di,fi,yi=m.ccclass,vi=m.property,gi=m.disallowMultiple,mi=Ludex.Events,bi=codex.event,Si=(Bn=yi("BaseScreen"),Dn=vi(A),Fn=vi(A),Mn=vi(R),zn=vi({visible:function(){return this.useSound},type:De}),Un=vi({visible:function(){return this.useSound},type:De}),Bn(Gn=gi((Wn=e((Hn=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"container",Wn,r(e)),a(e,"backgroundMask",Vn,r(e)),a(e,"openClipName",jn,r(e)),a(e,"closeClipName",qn,r(e)),e.data={},e.openPreloadPromises=[],a(e,"useSound",Kn,r(e)),a(e,"openSound",Yn,r(e)),a(e,"closeSound",Jn,r(e)),e}return o(h,[{key:"__preload",value:function(){this.animation=this.getComponent(b),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"addPreloadPromise",value:function(e){this.openPreloadPromises.push(e)}},{key:"hasPreloadOpenPromises",value:function(){return this.openPreloadPromises.length>0}},{key:"preloadOpen",value:(u=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.openPreloadPromises.map((function(e){return e()})),e.next=3,Promise.all(t);case 3:this.openPreloadPromises=[];case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"open",value:function(e){var t=this;e&&(this.data=e),this.animation.once(b.EventType.PLAY,(function(){t.show()}));var n=this.data.openAnimationName||this.openClipName;bi.emit(mi.OPENED_SCREEN,{screenName:this.node.name,screenData:this.data}),this.playAudio(this.openSound),this.runAnimation(n)}},{key:"close",value:function(){var e=this;this.node.active&&(this.animation.once(b.EventType.FINISHED,(function(){bi.emit(mi.CLOSED_SCREEN,{screenName:e.node.name}),e.hide()})),this.playAudio(this.closeSound),this.runAnimation(this.closeClipName))}},{key:"playAudio",value:function(e){if(this.useSound&&e){var t=Fe[e];if(!t)return;Me.playSound(t)}}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(P);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(P);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){this.node.active=!0}},{key:"hide",value:function(){this.node.active=!1}}]),h}(k)).prototype,"container",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vn=e(Hn.prototype,"backgroundMask",[Fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=e(Hn.prototype,"openClipName",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"OpenScreen"}}),qn=e(Hn.prototype,"closeClipName",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"CloseScreen"}}),Kn=e(Hn.prototype,"useSound",[Mn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Yn=e(Hn.prototype,"openSound",[zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return De[ze.POPUP_SHOW]}}),Jn=e(Hn.prototype,"closeSound",[Un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return De[ze.POPUP_HIDE]}}),Gn=Hn))||Gn)||Gn);g._RF.pop(),g._RF.push({},"61d05acoKNP2rgcbUtU8kxl","ScreenBackground",void 0);var wi=m.ccclass,ki=m.property,Ti=Ludex,Ci=Ti.Utils.Decorator,Ei=Ti.Events,Li=Be.Layout,xi=codex.event,Ii=(u(ti={},Li.Portrait,{width:1080,height:2164}),u(ti,Li.Landscape,{width:2732,height:1583}),ti),Ai=(ni=wi("ScreenBackground"),ii=ki(Si),ai=Re.required(),ri=Re.required(),oi=ki(E),si=Ci.debounce(100),ni((ci=e((ui=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"baseScreen",ci,r(e)),a(e,"sprite",hi,r(e)),a(e,"uiTransform",pi,r(e)),a(e,"additionalBg",di,r(e)),e.isPreloadCompleted=!1,e.listenGameEvents=function(t){t.screenName===Ue[Ge.DAILY_CHALLENGE_SCREEN]&&x.on(_e.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ue[Ge.DAILY_CHALLENGE_SCREEN]&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},a(e,"handleViewResized",fi,r(e)),e.viewWidth=0,e.viewHeight=0,e.flag=!0,e}return o(d,[{key:"__preload",value:function(){}},{key:"tryUpdateBackgroundSprite",value:function(){if(Oe.getCurrentLayout()===Be.Layout.Landscape){var e=Oe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Oe.getCurrentLayoutBackgroundByKey("DailyChallenge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Oe.getCurrentLayoutBackgroundByKey("DailyChallenge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentDailyChallengeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"getLandscapeBackground",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return Ii}},{key:"onEnable",value:function(){this.handleViewResized()}},{key:"onDestroy",value:function(){xi.off(Ei.OPENING_SCREEN,this.listenGameEvents),xi.off(Ei.CLOSING_SCREEN,this.unlistenGameEvents),x.off(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateBackgroundSprite",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPreloadCompleted){e.next=3;break}return console.log("Preload not completed yet, skipping updateBackgroundSprite"),e.abrupt("return");case 3:if(t=Oe.getCurrentLayout(),n=I.getVisibleSize(),i=n.width,a=n.height,this.flag){e.next=7;break}return e.abrupt("return");case 7:return this.flag=!1,this.viewWidth=i,this.viewHeight=a,r=[],o=null,s=null,u=this.getPortraitBackground().then((function(e){o=e})),r.push(u),t===Be.Layout.Landscape&&(c=this.getLandscapeBackground().then((function(e){s=e})),r.push(c)),e.next=18,Promise.all(r);case 18:t===Be.Layout.Landscape?(this.additionalBg&&(this.additionalBg.node.active=!0),this.setAdditionalBackgroundSprite(s),this.updateAdditionalSizeBackground(),this.setBackgroundSprite(o),this.updateSizeBackground(i,a)):t===Be.Layout.Portrait?(this.additionalBg&&(this.additionalBg.node.active=!1),this.setBackgroundSprite(o),this.updateSizeBackground(i,a)):console.warn("ScreenBackground: Unsupported layout",t),this.flag=!0,h=I.getVisibleSize(),p=h.width,d=h.height,p===i&&d===a||(console.log("ScreenBackground: Re-update background sprite due to spam resizing by user"),this.updateBackgroundSprite());case 22:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"updateSizeBackground",value:function(e,t){if(this.sprite&&this.sprite.spriteFrame){var n=this.getScreenDesignBackground()[Li.Portrait],i=n.width,a=n.height;this.uiTransform.setContentSize(i,a);var r=t/a;Oe.getCurrentLayout()===Li.Portrait?this.sprite.node.setScale(1,r):this.sprite.node.setScale(r,r),this.uiTransform.setAnchorPoint(.5,0),this.node.setPosition(0,-t/2,0)}}},{key:"updateAdditionalSizeBackground",value:function(){if(this.additionalBg){var e=I.getVisibleSize(),t=e.width,n=e.height;if(this.additionalBg.spriteFrame){var i=Oe.getCurrentLayout(),a=this.getScreenDesignBackground()[i],r=a.width,o=a.height;this.additionalBgUITransform.setContentSize(r,o);var s=t/r,l=n/o,u=Math.max(s,l);this.additionalBg.node.setScale(u,u),this.additionalBgUITransform.setAnchorPoint(.5,.5),this.additionalBg.node.setPosition(0,0,0)}}}},{key:"setAdditionalBackgroundSprite",value:function(e){this.additionalBg&&(this.additionalBg.spriteFrame=e)}}]),d}(k)).prototype,"baseScreen",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hi=e(ui.prototype,"sprite",[ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pi=e(ui.prototype,"uiTransform",[ri],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),di=e(ui.prototype,"additionalBg",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fi=e(ui.prototype,"handleViewResized",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite(),console.log("ScreenBackground: View resized, updating background sprite")}}}),li=ui))||li);g._RF.pop(),g._RF.push({},"6ca4ed2aINDB4yr+3glu5e0","ButtonPlusEvents",void 0);var Ri,Pi,_i,Ni,Oi,Bi,Di,Fi,Mi,zi,Ui,Gi,Hi,Wi,Vi,ji,qi,Ki,Yi,Ji,Zi,Xi,Qi,$i,ea,ta,na,ia,aa,ra="TRANSITION_DOWN",oa="TRANSITION_HOVER",sa="TRANSITION_RESET",la="TRANSITION_DISABLED",ua="CLICK_START",ca="CLICK",ha="CLICK_END",pa="CLICK_CANCEL";g._RF.pop(),g._RF.push({},"56710cJAPhPd4KK3hV3y8m6","ButtonPlus",void 0);var da,fa,ya,va,ga,ma,ba,Sa,wa,ka,Ta=m.ccclass,Ca=m.property,Ea=m.disallowMultiple,La=m.menu,xa=(Ri=Ta("ButtonPlus"),Pi=La("Ludex/ButtonPlus/ButtonPlus"),_i=Ca(_),Ni=Ca(_),Oi=Ca(_),Bi=Ca({override:!0,visible:!1}),Di=Ca({override:!0,visible:!1}),Fi=Ca({override:!0,visible:!1}),Mi=Ca({override:!0,visible:!1}),zi=Ca({override:!0,visible:!1}),Ui=Ca({override:!0,visible:!1}),Gi=Ca({override:!0,visible:!1}),Hi=Ca({override:!0,visible:!1}),Wi=Ca({override:!0,visible:!1}),Vi=Ca({override:!0,visible:!1}),ji=Ca({override:!0,visible:!1}),qi=Ca({visible:function(){return this.makeSound},type:De}),Ki=Ca({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),Yi=Ca({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),Ri(Ji=Ea(Ji=Pi((Xi=e((Zi=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"onClickStartEvents",Xi,r(e)),a(e,"onClickEndEvents",Qi,r(e)),a(e,"onClickCancelEvents",$i,r(e)),a(e,"makeSound",ea,r(e)),a(e,"soundKey",ta,r(e)),a(e,"disableSpamClick",na,r(e)),a(e,"disableSpamDelay",ia,r(e)),a(e,"performBoundsCheckOnClickCancel",aa,r(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.hasBeenDisabled=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=He.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(e.performBoundsCheckOnClickCancel){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickCancelEvents(t),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.emitTransitionEvent(oa)))},e.onMouseLeave=function(t){e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.emitTransitionEvent(sa)},e}return o(l,[{key:"transition",get:function(){return N.Transition.NONE},set:function(e){c(h(l.prototype),"transition",N.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return p(h(l.prototype),"normalColor",this)},set:function(e){c(h(l.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return p(h(l.prototype),"pressedColor",this)},set:function(e){c(h(l.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return p(h(l.prototype),"hoverColor",this)},set:function(e){c(h(l.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return p(h(l.prototype),"disabledColor",this)},set:function(e){c(h(l.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return p(h(l.prototype),"normalSprite",this)},set:function(e){c(h(l.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return p(h(l.prototype),"pressedSprite",this)},set:function(e){c(h(l.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return p(h(l.prototype),"hoverSprite",this)},set:function(e){c(h(l.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return p(h(l.prototype),"disabledSprite",this)},set:function(e){c(h(l.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return p(h(l.prototype),"duration",this)},set:function(e){c(h(l.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return p(h(l.prototype),"zoomScale",this)},set:function(e){c(h(l.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){p(h(l.prototype),"__preload",this).call(this)}},{key:"onDestroy",value:function(){var e;null===(e=p(h(l.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=p(h(l.prototype),"onEnable",this))||void 0===e||e.call(this),this.hasBeenDisabled=!this.interactable,this.node.off(O.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(A.EventType.TOUCH_START,this.onTouchStart),this.node.on(A.EventType.TOUCH_END,this.onTouchEnd),this.node.on(A.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(A.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(A.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=p(h(l.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(A.EventType.TOUCH_START,this.onTouchStart),this.node.off(A.EventType.TOUCH_END,this.onTouchEnd),this.node.off(A.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(A.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(A.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"_updateState",value:function(){p(h(l.prototype),"_updateState",this).call(this),this.patchEmitTransitionDisabled()}},{key:"patchEmitTransitionDisabled",value:function(){var e=3===this._getButtonState();this.hasBeenDisabled!==e&&(e?this.emitTransitionEvent(la):this.emitTransitionEvent(sa),this.hasBeenDisabled=e)}},{key:"handleDown",value:function(e){this.hasDown=!0,this.makeSound&&Me.playSound(Fe[this.soundKey]),this.emitTransitionEvent(ra),this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=d(this.onClickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ua)}},{key:"emitClickEndEvents",value:function(e){var t,n=d(this.onClickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ha)}},{key:"emitClickCancelEvents",value:function(e){var t,n=d(this.onClickCancelEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(pa)}},{key:"handleUp",value:function(e){this.hasUp=!0,this.hasFinishClickCycle=!0,this.emitTransitionEvent(sa),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){var t,n=d(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ca)}}},{key:"emitTransitionEvent",value:function(e){this.node.emit(e)}},{key:"fakeClick",value:function(){var e=this;this.emitTransitionEvent(ra),this.scheduleOnce((function(){e.emitTransitionEvent(sa)}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}},{key:"setInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.interactable=e,t&&(this.enabled=e)}}]),l}(N)).prototype,"onClickStartEvents",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qi=e(Zi.prototype,"onClickEndEvents",[Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$i=e(Zi.prototype,"onClickCancelEvents",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),e(Zi.prototype,"transition",[Bi],Object.getOwnPropertyDescriptor(Zi.prototype,"transition"),Zi.prototype),e(Zi.prototype,"normalColor",[Di],Object.getOwnPropertyDescriptor(Zi.prototype,"normalColor"),Zi.prototype),e(Zi.prototype,"pressedColor",[Fi],Object.getOwnPropertyDescriptor(Zi.prototype,"pressedColor"),Zi.prototype),e(Zi.prototype,"hoverColor",[Mi],Object.getOwnPropertyDescriptor(Zi.prototype,"hoverColor"),Zi.prototype),e(Zi.prototype,"disabledColor",[zi],Object.getOwnPropertyDescriptor(Zi.prototype,"disabledColor"),Zi.prototype),e(Zi.prototype,"normalSprite",[Ui],Object.getOwnPropertyDescriptor(Zi.prototype,"normalSprite"),Zi.prototype),e(Zi.prototype,"pressedSprite",[Gi],Object.getOwnPropertyDescriptor(Zi.prototype,"pressedSprite"),Zi.prototype),e(Zi.prototype,"hoverSprite",[Hi],Object.getOwnPropertyDescriptor(Zi.prototype,"hoverSprite"),Zi.prototype),e(Zi.prototype,"disabledSprite",[Wi],Object.getOwnPropertyDescriptor(Zi.prototype,"disabledSprite"),Zi.prototype),e(Zi.prototype,"duration",[Vi],Object.getOwnPropertyDescriptor(Zi.prototype,"duration"),Zi.prototype),e(Zi.prototype,"zoomScale",[ji],Object.getOwnPropertyDescriptor(Zi.prototype,"zoomScale"),Zi.prototype),ea=e(Zi.prototype,"makeSound",[Ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ta=e(Zi.prototype,"soundKey",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return De[ze.BUTTON_CLICK]}}),na=e(Zi.prototype,"disableSpamClick",[Ki],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ia=e(Zi.prototype,"disableSpamDelay",[Yi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),aa=e(Zi.prototype,"performBoundsCheckOnClickCancel",[Ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ji=Zi))||Ji)||Ji)||Ji);g._RF.pop(),g._RF.push({},"b7001YamGNLeauE1hUAtFfj","ButtonPlusAnalytics",void 0);var Ia,Aa,Ra,Pa,_a,Na,Oa,Ba,Da,Fa,Ma,za,Ua,Ga,Ha,Wa,Va,ja,qa,Ka,Ya,Ja,Za,Xa,Qa=m.ccclass,$a=m.property,er=m.disallowMultiple,tr=m.menu,nr=Ludex.Plugins.Analytics.Events,ir=codex.analytics;da=Qa("ButtonPlusAnalytics"),fa=tr("Ludex/ButtonPlus/ButtonPlusAnalytics"),ya=Re.required,va=$a(xa),ga=$a({visible:function(){return this.useCustomButtonName}}),da(ma=er(ma=fa((Sa=e((ba=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"button",Sa,r(e)),a(e,"useCustomButtonName",wa,r(e)),a(e,"customButtonName",ka,r(e)),e}return o(l,[{key:"onEnable",value:function(){this.button.node.on(ca,this.onClick,this)}},{key:"onDisable",value:function(){this.button.node.off(ra,this.onClick,this)}},{key:"onClick",value:function(){ir.event(nr.BUTTON_CLICK,{button_name:this.useCustomButtonName?this.customButtonName:this.node.name,screen_name:We.getCurrentPage()})}}]),l}(k)).prototype,"button",[ya,va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wa=e(ba.prototype,"useCustomButtonName",[$a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ka=e(ba.prototype,"customButtonName",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ma=ba))||ma)||ma);g._RF.pop(),g._RF.push({},"49518iJ465A7YFaBHFr8zo2","ButtonPlusColor",void 0);var ar,rr,or,sr,lr,ur,cr,hr,pr,dr,fr,yr,vr,gr,mr,br,Sr,wr,kr,Tr=m.ccclass,Cr=m.property,Er=m.disallowMultiple,Lr=m.requireComponent,xr=m.menu,Ir=Ludex.Utils.Signal,Ar=(Ia=Tr("ButtonPlusColor"),Aa=Lr(xa),Ra=Lr(E),Pa=xr("Ludex/ButtonPlus/ButtonPlusColor"),_a=Re.required,Na=Cr(xa),Oa=Re.required,Ba=Cr(E),Da=Cr({group:{name:"Normal",style:"section"},displayName:"Color"}),Fa=Cr({group:{name:"Normal",style:"section"},displayName:"Duration"}),Ma=Cr({group:{name:"Hover",style:"section"},displayName:"Color"}),za=Cr({group:{name:"Hover",style:"section"},displayName:"Duration"}),Ua=Cr({group:{name:"Click",style:"section"},displayName:"Color"}),Ga=Cr({group:{name:"Click",style:"section"},displayName:"Duration"}),Ia(Ha=Er(Ha=Aa(Ha=Ra(Ha=Pa((Va=e((Wa=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"button",Va,r(e)),a(e,"sprite",ja,r(e)),a(e,"normalColor",qa,r(e)),a(e,"normalDuration",Ka,r(e)),a(e,"hoverColor",Ya,r(e)),a(e,"hoverDuration",Ja,r(e)),a(e,"clickColor",Za,r(e)),a(e,"clickDuration",Xa,r(e)),e.animStateController=new Ir.SignalController,e}return o(l,[{key:"start",value:function(){this.setSpriteColor(this.normalColor)}},{key:"onEnable",value:function(){this.button.node.on(ra,this.onTransitionDown,this),this.button.node.on(oa,this.onTransitionHover,this),this.button.node.on(sa,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(ra,this.onTransitionDown,this),this.button.node.off(oa,this.onTransitionHover,this),this.button.node.off(sa,this.onTransitionReset,this)}},{key:"setSpriteColor",value:function(e){this.sprite&&(this.sprite.color=e)}},{key:"tweenSpriteColor",value:function(e,t){var n=this;if(this.sprite){var i=this.sprite.color.clone();Ve.runTweenAsync(B({t:0}).to(t,{t:1},{easing:"cubicOut",onUpdate:function(t){n.sprite&&(n.sprite.color=i.lerp(e,t.t))}}),this.animStateController.renew())}}},{key:"onTransitionDown",value:function(){this.tweenSpriteColor(this.clickColor,this.clickDuration)}},{key:"onTransitionHover",value:function(){this.tweenSpriteColor(this.hoverColor,this.hoverDuration)}},{key:"onTransitionReset",value:function(){this.tweenSpriteColor(this.normalColor,this.normalDuration)}}]),l}(k)).prototype,"button",[_a,Na],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ja=e(Wa.prototype,"sprite",[Oa,Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qa=e(Wa.prototype,"normalColor",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,255)}}),Ka=e(Wa.prototype,"normalDuration",[Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Ya=e(Wa.prototype,"hoverColor",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,255)}}),Ja=e(Wa.prototype,"hoverDuration",[za],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Za=e(Wa.prototype,"clickColor",[Ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(204,204,204)}}),Xa=e(Wa.prototype,"clickDuration",[Ga],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Ha=Wa))||Ha)||Ha)||Ha)||Ha)||Ha);g._RF.pop(),g._RF.push({},"a89b3F866FGO68YNa+5Tsqh","ButtonPlusScale",void 0);var Rr=m.ccclass,Pr=m.property,_r=m.disallowMultiple,Nr=m.menu,Or=Ludex.Utils.Signal;ar=Rr("ButtonPlusScale"),rr=Nr("Ludex/ButtonPlus/ButtonPlusScale"),or=Re.required,sr=Pr(xa),lr=Pr({group:{name:"Normal",style:"section"},displayName:"Scale"}),ur=Pr({group:{name:"Normal",style:"section"},displayName:"Duration"}),cr=Pr({group:{name:"Hover",style:"section"},displayName:"Scale"}),hr=Pr({group:{name:"Hover",style:"section"},displayName:"Duration"}),pr=Pr({group:{name:"Click",style:"section"},displayName:"Scale"}),dr=Pr({group:{name:"Click",style:"section"},displayName:"Duration"}),ar(fr=_r(fr=rr((vr=e((yr=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"button",vr,r(e)),a(e,"normalScale",gr,r(e)),a(e,"normalDuration",mr,r(e)),a(e,"hoverScale",br,r(e)),a(e,"hoverDuration",Sr,r(e)),a(e,"clickScale",wr,r(e)),a(e,"clickDuration",kr,r(e)),e.animStateController=new Or.SignalController,e}return o(l,[{key:"start",value:function(){this.button.node.setScale(this.normalScale)}},{key:"onEnable",value:function(){this.button.node.on(ra,this.onTransitionDown,this),this.button.node.on(oa,this.onTransitionHover,this),this.button.node.on(sa,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(ra,this.onTransitionDown,this),this.button.node.off(oa,this.onTransitionHover,this),this.button.node.off(sa,this.onTransitionReset,this)}},{key:"onTransitionDown",value:function(){Ve.runTweenAsync(B(this.button.node).to(this.clickDuration,{scale:this.clickScale},{easing:"cubicOut"}),this.animStateController.renew())}},{key:"onTransitionHover",value:function(){Ve.runTweenAsync(B(this.button.node).to(this.hoverDuration,{scale:this.hoverScale},{easing:"backOut"}),this.animStateController.renew())}},{key:"onTransitionReset",value:function(){Ve.runTweenAsync(B(this.button.node).to(this.normalDuration,{scale:this.normalScale},{easing:"cubicOut"}),this.animStateController.renew())}}]),l}(k)).prototype,"button",[or,sr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=e(yr.prototype,"normalScale",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(1,1,1)}}),mr=e(yr.prototype,"normalDuration",[ur],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),br=e(yr.prototype,"hoverScale",[cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(1.1,1.1,1.1)}}),Sr=e(yr.prototype,"hoverDuration",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),wr=e(yr.prototype,"clickScale",[pr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(.9,.9,.9)}}),kr=e(yr.prototype,"clickDuration",[dr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),fr=yr))||fr)||fr);g._RF.pop(),g._RF.push({},"bd9d5FQ4EpKcIK2rZmmYQPr","VibrateEffectManager",void 0);var Br,Dr,Fr,Mr,zr,Ur,Gr,Hr,Wr,Vr,jr=Ludex.Utils.Browser,qr=codex.player,Kr=function(){function e(){i(this,e)}return o(e,[{key:"isVibrateEnable",value:function(){return!!qr.getPlayerSetting("vibrate")}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"vibrate",value:function(e){if(this.inst.isVibrateEnable()&&0!==e&&!jr.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}}]),e}();g._RF.pop(),g._RF.push({},"1c88ex+VNVCDaiLiD6eJgHG","ButtonPlusVibrate",void 0);var Yr,Jr=m.ccclass,Zr=m.property,Xr=m.disallowMultiple,Qr=m.requireComponent,$r=m.menu;Ludex.Utils.Signal,Br=Jr("ButtonPlusVibrate"),Dr=Qr(xa),Fr=Qr(E),Mr=$r("Ludex/ButtonPlus/ButtonPlusVibrate"),zr=Re.required,Ur=Zr(xa),Br(Gr=Xr(Gr=Dr(Gr=Fr(Gr=Mr((Wr=e((Hr=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"button",Wr,r(e)),a(e,"time",Vr,r(e)),e}return o(l,[{key:"onEnable",value:function(){this.button.node.on(ra,this.onTransitionDown,this)}},{key:"onDisable",value:function(){this.button.node.off(ra,this.onTransitionDown,this)}},{key:"onTransitionDown",value:function(){Kr.vibrate(this.time)}}]),l}(k)).prototype,"button",[zr,Ur],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vr=e(Hr.prototype,"time",[Zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 35}}),Gr=Hr))||Gr)||Gr)||Gr)||Gr);g._RF.pop(),g._RF.push({},"16eacEpHldFUJlfsLYO+IKK","DebugButtonPlus",void 0);var eo,to,no,io,ao,ro,oo,so,lo,uo,co,ho,po,fo,yo,vo,go,mo=m.ccclass;m.property,mo("DebugButtonPlus")(Yr=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"onLoad",value:function(){Ludex.Utils.Valid.isDebugger()?this.node.active=!0:this.node.active=!1}},{key:"start",value:function(){}}]),r}(k));g._RF.pop(),g._RF.push({},"4b299Dv1kVGcqQmJC9yBPAV","ButtonReleased",void 0);var bo,So,wo,ko,To=m.ccclass,Co=m.requireComponent,Eo=m.property,Lo=m.disallowMultiple,xo=m.executionOrder,Io=codex.analytics;eo=To("ButtonReleased"),to=Co([b,N]),no=xo(120),io=Eo(S),ao=Eo(S),ro=Eo(R),oo=Eo({visible:function(){return this.useSound},type:De}),so=Eo({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),lo=Eo({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),eo(uo=Lo(uo=to(uo=no((ho=e((co=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"downClipName",ho,r(e)),a(e,"upClipName",po,r(e)),a(e,"useSound",fo,r(e)),a(e,"soundKey",yo,r(e)),a(e,"disableSpamClick",vo,r(e)),a(e,"disableSpamDelay",go,r(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.onTouchStart=function(t){if(e.buttonComponent.interactable&&!e.hasDown&&(e.currentClickBoundingBox=He.getBoundingBoxToWorld(e.node),e.hasDown=!0,e.runAnimation(e.downClipName),e.useSound&&e.soundKey)){var n=Fe[e.soundKey];if(!n)return;Me.playSound(n)}},e.onTouchEnd=function(t){e.buttonComponent.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))},e.onTouchCancel=function(t){var n,i;if(e.buttonComponent.interactable&&e.hasDown&&!e.hasUp){var a=t.getUILocation(),r=null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n;t instanceof M&&r?e.handleUp(t):(e.hasUp=!0,e.runAnimation(e.upClipName),e.animationComponent.once(b.EventType.FINISHED,(function(){e.handleResetButtonState()})))}},e.handleResetButtonState=function(){var t;if(e.hasDown=!1,e.hasUp=!1,e.buttonComponent){var n=e.buttonComponent.node.scale.x,i=e.buttonComponent.node.scale.z;null===(t=e.buttonComponent)||void 0===t||t.node.setScale(new F(n,1,i))}},e}return o(l,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(N),this.animationComponent=this.getComponent(b),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.animationComponent.clips.length<2?console.warn("ButtonAnimAddition: Animation component must have 2 clips in ".concat(this.node.name)):(this.node.off(O.EventType.TOUCH_END,this.buttonComponent._onTouchEnded,this.buttonComponent),this.node.on(A.EventType.TOUCH_START,this.onTouchStart),this.node.on(A.EventType.TOUCH_END,this.onTouchEnd),this.node.on(A.EventType.TOUCH_CANCEL,this.onTouchCancel))}},{key:"onDisable",value:function(){this.node.off(A.EventType.TOUCH_START,this.onTouchStart),this.node.off(A.EventType.TOUCH_END,this.onTouchEnd),this.node.off(A.EventType.TOUCH_CANCEL,this.onTouchCancel),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleUp",value:function(e){var t=this;this.hasUp=!0,this.runAnimation(this.upClipName),this.animationComponent.once(b.EventType.FINISHED,(function(){if(t.disableSpamClick?t.scheduleOnce(t.handleResetButtonState,t.disableSpamDelay):t.handleResetButtonState(),!t.buttonComponent||t.buttonComponent.interactable){Io.event(Ludex.Plugins.Analytics.Events.BUTTON_CLICK,{button_name:t.node.name,screen_name:We.getCurrentPage()});var n=t.buttonComponent.clickEvents;if(n){var i,a=d(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;r.emit([e,r.customEventData])}}catch(e){a.e(e)}finally{a.f()}}}}))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),l}(k)).prototype,"downClipName",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonDown"}}),po=e(co.prototype,"upClipName",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonUp"}}),fo=e(co.prototype,"useSound",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),yo=e(co.prototype,"soundKey",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return De[ze.BUTTON_CLICK]}}),vo=e(co.prototype,"disableSpamClick",[so],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),go=e(co.prototype,"disableSpamDelay",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),uo=co))||uo)||uo)||uo);g._RF.pop(),g._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var Ao,Ro,Po,_o,No,Oo,Bo,Do,Fo,Mo,zo,Uo,Go,Ho,Wo=m.ccclass,Vo=m.requireComponent,jo=m.property,qo=Wo("OpacityToggler")(bo=Vo([P])((wo=e((So=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"activeValue",wo,r(e)),a(e,"inActiveValue",ko,r(e)),e}return o(l,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(P),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}}]),l}(k)).prototype,"activeValue",[jo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),ko=e(So.prototype,"inActiveValue",[jo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),bo=So))||bo)||bo;g._RF.pop(),g._RF.push({},"c3ceby2vFtPK4X28SuN+nVX","ResizeWithBannerAd",void 0);var Ko,Yo,Jo,Zo=m.ccclass,Xo=m.requireComponent,Qo=m.property,$o=codex,es=$o.ads,ts=$o.event,ns=Ludex,is=ns.Events,as=ns.Configs.Ads.BannerDisplayAdOptions,rs=ns.Plugins.Ads,os=rs.Types,ss=rs.Status,ls=ns.Utils,us=ls.Array,cs=ls.Function,hs=ls.Device,ps=["top","topleft","topright"],ds=["bottom","bottomleft","bottomright"],fs=["left","topleft","bottomleft"],ys=["right","topright","bottomright"];Ao=Zo("ResizeWithBannerAd"),Ro=Xo(z),Po=Qo(R),_o=Qo(R),No=Qo(R),Oo=Qo(R),Bo=Qo(R),Ao(Do=Ro((Mo=e((Fo=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"includeSAB",Mo,r(e)),a(e,"includeRightBanner",zo,r(e)),a(e,"includeBottomBanner",Uo,r(e)),a(e,"includeLeftBanner",Go,r(e)),a(e,"closeWhenAdFailed",Ho,r(e)),e.handleOnAdShowing=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&(i===os.BANNER&&es.getAd(os.BANNER,n)&&(e.resizeWhenBannerAdShow(n),e.emitResizeEvent()))},e.handleOnAdClosed=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&(i===os.BANNER&&es.getAd(os.BANNER,n)&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent()))},e.handleOnAdFailed=function(t){var n=t.placementId,i=t.type;e.closeWhenAdFailed&&e.checkValid()&&n&&i===os.BANNER&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent())},e.handleOnResize=function(){e.checkValid()&&(0!==as.length?as.forEach((function(t){var n=t.PlacementId,i=es.getAdStatus(os.BANNER,n);i&&(i===ss.SHOWING||hs.isIOS()?e.resizeWhenBannerAdShow(n):i===ss.IDLE&&e.resizeWhenBannerAdClose(n))})):e.resizeSafeAreaBottom())},e.resizeWhenBannerAdShow=function(t){var n=void 0,i=void 0,a=void 0,r=void 0,o=He.cssSizeToWorldSize(1),s=es.getBannerConfig(t),l=s.PlacementId,u=s.BannerWidth,c=s.Position;if("top"===c)n=es.getBannerHeight(l,o);else if("bottom"===c)e.includeBottomBanner?i=es.getBannerHeight(l,o,e.includeSAB):e.includeSAB&&(i=es.getSafeAreaBottom(o));else if("left"===c||"right"===c){if(void 0===u)return;var h=u;"getBannerOffset"in GameSDK.extra&&(h+=GameSDK.extra.getBannerOffset()),"left"===c&&e.includeLeftBanner?a=h*o:"right"===c&&e.includeRightBanner&&(r=h*o)}e.updateWidgets({top:n,bottom:i,left:a,right:r})},e.resizeWhenBannerAdClose=function(t){var n=es.getBannerConfig(t).Position,i=He.cssSizeToWorldSize(1),a=e.includeSAB?es.getSafeAreaBottom(i):0;e.updateWidgets({top:us.has(ps,n)?0:void 0,bottom:us.has(ds,n)?a:void 0,left:us.has(fs,n)?0:void 0,right:us.has(ys,n)?0:void 0})},e.resizeSafeAreaBottom=function(){var t=He.cssSizeToWorldSize(1),n=e.includeSAB?es.getSafeAreaBottom(t):0;e.updateWidgets({bottom:n})},e.emitResizeEvent=cs.debounce((function(){x.emit(_e.WIDGET_RESIZED)}),100),e}return o(l,[{key:"__preload",value:function(){this.widget=this.getComponent(z),Re.lazyValidateProperties(this),ts.on(is.AD_SHOWING,this.handleOnAdShowing),ts.on(is.AD_CLOSED,this.handleOnAdClosed),ts.on(is.AD_FAILED,this.handleOnAdFailed),x.on(_e.VIEW_RESIZED,this.handleOnResize)}},{key:"onDestroy",value:function(){ts.off(is.AD_SHOWING,this.handleOnAdShowing),ts.off(is.AD_CLOSED,this.handleOnAdClosed),ts.off(is.AD_FAILED,this.handleOnAdFailed),x.off(_e.VIEW_RESIZED,this.handleOnResize)}},{key:"onEnable",value:function(){this.handleOnResize()}},{key:"updateWidgets",value:function(e){var t=e.top,n=e.bottom,i=e.left,a=e.right;this.widget.top=null!=t?t:this.widget.top,this.widget.bottom=null!=n?n:this.widget.bottom,this.widget.left=null!=i?i:this.widget.left,this.widget.right=null!=a?a:this.widget.right,U.instance.emit("canvas-resize")}},{key:"checkValid",value:function(){return this.node.activeInHierarchy&&null!==this.node.parent&&void 0!==this.node.parent}}]),l}(k)).prototype,"includeSAB",[Po],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),zo=e(Fo.prototype,"includeRightBanner",[_o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Uo=e(Fo.prototype,"includeBottomBanner",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Go=e(Fo.prototype,"includeLeftBanner",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ho=e(Fo.prototype,"closeWhenAdFailed",[Bo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Do=Fo))||Do);g._RF.pop(),g._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var vs,gs,ms,bs,Ss,ws,ks,Ts=m.ccclass,Cs=m.property,Es=m.requireComponent,Ls=m.disallowMultiple,xs=m.executeInEditMode,Is=Be.DesignSize,As=Is.Portrait,Rs=Is.Landscape;Ts("DebugResolution")(Ko=Ls(Ko=Es([G])(Ko=xs(!0)(((Jo=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return o(r,[{key:"drawPortrait",get:function(){return r._drawPortrait},set:function(e){e!==r._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),r._drawPortrait=e,r._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return r._drawLandscape},set:function(e){e!==r._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),r._drawLandscape=e,r._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(G),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){x.on(_e.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=As.WIDTH,n=As.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=D.GREEN,e.rect(i,a,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=Rs.WIDTH,n=Rs.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=D.CYAN,e.rect(i,a,t,n),e.stroke()}}}]),r}(k))._drawPortrait=!0,Jo._drawLandscape=!0,e((Yo=Jo).prototype,"drawPortrait",[Cs],Object.getOwnPropertyDescriptor(Yo.prototype,"drawPortrait"),Yo.prototype),e(Yo.prototype,"drawLandscape",[Cs],Object.getOwnPropertyDescriptor(Yo.prototype,"drawLandscape"),Yo.prototype),Ko=Yo))||Ko)||Ko)||Ko);g._RF.pop(),g._RF.push({},"e385aHZ0YdE449MMaQ5BZrq","CustomProgressBar",void 0);var Ps,_s,Ns,Os,Bs,Ds,Fs,Ms,zs,Us,Gs=m.ccclass,Hs=m.property,Ws=(m.requireComponent,vs=Gs("CustomProgressBar"),gs=Hs(E),ms=Hs(E),vs((ws=e((Ss=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=s.call.apply(s,[this].concat(n))).progress=0,a(e,"head",ws,r(e)),a(e,"tail",ks,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.progressBar=this.getComponent(H),this.headWidth=this.head.getComponent(L).width,this.tailWidth=this.tail.getComponent(L).width;var e=this.tail.node.x-this.head.node.x-this.headWidth;this.progressBar.totalLength=e}},{key:"setProgress",value:function(e){if(e<0||e>1)console.warn("Progress value must be between 0 and 1");else{if(!this.progressBar){this.progressBar=this.getComponent(H),this.headWidth=this.head.getComponent(L).width,this.tailWidth=this.tail.getComponent(L).width;var t=this.tail.node.x-this.head.node.x-this.headWidth;this.progressBar.totalLength=t}this.progress=e;var n=this.progressBar.totalLength+this.headWidth+this.tailWidth,i=n*e;0===i?(this.head.node.active=!1,this.tail.node.active=!1,this.progressBar.progress=0):i<this.headWidth?(this.head.node.active=!0,this.tail.node.active=!1,this.progressBar.progress=0):i<n-this.tailWidth/2?(this.head.node.active=!0,this.tail.node.active=!1,this.progressBar.progress=(i-this.headWidth)/this.progressBar.totalLength):(this.head.node.active=!0,this.tail.node.active=!0,this.progressBar.progress=1)}}},{key:"getProgress",value:function(){return this.progress}},{key:"onDestroy",value:function(){}}]),l}(k)).prototype,"head",[gs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=e(Ss.prototype,"tail",[ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=Ss))||bs);g._RF.pop(),g._RF.push({},"a60a9MZ5HNKVrHVpmUqCahw","ResponsiveNode",void 0);var Vs,js,qs,Ks,Ys,Js,Zs,Xs,Qs,$s,el,tl,nl,il,al,rl,ol,sl=m.ccclass,ll=m.property,ul=function(e){return e.NONE="None",e.SCALE_Y="ScaleY",e.SCALE="Scale",e.RESIZE="Resize",e.RESIZE_WITH_BANNER="ResizeWithBanner",e}(ul||{}),cl=Ludex,hl=cl.Utils.Decorator,pl=(cl.Events,Be.Layout),dl=(u(Ps={},pl.Portrait,{width:1080,height:2164}),u(Ps,pl.Landscape,{width:2732,height:1583}),Ps),fl=(_s=sl("ResponsiveNode"),Ns=ll(R),Os=ll({type:W(ul)}),Bs=hl.debounce(100),_s((Ms=e((Fs=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"isFooter",Ms,r(e)),a(e,"resizeType",zs,r(e)),a(e,"handleViewResized",Us,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.basePosition={x:this.node.position.x,y:this.node.position.y},this.uiTransform=this.node.getComponent(L),this.baseSize={width:this.uiTransform.contentSize.width,height:this.uiTransform.contentSize.height},this.baseScale={x:this.node.scale.x,y:this.node.scale.y}}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}},{key:"onEnable",value:function(){this.handleViewResized(),this.listenGameEvents()}},{key:"onDisable",value:function(){this.unlistenGameEvents()}},{key:"listenGameEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"unlistenGameEvents",value:function(){x.off(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"updateObjectInLayoutPortrait",value:function(){var e=I.getVisibleSize(),t=e.width,n=e.height,i=dl[pl.Portrait],a=t/i.width,r=n/i.height,o=je.getBannerAdsHeight();switch(this.isFooter?this.node.setPosition(new F(this.basePosition.x,this.basePosition.y*r+o,0)):this.node.setPosition(new F(this.basePosition.x,this.basePosition.y*r,0)),this.resizeType){case ul.SCALE_Y:this.node.setScale(new F(this.baseScale.x,this.baseScale.y*r,1));break;case ul.SCALE:this.node.setScale(new F(this.baseScale.x*Math.min(a,r),this.baseScale.y*Math.min(a,r),1));break;case ul.RESIZE:this.node.getComponent(L).setContentSize(this.baseSize.width*a,this.baseSize.height*r);break;case ul.RESIZE_WITH_BANNER:var s=this.node.getComponent(L);this.isFooter?(this.node.setPosition(new F(this.basePosition.x,this.basePosition.y*r+o*(1-this.uiTransform.anchorPoint.y),0)),s.setContentSize(this.baseSize.width*a,this.baseSize.height*r-o)):s.setContentSize(this.baseSize.width*a,this.baseSize.height*r);break;case ul.NONE:}}},{key:"updateObjectInLayoutLandscape",value:function(){var e=je.getBannerAdsHeight();switch(this.isFooter?this.node.setPosition(new F(this.basePosition.x,this.basePosition.y+e,0)):this.node.setPosition(new F(this.basePosition.x,this.basePosition.y,0)),this.resizeType){case ul.SCALE_Y:case ul.SCALE:this.node.setScale(new F(this.baseScale.x,this.baseScale.y,1));break;case ul.RESIZE:this.node.getComponent(L).setContentSize(this.baseSize.width,this.baseSize.height);break;case ul.RESIZE_WITH_BANNER:var t=this.node.getComponent(L),n=this.isFooter?e:0;t.setContentSize(this.baseSize.width,this.baseSize.height-n),this.isFooter,this.node.setPosition(new F(this.basePosition.x,this.basePosition.y+n/2,0));break;case ul.NONE:}}}]),l}(k)).prototype,"isFooter",[Ns],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),zs=e(Fs.prototype,"resizeType",[Os],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ul.NONE}}),Us=e(Fs.prototype,"handleViewResized",[Bs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Oe.getCurrentLayout();t===Be.Layout.Portrait?e.updateObjectInLayoutPortrait():t===Be.Layout.Landscape&&e.updateObjectInLayoutLandscape()}}}),Ds=Fs))||Ds);g._RF.pop(),g._RF.push({},"de0da6Sv3RKX4hKrjSEeaiO","VelocityScroller",void 0);var yl,vl=m.ccclass,gl=m.property,ml="scroll-update-continuous",bl="scroll-update-discrete",Sl=(Vs=vl("VelocityScroller"),js=gl(V),qs=gl(V),Ks=gl(V),Ys=gl(V),Js=gl(V),Zs=gl(A),Xs=gl(L),Vs((el=e(($s=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"acceleration",el,r(e)),a(e,"scrollingSpeed",tl,r(e)),a(e,"mouseScrollingSpeed",nl,r(e)),a(e,"maxBounceHeight",il,r(e)),a(e,"outRangeDecayFactor",al,r(e)),a(e,"content",rl,r(e)),a(e,"viewPort",ol,r(e)),e.lastTouchPos=new j,e.lastTouchMovePos=new j,e.velocity=new j,e.isTouching=!1,e.isStartFromBottom=!0,e.isFreeControl=!1,e.bottomBorder=0,e.topBorder=0,e.startTime=0,e.prevContentPosY=0,e.prevContentPosY2=0,e.originalContentHeight=0,e.originalViewPortHeight=0,e.originalTopBorder=0,e.originalBottomBorder=0,e}return o(l,[{key:"__preload",value:function(){this.registerEvents(),this.initializeComponents(),this.initData()}},{key:"registerEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleScrollerWhenResize,this),this.node.on(A.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(A.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(A.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(A.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.on(A.EventType.MOUSE_WHEEL,this.onMouseScrolling,this)}},{key:"handleScrollerWhenResize",value:function(){this.setUpBorders()}},{key:"addBorderAmount",value:function(e){this.isStartFromBottom?this.bottomBorder=this.originalBottomBorder-e:(this.topBorder=this.originalTopBorder+e,this.bottomBorder=this.originalBottomBorder+e)}},{key:"initData",value:function(){this.originalViewPortHeight=this.scrollerUITransform.height,this.originalContentHeight=this.contentUITransform.height}},{key:"setFreeControl",value:function(e){this.isFreeControl=e}},{key:"initScroller",value:function(e){var t=e.isStartFromBottom,n=e.isAddedHeight,i=e.height;this.isStartFromBottom=t,this.contentUITransform.height=n?this.originalContentHeight+i:i,this.setUpBorders()}},{key:"addHeightToViewport",value:function(e){this.scrollerUITransform.height=this.originalViewPortHeight+e}},{key:"setUpBorders",value:function(){var e=this.viewPort.node.position.y,t=this.contentUITransform.contentSize.height;this.isStartFromBottom?(this.topBorder=e+this.maxBounceHeight,this.bottomBorder=-(t-Math.abs(e))-this.maxBounceHeight):(this.topBorder=t-Math.abs(e)+this.maxBounceHeight,this.bottomBorder=e-this.maxBounceHeight),this.originalTopBorder=this.topBorder,this.originalBottomBorder=this.bottomBorder}},{key:"initializeComponents",value:function(){this.scrollerUITransform=this.getComponent(L),this.contentUITransform=this.content.getComponent(L),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onTouchStart",value:function(e){this.isFreeControl||(this.isTouching=!0,this.lastTouchPos=e.getLocation().clone(),this.lastTouchMovePos=e.getLocation().clone(),this.startTime=Date.now())}},{key:"onTouchMove",value:function(e){if(!this.isFreeControl){var t=e.getLocation().clone(),n=t.y-this.lastTouchMovePos.y,i=this.content.position,a=i.x,r=i.y,o=i.z;this.isOutRange()&&(n*=this.outRangeDecayFactor);var s=this.clampTargetY(r+n);this.content.setPosition(a,s,o),this.lastTouchMovePos.set(t.clone())}}},{key:"onTouchEnd",value:function(e){if(!this.isFreeControl&&(this.isTouching=!1,!((Date.now()-this.startTime)/1e3>.2))){var t=e.getLocation().clone(),n=t.y-this.lastTouchPos.y,i=this.velocity.y;this.lastTouchPos.set(t.clone()),this.velocity.set(0,i+n)}}},{key:"onMouseScrolling",value:function(e){if(!this.isFreeControl){var t=e.getScrollY()*this.mouseScrollingSpeed,n=this.velocity.y;this.velocity.set(0,n-t)}}},{key:"update",value:function(e){this.updateScroller(e),this.tryToUpdateContinuousScroller(),this.tryToUpdateDiscreteScroller()}},{key:"tryToUpdateDiscreteScroller",value:function(){this.canDiscreteUpdate()&&this.node.emit(bl)}},{key:"tryToUpdateContinuousScroller",value:function(){this.canContinuousUpdate()&&this.node.emit(ml)}},{key:"canDiscreteUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY)<=10)&&(this.prevContentPosY=e,!0)}},{key:"canContinuousUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY2)<=10)&&(this.prevContentPosY2=e,!0)}},{key:"updateScroller",value:function(e){if(!this.isFreeControl&&!this.tryToBounceBack(e)){var t=this.content.position,n=t.x,i=t.y,a=t.z,r=this.velocity.y,o=i+r*this.scrollingSpeed*e,s=this.getVelocityOverTime(r,e);this.velocity.set(0,s),o>this.topBorder&&(o=this.topBorder,this.velocity.set(0,0)),o<this.bottomBorder&&(o=this.bottomBorder,this.velocity.set(0,0)),o=this.handleClampTargetY(o),this.content.setPosition(n,o,a)}}},{key:"handleClampTargetY",value:function(e){if(this.isOutRange()){var t=this.velocity.y;this.velocity.set(0,t*this.outRangeDecayFactor)}return this.clampTargetY(e)}},{key:"clampTargetY",value:function(e){return e>this.topBorder?(this.velocity.set(0,0),this.topBorder):e<this.bottomBorder?(this.velocity.set(0,0),this.bottomBorder):e}},{key:"tryToBounceBack",value:function(e){var t=this.content.position.y;if(this.isTouching)return!1;var n=this.topBorder-this.maxBounceHeight,i=this.bottomBorder+this.maxBounceHeight;return t>n?(this.moveContentToRealBorder(n,e),this.velocity.set(0,0),!0):t<i&&(this.moveContentToRealBorder(i,e),this.velocity.set(0,0),!0)}},{key:"isOutRange",value:function(){var e=this.content.position.y,t=this.topBorder-this.maxBounceHeight,n=this.bottomBorder+this.maxBounceHeight;return e>t||e<n}},{key:"getVelocityOverTime",value:function(e,t){var n=Math.sign(e),i=Math.abs(e);return i*=Math.exp(this.acceleration*t),this.compareWithSmallestNumber(i)?0:n*i}},{key:"moveContentToRealBorder",value:function(e,t){var n=this.content.position,i=n.x,a=n.y,r=n.z,o=a+(e-a)*this.scrollingSpeed*t;this.compareWithSmallestNumber(o-a)?this.content.setPosition(i,e,r):this.content.setPosition(i,o,r)}},{key:"compareWithSmallestNumber",value:function(e){return Math.abs(e)<.1}},{key:"scrollWithOffset",value:function(e){var t=this.content.position.y+e;this.scrollToTargetY(t)}},{key:"scrollToTargetY",value:function(e){var t=this.content.position,n=t.x,i=t.z,a=e,r=this.topBorder-this.maxBounceHeight,o=this.bottomBorder+this.maxBounceHeight;e>r&&!this.isFreeControl&&(a=r),e<o&&!this.isFreeControl&&(a=o),this.content.setPosition(n,a,i)}},{key:"clampToBottomBorder",value:function(e){var t=this.bottomBorder+this.maxBounceHeight;return Math.max(e,t)}},{key:"reduceContentHeight",value:function(e){this.contentUITransform.height-=e,this.topBorder-=e}},{key:"addContentHeight",value:function(e){this.contentUITransform.height+=e,this.topBorder+=e}}]),l}(k)).prototype,"acceleration",[js],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-5}}),tl=e($s.prototype,"scrollingSpeed",[qs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 15}}),nl=e($s.prototype,"mouseScrollingSpeed",[Ks],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),il=e($s.prototype,"maxBounceHeight",[Ys],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 250}}),al=e($s.prototype,"outRangeDecayFactor",[Js],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.34}}),rl=e($s.prototype,"content",[Zs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=e($s.prototype,"viewPort",[Xs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qs=$s))||Qs);g._RF.pop(),g._RF.push({},"cbb040O6r1E+Ya9pFo++LKi","FakeItem",void 0);var wl,kl=(0,m.ccclass)("FakeItem")(yl=function(){function e(){i(this,e),this.idx=-1,this.active=!0}return o(e,[{key:"getIdx",value:function(){return this.idx}},{key:"getActive",value:function(){return this.active}},{key:"getRealItem",value:function(){return this.realItem}},{key:"getPosition",value:function(){return this.position}},{key:"setIdx",value:function(e){this.idx=e}},{key:"setRealItem",value:function(e){this.realItem=e}},{key:"setPosition",value:function(e){this.position=e}},{key:"setActive",value:function(e){this.active=e}},{key:"copyFrom",value:function(e){this.active=e.getActive()}},{key:"toggleRealItem",value:function(e){this.realItem.node.active=e}
//! only work for vertical scroller
},{key:"isVisible",value:function(){var e=this.realItem.node.getPosition().y,t=this.position.y-e;return Math.abs(t)<.1}}]),e}())||yl;g._RF.pop(),g._RF.push({},"e5ccdo8rdROT7cRjZAjWhAs","RealItem",void 0);var Tl,Cl,El,Ll,xl,Il,Al,Rl,Pl,_l,Nl,Ol,Bl,Dl,Fl,Ml,zl,Ul,Gl,Hl,Wl,Vl,jl,ql,Kl,Yl,Jl,Zl,Xl,Ql,$l,eu=(0,m.ccclass)("RealItem")(wl=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r)}(k))||wl;g._RF.pop(),g._RF.push({},"550b3tQjbFBA6q7NFyZoZG/","ReusableScroller",void 0);var tu=m.ccclass,nu=m.property,iu=(Tl=tu("ReusableScroller"),Cl=nu(L),El=nu(q),Ll=nu(A),xl=nu(R),Il=nu(R),Al=nu(w),Rl=nu(w),Pl=nu(V),_l=nu(V),Nl=nu(V),Ol=nu(V),Bl=nu(V),Dl=nu(V),Fl=nu(R),Tl((Ul=e((zl=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"viewUITransform",Ul,r(e)),a(e,"itemPrefab",Gl,r(e)),a(e,"content",Hl,r(e)),a(e,"isVertical",Wl,r(e)),a(e,"isStartFromBottom",Vl,r(e)),a(e,"maxRealItems",jl,r(e)),a(e,"borderItems",ql,r(e)),a(e,"distanceBetweenItems",Kl,r(e)),a(e,"itemHeight",Yl,r(e)),a(e,"offsetHeader",Jl,r(e)),a(e,"offsetBottom",Zl,r(e)),a(e,"navigationTopBorder",Xl,r(e)),a(e,"navigationBottomBorder",Ql,r(e)),a(e,"isDebug",$l,r(e)),e.realItems=[],e.fakeItems=[],e.shouldUpdateItems=!0,e.originalContentPosY=0,e.payloads=[],e.originalOffsetHeader=0,e}return o(l,[{key:"setOffsetHeader",value:function(e){this.offsetHeader=e}},{key:"setOffsetBottom",value:function(e){this.offsetBottom=e}},{key:"addOffsetHeader",value:function(e){this.offsetHeader+=e}},{key:"addOffsetBottom",value:function(e){this.offsetBottom+=e}},{key:"getOffsetHeader",value:function(){return this.offsetHeader}},{key:"getOffsetBottom",value:function(){return this.offsetBottom}},{key:"getFakeItem",value:function(e){return this.fakeItems[e]}},{key:"__preload",value:function(){this.initData(),this.initComponents(),this.registerEvents()}},{key:"initData",value:function(){this.originalOffsetHeader=this.offsetHeader}},{key:"initComponents",value:function(){this.scroller=this.node.getComponent(Sl),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"registerEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleScrollerWhenResize,this),this.scroller&&(this.scroller.node.on(bl,this.handleDiscreteScroll,this),this.scroller.node.on(ml,this.handleContinuousScroll,this))}},{key:"handleScrollerWhenResize",value:function(){var e=this.viewUITransform.contentSize.height,t=Math.ceil(e/(this.itemHeight+this.distanceBetweenItems)),n=this.maxRealItems-this.borderItems;if(!(t<=n)){this.maxRealItems=t+this.borderItems;for(var i=t-n+1,a=0;a<i;a++){var r=this.createRealItem();this.realItems.push(r);var o=this.distanceBetweenItems+this.itemHeight,s=new F(0,this.originalContentPosY+-1*(a*o+this.offsetBottom),0);r.node.setPosition(s),r.node.active=!1}for(var l=0;l<this.fakeItems.length;l++){var u=this.fakeItems[l],c=this.realItems[l%this.maxRealItems];u.setRealItem(c)}this.refreshScroller()}}},{key:"onLoad",value:function(){this.originalContentPosY=this.content.position.y}},{key:"reloadMaxRealItems",value:function(){var e=this.viewUITransform.contentSize.height,t=Math.ceil(e/(this.itemHeight+this.distanceBetweenItems));this.maxRealItems=t+this.borderItems,console.log("%c maxRealItems: ".concat(this.maxRealItems),"font-size:12px;background-color: #222;color:#bada55;")}},{key:"createRealItems",value:function(){var e=this.isStartFromBottom?1:-1,t=e*this.itemHeight/2;if(this.maxRealItems-this.realItems.length<=0)for(var n=this.maxRealItems;n<this.realItems.length;n++){this.realItems[n].node.active=!1}for(var i=this.realItems.length;i<this.maxRealItems;i++){var a=this.createRealItem();this.realItems.push(a);var r=this.distanceBetweenItems+this.itemHeight,o=new F(0,t+(i*r+this.offsetBottom)*e,0);a.node.setPosition(o),a.node.active=!1}}},{key:"createDebugger",value:function(){this.graph=this.content.addComponent(G)}},{key:"createRealItem",value:function(){var e=K(this.itemPrefab);return this.content.addChild(e),e.getComponent(eu)}},{key:"loadScroller",value:function(e){this.payloads=e,this.reloadMaxRealItems(),this.createRealItems(),this.fakeItems=[];var t=this.content.position,n=t.x,i=t.z;this.content.setPosition(n,this.originalContentPosY,i),this.createFakeItems(e),this.isDebug&&this.createDebugger()}},{key:"reloadScroller",value:function(){var e=this.content.position.y,t=this.payloads;void 0!==this.payloads&&0!==this.payloads.length&&(this.loadScroller(t),this.scroller.scrollToTargetY(e),this.handleDiscreteScroll())}},{key:"createFakeItems",value:function(e){var t=this.isStartFromBottom?1:-1,n=t*this.itemHeight/2,i=e.length;this.toggleRealItems(i>0);for(var a=0;a<i;a++){var r=this.createFakeItem(e[a]),o=this.distanceBetweenItems+this.itemHeight,s=new F(0,n+(a*o+this.offsetBottom)*t,0);r.setPosition(s),r.setRealItem(this.realItems[a%this.maxRealItems]),this.fakeItems.push(r)}if(i<this.maxRealItems)for(var l=i;l<this.maxRealItems;l++)this.realItems[l].node.active=!1;var u=-1,c=i<this.maxRealItems-this.borderItems;u=c?this.offsetHeader:i*(this.itemHeight+this.distanceBetweenItems)+this.offsetHeader+this.offsetBottom,u=Math.max(u,0),this.scroller.initScroller({isStartFromBottom:this.isStartFromBottom,isAddedHeight:c,height:u}),this.refreshScroller()}},{key:"createFakeItem",value:function(e){
//! temporary
var t=new kl;return t.setIdx(e.idx),t}},{key:"updateFakeItems",value:function(e){for(var t=0;t<e.length;t++){this.fakeItems[t].setIdx(e[t].idx)}}},{key:"toggleRealItems",value:function(e){for(var t=0;t<this.maxRealItems;t++)this.realItems[t].node.active=e}},{key:"handleDiscreteScroll",value:function(){if(this.shouldUpdateItems){var e=this.getVisibleFakeItems();this.updateScrollItems(e),this.drawDebugLines()}}},{key:"refreshScroller",value:function(){this.handleDiscreteScroll()}},{key:"drawDebugLines",value:function(){if(this.graph){this.graph.clear();var e=this.getVisibleTopBorder(),t=this.getVisibleBottomBorder();this.graph.strokeColor.fromHEX("#FF0000"),this.graph.moveTo(-1e3,e),this.graph.lineTo(1e3,e),this.graph.stroke(),this.graph.strokeColor.fromHEX("#00FF00"),this.graph.moveTo(-1e3,t),this.graph.lineTo(1e3,t),this.graph.stroke()}}},{key:"getVisibleFakeItems",value:function(){var e,t=[],n=this.getVisibleTopBorder(),i=this.getVisibleBottomBorder(),a=d(this.fakeItems);try{for(a.s();!(e=a.n()).done;){var r=e.value,o=r.getPosition().y;o>n||o<i||t.push(r)}}catch(e){a.e(e)}finally{a.f()}return t}},{key:"updateScrollItems",value:function(e){var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.updateRealItem(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateRealItem",value:function(e){var t=e.getPosition(),n=e.getRealItem();n.node.active=e.getActive(),n.node.setPosition(t)}},{key:"getVisibleTopBorder",value:function(){var e=this.content.position.y,t=this.viewUITransform.contentSize.height,n=this.itemHeight+this.distanceBetweenItems;return Math.ceil(t/n)*n-e-this.navigationTopBorder}},{key:"getVisibleBottomBorder",value:function(){var e=this.content.position.y,t=this.viewUITransform.contentSize.height,n=this.itemHeight+this.distanceBetweenItems;return-e-Math.ceil(t/n)*n+this.viewUITransform.node.position.y+this.navigationBottomBorder}},{key:"moveToIdx",value:function(e){if(!(e<0||e>=this.fakeItems.length)){var t=(this.getVisibleTopBorder()+this.getVisibleBottomBorder())/2-this.fakeItems[e].getPosition().y;this.scroller.scrollWithOffset(t)}}},{key:"swapItems",value:function(e,t){if(!(e<0||e>=this.fakeItems.length||t<0||t>=this.fakeItems.length)){var n=this.fakeItems[e];this.fakeItems[e]=this.fakeItems[t],this.fakeItems[t]=n}}},{key:"getItemFits",value:function(){var e=this.viewUITransform.contentSize.height,t=this.itemHeight+this.distanceBetweenItems;return Math.floor(e/t)}},{key:"handleContinuousScroll",value:function(){}},{key:"debugScroller",value:function(){var e,t=d(this.fakeItems);try{for(t.s();!(e=t.n()).done;){var n=e.value;console.log("%c fakeItem: ","font-size:12px;background-color: #4b4b4b;color:#fff;",n.getIdx())}}catch(e){t.e(e)}finally{t.f()}}}]),l}(k)).prototype,"viewUITransform",[Cl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gl=e(zl.prototype,"itemPrefab",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hl=e(zl.prototype,"content",[Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wl=e(zl.prototype,"isVertical",[xl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Vl=e(zl.prototype,"isStartFromBottom",[Il],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),jl=e(zl.prototype,"maxRealItems",[Al],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),ql=e(zl.prototype,"borderItems",[Rl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Kl=e(zl.prototype,"distanceBetweenItems",[Pl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),Yl=e(zl.prototype,"itemHeight",[_l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Jl=e(zl.prototype,"offsetHeader",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Zl=e(zl.prototype,"offsetBottom",[Ol],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Xl=e(zl.prototype,"navigationTopBorder",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Ql=e(zl.prototype,"navigationBottomBorder",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),$l=e(zl.prototype,"isDebug",[Fl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ml=zl))||Ml);g._RF.pop(),g._RF.push({},"fdfbePPntRMqLXMEGCBFqh3","Scroller",void 0);var au,ru="scrolling-continuous",ou="scrolling-discrete";g._RF.pop(),g._RF.push({},"68995CireVLDZrYtmMDEjvI","SmoothScroller",void 0);var su,lu,uu,cu,hu,pu,du,fu,yu,vu,gu,mu,bu,Su,wu,ku,Tu=m.ccclass,Cu=1e-4,Eu=function(e){return e.SCROLL_ENDED="scroll-ended",e.SCROLLING="scrolling",e.SCROLL_ENG_WITH_THRESHOLD="scroll-ended-with-threshold",e}({});Tu("SmoothScroller")(au=function(e){t(u,e);var a,r=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).headerBorder=0,e.bottomHeader=1139999,e.lastTouchPos=new j,e.currentTouchPos=new j,e.bounceTween=null,e.prevContentPosY=0,e.prevContentPosY2=0,e}return o(u,[{key:"__preload",value:function(){this.initComponents()}},{key:"initComponents",value:function(){this.content&&(this.contentUITransform=this.content.getComponent(L),this.validateRequiredComponents())}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.node.on(A.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"update",value:function(e){p(h(u.prototype),"update",this).call(this,e),this.updateContent()}},{key:"updateContent",value:function(){this.canDiscreteUpdate()&&this.node.emit(ou),this.canContinuousUpdate()&&this.node.emit(ru)}},{key:"_handleMoveLogic",value:function(e){this._getLocalAxisAlignDelta(this._deltaPos,e),this._deltaAmount.add(this._deltaPos),this.updateDeltaPos()}},{key:"updateDeltaPos",value:function(){var e=this.getScrollOffset(),t=I.getVisibleSize().height,n=.1*-t,i=this.contentUITransform.height-.9*t,a=this._deltaPos.y;if(e.y<n&&a<0){var r=this._deltaPos,o=r.x,s=r.z;this._deltaAmount.set(o,0,s)}if(e.y>i&&a>0){var l=Math.min(0,this._deltaPos.y+30),u=this._deltaPos,c=u.x,h=u.z;this._deltaAmount.set(c,l,h)}}},{key:"canDiscreteUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY)<=200)&&(this.prevContentPosY=e,!0)}},{key:"canContinuousUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY2)<=10)&&(this.prevContentPosY2=e,!0)}},{key:"_onMouseWheel",value:function(e,t){var n=this;if(this.content){var i=-e.getScrollY(),a=this.getMaxScrollOffset(),r=this.getScrollOffset();r.y=Y.clamp(r.y+2*i,0,a.y);var o=this.content.position,s=o.x,l=o.y;if(l<=this.headerBorder&&r.y<=0){if(null!=this.bounceTween)return;this.bounceTween=B(this.content).to(.1,{position:new F(s,l-10)},{easing:"sineOut"}).call((function(){n.resetBounceTween()})).start()}else if(l>=this.bottomHeader&&r.y>=a.y){if(null!=this.bounceTween)return;this.bounceTween=B(this.content).to(.1,{position:new F(s,l+10)},{easing:"sineOut"}).call((function(){n.resetBounceTween()})).start()}this.scrollToOffset(r,3.6)}}},{key:"resetBounceTween",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.waitTweenAsync(.3);case 2:this.bounceTween=null;case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onTouchMove",value:function(e){this.content&&(this.currentTouchPos.set(e.getLocationX(),e.getLocationY()),this.lastTouchPos.set(e.getLocationX(),e.getLocationY()))}},{key:"_processAutoScrolling",value:function(e){var t=this._isNecessaryAutoScrollBrake(),n=t?.05:1;this._autoScrollAccumulatedTime+=e*(1/n);var i,a=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(i=a,a=1-Math.pow(2,-30*i));var r=this._autoScrollTargetDelta.clone();r.multiplyScalar(a);var o=this._autoScrollStartPosition.clone();o.add(r);var s=Math.abs(a-1)<=Cu;if(Math.abs(a-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent(Eu.SCROLL_ENG_WITH_THRESHOLD),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var l=o.clone();l.subtract(this._autoScrollBrakingStartPosition),t&&l.multiplyScalar(n),o.set(this._autoScrollBrakingStartPosition),o.add(l)}else{var u=o.clone();u.subtract(this.getContentPosition());var c=this._getHowMuchOutOfBoundary(u);c.equals(F.ZERO,Cu)||(o.add(c),s=!0)}s&&(this._autoScrolling=!1);var h=o.clone();h.subtract(this.getContentPosition()),this._clampDelta(h),this._moveContent(h,s),this._dispatchEvent(Eu.SCROLLING),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent(Eu.SCROLL_ENDED))}}]),u}(J));g._RF.pop(),g._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var Lu,xu,Iu,Au,Ru,Pu,_u,Nu,Ou,Bu,Du,Fu=m.ccclass,Mu=m.property,zu=m.requireComponent,Uu=codex.analytics,Gu=(su=Fu("SwitchButton"),lu=zu([N]),uu=Mu(R),cu=Mu(A),hu=Mu(A),pu=Mu(R),du=Mu(N),fu=Mu({visible:function(){return this.useSound},type:De}),su(yu=lu((gu=e((vu=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"enable",gu,r(e)),a(e,"nodeOn",mu,r(e)),a(e,"nodeOff",bu,r(e)),a(e,"useSound",Su,r(e)),a(e,"button",wu,r(e)),a(e,"soundKey",ku,r(e)),e}return o(l,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"switch",value:function(){if(!this.node.active)return!1;if(Uu.event(Ludex.Plugins.Analytics.Events.BUTTON_CLICK,{enable:!this.enable,button_name:this.node.name,screen_name:We.getCurrentPage()}),this.useSound&&this.soundKey){var e=Fe[this.soundKey];e&&Me.playSound(e)}return this.updateStatus(!this.enable)}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e,e}}]),l}(k)).prototype,"enable",[uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),mu=e(vu.prototype,"nodeOn",[cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bu=e(vu.prototype,"nodeOff",[hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=e(vu.prototype,"useSound",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),wu=e(vu.prototype,"button",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ku=e(vu.prototype,"soundKey",[fu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return De[ze.BUTTON_CLICK]}}),yu=vu))||yu)||yu);g._RF.pop(),g._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var Hu,Wu,Vu,ju,qu,Ku,Yu,Ju,Zu,Xu,Qu,$u,ec,tc,nc,ic,ac,rc,oc,sc,lc,uc,cc,hc,pc,dc,fc,yc,vc,gc,mc,bc,Sc,wc,kc,Tc,Cc,Ec,Lc,xc,Ic,Ac,Rc,Pc=m.ccclass,_c=m.property,Nc=m.executeInEditMode,Oc=m.requireComponent;Lu=Pc("TapperedProgressBar"),xu=Oc(P),Iu=_c({type:P,displayName:"Fill opacity"}),Au=_c({type:E,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),Ru=_c({type:E,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),Pu=_c({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),Lu(_u=Nc(_u=xu((Ou=e((Nu=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"uiOpacity",Ou,r(e)),a(e,"leftCap",Bu,r(e)),a(e,"rightCap",Du,r(e)),e}return o(l,[{key:"progress",get:function(){return p(h(l.prototype),"progress",this)},set:function(e){c(h(l.prototype),"progress",e,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity)if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var e=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=e}}},{key:"start",value:function(){this.updateAppearance()}}]),l}(H)).prototype,"uiOpacity",[Iu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bu=e(Nu.prototype,"leftCap",[Au],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Du=e(Nu.prototype,"rightCap",[Ru],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(Nu.prototype,"progress",[Pu],Object.getOwnPropertyDescriptor(Nu.prototype,"progress"),Nu.prototype),_u=Nu))||_u)||_u);g._RF.pop(),g._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var Bc=m.ccclass,Dc=m.property,Fc=m.executeInEditMode,Mc=m.disallowMultiple,zc=Ludex,Uc=zc.Utils,Gc=Uc.Signal,Hc=(Uc.Function,Uc.Array),Wc=zc.Events,Vc=codex,jc=Vc.language,qc=Vc.event,Kc=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});Z(Kc);var Yc,Jc,Zc,Xc,Qc,$c,eh,th,nh,ih,ah,rh,oh,sh,lh,uh,ch,hh,ph,dh,fh,yh="localize-params-updated",vh=(Hu=Bc("LocalizeParams"),Wu=Dc({visible:!1}),Vu=Dc(S),Hu((Ku=e((qu=function(){function e(){i(this,e),a(this,"_text",Ku,this)}return o(e,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,x.emit(yh,{text:e,param:this})}}]),e}()).prototype,"_text",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(qu.prototype,"text",[Vu],Object.getOwnPropertyDescriptor(qu.prototype,"text"),qu.prototype),ju=qu))||ju),gh=(Yu=Bc("Localize"),Ju=Fc(!0),Zu=Dc({visible:!1}),Xu=Dc({type:S,visible:function(){return this.l10nType===Kc.Texture}}),Qu=Dc({visible:!1}),$u=Dc({type:W(Kc)}),ec=Dc({type:X,visible:function(){return this.l10nType===Kc.Text}}),tc=Dc({visible:function(){return this.l10nType===Kc.Text}}),nc=Dc({type:[vh],visible:function(){return this.l10nType===Kc.Text}}),ic=Dc({type:E,visible:function(){return this.l10nType===Kc.Texture}}),ac=Dc({visible:function(){return this.l10nType===Kc.Texture}}),rc=Dc({visible:!1}),oc=Dc({type:S}),sc=Dc({visible:!1}),lc=Dc({type:W({FNT:"fnt",TTF:"ttf"}),visible:function(){return this.l10nType===Kc.Text}}),uc=Re.onlyRunInLifeCycleAsync,cc=Re.onlyRunInLifeCycleAsync,hc=Re.onlyRunInLifeCycleAsync,pc=Re.onlyRunInLifeCycleAsync,dc=Re.onlyRunInLifeCycle,fc=Re.onlyRunInLifeCycleAsync,yc=Re.onlyRunInLifeCycleAsync,vc=Re.onlyRunInLifeCycleAsync,gc=Re.onlyRunInLifeCycleAsync,mc=Re.onlyRunInLifeCycle,bc=Re.onlyRunInLifeCycleAsync,Yu(Sc=Mc(Sc=Ju((kc=e((wc=function(e){t(k,e);var u,c,h,p,d,f,y,v,g,m,b,S,w=n(k);function k(){var e;i(this,k);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=w.call.apply(w,[this].concat(n))).localized=!1,a(e,"_defaultLocale",kc,r(e)),a(e,"_l10nType",Tc,r(e)),a(e,"label",Cc,r(e)),a(e,"updateFont",Ec,r(e)),a(e,"params",Lc,r(e)),a(e,"sprite",xc,r(e)),a(e,"packable",Ic,r(e)),a(e,"_key",Ac,r(e)),a(e,"_fontType",Rc,r(e)),e.updateSignalController=new Gc.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;Hc.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return o(k,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return Hc.has(qe,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(qe.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===Kc.Texture&&(this.label=void 0,this.params=[]),e===Kc.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"fontType",get:function(){return this._fontType},set:function(e){"fnt"===e||"ttf"===e?(this._fontType=e,this.updateLocalization()):console.warn("Font type ".concat(e," is not supported. Supported types are 'fnt' and 'ttf'."))}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new vh);for(var t=0,n=this.params.length;t<n;t++){var i,a=this.params[t];a.text=null!==(i=e[t])&&void 0!==i?i:a.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once(_e.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===Kc.Text&&jc.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===Kc.Texture&&jc.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent(),this.updateLocalizationComp(!0)}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){qc.on(Wc.LANGUAGE_CHANGED,this.updateLocalization),x.on(yh,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){qc.off(Wc.LANGUAGE_CHANGED,this.updateLocalization),x.off(yh,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(S=s(l().mark((function e(){var t,n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]&&a[0],e.next=4;break;case 4:if(this.enabledInHierarchy){e.next=6;break}return e.abrupt("return");case 6:if(void 0!==this.key){e.next=8;break}return e.abrupt("return");case 8:if(n=this.updateSignalController.renew(),e.prev=9,this.localized=!1,!this.isTextKey(this.key)){e.next=16;break}return e.next=14,this.updateTextLocalization(this.key,n);case 14:e.next=25;break;case 16:if(!this.isTextureKey(this.key)){e.next=24;break}if(i=jc.getCurrentLocale(),t&&i===this.defaultLocale){e.next=22;break}return e.next=22,this.updateTextureLocalization(this.key,i,n);case 22:e.next=25;break;case 24:throw new Error("Key ".concat(this.key," not found in locales"));case 25:if(!n.aborted){e.next=27;break}return e.abrupt("return");case 27:this.localized=!0,x.emit(_e.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit(_e.LOCALIZE_APPLIED,{localize:this,key:this.key}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(9),console.warn(e.t0);case 35:case"end":return e.stop()}}),e,this,[[9,32]])}))),function(){return S.apply(this,arguments)})},{key:"updateTextLocalization",value:(b=s(l().mark((function e(t,n){var i,a,r,o,s,u=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=jc.getCurrentLocale(),r=jc.getText(t,this.params.map((function(e){return e.text})),a),void 0!==(o=this.label)){e.next=5;break}throw new Error("Text localize component <".concat(this.node.name,"> has no label"));case 5:if(null===(i=n.wrap((function(){return u.setText(o,r)})))||void 0===i||i(),!this.updateFont){e.next=9;break}return e.next=9,null===(s=n.wrap((function(){return u.setTextFont(o,a,n)})))||void 0===s?void 0:s();case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"setText",value:(m=s(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.string=n;case 1:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"setTextFont",value:(g=s(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.setTextFontRuntime(t,n,i);case 3:e.next=7;break;case 5:return e.next=7,this.setTextFontEditor(t,n,i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"setTextFontRuntime",value:(v=s(l().mark((function e(t,n,i){var a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe.loadFontAsync(n,this.fontType);case 2:if(a=e.sent,!i.aborted){e.next=5;break}return e.abrupt("return");case 5:null!==a&&this.setLabelFontInLifeCycle(t,a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(y=s(l().mark((function e(t,n,i){var a,r,o,s,u,c,h=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestFontUuid(n);case 2:if(null!==(o=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,null===(a=i.wrap((function(){return h.requestNodeInfo(t.node.uuid)})))||void 0===a?void 0:a();case 7:if(void 0!==(s=e.sent)){e.next=10;break}return e.abrupt("return");case 10:return u=Hc.searchIndex(s.__comps__,(function(e){return"cc.Label"===e.type})),c="__comps__.".concat(u,".font"),e.next=14,null===(r=i.wrap((function(){return h.requestUpdateLabelFont(t.node.uuid,c,o)})))||void 0===r?void 0:r();case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"requestFontUuid",value:(f=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.fontType,e.next="fnt"===e.t0?3:"ttf"===e.t0?6:9;break;case 3:return e.next=5,Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Je[t]));case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Ye[t]));case 8:return e.abrupt("return",e.sent);case 9:throw new Error("Unsupported font type: ".concat(this.fontType));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(d=s(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:n,dump:{type:"cc.Font",value:{uuid:i}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"updateTextureLocalization",value:(p=s(l().mark((function e(t,n,i){var a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sprite){e.next=2;break}throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));case 2:return a="".concat(Ze.LOCALIZE_PREFIX).concat(n,"/").concat(jc.getTexture(t)),e.next=6,this.setSpriteRuntime(this.sprite,a,i);case 6:e.next=10;break;case 8:return e.next=10,this.setSpriteEditor(this.sprite,a,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"setSpriteRuntime",value:(h=s(l().mark((function e(t,n,i){var a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe.loadSpriteFrameAsync("".concat(n,"/spriteFrame"),this.packable);case 2:if(a=e.sent,!i.aborted){e.next=5;break}return e.abrupt("return");case 5:if(null!==a){e.next=8;break}return console.warn("Sprite not found by path: ".concat(n)),e.abrupt("return");case 8:this.setSprite(t,a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(c=s(l().mark((function e(t,n,i){var a,r,o,s,u,c,h,p,d,f=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestSpriteFrameInfo(n);case 2:if(0!==(o=e.sent).length){e.next=6;break}return console.error("Sprite not found by path: ".concat(n)),e.abrupt("return");case 6:if(!(o.length>1)){e.next=11;break}return s=o.slice(0,5).map((function(e){return e.path})),u="".concat(s.join(",")).concat(s.length<o.length?"...":""),console.warn("Ambiguous sprite's path: ".concat(n,". Found ").concat(u)),e.abrupt("return");case 11:return e.next=13,null===(a=i.wrap((function(){return f.requestNodeInfo(t.node.uuid)})))||void 0===a?void 0:a();case 13:if(void 0!==(c=e.sent)){e.next=16;break}return e.abrupt("return");case 16:return h=o[0].uuid,p=Hc.searchIndex(c.__comps__,(function(e){return"cc.Sprite"===e.type})),d="__comps__.".concat(p,".spriteFrame"),e.next=21,null===(r=i.wrap((function(){return f.requestUpdateSpriteSpriteFrame(t.node.uuid,d,h)})))||void 0===r?void 0:r();case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(u=s(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:n,dump:{type:"cc.SpriteFrame",value:{uuid:i}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}]),k}(k)).prototype,"_defaultLocale",[Zu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),e(wc.prototype,"defaultLocale",[Xu],Object.getOwnPropertyDescriptor(wc.prototype,"defaultLocale"),wc.prototype),Tc=e(wc.prototype,"_l10nType",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Kc.Text}}),e(wc.prototype,"l10nType",[$u],Object.getOwnPropertyDescriptor(wc.prototype,"l10nType"),wc.prototype),Cc=e(wc.prototype,"label",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=e(wc.prototype,"updateFont",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Lc=e(wc.prototype,"params",[nc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xc=e(wc.prototype,"sprite",[ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic=e(wc.prototype,"packable",[ac],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ac=e(wc.prototype,"_key",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(wc.prototype,"key",[oc],Object.getOwnPropertyDescriptor(wc.prototype,"key"),wc.prototype),Rc=e(wc.prototype,"_fontType",[sc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ttf"}}),e(wc.prototype,"fontType",[lc],Object.getOwnPropertyDescriptor(wc.prototype,"fontType"),wc.prototype),e(wc.prototype,"updateTextLocalization",[uc],Object.getOwnPropertyDescriptor(wc.prototype,"updateTextLocalization"),wc.prototype),e(wc.prototype,"setText",[cc],Object.getOwnPropertyDescriptor(wc.prototype,"setText"),wc.prototype),e(wc.prototype,"setTextFont",[hc],Object.getOwnPropertyDescriptor(wc.prototype,"setTextFont"),wc.prototype),e(wc.prototype,"setTextFontRuntime",[pc],Object.getOwnPropertyDescriptor(wc.prototype,"setTextFontRuntime"),wc.prototype),e(wc.prototype,"setLabelFontInLifeCycle",[dc],Object.getOwnPropertyDescriptor(wc.prototype,"setLabelFontInLifeCycle"),wc.prototype),e(wc.prototype,"setTextFontEditor",[fc],Object.getOwnPropertyDescriptor(wc.prototype,"setTextFontEditor"),wc.prototype),e(wc.prototype,"requestUpdateLabelFont",[yc],Object.getOwnPropertyDescriptor(wc.prototype,"requestUpdateLabelFont"),wc.prototype),e(wc.prototype,"updateTextureLocalization",[vc],Object.getOwnPropertyDescriptor(wc.prototype,"updateTextureLocalization"),wc.prototype),e(wc.prototype,"setSpriteRuntime",[gc],Object.getOwnPropertyDescriptor(wc.prototype,"setSpriteRuntime"),wc.prototype),e(wc.prototype,"setSprite",[mc],Object.getOwnPropertyDescriptor(wc.prototype,"setSprite"),wc.prototype),e(wc.prototype,"setSpriteEditor",[bc],Object.getOwnPropertyDescriptor(wc.prototype,"setSpriteEditor"),wc.prototype),Sc=wc))||Sc)||Sc)||Sc);g._RF.pop(),g._RF.push({},"b3fd8kSJpZMS47Z+G6ZUMJb","LocalizePreloader",void 0);var mh,bh,Sh,wh,kh,Th,Ch,Eh,Lh,xh,Ih,Ah,Rh,Ph,_h,Nh,Oh=m.ccclass,Bh=m.property,Dh=Ludex,Fh=Dh.Utils,Mh=Fh.Array,zh=Fh.Valid,Uh=Dh.Events,Gh=codex,Hh=Gh.event,Wh=Gh.language,Vh=(Yc=Oh("LocalizeTextureKey"),Jc=Bh({visible:!1}),Zc=Bh(S),Yc(($c=e((Qc=function(){function e(){i(this,e),a(this,"_key",$c,this)}return o(e,[{key:"key",get:function(){return this._key},set:function(e){Wh.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),e}()).prototype,"_key",[Jc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(Qc.prototype,"key",[Zc],Object.getOwnPropertyDescriptor(Qc.prototype,"key"),Qc.prototype),Xc=Qc))||Xc),jh=(eh=Oh("SupportedLocaleKey"),th=Bh({visible:!1}),nh=Bh(S),eh((rh=e((ah=function(){function e(){i(this,e),a(this,"_key",rh,this)}return o(e,[{key:"key",get:function(){return this._key},set:function(e){Mh.has(qe,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(qe.join(", ")))}}]),e}()).prototype,"_key",[th],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(ah.prototype,"key",[nh],Object.getOwnPropertyDescriptor(ah.prototype,"key"),ah.prototype),ih=ah))||ih);oh=Oh("LocalizePreloader"),sh=Bh([Vh]),lh=Bh({type:jh,tooltip:"Preload only for these locales"}),oh((hh=e((ch=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"keys",hh,r(e)),a(e,"locales",ph,r(e)),a(e,"preloadOnLanguageChange",dh,r(e)),a(e,"packable",fh,r(e)),e.lastLocale="",e.preloadLocalize=function(){return e.preloadTextures()},e}return o(l,[{key:"__preload",value:function(){this.lastLocale=Wh.getCurrentLocale(),this.preloadTextures()}},{key:"onEnable",value:function(){if(this.preloadOnLanguageChange){this.listenEvents();var e=Wh.getCurrentLocale();e!==this.lastLocale&&(this.lastLocale=e,this.preloadTextures())}}},{key:"onDisable",value:function(){this.preloadOnLanguageChange&&this.unlistenEvents()}},{key:"listenEvents",value:function(){Hh.on(Uh.LANGUAGE_CHANGED,this.preloadLocalize)}},{key:"unlistenEvents",value:function(){Hh.off(Uh.LANGUAGE_CHANGED,this.preloadLocalize)}},{key:"preloadTextures",value:function(){var e=Wh.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(Mh.has(t,e)){var n,i=[],a=d(this.keys);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(!1!==Wh.hasTextureKey(r.key)){var o=Wh.getTexture(r.key),s="".concat(Ze.LOCALIZE_PREFIX).concat(e,"/").concat(o,"/spriteFrame");i.push(s)}}}catch(e){a.e(e)}finally{a.f()}Pe.loadSpriteFramesAsync(i,this.packable)}else zh.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),l}(k)).prototype,"keys",[sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ph=e(ch.prototype,"locales",[lh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),dh=e(ch.prototype,"preloadOnLanguageChange",[Bh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),fh=e(ch.prototype,"packable",[Bh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),uh=ch));g._RF.pop(),g._RF.push({},"173031IssdPd61TGAHBxghZ","LocalizedLayout",void 0);var qh,Kh,Yh,Jh,Zh,Xh,Qh,$h,ep,tp,np,ip,ap,rp,op,sp,lp,up,cp,hp,pp,dp,fp,yp,vp,gp,mp,bp,Sp=m.ccclass,wp=m.property,kp=m.executeInEditMode,Tp=m.disallowMultiple,Cp=m.requireComponent;mh=Sp("LocalizedLayout"),bh=kp(!0),Sh=Cp(L),wh=wp(gh),kh=Re.required(),Th=wp(L),Ch=wp({visible:!1}),Eh=wp({visible:!1}),Lh=wp({type:V,group:"Padding"}),xh=wp({type:V,group:"Padding"}),mh(Ih=Tp(Ih=bh(Ih=Sh((Rh=e((Ah=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"label",Rh,r(e)),a(e,"layout",Ph,r(e)),a(e,"_horizontal",_h,r(e)),a(e,"_vertical",Nh,r(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(L))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,a=e.node.getComponentsInChildren(z),r=d(a);try{for(r.s();!(i=r.n()).done;){i.value.updateAlignment()}}catch(e){r.e(e)}finally{r.f()}}}},e}return o(l,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(L),Re.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on(_e.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off(_e.LOCALIZE_APPLIED,this.updateContentSize)}}]),l}(k)).prototype,"label",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ph=e(Ah.prototype,"layout",[kh,Th],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_h=e(Ah.prototype,"_horizontal",[Ch],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Nh=e(Ah.prototype,"_vertical",[Eh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Ah.prototype,"horizontal",[Lh],Object.getOwnPropertyDescriptor(Ah.prototype,"horizontal"),Ah.prototype),e(Ah.prototype,"vertical",[xh],Object.getOwnPropertyDescriptor(Ah.prototype,"vertical"),Ah.prototype),Ih=Ah))||Ih)||Ih)||Ih);g._RF.pop(),g._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var Ep,Lp,xp,Ip,Ap,Rp,Pp,_p,Np,Op,Bp,Dp,Fp,Mp,zp,Up,Gp,Hp,Wp,Vp,jp=m.ccclass,qp=m.executionOrder,Kp=m.property,Yp=Ludex.Utils,Jp=Yp.Decorator,Zp=Yp.Array,Xp="Batch By Name",Qp="Batch Label",$p="Batch Sprite";qh=jp("BatchNodes"),Kh=qp(99999),Yh=Kp({group:{name:Xp}}),Jh=Kp({type:[w],group:{name:Xp}}),Zh=Kp({type:[S],group:{name:Xp}}),Xh=Kp({group:{name:Qp}}),Qh=Kp({group:{name:Qp}}),$h=Kp({group:{name:Qp}}),ep=Kp({group:{name:$p}}),tp=Kp({group:{name:$p}}),np=Kp({readonly:!0}),ip=Kp({readonly:!0}),ap=Kp({readonly:!0}),rp=Jp.debounce(1e3),qh(op=Kh((lp=e((sp=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"batchByName",lp,r(e)),a(e,"depthNames",up,r(e)),a(e,"listName",cp,r(e)),a(e,"batchLabel",hp,r(e)),a(e,"depthLabel",pp,r(e)),a(e,"typeLabel",dp,r(e)),a(e,"batchSprite",fp,r(e)),a(e,"depthSprite",yp,r(e)),a(e,"batchAllNodes",vp,r(e)),a(e,"batchDepth",gp,r(e)),a(e,"checkOverlap",mp,r(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,a(e,"handleNodeChange",bp,r(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return o(l,[{key:"__preload",value:function(){this.enabled&&(C.on(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.on(Q.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){C.off(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.off(Q.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(C.on(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.on(Q.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(A.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),C.off(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.off(Q.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,a=i.depthNames[t];void 0!==a?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(a):console.warn("BatchNodes: depth is undefined",e,t,a)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new A("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=d(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var a=new A(i);a.active=!0,this.batchNode[i]=a,e.addChild(a)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new A("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new A("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(f(this.labelChildren),f(this.spriteChildren)),n=this.nameChildren,i=d(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.parent&&(this.handleActiveChange(a.node),this.originalParents[a.uuid]=a.node.parent)}}catch(e){i.e(e)}finally{i.f()}var r,o=d(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.parent&&(this.handleActiveChange(s),this.originalParents[s.uuid]=s.parent)}}catch(e){o.e(e)}finally{o.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=d(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.saveLabelChildren(a),this.saveSpriteChildren(a),this.saveNodeChildrenByName(a),this.saveNodeChildrenByType(a)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(X),i={none:X.CacheMode.NONE,char:X.CacheMode.CHAR,bitmap:X.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,f(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(E);0!==n.length&&(t=this.spriteChildren).push.apply(t,f(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=d(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;Zp.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(k);if((t=this.allChildren).push.apply(t,f(i)),!(this.batchDepth<1||n>=this.batchDepth)){var a,r=d(this.allChildren);try{for(r.s();!(a=r.n()).done;){var o=a.value;this.saveNodeChildrenByType(o.node,this.batchDepth)}}catch(e){r.e(e)}finally{r.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=$.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=d(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var a,r=d(this.spriteChildren);try{for(r.s();!(a=r.n()).done;){t(a.value,this.batchNode.sprite)}}catch(e){r.e(e)}finally{r.f()}var o,s=d(this.allChildren);try{for(s.s();!(o=s.n()).done;){t(o.value,this.batchNode.node)}}catch(e){s.e(e)}finally{s.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var l,u=d(this.nameChildren);try{for(u.s();!(l=u.n()).done;){var c=l.value;if(c.isValid&&c.activeInHierarchy&&c.isTransformDirty()){var h=c.getComponent(P);if(!(h&&h.opacity<1||Zp.has(n,c.name))){var p=this.batchNode[c.name];p&&(c.isChildOf(p)||(c.setParent(p,!0),c.layer=$.Enum.UI_2D))}}}}catch(e){u.e(e)}finally{u.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(f(this.labelChildren),f(this.spriteChildren));if(e.length>0){var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.originalParents[i.uuid];a&&(i.node.isChildOf(a)||i.node.setParent(a,!0))}}catch(e){n.e(e)}finally{n.f()}}var r,o=d(this.nameChildren);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=this.originalParents[s.uuid];l&&(s.isChildOf(l)||s.setParent(l,!0))}}catch(e){o.e(e)}finally{o.f()}}}]),l}(k)).prototype,"batchByName",[Yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),up=e(sp.prototype,"depthNames",[Jh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),cp=e(sp.prototype,"listName",[Zh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hp=e(sp.prototype,"batchLabel",[Xh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pp=e(sp.prototype,"depthLabel",[Qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),dp=e(sp.prototype,"typeLabel",[$h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),fp=e(sp.prototype,"batchSprite",[ep],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yp=e(sp.prototype,"depthSprite",[tp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),vp=e(sp.prototype,"batchAllNodes",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gp=e(sp.prototype,"batchDepth",[ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),mp=e(sp.prototype,"checkOverlap",[ap],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bp=e(sp.prototype,"handleNodeChange",[rp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),op=sp))||op);g._RF.pop(),g._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var ed,td=m.ccclass,nd=m.executionOrder,id=m.property,ad=Ludex.Utils,rd=ad.Array,od=ad.Object;Ep=td("BatchNodesV2"),Lp=nd(99999),xp=id({group:"Batch Settings"}),Ip=id({type:[S],group:"Batch Settings",visible:function(){return this.batchByName}}),Ap=id({type:[w],group:"Batch Settings",visible:function(){return this.batchByName}}),Rp=id({group:"Label Settings"}),Pp=id({group:"Label Settings",visible:function(){return this.batchLabel}}),_p=id({group:"Label Settings",visible:function(){return this.batchLabel}}),Np=id({group:"Sprite Settings"}),Op=id({group:"Sprite Settings",visible:function(){return this.batchSprite}}),Ep(Bp=Lp((Fp=e((Dp=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"batchByName",Fp,r(e)),a(e,"listName",Mp,r(e)),a(e,"depthNames",zp,r(e)),a(e,"batchLabel",Up,r(e)),a(e,"typeLabel",Gp,r(e)),a(e,"depthLabel",Hp,r(e)),a(e,"batchSprite",Wp,r(e)),a(e,"depthSprite",Vp,r(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return o(l,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(X);t&&("all"===this.typeLabel?t.cacheMode===X.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===X.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(E)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:X.CacheMode.NONE,char:X.CacheMode.CHAR,bitmap:X.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,a={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(a)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var r=0;r<this.listName.length;r++){var o=this.listName[r];if(o){var s=this.depthNames[r]||0,l=this.batchNodes[o];l&&l.setSiblingIndex(s)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=$.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=od.vals(this.batchNodes);return rd.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],a=0;a<i.length;a++){var r=i[a];r&&t(r)}else for(var o=0;o<this.labelNodes.length;o++){var s=this.labelNodes[o];s&&t(s)}if(this.batchSprite)for(var l=0;l<this.spriteNodes.length;l++){var u=this.spriteNodes[l];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var h=this.namedNodes[c];if(h)for(var p=0;p<h.length;p++){var d=h[p];d&&t(d)}}}},{key:"setupEventListeners",value:function(){C.on(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.on(Q.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){C.off(Q.EVENT_AFTER_UPDATE,this.onAfterUpdate),C.off(Q.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new A("BatchLabel_".concat(n));i.layer=$.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var a=new A("BatchLabel");a.layer=$.Enum.UI_2D,this.node.addChild(a),this.batchNodes.label=a}if(this.batchSprite){var r=new A("BatchSprite");r.layer=$.Enum.UI_2D,this.node.addChild(r),this.batchNodes.sprite=r}if(this.batchByName)for(var o=0;o<this.listName.length;o++){var s=this.listName[o];if(s){var l=new A("Batch_".concat(s));l.layer=$.Enum.UI_2D,this.node.addChild(l),this.batchNodes[s]=l,this.namedNodes[s]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),l}(k)).prototype,"batchByName",[xp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Mp=e(Dp.prototype,"listName",[Ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zp=e(Dp.prototype,"depthNames",[Ap],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Up=e(Dp.prototype,"batchLabel",[Rp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Gp=e(Dp.prototype,"typeLabel",[Pp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Hp=e(Dp.prototype,"depthLabel",[_p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Wp=e(Dp.prototype,"batchSprite",[Np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Vp=e(Dp.prototype,"depthSprite",[Op],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Bp=Dp))||Bp);g._RF.pop(),g._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var sd=m.ccclass,ld=Ludex.Utils,ud=codex.player;sd("Vibrate")(ed=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!ld.Browser.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!ud.getPlayerSetting("vibrate")}}]),r}(k));g._RF.pop(),g._RF.push({},"2521azdoHNFz7dpyh+MzNfr","WideframeConfigs",void 0),g._RF.pop(),g._RF.push({},"864477XgItAYpfGFIFfuHXg","FacebookConfigCustom",void 0),g._RF.pop(),g._RF.push({},"cadc9dNvDZNYJa5Col5DL0Q","MSGamesConfigCustom",void 0),g._RF.pop(),g._RF.push({},"2f96bZk1+RBL67UfNH3X1fy","BadgeOffset",void 0);var cd={DailyBadgeOffset:{1:{x:-9.5,y:42.5},2:{x:-3,y:39.5},3:{x:5,y:43},4:{x:-2,y:46},5:{x:-2,y:40.5},6:{x:3,y:44},7:{x:-1.5,y:43},8:{x:.5,y:47},9:{x:0,y:53.5},10:{x:-2.5,y:40.5},11:{x:-2.5,y:48},12:{x:-10.5,y:53}},JourneyBadgeOffset:{}};g._RF.pop(),g._RF.push({},"fa21371uJFDkpkh4CNcbPYr","SocialConfig",void 0);var hd={DEFAULT:["DEFAULT"],GROUP_2:["ID","TL"],GROUP_3:["US","BR","MX","CA","FR","IT","UK","AU"]},pd={DEFAULT:{CreatePlayerTournament:{Enabled:!0,Success:{Count:1,ResetTime:302400},Failed:{Count:1,ResetTime:216e3},MinLevelInterval:6,MinInterval:600,MaxShowPerSession:1,LevelStart:3,MaxLevel:-1,ShowPosition:["COMPLETE_LEVEL"],Priority:3},PlayWithFriend:{Enabled:!0,Success:{Count:2,ResetTime:57600},Failed:{Count:1,ResetTime:86400},MinLevelInterval:6,MinInterval:600,MaxShowPerSession:2,LevelStart:12,MaxLevel:75,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:2},JoinGlobalTournament:{Enabled:!0,Success:{Count:1,ResetTime:172800},Failed:{Count:1,ResetTime:259200},MinLevelInterval:6,MinInterval:600,MaxShowPerSession:1,LevelStart:12,MaxLevel:100,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:1},MinPopupInterval:600},GROUP_2:{CreatePlayerTournament:{Enabled:!0,Success:{Count:1,ResetTime:302400},Failed:{Count:1,ResetTime:216e3},MinLevelInterval:8,MinInterval:800,MaxShowPerSession:1,LevelStart:3,MaxLevel:-1,ShowPosition:["COMPLETE_LEVEL"],Priority:3},PlayWithFriend:{Enabled:!0,Success:{Count:2,ResetTime:57600},Failed:{Count:1,ResetTime:86400},MinLevelInterval:8,MinInterval:800,MaxShowPerSession:2,LevelStart:12,MaxLevel:75,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:2},JoinGlobalTournament:{Enabled:!0,Success:{Count:1,ResetTime:172800},Failed:{Count:1,ResetTime:259200},MinLevelInterval:8,MinInterval:800,MaxShowPerSession:1,LevelStart:12,MaxLevel:100,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:1},MinPopupInterval:800},GROUP_3:{CreatePlayerTournament:{Enabled:!0,Success:{Count:1,ResetTime:345600},Failed:{Count:1,ResetTime:259200},MinLevelInterval:10,MinInterval:1e3,MaxShowPerSession:1,LevelStart:3,MaxLevel:-1,ShowPosition:["COMPLETE_LEVEL"],Priority:3},PlayWithFriend:{Enabled:!0,Success:{Count:2,ResetTime:86400},Failed:{Count:1,ResetTime:129600},MinLevelInterval:10,MinInterval:1e3,MaxShowPerSession:2,LevelStart:12,MaxLevel:50,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:2},JoinGlobalTournament:{Enabled:!0,Success:{Count:1,ResetTime:259200},Failed:{Count:1,ResetTime:345600},MinLevelInterval:10,MinInterval:1e3,MaxShowPerSession:1,LevelStart:12,MaxLevel:75,ShowPosition:["NEXT_LEVEL_BUTTON"],Priority:1},MinPopupInterval:1e3}};g._RF.pop(),g._RF.push({},"f2134AVhktCQLHh8jp96V/y","VibrateStyle",void 0);var dd="normal";g._RF.pop(),g._RF.push({},"d6a460y/N5KD4HGvY1CxodW","AlignTile",void 0);var fd,yd,vd=-10,gd=-8,md=190,bd=211/171,Sd=16,wd=16;g._RF.pop(),g._RF.push({},"e218cFvNc1Afa7J5ohWJnaz","InputHandler",void 0);var kd=(0,m.ccclass)("InputHandler")(((yd=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).isDragging=!1,e.isTouching=!1,e.touchStartPosition=null,e.touchStartOffset=null,e}return o(r,[{key:"__preload",value:function(){this.tile=this.getComponent($f),this.uiTransform=this.getComponent(L),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.enableInteraction()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){this.disableInteraction()}},{key:"enableInteraction",value:function(){this.node.on(A.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(A.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(A.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(A.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}},{key:"disableInteraction",value:function(){this.node.off(A.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(A.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(A.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(A.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.isDragging=!1,this.isTouching=!1}},{key:"onTouchStart",value:function(e){this.checkIsChoosingOrAlreadyState()&&(this.isTouching=!0,this.touchStartPosition=this.getTouchPosition(e),this.touchStartOffset=this.getTouchOffset(this.touchStartPosition),this.tile.isUncovered||this.tile.handleTileCoveredClicked())}},{key:"onTouchMove",value:function(e){if(this.isTouching&&this.tile.isUncovered){var t=this.getTouchPosition(e);if(!this.isDragging){if(t.clone().subtract(this.touchStartPosition).length()<r.TOUCH_MOVE_THRESHOLD)return;this.isDragging=!0,this.tile.handleTileMoving()}if(this.isDragging){var n=t.add(this.touchStartOffset);this.setMovePosition(n),this.tile.animationHandler.abortAllMovementAnimations()}}}},{key:"setMovePosition",value:function(e){var t=this.tile.animationHandler.getShadow();t.node.setSiblingIndex(99998),this.node.setSiblingIndex(99999);var n=new F(e.x,e.y,this.node.position.z);t.node.setPosition(n),this.node.setPosition(n)}},{key:"getTouchPosition",value:function(e){var t=this.node.parent.parent.parent.getComponent(L),n=e.getUILocation();return t.convertToNodeSpaceAR(new F(n.x,n.y,0))}},{key:"getTouchOffset",value:function(e){var t=this.node.position;return new F(t.x-e.x,t.y-e.y,0)}},{key:"onTouchEnd",value:function(e){this.isTouching&&(this.isTouching=!1,this.checkIsChoosingOrAlreadyState()&&(this.isDragging?(this.isDragging=!1,this.tile.handleTileDropped()):this.handleClick()))}},{key:"onTouchCancel",value:function(e){this.isTouching&&(this.isTouching=!1,this.tile.isUncovered&&this.checkIsChoosingOrAlreadyState()&&(this.isDragging?(this.isDragging=!1,this.tile.handleTileDropped()):this.handleClick()))}},{key:"checkIsChoosingOrAlreadyState",value:function(){return this.tile.state===Xe.CHOOSING||this.tile.state===Xe.ALREADY}},{key:"handleClick",value:function(){this.tile.isUncovered&&
//! const vibrate = this.gameScene.gamePlay.vibrate
this.tile.handleTileClicked()}}]),r}(k)).TOUCH_MOVE_THRESHOLD=40,fd=yd))||fd;g._RF.pop(),g._RF.push({},"8b183z34N1DSbNWp3KCFNtS","TileCollectTween",void 0);Ludex.Utils.Signal;var Td=function(){function e(t){var n=this;i(this,e),this.reset=function(){n.tile.node.angle=0},this.tile=t}var t;return o(e,[{key:"startAnimation",value:(t=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.once(this.reset),n=this.tile.getTileSizeScale(),i=B(this.tile.node).to(.1,{scale:new F(1.2*n.x,1.2*n.y,1)},{easing:"cubicIn"}).to(.1,{scale:new F(1.25*n.x,1.25*n.y,1),angle:22},{easing:"cubicIn"}).to(.1,{angle:-22},{easing:"sineIn"}).to(.15,{angle:15},{easing:"sineInOut"}).to(.15,{angle:-13},{easing:"sineInOut"}).to(.1,{angle:0},{easing:"sineOut"}).to(.15,{scale:new F(0,0,1)},{easing:"cubicOut"}),e.next=5,Ve.runTweenAsync(i,t);case 5:t.off(this.reset);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();g._RF.pop(),g._RF.push({},"1a140DxQ0tGSoZKO4qqcxTs","TileCoverTween",void 0);Ludex.Utils.Signal;var Cd=function(){function e(t,n){i(this,e),this.itemSprite=t,this.overlayOpacity=n}var t,n;return o(e,[{key:"startCoverAnimation",value:(n=s(l().mark((function e(t){var n,i,a,r=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:.3,r.length>2&&void 0!==r[2]&&r[2]&&(i=B(this.itemSprite).to(n,{color:new D(180,180,180,255)}),Ve.runTweenAsync(i,t)),a=B(this.overlayOpacity).to(n,{opacity:255}).start(),Ve.runTweenAsync(a,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"startUncoverAnimation",value:(t=s(l().mark((function e(t){var n,i,a,r=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:.3,r.length>2&&void 0!==r[2]&&r[2]&&(i=B(this.itemSprite).to(n,{color:new D(255,255,255,255)}),Ve.runTweenAsync(i,t)),a=B(this.overlayOpacity).to(n,{opacity:0}).start(),Ve.runTweenAsync(a,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.overlayOpacity.opacity=0,this.itemSprite.color=new D(255,255,255,255)}}]),e}();g._RF.pop(),g._RF.push({},"0ee47HY0HBEr5sck4cawSHI","TileFlipTween",void 0);Ludex.Utils.Signal;var Ed=function(){function e(t,n,a,r){i(this,e),this.isHidingBackground=!1,this.isRunning=!1,this.tile=t,this.hidden=r,this.shadow=n,this.background=a}var t,n;return o(e,[{key:"getIsHidingBackground",value:function(){return this.isHidingBackground}},{key:"getIsRunning",value:function(){return this.isRunning}},{key:"setIsHidingBackground",value:function(e){this.isHidingBackground=e}},{key:"startHideBackgroundAnimation",value:(n=s(l().mark((function e(t){var n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:.2,i=!(s.length>2&&void 0!==s[2])||s[2],!this.isHidingBackground){e.next=4;break}return e.abrupt("return");case 4:if(this.isHidingBackground=!0,this.isRunning=!0,!(n<=0)){e.next=11;break}return this.background.active=!1,this.hidden.active=!0,this.isRunning=!1,e.abrupt("return");case 11:return a=this.createScaleTween(this.tile.node,n,!1),r=[Ve.runTweenAsync(a,t)],i&&(o=this.createScaleTween(this.shadow.node,n,!1),r.push(Ve.runTweenAsync(o,t))),e.next=16,Promise.all(r);case 16:this.isRunning=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createScaleTween",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.tile.getTileSizeScale();return B(e).to(.5*t,{scale:new F(.2*a.x,1*a.y,1)},{easing:"smooth"}).call((function(){i?(n.background.active=!0,n.hidden.active=!1):(n.background.active=!1,n.hidden.active=!0)})).to(.5*t,{scale:new F(a.x,a.y,1)},{easing:"smooth"})}},{key:"startShowBackgroundAnimation",value:(t=s(l().mark((function e(t){var n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:.2,i=!(s.length>2&&void 0!==s[2])||s[2],this.isHidingBackground){e.next=4;break}return e.abrupt("return");case 4:if(this.isHidingBackground=!1,this.isRunning=!0,!(n<=0)){e.next=11;break}return this.background.active=!0,this.hidden.active=!1,this.isRunning=!1,e.abrupt("return");case 11:return a=this.createScaleTween(this.tile.node,n,!0),r=[Ve.runTweenAsync(a,t)],i&&(o=this.createScaleTween(this.shadow.node,n,!0),r.push(Ve.runTweenAsync(o,t))),e.next=16,Promise.all(r);case 16:this.isRunning=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.isHidingBackground=!1,this.isRunning=!1,this.background.active=!0,this.hidden.active=!1}}]),e}();g._RF.pop(),g._RF.push({},"4c986D4ETNGgr2/U+UG6ceh","TileHighlightTween",void 0);Ludex.Utils.Signal;var Ld=function(){function e(t){i(this,e),this.isShowing=!1,this.selectedOverlayOpacity=t}var t,n,a;return o(e,[{key:"getIsShowing",value:function(){return this.isShowing}},{key:"createTweenGlowAnimation",value:(a=s(l().mark((function e(t,n){var i,a,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]?o[2]:.8,a=B(this.selectedOverlayOpacity).to(i,{opacity:t?255:0}),(r=[]).push(Ve.runTweenAsync(a,n)),e.next=6,Promise.all(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"startGlowAnimation",value:(n=s(l().mark((function e(t){var n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:.8,!this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return this.isShowing=!0,e.next=6,this.createTweenGlowAnimation(!0,t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"stopGlowAnimation",value:(t=s(l().mark((function e(t){var n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:.8,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return this.isShowing=!1,e.next=6,this.createTweenGlowAnimation(!1,t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.isShowing=!1,this.selectedOverlayOpacity.opacity=0}}]),e}();g._RF.pop(),g._RF.push({},"ee558+DmFpHh4vQ/m84xuJ5","TileHintTween",void 0);Ludex.Utils.Signal;var xd=function(){function e(t,n,a){i(this,e),this.isRunning=!1,this.hintOverlayOpacity=t,this.hintBorderOpacity=n,this.hintHighlight=a}return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"startHintAnimation",value:function(e){this.isRunning=!0;var t=B(this.hintOverlayOpacity).to(.3,{opacity:255});Ve.runTweenAsync(t,e);var n=B(this.hintOverlayOpacity).set({opacity:0}).to(.8,{opacity:150}).to(.8,{opacity:0}).union(),i=B(this.hintOverlayOpacity).set({opacity:0}).repeatForever(n);Ve.runTweenAsync(i,e);var a=B(this.hintBorderOpacity).to(.3,{opacity:255});Ve.runTweenAsync(a,e);var r=B(this.hintHighlight.node).set({angle:0}).by(1,{angle:360}).union(),o=B(this.hintHighlight.node).set({angle:0}).repeatForever(r);Ve.runTweenAsync(o,e)}},{key:"stopHintAnimation",value:function(e){this.isRunning=!1,this.hintOverlayOpacity.opacity=0,this.hintBorderOpacity.opacity=0,this.hintHighlight.node.angle=0}},{key:"reset",value:function(){this.isRunning=!1,this.hintOverlayOpacity.opacity=0,this.hintBorderOpacity.opacity=0,this.hintHighlight.node.angle=0}}]),e}();g._RF.pop(),g._RF.push({},"ab3d7Z05b1Mgb+TC2TRn/YQ","TileInitTween",void 0);Ludex.Utils.Signal;var Id=function(){function e(t,n,a){i(this,e),this.currentScale=new F(0,0,0),this.tile=t,this.tileUiOpacity=n,this.shadow=a}var t,n;return o(e,[{key:"closeTile",value:(n=s(l().mark((function e(){var t,n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:.075,n=a.length>1&&void 0!==a[1]?a[1]:0,this.currentScale.set(this.tile.getTileSizeScale()),this.tile.state=Xe.PRELOADING,i=B(this.tile.node).delay(n).to(t,{scale:new F(0,0,0)},{easing:"cubicIn"}),e.next=7,Ve.runTweenAsync(i);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"playScaleUpToCurrentAnimation",value:(t=s(l().mark((function e(t){var n,i,a,r,o,s,u,c,h,p=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:.12,i=p.length>2&&void 0!==p[2]?p[2]:0,a=p.length>3&&void 0!==p[3]?p[3]:new F(0,0,0),r=!(p.length>4&&void 0!==p[4])||p[4],this.tile.node.getComponent(P)){e.next=7;break}return e.abrupt("return");case 7:return this.currentScale.equals(F.ZERO)&&this.currentScale.set(this.tile.getTileSizeScale()),this.tileUiOpacity.opacity=255,this.shadow.opacity=255,o=[],r?(this.tile.node.setScale(F.ZERO),this.shadow.node.setScale(F.ZERO),s=this.createScaleUpTween(this.tile.node,n,i),u=this.createScaleUpTween(this.shadow.node,n,i),o.push(Ve.runTweenAsync(u,t)),o.push(Ve.runTweenAsync(s,t))):(this.tile.node.setScale(this.currentScale),this.shadow.node.setScale(this.currentScale)),c=this.createMoveToTween(this.tile.node,a,n,i),h=this.createMoveToTween(this.shadow.node,a,n,i),o.push(Ve.runTweenAsync(h,t)),o.push(Ve.runTweenAsync(c,t)),e.next=18,Promise.all(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createScaleUpTween",value:function(e,t,n){return B(e).delay(n).to(t,{scale:this.currentScale},{easing:"circOut"})}},{key:"createMoveToTween",value:function(e,t,n,i){var a=this.tile.worldPos.clone();return B(e).set({position:t.clone()}).delay(i).set({position:t.clone()}).to(n,{position:new F(a.x,a.y,0)},{easing:"cubicOut"})}},{key:"reset",value:function(){this.currentScale.set(F.ZERO)}}]),e}();g._RF.pop(),g._RF.push({},"1c93fOhNTJB8ruRTnhag89o","TileNudgeTween",void 0);Ludex.Utils.Signal;var Ad=function(){function e(t,n){i(this,e),this.isRunning=!1,this.tile=t,this.shadowOpacity=n}return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"startNudgeAnimation",value:function(e,t){if(!this.isRunning){this.isRunning=!0;var n=this.createNudgeTween(this.shadowOpacity.node),i=this.createLoopTween(this.shadowOpacity.node,n),a=this.createNudgeTween(this.tile.node),r=this.createLoopTween(this.tile.node,a);Ve.runTweenAsync(i,e),Ve.runTweenAsync(r,e)}}},{key:"createNudgeTween",value:function(e){return B(e).to(.15,{angle:22},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).to(.1,{angle:13},{easing:"sineInOut"}).to(.1,{angle:-13},{easing:"sineOut"}).to(.02,{angle:-17},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).delay(.3).union()}},{key:"createLoopTween",value:function(e,t){var n=this.tile.worldPos;return B(e).set({angle:0,position:new F(n.x,n.y,1)}).repeatForever(t)}},{key:"reset",value:function(){this.isRunning=!1,this.tile.node.angle=0,this.shadowOpacity.node.angle=0}}]),e}();g._RF.pop(),g._RF.push({},"6f7ebcNAMZAd7hGzOIS4ZzD","TileSelectTween",void 0);Ludex.Utils.Signal;var Rd=function(){function e(t,n){i(this,e),this.isRunning=!1,this.isBlockedLeft=!1,this.isBlockedRight=!1,this.tile=t,this.shadow=n}var t,n;return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"getCurrentSelectedPosition",value:function(){return this.isRunning?this.getSelectedPosition(this.isBlockedLeft,this.isBlockedRight):this.getSelectedPosition(!1,!1)}},{key:"startSelectAnimation",value:(n=s(l().mark((function e(t){var n,i,a,r,o,s,u,c=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],i=c.length>2&&void 0!==c[2]&&c[2],a=c.length>3&&void 0!==c[3]?c[3]:.8,this.isRunning=!0,this.isBlockedLeft=n,this.isBlockedRight=i,r=this.getSelectedPosition(n,i),o=this.createMoveTween(this.tile.node,a,r),s=this.createMoveTween(this.shadow.node,a,r),u=[Ve.runTweenAsync(o,t),Ve.runTweenAsync(s,t)],e.next=12,Promise.all(u);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createMoveTween",value:function(e,t,n){return B(e).to(t,{position:n},{easing:"smooth"})}},{key:"startUnselectAnimation",value:(t=s(l().mark((function e(t){var n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:.3,this.isRunning=!1,i=new F(this.tile.worldPos.x,this.tile.worldPos.y,1),a=this.createMoveTween(this.tile.node,n,i),r=this.createMoveTween(this.shadow.node,n,i),o=[Ve.runTweenAsync(a,t),Ve.runTweenAsync(r,t)],e.next=8,Promise.all(o);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.isRunning=!1,this.isBlockedLeft=!1,this.isBlockedRight=!1}},{key:"getSelectedPosition",value:function(e,t){var n=this.tile.worldPos,i=this.tile.getTileSize(),a=0;return e?a=.2*i.x:t&&(a=.2*-i.x),new F(n.x+a,n.y,1)}}]),e}();g._RF.pop(),g._RF.push({},"b7d66xr7RhN0KKD9F6zu+fG","TileShakeTween",void 0);Ludex.Utils.Signal;var Pd=function(){function e(t,n){i(this,e),this.tile=t,this.shadow=n}var t;return o(e,[{key:"playShakeAnimation",value:(t=s(l().mark((function e(t,n){var i,a,r,o=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.createShakeTween(this.tile.node,n),a=this.createShakeTween(this.shadow.node,n),r=function(){a.stop(),o.tile.node.setPosition(n.x,n.y),o.shadow.node.setPosition(n.x,n.y)},t.once(r),Ve.runTweenAsync(a),e.next=7,Ve.runTweenAsync(i,t);case 7:t.off(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"createShakeTween",value:function(e,t){var n=Qe.ANIMATION_CONFIGS.SHAKE.SHAKE_DURATION,i=Qe.ANIMATION_CONFIGS.SHAKE.SHAKE_OFFSET;return B(e).to(n,{position:new F(t.x+i,t.y)}).to(n,{position:new F(t.x-i,t.y)}).to(n,{position:new F(t.x+i,t.y)}).to(n,{position:new F(t.x-i,t.y)}).to(n,{position:new F(t.x,t.y)})}}]),e}();g._RF.pop(),g._RF.push({},"e0bacq8D3JJHaehSRDt2HQ7","TileShineTween",void 0);Ludex.Utils.Signal;var _d=function(){function e(t,n){i(this,e),this.isGlowShadow=!1,this.tile=t,this.shadow=n}var t;return o(e,[{key:"getIsHidingBackground",value:function(){return this.isGlowShadow}},{key:"startShineAnimation",value:(t=s(l().mark((function e(t){var n,i,a,r,o=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isGlowShadow){e.next=2;break}return e.abrupt("return");case 2:return this.isGlowShadow=!0,t.once(this.reset),n=this.tile.getTileSizeScale(),i=B(this.tile.node).to(.1,{scale:new F(.8*n.x,.8*n.y,1)},{easing:"cubicIn"}).to(.2,{scale:new F(1.2*n.x,1.2*n.y,1)},{easing:"cubicInOut"}).to(.2,{scale:new F(n.x,n.y,1)},{easing:"cubicOut"}),a=B(this.shadow).set({opacity:0}).delay(.1).call((function(){o.tile.setGlowShadow(!0)})).set({opacity:100}).to(.2,{opacity:255},{easing:"cubicIn"}).to(.2,{opacity:200},{easing:"cubicInOut"}),r=[Ve.runTweenAsync(i,t),Ve.runTweenAsync(a,t)],e.next=10,Promise.all(r);case 10:t.off(this.reset);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.isGlowShadow=!1,this.tile.setGlowShadow(!1),this.shadow.opacity=255}}]),e}();g._RF.pop(),g._RF.push({},"67b244GKPlEs5+hGwB+vsYW","TileShuffleTween",void 0);Ludex.Utils.Signal;var Nd=function(){function e(t,n){i(this,e),this.tile=t,this.shadowOpacity=n}var t;return o(e,[{key:"playShuffleAnimation",value:(t=s(l().mark((function e(t,n){var i,a,r,o,s,u,c,h,p,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.tile.worldPos.x,a=this.tile.worldPos.y,this.tile.uiTransform){e.next=4;break}return e.abrupt("return");case 4:return r=i,o=a,s=this.createMoveTween(this.tile.node,r,o),u=this.createMoveTween(this.shadowOpacity.node,r,o),c=B(this.shadowOpacity).to(.25,{opacity:0},{easing:"cubicOut"}).delay(1.15).to(.2,{opacity:255},{easing:"cubicOut"}),h=Ve.runTweenAsync(c,t),p=Ve.runTweenAsync(s,t),d=Ve.runTweenAsync(u,t),e.next=14,Promise.all([h,p,d]);case 14:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"createMoveTween",value:function(e,t,n){return B(e).to(.5,{position:new F(0,0,0)},{easing:"backIn"}).delay(.4).to(.5,{position:new F(t,n,0)},{easing:"backOut"})}}]),e}();g._RF.pop(),g._RF.push({},"f8b51gHgrFMkomOqHYy6Otp","TileTargetTween",void 0);Ludex.Utils.Signal;var Od=function(){function e(t){i(this,e),this.isRunning=!1,this.findingOpacity=t}var t;return o(e,[{key:"playShowAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.isRunning)return this.isRunning=!0,this.createTweenGlowAnimation(!0,e,t)}},{key:"playHideAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.isRunning)return this.isRunning=!1,this.createTweenGlowAnimation(!1,e,t)}},{key:"getIsRunning",value:function(){return this.isRunning}},{key:"createTweenGlowAnimation",value:(t=s(l().mark((function e(t,n){var i,a,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]?o[2]:.8,a=B(this.findingOpacity).to(i,{opacity:t?255:0}),(r=[]).push(Ve.runTweenAsync(a,n)),e.next=6,Promise.all(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"reset",value:function(){this.isRunning=!1,this.findingOpacity.opacity=0}}]),e}();g._RF.pop(),g._RF.push({},"2f8b7qRHRZAI426Nbgp2wBc","TileUndoTween",void 0);Ludex.Utils.Signal;var Bd=function(){function e(t,n,a){i(this,e),this.tile=t,this.tileOpacity=n,this.shadow=a}return o(e,[{key:"playUndoAnimation",value:function(e){this.tileOpacity.opacity=255,this.tile.node.setPosition(this.tile.worldPos.x,this.tile.worldPos.y);
//! this.shadow.node.setPosition(this.tile.worldPos.x, this.tile.worldPos.y)
var t=this.createScaleTween(this.tile.node),n=this.createScaleTween(this.shadow.node);Ve.runTweenAsync(t,e),Ve.runTweenAsync(n,e)}},{key:"createScaleTween",value:function(e){var t=this.tile.getTileSizeScale();return B(e).set({scale:new F(.3*t.x,.3*t.y,1)}).to(.3,{scale:new F(t.x,t.y,1)},{easing:"backOut"})}}]),e}();g._RF.pop(),g._RF.push({},"aa92cVSsjZHF4nMkgbVQrr2","TileZoomTween",void 0);Ludex.Utils.Signal;var Dd,Fd,Md,zd,Ud,Gd,Hd,Wd,Vd,jd,qd,Kd,Yd,Jd,Zd,Xd,Qd,$d,ef,tf,nf,af,rf,of,sf,lf,uf,cf=function(){function e(t,n){i(this,e),this.tile=t,this.shadow=n}var t;return o(e,[{key:"startAnimation",value:(t=s(l().mark((function e(t,n){var i,a,r,o,s,u,c,h;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tile.node.getComponent(P)){e.next=3;break}return e.abrupt("return");case 3:return i=[],a=this.tile.getTileSizeScale(),r=Qe.ANIMATION_CONFIGS.ZOOM.DURATION,o=this.tile.worldPos.clone(),s=this.createScaleTween(this.tile.node,r,a),i.push(Ve.runTweenAsync(s,t)),n||(u=this.createScaleTween(this.shadow.node,r,a),i.push(Ve.runTweenAsync(u,t))),c=this.createMoveToTween(this.tile.node,o,r),n||(h=this.createMoveToTween(this.shadow.node,o,r),i.push(Ve.runTweenAsync(h,t))),i.push(Ve.runTweenAsync(c,t)),e.next=15,Promise.all(i);case 15:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"createScaleTween",value:function(e,t,n){return B(e).to(t,{scale:n},{easing:"circOut"})}},{key:"createMoveToTween",value:function(e,t,n){return B(e).to(n,{position:new F(t.x,t.y,0)},{easing:"sineOut"})}}]),e}();g._RF.pop(),g._RF.push({},"dcdc7pCmblCF6sivNY6OqXp","TileAnimationHandler",void 0);var hf,pf,df,ff,yf,vf,gf,mf,bf,Sf,wf,kf,Tf,Cf,Ef,Lf,xf,If,Af,Rf,Pf,_f,Nf,Of,Bf,Df,Ff,Mf,zf,Uf,Gf,Hf=m.ccclass,Wf=m.property,Vf=Ludex.Utils.Signal,jf=(Dd=Hf("TileAnimationHandler"),Fd=Wf(L),Md=Wf(A),zd=Wf(P),Ud=Wf(P),Gd=Wf(P),Hd=Wf(P),Wd=Wf(P),Vd=Wf(P),jd=Wf(P),qd=Wf(ee),Kd=Wf(E),Yd=Wf(A),Dd((Xd=e((Zd=function(e){t(L,e);var u,c,h,p,d,f,y,v,g,m,b,S,w,k,T,C,E=n(L);function L(){var e;i(this,L);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=E.call.apply(E,[this].concat(n)),a(e,"tileUITransform",Xd,r(e)),a(e,"background",Qd,r(e)),a(e,"tileOpacity",$d,r(e)),a(e,"shadowOpacity",ef,r(e)),e.isShadowAttached=!0,a(e,"overlayOpacity",tf,r(e)),a(e,"selectedOverlayOpacity",nf,r(e)),a(e,"targetOverlayOpacity",af,r(e)),a(e,"hintOverlayOpacity",rf,r(e)),a(e,"hintBorderOpacity",of,r(e)),a(e,"selectParticleSystem",sf,r(e)),a(e,"hintHighlight",lf,r(e)),a(e,"hidden",uf,r(e)),e.initSignalController=new Vf.SignalController,e.hintSignalController=new Vf.SignalController,e.shakeSignalController=new Vf.SignalController,e.undoSignalController=new Vf.SignalController,e.highlightSignalController=new Vf.SignalController,e.selectSignalController=new Vf.SignalController,e.coverSignalController=new Vf.SignalController,e.shuffleSignalController=new Vf.SignalController,e.nudgeSignalController=new Vf.SignalController,e.targetSignalController=new Vf.SignalController,e.flipSignalController=new Vf.SignalController,e.shineSignalController=new Vf.SignalController,e.collectSignalController=new Vf.SignalController,e.zoomSignalController=new Vf.SignalController,e}return o(L,[{key:"__preload",value:function(){this.tile=this.getComponent($f),this.tileInitTween=new Id(this.tile,this.tileOpacity,this.shadowOpacity),this.tileShakeTween=new Pd(this.tile,this.shadowOpacity),this.tileUndoTween=new Bd(this.tile,this.tileOpacity,this.shadowOpacity),this.tileShuffleTween=new Nd(this.tile,this.shadowOpacity),this.tileSelectTween=new Rd(this.tile,this.shadowOpacity),this.tileNudgeTween=new Ad(this.tile,this.shadowOpacity),this.tileFlipTween=new Ed(this.tile,this.shadowOpacity,this.background,this.hidden),this.tileShineTween=new _d(this.tile,this.shadowOpacity),this.tileCollectTween=new Td(this.tile),this.tileZoomTween=new cf(this.tile,this.shadowOpacity),this.tileHighlightTween=new Ld(this.selectedOverlayOpacity),this.tileCoverTween=new Cd(this.tile.item,this.overlayOpacity),this.tileHintTween=new xd(this.hintOverlayOpacity,this.hintBorderOpacity,this.hintHighlight),this.tileTargetTween=new Od(this.targetOverlayOpacity),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"detachShadow",value:function(e){return this.isShadowAttached?(this.isShadowAttached=!1,this.shadowOpacity.node.setParent(e,!0),this.shadowOpacity.node.setPosition(this.tile.node.position),this.shadowOpacity):this.shadowOpacity}},{key:"attachShadow",value:function(){this.isShadowAttached||(this.isShadowAttached=!0,this.shadowOpacity.node.setScale(F.ONE),this.shadowOpacity.node.setParent(this.tile.node),this.shadowOpacity.node.setPosition(0,0,0),this.shadowOpacity.node.setSiblingIndex(0))}},{key:"getShadow",value:function(){return this.shadowOpacity}},{key:"getShadowIsAttached",value:function(){return this.isShadowAttached}},{key:"toggleCoverAnimations",value:(C=s(l().mark((function e(t){var n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.length>1&&void 0!==a[1]?a[1]:.3,i=this.coverSignalController.renew(),t?this.tileCoverTween.startUncoverAnimation(i,n,this.tile.isArtifact):this.tileCoverTween.startCoverAnimation(i,n,this.tile.isArtifact);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"playTileOpenAnimation",value:(T=s(l().mark((function e(){var t,n,i,a,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:.12,n=o.length>1&&void 0!==o[1]?o[1]:0,i=o.length>2&&void 0!==o[2]?o[2]:new F(0,0,0),a=!(o.length>3&&void 0!==o[3])||o[3],this.toggleCoverAnimations(!0,0),r=this.initSignalController.renew(),e.abrupt("return",this.tileInitTween.playScaleUpToCurrentAnimation(r,t,n,i,a));case 7:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"playSelectAnim",value:(k=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:.3,n=c.length>1&&void 0!==c[1]&&c[1],i=c.length>2&&void 0!==c[2]&&c[2],this.selectParticleSystem.node.active=!0,this.tileHighlightTween.getIsShowing()||(a=this.highlightSignalController.renew(),this.tileHighlightTween.startGlowAnimation(a,t)),this.abortAllMovementAnimations(),r=this.selectSignalController.renew(),o=[this.tileSelectTween.startSelectAnimation(r,n,i,t)],this.tile.isHidden&&this.tileFlipTween.getIsHidingBackground()&&(s=this.flipSignalController.renew(),u=this.tileFlipTween.startShowBackgroundAnimation(s,.2),o.push(u)),e.next=11,Promise.all(o);case 11:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"playUnselectAnim",value:(w=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:.3,this.selectParticleSystem.node.active=!1,this.tileHighlightTween.getIsShowing()&&(n=this.highlightSignalController.renew(),this.tileHighlightTween.stopGlowAnimation(n,t)),this.abortAllMovementAnimations(),i=this.selectSignalController.renew(),a=[this.tileSelectTween.startUnselectAnimation(i,t)],this.tile.isHidden&&!this.tileFlipTween.getIsHidingBackground()&&(r=this.flipSignalController.renew(),o=this.tileFlipTween.startHideBackgroundAnimation(r,.2),a.push(o)),e.next=9,Promise.all(a);case 9:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"playShuffleAnim",value:(S=s(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playTileStopHintAnim(),n=this.shuffleSignalController.renew(),e.next=4,this.tileShuffleTween.playShuffleAnimation(n,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"playTileShowHintAnim",value:(b=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tileHintTween.getIsRunning()){e.next=2;break}return e.abrupt("return");case 2:t=this.hintSignalController.renew(),this.tileHintTween.startHintAnimation(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"playTileStopHintAnim",value:(m=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tileHintTween.getIsRunning()){e.next=2;break}return e.abrupt("return");case 2:t=this.hintSignalController.renew(),this.tileHintTween.stopHintAnimation(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"toggleTargetTile",value:function(e){var t=this.targetSignalController.renew();e?this.tileTargetTween.playShowAnimation(t):this.tileTargetTween.playHideAnimation(t)}},{key:"toggleHiddenTile",value:function(e){var t=this.flipSignalController.renew();e?this.tileFlipTween.startHideBackgroundAnimation(t,0):this.tileFlipTween.startShowBackgroundAnimation(t,0)}},{key:"playTileShineAnim",value:(g=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.shineSignalController.renew(),this.attachShadow(),this.toggleCoverAnimations(!0,.2),e.abrupt("return",this.tileShineTween.startShineAnimation(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"playTileCollectAnim",value:(v=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.collectSignalController.renew(),this.attachShadow(),this.toggleCoverAnimations(!0,.2),e.abrupt("return",this.tileCollectTween.startAnimation(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"playTileZoomAnim",value:(y=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.zoomSignalController.renew(),n=this.getShadowIsAttached(),e.abrupt("return",this.tileZoomTween.startAnimation(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"playTileUndoAnim",value:(f=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.undoSignalController.renew(),this.tileUndoTween.playUndoAnimation(t);case 2:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"playTileShakeAnim",value:(d=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.abortAllMovementAnimations(),t=this.shakeSignalController.renew(),n=this.tileSelectTween.getCurrentSelectedPosition(),this.tileShakeTween.playShakeAnimation(t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"playTileNudgeAnim",value:(p=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.nudgeSignalController.renew(),n=this.tileSelectTween.getCurrentSelectedPosition(),this.tileNudgeTween.startNudgeAnimation(t,n);case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"abortTileNudgeAnim",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.nudgeSignalController.abort(),this.tileNudgeTween.reset();case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"playTileMoveToMatchPosition",value:(c=s(l().mark((function e(t,n,i){var a,r,o,s,u,c,h,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playTileStopHintAnim(),this.tile.inputHandler.disableInteraction(),this.abortTileNudgeAnim(),this.abortAllMovementAnimations(),this.attachShadow(),this.tileHighlightTween.getIsShowing()&&(a=this.highlightSignalController.renew(),this.tileHighlightTween.stopGlowAnimation(a,.3)),this.tile.isHidden&&this.tileFlipTween.getIsHidingBackground()!==this.tileFlipTween.getIsRunning()&&(r=this.flipSignalController.renew(),this.tileFlipTween.setIsHidingBackground(!0),this.tileFlipTween.startShowBackgroundAnimation(r,.2,!1)),o=this.tile.getTileSize(),s=1.2*o.x,u=te(n.x+s*i,t.y,0),c=.5*o.x,h=te(t.x+c*i,t.y,0),p=B(this.tile.node).to(.28,{position:u},{easing:"sineOut"}).to(.15,{position:h},{easing:"sineOut"}),e.next=16,Ve.runTweenAsync(p);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"playTileDestroyingAnim",value:(u=s(l().mark((function e(t,n){var i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.tile.getTileSizeScale(),a=B(this.tile.node).delay(.4).to(.15,{scale:new F(.7*i.x,.7*i.y,1)},{easing:"quartInOut"}),r=.35*this.tile.getTileSize().x,o=B(this.tile.node).delay(.43).to(.1,{position:new F(t.x+r*n,t.y,0)},{easing:"linear"}),s=B(this.tileOpacity).delay(.55).to(.15,{opacity:0},{easing:"cubicOut"}),e.next=7,Promise.all([Ve.runTweenAsync(a),Ve.runTweenAsync(s),Ve.runTweenAsync(o)]);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"abortAllMovementAnimations",value:function(){this.shakeSignalController.abort(),this.selectSignalController.abort(),this.initSignalController.abort(),this.zoomSignalController.abort()}},{key:"resetTileAnimation",value:function(){this.attachShadow(),this.hintSignalController.abort(),this.shakeSignalController.abort(),this.selectSignalController.abort(),this.coverSignalController.abort(),this.undoSignalController.abort(),this.highlightSignalController.abort(),this.shuffleSignalController.abort(),this.nudgeSignalController.abort(),this.targetSignalController.abort(),this.flipSignalController.abort(),this.shineSignalController.abort(),this.zoomSignalController.abort(),this.tileSelectTween.reset(),this.tileFlipTween.reset(),this.tileNudgeTween.reset(),this.tileHintTween.reset(),this.tileCoverTween.reset(),this.tileHighlightTween.reset(),this.tileInitTween.reset(),this.tileTargetTween.reset(),this.tileShineTween.reset(),this.selectParticleSystem.resetSystem(),this.selectParticleSystem.node.active=!1}}]),L}(k)).prototype,"tileUITransform",[Fd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qd=e(Zd.prototype,"background",[Md],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$d=e(Zd.prototype,"tileOpacity",[zd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ef=e(Zd.prototype,"shadowOpacity",[Ud],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tf=e(Zd.prototype,"overlayOpacity",[Gd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nf=e(Zd.prototype,"selectedOverlayOpacity",[Hd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),af=e(Zd.prototype,"targetOverlayOpacity",[Wd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rf=e(Zd.prototype,"hintOverlayOpacity",[Vd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),of=e(Zd.prototype,"hintBorderOpacity",[jd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sf=e(Zd.prototype,"selectParticleSystem",[qd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lf=e(Zd.prototype,"hintHighlight",[Kd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uf=e(Zd.prototype,"hidden",[Yd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jd=Zd))||Jd);g._RF.pop(),g._RF.push({},"20047S5wz1O65V4b+kQfNWx","Tile",void 0);var qf,Kf,Yf,Jf,Zf,Xf=m.ccclass,Qf=m.property,$f=(hf=Xf("Tile"),pf=Qf(E),df=Qf(E),ff=Qf(E),yf=Qf(E),vf=Qf(E),gf=Qf(E),mf=Qf(E),bf=Qf(E),Sf=Qf(E),wf=Qf(E),kf=Qf(E),Tf=Qf(E),Cf=Qf(E),Ef=Qf(ee),hf((If=e((xf=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"item",If,r(e)),a(e,"background",Af,r(e)),a(e,"shadow",Rf,r(e)),a(e,"overlay",Pf,r(e)),a(e,"hiddenBackground",_f,r(e)),a(e,"targetOverlay",Nf,r(e)),a(e,"hintOverlay",Of,r(e)),a(e,"hintBorder",Bf,r(e)),a(e,"hintMask",Df,r(e)),a(e,"hintGlow",Ff,r(e)),a(e,"selectOverlay",Mf,r(e)),a(e,"selectBorder",zf,r(e)),a(e,"selectMask",Uf,r(e)),a(e,"selectSpark",Gf,r(e)),e.id="",e.skinIdx=-1,e.gridPos=new j(0,0),e.worldPos=new j(0,0),e.state=Xe.PRELOADING,e.isUncovered=!0,e.isGolden=!1,e.isTarget=!1,e.isHidden=!1,e.isArtifact=!1,e.depth=0,e.layer=0,e.tileSize=new j(0,0),e.tileSizeScale=new F(0,0,0),e}return o(d,[{key:"getTileSize",value:function(){return this.tileSize}},{key:"getTileSizeScale",value:function(){return this.tileSizeScale}},{key:"__preload",value:function(){this.initializeComponents(),this.setupEventListeners(),this._init(),this.validateRequiredComponents()}},{key:"initializeComponents",value:function(){this.uiTransform=this.node.getComponent(L),this.animationHandler=this.getComponent(jf),this.inputHandler=this.getComponent(kd)}},{key:"setupEventListeners",value:function(){var e=this;this.node.scene.on($e.ALL_TILE_READY,(function(){e.state=Xe.ALREADY}),this)}},{key:"_init",value:function(){this.node.scale=new F(0,0,0)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onLoad",value:function(){}},{key:"setSize",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.tileSize.set(e,t),this.tileSizeScale.set(e/Qe.SIZE.WIDTH,t/Qe.SIZE.HEIGHT,1),n&&this.node.setScale(this.tileSizeScale)}},{key:"setInitSize",value:function(e,t){this.setSize(e,t)}},{key:"addSizeAmount",value:function(e,t){var n=this.uiTransform.contentSize,i=n.x+e,a=n.y+t;this.setSize(i,a)}},{key:"getSize",value:function(){return new j(this.uiTransform.width,this.uiTransform.height)}},{key:"addOffset",value:function(e,t){var n=this.node.position,i=n.x,a=n.y,r=n.z;this.node.position=new F(i+e,a+t,r)}},{key:"setDepth",value:function(e){this.depth=e}},{key:"getDepth",value:function(){return this.depth}},{key:"setLayer",value:function(e){this.layer=e}},{key:"getLayer",value:function(){return this.layer}},{key:"getCurrentTileConfig",value:function(){return{id:this.id,skinProp:{skinIdx:this.skinIdx,isHidden:this.isHidden,isTarget:this.isTarget},gridPos:this.gridPos,worldPos:this.worldPos,layer:this.layer,depth:this.depth,size:{width:this.tileSize.x,height:this.tileSize.y}}}},{key:"isTileChoosing",value:function(){return this.state===Xe.CHOOSING}},{key:"initializeTile",value:function(e){this.id=e.id,this.skinIdx=e.skinProp.skinIdx,this.isHidden=e.skinProp.isHidden,this.isTarget=e.skinProp.isTarget,this.gridPos=e.gridPos,this.worldPos=e.worldPos,this.setLayer(e.layer),this.setDepth(e.depth),this.setInitSize(e.size.width,e.size.height)}},{key:"handleInitializeTile",value:function(){this.inputHandler.enableInteraction()}},{key:"resetSkinIdx",value:function(e){this.isGolden&&e!==et&&(this.isGolden=!1,this.background.node.active=!0),this.isHidden&&(this.isHidden=!1,this.animationHandler.toggleHiddenTile(!1)),this.isTarget&&(this.isTarget=!1,this.animationHandler.toggleTargetTile(!1)),this.isArtifact||(this.skinIdx=e,this.setItemSprite(Ne.getTileIcon(e.toString())))}},{key:"setItemSprite",value:function(e){this.item&&e&&(this.item.spriteFrame=e)}},{key:"handleChooseTile",value:(h=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],n=i.length>1&&void 0!==i[1]&&i[1],this.state=Xe.CHOOSING,e.next=5,this.animationHandler.playSelectAnim(.3,t,n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleUnChooseTile",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=Xe.ALREADY,e.next=3,this.animationHandler.playUnselectAnim();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handlePreloadTile",value:function(){this.state=Xe.PRELOADING,this.inputHandler.disableInteraction()}},{key:"handleReadyTile",value:function(){this.state=Xe.ALREADY,this.inputHandler.enableInteraction()}},{key:"toggleUncover",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3;this.isUncovered=e,this.animationHandler.toggleCoverAnimations(e,t)}},{key:"setUncover",value:function(e){this.isUncovered=e}},{key:"setGolden",value:function(e){this.isGolden=!0,this.skinIdx=et,this.setItemSprite(e),this.background.node.active=!1}},{key:"setTargetTile",value:function(){this.isTarget=!0,this.animationHandler.toggleTargetTile(!0)}},{key:"setHiddenTile",value:function(){this.isHidden=!0,this.animationHandler.toggleHiddenTile(!0)}},{key:"setArtifactTile",value:function(e){this.isArtifact=!0,this.skinIdx=e,this.setItemSprite(tt.getCurrentArtifactTileSprite(e.toString())),this.overlay.node.active=!1,this.background.node.active=!1,this.shadow.node.active=!1}},{key:"handleTileClicked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isUncovered&&this.node&&this.node.scene.emit($e.TILE_CLICKED,this,e)}},{key:"handleTileMoving",value:function(){this.isUncovered&&this.node&&this.node.scene.emit($e.TILE_MOVING,this)}},{key:"handleTileDropped",value:function(){this.isUncovered&&this.node&&this.node.scene.emit($e.TILE_DROPPED,this)}},{key:"handleTileCoveredClicked",value:function(){!this.isUncovered&&this.node&&this.node.scene.emit($e.TILE_COVERED_CLICKED,this)}},{key:"swapTileData",value:function(e){var t=this.gridPos,n=this.worldPos,i=this.getDepth(),a=this.getLayer();this.gridPos=e.gridPos,this.worldPos=e.worldPos,this.depth=e.getDepth(),this.layer=e.getLayer(),e.gridPos=t,e.worldPos=n,e.setDepth(i),e.setLayer(a)}},{key:"setBackgroundSprite",value:function(e){this.background&&e&&(this.background.spriteFrame=e)}},{key:"setHiddenBackgroundSprite",value:function(e){this.hiddenBackground&&e&&(this.hiddenBackground.spriteFrame=e)}},{key:"setEffectSprites",value:function(){this.shadow.spriteFrame=Ne.getEffectSpriteFrame("shadow"),this.overlay.spriteFrame=Ne.getEffectSpriteFrame("grey"),this.hintBorder.spriteFrame=Ne.getEffectSpriteFrame("blue-border"),this.hintOverlay.spriteFrame=Ne.getEffectSpriteFrame("blue"),this.hintMask.spriteFrame=Ne.getEffectSpriteFrame("blue-border"),this.hintGlow.spriteFrame=Ne.getEffectSpriteFrame("glow"),this.selectOverlay.spriteFrame=Ne.getEffectSpriteFrame("green"),this.selectBorder.spriteFrame=Ne.getEffectSpriteFrame("yellow"),this.selectMask.spriteFrame=Ne.getEffectSpriteFrame("green"),this.selectSpark.spriteFrame=Ne.getEffectSpriteFrame("spark"),this.targetOverlay.spriteFrame=Ne.getEffectSpriteFrame("pink")}},{key:"setGlowShadow",value:function(e){this.shadow.spriteFrame=e?Ne.getEffectSpriteFrame("shadow-glow"):Ne.getEffectSpriteFrame("shadow")}},{key:"playShuffleAnim",value:(u=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.animationHandler.playShuffleAnim(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"returnToPool",value:function(){this.resetState(),this.gameScene.gameplay.gameObjects.tilePool.returnTile(this.node)}},{key:"resetState",value:function(){this.node.setScale(F.ZERO),this.id="",this.skinIdx=-1,this.gridPos=new j(0,0),this.worldPos=new j(0,0),this.state=Xe.PRELOADING,this.isUncovered=!0,this.isGolden=!1,this.isTarget=!1,this.isHidden=!1,this.isArtifact=!1,this.background.node.active=!0,this.overlay.node.active=!0,this.shadow.node.active=!0,this.depth=0,this.layer=0,this.animationHandler.resetTileAnimation(),this.inputHandler.disableInteraction(),ie.stopAllByTarget(this.node)}}]),d}(k)).prototype,"item",[pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Af=e(xf.prototype,"background",[df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf=e(xf.prototype,"shadow",[ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pf=e(xf.prototype,"overlay",[yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_f=e(xf.prototype,"hiddenBackground",[vf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nf=e(xf.prototype,"targetOverlay",[gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Of=e(xf.prototype,"hintOverlay",[mf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bf=e(xf.prototype,"hintBorder",[bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Df=e(xf.prototype,"hintMask",[Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ff=e(xf.prototype,"hintGlow",[wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mf=e(xf.prototype,"selectOverlay",[kf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zf=e(xf.prototype,"selectBorder",[Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uf=e(xf.prototype,"selectMask",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=e(xf.prototype,"selectSpark",[Ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lf=xf))||Lf);g._RF.pop(),g._RF.push({},"93cb2v1gvtJyqaFA2hjUuUU","TilePool",void 0);var ey=m.ccclass,ty=m.property,ny=(qf=ey("TilePool"),Kf=ty(q),qf((Zf=e((Jf=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"tilePrefab",Zf,r(e)),e.pool=[],e}return o(l,[{key:"getTile",value:function(){if(this.pool.length>0){var e=this.pool.pop();e.active=!0;var t=e.getComponent($f);return t&&(t.isUncovered=!0),e}var n=K(this.tilePrefab);return n.active=!0,n}},{key:"returnTile",value:function(e){e.removeFromParent(),e.active=!1,this.pool.push(e)}}]),l}(k)).prototype,"tilePrefab",[Kf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf=Jf))||Yf);g._RF.pop(),g._RF.push({},"c7c0fvKOOxEQpTUWke5LCqW","AlignTileManager",void 0);var iy,ay,ry,oy,sy,ly=function(){function e(t){i(this,e),this.borders={top:0,bottom:0},this.tileSize={width:0,height:0},this.gridBounds={minX:0,maxX:0,minY:0,maxY:0},this.maxLayer=0,this.layerOfMostTop=0,this.layerOfMostLeft=0,this.gameScene=t}return o(e,[{key:"useParams",value:function(e,t,n,i,a,r,o){this.maxLayer=a,this.layerOfMostTop=r,this.layerOfMostLeft=o,console.log({maxLayer:a,layerOfMostTop:r,layerOfMostLeft:o,minGridPosX:e,maxGridPosX:t,minGridPosY:n,maxGridPosY:i}),this.updateGridBounds(e,t,n,i),this.tileSize=this.calculateTileSize(),console.log("tileSize",{tileSize:this.tileSize,maxLayer:a,layerOfMostTop:r,layerOfMostLeft:o})}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getTopBotBorder",value:function(){return{top:this.borders.top,bottom:this.borders.bottom}}},{key:"getTilePosition",value:function(e,t,n){var i=e-(this.gridBounds.minX+this.gridBounds.maxX)/2,a=t-(this.gridBounds.minY+this.gridBounds.maxY)/2,r=-n*Sd+this.layerOfMostLeft*Sd/2,o=n*wd-this.layerOfMostTop*wd/2,s=i*vd,l=-a*gd;return{x:i*this.tileSize.width+s+r,y:-a*this.tileSize.height+l+o}}},{key:"updateBorders",value:function(){var e=this.gameScene.gameplay;this.borders.top=e.uiManager.header.height,this.borders.bottom=e.uiManager.footer.height+je.getBannerAdsHeight()}},{key:"updateGridBounds",value:function(e,t,n,i){this.gridBounds={minX:e,maxX:t,minY:n,maxY:i}}},{key:"calculateTileSize",value:function(){var e=this.prepareBoardConfig(),t=this.calculateInitialTileSize(e),n=t.width,i=t.height,a=n*bd;return a<i?{width:n,height:a}:{width:i/bd,height:i}}},{key:"prepareBoardConfig",value:function(){var e=this.gridBounds.maxY-this.gridBounds.minY,t=this.gridBounds.maxX-this.gridBounds.minX,n=t*vd,i=e*gd,a=100+this.layerOfMostLeft*Sd;return{boardMaxCoordX:t,boardMaxCoordY:e,totalPaddingX:n,totalPaddingY:i,remainingBoardWidth:this.getRemainingBoardWidth(a),remainingBoardHeight:this.getRemainingBoardHeight()}}},{key:"calculateInitialTileSize",value:function(e){var t=e.boardMaxCoordX,n=e.boardMaxCoordY,i=e.totalPaddingX,a=e.totalPaddingY,r=e.remainingBoardWidth,o=e.remainingBoardHeight,s=md,l=s*bd;return{width:s=Math.min((r-i)/(t+1),s),height:l=Math.min((o-a)/(n+1),l)}}},{key:"getRemainingBoardWidth",value:function(e){return this.gameScene.gameplay.gameObjects.getBoardGameObjectsWidth()-e}},{key:"getRemainingBoardHeight",value:function(){var e=this.gameScene.gameplay,t=e.gameObjects,n=.6*e.uiManager.header.height;return t.getBoardGameObjectsHeight()-this.layerOfMostTop*wd-n}}]),e}();g._RF.pop(),g._RF.push({},"75ad9uPflhLL4N96NmHF2Sk","GameObjects",void 0);var uy=m.ccclass,cy=m.property,hy=(iy=uy("GameObjects"),ay=cy(ny),iy((sy=e((oy=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"tilePool",sy,r(e)),e.minColTiles=0,e.maxColTiles=0,e.minRowTiles=0,e.maxRowTiles=0,e.maxLayer=0,e.totalTiles=0,e.layerOfMostTop=-1,e.layerOfMostLeft=-1,e.skinIndexes=[],e.tiles=[],e.uiTransform=null,e}return o(l,[{key:"__preload",value:function(){this.initManagers()}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(L)}},{key:"initManagers",value:function(){this.alignManager=new ly(this.gameScene)}},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"spawnObjects",value:function(e){this.sortDataAndCreateTiles(e)}},{key:"spawnGuideObjects",value:function(e){this.sortDataAndCreateGuideTiles(e)}},{key:"respawnTile",value:function(e){var t=this.createTileInstance();if(!t)return null;t.setPosition(e.worldPos.x,e.worldPos.y,0);var n=t.getComponent($f);if(!n)return null;var i=Ne.getTileIcon(e.skinProp.skinIdx.toString());i&&n.setItemSprite(i);var a=Ne.getCurrentTileBackgroundSprite();return n.setBackgroundSprite(a),n.setHiddenBackgroundSprite(Ne.getCurrentTileHiddenSprite()),n.setEffectSprites(),n.initializeTile(e),this.tiles.push(n),this.node.scene.emit($e.TILE_CREATED,{tile:n,layer:e.layer}),n}},{key:"sortDataAndCreateTiles",value:function(e){var t=this.extractLevel(e);this.calculateSkinIndexes(),this.sortDepth(t);for(var n=0,i=0;i<=this.maxLayer;i++){var a=t.get(i);if(a)for(var r=0;r<a.length;r++){var o=a[r],s=this.skinIndexes.pop();this.spawnTile(o,n,i,s),n++}}}},{key:"sortDataAndCreateGuideTiles",value:function(e){var t=this.extractLevel(e);this.sortDepth(t);for(var n=0,i=0;i<=this.maxLayer;i++){var a=t.get(i);if(a)for(var r=0;r<a.length;r++){var o=a[r];this.spawnTile(o,n,i,o.skinIdx),n++}}}},{key:"updateAlignObjects",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.size)return!1;var n,i=Number.MAX_VALUE,a=Number.NEGATIVE_INFINITY,r=Number.MAX_VALUE,o=Number.NEGATIVE_INFINITY,s=-1,l=-1,u=-1,c=d(e.entries());try{for(c.s();!(n=c.n()).done;){var h,p=y(n.value,2),f=p[0],v=p[1],g=d(v);try{for(g.s();!(h=g.n()).done;){var m=h.value,b=m.gridPos;b.x<=i&&(i=b.x,f>u&&(u=f)),b.x>a&&(a=b.x),b.y<=r&&(r=b.y,f>l&&(l=f)),b.y>o&&(o=b.y)}}catch(e){g.e(e)}finally{g.f()}f>s&&(s=f)}}catch(e){c.e(e)}finally{c.f()}var S=i-this.minColTiles,w=this.maxColTiles-a,k=r-this.minRowTiles,T=this.maxRowTiles-o,C=this.maxColTiles-this.minColTiles+1,E=this.maxRowTiles-this.minRowTiles+1,L=a-i+1,x=o-r+1,I=t;return!!(I=(I=I||(S>Qe.ZOOM.STEP_COLUMNS||w>Qe.ZOOM.STEP_COLUMNS||k>Qe.ZOOM.STEP_ROWS||T>Qe.ZOOM.STEP_ROWS)&&(C>=Qe.ZOOM.MIN_COLUMNS||E>=Qe.ZOOM.MIN_ROWS))||(S<0||w<0||k<0||T<0)&&(L>=Qe.ZOOM.MIN_COLUMNS||x>=Qe.ZOOM.MIN_ROWS))&&(this.updateTileAlign(i,a,r,o,s,l,u),this.minColTiles=i,this.maxColTiles=a,this.minRowTiles=r,this.maxRowTiles=o,this.maxLayer=s,this.layerOfMostTop=l,this.layerOfMostLeft=u,!0)}},{key:"getTilePosition",value:function(e,t,n){return this.alignManager.getTilePosition(e,t,n)}},{key:"getTileSize",value:function(){return this.alignManager.getTileSize()}},{key:"updateTileAlign",value:function(e,t,n,i,a,r,o){this.alignManager.updateBorders();var s=this.node.getComponent(z);if(s){var l=this.alignManager.getTopBotBorder(),u=l.top,c=l.bottom;s.top=u,s.bottom=c,s.updateAlignment(),this.node.scene.emit($e.GAMEOBJECT_WIDGET_UPDATE,u,c,this.node.position,this.node.worldPosition)}this.alignManager.useParams(e,t,n,i,a,r,o)}},{key:"extractLevel",value:function(e){this.minColTiles=Number.MAX_VALUE,this.maxColTiles=Number.NEGATIVE_INFINITY,this.minRowTiles=Number.MAX_VALUE,this.maxRowTiles=Number.NEGATIVE_INFINITY,this.maxLayer=-1,this.totalTiles=0,this.skinIndexes=[];var t,n=-1,i=-1,a=new Map,r=d(e.layers);try{for(r.s();!(t=r.n()).done;){var o,s=t.value,l=s.index,u=d(s.tiles);try{for(u.s();!(o=u.n()).done;){var c=o.value;c.x<=this.minColTiles&&(this.minColTiles=c.x,l>i&&(i=l)),c.x>this.maxColTiles&&(this.maxColTiles=c.x),c.y<=this.minRowTiles&&(this.minRowTiles=c.y,l>n&&(n=l)),c.y>this.maxRowTiles&&(this.maxRowTiles=c.y),this.totalTiles+=1;var h=a.get(l);if(void 0===h){var p=[c];a.set(l,p)}else h.push(c)}}catch(e){u.e(e)}finally{u.f()}l>this.maxLayer&&(this.maxLayer=l)}}catch(e){r.e(e)}finally{r.f()}return this.layerOfMostLeft=i,this.layerOfMostTop=n,this.updateTileAlign(this.minColTiles,this.maxColTiles,this.minRowTiles,this.maxRowTiles,this.maxLayer,this.layerOfMostTop,this.layerOfMostLeft),a}},{key:"sortDepth",value:function(e){for(var t=0;t<=this.maxLayer;t++){var n=e.get(t);n&&(n.sort((function(e,t){return e.x+e.y===t.x+t.y?t.x-e.x:t.x+t.y-(e.x+e.y)})),n.reverse())}}},{key:"calculateSkinIndexes",value:function(){var e=nt.getSeedByLevel();if(void 0!==e&&e.length>0)this.skinIndexes=e;else{this.skinIndexes=[];for(var t=Math.floor(this.totalTiles/2),n=["bamboo","characters","dots","winds","dragons"],i={bamboo:0,characters:0,dots:0,winds:0,dragons:0},a=0;a<t;a++){var r=n[a%n.length],o=it[r],s=i[r]%o.length;this.skinIndexes.push(o[s]),this.skinIndexes.push(o[s]),i[r]++}console.log("Calculate Skin Indexes",{totalTiles:this.totalTiles,totalPairs:t,skinIndexes:f(this.skinIndexes)}),Ludex.Utils.Array.shuffle(this.skinIndexes)}}},{key:"spawnTile",value:function(e,t,n,i){var a=this.alignManager.getTileSize(),r=this.alignManager.getTilePosition(e.x,e.y,n),o=r.x,s=r.y,l=new j(o,s),u=this.createTileInstance();if(u){u.setPosition(l.x,l.y,0);var c=u.getComponent($f);if(c){var h=Ne.getTileIcon(i.toString()),p=Ne.getCurrentTileBackgroundSprite();c.setBackgroundSprite(p),c.setHiddenBackgroundSprite(Ne.getCurrentTileHiddenSprite()),c.setEffectSprites(),h?c.setItemSprite(h):console.warn("Tile sprite not found for skin index: ".concat(i)),
//! tileComponent.id = tile.skinIdx
c.initializeTile({id:"".concat(n,"-").concat(e.x,"-").concat(e.y),skinProp:{skinIdx:i,isHidden:!1,isTarget:!1},gridPos:new j(e.x,e.y),worldPos:l,layer:n,depth:t,size:{width:a.width,height:a.height}}),this.tiles.push(c),this.node.scene.emit($e.TILE_CREATED,{tile:c,layer:n})}}}},{key:"createTileInstance",value:function(){var e=this.tilePool.getTile();return e instanceof A?(this.node.addChild(e),e):null}},{key:"getShuffleConfig",value:function(){for(var e=I.getVisibleSize().width,t=this.maxRowTiles,n=this.maxColTiles,i=this.minRowTiles,a=this.minColTiles,r=this.alignManager.getTileSize().width,o=1.2,s=t-i+1,l=e-s*(r+2)*o-10;l<0&&o>1;)l=e-s*(r+2)*(o=parseFloat((o-.01).toFixed(2)))-10;var u=this.alignManager.getRemainingBoardHeight(),c=t-i+1,h=c*gd+c*r;return{maxRowTiles:t,maxColTiles:n,minRowTiles:i,minColTiles:a,bonusSpace:2,maxScale:o,offsetHeight:Math.min((u-h)/2/c,5)}}},{key:"getBoardGameObjectsWidth",value:function(){var e;this.uiTransform||(this.uiTransform=this.getComponent(L));var t=I.getVisibleSize().width,n=(null===(e=this.uiTransform)||void 0===e?void 0:e.width)||t;return Math.max(t,n)}},{key:"getBoardGameObjectsHeight",value:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(L)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||I.getVisibleSize().height}}]),l}(k)).prototype,"tilePool",[ay],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ry=oy))||ry);g._RF.pop(),g._RF.push({},"1dbd0oP1L5HP7sKvcwP7rDQ","GameMode",void 0);var py,dy,fy,yy,vy,gy,my,by,Sy,wy,ky,Ty=function(e){return e.SINGLE="single",e.CHALLENGE_FRIEND="challenge-friend",e.TOURNAMENT="tournament",e.SHARE_INVITE="share-invite",e.MATCHING_GROUP="matching-group",e.DAILY_CHALLENGE="daily-challenge",e.JOURNEY="journey",e}(Ty||{});g._RF.pop(),g._RF.push({},"6c472ABbYFGy5TSFcApW8q0","EffectPool",void 0);var Cy,Ey,Ly,xy,Iy,Ay,Ry,Py,_y,Ny=m.ccclass,Oy=m.property,By=(py=Ny("EffectPool"),dy=Oy(q),fy=Oy(q),yy=Oy(q),vy=Oy(q),py((by=e((my=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"blossomExplosionPrefab",by,r(e)),a(e,"bambooExplosionPrefab",Sy,r(e)),a(e,"popupScorePrefab",wy,r(e)),a(e,"shuffleExplosionPrefab",ky,r(e)),e.blossomPool=[],e.bambooPool=[],e.popupScorePool=[],e.shufflePool=[],e.blossomCount=0,e.bambooCount=0,e.popupScoreCount=0,e.shuffleCount=0,e}return o(l,[{key:"getBlossomExplosionEffect",value:function(){if(this.blossomPool.length>0){var e=this.blossomPool.pop();return e.active=!0,console.log("reuse BlossomEffect"),e}var t=K(this.blossomExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(0),t.active=!0,this.blossomCount++,t}},{key:"returnBlossomExplosionEffect",value:function(e){e.active=!1,this.blossomPool.push(e)}},{key:"getBambooExplosionEffect",value:function(){if(this.bambooPool.length>0){var e=this.bambooPool.pop();return e.active=!0,console.log("reuse BambooEffect"),e}var t=K(this.bambooExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+1),t.active=!0,this.bambooCount++,t}},{key:"returnBambooExplosionEffect",value:function(e){e.active=!1,this.bambooPool.push(e)}},{key:"getPopupScoreEffect",value:function(){if(this.popupScorePool.length>0){var e=this.popupScorePool.pop();return e.active=!0,console.log("reuse PopupScoreEffect"),e}var t=K(this.popupScorePrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+this.bambooCount+1),t.active=!0,this.popupScoreCount++,t}},{key:"returnPopupScoreEffect",value:function(e){e.active=!1,this.popupScorePool.push(e)}},{key:"getShuffleExplosionEffect",value:function(){if(this.shufflePool.length>0){var e=this.shufflePool.pop();return e.active=!0,console.log("reuse ShuffleEffect"),e}var t=K(this.shuffleExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+this.bambooCount+this.popupScoreCount+1),t.active=!0,this.shuffleCount++,t}},{key:"returnShuffleExplosionEffect",value:function(e){e.active=!1,this.shufflePool.push(e)}}]),l}(k)).prototype,"blossomExplosionPrefab",[dy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sy=e(my.prototype,"bambooExplosionPrefab",[fy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wy=e(my.prototype,"popupScorePrefab",[yy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ky=e(my.prototype,"shuffleExplosionPrefab",[vy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gy=my))||gy);g._RF.pop(),g._RF.push({},"556ddWVDzZLFZrjY8a9r9K+","BlossomExplosion",void 0);var Dy,Fy,My,zy,Uy,Gy,Hy,Wy=m.ccclass,Vy=m.property,jy=(Cy=Wy("BlossomExplosion"),Ey=Vy(A),Ly=Vy(A),xy=Vy(A),Cy((Ry=e((Ay=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"aura1",Ry,r(e)),a(e,"aura2",Py,r(e)),a(e,"aura3",_y,r(e)),e}return o(h,[{key:"onLoad",value:function(){this._aura1Opacity=this.aura1.getComponent(P),this._aura2Opacity=this.aura2.getComponent(P),this._aura3Opacity=this.aura3.getComponent(P),this._aura1Opacity.opacity=0,this._aura2Opacity.opacity=0,this._aura3Opacity.opacity=0,this.particaleSystem=this.node.getComponentsInChildren(ee)}},{key:"runAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=d(this.particaleSystem);try{for(t.s();!(n=t.n()).done;)n.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}return i=[],a=B(this._aura1Opacity).set({opacity:102}).to(.15,{opacity:204}).to(.3,{opacity:0}),r=B(this._aura2Opacity).set({opacity:80}).to(.15,{opacity:150}).delay(.1).to(.25,{opacity:0}),o=B(this._aura3Opacity).set({opacity:80}).to(.15,{opacity:150}).to(.3,{opacity:0}),s=B(this.aura1).set({scale:new F(.35,.35,1)}).to(.2,{scale:new F(.5,.5,1)}),u=B(this.aura2).set({scale:new F(.2,.2,1)}).to(.2,{scale:new F(.35,.35,1)}).to(1,{scale:new F(1,1,1)}),c=B(this.aura3).set({scale:new F(.5,.5,1)}).to(.2,{scale:new F(.75,.75,1)}).to(1,{scale:new F(1.25,1.25,1)}),i.push(Ve.runTweenAsync(a)),i.push(Ve.runTweenAsync(r)),i.push(Ve.runTweenAsync(o)),i.push(Ve.runTweenAsync(s)),i.push(Ve.runTweenAsync(u)),i.push(Ve.runTweenAsync(c)),e.next=17,Promise.all(i);case 17:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"aura1",[Ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Py=e(Ay.prototype,"aura2",[Ly],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_y=e(Ay.prototype,"aura3",[xy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iy=Ay))||Iy);g._RF.pop(),g._RF.push({},"3005amPw6VHno+aEFYFe7wW","ShuffleExplosion",void 0);var qy,Ky,Yy,Jy,Zy,Xy,Qy,$y,ev,tv,nv,iv,av,rv=m.ccclass,ov=m.property,sv=Ludex.Utils.Time,lv=(Dy=rv("ShuffleExplosion"),Fy=ov(P),My=ov(P),Dy((Gy=e((Uy=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"aura1",Gy,r(e)),a(e,"aura2",Hy,r(e)),e}return o(h,[{key:"onLoad",value:function(){this.aura1.opacity=0,this.aura2.opacity=0,this.aura1.node.setScale(new F(0,0,1)),this.aura2.node.setScale(new F(0,0,1)),this.particaleSystem=this.node.getComponentsInChildren(ee)}},{key:"runAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,f=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=.4,n=sv.sleepAsync(2e3),i=sv.sleepAsync(400).then((function(){var e,t=d(f.particaleSystem);try{for(t.s();!(e=t.n()).done;)e.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}})),a=B(this.aura1.node).set({scale:new F(0,0,0)}).delay(t).to(.8,{scale:new F(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new F(1,1,1)},{easing:"cubicIn"}),r=B(this.aura1).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),o=B(this.aura2.node).set({scale:new F(0,0,0)}).delay(t).to(.8,{scale:new F(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new F(1,1,1)},{easing:"cubicIn"}),s=B(this.aura2).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),u=Ve.runTweenAsync(a),c=Ve.runTweenAsync(r),h=Ve.runTweenAsync(o),p=Ve.runTweenAsync(s),e.next=14,Promise.all([n,u,c,h,p,i]);case 14:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"aura1",[Fy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hy=e(Uy.prototype,"aura2",[My],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zy=Uy))||zy);g._RF.pop(),g._RF.push({},"9b6e5WQHrZGy5ituukEchCN","PopupBlock",void 0);var uv,cv,hv,pv,dv,fv,yv,vv,gv,mv,bv,Sv,wv,kv=m.ccclass,Tv=m.property,Cv=(qy=kv("PopupBlock"),Ky=Tv(X),Yy=Tv(gh),Jy=Tv(A),Zy=Tv(b),qy(($y=e((Qy=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"notificationLabel",$y,r(e)),a(e,"notificationLocalize",ev,r(e)),a(e,"parentNode",tv,r(e)),a(e,"animationComponent",nv,r(e)),a(e,"showClipName",iv,r(e)),a(e,"widthBound",av,r(e)),e}return o(l,[{key:"runShowBlockPopup",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=I.getVisibleSize().width,r=Y.clamp(e.x,a/2-this.widthBound/2,-a/2+this.widthBound/2);this.node.setPosition(new F(r,e.y,e.z)),this.parentNode.active=!0,this.runAnimation(this.showClipName),this.notificationLocalize.key=t?"lockedByAboveTiles":"lockedByLeftAndRight",this.animationComponent.on(b.EventType.FINISHED,(function(){i(),n.animationComponent.off(b.EventType.FINISHED)}))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),l}(k)).prototype,"notificationLabel",[Ky],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ev=e(Qy.prototype,"notificationLocalize",[Yy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tv=e(Qy.prototype,"parentNode",[Jy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nv=e(Qy.prototype,"animationComponent",[Zy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iv=e(Qy.prototype,"showClipName",[Tv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"PopupBlockShow"}}),av=e(Qy.prototype,"widthBound",[Tv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 854}}),Xy=Qy))||Xy);g._RF.pop(),g._RF.push({},"d2b01I9yhhMz4CRKN9ADxGc","AccumulatePopupScore",void 0);var Ev,Lv,xv,Iv,Av,Rv,Pv,_v=m.ccclass,Nv=m.property,Ov=(uv=_v("AccumulatePopupScore"),cv=Nv(X),hv=Nv(D),pv=Nv(D),dv=Nv(D),fv=Nv(D),uv((gv=e((vv=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"accumulatedScoreLabel",gv,r(e)),a(e,"lesserBaseColor",mv,r(e)),a(e,"lesserStrokeColor",bv,r(e)),a(e,"greaterBaseColor",Sv,r(e)),a(e,"greaterStrokeColor",wv,r(e)),e}return o(l,[{key:"setScore",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.accumulatedScoreLabel.string="+".concat(e.toString()),t?(this.accumulatedScoreLabel.color=this.greaterBaseColor,this.accumulatedScoreLabel.outlineColor=this.greaterStrokeColor):(this.accumulatedScoreLabel.color=this.lesserBaseColor,this.accumulatedScoreLabel.outlineColor=this.lesserStrokeColor)}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),l}(k)).prototype,"accumulatedScoreLabel",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=e(vv.prototype,"lesserBaseColor",[hv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,255,255)}}),bv=e(vv.prototype,"lesserStrokeColor",[pv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,0,255)}}),Sv=e(vv.prototype,"greaterBaseColor",[dv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,0,255)}}),wv=e(vv.prototype,"greaterStrokeColor",[fv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,255,0,255)}}),yv=vv))||yv);g._RF.pop(),g._RF.push({},"911aaEDDJxEAqVF2fpI2n1a","EncouragePopupScore",void 0);var Bv,Dv,Fv,Mv,zv,Uv,Gv,Hv,Wv,Vv,jv=m.ccclass,qv=m.property,Kv=(Ev=jv("EncouragePopupScore"),Lv=qv(gh),xv=qv(X),Ev((Rv=e((Av=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"localize",Rv,r(e)),a(e,"scoreLabel",Pv,r(e)),e}return o(l,[{key:"setScore",value:function(e,t){this.scoreLabel.string="+".concat(e.toString()),this.localize.key=t}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),l}(k)).prototype,"localize",[Lv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pv=e(Av.prototype,"scoreLabel",[xv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iv=Av))||Iv);g._RF.pop(),g._RF.push({},"becf1XX8m9DWL2DtyN+gENs","PopupScore",void 0);var Yv,Jv,Zv,Xv,Qv,$v,eg,tg=m.ccclass,ng=m.property,ig=(Bv=tg("PopupScore"),Dv=ng(b),Fv=ng(Ov),Mv=ng(Kv),Bv((Gv=e((Uv=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"animationComponent",Gv,r(e)),a(e,"accumulatePopupScore",Hv,r(e)),a(e,"encouragePopupScore",Wv,r(e)),a(e,"showClipName",Vv,r(e)),e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"runShowScorePopup",value:function(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=t>=3;this.accumulatePopupScore.setScore(e,r);var o=t%5==0;if(o){this.encouragePopupScore.node.active=!0;var s=t/5,l=this.getEncouragePopupScore(s),u=this.getEncouragePopupSound(s);Me.playSound(u),this.encouragePopupScore.setScore(n,l)}else this.encouragePopupScore.node.active=!1;this.runAnimation(this.showClipName),this.animationComponent.on(b.EventType.FINISHED,(function(){a(),i.animationComponent.off(b.EventType.FINISHED)}))}},{key:"getEncouragePopupScore",value:function(e){switch(e){case 1:return"Good";case 2:return"Great";case 3:return"Awesome";default:return"Amazing"}}},{key:"getEncouragePopupSound",value:function(e){switch(e){case 1:return ze.ENCOURAGE_GOOD;case 2:return ze.ENCOURAGE_GREAT;case 3:return ze.ENCOURAGE_AWESOME;default:return ze.ENCOURAGE_AMAZING}}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),l}(k)).prototype,"animationComponent",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hv=e(Uv.prototype,"accumulatePopupScore",[Fv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wv=e(Uv.prototype,"encouragePopupScore",[Mv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vv=e(Uv.prototype,"showClipName",[ng],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"PopupScoreShow"}}),zv=Uv))||zv);g._RF.pop(),g._RF.push({},"1a5d7W8yYxJuL/wRCNNmZF5","EffectManager",void 0);var ag,rg=m.ccclass,og=m.property,sg=(Yv=rg("EffectManager"),Jv=og(By),Zv=og(Cv),Yv(($v=e((Qv=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"effectPool",$v,r(e)),a(e,"popupBlock",eg,r(e)),e}return o(p,[{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.node.scene.on($e.START_SHUFFLE,this.playShuffleExplosionEffect,this)}},{key:"playTileMatchEffect",value:function(e,t,n,i){this.playMatchExplosionEffect(n,e),this.playPopupScoreEffect(e,t,n,i)}},{key:"playMatchExplosionEffect",value:function(e,t){var n,i,a=this,r=null;if(e<3)(r=null===(n=this.effectPool)||void 0===n?void 0:n.getBambooExplosionEffect())&&(r.setWorldPosition(t),null===(i=r.getComponent(jy))||void 0===i||i.runAnimation());else if(e>=3){var o,s;if(r=null===(o=this.effectPool)||void 0===o?void 0:o.getBlossomExplosionEffect())r.setWorldPosition(t),null===(s=r.getComponent(jy))||void 0===s||s.runAnimation()}Kr.vibrate(60),this.scheduleOnce((function(){var t;if(e<3)null===(t=a.effectPool)||void 0===t||t.returnBambooExplosionEffect(r);else if(e>=3){var n;null===(n=a.effectPool)||void 0===n||n.returnBlossomExplosionEffect(r)}}),2)}},{key:"playPopupScoreEffect",value:function(e,t,n,i){var a,r=this,o=null;if(o=null===(a=this.effectPool)||void 0===a?void 0:a.getPopupScoreEffect()){o.setWorldPosition(e);var s=o.getComponent(ig);s&&s.runShowScorePopup(t,n,i,(function(){var e;null===(e=r.effectPool)||void 0===e||e.returnPopupScoreEffect(o)}))}}},{key:"playShuffleExplosionEffect",value:(c=s(l().mark((function e(){var t,n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(t=this.effectPool)||void 0===t?void 0:t.getShuffleExplosionEffect(),Kr.vibrate(200),!n){e.next=7;break}return n.setPosition(new F(0,0,0)),e.next=6,null===(i=n.getComponent(lv))||void 0===i?void 0:i.runAnimation();case 6:null===(a=this.effectPool)||void 0===a||a.returnShuffleExplosionEffect(n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"playTileBlockedEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.popupBlock&&this.popupBlock.runShowBlockPopup(e,t),Kr.vibrate(100)}},{key:"playGameOverEffect",value:(u=s(l().mark((function e(t){var n,i,a,r=this,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=o.length>1&&void 0!==o[1]?o[1]:.8,i=d(t);try{for(i.s();!(a=i.n()).done;)a.value.animationHandler.toggleCoverAnimations(!1,n)}catch(e){i.e(e)}finally{i.f()}return at.setBlockInput(!0),e.next=6,new Promise((function(e){r.scheduleOnce((function(){at.setBlockInput(!1),e(!0)}),n)}));case 6:Me.playSound(ze.YOU_LOSE);case 7:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})}]),p}(k)).prototype,"effectPool",[Jv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),eg=e(Qv.prototype,"popupBlock",[Zv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xv=Qv))||Xv);g._RF.pop(),g._RF.push({},"accd9Z7tWxAY7VJKEjCMc4f","GameModeManager",void 0);var lg=m.ccclass,ug=codex.match,cg=lg("GameModeManager")(ag=function(){function e(){i(this,e),this.gameMode=Ty.SINGLE,this.runLeaderUpdate=function(){},this.updateLeaderScores=function(){}}var t,n,a,r;return o(e,[{key:"gameplay",get:function(){return this._gameplay}},{key:"init",value:function(e){this._gameplay=e}},{key:"start",value:(r=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ug.getMatchState(),n=t.mode,t.customData,console.log(" ? Start game with mode:",n),this.gameMode=n||Ty.SINGLE,e.t0=this.gameMode,e.next=e.t0===Ty.SINGLE?6:e.t0===Ty.TOURNAMENT?8:e.t0===Ty.CHALLENGE_FRIEND?10:13;break;case 6:return this.startSingleMode(),e.abrupt("break",15);case 8:return this.startTournamentMode(),e.abrupt("break",15);case 10:return e.next=12,this.startChallengeMode();case 12:return e.abrupt("break",15);case 13:this.stopChallengeMode(),this.stopTournamentMode();case 15:i=rt.getSpecialMode(),e.t1=i,e.next=e.t1===ot.JOURNEY?19:21;break;case 19:return this.startJourneyMode(),e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"stop",value:function(){switch(console.log(" ? Stop game with mode:",this.gameMode),this.gameMode){case Ty.SINGLE:this.stopSingleMode();break;case Ty.TOURNAMENT:this.stopTournamentMode();break;case Ty.CHALLENGE_FRIEND:this.stopChallengeMode()}}},{key:"setGameMode",value:function(e){this.gameMode=e}},{key:"startSingleMode",value:function(){this._gameplay.uiManager.enableSingleUI()}},{key:"stopSingleMode",value:function(){}},{key:"startTournamentMode",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._gameplay.uiManager.enableSingleUI();case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"updateTournamentInfo",value:(n=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"stopTournamentMode",value:function(){}},{key:"startChallengeMode",value:(t=s(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._gameplay.uiManager.enableChallengeUI(),e.abrupt("return",new Promise((function(e){var n=t._gameplay.uiManager.challengePrepare;n?n.runAnimationPrepareChallenge().then((function(){e()})):e()})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopChallengeMode",value:function(){this._gameplay.uiManager.enableSingleUI()}},{key:"startJourneyMode",value:function(){this._gameplay.uiManager.enableJourneyUI()}},{key:"getGameMode",value:function(){return rt.getSpecialMode()===ot.DAILY_CHALLENGE?Ty.DAILY_CHALLENGE:rt.getSpecialMode()===ot.JOURNEY?Ty.JOURNEY:this.gameMode}}]),e}())||ag;g._RF.pop(),g._RF.push({},"f994dPKg1JFYrdGUFjPYMfw","LimitAdsUtils",void 0);var hg=18e5,pg=3,dg=3,fg=function(){function e(){i(this,e)}return o(e,[{key:"updatePlayerData",value:function(){var e={shuffleItem:this.shuffleItem,hintItem:this.hintItem,lastWatchedAdTime:this.lastWatchedAdTime};codex.player.setGameData({limitAds:e})}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:function(){var e=codex.player.getPlayerData().gameData,t=e.limitAds,n=e.lastLoginTime;this.inst.shuffleItem=t.shuffleItem||0,this.inst.hintItem=t.hintItem||0,this.inst.lastWatchedAdTime=t.lastWatchedAdTime||0,st(n)||(this.inst.shuffleItem=0,this.inst.hintItem=0),this.inst.updatePlayerData()}},{key:"getCurrentWatchedAds",value:function(e){switch(e){case"shuffleItem":return this.inst.shuffleItem;case"hintItem":return this.inst.hintItem;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),0}}},{key:"getMaxWatchedAds",value:function(e){switch(e){case"shuffleItem":return pg;case"hintItem":return dg;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),1}}},{key:"canWatchAds",value:function(e){var t=3;switch(e){case"shop":return 0===this.getTimeLeftToWatchAdsInShop();case"shuffleItem":return t=pg,this.inst.shuffleItem<t;case"hintItem":return t=dg,this.inst.hintItem<t;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),!1}}},{key:"watchedAds",value:function(e){if(this.canWatchAds(e)){switch(e){case"shop":this.inst.lastWatchedAdTime=Date.now();break;case"shuffleItem":this.inst.shuffleItem+=1;break;case"hintItem":this.inst.hintItem+=1;break;default:return void console.warn("LimitAdsUtils: Unknown ad type: ".concat(e))}this.inst.updatePlayerData()}else console.warn('LimitAdsUtils: User watched a "'.concat(e,'" ad even though the daily limit had been reached.'))}},{key:"getTimeLeftToWatchAdsInShop",value:function(){var e=Date.now()-this.inst.lastWatchedAdTime,t=hg-e;return Math.max(0,t)}}]),e}();g._RF.pop(),g._RF.push({},"f641eB0fUxMaYiL+EvVDXM4","SDKFeatureUtils",void 0);var yg=function(){function e(){i(this,e)}return o(e,null,[{key:"isTournamentFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isPlayWithFriendFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isIAPFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isFBPageFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}}]),e}();g._RF.pop(),g._RF.push({},"a10d7laB6BNeK6o1AAs+jo5","ShuffleHandler",void 0);var vg,gg,mg,bg,Sg,wg,kg,Tg=function(){function e(){i(this,e),this.id="",this.gridPos=new j(0,0),this.layer=0,this.isUncovered=!0,this.isInPool=!0}return o(e,[{key:"init",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isUncovered=!0,this.id=e,this.gridPos=t,this.layer=n,this.skinProp={skinIdx:1,isHidden:i,isTarget:a,isArtifact:r}}}]),e}(),Cg=function(){function e(){i(this,e),this.pool=[],this.layerTileMap=new Map,this.tilesOnBoard=[],this.maxLayer=0,this.shuffleSeed=[]}var t;return o(e,[{key:"reset",value:function(){var e,t=d(this.tilesOnBoard);try{for(t.s();!(e=t.n()).done;){e.value.isInPool=!0}}catch(e){t.e(e)}finally{t.f()}var n,i=d(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a,r=n.value,o=d(r);try{for(o.s();!(a=o.n()).done;){a.value.isInPool=!0}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}this.layerTileMap.clear(),this.tilesOnBoard=[],this.maxLayer=0,this.shuffleSeed=[]}},{key:"prepareShuffleTiles",value:function(e){var t=this;this.reset(),this.setupTiles(e);var n,i=new Map,a=d(this.tilesOnBoard);try{for(a.s();!(n=a.n()).done;){var r=n.value;i.set(r.id,r.skinProp)}}catch(e){a.e(e)}finally{a.f()}for(var o=e.map((function(e){return{skinIdx:e.skinIdx,isHidden:e.isHidden,isTarget:e.isTarget,isArtifact:e.isArtifact}})),s=!0,l=0;l<3;l++){0!==l&&(this.reset(),this.setupTiles(e));var u=f(o);Ludex.Utils.Array.shuffle(u);for(var c=function(){var e=t.getUncoveredTiles();if(e.length<2)return console.log("Not enough uncovered tiles",e.length),s=!1,0;Ludex.Utils.Array.shuffle(e);for(var n=e[0],a=e[1],r=u[0];r.isArtifact;)u.splice(0,1),r=u[0];var o=u.find((function(e,n){return 0!==n&&t.canMatchSkinIndices(r.skinIdx,e.skinIdx)}));if(void 0===o)return console.log("No matching pair found in rawSeed"),s=!1,0;var l=u.indexOf(o,1);u.splice(Math.max(0,l),1),u.splice(Math.min(0,l),1),n.skinProp=r,a.skinProp=o,i.set(n.id,n.skinProp),i.set(a.id,a.skinProp),t.handleTileDestroyed(n),t.handleTileDestroyed(a),t.updateTilesState()};this.tilesOnBoard.length>0&&0!==c(););if(0===this.tilesOnBoard.length){s=!0,console.log("isCanShuffle",s,"tryTimes",l+1);break}}if(!s)return!1;var h=Array.from(i.values());return h.length!==e.length?(console.log("New seed length does not match current tiles length",h.length,e.length),!1):(this.shuffleSeed=h,!0)}},{key:"getShuffleSeed",value:function(){return this.shuffleSeed}},{key:"handleTileDestroyed",value:function(e){var t=this.tilesOnBoard.indexOf(e);-1!==t&&this.tilesOnBoard.splice(t,1);var n,i=d(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a=n.value,r=a.indexOf(e);if(-1!==r){a.splice(r,1);break}}}catch(e){i.e(e)}finally{i.f()}e.isInPool=!0}},{key:"canMatchSkinIndices",value:function(e,t){if(e===t)return!0;var n=it.flowers.includes(e),i=it.flowers.includes(t);if(n&&i)return!0;var a=it.seasons.includes(e),r=it.seasons.includes(t);return!(!a||!r)}},{key:"getUncoveredTiles",value:function(){var e,t=[],n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=d(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered&&t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"setupTiles",value:function(e){var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value,r=this.getTile(),o=a.getLayer();if(r.init(a.id,a.gridPos,o,a.isHidden,a.isTarget,a.isArtifact),this.maxLayer=Math.max(this.maxLayer,o),this.layerTileMap.has(o))null===(i=this.layerTileMap.get(o))||void 0===i||i.push(r);else this.layerTileMap.set(o,[r])}}catch(e){n.e(e)}finally{n.f()}this.handleTilesCreated()}},{key:"handleTilesCreated",value:(t=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sortLayersByKey(),this.updateTilesState();case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"updateTilesState",value:function(){this.updateLowerLayersVisibility(),this.destroyArtifactTiles()}},{key:"updateLowerLayersVisibility",value:function(){for(var e=this.maxLayer;e>=0;e--)this.updateTilesInLayer(e)}},{key:"destroyArtifactTiles",value:function(){var e,t=!1,n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=d(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.skinProp.isArtifact&&o.isUncovered&&(this.handleTileDestroyed(o),t=!0)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}t&&this.updateTilesState()}},{key:"updateTilesInLayer",value:function(e){var t,n=this.layerTileMap.get(e)||[],i=d(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a){var r=this.isTileOverlappedByUpperLayers(a,e),o=this.isTileBlockedBySides(a,e),s=!r&&!o;a.isUncovered=s}}}catch(e){i.e(e)}finally{i.f()}}},{key:"isTileOverlappedByUpperLayers",value:function(e,t){for(var n=this,i=t+1;i<=this.maxLayer;i++){if((this.layerTileMap.get(i)||[]).some((function(t){return n.isOverlapped(e.gridPos,t.gridPos)})))return!0}return!1}},{key:"isTileBlockedBySides",value:function(e,t){var n=this.layerTileMap.get(t)||[];return this.isBlockedOnLeft(e,n)&&this.isBlockedOnRight(e,n)}},{key:"isBlockedOnLeft",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnLeft(t,e)}))}},{key:"isTileOnLeft",value:function(e,t){return e.gridPos.x<t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isBlockedOnRight",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnRight(t,e)}))}},{key:"isTileOnRight",value:function(e,t){return e.gridPos.x>t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isOverlapped",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n<1&&n>=0&&i<1&&i>=0||n>-1&&n<=0&&i>-1&&i<=0||n<1&&n>=0&&i>-1&&i<=0||n>-1&&n<=0&&i<1&&i>=0}},{key:"sortLayersByKey",value:function(){for(var e=0;e<=this.maxLayer;e++){var t=this.layerTileMap.get(e);t&&(t.sort((function(e,t){return e.gridPos.x+e.gridPos.y===t.gridPos.x+t.gridPos.y?t.gridPos.x-e.gridPos.x:t.gridPos.x+t.gridPos.y-(e.gridPos.x+e.gridPos.y)})),t.reverse())}for(var n=0;n<=this.maxLayer;n++){var i=this.layerTileMap.get(n);if(i){var a,r=d(i);try{for(r.s();!(a=r.n()).done;){var o=a.value;this.tilesOnBoard.includes(o)||this.tilesOnBoard.push(o)}}catch(e){r.e(e)}finally{r.f()}}}}},{key:"getTile",value:function(){var e,t=d(this.pool);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.isInPool)return n.isInPool=!1,n}}catch(e){t.e(e)}finally{t.f()}var i=new Tg;return this.pool.push(i),i.isInPool=!1,i}}]),e}();g._RF.pop(),g._RF.push({},"712e3ncnN9O/I8hOJtbnCMr","TileManager",void 0);var Eg,Lg,xg,Ig,Ag,Rg=m.ccclass,Pg=m.property,_g=Ludex.Utils.Time,Ng=(vg=Rg("TileManager"),gg=Pg([ae]),mg=Pg(A),vg((wg=e((Sg=function(e){t(P,e);var u,c,h,p,v,g,m,b,S,w,k,T,C,E,x,A,R=n(P);function P(){var e;i(this,P);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=R.call.apply(R,[this].concat(n)),a(e,"specialTileSprites",wg,r(e)),a(e,"parentNode",kg,r(e)),e.layerTileMap=new Map,e.tilesOnBoard=[],e.maxLayer=0,e.choosingTile=null,e.numberOfMatchPairs=0,e.hintTiles=[],e.canUndoPair=[],e.matchedPairCount=0,e.matchedPairFailedCount=0,e.totalPairCount=0,e.isAutoFinishing=!1,e}return o(P,[{key:"getTilesOnBoard",value:function(){return this.tilesOnBoard}},{key:"getNumberOfMatchPairs",value:function(){return this.numberOfMatchPairs}},{key:"getNumberOfCanUndoPair",value:function(){return this.canUndoPair.length}},{key:"getLengthTilesOnBoard",value:function(){return this.tilesOnBoard.length}},{key:"getGoldenTileSprite",value:function(){return this.specialTileSprites[0]}},{key:"getLeftoverPairCount",value:function(){var e,t=0,n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){t+=e.value.length}}catch(e){n.e(e)}finally{n.f()}return t/2}},{key:"getMatchedPairCount",value:function(){return this.matchedPairCount}},{key:"getMatchedPairFailedCount",value:function(){return this.matchedPairFailedCount}},{key:"getTotalPairCount",value:function(){return this.totalPairCount}},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents(),this.validateRequiredComponents(),this.shuffleHandler=new Cg}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on($e.TILE_CREATED,this.handleTileCreated,this),e.on($e.TILE_CLICKED,this.handleTileClicked,this),e.on($e.TILE_MOVING,this.handleTileMoving,this),e.on($e.TILE_DROPPED,this.handleTileDropped,this),e.on($e.TILE_COVERED_CLICKED,this.handleTileCoveredClicked,this),e.on($e.TILE_DESTROYED,this.handleTileDestroyed,this),e.on($e.TILE_START_SORT,this.sortOrderTiles,this),e.on($e.TILE_RELEASE,this.handleReleaseTile,this),e.on($e.AUTO_ZOOM_UPDATE,this.handleUpdateZoom,this)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"handleTilesCreated",value:(A=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sortLayersByKey(),this.updateTilesState(),e.next=4,this.playOpenTilesAnimation();case 4:this.initializeTiles(),this.updateTilesCoveredState(),this.node.scene.emit($e.ALL_TILE_READY);case 7:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"reopenTiles",value:(x=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playOpenTilesAnimation(!0);case 2:this.initializeTiles(),this.updateTileToReadyState();case 4:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"updateTilesCoveredState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=codex.player.getPlayerSettings().highLight;if(t||e){var n,i=d(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a,r=n.value,o=d(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;t?s.animationHandler.toggleCoverAnimations(s.isUncovered,.3):s.animationHandler.toggleCoverAnimations(!0,.3)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}}}},{key:"updateTileToReadyState",value:function(){var e,t=d(this.layerTileMap.values());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=d(i);try{for(a.s();!(n=a.n()).done;){n.value.state=Xe.ALREADY}}catch(e){a.e(e)}finally{a.f()}}}catch(e){t.e(e)}finally{t.f()}this.gameScene.gameplay.handleAllTileReady()}},{key:"playOpenTilesAnimation",value:(E=s(l().mark((function e(){var t,n=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],this.sortOrderTiles(),!Oe.isLandscape()){e.next=7;break}return e.next=5,this.playOpenTilesLandscapeAnimation(t);case 5:e.next=9;break;case 7:return e.next=9,this.playOpenTilesPortraitAnimation(t);case 9:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"playOpenTilesLandscapeAnimation",value:(C=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=this.layerTileMap.size)){e.next=4;break}return e.abrupt("return");case 4:n=Math.min(Qe.ANIMATION_CONFIGS.OPEN_DURATION.LANDSCAPE_TOTAL/t,.3),i=Qe.ANIMATION_CONFIGS.OPEN_DURATION.INIT_DELAY,a=[],r=0,o=d(this.layerTileMap.values());try{for(o.s();!(s=o.n()).done;){u=s.value,c=n*r+i,h=d(u);try{for(h.s();!(p=h.n()).done;)f=p.value,a.push(f.animationHandler.playTileOpenAnimation(n,c,new F(f.worldPos.x,f.worldPos.y,0),!0))}catch(e){h.e(e)}finally{h.f()}r++}}catch(e){o.e(e)}finally{o.f()}return _g.sleepAsync(1e3*i).then((function(){Me.playSound(ze.TILE_SHOW)})),e.next=13,Promise.all(a);case 13:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"playOpenTilesPortraitAnimation",value:(T=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,f,y,v,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=0,i=this.getCenterPosition(),a=this.sortTilesByDistance(i),r=I.getVisibleSize().width,o=Qe.ANIMATION_CONFIGS.OPEN_DURATION.INIT_DELAY,s=Qe.ANIMATION_CONFIGS.OPEN_DURATION.MAX_DELAY/a.length,u=d(a);try{for(u.s();!(c=u.n()).done;)h=c.value,p=s*n+o,f=i.x<h.worldPos.x?r:-r,y=Qe.ANIMATION_CONFIGS.OPEN_DURATION.MIN_PORTRAIT_TOTAL,v=Qe.ANIMATION_CONFIGS.OPEN_DURATION.MAX_PORTRAIT_TOTAL,g=y+Math.random()*(v-y),t.push(h.animationHandler.playTileOpenAnimation(g,p,new F(f,h.worldPos.y,0),!1)),n++}catch(e){u.e(e)}finally{u.f()}return _g.sleepAsync(1e3*o).then((function(){Me.playSound(ze.TILE_SHOW)})),e.next=13,Promise.all(t);case 13:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"sortTilesByDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j(0,0),t=this.getAllTiles();return 0===t.length?[]:(t.sort((function(t,n){var i=t.worldPos.x-e.x,a=t.worldPos.y-e.y,r=n.worldPos.x-e.x,o=n.worldPos.y-e.y;return i*i+a*a-(r*r+o*o)})),t)}},{key:"getCenterPosition",value:function(){var e=this.getAllTiles();if(0===e.length)return new j(0,0);var t,n=0,i=0,a=d(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n+=r.worldPos.x,i+=r.worldPos.y}}catch(e){a.e(e)}finally{a.f()}return new j(n/e.length,i/e.length)}},{key:"initializeTiles",value:function(){var e,t=d(this.layerTileMap.values());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=d(i);try{for(a.s();!(n=a.n()).done;){n.value.handleInitializeTile()}}catch(e){a.e(e)}finally{a.f()}}}catch(e){t.e(e)}finally{t.f()}this.matchedPairCount=0,this.matchedPairFailedCount=0,this.totalPairCount=this.getLeftoverPairCount()}},{key:"updateTilesState",value:function(){this.updateLowerLayersVisibility(),this.calculateNumberOfMatchPairs(),this.node.scene.emit($e.TILES_STATE_UPDATED)}},{key:"handleUpdateZoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isAutoFinishing){var t=codex.player.getPlayerSettings().autoZoom;if(t){var n=this.gameScene.gameplay.gameObjects,i=n.updateAlignObjects(this.layerTileMap,e);if(i){var a,r=n.getTileSize(),o=d(this.layerTileMap.values());try{for(o.s();!(a=o.n()).done;){var s,l=a.value,u=d(l);try{for(u.s();!(s=u.n()).done;){var c=s.value,h=n.getTilePosition(c.gridPos.x,c.gridPos.y,c.getLayer()),p=h.x,f=h.y;c.worldPos=new j(p,f),c.setSize(r.width,r.height,!1),c.animationHandler.playTileZoomAnim()}}catch(e){u.e(e)}finally{u.f()}}}catch(e){o.e(e)}finally{o.f()}}}}}},{key:"updateLowerLayersVisibility",value:function(){for(var e=this.maxLayer;e>=0;e--)this.updateTilesInLayer(e)}},{key:"updateTilesInLayer",value:function(e){var t,n=this.layerTileMap.get(e)||[],i=d(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a){var r=this.isTileOverlappedByUpperLayers(a,e),o=this.isTileBlockedBySides(a,e),s=!r&&!o;a.setUncover(s),s&&a.toggleUncover(s)}}}catch(e){i.e(e)}finally{i.f()}}},{key:"handleTileClicked",value:function(e){if(!this.choosingTile)return this.choosingTile=e,this.handleChooseTile(e),Me.playSound(ze.TILE_CLICK),void Kr.vibrate(45);this.compareWithChoosingTile(e)}},{key:"handleTileMoving",value:function(e){if(!this.choosingTile)return this.choosingTile=e,this.handleChooseTile(e),void Kr.vibrate(45);this.choosingTile===e||this.compareWithChoosingTile(e)}},{key:"handleTileDropped",value:(k=s(l().mark((function e(t){var n,i,a,r,o,s,u,c,h,p,d,f=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.choosingTile=t,n=.85,i=t.node.getComponent(L),(a=i.getBoundingBoxToWorld()).width*=n,a.height*=n,r=this.getAllTiles().filter((function(e){var i=e.node.getComponent(L);if(!i)return!1;var r=i.getBoundingBoxToWorld();return r.width*=n,r.height*=n,a.intersects(r)&&e!==t&&e.state===Xe.ALREADY&&!f.isTileCompletelyOverlappedByUpperLayers(e,e.getLayer())})),o=r.filter((function(e){return f.checkTilesMatched(t,e)})),s=o.filter((function(e){return e.isUncovered})),u=o.filter((function(e){return!e.isUncovered})),!(o.length>0)){e.next=31;break}if(!(s.length>0)){e.next=20;break}return c=s[0],Me.playSound(ze.TILE_CLICK),Kr.vibrate(45),this.handleTwoTilesMatched(this.choosingTile,c),this.choosingTile=null,this.updateTilesState(),this.handleUpdateZoom(),e.abrupt("return");case 20:if(!(u.length>0)){e.next=31;break}if(h=u[0],p=this.getTilesOverlappedByUpperLayers(h,h.getLayer()),d=this.getTilesBlockedBySides(h,h.getLayer()),!p.includes(this.choosingTile)&&!d.includes(this.choosingTile)){e.next=30;break}return e.next=27,this.handleChooseTile(t);case 27:return this.node.scene.emit($e.TILE_START_SORT),this.handleTileCoveredClicked(h),e.abrupt("return");case 30:this.handleTileCoveredClicked(h);case 31:return e.next=33,this.handleChooseTile(t);case 33:this.node.scene.emit($e.TILE_START_SORT);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"handleChooseTile",value:(w=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.isBlockedOnLeft(t,this.layerTileMap.get(t.getLayer())||[]),i=this.isBlockedOnRight(t,this.layerTileMap.get(t.getLayer())||[]),e.next=4,t.handleChooseTile(n,i);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"handleTileCoveredClicked",value:function(e){var t=this.getTilesOverlappedByUpperLayers(e,e.getLayer()),n=this.getTilesBlockedBySides(e,e.getLayer()),i=t.length>0,a=n.length>0;if(i||a){var r=e.node.position;this.node.scene.emit($e.TILE_BLOCKED,r,i,a);var o,s=d(t);try{for(s.s();!(o=s.n()).done;){o.value.animationHandler.playTileShakeAnim()}}catch(e){s.e(e)}finally{s.f()}var l,u=d(n);try{for(u.s();!(l=u.n()).done;){l.value.animationHandler.playTileShakeAnim()}}catch(e){u.e(e)}finally{u.f()}}e.animationHandler.playTileShakeAnim(),e.animationHandler.toggleCoverAnimations(!1,.3),this.matchedPairFailedCount++,Me.playSound(ze.TILE_DESELECT)}},{key:"compareWithChoosingTile",value:function(e){if(this.choosingTile)return this.choosingTile===e?(this.choosingTile.handleUnChooseTile(),void(this.choosingTile=null)):void(this.checkTilesMatched(this.choosingTile,e)?(Me.playSound(ze.TILE_CLICK),Kr.vibrate(45),this.handleTwoTilesMatched(this.choosingTile,e),this.choosingTile=null,this.updateTilesState(),this.handleUpdateZoom()):(this.choosingTile.handleUnChooseTile(),this.choosingTile=e,this.handleChooseTile(e),Me.playSound(ze.TILE_CLICK),Kr.vibrate(45)))}},{key:"handleTwoTilesMatched",value:(S=s(l().mark((function e(t,n){var i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hintTiles.includes(t)||this.hintTiles.includes(n)){i=d(this.hintTiles);try{for(i.s();!(a=i.n()).done;)a.value.animationHandler.playTileStopHintAnim()}catch(e){i.e(e)}finally{i.f()}this.hintTiles=[],this.node.scene.emit($e.HIDE_HINT)}return this.removeTile(t),this.removeTile(n),this.canUndoPair.push([t.getCurrentTileConfig(),n.getCurrentTileConfig()]),this.matchedPairCount++,e.next=7,this.playMatchAnimation(t,n);case 7:this.destroyMatchedTiles(t),this.destroyMatchedTiles(n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"handleTileCollect",value:(b=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.canUndoPair=[],this.removeTile(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"checkTilesMatched",value:function(e,t){if(e.skinIdx===t.skinIdx)return!0;var n=it.flowers,i=it.seasons;return!(!n.includes(e.skinIdx)||!n.includes(t.skinIdx))||!(!i.includes(e.skinIdx)||!i.includes(t.skinIdx))}},{key:"getGroupKeyBySkinIdx",value:function(e){return it.flowers.includes(e)?"flower":it.seasons.includes(e)?"season":e.toString()}},{key:"calculateCenterPosition",value:function(e,t){return new F((e.x+t.x)/2,(e.y+t.y)/2)}},{key:"playMatchAnimation",value:(m=s(l().mark((function e(t,n){var i,a,r,o,s,u,c,h,p,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state=Xe.MOVING_TO_MATCH,n.state=Xe.MOVING_TO_MATCH,i=this.calculateCenterPosition(t.node.position,n.node.position),a=t.node.position.clone(),r=n.node.position.clone(),o=this.getIsMatchLeftOrRightX(a,i),s=-o,t.node.getSiblingIndex()<n.node.getSiblingIndex()?(t.node.setSiblingIndex(t.node.parent.children.length-1),n.node.setSiblingIndex(n.node.parent.children.length-1)):(n.node.setSiblingIndex(n.node.parent.children.length-1),t.node.setSiblingIndex(t.node.parent.children.length-1)),u=[ze.TILE_MATCH_1,ze.TILE_MATCH_2,ze.TILE_MATCH_3,ze.TILE_MATCH_4,ze.TILE_MATCH_5],c=Math.floor(Math.random()*u.length),h=[t.animationHandler.playTileMoveToMatchPosition(i,a,o),n.animationHandler.playTileMoveToMatchPosition(i,r,s),_g.sleepAsync(400).then((function(){Me.playSound(u[c])}))],p=[t.animationHandler.playTileDestroyingAnim(i,o),n.animationHandler.playTileDestroyingAnim(i,s)],e.next=14,Promise.all(h);case 14:return-1===o?(t.node.setSiblingIndex(t.node.parent.children.length-1),n.node.setSiblingIndex(n.node.parent.children.length-1)):(n.node.setSiblingIndex(n.node.parent.children.length-1),t.node.setSiblingIndex(t.node.parent.children.length-1)),t.state=Xe.MATCHED,n.state=Xe.MATCHED,d=this.calculateCenterPosition(t.node.worldPosition,n.node.worldPosition),this.node.scene.emit($e.TWO_TILES_MATCHED,{tile1:t,tile2:n,worldCenterPosition:d}),e.next=21,Promise.all(p);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"getIsMatchLeftOrRightX",value:function(e,t){var n=t.x-e.x;return 0===n?-1:n<0?1:-1}},{key:"destroyMatchedTiles",value:function(e){e.state=Xe.DESTROYED,e.returnToPool(),this.node.scene.emit($e.TILE_DESTROYED,e)}},{key:"isTileOverlappedByUpperLayers",value:function(e,t){for(var n=this,i=t+1;i<=this.maxLayer;i++){if((this.layerTileMap.get(i)||[]).some((function(t){return n.isOverlapped(e.gridPos,t.gridPos)})))return!0}return!1}},{key:"isTileCompletelyOverlappedByUpperLayers",value:function(e,t){for(var n=!1,i=!1,a=!1,r=!1,o=t+1;o<=this.maxLayer;o++){var s,l=this.layerTileMap.get(o)||[],u=d(l);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(this.isOverlapped(e.gridPos,c.gridPos)){var h=c.gridPos.x-e.gridPos.x,p=c.gridPos.y-e.gridPos.y;h<=0&&p<=0&&(n=!0),h>=0&&p<=0&&(i=!0),h<=0&&p>=0&&(a=!0),h>=0&&p>=0&&(r=!0)}}}catch(e){u.e(e)}finally{u.f()}}return!!(n&&i&&a&&r)}},{key:"isTileBlockedBySides",value:function(e,t){var n=this.layerTileMap.get(t)||[];return this.isBlockedOnLeft(e,n)&&this.isBlockedOnRight(e,n)}},{key:"getTilesOverlappedByUpperLayers",value:function(e,t){var n=this;return(this.layerTileMap.get(t+1)||[]).filter((function(t){return n.isOverlapped(e.gridPos,t.gridPos)}))}},{key:"getTilesBlockedBySides",value:function(e,t){var n=this,i=[],a=this.layerTileMap.get(t)||[];return i.push.apply(i,f(a.filter((function(t){return n.isTileOnLeft(t,e)||n.isTileOnRight(t,e)})))),i}},{key:"isBlockedOnLeft",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnLeft(t,e)}))}},{key:"isTileOnLeft",value:function(e,t){return e.gridPos.x<t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isBlockedOnRight",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnRight(t,e)}))}},{key:"isTileOnRight",value:function(e,t){return e.gridPos.x>t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isOverlapped",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n<1&&n>=0&&i<1&&i>=0||n>-1&&n<=0&&i>-1&&i<=0||n<1&&n>=0&&i>-1&&i<=0||n>-1&&n<=0&&i<1&&i>=0}},{key:"removeTile",value:function(e){var t,n=d(this.layerTileMap.values());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.indexOf(e);if(-1!==a){i.splice(a,1);break}}}catch(e){n.e(e)}finally{n.f()}}},{key:"sortLayersByKey",value:function(){var e=Array.from(this.layerTileMap.entries()).sort((function(e,t){var n=y(e,1)[0],i=y(t,1)[0];return Number(n)-Number(i)}));this.layerTileMap=new Map(e)}},{key:"clearTiles",value:function(){var e,t=d(this.tilesOnBoard);try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&n.returnToPool()}}catch(e){t.e(e)}finally{t.f()}this.layerTileMap=new Map,this.tilesOnBoard=[],this.maxLayer=0,this.choosingTile=null,this.numberOfMatchPairs=0,this.hintTiles=[],this.canUndoPair=[],this.isAutoFinishing=!1}},{key:"handleShuffle",value:(g=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.choosingTile&&(this.choosingTile.handleUnChooseTile(),this.choosingTile=null),0!==this.hintTiles.length){t=d(this.hintTiles);try{for(t.s();!(n=t.n()).done;)n.value.animationHandler.playTileStopHintAnim()}catch(e){t.e(e)}finally{t.f()}this.hintTiles=[],this.node.scene.emit($e.HIDE_HINT)}if(this.canUndoPair=[],i=this.getAllTiles(),this.shuffleHandler.prepareShuffleTiles(f(i))){e.next=9;break}return this.gameScene.gameplay.logCantShuffle(),this.node.scene.emit($e.ALL_TILE_COVERED),e.abrupt("return");case 9:a=this.shuffleHandler.getShuffleSeed(),r=this.gameScene.gameplay.gameObjects.getShuffleConfig(),o=d(i);try{for(o.s();!(s=o.n()).done;)s.value.state=Xe.PRELOADING}catch(e){o.e(e)}finally{o.f()}return e.next=15,this.playShuffleAnimation(i,a,r);case 15:u=d(i);try{for(u.s();!(c=u.n()).done;)c.value.state=Xe.ALREADY}catch(e){u.e(e)}finally{u.f()}this.updateTilesState(),this.updateTilesCoveredState(),this.node.scene.emit($e.END_SHUFFLE);case 20:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"handleShowHint",value:function(){if(0===this.hintTiles.length){var e=this.getNewHintPairs();console.log("New hint tiles:",e);var t,n=d(this.hintTiles);try{for(n.s();!(t=n.n()).done;){t.value.animationHandler.playTileStopHintAnim()}}catch(e){n.e(e)}finally{n.f()}this.hintTiles=e;var i,a=d(this.hintTiles);try{for(a.s();!(i=a.n()).done;){i.value.animationHandler.playTileShowHintAnim()}}catch(e){a.e(e)}finally{a.f()}Me.playSound(ze.USE_HINT)}}},{key:"handleAutoPlay",value:function(){if(!this.isAutoFinishing){var e,t=this.getUncoveredTiles(),n=new Map,i=d(t);try{for(i.s();!(e=i.n()).done;){var a,r=e.value,o=void 0;o=it.flowers.includes(r.skinIdx)?"flowers":it.seasons.includes(r.skinIdx)?"seasons":r.skinIdx.toString(),n.has(o)||n.set(o,[]),null===(a=n.get(o))||void 0===a||a.push(r)}}catch(e){i.e(e)}finally{i.f()}var s=Array.from(n.entries()).filter((function(e){var t=y(e,2);t[0];return t[1].length>=2}));if(0!==s.length){var l=y(s[Math.floor(Math.random()*s.length)],2),u=(l[0],l[1]),c=f(u).sort((function(){return.5-Math.random()})),h=y(c,2),p=h[0],v=h[1];this.handleTileClicked(p),this.handleTileClicked(v)}}}},{key:"handleUndo",value:(v=s(l().mark((function e(){var t,n,i,a,r,o,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.canUndoPair.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this.canUndoPair.pop()){e.next=5;break}return e.abrupt("return");case 5:if(this.choosingTile&&(this.choosingTile.handleUnChooseTile(),this.choosingTile=null),n=y(t,2),i=n[0],a=n[1],r=this.gameScene.gameplay.gameObjects.respawnTile(i),o=this.gameScene.gameplay.gameObjects.respawnTile(a),this.setTileSprite(r,i.skinProp),this.setTileSprite(o,a.skinProp),r&&o){e.next=14;break}return console.error("Failed to respawn tiles"),e.abrupt("return");case 14:return r.handlePreloadTile(),o.handlePreloadTile(),Me.playSound(ze.USE_UNDO),e.next=19,this.playUndoAnimation(r,o);case 19:if(this.node.scene.emit($e.TWO_TILES_UNDONE,{tile1:r,tile2:o}),r.handleReadyTile(),o.handleReadyTile(),this.updateTilesState(),this.handleUpdateZoom(!0),this.updateTilesCoveredState(),0!==this.hintTiles.length&&this.hintTiles[0]&&this.hintTiles[1]&&(!this.hintTiles[0].isUncovered||!this.hintTiles[1].isUncovered)){s=d(this.hintTiles);try{for(s.s();!(u=s.n()).done;)u.value.animationHandler.playTileStopHintAnim()}catch(e){s.e(e)}finally{s.f()}this.hintTiles=[],this.node.scene.emit($e.HIDE_HINT)}case 26:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"handleShowUndo",value:function(){this.canUndoPair.length}},{key:"handleAutoFinishMatch",value:(p=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,f,y,v,g,m,b,S;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.hintTiles.length){t=d(this.hintTiles);try{for(t.s();!(n=t.n()).done;)n.value.animationHandler.playTileStopHintAnim()}catch(e){t.e(e)}finally{t.f()}this.hintTiles=[],this.node.scene.emit($e.HIDE_HINT)}if(0!==(i=this.getAllTiles()).length){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:a=i.sort((function(e,t){return e.skinIdx-t.skinIdx||e.getLayer()-t.getLayer()})),r=d(a);try{for(r.s();!(o=r.n()).done;)(s=o.value).state=Xe.MOVING_TO_MATCH,s.inputHandler.disableInteraction(),s.animationHandler.abortAllMovementAnimations()}catch(e){r.e(e)}finally{r.f()}this.isAutoFinishing=!0,u=Qe.ANIMATION_CONFIGS.AUTO_FINISH.SHINE_DELAY_INTERVAL/a.length,c=[],h=d(a),e.prev=11,h.s();case 13:if((p=h.n()).done){e.next=20;break}return f=p.value,c.push(f.animationHandler.playTileShineAnim()),e.next=18,_g.sleepAsync(1e3*u);case 18:e.next=13;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(11),h.e(e.t0);case 25:return e.prev=25,h.f(),e.finish(25);case 28:return e.next=30,Promise.all(c);case 30:y=Math.min(Qe.ANIMATION_CONFIGS.AUTO_FINISH.MATCH_DELAY_PER_TILE*(a.length/2),Qe.ANIMATION_CONFIGS.AUTO_FINISH.MAX_MATCH_DELAY_TOTAL_TIME),v=y/(a.length/2),g=[],m=0;case 34:if(!(m<a.length-1)){e.next=43;break}return b=a[m],S=a[m+1],this.checkTilesMatched(b,S)?g.push(this.handleTwoTilesMatched(b,S)):console.warn("Tiles ".concat(b.skinIdx," and ").concat(S.skinIdx," do not match")),e.next=40,_g.sleepAsync(1e3*v);case 40:m+=2,e.next=34;break;case 43:return e.next=45,Promise.all(g);case 45:this.isAutoFinishing=!1;case 46:case"end":return e.stop()}}),e,this,[[11,22,25,28]])}))),function(){return p.apply(this,arguments)})},{key:"getNewHintPairs",value:function(){for(var e=this.getUncoveredTiles(),t=[],n=0;n<e.length;n++){var i=e[n];if(!t.includes(i))for(var a=n+1;a<e.length;a++){var r=e[a];if(!t.includes(r)&&this.checkTilesMatched(i,r))return t.push(i,r),t}}return[]}},{key:"getAllTiles",value:function(){var e,t=[],n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push.apply(t,f(i))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"playShuffleAnimation",value:(h=s(l().mark((function e(t,n,i){var a,r,o,s=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=[],r=0;r<t.length;r++)(o=t[r]).animationHandler.toggleCoverAnimations(!0,.5),a.push(o.playShuffleAnim(i));return a.push(_g.sleepAsync(500).then((function(){return Me.playSound(ze.USE_SHUFFLE)}))),a.push(_g.sleepAsync(900).then((function(){for(var e=0;e<t.length;e++){var i=t[e],a=n[e];s.setTileSprite(i,a)}s.sortOrderTiles()}))),e.next=6,Promise.all(a);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"setTileSprite",value:function(e,t){t.skinIdx===et?e.setGolden(this.getGoldenTileSprite()):e.resetSkinIdx(t.skinIdx),t.isHidden&&e.setHiddenTile(),t.isTarget&&e.setTargetTile()}},{key:"playUndoAnimation",value:(c=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=[]).push(t.animationHandler.playTileUndoAnim()),i.push(n.animationHandler.playTileUndoAnim()),this.sortOrderTiles(),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"handleReleaseTile",value:function(e){}},{key:"handleTileDestroyed",value:(u=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==(n=this.tilesOnBoard.indexOf(t))&&this.tilesOnBoard.splice(n,1),!this.isAutoFinishing){e.next=4;break}return e.abrupt("return");case 4:0===this.tilesOnBoard.length?this.node.scene.emit($e.ALL_TILE_DESTROYED):this.tilesOnBoard.length>=2&&(i=2*this.getLeftoverPairCount(),0===this.numberOfMatchPairs&&i===this.tilesOnBoard.length&&this.node.scene.emit($e.ALL_TILE_COVERED));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleTileCreated",value:function(e){if(void 0!==e.layer&&e.tile){var t;if(this.tilesOnBoard.includes(e.tile)||this.tilesOnBoard.push(e.tile),this.maxLayer=Math.max(this.maxLayer,e.layer),this.layerTileMap.has(e.layer))null===(t=this.layerTileMap.get(e.layer))||void 0===t||t.push(e.tile);else this.layerTileMap.set(e.layer,[e.tile]);e.tile.setUncover(!0)}}},{key:"sortOrderTiles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parentNode;if(e){var t,n=e.children,i=[],a=d(n);try{for(a.s();!(t=a.n()).done;){var r=t.value,o=r.getComponent($f);if(o&&o.state!==Xe.MOVING_TO_MATCH&&o.state!==Xe.MATCHED){var s=o.getLayer();i[s]||(i[s]=[]),i[s].push(o)}}}catch(e){a.e(e)}finally{a.f()}for(var l=[],u=0;u<i.length;u++)if(i[u]){i[u].sort((function(e,t){return e.getDepth()-t.getDepth()}));for(var c=0;c<i[u].length;c++){var h=i[u][c],p=h.animationHandler.detachShadow(e);l[u]||(l[u]=[]),l[u].push(p.node)}}for(var f=0,y=0;y<i.length;y++)if(i[y]){var v,g=d(l[y]);try{for(g.s();!(v=g.n()).done;){var m=v.value;m.setSiblingIndex(f),f++}}catch(e){g.e(e)}finally{g.f()}var b,S=d(i[y]);try{for(S.s();!(b=S.n()).done;){var w=b.value;w.node.setSiblingIndex(f),f++}}catch(e){S.e(e)}finally{S.f()}}}}},{key:"calculateNumberOfMatchPairs",value:function(){var e,t=this.getUncoveredTiles(),n=new Map,i=d(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,r=a.skinIdx,o=this.getGroupKeyBySkinIdx(r);n.has(o)||n.set(o,[]),n.get(o).push(a)}}catch(e){i.e(e)}finally{i.f()}var s,l=0,u=d(n.entries());try{for(u.s();!(s=u.n()).done;){var c=y(s.value,2)[1];l+=Math.floor(c.length/2)}}catch(e){u.e(e)}finally{u.f()}this.numberOfMatchPairs=l}},{key:"getUncoveredTiles",value:function(){var e,t=[],n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=d(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered&&t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getCoveredTiles",value:function(){var e,t=[],n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=d(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered||t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"updateTilesTheme",value:function(){var e,t=Ne.getCurrentTileBackgroundSprite(),n=d(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=d(a);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=Ne.getTileIcon(o.skinIdx.toString());o.setBackgroundSprite(t),o.setHiddenBackgroundSprite(Ne.getCurrentTileHiddenSprite()),o.setEffectSprites(),s&&o.setItemSprite(s)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"getGoldenTilesCandidates",value:function(){var e,t=new Map,n=d(this.getAllTiles());try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.skinIdx;if(!this.isIgnoredSkin(a)){var r=t.get(a)||[];r.push(i),t.set(a,r)}}}catch(e){n.e(e)}finally{n.f()}var o,s=[],l=d(t.values());try{for(l.s();!(o=l.n()).done;){var u=o.value;if(2===u.length&&(s.push.apply(s,f(u)),4===s.length))return s}}catch(e){l.e(e)}finally{l.f()}var c,h=d(t.values());try{for(h.s();!(c=h.n()).done;){var p=c.value;if(4===p.length)return p.slice(0,4)}}catch(e){h.e(e)}finally{h.f()}var y,v=[],g=d(t.values());try{for(g.s();!(y=g.n()).done;){var m=y.value;if(2===m.length&&!v.includes(m[0])&&(v.push.apply(v,f(m)),v.length>=4))return v.slice(0,4)}}catch(e){g.e(e)}finally{g.f()}return v}},{key:"getReplaceableTilesCombinations",value:function(e){var t,n=new Map,i=d(this.getAllTiles());try{for(i.s();!(t=i.n()).done;){var a=t.value,r=a.skinIdx;if(!this.isIgnoredSkin(r)){var o=n.get(r)||[];o.push(a),n.set(r,o)}}}catch(e){i.e(e)}finally{i.f()}var s,l=[],u=d(n.values());try{for(u.s();!(s=u.n()).done;){var c=s.value,h=c.filter(e||function(){return!0});h.length%2==0&&h.length===c.length&&l.push(f(c))}}catch(e){u.e(e)}finally{u.f()}return l}},{key:"getSymmetricTile",value:function(e){var t=this.layerTileMap.get(e.getLayer())||[],n=(Math.min.apply(Math,f(t.map((function(e){return e.gridPos.x}))))+Math.max.apply(Math,f(t.map((function(e){return e.gridPos.x})))))/2;if(t.length<2)return null;var i,a=d(t);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(r!==e&&(r.gridPos.x-n===-e.gridPos.x+n&&r.gridPos.y===e.gridPos.y))return r}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"isIgnoredSkin",value:function(e){return it.flowers.includes(e)||it.seasons.includes(e)}}]),P}(k)).prototype,"specialTileSprites",[gg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kg=e(Sg.prototype,"parentNode",[mg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bg=Sg))||bg);g._RF.pop(),g._RF.push({},"0288aaI3RVMYYIL+L6NxqMw","ItemManager",void 0);var Og,Bg,Dg=m.ccclass,Fg=m.property,Mg=(codex.analytics,Eg=Dg("ItemManager"),Lg=Fg(Ng),Eg((Ag=e((Ig=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"tileManager",Ag,r(e)),e.itemConfigs={},e.isUsingHint=!1,e.isUsingShuffle=!1,e.useUndoCount=0,e.useShuffleCount=0,e.useHintCount=0,e.enable=!0,e}return o(l,[{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on($e.USE_ITEM,this.handleUseItem,this),e.on($e.HIDE_HINT,this.handleEndHint,this),e.on($e.END_SHUFFLE,this.handleEndShuffle,this)}},{key:"setItemConfig",value:function(e,t){this.itemConfigs[e]=t,this.node.scene.emit($e.ITEM_CONFIG_CHANGE,e,t)}},{key:"updateItemCount",value:function(){this.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.HINT,ut.getItemCount(ct[lt.HINT])),this.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.UNDO,ut.getItemCount(ct[lt.UNDO])),this.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.SHUFFLE,ut.getItemCount(ct[lt.SHUFFLE]))}},{key:"setEnable",value:function(e){this.enable=e,e&&this.updateItemCount()}},{key:"getIsUsingShuffle",value:function(){return this.isUsingShuffle}},{key:"getItemConfig",value:function(e){return this.itemConfigs[e]}},{key:"resetUsingItems",value:function(){this.isUsingHint=!1,this.isUsingShuffle=!1,this.useUndoCount=0,this.useShuffleCount=0,this.useHintCount=0}},{key:"handleUseItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.enable&&(e===lt.HINT?this.handleUseHint(t):e===lt.UNDO?this.handleUseUndo(t):e===lt.SHUFFLE&&this.handleUseShuffle(t))}},{key:"handleUseHint",value:function(e){if(this.itemConfigs[lt.HINT]!==ht.DISABLE){if(this.tileManager.getNumberOfMatchPairs()<=0)
//! This should not happen in normal gameplay
return console.error("No matchable tiles for hint"),void this.showItemWarnScreen("noMatchableTiles");if(this.isUsingHint)this.showItemWarnScreen("matchableTilesHighlighted");else if(!this.isUsingShuffle)if(this.checkItemCount(lt.HINT))this.spendItem(lt.HINT),this.useHint();else{var t=yg.isIAPFeatureAvailable();if(e){if(!fg.canWatchAds("hintItem")&&t)return void pt.openScreen(Ge.SHOP_SCREEN,{source:Ge.FREE_ITEM_SCREEN});this.showFreeItemScreen(lt.HINT,this.useHint.bind(this))}}}}},{key:"handleUseUndo",value:function(e){this.itemConfigs[lt.UNDO]!==ht.DISABLE&&(this.tileManager.getNumberOfCanUndoPair()<=0?this.showItemWarnScreen("Can'tUndo"):this.checkItemCount(lt.UNDO)?(this.spendItem(lt.UNDO),this.useUndo()):e&&this.showFreeItemScreen(lt.UNDO,this.useUndo.bind(this)))}},{key:"handleUseShuffle",value:function(e){if(this.itemConfigs[lt.SHUFFLE]!==ht.DISABLE&&!this.isUsingShuffle)if(this.checkItemCount(lt.SHUFFLE))this.spendItem(lt.SHUFFLE),this.useShuffle();else{var t=yg.isIAPFeatureAvailable();if(e){if(!fg.canWatchAds("shuffleItem")&&t)return void pt.openScreen(Ge.SHOP_SCREEN,{source:Ge.FREE_ITEM_SCREEN});this.showFreeItemScreen(lt.SHUFFLE,this.useShuffle.bind(this))}}}},{key:"useHint",value:function(){this.isUsingHint=!0,this.useHintCount++,We.logUseItem(lt.HINT),this.node.scene.emit($e.SHOW_HINT)}},{key:"useUndo",value:function(){this.useUndoCount++,We.logUseItem(lt.UNDO),this.node.scene.emit($e.START_UNDO)}},{key:"useShuffle",value:function(){this.isUsingShuffle=!0,this.useShuffleCount++,We.logUseItem(lt.SHUFFLE),this.node.scene.emit($e.START_SHUFFLE)}},{key:"checkItemCount",value:function(e){return this.itemConfigs[e]===ht.INFINITE||!(ut.getItemCount(ct[e])<=0)}},{key:"spendItem",value:function(e){this.itemConfigs[e]===ht.ENABLE&&ut.useItem(ct[e]),this.node.scene.emit($e.ITEM_COUNT_CHANGE,e,ut.getItemCount(ct[e]))}},{key:"handleEndHint",value:function(){this.isUsingHint=!1}},{key:"handleEndShuffle",value:function(){this.isUsingShuffle=!1}},{key:"showFreeItemScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i={item:e,successCallback:t,failCallback:n};pt.openScreen(Ge.FREE_ITEM_SCREEN,i)}},{key:"showItemWarnScreen",value:function(e){var t={message:e,duration:1.5,enableCloseOnTouch:!1};pt.openScreen(Ge.ITEM_WARN_SCREEN,t)}},{key:"getUseHintCount",value:function(){return this.useHintCount}},{key:"getUseUndoCount",value:function(){return this.useUndoCount}},{key:"getUseShuffleCount",value:function(){return this.useShuffleCount}}]),l}(k)).prototype,"tileManager",[Lg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xg=Ig))||xg);g._RF.pop(),g._RF.push({},"9d3bekBKtpPzpXlL25at3ml","ScoreManager",void 0);var zg=m.ccclass,Ug=(m.property,zg("ScoreManager")(((Bg=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).matchedPair=0,e.currentScore=0,e.currentCombo=0,e.currentMatchScore=0,e.currentBonusScore=0,e.lastBonusCombo=0,e.trackCombo=!0,e.trackScore=!0,e.startPlayTime=0,e}return o(r,[{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on($e.TWO_TILES_MATCHED,this.handleTilesMatched,this),e.on($e.TILE_BLOCKED,this.handleTilesCoveredClicked,this),e.on($e.START_UNDO,this.handleComboBreak,this),e.on($e.GAME_START,this.resetScore,this)}},{key:"handleTilesMatched",value:function(e){var t=e.worldCenterPosition;if(this.matchedPair++,this.trackCombo&&(this.currentCombo++,dt.reachCombo(this.currentCombo)),this.trackScore){this.currentMatchScore=this.calculateMatchScore(),this.currentBonusScore=this.calculateBonusScore();var n=this.currentMatchScore+this.currentBonusScore;this.currentScore+=n}this.trackCombo?this.playMatchWithScoreComboAnimation(this.currentMatchScore,this.currentCombo,this.currentBonusScore,t):this.playMatchAnimation(t),this.updateUI()}},{key:"handleTilesCoveredClicked",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.handleComboBreak(),this.playBlockAnimation(e,t,n)}},{key:"handleComboBreak",value:function(){this.currentCombo=0,this.lastBonusCombo=0,this.playUnhighlightText()}},{key:"calculateMatchScore",value:function(){var e=r.SCORE_CONFIG,t=e.baseScore,n=e.comboIncrement,i=e.maxComboScore,a=t+(this.currentCombo-1)*n;return Math.min(a,i)}},{key:"calculateBonusScore",value:function(){var e=r.SCORE_CONFIG,t=e.bonusThreshold,n=e.bonusScores;if(this.currentCombo>=5&&this.currentCombo%t==0&&this.currentCombo>this.lastBonusCombo){this.lastBonusCombo=this.currentCombo;var i,a=Object.keys(n).map(Number).sort((function(e,t){return t-e})),o=d(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(this.currentCombo>=s)return n[s]}}catch(e){o.e(e)}finally{o.f()}}return 0}},{key:"playBlockAnimation",value:function(e,t,n){var i=t;this.gameScene.gameplay.effectManager.playTileBlockedEffect(e,i)}},{key:"playUnhighlightText",value:function(){this.gameScene.gameplay}},{key:"playMatchAnimation",value:function(e){this.gameScene.gameplay.effectManager.playMatchExplosionEffect(3,e)}},{key:"playMatchWithScoreComboAnimation",value:function(e,t,n,i){var a=this.gameScene.gameplay;a.effectManager.playTileMatchEffect(i,e,t,n),a.uiManager.runShowComboAnimation(t)}},{key:"updateUI",value:function(){this.gameScene.gameplay.uiManager.setScoreText(this.currentScore)}},{key:"resetScore",value:function(){this.currentScore=0,this.currentCombo=0,this.lastBonusCombo=0,this.matchedPair=0,this.startPlayTime=Date.now()/1e3,this.updateUI()}},{key:"setCombo",value:function(e){this.currentCombo=e}},{key:"setTrackCombo",value:function(e){this.trackCombo=e}},{key:"setTrackScore",value:function(e){this.trackScore=e}},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getCurrentCombo",value:function(){return this.currentCombo}},{key:"getCurrentMatchScore",value:function(){return this.currentMatchScore}},{key:"getCurrentBonusScore",value:function(){return this.currentBonusScore}},{key:"getMatchedPair",value:function(){return this.matchedPair}},{key:"getCurrentPlayTime",value:function(){return Date.now()/1e3-this.startPlayTime}}]),r}(k)).SCORE_CONFIG={baseScore:240,comboIncrement:40,maxComboScore:600,bonusThreshold:5,bonusScores:{5:40,10:80,15:80,20:120}},Og=Bg))||Og);g._RF.pop(),g._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var Gg=function(){function e(t){if(i(this,e),this.data={},this.gameplay=t.gameplay,!this.gameplay)throw new Error("Gameplay component not found");this.manager=t,this.logDebug()}return o(e,[{key:"logDebug",value:function(){var e=this.constructor.name;console.log("[STATE] ".concat(e))}}]),e}();g._RF.pop(),g._RF.push({},"44cefXAXkxB2qJhBlEIVk0K","AutoFinsishState",void 0);var Hg=function(e){t(c,e);var a,r,u=n(c);function c(e){var t;return i(this,c),(t=u.call(this,e)).disableGameplay(),t.gameplay.uiManager.disableUI(),rt.getSpecialMode()===ot.JOURNEY?t.handleJourneyMode():t.handleNormalMode(),We.logLevelAutoFinish(),t}return o(c,[{key:"handleJourneyMode",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameplay.scoreManager.setTrackCombo(!1),e.next=3,this.gameplay.tileManager.handleAutoFinishMatch();case 3:return e.next=5,this.gameplay.uiManager.journeyBlock.runFinishAnimation(this.gameplay.uiManager.getCenterPosition());case 5:this.gameplay.scoreManager.setTrackCombo(!0),this.nextLevelFromAutoFinish();case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleNormalMode",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameplay.tileManager.handleAutoFinishMatch();case 2:this.nextLevelFromAutoFinish();case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"disableGameplay",value:function(){Me.turnUpMusic(),this.gameplay.itemManager.setEnable(!1)}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"nextLevelFromAutoFinish",value:function(){var e=this.manager.createNextLevelState();this.manager.change(e)}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){var e=this.manager.createGameOverState();this.manager.change(e)}},{key:"update",value:function(){}}]),c}(Gg);g._RF.pop(),g._RF.push({},"ac9achzrA1MfaQq9nuYDIIB","GameOverState",void 0);var Wg=function(e){t(u,e);var a,r=n(u);function u(e){var t;return i(this,u),(t=r.call(this,e)).gameplay.uiManager.disableUI(),t.gameplay.uiManager.runHideAnimation(),t.handleOutOfMoves(),t}return o(u,[{key:"handleOutOfMoves",value:(a=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.gameplay.tileManager.getTilesOnBoard(),e.next=3,this.gameplay.effectManager.playGameOverEffect(t);case 3:Kr.vibrate(300),this.showLoseScreen();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"showLoseScreen",value:function(){pt.openScreen(Ge.LOSE_SCREEN)}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}}]),u}(Gg);g._RF.pop(),g._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var Vg=function(e){t(c,e);var a,r,u=n(c);function c(e){var t;return i(this,c),t=u.call(this,e),"CrazyGames"===GameSDK.getSDKName()&&t.processCrazyGamesRequirements(),t.enableUI(),t.updateItem(),nt.increaseTryCount(),t.gameplay.setupGameBoard(),t.updateHeader(),t.startGameAsync().then(s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.closeLoadingScreen(),t.gameplay.handleStartGame(),e.next=4,t.gameplay.gameModeManager.start();case 4:t.manager.ready(),t.logLevelStartAnalytics(),t.gameplay.attemptCallCreateShortcut(),nt.increaseLevelStartTimes(),t.gameplay.handlePreloadUpcomingScreens();case 9:case"end":return e.stop()}}),e)})))),t}return o(c,[{key:"processCrazyGamesRequirements",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart(),this.showInterAdsCrazyGames()}},{key:"updateItem",value:function(){if(this.gameplay){nt.getLevel();var e=this.gameplay.itemManager;e.updateItemCount(),e.setItemConfig(lt.HINT,ht.ENABLE),e.setItemConfig(lt.UNDO,ht.INFINITE),e.setItemConfig(lt.SHUFFLE,ht.ENABLE),e.resetUsingItems(),e.setEnable(!0)}}},{key:"showInterAdsCrazyGames",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.gameplay){e.next=2;break}return e.abrupt("return");case 2:return Me.stopAllSounds(),e.next=5,je.showInterstitialAdAsync({forLevel:this.data.level,includeSDK:["CrazyGames"]});case 5:e.sent&&this.gameplay.disableRewardAdsItemForCrazyGames(),Me.turnUpMusic();case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"load",value:function(){if(Ludex.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"closeLoadingScreen",value:function(){pt.closeLoadingScreen()}},{key:"enableUI",value:function(){var e;null===(e=this.gameplay)||void 0===e||e.uiManager.enableUI()}},{key:"updateHeader",value:function(){}},{key:"startGameAsync",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt.startMatchAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("startGameAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return a.apply(this,arguments)})},{key:"logLevelStartAnalytics",value:function(){We.logLevelStart()}}]),c}(Gg);g._RF.pop(),g._RF.push({},"a8496IbdA1EnY7sv4ApuaJW","LoadingState",void 0);var jg=function(e){t(h,e);var a,r,u,c=n(h);function h(e){var t;return i(this,h),(t=c.call(this,e)).handleLoaded=function(){var e,n=nt.getLevel();nt.getLevelData(n)?(
//! wait until loading screen open
nt.preloadLevelDataAsync(n+1),t.loadingScreenFlag?null===(e=t.gameplay)||void 0===e||e.scheduleOnce((function(){t.initialize()}),.5):t.initialize()):console.error("Failed to load level")},t.loadingScreenFlag=!t.isLevelAlreadyLoaded()||!t.isLevelUILoaded()||!t.isTournamentHandled(),t.loadingScreenFlag&&pt.showLoadingScreen(),t.updateHeaderTexts(),t.handleLoading(),t}return o(h,[{key:"load",value:function(){}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"isLevelAlreadyLoaded",value:function(){var e=nt.getLevel();return nt.hasLevelData(e)?!!Ne.isLoadedCurrentTileTheme()||(console.log("LoadingState: not all needed tile sprites loaded"),!1):(console.log("LoadingState: not has level data"),!1)}},{key:"isLevelUILoaded",value:function(){return!!this.gameplay&&(rt.getCurrentMatchMode()===Ludex.Match.Modes.CHALLENGE_FRIEND?this.gameplay.uiManager.isChallengeUILoaded():rt.getSpecialMode()!==ot.JOURNEY||this.gameplay.uiManager.isJourneyUILoaded())}},{key:"isTournamentHandled",value:function(){return codex.match.getMatchState().mode!==Ludex.Match.Modes.TOURNAMENT||ft.isTournamentHappening()}},{key:"handleLoading",value:(u=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(this.handleLoadLevelData()),t.push(this.handleLoadUI()),t.push(this.handleLoadTournamentData()),this.handleLoadSounds(),e.next=7,Promise.all(t);case 7:this.handleLoaded();case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleLoadLevelData",value:function(){var e=this;return new Promise((function(t){var n=nt.getLevel();
//! Load level data again if not already loaded
nt.preloadLevelDataAsync(n).then((function(){Ne.isLoadedCurrentTileTheme()?e.loadJourney(t):(console.log("LoadingState: load level tile sprites"),Ne.loadTileThemeSpriteFrames().then((function(){e.loadJourney(t)})))}))}))}},{key:"loadJourney",value:function(e){this.gameplay.journeyLevelMechanicsManager.getMissionType()!==yt.FIND_ARTIFACT||tt.isLoadedCurrentJourneyTileTheme()?e():tt.loadJourneyTileThemeSpriteFrames().then((function(){e()}))}},{key:"handleLoadUI",value:(r=s(l().mark((function e(){var t,n,i,a,r,o,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=rt.getCurrentMatchMode(),n=rt.getSpecialMode(),t!==Ludex.Match.Modes.CHALLENGE_FRIEND){e.next=11;break}return e.next=5,null===(i=this.gameplay)||void 0===i?void 0:i.uiManager.loadChallengeUI();case 5:if(!this.gameplay){e.next=11;break}if(a=this.gameplay.uiManager,r=a.challengeBlock,o=a.challengePrepare,r&&r.updateChallengeData(),!o){e.next=11;break}return e.next=11,o.updateChallengeData();case 11:if(n!==ot.JOURNEY){e.next=15;break}return e.next=14,null===(s=this.gameplay)||void 0===s?void 0:s.uiManager.loadJourneyUI();case 14:this.gameplay&&(u=this.gameplay.uiManager.journeyBlock,this.gameplay.journeyLevelMechanicsManager.setJourneyBlock(u));case 15:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleLoadTournamentData",value:(a=s(l().mark((function e(){var t,n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(codex.match.getMatchState().mode===Ludex.Match.Modes.TOURNAMENT&&!ft.isTournamentHappening()){e.next=2;break}return e.abrupt("return");case 2:return n=null===(t=codex.match.getMatchState().customData)||void 0===t?void 0:t.tournamentId,e.next=5,GameSDK.tournament.getTournamentsAsync();case 5:(i=e.sent.filter((function(e){return e.getID()===n}))[0])?(a=JSON.parse(i.getPayload()||"{}")).leaderboardId&&!a.isPlayerTournament&&ft.handleJoinFromPost():ft.handleJoinFromPost();case 7:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"handleLoadSounds",value:function(){for(var e=[ze.TILE_SHOW,ze.TILE_CLICK,ze.TILE_DESELECT,ze.TILE_MATCH_1,ze.TILE_MATCH_2,ze.TILE_MATCH_3,ze.TILE_MATCH_4,ze.TILE_MATCH_5,ze.ENCOURAGE_GOOD,ze.ENCOURAGE_GREAT,ze.ENCOURAGE_AMAZING,ze.ENCOURAGE_AWESOME,ze.USE_HINT,ze.USE_UNDO,ze.USE_SHUFFLE],t=function(){var e=i[n];Pe.loadAudioAsync(e).catch((function(t){console.error("Failed to preload sound: ".concat(e),t)}))},n=0,i=e;n<i.length;n++)t()}},{key:"updateHeaderTexts",value:function(){var e,t,n=nt.getLevel(),i=rt.getSpecialMode();if(i===ot.DAILY_CHALLENGE){var a,r=rt.getSpecialModeInfo();null===(a=this.gameplay)||void 0===a||a.uiManager.setDateStringText(r)}else if(i===ot.JOURNEY);else{var o;null===(o=this.gameplay)||void 0===o||o.uiManager.setLevelText(n)}null===(e=this.gameplay)||void 0===e||e.uiManager.setScoreText(0),null===(t=this.gameplay)||void 0===t||t.uiManager.setMatchText(0)}}]),h}(Gg);g._RF.pop(),g._RF.push({},"0e78aHOcUdI0ahf/IY+Ufzr","SocialUtils",void 0);var qg=codex.match,Kg=function(){function e(){i(this,e)}var t,n,a,r,u;return o(e,[{key:"updatePlayerData",value:function(){var e=this.createPlayerTournament,t=this.playWithFriend,n=this.joinGlobalTournament;codex.player.setGameData({social:{createPlayerTournament:{success:e.success,failed:e.failed},playWithFriend:{success:t.success,failed:t.failed},joinGlobalTournament:{success:n.success,failed:n.failed}}})}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:function(){this.loadConfigByLocale();var e=codex.player.getGameData().social,t=e.createPlayerTournament,n=e.playWithFriend,i=e.joinGlobalTournament;this.inst.createPlayerTournament={lastTimeShow:0,success:t.success,failed:t.failed,levelPassed:0,countInSession:0},this.inst.playWithFriend={lastTimeShow:0,success:n.success,failed:n.failed,levelPassed:0,countInSession:0},this.inst.joinGlobalTournament={lastTimeShow:0,success:i.success,failed:i.failed,levelPassed:0,countInSession:0},this.inst.lastTimeShow=0,this.handleResetTime(),this.addDebugCreatePlayerTournamentContent(),this.addDebugPlayWithFriendContent(),this.addDebugJoinGlobalTournamentContent(),this.addDebugContent(),this.inst.updatePlayerData()}},{key:"addDebugCreatePlayerTournamentContent",value:function(){var e=this.socialConfig.CreatePlayerTournament,t=e.Enabled,n=e.Success,i=e.Failed,a=e.MinLevelInterval,r=e.MinInterval,o=e.MaxShowPerSession,s=e.LevelStart,l=e.MaxLevel,u=e.Priority,c=vt.addLiveOpsFolder("SocialCreatePlayerTournament");c&&(vt.addLiveOpsBinding(c,{Enabled:t},"Enabled",{label:"Enabled"},(function(t){e.Enabled=t.value})),vt.addLiveOpsBinding(c,{SuccessC:n.Count},"SuccessC",{step:1,label:"SuccessC"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{SuccessRT:n.ResetTime},"SuccessRT",{step:1,label:"SuccessRT"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{FailedC:i.Count},"FailedC",{step:1,label:"FailedC"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{FailedRT:i.ResetTime},"FailedRT",{step:1,label:"FailedRT"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{MinLevelInterval:a},"MinLevelInterval",{step:1,label:"MinLevelInterval"},(function(t){e.MinLevelInterval=t.value})),vt.addLiveOpsBinding(c,{MinInterval:r},"MinInterval",{step:1,label:"MinInterval"},(function(t){e.MinInterval=t.value})),vt.addLiveOpsBinding(c,{MaxShowPerSession:o},"MaxShowPerSession",{step:1,label:"MaxShowPerSession"},(function(t){e.MaxShowPerSession=t.value})),vt.addLiveOpsBinding(c,{LevelStart:s},"LevelStart",{step:1,label:"LevelStart"},(function(t){e.LevelStart=t.value})),vt.addLiveOpsBinding(c,{MaxLevel:l},"MaxLevel",{step:1,label:"MaxLevel"},(function(t){e.MaxLevel=t.value})),vt.addLiveOpsBinding(c,{Priority:u},"Priority",{step:1,label:"Priority"},(function(t){e.Priority=t.value})))}},{key:"addDebugPlayWithFriendContent",value:function(){var e=this.socialConfig.PlayWithFriend,t=e.Enabled,n=e.Success,i=e.Failed,a=e.MinLevelInterval,r=e.MinInterval,o=e.MaxShowPerSession,s=e.LevelStart,l=e.MaxLevel,u=e.Priority,c=vt.addLiveOpsFolder("SocialPlayWithFriend");c&&(vt.addLiveOpsBinding(c,{Enabled:t},"Enabled",{label:"Enabled"},(function(t){e.Enabled=t.value})),vt.addLiveOpsBinding(c,{SuccessC:n.Count},"SuccessC",{step:1,label:"SuccessC"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{SuccessRT:n.ResetTime},"SuccessRT",{step:1,label:"SuccessRT"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{FailedC:i.Count},"FailedC",{step:1,label:"FailedC"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{FailedRT:i.ResetTime},"FailedRT",{step:1,label:"FailedRT"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{MinLevelInterval:a},"MinLevelInterval",{step:1,label:"MinLevelInterval"},(function(t){e.MinLevelInterval=t.value})),vt.addLiveOpsBinding(c,{MinInterval:r},"MinInterval",{step:1,label:"MinInterval"},(function(t){e.MinInterval=t.value})),vt.addLiveOpsBinding(c,{MaxShowPerSession:o},"MaxShowPerSession",{step:1,label:"MaxShowPerSession"},(function(t){e.MaxShowPerSession=t.value})),vt.addLiveOpsBinding(c,{LevelStart:s},"LevelStart",{step:1,label:"LevelStart"},(function(t){e.LevelStart=t.value})),vt.addLiveOpsBinding(c,{MaxLevel:l},"MaxLevel",{step:1,label:"MaxLevel"},(function(t){e.MaxLevel=t.value})),vt.addLiveOpsBinding(c,{Priority:u},"Priority",{step:1,label:"Priority"},(function(t){e.Priority=t.value})))}},{key:"addDebugJoinGlobalTournamentContent",value:function(){var e=this.socialConfig.JoinGlobalTournament,t=e.Enabled,n=e.Success,i=e.Failed,a=e.MinLevelInterval,r=e.MinInterval,o=e.MaxShowPerSession,s=e.LevelStart,l=e.MaxLevel,u=e.Priority,c=vt.addLiveOpsFolder("SocialJoinGlobalTournament");c&&(vt.addLiveOpsBinding(c,{Enabled:t},"Enabled",{label:"Enabled"},(function(t){e.Enabled=t.value})),vt.addLiveOpsBinding(c,{SuccessC:n.Count},"SuccessC",{step:1,label:"SuccessC"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{SuccessRT:n.ResetTime},"SuccessRT",{step:1,label:"SuccessRT"},(function(t){e.Success.Count=t.value})),vt.addLiveOpsBinding(c,{FailedC:i.Count},"FailedC",{step:1,label:"FailedC"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{FailedRT:i.ResetTime},"FailedRT",{step:1,label:"FailedRT"},(function(t){e.Failed.Count=t.value})),vt.addLiveOpsBinding(c,{MinLevelInterval:a},"MinLevelInterval",{step:1,label:"MinLevelInterval"},(function(t){e.MinLevelInterval=t.value})),vt.addLiveOpsBinding(c,{MinInterval:r},"MinInterval",{step:1,label:"MinInterval"},(function(t){e.MinInterval=t.value})),vt.addLiveOpsBinding(c,{MaxShowPerSession:o},"MaxShowPerSession",{step:1,label:"MaxShowPerSession"},(function(t){e.MaxShowPerSession=t.value})),vt.addLiveOpsBinding(c,{LevelStart:s},"LevelStart",{step:1,label:"LevelStart"},(function(t){e.LevelStart=t.value})),vt.addLiveOpsBinding(c,{MaxLevel:l},"MaxLevel",{step:1,label:"MaxLevel"},(function(t){e.MaxLevel=t.value})),vt.addLiveOpsBinding(c,{Priority:u},"Priority",{step:1,label:"Priority"},(function(t){e.Priority=t.value})))}},{key:"addDebugContent",value:function(){var e=this,t=vt.addLiveOpsFolder("Social");if(t){var n=this.socialConfig.MinPopupInterval;vt.addLiveOpsBinding(t,{MinPopupInterval:n},"MinPopupInterval",{step:1,label:"MinPopupInterval"},(function(t){e.socialConfig.MinPopupInterval=t.value})),vt.addLiveOpsButton(t,"Reset limit",(function(){codex.player.setGameData({social:{createPlayerTournament:{success:0,failed:0},playWithFriend:{success:0,failed:0},joinGlobalTournament:{success:1,failed:0}}})})),vt.addLiveOpsButton(t,"Day -1",(function(){codex.player.setGameData({lastLoginTime:codex.player.getGameData().lastLoginTime-864e5})}))}}},{key:"handleResetTime",value:function(){var e=this.socialConfig,t=e.CreatePlayerTournament,n=e.PlayWithFriend,i=e.JoinGlobalTournament;this.isResetTime(t.Success.ResetTime)&&(this.inst.createPlayerTournament.success=0),this.isResetTime(t.Failed.ResetTime)&&(this.inst.createPlayerTournament.failed=0),this.isResetTime(n.Success.ResetTime)&&(this.inst.playWithFriend.success=0),this.isResetTime(n.Failed.ResetTime)&&(this.inst.playWithFriend.failed=0),this.isResetTime(i.Success.ResetTime)&&(this.inst.joinGlobalTournament.success=0),this.isResetTime(i.Failed.ResetTime)&&(this.inst.joinGlobalTournament.failed=0)}},{key:"isResetTime",value:function(e){if(e<=0)return!0;var t=1e3*e,n=codex.player.getGameData().lastLoginTime,i=Date.now(),a=new Date(0);return n<=Math.floor((i-a.getTime())/t)*t+a.getTime()}},{key:"loadConfigByLocale",value:function(){var e=GameSDK.getLocale(),t=null==e?void 0:e.trim().split(/[-_]/)[1];this.socialConfig=this.getSocialConfigByGeo(t||"DEFAULT",!0)}},{key:"openPopupSharePlayerTournamentIfEligible",value:(u=s(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.level,this.canOpenPopup("createPlayerTournament")&&1!==n){e.next=3;break}return e.abrupt("return");case 3:return this.inst.createPlayerTournament.levelPassed=0,this.inst.createPlayerTournament.lastTimeShow=Date.now(),this.inst.lastTimeShow=Date.now(),e.next=8,rt.openPopupSharePlayerTournament(t);case 8:e.sent?this.inst.createPlayerTournament.success++:this.inst.createPlayerTournament.failed++,this.inst.createPlayerTournament.countInSession++,this.inst.updatePlayerData();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"openPopupRandomFriendIfEligible",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canOpenPopup("playWithFriend")){e.next=2;break}return e.abrupt("return");case 2:return this.inst.playWithFriend.levelPassed=0,this.inst.playWithFriend.lastTimeShow=Date.now(),this.inst.lastTimeShow=Date.now(),e.next=7,rt.openPopupRandomFriend();case 7:e.sent?this.inst.playWithFriend.success++:this.inst.playWithFriend.failed++,this.inst.playWithFriend.countInSession++,this.inst.updatePlayerData();case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"openPopupGlobalTournamentIfEligible",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canOpenPopup("joinGlobalTournament")){e.next=2;break}return e.abrupt("return");case 2:return this.inst.joinGlobalTournament.levelPassed=0,this.inst.joinGlobalTournament.lastTimeShow=Date.now(),this.inst.lastTimeShow=Date.now(),e.next=7,rt.openPopupJoinGlobalTournament();case 7:e.sent?this.inst.joinGlobalTournament.success++:this.inst.joinGlobalTournament.failed++,this.inst.joinGlobalTournament.countInSession++,this.inst.updatePlayerData();case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"canOpenPopup",value:function(t){var n=this.inst.createPlayerTournament,i=e.socialConfig.CreatePlayerTournament;"playWithFriend"===t?(n=this.inst.playWithFriend,i=e.socialConfig.PlayWithFriend):"joinGlobalTournament"===t&&(n=this.inst.joinGlobalTournament,i=e.socialConfig.JoinGlobalTournament),console.log("Check can open popup for",t,n,i);var a=n,r=a.lastTimeShow,o=a.levelPassed,s=a.success,l=a.failed,u=a.countInSession,c=i,h=c.Enabled,p=c.Success,d=c.Failed,f=c.MinLevelInterval,y=c.MinInterval,v=c.MaxShowPerSession,g=c.LevelStart,m=c.MaxLevel;if(!h)return!1;if(s>=p.Count)return!1;if(l>=d.Count)return!1;var b=nt.getPlayerLevel(),S=Date.now();return!(-1!==g&&b<g)&&(!(-1!==m&&b>m)&&(!(-1!==this.socialConfig.MinPopupInterval&&S-this.inst.lastTimeShow<1e3*this.socialConfig.MinPopupInterval)&&(0===r||!(-1!==o&&o<=f)&&(!(-1!==y&&!(S-r>=1e3*y))&&!(-1!==v&&u>=v)))))}},{key:"completeLevel",value:function(){this.inst.createPlayerTournament.levelPassed++,this.inst.playWithFriend.levelPassed++,this.inst.joinGlobalTournament.levelPassed++}},{key:"getSocialConfigByGeo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("Detect locale/geo from SDK:",e);for(var n=0,i=Object.entries(hd);n<i.length;n++){var a=y(i[n],2),r=a[0],o=a[1];if(o.includes(e.toUpperCase()))return t&&this.logSocialCustomConfigWithDelay(r),pd[r]}return console.log("No config for locale/geo:",e,"Use default config"),t&&this.logSocialCustomConfigWithDelay("DEFAULT"),pd.DEFAULT}},{key:"handleSocialOnCompleteLevel",value:(n=s(l().mark((function e(t,n){var i,a,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qg.getMatchState().mode!==Ty.TOURNAMENT){e.next=6;break}rt.switchToSoloContext(),e.next=34;break;case 6:i=[{name:"CreatePlayerTournament",config:this.socialConfig.CreatePlayerTournament},{name:"PlayWithFriend",config:this.socialConfig.PlayWithFriend},{name:"JoinGlobalTournament",config:this.socialConfig.JoinGlobalTournament}].sort((function(e,t){return t.config.Priority-e.config.Priority})),console.log("CompleteLevel: Check social popup",i),a=d(i),e.prev=9,a.s();case 11:if((r=a.n()).done){e.next=26;break}if((o=r.value).config.ShowPosition.includes("COMPLETE_LEVEL")){e.next=15;break}return e.abrupt("continue",24);case 15:if("CreatePlayerTournament"!==o.name||!this.canOpenPopup("createPlayerTournament")){e.next=18;break}return this.openPopupSharePlayerTournamentIfEligible({level:n,score:t}),e.abrupt("break",26);case 18:if("PlayWithFriend"!==o.name||!this.canOpenPopup("playWithFriend")){e.next=21;break}return this.openPopupRandomFriendIfEligible(),e.abrupt("break",26);case 21:if("JoinGlobalTournament"!==o.name||!this.canOpenPopup("joinGlobalTournament")){e.next=24;break}return this.openPopupGlobalTournamentIfEligible(),e.abrupt("break",26);case 24:e.next=11;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(9),a.e(e.t0);case 31:return e.prev=31,a.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[9,28,31,34]])}))),function(e,t){return n.apply(this,arguments)})},{key:"logSocialCustomConfigWithDelay",value:function(e){setTimeout((function(){codex.analytics.event(gt.SOCIAL_CUSTOM_CONFIG,{social_group:e})}),2500)}},{key:"handleSocialOnNextLevelButton",value:(t=s(l().mark((function e(){var t,n,i,a,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("NextLevelButton: Check social popup"),t=0,n=nt.getPlayerLevel(),qg.getMatchState().mode!==Ty.TOURNAMENT){e.next=8;break}e.next=40;break;case 8:i=[{name:"CreatePlayerTournament",config:this.socialConfig.CreatePlayerTournament},{name:"PlayWithFriend",config:this.socialConfig.PlayWithFriend},{name:"JoinGlobalTournament",config:this.socialConfig.JoinGlobalTournament}].sort((function(e,t){return t.config.Priority-e.config.Priority})),console.log("NextLevelButton: Check social popup",i),a=d(i),e.prev=11,a.s();case 13:if((r=a.n()).done){e.next=32;break}if((o=r.value).config.ShowPosition.includes("NEXT_LEVEL_BUTTON")){e.next=17;break}return e.abrupt("continue",30);case 17:if("CreatePlayerTournament"!==o.name||!this.canOpenPopup("createPlayerTournament")){e.next=22;break}return console.warn("NextLevelButton: No score to create player tournament"),e.next=21,this.openPopupSharePlayerTournamentIfEligible({level:n,score:t});case 21:return e.abrupt("break",32);case 22:if("PlayWithFriend"!==o.name||!this.canOpenPopup("playWithFriend")){e.next=26;break}return e.next=25,this.openPopupRandomFriendIfEligible();case 25:return e.abrupt("break",32);case 26:if("JoinGlobalTournament"!==o.name||!this.canOpenPopup("joinGlobalTournament")){e.next=30;break}return e.next=29,this.openPopupGlobalTournamentIfEligible();case 29:return e.abrupt("break",32);case 30:e.next=13;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(11),a.e(e.t0);case 37:return e.prev=37,a.f(),e.finish(37);case 40:case"end":return e.stop()}}),e,this,[[11,34,37,40]])}))),function(){return t.apply(this,arguments)})}]),e}();Kg.socialConfig=pd.DEFAULT,g._RF.pop(),g._RF.push({},"acde5YdsFNFqZHtxkJ8Tuh6","NextLevelState",void 0);var Yg=codex,Jg=Yg.match,Zg=Yg.player,Xg=Yg.leaderboard,Qg=(Yg.analytics,function(e){t(h,e);var a,r,u,c=n(h);function h(e){var t;i(this,h),(t=c.call(this,e)).disableGameplay();var n=nt.getLevel();return t.validateTournament(),t.handleDailyChallenge(),t.handleJourney(),dt.finishGame(),t.handleNextLevel(),t.finishGameAsync(n),t}return o(h,[{key:"disableGameplay",value:function(){this.gameplay.uiManager.disableUI(),this.gameplay.uiManager.runHideAnimation(),this.gameplay.itemManager.setEnable(!1),Me.turnUpMusic()}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"handleDailyChallenge",value:function(){if(rt.getSpecialMode()===ot.DAILY_CHALLENGE){var e=rt.getSpecialModeInfo();mt.completeChallenge(e)}}},{key:"handleJourney",value:function(){rt.getSpecialMode()===ot.JOURNEY&&(tt.logJourneyCompleteLevel(),tt.increaseLevel())}},{key:"validateTournament",value:function(){!ft.isTournamentHappening()&&ft.isInContextGlobalTournament()&&(console.warn("Tournament is not valid, switching to solo context"),rt.switchToSoloContext())}},{key:"handleNextLevel",value:(u=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.gameplay.scoreManager.getCurrentScore(),n=nt.getLevel(),t>Zg.getBestScore()&&Zg.setBestScore(t),ft.inst.isPlayerJoined&&ft.getTournamentRank()<=0?ft.completeLevelPromise=this.updateMatchProfile(t):(ft.completeLevelPromise=void 0,this.updateMatchProfile(t)),this.handleChallengeMatch(t),this.handlePlayerTournament(t),this.handleSocial({score:t,level:n}),this.logLevelCompleted(t,n),this.handleNextLevelData(n),console.log("Complete level:",n),i=rt.getCurrentMatchMode(),e.t0=i,e.next=e.t0===Ty.SINGLE||e.t0===Ty.TOURNAMENT?14:e.t0===Ty.CHALLENGE_FRIEND?16:18;break;case 14:return this.showWiningScreen(t,n),e.abrupt("break",18);case 16:return this.showChallengeFriendCompleteScreen(t,n),e.abrupt("break",18);case 18:ft.updateData(),dt.showCompleteQuestPopupIfReady();case 20:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"showWiningScreen",value:function(e,t){var n=this.getEndLevelScreenKeyEnum();pt.openScreen(n,{score:e,level:t})}},{key:"getEndLevelScreenKeyEnum",value:function(){var e=this.gameplay.hasGoldenTiles;return rt.getSpecialMode()===ot.JOURNEY?Ge.JOURNEY_WINNING_SCREEN:ft.inst.isPlayerJoined&&e?Ge.TOURNAMENT_COMPLETE_SCREEN:Ge.WINNING_SCREEN}},{key:"showChallengeFriendCompleteScreen",value:function(e,t){pt.openScreen(Ge.CHALLENGE_FRIEND_COMPLETE_SCREEN,{score:e,level:t})}},{key:"logLevelCompleted",value:function(e,t){We.logLevelEnd(t,e,!0)}},{key:"finishGameAsync",value:(r=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt.finishMatchAsync(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("finishGameAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return r.apply(this,arguments)})},{key:"updateMatchProfile",value:(a=s(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.gameplay.hasGoldenTiles,i=ft.inst.isPlayerJoined&&n,!ft.isInContextGlobalTournament()&&!i){e.next=12;break}if((a=ft.inst.tournamentData).bestScore+=ft.getGoldenTilesPerLevel(),ft.updateTournamentData(a),rt.setProfileMatchDataAsync({id:Zg.getPlayerId(),score:a.bestScore}),ft.isInContextGlobalTournament()||!i){e.next=10;break}return e.next=10,Xg.setLeaderboardScoreAsync(a.leaderboardId,Zg.getPlayerId(),a.bestScore);case 10:e.next=13;break;case 12:rt.setProfileMatchDataAsync({id:Zg.getPlayerId(),score:t});case 13:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"handleChallengeMatch",value:function(e){var t=Jg.getMatchState();if(t&&t.mode===Ty.CHALLENGE_FRIEND){var n,i=Zg.getPlayerId();null!==(n=t.profiles)&&void 0!==n&&n[i]&&(t.profiles[i].score=e)}}},{key:"handlePlayerTournament",value:function(e){var t,n=Jg.getMatchState();if(n&&n.mode===Ty.TOURNAMENT&&!ft.isInContextGlobalTournament()){var i=ft.inst.playerTournaments;if(void 0!==i)if(i.some((function(e){return e.getID()===n.customData.tournamentId}))){var a=Zg.getPlayerId();null!==(t=n.profiles)&&void 0!==t&&t[a]&&(n.profiles[a].score=e)}}}},{key:"handleSocial",value:function(e){Kg.completeLevel();var t=e.score,n=e.level;Kg.handleSocialOnCompleteLevel(t,n)}},{key:"handleNextLevelData",value:function(e){var t=codex.player.getGameData().level;t===e?nt.nextLevel():nt.setLevel(t)}}]),h}(Gg));g._RF.pop(),g._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var $g,em=function(e){t(r,e);var a=n(r);function r(e){var t;return i(this,r),(t=a.call(this,e)).gameplay.uiManager.enableUI(),t}return o(r,[{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"autoFinish",value:function(){var e=this.manager.createGameFinishState();this.manager.change(e)}},{key:"nextLevel",value:function(){var e=this.manager.createNextLevelState();this.manager.change(e)}},{key:"update",value:function(){}},{key:"gameOver",value:function(){var e=this.manager.createGameOverState();this.manager.change(e)}}]),r}(Gg);g._RF.pop(),g._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var tm,nm,im,am,rm,om,sm,lm,um,cm,hm,pm=(0,m.ccclass)("StateManager")($g=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"gameplay",get:function(){return this._gameplay}},{key:"init",value:function(e){this._gameplay=e,this.state=new jg(this)}},{key:"change",value:function(e){this.state=e}},{key:"load",value:function(){this.state.load()}},{key:"initialize",value:function(){this.state.initialize()}},{key:"ready",value:function(){this.state.ready()}},{key:"nextLevel",value:function(){this.state.nextLevel()}},{key:"autoFinish",value:function(){this.state.autoFinish()}},{key:"gameOver",value:function(){this.state.gameOver()}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){return new Vg(this)}},{key:"createLoadingState",value:function(){return new jg(this)}},{key:"createReadyState",value:function(){return new em(this)}},{key:"createNextLevelState",value:function(){return new Qg(this)}},{key:"createGameFinishState",value:function(){return new Hg(this)}},{key:"createGameOverState",value:function(){return new Wg(this)}},{key:"isGamePlaying",value:function(){return this.state instanceof em}}]),r}(k))||$g;g._RF.pop(),g._RF.push({},"4e147JaekpHbKk0tbNod1MR","DailyQuestHeader",void 0);var dm,fm,ym,vm,gm,mm=m.ccclass,bm=m.property,Sm=(m.requireComponent,codex.event),wm=(tm=mm("DailyQuestHeader"),nm=bm(X),im=bm(Ws),am=bm(X),rm=bm(E),tm((lm=e((sm=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"taskTitle",lm,r(e)),a(e,"progressBar",um,r(e)),a(e,"progressTitle",cm,r(e)),a(e,"icon",hm,r(e)),e.currentTimeout=void 0,e.onCompleteQuest=function(t){C.getScene().name===St.GAME_SCENE&&(e.currentTimeout&&(clearTimeout(e.currentTimeout),e.currentTimeout=void 0),e.updateTask(t),e.show(),e.currentTimeout=setTimeout((function(){e.hide()}),2500))},e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.node.active=!1,this.baseX=this.node.position.x,this.baseY=this.node.position.y,this.listenEvents(),this.taskTitleLocalize=this.taskTitle.getComponent(gh)}},{key:"onDestroy",value:function(){this.unListenEvents()}},{key:"listenEvents",value:function(){Sm.on(wt.COMPLETE_QUEST,this.onCompleteQuest)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"unListenEvents",value:function(){Sm.off(wt.COMPLETE_QUEST,this.onCompleteQuest)}},{key:"show",value:function(){this.node.active=!0,this.node.position=new F(this.baseX,this.baseY+449,0),B(this.node).to(.5,{position:new F(this.baseX,this.baseY,0)},{easing:re.backOut}).start()}},{key:"hide",value:function(){var e=this;B(this.node).to(.5,{position:new F(this.baseX,this.baseY+449,0)},{easing:re.backIn}).call((function(){e.node.active=!1})).start()}},{key:"setTaskTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.taskTitleLocalize||(this.taskTitleLocalize=this.taskTitle.getComponent(gh)),this.taskTitleLocalize.key=e,this.taskTitleLocalize.setParams(t)}},{key:"setProgressTitle",value:function(e){this.progressTitle.string=e}},{key:"setProgressBar",value:function(e){this.progressBar.setProgress(e)}},{key:"updateTask",value:function(e){var t=[];switch(e.type.name){case"CompleteLevel":case"UseItem":case"Match":t.push(e.target.toString());break;case"ReachCombo":t.push(e.type.minCombo.toString()),t.push(e.target.toString())}this.setTaskTitle(e.description,t),this.setProgressTitle("".concat(e.current,"/").concat(e.target));var n=e.current<=e.target?e.current/e.target:1;this.setProgressBar(n),this.icon.node.active=1===n}}]),l}(k)).prototype,"taskTitle",[nm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),um=e(sm.prototype,"progressBar",[im],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cm=e(sm.prototype,"progressTitle",[am],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hm=e(sm.prototype,"icon",[rm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(sm.prototype,"show",[bt],Object.getOwnPropertyDescriptor(sm.prototype,"show"),sm.prototype),e(sm.prototype,"hide",[bt],Object.getOwnPropertyDescriptor(sm.prototype,"hide"),sm.prototype),om=sm))||om);g._RF.pop(),g._RF.push({},"102bcXZy2xNS5WJJUUDaCPd","EventUIManager",void 0);var km,Tm,Cm,Em,Lm,xm,Im,Am,Rm,Pm,_m,Nm,Om,Bm,Dm,Fm=m.ccclass,Mm=m.property,zm=(dm=Fm("EventUIManager"),fm=Mm(A),dm((gm=e((vm=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"headerParent",gm,r(e)),e.dailyQuestHeader=null,e}return o(l,[{key:"start",value:function(){this.createDailyQuestHeader()}},{key:"createDailyQuestHeader",value:function(){var e=this;this.dailyQuestHeader?this.dailyQuestHeader.node.active=!0:(Pe.loadPrefabAsync(Ze.DAILY_QUEST_HEADER_PREFAB).then((function(t){e.dailyQuestHeader=K(t).getComponent(wm),e.dailyQuestHeader.node.setParent(e.headerParent)})),console.log("DailyQuestHeader created"))}}]),l}(k)).prototype,"headerParent",[fm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ym=vm))||ym);g._RF.pop(),g._RF.push({},"193a0wYCqRC97SFD7aKGmaE","ItemButtonContainer",void 0);var Um,Gm,Hm,Wm,Vm,jm,qm,Km,Ym,Jm=m.ccclass,Zm=m.property,Xm=(km=Jm("ItemButtonContainer"),Tm=Zm({type:W(lt)}),Cm=Zm(N),Em=Zm(E),Lm=Zm(X),xm=Zm(E),Im=Zm([ae]),km((Pm=e((Rm=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"itemEnum",Pm,r(e)),a(e,"buttonComponent",_m,r(e)),a(e,"counterSprite",Nm,r(e)),a(e,"counterLabel",Om,r(e)),a(e,"counterInfinitySprite",Bm,r(e)),a(e,"counterSpriteFrames",Dm,r(e)),e.isInfinity=!1,e}return o(l,[{key:"setActive",value:function(e){this.node.active=e}},{key:"setInteractable",value:function(e){this.buttonComponent.interactable=e}},{key:"setCounter",value:function(e){this.isInfinity||(e<=0?(this.counterLabel.string="",this.counterSprite.spriteFrame=this.counterSpriteFrames[0]):(this.counterLabel.string=e.toString(),this.counterSprite.spriteFrame=this.counterSpriteFrames[1]))}},{key:"setInfinity",value:function(e){this.isInfinity=e,e?(this.counterLabel.node.active=!1,this.counterSprite.spriteFrame=this.counterSpriteFrames[1]):this.counterLabel.node.active=!0,this.counterInfinitySprite.node.active=e}}]),l}(k)).prototype,"itemEnum",[Tm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_m=e(Rm.prototype,"buttonComponent",[Cm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nm=e(Rm.prototype,"counterSprite",[Em],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Om=e(Rm.prototype,"counterLabel",[Lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bm=e(Rm.prototype,"counterInfinitySprite",[xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dm=e(Rm.prototype,"counterSpriteFrames",[Im],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Am=Rm))||Am);g._RF.pop(),g._RF.push({},"14e060+CQZBg5pxaWXrlnuC","Footer",void 0);var Qm,$m,eb,tb,nb,ib,ab,rb,ob,sb=m.ccclass,lb=m.property,ub=Ludex.Utils.Signal,cb=(Um=sb("Footer"),Gm=lb(Xm),Hm=lb(Xm),Wm=lb(Xm),Um((qm=e((jm=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"hintButton",qm,r(e)),a(e,"undoButton",Km,r(e)),a(e,"shuffleButton",Ym,r(e)),e.widget=null,e.uiTransform=null,e.defaultBottom=-350,e.moveSignalController=new ub.SignalController,e}return o(h,[{key:"height",get:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(L)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||0}},{key:"positionY",get:function(){return this.postAdsPositionY}},{key:"onDestroy",value:function(){this.node.scene.off($e.ITEM_CONFIG_CHANGE,this.handleItemConfigChange,this),this.node.scene.off($e.ITEM_COUNT_CHANGE,this.handleItemCountChange,this)}},{key:"onLoad",value:function(){var e=je.getBannerAdsHeight();this.widget||(this.widget=this.node.getComponent(z)),this.widget&&e&&(this.widget.bottom=e),this.defaultBottom=e,console.log("Footer: onLoad",this.widget.bottom,e),this.validateRequiredComponents(),this.listenEvents()}},{key:"start",value:function(){this.postAdsPositionY=this.node.position.y,this.runHideAnimation(0)}},{key:"listenEvents",value:function(){this.node.scene.on($e.ITEM_CONFIG_CHANGE,this.handleItemConfigChange,this),this.node.scene.on($e.ITEM_COUNT_CHANGE,this.handleItemCountChange,this)}},{key:"handleItemCountChange",value:function(e,t){e===lt.HINT?this.hintButton.setCounter(t):e===lt.UNDO?this.undoButton.setCounter(t):e===lt.SHUFFLE&&this.shuffleButton.setCounter(t)}},{key:"handleItemConfigChange",value:function(e,t){e===lt.HINT?(this.hintButton.setActive(t!==ht.DISABLE),this.hintButton.setInfinity(t===ht.INFINITE)):e===lt.UNDO?(this.undoButton.setActive(t!==ht.DISABLE),this.undoButton.setInfinity(t===ht.INFINITE)):e===lt.SHUFFLE&&(this.shuffleButton.setActive(t!==ht.DISABLE),this.shuffleButton.setInfinity(t===ht.INFINITE))}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"disableButtons",value:function(){this.hintButton.setInteractable(!1),this.undoButton.setInteractable(!1),this.shuffleButton.setInteractable(!1)}},{key:"enableButtons",value:function(){this.hintButton.setInteractable(!0),this.undoButton.setInteractable(!0),this.shuffleButton.setInteractable(!0)}},{key:"runShowAnimation",value:function(e){if(this.node.active=!0,e<=0)return this.moveSignalController.abort(),void(this.widget.bottom=this.defaultBottom);var t=this.moveSignalController.renew(),n=B(this.widget).to(e,{bottom:this.defaultBottom},{easing:"backOut"});Ve.runTweenAsync(n,t)}},{key:"runHideAnimation",value:(u=s(l().mark((function e(t){var n,i,a,r=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.getVisibleSize().height,!(t<=0)){e.next=6;break}return this.moveSignalController.abort(),this.widget.bottom=this.defaultBottom-n/4,this.node.active=!1,e.abrupt("return");case 6:return i=this.moveSignalController.renew(),a=B(this.widget).to(t,{bottom:this.defaultBottom-n/4},{easing:"backIn"}).call((function(){r.node.active=!1})),e.next=10,Ve.runTweenAsync(a,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleClickHintButton",value:function(){console.log("handleClickHintButton"),this.node.scene.emit($e.USE_ITEM,lt.HINT,!0,h.name)}},{key:"handleClickUndoButton",value:function(){console.log("handleClickUndoButton"),this.node.scene.emit($e.USE_ITEM,lt.UNDO,!0,h.name)}},{key:"handleClickShuffleButton",value:function(){console.log("handleClickShuffleButton"),this.node.scene.emit($e.USE_ITEM,lt.SHUFFLE,!0,h.name)}}]),h}(k)).prototype,"hintButton",[Gm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Km=e(jm.prototype,"undoButton",[Hm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ym=e(jm.prototype,"shuffleButton",[Wm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vm=jm))||Vm);g._RF.pop(),g._RF.push({},"b944dFTE2NIL6O1YyyzwMDx","PlayerAvatar",void 0);var hb,pb,db,fb,yb,vb,gb,mb,bb,Sb,wb,kb=m.ccclass,Tb=m.property,Cb=(Qm=kb("PlayerAvatar"),$m=Tb(E),eb=Tb(X),tb=Tb(ae),Qm((ab=e((ib=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"avatar",ab,r(e)),a(e,"playerName",rb,r(e)),a(e,"baseSpriteFrame",ob,r(e)),e}return o(d,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.uiTransform=this.avatar.node.getComponent(L)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updatePlayerAvatar",value:(h=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playerName.string=t.playerName,e.next=3,this.setAvatar(t.avatarUrl);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setAvatar",value:(c=s(l().mark((function e(t){var n,i,a=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.avatar){e.next=2;break}return e.abrupt("return");case 2:if(t&&""!==t){e.next=5;break}return this.avatar.spriteFrame=this.baseSpriteFrame,e.abrupt("return");case 5:return e.next=7,Ludex.Utils.Image.loadImage(t||"");case 7:if(n=e.sent,i=ae.createWithImage(n)){e.next=13;break}return this.avatar.spriteFrame=this.baseSpriteFrame,this.scheduleOnce((function(){a.preloadAvatar(t)}),1),e.abrupt("return");case 13:this.avatar.spriteFrame=i;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"preloadAvatar",value:(u=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ludex.Utils.Image.loadImage(t||"");case 2:if(n=e.sent,i=ae.createWithImage(n)){e.next=7;break}return console.warn("Failed to preload avatar image:",t),e.abrupt("return");case 7:this.avatar.spriteFrame=i;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),d}(k)).prototype,"avatar",[$m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rb=e(ib.prototype,"playerName",[eb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ob=e(ib.prototype,"baseSpriteFrame",[tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nb=ib))||nb);g._RF.pop(),g._RF.push({},"655e6G+LGZPF6nEre9OWJx9","ChallengeBlock",void 0);var Eb,Lb,xb,Ib,Ab,Rb,Pb,_b,Nb,Ob,Bb,Db,Fb=m.ccclass,Mb=m.property,zb=(m.requireComponent,codex),Ub=zb.player,Gb=zb.match,Hb=(hb=Fb("ChallengeBlock"),pb=Mb(Cb),db=Mb(Cb),fb=Mb(X),yb=Mb(X),hb((mb=e((gb=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"playerAvatar",mb,r(e)),a(e,"opponentAvatar",bb,r(e)),a(e,"playerScore",Sb,r(e)),a(e,"opponentScore",wb,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updateChallengeData",value:function(){this.updatePlayerChallengeData(),this.updateOpponentChallengeData()}},{key:"updatePlayerChallengeData",value:function(){var e=Ub.getPlayer().playerId,t=codex.match.getMatchState().profiles;if(!t||!t[e])return console.warn("Player profile not found in match state"),void this.playerAvatar.updatePlayerAvatar({playerName:"You",avatarUrl:""});var n=t[e],i=n.name,a=n.photo,r=n.score,o=void 0===r?0:r;this.playerAvatar.updatePlayerAvatar({playerName:i,avatarUrl:a}),this.playerScore.string=o.toString()}},{key:"updateOpponentChallengeData",value:function(){var e=Gb.getMatchState().customData.opponentId,t=codex.match.getMatchState().profiles;if(!t||!t[e])return console.warn("Player profile not found in match state"),void this.opponentAvatar.updatePlayerAvatar({playerName:"Your friend",avatarUrl:""});var n=t[e],i=n.name,a=n.photo,r=n.score,o=void 0===r?0:r;this.opponentAvatar.updatePlayerAvatar({playerName:i,avatarUrl:a}),this.opponentScore.string=o.toString()}},{key:"setPlayerScoreText",value:function(e){this.playerScore.string=e.toString()}}]),l}(k)).prototype,"playerAvatar",[pb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bb=e(gb.prototype,"opponentAvatar",[db],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sb=e(gb.prototype,"playerScore",[fb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wb=e(gb.prototype,"opponentScore",[yb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vb=gb))||vb);g._RF.pop(),g._RF.push({},"6ebbbXu0D9KaIDvuqL2XNW8","PlayerAvatarWithFlag",void 0);var Wb,Vb,jb,qb,Kb,Yb,Jb,Zb,Xb,Qb,$b,eS,tS,nS,iS,aS,rS,oS=m.ccclass,sS=m.property,lS=m.executeInEditMode,uS=(Eb=oS("PlayerAvatarWithFlag"),Lb=lS(!0),xb=sS(Cb),Ib=sS(X),Ab=sS(E),Rb=sS(A),Eb(Pb=Lb((Nb=e((_b=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"playerAvatar",Nb,r(e)),a(e,"scoreLabel",Ob,r(e)),a(e,"glow",Bb,r(e)),a(e,"medal",Db,r(e)),e}return o(l,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.glow.node.active=!1}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"runGlowRotateAnimation",value:function(){this.glow.node.active||(this.glow.node.active=!0,this.glow.node.angle=0,this.glowTween||(this.glowTween=B(this.glow.node).set({angle:0}).by(5,{angle:360},{easing:"linear"}).repeatForever()),this.glowTween.start())}},{key:"stopGlowRotateAnimation",value:function(){var e;this.glow.node.active&&(this.glow.node.angle=0,this.glow.node.active=!1,null===(e=this.glowTween)||void 0===e||e.stop())}},{key:"updateState",value:function(e){switch(e){case"win":this.medal.active=!0,this.runGlowRotateAnimation();break;case"lose":case"waiting":this.medal.active=!1,this.stopGlowRotateAnimation()}}}]),l}(k)).prototype,"playerAvatar",[xb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ob=e(_b.prototype,"scoreLabel",[Ib],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bb=e(_b.prototype,"glow",[Ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Db=e(_b.prototype,"medal",[Rb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pb=_b))||Pb)||Pb);g._RF.pop(),g._RF.push({},"41014it/XdB5Y0t7yR+iDx/","ChallengePrepare",void 0);var cS,hS,pS,dS,fS,yS=m.ccclass,vS=m.property,gS=(m.requireComponent,codex),mS=gS.player,bS=(gS.event,gS.match),SS=(Wb=yS("ChallengePrepare"),Vb=vS(P),jb=vS(uS),qb=vS(uS),Kb=vS(E),Yb=vS(A),Jb=vS(A),Zb=vS(P),Wb(($b=e((Qb=function(e){t(y,e);var u,c,h,p,d,f=n(y);function y(){var e;i(this,y);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=f.call.apply(f,[this].concat(n)),a(e,"backgroundMask",$b,r(e)),a(e,"playerAvatarWithFlag",eS,r(e)),a(e,"opponentAvatarWithFlag",tS,r(e)),a(e,"vsIcon",nS,r(e)),a(e,"blueBG",iS,r(e)),a(e,"redBG",aS,r(e)),a(e,"light",rS,r(e)),e}return o(y,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.playerAvatarOpacity=this.playerAvatarWithFlag.getComponent(P),this.opponentAvatarOpacity=this.opponentAvatarWithFlag.getComponent(P),this.vsIconOpacity=this.vsIcon.getComponent(P),this.backgroundMask.opacity=0,this.backgroundMask.node.active=!1,this.playerAvatarOpacity.opacity=0,this.opponentAvatarOpacity.opacity=0,this.vsIconOpacity.opacity=0,this.basePlayerAvatarPosition={x:this.playerAvatarWithFlag.node.position.x,y:this.playerAvatarWithFlag.node.position.y},this.baseOpponentAvatarPosition={x:this.opponentAvatarWithFlag.node.position.x,y:this.opponentAvatarWithFlag.node.position.y},this.blueBGOpacity=this.blueBG.getComponent(P),this.redBGOpacity=this.redBG.getComponent(P),this.blueBGUITransform=this.blueBG.getComponent(L),this.redBGUITransform=this.redBG.getComponent(L)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updateChallengeData",value:(d=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(this.updatePlayerChallengeData()),t.push(this.updateOpponentChallengeData()),e.next=5,Promise.all(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"updatePlayerChallengeData",value:(p=s(l().mark((function e(){var t,n,i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=mS.getPlayer(),n=t.playerId,i=codex.match.getMatchState(),(a=i.profiles)&&a[n]){e.next=5;break}return console.warn("Player profile not found in match state"),e.abrupt("return");case 5:return r=a[n],o=r.name,s=r.photo,e.next=8,this.playerAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:o,avatarUrl:s});case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updateOpponentChallengeData",value:(h=s(l().mark((function e(){var t,n,i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bS.getMatchState(),n=t.customData.opponentId,i=codex.match.getMatchState(),(a=i.profiles)&&a[n]){e.next=6;break}return console.warn("Player profile not found in match state"),e.abrupt("return");case 6:return r=a[n],o=r.name,s=r.photo,e.next=9,this.opponentAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:o,avatarUrl:s});case 9:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"resizeBeforeRunAnimation",value:function(){var e=I.getVisibleSize(),t=e.width,n=(e.height-254)/2,i=this.blueBGUITransform.contentSize,a=i.width,r=i.height,o=this.redBGUITransform.contentSize,s=o.width,l=o.height;if(Oe.getCurrentLayout()===Be.Layout.Portrait)this.blueBG.setScale(new F(t/a,n/r,1)),this.redBG.setScale(new F(t/s,n/l,1));else{var u=.7*t;this.blueBG.setScale(new F(u/a,n/r,1)),this.redBG.setScale(new F(u/s,n/l,1))}}},{key:"runAnimationPrepareChallenge",value:(c=s(l().mark((function e(){var t,n,i=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resizeBeforeRunAnimation(),this.backgroundMask.node.active=!0,this.backgroundMask.opacity=0,this.playerAvatarOpacity.opacity=0,this.opponentAvatarOpacity.opacity=0,this.vsIconOpacity.opacity=0,this.vsIcon.node.setScale(new F(0,0,1)),this.blueBGOpacity.opacity=0,this.redBGOpacity.opacity=0,this.light.opacity=0,this.playerAvatarWithFlag.node.setPosition(this.basePlayerAvatarPosition.x+500,this.basePlayerAvatarPosition.y),this.opponentAvatarWithFlag.node.setPosition(this.baseOpponentAvatarPosition.x-500,this.baseOpponentAvatarPosition.y),t=.45,n=.3,B(this.backgroundMask).to(t,{opacity:204}).start(),B(this.playerAvatarWithFlag.node).to(t,{x:this.basePlayerAvatarPosition.x,y:this.basePlayerAvatarPosition.y}).start(),B(this.playerAvatarOpacity).to(n,{opacity:255}).start(),B(this.opponentAvatarWithFlag.node).to(t,{x:this.baseOpponentAvatarPosition.x,y:this.baseOpponentAvatarPosition.y}).start(),B(this.opponentAvatarOpacity).to(n,{opacity:255}).start(),B(this.blueBGOpacity).to(n,{opacity:255}).start(),B(this.redBGOpacity).to(n,{opacity:255}).start(),B(this.light).to(n,{opacity:255}).start(),B(this.vsIconOpacity).to(n,{opacity:255}).start(),B(this.vsIcon.node).to(t,{scale:new F(1,1,1)}).start(),e.abrupt("return",new Promise((function(e){kt(1e3*Math.max(t,n)).then((function(){e(),i.runFadeOutAnimation(n,.75).then((function(){try{i.backgroundMask.opacity=0,i.playerAvatarOpacity.opacity=0,i.opponentAvatarOpacity.opacity=0,i.vsIconOpacity.opacity=0,i.backgroundMask.node.active=!1}catch(e){}}))}))})));case 26:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runFadeOutAnimation",value:(u=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:.3,n=i.length>1&&void 0!==i[1]?i[1]:0,B(this.backgroundMask).delay(n).to(t,{opacity:0}).start(),B(this.playerAvatarOpacity).delay(n).to(t,{opacity:0}).start(),B(this.opponentAvatarOpacity).delay(n).to(t,{opacity:0}).start(),B(this.blueBGOpacity).delay(n).to(t,{opacity:0}).start(),B(this.redBGOpacity).delay(n).to(t,{opacity:0}).start(),B(this.light).delay(n).to(t,{opacity:0}).start(),B(this.vsIconOpacity).delay(n).to(t,{opacity:0}).start(),B(this.vsIcon.node).delay(n).to(t,{scale:new F(0,0,1)}).start(),e.abrupt("return",new Promise((function(e){kt(1e3*(n+t)).then((function(){e()}))})));case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),y}(k)).prototype,"backgroundMask",[Vb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eS=e(Qb.prototype,"playerAvatarWithFlag",[jb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tS=e(Qb.prototype,"opponentAvatarWithFlag",[qb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nS=e(Qb.prototype,"vsIcon",[Kb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iS=e(Qb.prototype,"blueBG",[Yb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aS=e(Qb.prototype,"redBG",[Jb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rS=e(Qb.prototype,"light",[Zb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xb=Qb))||Xb);g._RF.pop(),g._RF.push({},"05852I/xmhCyadhw9xtxUjf","ComboNumber",void 0);var wS,kS,TS,CS,ES,LS,xS,IS,AS,RS,PS,_S,NS,OS,BS,DS,FS,MS,zS=m.ccclass,US=m.property,GS=(cS=zS("ComboNumber"),hS=US(E),cS((fS=e((dS=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"comboNumberSprite",fS,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"setComboNumber",value:function(e){this.comboNumberSprite.spriteFrame=e}}]),l}(k)).prototype,"comboNumberSprite",[hS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pS=dS))||pS);g._RF.pop(),g._RF.push({},"4b919O7ovpFR4PdgLD9Eopa","ComboText",void 0);var HS,WS,VS,jS,qS,KS,YS,JS=m.ccclass,ZS=m.property,XS=(wS=JS("ComboText"),kS=ZS(b),TS=ZS(A),CS=ZS(oe),ES=ZS(E),LS=ZS(q),xS=ZS(GS),IS=ZS(ae),wS((PS=e((RS=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"animationComponent",PS,r(e)),a(e,"parentNode",_S,r(e)),a(e,"comboNumberLayout",NS,r(e)),a(e,"glowEffectSprite",OS,r(e)),a(e,"showClipName",BS,r(e)),a(e,"comboNumberPrefab",DS,r(e)),a(e,"spawnedComboNumber",FS,r(e)),a(e,"numebrSprites",MS,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.parentNode.active=!1}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"runShowComboTextAnimation",value:function(e,t){var n,i,a=this;this.setComboNumber(e),this.parentNode.active=!0,this.comboNumberLayout.updateLayout(!0);var r=null!==(n=null===(i=this.comboNumberLayout.getComponent(L))||void 0===i?void 0:i.contentSize.x)&&void 0!==n?n:0;this.glowEffectSprite.node.position=new F(this.comboNumberLayout.node.position.x+r/2,this.glowEffectSprite.node.position.y,this.glowEffectSprite.node.position.z),this.parentNode.active=!1,this.scheduleOnce((function(){a.runAnimation(a.showClipName)}),t)}},{key:"stopShowComboAnimation",value:function(){this.unscheduleAllCallbacks(),this.animationComponent.stop(),this.parentNode.active=!1}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"setComboNumber",value:function(e){for(var t=0;t<this.spawnedComboNumber.length;t++){var n=this.spawnedComboNumber[t];n&&(n.node.active=!1)}for(var i=e,a=[];i>0;){var r=i%10;i=Math.floor(i/10),a.push(r)}a.reverse();for(var o=0;o<a.length;o++){var s,l,u=null!==(s=a[o])&&void 0!==s?s:0,c=null!==(l=this.spawnedComboNumber[o])&&void 0!==l?l:this.spawnComboNumber(),h=this.getSpriteFrameByNumber(u);if(!c||!h)return;c.node.active=!0,c.setComboNumber(h)}}},{key:"getSpriteFrameByNumber",value:function(e){var t;return e<0||e>=this.numebrSprites.length?null:null!==(t=this.numebrSprites[e])&&void 0!==t?t:null}},{key:"spawnComboNumber",value:function(){var e=K(this.comboNumberPrefab),t=e.getComponent(GS);return t?(this.spawnedComboNumber.push(t),this.comboNumberLayout.node.addChild(e),t):null}}]),l}(k)).prototype,"animationComponent",[kS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_S=e(RS.prototype,"parentNode",[TS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NS=e(RS.prototype,"comboNumberLayout",[CS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OS=e(RS.prototype,"glowEffectSprite",[ES],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BS=e(RS.prototype,"showClipName",[ZS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ComboTextShow"}}),DS=e(RS.prototype,"comboNumberPrefab",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FS=e(RS.prototype,"spawnedComboNumber",[xS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),MS=e(RS.prototype,"numebrSprites",[IS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),AS=RS))||AS);g._RF.pop(),g._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var QS,$S,ew,tw,nw,iw,aw,rw,ow,sw=m.ccclass,lw=m.property,uw=codex,cw=uw.player,hw=(uw.analytics,Ludex.Utils.Signal),pw=(HS=sw("Header"),WS=lw(A),VS=lw(A),HS((KS=e((qS=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"pauseNode",KS,r(e)),a(e,"backNode",YS,r(e)),e.uiTransform=null,e.widget=null,e.moveSignalController=new hw.SignalController,e}return o(p,[{key:"height",get:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(L)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||0}},{key:"positionY",get:function(){return this.postAdsPositionY}},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"onLoad",value:function(){this.widget||(this.widget=this.getComponent(z)),this.validateRequiredComponents()}},{key:"start",value:function(){this.postAdsPositionY=this.node.position.y,this.runHideAnimation(0)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"handleClickedPauseGame",value:function(){this.showSettingScreen(),this.node.scene.emit($e.GAME_PAUSE)}},{key:"handleClickedReplayGame",value:function(){var e,t=(null!==(e=cw.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;this.node.scene.emit($e.GAME_REPLAY,{level:n})}},{key:"handleClickDashboardButton",value:(c=s(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.logEndGame(),this.node.scene.emit($e.GAME_PAUSE),this.node.scene.emit($e.SWITCH_SCENE,(function(){t.handleSwitchToDashboardScene()}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleSwitchToDashboardScene",value:function(){if(rt.getSpecialMode()===ot.JOURNEY&&!tt.canUpdateIncreaseSeason())return void Tt.switchToDashboardScene({screen:Ge.JOURNEY_LEVEL_SCREEN,screenData:{customData:{completedLevel:tt.getCompletedLevel(),useNextLevelAnimation:!1},openAnimationName:"FadeInInstant"}});Tt.switchToDashboardScene()}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=nt.getLevel(),n=e.getCurrentScore();We.logLevelEnd(t,n,!1)}},{key:"showSettingScreen",value:function(){pt.openScreen(Ge.SETTINGS_SCREEN,{})}},{key:"disableButtons",value:function(){this.enableBtnNode(this.pauseNode,!1,!0),this.enableBtnNode(this.backNode,!1,!0)}},{key:"enableButtons",value:function(){this.enableBtnNode(this.pauseNode,!0,!0),this.enableBtnNode(this.backNode,!0,!0)}},{key:"runShowAnimation",value:function(e){if(this.node.active=!0,e<=0)return this.moveSignalController.abort(),void(this.widget.top=0);var t=this.moveSignalController.renew(),n=B(this.widget).to(e,{top:0},{easing:"backOut"});Ve.runTweenAsync(n,t)}},{key:"runHideAnimation",value:(u=s(l().mark((function e(t){var n,i,a,r=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.getVisibleSize().height,!(t<=0)){e.next=6;break}return this.moveSignalController.abort(),this.widget.top=-n/4,this.node.active=!1,e.abrupt("return");case 6:return i=this.moveSignalController.renew(),a=B(this.widget).to(t,{top:-n/4},{easing:"backIn"}).call((function(){r.node.active=!1})),e.next=10,Ve.runTweenAsync(a,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"enableBtnNode",value:function(e,t,n){var i=e.getComponent(N);if(i&&(i.interactable=t),e.active=n,n){var a=e.getComponent(qo);a&&a.changeState(t)}}}]),p}(k)).prototype,"pauseNode",[WS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YS=e(qS.prototype,"backNode",[VS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jS=qS))||jS);g._RF.pop(),g._RF.push({},"2eef7j8rrtGmpY2hcs0A7yh","HeaderTileMatchProjectile",void 0);var dw,fw,yw,vw,gw,mw,bw,Sw,ww,kw,Tw,Cw,Ew,Lw,xw,Iw=m.ccclass,Aw=m.property,Rw=(Ludex.Utils.Signal,QS=Iw("HeaderTileMatchProjectile"),$S=Aw(se),ew=Aw(ee),tw=Aw(ee),QS((aw=e((iw=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"motionStreakComponent",aw,r(e)),a(e,"trailSystemComponent",rw,r(e)),a(e,"explodeSystemComponent",ow,r(e)),e}return o(h,[{key:"reset",value:function(){this.node.setPosition(new F(0,0,0)),this.node.active=!0,this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1,this.trailSystemComponent.resetSystem()}},{key:"hide",value:function(){this.node.setPosition(new F(0,0,0)),this.node.active=!1,this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1}},{key:"playCollectAnimation",value:(u=s(l().mark((function e(t,n,i,a,r,o){var s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.motionStreakComponent.node.active=!0,this.trailSystemComponent.node.active=!0,s=Ve.runTweenAsync(B(this.node).delay(r).to(.3,{worldPositionX:a},{easing:"sineOut"}).to(.35,{worldPositionX:n},{easing:"sineIn"}),t),Ve.runTweenAsync(B(this.node).delay(r).to(.65,{worldPositionY:i},{easing:"sineIn"}),t),e.next=6,s;case 6:null==o||o(),this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,r){return u.apply(this,arguments)})},{key:"playExplodeAnimation",value:function(e){this.explodeSystemComponent.resetSystem()}}]),h}(k)).prototype,"motionStreakComponent",[$S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rw=e(iw.prototype,"trailSystemComponent",[ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ow=e(iw.prototype,"explodeSystemComponent",[tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nw=iw))||nw);g._RF.pop(),g._RF.push({},"c796dG6wFFGM5XaOlhgskWL","TileStatContainer",void 0);var Pw,_w,Nw,Ow,Bw,Dw,Fw,Mw,zw,Uw,Gw,Hw,Ww,Vw=m.ccclass,jw=m.property,qw=(dw=Vw("TileStatContainer"),fw=jw(E),yw=jw(E),vw=jw(E),gw=jw(X),mw=jw(E),bw=jw(A),dw((kw=e((ww=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"backgroundSprite",kw,r(e)),a(e,"itemSprite",Tw,r(e)),a(e,"coverEffect",Cw,r(e)),a(e,"countLabel",Ew,r(e)),a(e,"checkSprite",Lw,r(e)),a(e,"parentTile",xw,r(e)),e}return o(l,[{key:"setJourneyMissionTileSet",value:function(e,t){this.journeyMissionTileSet=e,t?this.countLabel.node.setPosition(0,-43):this.countLabel.node.setPosition(40,-43),this.updateCount(e.count)}},{key:"updateCount",value:function(e){e>0?(this.countLabel.string=e.toString(),this.countLabel.enabled=!0,this.checkSprite.node.active=!1):(this.countLabel.enabled=!1,this.checkSprite.node.active=!0)}},{key:"updateSprite",value:function(e,t,n){this.backgroundSprite.node.active=!!e,this.backgroundSprite.spriteFrame=e,this.itemSprite.node.active=!!t,this.itemSprite.spriteFrame=t,this.coverEffect.node.active=!!n,this.coverEffect.spriteFrame=n}}]),l}(k)).prototype,"backgroundSprite",[fw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tw=e(ww.prototype,"itemSprite",[yw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cw=e(ww.prototype,"coverEffect",[vw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ew=e(ww.prototype,"countLabel",[gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=e(ww.prototype,"checkSprite",[mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xw=e(ww.prototype,"parentTile",[bw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sw=ww))||Sw);g._RF.pop(),g._RF.push({},"623a4S+KKJHa5mExB5qXd7o","JourneyBlock",void 0);var Kw,Yw,Jw,Zw,Xw,Qw,$w,ek,tk,nk,ik,ak,rk,ok=m.ccclass,sk=m.property,lk=Ludex.Utils.Signal,uk=(Pw=ok("JourneyBlock"),_w=sk(oe),Nw=sk(q),Ow=sk(q),Bw=sk(A),Dw=sk(P),Pw((zw=e((Mw=function(e){t(y,e);var u,c,h,p,f=n(y);function y(){var e;i(this,y);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=f.call.apply(f,[this].concat(n)),a(e,"layout",zw,r(e)),a(e,"tileStatContainerPrefab",Uw,r(e)),a(e,"headerTileMatchProjectilePrefab",Gw,r(e)),a(e,"glowNode",Hw,r(e)),a(e,"opacity",Ww,r(e)),e.totalCount=0,e.signalController=new lk.SignalController,e.activeTileStatContainers=[],e.inactiveTileStatContainers=[],e.projectiles=[],e}return o(y,[{key:"onEnable",value:function(){this.listenEvents(),this.signal=this.signalController.renew()}},{key:"onDisable",value:function(){this.unlistenEvents(),this.signal.abort();var e,t=d(this.projectiles);try{for(t.s();!(e=t.n()).done;){e.value.hide()}}catch(e){t.e(e)}finally{t.f()}var n,i=d(this.activeTileStatContainers);try{for(i.s();!(n=i.n()).done;){n.value.node.scale=new F(1,1,1)}}catch(e){i.e(e)}finally{i.f()}}},{key:"listenEvents",value:function(){this.node.scene.on($e.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.on($e.MISSION_TILE_SET_COLLECT,this.runCollectAnimation,this),this.node.scene.on($e.MISSION_TILE_SET_UPDATE,this.updateCount,this)}},{key:"unlistenEvents",value:function(){this.node.scene.off($e.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.off($e.MISSION_TILE_SET_COLLECT,this.runCollectAnimation,this),this.node.scene.off($e.MISSION_TILE_SET_UPDATE,this.updateCount,this)}},{key:"updateJourneyData",value:function(e){this.returnAllTileStatContainers();var t,n=e.length>1,i=d(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,r=this.getTileStatContainer(),o=this.getTileItemSprite(a.skinIdx),s=this.getTileBackgroundSprite(a.isEmptyBackground,a.isHidden),l=this.getTileEffectSprite(a.effect);r.updateSprite(s,o,l),r.setJourneyMissionTileSet(a,n),this.totalCount+=a.count}}catch(e){i.e(e)}finally{i.f()}this.layout.updateLayout()}},{key:"getTileStatContainer",value:function(){var e=this.inactiveTileStatContainers.pop();e||(e=K(this.tileStatContainerPrefab).getComponent(qw));return e.node.setParent(this.layout.node),e.node.active=!0,this.activeTileStatContainers.push(e),e}},{key:"returnTileStatContainer",value:function(e){this.activeTileStatContainers.splice(this.activeTileStatContainers.indexOf(e),1),this.inactiveTileStatContainers.push(e),e.node.active=!1,e.node.setParent(null)}},{key:"getTileItemSprite",value:function(e){return e?Ct.includes(e)?tt.getCurrentArtifactTileSprite(e.toString()):Ne.getCurrentItemTileSprite(e.toString()):null}},{key:"getTileBackgroundSprite",value:function(e,t){return e?null:t?Ne.getCurrentTileHiddenSprite():Ne.getCurrentTileBackgroundSprite()}},{key:"getTileEffectSprite",value:function(e){return e?Ne.getEffectSpriteFrame(e):null}},{key:"returnAllTileStatContainers",value:function(){this.inactiveTileStatContainers=this.activeTileStatContainers,this.activeTileStatContainers=[];var e,t=d(this.inactiveTileStatContainers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.node.active=!1,n.node.setParent(null)}}catch(e){t.e(e)}finally{t.f()}}},{key:"getProjectile",value:function(){var e=this.projectiles.pop();e||(e=K(this.headerTileMatchProjectilePrefab).getComponent(Rw));return e.node.setParent(this.node),e.reset(),e}},{key:"returnProjectile",value:function(e){this.projectiles.push(e),e.hide(),e.node.setParent(null)}},{key:"playCollectAnimation",value:(p=s(l().mark((function e(t,n,i){var a,r,o,s=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getProjectile(),r=this.signal,a.node.setWorldPosition(i),o=B(t.node).set({scale:new F(1,1,1)}).delay(.6).to(.1,{scale:new F(.8,.8,.8)},{easing:"cubicIn"}).call((function(){t.journeyMissionTileSet.count>n?t.updateCount(t.journeyMissionTileSet.count):t.updateCount(n),a.playExplodeAnimation(r)})).to(.1,{scale:new F(1,1,1)},{easing:"cubicOut"}).delay(.3).call((function(){s.returnProjectile(a)})),Ve.runTweenAsync(o,r),a.playExplodeAnimation(r),e.next=8,a.playCollectAnimation(r,t.node.worldPosition.x,t.node.worldPosition.y,t.node.worldPosition.x+.2*(t.node.worldPosition.x-i.x),0);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"runCollectAnimation",value:(h=s(l().mark((function e(t,n,i){var a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.activeTileStatContainers.find((function(e){return e.journeyMissionTileSet===t}))){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",this.playCollectAnimation(a,n,i));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"runFinishAnimation",value:(c=s(l().mark((function e(t){var n,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.glowNode.active=!0,this.glowNode.setPosition(new F(-437,0,0)),n=B(this.opacity).to(.5,{opacity:0},{easing:"cubicOut"}),e.next=5,Ve.runTweenAsync(n);case 5:return this.node.setWorldPosition(t),this.node.setScale(new F(1.2,1.2,1)),i=B(this.opacity).to(.5,{opacity:255},{easing:"cubicIn"}),e.next=10,Ve.runTweenAsync(i);case 10:return a=B(this.glowNode).to(.75,{position:new F(437,0,0)},{easing:"linear"}),e.next=13,Ve.runTweenAsync(a);case 13:return r=B(this.opacity).to(.15,{opacity:0},{easing:"cubicOut"}),e.next=16,Ve.runTweenAsync(r);case 16:this.glowNode.active=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"runEntranceAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=o.length>0&&void 0!==o[0]?o[0]:.8,this.opacity.opacity=255,B(this.layout.node).delay(t).to(.3,{scale:new F(1.15,1.15,1)},{easing:"cubicOut"}).delay(.2).to(.3,{scale:new F(1,1,1)},{easing:"backOut"}).start(),n=0,i=.05,a=0;a<this.activeTileStatContainers.length;a++)r=this.activeTileStatContainers[a],B(r.parentTile).delay(t+n+a*i).by(.1,{position:new F(0,5,0)},{easing:"sineIn"}).to(.15,{angle:22},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).to(.1,{angle:13},{easing:"sineInOut"}).to(.1,{angle:-13},{easing:"sineOut"}).to(.02,{angle:-17},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).by(.1,{position:new F(0,-5,0)},{easing:"sineOut"}).start();case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"updateCount",value:function(e,t){var n=this.activeTileStatContainers.find((function(t){return t.journeyMissionTileSet===e}));n&&n.updateCount(t)}},{key:"updateTilesTheme",value:function(){var e,t=d(this.activeTileStatContainers);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=this.getTileItemSprite(n.journeyMissionTileSet.skinIdx||null),a=this.getTileBackgroundSprite(n.journeyMissionTileSet.isEmptyBackground,n.journeyMissionTileSet.isHidden),r=this.getTileEffectSprite(n.journeyMissionTileSet.effect);n.updateSprite(a,i,r)}}catch(e){t.e(e)}finally{t.f()}}}]),y}(k)).prototype,"layout",[_w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uw=e(Mw.prototype,"tileStatContainerPrefab",[Nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gw=e(Mw.prototype,"headerTileMatchProjectilePrefab",[Ow],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=e(Mw.prototype,"glowNode",[Bw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ww=e(Mw.prototype,"opacity",[Dw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fw=Mw))||Fw);g._RF.pop(),g._RF.push({},"8f084a/9CtBTqwIW6SZ7HQ4","SingleBlock",void 0);var ck,hk,pk,dk,fk,yk,vk,gk,mk,bk,Sk,wk,kk,Tk,Ck,Ek,Lk,xk=m.ccclass,Ik=m.property,Ak="#62cea2",Rk="#a0aac0",Pk="#e67072",_k="#ddba8d",Nk="#c98ddd",Ok="#8bcabf",Bk=(Kw=xk("SingleBlock"),Yw=Ik(gh),Jw=Ik(X),Zw=Ik(X),Xw=Ik(X),Qw=Ik([X]),Kw((tk=e((ek=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"levelTitleLabel",tk,r(e)),a(e,"levelText",nk,r(e)),a(e,"matchText",ik,r(e)),a(e,"scoreText",ak,r(e)),a(e,"titleLabels",rk,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"start",value:function(){this.updateColorCode()}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){this.node.scene.on($e.THEME_BACKGROUND_CHANGE,this.updateColorCode,this)}},{key:"unlistenGameEvents",value:function(){this.node.scene.off($e.THEME_BACKGROUND_CHANGE,this.updateColorCode,this)}},{key:"updateColorCode",value:function(){var e;switch(codex.player.getPlayerSetting("theme").background){case Et.BG1:e=Ak;break;case Et.BG2:e=Ok;break;case Et.BG3:e=Rk;break;case Et.BG4:e=_k;break;case Et.BG5:e=Pk;break;case Et.BG6:e=Nk;break;default:e=Ak}var t,n=d(this.titleLabels);try{for(n.s();!(t=n.n()).done;){t.value.color=new Y.Color(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setDateStringText",value:function(e){this.levelTitleLabel.key="date";var t=e.day<10?"0".concat(e.day):e.day.toString(),n=e.month<10?"0".concat(e.month):e.month.toString();this.levelText.string="".concat(n,"/").concat(t)}},{key:"setLevelText",value:function(e){this.levelTitleLabel.key="level",this.levelText.string=e.toString()}},{key:"setScoreText",value:function(e){this.scoreText.string=e.toString()}},{key:"setMatchText",value:function(e){this.matchText.string=e.toString()}}]),l}(k)).prototype,"levelTitleLabel",[Yw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nk=e(ek.prototype,"levelText",[Jw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ik=e(ek.prototype,"matchText",[Zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ak=e(ek.prototype,"scoreText",[Xw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rk=e(ek.prototype,"titleLabels",[Qw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$w=ek))||$w);g._RF.pop(),g._RF.push({},"b105d9yGrBKu7+1O0ftW9oA","RearGlow",void 0);var Dk,Fk,Mk,zk,Uk,Gk=m.ccclass,Hk=m.property,Wk=(ck=Gk("RearGlow"),hk=Hk(E),pk=Hk(E),dk=Hk(F),fk=Hk(F),ck((gk=e((vk=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"glowSprite",gk,r(e)),a(e,"highlightSprite",mk,r(e)),a(e,"easeShowType",bk,r(e)),a(e,"easeHideType",Sk,r(e)),a(e,"glowShowDuration",wk,r(e)),a(e,"highlightMoveDuration",kk,r(e)),a(e,"glowHideDelay",Tk,r(e)),a(e,"glowAlpha",Ck,r(e)),a(e,"fromPosition",Ek,r(e)),a(e,"toPosition",Lk,r(e)),e.glowAlphaTween=null,e.highlightMoveTween=null,e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.node.active=!1}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"runShowAnimation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.glowAlphaTween&&(this.glowAlphaTween.stop(),this.glowAlphaTween=null),this.highlightMoveTween&&(this.highlightMoveTween.stop(),this.highlightMoveTween=null);var n=I.getVisibleSize(),i=this.glowSprite.getComponent(L);i&&i.setContentSize(i.width,n.height),this.node.active=!0,this.highlightSprite.node.active=!0;var a=this.glowSprite.color.clone();a.a=0,this.glowSprite.color=a;var r=this.glowSprite.color.clone();r.a=this.glowAlpha,this.glowAlphaTween=B(this.glowSprite).delay(t).to(this.glowShowDuration,{color:r},{easing:this.easeShowType}).delay(this.glowHideDelay).call((function(){e.runHideAnimation()})).start(),this.highlightSprite.node.setPosition(this.fromPosition),this.highlightMoveTween=B(this.highlightSprite.node).delay(t).to(this.highlightMoveDuration,{position:this.toPosition},{easing:this.easeShowType}).call((function(){e.highlightSprite.node.active=!1})).start()}},{key:"runHideAnimation",value:function(){this.glowAlphaTween&&(this.glowAlphaTween.stop(),this.glowAlphaTween=null);var e=this.glowSprite.color.clone();e.a=0,this.glowAlphaTween=B(this.glowSprite).to(this.glowShowDuration,{color:e},{easing:this.easeHideType}).start()}}]),l}(k)).prototype,"glowSprite",[hk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mk=e(vk.prototype,"highlightSprite",[pk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bk=e(vk.prototype,"easeShowType",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quintOut"}}),Sk=e(vk.prototype,"easeHideType",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quintIn"}}),wk=e(vk.prototype,"glowShowDuration",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),kk=e(vk.prototype,"highlightMoveDuration",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Tk=e(vk.prototype,"glowHideDelay",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),Ck=e(vk.prototype,"glowAlpha",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Ek=e(vk.prototype,"fromPosition",[dk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(0,0,0)}}),Lk=e(vk.prototype,"toPosition",[fk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(0,0,0)}}),yk=vk))||yk);g._RF.pop(),g._RF.push({},"9fb43PViUZF9J3qxgiLVgC9","Sidebar",void 0);var Vk,jk,qk,Kk,Yk,Jk,Zk,Xk,Qk,$k,eT,tT,nT,iT,aT,rT,oT,sT=m.ccclass,lT=m.property,uT=(Dk=sT("Sidebar"),Fk=lT(Wk),Dk((Uk=e((zk=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"rearGlow",Uk,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"runShowRearGlowAnimation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.rearGlow.runShowAnimation(e)}},{key:"runHideRearGlowAnimation",value:function(){this.rearGlow.runHideAnimation()}}]),l}(k)).prototype,"rearGlow",[Fk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mk=zk))||Mk);g._RF.pop(),g._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var cT,hT,pT,dT,fT,yT,vT,gT,mT=m.ccclass,bT=m.property,ST=(Ludex.Utils,Vk=mT("UIManager"),jk=bT(pw),qk=bT(cb),Kk=bT(uT),Yk=bT(uT),Jk=bT(Bk),Zk=bT(XS),Xk=bT(zm),Vk((eT=e(($k=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"header",eT,r(e)),a(e,"footer",tT,r(e)),a(e,"sidebarLeft",nT,r(e)),a(e,"sidebarRight",iT,r(e)),a(e,"singleBlock",aT,r(e)),a(e,"comboText",rT,r(e)),a(e,"eventUIManager",oT,r(e)),e.devToolsScale=F.ONE,e.journeyBlock=null,e}return o(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"setDateStringText",value:function(e){this.singleBlock.setDateStringText(e)}},{key:"setLevelText",value:function(e){this.singleBlock.setLevelText(e)}},{key:"setScoreText",value:function(e){var t;this.singleBlock.setScoreText(e),null===(t=this.challengeBlock)||void 0===t||t.setPlayerScoreText(e)}},{key:"setMatchText",value:function(e){this.singleBlock.setMatchText(e)}},{key:"getCenterPosition",value:function(){var e=(this.header.node.worldPositionX+this.footer.node.worldPositionX)/2,t=(this.header.node.worldPositionY+this.footer.node.worldPositionY)/2;return new F(e,t,0)}},{key:"runShowComboAnimation",value:function(e){e<3||(console.log("runShowComboAnimation",e),this.comboText.runShowComboTextAnimation(e,0),e>=5&&e%5==0&&(this.sidebarLeft.runShowRearGlowAnimation(0),this.sidebarRight.runShowRearGlowAnimation(0)))}},{key:"runHideAnimation",value:(h=s(l().mark((function e(){var t,n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:.5,n=this.header.runHideAnimation(t),i=this.footer.runHideAnimation(t),e.next=5,Promise.all([n,i]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"runShowAnimation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this.header.runShowAnimation(e),this.footer.runShowAnimation(e)}},{key:"disableUI",value:function(){this.header.disableButtons(),this.footer.disableButtons()}},{key:"enableUI",value:function(){this.header.enableButtons(),this.footer.enableButtons()}},{key:"disableRewardAdsUI",value:function(){}},{key:"isChallengeUILoaded",value:function(){return Pe.isPrefabLoaded(Ze.CHALLENGE_BLOCK_PREFAB)&&Pe.isPrefabLoaded(Ze.CHALLENGE_PREPARE_PREFAB)}},{key:"isJourneyUILoaded",value:function(){return Pe.isPrefabLoaded(Ze.JOURNEY_BLOCK_PREFAB)}},{key:"loadChallengeUI",value:(c=s(l().mark((function e(){var t,n,i,a,r=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Promise.resolve(null),this.challengeBlock||(Pe.isPrefabLoaded(Ze.CHALLENGE_BLOCK_PREFAB)?(n=Pe.getPrefab(Ze.CHALLENGE_BLOCK_PREFAB),this.challengeBlock=K(n).getComponent(Hb),this.challengeBlock.node.setParent(this.header.node),this.challengeBlock.node.setPosition(0,-22,0)):(t=Pe.loadPrefabAsync(Ze.CHALLENGE_BLOCK_PREFAB,!0)).then((function(e){r.challengeBlock=K(e).getComponent(Hb),r.challengeBlock.node.setParent(r.header.node),r.challengeBlock.node.setPosition(0,-22,0)}))),i=Promise.resolve(null),this.challengePrepare||(Pe.isPrefabLoaded(Ze.CHALLENGE_PREPARE_PREFAB)?(a=Pe.getPrefab(Ze.CHALLENGE_PREPARE_PREFAB),this.challengePrepare=K(a).getComponent(SS),this.challengePrepare.node.setParent(this.eventUIManager.node)):(i=Pe.loadPrefabAsync(Ze.CHALLENGE_PREPARE_PREFAB,!0)).then((function(e){r.challengePrepare=K(e).getComponent(SS),r.challengePrepare.node.setParent(r.eventUIManager.node)}))),e.next=6,Promise.all([t,i]);case 6:this.challengeBlock.node.active=!1,this.challengePrepare.node.active=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"loadJourneyUI",value:(u=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.journeyBlock){e.next=12;break}if(!Pe.isPrefabLoaded(Ze.JOURNEY_BLOCK_PREFAB)){e.next=7;break}t=Pe.getPrefab(Ze.JOURNEY_BLOCK_PREFAB),this.journeyBlock=K(t).getComponent(uk),this.journeyBlock.node.setParent(this.header.node),e.next=12;break;case 7:return e.next=9,Pe.loadPrefabAsync(Ze.JOURNEY_BLOCK_PREFAB,!0);case 9:n=e.sent,this.journeyBlock=K(n).getComponent(uk),this.journeyBlock.node.setParent(this.header.node);case 12:this.journeyBlock.node.setPosition(0,-22,0),this.journeyBlock.node.setScale(new F(1,1,1)),this.journeyBlock.node.active=!1;case 15:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"enableChallengeUI",value:function(){this.singleBlock.node.active=!1,this.challengeBlock&&(this.challengeBlock.node.active=!0),this.challengePrepare&&(this.challengePrepare.node.active=!0),this.journeyBlock&&(this.journeyBlock.node.active=!1)}},{key:"enableSingleUI",value:function(){this.singleBlock.node.active=!0,this.challengeBlock&&(this.challengeBlock.node.active=!1),this.challengePrepare&&(this.challengePrepare.node.active=!1),this.journeyBlock&&(this.journeyBlock.node.active=!1)}},{key:"enableJourneyUI",value:function(){this.singleBlock.node.active=!1,this.journeyBlock&&(this.journeyBlock.node.active=!0),this.challengeBlock&&(this.challengeBlock.node.active=!1),this.challengePrepare&&(this.challengePrepare.node.active=!1)}},{key:"runEventEntranceAnimation",value:function(){rt.getSpecialMode()===ot.JOURNEY&&this.journeyBlock.runEntranceAnimation()}}]),d}(k)).prototype,"header",[jk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tT=e($k.prototype,"footer",[qk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nT=e($k.prototype,"sidebarLeft",[Kk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iT=e($k.prototype,"sidebarRight",[Yk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aT=e($k.prototype,"singleBlock",[Jk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rT=e($k.prototype,"comboText",[Zk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oT=e($k.prototype,"eventUIManager",[Xk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qk=$k))||Qk);g._RF.pop(),g._RF.push({},"da9f779Lq1FZ6d4GYedSdef","TutorialHand",void 0);var wT,kT,TT,CT,ET,LT,xT,IT,AT,RT,PT,_T,NT,OT,BT,DT,FT,MT,zT,UT,GT,HT,WT,VT=m.ccclass,jT=m.property,qT=Ludex.Utils.Signal,KT=(cT=VT("TutorialHand"),hT=jT(P),pT=jT(A),cT((yT=e((fT=function(e){t(m,e);var u,c,h,p,d,f,y,v,g=n(m);function m(){var e;i(this,m);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=g.call.apply(g,[this].concat(n)),a(e,"handOpacity",yT,r(e)),a(e,"hand",vT,r(e)),a(e,"handScaleDefault",gT,r(e)),e.handInitialPosition=new F(0,0,0),e.isShowing=!1,e.signalController=new qT.SignalController,e}return o(m,[{key:"__preload",value:function(){this.handOpacity.opacity=0,this.hand.scale=new F(0,0,1),this.isShowing=!1,this.handInitialPosition=this.hand.position.clone()}},{key:"tap",value:(v=s(l().mark((function e(t,n){var i,a,r,o=this,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>2&&void 0!==s[2]?s[2]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return a=this.signalController.renew(),r=B(this.hand).delay(i).to(.15,{scale:new F(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).to(.15,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).call((function(){t&&o.hide(),n&&n()})),e.next=7,Ve.runTweenAsync(r,a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"doubleTap",value:(y=s(l().mark((function e(t,n){var i,a,r,o=this,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>2&&void 0!==s[2]?s[2]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return a=this.signalController.renew(),r=B(this.hand).delay(i).to(.1,{scale:new F(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicIn"}).to(.1,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicIn"}).to(.1,{scale:new F(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicIn"}).to(.1,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicIn"}).call((function(){t&&o.hide(),n&&n()})),e.next=7,Ve.runTweenAsync(r,a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"move",value:(f=s(l().mark((function e(t,n,i){var a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>3&&void 0!==s[3]?s[3]:0,r=this.signalController.renew(),o=B(this.node).delay(a).to(n,{position:t},{easing:"sineInOut"}).call((function(){i&&i()})),e.next=5,Ve.runTweenAsync(o,r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"tapAndHold",value:(d=s(l().mark((function e(t){var n,i,a,r=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return i=this.signalController.renew(),a=B(this.hand).delay(n).to(.2,{scale:new F(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).call((function(){t&&t()})),e.next=7,Ve.runTweenAsync(a,i);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"unHold",value:(p=s(l().mark((function e(t,n,i){var a,r=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isShowing){e.next=2;break}return e.abrupt("return");case 2:return a=this.signalController.renew(),B(this.hand).delay(t).to(.2,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).call((function(){n&&r.hide(),i&&i()})),e.next=6,Ve.runTweenAsync(B(this.hand),a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"tapLoop",value:(h=s(l().mark((function e(t){var n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return i=this.signalController.renew(),a=this.handInitialPosition.clone(),r=B(this.hand).set({position:a,scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0}).delay(n).to(.15,{scale:new F(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).delay(.2).to(.15,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).to(.4,{position:new F(a.x+t.x,a.y+t.y,0)},{easing:"sineInOut"}).to(.4,{position:new F(a.x,a.y,0)},{easing:"sineInOut"}),o=B(this.hand).set({position:a,scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0}).delay(n).repeatForever(r),e.next=9,Ve.runTweenAsync(o,i);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"show",value:(c=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:.2,n=this.signalController.renew(),this.isShowing=!0,i=B(this.handOpacity).to(t,{opacity:255},{easing:"cubicInOut"}),a=B(this.hand).to(t,{scale:new F(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicInOut"}),r=Ve.runTweenAsync(i,n),o=Ve.runTweenAsync(a,n),e.next=9,Promise.all([r,o]);case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hide",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:.2,n=this.signalController.renew(),this.isShowing=!1,i=B(this.handOpacity).to(t,{opacity:0},{easing:"cubicInOut"}),a=B(this.hand).to(t,{scale:new F(0,0,1),angle:-10},{easing:"cubicInOut"}),r=Ve.runTweenAsync(i,n),o=Ve.runTweenAsync(a,n),e.next=9,Promise.all([r,o]);case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),m}(k)).prototype,"handOpacity",[hT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vT=e(fT.prototype,"hand",[pT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gT=e(fT.prototype,"handScaleDefault",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),dT=fT))||dT);g._RF.pop(),g._RF.push({},"85c57+tkHpBaaH2FQcFcbwN","TutorialInstruction",void 0);var YT,JT,ZT,XT,QT,$T,eC,tC=m.ccclass,nC=m.property,iC=Ludex.Utils.Signal,aC=(wT=tC("TutorialInstruction"),kT=nC(A),TT=nC(X),CT=nC(gh),ET=nC(L),LT=nC(L),xT=nC(j),IT=nC(j),wT((PT=e((RT=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"parentContainer",PT,r(e)),a(e,"instructionLabel",_T,r(e)),a(e,"instructionLocalize",NT,r(e)),a(e,"instructionUiTransform",OT,r(e)),a(e,"popupUiTransform",BT,r(e)),a(e,"originalMessageSize",DT,r(e)),a(e,"maxMessageWidth",FT,r(e)),a(e,"minStretchCheckMessageHeight",MT,r(e)),a(e,"minPopupWidth",zT,r(e)),a(e,"minPopupHeight",UT,r(e)),a(e,"maxPopupWidth",GT,r(e)),a(e,"stretchWidthIterations",HT,r(e)),a(e,"messagePopupPadding",WT,r(e)),e.signalController=new iC.SignalController,e}return o(p,[{key:"__preload",value:function(){this.node.active=!1,this.parentContainer.scale=new F(0,0,1)}},{key:"showInstruction",value:(c=s(l().mark((function e(t){var n,i,a,r,o,s,u,c,h=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>1&&void 0!==h[1]?h[1]:.2,i=h.length>2&&void 0!==h[2]?h[2]:0,a=h.length>3&&void 0!==h[3]?h[3]:0,r=this.signalController.renew(),this.node.active=!0,this.instructionLocalize.key=t,this.updateBackgroundSize(),this.parentContainer.setPosition(new F(0,i,0)),o=B(this.parentContainer).to(n,{scale:new F(1,1,1)},{easing:"backOut"}),s=B(this.parentContainer).to(n,{position:new F(0,i+a,0)},{easing:"cubicOut"}),u=Ve.runTweenAsync(o,r),c=Ve.runTweenAsync(s,r),e.next=14,Promise.all([u,c]);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateBackgroundSize",value:function(){for(this.instructionLabel.overflow=X.Overflow.RESIZE_HEIGHT,this.instructionUiTransform.setContentSize(this.originalMessageSize.x,this.originalMessageSize.y),this.instructionLabel.updateRenderData(!0);this.instructionUiTransform.contentSize.y>=this.minStretchCheckMessageHeight&&this.instructionUiTransform.contentSize.x<this.maxMessageWidth;)this.instructionUiTransform.setContentSize(this.instructionUiTransform.contentSize.x+this.stretchWidthIterations,this.instructionUiTransform.contentSize.y),this.instructionLabel.updateRenderData(!0);var e=Y.clamp(this.instructionUiTransform.contentSize.x+this.messagePopupPadding.x,this.minPopupWidth,this.maxPopupWidth),t=Math.max(this.minPopupHeight,this.instructionUiTransform.contentSize.y+this.messagePopupPadding.y);this.popupUiTransform.setContentSize(e,t)}},{key:"hideInstruction",value:(u=s(l().mark((function e(){var t,n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:.2,n=this.signalController.renew(),i=B(this.parentContainer).to(t,{scale:new F(0,0,1)},{easing:"backIn"}),e.next=5,Ve.runTweenAsync(i,n);case 5:this.node.active=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"parentContainer",[kT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_T=e(RT.prototype,"instructionLabel",[TT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NT=e(RT.prototype,"instructionLocalize",[CT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OT=e(RT.prototype,"instructionUiTransform",[ET],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BT=e(RT.prototype,"popupUiTransform",[LT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DT=e(RT.prototype,"originalMessageSize",[xT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(500,70)}}),FT=e(RT.prototype,"maxMessageWidth",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),MT=e(RT.prototype,"minStretchCheckMessageHeight",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),zT=e(RT.prototype,"minPopupWidth",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 700}}),UT=e(RT.prototype,"minPopupHeight",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),GT=e(RT.prototype,"maxPopupWidth",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),HT=e(RT.prototype,"stretchWidthIterations",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),WT=e(RT.prototype,"messagePopupPadding",[IT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(200,200)}}),AT=RT))||AT);g._RF.pop(),g._RF.push({},"b65f9FC6j5OO6hOcjXL2Dh9","TutorialMask",void 0);var rC=m.ccclass,oC=m.property,sC=Ludex.Utils.Signal,lC=(YT=rC("TutorialMask"),JT=oC(A),ZT=oC(P),YT(($T=e((QT=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"parentNode",$T,r(e)),a(e,"maskOpacity",eC,r(e)),e.maskedMap=new Map,e.placeholderPools=[],e.signalController=new sC.SignalController,e}return o(l,[{key:"__preload",value:function(){this.node.active=!1,this.listenToEvents()}},{key:"onDestroy",value:function(){this.node.scene.off($e.GAMEOBJECT_WIDGET_UPDATE,this.updateParentNode,this)}},{key:"listenToEvents",value:function(){this.node.scene.on($e.GAMEOBJECT_WIDGET_UPDATE,this.updateParentNode,this)}},{key:"maskGameObjects",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=d(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,r=this.getPlaceholderNode();this.replaceWithPlaceHolder(r,a)}}catch(e){i.e(e)}finally{i.f()}this.sortSiblingIndexBaseOnPlaceholderSiblingIndex(),this.node.active=!0,this.maskOpacity.node.active=!0;var o=this.signalController.renew(),s=B(this.maskOpacity).to(n,{opacity:255});Ve.runTweenAsync(s,o)}},{key:"unmaskGameObjects",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2,i=d(this.maskedMap.entries());try{for(i.s();!(e=i.n()).done;){var a=y(e.value,2),r=a[0],o=a[1];this.restoreOriginalGameobject(r,o)}}catch(e){i.e(e)}finally{i.f()}this.maskedMap.clear();var s=this.signalController.renew(),l=B(this.maskOpacity).to(n,{opacity:0}).call((function(){t.node.active=!1,t.maskOpacity.node.active=!1}));Ve.runTweenAsync(l,s)}},{key:"replaceWithPlaceHolder",value:function(e,t){var n=t.getSiblingIndex(),i=t.position;e.setParent(t.parent),e.setPosition(i),t.setParent(this.parentNode,!0),e.setSiblingIndex(n),this.maskedMap.set(t,e)}},{key:"restoreOriginalGameobject",value:function(e,t){var n=t.getSiblingIndex();e.parent===this.parentNode?(e.setParent(t.parent,!0),this.returnPlaceholderNode(t),e.setSiblingIndex(n)):this.returnPlaceholderNode(t),this.maskedMap.delete(e)}},{key:"getAllGameObjects",value:function(){var e,t=[],n=d(this.maskedMap.entries());try{for(n.s();!(e=n.n()).done;){var i=y(e.value,1)[0];t.push(i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"sortSiblingIndexBaseOnPlaceholderSiblingIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],i=d(this.maskedMap.entries());try{for(i.s();!(e=i.n()).done;){var a=y(e.value,2),r=a[0],o=a[1];t.includes(r)||n.push([r,o.getSiblingIndex()])}}catch(e){i.e(e)}finally{i.f()}n.sort((function(e,t){return e[1]-t[1]}));for(var s=0;s<n.length;s++){var l=y(n[s],1),u=l[0];u.setSiblingIndex(s)}for(var c=0;c<t.length;c++){var h=t[c];h.setSiblingIndex(n.length+c)}}},{key:"getPlaceholderNode",value:function(){if(this.placeholderPools.length>0){var e=this.placeholderPools.pop();return e.active=!0,e}var t=new A("MaskPlaceholder");return t.active=!0,t}},{key:"returnPlaceholderNode",value:function(e){e.setParent(this.parentNode),e.active=!1,this.placeholderPools.push(e)}},{key:"updateParentNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.parentNode.getComponent(z);n&&(n.top=e,n.bottom=t,n.updateAlignment())}}]),l}(k)).prototype,"parentNode",[JT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),eC=e(QT.prototype,"maskOpacity",[ZT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),XT=QT))||XT);g._RF.pop(),g._RF.push({},"f8981zheJdE4oVhPzgodH0U","FirstGameTutorial",void 0);var uC=function(){function e(t){i(this,e),this.guideSteps=[],this.hideUI=!0,this.maskUI=!0,this.untrackCombo=!0,this.untrackScore=!0,this.useJsonLevel=!0,this.isComplete=!1,this.currentStep=0,this.level1={layers:[{index:0,tiles:[{x:.5,y:0,skinIdx:0},{x:-.5,y:0,skinIdx:0}]}]},this.level2={layers:[{index:0,tiles:[{x:1,y:0,skinIdx:2},{x:0,y:0,skinIdx:3},{x:-1,y:0,skinIdx:3}]},{index:1,tiles:[{x:-.5,y:0,skinIdx:2}]}]},this.level3={layers:[{index:0,tiles:[{x:1.5,y:0,skinIdx:4},{x:-1.5,y:0,skinIdx:4},{x:.5,y:0,skinIdx:1},{x:-.5,y:0,skinIdx:1}]}]},this.guideManager=t,this.createGuide()}var t,n,a,r,u;return o(e,[{key:"createGuide",value:function(){var e=this,t=["20","10","28","11","32","2","1","19","29","33"];[{level:this.level1,layers:[[0,0],[0,1]]},{level:this.level2,layers:[[0,0],[0,1],[0,2],[1,0]]},{level:this.level3,layers:[[0,0],[0,1],[0,2],[0,3]]}].forEach((function(n){var i=n.level;n.layers.forEach((function(n){var a=y(n,2),r=a[0],o=a[1];e.setNewSkinIndex(i,r,o,t)}))})),this.guideSteps=[{execute:function(){return e.executeStep1()}},{execute:function(){return e.executeStep2()}},{execute:function(){return e.executeStep3()}}]}},{key:"setNewSkinIndex",value:function(e,t,n,i){e.layers[t].tiles[n].skinIdx=Number(i[e.layers[t].tiles[n].skinIdx%i.length])}},{key:"executeStep1",value:(u=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level1);case 2:return t=this.guideManager.getTileById(["0-0.5-0","0--0.5-0"]),this.guideManager.showTutorialInstruction("firstTutor1",.5,t[0].worldPos.y+500,50),(n=[]).push(this.handMovement(t)),n.push(this.guideManager.onceAllTileDestroy()),e.next=9,Promise.all(n);case 9:return this.guideManager.hideTutorialHand(.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handMovement",value:(r=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t[0],this.guideManager.showTutorHandToTile(n,0),e.next=4,this.guideManager.onceSelectedTile(n);case 4:i=t[1],0!==this.currentStep||n.state!==Xe.ALREADY&&n.state!==Xe.CHOOSING?this.guideManager.hideTutorialHand(.2):this.guideManager.showTutorHandToTile(i,.2);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"executeStep2",value:(a=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level2);case 2:return t=this.guideManager.getTileById(["0-0-0"]),this.guideManager.showTutorialInstruction("firstTutor2",.5,t[0].worldPos.y+500,50),e.next=6,this.guideManager.onceAllTileDestroy();case 6:return this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"executeStep3",value:(n=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level3);case 2:return t=this.guideManager.getTileById(["0-0.5-0"]),this.guideManager.showTutorialInstruction("firstTutor3",.5,t[0].worldPos.y+500,50),e.next=6,this.guideManager.onceAllTileDestroy();case 6:return this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:function(){this.guideManager.setCanWinGame(!1)}},{key:"run",value:(t=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("asasasas tutorial run",gt.TUTORIAL_START,nt.getLevel()),codex.analytics.event(gt.TUTORIAL_START,{level:nt.getLevel()});case 2:if(!(this.currentStep<this.guideSteps.length)){e.next=11;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(gt.TUTORIAL_STEP,{level:nt.getLevel(),step:this.currentStep+1}),!t.execute){e.next=8;break}return e.next=8,t.execute();case 8:this.currentStep++,e.next=2;break;case 11:codex.analytics.event(gt.TUTORIAL_COMPLETE,{level:nt.getLevel()}),this.complete();case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0,this.guideManager.setCanWinGame(!0),this.guideManager.loadCurrentLevel()}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.setCanWinGame(!0),this.guideManager.hideTutorialHand(0),this.guideManager.hideTutorialInstruction(0)}}]),e}();g._RF.pop(),g._RF.push({},"a4a64FskCROb7d7fGAGo7t6","FlowerTileTutorial",void 0);var cC=function(){function e(t){i(this,e),this.guideSteps=[],this.hideUI=!0,this.untrackCombo=!1,this.untrackScore=!1,this.isComplete=!1,this.currentStep=0,this.tiles=[],this.guideManager=t,this.createGuide()}var t,n;return o(e,[{key:"createGuide",value:function(){var e=this;this.guideSteps=[{execute:function(){return e.executeStep1()}}]}},{key:"executeStep1",value:(n=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.onceAllTileReady();case 2:return this.tiles=this.guideManager.getTileBySkinIdx(it.flowers),this.guideManager.hintNudgeTiles(this.tiles,.2),this.guideManager.showTutorialInstruction("flowerTutor",.5,this.tiles[0].worldPos.y-320,50),e.next=7,this.guideManager.onceAnyTileMatched();case 7:return this.guideManager.unhintNudgeTiles(this.tiles,.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:function(){}},{key:"run",value:(t=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:codex.analytics.event(gt.TUTORIAL_START,{level:nt.getLevel()});case 1:if(!(this.currentStep<this.guideSteps.length)){e.next=10;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(gt.TUTORIAL_STEP,{level:nt.getLevel(),step:this.currentStep+1}),!t.execute){e.next=7;break}return e.next=7,t.execute();case 7:this.currentStep++,e.next=1;break;case 10:codex.analytics.event(gt.TUTORIAL_COMPLETE,{level:nt.getLevel()}),this.complete();case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.hideTutorialInstruction(0),this.guideManager.unhintNudgeTiles(this.tiles,0)}}]),e}();g._RF.pop(),g._RF.push({},"25f8fbE66pAgIExKMYQye+3","SeasonTileTutorial",void 0);var hC,pC,dC,fC,yC,vC,gC,mC,bC,SC=function(){function e(t){i(this,e),this.guideSteps=[],this.hideUI=!0,this.untrackCombo=!1,this.untrackScore=!1,this.isComplete=!1,this.currentStep=0,this.tiles=[],this.guideManager=t,this.createGuide()}var t,n;return o(e,[{key:"createGuide",value:function(){var e=this;this.guideSteps=[{execute:function(){return e.executeStep1()}}]}},{key:"executeStep1",value:(n=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.onceAllTileReady();case 2:return this.tiles=this.guideManager.getTileBySkinIdx(it.seasons),this.guideManager.hintNudgeTiles(this.tiles,.2),this.guideManager.showTutorialInstruction("seasonTutor",.5,this.tiles[0].worldPos.y-320,50),e.next=7,this.guideManager.onceAnyTileMatched();case 7:return this.guideManager.unhintNudgeTiles(this.tiles,.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:function(){}},{key:"run",value:(t=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:codex.analytics.event(gt.TUTORIAL_START,{level:nt.getLevel()});case 1:if(!(this.currentStep<this.guideSteps.length)){e.next=10;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(gt.TUTORIAL_STEP,{level:nt.getLevel(),step:this.currentStep+1}),!t.execute){e.next=7;break}return e.next=7,t.execute();case 7:this.currentStep++,e.next=1;break;case 10:codex.analytics.event(gt.TUTORIAL_COMPLETE,{level:nt.getLevel()}),this.complete();case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.hideTutorialInstruction(0),this.guideManager.unhintNudgeTiles(this.tiles,0)}}]),e}();g._RF.pop(),g._RF.push({},"1bff5uv5b5IiIy6Q8Gp+9C8","GuideManager",void 0);var wC=m.ccclass,kC=m.property,TC=codex,CC=TC.language,EC=(TC.match,Ludex.Utils.Signal),LC=(hC=wC("GuideManager"),pC=kC(lC),dC=kC(KT),fC=kC(aC),hC((gC=e((vC=function(e){t(T,e);var u,c,h,p,y,v,g,m,b,S,w,k=n(T);function T(){var e;i(this,T);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=k.call.apply(k,[this].concat(n)),a(e,"tutorialMask",gC,r(e)),a(e,"tutorialHand",mC,r(e)),a(e,"tutorialInstruction",bC,r(e)),e.tutorial=null,e.signalController=new EC.SignalController,e.isTutorialRunning=!1,e}return o(T,[{key:"init",value:function(e){this.gameplay=e}},{key:"loadTutorial",value:function(e){this.tutorial=this.getTutorial(e),this.tutorial&&this.tutorial.init()}},{key:"startTutorial",value:(w=s(l().mark((function e(){var t,n,i=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tutorial){e.next=3;break}return this.isTutorialRunning=!1,e.abrupt("return");case 3:return this.signal=this.signalController.renew(),this.startTutorialConfig(),t=!1,n=new Promise((function(e,n){i.signal.once((function(){t=!0,i.isTutorialRunning=!1,n(new Error("Tutorial was terminated before running"))}))})),e.prev=7,e.next=10,Promise.race([this.tutorial.run(),n]);case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(7),t?console.warn("Tutorial was terminated by signal:",e.t0):console.error("Tutorial run failed:",e.t0),this.isTutorialRunning=!1,e.abrupt("return");case 17:this.endTutorialConfig(),this.tutorial=null;case 19:case"end":return e.stop()}}),e,this,[[7,12]])}))),function(){return w.apply(this,arguments)})},{key:"terminateTutorial",value:function(){this.tutorial&&(this.signalController.abort(),this.tutorial.terminate(),this.tutorial=null)}},{key:"getIsTutorialRunning",value:function(){return this.isTutorialRunning}},{key:"startTutorialConfig",value:function(){this.isTutorialRunning=!0,this.tutorial.hideUI&&this.gameplay.uiManager.runHideAnimation(0),this.tutorial.untrackCombo&&this.gameplay.scoreManager.setTrackCombo(!1),this.tutorial.untrackScore&&this.gameplay.scoreManager.setTrackScore(!1)}},{key:"endTutorialConfig",value:function(){this.isTutorialRunning=!1,this.tutorial.hideUI&&this.gameplay.uiManager.runShowAnimation(),this.tutorial.untrackCombo&&this.gameplay.scoreManager.setTrackCombo(!0),this.tutorial.untrackScore&&this.gameplay.scoreManager.setTrackScore(!0)}},{key:"loadGuideLevel",value:(S=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameplay.tileManager.clearTiles(),this.gameplay.gameObjects.spawnGuideObjects(t),e.next=4,this.gameplay.tileManager.handleTilesCreated();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"loadCurrentLevel",value:(b=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=nt.getLevelData()){e.next=3;break}return e.abrupt("return");case 3:return this.gameplay.tileManager.clearTiles(),this.gameplay.gameObjects.spawnObjects(t),e.next=7,this.gameplay.tileManager.handleTilesCreated();case 7:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"canEndGame",value:function(){return this.tutorial.isComplete}},{key:"getTileById",value:function(e){return this.gameplay.tileManager.getAllTiles().filter((function(t){return e.includes(t.id)}))}},{key:"getTileBySkinIdx",value:function(e){return this.gameplay.tileManager.getAllTiles().filter((function(t){return e.includes(t.skinIdx)}))}},{key:"showTutorHandToTile",value:(m=s(l().mark((function e(t){var n,i,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,i=new F(t.worldPos.x,t.worldPos.y-100,0),n<=0&&(this.tutorialHand.node.position=i),e.next=5,this.tutorialHand.show();case 5:if(!(n>0)){e.next=8;break}return e.next=8,this.tutorialHand.move(i,n);case 8:return e.next=10,this.tutorialHand.tapLoop(new F(30,-30,0));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"hideTutorialHand",value:(g=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tutorialHand.hide(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"showTutorialInstruction",value:(v=s(l().mark((function e(t,n,i,a){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(CC.hasTextKey(t)){e.next=3;break}return console.error('Text key "'.concat(t,'" not found in language data.')),e.abrupt("return");case 3:return e.next=5,this.tutorialInstruction.showInstruction(t,n,i,a);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return v.apply(this,arguments)})},{key:"hideTutorialInstruction",value:(y=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tutorialInstruction.hideInstruction(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"onceSelectedTile",value:(p=s(l().mark((function e(t){var n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){n.signal.once(i);var a=function t(){n.node.scene.off($e.TILE_CLICKED,r),n.node.scene.off($e.TILE_MOVING,r),n.node.scene.off($e.ALL_TILE_DESTROYED,t),e()},r=function i(r){t===r&&(n.node.scene.off($e.TILE_CLICKED,i),n.node.scene.off($e.TILE_MOVING,i),n.node.scene.off($e.ALL_TILE_DESTROYED,a),e())};n.node.scene.on($e.TILE_CLICKED,r),n.node.scene.on($e.TILE_MOVING,r),n.node.scene.once($e.ALL_TILE_DESTROYED,a)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"onceAnyTileMatched",value:(h=s(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.on($e.TWO_TILES_MATCHED,(function n(){t.node.scene.off($e.TWO_TILES_MATCHED,n),e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"onceAllTileReady",value:(c=s(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.on($e.ALL_TILE_READY,(function n(){t.node.scene.off($e.ALL_TILE_READY,n),e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"onceAllTileDestroy",value:(u=s(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.once($e.ALL_TILE_DESTROYED,e)})));case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"setCanWinGame",value:function(e){this.gameplay.setCanWinOrEndGame(e)}},{key:"sortTileOnMask",value:function(){var e=this.tutorialMask.getAllGameObjects().filter((function(e){var t=e.getComponent($f);return!!t&&(t.state===Xe.PRELOADING||t.state===Xe.MOVING_TO_MATCH)}));this.tutorialMask.sortSiblingIndexBaseOnPlaceholderSiblingIndex(e)}},{key:"hintNudgeTiles",value:function(e,t){var n=this;return new Promise((function(i,a){if(0!==e.length){n.signal.once(a);var r,o=e.map((function(e){return e.animationHandler})),s=[].concat(f(e.map((function(e){return e.node}))),f(o.map((function(e){return e.getShadow().node})))),l=d(o);try{for(l.s();!(r=l.n()).done;){var u=r.value;u.playTileShowHintAnim(),u.playTileNudgeAnim()}}catch(e){l.e(e)}finally{l.f()}n.tutorialMask.maskGameObjects(s,t),n.node.scene.on($e.TILE_START_SORT,n.sortTileOnMask,n),i()}else i()}))}},{key:"unhintNudgeTiles",value:function(e,t){var n=this;return new Promise((function(i,a){n.signal.once(a),n.tutorialMask.unmaskGameObjects(t);var r,o=e.map((function(e){return e.animationHandler})),s=d(o);try{for(s.s();!(r=s.n()).done;){var l=r.value;l.playTileStopHintAnim(),l.abortTileNudgeAnim()}}catch(e){s.e(e)}finally{s.f()}n.node.scene.off($e.TILE_START_SORT,n.sortTileOnMask,n),i()}))}},{key:"getTutorial",value:function(e){switch(e){case"FirstGameTutorial":return new uC(this);case"FlowerTileTutorial":return new cC(this);case"SeasonTileTutorial":return new SC(this);default:return console.warn("Tutorial ".concat(e," not found")),null}}}]),T}(k)).prototype,"tutorialMask",[pC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mC=e(vC.prototype,"tutorialHand",[dC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bC=e(vC.prototype,"tutorialInstruction",[fC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yC=vC))||yC);g._RF.pop(),g._RF.push({},"06155+d06BEMr6ULnqfwSmL","FindArtifactMissionStrategy",void 0);var xC=2,IC=3,AC=function(){function e(){i(this,e),this.journeyMission=null,this.gameplay=null,this.totalCount=0,this.isFinishedLoading=!1,this.claimTiles=[]}var t,n;return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSet=null}},{key:"setupTiles",value:function(){this.isFinishedLoading=!1;var e=this.journeyMission.seed,t=tt.separateSeedsToParts(e,3),n=(t[0],t[1]),i=t[2];this.gameplay.tileManager.updateTilesState();this.gameplay.tileManager.getCoveredTiles();var a,r=2*(xC+i%(IC-xC+1)),o=tt.getJourneyTileSkinIdx(this.journeyMission),s=this.gameplay.tileManager.getReplaceableTilesCombinations((function(e){return!e.isUncovered})),l=tt.seededShuffle(s,n),u=[],c=new Set,h=0,p=d(l);try{for(p.s();!(a=p.n()).done;){var f=a.value;if(!(f.length+h>r)){var y,v=!1,g=d(f);try{for(g.s();!(y=g.n()).done;){var m=y.value;if(c.has(m.id)){v=!0;break}}}catch(e){g.e(e)}finally{g.f()}if(!v){var b,S=d(f);try{for(S.s();!(b=S.n()).done;){var w=b.value;w.setArtifactTile(o),c.add(w.id)}}catch(e){S.e(e)}finally{S.f()}if((h+=f.length)>=r)break}}}}catch(e){p.e(e)}finally{p.f()}return console.log("FindArtifactMissionStrategy: selectedTileCount",h,l),this.missionTileSet={isEmptyBackground:!0,skinIdx:o,count:h},this.totalCount=h,this.isFinishedLoading=!0,u.push(this.missionTileSet),u}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on($e.TILES_STATE_UPDATED,this.handleTileStateUpdated,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off($e.TILES_STATE_UPDATED,this.handleTileStateUpdated,this)}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount&&this.isFinishedLoading}},{key:"handleTileStateUpdated",value:function(){if(this.isFinishedLoading){var e,t,n=this.gameplay.tileManager.getUncoveredTiles(),i=[],a=d(n);try{for(a.s();!(e=a.n()).done;){var r=e.value;r.isArtifact&&(this.handleUncoveredTile(r),i.push(r),this.totalCount-=1,this.missionTileSet.count-=1)}}catch(e){a.e(e)}finally{a.f()}if(i.length>0)(t=this.claimTiles).push.apply(t,i),this.gameplay.tileManager.updateTilesState();this.gameplay.node.scene.emit($e.JOURNEY_MISSION_COMPLETE_CHECK);for(var o=0;o<this.claimTiles.length;o++){var s=this.claimTiles[o],l=this.missionTileSet.count+this.claimTiles.length-o-1;this.runAnimationCollect(s,l)}this.claimTiles=[]}}},{key:"handleUncoveredTile",value:(n=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.gameplay.tileManager.handleTileCollect(t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"runAnimationCollect",value:(t=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.node.worldPosition,t.handlePreloadTile(),e.next=4,t.animationHandler.playTileCollectAnim();case 4:this.gameplay.tileManager.destroyMatchedTiles(t),this.gameplay.node.scene.emit($e.MISSION_TILE_SET_COLLECT,this.missionTileSet,n,i);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();g._RF.pop(),g._RF.push({},"695c5Fb29xKw4pniq1i1HzX","HiddenTileMissionStrategy",void 0);var RC=3,PC=4,_C=3,NC=7,OC=3,BC=10,DC=function(){function e(){i(this,e),this.journeyMission=null,this.gameplay=null,this.totalCount=0}return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSet=null}},{key:"setupTiles",value:function(){var e,t=this.journeyMission.seed,n=tt.separateSeedsToParts(t,2),i=n[0],a=n[1],r=this.gameplay.tileManager.getAllTiles(),o=0,s=0;this.journeyMission.journeyLevel<=Lt.REWARD_1_LEVEL?(o=2*(RC+a%(PC-RC+1)),s=Math.ceil(.5*o)):this.journeyMission.journeyLevel<=Lt.REWARD_2_LEVEL?(o=2*(_C+a%(NC-_C+1)),s=Math.ceil(.5*o)):(o=2*(OC+a%(BC-OC+1)),s=Math.ceil(.5*o));var l,u=[],c=r.reverse(),h=(null===(e=c[0])||void 0===e?void 0:e.getLayer())||0,p=d(c);try{for(p.s();!(l=p.n()).done;){var f=l.value;if(f.getLayer()!==h){if(s<=u.length)break;h=f.getLayer()}u.push(f)}}catch(e){p.e(e)}finally{p.f()}var y,v=new Set,g=[],m=0,b=tt.seededShuffle(u,i),S=d(b);try{for(S.s();!(y=S.n()).done;){var w=y.value;if(m>=s)break;if(!v.has(w.id)){var k=this.gameplay.tileManager.getSymmetricTile(w);k&&!v.has(k.id)&&w!==k&&(w.setHiddenTile(),k.setHiddenTile(),v.add(w.id),v.add(k.id),m+=2)}}}catch(e){S.e(e)}finally{S.f()}var T,C=tt.seededShuffle(c,i),E=d(C);try{for(E.s();!(T=E.n()).done;){var L=T.value;if(m>=o)break;if(!v.has(L.id)){var x=this.gameplay.tileManager.getSymmetricTile(L);x&&!v.has(x.id)&&L!==x?(L.setHiddenTile(),x.setHiddenTile(),v.add(L.id),v.add(x.id),m+=2):(L.setHiddenTile(),v.add(L.id),m+=1)}}}catch(e){E.e(e)}finally{E.f()}return this.missionTileSet={isHidden:!0,count:m},this.totalCount=m,g.push(this.missionTileSet),g}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on($e.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.on($e.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off($e.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.off($e.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"handleMatchedTiles",value:function(e){var t=e.tile1,n=e.tile2,i=e.worldCenterPosition,a=0;t.isHidden&&a++,n.isHidden&&a++,0!==a&&(this.totalCount-=a,this.missionTileSet.count-=a,this.gameplay.node.scene.emit($e.MISSION_TILE_SET_COLLECT,this.missionTileSet,this.missionTileSet.count,i),this.gameplay.node.scene.emit($e.JOURNEY_MISSION_COMPLETE_CHECK))}},{key:"handleUndoneTiles",value:function(e){var t=e.tile1,n=e.tile2,i=0;t.isHidden&&i++,n.isHidden&&i++,0!==i&&(this.totalCount+=i,this.missionTileSet.count+=i,this.gameplay.node.scene.emit($e.MISSION_TILE_SET_UPDATE,this.missionTileSet,this.missionTileSet.count))}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount}}]),e}();g._RF.pop(),g._RF.push({},"0ef18JANHdNqJlTgd0euXWt","TargetTileMissionStrategy",void 0);var FC=function(){function e(){i(this,e),this.journeyMission=null,this.gameplay=null,this.missionTileSets=[],this.totalCount=0}return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSets=[]}},{key:"setupTiles",value:function(){var e=this.journeyMission.seed,t=tt.separateSeedsToParts(e,3),n=t[0],i=t[1],a=t[2],r=this.gameplay.tileManager.getAllTiles(),o=[it.bamboo,it.characters,it.dots].filter((function(e){var t,n=d(r);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(e.includes(i.skinIdx))return!0}}catch(e){n.e(e)}finally{n.f()}return!1})),s=o[i%o.length],l=f(s).filter((function(e){return r.some((function(t){return t.skinIdx===e}))})),u=Math.min(4,l.length),c=u+n%(Math.min(6,l.length)-u+1),h=tt.seededShuffle(l,n).slice(0,c),p=6+2*Math.floor(r.length/20),y=p+a%(14+2*Math.floor(r.length/20)-p+1);y%2!=0&&(y+=1);for(var v=2*Math.floor(y/c/2),g=y-v*c,m=[],b=[],S=function(e){var t=v,n=r.filter((function(t){return t.skinIdx===h[e]})).length;t=Math.min(t,n),g>=2&&t<=n-2&&(t+=2,g-=2),m.push({skinIdx:h[e],count:t,effect:"pink"}),b.push(t)},w=0;w<c;w++)S(w);var k,T=d(r);try{for(T.s();!(k=T.n()).done;){var C=k.value,E=h.indexOf(C.skinIdx);-1!==E&&b[E]>0&&(C.setTargetTile(),b[E]-=1)}}catch(e){T.e(e)}finally{T.f()}return m.sort((function(e,t){return e.skinIdx-t.skinIdx})),this.missionTileSets=m,this.totalCount=m.reduce((function(e,t){return e+t.count}),0),this.missionTileSets}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on($e.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.on($e.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off($e.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.off($e.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"handleMatchedTiles",value:function(e){var t=e.tile1,n=e.tile2,i=e.worldCenterPosition,a=this.missionTileSets.find((function(e){return e.skinIdx===t.skinIdx||e.skinIdx===n.skinIdx})),r=0;a&&(t.isTarget&&(r+=1),n.isTarget&&(r+=1),this.totalCount-=r,a.count-=r,this.gameplay.node.scene.emit($e.MISSION_TILE_SET_COLLECT,a,a.count,i),this.gameplay.node.scene.emit($e.JOURNEY_MISSION_COMPLETE_CHECK))}},{key:"handleUndoneTiles",value:function(e){var t=e.tile1,n=e.tile2,i=this.missionTileSets.find((function(e){return e.skinIdx===t.skinIdx||e.skinIdx===n.skinIdx}));i&&(i.count+=2,this.totalCount+=2,this.gameplay.node.scene.emit($e.MISSION_TILE_SET_UPDATE,i,i.count))}}]),e}();g._RF.pop(),g._RF.push({},"95a90qUfUBGv7qaenHMdap2","JourneyLevelMechanicsManager",void 0);var MC,zC,UC,GC,HC,WC,VC,jC,qC,KC,YC,JC,ZC=function(){function e(){i(this,e),this.strategies=[],this.gameplay=null,this.journeyBlock=null,this.isMissionCompleted=!1,this.hasMissionStarted=!1,this.createStrategies()}return o(e,[{key:"createStrategies",value:function(){this.findArtifactMissionStrategy=new AC,this.hiddenTileMissionStrategy=new DC,this.targetTileMissionStrategy=new FC,this.strategies=[this.findArtifactMissionStrategy,this.hiddenTileMissionStrategy,this.targetTileMissionStrategy]}},{key:"init",value:function(e){this.gameplay=e;var t,n=d(this.strategies);try{for(n.s();!(t=n.n()).done;){t.value.init(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setJourneyBlock",value:function(e){this.journeyBlock=e}},{key:"getCurrentStrategy",value:function(){var e=tt.getCurrentMission();if(!e)return null;switch(e.type){case yt.FIND_ARTIFACT:return this.findArtifactMissionStrategy;case yt.HIDDEN_TILE:return this.hiddenTileMissionStrategy;case yt.TARGET_TILE:return this.targetTileMissionStrategy;default:return null}}},{key:"getLastStrategy",value:function(){var e=tt.getLastMission();if(!e)return null;switch(e.type){case yt.FIND_ARTIFACT:return this.findArtifactMissionStrategy;case yt.HIDDEN_TILE:return this.hiddenTileMissionStrategy;case yt.TARGET_TILE:return this.targetTileMissionStrategy;default:return null}}},{key:"getMissionType",value:function(){var e=tt.getCurrentMission();return e?e.type:null}},{key:"setup",value:function(){var e,t=this.getCurrentStrategy();if(t){this.hasMissionStarted=!0,this.isMissionCompleted=!1;var n=tt.getCurrentMission();t.setupMission(n);var i=t.setupTiles();null===(e=this.journeyBlock)||void 0===e||e.updateJourneyData(i),t.setupListeners()}}},{key:"terminateJourneyMission",value:function(){if(this.hasMissionStarted){var e=this.getLastStrategy();e&&(e.terminateListeners(),this.hasMissionStarted=!1,this.isMissionCompleted=!1)}}},{key:"isDescriptionCompleted",value:function(){if(!tt.getCurrentMission())return!1;var e=this.getCurrentStrategy();return!e||e.isDescriptionCompleted()}},{key:"setJourneyMissionCompleted",value:function(){tt.getCurrentMission()&&(this.isMissionCompleted=!0)}},{key:"getJourneyMissionCompleted",value:function(){return this.isMissionCompleted}}]),e}();g._RF.pop(),g._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var XC,QC=m.ccclass,$C=m.requireComponent,eE=m.property,tE=Ludex.Utils.Decorator,nE=(MC=QC("Gameplay"),zC=$C([pm]),UC=eE(Ug),GC=eE(sg),HC=eE(hy),WC=tE.debounce(3e3),VC=Re.onlyRunInLifeCycleAsync,MC(jC=zC((KC=e((qC=function(e){t(f,e);var u,c,h,p=n(f);function f(){var e;i(this,f);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"scoreManager",KC,r(e)),a(e,"effectManager",YC,r(e)),a(e,"gameObjects",JC,r(e)),e.canShowShortcut=!1,e.setupGameBoard=s(l().mark((function t(){var n,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasGoldenTiles=!1,n=nt.getLevel(),e.guideManager.terminateTutorial(),1!==n){t.next=6;break}return e.guideManager.loadTutorial("FirstGameTutorial"),t.abrupt("return");case 6:if(4===n&&e.guideManager.loadTutorial("FlowerTileTutorial"),6===n&&e.guideManager.loadTutorial("SeasonTileTutorial"),i=nt.getLevelData()){t.next=11;break}return t.abrupt("return");case 11:return e.tileManager.clearTiles(),e.gameObjects.spawnObjects(i),e.handleSetupSpecialTiles(),t.next=16,e.tileManager.handleTilesCreated();case 16:case"end":return t.stop()}}),t)}))),e.handleStartGame=s(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.uiManager.runShowAnimation(),e.uiManager.runEventEntranceAnimation(),e.guideManager.startTutorial(),e.node.scene.emit($e.GAME_START),e.lastLoggedProgress=0;case 5:case"end":return t.stop()}}),t)}))),e.handlePauseGame=function(t){e.pauseGame(),e.highlightTiles=codex.player.getPlayerSettings().highLight,e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(t){e.resumeGame();var n=codex.player.getPlayerSettings().highLight;e.tileManager.updateTilesCoveredState(e.highlightTiles!==n),e.processCrazyGamesGameplayStart()},e.handleReplayGame=function(){console.log("handleReplayGame"),e.stateManager.initialize()},e.handleGameRescue=s(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stateManager.ready(),e.uiManager.enableUI(),e.uiManager.runShowAnimation(),t.next=5,e.tileManager.handleShuffle();case 5:case"end":return t.stop()}}),t)}))),e.handleNextLevel=function(){e.stateManager.load(),e.canShowShortcut=!0,console.log("Next level",nt.getLevel())},e.handleStartOver=function(){nt.setLevel(1),nt.setMaxLevel(1),e.stateManager.load()},e.handleSelectLevel=function(t){if(!t)throw new Error("handleSelectLevel: GameEvent payload is not defined");var n=t.level;if(n){var i=n<1?1:n;nt.setLevel(i),nt.setMaxLevel(i),e.stateManager.load()}},e.handleAutoFinishLevel=s(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.guideManager.terminateTutorial(),e.stateManager.autoFinish(),console.log("Auto Win Game");case 3:case"end":return t.stop()}}),t)}))),e.handleTwoTilesMatched=function(){e.logLevelProgress10()},e.handleJourneyLevelCompleted=function(){e.journeyLevelMechanicsManager.isDescriptionCompleted()&&!e.journeyLevelMechanicsManager.getJourneyMissionCompleted()&&(e.journeyLevelMechanicsManager.setJourneyMissionCompleted(),e.handleAutoFinishLevel())},e.lastLoggedProgress=0,e.handleTilesStateUpdated=function(){var t=e.tileManager.getNumberOfMatchPairs();e.uiManager.setMatchText(t)},e.handleShowHint=function(){e.tileManager.handleShowHint()},e.handleUndo=function(){e.tileManager.handleUndo()},e.handleShuffle=function(){e.tileManager.handleShuffle()},e.handleAutoPlay=function(){e.tileManager.handleAutoPlay()},e}return o(f,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenInputEvents()}},{key:"initComponents",value:function(){this.initUIManager(),this.initStateManager(),this.initTileManager(),this.initJourneyLevelMechanicsManager(),this.initGameModeManager(),this.initItemManager(),this.initGuideManager()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(ST)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(pm)}},{key:"initTileManager",value:function(){this.tileManager=this.getComponent(Ng)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(Mg)}},{key:"initJourneyLevelMechanicsManager",value:function(){this.journeyLevelMechanicsManager=new ZC,this.journeyLevelMechanicsManager.init(this)}},{key:"initGameModeManager",value:function(){this.gameModeManager=new cg,this.gameModeManager.init(this)}},{key:"initGuideManager",value:function(){var e;this.guideManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(LC),this.guideManager.init(this)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.scene.on($e.GAME_PAUSE,this.handlePauseGame),this.node.scene.on($e.GAME_RESUME,this.handleResumeGame),this.node.scene.on($e.GAME_REPLAY,this.handleReplayGame),this.node.scene.on($e.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on($e.START_OVER,this.handleStartOver),this.node.scene.on($e.SELECT_LEVEL,this.handleSelectLevel),this.node.scene.on($e.AUTO_FINISH_LEVEL,this.handleAutoFinishLevel),this.node.scene.on($e.TWO_TILES_MATCHED,this.handleTwoTilesMatched),this.node.scene.on($e.TILES_STATE_UPDATED,this.handleTilesStateUpdated),this.node.scene.on($e.GAME_RESCUE,this.handleGameRescue),this.node.scene.on($e.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.on($e.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.on($e.ALL_TILE_COVERED,this.handleGameOver,this),this.node.scene.on($e.SHOW_HINT,this.handleShowHint),this.node.scene.on($e.START_UNDO,this.handleUndo),this.node.scene.on($e.START_SHUFFLE,this.handleShuffle),this.node.scene.on($e.JOURNEY_MISSION_COMPLETE_CHECK,this.handleJourneyLevelCompleted)}},{key:"setCanWinOrEndGame",value:function(e){e?(this.node.scene.on($e.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.on($e.ALL_TILE_COVERED,this.handleGameOver,this)):(this.node.scene.off($e.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.off($e.ALL_TILE_COVERED,this.handleGameOver,this))}},{key:"start",value:function(){if(Tt.getSceneData(this.node.scene).isFromLoader){var e=codex.match.getMatchState();if(e.mode===Ty.CHALLENGE_FRIEND){var t=e.customData.level;t&&(nt.setLevel(t),console.log("Continue game from loader",t));try{var n,i=null===(n=codex.context)||void 0===n?void 0:n.getContextData(),a=i.type,r=i.level;a&&r&&"share_invite"===a&&(nt.setLevel(r),console.log("Continue game from loader share invite",r))}catch(e){console.error("Error in handleContinueGame",e)}}}this.initData(),this.initGame()}},{key:"isGamePlaying",value:function(){return this.stateManager.isGamePlaying()}},{key:"initData",value:function(){}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.load()}},{key:"handlePreloadUpcomingScreens",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:rt.getSpecialMode()===ot.JOURNEY&&(pt.preloadScreen(Ge.JOURNEY_WINNING_SCREEN),tt.isLevelWithBadges()&&pt.preloadScreen(Ge.BADGE_REWARD_SCREEN)),this.hasGoldenTiles&&pt.preloadScreen(Ge.TOURNAMENT_COMPLETE_SCREEN);case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleSetupSpecialTiles",value:function(){switch(this.getTileMode()){case"journey":this.handleSetupJourneyTiles();break;case"golden":this.handleSetupGoldenTiles()}}},{key:"getTileMode",value:function(){return rt.getSpecialMode()===ot.JOURNEY?"journey":ft.isTournamentHappening()?"golden":"normal"}},{key:"handleSetupGoldenTiles",value:function(){if(ft.isTournamentHappening()){var e=this.tileManager.getGoldenTileSprite();if(e){var t,n=this.tileManager.getGoldenTilesCandidates(),i=d(n);try{for(i.s();!(t=i.n()).done;){t.value.setGolden(e)}}catch(e){i.e(e)}finally{i.f()}this.hasGoldenTiles=n.length>0}}}},{key:"handleSetupJourneyTiles",value:function(){rt.getSpecialMode()===ot.JOURNEY?(this.journeyLevelMechanicsManager.terminateJourneyMission(),this.journeyLevelMechanicsManager.setup()):this.journeyLevelMechanicsManager.terminateJourneyMission()}},{key:"handleGameWin",value:function(){console.log("Win Game"),this.guideManager.terminateTutorial(),this.tileManager.clearTiles(),this.stateManager.nextLevel()}},{key:"handleGameOver",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Game Over"),this.guideManager.terminateTutorial(),this.stateManager.gameOver();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleAllTileReady",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"logLevelProgress10",value:function(){if(!(this.guideManager.getIsTutorialRunning()||nt.getLevel()>10)){var e=this.tileManager.getMatchedPairCount(),t=this.tileManager.getMatchedPairFailedCount(),n=this.scoreManager.getCurrentPlayTime(),i=this.tileManager.getTotalPairCount();if(0!==i&&0!==e){var a=Math.floor(100*e/i),r=10*Math.floor(a/10);r>this.lastLoggedProgress&&(this.lastLoggedProgress=r,codex.analytics.event(gt.LEVEL_PROGRESS,{level:nt.getLevel(),progress:r,match_count:e,match_failed_count:t,time_played:n,game_mode:this.gameModeManager.getGameMode()}))}}}},{key:"logCantShuffle",value:function(){var e;codex.analytics.event(gt.CANT_SHUFFLE,{level:nt.getLevel(),level_try_count:nt.getTryCount(),leftover_pairs:this.tileManager.getLeftoverPairCount(),is_highlight:null!==(e=codex.player.getPlayerSetting("highLight"))&&void 0!==e&&e,has_golden_tiles:this.hasGoldenTiles})}},{key:"pauseGame",value:function(){this.node.active=!1,this.node.pauseSystemEvents(!0)}},{key:"resumeGame",value:function(){this.node.active=!0,this.node.resumeSystemEvents(!0)}},{key:"attemptCallCreateShortcut",value:function(){this.canShowShortcut&&(this.canShowShortcut=!1,nt.getPlayerLevel()<2||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)})))}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"processCrazyGamesHappyTime",value:function(){"happyTime"in GameSDK.extra&&GameSDK.extra.happyTime()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){"CrazyGames"===GameSDK.getSDKName()&&this.uiManager.disableRewardAdsUI()}},{key:"updateTilesTheme",value:function(){this.tileManager.updateTilesTheme()}}]),f}(k)).prototype,"scoreManager",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YC=e(qC.prototype,"effectManager",[GC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JC=e(qC.prototype,"gameObjects",[HC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(qC.prototype,"handlePreloadUpcomingScreens",[WC,VC],Object.getOwnPropertyDescriptor(qC.prototype,"handlePreloadUpcomingScreens"),qC.prototype),jC=qC))||jC)||jC);g._RF.pop(),g._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var iE,aE,rE,oE,sE,lE=m.ccclass,uE=m.disallowMultiple,cE=m.executeInEditMode,hE=m.requireComponent,pE=lE("ParticleSystem2DExtra")(XC=cE(!0)(XC=uE(!0)(XC=hE(ee)(XC=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var r=i[a];e.updateParticle(r,n)}t(n)}},e}return o(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(ee),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}}]),r}(k))||XC)||XC)||XC)||XC;g._RF.pop(),g._RF.push({},"400fdviQqBM1KcojfwM0uT/","TileSelectParticleSystem2DExtra",void 0);var dE,fE,yE,vE,gE,mE,bE,SE,wE,kE,TE,CE=m.ccclass,EE=m.property;iE=CE("TileSelectParticleSystem2DExtra"),aE=EE(L),iE((sE=e((oE=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"selectedUITransform",sE,r(e)),e}return o(l,[{key:"initParticle",value:function(e){var t=Y.absMax(this.selectedUITransform.width,this.selectedUITransform.height)/100;e.timeToLive=3*t+Y.randomRange(-1,1)*t,e.maxSize=Y.randomRange(.25,1)*e.size*t,e.size=0,e.deltaSize=0,e.cycleDuration=Y.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=this.selectedUITransform.width,n=this.selectedUITransform.height,i=e.x,a=e.y;return e.x=i+Y.randomRange(-t/2,t/2),e.y=a+Y.randomRange(0,n/2)-n/2,e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),l}(pE)).prototype,"selectedUITransform",[aE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rE=oE));g._RF.pop(),g._RF.push({},"87767KZVqpEgIbdzZdGh1CJ","BatchObjectManager",void 0),g._RF.pop(),g._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var LE,xE,IE,AE,RE,PE,_E,NE,OE,BE,DE,FE,ME,zE,UE,GE,HE,WE=m.ccclass,VE=m.property,jE=(dE=WE("Burst"),fE=VE(V),yE=VE(w),vE=VE(V),gE=VE(w),dE((SE=e((bE=function(){function e(){i(this,e),a(this,"time",SE,this),a(this,"repeatCount",wE,this),a(this,"repeatInterval",kE,this),a(this,"count",TE,this),this.remainingCount=0,this.curTime=0}return o(e,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=le(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=le(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),e}()).prototype,"time",[fE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),wE=e(bE.prototype,"repeatCount",[yE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),kE=e(bE.prototype,"repeatInterval",[vE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),TE=e(bE.prototype,"count",[gE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),mE=bE))||mE);g._RF.pop(),g._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var qE,KE,YE,JE,ZE,XE,QE,$E,eL,tL,nL,iL,aL,rL,oL,sL,lL,uL=m.ccclass,cL=m.property,hL=W({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),pL=(LE=uL("CurveRange"),xE=cL({type:W(hL)}),IE=cL({visible:function(){return this.mode===hL.Constant}}),AE=cL({visible:function(){return this.mode===hL.Curve}}),RE=cL({visible:function(){return this.mode===hL.TwoCurves}}),PE=cL({visible:function(){return this.mode===hL.TwoCurves}}),_E=cL({visible:function(){return this.mode===hL.TwoConstants}}),NE=cL({visible:function(){return this.mode===hL.TwoConstants}}),LE((DE=e((BE=function(){function e(){i(this,e),a(this,"mode",DE,this),a(this,"constant",FE,this),a(this,"spline",ME,this),a(this,"splineMin",zE,this),a(this,"splineMax",UE,this),a(this,"constantMin",GE,this),a(this,"constantMax",HE,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return o(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case hL.Curve:return this.spline.evaluate(e);case hL.TwoCurves:return ue(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case hL.TwoConstants:return ue(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case hL.Curve:return 1;case hL.TwoConstants:return this.constantMax;case hL.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case hL.Curve:return ce(1,0,he);case hL.TwoConstants:return ce(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,he);case hL.TwoCurves:return ce(1,0,he);default:return ce(this.constant,0,he)}}}]),e}()).prototype,"mode",[xE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hL.Constant}}),FE=e(BE.prototype,"constant",[IE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ME=e(BE.prototype,"spline",[AE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pe}}),zE=e(BE.prototype,"splineMin",[RE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pe}}),UE=e(BE.prototype,"splineMax",[PE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pe}}),GE=e(BE.prototype,"constantMin",[_E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),HE=e(BE.prototype,"constantMax",[NE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),OE=BE))||OE);g._RF.pop(),g._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var dL=m.ccclass,fL=m.property,yL=W({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),vL=new D,gL=new D,mL=(qE=dL("GradientRange"),KE=fL({type:W(yL)}),YE=fL({visible:function(){return this.mode===yL.Color}}),JE=fL({visible:function(){return this.mode===yL.TwoColors}}),ZE=fL({visible:function(){return this.mode===yL.TwoColors}}),XE=fL({visible:function(){return this.mode===yL.Gradient||this.mode===yL.RandomColor}}),QE=fL({visible:function(){return this.mode===yL.TwoGradients}}),$E=fL({visible:function(){return this.mode===yL.TwoGradients}}),qE((nL=e((tL=function(){function e(){i(this,e),a(this,"mode",nL,this),a(this,"color",iL,this),a(this,"colorMin",aL,this),a(this,"colorMax",rL,this),a(this,"gradient",oL,this),a(this,"gradientMin",sL,this),a(this,"gradientMax",lL,this),this._color=D.WHITE.clone()}return o(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case yL.Color:return this.color;case yL.TwoColors:return D.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case yL.RandomColor:return this.gradient.getRandomColor(this._color);case yL.Gradient:return this.gradient.evaluateFast(this._color,e);case yL.TwoGradients:return D.lerp(this._color,this.gradientMin.evaluateFast(vL,e),this.gradientMax.evaluateFast(gL,e),t),this._color;default:return this.color}}}]),e}()).prototype,"mode",[KE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return yL.Color}}),iL=e(tL.prototype,"color",[YE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.WHITE.clone()}}),aL=e(tL.prototype,"colorMin",[JE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.WHITE.clone()}}),rL=e(tL.prototype,"colorMax",[ZE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.WHITE.clone()}}),oL=e(tL.prototype,"gradient",[XE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new de}}),sL=e(tL.prototype,"gradientMin",[QE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new de}}),lL=e(tL.prototype,"gradientMax",[$E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new de}}),eL=tL))||eL);function bL(e,t,n,i){!function(e,t){j.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,F.multiplyScalar(e,e,t+(n-t)*ye())}function SL(e){var t=hL;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}g._RF.pop(),g._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),g._RF.pop(),g._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var wL=new F(0,0,0),kL=function(){function e(){i(this,e),this.pos=new F(0,0,0),this.color=new D(255,255,255,255),this.size=new F(0,0,0),this.startSize=new F(0,0,0),this.rotation=new F(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new F(0,0),this.width=0,this.height=0}return o(e,[{key:"init",value:function(){this.pos.set(wL),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(wL),this.startColor=D.WHITE.clone(),this.velocity.set(wL),this.randomSeed=0}}]),e}(),TL=new(function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"get",value:function(){return this._get()||new kL}}]),r}(me.Pool))((function(e){e.pos.set(wL),e.color._val=4294967295,e.size.set(wL),e.rotation.set(wL)}),1024),CL=function(){function e(t){i(this,e),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new Se,this.sys=t,this.particles=[],this.active=!1,this.uvFilled=0}return o(e,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=d(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;TL.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=TL.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var a=i.uv,r=e?0:this.uvFilled,o=this.particles.length,s=r;s<o;s++){var l=9*s*4;n[l+3]=a[0],n[l+4]=a[1],n[l+12]=a[2],n[l+13]=a[3],n[l+21]=a[4],n[l+22]=a[5],n[l+30]=a[6],n[l+31]=a[7]}this.uvFilled=o}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var a=n.vData,r=t.x,o=t.y,s=t.z,l=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,h=e.rotation.y||0,p=e.rotation.z||0;if(0===c&&0===h&&0===p)a[i]=r-l,a[i+1]=o-u,a[i+2]=s,a[i+9]=r+l,a[i+10]=o-u,a[i+11]=s,a[i+18]=r-l,a[i+19]=o+u,a[i+20]=s,a[i+27]=r+l,a[i+28]=o+u,a[i+29]=s;else{var d=-be.degreesToRadians(c),f=-be.degreesToRadians(h),y=-be.degreesToRadians(p),v=Math.cos(d),g=Math.sin(d),m=Math.cos(f),b=Math.sin(f),S=Math.cos(y),w=Math.sin(y);function k(e,t,n){var i=t*v-n*g,a=t*g+n*v,r=e*m+a*b;return new F(r*S-i*w,r*w+i*S,a*m-e*b)}var T=[k(-l,-u,0),k(l,-u,0),k(-l,u,0),k(l,u,0)];a[i]=T[0].x+r,a[i+1]=T[0].y+o,a[i+2]=T[0].z+s,a[i+9]=T[1].x+r,a[i+10]=T[1].y+o,a[i+11]=T[1].z+s,a[i+18]=T[2].x+r,a[i+19]=T[2].y+o,a[i+20]=T[2].z+s,a[i+27]=T[3].x+r,a[i+28]=T[3].y+o,a[i+29]=T[3].z+s}D.toArray(a,e.color,i+5),D.toArray(a,e.color,i+14),D.toArray(a,e.color,i+23),D.toArray(a,e.color,i+32)}},{key:"step",value:function(e){var t=this.sys.node,n=this.particles;t.updateWorldTransform(),this.active&&this.sys.emitting(e);var i=this.renderData,a=n.length;i.reset(),this.requestData(4*a,6*a),a>this.uvFilled&&this.updateUVs();for(var r=0;r<n.length;){var o=n[r];if(o)if(o.remainingLifetime-=e,o.remainingLifetime>0){var s=9*r*4;this.updateParticleBuffer(o,o.pos,i,s),++r}else{var l=n[r];r!==n.length-1&&(n[r]=n[n.length-1]),TL.put(l),n.length--,i.resize(i.vertexCount-4,i.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,i.setRenderDrawInfoAttributes()}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,r=n;r<i;r++){var o=4*r;a[n++]=o,a[n++]=o+1,a[n++]=o+2,a[n++]=o+1,a[n++]=o+3,a[n++]=o+2}}},{key:"initDrawInfo",value:function(){this.renderData.setRenderDrawInfoAttributes()}}]),e}();g._RF.pop(),g._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var EL,LL,xL,IL,AL,RL,PL,_L=23541,NL=39825,OL=91041,BL=125292,DL=197866,FL=156497;g._RF.pop(),g._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var ML,zL,UL,GL,HL,WL,VL,jL,qL,KL=m.ccclass,YL=m.property,JL=OL,ZL=(EL=KL("ColorOvertimeModule"),LL=YL({type:R}),xL=YL({type:mL}),EL((RL=e((AL=function(){function e(){i(this,e),a(this,"enable",RL,this),a(this,"color",PL,this)}return o(e,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=yL;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?we(e.randomSeed+JL):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),e}()).prototype,"enable",[LL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PL=e(AL.prototype,"color",[xL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new mL}}),IL=AL))||IL);g._RF.pop(),g._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var XL,QL,$L,ex,tx,nx,ix,ax,rx,ox,sx,lx,ux,cx=m.ccclass,hx=m.property,px=_L,dx=(ML=cx("LimitVelocityOvertimeModule"),zL=hx({type:R}),UL=hx({type:pL}),GL=hx({type:pL}),ML((VL=e((WL=function(){function e(){i(this,e),a(this,"enable",VL,this),a(this,"limit",jL,this),a(this,"dampen",qL,this),this.limit.constant=500,this.dampen.constant=.2}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),a=SL(this.limit)?we(e.randomSeed+px):0,r=SL(this.dampen)?we(e.randomSeed+px+1):0,o=e.velocity.length(),s=this.limit.evaluate(n,a),l=this.dampen.evaluate(n,r);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(o,s,l,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var a=1-Math.exp(-n*i);return Y.lerp(e,t,a)}}]),e}()).prototype,"enable",[zL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jL=e(WL.prototype,"limit",[UL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),qL=e(WL.prototype,"dampen",[GL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),HL=WL))||HL);g._RF.pop(),g._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var fx,yx,vx,gx,mx,bx,Sx,wx,kx,Tx,Cx,Ex,Lx,xx,Ix,Ax,Rx,Px,_x,Nx,Ox,Bx,Dx,Fx=m.ccclass,Mx=m.property,zx=BL,Ux=(XL=Fx("RotationOvertimeModule"),QL=Mx({type:R}),$L=Mx(R),ex=Mx({type:pL,visible:function(){return this.separateAxes}}),tx=Mx({type:pL,visible:function(){return this.separateAxes}}),nx=Mx({type:pL}),XL((rx=e((ax=function(){function e(){i(this,e),a(this,"enable",rx,this),a(this,"separateAxes",ox,this),a(this,"x",sx,this),a(this,"y",lx,this),a(this,"z",ux,this)}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+zx,a=SL(this.z)?we(i):0,r=this.z.evaluate(n,a)*t,o=0,s=0;if(this.separateAxes){var l=SL(this.x)?we(i):0,u=SL(this.y)?we(i):0;o=this.x.evaluate(n,l)*t,s=this.y.evaluate(n,u)*t}e.rotation.add3f(o,s,r)}}}]),e}()).prototype,"enable",[QL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ox=e(ax.prototype,"separateAxes",[$L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sx=e(ax.prototype,"x",[ex],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),lx=e(ax.prototype,"y",[tx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),ux=e(ax.prototype,"z",[nx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),ix=ax))||ix);g._RF.pop(),g._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var Gx,Hx,Wx,Vx,jx,qx,Kx,Yx,Jx,Zx,Xx,Qx,$x,eI=m.ccclass,tI=m.property,nI=W({Circle:0,Rectangle:1}),iI=W({Base:0,Edge:1}),aI=function(){return this.shape===nI.Circle},rI=function(){return this.shape===nI.Rectangle},oI=[0,0],sI=(fx=eI("ShapeModule"),yx=tI({type:W(nI)}),vx=tI({type:W(iI),visible:rI}),gx=tI({}),mx=tI({}),bx=tI({}),Sx=tI({range:[0,360],visible:aI}),wx=tI({range:[-360,360],visible:aI}),kx=tI({min:0,visible:aI}),Tx=tI({range:[0,1],step:.01,visible:aI}),Cx=tI({visible:rI}),fx((xx=e((Lx=function(){function e(){i(this,e),a(this,"shape",xx,this),a(this,"emitFrom",Ix,this),a(this,"position",Ax,this),a(this,"rotation",Rx,this),a(this,"scale",Px,this),a(this,"arc",_x,this),a(this,"angle",Nx,this),a(this,"radius",Ox,this),a(this,"radiusThickness",Bx,this),a(this,"rectangleThickness",Dx,this)}return o(e,[{key:"emit",value:function(e){switch(this.shape){case nI.Circle:this.circleEmit(this.radius,this.radiusThickness,ke(this.generateArcAngle()),e);break;case nI.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var a=i.pos;bL(a,e*(1-t),e,n+ke(this.angle)),i.velocity=a.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,a,r,o=n.pos;switch(e){case iI.Base:a=o,r=t,j.set(a,ve(-r.x,r.x),ve(-r.y,r.y));break;case iI.Edge:oI[0]=ve(-1,1),oI[1]=(0===(i=ve(-1,1))&&i++,fe.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+ge(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(oI),this.applyRectThickness(oI,t),j.set(o,oI[0],oI[1])}n.velocity=o.clone().normalize()}},{key:"generateArcAngle",value:function(){return ve(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case nI.Circle:this.gizmoCircle(e);break;case nI.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(ke(this.angle)),a=this.radius*Math.sin(ke(this.angle)),r=this.radius*Math.cos(ke(this.arc+this.angle)),o=this.radius*Math.sin(ke(this.arc+this.angle));e.moveTo(i,a),e.lineTo(0,0),e.moveTo(r,o),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var a=(i-n)/48,r=0;r<=48;r++){var o=n+r*a,s=t*Math.cos(ke(o)),l=t*Math.sin(ke(o));0===r?e.moveTo(s,l):e.lineTo(s,l)}}}]),e}()).prototype,"shape",[yx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return nI.Circle}}),Ix=e(Lx.prototype,"emitFrom",[vx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return iI.Base}}),Ax=e(Lx.prototype,"position",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(0,0,0)}}),Rx=e(Lx.prototype,"rotation",[mx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(0,0,0)}}),Px=e(Lx.prototype,"scale",[bx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new F(1,1,1)}}),_x=e(Lx.prototype,"arc",[Sx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),Nx=e(Lx.prototype,"angle",[wx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),Ox=e(Lx.prototype,"radius",[kx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Bx=e(Lx.prototype,"radiusThickness",[Tx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Dx=e(Lx.prototype,"rectangleThickness",[Cx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(20,50)}}),Ex=Lx))||Ex);g._RF.pop(),g._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var lI,uI,cI,hI,pI,dI,fI,yI,vI,gI=m.ccclass,mI=m.property,bI=NL,SI=(Gx=gI("SizeOvertimeModule"),Hx=mI({type:R}),Wx=mI(R),Vx=mI({type:pL,visible:function(){return!this.separateAxes}}),jx=mI({type:pL,visible:function(){return this.separateAxes}}),qx=mI({type:pL,visible:function(){return this.separateAxes}}),Gx((Jx=e((Yx=function(){function e(){i(this,e),a(this,"enable",Jx,this),a(this,"separateAxes",Zx,this),a(this,"size",Xx,this),a(this,"x",Qx,this),a(this,"y",$x,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return o(e,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+bI;if(this.separateAxes){var i=SL(this.x)?we(n):0,a=SL(this.y)?we(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,a)}else{var r=SL(this.size)?we(n):0,o=this.size.evaluate(t,r);F.multiplyScalar(e.size,e.startSize,o)}}}}]),e}()).prototype,"enable",[Hx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zx=e(Yx.prototype,"separateAxes",[Wx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xx=e(Yx.prototype,"size",[Vx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),Qx=e(Yx.prototype,"x",[jx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),$x=e(Yx.prototype,"y",[qx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),Kx=Yx))||Kx);g._RF.pop(),g._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var wI,kI,TI,CI,EI,LI,xI,II,AI,RI,PI,_I,NI,OI,BI,DI,FI,MI,zI,UI,GI,HI,WI,VI,jI,qI,KI,YI,JI,ZI,XI,QI,$I,eA,tA,nA,iA,aA,rA,oA,sA,lA,uA,cA,hA,pA,dA,fA,yA,vA,gA,mA,bA,SA,wA,kA,TA,CA,EA,LA,xA,IA=m.ccclass,AA=m.property,RA=(lI=IA("VelocityOvertimeModule"),uI=AA({type:R}),cI=AA({type:pL}),hI=AA({type:pL}),lI((fI=e((dI=function(){function e(){i(this,e),a(this,"enable",fI,this),a(this,"x",yI,this),a(this,"y",vI,this),this._temp_v3=new F,this.x.constant=0,this.y.constant=0}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=SL(this.x)?we(e.randomSeed+DL):0,a=SL(this.y)?we(e.randomSeed+FL):0,r=F.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,a),0);e.velocity.add(r.multiplyScalar(t))}}}]),e}()).prototype,"enable",[uI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yI=e(dI.prototype,"x",[cI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),vI=e(dI.prototype,"y",[hI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),pI=dI))||pI);g._RF.pop(),g._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var PA,_A,NA,OA,BA,DA,FA,MA=m.ccclass,zA=m.property,UA=m.executeInEditMode,GA=m.disallowMultiple,HA=m.playOnFocus,WA=Te.Attr.setClassAttr,VA=W({World:0,Local:1}),jA=(wI=MA("ParticleSystem"),kI=UA(!0),TI=GA(!0),CI=HA(!0),EI=zA({}),LI=zA({formerlySerializedAs:"preview"}),xI=zA(R),II=zA({type:W(VA)}),AI=zA({formerlySerializedAs:"simulationSpace"}),RI=zA(V),PI=zA(R),_I=zA({type:pL}),NI=zA({type:pL}),OI=zA(mL),BI=zA(R),DI=zA({type:pL,formerlySerializedAs:"startSize"}),FI=zA({type:pL,visible:function(){return this.startSize2D}}),MI=zA({type:pL}),zI=zA(R),UI=zA({type:pL,visible:function(){return this.startRotation3D}}),GI=zA({type:pL,visible:function(){return this.startRotation3D}}),HI=zA({type:pL,formerlySerializedAs:"startRotation"}),WI=zA({type:pL}),VI=zA({type:pL}),jI=zA({type:sI}),qI=zA({type:RA}),KI=zA({type:SI}),YI=zA({type:Ux}),JI=zA({type:ZL}),ZI=zA({type:dx}),XI=zA(jE),QI=zA({serializable:!0}),$I=zA({type:ae}),wI(eA=kI(eA=TI(eA=CI((e((tA=function(e){t(l,e);var s=n(l);function l(){var e;return i(this,l),e=s.call(this),a(e,"_preview",nA,r(e)),a(e,"playOnAwake",iA,r(e)),a(e,"_simulationSpace",aA,r(e)),a(e,"duration",rA,r(e)),a(e,"loop",oA,r(e)),a(e,"startDelay",sA,r(e)),a(e,"startLifetime",lA,r(e)),a(e,"startColor",uA,r(e)),a(e,"startSize2D",cA,r(e)),a(e,"startSizeX",hA,r(e)),a(e,"startSizeY",pA,r(e)),a(e,"startSpeed",dA,r(e)),a(e,"startRotation3D",fA,r(e)),a(e,"startRotationX",yA,r(e)),a(e,"startRotationY",vA,r(e)),a(e,"startRotationZ",gA,r(e)),a(e,"gravityModifier",mA,r(e)),a(e,"rateOverTime",bA,r(e)),a(e,"shapeModule",SA,r(e)),a(e,"velocityOvertimeModule",wA,r(e)),a(e,"sizeOvertimeModule",kA,r(e)),a(e,"rotationOvertimeModule",TA,r(e)),a(e,"colorOvertimeModule",CA,r(e)),a(e,"limitVelocityOvertimeModule",EA,r(e)),a(e,"bursts",LA,r(e)),a(e,"_spriteFrame",xA,r(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return o(l,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){p(h(l.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){p(h(l.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new CL(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){p(h(l.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new F(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e,t=ee.Assembler.getAssembler(this);if(this._assembler!==t&&(this._assembler=t),null!==(e=this._assembler)&&void 0!==e&&e.createData){var n=this._simulator,i=n.renderData;i||(i=n.renderData=this._assembler.createData(this),n.uvFilled=0,i.particleInitRenderDrawInfo(this.renderEntity),n.initDrawInfo())}}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===VA.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return p(h(l.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===VA.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===VA.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){var e;"function"==typeof(null===(e=this._renderEntity)||void 0===e?void 0:e.setRenderTransform)&&(this.simulationSpace===VA.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===VA.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1)))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var a,r=d(this.bursts);try{for(r.s();!(a=r.n()).done;){a.value.update(this,e)}}catch(e){r.e(e)}finally{r.f()}}var o=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,o),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var a=this._simulator.emitParticle();if(a.init(),this.shapeModule.emit(a),this.simulationSpace===VA.World){var r=this.node.worldMatrix;a.pos.x+=r.m12,a.pos.y+=r.m13}var o=this.startSpeed.evaluate(n,this.rand());a.velocity.multiplyScalar(o),a.width=this.spriteFrame.width,a.height=this.spriteFrame.height;var s=this.startSizeX.evaluate(n,this.rand()),l=this.startSize2D?new F(s,this.startSizeY.evaluate(n,this.rand()),1):new F(s,s,1);a.startSize=l.clone(),a.size=l.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new F(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new F(0,0,u);a.rotation=c,a.startColor=this.startColor.evaluate(n,this.rand()).clone(),a.color=a.startColor.clone(),a.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,a.remainingLifetime=a.startLifetime,a.randomSeed=ge(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new F(0,-9.8*t,0))}},{key:"rand",value:function(){return we(ge(0,fe.INT_MAX))}}]),l}(Ce)).prototype,"preview",[EI],Object.getOwnPropertyDescriptor(tA.prototype,"preview"),tA.prototype),nA=e(tA.prototype,"_preview",[LI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),iA=e(tA.prototype,"playOnAwake",[xI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),e(tA.prototype,"simulationSpace",[II],Object.getOwnPropertyDescriptor(tA.prototype,"simulationSpace"),tA.prototype),aA=e(tA.prototype,"_simulationSpace",[AI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return VA.Local}}),rA=e(tA.prototype,"duration",[RI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),oA=e(tA.prototype,"loop",[PI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sA=e(tA.prototype,"startDelay",[_I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),lA=e(tA.prototype,"startLifetime",[NI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),uA=e(tA.prototype,"startColor",[OI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new mL}}),cA=e(tA.prototype,"startSize2D",[BI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hA=e(tA.prototype,"startSizeX",[DI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),pA=e(tA.prototype,"startSizeY",[FI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),dA=e(tA.prototype,"startSpeed",[MI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),fA=e(tA.prototype,"startRotation3D",[zI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yA=e(tA.prototype,"startRotationX",[UI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),vA=e(tA.prototype,"startRotationY",[GI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),gA=e(tA.prototype,"startRotationZ",[HI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),mA=e(tA.prototype,"gravityModifier",[WI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),bA=e(tA.prototype,"rateOverTime",[VI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pL}}),SA=e(tA.prototype,"shapeModule",[jI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new sI}}),wA=e(tA.prototype,"velocityOvertimeModule",[qI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new RA}}),kA=e(tA.prototype,"sizeOvertimeModule",[KI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new SI}}),TA=e(tA.prototype,"rotationOvertimeModule",[YI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ux}}),CA=e(tA.prototype,"colorOvertimeModule",[JI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ZL}}),EA=e(tA.prototype,"limitVelocityOvertimeModule",[ZI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new dx}}),LA=e(tA.prototype,"bursts",[zA,XI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xA=e(tA.prototype,"_spriteFrame",[QI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(tA.prototype,"spriteFrame",[$I],Object.getOwnPropertyDescriptor(tA.prototype,"spriteFrame"),tA.prototype),eA=tA))||eA)||eA)||eA)||eA);WA(jA,"color","visible",!1),g._RF.pop(),g._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var qA,KA=m.ccclass,YA=m.property;PA=KA("RendererModule"),_A=YA(Ee),NA=YA(ae),PA((DA=e((BA=o((function e(){i(this,e),a(this,"material",DA,this),a(this,"spriteFrame",FA,this)}))).prototype,"material",[_A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FA=e(BA.prototype,"spriteFrame",[NA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OA=BA));g._RF.pop(),g._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);(0,m.ccclass)("ExampleParticleSystem2DExtra")(qA=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"initParticle",value:function(e){e.maxSize=Y.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=Y.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Y.randomRange(-350,350),e.y=n+Y.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(pE));g._RF.pop(),g._RF.push({},"9c8fbsqmiJP+4ZOp4zST378","DailyRewardsUtils",void 0);var JA=codex.player,ZA=[{id:1,type:"shuffle",value:1},{id:2,type:"hint",value:1},{id:3,type:"both",value:1}],XA=Ludex.Configs.DailyRewards.MockTime,QA=function(){function e(){i(this,e)}var t,n;return o(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"setDirty",value:function(){this.lastClaim=0}},{key:"logLoginReward",value:function(){this.lastClaim=Date.now(),JA.setGameData({lastClaimDailyReward:this.lastClaim})}},{key:"tryUpdateData",value:(n=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.lastClaim=JA.getGameData().lastClaimDailyReward||0;case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getDailyReward",value:function(){return this.getCanClaimReward()?ZA[Math.floor(Math.random()*ZA.length)]:null}},{key:"getCanClaimReward",value:function(){return XA?Date.now()-this.lastClaim>=XA:!st(this.lastClaim)}},{key:"openPopupScreenAndWaitForClosed",value:(t=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt.openScreenAndWaitForClosed(Ge.DAILY_REWARD_SCREEN,{});case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}();QA.lastClaim=0,g._RF.pop(),g._RF.push({},"b085anIQ8pNU7FLMVpg0+Br","OfflineRewardUtils",void 0);var $A,eR={HintItem:4,ShuffleItem:4},tR=codex,nR=(tR.event,tR.player),iR=function(){function e(){i(this,e),this.lastLoginTime=0,this.canClaimReward=!1}return o(e,[{key:"processOfflineRewards",value:function(){var e=this.getLastLoginTime();if((this.lastLoginTime=e||Date.now(),!st(this.lastLoginTime))&&(new Date).getTime()-this.lastLoginTime>=2592e5)return this.canClaimReward=!0,void(this.rewards={UndoItem:eR.UndoItem,HintItem:eR.HintItem,ShuffleItem:eR.ShuffleItem});this.reset()}},{key:"reset",value:function(){this.lastLoginTime=Date.now(),this.rewards={UndoItem:0,HintItem:0,ShuffleItem:0},this.canClaimReward=!1}},{key:"getLastLoginTime",value:function(){var e=nR.getGameData().lastLoginTime;return 0===e?Date.now():e}}],[{key:"initData",value:function(){this.inst.processOfflineRewards()}},{key:"inst",get:function(){return e.instance||(e.instance=new e),e.instance}},{key:"handleClaimReward",value:function(){this.inst.processOfflineRewards(),e.inst.canClaimReward&&(this.inst.lastLoginTime=Date.now(),this.inst.rewards={UndoItem:0,HintItem:0,ShuffleItem:0},this.inst.canClaimReward=!1)}},{key:"getRewards",value:function(){return e.inst.rewards}},{key:"getCanClaimReward",value:function(){return!1}}]),e}();g._RF.pop(),g._RF.push({},"eeaab2Odg9N8YeoToeSN096","PaymentUtils",void 0);var aR,rR=m.ccclass,oR={ID:"remove_ad_30"},sR={ID:"item_combo_10",SHUFFLE_ITEM_COUNT:10,HINT_ITEM_COUNT:10},lR={ID:"item_combo_50",SHUFFLE_ITEM_COUNT:50,HINT_ITEM_COUNT:50},uR={ID:"free_item",SHUFFLE_ITEM_COUNT:1,HINT_ITEM_COUNT:1},cR=rR("PaymentUtils")($A=function(e){t(p,e);var a,r,u,c,h=n(p);function p(){return i(this,p),h.apply(this,arguments)}return o(p,null,[{key:"inst",get:function(){return this._instance||(this._instance=new p),this._instance}},{key:"initPayment",value:function(){var e=this;try{var t;null===(t=GameSDK.payments)||void 0===t||t.onReady((function(){console.log("GameSDK.payments.onReady"),e.fetchUnconsumedPurchasesAsync()}))}catch(e){console.error("Error initPayment",e)}}},{key:"getCatalogAsync",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.payments.getCatalogAsync();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),console.error("getCatalogAsync",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return c.apply(this,arguments)})},{key:"purchaseAsync",value:(u=s(l().mark((function e(t,n){var i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={productID:t},n&&(i.developerPayload=n),e.next=4,GameSDK.payments.purchaseAsync(i);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})},{key:"fetchUnconsumedPurchasesAsync",value:(r=s(l().mark((function e(){var t,n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.payments.getPurchasesAsync();case 3:if(t=e.sent,console.log("Unconsumed purchases:",t),!(t.length>0)){e.next=23;break}n=d(t),e.prev=7,n.s();case 9:if((i=n.n()).done){e.next=15;break}return a=i.value,e.next=13,this.consumePurchaseAsync(a.productID,a.purchaseToken);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),n.e(e.t0);case 20:return e.prev=20,n.f(),e.finish(20);case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error("fetchUnconsumedPurchasesAsync",e.t1);case 28:case"end":return e.stop()}}),e,this,[[0,25],[7,17,20,23]])}))),function(){return r.apply(this,arguments)})},{key:"consumePurchaseAsync",value:(a=s(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.payments.consumePurchaseAsync(n);case 2:this.consumePurchaseRewards(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"consumePurchaseRewards",value:function(e){if(console.log("Consume rewards for product: ".concat(e)),e===oR.ID){
//! Set remove ad data to player
var t=Date.now()+2592e6;codex.player.setGameData({removeAdEndTime:t}),je.checkRemoveAdEndTime()}else e===sR.ID?(ut.addItem(ct[lt.SHUFFLE],sR.SHUFFLE_ITEM_COUNT),ut.addItem(ct[lt.HINT],sR.HINT_ITEM_COUNT)):e===lR.ID&&(ut.addItem(ct[lt.SHUFFLE],lR.SHUFFLE_ITEM_COUNT),ut.addItem(ct[lt.HINT],lR.HINT_ITEM_COUNT))}}]),p}(k))||$A;g._RF.pop(),g._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var hR,pR,dR,fR,yR,vR,gR,mR=m.ccclass,bR=m.disallowMultiple,SR=Ludex,wR=SR.Events,kR=SR.Configs.Core.StartSDKAfterLoadGame,TR=codex,CR=TR.ads,ER=TR.player,LR=TR.event;TR.context,mR("BootScene")(aR=bR(aR=function(e){t(u,e);var a,r=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).loadLevel=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(null===(t=codex.player.getGameData())||void 0===t?void 0:t.level)||1,nt.setLevel(n),nt.setMaxLevel(n),e.next=6,nt.preloadLevelDataAsync(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error loading level",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),e.loadBackground=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.loadCurrentBackground();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error loading background",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),e.loadTheme=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ne.loadCurrentTheme();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error loading theme",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),e.setupLoadingFullScreen=function(){kR?(pt.addShowedScene(St.BOOT_SCENE),ER.isFirstSession()?pt.addShowedScene(St.GAME_SCENE):pt.addShowedScene(St.DASHBOARD_SCENE)):pt.showLoadingFullScreen(St.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.setupGameData(),e.sendMsGamesDailyNotification()},e.loadWasmModules=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.lazyLoadWasmModules=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.handlePauseAudio=function(){LR.on(wR.VISIBILITY_HIDDEN,e.handleMuteAudio),LR.on(wR.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){Me.muteAudio(!0)},e.handleUnMuteAudio=function(){CR.isAdFullSizeShowing()||(Me.muteAudio(!1),Me.fixAudioForIOSOnFocus())},e}return o(u,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.initGameUtils(),this.preloadAssets(),this.listenEvents()}},{key:"initGameUtils",value:function(){try{var e;vt.initDebugger(),nt.init(),je.checkRemoveAdEndTime(),Ne.initTheme(),ft.initData(),mt.initData(),tt.initAsync(),cR.initPayment(),fg.initData(),QA.tryUpdateData(),Kg.initData(),dt.initData(),iR.initData();var t=(null===(e=ER.getGameData())||void 0===e?void 0:e.lastLoginTime)||0;console.log("Last login time:",new Date(t).toLocaleString()),window.codex.player.setGameData({lastLoginTime:Date.now()})}catch(e){console.log("Error initializing game utils",e)}}},{key:"preloadAssets",value:(a=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x.pause(),(t=[]).push(this.loadLevel()),ER.isFirstSession()||t.push(this.loadBackground()),t.push(this.loadTheme()),e.next=8,Promise.all(t);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error preloading assets",e.t0);case 13:return e.prev=13,x.resume(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])}))),function(){return a.apply(this,arguments)})},{key:"onLoad",value:function(){this.handlePauseAudio(),this.overrideGameSDK(),this.setupLoadingFullScreen()}},{key:"start",value:function(){if(this.processCrazyGamesLoadingStop(),Ludex.Utils.Valid.isDebugger()){var e=window;e.LevelManager=nt,e.MatchUtils=rt,e.ScreenUtils=pt,e.DailyQuestManager=dt,e.AdsUtils=je,e.ThemeUtils=Ne,e.TournamentUtils=ft,e.AudioUtils=Me,e.LayoutUtils=Oe,e.DailyChallengeUtils=mt,e.JourneyUtils=tt,e.DailyRewardsUtils=QA,e.AdsUtils=je,e.ResourceUtils=Pe,e.LimitAdsUtils=fg,e.SocialUtils=Kg}}},{key:"listenEvents",value:function(){LR.catchUp(wR.GAME_READY,this.lazyLoadWasmModules),LR.catchUp(wR.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"overrideGameSDK",value:function(){if("FBInstant"in window&&"shareAsync"in FBInstant){var e=FBInstant.shareAsync;FBInstant.shareAsync=function(){var t=s(l().mark((function t(n){var i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.warn("shareAsync before",n),i=v({},n),console.warn("shareAsync after",i),t.abrupt("return",e(i));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}},{key:"setupGameData",value:function(){var e=ER.getGameData();if(e){var t=xt.MaxLevel,n=e.totalLevel,i={totalLevel:Math.max(n,t)};ER.setGameData(i)}}},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}}]),u}(k))||aR);g._RF.pop(),g._RF.push({},"e45b1inOmBOXrNV+qwzfUYP","SceneTransition",void 0);var xR,IR,AR,RR,PR,_R,NR,OR,BR,DR,FR,MR,zR,UR,GR,HR,WR,VR,jR,qR=m.ccclass,KR=m.property,YR=(Ludex.Utils.Signal,hR=qR("SceneTransition"),pR=KR(P),dR=KR(Le),hR((vR=e((yR=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"foreground",vR,r(e)),a(e,"blockInputEvents",gR,r(e)),e}return o(d,[{key:"onLoad",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){this.node.scene.on($e.SWITCH_SCENE,this.handleSwitchScene,this)}},{key:"handleSwitchScene",value:(h=s(l().mark((function e(t){var n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:0,e.next=3,this.runSwitchSceneAnimation(n);case 3:t();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"runSwitchSceneAnimation",value:(c=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,this.blockInputEvents.enabled=!0,n=B(this.foreground).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"smooth"}),e.next=5,Ve.runTweenAsync(n);case 5:this.blockInputEvents.enabled=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runOpenSceneAnimation",value:(u=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,this.blockInputEvents.enabled=!0,n=B(this.foreground).set({opacity:255}).delay(t).to(.2,{opacity:0},{easing:"smooth"}),e.next=5,Ve.runTweenAsync(n);case 5:this.blockInputEvents.enabled=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),d}(k)).prototype,"foreground",[pR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gR=e(yR.prototype,"blockInputEvents",[dR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fR=yR))||fR);g._RF.pop(),g._RF.push({},"32dab5C0R5IZbDfbsP/3nSu","JourneyButton",void 0);var JR,ZR,XR,QR,$R,eP,tP,nP,iP,aP,rP,oP=m.ccclass,sP=m.property,lP=(xR=oP("JourneyButton"),IR=sP(N),AR=sP(Ar),RR=sP(E),PR=sP(X),_R=sP(gh),NR=sP(gh),OR=sP(A),BR=sP(A),xR((MR=e((FR=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"journeyButton",MR,r(e)),a(e,"journeyButtonColor",zR,r(e)),a(e,"journeyOverlaySprite",UR,r(e)),a(e,"journeyButtonLabel",GR,r(e)),a(e,"journeyTimerTextLocalize",HR,r(e)),a(e,"journeyUnlockLabelLocalize",WR,r(e)),a(e,"journeyUnlockNode",VR,r(e)),a(e,"journeyLockNode",jR,r(e)),e.isScheduleTimer=!1,e}return o(l,[{key:"start",value:function(){this.updateTimeText(),this.updateButtonState()}},{key:"updateButtonState",value:function(){var e=tt.getMinLevelToUnlockJourney(),t=tt.checkJourneyUnlock();this.setJourneyButtonUnlock(t),this.journeyUnlockLabelLocalize.setParams([e.toString()]),this.journeyOverlaySprite.spriteFrame=tt.getJourneyButtonSpriteFrame()}},{key:"updateTimeText",value:function(){var e=tt.getJourneyEndTime();this.journeyTimerTextLocalize.key=e.key,this.journeyTimerTextLocalize.setParams(e.params)}},{key:"setJourneyButtonUnlock",value:function(e){this.journeyButton.interactable=e,e?(this.journeyButtonColor.clickColor=new D(255,255,255,255),this.journeyButtonColor.hoverColor=new D(255,255,255,255),this.journeyButtonColor.normalColor=new D(255,255,255,255),this.journeyLockNode.active=!1,this.journeyUnlockNode.active=!0,this.journeyButtonLabel.color=new D(253,242,162,255),this.setTimerActive(!0)):(this.journeyButtonColor.clickColor=new D(200,200,200,255),this.journeyButtonColor.hoverColor=new D(200,200,200,255),this.journeyButtonColor.normalColor=new D(200,200,200,255),this.journeyLockNode.active=!0,this.journeyUnlockNode.active=!1,this.journeyButtonLabel.color=new D(108,42,19,255),this.setTimerActive(!1))}},{key:"setTimerActive",value:function(e){e&&!this.isScheduleTimer&&(this.schedule(this.updateTimeText,1),this.isScheduleTimer=!0),!e&&this.isScheduleTimer&&(this.unschedule(this.updateTimeText),this.isScheduleTimer=!1)}}]),l}(k)).prototype,"journeyButton",[IR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zR=e(FR.prototype,"journeyButtonColor",[AR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UR=e(FR.prototype,"journeyOverlaySprite",[RR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GR=e(FR.prototype,"journeyButtonLabel",[PR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HR=e(FR.prototype,"journeyTimerTextLocalize",[_R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WR=e(FR.prototype,"journeyUnlockLabelLocalize",[NR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VR=e(FR.prototype,"journeyUnlockNode",[OR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jR=e(FR.prototype,"journeyLockNode",[BR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DR=FR))||DR);g._RF.pop(),g._RF.push({},"cdbc0jBcI5IgYgPbk2e9Q7j","DashboardFooter",void 0);var uP,cP,hP,pP,dP,fP,yP,vP=m.ccclass,gP=m.property,mP=(JR=vP("DashboardFooter"),ZR=gP(N),XR=gP(N),QR=gP(lP),$R=gP(gh),JR((nP=e((tP=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"playButton",nP,r(e)),a(e,"journeyButton",iP,r(e)),a(e,"journeyButtonComponent",aP,r(e)),a(e,"playButtonLabelLocalize",rP,r(e)),e}return o(p,[{key:"start",value:function(){this.updatePlayButton(),this.journeyButtonComponent.updateButtonState()}},{key:"updatePlayButton",value:function(){var e=nt.getLevel();this.playButtonLabelLocalize.setParams(["".concat(e)])}},{key:"setButtonsInteractable",value:function(e){this.playButton.interactable=e,this.journeyButton.interactable=e}},{key:"handlePlayButtonClicked",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(null===(t=codex.match.getMatchState())||void 0===t?void 0:t.mode)===Ty.CHALLENGE_FRIEND&&rt.switchToSoloContext(),rt.switchToNormal(),e.next=4,je.showInterstitialAdAsync();case 4:this.node.scene.emit($e.SWITCH_SCENE,(function(){Tt.switchToGameScene()}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleJourneyButtonClicked",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tt.checkJourneyUnlock()){e.next=3;break}return e.abrupt("return");case 3:if(!tt.canUpdateIncreaseSeason()){e.next=6;break}return e.abrupt("return");case 6:pt.openScreen(Ge.JOURNEY_LEVEL_SCREEN,{preloadCallback:tt.isNeedLoadCurrentJourneyBadge()?tt.loadCurrentJourneyBadge:void 0});case 7:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"playButton",[ZR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iP=e(tP.prototype,"journeyButton",[XR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aP=e(tP.prototype,"journeyButtonComponent",[QR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rP=e(tP.prototype,"playButtonLabelLocalize",[$R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eP=tP))||eP);g._RF.pop(),g._RF.push({},"5cee57cdVlOYac2TDI7DU6B","GameLogo",void 0);var bP,SP,wP,kP,TP,CP,EP,LP,xP,IP=m.ccclass,AP=m.property,RP=Ludex.Utils.Signal,PP=(uP=IP("GameLogo"),cP=AP(E),hP=AP(P),uP((fP=e((dP=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"sakuraSprite",fP,r(e)),a(e,"opacity",yP,r(e)),e.signalController=new RP.SignalController,e}return o(p,[{key:"__preload",value:function(){this.opacity.opacity=0}},{key:"showUI",value:function(){this.node.active=!0,this.opacity.opacity=255,this.node.setScale(new F(1,1,1))}},{key:"runPopInAnimation",value:(c=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,n=this.signalController.renew(),i=B(this.node).set({scale:new F(1.5,1.5,1)}).delay(t).to(.75,{scale:new F(1,1,1)},{easing:function(e){return Ve.elasticOut(e,.1,.45)}}),a=B(this.opacity).set({opacity:0}).delay(t).to(.2,{opacity:255}),r=Ve.runTweenAsync(i,n),o=Ve.runTweenAsync(a,n),e.next=8,Promise.all([r,o]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runIdleAnimation",value:function(){var e=this,t=this.signalController.renew(),n=B(this.sakuraSprite.node).set({angle:0}).by(15,{angle:540},{easing:"cubicInOut"}).by(15,{angle:-540},{easing:"cubicInOut"}).union(),i=B(this.sakuraSprite.node).set({angle:0}).repeatForever(n);t.once((function(){e.node.setRotationFromEuler(0,0,0)})),Ve.runTweenAsync(i,t)}},{key:"runHideAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,n=this.signalController.renew(),i=B(this.node).delay(t).to(.4,{scale:new F(.5,.5,1)},{easing:"backIn"}),a=B(this.opacity).delay(t+.2).to(.2,{opacity:0}),r=Ve.runTweenAsync(i,n),o=Ve.runTweenAsync(a,n),e.next=8,Promise.all([r,o]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"sakuraSprite",[cP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yP=e(dP.prototype,"opacity",[hP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pP=dP))||pP);g._RF.pop(),g._RF.push({},"801eer4yZtLgK1HWGAh3eEa","Main",void 0);var _P,NP,OP,BP,DP,FP,MP,zP,UP,GP=m.ccclass,HP=m.property,WP=(bP=GP("Main"),SP=HP(A),wP=HP(A),kP=HP(A),bP((EP=e((CP=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=c.call.apply(c,[this].concat(n))).basePosition={x:0,y:0},a(e,"tournamentButton",EP,r(e)),a(e,"playWithFriendButton",LP,r(e)),a(e,"shopButton",xP,r(e)),e}return o(h,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.basePosition={x:this.node.position.x,y:this.node.position.y},this.updateSocialFeatures()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"start",value:function(){}},{key:"handleChallengeFriendButtonClicked",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:rt.switchToNormal(),rt.openPopupChooseFriend();case 2:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"handleClickedDailyQuest",value:function(){pt.openScreen(Ge.DAILY_QUEST_SCREEN,{})}},{key:"handleTournamentButtonClicked",value:function(){ft.isTournamentHappening()&&ft.isInContextGlobalTournament()?pt.openScreen(Ge.TOURNAMENT_LEADERBOARD_SCREEN):pt.openScreen(Ge.TOURNAMENT_POPUP_SCREEN)}},{key:"updateTournamentButtonState",value:function(){yg.isTournamentFeatureAvailable()&&(ft.isHasValidTournament()?this.tournamentButton.active=!0:this.tournamentButton.active=!1)}},{key:"handleClickedShopButton",value:function(){pt.openScreen(Ge.SHOP_SCREEN,{source:St.DASHBOARD_SCENE})}},{key:"handleClickedDailyChallengeButton",value:function(){pt.openScreen(Ge.DAILY_CHALLENGE_SCREEN,{source:St.DASHBOARD_SCENE,preloadCallback:mt.isNeedLoadDailyChallenge()?mt.loadingTextureBeforeOpenDailyChallenge:void 0})}},{key:"updateSocialFeatures",value:function(){this.playWithFriendButton.active=yg.isPlayWithFriendFeatureAvailable(),this.tournamentButton.active=yg.isTournamentFeatureAvailable(),this.shopButton.active=yg.isIAPFeatureAvailable()}}]),h}(k)).prototype,"tournamentButton",[SP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LP=e(CP.prototype,"playWithFriendButton",[wP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xP=e(CP.prototype,"shopButton",[kP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TP=CP))||TP);g._RF.pop(),g._RF.push({},"8d8f6XFx19DWIYvM/BW8pRI","DashboardUi",void 0);var VP,jP,qP,KP,YP,JP,ZP,XP,QP,$P,e_,t_,n_,i_,a_,r_=m.ccclass,o_=m.property,s_=(_P=r_("DashboardUi"),NP=o_(PP),OP=o_(WP),BP=o_(mP),_P((MP=e((FP=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"gameLogo",MP,r(e)),a(e,"main",zP,r(e)),a(e,"footer",UP,r(e)),e}return o(p,[{key:"showUI",value:function(){this.gameLogo.showUI(),this.gameLogo.runIdleAnimation()}},{key:"runShowAnimation",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameLogo.runPopInAnimation();case 2:this.gameLogo.runIdleAnimation();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runHideAnimation",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameLogo.runHideAnimation();case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"updateTournamentButtonState",value:function(){this.main.updateTournamentButtonState()}},{key:"updateJourneyButtonState",value:function(){this.footer.journeyButtonComponent.updateButtonState()}},{key:"setButtonsInteractable",value:function(e){this.footer.setButtonsInteractable(e)}}]),p}(k)).prototype,"gameLogo",[NP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zP=e(FP.prototype,"main",[OP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UP=e(FP.prototype,"footer",[BP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DP=FP))||DP);g._RF.pop(),g._RF.push({},"c204dxNBw1BVL4oP1qs5X7Q","OpenableChest",void 0);var l_,u_,c_,h_,p_,d_=m.ccclass,f_=m.property,y_=(VP=d_("OpenableChest"),jP=f_(A),qP=f_(E),KP=f_(E),YP=f_(E),JP=f_(ae),ZP=f_(ae),VP(($P=e((QP=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"chestNode",$P,r(e)),a(e,"chestTop",e_,r(e)),a(e,"chestBottom",t_,r(e)),a(e,"glow",n_,r(e)),a(e,"chestTopSpriteFrames",i_,r(e)),a(e,"chestBottomSpriteFrames",a_,r(e)),e}return o(h,[{key:"onLoad",value:function(){this.chestNodeBasePosition={x:this.chestNode.position.x,y:this.chestNode.position.y},this.chestTopBasePosition={x:this.chestTop.node.position.x,y:this.chestTop.node.position.y},this.chestBottomBasePosition={x:this.chestBottom.node.position.x,y:this.chestBottom.node.position.y},this.glowOpacity=this.glow.getComponent(P),this.chestTopOpacity=this.chestTop.getComponent(P),this.chestBottomOpacity=this.chestBottom.getComponent(P),this.reset()}},{key:"onEnable",value:function(){}},{key:"runChestAnimation",value:(u=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateChestSprite(t),this.reset(),e.next=4,this.runShakeAndMoveDownAnimation();case 4:return e.next=6,this.runOpenChestAnimation();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"runShakeAndMoveDownAnimation",value:function(){var e=this;return this.chestNode.setPosition(new F(this.chestNodeBasePosition.x,this.chestNodeBasePosition.y,0)),new Promise((function(t){var n=.125,i=B().by(n,{angle:15}).by(n,{angle:-30}).by(n,{angle:30}).by(n,{angle:-15}).by(n,{angle:0}),a=B().by(.25,{position:new F(0,-200,0)});B(e.chestNode).then(i).then(a).call((function(){t()})).start()}))}},{key:"runOpenChestAnimation",value:function(){var e=this;return this.chestTop.node.setPosition(new F(this.chestTopBasePosition.x,this.chestTopBasePosition.y,0)),this.chestBottom.node.setPosition(new F(this.chestBottomBasePosition.x,this.chestBottomBasePosition.y,0)),new Promise((function(t){var n=.75,i=B().by(n,{position:new F(0,-130,0)},{easing:"sineInOut"}),a=B().to(.25,{opacity:255});e.scheduleOnce((function(){B(e.glowOpacity).then(a).start(),t()}),.25);var r={value:0},o=te(0,0,0),s=te(230,600,0),l=te(500,300,0);B(r).to(.75,{value:1},{easing:"sineInOut",onUpdate:function(){var t=r.value,n=1-t,i=n*n*o.x+2*n*t*s.x+t*t*l.x,a=n*n*o.y+2*n*t*s.y+t*t*l.y;e.chestTop.node.setPosition(i,a,0)}}).start(),B(e.chestTop.node).to(.75,{angle:-135}).start(),B(e.chestBottom.node).then(i).start(),B(e.chestTopOpacity).to(.5,{opacity:255}).to(.25,{opacity:0}).start(),B(e.chestBottomOpacity).to(.5,{opacity:255}).to(.5,{opacity:0}).start()}))}},{key:"reset",value:function(){this.chestNode.setPosition(new F(this.chestNodeBasePosition.x,this.chestNodeBasePosition.y,0)),this.chestTop.node.setPosition(new F(this.chestTopBasePosition.x,this.chestTopBasePosition.y,0)),this.chestBottom.node.setPosition(new F(this.chestBottomBasePosition.x,this.chestBottomBasePosition.y,0)),this.glowOpacity.opacity=0,this.chestTopOpacity.opacity=255,this.chestBottomOpacity.opacity=255,this.chestTop.node.angle=0}},{key:"updateChestSprite",value:function(e){e<0||e>=this.chestTopSpriteFrames.length?console.warn("OpenableChest: Invalid chest index"):(this.chestTop.spriteFrame=this.chestTopSpriteFrames[e],this.chestBottom.spriteFrame=this.chestBottomSpriteFrames[e])}}]),h}(k)).prototype,"chestNode",[jP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e_=e(QP.prototype,"chestTop",[qP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t_=e(QP.prototype,"chestBottom",[KP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n_=e(QP.prototype,"glow",[YP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=e(QP.prototype,"chestTopSpriteFrames",[JP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a_=e(QP.prototype,"chestBottomSpriteFrames",[ZP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),XP=QP))||XP);g._RF.pop(),g._RF.push({},"868e8cNp1hFwZiarM+NSgo7","RewardItemContainer",void 0);var v_,g_,m_,b_,S_,w_,k_,T_,C_,E_,L_,x_,I_,A_,R_,P_,__,N_,O_,B_,D_,F_,M_,z_,U_,G_,H_,W_,V_=m.ccclass,j_=m.property,q_=(l_=V_("RewardItemContainer"),u_=j_(X),l_((p_=e((h_=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"counterLabel",p_,r(e)),e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.setCounter(0)}},{key:"setCounter",value:function(e){this.counterLabel.string=e.toString()}}]),l}(k)).prototype,"counterLabel",[u_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c_=h_))||c_);g._RF.pop(),g._RF.push({},"4d2b3GHRKZGxqQJRRGfsXy8","RewardScreen",void 0);var K_,Y_,J_,Z_,X_,Q_,$_,eN,tN=m.ccclass,nN=m.disallowMultiple,iN=m.requireComponent,aN=m.property,rN=Ludex.Events,oN=codex,sN=oN.event,lN=oN.language,uN=oN.analytics,cN=0,hN=1,pN=2,dN=3;v_=tN("RewardScreen"),g_=iN(Si),m_=aN(A),b_=aN(X),S_=aN(gh),w_=aN(X),k_=aN(gh),T_=aN(oe),C_=aN(oe),E_=aN(q_),L_=aN(q_),x_=aN(N),I_=aN(N),A_=aN(y_),v_(R_=nN(R_=g_((__=e((P_=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"container",__,r(e)),a(e,"titleLabel",N_,r(e)),a(e,"titleLocalize",O_,r(e)),a(e,"descriptionLabel",B_,r(e)),a(e,"descriptionLocalize",D_,r(e)),a(e,"rewardLayout",F_,r(e)),a(e,"footerLayout",M_,r(e)),a(e,"shuffleItem",z_,r(e)),a(e,"hintItem",U_,r(e)),a(e,"collectButton",G_,r(e)),a(e,"adsX2Button",H_,r(e)),a(e,"openableChest",W_,r(e)),e.screenData=null,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("RewardScreen: screen not found");e.validateEventPayload(t)&&e.hideItem()},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.screenData=e.screen.data,e.alignUI(),e.runRewardAnimation())},e}return o(p,[{key:"__preload",value:function(){this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){sN.on(rN.OPENING_SCREEN,this.handleOpeningScreen),sN.on(rN.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){sN.off(rN.OPENING_SCREEN,this.handleOpeningScreen),sN.off(rN.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"close",value:function(){this.collectButton.interactable=!1,this.adsX2Button.interactable=!1,pt.closeScreen(Ge.REWARD_SCREEN)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"hideItem",value:function(){this.openableChest.node.active=!1,this.shuffleItem.node.active=!1,this.hintItem.node.active=!1,this.adsX2Button.node.scale=new F(0,0,0),this.collectButton.node.scale=new F(0,0,0),this.adsX2Button.node.active=!1,this.collectButton.node.active=!1,this.adsX2Button.interactable=!1,this.collectButton.interactable=!1}},{key:"alignUI",value:function(){var e=this.screenData,t=je.getBannerAdsHeight();e.title||e.description||!1||(t+=50),e.watchAdsDoubleReward||!1||(t+=-62.5),this.container.setPosition(new F(0,t,0))}},{key:"runRewardAnimation",value:(c=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,d,y;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=this.screenData).title?lN.hasTextKey(i.title)?(this.titleLabel.node.active=!0,this.titleLocalize.key=i.title):(this.titleLabel.node.active=!0,this.titleLocalize.key="customString",this.titleLocalize.setParams([i.title])):this.titleLabel.node.active=!1,i.description?lN.hasTextKey(i.description)?(this.descriptionLabel.node.active=!0,this.descriptionLocalize.key=i.description,i.descriptionParams?this.descriptionLocalize.setParams(i.descriptionParams):this.descriptionLocalize.setParams([])):(this.descriptionLabel.node.active=!0,this.descriptionLocalize.key="customString",this.descriptionLocalize.setParams([i.description])):this.descriptionLabel.node.active=!1,void 0===(a=i.chestId)){e.next=10;break}return this.openableChest.node.active=!0,e.next=8,this.openableChest.runChestAnimation(a);case 8:e.next=11;break;case 10:this.openableChest.node.active=!1;case 11:return r=(null===(t=i.items.find((function(e){return e.item===lt.HINT})))||void 0===t?void 0:t.count)||0,o=(null===(n=i.items.find((function(e){return e.item===lt.SHUFFLE})))||void 0===n?void 0:n.count)||0,r>0?(this.hintItem.node.active=!0,this.hintItem.setCounter(r)):this.hintItem.node.active=!1,o>0?(this.shuffleItem.node.active=!0,this.shuffleItem.setCounter(o)):this.shuffleItem.node.active=!1,this.rewardLayout.updateLayout(!0),s=[],this.shuffleItem.node.active&&(u=this.createMoveAnimation(this.shuffleItem.node),s.push.apply(s,f(u))),this.hintItem.node.active&&(c=this.createMoveAnimation(this.hintItem.node),s.push.apply(s,f(c))),e.next=21,Promise.all(s);case 21:return h=void 0===a?.5:1,p=[],i.watchAdsDoubleReward?this.adsX2Button.node.active=!0:this.adsX2Button.node.active=!1,this.collectButton.node.active=!0,this.footerLayout.updateLayout(!0),this.adsX2Button.node.active&&(d=B(this.adsX2Button.node).set({scale:new F(0,0,0)}).to(h,{scale:new F(1,1,1)},{easing:"backOut"}),p.push(Ve.runTweenAsync(d))),y=B(this.collectButton.node).set({scale:new F(0,0,0)}).to(h,{scale:new F(1,1,1)},{easing:"backOut"}),p.push(Ve.runTweenAsync(y)),e.next=31,Promise.all(p);case 31:this.collectButton.interactable=!0,this.adsX2Button.interactable=!0;case 33:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"createMoveAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=e.position.clone();e.setPosition(new F(0,-300,0)),e.setScale(new F(0,0,0));var i=B(e).to(t,{scale:new F(1,1,1)},{easing:"backOut"}),a=B(e).to(t,{x:n.x},{easing:"sineOut"}),r=B(e).to(t,{y:n.y},{easing:"sineIn"});return[Ve.runTweenAsync(i),Ve.runTweenAsync(a),Ve.runTweenAsync(r)]}},{key:"handleCollectButton",value:function(){var e,t;this.collectReward(1),null===(e=this.screenData)||void 0===e||null===(t=e.successCallback)||void 0===t||t.call(e),this.close()}},{key:"handleAdsX2Button",value:(u=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.adsX2Button.interactable=!1,this.collectButton.interactable=!1,e.next=4,je.showRewardVideoAdAsync();case 4:t=e.sent,this.adsX2Button.interactable=!0,this.collectButton.interactable=!0,t&&(this.collectReward(2),null===(n=this.screenData)||void 0===n||null===(i=n.successCallback)||void 0===i||i.call(n),this.close());case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"collectReward",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(null===(e=this.screenData)||void 0===e||!e.doNotUpdatePlayerData){var a=(null===(t=this.screenData)||void 0===t||null===(t=t.items.find((function(e){return e.item===lt.HINT})))||void 0===t?void 0:t.count)||0,r=(null===(n=this.screenData)||void 0===n||null===(n=n.items.find((function(e){return e.item===lt.SHUFFLE})))||void 0===n?void 0:n.count)||0;if(a>0){var o=ct[lt.HINT],s=a*i;ut.addItem(o,s),this.node.scene.emit($e.ITEM_COUNT_CHANGE,{item:o,count:ut.getItemCount(o)}),this.logEarnItem(s,o)}if(r>0){var l=ct[lt.SHUFFLE],u=r*i;ut.addItem(l,u),this.node.scene.emit($e.ITEM_COUNT_CHANGE,{item:l,count:ut.getItemCount(l)}),this.logEarnItem(u,l)}}}},{key:"logEarnItem",value:function(e,t){uN.event(gt.EARN_ITEM,{value:e,item_name:t,earn_from:this.screenData.earnFrom,level:nt.getLevel()})}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),p}(k)).prototype,"container",[m_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_=e(P_.prototype,"titleLabel",[b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O_=e(P_.prototype,"titleLocalize",[S_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B_=e(P_.prototype,"descriptionLabel",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D_=e(P_.prototype,"descriptionLocalize",[k_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F_=e(P_.prototype,"rewardLayout",[T_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M_=e(P_.prototype,"footerLayout",[C_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z_=e(P_.prototype,"shuffleItem",[E_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U_=e(P_.prototype,"hintItem",[L_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G_=e(P_.prototype,"collectButton",[x_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H_=e(P_.prototype,"adsX2Button",[I_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W_=e(P_.prototype,"openableChest",[A_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_=P_))||R_)||R_);g._RF.pop(),g._RF.push({},"c4e30ckJiFBG4VHrF+wikMs","DashboardScene",void 0);var fN,yN,vN,gN,mN,bN,SN,wN,kN,TN,CN,EN=m.ccclass,LN=m.disallowMultiple,xN=m.property,IN=codex.event,AN=Ludex.Events,RN=[Ue[Ge.OPTIONS_SCREEN],Ue[Ge.THEME_SCREEN],Ue[Ge.SHOP_SCREEN],Ue[Ge.TOURNAMENT_POPUP_SCREEN],Ue[Ge.TOURNAMENT_LEADERBOARD_SCREEN],Ue[Ge.LANGUAGES_SCREEN],Ue[Ge.DAILY_QUEST_SCREEN],Ue[Ge.DAILY_CHALLENGE_SCREEN],Ue[Ge.BADGES_SCREEN],Ue[Ge.JOURNEY_LEVEL_SCREEN],Ue[Ge.REWARD_SCREEN]];K_=EN("DashboardScene"),Y_=xN(s_),J_=xN(YR),Z_=Re.onlyRunInLifeCycle,K_(X_=LN(($_=e((Q_=function(e){t(g,e);var u,c,h,p,d,f,y=n(g);function g(){var e;i(this,g);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=y.call.apply(y,[this].concat(n)),a(e,"dashboardUi",$_,r(e)),a(e,"dashboardGameSceneTransition",eN,r(e)),e.isOpeningScreens=!1,e.openingScreens={},e.needToRunAnimationDashboard=!1,e.handleOpenScreen=function(t){var n=t.screenName;e.openingScreens[n]=!0,RN.includes(n)&&(e.dashboardUi.node.active=!1)},e.handleErrorOpenScreen=function(t){var n=t.screenName;n&&(e.openingScreens[n]=!1,!RN.includes(n))||(e.dashboardUi.node.active=!0)},e.handleCloseScreen=function(t){var n=t.screenName,i=t.screenData;RN.includes(n)&&!0!==(null==i?void 0:i.openNextScreenImmediately)&&(e.dashboardUi.node.active=!0)},e.handleClosedScreen=function(t){var n=t.screenData;!0!==(null==n?void 0:n.openNextScreenImmediately)&&(delete e.openingScreens[t.screenName],e.needToRunAnimationDashboard&&0===Object.keys(e.openingScreens).length&&(e.needToRunAnimationDashboard=!1,e.runAnimationOpenDashboard()))},e}return o(g,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"onLoad",value:function(){IN.on(AN.OPEN_SCREEN,this.handleOpenScreen),IN.on(AN.CLOSE_SCREEN,this.handleCloseScreen),IN.on(AN.CLOSED_SCREEN,this.handleClosedScreen),IN.on(_e.ERROR_OPEN_SCREEN,this.handleErrorOpenScreen),this.schedule(this.handleUpdate,1)}},{key:"onDestroy",value:function(){IN.off(AN.OPEN_SCREEN,this.handleOpenScreen),IN.off(AN.CLOSE_SCREEN,this.handleCloseScreen),IN.off(AN.CLOSED_SCREEN,this.handleClosedScreen),IN.off(_e.ERROR_OPEN_SCREEN,this.handleErrorOpenScreen),this.unschedule(this.handleUpdate)}},{key:"start",value:function(){var e=codex.player.getPlayerSetting("music");this.dashboardUi.node.active=!0,e&&Me.playMusic(),this.scheduleOnce(this.tryPreloadGameScene,1);var t=nt.getMaxLevel();nt.setLevel(t),this.updateGameEvents(),this.dashboardGameSceneTransition.runOpenSceneAnimation(),this.checkOpenSceneDataScreen()?(this.dashboardUi.showUI(),this.handleOpenSceneDataScreen(),this.needToRunAnimationDashboard=!0,"data"in this.node.scene.scene&&(this.node.scene.scene.data={screen:void 0,screenData:void 0})):this.checkOpenAnyScreen()?(this.dashboardUi.showUI(),this.runAnimationOpenDashboard()):this.dashboardUi.runShowAnimation()}},{key:"runAnimationOpenDashboard",value:(f=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOpeningScreens=!0,this.dashboardUi.setButtonsInteractable(!1),!this.checkOpenOfflineRewardScreen()){e.next=5;break}return e.next=5,this.checkAndClaimOfflineReward();case 5:if(!this.checkOpenTournamentRewardScreen()){e.next=8;break}return e.next=8,this.checkAndClaimTournamentReward();case 8:if(!this.checkOpenDailyRewardsScreen()){e.next=11;break}return e.next=11,QA.openPopupScreenAndWaitForClosed();case 11:if(!this.checkOpenJourneyScreen()){e.next=14;break}return e.next=14,this.checkAndClaimJourneyReward();case 14:this.dashboardUi.setButtonsInteractable(!0),this.isOpeningScreens=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"tryPreloadGameScene",value:function(){Tt.isSceneLoaded(St.GAME_SCENE)||Tt.preloadGameScene()}},{key:"handleUpdate",value:(d=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isOpeningScreens){e.next=2;break}return e.abrupt("return");case 2:if(!(Object.keys(this.openingScreens).length>0)){e.next=4;break}return e.abrupt("return");case 4:if(this.updateGameEvents(),this.checkOpenAnyScreen()){e.next=7;break}return e.abrupt("return");case 7:if(this.isOpeningScreens=!0,this.dashboardUi.setButtonsInteractable(!1),!this.checkOpenTournamentRewardScreen()){e.next=12;break}return e.next=12,this.checkAndClaimTournamentReward();case 12:if(!this.checkOpenJourneyScreen()){e.next=15;break}return e.next=15,this.checkAndClaimJourneyReward();case 15:this.isOpeningScreens=!1,this.dashboardUi.setButtonsInteractable(!0);case 17:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"updateGameEvents",value:function(){ft.updateData(),this.dashboardUi.updateTournamentButtonState()}},{key:"checkOpenAnyScreen",value:function(){return this.checkOpenTournamentRewardScreen()||this.checkOpenOfflineRewardScreen()||this.checkOpenDailyRewardsScreen()||this.checkOpenJourneyScreen()}},{key:"checkOpenTournamentRewardScreen",value:function(){return ft.isHasReward()}},{key:"checkOpenOfflineRewardScreen",value:function(){return iR.getCanClaimReward()}},{key:"checkOpenSceneDataScreen",value:function(){return!!Tt.getSceneData(this.node.scene).screen}},{key:"checkOpenDailyRewardsScreen",value:function(){return QA.getCanClaimReward()&&(pt.isScreenLoaded(Ue[Ge.DAILY_REWARD_SCREEN])||nt.getLevelStartTimes()>=3)}},{key:"checkOpenJourneyScreen",value:function(){return tt.canUpdateIncreaseSeason()}},{key:"handleOpenSceneDataScreen",value:(p=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Tt.getSceneData(this.node.scene),n=t.screen,i=t.screenData,e.abrupt("return",pt.openScreenAndWaitForClosed(n,v(v({},i),{},{source:St.DASHBOARD_SCENE})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"checkAndClaimTournamentReward",value:(h=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ft.getLastTournamentRankRewardQuantity(),n={items:[{item:lt.HINT,count:t},{item:lt.SHUFFLE,count:t}],watchAdsDoubleReward:!0,title:"LANTERN_CHALLENGE",description:"RANK_#V_REWARD",descriptionParams:[ft.getLastTournamentRankReward().toString()],successCallback:function(){},earnFrom:"TournamentRankReward"},ft.logTournamentRewarded(),ft.resetRewardData(),e.abrupt("return",pt.openScreenAndWaitForClosed(Ge.REWARD_SCREEN,n));case 5:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"checkAndClaimJourneyReward",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return tt.increaseSeason(),pt.showLoadingScreen(),this.openingScreens[Ge.JOURNEY_LEVEL_SCREEN]&&pt.closeScreen(Ge.JOURNEY_LEVEL_SCREEN),(t=[]).push(tt.loadJourneyButtonSpriteFrame()),e.next=7,Promise.all(t);case 7:return this.dashboardUi.updateJourneyButtonState(),pt.closeLoadingScreen(),e.abrupt("return",Promise.resolve(void 0));case 10:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"checkAndClaimOfflineReward",value:(u=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=iR.getRewards(),n={items:[{item:lt.HINT,count:t.HintItem},{item:lt.SHUFFLE,count:t.ShuffleItem},{item:lt.UNDO,count:t.UndoItem}],watchAdsDoubleReward:!1,title:"WELCOME_BACK",chestId:dN,successCallback:function(){iR.handleClaimReward()},earnFrom:"OfflineReward"},e.abrupt("return",pt.openScreenAndWaitForClosed(Ge.REWARD_SCREEN,n));case 3:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})}]),g}(k)).prototype,"dashboardUi",[Y_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eN=e(Q_.prototype,"dashboardGameSceneTransition",[J_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(Q_.prototype,"tryPreloadGameScene",[Z_],Object.getOwnPropertyDescriptor(Q_.prototype,"tryPreloadGameScene"),Q_.prototype),X_=Q_))||X_);g._RF.pop(),g._RF.push({},"ae0716AGTdOnLrs0rUWAPMP","DashboardBackground",void 0);var PN,_N,NN,ON,BN,DN,FN,MN=m.ccclass,zN=(m.property,Ludex),UN=zN.Utils.Decorator,GN=zN.Events,HN=Be.Layout,WN=Be.DesignSize,VN=codex.event,jN=(u(fN={},HN.Portrait,{width:1080,height:2520}),u(fN,HN.Landscape,{width:2732,height:1583}),fN);yN=MN("DashboardBackground"),vN=Re.required(),gN=Re.required(),mN=UN.debounce(100),yN(((CN=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"sprite",wN,r(e)),a(e,"uiTransform",kN,r(e)),e.handleSwitchScene=function(){VN.off(GN.SWITCH_SCENE,e.handleSwitchScene),e.removePortraitCurtain()},a(e,"handleViewResized",TN,r(e)),e}return o(h,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),Re.validateRequiredProperties(this),this.listenGameEvents()}},{key:"onLoad",value:function(){this.updateBackgroundSprite(),this.updateCurtain(),VN.on(GN.SWITCH_SCENE,this.handleSwitchScene)}},{key:"onDestroy",value:function(){VN.off(GN.SWITCH_SCENE,this.handleSwitchScene),x.off(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"updateBackgroundSprite",value:function(){var e=this;Oe.getCurrentBackground().then((function(t){t&&(e.setBackgroundSprite(t),e.updateSizeBackground())}))}},{key:"updateCurtain",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Oe.isLandscape()){e.next=3;break}return this.removePortraitCurtain(),e.abrupt("return");case 3:if(h.portraitCurtain){e.next=10;break}return e.next=6,Oe.getCurrentDashboardCurtain();case 6:if(t=e.sent){e.next=9;break}return e.abrupt("return");case 9:h.portraitCurtain=K(t);case 10:if(h.portraitCurtain){e.next=12;break}return e.abrupt("return");case 12:(n=h.portraitCurtain).active=!0,n.setParent(this.node),i=I.getVisibleSize(),a=i.height,r=Oe.getCurrentLayout(),o=jN[r].height,r===HN.Portrait&&(s=a<WN.Portrait.HEIGHT?0:a<o?(a-WN.Portrait.HEIGHT)/(o-WN.Portrait.HEIGHT)*160:160,n.setPosition(0,a-s,0));case 19:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"removePortraitCurtain",value:function(){h.portraitCurtain&&(h.portraitCurtain.removeFromParent(),h.portraitCurtain.active=!1)}},{key:"start",value:function(){this.handleViewResized()}},{key:"listenGameEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleViewResized)}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateSizeBackground",value:function(){if(this.sprite){var e=I.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=Oe.getCurrentLayout(),a=jN[i],r=a.width,o=a.height,s=t/r,l=n/o;if(i===HN.Portrait)this.uiTransform.setContentSize(t,Math.max(n,o)),this.node.setPosition(0,-n/2,0);else{var u=Math.max(s,l);this.uiTransform.setContentSize(Math.max(r,r*u),Math.max(o,o*u)),this.node.setPosition(0,-n/2,0)}}}}}]),h}(k)).portraitCurtain=null,wN=e((SN=CN).prototype,"sprite",[vN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kN=e(SN.prototype,"uiTransform",[gN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TN=e(SN.prototype,"handleViewResized",[mN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite(),e.updateCurtain()}}}),bN=SN));g._RF.pop(),g._RF.push({},"48793xDEIdGIIxZIn+SZThD","DailyQuestButton",void 0);var qN,KN=m.ccclass,YN=m.property;m.requireComponent,PN=KN("DailyQuestButton"),_N=YN(X),NN=YN(gh),PN((DN=e((BN=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"timeTextLabel",DN,r(e)),a(e,"timeTextLocalize",FN,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateButtonText()}},{key:"start",value:function(){this.schedule(this.updateButtonText,1)}},{key:"updateButtonText",value:function(){var e=new Date,t=new Date(e);t.setHours(24,0,0,0);var n=Number(t)-Number(e),i=Math.floor(n/36e5),a=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3);this.timeTextLocalize.key="timeHms",this.timeTextLocalize.setParams([i>=10?i.toString():"0".concat(i),a>=10?a.toString():"0".concat(a),r>=10?r.toString():"0".concat(r)])}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}}]),l}(k)).prototype,"timeTextLabel",[_N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FN=e(BN.prototype,"timeTextLocalize",[NN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ON=BN));g._RF.pop(),g._RF.push({},"f9a74iqHo9HRY7QwxlSDrwc","Header",void 0);var JN,ZN,XN,QN,$N;(0,m.ccclass)("Header")(qN=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"handleClickedOptions",value:function(){pt.openScreen(Ge.OPTIONS_SCREEN,{})}},{key:"handleClickedTheme",value:function(){pt.openScreen(Ge.THEME_SCREEN,{})}}]),r}(k));g._RF.pop(),g._RF.push({},"4952cFTdBhJgoOhDZuQi++k","DailyChallengeButton",void 0);var eO,tO,nO,iO,aO,rO,oO,sO,lO,uO=m.ccclass,cO=m.property;m.requireComponent,JN=uO("DailyChallengeButton"),ZN=cO(X),JN(($N=e((QN=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"dateText",$N,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateDateText()}},{key:"start",value:function(){}},{key:"updateDateText",value:function(){var e=(new Date).getDate();this.dateText.string=e<10?"0".concat(e):"".concat(e)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}}]),l}(k)).prototype,"dateText",[ZN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XN=QN));g._RF.pop(),g._RF.push({},"4a745W59XNFEoOicFjeYvNW","TourButton",void 0);var hO,pO,dO,fO,yO,vO=m.ccclass,gO=m.property;m.requireComponent,eO=vO("TourButton"),tO=gO(X),nO=gO(X),iO=gO(gh),eO((oO=e((rO=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"rankTextLabel",oO,r(e)),a(e,"timeTextLabel",sO,r(e)),a(e,"timeTextLocalize",lO,r(e)),e.currentRank=0,e}return o(h,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateButtonText()}},{key:"start",value:function(){this.schedule(this.updateButtonText,1),this.updateRankText()}},{key:"updateButtonText",value:function(){if(ft.inst.isPlayerJoined){this.rankTextLabel.node.active=!0;var e=ft.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}else this.rankTextLabel.node.active=!1,this.timeTextLocalize.key="join";this.currentRank!==ft.getTournamentRank()&&(this.updateRankText(),this.currentRank=ft.getTournamentRank())}},{key:"updateRankText",value:(u=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ft.getTournamentRank(),this.rankTextLabel.string=t>0?"#".concat(t):"#--";case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}}]),h}(k)).prototype,"rankTextLabel",[tO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sO=e(rO.prototype,"timeTextLabel",[nO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lO=e(rO.prototype,"timeTextLocalize",[iO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aO=rO));g._RF.pop(),g._RF.push({},"517fcvqZLRHQ5iZTchB0DL+","BlossomParticleSystem2DExtra",void 0);var mO,bO=m.ccclass,SO=m.property;bO("BlossomParticleSystem2DExtra")((dO=e((pO=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"maxSizeRandom",dO,r(e)),a(e,"minSizeRandom",fO,r(e)),a(e,"cycleDurationRandom",yO,r(e)),e}return o(l,[{key:"initParticle",value:function(e){e.maxSize=Y.randomRange(this.maxSizeRandom.x,this.maxSizeRandom.y)*e.size,e.minSize=Y.randomRange(this.minSizeRandom.x,this.minSizeRandom.y)*e.size,e.size=0,e.deltaSize=0,e.life=e.timeToLive,e.cycleDuration=Y.randomRange(this.cycleDurationRandom.x,this.cycleDurationRandom.y),e.cycleDuration=e.timeToLive/Math.floor(e.timeToLive/e.cycleDuration),this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Y.randomRange(-350,350),e.y=n+Y.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=e.life-e.timeToLive,n=1-t%e.cycleDuration/e.cycleDuration;t/e.cycleDuration<=e.life/e.cycleDuration?e.size=(e.maxSize-e.minSize)*Math.sin(n*Math.PI)+e.minSize:e.size=e.maxSize*Math.sin(n*Math.PI)}}]),l}(pE)).prototype,"maxSizeRandom",[SO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(.25,1)}}),fO=e(pO.prototype,"minSizeRandom",[SO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(0,.25)}}),yO=e(pO.prototype,"cycleDurationRandom",[SO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(.4,.6)}}),hO=pO));g._RF.pop(),g._RF.push({},"22d76GFn6BEoKFiZCFN1HmA","DraftScene",void 0);var wO,kO=m.ccclass,TO=m.disallowMultiple;kO("DraftScene")(mO=TO(mO=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"switchScene",value:function(){}}]),r}(k))||mO);g._RF.pop(),g._RF.push({},"27217ZS55VNqbq0d9w9Cc+3","Component",void 0);var CO,EO=m.ccclass,LO=m.executeInEditMode,xO=m.disallowMultiple,IO=Ludex.Events,AO=codex.event;EO("DraftComponent")(wO=xO(wO=LO(!0)(wO=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).locale="en",e.eventPayload={screenName:"DraftScene"},e}return o(r,[{key:"__preload",value:function(){console.log("DraftComponent",IO)}},{key:"onLoad",value:function(){console.log("DraftComponent",AO)}},{key:"start",value:function(){console.log("DraftComponent",Ke),this.makePersistent()}},{key:"makePersistent",value:function(){C.addPersistRootNode(this.node)}}]),r}(k))||wO)||wO);g._RF.pop(),g._RF.push({},"6adb6Vsx2BIsYfe4A3i4ArN","custom",void 0);(0,m.ccclass)("CustomSpine")(CO=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).spine=null,e.anims=null,e.customEnd=function(t){var n;console.log("CustomSpine customEnd",t);var i=null===(n=e.spine)||void 0===n?void 0:n.skeletonData;if(i){var a=i.getRuntimeData();a&&console.log("CustomSpine runtimeData",a)}},e}return o(r,[{key:"__preload",value:function(){var e,t;this.spine=null!==(e=this.node.getComponent(xe.Skeleton))&&void 0!==e?e:null,this.anims=null!==(t=this.node.getComponent(b))&&void 0!==t?t:null,Re.lazyValidateProperties(this)}},{key:"onLoad",value:function(){var e;console.log("CustomSpine onLoad",this.spine,this.anims),null===(e=this.anims)||void 0===e||e.play("custom")}},{key:"start",value:function(){}}]),r}(k));g._RF.pop(),g._RF.push({},"88f2b4WH6NBlaGD7WvCOA2j","VibrateUtils",void 0);var RO,PO,_O,NO,OO,BO,DO,FO=Ludex.Utils.Browser,MO=codex.player,zO=function(){function e(){i(this,e)}return o(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"addVibrationProfile",value:function(e,t){this.vibrationProfiles[e]=t}},{key:"vibrate",value:function(e){if(this.isVibrateEnable()){var t=this.vibrationProfiles[e];if(t||(console.warn("Vibration profile ".concat(e," not found. Using default profile.")),t=this.vibrationProfiles.default),!FO.vibrate(t)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}}},{key:"isVibrateEnable",value:function(){return!!MO.getPlayerSetting("vibrate")}}]),e}();zO.vibrationProfiles={default:[100]},g._RF.pop(),g._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var UO,GO,HO,WO,VO,jO,qO,KO=m.ccclass,YO=m.disallowMultiple,JO=m.property,ZO=codex,XO=ZO.audio,QO=(ZO.ads,Be.Layout),$O=Be.DesignSize.Portrait;RO=KO("GameScene"),PO=JO(nE),_O=JO(YR),RO(NO=YO((BO=e((OO=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"gameplay",BO,r(e)),a(e,"sceneTransition",DO,r(e)),e.background=null,e.handleGameMaskWhenLayoutChanged=function(e){var t=ne("Canvas/Game/GameObjects");if(t){var n=t.getComponent(Ie);n&&(n.enabled=e===QO.Landscape)}},e.handleAdsWhenResize=function(){e.checkBottomBannerAdSize(),e.setMaxSizeSideBannerAd()},e.attemptCallSubscribeBot=function(){"subscribeBotAsync"in GameSDK.extra&&GameSDK.extra.subscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))},e}return o(l,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){x.on(_e.VIEW_RESIZED,this.handleAdsWhenResize),x.on(_e.LAYOUT_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on($e.THEME_BACKGROUND_CHANGE,this.updateBackground,this)}},{key:"checkBottomBannerAdSize",value:function(){var e=I.getVisibleSize(),t=He.worldSizeToCssSize(e.height*It.MAX_BOTTOM_BANNER_RATIO);Ludex.Configs.Ads.BannerDisplayAdOptions.forEach((function(e){var n=e.PlacementId,i=e.Position,a=e.BannerHeight;"bottom"===i&&(a>t?je.hideBannerAd(n):je.showBannerAd(n))}))}},{key:"setMaxSizeSideBannerAd",value:function(){var e=GameSDK.extra;if("setSideBannerAdRemainSize"in e){var t=I.getVisibleSize(),n=$O.WIDTH+24,i=(t.width-n)/2,a=He.worldSizeToCssSize(i);e.setSideBannerAdRemainSize(a)}}},{key:"start",value:function(){this.scheduleOnce(this.attemptCallSubscribeBot,.5),codex.player.getPlayerSetting("music")&&Me.playMusic(),this.updateVolumeBackgroundMusic(),this.scheduleOnce(this.preloadScenes,2),this.addVibrationProfiles(),this.updateTheme(),this.sceneTransition.runOpenSceneAnimation()}},{key:"updateTheme",value:function(){this.updateBackground()}},{key:"updateBackground",value:function(){var e=this.background||this.getComponentInChildren(ei);this.background=e;var t=Ne.getCurrentBackgroundSprite();e.setBackgroundSprite(t)}},{key:"addVibrationProfiles",value:function(){zO.addVibrationProfile(dd,500)}},{key:"preloadScenes",value:function(){Tt.preloadDashboardScene(),Oe.loadCurrentBackground()}},{key:"updateVolumeBackgroundMusic",value:function(){XO.setVolume(1,"global_music")}}]),l}(k)).prototype,"gameplay",[PO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DO=e(OO.prototype,"sceneTransition",[_O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NO=OO))||NO);g._RF.pop(),g._RF.push({},"10856dEO59DzahZrXjZ7GV7","ExplosionParticleSystemExtra2D",void 0);var eB,tB,nB,iB,aB,rB,oB,sB,lB=m.ccclass,uB=m.property;UO=lB("ExplosionParticleSystem2DExtra"),GO=uB(w),HO=uB(w),UO((jO=e((VO=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"rectW",jO,r(e)),a(e,"rectH",qO,r(e)),e}return o(l,[{key:"initParticle",value:function(e){this.setInitPosition(e.pos,e.dir)}},{key:"setInitPosition",value:function(e,t){var n=this.rectW,i=this.rectH,a=Math.atan2(t.y,t.x),r=e.x,o=e.y;return e.x=r+Math.cos(a)*n/2,e.y=o+Math.sin(a)*i/2,e}},{key:"updateParticle",value:function(e,t){}}]),l}(pE)).prototype,"rectW",[GO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),qO=e(VO.prototype,"rectH",[HO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),WO=VO));g._RF.pop(),g._RF.push({},"7c115t9HKlH6ZfnhCnLAnpe","Star",void 0);var cB,hB,pB,dB,fB,yB,vB,gB,mB,bB,SB,wB=m.ccclass,kB=m.property,TB=m.requireComponent,CB=(eB=wB("Star"),tB=TB(b),nB=kB(k),iB=kB(b),eB(aB=tB((oB=e((rB=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"starAppearance",oB,r(e)),a(e,"animation",sB,r(e)),e.isAppear=!1,e.initialPosition=new F,e}return o(l,[{key:"onLoad",value:function(){this.initialPosition=this.node.position.clone(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"resetPosition",value:function(){this.node.setPosition(this.initialPosition)}},{key:"show",value:function(){this.starAppearance.node.active=!0,this.isAppear=!0}},{key:"hide",value:function(){this.starAppearance.node.active=!1,this.isAppear=!1}},{key:"playAnimation",value:function(){this.animation.stop();this.animation.clips.some((function(e){return!(!e||"UpAndDown"!==e.name)}))?this.animation.play("UpAndDown"):console.warn("SettingsScreen: clip not found")}},{key:"stopAnimation",value:function(){this.animation.stop()}}]),l}(k)).prototype,"starAppearance",[nB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sB=e(rB.prototype,"animation",[iB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aB=rB))||aB)||aB);g._RF.pop(),g._RF.push({},"09f0bRvi+1OQZiIGBFqdNzq","LevelProgressBar",void 0);var EB,LB=m.ccclass,xB=m.property;cB=LB("LevelProgressBar"),hB=xB(H),pB=xB(CB),dB=xB(CB),fB=xB(CB),cB((gB=e((vB=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"progressBar",gB,r(e)),a(e,"leftStar",mB,r(e)),a(e,"midStar",bB,r(e)),a(e,"rightStar",SB,r(e)),e.toProgress=1,e.progressStep=0,e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"start",value:function(){this.toProgress=1,this.progressStep=0,this.runStartsAnimation()}},{key:"update",value:function(){var e=this.progressBar.getComponent(E);e&&(this.progressBar.progress>=1?e.type=E.Type.SIMPLE:e.type=E.Type.TILED),this.progressBar.progress-this.progressStep<this.toProgress?this.progressBar.progress!==this.toProgress&&(this.progressBar.progress=this.toProgress):this.progressBar.progress-=this.progressStep}},{key:"runStartsAnimation",value:function(){this.leftStar.isAppear&&this.midStar.isAppear&&this.rightStar.isAppear||(this.leftStar.show(),this.midStar.show(),this.rightStar.show(),this.runStarAnimation(this.leftStar),this.runStarAnimation(this.midStar),this.runStarAnimation(this.rightStar))}},{key:"runStarAnimation",value:function(e){e.resetPosition(),e.playAnimation()}},{key:"stopStarAnimation",value:function(e){e.isAppear&&(e.hide(),e.stopAnimation(),e.resetPosition(),Me.playSound(ze.LOST_STAR_IN_GAMEPLAY))}},{key:"setProgress",value:function(e){this.toProgress=e/100,this.progressStep=(this.progressBar.progress-this.toProgress)/60*16}},{key:"setStars",value:function(e){switch(e){case 1:this.stopStarAnimation(this.rightStar),this.stopStarAnimation(this.midStar);break;case 2:this.stopStarAnimation(this.rightStar);break;default:this.runStartsAnimation()}}},{key:"reset",value:function(){this.progressBar.progress=1}}]),l}(k)).prototype,"progressBar",[hB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mB=e(vB.prototype,"leftStar",[pB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bB=e(vB.prototype,"midStar",[dB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SB=e(vB.prototype,"rightStar",[fB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yB=vB));g._RF.pop(),g._RF.push({},"2b2ebUm0nFD64V/fcD8RPF/","TestLayoutScene",void 0);var IB,AB,RB,PB,_B,NB=m.ccclass,OB=m.disallowMultiple;NB("TestLayoutScene")(EB=OB(EB=function(e){t(r,e);var a=n(r);function r(){var e;return i(this,r),(e=a.call(this)).handleLayoutChange=function(){pt.showNotificationScreen("Layout changed")},Tt.markIsTestScene(St.TEST_LAYOUT_SCENE),e}return o(r,[{key:"start",value:function(){this.isValid&&this.listenGameEvents()}},{key:"listenGameEvents",value:function(){x.on(_e.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"switchScene",value:function(){Tt.switchScene(St.DASHBOARD_SCENE)}}]),r}(k))||EB);g._RF.pop(),g._RF.push({},"c0a5fPghzxBxpXiudxt+Qd4","TestParticleSystemScene",void 0);var BB,DB=m.ccclass,FB=m.property;IB=DB("TestParticleSystemScene"),AB=FB(jA),IB((_B=e((PB=function(e){t(l,e);var s=n(l);function l(){var e;return i(this,l),e=s.call(this),a(e,"starParticleSystem",_B,r(e)),Tt.markIsTestScene(St.TEST_PARTICLE_SYSTEM_SCENE),e}return o(l,[{key:"start",value:function(){var e=this;this.isValid&&this.scheduleOnce((function(){e.starParticleSystem.play()}),1)}}]),l}(k)).prototype,"starParticleSystem",[AB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RB=PB));g._RF.pop(),g._RF.push({},"7dc71c6qMBI/ZZfA4rG4nFv","TestPerformanceScene",void 0);var MB,zB=m.ccclass,UB=m.disallowMultiple;zB("TestPerformanceScene")(BB=UB(BB=function(e){t(r,e);var a=n(r);function r(){var e;return i(this,r),e=a.call(this),Tt.markIsTestScene(St.TEST_PERFORMANCE_SCENE),e}return o(r,[{key:"start",value:function(){this.isValid&&this.listenEvents()}},{key:"listenEvents",value:function(){}}]),r}(k))||BB);g._RF.pop(),g._RF.push({},"0a4aeK2lAdAjq0xWi6SCbV+","TestScene",void 0);var GB,HB=m.ccclass,WB=m.disallowMultiple,VB=Ludex.Events,jB=codex.event;HB("TestScene")(MB=WB(MB=function(e){t(r,e);var a=n(r);function r(){var e;return i(this,r),e=a.call(this),Tt.markIsTestScene(St.TEST_SCENE),e}return o(r,[{key:"start",value:function(){this.isValid&&(this.listenScreenEvents(),pt.openScreen(Ge.LOADING_SCREEN,{duration:.5}))}},{key:"listenScreenEvents",value:function(){jB.once(VB.CLOSED_SCREEN,(function(e){e.screenName===Ue[Ge.LOADING_SCREEN]&&pt.openScreen(Ge.NOTIFICATION_SCREEN,{message:"Test screen events pass!",duration:2,isCloseButtonVisible:!1})}))}}]),r}(k))||MB);g._RF.pop(),g._RF.push({},"b16e7w74XVALY8Zco6TJYe7","AdsFlows",void 0);var qB,KB=m.ccclass,YB=Ludex.Plugins.Ads.Types;KB("AdsFlows")(GB=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"preloadAds",value:function(){je.preloadAds()}},{key:"checkServiceDegraded",value:function(){var e=je.isServiceDegraded();pt.showNotificationScreen("Service degraded: ".concat(e?"true":"false"))}},{key:"loadInterstitialAd",value:function(){je.preloadAdsByType(YB.INTERSTITIAL)}},{key:"loadRewardedVideoAd",value:function(){je.preloadAdsByType(YB.REWARDED_VIDEO)}},{key:"loadRewardedInterstitialAd",value:function(){je.preloadAdsByType(YB.REWARDED_INTERSTITIAL)}},{key:"showInterstitialAd",value:function(){je.showInterstitialAdAsync({contextType:"browse"})}},{key:"showRewardedVideoAd",value:function(){je.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0})}},{key:"showRewardedInterstitialAd",value:function(){je.showRewardedInterstitialAdAsync({contextType:"reward",forceLoad:!0})}},{key:"showBannerAd",value:function(){je.showBannerAds()}},{key:"hideBannerAd",value:function(){je.hideBannerAds()}},{key:"showAdsenseInterstitialAd",value:function(){je.showInterstitialAdAsync({adService:"adsense"})}},{key:"showAdsenseRewardedVideoAd",value:function(){je.showRewardVideoAdAsync({adService:"adsense",forceLoad:!0})}},{key:"showAdsenseRewardedInterstitialAd",value:function(){je.showRewardedInterstitialAdAsync({adService:"adsense",forceLoad:!0})}}]),r}(k));g._RF.pop(),g._RF.push({},"56a103phldKO7/xShKcD3bI","AnimationDemo",void 0);var JB;(0,m.ccclass)("AnimationDemo")(qB=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"onLoad",value:function(){}},{key:"switchToTestTransitionScene",value:function(){Tt.switchScene("TestTransitionScene")}}]),r}(k));g._RF.pop(),g._RF.push({},"a3b8adQtftPmKSSoumHWY1e","AudioDemo",void 0);var ZB,XB,QB,$B,eD,tD,nD,iD;(0,m.ccclass)("AudioDemo")(JB=function(e){t(r,e);var a=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).isMusicMute=!1,e.isSoundMute=!1,e.listSounds=[],e}return o(r,[{key:"onLoad",value:function(){var e,t;this.musicComp=null===(e=ne("Music"))||void 0===e?void 0:e.getComponent(Sn),this.soundComp=null===(t=ne("Sound"))||void 0===t?void 0:t.getComponent(On),this.validateRequiredComponents(),this.listSounds=[ze.BG_MUSIC,ze.BUTTON_CLICK,ze.HAND_CLAP,ze.LEVEL_FAIL,ze.LEVEL_PASS,ze.LOST_STAR_IN_GAMEPLAY,ze.RAISE_STAR,ze.SPAWN_COINS,ze.STAR_RAISE,ze.TOUCH_START]}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"playBackgroundMusic",value:function(){this.musicComp.play(ze.BG_MUSIC)}},{key:"pauseBackgroundMusic",value:function(){this.musicComp.pause(ze.BG_MUSIC)}},{key:"stopBackgroundMusic",value:function(){this.musicComp.stop(ze.BG_MUSIC)}},{key:"randomMusicChannelVolume",value:function(){var e=Math.random();this.musicComp.setVolume(e)}},{key:"toggleMuteMusicChannel",value:function(){this.isMusicMute?(this.musicComp.mute(!1),this.isMusicMute=!1):(this.musicComp.mute(!0),this.isMusicMute=!0)}},{key:"playRandomSound",value:function(){var e=Math.floor(Math.random()*this.listSounds.length),t=this.listSounds[e];t&&this.soundComp.play(t)}},{key:"toggleMuteSoundChannel",value:function(){this.isSoundMute?(this.soundComp.mute(!1),this.isSoundMute=!1):(this.soundComp.mute(!0),this.isSoundMute=!0)}},{key:"randomSoundChannelVolume",value:function(){var e=Math.random();this.soundComp.setVolume(e)}}]),r}(k));g._RF.pop(),g._RF.push({},"9e6b330nHBK2oNz8N9/lpDx","FlowChallenge",void 0);var aD,rD,oD,sD,lD,uD=m.ccclass,cD=Ludex.Utils,hD=cD.Decorator,pD=cD.String,dD=cD.Number,fD=codex,yD=fD.match,vD=fD.player,gD=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};ZB=uD("FlowChallenge"),XB=hD.tryCatch(gD),QB=hD.tryCatch(gD),$B=hD.tryCatch(gD),eD=hD.tryCatch(gD),tD=hD.tryCatch(gD),ZB((e((iD=function(e){t(d,e);var a,r,u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=p.call.apply(p,[this].concat(n))).playerId="",e.matchId="",e.contextId="",e.opponentId="",e}return o(d,[{key:"onLoad",value:function(){this.playerId=vD.getPlayerId(),this.matchId=pD.generateObjectId(),this.contextId=pD.generateObjectId(),this.opponentId=pD.generateObjectId()}},{key:"inviteFriends",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,yD.challenge.invite.processAsync({playerId:this.playerId,extraData:{rescued:0}});case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"challengeFriend",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={playerId:this.playerId,opponentId:this.opponentId},pt.showLoadingScreen(0),e.next=4,yD.challenge.friend.processAsync(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"joinChallenge",value:(u=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=yD.getMatchState(),i={playerId:this.playerId,contextId:pD.generateObjectId(),matchId:null!==(t=n.id)&&void 0!==t?t:this.matchId,opponentId:this.opponentId},pt.showLoadingScreen(0),e.next=5,yD.challenge.join.processAsync(i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"continueChallenge",value:(r=s(l().mark((function e(){var t,n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=yD.getMatchState(),i={playerId:this.playerId,matchId:null!==(t=n.id)&&void 0!==t?t:this.matchId,contextId:this.contextId,opponentId:this.opponentId},pt.showLoadingScreen(0),e.next=5,yD.challenge.continue.processAsync(i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"finishChallenge",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,yD.challenge.finish.processAsync({playerId:this.playerId,playerScore:dD.random(99999)});case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),d}(k)).prototype,"inviteFriends",[XB],Object.getOwnPropertyDescriptor(iD.prototype,"inviteFriends"),iD.prototype),e(iD.prototype,"challengeFriend",[QB],Object.getOwnPropertyDescriptor(iD.prototype,"challengeFriend"),iD.prototype),e(iD.prototype,"joinChallenge",[$B],Object.getOwnPropertyDescriptor(iD.prototype,"joinChallenge"),iD.prototype),e(iD.prototype,"continueChallenge",[eD],Object.getOwnPropertyDescriptor(iD.prototype,"continueChallenge"),iD.prototype),e(iD.prototype,"finishChallenge",[tD],Object.getOwnPropertyDescriptor(iD.prototype,"finishChallenge"),iD.prototype),nD=iD));g._RF.pop(),g._RF.push({},"f3decJ3ZlRLt6CDMHpl1XCe","FlowContext",void 0);var mD,bD,SD,wD,kD,TD,CD=m.ccclass,ED=Ludex.Utils.Decorator,LD=codex,xD=LD.match,ID=LD.player,AD=LD.context,RD=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};aD=CD("FlowContext"),rD=ED.tryCatch(RD),oD=ED.tryCatch(RD),aD((e((lD=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).playerId="",e.changeContext=function(){var e=s(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return AD.receiveContext(t,n,i),e.next=3,AD.detectContextSessionType();case 3:AD.detectContextGameMode();case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),e}return o(c,[{key:"onLoad",value:function(){this.playerId=ID.getPlayerId()}},{key:"chooseFriends",value:(r=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.parse(n),pt.showLoadingScreen(0),e.next=4,xD.context.choose.processAsync(v(v({},i),{},{playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"processContextData",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,AD.processContextData();case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"setSingleContext",value:function(){this.changeContext("","SOLO",{})}},{key:"setTournamentContext",value:function(){this.changeUrl("/?context_source_id=123&context_type=GENERIC&tournament=true"),this.changeContext("mocked-context-id-tournament","THREAD",{})}},{key:"setShareInviteContext",value:function(){var e={type:AD.getSessionContextTypes().SHARE_INVITE,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-share-invite","THREAD",e)}},{key:"setMatchingGroupContext",value:function(){var e={type:AD.getSessionContextTypes().MATCHING_GROUP,playerId:"4766619483409000",playerName:"Player",playerPhoto:"",playerScore:100};this.changeContext("mocked-context-id-matching-group","GROUP",e)}},{key:"setChallengeFriendContext",value:function(){var e={type:AD.getSessionContextTypes().CHALLENGE_FRIEND,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-challenge-friend","THREAD",e)}},{key:"changeUrl",value:function(e){window.history.pushState({},"",e)}}]),c}(k)).prototype,"chooseFriends",[rD],Object.getOwnPropertyDescriptor(lD.prototype,"chooseFriends"),lD.prototype),e(lD.prototype,"processContextData",[oD],Object.getOwnPropertyDescriptor(lD.prototype,"processContextData"),lD.prototype),sD=lD));g._RF.pop(),g._RF.push({},"36562c8k/RF2p/1aLUWFaf8","FlowGroup",void 0);var PD,_D,ND,OD,BD,DD=m.ccclass,FD=Ludex.Utils.Decorator,MD=codex,zD=MD.match,UD=MD.player,GD=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};mD=DD("FlowGroup"),bD=FD.tryCatch(GD),SD=FD.tryCatch(GD),wD=FD.tryCatch(GD),mD((e((TD=function(e){t(h,e);var a,r,u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=c.call.apply(c,[this].concat(n))).playerId="",e}return o(h,[{key:"onLoad",value:function(){this.playerId=UD.getPlayerId()}},{key:"startGroup",value:(u=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.parse(n),pt.showLoadingScreen(0),e.next=4,zD.group.start.processAsync(v(v({},i),{},{matchTag:"test",playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"joinGroup",value:(r=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.parse(n),pt.showLoadingScreen(0),e.next=4,zD.group.join.processAsync(v(v({},i),{},{playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"finishGroup",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),UD.setPlayerDataByName("score",Math.floor(2*Math.random())),e.next=4,zD.group.finish.processAsync();case 4:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})}]),h}(k)).prototype,"startGroup",[bD],Object.getOwnPropertyDescriptor(TD.prototype,"startGroup"),TD.prototype),e(TD.prototype,"joinGroup",[SD],Object.getOwnPropertyDescriptor(TD.prototype,"joinGroup"),TD.prototype),e(TD.prototype,"finishGroup",[wD],Object.getOwnPropertyDescriptor(TD.prototype,"finishGroup"),TD.prototype),kD=TD));g._RF.pop(),g._RF.push({},"46e6dOzDGJMa48+tVKTAEIT","FlowSingle",void 0);var HD,WD,VD,jD,qD,KD=m.ccclass,YD=Ludex.Utils,JD=YD.Decorator,ZD=YD.Number,XD=codex,QD=XD.match,$D=XD.player,eF=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};PD=KD("FlowSingle"),_D=JD.tryCatch(eF),ND=JD.tryCatch(eF),PD((e((BD=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).playerId="",e}return o(c,[{key:"onLoad",value:function(){this.playerId=$D.getPlayerId()}},{key:"startSingle",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,QD.single.start.processAsync({playerId:this.playerId});case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"finishSingle",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $D.setPlayerDataByName("score",ZD.random(1e3)),e.next=3,QD.single.finish.processAsync();case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})}]),c}(k)).prototype,"startSingle",[_D],Object.getOwnPropertyDescriptor(BD.prototype,"startSingle"),BD.prototype),e(BD.prototype,"finishSingle",[ND],Object.getOwnPropertyDescriptor(BD.prototype,"finishSingle"),BD.prototype),OD=BD));g._RF.pop(),g._RF.push({},"e2458xYf5xBG6uFEvkD4R6s","FlowStratery",void 0);var tF,nF,iF,aF,rF,oF,sF,lF,uF,cF,hF,pF=m.ccclass,dF=Ludex,fF=dF.Utils,yF=fF.Decorator,vF=fF.String,gF=fF.Number,mF=dF.Dtos.Match.CustomData,bF=codex,SF=bF.match,wF=bF.player,kF=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};HD=pF("FlowStrategy"),WD=yF.tryCatch(kF),VD=yF.tryCatch(kF),HD((e((qD=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).playerId="",e}return o(c,[{key:"onLoad",value:function(){this.playerId=wF.getPlayerId(),this.initDtosDefaultData()}},{key:"initDtosDefaultData",value:function(){mF.addDefaultData({maxTime:0}),mF.addValidateFunction("maxTime",(function(e){if(e<0)throw new Error("maxTime must be greater than 0")}))}},{key:"startStrategy",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,SF.strategy.start.processAsync({matchId:vF.generateObjectId(),gameMode:"endless",playerId:this.playerId});case 3:return e.next=5,SF.handler.setMatchCustomData({maxTime:600});case 5:return e.next=7,SF.handler.setProfileData({id:this.playerId,wish:0});case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"finishStrategy",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,SF.handler.setProfileData({id:this.playerId,wish:gF.random(9999)});case 2:return e.next=4,SF.strategy.finish.processAsync({setPlayerBestScore:!1,postGlobalLeaderboard:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),c}(k)).prototype,"startStrategy",[WD],Object.getOwnPropertyDescriptor(qD.prototype,"startStrategy"),qD.prototype),e(qD.prototype,"finishStrategy",[VD],Object.getOwnPropertyDescriptor(qD.prototype,"finishStrategy"),qD.prototype),jD=qD));g._RF.pop(),g._RF.push({},"943b1Zkv9BAaZVhinus8Bkv","FlowTournament",void 0);var TF,CF=m.ccclass,EF=Ludex.Utils.Decorator,LF=codex,xF=LF.match,IF=LF.player,AF=function(e){pt.closeLoadingScreen(),e instanceof Error&&pt.showNotificationScreen(e.message)};tF=CF("FlowTournament"),nF=EF.tryCatch(AF),iF=EF.tryCatch(AF),aF=EF.tryCatch(AF),rF=EF.tryCatch(AF),oF=EF.tryCatch(AF),sF=EF.tryCatch(AF),lF=EF.tryCatch(AF),uF=EF.tryCatch(AF),tF((e((hF=function(e){t(v,e);var a,r,u,c,h,p,d,f,y=n(v);function v(){var e;i(this,v);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=y.call.apply(y,[this].concat(n))).playerId="",e}return o(v,[{key:"onLoad",value:function(){this.playerId=IF.getPlayerId()}},{key:"joinTournament",value:(f=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:return t=e.sent,n=t.getID().toString(),e.next=7,xF.tournament.join.processAsync({tournamentId:n,playerId:this.playerId});case 7:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"continueTournament",value:(d=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:return t=e.sent,n=t.getContextID(),e.next=7,xF.tournament.continue.processAsync({contextId:n,playerId:this.playerId});case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"finishTournament",value:(p=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),t=Math.floor(2*Math.random()),IF.setPlayerDataByName("score",t),e.next=5,xF.tournament.finish.processAsync({playerId:this.playerId,bestScore:t});case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"createTournament",value:(h=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),t=Ludex.Utils.String.generateObjectId(),e.next=4,GameSDK.tournament.createAsync({initialScore:0,config:{title:"Tournament title",tournamentTitle:"Tournament title"},data:{playerId:this.playerId,playerName:"playerName",leaderboardId:t}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"postScoreTournament",value:(c=s(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Number(t.string),console.warn("score",n),pt.showLoadingScreen(0),e.next=5,GameSDK.tournament.postScoreAsync(n);case 5:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"shareTournament",value:(u=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.parse(n),pt.showLoadingScreen(0),console.warn("payload",i),e.next=5,GameSDK.tournament.shareAsync(i);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})},{key:"getTournamentsAsync",value:(r=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pt.showLoadingScreen(0),t=GameSDK.tournament.getTournamentsAsync(),console.warn(t);case 3:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getTournamentAsync",value:(a=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:t=e.sent,console.warn(t);case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})}]),v}(k)).prototype,"joinTournament",[nF],Object.getOwnPropertyDescriptor(hF.prototype,"joinTournament"),hF.prototype),e(hF.prototype,"continueTournament",[iF],Object.getOwnPropertyDescriptor(hF.prototype,"continueTournament"),hF.prototype),e(hF.prototype,"finishTournament",[aF],Object.getOwnPropertyDescriptor(hF.prototype,"finishTournament"),hF.prototype),e(hF.prototype,"createTournament",[rF],Object.getOwnPropertyDescriptor(hF.prototype,"createTournament"),hF.prototype),e(hF.prototype,"postScoreTournament",[oF],Object.getOwnPropertyDescriptor(hF.prototype,"postScoreTournament"),hF.prototype),e(hF.prototype,"shareTournament",[sF],Object.getOwnPropertyDescriptor(hF.prototype,"shareTournament"),hF.prototype),e(hF.prototype,"getTournamentsAsync",[lF],Object.getOwnPropertyDescriptor(hF.prototype,"getTournamentsAsync"),hF.prototype),e(hF.prototype,"getTournamentAsync",[uF],Object.getOwnPropertyDescriptor(hF.prototype,"getTournamentAsync"),hF.prototype),cF=hF));g._RF.pop(),g._RF.push({},"d78a7DHN+5P/YjKftUFEZcU","JavaAds",void 0);var RF;(0,m.ccclass)("JavaAds")(TF=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"__preload",value:function(){this.setupAds()}},{key:"setupAds",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),r}(k));g._RF.pop(),g._RF.push({},"e8e10DJmXdH8Jw30JCMjJqd","ScreensFlows",void 0);var PF;(0,m.ccclass)("ScreensFlows")(RF=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).screenActions=[function(){return e.showLoadingScreen()},function(){return e.showNotificationScreen()},function(){return e.showWinningScreen()},function(){return e.showLoseScreen()},function(){return e.showSettingsScreen()}],e}return o(c,[{key:"preloadScreens",value:function(){pt.preloadScreens()}},{key:"getRandomDelay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return Math.floor(Math.random()*(t-e+1))+e}},{key:"executeRandomScreenAction",value:(r=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Math.floor(Math.random()*this.screenActions.length),n=this.screenActions[t]){e.next=5;break}return console.warn("No screen action found at index:",t),e.abrupt("return");case 5:n();case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"spamScreens",value:(a=s(l().mark((function e(){var t,n,i,a=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=10,console.info(" Start spamming screens..."),n=l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.getRandomDelay(200,800),console.debug(" Spamming screen ".concat(i+1,"/").concat(t)),e.next=4,new Promise((function(e){return setTimeout(e,n)}));case 4:return e.next=6,a.executeRandomScreenAction();case 6:case"end":return e.stop()}}),e)})),i=0;case 4:if(!(i<t)){e.next=9;break}return e.delegateYield(n(),"t0",6);case 6:i++,e.next=4;break;case 9:console.info(" Finished spamming screens");case 10:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"showNotificationScreen",value:function(){pt.showNotificationScreen("Hey!")}},{key:"closeNotificationScreen",value:function(){pt.closeNotificationScreen()}},{key:"showLoadingScreen",value:function(){pt.showLoadingScreen(5)}},{key:"closeLoadingScreen",value:function(){pt.closeLoadingScreen()}},{key:"showWinningScreen",value:function(){pt.openScreen(Ge.WINNING_SCREEN)}},{key:"closeWinningScreen",value:function(){pt.closeScreen(Ge.WINNING_SCREEN)}},{key:"showLoseScreen",value:function(){pt.openScreen(Ge.LOSE_SCREEN,{level:1})}},{key:"closeLoseScreen",value:function(){pt.closeScreen(Ge.LOSE_SCREEN)}},{key:"showSettingsScreen",value:function(){pt.openScreen(Ge.SETTINGS_SCREEN)}},{key:"closeSettingsScreen",value:function(){pt.closeScreen(Ge.SETTINGS_SCREEN)}},{key:"showCongratulationScreen",value:function(){pt.openScreen(Ge.CONGRATULATION_SCREEN)}},{key:"closeCongratulationScreen",value:function(){pt.closeScreen(Ge.CONGRATULATION_SCREEN)}}]),c}(k));g._RF.pop(),g._RF.push({},"abf91gNohBK7arKnziqu2PF","AnimationDemo2",void 0);var _F,NF,OF,BF,DF,FF;(0,m.ccclass)("AnimationDemo2")(PF=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"onLoad",value:function(){}},{key:"switchToTestScene",value:function(){Tt.switchScene("TestScene")}}]),r}(k));g._RF.pop(),g._RF.push({},"56b92F9LoxNs5aCgvw+tkq6","LoadingSceneTransition",void 0);var MF,zF,UF,GF,HF,WF,VF,jF,qF,KF=m.ccclass,YF=m.requireComponent,JF=m.property;_F=KF("LoadingSceneTransition"),NF=YF([Ae]),OF=JF([A]),_F(BF=NF((FF=e((DF=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"targets",FF,r(e)),e.realTargets=[],e}return o(l,[{key:"start",value:function(){for(var e=this,t=0;t<this.targets.length;t++){var n=this.targets[t];if(n){var i=K(n);i.setParent(this.node),i.active=!1,this.realTargets.push(i)}}C.addPersistRootNode(this.node),C.once(Q.EVENT_BEFORE_SCENE_LAUNCH,(function(){e.playFadeOutAnimationClip()}))}},{key:"playFadeOutAnimationClip",value:function(){var e=this,t=0;if(this.realTargets&&0!==this.realTargets.length){var n,i=d(this.realTargets);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.active=!0;var r=a.getComponent(b);if(r)r.clips.some((function(e){return"FadeOut"===(null==e?void 0:e.name)}))?(r.play("FadeOut"),r.once(b.EventType.FINISHED,(function(){++t===e.realTargets.length&&e.node.destroy()}))):(this.node.destroy(),console.warn("Not have FadeOut clip"))}}catch(e){i.e(e)}finally{i.f()}}}}]),l}(k)).prototype,"targets",[OF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),BF=DF))||BF);g._RF.pop(),g._RF.push({},"13fe0ouBiBIBZF8ZbrGZnR9","BadgeExplosion",void 0);var ZF,XF,QF,$F,eM,tM,nM,iM,aM,rM,oM,sM,lM,uM,cM,hM,pM,dM,fM,yM,vM=m.ccclass,gM=m.property,mM=Ludex.Utils.Time,bM=(MF=vM("BadgeExplosion"),zF=gM(P),UF=gM(P),GF=gM(P),MF((VF=e((WF=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"aura1",VF,r(e)),a(e,"aura2",jF,r(e)),a(e,"aura3",qF,r(e)),e}return o(h,[{key:"onLoad",value:function(){this.aura1.opacity=0,this.aura2.opacity=0,this.aura1.node.setScale(new F(0,0,1)),this.aura2.node.setScale(new F(0,0,1)),this.particaleSystem=this.node.getComponentsInChildren(ee)}},{key:"runAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,f,y,v,g=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=mM.sleepAsync(500),n=mM.sleepAsync(0).then((function(){var e,t=d(g.particaleSystem);try{for(t.s();!(e=t.n()).done;)e.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}})),i=B(this.aura1.node).set({scale:new F(0,0,0)}).delay(0).to(.8,{scale:new F(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new F(1,1,1)},{easing:"cubicIn"}),a=B(this.aura1).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),r=B(this.aura2.node).set({scale:new F(0,0,0)}).delay(0).to(.8,{scale:new F(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new F(1,1,1)},{easing:"cubicIn"}),o=B(this.aura2).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),s=B(this.aura3).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),u=B(this.aura3.node).set({scale:new F(0,0,0)}).delay(0).to(.8,{scale:new F(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new F(1,1,1)},{easing:"cubicIn"}),c=Ve.runTweenAsync(i),h=Ve.runTweenAsync(a),p=Ve.runTweenAsync(r),f=Ve.runTweenAsync(o),y=Ve.runTweenAsync(s),v=Ve.runTweenAsync(u),e.next=18,Promise.all([t,c,h,p,f,y,v,n]);case 18:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"aura1",[zF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jF=e(WF.prototype,"aura2",[UF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qF=e(WF.prototype,"aura3",[GF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HF=WF))||HF);g._RF.pop(),g._RF.push({},"0c0ade09iBA/4Gh86gEKE7V","BadgeRewardScreen",void 0);var SM,wM,kM,TM,CM,EM,LM,xM,IM,AM=m.ccclass,RM=m.disallowMultiple,PM=m.requireComponent,_M=m.property,NM=Ludex.Events,OM=codex.event;ZF=AM("BadgeRewardScreen"),XF=PM(Si),QF=_M(E),$F=_M(P),eM=_M(bM),tM=_M(N),nM=_M(P),iM=_M(A),aM=_M(A),rM=_M(X),ZF(oM=RM(oM=XF((lM=e((sM=function(e){t(v,e);var u,c,h,p,d,f,y=n(v);function v(){var e;i(this,v);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=y.call.apply(y,[this].concat(n)),a(e,"badgeSprite",lM,r(e)),a(e,"badgeClaimOpacity",uM,r(e)),a(e,"badgeExplosion",cM,r(e)),a(e,"collectButtonComponent",hM,r(e)),a(e,"collectButtonOpacity",pM,r(e)),a(e,"badgeButtonPosition",dM,r(e)),a(e,"glowNode",fM,r(e)),a(e,"dateText",yM,r(e)),e.isReward=!1,e.badgeKey="",e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("BadgeRewardScreen: screen not found");e.validateEventPayload(t)&&(e.enabled=!0,e.badgeClaimOpacity.node.active=!1,e.badgeClaimOpacity.opacity=255,e.badgeButtonPosition.active=!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1)},e}return o(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){OM.on(NM.OPENING_SCREEN,this.handleOpeningScreen),OM.on(NM.OPENED_SCREEN,this.handleOpenedScreen),OM.on(NM.CLOSING_SCREEN,this.handleClosingScreen),OM.on(NM.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){OM.off(NM.OPENING_SCREEN,this.handleOpeningScreen),OM.off(NM.OPENED_SCREEN,this.handleOpenedScreen),OM.off(NM.CLOSING_SCREEN,this.handleClosingScreen),OM.off(NM.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled){var e=this.screen.data.customData||{},t=e.theme,n=e.key,i=e.date,a=e.isReward;this.isReward=!0===a,this.badgeKey=n,a?this.runRewardAnimation({theme:t,key:n}):(this.updateBadgeData({theme:t,key:n,date:i}),this.collectButtonOpacity.opacity=255,this.collectButtonComponent.interactable=!0)}}},{key:"close",value:function(){pt.closeScreen(Ge.BADGE_REWARD_SCREEN)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"handleCollectButton",value:function(){this.isReward?this.collectReward():this.close()}},{key:"updateBadgeData",value:function(e){var t=e.theme,n=e.key,i=e.date;this.badgeSprite.spriteFrame=tt.getJourneyBadgeSpriteFrame(n,t),this.badgeSprite.node.setScale(1.5,1.5),this.dateText.node.active=!0,this.dateText.string=i}},{key:"runRewardAnimation",value:(f=s(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.badgeSprite){e.next=3;break}return console.warn("No badge sprite found for animation"),e.abrupt("return");case 3:return n=t.theme,i=t.key,a=tt.getJourneyBadgeSpriteFrame(i,n),this.dateText.node.active=!1,this.badgeSprite.spriteFrame=a,this.badgeSprite.node.setScale(1,1),this.collectButtonComponent.interactable=!1,this.collectButtonOpacity.opacity=0,this.badgeExplosion.runAnimation(),e.next=13,this.runBadgeAnimation();case 13:return e.next=15,this.runCollectButtonAnimation();case 15:this.collectButtonComponent.interactable=!0;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"runBadgeAnimation",value:(d=s(l().mark((function e(){var t,n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.badgeSprite.node.scale=new F(1.6,1.6,0),t=B(this.badgeSprite.node).to(.5,{scale:new F(1,1,0)},{easing:"backOut"}),e.next=4,Promise.all([Ve.runTweenAsync(t)]).then((function(){n.badgeSprite.node.scale=new F(1,1,0)}));case 4:this.startGlowAnimation();case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"startGlowAnimation",value:function(){this.glowNode.active=!0,this.glowNode.setScale(new F(1,1,0)),this.glowTween?this.glowTween.start():this.glowTween=B(this.glowNode).by(6,{angle:360},{easing:"linear"}).repeatForever().start()}},{key:"stopGlowAnimation",value:function(){this.glowTween.stop(),this.glowNode.active=!1}},{key:"runCollectButtonAnimation",value:(p=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=B(this.collectButtonOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),e.next=3,Ve.runTweenAsync(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"collectReward",value:function(){var e=this;tt.logJourneyGetBadge(this.badgeKey),this.runCollectAnimation().then((function(){e.close()}))}},{key:"runCollectAnimation",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.collectButtonComponent.interactable=!1,this.collectButtonOpacity.opacity=0,e.next=4,this.runBadgeShrinkAnimation();case 4:return e.next=6,this.runBadgeClaimAnimation();case 6:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"runBadgeShrinkAnimation",value:(c=s(l().mark((function e(){var t,n,i,a=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=B(this.badgeSprite.node).to(.5,{scale:new F(0,0,0)},{easing:"backIn"}),n=B(this.glowNode).to(.3,{scale:new F(0,0,0)},{easing:"backIn",onComplete:function(){a.stopGlowAnimation()}}),e.next=4,Promise.all([Ve.runTweenAsync(t),Ve.runTweenAsync(n)]);case 4:return this.badgeClaimOpacity.node.active=!0,i=B(this.badgeClaimOpacity.node).set({scale:new F(0,0,0)}).to(.5,{scale:new F(.6,.6,0)},{easing:"cubicOut"}),e.next=8,Ve.runTweenAsync(i);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runBadgeClaimAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:1.5,this.badgeButtonPosition.active=!0,n=B(this.badgeClaimOpacity.node).to(t,{worldPositionX:this.badgeButtonPosition.worldPosition.x},{easing:"sineIn"}),i=B(this.badgeClaimOpacity.node).to(t,{worldPositionY:this.badgeButtonPosition.worldPosition.y},{easing:"sineOut"}),a=B(this.badgeClaimOpacity.node).to(t,{scale:new F(.3,.3,0)},{easing:"sineInOut"}),r=B(this.badgeClaimOpacity).to(t,{opacity:128},{easing:"cubicInOut"}),e.next=8,Promise.all([Ve.runTweenAsync(n),Ve.runTweenAsync(i),Ve.runTweenAsync(a),Ve.runTweenAsync(r)]);case 8:this.badgeClaimOpacity.node.active=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),v}(k)).prototype,"badgeSprite",[QF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uM=e(sM.prototype,"badgeClaimOpacity",[$F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cM=e(sM.prototype,"badgeExplosion",[eM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hM=e(sM.prototype,"collectButtonComponent",[tM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pM=e(sM.prototype,"collectButtonOpacity",[nM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dM=e(sM.prototype,"badgeButtonPosition",[iM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fM=e(sM.prototype,"glowNode",[aM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yM=e(sM.prototype,"dateText",[rM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oM=sM))||oM)||oM);g._RF.pop(),g._RF.push({},"9e3d0oIxtFNPrQeHM4VUq0v","Badge",void 0);var BM,DM,FM,MM,zM,UM=m.ccclass,GM=m.property,HM=(SM=UM("Badge"),wM=GM(X),kM=GM(E),TM=GM(N),SM((LM=e((EM=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"monthText",LM,r(e)),a(e,"badgeIcon",xM,r(e)),a(e,"badgeButton",IM,r(e)),e.canClick=!1,e.disableInteraction=function(){},e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"setData",value:function(e,t,n){if(e<1||e>12)return console.warn("Invalid month: ".concat(e,". Month should be between 1 and 12.")),void(this.monthText.string="Invalid Month");if(this.month=e,this.year=t,this.monthText.string=["None","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e],n){this.badgeIcon.node.active=!0;var i=mt.getBadgeSpriteFrame({month:e,year:t});if(i){this.badgeIcon.spriteFrame=i;var a=cd.DailyBadgeOffset[e];a&&this.badgeIcon.node.setPosition(new F(a.x,a.y,0))}this.badgeButton.node.name="BadgeButton-".concat(e,"-").concat(t)}else this.badgeIcon.node.active=!1}},{key:"handleClickBadge",value:function(){if(this.canClick){var e={day:1,month:this.month,year:this.year};this.disableInteraction(),pt.closeScreen(Ge.BADGES_SCREEN,{openNextScreenImmediately:!0}),pt.openScreen(Ge.DAILY_CHALLENGE_SCREEN,{customData:e,preloadCallback:mt.isNeedLoadDailyChallenge(e)?function(){return mt.loadingTextureBeforeOpenDailyChallenge(e)}:void 0})}}}]),l}(k)).prototype,"monthText",[wM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xM=e(EM.prototype,"badgeIcon",[kM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IM=e(EM.prototype,"badgeButton",[TM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CM=EM))||CM);g._RF.pop(),g._RF.push({},"340d33fSuRJiYZnXoULu9+7","BadgeShelf",void 0);var WM,VM,jM,qM,KM,YM=m.ccclass,JM=m.property,ZM=(BM=YM("BadgeShelf"),DM=JM(HM),BM((zM=e((MM=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"badges",zM,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updateShelf",value:function(e){var t,n=d(this.badges);try{for(n.s();!(t=n.n()).done;){t.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}for(var i=0;i<e.length;i++){var a=this.badges[i];a.node.active=!0,a.setData(e[i].month,e[i].year,e[i].badge)}}}]),l}(k)).prototype,"badges",[DM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),FM=MM))||FM);g._RF.pop(),g._RF.push({},"3144cy6l9hKvaQ6zP0zdxAK","JourneyBadge",void 0);var XM,QM,$M,ez,tz,nz,iz,az,rz,oz=m.ccclass,sz=m.property,lz=(WM=oz("JourneyBadge"),VM=sz(N),WM((KM=e((qM=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"badgeButton",KM,r(e)),e.canClick=!1,e.disableInteraction=function(){},e.isInit=!1,e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.init()}},{key:"init",value:function(){this.isInit||(this.sprite=this.getComponent(E),this.isInit=!0)}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"setData",value:function(e){var t=e.theme,n=e.key,i=e.seasonId;this.sprite.spriteFrame=tt.getJourneyBadgeSpriteFrame(n,t),this.theme=t,this.key=n,this.dateText=tt.getBadgeDate({seasonId:i,key:n})}},{key:"handleClickBadge",value:function(){this.canClick&&pt.openScreen(Ge.BADGE_REWARD_SCREEN,{customData:{theme:this.theme,key:this.key,date:this.dateText,isReward:!1}})}}]),l}(k)).prototype,"badgeButton",[VM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jM=qM))||jM);g._RF.pop(),g._RF.push({},"d1a8bWI7ghGGZYWTVf0o52l","JourneyBadgeBanner",void 0);var uz,cz,hz,pz,dz,fz,yz,vz,gz,mz,bz,Sz,wz,kz,Tz,Cz,Ez,Lz,xz,Iz,Az,Rz,Pz,_z,Nz,Oz,Bz=m.ccclass,Dz=m.property,Fz=(XM=Bz("JourneyBadgeBanner"),QM=Dz(gh),$M=Dz(oe),ez=Dz(lz),XM((iz=e((nz=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"titleLabel",iz,r(e)),a(e,"layout",az,r(e)),a(e,"badges",rz,r(e)),e.isInit=!1,e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.init()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"init",value:function(){this.isInit||(this.uiTransform=this.getComponent(L),this.layoutUITransform=this.layout.getComponent(L),this.isInit=!0)}},{key:"updateData",value:function(e,t,n){this.titleLabel.key=e;var i=At.CHERRY_BLOSSOM;switch(e){case"cherryBlossom":i=At.CHERRY_BLOSSOM;break;case"springDolls":i=At.SPRING_DOLLS;break;case"teaCeremony":i=At.TEA_CEREMONY;break;case"halloween":i=At.HALLOWEEN;break;case"thanksgiving":i=At.THANKSGIVING}var a,r=d(this.badges);try{for(r.s();!(a=r.n()).done;){a.value.node.active=!1}}catch(e){r.e(e)}finally{r.f()}for(var o=0;o<t;o++){var s=this.badges[o],l=(o+1).toString();s.node.active=!0,s.setData({theme:i,seasonId:n,key:l})}this.updateSizeLayout()}},{key:"updateSizeLayout",value:function(){this.isInit||this.init(),this.layout.spacingX=0,this.layout.updateLayout(!0);var e,t=0,n=d(this.badges);try{for(n.s();!(e=n.n()).done;){e.value.node.active&&t++}}catch(e){n.e(e)}finally{n.f()}if(!(t<=1)){var i=(this.uiTransform.width/this.layout.node.scale.x-this.layoutUITransform.width)/(t+1);this.layout.spacingX=i,this.layout.updateLayout(!0)}}}]),l}(k)).prototype,"titleLabel",[QM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),az=e(nz.prototype,"layout",[$M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rz=e(nz.prototype,"badges",[ez],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tz=nz))||tz);g._RF.pop(),g._RF.push({},"968e0OZNAlGYb9yClDwNxLb","BadgesScreen",void 0);var Mz,zz,Uz=m.ccclass,Gz=m.property,Hz=m.requireComponent,Wz=Ludex,Vz=Wz.Events,jz=(Wz.Utils,codex),qz=(jz.player,jz.event);uz=Uz("BadgesScreen"),cz=Hz(Si),hz=Gz(oe),pz=Gz(q),dz=Gz(q),fz=Gz(oe),yz=Gz(q),vz=Gz(N),gz=Gz(N),mz=Gz(N),bz=Gz(A),Sz=Gz(A),wz=Gz(A),uz(kz=cz((Cz=e((Tz=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"dailyBadgeContainer",Cz,r(e)),a(e,"badgeShelfPrefab",Ez,r(e)),a(e,"badgeYearLabelPrefab",Lz,r(e)),e.shelfComponentDict={},e.yearLabelDict={},a(e,"journeyBadgeContainer",xz,r(e)),a(e,"journeyBadgeBannerPrefab",Iz,r(e)),e.journeyBadgeBannerDict={},a(e,"buttons",Az,r(e)),e.badges=[],e.journeyBadges=[],a(e,"journeyButton",Rz,r(e)),a(e,"dailyButton",Pz,r(e)),a(e,"journeyScrollview",_z,r(e)),a(e,"dailyScrollview",Nz,r(e)),a(e,"journeyEmptyText",Oz,r(e)),e.interaction=!1,e.disableInteraction=function(){e.interaction=!1;var t,n=d(e.buttons);try{for(n.s();!(t=n.n()).done;){t.value.interactable=!1}}catch(e){n.e(e)}finally{n.f()}var i,a=d(e.badges);try{for(a.s();!(i=a.n()).done;){i.value.canClick=!1}}catch(e){a.e(e)}finally{a.f()}var r,o=d(e.journeyBadges);try{for(o.s();!(r=o.n()).done;){r.value.canClick=!1}}catch(e){o.e(e)}finally{o.f()}console.log("BadgeScreenButton",!1)},e.handleOpenedScreen=function(){var t=s(l().mark((function t(n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(n)){t.next=2;break}return t.abrupt("return");case 2:e.screen.data.source===Ge.DAILY_CHALLENGE_SCREEN?e.updateDailyChallengeContainer():e.updateJourneyContainer(),e.screen.animation?e.screen.animation.once(b.EventType.FINISHED,(function(){e.enableInteraction()})):e.enableInteraction();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.countBadges=0,e}return o(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.journeyButtonSprite=this.journeyButton.getComponent(E),this.journeyButtonLabel=this.journeyButton.getComponentInChildren(X),this.dailyButtonSprite=this.dailyButton.getComponent(E),this.dailyButtonLabel=this.dailyButton.getComponentInChildren(X),this.listenScreenEvents()}},{key:"enableInteraction",value:function(){this.interaction=!0;var e,t=d(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}var n,i=d(this.badges);try{for(i.s();!(n=i.n()).done;){n.value.canClick=!0}}catch(e){i.e(e)}finally{i.f()}var a,r=d(this.journeyBadges);try{for(r.s();!(a=r.n()).done;){a.value.canClick=!0}}catch(e){r.e(e)}finally{r.f()}console.log("BadgeScreenButton",!0)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){qz.on(Vz.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){qz.off(Vz.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"updateDailyBadgeData",value:function(){for(var e=Rt,t=(new Date).getMonth()+1,n=(new Date).getFullYear(),i=e;i<=n;i++){for(var a=i===n?t:12,r=[],o=1;o<=a;o++)if(r.push(o),3===r.length||o===a){var s="".concat(i,"-").concat(r[0]);if(!this.shelfComponentDict[s]){var l=K(this.badgeShelfPrefab);l.setParent(this.dailyBadgeContainer.node);var u=l.getComponent(ZM);this.shelfComponentDict[s]=u}var c,h=this.shelfComponentDict[s],p=[],f=d(r);try{for(f.s();!(c=f.n()).done;){var y=c.value,v=mt.isCompletedMonth({month:y,year:i});p.push({month:y,year:i,badge:v})}}catch(e){f.e(e)}finally{f.f()}h.updateShelf(p);var g,m=d(h.badges);try{for(m.s();!(g=m.n()).done;){var b=g.value;this.badges.push(b),b.disableInteraction=this.disableInteraction,b.canClick=this.interaction}}catch(e){m.e(e)}finally{m.f()}r.length=0}var S="".concat(i);if(!this.yearLabelDict[S]){var w=K(this.badgeYearLabelPrefab);w.setParent(this.dailyBadgeContainer.node);var k=w.getComponentInChildren(X);k.string=i.toString(),this.yearLabelDict[S]=k}}}},{key:"updateJourneyBadgeData",value:function(){this.countBadges=0;var e,t=tt.getSeasonIds(),n=d(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=tt.getClaimedBadgesBySeasonId(i).length;if(0!==a){var r=tt.getSeasonThemeById(i),o="cherryBlossom";switch(r){case At.CHERRY_BLOSSOM:o="cherryBlossom";break;case At.SPRING_DOLLS:o="springDolls";break;case At.TEA_CEREMONY:o="teaCeremony";break;case At.HALLOWEEN:o="halloween";break;case At.THANKSGIVING:o="thanksgiving"}var s=i;if(!this.journeyBadgeBannerDict[s]){var l=K(this.journeyBadgeBannerPrefab);l.setParent(this.journeyBadgeContainer.node);var u=l.getComponent(Fz);this.journeyBadgeBannerDict[s]=u}var c=this.journeyBadgeBannerDict[s];c.updateData(o,a,i);var h,p=d(c.badges);try{for(p.s();!(h=p.n()).done;){var f=h.value;this.journeyBadges.push(f),f.disableInteraction=this.disableInteraction,f.canClick=this.interaction}}catch(e){p.e(e)}finally{p.f()}this.countBadges+=a}}}catch(e){n.e(e)}finally{n.f()}this.journeyEmptyText.active=0===this.countBadges}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleClose",value:function(){this.disableInteraction(),pt.closeScreen(Ge.BADGES_SCREEN,{openNextScreenImmediately:!0});var e=this.screen.data;e.source===Ge.DAILY_CHALLENGE_SCREEN?pt.openScreen(Ge.DAILY_CHALLENGE_SCREEN):e.source===Ge.JOURNEY_LEVEL_SCREEN&&pt.openScreen(Ge.JOURNEY_LEVEL_SCREEN)}},{key:"handleScroll",value:function(e,t,n){if(12===t);else if(9!==t)return}},{key:"handleClickedDailyButton",value:function(){this.updateDailyChallengeContainer(!1),this.enableInteraction()}},{key:"updateDailyChallengeContainer",value:(c=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],!0!==this.isDailyBadge||t){e.next=3;break}return e.abrupt("return");case 3:if(!mt.isNeedLoadBadge()){e.next=9;break}return pt.showLoadingScreen(),n=mt.getBadges(),e.next=8,mt.loadBadges(n);case 8:pt.closeLoadingScreen();case 9:this.dailyButtonSprite.color=new D(255,255,255,255),this.dailyButtonLabel.color=new D(224,180,122,255),this.journeyButtonSprite.color=new D(185,166,166,255),this.journeyButtonLabel.color=new D(131,92,74,255),this.journeyScrollview.active=!1,this.journeyEmptyText.active=!1,this.dailyScrollview.active=!0,this.updateDailyBadgeData(),this.isDailyBadge=!0;case 18:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedJourneyButton",value:function(){this.updateJourneyContainer(!1),this.enableInteraction()}},{key:"updateJourneyContainer",value:(u=s(l().mark((function e(){var t,n=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(n.length>0&&void 0!==n[0])||n[0],!1!==this.isDailyBadge||t){e.next=3;break}return e.abrupt("return");case 3:if(!tt.isNeedClaimedBadges()){e.next=8;break}return pt.showLoadingScreen(),e.next=7,tt.loadClaimedBadges();case 7:pt.closeLoadingScreen();case 8:this.journeyButtonSprite.color=new D(255,255,255,255),this.journeyButtonLabel.color=new D(224,180,122,255),this.dailyButtonSprite.color=new D(185,166,166,255),this.dailyButtonLabel.color=new D(131,92,74,255),this.journeyScrollview.active=!0,this.journeyEmptyText.active=0===this.countBadges,this.dailyScrollview.active=!1,this.updateJourneyBadgeData(),this.isDailyBadge=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"dailyBadgeContainer",[hz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ez=e(Tz.prototype,"badgeShelfPrefab",[pz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lz=e(Tz.prototype,"badgeYearLabelPrefab",[dz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xz=e(Tz.prototype,"journeyBadgeContainer",[fz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iz=e(Tz.prototype,"journeyBadgeBannerPrefab",[yz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Az=e(Tz.prototype,"buttons",[vz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Rz=e(Tz.prototype,"journeyButton",[gz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pz=e(Tz.prototype,"dailyButton",[mz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_z=e(Tz.prototype,"journeyScrollview",[bz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nz=e(Tz.prototype,"dailyScrollview",[Sz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oz=e(Tz.prototype,"journeyEmptyText",[wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kz=Tz))||kz);g._RF.pop(),g._RF.push({},"f5bb7f58CRIWIyc/nZ+nFUo","BadgeBackground",void 0);var Kz,Yz,Jz,Zz,Xz,Qz=m.ccclass,$z=(m.property,Ludex),eU=($z.Utils.Decorator,$z.Events),tU=codex.event,nU=Be.Layout,iU=(u(Mz={},nU.Portrait,{width:1080,height:2164}),u(Mz,nU.Landscape,{width:2732,height:1583}),Mz);Qz("BadgeBackground")(zz=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ue[Ge.BADGES_SCREEN]&&(e.updateBackgroundSprite(),x.on(_e.VIEW_RESIZED,e.handleViewResized))},e.unlistenGameEvents=function(t){t.screenName===Ue[Ge.BADGES_SCREEN]&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),this.additionalBgUITransform=this.additionalBg.getComponent(L),Re.validateRequiredProperties(this),tU.on(eU.OPENING_SCREEN,this.listenGameEvents),tU.on(eU.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Oe.getCurrentLayout()===Be.Layout.Landscape){var e=Oe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Oe.getCurrentLayoutBackgroundByKey("Badge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Oe.getCurrentLayoutBackgroundByKey("Badge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentBadgeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getLandscapeBackground",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return iU}}]),c}(Ai));g._RF.pop(),g._RF.push({},"22d01dqMNdD2p4YoyXQIcGy","ScrollViewResponsiveNode",void 0);var aU,rU,oU,sU,lU,uU,cU,hU,pU,dU,fU,yU,vU,gU,mU,bU,SU,wU,kU,TU,CU,EU,LU,xU,IU=m.ccclass,AU=m.property;Kz=IU("ScrollViewResponsiveNode"),Yz=AU(J),Kz((Xz=e((Zz=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"scrollView",Xz,r(e)),e.isScrollToTop=!1,e}return o(l,[{key:"updateObjectInLayoutPortrait",value:function(){p(h(l.prototype),"updateObjectInLayoutPortrait",this).call(this),this.updateScrollView()}},{key:"updateObjectInLayoutLandscape",value:function(){p(h(l.prototype),"updateObjectInLayoutLandscape",this).call(this),this.updateScrollView()}},{key:"updateScrollView",value:function(){this.scrollView&&!this.isScrollToTop&&(this.scrollView.scrollToTop(),this.isScrollToTop=!0)}}]),l}(fl)).prototype,"scrollView",[Yz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jz=Zz));g._RF.pop(),g._RF.push({},"d6149LGv/NCuY8oQhmlvxvj","ChallengeFriendCompleteScreen",void 0);var RU,PU=m.ccclass,_U=m.property,NU=m.requireComponent,OU=Ludex,BU=OU.Events,DU=(OU.Utils,codex),FU=DU.player,MU=DU.event,zU=DU.match;aU=PU("ChallengeFriendCompleteScreen"),rU=NU(Si),oU=_U(uS),sU=_U(uS),lU=_U(X),uU=_U(X),cU=_U(X),hU=_U(X),pU=_U(E),dU=_U(ae),fU=_U(ae),yU=_U(E),aU(vU=rU((mU=e((gU=function(e){t(d,e);var u,c,h,p=n(d);function d(){var e;i(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=p.call.apply(p,[this].concat(n)),a(e,"playerAvatarWithFlag",mU,r(e)),a(e,"opponentAvatarWithFlag",bU,r(e)),a(e,"titleWin",SU,r(e)),a(e,"titleDraw",wU,r(e)),a(e,"titleLose",kU,r(e)),a(e,"titleWaiting",TU,r(e)),a(e,"glowBG",CU,r(e)),a(e,"glowBGWin",EU,r(e)),a(e,"glowBGLose",LU,r(e)),a(e,"glowTitle",xU,r(e)),e.isOpponentFinished=!1,e.handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.updateChallengeData()},e}return o(d,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){MU.on(BU.OPENING_SCREEN,this.handleOpeningScreen),MU.on(BU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){MU.off(BU.OPENING_SCREEN,this.handleOpeningScreen),MU.off(BU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){pt.closeScreen(Ge.CHALLENGE_FRIEND_COMPLETE_SCREEN)}},{key:"handleClickedClose",value:(h=s(l().mark((function e(){var t,n,i,a,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.close(),rt.switchToSoloContext(),(null==(t=this.screen.data)?void 0:t.source)===St.DASHBOARD_SCENE||(n=this.screen.data,i=n.level,a=void 0===i?1:i,r=n.score,o=void 0===r?0:r,this.showWiningScreen(o,a));case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"showWiningScreen",value:function(e,t){ft.inst.isPlayerJoined?pt.openScreen(Ge.TOURNAMENT_COMPLETE_SCREEN,{score:e,level:t}):pt.openScreen(Ge.WINNING_SCREEN,{score:e,level:t})}},{key:"updateChallengeData",value:function(){this.isOpponentFinished=!1,this.updatePlayerChallengeData(),this.updateOpponentChallengeData();var e=this.isOpponentFinished,t=Number(this.playerAvatarWithFlag.scoreLabel.string),n=Number(this.opponentAvatarWithFlag.scoreLabel.string),i=t>n,a=t===n;this.titleWin.node.active=!1,this.titleDraw.node.active=!1,this.titleLose.node.active=!1,this.titleWaiting.node.active=!1,e?i?(this.playerAvatarWithFlag.updateState("win"),this.opponentAvatarWithFlag.updateState("lose"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGWin,this.glowTitle.node.active=!0,this.titleWin.node.active=!0):a?(this.playerAvatarWithFlag.updateState("lose"),this.opponentAvatarWithFlag.updateState("lose"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGWin,this.glowTitle.node.active=!0,this.titleDraw.node.active=!0):(this.playerAvatarWithFlag.updateState("lose"),this.opponentAvatarWithFlag.updateState("win"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGLose,this.glowTitle.node.active=!0,this.titleLose.node.active=!0):(this.playerAvatarWithFlag.updateState("waiting"),this.opponentAvatarWithFlag.updateState("waiting"),this.glowBG.node.active=!1,this.glowTitle.node.active=!1,this.titleWaiting.node.active=!0)}},{key:"updatePlayerChallengeData",value:(c=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=FU.getPlayer(),n=t.playerId,i=codex.match.getMatchState(),(a=i.profiles)&&a[n]){e.next=4;break}return e.abrupt("return");case 4:r=a[n],o=r.name,s=r.photo,u=r.score,c=void 0===u?0:u,this.playerAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:o,avatarUrl:s}),this.playerAvatarWithFlag.scoreLabel.string=c.toString();case 7:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"updateOpponentChallengeData",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=zU.getMatchState(),n=t.customData.opponentId,i=codex.match.getMatchState(),(a=i.profiles)&&a[n]){e.next=5;break}return e.abrupt("return");case 5:r=a[n],o=r.name,s=r.photo,u=r.score,c=void 0===u?0:u,h=r.finished,p=void 0!==h&&h,this.opponentAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:o,avatarUrl:s}),this.opponentAvatarWithFlag.scoreLabel.string=c.toString(),this.isOpponentFinished=p;case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),d}(k)).prototype,"playerAvatarWithFlag",[oU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bU=e(gU.prototype,"opponentAvatarWithFlag",[sU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SU=e(gU.prototype,"titleWin",[lU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wU=e(gU.prototype,"titleDraw",[uU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kU=e(gU.prototype,"titleLose",[cU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TU=e(gU.prototype,"titleWaiting",[hU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CU=e(gU.prototype,"glowBG",[pU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EU=e(gU.prototype,"glowBGWin",[dU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LU=e(gU.prototype,"glowBGLose",[fU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xU=e(gU.prototype,"glowTitle",[yU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vU=gU))||vU);g._RF.pop(),g._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var UU,GU,HU,WU=m.ccclass,VU=m.requireComponent;WU("BackgroundMask")(RU=VU([P])(RU=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"onLoad",value:function(){var e=this.getComponent(P);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),r}(k))||RU);g._RF.pop(),g._RF.push({},"92058jAgL9EQrmYxKm+mzty","ScreenMiddleAlignment",void 0);var jU,qU,KU,YU,JU,ZU=m.ccclass,XU=m.property;ZU("ScreenMiddleAlignment")((HU=e((GU=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"reduceScaleWhenNotEnoughHeight",HU,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.alignToScreenMiddle()}},{key:"alignToScreenMiddle",value:function(){var e,t=je.getBannerAdsHeight();if(this.node.setPosition(0,t/2),this.reduceScaleWhenNotEnoughHeight){var n=(null===(e=this.node.getComponent(L))||void 0===e?void 0:e.contentSize.height)||0,i=I.getVisibleSize().height-t;if(n>i){var a=i/n;this.node.setScale(a,a,1)}else this.node.setScale(1,1,1)}}}]),l}(k)).prototype,"reduceScaleWhenNotEnoughHeight",[XU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),UU=GU));g._RF.pop(),g._RF.push({},"d562cAXnG1PQ6vXfOEq2wVu","Screens",void 0);var QU,$U,eG,tG,nG,iG,aG,rG=m.ccclass,oG=m.property,sG=m.executeInEditMode;jU=rG("Screens"),qU=oG({type:W(Ge)}),jU(KU=sG((JU=e((YU=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"screenKeys",JU,r(e)),e}return o(l,[{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"onChildrenChanged",value:function(){}}]),l}(k)).prototype,"screenKeys",[qU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),KU=YU))||KU);g._RF.pop(),g._RF.push({},"b05b4SBCkxHfLoaKt3EWCrp","ChooseCircle",void 0);var lG,uG,cG,hG,pG,dG,fG,yG,vG,gG=m.ccclass,mG=m.property,bG=121,SG=122,wG=Ludex.Utils.Signal,kG=(QU=gG("ChooseCircle"),$U=mG(L),eG=mG(L),QU((iG=e((nG=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"mask1",iG,r(e)),a(e,"mask2",aG,r(e)),e.signalController=new wG.SignalController,e}return o(h,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"reset",value:function(){this.signalController.abort(),this.mask1.setContentSize(0,.5*SG),this.mask2.setContentSize(0,.5*SG)}},{key:"runAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:.5,this.reset(),n=this.signalController.renew(),i=B(this.mask1).to(.3*t,{width:.6*bG}),a=B(this.mask1).to(.3*t,{height:SG}),r=B(this.mask2).to(.2*t,{width:.4*bG}),o=B(this.mask2).to(.2*t,{height:SG}),e.next=9,Ve.runTweenAsync(i,n);case 9:return e.next=11,Ve.runTweenAsync(a,n);case 11:return e.next=13,Ve.runTweenAsync(r,n);case 13:return e.next=15,Ve.runTweenAsync(o,n);case 15:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"mask1",[$U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aG=e(nG.prototype,"mask2",[eG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tG=nG))||tG);g._RF.pop(),g._RF.push({},"580e6YiGSBK/pZ2QsuAOa0i","DayColumn",void 0);var TG,CG,EG,LG,xG,IG,AG,RG,PG,_G,NG,OG,BG,DG,FG,MG,zG,UG,GG,HG,WG,VG,jG,qG,KG,YG,JG,ZG,XG,QG,$G,eH,tH,nH,iH,aH,rH,oH,sH,lH,uH,cH=m.ccclass,hH=m.property,pH=(lG=cH("DayColumn"),uG=hH(X),cG=hH(X),hG=hH(S),lG((fG=e((dG=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"dayOfWeekLabel",fG,r(e)),a(e,"dayLabels",yG,r(e)),a(e,"dayOfWeek",vG,r(e)),e.defaultColor=new D(154,71,46,255),e.unselectedColor=new D(180,139,109,255),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){if(0!==this.dayLabels.length){var e=this.dayLabels[0].getComponent(L);this.labelWidth=e.width,this.labelHeight=e.height}else console.warn("No day labels found in DayColumn")}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updateDayOfWeekLabel",value:function(e,t){if(this.dayOfWeekLabel.string="".concat(this.dayOfWeek.charAt(0).toUpperCase()).concat(this.dayOfWeek.slice(1)),e<1||e>12||t<0)console.warn("Invalid month or year provided");else{for(var n=["sun","mon","tue","wed","thu","fri","sat"],i=[],a=1;a<=31;a++){var r=new Date(t,e-1,a);if(r.getMonth()!==e-1)break;n[r.getDay()]===this.dayOfWeek&&i.push(a)}if(0!==i.length){var o,s=d(this.dayLabels);try{for(s.s();!(o=s.n()).done;){o.value.string=""}}catch(e){s.e(e)}finally{s.f()}for(var l=i[0]<=n.indexOf(this.dayOfWeek)+1?0:1,u=0;u<i.length;u++)this.dayLabels[u+l].string=i[u].toString(),this.dayLabels[u+l].color=this.defaultColor;var c=new Date,h=c.getDate(),p=c.getMonth()+1,f=c.getFullYear();if(p===e&&f===t)for(var y=0;y<i.length;y++)i[y]>h&&(this.dayLabels[y+l].color=this.unselectedColor)}else console.warn("No valid days found for ".concat(this.dayOfWeek," in ").concat(e,"/").concat(t))}}}]),l}(k)).prototype,"dayOfWeekLabel",[uG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yG=e(dG.prototype,"dayLabels",[cG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vG=e(dG.prototype,"dayOfWeek",[hG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"sun"}}),pG=dG))||pG);g._RF.pop(),g._RF.push({},"b6790CoxhxPF42ncO5h2FS5","Calendar",void 0);var dH,fH,yH,vH,gH,mH,bH,SH,wH=m.ccclass,kH=m.property,TH=(m.executeInEditMode,Ludex.Utils.Signal),CH=(TG=wH("Calendar"),CG=kH(pH),EG=kH(w),LG=kH(w),xG=kH(w),IG=kH(A),AG=kH(kG),RG=kH(gh),PG=kH(A),_G=kH(gh),NG=kH(X),OG=kH(N),BG=kH(N),DG=kH(oe),FG=kH(E),MG=kH(P),zG=kH(ae),UG=kH(E),GG=kH(E),HG=kH(E),TG((jG=e((VG=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"dayColumns",jG,r(e)),a(e,"day",qG,r(e)),a(e,"month",KG,r(e)),a(e,"year",YG,r(e)),a(e,"container",JG,r(e)),a(e,"chooseCircle",ZG,r(e)),a(e,"buttonLabel",XG,r(e)),a(e,"watchAdsNode",QG,r(e)),a(e,"buttonLabel2",$G,r(e)),a(e,"dateLabel",eH,r(e)),a(e,"prevMonthButton",tH,r(e)),a(e,"nextMonthButton",nH,r(e)),a(e,"layout",iH,r(e)),a(e,"doneImages",aH,r(e)),a(e,"glow",rH,r(e)),a(e,"doneImageFrame",oH,r(e)),a(e,"badgeBackground",sH,r(e)),a(e,"badgeGlow",lH,r(e)),a(e,"badge",uH,r(e)),e.signalController=new TH.SignalController,e.completedDayNode=null,e}return o(p,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.enableInteraction(),this.hideChooseCircle()}},{key:"onEnable",value:function(){this.signal=this.signalController.renew()}},{key:"onDisable",value:function(){this.signal.abort()}},{key:"onDestroy",value:function(){this.disableInteraction()}},{key:"start",value:function(){var e=new Date;this.month=e.getMonth()+1,this.year=e.getFullYear(),this.day=0;for(var t=e.getDate();t>0;t--){if(!mt.isCompletedChallenge({day:t,month:this.month,year:this.year})){this.day=t;break}}0===this.day&&(this.day=e.getDate()),this.updateMonthlySchedule({day:this.day,month:this.month,year:this.year})}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"updateMonthlySchedule",value:function(e){var t=e.day,n=e.month,i=e.year;if(console.log("Updating monthly schedule with:",e),void 0!==t&&void 0!==n&&void 0!==i)if(n<1||n>12||i<0)console.warn("Invalid month or year provided");else{this.signal.abort(),this.glow.opacity=0,this.day=t,this.month=n,this.year=i;for(var a=0;a<this.dayColumns.length;a++)this.dayColumns[a].updateDayOfWeekLabel(n,i);var r,o=null,s=d(this.dayColumns);try{for(s.s();!(r=s.n()).done;){var l,u=r.value,c=d(u.dayLabels);try{for(c.s();!(l=c.n()).done;){var h=l.value;if(""!==h.string)if(parseInt(h.string)===t){o=h;break}}}catch(e){c.e(e)}finally{c.f()}if(o)break}}catch(e){s.e(e)}finally{s.f()}if(o){var p=this.getLabelPosition(o);this.chooseCircle.node.setPosition(new F(p.x,p.y,0))}this.updateDoneImages(),this.updateButtons();var f=mt.getBadgeSpriteFrame({month:n,year:i}),y=mt.isCompletedMonth({month:n,year:i});if(this.badgeGlow.node.active=y,this.badgeBackground.color=y?new D(255,255,255,255):new D(126,100,106,255),f){this.badge.spriteFrame=f,this.badge.node.active=!0,this.badge.color=y?new D(255,255,255,255):new D(126,100,106,255);var v=cd.DailyBadgeOffset[n];v&&this.badge.node.setPosition(new F(v.x,v.y,0))}else this.badge.node.active=!1}}},{key:"enableInteraction",value:function(){this.node.on(A.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(A.EventType.TOUCH_END,this.onTouchEnd,this)}},{key:"disableInteraction",value:function(){this.node.off(A.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(A.EventType.TOUCH_END,this.onTouchEnd,this)}},{key:"getTouchPosition",value:function(e){var t=this.node.getComponent(L),n=e.getUILocation();return t.convertToNodeSpaceAR(new F(n.x,n.y,0))}},{key:"onTouchStart",value:function(e){var t,n=this.getTouchPosition(e),i=n.x-this.container.x,a=n.y-this.container.y,r=null,o=this.dayColumns[0].labelWidth,s=this.dayColumns[0].labelHeight*this.container.scale.y,l=d(this.dayColumns);try{for(l.s();!(t=l.n()).done;){var u,c=t.value,h=d(c.dayLabels);try{for(h.s();!(u=h.n()).done;){var p=u.value,f=this.getLabelPosition(p);if(i>=f.x-o/2&&i<=f.x+o/2&&a>=f.y-s/2&&a<=f.y+s/2){r=p,console.log("Label chosen:",p.string);break}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){l.e(e)}finally{l.f()}if(r&&""!==r.string&&!(new Date(this.year,this.month-1,parseInt(r.string))>new Date)){this.day=parseInt(r.string);var y=this.getLabelPosition(r);this.chooseCircle.node.setPosition(new F(y.x,y.y,0)),this.runChooseAnimation(),this.updateButtons()}}},{key:"onTouchEnd",value:function(e){}},{key:"getDate",value:function(){return{day:this.day,month:this.month,year:this.year}}},{key:"handlePrevMonthClicked",value:function(){var e=this,t=this.getDate(),n=t.month-1,i=t.year;if(n<1&&(n=12,i-=1),this.canClickedPrevMonth()){var a={day:new Date(i,n,0).getDate(),month:n,year:i};if(!mt.getBadgeSpriteFrame(a))return pt.showLoadingScreen(),void mt.loadBadges([a]).then((function(t){pt.closeLoadingScreen(),t?(e.updateMonthlySchedule(a),e.runChooseAnimation()):pt.openScreen(Ge.NOTIFICATION_SCREEN,{message:"failedToLoadBadge"})}));this.updateMonthlySchedule(a),this.runChooseAnimation()}}},{key:"handleNextMonthClicked",value:function(){var e=this,t=this.getDate(),n=t.month+1,i=t.year;if(n>12&&(n=1,i+=1),this.canClickedNextMonth()){var a=new Date(i,n-1,1).getDate(),r={day:a,month:n,year:i};if(!mt.getBadgeSpriteFrame(r))return pt.showLoadingScreen(),void mt.loadBadges([r]).then((function(t){pt.closeLoadingScreen(),t?(e.updateMonthlySchedule(r),e.runChooseAnimation()):pt.openScreen(Ge.NOTIFICATION_SCREEN,{message:"failedToLoadBadge"})}));this.updateMonthlySchedule({day:a,month:n,year:i}),this.runChooseAnimation()}}},{key:"canClickedPrevMonth",value:function(){var e=this.getDate(),t=e.month,n=e.year;return!(1===t&&n<=Rt)}},{key:"canClickedNextMonth",value:function(){var e=this.getDate(),t=e.month,n=e.year,i=new Date,a=i.getMonth()+1,r=i.getFullYear(),o=t+1,s=n;return o>12&&(o=1,s+=1),!(s>r||s===r&&o>a)}},{key:"getLabelPosition",value:function(e){var t=e.node.parent.parent;return{x:t.x,y:this.layout.node.position.y+e.node.position.y+e.node.parent.position.y+t.position.y}}},{key:"updateDoneImages",value:function(){var e,t=0,n=d(this.doneImages);try{for(n.s();!(e=n.n()).done;){e.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}var i,a=this.getDate(),r=a.month,o=a.year,s=d(this.dayColumns);try{for(s.s();!(i=s.n()).done;){var l,u=i.value,c=d(u.dayLabels);try{for(c.s();!(l=c.n()).done;){var h=l.value;if(""!==h.string){var p=parseInt(h.string);if(mt.isCompletedChallenge({day:p,month:r,year:o})){h.color=new D(255,255,255,0);var f=this.getLabelPosition(h);if(t<this.doneImages.length){var y=this.doneImages[t];y.node.active=!0,y.node.setPosition(new F(f.x,f.y,0))}else{var v=new A("DoneImage-".concat(t)),g=v.addComponent(E);g.spriteFrame=this.doneImageFrame,this.container.addChild(v),v.setPosition(new F(f.x,f.y,0)),this.doneImages.push(g),console.log("Created done image ",t)}t++}}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){s.e(e)}finally{s.f()}}},{key:"updateButtons",value:function(){var e=this.getDate(),t=e.month,n=e.year,i=mt.isCompletedChallenge({day:this.day,month:this.month,year:this.year}),a=new Date;a.getFullYear()===n&&a.getMonth()+1===t&&a.getDate()===this.day?(this.buttonLabel.node.active=!0,this.watchAdsNode.active=!1):(this.buttonLabel.node.active=!1,this.watchAdsNode.active=!0),i?(this.buttonLabel.key="restart",this.buttonLabel2.key="restart"):(this.buttonLabel.key="Play",this.buttonLabel2.key="Play"),this.prevMonthButton&&this.nextMonthButton&&this.dateLabel&&(this.prevMonthButton.node.active=this.canClickedPrevMonth(),this.nextMonthButton.node.active=this.canClickedNextMonth(),this.dateLabel.string="".concat(t<10?"0".concat(t):t,"/").concat(n))}},{key:"findAndHideCompletedDay",value:function(e){this.completedDayNode=null;var t,n=null,i=d(this.dayColumns);try{for(i.s();!(t=i.n()).done;){var a,r=t.value,o=d(r.dayLabels);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.string===e.toString()){n=this.getLabelPosition(s);break}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}if(n){var l=this.doneImages.find((function(e){return e.node.position.x===n.x&&e.node.position.y===n.y}));l?(this.completedDayNode=l.node,this.completedDayNode.active=!1,this.signal=this.signalController.renew()):console.warn("No done image found for position ".concat(n.x,", ").concat(n.y))}else console.warn("No label found for day ".concat(e))}},{key:"runShowCompletedDayAnimation",value:(c=s(l().mark((function e(){var t,n,i,a=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.completedDayNode){e.next=3;break}return console.warn("No completed day node found for animation"),e.abrupt("return");case 3:if(!this.signal.aborted){e.next=5;break}return e.abrupt("return");case 5:return this.completedDayNode.active=!0,this.completedDayNode.scale=new F(1.5,1.5,0),this.glow.node.setPosition(this.completedDayNode.position.clone()),this.glow.opacity=255,this.glow.node.scale=new F(.6,.6,0),t=B(this.completedDayNode).to(.5,{scale:new F(1,1,0)},{easing:"backOut"}),n=B(this.glow).to(.5,{opacity:100},{easing:"linear"}),i=B(this.glow.node).to(.5,{scale:new F(.9,.9,0)},{easing:"backOut"}),e.next=15,Promise.all([Ve.runTweenAsync(t,this.signal),Ve.runTweenAsync(n,this.signal),Ve.runTweenAsync(i,this.signal)]).then((function(){a.glow.opacity=0}));case 15:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hideChooseCircle",value:function(){this.chooseCircle.reset()}},{key:"runChooseAnimation",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.chooseCircle.runAnimation());case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"dayColumns",[CG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qG=e(VG.prototype,"day",[EG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),KG=e(VG.prototype,"month",[LG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),YG=e(VG.prototype,"year",[xG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2025}}),JG=e(VG.prototype,"container",[IG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZG=e(VG.prototype,"chooseCircle",[AG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XG=e(VG.prototype,"buttonLabel",[RG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QG=e(VG.prototype,"watchAdsNode",[PG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$G=e(VG.prototype,"buttonLabel2",[_G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eH=e(VG.prototype,"dateLabel",[NG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tH=e(VG.prototype,"prevMonthButton",[OG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nH=e(VG.prototype,"nextMonthButton",[BG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iH=e(VG.prototype,"layout",[DG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aH=e(VG.prototype,"doneImages",[FG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rH=e(VG.prototype,"glow",[MG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oH=e(VG.prototype,"doneImageFrame",[zG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sH=e(VG.prototype,"badgeBackground",[UG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lH=e(VG.prototype,"badgeGlow",[GG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uH=e(VG.prototype,"badge",[HG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WG=VG))||WG);g._RF.pop(),g._RF.push({},"eec4eYoz6dI1I15fh8NDomM","DailyChallengeScreen",void 0);var EH,LH,xH=m.ccclass,IH=m.property,AH=m.requireComponent,RH=Ludex,PH=RH.Events,_H=(RH.Utils,codex),NH=(_H.player,_H.event);dH=xH("DailyChallengeScreen"),fH=AH(Si),yH=IH(CH),vH=IH(N),dH(gH=fH((bH=e((mH=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"calendar",bH,r(e)),a(e,"buttons",SH,r(e)),e.handleOpenedScreen=function(){var t=s(l().mark((function t(n){var i,a,r,o,s,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(n)){t.next=2;break}return t.abrupt("return");case 2:a=null===(i=n.screenData)||void 0===i?void 0:i.customData,r=(null==a?void 0:a.day)||0,o=(null==a?void 0:a.month)||0,s=(null==a?void 0:a.year)||0,u=(null==a?void 0:a.dayCompleted)||0,r&&o&&s&&(e.calendar.updateMonthlySchedule({day:r,month:o,year:s}),e.calendar.hideChooseCircle()),u>0&&e.calendar.findAndHideCompletedDay(u),e.screen.animation?e.screen.animation.once(b.EventType.FINISHED,(function(){e.enableInteraction(),u>0?e.calendar.runShowCompletedDayAnimation().then((function(){e.calendar.runChooseAnimation()})):e.calendar.runChooseAnimation()})):e.enableInteraction();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return o(h,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"enableInteraction",value:function(){var e,t=d(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}console.log("DailyScreenButton",!0)}},{key:"disableInteraction",value:function(){var e,t=d(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!1}}catch(e){t.e(e)}finally{t.f()}console.log("DailyScreenButton",!1)}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){NH.on(PH.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){NH.off(PH.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleBadgesClicked",value:function(){this.disableInteraction(),pt.closeScreen(Ge.DAILY_CHALLENGE_SCREEN,{openNextScreenImmediately:!0}),pt.openScreen(Ge.BADGES_SCREEN,{preloadCallback:mt.isNeedLoadBadge()?mt.loadingTextureBeforeOpenBadgeScreen:void 0,source:Ge.DAILY_CHALLENGE_SCREEN})}},{key:"handleClose",value:function(){rt.switchToNormal(),this.disableInteraction(),pt.closeScreen(Ge.DAILY_CHALLENGE_SCREEN)}},{key:"handlePlay",value:(u=s(l().mark((function e(){var t,n,i,a,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.calendar.getDate(),n=t.day,i=t.month,a=t.year,r=new Date,r.getFullYear()===a&&r.getMonth()+1===i&&r.getDate()===n){e.next=10;break}return e.next=7,je.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0});case 7:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:o=mt.getRandomLevel(n,i,a),console.log("Daily Challenge Level: ".concat(o)),codex.analytics.event(gt.DAILY_CHALLENGE_START,{level:o}),nt.setLevel(o),rt.switchToDailyChallenge(n,i,a),rt.getCurrentMatchMode()===Ludex.Match.Modes.CHALLENGE_FRIEND&&rt.switchToSoloContext(),Tt.switchToGameScene();case 17:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"calendar",[yH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SH=e(mH.prototype,"buttons",[vH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gH=mH))||gH);g._RF.pop(),g._RF.push({},"2a8d2rxidZO+5jYBBzz2vEq","DailyChallengeBackground",void 0);var OH,BH,DH,FH,MH,zH,UH,GH,HH,WH,VH,jH,qH,KH,YH,JH,ZH,XH=m.ccclass,QH=(m.property,Ludex),$H=(QH.Utils.Decorator,QH.Events),eW=Be.Layout,tW=codex.event,nW=(u(EH={},eW.Portrait,{width:1080,height:2164}),u(EH,eW.Landscape,{width:2732,height:1583}),EH);XH("DailyChallengeBackground")(LH=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ue[Ge.DAILY_CHALLENGE_SCREEN]&&x.on(_e.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ue[Ge.DAILY_CHALLENGE_SCREEN]&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),this.additionalBgUITransform=this.additionalBg.getComponent(L),Re.validateRequiredProperties(this),tW.on($H.OPENING_SCREEN,this.listenGameEvents),tW.on($H.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Oe.getCurrentLayout()===Be.Layout.Landscape){var e=Oe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Oe.getCurrentLayoutBackgroundByKey("DailyChallenge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Oe.getCurrentLayoutBackgroundByKey("DailyChallenge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentDailyChallengeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getLandscapeBackground",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return nW}}]),c}(Ai));g._RF.pop(),g._RF.push({},"0764dErQjJGn6RS8E/9Xn1c","Chest",void 0);var iW,aW,rW,oW,sW,lW,uW,cW=m.ccclass,hW=m.property,pW=(OH=cW("Chest"),BH=hW(X),DH=hW(X),FH=hW(P),MH=hW(N),zH=hW(E),UH=hW(E),GH=hW(E),OH((VH=e((WH=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"hintLabel",VH,r(e)),a(e,"shuffleLabel",jH,r(e)),a(e,"popup",qH,r(e)),a(e,"chestButton",KH,r(e)),a(e,"chestSprite",YH,r(e)),a(e,"tickIcon",JH,r(e)),a(e,"glowSprite",ZH,r(e)),e.spinTween=null,e.currentTimeout=void 0,e}return o(l,[{key:"onLoad",value:function(){this.popup.opacity=0}},{key:"updateHintLabel",value:function(e){this.hintLabel.string=e.toString()}},{key:"updateShuffleLabel",value:function(e){this.shuffleLabel.string=e.toString()}},{key:"showPopup",value:function(){var e=this;this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0);var t=this.node.parent;t&&this.node.setSiblingIndex(t.children.length-1);B(this.popup).to(.2,{opacity:255},{easing:"sineInOut"}).start(),this.currentTimeout=setTimeout((function(){e.hidePopup()}),1700)}},{key:"hidePopup",value:function(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0),this&&this.popup&&(this.popup.opacity=0)}},{key:"updateChestState",value:function(e,t){var n,i;(this.chestSprite.color=e?new D(143,107,107):new D(255,255,255),this.chestButton.interactable=!e,this.tickIcon.node.active=e,t&&!e)?(null===(n=this.spinTween)||void 0===n||n.stop(),this.spinTween=B(this.glowSprite.node).by(2,{angle:360},{easing:"linear"}).repeatForever().start(),this.glowSprite.node.active=!0):(null===(i=this.spinTween)||void 0===i||i.stop(),this.glowSprite.node.active=!1)}}]),l}(k)).prototype,"hintLabel",[BH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jH=e(WH.prototype,"shuffleLabel",[DH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qH=e(WH.prototype,"popup",[FH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KH=e(WH.prototype,"chestButton",[MH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YH=e(WH.prototype,"chestSprite",[zH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JH=e(WH.prototype,"tickIcon",[UH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZH=e(WH.prototype,"glowSprite",[GH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HH=WH))||HH);g._RF.pop(),g._RF.push({},"3671aIPELFMe7d/cBXEiqGL","Stage",void 0);var dW,fW,yW,vW,gW,mW,bW,SW,wW,kW,TW,CW,EW,LW,xW,IW=m.ccclass,AW=m.property,RW=(iW=IW("Stage"),aW=AW(A),rW=AW(A),iW((lW=e((sW=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"tabContainer",lW,r(e)),a(e,"tabLockContainer",uW,r(e)),e}return o(l,[{key:"unLockStage",value:function(){this.tabContainer.active=!0,this.tabLockContainer.active=!1}},{key:"lockStage",value:function(){this.tabContainer.active=!1,this.tabLockContainer.active=!0}}]),l}(k)).prototype,"tabContainer",[aW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uW=e(sW.prototype,"tabLockContainer",[rW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oW=sW))||oW);g._RF.pop(),g._RF.push({},"adfa4ytM1JNS5ajyzDJZ4s8","TaskBlock",void 0);var PW,_W,NW,OW,BW,DW,FW,MW,zW,UW,GW,HW,WW,VW,jW,qW,KW=m.ccclass,YW=m.property,JW=(dW=KW("TaskBlock"),fW=YW(X),yW=YW(Ws),vW=YW(N),gW=YW(X),mW=YW(X),bW=YW(E),dW((kW=e((wW=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"taskTitle",kW,r(e)),a(e,"progressBar",TW,r(e)),a(e,"button",CW,r(e)),a(e,"progressTitle1",EW,r(e)),a(e,"progressTitle2",LW,r(e)),a(e,"icon",xW,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.taskTitleLocalize=this.taskTitle.getComponent(gh)}},{key:"setTaskTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.taskTitleLocalize||(this.taskTitleLocalize=this.taskTitle.getComponent(gh)),this.taskTitleLocalize.key=e,this.taskTitleLocalize.setParams(t)}},{key:"setProgressTitle",value:function(e,t){this.progressTitle1.string=e.toString(),this.progressTitle2.string="/".concat(t),this.progressTitle2.color=e===t?new D(100,169,33,255):new D(154,71,46,255)}},{key:"setProgressBar",value:function(e){this.progressBar.setProgress(e)}},{key:"handleSingleButtonClicked",value:function(){Tt.switchToGameScene()}},{key:"updateTask",value:function(e){var t=[];switch(e.type.name){case"CompleteLevel":case"UseItem":case"Match":t.push(e.target.toString());break;case"ReachCombo":t.push(e.type.minCombo.toString())}this.setTaskTitle(e.description,t),this.setProgressTitle(e.current,e.target);var n=e.current<=e.target?e.current/e.target:1;this.setProgressBar(n),1===n?(this.button.node.active=!1,this.icon.node.active=!0):(this.button.node.active=!0,this.icon.node.active=!1)}}]),l}(k)).prototype,"taskTitle",[fW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TW=e(wW.prototype,"progressBar",[yW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CW=e(wW.prototype,"button",[vW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EW=e(wW.prototype,"progressTitle1",[gW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LW=e(wW.prototype,"progressTitle2",[mW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xW=e(wW.prototype,"icon",[bW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SW=wW))||SW);g._RF.pop(),g._RF.push({},"8fa53dxgu5KFLkyjltDRQ7g","DailyQuestScreen",void 0);var ZW,XW,QW,$W,eV,tV,nV=m.ccclass,iV=m.property,aV=m.requireComponent,rV=Ludex.Events,oV=codex.event;PW=nV("DailyQuestScreen"),_W=aV(Si),NW=iV(Ws),OW=iV(RW),BW=iV(JW),DW=iV(pW),FW=iV(X),MW=iV(gh),PW(zW=_W((GW=e((UW=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"progressBar",GW,r(e)),a(e,"stages",HW,r(e)),a(e,"taskBlocks",WW,r(e)),a(e,"chests",VW,r(e)),a(e,"timerText",jW,r(e)),a(e,"timerTextLocalize",qW,r(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.updateDailyQuest()},e.currentShowedStage=-1,e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenButtonEvents(),this.updateTimerText(),this.schedule(this.updateTimerText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){oV.on(rV.OPENING_SCREEN,this.handleOpeningScreen),oV.on(rV.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){oV.off(rV.OPENING_SCREEN,this.handleOpeningScreen),oV.off(rV.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"listenButtonEvents",value:function(){}},{key:"updateDailyQuest",value:function(){console.log("DailyQuestScreen: updateDailyQuest");for(var e=0;e<this.stages.length;e++){var t=this.stages[e];t&&t.lockStage()}for(var n=0;n<dt.getCurrentStage();n++){var i=this.stages[n];i&&i.unLockStage()}this.updateShowQuest(),0===dt.getMaxExp()?this.progressBar.setProgress(0):this.progressBar.setProgress(dt.getExp()/dt.getMaxExp());for(var a=dt.getRewards(),r=0;r<this.chests.length;r++){var o=this.chests[r],s=a[r];o.updateHintLabel(0|s.HintItem),o.updateShuffleLabel(0|s.ShuffleItem)}this.handleUpdateChest();var l=dt.getRewardIsNotClaimed();(l.UndoItem>0||l.ShuffleItem>0||l.HintItem>0)&&this.handleGetOldReward()}},{key:"updateShowQuest",value:function(e){if(this.currentShowedStage!==e){this.currentShowedStage=void 0===e?dt.getCurrentStage():e;for(var t=dt.getCurrentQuestsInStage(e),n=0;n<this.taskBlocks.length;n++){var i=this.taskBlocks[n];if(i){if(n>=t.length){console.warn("DailyQuestScreen: Number of quests is not 3");break}var a=t[n];a&&i.updateTask(a)}}}}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){pt.closeScreen(Ge.DAILY_QUEST_SCREEN)}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedChest",value:function(e,t){var n=parseInt(t);if(!dt.getRewarded()[n]&&dt.canGetReward(n)){var i=dt.getRewards()[n],a=[];i.HintItem>0&&a.push({item:lt.HINT,count:i.HintItem}),i.ShuffleItem>0&&a.push({item:lt.SHUFFLE,count:i.ShuffleItem}),i.UndoItem>0&&a.push({item:lt.UNDO,count:i.UndoItem}),dt.updateGetChestReward(n),this.close();var r={items:a,watchAdsDoubleReward:!0,successCallback:function(){},chestId:n,earnFrom:"DailyQuest"};codex.analytics.event(gt.DAILY_QUEST_GET_REWARD,{chestId:n}),pt.openScreen(Ge.REWARD_SCREEN,r)}else{this.chests[n].showPopup();for(var o=0;o<this.chests.length;o++)o!==n&&this.chests[o].hidePopup()}}},{key:"handleUpdateChest",value:function(){for(var e=dt.getRewarded(),t=0;t<this.chests.length;t++){var n=this.chests[t],i=dt.canGetReward(t);n.updateChestState(e[t],i)}}},{key:"handleGetOldReward",value:function(){var e=dt.getRewardIsNotClaimed(),t=[];e.HintItem>0&&t.push({item:lt.HINT,count:e.HintItem}),e.ShuffleItem>0&&t.push({item:lt.SHUFFLE,count:e.ShuffleItem}),e.UndoItem>0&&t.push({item:lt.UNDO,count:e.UndoItem});var n={items:t,watchAdsDoubleReward:!0,successCallback:function(){dt.resetRewardIsNotClaimed()},earnFrom:"DailyQuest"};codex.analytics.event(gt.DAILY_QUEST_GET_OLD_REWARD),pt.openScreen(Ge.REWARD_SCREEN,n)}},{key:"handleClickedStage",value:function(e,t){var n=parseInt(t);n<=dt.getCurrentStage()?this.updateShowQuest(n):pt.openScreen(Ge.NOTIFICATION_SCREEN,{message:"youNeedToCompleteThePreviousStageFirst."})}},{key:"updateTimerText",value:function(){var e=new Date,t=new Date(e);t.setHours(24,0,0,0);var n=Number(t)-Number(e),i=Math.floor(n/36e5),a=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3);this.timerTextLocalize.key="timeHms",this.timerTextLocalize.setParams([i>=10?i.toString():"0".concat(i),a>=10?a.toString():"0".concat(a),r>=10?r.toString():"0".concat(r)])}},{key:"debugFinishGame",value:function(){dt.finishGame(),this.updateDailyQuest()}},{key:"debugUseItem",value:function(){dt.useItem({HintItem:1,ShuffleItem:1}),this.updateDailyQuest()}},{key:"debugReachCombo",value:function(){for(var e=45;e>0;e--)dt.reachCombo(e);this.updateDailyQuest()}},{key:"debugResetQuest",value:function(){dt.getInstance().reset()}},{key:"debugReward",value:function(){var e=Math.floor(3*Math.random()),t=Math.floor(3*Math.random());0===e&&0===t&&(e=1);var n={items:[{item:lt.HINT,count:e},{item:lt.SHUFFLE,count:t}],watchAdsDoubleReward:!0,successCallback:function(){},chestId:Math.floor(3*Math.random()),earnFrom:"DebugInDailyQuest"};pt.openScreen(Ge.REWARD_SCREEN,n)}}]),l}(k)).prototype,"progressBar",[NW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HW=e(UW.prototype,"stages",[OW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),WW=e(UW.prototype,"taskBlocks",[BW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),VW=e(UW.prototype,"chests",[DW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),jW=e(UW.prototype,"timerText",[FW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qW=e(UW.prototype,"timerTextLocalize",[MW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zW=UW))||zW);g._RF.pop(),g._RF.push({},"91431DewwBPMpOM36EKcv0L","DailyRewardScreen",void 0);var sV,lV,uV,cV,hV,pV,dV,fV,yV,vV,gV,mV,bV,SV,wV,kV,TV,CV,EV,LV,xV,IV,AV,RV,PV,_V,NV,OV,BV,DV,FV,MV=m.ccclass,zV=m.disallowMultiple,UV=m.requireComponent,GV=m.property,HV=Ludex.Events,WV=codex,VV=WV.event;WV.language,ZW=MV("DailyRewardScreen"),XW=UV(Si),QW=GV(N),ZW($W=zV($W=XW((tV=e((eV=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"closeButtonComponent",tV,r(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("DailyRewardScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.enabled=!0)},e}return o(l,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.listenScreenEvents()}},{key:"listenScreenEvents",value:function(){VV.on(HV.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){VV.off(HV.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,pt.closeScreen(Ge.DAILY_REWARD_SCREEN)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"handleClaimReward",value:function(e,t){var n=QA.getDailyReward();if(n){var i=[];switch(n.type){case"shuffle":i.push({item:lt.SHUFFLE,count:n.value});break;case"hint":i.push({item:lt.HINT,count:n.value});break;case"both":i.push({item:lt.SHUFFLE,count:n.value}),i.push({item:lt.HINT,count:n.value});break;default:return void console.warn("Unknown reward type:",n.type)}console.log("DailyRewardScreen: Claiming reward",t);var a={items:i,watchAdsDoubleReward:!0,successCallback:function(){QA.logLoginReward()},chestId:t,earnFrom:"DailyReward",title:"dailyReward",description:"congratulations",openNextScreenImmediately:!0};pt.openScreen(Ge.REWARD_SCREEN,a),this.close()}}}]),l}(k)).prototype,"closeButtonComponent",[QW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$W=eV))||$W)||$W);g._RF.pop(),g._RF.push({},"97d2fR85BlEOLDYcm3Yt/sT","FreeItemScreen",void 0);var jV,qV,KV,YV,JV,ZV,XV,QV,$V,ej,tj=m.ccclass,nj=m.disallowMultiple,ij=m.requireComponent,aj=m.property,rj=Ludex.Events,oj=codex,sj=oj.event,lj=oj.language,uj=(sV=tj("ItemConfig"),lV=aj({type:lt,visible:!0,serializable:!0}),uV=aj({type:ae,visible:!0,serializable:!0}),sV((pV=e((hV=o((function e(){i(this,e),a(this,"itemEnum",pV,this),a(this,"title",dV,this),a(this,"description",fV,this),a(this,"spriteFrame",yV,this)}))).prototype,"itemEnum",[lV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return lt.HINT}}),dV=e(hV.prototype,"title",[aj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),fV=e(hV.prototype,"description",[aj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),yV=e(hV.prototype,"spriteFrame",[uV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cV=hV))||cV);vV=tj("FreeItemScreen"),gV=ij(Si),mV=aj(N),bV=aj(N),SV=aj(X),wV=aj(gh),kV=aj(X),TV=aj(gh),CV=aj(E),EV=aj(gh),LV=aj({type:uj,visible:!0,serializable:!0}),vV(xV=nj(xV=gV((AV=e((IV=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"closeButtonComponent",AV,r(e)),a(e,"adsButtonComponent",RV,r(e)),a(e,"titleLabel",PV,r(e)),a(e,"titleLocalize",_V,r(e)),a(e,"descriptionLabel",NV,r(e)),a(e,"descriptionLocalize",OV,r(e)),a(e,"itemSprite",BV,r(e)),a(e,"limitAdsLocalize",DV,r(e)),a(e,"itemConfigs",FV,r(e)),e.itemConfigsMap=new Map,e.itemScreenData=null,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("FreeItemScreen: screen not found");if(e.validateEventPayload(t)){e.closeButtonComponent.interactable=!0,e.adsButtonComponent.interactable=!0,e.enabled=!0;var n=t.screenData;e.itemScreenData=n;var i=e.itemScreenData.item,a=e.itemConfigsMap.get(i);if(a)if(lj.hasTextKey(a.title))if(lj.hasTextKey(a.description)){e.titleLocalize.key=a.title,e.descriptionLocalize.key=a.description,e.itemSprite.spriteFrame=a.spriteFrame;var r=0,o=1;e.itemScreenData.item===lt.HINT?(r=fg.getCurrentWatchedAds("hintItem"),o=fg.getMaxWatchedAds("hintItem")):e.itemScreenData.item===lt.SHUFFLE&&(r=fg.getCurrentWatchedAds("shuffleItem"),o=fg.getMaxWatchedAds("shuffleItem"));var s=o-r;0===s?e.limitAdsLocalize.node.active=!1:1===s?e.limitAdsLocalize.key="1AdLeftToday":(e.limitAdsLocalize.key="xAdsLeftToday",e.limitAdsLocalize.setParams([s.toString()]))}else console.error("Description localization not found for item: ".concat(a.description));else console.error("Title localization not found for item: ".concat(a.title));else console.error("No configuration found for item: ".concat(i))}},e}return o(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.initializeItemConfigs(),this.listenScreenEvents()}},{key:"initializeItemConfigs",value:function(){var e=this;this.itemConfigs.forEach((function(t){e.itemConfigsMap.set(t.itemEnum,t)}))}},{key:"listenScreenEvents",value:function(){sj.on(rj.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){sj.off(rj.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleCloseButton",value:function(){var e,t;this.close(),null===(e=this.itemScreenData)||void 0===e||null===(t=e.failCallback)||void 0===t||t.call(e)}},{key:"handleAdsButton",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="",e.t0=null===(t=this.itemScreenData)||void 0===t?void 0:t.item,e.next=e.t0===lt.HINT?4:e.t0===lt.SHUFFLE?6:8;break;case 4:return i="hintItem",e.abrupt("break",9);case 6:return i="shuffleItem",e.abrupt("break",9);case 8:console.warn("FreeItemScreen: Unknown item type: ".concat(null===(n=this.itemScreenData)||void 0===n?void 0:n.item));case 9:if(""!==i){e.next=12;break}return console.warn("FreeItemScreen: No item type set for ads watched: ".concat(null===(a=this.itemScreenData)||void 0===a?void 0:a.item)),e.abrupt("return");case 12:if(fg.canWatchAds(i)){e.next=15;break}return pt.showNotificationScreen("youHaveReachedTheDailyAdLimit"),e.abrupt("return");case 15:return this.adsButtonComponent.interactable=!1,e.next=18,je.showRewardVideoAdAsync();case 18:r=e.sent,this.adsButtonComponent.interactable=!0,r&&(fg.watchedAds(i),null===(o=this.itemScreenData)||void 0===o||null===(s=o.successCallback)||void 0===s||s.call(o),this.close());case 21:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.adsButtonComponent.interactable=!1,pt.closeScreen(Ge.FREE_ITEM_SCREEN)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),h}(k)).prototype,"closeButtonComponent",[mV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RV=e(IV.prototype,"adsButtonComponent",[bV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PV=e(IV.prototype,"titleLabel",[SV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_V=e(IV.prototype,"titleLocalize",[wV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NV=e(IV.prototype,"descriptionLabel",[kV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OV=e(IV.prototype,"descriptionLocalize",[TV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BV=e(IV.prototype,"itemSprite",[CV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DV=e(IV.prototype,"limitAdsLocalize",[EV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FV=e(IV.prototype,"itemConfigs",[LV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xV=IV))||xV)||xV);g._RF.pop(),g._RF.push({},"96b6dDX0+ROxZshPw4lH4vu","ItemWarnScreen",void 0);var cj,hj,pj,dj,fj,yj,vj,gj,mj,bj,Sj,wj=m.ccclass,kj=m.disallowMultiple,Tj=m.requireComponent,Cj=m.property,Ej=Ludex,Lj=Ej.Events,xj=Ej.Utils,Ij=codex,Aj=Ij.event,Rj=Ij.language;jV=wj("ItemWarnScreen"),qV=Tj(Si),KV=Cj(X),YV=Cj(gh),JV=Cj(N),jV(ZV=kj(ZV=qV((QV=e((XV=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"message",QV,r(e)),a(e,"messageLocalize",$V,r(e)),a(e,"touchZone",ej,r(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.touchZone.interactable=!0)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.touchZone.interactable=!1)},e}return o(l,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Aj.on(Lj.OPENING_SCREEN,this.handleOpeningScreen),Aj.on(Lj.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){Aj.off(Lj.OPENING_SCREEN,this.handleOpeningScreen),Aj.off(Lj.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;xj.Valid.isObject(t)?(t.message&&(Rj.hasTextKey(t.message)?this.messageLocalize.key=t.message:this.message.string=t.message),t.duration&&t.duration>0&&this.scheduleOnce((function(){pt.closeScreen(Ge.ITEM_WARN_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("ItemWarnScreen: screenData not found")}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),pt.closeScreen(Ge.ITEM_WARN_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),l}(k)).prototype,"message",[KV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$V=e(XV.prototype,"messageLocalize",[YV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ej=e(XV.prototype,"touchZone",[JV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZV=XV))||ZV)||ZV);g._RF.pop(),g._RF.push({},"50568ZMYxhP4KHgiMLmPvsE","Board",void 0);var Pj,_j,Nj,Oj,Bj,Dj,Fj,Mj=m.ccclass,zj=m.property,Uj=(cj=Mj("Board"),hj=zj(E),pj=zj(Ws),dj=zj(X),fj=zj(ae),cj((gj=e((vj=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"reward",gj,r(e)),a(e,"progressBar",mj,r(e)),a(e,"progressText",bj,r(e)),a(e,"boxes",Sj,r(e)),e}return o(l,[{key:"start",value:function(){}},{key:"updateCurrentLevel",value:function(e){var t,n=0,i=0,a=d(Lt.REWARD_LEVELS);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(e<=r){i=r;break}n=r}}catch(e){a.e(e)}finally{a.f()}if(0===i){this.progressBar.setProgress(1);var o=Lt.REWARD_LEVELS[Lt.REWARD_LEVELS.length-1];i=o,this.progressText.string="".concat(o," / ").concat(o)}else{var s=1===e?0:e-n-1==0?1:e-n-1,l=i-n;this.progressBar.setProgress(s/l),this.progressText.string="".concat(e-1," / ").concat(i)}var u=tt.getJourneyTheme(),c=tt.getRewardByLevel(i);"Badge"===c.type?(this.reward.spriteFrame=tt.getJourneyBadgeSpriteFrame(c.key,u),this.reward.node.scale=new F(.4,.4,1)):(this.reward.spriteFrame=this.boxes[c.chestIdx%this.boxes.length],this.reward.node.scale=new F(.4,.4,1))}}]),l}(k)).prototype,"reward",[hj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mj=e(vj.prototype,"progressBar",[pj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bj=e(vj.prototype,"progressText",[dj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sj=e(vj.prototype,"boxes",[fj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yj=vj))||yj);g._RF.pop(),g._RF.push({},"a7e827XyI5Fj5JbaKeVWP7D","Cloud",void 0);var Gj,Hj,Wj,Vj,jj,qj=m.ccclass,Kj=m.property,Yj=[-13.5,18,12.6,18,10.8,-11.7,-13.5,12.6,-15.3],Jj=(Pj=qj("Cloud"),_j=Kj(E),Nj=Kj(A),Pj((Dj=e((Bj=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"clouds",Dj,r(e)),a(e,"container",Fj,r(e)),e.isShowTweenRunning=!1,e.isHideTweenRunning=!1,e.isShowed=!1,e}return o(l,[{key:"onLoad",value:function(){var e=this;this.baseContainerPosition={x:this.container.position.x,y:this.container.position.y},this.runIdleAnimation();var t=this.baseContainerPosition,n=t.x,i=t.y;this.showTween=B(this.container).to(.8,{position:new F(n,i,0)}).call((function(){e.isShowTweenRunning=!1,e.isShowed=!0})),this.hideTween=B(this.container).to(.8,{position:new F(n,i+200,0)}).call((function(){e.isHideTweenRunning=!1,e.isShowed=!1,e.node.active=!1})),this.container.setPosition(new F(n,i+200,0))}},{key:"runIdleAnimation",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2.5,t=0;t<this.clouds.length;t++){var n=this.clouds[t],i=Yj[t%Yj.length],a=B(n.node).by(e,{position:new F(-i,0,0)}),r=B(n.node).by(e,{position:new F(i,0,0)});B(n.node).sequence(a,r).repeatForever().start()}}},{key:"show",value:function(){this.node.active=!0,this.isShowTweenRunning||(this.isHideTweenRunning&&(this.hideTween.stop(),this.isHideTweenRunning=!1,this.node.active=!0),this.isShowTweenRunning=!0,this.showTween.start())}},{key:"hide",value:function(){this.isHideTweenRunning||(this.isShowTweenRunning&&(this.showTween.stop(),this.isShowTweenRunning=!1),this.isHideTweenRunning=!0,this.hideTween.start())}},{key:"getIsShowed",value:function(){return this.isShowed}},{key:"setIsShowed",value:function(e){this.isShowed=e;var t=this.baseContainerPosition,n=t.x,i=t.y;e?this.container.setPosition(new F(n,i,0)):this.container.setPosition(new F(n,i+200,0))}}]),l}(k)).prototype,"clouds",[_j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fj=e(Bj.prototype,"container",[Nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oj=Bj))||Oj);g._RF.pop(),g._RF.push({},"bc488hBN4ZDNpqq3N+2yVdC","Reward",void 0);var Zj,Xj,Qj,$j,eq,tq,nq,iq,aq,rq,oq,sq,lq,uq,cq,hq,pq,dq,fq,yq,vq,gq=m.ccclass,mq=m.property,bq=(Gj=gq("Reward"),Hj=mq(P),Gj((jj=e((Vj=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"lockOpacity",jj,r(e)),e}return o(h,[{key:"onLoad",value:function(){this.sprite=this.getComponent(E)}},{key:"setRewardSprite",value:function(e,t){this.sprite.spriteFrame=e,this.lockOpacity.node.active=!t,this.lockOpacity.opacity=t?0:255,this.sprite.color=t?new D(255,255,255,255):new D(126,100,106,192),this.lockOpacity.node.setPosition(this.node.position)}},{key:"resetRewardSprite",value:function(){this.lockOpacity.node.active=!1}},{key:"runUnlockAnimation",value:(u=s(l().mark((function e(){var t,n,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,B(this.lockOpacity).delay(t).to(.3,{opacity:0},{easing:"cubicOut"}).start(),n=B(this.sprite).delay(t+.3).to(.3,{color:new D(255,255,255,255)},{easing:"cubicOut"}),e.next=5,Ve.runTweenAsync(n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"lockOpacity",[Hj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wj=Vj))||Wj);g._RF.pop(),g._RF.push({},"6082bwoGDhO+qG3N72ebY9K","JourneyLevelPath",void 0);var Sq,wq,kq,Tq,Cq,Eq,Lq,xq=m.ccclass,Iq=m.property,Aq=1100,Rq=232,Pq=(Zj=xq("JourneyLevelPath"),Xj=Iq(E),Qj=Iq(X),$j=Iq(E),eq=Iq(bq),tq=Iq(ae),nq=Iq(ae),iq=Iq(A),aq=Iq(A),rq=Iq(ae),Zj((lq=e((sq=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"sprites",lq,r(e)),a(e,"labels",uq,r(e)),a(e,"paths",cq,r(e)),e.glow=void 0,e.path=void 0,a(e,"reward",hq,r(e)),e.rewardTypes=[],a(e,"spriteFrames",pq,r(e)),a(e,"pathSpriteFrames",dq,r(e)),a(e,"levelNode",fq,r(e)),a(e,"pathContainer",yq,r(e)),a(e,"chests",vq,r(e)),e.isInitialized=!1,e}return o(h,[{key:"start",value:function(){this.init()}},{key:"init",value:function(){this.isInitialized||(this.isInitialized=!0)}},{key:"updateButtonLabel",value:function(e,t){this.isInitialized||this.init();var n,i=e.levels,a=e.useLastPath,r=e.currentLevel,o=d(this.paths);try{for(o.s();!(n=o.n()).done;){n.value.node.active=!1}}catch(e){o.e(e)}finally{o.f()}this.glow&&(this.glow.active=!1);var s,l=d(i);try{for(l.s();!(s=l.n()).done;){if(s.value===r&&this.glow){this.glow.active=!0;break}}}catch(e){l.e(e)}finally{l.f()}for(var u=0;u<this.sprites.length;u++){var c=this.sprites[u],h=this.labels[u],p=i[u],f=this.paths[u];u<i.length?(c.node.active=!0,h.node.active=!0,u>0&&(this.paths[u-1].node.active=!0),h.string=p.toString(),p>r?(c.spriteFrame=this.spriteFrames[0],h.color=new D(229,198,139,255)):p<r?(c.spriteFrame=this.spriteFrames[1],h.color=new D(244,220,160,255)):(c.spriteFrame=this.spriteFrames[2],h.color=new D(242,216,160,255),this.glow&&this.glow.setPosition(c.node.position)),p+1<=r?f.spriteFrame=this.pathSpriteFrames[1]:p+1>r&&(f.spriteFrame=this.pathSpriteFrames[0])):(c.node.active=!1,h.node.active=!1)}for(var y=0;y<this.labels.length;y++){var v=this.labels[y];v.node.parent=t;var g=this.sprites[y].node.position,m=this.node.position;v.node.setPosition(g.x+m.x,g.y+m.y+6,0)}this.sprites[this.sprites.length-1].node.active&&a&&(this.paths[this.paths.length-1].node.active=!0),this.reward.node.active=!1,this.reward.resetRewardSprite();for(var b=tt.getJourneyTheme(),S=0;S<i.length;S++)if(Lt.REWARD_LEVELS.includes(i[S])){this.reward.node.active=!0,this.reward.node.setPosition(this.sprites[S].node.position);var w=tt.getRewardByLevel(i[S]);if(this.rewardTypes[S]=w.type,"Badge"===w.type){var k=tt.getJourneyBadgeSpriteFrame(w.key,b);this.reward.setRewardSprite(k,i[S]<r),this.reward.node.scale=new F(1,1,1)}else"Chest"===w.type&&(this.reward.setRewardSprite(this.chests[w.chestIdx%this.chests.length],!0),this.reward.node.scale=new F(.6,.6,1));this.sprites[S].node.active=!1,this.labels[S].node.active=!1}else this.rewardTypes[S]=""}},{key:"setGlowNode",value:function(e){this.glow&&(this.glow.active=!1),this.glow=e,this.glow&&(this.glow.parent=this.levelNode,this.glow.setSiblingIndex(0))}},{key:"setPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.path=e,this.path){this.path.node.parent=this.pathContainer;var n=this.paths[t].node.position,i=n.x,a=n.y;switch(this.path.node.setPosition(i,a,0),this.path.setFlip(t%2==1),t){case 0:this.path.node.setScale(1,1),this.path.node.setRotationFromEuler(0,0,0);break;case 1:this.path.node.setScale(-1,-1),this.path.node.setRotationFromEuler(0,180,0);break;case 2:this.path.node.setScale(-1,1),this.path.node.setRotationFromEuler(0,0,0);break;case 3:this.path.node.setScale(1,-1),this.path.node.setRotationFromEuler(0,180,0)}}}},{key:"getLevelNode",value:function(e){if(e<0||e>=this.sprites.length)throw new Error("Index ".concat(e," is out of bounds for JourneyLevelPath"));return this.sprites[e]}},{key:"runRewardUnlockAnimation",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.reward.runUnlockAnimation());case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getRewardType",value:function(e){if(e<0||e>=this.rewardTypes.length)throw new Error("Index ".concat(e," is out of bounds for JourneyLevelPath"));return this.rewardTypes[e]}},{key:"setActive",value:function(e){this.node.active=e;var t,n=d(this.labels);try{for(n.s();!(t=n.n()).done;){t.value.node.active=e}}catch(e){n.e(e)}finally{n.f()}}}],[{key:"getItemRealSize",value:function(e){switch(e){case 1:return 404;case 2:return 636;case 3:return 868;default:return Aq}}},{key:"getLevelDistance",value:function(){return Rq}}]),h}(eu)).prototype,"sprites",[Xj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),uq=e(sq.prototype,"labels",[Qj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),cq=e(sq.prototype,"paths",[$j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hq=e(sq.prototype,"reward",[eq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pq=e(sq.prototype,"spriteFrames",[tq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),dq=e(sq.prototype,"pathSpriteFrames",[nq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fq=e(sq.prototype,"levelNode",[iq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yq=e(sq.prototype,"pathContainer",[aq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vq=e(sq.prototype,"chests",[rq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),oq=sq))||oq);g._RF.pop(),g._RF.push({},"28265fkxtVAeotmTwoPD/p/","LevelGlow",void 0);var _q,Nq,Oq,Bq,Dq,Fq,Mq,zq,Uq,Gq,Hq,Wq,Vq,jq,qq,Kq,Yq,Jq,Zq,Xq=m.ccclass,Qq=m.property,$q=Ludex.Utils.Signal,eK=(Sq=Xq("LevelGlow"),wq=Qq(P),kq=Qq(P),Sq((Eq=e((Cq=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"innerUiOpacity",Eq,r(e)),a(e,"outerUiOpacity",Lq,r(e)),e.signalController=new $q.SignalController,e.idleTweens=[],e}return o(l,[{key:"onEnable",value:function(){var e,t=d(this.idleTweens);try{for(t.s();!(e=t.n()).done;){e.value.resume()}}catch(e){t.e(e)}finally{t.f()}}},{key:"onDisable",value:function(){var e,t=d(this.idleTweens);try{for(t.s();!(e=t.n()).done;){e.value.pause()}}catch(e){t.e(e)}finally{t.f()}}},{key:"runIdleAnimation",value:function(){var e=this.signalController.renew();this.idleTweens=[];var t=B(this.innerUiOpacity).to(2,{opacity:180},{easing:"smooth"}).to(2,{opacity:255},{easing:"smooth"}).union(),n=B(this.innerUiOpacity.node).to(1,{scale:new F(.95,.95,.9)},{easing:"smooth"}).delay(.2).to(1,{scale:new F(1.05,1.05,1.1)},{easing:"smooth"}).delay(.2).union(),i=B(this.innerUiOpacity).set({opacity:0}).to(1,{opacity:255},{easing:"sineInOut"}).repeatForever(t),a=B(this.innerUiOpacity.node).set({scale:new F(.7,.7,1)}).to(1,{scale:new F(1,1,1)},{easing:"sineInOut"}).repeatForever(n),r=B(this.outerUiOpacity).set({opacity:128}).to(1.25,{opacity:255},{easing:"sineInOut"}).to(.25,{opacity:0},{easing:"sineIn"}).delay(.5).union(),o=B(this.outerUiOpacity.node).set({scale:new F(.3,.3,1)}).to(1.5,{scale:new F(1,1,1)},{easing:"sineInOut"}).delay(.5).union(),s=B(this.outerUiOpacity).set({opacity:200}).repeatForever(r),l=B(this.outerUiOpacity.node).set({scale:new F(.5,.5,1)}).repeatForever(o);Ve.runTweenAsync(i,e),Ve.runTweenAsync(a,e),Ve.runTweenAsync(s,e),Ve.runTweenAsync(l,e),this.idleTweens.push(i,s)}},{key:"resetAnimation",value:function(){this.signalController.abort(),this.idleTweens=[],this.node.setScale(1,1,1),this.innerUiOpacity.opacity=0,this.outerUiOpacity.opacity=0}},{key:"runCloseAnimation",value:function(){var e=this.signalController.renew();this.idleTweens=[];var t=B(this.innerUiOpacity).to(.2,{opacity:0},{easing:"smooth"}),n=B(this.outerUiOpacity).to(.2,{opacity:0},{easing:"smooth"});Ve.runTweenAsync(t,e),Ve.runTweenAsync(n,e)}}]),l}(k)).prototype,"innerUiOpacity",[wq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lq=e(Cq.prototype,"outerUiOpacity",[kq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tq=Cq))||Tq);g._RF.pop(),g._RF.push({},"8c01ejYEylAVrb+ubvjV2md","Path",void 0);var tK,nK=m.ccclass,iK=m.property,aK=Ludex.Utils.Signal,rK=241,oK=273,sK=220,lK=(_q=nK("Path"),Nq=iK(L),Oq=iK(L),Bq=iK(E),Dq=iK(E),Fq=iK(E),Mq=iK(ae),zq=iK(ae),Uq=iK(R),_q((Wq=e((Hq=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"mask1",Wq,r(e)),a(e,"mask2",Vq,r(e)),e.signalController=new aK.SignalController,a(e,"path0",jq,r(e)),a(e,"path1",qq,r(e)),a(e,"path2",Kq,r(e)),a(e,"unfinishedSpriteFrame",Yq,r(e)),a(e,"completedSpriteFrame",Jq,r(e)),a(e,"flip",Zq,r(e)),e}return o(h,[{key:"start",value:function(){this.updateSpriteFrame(),this.reset()}},{key:"setFlip",value:function(e){this.flip=e,this.updateSpriteFrame(),this.reset()}},{key:"updateSpriteFrame",value:function(){this.flip?(this.path0.spriteFrame=this.completedSpriteFrame,this.path1.spriteFrame=this.unfinishedSpriteFrame,this.path2.spriteFrame=this.unfinishedSpriteFrame):(this.path0.spriteFrame=this.unfinishedSpriteFrame,this.path1.spriteFrame=this.completedSpriteFrame,this.path2.spriteFrame=this.completedSpriteFrame)}},{key:"reset",value:function(){this.signalController.abort(),this.setUnfinished()}},{key:"runAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:.5,this.reset(),n=this.signalController.renew(),this.flip){e.next=12;break}return i=B(this.mask1).to(.5*t,{width:oK}),a=B(this.mask2).to(.5*t,{width:sK}),e.next=8,Ve.runTweenAsync(i,n);case 8:return e.next=10,Ve.runTweenAsync(a,n);case 10:e.next=18;break;case 12:return r=B(this.mask1).to(.5*t,{width:0}),o=B(this.mask2).to(.5*t,{width:0}),e.next=16,Ve.runTweenAsync(o,n);case 16:return e.next=18,Ve.runTweenAsync(r,n);case 18:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setUnfinished",value:function(){this.signalController.abort(),this.flip?(this.mask1.setContentSize(oK,rK),this.mask2.setContentSize(sK,rK)):(this.mask1.setContentSize(0,rK),this.mask2.setContentSize(0,rK))}},{key:"setCompleted",value:function(){this.signalController.abort(),this.flip?(this.mask1.setContentSize(0,rK),this.mask2.setContentSize(0,rK)):(this.mask1.setContentSize(oK,rK),this.mask2.setContentSize(sK,rK))}}]),h}(k)).prototype,"mask1",[Nq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vq=e(Hq.prototype,"mask2",[Oq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jq=e(Hq.prototype,"path0",[Bq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qq=e(Hq.prototype,"path1",[Dq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kq=e(Hq.prototype,"path2",[Fq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yq=e(Hq.prototype,"unfinishedSpriteFrame",[Mq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jq=e(Hq.prototype,"completedSpriteFrame",[zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zq=e(Hq.prototype,"flip",[Uq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Gq=Hq))||Gq);g._RF.pop(),g._RF.push({},"b29b2H0f5tNTbB9E3XZQDT3","JourneyFakeLevelPath",void 0);var uK,cK,hK,pK,dK,fK,yK,vK,gK,mK,bK,SK,wK,kK=m.ccclass,TK=(m.property,kK("JourneyFakeLevelPath")(tK=function(e){t(r,e);var a=n(r);function r(){return i(this,r),a.apply(this,arguments)}return o(r,[{key:"setData",value:function(e){this.setIdx(e.idx),this.payload=e}},{key:"setRealItem",value:function(e){p(h(r.prototype),"setRealItem",this).call(this,e)}},{key:"getRealItem",value:function(){return p(h(r.prototype),"getRealItem",this).call(this)}},{key:"getPayload",value:function(){return this.payload}}]),r}(kl))||tK);g._RF.pop(),g._RF.push({},"6a70avWsZdNlr0ZkpTsIhA6","JourneyReusableScroller",void 0);var CK,EK,LK,xK,IK,AK,RK,PK,_K,NK,OK,BK,DK,FK,MK,zK,UK,GK=m.ccclass,HK=m.property,WK=(uK=GK("JourneyReusableScroller"),cK=HK(eK),hK=HK(lK),pK=HK(A),dK=HK(A),fK=HK(gh),uK((gK=e((vK=function(e){t(f,e);var u,c,d=n(f);function f(){var e;i(this,f);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=d.call.apply(d,[this].concat(n)),a(e,"levelGlow",gK,r(e)),a(e,"path",mK,r(e)),a(e,"itemContainer",bK,r(e)),a(e,"labelContainer",SK,r(e)),a(e,"completedLabel",wK,r(e)),e}return o(f,[{key:"onLoad",value:function(){p(h(f.prototype),"onLoad",this).call(this),this.contentUITransform=this.content.getComponent(L),this.levelGlow.node.active=!1}},{key:"handleScrollerWhenResize",value:function(){var e=this.viewUITransform.contentSize.height,t=Math.ceil(e/(this.itemHeight+this.distanceBetweenItems)),n=this.maxRealItems-this.borderItems;if(!(t<=n)){this.maxRealItems=t+this.borderItems;for(var i=t-n+1,a=0;a<i;a++){var r=this.createRealItem();this.realItems.push(r);var o=this.distanceBetweenItems+this.itemHeight,s=new F(0,this.originalContentPosY+-1*(a*o+this.offsetBottom),0);r.node.setPosition(s),r.setActive(!1)}for(var l=0;l<this.fakeItems.length;l++){var u=this.fakeItems[l],c=this.realItems[l%this.maxRealItems];u.setRealItem(c)}this.refreshScroller()}}},{key:"createRealItems",value:function(){var e=this.isStartFromBottom?1:-1,t=e*this.itemHeight/2;if(this.maxRealItems-this.realItems.length<=0)for(var n=this.maxRealItems;n<this.realItems.length;n++){this.realItems[n].setActive(!1)}for(var i=this.realItems.length;i<this.maxRealItems;i++){var a=this.createRealItem();this.realItems.push(a);var r=this.distanceBetweenItems+this.itemHeight,o=new F(0,t+(i*r+this.offsetBottom)*e,0);a.node.setPosition(o),a.setActive(!1)}}},{key:"loadScroller",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e,i=0;if(t<=Lt.REWARD_1_LEVEL){n=[];for(var a=Lt.REWARD_1_LEVEL,r=0;r<e.length;r++)if(n.push(e[r]),r>1&&e[r-2].levels.includes(a)){var o=Pq.getItemRealSize(4);i=1.875*-o;break}}else if(t<=Lt.REWARD_2_LEVEL){n=[];for(var s=Lt.REWARD_2_LEVEL,l=0;l<e.length;l++)if(n.push(e[l]),l>0&&e[l-1].levels.includes(s)){var u=Pq.getItemRealSize(4);i=1.5*-u;break}}this.currentLevel=t,this.setUpBeforeLoadScroller(n,i),p(h(f.prototype),"loadScroller",this).call(this,n),this.payloads=e;var c=tt.checkJourneyComplete(),d=75,y=this.contentUITransform.height;this.completedLabel.node.active=c,this.completedLabel.node.setPosition(0,y-this.getOffsetHeader()-d,0)}},{key:"setUpBeforeLoadScroller",value:function(e,t){var n=this.viewUITransform.height,i=e[e.length-1],a=Pq.getItemRealSize(i.levels.length),r=Pq.getItemRealSize(4),o=tt.checkJourneyComplete()?280:0,s=.5*-n-this.distanceBetweenItems+a-r+0+o+t,l=.5*-n+230+150;this.setOffsetHeader(s),this.setOffsetBottom(l)}},{key:"reloadScroller",value:function(){var e=this.content.position.y,t=this.payloads;void 0!==this.payloads&&0!==this.payloads.length&&(this.loadScroller(t,this.currentLevel),this.scroller.scrollToTargetY(e),this.handleDiscreteScroll())}},{key:"createRealItem",value:function(){var e=K(this.itemPrefab);return this.itemContainer.addChild(e),e.getComponent(Pq)}},{key:"createFakeItem",value:function(e){
//! temporary
var t=new TK;return t.setData(e),t}},{key:"updateFakeItems",value:function(e){for(var t=0;t<e.length;t++){this.fakeItems[t].setData(e[t])}}},{key:"updateScrollItems",value:function(e){this.currentLevelPath=void 0,this.currentLevelIndex=-1;for(var t=0;t<e.length;t++){var n=e[t],i=e[t-1];this.updateRealItem(n,i)}}},{key:"updateRealItem",value:function(e,t){var n=e.getPosition(),i=e.getRealItem();i.setActive(e.getActive()),i.node.setPosition(n);var a=e.getPayload(),r=a.levels,o=a.useLastPath,s=this.currentLevel,l=r.indexOf(s);-1!==l?(i.setGlowNode(this.levelGlow.node),this.currentLevelPath=i,this.currentLevelIndex=l,l>0?i.setPath(this.path,l-1):t&&t.getRealItem().setPath(this.path,r.length-1)):(i.setGlowNode(void 0),i.setPath(void 0));i.updateButtonLabel({levels:r,useLastPath:o,currentLevel:s},this.labelContainer),this.itemContainer.removeChild(i.node),this.itemContainer.addChild(i.node)}},{key:"scrollToTargetLevel",value:function(e){var t=-Pq.getLevelDistance()*(e-2);this.scroller.scrollToTargetY(t),this.refreshScroller()}},{key:"scrollToTargetLevelAsync",value:(c=s(l().mark((function e(t){var n,i,a,r,o=this,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:0,i=!(s.length>2&&void 0!==s[2])||s[2],!(t>tt.getLevelCount())){e.next=4;break}return e.abrupt("return");case 4:return a=Pq.getLevelDistance(),r=-a*(t-2),e.abrupt("return",new Promise((function(e){if(0===n)return o.scrollToTargetLevel(t),void e();i&&o.scroller&&o.scroller.setFreeControl(!0);var a=o.content.position.y,s=B({value:a}).to(n,{value:r},{onUpdate:function(e){o.scroller&&(o.scroller.scrollToTargetY(e.value),o.refreshScroller())}});Ve.runTweenAsync(s).then((function(){i&&o.scroller&&o.scroller.setFreeControl(!1),e()}))})));case 7:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"getDistanceToTop",value:function(){var e=this.content.position.y,t=-this.contentUITransform.height;return Math.abs(t-e)}},{key:"getCurrentScrollPercentValue",value:function(){var e=this.content.position.y,t=-this.contentUITransform.height;return 0===t?(console.warn("JourneyReusableScroller: minScrollValue and maxScrollValue are equal."),0):(e-0)/(t-0)}},{key:"prepareRunAnimation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.levelGlow.resetAnimation(),this.path.node.active=!0,e&&this.lockScroll()}},{key:"runCloseAnimation",value:function(){this.levelGlow.runCloseAnimation()}},{key:"runAnimationNextLevel",value:(u=s(l().mark((function e(){var t,n,i=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt(100);case 2:return e.next=4,this.path.runAnimation().then((function(){i.path.node.active=!1}));case 4:return t=this.currentLevelPath.getLevelNode(this.currentLevelIndex),n=B(t.node).to(.15,{scale:new F(.9,.9,.9)},{easing:"sineInOut"}).to(.2,{scale:new F(1.1,1.1,1.1)},{easing:"sineInOut"}).to(.15,{scale:new F(1,1,1)},{easing:"sineInOut"}),e.next=8,Ve.runTweenAsync(n);case 8:return this.runIdleAnimation(),e.next=11,kt(200);case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"runIdleAnimation",value:function(){switch(this.currentLevelPath.getRewardType(this.currentLevelIndex)){case"Badge":this.levelGlow.node.scale=new F(1.8,1.8,1);break;case"Chest":this.levelGlow.node.scale=new F(1.4,1.4,1);break;default:this.levelGlow.node.scale=new F(1,1,1)}this.levelGlow.runIdleAnimation()}},{key:"lockScroll",value:function(){this.scroller.setFreeControl(!0)}},{key:"unlockScroll",value:function(){this.scroller.setFreeControl(!1)}},{key:"getCurrentLevelPath",value:function(){return this.currentLevelPath}},{key:"setCurrentLevel",value:function(e){this.currentLevel=e;var t=this.getVisibleFakeItems();this.updateScrollItems(t)}}]),f}(iu)).prototype,"levelGlow",[cK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mK=e(vK.prototype,"path",[hK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bK=e(vK.prototype,"itemContainer",[pK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SK=e(vK.prototype,"labelContainer",[dK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wK=e(vK.prototype,"completedLabel",[fK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yK=vK))||yK);g._RF.pop(),g._RF.push({},"6a55dE439JNFYG8U7LV2mMb","JourneyLevelScreen",void 0);var VK,jK,qK=m.ccclass,KK=m.property,YK=(m.requireComponent,Ludex),JK=YK.Events,ZK=(YK.Utils,codex),XK=(ZK.player,ZK.event);CK=qK("JourneyLevelScreen"),EK=KK(WK),LK=KK(Uj),xK=KK(Jj),IK=KK(gh),AK=KK(N),RK=KK(N),PK=KK(E),CK((OK=e((NK=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"reusableScroller",OK,r(e)),a(e,"board",BK,r(e)),a(e,"cloud",DK,r(e)),a(e,"timerText",FK,r(e)),a(e,"buttons",MK,r(e)),a(e,"playButton",zK,r(e)),a(e,"footerSprite",UK,r(e)),e.disableInteraction=function(){var t,n=d(e.buttons);try{for(n.s();!(t=n.n()).done;){t.value.interactable=!1}}catch(e){n.e(e)}finally{n.f()}},e.loadJourneyData=function(t){for(var n=tt.getLevelCount(),i=t||tt.getCurrentLevel(),a=[],r=1;r<=n;r+=4){for(var o=[r],s=1;s<4&&r+s<=n;s++)o.push(r+s);a.push({idx:r,levels:o,useLastPath:r+4<=n})}e.reusableScroller.loadScroller(a,i);var l=tt.checkJourneyComplete();e.board.node.active=!l,e.board.updateCurrentLevel(tt.getCurrentLevel())},e.loadFooter=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",tt.loadJourneyFooterSpriteFrame());case 1:case"end":return e.stop()}}),e)}))),e.updateFooter=function(){var t=tt.getJourneyFooterSpriteFrame();t?e.footerSprite.spriteFrame=t:e.loadFooter().then((function(){var t=tt.getJourneyFooterSpriteFrame();e.footerSprite.spriteFrame=t}))},e.updateJourneyTime=function(){var t=tt.getJourneyEndTime();e.timerText.key=t.key,e.timerText.setParams(t.params),t.remainingTime<=0&&e.handleClose()},e.updateShowHideCloud=function(){var t=e.reusableScroller.getDistanceToTop(),n=Pq.getItemRealSize(4),i=e.cloud.getIsShowed();t<=.25*n?i||e.cloud.show():i&&e.cloud.hide()},e.handleOpenedScreen=function(){var t=s(l().mark((function t(n){var i,a,r,o,s,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(n)){t.next=2;break}return t.abrupt("return");case 2:if(r=e.screen.data,o=null==r||null===(i=r.customData)||void 0===i?void 0:i.rewardType,s=e.getShowLevel(o),u=null==r||null===(a=r.customData)||void 0===a?void 0:a.useNextLevelAnimation,e.preloadLevel(),e.loadJourneyData(s),e.updateJourneyTime(),e.updateFooter(),e.updatePlayButton(),e.schedule(e.updateJourneyTime,1),e.cloud.node.active=!1,e.cloud.setIsShowed(!1),e.schedule(e.updateShowHideCloud,.5),e.reusableScroller.scrollToTargetLevel(s),u&&e.reusableScroller.prepareRunAnimation(),!o||o===Pt.CHEST){t.next=37;break}return e.reusableScroller.path.node.active=!1,e.board.node.active=!0,t.next=22,pt.openScreenAndWaitForClose(Ge.BADGE_REWARD_SCREEN,{source:Ge.JOURNEY_LEVEL_SCREEN,customData:{theme:tt.getJourneyTheme(),key:o,isReward:!0}});case 22:return t.next=24,e.reusableScroller.getCurrentLevelPath().runRewardUnlockAnimation();case 24:if(e.reusableScroller){t.next=26;break}return t.abrupt("return");case 26:return e.reusableScroller.setCurrentLevel(s+1),e.reusableScroller.reloadScroller(),e.reusableScroller.path.node.active=!tt.checkJourneyComplete(),t.next=31,e.reusableScroller.scrollToTargetLevelAsync(s+1,1,!1);case 31:if(e.reusableScroller){t.next=33;break}return t.abrupt("return");case 33:return e.runScrollerAnimation(u),e.screen.data.customData.rewardType=void 0,e.runBoardAnimation(),t.abrupt("return");case 37:e.checkShowBoard(),e.screen.animation?e.screen.animation.once(b.EventType.FINISHED,(function(){e.runScrollerAnimation(u)})):e.runScrollerAnimation(u);case 39:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.disableInteraction(),e.unschedule(e.updateJourneyTime),e.unschedule(e.updateShowHideCloud),e.reusableScroller.runCloseAnimation())},e.isBoardAnimRunning=!1,e}return o(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),tt.getJourneyFooterSpriteFrame()||this.screen.addPreloadPromise(tt.loadJourneyFooterSpriteFrame)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"enableInteraction",value:function(){var e,t=d(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}}},{key:"updatePlayButton",value:function(){var e=tt.checkJourneyComplete();this.playButton.node.active=!e}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){XK.on(JK.OPENED_SCREEN,this.handleOpenedScreen),XK.on(JK.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){XK.off(JK.OPENED_SCREEN,this.handleOpenedScreen),XK.off(JK.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"preloadLevel",value:function(){Pe.isPrefabLoaded(Ze.JOURNEY_BLOCK_PREFAB)||Pe.preloadPrefab(Ze.JOURNEY_BLOCK_PREFAB);var e=tt.getJourneyTheme();tt.isLoadedCurrentJourneyTileTheme()||Pe.preloadSpriteFramesDir("".concat(Ze.TILE_PREFIX).concat(e,"/"));var t=tt.getCurrentMission().gameLevel;nt.hasLevelData(t)||nt.preloadLevelDataAsync(t)}},{key:"getShowLevel",value:function(e){return void 0===e||e===Pt.CHEST?tt.getCurrentLevel():tt.getCurrentLevel()-1}},{key:"runScrollerAnimation",value:function(e){var t,n=this;this.reusableScroller&&(tt.checkJourneyComplete()?(this.reusableScroller.unlockScroll(),this.enableInteraction()):e?this.reusableScroller.runAnimationNextLevel().then((function(){n.reusableScroller.unlockScroll(),n.enableInteraction()})):(this.reusableScroller.runIdleAnimation(),this.reusableScroller.unlockScroll(),this.enableInteraction()),null!==(t=this.screen.data)&&void 0!==t&&t.customData&&(this.screen.data.customData.useNextLevelAnimation=void 0))}},{key:"scrollToTargetLevel",value:function(e){this.reusableScroller.scrollToTargetLevel(e)}},{key:"processIncreaseLevel",value:function(){this.loadJourneyData(tt.getCurrentLevel()),this.scrollToTargetLevel(tt.getCurrentLevel()),this.reusableScroller.prepareRunAnimation(!1),this.reusableScroller.runAnimationNextLevel(),this.reusableScroller.scrollToTargetLevel(tt.getCurrentLevel()),this.updatePlayButton()}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.disableInteraction(),pt.closeScreen(Ge.JOURNEY_LEVEL_SCREEN)}},{key:"handleClose",value:function(){this.close()}},{key:"handleClickedPlay",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!tt.checkJourneyComplete()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,je.showInterstitialAdAsync();case 4:this.processPlayLevel();case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedBadge",value:function(){this.disableInteraction(),pt.closeScreen(Ge.JOURNEY_LEVEL_SCREEN,{openNextScreenImmediately:!0}),pt.openScreen(Ge.BADGES_SCREEN,{preloadCallback:tt.isNeedClaimedBadges()?tt.loadClaimedBadges:void 0,source:Ge.JOURNEY_LEVEL_SCREEN})}},{key:"processPlayLevel",value:function(){var e,t;this.close(),(null===(e=codex.match.getMatchState())||void 0===e?void 0:e.mode)!==Ty.CHALLENGE_FRIEND&&(null===(t=codex.match.getMatchState())||void 0===t?void 0:t.mode)!==Ty.TOURNAMENT||rt.switchToSoloContext();var n=tt.getCurrentMission();nt.setLevel(n.gameLevel),rt.switchToJourney(tt.getSeason(),tt.getCurrentLevel()),tt.logJourneyStartLevel(),this.node.scene.emit($e.SWITCH_SCENE,(function(){Tt.switchToGameScene()}))}},{key:"checkShowBoard",value:function(){var e=tt.checkJourneyComplete();this.board.node.active=!e}},{key:"runBoardAnimation",value:(u=s(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tt.checkJourneyComplete()){e.next=3;break}return e.abrupt("return");case 3:if(!this.isBoardAnimRunning){e.next=5;break}return e.abrupt("return");case 5:return t={x:this.board.node.position.x,y:this.board.node.position.y,z:this.board.node.position.z},this.board.node.active=!0,this.isBoardAnimRunning=!0,n=B(this.board.node).by(1,{position:new F(0,300,0)},{easing:"sineInOut"}),e.next=11,Ve.runTweenAsync(n);case 11:this.board.node.active=!1,this.board.node.setPosition(t.x,t.y,t.z),this.isBoardAnimRunning=!1;case 14:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(k)).prototype,"reusableScroller",[EK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BK=e(NK.prototype,"board",[LK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DK=e(NK.prototype,"cloud",[xK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FK=e(NK.prototype,"timerText",[IK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MK=e(NK.prototype,"buttons",[AK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zK=e(NK.prototype,"playButton",[RK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UK=e(NK.prototype,"footerSprite",[PK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_K=NK));g._RF.pop(),g._RF.push({},"585cahdAERGxYwNU78vFNP0","JourneyBackground",void 0);var QK,$K,eY,tY,nY,iY=m.ccclass,aY=(m.property,Ludex),rY=(aY.Utils.Decorator,aY.Events),oY=codex.event,sY=Be.Layout,lY=(u(VK={},sY.Portrait,{width:1080,height:2164}),u(VK,sY.Landscape,{width:2732,height:1583}),VK);iY("JourneyBackground")(jK=function(e){t(c,e);var a,r,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ue[Ge.JOURNEY_LEVEL_SCREEN]&&(e.updateBackgroundSprite(),x.on(_e.VIEW_RESIZED,e.handleViewResized))},e.unlistenGameEvents=function(t){t.screenName===Ue[Ge.JOURNEY_LEVEL_SCREEN]&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),this.additionalBgUITransform=this.additionalBg.getComponent(L),Re.validateRequiredProperties(this),oY.on(rY.OPENING_SCREEN,this.listenGameEvents.bind(this)),oY.on(rY.CLOSING_SCREEN,this.unlistenGameEvents.bind(this)),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Oe.getCurrentLayout()===Be.Layout.Landscape){var e=Oe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Oe.getCurrentLayoutBackgroundByKey("Journey")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Oe.getCurrentLayoutBackgroundByKey("Journey"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(r=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentJourneyBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getLandscapeBackground",value:(a=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return lY}}]),c}(Ai));g._RF.pop(),g._RF.push({},"90686rQlWtIubUa0oXgaXsR","JourneyHeaderResponsiveNode",void 0);var uY,cY,hY,pY,dY,fY=m.ccclass,yY=m.property;QK=fY("JourneyHeaderResponsiveNode"),$K=yY(L),QK((nY=e((tY=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"headerBackground",nY,r(e)),e}return o(l,[{key:"updateObjectInLayoutPortrait",value:function(){this.updateHeaderWidth()}},{key:"updateObjectInLayoutLandscape",value:function(){this.updateHeaderWidth()}},{key:"updateHeaderWidth",value:function(){if(this.headerBackground){var e=I.getVisibleSize().width,t=this.headerBackground.width,n=this.headerBackground.node.scale;this.headerBackground.node.setScale(new F(e/t,n.y,n.z))}}}]),l}(fl)).prototype,"headerBackground",[$K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eY=tY));g._RF.pop(),g._RF.push({},"4abfdFWrXhCSLEiS2+715nt","JourneyResponsiveNode",void 0);var vY,gY,mY,bY,SY,wY,kY,TY,CY,EY,LY,xY,IY,AY,RY,PY,_Y,NY,OY,BY=m.ccclass,DY=m.property;uY=BY("JourneyResponsiveNode"),cY=DY(WK),uY((dY=e((pY=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"reusableScroller",dY,r(e)),e}return o(l,[{key:"onLoad",value:function(){p(h(l.prototype),"onLoad",this).call(this)}},{key:"updateObjectInLayoutPortrait",value:function(){var e=this;kt(10).then((function(){e.reusableScroller.reloadScroller()}))}},{key:"updateObjectInLayoutLandscape",value:function(){var e=this;kt(10).then((function(){e.reusableScroller.reloadScroller()}))}}]),l}(fl)).prototype,"reusableScroller",[cY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hY=pY));g._RF.pop(),g._RF.push({},"7bae0CCow1MC4qjZB1mb85q","JourneyProgressBar",void 0);var FY,MY,zY,UY,GY,HY,WY,VY=m.ccclass,jY=m.property,qY=-254.5,KY=Ludex.Utils.Time,YY=(vY=VY("JourneyProgressBar"),gY=jY(E),mY=jY(A),bY=jY(P),SY=jY(E),wY=jY(P),kY=jY(ae),TY=jY(N),CY=jY([ae]),vY((xY=e((LY=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"progressBar",xY,r(e)),a(e,"progressFillTail",IY,r(e)),a(e,"glowOpacity",AY,r(e)),a(e,"icon",RY,r(e)),a(e,"popup",PY,r(e)),a(e,"chestSpriteFrame",_Y,r(e)),a(e,"rewardButtonComponent",NY,r(e)),a(e,"iconSpriteFrames",OY,r(e)),e.iconInitialPosition=new F(0,0,0),e.currentTimeout=void 0,e}return o(p,[{key:"onLoad",value:function(){this.iconInitialPosition=this.icon.node.position.clone(),this.hideReachTargetAnimation(),this.progressFillTail.setPosition(new F(qY,0,0)),this.popup.opacity=0}},{key:"showPopup",value:function(){var e=this;this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0);var t=this.node.parent;t&&this.node.setSiblingIndex(t.children.length-1);B(this.popup).to(.2,{opacity:255},{easing:"sineInOut"}).start(),this.currentTimeout=setTimeout((function(){e.hidePopup()}),1700)}},{key:"hidePopup",value:function(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0),this&&this.popup&&(this.popup.opacity=0)}},{key:"runFillAnimation",value:(c=s(l().mark((function e(t,n){var i,a,r,o=this,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:0,a=function(e){o.progressFillTail.setPosition(new F(505*e.fillRange+qY,0,0))},this.progressFillTail.setPosition(new F(505*t+qY,0,0)),r=B(this.progressBar).set({fillRange:t}).delay(i).to(.5,{fillRange:n},{easing:"cubicInOut",onUpdate:function(e){a(e)}}).call((function(){o.progressBar.fillRange=n,o.progressFillTail.setPosition(new F(505*n+qY,0,0))})),e.next=6,Ve.runTweenAsync(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"runReachTargetAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rewardButtonComponent.interactable=!1,t=B(this.glowOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),n=B(this.glowOpacity.node).set({scale:new F(0,0,1)}).to(.3,{scale:new F(1,1,1)},{easing:"backOut"}),i=B(this.icon.node).to(.2,{scale:new F(1.2,.8,1)},{easing:"cubicIn"}).to(.3,{scale:new F(.8,1.2,1)},{easing:"cubicOut"}).to(.2,{scale:new F(1,1,1)},{easing:"cubicInOut"}).delay(.1).to(.1,{scale:new F(1.1,.9,1)},{easing:"cubicIn"}).to(.1,{scale:new F(1,1,1)},{easing:"cubicInOut"}),a=B(this.icon.node).to(.2,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y-10,0)},{easing:"cubicInOut"}).to(.4,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+45,0)},{easing:"sineOut"}).to(.3,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"sineIn"}).to(.1,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+10,0)},{easing:"cubicInOut"}).to(.1,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"cubicInOut"}),B(this.glowOpacity.node).set({angle:0}).by(2,{angle:360},{easing:"linear"}).start(),(r=[]).push(Ve.runTweenAsync(t)),r.push(Ve.runTweenAsync(i)),r.push(Ve.runTweenAsync(n)),r.push(Ve.runTweenAsync(a)),e.next=13,Promise.all(r);case 13:return e.next=15,KY.sleepAsync(200);case 15:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"hideReachTargetAnimation",value:function(){this.glowOpacity.opacity=0,this.glowOpacity.node.setScale(new F(0,0,1)),this.glowOpacity.node.setRotationFromEuler(0,0,0),this.icon.node.setScale(new F(1,1,1)),this.icon.node.setPosition(this.iconInitialPosition)}},{key:"updateRewardIcon",value:function(e,t){var n=0;switch(tt.getJourneyTheme()){case At.CHERRY_BLOSSOM:n=0;break;case At.SPRING_DOLLS:n=1;break;case At.TEA_CEREMONY:n=2;break;case At.HALLOWEEN:n=3;break;case At.THANKSGIVING:n=4;break;default:n=0}switch(e){case Pt.BADGE_1:this.icon.spriteFrame=this.iconSpriteFrames[3*n],this.rewardButtonComponent.interactable=!1;break;case Pt.BADGE_2:this.icon.spriteFrame=this.iconSpriteFrames[3*n+1],this.rewardButtonComponent.interactable=!1;break;case Pt.BADGE_3:this.icon.spriteFrame=this.iconSpriteFrames[3*n+2],this.rewardButtonComponent.interactable=!1;break;case Pt.CHEST:return this.icon.spriteFrame=this.chestSpriteFrame,void(this.rewardButtonComponent.interactable=!0);default:return console.warn("Unknown reward type:",e),void(this.icon.spriteFrame=this.chestSpriteFrame)}this.icon.color=t?new D(255,255,255,255):new D(126,100,106,255)}}]),p}(k)).prototype,"progressBar",[gY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IY=e(LY.prototype,"progressFillTail",[mY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AY=e(LY.prototype,"glowOpacity",[bY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RY=e(LY.prototype,"icon",[SY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PY=e(LY.prototype,"popup",[wY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_Y=e(LY.prototype,"chestSpriteFrame",[kY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NY=e(LY.prototype,"rewardButtonComponent",[TY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OY=e(LY.prototype,"iconSpriteFrames",[CY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),EY=LY))||EY);g._RF.pop(),g._RF.push({},"49c0fiP0wtDuadHzTJFM2Af","NextJourneyLevelButton",void 0);var JY,ZY,XY,QY,$Y,eJ,tJ,nJ,iJ,aJ,rJ,oJ,sJ,lJ,uJ,cJ,hJ,pJ,dJ,fJ,yJ,vJ,gJ,mJ,bJ,SJ,wJ,kJ,TJ=m.ccclass,CJ=m.property,EJ=(FY=TJ("NextJourneyLevelButton"),MY=CJ(X),zY=CJ(gh),FY((HY=e((GY=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"levelText",HY,r(e)),a(e,"levelTextLocalize",WY,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.levelText)throw new Error("NextLevelButton requires a Label component in levelText.");if(!this.levelTextLocalize)throw new Error("NextLevelButton requires a Localize component in levelTextLocalize.")}},{key:"updateLevelText",value:function(e,t){this.levelText.string="".concat(t," ").concat(e),this.levelTextLocalize.key="levelV",this.levelTextLocalize.setParams([e.toString()])}},{key:"updateText",value:function(e){this.levelTextLocalize.key=e}}]),l}(k)).prototype,"levelText",[MY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WY=e(GY.prototype,"levelTextLocalize",[zY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UY=GY))||UY);g._RF.pop(),g._RF.push({},"b661aAXvHhMyqpoXrScxe5E","JourneyWinningScreen",void 0);var LJ,xJ,IJ,AJ,RJ,PJ,_J,NJ=m.ccclass,OJ=m.property,BJ=m.disallowMultiple,DJ=m.requireComponent,FJ=(m.executeInEditMode,Ludex),MJ=FJ.Events,zJ=FJ.Plugins.Analytics.Events.SHARE,UJ=FJ.Configs.FrameCapture.Enabled,GJ=codex,HJ=GJ.player,WJ=GJ.event,VJ=(GJ.language,GJ.analytics),jJ=GJ.frameCapture;JY=NJ("JourneyWinningScreen"),ZY=DJ(Si),XY=OJ(E),QY=OJ(gh),$Y=OJ(EJ),eJ=OJ(N),tJ=OJ(N),nJ=OJ(N),iJ=OJ(YY),aJ=OJ(gh),rJ=OJ(gh),oJ=OJ(ee),sJ=OJ(ee),lJ=OJ(ee),JY(uJ=BJ(uJ=ZY((hJ=e((cJ=function(e){t(f,e);var u,c,h,p,d=n(f);function f(){var e;i(this,f);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=d.call.apply(d,[this].concat(n)),a(e,"titleRibbon",hJ,r(e)),a(e,"titleLabel",pJ,r(e)),a(e,"nextLevelButton",dJ,r(e)),a(e,"shareButtonComponent",fJ,r(e)),a(e,"nextLevelButtonComponent",yJ,r(e)),a(e,"returnButtonComponent",vJ,r(e)),a(e,"rewardProgressBar",gJ,r(e)),a(e,"progressTextLocalize",mJ,r(e)),a(e,"commentTextLocalize",bJ,r(e)),a(e,"firelightParticleSystem",SJ,r(e)),a(e,"blossomParticleSystem",wJ,r(e)),a(e,"blossomParticleSystem2",kJ,r(e)),e.handleOpeningScreen=function(t){var n,i;if(!e.screen)throw new Error("JourneyWinningScreen: screen not found");e.validateEventPayload(t)&&(e.firelightParticleSystem.node.active=!0,e.screen.data.level=(null==t||null===(n=t.screenData)||void 0===n?void 0:n.level)||1,e.screen.data.score=(null==t||null===(i=t.screenData)||void 0===i?void 0:i.score)||0,e.open())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.firelightParticleSystem.resetSystem(),e.blossomParticleSystem.resetSystem(),e.blossomParticleSystem2.resetSystem())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.firelightParticleSystem.stopSystem(),e.blossomParticleSystem.stopSystem(),e.blossomParticleSystem2.stopSystem())},e}return o(f,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){WJ.on(MJ.OPENING_SCREEN,this.handleOpeningScreen),WJ.on(MJ.OPENED_SCREEN,this.handleOpenedScreen),WJ.on(MJ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){WJ.off(MJ.OPENING_SCREEN,this.handleOpeningScreen),WJ.off(MJ.OPENED_SCREEN,this.handleOpenedScreen),WJ.off(MJ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){Me.playSound(ze.HAND_CLAP),this.processJourneyFlow()}},{key:"processJourneyFlow",value:function(){this.titleLabel.key="wonderful",this.commentTextLocalize.key="observeCarefully",this.progressTextLocalize.key="levelV",this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!0,this.rewardProgressBar.node.active=!0,this.nextLevelButton.updateText("next");var e=tt.getCompletedLevel(),t=tt.getCurrentRewardLevel(!1),n=tt.getCurrentRewardType(t),i=(e-1)/t,a=e/t;this.progressTextLocalize.setParams(["".concat(e,"/").concat(t)]);var r=e===t;this.rewardProgressBar.updateRewardIcon(n,r),r?this.processJourneyRewardFlow(i,a):this.processJourneyNormalFlow(i,a)}},{key:"processJourneyRewardFlow",value:(p=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.node.active=!1,this.shareButtonComponent.node.active=!1,this.returnButtonComponent.node.active=!1,e.next=5,this.rewardProgressBar.runFillAnimation(t,n,.5);case 5:return e.next=7,this.rewardProgressBar.runReachTargetAnimation();case 7:if((i=tt.getCurrentRewardType(tt.getCurrentRewardLevel(!1)))!==Pt.CHEST){e.next=11;break}return e.next=11,this.openRewardScreen();case 11:Tt.switchToDashboardScene({screen:Ge.JOURNEY_LEVEL_SCREEN,screenData:{customData:{completedLevel:tt.getCompletedLevel(),rewardType:i,useNextLevelAnimation:!0},openAnimationName:"FadeInInstant"}});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"processJourneyNormalFlow",value:(h=s(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.interactable=!0,this.shareButtonComponent.interactable=!0,this.returnButtonComponent.interactable=!0,e.next=5,this.rewardProgressBar.runFillAnimation(t,n,.5);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"close",value:function(){this.nextLevelButtonComponent.interactable=!1,this.shareButtonComponent.interactable=!1,this.firelightParticleSystem.node.active=!1,pt.closeScreen(Ge.JOURNEY_WINNING_SCREEN)}},{key:"handleClickedNextLevel",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=tt.canUpdateIncreaseSeason(),e.next=3,je.showInterstitialAdAsync();case 3:t?Tt.switchToDashboardScene():this.goToNextLevel(),this.close();case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedReturn",value:function(){tt.canUpdateIncreaseSeason()?Tt.switchToDashboardScene():Tt.switchToDashboardScene({screen:Ge.JOURNEY_LEVEL_SCREEN,screenData:{completedLevel:tt.getCompletedLevel(),customData:{useNextLevelAnimation:!0},openAnimationName:"FadeInInstant"}}),this.close()}},{key:"handleClickedRetry",value:function(){this.close(),this.node.scene.emit($e.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close();var e=this.screen.data.level;this.node.scene.emit($e.NEXT_LEVEL,{level:e})}},{key:"handleClickedShare",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.extra||!("shareAsync"in GameSDK.extra)){e.next=20;break}if(pt.showLoadingScreen(),e.prev=2,n=HJ.getPlayer(),i=n.playerId,a=n.name,r=n.photo,n.data,o=nt.getPlayerLevel(),s="",!UJ){e.next=10;break}return e.next=9,jJ.wideframe.renderShareScore({playerId:i,playerPhoto:r,playerScore:o});case 9:s=e.sent;case 10:return e.next=12,GameSDK.extra.shareAsync({text:"Woohoo! I've never gone this far before!",intent:"SHARE",image:null!==(t=s)&&void 0!==t?t:"",data:{playerId:i,playerName:a,playerPhoto:r,type:"share_invite",level:o}});case 12:VJ.event(zJ,{share_content_type:"CurrentLevel",success:!0}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),VJ.event(zJ,{share_content_type:"CurrentLevel",success:!1}),console.warn(e.t0);case 19:pt.closeLoadingScreen();case 20:case"end":return e.stop()}}),e,null,[[2,15]])}))),function(){return u.apply(this,arguments)})},{key:"goToNextLevel",value:function(){var e=tt.getCurrentMission();nt.setLevel(e.gameLevel),rt.switchToJourney(tt.getSeason(),tt.getCurrentLevel()),this.node.scene.emit($e.NEXT_LEVEL)}},{key:"openRewardScreen",value:function(e){var t=this;return new Promise((function(n){var i={items:[{item:lt.HINT,count:1},{item:lt.SHUFFLE,count:1}],watchAdsDoubleReward:!0,chestId:cN,successCallback:function(){t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.HINT,ut.getItemCount(ct[lt.HINT])),t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.UNDO,ut.getItemCount(ct[lt.UNDO])),t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.SHUFFLE,ut.getItemCount(ct[lt.SHUFFLE])),null==e||e(),n()},earnFrom:"JourneyWinningScreen"};pt.openScreen(Ge.REWARD_SCREEN,i)}))}}]),f}(k)).prototype,"titleRibbon",[XY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pJ=e(cJ.prototype,"titleLabel",[QY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dJ=e(cJ.prototype,"nextLevelButton",[$Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fJ=e(cJ.prototype,"shareButtonComponent",[eJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yJ=e(cJ.prototype,"nextLevelButtonComponent",[tJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vJ=e(cJ.prototype,"returnButtonComponent",[nJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gJ=e(cJ.prototype,"rewardProgressBar",[iJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mJ=e(cJ.prototype,"progressTextLocalize",[aJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bJ=e(cJ.prototype,"commentTextLocalize",[rJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SJ=e(cJ.prototype,"firelightParticleSystem",[oJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wJ=e(cJ.prototype,"blossomParticleSystem",[sJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kJ=e(cJ.prototype,"blossomParticleSystem2",[lJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uJ=cJ))||uJ)||uJ);g._RF.pop(),g._RF.push({},"da829wtTWpCK56Wtj1ASsHP","WinningJourneyBlock",void 0);var qJ,KJ,YJ,JJ,ZJ,XJ,QJ,$J,eZ,tZ,nZ,iZ,aZ,rZ,oZ,sZ=m.ccclass,lZ=m.property;LJ=sZ("WinningJourneyBlock"),xJ=lZ(E),IJ=lZ(ae),LJ((PJ=e((RJ=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"itemIcon",PJ,r(e)),a(e,"checkSpriteFrame",_J,r(e)),e}return o(l,[{key:"onEnable",value:function(){this.updateItemIcon()}},{key:"updateItemIcon",value:function(){var e=tt.getLastMission();if(e){var t=e.type;switch(t){case yt.FIND_ARTIFACT:var n=tt.getJourneyTileSkinIdx(e);this.itemIcon.spriteFrame=tt.getCurrentArtifactTileSprite(n.toString());break;case yt.HIDDEN_TILE:this.itemIcon.spriteFrame=Ne.getCurrentTileHiddenSprite();break;case yt.TARGET_TILE:this.itemIcon.spriteFrame=this.checkSpriteFrame;break;default:console.warn("Unknown mission type:",t)}}}}]),l}(k)).prototype,"itemIcon",[xJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_J=e(RJ.prototype,"checkSpriteFrame",[IJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AJ=RJ));g._RF.pop(),g._RF.push({},"b5684yl13FPP7/xZ3cHT1wu","LanguageSelection",void 0);var uZ,cZ,hZ,pZ,dZ,fZ=m.ccclass,yZ=m.property,vZ=m.executeInEditMode,gZ=(qJ=fZ("LanguageSelection"),KJ=vZ(!0),YJ=yZ({visible:!1}),JJ=yZ({type:S,tooltip:"The locale of the language"}),ZJ=yZ(E),XJ=yZ(E),QJ=yZ(N),$J=yZ(X),qJ(eZ=KJ((nZ=e((tZ=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"_locale",nZ,r(e)),a(e,"unselectSprite",iZ,r(e)),a(e,"selectedSprite",aZ,r(e)),a(e,"button",rZ,r(e)),a(e,"label",oZ,r(e)),e}return o(l,[{key:"locale",get:function(){return this._locale},set:function(e){try{var t=qe;if(!t.includes(e))throw new Error("Locale ".concat(e," is not available. Available locales: ").concat(t.join(", ")));this._locale=e,this.updateLabelByLocale()}catch(e){console.warn(e)}}},{key:"setSelected",value:function(e){e?(this.unselectSprite.node.active=!1,this.selectedSprite.node.active=!0):(this.unselectSprite.node.active=!0,this.selectedSprite.node.active=!1)}},{key:"setInteractable",value:function(e){this.button.interactable=e}},{key:"updateLabelByLocale",value:function(){switch(this._locale){case"en":this.label.string="English";break;case"ru":this.label.string="";break;case"es":this.label.string="Espaol";break;case"de":this.label.string="Deutsch";break;case"fr":this.label.string="Franais";break;case"pt":this.label.string="Portugus";break;case"it":this.label.string="Italiano";break;case"zh":this.label.string="";break;case"id":this.label.string="Bahasa Indonesia";break;case"ja":this.label.string="";break;case"tr":this.label.string="Trke";break;default:console.warn("Locale ".concat(this._locale," is not supported. Defaulting to English.")),this.label.string="English"}}}]),l}(k)).prototype,"_locale",[YJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(tZ.prototype,"locale",[JJ],Object.getOwnPropertyDescriptor(tZ.prototype,"locale"),tZ.prototype),iZ=e(tZ.prototype,"unselectSprite",[ZJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aZ=e(tZ.prototype,"selectedSprite",[XJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rZ=e(tZ.prototype,"button",[QJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oZ=e(tZ.prototype,"label",[$J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eZ=tZ))||eZ)||eZ);g._RF.pop(),g._RF.push({},"1562eVJKuFFJZOeia8izV5n","LanguagesContent",void 0);var mZ,bZ,SZ,wZ,kZ,TZ,CZ,EZ,LZ=m.ccclass,xZ=m.property,IZ=Ludex.Events,AZ=codex,RZ=(AZ.event,AZ.language),PZ=(AZ.player,[]),_Z=(uZ=LZ("LanguagesContent"),cZ=xZ(gZ),uZ((dZ=e((pZ=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"languageSelections",dZ,r(e)),e}return o(h,[{key:"start",value:function(){var e=RZ.getCurrentLocale();e?PZ.push(e):PZ.push("en")}},{key:"updateSelection",value:function(){var e=RZ.getCurrentLocale();this.selectSelection(e)}},{key:"handleSelectedButton",value:(u=s(l().mark((function e(t,n){var i,a,r,o=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLocale(n)){e.next=2;break}return e.abrupt("return");case 2:if(i=n,!PZ.includes(i)){e.next=8;break}return a={locale:i,saveToPlayerData:!0},x.emit(_e.CHOOSE_LANGUAGE,a),this.selectSelection(i),e.abrupt("return");case 8:pt.showLoadingScreen(),r={locale:i,saveToPlayerData:!0,onLoad:function(e){pt.closeLoadingScreen(),o.selectSelection(i),PZ.push(i)}},x.emit(IZ.REQUEST_LANGUAGE,r);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"isLocale",value:function(e){return"string"==typeof e&&e.includes(e)}},{key:"selectSelection",value:function(e){var t,n=d(this.languageSelections);try{for(n.s();!(t=n.n()).done;){var i=t.value;i._locale===e?i.setSelected(!0):i.setSelected(!1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleContentScroll",value:function(e,t,n){if(12===t){var i,a=d(this.languageSelections);try{for(a.s();!(i=a.n()).done;){i.value.setInteractable(!1)}}catch(e){a.e(e)}finally{a.f()}}if(9===t){var r,o=d(this.languageSelections);try{for(o.s();!(r=o.n()).done;){r.value.setInteractable(!0)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"setInteractableAllSelections",value:function(e){var t,n=d(this.languageSelections);try{for(n.s();!(t=n.n()).done;){t.value.setInteractable(e)}}catch(e){n.e(e)}finally{n.f()}}}]),h}(k)).prototype,"languageSelections",[cZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hZ=pZ))||hZ);g._RF.pop(),g._RF.push({},"74661Y4mL9JnbO9+sM0x5XB","LanguagesScreen",void 0);var NZ,OZ,BZ,DZ,FZ,MZ,zZ,UZ=m.ccclass,GZ=m.disallowMultiple,HZ=m.requireComponent,WZ=m.property,VZ=Ludex.Events,jZ=codex.event;mZ=UZ("LanguagesScreen"),bZ=HZ(Si),SZ=WZ(N),wZ=WZ(_Z),mZ(kZ=GZ(kZ=bZ((CZ=e((TZ=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"closeButton",CZ,r(e)),a(e,"languageContent",EZ,r(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("LanguagesScreen: screen not found");e.languageContent.updateSelection()},e.handleOpenedScreen=function(t){e.languageContent.setInteractableAllSelections(!0),e.closeButton.interactable=!0,e.open()},e}return o(l,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.listenScreenEvents()}},{key:"listenScreenEvents",value:function(){jZ.on(VZ.OPENING_SCREEN,this.handleOpeningScreen),jZ.on(VZ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){jZ.off(VZ.OPENING_SCREEN,this.handleOpeningScreen),jZ.off(VZ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"handleClose",value:function(){this.languageContent.setInteractableAllSelections(!1),this.closeButton.interactable=!1;var e=void 0!==this.screen.data.source;pt.closeScreen(Ge.LANGUAGES_SCREEN,{openNextScreenImmediately:e}),this.screen.data.source?pt.openScreen(this.screen.data.source):this.node.scene.emit($e.GAME_RESUME)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),l}(k)).prototype,"closeButton",[SZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EZ=e(TZ.prototype,"languageContent",[wZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kZ=TZ))||kZ)||kZ);g._RF.pop(),g._RF.push({},"7b024d/xQ1BBZV0UpNjM9UQ","LoadingFullScreen",void 0);var qZ,KZ,YZ,JZ,ZZ,XZ=m.ccclass,QZ=m.property,$Z=(NZ=XZ("LoadingFullScreen"),OZ=QZ(H),BZ=QZ(X),NZ((MZ=e((FZ=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"progressBar",MZ,r(e)),a(e,"loadingText",zZ,r(e)),e}return o(p,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(P),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"runLoadingTextAnimation",value:function(){var e=this,t=0,n=this.loadingText.string;this.schedule((function(){t=t>2?0:t+1,e.loadingText.string=n+".".repeat(t)}),.5)}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"show",value:(c=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uiOpacity.opacity=0,this.progressBar.progress=0,n=B(this.uiOpacity).to(.2,{opacity:255},{easing:"cubicOut"}),i=B(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"}),this.runLoadingTextAnimation(),Ve.runTweenAsync(n),e.next=8,Ve.runTweenAsync(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"hide",value:(u=s(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uiOpacity&&this.progressBar){e.next=2;break}return e.abrupt("return");case 2:return this.uiOpacity.opacity=255,this.progressBar.progress=.9,n=B(this.uiOpacity).to(.15,{opacity:0},{easing:"cubicIn"}),i=B(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"}),this.runLoadingTextAnimation(),e.next=9,Ve.runTweenAsync(i);case 9:return this.stopLoadingTextAnimation(),e.next=12,Ve.runTweenAsync(n);case 12:this.node.active=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),p}(k)).prototype,"progressBar",[OZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zZ=e(FZ.prototype,"loadingText",[BZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DZ=FZ))||DZ);g._RF.pop(),g._RF.push({},"daa70r49mtGR6iXhcKLcS3q","Loading",void 0);var eX,tX,nX,iX,aX,rX,oX=m.ccclass,sX=m.property;qZ=oX("Loading"),KZ=sX(q),qZ((ZZ=e((JZ=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"loadingPrefab",ZZ,r(e)),e.loadingNode=null,e}return o(p,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){C.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=ne("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=K(this.loadingPrefab));var n=K._clone(this.loadingNode);this.loadingFullScreen=n.getComponent($Z),this.node.active=!1,null===(e=ne("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(c=s(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.createLoadingFullScreen(),!this.node.active){e.next=3;break}return e.abrupt("return");case 3:return this.node.active=!0,e.next=6,this.loadingFullScreen.show(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"hide",value:(u=s(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=this.node)&&void 0!==n&&n.active){e.next=2;break}return e.abrupt("return");case 2:if(this.loadingFullScreen){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.loadingFullScreen.hide(t);case 6:this.node.active=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),p}(k)).prototype,"loadingPrefab",[KZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YZ=JZ));g._RF.pop(),g._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var lX,uX,cX,hX,pX,dX,fX,yX,vX,gX,mX,bX,SX=m.ccclass,wX=m.disallowMultiple,kX=m.requireComponent,TX=m.property,CX=Ludex,EX=CX.Events,LX=CX.Utils.Signal,xX=codex.event;eX=SX("LoadingScreen"),tX=kX(Si),nX=TX(E),eX(iX=wX(iX=tX((rX=e((aX=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=s.call.apply(s,[this].concat(n))).isClosing=!1,a(e,"sakuraSprite",rX,r(e)),e.signalController=new LX.SignalController,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.isClosing=!1,e.node.setSiblingIndex(_t.LOADING_SCREEN))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.isClosing=!0,e.unscheduleAllCallbacks())},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1,e.isClosing=!1,e.signalController.abort())},e.handleOnCloseScreen=function(){pt.closeScreen(Ge.LOADING_SCREEN)},e}return o(l,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){xX.on(EX.OPENING_SCREEN,this.handleOpeningScreen),xX.on(EX.OPENED_SCREEN,this.handleOpenedScreen),xX.on(EX.CLOSING_SCREEN,this.handleClosingScreen),xX.on(EX.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){xX.off(EX.OPENING_SCREEN,this.handleOpeningScreen),xX.off(EX.OPENED_SCREEN,this.handleOpenedScreen),xX.off(EX.CLOSING_SCREEN,this.handleClosingScreen),xX.off(EX.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){var e,t=this;if(this.enabled&&!this.isClosing){var n=null!==(e=this.screen.data.duration)&&void 0!==e?e:0,i=this.signalController.renew(),a=B(this.sakuraSprite.node).set({angle:0}).by(2.5,{angle:-360},{easing:re.linear}).union(),r=B(this.sakuraSprite.node).set({angle:0}).repeatForever(a);i.once((function(){t.node.setRotationFromEuler(0,0,0)})),Ve.runTweenAsync(r,i),n>0&&this.scheduleOnce(this.handleOnCloseScreen,n)}}}]),l}(k)).prototype,"sakuraSprite",[nX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iX=aX))||iX)||iX);g._RF.pop(),g._RF.push({},"15681ka+CZC45B7BdUhsnhF","LoseScreen",void 0);var IX,AX,RX,PX,_X,NX,OX,BX,DX,FX,MX,zX,UX,GX,HX,WX,VX,jX,qX,KX,YX,JX,ZX,XX,QX,$X,eQ,tQ,nQ=m.ccclass,iQ=m.property,aQ=m.disallowMultiple,rQ=m.requireComponent,oQ=Ludex.Events,sQ=codex,lQ=sQ.event;sQ.analytics,sQ.player,lX=nQ("LoseScreen"),uX=rQ(Si),cX=iQ(N),hX=iQ(N),pX=iQ(N),dX=iQ(X),lX(fX=aQ(fX=uX((vX=e((yX=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"restartButton",vX,r(e)),a(e,"useShuffleButton",gX,r(e)),a(e,"adShuffleButton",mX,r(e)),a(e,"shuffleCountLabel",bX,r(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("LoseScreen: screen not found");if(e.validateEventPayload(t)){e.restartButton.interactable=!0;var n=ut.getItemCount(ct[lt.SHUFFLE]);n>0?(e.adShuffleButton.node.active=!1,e.adShuffleButton.interactable=!1,e.useShuffleButton.interactable=!0,e.useShuffleButton.node.active=!0,e.shuffleCountLabel.string=n.toString()):(e.adShuffleButton.node.active=!0,e.adShuffleButton.interactable=!0,e.useShuffleButton.interactable=!1,e.useShuffleButton.node.active=!1)}},e.handleOpenedScreen=function(t){e.validateEventPayload(t)},e.logRetry=function(){We.logLevelRetry(Ue[Ge.LOSE_SCREEN])},e.logRescue=function(){We.logLevelRescue()},e}return o(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){lQ.on(oQ.OPENING_SCREEN,this.handleOpeningScreen),lQ.on(oQ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){lQ.off(oQ.OPENING_SCREEN,this.handleOpeningScreen),lQ.off(oQ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.restartButton.interactable=!1,this.useShuffleButton.interactable=!1,this.adShuffleButton.interactable=!1,pt.closeScreen(Ge.LOSE_SCREEN)}},{key:"handleClickedUseShuffleGame",value:function(){this.node.scene.emit($e.USE_ITEM,lt.SHUFFLE,!1,p.name),this.node.scene.emit($e.GAME_RESCUE),this.logRescue(),this.close()}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=nt.getLevel(),n=e.getCurrentScore();We.logLevelEnd(t,n,!1)}},{key:"handleClickedAdShuffleGame",value:(c=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.showRewardVideoAdAsync();case 2:e.sent&&(ut.addItem(ct[lt.SHUFFLE],1),this.node.scene.emit($e.USE_ITEM,lt.SHUFFLE,!1,p.name),this.node.scene.emit($e.GAME_RESCUE),this.logRescue(),this.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedRestartGame",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.showInterstitialAdAsync();case 2:this.close(),this.logRetry(),this.logEndGame(),this.replayGame();case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"replayGame",value:function(){this.node.scene.emit($e.GAME_REPLAY)}}]),p}(k)).prototype,"restartButton",[cX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gX=e(yX.prototype,"useShuffleButton",[hX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mX=e(yX.prototype,"adShuffleButton",[pX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bX=e(yX.prototype,"shuffleCountLabel",[dX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fX=yX))||fX)||fX);g._RF.pop(),g._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var uQ,cQ,hQ,pQ,dQ,fQ,yQ,vQ,gQ,mQ,bQ,SQ,wQ,kQ,TQ,CQ,EQ,LQ,xQ,IQ,AQ,RQ,PQ,_Q,NQ,OQ,BQ,DQ,FQ=m.ccclass,MQ=m.disallowMultiple,zQ=m.requireComponent,UQ=m.property,GQ=Ludex,HQ=GQ.Events,WQ=GQ.Utils,VQ=codex,jQ=VQ.event,qQ=VQ.language;IX=FQ("NotificationScreen"),AX=zQ(Si),RX=UQ(L),PX=UQ(L),_X=UQ(X),NX=UQ(gh),OX=UQ(N),BX=UQ(z),DX=UQ(N),FX=UQ(j),MX=UQ(j),IX(zX=MQ(zX=AX((GX=e((UX=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"popupUiTransform",GX,r(e)),a(e,"messageUiTransform",HX,r(e)),a(e,"message",WX,r(e)),a(e,"messageLocalize",VX,r(e)),a(e,"closeButton",jX,r(e)),a(e,"closeButtonWidget",qX,r(e)),a(e,"touchZone",KX,r(e)),a(e,"originalMessageSize",YX,r(e)),a(e,"maxMessageWidth",JX,r(e)),a(e,"minStretchCheckMessageHeight",ZX,r(e)),a(e,"stretchWidthIterations",XX,r(e)),a(e,"minPopupWidth",QX,r(e)),a(e,"minPopupHeight",$X,r(e)),a(e,"maxPopupWidth",eQ,r(e)),a(e,"messagePopupPadding",tQ,r(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.closeButton.interactable=!0,e.touchZone.interactable=!0,e.node.setSiblingIndex(_t.NOTIFICATION_SCREEN))},e.handleOpenedScreen=function(t){if(e.validateEventPayload(t)&&t.screenData.message){for(e.message.overflow=X.Overflow.RESIZE_HEIGHT,e.messageUiTransform.setContentSize(e.originalMessageSize.x,e.originalMessageSize.y),e.message.updateRenderData(!0);e.messageUiTransform.contentSize.y>=e.minStretchCheckMessageHeight&&e.messageUiTransform.contentSize.x<e.maxMessageWidth;)e.messageUiTransform.setContentSize(e.messageUiTransform.contentSize.x+e.stretchWidthIterations,e.messageUiTransform.contentSize.y),e.message.updateRenderData(!0);var n=Y.clamp(e.messageUiTransform.contentSize.x+e.messagePopupPadding.x,e.minPopupWidth,e.maxPopupWidth),i=Math.max(e.minPopupHeight,e.messageUiTransform.contentSize.y+e.messagePopupPadding.y);e.popupUiTransform.setContentSize(n,i),e.closeButtonWidget.updateAlignment()}},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.closeButton.interactable=!1,e.touchZone.interactable=!1)},e}return o(l,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){jQ.on(HQ.OPENING_SCREEN,this.handleOpeningScreen),jQ.on(HQ.OPENED_SCREEN,this.handleOpenedScreen),jQ.on(HQ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){jQ.off(HQ.OPENING_SCREEN,this.handleOpeningScreen),jQ.off(HQ.OPENED_SCREEN,this.handleOpenedScreen),jQ.off(HQ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;WQ.Valid.isObject(t)?(t.message&&(qQ.hasTextKey(t.message)?this.messageLocalize.key=t.message:this.message.string=t.message),t.duration&&t.duration>0&&this.scheduleOnce((function(){pt.closeScreen(Ge.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),pt.closeScreen(Ge.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),l}(k)).prototype,"popupUiTransform",[RX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HX=e(UX.prototype,"messageUiTransform",[PX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WX=e(UX.prototype,"message",[_X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VX=e(UX.prototype,"messageLocalize",[NX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jX=e(UX.prototype,"closeButton",[OX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qX=e(UX.prototype,"closeButtonWidget",[BX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KX=e(UX.prototype,"touchZone",[DX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YX=e(UX.prototype,"originalMessageSize",[FX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(550,150)}}),JX=e(UX.prototype,"maxMessageWidth",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),ZX=e(UX.prototype,"minStretchCheckMessageHeight",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),XX=e(UX.prototype,"stretchWidthIterations",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),QX=e(UX.prototype,"minPopupWidth",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 700}}),$X=e(UX.prototype,"minPopupHeight",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),eQ=e(UX.prototype,"maxPopupWidth",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),tQ=e(UX.prototype,"messagePopupPadding",[MX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new j(200,200)}}),zX=UX))||zX)||zX);g._RF.pop(),g._RF.push({},"15d8eqh3ShJsp+VfeIUR9VN","OptionsScreen",void 0);var KQ,YQ,JQ,ZQ,XQ,QQ,$Q,e$,t$,n$,i$,a$,r$,o$,s$,l$,u$,c$,h$,p$,d$,f$,y$,v$,g$,m$,b$,S$,w$,k$,T$=m.ccclass,C$=m.property,E$=m.requireComponent,L$=Ludex,x$=L$.Events,I$=L$.Utils,A$=codex,R$=A$.player,P$=A$.event,_$=A$.analytics;uQ=T$("OptionsScreen"),cQ=E$(Si),hQ=C$(N),pQ=C$(N),dQ=C$(N),fQ=C$(oe),yQ=C$(Gu),vQ=C$(Gu),gQ=C$(Gu),mQ=C$(Gu),bQ=C$(Gu),SQ=C$(N),wQ=C$({type:[A]}),kQ=C$({type:[A]}),uQ(TQ=cQ((EQ=e((CQ=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"themeButtonContainer",EQ,r(e)),a(e,"noAdsButtonContainer",LQ,r(e)),a(e,"languageButtonContainer",xQ,r(e)),a(e,"settingButtonLayout",IQ,r(e)),a(e,"musicSwitch",AQ,r(e)),a(e,"soundSwitch",RQ,r(e)),a(e,"vibrateSwitch",PQ,r(e)),a(e,"highLightSwitch",_Q,r(e)),a(e,"autoZoomSwitch",NQ,r(e)),a(e,"closeButtonComponent",OQ,r(e)),a(e,"iapFeaturesElements",BQ,r(e)),a(e,"fbPageElements",DQ,r(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.themeButtonContainer.interactable=!0,e.noAdsButtonContainer.interactable=!0,e.languageButtonContainer.interactable=!0,e.musicSwitch.button.interactable=!0,e.soundSwitch.button.interactable=!0,e.vibrateSwitch.button.interactable=!0,e.highLightSwitch.button.interactable=!0,e.autoZoomSwitch.button.interactable=!0,e.updateStatus())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!1,e.themeButtonContainer.interactable=!1,e.noAdsButtonContainer.interactable=!1,e.languageButtonContainer.interactable=!1,e.musicSwitch.button.interactable=!1,e.soundSwitch.button.interactable=!1,e.vibrateSwitch.button.interactable=!1,e.highLightSwitch.button.interactable=!1,e.autoZoomSwitch.button.interactable=!1)},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){var n=t.code,i=Nt.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(P$.emit(Nt.Events.UNLOCK_DEV_TOOLS),e.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE)))},e.updateVibrateButton=function(){if(I$.Device.isMobile()){var t,n=null!==(t=R$.getPlayerSetting("vibrate"))&&void 0!==t&&t;e.vibrateSwitch.setEnabled(n)}else e.vibrateSwitch.node.parent.active=!1;e.settingButtonLayout.updateLayout(!0)},e}return o(l,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.handleGameDistributionUIChanges(),this.updateFBPageFeatures(),this.updateIAPFeatures()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"handleGameDistributionUIChanges",value:function(){"GameDistributions"===GameSDK.getSDKName()&&(this.vibrateSwitch.node.active=!1,this.settingButtonLayout.updateLayout(!0))}},{key:"listenScreenEvents",value:function(){P$.on(x$.OPENING_SCREEN,this.handleOpeningScreen),P$.on(x$.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){P$.off(x$.OPENING_SCREEN,this.handleOpeningScreen),P$.off(x$.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(Nt.Events.TRIGGER_UNLOCK_KEY),this.node.on(Nt.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(Nt.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(Nt.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(Nt.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE),pt.closeScreen(Ge.OPTIONS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i,a,r={music:null!==(e=R$.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=R$.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=R$.getPlayerSetting("vibrate"))&&void 0!==n&&n,highLight:null!==(i=R$.getPlayerSetting("highLight"))&&void 0!==i&&i,autoZoom:null===(a=R$.getPlayerSetting("autoZoom"))||void 0===a||a};this.musicSwitch?this.soundSwitch?this.highLightSwitch?this.autoZoomSwitch?(this.musicSwitch.setEnabled(r.music),this.soundSwitch.setEnabled(r.sound),this.highLightSwitch.setEnabled(r.highLight),this.autoZoomSwitch.setEnabled(r.autoZoom),this.vibrateSwitch.setEnabled(r.vibrate),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: autoZoomSwitch not found"):console.warn("SettingsScreen: highLightSwitch not found"):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("SettingsScreen: screen not found")}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();R$.setSetting("music",e),this.node.emit(Nt.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e?Me.playMusic():Me.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();R$.setSetting("sound",e),this.node.emit(Nt.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();R$.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"switchHighLightButton",value:function(){if(this.highLightSwitch){var e=this.highLightSwitch.switch();R$.setSetting("highLight",e)}else console.warn("SettingsScreen: highLightSwitch not found")}},{key:"switchAutoZoomButton",value:function(){if(this.autoZoomSwitch){var e=this.autoZoomSwitch.switch();R$.setSetting("autoZoom",e),e&&this.node.scene.emit($e.AUTO_ZOOM_UPDATE)}else console.warn("SettingsScreen: autoZoomSwitch not found")}},{key:"handleClickedClose",value:function(e,t){this.close()}},{key:"handleClickedJoinFacebookGroup",value:function(){GameSDK.extra&&"joinOfficialGroupAsync"in GameSDK.extra&&(GameSDK.extra.joinOfficialGroupAsync().catch((function(e){console.error("joinFacebookGroup failed",e)})),_$.event(gt.GROUP_JOIN))}},{key:"handleClickFollowPage",value:function(){GameSDK.extra&&"followOfficialPageAsync"in GameSDK.extra&&(GameSDK.extra.followOfficialPageAsync().catch((function(e){console.error("followOfficialPage failed",e)})),_$.event(gt.PAGE_FOLLOW))}},{key:"handleClickedTheme",value:function(){this.close(),pt.openScreen(Ge.THEME_SCREEN,{source:Ge.OPTIONS_SCREEN})}},{key:"handleClickedNoAds",value:function(){this.close(),pt.openScreen(Ge.SHOP_SCREEN,{source:Ge.OPTIONS_SCREEN})}},{key:"handleClickedLanguage",value:function(){this.close(),pt.openScreen(Ge.LANGUAGES_SCREEN,{source:Ge.OPTIONS_SCREEN})}},{key:"updateFBPageFeatures",value:function(){var e,t=yg.isFBPageFeatureAvailable(),n=d(this.fbPageElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}},{key:"updateIAPFeatures",value:function(){var e,t=yg.isIAPFeatureAvailable(),n=d(this.iapFeaturesElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}}]),l}(k)).prototype,"themeButtonContainer",[hQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LQ=e(CQ.prototype,"noAdsButtonContainer",[pQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xQ=e(CQ.prototype,"languageButtonContainer",[dQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IQ=e(CQ.prototype,"settingButtonLayout",[fQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AQ=e(CQ.prototype,"musicSwitch",[yQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RQ=e(CQ.prototype,"soundSwitch",[vQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PQ=e(CQ.prototype,"vibrateSwitch",[gQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_Q=e(CQ.prototype,"highLightSwitch",[mQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NQ=e(CQ.prototype,"autoZoomSwitch",[bQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OQ=e(CQ.prototype,"closeButtonComponent",[SQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BQ=e(CQ.prototype,"iapFeaturesElements",[wQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),DQ=e(CQ.prototype,"fbPageElements",[kQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),TQ=CQ))||TQ);g._RF.pop(),g._RF.push({},"a29a3R+SwZAqZVhE3htl6VV","RewardScreenData",void 0),g._RF.pop(),g._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var N$,O$,B$,D$,F$,M$,z$,U$,G$,H$,W$,V$=m.ccclass,j$=m.property,q$=m.requireComponent,K$=Ludex,Y$=K$.Events,J$=K$.Utils,Z$=codex,X$=Z$.player,Q$=Z$.event,$$=Z$.analytics;KQ=V$("SettingsScreen"),YQ=q$(Si),JQ=j$(N),ZQ=j$(N),XQ=j$(N),QQ=j$(oe),$Q=j$(Gu),e$=j$(Gu),t$=j$(Gu),n$=j$(Gu),i$=j$(Gu),a$=j$(N),r$=j$(N),o$=j$({type:[A]}),s$=j$({type:[A]}),KQ(l$=YQ((c$=e((u$=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"themeButtonContainer",c$,r(e)),a(e,"noAdsButtonContainer",h$,r(e)),a(e,"languageButtonContainer",p$,r(e)),a(e,"settingButtonLayout",d$,r(e)),a(e,"musicSwitch",f$,r(e)),a(e,"soundSwitch",y$,r(e)),a(e,"vibrateSwitch",v$,r(e)),a(e,"highLightSwitch",g$,r(e)),a(e,"autoZoomSwitch",m$,r(e)),a(e,"restartButtonComponent",b$,r(e)),a(e,"closeButtonComponent",S$,r(e)),a(e,"fbPageElements",w$,r(e)),a(e,"iapFeaturesElements",k$,r(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.restartButtonComponent.interactable=!0,e.themeButtonContainer.interactable=!0,e.noAdsButtonContainer.interactable=!0,e.languageButtonContainer.interactable=!0,e.musicSwitch.button.interactable=!0,e.soundSwitch.button.interactable=!0,e.vibrateSwitch.button.interactable=!0,e.highLightSwitch.button.interactable=!0,e.autoZoomSwitch.button.interactable=!0,e.updateStatus())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!1,e.restartButtonComponent.interactable=!1,e.themeButtonContainer.interactable=!1,e.noAdsButtonContainer.interactable=!1,e.languageButtonContainer.interactable=!1,e.musicSwitch.button.interactable=!1,e.soundSwitch.button.interactable=!1,e.vibrateSwitch.button.interactable=!1,e.highLightSwitch.button.interactable=!1,e.autoZoomSwitch.button.interactable=!1)},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){var n=t.code,i=Nt.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(Q$.emit(Nt.Events.UNLOCK_DEV_TOOLS),e.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE)))},e.updateVibrateButton=function(){if(J$.Device.isMobile()){var t,n=null!==(t=X$.getPlayerSetting("vibrate"))&&void 0!==t&&t;e.vibrateSwitch.setEnabled(n)}else e.vibrateSwitch.node.parent.active=!1;e.settingButtonLayout.updateLayout(!0)},e.logRetry=function(){var e=Ue[Ge.SETTINGS_SCREEN];We.logLevelRetry(e)},e}return o(h,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.handleGameDistributionUIChanges(),this.updateFBPageFeatures(),this.updateIAPFeatures()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"gameScene",get:function(){var e,t=null===(e=ne("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"handleGameDistributionUIChanges",value:function(){"GameDistributions"===GameSDK.getSDKName()&&(this.vibrateSwitch.node.active=!1,this.settingButtonLayout.updateLayout(!0))}},{key:"listenScreenEvents",value:function(){Q$.on(Y$.OPENING_SCREEN,this.handleOpeningScreen),Q$.on(Y$.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){Q$.off(Y$.OPENING_SCREEN,this.handleOpeningScreen),Q$.off(Y$.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(Nt.Events.TRIGGER_UNLOCK_KEY),this.node.on(Nt.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(Nt.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(Nt.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(Nt.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.node.emit(Nt.Events.TRIGGER_RESET_SEQUENCE),pt.closeScreen(Ge.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i,a,r={music:null!==(e=X$.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=X$.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=X$.getPlayerSetting("vibrate"))&&void 0!==n&&n,highLight:null!==(i=X$.getPlayerSetting("highLight"))&&void 0!==i&&i,autoZoom:null===(a=X$.getPlayerSetting("autoZoom"))||void 0===a||a};this.musicSwitch?this.soundSwitch?this.highLightSwitch?this.autoZoomSwitch?(this.musicSwitch.setEnabled(r.music),this.soundSwitch.setEnabled(r.sound),this.highLightSwitch.setEnabled(r.highLight),this.autoZoomSwitch.setEnabled(r.autoZoom),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: autoZoomSwitch not found"):console.warn("SettingsScreen: highLightSwitch not found"):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("SettingsScreen: screen not found")}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();X$.setSetting("music",e),this.node.emit(Nt.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e?Me.playMusic():Me.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();X$.setSetting("sound",e),this.node.emit(Nt.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchHighLightButton",value:function(){if(this.highLightSwitch){var e=this.highLightSwitch.switch();X$.setSetting("highLight",e)}else console.warn("SettingsScreen: highLightSwitch not found")}},{key:"switchAutoZoomButton",value:function(){if(this.autoZoomSwitch){var e=this.autoZoomSwitch.switch();X$.setSetting("autoZoom",e),e&&this.node.scene.emit($e.AUTO_ZOOM_UPDATE)}else console.warn("SettingsScreen: autoZoomSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();X$.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){console.log("SettingsScreen: handleClickedClose"),this.close(),this.node.scene.emit($e.GAME_RESUME)}},{key:"handleClickedTheme",value:function(){this.close(),pt.openScreen(Ge.THEME_SCREEN,{source:Ge.SETTINGS_SCREEN})}},{key:"handleClickedNoAds",value:function(){this.close(),pt.openScreen(Ge.SHOP_SCREEN,{source:Ge.SETTINGS_SCREEN})}},{key:"handleClickedLanguage",value:function(){this.close(),pt.openScreen(Ge.LANGUAGES_SCREEN,{source:Ge.SETTINGS_SCREEN})}},{key:"handleClickedJoinFacebookGroup",value:function(){GameSDK.extra&&"joinOfficialGroupAsync"in GameSDK.extra&&(GameSDK.extra.joinOfficialGroupAsync().catch((function(e){console.error("joinFacebookGroup failed",e)})),$$.event(gt.GROUP_JOIN))}},{key:"handleClickFollowPage",value:function(){GameSDK.extra&&"followOfficialPageAsync"in GameSDK.extra&&(GameSDK.extra.followOfficialPageAsync().catch((function(e){console.error("followOfficialPage failed",e)})),$$.event(gt.PAGE_FOLLOW))}},{key:"handleClickedRestart",value:(u=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.showInterstitialAdAsync();case 2:this.close(),this.replayGame();case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"replayGame",value:function(){this.logRetry(),this.logEndGame(),this.node.scene.emit($e.GAME_RESUME),this.node.scene.emit($e.GAME_REPLAY)}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=nt.getLevel(),n=e.getCurrentScore();We.logLevelEnd(t,n,!1)}},{key:"updateFBPageFeatures",value:function(){var e,t=yg.isFBPageFeatureAvailable(),n=d(this.fbPageElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}},{key:"updateIAPFeatures",value:function(){var e,t=yg.isIAPFeatureAvailable(),n=d(this.iapFeaturesElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}}]),h}(k)).prototype,"themeButtonContainer",[JQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h$=e(u$.prototype,"noAdsButtonContainer",[ZQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p$=e(u$.prototype,"languageButtonContainer",[XQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d$=e(u$.prototype,"settingButtonLayout",[QQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f$=e(u$.prototype,"musicSwitch",[$Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y$=e(u$.prototype,"soundSwitch",[e$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v$=e(u$.prototype,"vibrateSwitch",[t$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g$=e(u$.prototype,"highLightSwitch",[n$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m$=e(u$.prototype,"autoZoomSwitch",[i$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b$=e(u$.prototype,"restartButtonComponent",[a$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S$=e(u$.prototype,"closeButtonComponent",[r$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w$=e(u$.prototype,"fbPageElements",[o$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k$=e(u$.prototype,"iapFeaturesElements",[s$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l$=u$))||l$);g._RF.pop(),g._RF.push({},"9e813bKJYpE0Yj2E0IHsyJQ","Version",void 0);var e0,t0,n0,i0,a0,r0,o0,s0,l0,u0,c0,h0,p0,d0=m.ccclass,f0=m.property;Ludex.Events,codex.event,N$=d0("Version"),O$=f0(X),B$=f0(gh),D$=f0(L),F$=f0(L),N$((U$=e((z$=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"versionLabel",U$,r(e)),a(e,"versionLabelLocalize",G$,r(e)),a(e,"versionLabelTransform",H$,r(e)),a(e,"underlineTransform",W$,r(e)),e}return o(l,[{key:"start",value:function(){var e=codex.getBuildVersion();this.versionLabelLocalize.setParams([e.toString()])}},{key:"onEnable",value:function(){var e=this;this.scheduleOnce((function(){e.updateUnderline()}),.05)}},{key:"updateUnderline",value:function(){this.underlineTransform.setContentSize(this.versionLabelTransform.contentSize.width,this.underlineTransform.contentSize.height)}}]),l}(k)).prototype,"versionLabel",[O$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G$=e(z$.prototype,"versionLabelLocalize",[B$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H$=e(z$.prototype,"versionLabelTransform",[D$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W$=e(z$.prototype,"underlineTransform",[F$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M$=z$));g._RF.pop(),g._RF.push({},"cbd8fx4oOZAjI4kdkrvUv/t","CollectionProduct",void 0);var y0,v0,g0,m0,b0,S0,w0,k0,T0,C0,E0,L0,x0,I0,A0,R0,P0,_0,N0,O0,B0,D0,F0,M0,z0=m.ccclass,U0=m.property,G0=(e0=z0("CollectionProduct"),t0=U0(P),n0=U0(N),i0=U0(gh),a0=U0(X),r0=U0(X),e0((l0=e((s0=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"buyButtonOpacity",l0,r(e)),a(e,"buyButton",u0,r(e)),a(e,"priceLocalize",c0,r(e)),a(e,"firstItemLabel",h0,r(e)),a(e,"secondItemLabel",p0,r(e)),e}return o(l,[{key:"setInteractable",value:function(e){this.buyButton.interactable=e}},{key:"setPrice",value:function(e){this.buyButtonOpacity.opacity=255,this.priceLocalize.key="customString",this.priceLocalize.setParams([e])}},{key:"setLoadingPrice",value:function(){this.buyButtonOpacity.opacity=100,this.priceLocalize.key="loading"}},{key:"setItemCounts",value:function(e,t){this.firstItemLabel.string="x".concat(e.toString()),this.secondItemLabel.string="x".concat(t.toString())}}]),l}(k)).prototype,"buyButtonOpacity",[t0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u0=e(s0.prototype,"buyButton",[n0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c0=e(s0.prototype,"priceLocalize",[i0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h0=e(s0.prototype,"firstItemLabel",[a0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p0=e(s0.prototype,"secondItemLabel",[r0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o0=s0))||o0);g._RF.pop(),g._RF.push({},"038406q2A1LUoahVQ4/xUuD","ShopScreen",void 0);var H0,W0,V0,j0,q0,K0,Y0,J0,Z0,X0,Q0,$0,e1,t1,n1,i1=m.ccclass,a1=m.property,r1=m.requireComponent,o1=Ludex,s1=o1.Events,l1=(o1.Utils,codex),u1=l1.player,c1=l1.event;y0=i1("ShopScreen"),v0=r1(Si),g0=a1(N),m0=a1(G0),b0=a1(G0),S0=a1(G0),w0=a1(N),k0=a1(N),T0=a1(gh),C0=a1(gh),E0=a1(X),L0=a1(X),y0(x0=v0((A0=e((I0=function(e){t(m,e);var u,c,h,p,d,f,y,v,g=n(m);function m(){var e;i(this,m);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=g.call.apply(g,[this].concat(n)),a(e,"closeButtonComponent",A0,r(e)),a(e,"freeCollectionProduct",R0,r(e)),a(e,"collectionProductCombo10",P0,r(e)),a(e,"collectionProductCombo50",_0,r(e)),a(e,"buyButtonComponent",N0,r(e)),a(e,"detailsButtonComponent",O0,r(e)),a(e,"priceLocalize",B0,r(e)),a(e,"removeAdsTextLocalize",D0,r(e)),a(e,"freeText",F0,r(e)),a(e,"timerText",M0,r(e)),e.catalog=null,e.isScheduling=!1,e.handleOpeningScreen=function(){var t=s(l().mark((function t(n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(n)){t.next=2;break}return t.abrupt("return");case 2:if(e.updateButtonText(),fg.getTimeLeftToWatchAdsInShop()>0&&(e.schedule(e.updateButtonText,1),e.isScheduling=!0),e.catalog){t.next=11;break}return pt.showLoadingScreen(),t.next=9,cR.getCatalogAsync();case 9:e.catalog=t.sent,pt.closeLoadingScreen();case 11:e.updateNoAdsPriceProduct(),e.updateCollectionProducts(),e.closeButtonComponent.interactable=!0,e.buyButtonComponent.interactable=!0,e.detailsButtonComponent.interactable=!0,e.collectionProductCombo10.setInteractable(!0),e.collectionProductCombo50.setInteractable(!0),e.updateNoAdsContent(),e.logViewItemList();case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return o(m,[{key:"__preload",value:(v=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)})},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.updateCount()}},{key:"updateButtonText",value:function(){var e=fg.getTimeLeftToWatchAdsInShop();0===e?(this.freeText.node.active=!0,this.timerText.node.active=!1,this.freeCollectionProduct.setInteractable(!0),this.isScheduling&&(this.unschedule(this.updateButtonText),this.isScheduling=!1)):(this.freeText.node.active=!1,this.timerText.node.active=!0,this.timerText.string=Ot(e,!1),this.freeCollectionProduct.setInteractable(!1))}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){c1.on(s1.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){c1.off(s1.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"updateCount",value:function(){this.freeCollectionProduct.setItemCounts(uR.SHUFFLE_ITEM_COUNT,uR.HINT_ITEM_COUNT),this.collectionProductCombo10.setItemCounts(sR.SHUFFLE_ITEM_COUNT,sR.HINT_ITEM_COUNT),this.collectionProductCombo50.setItemCounts(lR.SHUFFLE_ITEM_COUNT,lR.HINT_ITEM_COUNT)}},{key:"updateNoAdsPriceProduct",value:function(){var e,t=null===(e=this.catalog)||void 0===e?void 0:e.find((function(e){return e.productID===oR.ID}));this.priceLocalize.key="customString",t?this.priceLocalize.setParams([t.price]):this.priceLocalize.setParams(["???"])}},{key:"updateCollectionProducts",value:function(){var e,t,n=null===(e=this.catalog)||void 0===e?void 0:e.find((function(e){return e.productID===sR.ID}));n?this.collectionProductCombo10.setPrice(n.price):this.collectionProductCombo10.setPrice("???");var i=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===lR.ID}));i?this.collectionProductCombo50.setPrice(i.price):this.collectionProductCombo50.setPrice("???")}},{key:"updateNoAdsContent",value:function(){if(console.log(u1.getGameData().removeAdEndTime-Date.now()),je.isInterstitialRemoved()){this.disableBuyButton();var e=je.getRemoveAdDayLeft();1===e?this.removeAdsTextLocalize.key="removedFor1Day":(this.removeAdsTextLocalize.key="removedForVDays",this.removeAdsTextLocalize.setParams([e.toString()]))}else this.enableBuyButton(),this.removeAdsTextLocalize.key="removeAdsFor30Days"}},{key:"disableBuyButton",value:function(){this.buyButtonComponent.interactable=!1,this.buyButtonComponent.getComponent(P).opacity=100,this.priceLocalize.key="purchased"}},{key:"enableBuyButton",value:(y=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.catalog){e.next=7;break}return this.buyButtonComponent.interactable=!1,this.buyButtonComponent.getComponent(P).opacity=100,this.priceLocalize.key="loading",e.next=6,cR.getCatalogAsync();case 6:this.catalog=e.sent;case 7:this.buyButtonComponent.interactable=!0,this.buyButtonComponent.getComponent(P).opacity=255,this.updateNoAdsPriceProduct();case 10:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.buyButtonComponent.interactable=!1,this.detailsButtonComponent.interactable=!1,this.freeCollectionProduct.setInteractable(!1),this.collectionProductCombo10.setInteractable(!1),this.collectionProductCombo50.setInteractable(!1),this.isScheduling&&(this.unschedule(this.updateButtonText),this.isScheduling=!1),pt.closeScreen(Ge.SHOP_SCREEN)}},{key:"handleClickedClose",value:function(){if(this.close(),this.screen.data.source){if(this.screen.data.source===Ge.FREE_ITEM_SCREEN)return;pt.openScreen(this.screen.data.source)}else this.node.scene.emit($e.GAME_RESUME)}},{key:"handleClickedBuyNoAds",value:(f=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,pt.showLoadingScreen(),this.logSelectItem(oR.ID),e.next=5,this.processPurchase(oR.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),pt.closeLoadingScreen(),this.updateNoAdsContent(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return f.apply(this,arguments)})},{key:"handleClickedCombo10",value:(d=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,pt.showLoadingScreen(),this.logSelectItem(sR.ID),e.next=5,this.processPurchase(sR.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),pt.closeLoadingScreen(),this.handleConsumeComboPurchase(sR.ID),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return d.apply(this,arguments)})},{key:"handleClickedCombo50",value:(p=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,pt.showLoadingScreen(),this.logSelectItem(lR.ID),e.next=5,this.processPurchase(lR.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),pt.closeLoadingScreen(),this.handleConsumeComboPurchase(lR.ID),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return p.apply(this,arguments)})},{key:"handleAdsWatchForFreeItem",value:(h=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fg.canWatchAds("shop")){e.next=3;break}return pt.showNotificationScreen("youHaveReachedTheDailyAdLimit",3),e.abrupt("return");case 3:return e.next=5,je.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0});case 5:e.sent&&(fg.watchedAds("shop"),this.logSelectItem(uR.ID),this.showRewardScreen(uR.HINT_ITEM_COUNT,uR.SHUFFLE_ITEM_COUNT,uR.ID,!1,cN),this.updateButtonText(),fg.getTimeLeftToWatchAdsInShop()>0&&(this.schedule(this.updateButtonText,1),this.isScheduling=!0));case 7:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleClosePurchase",value:function(e){console.error("Purchase failed:",e),pt.closeLoadingScreen();var t=e instanceof Error?e.message:"purchaseFailed";pt.showNotificationScreen(t,3),this.logPurchaseCancel(t)}},{key:"handleClickedDetails",value:function(){pt.showNotificationScreen("removeAdPolicy")}},{key:"processPurchase",value:(c=s(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cR.purchaseAsync(t);case 2:return n=e.sent,e.next=5,cR.consumePurchaseAsync(t,n.purchaseToken);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"handleConsumeComboPurchase",value:(u=s(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===sR.ID||t===lR.ID){e.next=2;break}return e.abrupt("return");case 2:if(null!==this.catalog){e.next=8;break}return this.collectionProductCombo10.setLoadingPrice(),this.collectionProductCombo50.setLoadingPrice(),e.next=7,cR.getCatalogAsync();case 7:this.catalog=e.sent;case 8:if(this.collectionProductCombo10.setInteractable(!0),this.collectionProductCombo50.setInteractable(!0),null===(n=this.catalog)||void 0===n?void 0:n.find((function(e){return e.productID===t}))){e.next=13;break}return e.abrupt("return");case 13:t===sR.ID?(i=sR.SHUFFLE_ITEM_COUNT,a=sR.HINT_ITEM_COUNT,this.showRewardScreen(a,i,t,!0,hN)):(i=lR.SHUFFLE_ITEM_COUNT,a=lR.HINT_ITEM_COUNT,this.showRewardScreen(a,i,t,!0,pN));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"showRewardScreen",value:function(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,o={items:[{item:lt.HINT,count:e},{item:lt.SHUFFLE,count:t}],watchAdsDoubleReward:!1,title:"You have received",chestId:r,doNotUpdatePlayerData:a,successCallback:function(){i.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.HINT,ut.getItemCount(ct[lt.HINT])),i.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.SHUFFLE,ut.getItemCount(ct[lt.SHUFFLE]))},earnFrom:Ue[Ge.SHOP_SCREEN]};pt.openScreen(Ge.REWARD_SCREEN,o)}},{key:"logViewItemList",value:function(){codex.analytics.event(gt.VIEW_ITEM_LIST)}},{key:"logSelectItem",value:function(e){codex.analytics.event(gt.SELECT_ITEM,{product_id:e})}},{key:"logPurchaseSuccess",value:function(e){var t,n=e.productID,i=e.purchaseToken,a=e.purchaseTime,r=e.paymentID,o=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===n}));o&&codex.analytics.event(gt.PURCHASE,{product_id:n,purchase_token:i,purchase_time:a,payment_id:r,price:o.priceAmount,currency:o.priceCurrencyCode,product_name:o.title})}},{key:"logPurchaseCancel",value:function(e){var t,n=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===oR.ID}));n&&codex.analytics.event(gt.PURCHASE_CANCEL,{product_id:n.productID,price:n.priceAmount,currency:n.priceCurrencyCode,product_name:n.title,error_message:e})}}]),m}(k)).prototype,"closeButtonComponent",[g0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R0=e(I0.prototype,"freeCollectionProduct",[m0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P0=e(I0.prototype,"collectionProductCombo10",[b0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_0=e(I0.prototype,"collectionProductCombo50",[S0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N0=e(I0.prototype,"buyButtonComponent",[w0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O0=e(I0.prototype,"detailsButtonComponent",[k0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B0=e(I0.prototype,"priceLocalize",[T0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D0=e(I0.prototype,"removeAdsTextLocalize",[C0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0=e(I0.prototype,"freeText",[E0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M0=e(I0.prototype,"timerText",[L0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x0=I0))||x0);g._RF.pop(),g._RF.push({},"2bac24dA51Or6QUQ/IlKDo4","BackgroundContent",void 0);var h1,p1,d1,f1,y1,v1,g1,m1,b1,S1,w1,k1,T1,C1,E1,L1,x1,I1=m.ccclass,A1=m.property,R1=(H0=I1("BackgroundContent"),W0=A1(A),V0=A1(A),j0=A1(A),q0=A1(A),K0=A1(A),Y0=A1(A),H0((X0=e((Z0=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"bg1Selector",X0,r(e)),a(e,"bg2Selector",Q0,r(e)),a(e,"bg3Selector",$0,r(e)),a(e,"bg4Selector",e1,r(e)),a(e,"bg5Selector",t1,r(e)),a(e,"bg6Selector",n1,r(e)),e}return o(h,[{key:"__preload",value:function(){}},{key:"updateBackground",value:function(e){Object.values(Et).includes(e)&&(this.unselectAllBackgroundButtons(),this.selectBackgroundButton(e))}},{key:"handleClickedBackgroundButton",value:(u=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n,Object.values(Et).includes(i)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ne.updateBackgroundKey(i);case 5:this.updateBackground(n),this.node.scene.emit($e.THEME_BACKGROUND_CHANGE),Ne.logThemeBackgroundChange(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"unselectAllBackgroundButtons",value:function(){this.bg1Selector.active=!1,this.bg2Selector.active=!1,this.bg3Selector.active=!1,this.bg4Selector.active=!1,this.bg5Selector.active=!1,this.bg6Selector.active=!1}},{key:"selectBackgroundButton",value:function(e){e===Et.BG1?this.bg1Selector.active=!0:e===Et.BG2?this.bg2Selector.active=!0:e===Et.BG3?this.bg3Selector.active=!0:e===Et.BG4?this.bg4Selector.active=!0:e===Et.BG5?this.bg5Selector.active=!0:e===Et.BG6&&(this.bg6Selector.active=!0)}}]),h}(k)).prototype,"bg1Selector",[W0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q0=e(Z0.prototype,"bg2Selector",[V0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$0=e(Z0.prototype,"bg3Selector",[j0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e1=e(Z0.prototype,"bg4Selector",[q0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t1=e(Z0.prototype,"bg5Selector",[K0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n1=e(Z0.prototype,"bg6Selector",[Y0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J0=Z0))||J0);g._RF.pop(),g._RF.push({},"85735WG2ORGvKtf3/fzWGvh","Tab",void 0);var P1,_1,N1,O1,B1,D1,F1,M1,z1,U1,G1,H1,W1,V1=m.ccclass,j1=m.property,q1=(Ludex.Events,codex.event,h1=V1("Tab"),p1=j1(E),d1=j1(N),f1=j1(N),y1=j1(X),v1=j1(X),g1=j1(A),m1=j1(A),h1((w1=e((S1=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"tabSprite",w1,r(e)),a(e,"tileButton",k1,r(e)),a(e,"backgroundButton",T1,r(e)),a(e,"tileLabel",C1,r(e)),a(e,"backgroundLabel",E1,r(e)),a(e,"tileNode",L1,r(e)),a(e,"backgroundNode",x1,r(e)),e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"handleClickedTileButton",value:function(){this.tabSprite.node.setScale(-1,1,1),this.tileButton.node.active=!1,this.backgroundButton.node.active=!0,this.tileLabel.node.active=!0,this.backgroundLabel.node.active=!1,this.switchToTileNode()}},{key:"handleClickedBackgroundButton",value:function(){this.tabSprite.node.setScale(1,1,1),this.tileButton.node.active=!0,this.backgroundButton.node.active=!1,this.tileLabel.node.active=!1,this.backgroundLabel.node.active=!0,this.switchToBackgroundNode()}},{key:"switchToTileNode",value:function(){this.tileNode.active=!0,this.backgroundNode.active=!1}},{key:"switchToBackgroundNode",value:function(){this.tileNode.active=!1,this.backgroundNode.active=!0}}]),l}(k)).prototype,"tabSprite",[p1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k1=e(S1.prototype,"tileButton",[d1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T1=e(S1.prototype,"backgroundButton",[f1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C1=e(S1.prototype,"tileLabel",[y1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E1=e(S1.prototype,"backgroundLabel",[v1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=e(S1.prototype,"tileNode",[g1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x1=e(S1.prototype,"backgroundNode",[m1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b1=S1))||b1);g._RF.pop(),g._RF.push({},"4bdfeYQar5DdZNmrOzJpcwS","TilesContent",void 0);var K1,Y1,J1,Z1,X1,Q1,$1,e2,t2,n2,i2,a2,r2=m.ccclass,o2=m.property,s2=(P1=r2("TilesContent"),_1=o2(A),N1=o2(A),O1=o2(A),B1=o2(A),D1=o2(A),P1((z1=e((M1=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"classicSelector",z1,r(e)),a(e,"flowerSelector",U1,r(e)),a(e,"violetSelector",G1,r(e)),a(e,"antiqueSelector",H1,r(e)),a(e,"simpleSelector",W1,r(e)),e}return o(h,[{key:"__preload",value:function(){}},{key:"updateTileset",value:function(e){Object.values(Bt).includes(e)&&(this.unselectAllTilesetButtons(),this.selectTilesetButton(e))}},{key:"handleClickedTilesetButton",value:(u=s(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n,Object.values(Bt).includes(i)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ne.updateTilesetKey(i);case 5:this.updateTileset(n),this.node.scene.emit($e.THEME_TILE_CHANGE),Ne.logThemeTileChange(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"unselectAllTilesetButtons",value:function(){this.classicSelector.active=!1,this.antiqueSelector.active=!1,this.simpleSelector.active=!1,this.violetSelector.active=!1,this.flowerSelector.active=!1}},{key:"selectTilesetButton",value:function(e){e===Bt.CLASSIC?this.classicSelector.active=!0:e===Bt.ANTIQUE?this.antiqueSelector.active=!0:e===Bt.SIMPLE?this.simpleSelector.active=!0:e===Bt.VIOLET?this.violetSelector.active=!0:e===Bt.FLOWER&&(this.flowerSelector.active=!0)}},{key:"handleContentScroll",value:function(e,t,n){12===t&&(this.classicSelector.getParent().getComponent(N).interactable=!1,this.antiqueSelector.getParent().getComponent(N).interactable=!1,this.simpleSelector.getParent().getComponent(N).interactable=!1,this.violetSelector.getParent().getComponent(N).interactable=!1,this.flowerSelector.getParent().getComponent(N).interactable=!1),9===t&&(this.classicSelector.getParent().getComponent(N).interactable=!0,this.antiqueSelector.getParent().getComponent(N).interactable=!0,this.simpleSelector.getParent().getComponent(N).interactable=!0,this.violetSelector.getParent().getComponent(N).interactable=!0,this.flowerSelector.getParent().getComponent(N).interactable=!0)}}]),h}(k)).prototype,"classicSelector",[_1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U1=e(M1.prototype,"flowerSelector",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G1=e(M1.prototype,"violetSelector",[O1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H1=e(M1.prototype,"antiqueSelector",[B1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W1=e(M1.prototype,"simpleSelector",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F1=M1))||F1);g._RF.pop(),g._RF.push({},"b3f53ktoLdJWo5xM/rk0qZ9","ThemeScreen",void 0);var l2,u2,c2,h2,p2,d2,f2,y2,v2,g2,m2,b2,S2,w2,k2,T2=m.ccclass,C2=m.property,E2=m.requireComponent,L2=Ludex.Events,x2=codex,I2=x2.player,A2=x2.event;K1=T2("ThemeScreen"),Y1=E2(Si),J1=C2(N),Z1=C2(s2),X1=C2(R1),Q1=C2(q1),K1($1=Y1((t2=e((e2=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"closeButtonComponent",t2,r(e)),a(e,"tilesContent",n2,r(e)),a(e,"backgroundContent",i2,r(e)),a(e,"tabComponent",a2,r(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.tabComponent.handleClickedTileButton(),e.closeButtonComponent.interactable=!0,e.updateStatus())},e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){A2.on(L2.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){A2.off(L2.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.runPopUpAnimation()}},{key:"updateStatus",value:function(){var e=I2.getPlayerSetting("theme");console.log("asasas updateStatus",e),e&&(this.tilesContent.updateTileset(e.tileset),this.backgroundContent.updateBackground(e.background))}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("ThemeScreen: screen not found")}},{key:"handleClickedClose",value:function(){var e=void 0!==this.screen.data.source;pt.closeScreen(Ge.THEME_SCREEN,{openNextScreenImmediately:e}),this.screen.data.source?pt.openScreen(this.screen.data.source):this.node.scene.emit($e.GAME_RESUME)}}]),l}(k)).prototype,"closeButtonComponent",[J1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n2=e(e2.prototype,"tilesContent",[Z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i2=e(e2.prototype,"backgroundContent",[X1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a2=e(e2.prototype,"tabComponent",[Q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$1=e2))||$1);g._RF.pop(),g._RF.push({},"937bfvpekFMLYYWakX0eoGI","Leader",void 0);var R2,P2,_2,N2,O2,B2,D2,F2=m.ccclass,M2=m.property,z2=120,U2=(l2=F2("Leader"),u2=M2(X),c2=M2(X),h2=M2(X),p2=M2(E),d2=M2(E),f2=M2(E),l2((g2=e((v2=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=c.call.apply(c,[this].concat(n))).score=0,e.leaderName="",e.rank=0,a(e,"rankLabel",g2,r(e)),a(e,"nameLabel",m2,r(e)),a(e,"scoreLabel",b2,r(e)),a(e,"avatarSprite",S2,r(e)),a(e,"medalSprite",w2,r(e)),a(e,"rewardSprite",k2,r(e)),e}return o(h,[{key:"setRank",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.rank=e,this.rankLabel.string=this.rank.toString(),this.rank<=0&&(this.rankLabel.string="--"),this.rank>99&&(this.rankLabel.string="99+"),this.rank>3||this.rank<=0?this.rankLabel.node.active=!0:this.rankLabel.node.active=!1,Dt.includes(this.rank)&&t?this.rewardSprite.node.active=!0:this.rewardSprite.node.active=!1}},{key:"setName",value:function(e){this.leaderName=e,this.nameLabel.string=this.leaderName}},{key:"setScore",value:function(e){this.score=e,this.score<0&&(this.score=0),this.scoreLabel.string=this.score.toString()}},{key:"setAvatar",value:(u=s(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ft.getCachedLeaderAvatar(t)){e.next=5;break}return n=ft.getCachedLeaderAvatar(t),this.avatarSprite.spriteFrame=n,this.avatarSprite.node.getComponent(L).setContentSize(z2,z2),e.abrupt("return");case 5:return e.next=7,Ludex.Utils.Image.loadImage(t);case 7:i=e.sent,a=ae.createWithImage(i),this.avatarSprite.spriteFrame=a,this.avatarSprite.node.getComponent(L).setContentSize(z2,z2),ft.setCachedLeaderAvatar(t,a);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setAvatarSprite",value:function(e){this.avatarSprite.spriteFrame=e,this.avatarSprite.node.getComponent(L).setContentSize(z2,z2)}},{key:"setRankSprite",value:function(e){this.medalSprite.spriteFrame=e}},{key:"setRewardSprite",value:function(e){this.rewardSprite.spriteFrame=e}},{key:"getRank",value:function(){return this.rank}},{key:"getName",value:function(){return this.leaderName}},{key:"getScore",value:function(){return this.score}}]),h}(k)).prototype,"rankLabel",[u2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m2=e(v2.prototype,"nameLabel",[c2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b2=e(v2.prototype,"scoreLabel",[h2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S2=e(v2.prototype,"avatarSprite",[p2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w2=e(v2.prototype,"medalSprite",[d2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k2=e(v2.prototype,"rewardSprite",[f2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y2=v2))||y2);g._RF.pop(),g._RF.push({},"cb16dmedgZB3bXDDg5eoCZE","GoldTileComplete",void 0);var G2,H2,W2,V2,j2,q2,K2,Y2,J2,Z2,X2,Q2,$2,e5,t5,n5,i5,a5,r5,o5,s5,l5,u5,c5,h5,p5,d5=m.ccclass,f5=m.property,y5=(Ludex.Utils.Signal,R2=d5("GoldTileComplete"),P2=f5(se),_2=f5(ee),R2((B2=e((O2=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"motionStreakComponent",B2,r(e)),a(e,"particleSystemComponent",D2,r(e)),e}return o(h,[{key:"resetTile",value:function(){this.node.setPosition(new F(0,0,0)),this.node.active=!0,this.motionStreakComponent.node.active=!1,this.particleSystemComponent.node.active=!1,this.particleSystemComponent.resetSystem()}},{key:"hideTile",value:function(){this.node.setPosition(new F(0,0,0)),this.node.active=!1,this.motionStreakComponent.node.active=!1,this.particleSystemComponent.node.active=!1}},{key:"playCollectAnimation",value:(u=s(l().mark((function e(t,n,i,a,r,o){var s,u=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.motionStreakComponent.node.active=!0,this.particleSystemComponent.node.active=!0,s=Ve.runTweenAsync(B(this.node).delay(r).to(.2,{worldPositionX:a},{easing:"sineOut"}).to(.25,{worldPositionX:n},{easing:"sineIn"}).call((function(){u.node.active=!1,null==o||o()})),t),Ve.runTweenAsync(B(this.node).delay(r).to(.45,{worldPositionY:i},{easing:"sineOut"}),t),e.next=6,s;case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,r){return u.apply(this,arguments)})}]),h}(k)).prototype,"motionStreakComponent",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D2=e(O2.prototype,"particleSystemComponent",[_2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N2=O2))||N2);g._RF.pop(),g._RF.push({},"d68e2Ddqo1L7o89/8bNCISn","TournamentCompleteScreen",void 0);var v5,g5,m5,b5,S5,w5,k5,T5,C5,E5,L5,x5,I5,A5,R5,P5,_5,N5,O5,B5,D5=m.ccclass,F5=m.property,M5=m.requireComponent,z5=Ludex,U5=z5.Utils.Signal,G5=z5.Events,H5=(z5.Utils,codex),W5=H5.player,V5=H5.event,j5=H5.match;H5.leaderboard,G2=D5("TournamentCompleteScreen"),H2=M5(Si),W2=F5([ae]),V2=F5([ae]),j2=F5(X),q2=F5(gh),K2=F5(J),Y2=F5([U2]),J2=F5(U2),Z2=F5(A),X2=F5(A),Q2=F5(A),$2=F5([y5]),G2(e5=H2((n5=e((t5=function(e){t(v,e);var u,c,h,p,f,y=n(v);function v(){var e;i(this,v);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=y.call.apply(y,[this].concat(n))).score=0,e.level=0,e.numberOfGolden=0,e.rank=100,e.lastRank=1e3,e.rankUpSignalController=new U5.SignalController,e.goldIconSignalController=new U5.SignalController,e.targetIndex=void 0,e.sessionLeaders=[],a(e,"leadersAvatars",n5,r(e)),a(e,"medals",i5,r(e)),a(e,"timeTextLabel",a5,r(e)),a(e,"timeTextLocalize",r5,r(e)),a(e,"scrollViewComponent",o5,r(e)),a(e,"leaders",s5,r(e)),a(e,"playerLeader",l5,r(e)),a(e,"playerScoreIcon",u5,r(e)),a(e,"goldenTilesContainer",c5,r(e)),a(e,"leaderExplosionEffect",h5,r(e)),a(e,"goldenTiles",p5,r(e)),e.handleOpeningScreen=function(t){e.scrollViewComponent.node.pauseSystemEvents(!0),e.rankUpSignal=e.rankUpSignalController.renew(),e.goldIconSignal=e.goldIconSignalController.renew(),e.validateEventPayload(t)&&(e.score=t.screenData.score||0,e.level=t.screenData.level||0,e.numberOfGolden=ft.getGoldenTilesPerLevel(),e.scrollViewComponent.scrollToBottom(0))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.handleLeaderboardData()},e}return o(v,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.schedule(this.updateTimeText,1),this.setDefaultLeader()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){V5.on(G5.OPENING_SCREEN,this.handleOpeningScreen),V5.on(G5.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){V5.off(G5.OPENING_SCREEN,this.handleOpeningScreen),V5.off(G5.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"handleLeaderboardData",value:(f=s(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resetStates(),!(ft.getTournamentRank()<=0)){e.next=12;break}if(pt.showLoadingScreen(),!ft.completeLevelPromise){e.next=7;break}return e.next=6,ft.completeLevelPromise;case 6:ft.completeLevelPromise=void 0;case 7:return e.next=9,ft.updateCurrentLeaderboard();case 9:pt.closeLoadingScreen(),e.next=13;break;case 12:ft.updateCurrentLeaderboard();case 13:this.updateLeaders(),this.updateTimeText(),ft.getIsNewSession()&&ft.getLeaderboard().length>=10?this.runRankUpAnimation(this.rankUpSignal):this.runRankStayAnimation(this.rankUpSignal);case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){pt.closeScreen(Ge.TOURNAMENT_COMPLETE_SCREEN)}},{key:"handleClickedContinueButton",value:function(){this.close(),pt.openScreen(Ge.WINNING_SCREEN,{score:this.score,level:this.level}),this.rankUpSignalController.abort();var e,t=d(this.goldenTiles);try{for(t.s();!(e=t.n()).done;){e.value.hideTile()}}catch(e){t.e(e)}finally{t.f()}ft.setIsNewSession(!1)}},{key:"resetStates",value:function(){for(var e=0;e<this.leaders.length;e++){var t=this.leaders[e];t.node.active=!1;var n=t.node.position;n.set(n.x,-110-203*e,n.z),t.node.setPosition(n)}this.playerLeader.node.setPosition(this.leaders[3].node.position),this.playerLeader.node.setScale(new F(1,1,1)),this.setLeaderRank(this.playerLeader,0),this.playerScoreIcon.setScale(new F(1,1,1)),this.goldenTilesContainer.setScale(new F(0,0,0));var i,a=d(this.goldenTiles);try{for(a.s();!(i=a.n()).done;){i.value.resetTile()}}catch(e){a.e(e)}finally{a.f()}}},{key:"updateTimeText",value:function(){var e=ft.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"updateLeaders",value:function(){var e=W5.getPlayerId(),t=ft.getTournamentData().bestScore,n=ft.getTournamentRank();this.lastRank=this.rank>0?this.rank:n+9,this.rank=n,console.log("TournamentCompleteScreen: updateLeaders",this.rank,this.lastRank);var i=j5.getMatchState().profiles[e];this.playerLeader.setAvatar(i.photo),this.playerLeader.setName(i.name);var a=ft.getLeaderboard().filter((function(t){return t.score>0&&t.playerId!==e}));this.validateLeadersRank(a,t),this.updateLeadersInfo(a,t),this.enableLeaders(a),this.playerLeader.setScore(t-this.numberOfGolden),console.log("TournamentCompleteScreen: runRankUpAnimation",this.rank)}},{key:"updateLeadersInfo",value:function(e,t){if(this.rank<4){this.setLeaderRank(this.playerLeader,13);for(var n=0;n<this.leaders.length;n++){var i=this.leaders[n];if(this.setLeaderRank(i,n+1),n<e.length){var a=e[n];i.setName(a.name),i.setAvatar(a.avatarUrl),i.setScore(a.score),n+1===this.rank&&(this.targetIndex=n)}else if(n+1===this.rank)this.targetIndex=n,i.setScore(Math.max(t-this.numberOfGolden,this.numberOfGolden));else if(n+1>this.rank)if(e.length>0&&this.rank-1<=e.length){var r=Math.max(e[e.length-1].score-this.numberOfGolden*(n+1-this.rank),this.numberOfGolden);r>t&&(r=t-this.numberOfGolden),i.setScore(r)}else{var o=Math.max(t-this.numberOfGolden*(n+1-this.rank),this.numberOfGolden);i.setScore(o)}else i.setScore(t)}}else{this.setLeaderRank(this.playerLeader,this.rank+9);for(var s=0;s<this.leaders.length;s++){var l=this.leaders[s];if(this.setLeaderRank(l,this.rank+s-3),this.rank+s-4<e.length){var u=e[this.rank+s-4];l.setName(u.name),l.setAvatar(u.avatarUrl),l.setScore(u.score),3===s&&(this.targetIndex=s)}else if(3===s)this.targetIndex=s,l.setScore(Math.max(t-this.numberOfGolden,this.numberOfGolden));else if(s>3)if(e.length>0&&this.rank-1<=e.length){var c=Math.max(e[e.length-1].score-this.numberOfGolden*(s-3),this.numberOfGolden);c>t&&(c=t-this.numberOfGolden),l.setScore(c)}else{var h=Math.max(t-this.numberOfGolden*(s-3),this.numberOfGolden);l.setScore(h)}else l.setScore(t)}}}},{key:"enableLeaders",value:function(e){if(this.rank<=10&&e.length>=9){console.log("TournamentCompleteScreen: runRankUpAnimation",this.rank);for(var t=0;t<this.leaders.length;t++){var n=this.leaders[t];n&&(n.node.active=!0)}this.rank<4?this.targetIndex=this.rank-1:this.targetIndex=3}else if(this.rank<=10&&e.length<9){for(var i=Math.max(0,this.rank-4),a=0;a<e.length-i;a++){var r=this.leaders[a];r&&(r.node.active=!0)}this.rank<4?this.targetIndex=this.rank-1:this.targetIndex=3}else for(var o=0;o<this.leaders.length;o++){var s=this.leaders[o];s&&(s.node.active=!0)}(!ft.getIsNewSession()||ft.getLeaderboard().length<10)&&this.setLeaderRank(this.playerLeader,this.rank)}},{key:"setDefaultLeader",value:function(){for(var e=[],t=0;t<this.leadersAvatars.length;t++)e.push(t);Ludex.Utils.Array.shuffle(e);for(var n=0;n<this.leaders.length;n++){var i=this.leaders[n],a=Math.floor(Math.random()*Ft.length),r=Ft[a].split(" ");i.setName(r[0]);var o=e[n%e.length],s=this.leadersAvatars[o];i.setAvatarSprite(s),this.sessionLeaders.push({name:i.getName(),score:0,photo:s})}this.rank=ft.inst.viewedRank}},{key:"runRankUpAnimation",value:(p=s(l().mark((function e(t){var n,i,a,r,o,s,u,c,h=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=W5.getPlayerId(),i=j5.getMatchState().profiles[n],console.log("TournamentCompleteScreen: runRankUpAnimation",i),e.next=5,this.runGoldenTilesAnimation(t,ft.getTournamentData().bestScore);case 5:return e.next=7,Ve.runTweenAsync(B(this.playerLeader.node).to(.3,{scale:new F(1.1,1.1,1)}),t);case 7:if(this.scrollViewComponent.scrollToTop(1.6),void 0===this.targetIndex){e.next=17;break}for(a=new F(this.leaders[this.targetIndex].node.position.x,this.leaders[this.targetIndex].node.position.y,this.leaders[this.targetIndex].node.position.z),console.log("vvvvvvv",this.targetIndex,a),r=this.leaders.length-1,o=function(){if(!(r<0)){var e=h.leaders[r];if(e.node.worldPositionY<h.playerLeader.node.worldPositionY){r--;var t=e.getRank();h.setLeaderRank(e,t+1),h.setLeaderRank(h.playerLeader,t)}}},s=this.targetIndex;s<this.leaders.length;s++)u=this.leaders[s],(c=new F(u.node.position.x,u.node.position.y,u.node.position.z)).set(c.x,c.y-203,c.z),Ve.runTweenAsync(B(u.node).delay(1.1*re.cubicIn((this.leaders.length-s)/(this.leaders.length-this.targetIndex))).to(.3,{position:c},{easing:"quartOut"}),t);return Ve.runTweenAsync(B(this.playerLeader.node).update(1.6,o).call((function(){h.setLeaderRank(h.playerLeader,h.rank)})),t),e.next=17,Ve.runTweenAsync(B(this.playerLeader.node).delay(.9).to(.4,{position:a},{easing:re.sineInOut}),t);case 17:return Ve.waitTweenAsync(.35,t).then((function(){h.runLeaderExplosionEffect()})),e.next=20,Ve.runTweenAsync(B(this.playerLeader.node).to(.2,{scale:new F(1.15,1.15,1)},{easing:"sineOut"}).to(.2,{scale:new F(1,1,1)},{easing:"backOut"}),t);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"runRankStayAnimation",value:(h=s(l().mark((function e(t){var n,i,a,r,o,s,u,c,h=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=W5.getPlayerId(),i=j5.getMatchState().profiles[n],console.log("TournamentCompleteScreen: runRankStayAnimation",i),this.scrollViewComponent.scrollToTop(),a=new F(this.leaders[this.targetIndex].node.position.x,this.leaders[this.targetIndex].node.position.y,this.leaders[this.targetIndex].node.position.z),r=this.targetIndex;r<this.leaders.length;r++)o=this.leaders[r],(s=new F(o.node.position.x,o.node.position.y,o.node.position.z)).set(s.x,s.y-203,s.z),o.node.setPosition(s),this.setLeaderRank(o,o.getRank()+1);for(u=0;u<this.targetIndex;u++)c=this.leaders[u],this.setLeaderRank(c,c.getRank());return this.setLeaderRank(this.playerLeader,this.rank),this.playerLeader.node.setPosition(a),e.next=11,this.runGoldenTilesAnimation(t,ft.getTournamentData().bestScore);case 11:return Ve.waitTweenAsync(.45,t).then((function(){h.runLeaderExplosionEffect()})),e.next=14,Ve.runTweenAsync(B(this.playerLeader.node).to(.3,{scale:new F(1.15,1.15,1)},{easing:"cubicOut"}),t);case 14:return e.next=16,Ve.runTweenAsync(B(this.playerLeader.node).to(.2,{scale:new F(1,1,1)},{easing:"backOut"}),t);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"runGoldenTilesAnimation",value:(c=s(l().mark((function e(t,n){var i,a,r=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.goldenTilesContainer.children.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ve.runTweenAsync(B(this.goldenTilesContainer).set({scale:new F(0,0,0)}).delay(.3).to(.25,{scale:new F(1,1,1)},{easing:"backOut"}),t);case 4:for(i=0;i<this.goldenTiles.length;i++)this.goldenTiles[this.goldenTiles.length-i-1].playCollectAnimation(t,this.playerScoreIcon.worldPositionX,this.playerScoreIcon.worldPositionY,this.playerScoreIcon.worldPositionX-300,.25*i,(function(){r.goldIconSignal=r.goldIconSignalController.renew(),r.runGoldTileIconAnimation(r.goldIconSignal)}));return a={value:n-this.numberOfGolden},e.next=8,Ve.runTweenAsync(B(a).to(1.5,{value:n},{onUpdate:function(e){r.playerLeader.setScore(Math.floor(e.value))}}),t);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"runGoldTileIconAnimation",value:(u=s(l().mark((function e(t){var n,i=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerScoreIcon){e.next=2;break}return e.abrupt("return");case 2:n=this.playerScoreIcon.getScale(),Ve.runTweenAsync(B(this.playerScoreIcon).set({scale:n}).to(.2,{scale:new F(1.2,1.2,1.2)},{easing:"sineIn"}).call((function(){i.playerScoreIcon.setScale(n)})),t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"runLeaderExplosionEffect",value:function(){if(this.leaderExplosionEffect){this.leaderExplosionEffect.setPosition(this.playerLeader.node.position);var e,t=d(this.leaderExplosionEffect.getComponentsInChildren(ee));try{for(t.s();!(e=t.n()).done;){e.value.resetSystem()}}catch(e){t.e(e)}finally{t.f()}}}},{key:"setLeaderRank",value:function(e,t){e.setRank(t,!1),t>3||t<=0?e.setRankSprite(this.medals[3]):e.setRankSprite(this.medals[t-1])}},{key:"validateLeadersRank",value:function(e,t){for(var n=0;n+1<this.rank&&n<e.length;n++){if(e[n].score<t)return void(this.rank=n+1)}e.length<Mt&&(this.rank=Math.min(this.rank,e.length+1))}}]),v}(k)).prototype,"leadersAvatars",[W2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i5=e(t5.prototype,"medals",[V2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a5=e(t5.prototype,"timeTextLabel",[j2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r5=e(t5.prototype,"timeTextLocalize",[q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o5=e(t5.prototype,"scrollViewComponent",[K2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s5=e(t5.prototype,"leaders",[Y2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l5=e(t5.prototype,"playerLeader",[J2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u5=e(t5.prototype,"playerScoreIcon",[Z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c5=e(t5.prototype,"goldenTilesContainer",[X2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h5=e(t5.prototype,"leaderExplosionEffect",[Q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p5=e(t5.prototype,"goldenTiles",[$2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),e5=t5))||e5);g._RF.pop(),g._RF.push({},"4c2349w3cFL0qV4hs+rKwmH","TournamentInfoScreen",void 0);var q5,K5,Y5,J5,Z5,X5,Q5,$5,e3,t3,n3,i3,a3,r3,o3,s3,l3,u3,c3,h3,p3,d3,f3,y3,v3,g3,m3,b3,S3=m.ccclass,w3=m.property,k3=m.requireComponent,T3=Ludex,C3=T3.Events,E3=T3.Utils,L3=codex,x3=(L3.player,L3.event),I3=.3;v5=S3("TournamentInfoScreen"),g5=k3(Si),m5=w3(N),b5=w3(z),S5=w3(P),w5=w3(P),k5=w3(P),T5=w3(P),C5=w3(P),E5=w3(P),v5(L5=g5((I5=e((x5=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=s.call.apply(s,[this].concat(n))).controller=new E3.Signal.SignalController,a(e,"triggerMaskButtonComponent",I5,r(e)),a(e,"containerWidget",A5,r(e)),a(e,"winLevelsNode",R5,r(e)),a(e,"arrow1",P5,r(e)),a(e,"collectTilesNode",_5,r(e)),a(e,"arrow2",N5,r(e)),a(e,"improveRankingNode",O5,r(e)),a(e,"tapToContinue",B5,r(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.triggerMaskButtonComponent.interactable=!0,e.open())},e}return o(l,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){x3.on(C3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){x3.off(C3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.runPopUpAnimation()}},{key:"close",value:function(){this.triggerMaskButtonComponent.interactable=!1,pt.closeScreen(Ge.TOURNAMENT_INFO_SCREEN)}},{key:"updateStatus",value:function(){var e=je.getBannerAdsHeight();this.containerWidget.bottom=e}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentInfoScreen: screen not found");var e=this.controller.renew();Ve.runTweenAsync(B(this.winLevelsNode).set({opacity:0}).delay(I3).to(I3,{opacity:255}).start(),e),Ve.runTweenAsync(B(this.arrow1).set({opacity:0}).delay(.6).to(I3,{opacity:255}).start(),e),Ve.runTweenAsync(B(this.collectTilesNode).set({opacity:0}).delay(.8999999999999999).to(I3,{opacity:255}).start(),e),Ve.runTweenAsync(B(this.arrow2).set({opacity:0}).delay(1.2).to(I3,{opacity:255}).start(),e),Ve.runTweenAsync(B(this.improveRankingNode).set({opacity:0}).delay(1.5).to(I3,{opacity:255}).start(),e),Ve.runTweenAsync(B(this.tapToContinue).set({opacity:0}).delay(1.7999999999999998).to(I3,{opacity:255}).start(),e)}},{key:"handleClickedTriggerMask",value:function(){this.close()}}]),l}(k)).prototype,"triggerMaskButtonComponent",[m5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A5=e(x5.prototype,"containerWidget",[b5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R5=e(x5.prototype,"winLevelsNode",[S5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P5=e(x5.prototype,"arrow1",[w5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_5=e(x5.prototype,"collectTilesNode",[k5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N5=e(x5.prototype,"arrow2",[T5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O5=e(x5.prototype,"improveRankingNode",[C5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B5=e(x5.prototype,"tapToContinue",[E5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L5=x5))||L5);g._RF.pop(),g._RF.push({},"e24d9VkfKtDloxxVDAL347i","TournamentLeaderboardScreen",void 0);var A3,R3,P3,_3,N3,O3,B3,D3,F3,M3,z3,U3,G3,H3,W3=m.ccclass,V3=m.property,j3=m.requireComponent,q3=Ludex,K3=q3.Events,Y3=(q3.Utils,codex),J3=Y3.player,Z3=Y3.event,X3=Y3.leaderboard;q5=W3("TournamentLeaderboardScreen"),K5=j3(Si),Y5=V3({type:q}),J5=V3({type:q}),Z5=V3(A),X5=V3(N),Q5=V3(N),$5=V3(N),e3=V3(A),t3=V3(X),n3=V3(gh),i3=V3(U2),a3=V3([ae]),r3=V3([ae]),q5(o3=K5((l3=e((s3=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"leaderPrefab",l3,r(e)),a(e,"playerLeaderPrefab",u3,r(e)),a(e,"leaderContainerContent",c3,r(e)),a(e,"closeButtonComponent",h3,r(e)),a(e,"infoButtonComponent",p3,r(e)),a(e,"continueButtonComponent",d3,r(e)),a(e,"continueTab",f3,r(e)),a(e,"timeTextLabel",y3,r(e)),a(e,"timeTextLocalize",v3,r(e)),a(e,"playerLeaderComponent",g3,r(e)),a(e,"medals",m3,r(e)),a(e,"rewards",b3,r(e)),e.leaderNodes=[],e.playerLeaderInBoardNode=null,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.infoButtonComponent.interactable=!0,e.continueButtonComponent.interactable=!0,e.updateStatus())},e}return o(p,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.schedule(this.updateTimeText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Z3.on(K3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){Z3.off(K3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.updateTimeText(),this.runPopUpAnimation()}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.infoButtonComponent.interactable=!1,this.continueButtonComponent.interactable=!1,pt.closeScreen(Ge.TOURNAMENT_LEADERBOARD_SCREEN)}},{key:"updateStatus",value:(c=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ft.getLeaderboardId(),X3.addLeaderboard({type:"tournament",name:t,autoSortRank:!0,leaderboardId:t}),this.updateLeaderboardData(),ft.inst.viewedRank=ft.getTournamentRank(),ft.getTournamentData().isFirstTimeJoinedTournament&&(pt.openScreen(Ge.TOURNAMENT_INFO_SCREEN),ft.updateTournamentData({isFirstTimeJoinedTournament:!1}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"updateTimeText",value:function(){var e=ft.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"updateLeaderboardData",value:function(){var e=ft.getLeaderboard();console.log("TournamentLeaderboardScreen: entries",e);var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.score<=0&&e.splice(e.indexOf(i),1)}}catch(e){n.e(e)}finally{n.f()}var a=Math.min(e.length,Mt);if(this.leaderContainerContent.getComponent(L).setContentSize(1080,200*a+108),0===this.leaderNodes.length)for(var r=0;r<a;r++){var o=K(this.leaderPrefab);this.leaderNodes.push(o),this.leaderContainerContent.addChild(o),o.setPosition(0,-108-200*r)}for(var s=0;s<a;s++){var l=this.leaderNodes[s];if(l||(l=K(this.leaderPrefab),this.leaderNodes.push(l),this.leaderContainerContent.addChild(l),l.setPosition(0,-108-200*s)),e[s]){l.active=!0;var u,c,h,p,f,y,v=l.getComponent(U2);if(v)this.setLeaderRankAndReward(v,s+1),v.setName(null!==(u=null===(c=e[s])||void 0===c?void 0:c.name)&&void 0!==u?u:"Player"),v.setScore(null!==(h=null===(p=e[s])||void 0===p?void 0:p.score)&&void 0!==h?h:0),v.setAvatar(null!==(f=null===(y=e[s])||void 0===y?void 0:y.avatarUrl)&&void 0!==f?f:"")}else l.active=!1}this.updatePlayerLeader()}},{key:"updatePlayerLeader",value:(u=s(l().mark((function e(){var t,n,i,a,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ft.getLeaderboard().filter((function(e){return e.playerId===J3.getPlayerId()})),console.log("TournamentLeaderboardScreen: playerEntry",t),t&&0!==t.length){e.next=9;break}return n=J3.getPlayer(),this.setLeaderRankAndReward(this.playerLeaderComponent,ft.getTournamentRank()>0?ft.getTournamentRank():0),this.playerLeaderComponent.setName(n.name||"You"),this.playerLeaderComponent.setScore(ft.getTournamentData().bestScore||0),this.playerLeaderComponent.setAvatar(n.photo||""),e.abrupt("return");case 9:i=ft.getTournamentRank()>0?ft.getTournamentRank():0,a=t[0],this.setLeaderRankAndReward(this.playerLeaderComponent,i),this.playerLeaderComponent.setName(a.name),this.playerLeaderComponent.setScore(a.score||0),this.playerLeaderComponent.setAvatar(a.avatarUrl||J3.getPlayer().photo),(r=this.leaderNodes.find((function(e){var t;return(null===(t=e.getComponent(U2))||void 0===t?void 0:t.getRank())===i})))?(this.playerLeaderInBoardNode||(this.playerLeaderInBoardNode=K(this.playerLeaderPrefab),this.leaderContainerContent.addChild(this.playerLeaderInBoardNode)),this.playerLeaderInBoardNode.setPosition(r.position),this.playerLeaderInBoardNode.active=!0,r.active=!1,o=this.playerLeaderInBoardNode.getComponent(U2),this.setLeaderRankAndReward(o,i),o.setName(a.name),o.setScore(a.score||0),o.setAvatar(a.avatarUrl||J3.getPlayer().photo)):this.playerLeaderInBoardNode&&(this.playerLeaderInBoardNode.active=!1);case 17:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setLeaderRankAndReward",value:function(e,t){t>3||t<=0?e.setRankSprite(this.medals[3]):e.setRankSprite(this.medals[t-1]),Dt.includes(t)?(e.setRewardSprite(this.rewards[t-1]),e.setRank(t,!0)):(e.setRewardSprite(null),e.setRank(t,!1))}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentLeaderboardScreen: screen not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedInfo",value:function(){pt.openScreen(Ge.TOURNAMENT_INFO_SCREEN)}},{key:"handleClickedContinue",value:function(){this.runContinueAnimation(),this.continueButtonComponent.interactable=!1}},{key:"runContinueAnimation",value:function(){var e=this,t=this.continueTab.getComponent(P);t&&B(t).set({opacity:255}).to(.3,{opacity:0},{easing:"smooth"}).call((function(){e.continueTab.active=!1})).start()}}]),p}(k)).prototype,"leaderPrefab",[Y5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u3=e(s3.prototype,"playerLeaderPrefab",[J5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c3=e(s3.prototype,"leaderContainerContent",[Z5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h3=e(s3.prototype,"closeButtonComponent",[X5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p3=e(s3.prototype,"infoButtonComponent",[Q5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d3=e(s3.prototype,"continueButtonComponent",[$5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f3=e(s3.prototype,"continueTab",[e3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y3=e(s3.prototype,"timeTextLabel",[t3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v3=e(s3.prototype,"timeTextLocalize",[n3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g3=e(s3.prototype,"playerLeaderComponent",[i3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m3=e(s3.prototype,"medals",[a3],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b3=e(s3.prototype,"rewards",[r3],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o3=s3))||o3);g._RF.pop(),g._RF.push({},"392e1NLXXtBxLM1Sdy78qXu","LeaderboardBackground",void 0);var Q3,$3,e4,t4,n4,i4,a4,r4,o4,s4,l4,u4,c4=m.ccclass,h4=m.property,p4=Ludex,d4=p4.Utils.Decorator,f4=p4.Events,y4=Be.Layout,v4=codex.event,g4=(u(A3={},y4.Portrait,{width:1080,height:2280}),u(A3,y4.Landscape,{width:2732,height:1583}),A3);R3=c4("LeaderboardBackground"),P3=Re.required(),_3=h4(A),N3=h4(A),O3=h4(Si),B3=d4.debounce(100),R3((M3=e((F3=function(e){t(c,e);var u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=u.call.apply(u,[this].concat(n)),a(e,"sprite",M3,r(e)),a(e,"timerContainer",z3,r(e)),a(e,"goldTile",U3,r(e)),a(e,"baseScreen",G3,r(e)),e.updateBackgroundSprite=s(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Oe.getCurrentLeaderboardBackground();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:e.setBackgroundSprite(n),e.updateSizeBackground();case 7:case"end":return t.stop()}}),t)}))),e.listenGameEvents=function(t){t.screenName===Ue[Ge.TOURNAMENT_LEADERBOARD_SCREEN]&&x.on(_e.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ue[Ge.TOURNAMENT_LEADERBOARD_SCREEN]&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},a(e,"handleViewResized",H3,r(e)),e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),this.uiTransform=this.getComponent(L),Re.validateRequiredProperties(this),v4.on(f4.OPENING_SCREEN,this.listenGameEvents),v4.on(f4.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite()}},{key:"tryUpdateBackgroundSprite",value:function(){var e=Oe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!==e)return this.setBackgroundSprite(e),void this.updateSizeBackground();this.baseScreen.addPreloadPromise(this.updateBackgroundSprite)}},{key:"onEnable",value:function(){this.handleViewResized()}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateSizeBackground",value:function(){if(this.sprite){var e=I.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=g4[Oe.getCurrentLayout()],a=i.width,r=i.height;this.uiTransform.setContentSize(a,r);var o=t/a,s=n/r,l=Math.max(o,s);console.log("scale",l,"scaleX",o,"scaleY",s),Oe.isPortrait()?this.sprite.node.setScale(o,s):Oe.isLandscape()&&s<l&&l>1.45?this.sprite.node.setScale(o,1.45):this.sprite.node.setScale(l,l),this.updateTimerContainerPosition(o,s),this.updateGoldTilePosition(o,s)}}}},{key:"updateTimerContainerPosition",value:function(e,t){this.timerContainer&&(Oe.isPortrait()?this.timerContainer.setPosition(0,380*t):Oe.isLandscape()&&(e>1.45?this.timerContainer.setPosition(0,435):this.timerContainer.setPosition(0,410)))}},{key:"updateGoldTilePosition",value:function(e,t){if(this.goldTile)if(Oe.isPortrait()){this.goldTile.setPosition(0,665*t);var n=Math.min(e,t);this.goldTile.setScale(n,n)}else Oe.isLandscape()&&(e>1.45?(this.goldTile.setPosition(0,675),this.goldTile.setScale(.9,.9)):(this.goldTile.setPosition(0,650),this.goldTile.setScale(.8,.8)))}}]),c}(k)).prototype,"sprite",[P3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z3=e(F3.prototype,"timerContainer",[_3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U3=e(F3.prototype,"goldTile",[N3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G3=e(F3.prototype,"baseScreen",[O3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H3=e(F3.prototype,"handleViewResized",[B3],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite()}}}),D3=F3));g._RF.pop(),g._RF.push({},"e3444hBHSZGG7IA2p+xZ5zi","LeaderboardLayout",void 0);var m4,b4,S4,w4,k4,T4,C4,E4,L4,x4,I4,A4,R4=m.ccclass,P4=m.property,_4=Ludex,N4=_4.Utils.Decorator,O4=_4.Events,B4=Be.Layout,D4=codex.event,F4=(u(Q3={},B4.Portrait,{width:1080,height:2280}),u(Q3,B4.Landscape,{width:2732,height:1583}),Q3),M4="TournamentLeaderboardScreen";$3=R4("LeaderboardLayout"),e4=P4(A),t4=P4(A),n4=P4(A),i4=N4.debounce(100),$3((o4=e((r4=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"leaderboardScroll",o4,r(e)),a(e,"leaderboardScrollView",s4,r(e)),a(e,"leaderboardFooter",l4,r(e)),e.listenGameEvents=function(t){t.screenName===M4&&x.on(_e.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===M4&&x.off(_e.VIEW_RESIZED,e.handleViewResized)},a(e,"handleViewResized",u4,r(e)),e}return o(l,[{key:"__preload",value:function(){D4.on(O4.OPENING_SCREEN,this.listenGameEvents),D4.on(O4.CLOSING_SCREEN,this.unlistenGameEvents)}},{key:"onLoad",value:function(){}},{key:"start",value:function(){this.handleViewResized()}},{key:"updateLeaderboardLayout",value:function(){var e=je.getBannerAdsHeight(),t=I.getVisibleSize(),n=(t.width,t.height),i=F4[Oe.getCurrentLayout()],a=(i.width,n/i.height),r=F4[B4.Portrait].height,o=this.leaderboardFooter.getComponent(z);if(o&&(o.bottom=e,o.updateAlignment()),Oe.isLandscape())this.leaderboardScroll.setPosition(0,330),this.leaderboardScroll.getComponent(L).setContentSize(r,1175-e),this.leaderboardScrollView.getComponent(L).setContentSize(r,1175-e);else if(Oe.isPortrait()){this.leaderboardScroll.setPosition(0,275*a);var s=275*a-this.leaderboardFooter.position.y-115-10;this.leaderboardScroll.getComponent(L).setContentSize(r,s),this.leaderboardScrollView.getComponent(L).setContentSize(r,s)}}}]),l}(k)).prototype,"leaderboardScroll",[e4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s4=e(r4.prototype,"leaderboardScrollView",[t4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l4=e(r4.prototype,"leaderboardFooter",[n4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u4=e(r4.prototype,"handleViewResized",[i4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateLeaderboardLayout()}}}),a4=r4));g._RF.pop(),g._RF.push({},"2a961XkBT9PBZLoMZaBr2aF","TournamentPopupScreen",void 0);var z4,U4,G4,H4,W4,V4,j4,q4,K4,Y4,J4,Z4=m.ccclass,X4=m.property,Q4=m.requireComponent,$4=Ludex,e6=$4.Events,t6=($4.Utils,codex),n6=(t6.player,t6.event);t6.analytics,m4=Z4("TournamentPopupScreen"),b4=Q4(Si),S4=X4(N),w4=X4(N),k4=X4(X),T4=X4(gh),m4(C4=b4((L4=e((E4=function(e){t(h,e);var u,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=c.call.apply(c,[this].concat(n)),a(e,"closeButtonComponent",L4,r(e)),a(e,"startButtonComponent",x4,r(e)),a(e,"timeTextLabel",I4,r(e)),a(e,"timeTextLocalize",A4,r(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.startButtonComponent.interactable=!0,e.updateStatus())},e}return o(h,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents(),this.schedule(this.updateTimeText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){n6.on(e6.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){n6.off(e6.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.runPopUpAnimation()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.closeButtonComponent.interactable=!1,this.startButtonComponent.interactable=!1,pt.closeScreen(Ge.TOURNAMENT_POPUP_SCREEN,{openNextScreenImmediately:e})}},{key:"updateStatus",value:function(){this.updateTimeText()}},{key:"updateTimeText",value:function(){var e=ft.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentPopupScreen: screen not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedStart",value:(u=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ft.inst.isPlayerJoined,e.next=3,rt.openPopupJoinGlobalTournament();case 3:if(ft.inst.isPlayerJoined){e.next=8;break}return this.close(),pt.showNotificationScreen("failedToJoinTournament"),ft.logTournamentRefuse(t),e.abrupt("return");case 8:t?ft.logTournamentRejoin():ft.logTournamentStart(),this.close(!0),pt.openScreen(Ge.TOURNAMENT_LEADERBOARD_SCREEN);case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(k)).prototype,"closeButtonComponent",[S4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x4=e(E4.prototype,"startButtonComponent",[w4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I4=e(E4.prototype,"timeTextLabel",[k4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A4=e(E4.prototype,"timeTextLocalize",[T4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C4=E4))||C4);g._RF.pop(),g._RF.push({},"4a93c9jKehDa4T9aXGRhgxr","NextLevelButton",void 0);var i6,a6,r6,o6,s6,l6,u6,c6,h6,p6,d6,f6=m.ccclass,y6=m.property,v6=(z4=f6("NextLevelButton"),U4=y6([X]),G4=y6([gh]),H4=y6(A),W4=y6(A),z4((q4=e((j4=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"levelText",q4,r(e)),a(e,"levelTextLocalize",K4,r(e)),a(e,"textWithIcon",Y4,r(e)),a(e,"textWithoutIcon",J4,r(e)),e}return o(l,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(0===this.levelText.length)throw new Error("NextLevelButton requires at least one Label component in levelText array.");if(0===this.levelTextLocalize.length)throw new Error("NextLevelButton requires at least one Localize component in levelTextLocalize array.")}},{key:"updateLevelText",value:function(e,t){var n,i=d(this.levelText);try{for(i.s();!(n=i.n()).done;){n.value.string="".concat(t," ").concat(e)}}catch(e){i.e(e)}finally{i.f()}var a,r=d(this.levelTextLocalize);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.key="levelV",o.setParams([e.toString()])}}catch(e){r.e(e)}finally{r.f()}ft.isTournamentHappening()?(this.textWithIcon.active=!0,this.textWithoutIcon.active=!1):(this.textWithIcon.active=!1,this.textWithoutIcon.active=!0)}},{key:"updateText",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=d(this.levelTextLocalize);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.key=e}}catch(e){i.e(e)}finally{i.f()}n?(this.textWithIcon.active=!0,this.textWithoutIcon.active=!1):(this.textWithIcon.active=!1,this.textWithoutIcon.active=!0)}}]),l}(k)).prototype,"levelText",[U4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K4=e(j4.prototype,"levelTextLocalize",[G4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Y4=e(j4.prototype,"textWithIcon",[H4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J4=e(j4.prototype,"textWithoutIcon",[W4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V4=j4))||V4);g._RF.pop(),g._RF.push({},"90835KRvK9KiqPOIXd+TUcq","RewardProgressBar",void 0);var g6,m6,b6,S6,w6,k6,T6,C6,E6,L6,x6,I6,A6,R6,P6,_6,N6,O6,B6,D6,F6,M6,z6,U6,G6,H6,W6,V6,j6,q6,K6=m.ccclass,Y6=m.property,J6=-254.5,Z6=Ludex.Utils.Time,X6=(i6=K6("RewardProgressBar"),a6=Y6(E),r6=Y6(A),o6=Y6(P),s6=Y6(E),i6((c6=e((u6=function(e){t(p,e);var u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=h.call.apply(h,[this].concat(n)),a(e,"progressBar",c6,r(e)),a(e,"progressFillTail",h6,r(e)),a(e,"glowOpacity",p6,r(e)),a(e,"icon",d6,r(e)),e.iconInitialPosition=new F(0,0,0),e}return o(p,[{key:"onLoad",value:function(){this.iconInitialPosition=this.icon.node.position.clone(),this.hideReachTargetAnimation(),this.progressFillTail.setPosition(new F(J6,0,0))}},{key:"runFillAnimation",value:(c=s(l().mark((function e(t,n){var i,a,r,o=this,s=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:0,a=function(e){o.progressFillTail.setPosition(new F(450*e.fillRange+J6,0,0))},this.progressFillTail.setPosition(new F(450*t+J6,0,0)),r=B(this.progressBar).set({fillRange:t}).delay(i).to(.5,{fillRange:n},{easing:"cubicInOut",onUpdate:function(e){a(e)}}).call((function(){o.progressBar.fillRange=n,o.progressFillTail.setPosition(new F(450*n+J6,0,0))})),e.next=6,Ve.runTweenAsync(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"runReachTargetAnimation",value:(u=s(l().mark((function e(){var t,n,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=B(this.glowOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),n=B(this.glowOpacity.node).set({scale:new F(0,0,1)}).to(.3,{scale:new F(1,1,1)},{easing:"backOut"}),i=B(this.icon.node).to(.2,{scale:new F(1.2,.8,1)},{easing:"cubicIn"}).to(.3,{scale:new F(.8,1.2,1)},{easing:"cubicOut"}).to(.2,{scale:new F(1,1,1)},{easing:"cubicInOut"}).delay(.1).to(.1,{scale:new F(1.1,.9,1)},{easing:"cubicIn"}).to(.1,{scale:new F(1,1,1)},{easing:"cubicInOut"}),a=B(this.icon.node).to(.2,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y-10,0)},{easing:"cubicInOut"}).to(.4,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+45,0)},{easing:"sineOut"}).to(.3,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"sineIn"}).to(.1,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+10,0)},{easing:"cubicInOut"}).to(.1,{position:new F(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"cubicInOut"}),B(this.glowOpacity.node).set({angle:0}).by(2,{angle:360},{easing:"linear"}).start(),(r=[]).push(Ve.runTweenAsync(t)),r.push(Ve.runTweenAsync(i)),r.push(Ve.runTweenAsync(n)),r.push(Ve.runTweenAsync(a)),e.next=12,Promise.all(r);case 12:return e.next=14,Z6.sleepAsync(200);case 14:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"hideReachTargetAnimation",value:function(){this.glowOpacity.opacity=0,this.glowOpacity.node.setScale(new F(0,0,1)),this.glowOpacity.node.setRotationFromEuler(0,0,0),this.icon.node.setScale(new F(1,1,1)),this.icon.node.setPosition(this.iconInitialPosition)}}]),p}(k)).prototype,"progressBar",[a6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h6=e(u6.prototype,"progressFillTail",[r6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p6=e(u6.prototype,"glowOpacity",[o6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d6=e(u6.prototype,"icon",[s6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l6=u6))||l6);g._RF.pop(),g._RF.push({},"35c09YGmdFA4pHOJFDg1tw5","WinningScreen",void 0);var Q6,$6,e8,t8,n8=m.ccclass,i8=m.property,a8=m.disallowMultiple,r8=m.requireComponent,o8=(m.executeInEditMode,Ludex),s8=o8.Events,l8=o8.Plugins.Analytics.Events.SHARE,u8=o8.Configs.FrameCapture.Enabled,c8=codex,h8=c8.player,p8=c8.event,d8=c8.language,f8=c8.analytics,y8=c8.frameCapture;g6=n8("WinningScreen"),m6=r8(Si),b6=i8(E),S6=i8(gh),w6=i8(v6),k6=i8(N),T6=i8(N),C6=i8(N),E6=i8(X),L6=i8(X6),x6=i8(gh),I6=i8(gh),A6=i8(ee),R6=i8(ee),P6=i8(ee),g6(_6=a8(_6=m6((O6=e((N6=function(e){t(f,e);var u,c,h,p,d=n(f);function f(){var e;i(this,f);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=d.call.apply(d,[this].concat(n)),a(e,"titleRibbon",O6,r(e)),a(e,"titleLabel",B6,r(e)),a(e,"nextLevelButton",D6,r(e)),a(e,"shareButtonComponent",F6,r(e)),a(e,"nextLevelButtonComponent",M6,r(e)),a(e,"returnButtonComponent",z6,r(e)),a(e,"scoreText",U6,r(e)),a(e,"rewardProgressBar",G6,r(e)),a(e,"progressTextLocalize",H6,r(e)),a(e,"commentTextLocalize",W6,r(e)),a(e,"firelightParticleSystem",V6,r(e)),a(e,"blossomParticleSystem",j6,r(e)),a(e,"blossomParticleSystem2",q6,r(e)),e.handleOpeningScreen=function(t){var n,i;if(!e.screen)throw new Error("WinningScreen: screen not found");e.validateEventPayload(t)&&(e.firelightParticleSystem.node.active=!0,e.screen.data.level=(null==t||null===(n=t.screenData)||void 0===n?void 0:n.level)||1,e.screen.data.score=(null==t||null===(i=t.screenData)||void 0===i?void 0:i.score)||0,e.open())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.firelightParticleSystem.resetSystem(),e.blossomParticleSystem.resetSystem(),e.blossomParticleSystem2.resetSystem())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.firelightParticleSystem.stopSystem(),e.blossomParticleSystem.stopSystem(),e.blossomParticleSystem2.stopSystem())},e}return o(f,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Si),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Re.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){p8.on(s8.OPENING_SCREEN,this.handleOpeningScreen),p8.on(s8.OPENED_SCREEN,this.handleOpenedScreen),p8.on(s8.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){p8.off(s8.OPENING_SCREEN,this.handleOpeningScreen),p8.off(s8.OPENED_SCREEN,this.handleOpenedScreen),p8.off(s8.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){Me.playSound(ze.HAND_CLAP),rt.getSpecialMode()!==ot.DAILY_CHALLENGE?this.processSingleFlow():this.processDailyChallengeFlow()}},{key:"processSingleFlow",value:function(){var e;this.titleLabel.key="wellDone",this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!0,this.rewardProgressBar.node.active=!0,this.returnButtonComponent.node.active=!1,this.updateLevel(),this.commentTextLocalize.key="NailedLikeAChamp";var t=(null===(e=codex.player.getGameData())||void 0===e?void 0:e.level)||1,n=this.screen.data.level===t?t+1:t,i=10*Math.ceil(t/10),a=n%10==0?1:n%10/10,r=(n-1)%10==0?0:(n-1)%10/10;this.progressTextLocalize.key="reachLevelV",this.progressTextLocalize.setParams([i.toString()]),i===n&&nt.getLevel()===nt.getMaxLevel()?this.processSingleRewardFlow(r,a):this.processSingleNormalFlow(r,a)}},{key:"processDailyChallengeFlow",value:function(){this.titleLabel.key="exceptional",this.nextLevelButtonComponent.interactable=!0,this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!1,this.rewardProgressBar.node.active=!1,this.returnButtonComponent.node.active=!1;var e=rt.getSpecialModeInfo(),t=e.day,n=e.month,i=e.year,a="".concat(i," / ").concat(n<10?"0".concat(n):n," / ").concat(t<10?"0".concat(t):t);this.commentTextLocalize.key="customString",this.commentTextLocalize.setParams([a]),this.nextLevelButton.updateText("continue");var r=this.screen.data.score||0;this.scoreText.string="".concat(r)}},{key:"processSingleNormalFlow",value:(p=s(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.interactable=!0,this.shareButtonComponent.interactable=!0,e.next=4,this.rewardProgressBar.runFillAnimation(t,n,.5);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"processSingleRewardFlow",value:(h=s(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.node.active=!1,this.shareButtonComponent.node.active=!1,e.next=4,this.rewardProgressBar.runFillAnimation(t,n,.5);case 4:return e.next=6,this.rewardProgressBar.runReachTargetAnimation();case 6:return this.close(),e.next=9,this.openRewardScreen();case 9:return this.rewardProgressBar.hideReachTargetAnimation(),this.nextLevelButtonComponent.node.active=!0,this.shareButtonComponent.node.active=!0,e.next=14,Kg.handleSocialOnNextLevelButton();case 14:this.goToNextLevel();case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"close",value:function(){this.nextLevelButtonComponent.interactable=!1,this.shareButtonComponent.interactable=!1,this.firelightParticleSystem.node.active=!1,pt.closeScreen(Ge.WINNING_SCREEN)}},{key:"handleClickedNextLevel",value:(c=s(l().mark((function e(){var t,n,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.interactable=!1,e.next=3,je.showInterstitialAdAsync();case 3:if(rt.getSpecialMode()!==ot.DAILY_CHALLENGE){e.next=10;break}t=rt.getSpecialModeInfo(),n=mt.calculateNextDay(t),i=n.day,a=n.month,r=n.year,Tt.switchToDashboardScene({screen:Ge.DAILY_CHALLENGE_SCREEN,screenData:{customData:{day:i,month:a,year:r,dayCompleted:t.day}}}),e.next=14;break;case 10:return rt.switchToSoloContext(),e.next=13,Kg.handleSocialOnNextLevelButton();case 13:this.goToNextLevel();case 14:this.close();case 15:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedReturn",value:function(){this.close()}},{key:"handleClickedRetry",value:function(){this.close(),this.node.scene.emit($e.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close();var e=this.screen.data.level;this.node.scene.emit($e.NEXT_LEVEL,{level:e})}},{key:"handleClickedShare",value:(u=s(l().mark((function e(){var t,n,i,a,r,o,s,u,c,h,p,d,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.extra||!("shareAsync"in GameSDK.extra)){e.next=22;break}if(pt.showLoadingScreen(),e.prev=2,n=h8.getPlayer(),i=n.playerId,a=n.name,r=n.photo,n.data,o=nt.getPlayerLevel().toString(),s=void 0,rt.getSpecialMode()===ot.DAILY_CHALLENGE&&(u=rt.getSpecialModeInfo(),c=u.day,h=u.month,p=u.year,d="".concat(p,"/").concat(h<10?"0".concat(h):h,"/").concat(c<10?"0".concat(c):c),o=d,s={day:c,month:h,year:p}),f="",!u8){e.next=12;break}return e.next=11,y8.wideframe.renderShareScore({playerId:i,playerPhoto:r,playerScore:o});case 11:f=e.sent;case 12:return e.next=14,GameSDK.extra.shareAsync({text:"Woohoo! I've never gone this far before!",intent:"SHARE",image:null!==(t=f)&&void 0!==t?t:"",data:{playerId:i,playerName:a,playerPhoto:r,type:"share_invite",level:nt.getPlayerLevel(),dailyChallengeData:s}});case 14:f8.event(l8,{share_content_type:"CurrentLevel",success:!0}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),f8.event(l8,{share_content_type:"CurrentLevel",success:!1}),console.warn(e.t0);case 21:pt.closeLoadingScreen();case 22:case"end":return e.stop()}}),e,null,[[2,17]])}))),function(){return u.apply(this,arguments)})},{key:"goToNextLevel",value:function(){this.screen.data.level?this.node.scene.emit($e.NEXT_LEVEL):console.warn("WinningScreen: level not found")}},{key:"openRewardScreen",value:function(e){var t=this;return new Promise((function(n){var i=[];Math.random()<.5?i.push({item:lt.HINT,count:1}):i.push({item:lt.SHUFFLE,count:1});var a={items:i,watchAdsDoubleReward:!0,chestId:dN,successCallback:function(){t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.HINT,ut.getItemCount(ct[lt.HINT])),t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.UNDO,ut.getItemCount(ct[lt.UNDO])),t.node.scene.emit($e.ITEM_COUNT_CHANGE,lt.SHUFFLE,ut.getItemCount(ct[lt.SHUFFLE])),null==e||e(),n()},earnFrom:"WinningScreen"};pt.openScreen(Ge.REWARD_SCREEN,a)}))}},{key:"updateLevel",value:function(){var e=nt.getLevel(),t=d8.getText("level");this.nextLevelButton.updateLevelText(e,t);var n=this.screen.data.score||0;this.scoreText.string="".concat(n)}}]),f}(k)).prototype,"titleRibbon",[b6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B6=e(N6.prototype,"titleLabel",[S6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D6=e(N6.prototype,"nextLevelButton",[w6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F6=e(N6.prototype,"shareButtonComponent",[k6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M6=e(N6.prototype,"nextLevelButtonComponent",[T6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z6=e(N6.prototype,"returnButtonComponent",[C6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U6=e(N6.prototype,"scoreText",[E6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G6=e(N6.prototype,"rewardProgressBar",[L6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H6=e(N6.prototype,"progressTextLocalize",[x6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W6=e(N6.prototype,"commentTextLocalize",[I6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V6=e(N6.prototype,"firelightParticleSystem",[A6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j6=e(N6.prototype,"blossomParticleSystem",[R6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q6=e(N6.prototype,"blossomParticleSystem2",[P6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_6=N6))||_6)||_6);g._RF.pop(),g._RF.push({},"c79513DyFFAIosjE1ekd39Y","FireLightParticleSystem2DExtra",void 0);var v8=m.ccclass,g8=m.property;v8("FirelightParticleSystem2DExtra")((e8=e(($6=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=s.call.apply(s,[this].concat(n)),a(e,"rectW",e8,r(e)),a(e,"rectH",t8,r(e)),e}return o(l,[{key:"initParticle",value:function(e){e.maxSize=Y.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=Y.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Y.randomRange(-this.rectW/2,this.rectW/2),e.y=n+Y.randomRange(0,this.rectH/2)-this.rectH/2,e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),l}(pE)).prototype,"rectW",[g8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),t8=e($6.prototype,"rectH",[g8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Q6=$6));g._RF.pop(),g._RF.push({},"ca600QzdYZDSLmGmfSVyz4h","AnimAbortSignal",void 0);Ludex.Utils.Array;g._RF.pop(),g._RF.push({},"58f4330KXRL77xyoA3903MY","WasmUtils",void 0),g._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});