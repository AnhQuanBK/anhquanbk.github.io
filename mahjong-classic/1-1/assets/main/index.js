System.register("chunks:///main.js",["./rollupPluginModLoBabelHelpers-7ef300de.js","cc","./GeneralUtils-906950c0.js"],(function(){var e,t,n,i,a,r,o,s,l,u,c,h,d,p,f,y,v,g,m,b,S,w,k,T,C,E,L,I,x,R,A,_,P,B,N,O,D,F,z,M,U,G,H,V,W,q,j,K,Y,J,Z,Q,X,$,ee,te,ne,ie,ae,re,oe,se,le,ue,ce,he,de,pe,fe,ye,ve,ge,me,be,Se,we,ke,Te,Ce,Ee,Le,Ie,xe,Re,Ae,_e,Pe,Be,Ne,Oe,De,Fe,ze,Me,Ue,Ge,He,Ve,We,qe,je,Ke,Ye,Je,Ze,Qe,Xe,$e,et,tt,nt,it,at,rt,ot,st,lt,ut,ct,ht,dt,pt,ft,yt,vt,gt,mt,bt,St,wt,kt,Tt,Ct,Et,Lt,It,xt,Rt;return{setters:[function(b){e=b.o,t=b.g,n=b.h,i=b.a,a=b.b,r=b.c,o=b.f,s=b.n,l=b.i,u=b._,c=b.d,h=b.e,d=b.l,p=b.p,f=b.q,y=b.r,v=b.j,g=b.k,m=b.m},function(e){b=e.cclegacy,S=e.isCCObject,w=e._decorator,k=e.Animation,T=e.CCString,C=e.CCInteger,E=e.Component,L=e.AudioSource,I=e.director,x=e.Sprite,R=e.UITransform,A=e.game,_=e.view,P=e.Node,B=e.CCBoolean,N=e.UIOpacity,O=e.EventHandler,D=e.Button,F=e.Input,z=e.tween,M=e.Color,U=e.Vec3,G=e.EventTouch,H=e.Widget,V=e.View,W=e.Graphics,q=e.Label,j=e.Director,K=e.sys,Y=e.ProgressBar,J=e.Enum,Z=e.CCFloat,Q=e.Vec2,X=e.Prefab,$=e.instantiate,ee=e.math,te=e.ScrollView,ne=e.ccenum,ie=e.Layers,ae=e.ParticleSystem2D,re=e.v3,oe=e.find,se=e.Tween,le=e.SpriteFrame,ue=e.easing,ce=e.Layout,he=e.MotionStreak,de=e.repeat,pe=e.lerp,fe=e.approx,ye=e.EPSILON,ve=e.RealCurve,ge=e.Gradient,me=e.bits,be=e.random,Se=e.randomRange,we=e.randomRangeInt,ke=e.js,Te=e.misc,Ce=e.MeshRenderData,Ee=e.pseudoRandom,Le=e.toRadian,Ie=e.CCClass,xe=e.UIRenderer,Re=e.Material,Ae=e.BlockInputEvents,_e=e.sp,Pe=e.Mask,Be=e.Canvas},function(e){Ne=e.R,Oe=e.G,De=e.T,Fe=e.m,ze=e.a,Me=e.n,Ue=e.o,Ge=e.p,He=e.q,Ve=e.k,We=e.j,qe=e.C,je=e.g,Ke=e.r,Ye=e.A,Je=e.d,Ze=e.E,Qe=e.s,Xe=e.t,$e=e.u,et=e.I,tt=e.v,nt=e.w,it=e.x,at=e.y,rt=e.M,ot=e.z,st=e.B,lt=e.D,ut=e.F,ct=e.H,ht=e.J,dt=e.K,pt=e.l,ft=e.N,yt=e.O,vt=e.Q,gt=e.S,mt=e.U,bt=e.i,St=e.h,wt=e.V,kt=e.W,Tt=e.X,Ct=e.Y,Et=e.Z,Lt=e._,It=e.$,xt=e.a0,Rt=e.a1}],execute:function(){function At(t,n,i){var a;if("object"!==e(t)||void 0===n||void 0===i)return a=t,function(e,t,n){var i=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(a.call(this))return null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}};!function(e,t,n){var i=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}(0,n,i)}function _t(i,a,r){var o;if("object"!==e(i)||void 0===a||void 0===r)return o=i,function(e,i,a){var r=a.value,s=function(){var e=t(n().mark((function e(){var t,a,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length,a=new Array(t),s=0;s<t;s++)a[s]=l[s];if(!o.call(this)){e.next=5;break}return e.next=4,null==r?void 0:r.apply(this,a);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(i)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();a.value=s};!function(e,i,a){var r=a.value,o=function(){var e=t(n().mark((function e(){var t,a,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length,a=new Array(t),o=0;o<t;o++)a[o]=s[o];if(!this.isValid){e.next=5;break}return e.next=4,null==r?void 0:r.apply(this,a);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(i)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();a.value=o}(0,a,r)}b._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),b._RF.pop(),b._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),b._RF.pop(),b._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),b._RF.pop(),b._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var Pt=function(e){i(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this,"".concat(e," is missing these required properties: [").concat(i.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,a.errors=i,a}return o(n)}(s(Error));b._RF.pop(),b._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var Bt=function(e){i(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this,"".concat(e," is missing the required property: <").concat(i,">"))).className=e,a.propertyName=i,a}return o(n)}(s(Error));b._RF.pop(),b._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var Nt=Ludex.Utils,Ot=Nt.String,Dt=Nt.Valid,Ft=codex.monitorError,zt="_compUtils_ReqPropsMap";function Mt(e){return null===e}function Ut(e){return void 0===e}function Gt(e){return Mt(e)||Ut(e)}function Ht(e){if("function"==typeof e)return e;switch(e){case"null-check":return Mt;case"undefined-check":return Ut;default:return Gt}}function Vt(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var i,a=t.constructor.name,r=(i=n,"".concat("_compUtils_ReqPropsMethod","_").concat(Ot.capitalize(i)));if(void 0!==t[r])throw new Error("The required decorator found that property name ".concat(r," already exists. The reserved method name ").concat(r," is used already or the decorator was applied multiple times."));t[r]=function(t){if(e(this[n]))throw new Bt(t,n)},void 0===t[zt]&&(t[zt]={}),void 0===t[zt][a]&&(t[zt][a]=[]),t[zt][a].push(r)}}function Wt(e,t){if("string"!=typeof t)return Vt(Ht(e));var n=e;Vt(Ht())(n,t)}b._RF.pop(),b._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),b._RF.pop(),b._RF.push({},"bfa55FbayJE75F0wBdnknTr","ComponentUtils",void 0);var qt,jt,Kt,Yt,Jt,Zt,Qt,Xt,$t,en=Ludex.Utils,tn=en.Array,nn=en.Object,an=en.Valid,rn=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],on=function(){function t(){r(this,t),this.validComponentCalled={}}return o(t,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredComponentNames(i),r=l(a);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(!e.getComponent(o))throw new Error("".concat(n,": Missing required ").concat(o," component"))}}catch(e){r.e(e)}finally{r.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredPropNames(i),r=l(a);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(!nn.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var s=this.getProperty(o,e);if(!S(s))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){r.e(e)}finally{r.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,i=this.getCustomPropNames(e),a=l(i);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(!nn.hasOwn(e,r))throw new Error("".concat(n,": Missing required ").concat(r," property"));var o=this.getProperty(r,e);if(!S(o))throw new Error("".concat(n,": ").concat(r," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"getProperty",value:function(e,t){var n;if(nn.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!nn.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!nn.hasOwn(e,t)&&(!!S(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=rn;t<n.length;t++){var i=n[t];if(i.indexOf(e)>=0)return i}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!nn.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),i=this.getProps(e.constructor);return tn.difference(n,i).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!nn.hasOwn(e,n))return!1;var i=t.getProperty(n,e);return!(!an.isObject(i)||!S(i))}))}}],[{key:"inst",get:function(){return this._instance||(this._instance=new t),this._instance}},{key:"required",value:function(e,t){return"string"==typeof t?Wt(e,t):Wt(e)}},{key:"onlyRunInLifeCycle",value:function(t,n,i){return"object"===e(t)&&void 0!==n&&void 0!==i?At(t,n,i):At(t)}},{key:"onlyRunInLifeCycleAsync",value:function(t,n,i){return"object"===e(t)&&void 0!==n&&void 0!==i?_t(t,n,i):_t(t)}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,i,a=t?t.name:e.constructor.name,r=t?t.prototype[zt]:e.constructor.prototype[zt],o=null!==(n=null==r?void 0:r[a])&&void 0!==n?n:[],s=[],u=e,c=l(o);try{for(c.s();!(i=c.n()).done;){var h=i.value;if("function"==typeof u[h])try{u[h](a)}catch(d){if(!(d instanceof Bt))throw d;s.push(d)}}}catch(e){c.e(e)}finally{c.f()}if(0!==s.length){var d=new Pt(a,s);if(Dt.isDebugger())throw d;console.error(d),null==Ft||Ft.sendException(d)}}(e,t)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,i=n.name;if(!this.inst.validComponentCalled[i])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled[i]=!0}}}}]),t}();b._RF.pop(),b._RF.push({},"60ac3vor0dMT5bXi8D3VSJN","BubbleAnimation",void 0);var sn=w.ccclass,ln=w.property;qt=sn("BubbleAnimation"),jt=ln(k),Kt=ln(T),Yt=ln(C),qt((Qt=u((Zt=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"animation",Qt,h(e)),c(e,"clipName",Xt,h(e)),c(e,"repeat",$t,h(e)),e.currentRepeat=-1,e}return o(n,[{key:"__preload",value:function(){this.animation=this.getComponent(k),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"play",value:function(){var e=this;this.animation&&(this.animation.clips.find((function(t){return(null==t?void 0:t.name)===e.clipName}))?(this.currentRepeat=-1,this.animation.play(this.clipName)):console.warn("BubbleAnimation: Animation component must have ".concat(this.clipName," clip")))}},{key:"onBubbleAnimationLoop",value:function(){this.animation&&-1!==this.repeat&&(this.currentRepeat++,this.currentRepeat>this.repeat&&this.animation.stop())}}]),n}(E)).prototype,"animation",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=u(Zt.prototype,"clipName",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Bubble"}}),$t=u(Zt.prototype,"repeat",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),Jt=Zt));b._RF.pop(),b._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var un,cn,hn=function(e){i(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this,e)).audioSource=i,a}return o(n,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,a=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=a}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===L.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),n}(Ludex.Plugins.Audio.BaseAudioPlayer);b._RF.pop(),b._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var dn,pn,fn,yn,vn,gn=Ludex,mn=gn.Plugins.Audio.BaseChannelManager,bn=gn.Utils,Sn=bn.Array,wn=(un=bn.Decorator.tryCatch(),u((cn=function(e){i(u,e);var s,l=a(u);function u(e,t){var n;return r(this,u),(n=l.call(this,t)).allowMultipleTracking={},n.handleLoadedAudio=function(e,t){var i=n.node.addComponent(L);return i.clip=t,i.playOnAwake=!1,new hn(e,i)},n.node=e,n}return o(u,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof hn)&&n.getAudioSource().state===L.AudioState.PLAYING}},{key:"onLoadAudio",value:(s=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne.loadAudioAsync(t);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(this.node.isValid){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",this.handleLoadedAudio(t,a));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,a=t.allowMultiple,r=void 0!==a&&a;if(t.volume=this.getVolume()*i,r){var o=e.getAudioSource().clip;if(!o)return;return void this.requestDuplicateAudioPlayer(e.getKey(),o,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof hn)return i.getAudioSource().state===L.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var a=i.key,r=n.volume,o=void 0===r?1:r;this.setAudioClip(a,{volume:o})}return i.audioPlayer}var s=this.allowMultipleTracking[e];if(!s)throw new Error("Allow multiple tracking is not found");var l="".concat(e,"_").concat(s.currentPostFix),u=this.handleLoadedAudio(l,t);return s.list.push({audioPlayer:u,key:l}),s.currentPostFix+=1,this.setAudioClip(l,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=Sn.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==L.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),u}(mn)).prototype,"onLoadAudio",[un],Object.getOwnPropertyDescriptor(cn.prototype,"onLoadAudio"),cn.prototype),cn);b._RF.pop(),b._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var kn,Tn,Cn,En,Ln,In=w.ccclass,xn=w.property,Rn=codex,An=Rn.audio,_n=Rn.player,Pn=(dn=In("Music"),pn=xn(T),dn((vn=u((yn=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"channelId",vn,h(e)),e.channel=null,e}return o(n,[{key:"__preload",value:function(){this.makePersistent(),this.channel=new wn(this.node,this.channelId),An.addChannel(this.channel)}},{key:"makePersistent",value:function(){I.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),An.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!_n.getPlayerSetting("music")}},{key:"setVolume",value:function(e){An.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return An.getVolume(this.channelId)}},{key:"pause",value:function(e){An.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&An.resume(e,this.channelId)}},{key:"stop",value:function(e){An.stop(e,this.channelId)}},{key:"mute",value:function(e){e?An.mute(this.channelId):An.unmute(this.channelId)}}]),n}(E)).prototype,"channelId",[pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),fn=yn))||fn);b._RF.pop(),b._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var Bn,Nn,On,Dn,Fn,zn,Mn,Un,Gn=w.ccclass,Hn=w.property,Vn=codex,Wn=Vn.audio,qn=Vn.player,jn=(kn=Gn("Sound"),Tn=Hn(T),kn((Ln=u((En=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"channelId",Ln,h(e)),e.channel=null,e}return o(n,[{key:"__preload",value:function(){this.channel=new wn(this.node,this.channelId),Wn.addChannel(this.channel)}},{key:"onLoad",value:function(){""===this.channelId&&(this.channelId=this.node.uuid)}},{key:"makePersistent",value:function(){I.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){I.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){this.isSoundEnable()&&Wn.play(e,t,this.channelId)}},{key:"isSoundEnable",value:function(){return!!qn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){Wn.setVolume(e,this.channelId)}},{key:"pause",value:function(e){Wn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&Wn.resume(e,this.channelId)}},{key:"stop",value:function(e){Wn.stop(e,this.channelId)}},{key:"stopAll",value:function(){Wn.stopAll(this.channelId)}},{key:"mute",value:function(e){e?Wn.mute(this.channelId):Wn.unmute(this.channelId)}}]),n}(E)).prototype,"channelId",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Cn=En))||Cn);b._RF.pop(),b._RF.push({},"ca427NpeqpC3bUoGTd9I/BM","Background",void 0);var Kn,Yn,Jn,Zn,Qn,Xn,$n,ei,ti,ni,ii,ai,ri,oi,si,li=w.ccclass,ui=Ludex.Utils.Decorator,ci=ze.Layout,hi=(d(Bn={},ci.Portrait,{"3x":{width:1080,height:2520},"2x":{width:1080,height:2279.52},"1x":{width:1080,height:2278.08}}),d(Bn,ci.Landscape,{"3x":{width:2732,height:1583},"2x":{width:1920*1.44,height:1555.2},"1x":{width:960*2.88,height:1555.2}}),Bn),di=(Nn=li("Background"),On=on.required(),Dn=ui.debounce(100),Nn((Mn=u((zn=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"sprite",Mn,h(e)),c(e,"handleViewResized",Un,h(e)),e}return o(n,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),on.validateRequiredProperties(this),this.listenGameEvents()}},{key:"start",value:function(){this.handleViewResized()}},{key:"onLoad",value:function(){this.updateBackgroundSprite()}},{key:"listenGameEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"onDestroy",value:function(){A.off(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"updateBackgroundSprite",value:function(){var e=this;De.loadCurrentBackgroundSprite().then((function(t){t&&e.setBackgroundSprite(t)}))}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e,this.updateBackgroundSize())}},{key:"updateBackgroundSize",value:function(){if(this.sprite){var e=_.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=Ne.getImageScale(),a=1===i?"1x":2===i?"2x":"3x",r=hi[Fe.getCurrentLayout()][a],o=r.width,s=r.height;this.uiTransform.setContentSize(o,s);var l=t/o,u=n/s,c=Math.max(l,u);this.sprite.node.setScale(c,c)}}}}]),n}(E)).prototype,"sprite",[On],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=u(zn.prototype,"handleViewResized",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite()}}}),Fn=zn))||Fn);b._RF.pop(),b._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var pi,fi,yi,vi,gi,mi,bi,Si,wi,ki,Ti,Ci,Ei,Li,Ii=w.ccclass,xi=w.property,Ri=w.disallowMultiple,Ai=Ludex.Events,_i=codex.event,Pi=(Kn=Ii("BaseScreen"),Yn=xi(P),Jn=xi(P),Zn=xi(B),Qn=xi({visible:function(){return this.useSound},type:Me}),Xn=xi({visible:function(){return this.useSound},type:Me}),Kn($n=Ri((ti=u((ei=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"container",ti,h(e)),c(e,"backgroundMask",ni,h(e)),c(e,"openClipName",ii,h(e)),c(e,"closeClipName",ai,h(e)),e.data={},e.openPreloadPromises=[],c(e,"useSound",ri,h(e)),c(e,"openSound",oi,h(e)),c(e,"closeSound",si,h(e)),e}return o(u,[{key:"__preload",value:function(){this.animation=this.getComponent(k),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"addPreloadPromise",value:function(e){this.openPreloadPromises.push(e)}},{key:"hasPreloadOpenPromises",value:function(){return this.openPreloadPromises.length>0}},{key:"preloadOpen",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.openPreloadPromises.map((function(e){return e()})),e.next=3,Promise.all(t);case 3:this.openPreloadPromises=[];case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"open",value:function(e){var t=this;e&&(this.data=e),this.animation.once(k.EventType.PLAY,(function(){t.show()}));var n=this.data.openAnimationName||this.openClipName;_i.emit(Ai.OPENED_SCREEN,{screenName:this.node.name,screenData:this.data}),this.playAudio(this.openSound),this.runAnimation(n)}},{key:"close",value:function(){var e=this;this.node.active&&(this.animation.once(k.EventType.FINISHED,(function(){_i.emit(Ai.CLOSED_SCREEN,{screenName:e.node.name}),e.hide()})),this.playAudio(this.closeSound),this.runAnimation(this.closeClipName))}},{key:"playAudio",value:function(e){if(this.useSound&&e){var t=Ue[e];if(!t)return;Ge.playSound(t)}}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(N);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(N);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){this.node.active=!0}},{key:"hide",value:function(){this.node.active=!1}}]),u}(E)).prototype,"container",[Yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=u(ei.prototype,"backgroundMask",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=u(ei.prototype,"openClipName",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"OpenScreen"}}),ai=u(ei.prototype,"closeClipName",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"CloseScreen"}}),ri=u(ei.prototype,"useSound",[Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),oi=u(ei.prototype,"openSound",[Qn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Me[He.POPUP_SHOW]}}),si=u(ei.prototype,"closeSound",[Xn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Me[He.POPUP_HIDE]}}),$n=ei))||$n)||$n);b._RF.pop(),b._RF.push({},"61d05acoKNP2rgcbUtU8kxl","ScreenBackground",void 0);var Bi=w.ccclass,Ni=w.property,Oi=Ludex,Di=Oi.Utils.Decorator,Fi=Oi.Events,zi=ze.Layout,Mi=codex.event,Ui=(d(pi={},zi.Portrait,{width:1080,height:2164}),d(pi,zi.Landscape,{width:2732,height:1583}),pi),Gi=(fi=Bi("ScreenBackground"),yi=Ni(Pi),vi=on.required(),gi=on.required(),mi=Ni(x),bi=Di.debounce(100),fi((ki=u((wi=function(e){i(p,e);var s,l,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"baseScreen",ki,h(e)),c(e,"sprite",Ti,h(e)),c(e,"uiTransform",Ci,h(e)),c(e,"additionalBg",Ei,h(e)),e.isPreloadCompleted=!1,e.listenGameEvents=function(t){t.screenName===Ve[We.DAILY_CHALLENGE_SCREEN]&&A.on(Oe.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ve[We.DAILY_CHALLENGE_SCREEN]&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},c(e,"handleViewResized",Li,h(e)),e.viewWidth=0,e.viewHeight=0,e.flag=!0,e}return o(p,[{key:"__preload",value:function(){}},{key:"tryUpdateBackgroundSprite",value:function(){if(Fe.getCurrentLayout()===ze.Layout.Landscape){var e=Fe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Fe.getCurrentLayoutBackgroundByKey("DailyChallenge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Fe.getCurrentLayoutBackgroundByKey("DailyChallenge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentDailyChallengeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"getLandscapeBackground",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return Ui}},{key:"onEnable",value:function(){this.handleViewResized()}},{key:"onDestroy",value:function(){Mi.off(Fi.OPENING_SCREEN,this.listenGameEvents),Mi.off(Fi.CLOSING_SCREEN,this.unlistenGameEvents),A.off(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateBackgroundSprite",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l,u,c,h,d,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPreloadCompleted){e.next=3;break}return console.log("Preload not completed yet, skipping updateBackgroundSprite"),e.abrupt("return");case 3:if(t=Fe.getCurrentLayout(),i=_.getVisibleSize(),a=i.width,r=i.height,this.flag){e.next=7;break}return e.abrupt("return");case 7:return this.flag=!1,this.viewWidth=a,this.viewHeight=r,o=[],s=null,l=null,u=this.getPortraitBackground().then((function(e){s=e})),o.push(u),t===ze.Layout.Landscape&&(c=this.getLandscapeBackground().then((function(e){l=e})),o.push(c)),e.next=18,Promise.all(o);case 18:t===ze.Layout.Landscape?(this.additionalBg&&(this.additionalBg.node.active=!0),this.setAdditionalBackgroundSprite(l),this.updateAdditionalSizeBackground(),this.setBackgroundSprite(s),this.updateSizeBackground(a,r)):t===ze.Layout.Portrait?(this.additionalBg&&(this.additionalBg.node.active=!1),this.setBackgroundSprite(s),this.updateSizeBackground(a,r)):console.warn("ScreenBackground: Unsupported layout",t),this.flag=!0,h=_.getVisibleSize(),d=h.width,p=h.height,d===a&&p===r||(console.log("ScreenBackground: Re-update background sprite due to spam resizing by user"),this.updateBackgroundSprite());case 22:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"updateSizeBackground",value:function(e,t){if(this.sprite&&this.sprite.spriteFrame){var n=this.getScreenDesignBackground()[zi.Portrait],i=n.width,a=n.height;this.uiTransform.setContentSize(i,a);var r=t/a;Fe.getCurrentLayout()===zi.Portrait?this.sprite.node.setScale(1,r):this.sprite.node.setScale(r,r),this.uiTransform.setAnchorPoint(.5,0),this.node.setPosition(0,-t/2,0)}}},{key:"updateAdditionalSizeBackground",value:function(){if(this.additionalBg){var e=_.getVisibleSize(),t=e.width,n=e.height;if(this.additionalBg.spriteFrame){var i=Fe.getCurrentLayout(),a=this.getScreenDesignBackground()[i],r=a.width,o=a.height;this.additionalBgUITransform.setContentSize(r,o);var s=t/r,l=n/o,u=Math.max(s,l);this.additionalBg.node.setScale(u,u),this.additionalBgUITransform.setAnchorPoint(.5,.5),this.additionalBg.node.setPosition(0,0,0)}}}},{key:"setAdditionalBackgroundSprite",value:function(e){this.additionalBg&&(this.additionalBg.spriteFrame=e)}}]),p}(E)).prototype,"baseScreen",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=u(wi.prototype,"sprite",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=u(wi.prototype,"uiTransform",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=u(wi.prototype,"additionalBg",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=u(wi.prototype,"handleViewResized",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite(),console.log("ScreenBackground: View resized, updating background sprite")}}}),Si=wi))||Si);b._RF.pop(),b._RF.push({},"6ca4ed2aINDB4yr+3glu5e0","ButtonPlusEvents",void 0);var Hi,Vi,Wi,qi,ji,Ki,Yi,Ji,Zi,Qi,Xi,$i,ea,ta,na,ia,aa,ra,oa,sa,la,ua,ca,ha,da,pa,fa,ya,va,ga="TRANSITION_DOWN",ma="TRANSITION_HOVER",ba="TRANSITION_RESET",Sa="TRANSITION_DISABLED",wa="CLICK_START",ka="CLICK",Ta="CLICK_END",Ca="CLICK_CANCEL";b._RF.pop(),b._RF.push({},"56710cJAPhPd4KK3hV3y8m6","ButtonPlus",void 0);var Ea,La,Ia,xa,Ra,Aa,_a,Pa,Ba,Na,Oa=w.ccclass,Da=w.property,Fa=w.disallowMultiple,za=w.menu,Ma=(Hi=Oa("ButtonPlus"),Vi=za("Ludex/ButtonPlus/ButtonPlus"),Wi=Da(O),qi=Da(O),ji=Da(O),Ki=Da({override:!0,visible:!1}),Yi=Da({override:!0,visible:!1}),Ji=Da({override:!0,visible:!1}),Zi=Da({override:!0,visible:!1}),Qi=Da({override:!0,visible:!1}),Xi=Da({override:!0,visible:!1}),$i=Da({override:!0,visible:!1}),ea=Da({override:!0,visible:!1}),ta=Da({override:!0,visible:!1}),na=Da({override:!0,visible:!1}),ia=Da({override:!0,visible:!1}),aa=Da({visible:function(){return this.makeSound},type:Me}),ra=Da({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),oa=Da({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),Hi(sa=Fa(sa=Vi((ua=u((la=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"onClickStartEvents",ua,h(e)),c(e,"onClickEndEvents",ca,h(e)),c(e,"onClickCancelEvents",ha,h(e)),c(e,"makeSound",da,h(e)),c(e,"soundKey",pa,h(e)),c(e,"disableSpamClick",fa,h(e)),c(e,"disableSpamDelay",ya,h(e)),c(e,"performBoundsCheckOnClickCancel",va,h(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.hasBeenDisabled=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=qe.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(e.performBoundsCheckOnClickCancel){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickCancelEvents(t),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.emitTransitionEvent(ma)))},e.onMouseLeave=function(t){e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.emitTransitionEvent(ba)},e}return o(n,[{key:"transition",get:function(){return D.Transition.NONE},set:function(e){p(f(n.prototype),"transition",D.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return y(f(n.prototype),"normalColor",this)},set:function(e){p(f(n.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return y(f(n.prototype),"pressedColor",this)},set:function(e){p(f(n.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return y(f(n.prototype),"hoverColor",this)},set:function(e){p(f(n.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return y(f(n.prototype),"disabledColor",this)},set:function(e){p(f(n.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return y(f(n.prototype),"normalSprite",this)},set:function(e){p(f(n.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return y(f(n.prototype),"pressedSprite",this)},set:function(e){p(f(n.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return y(f(n.prototype),"hoverSprite",this)},set:function(e){p(f(n.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return y(f(n.prototype),"disabledSprite",this)},set:function(e){p(f(n.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return y(f(n.prototype),"duration",this)},set:function(e){p(f(n.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return y(f(n.prototype),"zoomScale",this)},set:function(e){p(f(n.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){y(f(n.prototype),"__preload",this).call(this)}},{key:"onDestroy",value:function(){var e;null===(e=y(f(n.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=y(f(n.prototype),"onEnable",this))||void 0===e||e.call(this),this.hasBeenDisabled=!this.interactable,this.node.off(F.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(P.EventType.TOUCH_START,this.onTouchStart),this.node.on(P.EventType.TOUCH_END,this.onTouchEnd),this.node.on(P.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(P.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(P.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=y(f(n.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(P.EventType.TOUCH_START,this.onTouchStart),this.node.off(P.EventType.TOUCH_END,this.onTouchEnd),this.node.off(P.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(P.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(P.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"_updateState",value:function(){y(f(n.prototype),"_updateState",this).call(this),this.patchEmitTransitionDisabled()}},{key:"patchEmitTransitionDisabled",value:function(){var e=3===this._getButtonState();this.hasBeenDisabled!==e&&(e?this.emitTransitionEvent(Sa):this.emitTransitionEvent(ba),this.hasBeenDisabled=e)}},{key:"handleDown",value:function(e){this.hasDown=!0,this.makeSound&&Ge.playSound(Ue[this.soundKey]),this.emitTransitionEvent(ga),this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=l(this.onClickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(wa)}},{key:"emitClickEndEvents",value:function(e){var t,n=l(this.onClickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Ta)}},{key:"emitClickCancelEvents",value:function(e){var t,n=l(this.onClickCancelEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Ca)}},{key:"handleUp",value:function(e){this.hasUp=!0,this.hasFinishClickCycle=!0,this.emitTransitionEvent(ba),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){var t,n=l(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ka)}}},{key:"emitTransitionEvent",value:function(e){this.node.emit(e)}},{key:"fakeClick",value:function(){var e=this;this.emitTransitionEvent(ga),this.scheduleOnce((function(){e.emitTransitionEvent(ba)}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}},{key:"setInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.interactable=e,t&&(this.enabled=e)}}]),n}(D)).prototype,"onClickStartEvents",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ca=u(la.prototype,"onClickEndEvents",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ha=u(la.prototype,"onClickCancelEvents",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u(la.prototype,"transition",[Ki],Object.getOwnPropertyDescriptor(la.prototype,"transition"),la.prototype),u(la.prototype,"normalColor",[Yi],Object.getOwnPropertyDescriptor(la.prototype,"normalColor"),la.prototype),u(la.prototype,"pressedColor",[Ji],Object.getOwnPropertyDescriptor(la.prototype,"pressedColor"),la.prototype),u(la.prototype,"hoverColor",[Zi],Object.getOwnPropertyDescriptor(la.prototype,"hoverColor"),la.prototype),u(la.prototype,"disabledColor",[Qi],Object.getOwnPropertyDescriptor(la.prototype,"disabledColor"),la.prototype),u(la.prototype,"normalSprite",[Xi],Object.getOwnPropertyDescriptor(la.prototype,"normalSprite"),la.prototype),u(la.prototype,"pressedSprite",[$i],Object.getOwnPropertyDescriptor(la.prototype,"pressedSprite"),la.prototype),u(la.prototype,"hoverSprite",[ea],Object.getOwnPropertyDescriptor(la.prototype,"hoverSprite"),la.prototype),u(la.prototype,"disabledSprite",[ta],Object.getOwnPropertyDescriptor(la.prototype,"disabledSprite"),la.prototype),u(la.prototype,"duration",[na],Object.getOwnPropertyDescriptor(la.prototype,"duration"),la.prototype),u(la.prototype,"zoomScale",[ia],Object.getOwnPropertyDescriptor(la.prototype,"zoomScale"),la.prototype),da=u(la.prototype,"makeSound",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),pa=u(la.prototype,"soundKey",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Me[He.BUTTON_CLICK]}}),fa=u(la.prototype,"disableSpamClick",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ya=u(la.prototype,"disableSpamDelay",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),va=u(la.prototype,"performBoundsCheckOnClickCancel",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),sa=la))||sa)||sa)||sa);b._RF.pop(),b._RF.push({},"b7001YamGNLeauE1hUAtFfj","ButtonPlusAnalytics",void 0);var Ua,Ga,Ha,Va,Wa,qa,ja,Ka,Ya,Ja,Za,Qa,Xa,$a,er,tr,nr,ir,ar,rr,or,sr,lr,ur,cr=w.ccclass,hr=w.property,dr=w.disallowMultiple,pr=w.menu,fr=Ludex.Plugins.Analytics.Events,yr=codex.analytics;Ea=cr("ButtonPlusAnalytics"),La=pr("Ludex/ButtonPlus/ButtonPlusAnalytics"),Ia=on.required,xa=hr(Ma),Ra=hr({visible:function(){return this.useCustomButtonName}}),Ea(Aa=dr(Aa=La((Pa=u((_a=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"button",Pa,h(e)),c(e,"useCustomButtonName",Ba,h(e)),c(e,"customButtonName",Na,h(e)),e}return o(n,[{key:"onEnable",value:function(){this.button.node.on(ka,this.onClick,this)}},{key:"onDisable",value:function(){this.button.node.off(ga,this.onClick,this)}},{key:"onClick",value:function(){yr.event(fr.BUTTON_CLICK,{button_name:this.useCustomButtonName?this.customButtonName:this.node.name,screen_name:je.getCurrentPage()})}}]),n}(E)).prototype,"button",[Ia,xa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ba=u(_a.prototype,"useCustomButtonName",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Na=u(_a.prototype,"customButtonName",[Ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Aa=_a))||Aa)||Aa);b._RF.pop(),b._RF.push({},"49518iJ465A7YFaBHFr8zo2","ButtonPlusColor",void 0);var vr,gr,mr,br,Sr,wr,kr,Tr,Cr,Er,Lr,Ir,xr,Rr,Ar,_r,Pr,Br,Nr,Or=w.ccclass,Dr=w.property,Fr=w.disallowMultiple,zr=w.requireComponent,Mr=w.menu,Ur=Ludex.Utils.Signal,Gr=(Ua=Or("ButtonPlusColor"),Ga=zr(Ma),Ha=zr(x),Va=Mr("Ludex/ButtonPlus/ButtonPlusColor"),Wa=on.required,qa=Dr(Ma),ja=on.required,Ka=Dr(x),Ya=Dr({group:{name:"Normal",style:"section"},displayName:"Color"}),Ja=Dr({group:{name:"Normal",style:"section"},displayName:"Duration"}),Za=Dr({group:{name:"Hover",style:"section"},displayName:"Color"}),Qa=Dr({group:{name:"Hover",style:"section"},displayName:"Duration"}),Xa=Dr({group:{name:"Click",style:"section"},displayName:"Color"}),$a=Dr({group:{name:"Click",style:"section"},displayName:"Duration"}),Ua(er=Fr(er=Ga(er=Ha(er=Va((nr=u((tr=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"button",nr,h(e)),c(e,"sprite",ir,h(e)),c(e,"normalColor",ar,h(e)),c(e,"normalDuration",rr,h(e)),c(e,"hoverColor",or,h(e)),c(e,"hoverDuration",sr,h(e)),c(e,"clickColor",lr,h(e)),c(e,"clickDuration",ur,h(e)),e.animStateController=new Ur.SignalController,e}return o(n,[{key:"start",value:function(){this.setSpriteColor(this.normalColor)}},{key:"onEnable",value:function(){this.button.node.on(ga,this.onTransitionDown,this),this.button.node.on(ma,this.onTransitionHover,this),this.button.node.on(ba,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(ga,this.onTransitionDown,this),this.button.node.off(ma,this.onTransitionHover,this),this.button.node.off(ba,this.onTransitionReset,this)}},{key:"setSpriteColor",value:function(e){this.sprite&&(this.sprite.color=e)}},{key:"tweenSpriteColor",value:function(e,t){var n=this;if(this.sprite){var i=this.sprite.color.clone();Ke.runTweenAsync(z({t:0}).to(t,{t:1},{easing:"cubicOut",onUpdate:function(t){n.sprite&&(n.sprite.color=i.lerp(e,t.t))}}),this.animStateController.renew())}}},{key:"onTransitionDown",value:function(){this.tweenSpriteColor(this.clickColor,this.clickDuration)}},{key:"onTransitionHover",value:function(){this.tweenSpriteColor(this.hoverColor,this.hoverDuration)}},{key:"onTransitionReset",value:function(){this.tweenSpriteColor(this.normalColor,this.normalDuration)}}]),n}(E)).prototype,"button",[Wa,qa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ir=u(tr.prototype,"sprite",[ja,Ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ar=u(tr.prototype,"normalColor",[Ya],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,255)}}),rr=u(tr.prototype,"normalDuration",[Ja],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),or=u(tr.prototype,"hoverColor",[Za],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,255)}}),sr=u(tr.prototype,"hoverDuration",[Qa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),lr=u(tr.prototype,"clickColor",[Xa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(204,204,204)}}),ur=u(tr.prototype,"clickDuration",[$a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),er=tr))||er)||er)||er)||er)||er);b._RF.pop(),b._RF.push({},"a89b3F866FGO68YNa+5Tsqh","ButtonPlusScale",void 0);var Hr=w.ccclass,Vr=w.property,Wr=w.disallowMultiple,qr=w.menu,jr=Ludex.Utils.Signal;vr=Hr("ButtonPlusScale"),gr=qr("Ludex/ButtonPlus/ButtonPlusScale"),mr=on.required,br=Vr(Ma),Sr=Vr({group:{name:"Normal",style:"section"},displayName:"Scale"}),wr=Vr({group:{name:"Normal",style:"section"},displayName:"Duration"}),kr=Vr({group:{name:"Hover",style:"section"},displayName:"Scale"}),Tr=Vr({group:{name:"Hover",style:"section"},displayName:"Duration"}),Cr=Vr({group:{name:"Click",style:"section"},displayName:"Scale"}),Er=Vr({group:{name:"Click",style:"section"},displayName:"Duration"}),vr(Lr=Wr(Lr=gr((xr=u((Ir=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"button",xr,h(e)),c(e,"normalScale",Rr,h(e)),c(e,"normalDuration",Ar,h(e)),c(e,"hoverScale",_r,h(e)),c(e,"hoverDuration",Pr,h(e)),c(e,"clickScale",Br,h(e)),c(e,"clickDuration",Nr,h(e)),e.animStateController=new jr.SignalController,e}return o(n,[{key:"start",value:function(){this.button.node.setScale(this.normalScale)}},{key:"onEnable",value:function(){this.button.node.on(ga,this.onTransitionDown,this),this.button.node.on(ma,this.onTransitionHover,this),this.button.node.on(ba,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(ga,this.onTransitionDown,this),this.button.node.off(ma,this.onTransitionHover,this),this.button.node.off(ba,this.onTransitionReset,this)}},{key:"onTransitionDown",value:function(){Ke.runTweenAsync(z(this.button.node).to(this.clickDuration,{scale:this.clickScale},{easing:"cubicOut"}),this.animStateController.renew())}},{key:"onTransitionHover",value:function(){Ke.runTweenAsync(z(this.button.node).to(this.hoverDuration,{scale:this.hoverScale},{easing:"backOut"}),this.animStateController.renew())}},{key:"onTransitionReset",value:function(){Ke.runTweenAsync(z(this.button.node).to(this.normalDuration,{scale:this.normalScale},{easing:"cubicOut"}),this.animStateController.renew())}}]),n}(E)).prototype,"button",[mr,br],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=u(Ir.prototype,"normalScale",[Sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(1,1,1)}}),Ar=u(Ir.prototype,"normalDuration",[wr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),_r=u(Ir.prototype,"hoverScale",[kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(1.1,1.1,1.1)}}),Pr=u(Ir.prototype,"hoverDuration",[Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Br=u(Ir.prototype,"clickScale",[Cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(.9,.9,.9)}}),Nr=u(Ir.prototype,"clickDuration",[Er],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),Lr=Ir))||Lr)||Lr);b._RF.pop(),b._RF.push({},"bd9d5FQ4EpKcIK2rZmmYQPr","VibrateEffectManager",void 0);var Kr,Yr,Jr,Zr,Qr,Xr,$r,eo,to,no,io=Ludex.Utils.Browser,ao=codex.player,ro=function(){function e(){r(this,e)}return o(e,[{key:"isVibrateEnable",value:function(){return!!ao.getPlayerSetting("vibrate")}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"vibrate",value:function(e){if(this.inst.isVibrateEnable()&&0!==e&&!io.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}}]),e}();b._RF.pop(),b._RF.push({},"1c88ex+VNVCDaiLiD6eJgHG","ButtonPlusVibrate",void 0);var oo,so=w.ccclass,lo=w.property,uo=w.disallowMultiple,co=w.requireComponent,ho=w.menu;Ludex.Utils.Signal,Kr=so("ButtonPlusVibrate"),Yr=co(Ma),Jr=co(x),Zr=ho("Ludex/ButtonPlus/ButtonPlusVibrate"),Qr=on.required,Xr=lo(Ma),Kr($r=uo($r=Yr($r=Jr($r=Zr((to=u((eo=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"button",to,h(e)),c(e,"time",no,h(e)),e}return o(n,[{key:"onEnable",value:function(){this.button.node.on(ga,this.onTransitionDown,this)}},{key:"onDisable",value:function(){this.button.node.off(ga,this.onTransitionDown,this)}},{key:"onTransitionDown",value:function(){ro.vibrate(this.time)}}]),n}(E)).prototype,"button",[Qr,Xr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no=u(eo.prototype,"time",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 35}}),$r=eo))||$r)||$r)||$r)||$r);b._RF.pop(),b._RF.push({},"16eacEpHldFUJlfsLYO+IKK","DebugButtonPlus",void 0);var po,fo,yo,vo,go,mo,bo,So,wo,ko,To,Co,Eo,Lo,Io,xo,Ro,Ao=w.ccclass;w.property,Ao("DebugButtonPlus")(oo=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"onLoad",value:function(){Ludex.Utils.Valid.isDebugger()?this.node.active=!0:this.node.active=!1}},{key:"start",value:function(){}}]),n}(E));b._RF.pop(),b._RF.push({},"4b299Dv1kVGcqQmJC9yBPAV","ButtonReleased",void 0);var _o,Po,Bo,No,Oo=w.ccclass,Do=w.requireComponent,Fo=w.property,zo=w.disallowMultiple,Mo=w.executionOrder,Uo=codex.analytics;po=Oo("ButtonReleased"),fo=Do([k,D]),yo=Mo(120),vo=Fo(T),go=Fo(T),mo=Fo(B),bo=Fo({visible:function(){return this.useSound},type:Me}),So=Fo({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),wo=Fo({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),po(ko=zo(ko=fo(ko=yo((Co=u((To=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"downClipName",Co,h(e)),c(e,"upClipName",Eo,h(e)),c(e,"useSound",Lo,h(e)),c(e,"soundKey",Io,h(e)),c(e,"disableSpamClick",xo,h(e)),c(e,"disableSpamDelay",Ro,h(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.onTouchStart=function(t){if(e.buttonComponent.interactable&&!e.hasDown&&(e.currentClickBoundingBox=qe.getBoundingBoxToWorld(e.node),e.hasDown=!0,e.runAnimation(e.downClipName),e.useSound&&e.soundKey)){var n=Ue[e.soundKey];if(!n)return;Ge.playSound(n)}},e.onTouchEnd=function(t){e.buttonComponent.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))},e.onTouchCancel=function(t){var n,i;if(e.buttonComponent.interactable&&e.hasDown&&!e.hasUp){var a=t.getUILocation(),r=null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n;t instanceof G&&r?e.handleUp(t):(e.hasUp=!0,e.runAnimation(e.upClipName),e.animationComponent.once(k.EventType.FINISHED,(function(){e.handleResetButtonState()})))}},e.handleResetButtonState=function(){var t;if(e.hasDown=!1,e.hasUp=!1,e.buttonComponent){var n=e.buttonComponent.node.scale.x,i=e.buttonComponent.node.scale.z;null===(t=e.buttonComponent)||void 0===t||t.node.setScale(new U(n,1,i))}},e}return o(n,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(D),this.animationComponent=this.getComponent(k),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.animationComponent.clips.length<2?console.warn("ButtonAnimAddition: Animation component must have 2 clips in ".concat(this.node.name)):(this.node.off(F.EventType.TOUCH_END,this.buttonComponent._onTouchEnded,this.buttonComponent),this.node.on(P.EventType.TOUCH_START,this.onTouchStart),this.node.on(P.EventType.TOUCH_END,this.onTouchEnd),this.node.on(P.EventType.TOUCH_CANCEL,this.onTouchCancel))}},{key:"onDisable",value:function(){this.node.off(P.EventType.TOUCH_START,this.onTouchStart),this.node.off(P.EventType.TOUCH_END,this.onTouchEnd),this.node.off(P.EventType.TOUCH_CANCEL,this.onTouchCancel),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleUp",value:function(e){var t=this;this.hasUp=!0,this.runAnimation(this.upClipName),this.animationComponent.once(k.EventType.FINISHED,(function(){if(t.disableSpamClick?t.scheduleOnce(t.handleResetButtonState,t.disableSpamDelay):t.handleResetButtonState(),!t.buttonComponent||t.buttonComponent.interactable){Uo.event(Ludex.Plugins.Analytics.Events.BUTTON_CLICK,{button_name:t.node.name,screen_name:je.getCurrentPage()});var n=t.buttonComponent.clickEvents;if(n){var i,a=l(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;r.emit([e,r.customEventData])}}catch(e){a.e(e)}finally{a.f()}}}}))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),n}(E)).prototype,"downClipName",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonDown"}}),Eo=u(To.prototype,"upClipName",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonUp"}}),Lo=u(To.prototype,"useSound",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Io=u(To.prototype,"soundKey",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Me[He.BUTTON_CLICK]}}),xo=u(To.prototype,"disableSpamClick",[So],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ro=u(To.prototype,"disableSpamDelay",[wo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),ko=To))||ko)||ko)||ko);b._RF.pop(),b._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var Go,Ho,Vo,Wo,qo,jo,Ko,Yo,Jo,Zo,Qo,Xo,$o,es,ts=w.ccclass,ns=w.requireComponent,is=w.property,as=ts("OpacityToggler")(_o=ns([N])((Bo=u((Po=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"activeValue",Bo,h(e)),c(e,"inActiveValue",No,h(e)),e}return o(n,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(N),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}}]),n}(E)).prototype,"activeValue",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),No=u(Po.prototype,"inActiveValue",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),_o=Po))||_o)||_o;b._RF.pop(),b._RF.push({},"c3ceby2vFtPK4X28SuN+nVX","ResizeWithBannerAd",void 0);var rs,os,ss,ls=w.ccclass,us=w.requireComponent,cs=w.property,hs=codex,ds=hs.ads,ps=hs.event,fs=Ludex,ys=fs.Events,vs=fs.Configs.Ads.BannerDisplayAdOptions,gs=fs.Plugins.Ads,ms=gs.Types,bs=gs.Status,Ss=fs.Utils,ws=Ss.Array,ks=Ss.Function,Ts=Ss.Device,Cs=["top","topleft","topright"],Es=["bottom","bottomleft","bottomright"],Ls=["left","topleft","bottomleft"],Is=["right","topright","bottomright"];Go=ls("ResizeWithBannerAd"),Ho=us(H),Vo=cs(B),Wo=cs(B),qo=cs(B),jo=cs(B),Ko=cs(B),Go(Yo=Ho((Zo=u((Jo=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"includeSAB",Zo,h(e)),c(e,"includeRightBanner",Qo,h(e)),c(e,"includeBottomBanner",Xo,h(e)),c(e,"includeLeftBanner",$o,h(e)),c(e,"closeWhenAdFailed",es,h(e)),e.handleOnAdShowing=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&(i===ms.BANNER&&ds.getAd(ms.BANNER,n)&&(e.resizeWhenBannerAdShow(n),e.emitResizeEvent()))},e.handleOnAdClosed=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&(i===ms.BANNER&&ds.getAd(ms.BANNER,n)&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent()))},e.handleOnAdFailed=function(t){var n=t.placementId,i=t.type;e.closeWhenAdFailed&&e.checkValid()&&n&&i===ms.BANNER&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent())},e.handleOnResize=function(){e.checkValid()&&(0!==vs.length?vs.forEach((function(t){var n=t.PlacementId,i=ds.getAdStatus(ms.BANNER,n);i&&(i===bs.SHOWING||Ts.isIOS()?e.resizeWhenBannerAdShow(n):i===bs.IDLE&&e.resizeWhenBannerAdClose(n))})):e.resizeSafeAreaBottom())},e.resizeWhenBannerAdShow=function(t){var n=void 0,i=void 0,a=void 0,r=void 0,o=qe.cssSizeToWorldSize(1),s=ds.getBannerConfig(t),l=s.PlacementId,u=s.BannerWidth,c=s.Position;if("top"===c)n=ds.getBannerHeight(l,o);else if("bottom"===c)e.includeBottomBanner?i=ds.getBannerHeight(l,o,e.includeSAB):e.includeSAB&&(i=ds.getSafeAreaBottom(o));else if("left"===c||"right"===c){if(void 0===u)return;var h=u;"getBannerOffset"in GameSDK.extra&&(h+=GameSDK.extra.getBannerOffset()),"left"===c&&e.includeLeftBanner?a=h*o:"right"===c&&e.includeRightBanner&&(r=h*o)}e.updateWidgets({top:n,bottom:i,left:a,right:r})},e.resizeWhenBannerAdClose=function(t){var n=ds.getBannerConfig(t).Position,i=qe.cssSizeToWorldSize(1),a=e.includeSAB?ds.getSafeAreaBottom(i):0;e.updateWidgets({top:ws.has(Cs,n)?0:void 0,bottom:ws.has(Es,n)?a:void 0,left:ws.has(Ls,n)?0:void 0,right:ws.has(Is,n)?0:void 0})},e.resizeSafeAreaBottom=function(){var t=qe.cssSizeToWorldSize(1),n=e.includeSAB?ds.getSafeAreaBottom(t):0;e.updateWidgets({bottom:n})},e.emitResizeEvent=ks.debounce((function(){A.emit(Oe.WIDGET_RESIZED)}),100),e}return o(n,[{key:"__preload",value:function(){this.widget=this.getComponent(H),on.lazyValidateProperties(this),ps.on(ys.AD_SHOWING,this.handleOnAdShowing),ps.on(ys.AD_CLOSED,this.handleOnAdClosed),ps.on(ys.AD_FAILED,this.handleOnAdFailed),A.on(Oe.VIEW_RESIZED,this.handleOnResize)}},{key:"onDestroy",value:function(){ps.off(ys.AD_SHOWING,this.handleOnAdShowing),ps.off(ys.AD_CLOSED,this.handleOnAdClosed),ps.off(ys.AD_FAILED,this.handleOnAdFailed),A.off(Oe.VIEW_RESIZED,this.handleOnResize)}},{key:"onEnable",value:function(){this.handleOnResize()}},{key:"updateWidgets",value:function(e){var t=e.top,n=e.bottom,i=e.left,a=e.right;this.widget.top=null!=t?t:this.widget.top,this.widget.bottom=null!=n?n:this.widget.bottom,this.widget.left=null!=i?i:this.widget.left,this.widget.right=null!=a?a:this.widget.right,V.instance.emit("canvas-resize")}},{key:"checkValid",value:function(){return this.node.activeInHierarchy&&null!==this.node.parent&&void 0!==this.node.parent}}]),n}(E)).prototype,"includeSAB",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Qo=u(Jo.prototype,"includeRightBanner",[Wo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Xo=u(Jo.prototype,"includeBottomBanner",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$o=u(Jo.prototype,"includeLeftBanner",[jo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),es=u(Jo.prototype,"closeWhenAdFailed",[Ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Yo=Jo))||Yo);b._RF.pop(),b._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var xs=w.ccclass,Rs=w.property,As=w.requireComponent,_s=w.disallowMultiple,Ps=w.executeInEditMode,Bs=ze.DesignSize,Ns=Bs.Portrait,Os=Bs.Landscape;xs("DebugResolution")(rs=_s(rs=As([W])(rs=Ps(!0)(((ss=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return o(n,[{key:"drawPortrait",get:function(){return n._drawPortrait},set:function(e){e!==n._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),n._drawPortrait=e,n._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return n._drawLandscape},set:function(e){e!==n._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),n._drawLandscape=e,n._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(W),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){A.on(Oe.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=Ns.WIDTH,n=Ns.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=M.GREEN,e.rect(i,a,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=Os.WIDTH,n=Os.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=M.CYAN,e.rect(i,a,t,n),e.stroke()}}}]),n}(E))._drawPortrait=!0,ss._drawLandscape=!0,u((os=ss).prototype,"drawPortrait",[Rs],Object.getOwnPropertyDescriptor(os.prototype,"drawPortrait"),os.prototype),u(os.prototype,"drawLandscape",[Rs],Object.getOwnPropertyDescriptor(os.prototype,"drawLandscape"),os.prototype),rs=os))||rs)||rs)||rs);b._RF.pop(),b._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var Ds,Fs,zs,Ms,Us,Gs,Hs,Vs,Ws,qs,js,Ks,Ys,Js,Zs,Qs,Xs,$s,el,tl,nl,il,al,rl,ol,sl,ll,ul,cl,hl,dl,pl,fl,yl,vl,gl,ml,bl,Sl,wl,kl,Tl,Cl=function(){function e(){r(this,e),this.time=0,this._value=0,this.time=0,this._value=0}return o(e,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),e}();b._RF.pop(),b._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var El,Ll,Il,xl,Rl,Al,_l,Pl=w.ccclass,Bl=w.executionOrder,Nl=w.property,Ol=w.requireComponent,Dl=Ludex,Fl=Dl.Utils,zl=Fl.Valid,Ml=Fl.Array,Ul=Fl.Device,Gl=Dl.Configs.Debugger.ListPlayerDevIds,Hl=codex.player,Vl=M.RED,Wl=M.YELLOW,ql=M.WHITE,jl=M.BLACK;Ds=Pl("GameStats"),Fs=Bl(-1e3),zs=Ol([N]),Ms=on.required(),Us=Nl(q),Gs=on.required(),Hs=Nl(q),Vs=on.required(),Ws=Nl(q),qs=on.required(),js=Nl(q),Ks=on.required(),Ys=Nl(q),Js=on.required(),Zs=Nl(q),Qs=on.required(),Xs=Nl(q),$s=on.required(),el=Nl(q),tl=on.required(),nl=Nl(q),il=on.required(),al=Nl(q),rl=on.required(),ol=Nl(q),sl=on.required(),ll=on.required(),Ds(ul=Fs(ul=zs((hl=u((cl=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"dprLabel",hl,h(e)),c(e,"fpsLabel",dl,h(e)),c(e,"fpsRawLabel",pl,h(e)),c(e,"drawCountLabel",fl,h(e)),c(e,"rafTimeLabel",yl,h(e)),c(e,"deltaTimeLabel",vl,h(e)),c(e,"logicTimeLabel",gl,h(e)),c(e,"physicTimeLabel",ml,h(e)),c(e,"renderTimeLabel",bl,h(e)),c(e,"objectMemoryUsageLabel",Sl,h(e)),c(e,"textureMemoryUsageLabel",wl,h(e)),c(e,"bg",kl,h(e)),c(e,"opacity",Tl,h(e)),e.lastRafTime=0,e.slowRefreshInterval=1,e.mediumRefreshInterval=.5,e.fastRefreshInterval=.16,e.isBackgroundEnabled=!1,e.touchMs=0,e.isDragging=!1,e.handleTouchStart=function(t){t.touch&&(e.isDragging=!1,Date.now()-e.touchMs<300?e.opacity&&(e.opacity.opacity=0):e.opacity&&(e.opacity.opacity=255),e.touchMs=Date.now())},e.handleTouchMove=function(t){var n=t.touch;if(n){var i=n.getUIDelta();!e.isDragging&&i.length()>10&&(e.isDragging=!0),e.isDragging&&e.node.setPosition(e.node.position.x+i.x,e.node.position.y+i.y)}},e.handleTouchEnd=function(){e.isDragging||(e.bg.enabled=!e.bg.enabled,e.isBackgroundEnabled=e.bg.enabled),e.isDragging=!1},e.updateFastStats=function(){e.updateFpsRaw(),e.updateRafTime(),e.updateDeltaTime()},e.updateSlowStats=function(){e.updateDPR(),e.updateDrawCalls(),e.updateObjectMemoryUsage(),e.updateTextureMemoryUsage()},e.updateMediumStats=function(){e.updateFps(),e.updateLogicTime(),e.updatePhysicTime(),e.updateRenderTime()},e.calcRafTime=function(t){var n;null!==(n=e.node)&&void 0!==n&&n.isValid&&(e.rafTimeCounter.end(t),e.lastRafTime=t,e.handleRequestAnimationFrame())},e.handleRequestAnimationFrame=function(){e.rafTimeCounter.start(e.lastRafTime),requestAnimationFrame(e.calcRafTime)},e}return o(n,[{key:"__preload",value:function(){this.bg=this.getComponent(x),this.opacity=this.getComponent(N),this.listenInputEvents()}},{key:"onLoad",value:function(){on.validateRequiredProperties(this)}},{key:"listenInputEvents",value:function(){this.node.on(F.EventType.TOUCH_START,this.handleTouchStart),this.node.on(F.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.on(F.EventType.TOUCH_END,this.handleTouchEnd),this.node.on(F.EventType.TOUCH_CANCEL,this.handleTouchEnd)}},{key:"start",value:function(){this.bg.enabled=!1,this.canDisplayStats()?(this.node.active=!0,this.rafTimeCounter=new Cl,this.logicTimeCounter=new Cl,this.physicTimeCounter=new Cl,this.renderTimeCounter=new Cl,I.on(j.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),I.on(j.EVENT_AFTER_UPDATE,this.afterUpdate,this),I.on(j.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),I.on(j.EVENT_AFTER_PHYSICS,this.afterPhysics,this),I.on(j.EVENT_BEFORE_DRAW,this.beforeDraw,this),I.on(j.EVENT_AFTER_DRAW,this.afterDraw,this),this.startUpdateStats()):this.node.active=!1}},{key:"onDestroy",value:function(){this.canDisplayStats()&&(I.off(j.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),I.off(j.EVENT_AFTER_UPDATE,this.afterUpdate,this),I.off(j.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),I.off(j.EVENT_AFTER_PHYSICS,this.afterPhysics,this),I.off(j.EVENT_BEFORE_DRAW,this.beforeDraw,this),I.off(j.EVENT_AFTER_DRAW,this.afterDraw,this),this.unschedule(this.updateSlowStats),this.unschedule(this.updateFastStats),this.unschedule(this.updateMediumStats),this.node.off(F.EventType.TOUCH_START,this.handleTouchStart),this.node.off(F.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.off(F.EventType.TOUCH_END,this.handleTouchEnd),this.node.off(F.EventType.TOUCH_CANCEL,this.handleTouchEnd))}},{key:"canDisplayStats",value:function(){return zl.isDebugger()||Ml.has(Gl,Hl.getPlayerId())}},{key:"startUpdateStats",value:function(){this.schedule(this.updateFastStats,this.fastRefreshInterval),this.schedule(this.updateSlowStats,this.slowRefreshInterval),this.schedule(this.updateMediumStats,this.mediumRefreshInterval),requestAnimationFrame(this.handleRequestAnimationFrame)}},{key:"updateFps",value:function(){var e=this.getFps();this.updateFpsColor(e),this.fpsLabel.string="FPS: ".concat(e)}},{key:"updateFpsColor",value:function(e){e<30?this.fpsLabel.color=Vl:e<48?this.fpsLabel.color=Wl:this.setColorWithBackground(this.fpsLabel)}},{key:"updateFpsRaw",value:function(){var e=this.getFpsRaw();this.updateFpsRawColor(e),this.fpsRawLabel.string="FPS Raw: ".concat(e)}},{key:"updateFpsRawColor",value:function(e){e<30?this.fpsRawLabel.color=Vl:e<48?this.fpsRawLabel.color=Wl:this.setColorWithBackground(this.fpsRawLabel)}},{key:"updateDrawCalls",value:function(){var e=this.getDrawCalls();this.updateDrawCallsColor(e),this.drawCountLabel.string="Draw Calls: ".concat(e)}},{key:"updateDrawCallsColor",value:function(e){var t=K.os===K.OS.IOS,n=t?60:25;e>(t?80:40)?this.drawCountLabel.color=Vl:e>n?this.drawCountLabel.color=Wl:this.setColorWithBackground(this.drawCountLabel)}},{key:"updateRafTime",value:function(){var e=this.getRafTime();this.updateRafTimeColor(e),this.rafTimeLabel.string="RAF Time: ".concat(e,"ms")}},{key:"updateRafTimeColor",value:function(e){e>32?this.rafTimeLabel.color=Vl:e>16?this.rafTimeLabel.color=Wl:this.setColorWithBackground(this.rafTimeLabel)}},{key:"updateDeltaTime",value:function(){var e=this.getDeltaTime();this.updateDeltaTimeColor(e),this.deltaTimeLabel.string="Delta Time: ".concat(e,"ms")}},{key:"updateDeltaTimeColor",value:function(e){e>32?this.deltaTimeLabel.color=Vl:e>16?this.deltaTimeLabel.color=Wl:this.setColorWithBackground(this.deltaTimeLabel)}},{key:"updateLogicTime",value:function(){var e=this.getLogicTime();this.updateLogicTimeColor(e),this.logicTimeLabel.string="Logic Time: ".concat(e,"ms")}},{key:"updateLogicTimeColor",value:function(e){e>10?this.logicTimeLabel.color=Vl:e>5?this.logicTimeLabel.color=Wl:this.setColorWithBackground(this.logicTimeLabel)}},{key:"updatePhysicTime",value:function(){var e=this.getPhysicTime();this.updatePhysicTimeColor(e),this.physicTimeLabel.string="Physic Time: ".concat(e,"ms")}},{key:"updatePhysicTimeColor",value:function(e){e>10?this.physicTimeLabel.color=Vl:e>5?this.physicTimeLabel.color=Wl:this.setColorWithBackground(this.physicTimeLabel)}},{key:"updateRenderTime",value:function(){var e=this.getRenderTime();this.updateRenderTimeColor(e),this.renderTimeLabel.string="Render Time: ".concat(e,"ms")}},{key:"updateRenderTimeColor",value:function(e){e>10?this.renderTimeLabel.color=Vl:e>5?this.renderTimeLabel.color=Wl:this.setColorWithBackground(this.renderTimeLabel)}},{key:"updateObjectMemoryUsage",value:function(){var e=this.getObjectMemoryUsage();this.updateObjectMemoryUsageColor(e),this.objectMemoryUsageLabel.string="Object Mem: ".concat(e,"MB")}},{key:"updateObjectMemoryUsageColor",value:function(e){e>40?this.objectMemoryUsageLabel.color=Vl:e>25?this.objectMemoryUsageLabel.color=Wl:this.setColorWithBackground(this.objectMemoryUsageLabel)}},{key:"updateTextureMemoryUsage",value:function(){var e=this.getTextureMemoryUsage();this.updateTextureMemoryUsageColor(e),this.textureMemoryUsageLabel.string="Texture Mem: ".concat(e,"MB")}},{key:"updateTextureMemoryUsageColor",value:function(e){e>200?this.textureMemoryUsageLabel.color=Vl:e>100?this.textureMemoryUsageLabel.color=Wl:this.setColorWithBackground(this.textureMemoryUsageLabel)}},{key:"updateDPR",value:function(){var e=Ul.pixelRatio();this.updateDPRColor(e),this.dprLabel.string="DPR: ".concat(e)}},{key:"updateDPRColor",value:function(e){e>2?this.dprLabel.color=Vl:e<=1?this.dprLabel.color=Wl:this.setColorWithBackground(this.dprLabel)}},{key:"setColorWithBackground",value:function(e){e.color=this.isBackgroundEnabled?ql:jl}},{key:"getFps",value:function(){if(!I.root)return 0;var e=I.root.fps;return Math.round(e)||0}},{key:"getDrawCalls",value:function(){return I.root&&I.root.device.numDrawCalls||0}},{key:"toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(t))||0}},{key:"getFpsRaw",value:function(){return this.toFixed(1e3/this.rafTimeCounter.value,0)}},{key:"getRafTime",value:function(){return this.toFixed(this.rafTimeCounter.value)}},{key:"getDeltaTime",value:function(){return this.toFixed(1e3*A.deltaTime)}},{key:"getLogicTime",value:function(){return this.toFixed(this.logicTimeCounter.value)}},{key:"getPhysicTime",value:function(){return this.toFixed(this.physicTimeCounter.value)}},{key:"getRenderTime",value:function(){return this.toFixed(this.renderTimeCounter.value)}},{key:"getObjectMemoryUsage",value:function(){if(!I.root)return 0;var e=I.root.device.memoryStatus;return this.toFixed(e.bufferSize/1048576,4)||0}},{key:"getTextureMemoryUsage",value:function(){if(!I.root)return 0;var e=I.root.device.memoryStatus;return this.toFixed(e.textureSize/1048576,4)||0}},{key:"beforeUpdate",value:function(){var e=performance.now();this.logicTimeCounter.start(e)}},{key:"afterUpdate",value:function(){var e=performance.now();this.logicTimeCounter.end(e)}},{key:"beforePhysics",value:function(){var e=performance.now();this.physicTimeCounter.start(e)}},{key:"afterPhysics",value:function(){var e=performance.now();this.physicTimeCounter.end(e)}},{key:"beforeDraw",value:function(){var e=performance.now();this.renderTimeCounter.start(e)}},{key:"afterDraw",value:function(){var e=performance.now();this.renderTimeCounter.end(e)}}]),n}(E)).prototype,"dprLabel",[Ms,Us],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dl=u(cl.prototype,"fpsLabel",[Gs,Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pl=u(cl.prototype,"fpsRawLabel",[Vs,Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fl=u(cl.prototype,"drawCountLabel",[qs,js],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=u(cl.prototype,"rafTimeLabel",[Ks,Ys],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl=u(cl.prototype,"deltaTimeLabel",[Js,Zs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl=u(cl.prototype,"logicTimeLabel",[Qs,Xs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ml=u(cl.prototype,"physicTimeLabel",[$s,el],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=u(cl.prototype,"renderTimeLabel",[tl,nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sl=u(cl.prototype,"objectMemoryUsageLabel",[il,al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wl=u(cl.prototype,"textureMemoryUsageLabel",[rl,ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=u(cl.prototype,"bg",[sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tl=u(cl.prototype,"opacity",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ul=cl))||ul)||ul);b._RF.pop(),b._RF.push({},"e385aHZ0YdE449MMaQ5BZrq","CustomProgressBar",void 0);var Kl,Yl,Jl,Zl,Ql,Xl,$l,eu,tu,nu,iu=w.ccclass,au=w.property,ru=(w.requireComponent,El=iu("CustomProgressBar"),Ll=au(x),Il=au(x),El((Al=u((Rl=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).progress=0,c(e,"head",Al,h(e)),c(e,"tail",_l,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.progressBar=this.getComponent(Y),this.headWidth=this.head.getComponent(R).width,this.tailWidth=this.tail.getComponent(R).width;var e=this.tail.node.x-this.head.node.x-this.headWidth;this.progressBar.totalLength=e}},{key:"setProgress",value:function(e){if(e<0||e>1)console.warn("Progress value must be between 0 and 1");else{if(!this.progressBar){this.progressBar=this.getComponent(Y),this.headWidth=this.head.getComponent(R).width,this.tailWidth=this.tail.getComponent(R).width;var t=this.tail.node.x-this.head.node.x-this.headWidth;this.progressBar.totalLength=t}this.progress=e;var n=this.progressBar.totalLength+this.headWidth+this.tailWidth,i=n*e;0===i?(this.head.node.active=!1,this.tail.node.active=!1,this.progressBar.progress=0):i<this.headWidth?(this.head.node.active=!0,this.tail.node.active=!1,this.progressBar.progress=0):i<n-this.tailWidth/2?(this.head.node.active=!0,this.tail.node.active=!1,this.progressBar.progress=(i-this.headWidth)/this.progressBar.totalLength):(this.head.node.active=!0,this.tail.node.active=!0,this.progressBar.progress=1)}}},{key:"getProgress",value:function(){return this.progress}},{key:"onDestroy",value:function(){}}]),n}(E)).prototype,"head",[Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_l=u(Rl.prototype,"tail",[Il],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl=Rl))||xl);b._RF.pop(),b._RF.push({},"a60a9MZ5HNKVrHVpmUqCahw","ResponsiveNode",void 0);var ou,su,lu,uu,cu,hu,du,pu,fu,yu,vu,gu,mu,bu,Su,wu,ku,Tu=w.ccclass,Cu=w.property,Eu=function(e){return e.NONE="None",e.SCALE_Y="ScaleY",e.SCALE="Scale",e.RESIZE="Resize",e.RESIZE_WITH_BANNER="ResizeWithBanner",e}(Eu||{}),Lu=Ludex,Iu=Lu.Utils.Decorator,xu=(Lu.Events,ze.Layout),Ru=(d(Kl={},xu.Portrait,{width:1080,height:2164}),d(Kl,xu.Landscape,{width:2732,height:1583}),Kl),Au=(Yl=Tu("ResponsiveNode"),Jl=Cu(B),Zl=Cu({type:J(Eu)}),Ql=Iu.debounce(100),Yl((eu=u(($l=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"isFooter",eu,h(e)),c(e,"resizeType",tu,h(e)),c(e,"handleViewResized",nu,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.basePosition={x:this.node.position.x,y:this.node.position.y},this.uiTransform=this.node.getComponent(R),this.baseSize={width:this.uiTransform.contentSize.width,height:this.uiTransform.contentSize.height},this.baseScale={x:this.node.scale.x,y:this.node.scale.y}}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}},{key:"onEnable",value:function(){this.handleViewResized(),this.listenGameEvents()}},{key:"onDisable",value:function(){this.unlistenGameEvents()}},{key:"listenGameEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"unlistenGameEvents",value:function(){A.off(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"updateObjectInLayoutPortrait",value:function(){var e=_.getVisibleSize(),t=e.width,n=e.height,i=Ru[xu.Portrait],a=t/i.width,r=n/i.height,o=Ye.getBannerAdsHeight();switch(this.isFooter?this.node.setPosition(new U(this.basePosition.x,this.basePosition.y*r+o,0)):this.node.setPosition(new U(this.basePosition.x,this.basePosition.y*r,0)),this.resizeType){case Eu.SCALE_Y:this.node.setScale(new U(this.baseScale.x,this.baseScale.y*r,1));break;case Eu.SCALE:this.node.setScale(new U(this.baseScale.x*Math.min(a,r),this.baseScale.y*Math.min(a,r),1));break;case Eu.RESIZE:this.node.getComponent(R).setContentSize(this.baseSize.width*a,this.baseSize.height*r);break;case Eu.RESIZE_WITH_BANNER:var s=this.node.getComponent(R);this.isFooter?(this.node.setPosition(new U(this.basePosition.x,this.basePosition.y*r+o*(1-this.uiTransform.anchorPoint.y),0)),s.setContentSize(this.baseSize.width*a,this.baseSize.height*r-o)):s.setContentSize(this.baseSize.width*a,this.baseSize.height*r);break;case Eu.NONE:}}},{key:"updateObjectInLayoutLandscape",value:function(){var e=Ye.getBannerAdsHeight();switch(this.isFooter?this.node.setPosition(new U(this.basePosition.x,this.basePosition.y+e,0)):this.node.setPosition(new U(this.basePosition.x,this.basePosition.y,0)),this.resizeType){case Eu.SCALE_Y:case Eu.SCALE:this.node.setScale(new U(this.baseScale.x,this.baseScale.y,1));break;case Eu.RESIZE:this.node.getComponent(R).setContentSize(this.baseSize.width,this.baseSize.height);break;case Eu.RESIZE_WITH_BANNER:var t=this.node.getComponent(R),n=this.isFooter?e:0;t.setContentSize(this.baseSize.width,this.baseSize.height-n),this.isFooter,this.node.setPosition(new U(this.basePosition.x,this.basePosition.y+n/2,0));break;case Eu.NONE:}}}]),n}(E)).prototype,"isFooter",[Jl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),tu=u($l.prototype,"resizeType",[Zl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Eu.NONE}}),nu=u($l.prototype,"handleViewResized",[Ql],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Fe.getCurrentLayout();t===ze.Layout.Portrait?e.updateObjectInLayoutPortrait():t===ze.Layout.Landscape&&e.updateObjectInLayoutLandscape()}}}),Xl=$l))||Xl);b._RF.pop(),b._RF.push({},"de0da6Sv3RKX4hKrjSEeaiO","VelocityScroller",void 0);var _u,Pu=w.ccclass,Bu=w.property,Nu="scroll-update-continuous",Ou="scroll-update-discrete",Du=(ou=Pu("VelocityScroller"),su=Bu(Z),lu=Bu(Z),uu=Bu(Z),cu=Bu(Z),hu=Bu(Z),du=Bu(P),pu=Bu(R),ou((vu=u((yu=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"acceleration",vu,h(e)),c(e,"scrollingSpeed",gu,h(e)),c(e,"mouseScrollingSpeed",mu,h(e)),c(e,"maxBounceHeight",bu,h(e)),c(e,"outRangeDecayFactor",Su,h(e)),c(e,"content",wu,h(e)),c(e,"viewPort",ku,h(e)),e.lastTouchPos=new Q,e.lastTouchMovePos=new Q,e.velocity=new Q,e.isTouching=!1,e.isStartFromBottom=!0,e.isFreeControl=!1,e.bottomBorder=0,e.topBorder=0,e.startTime=0,e.prevContentPosY=0,e.prevContentPosY2=0,e.originalContentHeight=0,e.originalViewPortHeight=0,e.originalTopBorder=0,e.originalBottomBorder=0,e}return o(n,[{key:"__preload",value:function(){this.registerEvents(),this.initializeComponents(),this.initData()}},{key:"registerEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleScrollerWhenResize,this),this.node.on(P.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(P.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(P.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(P.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.on(P.EventType.MOUSE_WHEEL,this.onMouseScrolling,this)}},{key:"handleScrollerWhenResize",value:function(){this.setUpBorders()}},{key:"addBorderAmount",value:function(e){this.isStartFromBottom?this.bottomBorder=this.originalBottomBorder-e:(this.topBorder=this.originalTopBorder+e,this.bottomBorder=this.originalBottomBorder+e)}},{key:"initData",value:function(){this.originalViewPortHeight=this.scrollerUITransform.height,this.originalContentHeight=this.contentUITransform.height}},{key:"setFreeControl",value:function(e){this.isFreeControl=e}},{key:"initScroller",value:function(e){var t=e.isStartFromBottom,n=e.isAddedHeight,i=e.height;this.isStartFromBottom=t,this.contentUITransform.height=n?this.originalContentHeight+i:i,this.setUpBorders()}},{key:"addHeightToViewport",value:function(e){this.scrollerUITransform.height=this.originalViewPortHeight+e}},{key:"setUpBorders",value:function(){var e=this.viewPort.node.position.y,t=this.contentUITransform.contentSize.height;this.isStartFromBottom?(this.topBorder=e+this.maxBounceHeight,this.bottomBorder=-(t-Math.abs(e))-this.maxBounceHeight):(this.topBorder=t-Math.abs(e)+this.maxBounceHeight,this.bottomBorder=e-this.maxBounceHeight),this.originalTopBorder=this.topBorder,this.originalBottomBorder=this.bottomBorder}},{key:"initializeComponents",value:function(){this.scrollerUITransform=this.getComponent(R),this.contentUITransform=this.content.getComponent(R),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onTouchStart",value:function(e){this.isFreeControl||(this.isTouching=!0,this.lastTouchPos=e.getLocation().clone(),this.lastTouchMovePos=e.getLocation().clone(),this.startTime=Date.now())}},{key:"onTouchMove",value:function(e){if(!this.isFreeControl){var t=e.getLocation().clone(),n=t.y-this.lastTouchMovePos.y,i=this.content.position,a=i.x,r=i.y,o=i.z;this.isOutRange()&&(n*=this.outRangeDecayFactor);var s=this.clampTargetY(r+n);this.content.setPosition(a,s,o),this.lastTouchMovePos.set(t.clone())}}},{key:"onTouchEnd",value:function(e){if(!this.isFreeControl&&(this.isTouching=!1,!((Date.now()-this.startTime)/1e3>.2))){var t=e.getLocation().clone(),n=t.y-this.lastTouchPos.y,i=this.velocity.y;this.lastTouchPos.set(t.clone()),this.velocity.set(0,i+n)}}},{key:"onMouseScrolling",value:function(e){if(!this.isFreeControl){var t=e.getScrollY()*this.mouseScrollingSpeed,n=this.velocity.y;this.velocity.set(0,n-t)}}},{key:"update",value:function(e){this.updateScroller(e),this.tryToUpdateContinuousScroller(),this.tryToUpdateDiscreteScroller()}},{key:"tryToUpdateDiscreteScroller",value:function(){this.canDiscreteUpdate()&&this.node.emit(Ou)}},{key:"tryToUpdateContinuousScroller",value:function(){this.canContinuousUpdate()&&this.node.emit(Nu)}},{key:"canDiscreteUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY)<=10)&&(this.prevContentPosY=e,!0)}},{key:"canContinuousUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY2)<=10)&&(this.prevContentPosY2=e,!0)}},{key:"updateScroller",value:function(e){if(!this.isFreeControl&&!this.tryToBounceBack(e)){var t=this.content.position,n=t.x,i=t.y,a=t.z,r=this.velocity.y,o=i+r*this.scrollingSpeed*e,s=this.getVelocityOverTime(r,e);this.velocity.set(0,s),o>this.topBorder&&(o=this.topBorder,this.velocity.set(0,0)),o<this.bottomBorder&&(o=this.bottomBorder,this.velocity.set(0,0)),o=this.handleClampTargetY(o),this.content.setPosition(n,o,a)}}},{key:"handleClampTargetY",value:function(e){if(this.isOutRange()){var t=this.velocity.y;this.velocity.set(0,t*this.outRangeDecayFactor)}return this.clampTargetY(e)}},{key:"clampTargetY",value:function(e){return e>this.topBorder?(this.velocity.set(0,0),this.topBorder):e<this.bottomBorder?(this.velocity.set(0,0),this.bottomBorder):e}},{key:"tryToBounceBack",value:function(e){var t=this.content.position.y;if(this.isTouching)return!1;var n=this.topBorder-this.maxBounceHeight,i=this.bottomBorder+this.maxBounceHeight;return t>n?(this.moveContentToRealBorder(n,e),this.velocity.set(0,0),!0):t<i&&(this.moveContentToRealBorder(i,e),this.velocity.set(0,0),!0)}},{key:"isOutRange",value:function(){var e=this.content.position.y,t=this.topBorder-this.maxBounceHeight,n=this.bottomBorder+this.maxBounceHeight;return e>t||e<n}},{key:"getVelocityOverTime",value:function(e,t){var n=Math.sign(e),i=Math.abs(e);return i*=Math.exp(this.acceleration*t),this.compareWithSmallestNumber(i)?0:n*i}},{key:"moveContentToRealBorder",value:function(e,t){var n=this.content.position,i=n.x,a=n.y,r=n.z,o=a+(e-a)*this.scrollingSpeed*t;this.compareWithSmallestNumber(o-a)?this.content.setPosition(i,e,r):this.content.setPosition(i,o,r)}},{key:"compareWithSmallestNumber",value:function(e){return Math.abs(e)<.1}},{key:"scrollWithOffset",value:function(e){var t=this.content.position.y+e;this.scrollToTargetY(t)}},{key:"scrollToTargetY",value:function(e){var t=this.content.position,n=t.x,i=t.z,a=e,r=this.topBorder-this.maxBounceHeight,o=this.bottomBorder+this.maxBounceHeight;e>r&&!this.isFreeControl&&(a=r),e<o&&!this.isFreeControl&&(a=o),this.content.setPosition(n,a,i)}},{key:"clampToBottomBorder",value:function(e){var t=this.bottomBorder+this.maxBounceHeight;return Math.max(e,t)}},{key:"reduceContentHeight",value:function(e){this.contentUITransform.height-=e,this.topBorder-=e}},{key:"addContentHeight",value:function(e){this.contentUITransform.height+=e,this.topBorder+=e}}]),n}(E)).prototype,"acceleration",[su],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-5}}),gu=u(yu.prototype,"scrollingSpeed",[lu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 15}}),mu=u(yu.prototype,"mouseScrollingSpeed",[uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),bu=u(yu.prototype,"maxBounceHeight",[cu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 250}}),Su=u(yu.prototype,"outRangeDecayFactor",[hu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.34}}),wu=u(yu.prototype,"content",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ku=u(yu.prototype,"viewPort",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fu=yu))||fu);b._RF.pop(),b._RF.push({},"cbb040O6r1E+Ya9pFo++LKi","FakeItem",void 0);var Fu,zu=(0,w.ccclass)("FakeItem")(_u=function(){function e(){r(this,e),this.idx=-1,this.active=!0}return o(e,[{key:"getIdx",value:function(){return this.idx}},{key:"getActive",value:function(){return this.active}},{key:"getRealItem",value:function(){return this.realItem}},{key:"getPosition",value:function(){return this.position}},{key:"setIdx",value:function(e){this.idx=e}},{key:"setRealItem",value:function(e){this.realItem=e}},{key:"setPosition",value:function(e){this.position=e}},{key:"setActive",value:function(e){this.active=e}},{key:"copyFrom",value:function(e){this.active=e.getActive()}},{key:"toggleRealItem",value:function(e){this.realItem.node.active=e}
//! only work for vertical scroller
},{key:"isVisible",value:function(){var e=this.realItem.node.getPosition().y,t=this.position.y-e;return Math.abs(t)<.1}}]),e}())||_u;b._RF.pop(),b._RF.push({},"e5ccdo8rdROT7cRjZAjWhAs","RealItem",void 0);var Mu,Uu,Gu,Hu,Vu,Wu,qu,ju,Ku,Yu,Ju,Zu,Qu,Xu,$u,ec,tc,nc,ic,ac,rc,oc,sc,lc,uc,cc,hc,dc,pc,fc,yc,vc=(0,w.ccclass)("RealItem")(Fu=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n)}(E))||Fu;b._RF.pop(),b._RF.push({},"550b3tQjbFBA6q7NFyZoZG/","ReusableScroller",void 0);var gc=w.ccclass,mc=w.property,bc=(Mu=gc("ReusableScroller"),Uu=mc(R),Gu=mc(X),Hu=mc(P),Vu=mc(B),Wu=mc(B),qu=mc(C),ju=mc(C),Ku=mc(Z),Yu=mc(Z),Ju=mc(Z),Zu=mc(Z),Qu=mc(Z),Xu=mc(Z),$u=mc(B),Mu((nc=u((tc=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"viewUITransform",nc,h(e)),c(e,"itemPrefab",ic,h(e)),c(e,"content",ac,h(e)),c(e,"isVertical",rc,h(e)),c(e,"isStartFromBottom",oc,h(e)),c(e,"maxRealItems",sc,h(e)),c(e,"borderItems",lc,h(e)),c(e,"distanceBetweenItems",uc,h(e)),c(e,"itemHeight",cc,h(e)),c(e,"offsetHeader",hc,h(e)),c(e,"offsetBottom",dc,h(e)),c(e,"navigationTopBorder",pc,h(e)),c(e,"navigationBottomBorder",fc,h(e)),c(e,"isDebug",yc,h(e)),e.realItems=[],e.fakeItems=[],e.shouldUpdateItems=!0,e.originalContentPosY=0,e.payloads=[],e.originalOffsetHeader=0,e}return o(n,[{key:"setOffsetHeader",value:function(e){this.offsetHeader=e}},{key:"setOffsetBottom",value:function(e){this.offsetBottom=e}},{key:"addOffsetHeader",value:function(e){this.offsetHeader+=e}},{key:"addOffsetBottom",value:function(e){this.offsetBottom+=e}},{key:"getOffsetHeader",value:function(){return this.offsetHeader}},{key:"getOffsetBottom",value:function(){return this.offsetBottom}},{key:"getFakeItem",value:function(e){return this.fakeItems[e]}},{key:"__preload",value:function(){this.initData(),this.initComponents(),this.registerEvents()}},{key:"initData",value:function(){this.originalOffsetHeader=this.offsetHeader}},{key:"initComponents",value:function(){this.scroller=this.node.getComponent(Du),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"registerEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleScrollerWhenResize,this),this.scroller&&(this.scroller.node.on(Ou,this.handleDiscreteScroll,this),this.scroller.node.on(Nu,this.handleContinuousScroll,this))}},{key:"handleScrollerWhenResize",value:function(){var e=this.viewUITransform.contentSize.height,t=Math.ceil(e/(this.itemHeight+this.distanceBetweenItems)),n=this.maxRealItems-this.borderItems;if(!(t<=n)){this.maxRealItems=t+this.borderItems;for(var i=t-n+1,a=0;a<i;a++){var r=this.createRealItem();this.realItems.push(r);var o=this.distanceBetweenItems+this.itemHeight,s=new U(0,this.originalContentPosY+-1*(a*o+this.offsetBottom),0);r.node.setPosition(s),r.node.active=!1}for(var l=0;l<this.fakeItems.length;l++){var u=this.fakeItems[l],c=this.realItems[l%this.maxRealItems];u.setRealItem(c)}this.refreshScroller()}}},{key:"onLoad",value:function(){this.originalContentPosY=this.content.position.y}},{key:"reloadMaxRealItems",value:function(){var e=this.viewUITransform.contentSize.height,t=Math.ceil(e/(this.itemHeight+this.distanceBetweenItems));this.maxRealItems=t+this.borderItems}},{key:"createRealItems",value:function(){var e=this.isStartFromBottom?1:-1,t=e*this.itemHeight/2;if(this.maxRealItems-this.realItems.length<=0)for(var n=this.maxRealItems;n<this.realItems.length;n++){this.realItems[n].node.active=!1}for(var i=this.realItems.length;i<this.maxRealItems;i++){var a=this.createRealItem();this.realItems.push(a);var r=this.distanceBetweenItems+this.itemHeight,o=new U(0,t+(i*r+this.offsetBottom)*e,0);a.node.setPosition(o),a.node.active=!1}}},{key:"createDebugger",value:function(){this.graph=this.content.addComponent(W)}},{key:"createRealItem",value:function(){var e=$(this.itemPrefab);return this.content.addChild(e),e.getComponent(vc)}},{key:"loadScroller",value:function(e){this.payloads=e,this.reloadMaxRealItems(),this.createRealItems(),this.fakeItems=[];var t=this.content.position,n=t.x,i=t.z;this.content.setPosition(n,this.originalContentPosY,i),this.createFakeItems(e),this.isDebug&&this.createDebugger()}},{key:"reloadScroller",value:function(){var e=this.content.position.y,t=this.payloads;void 0!==this.payloads&&0!==this.payloads.length&&(this.loadScroller(t),this.scroller.scrollToTargetY(e),this.handleDiscreteScroll())}},{key:"createFakeItems",value:function(e){var t=this.isStartFromBottom?1:-1,n=t*this.itemHeight/2,i=e.length;this.toggleRealItems(i>0);for(var a=0;a<i;a++){var r=this.createFakeItem(e[a]),o=this.distanceBetweenItems+this.itemHeight,s=new U(0,n+(a*o+this.offsetBottom)*t,0);r.setPosition(s),r.setRealItem(this.realItems[a%this.maxRealItems]),this.fakeItems.push(r)}if(i<this.maxRealItems)for(var l=i;l<this.maxRealItems;l++)this.realItems[l].node.active=!1;var u=-1,c=i<this.maxRealItems-this.borderItems;u=c?this.offsetHeader:i*(this.itemHeight+this.distanceBetweenItems)+this.offsetHeader+this.offsetBottom,this.scroller.initScroller({isStartFromBottom:this.isStartFromBottom,isAddedHeight:c,height:u}),this.refreshScroller()}},{key:"createFakeItem",value:function(e){
//! temporary
var t=new zu;return t.setIdx(e.idx),t}},{key:"updateFakeItems",value:function(e){for(var t=0;t<e.length;t++){this.fakeItems[t].setIdx(e[t].idx)}}},{key:"toggleRealItems",value:function(e){for(var t=0;t<this.maxRealItems;t++)this.realItems[t].node.active=e}},{key:"handleDiscreteScroll",value:function(){if(this.shouldUpdateItems){var e=this.getVisibleFakeItems();this.updateScrollItems(e),this.drawDebugLines()}}},{key:"refreshScroller",value:function(){this.handleDiscreteScroll()}},{key:"drawDebugLines",value:function(){if(this.graph){this.graph.clear();var e=this.getVisibleTopBorder(),t=this.getVisibleBottomBorder();this.graph.strokeColor.fromHEX("#FF0000"),this.graph.moveTo(-1e3,e),this.graph.lineTo(1e3,e),this.graph.stroke(),this.graph.strokeColor.fromHEX("#00FF00"),this.graph.moveTo(-1e3,t),this.graph.lineTo(1e3,t),this.graph.stroke()}}},{key:"getVisibleFakeItems",value:function(){var e,t=[],n=this.getVisibleTopBorder(),i=this.getVisibleBottomBorder(),a=l(this.fakeItems);try{for(a.s();!(e=a.n()).done;){var r=e.value,o=r.getPosition().y;o>n||o<i||t.push(r)}}catch(e){a.e(e)}finally{a.f()}return t}},{key:"updateScrollItems",value:function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.updateRealItem(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateRealItem",value:function(e){var t=e.getPosition(),n=e.getRealItem();n.node.active=e.getActive(),n.node.setPosition(t)}},{key:"getVisibleTopBorder",value:function(){var e=this.content.position.y,t=this.viewUITransform.contentSize.height,n=this.itemHeight+this.distanceBetweenItems;return Math.ceil(t/n)*n-e-this.navigationTopBorder}},{key:"getVisibleBottomBorder",value:function(){var e=this.content.position.y,t=this.viewUITransform.contentSize.height,n=this.itemHeight+this.distanceBetweenItems;return-e-Math.ceil(t/n)*n+this.viewUITransform.node.position.y+this.navigationBottomBorder}},{key:"moveToIdx",value:function(e){if(!(e<0||e>=this.fakeItems.length)){var t=(this.getVisibleTopBorder()+this.getVisibleBottomBorder())/2-this.fakeItems[e].getPosition().y;this.scroller.scrollWithOffset(t)}}},{key:"swapItems",value:function(e,t){if(!(e<0||e>=this.fakeItems.length||t<0||t>=this.fakeItems.length)){var n=this.fakeItems[e];this.fakeItems[e]=this.fakeItems[t],this.fakeItems[t]=n}}},{key:"getItemFits",value:function(){var e=this.viewUITransform.contentSize.height,t=this.itemHeight+this.distanceBetweenItems;return Math.floor(e/t)}},{key:"handleContinuousScroll",value:function(){}},{key:"debugScroller",value:function(){var e,t=l(this.fakeItems);try{for(t.s();!(e=t.n()).done;){var n=e.value;console.log("%c fakeItem: ","font-size:12px;background-color: #4b4b4b;color:#fff;",n.getIdx())}}catch(e){t.e(e)}finally{t.f()}}}]),n}(E)).prototype,"viewUITransform",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic=u(tc.prototype,"itemPrefab",[Gu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac=u(tc.prototype,"content",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc=u(tc.prototype,"isVertical",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),oc=u(tc.prototype,"isStartFromBottom",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),sc=u(tc.prototype,"maxRealItems",[qu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),lc=u(tc.prototype,"borderItems",[ju],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),uc=u(tc.prototype,"distanceBetweenItems",[Ku],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),cc=u(tc.prototype,"itemHeight",[Yu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),hc=u(tc.prototype,"offsetHeader",[Ju],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),dc=u(tc.prototype,"offsetBottom",[Zu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),pc=u(tc.prototype,"navigationTopBorder",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),fc=u(tc.prototype,"navigationBottomBorder",[Xu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),yc=u(tc.prototype,"isDebug",[$u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ec=tc))||ec);b._RF.pop(),b._RF.push({},"fdfbePPntRMqLXMEGCBFqh3","Scroller",void 0);var Sc,wc="scrolling-continuous",kc="scrolling-discrete";b._RF.pop(),b._RF.push({},"68995CireVLDZrYtmMDEjvI","SmoothScroller",void 0);var Tc,Cc,Ec,Lc,Ic,xc,Rc,Ac,_c,Pc,Bc,Nc,Oc,Dc,Fc,zc,Mc=w.ccclass,Uc=1e-4,Gc=function(e){return e.SCROLL_ENDED="scroll-ended",e.SCROLLING="scrolling",e.SCROLL_ENG_WITH_THRESHOLD="scroll-ended-with-threshold",e}({});Mc("SmoothScroller")(Sc=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=l.call.apply(l,[this].concat(n))).headerBorder=0,e.bottomHeader=1139999,e.lastTouchPos=new Q,e.currentTouchPos=new Q,e.bounceTween=null,e.prevContentPosY=0,e.prevContentPosY2=0,e}return o(u,[{key:"__preload",value:function(){this.initComponents()}},{key:"initComponents",value:function(){this.content&&(this.contentUITransform=this.content.getComponent(R),this.validateRequiredComponents())}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.node.on(P.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"update",value:function(e){y(f(u.prototype),"update",this).call(this,e),this.updateContent()}},{key:"updateContent",value:function(){this.canDiscreteUpdate()&&this.node.emit(kc),this.canContinuousUpdate()&&this.node.emit(wc)}},{key:"_handleMoveLogic",value:function(e){this._getLocalAxisAlignDelta(this._deltaPos,e),this._deltaAmount.add(this._deltaPos),this.updateDeltaPos()}},{key:"updateDeltaPos",value:function(){var e=this.getScrollOffset(),t=_.getVisibleSize().height,n=.1*-t,i=this.contentUITransform.height-.9*t,a=this._deltaPos.y;if(e.y<n&&a<0){var r=this._deltaPos,o=r.x,s=r.z;this._deltaAmount.set(o,0,s)}if(e.y>i&&a>0){var l=Math.min(0,this._deltaPos.y+30),u=this._deltaPos,c=u.x,h=u.z;this._deltaAmount.set(c,l,h)}}},{key:"canDiscreteUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY)<=200)&&(this.prevContentPosY=e,!0)}},{key:"canContinuousUpdate",value:function(){if(!this.content)return!1;var e=this.content.position.y;return!(Math.abs(e-this.prevContentPosY2)<=10)&&(this.prevContentPosY2=e,!0)}},{key:"_onMouseWheel",value:function(e,t){var n=this;if(this.content){var i=-e.getScrollY(),a=this.getMaxScrollOffset(),r=this.getScrollOffset();r.y=ee.clamp(r.y+2*i,0,a.y);var o=this.content.position,s=o.x,l=o.y;if(l<=this.headerBorder&&r.y<=0){if(null!=this.bounceTween)return;this.bounceTween=z(this.content).to(.1,{position:new U(s,l-10)},{easing:"sineOut"}).call((function(){n.resetBounceTween()})).start()}else if(l>=this.bottomHeader&&r.y>=a.y){if(null!=this.bounceTween)return;this.bounceTween=z(this.content).to(.1,{position:new U(s,l+10)},{easing:"sineOut"}).call((function(){n.resetBounceTween()})).start()}this.scrollToOffset(r,3.6)}}},{key:"resetBounceTween",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.waitTweenAsync(.3);case 2:this.bounceTween=null;case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"onTouchMove",value:function(e){this.content&&(this.currentTouchPos.set(e.getLocationX(),e.getLocationY()),this.lastTouchPos.set(e.getLocationX(),e.getLocationY()))}},{key:"_processAutoScrolling",value:function(e){var t=this._isNecessaryAutoScrollBrake(),n=t?.05:1;this._autoScrollAccumulatedTime+=e*(1/n);var i,a=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(i=a,a=1-Math.pow(2,-30*i));var r=this._autoScrollTargetDelta.clone();r.multiplyScalar(a);var o=this._autoScrollStartPosition.clone();o.add(r);var s=Math.abs(a-1)<=Uc;if(Math.abs(a-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent(Gc.SCROLL_ENG_WITH_THRESHOLD),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var l=o.clone();l.subtract(this._autoScrollBrakingStartPosition),t&&l.multiplyScalar(n),o.set(this._autoScrollBrakingStartPosition),o.add(l)}else{var u=o.clone();u.subtract(this.getContentPosition());var c=this._getHowMuchOutOfBoundary(u);c.equals(U.ZERO,Uc)||(o.add(c),s=!0)}s&&(this._autoScrolling=!1);var h=o.clone();h.subtract(this.getContentPosition()),this._clampDelta(h),this._moveContent(h,s),this._dispatchEvent(Gc.SCROLLING),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent(Gc.SCROLL_ENDED))}}]),u}(te));b._RF.pop(),b._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var Hc,Vc,Wc,qc,jc,Kc,Yc,Jc,Zc,Qc,Xc,$c=w.ccclass,eh=w.property,th=w.requireComponent,nh=codex.analytics,ih=(Tc=$c("SwitchButton"),Cc=th([D]),Ec=eh(B),Lc=eh(P),Ic=eh(P),xc=eh(B),Rc=eh(D),Ac=eh({visible:function(){return this.useSound},type:Me}),Tc(_c=Cc((Bc=u((Pc=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"enable",Bc,h(e)),c(e,"nodeOn",Nc,h(e)),c(e,"nodeOff",Oc,h(e)),c(e,"useSound",Dc,h(e)),c(e,"button",Fc,h(e)),c(e,"soundKey",zc,h(e)),e}return o(n,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"switch",value:function(){if(!this.node.active)return!1;if(nh.event(Ludex.Plugins.Analytics.Events.BUTTON_CLICK,{enable:!this.enable,button_name:this.node.name,screen_name:je.getCurrentPage()}),this.useSound&&this.soundKey){var e=Ue[this.soundKey];e&&Ge.playSound(e)}return this.updateStatus(!this.enable)}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e,e}}]),n}(E)).prototype,"enable",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Nc=u(Pc.prototype,"nodeOn",[Lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oc=u(Pc.prototype,"nodeOff",[Ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dc=u(Pc.prototype,"useSound",[xc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Fc=u(Pc.prototype,"button",[Rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zc=u(Pc.prototype,"soundKey",[Ac],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Me[He.BUTTON_CLICK]}}),_c=Pc))||_c)||_c);b._RF.pop(),b._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var ah,rh,oh,sh,lh,uh,ch,hh,dh,ph,fh,yh,vh,gh,mh,bh,Sh,wh,kh,Th,Ch,Eh,Lh,Ih,xh,Rh,Ah,_h,Ph,Bh,Nh,Oh,Dh,Fh,zh,Mh,Uh,Gh,Hh,Vh,Wh,qh,jh,Kh=w.ccclass,Yh=w.property,Jh=w.executeInEditMode,Zh=w.requireComponent;Hc=Kh("TapperedProgressBar"),Vc=Zh(N),Wc=Yh({type:N,displayName:"Fill opacity"}),qc=Yh({type:x,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),jc=Yh({type:x,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),Kc=Yh({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),Hc(Yc=Jh(Yc=Vc((Zc=u((Jc=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"uiOpacity",Zc,h(e)),c(e,"leftCap",Qc,h(e)),c(e,"rightCap",Xc,h(e)),e}return o(n,[{key:"progress",get:function(){return y(f(n.prototype),"progress",this)},set:function(e){p(f(n.prototype),"progress",e,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity)if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var e=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=e}}},{key:"start",value:function(){this.updateAppearance()}}]),n}(Y)).prototype,"uiOpacity",[Wc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qc=u(Jc.prototype,"leftCap",[qc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xc=u(Jc.prototype,"rightCap",[jc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u(Jc.prototype,"progress",[Kc],Object.getOwnPropertyDescriptor(Jc.prototype,"progress"),Jc.prototype),Yc=Jc))||Yc)||Yc);b._RF.pop(),b._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var Qh=w.ccclass,Xh=w.property,$h=w.executeInEditMode,ed=w.disallowMultiple,td=Ludex,nd=td.Utils,id=nd.Signal,ad=(nd.Function,nd.Array),rd=td.Events,od=codex,sd=od.language,ld=od.event,ud=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});ne(ud);var cd,hd,dd,pd,fd,yd,vd,gd,md,bd,Sd,wd,kd,Td,Cd,Ed,Ld,Id,xd,Rd,Ad,_d="localize-params-updated",Pd=(ah=Qh("LocalizeParams"),rh=Xh({visible:!1}),oh=Xh(T),ah((uh=u((lh=function(){function e(){r(this,e),c(this,"_text",uh,this)}return o(e,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,A.emit(_d,{text:e,param:this})}}]),e}()).prototype,"_text",[rh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),u(lh.prototype,"text",[oh],Object.getOwnPropertyDescriptor(lh.prototype,"text"),lh.prototype),sh=lh))||sh),Bd=(ch=Qh("Localize"),hh=$h(!0),dh=Xh({visible:!1}),ph=Xh({type:T,visible:function(){return this.l10nType===ud.Texture}}),fh=Xh({visible:!1}),yh=Xh({type:J(ud)}),vh=Xh({type:q,visible:function(){return this.l10nType===ud.Text}}),gh=Xh({visible:function(){return this.l10nType===ud.Text}}),mh=Xh({type:[Pd],visible:function(){return this.l10nType===ud.Text}}),bh=Xh({type:x,visible:function(){return this.l10nType===ud.Texture}}),Sh=Xh({visible:function(){return this.l10nType===ud.Texture}}),wh=Xh({visible:!1}),kh=Xh({type:T}),Th=Xh({visible:!1}),Ch=Xh({type:J({FNT:"fnt",TTF:"ttf"}),visible:function(){return this.l10nType===ud.Text}}),Eh=on.onlyRunInLifeCycleAsync,Lh=on.onlyRunInLifeCycleAsync,Ih=on.onlyRunInLifeCycleAsync,xh=on.onlyRunInLifeCycleAsync,Rh=on.onlyRunInLifeCycle,Ah=on.onlyRunInLifeCycleAsync,_h=on.onlyRunInLifeCycleAsync,Ph=on.onlyRunInLifeCycleAsync,Bh=on.onlyRunInLifeCycleAsync,Nh=on.onlyRunInLifeCycle,Oh=on.onlyRunInLifeCycleAsync,ch(Dh=ed(Dh=hh((zh=u((Fh=function(e){i(k,e);var s,l,u,d,p,f,y,v,g,m,b,S,w=a(k);function k(){var e;r(this,k);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=w.call.apply(w,[this].concat(n))).localized=!1,c(e,"_defaultLocale",zh,h(e)),c(e,"_l10nType",Mh,h(e)),c(e,"label",Uh,h(e)),c(e,"updateFont",Gh,h(e)),c(e,"params",Hh,h(e)),c(e,"sprite",Vh,h(e)),c(e,"packable",Wh,h(e)),c(e,"_key",qh,h(e)),c(e,"_fontType",jh,h(e)),e.updateSignalController=new id.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;ad.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return o(k,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return ad.has(Je,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(Je.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===ud.Texture&&(this.label=void 0,this.params=[]),e===ud.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"fontType",get:function(){return this._fontType},set:function(e){"fnt"===e||"ttf"===e?(this._fontType=e,this.updateLocalization()):console.warn("Font type ".concat(e," is not supported. Supported types are 'fnt' and 'ttf'."))}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new Pd);for(var t=0,n=this.params.length;t<n;t++){var i,a=this.params[t];a.text=null!==(i=e[t])&&void 0!==i?i:a.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once(Oe.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===ud.Text&&sd.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===ud.Texture&&sd.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent(),this.updateLocalizationComp(!0)}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){ld.on(rd.LANGUAGE_CHANGED,this.updateLocalization),A.on(_d,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){ld.off(rd.LANGUAGE_CHANGED,this.updateLocalization),A.off(_d,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(S=t(n().mark((function e(){var t,i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.length>0&&void 0!==r[0]&&r[0],e.next=4;break;case 4:if(this.enabledInHierarchy){e.next=6;break}return e.abrupt("return");case 6:if(void 0!==this.key){e.next=8;break}return e.abrupt("return");case 8:if(i=this.updateSignalController.renew(),e.prev=9,this.localized=!1,!this.isTextKey(this.key)){e.next=16;break}return e.next=14,this.updateTextLocalization(this.key,i);case 14:e.next=25;break;case 16:if(!this.isTextureKey(this.key)){e.next=24;break}if(a=sd.getCurrentLocale(),t&&a===this.defaultLocale){e.next=22;break}return e.next=22,this.updateTextureLocalization(this.key,a,i);case 22:e.next=25;break;case 24:throw new Error("Key ".concat(this.key," not found in locales"));case 25:if(!i.aborted){e.next=27;break}return e.abrupt("return");case 27:this.localized=!0,A.emit(Oe.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit(Oe.LOCALIZE_APPLIED,{localize:this,key:this.key}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(9),console.warn(e.t0);case 35:case"end":return e.stop()}}),e,this,[[9,32]])}))),function(){return S.apply(this,arguments)})},{key:"updateTextLocalization",value:(b=t(n().mark((function e(t,i){var a,r,o,s,l,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=sd.getCurrentLocale(),o=sd.getText(t,this.params.map((function(e){return e.text})),r),void 0!==(s=this.label)){e.next=5;break}throw new Error("Text localize component <".concat(this.node.name,"> has no label"));case 5:if(null===(a=i.wrap((function(){return u.setText(s,o)})))||void 0===a||a(),!this.updateFont){e.next=9;break}return e.next=9,null===(l=i.wrap((function(){return u.setTextFont(s,r,i)})))||void 0===l?void 0:l();case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"setText",value:(m=t(n().mark((function e(t,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.string=i;case 1:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"setTextFont",value:(g=t(n().mark((function e(t,i,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.setTextFontRuntime(t,i,a);case 3:e.next=7;break;case 5:return e.next=7,this.setTextFontEditor(t,i,a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"setTextFontRuntime",value:(v=t(n().mark((function e(t,i,a){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne.loadFontAsync(i,this.fontType);case 2:if(r=e.sent,!a.aborted){e.next=5;break}return e.abrupt("return");case 5:null!==r&&this.setLabelFontInLifeCycle(t,r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(y=t(n().mark((function e(t,i,a){var r,o,s,l,u,c,h=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestFontUuid(i);case 2:if(null!==(s=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,null===(r=a.wrap((function(){return h.requestNodeInfo(t.node.uuid)})))||void 0===r?void 0:r();case 7:if(void 0!==(l=e.sent)){e.next=10;break}return e.abrupt("return");case 10:return u=ad.searchIndex(l.__comps__,(function(e){return"cc.Label"===e.type})),c="__comps__.".concat(u,".font"),e.next=14,null===(o=a.wrap((function(){return h.requestUpdateLabelFont(t.node.uuid,c,s)})))||void 0===o?void 0:o();case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"requestFontUuid",value:(f=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.fontType,e.next="fnt"===e.t0?3:"ttf"===e.t0?6:9;break;case 3:return e.next=5,Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Xe[t]));case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Qe[t]));case 8:return e.abrupt("return",e.sent);case 9:throw new Error("Unsupported font type: ".concat(this.fontType));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(p=t(n().mark((function e(t,i,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:i,dump:{type:"cc.Font",value:{uuid:a}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"updateTextureLocalization",value:(d=t(n().mark((function e(t,i,a){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sprite){e.next=2;break}throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));case 2:return r="".concat($e.LOCALIZE_PREFIX).concat(i,"/").concat(sd.getTexture(t)),e.next=6,this.setSpriteRuntime(this.sprite,r,a);case 6:e.next=10;break;case 8:return e.next=10,this.setSpriteEditor(this.sprite,r,a);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"setSpriteRuntime",value:(u=t(n().mark((function e(t,i,a){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne.loadSpriteFrameAsync("".concat(i,"/spriteFrame"),this.packable);case 2:if(r=e.sent,!a.aborted){e.next=5;break}return e.abrupt("return");case 5:if(null!==r){e.next=8;break}return console.warn("Sprite not found by path: ".concat(i)),e.abrupt("return");case 8:this.setSprite(t,r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(l=t(n().mark((function e(t,i,a){var r,o,s,l,u,c,h,d,p,f=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestSpriteFrameInfo(i);case 2:if(0!==(s=e.sent).length){e.next=6;break}return console.error("Sprite not found by path: ".concat(i)),e.abrupt("return");case 6:if(!(s.length>1)){e.next=11;break}return l=s.slice(0,5).map((function(e){return e.path})),u="".concat(l.join(",")).concat(l.length<s.length?"...":""),console.warn("Ambiguous sprite's path: ".concat(i,". Found ").concat(u)),e.abrupt("return");case 11:return e.next=13,null===(r=a.wrap((function(){return f.requestNodeInfo(t.node.uuid)})))||void 0===r?void 0:r();case 13:if(void 0!==(c=e.sent)){e.next=16;break}return e.abrupt("return");case 16:return h=s[0].uuid,d=ad.searchIndex(c.__comps__,(function(e){return"cc.Sprite"===e.type})),p="__comps__.".concat(d,".spriteFrame"),e.next=21,null===(o=a.wrap((function(){return f.requestUpdateSpriteSpriteFrame(t.node.uuid,p,h)})))||void 0===o?void 0:o();case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(s=t(n().mark((function e(t,i,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:i,dump:{type:"cc.SpriteFrame",value:{uuid:a}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return s.apply(this,arguments)})}]),k}(E)).prototype,"_defaultLocale",[dh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),u(Fh.prototype,"defaultLocale",[ph],Object.getOwnPropertyDescriptor(Fh.prototype,"defaultLocale"),Fh.prototype),Mh=u(Fh.prototype,"_l10nType",[fh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ud.Text}}),u(Fh.prototype,"l10nType",[yh],Object.getOwnPropertyDescriptor(Fh.prototype,"l10nType"),Fh.prototype),Uh=u(Fh.prototype,"label",[vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gh=u(Fh.prototype,"updateFont",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Hh=u(Fh.prototype,"params",[mh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vh=u(Fh.prototype,"sprite",[bh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wh=u(Fh.prototype,"packable",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qh=u(Fh.prototype,"_key",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(Fh.prototype,"key",[kh],Object.getOwnPropertyDescriptor(Fh.prototype,"key"),Fh.prototype),jh=u(Fh.prototype,"_fontType",[Th],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ttf"}}),u(Fh.prototype,"fontType",[Ch],Object.getOwnPropertyDescriptor(Fh.prototype,"fontType"),Fh.prototype),u(Fh.prototype,"updateTextLocalization",[Eh],Object.getOwnPropertyDescriptor(Fh.prototype,"updateTextLocalization"),Fh.prototype),u(Fh.prototype,"setText",[Lh],Object.getOwnPropertyDescriptor(Fh.prototype,"setText"),Fh.prototype),u(Fh.prototype,"setTextFont",[Ih],Object.getOwnPropertyDescriptor(Fh.prototype,"setTextFont"),Fh.prototype),u(Fh.prototype,"setTextFontRuntime",[xh],Object.getOwnPropertyDescriptor(Fh.prototype,"setTextFontRuntime"),Fh.prototype),u(Fh.prototype,"setLabelFontInLifeCycle",[Rh],Object.getOwnPropertyDescriptor(Fh.prototype,"setLabelFontInLifeCycle"),Fh.prototype),u(Fh.prototype,"setTextFontEditor",[Ah],Object.getOwnPropertyDescriptor(Fh.prototype,"setTextFontEditor"),Fh.prototype),u(Fh.prototype,"requestUpdateLabelFont",[_h],Object.getOwnPropertyDescriptor(Fh.prototype,"requestUpdateLabelFont"),Fh.prototype),u(Fh.prototype,"updateTextureLocalization",[Ph],Object.getOwnPropertyDescriptor(Fh.prototype,"updateTextureLocalization"),Fh.prototype),u(Fh.prototype,"setSpriteRuntime",[Bh],Object.getOwnPropertyDescriptor(Fh.prototype,"setSpriteRuntime"),Fh.prototype),u(Fh.prototype,"setSprite",[Nh],Object.getOwnPropertyDescriptor(Fh.prototype,"setSprite"),Fh.prototype),u(Fh.prototype,"setSpriteEditor",[Oh],Object.getOwnPropertyDescriptor(Fh.prototype,"setSpriteEditor"),Fh.prototype),Dh=Fh))||Dh)||Dh)||Dh);b._RF.pop(),b._RF.push({},"b3fd8kSJpZMS47Z+G6ZUMJb","LocalizePreloader",void 0);var Nd,Od,Dd,Fd,zd,Md,Ud,Gd,Hd,Vd,Wd,qd,jd,Kd,Yd,Jd,Zd=w.ccclass,Qd=w.property,Xd=Ludex,$d=Xd.Utils,ep=$d.Array,tp=$d.Valid,np=Xd.Events,ip=codex,ap=ip.event,rp=ip.language,op=(cd=Zd("LocalizeTextureKey"),hd=Qd({visible:!1}),dd=Qd(T),cd((yd=u((fd=function(){function e(){r(this,e),c(this,"_key",yd,this)}return o(e,[{key:"key",get:function(){return this._key},set:function(e){rp.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),e}()).prototype,"_key",[hd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),u(fd.prototype,"key",[dd],Object.getOwnPropertyDescriptor(fd.prototype,"key"),fd.prototype),pd=fd))||pd),sp=(vd=Zd("SupportedLocaleKey"),gd=Qd({visible:!1}),md=Qd(T),vd((wd=u((Sd=function(){function e(){r(this,e),c(this,"_key",wd,this)}return o(e,[{key:"key",get:function(){return this._key},set:function(e){ep.has(Je,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(Je.join(", ")))}}]),e}()).prototype,"_key",[gd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),u(Sd.prototype,"key",[md],Object.getOwnPropertyDescriptor(Sd.prototype,"key"),Sd.prototype),bd=Sd))||bd);kd=Zd("LocalizePreloader"),Td=Qd([op]),Cd=Qd({type:sp,tooltip:"Preload only for these locales"}),kd((Id=u((Ld=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"keys",Id,h(e)),c(e,"locales",xd,h(e)),c(e,"preloadOnLanguageChange",Rd,h(e)),c(e,"packable",Ad,h(e)),e.lastLocale="",e.preloadLocalize=function(){return e.preloadTextures()},e}return o(n,[{key:"__preload",value:function(){this.lastLocale=rp.getCurrentLocale(),this.preloadTextures()}},{key:"onEnable",value:function(){if(this.preloadOnLanguageChange){this.listenEvents();var e=rp.getCurrentLocale();e!==this.lastLocale&&(this.lastLocale=e,this.preloadTextures())}}},{key:"onDisable",value:function(){this.preloadOnLanguageChange&&this.unlistenEvents()}},{key:"listenEvents",value:function(){ap.on(np.LANGUAGE_CHANGED,this.preloadLocalize)}},{key:"unlistenEvents",value:function(){ap.off(np.LANGUAGE_CHANGED,this.preloadLocalize)}},{key:"preloadTextures",value:function(){var e=rp.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(ep.has(t,e)){var n,i=[],a=l(this.keys);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(!1!==rp.hasTextureKey(r.key)){var o=rp.getTexture(r.key),s="".concat($e.LOCALIZE_PREFIX).concat(e,"/").concat(o,"/spriteFrame");i.push(s)}}}catch(e){a.e(e)}finally{a.f()}Ne.loadSpriteFramesAsync(i,this.packable)}else tp.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),n}(E)).prototype,"keys",[Td],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xd=u(Ld.prototype,"locales",[Cd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Rd=u(Ld.prototype,"preloadOnLanguageChange",[Qd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ad=u(Ld.prototype,"packable",[Qd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ed=Ld));b._RF.pop(),b._RF.push({},"173031IssdPd61TGAHBxghZ","LocalizedLayout",void 0);var lp,up,cp,hp,dp,pp,fp,yp,vp,gp,mp,bp,Sp,wp,kp,Tp,Cp,Ep,Lp,Ip,xp,Rp,Ap,_p,Pp,Bp,Np,Op,Dp=w.ccclass,Fp=w.property,zp=w.executeInEditMode,Mp=w.disallowMultiple,Up=w.requireComponent;Nd=Dp("LocalizedLayout"),Od=zp(!0),Dd=Up(R),Fd=Fp(Bd),zd=on.required(),Md=Fp(R),Ud=Fp({visible:!1}),Gd=Fp({visible:!1}),Hd=Fp({type:Z,group:"Padding"}),Vd=Fp({type:Z,group:"Padding"}),Nd(Wd=Mp(Wd=Od(Wd=Dd((jd=u((qd=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"label",jd,h(e)),c(e,"layout",Kd,h(e)),c(e,"_horizontal",Yd,h(e)),c(e,"_vertical",Jd,h(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(R))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,a=e.node.getComponentsInChildren(H),r=l(a);try{for(r.s();!(i=r.n()).done;){i.value.updateAlignment()}}catch(e){r.e(e)}finally{r.f()}}}},e}return o(n,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(R),on.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on(Oe.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off(Oe.LOCALIZE_APPLIED,this.updateContentSize)}}]),n}(E)).prototype,"label",[Fd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kd=u(qd.prototype,"layout",[zd,Md],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yd=u(qd.prototype,"_horizontal",[Ud],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Jd=u(qd.prototype,"_vertical",[Gd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),u(qd.prototype,"horizontal",[Hd],Object.getOwnPropertyDescriptor(qd.prototype,"horizontal"),qd.prototype),u(qd.prototype,"vertical",[Vd],Object.getOwnPropertyDescriptor(qd.prototype,"vertical"),qd.prototype),Wd=qd))||Wd)||Wd)||Wd);b._RF.pop(),b._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var Gp,Hp,Vp,Wp,qp,jp,Kp,Yp,Jp,Zp,Qp,Xp,$p,ef,tf,nf,af,rf,of,sf,lf=w.ccclass,uf=w.executionOrder,cf=w.property,hf=Ludex.Utils,df=hf.Decorator,pf=hf.Array,ff="Batch By Name",yf="Batch Label",vf="Batch Sprite";lp=lf("BatchNodes"),up=uf(99999),cp=cf({group:{name:ff}}),hp=cf({type:[C],group:{name:ff}}),dp=cf({type:[T],group:{name:ff}}),pp=cf({group:{name:yf}}),fp=cf({group:{name:yf}}),yp=cf({group:{name:yf}}),vp=cf({group:{name:vf}}),gp=cf({group:{name:vf}}),mp=cf({readonly:!0}),bp=cf({readonly:!0}),Sp=cf({readonly:!0}),wp=df.debounce(1e3),lp(kp=up((Cp=u((Tp=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"batchByName",Cp,h(e)),c(e,"depthNames",Ep,h(e)),c(e,"listName",Lp,h(e)),c(e,"batchLabel",Ip,h(e)),c(e,"depthLabel",xp,h(e)),c(e,"typeLabel",Rp,h(e)),c(e,"batchSprite",Ap,h(e)),c(e,"depthSprite",_p,h(e)),c(e,"batchAllNodes",Pp,h(e)),c(e,"batchDepth",Bp,h(e)),c(e,"checkOverlap",Np,h(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,c(e,"handleNodeChange",Op,h(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return o(n,[{key:"__preload",value:function(){this.enabled&&(I.on(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.on(j.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){I.off(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.off(j.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(I.on(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.on(j.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(P.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),I.off(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.off(j.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,a=i.depthNames[t];void 0!==a?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(a):console.warn("BatchNodes: depth is undefined",e,t,a)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new P("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=l(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var a=new P(i);a.active=!0,this.batchNode[i]=a,e.addChild(a)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new P("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new P("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(v(this.labelChildren),v(this.spriteChildren)),n=this.nameChildren,i=l(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.parent&&(this.handleActiveChange(a.node),this.originalParents[a.uuid]=a.node.parent)}}catch(e){i.e(e)}finally{i.f()}var r,o=l(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.parent&&(this.handleActiveChange(s),this.originalParents[s.uuid]=s.parent)}}catch(e){o.e(e)}finally{o.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=l(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.saveLabelChildren(a),this.saveSpriteChildren(a),this.saveNodeChildrenByName(a),this.saveNodeChildrenByType(a)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(q),i={none:q.CacheMode.NONE,char:q.CacheMode.CHAR,bitmap:q.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,v(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(x);0!==n.length&&(t=this.spriteChildren).push.apply(t,v(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=l(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;pf.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(E);if((t=this.allChildren).push.apply(t,v(i)),!(this.batchDepth<1||n>=this.batchDepth)){var a,r=l(this.allChildren);try{for(r.s();!(a=r.n()).done;){var o=a.value;this.saveNodeChildrenByType(o.node,this.batchDepth)}}catch(e){r.e(e)}finally{r.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=ie.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=l(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var a,r=l(this.spriteChildren);try{for(r.s();!(a=r.n()).done;){t(a.value,this.batchNode.sprite)}}catch(e){r.e(e)}finally{r.f()}var o,s=l(this.allChildren);try{for(s.s();!(o=s.n()).done;){t(o.value,this.batchNode.node)}}catch(e){s.e(e)}finally{s.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var u,c=l(this.nameChildren);try{for(c.s();!(u=c.n()).done;){var h=u.value;if(h.isValid&&h.activeInHierarchy&&h.isTransformDirty()){var d=h.getComponent(N);if(!(d&&d.opacity<1||pf.has(n,h.name))){var p=this.batchNode[h.name];p&&(h.isChildOf(p)||(h.setParent(p,!0),h.layer=ie.Enum.UI_2D))}}}}catch(e){c.e(e)}finally{c.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(v(this.labelChildren),v(this.spriteChildren));if(e.length>0){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.originalParents[i.uuid];a&&(i.node.isChildOf(a)||i.node.setParent(a,!0))}}catch(e){n.e(e)}finally{n.f()}}var r,o=l(this.nameChildren);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=this.originalParents[s.uuid];u&&(s.isChildOf(u)||s.setParent(u,!0))}}catch(e){o.e(e)}finally{o.f()}}}]),n}(E)).prototype,"batchByName",[cp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ep=u(Tp.prototype,"depthNames",[hp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Lp=u(Tp.prototype,"listName",[dp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ip=u(Tp.prototype,"batchLabel",[pp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xp=u(Tp.prototype,"depthLabel",[fp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Rp=u(Tp.prototype,"typeLabel",[yp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Ap=u(Tp.prototype,"batchSprite",[vp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_p=u(Tp.prototype,"depthSprite",[gp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Pp=u(Tp.prototype,"batchAllNodes",[mp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bp=u(Tp.prototype,"batchDepth",[bp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Np=u(Tp.prototype,"checkOverlap",[Sp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Op=u(Tp.prototype,"handleNodeChange",[wp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),kp=Tp))||kp);b._RF.pop(),b._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var gf,mf=w.ccclass,bf=w.executionOrder,Sf=w.property,wf=Ludex.Utils,kf=wf.Array,Tf=wf.Object;Gp=mf("BatchNodesV2"),Hp=bf(99999),Vp=Sf({group:"Batch Settings"}),Wp=Sf({type:[T],group:"Batch Settings",visible:function(){return this.batchByName}}),qp=Sf({type:[C],group:"Batch Settings",visible:function(){return this.batchByName}}),jp=Sf({group:"Label Settings"}),Kp=Sf({group:"Label Settings",visible:function(){return this.batchLabel}}),Yp=Sf({group:"Label Settings",visible:function(){return this.batchLabel}}),Jp=Sf({group:"Sprite Settings"}),Zp=Sf({group:"Sprite Settings",visible:function(){return this.batchSprite}}),Gp(Qp=Hp(($p=u((Xp=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"batchByName",$p,h(e)),c(e,"listName",ef,h(e)),c(e,"depthNames",tf,h(e)),c(e,"batchLabel",nf,h(e)),c(e,"typeLabel",af,h(e)),c(e,"depthLabel",rf,h(e)),c(e,"batchSprite",of,h(e)),c(e,"depthSprite",sf,h(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return o(n,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(q);t&&("all"===this.typeLabel?t.cacheMode===q.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===q.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(x)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:q.CacheMode.NONE,char:q.CacheMode.CHAR,bitmap:q.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,a={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(a)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var r=0;r<this.listName.length;r++){var o=this.listName[r];if(o){var s=this.depthNames[r]||0,l=this.batchNodes[o];l&&l.setSiblingIndex(s)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=ie.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=Tf.vals(this.batchNodes);return kf.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],a=0;a<i.length;a++){var r=i[a];r&&t(r)}else for(var o=0;o<this.labelNodes.length;o++){var s=this.labelNodes[o];s&&t(s)}if(this.batchSprite)for(var l=0;l<this.spriteNodes.length;l++){var u=this.spriteNodes[l];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var h=this.namedNodes[c];if(h)for(var d=0;d<h.length;d++){var p=h[d];p&&t(p)}}}},{key:"setupEventListeners",value:function(){I.on(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.on(j.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){I.off(j.EVENT_AFTER_UPDATE,this.onAfterUpdate),I.off(j.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new P("BatchLabel_".concat(n));i.layer=ie.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var a=new P("BatchLabel");a.layer=ie.Enum.UI_2D,this.node.addChild(a),this.batchNodes.label=a}if(this.batchSprite){var r=new P("BatchSprite");r.layer=ie.Enum.UI_2D,this.node.addChild(r),this.batchNodes.sprite=r}if(this.batchByName)for(var o=0;o<this.listName.length;o++){var s=this.listName[o];if(s){var l=new P("Batch_".concat(s));l.layer=ie.Enum.UI_2D,this.node.addChild(l),this.batchNodes[s]=l,this.namedNodes[s]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),n}(E)).prototype,"batchByName",[Vp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ef=u(Xp.prototype,"listName",[Wp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tf=u(Xp.prototype,"depthNames",[qp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nf=u(Xp.prototype,"batchLabel",[jp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),af=u(Xp.prototype,"typeLabel",[Kp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),rf=u(Xp.prototype,"depthLabel",[Yp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),of=u(Xp.prototype,"batchSprite",[Jp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sf=u(Xp.prototype,"depthSprite",[Zp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Qp=Xp))||Qp);b._RF.pop(),b._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var Cf=w.ccclass,Ef=Ludex.Utils,Lf=codex.player;Cf("Vibrate")(gf=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!Ef.Browser.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!Lf.getPlayerSetting("vibrate")}}]),n}(E));b._RF.pop(),b._RF.push({},"2521azdoHNFz7dpyh+MzNfr","WideframeConfigs",void 0),b._RF.pop(),b._RF.push({},"864477XgItAYpfGFIFfuHXg","FacebookConfigCustom",void 0),b._RF.pop(),b._RF.push({},"cadc9dNvDZNYJa5Col5DL0Q","MSGamesConfigCustom",void 0),b._RF.pop(),b._RF.push({},"2f96bZk1+RBL67UfNH3X1fy","BadgeOffset",void 0);var If={DailyBadgeOffset:{1:{x:-9.5,y:42.5},2:{x:-3,y:39.5},3:{x:5,y:43},4:{x:-2,y:46},5:{x:-2,y:40.5},6:{x:3,y:44},7:{x:-1.5,y:43},8:{x:.5,y:47},9:{x:0,y:53.5},10:{x:-2.5,y:40.5},11:{x:-2.5,y:48},12:{x:-10.5,y:53}},JourneyBadgeOffset:{}};b._RF.pop(),b._RF.push({},"6e50aRjxGVCAbRnH5TLU35R","DailyQuest",void 0);var xf=function(e){var t=e.split("-");if(0!==t.length){if("CompleteLevel"===t[0]&&3===t.length){var n=g(t,3),i=(n[0],n[1]),a=n[2];return m(m({},function(e){return{description:"winXLevels",type:{name:"CompleteLevel"},target:e}}(parseInt(i))),{},{current:parseInt(a)})}if("UseItem"===t[0]&&3===t.length){var r=g(t,3),o=(r[0],r[1]),s=r[2];return m(m({},function(e){return{description:"useXItems",type:{name:"UseItem",items:[et[tt.HINT],et[tt.SHUFFLE]]},target:e}}(parseInt(o))),{},{current:parseInt(s)})}if("ReachCombo"===t[0]&&3===t.length){var l=g(t,3),u=(l[0],l[1]),c=l[2];return m(m({},function(e){return{description:"reachComboX",type:{name:"ReachCombo",minCombo:e},target:1}}(parseInt(u))),{},{current:parseInt(c)})}}},Rf=function(e){switch(e.type.name){case"CompleteLevel":return"CompleteLevel-".concat(e.target,"-").concat(e.current||0);case"UseItem":return"UseItem-".concat(e.target,"-").concat(e.current||0);case"ReachCombo":return"ReachCombo-".concat(e.type.minCombo,"-").concat(e.current||0);default:return}};b._RF.pop(),b._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Af=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(Af||{}),_f={Events:Af,UNLOCK_SEQUENCE:"1010101010"};b._RF.pop(),b._RF.push({},"f2134AVhktCQLHh8jp96V/y","VibrateStyle",void 0);var Pf,Bf="normal";b._RF.pop(),b._RF.push({},"cedfajYJypBX4mKSbPz5pXd","TournamentUtils",void 0);var Nf=Ludex,Of=Nf.Events,Df=(Nf.Utils,Nf.Match),Ff=Nf.Configs.Mockup.Leaderboards;function zf(){var e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e||"[::1]"===e||/^192\.168\.\d+\.\d+$/.test(e)||/^10\.\d+\.\d+\.\d+$/.test(e)}var Mf=[1,2,3,4,5],Uf=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),Gf=10,Hf=codex,Vf=Hf.player,Wf=Hf.event,qf=Hf.leaderboard,jf=function(){function e(){r(this,e),this.playerRank=0,this.leaderboardEntries=[],this.cachedLeaderAvatar=new Map,this.viewedRank=-1,this.addedRealPlayers={}}var i,a,s,l,u,c,h,d,p,f;return o(e,[{key:"fetchTournamentData",value:(f=t(n().mark((function t(){var i,a,r,o,s,l,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.tournamentData,a=i.tournamentId,r=i.leaderboardId,t.next=3,qf.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"});case 3:if(o=t.sent.filter((function(e){return e._id===r&&JSON.parse(e.description).tournamentID===a})),console.log("globalTournament",o),!(o.length>0)){t.next=19;break}return qf.addLeaderboard({type:"tournament",name:r,autoSortRank:!0,leaderboardId:r}),t.next=9,e.getLeaderboardAsync(r,Gf);case 9:return t.next=11,e.getTournamentPlayerInfo();case 11:u=t.sent,this.playerRank=(null===(s=u[0])||void 0===s?void 0:s.rank)||0,this.tournamentData.bestScore=(null===(l=u[0])||void 0===l?void 0:l.score)||0,Vf.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!0,this.status=Uf.HAPPENING,t.next=20;break;case 19:this.isHasValidTournament=!1;case 20:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"checkTimeOut",value:(p=t(n().mark((function t(){var i,a,r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.tournamentData,a=i.tournamentId,r=i.leaderboardId,o=i.endTime,!(a&&r&&o)){t.next=13;break}if(!(Date.now()/1e3>o&&this.status!==Uf.FINISHED)){t.next=11;break}return this.status=Uf.FINISHED,this.isHasValidTournament=!1,t.next=7,this.progressPreviousTournamentReward();case 7:return e.logTournamentEnd(),t.next=10,this.chooseNewTournament();case 10:e.updateCurrentLeaderboard();case 11:t.next=16;break;case 13:return t.next=15,this.chooseNewTournament();case 15:e.updateCurrentLeaderboard();case 16:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"chooseNewTournament",value:(d=t(n().mark((function t(){var i,a,r,o,s,l,u,c,h,d,p,f,y,v=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isPlayerJoined=!1,this.tournamentData.tournamentId="",this.tournamentData.leaderboardId="",this.tournamentData.endTime=0,this.tournamentData.bestScore=0,this.tournamentData.isPlayerJoined=!1,this.leaderboardEntries=[],!Ff.Enabled){t.next=36;break}return t.next=11,GameSDK.tournament.getTournamentsAsync();case 11:if(!((i=t.sent.filter((function(e){return e.getEndTime()-Date.now()/1e3>3600}))).length>0)){t.next=32;break}return o=i[0],s={id:o.getID().toString(),endTime:o.getEndTime(),contextId:o.getContextID(),payload:JSON.parse(o.getPayload()),tournamentType:"PAGE_HOSTED"},this.tournamentData.tournamentId=s.id,this.tournamentData.leaderboardId=s.payload.leaderboardId,this.tournamentData.endTime=s.endTime,t.next=20,e.getTournamentPlayerInfo();case 20:return l=t.sent,this.playerRank=(null===(a=l[0])||void 0===a?void 0:a.rank)||0,this.tournamentData.bestScore=(null===(r=l[0])||void 0===r?void 0:r.score)||0,Vf.setGameData({tournamentData:this.tournamentData}),qf.addLeaderboard({type:"tournament",name:s.payload.leaderboardId,autoSortRank:!0,leaderboardId:s.payload.leaderboardId}),t.next=27,e.getLeaderboardAsync(this.tournamentData.leaderboardId,Gf);case 27:console.log("New tournament found:",o),this.isHasValidTournament=!0,this.status=Uf.WAITING,t.next=35;break;case 32:console.warn("No valid tournament found"),Vf.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!1;case 35:return t.abrupt("return");case 36:return t.next=38,qf.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"});case 38:if(u=t.sent.filter((function(e){return v.getTournamentEndTime(e)-Date.now()/1e3>3600})),console.log("validTournament",u),!(u.length>0)){t.next=60;break}return d=u[0],p=JSON.parse(d.description),f={id:p.tournamentID,endTime:this.getTournamentEndTime(d),contextId:p.contextID,payload:{playerId:"global",playerName:"global",leaderboardId:d._id},tournamentType:"PAGE_HOSTED"},this.tournamentData.tournamentId=f.id,this.tournamentData.leaderboardId=f.payload.leaderboardId,this.tournamentData.endTime=f.endTime,t.next=49,e.getTournamentPlayerInfo();case 49:return y=t.sent,this.playerRank=(null===(c=y[0])||void 0===c?void 0:c.rank)||0,this.tournamentData.bestScore=(null===(h=y[0])||void 0===h?void 0:h.score)||0,Vf.setGameData({tournamentData:this.tournamentData}),qf.addLeaderboard({type:"tournament",name:f.payload.leaderboardId,autoSortRank:!0,leaderboardId:f.payload.leaderboardId}),t.next=56,e.getLeaderboardAsync(this.tournamentData.leaderboardId,Gf);case 56:console.log("New tournament found:",d),this.isHasValidTournament=!0,t.next=63;break;case 60:console.warn("No valid tournament found"),Vf.setGameData({tournamentData:this.tournamentData}),this.isHasValidTournament=!1;case 63:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"getTournamentEndTime",value:function(e){var t=new Date(e.createdAt).getTime();return Math.round(604800+t/1e3)}},{key:"progressPreviousTournamentReward",value:(h=t(n().mark((function t(){var i,a,r,o,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.tournamentData,a=i.tournamentId,r=i.leaderboardId,a&&r){t.next=3;break}return t.abrupt("return");case 3:o=e.getTournamentRank(),Mf.includes(o)?(s=Mf.indexOf(o)+1,console.log("Player ".concat(Vf.getPlayerId()," received reward ").concat(s," for rank ").concat(o)),this.tournamentData.lastTournamentRankReward=s,Vf.setGameData({tournamentData:this.tournamentData})):(this.tournamentData.lastTournamentRankReward=0,Vf.setGameData({tournamentData:this.tournamentData}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:(c=t(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.inst.leaderboard=null,this.inst.isNewSession=!0,this.inst.tournamentData=Vf.getGameData().tournamentData,this.inst.isPlayerJoined=this.inst.tournamentData.isPlayerJoined,this.inst.status=Uf.WAITING,Wf.catchUp(Of.GAME_SDK_READY,e.handleGameSDKReady);case 6:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"updateData",value:function(){this.isHasValidTournament()&&this.inst.checkTimeOut()}},{key:"handleJoinFromPost",value:function(){this.inst.isPlayerJoined?console.log("TournamentUtils: Player already joined the tournament"):(this.inst.isPlayerJoined=!0,this.inst.tournamentData.isPlayerJoined=!0,Vf.setGameData({tournamentData:this.inst.tournamentData}),this.inst.status=Uf.HAPPENING,this.updateData())}},{key:"updateCurrentLeaderboard",value:(u=t(n().mark((function t(){var i,a,r,o,s,l,u,c,h,d,p,f,y=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=(null===(i=this.inst.leaderboard)||void 0===i?void 0:i.leaders)||{},console.log("TournamentUtils: updateCurrentLeaderboard",a),r=n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=a[o])&&!y.inst.leaderboardEntries.some((function(e){return e.playerId===t.playerId}))&&y.inst.leaderboardEntries.push({playerId:t.playerId,score:t.score,name:t.name,avatarUrl:t.photo});case 2:case"end":return e.stop()}}),e)})),t.t0=n().keys(a);case 4:if((t.t1=t.t0()).done){t.next=9;break}return o=t.t1.value,t.delegateYield(r(),"t2",7);case 7:t.next=4;break;case 9:if(s=Vf.getPlayerId(),l=this.inst.tournamentData.bestScore,(u=this.inst.leaderboardEntries.find((function(e){return e.playerId===s})))||!(l>0)){t.next=26;break}c=!1,h=0;case 15:if(!(h<this.inst.leaderboardEntries.length)){t.next=23;break}if(!(this.inst.leaderboardEntries[h].score<l)){t.next=20;break}return this.inst.leaderboardEntries.push({playerId:s,score:l,name:Vf.getPlayer().name||"You",avatarUrl:Vf.getPlayer().photo||""}),c=!0,t.abrupt("break",23);case 20:h++,t.next=15;break;case 23:!c&&this.inst.leaderboardEntries.length<Gf&&this.inst.leaderboardEntries.push({playerId:s,score:l,name:Vf.getPlayer().name||"You",avatarUrl:Vf.getPlayer().photo||""}),t.next=27;break;case 26:u&&(u.score=l);case 27:this.inst.leaderboardEntries.sort((function(e,t){return t.score-e.score})),this.inst.leaderboardEntries.length>Gf&&this.inst.leaderboardEntries.pop(),d=0;case 30:if(!(d<this.inst.leaderboardEntries.length)){t.next=38;break}if(this.inst.leaderboardEntries[d].playerId!==Vf.getPlayerId()){t.next=35;break}return this.inst.playerRank=d+1,t.abrupt("break",38);case 35:d++,t.next=30;break;case 38:if(console.log("TournamentUtils: playerRank",this.inst.playerRank),!(this.inst.playerRank<=0&&l>0)){t.next=44;break}return t.next=42,e.getTournamentPlayerInfo();case 42:f=t.sent,this.inst.playerRank=Math.max((null===(p=f[0])||void 0===p?void 0:p.rank)||0,this.inst.leaderboardEntries.length+1);case 44:console.log("TournamentUtils: updateCurrentLeaderboard",this.inst.leaderboardEntries);case 45:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"updateLeaderboard",value:(l=t(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inst.leaderboard){t.next=3;break}return t.next=3,e.getLeaderboardAsync(e.getLeaderboardId(),Gf);case 3:e.updateCurrentLeaderboard();case 4:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"resetRewardData",value:function(){this.inst.tournamentData.lastTournamentRankReward=0,Vf.setGameData({tournamentData:this.inst.tournamentData})}},{key:"handleJoinTournament",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt.joinTournamentAsync(this.inst.tournamentData.tournamentId);case 3:this.inst.isPlayerJoined=!0,this.inst.tournamentData.isPlayerJoined=!0,Vf.setGameData({tournamentData:this.inst.tournamentData}),this.inst.status=Uf.HAPPENING,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("TournamentUtils: handleJoinTournament",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return s.apply(this,arguments)})},{key:"getLeaderboard",value:function(){return console.log("Returning cached leaderboard data"),this.inst.leaderboardEntries}},{key:"getLeaderboardAsync",value:(a=t(n().mark((function t(i,a){var r,o,s,l,u,c,h,d,p,f,y,v;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=qf.getLeaderboardName(i)){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,qf.requestLeaderboardAsync(r,a);case 5:for(o=qf.getLeaderboard(r),e.useRealLeaderBoard&&o||(o={limit:a,offset:0,leaders:{},isRequesting:!1,amountPlayer:0,resettable:"manually"}),s=Object.values(this.inst.addedRealPlayers),l=0,u=s;l<u.length;l++)c=u[l],o.leaders[c.playerId]=c,console.log(c);return h=Vf.getPlayerId(),d=this.inst.tournamentData.bestScore||0,!o.leaders[h]&&d>0&&(f=Object.keys(this.inst.addedRealPlayers).length,y=(null===(p=this.inst.leaderboard)||void 0===p?void 0:p.leaders[h])||{},o.leaders[h]={playerId:h,score:this.inst.tournamentData.bestScore,name:Vf.getPlayer().name||"Guest",photo:Vf.getPlayer().photo||"https://picsum.photos/seed/%1/300/300",rank:y.rank||f+1}),(v=Object.values(o.leaders).sort((function(e,t){return t.score===e.score?e.rank-t.rank:t.score-e.score}))).forEach((function(e,t){e.rank=t+1})),o.leaders=v.slice(0,a).reduce((function(e,t){return e[t.playerId]=t,e}),{}),console.log("TournamentUtils: getLeaderboardAsync",o),this.inst.leaderboard=o,t.abrupt("return",this.inst.leaderboard);case 18:case"end":return t.stop()}}),t,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"isHasReward",value:function(){return this.inst.tournamentData.lastTournamentRankReward>0}},{key:"getLastTournamentRankRewardQuantity",value:function(){return Math.ceil((6-e.inst.tournamentData.lastTournamentRankReward)/2)}},{key:"getLastTournamentRankReward",value:function(){return e.inst.tournamentData.lastTournamentRankReward}},{key:"getTournamentEndTime",value:function(){var t=e.inst.tournamentData.endTime;if(!t)return{key:"customString",params:[nt(0,!0)]};var n=ot(t),i=n.remainingTimeInDays,a=n.remainingTimeInMs;return a<864e5?{key:"customString",params:[nt(a,!0)]}:i>1?{key:"vDays",params:[i.toString()]}:{key:"1day",params:[]}}},{key:"getTournamentId",value:function(){return e.inst.tournamentData.tournamentId}},{key:"getLeaderboardId",value:function(){return e.inst.tournamentData.leaderboardId}},{key:"getTournamentPlayerInfo",value:(i=t(n().mark((function t(){var i,a=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=zf()?new Promise((function(t){st(300).then((function(){var n,i=Vf.getPlayerId(),r=(null===(n=a.inst.leaderboard)||void 0===n?void 0:n.leaders)||{};if(r[i])t([r[i]]);else{var o=e.inst.tournamentData.bestScore||0;if(o>0){var s=1;for(var l in e.inst.addedRealPlayers)e.inst.addedRealPlayers[l].score>o&&s++;t([{playerId:i,score:o,name:Vf.getPlayer().name||"Guest",photo:Vf.getPlayer().photo||"https://picsum.photos/seed/%1/300/300",rank:s}])}else t([])}}))})):qf.getLeadersByPlayerIdsAsync(e.getLeaderboardId(),[Vf.getPlayerId()]),t.abrupt("return",i);case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"getIsNewSession",value:function(){return this.inst.isNewSession}},{key:"setIsNewSession",value:function(e){this.inst.isNewSession=e}},{key:"getTournamentRank",value:function(){return e.inst.playerRank||(e.inst.playerRank=-1),e.inst.playerRank}},{key:"getCachedLeaderAvatar",value:function(e){return this.inst.cachedLeaderAvatar.has(e)&&this.inst.cachedLeaderAvatar.get(e)||null}},{key:"setCachedLeaderAvatar",value:function(e,t){this.inst.cachedLeaderAvatar.set(e,t)}},{key:"isHasValidTournament",value:function(){return this.inst.isHasValidTournament}},{key:"isTournamentHappening",value:function(){return this.inst.isPlayerJoined&&this.inst.tournamentData.endTime>Date.now()/1e3}},{key:"getTournamentData",value:function(){return this.inst.tournamentData}},{key:"getGoldenTilesPerLevel",value:function(){return 4}},{key:"updateTournamentData",value:function(e){this.inst.tournamentData=m(m({},this.inst.tournamentData),e),Vf.setGameData({tournamentData:this.inst.tournamentData})}},{key:"logTournamentEnd",value:function(){codex.analytics.event(it.TOURNAMENT_END,{rank:e.getLastTournamentRankReward(),level:at.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentRewarded",value:function(){codex.analytics.event(it.TOURNAMENT_REWARDED,{rank:e.getLastTournamentRankReward(),level:at.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentStart",value:function(){codex.analytics.event(it.TOURNAMENT_START,{level:at.getLevel(),tournament_id:e.getTournamentId()})}},{key:"logTournamentRejoin",value:function(){codex.analytics.event(it.TOURNAMENT_REJOIN)}},{key:"logTournamentRefuse",value:function(e){codex.analytics.event(it.TOURNAMENT_REFUSE,{value:e})}},{key:"logTournamentShare",value:function(){codex.analytics.event(it.TOURNAMENT_SHARE)}},{key:"logTournamentPostScore",value:function(){codex.analytics.event(it.TOURNAMENT_POST_SCORE)}},{key:"isInContextGlobalTournament",value:function(){var e=codex.match.getMatchState();if(e.mode!==Df.Modes.TOURNAMENT)return!1;var t=e.customData.tournamentId;return!!t&&t===this.inst.tournamentData.tournamentId}},{key:"addRealPlayers",value:function(e){for(var t=Object.keys(this.inst.addedRealPlayers).length,n=0;n<e;n++){var i="real-player-".concat(t+n);this.inst.addedRealPlayers[i]={playerId:i,score:4*Math.floor(25*Math.random())+4,name:"Player ".concat(t+n),photo:"https://fastly.picsum.photos/id/866/200/300.jpg?hmac=rcadCENKh4rD6MAp6V_ma-AyWv641M4iiOpe1RyFHeI",rank:t+n+2}}}},{key:"addRealPlayer",value:function(e,t){var n=Object.keys(this.inst.addedRealPlayers).length,i="real-player-".concat(n);this.inst.addedRealPlayers[i]={playerId:i,score:t,name:e,photo:"https://fastly.picsum.photos/id/866/200/300.jpg?hmac=rcadCENKh4rD6MAp6V_ma-AyWv641M4iiOpe1RyFHeI",rank:n+2}}}]),e}();Pf=jf,jf.useRealLeaderBoard=!0,jf.completeLevelPromise=void 0,jf.handleGameSDKReady=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pf.inst.fetchTournamentData();case 2:if(Pf.isHasValidTournament()){e.next=5;break}return e.next=5,Pf.inst.chooseNewTournament();case 5:return zf()&&(Pf.useRealLeaderBoard=!1),Ludex.Utils.Valid.isDebugger()||(Pf.useRealLeaderBoard=!0),e.next=9,Pf.updateLeaderboard();case 9:Pf.updateData();case 10:case"end":return e.stop()}}),e)})));var Kf=["Patrice Remy","Gellie Hinton","Codle De Pablo","Roger Dumagat","Bud Franklin","Burl Drake","Jan Retallack","Donna E French","Ahmet Karatay","Ann Hamilton","Jodie Williams","Debbie Drumm","Tommy Johnson","Shirley Jeane Reigles","Ron Richard","Dot Dennis","Joan Gaetano","Pat Waclawsky","Arton Hoxha","Lulzim Kosumi","Amir Berisha","Rosemarie Gilbert","Bernard Dube","Solange Rocher","Fay Grouiou","James Jhon","Ken Ewing","Carmel Mccormack","Kay Pike","Coco Zenou","Theodore Crevon"];b._RF.pop(),b._RF.push({},"d6a460y/N5KD4HGvY1CxodW","AlignTile",void 0);var Yf=-10,Jf=-8,Zf=190,Qf=211/171,Xf=16,$f=16;b._RF.pop(),b._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var ey,ty,ny=function(e){return e.NEXT_LEVEL="next-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.AUTO_FINISH_LEVEL="auto-finish-level",e.SWITCH_SCENE="switch-scene",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.GAME_RESCUE="game-rescue",e.USE_ITEM="use-item",e.SHOW_HINT="show-hint",e.HIDE_HINT="hide-hint",e.START_UNDO="start-undo",e.START_SHUFFLE="start-shuffle",e.END_SHUFFLE="end-shuffle",e.ITEM_CONFIG_CHANGE="item-config-change",e.ITEM_COUNT_CHANGE="item-count-change",e.THEME_BACKGROUND_CHANGE="theme-background-change",e.THEME_TILE_CHANGE="theme-tile-change",e.GAMEOBJECT_WIDGET_UPDATE="gameobject-widget-update",e.SKIP_LEVEL="skip-level",e.TIME_OUT="time-out",e.ALL_TILE_READY="all-tile-ready",e.ALL_TILE_DESTROYED="all-tile-destroyed",e.ALL_TILE_COVERED="all-tile-covered",e.TILE_CLICKED="tile-clicked",e.TILE_MOVING="tile-moving",e.TILE_DROPPED="tile-dropped",e.TILE_COVERED_CLICKED="tile-covered-clicked",e.TILE_CREATED="tile-created",e.TILE_DESTROYED="tile-destroyed",e.TILE_RELEASE="tile-release",e.TILE_START_SORT="tile-start-sort",e.TWO_TILES_MATCHED="two-tiles-matched",e.TWO_TILES_UNDONE="two-tiles-undone",e.TILE_BLOCKED="tile-blocked",e.TILES_STATE_UPDATED="tiles-state-updated",e.JOURNEY_MISSION_COMPLETE_CHECK="journey-mission-complete-check",e.MISSION_TILE_SET_COLLECT="mission-tile-set-collect",e.MISSION_TILE_SET_UPDATE="mission-tile-set-update",e}(ny||{});b._RF.pop(),b._RF.push({},"e218cFvNc1Afa7J5ohWJnaz","InputHandler",void 0);var iy=(0,w.ccclass)("InputHandler")(((ty=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).isDragging=!1,e.isTouching=!1,e.touchStartPosition=null,e.touchStartOffset=null,e}return o(n,[{key:"__preload",value:function(){this.tile=this.getComponent(Pv),this.uiTransform=this.getComponent(R),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.enableInteraction()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){this.disableInteraction()}},{key:"enableInteraction",value:function(){this.node.on(P.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(P.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(P.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(P.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}},{key:"disableInteraction",value:function(){this.node.off(P.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(P.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(P.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(P.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.isDragging=!1,this.isTouching=!1}},{key:"onTouchStart",value:function(e){this.checkIsChoosingOrAlreadyState()&&(this.isTouching=!0,this.touchStartPosition=this.getTouchPosition(e),this.touchStartOffset=this.getTouchOffset(this.touchStartPosition),this.tile.isUncovered||this.tile.handleTileCoveredClicked())}},{key:"onTouchMove",value:function(e){if(this.isTouching&&this.tile.isUncovered){var t=this.getTouchPosition(e);if(!this.isDragging){if(t.clone().subtract(this.touchStartPosition).length()<n.TOUCH_MOVE_THRESHOLD)return;this.isDragging=!0,this.tile.handleTileMoving()}if(this.isDragging){var i=t.add(this.touchStartOffset);this.setMovePosition(i),this.tile.animationHandler.abortAllMovementAnimations()}}}},{key:"setMovePosition",value:function(e){var t=this.tile.animationHandler.getShadow();t.node.setSiblingIndex(99998),this.node.setSiblingIndex(99999);var n=new U(e.x,e.y,this.node.position.z);t.node.setPosition(n),this.node.setPosition(n)}},{key:"getTouchPosition",value:function(e){var t=this.node.parent.parent.parent.getComponent(R),n=e.getUILocation();return t.convertToNodeSpaceAR(new U(n.x,n.y,0))}},{key:"getTouchOffset",value:function(e){var t=this.node.position;return new U(t.x-e.x,t.y-e.y,0)}},{key:"onTouchEnd",value:function(e){this.isTouching&&(this.isTouching=!1,this.checkIsChoosingOrAlreadyState()&&(this.isDragging?(this.isDragging=!1,this.tile.handleTileDropped()):this.handleClick()))}},{key:"onTouchCancel",value:function(e){this.isTouching&&(this.isTouching=!1,this.tile.isUncovered&&this.checkIsChoosingOrAlreadyState()&&(this.isDragging?(this.isDragging=!1,this.tile.handleTileDropped()):this.handleClick()))}},{key:"checkIsChoosingOrAlreadyState",value:function(){return this.tile.state===lt.CHOOSING||this.tile.state===lt.ALREADY}},{key:"handleClick",value:function(){this.tile.isUncovered&&
//! const vibrate = this.gameScene.gamePlay.vibrate
this.tile.handleTileClicked()}}]),n}(E)).TOUCH_MOVE_THRESHOLD=40,ey=ty))||ey;b._RF.pop(),b._RF.push({},"8b183z34N1DSbNWp3KCFNtS","TileCollectTween",void 0);Ludex.Utils.Signal;var ay=function(){function e(t){var n=this;r(this,e),this.reset=function(){n.tile.node.angle=0},this.tile=t}var i;return o(e,[{key:"startAnimation",value:(i=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.once(this.reset),i=this.tile.getTileSizeScale(),a=z(this.tile.node).to(.1,{scale:new U(1.2*i.x,1.2*i.y,1)},{easing:"cubicIn"}).to(.1,{scale:new U(1.25*i.x,1.25*i.y,1),angle:22},{easing:"cubicIn"}).to(.1,{angle:-22},{easing:"sineIn"}).to(.15,{angle:15},{easing:"sineInOut"}).to(.15,{angle:-13},{easing:"sineInOut"}).to(.1,{angle:0},{easing:"sineOut"}).to(.15,{scale:new U(0,0,1)},{easing:"cubicOut"}),e.next=5,Ke.runTweenAsync(a,t);case 5:t.off(this.reset);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}]),e}();b._RF.pop(),b._RF.push({},"1a140DxQ0tGSoZKO4qqcxTs","TileCoverTween",void 0);Ludex.Utils.Signal;var ry=function(){function e(t,n){r(this,e),this.itemSprite=t,this.overlayOpacity=n}var i,a;return o(e,[{key:"startCoverAnimation",value:(a=t(n().mark((function e(t){var i,a,r,o=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=o.length>1&&void 0!==o[1]?o[1]:.3,o.length>2&&void 0!==o[2]&&o[2]&&(a=z(this.itemSprite).to(i,{color:new M(180,180,180,255)}),Ke.runTweenAsync(a,t)),r=z(this.overlayOpacity).to(i,{opacity:255}).start(),Ke.runTweenAsync(r,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"startUncoverAnimation",value:(i=t(n().mark((function e(t){var i,a,r,o=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=o.length>1&&void 0!==o[1]?o[1]:.3,o.length>2&&void 0!==o[2]&&o[2]&&(a=z(this.itemSprite).to(i,{color:new M(255,255,255,255)}),Ke.runTweenAsync(a,t)),r=z(this.overlayOpacity).to(i,{opacity:0}).start(),Ke.runTweenAsync(r,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"reset",value:function(){this.overlayOpacity.opacity=0,this.itemSprite.color=new M(255,255,255,255)}}]),e}();b._RF.pop(),b._RF.push({},"0ee47HY0HBEr5sck4cawSHI","TileFlipTween",void 0);Ludex.Utils.Signal;var oy=function(){function e(t,n,i,a){r(this,e),this.isHidingBackground=!1,this.isRunning=!1,this.tile=t,this.hidden=a,this.shadow=n,this.background=i}var i,a;return o(e,[{key:"getIsHidingBackground",value:function(){return this.isHidingBackground}},{key:"getIsRunning",value:function(){return this.isRunning}},{key:"setIsHidingBackground",value:function(e){this.isHidingBackground=e}},{key:"startHideBackgroundAnimation",value:(a=t(n().mark((function e(t){var i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:.2,a=!(l.length>2&&void 0!==l[2])||l[2],!this.isHidingBackground){e.next=4;break}return e.abrupt("return");case 4:if(this.isHidingBackground=!0,this.isRunning=!0,!(i<=0)){e.next=11;break}return this.background.active=!1,this.hidden.active=!0,this.isRunning=!1,e.abrupt("return");case 11:return r=this.createScaleTween(this.tile.node,i,!1),o=[Ke.runTweenAsync(r,t)],a&&(s=this.createScaleTween(this.shadow.node,i,!1),o.push(Ke.runTweenAsync(s,t))),e.next=16,Promise.all(o);case 16:this.isRunning=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"createScaleTween",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.tile.getTileSizeScale();return z(e).to(.5*t,{scale:new U(.2*a.x,1*a.y,1)},{easing:"smooth"}).call((function(){i?(n.background.active=!0,n.hidden.active=!1):(n.background.active=!1,n.hidden.active=!0)})).to(.5*t,{scale:new U(a.x,a.y,1)},{easing:"smooth"})}},{key:"startShowBackgroundAnimation",value:(i=t(n().mark((function e(t){var i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:.2,a=!(l.length>2&&void 0!==l[2])||l[2],this.isHidingBackground){e.next=4;break}return e.abrupt("return");case 4:if(this.isHidingBackground=!1,this.isRunning=!0,!(i<=0)){e.next=11;break}return this.background.active=!0,this.hidden.active=!1,this.isRunning=!1,e.abrupt("return");case 11:return r=this.createScaleTween(this.tile.node,i,!0),o=[Ke.runTweenAsync(r,t)],a&&(s=this.createScaleTween(this.shadow.node,i,!0),o.push(Ke.runTweenAsync(s,t))),e.next=16,Promise.all(o);case 16:this.isRunning=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"reset",value:function(){this.isHidingBackground=!1,this.isRunning=!1,this.background.active=!0,this.hidden.active=!1}}]),e}();b._RF.pop(),b._RF.push({},"4c986D4ETNGgr2/U+UG6ceh","TileHighlightTween",void 0);Ludex.Utils.Signal;var sy=function(){function e(t){r(this,e),this.isShowing=!1,this.selectedOverlayOpacity=t}var i,a,s;return o(e,[{key:"getIsShowing",value:function(){return this.isShowing}},{key:"createTweenGlowAnimation",value:(s=t(n().mark((function e(t,i){var a,r,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:.8,r=z(this.selectedOverlayOpacity).to(a,{opacity:t?255:0}),(o=[]).push(Ke.runTweenAsync(r,i)),e.next=6,Promise.all(o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"startGlowAnimation",value:(a=t(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.length>1&&void 0!==a[1]?a[1]:.8,!this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return this.isShowing=!0,e.next=6,this.createTweenGlowAnimation(!0,t,i);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"stopGlowAnimation",value:(i=t(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.length>1&&void 0!==a[1]?a[1]:.8,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return this.isShowing=!1,e.next=6,this.createTweenGlowAnimation(!1,t,i);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"reset",value:function(){this.isShowing=!1,this.selectedOverlayOpacity.opacity=0}}]),e}();b._RF.pop(),b._RF.push({},"ee558+DmFpHh4vQ/m84xuJ5","TileHintTween",void 0);Ludex.Utils.Signal;var ly=function(){function e(t,n,i){r(this,e),this.isRunning=!1,this.hintOverlayOpacity=t,this.hintBorderOpacity=n,this.hintHighlight=i}return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"startHintAnimation",value:function(e){this.isRunning=!0;var t=z(this.hintOverlayOpacity).to(.3,{opacity:255});Ke.runTweenAsync(t,e);var n=z(this.hintOverlayOpacity).set({opacity:0}).to(.8,{opacity:150}).to(.8,{opacity:0}).union(),i=z(this.hintOverlayOpacity).set({opacity:0}).repeatForever(n);Ke.runTweenAsync(i,e);var a=z(this.hintBorderOpacity).to(.3,{opacity:255});Ke.runTweenAsync(a,e);var r=z(this.hintHighlight.node).set({angle:0}).by(1,{angle:360}).union(),o=z(this.hintHighlight.node).set({angle:0}).repeatForever(r);Ke.runTweenAsync(o,e)}},{key:"stopHintAnimation",value:function(e){this.isRunning=!1,this.hintOverlayOpacity.opacity=0,this.hintBorderOpacity.opacity=0,this.hintHighlight.node.angle=0}},{key:"reset",value:function(){this.isRunning=!1,this.hintOverlayOpacity.opacity=0,this.hintBorderOpacity.opacity=0,this.hintHighlight.node.angle=0}}]),e}();b._RF.pop(),b._RF.push({},"ab3d7Z05b1Mgb+TC2TRn/YQ","TileInitTween",void 0);Ludex.Utils.Signal;var uy=function(){function e(t,n,i){r(this,e),this.currentScale=new U(0,0,0),this.tile=t,this.tileUiOpacity=n,this.shadow=i}var i,a;return o(e,[{key:"closeTile",value:(a=t(n().mark((function e(){var t,i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.075,i=r.length>1&&void 0!==r[1]?r[1]:0,this.currentScale.set(this.tile.getTileSizeScale()),this.tile.state=lt.PRELOADING,a=z(this.tile.node).delay(i).to(t,{scale:new U(0,0,0)},{easing:"cubicIn"}),e.next=7,Ke.runTweenAsync(a);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"playScaleUpToCurrentAnimation",value:(i=t(n().mark((function e(t){var i,a,r,o,s,l,u,c,h,d=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>1&&void 0!==d[1]?d[1]:.12,a=d.length>2&&void 0!==d[2]?d[2]:0,r=d.length>3&&void 0!==d[3]?d[3]:new U(0,0,0),o=!(d.length>4&&void 0!==d[4])||d[4],this.tile.node.getComponent(N)){e.next=7;break}return e.abrupt("return");case 7:return this.currentScale.equals(U.ZERO)&&this.currentScale.set(this.tile.getTileSizeScale()),this.tileUiOpacity.opacity=255,this.shadow.opacity=255,s=[],o?(this.tile.node.setScale(U.ZERO),this.shadow.node.setScale(U.ZERO),l=this.createScaleUpTween(this.tile.node,i,a),u=this.createScaleUpTween(this.shadow.node,i,a),s.push(Ke.runTweenAsync(u,t)),s.push(Ke.runTweenAsync(l,t))):(this.tile.node.setScale(this.currentScale),this.shadow.node.setScale(this.currentScale)),c=this.createMoveToTween(this.tile.node,r,i,a),h=this.createMoveToTween(this.shadow.node,r,i,a),s.push(Ke.runTweenAsync(h,t)),s.push(Ke.runTweenAsync(c,t)),e.next=18,Promise.all(s);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createScaleUpTween",value:function(e,t,n){return z(e).delay(n).to(t,{scale:this.currentScale},{easing:"circOut"})}},{key:"createMoveToTween",value:function(e,t,n,i){var a=this.tile.worldPos.clone();return z(e).set({position:t}).delay(i).to(n,{position:new U(a.x,a.y,0)},{easing:"cubicOut"})}},{key:"reset",value:function(){this.currentScale.set(U.ZERO)}}]),e}();b._RF.pop(),b._RF.push({},"1c93fOhNTJB8ruRTnhag89o","TileNudgeTween",void 0);Ludex.Utils.Signal;var cy=function(){function e(t,n){r(this,e),this.isRunning=!1,this.tile=t,this.shadowOpacity=n}return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"startNudgeAnimation",value:function(e,t){if(!this.isRunning){this.isRunning=!0;var n=this.createNudgeTween(this.shadowOpacity.node),i=this.createLoopTween(this.shadowOpacity.node,n),a=this.createNudgeTween(this.tile.node),r=this.createLoopTween(this.tile.node,a);Ke.runTweenAsync(i,e),Ke.runTweenAsync(r,e)}}},{key:"createNudgeTween",value:function(e){return z(e).to(.15,{angle:22},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).to(.1,{angle:13},{easing:"sineInOut"}).to(.1,{angle:-13},{easing:"sineOut"}).to(.02,{angle:-17},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).delay(.3).union()}},{key:"createLoopTween",value:function(e,t){var n=this.tile.worldPos;return z(e).set({angle:0,position:new U(n.x,n.y,1)}).repeatForever(t)}},{key:"reset",value:function(){this.isRunning=!1,this.tile.node.angle=0,this.shadowOpacity.node.angle=0}}]),e}();b._RF.pop(),b._RF.push({},"6f7ebcNAMZAd7hGzOIS4ZzD","TileSelectTween",void 0);Ludex.Utils.Signal;var hy=function(){function e(t,n){r(this,e),this.isRunning=!1,this.isBlockedLeft=!1,this.isBlockedRight=!1,this.tile=t,this.shadow=n}var i,a;return o(e,[{key:"getIsRunning",value:function(){return this.isRunning}},{key:"getCurrentSelectedPosition",value:function(){return this.isRunning?this.getSelectedPosition(this.isBlockedLeft,this.isBlockedRight):this.getSelectedPosition(!1,!1)}},{key:"startSelectAnimation",value:(a=t(n().mark((function e(t){var i,a,r,o,s,l,u,c=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>1&&void 0!==c[1]&&c[1],a=c.length>2&&void 0!==c[2]&&c[2],r=c.length>3&&void 0!==c[3]?c[3]:.8,this.isRunning=!0,this.isBlockedLeft=i,this.isBlockedRight=a,o=this.getSelectedPosition(i,a),s=this.createMoveTween(this.tile.node,r,o),l=this.createMoveTween(this.shadow.node,r,o),u=[Ke.runTweenAsync(s,t),Ke.runTweenAsync(l,t)],e.next=12,Promise.all(u);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"createMoveTween",value:function(e,t,n){return z(e).to(t,{position:n},{easing:"smooth"})}},{key:"startUnselectAnimation",value:(i=t(n().mark((function e(t){var i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>1&&void 0!==l[1]?l[1]:.3,this.isRunning=!1,a=new U(this.tile.worldPos.x,this.tile.worldPos.y,1),r=this.createMoveTween(this.tile.node,i,a),o=this.createMoveTween(this.shadow.node,i,a),s=[Ke.runTweenAsync(r,t),Ke.runTweenAsync(o,t)],e.next=8,Promise.all(s);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"reset",value:function(){this.isRunning=!1,this.isBlockedLeft=!1,this.isBlockedRight=!1}},{key:"getSelectedPosition",value:function(e,t){var n=this.tile.worldPos,i=this.tile.getTileSize(),a=0;return e?a=.2*i.x:t&&(a=.2*-i.x),new U(n.x+a,n.y,1)}}]),e}();b._RF.pop(),b._RF.push({},"b7d66xr7RhN0KKD9F6zu+fG","TileShakeTween",void 0);Ludex.Utils.Signal;var dy=function(){function e(t,n){r(this,e),this.tile=t,this.shadow=n}var i;return o(e,[{key:"playShakeAnimation",value:(i=t(n().mark((function e(t,i){var a,r,o,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.createShakeTween(this.tile.node,i),r=this.createShakeTween(this.shadow.node,i),o=function(){r.stop(),s.tile.node.setPosition(i.x,i.y),s.shadow.node.setPosition(i.x,i.y)},t.once(o),Ke.runTweenAsync(r),e.next=7,Ke.runTweenAsync(a,t);case 7:t.off(o);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"createShakeTween",value:function(e,t){var n=ut.ANIMATION_CONFIGS.SHAKE.SHAKE_DURATION,i=ut.ANIMATION_CONFIGS.SHAKE.SHAKE_OFFSET;return z(e).to(n,{position:new U(t.x+i,t.y)}).to(n,{position:new U(t.x-i,t.y)}).to(n,{position:new U(t.x+i,t.y)}).to(n,{position:new U(t.x-i,t.y)}).to(n,{position:new U(t.x,t.y)})}}]),e}();b._RF.pop(),b._RF.push({},"e0bacq8D3JJHaehSRDt2HQ7","TileShineTween",void 0);Ludex.Utils.Signal;var py=function(){function e(t,n){r(this,e),this.isGlowShadow=!1,this.tile=t,this.shadow=n}var i;return o(e,[{key:"getIsHidingBackground",value:function(){return this.isGlowShadow}},{key:"startShineAnimation",value:(i=t(n().mark((function e(t){var i,a,r,o,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isGlowShadow){e.next=2;break}return e.abrupt("return");case 2:return this.isGlowShadow=!0,t.once(this.reset),i=this.tile.getTileSizeScale(),a=z(this.tile.node).to(.1,{scale:new U(.8*i.x,.8*i.y,1)},{easing:"cubicIn"}).to(.2,{scale:new U(1.2*i.x,1.2*i.y,1)},{easing:"cubicInOut"}).to(.2,{scale:new U(i.x,i.y,1)},{easing:"cubicOut"}),r=z(this.shadow).set({opacity:0}).delay(.1).call((function(){s.tile.setGlowShadow(!0)})).set({opacity:100}).to(.2,{opacity:255},{easing:"cubicIn"}).to(.2,{opacity:200},{easing:"cubicInOut"}),o=[Ke.runTweenAsync(a,t),Ke.runTweenAsync(r,t)],e.next=10,Promise.all(o);case 10:t.off(this.reset);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"reset",value:function(){this.isGlowShadow=!1,this.tile.setGlowShadow(!1),this.shadow.opacity=255}}]),e}();b._RF.pop(),b._RF.push({},"67b244GKPlEs5+hGwB+vsYW","TileShuffleTween",void 0);Ludex.Utils.Signal;var fy=function(){function e(t,n){r(this,e),this.tile=t,this.shadowOpacity=n}var i;return o(e,[{key:"playShuffleAnimation",value:(i=t(n().mark((function e(t,i){var a,r,o,s,l,u,c,h,d,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.tile.worldPos.x,r=this.tile.worldPos.y,this.tile.uiTransform){e.next=4;break}return e.abrupt("return");case 4:return o=a,s=r,l=this.createMoveTween(this.tile.node,o,s),u=this.createMoveTween(this.shadowOpacity.node,o,s),c=z(this.shadowOpacity).to(.25,{opacity:0},{easing:"cubicOut"}).delay(1.15).to(.2,{opacity:255},{easing:"cubicOut"}),h=Ke.runTweenAsync(c,t),d=Ke.runTweenAsync(l,t),p=Ke.runTweenAsync(u,t),e.next=14,Promise.all([h,d,p]);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"createMoveTween",value:function(e,t,n){return z(e).to(.5,{position:new U(0,0,0)},{easing:"backIn"}).delay(.4).to(.5,{position:new U(t,n,0)},{easing:"backOut"})}}]),e}();b._RF.pop(),b._RF.push({},"f8b51gHgrFMkomOqHYy6Otp","TileTargetTween",void 0);Ludex.Utils.Signal;var yy=function(){function e(t){r(this,e),this.isRunning=!1,this.findingOpacity=t}var i;return o(e,[{key:"playShowAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.isRunning)return this.isRunning=!0,this.createTweenGlowAnimation(!0,e,t)}},{key:"playHideAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.isRunning)return this.isRunning=!1,this.createTweenGlowAnimation(!1,e,t)}},{key:"getIsRunning",value:function(){return this.isRunning}},{key:"createTweenGlowAnimation",value:(i=t(n().mark((function e(t,i){var a,r,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:.8,r=z(this.findingOpacity).to(a,{opacity:t?255:0}),(o=[]).push(Ke.runTweenAsync(r,i)),e.next=6,Promise.all(o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"reset",value:function(){this.isRunning=!1,this.findingOpacity.opacity=0}}]),e}();b._RF.pop(),b._RF.push({},"2f8b7qRHRZAI426Nbgp2wBc","TileUndoTween",void 0);Ludex.Utils.Signal;var vy,gy,my,by,Sy,wy,ky,Ty,Cy,Ey,Ly,Iy,xy,Ry,Ay,_y,Py,By,Ny,Oy,Dy,Fy,zy,My,Uy,Gy,Hy,Vy=function(){function e(t,n,i){r(this,e),this.tile=t,this.tileOpacity=n,this.shadow=i}return o(e,[{key:"playUndoAnimation",value:function(e){this.tileOpacity.opacity=255,this.tile.node.setPosition(this.tile.worldPos.x,this.tile.worldPos.y);
//! this.shadow.node.setPosition(this.tile.worldPos.x, this.tile.worldPos.y)
var t=this.createScaleTween(this.tile.node),n=this.createScaleTween(this.shadow.node);Ke.runTweenAsync(t,e),Ke.runTweenAsync(n,e)}},{key:"createScaleTween",value:function(e){var t=this.tile.getTileSizeScale();return z(e).set({scale:new U(.3*t.x,.3*t.y,1)}).to(.3,{scale:new U(t.x,t.y,1)},{easing:"backOut"})}}]),e}();b._RF.pop(),b._RF.push({},"dcdc7pCmblCF6sivNY6OqXp","TileAnimationHandler",void 0);var Wy,qy,jy,Ky,Yy,Jy,Zy,Qy,Xy,$y,ev,tv,nv,iv,av,rv,ov,sv,lv,uv,cv,hv,dv,pv,fv,yv,vv,gv,mv,bv,Sv,wv=w.ccclass,kv=w.property,Tv=Ludex.Utils.Signal,Cv=(vy=wv("TileAnimationHandler"),gy=kv(R),my=kv(P),by=kv(N),Sy=kv(N),wy=kv(N),ky=kv(N),Ty=kv(N),Cy=kv(N),Ey=kv(N),Ly=kv(ae),Iy=kv(x),xy=kv(P),vy((_y=u((Ay=function(e){i(E,e);var s,l,u,d,p,f,y,v,g,m,b,S,w,k,T,C=a(E);function E(){var e;r(this,E);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=C.call.apply(C,[this].concat(n)),c(e,"tileUITransform",_y,h(e)),c(e,"background",Py,h(e)),c(e,"tileOpacity",By,h(e)),c(e,"shadowOpacity",Ny,h(e)),e.isShadowAttached=!0,c(e,"overlayOpacity",Oy,h(e)),c(e,"selectedOverlayOpacity",Dy,h(e)),c(e,"targetOverlayOpacity",Fy,h(e)),c(e,"hintOverlayOpacity",zy,h(e)),c(e,"hintBorderOpacity",My,h(e)),c(e,"selectParticleSystem",Uy,h(e)),c(e,"hintHighlight",Gy,h(e)),c(e,"hidden",Hy,h(e)),e.initSignalController=new Tv.SignalController,e.hintSignalController=new Tv.SignalController,e.shakeSignalController=new Tv.SignalController,e.undoSignalController=new Tv.SignalController,e.highlightSignalController=new Tv.SignalController,e.selectSignalController=new Tv.SignalController,e.coverSignalController=new Tv.SignalController,e.shuffleSignalController=new Tv.SignalController,e.nudgeSignalController=new Tv.SignalController,e.targetSignalController=new Tv.SignalController,e.flipSignalController=new Tv.SignalController,e.shineSignalController=new Tv.SignalController,e.collectSignalController=new Tv.SignalController,e}return o(E,[{key:"__preload",value:function(){this.tile=this.getComponent(Pv),this.tileInitTween=new uy(this.tile,this.tileOpacity,this.shadowOpacity),this.tileShakeTween=new dy(this.tile,this.shadowOpacity),this.tileUndoTween=new Vy(this.tile,this.tileOpacity,this.shadowOpacity),this.tileShuffleTween=new fy(this.tile,this.shadowOpacity),this.tileSelectTween=new hy(this.tile,this.shadowOpacity),this.tileNudgeTween=new cy(this.tile,this.shadowOpacity),this.tileFlipTween=new oy(this.tile,this.shadowOpacity,this.background,this.hidden),this.tileShineTween=new py(this.tile,this.shadowOpacity),this.tileCollectTween=new ay(this.tile),this.tileHighlightTween=new sy(this.selectedOverlayOpacity),this.tileCoverTween=new ry(this.tile.item,this.overlayOpacity),this.tileHintTween=new ly(this.hintOverlayOpacity,this.hintBorderOpacity,this.hintHighlight),this.tileTargetTween=new yy(this.targetOverlayOpacity),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"detachShadow",value:function(e){return this.isShadowAttached?(this.isShadowAttached=!1,this.shadowOpacity.node.setParent(e,!0),this.shadowOpacity):this.shadowOpacity}},{key:"attachShadow",value:function(){this.isShadowAttached||(this.isShadowAttached=!0,this.shadowOpacity.node.setScale(U.ONE),this.shadowOpacity.node.setParent(this.tile.node),this.shadowOpacity.node.setPosition(0,0,0),this.shadowOpacity.node.setSiblingIndex(0))}},{key:"getShadow",value:function(){return this.shadowOpacity}},{key:"toggleCoverAnimations",value:(T=t(n().mark((function e(t){var i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.length>1&&void 0!==r[1]?r[1]:.3,a=this.coverSignalController.renew(),t?this.tileCoverTween.startUncoverAnimation(a,i,this.tile.isArtifact):this.tileCoverTween.startCoverAnimation(a,i,this.tile.isArtifact);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"playTileOpenAnimation",value:(k=t(n().mark((function e(){var t,i,a,r,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:.12,i=s.length>1&&void 0!==s[1]?s[1]:0,a=s.length>2&&void 0!==s[2]?s[2]:new U(0,0,0),r=!(s.length>3&&void 0!==s[3])||s[3],this.toggleCoverAnimations(!0,0),o=this.initSignalController.renew(),e.abrupt("return",this.tileInitTween.playScaleUpToCurrentAnimation(o,t,i,a,r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"playSelectAnim",value:(w=t(n().mark((function e(){var t,i,a,r,o,s,l,u,c=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:.3,i=c.length>1&&void 0!==c[1]&&c[1],a=c.length>2&&void 0!==c[2]&&c[2],this.selectParticleSystem.node.active=!0,this.tileHighlightTween.getIsShowing()||(r=this.highlightSignalController.renew(),this.tileHighlightTween.startGlowAnimation(r,t)),this.abortAllMovementAnimations(),o=this.selectSignalController.renew(),s=[this.tileSelectTween.startSelectAnimation(o,i,a,t)],this.tile.isHidden&&this.tileFlipTween.getIsHidingBackground()&&(l=this.flipSignalController.renew(),u=this.tileFlipTween.startShowBackgroundAnimation(l,.2),s.push(u)),e.next=11,Promise.all(s);case 11:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"playUnselectAnim",value:(S=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:.3,this.selectParticleSystem.node.active=!1,this.tileHighlightTween.getIsShowing()&&(i=this.highlightSignalController.renew(),this.tileHighlightTween.stopGlowAnimation(i,t)),this.abortAllMovementAnimations(),a=this.selectSignalController.renew(),r=[this.tileSelectTween.startUnselectAnimation(a,t)],this.tile.isHidden&&!this.tileFlipTween.getIsHidingBackground()&&(o=this.flipSignalController.renew(),s=this.tileFlipTween.startHideBackgroundAnimation(o,.2),r.push(s)),e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"playShuffleAnim",value:(b=t(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playTileStopHintAnim(),i=this.shuffleSignalController.renew(),e.next=4,this.tileShuffleTween.playShuffleAnimation(i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"playTileShowHintAnim",value:(m=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tileHintTween.getIsRunning()){e.next=2;break}return e.abrupt("return");case 2:t=this.hintSignalController.renew(),this.tileHintTween.startHintAnimation(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"playTileStopHintAnim",value:(g=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tileHintTween.getIsRunning()){e.next=2;break}return e.abrupt("return");case 2:t=this.hintSignalController.renew(),this.tileHintTween.stopHintAnimation(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"toggleTargetTile",value:function(e){var t=this.targetSignalController.renew();e?this.tileTargetTween.playShowAnimation(t):this.tileTargetTween.playHideAnimation(t)}},{key:"toggleHiddenTile",value:function(e){var t=this.flipSignalController.renew();e?this.tileFlipTween.startHideBackgroundAnimation(t,0):this.tileFlipTween.startShowBackgroundAnimation(t,0)}},{key:"playTileShineAnim",value:(v=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.shineSignalController.renew(),this.attachShadow(),this.toggleCoverAnimations(!0,.2),e.abrupt("return",this.tileShineTween.startShineAnimation(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"playTileCollectAnim",value:(y=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.collectSignalController.renew(),this.attachShadow(),this.toggleCoverAnimations(!0,.2),e.abrupt("return",this.tileCollectTween.startAnimation(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"playTileUndoAnim",value:(f=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.undoSignalController.renew(),this.tileUndoTween.playUndoAnimation(t);case 2:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"playTileShakeAnim",value:(p=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.abortAllMovementAnimations(),t=this.shakeSignalController.renew(),i=this.tileSelectTween.getCurrentSelectedPosition(),this.tileShakeTween.playShakeAnimation(t,i);case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"playTileNudgeAnim",value:(d=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.nudgeSignalController.renew(),i=this.tileSelectTween.getCurrentSelectedPosition(),this.tileNudgeTween.startNudgeAnimation(t,i);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"abortTileNudgeAnim",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.nudgeSignalController.abort(),this.tileNudgeTween.reset();case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"playTileMoveToMatchPosition",value:(l=t(n().mark((function e(t,i,a){var r,o,s,l,u,c,h,d;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playTileStopHintAnim(),this.tile.inputHandler.disableInteraction(),this.abortTileNudgeAnim(),this.abortAllMovementAnimations(),this.attachShadow(),this.tileHighlightTween.getIsShowing()&&(r=this.highlightSignalController.renew(),this.tileHighlightTween.stopGlowAnimation(r,.3)),this.tile.isHidden&&this.tileFlipTween.getIsHidingBackground()!==this.tileFlipTween.getIsRunning()&&(o=this.flipSignalController.renew(),this.tileFlipTween.setIsHidingBackground(!0),this.tileFlipTween.startShowBackgroundAnimation(o,.2,!1)),s=this.tile.getTileSize(),l=1.2*s.x,u=re(i.x+l*a,t.y,0),c=.5*s.x,h=re(t.x+c*a,t.y,0),d=z(this.tile.node).to(.28,{position:u},{easing:"sineOut"}).to(.15,{position:h},{easing:"sineOut"}),e.next=16,Ke.runTweenAsync(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"playTileDestroyingAnim",value:(s=t(n().mark((function e(t,i){var a,r,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.tile.getTileSizeScale(),r=z(this.tile.node).delay(.4).to(.15,{scale:new U(.7*a.x,.7*a.y,1)},{easing:"quartInOut"}),o=.35*this.tile.getTileSize().x,s=z(this.tile.node).delay(.43).to(.1,{position:new U(t.x+o*i,t.y,0)},{easing:"linear"}),l=z(this.tileOpacity).delay(.55).to(.15,{opacity:0},{easing:"cubicOut"}),e.next=7,Promise.all([Ke.runTweenAsync(r),Ke.runTweenAsync(l),Ke.runTweenAsync(s)]);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"abortAllMovementAnimations",value:function(){this.shakeSignalController.abort(),this.selectSignalController.abort(),this.initSignalController.abort()}},{key:"resetTileAnimation",value:function(){this.attachShadow(),this.hintSignalController.abort(),this.shakeSignalController.abort(),this.selectSignalController.abort(),this.coverSignalController.abort(),this.undoSignalController.abort(),this.highlightSignalController.abort(),this.shuffleSignalController.abort(),this.nudgeSignalController.abort(),this.targetSignalController.abort(),this.flipSignalController.abort(),this.shineSignalController.abort(),this.tileSelectTween.reset(),this.tileFlipTween.reset(),this.tileNudgeTween.reset(),this.tileHintTween.reset(),this.tileCoverTween.reset(),this.tileHighlightTween.reset(),this.tileInitTween.reset(),this.tileTargetTween.reset(),this.tileShineTween.reset(),this.selectParticleSystem.resetSystem(),this.selectParticleSystem.node.active=!1}}]),E}(E)).prototype,"tileUITransform",[gy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Py=u(Ay.prototype,"background",[my],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),By=u(Ay.prototype,"tileOpacity",[by],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ny=u(Ay.prototype,"shadowOpacity",[Sy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy=u(Ay.prototype,"overlayOpacity",[wy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dy=u(Ay.prototype,"selectedOverlayOpacity",[ky],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fy=u(Ay.prototype,"targetOverlayOpacity",[Ty],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zy=u(Ay.prototype,"hintOverlayOpacity",[Cy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),My=u(Ay.prototype,"hintBorderOpacity",[Ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uy=u(Ay.prototype,"selectParticleSystem",[Ly],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gy=u(Ay.prototype,"hintHighlight",[Iy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hy=u(Ay.prototype,"hidden",[xy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ry=Ay))||Ry);b._RF.pop(),b._RF.push({},"20047S5wz1O65V4b+kQfNWx","Tile",void 0);var Ev,Lv,Iv,xv,Rv,Av=w.ccclass,_v=w.property,Pv=(Wy=Av("Tile"),qy=_v(x),jy=_v(x),Ky=_v(x),Yy=_v(x),Jy=_v(x),Zy=_v(x),Qy=_v(x),Xy=_v(x),$y=_v(x),ev=_v(x),tv=_v(x),nv=_v(x),iv=_v(x),av=_v(ae),Wy((sv=u((ov=function(e){i(f,e);var s,u,d,p=a(f);function f(){var e;r(this,f);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=p.call.apply(p,[this].concat(n)),c(e,"item",sv,h(e)),c(e,"background",lv,h(e)),c(e,"shadow",uv,h(e)),c(e,"overlay",cv,h(e)),c(e,"hiddenBackground",hv,h(e)),c(e,"targetOverlay",dv,h(e)),c(e,"hintOverlay",pv,h(e)),c(e,"hintBorder",fv,h(e)),c(e,"hintMask",yv,h(e)),c(e,"hintGlow",vv,h(e)),c(e,"selectOverlay",gv,h(e)),c(e,"selectBorder",mv,h(e)),c(e,"selectMask",bv,h(e)),c(e,"selectSpark",Sv,h(e)),e.id="",e.skinIdx=-1,e.gridPos=new Q(0,0),e.worldPos=new Q(0,0),e.state=lt.PRELOADING,e.isUncovered=!0,e.isGolden=!1,e.isTarget=!1,e.isHidden=!1,e.isArtifact=!1,e.depth=0,e.layer=0,e.tileSize=new Q(0,0),e.tileSizeScale=new U(0,0,0),e}return o(f,[{key:"getTileSize",value:function(){return this.tileSize}},{key:"getTileSizeScale",value:function(){return this.tileSizeScale}},{key:"__preload",value:function(){this.initializeComponents(),this.setupEventListeners(),this._init(),this.validateRequiredComponents()}},{key:"initializeComponents",value:function(){this.uiTransform=this.node.getComponent(R),this.animationHandler=this.getComponent(Cv),this.inputHandler=this.getComponent(iy),this.widgets=this.getComponentsInChildren(H)}},{key:"setupEventListeners",value:function(){var e=this;this.node.scene.on(ny.ALL_TILE_READY,(function(){e.state=lt.ALREADY}),this)}},{key:"_init",value:function(){this.node.scale=new U(0,0,0)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onLoad",value:function(){}},{key:"setSize",value:function(e,t){this.tileSize.set(e,t),this.tileSizeScale.set(e/ut.SIZE.WIDTH,t/ut.SIZE.HEIGHT,1),this.node.setScale(this.tileSizeScale);var n,i=l(this.widgets);try{for(i.s();!(n=i.n()).done;){var a=n.value,r=a.node.active;a.node.active=!0,a.updateAlignment(),a.node.active=r}}catch(e){i.e(e)}finally{i.f()}}},{key:"setInitSize",value:function(e,t){this.setSize(e,t)}},{key:"addSizeAmount",value:function(e,t){var n=this.uiTransform.contentSize,i=n.x+e,a=n.y+t;this.setSize(i,a)}},{key:"getSize",value:function(){return new Q(this.uiTransform.width,this.uiTransform.height)}},{key:"addOffset",value:function(e,t){var n=this.node.position,i=n.x,a=n.y,r=n.z;this.node.position=new U(i+e,a+t,r)}},{key:"setDepth",value:function(e){this.depth=e}},{key:"getDepth",value:function(){return this.depth}},{key:"setLayer",value:function(e){this.layer=e}},{key:"getLayer",value:function(){return this.layer}},{key:"getCurrentTileConfig",value:function(){return{id:this.id,skinProp:{skinIdx:this.skinIdx,isHidden:this.isHidden,isTarget:this.isTarget},gridPos:this.gridPos,worldPos:this.worldPos,layer:this.layer,depth:this.depth,size:{width:this.tileSize.x,height:this.tileSize.y}}}},{key:"isTileChoosing",value:function(){return this.state===lt.CHOOSING}},{key:"initializeTile",value:function(e){this.id=e.id,this.skinIdx=e.skinProp.skinIdx,this.isHidden=e.skinProp.isHidden,this.isTarget=e.skinProp.isTarget,this.gridPos=e.gridPos,this.worldPos=e.worldPos,this.setLayer(e.layer),this.setDepth(e.depth),this.setInitSize(e.size.width,e.size.height)}},{key:"handleInitializeTile",value:function(){this.inputHandler.enableInteraction()}},{key:"resetSkinIdx",value:function(e){this.isGolden&&e!==ct&&(this.isGolden=!1,this.background.node.active=!0),this.isHidden&&(this.isHidden=!1,this.animationHandler.toggleHiddenTile(!1)),this.isTarget&&(this.isTarget=!1,this.animationHandler.toggleTargetTile(!1)),this.isArtifact||(this.skinIdx=e,this.setItemSprite(De.getTileIcon(e.toString())))}},{key:"setItemSprite",value:function(e){this.item&&e&&(this.item.spriteFrame=e)}},{key:"handleChooseTile",value:(d=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],i=a.length>1&&void 0!==a[1]&&a[1],this.state=lt.CHOOSING,e.next=5,this.animationHandler.playSelectAnim(.3,t,i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handleUnChooseTile",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=lt.ALREADY,e.next=3,this.animationHandler.playUnselectAnim();case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handlePreloadTile",value:function(){this.state=lt.PRELOADING,this.inputHandler.disableInteraction()}},{key:"handleReadyTile",value:function(){this.state=lt.ALREADY,this.inputHandler.enableInteraction()}},{key:"toggleUncover",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3;this.isUncovered=e,this.animationHandler.toggleCoverAnimations(e,t)}},{key:"setUncover",value:function(e){this.isUncovered=e}},{key:"setGolden",value:function(e){this.isGolden=!0,this.skinIdx=ct,this.setItemSprite(e),this.background.node.active=!1}},{key:"setTargetTile",value:function(){this.isTarget=!0,this.animationHandler.toggleTargetTile(!0)}},{key:"setHiddenTile",value:function(){this.isHidden=!0,this.animationHandler.toggleHiddenTile(!0)}},{key:"setArtifactTile",value:function(e){this.isArtifact=!0,this.skinIdx=e,this.setItemSprite(ht.getCurrentArtifactTileSprite(e.toString())),this.overlay.node.active=!1,this.background.node.active=!1,this.shadow.node.active=!1}},{key:"handleTileClicked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isUncovered&&this.node&&this.node.scene.emit(ny.TILE_CLICKED,this,e)}},{key:"handleTileMoving",value:function(){this.isUncovered&&this.node&&this.node.scene.emit(ny.TILE_MOVING,this)}},{key:"handleTileDropped",value:function(){this.isUncovered&&this.node&&this.node.scene.emit(ny.TILE_DROPPED,this)}},{key:"handleTileCoveredClicked",value:function(){!this.isUncovered&&this.node&&this.node.scene.emit(ny.TILE_COVERED_CLICKED,this)}},{key:"swapTileData",value:function(e){var t=this.gridPos,n=this.worldPos,i=this.getDepth(),a=this.getLayer();this.gridPos=e.gridPos,this.worldPos=e.worldPos,this.depth=e.getDepth(),this.layer=e.getLayer(),e.gridPos=t,e.worldPos=n,e.setDepth(i),e.setLayer(a)}},{key:"setBackgroundSprite",value:function(e){this.background&&e&&(this.background.spriteFrame=e)}},{key:"setHiddenBackgroundSprite",value:function(e){this.hiddenBackground&&e&&(this.hiddenBackground.spriteFrame=e)}},{key:"setEffectSprites",value:function(){this.shadow.spriteFrame=De.getEffectSpriteFrame("shadow"),this.overlay.spriteFrame=De.getEffectSpriteFrame("grey"),this.hintBorder.spriteFrame=De.getEffectSpriteFrame("blue-border"),this.hintOverlay.spriteFrame=De.getEffectSpriteFrame("blue"),this.hintMask.spriteFrame=De.getEffectSpriteFrame("blue-border"),this.hintGlow.spriteFrame=De.getEffectSpriteFrame("glow"),this.selectOverlay.spriteFrame=De.getEffectSpriteFrame("green"),this.selectBorder.spriteFrame=De.getEffectSpriteFrame("yellow"),this.selectMask.spriteFrame=De.getEffectSpriteFrame("green"),this.selectSpark.spriteFrame=De.getEffectSpriteFrame("spark"),this.targetOverlay.spriteFrame=De.getEffectSpriteFrame("pink")}},{key:"setGlowShadow",value:function(e){this.shadow.spriteFrame=e?De.getEffectSpriteFrame("shadow-glow"):De.getEffectSpriteFrame("shadow")}},{key:"playShuffleAnim",value:(s=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.animationHandler.playShuffleAnim(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"returnToPool",value:function(){this.resetState(),this.gameScene.gameplay.gameObjects.tilePool.returnTile(this.node)}},{key:"resetState",value:function(){this.node.setScale(U.ZERO),this.id="",this.skinIdx=-1,this.gridPos=new Q(0,0),this.worldPos=new Q(0,0),this.state=lt.PRELOADING,this.isUncovered=!0,this.isGolden=!1,this.isTarget=!1,this.isHidden=!1,this.isArtifact=!1,this.background.node.active=!0,this.overlay.node.active=!0,this.shadow.node.active=!0,this.depth=0,this.layer=0,this.animationHandler.resetTileAnimation(),this.inputHandler.disableInteraction(),se.stopAllByTarget(this.node)}}]),f}(E)).prototype,"item",[qy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lv=u(ov.prototype,"background",[jy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uv=u(ov.prototype,"shadow",[Ky],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cv=u(ov.prototype,"overlay",[Yy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hv=u(ov.prototype,"hiddenBackground",[Jy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dv=u(ov.prototype,"targetOverlay",[Zy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pv=u(ov.prototype,"hintOverlay",[Qy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fv=u(ov.prototype,"hintBorder",[Xy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yv=u(ov.prototype,"hintMask",[$y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vv=u(ov.prototype,"hintGlow",[ev],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gv=u(ov.prototype,"selectOverlay",[tv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=u(ov.prototype,"selectBorder",[nv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bv=u(ov.prototype,"selectMask",[iv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sv=u(ov.prototype,"selectSpark",[av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rv=ov))||rv);b._RF.pop(),b._RF.push({},"93cb2v1gvtJyqaFA2hjUuUU","TilePool",void 0);var Bv=w.ccclass,Nv=w.property,Ov=(Ev=Bv("TilePool"),Lv=Nv(X),Ev((Rv=u((xv=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"tilePrefab",Rv,h(e)),e.pool=[],e}return o(n,[{key:"getTile",value:function(){if(this.pool.length>0){var e=this.pool.pop();e.active=!0;var t=e.getComponent(Pv);return t&&(t.isUncovered=!0),e}var n=$(this.tilePrefab);return n.active=!0,n}},{key:"returnTile",value:function(e){e.removeFromParent(),e.active=!1,this.pool.push(e)}}]),n}(E)).prototype,"tilePrefab",[Lv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iv=xv))||Iv);b._RF.pop(),b._RF.push({},"c7c0fvKOOxEQpTUWke5LCqW","AlignTileManager",void 0);var Dv,Fv,zv,Mv,Uv,Gv=function(){function e(t){r(this,e),this.borders={top:0,bottom:0},this.tileSize={width:0,height:0},this.gridBounds={minX:0,maxX:0,minY:0,maxY:0},this.maxLayer=0,this.layerOfMostTop=0,this.layerOfMostLeft=0,this.gameScene=t}return o(e,[{key:"useParams",value:function(e,t,n,i,a,r,o){this.maxLayer=a,this.layerOfMostTop=r,this.layerOfMostLeft=o,console.log({maxLayer:a,layerOfMostTop:r,layerOfMostLeft:o,minGridPosX:e,maxGridPosX:t,minGridPosY:n,maxGridPosY:i}),this.updateGridBounds(e,t,n,i),this.tileSize=this.calculateTileSize(),console.log("tileSize",{tileSize:this.tileSize,maxLayer:a,layerOfMostTop:r,layerOfMostLeft:o})}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getTopBotBorder",value:function(){return{top:this.borders.top,bottom:this.borders.bottom}}},{key:"getTilePosition",value:function(e,t,n){var i=e-(this.gridBounds.minX+this.gridBounds.maxX)/2,a=t-(this.gridBounds.minY+this.gridBounds.maxY)/2,r=-n*Xf+this.layerOfMostLeft*Xf/2,o=n*$f-this.layerOfMostTop*$f/2,s=i*Yf,l=-a*Jf;return{x:i*this.tileSize.width+s+r,y:-a*this.tileSize.height+l+o}}},{key:"updateBorders",value:function(){var e=this.gameScene.gameplay;this.borders.top=e.uiManager.header.height,this.borders.bottom=e.uiManager.footer.height+Ye.getBannerAdsHeight()}},{key:"updateGridBounds",value:function(e,t,n,i){this.gridBounds={minX:e,maxX:t,minY:n,maxY:i}}},{key:"calculateTileSize",value:function(){var e=this.prepareBoardConfig(),t=this.calculateInitialTileSize(e),n=t.width,i=t.height,a=n*Qf;return a<i?{width:n,height:a}:{width:i/Qf,height:i}}},{key:"prepareBoardConfig",value:function(){var e=this.gridBounds.maxY-this.gridBounds.minY,t=this.gridBounds.maxX-this.gridBounds.minX,n=t*Yf,i=e*Jf,a=100+this.layerOfMostLeft*Xf;return{boardMaxCoordX:t,boardMaxCoordY:e,totalPaddingX:n,totalPaddingY:i,remainingBoardWidth:this.getRemainingBoardWidth(a),remainingBoardHeight:this.getRemainingBoardHeight()}}},{key:"calculateInitialTileSize",value:function(e){var t=e.boardMaxCoordX,n=e.boardMaxCoordY,i=e.totalPaddingX,a=e.totalPaddingY,r=e.remainingBoardWidth,o=e.remainingBoardHeight,s=Zf,l=s*Qf;return{width:s=Math.min((r-i)/(t+1),s),height:l=Math.min((o-a)/(n+1),l)}}},{key:"getRemainingBoardWidth",value:function(e){return this.gameScene.gameplay.gameObjects.getBoardGameObjectsWidth()-e}},{key:"getRemainingBoardHeight",value:function(){var e=this.gameScene.gameplay,t=e.gameObjects,n=.6*e.uiManager.header.height;return t.getBoardGameObjectsHeight()-this.layerOfMostTop*$f-n}}]),e}();b._RF.pop(),b._RF.push({},"75ad9uPflhLL4N96NmHF2Sk","GameObjects",void 0);var Hv=w.ccclass,Vv=w.property,Wv=(Dv=Hv("GameObjects"),Fv=Vv(Ov),Dv((Uv=u((Mv=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"tilePool",Uv,h(e)),e.minColTiles=0,e.maxColTiles=0,e.minRowTiles=0,e.maxRowTiles=0,e.maxLayer=0,e.totalTiles=0,e.skinIndexes=[],e.tiles=[],e.uiTransform=null,e}return o(n,[{key:"__preload",value:function(){this.initManagers()}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(R)}},{key:"initManagers",value:function(){this.alignManager=new Gv(this.gameScene)}},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"spawnObjects",value:function(e){this.sortDataAndCreateTiles(e)}},{key:"spawnGuideObjects",value:function(e){this.sortDataAndCreateGuideTiles(e)}},{key:"respawnTile",value:function(e){var t=this.createTileInstance();if(!t)return null;t.setPosition(e.worldPos.x,e.worldPos.y,0);var n=t.getComponent(Pv);if(!n)return null;var i=De.getTileIcon(e.skinProp.skinIdx.toString());i&&n.setItemSprite(i);var a=De.getCurrentTileBackgroundSprite();return n.setBackgroundSprite(a),n.setHiddenBackgroundSprite(De.getCurrentTileHiddenSprite()),n.setEffectSprites(),n.initializeTile(e),this.tiles.push(n),this.node.scene.emit(ny.TILE_CREATED,{tile:n,layer:e.layer}),n}},{key:"sortDataAndCreateTiles",value:function(e){var t=this.extractLevel(e);this.calculateSkinIndexes(),this.sortDepth(t);for(var n=0,i=0;i<=this.maxLayer;i++){var a=t.get(i);if(a)for(var r=0;r<a.length;r++){var o=a[r],s=this.skinIndexes.pop();this.spawnTile(o,n,i,s),n++}}}},{key:"sortDataAndCreateGuideTiles",value:function(e){var t=this.extractLevel(e);this.sortDepth(t);for(var n=0,i=0;i<=this.maxLayer;i++){var a=t.get(i);if(a)for(var r=0;r<a.length;r++){var o=a[r];this.spawnTile(o,n,i,o.skinIdx),n++}}}},{key:"extractLevel",value:function(e){this.minColTiles=Number.MAX_VALUE,this.maxColTiles=Number.NEGATIVE_INFINITY,this.minRowTiles=Number.MAX_VALUE,this.maxRowTiles=Number.NEGATIVE_INFINITY,this.maxLayer=-1,this.totalTiles=0,this.skinIndexes=[];var t,n=-1,i=-1,a=new Map,r=l(e.layers);try{for(r.s();!(t=r.n()).done;){var o,s=t.value,u=s.index,c=l(s.tiles);try{for(c.s();!(o=c.n()).done;){var h=o.value;h.x<=this.minColTiles&&(this.minColTiles=h.x,u>i&&(i=u)),h.x>this.maxColTiles&&(this.maxColTiles=h.x),h.y<=this.minRowTiles&&(this.minRowTiles=h.y,u>n&&(n=u)),h.y>this.maxRowTiles&&(this.maxRowTiles=h.y),this.totalTiles+=1;var d=a.get(u);if(void 0===d){var p=[h];a.set(u,p)}else d.push(h)}}catch(e){c.e(e)}finally{c.f()}u>this.maxLayer&&(this.maxLayer=u)}}catch(e){r.e(e)}finally{r.f()}this.alignManager.updateBorders();var f=this.node.getComponent(H);if(f){var y=this.alignManager.getTopBotBorder(),v=y.top,g=y.bottom;f.top=v,f.bottom=g,f.updateAlignment(),this.node.scene.emit(ny.GAMEOBJECT_WIDGET_UPDATE,v,g,this.node.position,this.node.worldPosition)}return this.alignManager.useParams(this.minColTiles,this.maxColTiles,this.minRowTiles,this.maxRowTiles,this.maxLayer,n,i),a}},{key:"sortDepth",value:function(e){for(var t=0;t<=this.maxLayer;t++){var n=e.get(t);n&&(n.sort((function(e,t){return e.x+e.y===t.x+t.y?t.x-e.x:t.x+t.y-(e.x+e.y)})),n.reverse())}}},{key:"calculateSkinIndexes",value:function(){var e=at.getSeedByLevel();if(void 0!==e&&e.length>0)this.skinIndexes=e;else{this.skinIndexes=[];for(var t=Math.floor(this.totalTiles/2),n=["bamboo","characters","dots","winds","dragons"],i={bamboo:0,characters:0,dots:0,winds:0,dragons:0},a=0;a<t;a++){var r=n[a%n.length],o=dt[r],s=i[r]%o.length;this.skinIndexes.push(o[s]),this.skinIndexes.push(o[s]),i[r]++}console.log("Calculate Skin Indexes",{totalTiles:this.totalTiles,totalPairs:t,skinIndexes:v(this.skinIndexes)}),Ludex.Utils.Array.shuffle(this.skinIndexes)}}},{key:"spawnTile",value:function(e,t,n,i){var a=this.alignManager.getTileSize(),r=this.alignManager.getTilePosition(e.x,e.y,n),o=r.x,s=r.y,l=new Q(o,s),u=this.createTileInstance();if(u){u.setPosition(l.x,l.y,0);var c=u.getComponent(Pv);if(c){var h=De.getTileIcon(i.toString()),d=De.getCurrentTileBackgroundSprite();c.setBackgroundSprite(d),c.setHiddenBackgroundSprite(De.getCurrentTileHiddenSprite()),c.setEffectSprites(),h?c.setItemSprite(h):console.warn("Tile sprite not found for skin index: ".concat(i)),
//! tileComponent.id = tile.skinIdx
c.initializeTile({id:"".concat(n,"-").concat(e.x,"-").concat(e.y),skinProp:{skinIdx:i,isHidden:!1,isTarget:!1},gridPos:new Q(e.x,e.y),worldPos:l,layer:n,depth:t,size:{width:a.width,height:a.height}}),this.tiles.push(c),this.node.scene.emit(ny.TILE_CREATED,{tile:c,layer:n})}}}},{key:"createTileInstance",value:function(){var e=this.tilePool.getTile();return e instanceof P?(this.node.addChild(e),e):null}},{key:"getShuffleConfig",value:function(){for(var e=_.getVisibleSize().width,t=this.maxRowTiles,n=this.maxColTiles,i=this.minRowTiles,a=this.minColTiles,r=this.alignManager.getTileSize().width,o=1.2,s=t-i+1,l=e-s*(r+2)*o-10;l<0&&o>1;)l=e-s*(r+2)*(o=parseFloat((o-.01).toFixed(2)))-10;var u=this.alignManager.getRemainingBoardHeight(),c=t-i+1,h=c*Jf+c*r;return{maxRowTiles:t,maxColTiles:n,minRowTiles:i,minColTiles:a,bonusSpace:2,maxScale:o,offsetHeight:Math.min((u-h)/2/c,5)}}},{key:"getBoardGameObjectsWidth",value:function(){var e;this.uiTransform||(this.uiTransform=this.getComponent(R));var t=_.getVisibleSize().width,n=(null===(e=this.uiTransform)||void 0===e?void 0:e.width)||t;return Math.max(t,n)}},{key:"getBoardGameObjectsHeight",value:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(R)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||_.getVisibleSize().height}}]),n}(E)).prototype,"tilePool",[Fv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zv=Mv))||zv);b._RF.pop(),b._RF.push({},"1dbd0oP1L5HP7sKvcwP7rDQ","GameMode",void 0);var qv,jv,Kv,Yv,Jv,Zv,Qv,Xv,$v,eg,tg,ng=function(e){return e.SINGLE="single",e.CHALLENGE_FRIEND="challenge-friend",e.TOURNAMENT="tournament",e.SHARE_INVITE="share-invite",e.MATCHING_GROUP="matching-group",e.DAILY_CHALLENGE="daily-challenge",e.JOURNEY="journey",e}(ng||{});b._RF.pop(),b._RF.push({},"6c472ABbYFGy5TSFcApW8q0","EffectPool",void 0);var ig,ag,rg,og,sg,lg,ug,cg,hg,dg=w.ccclass,pg=w.property,fg=(qv=dg("EffectPool"),jv=pg(X),Kv=pg(X),Yv=pg(X),Jv=pg(X),qv((Xv=u((Qv=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"blossomExplosionPrefab",Xv,h(e)),c(e,"bambooExplosionPrefab",$v,h(e)),c(e,"popupScorePrefab",eg,h(e)),c(e,"shuffleExplosionPrefab",tg,h(e)),e.blossomPool=[],e.bambooPool=[],e.popupScorePool=[],e.shufflePool=[],e.blossomCount=0,e.bambooCount=0,e.popupScoreCount=0,e.shuffleCount=0,e}return o(n,[{key:"getBlossomExplosionEffect",value:function(){if(this.blossomPool.length>0){var e=this.blossomPool.pop();return e.active=!0,console.log("reuse BlossomEffect"),e}var t=$(this.blossomExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(0),t.active=!0,this.blossomCount++,t}},{key:"returnBlossomExplosionEffect",value:function(e){e.active=!1,this.blossomPool.push(e)}},{key:"getBambooExplosionEffect",value:function(){if(this.bambooPool.length>0){var e=this.bambooPool.pop();return e.active=!0,console.log("reuse BambooEffect"),e}var t=$(this.bambooExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+1),t.active=!0,this.bambooCount++,t}},{key:"returnBambooExplosionEffect",value:function(e){e.active=!1,this.bambooPool.push(e)}},{key:"getPopupScoreEffect",value:function(){if(this.popupScorePool.length>0){var e=this.popupScorePool.pop();return e.active=!0,console.log("reuse PopupScoreEffect"),e}var t=$(this.popupScorePrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+this.bambooCount+1),t.active=!0,this.popupScoreCount++,t}},{key:"returnPopupScoreEffect",value:function(e){e.active=!1,this.popupScorePool.push(e)}},{key:"getShuffleExplosionEffect",value:function(){if(this.shufflePool.length>0){var e=this.shufflePool.pop();return e.active=!0,console.log("reuse ShuffleEffect"),e}var t=$(this.shuffleExplosionPrefab);return this.node.addChild(t),t.setSiblingIndex(this.blossomCount+this.bambooCount+this.popupScoreCount+1),t.active=!0,this.shuffleCount++,t}},{key:"returnShuffleExplosionEffect",value:function(e){e.active=!1,this.shufflePool.push(e)}}]),n}(E)).prototype,"blossomExplosionPrefab",[jv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$v=u(Qv.prototype,"bambooExplosionPrefab",[Kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg=u(Qv.prototype,"popupScorePrefab",[Yv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tg=u(Qv.prototype,"shuffleExplosionPrefab",[Jv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv=Qv))||Zv);b._RF.pop(),b._RF.push({},"556ddWVDzZLFZrjY8a9r9K+","BlossomExplosion",void 0);var yg,vg,gg,mg,bg,Sg,wg,kg=w.ccclass,Tg=w.property,Cg=(ig=kg("BlossomExplosion"),ag=Tg(P),rg=Tg(P),og=Tg(P),ig((ug=u((lg=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"aura1",ug,h(e)),c(e,"aura2",cg,h(e)),c(e,"aura3",hg,h(e)),e}return o(d,[{key:"onLoad",value:function(){this._aura1Opacity=this.aura1.getComponent(N),this._aura2Opacity=this.aura2.getComponent(N),this._aura3Opacity=this.aura3.getComponent(N),this._aura1Opacity.opacity=0,this._aura2Opacity.opacity=0,this._aura3Opacity.opacity=0,this.particaleSystem=this.node.getComponentsInChildren(ae)}},{key:"runAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l(this.particaleSystem);try{for(t.s();!(i=t.n()).done;)i.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}return a=[],r=z(this._aura1Opacity).set({opacity:102}).to(.15,{opacity:204}).to(.3,{opacity:0}),o=z(this._aura2Opacity).set({opacity:80}).to(.15,{opacity:150}).delay(.1).to(.25,{opacity:0}),s=z(this._aura3Opacity).set({opacity:80}).to(.15,{opacity:150}).to(.3,{opacity:0}),u=z(this.aura1).set({scale:new U(.35,.35,1)}).to(.2,{scale:new U(.5,.5,1)}),c=z(this.aura2).set({scale:new U(.2,.2,1)}).to(.2,{scale:new U(.35,.35,1)}).to(1,{scale:new U(1,1,1)}),h=z(this.aura3).set({scale:new U(.5,.5,1)}).to(.2,{scale:new U(.75,.75,1)}).to(1,{scale:new U(1.25,1.25,1)}),a.push(Ke.runTweenAsync(r)),a.push(Ke.runTweenAsync(o)),a.push(Ke.runTweenAsync(s)),a.push(Ke.runTweenAsync(u)),a.push(Ke.runTweenAsync(c)),a.push(Ke.runTweenAsync(h)),e.next=17,Promise.all(a);case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"aura1",[ag],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cg=u(lg.prototype,"aura2",[rg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hg=u(lg.prototype,"aura3",[og],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sg=lg))||sg);b._RF.pop(),b._RF.push({},"3005amPw6VHno+aEFYFe7wW","ShuffleExplosion",void 0);var Eg,Lg,Ig,xg,Rg,Ag,_g,Pg,Bg,Ng,Og,Dg,Fg,zg=w.ccclass,Mg=w.property,Ug=Ludex.Utils.Time,Gg=(yg=zg("ShuffleExplosion"),vg=Mg(N),gg=Mg(N),yg((Sg=u((bg=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"aura1",Sg,h(e)),c(e,"aura2",wg,h(e)),e}return o(d,[{key:"onLoad",value:function(){this.aura1.opacity=0,this.aura2.opacity=0,this.aura1.node.setScale(new U(0,0,1)),this.aura2.node.setScale(new U(0,0,1)),this.particaleSystem=this.node.getComponentsInChildren(ae)}},{key:"runAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h,d,p,f=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=.4,i=Ug.sleepAsync(2e3),a=Ug.sleepAsync(400).then((function(){var e,t=l(f.particaleSystem);try{for(t.s();!(e=t.n()).done;)e.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}})),r=z(this.aura1.node).set({scale:new U(0,0,0)}).delay(t).to(.8,{scale:new U(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new U(1,1,1)},{easing:"cubicIn"}),o=z(this.aura1).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),s=z(this.aura2.node).set({scale:new U(0,0,0)}).delay(t).to(.8,{scale:new U(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new U(1,1,1)},{easing:"cubicIn"}),u=z(this.aura2).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),c=Ke.runTweenAsync(r),h=Ke.runTweenAsync(o),d=Ke.runTweenAsync(s),p=Ke.runTweenAsync(u),e.next=14,Promise.all([i,c,h,d,p,a]);case 14:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"aura1",[vg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wg=u(bg.prototype,"aura2",[gg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mg=bg))||mg);b._RF.pop(),b._RF.push({},"9b6e5WQHrZGy5ituukEchCN","PopupBlock",void 0);var Hg,Vg,Wg,qg,jg,Kg,Yg,Jg,Zg,Qg,Xg,$g,em,tm=w.ccclass,nm=w.property,im=(Eg=tm("PopupBlock"),Lg=nm(q),Ig=nm(Bd),xg=nm(P),Rg=nm(k),Eg((Pg=u((_g=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"notificationLabel",Pg,h(e)),c(e,"notificationLocalize",Bg,h(e)),c(e,"parentNode",Ng,h(e)),c(e,"animationComponent",Og,h(e)),c(e,"showClipName",Dg,h(e)),c(e,"widthBound",Fg,h(e)),e}return o(n,[{key:"runShowBlockPopup",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=_.getVisibleSize().width,r=ee.clamp(e.x,a/2-this.widthBound/2,-a/2+this.widthBound/2);this.node.setPosition(new U(r,e.y,e.z)),this.parentNode.active=!0,this.runAnimation(this.showClipName),this.notificationLocalize.key=t?"lockedByAboveTiles":"lockedByLeftAndRight",this.animationComponent.on(k.EventType.FINISHED,(function(){i(),n.animationComponent.off(k.EventType.FINISHED)}))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),n}(E)).prototype,"notificationLabel",[Lg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bg=u(_g.prototype,"notificationLocalize",[Ig],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ng=u(_g.prototype,"parentNode",[xg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Og=u(_g.prototype,"animationComponent",[Rg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dg=u(_g.prototype,"showClipName",[nm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"PopupBlockShow"}}),Fg=u(_g.prototype,"widthBound",[nm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 854}}),Ag=_g))||Ag);b._RF.pop(),b._RF.push({},"d2b01I9yhhMz4CRKN9ADxGc","AccumulatePopupScore",void 0);var am,rm,om,sm,lm,um,cm,hm=w.ccclass,dm=w.property,pm=(Hg=hm("AccumulatePopupScore"),Vg=dm(q),Wg=dm(M),qg=dm(M),jg=dm(M),Kg=dm(M),Hg((Zg=u((Jg=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"accumulatedScoreLabel",Zg,h(e)),c(e,"lesserBaseColor",Qg,h(e)),c(e,"lesserStrokeColor",Xg,h(e)),c(e,"greaterBaseColor",$g,h(e)),c(e,"greaterStrokeColor",em,h(e)),e}return o(n,[{key:"setScore",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.accumulatedScoreLabel.string="+".concat(e.toString()),t?(this.accumulatedScoreLabel.color=this.greaterBaseColor,this.accumulatedScoreLabel.outlineColor=this.greaterStrokeColor):(this.accumulatedScoreLabel.color=this.lesserBaseColor,this.accumulatedScoreLabel.outlineColor=this.lesserStrokeColor)}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),n}(E)).prototype,"accumulatedScoreLabel",[Vg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qg=u(Jg.prototype,"lesserBaseColor",[Wg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,255,255)}}),Xg=u(Jg.prototype,"lesserStrokeColor",[qg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,0,255)}}),$g=u(Jg.prototype,"greaterBaseColor",[jg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,0,255)}}),em=u(Jg.prototype,"greaterStrokeColor",[Kg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(255,255,0,255)}}),Yg=Jg))||Yg);b._RF.pop(),b._RF.push({},"911aaEDDJxEAqVF2fpI2n1a","EncouragePopupScore",void 0);var fm,ym,vm,gm,mm,bm,Sm,wm,km,Tm,Cm=w.ccclass,Em=w.property,Lm=(am=Cm("EncouragePopupScore"),rm=Em(Bd),om=Em(q),am((um=u((lm=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"localize",um,h(e)),c(e,"scoreLabel",cm,h(e)),e}return o(n,[{key:"setScore",value:function(e,t){this.scoreLabel.string="+".concat(e.toString()),this.localize.key=t}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),n}(E)).prototype,"localize",[rm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cm=u(lm.prototype,"scoreLabel",[om],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sm=lm))||sm);b._RF.pop(),b._RF.push({},"becf1XX8m9DWL2DtyN+gENs","PopupScore",void 0);var Im,xm,Rm,Am,_m,Pm,Bm,Nm=w.ccclass,Om=w.property,Dm=(fm=Nm("PopupScore"),ym=Om(k),vm=Om(pm),gm=Om(Lm),fm((Sm=u((bm=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"animationComponent",Sm,h(e)),c(e,"accumulatePopupScore",wm,h(e)),c(e,"encouragePopupScore",km,h(e)),c(e,"showClipName",Tm,h(e)),e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"runShowScorePopup",value:function(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=t>=3;this.accumulatePopupScore.setScore(e,r);var o=t%5==0;if(o){this.encouragePopupScore.node.active=!0;var s=t/5,l=this.getEncouragePopupScore(s),u=this.getEncouragePopupSound(s);Ge.playSound(u),this.encouragePopupScore.setScore(n,l)}else this.encouragePopupScore.node.active=!1;this.runAnimation(this.showClipName),this.animationComponent.on(k.EventType.FINISHED,(function(){a(),i.animationComponent.off(k.EventType.FINISHED)}))}},{key:"getEncouragePopupScore",value:function(e){switch(e){case 1:return"Good";case 2:return"Great";case 3:return"Awesome";default:return"Amazing"}}},{key:"getEncouragePopupSound",value:function(e){switch(e){case 1:return He.ENCOURAGE_GOOD;case 2:return He.ENCOURAGE_GREAT;case 3:return He.ENCOURAGE_AWESOME;default:return He.ENCOURAGE_AMAZING}}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),n}(E)).prototype,"animationComponent",[ym],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wm=u(bm.prototype,"accumulatePopupScore",[vm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),km=u(bm.prototype,"encouragePopupScore",[gm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tm=u(bm.prototype,"showClipName",[Om],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"PopupScoreShow"}}),mm=bm))||mm);b._RF.pop(),b._RF.push({},"1a5d7W8yYxJuL/wRCNNmZF5","EffectManager",void 0);var Fm,zm=w.ccclass,Mm=w.property,Um=(Im=zm("EffectManager"),xm=Mm(fg),Rm=Mm(im),Im((Pm=u((_m=function(e){i(p,e);var s,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"effectPool",Pm,h(e)),c(e,"popupBlock",Bm,h(e)),e}return o(p,[{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.node.scene.on(ny.START_SHUFFLE,this.playShuffleExplosionEffect,this)}},{key:"playTileMatchEffect",value:function(e,t,n,i){this.playMatchExplosionEffect(n,e),this.playPopupScoreEffect(e,t,n,i)}},{key:"playMatchExplosionEffect",value:function(e,t){var n,i,a=this,r=null;if(e<3)(r=null===(n=this.effectPool)||void 0===n?void 0:n.getBambooExplosionEffect())&&(r.setWorldPosition(t),null===(i=r.getComponent(Cg))||void 0===i||i.runAnimation());else if(e>=3){var o,s;if(r=null===(o=this.effectPool)||void 0===o?void 0:o.getBlossomExplosionEffect())r.setWorldPosition(t),null===(s=r.getComponent(Cg))||void 0===s||s.runAnimation()}ro.vibrate(60),this.scheduleOnce((function(){var t;if(e<3)null===(t=a.effectPool)||void 0===t||t.returnBambooExplosionEffect(r);else if(e>=3){var n;null===(n=a.effectPool)||void 0===n||n.returnBlossomExplosionEffect(r)}}),2)}},{key:"playPopupScoreEffect",value:function(e,t,n,i){var a,r=this,o=null;if(o=null===(a=this.effectPool)||void 0===a?void 0:a.getPopupScoreEffect()){o.setWorldPosition(e);var s=o.getComponent(Dm);s&&s.runShowScorePopup(t,n,i,(function(){var e;null===(e=r.effectPool)||void 0===e||e.returnPopupScoreEffect(o)}))}}},{key:"playShuffleExplosionEffect",value:(u=t(n().mark((function e(){var t,i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===(t=this.effectPool)||void 0===t?void 0:t.getShuffleExplosionEffect(),ro.vibrate(200),!i){e.next=7;break}return i.setPosition(new U(0,0,0)),e.next=6,null===(a=i.getComponent(Gg))||void 0===a?void 0:a.runAnimation();case 6:null===(r=this.effectPool)||void 0===r||r.returnShuffleExplosionEffect(i);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"playTileBlockedEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.popupBlock&&this.popupBlock.runShowBlockPopup(e,t),ro.vibrate(100)}},{key:"playGameOverEffect",value:(s=t(n().mark((function e(t){var i,a,r,o=this,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=s.length>1&&void 0!==s[1]?s[1]:.8,a=l(t);try{for(a.s();!(r=a.n()).done;)r.value.animationHandler.toggleCoverAnimations(!1,i)}catch(e){a.e(e)}finally{a.f()}return pt.setBlockInput(!0),e.next=6,new Promise((function(e){o.scheduleOnce((function(){pt.setBlockInput(!1),e(!0)}),i)}));case 6:Ge.playSound(He.YOU_LOSE);case 7:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})}]),p}(E)).prototype,"effectPool",[xm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bm=u(_m.prototype,"popupBlock",[Rm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Am=_m))||Am);b._RF.pop(),b._RF.push({},"accd9Z7tWxAY7VJKEjCMc4f","GameModeManager",void 0);var Gm=w.ccclass,Hm=codex.match,Vm=Gm("GameModeManager")(Fm=function(){function e(){r(this,e),this.gameMode=ng.SINGLE,this.runLeaderUpdate=function(){},this.updateLeaderScores=function(){}}var i,a,s,l;return o(e,[{key:"gameplay",get:function(){return this._gameplay}},{key:"init",value:function(e){this._gameplay=e}},{key:"start",value:(l=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Hm.getMatchState(),i=t.mode,t.customData,console.log(" ? Start game with mode:",i),this.gameMode=i||ng.SINGLE,e.t0=this.gameMode,e.next=e.t0===ng.SINGLE?6:e.t0===ng.TOURNAMENT?8:e.t0===ng.CHALLENGE_FRIEND?10:13;break;case 6:return this.startSingleMode(),e.abrupt("break",15);case 8:return this.startTournamentMode(),e.abrupt("break",15);case 10:return e.next=12,this.startChallengeMode();case 12:return e.abrupt("break",15);case 13:this.stopChallengeMode(),this.stopTournamentMode();case 15:a=rt.getSpecialMode(),e.t1=a,e.next=e.t1===ft.JOURNEY?19:21;break;case 19:return this.startJourneyMode(),e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"stop",value:function(){switch(console.log(" ? Stop game with mode:",this.gameMode),this.gameMode){case ng.SINGLE:this.stopSingleMode();break;case ng.TOURNAMENT:this.stopTournamentMode();break;case ng.CHALLENGE_FRIEND:this.stopChallengeMode()}}},{key:"setGameMode",value:function(e){this.gameMode=e}},{key:"startSingleMode",value:function(){this._gameplay.uiManager.enableSingleUI()}},{key:"stopSingleMode",value:function(){}},{key:"startTournamentMode",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._gameplay.uiManager.enableSingleUI();case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"updateTournamentInfo",value:(a=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"stopTournamentMode",value:function(){}},{key:"startChallengeMode",value:(i=t(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._gameplay.uiManager.enableChallengeUI(),e.abrupt("return",new Promise((function(e){var n=t._gameplay.uiManager.challengePrepare;n?n.runAnimationPrepareChallenge().then((function(){e()})):e()})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"stopChallengeMode",value:function(){this._gameplay.uiManager.enableSingleUI()}},{key:"startJourneyMode",value:function(){this._gameplay.uiManager.enableJourneyUI()}},{key:"getGameMode",value:function(){return rt.getSpecialMode()===ft.DAILY_CHALLENGE?ng.DAILY_CHALLENGE:rt.getSpecialMode()===ft.JOURNEY?ng.JOURNEY:this.gameMode}}]),e}())||Fm;b._RF.pop(),b._RF.push({},"fc102DnnDVPELVz7+fkxRMD","DailyQuestManager",void 0);var Wm=[["CompleteLevel-10-0","UseItem-3-0","ReachCombo-15-0"],["CompleteLevel-20-0","UseItem-6-0","ReachCombo-30-0"],["CompleteLevel-30-0","UseItem-9-0","ReachCombo-45-0"]],qm=[{ShuffleItem:1,HintItem:1},{ShuffleItem:2,HintItem:2},{HintItem:3,ShuffleItem:3}],jm="daily-quest-event-complete-quest",Km=codex.event,Ym=function(){function e(){r(this,e),this.exp=0,this.currentStage=1,this.rewardList=[],this.quests=[],this.rewarded=[],this.lastLoginTime=0;var t=window.codex.player.getPlayerData().gameData.dailyQuest;if(this.currentStage=t.currentStage||1,void 0===t.quests||0===t.quests.length||0===t.quests[0].length||"string"!=typeof t.quests[0][0]?this.initQuests():this.loadQuestsFromPlayerData(t),this.rewardList=qm.map((function(e){return e})),this.currentStage<=3){var n=this.quests[this.currentStage-1].filter((function(e){return e.current>=e.target})).length;this.exp=n+3*(this.currentStage-1)}else this.exp=9;if(t.rewarded&&3!==t.rewarded.length){this.rewarded=[];for(var i=0;i<3;i++)this.rewarded.push(!1)}else this.rewarded=t.rewarded;var a={UndoItem:0,HintItem:0,ShuffleItem:0},o=new Date(t.lastLoginTime||0),s=new Date;if(o.getDate()!==s.getDate()||o.getMonth()!==s.getMonth()||o.getFullYear()!==s.getFullYear()){for(var l=0;l<this.rewarded.length;l++)l+1<this.currentStage&&!this.rewarded[l]&&(a.UndoItem+=0|this.rewardList[l].UndoItem,a.HintItem+=0|this.rewardList[l].HintItem,a.ShuffleItem+=0|this.rewardList[l].ShuffleItem);3!==this.currentStage||this.rewarded[2]||9!==this.exp||(a.UndoItem+=0|this.rewardList[2].UndoItem,a.HintItem+=0|this.rewardList[2].HintItem,a.ShuffleItem+=0|this.rewardList[2].ShuffleItem),this.reset()}this.lastLoginTime=Date.now(),this.rewardIsNotClaimed=a,this.updateQuestPlayerData()}return o(e,[{key:"loadQuestsFromPlayerData",value:function(e){var t=e.quests;this.quests=[];var n,i=l(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.quests.push([]);var r,o=l(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=xf(s);u?this.quests[this.quests.length-1].push(u):console.warn("DailyQuestManager: quest ".concat(s," not found"))}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:"initQuests",value:function(){var e=[].concat(Wm);this.quests=[];var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.quests.push([]);var a,r=l(i);try{for(r.s();!(a=r.n()).done;){var o=a.value,s=xf(o);s?this.quests[this.quests.length-1].push(s):console.warn("DailyQuestManager: quest ".concat(o," not found"))}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateQuestPlayerData",value:function(){for(var e=[],t=0;t<this.quests.length;t++){e.push([]);for(var n=0;n<this.quests.length;n++){var i=Rf(this.quests[t][n]);void 0!==i&&"string"==typeof i?e[t].push(i):console.warn("DailyQuestManager: quest ".concat(this.quests[t][n]," not found"))}}var a={currentStage:this.currentStage,quests:e,rewarded:v(this.rewarded),lastLoginTime:this.lastLoginTime};window.codex.player.setGameData({dailyQuest:a})}},{key:"reset",value:function(){this.exp=0,this.currentStage=1,this.rewardList=qm.map((function(e){return e})),this.rewarded=[];for(var e=0;e<3;e++)this.rewarded.push(!1);this.lastLoginTime=Date.now(),this.rewardIsNotClaimed={UndoItem:0,HintItem:0,ShuffleItem:0},this.initQuests(),this.updateQuestPlayerData()}},{key:"handleQuestCompleteLevel",value:function(){if(!(this.currentStage>3)){var e,t=this.quests[this.currentStage-1].filter((function(e){return"CompleteLevel"===e.type.name&&e.current<e.target})),n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.current++,i.current>=i.target)i.current=i.target,this.exp+=1,codex.player.getPlayerData().gameData.level>1&&Km.emit(jm,i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"handleQuestUseItem",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(e){return"UseItem"===e.type.name&&e.current<e.target})),i=l(n);try{for(i.s();!(t=i.n()).done;){var a,r=t.value,o=r.type.items,s=l(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;e[u]&&(r.current+=e[u])}}catch(e){s.e(e)}finally{s.f()}r.current>=r.target&&(r.current=r.target,this.exp+=1,Km.emit(jm,r))}}catch(e){i.e(e)}finally{i.f()}}}},{key:"handleQuestMatch",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(e){return"Match"===e.type.name&&e.current<e.target})),i=l(n);try{for(i.s();!(t=i.n()).done;){var a=t.value,r=a.type.tiles;if(0===r.length)a.current+=1;else{var o,s=l(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;e[u]&&(a.current+=e[u])}}catch(e){s.e(e)}finally{s.f()}}a.current>=a.target&&(a.current=a.target,this.exp+=1,Km.emit(jm,a))}}catch(e){i.e(e)}finally{i.f()}}}},{key:"handleQuestReachCombo",value:function(e){if(!(this.currentStage>3)){var t,n=this.quests[this.currentStage-1].filter((function(t){return"ReachCombo"===t.type.name&&t.current<t.target&&e===t.type.minCombo})),i=l(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.current++,a.current>=a.target)a.current=a.target,this.exp+=1,codex.player.getPlayerData().gameData.level>1&&Km.emit(jm,a)}}catch(e){i.e(e)}finally{i.f()}}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"finishGame",value:function(){var t=e.getInstance();t.handleQuestCompleteLevel(),e.checkAllLevelsCompleted(),t.updateQuestPlayerData()}},{key:"useItem",value:function(t){var n=e.getInstance();n.handleQuestUseItem(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"matchTile",value:function(t){var n=e.getInstance();n.handleQuestMatch(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"reachCombo",value:function(t){var n=e.getInstance();n.handleQuestReachCombo(t),e.checkAllLevelsCompleted(),n.updateQuestPlayerData()}},{key:"checkAllLevelsCompleted",value:function(){var t=e.getInstance();t.currentStage>3||t.quests[t.currentStage-1].every((function(e){return e.current>=e.target}))&&t.currentStage<3&&t.currentStage++}},{key:"getExp",value:function(){return e.getInstance().exp}},{key:"getMaxExp",value:function(){return 3*e.getInstance().rewardList.length}},{key:"getCurrentStage",value:function(){var t=e.getInstance();return t.currentStage>3?3:t.currentStage}},{key:"getCurrentQuestsInStage",value:function(t){var n=e.getInstance(),i=void 0===t?n.currentStage:t;return i>3&&(i=3),i-1<n.quests.length?n.quests[i-1]:(console.warn("DailyQuestManager: current stage out of range"),[])}},{key:"getRewards",value:function(){return e.getInstance().rewardList}},{key:"getRewarded",value:function(){return e.getInstance().rewarded}},{key:"updateGetChestReward",value:function(t){var n=e.getInstance();t>=n.rewarded.length?console.warn("DailyQuestManager: index out of range"):(n.rewarded[t]=!0,n.updateQuestPlayerData())}},{key:"canGetReward",value:function(t){return t+1<e.getInstance().currentStage||3===e.getInstance().currentStage&&this.getExp()===this.getMaxExp()}},{key:"getRewardIsNotClaimed",value:function(){return e.getInstance().rewardIsNotClaimed}},{key:"resetRewardIsNotClaimed",value:function(){e.getInstance().rewardIsNotClaimed={UndoItem:0,HintItem:0,ShuffleItem:0}}}]),e}();b._RF.pop(),b._RF.push({},"a4b9amW8vpEPJQAJqCTMQL7","ItemUtils",void 0);var Jm=codex.player,Zm=function(){function e(){r(this,e)}return o(e,null,[{key:"getPlayerItems",value:function(){var e=Jm.getGameData();return null!=e&&e.items?e.items:{}}},{key:"setPlayerItems",value:function(e){var t=Jm.getGameData();if(t){var n=m({},t);n.items=e,Jm.setGameData(n)}}},{key:"getPlayerItem",value:function(e){return this.getPlayerItems()[e]||null}},{key:"setPlayerItem",value:function(e,t){var n=this.getPlayerItems();n[e]=t,this.setPlayerItems(n)}},{key:"getItemCount",value:function(e){var t=this.getPlayerItem(e);return(null==t?void 0:t.count)||0}},{key:"setItemCount",value:function(e,t){var n=this.getPlayerItem(e);n&&(n.count=t,this.setPlayerItem(e,n))}},{key:"isItemFirstUse",value:function(e){var t=this.getPlayerItem(e);return(null==t?void 0:t.isFirstUse)||!1}},{key:"setItemFirstUse",value:function(e,t){var n=this.getPlayerItem(e);n&&(n.isFirstUse=t,this.setPlayerItem(e,n))}},{key:"useItem",value:function(e){var t={};t[e]=1,Ym.useItem(t);var n=this.getPlayerItem(e);return n?0===n.count?0:(n.count--,this.setPlayerItem(e,n),n.count):0}},{key:"addItem",value:function(e,t){var n=this.getPlayerItem(e);return n?(n.count+=t,this.setPlayerItem(e,n),n.count):0}},{key:"removeAllItem",value:function(){var e=this;Object.values(tt).forEach((function(t){"number"==typeof t&&e.setItemCount(et[t],0)}))}}]),e}();b._RF.pop(),b._RF.push({},"f994dPKg1JFYrdGUFjPYMfw","LimitAdsUtils",void 0);var Qm=18e5,Xm=3,$m=3,eb=function(){function e(){r(this,e)}return o(e,[{key:"updatePlayerData",value:function(){var e={lastLoginTime:this.lastLoginTime,shuffleItem:this.shuffleItem,hintItem:this.hintItem,lastWatchedAdTime:this.lastWatchedAdTime};codex.player.setGameData({limitAds:e})}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:function(){var e=codex.player.getPlayerData().gameData.limitAds;this.inst.lastLoginTime=e.lastLoginTime||0,this.inst.shuffleItem=e.shuffleItem||0,this.inst.hintItem=e.hintItem||0,this.inst.lastWatchedAdTime=e.lastWatchedAdTime||0;var t=new Date;yt(this.inst.lastLoginTime)||(this.inst.lastLoginTime=t.getTime(),this.inst.shuffleItem=0,this.inst.hintItem=0),this.inst.updatePlayerData()}},{key:"getCurrentWatchedAds",value:function(e){switch(e){case"shuffleItem":return this.inst.shuffleItem;case"hintItem":return this.inst.hintItem;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),0}}},{key:"getMaxWatchedAds",value:function(e){switch(e){case"shuffleItem":return Xm;case"hintItem":return $m;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),1}}},{key:"canWatchAds",value:function(e){var t=3;switch(e){case"shop":return 0===this.getTimeLeftToWatchAdsInShop();case"shuffleItem":return t=Xm,this.inst.shuffleItem<t;case"hintItem":return t=$m,this.inst.hintItem<t;default:return console.warn("LimitAdsUtils: Unknown ad type: ".concat(e)),!1}}},{key:"watchedAds",value:function(e){if(this.canWatchAds(e)){switch(e){case"shop":this.inst.lastWatchedAdTime=Date.now();break;case"shuffleItem":this.inst.shuffleItem+=1;break;case"hintItem":this.inst.hintItem+=1;break;default:return void console.warn("LimitAdsUtils: Unknown ad type: ".concat(e))}this.inst.updatePlayerData()}else console.warn('LimitAdsUtils: User watched a "'.concat(e,'" ad even though the daily limit had been reached.'))}},{key:"getTimeLeftToWatchAdsInShop",value:function(){var e=Date.now()-this.inst.lastWatchedAdTime,t=Qm-e;return Math.max(0,t)}}]),e}();b._RF.pop(),b._RF.push({},"a10d7laB6BNeK6o1AAs+jo5","ShuffleHandler",void 0);var tb,nb,ib,ab,rb,ob,sb,lb=function(){function e(){r(this,e),this.id="",this.gridPos=new Q(0,0),this.layer=0,this.isUncovered=!0,this.isInPool=!0}return o(e,[{key:"init",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isUncovered=!0,this.id=e,this.gridPos=t,this.layer=n,this.skinProp={skinIdx:1,isHidden:i,isTarget:a,isArtifact:r}}}]),e}(),ub=function(){function e(){r(this,e),this.pool=[],this.layerTileMap=new Map,this.tilesOnBoard=[],this.maxLayer=0,this.shuffleSeed=[]}var i;return o(e,[{key:"reset",value:function(){var e,t=l(this.tilesOnBoard);try{for(t.s();!(e=t.n()).done;){e.value.isInPool=!0}}catch(e){t.e(e)}finally{t.f()}var n,i=l(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a,r=n.value,o=l(r);try{for(o.s();!(a=o.n()).done;){a.value.isInPool=!0}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}this.layerTileMap.clear(),this.tilesOnBoard=[],this.maxLayer=0,this.shuffleSeed=[]}},{key:"prepareShuffleTiles",value:function(e){var t=this;this.reset(),this.setupTiles(e);var n,i=new Map,a=l(this.tilesOnBoard);try{for(a.s();!(n=a.n()).done;){var r=n.value;i.set(r.id,r.skinProp)}}catch(e){a.e(e)}finally{a.f()}for(var o=e.map((function(e){return{skinIdx:e.skinIdx,isHidden:e.isHidden,isTarget:e.isTarget,isArtifact:e.isArtifact}})),s=!0,u=0;u<3;u++){0!==u&&(this.reset(),this.setupTiles(e));var c=v(o);Ludex.Utils.Array.shuffle(c);for(var h=function(){var e=t.getUncoveredTiles();if(e.length<2)return console.log("Not enough uncovered tiles",e.length),s=!1,0;Ludex.Utils.Array.shuffle(e);for(var n=e[0],a=e[1],r=c[0];r.isArtifact;)c.splice(0,1),r=c[0];var o=c.find((function(e,n){return 0!==n&&t.canMatchSkinIndices(r.skinIdx,e.skinIdx)}));if(void 0===o)return console.log("No matching pair found in rawSeed"),s=!1,0;var l=c.indexOf(o,1);c.splice(Math.max(0,l),1),c.splice(Math.min(0,l),1),n.skinProp=r,a.skinProp=o,i.set(n.id,n.skinProp),i.set(a.id,a.skinProp),t.handleTileDestroyed(n),t.handleTileDestroyed(a),t.updateTilesState()};this.tilesOnBoard.length>0&&0!==h(););if(0===this.tilesOnBoard.length){s=!0,console.log("isCanShuffle",s,"tryTimes",u+1);break}}if(!s)return!1;var d=Array.from(i.values());return d.length!==e.length?(console.log("New seed length does not match current tiles length",d.length,e.length),!1):(this.shuffleSeed=d,!0)}},{key:"getShuffleSeed",value:function(){return this.shuffleSeed}},{key:"handleTileDestroyed",value:function(e){var t=this.tilesOnBoard.indexOf(e);-1!==t&&this.tilesOnBoard.splice(t,1);var n,i=l(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a=n.value,r=a.indexOf(e);if(-1!==r){a.splice(r,1);break}}}catch(e){i.e(e)}finally{i.f()}e.isInPool=!0}},{key:"canMatchSkinIndices",value:function(e,t){if(e===t)return!0;var n=dt.flowers.includes(e),i=dt.flowers.includes(t);if(n&&i)return!0;var a=dt.seasons.includes(e),r=dt.seasons.includes(t);return!(!a||!r)}},{key:"getUncoveredTiles",value:function(){var e,t=[],n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=l(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered&&t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"setupTiles",value:function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value,r=this.getTile(),o=a.getLayer();if(r.init(a.id,a.gridPos,o,a.isHidden,a.isTarget,a.isArtifact),this.maxLayer=Math.max(this.maxLayer,o),this.layerTileMap.has(o))null===(i=this.layerTileMap.get(o))||void 0===i||i.push(r);else this.layerTileMap.set(o,[r])}}catch(e){n.e(e)}finally{n.f()}this.handleTilesCreated()}},{key:"handleTilesCreated",value:(i=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sortLayersByKey(),this.updateTilesState();case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateTilesState",value:function(){this.updateLowerLayersVisibility(),this.destroyArtifactTiles()}},{key:"updateLowerLayersVisibility",value:function(){for(var e=this.maxLayer;e>=0;e--)this.updateTilesInLayer(e)}},{key:"destroyArtifactTiles",value:function(){var e,t=!1,n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=l(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.skinProp.isArtifact&&o.isUncovered&&(this.handleTileDestroyed(o),t=!0)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}t&&this.updateTilesState()}},{key:"updateTilesInLayer",value:function(e){var t,n=this.layerTileMap.get(e)||[],i=l(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a){var r=this.isTileOverlappedByUpperLayers(a,e),o=this.isTileBlockedBySides(a,e),s=!r&&!o;a.isUncovered=s}}}catch(e){i.e(e)}finally{i.f()}}},{key:"isTileOverlappedByUpperLayers",value:function(e,t){for(var n=this,i=t+1;i<=this.maxLayer;i++){if((this.layerTileMap.get(i)||[]).some((function(t){return n.isOverlapped(e.gridPos,t.gridPos)})))return!0}return!1}},{key:"isTileBlockedBySides",value:function(e,t){var n=this.layerTileMap.get(t)||[];return this.isBlockedOnLeft(e,n)&&this.isBlockedOnRight(e,n)}},{key:"isBlockedOnLeft",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnLeft(t,e)}))}},{key:"isTileOnLeft",value:function(e,t){return e.gridPos.x<t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isBlockedOnRight",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnRight(t,e)}))}},{key:"isTileOnRight",value:function(e,t){return e.gridPos.x>t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isOverlapped",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n<1&&n>=0&&i<1&&i>=0||n>-1&&n<=0&&i>-1&&i<=0||n<1&&n>=0&&i>-1&&i<=0||n>-1&&n<=0&&i<1&&i>=0}},{key:"sortLayersByKey",value:function(){for(var e=0;e<=this.maxLayer;e++){var t=this.layerTileMap.get(e);t&&(t.sort((function(e,t){return e.gridPos.x+e.gridPos.y===t.gridPos.x+t.gridPos.y?t.gridPos.x-e.gridPos.x:t.gridPos.x+t.gridPos.y-(e.gridPos.x+e.gridPos.y)})),t.reverse())}for(var n=0;n<=this.maxLayer;n++){var i=this.layerTileMap.get(n);if(i){var a,r=l(i);try{for(r.s();!(a=r.n()).done;){var o=a.value;this.tilesOnBoard.includes(o)||this.tilesOnBoard.push(o)}}catch(e){r.e(e)}finally{r.f()}}}}},{key:"getTile",value:function(){var e,t=l(this.pool);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.isInPool)return n.isInPool=!1,n}}catch(e){t.e(e)}finally{t.f()}var i=new lb;return this.pool.push(i),i.isInPool=!1,i}}]),e}();b._RF.pop(),b._RF.push({},"712e3ncnN9O/I8hOJtbnCMr","TileManager",void 0);var cb,hb,db,pb,fb,yb=w.ccclass,vb=w.property,gb=Ludex.Utils.Time,mb=(tb=yb("TileManager"),nb=vb([le]),ib=vb(P),tb((ob=u((rb=function(e){i(A,e);var s,u,d,p,f,y,m,b,S,w,k,T,C,E,L,I,x=a(A);function A(){var e;r(this,A);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=x.call.apply(x,[this].concat(n)),c(e,"specialTileSprites",ob,h(e)),c(e,"parentNode",sb,h(e)),e.layerTileMap=new Map,e.tilesOnBoard=[],e.maxLayer=0,e.choosingTile=null,e.numberOfMatchPairs=0,e.hintTiles=[],e.canUndoPair=[],e.matchedPairCount=0,e.matchedPairFailedCount=0,e.totalPairCount=0,e.isAutoFinishing=!1,e}return o(A,[{key:"getTilesOnBoard",value:function(){return this.tilesOnBoard}},{key:"getNumberOfMatchPairs",value:function(){return this.numberOfMatchPairs}},{key:"getNumberOfCanUndoPair",value:function(){return this.canUndoPair.length}},{key:"getLengthTilesOnBoard",value:function(){return this.tilesOnBoard.length}},{key:"getGoldenTileSprite",value:function(){return this.specialTileSprites[0]}},{key:"getLeftoverPairCount",value:function(){var e,t=0,n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){t+=e.value.length}}catch(e){n.e(e)}finally{n.f()}return t/2}},{key:"getMatchedPairCount",value:function(){return this.matchedPairCount}},{key:"getMatchedPairFailedCount",value:function(){return this.matchedPairFailedCount}},{key:"getTotalPairCount",value:function(){return this.totalPairCount}},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents(),this.validateRequiredComponents(),this.shuffleHandler=new ub}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on(ny.TILE_CREATED,this.handleTileCreated,this),e.on(ny.TILE_CLICKED,this.handleTileClicked,this),e.on(ny.TILE_MOVING,this.handleTileMoving,this),e.on(ny.TILE_DROPPED,this.handleTileDropped,this),e.on(ny.TILE_COVERED_CLICKED,this.handleTileCoveredClicked,this),e.on(ny.TILE_DESTROYED,this.handleTileDestroyed,this),e.on(ny.TILE_START_SORT,this.sortOrderTiles,this),e.on(ny.TILE_RELEASE,this.handleReleaseTile,this)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleTilesCreated",value:(I=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sortLayersByKey(),this.updateTilesState(),e.next=4,this.playOpenTilesAnimation();case 4:this.initializeTiles(),this.updateTilesCoveredState(),this.node.scene.emit(ny.ALL_TILE_READY);case 7:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"reopenTiles",value:(L=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playOpenTilesAnimation(!0);case 2:this.initializeTiles(),this.updateTileToReadyState();case 4:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"updateTilesCoveredState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=codex.player.getPlayerSettings().highLight;if(t||e){var n,i=l(this.layerTileMap.values());try{for(i.s();!(n=i.n()).done;){var a,r=n.value,o=l(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;t?s.animationHandler.toggleCoverAnimations(s.isUncovered,.3):s.animationHandler.toggleCoverAnimations(!0,.3)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}}}},{key:"updateTileToReadyState",value:function(){var e,t=l(this.layerTileMap.values());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=l(i);try{for(a.s();!(n=a.n()).done;){n.value.state=lt.ALREADY}}catch(e){a.e(e)}finally{a.f()}}}catch(e){t.e(e)}finally{t.f()}this.gameScene.gameplay.handleAllTileReady()}},{key:"playOpenTilesAnimation",value:(E=t(n().mark((function e(){var t,i=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]&&i[0],this.sortOrderTiles(),!Fe.isLandscape()){e.next=7;break}return e.next=5,this.playOpenTilesLandscapeAnimation(t);case 5:e.next=9;break;case 7:return e.next=9,this.playOpenTilesPortraitAnimation(t);case 9:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"playOpenTilesLandscapeAnimation",value:(C=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h,d,p,f;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=this.layerTileMap.size)){e.next=4;break}return e.abrupt("return");case 4:i=Math.min(ut.ANIMATION_CONFIGS.OPEN_DURATION.LANDSCAPE_TOTAL/t,.3),a=ut.ANIMATION_CONFIGS.OPEN_DURATION.INIT_DELAY,r=[],o=0,s=l(this.layerTileMap.values());try{for(s.s();!(u=s.n()).done;){c=u.value,h=i*o+a,d=l(c);try{for(d.s();!(p=d.n()).done;)f=p.value,r.push(f.animationHandler.playTileOpenAnimation(i,h,new U(f.worldPos.x,f.worldPos.y,0),!0))}catch(e){d.e(e)}finally{d.f()}o++}}catch(e){s.e(e)}finally{s.f()}return gb.sleepAsync(1e3*a).then((function(){Ge.playSound(He.TILE_SHOW)})),e.next=13,Promise.all(r);case 13:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"playOpenTilesPortraitAnimation",value:(T=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h,d,p,f,y,v,g;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],i=0,a=this.getCenterPosition(),r=this.sortTilesByDistance(a),o=_.getVisibleSize().width,s=ut.ANIMATION_CONFIGS.OPEN_DURATION.INIT_DELAY,u=ut.ANIMATION_CONFIGS.OPEN_DURATION.MAX_DELAY/r.length,c=l(r);try{for(c.s();!(h=c.n()).done;)d=h.value,p=u*i+s,f=a.x<d.worldPos.x?o:-o,y=ut.ANIMATION_CONFIGS.OPEN_DURATION.MIN_PORTRAIT_TOTAL,v=ut.ANIMATION_CONFIGS.OPEN_DURATION.MAX_PORTRAIT_TOTAL,g=y+Math.random()*(v-y),t.push(d.animationHandler.playTileOpenAnimation(g,p,new U(f,d.worldPos.y,0),!1)),i++}catch(e){c.e(e)}finally{c.f()}return gb.sleepAsync(1e3*s).then((function(){Ge.playSound(He.TILE_SHOW)})),e.next=13,Promise.all(t);case 13:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"sortTilesByDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Q(0,0),t=this.getAllTiles();return 0===t.length?[]:(t.sort((function(t,n){var i=t.worldPos.x-e.x,a=t.worldPos.y-e.y,r=n.worldPos.x-e.x,o=n.worldPos.y-e.y;return i*i+a*a-(r*r+o*o)})),t)}},{key:"getCenterPosition",value:function(){var e=this.getAllTiles();if(0===e.length)return new Q(0,0);var t,n=0,i=0,a=l(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n+=r.worldPos.x,i+=r.worldPos.y}}catch(e){a.e(e)}finally{a.f()}return new Q(n/e.length,i/e.length)}},{key:"initializeTiles",value:function(){var e,t=l(this.layerTileMap.values());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=l(i);try{for(a.s();!(n=a.n()).done;){n.value.handleInitializeTile()}}catch(e){a.e(e)}finally{a.f()}}}catch(e){t.e(e)}finally{t.f()}this.matchedPairCount=0,this.matchedPairFailedCount=0,this.totalPairCount=this.getLeftoverPairCount()}},{key:"updateTilesState",value:function(){this.updateLowerLayersVisibility(),this.calculateNumberOfMatchPairs(),this.node.scene.emit(ny.TILES_STATE_UPDATED)}},{key:"updateLowerLayersVisibility",value:function(){for(var e=this.maxLayer;e>=0;e--)this.updateTilesInLayer(e)}},{key:"updateTilesInLayer",value:function(e){var t,n=this.layerTileMap.get(e)||[],i=l(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a){var r=this.isTileOverlappedByUpperLayers(a,e),o=this.isTileBlockedBySides(a,e),s=!r&&!o;a.setUncover(s),s&&a.toggleUncover(s)}}}catch(e){i.e(e)}finally{i.f()}}},{key:"handleTileClicked",value:function(e){if(!this.choosingTile)return this.choosingTile=e,this.handleChooseTile(e),Ge.playSound(He.TILE_CLICK),void ro.vibrate(45);this.compareWithChoosingTile(e)}},{key:"handleTileMoving",value:function(e){if(!this.choosingTile)return this.choosingTile=e,this.handleChooseTile(e),void ro.vibrate(45);this.choosingTile===e||this.compareWithChoosingTile(e)}},{key:"handleTileDropped",value:(k=t(n().mark((function e(t){var i,a,r,o,s,l,u,c,h,d,p,f=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.choosingTile=t,i=.85,a=t.node.getComponent(R),(r=a.getBoundingBoxToWorld()).width*=i,r.height*=i,o=this.getAllTiles().filter((function(e){var n=e.node.getComponent(R);if(!n)return!1;var a=n.getBoundingBoxToWorld();return a.width*=i,a.height*=i,r.intersects(a)&&e!==t&&e.state===lt.ALREADY&&!f.isTileCompletelyOverlappedByUpperLayers(e,e.getLayer())})),s=o.filter((function(e){return f.checkTilesMatched(t,e)})),l=s.filter((function(e){return e.isUncovered})),u=s.filter((function(e){return!e.isUncovered})),!(s.length>0)){e.next=30;break}if(!(l.length>0)){e.next=19;break}return c=l[0],Ge.playSound(He.TILE_CLICK),ro.vibrate(45),this.handleTwoTilesMatched(this.choosingTile,c),this.choosingTile=null,this.updateTilesState(),e.abrupt("return");case 19:if(!(u.length>0)){e.next=30;break}if(h=u[0],d=this.getTilesOverlappedByUpperLayers(h,h.getLayer()),p=this.getTilesBlockedBySides(h,h.getLayer()),!d.includes(this.choosingTile)&&!p.includes(this.choosingTile)){e.next=29;break}return e.next=26,this.handleChooseTile(t);case 26:return this.node.scene.emit(ny.TILE_START_SORT),this.handleTileCoveredClicked(h),e.abrupt("return");case 29:this.handleTileCoveredClicked(h);case 30:return e.next=32,this.handleChooseTile(t);case 32:this.node.scene.emit(ny.TILE_START_SORT);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"handleChooseTile",value:(w=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.isBlockedOnLeft(t,this.layerTileMap.get(t.getLayer())||[]),a=this.isBlockedOnRight(t,this.layerTileMap.get(t.getLayer())||[]),e.next=4,t.handleChooseTile(i,a);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"handleTileCoveredClicked",value:function(e){var t=this.getTilesOverlappedByUpperLayers(e,e.getLayer()),n=this.getTilesBlockedBySides(e,e.getLayer()),i=t.length>0,a=n.length>0;if(i||a){var r=e.node.position;this.node.scene.emit(ny.TILE_BLOCKED,r,i,a);var o,s=l(t);try{for(s.s();!(o=s.n()).done;){o.value.animationHandler.playTileShakeAnim()}}catch(e){s.e(e)}finally{s.f()}var u,c=l(n);try{for(c.s();!(u=c.n()).done;){u.value.animationHandler.playTileShakeAnim()}}catch(e){c.e(e)}finally{c.f()}}e.animationHandler.playTileShakeAnim(),e.animationHandler.toggleCoverAnimations(!1,.3),this.matchedPairFailedCount++,Ge.playSound(He.TILE_DESELECT)}},{key:"compareWithChoosingTile",value:function(e){if(this.choosingTile)return this.choosingTile===e?(this.choosingTile.handleUnChooseTile(),void(this.choosingTile=null)):void(this.checkTilesMatched(this.choosingTile,e)?(Ge.playSound(He.TILE_CLICK),ro.vibrate(45),this.handleTwoTilesMatched(this.choosingTile,e),this.choosingTile=null,this.updateTilesState()):(this.choosingTile.handleUnChooseTile(),this.choosingTile=e,this.handleChooseTile(e),Ge.playSound(He.TILE_CLICK),ro.vibrate(45)))}},{key:"handleTwoTilesMatched",value:(S=t(n().mark((function e(t,i){var a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hintTiles.includes(t)||this.hintTiles.includes(i)){a=l(this.hintTiles);try{for(a.s();!(r=a.n()).done;)r.value.animationHandler.playTileStopHintAnim()}catch(e){a.e(e)}finally{a.f()}this.hintTiles=[],this.node.scene.emit(ny.HIDE_HINT)}return this.removeTile(t),this.removeTile(i),this.canUndoPair.push([t.getCurrentTileConfig(),i.getCurrentTileConfig()]),this.matchedPairCount++,e.next=7,this.playMatchAnimation(t,i);case 7:this.destroyMatchedTiles(t),this.destroyMatchedTiles(i);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"handleTileCollect",value:(b=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.canUndoPair=[],this.removeTile(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"checkTilesMatched",value:function(e,t){if(e.skinIdx===t.skinIdx)return!0;var n=dt.flowers,i=dt.seasons;return!(!n.includes(e.skinIdx)||!n.includes(t.skinIdx))||!(!i.includes(e.skinIdx)||!i.includes(t.skinIdx))}},{key:"getGroupKeyBySkinIdx",value:function(e){return dt.flowers.includes(e)?"flower":dt.seasons.includes(e)?"season":e.toString()}},{key:"calculateCenterPosition",value:function(e,t){return new U((e.x+t.x)/2,(e.y+t.y)/2)}},{key:"playMatchAnimation",value:(m=t(n().mark((function e(t,i){var a,r,o,s,l,u,c,h,d,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state=lt.MOVING_TO_MATCH,i.state=lt.MOVING_TO_MATCH,a=this.calculateCenterPosition(t.node.position,i.node.position),r=t.node.position.clone(),o=i.node.position.clone(),s=this.getIsMatchLeftOrRightX(r,a),l=-s,t.node.getSiblingIndex()<i.node.getSiblingIndex()?(t.node.setSiblingIndex(t.node.parent.children.length-1),i.node.setSiblingIndex(i.node.parent.children.length-1)):(i.node.setSiblingIndex(i.node.parent.children.length-1),t.node.setSiblingIndex(t.node.parent.children.length-1)),u=[He.TILE_MATCH_1,He.TILE_MATCH_2,He.TILE_MATCH_3,He.TILE_MATCH_4,He.TILE_MATCH_5],c=Math.floor(Math.random()*u.length),h=[t.animationHandler.playTileMoveToMatchPosition(a,r,s),i.animationHandler.playTileMoveToMatchPosition(a,o,l),gb.sleepAsync(400).then((function(){Ge.playSound(u[c])}))],d=[t.animationHandler.playTileDestroyingAnim(a,s),i.animationHandler.playTileDestroyingAnim(a,l)],e.next=14,Promise.all(h);case 14:return-1===s?(t.node.setSiblingIndex(t.node.parent.children.length-1),i.node.setSiblingIndex(i.node.parent.children.length-1)):(i.node.setSiblingIndex(i.node.parent.children.length-1),t.node.setSiblingIndex(t.node.parent.children.length-1)),t.state=lt.MATCHED,i.state=lt.MATCHED,p=this.calculateCenterPosition(t.node.worldPosition,i.node.worldPosition),this.node.scene.emit(ny.TWO_TILES_MATCHED,{tile1:t,tile2:i,worldCenterPosition:p}),e.next=21,Promise.all(d);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"getIsMatchLeftOrRightX",value:function(e,t){var n=t.x-e.x;return 0===n?-1:n<0?1:-1}},{key:"destroyMatchedTiles",value:function(e){e.state=lt.DESTROYED,e.returnToPool(),this.node.scene.emit(ny.TILE_DESTROYED,e)}},{key:"isTileOverlappedByUpperLayers",value:function(e,t){for(var n=this,i=t+1;i<=this.maxLayer;i++){if((this.layerTileMap.get(i)||[]).some((function(t){return n.isOverlapped(e.gridPos,t.gridPos)})))return!0}return!1}},{key:"isTileCompletelyOverlappedByUpperLayers",value:function(e,t){for(var n=!1,i=!1,a=!1,r=!1,o=t+1;o<=this.maxLayer;o++){var s,u=this.layerTileMap.get(o)||[],c=l(u);try{for(c.s();!(s=c.n()).done;){var h=s.value;if(this.isOverlapped(e.gridPos,h.gridPos)){var d=h.gridPos.x-e.gridPos.x,p=h.gridPos.y-e.gridPos.y;d<=0&&p<=0&&(n=!0),d>=0&&p<=0&&(i=!0),d<=0&&p>=0&&(a=!0),d>=0&&p>=0&&(r=!0)}}}catch(e){c.e(e)}finally{c.f()}}return!!(n&&i&&a&&r)}},{key:"isTileBlockedBySides",value:function(e,t){var n=this.layerTileMap.get(t)||[];return this.isBlockedOnLeft(e,n)&&this.isBlockedOnRight(e,n)}},{key:"getTilesOverlappedByUpperLayers",value:function(e,t){var n=this;return(this.layerTileMap.get(t+1)||[]).filter((function(t){return n.isOverlapped(e.gridPos,t.gridPos)}))}},{key:"getTilesBlockedBySides",value:function(e,t){var n=this,i=[],a=this.layerTileMap.get(t)||[];return i.push.apply(i,v(a.filter((function(t){return n.isTileOnLeft(t,e)||n.isTileOnRight(t,e)})))),i}},{key:"isBlockedOnLeft",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnLeft(t,e)}))}},{key:"isTileOnLeft",value:function(e,t){return e.gridPos.x<t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isBlockedOnRight",value:function(e,t){var n=this;return t.some((function(t){return n.isTileOnRight(t,e)}))}},{key:"isTileOnRight",value:function(e,t){return e.gridPos.x>t.gridPos.x&&Math.abs(e.gridPos.x-t.gridPos.x)<=1&&Math.abs(e.gridPos.y-t.gridPos.y)<1}},{key:"isOverlapped",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n<1&&n>=0&&i<1&&i>=0||n>-1&&n<=0&&i>-1&&i<=0||n<1&&n>=0&&i>-1&&i<=0||n>-1&&n<=0&&i<1&&i>=0}},{key:"removeTile",value:function(e){var t,n=l(this.layerTileMap.values());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.indexOf(e);if(-1!==a){i.splice(a,1);break}}}catch(e){n.e(e)}finally{n.f()}}},{key:"sortLayersByKey",value:function(){var e=Array.from(this.layerTileMap.entries()).sort((function(e,t){var n=g(e,1)[0],i=g(t,1)[0];return Number(n)-Number(i)}));this.layerTileMap=new Map(e)}},{key:"clearTiles",value:function(){var e,t=l(this.tilesOnBoard);try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&n.returnToPool()}}catch(e){t.e(e)}finally{t.f()}this.layerTileMap=new Map,this.tilesOnBoard=[],this.maxLayer=0,this.choosingTile=null,this.numberOfMatchPairs=0,this.hintTiles=[],this.canUndoPair=[],this.isAutoFinishing=!1}},{key:"handleShuffle",value:(y=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.choosingTile&&(this.choosingTile.handleUnChooseTile(),this.choosingTile=null),0!==this.hintTiles.length){t=l(this.hintTiles);try{for(t.s();!(i=t.n()).done;)i.value.animationHandler.playTileStopHintAnim()}catch(e){t.e(e)}finally{t.f()}this.hintTiles=[],this.node.scene.emit(ny.HIDE_HINT)}if(this.canUndoPair=[],a=this.getAllTiles(),this.shuffleHandler.prepareShuffleTiles(v(a))){e.next=9;break}return this.gameScene.gameplay.logCantShuffle(),this.node.scene.emit(ny.ALL_TILE_COVERED),e.abrupt("return");case 9:r=this.shuffleHandler.getShuffleSeed(),o=this.gameScene.gameplay.gameObjects.getShuffleConfig(),s=l(a);try{for(s.s();!(u=s.n()).done;)u.value.state=lt.PRELOADING}catch(e){s.e(e)}finally{s.f()}return e.next=15,this.playShuffleAnimation(a,r,o);case 15:c=l(a);try{for(c.s();!(h=c.n()).done;)h.value.state=lt.ALREADY}catch(e){c.e(e)}finally{c.f()}this.updateTilesState(),this.updateTilesCoveredState(),this.node.scene.emit(ny.END_SHUFFLE);case 20:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"handleShowHint",value:function(){if(0===this.hintTiles.length){var e=this.getNewHintPairs();console.log("New hint tiles:",e);var t,n=l(this.hintTiles);try{for(n.s();!(t=n.n()).done;){t.value.animationHandler.playTileStopHintAnim()}}catch(e){n.e(e)}finally{n.f()}this.hintTiles=e;var i,a=l(this.hintTiles);try{for(a.s();!(i=a.n()).done;){i.value.animationHandler.playTileShowHintAnim()}}catch(e){a.e(e)}finally{a.f()}Ge.playSound(He.USE_HINT)}}},{key:"handleAutoPlay",value:function(){if(0===this.hintTiles.length&&!this.isAutoFinishing){var e=this.getNewHintPairs();0!==e.length&&(this.handleTileClicked(e[0]),this.handleTileClicked(e[1]))}}},{key:"handleUndo",value:(f=t(n().mark((function e(){var t,i,a,r,o,s,u,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.canUndoPair.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this.canUndoPair.pop()){e.next=5;break}return e.abrupt("return");case 5:if(this.choosingTile&&(this.choosingTile.handleUnChooseTile(),this.choosingTile=null),i=g(t,2),a=i[0],r=i[1],o=this.gameScene.gameplay.gameObjects.respawnTile(a),s=this.gameScene.gameplay.gameObjects.respawnTile(r),this.setTileSprite(o,a.skinProp),this.setTileSprite(s,r.skinProp),o&&s){e.next=14;break}return console.error("Failed to respawn tiles"),e.abrupt("return");case 14:return o.handlePreloadTile(),s.handlePreloadTile(),Ge.playSound(He.USE_UNDO),e.next=19,this.playUndoAnimation(o,s);case 19:if(this.node.scene.emit(ny.TWO_TILES_UNDONE,{tile1:o,tile2:s}),o.handleReadyTile(),s.handleReadyTile(),this.updateTilesState(),this.updateTilesCoveredState(),0!==this.hintTiles.length&&this.hintTiles[0]&&this.hintTiles[1]&&(!this.hintTiles[0].isUncovered||!this.hintTiles[1].isUncovered)){u=l(this.hintTiles);try{for(u.s();!(c=u.n()).done;)c.value.animationHandler.playTileStopHintAnim()}catch(e){u.e(e)}finally{u.f()}this.hintTiles=[],this.node.scene.emit(ny.HIDE_HINT)}case 25:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"handleShowUndo",value:function(){this.canUndoPair.length}},{key:"handleAutoFinishMatch",value:(p=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h,d,p,f,y,v,g,m,b,S;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.hintTiles.length){t=l(this.hintTiles);try{for(t.s();!(i=t.n()).done;)i.value.animationHandler.playTileStopHintAnim()}catch(e){t.e(e)}finally{t.f()}this.hintTiles=[],this.node.scene.emit(ny.HIDE_HINT)}if(0!==(a=this.getAllTiles()).length){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:r=a.sort((function(e,t){return e.skinIdx-t.skinIdx||e.getLayer()-t.getLayer()})),o=l(r);try{for(o.s();!(s=o.n()).done;)(u=s.value).state=lt.MOVING_TO_MATCH,u.inputHandler.disableInteraction(),u.animationHandler.abortAllMovementAnimations()}catch(e){o.e(e)}finally{o.f()}this.isAutoFinishing=!0,c=ut.ANIMATION_CONFIGS.AUTO_FINISH.SHINE_DELAY_INTERVAL/r.length,h=[],d=l(r),e.prev=11,d.s();case 13:if((p=d.n()).done){e.next=20;break}return f=p.value,h.push(f.animationHandler.playTileShineAnim()),e.next=18,gb.sleepAsync(1e3*c);case 18:e.next=13;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(11),d.e(e.t0);case 25:return e.prev=25,d.f(),e.finish(25);case 28:return e.next=30,Promise.all(h);case 30:y=Math.min(ut.ANIMATION_CONFIGS.AUTO_FINISH.MATCH_DELAY_PER_TILE*(r.length/2),ut.ANIMATION_CONFIGS.AUTO_FINISH.MAX_MATCH_DELAY_TOTAL_TIME),v=y/(r.length/2),g=[],m=0;case 34:if(!(m<r.length-1)){e.next=43;break}return b=r[m],S=r[m+1],this.checkTilesMatched(b,S)?g.push(this.handleTwoTilesMatched(b,S)):console.warn("Tiles ".concat(b.skinIdx," and ").concat(S.skinIdx," do not match")),e.next=40,gb.sleepAsync(1e3*v);case 40:m+=2,e.next=34;break;case 43:return e.next=45,Promise.all(g);case 45:this.isAutoFinishing=!1;case 46:case"end":return e.stop()}}),e,this,[[11,22,25,28]])}))),function(){return p.apply(this,arguments)})},{key:"getNewHintPairs",value:function(){for(var e=this.getUncoveredTiles(),t=[],n=0;n<e.length;n++){var i=e[n];if(!t.includes(i))for(var a=n+1;a<e.length;a++){var r=e[a];if(!t.includes(r)&&this.checkTilesMatched(i,r))return t.push(i,r),t}}return[]}},{key:"getAllTiles",value:function(){var e,t=[],n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push.apply(t,v(i))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"playShuffleAnimation",value:(d=t(n().mark((function e(t,i,a){var r,o,s,l=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],o=0;o<t.length;o++)(s=t[o]).animationHandler.toggleCoverAnimations(!0,.5),r.push(s.playShuffleAnim(a));return r.push(gb.sleepAsync(500).then((function(){return Ge.playSound(He.USE_SHUFFLE)}))),r.push(gb.sleepAsync(900).then((function(){for(var e=0;e<t.length;e++){var n=t[e],a=i[e];l.setTileSprite(n,a)}l.sortOrderTiles()}))),e.next=6,Promise.all(r);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"setTileSprite",value:function(e,t){t.skinIdx===ct?e.setGolden(this.getGoldenTileSprite()):e.resetSkinIdx(t.skinIdx),t.isHidden&&e.setHiddenTile(),t.isTarget&&e.setTargetTile()}},{key:"playUndoAnimation",value:(u=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=[]).push(t.animationHandler.playTileUndoAnim()),a.push(i.animationHandler.playTileUndoAnim()),this.sortOrderTiles(),e.next=6,Promise.all(a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"handleReleaseTile",value:function(e){}},{key:"handleTileDestroyed",value:(s=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==(i=this.tilesOnBoard.indexOf(t))&&this.tilesOnBoard.splice(i,1),!this.isAutoFinishing){e.next=4;break}return e.abrupt("return");case 4:0===this.tilesOnBoard.length?this.node.scene.emit(ny.ALL_TILE_DESTROYED):this.tilesOnBoard.length>=2&&(a=2*this.getLeftoverPairCount(),0===this.numberOfMatchPairs&&a===this.tilesOnBoard.length&&this.node.scene.emit(ny.ALL_TILE_COVERED));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"handleTileCreated",value:function(e){if(void 0!==e.layer&&e.tile){var t;if(this.tilesOnBoard.includes(e.tile)||this.tilesOnBoard.push(e.tile),this.maxLayer=Math.max(this.maxLayer,e.layer),this.layerTileMap.has(e.layer))null===(t=this.layerTileMap.get(e.layer))||void 0===t||t.push(e.tile);else this.layerTileMap.set(e.layer,[e.tile]);e.tile.setUncover(!0)}}},{key:"sortOrderTiles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parentNode;if(e){var t,n=e.children,i=[],a=l(n);try{for(a.s();!(t=a.n()).done;){var r=t.value,o=r.getComponent(Pv);if(o&&o.state!==lt.MOVING_TO_MATCH&&o.state!==lt.MATCHED){var s=o.getLayer();i[s]||(i[s]=[]),i[s].push(o)}}}catch(e){a.e(e)}finally{a.f()}for(var u=[],c=0;c<i.length;c++)if(i[c]){i[c].sort((function(e,t){return e.getDepth()-t.getDepth()}));for(var h=0;h<i[c].length;h++){var d=i[c][h],p=d.animationHandler.detachShadow(e);u[c]||(u[c]=[]),u[c].push(p.node)}}for(var f=0,y=0;y<i.length;y++)if(i[y]){var v,g=l(u[y]);try{for(g.s();!(v=g.n()).done;){var m=v.value;m.setSiblingIndex(f),f++}}catch(e){g.e(e)}finally{g.f()}var b,S=l(i[y]);try{for(S.s();!(b=S.n()).done;){var w=b.value;w.node.setSiblingIndex(f),f++}}catch(e){S.e(e)}finally{S.f()}}}}},{key:"calculateNumberOfMatchPairs",value:function(){var e,t=this.getUncoveredTiles(),n=new Map,i=l(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,r=a.skinIdx,o=this.getGroupKeyBySkinIdx(r);n.has(o)||n.set(o,[]),n.get(o).push(a)}}catch(e){i.e(e)}finally{i.f()}var s,u=0,c=l(n.entries());try{for(c.s();!(s=c.n()).done;){var h=g(s.value,2)[1];u+=Math.floor(h.length/2)}}catch(e){c.e(e)}finally{c.f()}this.numberOfMatchPairs=u}},{key:"getUncoveredTiles",value:function(){var e,t=[],n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=l(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered&&t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getCoveredTiles",value:function(){var e,t=[],n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=l(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.isUncovered||t.push(o)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"updateTilesTheme",value:function(){var e,t=De.getCurrentTileBackgroundSprite(),n=l(this.layerTileMap.values());try{for(n.s();!(e=n.n()).done;){var i,a=e.value,r=l(a);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=De.getTileIcon(o.skinIdx.toString());o.setBackgroundSprite(t),o.setHiddenBackgroundSprite(De.getCurrentTileHiddenSprite()),o.setEffectSprites(),s&&o.setItemSprite(s)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"getGoldenTilesCandidates",value:function(){var e,t=new Map,n=l(this.getAllTiles());try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.skinIdx;if(!this.isIgnoredSkin(a)){var r=t.get(a)||[];r.push(i),t.set(a,r)}}}catch(e){n.e(e)}finally{n.f()}var o,s=[],u=l(t.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;if(2===c.length&&(s.push.apply(s,v(c)),4===s.length))return s}}catch(e){u.e(e)}finally{u.f()}var h,d=l(t.values());try{for(d.s();!(h=d.n()).done;){var p=h.value;if(4===p.length)return p.slice(0,4)}}catch(e){d.e(e)}finally{d.f()}var f,y=[],g=l(t.values());try{for(g.s();!(f=g.n()).done;){var m=f.value;if(2===m.length&&!y.includes(m[0])&&(y.push.apply(y,v(m)),y.length>=4))return y.slice(0,4)}}catch(e){g.e(e)}finally{g.f()}return y}},{key:"getReplaceableTilesCombinations",value:function(e){var t,n=new Map,i=l(this.getAllTiles());try{for(i.s();!(t=i.n()).done;){var a=t.value,r=a.skinIdx;if(!this.isIgnoredSkin(r)){var o=n.get(r)||[];o.push(a),n.set(r,o)}}}catch(e){i.e(e)}finally{i.f()}var s,u=[],c=l(n.values());try{for(c.s();!(s=c.n()).done;){var h=s.value,d=h.filter(e||function(){return!0});d.length%2==0&&d.length===h.length&&u.push(v(h))}}catch(e){c.e(e)}finally{c.f()}return u}},{key:"getSymmetricTile",value:function(e){var t=this.layerTileMap.get(e.getLayer())||[],n=(Math.min.apply(Math,v(t.map((function(e){return e.gridPos.x}))))+Math.max.apply(Math,v(t.map((function(e){return e.gridPos.x})))))/2;if(t.length<2)return null;var i,a=l(t);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(r!==e&&(r.gridPos.x-n===-e.gridPos.x+n&&r.gridPos.y===e.gridPos.y))return r}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"isIgnoredSkin",value:function(e){return dt.flowers.includes(e)||dt.seasons.includes(e)}}]),A}(E)).prototype,"specialTileSprites",[nb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),sb=u(rb.prototype,"parentNode",[ib],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ab=rb))||ab);b._RF.pop(),b._RF.push({},"0288aaI3RVMYYIL+L6NxqMw","ItemManager",void 0);var bb,Sb,wb=w.ccclass,kb=w.property,Tb=(codex.analytics,cb=wb("ItemManager"),hb=kb(mb),cb((fb=u((pb=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"tileManager",fb,h(e)),e.itemConfigs={},e.isUsingHint=!1,e.isUsingShuffle=!1,e.useUndoCount=0,e.useShuffleCount=0,e.useHintCount=0,e.enable=!0,e}return o(n,[{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on(ny.USE_ITEM,this.handleUseItem,this),e.on(ny.HIDE_HINT,this.handleEndHint,this),e.on(ny.END_SHUFFLE,this.handleEndShuffle,this)}},{key:"setItemConfig",value:function(e,t){this.itemConfigs[e]=t,this.node.scene.emit(ny.ITEM_CONFIG_CHANGE,e,t)}},{key:"updateItemCount",value:function(){this.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),this.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.UNDO,Zm.getItemCount(et[tt.UNDO])),this.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE]))}},{key:"setEnable",value:function(e){this.enable=e,e&&this.updateItemCount()}},{key:"getIsUsingShuffle",value:function(){return this.isUsingShuffle}},{key:"getItemConfig",value:function(e){return this.itemConfigs[e]}},{key:"resetUsingItems",value:function(){this.isUsingHint=!1,this.isUsingShuffle=!1,this.useUndoCount=0,this.useShuffleCount=0,this.useHintCount=0}},{key:"handleUseItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.enable&&(e===tt.HINT?this.handleUseHint(t):e===tt.UNDO?this.handleUseUndo(t):e===tt.SHUFFLE&&this.handleUseShuffle(t))}},{key:"handleUseHint",value:function(e){if(this.itemConfigs[tt.HINT]!==vt.DISABLE){if(this.tileManager.getNumberOfMatchPairs()<=0)
//! This should not happen in normal gameplay
return console.error("No matchable tiles for hint"),void this.showItemWarnScreen("noMatchableTiles");if(this.isUsingHint)this.showItemWarnScreen("matchableTilesHighlighted");else if(!this.isUsingShuffle)if(this.checkItemCount(tt.HINT))this.spendItem(tt.HINT),this.useHint();else if(e){if(!eb.canWatchAds("hintItem"))return void gt.openScreen(We.SHOP_SCREEN,{source:We.FREE_ITEM_SCREEN});this.showFreeItemScreen(tt.HINT,this.useHint.bind(this))}}}},{key:"handleUseUndo",value:function(e){this.itemConfigs[tt.UNDO]!==vt.DISABLE&&(this.tileManager.getNumberOfCanUndoPair()<=0?this.showItemWarnScreen("Can'tUndo"):this.checkItemCount(tt.UNDO)?(this.spendItem(tt.UNDO),this.useUndo()):e&&this.showFreeItemScreen(tt.UNDO,this.useUndo.bind(this)))}},{key:"handleUseShuffle",value:function(e){if(this.itemConfigs[tt.SHUFFLE]!==vt.DISABLE&&!this.isUsingShuffle)if(this.checkItemCount(tt.SHUFFLE))this.spendItem(tt.SHUFFLE),this.useShuffle();else if(e){if(!eb.canWatchAds("shuffleItem"))return void gt.openScreen(We.SHOP_SCREEN,{source:We.FREE_ITEM_SCREEN});this.showFreeItemScreen(tt.SHUFFLE,this.useShuffle.bind(this))}}},{key:"useHint",value:function(){this.isUsingHint=!0,this.useHintCount++,je.logUseItem(tt.HINT),this.node.scene.emit(ny.SHOW_HINT)}},{key:"useUndo",value:function(){this.useUndoCount++,je.logUseItem(tt.UNDO),this.node.scene.emit(ny.START_UNDO)}},{key:"useShuffle",value:function(){this.isUsingShuffle=!0,this.useShuffleCount++,je.logUseItem(tt.SHUFFLE),this.node.scene.emit(ny.START_SHUFFLE)}},{key:"checkItemCount",value:function(e){return this.itemConfigs[e]===vt.INFINITE||!(Zm.getItemCount(et[e])<=0)}},{key:"spendItem",value:function(e){this.itemConfigs[e]===vt.ENABLE&&Zm.useItem(et[e]),this.node.scene.emit(ny.ITEM_COUNT_CHANGE,e,Zm.getItemCount(et[e]))}},{key:"handleEndHint",value:function(){this.isUsingHint=!1}},{key:"handleEndShuffle",value:function(){this.isUsingShuffle=!1}},{key:"showFreeItemScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i={item:e,successCallback:t,failCallback:n};gt.openScreen(We.FREE_ITEM_SCREEN,i)}},{key:"showItemWarnScreen",value:function(e){var t={message:e,duration:1.5,enableCloseOnTouch:!1};gt.openScreen(We.ITEM_WARN_SCREEN,t)}},{key:"getUseHintCount",value:function(){return this.useHintCount}},{key:"getUseUndoCount",value:function(){return this.useUndoCount}},{key:"getUseShuffleCount",value:function(){return this.useShuffleCount}}]),n}(E)).prototype,"tileManager",[hb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),db=pb))||db);b._RF.pop(),b._RF.push({},"9d3bekBKtpPzpXlL25at3ml","ScoreManager",void 0);var Cb=w.ccclass,Eb=(w.property,Cb("ScoreManager")(((Sb=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).matchedPair=0,e.currentScore=0,e.currentCombo=0,e.currentMatchScore=0,e.currentBonusScore=0,e.lastBonusCombo=0,e.trackCombo=!0,e.trackScore=!0,e.startPlayTime=0,e}return o(n,[{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){var e=this.node.scene;e.on(ny.TWO_TILES_MATCHED,this.handleTilesMatched,this),e.on(ny.TILE_BLOCKED,this.handleTilesCoveredClicked,this),e.on(ny.START_UNDO,this.handleComboBreak,this),e.on(ny.GAME_START,this.resetScore,this)}},{key:"handleTilesMatched",value:function(e){var t=e.worldCenterPosition;if(this.matchedPair++,this.trackCombo&&(this.currentCombo++,Ym.reachCombo(this.currentCombo)),this.trackScore){this.currentMatchScore=this.calculateMatchScore(),this.currentBonusScore=this.calculateBonusScore();var n=this.currentMatchScore+this.currentBonusScore;this.currentScore+=n}this.trackCombo?this.playMatchWithScoreComboAnimation(this.currentMatchScore,this.currentCombo,this.currentBonusScore,t):this.playMatchAnimation(t),this.updateUI()}},{key:"handleTilesCoveredClicked",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.handleComboBreak(),this.playBlockAnimation(e,t,n)}},{key:"handleComboBreak",value:function(){this.currentCombo=0,this.lastBonusCombo=0,this.playUnhighlightText()}},{key:"calculateMatchScore",value:function(){var e=n.SCORE_CONFIG,t=e.baseScore,i=e.comboIncrement,a=e.maxComboScore,r=t+(this.currentCombo-1)*i;return Math.min(r,a)}},{key:"calculateBonusScore",value:function(){var e=n.SCORE_CONFIG,t=e.bonusThreshold,i=e.bonusScores;if(this.currentCombo>=5&&this.currentCombo%t==0&&this.currentCombo>this.lastBonusCombo){this.lastBonusCombo=this.currentCombo;var a,r=Object.keys(i).map(Number).sort((function(e,t){return t-e})),o=l(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(this.currentCombo>=s)return i[s]}}catch(e){o.e(e)}finally{o.f()}}return 0}},{key:"playBlockAnimation",value:function(e,t,n){var i=t;this.gameScene.gameplay.effectManager.playTileBlockedEffect(e,i)}},{key:"playUnhighlightText",value:function(){this.gameScene.gameplay}},{key:"playMatchAnimation",value:function(e){this.gameScene.gameplay.effectManager.playMatchExplosionEffect(3,e)}},{key:"playMatchWithScoreComboAnimation",value:function(e,t,n,i){var a=this.gameScene.gameplay;a.effectManager.playTileMatchEffect(i,e,t,n),a.uiManager.runShowComboAnimation(t)}},{key:"updateUI",value:function(){this.gameScene.gameplay.uiManager.setScoreText(this.currentScore)}},{key:"resetScore",value:function(){this.currentScore=0,this.currentCombo=0,this.lastBonusCombo=0,this.matchedPair=0,this.startPlayTime=Date.now()/1e3,this.updateUI()}},{key:"setCombo",value:function(e){this.currentCombo=e}},{key:"setTrackCombo",value:function(e){this.trackCombo=e}},{key:"setTrackScore",value:function(e){this.trackScore=e}},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getCurrentCombo",value:function(){return this.currentCombo}},{key:"getCurrentMatchScore",value:function(){return this.currentMatchScore}},{key:"getCurrentBonusScore",value:function(){return this.currentBonusScore}},{key:"getMatchedPair",value:function(){return this.matchedPair}},{key:"getCurrentPlayTime",value:function(){return Date.now()/1e3-this.startPlayTime}}]),n}(E)).SCORE_CONFIG={baseScore:240,comboIncrement:40,maxComboScore:600,bonusThreshold:5,bonusScores:{5:40,10:80,15:80,20:120}},bb=Sb))||bb);b._RF.pop(),b._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var Lb=function(){function e(t){if(r(this,e),this.data={},this.gameplay=t.gameplay,!this.gameplay)throw new Error("Gameplay component not found");this.manager=t,this.logDebug()}return o(e,[{key:"logDebug",value:function(){var e=this.constructor.name;console.log("[STATE] ".concat(e))}}]),e}();b._RF.pop(),b._RF.push({},"44cefXAXkxB2qJhBlEIVk0K","AutoFinsishState",void 0);var Ib=function(e){i(c,e);var s,l,u=a(c);function c(e){var t;return r(this,c),(t=u.call(this,e)).disableGameplay(),t.gameplay.uiManager.disableUI(),rt.getSpecialMode()===ft.JOURNEY?t.handleJourneyMode():t.handleNormalMode(),je.logLevelAutoFinish(),t}return o(c,[{key:"handleJourneyMode",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameplay.scoreManager.setTrackCombo(!1),e.next=3,this.gameplay.tileManager.handleAutoFinishMatch();case 3:return e.next=5,this.gameplay.uiManager.journeyBlock.runFinishAnimation(this.gameplay.uiManager.getCenterPosition());case 5:this.gameplay.scoreManager.setTrackCombo(!0),this.nextLevelFromAutoFinish();case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleNormalMode",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameplay.tileManager.handleAutoFinishMatch();case 2:this.nextLevelFromAutoFinish();case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"disableGameplay",value:function(){Ge.turnUpMusic(),this.gameplay.itemManager.setEnable(!1)}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"nextLevelFromAutoFinish",value:function(){var e=this.manager.createNextLevelState();this.manager.change(e)}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){var e=this.manager.createGameOverState();this.manager.change(e)}},{key:"update",value:function(){}}]),c}(Lb);b._RF.pop(),b._RF.push({},"ac9achzrA1MfaQq9nuYDIIB","GameOverState",void 0);var xb=function(e){i(u,e);var s,l=a(u);function u(e){var t;return r(this,u),(t=l.call(this,e)).gameplay.uiManager.disableUI(),t.gameplay.uiManager.runHideAnimation(),t.handleOutOfMoves(),t}return o(u,[{key:"handleOutOfMoves",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.gameplay.tileManager.getTilesOnBoard(),e.next=3,this.gameplay.effectManager.playGameOverEffect(t);case 3:ro.vibrate(300),this.showLoseScreen();case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"showLoseScreen",value:function(){gt.openScreen(We.LOSE_SCREEN)}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}}]),u}(Lb);b._RF.pop(),b._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var Rb=function(e){i(c,e);var s,l,u=a(c);function c(e){var i;return r(this,c),i=u.call(this,e),"CrazyGames"===GameSDK.getSDKName()&&i.processCrazyGamesRequirements(),i.validateTournament(),i.enableUI(),i.updateItem(),at.increaseTryCount(),i.gameplay.setupGameBoard(),i.updateHeader(),i.startGameAsync().then(t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.closeLoadingScreen(),i.gameplay.handleStartGame(),e.next=4,i.gameplay.gameModeManager.start();case 4:i.manager.ready(),i.logLevelStartAnalytics(),i.gameplay.attemptCallCreateShortcut(),at.increaseLevelStartTimes(),i.gameplay.handlePreloadUpcomingScreens();case 9:case"end":return e.stop()}}),e)})))),i}return o(c,[{key:"processCrazyGamesRequirements",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart(),this.showInterAdsCrazyGames()}},{key:"validateTournament",value:function(){!jf.isTournamentHappening()&&jf.isInContextGlobalTournament()&&jf.handleJoinFromPost()}},{key:"updateItem",value:function(){if(this.gameplay){at.getLevel();var e=this.gameplay.itemManager;e.updateItemCount(),e.setItemConfig(tt.HINT,vt.ENABLE),e.setItemConfig(tt.UNDO,vt.INFINITE),e.setItemConfig(tt.SHUFFLE,vt.ENABLE),e.resetUsingItems(),e.setEnable(!0)}}},{key:"showInterAdsCrazyGames",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.gameplay){e.next=2;break}return e.abrupt("return");case 2:return Ge.stopAllSounds(),e.next=5,Ye.showInterstitialAdAsync({forLevel:this.data.level,includeSDK:["CrazyGames"]});case 5:e.sent&&this.gameplay.disableRewardAdsItemForCrazyGames(),Ge.turnUpMusic();case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"load",value:function(){if(Ludex.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"closeLoadingScreen",value:function(){gt.closeLoadingScreen()}},{key:"enableUI",value:function(){var e;null===(e=this.gameplay)||void 0===e||e.uiManager.enableUI()}},{key:"updateHeader",value:function(){}},{key:"startGameAsync",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt.startMatchAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("startGameAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return s.apply(this,arguments)})},{key:"logLevelStartAnalytics",value:function(){je.logLevelStart()}}]),c}(Lb);b._RF.pop(),b._RF.push({},"a8496IbdA1EnY7sv4ApuaJW","LoadingState",void 0);var Ab,_b=function(e){i(c,e);var s,l,u=a(c);function c(e){var t;return r(this,c),(t=u.call(this,e)).handleLoaded=function(){var e,n=at.getLevel();at.getLevelData(n)?(
//! wait until loading screen open
at.preloadLevelDataAsync(n+1),t.loadingScreenFlag?null===(e=t.gameplay)||void 0===e||e.scheduleOnce((function(){t.initialize()}),.5):t.initialize()):console.error("Failed to load level")},t.loadingScreenFlag=!t.isLevelAlreadyLoaded()||!t.isLevelUILoaded(),t.loadingScreenFlag&&gt.showLoadingScreen(),t.updateHeaderTexts(),t.handleLoading(),t}return o(c,[{key:"load",value:function(){}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"isLevelAlreadyLoaded",value:function(){var e=at.getLevel();return at.hasLevelData(e)?!!De.isLoadedCurrentTileTheme()||(console.log("LoadingState: not all needed tile sprites loaded"),!1):(console.log("LoadingState: not has level data"),!1)}},{key:"isLevelUILoaded",value:function(){return!!this.gameplay&&(rt.getCurrentMatchMode()===Ludex.Match.Modes.CHALLENGE_FRIEND?this.gameplay.uiManager.isChallengeUILoaded():rt.getSpecialMode()!==ft.JOURNEY||this.gameplay.uiManager.isJourneyUILoaded())}},{key:"handleLoading",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(this.handleLoadLevelData()),t.push(this.handleLoadUI()),this.handleLoadSounds(),e.next=6,Promise.all(t);case 6:this.handleLoaded();case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleLoadLevelData",value:function(){var e=this;return new Promise((function(t){var n=at.getLevel();
//! Load level data again if not already loaded
at.preloadLevelDataAsync(n).then((function(){De.isLoadedCurrentTileTheme()?e.loadJourney(t):(console.log("LoadingState: load level tile sprites"),De.loadTileThemeSpriteFrames().then((function(){e.loadJourney(t)})))}))}))}},{key:"loadJourney",value:function(e){this.gameplay.journeyLevelMechanicsManager.getMissionType()!==mt.FIND_ARTIFACT||ht.isLoadedCurrentJourneyTileTheme()?e():ht.loadJourneyTileThemeSpriteFrames().then((function(){e()}))}},{key:"handleLoadUI",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=rt.getCurrentMatchMode(),i=rt.getSpecialMode(),t!==Ludex.Match.Modes.CHALLENGE_FRIEND){e.next=11;break}return e.next=5,null===(a=this.gameplay)||void 0===a?void 0:a.uiManager.loadChallengeUI();case 5:if(!this.gameplay){e.next=11;break}if(r=this.gameplay.uiManager,o=r.challengeBlock,s=r.challengePrepare,o&&o.updateChallengeData(),!s){e.next=11;break}return e.next=11,s.updateChallengeData();case 11:if(i!==ft.JOURNEY){e.next=15;break}return e.next=14,null===(l=this.gameplay)||void 0===l?void 0:l.uiManager.loadJourneyUI();case 14:this.gameplay&&(u=this.gameplay.uiManager.journeyBlock,this.gameplay.journeyLevelMechanicsManager.setJourneyBlock(u));case 15:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleLoadSounds",value:function(){for(var e=[He.TILE_SHOW,He.TILE_CLICK,He.TILE_DESELECT,He.TILE_MATCH_1,He.TILE_MATCH_2,He.TILE_MATCH_3,He.TILE_MATCH_4,He.TILE_MATCH_5,He.ENCOURAGE_GOOD,He.ENCOURAGE_GREAT,He.ENCOURAGE_AMAZING,He.ENCOURAGE_AWESOME,He.USE_HINT,He.USE_UNDO,He.USE_SHUFFLE],t=function(){var e=i[n];Ne.loadAudioAsync(e).catch((function(t){console.error("Failed to preload sound: ".concat(e),t)}))},n=0,i=e;n<i.length;n++)t()}},{key:"updateHeaderTexts",value:function(){var e,t,n=at.getLevel(),i=rt.getSpecialMode();if(i===ft.DAILY_CHALLENGE){var a,r=rt.getSpecialModeInfo();null===(a=this.gameplay)||void 0===a||a.uiManager.setDateStringText(r)}else if(i===ft.JOURNEY);else{var o;null===(o=this.gameplay)||void 0===o||o.uiManager.setLevelText(n)}null===(e=this.gameplay)||void 0===e||e.uiManager.setScoreText(0),null===(t=this.gameplay)||void 0===t||t.uiManager.setMatchText(0)}}]),c}(Lb);function Pb(e){return Math.ceil(Math.log2(e+1))}function Bb(e,t){var n,i=Pb(t),a=e.length*i,r=Math.ceil(a/8),o=new Array(r).fill(0),s=0,u=l(e);try{for(u.s();!(n=u.n()).done;)for(var c=n.value,h=0;h<i;h++){var d=Math.floor(s/8),p=s%8,f=c>>h&1;o[d]|=f<<p,s++}}catch(e){u.e(e)}finally{u.f()}return function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0;i<e.length;){var a=e[i++],r=i<e.length?e[i++]:0,o=i<e.length?e[i++]:0,s=(3&a)<<4|r>>4,l=(15&r)<<2|o>>6,u=63&o;n+=t.charAt(a>>2)+t.charAt(s)+(i<=e.length+1?t.charAt(l):"=")+(i<=e.length?t.charAt(u):"=")}return n}(o)}function Nb(e,t,n){for(var i=Pb(n),a=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;i+=4){var a=t.indexOf(e.charAt(i)),r=t.indexOf(e.charAt(i+1)),o="="===e.charAt(i+2)?0:t.indexOf(e.charAt(i+2)),s=a<<2|r>>4,l=(15&r)<<4|o>>2,u=(3&o)<<6|("="===e.charAt(i+3)?0:t.indexOf(e.charAt(i+3)));n.push(s),"="!==e.charAt(i+2)&&n.push(l),"="!==e.charAt(i+3)&&n.push(u)}return n}(e),r=[],o=0,s=0;s<t;s++){for(var l=0,u=0;u<i;u++){var c=o%8;l|=(a[Math.floor(o/8)]>>c&1)<<u,o++}r.push(l)}return r}b._RF.pop(),b._RF.push({},"69771rpnOpHv7uoHCmzgP1X","Base64Utils",void 0),b._RF.pop(),b._RF.push({},"a615d6Weo1L7pb2JJy+isJA","DailyChallengeUtils",void 0);var Ob=2025,Db=2025,Fb=function(){function e(){r(this,e),this.years=[],this.completeDictionary={},this.badges={},this.badgeList=[],this.badgeSprites=new Map}var i,a;return o(e,[{key:"encodeCompleteChallenge",value:function(){var e=[];this.years.sort((function(e,t){return e-t}));var t,n=0,i=l(this.years);try{for(i.s();!(t=i.n()).done;){for(var a=t.value,r=this.isLeapYear(a)?366:365,o=[],s=!1,u=0;u<r;u++){var c=n+u,h=this.completeDictionary[c]?1:0;o.push(h),h&&(s=!0)}if(!s)break;var d=Bb(o,1);e.push("".concat(a,"-").concat(d)),n+=r}}catch(e){i.e(e)}finally{i.f()}return e}},{key:"decodeCompleteChallenge",value:function(e){if(this.completeDictionary={},this.years=[],e&&0!==e.length)try{var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.indexOf("-");if(-1!==a){var r=parseInt(i.slice(0,a));this.years.push(r);for(var o=i.slice(a+1),s=this.isLeapYear(r)?366:365,u=Nb(o,s,1),c=this.getOffsetFromBaseYear(r),h=0;h<s;h++){var d=c+h;1===u[h]&&(this.completeDictionary[d]=!0)}}}}catch(e){n.e(e)}finally{n.f()}}catch(e){console.error("Error decoding daily challenges:",e),this.completeDictionary={}}}},{key:"isLeapYear",value:function(e){return e%4==0&&e%100!=0||e%400==0}},{key:"getOffsetFromBaseYear",value:function(e){for(var t=0,n=Ob;n<e;n++)t+=this.isLeapYear(n)?366:365;return t}},{key:"updatePlayerData",value:function(){var e=this.encodeCompleteChallenge();window.codex.player.setGameData({dailyChallenge:e})}},{key:"getBadgeKey",value:function(e){var t=e.month-1+12*(e.year-Db);return t<0?(console.warn("Invalid badge data:",e),"1"):(t%12+1).toString()}},{key:"loadBadgesOnly",value:(a=t(n().mark((function e(t){var i,a,r,o,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],a=l(t),e.prev=2,o=n().mark((function e(){var t,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.value,a=s.getBadgeKey(t),!s.badgeSprites.has(a)){e.next=4;break}return e.abrupt("return",1);case 4:(o=Ne.loadSpriteFrameAsync("".concat($e.DAILY_BADGE_PREFIX).concat(a,"/spriteFrame"))).then((function(e){s.badgeSprites.set(a,e)})),i.push(o);case 7:case"end":return e.stop()}}),e)})),a.s();case 5:if((r=a.n()).done){e.next=11;break}return e.delegateYield(o(),"t0",7);case 7:if(!e.t0){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(2),a.e(e.t1);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.next=21,Promise.all(i);case 21:case"end":return e.stop()}}),e,null,[[2,13,16,19]])}))),function(e){return a.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"initData",value:function(){var e=window.codex.player.getPlayerData().gameData.dailyChallenge;for(var t in this.inst.completeDictionary={},this.inst.badges={},this.inst.decodeCompleteChallenge(e),this.inst.completeDictionary){var n=parseInt(t),i=new Date(Ob,0,1+n),a=i.getMonth()+1,r=i.getFullYear(),o="".concat(a,"-").concat(r);this.inst.badges[o]=(this.inst.badges[o]||0)+1,this.inst.badges[o]===new Date(r,a,0).getDate()&&this.inst.badgeList.push({month:a,year:r})}this.inst.updatePlayerData()}},{key:"completeChallenge",value:function(e){var t=e.day,n=e.month,i=e.year,a=new Date(Ob,0,1),r=new Date(i,n-1,t).getTime()-a.getTime(),o=Math.floor(r/864e5);if(o<0)console.warn("Invalid challenge date:",e);else if(this.inst.completeDictionary[o])console.log("Challenge already completed:",e);else{this.inst.years.includes(i)||this.inst.years.push(i),this.inst.completeDictionary[o]=!0;var s="".concat(n,"-").concat(i);this.inst.badges[s]=(this.inst.badges[s]||0)+1;var l=new Date(i,n,0).getDate();this.inst.badges[s]===l&&this.inst.badgeList.push({month:n,year:i}),this.inst.updatePlayerData()}}},{key:"isCompletedChallenge",value:function(e){var t=e.day,n=e.month,i=e.year,a=new Date(Ob,0,1),r=new Date(i,n-1,t).getTime()-a.getTime(),o=Math.floor(r/864e5);return o<0?(console.warn("Invalid challenge date:",e),!1):this.inst.completeDictionary[o]}},{key:"getBadges",value:function(){return this.inst.badgeList}},{key:"isCompletedMonth",value:function(e){var t=e.month,n=e.year,i="".concat(t,"-").concat(n);return this.inst.badges[i]===new Date(n,t,0).getDate()}},{key:"loadBadges",value:(i=t(n().mark((function e(t){var i,a,r,o,s,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inst.loadBadgesOnly(t);case 2:i=[],a=l(t);try{for(a.s();!(r=a.n()).done;)o=r.value,s=this.inst.getBadgeKey(o),this.inst.badgeSprites.has(s)||(console.warn("Badge not loaded: ".concat(s)),i.push(o))}catch(e){a.e(e)}finally{a.f()}return i.length>0&&st(500).then((function(){u.inst.loadBadgesOnly(i)})),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getBadgeSpriteFrame",value:function(e){var t=this.inst.getBadgeKey(e);return this.inst.badgeSprites.has(t)&&this.inst.badgeSprites.get(t)||null}},{key:"getRandomLevel",value:function(e,t,n){var i=new Date(2e3,0,1),a=(new Date(n,t-1,e).getTime()-i.getTime())/1e3/3600/24+n%100*97+59*t+43*e;return Math.floor(a%2e3+1001)}},{key:"isNeedLoadDailyChallenge",value:function(e){var t=e||{},n=t.month,i=t.year;if(!n||!i){var a=new Date;n=a.getMonth()+1,i=a.getFullYear()}return!this.getBadgeSpriteFrame({month:n,year:i})}},{key:"isNeedLoadBadge",value:function(){return!e.getBadges().reduce((function(t,n){var i=null!==e.getBadgeSpriteFrame(n);return t&&i}),!0)}},{key:"calculateNextDay",value:function(t){for(var n=t.day,i=t.month,a=t.year,r=-1,o=(new Date).getFullYear(),s=(new Date).getMonth()+1,l=a===o&&i===s?(new Date).getDate():new Date(a,i,0).getDate(),u=n+1;u<=l;u++)if(!e.isCompletedChallenge({day:u,month:i,year:a})){r=u;break}if(-1===r)for(var c=n-1;c>=1;c--)if(!e.isCompletedChallenge({day:c,month:i,year:a})){r=c;break}return-1===r&&(r=l),{day:r,month:i,year:a}}}]),e}();Ab=Fb,Fb.loadingTextureBeforeOpenDailyChallenge=function(){var e=t(n().mark((function e(t){var i,a,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(i=t||{}).month,r=i.year,a&&r||(o=new Date,a=o.getMonth()+1,r=o.getFullYear()),Ab.isNeedLoadDailyChallenge(t)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Ab.loadBadges([{month:a,year:r}]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fb.loadingTextureBeforeOpenBadgeScreen=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ab.getBadges(),Ab.isNeedLoadBadge()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ab.loadBadges(t);case 5:case"end":return e.stop()}}),e)}))),b._RF.pop(),b._RF.push({},"acde5YdsFNFqZHtxkJ8Tuh6","NextLevelState",void 0);var zb=codex,Mb=zb.match,Ub=zb.player,Gb=zb.leaderboard,Hb=(zb.analytics,function(e){i(h,e);var s,l,u,c=a(h);function h(e){var t;r(this,h),(t=c.call(this,e)).disableGameplay();var n=at.getLevel();return t.validateTournament(),t.handleDailyChallenge(),t.handleJourney(),t.handleNextLevel(),t.finishGameAsync(n),t}return o(h,[{key:"disableGameplay",value:function(){this.gameplay.uiManager.disableUI(),this.gameplay.uiManager.runHideAnimation(),this.gameplay.itemManager.setEnable(!1),Ge.turnUpMusic()}},{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"nextLevel",value:function(){}},{key:"autoFinish",value:function(){}},{key:"gameOver",value:function(){}},{key:"update",value:function(){}},{key:"handleDailyChallenge",value:function(){if(rt.getSpecialMode()===ft.DAILY_CHALLENGE){var e=rt.getSpecialModeInfo();Fb.completeChallenge(e)}}},{key:"handleJourney",value:function(){rt.getSpecialMode()===ft.JOURNEY&&(ht.logJourneyCompleteLevel(),ht.increaseLevel())}},{key:"validateTournament",value:function(){!jf.isTournamentHappening()&&jf.isInContextGlobalTournament()&&(console.warn("Tournament is not valid, switching to solo context"),rt.switchToSoloContext())}},{key:"handleNextLevel",value:(u=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.gameplay.scoreManager.getCurrentScore(),i=at.getLevel(),t>Ub.getBestScore()&&Ub.setBestScore(t),jf.inst.isPlayerJoined&&jf.getTournamentRank()<=0?jf.completeLevelPromise=this.updateMatchProfile(t):(jf.completeLevelPromise=void 0,this.updateMatchProfile(t)),this.handleChallengeMatch(t),this.logLevelCompleted(t,i),this.handleNextLevelData(i),console.log("Complete level:",i),a=rt.getCurrentMatchMode(),e.t0=a,e.next=e.t0===ng.SINGLE||e.t0===ng.TOURNAMENT?12:e.t0===ng.CHALLENGE_FRIEND?14:16;break;case 12:return this.showWiningScreen(t,i),e.abrupt("break",16);case 14:return this.showChallengeFriendCompleteScreen(t,i),e.abrupt("break",16);case 16:jf.updateData(),Ym.finishGame();case 18:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"showWiningScreen",value:function(e,t){var n=this.getEndLevelScreenKeyEnum();gt.openScreen(n,{score:e,level:t})}},{key:"getEndLevelScreenKeyEnum",value:function(){var e=this.gameplay.hasGoldenTiles;return rt.getSpecialMode()===ft.JOURNEY?We.JOURNEY_WINNING_SCREEN:jf.inst.isPlayerJoined&&e?We.TOURNAMENT_COMPLETE_SCREEN:We.WINNING_SCREEN}},{key:"showChallengeFriendCompleteScreen",value:function(e,t){gt.openScreen(We.CHALLENGE_FRIEND_COMPLETE_SCREEN,{score:e,level:t})}},{key:"logLevelCompleted",value:function(e,t){je.logLevelEnd(t,e,!0)}},{key:"finishGameAsync",value:(l=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt.finishMatchAsync(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("finishGameAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return l.apply(this,arguments)})},{key:"updateMatchProfile",value:(s=t(n().mark((function e(t){var i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.gameplay.hasGoldenTiles,a=jf.inst.isPlayerJoined&&i,!jf.isInContextGlobalTournament()&&!a){e.next=12;break}if((r=jf.inst.tournamentData).bestScore+=jf.getGoldenTilesPerLevel(),jf.updateTournamentData(r),rt.setProfileMatchDataAsync({id:Ub.getPlayerId(),score:r.bestScore}),jf.isInContextGlobalTournament()||!a){e.next=10;break}return e.next=10,Gb.setLeaderboardScoreAsync(r.leaderboardId,Ub.getPlayerId(),r.bestScore);case 10:e.next=13;break;case 12:rt.setProfileMatchDataAsync({id:Ub.getPlayerId(),score:t});case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"handleChallengeMatch",value:function(e){var t=Mb.getMatchState();if(t&&t.mode===ng.CHALLENGE_FRIEND){var n,i=Ub.getPlayerId();null!==(n=t.profiles)&&void 0!==n&&n[i]&&(t.profiles[i].score=e)}}},{key:"handleNextLevelData",value:function(e){var t=codex.player.getGameData().level;t===e?at.nextLevel():at.setLevel(t)}}]),h}(Lb));b._RF.pop(),b._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var Vb,Wb=function(e){i(n,e);var t=a(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).gameplay.uiManager.enableUI(),i}return o(n,[{key:"load",value:function(){if(Ludex.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"autoFinish",value:function(){var e=this.manager.createGameFinishState();this.manager.change(e)}},{key:"nextLevel",value:function(){var e=this.manager.createNextLevelState();this.manager.change(e)}},{key:"update",value:function(){}},{key:"gameOver",value:function(){var e=this.manager.createGameOverState();this.manager.change(e)}}]),n}(Lb);b._RF.pop(),b._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var qb,jb,Kb,Yb,Jb,Zb,Qb,Xb,$b,eS,tS,nS=(0,w.ccclass)("StateManager")(Vb=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"gameplay",get:function(){return this._gameplay}},{key:"init",value:function(e){this._gameplay=e,this.state=new _b(this)}},{key:"change",value:function(e){this.state=e}},{key:"load",value:function(){this.state.load()}},{key:"initialize",value:function(){this.state.initialize()}},{key:"ready",value:function(){this.state.ready()}},{key:"nextLevel",value:function(){this.state.nextLevel()}},{key:"autoFinish",value:function(){this.state.autoFinish()}},{key:"gameOver",value:function(){this.state.gameOver()}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){return new Rb(this)}},{key:"createLoadingState",value:function(){return new _b(this)}},{key:"createReadyState",value:function(){return new Wb(this)}},{key:"createNextLevelState",value:function(){return new Hb(this)}},{key:"createGameFinishState",value:function(){return new Ib(this)}},{key:"createGameOverState",value:function(){return new xb(this)}},{key:"isGamePlaying",value:function(){return this.state instanceof Wb}}]),n}(E))||Vb;b._RF.pop(),b._RF.push({},"4e147JaekpHbKk0tbNod1MR","DailyQuestHeader",void 0);var iS,aS,rS,oS,sS,lS=w.ccclass,uS=w.property,cS=(w.requireComponent,codex.event),hS=(qb=lS("DailyQuestHeader"),jb=uS(q),Kb=uS(ru),Yb=uS(q),Jb=uS(x),qb((Xb=u((Qb=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"taskTitle",Xb,h(e)),c(e,"progressBar",$b,h(e)),c(e,"progressTitle",eS,h(e)),c(e,"icon",tS,h(e)),e.currentTimeout=void 0,e.onCompleteQuest=function(t){I.getScene().name===bt.GAME_SCENE&&(e.currentTimeout&&(clearTimeout(e.currentTimeout),e.currentTimeout=void 0),e.updateTask(t),e.show(),e.currentTimeout=setTimeout((function(){e.hide()}),2500))},e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.node.active=!1,this.baseX=this.node.position.x,this.baseY=this.node.position.y,this.listenEvents(),this.taskTitleLocalize=this.taskTitle.getComponent(Bd)}},{key:"onDestroy",value:function(){this.unListenEvents()}},{key:"listenEvents",value:function(){cS.on(jm,this.onCompleteQuest)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"unListenEvents",value:function(){cS.off(jm,this.onCompleteQuest)}},{key:"show",value:function(){this.node.active=!0,this.node.position=new U(this.baseX,this.baseY+449,this.node.position.z),z(this.node).to(.5,{position:new U(this.baseX,this.baseY,this.node.position.z)},{easing:ue.backOut}).start()}},{key:"hide",value:function(){var e=this;z(this.node).to(.5,{position:new U(this.baseX,this.baseY+449,this.node.position.z)},{easing:ue.backIn}).call((function(){e.node.active=!1})).start()}},{key:"setTaskTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.taskTitleLocalize||(this.taskTitleLocalize=this.taskTitle.getComponent(Bd)),this.taskTitleLocalize.key=e,this.taskTitleLocalize.setParams(t)}},{key:"setProgressTitle",value:function(e){this.progressTitle.string=e}},{key:"setProgressBar",value:function(e){this.progressBar.setProgress(e)}},{key:"updateTask",value:function(e){var t=[];switch(e.type.name){case"CompleteLevel":case"UseItem":case"Match":t.push(e.target.toString());break;case"ReachCombo":t.push(e.type.minCombo.toString()),t.push(e.target.toString())}this.setTaskTitle(e.description,t),this.setProgressTitle("".concat(e.current,"/").concat(e.target));var n=e.current<=e.target?e.current/e.target:1;this.setProgressBar(n),this.icon.node.active=1===n}}]),n}(E)).prototype,"taskTitle",[jb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$b=u(Qb.prototype,"progressBar",[Kb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eS=u(Qb.prototype,"progressTitle",[Yb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tS=u(Qb.prototype,"icon",[Jb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zb=Qb))||Zb);b._RF.pop(),b._RF.push({},"102bcXZy2xNS5WJJUUDaCPd","EventUIManager",void 0);var dS,pS,fS,yS,vS,gS,mS,bS,SS,wS,kS,TS,CS,ES,LS,IS=w.ccclass,xS=w.property,RS=(iS=IS("EventUIManager"),aS=xS(P),iS((sS=u((oS=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"headerParent",sS,h(e)),e.dailyQuestHeader=null,e}return o(n,[{key:"start",value:function(){this.createDailyQuestHeader()}},{key:"createDailyQuestHeader",value:function(){var e=this;this.dailyQuestHeader?this.dailyQuestHeader.node.active=!0:(Ne.loadPrefabAsync($e.DAILY_QUEST_HEADER_PREFAB).then((function(t){e.dailyQuestHeader=$(t).getComponent(hS),e.dailyQuestHeader.node.setParent(e.headerParent)})),console.log("DailyQuestHeader created"))}}]),n}(E)).prototype,"headerParent",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rS=oS))||rS);b._RF.pop(),b._RF.push({},"193a0wYCqRC97SFD7aKGmaE","ItemButtonContainer",void 0);var AS,_S,PS,BS,NS,OS,DS,FS,zS,MS=w.ccclass,US=w.property,GS=(dS=MS("ItemButtonContainer"),pS=US({type:J(tt)}),fS=US(D),yS=US(x),vS=US(q),gS=US(x),mS=US([le]),dS((wS=u((SS=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"itemEnum",wS,h(e)),c(e,"buttonComponent",kS,h(e)),c(e,"counterSprite",TS,h(e)),c(e,"counterLabel",CS,h(e)),c(e,"counterInfinitySprite",ES,h(e)),c(e,"counterSpriteFrames",LS,h(e)),e.isInfinity=!1,e}return o(n,[{key:"setActive",value:function(e){this.node.active=e}},{key:"setInteractable",value:function(e){this.buttonComponent.interactable=e}},{key:"setCounter",value:function(e){this.isInfinity||(e<=0?(this.counterLabel.string="",this.counterSprite.spriteFrame=this.counterSpriteFrames[0]):(this.counterLabel.string=e.toString(),this.counterSprite.spriteFrame=this.counterSpriteFrames[1]))}},{key:"setInfinity",value:function(e){this.isInfinity=e,e?(this.counterLabel.node.active=!1,this.counterSprite.spriteFrame=this.counterSpriteFrames[1]):this.counterLabel.node.active=!0,this.counterInfinitySprite.node.active=e}}]),n}(E)).prototype,"itemEnum",[pS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kS=u(SS.prototype,"buttonComponent",[fS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TS=u(SS.prototype,"counterSprite",[yS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CS=u(SS.prototype,"counterLabel",[vS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ES=u(SS.prototype,"counterInfinitySprite",[gS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LS=u(SS.prototype,"counterSpriteFrames",[mS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bS=SS))||bS);b._RF.pop(),b._RF.push({},"14e060+CQZBg5pxaWXrlnuC","Footer",void 0);var HS,VS,WS,qS,jS,KS,YS,JS,ZS,QS=w.ccclass,XS=w.property,$S=Ludex.Utils.Signal,ew=(AS=QS("Footer"),_S=XS(GS),PS=XS(GS),BS=XS(GS),AS((DS=u((OS=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"hintButton",DS,h(e)),c(e,"undoButton",FS,h(e)),c(e,"shuffleButton",zS,h(e)),e.widget=null,e.uiTransform=null,e.defaultBottom=-350,e.moveSignalController=new $S.SignalController,e}return o(u,[{key:"height",get:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(R)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||0}},{key:"positionY",get:function(){return this.postAdsPositionY}},{key:"onDestroy",value:function(){this.node.scene.off(ny.ITEM_CONFIG_CHANGE,this.handleItemConfigChange,this),this.node.scene.off(ny.ITEM_COUNT_CHANGE,this.handleItemCountChange,this)}},{key:"onLoad",value:function(){var e=Ye.getBannerAdsHeight();this.widget||(this.widget=this.node.getComponent(H)),this.widget&&e&&(this.widget.bottom=e),this.defaultBottom=e,console.log("Footer: onLoad",this.widget.bottom,e),this.validateRequiredComponents(),this.listenEvents()}},{key:"start",value:function(){this.postAdsPositionY=this.node.position.y,this.runHideAnimation(0)}},{key:"listenEvents",value:function(){this.node.scene.on(ny.ITEM_CONFIG_CHANGE,this.handleItemConfigChange,this),this.node.scene.on(ny.ITEM_COUNT_CHANGE,this.handleItemCountChange,this)}},{key:"handleItemCountChange",value:function(e,t){e===tt.HINT?this.hintButton.setCounter(t):e===tt.UNDO?this.undoButton.setCounter(t):e===tt.SHUFFLE&&this.shuffleButton.setCounter(t)}},{key:"handleItemConfigChange",value:function(e,t){e===tt.HINT?(this.hintButton.setActive(t!==vt.DISABLE),this.hintButton.setInfinity(t===vt.INFINITE)):e===tt.UNDO?(this.undoButton.setActive(t!==vt.DISABLE),this.undoButton.setInfinity(t===vt.INFINITE)):e===tt.SHUFFLE&&(this.shuffleButton.setActive(t!==vt.DISABLE),this.shuffleButton.setInfinity(t===vt.INFINITE))}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"disableButtons",value:function(){this.hintButton.setInteractable(!1),this.undoButton.setInteractable(!1),this.shuffleButton.setInteractable(!1)}},{key:"enableButtons",value:function(){this.hintButton.setInteractable(!0),this.undoButton.setInteractable(!0),this.shuffleButton.setInteractable(!0)}},{key:"runShowAnimation",value:function(e){if(this.node.active=!0,e<=0)return this.moveSignalController.abort(),void(this.widget.bottom=this.defaultBottom);var t=this.moveSignalController.renew(),n=z(this.widget).to(e,{bottom:this.defaultBottom},{easing:"backOut"});Ke.runTweenAsync(n,t)}},{key:"runHideAnimation",value:(s=t(n().mark((function e(t){var i,a,r,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_.getVisibleSize().height,!(t<=0)){e.next=6;break}return this.moveSignalController.abort(),this.widget.bottom=this.defaultBottom-i/4,this.node.active=!1,e.abrupt("return");case 6:return a=this.moveSignalController.renew(),r=z(this.widget).to(t,{bottom:this.defaultBottom-i/4},{easing:"backIn"}).call((function(){o.node.active=!1})),e.next=10,Ke.runTweenAsync(r,a);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"handleClickHintButton",value:function(){console.log("handleClickHintButton"),this.node.scene.emit(ny.USE_ITEM,tt.HINT,!0,u.name)}},{key:"handleClickUndoButton",value:function(){console.log("handleClickUndoButton"),this.node.scene.emit(ny.USE_ITEM,tt.UNDO,!0,u.name)}},{key:"handleClickShuffleButton",value:function(){console.log("handleClickShuffleButton"),this.node.scene.emit(ny.USE_ITEM,tt.SHUFFLE,!0,u.name)}}]),u}(E)).prototype,"hintButton",[_S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FS=u(OS.prototype,"undoButton",[PS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zS=u(OS.prototype,"shuffleButton",[BS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NS=OS))||NS);b._RF.pop(),b._RF.push({},"b944dFTE2NIL6O1YyyzwMDx","PlayerAvatar",void 0);var tw,nw,iw,aw,rw,ow,sw,lw,uw,cw,hw,dw=w.ccclass,pw=w.property,fw=(HS=dw("PlayerAvatar"),VS=pw(x),WS=pw(q),qS=pw(le),HS((YS=u((KS=function(e){i(p,e);var s,l,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"avatar",YS,h(e)),c(e,"playerName",JS,h(e)),c(e,"baseSpriteFrame",ZS,h(e)),e}return o(p,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.uiTransform=this.avatar.node.getComponent(R)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updatePlayerAvatar",value:(u=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playerName.string=t.playerName,e.next=3,this.setAvatar(t.avatarUrl);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setAvatar",value:(l=t(n().mark((function e(t){var i,a,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.avatar){e.next=2;break}return e.abrupt("return");case 2:if(t&&""!==t){e.next=5;break}return this.avatar.spriteFrame=this.baseSpriteFrame,e.abrupt("return");case 5:return e.next=7,Ludex.Utils.Image.loadImage(t||"");case 7:if(i=e.sent,a=le.createWithImage(i)){e.next=13;break}return this.avatar.spriteFrame=this.baseSpriteFrame,this.scheduleOnce((function(){r.preloadAvatar(t)}),1),e.abrupt("return");case 13:this.avatar.spriteFrame=a;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"preloadAvatar",value:(s=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ludex.Utils.Image.loadImage(t||"");case 2:if(i=e.sent,a=le.createWithImage(i)){e.next=7;break}return console.warn("Failed to preload avatar image:",t),e.abrupt("return");case 7:this.avatar.spriteFrame=a;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})}]),p}(E)).prototype,"avatar",[VS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JS=u(KS.prototype,"playerName",[WS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZS=u(KS.prototype,"baseSpriteFrame",[qS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jS=KS))||jS);b._RF.pop(),b._RF.push({},"655e6G+LGZPF6nEre9OWJx9","ChallengeBlock",void 0);var yw,vw,gw,mw,bw,Sw,ww,kw,Tw,Cw,Ew,Lw,Iw=w.ccclass,xw=w.property,Rw=(w.requireComponent,codex),Aw=Rw.player,_w=Rw.match,Pw=(tw=Iw("ChallengeBlock"),nw=xw(fw),iw=xw(fw),aw=xw(q),rw=xw(q),tw((lw=u((sw=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"playerAvatar",lw,h(e)),c(e,"opponentAvatar",uw,h(e)),c(e,"playerScore",cw,h(e)),c(e,"opponentScore",hw,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updateChallengeData",value:function(){this.updatePlayerChallengeData(),this.updateOpponentChallengeData()}},{key:"updatePlayerChallengeData",value:function(){var e=Aw.getPlayer().playerId,t=codex.match.getMatchState().profiles;if(!t||!t[e])return console.warn("Player profile not found in match state"),void this.playerAvatar.updatePlayerAvatar({playerName:"You",avatarUrl:""});var n=t[e],i=n.name,a=n.photo,r=n.score,o=void 0===r?0:r;this.playerAvatar.updatePlayerAvatar({playerName:i,avatarUrl:a}),this.playerScore.string=o.toString()}},{key:"updateOpponentChallengeData",value:function(){var e=_w.getMatchState().customData.opponentId,t=codex.match.getMatchState().profiles;if(!t||!t[e])return console.warn("Player profile not found in match state"),void this.opponentAvatar.updatePlayerAvatar({playerName:"Your friend",avatarUrl:""});var n=t[e],i=n.name,a=n.photo,r=n.score,o=void 0===r?0:r;this.opponentAvatar.updatePlayerAvatar({playerName:i,avatarUrl:a}),this.opponentScore.string=o.toString()}},{key:"setPlayerScoreText",value:function(e){this.playerScore.string=e.toString()}}]),n}(E)).prototype,"playerAvatar",[nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uw=u(sw.prototype,"opponentAvatar",[iw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cw=u(sw.prototype,"playerScore",[aw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hw=u(sw.prototype,"opponentScore",[rw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ow=sw))||ow);b._RF.pop(),b._RF.push({},"6ebbbXu0D9KaIDvuqL2XNW8","PlayerAvatarWithFlag",void 0);var Bw,Nw,Ow,Dw,Fw,zw,Mw,Uw,Gw,Hw,Vw,Ww,qw,jw,Kw,Yw,Jw,Zw=w.ccclass,Qw=w.property,Xw=w.executeInEditMode,$w=(yw=Zw("PlayerAvatarWithFlag"),vw=Xw(!0),gw=Qw(fw),mw=Qw(q),bw=Qw(x),Sw=Qw(P),yw(ww=vw((Tw=u((kw=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"playerAvatar",Tw,h(e)),c(e,"scoreLabel",Cw,h(e)),c(e,"glow",Ew,h(e)),c(e,"medal",Lw,h(e)),e}return o(n,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.glow.node.active=!1}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"runGlowRotateAnimation",value:function(){this.glow.node.active||(this.glow.node.active=!0,this.glow.node.angle=0,this.glowTween||(this.glowTween=z(this.glow.node).set({angle:0}).by(5,{angle:360},{easing:"linear"}).repeatForever()),this.glowTween.start())}},{key:"stopGlowRotateAnimation",value:function(){var e;this.glow.node.active&&(this.glow.node.angle=0,this.glow.node.active=!1,null===(e=this.glowTween)||void 0===e||e.stop())}},{key:"updateState",value:function(e){switch(e){case"win":this.medal.active=!0,this.runGlowRotateAnimation();break;case"lose":case"waiting":this.medal.active=!1,this.stopGlowRotateAnimation()}}}]),n}(E)).prototype,"playerAvatar",[gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cw=u(kw.prototype,"scoreLabel",[mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ew=u(kw.prototype,"glow",[bw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=u(kw.prototype,"medal",[Sw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ww=kw))||ww)||ww);b._RF.pop(),b._RF.push({},"41014it/XdB5Y0t7yR+iDx/","ChallengePrepare",void 0);var ek,tk,nk,ik,ak,rk=w.ccclass,ok=w.property,sk=(w.requireComponent,codex),lk=sk.player,uk=(sk.event,sk.match),ck=(Bw=rk("ChallengePrepare"),Nw=ok(N),Ow=ok($w),Dw=ok($w),Fw=ok(x),zw=ok(P),Mw=ok(P),Uw=ok(N),Bw((Vw=u((Hw=function(e){i(y,e);var s,l,u,d,p,f=a(y);function y(){var e;r(this,y);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=f.call.apply(f,[this].concat(n)),c(e,"backgroundMask",Vw,h(e)),c(e,"playerAvatarWithFlag",Ww,h(e)),c(e,"opponentAvatarWithFlag",qw,h(e)),c(e,"vsIcon",jw,h(e)),c(e,"blueBG",Kw,h(e)),c(e,"redBG",Yw,h(e)),c(e,"light",Jw,h(e)),e}return o(y,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.playerAvatarOpacity=this.playerAvatarWithFlag.getComponent(N),this.opponentAvatarOpacity=this.opponentAvatarWithFlag.getComponent(N),this.vsIconOpacity=this.vsIcon.getComponent(N),this.backgroundMask.opacity=0,this.backgroundMask.node.active=!1,this.playerAvatarOpacity.opacity=0,this.opponentAvatarOpacity.opacity=0,this.vsIconOpacity.opacity=0,this.basePlayerAvatarPosition={x:this.playerAvatarWithFlag.node.position.x,y:this.playerAvatarWithFlag.node.position.y},this.baseOpponentAvatarPosition={x:this.opponentAvatarWithFlag.node.position.x,y:this.opponentAvatarWithFlag.node.position.y},this.blueBGOpacity=this.blueBG.getComponent(N),this.redBGOpacity=this.redBG.getComponent(N),this.blueBGUITransform=this.blueBG.getComponent(R),this.redBGUITransform=this.redBG.getComponent(R)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updateChallengeData",value:(p=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(this.updatePlayerChallengeData()),t.push(this.updateOpponentChallengeData()),e.next=5,Promise.all(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updatePlayerChallengeData",value:(d=t(n().mark((function e(){var t,i,a,r,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=lk.getPlayer(),i=t.playerId,a=codex.match.getMatchState(),(r=a.profiles)&&r[i]){e.next=5;break}return console.warn("Player profile not found in match state"),e.abrupt("return");case 5:return o=r[i],s=o.name,l=o.photo,e.next=8,this.playerAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:s,avatarUrl:l});case 8:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"updateOpponentChallengeData",value:(u=t(n().mark((function e(){var t,i,a,r,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=uk.getMatchState(),i=t.customData.opponentId,a=codex.match.getMatchState(),(r=a.profiles)&&r[i]){e.next=6;break}return console.warn("Player profile not found in match state"),e.abrupt("return");case 6:return o=r[i],s=o.name,l=o.photo,e.next=9,this.opponentAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:s,avatarUrl:l});case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"resizeBeforeRunAnimation",value:function(){var e=_.getVisibleSize(),t=e.width,n=(e.height-254)/2,i=this.blueBGUITransform.contentSize,a=i.width,r=i.height,o=this.redBGUITransform.contentSize,s=o.width,l=o.height;if(Fe.getCurrentLayout()===ze.Layout.Portrait)this.blueBG.setScale(new U(t/a,n/r,1)),this.redBG.setScale(new U(t/s,n/l,1));else{var u=.7*t;this.blueBG.setScale(new U(u/a,n/r,1)),this.redBG.setScale(new U(u/s,n/l,1))}}},{key:"runAnimationPrepareChallenge",value:(l=t(n().mark((function e(){var t,i,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resizeBeforeRunAnimation(),this.backgroundMask.node.active=!0,this.backgroundMask.opacity=0,this.playerAvatarOpacity.opacity=0,this.opponentAvatarOpacity.opacity=0,this.vsIconOpacity.opacity=0,this.vsIcon.node.setScale(new U(0,0,1)),this.blueBGOpacity.opacity=0,this.redBGOpacity.opacity=0,this.light.opacity=0,this.playerAvatarWithFlag.node.setPosition(this.basePlayerAvatarPosition.x+500,this.basePlayerAvatarPosition.y),this.opponentAvatarWithFlag.node.setPosition(this.baseOpponentAvatarPosition.x-500,this.baseOpponentAvatarPosition.y),t=.45,i=.3,z(this.backgroundMask).to(t,{opacity:204}).start(),z(this.playerAvatarWithFlag.node).to(t,{x:this.basePlayerAvatarPosition.x,y:this.basePlayerAvatarPosition.y}).start(),z(this.playerAvatarOpacity).to(i,{opacity:255}).start(),z(this.opponentAvatarWithFlag.node).to(t,{x:this.baseOpponentAvatarPosition.x,y:this.baseOpponentAvatarPosition.y}).start(),z(this.opponentAvatarOpacity).to(i,{opacity:255}).start(),z(this.blueBGOpacity).to(i,{opacity:255}).start(),z(this.redBGOpacity).to(i,{opacity:255}).start(),z(this.light).to(i,{opacity:255}).start(),z(this.vsIconOpacity).to(i,{opacity:255}).start(),z(this.vsIcon.node).to(t,{scale:new U(1,1,1)}).start(),e.abrupt("return",new Promise((function(e){st(Math.max(t,i)).then((function(){e(),a.runFadeOutAnimation(i,.75).then((function(){try{a.backgroundMask.opacity=0,a.playerAvatarOpacity.opacity=0,a.opponentAvatarOpacity.opacity=0,a.vsIconOpacity.opacity=0,a.backgroundMask.node.active=!1}catch(e){}}))}))})));case 26:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"runFadeOutAnimation",value:(s=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:.3,i=a.length>1&&void 0!==a[1]?a[1]:0,z(this.backgroundMask).delay(i).to(t,{opacity:0}).start(),z(this.playerAvatarOpacity).delay(i).to(t,{opacity:0}).start(),z(this.opponentAvatarOpacity).delay(i).to(t,{opacity:0}).start(),z(this.blueBGOpacity).delay(i).to(t,{opacity:0}).start(),z(this.redBGOpacity).delay(i).to(t,{opacity:0}).start(),z(this.light).delay(i).to(t,{opacity:0}).start(),z(this.vsIconOpacity).delay(i).to(t,{opacity:0}).start(),z(this.vsIcon.node).delay(i).to(t,{scale:new U(0,0,1)}).start(),e.abrupt("return",new Promise((function(e){st(i+t).then((function(){e()}))})));case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),y}(E)).prototype,"backgroundMask",[Nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ww=u(Hw.prototype,"playerAvatarWithFlag",[Ow],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qw=u(Hw.prototype,"opponentAvatarWithFlag",[Dw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jw=u(Hw.prototype,"vsIcon",[Fw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kw=u(Hw.prototype,"blueBG",[zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yw=u(Hw.prototype,"redBG",[Mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jw=u(Hw.prototype,"light",[Uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gw=Hw))||Gw);b._RF.pop(),b._RF.push({},"05852I/xmhCyadhw9xtxUjf","ComboNumber",void 0);var hk,dk,pk,fk,yk,vk,gk,mk,bk,Sk,wk,kk,Tk,Ck,Ek,Lk,Ik,xk,Rk=w.ccclass,Ak=w.property,_k=(ek=Rk("ComboNumber"),tk=Ak(x),ek((ak=u((ik=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"comboNumberSprite",ak,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"setComboNumber",value:function(e){this.comboNumberSprite.spriteFrame=e}}]),n}(E)).prototype,"comboNumberSprite",[tk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nk=ik))||nk);b._RF.pop(),b._RF.push({},"4b919O7ovpFR4PdgLD9Eopa","ComboText",void 0);var Pk,Bk,Nk,Ok,Dk,Fk,zk,Mk=w.ccclass,Uk=w.property,Gk=(hk=Mk("ComboText"),dk=Uk(k),pk=Uk(P),fk=Uk(ce),yk=Uk(x),vk=Uk(X),gk=Uk(_k),mk=Uk(le),hk((wk=u((Sk=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"animationComponent",wk,h(e)),c(e,"parentNode",kk,h(e)),c(e,"comboNumberLayout",Tk,h(e)),c(e,"glowEffectSprite",Ck,h(e)),c(e,"showClipName",Ek,h(e)),c(e,"comboNumberPrefab",Lk,h(e)),c(e,"spawnedComboNumber",Ik,h(e)),c(e,"numebrSprites",xk,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.parentNode.active=!1}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"runShowComboTextAnimation",value:function(e,t){var n,i,a=this;this.setComboNumber(e),this.parentNode.active=!0,this.comboNumberLayout.updateLayout(!0);var r=null!==(n=null===(i=this.comboNumberLayout.getComponent(R))||void 0===i?void 0:i.contentSize.x)&&void 0!==n?n:0;this.glowEffectSprite.node.position=new U(this.comboNumberLayout.node.position.x+r/2,this.glowEffectSprite.node.position.y,this.glowEffectSprite.node.position.z),this.parentNode.active=!1,this.scheduleOnce((function(){a.runAnimation(a.showClipName)}),t)}},{key:"stopShowComboAnimation",value:function(){this.unscheduleAllCallbacks(),this.animationComponent.stop(),this.parentNode.active=!1}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"setComboNumber",value:function(e){for(var t=0;t<this.spawnedComboNumber.length;t++){var n=this.spawnedComboNumber[t];n&&(n.node.active=!1)}for(var i=e,a=[];i>0;){var r=i%10;i=Math.floor(i/10),a.push(r)}a.reverse();for(var o=0;o<a.length;o++){var s,l,u=null!==(s=a[o])&&void 0!==s?s:0,c=null!==(l=this.spawnedComboNumber[o])&&void 0!==l?l:this.spawnComboNumber(),h=this.getSpriteFrameByNumber(u);if(!c||!h)return;c.node.active=!0,c.setComboNumber(h)}}},{key:"getSpriteFrameByNumber",value:function(e){var t;return e<0||e>=this.numebrSprites.length?null:null!==(t=this.numebrSprites[e])&&void 0!==t?t:null}},{key:"spawnComboNumber",value:function(){var e=$(this.comboNumberPrefab),t=e.getComponent(_k);return t?(this.spawnedComboNumber.push(t),this.comboNumberLayout.node.addChild(e),t):null}}]),n}(E)).prototype,"animationComponent",[dk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kk=u(Sk.prototype,"parentNode",[pk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tk=u(Sk.prototype,"comboNumberLayout",[fk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ck=u(Sk.prototype,"glowEffectSprite",[yk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ek=u(Sk.prototype,"showClipName",[Uk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ComboTextShow"}}),Lk=u(Sk.prototype,"comboNumberPrefab",[vk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ik=u(Sk.prototype,"spawnedComboNumber",[gk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xk=u(Sk.prototype,"numebrSprites",[mk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bk=Sk))||bk);b._RF.pop(),b._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var Hk,Vk,Wk,qk,jk,Kk,Yk,Jk,Zk,Qk=w.ccclass,Xk=w.property,$k=codex,eT=$k.player,tT=($k.analytics,Ludex.Utils.Signal),nT=(Pk=Qk("Header"),Bk=Xk(P),Nk=Xk(P),Pk((Fk=u((Dk=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"pauseNode",Fk,h(e)),c(e,"backNode",zk,h(e)),e.uiTransform=null,e.widget=null,e.moveSignalController=new tT.SignalController,e}return o(d,[{key:"height",get:function(){var e;return this.uiTransform||(this.uiTransform=this.getComponent(R)),(null===(e=this.uiTransform)||void 0===e?void 0:e.height)||0}},{key:"positionY",get:function(){return this.postAdsPositionY}},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"onLoad",value:function(){this.widget||(this.widget=this.getComponent(H)),this.validateRequiredComponents()}},{key:"start",value:function(){this.postAdsPositionY=this.node.position.y,this.runHideAnimation(0)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleClickedPauseGame",value:function(){this.showSettingScreen(),this.node.scene.emit(ny.GAME_PAUSE)}},{key:"handleClickedReplayGame",value:function(){var e,t=(null!==(e=eT.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;this.node.scene.emit(ny.GAME_REPLAY,{level:n})}},{key:"handleClickDashboardButton",value:(l=t(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.logEndGame(),this.node.scene.emit(ny.GAME_PAUSE),this.node.scene.emit(ny.SWITCH_SCENE,(function(){t.handleSwitchToDashboardScene()}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleSwitchToDashboardScene",value:function(){if(rt.getSpecialMode()===ft.JOURNEY&&!ht.canUpdateIncreaseSeason())return void St.switchToDashboardScene({screen:We.JOURNEY_LEVEL_SCREEN,screenData:{customData:{completedLevel:ht.getCompletedLevel(),useNextLevelAnimation:!1},openAnimationName:"FadeInInstant"}});St.switchToDashboardScene()}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=at.getLevel(),n=e.getCurrentScore();je.logLevelEnd(t,n,!1)}},{key:"showSettingScreen",value:function(){gt.openScreen(We.SETTINGS_SCREEN,{})}},{key:"disableButtons",value:function(){this.enableBtnNode(this.pauseNode,!1,!0),this.enableBtnNode(this.backNode,!1,!0)}},{key:"enableButtons",value:function(){this.enableBtnNode(this.pauseNode,!0,!0),this.enableBtnNode(this.backNode,!0,!0)}},{key:"runShowAnimation",value:function(e){if(this.node.active=!0,e<=0)return this.moveSignalController.abort(),void(this.widget.top=0);var t=this.moveSignalController.renew(),n=z(this.widget).to(e,{top:0},{easing:"backOut"});Ke.runTweenAsync(n,t)}},{key:"runHideAnimation",value:(s=t(n().mark((function e(t){var i,a,r,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_.getVisibleSize().height,!(t<=0)){e.next=6;break}return this.moveSignalController.abort(),this.widget.top=-i/4,this.node.active=!1,e.abrupt("return");case 6:return a=this.moveSignalController.renew(),r=z(this.widget).to(t,{top:-i/4},{easing:"backIn"}).call((function(){o.node.active=!1})),e.next=10,Ke.runTweenAsync(r,a);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"enableBtnNode",value:function(e,t,n){var i=e.getComponent(D);if(i&&(i.interactable=t),e.active=n,n){var a=e.getComponent(as);a&&a.changeState(t)}}}]),d}(E)).prototype,"pauseNode",[Bk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zk=u(Dk.prototype,"backNode",[Nk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ok=Dk))||Ok);b._RF.pop(),b._RF.push({},"2eef7j8rrtGmpY2hcs0A7yh","HeaderTileMatchProjectile",void 0);var iT,aT,rT,oT,sT,lT,uT,cT,hT,dT,pT,fT,yT,vT,gT,mT=w.ccclass,bT=w.property,ST=(Ludex.Utils.Signal,Hk=mT("HeaderTileMatchProjectile"),Vk=bT(he),Wk=bT(ae),qk=bT(ae),Hk((Yk=u((Kk=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"motionStreakComponent",Yk,h(e)),c(e,"trailSystemComponent",Jk,h(e)),c(e,"explodeSystemComponent",Zk,h(e)),e}return o(u,[{key:"reset",value:function(){this.node.setPosition(new U(0,0,0)),this.node.active=!0,this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1,this.trailSystemComponent.resetSystem()}},{key:"hide",value:function(){this.node.setPosition(new U(0,0,0)),this.node.active=!1,this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1}},{key:"playCollectAnimation",value:(s=t(n().mark((function e(t,i,a,r,o,s){var l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.motionStreakComponent.node.active=!0,this.trailSystemComponent.node.active=!0,l=Ke.runTweenAsync(z(this.node).delay(o).to(.3,{worldPositionX:r},{easing:"sineOut"}).to(.35,{worldPositionX:i},{easing:"sineIn"}),t),Ke.runTweenAsync(z(this.node).delay(o).to(.65,{worldPositionY:a},{easing:"sineIn"}),t),e.next=6,l;case 6:null==s||s(),this.motionStreakComponent.node.active=!1,this.trailSystemComponent.node.active=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,r){return s.apply(this,arguments)})},{key:"playExplodeAnimation",value:function(e){this.explodeSystemComponent.resetSystem()}}]),u}(E)).prototype,"motionStreakComponent",[Vk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jk=u(Kk.prototype,"trailSystemComponent",[Wk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zk=u(Kk.prototype,"explodeSystemComponent",[qk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jk=Kk))||jk);b._RF.pop(),b._RF.push({},"c796dG6wFFGM5XaOlhgskWL","TileStatContainer",void 0);var wT,kT,TT,CT,ET,LT,IT,xT,RT,AT,_T,PT,BT,NT=w.ccclass,OT=w.property,DT=(iT=NT("TileStatContainer"),aT=OT(x),rT=OT(x),oT=OT(x),sT=OT(q),lT=OT(x),uT=OT(P),iT((dT=u((hT=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"backgroundSprite",dT,h(e)),c(e,"itemSprite",pT,h(e)),c(e,"coverEffect",fT,h(e)),c(e,"countLabel",yT,h(e)),c(e,"checkSprite",vT,h(e)),c(e,"parentTile",gT,h(e)),e}return o(n,[{key:"setJourneyMissionTileSet",value:function(e,t){this.journeyMissionTileSet=e,t?this.countLabel.node.setPosition(0,-43):this.countLabel.node.setPosition(40,-43),this.updateCount(e.count)}},{key:"updateCount",value:function(e){e>0?(this.countLabel.string=e.toString(),this.countLabel.enabled=!0,this.checkSprite.node.active=!1):(this.countLabel.enabled=!1,this.checkSprite.node.active=!0)}},{key:"updateSprite",value:function(e,t,n){this.backgroundSprite.node.active=!!e,this.backgroundSprite.spriteFrame=e,this.itemSprite.node.active=!!t,this.itemSprite.spriteFrame=t,this.coverEffect.node.active=!!n,this.coverEffect.spriteFrame=n}}]),n}(E)).prototype,"backgroundSprite",[aT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pT=u(hT.prototype,"itemSprite",[rT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fT=u(hT.prototype,"coverEffect",[oT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yT=u(hT.prototype,"countLabel",[sT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=u(hT.prototype,"checkSprite",[lT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gT=u(hT.prototype,"parentTile",[uT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cT=hT))||cT);b._RF.pop(),b._RF.push({},"623a4S+KKJHa5mExB5qXd7o","JourneyBlock",void 0);var FT,zT,MT,UT,GT,HT,VT,WT,qT,jT,KT,YT,JT,ZT=w.ccclass,QT=w.property,XT=Ludex.Utils.Signal,$T=(wT=ZT("JourneyBlock"),kT=QT(ce),TT=QT(X),CT=QT(X),ET=QT(P),LT=QT(N),wT((RT=u((xT=function(e){i(y,e);var s,u,d,p,f=a(y);function y(){var e;r(this,y);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=f.call.apply(f,[this].concat(n)),c(e,"layout",RT,h(e)),c(e,"tileStatContainerPrefab",AT,h(e)),c(e,"headerTileMatchProjectilePrefab",_T,h(e)),c(e,"glowNode",PT,h(e)),c(e,"opacity",BT,h(e)),e.totalCount=0,e.signalController=new XT.SignalController,e.activeTileStatContainers=[],e.inactiveTileStatContainers=[],e.projectiles=[],e}return o(y,[{key:"onEnable",value:function(){this.listenEvents(),this.signal=this.signalController.renew()}},{key:"onDisable",value:function(){this.unlistenEvents(),this.signal.abort();var e,t=l(this.projectiles);try{for(t.s();!(e=t.n()).done;){e.value.hide()}}catch(e){t.e(e)}finally{t.f()}var n,i=l(this.activeTileStatContainers);try{for(i.s();!(n=i.n()).done;){n.value.node.scale=new U(1,1,1)}}catch(e){i.e(e)}finally{i.f()}}},{key:"listenEvents",value:function(){this.node.scene.on(ny.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.on(ny.MISSION_TILE_SET_COLLECT,this.runCollectAnimation,this),this.node.scene.on(ny.MISSION_TILE_SET_UPDATE,this.updateCount,this)}},{key:"unlistenEvents",value:function(){this.node.scene.off(ny.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.off(ny.MISSION_TILE_SET_COLLECT,this.runCollectAnimation,this),this.node.scene.off(ny.MISSION_TILE_SET_UPDATE,this.updateCount,this)}},{key:"updateJourneyData",value:function(e){this.returnAllTileStatContainers();var t,n=e.length>1,i=l(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,r=this.getTileStatContainer(),o=this.getTileItemSprite(a.skinIdx),s=this.getTileBackgroundSprite(a.isEmptyBackground,a.isHidden),u=this.getTileEffectSprite(a.effect);r.updateSprite(s,o,u),r.setJourneyMissionTileSet(a,n),this.totalCount+=a.count}}catch(e){i.e(e)}finally{i.f()}this.layout.updateLayout()}},{key:"getTileStatContainer",value:function(){var e=this.inactiveTileStatContainers.pop();e||(e=$(this.tileStatContainerPrefab).getComponent(DT));return e.node.setParent(this.layout.node),e.node.active=!0,this.activeTileStatContainers.push(e),e}},{key:"returnTileStatContainer",value:function(e){this.activeTileStatContainers.splice(this.activeTileStatContainers.indexOf(e),1),this.inactiveTileStatContainers.push(e),e.node.active=!1,e.node.setParent(null)}},{key:"getTileItemSprite",value:function(e){return e?wt.includes(e)?ht.getCurrentArtifactTileSprite(e.toString()):De.getCurrentItemTileSprite(e.toString()):null}},{key:"getTileBackgroundSprite",value:function(e,t){return e?null:t?De.getCurrentTileHiddenSprite():De.getCurrentTileBackgroundSprite()}},{key:"getTileEffectSprite",value:function(e){return e?De.getEffectSpriteFrame(e):null}},{key:"returnAllTileStatContainers",value:function(){this.inactiveTileStatContainers=this.activeTileStatContainers,this.activeTileStatContainers=[];var e,t=l(this.inactiveTileStatContainers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.node.active=!1,n.node.setParent(null)}}catch(e){t.e(e)}finally{t.f()}}},{key:"getProjectile",value:function(){var e=this.projectiles.pop();e||(e=$(this.headerTileMatchProjectilePrefab).getComponent(ST));return e.node.setParent(this.node),e.reset(),e}},{key:"returnProjectile",value:function(e){this.projectiles.push(e),e.hide(),e.node.setParent(null)}},{key:"playCollectAnimation",value:(p=t(n().mark((function e(t,i,a){var r,o,s,l=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getProjectile(),o=this.signal,r.node.setWorldPosition(a),s=z(t.node).set({scale:new U(1,1,1)}).delay(.6).to(.1,{scale:new U(.8,.8,.8)},{easing:"cubicIn"}).call((function(){t.journeyMissionTileSet.count>i?t.updateCount(t.journeyMissionTileSet.count):t.updateCount(i),r.playExplodeAnimation(o)})).to(.1,{scale:new U(1,1,1)},{easing:"cubicOut"}).delay(.3).call((function(){l.returnProjectile(r)})),Ke.runTweenAsync(s,o),r.playExplodeAnimation(o),e.next=8,r.playCollectAnimation(o,t.node.worldPosition.x,t.node.worldPosition.y,t.node.worldPosition.x+.2*(t.node.worldPosition.x-a.x),0);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"runCollectAnimation",value:(d=t(n().mark((function e(t,i,a){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.activeTileStatContainers.find((function(e){return e.journeyMissionTileSet===t}))){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",this.playCollectAnimation(r,i,a));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"runFinishAnimation",value:(u=t(n().mark((function e(t){var i,a,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.glowNode.active=!0,this.glowNode.setPosition(new U(-437,0,0)),i=z(this.opacity).to(.5,{opacity:0},{easing:"cubicOut"}),e.next=5,Ke.runTweenAsync(i);case 5:return this.node.setWorldPosition(t),this.node.setScale(new U(1.2,1.2,1)),a=z(this.opacity).to(.5,{opacity:255},{easing:"cubicIn"}),e.next=10,Ke.runTweenAsync(a);case 10:return r=z(this.glowNode).to(.75,{position:new U(437,0,0)},{easing:"linear"}),e.next=13,Ke.runTweenAsync(r);case 13:return o=z(this.opacity).to(.15,{opacity:0},{easing:"cubicOut"}),e.next=16,Ke.runTweenAsync(o);case 16:this.glowNode.active=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"runEntranceAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length>0&&void 0!==s[0]?s[0]:.8,this.opacity.opacity=255,z(this.layout.node).delay(t).to(.3,{scale:new U(1.15,1.15,1)},{easing:"cubicOut"}).delay(.2).to(.3,{scale:new U(1,1,1)},{easing:"backOut"}).start(),i=0,a=.05,r=0;r<this.activeTileStatContainers.length;r++)o=this.activeTileStatContainers[r],z(o.parentTile).delay(t+i+r*a).by(.1,{position:new U(0,5,0)},{easing:"sineIn"}).to(.15,{angle:22},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).to(.1,{angle:13},{easing:"sineInOut"}).to(.1,{angle:-13},{easing:"sineOut"}).to(.02,{angle:-17},{easing:"sineIn"}).to(.1,{angle:0},{easing:"sineOut"}).by(.1,{position:new U(0,-5,0)},{easing:"sineOut"}).start();case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"updateCount",value:function(e,t){var n=this.activeTileStatContainers.find((function(t){return t.journeyMissionTileSet===e}));n&&n.updateCount(t)}},{key:"updateTilesTheme",value:function(){var e,t=l(this.activeTileStatContainers);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=this.getTileItemSprite(n.journeyMissionTileSet.skinIdx||null),a=this.getTileBackgroundSprite(n.journeyMissionTileSet.isEmptyBackground,n.journeyMissionTileSet.isHidden),r=this.getTileEffectSprite(n.journeyMissionTileSet.effect);n.updateSprite(a,i,r)}}catch(e){t.e(e)}finally{t.f()}}}]),y}(E)).prototype,"layout",[kT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AT=u(xT.prototype,"tileStatContainerPrefab",[TT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_T=u(xT.prototype,"headerTileMatchProjectilePrefab",[CT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=u(xT.prototype,"glowNode",[ET],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BT=u(xT.prototype,"opacity",[LT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IT=xT))||IT);b._RF.pop(),b._RF.push({},"8f084a/9CtBTqwIW6SZ7HQ4","SingleBlock",void 0);var eC,tC,nC,iC,aC,rC,oC,sC,lC,uC,cC,hC,dC,pC,fC,yC,vC,gC=w.ccclass,mC=w.property,bC="#62cea2",SC="#a0aac0",wC="#e67072",kC="#ddba8d",TC="#c98ddd",CC="#8bcabf",EC=(FT=gC("SingleBlock"),zT=mC(Bd),MT=mC(q),UT=mC(q),GT=mC(q),HT=mC([q]),FT((qT=u((WT=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"levelTitleLabel",qT,h(e)),c(e,"levelText",jT,h(e)),c(e,"matchText",KT,h(e)),c(e,"scoreText",YT,h(e)),c(e,"titleLabels",JT,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"start",value:function(){this.updateColorCode()}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){this.node.scene.on(ny.THEME_BACKGROUND_CHANGE,this.updateColorCode,this)}},{key:"unlistenGameEvents",value:function(){this.node.scene.off(ny.THEME_BACKGROUND_CHANGE,this.updateColorCode,this)}},{key:"updateColorCode",value:function(){var e;switch(codex.player.getPlayerSetting("theme").background){case kt.BG1:e=bC;break;case kt.BG2:e=CC;break;case kt.BG3:e=SC;break;case kt.BG4:e=kC;break;case kt.BG5:e=wC;break;case kt.BG6:e=TC;break;default:e=bC}var t,n=l(this.titleLabels);try{for(n.s();!(t=n.n()).done;){t.value.color=new ee.Color(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setDateStringText",value:function(e){this.levelTitleLabel.key="date";var t=e.day<10?"0".concat(e.day):e.day.toString(),n=e.month<10?"0".concat(e.month):e.month.toString();this.levelText.string="".concat(n,"/").concat(t)}},{key:"setLevelText",value:function(e){this.levelTitleLabel.key="level",this.levelText.string=e.toString()}},{key:"setScoreText",value:function(e){this.scoreText.string=e.toString()}},{key:"setMatchText",value:function(e){this.matchText.string=e.toString()}}]),n}(E)).prototype,"levelTitleLabel",[zT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jT=u(WT.prototype,"levelText",[MT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KT=u(WT.prototype,"matchText",[UT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YT=u(WT.prototype,"scoreText",[GT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JT=u(WT.prototype,"titleLabels",[HT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),VT=WT))||VT);b._RF.pop(),b._RF.push({},"b105d9yGrBKu7+1O0ftW9oA","RearGlow",void 0);var LC,IC,xC,RC,AC,_C=w.ccclass,PC=w.property,BC=(eC=_C("RearGlow"),tC=PC(x),nC=PC(x),iC=PC(U),aC=PC(U),eC((sC=u((oC=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"glowSprite",sC,h(e)),c(e,"highlightSprite",lC,h(e)),c(e,"easeShowType",uC,h(e)),c(e,"easeHideType",cC,h(e)),c(e,"glowShowDuration",hC,h(e)),c(e,"highlightMoveDuration",dC,h(e)),c(e,"glowHideDelay",pC,h(e)),c(e,"glowAlpha",fC,h(e)),c(e,"fromPosition",yC,h(e)),c(e,"toPosition",vC,h(e)),e.glowAlphaTween=null,e.highlightMoveTween=null,e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.node.active=!1}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"runShowAnimation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.glowAlphaTween&&(this.glowAlphaTween.stop(),this.glowAlphaTween=null),this.highlightMoveTween&&(this.highlightMoveTween.stop(),this.highlightMoveTween=null);var n=_.getVisibleSize(),i=this.glowSprite.getComponent(R);i&&i.setContentSize(i.width,n.height),this.node.active=!0,this.highlightSprite.node.active=!0;var a=this.glowSprite.color.clone();a.a=0,this.glowSprite.color=a;var r=this.glowSprite.color.clone();r.a=this.glowAlpha,this.glowAlphaTween=z(this.glowSprite).delay(t).to(this.glowShowDuration,{color:r},{easing:this.easeShowType}).delay(this.glowHideDelay).call((function(){e.runHideAnimation()})).start(),this.highlightSprite.node.setPosition(this.fromPosition),this.highlightMoveTween=z(this.highlightSprite.node).delay(t).to(this.highlightMoveDuration,{position:this.toPosition},{easing:this.easeShowType}).call((function(){e.highlightSprite.node.active=!1})).start()}},{key:"runHideAnimation",value:function(){this.glowAlphaTween&&(this.glowAlphaTween.stop(),this.glowAlphaTween=null);var e=this.glowSprite.color.clone();e.a=0,this.glowAlphaTween=z(this.glowSprite).to(this.glowShowDuration,{color:e},{easing:this.easeHideType}).start()}}]),n}(E)).prototype,"glowSprite",[tC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lC=u(oC.prototype,"highlightSprite",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uC=u(oC.prototype,"easeShowType",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quintOut"}}),cC=u(oC.prototype,"easeHideType",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quintIn"}}),hC=u(oC.prototype,"glowShowDuration",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),dC=u(oC.prototype,"highlightMoveDuration",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),pC=u(oC.prototype,"glowHideDelay",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),fC=u(oC.prototype,"glowAlpha",[PC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),yC=u(oC.prototype,"fromPosition",[iC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0)}}),vC=u(oC.prototype,"toPosition",[aC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0)}}),rC=oC))||rC);b._RF.pop(),b._RF.push({},"9fb43PViUZF9J3qxgiLVgC9","Sidebar",void 0);var NC,OC,DC,FC,zC,MC,UC,GC,HC,VC,WC,qC,jC,KC,YC,JC,ZC,QC,XC,$C,eE,tE,nE,iE,aE,rE,oE,sE,lE,uE,cE,hE,dE,pE,fE,yE=w.ccclass,vE=w.property,gE=(LC=yE("Sidebar"),IC=vE(BC),LC((AC=u((RC=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"rearGlow",AC,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"runShowRearGlowAnimation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.rearGlow.runShowAnimation(e)}},{key:"runHideRearGlowAnimation",value:function(){this.rearGlow.runHideAnimation()}}]),n}(E)).prototype,"rearGlow",[IC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xC=RC))||xC);b._RF.pop(),b._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var mE,bE,SE,wE,kE,TE,CE,EE,LE,IE,xE,RE,AE,_E,PE,BE,NE,OE,DE,FE=w.ccclass,zE=w.property,ME=(NC=FE("DevToolsContainer"),OC=zE(P),DC=zE(P),FC=zE(P),zC=zE(P),MC=zE(P),UC=zE(P),GC=zE(P),HC=zE(P),VC=zE(P),WC=zE(P),qC=zE(P),jC=zE(P),KC=zE(P),YC=zE(P),JC=zE(P),ZC=zE(P),NC(($C=u((XC=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"devToolsButton",$C,h(e)),c(e,"winLevelButton",eE,h(e)),c(e,"loseLevelButton",tE,h(e)),c(e,"buildVersionButton",nE,h(e)),c(e,"prevLevelButton",iE,h(e)),c(e,"nextLevelButton",aE,h(e)),c(e,"selectLevelButton",rE,h(e)),c(e,"hintButton",oE,h(e)),c(e,"undoButton",sE,h(e)),c(e,"shuffleButton",lE,h(e)),c(e,"autoPlayButton",uE,h(e)),c(e,"autoStepButton",cE,h(e)),c(e,"autoFinishButton",hE,h(e)),c(e,"add1ItemButton",dE,h(e)),c(e,"removeAllItemButton",pE,h(e)),c(e,"dashboardButton",fE,h(e)),e.gameplay=null,e.gameObjects=null,e.currentSpawnObjId=-1,e.autoPlay=!1,e.autoPlayInterval=null,e.handleClickDashboardButton=function(){St.switchToDashboardScene()},e.handleClickDevToolsButton=function(){e.toggleAllButtons()},e.handleClickPrevLevelButton=function(){var t=e.getCurrentLevel();t&&e.node.scene.emit(ny.SELECT_LEVEL,{level:t-1})},e.handleClickNextLevelButton=function(){var t=e.getCurrentLevel();t&&e.node.scene.emit(ny.SELECT_LEVEL,{level:t+1})},e.handleClickHintButton=function(){e.node.scene.emit(ny.SHOW_HINT,{noAd:!0})},e.handleClickUndoButton=function(){e.node.scene.emit(ny.START_UNDO)},e.handleClickShuffleButton=function(){e.node.scene.emit(ny.START_SHUFFLE)},e.handleClickAutoPlayButton=function(){e.autoPlay?(clearInterval(e.autoPlayInterval),e.autoPlay=!1):(e.autoPlay=!0,e.autoPlayInterval=setInterval((function(){var t,n;if(null===(t=e.gameplay)||void 0===t||!t.isGamePlaying())return clearInterval(e.autoPlayInterval),void(e.autoPlay=!1);null===(n=e.gameplay)||void 0===n||n.tileManager.handleAutoPlay()}),800))},e.handleClickAutoStepButton=function(){var t,n;null!==(t=e.gameplay)&&void 0!==t&&t.isGamePlaying()&&(null===(n=e.gameplay)||void 0===n||n.tileManager.handleAutoPlay())},e.handleClickAutoFinishButton=function(){var t;null!==(t=e.gameplay)&&void 0!==t&&t.isGamePlaying()&&e.node.scene.emit(ny.AUTO_FINISH_LEVEL)},e.handleClickAdd1ItemButton=function(){Zm.addItem(et[tt.HINT],1),Zm.addItem(et[tt.UNDO],1),Zm.addItem(et[tt.SHUFFLE],1),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.UNDO,Zm.getItemCount(et[tt.UNDO])),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE]))},e.handleClickRemoveAllItemButton=function(){Zm.removeAllItem(),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.UNDO,Zm.getItemCount(et[tt.UNDO])),e.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE]))},e.handleClickBuildVersionButton=function(){var e=codex.getBuildVersion();gt.showNotificationScreen("Build version: ".concat(e))},e.handleClickWinLevelButton=function(){var t;null===(t=e.gameplay)||void 0===t||t.handleGameWin()},e.handleClickLoseLevelButton=function(){var t;null===(t=e.gameplay)||void 0===t||t.handleGameOver()},e}return o(n,[{key:"start",value:function(){this.handleToggleDevToolsButton(),this.handleGameLevelButtons(),this.handleItemButtons(),this.handleEngineButtons(),this.handleSwitchSceneButtons(),this.toggleAllButtons()}},{key:"handleToggleDevToolsButton",value:function(){this.devToolsButton.on(P.EventType.TOUCH_START,this.handleClickDevToolsButton)}},{key:"handleGameLevelButtons",value:function(){this.winLevelButton.on(P.EventType.TOUCH_START,this.handleClickWinLevelButton),this.loseLevelButton.on(P.EventType.TOUCH_START,this.handleClickLoseLevelButton),this.prevLevelButton.on(P.EventType.TOUCH_START,this.handleClickPrevLevelButton),this.nextLevelButton.on(P.EventType.TOUCH_START,this.handleClickNextLevelButton)}},{key:"handleItemButtons",value:function(){this.hintButton.on(P.EventType.TOUCH_START,this.handleClickHintButton),this.undoButton.on(P.EventType.TOUCH_START,this.handleClickUndoButton),this.shuffleButton.on(P.EventType.TOUCH_START,this.handleClickShuffleButton),this.autoPlayButton.on(P.EventType.TOUCH_START,this.handleClickAutoPlayButton),this.autoStepButton.on(P.EventType.TOUCH_START,this.handleClickAutoStepButton),this.autoFinishButton.on(P.EventType.TOUCH_START,this.handleClickAutoFinishButton),this.add1ItemButton.on(P.EventType.TOUCH_START,this.handleClickAdd1ItemButton),this.removeAllItemButton.on(P.EventType.TOUCH_START,this.handleClickRemoveAllItemButton)}},{key:"handleEngineButtons",value:function(){this.buildVersionButton.on(P.EventType.TOUCH_START,this.handleClickBuildVersionButton)}},{key:"handleSwitchSceneButtons",value:function(){this.dashboardButton.on(P.EventType.TOUCH_START,this.handleClickDashboardButton)}},{key:"handleComboAnimation",value:function(e){var t,n=this.node.scene.getPosition(),i=null===(t=oe("Canvas"))||void 0===t?void 0:t.getComponent("GameScene");if(!i)throw new Error("GameScene is not defined");i.gameplay.scoreManager.setCombo(Number(e.string)-1),this.node.scene.emit(ny.TWO_TILES_MATCHED,{centerPosition:n})}},{key:"injectGameplay",value:function(e){this.gameplay=e,this.gameObjects=e.gameObjects}},{key:"toggleAllButtons",value:function(){var e=this;this.getComponentsInChildren(D).forEach((function(t){t.node.name!==e.devToolsButton.name&&(t.node.active=!t.node.active)}))}},{key:"getCurrentLevel",value:function(){return at.getLevel()}},{key:"handleEnterSelectLevel",value:function(e){var t=Number(e.string);this.node.scene.emit(ny.SELECT_LEVEL,{level:t})}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleSwitchBundle",value:function(){A.emit(Oe.REQUEST_UPGRADE_ASSET)}}]),n}(E)).prototype,"devToolsButton",[OC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eE=u(XC.prototype,"winLevelButton",[DC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tE=u(XC.prototype,"loseLevelButton",[FC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nE=u(XC.prototype,"buildVersionButton",[zC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iE=u(XC.prototype,"prevLevelButton",[MC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aE=u(XC.prototype,"nextLevelButton",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rE=u(XC.prototype,"selectLevelButton",[GC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oE=u(XC.prototype,"hintButton",[HC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sE=u(XC.prototype,"undoButton",[VC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lE=u(XC.prototype,"shuffleButton",[WC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uE=u(XC.prototype,"autoPlayButton",[qC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cE=u(XC.prototype,"autoStepButton",[jC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hE=u(XC.prototype,"autoFinishButton",[KC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dE=u(XC.prototype,"add1ItemButton",[YC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pE=u(XC.prototype,"removeAllItemButton",[JC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fE=u(XC.prototype,"dashboardButton",[ZC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QC=XC))||QC);b._RF.pop(),b._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var UE,GE,HE,VE,WE,qE,jE,KE,YE=w.ccclass,JE=w.property,ZE=Ludex.Utils,QE=(mE=YE("UIManager"),bE=JE(nT),SE=JE(ew),wE=JE(gE),kE=JE(gE),TE=JE(EC),CE=JE(Gk),EE=JE(ME),LE=JE(RS),mE((RE=u((xE=function(e){i(p,e);var s,l,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"header",RE,h(e)),c(e,"footer",AE,h(e)),c(e,"sidebarLeft",_E,h(e)),c(e,"sidebarRight",PE,h(e)),c(e,"singleBlock",BE,h(e)),c(e,"comboText",NE,h(e)),c(e,"devTools",OE,h(e)),c(e,"eventUIManager",DE,h(e)),e.devToolsScale=U.ONE,e.journeyBlock=null,e.toggleDevTools=function(){e.devTools&&(e.devTools.node.scale=e.devTools.node.scale.equals(U.ZERO)?e.devToolsScale:U.ZERO)},e}return o(p,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listensDevToolsEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listensDevToolsEvents",value:function(){this.node.scene.on(_f.Events.UNLOCK_DEV_TOOLS,this.toggleDevTools)}},{key:"initDevTools",value:function(e){this.devTools&&(this.devTools.node.active=ZE.Valid.isDebugger(),this.devTools.injectGameplay(e),this.devToolsScale=this.devTools.node.scale.clone())}},{key:"setDateStringText",value:function(e){this.singleBlock.setDateStringText(e)}},{key:"setLevelText",value:function(e){this.singleBlock.setLevelText(e)}},{key:"setScoreText",value:function(e){var t;this.singleBlock.setScoreText(e),null===(t=this.challengeBlock)||void 0===t||t.setPlayerScoreText(e)}},{key:"setMatchText",value:function(e){this.singleBlock.setMatchText(e)}},{key:"getCenterPosition",value:function(){var e=(this.header.node.worldPositionX+this.footer.node.worldPositionX)/2,t=(this.header.node.worldPositionY+this.footer.node.worldPositionY)/2;return new U(e,t,0)}},{key:"runShowComboAnimation",value:function(e){e<3||(console.log("runShowComboAnimation",e),this.comboText.runShowComboTextAnimation(e,0),e>=5&&e%5==0&&(this.sidebarLeft.runShowRearGlowAnimation(0),this.sidebarRight.runShowRearGlowAnimation(0)))}},{key:"runHideAnimation",value:(u=t(n().mark((function e(){var t,i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.5,i=this.header.runHideAnimation(t),a=this.footer.runHideAnimation(t),e.next=5,Promise.all([i,a]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"runShowAnimation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this.header.runShowAnimation(e),this.footer.runShowAnimation(e)}},{key:"disableUI",value:function(){this.header.disableButtons(),this.footer.disableButtons()}},{key:"enableUI",value:function(){this.header.enableButtons(),this.footer.enableButtons()}},{key:"disableRewardAdsUI",value:function(){}},{key:"isChallengeUILoaded",value:function(){return Ne.isPrefabLoaded($e.CHALLENGE_BLOCK_PREFAB)&&Ne.isPrefabLoaded($e.CHALLENGE_PREPARE_PREFAB)}},{key:"isJourneyUILoaded",value:function(){return Ne.isPrefabLoaded($e.JOURNEY_BLOCK_PREFAB)}},{key:"loadChallengeUI",value:(l=t(n().mark((function e(){var t,i,a,r,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Promise.resolve(null),this.challengeBlock||(Ne.isPrefabLoaded($e.CHALLENGE_BLOCK_PREFAB)?(i=Ne.getPrefab($e.CHALLENGE_BLOCK_PREFAB),this.challengeBlock=$(i).getComponent(Pw),this.challengeBlock.node.setParent(this.header.node),this.challengeBlock.node.setPosition(0,-22,0)):(t=Ne.loadPrefabAsync($e.CHALLENGE_BLOCK_PREFAB,!0)).then((function(e){o.challengeBlock=$(e).getComponent(Pw),o.challengeBlock.node.setParent(o.header.node),o.challengeBlock.node.setPosition(0,-22,0)}))),a=Promise.resolve(null),this.challengePrepare||(Ne.isPrefabLoaded($e.CHALLENGE_PREPARE_PREFAB)?(r=Ne.getPrefab($e.CHALLENGE_PREPARE_PREFAB),this.challengePrepare=$(r).getComponent(ck),this.challengePrepare.node.setParent(this.eventUIManager.node)):(a=Ne.loadPrefabAsync($e.CHALLENGE_PREPARE_PREFAB,!0)).then((function(e){o.challengePrepare=$(e).getComponent(ck),o.challengePrepare.node.setParent(o.eventUIManager.node)}))),e.next=6,Promise.all([t,a]);case 6:this.challengeBlock.node.active=!1,this.challengePrepare.node.active=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadJourneyUI",value:(s=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.journeyBlock){e.next=12;break}if(!Ne.isPrefabLoaded($e.JOURNEY_BLOCK_PREFAB)){e.next=7;break}t=Ne.getPrefab($e.JOURNEY_BLOCK_PREFAB),this.journeyBlock=$(t).getComponent($T),this.journeyBlock.node.setParent(this.header.node),e.next=12;break;case 7:return e.next=9,Ne.loadPrefabAsync($e.JOURNEY_BLOCK_PREFAB,!0);case 9:i=e.sent,this.journeyBlock=$(i).getComponent($T),this.journeyBlock.node.setParent(this.header.node);case 12:this.journeyBlock.node.setPosition(0,-22,0),this.journeyBlock.node.setScale(new U(1,1,1)),this.journeyBlock.node.active=!1;case 15:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"enableChallengeUI",value:function(){this.singleBlock.node.active=!1,this.challengeBlock&&(this.challengeBlock.node.active=!0),this.challengePrepare&&(this.challengePrepare.node.active=!0),this.journeyBlock&&(this.journeyBlock.node.active=!1)}},{key:"enableSingleUI",value:function(){this.singleBlock.node.active=!0,this.challengeBlock&&(this.challengeBlock.node.active=!1),this.challengePrepare&&(this.challengePrepare.node.active=!1),this.journeyBlock&&(this.journeyBlock.node.active=!1)}},{key:"enableJourneyUI",value:function(){this.singleBlock.node.active=!1,this.journeyBlock&&(this.journeyBlock.node.active=!0),this.challengeBlock&&(this.challengeBlock.node.active=!1),this.challengePrepare&&(this.challengePrepare.node.active=!1)}},{key:"runEventEntranceAnimation",value:function(){rt.getSpecialMode()===ft.JOURNEY&&this.journeyBlock.runEntranceAnimation()}}]),p}(E)).prototype,"header",[bE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AE=u(xE.prototype,"footer",[SE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_E=u(xE.prototype,"sidebarLeft",[wE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PE=u(xE.prototype,"sidebarRight",[kE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BE=u(xE.prototype,"singleBlock",[TE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NE=u(xE.prototype,"comboText",[CE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OE=u(xE.prototype,"devTools",[EE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),DE=u(xE.prototype,"eventUIManager",[LE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),IE=xE))||IE);b._RF.pop(),b._RF.push({},"da9f779Lq1FZ6d4GYedSdef","TutorialHand",void 0);var XE,$E,eL,tL,nL,iL,aL,rL,oL,sL,lL,uL,cL,hL,dL,pL,fL,yL,vL,gL,mL,bL,SL,wL=w.ccclass,kL=w.property,TL=Ludex.Utils.Signal,CL=(UE=wL("TutorialHand"),GE=kL(N),HE=kL(P),UE((qE=u((WE=function(e){i(m,e);var s,l,u,d,p,f,y,v,g=a(m);function m(){var e;r(this,m);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=g.call.apply(g,[this].concat(n)),c(e,"handOpacity",qE,h(e)),c(e,"hand",jE,h(e)),c(e,"handScaleDefault",KE,h(e)),e.handInitialPosition=new U(0,0,0),e.isShowing=!1,e.signalController=new TL.SignalController,e}return o(m,[{key:"__preload",value:function(){this.handOpacity.opacity=0,this.hand.scale=new U(0,0,1),this.isShowing=!1,this.handInitialPosition=this.hand.position.clone()}},{key:"tap",value:(v=t(n().mark((function e(t,i){var a,r,o,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>2&&void 0!==l[2]?l[2]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return r=this.signalController.renew(),o=z(this.hand).delay(a).to(.15,{scale:new U(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).to(.15,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).call((function(){t&&s.hide(),i&&i()})),e.next=7,Ke.runTweenAsync(o,r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"doubleTap",value:(y=t(n().mark((function e(t,i){var a,r,o,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>2&&void 0!==l[2]?l[2]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return r=this.signalController.renew(),o=z(this.hand).delay(a).to(.1,{scale:new U(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicIn"}).to(.1,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicIn"}).to(.1,{scale:new U(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicIn"}).to(.1,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicIn"}).call((function(){t&&s.hide(),i&&i()})),e.next=7,Ke.runTweenAsync(o,r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"move",value:(f=t(n().mark((function e(t,i,a){var r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>3&&void 0!==l[3]?l[3]:0,o=this.signalController.renew(),s=z(this.node).delay(r).to(i,{position:t},{easing:"sineInOut"}).call((function(){a&&a()})),e.next=5,Ke.runTweenAsync(s,o);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"tapAndHold",value:(p=t(n().mark((function e(t){var i,a,r,o=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.length>1&&void 0!==o[1]?o[1]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return a=this.signalController.renew(),r=z(this.hand).delay(i).to(.2,{scale:new U(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).call((function(){t&&t()})),e.next=7,Ke.runTweenAsync(r,a);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"unHold",value:(d=t(n().mark((function e(t,i,a){var r,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isShowing){e.next=2;break}return e.abrupt("return");case 2:return r=this.signalController.renew(),z(this.hand).delay(t).to(.2,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).call((function(){i&&o.hide(),a&&a()})),e.next=6,Ke.runTweenAsync(z(this.hand),r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"tapLoop",value:(u=t(n().mark((function e(t){var i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:0,this.isShowing){e.next=3;break}return e.abrupt("return");case 3:return a=this.signalController.renew(),r=this.handInitialPosition.clone(),o=z(this.hand).set({position:r,scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0}).delay(i).to(.15,{scale:new U(.8*this.handScaleDefault,.8*this.handScaleDefault,1),angle:-10},{easing:"cubicOut"}).delay(.2).to(.15,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicOut"}).to(.4,{position:new U(r.x+t.x,r.y+t.y,0)},{easing:"sineInOut"}).to(.4,{position:new U(r.x,r.y,0)},{easing:"sineInOut"}),s=z(this.hand).set({position:r,scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0}).delay(i).repeatForever(o),e.next=9,Ke.runTweenAsync(s,a);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"show",value:(l=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:.2,i=this.signalController.renew(),this.isShowing=!0,a=z(this.handOpacity).to(t,{opacity:255},{easing:"cubicInOut"}),r=z(this.hand).to(t,{scale:new U(this.handScaleDefault,this.handScaleDefault,1),angle:0},{easing:"cubicInOut"}),o=Ke.runTweenAsync(a,i),s=Ke.runTweenAsync(r,i),e.next=9,Promise.all([o,s]);case 9:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"hide",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:.2,i=this.signalController.renew(),this.isShowing=!1,a=z(this.handOpacity).to(t,{opacity:0},{easing:"cubicInOut"}),r=z(this.hand).to(t,{scale:new U(0,0,1),angle:-10},{easing:"cubicInOut"}),o=Ke.runTweenAsync(a,i),s=Ke.runTweenAsync(r,i),e.next=9,Promise.all([o,s]);case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),m}(E)).prototype,"handOpacity",[GE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jE=u(WE.prototype,"hand",[HE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KE=u(WE.prototype,"handScaleDefault",[kL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),VE=WE))||VE);b._RF.pop(),b._RF.push({},"85c57+tkHpBaaH2FQcFcbwN","TutorialInstruction",void 0);var EL,LL,IL,xL,RL,AL,_L,PL=w.ccclass,BL=w.property,NL=Ludex.Utils.Signal,OL=(XE=PL("TutorialInstruction"),$E=BL(P),eL=BL(q),tL=BL(Bd),nL=BL(R),iL=BL(R),aL=BL(Q),rL=BL(Q),XE((lL=u((sL=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"parentContainer",lL,h(e)),c(e,"instructionLabel",uL,h(e)),c(e,"instructionLocalize",cL,h(e)),c(e,"instructionUiTransform",hL,h(e)),c(e,"popupUiTransform",dL,h(e)),c(e,"originalMessageSize",pL,h(e)),c(e,"maxMessageWidth",fL,h(e)),c(e,"minStretchCheckMessageHeight",yL,h(e)),c(e,"minPopupWidth",vL,h(e)),c(e,"minPopupHeight",gL,h(e)),c(e,"maxPopupWidth",mL,h(e)),c(e,"stretchWidthIterations",bL,h(e)),c(e,"messagePopupPadding",SL,h(e)),e.signalController=new NL.SignalController,e}return o(d,[{key:"__preload",value:function(){this.node.active=!1,this.parentContainer.scale=new U(0,0,1)}},{key:"showInstruction",value:(l=t(n().mark((function e(t){var i,a,r,o,s,l,u,c,h=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=h.length>1&&void 0!==h[1]?h[1]:.2,a=h.length>2&&void 0!==h[2]?h[2]:0,r=h.length>3&&void 0!==h[3]?h[3]:0,o=this.signalController.renew(),this.node.active=!0,this.instructionLocalize.key=t,this.updateBackgroundSize(),this.parentContainer.setPosition(new U(0,a,0)),s=z(this.parentContainer).to(i,{scale:new U(1,1,1)},{easing:"backOut"}),l=z(this.parentContainer).to(i,{position:new U(0,a+r,0)},{easing:"cubicOut"}),u=Ke.runTweenAsync(s,o),c=Ke.runTweenAsync(l,o),e.next=14,Promise.all([u,c]);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"updateBackgroundSize",value:function(){for(this.instructionLabel.overflow=q.Overflow.RESIZE_HEIGHT,this.instructionUiTransform.setContentSize(this.originalMessageSize.x,this.originalMessageSize.y),this.instructionLabel.updateRenderData(!0);this.instructionUiTransform.contentSize.y>=this.minStretchCheckMessageHeight&&this.instructionUiTransform.contentSize.x<this.maxMessageWidth;)this.instructionUiTransform.setContentSize(this.instructionUiTransform.contentSize.x+this.stretchWidthIterations,this.instructionUiTransform.contentSize.y),this.instructionLabel.updateRenderData(!0);var e=ee.clamp(this.instructionUiTransform.contentSize.x+this.messagePopupPadding.x,this.minPopupWidth,this.maxPopupWidth),t=Math.max(this.minPopupHeight,this.instructionUiTransform.contentSize.y+this.messagePopupPadding.y);this.popupUiTransform.setContentSize(e,t)}},{key:"hideInstruction",value:(s=t(n().mark((function e(){var t,i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.2,i=this.signalController.renew(),a=z(this.parentContainer).to(t,{scale:new U(0,0,1)},{easing:"backIn"}),e.next=5,Ke.runTweenAsync(a,i);case 5:this.node.active=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"parentContainer",[$E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uL=u(sL.prototype,"instructionLabel",[eL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cL=u(sL.prototype,"instructionLocalize",[tL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hL=u(sL.prototype,"instructionUiTransform",[nL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dL=u(sL.prototype,"popupUiTransform",[iL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pL=u(sL.prototype,"originalMessageSize",[aL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(500,70)}}),fL=u(sL.prototype,"maxMessageWidth",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),yL=u(sL.prototype,"minStretchCheckMessageHeight",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),vL=u(sL.prototype,"minPopupWidth",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 700}}),gL=u(sL.prototype,"minPopupHeight",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),mL=u(sL.prototype,"maxPopupWidth",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),bL=u(sL.prototype,"stretchWidthIterations",[BL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),SL=u(sL.prototype,"messagePopupPadding",[rL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(200,200)}}),oL=sL))||oL);b._RF.pop(),b._RF.push({},"b65f9FC6j5OO6hOcjXL2Dh9","TutorialMask",void 0);var DL=w.ccclass,FL=w.property,zL=Ludex.Utils.Signal,ML=(EL=DL("TutorialMask"),LL=FL(P),IL=FL(N),EL((AL=u((RL=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"parentNode",AL,h(e)),c(e,"maskOpacity",_L,h(e)),e.maskedMap=new Map,e.placeholderPools=[],e.signalController=new zL.SignalController,e}return o(n,[{key:"__preload",value:function(){this.node.active=!1,this.listenToEvents()}},{key:"onDestroy",value:function(){this.node.scene.off(ny.GAMEOBJECT_WIDGET_UPDATE,this.updateParentNode,this)}},{key:"listenToEvents",value:function(){this.node.scene.on(ny.GAMEOBJECT_WIDGET_UPDATE,this.updateParentNode,this)}},{key:"maskGameObjects",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=l(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,r=this.getPlaceholderNode();this.replaceWithPlaceHolder(r,a)}}catch(e){i.e(e)}finally{i.f()}this.sortSiblingIndexBaseOnPlaceholderSiblingIndex(),this.node.active=!0,this.maskOpacity.node.active=!0;var o=this.signalController.renew(),s=z(this.maskOpacity).to(n,{opacity:255});Ke.runTweenAsync(s,o)}},{key:"unmaskGameObjects",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2,i=l(this.maskedMap.entries());try{for(i.s();!(e=i.n()).done;){var a=g(e.value,2),r=a[0],o=a[1];this.restoreOriginalGameobject(r,o)}}catch(e){i.e(e)}finally{i.f()}this.maskedMap.clear();var s=this.signalController.renew(),u=z(this.maskOpacity).to(n,{opacity:0}).call((function(){t.node.active=!1,t.maskOpacity.node.active=!1}));Ke.runTweenAsync(u,s)}},{key:"replaceWithPlaceHolder",value:function(e,t){var n=t.getSiblingIndex(),i=t.position;e.setParent(t.parent),e.setPosition(i),t.setParent(this.parentNode,!0),e.setSiblingIndex(n),this.maskedMap.set(t,e)}},{key:"restoreOriginalGameobject",value:function(e,t){var n=t.getSiblingIndex();e.parent===this.parentNode?(e.setParent(t.parent,!0),this.returnPlaceholderNode(t),e.setSiblingIndex(n)):this.returnPlaceholderNode(t),this.maskedMap.delete(e)}},{key:"getAllGameObjects",value:function(){var e,t=[],n=l(this.maskedMap.entries());try{for(n.s();!(e=n.n()).done;){var i=g(e.value,1)[0];t.push(i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"sortSiblingIndexBaseOnPlaceholderSiblingIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],i=l(this.maskedMap.entries());try{for(i.s();!(e=i.n()).done;){var a=g(e.value,2),r=a[0],o=a[1];t.includes(r)||n.push([r,o.getSiblingIndex()])}}catch(e){i.e(e)}finally{i.f()}n.sort((function(e,t){return e[1]-t[1]}));for(var s=0;s<n.length;s++){var u=g(n[s],1),c=u[0];c.setSiblingIndex(s)}for(var h=0;h<t.length;h++){var d=t[h];d.setSiblingIndex(n.length+h)}}},{key:"getPlaceholderNode",value:function(){if(this.placeholderPools.length>0){var e=this.placeholderPools.pop();return e.active=!0,e}var t=new P("MaskPlaceholder");return t.active=!0,t}},{key:"returnPlaceholderNode",value:function(e){e.setParent(this.parentNode),e.active=!1,this.placeholderPools.push(e)}},{key:"updateParentNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.parentNode.getComponent(H);n&&(n.top=e,n.bottom=t,n.updateAlignment())}}]),n}(E)).prototype,"parentNode",[LL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_L=u(RL.prototype,"maskOpacity",[IL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xL=RL))||xL);b._RF.pop(),b._RF.push({},"f8981zheJdE4oVhPzgodH0U","FirstGameTutorial",void 0);var UL=function(){function e(t){r(this,e),this.guideSteps=[],this.hideUI=!0,this.maskUI=!0,this.untrackCombo=!0,this.untrackScore=!0,this.useJsonLevel=!0,this.isComplete=!1,this.currentStep=0,this.level1={layers:[{index:0,tiles:[{x:.5,y:0,skinIdx:0},{x:-.5,y:0,skinIdx:0}]}]},this.level2={layers:[{index:0,tiles:[{x:1,y:0,skinIdx:2},{x:0,y:0,skinIdx:3},{x:-1,y:0,skinIdx:3}]},{index:1,tiles:[{x:-.5,y:0,skinIdx:2}]}]},this.level3={layers:[{index:0,tiles:[{x:1.5,y:0,skinIdx:4},{x:-1.5,y:0,skinIdx:4},{x:.5,y:0,skinIdx:1},{x:-.5,y:0,skinIdx:1}]}]},this.guideManager=t,this.createGuide()}var i,a,s,l,u;return o(e,[{key:"createGuide",value:function(){var e=this,t=["20","10","28","11","32","2","1","19","29","33"];[{level:this.level1,layers:[[0,0],[0,1]]},{level:this.level2,layers:[[0,0],[0,1],[0,2],[1,0]]},{level:this.level3,layers:[[0,0],[0,1],[0,2],[0,3]]}].forEach((function(n){var i=n.level;n.layers.forEach((function(n){var a=g(n,2),r=a[0],o=a[1];e.setNewSkinIndex(i,r,o,t)}))})),this.guideSteps=[{execute:function(){return e.executeStep1()}},{execute:function(){return e.executeStep2()}},{execute:function(){return e.executeStep3()}}]}},{key:"setNewSkinIndex",value:function(e,t,n,i){e.layers[t].tiles[n].skinIdx=Number(i[e.layers[t].tiles[n].skinIdx%i.length])}},{key:"executeStep1",value:(u=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level1);case 2:return t=this.guideManager.getTileById(["0-0.5-0","0--0.5-0"]),this.guideManager.showTutorialInstruction("firstTutor1",.5,t[0].worldPos.y+500,50),(i=[]).push(this.handMovement(t)),i.push(this.guideManager.onceAllTileDestroy()),e.next=9,Promise.all(i);case 9:return this.guideManager.hideTutorialHand(.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handMovement",value:(l=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t[0],this.guideManager.showTutorHandToTile(i,0),e.next=4,this.guideManager.onceSelectedTile(i);case 4:a=t[1],0!==this.currentStep||i.state!==lt.ALREADY&&i.state!==lt.CHOOSING?this.guideManager.hideTutorialHand(.2):this.guideManager.showTutorHandToTile(a,.2);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"executeStep2",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level2);case 2:return t=this.guideManager.getTileById(["0-0-0"]),this.guideManager.showTutorialInstruction("firstTutor2",.5,t[0].worldPos.y+500,50),e.next=6,this.guideManager.onceAllTileDestroy();case 6:return this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"executeStep3",value:(a=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.loadGuideLevel(this.level3);case 2:return t=this.guideManager.getTileById(["0-0.5-0"]),this.guideManager.showTutorialInstruction("firstTutor3",.5,t[0].worldPos.y+500,50),e.next=6,this.guideManager.onceAllTileDestroy();case 6:return this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"init",value:function(){this.guideManager.setCanWinGame(!1)}},{key:"run",value:(i=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("asasasas tutorial run",it.TUTORIAL_START,at.getLevel()),codex.analytics.event(it.TUTORIAL_START,{level:at.getLevel()});case 2:if(!(this.currentStep<this.guideSteps.length)){e.next=11;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(it.TUTORIAL_STEP,{level:at.getLevel(),step:this.currentStep+1}),!t.execute){e.next=8;break}return e.next=8,t.execute();case 8:this.currentStep++,e.next=2;break;case 11:codex.analytics.event(it.TUTORIAL_COMPLETE,{level:at.getLevel()}),this.complete();case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0,this.guideManager.setCanWinGame(!0),this.guideManager.loadCurrentLevel()}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.setCanWinGame(!0),this.guideManager.hideTutorialHand(0),this.guideManager.hideTutorialInstruction(0)}}]),e}();b._RF.pop(),b._RF.push({},"a4a64FskCROb7d7fGAGo7t6","FlowerTileTutorial",void 0);var GL=function(){function e(t){r(this,e),this.guideSteps=[],this.hideUI=!0,this.untrackCombo=!1,this.untrackScore=!1,this.isComplete=!1,this.currentStep=0,this.tiles=[],this.guideManager=t,this.createGuide()}var i,a;return o(e,[{key:"createGuide",value:function(){var e=this;this.guideSteps=[{execute:function(){return e.executeStep1()}}]}},{key:"executeStep1",value:(a=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.onceAllTileReady();case 2:return this.tiles=this.guideManager.getTileBySkinIdx(dt.flowers),this.guideManager.hintNudgeTiles(this.tiles,.2),this.guideManager.showTutorialInstruction("flowerTutor",.5,this.tiles[0].worldPos.y-320,50),e.next=7,this.guideManager.onceAnyTileMatched();case 7:return this.guideManager.unhintNudgeTiles(this.tiles,.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"init",value:function(){}},{key:"run",value:(i=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:codex.analytics.event(it.TUTORIAL_START,{level:at.getLevel()});case 1:if(!(this.currentStep<this.guideSteps.length)){e.next=10;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(it.TUTORIAL_STEP,{level:at.getLevel(),step:this.currentStep+1}),!t.execute){e.next=7;break}return e.next=7,t.execute();case 7:this.currentStep++,e.next=1;break;case 10:codex.analytics.event(it.TUTORIAL_COMPLETE,{level:at.getLevel()}),this.complete();case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.hideTutorialInstruction(0),this.guideManager.unhintNudgeTiles(this.tiles,0)}}]),e}();b._RF.pop(),b._RF.push({},"25f8fbE66pAgIExKMYQye+3","SeasonTileTutorial",void 0);var HL,VL,WL,qL,jL,KL,YL,JL,ZL,QL=function(){function e(t){r(this,e),this.guideSteps=[],this.hideUI=!0,this.untrackCombo=!1,this.untrackScore=!1,this.isComplete=!1,this.currentStep=0,this.tiles=[],this.guideManager=t,this.createGuide()}var i,a;return o(e,[{key:"createGuide",value:function(){var e=this;this.guideSteps=[{execute:function(){return e.executeStep1()}}]}},{key:"executeStep1",value:(a=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.guideManager.onceAllTileReady();case 2:return this.tiles=this.guideManager.getTileBySkinIdx(dt.seasons),this.guideManager.hintNudgeTiles(this.tiles,.2),this.guideManager.showTutorialInstruction("seasonTutor",.5,this.tiles[0].worldPos.y-320,50),e.next=7,this.guideManager.onceAnyTileMatched();case 7:return this.guideManager.unhintNudgeTiles(this.tiles,.2),this.guideManager.hideTutorialInstruction(.2),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"init",value:function(){}},{key:"run",value:(i=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:codex.analytics.event(it.TUTORIAL_START,{level:at.getLevel()});case 1:if(!(this.currentStep<this.guideSteps.length)){e.next=10;break}if(t=this.guideSteps[this.currentStep],codex.analytics.event(it.TUTORIAL_STEP,{level:at.getLevel(),step:this.currentStep+1}),!t.execute){e.next=7;break}return e.next=7,t.execute();case 7:this.currentStep++,e.next=1;break;case 10:codex.analytics.event(it.TUTORIAL_COMPLETE,{level:at.getLevel()}),this.complete();case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"complete",value:function(){this.isComplete=!0}},{key:"terminate",value:function(){this.guideSteps=[],this.isComplete=!0,this.currentStep=0,this.guideManager.hideTutorialInstruction(0),this.guideManager.unhintNudgeTiles(this.tiles,0)}}]),e}();b._RF.pop(),b._RF.push({},"1bff5uv5b5IiIy6Q8Gp+9C8","GuideManager",void 0);var XL=w.ccclass,$L=w.property,eI=codex,tI=eI.language,nI=(eI.match,Ludex.Utils.Signal),iI=(HL=XL("GuideManager"),VL=$L(ML),WL=$L(CL),qL=$L(OL),HL((YL=u((KL=function(e){i(T,e);var s,u,d,p,f,y,g,m,b,S,w,k=a(T);function T(){var e;r(this,T);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=k.call.apply(k,[this].concat(n)),c(e,"tutorialMask",YL,h(e)),c(e,"tutorialHand",JL,h(e)),c(e,"tutorialInstruction",ZL,h(e)),e.tutorial=null,e.signalController=new nI.SignalController,e.isTutorialRunning=!1,e}return o(T,[{key:"init",value:function(e){this.gameplay=e}},{key:"loadTutorial",value:function(e){this.tutorial=this.getTutorial(e),this.tutorial&&this.tutorial.init()}},{key:"startTutorial",value:(w=t(n().mark((function e(){var t,i,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tutorial){e.next=3;break}return this.isTutorialRunning=!1,e.abrupt("return");case 3:return this.signal=this.signalController.renew(),this.startTutorialConfig(),t=!1,i=new Promise((function(e,n){a.signal.once((function(){t=!0,a.isTutorialRunning=!1,n(new Error("Tutorial was terminated before running"))}))})),e.prev=7,e.next=10,Promise.race([this.tutorial.run(),i]);case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(7),t?console.warn("Tutorial was terminated by signal:",e.t0):console.error("Tutorial run failed:",e.t0),this.isTutorialRunning=!1,e.abrupt("return");case 17:this.endTutorialConfig(),this.tutorial=null;case 19:case"end":return e.stop()}}),e,this,[[7,12]])}))),function(){return w.apply(this,arguments)})},{key:"terminateTutorial",value:function(){this.tutorial&&(this.signalController.abort(),this.tutorial.terminate(),this.tutorial=null)}},{key:"getIsTutorialRunning",value:function(){return this.isTutorialRunning}},{key:"startTutorialConfig",value:function(){this.isTutorialRunning=!0,this.tutorial.hideUI&&this.gameplay.uiManager.runHideAnimation(0),this.tutorial.untrackCombo&&this.gameplay.scoreManager.setTrackCombo(!1),this.tutorial.untrackScore&&this.gameplay.scoreManager.setTrackScore(!1)}},{key:"endTutorialConfig",value:function(){this.isTutorialRunning=!1,this.tutorial.hideUI&&this.gameplay.uiManager.runShowAnimation(),this.tutorial.untrackCombo&&this.gameplay.scoreManager.setTrackCombo(!0),this.tutorial.untrackScore&&this.gameplay.scoreManager.setTrackScore(!0)}},{key:"loadGuideLevel",value:(S=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameplay.tileManager.clearTiles(),this.gameplay.gameObjects.spawnGuideObjects(t),e.next=4,this.gameplay.tileManager.handleTilesCreated();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"loadCurrentLevel",value:(b=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=at.getLevelData()){e.next=3;break}return e.abrupt("return");case 3:return this.gameplay.tileManager.clearTiles(),this.gameplay.gameObjects.spawnObjects(t),e.next=7,this.gameplay.tileManager.handleTilesCreated();case 7:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"canEndGame",value:function(){return this.tutorial.isComplete}},{key:"getTileById",value:function(e){return this.gameplay.tileManager.getAllTiles().filter((function(t){return e.includes(t.id)}))}},{key:"getTileBySkinIdx",value:function(e){return this.gameplay.tileManager.getAllTiles().filter((function(t){return e.includes(t.skinIdx)}))}},{key:"showTutorHandToTile",value:(m=t(n().mark((function e(t){var i,a,r=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.length>1&&void 0!==r[1]?r[1]:0,a=new U(t.worldPos.x,t.worldPos.y-100,0),i<=0&&(this.tutorialHand.node.position=a),e.next=5,this.tutorialHand.show();case 5:if(!(i>0)){e.next=8;break}return e.next=8,this.tutorialHand.move(a,i);case 8:return e.next=10,this.tutorialHand.tapLoop(new U(30,-30,0));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"hideTutorialHand",value:(g=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tutorialHand.hide(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"showTutorialInstruction",value:(y=t(n().mark((function e(t,i,a,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tI.hasTextKey(t)){e.next=3;break}return console.error('Text key "'.concat(t,'" not found in language data.')),e.abrupt("return");case 3:return e.next=5,this.tutorialInstruction.showInstruction(t,i,a,r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return y.apply(this,arguments)})},{key:"hideTutorialInstruction",value:(f=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tutorialInstruction.hideInstruction(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"onceSelectedTile",value:(p=t(n().mark((function e(t){var i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){i.signal.once(n);var a=function t(){i.node.scene.off(ny.TILE_CLICKED,r),i.node.scene.off(ny.TILE_MOVING,r),i.node.scene.off(ny.ALL_TILE_DESTROYED,t),e()},r=function n(r){t===r&&(i.node.scene.off(ny.TILE_CLICKED,n),i.node.scene.off(ny.TILE_MOVING,n),i.node.scene.off(ny.ALL_TILE_DESTROYED,a),e())};i.node.scene.on(ny.TILE_CLICKED,r),i.node.scene.on(ny.TILE_MOVING,r),i.node.scene.once(ny.ALL_TILE_DESTROYED,a)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"onceAnyTileMatched",value:(d=t(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.on(ny.TWO_TILES_MATCHED,(function n(){t.node.scene.off(ny.TWO_TILES_MATCHED,n),e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"onceAllTileReady",value:(u=t(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.on(ny.ALL_TILE_READY,(function n(){t.node.scene.off(ny.ALL_TILE_READY,n),e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"onceAllTileDestroy",value:(s=t(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.signal.once(n),t.node.scene.once(ny.ALL_TILE_DESTROYED,e)})));case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"setCanWinGame",value:function(e){this.gameplay.setCanWinOrEndGame(e)}},{key:"sortTileOnMask",value:function(){var e=this.tutorialMask.getAllGameObjects().filter((function(e){var t=e.getComponent(Pv);return!!t&&(t.state===lt.PRELOADING||t.state===lt.MOVING_TO_MATCH)}));this.tutorialMask.sortSiblingIndexBaseOnPlaceholderSiblingIndex(e)}},{key:"hintNudgeTiles",value:function(e,t){var n=this;return new Promise((function(i,a){if(0!==e.length){n.signal.once(a);var r,o=e.map((function(e){return e.animationHandler})),s=[].concat(v(e.map((function(e){return e.node}))),v(o.map((function(e){return e.getShadow().node})))),u=l(o);try{for(u.s();!(r=u.n()).done;){var c=r.value;c.playTileShowHintAnim(),c.playTileNudgeAnim()}}catch(e){u.e(e)}finally{u.f()}n.tutorialMask.maskGameObjects(s,t),n.node.scene.on(ny.TILE_START_SORT,n.sortTileOnMask,n),i()}else i()}))}},{key:"unhintNudgeTiles",value:function(e,t){var n=this;return new Promise((function(i,a){n.signal.once(a),n.tutorialMask.unmaskGameObjects(t);var r,o=e.map((function(e){return e.animationHandler})),s=l(o);try{for(s.s();!(r=s.n()).done;){var u=r.value;u.playTileStopHintAnim(),u.abortTileNudgeAnim()}}catch(e){s.e(e)}finally{s.f()}n.node.scene.off(ny.TILE_START_SORT,n.sortTileOnMask,n),i()}))}},{key:"getTutorial",value:function(e){switch(e){case"FirstGameTutorial":return new UL(this);case"FlowerTileTutorial":return new GL(this);case"SeasonTileTutorial":return new QL(this);default:return console.warn("Tutorial ".concat(e," not found")),null}}}]),T}(E)).prototype,"tutorialMask",[VL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JL=u(KL.prototype,"tutorialHand",[WL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZL=u(KL.prototype,"tutorialInstruction",[qL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jL=KL))||jL);b._RF.pop(),b._RF.push({},"06155+d06BEMr6ULnqfwSmL","FindArtifactMissionStrategy",void 0);var aI=2,rI=3,oI=function(){function e(){r(this,e),this.journeyMission=null,this.gameplay=null,this.totalCount=0,this.isFinishedLoading=!1,this.claimTiles=[]}var i,a;return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSet=null}},{key:"setupTiles",value:function(){this.isFinishedLoading=!1;var e=this.journeyMission.seed,t=ht.separateSeedsToParts(e,3),n=(t[0],t[1]),i=t[2];this.gameplay.tileManager.updateTilesState();this.gameplay.tileManager.getCoveredTiles();var a,r=2*(aI+i%(rI-aI+1)),o=ht.getJourneyTileSkinIdx(this.journeyMission),s=this.gameplay.tileManager.getReplaceableTilesCombinations((function(e){return!e.isUncovered})),u=ht.seededShuffle(s,n),c=[],h=new Set,d=0,p=l(u);try{for(p.s();!(a=p.n()).done;){var f=a.value;if(!(f.length+d>r)){var y,v=!1,g=l(f);try{for(g.s();!(y=g.n()).done;){var m=y.value;if(h.has(m.id)){v=!0;break}}}catch(e){g.e(e)}finally{g.f()}if(!v){var b,S=l(f);try{for(S.s();!(b=S.n()).done;){var w=b.value;w.setArtifactTile(o),h.add(w.id)}}catch(e){S.e(e)}finally{S.f()}if((d+=f.length)>=r)break}}}}catch(e){p.e(e)}finally{p.f()}return console.log("FindArtifactMissionStrategy: selectedTileCount",d,u),this.missionTileSet={isEmptyBackground:!0,skinIdx:o,count:d},this.totalCount=d,this.isFinishedLoading=!0,c.push(this.missionTileSet),c}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on(ny.TILES_STATE_UPDATED,this.handleTileStateUpdated,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off(ny.TILES_STATE_UPDATED,this.handleTileStateUpdated,this)}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount&&this.isFinishedLoading}},{key:"handleTileStateUpdated",value:function(){if(this.isFinishedLoading){var e,t,n=this.gameplay.tileManager.getUncoveredTiles(),i=[],a=l(n);try{for(a.s();!(e=a.n()).done;){var r=e.value;r.isArtifact&&(this.handleUncoveredTile(r),i.push(r),this.totalCount-=1,this.missionTileSet.count-=1)}}catch(e){a.e(e)}finally{a.f()}if(i.length>0)(t=this.claimTiles).push.apply(t,i),this.gameplay.tileManager.updateTilesState();this.gameplay.node.scene.emit(ny.JOURNEY_MISSION_COMPLETE_CHECK);for(var o=0;o<this.claimTiles.length;o++){var s=this.claimTiles[o],u=this.missionTileSet.count+this.claimTiles.length-o-1;this.runAnimationCollect(s,u)}this.claimTiles=[]}}},{key:"handleUncoveredTile",value:(a=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.gameplay.tileManager.handleTileCollect(t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"runAnimationCollect",value:(i=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.node.worldPosition,t.handlePreloadTile(),e.next=4,t.animationHandler.playTileCollectAnim();case 4:this.gameplay.tileManager.destroyMatchedTiles(t),this.gameplay.node.scene.emit(ny.MISSION_TILE_SET_COLLECT,this.missionTileSet,i,a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})}]),e}();b._RF.pop(),b._RF.push({},"695c5Fb29xKw4pniq1i1HzX","HiddenTileMissionStrategy",void 0);var sI=3,lI=4,uI=3,cI=7,hI=3,dI=10,pI=function(){function e(){r(this,e),this.journeyMission=null,this.gameplay=null,this.totalCount=0}return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSet=null}},{key:"setupTiles",value:function(){var e,t=this.journeyMission.seed,n=ht.separateSeedsToParts(t,2),i=n[0],a=n[1],r=this.gameplay.tileManager.getAllTiles(),o=0,s=0;this.journeyMission.journeyLevel<=Tt.REWARD_1_LEVEL?(o=2*(sI+a%(lI-sI+1)),s=Math.ceil(.5*o)):this.journeyMission.journeyLevel<=Tt.REWARD_2_LEVEL?(o=2*(uI+a%(cI-uI+1)),s=Math.ceil(.5*o)):(o=2*(hI+a%(dI-hI+1)),s=Math.ceil(.5*o));var u,c=[],h=r.reverse(),d=(null===(e=h[0])||void 0===e?void 0:e.getLayer())||0,p=l(h);try{for(p.s();!(u=p.n()).done;){var f=u.value;if(f.getLayer()!==d){if(s<=c.length)break;d=f.getLayer()}c.push(f)}}catch(e){p.e(e)}finally{p.f()}var y,v=new Set,g=[],m=0,b=ht.seededShuffle(c,i),S=l(b);try{for(S.s();!(y=S.n()).done;){var w=y.value;if(m>=s)break;if(!v.has(w.id)){var k=this.gameplay.tileManager.getSymmetricTile(w);k&&!v.has(k.id)&&w!==k&&(w.setHiddenTile(),k.setHiddenTile(),v.add(w.id),v.add(k.id),m+=2)}}}catch(e){S.e(e)}finally{S.f()}var T,C=ht.seededShuffle(h,i),E=l(C);try{for(E.s();!(T=E.n()).done;){var L=T.value;if(m>=o)break;if(!v.has(L.id)){var I=this.gameplay.tileManager.getSymmetricTile(L);I&&!v.has(I.id)&&L!==I?(L.setHiddenTile(),I.setHiddenTile(),v.add(L.id),v.add(I.id),m+=2):(L.setHiddenTile(),v.add(L.id),m+=1)}}}catch(e){E.e(e)}finally{E.f()}return this.missionTileSet={isHidden:!0,count:m},this.totalCount=m,g.push(this.missionTileSet),g}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on(ny.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.on(ny.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off(ny.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.off(ny.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"handleMatchedTiles",value:function(e){var t=e.tile1,n=e.tile2,i=e.worldCenterPosition,a=0;t.isHidden&&a++,n.isHidden&&a++,0!==a&&(this.totalCount-=a,this.missionTileSet.count-=a,this.gameplay.node.scene.emit(ny.MISSION_TILE_SET_COLLECT,this.missionTileSet,this.missionTileSet.count,i),this.gameplay.node.scene.emit(ny.JOURNEY_MISSION_COMPLETE_CHECK))}},{key:"handleUndoneTiles",value:function(e){var t=e.tile1,n=e.tile2,i=0;t.isHidden&&i++,n.isHidden&&i++,0!==i&&(this.totalCount+=i,this.missionTileSet.count+=i,this.gameplay.node.scene.emit(ny.MISSION_TILE_SET_UPDATE,this.missionTileSet,this.missionTileSet.count))}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount}}]),e}();b._RF.pop(),b._RF.push({},"0ef18JANHdNqJlTgd0euXWt","TargetTileMissionStrategy",void 0);var fI=function(){function e(){r(this,e),this.journeyMission=null,this.gameplay=null,this.missionTileSets=[],this.totalCount=0}return o(e,[{key:"init",value:function(e){this.gameplay=e}},{key:"setupMission",value:function(e){this.journeyMission=e,this.missionTileSets=[]}},{key:"setupTiles",value:function(){var e=this.journeyMission.seed,t=ht.separateSeedsToParts(e,3),n=t[0],i=t[1],a=t[2],r=this.gameplay.tileManager.getAllTiles(),o=[dt.bamboo,dt.characters,dt.dots].filter((function(e){var t,n=l(r);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(e.includes(i.skinIdx))return!0}}catch(e){n.e(e)}finally{n.f()}return!1})),s=o[i%o.length],u=v(s).filter((function(e){return r.some((function(t){return t.skinIdx===e}))})),c=Math.min(4,u.length),h=c+n%(Math.min(6,u.length)-c+1),d=ht.seededShuffle(u,n).slice(0,h),p=6+2*Math.floor(r.length/20),f=p+a%(14+2*Math.floor(r.length/20)-p+1);f%2!=0&&(f+=1);for(var y=2*Math.floor(f/h/2),g=f-y*h,m=[],b=[],S=function(e){var t=y,n=r.filter((function(t){return t.skinIdx===d[e]})).length;t=Math.min(t,n),g>=2&&t<=n-2&&(t+=2,g-=2),m.push({skinIdx:d[e],count:t,effect:"pink"}),b.push(t)},w=0;w<h;w++)S(w);var k,T=l(r);try{for(T.s();!(k=T.n()).done;){var C=k.value,E=d.indexOf(C.skinIdx);-1!==E&&b[E]>0&&(C.setTargetTile(),b[E]-=1)}}catch(e){T.e(e)}finally{T.f()}return m.sort((function(e,t){return e.skinIdx-t.skinIdx})),this.missionTileSets=m,this.totalCount=m.reduce((function(e,t){return e+t.count}),0),this.missionTileSets}},{key:"isDescriptionCompleted",value:function(){return 0===this.totalCount}},{key:"setupListeners",value:function(){this.gameplay.node.scene.on(ny.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.on(ny.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"terminateListeners",value:function(){this.gameplay.node.scene.off(ny.TWO_TILES_MATCHED,this.handleMatchedTiles,this),this.gameplay.node.scene.off(ny.TWO_TILES_UNDONE,this.handleUndoneTiles,this)}},{key:"handleMatchedTiles",value:function(e){var t=e.tile1,n=e.tile2,i=e.worldCenterPosition,a=this.missionTileSets.find((function(e){return e.skinIdx===t.skinIdx||e.skinIdx===n.skinIdx})),r=0;a&&(t.isTarget&&(r+=1),n.isTarget&&(r+=1),this.totalCount-=r,a.count-=r,this.gameplay.node.scene.emit(ny.MISSION_TILE_SET_COLLECT,a,a.count,i),this.gameplay.node.scene.emit(ny.JOURNEY_MISSION_COMPLETE_CHECK))}},{key:"handleUndoneTiles",value:function(e){var t=e.tile1,n=e.tile2,i=this.missionTileSets.find((function(e){return e.skinIdx===t.skinIdx||e.skinIdx===n.skinIdx}));i&&(i.count+=2,this.totalCount+=2,this.gameplay.node.scene.emit(ny.MISSION_TILE_SET_UPDATE,i,i.count))}}]),e}();b._RF.pop(),b._RF.push({},"95a90qUfUBGv7qaenHMdap2","JourneyLevelMechanicsManager",void 0);var yI,vI,gI,mI,bI,SI,wI,kI,TI,CI,EI,LI,II=function(){function e(){r(this,e),this.strategies=[],this.gameplay=null,this.journeyBlock=null,this.isMissionCompleted=!1,this.hasMissionStarted=!1,this.createStrategies()}return o(e,[{key:"createStrategies",value:function(){this.findArtifactMissionStrategy=new oI,this.hiddenTileMissionStrategy=new pI,this.targetTileMissionStrategy=new fI,this.strategies=[this.findArtifactMissionStrategy,this.hiddenTileMissionStrategy,this.targetTileMissionStrategy]}},{key:"init",value:function(e){this.gameplay=e;var t,n=l(this.strategies);try{for(n.s();!(t=n.n()).done;){t.value.init(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setJourneyBlock",value:function(e){this.journeyBlock=e}},{key:"getCurrentStrategy",value:function(){var e=ht.getCurrentMission();if(!e)return null;switch(e.type){case mt.FIND_ARTIFACT:return this.findArtifactMissionStrategy;case mt.HIDDEN_TILE:return this.hiddenTileMissionStrategy;case mt.TARGET_TILE:return this.targetTileMissionStrategy;default:return null}}},{key:"getLastStrategy",value:function(){var e=ht.getLastMission();if(!e)return null;switch(e.type){case mt.FIND_ARTIFACT:return this.findArtifactMissionStrategy;case mt.HIDDEN_TILE:return this.hiddenTileMissionStrategy;case mt.TARGET_TILE:return this.targetTileMissionStrategy;default:return null}}},{key:"getMissionType",value:function(){var e=ht.getCurrentMission();return e?e.type:null}},{key:"setup",value:function(){var e,t=this.getCurrentStrategy();if(t){this.hasMissionStarted=!0,this.isMissionCompleted=!1;var n=ht.getCurrentMission();t.setupMission(n);var i=t.setupTiles();null===(e=this.journeyBlock)||void 0===e||e.updateJourneyData(i),t.setupListeners()}}},{key:"terminateJourneyMission",value:function(){if(this.hasMissionStarted){var e=this.getLastStrategy();e&&(e.terminateListeners(),this.hasMissionStarted=!1,this.isMissionCompleted=!1)}}},{key:"isDescriptionCompleted",value:function(){if(!ht.getCurrentMission())return!1;var e=this.getCurrentStrategy();return!e||e.isDescriptionCompleted()}},{key:"setJourneyMissionCompleted",value:function(){ht.getCurrentMission()&&(this.isMissionCompleted=!0)}},{key:"getJourneyMissionCompleted",value:function(){return this.isMissionCompleted}}]),e}();b._RF.pop(),b._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var xI,RI,AI,_I,PI,BI,NI,OI,DI,FI,zI,MI=w.ccclass,UI=w.requireComponent,GI=w.property,HI=Ludex.Utils.Decorator,VI=(yI=MI("Gameplay"),vI=UI([nS]),gI=GI(Eb),mI=GI(Um),bI=GI(Wv),SI=HI.debounce(3e3),wI=on.onlyRunInLifeCycleAsync,yI(kI=vI((CI=u((TI=function(e){i(f,e);var s,u,d,p=a(f);function f(){var e;r(this,f);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=p.call.apply(p,[this].concat(a)),c(e,"scoreManager",CI,h(e)),c(e,"effectManager",EI,h(e)),c(e,"gameObjects",LI,h(e)),e.canShowShortcut=!1,e.setupGameBoard=t(n().mark((function t(){var i,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasGoldenTiles=!1,i=at.getLevel(),e.guideManager.terminateTutorial(),1!==i){t.next=6;break}return e.guideManager.loadTutorial("FirstGameTutorial"),t.abrupt("return");case 6:if(4===i&&e.guideManager.loadTutorial("FlowerTileTutorial"),6===i&&e.guideManager.loadTutorial("SeasonTileTutorial"),a=at.getLevelData()){t.next=11;break}return t.abrupt("return");case 11:return e.tileManager.clearTiles(),e.gameObjects.spawnObjects(a),e.handleSetupSpecialTiles(),t.next=16,e.tileManager.handleTilesCreated();case 16:case"end":return t.stop()}}),t)}))),e.handleStartGame=t(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.uiManager.runShowAnimation(),e.uiManager.runEventEntranceAnimation(),e.guideManager.startTutorial(),e.node.scene.emit(ny.GAME_START),e.lastLoggedProgress=0;case 5:case"end":return t.stop()}}),t)}))),e.handlePauseGame=function(t){e.pauseGame(),e.highlightTiles=codex.player.getPlayerSettings().highLight,e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(t){e.resumeGame();var n=codex.player.getPlayerSettings().highLight;e.tileManager.updateTilesCoveredState(e.highlightTiles!==n),e.processCrazyGamesGameplayStart()},e.handleReplayGame=function(){console.log("handleReplayGame"),e.stateManager.initialize()},e.handleGameRescue=t(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stateManager.ready(),e.uiManager.enableUI(),e.uiManager.runShowAnimation(),t.next=5,e.tileManager.handleShuffle();case 5:case"end":return t.stop()}}),t)}))),e.handleNextLevel=function(){e.stateManager.load(),e.canShowShortcut=!0,console.log("Next level",at.getLevel())},e.handleStartOver=function(){at.setLevel(1),at.setMaxLevel(1),e.stateManager.load()},e.handleSelectLevel=function(t){if(!t)throw new Error("handleSelectLevel: GameEvent payload is not defined");var n=t.level;if(n){var i=n<1?1:n;at.setLevel(i),at.setMaxLevel(i),e.stateManager.load()}},e.handleAutoFinishLevel=t(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.guideManager.terminateTutorial(),e.stateManager.autoFinish(),console.log("Auto Win Game");case 3:case"end":return t.stop()}}),t)}))),e.handleTwoTilesMatched=function(){e.logLevelProgress10()},e.handleJourneyLevelCompleted=function(){e.journeyLevelMechanicsManager.isDescriptionCompleted()&&!e.journeyLevelMechanicsManager.getJourneyMissionCompleted()&&(e.journeyLevelMechanicsManager.setJourneyMissionCompleted(),e.handleAutoFinishLevel())},e.lastLoggedProgress=0,e.handleTilesStateUpdated=function(){var t=e.tileManager.getNumberOfMatchPairs();e.uiManager.setMatchText(t)},e.handleShowHint=function(){e.tileManager.handleShowHint()},e.handleUndo=function(){e.tileManager.handleUndo()},e.handleShuffle=function(){e.tileManager.handleShuffle()},e.handleAutoPlay=function(){e.tileManager.handleAutoPlay()},e}return o(f,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenInputEvents()}},{key:"initComponents",value:function(){this.initUIManager(),this.initStateManager(),this.initTileManager(),this.initJourneyLevelMechanicsManager(),this.initGameModeManager(),this.initItemManager(),this.initGuideManager()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(QE)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(nS)}},{key:"initTileManager",value:function(){this.tileManager=this.getComponent(mb)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(Tb)}},{key:"initJourneyLevelMechanicsManager",value:function(){this.journeyLevelMechanicsManager=new II,this.journeyLevelMechanicsManager.init(this)}},{key:"initGameModeManager",value:function(){this.gameModeManager=new Vm,this.gameModeManager.init(this)}},{key:"initGuideManager",value:function(){var e;this.guideManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(iI),this.guideManager.init(this)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.scene.on(ny.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(ny.GAME_RESUME,this.handleResumeGame),this.node.scene.on(ny.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(ny.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(ny.START_OVER,this.handleStartOver),this.node.scene.on(ny.SELECT_LEVEL,this.handleSelectLevel),this.node.scene.on(ny.AUTO_FINISH_LEVEL,this.handleAutoFinishLevel),this.node.scene.on(ny.TWO_TILES_MATCHED,this.handleTwoTilesMatched),this.node.scene.on(ny.TILES_STATE_UPDATED,this.handleTilesStateUpdated),this.node.scene.on(ny.GAME_RESCUE,this.handleGameRescue),this.node.scene.on(ny.THEME_TILE_CHANGE,this.updateTilesTheme,this),this.node.scene.on(ny.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.on(ny.ALL_TILE_COVERED,this.handleGameOver,this),this.node.scene.on(ny.SHOW_HINT,this.handleShowHint),this.node.scene.on(ny.START_UNDO,this.handleUndo),this.node.scene.on(ny.START_SHUFFLE,this.handleShuffle),this.node.scene.on(ny.JOURNEY_MISSION_COMPLETE_CHECK,this.handleJourneyLevelCompleted)}},{key:"setCanWinOrEndGame",value:function(e){e?(this.node.scene.on(ny.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.on(ny.ALL_TILE_COVERED,this.handleGameOver,this)):(this.node.scene.off(ny.ALL_TILE_DESTROYED,this.handleGameWin,this),this.node.scene.off(ny.ALL_TILE_COVERED,this.handleGameOver,this))}},{key:"start",value:function(){if(St.getSceneData(this.node.scene).isFromLoader){var e=codex.match.getMatchState();if(e.mode===ng.CHALLENGE_FRIEND){var t=e.customData.level;t&&(at.setLevel(t),console.log("Continue game from loader",t));try{var n,i=null===(n=codex.context)||void 0===n?void 0:n.getContextData(),a=i.type,r=i.level;a&&r&&"share_invite"===a&&(at.setLevel(r),console.log("Continue game from loader share invite",r))}catch(e){console.error("Error in handleContinueGame",e)}}}this.initData(),this.initGame(),this.initDevTools()}},{key:"isGamePlaying",value:function(){return this.stateManager.isGamePlaying()}},{key:"initDevTools",value:function(){this.uiManager.initDevTools(this)}},{key:"initData",value:function(){}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.load()}},{key:"handlePreloadUpcomingScreens",value:(d=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:rt.getSpecialMode()===ft.JOURNEY&&(gt.preloadScreen(We.JOURNEY_WINNING_SCREEN),ht.isLevelWithBadges()&&gt.preloadScreen(We.BADGE_REWARD_SCREEN)),this.hasGoldenTiles&&gt.preloadScreen(We.TOURNAMENT_COMPLETE_SCREEN);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handleSetupSpecialTiles",value:function(){switch(this.getTileMode()){case"journey":this.handleSetupJourneyTiles();break;case"golden":this.handleSetupGoldenTiles()}}},{key:"getTileMode",value:function(){return rt.getSpecialMode()===ft.JOURNEY?"journey":jf.isTournamentHappening()?"golden":"normal"}},{key:"handleSetupGoldenTiles",value:function(){if(jf.isTournamentHappening()){var e=this.tileManager.getGoldenTileSprite();if(e){var t,n=this.tileManager.getGoldenTilesCandidates(),i=l(n);try{for(i.s();!(t=i.n()).done;){t.value.setGolden(e)}}catch(e){i.e(e)}finally{i.f()}this.hasGoldenTiles=n.length>0}}}},{key:"handleSetupJourneyTiles",value:function(){rt.getSpecialMode()===ft.JOURNEY?(this.journeyLevelMechanicsManager.terminateJourneyMission(),this.journeyLevelMechanicsManager.setup()):this.journeyLevelMechanicsManager.terminateJourneyMission()}},{key:"handleGameWin",value:function(){console.log("Win Game"),this.guideManager.terminateTutorial(),this.tileManager.clearTiles(),this.stateManager.nextLevel()}},{key:"handleGameOver",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Game Over"),this.guideManager.terminateTutorial(),this.stateManager.gameOver();case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleAllTileReady",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"logLevelProgress10",value:function(){if(!(this.guideManager.getIsTutorialRunning()||at.getLevel()>10)){var e=this.tileManager.getMatchedPairCount(),t=this.tileManager.getMatchedPairFailedCount(),n=this.scoreManager.getCurrentPlayTime(),i=this.tileManager.getTotalPairCount();if(0!==i&&0!==e){var a=Math.floor(100*e/i),r=10*Math.floor(a/10);r>this.lastLoggedProgress&&(this.lastLoggedProgress=r,codex.analytics.event(it.LEVEL_PROGRESS,{level:at.getLevel(),progress:r,match_count:e,match_failed_count:t,time_played:n,game_mode:this.gameModeManager.getGameMode()}))}}}},{key:"logCantShuffle",value:function(){var e;codex.analytics.event(it.CANT_SHUFFLE,{level:at.getLevel(),level_try_count:at.getTryCount(),leftover_pairs:this.tileManager.getLeftoverPairCount(),is_highlight:null!==(e=codex.player.getPlayerSetting("highLight"))&&void 0!==e&&e,has_golden_tiles:this.hasGoldenTiles})}},{key:"pauseGame",value:function(){this.node.active=!1,this.node.pauseSystemEvents(!0)}},{key:"resumeGame",value:function(){this.node.active=!0,this.node.resumeSystemEvents(!0)}},{key:"attemptCallCreateShortcut",value:function(){this.canShowShortcut&&(this.canShowShortcut=!1,at.getPlayerLevel()<2||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)})))}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"processCrazyGamesHappyTime",value:function(){"happyTime"in GameSDK.extra&&GameSDK.extra.happyTime()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){"CrazyGames"===GameSDK.getSDKName()&&this.uiManager.disableRewardAdsUI()}},{key:"updateTilesTheme",value:function(){this.tileManager.updateTilesTheme()}}]),f}(E)).prototype,"scoreManager",[gI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EI=u(TI.prototype,"effectManager",[mI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LI=u(TI.prototype,"gameObjects",[bI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(TI.prototype,"handlePreloadUpcomingScreens",[SI,wI],Object.getOwnPropertyDescriptor(TI.prototype,"handlePreloadUpcomingScreens"),TI.prototype),kI=TI))||kI)||kI);b._RF.pop(),b._RF.push({},"50568ZMYxhP4KHgiMLmPvsE","Board",void 0);var WI,qI,jI,KI,YI,JI,ZI,QI=w.ccclass,XI=w.property,$I=(xI=QI("Board"),RI=XI(x),AI=XI(ru),_I=XI(q),PI=XI(le),xI((OI=u((NI=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"reward",OI,h(e)),c(e,"progressBar",DI,h(e)),c(e,"progressText",FI,h(e)),c(e,"boxes",zI,h(e)),e}return o(n,[{key:"start",value:function(){}},{key:"updateCurrentLevel",value:function(e){var t,n=0,i=0,a=l(Tt.REWARD_LEVELS);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(e<=r){i=r;break}n=r}}catch(e){a.e(e)}finally{a.f()}if(0===i){this.progressBar.setProgress(1);var o=Tt.REWARD_LEVELS[Tt.REWARD_LEVELS.length-1];i=o,this.progressText.string="".concat(o," / ").concat(o)}else{var s=1===e?0:e-n-1==0?1:e-n-1,u=i-n;this.progressBar.setProgress(s/u),this.progressText.string="".concat(e-1," / ").concat(i)}var c=ht.getJourneyTheme(),h=ht.getRewardByLevel(i);"Badge"===h.type?(this.reward.spriteFrame=ht.getJourneyBadgeSpriteFrame(h.key,c),this.reward.node.scale=new U(.4,.4,1)):(this.reward.spriteFrame=this.boxes[h.chestIdx%this.boxes.length],this.reward.node.scale=new U(.4,.4,1))}}]),n}(E)).prototype,"reward",[RI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DI=u(NI.prototype,"progressBar",[AI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FI=u(NI.prototype,"progressText",[_I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zI=u(NI.prototype,"boxes",[PI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),BI=NI))||BI);b._RF.pop(),b._RF.push({},"a7e827XyI5Fj5JbaKeVWP7D","Cloud",void 0);var ex,tx,nx,ix,ax,rx=w.ccclass,ox=w.property,sx=[-13.5,18,12.6,18,10.8,-11.7,-13.5,12.6,-15.3],lx=(WI=rx("Cloud"),qI=ox(x),jI=ox(P),WI((JI=u((YI=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"clouds",JI,h(e)),c(e,"container",ZI,h(e)),e.isShowTweenRunning=!1,e.isHideTweenRunning=!1,e.isShowed=!1,e}return o(n,[{key:"onLoad",value:function(){var e=this;this.baseContainerPosition={x:this.container.position.x,y:this.container.position.y},this.runIdleAnimation();var t=this.baseContainerPosition,n=t.x,i=t.y;this.showTween=z(this.container).to(.8,{position:new U(n,i,0)}).call((function(){e.isShowTweenRunning=!1,e.isShowed=!0})),this.hideTween=z(this.container).to(.8,{position:new U(n,i+200,0)}).call((function(){e.isHideTweenRunning=!1,e.isShowed=!1,e.node.active=!1})),this.container.setPosition(new U(n,i+200,0))}},{key:"runIdleAnimation",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2.5,t=0;t<this.clouds.length;t++){var n=this.clouds[t],i=sx[t%sx.length],a=z(n.node).by(e,{position:new U(-i,0,0)}),r=z(n.node).by(e,{position:new U(i,0,0)});z(n.node).sequence(a,r).repeatForever().start()}}},{key:"show",value:function(){this.node.active=!0,this.isShowTweenRunning||(this.isHideTweenRunning&&(this.hideTween.stop(),this.isHideTweenRunning=!1,this.node.active=!0),this.isShowTweenRunning=!0,this.showTween.start())}},{key:"hide",value:function(){this.isHideTweenRunning||(this.isShowTweenRunning&&(this.showTween.stop(),this.isShowTweenRunning=!1),this.isHideTweenRunning=!0,this.hideTween.start())}},{key:"getIsShowed",value:function(){return this.isShowed}},{key:"setIsShowed",value:function(e){this.isShowed=e;var t=this.baseContainerPosition,n=t.x,i=t.y;e?this.container.setPosition(new U(n,i,0)):this.container.setPosition(new U(n,i+200,0))}}]),n}(E)).prototype,"clouds",[qI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ZI=u(YI.prototype,"container",[jI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KI=YI))||KI);b._RF.pop(),b._RF.push({},"bc488hBN4ZDNpqq3N+2yVdC","Reward",void 0);var ux,cx,hx,dx,px,fx,yx,vx,gx,mx,bx,Sx,wx,kx,Tx,Cx,Ex,Lx,Ix,xx,Rx,Ax=w.ccclass,_x=w.property,Px=(ex=Ax("Reward"),tx=_x(N),ex((ax=u((ix=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"lockOpacity",ax,h(e)),e}return o(u,[{key:"onLoad",value:function(){this.sprite=this.getComponent(x)}},{key:"setRewardSprite",value:function(e,t){this.sprite.spriteFrame=e,this.lockOpacity.node.active=!t,this.lockOpacity.opacity=t?0:255,this.sprite.color=t?new M(255,255,255,255):new M(126,100,106,192),this.lockOpacity.node.setPosition(this.node.position)}},{key:"resetRewardSprite",value:function(){this.lockOpacity.node.active=!1}},{key:"runUnlockAnimation",value:(s=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:1,z(this.lockOpacity).delay(t).to(.3,{opacity:0},{easing:"cubicOut"}).start(),i=z(this.sprite).delay(t+.3).to(.3,{color:new M(255,255,255,255)},{easing:"cubicOut"}),e.next=5,Ke.runTweenAsync(i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),u}(E)).prototype,"lockOpacity",[tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=ix))||nx);b._RF.pop(),b._RF.push({},"6082bwoGDhO+qG3N72ebY9K","JourneyLevelPath",void 0);var Bx,Nx,Ox,Dx,Fx,zx,Mx,Ux=w.ccclass,Gx=w.property,Hx=1100,Vx=232,Wx=(ux=Ux("JourneyLevelPath"),cx=Gx(x),hx=Gx(q),dx=Gx(x),px=Gx(Px),fx=Gx(le),yx=Gx(le),vx=Gx(P),gx=Gx(P),mx=Gx(le),ux((wx=u((Sx=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"sprites",wx,h(e)),c(e,"labels",kx,h(e)),c(e,"paths",Tx,h(e)),e.glow=void 0,e.path=void 0,c(e,"reward",Cx,h(e)),e.rewardTypes=[],c(e,"spriteFrames",Ex,h(e)),c(e,"pathSpriteFrames",Lx,h(e)),c(e,"levelNode",Ix,h(e)),c(e,"pathContainer",xx,h(e)),c(e,"chests",Rx,h(e)),e.isInitialized=!1,e}return o(d,[{key:"start",value:function(){this.init()}},{key:"init",value:function(){this.isInitialized||(this.isInitialized=!0)}},{key:"updateButtonLabel",value:function(e,t){this.isInitialized||this.init();var n,i=e.levels,a=e.useLastPath,r=e.currentLevel,o=l(this.paths);try{for(o.s();!(n=o.n()).done;){n.value.node.active=!1}}catch(e){o.e(e)}finally{o.f()}this.glow&&(this.glow.active=!1);var s,u=l(i);try{for(u.s();!(s=u.n()).done;){if(s.value===r&&this.glow){this.glow.active=!0;break}}}catch(e){u.e(e)}finally{u.f()}for(var c=0;c<this.sprites.length;c++){var h=this.sprites[c],d=this.labels[c],p=i[c],f=this.paths[c];c<i.length?(h.node.active=!0,d.node.active=!0,c>0&&(this.paths[c-1].node.active=!0),d.string=p.toString(),p>r?(h.spriteFrame=this.spriteFrames[0],d.color=new M(229,198,139,255)):p<r?(h.spriteFrame=this.spriteFrames[1],d.color=new M(244,220,160,255)):(h.spriteFrame=this.spriteFrames[2],d.color=new M(242,216,160,255),this.glow&&this.glow.setPosition(h.node.position)),p+1<=r?f.spriteFrame=this.pathSpriteFrames[1]:p+1>r&&(f.spriteFrame=this.pathSpriteFrames[0])):(h.node.active=!1,d.node.active=!1)}for(var y=0;y<this.labels.length;y++){var v=this.labels[y];v.node.parent=t;var g=this.sprites[y].node.position,m=this.node.position;v.node.setPosition(g.x+m.x,g.y+m.y+6,0)}this.sprites[this.sprites.length-1].node.active&&a&&(this.paths[this.paths.length-1].node.active=!0),this.reward.node.active=!1,this.reward.resetRewardSprite();for(var b=ht.getJourneyTheme(),S=0;S<i.length;S++)if(Tt.REWARD_LEVELS.includes(i[S])){this.reward.node.active=!0,this.reward.node.setPosition(this.sprites[S].node.position);var w=ht.getRewardByLevel(i[S]);if(this.rewardTypes[S]=w.type,"Badge"===w.type){var k=ht.getJourneyBadgeSpriteFrame(w.key,b);this.reward.setRewardSprite(k,i[S]<r),this.reward.node.scale=new U(1,1,1)}else"Chest"===w.type&&(this.reward.setRewardSprite(this.chests[w.chestIdx%this.chests.length],!0),this.reward.node.scale=new U(.6,.6,1));this.sprites[S].node.active=!1,this.labels[S].node.active=!1}else this.rewardTypes[S]=""}},{key:"setGlowNode",value:function(e){this.glow&&(this.glow.active=!1),this.glow=e,this.glow&&(this.glow.parent=this.levelNode,this.glow.setSiblingIndex(0))}},{key:"setPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.path=e,this.path){this.path.node.parent=this.pathContainer;var n=this.paths[t].node.position,i=n.x,a=n.y;switch(this.path.node.setPosition(i,a,0),this.path.setFlip(t%2==1),t){case 0:this.path.node.setScale(1,1),this.path.node.setRotationFromEuler(0,0,0);break;case 1:this.path.node.setScale(-1,-1),this.path.node.setRotationFromEuler(0,180,0);break;case 2:this.path.node.setScale(-1,1),this.path.node.setRotationFromEuler(0,0,0);break;case 3:this.path.node.setScale(1,-1),this.path.node.setRotationFromEuler(0,180,0)}}}},{key:"getLevelNode",value:function(e){if(e<0||e>=this.sprites.length)throw new Error("Index ".concat(e," is out of bounds for JourneyLevelPath"));return this.sprites[e]}},{key:"runRewardUnlockAnimation",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.reward.runUnlockAnimation());case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getRewardType",value:function(e){if(e<0||e>=this.rewardTypes.length)throw new Error("Index ".concat(e," is out of bounds for JourneyLevelPath"));return this.rewardTypes[e]}}],[{key:"getItemRealSize",value:function(e){switch(e){case 1:return 404;case 2:return 636;case 3:return 868;default:return Hx}}},{key:"getLevelDistance",value:function(){return Vx}}]),d}(vc)).prototype,"sprites",[cx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kx=u(Sx.prototype,"labels",[hx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Tx=u(Sx.prototype,"paths",[dx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Cx=u(Sx.prototype,"reward",[px],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ex=u(Sx.prototype,"spriteFrames",[fx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Lx=u(Sx.prototype,"pathSpriteFrames",[yx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ix=u(Sx.prototype,"levelNode",[vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xx=u(Sx.prototype,"pathContainer",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rx=u(Sx.prototype,"chests",[mx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bx=Sx))||bx);b._RF.pop(),b._RF.push({},"28265fkxtVAeotmTwoPD/p/","LevelGlow",void 0);var qx,jx,Kx,Yx,Jx,Zx,Qx,Xx,$x,eR,tR,nR,iR,aR,rR,oR,sR,lR,uR,cR=w.ccclass,hR=w.property,dR=Ludex.Utils.Signal,pR=(Bx=cR("LevelGlow"),Nx=hR(N),Ox=hR(N),Bx((zx=u((Fx=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"innerUiOpacity",zx,h(e)),c(e,"outerUiOpacity",Mx,h(e)),e.signalController=new dR.SignalController,e.idleTweens=[],e}return o(n,[{key:"onEnable",value:function(){var e,t=l(this.idleTweens);try{for(t.s();!(e=t.n()).done;){e.value.resume()}}catch(e){t.e(e)}finally{t.f()}}},{key:"onDisable",value:function(){var e,t=l(this.idleTweens);try{for(t.s();!(e=t.n()).done;){e.value.pause()}}catch(e){t.e(e)}finally{t.f()}}},{key:"runIdleAnimation",value:function(){var e=this.signalController.renew();this.idleTweens=[];var t=z(this.innerUiOpacity).to(2,{opacity:180},{easing:"smooth"}).to(2,{opacity:255},{easing:"smooth"}).union(),n=z(this.innerUiOpacity.node).to(1,{scale:new U(.95,.95,.9)},{easing:"smooth"}).delay(.2).to(1,{scale:new U(1.05,1.05,1.1)},{easing:"smooth"}).delay(.2).union(),i=z(this.innerUiOpacity).set({opacity:0}).to(1,{opacity:255},{easing:"sineInOut"}).repeatForever(t),a=z(this.innerUiOpacity.node).set({scale:new U(.7,.7,1)}).to(1,{scale:new U(1,1,1)},{easing:"sineInOut"}).repeatForever(n),r=z(this.outerUiOpacity).set({opacity:128}).to(1.25,{opacity:255},{easing:"sineInOut"}).to(.25,{opacity:0},{easing:"sineIn"}).delay(.5).union(),o=z(this.outerUiOpacity.node).set({scale:new U(.3,.3,1)}).to(1.5,{scale:new U(1,1,1)},{easing:"sineInOut"}).delay(.5).union(),s=z(this.outerUiOpacity).set({opacity:200}).repeatForever(r),l=z(this.outerUiOpacity.node).set({scale:new U(.5,.5,1)}).repeatForever(o);Ke.runTweenAsync(i,e),Ke.runTweenAsync(a,e),Ke.runTweenAsync(s,e),Ke.runTweenAsync(l,e),this.idleTweens.push(i,s)}},{key:"resetAnimation",value:function(){this.signalController.abort(),this.idleTweens=[],this.node.setScale(1,1,1),this.innerUiOpacity.opacity=0,this.outerUiOpacity.opacity=0}},{key:"runCloseAnimation",value:function(){var e=this.signalController.renew();this.idleTweens=[];var t=z(this.innerUiOpacity).to(.2,{opacity:0},{easing:"smooth"}),n=z(this.outerUiOpacity).to(.2,{opacity:0},{easing:"smooth"});Ke.runTweenAsync(t,e),Ke.runTweenAsync(n,e)}}]),n}(E)).prototype,"innerUiOpacity",[Nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mx=u(Fx.prototype,"outerUiOpacity",[Ox],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dx=Fx))||Dx);b._RF.pop(),b._RF.push({},"8c01ejYEylAVrb+ubvjV2md","Path",void 0);var fR,yR=w.ccclass,vR=w.property,gR=Ludex.Utils.Signal,mR=241,bR=273,SR=220,wR=(qx=yR("Path"),jx=vR(R),Kx=vR(R),Yx=vR(x),Jx=vR(x),Zx=vR(x),Qx=vR(le),Xx=vR(le),$x=vR(B),qx((nR=u((tR=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"mask1",nR,h(e)),c(e,"mask2",iR,h(e)),e.signalController=new gR.SignalController,c(e,"path0",aR,h(e)),c(e,"path1",rR,h(e)),c(e,"path2",oR,h(e)),c(e,"unfinishedSpriteFrame",sR,h(e)),c(e,"completedSpriteFrame",lR,h(e)),c(e,"flip",uR,h(e)),e}return o(u,[{key:"start",value:function(){this.updateSpriteFrame(),this.reset()}},{key:"setFlip",value:function(e){this.flip=e,this.updateSpriteFrame(),this.reset()}},{key:"updateSpriteFrame",value:function(){this.flip?(this.path0.spriteFrame=this.completedSpriteFrame,this.path1.spriteFrame=this.unfinishedSpriteFrame,this.path2.spriteFrame=this.unfinishedSpriteFrame):(this.path0.spriteFrame=this.unfinishedSpriteFrame,this.path1.spriteFrame=this.completedSpriteFrame,this.path2.spriteFrame=this.completedSpriteFrame)}},{key:"reset",value:function(){this.signalController.abort(),this.setUnfinished()}},{key:"runAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:.5,this.reset(),i=this.signalController.renew(),this.flip){e.next=12;break}return a=z(this.mask1).to(.5*t,{width:bR}),r=z(this.mask2).to(.5*t,{width:SR}),e.next=8,Ke.runTweenAsync(a,i);case 8:return e.next=10,Ke.runTweenAsync(r,i);case 10:e.next=18;break;case 12:return o=z(this.mask1).to(.5*t,{width:0}),s=z(this.mask2).to(.5*t,{width:0}),e.next=16,Ke.runTweenAsync(s,i);case 16:return e.next=18,Ke.runTweenAsync(o,i);case 18:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setUnfinished",value:function(){this.signalController.abort(),this.flip?(this.mask1.setContentSize(bR,mR),this.mask2.setContentSize(SR,mR)):(this.mask1.setContentSize(0,mR),this.mask2.setContentSize(0,mR))}},{key:"setCompleted",value:function(){this.signalController.abort(),this.flip?(this.mask1.setContentSize(0,mR),this.mask2.setContentSize(0,mR)):(this.mask1.setContentSize(bR,mR),this.mask2.setContentSize(SR,mR))}}]),u}(E)).prototype,"mask1",[jx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iR=u(tR.prototype,"mask2",[Kx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aR=u(tR.prototype,"path0",[Yx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rR=u(tR.prototype,"path1",[Jx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oR=u(tR.prototype,"path2",[Zx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sR=u(tR.prototype,"unfinishedSpriteFrame",[Qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lR=u(tR.prototype,"completedSpriteFrame",[Xx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uR=u(tR.prototype,"flip",[$x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),eR=tR))||eR);b._RF.pop(),b._RF.push({},"b29b2H0f5tNTbB9E3XZQDT3","JourneyFakeLevelPath",void 0);var kR,TR,CR,ER,LR,IR,xR,RR,AR,_R,PR,BR,NR,OR=w.ccclass,DR=(w.property,OR("JourneyFakeLevelPath")(fR=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"setData",value:function(e){this.setIdx(e.idx),this.payload=e}},{key:"setRealItem",value:function(e){y(f(n.prototype),"setRealItem",this).call(this,e)}},{key:"getRealItem",value:function(){return y(f(n.prototype),"getRealItem",this).call(this)}},{key:"getPayload",value:function(){return this.payload}}]),n}(zu))||fR);b._RF.pop(),b._RF.push({},"6a70avWsZdNlr0ZkpTsIhA6","JourneyReusableScroller",void 0);var FR,zR,MR,UR,GR,HR,VR,WR,qR,jR,KR,YR,JR,ZR,QR,XR,$R,eA,tA,nA=w.ccclass,iA=w.property,aA=(kR=nA("JourneyReusableScroller"),TR=iA(pR),CR=iA(wR),ER=iA(P),LR=iA(P),IR=iA(Bd),kR((AR=u((RR=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"levelGlow",AR,h(e)),c(e,"path",_R,h(e)),c(e,"itemContainer",PR,h(e)),c(e,"labelContainer",BR,h(e)),c(e,"completedLabel",NR,h(e)),e}return o(d,[{key:"onLoad",value:function(){y(f(d.prototype),"onLoad",this).call(this),this.contentUITransform=this.content.getComponent(R),this.levelGlow.node.active=!1}},{key:"loadScroller",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e,i=0;if(t<=Tt.REWARD_2_LEVEL){n=[];for(var a=t<=Tt.REWARD_1_LEVEL?Tt.REWARD_1_LEVEL:Tt.REWARD_2_LEVEL,r=0;r<e.length;r++)if(n.push(e[r]),r>0&&e[r-1].levels.includes(a)){var o=e[r-1].levels.indexOf(a),s=Wx.getItemRealSize(4);i=-s-(0===o?.5*s:0);break}}this.currentLevel=t,this.setUpBeforeLoadScroller(n,i),y(f(d.prototype),"loadScroller",this).call(this,n),this.payloads=e;var l=ht.checkJourneyComplete(),u=200,c=this.contentUITransform.height;this.completedLabel.node.active=l,this.completedLabel.node.setPosition(0,c-this.getOffsetHeader()-u/2,0)}},{key:"setUpBeforeLoadScroller",value:function(e,t){var n=this.viewUITransform.height,i=e[e.length-1],a=Wx.getItemRealSize(i.levels.length),r=Wx.getItemRealSize(4),o=ht.checkJourneyComplete()?200:0,s=Ye.getBannerAdsHeight(),l=.5*-n-this.distanceBetweenItems+a-r+175+o+t,u=.5*-n+100+330+s;this.setOffsetHeader(l),this.setOffsetBottom(u)}},{key:"reloadScroller",value:function(){var e=this.content.position.y,t=this.payloads;void 0!==this.payloads&&0!==this.payloads.length&&(this.loadScroller(t,this.currentLevel),this.scroller.scrollToTargetY(e),this.handleDiscreteScroll())}},{key:"createRealItem",value:function(){var e=$(this.itemPrefab);return this.itemContainer.addChild(e),e.getComponent(vc)}},{key:"createFakeItem",value:function(e){
//! temporary
var t=new DR;return t.setData(e),t}},{key:"updateFakeItems",value:function(e){for(var t=0;t<e.length;t++){this.fakeItems[t].setData(e[t])}}},{key:"updateScrollItems",value:function(e){this.currentLevelPath=void 0,this.currentLevelIndex=-1;for(var t=0;t<e.length;t++){var n=e[t],i=e[t-1];this.updateRealItem(n,i)}}},{key:"updateRealItem",value:function(e,t){var n=e.getPosition(),i=e.getRealItem();i.node.active=e.getActive(),i.node.setPosition(n);var a=e.getPayload(),r=a.levels,o=a.useLastPath,s=this.currentLevel,l=r.indexOf(s);-1!==l?(i.setGlowNode(this.levelGlow.node),this.currentLevelPath=i,this.currentLevelIndex=l,l>0?i.setPath(this.path,l-1):t&&t.getRealItem().setPath(this.path,r.length-1)):(i.setGlowNode(void 0),i.setPath(void 0));i.updateButtonLabel({levels:r,useLastPath:o,currentLevel:s},this.labelContainer),this.itemContainer.removeChild(i.node),this.itemContainer.addChild(i.node)}},{key:"scrollToTargetLevel",value:function(e){var t=-Wx.getLevelDistance()*(e-2);this.scroller.scrollToTargetY(t),this.refreshScroller()}},{key:"scrollToTargetLevelAsync",value:(l=t(n().mark((function e(t){var i,a,r,o,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:0,a=!(l.length>2&&void 0!==l[2])||l[2],!(t>ht.getLevelCount())){e.next=4;break}return e.abrupt("return");case 4:return r=Wx.getLevelDistance(),o=-r*(t-2),e.abrupt("return",new Promise((function(e){if(0===i)return s.scrollToTargetLevel(t),void e();a&&s.scroller&&s.scroller.setFreeControl(!0);var n=s.content.position.y,r=z({value:n}).to(i,{value:o},{onUpdate:function(e){s.scroller&&(s.scroller.scrollToTargetY(e.value),s.refreshScroller())}});Ke.runTweenAsync(r).then((function(){a&&s.scroller&&s.scroller.setFreeControl(!1),e()}))})));case 7:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"getDistanceToTop",value:function(){var e=this.content.position.y,t=-this.contentUITransform.height;return Math.abs(t-e)}},{key:"getCurrentScrollPercentValue",value:function(){var e=this.content.position.y,t=-this.contentUITransform.height;return 0===t?(console.warn("JourneyReusableScroller: minScrollValue and maxScrollValue are equal."),0):(e-0)/(t-0)}},{key:"prepareRunAnimation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.levelGlow.resetAnimation(),this.path.node.active=!0,e&&this.lockScroll()}},{key:"runCloseAnimation",value:function(){this.levelGlow.runCloseAnimation()}},{key:"runAnimationNextLevel",value:(s=t(n().mark((function e(){var t,i,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st(100);case 2:return e.next=4,this.path.runAnimation().then((function(){a.path.node.active=!1}));case 4:return t=this.currentLevelPath.getLevelNode(this.currentLevelIndex),i=z(t.node).to(.15,{scale:new U(.9,.9,.9)},{easing:"sineInOut"}).to(.2,{scale:new U(1.1,1.1,1.1)},{easing:"sineInOut"}).to(.15,{scale:new U(1,1,1)},{easing:"sineInOut"}),e.next=8,Ke.runTweenAsync(i);case 8:return this.runIdleAnimation(),e.next=11,st(200);case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"runIdleAnimation",value:function(){switch(this.currentLevelPath.getRewardType(this.currentLevelIndex)){case"Badge":this.levelGlow.node.scale=new U(1.8,1.8,1);break;case"Chest":this.levelGlow.node.scale=new U(1.4,1.4,1);break;default:this.levelGlow.node.scale=new U(1,1,1)}this.levelGlow.runIdleAnimation()}},{key:"lockScroll",value:function(){this.scroller.setFreeControl(!0)}},{key:"unlockScroll",value:function(){this.scroller.setFreeControl(!1)}},{key:"getCurrentLevelPath",value:function(){return this.currentLevelPath}},{key:"setCurrentLevel",value:function(e){this.currentLevel=e;var t=this.getVisibleFakeItems();this.updateScrollItems(t)}}]),d}(bc)).prototype,"levelGlow",[TR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_R=u(RR.prototype,"path",[CR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PR=u(RR.prototype,"itemContainer",[ER],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BR=u(RR.prototype,"labelContainer",[LR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NR=u(RR.prototype,"completedLabel",[IR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xR=RR))||xR);b._RF.pop(),b._RF.push({},"6a55dE439JNFYG8U7LV2mMb","JourneyLevelScreen",void 0);var rA,oA,sA,lA,uA,cA,hA,dA,pA,fA,yA,vA,gA,mA,bA,SA,wA,kA=w.ccclass,TA=w.property,CA=(w.requireComponent,Ludex),EA=CA.Events,LA=CA.Utils,IA=codex,xA=(IA.player,IA.event),RA=(FR=kA("JourneyLevelScreen"),zR=TA(P),MR=TA(aA),UR=TA($I),GR=TA(lx),HR=TA(Bd),VR=TA(D),WR=TA(D),qR=TA(x),FR((YR=u((KR=function(e){i(p,e);var s,u,d=a(p);function p(){var e;r(this,p);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=d.call.apply(d,[this].concat(a)),c(e,"devToolsContainer",YR,h(e)),c(e,"reusableScroller",JR,h(e)),c(e,"board",ZR,h(e)),c(e,"cloud",QR,h(e)),c(e,"timerText",XR,h(e)),c(e,"buttons",$R,h(e)),c(e,"playButton",eA,h(e)),c(e,"footerSprite",tA,h(e)),e.disableInteraction=function(){var t,n=l(e.buttons);try{for(n.s();!(t=n.n()).done;){t.value.interactable=!1}}catch(e){n.e(e)}finally{n.f()}},e.loadJourneyData=function(t){for(var n=ht.getLevelCount(),i=t||ht.getCurrentLevel(),a=[],r=1;r<=n;r+=4){for(var o=[r],s=1;s<4&&r+s<=n;s++)o.push(r+s);a.push({idx:r,levels:o,useLastPath:r+4<=n})}e.reusableScroller.loadScroller(a,i);var l=ht.checkJourneyComplete();e.board.node.active=!l,e.board.updateCurrentLevel(ht.getCurrentLevel())},e.loadFooter=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ht.loadJourneyFooterSpriteFrame());case 1:case"end":return e.stop()}}),e)}))),e.updateFooter=function(){var t=ht.getJourneyFooterSpriteFrame();t?e.footerSprite.spriteFrame=t:e.loadFooter().then((function(){var t=ht.getJourneyFooterSpriteFrame();e.footerSprite.spriteFrame=t}))},e.updateJourneyTime=function(){var t=ht.getJourneyEndTime();e.timerText.key=t.key,e.timerText.setParams(t.params),t.remainingTime<=0&&e.handleClose()},e.updateShowHideCloud=function(){var t=e.reusableScroller.getDistanceToTop(),n=Wx.getItemRealSize(4),i=e.cloud.getIsShowed();t<=.25*n?i||e.cloud.show():i&&e.cloud.hide()},e.handleOpenedScreen=function(){var i=t(n().mark((function t(i){var a,r,o,s,l,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(i)){t.next=2;break}return t.abrupt("return");case 2:if(o=e.screen.data,s=null==o||null===(a=o.customData)||void 0===a?void 0:a.rewardType,l=e.getShowLevel(s),u=null==o||null===(r=o.customData)||void 0===r?void 0:r.useNextLevelAnimation,e.preloadLevel(),e.loadJourneyData(l),e.updateJourneyTime(),e.updateFooter(),e.updatePlayButton(),e.schedule(e.updateJourneyTime,1),e.cloud.node.active=!1,e.cloud.setIsShowed(!1),e.schedule(e.updateShowHideCloud,.5),e.reusableScroller.scrollToTargetLevel(l),u&&e.reusableScroller.prepareRunAnimation(),!s||s===Ct.CHEST){t.next=37;break}return e.reusableScroller.path.node.active=!1,e.board.node.active=!0,t.next=22,gt.openScreenAndWaitForClose(We.BADGE_REWARD_SCREEN,{source:We.JOURNEY_LEVEL_SCREEN,customData:{theme:ht.getJourneyTheme(),key:s,isReward:!0}});case 22:return t.next=24,e.reusableScroller.getCurrentLevelPath().runRewardUnlockAnimation();case 24:if(e.reusableScroller){t.next=26;break}return t.abrupt("return");case 26:return e.reusableScroller.setCurrentLevel(l+1),e.reusableScroller.reloadScroller(),e.reusableScroller.path.node.active=!ht.checkJourneyComplete(),t.next=31,e.reusableScroller.scrollToTargetLevelAsync(l+1,1,!1);case 31:if(e.reusableScroller){t.next=33;break}return t.abrupt("return");case 33:return e.runScrollerAnimation(u),e.screen.data.customData.rewardType=void 0,e.runBoardAnimation(),t.abrupt("return");case 37:e.checkShowBoard(),e.screen.animation?e.screen.animation.once(k.EventType.FINISHED,(function(){e.runScrollerAnimation(u)})):e.runScrollerAnimation(u);case 39:case"end":return t.stop()}}),t)})));return function(e){return i.apply(this,arguments)}}(),e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.disableInteraction(),e.unschedule(e.updateJourneyTime),e.unschedule(e.updateShowHideCloud),e.reusableScroller.runCloseAnimation())},e.isBoardAnimRunning=!1,e}return o(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),ht.getJourneyFooterSpriteFrame()||this.screen.addPreloadPromise(ht.loadJourneyFooterSpriteFrame),this.devToolsContainer.active=LA.Valid.isDebugger()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"enableInteraction",value:function(){var e,t=l(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}}},{key:"updatePlayButton",value:function(){var e=ht.checkJourneyComplete();this.playButton.node.active=!e}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){xA.on(EA.OPENED_SCREEN,this.handleOpenedScreen),xA.on(EA.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){xA.off(EA.OPENED_SCREEN,this.handleOpenedScreen),xA.off(EA.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"preloadLevel",value:function(){Ne.isPrefabLoaded($e.JOURNEY_BLOCK_PREFAB)||Ne.preloadPrefab($e.JOURNEY_BLOCK_PREFAB);var e=ht.getJourneyTheme();ht.isLoadedCurrentJourneyTileTheme()||Ne.preloadSpriteFramesDir("".concat($e.TILE_PREFIX).concat(e,"/"));var t=ht.getCurrentMission().gameLevel;at.hasLevelData(t)||at.preloadLevelDataAsync(t)}},{key:"getShowLevel",value:function(e){return void 0===e||e===Ct.CHEST?ht.getCurrentLevel():ht.getCurrentLevel()-1}},{key:"runScrollerAnimation",value:function(e){var t,n=this;this.reusableScroller&&(ht.checkJourneyComplete()?(this.reusableScroller.unlockScroll(),this.enableInteraction()):e?this.reusableScroller.runAnimationNextLevel().then((function(){n.reusableScroller.unlockScroll(),n.enableInteraction()})):(this.reusableScroller.runIdleAnimation(),this.reusableScroller.unlockScroll(),this.enableInteraction()),null!==(t=this.screen.data)&&void 0!==t&&t.customData&&(this.screen.data.customData.useNextLevelAnimation=void 0))}},{key:"scrollToTargetLevel",value:function(e){this.reusableScroller.scrollToTargetLevel(e)}},{key:"processIncreaseLevel",value:function(){this.loadJourneyData(ht.getCurrentLevel()),this.scrollToTargetLevel(ht.getCurrentLevel()),this.reusableScroller.prepareRunAnimation(!1),this.reusableScroller.runAnimationNextLevel(),this.reusableScroller.scrollToTargetLevel(ht.getCurrentLevel()),this.updatePlayButton()}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.disableInteraction(),gt.closeScreen(We.JOURNEY_LEVEL_SCREEN)}},{key:"handleClose",value:function(){this.close()}},{key:"handleClickedPlay",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ht.checkJourneyComplete()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ye.showInterstitialAdAsync();case 4:this.processPlayLevel();case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleClickedBadge",value:function(){this.disableInteraction(),gt.closeScreen(We.JOURNEY_LEVEL_SCREEN,{openNextScreenImmediately:!0}),gt.openScreen(We.BADGES_SCREEN,{preloadCallback:ht.isNeedClaimedBadges()?ht.loadClaimedBadges:void 0,source:We.JOURNEY_LEVEL_SCREEN})}},{key:"processPlayLevel",value:function(){var e,t;this.close(),(null===(e=codex.match.getMatchState())||void 0===e?void 0:e.mode)!==ng.CHALLENGE_FRIEND&&(null===(t=codex.match.getMatchState())||void 0===t?void 0:t.mode)!==ng.TOURNAMENT||rt.switchToSoloContext();var n=ht.getCurrentMission();at.setLevel(n.gameLevel),rt.switchToJourney(ht.getSeason(),ht.getCurrentLevel()),ht.logJourneyStartLevel(),this.node.scene.emit(ny.SWITCH_SCENE,(function(){St.switchToGameScene()}))}},{key:"checkShowBoard",value:function(){var e=ht.checkJourneyComplete();this.board.node.active=!e}},{key:"runBoardAnimation",value:(s=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ht.checkJourneyComplete()){e.next=3;break}return e.abrupt("return");case 3:if(!this.isBoardAnimRunning){e.next=5;break}return e.abrupt("return");case 5:return t={x:this.board.node.position.x,y:this.board.node.position.y,z:this.board.node.position.z},this.board.node.active=!0,this.isBoardAnimRunning=!0,i=z(this.board.node).by(1,{position:new U(0,300,0)},{easing:"sineInOut"}),e.next=11,Ke.runTweenAsync(i);case 11:this.board.node.active=!1,this.board.node.setPosition(t.x,t.y,t.z),this.isBoardAnimRunning=!1;case 14:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"devToolsContainer",[zR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JR=u(KR.prototype,"reusableScroller",[MR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZR=u(KR.prototype,"board",[UR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QR=u(KR.prototype,"cloud",[GR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XR=u(KR.prototype,"timerText",[HR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$R=u(KR.prototype,"buttons",[VR],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),eA=u(KR.prototype,"playButton",[WR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tA=u(KR.prototype,"footerSprite",[qR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jR=KR))||jR);b._RF.pop(),b._RF.push({},"4368899v6lKV5yvR09mGmkN","JourneyDevTools",void 0);var AA,_A,PA,BA,NA,OA,DA,FA=w.ccclass,zA=w.property;rA=FA("JourneyDevTools"),oA=zA(RA),sA=zA(P),lA=zA(P),uA=zA(P),cA=zA(P),hA=zA(P),dA=zA(P),rA((yA=u((fA=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"journeyScreen",yA,h(e)),c(e,"devToolsButton",vA,h(e)),c(e,"resetButton",gA,h(e)),c(e,"endButton",mA,h(e)),c(e,"nextLevelButton",bA,h(e)),c(e,"selectLevelButton",SA,h(e)),c(e,"selectSeasonButton",wA,h(e)),e.handleClickResetButton=function(){ht.resetNewSeason(),e.journeyScreen.scrollToTargetLevel(ht.getCurrentLevel())},e.handleClickEndButton=function(){var e=(new Date).getTime()+5e3;ht.setEndTime(new Date(e))},e.handleClickAdvanceButton=function(){ht.increaseLevel(),e.journeyScreen.processIncreaseLevel()},e.handleClickDevToolsButton=function(){e.toggleAllButtons()},e}return o(u,[{key:"start",value:function(){this.handleToggleDevToolsButton(),this.handleJourneyButtons(),this.toggleAllButtons()}},{key:"handleToggleDevToolsButton",value:function(){this.devToolsButton.on(P.EventType.TOUCH_START,this.handleClickDevToolsButton)}},{key:"handleJourneyButtons",value:function(){this.resetButton.on(P.EventType.TOUCH_START,this.handleClickResetButton),this.endButton.on(P.EventType.TOUCH_START,this.handleClickEndButton),this.nextLevelButton.on(P.EventType.TOUCH_START,this.handleClickAdvanceButton)}},{key:"handleClickSelectLevelButton",value:function(e){var t=Number(e.string);ht.setCurrentLevel(t),this.journeyScreen.loadJourneyData(),this.journeyScreen.updatePlayButton(),this.journeyScreen.scrollToTargetLevel(ht.getCurrentLevel()),this.journeyScreen.runScrollerAnimation(!1),this.journeyScreen.reusableScroller.scrollToTargetLevel(t)}},{key:"handleClickSelectSeasonButton",value:(s=t(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Number(t.string),ht.setSeason(i),ht.resetNewSeason(),this.journeyScreen.loadJourneyData(),this.journeyScreen.updatePlayButton(),this.journeyScreen.reusableScroller.scrollToTargetLevel(ht.getCurrentLevel()),gt.showLoadingScreen(),e.next=9,ht.loadJourneyButtonSpriteFrame();case 9:gt.closeLoadingScreen(),gt.closeScreen(We.JOURNEY_LEVEL_SCREEN);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"toggleAllButtons",value:function(){var e=this;this.getComponentsInChildren(D).forEach((function(t){t.node.name!==e.devToolsButton.name&&(t.node.active=!t.node.active)}))}}]),u}(E)).prototype,"journeyScreen",[oA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vA=u(fA.prototype,"devToolsButton",[sA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gA=u(fA.prototype,"resetButton",[lA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mA=u(fA.prototype,"endButton",[uA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bA=u(fA.prototype,"nextLevelButton",[cA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SA=u(fA.prototype,"selectLevelButton",[hA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wA=u(fA.prototype,"selectSeasonButton",[dA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pA=fA));b._RF.pop(),b._RF.push({},"04da7voGFNPBapjpx+YXc9R","TournamentDevTools",void 0);var MA,UA=w.ccclass,GA=w.property;AA=UA("TournamentDevTools"),_A=GA(P),PA=GA(P),AA((OA=u((NA=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"devToolsButton",OA,h(e)),c(e,"endTournamentButton",DA,h(e)),e.handleClickEndTournamentButton=function(){var e=Date.now();jf.inst.tournamentData.endTime=e/1e3+30},e.handleClickDevToolsButton=function(){e.toggleAllButtons()},e}return o(n,[{key:"start",value:function(){this.handleToggleDevToolsButton(),this.handleEndTournamentButton(),this.toggleAllButtons()}},{key:"handleToggleDevToolsButton",value:function(){this.devToolsButton.on(P.EventType.TOUCH_START,this.handleClickDevToolsButton)}},{key:"handleEndTournamentButton",value:function(){this.endTournamentButton.on(P.EventType.TOUCH_START,this.handleClickEndTournamentButton)}},{key:"toggleAllButtons",value:function(){var e=this;this.getComponentsInChildren(D).forEach((function(t){t.node.name!==e.devToolsButton.name&&(t.node.active=!t.node.active)}))}}]),n}(E)).prototype,"devToolsButton",[_A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DA=u(NA.prototype,"endTournamentButton",[PA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BA=NA));b._RF.pop(),b._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var HA,VA,WA,qA,jA,KA=w.ccclass,YA=w.disallowMultiple,JA=w.executeInEditMode,ZA=w.requireComponent,QA=KA("ParticleSystem2DExtra")(MA=JA(!0)(MA=YA(!0)(MA=ZA(ae)(MA=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var r=i[a];e.updateParticle(r,n)}t(n)}},e}return o(n,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(ae),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}}]),n}(E))||MA)||MA)||MA)||MA;b._RF.pop(),b._RF.push({},"400fdviQqBM1KcojfwM0uT/","TileSelectParticleSystem2DExtra",void 0);var XA,$A,e_,t_,n_,i_,a_,r_,o_,s_,l_,u_=w.ccclass,c_=w.property;HA=u_("TileSelectParticleSystem2DExtra"),VA=c_(R),HA((jA=u((qA=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"selectedUITransform",jA,h(e)),e}return o(n,[{key:"initParticle",value:function(e){var t=ee.absMax(this.selectedUITransform.width,this.selectedUITransform.height)/100;e.timeToLive=3*t+ee.randomRange(-1,1)*t,e.maxSize=ee.randomRange(.25,1)*e.size*t,e.size=0,e.deltaSize=0,e.cycleDuration=ee.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=this.selectedUITransform.width,n=this.selectedUITransform.height,i=e.x,a=e.y;return e.x=i+ee.randomRange(-t/2,t/2),e.y=a+ee.randomRange(0,n/2)-n/2,e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),n}(QA)).prototype,"selectedUITransform",[VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WA=qA));b._RF.pop(),b._RF.push({},"87767KZVqpEgIbdzZdGh1CJ","BatchObjectManager",void 0),b._RF.pop(),b._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var h_,d_,p_,f_,y_,v_,g_,m_,b_,S_,w_,k_,T_,C_,E_,L_,I_,x_=w.ccclass,R_=w.property,A_=(XA=x_("Burst"),$A=R_(Z),e_=R_(C),t_=R_(Z),n_=R_(C),XA((r_=u((a_=function(){function e(){r(this,e),c(this,"time",r_,this),c(this,"repeatCount",o_,this),c(this,"repeatInterval",s_,this),c(this,"count",l_,this),this.remainingCount=0,this.curTime=0}return o(e,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=de(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=de(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),e}()).prototype,"time",[$A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o_=u(a_.prototype,"repeatCount",[e_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),s_=u(a_.prototype,"repeatInterval",[t_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),l_=u(a_.prototype,"count",[n_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),i_=a_))||i_);b._RF.pop(),b._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var __,P_,B_,N_,O_,D_,F_,z_,M_,U_,G_,H_,V_,W_,q_,j_,K_,Y_=w.ccclass,J_=w.property,Z_=J({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),Q_=(h_=Y_("CurveRange"),d_=J_({type:J(Z_)}),p_=J_({visible:function(){return this.mode===Z_.Constant}}),f_=J_({visible:function(){return this.mode===Z_.Curve}}),y_=J_({visible:function(){return this.mode===Z_.TwoCurves}}),v_=J_({visible:function(){return this.mode===Z_.TwoCurves}}),g_=J_({visible:function(){return this.mode===Z_.TwoConstants}}),m_=J_({visible:function(){return this.mode===Z_.TwoConstants}}),h_((w_=u((S_=function(){function e(){r(this,e),c(this,"mode",w_,this),c(this,"constant",k_,this),c(this,"spline",T_,this),c(this,"splineMin",C_,this),c(this,"splineMax",E_,this),c(this,"constantMin",L_,this),c(this,"constantMax",I_,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return o(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case Z_.Curve:return this.spline.evaluate(e);case Z_.TwoCurves:return pe(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case Z_.TwoConstants:return pe(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case Z_.Curve:return 1;case Z_.TwoConstants:return this.constantMax;case Z_.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case Z_.Curve:return fe(1,0,ye);case Z_.TwoConstants:return fe(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,ye);case Z_.TwoCurves:return fe(1,0,ye);default:return fe(this.constant,0,ye)}}}]),e}()).prototype,"mode",[d_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z_.Constant}}),k_=u(S_.prototype,"constant",[p_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T_=u(S_.prototype,"spline",[f_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ve}}),C_=u(S_.prototype,"splineMin",[y_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ve}}),E_=u(S_.prototype,"splineMax",[v_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ve}}),L_=u(S_.prototype,"constantMin",[g_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),I_=u(S_.prototype,"constantMax",[m_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b_=S_))||b_);b._RF.pop(),b._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var X_=w.ccclass,$_=w.property,eP=J({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),tP=new M,nP=new M,iP=(__=X_("GradientRange"),P_=$_({type:J(eP)}),B_=$_({visible:function(){return this.mode===eP.Color}}),N_=$_({visible:function(){return this.mode===eP.TwoColors}}),O_=$_({visible:function(){return this.mode===eP.TwoColors}}),D_=$_({visible:function(){return this.mode===eP.Gradient||this.mode===eP.RandomColor}}),F_=$_({visible:function(){return this.mode===eP.TwoGradients}}),z_=$_({visible:function(){return this.mode===eP.TwoGradients}}),__((G_=u((U_=function(){function e(){r(this,e),c(this,"mode",G_,this),c(this,"color",H_,this),c(this,"colorMin",V_,this),c(this,"colorMax",W_,this),c(this,"gradient",q_,this),c(this,"gradientMin",j_,this),c(this,"gradientMax",K_,this),this._color=M.WHITE.clone()}return o(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case eP.Color:return this.color;case eP.TwoColors:return M.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case eP.RandomColor:return this.gradient.getRandomColor(this._color);case eP.Gradient:return this.gradient.evaluateFast(this._color,e);case eP.TwoGradients:return M.lerp(this._color,this.gradientMin.evaluateFast(tP,e),this.gradientMax.evaluateFast(nP,e),t),this._color;default:return this.color}}}]),e}()).prototype,"mode",[P_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return eP.Color}}),H_=u(U_.prototype,"color",[B_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.WHITE.clone()}}),V_=u(U_.prototype,"colorMin",[N_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.WHITE.clone()}}),W_=u(U_.prototype,"colorMax",[O_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.WHITE.clone()}}),q_=u(U_.prototype,"gradient",[D_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ge}}),j_=u(U_.prototype,"gradientMin",[F_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ge}}),K_=u(U_.prototype,"gradientMax",[z_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ge}}),M_=U_))||M_);function aP(e,t,n,i){!function(e,t){Q.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,U.multiplyScalar(e,e,t+(n-t)*be())}function rP(e){var t=Z_;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}b._RF.pop(),b._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),b._RF.pop(),b._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var oP=new U(0,0,0),sP=function(){function e(){r(this,e),this.pos=new U(0,0,0),this.color=new M(255,255,255,255),this.size=new U(0,0,0),this.startSize=new U(0,0,0),this.rotation=new U(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new U(0,0),this.width=0,this.height=0}return o(e,[{key:"init",value:function(){this.pos.set(oP),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(oP),this.startColor=M.WHITE.clone(),this.velocity.set(oP),this.randomSeed=0}}]),e}(),lP=new(function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"get",value:function(){return this._get()||new sP}}]),n}(ke.Pool))((function(e){e.pos.set(oP),e.color._val=4294967295,e.size.set(oP),e.rotation.set(oP)}),1024),uP=function(){function e(t){r(this,e),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new Ce,this.sys=t,this.particles=[],this.active=!1,this.uvFilled=0}return o(e,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;lP.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=lP.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var a=i.uv,r=e?0:this.uvFilled,o=this.particles.length,s=r;s<o;s++){var l=9*s*4;n[l+3]=a[0],n[l+4]=a[1],n[l+12]=a[2],n[l+13]=a[3],n[l+21]=a[4],n[l+22]=a[5],n[l+30]=a[6],n[l+31]=a[7]}this.uvFilled=o}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var a=n.vData,r=t.x,o=t.y,s=t.z,l=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,h=e.rotation.y||0,d=e.rotation.z||0;if(0===c&&0===h&&0===d)a[i]=r-l,a[i+1]=o-u,a[i+2]=s,a[i+9]=r+l,a[i+10]=o-u,a[i+11]=s,a[i+18]=r-l,a[i+19]=o+u,a[i+20]=s,a[i+27]=r+l,a[i+28]=o+u,a[i+29]=s;else{var p=-Te.degreesToRadians(c),f=-Te.degreesToRadians(h),y=-Te.degreesToRadians(d),v=Math.cos(p),g=Math.sin(p),m=Math.cos(f),b=Math.sin(f),S=Math.cos(y),w=Math.sin(y);function k(e,t,n){var i=t*v-n*g,a=t*g+n*v,r=e*m+a*b;return new U(r*S-i*w,r*w+i*S,a*m-e*b)}var T=[k(-l,-u,0),k(l,-u,0),k(-l,u,0),k(l,u,0)];a[i]=T[0].x+r,a[i+1]=T[0].y+o,a[i+2]=T[0].z+s,a[i+9]=T[1].x+r,a[i+10]=T[1].y+o,a[i+11]=T[1].z+s,a[i+18]=T[2].x+r,a[i+19]=T[2].y+o,a[i+20]=T[2].z+s,a[i+27]=T[3].x+r,a[i+28]=T[3].y+o,a[i+29]=T[3].z+s}M.toArray(a,e.color,i+5),M.toArray(a,e.color,i+14),M.toArray(a,e.color,i+23),M.toArray(a,e.color,i+32)}},{key:"step",value:function(e){var t=this.sys.node,n=this.particles;t.updateWorldTransform(),this.active&&this.sys.emitting(e);var i=this.renderData,a=n.length;i.reset(),this.requestData(4*a,6*a),a>this.uvFilled&&this.updateUVs();for(var r=0;r<n.length;){var o=n[r];if(o)if(o.remainingLifetime-=e,o.remainingLifetime>0){var s=9*r*4;this.updateParticleBuffer(o,o.pos,i,s),++r}else{var l=n[r];r!==n.length-1&&(n[r]=n[n.length-1]),lP.put(l),n.length--,i.resize(i.vertexCount-4,i.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,i.setRenderDrawInfoAttributes()}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,r=n;r<i;r++){var o=4*r;a[n++]=o,a[n++]=o+1,a[n++]=o+2,a[n++]=o+1,a[n++]=o+3,a[n++]=o+2}}},{key:"initDrawInfo",value:function(){this.renderData.setRenderDrawInfoAttributes()}}]),e}();b._RF.pop(),b._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var cP,hP,dP,pP,fP,yP,vP,gP=23541,mP=39825,bP=91041,SP=125292,wP=197866,kP=156497;b._RF.pop(),b._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var TP,CP,EP,LP,IP,xP,RP,AP,_P,PP=w.ccclass,BP=w.property,NP=bP,OP=(cP=PP("ColorOvertimeModule"),hP=BP({type:B}),dP=BP({type:iP}),cP((yP=u((fP=function(){function e(){r(this,e),c(this,"enable",yP,this),c(this,"color",vP,this)}return o(e,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=eP;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?Ee(e.randomSeed+NP):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),e}()).prototype,"enable",[hP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vP=u(fP.prototype,"color",[dP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new iP}}),pP=fP))||pP);b._RF.pop(),b._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var DP,FP,zP,MP,UP,GP,HP,VP,WP,qP,jP,KP,YP,JP=w.ccclass,ZP=w.property,QP=gP,XP=(TP=JP("LimitVelocityOvertimeModule"),CP=ZP({type:B}),EP=ZP({type:Q_}),LP=ZP({type:Q_}),TP((RP=u((xP=function(){function e(){r(this,e),c(this,"enable",RP,this),c(this,"limit",AP,this),c(this,"dampen",_P,this),this.limit.constant=500,this.dampen.constant=.2}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),a=rP(this.limit)?Ee(e.randomSeed+QP):0,r=rP(this.dampen)?Ee(e.randomSeed+QP+1):0,o=e.velocity.length(),s=this.limit.evaluate(n,a),l=this.dampen.evaluate(n,r);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(o,s,l,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var a=1-Math.exp(-n*i);return ee.lerp(e,t,a)}}]),e}()).prototype,"enable",[CP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AP=u(xP.prototype,"limit",[EP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),_P=u(xP.prototype,"dampen",[LP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),IP=xP))||IP);b._RF.pop(),b._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var $P,eB,tB,nB,iB,aB,rB,oB,sB,lB,uB,cB,hB,dB,pB,fB,yB,vB,gB,mB,bB,SB,wB,kB=w.ccclass,TB=w.property,CB=SP,EB=(DP=kB("RotationOvertimeModule"),FP=TB({type:B}),zP=TB(B),MP=TB({type:Q_,visible:function(){return this.separateAxes}}),UP=TB({type:Q_,visible:function(){return this.separateAxes}}),GP=TB({type:Q_}),DP((WP=u((VP=function(){function e(){r(this,e),c(this,"enable",WP,this),c(this,"separateAxes",qP,this),c(this,"x",jP,this),c(this,"y",KP,this),c(this,"z",YP,this)}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+CB,a=rP(this.z)?Ee(i):0,r=this.z.evaluate(n,a)*t,o=0,s=0;if(this.separateAxes){var l=rP(this.x)?Ee(i):0,u=rP(this.y)?Ee(i):0;o=this.x.evaluate(n,l)*t,s=this.y.evaluate(n,u)*t}e.rotation.add3f(o,s,r)}}}]),e}()).prototype,"enable",[FP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qP=u(VP.prototype,"separateAxes",[zP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jP=u(VP.prototype,"x",[MP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),KP=u(VP.prototype,"y",[UP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),YP=u(VP.prototype,"z",[GP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),HP=VP))||HP);b._RF.pop(),b._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var LB,IB,xB,RB,AB,_B,PB,BB,NB,OB,DB,FB,zB,MB=w.ccclass,UB=w.property,GB=J({Circle:0,Rectangle:1}),HB=J({Base:0,Edge:1}),VB=function(){return this.shape===GB.Circle},WB=function(){return this.shape===GB.Rectangle},qB=[0,0],jB=($P=MB("ShapeModule"),eB=UB({type:J(GB)}),tB=UB({type:J(HB),visible:WB}),nB=UB({}),iB=UB({}),aB=UB({}),rB=UB({range:[0,360],visible:VB}),oB=UB({range:[-360,360],visible:VB}),sB=UB({min:0,visible:VB}),lB=UB({range:[0,1],step:.01,visible:VB}),uB=UB({visible:WB}),$P((dB=u((hB=function(){function e(){r(this,e),c(this,"shape",dB,this),c(this,"emitFrom",pB,this),c(this,"position",fB,this),c(this,"rotation",yB,this),c(this,"scale",vB,this),c(this,"arc",gB,this),c(this,"angle",mB,this),c(this,"radius",bB,this),c(this,"radiusThickness",SB,this),c(this,"rectangleThickness",wB,this)}return o(e,[{key:"emit",value:function(e){switch(this.shape){case GB.Circle:this.circleEmit(this.radius,this.radiusThickness,Le(this.generateArcAngle()),e);break;case GB.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var a=i.pos;aP(a,e*(1-t),e,n+Le(this.angle)),i.velocity=a.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,a,r,o=n.pos;switch(e){case HB.Base:a=o,r=t,Q.set(a,Se(-r.x,r.x),Se(-r.y,r.y));break;case HB.Edge:qB[0]=Se(-1,1),qB[1]=(0===(i=Se(-1,1))&&i++,me.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+we(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(qB),this.applyRectThickness(qB,t),Q.set(o,qB[0],qB[1])}n.velocity=o.clone().normalize()}},{key:"generateArcAngle",value:function(){return Se(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case GB.Circle:this.gizmoCircle(e);break;case GB.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(Le(this.angle)),a=this.radius*Math.sin(Le(this.angle)),r=this.radius*Math.cos(Le(this.arc+this.angle)),o=this.radius*Math.sin(Le(this.arc+this.angle));e.moveTo(i,a),e.lineTo(0,0),e.moveTo(r,o),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var a=(i-n)/48,r=0;r<=48;r++){var o=n+r*a,s=t*Math.cos(Le(o)),l=t*Math.sin(Le(o));0===r?e.moveTo(s,l):e.lineTo(s,l)}}}]),e}()).prototype,"shape",[eB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return GB.Circle}}),pB=u(hB.prototype,"emitFrom",[tB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return HB.Base}}),fB=u(hB.prototype,"position",[nB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0)}}),yB=u(hB.prototype,"rotation",[iB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0)}}),vB=u(hB.prototype,"scale",[aB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(1,1,1)}}),gB=u(hB.prototype,"arc",[rB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),mB=u(hB.prototype,"angle",[oB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),bB=u(hB.prototype,"radius",[sB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),SB=u(hB.prototype,"radiusThickness",[lB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),wB=u(hB.prototype,"rectangleThickness",[uB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(20,50)}}),cB=hB))||cB);b._RF.pop(),b._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var KB,YB,JB,ZB,QB,XB,$B,eN,tN,nN=w.ccclass,iN=w.property,aN=mP,rN=(LB=nN("SizeOvertimeModule"),IB=iN({type:B}),xB=iN(B),RB=iN({type:Q_,visible:function(){return!this.separateAxes}}),AB=iN({type:Q_,visible:function(){return this.separateAxes}}),_B=iN({type:Q_,visible:function(){return this.separateAxes}}),LB((NB=u((BB=function(){function e(){r(this,e),c(this,"enable",NB,this),c(this,"separateAxes",OB,this),c(this,"size",DB,this),c(this,"x",FB,this),c(this,"y",zB,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return o(e,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+aN;if(this.separateAxes){var i=rP(this.x)?Ee(n):0,a=rP(this.y)?Ee(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,a)}else{var r=rP(this.size)?Ee(n):0,o=this.size.evaluate(t,r);U.multiplyScalar(e.size,e.startSize,o)}}}}]),e}()).prototype,"enable",[IB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OB=u(BB.prototype,"separateAxes",[xB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),DB=u(BB.prototype,"size",[RB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),FB=u(BB.prototype,"x",[AB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),zB=u(BB.prototype,"y",[_B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),PB=BB))||PB);b._RF.pop(),b._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var oN,sN,lN,uN,cN,hN,dN,pN,fN,yN,vN,gN,mN,bN,SN,wN,kN,TN,CN,EN,LN,IN,xN,RN,AN,_N,PN,BN,NN,ON,DN,FN,zN,MN,UN,GN,HN,VN,WN,qN,jN,KN,YN,JN,ZN,QN,XN,$N,eO,tO,nO,iO,aO,rO,oO,sO,lO,uO,cO,hO,dO,pO=w.ccclass,fO=w.property,yO=(KB=pO("VelocityOvertimeModule"),YB=fO({type:B}),JB=fO({type:Q_}),ZB=fO({type:Q_}),KB(($B=u((XB=function(){function e(){r(this,e),c(this,"enable",$B,this),c(this,"x",eN,this),c(this,"y",tN,this),this._temp_v3=new U,this.x.constant=0,this.y.constant=0}return o(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=rP(this.x)?Ee(e.randomSeed+wP):0,a=rP(this.y)?Ee(e.randomSeed+kP):0,r=U.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,a),0);e.velocity.add(r.multiplyScalar(t))}}}]),e}()).prototype,"enable",[YB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eN=u(XB.prototype,"x",[JB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),tN=u(XB.prototype,"y",[ZB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),QB=XB))||QB);b._RF.pop(),b._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var vO,gO,mO,bO,SO,wO,kO,TO=w.ccclass,CO=w.property,EO=w.executeInEditMode,LO=w.disallowMultiple,IO=w.playOnFocus,xO=Ie.Attr.setClassAttr,RO=J({World:0,Local:1}),AO=(oN=TO("ParticleSystem"),sN=EO(!0),lN=LO(!0),uN=IO(!0),cN=CO({}),hN=CO({formerlySerializedAs:"preview"}),dN=CO(B),pN=CO({type:J(RO)}),fN=CO({formerlySerializedAs:"simulationSpace"}),yN=CO(Z),vN=CO(B),gN=CO({type:Q_}),mN=CO({type:Q_}),bN=CO(iP),SN=CO(B),wN=CO({type:Q_,formerlySerializedAs:"startSize"}),kN=CO({type:Q_,visible:function(){return this.startSize2D}}),TN=CO({type:Q_}),CN=CO(B),EN=CO({type:Q_,visible:function(){return this.startRotation3D}}),LN=CO({type:Q_,visible:function(){return this.startRotation3D}}),IN=CO({type:Q_,formerlySerializedAs:"startRotation"}),xN=CO({type:Q_}),RN=CO({type:Q_}),AN=CO({type:jB}),_N=CO({type:yO}),PN=CO({type:rN}),BN=CO({type:EB}),NN=CO({type:OP}),ON=CO({type:XP}),DN=CO(A_),FN=CO({serializable:!0}),zN=CO({type:le}),oN(MN=sN(MN=lN(MN=uN((u((UN=function(e){i(n,e);var t=a(n);function n(){var e;return r(this,n),e=t.call(this),c(e,"_preview",GN,h(e)),c(e,"playOnAwake",HN,h(e)),c(e,"_simulationSpace",VN,h(e)),c(e,"duration",WN,h(e)),c(e,"loop",qN,h(e)),c(e,"startDelay",jN,h(e)),c(e,"startLifetime",KN,h(e)),c(e,"startColor",YN,h(e)),c(e,"startSize2D",JN,h(e)),c(e,"startSizeX",ZN,h(e)),c(e,"startSizeY",QN,h(e)),c(e,"startSpeed",XN,h(e)),c(e,"startRotation3D",$N,h(e)),c(e,"startRotationX",eO,h(e)),c(e,"startRotationY",tO,h(e)),c(e,"startRotationZ",nO,h(e)),c(e,"gravityModifier",iO,h(e)),c(e,"rateOverTime",aO,h(e)),c(e,"shapeModule",rO,h(e)),c(e,"velocityOvertimeModule",oO,h(e)),c(e,"sizeOvertimeModule",sO,h(e)),c(e,"rotationOvertimeModule",lO,h(e)),c(e,"colorOvertimeModule",uO,h(e)),c(e,"limitVelocityOvertimeModule",cO,h(e)),c(e,"bursts",hO,h(e)),c(e,"_spriteFrame",dO,h(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return o(n,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){y(f(n.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){y(f(n.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new uP(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){y(f(n.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new U(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e,t=ae.Assembler.getAssembler(this);if(this._assembler!==t&&(this._assembler=t),null!==(e=this._assembler)&&void 0!==e&&e.createData){var n=this._simulator,i=n.renderData;i||(i=n.renderData=this._assembler.createData(this),n.uvFilled=0,i.particleInitRenderDrawInfo(this.renderEntity),n.initDrawInfo())}}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===RO.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return y(f(n.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===RO.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===RO.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){var e;"function"==typeof(null===(e=this._renderEntity)||void 0===e?void 0:e.setRenderTransform)&&(this.simulationSpace===RO.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===RO.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1)))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var a,r=l(this.bursts);try{for(r.s();!(a=r.n()).done;){a.value.update(this,e)}}catch(e){r.e(e)}finally{r.f()}}var o=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,o),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var a=this._simulator.emitParticle();if(a.init(),this.shapeModule.emit(a),this.simulationSpace===RO.World){var r=this.node.worldMatrix;a.pos.x+=r.m12,a.pos.y+=r.m13}var o=this.startSpeed.evaluate(n,this.rand());a.velocity.multiplyScalar(o),a.width=this.spriteFrame.width,a.height=this.spriteFrame.height;var s=this.startSizeX.evaluate(n,this.rand()),l=this.startSize2D?new U(s,this.startSizeY.evaluate(n,this.rand()),1):new U(s,s,1);a.startSize=l.clone(),a.size=l.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new U(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new U(0,0,u);a.rotation=c,a.startColor=this.startColor.evaluate(n,this.rand()).clone(),a.color=a.startColor.clone(),a.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,a.remainingLifetime=a.startLifetime,a.randomSeed=we(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new U(0,-9.8*t,0))}},{key:"rand",value:function(){return Ee(we(0,me.INT_MAX))}}]),n}(xe)).prototype,"preview",[cN],Object.getOwnPropertyDescriptor(UN.prototype,"preview"),UN.prototype),GN=u(UN.prototype,"_preview",[hN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),HN=u(UN.prototype,"playOnAwake",[dN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),u(UN.prototype,"simulationSpace",[pN],Object.getOwnPropertyDescriptor(UN.prototype,"simulationSpace"),UN.prototype),VN=u(UN.prototype,"_simulationSpace",[fN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return RO.Local}}),WN=u(UN.prototype,"duration",[yN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),qN=u(UN.prototype,"loop",[vN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jN=u(UN.prototype,"startDelay",[gN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),KN=u(UN.prototype,"startLifetime",[mN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),YN=u(UN.prototype,"startColor",[bN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new iP}}),JN=u(UN.prototype,"startSize2D",[SN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ZN=u(UN.prototype,"startSizeX",[wN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),QN=u(UN.prototype,"startSizeY",[kN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),XN=u(UN.prototype,"startSpeed",[TN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),$N=u(UN.prototype,"startRotation3D",[CN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),eO=u(UN.prototype,"startRotationX",[EN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),tO=u(UN.prototype,"startRotationY",[LN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),nO=u(UN.prototype,"startRotationZ",[IN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),iO=u(UN.prototype,"gravityModifier",[xN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),aO=u(UN.prototype,"rateOverTime",[RN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q_}}),rO=u(UN.prototype,"shapeModule",[AN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new jB}}),oO=u(UN.prototype,"velocityOvertimeModule",[_N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yO}}),sO=u(UN.prototype,"sizeOvertimeModule",[PN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new rN}}),lO=u(UN.prototype,"rotationOvertimeModule",[BN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new EB}}),uO=u(UN.prototype,"colorOvertimeModule",[NN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new OP}}),cO=u(UN.prototype,"limitVelocityOvertimeModule",[ON],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new XP}}),hO=u(UN.prototype,"bursts",[CO,DN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),dO=u(UN.prototype,"_spriteFrame",[FN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u(UN.prototype,"spriteFrame",[zN],Object.getOwnPropertyDescriptor(UN.prototype,"spriteFrame"),UN.prototype),MN=UN))||MN)||MN)||MN)||MN);xO(AO,"color","visible",!1),b._RF.pop(),b._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var _O,PO=w.ccclass,BO=w.property;vO=PO("RendererModule"),gO=BO(Re),mO=BO(le),vO((wO=u((SO=o((function e(){r(this,e),c(this,"material",wO,this),c(this,"spriteFrame",kO,this)}))).prototype,"material",[gO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kO=u(SO.prototype,"spriteFrame",[mO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bO=SO));b._RF.pop(),b._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);(0,w.ccclass)("ExampleParticleSystem2DExtra")(_O=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"initParticle",value:function(e){e.maxSize=ee.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=ee.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+ee.randomRange(-350,350),e.y=n+ee.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),n}(QA));b._RF.pop(),b._RF.push({},"9c8fbsqmiJP+4ZOp4zST378","DailyRewardsUtils",void 0);var NO,OO=codex.player,DO=[{id:1,type:"shuffle",value:1},{id:2,type:"hint",value:1},{id:3,type:"both",value:1}],FO=Ludex.Configs.DailyRewards.MockTime,zO=function(){function e(){r(this,e)}var i,a;return o(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"setDirty",value:function(){this.lastClaim=0}},{key:"logLoginReward",value:function(){this.lastClaim=Date.now(),OO.setGameData({lastClaimDailyReward:this.lastClaim})}},{key:"tryUpdateData",value:(a=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.lastClaim=OO.getGameData().lastClaimDailyReward||0;case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getDailyReward",value:function(){return this.getCanClaimReward()?DO[Math.floor(Math.random()*DO.length)]:null}},{key:"getCanClaimReward",value:function(){return FO?Date.now()-this.lastClaim>=FO:!yt(this.lastClaim)}},{key:"openPopupScreenAndWaitForClosed",value:(i=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gt.openScreenAndWaitForClosed(We.DAILY_REWARD_SCREEN,{});case 2:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})}]),e}();zO.lastClaim=0,b._RF.pop(),b._RF.push({},"eeaab2Odg9N8YeoToeSN096","PaymentUtils",void 0);var MO,UO=w.ccclass,GO={ID:"remove_ad_30"},HO={ID:"item_combo_10",SHUFFLE_ITEM_COUNT:10,HINT_ITEM_COUNT:10},VO={ID:"item_combo_50",SHUFFLE_ITEM_COUNT:50,HINT_ITEM_COUNT:50},WO={ID:"free_item",SHUFFLE_ITEM_COUNT:1,HINT_ITEM_COUNT:1},qO=UO("PaymentUtils")(NO=function(e){i(p,e);var s,u,c,h,d=a(p);function p(){return r(this,p),d.apply(this,arguments)}return o(p,null,[{key:"inst",get:function(){return this._instance||(this._instance=new p),this._instance}},{key:"initPayment",value:function(){var e,t=this;null===(e=GameSDK.payments)||void 0===e||e.onReady((function(){console.log("GameSDK.payments.onReady"),t.fetchUnconsumedPurchasesAsync()}))}},{key:"getCatalogAsync",value:(h=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.payments.getCatalogAsync();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),console.error("getCatalogAsync",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"purchaseAsync",value:(c=t(n().mark((function e(t,i){var a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={productID:t},i&&(a.developerPayload=i),e.next=4,GameSDK.payments.purchaseAsync(a);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},{key:"fetchUnconsumedPurchasesAsync",value:(u=t(n().mark((function e(){var t,i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.payments.getPurchasesAsync();case 3:if(t=e.sent,console.log("Unconsumed purchases:",t),!(t.length>0)){e.next=23;break}i=l(t),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=15;break}return r=a.value,e.next=13,this.consumePurchaseAsync(r.productID,r.purchaseToken);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error("fetchUnconsumedPurchasesAsync",e.t1);case 28:case"end":return e.stop()}}),e,this,[[0,25],[7,17,20,23]])}))),function(){return u.apply(this,arguments)})},{key:"consumePurchaseAsync",value:(s=t(n().mark((function e(t,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.payments.consumePurchaseAsync(i);case 2:this.consumePurchaseRewards(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"consumePurchaseRewards",value:function(e){if(console.log("Consume rewards for product: ".concat(e)),e===GO.ID){
//! Set remove ad data to player
var t=Date.now()+2592e6;codex.player.setGameData({removeAdEndTime:t}),Ye.checkRemoveAdEndTime()}else e===HO.ID?(Zm.addItem(et[tt.SHUFFLE],HO.SHUFFLE_ITEM_COUNT),Zm.addItem(et[tt.HINT],HO.HINT_ITEM_COUNT)):e===VO.ID&&(Zm.addItem(et[tt.SHUFFLE],VO.SHUFFLE_ITEM_COUNT),Zm.addItem(et[tt.HINT],VO.HINT_ITEM_COUNT))}}]),p}(E))||NO;b._RF.pop(),b._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var jO,KO,YO,JO,ZO,QO,XO,$O=w.ccclass,eD=w.disallowMultiple,tD=Ludex,nD=tD.Events,iD=tD.Configs.Core.StartSDKAfterLoadGame,aD=codex,rD=aD.ads,oD=aD.player,sD=aD.event;aD.context,$O("BootScene")(MO=eD(MO=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=u.call.apply(u,[this].concat(a))).setupLoadingFullScreen=function(){iD?(gt.addShowedScene(bt.BOOT_SCENE),oD.isFirstSession()?gt.addShowedScene(bt.GAME_SCENE):gt.addShowedScene(bt.DASHBOARD_SCENE)):gt.showLoadingFullScreen(bt.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.setupGameData(),e.sendMsGamesDailyNotification()},e.loadWasmModules=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.lazyLoadWasmModules=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.handlePauseAudio=function(){sD.on(nD.VISIBILITY_HIDDEN,e.handleMuteAudio),sD.on(nD.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){Ge.muteAudio(!0)},e.handleUnMuteAudio=function(){rD.isAdFullSizeShowing()||(Ge.muteAudio(!1),Ge.fixAudioForIOSOnFocus())},e}return o(c,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.initGameUtils(),this.preloadAssets(),this.listenEvents()}},{key:"initGameUtils",value:function(){Ye.checkRemoveAdEndTime(),De.initTheme(),jf.initData(),Fb.initData(),ht.initAsync(),qO.initPayment(),eb.initData(),zO.tryUpdateData()}},{key:"preloadAssets",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A.pause(),(t=[]).push(this.loadLevel()),oD.isFirstSession()||t.push(Fe.loadCurrentBackground()),t.push(De.loadCurrentTheme()),e.next=7,Promise.all(t);case 7:A.resume();case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadLevel",value:(s=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=(null===(t=codex.player.getGameData())||void 0===t?void 0:t.level)||1,at.setLevel(i),at.setMaxLevel(i),e.next=6,at.preloadLevelDataAsync(i);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error loading level",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(){return s.apply(this,arguments)})},{key:"onLoad",value:function(){this.handlePauseAudio(),this.overrideGameSDK(),this.setupLoadingFullScreen()}},{key:"start",value:function(){if(this.processCrazyGamesLoadingStop(),Ludex.Utils.Valid.isDebugger()){var e=window;e.LevelManager=at,e.MatchUtils=rt,e.ScreenUtils=gt,e.DailyQuestManager=Ym,e.AdsUtils=Ye,e.ThemeUtils=De,e.TournamentUtils=jf,e.AudioUtils=Ge,e.LayoutUtils=Fe,e.DailyChallengeUtils=Fb,e.JourneyUtils=ht,e.DailyRewardsUtils=zO,e.AdsUtils=Ye,e.ResourceUtils=Ne,e.LimitAdsUtils=eb}}},{key:"listenEvents",value:function(){sD.catchUp(nD.GAME_READY,this.lazyLoadWasmModules),sD.catchUp(nD.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"overrideGameSDK",value:function(){if("FBInstant"in window&&"shareAsync"in FBInstant){var e=FBInstant.shareAsync;FBInstant.shareAsync=function(){var i=t(n().mark((function t(i){var a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.warn("shareAsync before",i),a=m({},i),console.warn("shareAsync after",a),t.abrupt("return",e(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return i.apply(this,arguments)}}()}}},{key:"setupGameData",value:function(){var e=oD.getGameData();if(e){var t=Et.MaxLevel,n=e.totalLevel,i={totalLevel:Math.max(n,t)};oD.setGameData(i)}}},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}}]),c}(E))||MO);b._RF.pop(),b._RF.push({},"e45b1inOmBOXrNV+qwzfUYP","SceneTransition",void 0);var lD,uD,cD,hD,dD,pD,fD,yD,vD,gD,mD,bD,SD,wD,kD,TD,CD,ED,LD,ID=w.ccclass,xD=w.property,RD=(Ludex.Utils.Signal,jO=ID("SceneTransition"),KO=xD(N),YO=xD(Ae),jO((QO=u((ZO=function(e){i(p,e);var s,l,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"foreground",QO,h(e)),c(e,"blockInputEvents",XO,h(e)),e}return o(p,[{key:"onLoad",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){this.node.scene.on(ny.SWITCH_SCENE,this.handleSwitchScene,this)}},{key:"handleSwitchScene",value:(u=t(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:0,e.next=3,this.runSwitchSceneAnimation(i);case 3:t();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"runSwitchSceneAnimation",value:(l=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:0,this.blockInputEvents.enabled=!0,i=z(this.foreground).set({opacity:0}).delay(t).to(.2,{opacity:255},{easing:"smooth"}),e.next=5,Ke.runTweenAsync(i);case 5:this.blockInputEvents.enabled=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"runOpenSceneAnimation",value:(s=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:0,this.blockInputEvents.enabled=!0,i=z(this.foreground).set({opacity:255}).delay(t).to(.2,{opacity:0},{easing:"smooth"}),e.next=5,Ke.runTweenAsync(i);case 5:this.blockInputEvents.enabled=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"foreground",[KO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XO=u(ZO.prototype,"blockInputEvents",[YO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JO=ZO))||JO);b._RF.pop(),b._RF.push({},"32dab5C0R5IZbDfbsP/3nSu","JourneyButton",void 0);var AD,_D,PD,BD,ND,OD,DD,FD,zD,MD,UD,GD=w.ccclass,HD=w.property,VD=(lD=GD("JourneyButton"),uD=HD(D),cD=HD(Gr),hD=HD(x),dD=HD(q),pD=HD(Bd),fD=HD(Bd),yD=HD(P),vD=HD(P),lD((bD=u((mD=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"journeyButton",bD,h(e)),c(e,"journeyButtonColor",SD,h(e)),c(e,"journeyOverlaySprite",wD,h(e)),c(e,"journeyButtonLabel",kD,h(e)),c(e,"journeyTimerTextLocalize",TD,h(e)),c(e,"journeyUnlockLabelLocalize",CD,h(e)),c(e,"journeyUnlockNode",ED,h(e)),c(e,"journeyLockNode",LD,h(e)),e.isScheduleTimer=!1,e}return o(n,[{key:"start",value:function(){this.updateTimeText(),this.updateButtonState()}},{key:"updateButtonState",value:function(){var e=ht.getMinLevelToUnlockJourney(),t=ht.checkJourneyUnlock();this.setJourneyButtonUnlock(t),this.journeyUnlockLabelLocalize.setParams([e.toString()]),this.journeyOverlaySprite.spriteFrame=ht.getJourneyButtonSpriteFrame()}},{key:"updateTimeText",value:function(){var e=ht.getJourneyEndTime();this.journeyTimerTextLocalize.key=e.key,this.journeyTimerTextLocalize.setParams(e.params)}},{key:"setJourneyButtonUnlock",value:function(e){this.journeyButton.interactable=e,e?(this.journeyButtonColor.clickColor=new M(255,255,255,255),this.journeyButtonColor.hoverColor=new M(255,255,255,255),this.journeyButtonColor.normalColor=new M(255,255,255,255),this.journeyLockNode.active=!1,this.journeyUnlockNode.active=!0,this.journeyButtonLabel.color=new M(253,242,162,255),this.setTimerActive(!0)):(this.journeyButtonColor.clickColor=new M(200,200,200,255),this.journeyButtonColor.hoverColor=new M(200,200,200,255),this.journeyButtonColor.normalColor=new M(200,200,200,255),this.journeyLockNode.active=!0,this.journeyUnlockNode.active=!1,this.journeyButtonLabel.color=new M(108,42,19,255),this.setTimerActive(!1))}},{key:"setTimerActive",value:function(e){e&&!this.isScheduleTimer&&(this.schedule(this.updateTimeText,1),this.isScheduleTimer=!0),!e&&this.isScheduleTimer&&(this.unschedule(this.updateTimeText),this.isScheduleTimer=!1)}}]),n}(E)).prototype,"journeyButton",[uD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SD=u(mD.prototype,"journeyButtonColor",[cD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wD=u(mD.prototype,"journeyOverlaySprite",[hD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kD=u(mD.prototype,"journeyButtonLabel",[dD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TD=u(mD.prototype,"journeyTimerTextLocalize",[pD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CD=u(mD.prototype,"journeyUnlockLabelLocalize",[fD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ED=u(mD.prototype,"journeyUnlockNode",[yD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LD=u(mD.prototype,"journeyLockNode",[vD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gD=mD))||gD);b._RF.pop(),b._RF.push({},"cdbc0jBcI5IgYgPbk2e9Q7j","DashboardFooter",void 0);var WD,qD,jD,KD,YD,JD,ZD,QD=w.ccclass,XD=w.property,$D=(AD=QD("DashboardFooter"),_D=XD(D),PD=XD(D),BD=XD(VD),ND=XD(Bd),AD((FD=u((DD=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"playButton",FD,h(e)),c(e,"journeyButton",zD,h(e)),c(e,"journeyButtonComponent",MD,h(e)),c(e,"playButtonLabelLocalize",UD,h(e)),e}return o(d,[{key:"start",value:function(){this.updatePlayButton(),this.journeyButtonComponent.updateButtonState()}},{key:"updatePlayButton",value:function(){var e=at.getLevel();this.playButtonLabelLocalize.setParams(["".concat(e)])}},{key:"setButtonsInteractable",value:function(e){this.playButton.interactable=e,this.journeyButton.interactable=e}},{key:"handlePlayButtonClicked",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(null===(t=codex.match.getMatchState())||void 0===t?void 0:t.mode)===ng.CHALLENGE_FRIEND&&rt.switchToSoloContext(),rt.switchToNormal(),e.next=4,Ye.showInterstitialAdAsync();case 4:this.node.scene.emit(ny.SWITCH_SCENE,(function(){St.switchToGameScene()}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleJourneyButtonClicked",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ht.checkJourneyUnlock()){e.next=3;break}return e.abrupt("return");case 3:if(!ht.canUpdateIncreaseSeason()){e.next=6;break}return e.abrupt("return");case 6:gt.openScreen(We.JOURNEY_LEVEL_SCREEN,{preloadCallback:ht.isNeedLoadCurrentJourneyBadge()?ht.loadCurrentJourneyBadge:void 0});case 7:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"playButton",[_D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zD=u(DD.prototype,"journeyButton",[PD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MD=u(DD.prototype,"journeyButtonComponent",[BD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UD=u(DD.prototype,"playButtonLabelLocalize",[ND],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OD=DD))||OD);b._RF.pop(),b._RF.push({},"5cee57cdVlOYac2TDI7DU6B","GameLogo",void 0);var eF=w.ccclass,tF=w.property,nF=Ludex.Utils.Signal,iF=(WD=eF("GameLogo"),qD=tF(x),jD=tF(N),WD((JD=u((YD=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"sakuraSprite",JD,h(e)),c(e,"opacity",ZD,h(e)),e.signalController=new nF.SignalController,e}return o(d,[{key:"__preload",value:function(){this.opacity.opacity=0}},{key:"showUI",value:function(){this.node.active=!0,this.opacity.opacity=255,this.node.setScale(new U(1,1,1))}},{key:"runPopInAnimation",value:(l=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,i=this.signalController.renew(),a=z(this.node).set({scale:new U(1.5,1.5,1)}).delay(t).to(.75,{scale:new U(1,1,1)},{easing:function(e){return Ke.elasticOut(e,.1,.45)}}),r=z(this.opacity).set({opacity:0}).delay(t).to(.2,{opacity:255}),o=Ke.runTweenAsync(a,i),s=Ke.runTweenAsync(r,i),e.next=8,Promise.all([o,s]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"runIdleAnimation",value:function(){var e=this,t=this.signalController.renew(),n=z(this.sakuraSprite.node).set({angle:0}).by(15,{angle:540},{easing:"cubicInOut"}).by(15,{angle:-540},{easing:"cubicInOut"}).union(),i=z(this.sakuraSprite.node).set({angle:0}).repeatForever(n);t.once((function(){e.node.setRotationFromEuler(0,0,0)})),Ke.runTweenAsync(i,t)}},{key:"runHideAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,i=this.signalController.renew(),a=z(this.node).delay(t).to(.4,{scale:new U(.5,.5,1)},{easing:"backIn"}),r=z(this.opacity).delay(t+.2).to(.2,{opacity:0}),o=Ke.runTweenAsync(a,i),s=Ke.runTweenAsync(r,i),e.next=8,Promise.all([o,s]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"sakuraSprite",[qD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZD=u(YD.prototype,"opacity",[jD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KD=YD))||KD);b._RF.pop(),b._RF.push({},"f641eB0fUxMaYiL+EvVDXM4","SDKFeatureUtils",void 0);var aF,rF,oF,sF,lF,uF,cF,hF=function(){function e(){r(this,e)}return o(e,null,[{key:"isTournamentFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isPlayWithFriendFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isLeaderboardFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isIAPFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}},{key:"isFBPageFeatureAvailable",value:function(){return["FacebookInstant"].includes(GameSDK.getSDKName())}}]),e}();b._RF.pop(),b._RF.push({},"801eer4yZtLgK1HWGAh3eEa","Main",void 0);var dF,pF,fF,yF,vF,gF,mF,bF,SF,wF=w.ccclass,kF=w.property,TF=codex,CF=TF.player,EF=TF.match,LF=(aF=wF("Main"),rF=kF(P),oF=kF(P),aF((uF=u((lF=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=l.call.apply(l,[this].concat(n))).basePosition={x:0,y:0},c(e,"tournamentButton",uF,h(e)),c(e,"playWithFriendButton",cF,h(e)),e}return o(u,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.basePosition={x:this.node.position.x,y:this.node.position.y},this.updateSocialFeatures()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"start",value:function(){}},{key:"handleChallengeFriendButtonClicked",value:(s=t(n().mark((function e(){var t,i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(),e.prev=1,rt.switchToNormal(),e.next=5,EF.context.choose.processAsync({playerId:CF.getPlayerId(),fallbackSingleMode:!1,extraData:{level:at.getLevel()}});case 5:t=codex.match.getMatchState(),console.log("Match State:",t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),"USER_INPUT"===e.t0.code?rt.switchToSoloContext():console.warn("Error while finding opponent:",e.t0);case 12:return e.prev=12,i=Ludex.Utils.Valid.isDebugger(),a=codex.match.getMatchState(),r=CF.getPlayerId(),i&&!a.profiles[r]&&(console.log("[MatchUtils] Player ".concat(r," is not in match, creating a new profile.")),a.profiles[r]={id:r,name:"Guest",photo:"",score:123,bestScore:0,finished:!1},a.customData.opponentId="mock-opponent-id",a.profiles["mock-opponent-id"]={id:"mock-opponent-id",name:"Guest",photo:"https://fastly.picsum.photos/id/237/200/300.jpg?hmac=TmmQSbShHz9CdQm0NkEjx1Dyh_Y984R9LpNrpvH2D_U",score:0,bestScore:0,finished:!1}),e.next=19,St.switchToGameScene();case 19:return gt.closeLoadingScreen(),e.finish(12);case 21:case"end":return e.stop()}}),e,null,[[1,9,12,21]])}))),function(){return s.apply(this,arguments)})},{key:"handleClickedDailyQuest",value:function(){gt.openScreen(We.DAILY_QUEST_SCREEN,{})}},{key:"handleTournamentButtonClicked",value:function(){jf.isTournamentHappening()&&jf.isInContextGlobalTournament()?gt.openScreen(We.TOURNAMENT_LEADERBOARD_SCREEN):gt.openScreen(We.TOURNAMENT_POPUP_SCREEN)}},{key:"updateTournamentButtonState",value:function(){hF.isTournamentFeatureAvailable()&&(jf.isHasValidTournament()?this.tournamentButton.active=!0:this.tournamentButton.active=!1)}},{key:"handleClickedShopButton",value:function(){gt.openScreen(We.SHOP_SCREEN,{source:bt.DASHBOARD_SCENE})}},{key:"handleClickedDailyChallengeButton",value:function(){gt.openScreen(We.DAILY_CHALLENGE_SCREEN,{source:bt.DASHBOARD_SCENE,preloadCallback:Fb.isNeedLoadDailyChallenge()?Fb.loadingTextureBeforeOpenDailyChallenge:void 0})}},{key:"updateSocialFeatures",value:function(){this.playWithFriendButton.active=hF.isPlayWithFriendFeatureAvailable(),this.tournamentButton.active=hF.isTournamentFeatureAvailable()}}]),u}(E)).prototype,"tournamentButton",[rF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cF=u(lF.prototype,"playWithFriendButton",[oF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sF=lF))||sF);b._RF.pop(),b._RF.push({},"8d8f6XFx19DWIYvM/BW8pRI","DashboardUi",void 0);var IF,xF,RF,AF,_F,PF,BF,NF,OF,DF,FF,zF,MF,UF,GF,HF=w.ccclass,VF=w.property,WF=(dF=HF("DashboardUi"),pF=VF(iF),fF=VF(LF),yF=VF($D),dF((mF=u((gF=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"gameLogo",mF,h(e)),c(e,"main",bF,h(e)),c(e,"footer",SF,h(e)),e}return o(d,[{key:"showUI",value:function(){this.gameLogo.showUI(),this.gameLogo.runIdleAnimation()}},{key:"runShowAnimation",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameLogo.runPopInAnimation();case 2:this.gameLogo.runIdleAnimation();case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"runHideAnimation",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameLogo.runHideAnimation();case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"updateTournamentButtonState",value:function(){this.main.updateTournamentButtonState()}},{key:"updateJourneyButtonState",value:function(){this.footer.journeyButtonComponent.updateButtonState()}},{key:"setButtonsInteractable",value:function(e){this.footer.setButtonsInteractable(e)}}]),d}(E)).prototype,"gameLogo",[pF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bF=u(gF.prototype,"main",[fF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SF=u(gF.prototype,"footer",[yF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vF=gF))||vF);b._RF.pop(),b._RF.push({},"c204dxNBw1BVL4oP1qs5X7Q","OpenableChest",void 0);var qF,jF,KF,YF,JF,ZF=w.ccclass,QF=w.property,XF=(IF=ZF("OpenableChest"),xF=QF(P),RF=QF(x),AF=QF(x),_F=QF(x),PF=QF(le),BF=QF(le),IF((DF=u((OF=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"chestNode",DF,h(e)),c(e,"chestTop",FF,h(e)),c(e,"chestBottom",zF,h(e)),c(e,"glow",MF,h(e)),c(e,"chestTopSpriteFrames",UF,h(e)),c(e,"chestBottomSpriteFrames",GF,h(e)),e}return o(u,[{key:"onLoad",value:function(){this.chestNodeBasePosition={x:this.chestNode.position.x,y:this.chestNode.position.y},this.chestTopBasePosition={x:this.chestTop.node.position.x,y:this.chestTop.node.position.y},this.chestBottomBasePosition={x:this.chestBottom.node.position.x,y:this.chestBottom.node.position.y},this.glowOpacity=this.glow.getComponent(N),this.chestTopOpacity=this.chestTop.getComponent(N),this.chestBottomOpacity=this.chestBottom.getComponent(N),this.reset()}},{key:"onEnable",value:function(){}},{key:"runChestAnimation",value:(s=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateChestSprite(t),this.reset(),e.next=4,this.runShakeAndMoveDownAnimation();case 4:return e.next=6,this.runOpenChestAnimation();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"runShakeAndMoveDownAnimation",value:function(){var e=this;return this.chestNode.setPosition(new U(this.chestNodeBasePosition.x,this.chestNodeBasePosition.y,0)),new Promise((function(t){var n=.125,i=z().by(n,{angle:15}).by(n,{angle:-30}).by(n,{angle:30}).by(n,{angle:-15}).by(n,{angle:0}),a=z().by(.25,{position:new U(0,-200,0)});z(e.chestNode).then(i).then(a).call((function(){t()})).start()}))}},{key:"runOpenChestAnimation",value:function(){var e=this;return this.chestTop.node.setPosition(new U(this.chestTopBasePosition.x,this.chestTopBasePosition.y,0)),this.chestBottom.node.setPosition(new U(this.chestBottomBasePosition.x,this.chestBottomBasePosition.y,0)),new Promise((function(t){var n=.75,i=z().by(n,{position:new U(0,-130,0)},{easing:"sineInOut"}),a=z().to(.25,{opacity:255});e.scheduleOnce((function(){z(e.glowOpacity).then(a).start(),t()}),.25);var r={value:0},o=re(0,0,0),s=re(230,600,0),l=re(500,300,0);z(r).to(.75,{value:1},{easing:"sineInOut",onUpdate:function(){var t=r.value,n=1-t,i=n*n*o.x+2*n*t*s.x+t*t*l.x,a=n*n*o.y+2*n*t*s.y+t*t*l.y;e.chestTop.node.setPosition(i,a,0)}}).start(),z(e.chestTop.node).to(.75,{angle:-135}).start(),z(e.chestBottom.node).then(i).start(),z(e.chestTopOpacity).to(.5,{opacity:255}).to(.25,{opacity:0}).start(),z(e.chestBottomOpacity).to(.5,{opacity:255}).to(.5,{opacity:0}).start()}))}},{key:"reset",value:function(){this.chestNode.setPosition(new U(this.chestNodeBasePosition.x,this.chestNodeBasePosition.y,0)),this.chestTop.node.setPosition(new U(this.chestTopBasePosition.x,this.chestTopBasePosition.y,0)),this.chestBottom.node.setPosition(new U(this.chestBottomBasePosition.x,this.chestBottomBasePosition.y,0)),this.glowOpacity.opacity=0,this.chestTopOpacity.opacity=255,this.chestBottomOpacity.opacity=255,this.chestTop.node.angle=0}},{key:"updateChestSprite",value:function(e){e<0||e>=this.chestTopSpriteFrames.length?console.warn("OpenableChest: Invalid chest index"):(this.chestTop.spriteFrame=this.chestTopSpriteFrames[e],this.chestBottom.spriteFrame=this.chestBottomSpriteFrames[e])}}]),u}(E)).prototype,"chestNode",[xF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FF=u(OF.prototype,"chestTop",[RF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zF=u(OF.prototype,"chestBottom",[AF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MF=u(OF.prototype,"glow",[_F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UF=u(OF.prototype,"chestTopSpriteFrames",[PF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),GF=u(OF.prototype,"chestBottomSpriteFrames",[BF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),NF=OF))||NF);b._RF.pop(),b._RF.push({},"868e8cNp1hFwZiarM+NSgo7","RewardItemContainer",void 0);var $F,ez,tz,nz,iz,az,rz,oz,sz,lz,uz,cz,hz,dz,pz,fz,yz,vz,gz,mz,bz,Sz,wz,kz,Tz,Cz,Ez,Lz,Iz=w.ccclass,xz=w.property,Rz=(qF=Iz("RewardItemContainer"),jF=xz(q),qF((JF=u((YF=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"counterLabel",JF,h(e)),e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.setCounter(0)}},{key:"setCounter",value:function(e){this.counterLabel.string=e.toString()}}]),n}(E)).prototype,"counterLabel",[jF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KF=YF))||KF);b._RF.pop(),b._RF.push({},"4d2b3GHRKZGxqQJRRGfsXy8","RewardScreen",void 0);var Az=w.ccclass,_z=w.disallowMultiple,Pz=w.requireComponent,Bz=w.property,Nz=Ludex.Events,Oz=codex,Dz=Oz.event,Fz=Oz.language,zz=Oz.analytics,Mz=0,Uz=1,Gz=2,Hz=3;$F=Az("RewardScreen"),ez=Pz(Pi),tz=Bz(P),nz=Bz(q),iz=Bz(Bd),az=Bz(q),rz=Bz(Bd),oz=Bz(ce),sz=Bz(ce),lz=Bz(Rz),uz=Bz(Rz),cz=Bz(D),hz=Bz(D),dz=Bz(XF),$F(pz=_z(pz=ez((yz=u((fz=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"container",yz,h(e)),c(e,"titleLabel",vz,h(e)),c(e,"titleLocalize",gz,h(e)),c(e,"descriptionLabel",mz,h(e)),c(e,"descriptionLocalize",bz,h(e)),c(e,"rewardLayout",Sz,h(e)),c(e,"footerLayout",wz,h(e)),c(e,"shuffleItem",kz,h(e)),c(e,"hintItem",Tz,h(e)),c(e,"collectButton",Cz,h(e)),c(e,"adsX2Button",Ez,h(e)),c(e,"openableChest",Lz,h(e)),e.screenData=null,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("RewardScreen: screen not found");e.validateEventPayload(t)&&e.hideItem()},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.screenData=e.screen.data,e.alignUI(),e.runRewardAnimation())},e}return o(d,[{key:"__preload",value:function(){this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Dz.on(Nz.OPENING_SCREEN,this.handleOpeningScreen),Dz.on(Nz.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Dz.off(Nz.OPENING_SCREEN,this.handleOpeningScreen),Dz.off(Nz.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"close",value:function(){this.collectButton.interactable=!1,this.adsX2Button.interactable=!1,gt.closeScreen(We.REWARD_SCREEN)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"hideItem",value:function(){this.openableChest.node.active=!1,this.shuffleItem.node.active=!1,this.hintItem.node.active=!1,this.adsX2Button.node.scale=new U(0,0,0),this.collectButton.node.scale=new U(0,0,0),this.adsX2Button.node.active=!1,this.collectButton.node.active=!1,this.adsX2Button.interactable=!1,this.collectButton.interactable=!1}},{key:"alignUI",value:function(){var e=this.screenData,t=Ye.getBannerAdsHeight();e.title||e.description||!1||(t+=50),e.watchAdsDoubleReward||!1||(t+=-62.5),this.container.setPosition(new U(0,t,0))}},{key:"runRewardAnimation",value:(l=t(n().mark((function e(){var t,i,a,r,o,s,l,u,c,h,d,p,f;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.screenData).title?Fz.hasTextKey(a.title)?(this.titleLabel.node.active=!0,this.titleLocalize.key=a.title):(this.titleLabel.node.active=!0,this.titleLocalize.key="customString",this.titleLocalize.setParams([a.title])):this.titleLabel.node.active=!1,a.description?Fz.hasTextKey(a.description)?(this.descriptionLabel.node.active=!0,this.descriptionLocalize.key=a.description,a.descriptionParams?this.descriptionLocalize.setParams(a.descriptionParams):this.descriptionLocalize.setParams([])):(this.descriptionLabel.node.active=!0,this.descriptionLocalize.key="customString",this.descriptionLocalize.setParams([a.description])):this.descriptionLabel.node.active=!1,void 0===(r=a.chestId)){e.next=10;break}return this.openableChest.node.active=!0,e.next=8,this.openableChest.runChestAnimation(r);case 8:e.next=11;break;case 10:this.openableChest.node.active=!1;case 11:return o=(null===(t=a.items.find((function(e){return e.item===tt.HINT})))||void 0===t?void 0:t.count)||0,s=(null===(i=a.items.find((function(e){return e.item===tt.SHUFFLE})))||void 0===i?void 0:i.count)||0,o>0?(this.hintItem.node.active=!0,this.hintItem.setCounter(o)):this.hintItem.node.active=!1,s>0?(this.shuffleItem.node.active=!0,this.shuffleItem.setCounter(s)):this.shuffleItem.node.active=!1,this.rewardLayout.updateLayout(!0),l=[],this.shuffleItem.node.active&&(u=this.createMoveAnimation(this.shuffleItem.node),l.push.apply(l,v(u))),this.hintItem.node.active&&(c=this.createMoveAnimation(this.hintItem.node),l.push.apply(l,v(c))),e.next=21,Promise.all(l);case 21:return h=void 0===r?.5:1,d=[],a.watchAdsDoubleReward?this.adsX2Button.node.active=!0:this.adsX2Button.node.active=!1,this.collectButton.node.active=!0,this.footerLayout.updateLayout(!0),this.adsX2Button.node.active&&(p=z(this.adsX2Button.node).set({scale:new U(0,0,0)}).to(h,{scale:new U(1,1,1)},{easing:"backOut"}),d.push(Ke.runTweenAsync(p))),f=z(this.collectButton.node).set({scale:new U(0,0,0)}).to(h,{scale:new U(1,1,1)},{easing:"backOut"}),d.push(Ke.runTweenAsync(f)),e.next=31,Promise.all(d);case 31:this.collectButton.interactable=!0,this.adsX2Button.interactable=!0;case 33:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"createMoveAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=e.position.clone();e.setPosition(new U(0,-300,0)),e.setScale(new U(0,0,0));var i=z(e).to(t,{scale:new U(1,1,1)},{easing:"backOut"}),a=z(e).to(t,{x:n.x},{easing:"sineOut"}),r=z(e).to(t,{y:n.y},{easing:"sineIn"});return[Ke.runTweenAsync(i),Ke.runTweenAsync(a),Ke.runTweenAsync(r)]}},{key:"handleCollectButton",value:function(){var e,t;this.collectReward(1),null===(e=this.screenData)||void 0===e||null===(t=e.successCallback)||void 0===t||t.call(e),this.close()}},{key:"handleAdsX2Button",value:(s=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.adsX2Button.interactable=!1,this.collectButton.interactable=!1,e.next=4,Ye.showRewardVideoAdAsync();case 4:t=e.sent,this.adsX2Button.interactable=!0,this.collectButton.interactable=!0,t&&(this.collectReward(2),null===(i=this.screenData)||void 0===i||null===(a=i.successCallback)||void 0===a||a.call(i),this.close());case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"collectReward",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(null===(e=this.screenData)||void 0===e||!e.doNotUpdatePlayerData){var a=(null===(t=this.screenData)||void 0===t||null===(t=t.items.find((function(e){return e.item===tt.HINT})))||void 0===t?void 0:t.count)||0,r=(null===(n=this.screenData)||void 0===n||null===(n=n.items.find((function(e){return e.item===tt.SHUFFLE})))||void 0===n?void 0:n.count)||0;if(a>0){var o=et[tt.HINT],s=a*i;Zm.addItem(o,s),this.node.scene.emit(ny.ITEM_COUNT_CHANGE,{item:o,count:Zm.getItemCount(o)}),this.logEarnItem(s,o)}if(r>0){var l=et[tt.SHUFFLE],u=r*i;Zm.addItem(l,u),this.node.scene.emit(ny.ITEM_COUNT_CHANGE,{item:l,count:Zm.getItemCount(l)}),this.logEarnItem(u,l)}}}},{key:"logEarnItem",value:function(e,t){zz.event(it.EARN_ITEM,{value:e,item_name:t,earn_from:this.screenData.earnFrom,level:at.getLevel()})}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),d}(E)).prototype,"container",[tz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vz=u(fz.prototype,"titleLabel",[nz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gz=u(fz.prototype,"titleLocalize",[iz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mz=u(fz.prototype,"descriptionLabel",[az],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bz=u(fz.prototype,"descriptionLocalize",[rz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sz=u(fz.prototype,"rewardLayout",[oz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wz=u(fz.prototype,"footerLayout",[sz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kz=u(fz.prototype,"shuffleItem",[lz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tz=u(fz.prototype,"hintItem",[uz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cz=u(fz.prototype,"collectButton",[cz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ez=u(fz.prototype,"adsX2Button",[hz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lz=u(fz.prototype,"openableChest",[dz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pz=fz))||pz)||pz);b._RF.pop(),b._RF.push({},"b085anIQ8pNU7FLMVpg0+Br","OfflineRewardUtils",void 0);var Vz,Wz,qz,jz,Kz,Yz,Jz,Zz,Qz={HintItem:4,ShuffleItem:4},Xz=codex,$z=(Xz.event,Xz.player),eM=function(){function e(){r(this,e),this.lastLoginTime=0,this.canClaimReward=!1,this.processOfflineRewards()}return o(e,[{key:"processOfflineRewards",value:function(){var e=this.getPlayerOfflineReward();if((this.lastLoginTime=e.lastLoginTime||Date.now(),!yt(this.lastLoginTime))&&(new Date).getTime()-this.lastLoginTime>=2592e5)return this.canClaimReward=!0,void(this.rewards={UndoItem:Qz.UndoItem,HintItem:Qz.HintItem,ShuffleItem:Qz.ShuffleItem});this.reset()}},{key:"reset",value:function(){this.lastLoginTime=Date.now(),this.rewards={UndoItem:0,HintItem:0,ShuffleItem:0},this.canClaimReward=!1,this.updateOfflineRewardPlayerData()}},{key:"getPlayerOfflineReward",value:function(){var e=$z.getGameData();return null!=e&&e.offlineReward?e.offlineReward:{lastLoginTime:Date.now()}}},{key:"updateOfflineRewardPlayerData",value:function(){var e={lastLoginTime:this.lastLoginTime};$z.setGameData({offlineReward:e})}}],[{key:"inst",get:function(){return e.instance||(e.instance=new e),e.instance}},{key:"handleClaimReward",value:function(){this.inst.processOfflineRewards(),e.inst.canClaimReward&&(this.inst.lastLoginTime=Date.now(),this.inst.rewards={UndoItem:0,HintItem:0,ShuffleItem:0},this.inst.canClaimReward=!1,this.inst.updateOfflineRewardPlayerData())}},{key:"getRewards",value:function(){return e.inst.rewards}},{key:"getCanClaimReward",value:function(){return!1}}]),e}();b._RF.pop(),b._RF.push({},"c4e30ckJiFBG4VHrF+wikMs","DashboardScene",void 0);var tM,nM,iM,aM,rM,oM,sM,lM,uM,cM,hM,dM=w.ccclass,pM=w.disallowMultiple,fM=w.property,yM=codex.event,vM=Ludex.Events,gM=[Ve[We.OPTIONS_SCREEN],Ve[We.THEME_SCREEN],Ve[We.SHOP_SCREEN],Ve[We.TOURNAMENT_POPUP_SCREEN],Ve[We.TOURNAMENT_LEADERBOARD_SCREEN],Ve[We.LANGUAGES_SCREEN],Ve[We.DAILY_QUEST_SCREEN],Ve[We.DAILY_CHALLENGE_SCREEN],Ve[We.BADGES_SCREEN],Ve[We.JOURNEY_LEVEL_SCREEN],Ve[We.REWARD_SCREEN]];Vz=dM("DashboardScene"),Wz=fM(WF),qz=fM(RD),jz=on.onlyRunInLifeCycle,Vz(Kz=pM((Jz=u((Yz=function(e){i(v,e);var s,l,u,d,p,f,y=a(v);function v(){var e;r(this,v);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=y.call.apply(y,[this].concat(n)),c(e,"dashboardUi",Jz,h(e)),c(e,"dashboardGameSceneTransition",Zz,h(e)),e.isOpeningScreens=!1,e.openingScreens={},e.needToRunAnimationDashboard=!1,e.handleOpenScreen=function(t){var n=t.screenName;e.openingScreens[n]=!0,gM.includes(n)&&(e.dashboardUi.node.active=!1)},e.handleErrorOpenScreen=function(t){var n=t.screenName;n&&(e.openingScreens[n]=!1,!gM.includes(n))||(e.dashboardUi.node.active=!0)},e.handleCloseScreen=function(t){var n=t.screenName,i=t.screenData;gM.includes(n)&&!0!==(null==i?void 0:i.openNextScreenImmediately)&&(e.dashboardUi.node.active=!0)},e.handleClosedScreen=function(t){var n=t.screenData;!0!==(null==n?void 0:n.openNextScreenImmediately)&&(delete e.openingScreens[t.screenName],e.needToRunAnimationDashboard&&0===Object.keys(e.openingScreens).length&&(e.needToRunAnimationDashboard=!1,e.runAnimationOpenDashboard()))},e}return o(v,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"onLoad",value:function(){yM.on(vM.OPEN_SCREEN,this.handleOpenScreen),yM.on(vM.CLOSE_SCREEN,this.handleCloseScreen),yM.on(vM.CLOSED_SCREEN,this.handleClosedScreen),yM.on(Oe.ERROR_OPEN_SCREEN,this.handleErrorOpenScreen),this.schedule(this.handleUpdate,1)}},{key:"onDestroy",value:function(){yM.off(vM.OPEN_SCREEN,this.handleOpenScreen),yM.off(vM.CLOSE_SCREEN,this.handleCloseScreen),yM.off(vM.CLOSED_SCREEN,this.handleClosedScreen),yM.off(Oe.ERROR_OPEN_SCREEN,this.handleErrorOpenScreen),this.unschedule(this.handleUpdate)}},{key:"start",value:function(){var e=codex.player.getPlayerSetting("music");this.dashboardUi.node.active=!0,e&&Ge.playMusic(),this.scheduleOnce(this.tryPreloadGameScene,1);var t=at.getMaxLevel();at.setLevel(t),this.updateGameEvents(),this.dashboardGameSceneTransition.runOpenSceneAnimation(),this.checkOpenSceneDataScreen()?(this.dashboardUi.showUI(),this.handleOpenSceneDataScreen(),this.needToRunAnimationDashboard=!0,"data"in this.node.scene.scene&&(this.node.scene.scene.data={screen:void 0,screenData:void 0})):this.checkOpenAnyScreen()?(this.dashboardUi.showUI(),this.runAnimationOpenDashboard()):this.dashboardUi.runShowAnimation()}},{key:"runAnimationOpenDashboard",value:(f=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOpeningScreens=!0,this.dashboardUi.setButtonsInteractable(!1),!this.checkOpenOfflineRewardScreen()){e.next=5;break}return e.next=5,this.checkAndClaimOfflineReward();case 5:if(!this.checkOpenTournamentRewardScreen()){e.next=8;break}return e.next=8,this.checkAndClaimTournamentReward();case 8:if(!this.checkOpenDailyRewardsScreen()){e.next=11;break}return e.next=11,zO.openPopupScreenAndWaitForClosed();case 11:if(!this.checkOpenJourneyScreen()){e.next=14;break}return e.next=14,this.checkAndClaimJourneyReward();case 14:this.dashboardUi.setButtonsInteractable(!0),this.isOpeningScreens=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"tryPreloadGameScene",value:function(){St.isSceneLoaded(bt.GAME_SCENE)||St.preloadGameScene()}},{key:"handleUpdate",value:(p=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isOpeningScreens){e.next=2;break}return e.abrupt("return");case 2:if(!(Object.keys(this.openingScreens).length>0)){e.next=4;break}return e.abrupt("return");case 4:if(this.updateGameEvents(),this.checkOpenAnyScreen()){e.next=7;break}return e.abrupt("return");case 7:if(this.isOpeningScreens=!0,this.dashboardUi.setButtonsInteractable(!1),!this.checkOpenTournamentRewardScreen()){e.next=12;break}return e.next=12,this.checkAndClaimTournamentReward();case 12:if(!this.checkOpenJourneyScreen()){e.next=15;break}return e.next=15,this.checkAndClaimJourneyReward();case 15:this.isOpeningScreens=!1,this.dashboardUi.setButtonsInteractable(!0);case 17:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updateGameEvents",value:function(){jf.updateData(),this.dashboardUi.updateTournamentButtonState()}},{key:"checkOpenAnyScreen",value:function(){return this.checkOpenTournamentRewardScreen()||this.checkOpenOfflineRewardScreen()||this.checkOpenDailyRewardsScreen()||this.checkOpenJourneyScreen()}},{key:"checkOpenTournamentRewardScreen",value:function(){return jf.isHasReward()}},{key:"checkOpenOfflineRewardScreen",value:function(){return eM.getCanClaimReward()}},{key:"checkOpenSceneDataScreen",value:function(){return!!St.getSceneData(this.node.scene).screen}},{key:"checkOpenDailyRewardsScreen",value:function(){return zO.getCanClaimReward()&&(gt.isScreenLoaded(Ve[We.DAILY_REWARD_SCREEN])||at.getLevelStartTimes()>=3)}},{key:"checkOpenJourneyScreen",value:function(){return ht.canUpdateIncreaseSeason()}},{key:"handleOpenSceneDataScreen",value:(d=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=St.getSceneData(this.node.scene),i=t.screen,a=t.screenData,e.abrupt("return",gt.openScreenAndWaitForClosed(i,m(m({},a),{},{source:bt.DASHBOARD_SCENE})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"checkAndClaimTournamentReward",value:(u=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=jf.getLastTournamentRankRewardQuantity(),i={items:[{item:tt.HINT,count:t},{item:tt.SHUFFLE,count:t}],watchAdsDoubleReward:!0,title:"LANTERN_CHALLENGE",description:"RANK_#V_REWARD",descriptionParams:[jf.getLastTournamentRankReward().toString()],successCallback:function(){},earnFrom:"TournamentRankReward"},jf.logTournamentRewarded(),jf.resetRewardData(),e.abrupt("return",gt.openScreenAndWaitForClosed(We.REWARD_SCREEN,i));case 5:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"checkAndClaimJourneyReward",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ht.increaseSeason(),gt.showLoadingScreen(),this.openingScreens[We.JOURNEY_LEVEL_SCREEN]&&gt.closeScreen(We.JOURNEY_LEVEL_SCREEN),(t=[]).push(ht.loadJourneyButtonSpriteFrame()),e.next=7,Promise.all(t);case 7:return this.dashboardUi.updateJourneyButtonState(),gt.closeLoadingScreen(),e.abrupt("return",Promise.resolve(void 0));case 10:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"checkAndClaimOfflineReward",value:(s=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=eM.getRewards(),i={items:[{item:tt.HINT,count:t.HintItem},{item:tt.SHUFFLE,count:t.ShuffleItem},{item:tt.UNDO,count:t.UndoItem}],watchAdsDoubleReward:!1,title:"WELCOME_BACK",chestId:Hz,successCallback:function(){eM.handleClaimReward()},earnFrom:"OfflineReward"},e.abrupt("return",gt.openScreenAndWaitForClosed(We.REWARD_SCREEN,i));case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}]),v}(E)).prototype,"dashboardUi",[Wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zz=u(Yz.prototype,"dashboardGameSceneTransition",[qz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(Yz.prototype,"tryPreloadGameScene",[jz],Object.getOwnPropertyDescriptor(Yz.prototype,"tryPreloadGameScene"),Yz.prototype),Kz=Yz))||Kz);b._RF.pop(),b._RF.push({},"ae0716AGTdOnLrs0rUWAPMP","DashboardBackground",void 0);var mM,bM,SM,wM,kM,TM,CM,EM=w.ccclass,LM=(w.property,Ludex),IM=LM.Utils.Decorator,xM=LM.Events,RM=ze.Layout,AM=ze.DesignSize,_M=codex.event,PM=(d(tM={},RM.Portrait,{width:1080,height:2520}),d(tM,RM.Landscape,{width:2732,height:1583}),tM);nM=EM("DashboardBackground"),iM=on.required(),aM=on.required(),rM=IM.debounce(100),nM(((hM=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"sprite",lM,h(e)),c(e,"uiTransform",uM,h(e)),e.handleSwitchScene=function(){_M.off(xM.SWITCH_SCENE,e.handleSwitchScene),e.removePortraitCurtain()},c(e,"handleViewResized",cM,h(e)),e}return o(u,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),on.validateRequiredProperties(this),this.listenGameEvents()}},{key:"onLoad",value:function(){this.updateBackgroundSprite(),this.updateCurtain(),_M.on(xM.SWITCH_SCENE,this.handleSwitchScene)}},{key:"onDestroy",value:function(){_M.off(xM.SWITCH_SCENE,this.handleSwitchScene),A.off(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"updateBackgroundSprite",value:function(){var e=this;Fe.getCurrentBackground().then((function(t){t&&(e.setBackgroundSprite(t),e.updateSizeBackground())}))}},{key:"updateCurtain",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Fe.isLandscape()){e.next=3;break}return this.removePortraitCurtain(),e.abrupt("return");case 3:if(u.portraitCurtain){e.next=10;break}return e.next=6,Fe.getCurrentDashboardCurtain();case 6:if(t=e.sent){e.next=9;break}return e.abrupt("return");case 9:u.portraitCurtain=$(t);case 10:if(u.portraitCurtain){e.next=12;break}return e.abrupt("return");case 12:(i=u.portraitCurtain).active=!0,i.setParent(this.node),a=_.getVisibleSize(),r=a.height,o=Fe.getCurrentLayout(),s=PM[o].height,o===RM.Portrait&&(l=r<AM.Portrait.HEIGHT?0:r<s?(r-AM.Portrait.HEIGHT)/(s-AM.Portrait.HEIGHT)*160:160,i.setPosition(0,r-l,0));case 19:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"removePortraitCurtain",value:function(){u.portraitCurtain&&(u.portraitCurtain.removeFromParent(),u.portraitCurtain.active=!1)}},{key:"start",value:function(){this.handleViewResized()}},{key:"listenGameEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleViewResized)}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateSizeBackground",value:function(){if(this.sprite){var e=_.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=Fe.getCurrentLayout(),a=PM[i],r=a.width,o=a.height,s=t/r,l=n/o;if(i===RM.Portrait)this.uiTransform.setContentSize(t,Math.max(n,o)),this.node.setPosition(0,-n/2,0);else{var u=Math.max(s,l);this.uiTransform.setContentSize(Math.max(r,r*u),Math.max(o,o*u)),this.node.setPosition(0,-n/2,0)}}}}}]),u}(E)).portraitCurtain=null,lM=u((sM=hM).prototype,"sprite",[iM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uM=u(sM.prototype,"uiTransform",[aM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cM=u(sM.prototype,"handleViewResized",[rM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite(),e.updateCurtain()}}}),oM=sM));b._RF.pop(),b._RF.push({},"48793xDEIdGIIxZIn+SZThD","DailyQuestButton",void 0);var BM,NM=w.ccclass,OM=w.property;w.requireComponent,mM=NM("DailyQuestButton"),bM=OM(q),SM=OM(Bd),mM((TM=u((kM=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"timeTextLabel",TM,h(e)),c(e,"timeTextLocalize",CM,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateButtonText()}},{key:"start",value:function(){this.schedule(this.updateButtonText,1)}},{key:"updateButtonText",value:function(){var e=new Date,t=new Date(e);t.setHours(24,0,0,0);var n=Number(t)-Number(e),i=Math.floor(n/36e5),a=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3);this.timeTextLocalize.key="timeHms",this.timeTextLocalize.setParams([i>=10?i.toString():"0".concat(i),a>=10?a.toString():"0".concat(a),r>=10?r.toString():"0".concat(r)])}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}}]),n}(E)).prototype,"timeTextLabel",[bM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CM=u(kM.prototype,"timeTextLocalize",[SM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wM=kM));b._RF.pop(),b._RF.push({},"f9a74iqHo9HRY7QwxlSDrwc","Header",void 0);var DM,FM,zM,MM,UM;(0,w.ccclass)("Header")(BM=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleClickedOptions",value:function(){gt.openScreen(We.OPTIONS_SCREEN,{})}},{key:"handleClickedTheme",value:function(){gt.openScreen(We.THEME_SCREEN,{})}}]),n}(E));b._RF.pop(),b._RF.push({},"4952cFTdBhJgoOhDZuQi++k","DailyChallengeButton",void 0);var GM,HM,VM,WM,qM,jM,KM,YM,JM,ZM=w.ccclass,QM=w.property;w.requireComponent,DM=ZM("DailyChallengeButton"),FM=QM(q),DM((UM=u((MM=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"dateText",UM,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateDateText()}},{key:"start",value:function(){}},{key:"updateDateText",value:function(){var e=(new Date).getDate();this.dateText.string=e<10?"0".concat(e):"".concat(e)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}}]),n}(E)).prototype,"dateText",[FM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zM=MM));b._RF.pop(),b._RF.push({},"4a745W59XNFEoOicFjeYvNW","TourButton",void 0);var XM,$M,eU,tU,nU,iU=w.ccclass,aU=w.property;w.requireComponent,GM=iU("TourButton"),HM=aU(q),VM=aU(q),WM=aU(Bd),GM((KM=u((jM=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"rankTextLabel",KM,h(e)),c(e,"timeTextLabel",YM,h(e)),c(e,"timeTextLocalize",JM,h(e)),e.currentRank=0,e}return o(u,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.updateButtonText()}},{key:"start",value:function(){this.schedule(this.updateButtonText,1),this.updateRankText()}},{key:"updateButtonText",value:function(){if(jf.inst.isPlayerJoined){this.rankTextLabel.node.active=!0;var e=jf.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}else this.rankTextLabel.node.active=!1,this.timeTextLocalize.key="join";this.currentRank!==jf.getTournamentRank()&&(this.updateRankText(),this.currentRank=jf.getTournamentRank())}},{key:"updateRankText",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=jf.getTournamentRank(),this.rankTextLabel.string=t>0?"#".concat(t):"#--";case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}}]),u}(E)).prototype,"rankTextLabel",[HM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YM=u(jM.prototype,"timeTextLabel",[VM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JM=u(jM.prototype,"timeTextLocalize",[WM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qM=jM));b._RF.pop(),b._RF.push({},"517fcvqZLRHQ5iZTchB0DL+","BlossomParticleSystem2DExtra",void 0);var rU,oU=w.ccclass,sU=w.property;oU("BlossomParticleSystem2DExtra")((eU=u(($M=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"maxSizeRandom",eU,h(e)),c(e,"minSizeRandom",tU,h(e)),c(e,"cycleDurationRandom",nU,h(e)),e}return o(n,[{key:"initParticle",value:function(e){e.maxSize=ee.randomRange(this.maxSizeRandom.x,this.maxSizeRandom.y)*e.size,e.minSize=ee.randomRange(this.minSizeRandom.x,this.minSizeRandom.y)*e.size,e.size=0,e.deltaSize=0,e.life=e.timeToLive,e.cycleDuration=ee.randomRange(this.cycleDurationRandom.x,this.cycleDurationRandom.y),e.cycleDuration=e.timeToLive/Math.floor(e.timeToLive/e.cycleDuration),this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+ee.randomRange(-350,350),e.y=n+ee.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=e.life-e.timeToLive,n=1-t%e.cycleDuration/e.cycleDuration;t/e.cycleDuration<=e.life/e.cycleDuration?e.size=(e.maxSize-e.minSize)*Math.sin(n*Math.PI)+e.minSize:e.size=e.maxSize*Math.sin(n*Math.PI)}}]),n}(QA)).prototype,"maxSizeRandom",[sU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(.25,1)}}),tU=u($M.prototype,"minSizeRandom",[sU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(0,.25)}}),nU=u($M.prototype,"cycleDurationRandom",[sU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(.4,.6)}}),XM=$M));b._RF.pop(),b._RF.push({},"22d76GFn6BEoKFiZCFN1HmA","DraftScene",void 0);var lU,uU=w.ccclass,cU=w.disallowMultiple;uU("DraftScene")(rU=cU(rU=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"switchScene",value:function(){}}]),n}(E))||rU);b._RF.pop(),b._RF.push({},"27217ZS55VNqbq0d9w9Cc+3","Component",void 0);var hU,dU=w.ccclass,pU=w.executeInEditMode,fU=w.disallowMultiple,yU=Ludex.Events,vU=codex.event;dU("DraftComponent")(lU=fU(lU=pU(!0)(lU=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).locale="en",e.eventPayload={screenName:"DraftScene"},e}return o(n,[{key:"__preload",value:function(){console.log("DraftComponent",yU)}},{key:"onLoad",value:function(){console.log("DraftComponent",vU)}},{key:"start",value:function(){console.log("DraftComponent",Ze),this.makePersistent()}},{key:"makePersistent",value:function(){I.addPersistRootNode(this.node)}}]),n}(E))||lU)||lU);b._RF.pop(),b._RF.push({},"6adb6Vsx2BIsYfe4A3i4ArN","custom",void 0);(0,w.ccclass)("CustomSpine")(hU=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).spine=null,e.anims=null,e.customEnd=function(t){var n;console.log("CustomSpine customEnd",t);var i=null===(n=e.spine)||void 0===n?void 0:n.skeletonData;if(i){var a=i.getRuntimeData();a&&console.log("CustomSpine runtimeData",a)}},e}return o(n,[{key:"__preload",value:function(){var e,t;this.spine=null!==(e=this.node.getComponent(_e.Skeleton))&&void 0!==e?e:null,this.anims=null!==(t=this.node.getComponent(k))&&void 0!==t?t:null,on.lazyValidateProperties(this)}},{key:"onLoad",value:function(){var e;console.log("CustomSpine onLoad",this.spine,this.anims),null===(e=this.anims)||void 0===e||e.play("custom")}},{key:"start",value:function(){}}]),n}(E));b._RF.pop(),b._RF.push({},"88f2b4WH6NBlaGD7WvCOA2j","VibrateUtils",void 0);var gU,mU,bU,SU,wU,kU,TU,CU=Ludex.Utils.Browser,EU=codex.player,LU=function(){function e(){r(this,e)}return o(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"addVibrationProfile",value:function(e,t){this.vibrationProfiles[e]=t}},{key:"vibrate",value:function(e){if(this.isVibrateEnable()){var t=this.vibrationProfiles[e];if(t||(console.warn("Vibration profile ".concat(e," not found. Using default profile.")),t=this.vibrationProfiles.default),!CU.vibrate(t)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}}},{key:"isVibrateEnable",value:function(){return!!EU.getPlayerSetting("vibrate")}}]),e}();LU.vibrationProfiles={default:[100]},b._RF.pop(),b._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var IU,xU,RU,AU,_U,PU,BU,NU=w.ccclass,OU=w.disallowMultiple,DU=w.property,FU=codex,zU=FU.audio,MU=FU.ads,UU=ze.Layout,GU=ze.DesignSize.Portrait;gU=NU("GameScene"),mU=DU(VI),bU=DU(RD),gU(SU=OU((kU=u((wU=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"gameplay",kU,h(e)),c(e,"sceneTransition",TU,h(e)),e.background=null,e.handleGameMaskWhenLayoutChanged=function(e){var t=oe("Canvas/Game/GameObjects");if(t){var n=t.getComponent(Pe);n&&(n.enabled=e===UU.Landscape)}},e.handleAdsWhenResize=function(){e.checkBottomBannerAdSize(),e.setMaxSizeSideBannerAd()},e.attemptCallSubscribeBot=function(){"subscribeBotAsync"in GameSDK.extra&&GameSDK.extra.subscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))},e}return o(n,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){A.on(Oe.VIEW_RESIZED,this.handleAdsWhenResize),A.on(Oe.LAYOUT_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(ny.THEME_BACKGROUND_CHANGE,this.updateBackground,this)}},{key:"checkBottomBannerAdSize",value:function(){var e=_.getVisibleSize(),t=qe.worldSizeToCssSize(e.height*Lt.MAX_BOTTOM_BANNER_RATIO);Ludex.Configs.Ads.BannerDisplayAdOptions.forEach((function(e){var n=e.PlacementId,i=e.Position,a=e.BannerHeight;"bottom"===i&&(a>t?MU.hideBannerAdAsync(n).catch((function(e){})):MU.showBannerAdAsync(n).catch((function(e){})))}))}},{key:"setMaxSizeSideBannerAd",value:function(){var e=GameSDK.extra;if("setSideBannerAdRemainSize"in e){var t=_.getVisibleSize(),n=GU.WIDTH+24,i=(t.width-n)/2,a=qe.worldSizeToCssSize(i);e.setSideBannerAdRemainSize(a)}}},{key:"start",value:function(){this.scheduleOnce(this.attemptCallSubscribeBot,.5),codex.player.getPlayerSetting("music")&&Ge.playMusic(),this.updateVolumeBackgroundMusic(),this.scheduleOnce(this.preloadScenes,2),this.addVibrationProfiles(),this.updateTheme(),this.sceneTransition.runOpenSceneAnimation()}},{key:"updateTheme",value:function(){this.updateBackground()}},{key:"updateBackground",value:function(){var e=this.background||this.getComponentInChildren(di);this.background=e;var t=De.getCurrentBackgroundSprite();e.setBackgroundSprite(t)}},{key:"addVibrationProfiles",value:function(){LU.addVibrationProfile(Bf,500)}},{key:"preloadScenes",value:function(){St.preloadDashboardScene(),Fe.loadCurrentBackground()}},{key:"updateVolumeBackgroundMusic",value:function(){zU.setVolume(1,"global_music")}}]),n}(E)).prototype,"gameplay",[mU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TU=u(wU.prototype,"sceneTransition",[bU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SU=wU))||SU);b._RF.pop(),b._RF.push({},"10856dEO59DzahZrXjZ7GV7","ExplosionParticleSystemExtra2D",void 0);var HU,VU,WU,qU,jU,KU,YU,JU,ZU=w.ccclass,QU=w.property;IU=ZU("ExplosionParticleSystem2DExtra"),xU=QU(C),RU=QU(C),IU((PU=u((_U=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"rectW",PU,h(e)),c(e,"rectH",BU,h(e)),e}return o(n,[{key:"initParticle",value:function(e){this.setInitPosition(e.pos,e.dir)}},{key:"setInitPosition",value:function(e,t){var n=this.rectW,i=this.rectH,a=Math.atan2(t.y,t.x),r=e.x,o=e.y;return e.x=r+Math.cos(a)*n/2,e.y=o+Math.sin(a)*i/2,e}},{key:"updateParticle",value:function(e,t){}}]),n}(QA)).prototype,"rectW",[xU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),BU=u(_U.prototype,"rectH",[RU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),AU=_U));b._RF.pop(),b._RF.push({},"7c115t9HKlH6ZfnhCnLAnpe","Star",void 0);var XU,$U,eG,tG,nG,iG,aG,rG,oG,sG,lG,uG=w.ccclass,cG=w.property,hG=w.requireComponent,dG=(HU=uG("Star"),VU=hG(k),WU=cG(E),qU=cG(k),HU(jU=VU((YU=u((KU=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"starAppearance",YU,h(e)),c(e,"animation",JU,h(e)),e.isAppear=!1,e.initialPosition=new U,e}return o(n,[{key:"onLoad",value:function(){this.initialPosition=this.node.position.clone(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"resetPosition",value:function(){this.node.setPosition(this.initialPosition)}},{key:"show",value:function(){this.starAppearance.node.active=!0,this.isAppear=!0}},{key:"hide",value:function(){this.starAppearance.node.active=!1,this.isAppear=!1}},{key:"playAnimation",value:function(){this.animation.stop();this.animation.clips.some((function(e){return!(!e||"UpAndDown"!==e.name)}))?this.animation.play("UpAndDown"):console.warn("SettingsScreen: clip not found")}},{key:"stopAnimation",value:function(){this.animation.stop()}}]),n}(E)).prototype,"starAppearance",[WU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JU=u(KU.prototype,"animation",[qU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jU=KU))||jU)||jU);b._RF.pop(),b._RF.push({},"09f0bRvi+1OQZiIGBFqdNzq","LevelProgressBar",void 0);var pG,fG=w.ccclass,yG=w.property;XU=fG("LevelProgressBar"),$U=yG(Y),eG=yG(dG),tG=yG(dG),nG=yG(dG),XU((rG=u((aG=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"progressBar",rG,h(e)),c(e,"leftStar",oG,h(e)),c(e,"midStar",sG,h(e)),c(e,"rightStar",lG,h(e)),e.toProgress=1,e.progressStep=0,e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"start",value:function(){this.toProgress=1,this.progressStep=0,this.runStartsAnimation()}},{key:"update",value:function(){var e=this.progressBar.getComponent(x);e&&(this.progressBar.progress>=1?e.type=x.Type.SIMPLE:e.type=x.Type.TILED),this.progressBar.progress-this.progressStep<this.toProgress?this.progressBar.progress!==this.toProgress&&(this.progressBar.progress=this.toProgress):this.progressBar.progress-=this.progressStep}},{key:"runStartsAnimation",value:function(){this.leftStar.isAppear&&this.midStar.isAppear&&this.rightStar.isAppear||(this.leftStar.show(),this.midStar.show(),this.rightStar.show(),this.runStarAnimation(this.leftStar),this.runStarAnimation(this.midStar),this.runStarAnimation(this.rightStar))}},{key:"runStarAnimation",value:function(e){e.resetPosition(),e.playAnimation()}},{key:"stopStarAnimation",value:function(e){e.isAppear&&(e.hide(),e.stopAnimation(),e.resetPosition(),Ge.playSound(He.LOST_STAR_IN_GAMEPLAY))}},{key:"setProgress",value:function(e){this.toProgress=e/100,this.progressStep=(this.progressBar.progress-this.toProgress)/60*16}},{key:"setStars",value:function(e){switch(e){case 1:this.stopStarAnimation(this.rightStar),this.stopStarAnimation(this.midStar);break;case 2:this.stopStarAnimation(this.rightStar);break;default:this.runStartsAnimation()}}},{key:"reset",value:function(){this.progressBar.progress=1}}]),n}(E)).prototype,"progressBar",[$U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oG=u(aG.prototype,"leftStar",[eG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sG=u(aG.prototype,"midStar",[tG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lG=u(aG.prototype,"rightStar",[nG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iG=aG));b._RF.pop(),b._RF.push({},"2b2ebUm0nFD64V/fcD8RPF/","TestLayoutScene",void 0);var vG,gG,mG,bG,SG,wG=w.ccclass,kG=w.disallowMultiple;wG("TestLayoutScene")(pG=kG(pG=function(e){i(n,e);var t=a(n);function n(){var e;return r(this,n),(e=t.call(this)).handleLayoutChange=function(){gt.showNotificationScreen("Layout changed")},St.markIsTestScene(bt.TEST_LAYOUT_SCENE),e}return o(n,[{key:"start",value:function(){this.isValid&&this.listenGameEvents()}},{key:"listenGameEvents",value:function(){A.on(Oe.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"switchScene",value:function(){St.switchScene(bt.DASHBOARD_SCENE)}}]),n}(E))||pG);b._RF.pop(),b._RF.push({},"c0a5fPghzxBxpXiudxt+Qd4","TestParticleSystemScene",void 0);var TG,CG=w.ccclass,EG=w.property;vG=CG("TestParticleSystemScene"),gG=EG(AO),vG((SG=u((bG=function(e){i(n,e);var t=a(n);function n(){var e;return r(this,n),e=t.call(this),c(e,"starParticleSystem",SG,h(e)),St.markIsTestScene(bt.TEST_PARTICLE_SYSTEM_SCENE),e}return o(n,[{key:"start",value:function(){var e=this;this.isValid&&this.scheduleOnce((function(){e.starParticleSystem.play()}),1)}}]),n}(E)).prototype,"starParticleSystem",[gG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mG=bG));b._RF.pop(),b._RF.push({},"7dc71c6qMBI/ZZfA4rG4nFv","TestPerformanceScene",void 0);var LG,IG=w.ccclass,xG=w.disallowMultiple;IG("TestPerformanceScene")(TG=xG(TG=function(e){i(n,e);var t=a(n);function n(){var e;return r(this,n),e=t.call(this),St.markIsTestScene(bt.TEST_PERFORMANCE_SCENE),e}return o(n,[{key:"start",value:function(){this.isValid&&this.listenEvents()}},{key:"listenEvents",value:function(){}}]),n}(E))||TG);b._RF.pop(),b._RF.push({},"0a4aeK2lAdAjq0xWi6SCbV+","TestScene",void 0);var RG,AG=w.ccclass,_G=w.disallowMultiple,PG=Ludex.Events,BG=codex.event;AG("TestScene")(LG=_G(LG=function(e){i(n,e);var t=a(n);function n(){var e;return r(this,n),e=t.call(this),St.markIsTestScene(bt.TEST_SCENE),e}return o(n,[{key:"start",value:function(){this.isValid&&(this.listenScreenEvents(),gt.openScreen(We.LOADING_SCREEN,{duration:.5}))}},{key:"listenScreenEvents",value:function(){BG.once(PG.CLOSED_SCREEN,(function(e){e.screenName===Ve[We.LOADING_SCREEN]&&gt.openScreen(We.NOTIFICATION_SCREEN,{message:"Test screen events pass!",duration:2,isCloseButtonVisible:!1})}))}}]),n}(E))||LG);b._RF.pop(),b._RF.push({},"b16e7w74XVALY8Zco6TJYe7","AdsFlows",void 0);var NG,OG=w.ccclass,DG=Ludex.Plugins.Ads.Types;OG("AdsFlows")(RG=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"preloadAds",value:function(){Ye.preloadAds()}},{key:"checkServiceDegraded",value:function(){var e=Ye.isServiceDegraded();gt.showNotificationScreen("Service degraded: ".concat(e?"true":"false"))}},{key:"loadInterstitialAd",value:function(){Ye.preloadAdsByType(DG.INTERSTITIAL)}},{key:"loadRewardedVideoAd",value:function(){Ye.preloadAdsByType(DG.REWARDED_VIDEO)}},{key:"loadRewardedInterstitialAd",value:function(){Ye.preloadAdsByType(DG.REWARDED_INTERSTITIAL)}},{key:"showInterstitialAd",value:function(){Ye.showInterstitialAdAsync({contextType:"browse"})}},{key:"showRewardedVideoAd",value:function(){Ye.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0})}},{key:"showRewardedInterstitialAd",value:function(){Ye.showRewardedInterstitialAdAsync({contextType:"reward",forceLoad:!0})}},{key:"showBannerAd",value:function(){Ye.showBannerAds()}},{key:"hideBannerAd",value:function(){Ye.hideBannerAds()}},{key:"showAdsenseInterstitialAd",value:function(){Ye.showInterstitialAdAsync({adService:"adsense"})}},{key:"showAdsenseRewardedVideoAd",value:function(){Ye.showRewardVideoAdAsync({adService:"adsense",forceLoad:!0})}},{key:"showAdsenseRewardedInterstitialAd",value:function(){Ye.showRewardedInterstitialAdAsync({adService:"adsense",forceLoad:!0})}}]),n}(E));b._RF.pop(),b._RF.push({},"56a103phldKO7/xShKcD3bI","AnimationDemo",void 0);var FG;(0,w.ccclass)("AnimationDemo")(NG=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"onLoad",value:function(){}},{key:"switchToTestTransitionScene",value:function(){St.switchScene("TestTransitionScene")}}]),n}(E));b._RF.pop(),b._RF.push({},"a3b8adQtftPmKSSoumHWY1e","AudioDemo",void 0);var zG,MG,UG,GG,HG,VG,WG,qG;(0,w.ccclass)("AudioDemo")(FG=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).isMusicMute=!1,e.isSoundMute=!1,e.listSounds=[],e}return o(n,[{key:"onLoad",value:function(){var e,t;this.musicComp=null===(e=oe("Music"))||void 0===e?void 0:e.getComponent(Pn),this.soundComp=null===(t=oe("Sound"))||void 0===t?void 0:t.getComponent(jn),this.validateRequiredComponents(),this.listSounds=[He.BG_MUSIC,He.BUTTON_CLICK,He.HAND_CLAP,He.LEVEL_FAIL,He.LEVEL_PASS,He.LOST_STAR_IN_GAMEPLAY,He.RAISE_STAR,He.SPAWN_COINS,He.STAR_RAISE,He.TOUCH_START]}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"playBackgroundMusic",value:function(){this.musicComp.play(He.BG_MUSIC)}},{key:"pauseBackgroundMusic",value:function(){this.musicComp.pause(He.BG_MUSIC)}},{key:"stopBackgroundMusic",value:function(){this.musicComp.stop(He.BG_MUSIC)}},{key:"randomMusicChannelVolume",value:function(){var e=Math.random();this.musicComp.setVolume(e)}},{key:"toggleMuteMusicChannel",value:function(){this.isMusicMute?(this.musicComp.mute(!1),this.isMusicMute=!1):(this.musicComp.mute(!0),this.isMusicMute=!0)}},{key:"playRandomSound",value:function(){var e=Math.floor(Math.random()*this.listSounds.length),t=this.listSounds[e];t&&this.soundComp.play(t)}},{key:"toggleMuteSoundChannel",value:function(){this.isSoundMute?(this.soundComp.mute(!1),this.isSoundMute=!1):(this.soundComp.mute(!0),this.isSoundMute=!0)}},{key:"randomSoundChannelVolume",value:function(){var e=Math.random();this.soundComp.setVolume(e)}}]),n}(E));b._RF.pop(),b._RF.push({},"9e6b330nHBK2oNz8N9/lpDx","FlowChallenge",void 0);var jG,KG,YG,JG,ZG,QG=w.ccclass,XG=Ludex.Utils,$G=XG.Decorator,eH=XG.String,tH=XG.Number,nH=codex,iH=nH.match,aH=nH.player,rH=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};zG=QG("FlowChallenge"),MG=$G.tryCatch(rH),UG=$G.tryCatch(rH),GG=$G.tryCatch(rH),HG=$G.tryCatch(rH),VG=$G.tryCatch(rH),zG((u((qG=function(e){i(p,e);var s,l,u,c,h,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=d.call.apply(d,[this].concat(n))).playerId="",e.matchId="",e.contextId="",e.opponentId="",e}return o(p,[{key:"onLoad",value:function(){this.playerId=aH.getPlayerId(),this.matchId=eH.generateObjectId(),this.contextId=eH.generateObjectId(),this.opponentId=eH.generateObjectId()}},{key:"inviteFriends",value:(h=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,iH.challenge.invite.processAsync({playerId:this.playerId,extraData:{rescued:0}});case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"challengeFriend",value:(c=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={playerId:this.playerId,opponentId:this.opponentId},gt.showLoadingScreen(0),e.next=4,iH.challenge.friend.processAsync(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"joinChallenge",value:(u=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=iH.getMatchState(),a={playerId:this.playerId,contextId:eH.generateObjectId(),matchId:null!==(t=i.id)&&void 0!==t?t:this.matchId,opponentId:this.opponentId},gt.showLoadingScreen(0),e.next=5,iH.challenge.join.processAsync(a);case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"continueChallenge",value:(l=t(n().mark((function e(){var t,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=iH.getMatchState(),a={playerId:this.playerId,matchId:null!==(t=i.id)&&void 0!==t?t:this.matchId,contextId:this.contextId,opponentId:this.opponentId},gt.showLoadingScreen(0),e.next=5,iH.challenge.continue.processAsync(a);case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"finishChallenge",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,iH.challenge.finish.processAsync({playerId:this.playerId,playerScore:tH.random(99999)});case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"inviteFriends",[MG],Object.getOwnPropertyDescriptor(qG.prototype,"inviteFriends"),qG.prototype),u(qG.prototype,"challengeFriend",[UG],Object.getOwnPropertyDescriptor(qG.prototype,"challengeFriend"),qG.prototype),u(qG.prototype,"joinChallenge",[GG],Object.getOwnPropertyDescriptor(qG.prototype,"joinChallenge"),qG.prototype),u(qG.prototype,"continueChallenge",[HG],Object.getOwnPropertyDescriptor(qG.prototype,"continueChallenge"),qG.prototype),u(qG.prototype,"finishChallenge",[VG],Object.getOwnPropertyDescriptor(qG.prototype,"finishChallenge"),qG.prototype),WG=qG));b._RF.pop(),b._RF.push({},"f3decJ3ZlRLt6CDMHpl1XCe","FlowContext",void 0);var oH,sH,lH,uH,cH,hH,dH=w.ccclass,pH=Ludex.Utils.Decorator,fH=codex,yH=fH.match,vH=fH.player,gH=fH.context,mH=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};jG=dH("FlowContext"),KG=pH.tryCatch(mH),YG=pH.tryCatch(mH),jG((u((ZG=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=u.call.apply(u,[this].concat(a))).playerId="",e.changeContext=function(){var e=t(n().mark((function e(t,i,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gH.receiveContext(t,i,a),e.next=3,gH.detectContextSessionType();case 3:gH.detectContextGameMode();case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),e}return o(c,[{key:"onLoad",value:function(){this.playerId=vH.getPlayerId()}},{key:"chooseFriends",value:(l=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(i),gt.showLoadingScreen(0),e.next=4,yH.context.choose.processAsync(m(m({},a),{},{playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"processContextData",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,gH.processContextData();case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"setSingleContext",value:function(){this.changeContext("","SOLO",{})}},{key:"setTournamentContext",value:function(){this.changeUrl("/?context_source_id=123&context_type=GENERIC&tournament=true"),this.changeContext("mocked-context-id-tournament","THREAD",{})}},{key:"setShareInviteContext",value:function(){var e={type:gH.getSessionContextTypes().SHARE_INVITE,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-share-invite","THREAD",e)}},{key:"setMatchingGroupContext",value:function(){var e={type:gH.getSessionContextTypes().MATCHING_GROUP,playerId:"4766619483409000",playerName:"Player",playerPhoto:"",playerScore:100};this.changeContext("mocked-context-id-matching-group","GROUP",e)}},{key:"setChallengeFriendContext",value:function(){var e={type:gH.getSessionContextTypes().CHALLENGE_FRIEND,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-challenge-friend","THREAD",e)}},{key:"changeUrl",value:function(e){window.history.pushState({},"",e)}}]),c}(E)).prototype,"chooseFriends",[KG],Object.getOwnPropertyDescriptor(ZG.prototype,"chooseFriends"),ZG.prototype),u(ZG.prototype,"processContextData",[YG],Object.getOwnPropertyDescriptor(ZG.prototype,"processContextData"),ZG.prototype),JG=ZG));b._RF.pop(),b._RF.push({},"36562c8k/RF2p/1aLUWFaf8","FlowGroup",void 0);var bH,SH,wH,kH,TH,CH=w.ccclass,EH=Ludex.Utils.Decorator,LH=codex,IH=LH.match,xH=LH.player,RH=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};oH=CH("FlowGroup"),sH=EH.tryCatch(RH),lH=EH.tryCatch(RH),uH=EH.tryCatch(RH),oH((u((hH=function(e){i(h,e);var s,l,u,c=a(h);function h(){var e;r(this,h);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=c.call.apply(c,[this].concat(n))).playerId="",e}return o(h,[{key:"onLoad",value:function(){this.playerId=xH.getPlayerId()}},{key:"startGroup",value:(u=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(i),gt.showLoadingScreen(0),e.next=4,IH.group.start.processAsync(m(m({},a),{},{matchTag:"test",playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"joinGroup",value:(l=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(i),gt.showLoadingScreen(0),e.next=4,IH.group.join.processAsync(m(m({},a),{},{playerId:this.playerId}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"finishGroup",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),xH.setPlayerDataByName("score",Math.floor(2*Math.random())),e.next=4,IH.group.finish.processAsync();case 4:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}]),h}(E)).prototype,"startGroup",[sH],Object.getOwnPropertyDescriptor(hH.prototype,"startGroup"),hH.prototype),u(hH.prototype,"joinGroup",[lH],Object.getOwnPropertyDescriptor(hH.prototype,"joinGroup"),hH.prototype),u(hH.prototype,"finishGroup",[uH],Object.getOwnPropertyDescriptor(hH.prototype,"finishGroup"),hH.prototype),cH=hH));b._RF.pop(),b._RF.push({},"46e6dOzDGJMa48+tVKTAEIT","FlowSingle",void 0);var AH,_H,PH,BH,NH,OH=w.ccclass,DH=Ludex.Utils,FH=DH.Decorator,zH=DH.Number,MH=codex,UH=MH.match,GH=MH.player,HH=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};bH=OH("FlowSingle"),SH=FH.tryCatch(HH),wH=FH.tryCatch(HH),bH((u((TH=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).playerId="",e}return o(c,[{key:"onLoad",value:function(){this.playerId=GH.getPlayerId()}},{key:"startSingle",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,UH.single.start.processAsync({playerId:this.playerId});case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"finishSingle",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return GH.setPlayerDataByName("score",zH.random(1e3)),e.next=3,UH.single.finish.processAsync();case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}]),c}(E)).prototype,"startSingle",[SH],Object.getOwnPropertyDescriptor(TH.prototype,"startSingle"),TH.prototype),u(TH.prototype,"finishSingle",[wH],Object.getOwnPropertyDescriptor(TH.prototype,"finishSingle"),TH.prototype),kH=TH));b._RF.pop(),b._RF.push({},"e2458xYf5xBG6uFEvkD4R6s","FlowStratery",void 0);var VH,WH,qH,jH,KH,YH,JH,ZH,QH,XH,$H,eV=w.ccclass,tV=Ludex,nV=tV.Utils,iV=nV.Decorator,aV=nV.String,rV=nV.Number,oV=tV.Dtos.Match.CustomData,sV=codex,lV=sV.match,uV=sV.player,cV=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};AH=eV("FlowStrategy"),_H=iV.tryCatch(cV),PH=iV.tryCatch(cV),AH((u((NH=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).playerId="",e}return o(c,[{key:"onLoad",value:function(){this.playerId=uV.getPlayerId(),this.initDtosDefaultData()}},{key:"initDtosDefaultData",value:function(){oV.addDefaultData({maxTime:0}),oV.addValidateFunction("maxTime",(function(e){if(e<0)throw new Error("maxTime must be greater than 0")}))}},{key:"startStrategy",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,lV.strategy.start.processAsync({matchId:aV.generateObjectId(),gameMode:"endless",playerId:this.playerId});case 3:return e.next=5,lV.handler.setMatchCustomData({maxTime:600});case 5:return e.next=7,lV.handler.setProfileData({id:this.playerId,wish:0});case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"finishStrategy",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lV.handler.setProfileData({id:this.playerId,wish:rV.random(9999)});case 2:return e.next=4,lV.strategy.finish.processAsync({setPlayerBestScore:!1,postGlobalLeaderboard:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),c}(E)).prototype,"startStrategy",[_H],Object.getOwnPropertyDescriptor(NH.prototype,"startStrategy"),NH.prototype),u(NH.prototype,"finishStrategy",[PH],Object.getOwnPropertyDescriptor(NH.prototype,"finishStrategy"),NH.prototype),BH=NH));b._RF.pop(),b._RF.push({},"943b1Zkv9BAaZVhinus8Bkv","FlowTournament",void 0);var hV,dV=w.ccclass,pV=Ludex.Utils.Decorator,fV=codex,yV=fV.match,vV=fV.player,gV=function(e){gt.closeLoadingScreen(),e instanceof Error&&gt.showNotificationScreen(e.message)};VH=dV("FlowTournament"),WH=pV.tryCatch(gV),qH=pV.tryCatch(gV),jH=pV.tryCatch(gV),KH=pV.tryCatch(gV),YH=pV.tryCatch(gV),JH=pV.tryCatch(gV),ZH=pV.tryCatch(gV),QH=pV.tryCatch(gV),VH((u(($H=function(e){i(v,e);var s,l,u,c,h,d,p,f,y=a(v);function v(){var e;r(this,v);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=y.call.apply(y,[this].concat(n))).playerId="",e}return o(v,[{key:"onLoad",value:function(){this.playerId=vV.getPlayerId()}},{key:"joinTournament",value:(f=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:return t=e.sent,i=t.getID().toString(),e.next=7,yV.tournament.join.processAsync({tournamentId:i,playerId:this.playerId});case 7:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"continueTournament",value:(p=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:return t=e.sent,i=t.getContextID(),e.next=7,yV.tournament.continue.processAsync({contextId:i,playerId:this.playerId});case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"finishTournament",value:(d=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),t=Math.floor(2*Math.random()),vV.setPlayerDataByName("score",t),e.next=5,yV.tournament.finish.processAsync({playerId:this.playerId,bestScore:t});case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"createTournament",value:(h=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),t=Ludex.Utils.String.generateObjectId(),e.next=4,GameSDK.tournament.createAsync({initialScore:0,config:{title:"Tournament title",tournamentTitle:"Tournament title"},data:{playerId:this.playerId,playerName:"playerName",leaderboardId:t}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"postScoreTournament",value:(c=t(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Number(t.string),console.warn("score",i),gt.showLoadingScreen(0),e.next=5,GameSDK.tournament.postScoreAsync(i);case 5:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"shareTournament",value:(u=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(i),gt.showLoadingScreen(0),console.warn("payload",a),e.next=5,GameSDK.tournament.shareAsync(a);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})},{key:"getTournamentsAsync",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:gt.showLoadingScreen(0),t=GameSDK.tournament.getTournamentsAsync(),console.warn(t);case 3:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"getTournamentAsync",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gt.showLoadingScreen(0),e.next=3,GameSDK.getTournamentAsync();case 3:t=e.sent,console.warn(t);case 5:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}]),v}(E)).prototype,"joinTournament",[WH],Object.getOwnPropertyDescriptor($H.prototype,"joinTournament"),$H.prototype),u($H.prototype,"continueTournament",[qH],Object.getOwnPropertyDescriptor($H.prototype,"continueTournament"),$H.prototype),u($H.prototype,"finishTournament",[jH],Object.getOwnPropertyDescriptor($H.prototype,"finishTournament"),$H.prototype),u($H.prototype,"createTournament",[KH],Object.getOwnPropertyDescriptor($H.prototype,"createTournament"),$H.prototype),u($H.prototype,"postScoreTournament",[YH],Object.getOwnPropertyDescriptor($H.prototype,"postScoreTournament"),$H.prototype),u($H.prototype,"shareTournament",[JH],Object.getOwnPropertyDescriptor($H.prototype,"shareTournament"),$H.prototype),u($H.prototype,"getTournamentsAsync",[ZH],Object.getOwnPropertyDescriptor($H.prototype,"getTournamentsAsync"),$H.prototype),u($H.prototype,"getTournamentAsync",[QH],Object.getOwnPropertyDescriptor($H.prototype,"getTournamentAsync"),$H.prototype),XH=$H));b._RF.pop(),b._RF.push({},"d78a7DHN+5P/YjKftUFEZcU","JavaAds",void 0);var mV;(0,w.ccclass)("JavaAds")(hV=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"__preload",value:function(){this.setupAds()}},{key:"setupAds",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),n}(E));b._RF.pop(),b._RF.push({},"e8e10DJmXdH8Jw30JCMjJqd","ScreensFlows",void 0);var bV;(0,w.ccclass)("ScreensFlows")(mV=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).screenActions=[function(){return e.showLoadingScreen()},function(){return e.showNotificationScreen()},function(){return e.showWinningScreen()},function(){return e.showLoseScreen()},function(){return e.showSettingsScreen()}],e}return o(c,[{key:"preloadScreens",value:function(){gt.preloadScreens()}},{key:"getRandomDelay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return Math.floor(Math.random()*(t-e+1))+e}},{key:"executeRandomScreenAction",value:(l=t(n().mark((function e(){var t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Math.floor(Math.random()*this.screenActions.length),i=this.screenActions[t]){e.next=5;break}return console.warn("No screen action found at index:",t),e.abrupt("return");case 5:i();case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"spamScreens",value:(s=t(n().mark((function e(){var t,i,a,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=10,console.info(" Start spamming screens..."),i=n().mark((function e(){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.getRandomDelay(200,800),console.debug(" Spamming screen ".concat(a+1,"/").concat(t)),e.next=4,new Promise((function(e){return setTimeout(e,i)}));case 4:return e.next=6,r.executeRandomScreenAction();case 6:case"end":return e.stop()}}),e)})),a=0;case 4:if(!(a<t)){e.next=9;break}return e.delegateYield(i(),"t0",6);case 6:a++,e.next=4;break;case 9:console.info(" Finished spamming screens");case 10:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"showNotificationScreen",value:function(){gt.showNotificationScreen("Hey!")}},{key:"closeNotificationScreen",value:function(){gt.closeNotificationScreen()}},{key:"showLoadingScreen",value:function(){gt.showLoadingScreen(5)}},{key:"closeLoadingScreen",value:function(){gt.closeLoadingScreen()}},{key:"showWinningScreen",value:function(){gt.openScreen(We.WINNING_SCREEN)}},{key:"closeWinningScreen",value:function(){gt.closeScreen(We.WINNING_SCREEN)}},{key:"showLoseScreen",value:function(){gt.openScreen(We.LOSE_SCREEN,{level:1})}},{key:"closeLoseScreen",value:function(){gt.closeScreen(We.LOSE_SCREEN)}},{key:"showSettingsScreen",value:function(){gt.openScreen(We.SETTINGS_SCREEN)}},{key:"closeSettingsScreen",value:function(){gt.closeScreen(We.SETTINGS_SCREEN)}},{key:"showCongratulationScreen",value:function(){gt.openScreen(We.CONGRATULATION_SCREEN)}},{key:"closeCongratulationScreen",value:function(){gt.closeScreen(We.CONGRATULATION_SCREEN)}}]),c}(E));b._RF.pop(),b._RF.push({},"abf91gNohBK7arKnziqu2PF","AnimationDemo2",void 0);var SV,wV,kV,TV,CV,EV;(0,w.ccclass)("AnimationDemo2")(bV=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"onLoad",value:function(){}},{key:"switchToTestScene",value:function(){St.switchScene("TestScene")}}]),n}(E));b._RF.pop(),b._RF.push({},"56b92F9LoxNs5aCgvw+tkq6","LoadingSceneTransition",void 0);var LV,IV,xV,RV,AV,_V,PV,BV,NV,OV=w.ccclass,DV=w.requireComponent,FV=w.property;SV=OV("LoadingSceneTransition"),wV=DV([Be]),kV=FV([P]),SV(TV=wV((EV=u((CV=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"targets",EV,h(e)),e.realTargets=[],e}return o(n,[{key:"start",value:function(){for(var e=this,t=0;t<this.targets.length;t++){var n=this.targets[t];if(n){var i=$(n);i.setParent(this.node),i.active=!1,this.realTargets.push(i)}}I.addPersistRootNode(this.node),I.once(j.EVENT_BEFORE_SCENE_LAUNCH,(function(){e.playFadeOutAnimationClip()}))}},{key:"playFadeOutAnimationClip",value:function(){var e=this,t=0;if(this.realTargets&&0!==this.realTargets.length){var n,i=l(this.realTargets);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.active=!0;var r=a.getComponent(k);if(r)r.clips.some((function(e){return"FadeOut"===(null==e?void 0:e.name)}))?(r.play("FadeOut"),r.once(k.EventType.FINISHED,(function(){++t===e.realTargets.length&&e.node.destroy()}))):(this.node.destroy(),console.warn("Not have FadeOut clip"))}}catch(e){i.e(e)}finally{i.f()}}}}]),n}(E)).prototype,"targets",[kV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),TV=CV))||TV);b._RF.pop(),b._RF.push({},"13fe0ouBiBIBZF8ZbrGZnR9","BadgeExplosion",void 0);var zV,MV,UV,GV,HV,VV,WV,qV,jV,KV,YV,JV,ZV,QV,XV,$V,eW,tW,nW,iW,aW=w.ccclass,rW=w.property,oW=Ludex.Utils.Time,sW=(LV=aW("BadgeExplosion"),IV=rW(N),xV=rW(N),RV=rW(N),LV((PV=u((_V=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"aura1",PV,h(e)),c(e,"aura2",BV,h(e)),c(e,"aura3",NV,h(e)),e}return o(d,[{key:"onLoad",value:function(){this.aura1.opacity=0,this.aura2.opacity=0,this.aura1.node.setScale(new U(0,0,1)),this.aura2.node.setScale(new U(0,0,1)),this.particaleSystem=this.node.getComponentsInChildren(ae)}},{key:"runAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,u,c,h,d,p,f,y,v,g=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=oW.sleepAsync(500),i=oW.sleepAsync(0).then((function(){var e,t=l(g.particaleSystem);try{for(t.s();!(e=t.n()).done;)e.value.resetSystem()}catch(e){t.e(e)}finally{t.f()}})),a=z(this.aura1.node).set({scale:new U(0,0,0)}).delay(0).to(.8,{scale:new U(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new U(1,1,1)},{easing:"cubicIn"}),r=z(this.aura1).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),o=z(this.aura2.node).set({scale:new U(0,0,0)}).delay(0).to(.8,{scale:new U(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new U(1,1,1)},{easing:"cubicIn"}),s=z(this.aura2).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),u=z(this.aura3).set({opacity:0}).delay(0).to(.2,{opacity:255},{easing:"cubicOut"}).delay(.4).to(.6,{opacity:0},{easing:"cubicOut"}),c=z(this.aura3.node).set({scale:new U(0,0,0)}).delay(0).to(.8,{scale:new U(.8,.8,1)},{easing:"quintOut"}).to(.4,{scale:new U(1,1,1)},{easing:"cubicIn"}),h=Ke.runTweenAsync(a),d=Ke.runTweenAsync(r),p=Ke.runTweenAsync(o),f=Ke.runTweenAsync(s),y=Ke.runTweenAsync(u),v=Ke.runTweenAsync(c),e.next=18,Promise.all([t,h,d,p,f,y,v,i]);case 18:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"aura1",[IV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BV=u(_V.prototype,"aura2",[xV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NV=u(_V.prototype,"aura3",[RV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AV=_V))||AV);b._RF.pop(),b._RF.push({},"0c0ade09iBA/4Gh86gEKE7V","BadgeRewardScreen",void 0);var lW,uW,cW,hW,dW,pW,fW,yW,vW,gW=w.ccclass,mW=w.disallowMultiple,bW=w.requireComponent,SW=w.property,wW=Ludex.Events,kW=codex.event;zV=gW("BadgeRewardScreen"),MV=bW(Pi),UV=SW(x),GV=SW(N),HV=SW(sW),VV=SW(D),WV=SW(N),qV=SW(P),jV=SW(P),KV=SW(q),zV(YV=mW(YV=MV((ZV=u((JV=function(e){i(v,e);var s,l,u,d,p,f,y=a(v);function v(){var e;r(this,v);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=y.call.apply(y,[this].concat(n)),c(e,"badgeSprite",ZV,h(e)),c(e,"badgeClaimOpacity",QV,h(e)),c(e,"badgeExplosion",XV,h(e)),c(e,"collectButtonComponent",$V,h(e)),c(e,"collectButtonOpacity",eW,h(e)),c(e,"badgeButtonPosition",tW,h(e)),c(e,"glowNode",nW,h(e)),c(e,"dateText",iW,h(e)),e.isReward=!1,e.badgeKey="",e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("BadgeRewardScreen: screen not found");e.validateEventPayload(t)&&(e.enabled=!0,e.badgeClaimOpacity.node.active=!1,e.badgeClaimOpacity.opacity=255,e.badgeButtonPosition.active=!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1)},e}return o(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){kW.on(wW.OPENING_SCREEN,this.handleOpeningScreen),kW.on(wW.OPENED_SCREEN,this.handleOpenedScreen),kW.on(wW.CLOSING_SCREEN,this.handleClosingScreen),kW.on(wW.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){kW.off(wW.OPENING_SCREEN,this.handleOpeningScreen),kW.off(wW.OPENED_SCREEN,this.handleOpenedScreen),kW.off(wW.CLOSING_SCREEN,this.handleClosingScreen),kW.off(wW.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled){var e=this.screen.data.customData||{},t=e.theme,n=e.key,i=e.date,a=e.isReward;this.isReward=!0===a,this.badgeKey=n,a?this.runRewardAnimation({theme:t,key:n}):(this.updateBadgeData({theme:t,key:n,date:i}),this.collectButtonOpacity.opacity=255,this.collectButtonComponent.interactable=!0)}}},{key:"close",value:function(){gt.closeScreen(We.BADGE_REWARD_SCREEN)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"handleCollectButton",value:function(){this.isReward?this.collectReward():this.close()}},{key:"updateBadgeData",value:function(e){var t=e.theme,n=e.key,i=e.date;this.badgeSprite.spriteFrame=ht.getJourneyBadgeSpriteFrame(n,t),this.badgeSprite.node.setScale(1.5,1.5),this.dateText.node.active=!0,this.dateText.string=i}},{key:"runRewardAnimation",value:(f=t(n().mark((function e(t){var i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.badgeSprite){e.next=3;break}return console.warn("No badge sprite found for animation"),e.abrupt("return");case 3:return i=t.theme,a=t.key,r=ht.getJourneyBadgeSpriteFrame(a,i),this.dateText.node.active=!1,this.badgeSprite.spriteFrame=r,this.badgeSprite.node.setScale(1,1),this.collectButtonComponent.interactable=!1,this.collectButtonOpacity.opacity=0,this.badgeExplosion.runAnimation(),e.next=13,this.runBadgeAnimation();case 13:return e.next=15,this.runCollectButtonAnimation();case 15:this.collectButtonComponent.interactable=!0;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"runBadgeAnimation",value:(p=t(n().mark((function e(){var t,i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.badgeSprite.node.scale=new U(1.6,1.6,0),t=z(this.badgeSprite.node).to(.5,{scale:new U(1,1,0)},{easing:"backOut"}),e.next=4,Promise.all([Ke.runTweenAsync(t)]).then((function(){i.badgeSprite.node.scale=new U(1,1,0)}));case 4:this.startGlowAnimation();case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"startGlowAnimation",value:function(){this.glowNode.active=!0,this.glowNode.setScale(new U(1,1,0)),this.glowTween?this.glowTween.start():this.glowTween=z(this.glowNode).by(6,{angle:360},{easing:"linear"}).repeatForever().start()}},{key:"stopGlowAnimation",value:function(){this.glowTween.stop(),this.glowNode.active=!1}},{key:"runCollectButtonAnimation",value:(d=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z(this.collectButtonOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),e.next=3,Ke.runTweenAsync(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"collectReward",value:function(){var e=this;ht.logJourneyGetBadge(this.badgeKey),this.runCollectAnimation().then((function(){e.close()}))}},{key:"runCollectAnimation",value:(u=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.collectButtonComponent.interactable=!1,this.collectButtonOpacity.opacity=0,e.next=4,this.runBadgeShrinkAnimation();case 4:return e.next=6,this.runBadgeClaimAnimation();case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"runBadgeShrinkAnimation",value:(l=t(n().mark((function e(){var t,i,a,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z(this.badgeSprite.node).to(.5,{scale:new U(0,0,0)},{easing:"backIn"}),i=z(this.glowNode).to(.3,{scale:new U(0,0,0)},{easing:"backIn",onComplete:function(){r.stopGlowAnimation()}}),e.next=4,Promise.all([Ke.runTweenAsync(t),Ke.runTweenAsync(i)]);case 4:return this.badgeClaimOpacity.node.active=!0,a=z(this.badgeClaimOpacity.node).set({scale:new U(0,0,0)}).to(.5,{scale:new U(.6,.6,0)},{easing:"cubicOut"}),e.next=8,Ke.runTweenAsync(a);case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"runBadgeClaimAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:1.5,this.badgeButtonPosition.active=!0,i=z(this.badgeClaimOpacity.node).to(t,{worldPositionX:this.badgeButtonPosition.worldPosition.x},{easing:"sineIn"}),a=z(this.badgeClaimOpacity.node).to(t,{worldPositionY:this.badgeButtonPosition.worldPosition.y},{easing:"sineOut"}),r=z(this.badgeClaimOpacity.node).to(t,{scale:new U(.3,.3,0)},{easing:"sineInOut"}),o=z(this.badgeClaimOpacity).to(t,{opacity:128},{easing:"cubicInOut"}),e.next=8,Promise.all([Ke.runTweenAsync(i),Ke.runTweenAsync(a),Ke.runTweenAsync(r),Ke.runTweenAsync(o)]);case 8:this.badgeClaimOpacity.node.active=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),v}(E)).prototype,"badgeSprite",[UV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QV=u(JV.prototype,"badgeClaimOpacity",[GV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XV=u(JV.prototype,"badgeExplosion",[HV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$V=u(JV.prototype,"collectButtonComponent",[VV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eW=u(JV.prototype,"collectButtonOpacity",[WV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tW=u(JV.prototype,"badgeButtonPosition",[qV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nW=u(JV.prototype,"glowNode",[jV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iW=u(JV.prototype,"dateText",[KV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YV=JV))||YV)||YV);b._RF.pop(),b._RF.push({},"9e3d0oIxtFNPrQeHM4VUq0v","Badge",void 0);var TW,CW,EW,LW,IW,xW=w.ccclass,RW=w.property,AW=(lW=xW("Badge"),uW=RW(q),cW=RW(x),hW=RW(D),lW((fW=u((pW=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"monthText",fW,h(e)),c(e,"badgeIcon",yW,h(e)),c(e,"badgeButton",vW,h(e)),e.canClick=!1,e.disableInteraction=function(){},e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"setData",value:function(e,t,n){if(e<1||e>12)return console.warn("Invalid month: ".concat(e,". Month should be between 1 and 12.")),void(this.monthText.string="Invalid Month");if(this.month=e,this.year=t,this.monthText.string=["None","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e],n){this.badgeIcon.node.active=!0;var i=Fb.getBadgeSpriteFrame({month:e,year:t});if(i){this.badgeIcon.spriteFrame=i;var a=If.DailyBadgeOffset[e];a&&this.badgeIcon.node.setPosition(new U(a.x,a.y,0))}this.badgeButton.node.name="BadgeButton-".concat(e,"/").concat(t)}else this.badgeIcon.node.active=!1}},{key:"handleClickBadge",value:function(){if(this.canClick){var e={day:1,month:this.month,year:this.year};this.disableInteraction(),gt.closeScreen(We.BADGES_SCREEN,{openNextScreenImmediately:!0}),gt.openScreen(We.DAILY_CHALLENGE_SCREEN,{customData:e,preloadCallback:Fb.isNeedLoadDailyChallenge(e)?function(){return Fb.loadingTextureBeforeOpenDailyChallenge(e)}:void 0})}}}]),n}(E)).prototype,"monthText",[uW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yW=u(pW.prototype,"badgeIcon",[cW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vW=u(pW.prototype,"badgeButton",[hW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dW=pW))||dW);b._RF.pop(),b._RF.push({},"340d33fSuRJiYZnXoULu9+7","BadgeShelf",void 0);var _W,PW,BW,NW,OW,DW=w.ccclass,FW=w.property,zW=(TW=DW("BadgeShelf"),CW=FW(AW),TW((IW=u((LW=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"badges",IW,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updateShelf",value:function(e){var t,n=l(this.badges);try{for(n.s();!(t=n.n()).done;){t.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}for(var i=0;i<e.length;i++){var a=this.badges[i];a.node.active=!0,a.setData(e[i].month,e[i].year,e[i].badge)}}}]),n}(E)).prototype,"badges",[CW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),EW=LW))||EW);b._RF.pop(),b._RF.push({},"3144cy6l9hKvaQ6zP0zdxAK","JourneyBadge",void 0);var MW,UW,GW,HW,VW,WW,qW,jW,KW,YW=w.ccclass,JW=w.property,ZW=(_W=YW("JourneyBadge"),PW=JW(D),_W((OW=u((NW=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"badgeButton",OW,h(e)),e.canClick=!1,e.disableInteraction=function(){},e.isInit=!1,e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.init()}},{key:"init",value:function(){this.isInit||(this.sprite=this.getComponent(x),this.isInit=!0)}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"setData",value:function(e){var t=e.theme,n=e.key,i=e.seasonId;this.sprite.spriteFrame=ht.getJourneyBadgeSpriteFrame(n,t),this.theme=t,this.key=n,this.dateText=ht.getBadgeDate({seasonId:i,key:n})}},{key:"handleClickBadge",value:function(){this.canClick&&gt.openScreen(We.BADGE_REWARD_SCREEN,{customData:{theme:this.theme,key:this.key,date:this.dateText,isReward:!1}})}}]),n}(E)).prototype,"badgeButton",[PW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BW=NW))||BW);b._RF.pop(),b._RF.push({},"d1a8bWI7ghGGZYWTVf0o52l","JourneyBadgeBanner",void 0);var QW,XW,$W,eq,tq,nq,iq,aq,rq,oq,sq,lq,uq,cq,hq,dq,pq,fq,yq,vq,gq,mq,bq,Sq,wq,kq,Tq=w.ccclass,Cq=w.property,Eq=(MW=Tq("JourneyBadgeBanner"),UW=Cq(Bd),GW=Cq(ce),HW=Cq(ZW),MW((qW=u((WW=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"titleLabel",qW,h(e)),c(e,"layout",jW,h(e)),c(e,"badges",KW,h(e)),e.isInit=!1,e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.init()}},{key:"start",value:function(){}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"init",value:function(){this.isInit||(this.uiTransform=this.getComponent(R),this.layoutUITransform=this.layout.getComponent(R),this.isInit=!0)}},{key:"updateData",value:function(e,t,n){this.titleLabel.key=e;var i=It.CHERRY_BLOSSOM;switch(e){case"cherryBlossom":i=It.CHERRY_BLOSSOM;break;case"springDolls":i=It.SPRING_DOLLS;break;case"teaCeremony":i=It.TEA_CEREMONY}var a,r=l(this.badges);try{for(r.s();!(a=r.n()).done;){a.value.node.active=!1}}catch(e){r.e(e)}finally{r.f()}for(var o=0;o<t;o++){var s=this.badges[o],u=(o+1).toString();s.node.active=!0,s.setData({theme:i,seasonId:n,key:u})}this.updateSizeLayout()}},{key:"updateSizeLayout",value:function(){this.isInit||this.init(),this.layout.spacingX=0,this.layout.updateLayout(!0);var e,t=0,n=l(this.badges);try{for(n.s();!(e=n.n()).done;){e.value.node.active&&t++}}catch(e){n.e(e)}finally{n.f()}if(!(t<=1)){var i=(this.uiTransform.width/this.layout.node.scale.x-this.layoutUITransform.width)/(t+1);this.layout.spacingX=i,this.layout.updateLayout(!0)}}}]),n}(E)).prototype,"titleLabel",[UW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jW=u(WW.prototype,"layout",[GW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KW=u(WW.prototype,"badges",[HW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),VW=WW))||VW);b._RF.pop(),b._RF.push({},"968e0OZNAlGYb9yClDwNxLb","BadgesScreen",void 0);var Lq,Iq,xq=w.ccclass,Rq=w.property,Aq=w.requireComponent,_q=Ludex,Pq=_q.Events,Bq=(_q.Utils,codex),Nq=(Bq.player,Bq.event);QW=xq("BadgesScreen"),XW=Aq(Pi),$W=Rq(ce),eq=Rq(X),tq=Rq(X),nq=Rq(ce),iq=Rq(X),aq=Rq(D),rq=Rq(D),oq=Rq(D),sq=Rq(P),lq=Rq(P),uq=Rq(P),QW(cq=XW((dq=u((hq=function(e){i(p,e);var s,u,d=a(p);function p(){var e;r(this,p);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=d.call.apply(d,[this].concat(a)),c(e,"dailyBadgeContainer",dq,h(e)),c(e,"badgeShelfPrefab",pq,h(e)),c(e,"badgeYearLabelPrefab",fq,h(e)),e.shelfComponentDict={},e.yearLabelDict={},c(e,"journeyBadgeContainer",yq,h(e)),c(e,"journeyBadgeBannerPrefab",vq,h(e)),e.journeyBadgeBannerDict={},c(e,"buttons",gq,h(e)),e.badges=[],e.journeyBadges=[],c(e,"journeyButton",mq,h(e)),c(e,"dailyButton",bq,h(e)),c(e,"journeyScrollview",Sq,h(e)),c(e,"dailyScrollview",wq,h(e)),c(e,"journeyEmptyText",kq,h(e)),e.interaction=!1,e.disableInteraction=function(){e.interaction=!1;var t,n=l(e.buttons);try{for(n.s();!(t=n.n()).done;){t.value.interactable=!1}}catch(e){n.e(e)}finally{n.f()}var i,a=l(e.badges);try{for(a.s();!(i=a.n()).done;){i.value.canClick=!1}}catch(e){a.e(e)}finally{a.f()}var r,o=l(e.journeyBadges);try{for(o.s();!(r=o.n()).done;){r.value.canClick=!1}}catch(e){o.e(e)}finally{o.f()}console.log("BadgeScreenButton",!1)},e.handleOpenedScreen=function(){var i=t(n().mark((function t(i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(i)){t.next=2;break}return t.abrupt("return");case 2:e.screen.data.source===We.DAILY_CHALLENGE_SCREEN?e.updateDailyChallengeContainer():e.updateJourneyContainer(),e.screen.animation?e.screen.animation.once(k.EventType.FINISHED,(function(){e.enableInteraction()})):e.enableInteraction();case 5:case"end":return t.stop()}}),t)})));return function(e){return i.apply(this,arguments)}}(),e.countBadges=0,e}return o(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.journeyButtonSprite=this.journeyButton.getComponent(x),this.journeyButtonLabel=this.journeyButton.getComponentInChildren(q),this.dailyButtonSprite=this.dailyButton.getComponent(x),this.dailyButtonLabel=this.dailyButton.getComponentInChildren(q),this.listenScreenEvents()}},{key:"enableInteraction",value:function(){this.interaction=!0;var e,t=l(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}var n,i=l(this.badges);try{for(i.s();!(n=i.n()).done;){n.value.canClick=!0}}catch(e){i.e(e)}finally{i.f()}var a,r=l(this.journeyBadges);try{for(r.s();!(a=r.n()).done;){a.value.canClick=!0}}catch(e){r.e(e)}finally{r.f()}console.log("BadgeScreenButton",!0)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Nq.on(Pq.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Nq.off(Pq.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"updateDailyBadgeData",value:function(){for(var e=(new Date).getMonth()+1,t=(new Date).getFullYear(),n=2025;n<=t;n++){for(var i=n===t?e:12,a=[],r=1;r<=i;r++)if(a.push(r),3===a.length||r===i){var o="".concat(n,"-").concat(a[0]);if(!this.shelfComponentDict[o]){var s=$(this.badgeShelfPrefab);s.setParent(this.dailyBadgeContainer.node);var u=s.getComponent(zW);this.shelfComponentDict[o]=u}var c,h=this.shelfComponentDict[o],d=[],p=l(a);try{for(p.s();!(c=p.n()).done;){var f=c.value,y=Fb.isCompletedMonth({month:f,year:n});d.push({month:f,year:n,badge:y})}}catch(e){p.e(e)}finally{p.f()}h.updateShelf(d);var v,g=l(h.badges);try{for(g.s();!(v=g.n()).done;){var m=v.value;this.badges.push(m),m.disableInteraction=this.disableInteraction,m.canClick=this.interaction}}catch(e){g.e(e)}finally{g.f()}a.length=0}var b="".concat(n);if(!this.yearLabelDict[b]){var S=$(this.badgeYearLabelPrefab);S.setParent(this.dailyBadgeContainer.node);var w=S.getComponentInChildren(q);w.string=n.toString(),this.yearLabelDict[b]=w}}}},{key:"updateJourneyBadgeData",value:function(){this.countBadges=0;var e,t=ht.getSeasonIds(),n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=ht.getClaimedBadgesBySeasonId(i).length;if(0!==a){var r=ht.getSeasonThemeById(i),o="cherryBlossom";switch(r){case It.CHERRY_BLOSSOM:o="cherryBlossom";break;case It.SPRING_DOLLS:o="springDolls";break;case It.TEA_CEREMONY:o="teaCeremony"}var s=i;if(!this.journeyBadgeBannerDict[s]){var u=$(this.journeyBadgeBannerPrefab);u.setParent(this.journeyBadgeContainer.node);var c=u.getComponent(Eq);this.journeyBadgeBannerDict[s]=c}var h=this.journeyBadgeBannerDict[s];h.updateData(o,a,i);var d,p=l(h.badges);try{for(p.s();!(d=p.n()).done;){var f=d.value;this.journeyBadges.push(f),f.disableInteraction=this.disableInteraction,f.canClick=this.interaction}}catch(e){p.e(e)}finally{p.f()}this.countBadges+=a}}}catch(e){n.e(e)}finally{n.f()}this.journeyEmptyText.active=0===this.countBadges}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleClose",value:function(){this.disableInteraction(),gt.closeScreen(We.BADGES_SCREEN,{openNextScreenImmediately:!0});var e=this.screen.data;e.source===We.DAILY_CHALLENGE_SCREEN?gt.openScreen(We.DAILY_CHALLENGE_SCREEN):e.source===We.JOURNEY_LEVEL_SCREEN&&gt.openScreen(We.JOURNEY_LEVEL_SCREEN)}},{key:"handleScroll",value:function(e,t,n){var i;if(12===t)i=!1;else{if(9!==t)return;i=!0}for(var a in this.shelfComponentDict){var r=this.shelfComponentDict[a];if(r){var o,s=l(r.badges);try{for(s.s();!(o=s.n()).done;){o.value.badgeButton.interactable=i}}catch(e){s.e(e)}finally{s.f()}}}for(var u in this.journeyBadgeBannerDict){var c=this.journeyBadgeBannerDict[u];if(c){var h,d=l(c.badges);try{for(d.s();!(h=d.n()).done;){h.value.badgeButton.interactable=i}}catch(e){d.e(e)}finally{d.f()}}}}},{key:"handleClickedDailyButton",value:function(){this.updateDailyChallengeContainer(!1)}},{key:"updateDailyChallengeContainer",value:(u=t(n().mark((function e(){var t,i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(a.length>0&&void 0!==a[0])||a[0],!0!==this.isDailyBadge||!t){e.next=3;break}return e.abrupt("return");case 3:if(!Fb.isNeedLoadBadge()){e.next=9;break}return gt.showLoadingScreen(),i=Fb.getBadges(),e.next=8,Fb.loadBadges(i);case 8:gt.closeLoadingScreen();case 9:this.dailyButtonSprite.color=new M(255,255,255,255),this.dailyButtonLabel.color=new M(224,180,122,255),this.journeyButtonSprite.color=new M(185,166,166,255),this.journeyButtonLabel.color=new M(131,92,74,255),this.journeyScrollview.active=!1,this.journeyEmptyText.active=!1,this.dailyScrollview.active=!0,this.updateDailyBadgeData(),this.isDailyBadge=!0;case 18:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleClickedJourneyButton",value:function(){this.updateJourneyContainer(!1)}},{key:"updateJourneyContainer",value:(s=t(n().mark((function e(){var t,i=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],!1!==this.isDailyBadge||t){e.next=3;break}return e.abrupt("return");case 3:if(!ht.isNeedClaimedBadges()){e.next=8;break}return gt.showLoadingScreen(),e.next=7,ht.loadClaimedBadges();case 7:gt.closeLoadingScreen();case 8:this.journeyButtonSprite.color=new M(255,255,255,255),this.journeyButtonLabel.color=new M(224,180,122,255),this.dailyButtonSprite.color=new M(185,166,166,255),this.dailyButtonLabel.color=new M(131,92,74,255),this.journeyScrollview.active=!0,this.journeyEmptyText.active=0===this.countBadges,this.dailyScrollview.active=!1,this.updateJourneyBadgeData(),this.isDailyBadge=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"dailyBadgeContainer",[$W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pq=u(hq.prototype,"badgeShelfPrefab",[eq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fq=u(hq.prototype,"badgeYearLabelPrefab",[tq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yq=u(hq.prototype,"journeyBadgeContainer",[nq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vq=u(hq.prototype,"journeyBadgeBannerPrefab",[iq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gq=u(hq.prototype,"buttons",[aq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mq=u(hq.prototype,"journeyButton",[rq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bq=u(hq.prototype,"dailyButton",[oq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sq=u(hq.prototype,"journeyScrollview",[sq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wq=u(hq.prototype,"dailyScrollview",[lq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kq=u(hq.prototype,"journeyEmptyText",[uq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cq=hq))||cq);b._RF.pop(),b._RF.push({},"f5bb7f58CRIWIyc/nZ+nFUo","BadgeBackground",void 0);var Oq,Dq,Fq,zq,Mq,Uq,Gq,Hq,Vq,Wq,qq,jq,Kq,Yq,Jq,Zq,Qq,Xq,$q,ej,tj,nj,ij,aj,rj=w.ccclass,oj=(w.property,Ludex),sj=(oj.Utils.Decorator,oj.Events),lj=codex.event,uj=ze.Layout,cj=(d(Lq={},uj.Portrait,{width:1080,height:2164}),d(Lq,uj.Landscape,{width:2732,height:1583}),Lq);rj("BadgeBackground")(Iq=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ve[We.BADGES_SCREEN]&&(e.updateBackgroundSprite(),A.on(Oe.VIEW_RESIZED,e.handleViewResized))},e.unlistenGameEvents=function(t){t.screenName===Ve[We.BADGES_SCREEN]&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),this.additionalBgUITransform=this.additionalBg.getComponent(R),on.validateRequiredProperties(this),lj.on(sj.OPENING_SCREEN,this.listenGameEvents),lj.on(sj.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Fe.getCurrentLayout()===ze.Layout.Landscape){var e=Fe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Fe.getCurrentLayoutBackgroundByKey("Badge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Fe.getCurrentLayoutBackgroundByKey("Badge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentBadgeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"getLandscapeBackground",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return cj}}]),c}(Gi));b._RF.pop(),b._RF.push({},"d6149LGv/NCuY8oQhmlvxvj","ChallengeFriendCompleteScreen",void 0);var hj,dj=w.ccclass,pj=w.property,fj=w.requireComponent,yj=Ludex,vj=yj.Events,gj=(yj.Utils,codex),mj=gj.player,bj=gj.event,Sj=gj.match;Oq=dj("ChallengeFriendCompleteScreen"),Dq=fj(Pi),Fq=pj($w),zq=pj($w),Mq=pj(q),Uq=pj(q),Gq=pj(q),Hq=pj(q),Vq=pj(x),Wq=pj(le),qq=pj(le),jq=pj(x),Oq(Kq=Dq((Jq=u((Yq=function(e){i(p,e);var s,l,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"playerAvatarWithFlag",Jq,h(e)),c(e,"opponentAvatarWithFlag",Zq,h(e)),c(e,"titleWin",Qq,h(e)),c(e,"titleDraw",Xq,h(e)),c(e,"titleLose",$q,h(e)),c(e,"titleWaiting",ej,h(e)),c(e,"glowBG",tj,h(e)),c(e,"glowBGWin",nj,h(e)),c(e,"glowBGLose",ij,h(e)),c(e,"glowTitle",aj,h(e)),e.isOpponentFinished=!1,e.handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.updateChallengeData()},e}return o(p,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){bj.on(vj.OPENING_SCREEN,this.handleOpeningScreen),bj.on(vj.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){bj.off(vj.OPENING_SCREEN,this.handleOpeningScreen),bj.off(vj.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){gt.closeScreen(We.CHALLENGE_FRIEND_COMPLETE_SCREEN)}},{key:"handleClickedClose",value:(u=t(n().mark((function e(){var t,i,a,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.close(),rt.switchToSoloContext(),(null==(t=this.screen.data)?void 0:t.source)===bt.DASHBOARD_SCENE||(i=this.screen.data,a=i.level,r=void 0===a?1:a,o=i.score,s=void 0===o?0:o,this.showWiningScreen(s,r));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"showWiningScreen",value:function(e,t){jf.inst.isPlayerJoined?gt.openScreen(We.TOURNAMENT_COMPLETE_SCREEN,{score:e,level:t}):gt.openScreen(We.WINNING_SCREEN,{score:e,level:t})}},{key:"updateChallengeData",value:function(){this.isOpponentFinished=!1,this.updatePlayerChallengeData(),this.updateOpponentChallengeData();var e=this.isOpponentFinished,t=Number(this.playerAvatarWithFlag.scoreLabel.string),n=Number(this.opponentAvatarWithFlag.scoreLabel.string),i=t>n,a=t===n;this.titleWin.node.active=!1,this.titleDraw.node.active=!1,this.titleLose.node.active=!1,this.titleWaiting.node.active=!1,e?i?(this.playerAvatarWithFlag.updateState("win"),this.opponentAvatarWithFlag.updateState("lose"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGWin,this.glowTitle.node.active=!0,this.titleWin.node.active=!0):a?(this.playerAvatarWithFlag.updateState("lose"),this.opponentAvatarWithFlag.updateState("lose"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGWin,this.glowTitle.node.active=!0,this.titleDraw.node.active=!0):(this.playerAvatarWithFlag.updateState("lose"),this.opponentAvatarWithFlag.updateState("win"),this.glowBG.node.active=!0,this.glowBG.spriteFrame=this.glowBGLose,this.glowTitle.node.active=!0,this.titleLose.node.active=!0):(this.playerAvatarWithFlag.updateState("waiting"),this.opponentAvatarWithFlag.updateState("waiting"),this.glowBG.node.active=!1,this.glowTitle.node.active=!1,this.titleWaiting.node.active=!0)}},{key:"updatePlayerChallengeData",value:(l=t(n().mark((function e(){var t,i,a,r,o,s,l,u,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=mj.getPlayer(),i=t.playerId,a=codex.match.getMatchState(),(r=a.profiles)&&r[i]){e.next=4;break}return e.abrupt("return");case 4:o=r[i],s=o.name,l=o.photo,u=o.score,c=void 0===u?0:u,this.playerAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:s,avatarUrl:l}),this.playerAvatarWithFlag.scoreLabel.string=c.toString();case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"updateOpponentChallengeData",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l,u,c,h,d;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Sj.getMatchState(),i=t.customData.opponentId,a=codex.match.getMatchState(),(r=a.profiles)&&r[i]){e.next=5;break}return e.abrupt("return");case 5:o=r[i],s=o.name,l=o.photo,u=o.score,c=void 0===u?0:u,h=o.finished,d=void 0!==h&&h,this.opponentAvatarWithFlag.playerAvatar.updatePlayerAvatar({playerName:s,avatarUrl:l}),this.opponentAvatarWithFlag.scoreLabel.string=c.toString(),this.isOpponentFinished=d;case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"playerAvatarWithFlag",[Fq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zq=u(Yq.prototype,"opponentAvatarWithFlag",[zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qq=u(Yq.prototype,"titleWin",[Mq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xq=u(Yq.prototype,"titleDraw",[Uq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$q=u(Yq.prototype,"titleLose",[Gq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ej=u(Yq.prototype,"titleWaiting",[Hq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tj=u(Yq.prototype,"glowBG",[Vq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nj=u(Yq.prototype,"glowBGWin",[Wq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ij=u(Yq.prototype,"glowBGLose",[qq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aj=u(Yq.prototype,"glowTitle",[jq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kq=Yq))||Kq);b._RF.pop(),b._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var wj,kj,Tj,Cj=w.ccclass,Ej=w.requireComponent;Cj("BackgroundMask")(hj=Ej([N])(hj=function(e){i(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"onLoad",value:function(){var e=this.getComponent(N);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),n}(E))||hj);b._RF.pop(),b._RF.push({},"92058jAgL9EQrmYxKm+mzty","ScreenMiddleAlignment",void 0);var Lj,Ij,xj,Rj,Aj,_j=w.ccclass,Pj=w.property;_j("ScreenMiddleAlignment")((Tj=u((kj=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"reduceScaleWhenNotEnoughHeight",Tj,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.alignToScreenMiddle()}},{key:"alignToScreenMiddle",value:function(){var e,t=Ye.getBannerAdsHeight();if(this.node.setPosition(0,t/2),this.reduceScaleWhenNotEnoughHeight){var n=(null===(e=this.node.getComponent(R))||void 0===e?void 0:e.contentSize.height)||0,i=_.getVisibleSize().height-t;if(n>i){var a=i/n;this.node.setScale(a,a,1)}else this.node.setScale(1,1,1)}}}]),n}(E)).prototype,"reduceScaleWhenNotEnoughHeight",[Pj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wj=kj));b._RF.pop(),b._RF.push({},"d562cAXnG1PQ6vXfOEq2wVu","Screens",void 0);var Bj,Nj,Oj,Dj,Fj,zj,Mj,Uj=w.ccclass,Gj=w.property,Hj=w.executeInEditMode;Lj=Uj("Screens"),Ij=Gj({type:J(We)}),Lj(xj=Hj((Aj=u((Rj=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"screenKeys",Aj,h(e)),e}return o(n,[{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"onChildrenChanged",value:function(){}}]),n}(E)).prototype,"screenKeys",[Ij],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xj=Rj))||xj);b._RF.pop(),b._RF.push({},"b05b4SBCkxHfLoaKt3EWCrp","ChooseCircle",void 0);var Vj,Wj,qj,jj,Kj,Yj,Jj,Zj,Qj,Xj=w.ccclass,$j=w.property,eK=121,tK=122,nK=Ludex.Utils.Signal,iK=(Bj=Xj("ChooseCircle"),Nj=$j(R),Oj=$j(R),Bj((zj=u((Fj=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"mask1",zj,h(e)),c(e,"mask2",Mj,h(e)),e.signalController=new nK.SignalController,e}return o(u,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"reset",value:function(){this.signalController.abort(),this.mask1.setContentSize(0,.5*tK),this.mask2.setContentSize(0,.5*tK)}},{key:"runAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:.5,this.reset(),i=this.signalController.renew(),a=z(this.mask1).to(.3*t,{width:.6*eK}),r=z(this.mask1).to(.3*t,{height:tK}),o=z(this.mask2).to(.2*t,{width:.4*eK}),s=z(this.mask2).to(.2*t,{height:tK}),e.next=9,Ke.runTweenAsync(a,i);case 9:return e.next=11,Ke.runTweenAsync(r,i);case 11:return e.next=13,Ke.runTweenAsync(o,i);case 13:return e.next=15,Ke.runTweenAsync(s,i);case 15:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),u}(E)).prototype,"mask1",[Nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mj=u(Fj.prototype,"mask2",[Oj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dj=Fj))||Dj);b._RF.pop(),b._RF.push({},"580e6YiGSBK/pZ2QsuAOa0i","DayColumn",void 0);var aK,rK,oK,sK,lK,uK,cK,hK,dK,pK,fK,yK,vK,gK,mK,bK,SK,wK,kK,TK,CK,EK,LK,IK,xK,RK,AK,_K,PK,BK,NK,OK,DK,FK,zK,MK,UK,GK,HK,VK,WK,qK=w.ccclass,jK=w.property,KK=(Vj=qK("DayColumn"),Wj=jK(q),qj=jK(q),jj=jK(T),Vj((Jj=u((Yj=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"dayOfWeekLabel",Jj,h(e)),c(e,"dayLabels",Zj,h(e)),c(e,"dayOfWeek",Qj,h(e)),e.defaultColor=new M(154,71,46,255),e.unselectedColor=new M(180,139,109,255),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){if(0!==this.dayLabels.length){var e=this.dayLabels[0].getComponent(R);this.labelWidth=e.width,this.labelHeight=e.height}else console.warn("No day labels found in DayColumn")}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updateDayOfWeekLabel",value:function(e,t){if(this.dayOfWeekLabel.string="".concat(this.dayOfWeek.charAt(0).toUpperCase()).concat(this.dayOfWeek.slice(1)),e<1||e>12||t<0)console.warn("Invalid month or year provided");else{for(var n=["sun","mon","tue","wed","thu","fri","sat"],i=[],a=1;a<=31;a++){var r=new Date(t,e-1,a);if(r.getMonth()!==e-1)break;n[r.getDay()]===this.dayOfWeek&&i.push(a)}if(0!==i.length){var o,s=l(this.dayLabels);try{for(s.s();!(o=s.n()).done;){o.value.string=""}}catch(e){s.e(e)}finally{s.f()}for(var u=i[0]<=n.indexOf(this.dayOfWeek)+1?0:1,c=0;c<i.length;c++)this.dayLabels[c+u].string=i[c].toString(),this.dayLabels[c+u].color=this.defaultColor;var h=new Date,d=h.getDate(),p=h.getMonth()+1,f=h.getFullYear();if(p===e&&f===t)for(var y=0;y<i.length;y++)i[y]>d&&(this.dayLabels[y+u].color=this.unselectedColor)}else console.warn("No valid days found for ".concat(this.dayOfWeek," in ").concat(e,"/").concat(t))}}}]),n}(E)).prototype,"dayOfWeekLabel",[Wj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zj=u(Yj.prototype,"dayLabels",[qj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qj=u(Yj.prototype,"dayOfWeek",[jj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"sun"}}),Kj=Yj))||Kj);b._RF.pop(),b._RF.push({},"b6790CoxhxPF42ncO5h2FS5","Calendar",void 0);var YK,JK,ZK,QK,XK,$K,eY,tY,nY=w.ccclass,iY=w.property,aY=(w.executeInEditMode,aK=nY("Calendar"),rK=iY(KK),oK=iY(C),sK=iY(C),lK=iY(C),uK=iY(P),cK=iY(iK),hK=iY(Bd),dK=iY(P),pK=iY(Bd),fK=iY(q),yK=iY(D),vK=iY(D),gK=iY(ce),mK=iY(x),bK=iY(N),SK=iY(le),wK=iY(x),kK=iY(x),TK=iY(x),aK((LK=u((EK=function(e){i(p,e);var s,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"dayColumns",LK,h(e)),c(e,"day",IK,h(e)),c(e,"month",xK,h(e)),c(e,"year",RK,h(e)),c(e,"container",AK,h(e)),c(e,"chooseCircle",_K,h(e)),c(e,"buttonLabel",PK,h(e)),c(e,"watchAdsNode",BK,h(e)),c(e,"buttonLabel2",NK,h(e)),c(e,"dateLabel",OK,h(e)),c(e,"prevMonthButton",DK,h(e)),c(e,"nextMonthButton",FK,h(e)),c(e,"layout",zK,h(e)),c(e,"doneImages",MK,h(e)),c(e,"glow",UK,h(e)),c(e,"doneImageFrame",GK,h(e)),c(e,"badgeBackground",HK,h(e)),c(e,"badgeGlow",VK,h(e)),c(e,"badge",WK,h(e)),e.completedDayNode=null,e}return o(p,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.enableInteraction(),this.hideChooseCircle()}},{key:"onDestroy",value:function(){this.disableInteraction()}},{key:"start",value:function(){var e=new Date;this.month=e.getMonth()+1,this.year=e.getFullYear(),this.day=0;for(var t=e.getDate();t>0;t--){if(!Fb.isCompletedChallenge({day:t,month:this.month,year:this.year})){this.day=t;break}}0===this.day&&(this.day=e.getDate()),this.updateMonthlySchedule({day:this.day,month:this.month,year:this.year})}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"updateMonthlySchedule",value:function(e){var t=e.day,n=e.month,i=e.year;if(console.log("Updating monthly schedule with:",e),void 0!==t&&void 0!==n&&void 0!==i)if(n<1||n>12||i<0)console.warn("Invalid month or year provided");else{this.day=t,this.month=n,this.year=i;for(var a=0;a<this.dayColumns.length;a++)this.dayColumns[a].updateDayOfWeekLabel(n,i);var r,o=null,s=l(this.dayColumns);try{for(s.s();!(r=s.n()).done;){var u,c=r.value,h=l(c.dayLabels);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(""!==d.string)if(parseInt(d.string)===t){o=d;break}}}catch(e){h.e(e)}finally{h.f()}if(o)break}}catch(e){s.e(e)}finally{s.f()}if(o){var p=this.getLabelPosition(o);this.chooseCircle.node.setPosition(new U(p.x,p.y,0))}this.updateDoneImages(),this.updateButtons();var f=Fb.getBadgeSpriteFrame({month:n,year:i}),y=Fb.isCompletedMonth({month:n,year:i});if(this.badgeGlow.node.active=y,this.badgeBackground.color=y?new M(255,255,255,255):new M(126,100,106,255),f){this.badge.spriteFrame=f,this.badge.node.active=!0,this.badge.color=y?new M(255,255,255,255):new M(126,100,106,255);var v=If.DailyBadgeOffset[n];v&&this.badge.node.setPosition(new U(v.x,v.y,0))}else this.badge.node.active=!1}}},{key:"enableInteraction",value:function(){this.node.on(P.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(P.EventType.TOUCH_END,this.onTouchEnd,this)}},{key:"disableInteraction",value:function(){this.node.off(P.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(P.EventType.TOUCH_END,this.onTouchEnd,this)}},{key:"getTouchPosition",value:function(e){var t=this.node.getComponent(R),n=e.getUILocation();return t.convertToNodeSpaceAR(new U(n.x,n.y,0))}},{key:"onTouchStart",value:function(e){var t,n=this.getTouchPosition(e),i=n.x-this.container.x,a=n.y-this.container.y,r=null,o=this.dayColumns[0].labelWidth,s=this.dayColumns[0].labelHeight*this.container.scale.y,u=l(this.dayColumns);try{for(u.s();!(t=u.n()).done;){var c,h=t.value,d=l(h.dayLabels);try{for(d.s();!(c=d.n()).done;){var p=c.value,f=this.getLabelPosition(p);if(i>=f.x-o/2&&i<=f.x+o/2&&a>=f.y-s/2&&a<=f.y+s/2){r=p,console.log("Label chosen:",p.string);break}}}catch(e){d.e(e)}finally{d.f()}}}catch(e){u.e(e)}finally{u.f()}if(r&&""!==r.string&&!(new Date(this.year,this.month-1,parseInt(r.string))>new Date)){this.day=parseInt(r.string);var y=this.getLabelPosition(r);this.chooseCircle.node.setPosition(new U(y.x,y.y,0)),this.runChooseAnimation(),this.updateButtons()}}},{key:"onTouchEnd",value:function(e){}},{key:"getDate",value:function(){return{day:this.day,month:this.month,year:this.year}}},{key:"handlePrevMonthClicked",value:function(){var e=this,t=this.getDate(),n=t.month-1,i=t.year;if(n<1&&(n=12,i-=1),this.canClickedPrevMonth()){var a={day:new Date(i,n,0).getDate(),month:n,year:i};if(!Fb.getBadgeSpriteFrame(a))return gt.showLoadingScreen(),void Fb.loadBadges([a]).then((function(t){gt.closeLoadingScreen(),t?(e.updateMonthlySchedule(a),e.runChooseAnimation()):gt.openScreen(We.NOTIFICATION_SCREEN,{message:"failedToLoadBadge"})}));this.updateMonthlySchedule(a),this.runChooseAnimation()}}},{key:"handleNextMonthClicked",value:function(){var e=this,t=this.getDate(),n=t.month+1,i=t.year;if(n>12&&(n=1,i+=1),this.canClickedNextMonth()){var a=new Date(i,n-1,1).getDate(),r={day:a,month:n,year:i};if(!Fb.getBadgeSpriteFrame(r))return gt.showLoadingScreen(),void Fb.loadBadges([r]).then((function(t){gt.closeLoadingScreen(),t?(e.updateMonthlySchedule(r),e.runChooseAnimation()):gt.openScreen(We.NOTIFICATION_SCREEN,{message:"failedToLoadBadge"})}));this.updateMonthlySchedule({day:a,month:n,year:i}),this.runChooseAnimation()}}},{key:"canClickedPrevMonth",value:function(){var e=this.getDate(),t=e.month,n=e.year;return!(1===t&&n<=Db)}},{key:"canClickedNextMonth",value:function(){var e=this.getDate(),t=e.month,n=e.year,i=new Date,a=i.getMonth()+1,r=i.getFullYear(),o=t+1,s=n;return o>12&&(o=1,s+=1),!(s>r||s===r&&o>a)}},{key:"getLabelPosition",value:function(e){var t=e.node.parent.parent;return{x:t.x,y:this.layout.node.position.y+e.node.position.y+e.node.parent.position.y+t.position.y}}},{key:"updateDoneImages",value:function(){var e,t=0,n=l(this.doneImages);try{for(n.s();!(e=n.n()).done;){e.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}var i,a=this.getDate(),r=a.month,o=a.year,s=l(this.dayColumns);try{for(s.s();!(i=s.n()).done;){var u,c=i.value,h=l(c.dayLabels);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(""!==d.string){var p=parseInt(d.string);if(Fb.isCompletedChallenge({day:p,month:r,year:o})){d.color=new M(255,255,255,0);var f=this.getLabelPosition(d);if(t<this.doneImages.length){var y=this.doneImages[t];y.node.active=!0,y.node.setPosition(new U(f.x,f.y,0))}else{var v=new P("DoneImage-".concat(t)),g=v.addComponent(x);g.spriteFrame=this.doneImageFrame,this.container.addChild(v),v.setPosition(new U(f.x,f.y,0)),this.doneImages.push(g),console.log("Created done image ",t)}t++}}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){s.e(e)}finally{s.f()}}},{key:"updateButtons",value:function(){var e=this.getDate(),t=e.month,n=e.year,i=Fb.isCompletedChallenge({day:this.day,month:this.month,year:this.year}),a=new Date;a.getFullYear()===n&&a.getMonth()+1===t&&a.getDate()===this.day?(this.buttonLabel.node.active=!0,this.watchAdsNode.active=!1):(this.buttonLabel.node.active=!1,this.watchAdsNode.active=!0),i?(this.buttonLabel.key="restart",this.buttonLabel2.key="restart"):(this.buttonLabel.key="Play",this.buttonLabel2.key="Play"),this.prevMonthButton&&this.nextMonthButton&&this.dateLabel&&(this.prevMonthButton.node.active=this.canClickedPrevMonth(),this.nextMonthButton.node.active=this.canClickedNextMonth(),this.dateLabel.string="".concat(t<10?"0".concat(t):t,"/").concat(n))}},{key:"findAndHideCompletedDay",value:function(e){this.completedDayNode=null;var t,n=null,i=l(this.dayColumns);try{for(i.s();!(t=i.n()).done;){var a,r=t.value,o=l(r.dayLabels);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.string===e.toString()){n=this.getLabelPosition(s);break}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}if(n){var u=this.doneImages.find((function(e){return e.node.position.x===n.x&&e.node.position.y===n.y}));u?(this.completedDayNode=u.node,this.completedDayNode.active=!1):console.warn("No done image found for position ".concat(n.x,", ").concat(n.y))}else console.warn("No label found for day ".concat(e))}},{key:"runShowCompletedDayAnimation",value:(u=t(n().mark((function e(){var t,i,a,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.completedDayNode){e.next=3;break}return console.warn("No completed day node found for animation"),e.abrupt("return");case 3:return this.completedDayNode.active=!0,this.completedDayNode.scale=new U(1.5,1.5,0),this.glow.node.setPosition(this.completedDayNode.position.clone()),this.glow.opacity=255,this.glow.node.scale=new U(.6,.6,0),t=z(this.completedDayNode).to(.5,{scale:new U(1,1,0)},{easing:"backOut"}),i=z(this.glow).to(.5,{opacity:100},{easing:"linear"}),a=z(this.glow.node).to(.5,{scale:new U(.9,.9,0)},{easing:"backOut"}),e.next=13,Promise.all([Ke.runTweenAsync(t),Ke.runTweenAsync(i),Ke.runTweenAsync(a)]).then((function(){r.glow.opacity=0}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"hideChooseCircle",value:function(){this.chooseCircle.reset()}},{key:"runChooseAnimation",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.chooseCircle.runAnimation());case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),p}(E)).prototype,"dayColumns",[rK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),IK=u(EK.prototype,"day",[oK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),xK=u(EK.prototype,"month",[sK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),RK=u(EK.prototype,"year",[lK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2025}}),AK=u(EK.prototype,"container",[uK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_K=u(EK.prototype,"chooseCircle",[cK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PK=u(EK.prototype,"buttonLabel",[hK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BK=u(EK.prototype,"watchAdsNode",[dK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NK=u(EK.prototype,"buttonLabel2",[pK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OK=u(EK.prototype,"dateLabel",[fK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DK=u(EK.prototype,"prevMonthButton",[yK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FK=u(EK.prototype,"nextMonthButton",[vK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zK=u(EK.prototype,"layout",[gK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MK=u(EK.prototype,"doneImages",[mK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),UK=u(EK.prototype,"glow",[bK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GK=u(EK.prototype,"doneImageFrame",[SK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HK=u(EK.prototype,"badgeBackground",[wK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VK=u(EK.prototype,"badgeGlow",[kK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WK=u(EK.prototype,"badge",[TK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CK=EK))||CK);b._RF.pop(),b._RF.push({},"eec4eYoz6dI1I15fh8NDomM","DailyChallengeScreen",void 0);var rY,oY,sY=w.ccclass,lY=w.property,uY=w.requireComponent,cY=Ludex,hY=cY.Events,dY=(cY.Utils,codex),pY=(dY.player,dY.event);YK=sY("DailyChallengeScreen"),JK=uY(Pi),ZK=lY(aY),QK=lY(D),YK(XK=JK((eY=u(($K=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=u.call.apply(u,[this].concat(a)),c(e,"calendar",eY,h(e)),c(e,"buttons",tY,h(e)),e.handleOpenedScreen=function(){var i=t(n().mark((function t(i){var a,r,o,s,l,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(i)){t.next=2;break}return t.abrupt("return");case 2:r=null===(a=i.screenData)||void 0===a?void 0:a.customData,o=(null==r?void 0:r.day)||0,s=(null==r?void 0:r.month)||0,l=(null==r?void 0:r.year)||0,u=(null==r?void 0:r.dayCompleted)||0,o&&s&&l&&(e.calendar.updateMonthlySchedule({day:o,month:s,year:l}),e.calendar.hideChooseCircle()),u>0&&e.calendar.findAndHideCompletedDay(u),e.screen.animation?e.screen.animation.once(k.EventType.FINISHED,(function(){e.enableInteraction(),u>0?e.calendar.runShowCompletedDayAnimation().then((function(){e.calendar.runChooseAnimation()})):e.calendar.runChooseAnimation()})):e.enableInteraction();case 10:case"end":return t.stop()}}),t)})));return function(e){return i.apply(this,arguments)}}(),e}return o(d,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"enableInteraction",value:function(){var e,t=l(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!0}}catch(e){t.e(e)}finally{t.f()}console.log("DailyScreenButton",!0)}},{key:"disableInteraction",value:function(){var e,t=l(this.buttons);try{for(t.s();!(e=t.n()).done;){e.value.interactable=!1}}catch(e){t.e(e)}finally{t.f()}console.log("DailyScreenButton",!1)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){pY.on(hY.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){pY.off(hY.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleBadgesClicked",value:function(){this.disableInteraction(),gt.closeScreen(We.DAILY_CHALLENGE_SCREEN,{openNextScreenImmediately:!0}),gt.openScreen(We.BADGES_SCREEN,{preloadCallback:Fb.isNeedLoadBadge()?Fb.loadingTextureBeforeOpenBadgeScreen:void 0,source:We.DAILY_CHALLENGE_SCREEN})}},{key:"handleClose",value:function(){rt.switchToNormal(),this.disableInteraction(),gt.closeScreen(We.DAILY_CHALLENGE_SCREEN)}},{key:"handlePlay",value:(s=t(n().mark((function e(){var t,i,a,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.calendar.getDate(),i=t.day,a=t.month,r=t.year,o=new Date,o.getFullYear()===r&&o.getMonth()+1===a&&o.getDate()===i){e.next=10;break}return e.next=7,Ye.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0});case 7:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:s=Fb.getRandomLevel(i,a,r),console.log("Daily Challenge Level: ".concat(s)),codex.analytics.event(it.DAILY_CHALLENGE_START,{level:s}),at.setLevel(s),rt.switchToDailyChallenge(i,a,r),rt.getCurrentMatchMode()===Ludex.Match.Modes.CHALLENGE_FRIEND&&rt.switchToSoloContext(),St.switchToGameScene();case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),d}(E)).prototype,"calendar",[ZK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tY=u($K.prototype,"buttons",[QK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),XK=$K))||XK);b._RF.pop(),b._RF.push({},"2a8d2rxidZO+5jYBBzz2vEq","DailyChallengeBackground",void 0);var fY,yY,vY,gY,mY,bY,SY,wY,kY,TY,CY,EY,LY,IY,xY,RY,AY,_Y=w.ccclass,PY=(w.property,Ludex),BY=(PY.Utils.Decorator,PY.Events),NY=ze.Layout,OY=codex.event,DY=(d(rY={},NY.Portrait,{width:1080,height:2164}),d(rY,NY.Landscape,{width:2732,height:1583}),rY);_Y("DailyChallengeBackground")(oY=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ve[We.DAILY_CHALLENGE_SCREEN]&&A.on(Oe.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ve[We.DAILY_CHALLENGE_SCREEN]&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),this.additionalBgUITransform=this.additionalBg.getComponent(R),on.validateRequiredProperties(this),OY.on(BY.OPENING_SCREEN,this.listenGameEvents),OY.on(BY.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Fe.getCurrentLayout()===ze.Layout.Landscape){var e=Fe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Fe.getCurrentLayoutBackgroundByKey("DailyChallenge")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Fe.getCurrentLayoutBackgroundByKey("DailyChallenge"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentDailyChallengeBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"getLandscapeBackground",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return DY}}]),c}(Gi));b._RF.pop(),b._RF.push({},"0764dErQjJGn6RS8E/9Xn1c","Chest",void 0);var FY,zY,MY,UY,GY,HY,VY,WY=w.ccclass,qY=w.property,jY=(fY=WY("Chest"),yY=qY(q),vY=qY(q),gY=qY(N),mY=qY(D),bY=qY(x),SY=qY(x),wY=qY(x),fY((CY=u((TY=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"hintLabel",CY,h(e)),c(e,"shuffleLabel",EY,h(e)),c(e,"popup",LY,h(e)),c(e,"chestButton",IY,h(e)),c(e,"chestSprite",xY,h(e)),c(e,"tickIcon",RY,h(e)),c(e,"glowSprite",AY,h(e)),e.spinTween=null,e.currentTimeout=void 0,e}return o(n,[{key:"onLoad",value:function(){this.popup.opacity=0}},{key:"updateHintLabel",value:function(e){this.hintLabel.string=e.toString()}},{key:"updateShuffleLabel",value:function(e){this.shuffleLabel.string=e.toString()}},{key:"showPopup",value:function(){var e=this;this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0);var t=this.node.parent;t&&this.node.setSiblingIndex(t.children.length-1);z(this.popup).to(.2,{opacity:255},{easing:"sineInOut"}).start(),this.currentTimeout=setTimeout((function(){e.hidePopup()}),1700)}},{key:"hidePopup",value:function(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0),this&&this.popup&&(this.popup.opacity=0)}},{key:"updateChestState",value:function(e,t){var n,i;(this.chestSprite.color=e?new M(143,107,107):new M(255,255,255),this.chestButton.interactable=!e,this.tickIcon.node.active=e,t&&!e)?(null===(n=this.spinTween)||void 0===n||n.stop(),this.spinTween=z(this.glowSprite.node).by(2,{angle:360},{easing:"linear"}).repeatForever().start(),this.glowSprite.node.active=!0):(null===(i=this.spinTween)||void 0===i||i.stop(),this.glowSprite.node.active=!1)}}]),n}(E)).prototype,"hintLabel",[yY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EY=u(TY.prototype,"shuffleLabel",[vY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LY=u(TY.prototype,"popup",[gY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IY=u(TY.prototype,"chestButton",[mY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xY=u(TY.prototype,"chestSprite",[bY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RY=u(TY.prototype,"tickIcon",[SY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AY=u(TY.prototype,"glowSprite",[wY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kY=TY))||kY);b._RF.pop(),b._RF.push({},"3671aIPELFMe7d/cBXEiqGL","Stage",void 0);var KY,YY,JY,ZY,QY,XY,$Y,eJ,tJ,nJ,iJ,aJ,rJ,oJ,sJ,lJ=w.ccclass,uJ=w.property,cJ=(FY=lJ("Stage"),zY=uJ(P),MY=uJ(P),FY((HY=u((GY=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"tabContainer",HY,h(e)),c(e,"tabLockContainer",VY,h(e)),e}return o(n,[{key:"unLockStage",value:function(){this.tabContainer.active=!0,this.tabLockContainer.active=!1}},{key:"lockStage",value:function(){this.tabContainer.active=!1,this.tabLockContainer.active=!0}}]),n}(E)).prototype,"tabContainer",[zY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VY=u(GY.prototype,"tabLockContainer",[MY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UY=GY))||UY);b._RF.pop(),b._RF.push({},"adfa4ytM1JNS5ajyzDJZ4s8","TaskBlock",void 0);var hJ,dJ,pJ,fJ,yJ,vJ,gJ,mJ,bJ,SJ,wJ,kJ,TJ,CJ,EJ,LJ,IJ=w.ccclass,xJ=w.property,RJ=(KY=IJ("TaskBlock"),YY=xJ(q),JY=xJ(ru),ZY=xJ(D),QY=xJ(q),XY=xJ(q),$Y=xJ(x),KY((nJ=u((tJ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"taskTitle",nJ,h(e)),c(e,"progressBar",iJ,h(e)),c(e,"button",aJ,h(e)),c(e,"progressTitle1",rJ,h(e)),c(e,"progressTitle2",oJ,h(e)),c(e,"icon",sJ,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.taskTitleLocalize=this.taskTitle.getComponent(Bd)}},{key:"setTaskTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.taskTitleLocalize||(this.taskTitleLocalize=this.taskTitle.getComponent(Bd)),this.taskTitleLocalize.key=e,this.taskTitleLocalize.setParams(t)}},{key:"setProgressTitle",value:function(e,t){this.progressTitle1.string=e.toString(),this.progressTitle2.string="/".concat(t),this.progressTitle2.color=e===t?new M(100,169,33,255):new M(154,71,46,255)}},{key:"setProgressBar",value:function(e){this.progressBar.setProgress(e)}},{key:"handleSingleButtonClicked",value:function(){St.switchToGameScene()}},{key:"updateTask",value:function(e){var t=[];switch(e.type.name){case"CompleteLevel":case"UseItem":case"Match":t.push(e.target.toString());break;case"ReachCombo":t.push(e.type.minCombo.toString())}this.setTaskTitle(e.description,t),this.setProgressTitle(e.current,e.target);var n=e.current<=e.target?e.current/e.target:1;this.setProgressBar(n),1===n?(this.button.node.active=!1,this.icon.node.active=!0):(this.button.node.active=!0,this.icon.node.active=!1)}}]),n}(E)).prototype,"taskTitle",[YY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iJ=u(tJ.prototype,"progressBar",[JY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aJ=u(tJ.prototype,"button",[ZY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rJ=u(tJ.prototype,"progressTitle1",[QY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oJ=u(tJ.prototype,"progressTitle2",[XY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sJ=u(tJ.prototype,"icon",[$Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eJ=tJ))||eJ);b._RF.pop(),b._RF.push({},"8fa53dxgu5KFLkyjltDRQ7g","DailyQuestScreen",void 0);var AJ,_J,PJ,BJ,NJ,OJ,DJ=w.ccclass,FJ=w.property,zJ=w.requireComponent,MJ=Ludex.Events,UJ=codex.event;hJ=DJ("DailyQuestScreen"),dJ=zJ(Pi),pJ=FJ(ru),fJ=FJ(cJ),yJ=FJ(RJ),vJ=FJ(jY),gJ=FJ(q),mJ=FJ(Bd),hJ(bJ=dJ((wJ=u((SJ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"progressBar",wJ,h(e)),c(e,"stages",kJ,h(e)),c(e,"taskBlocks",TJ,h(e)),c(e,"chests",CJ,h(e)),c(e,"timerText",EJ,h(e)),c(e,"timerTextLocalize",LJ,h(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.updateDailyQuest()},e.currentShowedStage=-1,e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenButtonEvents(),this.updateTimerText(),this.schedule(this.updateTimerText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){UJ.on(MJ.OPENING_SCREEN,this.handleOpeningScreen),UJ.on(MJ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){UJ.off(MJ.OPENING_SCREEN,this.handleOpeningScreen),UJ.off(MJ.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"listenButtonEvents",value:function(){}},{key:"updateDailyQuest",value:function(){console.log("DailyQuestScreen: updateDailyQuest");for(var e=0;e<this.stages.length;e++){var t=this.stages[e];t&&t.lockStage()}for(var n=0;n<Ym.getCurrentStage();n++){var i=this.stages[n];i&&i.unLockStage()}this.updateShowQuest(),0===Ym.getMaxExp()?this.progressBar.setProgress(0):this.progressBar.setProgress(Ym.getExp()/Ym.getMaxExp());for(var a=Ym.getRewards(),r=0;r<this.chests.length;r++){var o=this.chests[r],s=a[r];o.updateHintLabel(0|s.HintItem),o.updateShuffleLabel(0|s.ShuffleItem)}this.handleUpdateChest();var l=Ym.getRewardIsNotClaimed();(l.UndoItem>0||l.ShuffleItem>0||l.HintItem>0)&&this.handleGetOldReward()}},{key:"updateShowQuest",value:function(e){if(this.currentShowedStage!==e){this.currentShowedStage=void 0===e?Ym.getCurrentStage():e;for(var t=Ym.getCurrentQuestsInStage(e),n=0;n<this.taskBlocks.length;n++){var i=this.taskBlocks[n];if(i){if(n>=t.length){console.warn("DailyQuestScreen: Number of quests is not 3");break}var a=t[n];a&&i.updateTask(a)}}}}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){gt.closeScreen(We.DAILY_QUEST_SCREEN)}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedChest",value:function(e,t){var n=parseInt(t);if(!Ym.getRewarded()[n]&&Ym.canGetReward(n)){var i=Ym.getRewards()[n],a=[];i.HintItem>0&&a.push({item:tt.HINT,count:i.HintItem}),i.ShuffleItem>0&&a.push({item:tt.SHUFFLE,count:i.ShuffleItem}),i.UndoItem>0&&a.push({item:tt.UNDO,count:i.UndoItem}),Ym.updateGetChestReward(n),this.close();var r={items:a,watchAdsDoubleReward:!0,successCallback:function(){},chestId:n,earnFrom:"DailyQuest"};codex.analytics.event(it.DAILY_QUEST_GET_REWARD,{chestId:n}),gt.openScreen(We.REWARD_SCREEN,r)}else{this.chests[n].showPopup();for(var o=0;o<this.chests.length;o++)o!==n&&this.chests[o].hidePopup()}}},{key:"handleUpdateChest",value:function(){for(var e=Ym.getRewarded(),t=0;t<this.chests.length;t++){var n=this.chests[t],i=Ym.canGetReward(t);n.updateChestState(e[t],i)}}},{key:"handleGetOldReward",value:function(){var e=Ym.getRewardIsNotClaimed(),t=[];e.HintItem>0&&t.push({item:tt.HINT,count:e.HintItem}),e.ShuffleItem>0&&t.push({item:tt.SHUFFLE,count:e.ShuffleItem}),e.UndoItem>0&&t.push({item:tt.UNDO,count:e.UndoItem});var n={items:t,watchAdsDoubleReward:!0,successCallback:function(){Ym.resetRewardIsNotClaimed()},earnFrom:"DailyQuest"};codex.analytics.event(it.DAILY_QUEST_GET_OLD_REWARD),gt.openScreen(We.REWARD_SCREEN,n)}},{key:"handleClickedStage",value:function(e,t){var n=parseInt(t);n<=Ym.getCurrentStage()?this.updateShowQuest(n):gt.openScreen(We.NOTIFICATION_SCREEN,{message:"youNeedToCompleteThePreviousStageFirst."})}},{key:"updateTimerText",value:function(){var e=new Date,t=new Date(e);t.setHours(24,0,0,0);var n=Number(t)-Number(e),i=Math.floor(n/36e5),a=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3);this.timerTextLocalize.key="timeHms",this.timerTextLocalize.setParams([i>=10?i.toString():"0".concat(i),a>=10?a.toString():"0".concat(a),r>=10?r.toString():"0".concat(r)])}},{key:"debugFinishGame",value:function(){Ym.finishGame(),this.updateDailyQuest()}},{key:"debugUseItem",value:function(){Ym.useItem({HintItem:1,ShuffleItem:1}),this.updateDailyQuest()}},{key:"debugReachCombo",value:function(){for(var e=45;e>0;e--)Ym.reachCombo(e);this.updateDailyQuest()}},{key:"debugResetQuest",value:function(){Ym.getInstance().reset()}},{key:"debugReward",value:function(){var e=Math.floor(3*Math.random()),t=Math.floor(3*Math.random());0===e&&0===t&&(e=1);var n={items:[{item:tt.HINT,count:e},{item:tt.SHUFFLE,count:t}],watchAdsDoubleReward:!0,successCallback:function(){},chestId:Math.floor(3*Math.random()),earnFrom:"DebugInDailyQuest"};gt.openScreen(We.REWARD_SCREEN,n)}}]),n}(E)).prototype,"progressBar",[pJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kJ=u(SJ.prototype,"stages",[fJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),TJ=u(SJ.prototype,"taskBlocks",[yJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),CJ=u(SJ.prototype,"chests",[vJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),EJ=u(SJ.prototype,"timerText",[gJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LJ=u(SJ.prototype,"timerTextLocalize",[mJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bJ=SJ))||bJ);b._RF.pop(),b._RF.push({},"91431DewwBPMpOM36EKcv0L","DailyRewardScreen",void 0);var GJ,HJ,VJ,WJ,qJ,jJ,KJ,YJ,JJ,ZJ,QJ,XJ,$J,eZ,tZ,nZ,iZ,aZ,rZ,oZ,sZ,lZ,uZ,cZ,hZ,dZ,pZ,fZ,yZ,vZ,gZ,mZ=w.ccclass,bZ=w.disallowMultiple,SZ=w.requireComponent,wZ=w.property,kZ=Ludex.Events,TZ=codex,CZ=TZ.event;TZ.language,AJ=mZ("DailyRewardScreen"),_J=SZ(Pi),PJ=wZ(D),AJ(BJ=bZ(BJ=_J((OJ=u((NJ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"closeButtonComponent",OJ,h(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("DailyRewardScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.enabled=!0)},e}return o(n,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.listenScreenEvents()}},{key:"listenScreenEvents",value:function(){CZ.on(kZ.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){CZ.off(kZ.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,gt.closeScreen(We.DAILY_REWARD_SCREEN)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"handleClaimReward",value:function(e,t){var n=zO.getDailyReward();if(n){var i=[];switch(n.type){case"shuffle":i.push({item:tt.SHUFFLE,count:n.value});break;case"hint":i.push({item:tt.HINT,count:n.value});break;case"both":i.push({item:tt.SHUFFLE,count:n.value}),i.push({item:tt.HINT,count:n.value});break;default:return void console.warn("Unknown reward type:",n.type)}console.log("DailyRewardScreen: Claiming reward",t);var a={items:i,watchAdsDoubleReward:!0,successCallback:function(){zO.logLoginReward()},chestId:t,earnFrom:"DailyReward",title:"dailyReward",description:"congratulations",openNextScreenImmediately:!0};gt.openScreen(We.REWARD_SCREEN,a),this.close()}}}]),n}(E)).prototype,"closeButtonComponent",[PJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BJ=NJ))||BJ)||BJ);b._RF.pop(),b._RF.push({},"97d2fR85BlEOLDYcm3Yt/sT","FreeItemScreen",void 0);var EZ,LZ,IZ,xZ,RZ,AZ,_Z,PZ,BZ,NZ,OZ=w.ccclass,DZ=w.disallowMultiple,FZ=w.requireComponent,zZ=w.property,MZ=Ludex.Events,UZ=codex,GZ=UZ.event,HZ=UZ.language,VZ=(GJ=OZ("ItemConfig"),HJ=zZ({type:tt,visible:!0,serializable:!0}),VJ=zZ({type:le,visible:!0,serializable:!0}),GJ((jJ=u((qJ=o((function e(){r(this,e),c(this,"itemEnum",jJ,this),c(this,"title",KJ,this),c(this,"description",YJ,this),c(this,"spriteFrame",JJ,this)}))).prototype,"itemEnum",[HJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return tt.HINT}}),KJ=u(qJ.prototype,"title",[zZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),YJ=u(qJ.prototype,"description",[zZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),JJ=u(qJ.prototype,"spriteFrame",[VJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),WJ=qJ))||WJ);ZJ=OZ("FreeItemScreen"),QJ=FZ(Pi),XJ=zZ(D),$J=zZ(D),eZ=zZ(q),tZ=zZ(Bd),nZ=zZ(q),iZ=zZ(Bd),aZ=zZ(x),rZ=zZ(Bd),oZ=zZ({type:VZ,visible:!0,serializable:!0}),ZJ(sZ=DZ(sZ=QJ((uZ=u((lZ=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"closeButtonComponent",uZ,h(e)),c(e,"adsButtonComponent",cZ,h(e)),c(e,"titleLabel",hZ,h(e)),c(e,"titleLocalize",dZ,h(e)),c(e,"descriptionLabel",pZ,h(e)),c(e,"descriptionLocalize",fZ,h(e)),c(e,"itemSprite",yZ,h(e)),c(e,"limitAdsLocalize",vZ,h(e)),c(e,"itemConfigs",gZ,h(e)),e.itemConfigsMap=new Map,e.itemScreenData=null,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("FreeItemScreen: screen not found");if(e.validateEventPayload(t)){e.closeButtonComponent.interactable=!0,e.adsButtonComponent.interactable=!0,e.enabled=!0;var n=t.screenData;e.itemScreenData=n;var i=e.itemScreenData.item,a=e.itemConfigsMap.get(i);if(a)if(HZ.hasTextKey(a.title))if(HZ.hasTextKey(a.description)){e.titleLocalize.key=a.title,e.descriptionLocalize.key=a.description,e.itemSprite.spriteFrame=a.spriteFrame;var r=0,o=1;e.itemScreenData.item===tt.HINT?(r=eb.getCurrentWatchedAds("hintItem"),o=eb.getMaxWatchedAds("hintItem")):e.itemScreenData.item===tt.SHUFFLE&&(r=eb.getCurrentWatchedAds("shuffleItem"),o=eb.getMaxWatchedAds("shuffleItem"));var s=o-r;0===s?e.limitAdsLocalize.node.active=!1:1===s?e.limitAdsLocalize.key="1AdLeftToday":(e.limitAdsLocalize.key="xAdsLeftToday",e.limitAdsLocalize.setParams([s.toString()]))}else console.error("Description localization not found for item: ".concat(a.description));else console.error("Title localization not found for item: ".concat(a.title));else console.error("No configuration found for item: ".concat(i))}},e}return o(u,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.initializeItemConfigs(),this.listenScreenEvents()}},{key:"initializeItemConfigs",value:function(){var e=this;this.itemConfigs.forEach((function(t){e.itemConfigsMap.set(t.itemEnum,t)}))}},{key:"listenScreenEvents",value:function(){GZ.on(MZ.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){GZ.off(MZ.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"handleCloseButton",value:function(){var e,t;this.close(),null===(e=this.itemScreenData)||void 0===e||null===(t=e.failCallback)||void 0===t||t.call(e)}},{key:"handleAdsButton",value:(s=t(n().mark((function e(){var t,i,a,r,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="",e.t0=null===(t=this.itemScreenData)||void 0===t?void 0:t.item,e.next=e.t0===tt.HINT?4:e.t0===tt.SHUFFLE?6:8;break;case 4:return a="hintItem",e.abrupt("break",9);case 6:return a="shuffleItem",e.abrupt("break",9);case 8:console.warn("FreeItemScreen: Unknown item type: ".concat(null===(i=this.itemScreenData)||void 0===i?void 0:i.item));case 9:if(""!==a){e.next=12;break}return console.warn("FreeItemScreen: No item type set for ads watched: ".concat(null===(r=this.itemScreenData)||void 0===r?void 0:r.item)),e.abrupt("return");case 12:if(eb.canWatchAds(a)){e.next=15;break}return gt.showNotificationScreen("youHaveReachedTheDailyAdLimit"),e.abrupt("return");case 15:return this.adsButtonComponent.interactable=!1,e.next=18,Ye.showRewardVideoAdAsync();case 18:o=e.sent,this.adsButtonComponent.interactable=!0,o&&(eb.watchedAds(a),null===(s=this.itemScreenData)||void 0===s||null===(l=s.successCallback)||void 0===l||l.call(s),this.close());case 21:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.adsButtonComponent.interactable=!1,gt.closeScreen(We.FREE_ITEM_SCREEN)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),u}(E)).prototype,"closeButtonComponent",[XJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cZ=u(lZ.prototype,"adsButtonComponent",[$J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hZ=u(lZ.prototype,"titleLabel",[eZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dZ=u(lZ.prototype,"titleLocalize",[tZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pZ=u(lZ.prototype,"descriptionLabel",[nZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fZ=u(lZ.prototype,"descriptionLocalize",[iZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yZ=u(lZ.prototype,"itemSprite",[aZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vZ=u(lZ.prototype,"limitAdsLocalize",[rZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gZ=u(lZ.prototype,"itemConfigs",[oZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),sZ=lZ))||sZ)||sZ);b._RF.pop(),b._RF.push({},"96b6dDX0+ROxZshPw4lH4vu","ItemWarnScreen",void 0);var WZ,qZ,jZ=w.ccclass,KZ=w.disallowMultiple,YZ=w.requireComponent,JZ=w.property,ZZ=Ludex,QZ=ZZ.Events,XZ=ZZ.Utils,$Z=codex,eQ=$Z.event,tQ=$Z.language;EZ=jZ("ItemWarnScreen"),LZ=YZ(Pi),IZ=JZ(q),xZ=JZ(Bd),RZ=JZ(D),EZ(AZ=KZ(AZ=LZ((PZ=u((_Z=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"message",PZ,h(e)),c(e,"messageLocalize",BZ,h(e)),c(e,"touchZone",NZ,h(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.touchZone.interactable=!0)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.touchZone.interactable=!1)},e}return o(n,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){eQ.on(QZ.OPENING_SCREEN,this.handleOpeningScreen),eQ.on(QZ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){eQ.off(QZ.OPENING_SCREEN,this.handleOpeningScreen),eQ.off(QZ.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;XZ.Valid.isObject(t)?(t.message&&(tQ.hasTextKey(t.message)?this.messageLocalize.key=t.message:this.message.string=t.message),t.duration&&t.duration>0&&this.scheduleOnce((function(){gt.closeScreen(We.ITEM_WARN_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("ItemWarnScreen: screenData not found")}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),gt.closeScreen(We.ITEM_WARN_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),n}(E)).prototype,"message",[IZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BZ=u(_Z.prototype,"messageLocalize",[xZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NZ=u(_Z.prototype,"touchZone",[RZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AZ=_Z))||AZ)||AZ);b._RF.pop(),b._RF.push({},"585cahdAERGxYwNU78vFNP0","JourneyBackground",void 0);var nQ,iQ,aQ,rQ,oQ,sQ=w.ccclass,lQ=(w.property,Ludex),uQ=(lQ.Utils.Decorator,lQ.Events),cQ=codex.event,hQ=ze.Layout,dQ=(d(WZ={},hQ.Portrait,{width:1080,height:2164}),d(WZ,hQ.Landscape,{width:2732,height:1583}),WZ);sQ("JourneyBackground")(qZ=function(e){i(c,e);var s,l,u=a(c);function c(){var e;r(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=u.call.apply(u,[this].concat(n))).listenGameEvents=function(t){t.screenName===Ve[We.JOURNEY_LEVEL_SCREEN]&&(e.updateBackgroundSprite(),A.on(Oe.VIEW_RESIZED,e.handleViewResized))},e.unlistenGameEvents=function(t){t.screenName===Ve[We.JOURNEY_LEVEL_SCREEN]&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},e}return o(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),this.additionalBgUITransform=this.additionalBg.getComponent(R),on.validateRequiredProperties(this),cQ.on(uQ.OPENING_SCREEN,this.listenGameEvents.bind(this)),cQ.on(uQ.CLOSING_SCREEN,this.unlistenGameEvents.bind(this)),this.tryUpdateBackgroundSprite(),this.isPreloadCompleted=!0}},{key:"tryUpdateBackgroundSprite",value:function(){if(Fe.getCurrentLayout()===ze.Layout.Landscape){var e=Fe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!=Fe.getCurrentLayoutBackgroundByKey("Journey")&&null!=e)return void this.updateBackgroundSprite()}else{if(null!=Fe.getCurrentLayoutBackgroundByKey("Journey"))return void this.updateBackgroundSprite()}this.baseScreen.addPreloadPromise(this.updateBackgroundSprite.bind(this))}},{key:"getPortraitBackground",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentJourneyBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"getLandscapeBackground",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fe.getCurrentLeaderboardBackground());case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"getScreenDesignBackground",value:function(){return dQ}}]),c}(Gi));b._RF.pop(),b._RF.push({},"90686rQlWtIubUa0oXgaXsR","JourneyHeaderResponsiveNode",void 0);var pQ,fQ,yQ,vQ,gQ,mQ=w.ccclass,bQ=w.property;nQ=mQ("JourneyHeaderResponsiveNode"),iQ=bQ(R),nQ((oQ=u((rQ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"headerBackground",oQ,h(e)),e}return o(n,[{key:"updateObjectInLayoutPortrait",value:function(){this.updateHeaderWidth()}},{key:"updateObjectInLayoutLandscape",value:function(){this.updateHeaderWidth()}},{key:"updateHeaderWidth",value:function(){if(this.headerBackground){var e=_.getVisibleSize().width,t=this.headerBackground.width,n=this.headerBackground.node.scale;this.headerBackground.node.setScale(new U(e/t,n.y,n.z))}}}]),n}(Au)).prototype,"headerBackground",[iQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aQ=rQ));b._RF.pop(),b._RF.push({},"4abfdFWrXhCSLEiS2+715nt","JourneyResponsiveNode",void 0);var SQ,wQ,kQ,TQ,CQ,EQ,LQ,IQ,xQ,RQ,AQ,_Q,PQ,BQ,NQ,OQ,DQ,FQ,zQ,MQ=w.ccclass,UQ=w.property;pQ=MQ("JourneyResponsiveNode"),fQ=UQ(aA),pQ((gQ=u((vQ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"reusableScroller",gQ,h(e)),e}return o(n,[{key:"onLoad",value:function(){y(f(n.prototype),"onLoad",this).call(this)}},{key:"updateObjectInLayoutPortrait",value:function(){var e=this;st(10).then((function(){e.reusableScroller.reloadScroller()}))}},{key:"updateObjectInLayoutLandscape",value:function(){var e=this;st(10).then((function(){e.reusableScroller.reloadScroller()}))}}]),n}(Au)).prototype,"reusableScroller",[fQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yQ=vQ));b._RF.pop(),b._RF.push({},"7bae0CCow1MC4qjZB1mb85q","JourneyProgressBar",void 0);var GQ,HQ,VQ,WQ,qQ,jQ,KQ,YQ=w.ccclass,JQ=w.property,ZQ=-254.5,QQ=Ludex.Utils.Time,XQ=(SQ=YQ("JourneyProgressBar"),wQ=JQ(x),kQ=JQ(P),TQ=JQ(N),CQ=JQ(x),EQ=JQ(N),LQ=JQ(le),IQ=JQ(D),xQ=JQ([le]),SQ((_Q=u((AQ=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"progressBar",_Q,h(e)),c(e,"progressFillTail",PQ,h(e)),c(e,"glowOpacity",BQ,h(e)),c(e,"icon",NQ,h(e)),c(e,"popup",OQ,h(e)),c(e,"chestSpriteFrame",DQ,h(e)),c(e,"rewardButtonComponent",FQ,h(e)),c(e,"iconSpriteFrames",zQ,h(e)),e.iconInitialPosition=new U(0,0,0),e.currentTimeout=void 0,e}return o(d,[{key:"onLoad",value:function(){this.iconInitialPosition=this.icon.node.position.clone(),this.hideReachTargetAnimation(),this.progressFillTail.setPosition(new U(ZQ,0,0)),this.popup.opacity=0}},{key:"showPopup",value:function(){var e=this;this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0);var t=this.node.parent;t&&this.node.setSiblingIndex(t.children.length-1);z(this.popup).to(.2,{opacity:255},{easing:"sineInOut"}).start(),this.currentTimeout=setTimeout((function(){e.hidePopup()}),1700)}},{key:"hidePopup",value:function(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=void 0),this&&this.popup&&(this.popup.opacity=0)}},{key:"runFillAnimation",value:(l=t(n().mark((function e(t,i){var a,r,o,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:0,r=function(e){s.progressFillTail.setPosition(new U(505*e.fillRange+ZQ,0,0))},this.progressFillTail.setPosition(new U(505*t+ZQ,0,0)),o=z(this.progressBar).set({fillRange:t}).delay(a).to(.5,{fillRange:i},{easing:"cubicInOut",onUpdate:function(e){r(e)}}).call((function(){s.progressBar.fillRange=i,s.progressFillTail.setPosition(new U(505*i+ZQ,0,0))})),e.next=6,Ke.runTweenAsync(o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"runReachTargetAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rewardButtonComponent.interactable=!1,t=z(this.glowOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),i=z(this.glowOpacity.node).set({scale:new U(0,0,1)}).to(.3,{scale:new U(1,1,1)},{easing:"backOut"}),a=z(this.icon.node).to(.2,{scale:new U(1.2,.8,1)},{easing:"cubicIn"}).to(.3,{scale:new U(.8,1.2,1)},{easing:"cubicOut"}).to(.2,{scale:new U(1,1,1)},{easing:"cubicInOut"}).delay(.1).to(.1,{scale:new U(1.1,.9,1)},{easing:"cubicIn"}).to(.1,{scale:new U(1,1,1)},{easing:"cubicInOut"}),r=z(this.icon.node).to(.2,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y-10,0)},{easing:"cubicInOut"}).to(.4,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+45,0)},{easing:"sineOut"}).to(.3,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"sineIn"}).to(.1,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+10,0)},{easing:"cubicInOut"}).to(.1,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"cubicInOut"}),z(this.glowOpacity.node).set({angle:0}).by(2,{angle:360},{easing:"linear"}).start(),(o=[]).push(Ke.runTweenAsync(t)),o.push(Ke.runTweenAsync(a)),o.push(Ke.runTweenAsync(i)),o.push(Ke.runTweenAsync(r)),e.next=13,Promise.all(o);case 13:return e.next=15,QQ.sleepAsync(200);case 15:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"hideReachTargetAnimation",value:function(){this.glowOpacity.opacity=0,this.glowOpacity.node.setScale(new U(0,0,1)),this.glowOpacity.node.setRotationFromEuler(0,0,0),this.icon.node.setScale(new U(1,1,1)),this.icon.node.setPosition(this.iconInitialPosition)}},{key:"updateRewardIcon",value:function(e,t){var n=0;switch(ht.getJourneyTheme()){case It.CHERRY_BLOSSOM:n=0;break;case It.SPRING_DOLLS:n=1;break;case It.TEA_CEREMONY:n=2;break;default:n=0}switch(e){case Ct.BADGE_1:this.icon.spriteFrame=this.iconSpriteFrames[3*n],this.rewardButtonComponent.interactable=!1;break;case Ct.BADGE_2:this.icon.spriteFrame=this.iconSpriteFrames[3*n+1],this.rewardButtonComponent.interactable=!1;break;case Ct.BADGE_3:this.icon.spriteFrame=this.iconSpriteFrames[3*n+2],this.rewardButtonComponent.interactable=!1;break;case Ct.CHEST:return this.icon.spriteFrame=this.chestSpriteFrame,void(this.rewardButtonComponent.interactable=!0);default:return console.warn("Unknown reward type:",e),void(this.icon.spriteFrame=this.chestSpriteFrame)}this.icon.color=t?new M(255,255,255,255):new M(126,100,106,255)}}]),d}(E)).prototype,"progressBar",[wQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PQ=u(AQ.prototype,"progressFillTail",[kQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BQ=u(AQ.prototype,"glowOpacity",[TQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NQ=u(AQ.prototype,"icon",[CQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OQ=u(AQ.prototype,"popup",[EQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DQ=u(AQ.prototype,"chestSpriteFrame",[LQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FQ=u(AQ.prototype,"rewardButtonComponent",[IQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zQ=u(AQ.prototype,"iconSpriteFrames",[xQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),RQ=AQ))||RQ);b._RF.pop(),b._RF.push({},"49c0fiP0wtDuadHzTJFM2Af","NextJourneyLevelButton",void 0);var $Q,eX,tX,nX,iX,aX,rX,oX,sX,lX,uX,cX,hX,dX,pX,fX,yX,vX,gX,mX,bX,SX,wX,kX,TX,CX,EX,LX,IX=w.ccclass,xX=w.property,RX=(GQ=IX("NextJourneyLevelButton"),HQ=xX(q),VQ=xX(Bd),GQ((jQ=u((qQ=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"levelText",jQ,h(e)),c(e,"levelTextLocalize",KQ,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.levelText)throw new Error("NextLevelButton requires a Label component in levelText.");if(!this.levelTextLocalize)throw new Error("NextLevelButton requires a Localize component in levelTextLocalize.")}},{key:"updateLevelText",value:function(e,t){this.levelText.string="".concat(t," ").concat(e),this.levelTextLocalize.key="levelV",this.levelTextLocalize.setParams([e.toString()])}},{key:"updateText",value:function(e){this.levelTextLocalize.key=e}}]),n}(E)).prototype,"levelText",[HQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KQ=u(qQ.prototype,"levelTextLocalize",[VQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WQ=qQ))||WQ);b._RF.pop(),b._RF.push({},"b661aAXvHhMyqpoXrScxe5E","JourneyWinningScreen",void 0);var AX,_X,PX,BX,NX,OX,DX,FX=w.ccclass,zX=w.property,MX=w.disallowMultiple,UX=w.requireComponent,GX=(w.executeInEditMode,Ludex),HX=GX.Events,VX=GX.Plugins.Analytics.Events.SHARE,WX=codex,qX=WX.player,jX=WX.event,KX=(WX.language,WX.analytics),YX=WX.frameCapture;$Q=FX("JourneyWinningScreen"),eX=UX(Pi),tX=zX(x),nX=zX(Bd),iX=zX(RX),aX=zX(D),rX=zX(D),oX=zX(D),sX=zX(XQ),lX=zX(Bd),uX=zX(Bd),cX=zX(ae),hX=zX(ae),dX=zX(ae),$Q(pX=MX(pX=eX((yX=u((fX=function(e){i(f,e);var s,l,u,d,p=a(f);function f(){var e;r(this,f);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=p.call.apply(p,[this].concat(n)),c(e,"titleRibbon",yX,h(e)),c(e,"titleLabel",vX,h(e)),c(e,"nextLevelButton",gX,h(e)),c(e,"shareButtonComponent",mX,h(e)),c(e,"nextLevelButtonComponent",bX,h(e)),c(e,"returnButtonComponent",SX,h(e)),c(e,"rewardProgressBar",wX,h(e)),c(e,"progressTextLocalize",kX,h(e)),c(e,"commentTextLocalize",TX,h(e)),c(e,"firelightParticleSystem",CX,h(e)),c(e,"blossomParticleSystem",EX,h(e)),c(e,"blossomParticleSystem2",LX,h(e)),e.handleOpeningScreen=function(t){var n,i;if(!e.screen)throw new Error("JourneyWinningScreen: screen not found");e.validateEventPayload(t)&&(e.firelightParticleSystem.node.active=!0,e.screen.data.level=(null==t||null===(n=t.screenData)||void 0===n?void 0:n.level)||1,e.screen.data.score=(null==t||null===(i=t.screenData)||void 0===i?void 0:i.score)||0,e.open())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.firelightParticleSystem.resetSystem(),e.blossomParticleSystem.resetSystem(),e.blossomParticleSystem2.resetSystem())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.firelightParticleSystem.stopSystem(),e.blossomParticleSystem.stopSystem(),e.blossomParticleSystem2.stopSystem())},e}return o(f,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){jX.on(HX.OPENING_SCREEN,this.handleOpeningScreen),jX.on(HX.OPENED_SCREEN,this.handleOpenedScreen),jX.on(HX.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){jX.off(HX.OPENING_SCREEN,this.handleOpeningScreen),jX.off(HX.OPENED_SCREEN,this.handleOpenedScreen),jX.off(HX.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){Ge.playSound(He.HAND_CLAP),this.processJourneyFlow()}},{key:"processJourneyFlow",value:function(){this.titleLabel.key="wonderful",this.commentTextLocalize.key="observeCarefully",this.progressTextLocalize.key="levelV",this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!0,this.rewardProgressBar.node.active=!0,this.nextLevelButton.updateText("next");var e=ht.getCompletedLevel(),t=ht.getCurrentRewardLevel(!1),n=ht.getCurrentRewardType(t),i=(e-1)/t,a=e/t;this.progressTextLocalize.setParams(["".concat(e,"/").concat(t)]);var r=e===t;this.rewardProgressBar.updateRewardIcon(n,r),r?this.processJourneyRewardFlow(i,a):this.processJourneyNormalFlow(i,a)}},{key:"processJourneyRewardFlow",value:(d=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.node.active=!1,this.shareButtonComponent.node.active=!1,this.returnButtonComponent.node.active=!1,e.next=5,this.rewardProgressBar.runFillAnimation(t,i,.5);case 5:return e.next=7,this.rewardProgressBar.runReachTargetAnimation();case 7:if((a=ht.getCurrentRewardType(ht.getCurrentRewardLevel(!1)))!==Ct.CHEST){e.next=11;break}return e.next=11,this.openRewardScreen();case 11:St.switchToDashboardScene({screen:We.JOURNEY_LEVEL_SCREEN,screenData:{customData:{completedLevel:ht.getCompletedLevel(),rewardType:a,useNextLevelAnimation:!0},openAnimationName:"FadeInInstant"}});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"processJourneyNormalFlow",value:(u=t(n().mark((function e(t,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.interactable=!0,this.shareButtonComponent.interactable=!0,this.returnButtonComponent.interactable=!0,e.next=5,this.rewardProgressBar.runFillAnimation(t,i,.5);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"close",value:function(){this.nextLevelButtonComponent.interactable=!1,this.shareButtonComponent.interactable=!1,this.firelightParticleSystem.node.active=!1,gt.closeScreen(We.JOURNEY_WINNING_SCREEN)}},{key:"handleClickedNextLevel",value:(l=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ht.canUpdateIncreaseSeason(),e.next=3,Ye.showInterstitialAdAsync();case 3:t?St.switchToDashboardScene():this.goToNextLevel(),this.close();case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleClickedReturn",value:function(){ht.canUpdateIncreaseSeason()?St.switchToDashboardScene():St.switchToDashboardScene({screen:We.JOURNEY_LEVEL_SCREEN,screenData:{completedLevel:ht.getCompletedLevel(),customData:{useNextLevelAnimation:!0},openAnimationName:"FadeInInstant"}}),this.close()}},{key:"handleClickedRetry",value:function(){this.close(),this.node.scene.emit(ny.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close();var e=this.screen.data.level;this.node.scene.emit(ny.NEXT_LEVEL,{level:e})}},{key:"handleClickedShare",value:(s=t(n().mark((function e(){var t,i,a,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.extra||!("shareBestScoreAsync"in GameSDK.extra)){e.next=18;break}return gt.showLoadingScreen(),e.prev=2,t=qX.getPlayer(),i=t.playerId,a=t.name,r=t.photo,t.data,o=at.getPlayerLevel(),e.next=7,YX.wideframe.renderShareScore({playerId:i,playerPhoto:r,playerScore:o});case 7:return s=e.sent,e.next=10,FBInstant.shareAsync({text:"Woohoo! I've never gone this far before!",intent:"SHARE",image:null!=s?s:"",data:{playerId:i,playerName:a,playerPhoto:r,type:"share_invite",level:o}});case 10:KX.event(VX,{share_content_type:"CurrentLevel",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),KX.event(VX,{share_content_type:"CurrentLevel",success:!1}),console.warn(e.t0);case 17:gt.closeLoadingScreen();case 18:case"end":return e.stop()}}),e,null,[[2,13]])}))),function(){return s.apply(this,arguments)})},{key:"goToNextLevel",value:function(){var e=ht.getCurrentMission();at.setLevel(e.gameLevel),rt.switchToJourney(ht.getSeason(),ht.getCurrentLevel()),this.node.scene.emit(ny.NEXT_LEVEL)}},{key:"openRewardScreen",value:function(e){var t=this;return new Promise((function(n){var i={items:[{item:tt.HINT,count:1},{item:tt.SHUFFLE,count:1}],watchAdsDoubleReward:!0,chestId:Mz,successCallback:function(){t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.UNDO,Zm.getItemCount(et[tt.UNDO])),t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE])),null==e||e(),n()},earnFrom:"JourneyWinningScreen"};gt.openScreen(We.REWARD_SCREEN,i)}))}}]),f}(E)).prototype,"titleRibbon",[tX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vX=u(fX.prototype,"titleLabel",[nX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gX=u(fX.prototype,"nextLevelButton",[iX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mX=u(fX.prototype,"shareButtonComponent",[aX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bX=u(fX.prototype,"nextLevelButtonComponent",[rX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SX=u(fX.prototype,"returnButtonComponent",[oX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wX=u(fX.prototype,"rewardProgressBar",[sX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kX=u(fX.prototype,"progressTextLocalize",[lX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TX=u(fX.prototype,"commentTextLocalize",[uX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CX=u(fX.prototype,"firelightParticleSystem",[cX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EX=u(fX.prototype,"blossomParticleSystem",[hX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LX=u(fX.prototype,"blossomParticleSystem2",[dX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pX=fX))||pX)||pX);b._RF.pop(),b._RF.push({},"da829wtTWpCK56Wtj1ASsHP","WinningJourneyBlock",void 0);var JX,ZX,QX,XX,$X,e$,t$,n$,i$,a$,r$,o$,s$,l$,u$,c$=w.ccclass,h$=w.property;AX=c$("WinningJourneyBlock"),_X=h$(x),PX=h$(le),AX((OX=u((NX=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"itemIcon",OX,h(e)),c(e,"checkSpriteFrame",DX,h(e)),e}return o(n,[{key:"onEnable",value:function(){this.updateItemIcon()}},{key:"updateItemIcon",value:function(){var e=ht.getLastMission();if(e){var t=e.type;switch(t){case mt.FIND_ARTIFACT:var n=ht.getJourneyTileSkinIdx(e);this.itemIcon.spriteFrame=ht.getCurrentArtifactTileSprite(n.toString());break;case mt.HIDDEN_TILE:this.itemIcon.spriteFrame=De.getCurrentTileHiddenSprite();break;case mt.TARGET_TILE:this.itemIcon.spriteFrame=this.checkSpriteFrame;break;default:console.warn("Unknown mission type:",t)}}}}]),n}(E)).prototype,"itemIcon",[_X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DX=u(NX.prototype,"checkSpriteFrame",[PX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BX=NX));b._RF.pop(),b._RF.push({},"b5684yl13FPP7/xZ3cHT1wu","LanguageSelection",void 0);var d$,p$,f$,y$,v$,g$=w.ccclass,m$=w.property,b$=w.executeInEditMode,S$=(JX=g$("LanguageSelection"),ZX=b$(!0),QX=m$({visible:!1}),XX=m$({type:T,tooltip:"The locale of the language"}),$X=m$(x),e$=m$(x),t$=m$(D),n$=m$(q),JX(i$=ZX((r$=u((a$=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"_locale",r$,h(e)),c(e,"unselectSprite",o$,h(e)),c(e,"selectedSprite",s$,h(e)),c(e,"button",l$,h(e)),c(e,"label",u$,h(e)),e}return o(n,[{key:"locale",get:function(){return this._locale},set:function(e){try{var t=Je;if(!t.includes(e))throw new Error("Locale ".concat(e," is not available. Available locales: ").concat(t.join(", ")));this._locale=e,this.updateLabelByLocale()}catch(e){console.warn(e)}}},{key:"setSelected",value:function(e){e?(this.unselectSprite.node.active=!1,this.selectedSprite.node.active=!0):(this.unselectSprite.node.active=!0,this.selectedSprite.node.active=!1)}},{key:"setInteractable",value:function(e){this.button.interactable=e}},{key:"updateLabelByLocale",value:function(){switch(this._locale){case"en":this.label.string="English";break;case"ru":this.label.string="";break;case"es":this.label.string="Espaol";break;case"de":this.label.string="Deutsch";break;case"fr":this.label.string="Franais";break;case"pt":this.label.string="Portugus";break;case"it":this.label.string="Italiano";break;case"zh":this.label.string="";break;case"id":this.label.string="Bahasa Indonesia";break;case"ja":this.label.string="";break;case"tr":this.label.string="Trke";break;default:console.warn("Locale ".concat(this._locale," is not supported. Defaulting to English.")),this.label.string="English"}}}]),n}(E)).prototype,"_locale",[QX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a$.prototype,"locale",[XX],Object.getOwnPropertyDescriptor(a$.prototype,"locale"),a$.prototype),o$=u(a$.prototype,"unselectSprite",[$X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s$=u(a$.prototype,"selectedSprite",[e$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l$=u(a$.prototype,"button",[t$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u$=u(a$.prototype,"label",[n$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i$=a$))||i$)||i$);b._RF.pop(),b._RF.push({},"1562eVJKuFFJZOeia8izV5n","LanguagesContent",void 0);var w$,k$,T$,C$,E$,L$,I$,x$,R$=w.ccclass,A$=w.property,_$=Ludex.Events,P$=codex,B$=(P$.event,P$.language),N$=(P$.player,[]),O$=(d$=R$("LanguagesContent"),p$=A$(S$),d$((v$=u((y$=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"languageSelections",v$,h(e)),e}return o(d,[{key:"start",value:function(){var e=B$.getCurrentLocale();e?N$.push(e):N$.push("en")}},{key:"updateSelection",value:function(){var e=B$.getCurrentLocale();this.selectSelection(e)}},{key:"handleSelectedButton",value:(s=t(n().mark((function e(t,i){var a,r,o,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLocale(i)){e.next=2;break}return e.abrupt("return");case 2:if(a=i,!N$.includes(a)){e.next=8;break}return r={locale:a,saveToPlayerData:!0},A.emit(Oe.CHOOSE_LANGUAGE,r),this.selectSelection(a),e.abrupt("return");case 8:gt.showLoadingScreen(),o={locale:a,saveToPlayerData:!0,onLoad:function(e){gt.closeLoadingScreen(),s.selectSelection(a),N$.push(a)}},A.emit(_$.REQUEST_LANGUAGE,o);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"isLocale",value:function(e){return"string"==typeof e&&e.includes(e)}},{key:"selectSelection",value:function(e){var t,n=l(this.languageSelections);try{for(n.s();!(t=n.n()).done;){var i=t.value;i._locale===e?i.setSelected(!0):i.setSelected(!1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleContentScroll",value:function(e,t,n){if(12===t){var i,a=l(this.languageSelections);try{for(a.s();!(i=a.n()).done;){i.value.setInteractable(!1)}}catch(e){a.e(e)}finally{a.f()}}if(9===t){var r,o=l(this.languageSelections);try{for(o.s();!(r=o.n()).done;){r.value.setInteractable(!0)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"setInteractableAllSelections",value:function(e){var t,n=l(this.languageSelections);try{for(n.s();!(t=n.n()).done;){t.value.setInteractable(e)}}catch(e){n.e(e)}finally{n.f()}}}]),d}(E)).prototype,"languageSelections",[p$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f$=y$))||f$);b._RF.pop(),b._RF.push({},"74661Y4mL9JnbO9+sM0x5XB","LanguagesScreen",void 0);var D$,F$,z$,M$,U$,G$,H$,V$=w.ccclass,W$=w.disallowMultiple,q$=w.requireComponent,j$=w.property,K$=Ludex.Events,Y$=codex.event;w$=V$("LanguagesScreen"),k$=q$(Pi),T$=j$(D),C$=j$(O$),w$(E$=W$(E$=k$((I$=u((L$=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"closeButton",I$,h(e)),c(e,"languageContent",x$,h(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("LanguagesScreen: screen not found");e.languageContent.updateSelection()},e.handleOpenedScreen=function(t){e.languageContent.setInteractableAllSelections(!0),e.closeButton.interactable=!0,e.open()},e}return o(n,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.listenScreenEvents()}},{key:"listenScreenEvents",value:function(){Y$.on(K$.OPENING_SCREEN,this.handleOpeningScreen),Y$.on(K$.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Y$.off(K$.OPENING_SCREEN,this.handleOpeningScreen),Y$.off(K$.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"handleClose",value:function(){this.languageContent.setInteractableAllSelections(!1),this.closeButton.interactable=!1;var e=void 0!==this.screen.data.source;gt.closeScreen(We.LANGUAGES_SCREEN,{openNextScreenImmediately:e}),this.screen.data.source?gt.openScreen(this.screen.data.source):this.node.scene.emit(ny.GAME_RESUME)}},{key:"open",value:function(){this.enabled}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}}]),n}(E)).prototype,"closeButton",[T$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x$=u(L$.prototype,"languageContent",[C$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E$=L$))||E$)||E$);b._RF.pop(),b._RF.push({},"7b024d/xQ1BBZV0UpNjM9UQ","LoadingFullScreen",void 0);var J$,Z$,Q$,X$,$$,e0=w.ccclass,t0=w.property,n0=(D$=e0("LoadingFullScreen"),F$=t0(Y),z$=t0(q),D$((G$=u((U$=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"progressBar",G$,h(e)),c(e,"loadingText",H$,h(e)),e}return o(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(N),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"runLoadingTextAnimation",value:function(){var e=this,t=0,n=this.loadingText.string;this.schedule((function(){t=t>2?0:t+1,e.loadingText.string=n+".".repeat(t)}),.5)}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"show",value:(l=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uiOpacity.opacity=0,this.progressBar.progress=0,i=z(this.uiOpacity).to(.2,{opacity:255},{easing:"cubicOut"}),a=z(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"}),this.runLoadingTextAnimation(),Ke.runTweenAsync(i),e.next=8,Ke.runTweenAsync(a);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"hide",value:(s=t(n().mark((function e(t){var i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uiOpacity&&this.progressBar){e.next=2;break}return e.abrupt("return");case 2:return this.uiOpacity.opacity=255,this.progressBar.progress=.9,i=z(this.uiOpacity).to(.15,{opacity:0},{easing:"cubicIn"}),a=z(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"}),this.runLoadingTextAnimation(),e.next=9,Ke.runTweenAsync(a);case 9:return this.stopLoadingTextAnimation(),e.next=12,Ke.runTweenAsync(i);case 12:this.node.active=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})}]),d}(E)).prototype,"progressBar",[F$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H$=u(U$.prototype,"loadingText",[z$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M$=U$))||M$);b._RF.pop(),b._RF.push({},"daa70r49mtGR6iXhcKLcS3q","Loading",void 0);var i0,a0,r0,o0,s0,l0,u0=w.ccclass,c0=w.property;J$=u0("Loading"),Z$=c0(X),J$(($$=u((X$=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"loadingPrefab",$$,h(e)),e.loadingNode=null,e}return o(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){I.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=oe("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=$(this.loadingPrefab));var n=$._clone(this.loadingNode);this.loadingFullScreen=n.getComponent(n0),this.node.active=!1,null===(e=oe("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(l=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.createLoadingFullScreen(),!this.node.active){e.next=3;break}return e.abrupt("return");case 3:return this.node.active=!0,e.next=6,this.loadingFullScreen.show(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"hide",value:(s=t(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=this.node)&&void 0!==i&&i.active){e.next=2;break}return e.abrupt("return");case 2:if(this.loadingFullScreen){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.loadingFullScreen.hide(t);case 6:this.node.active=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})}]),d}(E)).prototype,"loadingPrefab",[Z$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q$=X$));b._RF.pop(),b._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var h0,d0,p0,f0,y0,v0,g0,m0,b0,S0,w0,k0,T0=w.ccclass,C0=w.disallowMultiple,E0=w.requireComponent,L0=w.property,I0=Ludex,x0=I0.Events,R0=I0.Utils.Signal,A0=codex.event;i0=T0("LoadingScreen"),a0=E0(Pi),r0=L0(x),i0(o0=C0(o0=a0((l0=u((s0=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).isClosing=!1,c(e,"sakuraSprite",l0,h(e)),e.signalController=new R0.SignalController,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.isClosing=!1,e.node.setSiblingIndex(xt.LOADING_SCREEN))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.isClosing=!0,e.unscheduleAllCallbacks())},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1,e.isClosing=!1,e.signalController.abort())},e.handleOnCloseScreen=function(){gt.closeScreen(We.LOADING_SCREEN)},e}return o(n,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){A0.on(x0.OPENING_SCREEN,this.handleOpeningScreen),A0.on(x0.OPENED_SCREEN,this.handleOpenedScreen),A0.on(x0.CLOSING_SCREEN,this.handleClosingScreen),A0.on(x0.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){A0.off(x0.OPENING_SCREEN,this.handleOpeningScreen),A0.off(x0.OPENED_SCREEN,this.handleOpenedScreen),A0.off(x0.CLOSING_SCREEN,this.handleClosingScreen),A0.off(x0.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){var e,t=this;if(this.enabled&&!this.isClosing){var n=null!==(e=this.screen.data.duration)&&void 0!==e?e:0,i=this.signalController.renew(),a=z(this.sakuraSprite.node).set({angle:0}).by(2.5,{angle:-360},{easing:ue.linear}).union(),r=z(this.sakuraSprite.node).set({angle:0}).repeatForever(a);i.once((function(){t.node.setRotationFromEuler(0,0,0)})),Ke.runTweenAsync(r,i),n>0&&this.scheduleOnce(this.handleOnCloseScreen,n)}}}]),n}(E)).prototype,"sakuraSprite",[r0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o0=s0))||o0)||o0);b._RF.pop(),b._RF.push({},"15681ka+CZC45B7BdUhsnhF","LoseScreen",void 0);var _0,P0,B0,N0,O0,D0,F0,z0,M0,U0,G0,H0,V0,W0,q0,j0,K0,Y0,J0,Z0,Q0,X0,$0,e1,t1,n1,i1,a1,r1=w.ccclass,o1=w.property,s1=w.disallowMultiple,l1=w.requireComponent,u1=Ludex.Events,c1=codex,h1=c1.event;c1.analytics,c1.player,h0=r1("LoseScreen"),d0=l1(Pi),p0=o1(D),f0=o1(D),y0=o1(D),v0=o1(q),h0(g0=s1(g0=d0((b0=u((m0=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"restartButton",b0,h(e)),c(e,"useShuffleButton",S0,h(e)),c(e,"adShuffleButton",w0,h(e)),c(e,"shuffleCountLabel",k0,h(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("LoseScreen: screen not found");if(e.validateEventPayload(t)){e.restartButton.interactable=!0;var n=Zm.getItemCount(et[tt.SHUFFLE]);n>0?(e.adShuffleButton.node.active=!1,e.adShuffleButton.interactable=!1,e.useShuffleButton.interactable=!0,e.useShuffleButton.node.active=!0,e.shuffleCountLabel.string=n.toString()):(e.adShuffleButton.node.active=!0,e.adShuffleButton.interactable=!0,e.useShuffleButton.interactable=!1,e.useShuffleButton.node.active=!1)}},e.handleOpenedScreen=function(t){e.validateEventPayload(t)},e.logRetry=function(){je.logLevelRetry(Ve[We.LOSE_SCREEN])},e.logRescue=function(){je.logLevelRescue()},e}return o(d,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){h1.on(u1.OPENING_SCREEN,this.handleOpeningScreen),h1.on(u1.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){h1.off(u1.OPENING_SCREEN,this.handleOpeningScreen),h1.off(u1.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.restartButton.interactable=!1,this.useShuffleButton.interactable=!1,this.adShuffleButton.interactable=!1,gt.closeScreen(We.LOSE_SCREEN)}},{key:"handleClickedUseShuffleGame",value:function(){this.node.scene.emit(ny.USE_ITEM,tt.SHUFFLE,!1,d.name),this.node.scene.emit(ny.GAME_RESCUE),this.logRescue(),this.close()}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=at.getLevel(),n=e.getCurrentScore();je.logLevelEnd(t,n,!1)}},{key:"handleClickedAdShuffleGame",value:(l=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye.showRewardVideoAdAsync();case 2:e.sent&&(Zm.addItem(et[tt.SHUFFLE],1),this.node.scene.emit(ny.USE_ITEM,tt.SHUFFLE,!1,d.name),this.node.scene.emit(ny.GAME_RESCUE),this.logRescue(),this.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleClickedRestartGame",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye.showInterstitialAdAsync();case 2:this.close(),this.logRetry(),this.logEndGame(),this.replayGame();case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"replayGame",value:function(){this.node.scene.emit(ny.GAME_REPLAY)}}]),d}(E)).prototype,"restartButton",[p0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S0=u(m0.prototype,"useShuffleButton",[f0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w0=u(m0.prototype,"adShuffleButton",[y0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k0=u(m0.prototype,"shuffleCountLabel",[v0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g0=m0))||g0)||g0);b._RF.pop(),b._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var d1,p1,f1,y1,v1,g1,m1,b1,S1,w1,k1,T1,C1,E1,L1,I1,x1,R1,A1,_1,P1,B1,N1,O1,D1,F1,z1=w.ccclass,M1=w.disallowMultiple,U1=w.requireComponent,G1=w.property,H1=Ludex,V1=H1.Events,W1=H1.Utils,q1=codex,j1=q1.event,K1=q1.language;_0=z1("NotificationScreen"),P0=U1(Pi),B0=G1(R),N0=G1(R),O0=G1(q),D0=G1(Bd),F0=G1(D),z0=G1(H),M0=G1(D),U0=G1(Q),G0=G1(Q),_0(H0=M1(H0=P0((W0=u((V0=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"popupUiTransform",W0,h(e)),c(e,"messageUiTransform",q0,h(e)),c(e,"message",j0,h(e)),c(e,"messageLocalize",K0,h(e)),c(e,"closeButton",Y0,h(e)),c(e,"closeButtonWidget",J0,h(e)),c(e,"touchZone",Z0,h(e)),c(e,"originalMessageSize",Q0,h(e)),c(e,"maxMessageWidth",X0,h(e)),c(e,"minStretchCheckMessageHeight",$0,h(e)),c(e,"stretchWidthIterations",e1,h(e)),c(e,"minPopupWidth",t1,h(e)),c(e,"minPopupHeight",n1,h(e)),c(e,"maxPopupWidth",i1,h(e)),c(e,"messagePopupPadding",a1,h(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.closeButton.interactable=!0,e.touchZone.interactable=!0,e.node.setSiblingIndex(xt.NOTIFICATION_SCREEN))},e.handleOpenedScreen=function(t){if(e.validateEventPayload(t)&&t.screenData.message){for(e.message.overflow=q.Overflow.RESIZE_HEIGHT,e.messageUiTransform.setContentSize(e.originalMessageSize.x,e.originalMessageSize.y),e.message.updateRenderData(!0);e.messageUiTransform.contentSize.y>=e.minStretchCheckMessageHeight&&e.messageUiTransform.contentSize.x<e.maxMessageWidth;)e.messageUiTransform.setContentSize(e.messageUiTransform.contentSize.x+e.stretchWidthIterations,e.messageUiTransform.contentSize.y),e.message.updateRenderData(!0);var n=ee.clamp(e.messageUiTransform.contentSize.x+e.messagePopupPadding.x,e.minPopupWidth,e.maxPopupWidth),i=Math.max(e.minPopupHeight,e.messageUiTransform.contentSize.y+e.messagePopupPadding.y);e.popupUiTransform.setContentSize(n,i),e.closeButtonWidget.updateAlignment()}},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.closeButton.interactable=!1,e.touchZone.interactable=!1)},e}return o(n,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){j1.on(V1.OPENING_SCREEN,this.handleOpeningScreen),j1.on(V1.OPENED_SCREEN,this.handleOpenedScreen),j1.on(V1.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){j1.off(V1.OPENING_SCREEN,this.handleOpeningScreen),j1.off(V1.OPENED_SCREEN,this.handleOpenedScreen),j1.off(V1.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;W1.Valid.isObject(t)?(t.message&&(K1.hasTextKey(t.message)?this.messageLocalize.key=t.message:this.message.string=t.message),t.duration&&t.duration>0&&this.scheduleOnce((function(){gt.closeScreen(We.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),gt.closeScreen(We.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),n}(E)).prototype,"popupUiTransform",[B0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q0=u(V0.prototype,"messageUiTransform",[N0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0=u(V0.prototype,"message",[O0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0=u(V0.prototype,"messageLocalize",[D0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y0=u(V0.prototype,"closeButton",[F0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J0=u(V0.prototype,"closeButtonWidget",[z0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z0=u(V0.prototype,"touchZone",[M0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q0=u(V0.prototype,"originalMessageSize",[U0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(550,150)}}),X0=u(V0.prototype,"maxMessageWidth",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),$0=u(V0.prototype,"minStretchCheckMessageHeight",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),e1=u(V0.prototype,"stretchWidthIterations",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),t1=u(V0.prototype,"minPopupWidth",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 700}}),n1=u(V0.prototype,"minPopupHeight",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),i1=u(V0.prototype,"maxPopupWidth",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),a1=u(V0.prototype,"messagePopupPadding",[G0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Q(200,200)}}),H0=V0))||H0)||H0);b._RF.pop(),b._RF.push({},"15d8eqh3ShJsp+VfeIUR9VN","OptionsScreen",void 0);var Y1,J1,Z1,Q1,X1,$1,e2,t2,n2,i2,a2,r2,o2,s2,l2,u2,c2,h2,d2,p2,f2,y2,v2,g2,m2,b2,S2,w2,k2=w.ccclass,T2=w.property,C2=w.requireComponent,E2=Ludex,L2=E2.Events,I2=E2.Utils,x2=codex,R2=x2.player,A2=x2.event,_2=x2.analytics;d1=k2("OptionsScreen"),p1=C2(Pi),f1=T2(D),y1=T2(D),v1=T2(D),g1=T2(D),m1=T2(ce),b1=T2(ih),S1=T2(ih),w1=T2(ih),k1=T2(ih),T1=T2(D),C1=T2({type:[P]}),d1(E1=p1((I1=u((L1=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"themeButtonContainer",I1,h(e)),c(e,"noAdsButtonContainer",x1,h(e)),c(e,"languageButtonContainer",R1,h(e)),c(e,"joinFacebookButtonContainer",A1,h(e)),c(e,"settingButtonLayout",_1,h(e)),c(e,"musicSwitch",P1,h(e)),c(e,"soundSwitch",B1,h(e)),c(e,"vibrateSwitch",N1,h(e)),c(e,"highLightSwitch",O1,h(e)),c(e,"closeButtonComponent",D1,h(e)),c(e,"fbPageElements",F1,h(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.themeButtonContainer.interactable=!0,e.noAdsButtonContainer.interactable=!0,e.languageButtonContainer.interactable=!0,e.joinFacebookButtonContainer.interactable=!0,e.musicSwitch.button.interactable=!0,e.soundSwitch.button.interactable=!0,e.vibrateSwitch.button.interactable=!0,e.highLightSwitch.button.interactable=!0,e.updateStatus())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!1,e.themeButtonContainer.interactable=!1,e.noAdsButtonContainer.interactable=!1,e.languageButtonContainer.interactable=!1,e.joinFacebookButtonContainer.interactable=!1,e.musicSwitch.button.interactable=!1,e.soundSwitch.button.interactable=!1,e.vibrateSwitch.button.interactable=!1,e.highLightSwitch.button.interactable=!1)},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){var n=t.code,i=_f.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(_f.Events.UNLOCK_DEV_TOOLS),e.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE)))},e.updateVibrateButton=function(){if(I2.Device.isMobile()){var t,n=null!==(t=R2.getPlayerSetting("vibrate"))&&void 0!==t&&t;e.vibrateSwitch.setEnabled(n)}else e.vibrateSwitch.node.active=!1;e.settingButtonLayout.updateLayout(!0)},e}return o(n,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.handleGameDistributionUIChanges(),this.updateFBPageFeatures()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleGameDistributionUIChanges",value:function(){"GameDistributions"===GameSDK.getSDKName()&&(this.vibrateSwitch.node.active=!1,this.settingButtonLayout.updateLayout(!0))}},{key:"listenScreenEvents",value:function(){A2.on(L2.OPENING_SCREEN,this.handleOpeningScreen),A2.on(L2.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){A2.off(L2.OPENING_SCREEN,this.handleOpeningScreen),A2.off(L2.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(_f.Events.TRIGGER_UNLOCK_KEY),this.node.on(_f.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(_f.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(_f.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(_f.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE),gt.closeScreen(We.OPTIONS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i,a={music:null!==(e=R2.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=R2.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=R2.getPlayerSetting("vibrate"))&&void 0!==n&&n,highLight:null!==(i=R2.getPlayerSetting("highLight"))&&void 0!==i&&i};this.musicSwitch?this.soundSwitch?this.highLightSwitch?(this.musicSwitch.setEnabled(a.music),this.soundSwitch.setEnabled(a.sound),this.highLightSwitch.setEnabled(a.highLight),this.vibrateSwitch.setEnabled(a.vibrate),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: highLightSwitch not found"):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("SettingsScreen: screen not found")}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();R2.setSetting("music",e),this.node.emit(_f.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e?Ge.playMusic():Ge.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();R2.setSetting("sound",e),this.node.emit(_f.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();R2.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"switchHighLightButton",value:function(){if(this.highLightSwitch){var e=this.highLightSwitch.switch();R2.setSetting("highLight",e)}else console.warn("SettingsScreen: highLightSwitch not found")}},{key:"handleClickedClose",value:function(e,t){this.close()}},{key:"handleClickedJoinFacebookGroup",value:function(){GameSDK.extra&&"joinOfficialGroupAsync"in GameSDK.extra&&(GameSDK.extra.joinOfficialGroupAsync().catch((function(e){console.error("joinFacebookGroup failed",e)})),_2.event(it.GROUP_JOIN))}},{key:"handleClickFollowPage",value:function(){GameSDK.extra&&"followOfficialPageAsync"in GameSDK.extra&&(GameSDK.extra.followOfficialPageAsync().catch((function(e){console.error("followOfficialPage failed",e)})),_2.event(it.PAGE_FOLLOW))}},{key:"handleClickedTheme",value:function(){this.close(),gt.openScreen(We.THEME_SCREEN,{source:We.OPTIONS_SCREEN})}},{key:"handleClickedNoAds",value:function(){this.close(),gt.openScreen(We.SHOP_SCREEN,{source:We.OPTIONS_SCREEN})}},{key:"handleClickedLanguage",value:function(){this.close(),gt.openScreen(We.LANGUAGES_SCREEN,{source:We.OPTIONS_SCREEN})}},{key:"updateFBPageFeatures",value:function(){var e,t=hF.isFBPageFeatureAvailable(),n=l(this.fbPageElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}}]),n}(E)).prototype,"themeButtonContainer",[f1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x1=u(L1.prototype,"noAdsButtonContainer",[y1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R1=u(L1.prototype,"languageButtonContainer",[v1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A1=u(L1.prototype,"joinFacebookButtonContainer",[g1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_1=u(L1.prototype,"settingButtonLayout",[m1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P1=u(L1.prototype,"musicSwitch",[b1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B1=u(L1.prototype,"soundSwitch",[S1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N1=u(L1.prototype,"vibrateSwitch",[w1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O1=u(L1.prototype,"highLightSwitch",[k1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D1=u(L1.prototype,"closeButtonComponent",[T1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F1=u(L1.prototype,"fbPageElements",[C1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E1=L1))||E1);b._RF.pop(),b._RF.push({},"a29a3R+SwZAqZVhE3htl6VV","RewardScreenData",void 0),b._RF.pop(),b._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var P2,B2,N2,O2,D2,F2,z2,M2,U2,G2,H2,V2=w.ccclass,W2=w.property,q2=w.requireComponent,j2=Ludex,K2=j2.Events,Y2=j2.Utils,J2=codex,Z2=J2.player,Q2=J2.event,X2=J2.analytics;Y1=V2("SettingsScreen"),J1=q2(Pi),Z1=W2(D),Q1=W2(D),X1=W2(D),$1=W2(D),e2=W2(ce),t2=W2(ih),n2=W2(ih),i2=W2(ih),a2=W2(ih),r2=W2(D),o2=W2(D),s2=W2({type:[P]}),Y1(l2=J1((c2=u((u2=function(e){i(d,e);var s,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"themeButtonContainer",c2,h(e)),c(e,"noAdsButtonContainer",h2,h(e)),c(e,"languageButtonContainer",d2,h(e)),c(e,"joinFacebookGroupButton",p2,h(e)),c(e,"settingButtonLayout",f2,h(e)),c(e,"musicSwitch",y2,h(e)),c(e,"soundSwitch",v2,h(e)),c(e,"vibrateSwitch",g2,h(e)),c(e,"highLightSwitch",m2,h(e)),c(e,"restartButtonComponent",b2,h(e)),c(e,"closeButtonComponent",S2,h(e)),c(e,"fbPageElements",w2,h(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.restartButtonComponent.interactable=!0,e.themeButtonContainer.interactable=!0,e.noAdsButtonContainer.interactable=!0,e.languageButtonContainer.interactable=!0,e.joinFacebookGroupButton.interactable=!0,e.musicSwitch.button.interactable=!0,e.soundSwitch.button.interactable=!0,e.vibrateSwitch.button.interactable=!0,e.highLightSwitch.button.interactable=!0,e.updateStatus())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!1,e.restartButtonComponent.interactable=!1,e.themeButtonContainer.interactable=!1,e.noAdsButtonContainer.interactable=!1,e.languageButtonContainer.interactable=!1,e.joinFacebookGroupButton.interactable=!1,e.musicSwitch.button.interactable=!1,e.soundSwitch.button.interactable=!1,e.vibrateSwitch.button.interactable=!1,e.highLightSwitch.button.interactable=!1)},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){var n=t.code,i=_f.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(_f.Events.UNLOCK_DEV_TOOLS),e.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE)))},e.updateVibrateButton=function(){if(Y2.Device.isMobile()){var t,n=null!==(t=Z2.getPlayerSetting("vibrate"))&&void 0!==t&&t;e.vibrateSwitch.setEnabled(n)}else e.vibrateSwitch.node.active=!1;e.settingButtonLayout.updateLayout(!0)},e.logRetry=function(){var e=Ve[We.SETTINGS_SCREEN];je.logLevelRetry(e)},e}return o(d,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.handleGameDistributionUIChanges(),this.updateFBPageFeatures()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"gameScene",get:function(){var e,t=null===(e=oe("Canvas"))||void 0===e?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"handleGameDistributionUIChanges",value:function(){"GameDistributions"===GameSDK.getSDKName()&&(this.vibrateSwitch.node.active=!1,this.settingButtonLayout.updateLayout(!0))}},{key:"listenScreenEvents",value:function(){Q2.on(K2.OPENING_SCREEN,this.handleOpeningScreen),Q2.on(K2.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){Q2.off(K2.OPENING_SCREEN,this.handleOpeningScreen),Q2.off(K2.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(_f.Events.TRIGGER_UNLOCK_KEY),this.node.on(_f.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(_f.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(_f.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(_f.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.node.emit(_f.Events.TRIGGER_RESET_SEQUENCE),gt.closeScreen(We.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i,a={music:null!==(e=Z2.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=Z2.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=Z2.getPlayerSetting("vibrate"))&&void 0!==n&&n,highLight:null!==(i=Z2.getPlayerSetting("highLight"))&&void 0!==i&&i};this.musicSwitch?this.soundSwitch?this.highLightSwitch?(this.musicSwitch.setEnabled(a.music),this.soundSwitch.setEnabled(a.sound),this.highLightSwitch.setEnabled(a.highLight),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: highLightSwitch not found"):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("SettingsScreen: screen not found")}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();Z2.setSetting("music",e),this.node.emit(_f.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e?Ge.playMusic():Ge.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();Z2.setSetting("sound",e),this.node.emit(_f.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchHighLightButton",value:function(){if(this.highLightSwitch){var e=this.highLightSwitch.switch();Z2.setSetting("highLight",e)}else console.warn("SettingsScreen: highLightSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();Z2.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){console.log("SettingsScreen: handleClickedClose"),this.close(),this.node.scene.emit(ny.GAME_RESUME)}},{key:"handleClickedTheme",value:function(){this.close(),gt.openScreen(We.THEME_SCREEN,{source:We.SETTINGS_SCREEN})}},{key:"handleClickedNoAds",value:function(){this.close(),gt.openScreen(We.SHOP_SCREEN,{source:We.SETTINGS_SCREEN})}},{key:"handleClickedLanguage",value:function(){this.close(),gt.openScreen(We.LANGUAGES_SCREEN,{source:We.SETTINGS_SCREEN})}},{key:"handleClickedJoinFacebookGroup",value:function(){GameSDK.extra&&"joinOfficialGroupAsync"in GameSDK.extra&&(GameSDK.extra.joinOfficialGroupAsync().catch((function(e){console.error("joinFacebookGroup failed",e)})),X2.event(it.GROUP_JOIN))}},{key:"handleClickFollowPage",value:function(){GameSDK.extra&&"followOfficialPageAsync"in GameSDK.extra&&(GameSDK.extra.followOfficialPageAsync().catch((function(e){console.error("followOfficialPage failed",e)})),X2.event(it.PAGE_FOLLOW))}},{key:"handleClickedRestart",value:(s=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye.showInterstitialAdAsync();case 2:this.close(),this.replayGame();case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"replayGame",value:function(){this.logRetry(),this.logEndGame(),this.node.scene.emit(ny.GAME_RESUME),this.node.scene.emit(ny.GAME_REPLAY)}},{key:"logEndGame",value:function(){var e=this.gameScene.gameplay.scoreManager,t=at.getLevel(),n=e.getCurrentScore();je.logLevelEnd(t,n,!1)}},{key:"updateFBPageFeatures",value:function(){var e,t=hF.isFBPageFeatureAvailable(),n=l(this.fbPageElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}this.settingButtonLayout.updateLayout(!0)}}]),d}(E)).prototype,"themeButtonContainer",[Z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h2=u(u2.prototype,"noAdsButtonContainer",[Q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d2=u(u2.prototype,"languageButtonContainer",[X1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p2=u(u2.prototype,"joinFacebookGroupButton",[$1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f2=u(u2.prototype,"settingButtonLayout",[e2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y2=u(u2.prototype,"musicSwitch",[t2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v2=u(u2.prototype,"soundSwitch",[n2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g2=u(u2.prototype,"vibrateSwitch",[i2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m2=u(u2.prototype,"highLightSwitch",[a2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b2=u(u2.prototype,"restartButtonComponent",[r2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S2=u(u2.prototype,"closeButtonComponent",[o2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w2=u(u2.prototype,"fbPageElements",[s2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l2=u2))||l2);b._RF.pop(),b._RF.push({},"9e813bKJYpE0Yj2E0IHsyJQ","Version",void 0);var $2,e5,t5,n5,i5,a5,r5,o5,s5,l5,u5,c5,h5,d5=w.ccclass,p5=w.property;Ludex.Events,codex.event,P2=d5("Version"),B2=p5(q),N2=p5(Bd),O2=p5(R),D2=p5(R),P2((M2=u((z2=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"versionLabel",M2,h(e)),c(e,"versionLabelLocalize",U2,h(e)),c(e,"versionLabelTransform",G2,h(e)),c(e,"underlineTransform",H2,h(e)),e}return o(n,[{key:"start",value:function(){var e=codex.getBuildVersion();this.versionLabelLocalize.setParams([e.toString()])}},{key:"onEnable",value:function(){var e=this;this.scheduleOnce((function(){e.updateUnderline()}),.05)}},{key:"updateUnderline",value:function(){this.underlineTransform.setContentSize(this.versionLabelTransform.contentSize.width,this.underlineTransform.contentSize.height)}}]),n}(E)).prototype,"versionLabel",[B2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U2=u(z2.prototype,"versionLabelLocalize",[N2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G2=u(z2.prototype,"versionLabelTransform",[O2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H2=u(z2.prototype,"underlineTransform",[D2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F2=z2));b._RF.pop(),b._RF.push({},"cbd8fx4oOZAjI4kdkrvUv/t","CollectionProduct",void 0);var f5,y5,v5,g5,m5,b5,S5,w5,k5,T5,C5,E5,L5,I5,x5,R5,A5,_5,P5,B5,N5,O5,D5,F5,z5,M5,U5=w.ccclass,G5=w.property,H5=($2=U5("CollectionProduct"),e5=G5(N),t5=G5(D),n5=G5(Bd),i5=G5(q),a5=G5(q),$2((s5=u((o5=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"buyButtonOpacity",s5,h(e)),c(e,"buyButton",l5,h(e)),c(e,"priceLocalize",u5,h(e)),c(e,"firstItemLabel",c5,h(e)),c(e,"secondItemLabel",h5,h(e)),e}return o(n,[{key:"setInteractable",value:function(e){this.buyButton.interactable=e}},{key:"setPrice",value:function(e){this.buyButtonOpacity.opacity=255,this.priceLocalize.key="customString",this.priceLocalize.setParams([e])}},{key:"setLoadingPrice",value:function(){this.buyButtonOpacity.opacity=100,this.priceLocalize.key="loading"}},{key:"setItemCounts",value:function(e,t){this.firstItemLabel.string="x".concat(e.toString()),this.secondItemLabel.string="x".concat(t.toString())}}]),n}(E)).prototype,"buyButtonOpacity",[e5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l5=u(o5.prototype,"buyButton",[t5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u5=u(o5.prototype,"priceLocalize",[n5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c5=u(o5.prototype,"firstItemLabel",[i5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h5=u(o5.prototype,"secondItemLabel",[a5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r5=o5))||r5);b._RF.pop(),b._RF.push({},"038406q2A1LUoahVQ4/xUuD","ShopScreen",void 0);var V5,W5,q5,j5,K5,Y5,J5,Z5,Q5,X5,$5,e3,t3,n3,i3,a3=w.ccclass,r3=w.property,o3=w.requireComponent,s3=Ludex,l3=s3.Events,u3=(s3.Utils,codex),c3=u3.player,h3=u3.event;f5=a3("ShopScreen"),y5=o3(Pi),v5=r3(D),g5=r3(H5),m5=r3(H5),b5=r3(H5),S5=r3({type:[P]}),w5=r3(D),k5=r3(D),T5=r3(Bd),C5=r3(Bd),E5=r3(q),L5=r3(q),f5(I5=y5((R5=u((x5=function(e){i(b,e);var s,u,d,p,f,y,v,g,m=a(b);function b(){var e;r(this,b);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=m.call.apply(m,[this].concat(a)),c(e,"closeButtonComponent",R5,h(e)),c(e,"freeCollectionProduct",A5,h(e)),c(e,"collectionProductCombo10",_5,h(e)),c(e,"collectionProductCombo50",P5,h(e)),c(e,"inAppPurchaseElements",B5,h(e)),c(e,"buyButtonComponent",N5,h(e)),c(e,"detailsButtonComponent",O5,h(e)),c(e,"priceLocalize",D5,h(e)),c(e,"removeAdsTextLocalize",F5,h(e)),c(e,"freeText",z5,h(e)),c(e,"timerText",M5,h(e)),e.catalog=null,e.isScheduling=!1,e.handleOpeningScreen=function(){var i=t(n().mark((function t(i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(i)){t.next=2;break}return t.abrupt("return");case 2:if(e.updateButtonText(),eb.getTimeLeftToWatchAdsInShop()>0&&(e.schedule(e.updateButtonText,1),e.isScheduling=!0),e.catalog){t.next=11;break}return gt.showLoadingScreen(),t.next=9,qO.getCatalogAsync();case 9:e.catalog=t.sent,gt.closeLoadingScreen();case 11:e.updateNoAdsPriceProduct(),e.updateCollectionProducts(),e.closeButtonComponent.interactable=!0,e.buyButtonComponent.interactable=!0,e.detailsButtonComponent.interactable=!0,e.collectionProductCombo10.setInteractable(!0),e.collectionProductCombo50.setInteractable(!0),e.updateNoAdsContent(),e.logViewItemList();case 20:case"end":return t.stop()}}),t)})));return function(e){return i.apply(this,arguments)}}(),e}return o(b,[{key:"__preload",value:(g=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)})},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.updateCount(),this.updateShopFeatures()}},{key:"updateButtonText",value:function(){var e=eb.getTimeLeftToWatchAdsInShop();0===e?(this.freeText.node.active=!0,this.timerText.node.active=!1,this.freeCollectionProduct.setInteractable(!0),this.isScheduling&&(this.unschedule(this.updateButtonText),this.isScheduling=!1)):(this.freeText.node.active=!1,this.timerText.node.active=!0,this.timerText.string=nt(e,!1),this.freeCollectionProduct.setInteractable(!1))}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){h3.on(l3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){h3.off(l3.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"updateCount",value:function(){this.freeCollectionProduct.setItemCounts(WO.SHUFFLE_ITEM_COUNT,WO.HINT_ITEM_COUNT),this.collectionProductCombo10.setItemCounts(HO.SHUFFLE_ITEM_COUNT,HO.HINT_ITEM_COUNT),this.collectionProductCombo50.setItemCounts(VO.SHUFFLE_ITEM_COUNT,VO.HINT_ITEM_COUNT)}},{key:"updateNoAdsPriceProduct",value:function(){var e,t=null===(e=this.catalog)||void 0===e?void 0:e.find((function(e){return e.productID===GO.ID}));this.priceLocalize.key="customString",t?this.priceLocalize.setParams([t.price]):this.priceLocalize.setParams(["???"])}},{key:"updateCollectionProducts",value:function(){var e,t,n=null===(e=this.catalog)||void 0===e?void 0:e.find((function(e){return e.productID===HO.ID}));n?this.collectionProductCombo10.setPrice(n.price):this.collectionProductCombo10.setPrice("???");var i=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===VO.ID}));i?this.collectionProductCombo50.setPrice(i.price):this.collectionProductCombo50.setPrice("???")}},{key:"updateNoAdsContent",value:function(){if(console.log(c3.getGameData().removeAdEndTime-Date.now()),Ye.isInterstitialRemoved()){this.disableBuyButton();var e=Ye.getRemoveAdDayLeft();1===e?this.removeAdsTextLocalize.key="removedFor1Day":(this.removeAdsTextLocalize.key="removedForVDays",this.removeAdsTextLocalize.setParams([e.toString()]))}else this.enableBuyButton(),this.removeAdsTextLocalize.key="removeAdsFor30Days"}},{key:"disableBuyButton",value:function(){this.buyButtonComponent.interactable=!1,this.buyButtonComponent.getComponent(N).opacity=100,this.priceLocalize.key="purchased"}},{key:"enableBuyButton",value:(v=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.catalog){e.next=7;break}return this.buyButtonComponent.interactable=!1,this.buyButtonComponent.getComponent(N).opacity=100,this.priceLocalize.key="loading",e.next=6,qO.getCatalogAsync();case 6:this.catalog=e.sent;case 7:this.buyButtonComponent.interactable=!0,this.buyButtonComponent.getComponent(N).opacity=255,this.updateNoAdsPriceProduct();case 10:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.buyButtonComponent.interactable=!1,this.detailsButtonComponent.interactable=!1,this.freeCollectionProduct.setInteractable(!1),this.collectionProductCombo10.setInteractable(!1),this.collectionProductCombo50.setInteractable(!1),this.isScheduling&&(this.unschedule(this.updateButtonText),this.isScheduling=!1),gt.closeScreen(We.SHOP_SCREEN)}},{key:"handleClickedClose",value:function(){if(this.close(),this.screen.data.source){if(this.screen.data.source===We.FREE_ITEM_SCREEN)return;gt.openScreen(this.screen.data.source)}else this.node.scene.emit(ny.GAME_RESUME)}},{key:"handleClickedBuyNoAds",value:(y=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,gt.showLoadingScreen(),this.logSelectItem(GO.ID),e.next=5,this.processPurchase(GO.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),gt.closeLoadingScreen(),this.updateNoAdsContent(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return y.apply(this,arguments)})},{key:"handleClickedCombo10",value:(f=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,gt.showLoadingScreen(),this.logSelectItem(HO.ID),e.next=5,this.processPurchase(HO.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),gt.closeLoadingScreen(),this.handleConsumeComboPurchase(HO.ID),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return f.apply(this,arguments)})},{key:"handleClickedCombo50",value:(p=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,gt.showLoadingScreen(),this.logSelectItem(VO.ID),e.next=5,this.processPurchase(VO.ID);case 5:t=e.sent,this.logPurchaseSuccess(t),gt.closeLoadingScreen(),this.handleConsumeComboPurchase(VO.ID),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.handleClosePurchase(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return p.apply(this,arguments)})},{key:"handleAdsWatchForFreeItem",value:(d=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(eb.canWatchAds("shop")){e.next=3;break}return gt.showNotificationScreen("youHaveReachedTheDailyAdLimit",3),e.abrupt("return");case 3:return e.next=5,Ye.showRewardVideoAdAsync({contextType:"reward",forceLoad:!0});case 5:e.sent&&(eb.watchedAds("shop"),this.logSelectItem(WO.ID),this.showRewardScreen(WO.HINT_ITEM_COUNT,WO.SHUFFLE_ITEM_COUNT,WO.ID,!1,Mz),this.updateButtonText(),eb.getTimeLeftToWatchAdsInShop()>0&&(this.schedule(this.updateButtonText,1),this.isScheduling=!0));case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handleClosePurchase",value:function(e){console.error("Purchase failed:",e),gt.closeLoadingScreen();var t=e instanceof Error?e.message:"purchaseFailed";gt.showNotificationScreen(t,3),this.logPurchaseCancel(t)}},{key:"handleClickedDetails",value:function(){gt.showNotificationScreen("removeAdPolicy")}},{key:"processPurchase",value:(u=t(n().mark((function e(t){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qO.purchaseAsync(t);case 2:return i=e.sent,e.next=5,qO.consumePurchaseAsync(t,i.purchaseToken);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"handleConsumeComboPurchase",value:(s=t(n().mark((function e(t){var i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===HO.ID||t===VO.ID){e.next=2;break}return e.abrupt("return");case 2:if(null!==this.catalog){e.next=8;break}return this.collectionProductCombo10.setLoadingPrice(),this.collectionProductCombo50.setLoadingPrice(),e.next=7,qO.getCatalogAsync();case 7:this.catalog=e.sent;case 8:if(this.collectionProductCombo10.setInteractable(!0),this.collectionProductCombo50.setInteractable(!0),null===(i=this.catalog)||void 0===i?void 0:i.find((function(e){return e.productID===t}))){e.next=13;break}return e.abrupt("return");case 13:t===HO.ID?(a=HO.SHUFFLE_ITEM_COUNT,r=HO.HINT_ITEM_COUNT,this.showRewardScreen(r,a,t,!0,Uz)):(a=VO.SHUFFLE_ITEM_COUNT,r=VO.HINT_ITEM_COUNT,this.showRewardScreen(r,a,t,!0,Gz));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"showRewardScreen",value:function(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,o={items:[{item:tt.HINT,count:e},{item:tt.SHUFFLE,count:t}],watchAdsDoubleReward:!1,title:"You have received",chestId:r,doNotUpdatePlayerData:a,successCallback:function(){i.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),i.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE]))},earnFrom:Ve[We.SHOP_SCREEN]};gt.openScreen(We.REWARD_SCREEN,o)}},{key:"logViewItemList",value:function(){codex.analytics.event(it.VIEW_ITEM_LIST)}},{key:"logSelectItem",value:function(e){codex.analytics.event(it.SELECT_ITEM,{product_id:e})}},{key:"logPurchaseSuccess",value:function(e){var t,n=e.productID,i=e.purchaseToken,a=e.purchaseTime,r=e.paymentID,o=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===n}));o&&codex.analytics.event(it.PURCHASE,{product_id:n,purchase_token:i,purchase_time:a,payment_id:r,price:o.priceAmount,currency:o.priceCurrencyCode,product_name:o.title})}},{key:"logPurchaseCancel",value:function(e){var t,n=null===(t=this.catalog)||void 0===t?void 0:t.find((function(e){return e.productID===GO.ID}));n&&codex.analytics.event(it.PURCHASE_CANCEL,{product_id:n.productID,price:n.priceAmount,currency:n.priceCurrencyCode,product_name:n.title,error_message:e})}},{key:"updateShopFeatures",value:function(){var e,t=hF.isIAPFeatureAvailable(),n=l(this.inAppPurchaseElements);try{for(n.s();!(e=n.n()).done;){e.value.active=t}}catch(e){n.e(e)}finally{n.f()}}}]),b}(E)).prototype,"closeButtonComponent",[v5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A5=u(x5.prototype,"freeCollectionProduct",[g5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_5=u(x5.prototype,"collectionProductCombo10",[m5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P5=u(x5.prototype,"collectionProductCombo50",[b5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B5=u(x5.prototype,"inAppPurchaseElements",[S5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N5=u(x5.prototype,"buyButtonComponent",[w5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O5=u(x5.prototype,"detailsButtonComponent",[k5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D5=u(x5.prototype,"priceLocalize",[T5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F5=u(x5.prototype,"removeAdsTextLocalize",[C5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z5=u(x5.prototype,"freeText",[E5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M5=u(x5.prototype,"timerText",[L5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I5=x5))||I5);b._RF.pop(),b._RF.push({},"2bac24dA51Or6QUQ/IlKDo4","BackgroundContent",void 0);var d3,p3,f3,y3,v3,g3,m3,b3,S3,w3,k3,T3,C3,E3,L3,I3,x3,R3=w.ccclass,A3=w.property,_3=(V5=R3("BackgroundContent"),W5=A3(P),q5=A3(P),j5=A3(P),K5=A3(P),Y5=A3(P),J5=A3(P),V5((X5=u((Q5=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"bg1Selector",X5,h(e)),c(e,"bg2Selector",$5,h(e)),c(e,"bg3Selector",e3,h(e)),c(e,"bg4Selector",t3,h(e)),c(e,"bg5Selector",n3,h(e)),c(e,"bg6Selector",i3,h(e)),e}return o(u,[{key:"__preload",value:function(){}},{key:"updateBackground",value:function(e){Object.values(kt).includes(e)&&(this.unselectAllBackgroundButtons(),this.selectBackgroundButton(e))}},{key:"handleClickedBackgroundButton",value:(s=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i,Object.values(kt).includes(a)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,De.updateBackgroundKey(a);case 5:this.updateBackground(i),this.node.scene.emit(ny.THEME_BACKGROUND_CHANGE),De.logThemeBackgroundChange(a);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"unselectAllBackgroundButtons",value:function(){this.bg1Selector.active=!1,this.bg2Selector.active=!1,this.bg3Selector.active=!1,this.bg4Selector.active=!1,this.bg5Selector.active=!1,this.bg6Selector.active=!1}},{key:"selectBackgroundButton",value:function(e){e===kt.BG1?this.bg1Selector.active=!0:e===kt.BG2?this.bg2Selector.active=!0:e===kt.BG3?this.bg3Selector.active=!0:e===kt.BG4?this.bg4Selector.active=!0:e===kt.BG5?this.bg5Selector.active=!0:e===kt.BG6&&(this.bg6Selector.active=!0)}}]),u}(E)).prototype,"bg1Selector",[W5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$5=u(Q5.prototype,"bg2Selector",[q5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e3=u(Q5.prototype,"bg3Selector",[j5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t3=u(Q5.prototype,"bg4Selector",[K5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n3=u(Q5.prototype,"bg5Selector",[Y5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i3=u(Q5.prototype,"bg6Selector",[J5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z5=Q5))||Z5);b._RF.pop(),b._RF.push({},"85735WG2ORGvKtf3/fzWGvh","Tab",void 0);var P3,B3,N3,O3,D3,F3,z3,M3,U3,G3,H3,V3,W3,q3=w.ccclass,j3=w.property,K3=(Ludex.Events,codex.event,d3=q3("Tab"),p3=j3(x),f3=j3(D),y3=j3(D),v3=j3(q),g3=j3(q),m3=j3(P),b3=j3(P),d3((k3=u((w3=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"tabSprite",k3,h(e)),c(e,"tileButton",T3,h(e)),c(e,"backgroundButton",C3,h(e)),c(e,"tileLabel",E3,h(e)),c(e,"backgroundLabel",L3,h(e)),c(e,"tileNode",I3,h(e)),c(e,"backgroundNode",x3,h(e)),e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"handleClickedTileButton",value:function(){this.tabSprite.node.setScale(-1,1,1),this.tileButton.node.active=!1,this.backgroundButton.node.active=!0,this.tileLabel.node.active=!0,this.backgroundLabel.node.active=!1,this.switchToTileNode()}},{key:"handleClickedBackgroundButton",value:function(){this.tabSprite.node.setScale(1,1,1),this.tileButton.node.active=!0,this.backgroundButton.node.active=!1,this.tileLabel.node.active=!1,this.backgroundLabel.node.active=!0,this.switchToBackgroundNode()}},{key:"switchToTileNode",value:function(){this.tileNode.active=!0,this.backgroundNode.active=!1}},{key:"switchToBackgroundNode",value:function(){this.tileNode.active=!1,this.backgroundNode.active=!0}}]),n}(E)).prototype,"tabSprite",[p3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T3=u(w3.prototype,"tileButton",[f3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C3=u(w3.prototype,"backgroundButton",[y3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E3=u(w3.prototype,"tileLabel",[v3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L3=u(w3.prototype,"backgroundLabel",[g3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I3=u(w3.prototype,"tileNode",[m3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x3=u(w3.prototype,"backgroundNode",[b3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S3=w3))||S3);b._RF.pop(),b._RF.push({},"4bdfeYQar5DdZNmrOzJpcwS","TilesContent",void 0);var Y3,J3,Z3,Q3,X3,$3,e4,t4,n4,i4,a4,r4,o4=w.ccclass,s4=w.property,l4=(P3=o4("TilesContent"),B3=s4(P),N3=s4(P),O3=s4(P),D3=s4(P),F3=s4(P),P3((U3=u((M3=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"classicSelector",U3,h(e)),c(e,"flowerSelector",G3,h(e)),c(e,"violetSelector",H3,h(e)),c(e,"antiqueSelector",V3,h(e)),c(e,"simpleSelector",W3,h(e)),e}return o(u,[{key:"__preload",value:function(){}},{key:"updateTileset",value:function(e){Object.values(Rt).includes(e)&&(this.unselectAllTilesetButtons(),this.selectTilesetButton(e))}},{key:"handleClickedTilesetButton",value:(s=t(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i,Object.values(Rt).includes(a)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,De.updateTilesetKey(a);case 5:this.updateTileset(i),this.node.scene.emit(ny.THEME_TILE_CHANGE),De.logThemeTileChange(a);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"unselectAllTilesetButtons",value:function(){this.classicSelector.active=!1,this.antiqueSelector.active=!1,this.simpleSelector.active=!1,this.violetSelector.active=!1,this.flowerSelector.active=!1}},{key:"selectTilesetButton",value:function(e){e===Rt.CLASSIC?this.classicSelector.active=!0:e===Rt.ANTIQUE?this.antiqueSelector.active=!0:e===Rt.SIMPLE?this.simpleSelector.active=!0:e===Rt.VIOLET?this.violetSelector.active=!0:e===Rt.FLOWER&&(this.flowerSelector.active=!0)}},{key:"handleContentScroll",value:function(e,t,n){12===t&&(this.classicSelector.getParent().getComponent(D).interactable=!1,this.antiqueSelector.getParent().getComponent(D).interactable=!1,this.simpleSelector.getParent().getComponent(D).interactable=!1,this.violetSelector.getParent().getComponent(D).interactable=!1,this.flowerSelector.getParent().getComponent(D).interactable=!1),9===t&&(this.classicSelector.getParent().getComponent(D).interactable=!0,this.antiqueSelector.getParent().getComponent(D).interactable=!0,this.simpleSelector.getParent().getComponent(D).interactable=!0,this.violetSelector.getParent().getComponent(D).interactable=!0,this.flowerSelector.getParent().getComponent(D).interactable=!0)}}]),u}(E)).prototype,"classicSelector",[B3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G3=u(M3.prototype,"flowerSelector",[N3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H3=u(M3.prototype,"violetSelector",[O3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V3=u(M3.prototype,"antiqueSelector",[D3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W3=u(M3.prototype,"simpleSelector",[F3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z3=M3))||z3);b._RF.pop(),b._RF.push({},"b3f53ktoLdJWo5xM/rk0qZ9","ThemeScreen",void 0);var u4,c4,h4,d4,p4,f4,y4,v4,g4,m4,b4,S4,w4,k4,T4,C4=w.ccclass,E4=w.property,L4=w.requireComponent,I4=Ludex.Events,x4=codex,R4=x4.player,A4=x4.event;Y3=C4("ThemeScreen"),J3=L4(Pi),Z3=E4(D),Q3=E4(l4),X3=E4(_3),$3=E4(K3),Y3(e4=J3((n4=u((t4=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"closeButtonComponent",n4,h(e)),c(e,"tilesContent",i4,h(e)),c(e,"backgroundContent",a4,h(e)),c(e,"tabComponent",r4,h(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.tabComponent.handleClickedTileButton(),e.closeButtonComponent.interactable=!0,e.updateStatus())},e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){A4.on(I4.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){A4.off(I4.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.runPopUpAnimation()}},{key:"updateStatus",value:function(){var e=R4.getPlayerSetting("theme");console.log("asasas updateStatus",e),e&&(this.tilesContent.updateTileset(e.tileset),this.backgroundContent.updateBackground(e.background))}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("ThemeScreen: screen not found")}},{key:"handleClickedClose",value:function(){var e=void 0!==this.screen.data.source;gt.closeScreen(We.THEME_SCREEN,{openNextScreenImmediately:e}),this.screen.data.source?gt.openScreen(this.screen.data.source):this.node.scene.emit(ny.GAME_RESUME)}}]),n}(E)).prototype,"closeButtonComponent",[Z3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i4=u(t4.prototype,"tilesContent",[Q3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a4=u(t4.prototype,"backgroundContent",[X3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r4=u(t4.prototype,"tabComponent",[$3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e4=t4))||e4);b._RF.pop(),b._RF.push({},"937bfvpekFMLYYWakX0eoGI","Leader",void 0);var _4,P4,B4,N4,O4,D4,F4,z4=w.ccclass,M4=w.property,U4=120,G4=(u4=z4("Leader"),c4=M4(q),h4=M4(q),d4=M4(q),p4=M4(x),f4=M4(x),y4=M4(x),u4((m4=u((g4=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=l.call.apply(l,[this].concat(n))).score=0,e.leaderName="",e.rank=0,c(e,"rankLabel",m4,h(e)),c(e,"nameLabel",b4,h(e)),c(e,"scoreLabel",S4,h(e)),c(e,"avatarSprite",w4,h(e)),c(e,"medalSprite",k4,h(e)),c(e,"rewardSprite",T4,h(e)),e}return o(u,[{key:"setRank",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.rank=e,this.rankLabel.string=this.rank.toString(),this.rank<=0&&(this.rankLabel.string="--"),this.rank>99&&(this.rankLabel.string="99+"),this.rank>3||this.rank<=0?this.rankLabel.node.active=!0:this.rankLabel.node.active=!1,Mf.includes(this.rank)&&t?this.rewardSprite.node.active=!0:this.rewardSprite.node.active=!1}},{key:"setName",value:function(e){this.leaderName=e,this.nameLabel.string=this.leaderName}},{key:"setScore",value:function(e){this.score=e,this.score<0&&(this.score=0),this.scoreLabel.string=this.score.toString()}},{key:"setAvatar",value:(s=t(n().mark((function e(t){var i,a,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!jf.getCachedLeaderAvatar(t)){e.next=5;break}return i=jf.getCachedLeaderAvatar(t),this.avatarSprite.spriteFrame=i,this.avatarSprite.node.getComponent(R).setContentSize(U4,U4),e.abrupt("return");case 5:return e.next=7,Ludex.Utils.Image.loadImage(t);case 7:a=e.sent,r=le.createWithImage(a),this.avatarSprite.spriteFrame=r,this.avatarSprite.node.getComponent(R).setContentSize(U4,U4),jf.setCachedLeaderAvatar(t,r);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"setAvatarSprite",value:function(e){this.avatarSprite.spriteFrame=e,this.avatarSprite.node.getComponent(R).setContentSize(U4,U4)}},{key:"setRankSprite",value:function(e){this.medalSprite.spriteFrame=e}},{key:"setRewardSprite",value:function(e){this.rewardSprite.spriteFrame=e}},{key:"getRank",value:function(){return this.rank}},{key:"getName",value:function(){return this.leaderName}},{key:"getScore",value:function(){return this.score}}]),u}(E)).prototype,"rankLabel",[c4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b4=u(g4.prototype,"nameLabel",[h4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S4=u(g4.prototype,"scoreLabel",[d4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w4=u(g4.prototype,"avatarSprite",[p4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k4=u(g4.prototype,"medalSprite",[f4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T4=u(g4.prototype,"rewardSprite",[y4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v4=g4))||v4);b._RF.pop(),b._RF.push({},"cb16dmedgZB3bXDDg5eoCZE","GoldTileComplete",void 0);var H4,V4,W4,q4,j4,K4,Y4,J4,Z4,Q4,X4,$4,e6,t6,n6,i6,a6,r6,o6,s6,l6,u6,c6,h6,d6,p6,f6=w.ccclass,y6=w.property,v6=(Ludex.Utils.Signal,_4=f6("GoldTileComplete"),P4=y6(he),B4=y6(ae),_4((D4=u((O4=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"motionStreakComponent",D4,h(e)),c(e,"particleSystemComponent",F4,h(e)),e}return o(u,[{key:"resetTile",value:function(){this.node.setPosition(new U(0,0,0)),this.node.active=!0,this.motionStreakComponent.node.active=!1,this.particleSystemComponent.node.active=!1,this.particleSystemComponent.resetSystem()}},{key:"hideTile",value:function(){this.node.setPosition(new U(0,0,0)),this.node.active=!1,this.motionStreakComponent.node.active=!1,this.particleSystemComponent.node.active=!1}},{key:"playCollectAnimation",value:(s=t(n().mark((function e(t,i,a,r,o,s){var l,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.motionStreakComponent.node.active=!0,this.particleSystemComponent.node.active=!0,l=Ke.runTweenAsync(z(this.node).delay(o).to(.2,{worldPositionX:r},{easing:"sineOut"}).to(.25,{worldPositionX:i},{easing:"sineIn"}).call((function(){u.node.active=!1,null==s||s()})),t),Ke.runTweenAsync(z(this.node).delay(o).to(.45,{worldPositionY:a},{easing:"sineOut"}),t),e.next=6,l;case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,r){return s.apply(this,arguments)})}]),u}(E)).prototype,"motionStreakComponent",[P4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F4=u(O4.prototype,"particleSystemComponent",[B4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N4=O4))||N4);b._RF.pop(),b._RF.push({},"d68e2Ddqo1L7o89/8bNCISn","TournamentCompleteScreen",void 0);var g6,m6,b6,S6,w6,k6,T6,C6,E6,L6,I6,x6,R6,A6,_6,P6,B6,N6,O6,D6,F6=w.ccclass,z6=w.property,M6=w.requireComponent,U6=Ludex,G6=U6.Utils.Signal,H6=U6.Events,V6=(U6.Utils,codex),W6=V6.player,q6=V6.event,j6=V6.match;V6.leaderboard,H4=F6("TournamentCompleteScreen"),V4=M6(Pi),W4=z6([le]),q4=z6([le]),j4=z6(q),K4=z6(Bd),Y4=z6(te),J4=z6([G4]),Z4=z6(G4),Q4=z6(P),X4=z6(P),$4=z6(P),e6=z6([v6]),H4(t6=V4((i6=u((n6=function(e){i(v,e);var s,u,d,p,f,y=a(v);function v(){var e;r(this,v);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=y.call.apply(y,[this].concat(n))).score=0,e.level=0,e.numberOfGolden=0,e.rank=100,e.lastRank=1e3,e.rankUpSignalController=new G6.SignalController,e.goldIconSignalController=new G6.SignalController,e.targetIndex=void 0,e.sessionLeaders=[],c(e,"leadersAvatars",i6,h(e)),c(e,"medals",a6,h(e)),c(e,"timeTextLabel",r6,h(e)),c(e,"timeTextLocalize",o6,h(e)),c(e,"scrollViewComponent",s6,h(e)),c(e,"leaders",l6,h(e)),c(e,"playerLeader",u6,h(e)),c(e,"playerScoreIcon",c6,h(e)),c(e,"goldenTilesContainer",h6,h(e)),c(e,"leaderExplosionEffect",d6,h(e)),c(e,"goldenTiles",p6,h(e)),e.handleOpeningScreen=function(t){e.scrollViewComponent.node.pauseSystemEvents(!0),e.rankUpSignal=e.rankUpSignalController.renew(),e.goldIconSignal=e.goldIconSignalController.renew(),e.validateEventPayload(t)&&(e.score=t.screenData.score||0,e.level=t.screenData.level||0,e.numberOfGolden=jf.getGoldenTilesPerLevel(),e.scrollViewComponent.scrollToBottom(0))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.handleLeaderboardData()},e}return o(v,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.schedule(this.updateTimeText,1),this.setDefaultLeader()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){q6.on(H6.OPENING_SCREEN,this.handleOpeningScreen),q6.on(H6.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){q6.off(H6.OPENING_SCREEN,this.handleOpeningScreen),q6.off(H6.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"handleLeaderboardData",value:(f=t(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resetStates(),!(jf.getTournamentRank()<=0)){e.next=12;break}if(gt.showLoadingScreen(),!jf.completeLevelPromise){e.next=7;break}return e.next=6,jf.completeLevelPromise;case 6:jf.completeLevelPromise=void 0;case 7:return e.next=9,jf.updateCurrentLeaderboard();case 9:gt.closeLoadingScreen(),e.next=13;break;case 12:jf.updateCurrentLeaderboard();case 13:this.updateLeaders(),this.updateTimeText(),jf.getIsNewSession()&&jf.getLeaderboard().length>=10?this.runRankUpAnimation(this.rankUpSignal):this.runRankStayAnimation(this.rankUpSignal);case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"close",value:function(){gt.closeScreen(We.TOURNAMENT_COMPLETE_SCREEN)}},{key:"handleClickedContinueButton",value:function(){this.close(),gt.openScreen(We.WINNING_SCREEN,{score:this.score,level:this.level}),this.rankUpSignalController.abort();var e,t=l(this.goldenTiles);try{for(t.s();!(e=t.n()).done;){e.value.hideTile()}}catch(e){t.e(e)}finally{t.f()}jf.setIsNewSession(!1)}},{key:"resetStates",value:function(){for(var e=0;e<this.leaders.length;e++){var t=this.leaders[e];t.node.active=!1;var n=t.node.position;n.set(n.x,-110-203*e,n.z),t.node.setPosition(n)}this.playerLeader.node.setPosition(this.leaders[3].node.position),this.playerLeader.node.setScale(new U(1,1,1)),this.setLeaderRank(this.playerLeader,0),this.playerScoreIcon.setScale(new U(1,1,1)),this.goldenTilesContainer.setScale(new U(0,0,0));var i,a=l(this.goldenTiles);try{for(a.s();!(i=a.n()).done;){i.value.resetTile()}}catch(e){a.e(e)}finally{a.f()}}},{key:"updateTimeText",value:function(){var e=jf.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"updateLeaders",value:function(){var e=W6.getPlayerId(),t=jf.getTournamentData().bestScore,n=jf.getTournamentRank();this.lastRank=this.rank>0?this.rank:n+9,this.rank=n,console.log("TournamentCompleteScreen: updateLeaders",this.rank,this.lastRank);var i=j6.getMatchState().profiles[e];this.playerLeader.setAvatar(i.photo),this.playerLeader.setName(i.name);var a=jf.getLeaderboard().filter((function(t){return t.score>0&&t.playerId!==e}));this.validateLeadersRank(a,t),this.updateLeadersInfo(a,t),this.enableLeaders(a),this.playerLeader.setScore(t-this.numberOfGolden),console.log("TournamentCompleteScreen: runRankUpAnimation",this.rank)}},{key:"updateLeadersInfo",value:function(e,t){if(this.rank<4){this.setLeaderRank(this.playerLeader,13);for(var n=0;n<this.leaders.length;n++){var i=this.leaders[n];if(this.setLeaderRank(i,n+1),n<e.length){var a=e[n];i.setName(a.name),i.setAvatar(a.avatarUrl),i.setScore(a.score),n+1===this.rank&&(this.targetIndex=n)}else if(n+1===this.rank)this.targetIndex=n,i.setScore(Math.max(t-this.numberOfGolden,this.numberOfGolden));else if(n+1>this.rank)if(e.length>0&&this.rank-1<=e.length){var r=Math.max(e[e.length-1].score-this.numberOfGolden*(n+1-this.rank),this.numberOfGolden);r>t&&(r=t-this.numberOfGolden),i.setScore(r)}else{var o=Math.max(t-this.numberOfGolden*(n+1-this.rank),this.numberOfGolden);i.setScore(o)}else i.setScore(t)}}else{this.setLeaderRank(this.playerLeader,this.rank+9);for(var s=0;s<this.leaders.length;s++){var l=this.leaders[s];if(this.setLeaderRank(l,this.rank+s-3),this.rank+s-4<e.length){var u=e[this.rank+s-4];l.setName(u.name),l.setAvatar(u.avatarUrl),l.setScore(u.score),3===s&&(this.targetIndex=s)}else if(3===s)this.targetIndex=s,l.setScore(Math.max(t-this.numberOfGolden,this.numberOfGolden));else if(s>3)if(e.length>0&&this.rank-1<=e.length){var c=Math.max(e[e.length-1].score-this.numberOfGolden*(s-3),this.numberOfGolden);c>t&&(c=t-this.numberOfGolden),l.setScore(c)}else{var h=Math.max(t-this.numberOfGolden*(s-3),this.numberOfGolden);l.setScore(h)}else l.setScore(t)}}}},{key:"enableLeaders",value:function(e){if(this.rank<=10&&e.length>=9){console.log("TournamentCompleteScreen: runRankUpAnimation",this.rank);for(var t=0;t<this.leaders.length;t++){var n=this.leaders[t];n&&(n.node.active=!0)}this.rank<4?this.targetIndex=this.rank-1:this.targetIndex=3}else if(this.rank<=10&&e.length<9){for(var i=Math.max(0,this.rank-4),a=0;a<e.length-i;a++){var r=this.leaders[a];r&&(r.node.active=!0)}this.rank<4?this.targetIndex=this.rank-1:this.targetIndex=3}else for(var o=0;o<this.leaders.length;o++){var s=this.leaders[o];s&&(s.node.active=!0)}(!jf.getIsNewSession()||jf.getLeaderboard().length<10)&&this.setLeaderRank(this.playerLeader,this.rank)}},{key:"setDefaultLeader",value:function(){for(var e=[],t=0;t<this.leadersAvatars.length;t++)e.push(t);Ludex.Utils.Array.shuffle(e);for(var n=0;n<this.leaders.length;n++){var i=this.leaders[n],a=Math.floor(Math.random()*Kf.length),r=Kf[a].split(" ");i.setName(r[0]);var o=e[n%e.length],s=this.leadersAvatars[o];i.setAvatarSprite(s),this.sessionLeaders.push({name:i.getName(),score:0,photo:s})}this.rank=jf.inst.viewedRank}},{key:"runRankUpAnimation",value:(p=t(n().mark((function e(t){var i,a,r,o,s,l,u,c,h=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=W6.getPlayerId(),a=j6.getMatchState().profiles[i],console.log("TournamentCompleteScreen: runRankUpAnimation",a),e.next=5,this.runGoldenTilesAnimation(t,jf.getTournamentData().bestScore);case 5:return e.next=7,Ke.runTweenAsync(z(this.playerLeader.node).to(.3,{scale:new U(1.1,1.1,1)}),t);case 7:if(this.scrollViewComponent.scrollToTop(1.6),void 0===this.targetIndex){e.next=17;break}for(r=new U(this.leaders[this.targetIndex].node.position.x,this.leaders[this.targetIndex].node.position.y,this.leaders[this.targetIndex].node.position.z),console.log("vvvvvvv",this.targetIndex,r),o=this.leaders.length-1,s=function(){if(!(o<0)){var e=h.leaders[o];if(e.node.worldPositionY<h.playerLeader.node.worldPositionY){o--;var t=e.getRank();h.setLeaderRank(e,t+1),h.setLeaderRank(h.playerLeader,t)}}},l=this.targetIndex;l<this.leaders.length;l++)u=this.leaders[l],(c=new U(u.node.position.x,u.node.position.y,u.node.position.z)).set(c.x,c.y-203,c.z),Ke.runTweenAsync(z(u.node).delay(1.1*ue.cubicIn((this.leaders.length-l)/(this.leaders.length-this.targetIndex))).to(.3,{position:c},{easing:"quartOut"}),t);return Ke.runTweenAsync(z(this.playerLeader.node).update(1.6,s).call((function(){h.setLeaderRank(h.playerLeader,h.rank)})),t),e.next=17,Ke.runTweenAsync(z(this.playerLeader.node).delay(.9).to(.4,{position:r},{easing:ue.sineInOut}),t);case 17:return Ke.waitTweenAsync(.35,t).then((function(){h.runLeaderExplosionEffect()})),e.next=20,Ke.runTweenAsync(z(this.playerLeader.node).to(.2,{scale:new U(1.15,1.15,1)},{easing:"sineOut"}).to(.2,{scale:new U(1,1,1)},{easing:"backOut"}),t);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"runRankStayAnimation",value:(d=t(n().mark((function e(t){var i,a,r,o,s,l,u,c,h=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=W6.getPlayerId(),a=j6.getMatchState().profiles[i],console.log("TournamentCompleteScreen: runRankStayAnimation",a),this.scrollViewComponent.scrollToTop(),r=new U(this.leaders[this.targetIndex].node.position.x,this.leaders[this.targetIndex].node.position.y,this.leaders[this.targetIndex].node.position.z),o=this.targetIndex;o<this.leaders.length;o++)s=this.leaders[o],(l=new U(s.node.position.x,s.node.position.y,s.node.position.z)).set(l.x,l.y-203,l.z),s.node.setPosition(l),this.setLeaderRank(s,s.getRank()+1);for(u=0;u<this.targetIndex;u++)c=this.leaders[u],this.setLeaderRank(c,c.getRank());return this.setLeaderRank(this.playerLeader,this.rank),this.playerLeader.node.setPosition(r),e.next=11,this.runGoldenTilesAnimation(t,jf.getTournamentData().bestScore);case 11:return Ke.waitTweenAsync(.45,t).then((function(){h.runLeaderExplosionEffect()})),e.next=14,Ke.runTweenAsync(z(this.playerLeader.node).to(.3,{scale:new U(1.15,1.15,1)},{easing:"cubicOut"}),t);case 14:return e.next=16,Ke.runTweenAsync(z(this.playerLeader.node).to(.2,{scale:new U(1,1,1)},{easing:"backOut"}),t);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"runGoldenTilesAnimation",value:(u=t(n().mark((function e(t,i){var a,r,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.goldenTilesContainer.children.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ke.runTweenAsync(z(this.goldenTilesContainer).set({scale:new U(0,0,0)}).delay(.3).to(.25,{scale:new U(1,1,1)},{easing:"backOut"}),t);case 4:for(a=0;a<this.goldenTiles.length;a++)this.goldenTiles[this.goldenTiles.length-a-1].playCollectAnimation(t,this.playerScoreIcon.worldPositionX,this.playerScoreIcon.worldPositionY,this.playerScoreIcon.worldPositionX-300,.25*a,(function(){o.goldIconSignal=o.goldIconSignalController.renew(),o.runGoldTileIconAnimation(o.goldIconSignal)}));return r={value:i-this.numberOfGolden},e.next=8,Ke.runTweenAsync(z(r).to(1.5,{value:i},{onUpdate:function(e){o.playerLeader.setScore(Math.floor(e.value))}}),t);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"runGoldTileIconAnimation",value:(s=t(n().mark((function e(t){var i,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.playerScoreIcon){e.next=2;break}return e.abrupt("return");case 2:i=this.playerScoreIcon.getScale(),Ke.runTweenAsync(z(this.playerScoreIcon).set({scale:i}).to(.2,{scale:new U(1.2,1.2,1.2)},{easing:"sineIn"}).call((function(){a.playerScoreIcon.setScale(i)})),t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"runLeaderExplosionEffect",value:function(){if(this.leaderExplosionEffect){this.leaderExplosionEffect.setPosition(this.playerLeader.node.position);var e,t=l(this.leaderExplosionEffect.getComponentsInChildren(ae));try{for(t.s();!(e=t.n()).done;){e.value.resetSystem()}}catch(e){t.e(e)}finally{t.f()}}}},{key:"setLeaderRank",value:function(e,t){e.setRank(t,!1),t>3||t<=0?e.setRankSprite(this.medals[3]):e.setRankSprite(this.medals[t-1])}},{key:"validateLeadersRank",value:function(e,t){for(var n=0;n+1<this.rank&&n<e.length;n++){if(e[n].score<t)return void(this.rank=n+1)}e.length<Gf&&(this.rank=Math.min(this.rank,e.length+1))}}]),v}(E)).prototype,"leadersAvatars",[W4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a6=u(n6.prototype,"medals",[q4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),r6=u(n6.prototype,"timeTextLabel",[j4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o6=u(n6.prototype,"timeTextLocalize",[K4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s6=u(n6.prototype,"scrollViewComponent",[Y4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l6=u(n6.prototype,"leaders",[J4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u6=u(n6.prototype,"playerLeader",[Z4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c6=u(n6.prototype,"playerScoreIcon",[Q4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h6=u(n6.prototype,"goldenTilesContainer",[X4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d6=u(n6.prototype,"leaderExplosionEffect",[$4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p6=u(n6.prototype,"goldenTiles",[e6],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),t6=n6))||t6);b._RF.pop(),b._RF.push({},"4c2349w3cFL0qV4hs+rKwmH","TournamentInfoScreen",void 0);var K6,Y6,J6,Z6,Q6,X6,$6,e9,t9,n9,i9,a9,r9,o9,s9,l9,u9,c9,h9,d9,p9,f9,y9,v9,g9,m9,b9,S9,w9,k9,T9=w.ccclass,C9=w.property,E9=w.requireComponent,L9=Ludex,I9=L9.Events,x9=L9.Utils,R9=codex,A9=(R9.player,R9.event),_9=.3;g6=T9("TournamentInfoScreen"),m6=E9(Pi),b6=C9(D),S6=C9(H),w6=C9(N),k6=C9(N),T6=C9(N),C6=C9(N),E6=C9(N),L6=C9(N),g6(I6=m6((R6=u((x6=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).controller=new x9.Signal.SignalController,c(e,"triggerMaskButtonComponent",R6,h(e)),c(e,"containerWidget",A6,h(e)),c(e,"winLevelsNode",_6,h(e)),c(e,"arrow1",P6,h(e)),c(e,"collectTilesNode",B6,h(e)),c(e,"arrow2",N6,h(e)),c(e,"improveRankingNode",O6,h(e)),c(e,"tapToContinue",D6,h(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.triggerMaskButtonComponent.interactable=!0,e.open())},e}return o(n,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){A9.on(I9.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){A9.off(I9.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.runPopUpAnimation()}},{key:"close",value:function(){this.triggerMaskButtonComponent.interactable=!1,gt.closeScreen(We.TOURNAMENT_INFO_SCREEN)}},{key:"updateStatus",value:function(){var e=Ye.getBannerAdsHeight();this.containerWidget.bottom=e}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentInfoScreen: screen not found");var e=this.controller.renew();Ke.runTweenAsync(z(this.winLevelsNode).set({opacity:0}).delay(_9).to(_9,{opacity:255}).start(),e),Ke.runTweenAsync(z(this.arrow1).set({opacity:0}).delay(.6).to(_9,{opacity:255}).start(),e),Ke.runTweenAsync(z(this.collectTilesNode).set({opacity:0}).delay(.8999999999999999).to(_9,{opacity:255}).start(),e),Ke.runTweenAsync(z(this.arrow2).set({opacity:0}).delay(1.2).to(_9,{opacity:255}).start(),e),Ke.runTweenAsync(z(this.improveRankingNode).set({opacity:0}).delay(1.5).to(_9,{opacity:255}).start(),e),Ke.runTweenAsync(z(this.tapToContinue).set({opacity:0}).delay(1.7999999999999998).to(_9,{opacity:255}).start(),e)}},{key:"handleClickedTriggerMask",value:function(){this.close()}}]),n}(E)).prototype,"triggerMaskButtonComponent",[b6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A6=u(x6.prototype,"containerWidget",[S6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_6=u(x6.prototype,"winLevelsNode",[w6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P6=u(x6.prototype,"arrow1",[k6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B6=u(x6.prototype,"collectTilesNode",[T6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N6=u(x6.prototype,"arrow2",[C6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O6=u(x6.prototype,"improveRankingNode",[E6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D6=u(x6.prototype,"tapToContinue",[L6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I6=x6))||I6);b._RF.pop(),b._RF.push({},"e24d9VkfKtDloxxVDAL347i","TournamentLeaderboardScreen",void 0);var P9,B9,N9,O9,D9,F9,z9,M9,U9,G9,H9,V9,W9,q9,j9=w.ccclass,K9=w.property,Y9=w.requireComponent,J9=Ludex,Z9=J9.Events,Q9=J9.Utils,X9=codex,$9=X9.player,e8=X9.event,t8=X9.leaderboard;K6=j9("TournamentLeaderboardScreen"),Y6=Y9(Pi),J6=K9({type:X}),Z6=K9({type:X}),Q6=K9(P),X6=K9(D),$6=K9(D),e9=K9(D),t9=K9(P),n9=K9(q),i9=K9(Bd),a9=K9(G4),r9=K9(P),o9=K9([le]),s9=K9([le]),K6(l9=Y6((c9=u((u9=function(e){i(p,e);var s,u,d=a(p);function p(){var e;r(this,p);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=d.call.apply(d,[this].concat(n)),c(e,"leaderPrefab",c9,h(e)),c(e,"playerLeaderPrefab",h9,h(e)),c(e,"leaderContainerContent",d9,h(e)),c(e,"closeButtonComponent",p9,h(e)),c(e,"infoButtonComponent",f9,h(e)),c(e,"continueButtonComponent",y9,h(e)),c(e,"continueTab",v9,h(e)),c(e,"timeTextLabel",g9,h(e)),c(e,"timeTextLocalize",m9,h(e)),c(e,"playerLeaderComponent",b9,h(e)),c(e,"devToolsContainer",S9,h(e)),c(e,"medals",w9,h(e)),c(e,"rewards",k9,h(e)),e.leaderNodes=[],e.playerLeaderInBoardNode=null,e.toggleDevTools=function(){e.devToolsContainer&&(e.devToolsContainer.scale=e.devToolsContainer.scale.equals(U.ZERO)?U.ONE:U.ZERO)},e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.infoButtonComponent.interactable=!0,e.continueButtonComponent.interactable=!0,e.updateStatus())},e}return o(p,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),Q9.Valid.isDebugger()?this.devToolsContainer.active=!0:this.devToolsContainer.active=!1,this.listenScreenEvents(),this.listenUnlockDevTools(),this.schedule(this.updateTimeText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.node.scene.off(_f.Events.UNLOCK_DEV_TOOLS,this.toggleDevTools)}},{key:"listenUnlockDevTools",value:function(){this.node.scene.on(_f.Events.UNLOCK_DEV_TOOLS,this.toggleDevTools)}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){e8.on(Z9.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){e8.off(Z9.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.updateTimeText(),this.runPopUpAnimation()}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.infoButtonComponent.interactable=!1,this.continueButtonComponent.interactable=!1,gt.closeScreen(We.TOURNAMENT_LEADERBOARD_SCREEN)}},{key:"updateStatus",value:(u=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=jf.getLeaderboardId(),t8.addLeaderboard({type:"tournament",name:t,autoSortRank:!0,leaderboardId:t}),this.updateLeaderboardData(),jf.inst.viewedRank=jf.getTournamentRank(),jf.getTournamentData().isFirstTimeJoinedTournament&&(gt.openScreen(We.TOURNAMENT_INFO_SCREEN),jf.updateTournamentData({isFirstTimeJoinedTournament:!1}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"updateTimeText",value:function(){var e=jf.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"updateLeaderboardData",value:function(){var e=jf.getLeaderboard();console.log("TournamentLeaderboardScreen: entries",e);var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.score<=0&&e.splice(e.indexOf(i),1)}}catch(e){n.e(e)}finally{n.f()}var a=Math.min(e.length,Gf);if(this.leaderContainerContent.getComponent(R).setContentSize(1080,200*a+108),0===this.leaderNodes.length)for(var r=0;r<a;r++){var o=$(this.leaderPrefab);this.leaderNodes.push(o),this.leaderContainerContent.addChild(o),o.setPosition(0,-108-200*r)}for(var s=0;s<a;s++){var u=this.leaderNodes[s];if(u||(u=$(this.leaderPrefab),this.leaderNodes.push(u),this.leaderContainerContent.addChild(u),u.setPosition(0,-108-200*s)),e[s]){u.active=!0;var c,h,d,p,f,y,v=u.getComponent(G4);if(v)this.setLeaderRankAndReward(v,s+1),v.setName(null!==(c=null===(h=e[s])||void 0===h?void 0:h.name)&&void 0!==c?c:"Player"),v.setScore(null!==(d=null===(p=e[s])||void 0===p?void 0:p.score)&&void 0!==d?d:0),v.setAvatar(null!==(f=null===(y=e[s])||void 0===y?void 0:y.avatarUrl)&&void 0!==f?f:"")}else u.active=!1}this.updatePlayerLeader()}},{key:"updatePlayerLeader",value:(s=t(n().mark((function e(){var t,i,a,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=jf.getLeaderboard().filter((function(e){return e.playerId===$9.getPlayerId()})),console.log("TournamentLeaderboardScreen: playerEntry",t),t&&0!==t.length){e.next=9;break}return i=$9.getPlayer(),this.setLeaderRankAndReward(this.playerLeaderComponent,jf.getTournamentRank()>0?jf.getTournamentRank():0),this.playerLeaderComponent.setName(i.name||"You"),this.playerLeaderComponent.setScore(jf.getTournamentData().bestScore||0),this.playerLeaderComponent.setAvatar(i.photo||""),e.abrupt("return");case 9:a=jf.getTournamentRank()>0?jf.getTournamentRank():0,r=t[0],this.setLeaderRankAndReward(this.playerLeaderComponent,a),this.playerLeaderComponent.setName(r.name),this.playerLeaderComponent.setScore(r.score||0),this.playerLeaderComponent.setAvatar(r.avatarUrl||$9.getPlayer().photo),(o=this.leaderNodes.find((function(e){var t;return(null===(t=e.getComponent(G4))||void 0===t?void 0:t.getRank())===a})))?(this.playerLeaderInBoardNode||(this.playerLeaderInBoardNode=$(this.playerLeaderPrefab),this.leaderContainerContent.addChild(this.playerLeaderInBoardNode)),this.playerLeaderInBoardNode.setPosition(o.position),this.playerLeaderInBoardNode.active=!0,o.active=!1,s=this.playerLeaderInBoardNode.getComponent(G4),this.setLeaderRankAndReward(s,a),s.setName(r.name),s.setScore(r.score||0),s.setAvatar(r.avatarUrl||$9.getPlayer().photo)):this.playerLeaderInBoardNode&&(this.playerLeaderInBoardNode.active=!1);case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setLeaderRankAndReward",value:function(e,t){t>3||t<=0?e.setRankSprite(this.medals[3]):e.setRankSprite(this.medals[t-1]),Mf.includes(t)?(e.setRewardSprite(this.rewards[t-1]),e.setRank(t,!0)):(e.setRewardSprite(null),e.setRank(t,!1))}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentLeaderboardScreen: screen not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedInfo",value:function(){gt.openScreen(We.TOURNAMENT_INFO_SCREEN)}},{key:"handleClickedContinue",value:function(){this.runContinueAnimation(),this.continueButtonComponent.interactable=!1}},{key:"runContinueAnimation",value:function(){var e=this,t=this.continueTab.getComponent(N);t&&z(t).set({opacity:255}).to(.3,{opacity:0},{easing:"smooth"}).call((function(){e.continueTab.active=!1})).start()}}]),p}(E)).prototype,"leaderPrefab",[J6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h9=u(u9.prototype,"playerLeaderPrefab",[Z6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d9=u(u9.prototype,"leaderContainerContent",[Q6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p9=u(u9.prototype,"closeButtonComponent",[X6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f9=u(u9.prototype,"infoButtonComponent",[$6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y9=u(u9.prototype,"continueButtonComponent",[e9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v9=u(u9.prototype,"continueTab",[t9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g9=u(u9.prototype,"timeTextLabel",[n9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m9=u(u9.prototype,"timeTextLocalize",[i9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b9=u(u9.prototype,"playerLeaderComponent",[a9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S9=u(u9.prototype,"devToolsContainer",[r9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w9=u(u9.prototype,"medals",[o9],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k9=u(u9.prototype,"rewards",[s9],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l9=u9))||l9);b._RF.pop(),b._RF.push({},"392e1NLXXtBxLM1Sdy78qXu","LeaderboardBackground",void 0);var n8,i8,a8,r8,o8,s8,l8,u8,c8,h8,d8,p8,f8=w.ccclass,y8=w.property,v8=Ludex,g8=v8.Utils.Decorator,m8=v8.Events,b8=ze.Layout,S8=codex.event,w8=(d(P9={},b8.Portrait,{width:1080,height:2280}),d(P9,b8.Landscape,{width:2732,height:1583}),P9);B9=f8("LeaderboardBackground"),N9=on.required(),O9=y8(P),D9=y8(P),F9=y8(Pi),z9=g8.debounce(100),B9((G9=u((U9=function(e){i(l,e);var s=a(l);function l(){var e;r(this,l);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=s.call.apply(s,[this].concat(a)),c(e,"sprite",G9,h(e)),c(e,"timerContainer",H9,h(e)),c(e,"goldTile",V9,h(e)),c(e,"baseScreen",W9,h(e)),e.updateBackgroundSprite=t(n().mark((function t(){var i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fe.getCurrentLeaderboardBackground();case 2:if(i=t.sent){t.next=5;break}return t.abrupt("return");case 5:e.setBackgroundSprite(i),e.updateSizeBackground();case 7:case"end":return t.stop()}}),t)}))),e.listenGameEvents=function(t){t.screenName===Ve[We.TOURNAMENT_LEADERBOARD_SCREEN]&&A.on(Oe.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===Ve[We.TOURNAMENT_LEADERBOARD_SCREEN]&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},c(e,"handleViewResized",q9,h(e)),e}return o(l,[{key:"__preload",value:function(){this.sprite=this.getComponent(x),this.uiTransform=this.getComponent(R),on.validateRequiredProperties(this),S8.on(m8.OPENING_SCREEN,this.listenGameEvents),S8.on(m8.CLOSING_SCREEN,this.unlistenGameEvents),this.tryUpdateBackgroundSprite()}},{key:"tryUpdateBackgroundSprite",value:function(){var e=Fe.getCurrentLayoutBackgroundByKey("Leaderboard");if(null!==e)return this.setBackgroundSprite(e),void this.updateSizeBackground();this.baseScreen.addPreloadPromise(this.updateBackgroundSprite)}},{key:"onEnable",value:function(){this.handleViewResized()}},{key:"setBackgroundSprite",value:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"updateSizeBackground",value:function(){if(this.sprite){var e=_.getVisibleSize(),t=e.width,n=e.height;if(this.sprite.spriteFrame){var i=w8[Fe.getCurrentLayout()],a=i.width,r=i.height;this.uiTransform.setContentSize(a,r);var o=t/a,s=n/r,l=Math.max(o,s);console.log("scale",l,"scaleX",o,"scaleY",s),Fe.isPortrait()?this.sprite.node.setScale(o,s):Fe.isLandscape()&&s<l&&l>1.45?this.sprite.node.setScale(o,1.45):this.sprite.node.setScale(l,l),this.updateTimerContainerPosition(o,s),this.updateGoldTilePosition(o,s)}}}},{key:"updateTimerContainerPosition",value:function(e,t){this.timerContainer&&(Fe.isPortrait()?this.timerContainer.setPosition(0,380*t):Fe.isLandscape()&&(e>1.45?this.timerContainer.setPosition(0,435):this.timerContainer.setPosition(0,410)))}},{key:"updateGoldTilePosition",value:function(e,t){if(this.goldTile)if(Fe.isPortrait()){this.goldTile.setPosition(0,665*t);var n=Math.min(e,t);this.goldTile.setScale(n,n)}else Fe.isLandscape()&&(e>1.45?(this.goldTile.setPosition(0,675),this.goldTile.setScale(.9,.9)):(this.goldTile.setPosition(0,650),this.goldTile.setScale(.8,.8)))}}]),l}(E)).prototype,"sprite",[N9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H9=u(U9.prototype,"timerContainer",[O9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V9=u(U9.prototype,"goldTile",[D9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W9=u(U9.prototype,"baseScreen",[F9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q9=u(U9.prototype,"handleViewResized",[z9],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateBackgroundSprite()}}}),M9=U9));b._RF.pop(),b._RF.push({},"e3444hBHSZGG7IA2p+xZ5zi","LeaderboardLayout",void 0);var k8,T8,C8,E8,L8,I8,x8,R8,A8,_8,P8,B8,N8=w.ccclass,O8=w.property,D8=Ludex,F8=D8.Utils.Decorator,z8=D8.Events,M8=ze.Layout,U8=codex.event,G8=(d(n8={},M8.Portrait,{width:1080,height:2280}),d(n8,M8.Landscape,{width:2732,height:1583}),n8),H8="TournamentLeaderboardScreen";i8=N8("LeaderboardLayout"),a8=O8(P),r8=O8(P),o8=O8(P),s8=F8.debounce(100),i8((c8=u((u8=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"leaderboardScroll",c8,h(e)),c(e,"leaderboardScrollView",h8,h(e)),c(e,"leaderboardFooter",d8,h(e)),e.listenGameEvents=function(t){t.screenName===H8&&A.on(Oe.VIEW_RESIZED,e.handleViewResized)},e.unlistenGameEvents=function(t){t.screenName===H8&&A.off(Oe.VIEW_RESIZED,e.handleViewResized)},c(e,"handleViewResized",p8,h(e)),e}return o(n,[{key:"__preload",value:function(){U8.on(z8.OPENING_SCREEN,this.listenGameEvents),U8.on(z8.CLOSING_SCREEN,this.unlistenGameEvents)}},{key:"onLoad",value:function(){}},{key:"start",value:function(){this.handleViewResized()}},{key:"updateLeaderboardLayout",value:function(){var e=Ye.getBannerAdsHeight(),t=_.getVisibleSize(),n=(t.width,t.height),i=G8[Fe.getCurrentLayout()],a=(i.width,n/i.height),r=G8[M8.Portrait].height,o=this.leaderboardFooter.getComponent(H);if(o&&(o.bottom=e,o.updateAlignment()),Fe.isLandscape())this.leaderboardScroll.setPosition(0,330),this.leaderboardScroll.getComponent(R).setContentSize(r,1175-e),this.leaderboardScrollView.getComponent(R).setContentSize(r,1175-e);else if(Fe.isPortrait()){this.leaderboardScroll.setPosition(0,275*a);var s=275*a-this.leaderboardFooter.position.y-115-10;this.leaderboardScroll.getComponent(R).setContentSize(r,s),this.leaderboardScrollView.getComponent(R).setContentSize(r,s)}}}]),n}(E)).prototype,"leaderboardScroll",[a8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h8=u(u8.prototype,"leaderboardScrollView",[r8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d8=u(u8.prototype,"leaderboardFooter",[o8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p8=u(u8.prototype,"handleViewResized",[s8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateLeaderboardLayout()}}}),l8=u8));b._RF.pop(),b._RF.push({},"2a961XkBT9PBZLoMZaBr2aF","TournamentPopupScreen",void 0);var V8,W8,q8,j8,K8,Y8,J8,Z8,Q8,X8,$8,e7=w.ccclass,t7=w.property,n7=w.requireComponent,i7=Ludex,a7=i7.Events,r7=(i7.Utils,codex),o7=(r7.player,r7.event);r7.analytics,k8=e7("TournamentPopupScreen"),T8=n7(Pi),C8=t7(D),E8=t7(D),L8=t7(q),I8=t7(Bd),k8(x8=T8((A8=u((R8=function(e){i(u,e);var s,l=a(u);function u(){var e;r(this,u);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=l.call.apply(l,[this].concat(n)),c(e,"closeButtonComponent",A8,h(e)),c(e,"startButtonComponent",_8,h(e)),c(e,"timeTextLabel",P8,h(e)),c(e,"timeTextLocalize",B8,h(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.startButtonComponent.interactable=!0,e.updateStatus())},e}return o(u,[{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents(),this.schedule(this.updateTimeText,1)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){o7.on(a7.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){o7.off(a7.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(e){this.updateStatus(),this.runPopUpAnimation()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.closeButtonComponent.interactable=!1,this.startButtonComponent.interactable=!1,gt.closeScreen(We.TOURNAMENT_POPUP_SCREEN,{openNextScreenImmediately:e})}},{key:"updateStatus",value:function(){this.updateTimeText()}},{key:"updateTimeText",value:function(){var e=jf.getTournamentEndTime();this.timeTextLocalize.key=e.key,this.timeTextLocalize.setParams(e.params)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("TournamentPopupScreen: screen not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedStart",value:(s=t(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=jf.inst.isPlayerJoined,e.next=3,jf.handleJoinTournament();case 3:if(jf.inst.isPlayerJoined){e.next=8;break}return this.close(),gt.showNotificationScreen("failedToJoinTournament"),jf.logTournamentRefuse(t),e.abrupt("return");case 8:t?jf.logTournamentRejoin():jf.logTournamentStart(),this.close(!0),gt.openScreen(We.TOURNAMENT_LEADERBOARD_SCREEN);case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),u}(E)).prototype,"closeButtonComponent",[C8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_8=u(R8.prototype,"startButtonComponent",[E8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P8=u(R8.prototype,"timeTextLabel",[L8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B8=u(R8.prototype,"timeTextLocalize",[I8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x8=R8))||x8);b._RF.pop(),b._RF.push({},"4a93c9jKehDa4T9aXGRhgxr","NextLevelButton",void 0);var s7,l7,u7,c7,h7,d7,p7,f7,y7,v7,g7,m7=w.ccclass,b7=w.property,S7=(V8=m7("NextLevelButton"),W8=b7([q]),q8=b7([Bd]),j8=b7(P),K8=b7(P),V8((Z8=u((J8=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"levelText",Z8,h(e)),c(e,"levelTextLocalize",Q8,h(e)),c(e,"textWithIcon",X8,h(e)),c(e,"textWithoutIcon",$8,h(e)),e}return o(n,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(0===this.levelText.length)throw new Error("NextLevelButton requires at least one Label component in levelText array.");if(0===this.levelTextLocalize.length)throw new Error("NextLevelButton requires at least one Localize component in levelTextLocalize array.")}},{key:"updateLevelText",value:function(e,t){var n,i=l(this.levelText);try{for(i.s();!(n=i.n()).done;){n.value.string="".concat(t," ").concat(e)}}catch(e){i.e(e)}finally{i.f()}var a,r=l(this.levelTextLocalize);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.key="levelV",o.setParams([e.toString()])}}catch(e){r.e(e)}finally{r.f()}jf.isTournamentHappening()?(this.textWithIcon.active=!0,this.textWithoutIcon.active=!1):(this.textWithIcon.active=!1,this.textWithoutIcon.active=!0)}},{key:"updateText",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=l(this.levelTextLocalize);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.key=e}}catch(e){i.e(e)}finally{i.f()}n?(this.textWithIcon.active=!0,this.textWithoutIcon.active=!1):(this.textWithIcon.active=!1,this.textWithoutIcon.active=!0)}}]),n}(E)).prototype,"levelText",[W8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Q8=u(J8.prototype,"levelTextLocalize",[q8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),X8=u(J8.prototype,"textWithIcon",[j8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$8=u(J8.prototype,"textWithoutIcon",[K8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y8=J8))||Y8);b._RF.pop(),b._RF.push({},"90835KRvK9KiqPOIXd+TUcq","RewardProgressBar",void 0);var w7,k7,T7,C7,E7,L7,I7,x7,R7,A7,_7,P7,B7,N7,O7,D7,F7,z7,M7,U7,G7,H7,V7,W7,q7,j7,K7,Y7,J7,Z7,Q7=w.ccclass,X7=w.property,$7=-254.5,eee=Ludex.Utils.Time,tee=(s7=Q7("RewardProgressBar"),l7=X7(x),u7=X7(P),c7=X7(N),h7=X7(x),s7((f7=u((p7=function(e){i(d,e);var s,l,u=a(d);function d(){var e;r(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),c(e,"progressBar",f7,h(e)),c(e,"progressFillTail",y7,h(e)),c(e,"glowOpacity",v7,h(e)),c(e,"icon",g7,h(e)),e.iconInitialPosition=new U(0,0,0),e}return o(d,[{key:"onLoad",value:function(){this.iconInitialPosition=this.icon.node.position.clone(),this.hideReachTargetAnimation(),this.progressFillTail.setPosition(new U($7,0,0))}},{key:"runFillAnimation",value:(l=t(n().mark((function e(t,i){var a,r,o,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:0,r=function(e){s.progressFillTail.setPosition(new U(450*e.fillRange+$7,0,0))},this.progressFillTail.setPosition(new U(450*t+$7,0,0)),o=z(this.progressBar).set({fillRange:t}).delay(a).to(.5,{fillRange:i},{easing:"cubicInOut",onUpdate:function(e){r(e)}}).call((function(){s.progressBar.fillRange=i,s.progressFillTail.setPosition(new U(450*i+$7,0,0))})),e.next=6,Ke.runTweenAsync(o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"runReachTargetAnimation",value:(s=t(n().mark((function e(){var t,i,a,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z(this.glowOpacity).to(.2,{opacity:255},{easing:"cubicInOut"}),i=z(this.glowOpacity.node).set({scale:new U(0,0,1)}).to(.3,{scale:new U(1,1,1)},{easing:"backOut"}),a=z(this.icon.node).to(.2,{scale:new U(1.2,.8,1)},{easing:"cubicIn"}).to(.3,{scale:new U(.8,1.2,1)},{easing:"cubicOut"}).to(.2,{scale:new U(1,1,1)},{easing:"cubicInOut"}).delay(.1).to(.1,{scale:new U(1.1,.9,1)},{easing:"cubicIn"}).to(.1,{scale:new U(1,1,1)},{easing:"cubicInOut"}),r=z(this.icon.node).to(.2,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y-10,0)},{easing:"cubicInOut"}).to(.4,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+45,0)},{easing:"sineOut"}).to(.3,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"sineIn"}).to(.1,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+10,0)},{easing:"cubicInOut"}).to(.1,{position:new U(this.iconInitialPosition.x,this.iconInitialPosition.y+0,0)},{easing:"cubicInOut"}),z(this.glowOpacity.node).set({angle:0}).by(2,{angle:360},{easing:"linear"}).start(),(o=[]).push(Ke.runTweenAsync(t)),o.push(Ke.runTweenAsync(a)),o.push(Ke.runTweenAsync(i)),o.push(Ke.runTweenAsync(r)),e.next=12,Promise.all(o);case 12:return e.next=14,eee.sleepAsync(200);case 14:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"hideReachTargetAnimation",value:function(){this.glowOpacity.opacity=0,this.glowOpacity.node.setScale(new U(0,0,1)),this.glowOpacity.node.setRotationFromEuler(0,0,0),this.icon.node.setScale(new U(1,1,1)),this.icon.node.setPosition(this.iconInitialPosition)}}]),d}(E)).prototype,"progressBar",[l7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y7=u(p7.prototype,"progressFillTail",[u7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v7=u(p7.prototype,"glowOpacity",[c7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g7=u(p7.prototype,"icon",[h7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d7=p7))||d7);b._RF.pop(),b._RF.push({},"35c09YGmdFA4pHOJFDg1tw5","WinningScreen",void 0);var nee,iee,aee,ree,oee=w.ccclass,see=w.property,lee=w.disallowMultiple,uee=w.requireComponent,cee=(w.executeInEditMode,Ludex),hee=cee.Events,dee=cee.Plugins.Analytics.Events.SHARE,pee=codex,fee=pee.player,yee=pee.event,vee=pee.language,gee=pee.analytics,mee=pee.frameCapture;w7=oee("WinningScreen"),k7=uee(Pi),T7=see(x),C7=see(Bd),E7=see(S7),L7=see(D),I7=see(D),x7=see(D),R7=see(q),A7=see(tee),_7=see(Bd),P7=see(Bd),B7=see(ae),N7=see(ae),O7=see(ae),w7(D7=lee(D7=k7((z7=u((F7=function(e){i(f,e);var s,l,u,d,p=a(f);function f(){var e;r(this,f);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=p.call.apply(p,[this].concat(n)),c(e,"titleRibbon",z7,h(e)),c(e,"titleLabel",M7,h(e)),c(e,"nextLevelButton",U7,h(e)),c(e,"shareButtonComponent",G7,h(e)),c(e,"nextLevelButtonComponent",H7,h(e)),c(e,"returnButtonComponent",V7,h(e)),c(e,"scoreText",W7,h(e)),c(e,"rewardProgressBar",q7,h(e)),c(e,"progressTextLocalize",j7,h(e)),c(e,"commentTextLocalize",K7,h(e)),c(e,"firelightParticleSystem",Y7,h(e)),c(e,"blossomParticleSystem",J7,h(e)),c(e,"blossomParticleSystem2",Z7,h(e)),e.handleOpeningScreen=function(t){var n,i;if(!e.screen)throw new Error("WinningScreen: screen not found");e.validateEventPayload(t)&&(e.firelightParticleSystem.node.active=!0,e.screen.data.level=(null==t||null===(n=t.screenData)||void 0===n?void 0:n.level)||1,e.screen.data.score=(null==t||null===(i=t.screenData)||void 0===i?void 0:i.score)||0,e.open())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&(e.firelightParticleSystem.resetSystem(),e.blossomParticleSystem.resetSystem(),e.blossomParticleSystem2.resetSystem())},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.unscheduleAllCallbacks(),e.firelightParticleSystem.stopSystem(),e.blossomParticleSystem.stopSystem(),e.blossomParticleSystem2.stopSystem())},e}return o(f,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Pi),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){on.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){yee.on(hee.OPENING_SCREEN,this.handleOpeningScreen),yee.on(hee.OPENED_SCREEN,this.handleOpenedScreen),yee.on(hee.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){yee.off(hee.OPENING_SCREEN,this.handleOpeningScreen),yee.off(hee.OPENED_SCREEN,this.handleOpenedScreen),yee.off(hee.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){Ge.playSound(He.HAND_CLAP),rt.getSpecialMode()!==ft.DAILY_CHALLENGE?this.processSingleFlow():this.processDailyChallengeFlow()}},{key:"processSingleFlow",value:function(){var e;this.titleLabel.key="wellDone",this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!0,this.rewardProgressBar.node.active=!0,this.returnButtonComponent.node.active=!1,this.updateLevel(),this.commentTextLocalize.key="NailedLikeAChamp";var t=(null===(e=codex.player.getGameData())||void 0===e?void 0:e.level)||1,n=this.screen.data.level===t?t+1:t,i=10*Math.ceil(t/10),a=n%10==0?1:n%10/10,r=(n-1)%10==0?0:(n-1)%10/10;this.progressTextLocalize.key="reachLevelV",this.progressTextLocalize.setParams([i.toString()]),i===n&&at.getLevel()===at.getMaxLevel()?this.processSingleRewardFlow(r,a):this.processSingleNormalFlow(r,a)}},{key:"processDailyChallengeFlow",value:function(){this.titleLabel.key="exceptional",this.nextLevelButtonComponent.interactable=!0,this.commentTextLocalize.node.active=!0,this.progressTextLocalize.node.active=!1,this.rewardProgressBar.node.active=!1,this.returnButtonComponent.node.active=!1;var e=rt.getSpecialModeInfo(),t=e.day,n=e.month,i=e.year,a="".concat(i," / ").concat(n<10?"0".concat(n):n," / ").concat(t<10?"0".concat(t):t);this.commentTextLocalize.key="customString",this.commentTextLocalize.setParams([a]),this.nextLevelButton.updateText("continue");var r=this.screen.data.score||0;this.scoreText.string="".concat(r)}},{key:"processSingleNormalFlow",value:(d=t(n().mark((function e(t,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.interactable=!0,this.shareButtonComponent.interactable=!0,e.next=4,this.rewardProgressBar.runFillAnimation(t,i,.5);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"processSingleRewardFlow",value:(u=t(n().mark((function e(t,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextLevelButtonComponent.node.active=!1,this.shareButtonComponent.node.active=!1,e.next=4,this.rewardProgressBar.runFillAnimation(t,i,.5);case 4:return e.next=6,this.rewardProgressBar.runReachTargetAnimation();case 6:return this.close(),e.next=9,this.openRewardScreen();case 9:this.rewardProgressBar.hideReachTargetAnimation(),this.nextLevelButtonComponent.node.active=!0,this.shareButtonComponent.node.active=!0,this.goToNextLevel();case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"close",value:function(){this.nextLevelButtonComponent.interactable=!1,this.shareButtonComponent.interactable=!1,this.firelightParticleSystem.node.active=!1,gt.closeScreen(We.WINNING_SCREEN)}},{key:"handleClickedNextLevel",value:(l=t(n().mark((function e(){var t,i,a,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye.showInterstitialAdAsync();case 2:rt.getSpecialMode()===ft.DAILY_CHALLENGE?(t=rt.getSpecialModeInfo(),i=Fb.calculateNextDay(t),a=i.day,r=i.month,o=i.year,St.switchToDashboardScene({screen:We.DAILY_CHALLENGE_SCREEN,screenData:{customData:{day:a,month:r,year:o,dayCompleted:t.day}}})):this.goToNextLevel(),this.close();case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleClickedReturn",value:function(){this.close()}},{key:"handleClickedRetry",value:function(){this.close(),this.node.scene.emit(ny.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close();var e=this.screen.data.level;this.node.scene.emit(ny.NEXT_LEVEL,{level:e})}},{key:"handleClickedShare",value:(s=t(n().mark((function e(){var t,i,a,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.extra||!("shareAsync"in GameSDK.extra)){e.next=18;break}return gt.showLoadingScreen(),e.prev=2,t=fee.getPlayer(),i=t.playerId,a=t.name,r=t.photo,t.data,o=at.getPlayerLevel(),e.next=7,mee.wideframe.renderShareScore({playerId:i,playerPhoto:r,playerScore:o});case 7:return s=e.sent,e.next=10,GameSDK.extra.shareAsync({text:"Woohoo! I've never gone this far before!",intent:"SHARE",image:null!=s?s:"",data:{playerId:i,playerName:a,playerPhoto:r,type:"share_invite",level:o}});case 10:gee.event(dee,{share_content_type:"CurrentLevel",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),gee.event(dee,{share_content_type:"CurrentLevel",success:!1}),console.warn(e.t0);case 17:gt.closeLoadingScreen();case 18:case"end":return e.stop()}}),e,null,[[2,13]])}))),function(){return s.apply(this,arguments)})},{key:"goToNextLevel",value:function(){this.screen.data.level?this.node.scene.emit(ny.NEXT_LEVEL):console.warn("WinningScreen: level not found")}},{key:"openRewardScreen",value:function(e){var t=this;return new Promise((function(n){var i=[];Math.random()<.5?i.push({item:tt.HINT,count:1}):i.push({item:tt.SHUFFLE,count:1});var a={items:i,watchAdsDoubleReward:!0,chestId:Hz,successCallback:function(){t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.HINT,Zm.getItemCount(et[tt.HINT])),t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.UNDO,Zm.getItemCount(et[tt.UNDO])),t.node.scene.emit(ny.ITEM_COUNT_CHANGE,tt.SHUFFLE,Zm.getItemCount(et[tt.SHUFFLE])),null==e||e(),n()},earnFrom:"WinningScreen"};gt.openScreen(We.REWARD_SCREEN,a)}))}},{key:"updateLevel",value:function(){var e=at.getLevel(),t=vee.getText("level");this.nextLevelButton.updateLevelText(e,t);var n=this.screen.data.score||0;this.scoreText.string="".concat(n)}}]),f}(E)).prototype,"titleRibbon",[T7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M7=u(F7.prototype,"titleLabel",[C7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U7=u(F7.prototype,"nextLevelButton",[E7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G7=u(F7.prototype,"shareButtonComponent",[L7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H7=u(F7.prototype,"nextLevelButtonComponent",[I7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V7=u(F7.prototype,"returnButtonComponent",[x7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W7=u(F7.prototype,"scoreText",[R7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q7=u(F7.prototype,"rewardProgressBar",[A7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j7=u(F7.prototype,"progressTextLocalize",[_7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K7=u(F7.prototype,"commentTextLocalize",[P7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y7=u(F7.prototype,"firelightParticleSystem",[B7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J7=u(F7.prototype,"blossomParticleSystem",[N7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z7=u(F7.prototype,"blossomParticleSystem2",[O7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D7=F7))||D7)||D7);b._RF.pop(),b._RF.push({},"c79513DyFFAIosjE1ekd39Y","FireLightParticleSystem2DExtra",void 0);var bee=w.ccclass,See=w.property;bee("FirelightParticleSystem2DExtra")((aee=u((iee=function(e){i(n,e);var t=a(n);function n(){var e;r(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),c(e,"rectW",aee,h(e)),c(e,"rectH",ree,h(e)),e}return o(n,[{key:"initParticle",value:function(e){e.maxSize=ee.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=ee.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+ee.randomRange(-this.rectW/2,this.rectW/2),e.y=n+ee.randomRange(0,this.rectH/2)-this.rectH/2,e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),n}(QA)).prototype,"rectW",[See],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),ree=u(iee.prototype,"rectH",[See],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),nee=iee));b._RF.pop(),b._RF.push({},"ca600QzdYZDSLmGmfSVyz4h","AnimAbortSignal",void 0);Ludex.Utils.Array;b._RF.pop(),b._RF.push({},"58f4330KXRL77xyoA3903MY","WasmUtils",void 0),b._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});