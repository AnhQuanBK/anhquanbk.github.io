System.register("chunks:///systems.js",["./rollupPluginModLoBabelHelpers-59152efd.js","cc","./TournamentUtils-a5936e3c.js"],(function(){var e,t,n,r,a,i,s,o,c,u,l,d,h,p,f,g,m,v,$,y,w,S,b,x,E,A,C,D,k,R,L,F,T,P,_,M,I,N,O,U,G,z,H,B,V,j,Y,q,W,Q,K,X,J,Z,ee,te,ne,re,ae,ie,se,oe,ce,ue;return{setters:[function(p){e=p._,t=p.f,n=p.g,r=p.h,a=p.c,i=p.d,s=p.j,o=p.r,c=p.p,u=p.i,l=p.q,d=p.a,h=p.b},function(e){p=e.cclegacy,f=e.game,g=e.settings,m=e.Settings,v=e.View,$=e.AssetManager,y=e.sys,w=e.director,S=e.input,b=e.Input,x=e.DynamicAtlasManager,E=e.macro,A=e.view,C=e.ResolutionPolicy,D=e.Size,k=e.screen,R=e.Director,L=e.Texture2D,F=e.Layers,T=e.assetManager,P=e.ImageAsset,_=e.instantiate,M=e.Prefab,I=e.Game,N=e.gfx,O=e._decorator,U=e.rendering,G=e.Component},function(e){z=e.m,H=e.G,B=e.L,V=e.a,j=e.C,Y=e.M,q=e.i,W=e.P,Q=e.u,K=e.I,X=e.v,J=e.g,Z=e.w,ee=e.f,te=e.R,ne=e.x,re=e.l,ae=e.S,ie=e.c,se=e.n,oe=e.p,ce=e.j,ue=e.r}],execute:function(){var le,de,he,pe={text:{"core.nameless":"Nameless","game.resume":"Resume","game.restart":"Restart","game.cancel":"Cancel","game.challenge":"Challenge\nFriends","game.next":"NEXT","game.completed":"COMPLETED","game.tryAgain":"Try again","game.retry":"RETRY","game.startOverQ":"Start Over?","game.startOverMsg":"Start over? You'll lose your current progress and begin from the start. Are you sure you want to restart?","game.startOver":"START OVER","game.paused":"Paused","game.end":"End","game.quit":"Quit","game.join":"Join","game.joinLeaderboard":"Join Leaderboard","game.continue":"Continue","game.letsPlay":"Let's Play","game.logIn":"Log in","game.create":"Create","game.quitLevelShortMsg":"Quit Level?","game.quitSingleMsg":"Quit now? You're so close to completing this level!","game.quitTourMsg":"Quit now? You're just a few levels away from ranking up!","game.level":"Level","game.levelX":"Level %{0}","game.hardLevel":"Hard Level","game.result":"Your Result","game.nextLevel":"Next Level","game.win":"You Win","game.lose":"You Lose","game.draw":"Draw","game.replay":"Replay","game.boom":"Boom!","game.timesUp":"Time's Up!","game.bombDesc":"The bomb exploded!","game.timesUpDesc":"Restart or add 2 minutes?","game.daily":"Daily","game.weekly":"Weekly","game.endsSoon":"Ends Soon","game.endsIn":"Ends %{0}","game.player":"1 player","game.nPlayers":"%{0} players","game.pTour":"%{0}'s Tournament","game.combo":"Combo","game.tourLbUpdated":"Duel!","settings.level":"Level","settings.settings":"Settings","settings.music":"Music","settings.sound":"Sound","settings.vibrate":"Vibrate","settings.on":"ON","settings.off":"OFF","settings.notification":"Notification","settings.report":"Report","settings.share":"Share","settings.invite":"Invite Friends","settings.feedback":"Feedback","settings.createShortcut":"Create\nShortcut","settings.or":"OR","settings.customMode":"Custom\nMode","custom.customLevel":"Custom Level","custom.time":"Time","custom.difficulty":"Difficulty","custom.easy":"Easy","custom.normal":"Normal","custom.hard":"Hard","custom.extreme":"Extreme","custom.bombs":"Bombs","custom.ads":"Extra ads duration","custom.score":"Score increase:","custom.play":"Play","ads.cancelled":"Sorry, No Rewards!\nYou have cancelled the ad!","ads.loading":"Loading ads...","ads.notReady":"No ads to display!","ads.adAfterT":"AD starting in %{0}...","ads.levelAfterT":"Next level in %{0}...","ads.rewardNotice":"Watch a short ad to receive\nthese rewards:","ads.skip":"Skip","ads.daily":"Daily Rewards","ads.claim":"Claim","ads.claimX2":"Claim x2","ads.claimNow":"Claim Now!","ads.await":"Looking for rewards...","ads.open":"Open","ads.coins":"Get Coins","ads.getNow":"Get Now","ads.freeMinutes":"Get %{0} FREE minutes","ads.interNotice.hangTight":"Short ad break, hang tight!","ads.interNotice.backInSec":"Back to the game in just a sec!","ads.interNotice.quickAd":"Quick ad, then more fun!","status.loading":"Loading","status.congrats":"Congratulations","status.allLevels":"You have passed all levels.","status.later":"Please come back later,\nwe will update soon!","status.confirm":"CONFIRMATION","status.confirmReset":"ARE YOU SURE TO START OVER?","status.resetInfo":"You will play the game again\nfrom the beginning, at level 1.","status.no":"NO","status.yes":"YES","status.first":"1st","status.second":"2nd","status.third":"3rd","status.nth":"%{0}th","status.tap":"Tap to continue","status.waitingX":"Waiting%{0}","status.lbNotAvail":"Leaderboard is empty.","status.tourNotAvail":"No tournaments available.","pages.shop":"Shop","pages.collections":"Collections","pages.home":"Home","pages.leaderboard":"Leaderboard","pages.tournament":"Tournament","guide.step1":"Tap to connect","guide.step2":"Connect similar tiles with less than 2 turns","guide.step3":"Connect similar tiles with less than 2 turns","guide.step4":"More than 2 turns are NOT allowed","guide.step5":"There's obstacle between the tiles","guide.timer":"Remove all tiles before\nthe time end","guide.combo":"Remove tiles continuously\nto increase combo!","guide.hint":"Tap to reveal a connectable pair","guide.thunder":"Tap to remove 2 pairs","guide.storm":"Tap to rearrange the tiles","guide.pliers":"Tap to remove bomb","guide.custom":"Custom mode unlocked.\n Press this button to set your own difficulty","interMsg.reviveAd":"Watch an ad to revive yourself\nKeep playing and don't give up!","interMsg.doubleAd":"Watching an ad doubles your rewards!","interMsg.ranked":"Test your skills\nin ranked tournaments","interMsg.friendChallenge":"Challenge your friend\nSee who can score higher!","interMsg.bragChallenge":"Send a challenge to your friend\nClaim bragging rights!","interMsg.clearTiles":"Clear all tiles to\nwin the level!","interMsg.beatClock":"Beat the clock before\ntime runs out!","interMsg.clearBombs":"Clear bombs before\nthey explode","interMsg.seasonPack":"A season pack unlock\nnew tile sets!","interMsg.collectStars":"The more stars you collect\nThe more coins you'll be rewarded!","interMsg.competeInLb":"Compete globally or with friends\nRise to the top in tournaments!","interMsg.competeWithFriends":"You can challenge a friend\nTest each other's reflexes!","interMsg.thunder":"The Thunder power-up\nblasts tiles away","interMsg.hint":"A Hint power-up reveals\nthe next pair","interMsg.pliers":"Pliers can remove\nany bomb instantly","interMsg.tornado":"The Tornado power-up\nshuffles the board!","interMsg.coins":"Earn coins by completing levels\nWin tournaments for even more!","interMsg.seasonTiles":"A new tile set is unlocked\nevery season packs","interMsg.dailyLogin":"Log in daily to claim\nbetter rewards!","interMsg.levelUp":"Level up and earn coins\nwith each victory!","interMsg.seasonRewards":"Each season pack offers\nnew tiles!","error.tryLater":"Sorry, please try again later","error.soon":"Coming Soon","error.noFriendsLb":"Unable to load friends leaderboard. Please try again later.","error.noWorldLb":"Unable to load world leaderboard. Please try again later.","error.createTourFail":"Unknown error. Failed to Create Tournament","error.tourExists":"You already have a tournament","error.challengeFail":"Sorry, you cannot replay\nat this time.","error.rewardFail":"Unable to validate rewards. Please try again later...","error.tourEnded":"Tournament has ended","error.tourJoinFail":"Sorry, you cannot join\nat this time.","error.noAd":"No ads to display.","error.ratingNoAuth":"You need to log in to rate the game.","error.ratingGameRated":"You have already rated the game.","error.ratingFail":"Failed to rate the game.","error.shortcutFail":"Failed to create shortcut.","error.login":"Failed to log in.","error.joinLb":"Failed to join the leaderboard.","reward.day":"Day","reward.dayX":"Day %{0}","reward.starChestTitle":"Star Chest","reward.starChestAvailable":"Congrats, you have enough stars to open the chest!","reward.starChestUnavailable":"Win more stars to open!","item.hint":"Hint","item.thunder":"Thunder","item.storm":"Storm","item.pliers":"Pliers","item.hintDesc":"Shows a pair of tiles\nthat can be connected.","item.thunderDesc":"Remove 2 pair of tiles\non the game field.","item.stormDesc":"Randomly rearranges the \ntiles on the game field.","item.pliersDesc":"Removes a random bomb\nfrom the game field.","theme.newTiles":"New tiles","theme.summer":"Summer Levels","theme.autumn":"Autumn Levels","theme.winter":"Winter Levels","theme.springFestival":"Spring Festival Levels","theme.treePlantingFestival":"Tree Planting Festival Levels","theme.blueSeaFestival":"Blue Sea Festival Levels","theme.musicFestival":"Music Festival Levels","theme.harvestFestival":"Harvest Festival Levels","theme.foodFestival":"Food Festival Levels","theme.snowFestival":"Snow Festival Levels","theme.lightFestival":"Light Festival Levels","theme.peaceFestival":"Peace Festival Levels","theme.flowerFestival":"Flower Festival Levels","theme.streetFestival":"Street Festival Levels","theme.colorGarden":"Color Garden Levels","theme.colorFestival":"Color Festival Levels","theme.natureSummer":"Nature Summer Levels","theme.snowMountain":"Snow Mountain Levels","theme.iceFestival":"Ice Festival Levels","theme.greenGrassFestival":"Green Grass Festival Levels","theme.communityFestival":"Community Festival Levels","theme.waterFestival":"Water Festival Levels","theme.animalFestival":"Animal Festival Levels","theme.lostFestival":"Lost Festival Levels","theme.halloweenFestival":"Halloween Festival Levels","theme.snowMusicFestival":"Snow Music Festival Levels","theme.christmas":"Christmas Levels","theme.springFlowerFestival":"Spring Flower Festival Levels","theme.tetHoliday":"Tet Holiday Levels","theme.seaFestival":"Sea Festival Levels","theme.fireworkFestival":"Firework Festival Levels","theme.halloweenHorror":"Halloween Horror Levels","theme.midAutumn":"Mid Autumn Levels","theme.christmasSweet":"Christmas Sweet Levels","theme.newYearCountdown":"New Year Countdown Levels","theme.happyNewYear":"Happy New Year Levels","share.canYouDoBetter":"Can you do better?","dashboard.unlockLevel":"Unlock lv.%{0}"},texture:{draw:"locales/en/scenes/result-scene/resources/text_draw",lose:"locales/en/scenes/result-scene/resources/text_lose",victory:"locales/en/scenes/result-scene/resources/text_victory",waiting:"locales/en/scenes/result-scene/resources/text_waiting",excellent:"locales/en/scenes/game-scene/resources/effects/text-effect/excellent",good:"locales/en/scenes/game-scene/resources/effects/text-effect/good",great:"locales/en/scenes/game-scene/resources/effects/text-effect/great",wellDone:"locales/en/screens/level-complete-screen/resources/well_done",freeRewards:"locales/en/screens/get-rewards-screen/resources/free_rewards"}};p._RF.push({},"0b4bc6YT6ZGg4lnXfh/zL6J","AdsManager",void 0);var fe=Ludex,ge=fe.Events,me=fe.Configs.Ads,ve=me.Enabled,$e=me.PreloadAds,ye=me.ShowAdOnLoad,we=fe.Utils,Se=we.Time,be=we.Decorator,xe=codex.event,Ee=(le=be.tryCatch(),he=e((de=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){xe.on(ge.AD_CLOSED,t.requestResizeGame$),xe.catchUp(ge.GAME_READY,t.processPreloadAds$),xe.catchUp(ge.GAME_SDK_READY,t.processShowFirstInterstitialAd),xe.catchUp(ge.CONTEXT_DATA_PROCESSED,t.processShowBannerAds$),xe.catchUp(ge.CONTEXT_DATA_PROCESSED,(function(){f.on(H.LAYOUT_CHANGED,t.handleLayoutChanged$)}))},this.requestResizeGame$=function(){xe.emit(ge.REQUEST_RESIZE_GAME)},this.processShowBannerAds$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ve){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Se.sleepAsync(5e3);case 4:z.updateBannerAdsByLayout(B.getCurrentLayout()),z.refreshBannerAdVisibility();case 6:case"end":return e.stop()}}),e)}))),this.processPreloadAds$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($e){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Se.sleepAsync(3e3);case 4:z.preloadAds();case 5:case"end":return e.stop()}}),e)}))),i(this,"processShowFirstInterstitialAd",he,this),this.handleLayoutChanged$=function(){z.updateBannerAdsByLayout(B.getCurrentLayout()),z.refreshBannerAdVisibility()}}return t(e,[{key:"init",value:function(){this.listenEvents$(),console.debug("Ads Manager: Initialized",{Enabled:ve,PreloadAds:$e,ShowAdOnLoad:ye})}}]),e}()).prototype,"processShowFirstInterstitialAd",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return n(r().mark((function e(){var t,n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ve){e.next=2;break}return e.abrupt("return");case 2:if(t=ye.Enabled,n=ye.DelaySeconds,t){e.next=5;break}return e.abrupt("return");case 5:if(!(n>0)){e.next=8;break}return e.next=8,Se.sleepAsync(1e3*n);case 8:return(a=GameSDK.isGameSDK("Yandex"))&&f.pause(),e.next=12,z.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"});case 12:a&&f.resume();case 13:case"end":return e.stop()}}),e)})))}}),de);p._RF.pop(),p._RF.push({},"43001Am3F9GVZjL3Nj2K44h","CoreManager",void 0);var Ae=Ludex.Events,Ce=codex.event,De=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){console.debug("Core Manager: Initialized")}},{key:"requestStart",value:function(){Ce.emit(Ae.REQUEST_CORE_START)}},{key:"onCoreBoot",value:function(e){Ce.catchUp(Ae.CORE_BOOTING,e)}},{key:"onCoreStart",value:function(e){Ce.catchUp(Ae.CORE_STARTING,e)}},{key:"onCoreReady",value:function(e){Ce.catchUp(Ae.CORE_READY,e)}}]),e}();p._RF.pop(),p._RF.push({},"b4ad5mMokdAa6EVNGzNedpF","EngineManager",void 0);var ke,Re,Le,Fe=Ludex,Te=Fe.Events,Pe=Fe.Configs.GameEngine,_e=Pe.DynamicAtlas,Me=Pe.PreferredFPS,Ie=Fe.Utils,Ne=Ie.Valid,Oe=Ie.Device,Ue=codex.event,Ge=function(){function e(){var t=this;a(this,e),this.overrideSettings$=function(){g.overrideSettings(m.Category.ENGINE,"debug",Ne.isDebugger()),v.instance.resizeWithBrowserSize(!1),Oe.isDesktop()?f.frameRate=Me.Desktop:f.frameRate=Me.Mobile},this.setupAutoAtlas$=function(){$.instance.cacheAsset=!0},this.setupAssetDownloader$=n(r().mark((function e(){var n,a,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=$.instance.downloader).maxConcurrency=12,n.maxRequestsPerFrame=12,e.next=5,t.checkWebpSupport$();case 5:a=e.sent,y.hasFeature(y.Feature.WEBP)&&(i=y.hasFeature,y.hasFeature=function(e){return e===y.Feature.WEBP?a:i(e)});case 7:case"end":return e.stop()}}),e)}))),this.checkWebpSupport$=function(){return new Promise((function(e){var t=new Image;t.onload=function(){return e(!0)},t.onerror=function(){return e(!1)},t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))},this.getPipelineFlows$=function(){var e,t;return null!==(e=null===(t=w.root)||void 0===t||null===(t=t.pipeline)||void 0===t?void 0:t.flows)&&void 0!==e?e:[]},this.getRenderQueues$=function(e){var n=t.getPipelineFlows$()[0];return null!=n&&n.stages?n.stages[e].renderQueues:[]},this.setupOptimalCoreLoop$=function(){w.getScheduler()},this.setupOptimalPipelines$=n(r().mark((function e(){var n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$.instance.transformPipeline.remove(1),e.next=4;break;case 4:return e.next=6,Ne.isValueChangeAsync((function(){return!!w.root}),!0,{timeout:1e4});case 6:(n=t.getPipelineFlows$()).shift(),n.shift(),(a=t.getRenderQueues$(0)).shift(),a.shift();case 12:case"end":return e.stop()}}),e)}))),this.setupEngineRunningState$=function(){S.on(b.EventType.TOUCH_START,t.handleResumeEngine$),Ue.catchUp(Te.GAME_READY,(function(){Ue.on(Te.VISIBILITY_HIDDEN,t.handlePauseEngine$),Ue.on(Te.VISIBILITY_VISIBLE,t.handleResumeEngine$)}))},this.handlePauseEngine$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.debug("Engine: Paused",f.isPaused()),!f.isPaused()){e.next=3;break}return e.abrupt("return");case 3:case"end":return e.stop()}}),e)}))),this.handleResumeEngine$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.debug("Engine: Resumed",f.isPaused()),f.isPaused()){e.next=3;break}return e.abrupt("return");case 3:case"end":return e.stop()}}),e)}))),this.setupDynamicAtlas$=function(){y.isBrowser?t.setupDynamicAtlasForBrowser$():y.isNative?t.setupDynamicAtlasForNative$():t.disableDynamicAtlas$()},this.setupDynamicAtlasForBrowser$=function(){switch(y.os){case y.OS.IOS:t.setupDynamicAtlasForIOS$();break;case y.OS.ANDROID:t.setupDynamicAtlasForAndroid$();break;case y.OS.OSX:case y.OS.LINUX:case y.OS.WINDOWS:t.setupDynamicAtlasForDesktop$();break;default:t.setupDynamicAtlasDefault$()}},this.setupDynamicAtlasForNative$=function(){switch(y.platform){case y.Platform.ANDROID:t.setupDynamicAtlasForAndroid$();break;case y.Platform.IOS:t.setupDynamicAtlasForIOS$();break;default:t.setupDynamicAtlasDefault$()}},this.setDynamicAtlas$=function(e){var n=e.Enabled,r=e.MaxAtlasCount,a=e.MaxAtlasSize,i=e.MaxFrameSize,s=x.instance;E.CLEANUP_IMAGE_CACHE=!n,s.enabled=n,s.textureSize=a,s.maxFrameSize=i,s.maxAtlasCount=r,s.textureBleeding=_e.TextureBleeding;var o=t.getMaxTextureSize$()||a,c=Math.min(a,o);s.textureSize=c,i>c&&(s.maxFrameSize=c)},this.getMaxTextureSize$=function(){if(!w.root)return-1;var e=w.root.device.capabilities.maxTextureSize;if(e>8192)return 7168;var t=x.instance.maxFrameSize,n=e-1024;return n<=(void 0===t?0:t)||n<=0?-1:n},this.setupDynamicAtlasForIOS$=function(){var e=_e.IOS;t.setDynamicAtlas$(e)},this.setupDynamicAtlasForAndroid$=function(){var e=_e.Android;t.setDynamicAtlas$(e)},this.setupDynamicAtlasForDesktop$=function(){var e=_e.Desktop;t.setDynamicAtlas$(e)},this.setupDynamicAtlasDefault$=function(){t.setDynamicAtlas$({Enabled:!0,MaxAtlasCount:5,MaxAtlasSize:2048,MaxFrameSize:512})},this.disableDynamicAtlas$=function(){E.CLEANUP_IMAGE_CACHE=!0,x.instance.enabled=!1},this.setupBatcherLimit$=function(){E.BATCHER2D_MEM_INCREMENT=288,E.MAX_LABEL_CANVAS_POOL_SIZE=125}}return t(e,[{key:"init",value:function(){this.overrideSettings$(),this.setupAutoAtlas$(),this.setupBatcherLimit$(),this.setupDynamicAtlas$(),this.setupAssetDownloader$(),this.setupOptimalCoreLoop$(),this.setupOptimalPipelines$(),this.setupEngineRunningState$(),console.debug("Engine Manager: Initialized",{DynamicAtlasConfig:_e,PreferredFPS:Me})}}]),e}();p._RF.pop(),p._RF.push({},"9f0a0l1uXlNwqKEKardFRyv","LayoutManager",void 0);var ze=V.Layout,He=V.DesignSize,Be=He.Portrait,Ve=He.Landscape,je=V.AcceptPortraitRatio,Ye=Ludex,qe=Ye.Utils,We=qe.Device,Qe=qe.Decorator,Ke=Ye.Configs.GameEngine.AutoResizeCanvas,Xe=Ye.Events,Je=codex,Ze=Je.ads,et=Je.event,tt=(ke=Qe.debounce(100),Le=e((Re=function(){function e(){var t=this;a(this,e),this.listenResizeEvent$=function(){if(Ke&&ResizeObserver){var e,n=null!==(e=window.__listeners.resize)&&void 0!==e?e:[];if(n.length>0){var r,a=s(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;window.removeEventListener("resize",i)}}catch(e){a.e(e)}finally{a.f()}}new ResizeObserver(t.handleBodyResize).observe(window.document.body)}et.on(Xe.REQUEST_RESIZE_GAME,t.handleViewResizeBySystem$)},this.setupResolutionPolicy$=function(){A.setOrientation(E.ORIENTATION_AUTO),t.resolutionPolicy$=A.getResolutionPolicy(),t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.EXACT_FIT),t.resolutionPolicy$.setContainerStrategy(C.ContainerStrategy.PROPORTION_TO_FRAME)},this.isAdShowing$=function(){return!(null==Ze||!Ze.isAdFullSizeShowing())&&(console.error("⚠️ LayoutManager:handleViewResize skipped because ad is showing"),!0)},this.handleViewResizeBySystem$=function(e){if(!t.isAdShowing$()){var n=We.pixelRatio(),r=Math.min(n,2),a=(null!=e?e:{}).forcePixelRatio,i=void 0===a?r:a;console.debug("📱 View resize by system",{forcePixelRatio:i,dpr:n,maxDpr:r}),window.devicePixelRatio=null!=i?i:r,t.setupOrientationByCanvasSize$()}},i(this,"handleBodyResize",Le,this),this.setupOrientationByCanvasSize$=function(){var e=t.getScreenRatio$();switch(V.PRIMARY_LAYOUT){case"portrait":t.setPortraitView$();break;case"landscape":t.setLandscapeView$();break;case"auto":e<=je?t.setPortraitView$():t.setLandscapeView$()}},this.setPortraitView$=function(){var e=Be.WIDTH,n=Be.HEIGHT,r=V.PRIMARY_LAYOUT===ze.Portrait;(t.currentLayout$!==ze.Portrait||r)&&(t.currentLayout$=ze.Portrait,t.setupLayoutStrategy$(e,n)),t.resizeGameView$(e,n)},this.setLandscapeView$=function(){var e=Ve.WIDTH,n=Ve.HEIGHT,r=V.PRIMARY_LAYOUT===ze.Landscape;(t.currentLayout$!==ze.Landscape||r)&&(t.currentLayout$=ze.Landscape,t.setupLayoutStrategy$(e,n)),t.resizeGameView$(e,n)},this.setupLayoutStrategy$=function(e,n){var r=A.getDesignResolutionSize(),a=r.width,i=r.height,s=t.resolutionPolicy$.getContentStrategy(),o=t.resolutionPolicy$._containerStrategy.name,c=t.currentLayout$===ze.Portrait,u=t.currentLayout$===ze.Landscape;c&&t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.FIXED_WIDTH),u&&t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.FIXED_HEIGHT),c&&!V.FULL_PORTRAIT_SIZE&&(t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.SHOW_ALL),t.resolutionPolicy$.setContainerStrategy(C.ContainerStrategy.PROPORTION_TO_FRAME)),u&&!V.FULL_LANDSCAPE_SIZE&&(t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.EXACT_FIT),t.resolutionPolicy$.setContainerStrategy(C.ContainerStrategy.PROPORTION_TO_FRAME)),t.getScreenRatio$()>V.AcceptPortraitRatio&&c&&t.resolutionPolicy$.setContentStrategy(C.ContentStrategy.FIXED_HEIGHT),c&&t.resolutionPolicy$.setContainerStrategy(C.ContainerStrategy.EQUAL_TO_FRAME),u&&t.resolutionPolicy$.setContainerStrategy(C.ContainerStrategy.EQUAL_TO_FRAME),a===e&&i===n&&s===t.resolutionPolicy$.getContentStrategy()&&o===t.resolutionPolicy$._containerStrategy.name||A.setDesignResolutionSize(e,n,t.resolutionPolicy$),console.debug("🔥 Change layout to",t.currentLayout$,t.resolutionPolicy$),f.emit(H.LAYOUT_CHANGED,t.currentLayout$)},this.resizeGameView$=function(e,n){var r=V.DesignSize.Resolution,a=new D(e/r,n/r),i=j.getScreenWidthCss(),s=j.getScreenHeightCss(),o=i/a.width,c=s/a.height,u=new D(a.width,a.height),l=t.currentLayout$===ze.Portrait,d=t.currentLayout$===ze.Landscape;if(l||d)u.width*=o,u.height*=c;else{var h=Math.min(o,c);u.width*=h,u.height*=h}var p=j.worldSizeToCssSize(u.width),g=j.worldSizeToCssSize(u.height),m=new D(p,g);k.windowSize=m,f.emit(H.VIEW_RESIZED,m),console.info("📐 View Resized",m)},this.getScreenRatio$=function(){return j.getScreenWidthCss()/j.getScreenHeightCss()}}return t(e,[{key:"init",value:function(){this.listenResizeEvent$(),this.setupResolutionPolicy$(),console.debug("Layout Manager: Initialized",{AcceptPortraitRatio:je,AutoResizeCanvas:Ke})}}]),e}()).prototype,"handleBodyResize",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(!e.isAdShowing$()){var t=We.pixelRatio(),n=Math.min(t,2);console.debug("📱 View resize by body",{dpr:t,maxDpr:n}),window.devicePixelRatio=n,e.setupOrientationByCanvasSize$()}}}}),Re);p._RF.pop(),p._RF.push({},"535cbXcmXdEzLn3H3LOIS27","MatchManager",void 0);var nt=Ludex,rt=nt.Utils,at=rt.Valid,it=rt.Object,st=rt.Array,ot=nt.Dtos.Match,ct=(void 0===ot?{}:ot).CustomData,ut=["code","cols","encoding","idSize","rows"],lt=["addRandomTilesPerMove","maxSpaceOfPair"],dt=function(){function e(){var t=this;a(this,e),this.setupMatchCustomData$=function(){ct&&(ct.addDefaults(Y),ct.addValidator("score",(function(e){if(!at.isNumber(e)||e<0)throw new Error("score ".concat(e," is invalid"))})))},this.setupMatchData$=function(){ct&&ct.addValidator("challengeData",(function(e){if(null!=e){if(!at.isObject(e))throw new Error("challengeData ".concat(e," must be a record of string keys"));var n=e,r=Object.keys(n);if(!st.has(r,"level"))throw new Error("challengeData.level is missing");if(!at.isNumber(n.level))throw new Error("challengeData.level ".concat(n.level," must be a number"));if(!st.has(r,"fen"))throw new Error("challengeData.fen is missing");if(t.validateFen$(n.fen),!st.has(r,"gravity"))throw new Error("challengeData.gravity is missing");if(!at.isString(n.gravity))throw new Error("challengeData.gravity ".concat(n.gravity," must be a string"));if(!st.has(r,"rules"))throw new Error("challengeData.rules is missing");if(t.validateLevelRules$(n.rules),!st.has(r,"time"))throw new Error("challengeData.time is missing");if(!at.isNumber(n.time))throw new Error("challengeData.time ".concat(n.time," must be a number"))}}))},this.validateFen$=function(e){if(!at.isObject(e))throw new Error("challengeData.fen ".concat(e," must be a record of string keys"));var n=t.validateKeys$(e,ut);if(!at.isNumber(n.idSize))throw new Error("fen.idSize must be a number");if(!at.isString(n.code))throw new Error("fen.code must be a string");if(!at.isNumber(n.rows))throw new Error("fen.rows must be a number");if(!at.isNumber(n.cols))throw new Error("fen.cols must be a number");if(!at.isObject(n.encoding))throw new Error("fen.encoding must be a record of string keys");var r=t.validateKeys$(n.encoding,it.vals(q));Object.entries(r).forEach((function(e){var t=o(e,2),n=t[0],r=t[1];if(!at.isString(r))throw new Error("fen.encoding.".concat(n," ").concat(r," must be a string"))}))},this.validateLevelRules$=function(e){if(!at.isObject(e))throw new Error("challengeData.rules ".concat(e," must be a record of string keys"));var n=t.validateKeys$(e,lt);if(!at.isNumber(n.addRandomTilesPerMove))throw new Error("rules.addRandomTilesPerMove must be a number");if(!at.isNumber(n.maxSpaceOfPair))throw new Error("rules.maxSpaceOfPair must be a number")},this.validateKeys$=function(e,t){return Object.keys(e).forEach((function(e){if(!st.has(t,e))throw new Error("Key ".concat(e," is missing"))})),e}}return t(e,[{key:"init",value:function(){console.debug("Match Manager: Initialized")}},{key:"setupDefaultMatchData",value:function(){this.setupMatchData$(),this.setupMatchCustomData$()}}]),e}();p._RF.pop(),p._RF.push({},"d675ctpYslBHp4qqiYEki+q","PlayerManager",void 0);var ht=Ludex,pt=ht.Utils,ft=pt.Valid,gt=pt.Array,mt=pt.Object,vt=ht.Dtos.Player,$t=codex.player,yt=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){console.debug("Player Manager: Initialized")}},{key:"setupDefaultGameData",value:function(){vt.Data.addDefaults(W),vt.GameData.addDefaults(Q),vt.GameData.addValidator("stars",(function(e){if(!ft.isNumber(e)||e<0)throw new Error("stars ".concat(e," is invalid"))})),vt.GameData.addValidator("totalLevel",(function(e){ft.isNumber(e)})),vt.GameData.addValidator("levelVersion",(function(e){if(!ft.isNumber(e)||e<0)throw new Error("levelVersion ".concat(e," is invalid"))})),vt.GameData.addValidator("lastRewardedItems",(function(e){if(!ft.isNumber(e)||e<0)throw new Error("lastRewardedItems ".concat(e," is invalid"))})),vt.GameData.addValidator("lastCreateTournamentShown",(function(e){if(!ft.isNumber(e)||e<0)throw new Error("lastCreateTournamentShown ".concat(e," is invalid"))})),vt.GameData.addValidator("guideItemShowed",(function(e){if(!Array.isArray(e))throw new Error("guideItemShowed ".concat(e," is invalid"))})),vt.GameData.addValidator("items",(function(e){if(!ft.isObject(e))throw new Error("items ".concat(e," is invalid"));var t=Object.keys(e),n=mt.vals(e);if(!gt.has(t,K.HINT))throw new Error("item ".concat(K.HINT," not found"));if(!gt.has(t,K.THUNDER))throw new Error("item ".concat(K.THUNDER," not found"));if(!gt.has(t,K.STORM))throw new Error("item ".concat(K.STORM," not found"));if(!gt.has(t,K.PLIERS))throw new Error("item ".concat(K.PLIERS," not found"));n.forEach((function(e){if(!ft.isNumber(e)||e<0)throw new Error("item ".concat(e," is invalid"))}))})),vt.GameData.addValidator("tournamentProgress",(function(e){if(!ft.isObject(e))throw new Error("tournamentProgress ".concat(e," is invalid"))})),vt.GameData.addValidator("custom",(function(e){if(!ft.isObject(e))throw new Error("custom ".concat(e," is invalid"));var t=Object.keys(e);if(!gt.has(t,"time"))throw new Error("custom time not found");if(!gt.has(t,"difficulty"))throw new Error("custom tiles not found");if(!gt.has(t,"bombs"))throw new Error("custom bombs not found");if(!gt.has(t,"ads"))throw new Error("custom ads not found")})),vt.GameData.addValidator("endlessScore",(function(e){if(!ft.isNumber(e)||e<0)throw new Error("endlessScore ".concat(e," is invalid"))}))}},{key:"requestConnectedPlayers",value:function(){$t.requestConnectedPlayers().catch((function(e){console.warn("player.requestConnectedPlayers",e)}))}}]),e}();p._RF.pop(),p._RF.push({},"51079bCfn9MZK6cuxbahS7M","AdaptivePerformance",void 0);var wt=Ludex.Utils.Valid,St=codex.adaptivePerformance,bt=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){w.once(R.EVENT_BEGIN_FRAME,t.handleBeginFrame$),w.on(R.EVENT_AFTER_SCENE_LAUNCH,t.handleAfterSceneLaunch$)},this.handleBeginFrame$=function(){w.on(R.EVENT_AFTER_UPDATE,t.lateUpdate$),w.on(R.EVENT_BEFORE_UPDATE,t.updateActualFPS$)},this.handleAfterSceneLaunch$=function(e){St&&St.trackingScene(e.name)},this.lateUpdate$=function(){var e=1e3*f.deltaTime;null==St||St.updatePostStepDeltaTime(e)},this.updateActualFPS$=function(){var e,t=null===(e=w.root)||void 0===e?void 0:e.fps;wt.isNumber(t)&&(null==St||St.updateActualFPS(t))}}return t(e,[{key:"init",value:function(){St&&this.listenEvents$()}}]),e}();p._RF.pop(),p._RF.push({},"0bbd4wf2fRDcKljBcls6K8a","CanvasRecorder",void 0);var xt=codex.canvasRecorder,Et=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){if(f.canvas&&xt){xt.setCanvas(f.canvas);var e=xt.getOptions(),t=function(){f.pause(),f.step()},n=xt.waitNextFrame;xt.waitNextFrame=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(a,i){r||xt.isCapturing()?e.syncFps?(w.once(R.EVENT_AFTER_RENDER,a),t()):n(r).then(a).catch(i):f.resume()}))}}}}]),e}();p._RF.pop(),p._RF.push({},"e8b3dVomjtKZ68ykoRs82vP","DailyRewards",void 0);var At,Ct,Dt=codex.storage,kt=function(){function e(){a(this,e),this.initStorage$=function(){Dt.addStorage("dashboardDailyRewards",{hasShownPopup:!1})}}return t(e,[{key:"init",value:function(){this.initStorage$()}}]),e}();p._RF.pop(),p._RF.push({},"49a72YoKFFCKbOm5Xgp9R+k","DynamicAssets",void 0);var Rt,Lt,Ft,Tt,Pt,_t=Ludex,Mt=_t.Configs.GameEngine.DynamicAssets,It=Mt.Resolution,Nt=Mt.IgnoreFiles,Ot=_t.Events,Ut=_t.Utils,Gt=Ut.Array,zt=Ut.Function,Ht=Ut.Time,Bt=Ut.Decorator,Vt=codex,jt=Vt.event,Yt=Vt.storage,qt=Vt.getBuildVersion,Wt=[".png",".jpg",".jpeg",".webp"],Qt=(At=Bt.debounce(1e3),e((Ct=function(){function e(){var t=this;a(this,e),this.isProcessing=!1,this.useHighQuality$=!1,this.upgradedAssets$={},this.upgradableAssets$={},this.initStorage$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yt.addStorage("DynamicAssets",{useHighQuality:!1,buildVersion:"0"},!0);case 2:case"end":return e.stop()}}),e)}))),this.checkCacheVersion$=function(){var e=qt().toString(),n=Yt.getStorage("DynamicAssets"),r=null!=n?n:{},a=r.buildVersion,i=r.useHighQuality;"boolean"==typeof i&&(t.useHighQuality$=i&&a===e),Yt.setStorageData("DynamicAssets","buildVersion",e),Yt.updateToWebStorage("DynamicAssets")},this.listenEvents$=function(){t.useHighQuality$||jt.catchUp(Ot.GAME_READY,(function(){t.useHighQuality$=!0,f.on(H.REQUEST_UPGRADE_ASSET,t.handleChangeQuality)}))},this.injectTextureResolution$=function(){var e=It.Adjust,t=It.Original;if(!(e>=t||t<=0)){var n=e/t;Object.defineProperty(L.prototype,"width",{get:function(){var e,t;return this.isValid?this.uuid?(null===(e=this.image.data)||void 0===e||null===(e=e.src)||void 0===e?void 0:e.indexOf("native32/"))>=0?this._width:(null===(t=this.image)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.width)/n||this._width:this._width/n:this._width}}),Object.defineProperty(L.prototype,"height",{get:function(){var e,t;return this.isValid?this.uuid?(null===(e=this.image.data)||void 0===e||null===(e=e.src)||void 0===e?void 0:e.indexOf("native32/"))>=0?this._height:(null===(t=this.image)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.height)/n||this._height:this._height/n:this._height}})}},this.replaceAssetUrl$=function(e){return t.useHighQuality$?e.replace("native/","native32/"):e},this.saveStateToStorage$=function(){Yt.setStorageData("DynamicAssets","useHighQuality",t.useHighQuality$),Yt.updateToWebStorage("DynamicAssets",!0)},this.updateSpriteFrames$=n(r().mark((function e(){var n,a,i,o,c,u,l,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=w.getScene()){e.next=3;break}return e.abrupt("return");case 3:a=n.getComponentsInChildren("cc.Sprite"),i=s(a),e.prev=5,i.s();case 7:if((o=i.n()).done){e.next=21;break}if(u=o.value,null!=(l=u.spriteFrame)&&l.texture){e.next=12;break}return e.abrupt("continue",19);case 12:if(d=l.texture,t.upgradedAssets$[null===(c=d.image)||void 0===c?void 0:c.uuid]){e.next=15;break}return e.abrupt("continue",19);case 15:return u.node.layer=F.Enum.UI_2D,d.updateImage(),e.next=19,Ht.sleepAsync(16);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),i.e(e.t0);case 26:return e.prev=26,i.f(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[5,23,26,29]])}))),this.requestUpdateDynamicAssets$=function(){f.emit(H.UPGRADE_DYNAMIC_ATLAS,{force:!0})},this.collectUpgradableAssets$=function(e){var n,r=e.output=e.input,a=It.Adjust,i=It.Original,o=a<i?a:i,c=!1,u=s(r);try{for(u.s();!(n=u.n()).done;){var l=n.value;if(Gt.has(Wt,l.ext)&&(!Gt.has(Nt,l.uuid)&&(l.url=t.replaceAssetUrl$(l.url),!(l.uuid in t.upgradableAssets$)))){var d={ext:l.ext,url:l.url,uuid:l.uuid,options:l.options,resolution:o};t.upgradableAssets$[l.uuid]=d,c=!0}}}catch(e){u.e(e)}finally{u.f()}c&&f.emit(H.REQUEST_UPGRADE_ASSET)},this.processUpgradeQualityAsync$=function(){var e=n(r().mark((function e(n){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=T.assets.get(n.uuid))instanceof P){e.next=5;break}return console.warn("DynamicAssets: Asset not found",n.uuid,a),t.upgradedAssets$[n.uuid]=!1,e.abrupt("return",!1);case 5:return n.url=t.replaceAssetUrl$(n.url),e.abrupt("return",new Promise((function(e){T.loadAny(n,n.options,(function(r,i){if(r)return console.warn("DynamicAssets: Upgrade error",r),t.upgradedAssets$[n.uuid]=!1,void e(!1);a.reset(i),a._nativeUrl=t.replaceAssetUrl$(a.nativeUrl),t.upgradedAssets$[n.uuid]=!0,f.emit(H.ASSET_QUALITY_CHANGE,{asset:a,item:n}),e(!0)}))})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var i,o;return t(e,[{key:"init",value:(o=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,this.initStorage$();case 4:this.checkCacheVersion$(),T.transformPipeline.insert(this.collectUpgradableAssets$,2),this.useHighQuality$||this.injectTextureResolution$(),this.listenEvents$();case 9:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"handleChangeQuality",value:(i=n(r().mark((function e(){var t,n,a,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isProcessing){e.next=2;break}return e.abrupt("return");case 2:e.prev=2,this.isProcessing=!0,t=[],e.t0=r().keys(this.upgradableAssets$);case 6:if((e.t1=e.t0()).done){e.next=15;break}if(n=e.t1.value,(a=this.upgradableAssets$[n])&&!this.upgradedAssets$[n]){e.next=11;break}return e.abrupt("continue",6);case 11:i=this.processUpgradeQualityAsync$(a),t.push(i),e.next=6;break;case 15:if(!(t.length<1)){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,zt.allSettled(t);case 19:return this.saveStateToStorage$(),e.next=22,this.updateSpriteFrames$();case 22:this.requestUpdateDynamicAssets$(),e.next=28;break;case 25:e.prev=25,e.t2=e.catch(2),console.warn("DynamicAssets: Handle change quality error",e.t2);case 28:return e.prev=28,this.isProcessing=!1,e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[2,25,28,31]])}))),function(){return i.apply(this,arguments)})}]),e}()).prototype,"handleChangeQuality",[At],Object.getOwnPropertyDescriptor(Ct.prototype,"handleChangeQuality"),Ct.prototype),Ct);p._RF.pop(),p._RF.push({},"15ecbqnx5lFtYRSJp2lOLCm","DynamicAtlas",void 0);var Kt=Ludex,Xt=Kt.Events,Jt=Kt.Configs.GameEngine.DynamicAtlas,Zt=Jt.AutoAtlasSize,en=Jt.UsePowerOfTwo,tn=Jt.AllowNonePackable,nn=Jt.TextureAtlasOptimize,rn=Jt.OnlyOptimizeWhenRenderTooLong,an=Kt.Utils,sn=an.Array,on=an.Json,cn=an.Object,un=an.Image,ln=an.Valid,dn=an.Decorator,hn=codex.event,pn=(Rt=dn.debounce(2e3),Lt=dn.debounce(2e3),Ft=dn.debounce(1e3),e((Tt=function(){function e(){var t=this;a(this,e),this.drawInfo$=[],this.atlasInfo$=null,this.lastAtlasInfo$=null,this.renderTimes$=[],this.lastRenderTime$=0,this.renderTimeInterval$=5e3,this.maxRecordRenderTimes$=100,this.isEffective$=!0,this.isProcessing$=!1,this.forceUpdateDynamicAtlas$=!1,this.collectInfo$={},this.pendingSprites$={},this.pendingTextureAtlas$={},this.debugCanvases$={},this.listenEvents$=function(){f.on(H.UPGRADE_DYNAMIC_ATLAS,t.requestUpdateDynamicAtlas$,t),hn.on(Xt.SWITCH_SCENE,t.resetPendingInfo$),hn.on(Xt.SCENE_RENDERED,t.requestUpdateDynamicAtlas$),hn.catchUp(Xt.GAME_READY,t.setupRenderListeners$)},this.setupRenderListeners$=function(){w.on(R.EVENT_BEFORE_RENDER,t.updateBeforeRenderTime$),w.on(R.EVENT_AFTER_RENDER,t.updateAfterRenderTime$),rn&&hn.catchUp(Xt.SCENE_LAUNCHED,(function(){w.once(R.EVENT_AFTER_RENDER,t.checkRenderTimeHighers$)}))},this.checkRenderTimeHighers$=function(){var e=t.getMeanRenderTime$();e>8&&t.handleLaggyFrame$(e),w.once(R.EVENT_AFTER_RENDER,(function(){setTimeout(t.checkRenderTimeHighers$,t.renderTimeInterval$)}))},this.handleLaggyFrame$=function(e){console.warn("DynamicAtlas: Laggy frame detected, render time: ".concat(e.toFixed(2),"ms")),t.isEffective$||(t.renderTimeInterval$=Math.min(t.renderTimeInterval$+1e3,1e4),console.warn("DynamicAtlas: Atlas update not effective. Increased interval: ".concat(t.renderTimeInterval$,"ms"))),t.requestUpdateDynamicAtlas$()},this.resetPendingInfo$=function(){t.pendingSprites$={},t.pendingTextureAtlas$={}},this.updateBeforeRenderTime$=function(){t.lastRenderTime$=performance.now()},this.updateAfterRenderTime$=function(){t.renderTimes$.length>=t.maxRecordRenderTimes$&&(t.renderTimes$.length=0);var e=performance.now()-t.lastRenderTime$;t.renderTimes$.push(e)},this.getMeanRenderTime$=function(){var e,n=0,r=s(t.renderTimes$);try{for(r.s();!(e=r.n()).done;){n+=e.value}}catch(e){r.e(e)}finally{r.f()}return n/=t.renderTimes$.length,t.renderTimes$=[],n},this.overrideDynamicAtlas$=function(){var e=x.instance;e.packToDynamicAtlas=function(t,n){if(n&&!n.original&&(n.packable||tn)){var r=e.insertSpriteFrame(n);r&&n._setDynamicAtlasFrame(r)}},e.insertSpriteFrame=function(n){if(!e.enabled)return null;var r=e.maxAtlasCount,a=(e._atlases,e._atlasIndex),i=void 0===a?-1:a;if(i>=r)return null;try{var s=t.tryInsertSpriteFrame$(n);return s||i>=r?s:s=t.tryInsertSpriteFrame$(n)}catch(e){return null}}},this.tryInsertSpriteFrame$=function(e){var n=t.getAtlas$();if(!n)throw new Error("DynamicAtlas: Atlas not found");if(sn.has(n._innerSpriteFrames,e))throw new Error("DynamicAtlas: Sprite frame already exists");var r=n.insertSpriteFrame(e);if(!1===r)throw new Error("DynamicAtlas: Failed to insert sprite frame");return r},this.requestUpdateDynamicAtlas$=function(e){var n=(e||{}).force;t.isProcessing$&&!n||(t.forceUpdateDynamicAtlas$||(t.forceUpdateDynamicAtlas$=n||!1),t.updateDynamicAtlas())},this.createAtlas$=function(){var e=x.instance.newAtlas();if(e&&ln.isDebugger()){var n=x.instance.textureSize,r=document.createElement("canvas");r.width=n,r.height=n;var a=t.getAtlasIndex$();t.debugCanvases$[a]=r}return e},this.getAtlas$=function(e){var n=x.instance,r=n._atlases,a=void 0===r?[]:r,i=n._atlasIndex,s=n.textureBleeding,o=a[e||i];return o||(o=t.createAtlas$()),o?(o.originalInsertSpriteFrame||(o.originalInsertSpriteFrame=o.insertSpriteFrame,o.insertSpriteFrame=function(e){return t.drawTexture$(o,e,s)}),o):null},this.getAtlasIndex$=function(){return x.instance._atlasIndex},this.getAtlasSize$=function(){var e=t.getAtlas$(),n=x.instance.textureSize;return e&&e._texture?{w:e._texture.width,h:e._texture.height}:{w:n,h:n}},i(this,"printAtlasTextures$",Pt,this),this.collectAllSpriteFrames$=function(){var e=w.getScene();if(e){var n,r=e.getComponentsInChildren("cc.UIRenderer"),a=s(r);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.spriteFrame;if(i.enabled&&o&&o.texture&&(o.packable||tn)){var c=o.uuid||o._id;c&&(t.pendingSprites$[c]||(i.node.layer=F.Enum.UI_2D,t.pendingSprites$[c]=o))}}}catch(e){a.e(e)}finally{a.f()}}},this.getTextureSize$=function(e){var t=e.texture,n=e.original;return null!=n&&n._texture?{w:n._texture.width||0,h:n._texture.height||0}:{w:t.width,h:t.height}},this.isTextureTooLarge$=function(e){var t=x.instance.maxFrameSize;return e.w>=t||e.h>=t},this.calculateExcessDimensions$=function(e,t,n){var r=.1*Math.min(n.w,n.h);return{excessWidth:Math.max(0,e-n.w+r),excessHeight:Math.max(0,t-n.h+r)}},this.tryRemoveExcessTextures$=function(e,n,r){var a,i=0,o=0,c=[],u=[],l=t.getAtlasIndex$(),d=s(e);try{for(d.s();!(a=d.n()).done;){var h=a.value;if(n>0&&i<n||r>0&&o<r){i+=h.w,o+=h.h,u.push(h);var p=t.pendingTextureAtlas$[h.id]||l;t.pendingTextureAtlas$[h.id]=Math.min(p,l)}else c.push(h)}}catch(e){d.e(e)}finally{d.f()}return u.length>0&&(e.length=0,e.push.apply(e,c),!0)},this.collectPackageInfo$=function(){tn&&t.collectAllSpriteFrames$();var e,n=cn.vals(t.pendingSprites$),r={},a=s(n);try{for(a.s();!(e=a.n()).done;){var i,o=e.value,c=o.texture,u=o.original,l=o.refCount,d=c.getId();d=(null==u||null===(i=u._texture)||void 0===i?void 0:i.getId())||d;var h=t.getTextureSize$(o);if(d)if(t.isTextureTooLarge$(h))console.debug("DynamicAtlas: skip too large texture",d,h);else{t.collectInfo$[d]||t.initializeCollectInfo$(d,h);var p=t.collectInfo$[d];p?(p.usageCount+=l,r[d]=p):console.debug("DynamicAtlas: skip missing texture info",d)}else console.debug("DynamicAtlas: skip missing texture",o)}}catch(e){a.e(e)}finally{a.f()}return console.debug("DynamicAtlas: Collect package info",r,Object.keys(r).length),r},this.initializeCollectInfo$=function(e,n){var r=n.w+2,a=n.h+2;r<=2||a<=2||(t.collectInfo$[e]={id:e,w:r,h:a,x:-1,y:-1,usageCount:0})},this.generateDrawInfo$=function(e){if(!(e.length<1)){var n=e.sort((function(e,t){return t.usageCount-e.usageCount})),r=t.getAtlasSize$();if(t.calculateOptimizedAtlas$(n,r),t.atlasInfo$){var a,i=t.atlasInfo$.textures,o=s(i);try{for(o.s();!(a=o.n()).done;){var c=a.value;t.drawInfo$.push(c)}}catch(e){o.e(e)}finally{o.f()}var u=n.filter((function(e){return!i.some((function(t){return t.id===e.id}))}));u.length>0&&(console.warn("DynamicAtlas: Missing textures",u),t.generateDrawInfo$(u))}}},this.calculateOptimizedAtlas$=function(e,n){var r=function(e){var t,n=0,r=0,a=s(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n+=i.w*i.h,r=Math.max(r,i.w)}}catch(e){a.e(e)}finally{a.f()}e.sort((function(e,t){return t.h-e.h}));var o,c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),r),h:1/0}],u=0,l=0,d=s(e);try{for(d.s();!(o=d.n()).done;)for(var h=o.value,p=c.length-1;p>=0;p--){var f=c[p];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,l=Math.max(l,h.y+h.h),u=Math.max(u,h.x+h.w),h.w===f.w&&h.h===f.h){var g=c.pop();p<c.length&&(c[p]=g)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):h.w===f.w?(f.y+=h.h,f.h-=h.h):(c.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}catch(e){d.e(e)}finally{d.f()}return{w:u,h:l,fill:n/(u*l)||0}}(c(e)),a=r.w,i=r.h,o=r.fill;if(o<.6)console.warn("DynamicAtlas: Fill rate is too low",o,c(e));else if(a>n.w||i>n.h){var u=t.calculateExcessDimensions$(a,i,n),l=u.excessWidth,d=u.excessHeight;t.tryRemoveExcessTextures$(e,l,d)?t.calculateOptimizedAtlas$(e,n):console.warn("DynamicAtlas: No suitable textures to remove",{w:a,h:i,atlasSize:n})}else{var h=t.getAtlasIndex$();t.atlasInfo$={textures:e,atlasSize:n,atlasIndex:h,packedInfo:{width:Math.round(a),height:Math.round(i),fillRate:o}},console.info("DynamicAtlas: atlas info",t.atlasInfo$)}},this.updateAtlasData$=function(){if(!t.atlasInfo$)return!1;if(t.lastAtlasInfo$&&!t.forceUpdateDynamicAtlas$){var e=t.isSameAtlas$(t.lastAtlasInfo$,t.atlasInfo$);if(t.isEffective$=!e,e)return console.warn("DynamicAtlas: Last update dynamic atlas is not effective",x.instance),!1}var n=t.getAtlas$();if(!n||!n._texture)return!1;var r=t.atlasInfo$.packedInfo,a=n._texture,i=a.width,s=a.height,o={width:i,height:s},c=r.width+5,u=r.height+5,l=Math.max(c,u);if(l<=5)return!1;var d=en?l:c,h=en?l:u;if(!(o.width!==d||o.height!==h))return!1;console.debug("DynamicAtlas: Update atlas data",{newWidth:d,newHeight:h,currentSize:o,UsePowerOfTwo:en}),n.reset();var p=t.getAtlasIndex$(),f=t.debugCanvases$[p];if(f){var g=f.getContext("2d");null==g||g.clearRect(0,0,f.width,f.height)}return(Zt||(d>i||h>s))&&(n._texture.initWithSize(d,h),f&&(f.width=d,f.height=h)),t.lastAtlasInfo$=on.clone(t.atlasInfo$),!0},this.drawTexture$=function(e,n,r){var a,i,s=n.texture,o=s.image;if(!o)return null;var c=s.getId(),u=n.uuid||n._id||c,l=sn.search(t.drawInfo$,(function(e){return e.id===c}))||{x:-1,y:-1},d=l.x,h=l.y;if(d<0||h<0)return u&&!t.pendingSprites$[u]&&(t.pendingSprites$[u]=n,rn||t.requestUpdateDynamicAtlas$()),null;var p=r?2:0;d+=p,h+=p;var f=e._innerTextureInfos[c];f||(r&&((o.width<=8||o.height<=8)&&(e._texture.drawTextureAt(o,d-1,h-1),e._texture.drawTextureAt(o,d-1,h+1),e._texture.drawTextureAt(o,d+1,h-1),e._texture.drawTextureAt(o,d+1,h+1)),e._texture.drawTextureAt(o,d-1,h),e._texture.drawTextureAt(o,d+1,h),e._texture.drawTextureAt(o,d,h-1),e._texture.drawTextureAt(o,d,h+1)),e._texture.drawTextureAt(o,d,h),t.drawDebugFrame$({spriteFrame:n,texId:c,id:u,x:d,y:h,textureBleeding:r}),e._count++,e._innerTextureInfos[c]={texture:s,x:d,y:h});var g=n.rect,m=g.x,v=g.y,$={x:m+=null!==(a=null==f?void 0:f.x)&&void 0!==a?a:d,y:v+=null!==(i=null==f?void 0:f.y)&&void 0!==i?i:h,texture:e._texture};return d-=p,h-=p,e._innerSpriteFrames.push(n),$},this.drawDebugFrame$=function(e){var n=t.getAtlasIndex$(),r=t.debugCanvases$[n];if(r){var a=e.spriteFrame,i=e.texId,s=e.x,o=e.y,c=e.textureBleeding,u=a.texture.image,l=r.getContext("2d"),d=u.data;if(l&&d&&(d instanceof HTMLCanvasElement||d instanceof HTMLImageElement)){c&&((u.width<=8||u.height<=8)&&(l.drawImage(d,s-1,o-1),l.drawImage(d,s-1,o+1),l.drawImage(d,s+1,o-1),l.drawImage(d,s+1,o+1)),l.drawImage(d,s-1,o),l.drawImage(d,s+1,o),l.drawImage(d,s,o-1),l.drawImage(d,s,o+1)),l.drawImage(d,s,o);var h=a.rect,p=a.rotated,f=s,g=o,m=p?h.height:h.width,v=p?h.width:h.height;c&&(f-=1,g-=1,m+=2,v+=2),l.strokeStyle="rgba(255, 0, 0, 0.75)",l.lineWidth=1,l.strokeRect(f+.5,g+.5,m,v),l.font="22px Arial",l.textAlign="left",l.textBaseline="top";var $=l.measureText(i).width,y=f+10,w=g+10;l.fillStyle="rgba(0, 50, 0, 0.8)",l.fillRect(y-4,w-4,$+8,30),l.fillStyle="rgba(255, 255, 255, 0.95)",l.fillText(i,y,w)}}},this.refreshComponents$=function(){var e=w.getScene();if(e){var t,n=e.getComponentsInChildren("cc.UIRenderer"),r=s(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.enabled&&(a.node.active&&a.node.activeInHierarchy&&(a.node.active=!1,a.node.active=!0))}}catch(e){r.e(e)}finally{r.f()}}},this.isSameAtlas$=function(e,t){if(!e||!t)return!1;var n=e.textures,r=t.textures;if(n.length!==r.length)return!1;var a=n.slice().sort((function(e,t){return e.id.localeCompare(t.id)})),i=r.slice().sort((function(e,t){return e.id.localeCompare(t.id)}));return a.every((function(e,t){var n=i[t];if(!n)return!1;var r=e.id,a=e.w,s=e.h,o=n.id,c=n.w,u=n.h;return r===o&&(a===c&&s===u)}))}}return t(e,[{key:"init",value:function(){x.instance.enabled&&nn&&(this.listenEvents$(),this.overrideDynamicAtlas$())}},{key:"updateDynamicAtlas",value:function(){try{if(!w.getScene())return;w.stopAnimation();var e=this.collectPackageInfo$();if(Object.keys(e).length<1)return;if(this.drawInfo$=[],this.atlasInfo$=null,this.isProcessing$=!0,this.generateDrawInfo$(cn.vals(e)),!this.atlasInfo$)return;if(!this.updateAtlasData$()&&!this.forceUpdateDynamicAtlas$)return;this.refreshComponents$(),this.printAtlasTextures$()}catch(e){console.error("DynamicAtlas: Error updating dynamic atlas",e)}finally{this.isProcessing$=!1,this.forceUpdateDynamicAtlas$&&(this.forceUpdateDynamicAtlas$=!1),w.startAnimation()}}},{key:"processNextAtlas",value:function(){if(!this.isProcessing$){var e=x.instance.maxAtlasCount;if(!(e<=1)){var t=this.getAtlasIndex$(),n=t+1;if(n>=e)console.warn("DynamicAtlas: Max atlas count is reached, skip process next atlas");else if(!(Object.keys(this.pendingTextureAtlas$).length<=0)){var r=[];for(var a in this.pendingTextureAtlas$)this.pendingTextureAtlas$[a]===t&&r.push(a);if(!(r.length<=0)){var i={};for(var s in this.pendingSprites$){var o=this.pendingSprites$[s];if(o){var c=o.texture;if(c){var u=c.getId();u&&r.includes(u)&&(i[s]=o)}}}this.pendingSprites$=i,this.forceUpdateDynamicAtlas$=!0,this.createAtlas$(),this.updateDynamicAtlas(),console.warn("DynamicAtlas: Moving to next atlas index",n)}}}}}}]),e}()).prototype,"updateDynamicAtlas",[Rt],Object.getOwnPropertyDescriptor(Tt.prototype,"updateDynamicAtlas"),Tt.prototype),Pt=e(Tt.prototype,"printAtlasTextures$",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(ln.isDebugger())if(e.isProcessing$)e.printAtlasTextures$();else for(var t in e.debugCanvases$){var n=e.debugCanvases$[t];if(n){var r=n.toDataURL("image/jpeg",.6);un.logImage(r,.5)}}}}}),e(Tt.prototype,"processNextAtlas",[Ft],Object.getOwnPropertyDescriptor(Tt.prototype,"processNextAtlas"),Tt.prototype),Tt);p._RF.pop(),p._RF.push({},"f18351KuT9C+7suAM5eHst5","renderResultChallenge",void 0);var fn=Ludex.Utils.Error,gn="./wideframes",mn="".concat(gn,"/result-challenge.png"),vn="".concat(gn,"/update-challenge.png"),$n="".concat(gn,"/images/avatar-fallback.png"),yn={wideframe:{type:"image",depth:0,size:[952,492],position:[0,0]},playerPhoto:{type:"image",depth:-2,size:[160,160],position:[50,140],fallbackImage:$n},opponentPhoto:{type:"image",depth:-1,size:[160,160],position:[740,140],fallbackImage:$n},leftScore:{type:"text",name:"left-score",depth:3,font:"normal bold 44px",color:"#f2a62e",textAlign:"center",position:[123,372]},rightScore:{type:"text",name:"right-score",depth:3,font:"normal bold 44px",color:"#f2a62e",textAlign:"center",position:[820,372]},leftCrown:{type:"image",name:"crown",depth:3,size:[92,63],position:[80,80],image:"".concat(gn,"/images/crown-icon.png")},rightCrown:{type:"image",name:"crown",depth:3,size:[92,63],position:[775,80],image:"".concat(gn,"/images/crown-icon.png")}},wn={win:{name:"win-image",type:"image",depth:2,size:[277,144],position:[337.5,174],image:"".concat(gn,"/images/win.png")},lose:{name:"lose-image",type:"image",depth:2,size:[326,145],position:[313,173.5],image:"".concat(gn,"/images/lose.png")},draw:{name:"draw-image",type:"image",depth:2,size:[390,144],position:[281,174],image:"".concat(gn,"/images/draw.png")}},Sn=function(){var e=n(r().mark((function e(t){var n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=fn.lift({}),a=fn.pipe(En(t),An(t),Cn(t),xn(t))(n),e.next=4,fn.applyAsync(bn)(a);case 4:if(i=e.sent,!fn.isFailure(i)){e.next=9;break}return s=fn.extractFailure(i),console.error(s),e.abrupt("return",null);case 9:return e.abrupt("return",fn.extractSuccess(i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bn=function(e){return codex.frameCapture.captureAsync({name:"ResultChallenge",width:952,height:492,renderOptions:e})},xn=function(e){return function(t){var n=e.isPlayerFinished,r=e.isOpponentFinished,a=n||r,i=a?"result-challenge-with-score-box":"result-challenge-without-score-box",s=a?mn:vn;return u(u({},t),{},{wideframe:u(u({},yn.wideframe),{},{image:s,name:i})})}},En=function(e){return function(t){return u(u({},t),{},{playerPhoto:u(u({},yn.playerPhoto),{},{name:e.playerId,image:e.playerPhoto}),opponentPhoto:u(u({},yn.opponentPhoto),{},{name:e.opponentId,image:e.opponentPhoto})})}},An=function(e){return function(t){var n=e.isPlayerFinished,r=e.isOpponentFinished,a=e.playerScore,i=void 0===a?0:a,s=e.opponentScore,o=void 0===s?0:s;if(!(n||r))return t;var c=n?"".concat(i):"???",l=r?"".concat(o):"???";return u(u({},t),{},{leftScore:u(u({},yn.leftScore),{},{text:c}),rightScore:u(u({},yn.rightScore),{},{text:l})})}},Cn=function(e){return function(t){var n=Dn(e);if("none"===n)return t;var r=wn[n];if("draw"===n)return u(u({},t),{},{statusImage:r});var a="win"===n?yn.leftCrown:yn.rightCrown;return u(u({},t),{},{crown:a,statusImage:r})}},Dn=function(e){var t=e.playerScore,n=void 0===t?0:t,r=e.opponentScore,a=void 0===r?0:r,i=e.isPlayerFinished,s=e.isOpponentFinished;return i&&s?n===a?"draw":n>a?"win":"lose":"none"};p._RF.pop(),p._RF.push({},"46949HU2K9PdYlSXXZkfABn","renderShareLeaderboard",void 0);var kn=Ludex.Utils.Error,Rn="./wideframes",Ln="".concat(Rn,"/share-leaderboard.png"),Fn="".concat(Rn,"/images/avatar-fallback.png"),Tn={wideframe:{name:"share-leaderboard",type:"image",depth:0,image:Ln,size:[1500,2e3],position:[0,0],fallbackImage:Fn},avatar:{type:"image",depth:-2,size:[510,510],position:[510,278],fallbackImage:Fn},leaderPhoto:{type:"image",depth:-1,size:[100,100],fallbackImage:Fn,position:[436,0]},leaderName:{type:"text",depth:1,font:"600 48px",position:[600,0]},leaderScore:{type:"text",depth:1,font:"600 48px",position:[100,0]}},Pn=function(){var e=n(r().mark((function e(t){var n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=kn.lift({}),a=kn.pipe(In(t),Nn(t),Mn)(n),e.next=4,kn.applyAsync(_n)(a);case 4:if(i=e.sent,!kn.isFailure(i)){e.next=9;break}return s=kn.extractFailure(i),console.error(s),e.abrupt("return",null);case 9:return e.abrupt("return",kn.extractSuccess(i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_n=function(e){return codex.frameCapture.captureAsync({name:"ShareLeaderboard",width:1500,height:2e3,renderOptions:e})},Mn=function(e){return u(u({},e),{},{wideframe:Tn.wideframe})},In=function(e){return function(t){return u(u({},t),{},{avatar:u(u({},Tn.avatar),{},{name:e.playerId,image:e.playerPhoto})})}},Nn=function(e){return function(t){for(var n=e.leaders,r=u({},t),a=0;a<n.length;a++){var i=n[a],s=i.id,o=i.name,c=i.photo,l=i.score,d=1292+180*a,h=1360+180*a;r["photo_".concat(s)]=u(u({},Tn.leaderPhoto),{},{position:[Tn.leaderPhoto.position[0],d],name:s,image:c}),r["name_".concat(s)]=u(u({},Tn.leaderName),{},{position:[Tn.leaderName.position[0],h],name:s,text:o}),r["score_".concat(s)]=u(u({},Tn.leaderScore),{},{position:[Tn.leaderScore.position[0],h],name:s,text:"".concat(l)})}return r}};p._RF.pop(),p._RF.push({},"c5f1cF6b7dGYLU3X1NOhOPG","renderShareScore",void 0);var On=Ludex.Utils,Un=On.Error,Gn=(On.Valid,On.Function),zn=codex,Hn=zn.frameCapture,Bn=zn.language,Vn=zn.monitorError,jn="./wideframes",Yn="".concat(jn,"/share-score.png"),qn="".concat(jn,"/images/avatar-fallback.png"),Wn={wideframe:{type:"image",name:"share-score",depth:0,image:Yn,size:[1500,2e3],position:[0,0]},avatar:{type:"image",depth:-1,size:[500,500],position:[500,410],fallbackImage:qn},playerScore:{type:"text",name:"player-score",depth:1,font:"normal bold",color:"#f2a62e",textAlign:"center",position:[750,1120]},message:{type:"text",name:"message",depth:2,color:"#8f5543",textAlign:"center",position:[760,1560]}},Qn=function(){var e=n(r().mark((function e(t){var n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Un.lift({}),a=Un.pipe(Jn(t),Zn(t),er,Xn)(n),e.next=4,Un.applyAsync(Kn)(a);case 4:if(i=e.sent,!Un.isFailure(i)){e.next=9;break}return s=Un.extractFailure(i),console.error(s),e.abrupt("return",null);case 9:return e.abrupt("return",Un.extractSuccess(i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Kn=function(e){return Hn.captureAsync({name:"ShareScore",width:1500,height:2e3,renderOptions:e})},Xn=function(e){return u(u({},e),{},{wideframe:Wn.wideframe})},Jn=function(e){return function(t){return u(u({},t),{},{avatar:u(u({},Wn.avatar),{},{name:"".concat(e.playerId),image:e.playerPhoto})})}},Zn=function(e){return function(t){var n=Wn.playerScore.font,r=tr(),a=nr();return u(u({},t),{},{playerScore:u(u({},Wn.playerScore),{},{text:"".concat(e.playerScore),font:"".concat(n," ").concat(a," ").concat(r,",")})})}},er=function(e){var t=tr(),n=nr(),r=ar(),a=u(u({},Wn.message),{},{font:"normal ".concat(n," ").concat(t,","),text:r});return u(u({},e),{},{message:a})},tr=function(){var e=Bn.getCurrentLocale(),t=J[e],n=rr(t);return"".concat(n,"_LABEL")},nr=function(){var e,t=Bn.getCurrentLocale();return null!==(e=X[t])&&void 0!==e?e:"104px"},rr=function(e){var t,n=e.split("/"),r=null!==(t=n[n.length-1])&&void 0!==t?t:"",a=r.lastIndexOf(".");return-1===a?r:r.substring(0,a)},ar=function(){try{return Bn.getText("share.canYouDoBetter")}catch(e){return null==Vn||Vn.sendException(Gn.toError(e),{locale:Bn.getCurrentLocale(),message:"share.canYouDoBetter"}),"share.canYouDoBetter"}};p._RF.pop(),p._RF.push({},"3639a1RbypBKqHUo6gIZVdm","renderShareScoreWithInvite",void 0);var ir=Ludex.Utils.Error,sr=codex,or=sr.frameCapture,cr=sr.language,ur="./wideframes",lr="".concat(ur,"/invite-score.png"),dr="".concat(ur,"/images/avatar-fallback.png"),hr={wideframe:{type:"image",name:"share-score-with-invite",depth:0,image:lr,size:[952,492],position:[0,0]},avatar:{type:"image",depth:-1,size:[160,160],position:[85,140],fallbackImage:dr},playerScore:{type:"text",name:"player-score",depth:1,font:"normal bold",color:"#f2a62e",textAlign:"center",position:[165,384]}},pr={en:"44px",ru:"40px"},fr=function(){var e=n(r().mark((function e(t){var n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ir.lift({}),a=ir.pipe(vr(t),$r(t),mr)(n),e.next=4,ir.applyAsync(gr)(a);case 4:if(i=e.sent,!ir.isFailure(i)){e.next=9;break}return s=ir.extractFailure(i),console.error(s),e.abrupt("return",null);case 9:return e.abrupt("return",ir.extractSuccess(i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gr=function(e){return or.captureAsync({name:"ShareScore",width:952,height:492,renderOptions:e})},mr=function(e){return u(u({},e),{},{wideframe:hr.wideframe})},vr=function(e){return function(t){return u(u({},t),{},{avatar:u(u({},hr.avatar),{},{name:"".concat(e.playerId),image:e.playerPhoto})})}},$r=function(e){return function(t){var n=hr.playerScore.font,r=yr(),a=wr();return u(u({},t),{},{playerScore:u(u({},hr.playerScore),{},{text:"".concat(e.playerScore),font:"".concat(n," ").concat(a," ").concat(r,",")})})}},yr=function(){var e=cr.getCurrentLocale(),t=J[e],n=Sr(t);return"".concat(n,"_LABEL")},wr=function(){var e,t=cr.getCurrentLocale();return null!==(e=pr[t])&&void 0!==e?e:"44px"},Sr=function(e){var t,n=e.split("/"),r=null!==(t=n[n.length-1])&&void 0!==t?t:"",a=r.lastIndexOf(".");return-1===a?r:r.substring(0,a)};p._RF.pop(),p._RF.push({},"407a0rBEoFPs6GoXuwQofW2","renderUpdateChallenge",void 0);var br=Ludex.Utils.Error,xr="./wideframes",Er="".concat(xr,"/update-challenge.png"),Ar="".concat(xr,"/images/avatar-fallback.png"),Cr={wideframe:{type:"image",name:"update-challenge",depth:0,image:Er,size:[952,492],position:[0,0]},playerPhoto:{type:"image",depth:-1,size:[160,160],position:[50,140],fallbackImage:Ar},opponentPhoto:{type:"image",depth:-1,size:[160,160],position:[740,140],fallbackImage:Ar}},Dr=function(){var e=n(r().mark((function e(t){var n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=br.lift({}),a=br.pipe(Lr(t),Rr)(n),e.next=4,br.applyAsync(kr)(a);case 4:if(i=e.sent,!br.isFailure(i)){e.next=9;break}return s=br.extractFailure(i),console.error(s),e.abrupt("return",null);case 9:return e.abrupt("return",br.extractSuccess(i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kr=function(e){return codex.frameCapture.captureAsync({name:"UpdateChallenge",width:952,height:492,renderOptions:e})},Rr=function(e){return u(u({},e),{},{wideframe:Cr.wideframe})},Lr=function(e){return function(t){return u(u({},t),{},{playerPhoto:u(u({},Cr.playerPhoto),{},{image:e.playerPhoto,name:e.playerId}),opponentPhoto:u(u({},Cr.opponentPhoto),{},{image:e.opponentPhoto,name:e.opponentId})})}};p._RF.pop(),p._RF.push({},"5cf47s8lohMlZGIaMKBpDK0","FrameCapture",void 0);var Fr,Tr,Pr,_r=codex.frameCapture,Mr=function(){function e(){a(this,e)}var i;return t(e,[{key:"init",value:(i=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_r.setRenderer("share-score",Qn),_r.setRenderer("result-challenge",Sn),_r.setRenderer("update-challenge",Dr),_r.setRenderer("share-leaderboard",Pn),_r.setRenderer("share-score-with-invite",fr);case 5:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})}]),e}();p._RF.pop(),p._RF.push({},"2f36c+IsKJAU5s61TqQdaJ6","HybridFileCache",void 0);var Ir=Ludex,Nr=Ir.Events,Or=Ir.Configs.GameEngine.HybridFileCache,Ur=Or.Enabled,Gr=Or.PreviewMode,zr=Or.BuildMode,Hr=Ir.Utils,Br=Hr.Object,Vr=Hr.Function,jr=Hr.Json,Yr=Hr.Decorator,qr=codex,Wr=qr.event,Qr=qr.storage,Kr=qr.getBuildVersion,Xr=p.internal.CCON,Jr=$.instance,Zr=Jr.downloader,ea=Jr.pipeline,ta=Jr.fetchPipeline,na=(Fr=Yr.throttle(1e3),Pr=e((Tr=function(){function e(){var t=this;a(this,e),this.supportTypes$=[],this.bundledFiles$={},this.originDownloaders$={},this.nativeAssetDictionary$={},this.initStorage$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qr.addStorage("HybridFileCache",{commitId:"unknown",buildVersion:"0",cachedFiles:{},cachedBundles:{},cachedExtensions:{}},!0));case 1:case"end":return e.stop()}}),e)}))),this.checkCacheVersion$=n(r().mark((function e(){var n,a,i,s,o,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=zr.InvalidateMode,a=window.CommitId,i=Kr().toString(),s=Qr.getStorageData("HybridFileCache","commitId"),o=Qr.getStorageData("HybridFileCache","buildVersion"),Qr.setStorageData("HybridFileCache","commitId",a),Qr.setStorageData("HybridFileCache","buildVersion",i),c=s!==a,u=o!==i,e.t0=n,e.next="version"===e.t0?13:"commitId"===e.t0?17:21;break;case 13:if(!u){e.next=16;break}return e.next=16,t.clearCache$();case 16:return e.abrupt("break",25);case 17:if(!c){e.next=20;break}return e.next=20,t.clearCache$();case 20:return e.abrupt("break",25);case 21:if(!u&&!c){e.next=24;break}return e.next=24,t.clearCache$();case 24:return e.abrupt("break",25);case 25:t.requestUpdateStorage();case 26:case"end":return e.stop()}}),e)}))),this.initSupportedTypes$=function(){t.supportTypes$=zr.SupportedExtensions},this.setupBundledFiles$=n(r().mark((function e(){var n,a,i,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,zr.Enabled){e.next=3;break}return e.abrupt("return");case 3:n=[],a=s(t.supportTypes$),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=15;break}if(o=i.value,!t.getCachedBundles$(o)){e.next=12;break}return e.abrupt("continue",13);case 12:n.push(t.downloadBundledFile$(o));case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:if(!(n.length>0)){e.next=26;break}return e.next=26,Vr.allSettled(n);case 26:return e.prev=26,Wr.emit(Nr.BUNDLE_READY),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[0,,26,29],[5,17,20,23]])}))),this.downloadBundledFile$=function(){var e=n(r().mark((function e(n){var a,i,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n.replace(".",""),i="./cache/bundle".concat(a.toUpperCase(),".").concat(a),"bundle"===n&&(i="./cache/bundleBUNDLE.json"),e.next=6,fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}});case 6:return s=e.sent,e.next=9,s.json();case 9:o=e.sent,t.setBundledCache$(n,o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Hybrid File Cache: Downloaded bundled file",{type:n,error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),this.injectOptimalFetchPipeline$=function(){if(Gr.Enabled||zr.Enabled){var e=ta.pipes[2];if(e){ta.remove(2),ta.insert((function(t,n){try{e(t,n)}catch(e){console.error("Hybrid File Cache: optimized fetch pipeline",{error:e})}}),2)}}},this.injectOptimalLoadPipeline$=function(){if(Gr.Enabled||zr.Enabled){var e=ea.pipes[2];if(e){ea.remove(2),ea.insert((function(t,n){try{e(t,n)}catch(e){console.error("Hybrid File Cache: optimized load pipeline",{error:e})}}),2)}}},this.injectCacheExtensionPipeline$=function(){if(Gr.Enabled&&Gr.CacheUuidExtension){var e={},n=function(n,r){n.output=n.input;for(var a=0;a<n.input.length;a++){var i=n.input[a];if(i.id){var s=t.getCacheExtension$(i.id);s?(i.url=i.url.replace(i.ext,s),i.ext=s,e[i.id]=!0):e[i.id]=!1}}r(null,null)},r=function(n){return function(r,a){for(var i=c(r.input),s=0;s<i.length;s++){var o=i[s];if(o.id){var u,l=e[o.id];if(!Br.hasOwn(t.nativeAssetDictionary$,o.id))t.nativeAssetDictionary$[o.id]=null!==(u=o.isNative)&&void 0!==u&&u;l&&(o.isNative=!0)}}r.input.length,n(r,a)}},a=function(n,r){n.output=n.input;for(var a=0;a<n.output.length;a++){var i,s=n.output[a];if(s.id){var o=null!==(i=t.nativeAssetDictionary$[s.id])&&void 0!==i&&i;s.isNative=o,e[s.id]||t.setCacheExtension$(s.id,s.ext)}}r(null,null)};ea.insert(n,1),ta.insert(n,1),ea.insert(a,3),ta.insert(a,3);var i=c(ea.pipes),s=c(ta.pipes),o=i[2];o&&(ea.pipes[2]=r(o));var u=s[2];u&&(ta.pipes[2]=r(u));var l=c(ea.pipes),d=c(ta.pipes);console.debug("Hybrid File Cache: inject cache extension pipelines",i,s,l,d)}},this.saveOriginDownloaders$=function(){var e,n=s(t.supportTypes$);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.originDownloaders$[r]=Zr.handlers[r]}}catch(e){n.e(e)}finally{n.f()}},this.registerCustomDownloader$=function(){var e,n=s(t.supportTypes$);try{for(n.s();!(e=n.n()).done;){var r=e.value;"bundle"!==r&&Zr.register(r,t.downloadFile$(r))}}catch(e){n.e(e)}finally{n.f()}},this.listenEvents$=function(){Wr.on(Nr.SCENE_LOADED,t.requestUpdateStorage),f.on(H.CLEAR_HYBRID_FILE_CACHE,t.clearCache$)},this.getDownloader$=function(e){var n;return null!==(n=t.originDownloaders$[e])&&void 0!==n?n:null},this.downloadFile$=function(e){return function(n,r,a){var i=t.getCache$(e,n);if(i)return a(null,i);var s=t.getDownloader$(e);if(!s)return a(new Error("Downloader not found"),null);s(n,r,(function(r,i){return!r&&t.setCache$(e,n,i),a(r,i)}))}},this.getCacheKey$=function(e,t){var n=t.match(/.*\/([-a-z0-9@]+)\.([^\.]+)$/);if(!n)return null;var r=o(n,3),a=(r[0],r[1]),i=r[2];return!i||e.indexOf(i)<0?null:"".concat(a,":").concat(e)},this.validateDataType$=function(e,t){Array.isArray(t)&&Br.hasOwn(t[0],"__type__");return!(".cconb"===e&&Br.hasOwn(t,"chunks")&&!(Array.isArray(t.chunks)&&t instanceof Xr))||(console.warn("Hybrid File Cache: Invalid cconb",{type:e,data:t}),!1)},this.encodeData$=function(e,t){return".cconb"===e?Br.hasOwn(t,"_document")&&Br.hasOwn(t,"_chunks")?new Xr(t._document,t._chunks):null:jr.clone(t)},this.decodeData$=function(e,t){if(".cconb"===e){if(!Br.hasOwn(t,"_document")||!Br.hasOwn(t,"_chunks"))return null;if(!Array.isArray(t._chunks))return null;var n,r=[],a=s(t._chunks);try{for(a.s();!(n=a.n()).done;){var i=n.value;i instanceof Uint8Array?r.push(i):r.push(new Uint8Array(Object.values(i)))}}catch(e){a.e(e)}finally{a.f()}return new Xr(t._document,r)}return jr.clone(t)},this.setCache$=function(e,n,r){var a=t.getCacheKey$(e,n);if(a&&t.validateDataType$(e,r)){var i=t.encodeData$(e,r);Qr.setStorageData("HybridFileCache","cachedFiles",l({},a,i)),t.requestUpdateStorage()}},this.getCache$=function(e,n){var r=t.getCacheKey$(e,n);if(!r)return null;var a=t.getFileCaches$()[r];return a||(a=t.getBundledCache$(e,r)),a?t.decodeData$(e,a):null},this.getFileCaches$=function(){var e;return null!==(e=Qr.getStorageData("HybridFileCache","cachedFiles"))&&void 0!==e?e:{}},this.getCachedBundles$=function(e){var n=Qr.getStorageData("HybridFileCache","cachedBundles");if(!n)return null;var r=n[e];return r?(t.bundledFiles$[e]=r,r):null},this.getBundledCache$=function(e,n){var r,a=t.bundledFiles$[e];return a&&null!==(r=a[n.replace(":".concat(e),"")])&&void 0!==r?r:null},this.setBundledCache$=function(e,n){t.bundledFiles$[e]=n,Qr.setStorageData("HybridFileCache","cachedBundles",l({},e,n)),t.requestUpdateStorage()},this.getCacheExtension$=function(e){return t.getCachedExtensions$()[e]},this.setCacheExtension$=function(e,n){Qr.setStorageData("HybridFileCache","cachedExtensions",l({},e,n)),t.requestUpdateStorage()},this.getCachedExtensions$=function(){var e;return null!==(e=Qr.getStorageData("HybridFileCache","cachedExtensions"))&&void 0!==e?e:{}},i(this,"requestUpdateStorage",Pr,this),this.clearCache$=function(){Qr.initStorageData("HybridFileCache","cachedFiles",{}),Qr.initStorageData("HybridFileCache","cachedBundles",{}),Qr.updateToWebStorage("HybridFileCache")}}var u;return t(e,[{key:"init",value:(u=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ur&&!Z){e.next=3;break}return Wr.emit(Nr.BUNDLE_READY),e.abrupt("return");case 3:return e.next=5,this.initStorage$();case 5:return e.next=7,this.checkCacheVersion$();case 7:this.initSupportedTypes$(),this.injectOptimalLoadPipeline$(),this.injectOptimalFetchPipeline$(),this.injectCacheExtensionPipeline$(),this.saveOriginDownloaders$(),this.registerCustomDownloader$(),this.setupBundledFiles$(),this.listenEvents$(),console.debug("Hybrid File Cache: Initialized",{supportTypes:this.supportTypes$});case 16:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),e}()).prototype,"requestUpdateStorage",[Fr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){Qr.updateToWebStorage("HybridFileCache")}}}),Tr);p._RF.pop(),p._RF.push({},"14b76Yew19JgY7K+L9F5mmu","Languages",void 0);var ra=Ludex,aa=ra.Events,ia=ra.Utils.Array,sa=codex,oa=sa.player,ca=sa.event,ua=sa.language,la=sa.monitorError,da=function(){function e(){var t=this;a(this,e),this.initDefaultLanguage$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ua.add("en",pe,!0),t.setLanguage$("en");case 2:case"end":return e.stop()}}),e)}))),this.initPlayerLanguage$=n(r().mark((function e(){var n,a,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=ua.getPlayerLanguage())&&t.isSupportedLocale$(a)){e.next=5;break}return console.warn("Language ".concat(a," not supported. Overriding with default language")),t.setLanguage$("en",!0),e.abrupt("return");case 5:return e.next=7,t.addLanguage$(a);case 7:i=null!==(n=oa.getPlayerDataByKey("isFirstLogin"))&&void 0!==n&&n,t.setLanguage$(a,i);case 9:case"end":return e.stop()}}),e)}))),this.isSupportedLocale$=function(e){return ia.has(ee,e)},this.listenEvent$=function(){ca.on(aa.REQUEST_LANGUAGE,t.handleLanguageRequested$),f.on(aa.REQUEST_LANGUAGE,t.handleLanguageRequested$),f.on(H.PRELOAD_LANGUAGE,t.handlePreloadLanguage$),f.on(H.CHOOSE_LANGUAGE,t.handleChooseLanguage$)},this.addLanguage$=function(){var e=n(r().mark((function e(n){var a,i,s=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],e.next=3,t.getLangData$(n);case 3:i=e.sent,ua.add(n,i,a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setLanguage$=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ua.choose(e),t&&oa.setSetting("language",e)},this.handlePreloadLanguage$=function(){var e=n(r().mark((function e(n){var a,i,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.locale,i=n.onLoad,s=n.onError,t.isSupportedLocale$(a)){e.next=5;break}return console.warn("Preload language ".concat(a," not found")),null==s||s(new Error("Language ".concat(a," not found"))),e.abrupt("return");case 5:return e.prev=5,e.next=8,t.addLanguage$(a);case 8:null==i||i(a),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(5),o=t.toError$(e.t0,"handleLanguageRequested"),console.error(o),null==la||la.sendException(o),null==s||s(e.t0);case 17:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}(),this.handleChooseLanguage$=function(e){var n=e.locale,r=e.saveToPlayerData,a=void 0!==r&&r;if(t.isSupportedLocale$(n))try{t.setLanguage$(n,a)}catch(e){var i=t.toError$(e,"handleLanguageRequested");console.error(i),null==la||la.sendException(i)}else console.warn("Choose language ".concat(n," not found"))},this.getLangData$=function(){var e=n(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("en"!==t){e.next=2;break}return e.abrupt("return",pe);case 2:return e.next=4,te.loadJsonAsync(ne[t]);case 4:if(null!==(n=e.sent)){e.next=7;break}throw new Error("Language ".concat(t," not found"));case 7:if(null!==n.json){e.next=9;break}throw new Error("Language ".concat(t," is empty"));case 9:return e.abrupt("return",n.json);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleLanguageRequested$=function(){var e=n(r().mark((function e(n){var a,i,s,o,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.locale,i=n.saveToPlayerData,s=void 0!==i&&i,o=n.onLoad,c=n.onError,t.isSupportedLocale$(a)){e.next=5;break}return console.warn("Request language ".concat(a," not found")),null==c||c(new Error("Language ".concat(a," not found"))),e.abrupt("return");case 5:return e.prev=5,e.next=8,t.addLanguage$(a);case 8:null==o||o(a),t.setLanguage$(a,s),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(5),u=t.toError$(e.t0,"handleLanguageRequested"),console.error(u),null==la||la.sendException(u),null==c||c(u);case 18:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}(),this.toError$=function(e,t){return e instanceof Error?e:"string"==typeof e?new Error("LanguagePlugin: ".concat(e)):new Error("LanguagePlugin: Unknown error in module: <".concat(t,">"))}}var i;return t(e,[{key:"init",value:(i=n(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.initDefaultLanguage$();case 3:return this.listenEvent$(),e.next=6,this.initPlayerLanguage$();case 6:e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),t=this.toError$(e.t0,"handleLanguageRequested"),console.error(t),null==la||la.sendException(t);case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return i.apply(this,arguments)})}]),e}();p._RF.pop(),p._RF.push({},"fb33bK/6Y5FAas5AwmmBM/X","Leaderboards",void 0);var ha=Ludex,pa=ha.Configs,fa=pa.Mockup,ga=fa.Leaderboards,ma=fa.GameSDK.Player,va=pa.Leaderboards,$a=ha.Utils.Number,ya=codex.leaderboard,wa=function(){function e(){var t=this;a(this,e),this.handleWhenGameSDKStarted$=function(){ga.Enabled?t.setupLeaderboardsMockup$():t.setupLeaderboards$()},this.setupLeaderboards$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setupLeaderboardByConfigs$();case 1:case"end":return e.stop()}}),e)}))),this.setupLeaderboardByConfigs$=function(){var e,t=va.LeaderboardList,n=s(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.Id,i=r.Name;ya.addLeaderboard({name:i,type:"global",autoSortRank:!0,leaderboardId:a})}}catch(e){n.e(e)}finally{n.f()}},this.setupLeaderboardsMockup$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setupMockGlobalLeaderboards$(),t.setupMockFriendsLeaderboard$(),t.setupMockGlobalTournamentLeaderboard$();case 3:case"end":return e.stop()}}),e)}))),this.setupMockGlobalLeaderboards$=n(r().mark((function e(){var t,n,a,i,o,c,u,l,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ga.NumOfLeaders,n=va.LeaderboardList,a=s(n),e.prev=3,a.s();case 5:if((i=a.n()).done){e.next=22;break}if(o=i.value,c=o.Name,u=o.Id,c){e.next=10;break}return e.abrupt("continue",20);case 10:return e.next=12,ya.createLeaderboardAsync({_id:u,name:c,numberOfLeaders:$a.random(t.Max-t.Min)+t.Min});case 12:return l=e.sent,ya.addLeaderboard({name:c,type:"global",autoSortRank:!0,leaderboardId:l}),e.next=16,ya.requestLeaderboardAsync(c,10);case 16:d=ya.getLeaderboard(c),console.debug("setupGlobalLeaderboard fetch new",d,d&&Object.keys(d.leaders).length),d=ya.getLeaderboard(c),console.debug("setupGlobalLeaderboard load more",d,d&&Object.keys(d.leaders).length);case 20:e.next=5;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(3),a.e(e.t0);case 27:return e.prev=27,a.f(),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[3,24,27,30]])}))),this.setupMockFriendsLeaderboard$=n(r().mark((function e(){var t,n,a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="Mock Friends Leaderboard","friends-leaderboard-id",n=0,(a=ma.ConnectedPlayers).Enabled&&(n=$a.random(a.NumOfPlayers-1)+1),e.next=7,ya.createLeaderboardAsync({_id:"friends-leaderboard-id",name:t,numberOfLeaders:n});case 7:return i=e.sent,ya.addLeaderboard({name:t,type:"friends",autoSortRank:!0,leaderboardId:i}),e.next=11,ya.requestLeaderboardAsync(t,10);case 11:s=ya.getLeaderboard(t),console.debug("setupFriendsLeaderboard done",s);case 13:case"end":return e.stop()}}),e)}))),this.setupMockGlobalTournamentLeaderboard$=n(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.requestTournamentDataAsync();case 2:(t=e.sent).forEach((function(e){var t=e.payload.leaderboardId;t&&(ya.isExistLeaderboardId(t)||ya.addLeaderboard({type:"tournament",name:t,autoSortRank:!0,leaderboardId:t}))})),console.debug("setupGlobalTournamentLeaderboard done",t);case 5:case"end":return e.stop()}}),e)})))}return t(e,[{key:"init",value:function(){this.handleWhenGameSDKStarted$()}}]),e}();p._RF.pop(),p._RF.push({},"e7bf73g4jJGuI9FqvW5YBsS","PerformanceMonitor",void 0);var Sa=Ludex,ba=Sa.Utils.Mark,xa=Sa.Events,Ea=Sa.Configs.PerformanceMonitor.FpsTracking,Aa=codex.event,Ca=function(){function e(){var t=this;a(this,e),this.markName$="FPS Tracking",this.listenEvents$=function(){Aa.catchUp(xa.GAME_READY,t.handleStartTraceFps$)},this.unListenEvents$=function(){w.off(R.EVENT_AFTER_UPDATE,t.handleLateUpdate$)},this.handleStartTraceFps$=function(){t.startTraceFps$(),w.on(R.EVENT_AFTER_UPDATE,t.handleLateUpdate$)},this.startTraceFps$=function(){t.mark&&(t.mark.measure(t.markName$),t.mark.start(t.markName$))},this.handleLateUpdate$=function(){if(t.mark){if(t.fpsTraceDuration$-=f.deltaTime,t.fpsTraceDuration$<=0&&!t.traceStopped$)return t.traceStopped$=!0,t.unListenEvents$(),t.updateFPS$(),void t.mark.stop(t.markName$);t.fpsTraceIntervalTimer$-=f.deltaTime,t.fpsTraceIntervalTimer$>0||(t.fpsTraceIntervalTimer$=t.fpsTraceInterval$,t.updateFPS$(),t.mark.stop(t.markName$),t.startTraceFps$())}},this.updateFPS$=function(){var e,n;if(t.mark){var r=t.getFPS$(),a=t.getDrawCalls$(),i=t.getDeviceRender$(),s=t.getTextureMemory$();t.minFps$=Math.min(null!==(e=t.minFps$)&&void 0!==e?e:r,r),t.maxFps$=Math.max(null!==(n=t.maxFps$)&&void 0!==n?n:0,r),t.mark.putMetric(t.markName$,"FPS Metric",r),t.mark.putAttr(t.markName$,"Page Title",document.title),t.mark.putAttr(t.markName$,"Device Render",i),t.mark.putAttr(t.markName$,"Draw Calls",a.toString()),t.mark.putAttr(t.markName$,"Texture Memory",s.toFixed(2)),t.mark.putAttr(t.markName$,"Min FPS",t.minFps$.toString()),t.mark.putAttr(t.markName$,"Max FPS",t.maxFps$.toString()),console.debug("FPS: ".concat(r," Min: ").concat(t.minFps$," Max: ").concat(t.maxFps$,", draw calls: ").concat(a,", texture memory: ").concat(s.toFixed(2),"MB"))}},this.getFPS$=function(){if(!w.root)return 0;var e=w.root.fps;return Math.floor(e)||0},this.getDrawCalls$=function(){return w.root&&w.root.device.numDrawCalls||0},this.getDeviceRender$=function(){return w.root&&w.root.device.renderer||"Unknown"},this.getTextureMemory$=function(){return w.root&&w.root.device.memoryStatus.textureSize/1048576||0}}return t(e,[{key:"mark",get:function(){return Ea.Enabled?ba:null}},{key:"init",value:function(){var e=Ea.TrackingDuration,t=Ea.TrackingInterval;this.mark&&(this.fpsTraceDuration$=null!=e?e:60,this.fpsTraceInterval$=null!=t?t:10,this.fpsTraceIntervalTimer$=this.fpsTraceInterval$,this.traceStopped$=!1,this.listenEvents$())}}]),e}();p._RF.pop(),p._RF.push({},"58248LBip1DBrMjK0UWw2rM","RemoteConfig",void 0);var Da=Ludex.Events,ka=codex.event,Ra=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){ka.on(Da.REQUEST_HOT_RELOAD,t.handleHotReload$),ka.on(Da.REQUEST_UPDATE_CONFIG,t.handleUpdateConfig$)},this.handleHotReload$=function(){f.restart()},this.handleUpdateConfig$=function(e){if("Gameplay"===e.type){f.emit(H.GAMEPLAY_UPDATE_CONFIG,e.config);var t=e.id,n=e.type;ka.emit(Da.REMOTE_CONFIG_UPDATED,{id:t,type:n})}}}return t(e,[{key:"init",value:function(){this.listenEvents$()}}]),e}();p._RF.pop(),p._RF.push({},"c34a93D1BREiKms1T21AkQS","PluginsManager",void 0);var La=Ludex.Configs,Fa=function(){function e(){a(this,e),this.initHybridFileCache$=function(){La.GameEngine.HybridFileCache.Enabled&&(new na).init()}}return t(e,[{key:"init",value:function(){this.initHybridFileCache$(),console.debug("Plugins Manager: Initialized")}},{key:"initLanguages",value:function(){La.Languages.Enabled&&(new da).init()}},{key:"initLeaderboards",value:function(){La.Leaderboards.Enabled&&(new wa).init()}},{key:"initRemoteConfig",value:function(){La.RemoteConfig.Enabled&&(new Ra).init()}},{key:"initDynamicAtlas",value:function(){(new pn).init()}},{key:"initDynamicAssets",value:function(){La.GameEngine.DynamicAssets.Enabled&&(new Qt).init()}},{key:"initCanvasRecorder",value:function(){La.Debugger.CanvasRecorder.Enabled&&(new Et).init()}},{key:"initPerformanceMonitor",value:function(){La.Debugger.Profiler.Enabled&&(new Ca).init()}},{key:"initAdaptivePerformance",value:function(){La.AdaptivePerformance.Enabled&&(new bt).init()}},{key:"initFrameCapture",value:function(){La.FrameCapture.Enabled&&(new Mr).init()}},{key:"initDailyRewards",value:function(){La.DailyRewards.Enabled&&(new kt).init()}}]),e}();p._RF.pop(),p._RF.push({},"ac8b03T+rFB061sXoEEsCUH","SceneManager",void 0);var Ta=codex,Pa=Ta.event,_a=Ta.monitorError,Ma=Ludex,Ia=Ma.Events,Na=Ma.Configs.PerformanceMonitor,Oa=Ma.Utils,Ua=Oa.Mark,Ga=Oa.Function,za=function(){function e(){var t=this;a(this,e),this.markName$="Load Scene",this.testScene$={},this.isClearedMark$=!1,this.callbackSwitchScene$=null,this.mutex$=Ga.mutex(),this.listenEvents$=function(){Pa.catchUp(Ia.MARK_IS_TEST_SCENE,t.setTestScene$),Pa.on(Ia.SWITCH_SCENE,t.switchScene$),Pa.on(Ia.PRELOAD_SCENE,t.preloadScene$)},this.correctSceneName$=function(e){var n=w.getScene(),r=t.getTestScene$();return r?r===(null==n?void 0:n.name)?null:r:null!=n&&n.isValid&&e===n.name?null:e},this.switchScene$=function(){var e=n(r().mark((function e(n){var a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.sceneName,i=n.sceneData,s=t.correctSceneName$(a),console.debug("Switching",s,null!=i?i:{}),s){e.next=5;break}return e.abrupt("return");case 5:se.isSceneLoaded(s)||ae.showLoadingFullScreen(s),t.startScene$(u(u({},n),{},{sceneName:s}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.startScene$=function(){var e=n(r().mark((function e(n){var a,i,s,o,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.sceneName,i=n.sceneData,e.next=3,t.mutex$.use(a);case 3:return s=e.sent,e.prev=4,t.startMeasure$("start",n),e.next=8,t.loadSceneAsync$(a,t.onSceneProgress$);case 8:return o=e.sent,e.next=11,t.runSceneAsync$(o);case 11:c=e.sent,t.setSceneData$(c,null!=i?i:{}),se.markIsSceneLoaded(a),Pa.emit(Ia.SCENE_LOADED,{sceneName:c.name}),t.clearTestMark$(),t.stopMeasure$(),t.handleSceneLaunched$(a,i),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(4),u=Ga.toError(e.t0),console.warn("SceneManager.startScene",u),t.stopMeasure$(!1);case 25:return e.prev=25,s.release(),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[4,20,25,28]])})));return function(t){return e.apply(this,arguments)}}(),this.preloadScene$=function(){var e=n(r().mark((function e(n){var a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.sceneName,e.next=3,t.mutex$.use(a);case 3:return i=e.sent,e.prev=4,t.startMeasure$("preload",n),e.next=8,t.loadSceneAsync$(a,t.onSceneProgress$);case 8:se.markIsSceneLoaded(a),Pa.emit(Ia.SCENE_LOADED,{sceneName:a,isPreload:!0}),t.stopMeasure$(),i.release(),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(4),s=Ga.toError(e.t0),console.warn("SceneManager.preloadScene",s),t.stopMeasure$(!1),i.release();case 20:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),this.loadSceneAsync$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,r){var a=T.main;if(!a)throw new Error("Main bundle not found");a.loadScene(e,null!=t?t:null,(function(e,t){if(e)return r(e);n(t)}))}))},this.runSceneAsync$=function(e){return new Promise((function(t,n){w.runScene(e,void 0,(function(e,r){if(e)return n(e);if(!r)throw new Error("Scene not found");t(r)}))}))},this.startMeasure$=function(e,n){if(t.mark){var r=n.sceneName;console.groupCollapsed("📦 ".concat(r,": ").concat(e," progress")),t.mark.measure(t.markName$),t.mark.putAttr(t.markName$,"Cancel","false"),t.mark.putAttr(t.markName$,"Success","false"),t.mark.putMetric(t.markName$,r),t.mark.start(t.markName$)}},this.stopMeasure$=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.mark&&(t.mark.rmAttr(t.markName$,"File"),t.mark.putAttr(t.markName$,"Success",e?"true":"false"),t.mark.stop(t.markName$),console.groupEnd())},this.onSceneProgress$=function(e,n,r){var a=e/n;t.mark&&t.mark.putAttr(t.markName$,"Last File","".concat(r.id," (").concat(r.ext,")"));var i=Math.floor(70*a+30);GameSDK.setLoadingProgress(i)},this.clearTestMark$=function(){t.isClearedMark$||(Pa.clear(Ia.MARK_IS_TEST_SCENE),t.isClearedMark$=!0)},this.handleSceneLaunched$=function(e,n){var r;ae.hideLoadingFullScreen(e),ie.switchSceneTracking(),null==_a||_a.addMetadata({currentScene:e}),null===(r=t.callbackSwitchScene$)||void 0===r||r.call(t,{sceneName:e,sceneData:n}),Pa.emit(Ia.SCENE_LAUNCHED,{sceneName:e}),w.once(R.EVENT_AFTER_RENDER,(function(){Pa.emit(Ia.SCENE_RENDERED,{sceneName:e})}))},this.getTestScene$=function(){var e;return null!==(e=Object.keys(t.testScene$)[0])&&void 0!==e?e:null},this.setTestScene$=function(e){var n=e.sceneName;console.warn("SceneManager.setTestScene",n),t.testScene$[n]=!0},this.onSwitchScene=function(e){t.callbackSwitchScene$=e},this.setSceneData$=function(e,t){if(t&&("data"in e||e.scene.attr({data:{}}),"data"in e)){var n=e.data||{};e.scene.attr({data:u(u({},n),t)}),console.debug("SceneManager.setSceneData",{sceneName:e.name,sceneData:t,currentData:n})}}}return t(e,[{key:"init",value:function(){this.listenEvents$(),console.debug("Scene Manager: Initialized")}},{key:"mark",get:function(){return Na.LoadResources?Ua:null}}]),e}();p._RF.pop(),p._RF.push({},"617b2SRAL5CyL75C998xBnx","ScreenManager",void 0);var Ha=codex,Ba=Ha.event,Va=Ha.monitorError,ja=Ludex,Ya=ja.Events,qa=ja.Utils,Wa=qa.Object,Qa=qa.Valid;function Ka(e){return"ready"===e.state?(e.screen.node.removeFromParent(),e.screen.node.destroy(),{state:"prefab",order:e.order,name:e.name,prefab:e.prefab,useCount:e.useCount}):"prefab"===e.state?u({},e):{state:"queued",order:e.order,name:e.name}}var Xa=function(){function e(){var t=this;a(this,e),this.screens$={},this.onPrefabReadyCallbacks$={},this.bindEventHandlers$=function(){Ba.on(Ya.OPEN_SCREEN,t.handleOpenScreen$),Ba.on(Ya.CLOSE_SCREEN,t.handleCloseScreen$),Ba.on(Ya.PRELOAD_SCREEN,t.handlePreloadScreen$),Ba.on(Ya.PRELOAD_SCREENS,t.handlePreloadScreens$),Ba.on(Ya.SWITCH_SCENE,t.handleSwitchScene$)},this.handleOpenScreen$=function(e){t.openScreen(e.screenName,e.screenData)},this.handleCloseScreen$=function(e){t.closeScreen(e.screenName,!0)},this.handlePreloadScreen$=function(e){var n=e.screenName;t.addScreenQueues$([n]);var r=t.screens$[n];"queued"===(null==r?void 0:r.state)&&t.loadScreen$(r)},this.handlePreloadScreens$=function(){var e=w.getScene();t.validateScene$(e)&&(t.initScreens$(e),t.preloadScreens$())},this.handleSwitchScene$=function(){t.resetAllScreenParents$(),t.onPrefabReadyCallbacks$={}},this.resetAllScreenParents$=function(){for(var e in t.screens$){var n=t.screens$[e];void 0!==n&&(t.screens$[e]=Ka(n))}},this.validateScene$=function(e){return!!e||(console.warn("No scene found for preloading screens"),!1)},this.initScreens$=function(e){var n=e.getComponentsInChildren("BaseScreen");if(!Qa.isEmpty(n)){var r=n.map((function(e){return null==e?void 0:e.node.name})).join(", ");console.info("📺 Active Screens in ".concat(e.name,": ").concat(r)),t.addScreens$(n)}var a=t.getScreenHolder$();if(null!=a&&a.enabled){var i=a.screenKeys.filter((function(e){return!n.some((function(t){return t.node.name===oe[e]}))}));if(!Qa.isEmpty(i)){var s=i.map((function(e){return oe[e]}));console.info("📺 Lazy-loading Screens in ".concat(e.name,": ").concat(s.join(", "))),t.addScreenQueues$(s)}}},this.getScreenHolder$=function(){var e,t=w.getScene();return null!==(e=null==t?void 0:t.getComponentInChildren("Screens"))&&void 0!==e?e:null},this.addScreens$=function(e){for(var n=0;n<e.length;n++){var r=e[n];if(r){var a=r.node.name;if(t.isScreenNameValid$(a)){var i=t.screens$[a];"ready"!==(null==i?void 0:i.state)?t.screens$[a]={state:"ready",order:n,screen:r,prefab:r.node,name:a,useCount:0}:t.screens$[a]=u(u({},i),{},{order:n,screen:r})}else console.warn("ScreenManager.addScreens: Invalid screen name ".concat(a))}else console.warn("ScreenManager.addScreens: Invalid screen ".concat(n))}},this.isScreenNameValid$=function(e){return Qa.isString(e)&&Wa.vals(oe).includes(e)},this.addScreenQueues$=function(e){var n=t.getScreenHolder$();if(null!=n&&n.isValid)for(var r=0;r<e.length;r++){var a=e[r];if(t.isScreenNameValid$(a)){var i=t.screens$[a];t.screens$[a]=void 0===i?{state:"queued",order:r,name:a}:u(u({},i),{},{order:r})}else console.warn("ScreenManager.addScreenQueues: Invalid screen name ".concat(a))}else console.warn("ScreenManager.addScreenQueues: No valid screen holder found")},this.loadScreen$=function(){var e=n(r().mark((function e(n){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.screens$[n.name]=u(u({},n),{},{state:"loading"}),e.next=4,te.loadPrefabAsync("screens/".concat(n.name));case 4:if(null!==(a=e.sent)){e.next=7;break}throw new Error("ScreenManager.loadScreen: Failed to load prefab: ".concat(n.name));case 7:t.screens$[n.name]=u(u({},n),{},{state:"prefab",prefab:a,useCount:0}),console.debug("ScreenManager.loadScreen: ".concat(n.name," loaded successfully")),t.emitPrefabReady$(n.name),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.warn("ScreenManager.loadScreen: Failed to load ".concat(n.name),e.t0),t.screens$[n.name]={state:"queued",order:n.order,name:n.name};case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),this.preloadScreens$=function(){for(var e in t.screens$){var n=t.screens$[e];"queued"===(null==n?void 0:n.state)&&t.loadScreen$(n)}},this.getScreen$=function(){var e=n(r().mark((function e(n){var a,i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(a=t.getScreenHolder$())&&a.isValid){e.next=3;break}throw new Error("ScreenManager.getScreen: Invalid screen holder");case 3:if("ready"!==n.state){e.next=5;break}return e.abrupt("return",n.screen);case 5:if(n.prefab instanceof M){e.next=7;break}throw new Error("ScreenManager.getScreen: Invalid prefab ".concat(n.name));case 7:if((i=_(n.prefab)).name=n.name,s=i.getComponent("BaseScreen")){e.next=12;break}throw new Error("ScreenManager.getScreen: Invalid screen ".concat(n.name));case 12:return a.node.addChild(i),i.active=!1,t.screens$[n.name]=u(u({},n),{},{state:"ready",screen:s}),t.reorderScreens$(),console.debug("ScreenManager.getScreen: Retrieved ".concat(n.name),n),e.abrupt("return",s);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.reorderScreens$=function(){var e=[];for(var n in t.screens$){var r=t.screens$[n];"ready"===(null==r?void 0:r.state)&&null!=r&&r.screen.isValid&&e.push(r)}e.sort((function(e,t){return e.order-t.order}));for(var a=0,i=e;a<i.length;a++){var s=i[a];s.screen.node.setSiblingIndex(s.order)}},this.openScreen=function(){var e=n(r().mark((function e(n,a){var i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isScreenNameValid$(n)){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==(i=t.getOrTryAddScreen$(n))){e.next=6;break}return console.warn("ScreenManager.openScreen: Screen ".concat(n," not found")),e.abrupt("return");case 6:if("ready"===i.state||"prefab"===i.state){e.next=11;break}return"queued"===i.state&&t.loadScreen$(i),e.next=10,t.queueScreen$(n,a);case 10:return e.abrupt("return",e.sent);case 11:return e.prev=11,ce.setBlockInput(!0),e.next=15,t.getScreen$(i);case 15:if(null!=(s=e.sent)&&s.isValid){e.next=18;break}throw new Error("ScreenManager.performScreenOpen: Invalid screen ".concat(n));case 18:return t.incrementUseCount$(n),e.next=21,t.showScreen$(s,n,a);case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(11),console.error("ScreenManager.openScreen: Error opening ".concat(n),e.t0);case 26:return e.prev=26,ce.setBlockInput(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[11,23,26,29]])})));return function(t,n){return e.apply(this,arguments)}}(),this.queueScreen$=function(e,a){var i;console.debug("ScreenManager.queueScreen: Queuing ".concat(e));var s=null!==(i=t.onPrefabReadyCallbacks$[e])&&void 0!==i?i:[];return new Promise((function(i){var o=function(){var s=n(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openScreen(e,a);case 2:i();case 3:case"end":return n.stop()}}),n)})));return function(){return s.apply(this,arguments)}}();t.onPrefabReadyCallbacks$[e]=[].concat(c(s),[o])}))},this.incrementUseCount$=function(e){var n=t.screens$[e];"ready"!==(null==n?void 0:n.state)&&"prefab"!==(null==n?void 0:n.state)||(t.screens$[e]=u(u({},n),{},{useCount:n.useCount+1}))},this.showScreen$=function(){var e=n(r().mark((function e(n,a,i){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.node.active=!0,s={screenName:a,screenData:i},Ba.emit(Ya.OPENING_SCREEN,s),e.next=5,new Promise((function(e){return requestAnimationFrame(e)}));case 5:n.open(i),t.updateAnalytics$(a);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.closeScreen=function(){var e=n(r().mark((function e(n){var a,i,s=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.length>1&&void 0!==s[1]&&s[1],t.isScreenNameValid$(n)){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(i=t.screens$[n])){e.next=7;break}return console.debug("ScreenManager.closeScreen: Screen ".concat(n," not found")),e.abrupt("return");case 7:if("ready"===i.state){e.next=11;break}return console.debug("ScreenManager.closeScreen: ".concat(n," is not ready")),delete t.onPrefabReadyCallbacks$[n],e.abrupt("return");case 11:if(e.prev=11,i.screen.isValid&&i.screen.node.active){e.next=14;break}return e.abrupt("return");case 14:Ba.emit(Ya.CLOSING_SCREEN,{screenName:n}),i.screen.close(),a&&t.updateAnalytics$(n,!1),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(11),console.error("ScreenManager.closeScreen: Error closing ".concat(n),e.t0);case 22:case"end":return e.stop()}}),e,null,[[11,19]])})));return function(t){return e.apply(this,arguments)}}(),this.updateAnalytics$=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ie.trackCurrentPage(e,t),t?null==Va||Va.addMetadata({currentScreen:e}):null==Va||Va.removeMetadata("currentScreen")},this.closeAllScreens=function(){for(var e in t.screens$)t.closeScreen(e,false)},this.getOrTryAddScreen$=function(e){var n=t.screens$[e];return void 0===n?(console.debug("ScreenManager.getOrTryAddScreen: Adding new screen (".concat(e,") to queue")),t.addScreenQueues$([e]),t.screens$[e]):n},this.emitPrefabReady$=function(e){var n,r,a=null!==(n=t.onPrefabReadyCallbacks$[e])&&void 0!==n?n:[],i=s(a);try{for(i.s();!(r=i.n()).done;){(0,r.value)()}}catch(e){i.e(e)}finally{i.f()}delete t.onPrefabReadyCallbacks$[e]}}return t(e,[{key:"init",value:function(){this.bindEventHandlers$(),console.debug("Screen Manager: Initialized")}}]),e}();p._RF.pop(),p._RF.push({},"9d892ZsSyxHSITF2VHJ1zpy","LudosSystem",void 0);var Ja=Ludex,Za=Ja.Configs,ei=Za.Core,ti=Za.Ads,ni=Za.Match,ri=Za.Player,ai=Ja.Events,ii=Ja.Plugins.Analytics,si=(void 0===ii?{}:ii).Events,oi=codex,ci=oi.context,ui=oi.event,li=oi.analytics,di=oi.monitorError;new(t((function e(){var t=this;a(this,e),this.adsManager$=null,this.matchManager$=null,this.playerManager$=null,this.createManager$=function(){t.coreManager$=new De,t.sceneManager$=new za,t.screenManager$=new Xa,t.engineManager$=new Ge,t.layoutManager$=new tt,t.pluginsManager$=new Fa,ti.Enabled&&(t.adsManager$=new Ee),ni.Enabled&&(t.matchManager$=new dt),ri.Enabled&&(t.playerManager$=new yt)},this.initManagers$=function(){var e,n,r;t.coreManager$.init(),t.sceneManager$.init(),t.screenManager$.init(),t.engineManager$.init(),t.layoutManager$.init(),t.pluginsManager$.init(),null===(e=t.adsManager$)||void 0===e||e.init(),null===(n=t.matchManager$)||void 0===n||n.init(),null===(r=t.playerManager$)||void 0===r||r.init()},this.listenEvents$=function(){t.coreManager$.onCoreBoot(t.handleWhenCoreBoot$),t.coreManager$.onCoreStart(t.handleWhenCoreStart$),t.coreManager$.onCoreReady(t.handleWhenCoreReady$),t.sceneManager$.onSwitchScene(t.handleSwitchScene$)},this.handleWhenCoreBoot$=function(){console.warn("Ludos System: Core boot",{inited:f.inited,game:f}),f.inited?t.handleCocosInit$():f.once(I.EVENT_GAME_INITED,t.handleCocosInit$)},this.handleCocosInit$=function(){t.coreManager$.requestStart()},this.handleWhenCoreStart$=function(){var e,n;null===(e=t.playerManager$)||void 0===e||e.setupDefaultGameData(),null===(n=t.matchManager$)||void 0===n||n.setupDefaultMatchData()},this.handleWhenCoreReady$=function(){t.initPlugins$(),si&&li.event(si.LOAD_START),ui.catchUp(ai.BUNDLE_READY,t.processPreStartGame$)},this.processPreStartGame$=function(){ui.catchUp(ai.SCENE_LOADED,t.preloadScenes$),ui.catchUp(ai.SCENE_LAUNCHED,t.processBootSceneLaunched$),t.runBootScene$()},this.processBootSceneLaunched$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ei.StartSDKAfterLoadGame){e.next=3;break}return e.next=3,ui.waitTo(ai.SCENE_LOADED);case 3:return e.next=5,GameSDK.extra.waitSDKInitiatedAsync();case 5:if(console.debug("Game paused",f.isPaused()),!f.isPaused()){e.next=9;break}return e.next=9,t.waitGameResume$();case 9:t.processStartGame$();case 10:case"end":return e.stop()}}),e)}))),this.waitGameResume$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){f.once(I.EVENT_RESUME,e)})));case 1:case"end":return e.stop()}}),e)}))),this.runBootScene$=function(){GameSDK.isGameSDK("Playable")?se.switchScene(ue.PLAYABLE_SCENE):se.switchScene(ue.BOOT_SCENE)},this.preloadScenes$=function(){GameSDK.isGameSDK("Playable")||("solo"===ci.getSessionContextType()?se.preloadDashboardScene():se.preloadGameScene())},this.processStartGame$=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.groupEnd(),si&&li.event(si.LOAD_COMPLETE),e.next=4,t.startGameAsync$();case 4:ui.catchUp(ai.PLAYER_INFO_LOADED,t.startProcessContextData$);case 5:case"end":return e.stop()}}),e)}))),this.handleSwitchScene$=function(){ae.preloadScreens(),console.groupEnd()},this.startGameAsync$=n(r().mark((function e(){var n,a=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:0,e.prev=1,e.next=4,GameSDK.startGameAsync();case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.warn("GameSDK.startGameAsync",e.t0),n<=3?setTimeout((function(){t.startGameAsync$(n+1)}),1e3):null==di||di.sendException(e.t0 instanceof Error?e.t0:new Error(JSON.stringify(e.t0)));case 10:case"end":return e.stop()}}),e,null,[[1,6]])}))),this.startProcessContextData$=n(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return si&&li.event(si.APP_READY),e.prev=1,null===(n=t.playerManager$)||void 0===n||n.requestConnectedPlayers(),e.next=5,ci.processContextData();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("startProcessContextData",e.t0),e.t0 instanceof Error&&(null==di||di.sendException(e.t0));case 11:return e.prev=11,ui.emit(ai.GAME_READY),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,7,11,14]])}))),this.initPlugins$=function(){t.pluginsManager$.initLanguages(),t.pluginsManager$.initFrameCapture(),t.pluginsManager$.initDailyRewards(),t.pluginsManager$.initLeaderboards(),t.pluginsManager$.initDynamicAtlas(),t.pluginsManager$.initDynamicAssets(),t.pluginsManager$.initCanvasRecorder(),t.pluginsManager$.initPerformanceMonitor(),t.pluginsManager$.initAdaptivePerformance()},si&&li.event(si.ENGINE_READY),console.groupCollapsed("📦 Ludos System"),this.createManager$(),this.initManagers$(),this.listenEvents$(),console.groupEnd()}))),p._RF.pop(),p._RF.push({},"826b3i39nhICrG3S59Y/cpR","PipelineData",void 0);var hi,pi=t((function e(t,n,r,i){a(this,e),this.id=4294967295,this.width=0,this.height=0,this.id=t,this.width=n,this.height=r,this.framebuffer=i}));p.user||(p.user={windowID:0,windows:new WeakMap}),p._RF.pop(),p._RF.push({},"c7df3pBHqRChZTjXMfWIy6H","Optimized2DPipeline",void 0);var fi=O.ccclass,gi=function(){function e(){var t=this;a(this,e),this.prepareCameraResources$=function(e,n){var r=function(e){var t=p.user.windows.get(e.window);return void 0!==t||(t=new pi(p.user.windowID,0,0,e.window.framebuffer),++p.user.windowID,p.user.windows.set(e.window,t)),t}(n);return 0===r.width&&0===r.height?(r.width=n.window.width,r.height=n.window.height,t.initCameraResources$(e,n,r.id,r.width,r.height)):r.framebuffer===n.window.framebuffer&&r.width===n.window.width&&r.height===n.window.height||(r.framebuffer=n.window.framebuffer,r.width=n.window.width,r.height=n.window.height,t.initCameraResources$(e,n,r.id,r.width,r.height)),r},this.initCameraResources$=function(e,n,r,a,i){e.addRenderWindow("Color".concat(r),N.Format.RGBA8,a,i,n.window),t.usesMask$&&e.addDepthStencil("DepthStencil".concat(r),N.Format.DEPTH_STENCIL,a,i)},this.buildForward$=function(e,n,r,a,i){t.clearColor$.x=n.clearColor.x,t.clearColor$.y=n.clearColor.y,t.clearColor$.z=n.clearColor.z,t.clearColor$.w=n.clearColor.w,t.viewport$.left=n.viewport.x*a,t.viewport$.top=n.viewport.y*i,t.viewport$.width=n.viewport.z*a,t.viewport$.height=n.viewport.w*i;var s=e.addRenderPass(a,i,"default");s.setViewport(t.viewport$),!function(e){return 0!=(e.clearFlag&N.ClearFlagBit.COLOR)}(n)?s.addRenderTarget("Color".concat(r),N.LoadOp.LOAD):s.addRenderTarget("Color".concat(r),N.LoadOp.CLEAR,N.StoreOp.STORE,t.clearColor$),t.usesMask$&&(n.clearFlag&N.ClearFlagBit.DEPTH_STENCIL?s.addDepthStencil("DepthStencil".concat(r),N.LoadOp.CLEAR,N.StoreOp.STORE,n.clearDepth,n.clearStencil,n.clearFlag&N.ClearFlagBit.DEPTH_STENCIL):s.addDepthStencil("DepthStencil".concat(r),N.LoadOp.LOAD))},this.viewport$=new N.Viewport,this.clearColor$=new N.Color(0,0,0,1),this.usesMask$=!0}return t(e,[{key:"setup",value:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r&&null!==r.scene&&null!==r.window){var a=this.prepareCameraResources$(t,r);this.buildForward$(t,r,a.id,a.width,a.height)}}}}]),e}();U&&(console.log("register pipeline"),U.setCustomPipeline("Optimized2DPipeline",new gi));fi("Optimized2DPipeline")(hi=function(e){d(r,e);var n=h(r);function r(){return a(this,r),n.apply(this,arguments)}return t(r,[{key:"start",value:function(){}},{key:"update",value:function(e){}}]),r}(G));p._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/systems', 'chunks:///systems.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});