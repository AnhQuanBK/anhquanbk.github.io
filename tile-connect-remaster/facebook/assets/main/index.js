System.register("chunks:///main.js",["./rollupPluginModLoBabelHelpers-59152efd.js","cc","./TournamentUtils-a5936e3c.js"],(function(){var e,t,n,i,r,a,o,s,l,u,c,p,h,d,y,f,v,m,g,b,w,k,S,C,E,x,A,T,P,R,L,I,O,_,D,M,N,B,z,F,U,G,H,q,V,W,K,j,Y,J,Z,X,Q,$,ee,te,ne,ie,re,ae,oe,se,le,ue,ce,pe,he,de,ye,fe,ve,me,ge,be,we,ke,Se,Ce,Ee,xe,Ae,Te,Pe,Re,Le,Ie,Oe,_e,De,Me,Ne,Be,ze,Fe,Ue,Ge,He,qe,Ve,We,Ke,je,Ye,Je,Ze,Xe,Qe,$e,et,tt,nt,it,rt,at,ot,st,lt,ut,ct,pt,ht,dt;return{setters:[function(w){e=w.f,t=w.c,n=w.a,i=w.b,r=w._,a=w.g,o=w.h,s=w.d,l=w.e,u=w.i,c=w.j,p=w.k,h=w.l,d=w.m,y=w.n,f=w.o,v=w.p,m=w.q,g=w.r,b=w.s},function(e){w=e.cclegacy,k=e.AudioSource,S=e._decorator,C=e.CCString,E=e.director,x=e.Component,A=e.UITransform,T=e.CCInteger,P=e.CCFloat,R=e.Widget,L=e.tween,I=e.Layout,O=e.game,_=e.ccenum,D=e.isCCObject,M=e.UIOpacity,N=e.Sprite,B=e.Enum,z=e.easing,F=e.EventHandler,U=e.Button,G=e.Input,H=e.Node,q=e.Vec3,V=e.animation,W=e.CCBoolean,K=e.Graphics,j=e.Color,Y=e.Label,J=e.Director,Z=e.sys,X=e.EventTarget,Q=e.ParticleSystem2D,$=e.math,ee=e.View,te=e.ProgressBar,ne=e.Vec2,ie=e.Layers,re=e.find,ae=e.pseudoRandomRangeInt,oe=e.randomRangeInt,se=e.SpriteFrame,le=e.Animation,ue=e.AnimationClip,ce=e.randomRange,pe=e.pseudoRandom,he=e.instantiate,de=e.Pool,ye=e.Prefab,fe=e.repeat,ve=e.js,me=e.misc,ge=e.MeshRenderData,be=e.lerp,we=e.approx,ke=e.EPSILON,Se=e.RealCurve,Ce=e.Gradient,Ee=e.bits,xe=e.random,Ae=e.toRadian,Te=e.CCClass,Pe=e.UIRenderer,Re=e.gfx,Le=e.HorizontalTextAlignment,Ie=e.Tween,Oe=e.Material,_e=e.Canvas,De=e.ScrollView,Me=e.NodeEventType,Ne=e.ResolutionPolicy,Be=e.view,ze=e.Mask},function(e){Fe=e.R,Ue=e.A,Ge=e.G,He=e.C,qe=e.a,Ve=e.b,We=e.c,Ke=e.d,je=e.e,Ye=e.L,Je=e.f,e.E,Ze=e.g,Xe=e.I,Qe=e.h,$e=e.T,et=e.i,tt=e.j,nt=e.S,it=e.k,rt=e.l,at=e.m,ot=e.n,st=e.o,lt=e.p,ut=e.q,ct=e.r,pt=e.W,ht=e.s,dt=e.t}],execute:function(){var yt;w._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var ft=null===(yt=Ludex.Plugins.Audio)||void 0===yt?void 0:yt.BaseAudioPlayer;ft||(ft=e((function e(n){t(this,e),console.warn("BaseAudioPlayer is not defined",n)})));var vt,mt,gt,bt=function(r){n(o,r);var a=i(o);function o(e,n){var i;return t(this,o),(i=a.call(this,e)).audioSource=n,i}return e(o,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,r=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=r}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===k.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),o}(ft);w._RF.pop(),w._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var wt=Ludex.Utils,kt=wt.Array,St=wt.Decorator,Ct=null===(vt=Ludex.Plugins.Audio)||void 0===vt?void 0:vt.BaseChannelManager;Ct||(Ct=e((function e(n){t(this,e),console.warn("BaseChannelManager is not defined",n)})));var Et,xt,At,Tt,Pt,Rt=(mt=St.tryCatch(),r((gt=function(r){n(u,r);var s,l=i(u);function u(e,n){var i;return t(this,u),(i=l.call(this,n)).allowMultipleTracking={},i.handleLoadedAudio=function(e,t){var n=i.node.addComponent(k);return n.clip=t,n.playOnAwake=!1,new bt(e,n)},i.node=e,i}return e(u,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof bt)&&n.getAudioSource().state===k.AudioState.PLAYING}},{key:"onLoadAudio",value:(s=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.loadAudioAsync(t);case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(this.node.isValid){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",this.handleLoadedAudio(t,i));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,r=t.allowMultiple,a=void 0!==r&&r;if(t.volume=this.getVolume()*i,a){var o=e.getAudioSource().clip;if(!o)return;return void this.requestDuplicateAudioPlayer(e.getKey(),o,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof bt)return i.getAudioSource().state===k.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var r=i.key,a=n.volume,o=void 0===a?1:a;this.setAudioClip(r,{volume:o})}return i.audioPlayer}var s=this.allowMultipleTracking[e];if(!s)throw new Error("Allow multiple tracking is not found");var l="".concat(e,"_").concat(s.currentPostFix),u=this.handleLoadedAudio(l,t);return s.list.push({audioPlayer:u,key:l}),s.currentPostFix+=1,this.setAudioClip(l,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=kt.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==k.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),u}(Ct)).prototype,"onLoadAudio",[mt],Object.getOwnPropertyDescriptor(gt.prototype,"onLoadAudio"),gt.prototype),gt);w._RF.pop(),w._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var Lt,It,Ot,_t,Dt,Mt=S.ccclass,Nt=S.property,Bt=codex,zt=Bt.audio,Ft=Bt.player;Et=Mt("Music"),xt=Nt(C),Et((Pt=r((Tt=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"channelId",Pt,l(e)),e.channel=null,e.isMute=!1,e.volume=1,e}return e(o,[{key:"__preload",value:function(){zt&&(this.makePersistent(),this.channel=new Rt(this.node,this.channelId),zt.addChannel(this.channel))}},{key:"makePersistent",value:function(){E.isPersistRootNode(this.node)||E.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),zt.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!Ft.getPlayerSetting("music")}},{key:"setVolume",value:function(e){this.volume=e,this.isMute||zt.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return zt.getVolume(this.channelId)}},{key:"pause",value:function(e){zt.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&zt.resume(e,this.channelId)}},{key:"stop",value:function(e){zt.stop(e,this.channelId)}},{key:"mute",value:function(e){this.isMute=e,e?zt.mute(this.channelId):(this.setVolume(this.volume),zt.unmute(this.channelId))}}]),o}(x)).prototype,"channelId",[xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),At=Tt));w._RF.pop(),w._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var Ut,Gt,Ht,qt,Vt,Wt,Kt,jt,Yt,Jt,Zt,Xt,Qt,$t,en,tn,nn,rn,an,on,sn=S.ccclass,ln=S.property,un=codex,cn=un.audio,pn=un.player,hn=(Lt=sn("Sound"),It=ln(C),Lt((Dt=r((_t=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"channelId",Dt,l(e)),e.channel=null,e}return e(o,[{key:"__preload",value:function(){cn&&(this.channel=new Rt(this.node,this.channelId),cn.addChannel(this.channel))}},{key:"onLoad",value:function(){""===this.channelId&&(this.channelId=this.node.uuid)}},{key:"makePersistent",value:function(){E.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){E.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){return this.isSoundEnable()?cn.play(e,t,this.channelId):Promise.resolve()}},{key:"isSoundEnable",value:function(){return!!pn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){cn.setVolume(e,this.channelId)}},{key:"pause",value:function(e){cn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&cn.resume(e,this.channelId)}},{key:"stop",value:function(e){cn.stop(e,this.channelId)}},{key:"stopAll",value:function(){cn.stopAll(this.channelId)}},{key:"mute",value:function(e){e?cn.mute(this.channelId):cn.unmute(this.channelId)}}]),o}(x)).prototype,"channelId",[It],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ot=_t))||Ot);w._RF.pop(),w._RF.push({},"84a2dB5IaRJ8JB+n9yXfBc7","AutoLayout",void 0);var dn,yn=S.ccclass,fn=S.property,vn=(Ut=yn("AutoLayoutWrappee"),Gt=fn({type:A}),Ht=fn({type:A}),Ut((Wt=r((Vt=e((function e(){t(this,e),s(this,"wrapeeContainer",Wt,this),s(this,"wrapee",Kt,this)}))).prototype,"wrapeeContainer",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=r(Vt.prototype,"wrapee",[Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Vt))||qt),mn=(jt=yn("AutoLayout"),Yt=fn({displayName:"Use Auto Layout"}),Jt=fn({type:[vn],displayName:"Children",visible:function(){return this.useAutoLayout}}),Zt=fn({visible:!1,serializable:!0}),Xt=fn({type:T,displayName:"Selected Index",visible:function(){return this.useAutoLayout}}),Qt=fn({type:P,displayName:"Deselected Icon Width",group:"Edge Icons",visible:function(){return this.useAutoLayout}}),$t=fn({visible:!1,serializable:!0}),jt((nn=r((tn=function(r){n(f,r);var d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"useAutoLayout",nn,l(e)),s(e,"children",rn,l(e)),e.mappedChildren=[],s(e,"selected",an,l(e)),s(e,"deselectedIconW",on,l(e)),e.tweens=[],e}return e(f,[{key:"selectedIndex",get:function(){return this.selected},set:function(e){this.selected=e,this.updateLayout(!0)}},{key:"deselectedIconWidth",get:function(){return this.deselectedIconW},set:function(e){this.deselectedIconW=e,this.updateLayout(!0)}},{key:"__preload",value:function(){this.mappedChildren=this.children.map((function(e){var t=e.wrapeeContainer.getComponent(R);if(!t)throw new Error("AutoLayout: Widget component not found");return u(u({},e),{},{wrapeeContainerWidget:t})}))}},{key:"updateLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._layoutDirty||e){this.updateChildrenAnchors();var t,n=c(this.mappedChildren);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.wrapeeContainerWidget.updateAlignment()}}catch(e){n.e(e)}finally{n.f()}}p(h(f.prototype),"updateLayout",this).call(this,e)}},{key:"getSelectedWorldX",value:function(){var e=this.mappedChildren[this.selectedIndex].wrapeeContainer;return 0===this.selectedIndex||this.selectedIndex===this.children.length-1?e.getBoundingBoxToWorld().xMin+this.getAnchorX(this.selectedIndex)*e.width:e.getBoundingBoxToWorld().center.x}},{key:"getAnchorX",value:function(e){if(e<this.selectedIndex)return 0;if(e>this.selectedIndex)return 1;if(0===e){var t=this.mappedChildren[e].wrapeeContainer.width,n=this.deselectedIconWidth/2,i=this.paddingLeft;return((i+t+(t-n+this.spacingX))/2-i)/t}if(e===this.children.length-1){var r=this.mappedChildren[e].wrapeeContainer.width,a=r-this.deselectedIconWidth/2+this.spacingX;return((a+r+this.paddingRight)/2-a)/r}return.5}},{key:"updateChildrenAnchors",value:(d=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c(this.tweens);try{for(t.s();!(n=t.n()).done;)n.value.stop()}catch(e){t.e(e)}finally{t.f()}return this.tweens=[],e.next=5,Promise.all([this.children.flatMap((function(e,t){return i.getChildrenAnchorsTweens(e,i.getAnchorX(t))})).map((function(e){return Ue.runTweenAsync(e)}))]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"updateChildrenAnchorsEditor",value:function(){var e=this;this.children.forEach((function(t,n){var i=e.getAnchorX(n);t.wrapee.setAnchorPoint(i,t.wrapee.anchorY),t.wrapeeContainer.setAnchorPoint(i,t.wrapeeContainer.anchorY)}))}},{key:"getChildrenAnchorsTweens",value:function(e,t){return[L(e.wrapee).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapee.setAnchorPoint(t,e.wrapee.anchorY)})),L(e.wrapeeContainer).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapeeContainer.setAnchorPoint(t,e.wrapeeContainer.anchorY)}))]}}]),f}(I)).prototype,"useAutoLayout",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),rn=r(tn.prototype,"children",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),an=r(tn.prototype,"selected",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r(tn.prototype,"selectedIndex",[Xt],Object.getOwnPropertyDescriptor(tn.prototype,"selectedIndex"),tn.prototype),r(tn.prototype,"deselectedIconWidth",[Qt],Object.getOwnPropertyDescriptor(tn.prototype,"deselectedIconWidth"),tn.prototype),on=r(tn.prototype,"deselectedIconW",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),en=tn))||en);w._RF.pop(),w._RF.push({},"32a77jcKOREvpuCe9wamBRu","Background",void 0);(0,S.ccclass)("Background")(dn=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"__preload",value:function(){this.uiTransform=this.getComponent(A),this.ratio=this.uiTransform.width/this.uiTransform.height,this.listenGameEvents(),this.handleViewResized()}},{key:"listenGameEvents",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenGameEvents",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}},{key:"handleViewResized",value:function(){var e=He.cssSizeToWorldSize(He.getScreenWidthCss()),t=He.cssSizeToWorldSize(He.getScreenHeightCss());e/t<this.ratio?(this.uiTransform.width=t*this.ratio,this.uiTransform.height=t):(this.uiTransform.width=e,this.uiTransform.height=e/this.ratio)}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}}]),o}(x));w._RF.pop(),w._RF.push({},"bf320amyc1I86bS3oK0M9NR","DashboardEvents",void 0);var gn="STARS_UPDATED",bn="PLAY_BUTTON_PRESS",wn="CUSTOM_PLAY_BUTTON_PRESS",kn="REQUEST_NAVIGATION",Sn="REQUEST_NAVIGATION_ANIMATION",Cn="DASHBOARD_EVENTS_BUTTON_PRESS";w._RF.pop(),w._RF.push({},"68b8bf0Va5JT7NVPECDNC5l","DashboardScreens",void 0);var En=function(e){return e[e.store=0]="store",e[e.collections=1]="collections",e[e.home=2]="home",e[e.leaderboard=3]="leaderboard",e[e.tournaments=4]="tournaments",e}(En||{});_(En),w._RF.pop(),w._RF.push({},"a0756pde9lOeoJ4TckTOcMV","AnimAbortSignal",void 0);var xn=Ludex.Utils.Array,An=function(){function n(){t(this,n),this.callbacks$=[],this.isAborted$=!1,this.abortReason$="",this.callbacks$=[]}var i;return e(n,[{key:"aborted",get:function(){return this.isAborted$}},{key:"reason",get:function(){return this.abortReason$}},{key:"addAbortListener",value:function(e){this.callbacks$.push(e)}},{key:"removeAbortListener",value:function(e){var t=xn.searchIndex(this.callbacks$,(function(t){return t===e}));-1!==t&&this.callbacks$.splice(t,1)}},{key:"abort",value:function(e){if(!this.isAborted$){this.isAborted$=!0,this.abortReason$=e;var t,n=c(this.callbacks$);try{for(n.s();!(t=n.n()).done;){var i=t.value;"function"==typeof i&&i()}}catch(e){n.e(e)}finally{n.f()}this.callbacks$=[]}}},{key:"untilAborted",value:(i=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAborted$){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){t.addAbortListener((function(){return e()}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"call",value:function(e){this.aborted||e(this)}},{key:"callAsync",value:function(e){return this.aborted?Promise.resolve():e(this)}},{key:"chain",value:function(e){var t=this;e instanceof n?e.addAbortListener((function(){return t.abort()})):e.addEventListener("abort",(function(){return t.abort()}))}}],[{key:"hasBeenAborted",value:function(e){return null==e||e.aborted}}]),n}();function Tn(e,t,n){var i;if("object"!==d(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var r=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(i.call(this))return null==r?void 0:r.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}};!function(e,t,n){var i=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(this.isValid)return null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}(0,t,n)}function Pn(e,t,n){var i;if("object"!==d(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var r=n.value,s=function(){var e=a(o().mark((function e(){var n,a,s,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=l.length,a=new Array(n),s=0;s<n;s++)a[s]=l[s];if(!i.call(this)){e.next=5;break}return e.next=4,null==r?void 0:r.apply(this,a);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();n.value=s};!function(e,t,n){var i=n.value,r=function(){var e=a(o().mark((function e(){var n,r,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,r=new Array(n),a=0;a<n;a++)r[a]=s[a];if(!this.isValid){e.next=5;break}return e.next=4,null==i?void 0:i.apply(this,r);case 4:return e.abrupt("return",e.sent);case 5:console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();n.value=r}(0,t,n)}w._RF.pop(),w._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),w._RF.pop(),w._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),w._RF.pop(),w._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),w._RF.pop(),w._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var Rn=function(r){n(o,r);var a=i(o);function o(e,n){var i;return t(this,o),(i=a.call(this,"".concat(e," is missing these required properties: [").concat(n.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,i.errors=n,i}return e(o)}(y(Error));w._RF.pop(),w._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var Ln=function(r){n(o,r);var a=i(o);function o(e,n){var i;return t(this,o),(i=a.call(this,"".concat(e," is missing the required property: <").concat(n,">"))).className=e,i.propertyName=n,i}return e(o)}(y(Error));w._RF.pop(),w._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var In=Ludex.Utils,On=In.String,_n=In.Valid,Dn=codex.monitorError,Mn="_compUtils_ReqPropsMap";function Nn(e){return null===e}function Bn(e){return void 0===e}function zn(e){return Nn(e)||Bn(e)}function Fn(e){if("function"==typeof e)return e;switch(e){case"null-check":return Nn;case"undefined-check":return Bn;default:return zn}}function Un(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var i,r=t.constructor.name,a=(i=n,"".concat("_compUtils_ReqPropsMethod","_").concat(On.capitalize(i)));if(void 0!==t[a])throw new Error("The required decorator found that property name ".concat(a," already exists. The reserved method name ").concat(a," is used already or the decorator was applied multiple times."));t[a]=function(t){if(e(this[n]))throw new Ln(t,n)},void 0===t[Mn]&&(t[Mn]={}),void 0===t[Mn][r]&&(t[Mn][r]=[]),t[Mn][r].push(a)}}function Gn(e,t){if("string"!=typeof t)return Un(Fn(e));var n=e;Un(Fn())(n,t)}w._RF.pop(),w._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),w._RF.pop(),w._RF.push({},"95972yG/ulEg4gycbc+QB5Y","ComponentUtils",void 0);var Hn,qn,Vn,Wn,Kn,jn,Yn,Jn,Zn,Xn,Qn,$n,ei,ti,ni,ii,ri,ai,oi,si,li,ui,ci,pi,hi,di,yi,fi,vi,mi,gi,bi,wi,ki,Si,Ci,Ei,xi,Ai=Ludex.Utils,Ti=Ai.Array,Pi=Ai.Object,Ri=Ai.Valid,Li=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],Ii=function(){function n(){t(this,n),this.validComponentCalled$={}}return e(n,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,i=e.constructor,r=this.getRequiredComponentNames(i),a=c(r);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!e.getComponent(o))throw new Error("".concat(n,": Missing required ").concat(o," component"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,i=e.constructor,r=this.getRequiredPropNames(i),a=c(r);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!Pi.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var s=this.getProperty(o,e);if(!D(s))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,i=this.getCustomPropNames(e),r=c(i);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!Pi.hasOwn(e,a))throw new Error("".concat(n,": Missing required ").concat(a," property"));var o=this.getProperty(a,e);if(!D(o))throw new Error("".concat(n,": ").concat(a," property is not a cc object"))}}catch(e){r.e(e)}finally{r.f()}}},{key:"getProperty",value:function(e,t){var n;if(Pi.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!Pi.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!Pi.hasOwn(e,t)&&(!!D(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=Li;t<n.length;t++){var i=n[t];if(i.indexOf(e)>=0)return i}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!Pi.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),i=this.getProps(e.constructor);return Ti.difference(n,i).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!Pi.hasOwn(e,n))return!1;var i=t.getProperty(n,e);return!(!Ri.isObject(i)||!D(i))}))}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"required",value:function(e,t){return"string"==typeof t?Gn(e,t):Gn(e)}},{key:"onlyRunInLifeCycle",value:function(e,t,n){return"object"===d(e)&&void 0!==t&&void 0!==n?Tn(e,t,n):Tn(e)}},{key:"onlyRunInLifeCycleAsync",value:function(e,t,n){return"object"===d(e)&&void 0!==t&&void 0!==n?Pn(e,t,n):Pn(e)}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,i,r=t?t.name:e.constructor.name,a=t?t.prototype[Mn]:e.constructor.prototype[Mn],o=null!==(n=null==a?void 0:a[r])&&void 0!==n?n:[],s=[],l=e,u=c(o);try{for(u.s();!(i=u.n()).done;){var p=i.value;if("function"==typeof l[p])try{l[p](r)}catch(h){if(!(h instanceof Ln))throw h;s.push(h)}}}catch(e){u.e(e)}finally{u.f()}if(0!==s.length){var h=new Rn(r,s);if(_n.isDebugger())throw h;console.error(h),null==Dn||Dn.sendException(h)}}(e,t)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,i=n.name;if(!this.inst.validComponentCalled$[i])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled$[i]=!0}}}}]),n}();w._RF.pop(),w._RF.push({},"ab9cd/wERRKYqhDoYtJ1L3w","MultiBackground",void 0);var Oi=S.ccclass,_i=S.property,Di=codex.monitorError,Mi=Ludex.Utils.Number,Ni=qe.Layout,Bi=(Hn=Oi("MultiBackground"),qn=Ii.required,Vn=_i({type:M}),Wn=Ii.required,Kn=_i({type:N}),jn=Ii.required,Yn=_i({type:N}),Jn=Ii.required,Zn=_i({type:M}),Xn=Ii.required,Qn=_i({type:M}),$n=Ii.required,ei=_i({type:A}),ti=Ii.required,ni=_i({type:A}),ii=Ii.required,ri=_i({type:A}),ai=_i(T),oi=Ii.required,si=_i(R),li=_i({type:B(En)}),ui=_i({type:B(En)}),ci=Ii.onlyRunInLifeCycleAsync,pi=Ii.onlyRunInLifeCycleAsync,Hn((yi=r((di=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"fallbackBackground",yi,l(e)),s(e,"background1",fi,l(e)),s(e,"background2",vi,l(e)),s(e,"background1UiOpacity",mi,l(e)),s(e,"background2UiOpacity",gi,l(e)),s(e,"screenUiTransform",bi,l(e)),s(e,"background1UiTransform",wi,l(e)),s(e,"background2UiTransform",ki,l(e)),s(e,"backgroundNudgeAmount",Si,l(e)),s(e,"nudgeableWidget",Ci,l(e)),s(e,"pageOrder",Ei,l(e)),s(e,"homePage",xi,l(e)),e.currentPage=En.home,e.tryNudgeBackground=function(t){var n=t.to;e.currentPage=n;var i=e.getDirection(e.homePage,n),r=Mi.sign(i),a=Math.abs(i),o=e.backgroundNudgeAmount*a,s=Math.min(e.background1UiTransform.width,e.background2UiTransform.width),l=Math.max(0,(s-e.screenUiTransform.width)/2),u=Math.min(l,o)*r;L(e.nudgeableWidget).to(.5,{horizontalCenter:u},{easing:z.cubicInOut}).start()},e}return e(h,[{key:"__preload",value:function(){this.currentBackground=this.background1,this.nextBackground=this.background2,this.currentBackgroundUiOpacity=this.background1UiOpacity,this.nextBackgroundUiOpacity=this.background2UiOpacity}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this,h),this.listenToNavigationEvents()}},{key:"onDestroy",value:function(){this.unlistenToNavigationEvents()}},{key:"listenToNavigationEvents",value:function(){this.node.scene.on(Sn,this.tryNudgeBackground),O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"unlistenToNavigationEvents",value:function(){this.node.scene.off(Sn,this.tryNudgeBackground),O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"getDirection",value:function(e,t){var n=this.pageOrder.indexOf(e),i=this.pageOrder.indexOf(t);return-1===n||-1===i?(null==Di||Di.sendException(new Error("MultiBackground.getDirection: fromIndex or toIndex is -1")),0):n-i}},{key:"setCurrentTheme",value:(c=a(o().mark((function e(t,n){var i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentThemeId!==t){e.next=2;break}return e.abrupt("return");case 2:return this.currentThemeId=t,null===(i=this.tweenSignal)||void 0===i||i.abort(),r=new An,null==n||n.chain(r),this.tweenSignal=r,e.next=9,Fe.loadThemeAsync(t);case 9:if(a=e.sent){e.next=13;break}return null==Di||Di.sendException(new Error("MultiBackground.setCurrentTheme: Failed to load theme ".concat(t,"'s sprite."))),e.abrupt("return");case 13:if(!r.aborted){e.next=15;break}return e.abrupt("return");case 15:return e.next=17,this.updateBackground(a,r);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"updateBackground",value:(u=a(o().mark((function e(t,n){var i,r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.packable=!1,i=this.currentBackground,r=this.nextBackground,a=this.currentBackgroundUiOpacity,s=this.nextBackgroundUiOpacity,l=this.fallbackBackground,r.spriteFrame=t,r.node.setSiblingIndex(1),s.opacity=0,l.opacity=255,e.next=12,Ue.runTweenAsync(L(s).to(.25,{opacity:255}),n);case 12:a.opacity=0,l.opacity=0,this.currentBackground=r,this.nextBackground=i,this.currentBackgroundUiOpacity=r===this.background1?this.background1UiOpacity:this.background2UiOpacity,this.nextBackgroundUiOpacity=i===this.background1?this.background1UiOpacity:this.background2UiOpacity;case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){if(e===Ni.Portrait){var t=this.getDirection(this.homePage,this.currentPage),n=Mi.sign(t),i=Math.abs(t),r=this.backgroundNudgeAmount*i,a=Math.min(this.background1UiTransform.width,this.background2UiTransform.width),o=Math.max(0,(a-this.screenUiTransform.width)/2),s=Math.min(o,r)*n;this.nudgeableWidget.horizontalCenter=s}else e===Ni.Landscape&&(this.nudgeableWidget.horizontalCenter=0)}}]),h}(x)).prototype,"fallbackBackground",[qn,Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fi=r(di.prototype,"background1",[Wn,Kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vi=r(di.prototype,"background2",[jn,Yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mi=r(di.prototype,"background1UiOpacity",[Jn,Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi=r(di.prototype,"background2UiOpacity",[Xn,Qn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bi=r(di.prototype,"screenUiTransform",[$n,ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wi=r(di.prototype,"background1UiTransform",[ti,ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ki=r(di.prototype,"background2UiTransform",[ii,ri],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=r(di.prototype,"backgroundNudgeAmount",[ai],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Ci=r(di.prototype,"nudgeableWidget",[oi,si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=r(di.prototype,"pageOrder",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xi=r(di.prototype,"homePage",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return En.home}}),r(di.prototype,"setCurrentTheme",[ci],Object.getOwnPropertyDescriptor(di.prototype,"setCurrentTheme"),di.prototype),r(di.prototype,"updateBackground",[pi],Object.getOwnPropertyDescriptor(di.prototype,"updateBackground"),di.prototype),hi=di))||hi);w._RF.pop(),w._RF.push({},"cb1abhXDs1A57EPVKbvTJg/","ButtonPlusEvents",void 0);var zi="TRANSITION_DOWN",Fi="TRANSITION_HOVER",Ui="TRANSITION_RESET",Gi="TRANSITION_DISABLED",Hi="CLICK_START",qi="CLICK",Vi="CLICK_END",Wi="CLICK_CANCEL";w._RF.pop(),w._RF.push({},"d159egaUVVLHKLg1UL865ub","SoundKeys",void 0);var Ki="musics/",ji="sounds/",Yi=Ludex.Utils.Object,Ji={BUTTON_CLICK:"".concat(ji,"use_item_click"),BOMB_DEFUSE:"".concat(ji,"bomb_defuse"),BOMB_EXPLODE_1:"".concat(ji,"bomb_explode_1"),BOMB_EXPLODE_2:"".concat(ji,"bomb_explode_2"),CLICKS:"".concat(ji,"clicks"),CLOSE_POPUP_CLICK:"".concat(ji,"close_popup_click"),COLLECT_STARS:"".concat(ji,"collect_stars"),COMBO_1:"".concat(ji,"combo_1"),COMBO_2:"".concat(ji,"combo_2"),COMBO_3:"".concat(ji,"combo_3"),COMBO_4:"".concat(ji,"combo_4"),COMBO_5:"".concat(ji,"combo_5"),DAILY_REWARD:"".concat(ji,"daily_reward"),EXTRA_TIME_SPAWN:"".concat(ji,"extra_time_spawn"),GIFT_CHARGE:"".concat(ji,"gift_charge"),GIFT_EXPLODE:"".concat(ji,"gift_explode"),GIFT_REVEAL:"".concat(ji,"gift_reveal"),HINT_ITEM:"".concat(ji,"hint_item"),INVALID_MATCH:"".concat(ji,"invalid_match"),LEVEL_COMPLETE:"".concat(ji,"level_complete"),LEVEL_FAIL:"".concat(ji,"level_fail"),LEVEL_START:"".concat(ji,"level_start"),PROGRESS_STAR:"".concat(ji,"progress_star"),RESCUE_TIMER:"".concat(ji,"rescue_timer"),ROCKET_FLY:"".concat(ji,"rocket_fly"),SHUFFLE_ITEM:"".concat(ji,"shuffle_item"),THREE_STARS:"".concat(ji,"three_stars"),TICKING_BOMB_BEFORE_EXPLODE:"".concat(ji,"ticking_bomb_before_explode"),TILE_SELECT:"".concat(ji,"tile_select"),USE_ITEM_CLICK:"".concat(ji,"use_item_click"),BG_MUSIC:"".concat(Ki,"bg_music"),PATCH_SHIFT:"".concat(ji,"patch_shift"),THUNDERBOLT:"".concat(ji,"thunderbolt"),WIND:"".concat(ji,"wind"),COLLECT_COINS:"".concat(ji,"collect_coins"),COLLECT_STOCK_COINS:"".concat(ji,"collect_stock_coins"),LEVEL_FAIL_TIMEOUT:"".concat(ji,"level_fail_timeout"),STAR_CHEST_DRUM_ROLL:"".concat(ji,"star_chest_drum_roll"),STAR_CHEST_OPEN:"".concat(ji,"star_chest_open"),LEADERBOARD_TRIUMPH:"".concat(ji,"leaderboard_triumph"),ITEM_REWARD:"".concat(ji,"item_reward"),COMBO_6:"".concat(ji,"combo_6"),COMBO_7:"".concat(ji,"combo_7"),COMBO_8:"".concat(ji,"combo_8"),COMBO_9:"".concat(ji,"combo_9"),COMBO_10:"".concat(ji,"combo_10"),COMBO_11:"".concat(ji,"combo_11"),COMBO_12:"".concat(ji,"combo_12"),COMBO_13:"".concat(ji,"combo_13"),TILE_MATCH:"".concat(ji,"tile_match"),TOURNAMENT_MUSIC:"".concat(Ki,"tournament_music")},Zi=Yi.vals(Ji),Xi=Zi.reduce((function(e,t,n){return e[t]=n,e}),{});_(Xi);var Qi,$i,er,tr,nr,ir,rr,ar,or,sr,lr,ur,cr,pr,hr,dr,yr,fr,vr,mr,gr,br,wr,kr,Sr,Cr,Er,xr,Ar,Tr=Zi;w._RF.pop(),w._RF.push({},"56710cJAPhPd4KK3hV3y8m6","ButtonPlus",void 0);var Pr,Rr,Lr,Ir,Or,_r,Dr,Mr,Nr,Br,zr,Fr=S.ccclass,Ur=S.property,Gr=S.disallowMultiple,Hr=S.menu,qr=(Qi=Fr("ButtonPlus"),$i=Hr("Ludex/ButtonPlus/ButtonPlus"),er=Ur(F),tr=Ur(F),nr=Ur(F),ir=Ur({override:!0,visible:!1}),rr=Ur({override:!0,visible:!1}),ar=Ur({override:!0,visible:!1}),or=Ur({override:!0,visible:!1}),sr=Ur({override:!0,visible:!1}),lr=Ur({override:!0,visible:!1}),ur=Ur({override:!0,visible:!1}),cr=Ur({override:!0,visible:!1}),pr=Ur({override:!0,visible:!1}),hr=Ur({override:!0,visible:!1}),dr=Ur({override:!0,visible:!1}),yr=Ur({visible:function(){return this.makeSound},type:Xi}),fr=Ur({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),vr=Ur({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),Qi(mr=Gr(mr=$i((br=r((gr=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"onClickStartEvents",br,l(e)),s(e,"onClickEndEvents",wr,l(e)),s(e,"onClickCancelEvents",kr,l(e)),s(e,"makeSound",Sr,l(e)),s(e,"soundKey",Cr,l(e)),s(e,"disableSpamClick",Er,l(e)),s(e,"disableSpamDelay",xr,l(e)),s(e,"performBoundsCheckOnClickCancel",Ar,l(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.hasBeenDisabled=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=He.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(e.performBoundsCheckOnClickCancel){var n,i,r=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(r))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickCancelEvents(t),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.emitTransitionEvent(Fi)))},e.onMouseLeave=function(t){e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.emitTransitionEvent(Ui)},e}return e(o,[{key:"transition",get:function(){return U.Transition.NONE},set:function(e){f(h(o.prototype),"transition",U.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return p(h(o.prototype),"normalColor",this)},set:function(e){f(h(o.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return p(h(o.prototype),"pressedColor",this)},set:function(e){f(h(o.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return p(h(o.prototype),"hoverColor",this)},set:function(e){f(h(o.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return p(h(o.prototype),"disabledColor",this)},set:function(e){f(h(o.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return p(h(o.prototype),"normalSprite",this)},set:function(e){f(h(o.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return p(h(o.prototype),"pressedSprite",this)},set:function(e){f(h(o.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return p(h(o.prototype),"hoverSprite",this)},set:function(e){f(h(o.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return p(h(o.prototype),"disabledSprite",this)},set:function(e){f(h(o.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return p(h(o.prototype),"duration",this)},set:function(e){f(h(o.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return p(h(o.prototype),"zoomScale",this)},set:function(e){f(h(o.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){p(h(o.prototype),"__preload",this).call(this)}},{key:"onDestroy",value:function(){var e;null===(e=p(h(o.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=p(h(o.prototype),"onEnable",this))||void 0===e||e.call(this),this.hasBeenDisabled=!this.interactable,this.node.off(G.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(H.EventType.TOUCH_START,this.onTouchStart),this.node.on(H.EventType.TOUCH_END,this.onTouchEnd),this.node.on(H.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=p(h(o.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(H.EventType.TOUCH_START,this.onTouchStart),this.node.off(H.EventType.TOUCH_END,this.onTouchEnd),this.node.off(H.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(H.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"_updateState",value:function(){p(h(o.prototype),"_updateState",this).call(this),this.patchEmitTransitionDisabled()}},{key:"patchEmitTransitionDisabled",value:function(){var e=3===this._getButtonState();this.hasBeenDisabled!==e&&(e?this.emitTransitionEvent(Gi):this.emitTransitionEvent(Ui),this.hasBeenDisabled=e)}},{key:"handleDown",value:function(e){this.hasDown=!0,this.makeSound&&Ve.playSound(Tr[this.soundKey]),this.emitTransitionEvent(zi),this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=c(this.onClickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Hi)}},{key:"emitClickEndEvents",value:function(e){var t,n=c(this.onClickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Vi)}},{key:"emitClickCancelEvents",value:function(e){var t,n=c(this.onClickCancelEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Wi)}},{key:"handleUp",value:function(e){this.hasUp=!0,this.hasFinishClickCycle=!0,this.emitTransitionEvent(Ui),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){var t,n=c(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(qi)}}},{key:"emitTransitionEvent",value:function(e){this.node.emit(e)}},{key:"fakeClick",value:function(){var e=this;this.emitTransitionEvent(zi),this.scheduleOnce((function(){e.emitTransitionEvent(Ui)}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}},{key:"setInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.interactable=e,t&&(this.enabled=e)}}]),o}(U)).prototype,"onClickStartEvents",[er],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wr=r(gr.prototype,"onClickEndEvents",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kr=r(gr.prototype,"onClickCancelEvents",[nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),r(gr.prototype,"transition",[ir],Object.getOwnPropertyDescriptor(gr.prototype,"transition"),gr.prototype),r(gr.prototype,"normalColor",[rr],Object.getOwnPropertyDescriptor(gr.prototype,"normalColor"),gr.prototype),r(gr.prototype,"pressedColor",[ar],Object.getOwnPropertyDescriptor(gr.prototype,"pressedColor"),gr.prototype),r(gr.prototype,"hoverColor",[or],Object.getOwnPropertyDescriptor(gr.prototype,"hoverColor"),gr.prototype),r(gr.prototype,"disabledColor",[sr],Object.getOwnPropertyDescriptor(gr.prototype,"disabledColor"),gr.prototype),r(gr.prototype,"normalSprite",[lr],Object.getOwnPropertyDescriptor(gr.prototype,"normalSprite"),gr.prototype),r(gr.prototype,"pressedSprite",[ur],Object.getOwnPropertyDescriptor(gr.prototype,"pressedSprite"),gr.prototype),r(gr.prototype,"hoverSprite",[cr],Object.getOwnPropertyDescriptor(gr.prototype,"hoverSprite"),gr.prototype),r(gr.prototype,"disabledSprite",[pr],Object.getOwnPropertyDescriptor(gr.prototype,"disabledSprite"),gr.prototype),r(gr.prototype,"duration",[hr],Object.getOwnPropertyDescriptor(gr.prototype,"duration"),gr.prototype),r(gr.prototype,"zoomScale",[dr],Object.getOwnPropertyDescriptor(gr.prototype,"zoomScale"),gr.prototype),Sr=r(gr.prototype,"makeSound",[Ur],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Cr=r(gr.prototype,"soundKey",[yr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xi[Ji.BUTTON_CLICK]}}),Er=r(gr.prototype,"disableSpamClick",[fr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),xr=r(gr.prototype,"disableSpamDelay",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ar=r(gr.prototype,"performBoundsCheckOnClickCancel",[Ur],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),mr=gr))||mr)||mr)||mr);w._RF.pop(),w._RF.push({},"b7001YamGNLeauE1hUAtFfj","ButtonPlusAnalytics",void 0);var Vr,Wr,Kr,jr,Yr,Jr,Zr,Xr,Qr,$r,ea,ta,na,ia,ra,aa,oa,sa,la,ua,ca=S.ccclass,pa=S.property,ha=S.disallowMultiple,da=S.requireComponent,ya=S.menu,fa=Ludex.Plugins.Analytics,va=(void 0===fa?{}:fa).Events,ma=codex.analytics;Pr=ca("ButtonPlusAnalytics"),Rr=da(qr),Lr=ya("Ludex/ButtonPlus/ButtonPlusAnalytics"),Ir=Ii.required,Or=pa(qr),_r=pa({visible:function(){return this.useCustomButtonName}}),Pr(Dr=ha(Dr=Rr(Dr=Lr((Nr=r((Mr=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"button",Nr,l(e)),s(e,"useCustomButtonName",Br,l(e)),s(e,"customButtonName",zr,l(e)),e}return e(o,[{key:"onEnable",value:function(){this.button.node.on(qi,this.onClick,this)}},{key:"onDisable",value:function(){this.button.node.off(zi,this.onClick,this)}},{key:"onClick",value:function(){va&&ma.event(va.BUTTON_CLICK,{button_name:this.useCustomButtonName?this.customButtonName:this.node.name,screen_name:We.getCurrentPage()})}}]),o}(x)).prototype,"button",[Ir,Or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Br=r(Mr.prototype,"useCustomButtonName",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),zr=r(Mr.prototype,"customButtonName",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Dr=Mr))||Dr)||Dr)||Dr);w._RF.pop(),w._RF.push({},"a89b3F866FGO68YNa+5Tsqh","ButtonPlusScale",void 0);var ga,ba,wa,ka,Sa,Ca,Ea,xa,Aa,Ta,Pa,Ra,La,Ia,Oa,_a,Da,Ma,Na,Ba,za,Fa,Ua,Ga,Ha,qa,Va,Wa,Ka,ja,Ya,Ja,Za,Xa,Qa,$a=S.ccclass,eo=S.property,to=S.disallowMultiple,no=S.requireComponent,io=S.menu,ro=Ludex.Utils.Signal;Vr=$a("ButtonPlusScale"),Wr=no(qr),Kr=io("Ludex/ButtonPlus/ButtonPlusScale"),jr=Ii.required,Yr=eo(qr),Jr=eo({group:{name:"Normal",style:"section"},displayName:"Scale"}),Zr=eo({group:{name:"Normal",style:"section"},displayName:"Duration"}),Xr=eo({group:{name:"Hover",style:"section"},displayName:"Scale"}),Qr=eo({group:{name:"Hover",style:"section"},displayName:"Duration"}),$r=eo({group:{name:"Click",style:"section"},displayName:"Scale"}),ea=eo({group:{name:"Click",style:"section"},displayName:"Duration"}),Vr(ta=to(ta=Wr(ta=Kr((ia=r((na=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"button",ia,l(e)),s(e,"normalScale",ra,l(e)),s(e,"normalDuration",aa,l(e)),s(e,"hoverScale",oa,l(e)),s(e,"hoverDuration",sa,l(e)),s(e,"clickScale",la,l(e)),s(e,"clickDuration",ua,l(e)),e.animStateController=new ro.SignalController,e}return e(o,[{key:"start",value:function(){this.button.node.setScale(this.normalScale)}},{key:"onEnable",value:function(){this.button.node.on(zi,this.onTransitionDown,this),this.button.node.on(Fi,this.onTransitionHover,this),this.button.node.on(Ui,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(zi,this.onTransitionDown,this),this.button.node.off(Fi,this.onTransitionHover,this),this.button.node.off(Ui,this.onTransitionReset,this)}},{key:"onTransitionDown",value:function(){Ue.runTweenAsync(L(this.button.node).to(this.clickDuration,{scale:this.clickScale},{easing:"cubicOut"}),this.animStateController.renew())}},{key:"onTransitionHover",value:function(){Ue.runTweenAsync(L(this.button.node).to(this.hoverDuration,{scale:this.hoverScale},{easing:"backOut"}),this.animStateController.renew())}},{key:"onTransitionReset",value:function(){Ue.runTweenAsync(L(this.button.node).to(this.normalDuration,{scale:this.normalScale},{easing:"cubicOut"}),this.animStateController.renew())}}]),o}(x)).prototype,"button",[jr,Yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ra=r(na.prototype,"normalScale",[Jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(1,1,1)}}),aa=r(na.prototype,"normalDuration",[Zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),oa=r(na.prototype,"hoverScale",[Xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(1.1,1.1,1.1)}}),sa=r(na.prototype,"hoverDuration",[Qr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),la=r(na.prototype,"clickScale",[$r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(.9,.9,.9)}}),ua=r(na.prototype,"clickDuration",[ea],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),ta=na))||ta)||ta)||ta);w._RF.pop(),w._RF.push({},"ef63ctZn6BPAout9ufUgFVq","ExtendedButton",void 0);var ao,oo,so,lo,uo=S.ccclass,co=S.property,po=S.disallowMultiple,ho=S.executionOrder,yo=codex.analytics,fo=Ludex,vo=fo.Plugins.Analytics,mo=(void 0===vo?{}:vo).Events,go=fo.Utils.Valid,bo=(ga=uo("ExtendedButton"),ba=ho(111),wa=co(F),ka=co(F),Sa=co(V.AnimationController),Ca=co({override:!0,visible:!1}),Ea=co({override:!0,visible:!1}),xa=co({override:!0,visible:!1}),Aa=co({override:!0,visible:!1}),Ta=co({override:!0,visible:!1}),Pa=co({override:!0,visible:!1}),Ra=co({override:!0,visible:!1}),La=co({override:!0,visible:!1}),Ia=co({override:!0,visible:!1}),Oa=co({override:!0,visible:!1}),_a=co({override:!0,visible:!1}),Da=co(W),Ma=co(W),Na=co(W),Ba=co({visible:function(){return this.makeSound},type:Xi}),za=co({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),Fa=co({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),Ua=co({}),ga(Ga=po(Ga=ba((qa=r((Ha=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"clickStartEvents",qa,l(e)),s(e,"clickEndEvents",Va,l(e)),s(e,"animationController",Wa,l(e)),s(e,"useDesktopHover",Ka,l(e)),s(e,"emitAnalyticsEvents",ja,l(e)),s(e,"makeSound",Ya,l(e)),s(e,"soundKey",Ja,l(e)),s(e,"disableSpamClick",Za,l(e)),s(e,"disableSpamDelay",Xa,l(e)),s(e,"isScrollViewCancelInnerEvents",Qa,l(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=He.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(!e.isScrollViewCancelInnerEvents){var n,i,r=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(r))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.setAnimationState("HOVER")))},e.onMouseLeave=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.setAnimationState("RESET")},e}return e(o,[{key:"transition",get:function(){return U.Transition.NONE},set:function(e){f(h(o.prototype),"transition",U.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return p(h(o.prototype),"normalColor",this)},set:function(e){f(h(o.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return p(h(o.prototype),"pressedColor",this)},set:function(e){f(h(o.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return p(h(o.prototype),"hoverColor",this)},set:function(e){f(h(o.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return p(h(o.prototype),"disabledColor",this)},set:function(e){f(h(o.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return p(h(o.prototype),"normalSprite",this)},set:function(e){f(h(o.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return p(h(o.prototype),"pressedSprite",this)},set:function(e){f(h(o.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return p(h(o.prototype),"hoverSprite",this)},set:function(e){f(h(o.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return p(h(o.prototype),"disabledSprite",this)},set:function(e){f(h(o.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return p(h(o.prototype),"duration",this)},set:function(e){f(h(o.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return p(h(o.prototype),"zoomScale",this)},set:function(e){f(h(o.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){p(h(o.prototype),"__preload",this).call(this),Ii.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){var e;null===(e=p(h(o.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=p(h(o.prototype),"onEnable",this))||void 0===e||e.call(this),this.node.off(G.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(H.EventType.TOUCH_START,this.onTouchStart),this.node.on(H.EventType.TOUCH_END,this.onTouchEnd),this.node.on(H.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=p(h(o.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(H.EventType.TOUCH_START,this.onTouchStart),this.node.off(H.EventType.TOUCH_END,this.onTouchEnd),this.node.off(H.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(H.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleDown",value:function(e){if(this.hasDown=!0,this.setAnimationState("DOWN"),this.makeSound&&go.isString(this.soundKey)){var t=Tr[this.soundKey];t&&Ve.playSound(t)}this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=c(this.clickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"emitClickEndEvents",value:function(e){var t,n=c(this.clickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleUp",value:function(e){this.hasUp=!0,this.hasFinishClickCycle=!0,this.setAnimationState("RESET"),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){this.emitAnalyticsEvents&&mo&&yo.event(mo.BUTTON_CLICK,{button_name:this.node.name,screen_name:We.getCurrentPage()});var t,n=c(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}}},{key:"setAnimationState",value:function(e){this.animationController&&(this.animationController.setValue("DOWN","DOWN"===e),this.animationController.setValue("HOVER","HOVER"===e),this.animationController.setValue("RESET","RESET"===e))}},{key:"fakeClick",value:function(){var e=this;this.setAnimationState("DOWN"),this.scheduleOnce((function(){e.setAnimationState("RESET")}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}}]),o}(U)).prototype,"clickStartEvents",[wa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Va=r(Ha.prototype,"clickEndEvents",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Wa=r(Ha.prototype,"animationController",[Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Ha.prototype,"transition",[Ca],Object.getOwnPropertyDescriptor(Ha.prototype,"transition"),Ha.prototype),r(Ha.prototype,"normalColor",[Ea],Object.getOwnPropertyDescriptor(Ha.prototype,"normalColor"),Ha.prototype),r(Ha.prototype,"pressedColor",[xa],Object.getOwnPropertyDescriptor(Ha.prototype,"pressedColor"),Ha.prototype),r(Ha.prototype,"hoverColor",[Aa],Object.getOwnPropertyDescriptor(Ha.prototype,"hoverColor"),Ha.prototype),r(Ha.prototype,"disabledColor",[Ta],Object.getOwnPropertyDescriptor(Ha.prototype,"disabledColor"),Ha.prototype),r(Ha.prototype,"normalSprite",[Pa],Object.getOwnPropertyDescriptor(Ha.prototype,"normalSprite"),Ha.prototype),r(Ha.prototype,"pressedSprite",[Ra],Object.getOwnPropertyDescriptor(Ha.prototype,"pressedSprite"),Ha.prototype),r(Ha.prototype,"hoverSprite",[La],Object.getOwnPropertyDescriptor(Ha.prototype,"hoverSprite"),Ha.prototype),r(Ha.prototype,"disabledSprite",[Ia],Object.getOwnPropertyDescriptor(Ha.prototype,"disabledSprite"),Ha.prototype),r(Ha.prototype,"duration",[Oa],Object.getOwnPropertyDescriptor(Ha.prototype,"duration"),Ha.prototype),r(Ha.prototype,"zoomScale",[_a],Object.getOwnPropertyDescriptor(Ha.prototype,"zoomScale"),Ha.prototype),Ka=r(Ha.prototype,"useDesktopHover",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ja=r(Ha.prototype,"emitAnalyticsEvents",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ya=r(Ha.prototype,"makeSound",[Na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ja=r(Ha.prototype,"soundKey",[Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xi[Ji.BUTTON_CLICK]}}),Za=r(Ha.prototype,"disableSpamClick",[za],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Xa=r(Ha.prototype,"disableSpamDelay",[Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Qa=r(Ha.prototype,"isScrollViewCancelInnerEvents",[Ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ga=Ha))||Ga)||Ga)||Ga);w._RF.pop(),w._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var wo,ko,So,Co=S.ccclass,Eo=S.requireComponent,xo=S.property,Ao=Co("OpacityToggler")(ao=Eo([M])((so=r((oo=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"activeValue",so,l(e)),s(e,"inActiveValue",lo,l(e)),e.signal=new An,e}return e(p,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.signal.abort(),this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}},{key:"changeStateFade",value:(u=a(o().mark((function e(){var t,n,i,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],n=r.length>1&&void 0!==r[1]?r[1]:.2,this.signal.abort(),this.signal=new An,i=t?this.activeValue:this.inActiveValue,e.next=7,Ue.runTweenAsync(L(this.opacityComponent).to(n,{opacity:i}),this.signal);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(x)).prototype,"activeValue",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),lo=r(oo.prototype,"inActiveValue",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),ao=oo))||ao)||ao;w._RF.pop(),w._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var To=S.ccclass,Po=S.property,Ro=S.requireComponent,Lo=S.disallowMultiple,Io=S.executeInEditMode,Oo=qe.DesignSize,_o=Oo.Portrait,Do=Oo.Landscape;To("DebugResolution")(wo=Lo(wo=Ro([K])(wo=Io(!0)(((So=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return e(o,[{key:"drawPortrait",get:function(){return o._drawPortrait},set:function(e){e!==o._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),o._drawPortrait=e,o._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return o._drawLandscape},set:function(e){e!==o._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),o._drawLandscape=e,o._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(K),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){O.on(Ge.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=_o.WIDTH,n=_o.HEIGHT,i=-t/2,r=-n/2;e.strokeColor=j.GREEN,e.rect(i,r,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=Do.WIDTH,n=Do.HEIGHT,i=-t/2,r=-n/2;e.strokeColor=j.CYAN,e.rect(i,r,t,n),e.stroke()}}}]),o}(x))._drawPortrait=!0,So._drawLandscape=!0,r((ko=So).prototype,"drawPortrait",[Po],Object.getOwnPropertyDescriptor(ko.prototype,"drawPortrait"),ko.prototype),r(ko.prototype,"drawLandscape",[Po],Object.getOwnPropertyDescriptor(ko.prototype,"drawLandscape"),ko.prototype),wo=ko))||wo)||wo)||wo);w._RF.pop(),w._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var Mo,No,Bo,zo,Fo,Uo,Go,Ho,qo,Vo,Wo,Ko,jo,Yo,Jo,Zo,Xo,Qo,$o,es,ts,ns,is,rs,as,os,ss,ls,us,cs,ps,hs,ds,ys,fs,vs,ms,gs,bs,ws,ks,Ss,Cs=function(){function n(){t(this,n),this.time=0,this._value=0,this.time=0,this._value=0}return e(n,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),n}();w._RF.pop(),w._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var Es=S.ccclass,xs=S.executionOrder,As=S.property,Ts=S.requireComponent,Ps=Ludex,Rs=Ps.Utils,Ls=Rs.Valid,Is=Rs.Array,Os=Rs.Device,_s=Ps.Configs.Debugger.ListPlayerDevIds,Ds=codex.player,Ms=j.RED,Ns=j.YELLOW,Bs=j.WHITE,zs=j.BLACK;Mo=Es("GameStats"),No=xs(-1e3),Bo=Ts([M]),zo=Ii.required(),Fo=As(Y),Uo=Ii.required(),Go=As(Y),Ho=Ii.required(),qo=As(Y),Vo=Ii.required(),Wo=As(Y),Ko=Ii.required(),jo=As(Y),Yo=Ii.required(),Jo=As(Y),Zo=Ii.required(),Xo=As(Y),Qo=Ii.required(),$o=As(Y),es=Ii.required(),ts=As(Y),ns=Ii.required(),is=As(Y),rs=Ii.required(),as=As(Y),os=Ii.required(),ss=Ii.required(),Mo(ls=No(ls=Bo((cs=r((us=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"dprLabel",cs,l(e)),s(e,"fpsLabel",ps,l(e)),s(e,"fpsRawLabel",hs,l(e)),s(e,"drawCountLabel",ds,l(e)),s(e,"rafTimeLabel",ys,l(e)),s(e,"deltaTimeLabel",fs,l(e)),s(e,"logicTimeLabel",vs,l(e)),s(e,"physicTimeLabel",ms,l(e)),s(e,"renderTimeLabel",gs,l(e)),s(e,"objectMemoryUsageLabel",bs,l(e)),s(e,"textureMemoryUsageLabel",ws,l(e)),s(e,"bg",ks,l(e)),s(e,"opacity",Ss,l(e)),e.lastRafTime=0,e.slowRefreshInterval=1,e.mediumRefreshInterval=.5,e.fastRefreshInterval=.16,e.isBackgroundEnabled=!1,e.touchMs=0,e.isDragging=!1,e.handleTouchStart=function(t){t.touch&&(e.isDragging=!1,Date.now()-e.touchMs<300?e.opacity&&(e.opacity.opacity=0):e.opacity&&(e.opacity.opacity=255),e.touchMs=Date.now())},e.handleTouchMove=function(t){var n=t.touch;if(n){var i=n.getUIDelta();!e.isDragging&&i.length()>10&&(e.isDragging=!0),e.isDragging&&e.node.setPosition(e.node.position.x+i.x,e.node.position.y+i.y)}},e.handleTouchEnd=function(){e.isDragging||(e.bg.enabled=!e.bg.enabled,e.isBackgroundEnabled=e.bg.enabled),e.isDragging=!1},e.updateFastStats=function(){e.updateFpsRaw(),e.updateRafTime(),e.updateDeltaTime()},e.updateSlowStats=function(){e.updateDPR(),e.updateDrawCalls(),e.updateObjectMemoryUsage(),e.updateTextureMemoryUsage()},e.updateMediumStats=function(){e.updateFps(),e.updateLogicTime(),e.updatePhysicTime(),e.updateRenderTime()},e.calcRafTime=function(t){var n;null!==(n=e.node)&&void 0!==n&&n.isValid&&(e.rafTimeCounter.end(t),e.lastRafTime=t,e.handleRequestAnimationFrame())},e.handleRequestAnimationFrame=function(){e.rafTimeCounter.start(e.lastRafTime),requestAnimationFrame(e.calcRafTime)},e}return e(o,[{key:"__preload",value:function(){this.bg=this.getComponent(N),this.opacity=this.getComponent(M),this.listenInputEvents()}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this)}},{key:"listenInputEvents",value:function(){this.node.on(G.EventType.TOUCH_START,this.handleTouchStart),this.node.on(G.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.on(G.EventType.TOUCH_END,this.handleTouchEnd),this.node.on(G.EventType.TOUCH_CANCEL,this.handleTouchEnd)}},{key:"start",value:function(){this.bg.enabled=!1,this.canDisplayStats()?(this.node.active=!0,this.rafTimeCounter=new Cs,this.logicTimeCounter=new Cs,this.physicTimeCounter=new Cs,this.renderTimeCounter=new Cs,E.on(J.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),E.on(J.EVENT_AFTER_UPDATE,this.afterUpdate,this),E.on(J.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),E.on(J.EVENT_AFTER_PHYSICS,this.afterPhysics,this),E.on(J.EVENT_BEFORE_DRAW,this.beforeDraw,this),E.on(J.EVENT_AFTER_DRAW,this.afterDraw,this),this.startUpdateStats()):this.node.active=!1}},{key:"onDestroy",value:function(){this.canDisplayStats()&&(E.off(J.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),E.off(J.EVENT_AFTER_UPDATE,this.afterUpdate,this),E.off(J.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),E.off(J.EVENT_AFTER_PHYSICS,this.afterPhysics,this),E.off(J.EVENT_BEFORE_DRAW,this.beforeDraw,this),E.off(J.EVENT_AFTER_DRAW,this.afterDraw,this),this.unschedule(this.updateSlowStats),this.unschedule(this.updateFastStats),this.unschedule(this.updateMediumStats),this.node.off(G.EventType.TOUCH_START,this.handleTouchStart),this.node.off(G.EventType.TOUCH_MOVE,this.handleTouchMove),this.node.off(G.EventType.TOUCH_END,this.handleTouchEnd),this.node.off(G.EventType.TOUCH_CANCEL,this.handleTouchEnd))}},{key:"canDisplayStats",value:function(){return Ls.isDebugger()||Is.has(_s,Ds.getPlayerId())}},{key:"startUpdateStats",value:function(){this.schedule(this.updateFastStats,this.fastRefreshInterval),this.schedule(this.updateSlowStats,this.slowRefreshInterval),this.schedule(this.updateMediumStats,this.mediumRefreshInterval),requestAnimationFrame(this.handleRequestAnimationFrame)}},{key:"updateFps",value:function(){var e=this.getFps();this.updateFpsColor(e),this.fpsLabel.string="FPS: ".concat(e)}},{key:"updateFpsColor",value:function(e){e<30?this.fpsLabel.color=Ms:e<48?this.fpsLabel.color=Ns:this.setColorWithBackground(this.fpsLabel)}},{key:"updateFpsRaw",value:function(){var e=this.getFpsRaw();this.updateFpsRawColor(e),this.fpsRawLabel.string="FPS Raw: ".concat(e)}},{key:"updateFpsRawColor",value:function(e){e<30?this.fpsRawLabel.color=Ms:e<48?this.fpsRawLabel.color=Ns:this.setColorWithBackground(this.fpsRawLabel)}},{key:"updateDrawCalls",value:function(){var e=this.getDrawCalls();this.updateDrawCallsColor(e),this.drawCountLabel.string="Draw Calls: ".concat(e)}},{key:"updateDrawCallsColor",value:function(e){var t=Z.os===Z.OS.IOS,n=t?60:25;e>(t?80:40)?this.drawCountLabel.color=Ms:e>n?this.drawCountLabel.color=Ns:this.setColorWithBackground(this.drawCountLabel)}},{key:"updateRafTime",value:function(){var e=this.getRafTime();this.updateRafTimeColor(e),this.rafTimeLabel.string="RAF Time: ".concat(e,"ms")}},{key:"updateRafTimeColor",value:function(e){e>32?this.rafTimeLabel.color=Ms:e>16?this.rafTimeLabel.color=Ns:this.setColorWithBackground(this.rafTimeLabel)}},{key:"updateDeltaTime",value:function(){var e=this.getDeltaTime();this.updateDeltaTimeColor(e),this.deltaTimeLabel.string="Delta Time: ".concat(e,"ms")}},{key:"updateDeltaTimeColor",value:function(e){e>32?this.deltaTimeLabel.color=Ms:e>16?this.deltaTimeLabel.color=Ns:this.setColorWithBackground(this.deltaTimeLabel)}},{key:"updateLogicTime",value:function(){var e=this.getLogicTime();this.updateLogicTimeColor(e),this.logicTimeLabel.string="Logic Time: ".concat(e,"ms")}},{key:"updateLogicTimeColor",value:function(e){e>10?this.logicTimeLabel.color=Ms:e>5?this.logicTimeLabel.color=Ns:this.setColorWithBackground(this.logicTimeLabel)}},{key:"updatePhysicTime",value:function(){var e=this.getPhysicTime();this.updatePhysicTimeColor(e),this.physicTimeLabel.string="Physic Time: ".concat(e,"ms")}},{key:"updatePhysicTimeColor",value:function(e){e>10?this.physicTimeLabel.color=Ms:e>5?this.physicTimeLabel.color=Ns:this.setColorWithBackground(this.physicTimeLabel)}},{key:"updateRenderTime",value:function(){var e=this.getRenderTime();this.updateRenderTimeColor(e),this.renderTimeLabel.string="Render Time: ".concat(e,"ms")}},{key:"updateRenderTimeColor",value:function(e){e>10?this.renderTimeLabel.color=Ms:e>5?this.renderTimeLabel.color=Ns:this.setColorWithBackground(this.renderTimeLabel)}},{key:"updateObjectMemoryUsage",value:function(){var e=this.getObjectMemoryUsage();this.updateObjectMemoryUsageColor(e),this.objectMemoryUsageLabel.string="Object Mem: ".concat(e,"MB")}},{key:"updateObjectMemoryUsageColor",value:function(e){e>40?this.objectMemoryUsageLabel.color=Ms:e>25?this.objectMemoryUsageLabel.color=Ns:this.setColorWithBackground(this.objectMemoryUsageLabel)}},{key:"updateTextureMemoryUsage",value:function(){var e=this.getTextureMemoryUsage();this.updateTextureMemoryUsageColor(e),this.textureMemoryUsageLabel.string="Texture Mem: ".concat(e,"MB")}},{key:"updateTextureMemoryUsageColor",value:function(e){e>200?this.textureMemoryUsageLabel.color=Ms:e>100?this.textureMemoryUsageLabel.color=Ns:this.setColorWithBackground(this.textureMemoryUsageLabel)}},{key:"updateDPR",value:function(){var e=Os.pixelRatio();this.updateDPRColor(e),this.dprLabel.string="DPR: ".concat(e)}},{key:"updateDPRColor",value:function(e){e>2?this.dprLabel.color=Ms:e<=1?this.dprLabel.color=Ns:this.setColorWithBackground(this.dprLabel)}},{key:"setColorWithBackground",value:function(e){e.color=this.isBackgroundEnabled?Bs:zs}},{key:"getFps",value:function(){if(!E.root)return 0;var e=E.root.fps;return Math.round(e)||0}},{key:"getDrawCalls",value:function(){return E.root&&E.root.device.numDrawCalls||0}},{key:"toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(t))||0}},{key:"getFpsRaw",value:function(){return this.toFixed(1e3/this.rafTimeCounter.value,0)}},{key:"getRafTime",value:function(){return this.toFixed(this.rafTimeCounter.value)}},{key:"getDeltaTime",value:function(){return this.toFixed(1e3*O.deltaTime)}},{key:"getLogicTime",value:function(){return this.toFixed(this.logicTimeCounter.value)}},{key:"getPhysicTime",value:function(){return this.toFixed(this.physicTimeCounter.value)}},{key:"getRenderTime",value:function(){return this.toFixed(this.renderTimeCounter.value)}},{key:"getObjectMemoryUsage",value:function(){if(!E.root)return 0;var e=E.root.device.memoryStatus;return this.toFixed(e.bufferSize/1048576,4)||0}},{key:"getTextureMemoryUsage",value:function(){if(!E.root)return 0;var e=E.root.device.memoryStatus;return this.toFixed(e.textureSize/1048576,4)||0}},{key:"beforeUpdate",value:function(){var e=performance.now();this.logicTimeCounter.start(e)}},{key:"afterUpdate",value:function(){var e=performance.now();this.logicTimeCounter.end(e)}},{key:"beforePhysics",value:function(){var e=performance.now();this.physicTimeCounter.start(e)}},{key:"afterPhysics",value:function(){var e=performance.now();this.physicTimeCounter.end(e)}},{key:"beforeDraw",value:function(){var e=performance.now();this.renderTimeCounter.start(e)}},{key:"afterDraw",value:function(){var e=performance.now();this.renderTimeCounter.end(e)}}]),o}(x)).prototype,"dprLabel",[zo,Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps=r(us.prototype,"fpsLabel",[Uo,Go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hs=r(us.prototype,"fpsRawLabel",[Ho,qo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds=r(us.prototype,"drawCountLabel",[Vo,Wo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ys=r(us.prototype,"rafTimeLabel",[Ko,jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs=r(us.prototype,"deltaTimeLabel",[Yo,Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vs=r(us.prototype,"logicTimeLabel",[Zo,Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ms=r(us.prototype,"physicTimeLabel",[Qo,$o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs=r(us.prototype,"renderTimeLabel",[es,ts],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=r(us.prototype,"objectMemoryUsageLabel",[ns,is],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=r(us.prototype,"textureMemoryUsageLabel",[rs,as],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=r(us.prototype,"bg",[os],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ss=r(us.prototype,"opacity",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls=us))||ls)||ls);w._RF.pop(),w._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var Fs,Us=function(e){return e.CHALLENGE_FRIENDS="challenge-friends",e.REPLAY_FRIENDS="replay-friends",e.SHOW_CHALLENGE_RESULTS="show-challenge-results",e.UPDATE_MUSIC="update-music",e.NEXT_LEVEL="next-level",e.MAX_LEVEL="max-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.GAME_FINISH="game-finish",e.GAME_EXIT="game-exit",e.USE_ITEM="use-item",e.SKIP_LEVEL="skip-level",e.ADD_ITEM="add-item",e.ADD_ITEMS="add-items",e.REFRESH_ITEMS="refresh-items",e.ADD_COINS="add-coins",e.REMOVE_COINS="remove-coins",e.REMOVE_COINS_SUCCESS="remove-coins-success",e.REMOVE_COINS_FAILED="remove-coins-failed",e.COIN_CHANGED="coin-changed",e.ABORT_COIN_ANIMATION="abort-coin-animation",e.ADD_STARS="add-stars",e.PAUSE_TIME="pause-time",e.RESUME_TIME="resume-time",e.TIME_OUT="time-out",e.HALF_TIME="half-time",e.RESCUE_START="rescue-time",e.RESCUE_FINISHED="clock-animation-finished",e.TIME_UPDATED="time-updated",e.APPLY_GRAVITY="apply-gravity",e.GRID_ORIENTATION_CHANGE="grid-orientation-change",e.IDLE_ENTER="idle-enter",e.IDLE_EXIT="idle-exit",e.GRID_MATCH="grid-match",e.GRID_MATCH_SUCCESS="grid-match-success",e.GRID_MATCH_FAIL="grid-match-fail",e.GRID_CLEAR="grid-clear",e.GRID_SPAWN="grid-spawn",e.GRID_CREATE="grid-create",e.GRID_RESIZE="grid-resize",e.TILE_CLICK="tile-click",e.BOMB_EXPLODE="bomb-explode",e.SHOW_HINT="show-hint",e.ADD_COMBO="add-combo",e.COMBO_UPDATED="combo-updated",e.COMBO_ENDED="combo-ended",e.COMBO_PROGRESS="combo-progress",e.ADD_SCORE="add-score",e.SCORE_UPDATED="score-updated",e.SHOW_UI="show-ui",e.HIDE_UI="hide-ui",e.AUTO_PLAY="auto-play",e.GUIDE_MASK_CLICKED="guide-mask-clicked",e.ITEM_MASK_CLICKED="item-mask-clicked",e.EFFECTS_ANIMATION_START="effects-start",e.EFFECTS_ANIMATION_END="effects-end",e}(Us||{});w._RF.pop(),w._RF.push({},"8249dDH5xBEc4nnCGRgSjaW","PanelAnimationController",void 0);var Gs,Hs,qs,Vs,Ws,Ks,js,Ys,Js,Zs,Xs,Qs,$s,el,tl,nl,il,rl,al=(0,S.ccclass)("PanelAnimationController")(Fs=function(r){n(l,r);var s=i(l);function l(){var e;t(this,l);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=s.call.apply(s,[this].concat(i))).animators=new Set,e.eventTarget=new X,e.handleRegistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)&&console.warn("Animator already registered."),e.animators.add(t)},e.handleUnregistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)||console.warn("Animator not registered."),e.animators.delete(t)},e.handleShowUIs=function(){var t=a(o().mark((function t(n){var i,r,a,s,l,u,p,h,d,y,f,v;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!1,s=[],l=c(e.animators);try{for(l.s();!(u=l.n()).done;)p=u.value,s.push(p)}catch(e){l.e(e)}finally{l.f()}for(h=[],d=0,y=s;d<y.length;d++)(f=y[d]).isReadyForAnimation()||a||(a=!0,null==n||null===(v=n.fallback)||void 0===v||v.call(n)),h.push(f.handleShowUI());return t.next=8,Promise.all(h);case 8:null==n||null===(i=n.onComplete)||void 0===i||i.call(n),null===(r=e.eventTarget)||void 0===r||r.emit(Us.SHOW_UI);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleHideUIs=function(){var t=a(o().mark((function t(n){var i,r,a,s,l,u,p,h,d,y,f,v;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!1,s=[],l=c(e.animators);try{for(l.s();!(u=l.n()).done;)p=u.value,s.push(p)}catch(e){l.e(e)}finally{l.f()}for(h=[],d=0,y=s;d<y.length;d++)(f=y[d]).isReadyForAnimation()||a||(a=!0,null==n||null===(v=n.fallback)||void 0===v||v.call(n)),h.push(f.handleHideUI());return t.next=8,Promise.all(h);case 8:null==n||null===(i=n.onComplete)||void 0===i||i.call(n),null===(r=e.eventTarget)||void 0===r||r.emit(Us.HIDE_UI);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return e(l,[{key:"onEnable",value:function(){this.node.scene.on(Us.SHOW_UI,this.handleShowUIs,this),this.node.scene.on(Us.HIDE_UI,this.handleHideUIs,this)}},{key:"onDisable",value:function(){this.node.scene.off(Us.SHOW_UI,this.handleShowUIs,this),this.node.scene.off(Us.HIDE_UI,this.handleHideUIs,this)}},{key:"showUI",value:function(){return this.handleShowUIs()}},{key:"hideUI",value:function(){return this.handleHideUIs()}},{key:"on",value:function(e,t,n,i){this.eventTarget.on(e,t,n,i)}},{key:"off",value:function(e,t,n){this.eventTarget.off(e,t,n)}}],[{key:"getController",value:function(e){for(var t=null,n=e;null!==n;){if(t=n.getComponent(l))return t;n=n.parent}return t}},{key:"registerAnimator",value:function(e){var t=this.getController(e.node);t?t.handleRegistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}},{key:"unregisterAnimator",value:function(e){var t=this.getController(e.node);t?t.handleUnregistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}}]),l}(x))||Fs;w._RF.pop(),w._RF.push({},"f190aWZvVlGiplYX4XrZG3a","PanelAnimator",void 0);var ol,sl=S.ccclass,ll=S.property,ul=Ludex.Utils.Object,cl=(Gs=sl("AnimationConfig"),Hs=ll({type:[R]}),Gs((Ws=r((Vs=function(){function n(){t(this,n),s(this,"startHidden",Ws,this),s(this,"nodes",Ks,this),s(this,"posOffset",js,this),s(this,"showEase",Ys,this),s(this,"hideEase",Js,this),s(this,"showDuration",Zs,this),s(this,"hideDuration",Xs,this)}return e(n,[{key:"setConfig",value:function(e){e&&ul.assign(this,e)}}]),n}()).prototype,"startHidden",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ks=r(Vs.prototype,"nodes",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),js=r(Vs.prototype,"posOffset",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ys=r(Vs.prototype,"showEase",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),Js=r(Vs.prototype,"hideEase",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backIn"}}),Zs=r(Vs.prototype,"showDuration",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xs=r(Vs.prototype,"hideDuration",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),qs=Vs))||qs),pl=(Qs=sl("PanelAnimator"),$s=ll({type:cl,displayName:"Top animation nodes"}),el=ll({type:cl,displayName:"Bottom animation nodes"}),Qs((il=r((nl=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"topConfig",il,l(e)),s(e,"botConfig",rl,l(e)),e.isReady=!1,e}return e(h,[{key:"onEnable",value:function(){al.registerAnimator(this)}},{key:"onDisable",value:function(){al.unregisterAnimator(this)}},{key:"onLoad",value:function(){this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos(),this.isReady=!0}},{key:"initUIPos",value:function(){this.topAnimator.switchState(this.topConfig.startHidden?"hidden":"shown",!0),this.botAnimator.switchState(this.botConfig.startHidden?"hidden":"shown",!0)}},{key:"isReadyForAnimation",value:function(){return this.isReady}},{key:"handleShowUI",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady){e.next=3;break}return console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready")),e.abrupt("return");case 3:return e.abrupt("return",Promise.all([this.topAnimator.switchState("shown"),this.botAnimator.switchState("shown")]));case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleHideUI",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady){e.next=3;break}return console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready")),e.abrupt("return");case 3:return e.abrupt("return",Promise.all([this.topAnimator.switchState("hidden"),this.botAnimator.switchState("hidden")]));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"createAnimator",value:function(e,t){var n=e.nodes,i=e.posOffset,r=e.showEase,s=e.hideEase,l=e.showDuration,u=e.hideDuration,c=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom}:{mode:"position",value:e.node.position.y}})),p=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top+i}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom-i}:{mode:"position",value:e.node.position.y+i}})),d="shown",y=new An;return{switchState:function(){var e=a(o().mark((function e(t){var i,a,f,v,m,g,b,w=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=w.length>1&&void 0!==w[1]&&w[1],y.abort(),a=new An,y=a,d!==t){e.next=6;break}return e.abrupt("return");case 6:if(d=t,f="hidden"===t?c:p,v="hidden"===t?p:c,m="hidden"===t?u:l,g="hidden"===t?s:r,b=function(){for(var e=0,t=n.length;e<t;e++){var i=n[e],r=f[e],a=v[e].value;h.setToTargetImmediately(i,r,a)}},!i){e.next=15;break}return b(),e.abrupt("return");case 15:return a.addAbortListener(b),e.next=18,Promise.all(n.map((function(e,t){var n=f[t],i=v[t].value;return Ue.runTweenAsync(h.getTween({widget:e,config:n,target:i,easing:g,duration:m}),a)})));case 18:a.aborted||a.removeAbortListener(b);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}},{key:"setAnimator",value:function(e){var t=e.topConfig,n=e.botConfig,i=new cl,r=new cl;i.setConfig(t),r.setConfig(n),this.topConfig=i,this.botConfig=r,this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos()}}],[{key:"getTween",value:function(e){var t=e.widget,n=e.config,i=e.target,r=e.easing,a=e.duration;return"top"===n.mode?L(t).call((function(){t.top=n.value})).to(a,{top:i},{easing:r}):"bottom"===n.mode?L(t).call((function(){t.bottom=n.value})).to(a,{bottom:i},{easing:r}):L(t.node.position).call((function(){t.node.setPosition(t.node.position.x,n.value,t.node.position.z)})).to(a,{y:i},{easing:r})}},{key:"setToTargetImmediately",value:function(e,t,n){"top"===t.mode&&(e.top=n),"bottom"===t.mode&&(e.bottom=n);var i=e.node.position.x,r=n,a=e.node.position.z;e.node.setPosition(i,r,a)}}]),h}(x)).prototype,"topConfig",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new cl}}),rl=r(nl.prototype,"botConfig",[el],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new cl}}),tl=nl))||tl);w._RF.pop(),w._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var hl,dl=S.ccclass,yl=S.disallowMultiple,fl=S.executeInEditMode,vl=S.requireComponent,ml=dl("ParticleSystem2DExtra")(ol=fl(!0)(ol=yl(!0)(ol=vl(Q)(ol=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,r=e.particleSystem._simulator.particles[i-1];e.initParticle(r)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,r=0;r<i.length;r++){var a=i[r];e.updateParticle(a,n)}t(n)}},e}return e(o,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(Q),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),o}(x))||ol)||ol)||ol)||ol;w._RF.pop(),w._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);var gl,bl,wl,kl,Sl,Cl,El,xl,Al,Tl,Pl,Rl,Ll,Il;(0,S.ccclass)("ExampleParticleSystem2DExtra")(hl=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"initParticle",value:function(e){e.maxSize=$.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=$.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+$.randomRange(-350,350),e.y=n+$.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),o}(ml));w._RF.pop(),w._RF.push({},"6ea01hdw/9MHb28SCDAiRss","ResizeWithBannerAd",void 0);var Ol,_l,Dl,Ml,Nl,Bl,zl,Fl,Ul,Gl,Hl,ql,Vl=S.ccclass,Wl=S.requireComponent,Kl=S.property,jl=codex,Yl=jl.ads,Jl=jl.event,Zl=Ludex,Xl=Zl.Events,Ql=Zl.Configs.Ads.BannerDisplayAdOptions,$l=Zl.Plugins.Ads,eu=void 0===$l?{}:$l,tu=eu.Types,nu=eu.Status,iu=Zl.Utils,ru=iu.Array,au=iu.Function,ou=iu.Device,su=["top","topleft","topright"],lu=["bottom","bottomleft","bottomright"],uu=["left","topleft","bottomleft"],cu=["right","topright","bottomright"];gl=Vl("ResizeWithBannerAd"),bl=Wl(R),wl=Kl(W),kl=Kl(W),Sl=Kl(W),Cl=Kl(W),El=Kl(W),gl(xl=bl((Tl=r((Al=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"includeSAB",Tl,l(e)),s(e,"includeRightBanner",Pl,l(e)),s(e,"includeBottomBanner",Rl,l(e)),s(e,"includeLeftBanner",Ll,l(e)),s(e,"closeWhenAdFailed",Il,l(e)),e.handleOnAdShowing=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&tu&&(i===tu.BANNER&&Yl.getAd(tu.BANNER,n)&&(e.resizeWhenBannerAdShow(n),e.emitResizeEvent()))},e.handleOnAdClosed=function(t){var n=t.placementId,i=t.type;e.checkValid()&&n&&tu&&(i===tu.BANNER&&Yl.getAd(tu.BANNER,n)&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent()))},e.handleOnAdFailed=function(t){var n=t.placementId,i=t.type;e.closeWhenAdFailed&&e.checkValid()&&n&&tu&&i===tu.BANNER&&(e.resizeWhenBannerAdClose(n),e.emitResizeEvent())},e.handleOnResize=function(){e.checkValid()&&(0!==Ql.length?Ql.forEach((function(t){var n=t.PlacementId;if(tu&&nu){var i=Yl.getAdStatus(tu.BANNER,n);i&&(i===nu.SHOWING||ou.isIOS()?e.resizeWhenBannerAdShow(n):i===nu.IDLE&&e.resizeWhenBannerAdClose(n))}})):e.resizeSafeAreaBottom())},e.resizeWhenBannerAdShow=function(t){var n=void 0,i=void 0,r=void 0,a=void 0,o=He.cssSizeToWorldSize(1),s=Yl.getBannerConfig(t),l=s.PlacementId,u=s.BannerWidth,c=s.Position;if("top"===c)n=Yl.getBannerHeight(l,o);else if("bottom"===c)e.includeBottomBanner?i=Yl.getBannerHeight(l,o,e.includeSAB):e.includeSAB&&(i=Yl.getSafeAreaBottom(o));else if("left"===c||"right"===c){if(void 0===u)return;var p=u;"getBannerOffset"in GameSDK.extra&&(p+=GameSDK.extra.getBannerOffset()),"left"===c&&e.includeLeftBanner?r=p*o:"right"===c&&e.includeRightBanner&&(a=p*o)}e.updateWidgets({top:n,bottom:i,left:r,right:a})},e.resizeWhenBannerAdClose=function(t){var n=Yl.getBannerConfig(t).Position,i=He.cssSizeToWorldSize(1),r=e.includeSAB?Yl.getSafeAreaBottom(i):0;e.updateWidgets({top:ru.has(su,n)?0:void 0,bottom:ru.has(lu,n)?r:void 0,left:ru.has(uu,n)?0:void 0,right:ru.has(cu,n)?0:void 0})},e.resizeSafeAreaBottom=function(){var t=He.cssSizeToWorldSize(1),n=e.includeSAB?Yl.getSafeAreaBottom(t):0;e.updateWidgets({bottom:n})},e.emitResizeEvent=au.debounce((function(){O.emit(Ge.WIDGET_RESIZED)}),100),e}return e(o,[{key:"__preload",value:function(){this.widget=this.getComponent(R),Ii.lazyValidateProperties(this),Jl.on(Xl.AD_SHOWING,this.handleOnAdShowing),Jl.on(Xl.AD_CLOSED,this.handleOnAdClosed),Jl.on(Xl.AD_FAILED,this.handleOnAdFailed),O.on(Ge.VIEW_RESIZED,this.handleOnResize)}},{key:"onDestroy",value:function(){Jl.off(Xl.AD_SHOWING,this.handleOnAdShowing),Jl.off(Xl.AD_CLOSED,this.handleOnAdClosed),Jl.off(Xl.AD_FAILED,this.handleOnAdFailed),O.off(Ge.VIEW_RESIZED,this.handleOnResize)}},{key:"start",value:function(){this.handleOnResize()}},{key:"updateWidgets",value:function(e){var t=e.top,n=e.bottom,i=e.left,r=e.right;this.widget.top=null!=t?t:this.widget.top,this.widget.bottom=null!=n?n:this.widget.bottom,this.widget.left=null!=i?i:this.widget.left,this.widget.right=null!=r?r:this.widget.right,ee.instance.emit("canvas-resize")}},{key:"checkValid",value:function(){return this.node.activeInHierarchy&&null!==this.node.parent&&void 0!==this.node.parent}}]),o}(x)).prototype,"includeSAB",[wl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pl=r(Al.prototype,"includeRightBanner",[kl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Rl=r(Al.prototype,"includeBottomBanner",[Sl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ll=r(Al.prototype,"includeLeftBanner",[Cl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Il=r(Al.prototype,"closeWhenAdFailed",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xl=Al))||xl);w._RF.pop(),w._RF.push({},"3825fBvhGRPUK6d/ohif+v0","PreloadSprite",void 0);var pu=S.ccclass,hu=S.property,du=S.requireComponent,yu=qe.Layout,fu=function(e){return e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape",e}(fu||{}),vu=[yu.Portrait,yu.Landscape];_(fu);var mu,gu,bu,wu,ku,Su,Cu,Eu,xu,Au,Tu;Ol=pu("PreloadSprite"),_l=du(N),Dl=hu({type:fu}),Ml=hu({type:Ke}),Nl=hu({type:W}),Bl=Ii.required,Ol(zl=_l((Ul=r((Fl=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"layout",Ul,l(e)),s(e,"path",Gl,l(e)),s(e,"packable",Hl,l(e)),s(e,"sprite",ql,l(e)),e}return e(p,[{key:"__preload",value:function(){this.sprite=this.getComponent(N),Ii.validateRequiredProperties(this,p),O.on(Ge.ORIENTATION_CHANGED,this.loadSpriteFrame,this),this.loadSpriteFrame()}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}},{key:"loadSpriteFrame",value:(u=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sprite.spriteFrame){e.next=3;break}return this.unlistenEvent(),e.abrupt("return");case 3:if(Ye.getCurrentLayout()===vu[this.layout]){e.next=5;break}return e.abrupt("return");case 5:if(this.path){e.next=7;break}return e.abrupt("return");case 7:if(t="".concat(je[this.path],"/spriteFrame")){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,Fe.loadSpriteFrameAsync(t,this.packable);case 12:if(n=e.sent,this.enabledInHierarchy&&!this.sprite.spriteFrame){e.next=16;break}return this.unlistenEvent(),e.abrupt("return");case 16:this.sprite.spriteFrame=n,this.unlistenEvent();case 18:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"unlistenEvent",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}}]),p}(x)).prototype,"layout",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gl=r(Fl.prototype,"path",[Ml],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Hl=r(Fl.prototype,"packable",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ql=r(Fl.prototype,"sprite",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zl=Fl))||zl);w._RF.pop(),w._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var Pu,Ru,Lu,Iu,Ou,_u,Du,Mu=S.ccclass,Nu=S.property,Bu=S.executeInEditMode,zu=S.requireComponent,Fu=(mu=Mu("TapperedProgressBar"),gu=zu(M),bu=Nu({type:M,displayName:"Fill opacity"}),wu=Nu({type:N,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),ku=Nu({type:N,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),Su=Nu({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),mu(Cu=Bu(Cu=gu((xu=r((Eu=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"uiOpacity",xu,l(e)),s(e,"leftCap",Au,l(e)),s(e,"rightCap",Tu,l(e)),e}return e(o,[{key:"progress",get:function(){return p(h(o.prototype),"progress",this)},set:function(e){f(h(o.prototype),"progress",e,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity)if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var e=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=e}}},{key:"start",value:function(){this.updateAppearance()}}]),o}(te)).prototype,"uiOpacity",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Au=r(Eu.prototype,"leftCap",[wu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tu=r(Eu.prototype,"rightCap",[ku],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r(Eu.prototype,"progress",[Su],Object.getOwnPropertyDescriptor(Eu.prototype,"progress"),Eu.prototype),Cu=Eu))||Cu)||Cu)||Cu);w._RF.pop(),w._RF.push({},"aa60frMJLtIlJZh2yJhMp1s","DynamicLabel",void 0);var Uu,Gu,Hu,qu,Vu,Wu,Ku,ju,Yu,Ju,Zu,Xu,Qu,$u,ec,tc,nc,ic,rc,ac,oc,sc,lc,uc,cc,pc,hc,dc,yc,fc,vc,mc,gc,bc,wc,kc,Sc,Cc,Ec,xc,Ac=S.ccclass,Tc=S.property,Pc=S.executeInEditMode,Rc=S.requireComponent;Pu=Ac("DynamicLabel"),Ru=Rc(Y),Lu=Pc(!0),Iu=Tc({type:P,min:1,max:200}),Ou=Tc({type:P,min:.1,max:4}),Pu(_u=Ru(_u=Lu((r((Du=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i)))._quality=1,e._size=1,e._outlineWidth=0,e._shadowOffset=new ne(0,0),e}return e(o,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.label.fontSize=this.size*this.quality}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.node.scale=new q(1/this.quality,1/this.quality,1),this.label.fontSize=this.size*this.quality,this.label.outlineWidth=this._outlineWidth*this.quality,this.label.shadowOffset=this._shadowOffset.multiplyScalar(this.quality)}},{key:"__preload",value:function(){this.label=this.getComponent(Y)}},{key:"start",value:function(){this._quality=1/this.node.scale.x,this._size=this.label.fontSize/this.quality,this._outlineWidth=this.label.outlineWidth,this._shadowOffset=this.label.shadowOffset,this.quality=window.devicePixelRatio,console.info("🔠 ".concat(this.node.name,"<Label> quality:"),this.quality)}}]),o}(x)).prototype,"size",[Iu],Object.getOwnPropertyDescriptor(Du.prototype,"size"),Du.prototype),r(Du.prototype,"quality",[Ou],Object.getOwnPropertyDescriptor(Du.prototype,"quality"),Du.prototype),_u=Du))||_u)||_u);w._RF.pop(),w._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var Lc=S.ccclass,Ic=S.property,Oc=S.executeInEditMode,_c=S.disallowMultiple,Dc=Ludex,Mc=Dc.Utils,Nc=Mc.Signal,Bc=(Mc.Function,Mc.Array),zc=Dc.Events,Fc=codex,Uc=Fc.language,Gc=Fc.event,Hc=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});_(Hc);var qc,Vc,Wc,Kc,jc,Yc,Jc,Zc,Xc,Qc,$c,ep,tp,np,ip,rp,ap,op,sp,lp="localize-params-updated",up=(Uu=Lc("LocalizeParams"),Gu=Ic({visible:!1}),Hu=Ic(C),Uu((Wu=r((Vu=function(){function n(){t(this,n),s(this,"_text",Wu,this)}return e(n,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,O.emit(lp,{text:e,param:this})}}]),n}()).prototype,"_text",[Gu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),r(Vu.prototype,"text",[Hu],Object.getOwnPropertyDescriptor(Vu.prototype,"text"),Vu.prototype),qu=Vu))||qu),cp=(Ku=Lc("Localize"),ju=Oc(!0),Yu=Ic({visible:!1}),Ju=Ic({type:C,visible:function(){return this.l10nType===Hc.Texture}}),Zu=Ic({visible:!1}),Xu=Ic({type:B(Hc)}),Qu=Ic({type:Y,visible:function(){return this.l10nType===Hc.Text}}),$u=Ic({visible:function(){return this.l10nType===Hc.Text}}),ec=Ic({type:[up],visible:function(){return this.l10nType===Hc.Text}}),tc=Ic({type:N,visible:function(){return this.l10nType===Hc.Texture}}),nc=Ic({visible:function(){return this.l10nType===Hc.Texture}}),ic=Ic({visible:!1}),rc=Ic({type:C}),ac=Ii.onlyRunInLifeCycleAsync,oc=Ii.onlyRunInLifeCycleAsync,sc=Ii.onlyRunInLifeCycleAsync,lc=Ii.onlyRunInLifeCycleAsync,uc=Ii.onlyRunInLifeCycle,cc=Ii.onlyRunInLifeCycleAsync,pc=Ii.onlyRunInLifeCycleAsync,hc=Ii.onlyRunInLifeCycleAsync,dc=Ii.onlyRunInLifeCycleAsync,yc=Ii.onlyRunInLifeCycle,fc=Ii.onlyRunInLifeCycleAsync,Ku(vc=_c(vc=ju((gc=r((mc=function(r){n(S,r);var u,c,p,h,d,y,f,v,m,g,b,w,k=i(S);function S(){var e;t(this,S);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=k.call.apply(k,[this].concat(i))).localized=!1,s(e,"_defaultLocale",gc,l(e)),s(e,"_l10nType",bc,l(e)),s(e,"label",wc,l(e)),s(e,"updateFont",kc,l(e)),s(e,"params",Sc,l(e)),s(e,"sprite",Cc,l(e)),s(e,"packable",Ec,l(e)),s(e,"_key",xc,l(e)),e.updateSignalController=new Nc.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;Bc.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return e(S,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return Bc.has(Je,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(Je.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===Hc.Texture&&(this.label=void 0,this.params=[]),e===Hc.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new up);for(var t=0,n=this.params.length;t<n;t++){var i,r=this.params[t];r.text=null!==(i=e[t])&&void 0!==i?i:r.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once(Ge.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===Hc.Text&&Uc.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===Hc.Texture&&Uc.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){Gc.on(zc.LANGUAGE_CHANGED,this.updateLocalization),O.on(lp,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){Gc.off(zc.LANGUAGE_CHANGED,this.updateLocalization),O.off(lp,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(w=a(o().mark((function e(){var t,n,i,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.length>0&&void 0!==r[0]&&r[0],e.next=4;break;case 4:if(this.enabledInHierarchy){e.next=6;break}return e.abrupt("return");case 6:if(void 0!==this.key){e.next=8;break}return e.abrupt("return");case 8:if(n=this.updateSignalController.renew(),e.prev=9,this.localized=!1,!this.isTextKey(this.key)){e.next=16;break}return e.next=14,this.updateTextLocalization(this.key,n);case 14:e.next=25;break;case 16:if(!this.isTextureKey(this.key)){e.next=24;break}if(i=Uc.getCurrentLocale(),t&&i===this.defaultLocale){e.next=22;break}return e.next=22,this.updateTextureLocalization(this.key,n);case 22:e.next=25;break;case 24:throw new Error("Key ".concat(this.key," not found in locales"));case 25:if(!n.aborted){e.next=27;break}return e.abrupt("return");case 27:this.localized=!0,O.emit(Ge.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit(Ge.LOCALIZE_APPLIED,{localize:this,key:this.key}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(9),console.warn(e.t0);case 35:case"end":return e.stop()}}),e,this,[[9,32]])}))),function(){return w.apply(this,arguments)})},{key:"updateTextLocalization",value:(b=a(o().mark((function e(t,n){var i,r,a,s,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Uc.getCurrentLocale(),a=Uc.getText(t,this.params.map((function(e){return e.text})),r),void 0!==(s=this.label)){e.next=5;break}throw new Error("Text localize component <".concat(this.node.name,"> has no label"));case 5:if(null===(i=n.wrap((function(){return u.setText(s,a)})))||void 0===i||i(),!this.updateFont){e.next=9;break}return e.next=9,null===(l=n.wrap((function(){return u.setTextFont(s,r,n)})))||void 0===l?void 0:l();case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"setText",value:(g=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.string=n;case 1:case"end":return e.stop()}}),e)}))),function(e,t){return g.apply(this,arguments)})},{key:"setTextFont",value:(m=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.setTextFontRuntime(t,n,i);case 3:e.next=7;break;case 5:return e.next=7,this.setTextFontEditor(t,n,i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"setTextFontRuntime",value:(v=a(o().mark((function e(t,n,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.loadFontAsync(n);case 2:if(r=e.sent,!i.aborted){e.next=5;break}return e.abrupt("return");case 5:null!==r&&this.setLabelFontInLifeCycle(t,r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(f=a(o().mark((function e(t,n,i){var r,a,s,l,u,c,p=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestFontUuid(n);case 2:if(null!==(s=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,null===(r=i.wrap((function(){return p.requestNodeInfo(t.node.uuid)})))||void 0===r?void 0:r();case 7:if(void 0!==(l=e.sent)){e.next=10;break}return e.abrupt("return");case 10:return u=Bc.searchIndex(l.__comps__,(function(e){return"cc.Label"===e.type})),c="__comps__.".concat(u,".font"),e.next=14,null===(a=i.wrap((function(){return p.requestUpdateLabelFont(t.node.uuid,c,s)})))||void 0===a?void 0:a();case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"requestFontUuid",value:(y=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Ze[t]));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(d=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:n,dump:{type:"cc.Font",value:{uuid:i}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"updateTextureLocalization",value:(h=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sprite){e.next=2;break}throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));case 2:return i=Uc.getTexture(t),e.next=6,this.setSpriteRuntime(this.sprite,i,n);case 6:e.next=10;break;case 8:return e.next=10,this.setSpriteEditor(this.sprite,i,n);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"setSpriteRuntime",value:(p=a(o().mark((function e(t,n,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.loadSpriteFrameAsync("".concat(n,"/spriteFrame"),this.packable);case 2:if(r=e.sent,!i.aborted){e.next=5;break}return e.abrupt("return");case 5:if(null!==r){e.next=8;break}return console.warn("Sprite not found by path: ".concat(n)),e.abrupt("return");case 8:this.setSprite(t,r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(c=a(o().mark((function e(t,n,i){var r,a,s,l,u,c,p,h,d,y=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestSpriteFrameInfo(n);case 2:if(0!==(s=e.sent).length){e.next=6;break}return console.error("Sprite not found by path: ".concat(n)),e.abrupt("return");case 6:if(!(s.length>1)){e.next=11;break}return l=s.slice(0,5).map((function(e){return e.path})),u="".concat(l.join(",")).concat(l.length<s.length?"...":""),console.warn("Ambiguous sprite's path: ".concat(n,". Found ").concat(u)),e.abrupt("return");case 11:return e.next=13,null===(r=i.wrap((function(){return y.requestNodeInfo(t.node.uuid)})))||void 0===r?void 0:r();case 13:if(void 0!==(c=e.sent)){e.next=16;break}return e.abrupt("return");case 16:return p=s[0].uuid,h=Bc.searchIndex(c.__comps__,(function(e){return"cc.Sprite"===e.type})),d="__comps__.".concat(h,".spriteFrame"),e.next=21,null===(a=i.wrap((function(){return y.requestUpdateSpriteSpriteFrame(t.node.uuid,d,p)})))||void 0===a?void 0:a();case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(u=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Editor.Message.request("scene","set-property",{uuid:t,path:n,dump:{type:"cc.SpriteFrame",value:{uuid:i}}});case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}]),S}(x)).prototype,"_defaultLocale",[Yu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),r(mc.prototype,"defaultLocale",[Ju],Object.getOwnPropertyDescriptor(mc.prototype,"defaultLocale"),mc.prototype),bc=r(mc.prototype,"_l10nType",[Zu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Hc.Text}}),r(mc.prototype,"l10nType",[Xu],Object.getOwnPropertyDescriptor(mc.prototype,"l10nType"),mc.prototype),wc=r(mc.prototype,"label",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kc=r(mc.prototype,"updateFont",[$u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sc=r(mc.prototype,"params",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Cc=r(mc.prototype,"sprite",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=r(mc.prototype,"packable",[nc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),xc=r(mc.prototype,"_key",[ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(mc.prototype,"key",[rc],Object.getOwnPropertyDescriptor(mc.prototype,"key"),mc.prototype),r(mc.prototype,"updateTextLocalization",[ac],Object.getOwnPropertyDescriptor(mc.prototype,"updateTextLocalization"),mc.prototype),r(mc.prototype,"setText",[oc],Object.getOwnPropertyDescriptor(mc.prototype,"setText"),mc.prototype),r(mc.prototype,"setTextFont",[sc],Object.getOwnPropertyDescriptor(mc.prototype,"setTextFont"),mc.prototype),r(mc.prototype,"setTextFontRuntime",[lc],Object.getOwnPropertyDescriptor(mc.prototype,"setTextFontRuntime"),mc.prototype),r(mc.prototype,"setLabelFontInLifeCycle",[uc],Object.getOwnPropertyDescriptor(mc.prototype,"setLabelFontInLifeCycle"),mc.prototype),r(mc.prototype,"setTextFontEditor",[cc],Object.getOwnPropertyDescriptor(mc.prototype,"setTextFontEditor"),mc.prototype),r(mc.prototype,"requestUpdateLabelFont",[pc],Object.getOwnPropertyDescriptor(mc.prototype,"requestUpdateLabelFont"),mc.prototype),r(mc.prototype,"updateTextureLocalization",[hc],Object.getOwnPropertyDescriptor(mc.prototype,"updateTextureLocalization"),mc.prototype),r(mc.prototype,"setSpriteRuntime",[dc],Object.getOwnPropertyDescriptor(mc.prototype,"setSpriteRuntime"),mc.prototype),r(mc.prototype,"setSprite",[yc],Object.getOwnPropertyDescriptor(mc.prototype,"setSprite"),mc.prototype),r(mc.prototype,"setSpriteEditor",[fc],Object.getOwnPropertyDescriptor(mc.prototype,"setSpriteEditor"),mc.prototype),vc=mc))||vc)||vc)||vc);w._RF.pop(),w._RF.push({},"060a722v8VBE68QPm8fKcyQ","LocalizePreloader",void 0);var pp,hp,dp,yp,fp,vp,mp,gp,bp,wp,kp,Sp,Cp,Ep,xp,Ap,Tp=S.ccclass,Pp=S.property,Rp=Ludex.Utils,Lp=Rp.Array,Ip=Rp.Valid,Op=codex.language,_p=(qc=Tp("LocalizeTextureKey"),Vc=Pp({visible:!1}),Wc=Pp(C),qc((Yc=r((jc=function(){function n(){t(this,n),s(this,"_key",Yc,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){Op.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),n}()).prototype,"_key",[Vc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),r(jc.prototype,"key",[Wc],Object.getOwnPropertyDescriptor(jc.prototype,"key"),jc.prototype),Kc=jc))||Kc),Dp=(Jc=Tp("SupportedLocaleKey"),Zc=Pp({visible:!1}),Xc=Pp(C),Jc((ep=r(($c=function(){function n(){t(this,n),s(this,"_key",ep,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){Lp.has(Je,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(Je.join(", ")))}}]),n}()).prototype,"_key",[Zc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),r($c.prototype,"key",[Xc],Object.getOwnPropertyDescriptor($c.prototype,"key"),$c.prototype),Qc=$c))||Qc);tp=Tp("LocalizePreloader"),np=Pp([_p]),ip=Pp({type:Dp,tooltip:"Preload only for these locales"}),tp((op=r((ap=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"keys",op,l(e)),s(e,"locales",sp,l(e)),e}return e(o,[{key:"__preload",value:function(){this.preloadTextures()}},{key:"preloadTextures",value:function(){var e=Op.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(Lp.has(t,e)){var n,i=[],r=c(this.keys);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!1!==Op.hasTextureKey(a.key)){var o=Op.getTexture(a.key),s="".concat(o,"/spriteFrame");i.push(s)}}}catch(e){r.e(e)}finally{r.f()}Fe.loadSpriteFramesAsync(i)}else Ip.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),o}(x)).prototype,"keys",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),sp=r(ap.prototype,"locales",[ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rp=ap));w._RF.pop(),w._RF.push({},"3f364xnTJtDR5yeow2MWHhm","LocalizedLayout",void 0);var Mp,Np,Bp,zp,Fp,Up,Gp,Hp,qp,Vp=S.ccclass,Wp=S.property,Kp=S.executeInEditMode,jp=S.disallowMultiple,Yp=S.requireComponent;pp=Vp("LocalizedLayout"),hp=Kp(!0),dp=Yp(A),yp=Wp(cp),fp=Ii.required(),vp=Wp(A),mp=Wp({visible:!1}),gp=Wp({visible:!1}),bp=Wp({type:P,group:"Padding"}),wp=Wp({type:P,group:"Padding"}),pp(kp=jp(kp=hp(kp=dp((Cp=r((Sp=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"label",Cp,l(e)),s(e,"layout",Ep,l(e)),s(e,"_horizontal",xp,l(e)),s(e,"_vertical",Ap,l(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(A))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,r=e.node.getComponentsInChildren(R),a=c(r);try{for(a.s();!(i=a.n()).done;){i.value.updateAlignment()}}catch(e){a.e(e)}finally{a.f()}}}},e}return e(o,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(A),Ii.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on(Ge.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off(Ge.LOCALIZE_APPLIED,this.updateContentSize)}}]),o}(x)).prototype,"label",[yp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ep=r(Sp.prototype,"layout",[fp,vp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xp=r(Sp.prototype,"_horizontal",[mp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ap=r(Sp.prototype,"_vertical",[gp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r(Sp.prototype,"horizontal",[bp],Object.getOwnPropertyDescriptor(Sp.prototype,"horizontal"),Sp.prototype),r(Sp.prototype,"vertical",[wp],Object.getOwnPropertyDescriptor(Sp.prototype,"vertical"),Sp.prototype),kp=Sp))||kp)||kp)||kp);w._RF.pop(),w._RF.push({},"aef305TaZhKVo1f4/qH1kf+","SecondOrderDynamics",void 0);var Jp,Zp,Xp,Qp,$p,eh,th,nh,ih,rh=S.ccclass,ah=S.property,oh=function(){function n(e,i){t(this,n);var r=null!=i?i:{response:1,dampen:1,eager:1};this.k1=n.calcK1(r),this.k2=n.calcK2(r),this.k3=n.calcK3(r),this.xp=e.clone(),this.y=e.clone(),this.yd=new ne(0,0)}return e(n,[{key:"update",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n;null===i&&(i=new ne((t.x-this.xp.x)/e,(t.y-this.xp.y)/e),this.xp.x=t.x,this.xp.y=t.y);var r=Math.max(this.k2,e*e/2+e*this.k1/2,e*this.k1);return this.y.x=this.y.x+e*this.yd.x,this.y.y=this.y.y+e*this.yd.y,this.yd.x=this.yd.x+e*(t.x+this.k3*i.x-this.y.x-this.k1*this.yd.x)/r,this.yd.y=this.yd.y+e*(t.y+this.k3*i.y-this.y.y-this.k1*this.yd.y)/r,this.y}},{key:"setDynamics",value:function(e){this.k1=n.calcK1(e),this.k2=n.calcK2(e),this.k3=n.calcK3(e)}},{key:"reset",value:function(e){this.xp.set(e.x,e.y),this.y.set(e.x,e.y),this.yd.set(0,0)}},{key:"currentState",get:function(){return this.y}}],[{key:"calcK1",value:function(e){return e.dampen/(Math.PI*e.response)}},{key:"calcK2",value:function(e){return 1/(2*Math.PI*e.response*(2*Math.PI*e.response))}},{key:"calcK3",value:function(e){return e.eager*e.dampen/(2*Math.PI*e.response)}}]),n}(),sh=(Mp=rh("SODConfig"),Np=ah({type:P,displayName:"Responsiveness",tooltip:"Higher values will result shorter response times."}),Bp=ah({type:P,displayName:"Dampening",tooltip:"Higher values will result in less overshoot and oscillation."}),zp=ah({type:P,displayName:"Eagerness",tooltip:"Higher values will result in more overshoot and oscillation, negative values will result in anticipation."}),Mp((Gp=r((Up=e((function e(){t(this,e),s(this,"response",Gp,this),s(this,"dampen",Hp,this),s(this,"eager",qp,this)}))).prototype,"response",[Np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Hp=r(Up.prototype,"dampen",[Bp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),qp=r(Up.prototype,"eager",[zp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fp=Up))||Fp);w._RF.pop(),w._RF.push({},"e9e74FEHyRLvar32WZD/F11","Trail",void 0);var lh,uh,ch,ph,hh,dh,yh,fh,vh,mh,gh,bh,wh,kh,Sh,Ch,Eh,xh,Ah,Th,Ph,Rh,Lh,Ih,Oh,_h,Dh,Mh,Nh=S.ccclass,Bh=S.property,zh=(Jp=Nh("Trail"),Zp=Bh({type:H,displayName:"Target"}),Xp=Bh({type:K,displayName:"Graphics"}),Qp=Bh({type:[sh],displayName:"Trail Nodes"}),Jp((th=r((eh=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"target",th,l(e)),s(e,"graphics",nh,l(e)),s(e,"trailNodes",ih,l(e)),e.trailNodeInstances=[],e}return e(o,[{key:"reset",value:function(){var e,t=c(this.trailNodeInstances);try{for(t.s();!(e=t.n()).done;){e.value.reset(new ne(this.node.worldPosition.x,this.node.worldPosition.y))}}catch(e){t.e(e)}finally{t.f()}this.graphics.clear()}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.spawnTrailNodes()}},{key:"update",value:function(e){this.graphics.clear();var t=this.trailNodeInstances[0];this.drawTrail(e,t,this.target.worldPosition.x,this.target.worldPosition.y);for(var n=1;n<this.trailNodeInstances.length;n++){var i=this.trailNodeInstances[n-1],r=this.trailNodeInstances[n];this.drawTrail(e,r,i.currentState.x,i.currentState.y)}}},{key:"drawTrail",value:function(e,t,n,i){var r=this.graphics;if(this.target.activeInHierarchy){var a=new ne(n,i),o=t.update(e,a),s=new q(a.x,a.y,0),l=new q(o.x,o.y,0);r.node.inverseTransformPoint(s,s),r.node.inverseTransformPoint(l,l),r.moveTo(s.x,s.y),r.lineTo(l.x,l.y),r.stroke()}}},{key:"spawnTrailNodes",value:function(){var e,t=c(this.trailNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=new ne(this.node.worldPosition.x,this.node.worldPosition.y),r=new oh(i,n);this.trailNodeInstances.push(r)}}catch(e){t.e(e)}finally{t.f()}}},{key:"validateRequiredComponents",value:function(){if(!this.target)throw new Error("Target is not set");if(!this.graphics)throw new Error("Graphics is not set");0===this.trailNodes.length&&console.warn("No trail nodes are set")}}]),o}(x)).prototype,"target",[Zp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nh=r(eh.prototype,"graphics",[Xp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ih=r(eh.prototype,"trailNodes",[Qp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$p=eh))||$p);w._RF.pop(),w._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var Fh,Uh,Gh,Hh,qh,Vh,Wh,Kh,jh,Yh,Jh,Zh,Xh,Qh,$h,ed,td,nd,id,rd,ad=S.ccclass,od=S.executionOrder,sd=S.property,ld=Ludex.Utils,ud=ld.Decorator,cd=ld.Array,pd="Batch By Name",hd="Batch Label",dd="Batch Sprite";lh=ad("BatchNodes"),uh=od(99999),ch=sd({group:{name:pd}}),ph=sd({type:[T],group:{name:pd}}),hh=sd({type:[C],group:{name:pd}}),dh=sd({group:{name:hd}}),yh=sd({group:{name:hd}}),fh=sd({group:{name:hd}}),vh=sd({group:{name:dd}}),mh=sd({group:{name:dd}}),gh=sd({readonly:!0}),bh=sd({readonly:!0}),wh=sd({readonly:!0}),kh=ud.debounce(1e3),lh(Sh=uh((Eh=r((Ch=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"batchByName",Eh,l(e)),s(e,"depthNames",xh,l(e)),s(e,"listName",Ah,l(e)),s(e,"batchLabel",Th,l(e)),s(e,"depthLabel",Ph,l(e)),s(e,"typeLabel",Rh,l(e)),s(e,"batchSprite",Lh,l(e)),s(e,"depthSprite",Ih,l(e)),s(e,"batchAllNodes",Oh,l(e)),s(e,"batchDepth",_h,l(e)),s(e,"checkOverlap",Dh,l(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,s(e,"handleNodeChange",Mh,l(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return e(o,[{key:"__preload",value:function(){this.enabled&&(E.on(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.on(J.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){E.off(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.off(J.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(E.on(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.on(J.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(H.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),E.off(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.off(J.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,r=i.depthNames[t];void 0!==r?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(r):console.warn("BatchNodes: depth is undefined",e,t,r)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new H("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=c(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var r=new H(i);r.active=!0,this.batchNode[i]=r,e.addChild(r)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new H("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new H("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(v(this.labelChildren),v(this.spriteChildren)),n=this.nameChildren,i=c(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.node.parent&&(this.handleActiveChange(r.node),this.originalParents[r.uuid]=r.node.parent)}}catch(e){i.e(e)}finally{i.f()}var a,o=c(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.parent&&(this.handleActiveChange(s),this.originalParents[s.uuid]=s.parent)}}catch(e){o.e(e)}finally{o.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=c(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.saveLabelChildren(r),this.saveSpriteChildren(r),this.saveNodeChildrenByName(r),this.saveNodeChildrenByType(r)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(Y),i={none:Y.CacheMode.NONE,char:Y.CacheMode.CHAR,bitmap:Y.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,v(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(N);0!==n.length&&(t=this.spriteChildren).push.apply(t,v(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=c(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;cd.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(x);if((t=this.allChildren).push.apply(t,v(i)),!(this.batchDepth<1||n>=this.batchDepth)){var r,a=c(this.allChildren);try{for(a.s();!(r=a.n()).done;){var o=r.value;this.saveNodeChildrenByType(o.node,this.batchDepth)}}catch(e){a.e(e)}finally{a.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=ie.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=c(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var r,a=c(this.spriteChildren);try{for(a.s();!(r=a.n()).done;){t(r.value,this.batchNode.sprite)}}catch(e){a.e(e)}finally{a.f()}var o,s=c(this.allChildren);try{for(s.s();!(o=s.n()).done;){t(o.value,this.batchNode.node)}}catch(e){s.e(e)}finally{s.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var l,u=c(this.nameChildren);try{for(u.s();!(l=u.n()).done;){var p=l.value;if(p.isValid&&p.activeInHierarchy&&p.isTransformDirty()){var h=p.getComponent(M);if(!(h&&h.opacity<1||cd.has(n,p.name))){var d=this.batchNode[p.name];d&&(p.isChildOf(d)||(p.setParent(d,!0),p.layer=ie.Enum.UI_2D))}}}}catch(e){u.e(e)}finally{u.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(v(this.labelChildren),v(this.spriteChildren));if(e.length>0){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=this.originalParents[i.uuid];r&&(i.node.isChildOf(r)||i.node.setParent(r,!0))}}catch(e){n.e(e)}finally{n.f()}}var a,o=c(this.nameChildren);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=this.originalParents[s.uuid];l&&(s.isChildOf(l)||s.setParent(l,!0))}}catch(e){o.e(e)}finally{o.f()}}}]),o}(x)).prototype,"batchByName",[ch],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xh=r(Ch.prototype,"depthNames",[ph],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ah=r(Ch.prototype,"listName",[hh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Th=r(Ch.prototype,"batchLabel",[dh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ph=r(Ch.prototype,"depthLabel",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Rh=r(Ch.prototype,"typeLabel",[fh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Lh=r(Ch.prototype,"batchSprite",[vh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ih=r(Ch.prototype,"depthSprite",[mh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Oh=r(Ch.prototype,"batchAllNodes",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_h=r(Ch.prototype,"batchDepth",[bh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Dh=r(Ch.prototype,"checkOverlap",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Mh=r(Ch.prototype,"handleNodeChange",[kh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),Sh=Ch))||Sh);w._RF.pop(),w._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var yd,fd=S.ccclass,vd=S.executionOrder,md=S.property,gd=Ludex.Utils,bd=gd.Array,wd=gd.Object;Fh=fd("BatchNodesV2"),Uh=vd(99999),Gh=md({group:"Batch Settings"}),Hh=md({type:[C],group:"Batch Settings",visible:function(){return this.batchByName}}),qh=md({type:[T],group:"Batch Settings",visible:function(){return this.batchByName}}),Vh=md({group:"Label Settings"}),Wh=md({group:"Label Settings",visible:function(){return this.batchLabel}}),Kh=md({group:"Label Settings",visible:function(){return this.batchLabel}}),jh=md({group:"Sprite Settings"}),Yh=md({group:"Sprite Settings",visible:function(){return this.batchSprite}}),Fh(Jh=Uh((Xh=r((Zh=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"batchByName",Xh,l(e)),s(e,"listName",Qh,l(e)),s(e,"depthNames",$h,l(e)),s(e,"batchLabel",ed,l(e)),s(e,"typeLabel",td,l(e)),s(e,"depthLabel",nd,l(e)),s(e,"batchSprite",id,l(e)),s(e,"depthSprite",rd,l(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return e(o,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(Y);t&&("all"===this.typeLabel?t.cacheMode===Y.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===Y.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(N)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:Y.CacheMode.NONE,char:Y.CacheMode.CHAR,bitmap:Y.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,r={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(r)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var a=0;a<this.listName.length;a++){var o=this.listName[a];if(o){var s=this.depthNames[a]||0,l=this.batchNodes[o];l&&l.setSiblingIndex(s)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=ie.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=wd.vals(this.batchNodes);return bd.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],r=0;r<i.length;r++){var a=i[r];a&&t(a)}else for(var o=0;o<this.labelNodes.length;o++){var s=this.labelNodes[o];s&&t(s)}if(this.batchSprite)for(var l=0;l<this.spriteNodes.length;l++){var u=this.spriteNodes[l];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var p=this.namedNodes[c];if(p)for(var h=0;h<p.length;h++){var d=p[h];d&&t(d)}}}},{key:"setupEventListeners",value:function(){E.on(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.on(J.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){E.off(J.EVENT_AFTER_UPDATE,this.onAfterUpdate),E.off(J.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new H("BatchLabel_".concat(n));i.layer=ie.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var r=new H("BatchLabel");r.layer=ie.Enum.UI_2D,this.node.addChild(r),this.batchNodes.label=r}if(this.batchSprite){var a=new H("BatchSprite");a.layer=ie.Enum.UI_2D,this.node.addChild(a),this.batchNodes.sprite=a}if(this.batchByName)for(var o=0;o<this.listName.length;o++){var s=this.listName[o];if(s){var l=new H("Batch_".concat(s));l.layer=ie.Enum.UI_2D,this.node.addChild(l),this.batchNodes[s]=l,this.namedNodes[s]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),o}(x)).prototype,"batchByName",[Gh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qh=r(Zh.prototype,"listName",[Hh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$h=r(Zh.prototype,"depthNames",[qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ed=r(Zh.prototype,"batchLabel",[Vh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),td=r(Zh.prototype,"typeLabel",[Wh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),nd=r(Zh.prototype,"depthLabel",[Kh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),id=r(Zh.prototype,"batchSprite",[jh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rd=r(Zh.prototype,"depthSprite",[Yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Jh=Zh))||Jh);w._RF.pop(),w._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var kd,Sd=S.ccclass,Cd=Ludex.Utils.Browser,Ed=codex.player,xd=Sd("Vibrate")(yd=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!Cd.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!Ed.getPlayerSetting("vibrate")}}]),o}(x))||yd;w._RF.pop(),w._RF.push({},"21fbd1aIo9DNoKfAoZaF1DC","WidgetCanvasTarget",void 0);var Ad;(0,S.ccclass)("WidgetCanvasTarget")(kd=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"__preload",value:function(){var e=this.getComponent(R);if(e){var t=re("Canvas");t&&(e.target=t)}}}]),o}(x));w._RF.pop(),w._RF.push({},"62927KYr+tCcIzOaPtVc/q8","CoinData",void 0);var Td=10,Pd=20,Rd=100,Ld=(m(Ad={},Xe.HINT,80),m(Ad,Xe.THUNDER,200),m(Ad,Xe.STORM,150),m(Ad,Xe.PLIERS,150),Ad),Id=2e3,Od=300;w._RF.pop(),w._RF.push({},"8328a20Ku5GF4anma0sBaxm","DailyRewardsData",void 0);var _d={0:{id:1,type:"coin",value:20},1:{id:2,type:"coin",value:30},2:{id:3,type:"coin",value:50},3:{id:4,type:"coin",value:100},4:{id:5,type:"coin",value:150},5:{id:6,type:"coin",value:200},6:{id:7,type:"coin",value:250,items:{hint:3,thunder:3,storm:3,pliers:0}}};w._RF.pop(),w._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Dd,Md,Nd,Bd,zd=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(zd||{}),Fd={Events:zd,UNLOCK_SEQUENCE:"101013012031"};w._RF.pop(),w._RF.push({},"52b52FNwvhBKY/becAy420o","Leaderboard",void 0);var Ud=Ludex.Configs.Leaderboards.LeaderboardList,Gd={DAILY:null!==(Dd=null===(Md=Ud[0])||void 0===Md?void 0:Md.Id)&&void 0!==Dd?Dd:"daily-leaderboard-id",WEEKLY:null!==(Nd=null===(Bd=Ud[1])||void 0===Bd?void 0:Bd.Id)&&void 0!==Nd?Nd:"weekly-leaderboard-id"},Hd="daily",qd="weekly";w._RF.pop(),w._RF.push({},"f16ffbXQPtDK58g6BNFwzJv","Tournament",void 0);var Vd=function(e){return e.RELOAD_TOURNAMENT="reload-tournament",e}(Vd||{});w._RF.pop(),w._RF.push({},"7e0c9Khhb1DD7wE1NBWi3Py","VibrateStyle",void 0),w._RF.pop(),w._RF.push({},"ad7acMQ2iJNKKA2RkT+nGNI","CommonError",void 0);var Wd=function(r){n(o,r);var a=i(o);function o(e,n){var i;return t(this,o),(i=a.call(this,n)).code=e,i}return e(o)}(y(Error));w._RF.pop(),w._RF.push({},"5ff78u05/tPepABfMzNaOjM","PlayerHasTournamentError",void 0);var Kd=function(r){n(o,r);var a=i(o);function o(e,n){var i;return t(this,o),(i=a.call(this,"PLAYER_HAS_TOURNAMENT","Player has a tournament")).playerId=e,i.tournamentId=n,i}return e(o)}(Wd);w._RF.pop(),w._RF.push({},"e14dbcdc89LQJIggfi5qO6U","MapData",void 0);var jd={mapOrder:[{id:1,theme:"summer",skins:["fruit"],levelCount:10},{id:2,theme:"autumn",skins:["flower"],levelCount:10},{id:3,theme:"winter",skins:["tool"],levelCount:10},{id:4,theme:"summer",skins:["sport"],levelCount:10},{id:5,theme:"autumn",skins:["cosmetics"],levelCount:10},{id:6,theme:"winter",skins:["ice-cream"],levelCount:10},{id:7,theme:"summer",skins:["cakes"],levelCount:10},{id:8,theme:"happy-new-year",skins:["cosmetics","car"],levelCount:10},{id:9,theme:"spring-festival",skins:["flower","ice-cream"],levelCount:10},{id:10,theme:"tree-planting-festival",skins:["fruit","flower","tool"],levelCount:10},{id:11,theme:"blue-sea-festival",skins:["sport","ice-cream"],levelCount:10},{id:12,theme:"music-festival",skins:["cakes","cosmetics"],levelCount:10},{id:13,theme:"harvest-festival",skins:["fruit","flower","tool"],levelCount:10},{id:14,theme:"food-festival",skins:["cakes","ice-cream","flower"],levelCount:10},{id:15,theme:"snow-festival",skins:["ice-cream","sport"],levelCount:10},{id:16,theme:"light-festival",skins:["flower","cakes"],levelCount:10},{id:17,theme:"peace-festival",skins:["flower","sport"],levelCount:10},{id:18,theme:"flower-festival",skins:["flower","fruit"],levelCount:10},{id:19,theme:"street-festival",skins:["car","ice-cream","sport"],levelCount:10},{id:20,theme:"color-garden",skins:["cakes","fruit"],levelCount:10},{id:21,theme:"color-festival",skins:["car","cosmetics","flower"],levelCount:10},{id:22,theme:"nature-summer",skins:["tool","sport"],levelCount:10},{id:23,theme:"snow-mountain",skins:["cakes","ice-cream"],levelCount:10},{id:24,theme:"ice-festival",skins:["ice-cream"],levelCount:10},{id:25,theme:"green-grass-festival",skins:["flower","fruit"],levelCount:10},{id:26,theme:"community-festival",skins:["car","cakes","cosmetics"],levelCount:10},{id:27,theme:"water-festival",skins:["sport","car"],levelCount:10},{id:28,theme:"animal-festival",skins:["flower","fruit"],levelCount:10},{id:29,theme:"lost-festival",skins:["flower"],levelCount:10},{id:30,theme:"halloween-festival",skins:["cakes","cosmetics"],levelCount:10},{id:31,theme:"snow-music-festival",skins:["ice-cream","cosmetics"],levelCount:10},{id:32,theme:"christmas",skins:["ice-cream","tool","cosmetics"],levelCount:10},{id:33,theme:"spring-flower-festival",skins:["flower","fruit"],levelCount:10},{id:34,theme:"tet-holiday",skins:["flower","cosmetics","fruit"],levelCount:10},{id:35,theme:"sea-festival",skins:["car","sport"],levelCount:10},{id:36,theme:"firework-festival",skins:["cosmetics","car","flower"],levelCount:10},{id:37,theme:"halloween-horror",skins:["cakes","cosmetics"],levelCount:10},{id:38,theme:"mid-autumn",skins:["flower","cakes"],levelCount:10},{id:39,theme:"christmas-sweet",skins:["ice-cream","cakes","sport"],levelCount:10},{id:40,theme:"new-year-countdown",skins:["cosmetics","car"],levelCount:10}]};w._RF.pop(),w._RF.push({},"6093adbLQZKpqgUpTV/sHj1","ThemeUtils",void 0);var Yd=Ludex.Utils.Function,Jd=codex,Zd=Jd.player,Xd=Jd.storage,Qd=jd.mapOrder.map((function(e){return{skins:e.skins,themeId:e.theme,currentProgress:0,maxProgress:e.levelCount,isLocked:!0}})),$d=function(){function n(){t(this,n),this.playerSkinProgress=Qd.map((function(e){return u({},e)}))}var i,r;return e(n,[{key:"initDefaultPlayerSkinProgress",value:function(){this.playerSkinProgress=Qd.map((function(e){return u({},e)}))}},{key:"initDashboardSceneStorage",value:function(){var e=Xd.getStorage("dashboard");if(null==e){var t=this.getCurrentMapProgressInstance();Xd.addStorage("dashboard",{lastMapPayload:t,numOfMapsPassed:0,animateToCurrentLevel:!1});var n=Xd.getStorage("collection");if(null==n){Xd.addStorage("collection",{lastMapPack:t.id,animateMapPackUnlock:!1});var i=Xd.getStorage("leaderboard_content");if(null==i){Xd.addStorage("leaderboard_content",{lastTabOpened:Hd,previousScore:-1});var r=Xd.getStorage("tournament");null==r&&Xd.addStorage("tournament",{animateTournamentLeader:!1,previousScore:-1})}}}}},{key:"getCurrentMapProgressInstance",value:function(){for(var e=void 0,t=void 0,n=0,i=0,r=0,a=0,o=jd.mapOrder.length;a<o;a++){var s=this.playerSkinProgress[a],l=jd.mapOrder[a],u=jd.mapOrder[a+1];if(s.currentProgress<s.maxProgress){var c;r=l.id,e=l.theme,t=null!==(c=null==u?void 0:u.theme)&&void 0!==c?c:e,n=s.currentProgress,i=s.maxProgress;break}}if(void 0===e||void 0===t){var p=jd.mapOrder[jd.mapOrder.length-1];return{id:r=p.id,currentTheme:e=p.theme,nextTheme:t=p.theme,progress:n=p.levelCount,max:i=p.levelCount}}return{id:r,currentTheme:e,nextTheme:t,progress:n,max:i}}},{key:"getUnlockedSkinsInstance",value:function(){var e,t=[],n=c(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!i.isLocked&&1===i.skins.length){var r=i.skins[0];r&&t.push(r)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getLevelSkinsInstance",value:function(e){var t,n=null!=e?e:1,i=0,r=c(jd.mapOrder);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(i+a.levelCount>=n)return a.skins;i+=a.levelCount}}catch(e){r.e(e)}finally{r.f()}return jd.mapOrder[jd.mapOrder.length-1].skins}},{key:"getLevelThemeInstance",value:function(e){var t,n=null!=e?e:1,i=0,r=c(jd.mapOrder);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(i+a.levelCount>=n)return a.theme;i+=a.levelCount}}catch(e){r.e(e)}finally{r.f()}return jd.mapOrder[jd.mapOrder.length-1].theme}},{key:"getThemeSkinsInstance",value:function(e){var t,n=c(jd.mapOrder);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.theme===e)return i.skins}}catch(e){n.e(e)}finally{n.f()}return[]}},{key:"getCollectionUnlockProgressInstance",value:function(){var e,t=[],n=c(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push({skins:i.skins,theme:i.themeId,progress:i.currentProgress,max:i.maxProgress,isLocked:i.isLocked})}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"updatePlayerSkinProgress",value:function(){var e,t=Zd.getGameData(),n=(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)-1;this.playerSkinProgress[0].isLocked=!1;for(var i=0,r=jd.mapOrder.length;i<r;i++){var a=jd.mapOrder[i];if(!(n<=0)){var o=n-a.levelCount>=0?a.levelCount:n;n-=o,this.increaseProgress(i,o)}}}},{key:"increaseProgress",value:function(e,t){if(e<0||e>=this.playerSkinProgress.length)throw new Error("increaseProgress: index out of range");var n,i=this.playerSkinProgress[e],r=i.currentProgress,a=i.maxProgress,o=r+t>a?a:r+t;(o>0&&(i.isLocked=!1),o===a)&&((null===(n=jd.mapOrder[e+1])||void 0===n?void 0:n.skins)&&(this.playerSkinProgress[e+1].isLocked=!1));i.currentProgress=o,i.maxProgress=a}}],[{key:"getInstance",value:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"init",value:function(){var e=this.getInstance();e.initDefaultPlayerSkinProgress(),e.updatePlayerSkinProgress(),e.initDashboardSceneStorage()}},{key:"getCurrentMapProgress",value:function(){return this.getInstance().getCurrentMapProgressInstance()}},{key:"getUnlockedSkins",value:function(){return this.getInstance().getUnlockedSkinsInstance()}},{key:"getLevelSkins",value:function(e){return this.getInstance().getLevelSkinsInstance(e)}},{key:"getLevelTheme",value:function(e){return this.getInstance().getLevelThemeInstance(e)}},{key:"getThemeSkins",value:function(e){return this.getInstance().getThemeSkinsInstance(e)}},{key:"getCollectionUnlockProgress",value:function(){return this.getInstance().getCollectionUnlockProgressInstance()}},{key:"getCurrentUnlockingThemeIndex",value:function(){var e=this.getCollectionUnlockProgress();if(0===e.length)return null;var t=0;return e.forEach((function(e,n){e.isLocked||(t=n)})),t}},{key:"preloadLevelSpriteFrames",value:function(e){var t=this.getLevelSkins(e);this.preloadSkinsFrames(t)}},{key:"preloadSkinsFrames",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.preloadSkinFrames(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"preloadSkinFrames",value:function(e){var t="".concat(Qe.TILE_SKIN_FOLDER,"/").concat(e);Fe.loadSpriteFramesDirAsync(t)}},{key:"loadLevelSpriteFrames",value:(r=a(o().mark((function e(t,n,i){var r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Yd.rng({generate:function(e,t,n){return ae(e,t,n)},generateSeed:function(e){return ae(e,0,1e6)},seed:null!=i?i:Date.now()}),void 0===n){e.next=9;break}if(0!==r(0,2)){e.next=9;break}return a=this.getThemeSkins(n),s=a[r(0,a.length)],e.next=8,this.loadSkinFrames(s);case 8:return e.abrupt("return",e.sent);case 9:if(0!==r(0,2)){e.next=17;break}if(!((l=this.getUnlockedSkins()).length>1)){e.next=17;break}return u=l[r(0,l.length)],e.next=16,this.loadSkinFrames(u);case 16:return e.abrupt("return",e.sent);case 17:if(0!==(c=this.getLevelSkins(t)).length){e.next=20;break}throw new Error("No skins found for level ".concat(t));case 20:if(!(c.length>1)){e.next=24;break}return e.next=23,this.loadSkinsFrames(c);case 23:return e.abrupt("return",e.sent);case 24:return p=c[0],e.next=27,this.loadSkinFrames(p);case 27:return e.abrupt("return",e.sent);case 28:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"loadSkinFrames",value:function(e){var t="".concat(Qe.TILE_SKIN_FOLDER,"/").concat(e);return Fe.loadSpriteFramesDirAsync(t)}},{key:"loadSkinsFrames",value:(i=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(this.loadSkinFrames),e.next=3,Yd.allSettled(n);case 3:return i=e.sent,r=i.reduce((function(e,t){return"fulfilled"===t.status&&e.push.apply(e,v(t.value)),e}),[]),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}]),n}();w._RF.pop(),w._RF.push({},"0397cr2IpZEwbRzwQhlVHMO","MatchUtils",void 0);var ey=codex,ty=ey.match,ny=ey.player,iy=ey.leaderboard,ry=Ludex,ay=ry.Utils,oy=ay.Object,sy=ay.Valid,ly=ay.String,uy=ay.Array,cy=ry.Match.Modes,py=["Champion","Ultimate","Grand","Elite","Master's","Premier","Epic","Pro's","Supreme","Legendary","Victory","Prime","Titan's","Hero's","Star's"],hy=function(){function n(){t(this,n)}var i,r,s,l,u,c,p,h,d,y,f,v,m,g,b,w,k,S,C,E,x;return e(n,[{key:"processStartSingleModeAsync",value:(x=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ny.getPlayerId(),e.next=3,ty.single.start.processAsync({playerId:t});case 3:case"end":return e.stop()}}),e)}))),function(){return x.apply(this,arguments)})},{key:"processFinishSingleModeAsync",value:(E=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ty.single.finish.processAsync();case 2:case"end":return e.stop()}}),e)}))),function(){return E.apply(this,arguments)})},{key:"processStartTournamentModeAsync",value:(C=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ny.getPlayerId(),n=GameSDK.context.getID(),e.next=4,ty.tournament.continue.processAsync({playerId:t,contextId:n});case 4:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"processFinishTournamentModeAsync",value:(S=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ny.getPlayerId(),n=ny.getBestScore(),e.next=4,ty.tournament.finish.processAsync({playerId:t,bestScore:n});case 4:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"processStartChallengeModeAsync",value:(k=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.processContinueChallengeAsync();case 3:e.next=15;break;case 5:if(e.prev=5,e.t0=e.catch(0),oy.hasOwn(e.t0,"name")&&!sy.isString(e.t0.name)){e.next=9;break}throw e.t0;case 9:if("PlayerHasFinishedMatch"!==e.t0.name){e.next=12;break}return e.next=12,this.processChallengeNewOpponentAsync();case 12:if("PlayerNotJoinInMatch"!==e.t0.name){e.next=15;break}return e.next=15,this.processJoinChallengeAsync();case 15:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return k.apply(this,arguments)})},{key:"processFinishChallengeModeAsync",value:(w=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ty.challenge.finish.processAsync(t);case 2:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)})},{key:"processContinueChallengeAsync",value:(b=a(o().mark((function e(){var t,n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getMatchState(),n=t.id,i=t.customData,r=i.playerId,a=i.opponentId,sy.isString(n)){e.next=4;break}throw new Error("Invalid match id");case 4:if(sy.isString(r)){e.next=6;break}throw new Error("Invalid player id");case 6:if(sy.isString(a)){e.next=8;break}throw new Error("Invalid opponent id");case 8:if(s=GameSDK.context.getID()){e.next=11;break}throw new Error("Cannot get contextId");case 11:return e.next=13,ty.challenge.continue.processAsync({matchId:n,contextId:s,playerId:r,opponentId:a});case 13:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"processChallengeNewOpponentAsync",value:(g=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ny.getConnectedPlayerIds(100,0),n=Math.floor(Math.random()*t.length),i=ny.getPlayerId(),r=t[n],sy.isString(r)&&!sy.isEmpty(r)){e.next=6;break}throw new Error("Invalid opponent id");case 6:return e.next=8,ty.challenge.friend.processAsync({playerId:i,opponentId:r});case 8:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)})},{key:"processJoinChallengeAsync",value:(m=a(o().mark((function e(){var t,n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getMatchState(),n=t.id,i=t.customData,r=i.playerId,a=i.opponentId,sy.isString(n)){e.next=4;break}throw new Error("Invalid match id");case 4:if(sy.isString(r)){e.next=6;break}throw new Error("Invalid player id");case 6:if(sy.isString(a)){e.next=8;break}throw new Error("Invalid opponent id");case 8:return e.next=10,ty.challenge.join.processAsync({matchId:n,playerId:r,opponentId:a});case 10:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"processStartGameModeAsync",value:(v=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ny.getPlayerId(),ty.strategy.start.processAsync({matchId:"123456",gameMode:t,playerId:n});case 2:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"processFinishGameModeAsync",value:(f=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ty.strategy.finish.processAsync({postGlobalLeaderboard:!0,setPlayerBestScore:!0});case 2:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)})},{key:"getMatchState",value:function(){var e=ty.getMatchState();if(!e)throw new Error("Match state not found");return e}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"startMatchAsync",value:(y=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=null!=t?t:this.getMatchMode(),e.t0=n,e.next=e.t0===cy.SINGLE?5:e.t0===cy.TOURNAMENT?8:e.t0===cy.CHALLENGE_FRIEND?11:14;break;case 5:return e.next=7,this.inst.processStartSingleModeAsync();case 7:return e.abrupt("break",21);case 8:return e.next=10,this.inst.processStartTournamentModeAsync();case 10:return e.abrupt("break",21);case 11:return e.next=13,this.inst.processStartChallengeModeAsync();case 13:return e.abrupt("break",21);case 14:if(!n){e.next=19;break}return e.next=17,this.inst.processStartGameModeAsync(n);case 17:e.next=21;break;case 19:return e.next=21,this.inst.processStartSingleModeAsync();case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),console.warn("startMatchAsync",e.t1);case 26:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(e){return y.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(d=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ty.handler.setProfileData(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setProfileMatchDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return d.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(h=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ty.handler.setMatchCustomData(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setMatchCustomDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return h.apply(this,arguments)})},{key:"getMatchCustomDataAsync",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ty.handler.getMatchCustomData();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("getMatchCustomDataAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return p.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(c=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ty.handler.setLeaderboardScore(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn("setLeaderboardScoreAsync",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return c.apply(this,arguments)})},{key:"finishMatchAsync",value:(u=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=this.getMatchMode(),e.t0=n,e.next=e.t0===cy.SINGLE?5:e.t0===cy.TOURNAMENT?8:e.t0===cy.CHALLENGE_FRIEND?11:14;break;case 5:return e.next=7,this.inst.processFinishSingleModeAsync();case 7:return e.abrupt("break",21);case 8:return e.next=10,this.inst.processFinishTournamentModeAsync();case 10:return e.abrupt("break",21);case 11:return e.next=13,this.inst.processFinishChallengeModeAsync(t);case 13:return e.abrupt("break",21);case 14:if(!n){e.next=19;break}return e.next=17,this.inst.processFinishGameModeAsync();case 17:e.next=21;break;case 19:return e.next=21,this.inst.processFinishSingleModeAsync();case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),console.warn("finishMatchAsync",e.t1);case 26:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(e){return u.apply(this,arguments)})},{key:"joinTournamentAsync",value:(l=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ny.getPlayerId(),e.next=3,ty.tournament.join.processAsync({tournamentId:t,playerId:n});case 3:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"continueTournamentAsync",value:(s=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ny.getPlayerId(),e.next=3,ty.tournament.continue.processAsync({playerId:n,contextId:t});case 3:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"createTournamentName",value:function(){var e=py[$.randomRangeInt(0,py.length-1)],t="".concat(e," Tournament"),n=ly.removeDiacritics(t);return"".concat(n)}},{key:"createTournamentPayload",value:function(){var e,t,n,i=ly.generateObjectId(),r=ny.getPlayerId(),a=ny.getPlayer().name,o=ny.getGameData(),s=null!==(e=null==o?void 0:o.level)&&void 0!==e?e:1,l=$d.getLevelTheme(s),u=this.inst.getMatchState().profiles;return{score:null!==(t=null===(n=(void 0===u?{}:u)[r])||void 0===n?void 0:n.score)&&void 0!==t?t:0,playerId:r,mode:cy.TOURNAMENT,name:this.createTournamentName(),leaderboardId:i,payload:{playerId:r,playerName:a,leaderboardId:i,themeId:l}}}},{key:"getTournamentsAsync",value:(r=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.tournament.getTournamentsAsync();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return r.apply(this,arguments)})},{key:"processCreateTournamentAsync",value:(i=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTournamentsAsync();case 2:if(t=e.sent,!(n=uy.search(t,(function(e){var t=e.getPayload(),n=JSON.parse(sy.isString(t)?t:"{}");return"DEFAULT"===e.getTournamentType()&&n.playerId===ny.getPlayerId()})))){e.next=6;break}throw new Kd(ny.getPlayerId(),n.getID());case 6:return i=this.createTournamentPayload(),ny.setGameData({lastCreateTournamentShown:Date.now()}),e.next=10,ty.tournament.create.processAsync(i);case 10:r=i.leaderboardId,iy.addLeaderboard({name:r,type:"tournament",autoSortRank:!0,leaderboardId:r});case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getMatchMode",value:function(){var e=this.inst.getMatchState();return sy.isString(e.mode)?e.mode:null}},{key:"getMatchCustomData",value:function(){var e=this.inst.getMatchState();return sy.isObject(e.customData)?e.customData:null}},{key:"updateMatchStateAfterLevelFinish",value:function(e,t){this.setMatchCustomDataAsync({level:e,score:t});var n=ny.getPlayerId();this.setProfileMatchDataAsync({id:n,score:t})}}]),n}();w._RF.pop(),w._RF.push({},"d90c4WisP9LybAFqNuS6imZ","FailKeys",void 0);var dy="time",yy="bomb";w._RF.pop(),w._RF.push({},"43ee9veYalAU7wfruC56uJv","GameMode",void 0);var fy,vy="custom";w._RF.pop(),w._RF.push({},"44b50YkamZDD5fO9vdZKeG7","InputController",void 0);var my=(0,S.ccclass)("InputController")(fy=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).handleElementPointerDown=function(){},e.handleElementPointerUp=function(e){},e}return e(o,[{key:"onLoad",value:function(){this.listenInputEvents()}},{key:"listenInputEvents",value:function(){Z.os!==Z.OS.WINDOWS&&Z.os!==Z.OS.OSX||(document.addEventListener("pointerup",this.handleElementPointerUp),document.addEventListener("pointerdown",this.handleElementPointerDown))}},{key:"onDestroy",value:function(){Z.os!==Z.OS.WINDOWS&&Z.os!==Z.OS.OSX||(document.removeEventListener("pointerup",this.handleElementPointerUp),document.removeEventListener("pointerdown",this.handleElementPointerDown))}}]),o}(x))||fy;w._RF.pop(),w._RF.push({},"7f144HjLfBLWbFvbRFCCt8e","Directions",void 0);var gy={Up:{x:0,y:1},Down:{x:0,y:-1},Left:{x:-1,y:0},Right:{x:1,y:0}};w._RF.pop(),w._RF.push({},"361eckT3VBO5ZFyetePNmNY","LevelGravity",void 0);var by="fall-down",wy="fly-up",ky="push-left",Sy="push-right",Cy="put-columns-middle",Ey="put-rows-middle",xy=[by,wy,ky,Sy,Cy,Ey],Ay=[by,wy,Ey],Ty=[ky,Sy,Cy];w._RF.pop(),w._RF.push({},"636f3vmmpVFBLNjr6WR2MSa","CustomModeUtils",void 0);var Py=codex.player,Ry=function(){function n(){t(this,n)}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"getCustomBonus",value:function(){var e=this.getCustomData(),t=e.time,n=e.difficulty,i=e.bombs,r=e.ads;return this.getTimeBonus(t)+this.getDifficultyBonus(n)+this.getBombsBonus(i)+this.getExtraAdsBonus(r)}},{key:"getCustomData",value:function(){var e,t=(null!==(e=Py.getGameData())&&void 0!==e?e:{}).custom;return void 0===t?{time:4,difficulty:1,bombs:0,ads:!1}:t}},{key:"getTimeBonus",value:function(e){return 5*(e-4)}},{key:"getDifficultyBonus",value:function(e){return 3===e?30:20*(e-1)}},{key:"getBombsBonus",value:function(e){return 5*e}},{key:"getExtraAdsBonus",value:function(e){return e?75:0}}]),n}();w._RF.pop(),w._RF.push({},"f0eaf/DUO9MpretbO/JIGbt","CustomGameData",void 0);var Ly={time:[40,30,20,10,0,-10,-20,-30,-40],difficulty:["Easy","Normal","Hard","Extreme"],bombs:[0,1,2,3,4]};w._RF.pop(),w._RF.push({},"c0656MbbYRE+KSk63rv74ZI","SkinKeys",void 0);var Iy={CAKES:"cakes",CAR:"car",COSMETIC:"cosmetics",FLOWER:"flower",FRUIT:"fruit",ICE_CREAM:"ice-cream",SPORT:"sport",TOOL:"tool"};w._RF.pop(),w._RF.push({},"5c321EpuONCAq5BAh+AQCcd","RandomizedLevelDataConfig",void 0);var Oy=5,_y=[90,200],Dy=[6,30],My={bombRange:[1,8],rocketRange:[0,2]},Ny={maxSpaceOfPairRange:[2,10],addRandomTilesPerMoveRange:[0,8]},By=[5,7],zy=[6,12];w._RF.pop(),w._RF.push({},"4e7344vPB1EoI9uMkZu5Zd0","createRandomizedLevelData",void 0);var Fy,Uy,Gy=function(e,t){return function(n){return n<=0?[e,t]:n>=1?[t,t]:[Math.floor(e+n*(t-e)),t]}},Hy=function(e,t){var n=Math.ceil(e),i=Math.floor(t);return Math.floor(Math.random()*(i-n+1))+n},qy=function(e){return function(t){return Hy.apply(void 0,v(e(t)))}},Vy={generateDifficulty:(Fy=Oy,function(e){return Fy<=1?0:(e-1)%Fy/(Fy-1)}),generateTime:qy(function(e,t){var n=Gy(t,e);return function(e){return n(e)}}.apply(void 0,v(_y))),generateColors:qy(Gy.apply(void 0,v(Dy))),specials:{generateBomb:qy(Gy.apply(void 0,v(My.bombRange))),generateRocket:qy(Gy.apply(void 0,v(My.rocketRange)))},rules:{generateMaxSpaceOfPair:qy(Gy.apply(void 0,v(Ny.maxSpaceOfPairRange))),generateAddRandomTilesPerMove:qy(Gy.apply(void 0,v(Ny.addRandomTilesPerMoveRange)))},generateColumns:qy(Gy.apply(void 0,v(By))),generateRows:qy(Gy.apply(void 0,v(zy)))};w._RF.pop(),w._RF.push({},"bbe87JDGgVEkJdgCL2ydwxX","LevelManager",void 0);var Wy=S.ccclass,Ky=Ludex.Utils,jy=Ky.Json,Yy=Ky.Array,Jy=codex.monitorError,Zy=Object.values(Iy),Xy=[[4,6],[4,8],[5,8],[6,8],[5,10],[6,10],[7,10],[7,12]],Qy=[-2,0,2,5],$y={level:1,mode:"normal",time:900,colors:12,specials:{bomb:0,rocket:0},rules:{maxSpaceOfPair:1,addRandomTilesPerMove:0},columns:5,rows:6,theme:["flower"]},ef=function(){var e={};return function(t){if(e[t])return e[t];var n=function(e){var t=Vy.generateDifficulty(e),n=Vy.generateColumns(t),i=Vy.generateRows(t);return{rows:n%2==1&&i%2==1?i+1:i,columns:n,colors:Vy.generateColors(t),gravity:Math.random()>.75?"normal":Math.random()>.5?xy[Math.floor(Math.random()*xy.length)]:[Ay[Math.floor(Math.random()*Ay.length)],Ty[Math.floor(Math.random()*Ty.length)]].join("-"),rules:{addRandomTilesPerMove:Vy.rules.generateAddRandomTilesPerMove(t),maxSpaceOfPair:Vy.rules.generateMaxSpaceOfPair(t)},specials:{bomb:Vy.specials.generateBomb(t),rocket:Vy.specials.generateRocket(t)},time:Vy.generateTime(t)}}(t);return e[t]={level:t,theme:Zy,rows:n.rows,columns:n.columns,colors:n.colors,mode:n.gravity,rules:{maxSpaceOfPair:n.rules.maxSpaceOfPair,addRandomTilesPerMove:n.rules.addRandomTilesPerMove},specials:{bomb:n.specials.bomb,rocket:n.specials.rocket},time:n.time},e[t]}},tf=Wy("LevelManager")(Uy=function(r){n(c,r);var s,l,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=u.call.apply(u,[this].concat(i))).getRandomizedLevelData=ef(),e}return e(c,[{key:"loadLevel",value:(l=a(o().mark((function e(){var t,n,i,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:1,e.next=3,this.loadLevelData(n);case 3:i=e.sent,this.levelData=null!==(t=null!=i?i:this.levelData)&&void 0!==t?t:$y,null==Jy||Jy.addMetadata({level:n});case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadLevelData",value:(s=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h,d,y,f,v,m,b,w,k,S=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.length>0&&void 0!==S[0]?S[0]:1,n=null,!(t>=$e)){e.next=6;break}n=this.getRandomizedLevelData(t),e.next=17;break;case 6:return i=10,r=this.paddingZero("".concat(Math.floor(t/i)+1),3),a=t%i,e.next=11,Fe.loadJsonAsync("".concat(Qe.LEVEL_DATA_FOLDER,"/").concat(r));case 11:if(s=e.sent){e.next=14;break}return e.abrupt("return",null);case 14:if(null!==s.json){e.next=16;break}return e.abrupt("return",null);case 16:n=s.json[a];case 17:if(n=jy.clone(n)){e.next=20;break}return e.abrupt("return",null);case 20:return hy.getMatchMode()===vy&&(p=Ry.getCustomData(),h=n.time*(1+(null!==(l=Ly.time[p.time])&&void 0!==l?l:0)/100),d=n.specials.bomb+(null!==(u=Ly.bombs[p.bombs])&&void 0!==u?u:0),y=Math.min(n.colors+(null!==(c=Qy[p.difficulty])&&void 0!==c?c:0),30),void 0!==(f=this.getDifficulty(n.columns,n.rows))&&(f+=p.difficulty-1,m=null!==(v=this.getCustomColumnAndRow(f))&&void 0!==v?v:[n.columns,n.rows],b=g(m,2),w=b[0],k=b[1],n.rows=k,n.columns=w),n.time=h,n.specials.bomb=d,n.colors=y),e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getLevelData",value:function(){return this.levelData}},{key:"getCustomColumnAndRow",value:function(e){return Xy[$.clamp(e,0,Xy.length-1)]}},{key:"getDifficulty",value:function(e,t){var n=Yy.searchIndex(Xy,(function(n){var i=g(n,2),r=i[0],a=i[1];return r===e&&a===t}));return-1===n?void 0:n}},{key:"paddingZero",value:function(e,t){for(var n="",i=0;i<t-e.length;i++)n+="0";return n+e}}]),c}(x))||Uy;function nf(e,t){for(var n=t.x,i=t.y,r="center"===e?{x:(n-1)/2,y:(i-1)/2}:e,a=r.x,o=r.y,s=[],l=0;l<n;l++){for(var u=[],c=0;c<i;c++){var p=a-l,h=o-c,d=Math.sqrt(p*p+h*h);u.push(d)}s.push(u)}return s}function rf(e){for(var t=e.array,n=e.isLighter,i=e.out,r=void 0===i?new Set:i,a=0;a<t.length;a++)if(n(t.get(a)))for(var o=a+1;o<t.length;o++)if(!n(t.get(o))){t.swap(a,o),r.add(t.get(a));break}return r}w._RF.pop(),w._RF.push({},"bfb989Gr/dArq4M9uSSrF5/","stagger",void 0),w._RF.pop(),w._RF.push({},"cf506DevntPeIl9QrpMEBY0","Grid",void 0);var af,of,sf,lf,uf,cf,pf,hf,df,yf,ff,vf,mf,gf,bf,wf,kf,Sf,Cf,Ef,xf,Af,Tf,Pf,Rf,Lf,If,Of,_f,Df,Mf,Nf,Bf,zf,Ff,Uf,Gf,Hf,qf,Vf,Wf,Kf,jf,Yf,Jf,Zf,Xf,Qf,$f,ev,tv,nv,iv,rv,av,ov,sv,lv,uv,cv,pv,hv,dv,yv,fv,vv,mv,gv,bv,wv,kv,Sv,Cv,Ev,xv=function(){function n(e){var i;t(this,n),this.array=[];var r=null!=e?e:{},a=r.width,o=void 0===a?1:a,s=r.height,l=void 0===s?1:s,u=e instanceof n?e.array:null!==(i=null==e?void 0:e.content)&&void 0!==i?i:[];if(u.length!==o*l)throw new Error("Invalid content length");this.width=o,this.height=l,this.array=v(u)}return e(n,[{key:"asArray",value:function(){return this.array}},{key:"get",value:function(e,t){if(!this.isInBounds(e,t))throw new Error("Out of bounds");return this.array[t*this.width+e]}},{key:"set",value:function(e,t,n){this.array[t*this.width+e]=n}},{key:"isInBounds",value:function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height}},{key:"each",value:function(e){for(var t=0;t<this.height;t++)for(var n=0;n<this.width;n++)e(this.get(n,t),n,t)}},{key:"map",value:function(e){for(var t=[],n=0;n<this.height;n++)for(var i=0;i<this.width;i++)t.push(e(this.get(i,n),i,n));return t}},{key:"reduce",value:function(e,t){for(var n=t,i=0;i<this.height;i++)for(var r=0;r<this.width;r++)n=e(n,this.get(r,i),r,i);return n}},{key:"swap",value:function(e,t){var n=g(e,2),i=n[0],r=n[1],a=g(t,2),o=a[0],s=a[1],l=this.get(i,r);this.set(i,r,this.get(o,s)),this.set(o,s,l)}},{key:"shuffle",value:function(e){for(var t=null!=e?e:this.map((function(e,t,n){return[t,n]})),n=v(t),i=new Set,r=n.length-1;r>0;r--){var a=oe(0,r+1),o=n[r],s=n[a];n[r]=s,n[a]=o,i.add(this.get(o[0],o[1])),i.add(this.get(s[0],s[1]))}for(var l=0;l<n.length;l++){var u=t[l],c=g(u,2),p=c[0],h=c[1],d=n[l],y=g(d,2),f=y[0],m=y[1];this.swap([p,h],[f,m])}return i}},{key:"toShuffled",value:function(e){var t=new n({width:this.width,height:this.height,content:this.array}),i=t.shuffle(e);return[t,i]}},{key:"gravitate",value:function(e){var t=this,n=g(e.rowRange,2),i=n[0],r=n[1],a=g(e.colRange,2),o=a[0],s=a[1],l=e.direction,u=e.isLighter,c=e.onSwap,p=e.out,h=void 0===p?new Set:p,d=s-o+1,y=r-i+1;switch(l){case gy.Up:for(var f=function(e){rf({array:{length:y,get:function(n){return t.get(e,r-n)},swap:function(n,i){var a=t.get(e,r-n),o=t.get(e,r-i);t.swap([e,r-n],[e,r-i]),null==c||c(a,o)}},isLighter:u,out:h})},v=o;v<=s;v++)f(v);return h;case gy.Down:for(var m=function(e){rf({array:{length:y,get:function(n){return t.get(e,i+n)},swap:function(n,r){var a=t.get(e,i+n),o=t.get(e,i+r);t.swap([e,i+n],[e,i+r]),null==c||c(a,o)}},isLighter:u,out:h})},b=o;b<=s;b++)m(b);return h;case gy.Left:for(var w=function(e){rf({array:{length:d,get:function(n){return t.get(o+n,e)},swap:function(n,i){var r=t.get(o+n,e),a=t.get(o+i,e);t.swap([o+n,e],[o+i,e]),null==c||c(r,a)}},isLighter:u,out:h})},k=i;k<=r;k++)w(k);return h;case gy.Right:for(var S=function(e){rf({array:{length:d,get:function(n){return t.get(s-n,e)},swap:function(n,i){var r=t.get(s-n,e),a=t.get(s-i,e);t.swap([s-n,e],[s-i,e]),null==c||c(r,a)}},isLighter:u,out:h})},C=i;C<=r;C++)S(C);return h;default:throw new Error("Invalid direction")}}},{key:"toGravitated",value:function(){var e=new n({width:this.width,height:this.height,content:this.array}),t=e.gravitate.apply(e,arguments);return[e,t]}},{key:"toRotated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new n({width:this.height,height:this.width,content:new Array(this.width*this.height)});if(e)for(var i=0;i<this.height;i++)for(var r=this.width-1;r>=0;r--)t.set(i,this.width-1-r,this.get(r,i));else for(var a=this.height-1;a>=0;a--)for(var o=0;o<this.width;o++)t.set(this.height-1-a,o,this.get(o,a));return t}}]),n}();w._RF.pop(),w._RF.push({},"4046cPYak1BDIVFKksVPsnk","index",void 0),w._RF.pop(),w._RF.push({},"ea140gA27tJa4LD9MT3t93/","Tile",void 0);var Av=S.ccclass,Tv=S.property,Pv=S.requireComponent,Rv=Ludex.Utils,Lv=Rv.Signal,Iv=Rv.Function,Ov=(af=Av("Tile"),of=Pv([A]),sf=Pv([M]),lf=Ii.required,uf=Tv({type:N,group:"Sprite"}),cf=Ii.required,pf=Tv({type:N,group:"Sprite"}),hf=Ii.required,df=Tv({type:N,group:"Sprite"}),yf=Ii.required,ff=Tv({type:N,group:"Sprite"}),vf=Ii.required,mf=Tv({type:N,group:"Sprite"}),gf=Ii.required,bf=Tv({type:A,displayName:"Background UI Transform"}),wf=Ii.required,kf=Tv(se),Sf=Ii.required,Cf=Tv({type:M,group:"Opacity"}),Ef=Ii.required,xf=Tv({type:M,group:"Opacity"}),Af=Ii.required,Tf=Tv({type:M,group:"Opacity"}),Pf=Ii.required,Rf=Tv({type:M,group:"Opacity"}),Lf=Ii.required,If=Tv({type:M,group:"Opacity"}),Of=Ii.required,_f=Tv({type:M,group:"Opacity"}),Df=Ii.required,Mf=Tv({type:M,group:"Opacity"}),Nf=Ii.required,Bf=Tv(bo),zf=Ii.required,Ff=Tv(H),Uf=Ii.required,Gf=Tv({type:le,group:"Animation"}),Hf=Ii.required,qf=Tv({type:ue,group:"Animation"}),Vf=Ii.required,Wf=Tv({type:ue,group:"Animation"}),Kf=Ii.required,jf=Tv({type:ue,group:"Animation"}),Yf=Ii.required,Jf=Tv({type:ue,group:"Animation"}),Zf=Ii.onlyRunInLifeCycle,Xf=Ii.onlyRunInLifeCycle,Qf=Ii.onlyRunInLifeCycle,$f=Ii.onlyRunInLifeCycle,ev=Ii.onlyRunInLifeCycleAsync,tv=Ii.onlyRunInLifeCycleAsync,af(nv=of(nv=sf((rv=r((iv=function(r){n(k,r);var u,c,p,h,d,y,f,v,m,b,w=i(k);function k(){var e;t(this,k);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=w.call.apply(w,[this].concat(i)),s(e,"iconPlaceholder",rv,l(e)),s(e,"icon",av,l(e)),s(e,"bombComponent",ov,l(e)),s(e,"starComponent",sv,l(e)),s(e,"background",lv,l(e)),s(e,"bgUITransform",uv,l(e)),s(e,"defaultBackground",cv,l(e)),s(e,"uiOpacity",pv,l(e)),s(e,"shineOpacity",hv,l(e)),s(e,"glowOpacity",dv,l(e)),s(e,"iconOpacity",yv,l(e)),s(e,"iconPlaceholderOpacity",fv,l(e)),s(e,"bombUiOpacity",vv,l(e)),s(e,"startUiOpacity",mv,l(e)),s(e,"button",gv,l(e)),s(e,"container",bv,l(e)),s(e,"animationComponent",wv,l(e)),s(e,"clearClip",kv,l(e)),s(e,"shakeClip",Sv,l(e)),s(e,"breakClip",Cv,l(e)),s(e,"lightningClearClip",Ev,l(e)),e.id=null,e.frames=[],e.isEmpty=!1,e.coord=new ne,e.mainSignalController=new Lv.SignalController,e.identitySignalController=new Lv.SignalController,e.placeholderSignalController=new Lv.SignalController,e.specialSignalController=new Lv.SignalController,e}return e(k,[{key:"onLoad",value:function(){Ii.validateRequiredProperties(this,k),this.special=this.createSpecialHandler(et.none)}},{key:"update",value:function(e){var t;(null===(t=this.special)||void 0===t?void 0:t.type)===et.bomb&&this.special.update(e)}},{key:"onDestroy",value:function(){var e,t;(null===(e=this.special)||void 0===e?void 0:e.type)!==et.none&&(null===(t=this.special)||void 0===t||t.onDestroy())}},{key:"setIgnoreInput",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.button.interactable=!e}},{key:"getCoord",value:function(){return this.coord}},{key:"setCoord",value:function(e,t){this.coord.set(e,t)}},{key:"isSimilarTo",value:function(e){return this.id===e.id}},{key:"inSamePositionAs",value:function(e,t){return e instanceof k?this.coord.equals(e.getCoord()):this.coord.x===e&&this.coord.y===t}},{key:"isHidden",value:function(){return this.isEmpty}},{key:"getSize",value:function(){return[this.bgUITransform.width,this.bgUITransform.height]}},{key:"onClick",value:function(){this.isHidden()||this.node.scene.emit(Us.TILE_CLICK,this)}},{key:"setIdentity",value:function(e,t){this.id=e,this.frames=t,this.updateIdentityFrame()}},{key:"updateIdentityFrame",value:(b=a(o().mark((function e(){var t,n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.id){e.next=2;break}return e.abrupt("return");case 2:if(n=this.identitySignalController.renew(),Array.isArray(this.frames)){e.next=11;break}return this.setPlaceholderVisible(!0,n),e.next=7,this.frames;case 7:if(i=e.sent,!n.aborted){e.next=10;break}return e.abrupt("return");case 10:this.frames=i;case 11:if(r=this.frames[this.id]){e.next=15;break}return console.error("Failed to load identity frame. ".concat(this.id," is not in the frames array.")),e.abrupt("return");case 15:this.setPlaceholderVisible(!1,n),null===(t=n.wrap((function(){return a.setIdentityFrame(r)})))||void 0===t||t();case 17:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"setPlaceholderVisible",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this.placeholderSignalController.renew();if(t&&n.chain(t),e)return Ue.runTweenAsync(L(this.iconPlaceholder.node).to(.15,{scale:q.ONE},{easing:"backOut"}),n),void Ue.runTweenAsync(L(this.iconPlaceholderOpacity).delay(ce(0,.75)).to(.15,{opacity:255}).repeatForever(L(this.iconPlaceholderOpacity).to(.25,{opacity:80}).delay(.25).to(.25,{opacity:255}).delay(.75)),n);Ue.runTweenAsync(L(this.iconPlaceholder.node).to(.15,{scale:q.ZERO},{easing:"backIn"}),n),Ue.runTweenAsync(L(this.iconPlaceholderOpacity).to(.15,{opacity:0}),n)}},{key:"setIdentityFrame",value:function(e,t){var n=this;this.icon.spriteFrame=e;var i=this.getSize(),r=g(i,2),a=r[0],o=r[1],s=e.originalSize,l=s.width,u=s.height,c=Math.max(l/(.7*a),u/(.7*o));this.icon.node.setScale(0,0,0);var p=function(){n.icon.node.setScale(1/c,1/c,1)};null==t||t.once(p),Ue.runTweenAsync(L(this.icon.node).delay(ce(0,.2)).to(.15,{scale:new q(1/c,1/c,1)},{easing:"sineOut"}),t),null==t||t.off(p)}},{key:"setSpecialType",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et.none,r=arguments.length>1?arguments[1]:void 0;if(null===(e=this.special)||void 0===e||e.switch(i,r),(null===(t=this.special)||void 0===t?void 0:t.type)===et.bomb||(null===(n=this.special)||void 0===n?void 0:n.type)===et.star){var a=this.special;if(!Array.isArray(this.frames)){var o=this.specialSignalController.renew();a.hide(o,!0),this.frames.then((function(){a.isDestroyed||a.show(o)}))}}}},{key:"setFocused",value:(m=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=L(this.shineOpacity).to(.15,{opacity:t?255:0},{easing:"cubicOut"}),this.shineOpacity.node.scale=t?q.ZERO:q.ONE,i=L(this.shineOpacity.node).to(.15,{scale:t?q.ONE:q.ZERO},{easing:"cubicOut"}),t?((r=L(this.glowOpacity).to(2,{opacity:150})).to(2,{opacity:20}),this.glowOpacityTween=L(this.glowOpacity).repeatForever(r).start()):(this.glowOpacityTween&&this.glowOpacityTween.stop(),this.glowOpacity.opacity=0),e.next=6,Promise.all([Ue.runTweenAsync(n),Ue.runTweenAsync(i)]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"setEmpty",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isEmpty||(this.mainSignalController.abort(),this.isEmpty=!0,this.setIgnoreInput(!0),this.button.resetButtonState(),i||(null===(e=this.special)||void 0===e?void 0:e.type)!==et.star&&(null===(t=this.special)||void 0===t?void 0:t.type)!==et.bomb||this.special.clear(),this.setOpacity(0),null===(n=this.special)||void 0===n||n.switch(et.none))}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"setHint",value:(v=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.mainSignalController.renew(),!t){e.next=5;break}return e.next=4,this.runAnimation(this.shakeClip.name,i);case 4:return e.abrupt("return");case 5:if(null===(n=this.animationComponent)||void 0===n||n.stop(),this.container){e.next=8;break}return e.abrupt("return");case 8:return r=L(this.container).to(.1,{scale:q.ONE,eulerAngles:q.ZERO}),e.next=11,Ue.runTweenAsync(r,i);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"playClearFX",value:(f=a(o().mark((function e(t){var n,i,r,a,s=this,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],i=this.mainSignalController.renew(),this.setOpacity(255),r=function(){return s.setOpacity(0)},a=n?this.lightningClearClip:this.clearClip,i.once(r),e.next=8,this.runAnimationAfterDelay(a.name,t,i);case 8:i.off(r),i.aborted||r();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"playOldLightningClearFX",value:(y=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.mainSignalController.renew(),this.setOpacity(255),n=function(){return i.setOpacity(0)},t.once(n),e.next=6,this.runAnimation(this.breakClip.name,t);case 6:t.off(n),t.aborted||n();case 8:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"runAnimationAfterDelay",value:(d=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,Ue.waitTweenAsync(n,i);case 3:return e.next=5,this.runAnimation(t,i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"runAnimation",value:function(e,t){return Ue.runAnimationAsync(this.animationComponent,e,t)}},{key:"restore",value:(h=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.mainSignalController.renew(),this.animationComponent.stop(),this.isEmpty=!1,this.setIgnoreInput(!0),void 0!==t&&n&&this.setIdentity(t,n),this.setOpacity(255),this.iconOpacity.opacity=255,this.node.setScale(q.ZERO),this.background.spriteFrame=this.defaultBackground,this.button.fakeClick(),e.next=12,Ue.runTweenAsync(L(this.node).to(.3,{scale:q.ONE},{easing:"backOut"}),i);case 12:this.node.setScale(q.ONE),this.setIgnoreInput(!1);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"sync",value:(p=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.duration,i=void 0===n?.3:n,r=t.delay,a=void 0===r?0:r,s=t.easing,l=void 0===s?"cubicOut":s,u=t.getTargetPosition,c=u(this.coord),p=new q(c.x,c.y,this.node.position.z),e.next=5,Ue.runTweenAsync(L(this.node).delay(a).to(i,{position:p},{easing:l}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"fly",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h,d,y,f,v,m,g,b,w=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=300,i=Math.sqrt(Math.pow(this.node.position.x,2)+Math.pow(this.node.position.y,2)),r=Math.max(n-.7*i,0),a=i/1e3,s=this.node.position.clone(),l=t.getTilePosition(this.coord),u=new q(l.x,l.y,this.node.position.z),c=this.container,p=2,h=1,d=360,y=.0025*r,f=0,v=new q(0,0,0),m=.75-y,(b=L(g={value:0,prevElapsed:0})).delay(a),b.to(.5,{value:0},{progress:function(e,t,n,i){var r=(p*=-1)*i,a=s.clone();return a.x+=r,w.node.setPosition(a),n}}),b.to(y,{value:1},{progress:function(e,t,i,a){var o=Ue.easeOutExpo(a),s=y*a-g.prevElapsed,l=y*a,u=r*o;w.setHeight(u,n);var p=w.node.position.clone();h+=.1,q.rotateZ(p,p,new q(0,0,0),h*Math.PI*s),w.node.setPosition(new q(p.x,p.y,p.z));var f=(d+=10)*s;return c.angle+=f,g.prevElapsed=l,i}}),b.call((function(){v.set((w.node.position.x+u.x)/2,(w.node.position.y+u.y)/2,0),g.prevElapsed=0,c.angle%=360,c.angle-=360,f=c.angle})),b.to(m,{value:0},{progress:function(e,t,i,a){var o=m*a-g.prevElapsed,s=m*a,l=r*(1-a);w.setHeight(l,n);var u=w.node.position.clone();return q.rotateZ(u,u,v,Math.PI/m*o),w.node.setPosition(new q(u.x,u.y,u.z)),c.angle+=-f/m*o,g.prevElapsed=s,i}}),b.call((function(){w.node.setPosition(u),w.setHeight(0,n),c.angle=0})),e.abrupt("return",Ue.runTweenAsync(b));case 25:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"moveAround",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],n=this.container.position.clone(),i=-1,r=0;case 4:if(!(r<5)){e.next=18;break}for(a=$.randomRangeInt(0,4);i===a;)a=$.randomRangeInt(0,4);if(i=a,s=t[a]){e.next=11;break}return e.abrupt("continue",15);case 11:return l=n.clone().add(new q(5*s.x,5*s.y)),u=L(this.container).to(.1,{position:l},{easing:"smooth"}),e.next=15,Ue.runTweenAsync(u);case 15:r++,e.next=4;break;case 18:return c=L(this.container).to(.1,{position:n},{easing:"smooth"}),e.next=21,Ue.runTweenAsync(c);case 21:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setHeight",value:function(e,t){if(this.container){var n=this.container;n.setPosition(new q(n.position.x,e,0)),n.setScale(new q(1+e/t*.3,1+e/t*.3,1))}}},{key:"createSpecialHandler",value:function(e,t){var n=this;switch(e){case et.bomb:return this.createBombHandler(null!=t?t:90);case et.star:return this.createStarHandler();default:return{type:et.none,switch:function(e,t){n.special=n.createSpecialHandler(e,t)}}}}},{key:"createBombHandler",value:function(e){var t=this,n=!1,i=!1,r=e,a=function(){i=!0},o=function(){i=!1};this.node.scene.on(Us.TILE_CLICK,a),this.node.scene.on(Us.USE_ITEM,a),this.node.scene.on(Us.RESUME_TIME,a),this.node.scene.on(Us.PAUSE_TIME,o),this.node.scene.on(Us.TIME_OUT,o),this.bombComponent.node.active=!0;var s=function(){n=!0,i=!1,t.bombComponent.node.active=!1,r=e,t.node.scene.off(Us.TILE_CLICK,a),t.node.scene.off(Us.USE_ITEM,a),t.node.scene.off(Us.GAME_RESUME,a),t.node.scene.off(Us.GAME_PAUSE,o),t.node.scene.off(Us.TIME_OUT,o)};return{type:et.bomb,get isDestroyed(){return n},update:function(n){i&&(r-=n,t.bombComponent.fillRange=-r/e,r<=0&&(i=!1,t.bombComponent.node.active=!1,t.setEmpty(!0),t.node.scene.emit(Us.BOMB_EXPLODE,t)))},clear:function(){Ve.playSound(Ji.BOMB_DEFUSE)},cleanup:s,onDestroy:function(){n=!0,t.node.scene.off(Us.TILE_CLICK,a),t.node.scene.off(Us.USE_ITEM,a),t.node.scene.off(Us.GAME_RESUME,a),t.node.scene.off(Us.GAME_PAUSE,o),t.node.scene.off(Us.TIME_OUT,o)},switch:function(e,n){s(),t.special=t.createSpecialHandler(e,n)},show:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=255})),Iv.allSettled([Ue.runTweenAsync(L(t.bombUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=255},hide:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=0})),Iv.allSettled([Ue.runTweenAsync(L(t.bombUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=0},detonateImmediately:function(){r=0}}}},{key:"createStarHandler",value:function(){var e=this,t=!1;this.starComponent.node.active=!0;var n=function(){t=!0,e.starComponent.node.active=!1};return{type:et.star,get isDestroyed(){return t},clear:function(){e.starComponent.node.active=!1,Ve.playSound(Ji.COLLECT_STARS);var t=e.node.worldPosition,n=t.x,i=t.y;e.node.scene.emit(Us.ADD_STARS,{startAnimationAt:[n,i]})},cleanup:n,onDestroy:function(){t=!0},show:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=255})),Iv.allSettled([Ue.runTweenAsync(L(e.startUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=255},hide:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=0})),Iv.allSettled([Ue.runTweenAsync(L(e.startUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=0},switch:function(t){n(),e.special=e.createSpecialHandler(t)}}}}]),k}(x)).prototype,"iconPlaceholder",[lf,uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),av=r(iv.prototype,"icon",[cf,pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ov=r(iv.prototype,"bombComponent",[hf,df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sv=r(iv.prototype,"starComponent",[yf,ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lv=r(iv.prototype,"background",[vf,mf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uv=r(iv.prototype,"bgUITransform",[gf,bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cv=r(iv.prototype,"defaultBackground",[wf,kf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pv=r(iv.prototype,"uiOpacity",[Sf,Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hv=r(iv.prototype,"shineOpacity",[Ef,xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dv=r(iv.prototype,"glowOpacity",[Af,Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yv=r(iv.prototype,"iconOpacity",[Pf,Rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fv=r(iv.prototype,"iconPlaceholderOpacity",[Lf,If],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vv=r(iv.prototype,"bombUiOpacity",[Of,_f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=r(iv.prototype,"startUiOpacity",[Df,Mf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gv=r(iv.prototype,"button",[Nf,Bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bv=r(iv.prototype,"container",[zf,Ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wv=r(iv.prototype,"animationComponent",[Uf,Gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kv=r(iv.prototype,"clearClip",[Hf,qf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sv=r(iv.prototype,"shakeClip",[Vf,Wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cv=r(iv.prototype,"breakClip",[Kf,jf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ev=r(iv.prototype,"lightningClearClip",[Yf,Jf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(iv.prototype,"setIgnoreInput",[Zf],Object.getOwnPropertyDescriptor(iv.prototype,"setIgnoreInput"),iv.prototype),r(iv.prototype,"setPlaceholderVisible",[Xf],Object.getOwnPropertyDescriptor(iv.prototype,"setPlaceholderVisible"),iv.prototype),r(iv.prototype,"setIdentityFrame",[Qf],Object.getOwnPropertyDescriptor(iv.prototype,"setIdentityFrame"),iv.prototype),r(iv.prototype,"setOpacity",[$f],Object.getOwnPropertyDescriptor(iv.prototype,"setOpacity"),iv.prototype),r(iv.prototype,"runAnimationAfterDelay",[ev],Object.getOwnPropertyDescriptor(iv.prototype,"runAnimationAfterDelay"),iv.prototype),r(iv.prototype,"runAnimation",[tv],Object.getOwnPropertyDescriptor(iv.prototype,"runAnimation"),iv.prototype),nv=iv))||nv)||nv)||nv);w._RF.pop(),w._RF.push({},"d6995j9hvVJYKs6vvV+rs1I","index",void 0),w._RF.pop(),w._RF.push({},"d65b2oe6HRJU7zJnHC2Jubi","BoardScale",void 0);function _v(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=n.x,a=n.y,o=g(t,2),s=o[0],l=o[1],u=s*(r-(e.width-1)/2)+i*(r-e.width/2),c=l*(a-(e.height-1)/2)+i*(a-e.height/2);return-1===r&&(u+=t[0]/4),r===e.width&&(u-=t[0]/4),-1===a&&(c+=t[1]/4),a===e.height&&(c-=t[1]/4),{x:u,y:c}}function Dv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=g(e,2),i=n[0],r=n[1],a=g(t,2),o=a[0],s=a[1],l=1-o,u=1-s,c=i*l,p=r*u;return[c,p]}function Mv(e){for(var t=e.split("-"),n=[],i=0;i<t.length;){var r=null;switch(t[i]){case"normal":i+=1;break;case"fall":r=by,i+=2;break;case"fly":r=wy,i+=2;break;case"push":"left"===t[i+1]?(r=ky,i+=2):(r=Sy,i+=2);break;case"put":"columns"===t[i+1]?(r=Cy,i+=3):(r=Ey,i+=3)}r&&n.push(r)}return n}function Nv(e){switch(e){case by:return Sy;case wy:return ky;case ky:return by;case Sy:return wy;case Cy:return Ey;case Ey:return Cy}}function Bv(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.x,a=e.y,o=i?a:n-1-a,s=i?t-1-r:r;return{x:o,y:s}}function zv(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=[],o=c(n);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=s.a,u=s.b,p=Bv(l,e,t,r),h=Bv(u,e,t,r);a.push({a:p,b:h})}}catch(e){o.e(e)}finally{o.f()}return a}function Fv(e){return(e instanceof xv?e.asArray():e).filter((function(e){return!e.isHidden()}))}function Uv(e){return(e instanceof xv?e.asArray():e).filter((function(e){return e.isHidden()}))}w._RF.pop(),w._RF.push({},"cb8ddC2w59DpqVoQENbYYcU","calcBoardScale",void 0),w._RF.pop(),w._RF.push({},"305c7LJx+ROLI4g8tTiAFyb","calcTilePosition",void 0),w._RF.pop(),w._RF.push({},"c522ca1UPhDYaToWf66t1X2","calcTileSize",void 0),w._RF.pop(),w._RF.push({},"37667B66RZBc5chlMqN6mH8","parseLevelGravity",void 0),w._RF.pop(),w._RF.push({},"60475oElENLe7C3g+jd0ZEl","rotateGravity",void 0),w._RF.pop(),w._RF.push({},"a1c1a/tPEpHy4ITkE80K0lL","rotatePath",void 0),w._RF.pop(),w._RF.push({},"f0f0bXgdxJHIJWOmA6n0Ood","getUncleared",void 0),w._RF.pop(),w._RF.push({},"a90bcq22hlMzbYdivjPpm0h","getBombTiles",void 0),w._RF.pop(),w._RF.push({},"92e23drVfRIgbDVZLTSdEkI","getCleared",void 0),w._RF.pop(),w._RF.push({},"7105bfR+Y5F1a0SDiMXZ9mV","getNearbyTiles",void 0);var Gv=Ludex.Utils.Object;function Hv(e){return Array.isArray(e)}function qv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=Hv(e)?e:e.asArray();return n[ae(t,0,n.length)]}w._RF.pop(),w._RF.push({},"d1b9bBg+dBA+7n/Sz+RCIAX","getRandomTile",void 0),w._RF.pop(),w._RF.push({},"c4bf3uyS1pEdrTrwDEXeuZP","getRandomPair",void 0);var Vv=Ludex.Utils.Array;function Wv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=e instanceof xv?e.asArray():e,i=qv(n,t),r=Vv.search(n,(function(e){return e.isSimilarTo(i)&&!e.inSamePositionAs(i)}));if(void 0===r)throw new Error("Could not find a matching tile");return[i,r]}w._RF.pop(),w._RF.push({},"cf8d6gfx2ZIsqm978cNLWaV","pseudoRandomIterable",void 0);var Kv=function(e){return e};function jv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kv;return o().mark((function i(){var r,a,s;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=t,(r=e)<=0&&(r=Number.POSITIVE_INFINITY),s=0;case 4:if(!(s<r)){i.next=11;break}return i.next=7,n(a);case 7:a=1e9*pe(a);case 8:s++,i.next=4;break;case 11:case"end":return i.stop()}}),i)}))()}function Yv(e){return Array.isArray(e)}function Jv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=Yv(e)?e:e.asArray();if(i.length<t)return new Set(i);for(var r=new Set,a=jv(-1,n),o=a.next();r.size<t;){if(o.done)throw new Error("RNG exhausted");r.add(qv(i,o.value)),o=a.next()}return r}w._RF.pop(),w._RF.push({},"718b6Wu0pdGVK5KYSUDctVX","getRandomTiles",void 0),w._RF.pop(),w._RF.push({},"17ccarKybRNwYcZnBQhCUYy","index",void 0),w._RF.pop(),w._RF.push({},"bab6dqrPz9AaaBN5cy+QzPj","assignSpecialTiles",void 0);var Zv=[1,2];function Xv(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),r=t.specials,a=r.bomb,o=ae.apply(void 0,[i].concat(Zv)),s=Jv(e,a,i),l=e.asArray().filter((function(e){return!s.has(e)})),u=Jv(l,o,i),p=c(s);try{for(p.s();!(n=p.n()).done;){var h=n.value,d=2*t.time/3;h.setSpecialType(et.bomb,d)}}catch(e){p.e(e)}finally{p.f()}var y,f=c(u);try{for(f.s();!(y=f.n()).done;){var v=y.value;v.setSpecialType(et.star)}}catch(e){f.e(e)}finally{f.f()}}w._RF.pop(),w._RF.push({},"228efPdzUNCMp4yYcBs9r+3","index",void 0),w._RF.pop(),w._RF.push({},"09be7lmGLNMvIObiqskePhz","createGrid",void 0);var Qv=Ludex.Utils.Array;function $v(e){var t=e.levelData,n=t.columns,i=t.rows,r=e.identities,a=e.setTileIdentity,o=e.createTile,s=e.seed,l=function(e,t,n){var i,r=[],a=c(jv(t/2,e,(function(e){return ae(e,0,n.length)})));try{for(a.s();!(i=a.n()).done;){var o=i.value;r.push(n[o]),r.push(n[o])}}catch(e){a.e(e)}finally{a.f()}return Qv.shuffle(r),r}(void 0===s?Date.now():s,n*i,r),u=em(e.levelData,r,l).reverse(),p=em(e.levelData,r,u).reverse().map((function(e){var t=o(e);return a(t,e),t}));return new xv({width:n,height:i,content:p})}function em(e,t,n){var i=e.rows,r=e.columns,a=e.rules;if(!a.maxSpaceOfPair)return n;var o,s=function(e,t,n){for(var i=[],r=0;r<t;r++){i[r]=[];for(var a=0;a<n;a++)i[r][a]=e[r*n+a]}return i}(n,i,r),l=c(t);try{for(l.s();!(o=l.n()).done;)for(var u=o.value,p=null,h=null,d=0;d<i;d++)for(var y=0;y<r;y++){if(s[d][y]===u)if(p&&h){var f=a.maxSpaceOfPair+1;if(Math.abs(d-p)+Math.abs(y-h)<=f)h=y,p=d;else{var v=tm(p,h,d,y),m=s[v.row][v.column];s[v.row][v.column]=s[d][y],s[d][y]=m}}else p=d,h=y}}catch(e){l.e(e)}finally{l.f()}return function(e){var t,n=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,o=c(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;n.push(s)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}return n}(s)}function tm(e,t,n,i){var r=e,a=t;return n>e&&(r=e+1),n<e&&(r=e-1),i>t&&(a=t+1),i<t&&(a=t-1),{row:r,column:a}}w._RF.pop(),w._RF.push({},"5d998xlab9FLIpvw+sXMIYw","createGridFromFen",void 0);var nm=Ludex.Utils.Array;function im(e){var t=e.customFen,n=e.identities,i=e.createTile,r=t.idSize,a=t.cols,o=t.rows,s=t.code;if(n.length<t.idSize)throw new Error("Invalid grid code. There are not enough identities/frames ".concat(n.length," to fill it according to fen code ").concat(r));var l=s.split(":");if(l.length!==o)throw new Error("Invalid grid code");var u=/[a-zA-Z]+\d+|./g,p=/[a-zA-Z]+/,h=/\d+/,d=l.reduceRight((function(e,r){var a,o=[],s=r.matchAll(u),l=c(s);try{for(l.s();!(a=l.n()).done;){var d,y,f=a.value[0],v=null===(d=h.exec(f))||void 0===d?void 0:d[0],m=void 0!==v?parseInt(v,10):void 0,g=void 0!==m&&!isNaN(m)&&m<n.length?n[m]:void 0,b=i(void 0!==g?g:n[0]),w=null===(y=p.exec(f))||void 0===y?void 0:y[0],k=void 0!==w?rm(w,t.encoding):void 0;void 0!==k&&void 0!==g?b.setSpecialType(k):b.setEmpty(),o.push(b)}}catch(e){l.e(e)}finally{l.f()}return e.concat(o)}),[]);return new xv({width:a,height:o,content:d})}function rm(e,t){var n=nm.search(Object.entries(t),(function(t){var n=g(t,2);n[0];return n[1]===e}));if(void 0===n)throw new Error("Invalid special type ".concat(e));return n[0]}function am(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.toRotated(t);return n.each((function(e,t,n){e.setCoord(t,n)})),n}w._RF.pop(),w._RF.push({},"30de5d+cW5OjKyEubKVREbU","createRotatedGrid",void 0),w._RF.pop(),w._RF.push({},"9ceb6vNbn9PKozkdGjjZD67","ensureOneMatch",void 0);var om=Ludex.Utils.Array;function sm(e){var t=e.grid,n=e.setIdentity,i=e.seed,r=void 0===i?Date.now():i,a=t.asArray(),o=qv(t,r),s=function(e,t){var n=t.getCoord(),i=n.x,r=n.y;return Gv.vals(gy).reduce((function(t,n){var a=n.x,o=n.y,s=i+a,l=r+o;return e.isInBounds(s,l)&&t.push(e.get(s,l)),t}),[])}(t,o);if(!s.some((function(e){return e.isSimilarTo(o)}))){var l=qv(s,r),u=om.search(a,(function(e){return!e.inSamePositionAs(o)&&!e.inSamePositionAs(l)&&e.isSimilarTo(l)}));if(void 0===u||null===o.id)throw new Error("Could not find a sacrifice tile");n(u,o.id),n(l,o.id)}}w._RF.pop(),w._RF.push({},"89318H0TDxMlJsVFwuKgrh3","index",void 0),w._RF.pop(),w._RF.push({},"fb4a9VOCxBBvpXFCcSt4P3J","NewbieSteps",void 0);var lm=[{startTile:{x:0,y:1},endTile:{x:3,y:1},localeTextKey:"guide.step1"},{startTile:{x:2,y:2},endTile:{x:3,y:0},localeTextKey:"guide.step2"},{startTile:{x:0,y:0},endTile:{x:3,y:3},localeTextKey:"guide.step3"},{startTile:{x:0,y:4},endTile:{x:2,y:3},localeTextKey:"guide.step4"},{startTile:{x:1,y:4},endTile:{x:1,y:2},localeTextKey:"guide.step5"}];w._RF.pop(),w._RF.push({},"627d5N3oStP8q9+ABNqnHBq","getBestPath",void 0);var um=Ludex.Utils.Array;function cm(e,t){return e[0]===t[0]&&e[1]===t[1]}function pm(e){return new ne(e[0],e[1])}function hm(e,t){return e.x>=-1&&e.x<t.width+1&&e.y>=-1&&e.y<t.height+1}function dm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fm;return t.map((function(t){return[e.tile[0]+t.x,e.tile[1]+t.y]}))}var ym,fm=[gy.Up,gy.Down,gy.Left,gy.Right],vm=function(){function n(e,i){var r;if(t(this,n),this.f=0,this.g=0,this.h=0,i&&cm(e,i.tile))throw new Error("Tile cannot be its own parent");this.tile=e,this.parent=i;var a=n.calcDirection(this),o=i&&a&&i.cache.direction&&!a.equals(i.cache.direction)?1:0;this.cache={direction:a,turns:o+(null!==(r=null==i?void 0:i.cache.turns)&&void 0!==r?r:0)}}return e(n,[{key:"getKey",value:function(){var e;return"x:".concat(this.tile[0],",y:").concat(this.tile[1],",d:").concat(null===(e=this.cache.direction)||void 0===e?void 0:e.toString())}},{key:"equals",value:function(e){return this.getKey()===e.getKey()}}],[{key:"calcDirection",value:function(e){if(e.parent){var t=e.parent.tile,n=e.tile;return new ne(n[0]-t[0],n[1]-t[1])}return null}}]),n}();function mm(e,t,n){var i=wm(e,t),r=wm(e,n);if(0===i.length||0===r.length)return gm(t,n);var a=function(e,t,n){var i=[],r=[],a=new vm(t,null),o=new vm(n,null),s=[o.tile];i.push(a);for(;i.length>0;){var l=i.shift();if(r.push(l),cm(l.tile,o.tile)){for(var u=[],p=l,h=l,d=l.parent;d;)d.cache.turns!==h.cache.turns&&(u.unshift({a:pm(d.tile),b:pm(p.tile)}),p=d),h=d,d=d.parent;return u.unshift({a:pm(h.tile),b:pm(p.tile)}),u}var y,f=dm(l,wm(e,l.tile,s)),v=c(f);try{var m=function(){var e=y.value,t=new vm(e,l);if(t.cache.turns>8)return 0;var n=cm(t.tile,o.tile),a=r.some((function(e){return e.equals(t)}));if(i.some((function(e){return e.equals(t)}))||a&&!n)return 0;t.g=l.g+1+t.cache.turns,t.h=bm(t,o),t.f=t.g+t.h,i.push(t)};for(v.s();!(y=v.n()).done;)m()}catch(e){v.e(e)}finally{v.f()}i.sort((function(e,t){return e.f-t.f}))}return null}(e,t,n);return a||gm(t,n)}function gm(e,t){var n=pm(e),i=pm(t);return n.x===i.x||n.y===i.y?[{a:n,b:i}]:[{a:n,b:{x:n.x,y:i.y}},{a:{x:n.x,y:i.y},b:i}]}function bm(e,t){var n=e.tile,i=t.tile;return Math.abs(n[0]-i[0])+Math.abs(n[1]-i[1])}function wm(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],a=c(fm);try{var o=function(){var a=n.value,o={x:t[0]+a.x,y:t[1]+a.y};if(e.isInBounds(o.x,o.y))return(e.get(o.x,o.y).isHidden()||um.search(i,(function(e){return cm(e,[o.x,o.y])})))&&r.push(a),1;hm(o,e)&&r.push(a)};for(a.s();!(n=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return r}w._RF.pop(),w._RF.push({},"b622ea7Aw5LT5yfRAx8qSap","getErrorPath",void 0),w._RF.pop(),w._RF.push({},"716f6/ILpZCPp1nebbdk8Oj","getGridFen",void 0);var km=(m(ym={},et.bomb,"b"),m(ym,et.star,"s"),m(ym,et.none,"t"),ym);function Sm(e){return e.reduce((function(e,t,n,i){return t.inSamePositionAs(n,i)||e.push([t,[n,i]]),e}),[])}w._RF.pop(),w._RF.push({},"badfeEqwgFEorJVHO9tJSXZ","getOutOfSync",void 0),w._RF.pop();var Cm=o().mark(Em);function Em(e,t){var n,i,r,a,s,l,u,c;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=0,i=e-1,r=0,a=t-1;case 4:if(!(n<=i&&r<=a)){o.next=39;break}s=n;case 6:if(!(s<=i)){o.next=12;break}return o.next=9,{x:s,y:r};case 9:s++,o.next=6;break;case 12:r++,l=r;case 14:if(!(l<=a)){o.next=20;break}return o.next=17,{x:i,y:l};case 17:l++,o.next=14;break;case 20:i--,u=i;case 22:if(!(u>=n)){o.next=28;break}return o.next=25,{x:u,y:a};case 25:u--,o.next=22;break;case 28:a--,c=a;case 30:if(!(c>=r)){o.next=36;break}return o.next=33,{x:n,y:c};case 33:c--,o.next=30;break;case 36:n++,o.next=4;break;case 39:case"end":return o.stop()}}),Cm)}w._RF.push({},"cd0d548/WxD7KCyW2hwySVO","traverseSpiralIn",void 0),w._RF.pop(),w._RF.push({},"373ceVkYCtMTrQObvzJgg7s","getValidPath",void 0);var xm,Am,Tm,Pm,Rm,Lm,Im,Om,_m,Dm,Mm,Nm,Bm=Ludex.Utils.Array,zm=function(){function n(e,i){t(this,n),this.coord=new ne(e,i)}return e(n,[{key:"isHidden",value:function(){return!0}},{key:"isSimilarTo",value:function(){return!1}}]),n}();function Fm(e){return new ne(e[0],e[1])}function Um(e,t,n){if(void 0===t||void 0===n)return function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em,i=[],r=c(n(e.width,e.height));try{for(r.s();!(t=r.n()).done;){var a=t.value,o=e.get(a.x,a.y);o.isHidden()||i.push([o,[a.x,a.y]])}}catch(e){r.e(e)}finally{r.f()}var s,l=[],u=function(){var t=i.shift(),n=g(t,2),r=n[0],a=n[1];if(Bm.search(l,(function(e){return qm(e,a)})))return 0;l.push(a);for(var o,s=function(){var t=g(c[u],2),n=t[0],i=t[1];if(!n.isSimilarTo(r)||Bm.search(l,(function(e){return qm(e,i)})))return 0;var o=Um(e,a,i);return null!==o?{v:{v:o}}:void 0},u=0,c=i;u<c.length;u++)if(0!==(o=s())&&o)return o.v};for(;i.length>0;)if(0!==(s=u())&&s)return s.v;return null}(e);var i,r=[t[0]+1,t[1]+1],a=[n[0]+1,n[1]+1],o=function(e){var t=Bm.fillWith(e.width+2,(function(e){return new zm(e-1,-1)})),n=Bm.fillWith(e.width+2,(function(t){return new zm(t-1,e.height)})),i=Bm.fillWith(e.height,(function(e){return new zm(-1,e)})),r=Bm.fillWith(e.height,(function(t){return new zm(e.width,t)})),a=function(a,o){var s=a-1,l=o-1;return-1===s?i[l]:s===e.width?r[l]:-1===l?t[s]:l===e.height?n[s]:e.get(s,l)};return{get:function(e,t){return a(e,t)},width:e.width+2,height:e.height+2}}(e),s=[r,a];if(r[0]===a[0]&&Wm(o,s,r[1],a[1],r[0])||r[1]===a[1]&&Km(o,s,r[0],a[0],r[1]))return Jm([{a:Fm(r),b:Fm(a)}],{x:-1,y:-1});var l=r[1]<=a[1]?r:a,u=r[1]<=a[1]?a:r,p=r[0]<=a[0]?r:a,h=r[0]<=a[0]?a:r,d=[],y=[],f=jm(o,s,1,Fm(l),Fm(u)),v=jm(o,s,-1,Fm(l),Fm(u));-1===f&&-1===v||(i=-1!==f?f:v,d=[{a:Fm(r),b:{x:r[0],y:i}},{a:{x:r[0],y:i},b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:Fm(a)}]);var m=Ym(o,s,1,Fm(p),Fm(h)),b=Ym(o,s,-1,Fm(p),Fm(h));-1===m&&-1===b||(i=-1!==m?m:b,d=[{a:Fm(r),b:{x:i,y:r[1]}},{a:{x:i,y:r[1]},b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:Fm(a)}]);var w=function(e,t,n,i){for(var r=n.y+1;r<i.y;r++)if(Wm(e,t,n.y,r,n.x)&&Km(e,t,n.x,i.x,r)&&Wm(e,t,r,i.y,i.x))return r;return-1}(o,s,Fm(l),Fm(u));-1!==w&&(i=w,y=[{a:Fm(r),b:{x:r[0],y:i}},{a:{x:r[0],y:i},b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:Fm(a)}]);var k=function(e,t,n,i){for(var r=n.x+1;r<i.x;r++)if(Km(e,t,n.x,r,n.y)&&Wm(e,t,n.y,i.y,r)&&Km(e,t,r,i.x,i.y))return r;return-1}(o,s,Fm(p),Fm(h));return-1!==k&&(i=k,y=[{a:Fm(r),b:{x:i,y:r[1]}},{a:{x:i,y:r[1]},b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:Fm(a)}]),d.length>0&&y.length>0?Jm(Gm(d)<=Gm(y)?d:y,{x:-1,y:-1}):d.length>0?Jm(d,{x:-1,y:-1}):y.length>0?Jm(y,{x:-1,y:-1}):null}function Gm(e){var t,n=0,i=c(e);try{for(i.s();!(t=i.n()).done;){n+=Hm(t.value)}}catch(e){i.e(e)}finally{i.f()}return n}function Hm(e){return e.a.x===e.b.x?Math.abs(e.a.y-e.b.y):e.a.y===e.b.y?Math.abs(e.a.x-e.b.x):0}function qm(e,t){return e[0]===t[0]&&e[1]===t[1]}function Vm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.get.apply(e,v(t));return i.isHidden()||n.some((function(e){return qm(e,t)}))}function Wm(e,t,n,i,r){for(var a=Math.min(n,i),o=Math.max(n,i),s=a;s<=o;s++)if(!Vm(e,[r,s],t))return!1;return!0}function Km(e,t,n,i,r){for(var a=Math.min(n,i),o=Math.max(n,i),s=a;s<=o;s++)if(!Vm(e,[s,r],t))return!1;return!0}function jm(e,t,n,i,r){var a=1===n?r.y:i.y,o=1===n?i.x:r.x;if(Wm(e,t,i.y,r.y,o))for(;a>=0&&a<e.height&&Vm(e,[i.x,a],t)&&Vm(e,[r.x,a],t);){if(Km(e,t,i.x,r.x,a))return a;a+=n}return-1}function Ym(e,t,n,i,r){var a=1===n?r.x:i.x,o=1===n?i.y:r.y;if(Km(e,t,i.x,r.x,o))for(;a>=0&&a<e.width&&Vm(e,[a,i.y],t)&&Vm(e,[a,r.y],t);){if(Wm(e,t,i.y,r.y,a))return a;a+=n}return-1}function Jm(e,t){return e.map((function(e){return{a:{x:e.a.x+t.x,y:e.a.y+t.y},b:{x:e.b.x+t.x,y:e.b.y+t.y}}}))}w._RF.pop(),w._RF.push({},"0cceagmIDZNoZTxP8hBPplh","Board",void 0);var Zm=S.ccclass,Xm=S.property,Qm=S.requireComponent,$m=codex.monitorError,eg=Ludex.Utils,tg=eg.Array,ng=eg.Function,ig=eg.Valid,rg=qe.Layout,ag=(xm=Zm("Board"),Am=Qm(A),Tm=Ii.required,Pm=Xm(Ov),Rm=Ii.required,Lm=Xm(H),Im=Xm({displayName:"Tile Spacing",group:"Create config"}),xm(Om=Am((Dm=r((_m=function(r){n(f,r);var u,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"tilePrefab",Dm,l(e)),s(e,"tilesHolder",Mm,l(e)),s(e,"tileTrim",Nm,l(e)),e.tileSize=[0,0],e.selectedTile=null,e.isPlayingEffect=!1,e.useRotatedGameplay=!1,e.dirtyGameplayRotation=!1,e.parsedGravityRules=[],e.normalMatches=0,e.normalMatchesSinceLastSpawn=0,e.spawnAttempts=0,e.hintPath=null,e.hintTiles=null,e.isAnimating=!1,e.animationQueue=[],e.isConsumingAnimation=!1,e.handleViewResized=ng.debounce((function(){if(!e.isPlayingEffect&&(e.updateTilesHolderScale(),e.levelData)){var t=e.shouldRotate(e.levelData);e.dirtyGameplayRotation=e.useRotatedGameplay!==t,e.dirtyGameplayRotation&&e.consumeAnimationQueue()}}),100),e}return e(f,[{key:"onLoad",value:function(){this.widget=this.getComponent(R),this.uiTransform=this.getComponent(A),Ii.validateRequiredProperties(this,f),this.tilePrefab.node.active=!1,this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"shouldRotate",value:function(e){return 0!==e.level&&e.rows>e.columns!==this.uiTransform.height>this.uiTransform.width}},{key:"create",value:(d=a(o().mark((function e(t,n){var i,r,a,s,l,u,c=this,p=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.length>2&&void 0!==p[2]?p[2]:Date.now(),this.levelData=n,this.handleOrientationChanged(Ye.getCurrentLayout()),e.next=5,Ue.waitTweenAsync(0);case 5:if(r=t.then((function(e){var t=v(e);tg.shuffle(t);var i=t.slice(0,n.colors);return null==$m||$m.addMetadata({frames:i.map((function(e){return e.name}))}),i})),a=tg.fillWith(n.colors,(function(e){return e})),this.useRotatedGameplay=this.shouldRotate(n)&&0!==this.levelData.level,this.parsedGravityRules=Mv(n.mode),s=function(e){var t=he(c.tilePrefab.node),n=t.getComponent(Ov);return n.setIdentity(e,r),c.tilesHolder.addChild(t),t.active=!0,n},l=!1,void 0!==n.customFen)try{l=!0,this.grid=im({customFen:n.customFen,identities:a,createTile:s}),this.useRotatedGameplay&&(this.grid=am(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)}))}catch(e){console.error("Error creating grid from custom fen",e,"falling back to random grid"),l=!1}l||(this.grid=$v({levelData:n,seed:i,identities:a,createTile:s,setTileIdentity:function(e,t){return e.setIdentity(t,r)}}),this.useRotatedGameplay&&(this.grid=am(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)})),sm({grid:this.grid,setIdentity:function(e,t){return e.setIdentity(t,r)},seed:i}),Xv(this.grid,n,i)),u=[this.tileTrim.x,this.tileTrim.y],this.tileSize=Dv(this.tilePrefab.getSize(),u),this.updateTilesHolderScale(),this.node.scene.emit(Us.GRID_CREATE,this),this.selectedTile=null,this.animationQueue=[],this.normalMatches=0,this.normalMatchesSinceLastSpawn=0,this.spawnAttempts=0,this.hintPath=null,this.processGameplayCycle();case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"updateTilesHolderScale",value:function(){if(this.grid){var e=[this.grid.width,this.grid.height],t=[this.uiTransform.width,this.uiTransform.height],n=function(e,t,n){var i=g(e,2),r=i[0],a=i[1],o=g(t,2),s=o[0],l=o[1],u=g(n,2),c=u[0]/(r*s),p=u[1]/(a*l);return Math.min(Math.min(c,p),2.25)}(e,this.tilePrefab.getSize(),t);this.tilesHolder.setScale(n,n),this.node.scene.emit(Us.GRID_RESIZE,n)}}},{key:"destroyTiles",value:function(){var e;null===(e=this.grid)||void 0===e||e.each((function(e){return e.node.destroy()}))}},{key:"animateTilesAppear",value:function(){var e=this;if(!this.grid){var t=new Error("animateTilesAppear: Grid is not initialized");if(ig.isDebugger())throw t;return null==$m||$m.sendException(t),Promise.resolve()}var n=this.grid,i=function(t,n){var i,r=ne.ZERO.clone(),a=c(e.parsedGravityRules);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.useRotatedGameplay?Nv(o):o,l=e.getPrimitiveDirection(t,n,s);r.subtract2f(l.x,l.y)}}catch(e){a.e(e)}finally{a.f()}return r.normalize()};return new Promise((function(t){var r=function(){var r=a(o().mark((function r(){var a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=function(t){return _v(n,e.tileSize,t)},r.next=3,Promise.all(n.map((function(t,r,o){var s=ce(0,.5),l=t.node.scale.clone(),u=i(r,o),c=_v(n,e.tileSize,{x:r,y:o}),p=u.multiplyScalar(100).add2f(c.x,c.y);return t.node.setPosition(p.x,p.y),t.node.setScale(0,0),Promise.all([Ue.runTweenAsync(L(t.node).delay(s).to(.5,{scale:l},{easing:"elasticOut"})),t.sync({getTargetPosition:a,easing:"backOut",duration:.5,delay:s})])})));case 3:t();case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();e.animationQueue.push(r),e.consumeAnimationQueue()}))}},{key:"animateTilesWave",value:function(){var e=this;if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesWave"),Promise.resolve();var t=this.grid;return new Promise((function(n){var i=function(){var e=a(o().mark((function e(){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=nf("center",{x:t.width,y:t.height}),e.next=3,Promise.all(t.map((function(e,t,n){var r,a,o=.1*(null!==(r=null===(a=i[t])||void 0===a?void 0:a[n])&&void 0!==r?r:0),s=e.node.scale.clone();return Promise.all([Ue.runTweenAsync(L(e.node).delay(o).to(.25,{scale:s.clone().multiplyScalar(1.2)},{easing:"quadOut"}).to(.25,{scale:s},{easing:"quadIn"}))])})));case 3:n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.animationQueue.push(i),e.consumeAnimationQueue()}))}},{key:"animateTilesError",value:(h=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.grid){e.next=3;break}return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesError"),e.abrupt("return",Promise.resolve());case 3:if(!this.isAnimating){e.next=5;break}return e.abrupt("return");case 5:return this.isAnimating=!0,e.next=8,Promise.all(t.map((function(e){return e.moveAround()})));case 8:this.isAnimating=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"handleTileClick",value:function(e){if(!e.isHidden()){if(this.selectedTile===e)return Ve.playSound(Ji.TILE_SELECT),this.selectedTile=null,void e.setFocused(!1);if(!this.selectedTile)return Ve.playSound(Ji.TILE_SELECT),this.selectedTile=e,void e.setFocused(!0);if(!this.selectedTile.isSimilarTo(e))return Ve.playSound(Ji.TILE_SELECT),this.selectedTile.setFocused(!1),this.selectedTile=e,void e.setFocused(!0);this.selectedTile.setFocused(!1),this.match(this.selectedTile,e),this.selectedTile=null}}},{key:"clearSelectedTile",value:function(){this.selectedTile&&(this.selectedTile.setFocused(!1),this.selectedTile=null)}},{key:"match",value:function(e,t){if(this.grid&&this.levelData){var n=[e.getCoord().x,e.getCoord().y],i=[t.getCoord().x,t.getCoord().y],r=Um(this.grid,n,i);if(null===r){Ve.playSound(Ji.INVALID_MATCH),this.animateTilesError([e,t]);var a=0===this.levelData.level,o=function(e,t,n,i){if(i){var r=lm[4].startTile,a=lm[4].endTile;if(t[0]===r.x&&t[1]===r.y&&n[0]===a.x&&n[1]===a.y)return[{a:r,b:a}];if(t[0]===a.x&&t[1]===a.y&&n[0]===r.x&&n[1]===r.y)return[{a:r,b:a}]}return mm(e,t,n)}(this.grid,n,i,a);return this.node.scene.emit(Us.GRID_MATCH,[e,t]),void this.node.scene.emit(Us.GRID_MATCH_FAIL,o)}Ve.playSound(Ji.TILE_MATCH),this.node.scene.emit(Us.GRID_MATCH,[e,t]),this.node.scene.emit(Us.GRID_MATCH_SUCCESS,r,[e,t]),this.clear({pairs:[[e,t]]})}else this.reportOrThrowInDebugger("Grid is not initialized","match")}},{key:"clear",value:function(e){var t=this,n=e.pairs,i=e.stagger,r=void 0===i?0:i,a=e.delay,o=void 0===a?0:a,s=e.lightning,l=void 0!==s&&s;this.normalMatches+=n.length;for(var u=0;u<n.length;u++){var c=n[u],p=g(c,2),h=p[0],d=p[1],y=r?2*u*r:0,f=r?(2*u+1)*r:0;h.setEmpty(),d.setEmpty(),h.playClearFX(y,l),d.playClearFX(f,l),this.node.scene.emit(Us.GRID_CLEAR,[h,d])}Ue.waitTweenAsync(o).then((function(){t.processGameplayCycle()}))}},{key:"clearUsingOldLightningFX",value:function(e){this.normalMatches+=e.length;var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=g(i,2),a=r[0],o=r[1];a.setEmpty(),o.setEmpty(),a.playOldLightningClearFX(),o.playOldLightningClearFX(),this.node.scene.emit(Us.GRID_CLEAR,[a,o])}}catch(e){n.e(e)}finally{n.f()}this.processGameplayCycle()}},{key:"showHint",value:function(){if(this.hintPath){var e=this.hintPath[0],t=this.hintPath[this.hintPath.length-1];if(e&&t){var n=e.a,i=t.b,r=this.getTileAt(n.x,n.y),a=this.getTileAt(i.x,i.y);r&&a?(r.setHint(!0),a.setHint(!0),this.hintTiles=[r,a]):this.reportOrThrowInDebugger("Hint tiles are not valid","showHint")}else this.reportOrThrowInDebugger("Hint path is not valid","showHint")}}},{key:"hideHint",value:function(){if(this.hintTiles){var e=g(this.hintTiles,2),t=e[0],n=e[1];t.setHint(!1),n.setHint(!1),this.hintTiles=null}}},{key:"getHintPath",value:function(){return this.hintPath}},{key:"getTileAt",value:function(e,t){return this.grid&&this.grid.isInBounds(e,t)?this.grid.get(e,t):null}},{key:"getAnyTileWorldPosition",value:function(e,t){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getAnyTileWorldPosition"),{x:0,y:0};var n=_v(this.grid,this.tileSize,{x:e,y:t});this.tilePrefab.node.setPosition(n.x,n.y);var i=this.tilePrefab.node.getWorldPosition();return{x:i.x,y:i.y}}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getGridSize",value:function(){return this.grid?[this.grid.width,this.grid.height]:(this.reportOrThrowInDebugger("Grid is not initialized","getGridSize"),[0,0])}},{key:"getUncleared",value:function(){return this.grid?Fv(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getUncleared"),[])}},{key:"getCleared",value:function(){return this.grid?Uv(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getCleared"),[])}},{key:"getBombTiles",value:function(){return this.grid?Fv((e=this.grid)instanceof xv?e.asArray():e).filter((function(e){var t;return(null===(t=e.special)||void 0===t?void 0:t.type)===et.bomb})):(this.reportOrThrowInDebugger("Grid is not initialized","getBombTiles"),[]);var e}},{key:"getPairs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPairs"),[];for(var n=[],i=t?Fv(this.grid):Uv(this.grid),r=function(){var e=Wv(i),t=g(e,2),r=t[0],a=t[1];n.push([r,a]),i=i.filter((function(e){return e!==r&&e!==a}))};n.length<e;)r();return n}},{key:"getBoundingBoxWorld",value:function(){var e=this.tilesHolder.getWorldScale().x,t=this.getGridSize(),n=this.tileSize[0]*e*t[0],i=this.tileSize[1]*e*t[1],r=this.node.getWorldPosition().subtract3f(n/2,i/2,0);return new $.Rect(r.x,r.y,n,i)}},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this.grid)||void 0===e||e.each((function(e){return e.setIgnoreInput(t)}))}},{key:"processShuffleRequest",value:function(e){if(this.grid){var t=this.processShuffleStep(this.grid,!0,e);this.grid=t[0],this.hintPath=t[1],this.consumeAnimationQueue()}else this.reportOrThrowInDebugger("Grid is not initialized","processShuffleRequest")}},{key:"generateFenFromCurrentLevel",value:function(e){var t;return this.levelData||this.reportOrThrowInDebugger("Level data is not initialized","generateFenFromCurrentLevel"),f.generateFen(null!==(t=null!=e?e:this.levelData)&&void 0!==t?t:$y)}},{key:"listenEvents",value:function(){O.on(Ge.VIEW_RESIZED,this.handleViewResized),O.on(Ge.WIDGET_RESIZED,this.handleViewResized),O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.on(Us.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.on(Us.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"unlistenEvents",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized),O.off(Ge.WIDGET_RESIZED,this.handleViewResized),O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.off(Us.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.off(Us.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"onEffectAnimStarted",value:function(){this.isPlayingEffect=!0}},{key:"onEffectAnimEnded",value:function(){this.isPlayingEffect=!1,this.handleOrientationChanged(Ye.getCurrentLayout()),this.handleViewResized()}},{key:"getWidgetMargins",value:function(e){return e!==rg.Landscape||void 0!==this.levelData&&0===this.levelData.level?{top:160,bottom:160,left:20,right:20}:{top:80,bottom:80,left:640,right:60}}},{key:"handleOrientationChanged",value:function(e){if(!this.isPlayingEffect){var t=this.getWidgetMargins(e),n=t.top,i=t.bottom,r=t.left,a=t.right;this.widget.top=n,this.widget.bottom=i,this.widget.left=r,this.widget.right=a}}},{key:"processGameplayCycle",value:function(){if(this.node.activeInHierarchy&&this.grid&&this.levelData){var e=Fv(this.grid);if(0!==e.length){var t=this.grid,n=e.length>=2&&this.spawnAttempts<this.levelData.rules.addRandomTilesPerMove&&this.normalMatches>=5,i=this.normalMatchesSinceLastSpawn>=2;n&&(i?(this.spawnAttempts++,this.normalMatchesSinceLastSpawn=0,this.processSpawnStep()):this.normalMatchesSinceLastSpawn++),e.length%2==1&&this.processSpawnSingleTileStep(),e.length>14&&(t=this.processGravitationStep(t));var r=this.processShuffleStep(t);this.consumeAnimationQueue(),this.grid=r[0],this.hintPath=r[1]}}else this.reportOrThrowInDebugger("Grid is not initialized","processGameplayCycle")}},{key:"processSpawnStep",value:function(){var e,t;if(this.grid){var n=Jv(Uv(this.grid),2),i=g(n,2),r=i[0],a=i[1],o=null!==(e=null==r?void 0:r.id)&&void 0!==e?e:void 0,s=null!==(t=null==r?void 0:r.frames)&&void 0!==t?t:void 0;void 0!==r&&void 0!==o&&void 0!==s&&void 0!==a?(r.restore(),a.restore(o,s),this.node.scene.emit(Us.GRID_SPAWN,[r,a])):this.reportOrThrowInDebugger("Failed to get random tiles","processSpawnStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnStep")}},{key:"processGravitationStep",value:function(e){var t,n=this,i=e,r=[],s=c(this.parsedGravityRules);try{var l=function(){var e=t.value,s=n.useRotatedGameplay?Nv(e):e,l=Sm(i=n.toGravitated(i,s));if(0===l.length)return 1;var u,p=c(l);try{for(p.s();!(u=p.n()).done;){var h=g(u.value,2),d=h[0],y=g(h[1],2),f=y[0],v=y[1];d.setCoord(f,v)}}catch(e){p.e(e)}finally{p.f()}i.each((function(e){e.node.setSiblingIndex(0)}));var m=function(){var e=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(l.map((function(e){var t=g(e,2),r=t[0],a=g(t[1],2),o=a[0],s=a[1];return r.sync({delay:.25,duration:.25,getTargetPosition:function(){return _v(i,n.tileSize,{x:o,y:s})}})})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.push(m)};for(s.s();!(t=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}var u=function(){var e=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,n=r;case 1:if(!(t<n.length)){e.next=8;break}return i=n[t],e.next=5,i();case 5:t++,e.next=1;break;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return this.animationQueue.push(u),i}},{key:"toGravitated",value:function(e,t){var n=new xv(e),i=e.height-1,r=e.width-1,a=[0,i],o=[0,r],s=Math.floor(e.height/2),l=Math.floor(e.width/2),u=function(e){return e.isHidden()};switch(t){case by:n.gravitate({rowRange:a,colRange:o,direction:gy.Down,isLighter:u});break;case wy:n.gravitate({rowRange:a,colRange:o,direction:gy.Up,isLighter:u});break;case ky:n.gravitate({rowRange:a,colRange:o,direction:gy.Left,isLighter:u});break;case Sy:n.gravitate({rowRange:a,colRange:o,direction:gy.Right,isLighter:u});break;case Cy:n.gravitate({rowRange:a,colRange:[l,r],direction:gy.Left,isLighter:u,out:n.gravitate({rowRange:a,colRange:[0,l-1],direction:gy.Right,isLighter:u})});break;case Ey:n.gravitate({rowRange:[s,i],colRange:o,direction:gy.Down,isLighter:u,out:n.gravitate({rowRange:[0,s-1],colRange:o,direction:gy.Up,isLighter:u})})}return n}},{key:"getPrimitiveDirection",value:function(e,t,n){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPrimitiveDirection"),gy.Down;var i=Math.floor(this.grid.height/2),r=Math.floor(this.grid.width/2);switch(n){case by:return gy.Down;case wy:return gy.Up;case ky:return gy.Left;case Sy:return gy.Right;case Cy:return e>=r?gy.Left:gy.Right;case Ey:return t>=i?gy.Down:gy.Up}}},{key:"processShuffleStep",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=Um(e),o=Fv(e).map((function(e){var t=e.getCoord();return[t.x,t.y]}));if(null!==a&&!i)return[e,a];var s=100;do{var l=e.toShuffled(o),u=g(l,1);a=Um(n=u[0]),s--}while(null===a&&s>0);if(s<=0){var p,h,d,y,f=n.asArray().map((function(e){var t;return{name:e.id,type:null===(t=e.special)||void 0===t?void 0:t.type,active:!e.isHidden()}}));return null==$m||$m.sendException(new Error("No paths found after 100 shuffle attempts"),{message:"No paths found after 100 shuffle attempts",level:null===(p=this.levelData)||void 0===p?void 0:p.level,rules:null===(h=this.levelData)||void 0===h?void 0:h.rules,mode:null===(d=this.levelData)||void 0===d?void 0:d.mode,gridAsArray:f}),this.node.scene.emit(Us.GAME_EXIT),[e,null!==(y=a)&&void 0!==y?y:[]]}var v,m=Sm(n),b=c(m);try{for(b.s();!(v=b.n()).done;){var w=g(v.value,2),k=w[0],S=g(w[1],2),C=S[0],E=S[1];k.setCoord(C,E)}}catch(e){b.e(e)}finally{b.f()}var x=void 0!==r?function(){return r(e,n)}:this.createShuffleAnimationHandler(e,n);return this.animationQueue.push(x),[n,null!==(t=a)&&void 0!==t?t:[]]}},{key:"createShuffleAnimationHandler",value:function(e,t){var n=this,i=function(){var i=a(o().mark((function i(){return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all(e.map((function(e,i,r){return e.sync({duration:.3,easing:"smooth",getTargetPosition:function(){return _v(t,n.tileSize,{x:i,y:r},10)}})})));case 2:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}(),r=function(){var e=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.each((function(e){e.node.setSiblingIndex(0)})),e.next=3,Promise.all(t.map((function(e){return e.sync({duration:.4,easing:"smooth",delay:ce(0,.2),getTargetPosition:function(e){return _v(t,n.tileSize,e)}})})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(){var e=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return e.next=4,r();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},{key:"processSpawnSingleTileStep",value:function(){if(this.grid){var e,t=Jv(Uv(this.grid),1),n=g(t,1)[0],i=Fv(this.grid),r={},a=c(i);try{for(a.s();!(e=a.n()).done;){var o,s=e.value.id;null!==s&&(r[s]=(null!==(o=r[s])&&void 0!==o?o:0)+1)}}catch(e){a.e(e)}finally{a.f()}var l=tg.search(i,(function(e){var t=e.id;if(null===t)return!1;var n=r[t];return void 0!==n&&n%2==1}));n&&l&&null!==l.id?(n.restore(l.id,l.frames),this.node.scene.emit(Us.GRID_SPAWN,[n])):this.reportOrThrowInDebugger("Failed to get a random tile","processSpawnSingleTileStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnSingleTileStep")}},{key:"consumeAnimationQueue",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isConsumingAnimation){e.next=2;break}return e.abrupt("return");case 2:this.isConsumingAnimation=!0;case 3:if(!(this.animationQueue.length>0)){e.next=12;break}if(0!==this.getUncleared().length){e.next=7;break}return this.animationQueue=[],e.abrupt("break",12);case 7:return t=this.animationQueue.shift(),e.next=10,null==t?void 0:t();case 10:e.next=3;break;case 12:if(!this.dirtyGameplayRotation||void 0===this.levelData){e.next=20;break}if(this.dirtyGameplayRotation=!1,this.shouldRotate(this.levelData)===this.useRotatedGameplay){e.next=18;break}return e.next=18,this.updateGameplayRotation();case 18:e.next=12;break;case 20:this.isConsumingAnimation=!1;case 21:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updateGameplayRotation",value:(u=a(o().mark((function e(){var t,n,i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.levelData){e.next=2;break}return e.abrupt("return");case 2:if(t=this.shouldRotate(this.levelData),n=this.useRotatedGameplay&&!t,this.useRotatedGameplay=t,this.grid&&this.levelData&&this.hintPath){e.next=7;break}return e.abrupt("return");case 7:return this.node.scene.emit(Us.GRID_ORIENTATION_CHANGE,this.useRotatedGameplay),this.hintPath=zv(this.grid.width,this.grid.height,this.hintPath,n),this.setIgnoreInput(!0),i=am(this.grid,n),this.grid=i,this.updateTilesHolderScale(),e.next=15,Promise.all(i.map((function(e){return e.sync({delay:.3,duration:.3,easing:"quartInOut",getTargetPosition:function(){return _v(i,r.tileSize,e.getCoord(),10)}})})));case 15:return i.each((function(e){e.node.setSiblingIndex(0)})),e.next=18,Promise.all(i.map((function(e){return e.sync({duration:.2,easing:"sineInOut",getTargetPosition:function(){return _v(i,r.tileSize,e.getCoord())}})})));case 18:this.setIgnoreInput(!1);case 19:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"clearAnimationQueue",value:function(){this.isConsumingAnimation=!1,this.animationQueue=[]}},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if(ig.isDebugger())throw n;null==$m||$m.sendException(n)}}],[{key:"generateFen",value:function(e){for(var t=e,n=[],i=0;i<t.colors;i++)n.push(i+1);var r=Date.now(),a=$v({levelData:t,seed:r,identities:n,setTileIdentity:function(e,t){return e.setIdentity(t)},createTile:function(e){var t=e,n=void 0,i=new ne(0,0);return{get id(){return t},get special(){return n},get coord(){return i},setIdentity:function(e){t=e},isHidden:function(){return!1},setSpecialType:function(e){n={type:e}},setCoord:function(e,t){return i.set(e,t)},getCoord:function(){return i},isSimilarTo:function(e){return e.id===t},inSamePositionAs:function(e){return e.getCoord().equals(i)}}}});return a.each((function(e,t,n){e.setCoord(t,n)})),sm({grid:a,seed:r,setIdentity:function(e,t){return e.setIdentity(t)}}),Xv(a,t,r),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:km,n=e.width,i=e.height,r=[],a=new Map,o=i-1;o>=0;o--){for(var s=[],l=0;l<n;l++){var u,c,p=e.get(l,o),h=p.isHidden()?null:p.id;if(null!==h){var d=t[null!==(u=null===(c=p.special)||void 0===c?void 0:c.type)&&void 0!==u?u:et.none];if(!a.has(h)){var y=a.size.toString();a.set(h,y)}var f="".concat(d).concat(a.get(h));s.push(f)}else s.push(".")}r.push(s.join(""))}return{code:r.join(":"),idSize:a.size,encoding:t,rows:i,cols:n}}(a)}}]),f}(x)).prototype,"tilePrefab",[Tm,Pm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mm=r(_m.prototype,"tilesHolder",[Rm,Lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nm=r(_m.prototype,"tileTrim",[Im],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ne(.025,.1)}}),Om=_m))||Om)||Om);w._RF.pop(),w._RF.push({},"f7e1byg/txJGqnuJJ7xQV1M","withItemAnalytics",void 0);var og=Ludex.Plugins.Analytics,sg=(void 0===og?{}:og).Events,lg=codex.analytics,ug=function(e,t){return function(){return sg&&lg.event(sg.USE_ITEM,{item_name:e}),t.apply(void 0,arguments)}};w._RF.pop(),w._RF.push({},"bc704Yz8bdJzYja7TsWcGMN","useHintItem",void 0);var cg=ug(Xe.PLIERS,(function(e,t){if(!t.isDrawingHint){var n=e.getHintPath();null!==n&&(Ve.playSound(Ji.HINT_ITEM),t.drawHintPath(n,(function(t){return e.getAnyTileWorldPosition(t.x,t.y)})),e.showHint())}}));w._RF.pop(),w._RF.push({},"0a2423JE25HLIm5td77YE7e","usePliersItem",void 0);var pg=ug(Xe.PLIERS,(function(e,t){var n,i=qv(e.getBombTiles()),r=i.node.worldPosition;t.createDefuseExplosionAt(r.x,r.y),Ve.playSound(Ji.BOMB_DEFUSE),null===(n=i.special)||void 0===n||n.switch(et.none)}));w._RF.pop(),w._RF.push({},"004c93sHsBHnpww25v/ilqP","withBlockedInput",void 0);w._RF.pop(),w._RF.push({},"33523Q0FqxMp6H+SNCi8//7","withCenteredBoard",void 0);var hg=function(e,t){return a(o().mark((function n(){var i,r,a,s,l,u,c,p,h,d,y=arguments;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.widget,r=i.left,a=i.right,s=(r+a)/2,n.next=4,Ue.runTweenAsync(L(e.widget).to(.2,{left:s,right:s},{easing:"cubicOut"}));case 4:return n.next=6,t.apply(void 0,y);case 6:return l=n.sent,u=e.getWidgetMargins(Ye.getCurrentLayout()),c=u.top,p=u.bottom,h=u.left,d=u.right,n.next=10,Ue.runTweenAsync(L(e.widget).to(.2,{top:c,bottom:p,left:h,right:d},{easing:"cubicOut"}));case 10:return n.abrupt("return",l);case 11:case"end":return n.stop()}}),n)})))};w._RF.pop(),w._RF.push({},"975e3Ao0kxHW6RlBkPl5kbh","withEffectAnimationEvents",void 0);var dg=function(e,t){return a(o().mark((function n(){var i,r=arguments;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.node.scene.emit(Us.EFFECTS_ANIMATION_START),n.next=3,t.apply(void 0,r);case 3:return i=n.sent,e.node.scene.emit(Us.EFFECTS_ANIMATION_END),n.abrupt("return",i);case 6:case"end":return n.stop()}}),n)})))};w._RF.pop(),w._RF.push({},"d2cd0VZLwhNMJwc3ppHvOtA","withLoweredVolume",void 0);var yg=function(e){return a(o().mark((function t(){var n,i=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ve.setVolumeMusic(0,!0),t.next=3,e.apply(void 0,i);case 3:return n=t.sent,Ve.setVolumeMusic(.3,!0),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))};w._RF.pop(),w._RF.push({},"a62ebriH15FfI8l0x1GBX1p","useThunderItem",void 0);var fg,vg=function(){var e=a(o().mark((function e(t,n){var i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.getUncleared().length<4)){e.next=3;break}return e.abrupt("return");case 3:return i=t.getPairs(2),r=dg(t,hg(t,gg)),t.clearSelectedTile(),e.next=8,r(n,i,t);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),mg=ug(Xe.THUNDER,yg((fg=vg,a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return tt.setBlockInput(!0),e.next=3,fg.apply(void 0,n);case 3:return t=e.sent,tt.setBlockInput(!1),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))))));function gg(e,t,n){return e.playThunderAnimation(t,n)}w._RF.pop(),w._RF.push({},"0e50bRTLUtMgYDDkS0nbFm5","useTornadoItem",void 0);var bg,wg=Ludex.Utils.Function,kg=function(){var e=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wg.allSettled(t.map((function(e,i,r){return e.sync({duration:.4,easing:"smooth",getTargetPosition:function(){return _v(t,n,{x:i,y:r},10)}})})));case 2:(i=e.sent).some((function(e){return"rejected"===e.status}))&&console.error("Error playing padding animation",i.filter((function(e){return"rejected"===e.status})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Sg=function(){var e=a(o().mark((function e(t,n){var i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.asArray(),r=i.length,t.each((function(e,n,i){e.node.setSiblingIndex(r-1-(n+i*t.width))})),e.next=5,wg.allSettled(t.map((function(e){return e.fly({getTilePosition:function(e){return _v(t,n,e)}})})));case 5:(a=e.sent).some((function(e){return"rejected"===e.status}))&&console.error("Error playing shuffle animation",a.filter((function(e){return"rejected"===e.status})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Cg=function(){var e=a(o().mark((function e(t,n,i,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ve.playSound(Ji.SHUFFLE_ITEM),Ve.playSound(Ji.WIND),e.next=4,kg(t,i());case 4:return r(),e.next=7,Sg(n,i());case 7:case"end":return e.stop()}}),e)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),Eg=function(){var e=a(o().mark((function e(t,n){var i,r,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return t.getTileSize()},r=function(){return n.playTornadoAnimation()},s=dg(t,hg(t,yg((function(e,t){return Cg(e,t,i,r)})))),e.abrupt("return",new Promise((function(e){t.processShuffleRequest(function(){var n=a(o().mark((function n(i,r){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.clearSelectedTile(),n.next=3,s(i,r);case 3:e();case 4:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xg=ug(Xe.THUNDER,yg(Eg));w._RF.pop(),w._RF.push({},"c92ec8pmUJGbrL9PLjum+i5","Line",void 0);var Ag=(0,S.ccclass)("Line")(bg=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(A)}},{key:"setPoints",value:function(e,t){this.node.setWorldPosition((e.x+t.x)/2,(e.y+t.y)/2,0),this.uiTransform.width=ne.distance(e,t)+10,this.uiTransform.width/=this.node.worldScale.x;var n=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI;this.node.eulerAngles=new q(0,0,n)}}]),o}(x))||bg;w._RF.pop(),w._RF.push({},"1e7cch8i/5DkYHOwJowrjeg","AFPool",void 0);var Tg,Pg,Rg,Lg,Ig,Og,_g,Dg,Mg,Ng,Bg,zg=function(r){n(o,r);var a=i(o);function o(e,n,i,r,s){var l;return t(this,o),(l=a.call(this,e,n,s)).ator=i,l.ftor=r,l}return e(o,[{key:"alloc",value:function(){var e=p(h(o.prototype),"alloc",this).call(this);return this.ator&&this.ator(e),e}},{key:"free",value:function(e){this.ftor&&this.ftor(e),p(h(o.prototype),"free",this).call(this,e)}}]),o}(de);w._RF.pop(),w._RF.push({},"6f7a1msxIxIbYLx5PpbL/BZ","PathDrawer",void 0);var Fg,Ug,Gg,Hg,qg,Vg,Wg,Kg,jg,Yg=S.ccclass,Jg=S.property,Zg=(Tg=Yg("PathDrawer"),Pg=Jg({group:"Line",displayName:"Prefab",type:ye}),Rg=Jg({group:"Line",displayName:"Holder",type:H,tooltip:"Line Prefab"}),Lg=Jg({group:"Point",displayName:"Prefab",type:ye}),Ig=Jg({group:"Point",displayName:"Holder",type:H}),Tg((Dg=r((_g=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"linePrefab",Dg,l(e)),s(e,"lineHolder",Mg,l(e)),e.lineNodes=[],s(e,"pointPrefab",Ng,l(e)),s(e,"pointHolder",Bg,l(e)),e.pointNodes=[],e}return e(o,[{key:"start",value:function(){var e=this;this.linePool=new zg((function(){var t=he(e.linePrefab);return e.lineHolder.addChild(t),t.parent=e.lineHolder,t.active=!1,t}),0,(function(t){e.lineNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()})),this.pointPool=new zg((function(){var t=he(e.pointPrefab);return e.pointHolder.addChild(t),t.active=!1,t}),0,(function(t){e.pointNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()}))}},{key:"drawPath",value:function(e){this.clearPath();var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i,r=t.value;null===(i=this.linePool.alloc().getComponent(Ag))||void 0===i||i.setPoints(r.a,r.b)}}catch(e){n.e(e)}finally{n.f()}}},{key:"clearPath",value:function(){var e,t=c(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.linePool.free(n)}}catch(e){t.e(e)}finally{t.f()}this.lineNodes=[];var i,r=c(this.pointNodes);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.pointPool.free(a)}}catch(e){r.e(e)}finally{r.f()}this.pointNodes=[]}}]),o}(x)).prototype,"linePrefab",[Pg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mg=r(_g.prototype,"lineHolder",[Rg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ng=r(_g.prototype,"pointPrefab",[Lg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bg=r(_g.prototype,"pointHolder",[Ig],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Og=_g))||Og);w._RF.pop(),w._RF.push({},"5cc7bAmTI1JL7nwLzZcp45u","ErrorDrawer",void 0);var Xg,Qg,$g,eb,tb=S.ccclass,nb=S.property,ib=(Fg=tb("ErrorDrawer"),Ug=nb(se),Gg=nb(se),Hg=nb(se),Fg((Wg=r((Vg=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"one",Wg,l(e)),s(e,"two",Kg,l(e)),s(e,"error",jg,l(e)),e}return e(o,[{key:"start",value:function(){p(h(o.prototype),"start",this).call(this),this.pathAppearDuration=0}},{key:"drawPath",value:function(e){var t=this;if(this.clearPath(),e.forEach((function(n,i){var r;if(null===(r=t.linePool.alloc().getComponent(Ag))||void 0===r||r.setPoints(n.a,n.b),0!==i){var a=t.pointPool.alloc();a.setWorldPosition(new q(n.a.x,n.a.y,0));var o=a.getComponent(N);1===i&&e.length>3?o.spriteFrame=t.one:2===i&&e.length>3?o.spriteFrame=t.two:o.spriteFrame=t.error}})),1===e.length){var n=this.pointPool.alloc();n.setWorldPosition(new q(e[0].a.x+e[0].b.x,e[0].a.y+e[0].b.y,0).multiplyScalar(.5)),n.getComponent(N).spriteFrame=this.error}this.pathAppearDuration=.8}},{key:"update",value:function(e){this.pathAppearDuration>0&&(this.pathAppearDuration-=e,this.pathAppearDuration<=0&&this.clearPath())}}]),o}(Zg)).prototype,"one",[Ug],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kg=r(Vg.prototype,"two",[Gg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jg=r(Vg.prototype,"error",[Hg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qg=Vg))||qg);w._RF.pop(),w._RF.push({},"880e8aL9NFPj68zH2xVRIFR","HintDrawer",void 0);var rb,ab,ob,sb,lb=(Xg=(0,S.ccclass)("HintDrawer"),Qg=Ii.onlyRunInLifeCycle,Xg((r((eb=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"drawPath",value:function(e){this.clearPath(),this.createPath(e),this.showPath()}},{key:"createPath",value:function(e){if(0!==e.length){var t=e.length-1;if(!(t<0)){var n=e[t];if(n){var i,r=c(e);try{for(r.s();!(i=r.n()).done;){var a,o=i.value;null===(a=this.linePool.alloc().getComponent(Ag))||void 0===a||a.setPoints(o.a,o.b),this.pointPool.alloc().setWorldPosition(o.a.x,o.a.y,0)}}catch(e){r.e(e)}finally{r.f()}this.pointPool.alloc().setWorldPosition(n.b.x,n.b.y,0)}}}}},{key:"showPath",value:function(){var e,t=c(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value.getComponent(M);n.opacity=0,L(n).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){t.e(e)}finally{t.f()}var i,r=c(this.pointNodes);try{for(r.s();!(i=r.n()).done;){var a=i.value.getComponent(M);a.opacity=0,L(a).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){r.e(e)}finally{r.f()}}},{key:"clearPath",value:function(){var e,t=this,n=c(this.lineNodes);try{var i=function(){var n=e.value,i=n.getComponent(M),r=L(i).to(.15,{opacity:0});Ue.runTweenAsync(r).then((function(){t.node.activeInHierarchy&&(i.opacity=255,t.linePool.free(n))}))};for(n.s();!(e=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}var r,a=c(this.pointNodes);try{var o=function(){var e=r.value,n=e.getComponent(M),i=L(n).to(.15,{opacity:0});Ue.runTweenAsync(i).then((function(){t.node.activeInHierarchy&&(n.opacity=255,t.pointPool.free(e))}))};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}this.lineNodes=[],this.pointNodes=[]}}]),o}(Zg)).prototype,"clearPath",[Qg],Object.getOwnPropertyDescriptor(eb.prototype,"clearPath"),eb.prototype),$g=eb))||$g);w._RF.pop(),w._RF.push({},"25f67BW5/5Jzox4v+yBBbyS","MatchDrawer",void 0);var ub,cb,pb,hb,db,yb,fb,vb,mb,gb=(rb=(0,S.ccclass)("MatchDrawer"),ab=Ii.onlyRunInLifeCycleAsync,rb((r((sb=function(r){n(c,r);var s,l,u=i(c);function c(){return t(this,c),u.apply(this,arguments)}return e(c,[{key:"drawPath",value:function(e){var t=this;if(0!==e.length){var n=e.length-1;if(!(n<0)){var i=e[n];if(i){e.forEach((function(e,n){var i,r=t.linePool.alloc();null===(i=r.getComponent(Ag))||void 0===i||i.setPoints(e.a,e.b),t.animateLine(r);var a=t.pointPool.alloc();a.setWorldPosition(e.a.x,e.a.y,0),t.animatePoint(a,n)}));var r=this.pointPool.alloc();r.setWorldPosition(i.b.x,i.b.y,0),this.animatePoint(r,e.length)}}}}},{key:"animateLine",value:(l=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.getComponent(M)).opacity=0,i=L(n).to(.25,{opacity:255},{easing:"quadOut"}).delay(.1).to(.2,{opacity:0}),e.next=5,Ue.runTweenAsync(i);case 5:n.opacity=255,this.linePool.free(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"animatePoint",value:(s=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.scale=q.ZERO,i=L(t).delay(.03*n).to(.2,{scale:q.ONE},{easing:"quadOut"}).delay(.1).to(.2,{scale:q.ZERO},{easing:"backIn"}),e.next=4,Ue.runTweenAsync(i);case 4:if(this.node.activeInHierarchy){e.next=6;break}return e.abrupt("return");case 6:this.pointPool.free(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"clearPath",value:function(){this.lineNodes=[],this.pointNodes=[]}}]),c}(Zg)).prototype,"animatePoint",[ab],Object.getOwnPropertyDescriptor(sb.prototype,"animatePoint"),sb.prototype),ob=sb))||ob);w._RF.pop(),w._RF.push({},"bfdf2THr9lPJ4TOVDN8VgE4","PathDraw",void 0);var bb,wb=S.ccclass,kb=S.property,Sb=(ub=wb("PathDraw"),cb=kb({group:{name:"Path Drawer"},type:gb}),pb=kb({group:{name:"Path Drawer"},type:lb}),hb=kb({group:{name:"Path Drawer"},type:ib}),ub((fb=r((yb=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"matchPath",fb,l(e)),s(e,"hintPath",vb,l(e)),s(e,"errorPath",mb,l(e)),e.isDrawingHint=!1,e}return e(o,[{key:"onLoad",value:function(){var e=this;this.node.scene.on(Us.GRID_RESIZE,(function(t){e.node.setScale(t,t),e.node.position=e.board.node.position.clone()}))}},{key:"init",value:function(e){this.board=e}},{key:"drawMatchPath",value:function(e,t){var n,i=e.map((function(e){return u({},e)})),r=c(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.a=t(a.a),a.b=t(a.b)}}catch(e){r.e(e)}finally{r.f()}this.matchPath.drawPath(i)}},{key:"clearMatchPath",value:function(){this.matchPath.clearPath()}},{key:"drawHintPath",value:function(e,t){if(!this.isDrawingHint){this.isDrawingHint=!0;var n,i=e.map((function(e){return u({},e)})),r=c(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.a=t(a.a),a.b=t(a.b)}}catch(e){r.e(e)}finally{r.f()}this.hintPath.drawPath(i)}}},{key:"clearHintPath",value:function(){this.isDrawingHint&&(this.isDrawingHint=!1,this.hintPath.clearPath())}},{key:"drawErrorPath",value:function(e,t){var n,i=e.map((function(e){return u({},e)})),r=c(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.a=t(a.a),a.b=t(a.b)}}catch(e){r.e(e)}finally{r.f()}this.errorPath.drawPath(i)}}]),o}(x)).prototype,"matchPath",[cb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vb=r(yb.prototype,"hintPath",[pb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mb=r(yb.prototype,"errorPath",[hb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),db=yb))||db);w._RF.pop(),w._RF.push({},"1a5c0RyWQJOipSvNtPLsTHS","ClockManager",void 0);var Cb,Eb,xb,Ab,Tb,Pb,Rb,Lb,Ib,Ob,_b,Db,Mb,Nb,Bb,zb,Fb,Ub,Gb=S.ccclass,Hb=S.disallowMultiple,qb=Gb("ClockManager")(bb=Hb(bb=function(r){n(u,r);var s,l=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=l.call.apply(l,[this].concat(i))).time=0,e.remaining=0,e.running=!1,e.halfTime=!1,e}return e(u,[{key:"onLoad",value:function(){this.node.scene.on(Us.RESCUE_START,this.refillTime,this)}},{key:"init",value:function(){this.running=!1,this.halfTime=!1}},{key:"setTime",value:function(e){this.time=e,this.remaining=e,this.node.scene.emit(Us.TIME_UPDATED,this.remaining)}},{key:"getRemainingTime",value:function(){return this.remaining}},{key:"startCountdown",value:function(){this.running=!0,this.remaining=this.time}},{key:"pause",value:function(){this.running=!1}},{key:"resume",value:function(){this.running=!0}},{key:"endCountDown",value:function(){this.running=!1,this.remaining=0,this.node.scene.emit(Us.TIME_OUT)}},{key:"update",value:function(e){this.running&&(this.remaining<=0?this.endCountDown():(this.remaining-=e,!this.halfTime&&this.remaining<=this.time/2&&(this.halfTime=!0,this.node.scene.emit(Us.HALF_TIME)),this.remaining>=0&&this.node.scene.emit(Us.TIME_UPDATED,this.remaining)))}},{key:"refillTime",value:(s=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=120,n=L(this.node).to(3,{},{onUpdate:function(e,n){if(n){var r=$.lerp(0,t,n);i.setTime(r)}}}),e.next=4,Ue.runTweenAsync(n);case 4:this.setTime(t),this.node.scene.emit(Us.RESCUE_FINISHED);case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}]),u}(x))||bb)||bb;w._RF.pop(),w._RF.push({},"944cbG3+yRMsJZimXjukGdn","Coin",void 0);var Vb,Wb,Kb,jb,Yb,Jb,Zb,Xb,Qb,$b,ew,tw=S.ccclass,nw=S.property,iw=(Cb=tw("Coin"),Eb=nw(Q),xb=nw(le),Ab=nw(ue),Tb=nw(ue),Pb=Ii.onlyRunInLifeCycle,Rb=Ii.onlyRunInLifeCycle,Lb=Ii.onlyRunInLifeCycle,Ib=Ii.onlyRunInLifeCycle,Ob=Ii.onlyRunInLifeCycleAsync,_b=Ii.onlyRunInLifeCycleAsync,Db=Ii.onlyRunInLifeCycle,Cb((Bb=r((Nb=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"emittingParticles",Bb,l(e)),s(e,"animation",zb,l(e)),s(e,"spin",Fb,l(e)),s(e,"rest",Ub,l(e)),e}return e(p,[{key:"__preload",value:function(){Ii.lazyValidateProperties(this)}},{key:"resetDisabled",value:function(){this.stopParticles(),this.stopAnimation(),this.hide(),this.node.active=!1,this.node.setPosition(0,0,this.node.position.z)}},{key:"hide",value:function(){this.node.setScale(q.ZERO)}},{key:"stopParticles",value:function(){this.emittingParticles.stopSystem()}},{key:"playTrailParticles",value:function(){this.emittingParticles.resetSystem()}},{key:"playSpinAnimationAfterDelay",value:(u=a(o().mark((function e(){var t,n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:0,n=i.length>1?i[1]:void 0,!(t>0)){e.next=5;break}return e.next=5,Ue.waitTweenAsync(t);case 5:return e.next=7,this.playSpinAnimation(n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"playSpinAnimation",value:function(e){return Ue.runAnimationAsync(this.animation,this.spin.name,e)}},{key:"stopAnimation",value:function(){this.animation.play(this.rest.name)}}]),p}(x)).prototype,"emittingParticles",[Eb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zb=r(Nb.prototype,"animation",[xb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fb=r(Nb.prototype,"spin",[Ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ub=r(Nb.prototype,"rest",[Tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Nb.prototype,"resetDisabled",[Pb],Object.getOwnPropertyDescriptor(Nb.prototype,"resetDisabled"),Nb.prototype),r(Nb.prototype,"hide",[Rb],Object.getOwnPropertyDescriptor(Nb.prototype,"hide"),Nb.prototype),r(Nb.prototype,"stopParticles",[Lb],Object.getOwnPropertyDescriptor(Nb.prototype,"stopParticles"),Nb.prototype),r(Nb.prototype,"playTrailParticles",[Ib],Object.getOwnPropertyDescriptor(Nb.prototype,"playTrailParticles"),Nb.prototype),r(Nb.prototype,"playSpinAnimationAfterDelay",[Ob],Object.getOwnPropertyDescriptor(Nb.prototype,"playSpinAnimationAfterDelay"),Nb.prototype),r(Nb.prototype,"playSpinAnimation",[_b],Object.getOwnPropertyDescriptor(Nb.prototype,"playSpinAnimation"),Nb.prototype),r(Nb.prototype,"stopAnimation",[Db],Object.getOwnPropertyDescriptor(Nb.prototype,"stopAnimation"),Nb.prototype),Mb=Nb))||Mb);w._RF.pop(),w._RF.push({},"0c6a8vx5IhFvKJ5IUimm0Je","CoinTextPopup",void 0);var rw,aw,ow,sw,lw,uw,cw,pw,hw,dw,yw,fw,vw,mw,gw,bw,ww,kw,Sw=S.ccclass,Cw=S.property,Ew=q.ZERO.clone().add3f(0,-100,0),xw=q.ZERO.clone().add3f(0,100,0),Aw=Ludex.Utils.Number,Tw=(Vb=Sw("CoinTextPopup"),Wb=Cw(Y),Kb=Cw(M),jb=Ii.onlyRunInLifeCycle,Yb=Ii.onlyRunInLifeCycle,Jb=Ii.onlyRunInLifeCycleAsync,Zb=Ii.onlyRunInLifeCycleAsync,Vb(($b=r((Qb=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"label",$b,l(e)),s(e,"uiOpacity",ew,l(e)),e}return e(d,[{key:"__preload",value:function(){Ii.lazyValidateProperties(this),this.node.active=!1}},{key:"show",value:(p=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.enableNode(),this.initializePopup(t),e.next=4,this.showTextPopupAnimation(n);case 4:return e.next=6,this.hidePopup();case 6:this.disableNode();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"enableNode",value:function(){this.node.active=!0}},{key:"disableNode",value:function(){this.node.active=!1}},{key:"initializePopup",value:function(e){var t=Aw.getShortNumber(e,3);this.label.string=t,this.uiOpacity.opacity=255,this.node.setScale(.5,.5,.5),this.node.setPosition(Ew)}},{key:"hidePopup",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.setScale(q.ONE),this.node.setPosition(xw),
//! not subscribed to signal because in the case the user skipped the animation we'd still want them to see this node disappear
e.next=4,Ue.runTweenAsync(L(this.uiOpacity).to(.5,{opacity:0}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"showTextPopupAnimation",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Ue.runTweenAsync(L(this.node).to(1.5,{position:xw},{easing:"sineOut"}),t),Ue.runTweenAsync(L(this.node).to(.5,{scale:q.ONE},{easing:"backOut"}),t)]);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),d}(x)).prototype,"label",[Wb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ew=r(Qb.prototype,"uiOpacity",[Kb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Qb.prototype,"disableNode",[jb],Object.getOwnPropertyDescriptor(Qb.prototype,"disableNode"),Qb.prototype),r(Qb.prototype,"initializePopup",[Yb],Object.getOwnPropertyDescriptor(Qb.prototype,"initializePopup"),Qb.prototype),r(Qb.prototype,"hidePopup",[Jb],Object.getOwnPropertyDescriptor(Qb.prototype,"hidePopup"),Qb.prototype),r(Qb.prototype,"showTextPopupAnimation",[Zb],Object.getOwnPropertyDescriptor(Qb.prototype,"showTextPopupAnimation"),Qb.prototype),Xb=Qb))||Xb);w._RF.pop(),w._RF.push({},"8a5c3m7o41LNqGBKPo0oqf1","CoinManager",void 0);var Pw,Rw=S.ccclass,Lw=S.disallowMultiple,Iw=S.property,Ow=codex,_w=Ow.player,Dw=Ow.monitorError,Mw=999999999,Nw=10,Bw=1,zw=1,Fw=(rw=Rw("CoinManager"),aw=Ii.required(),ow=Iw(ye),sw=Ii.required(),lw=Iw(ye),uw=Ii.required(),cw=Iw(H),pw=Ii.onlyRunInLifeCycleAsync,hw=Ii.onlyRunInLifeCycleAsync,dw=Ii.onlyRunInLifeCycleAsync,yw=Ii.onlyRunInLifeCycleAsync,fw=Ii.onlyRunInLifeCycleAsync,vw=Ii.onlyRunInLifeCycleAsync,rw(mw=Lw((bw=r((gw=function(r){n(f,r);var c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=y.call.apply(y,[this].concat(i))).coins=0,s(e,"coinPrefab",bw,l(e)),s(e,"coinTextPopup",ww,l(e)),s(e,"coinAnimContainer",kw,l(e)),e.coinObjects=[],e}return e(f,[{key:"onLoad",value:function(){Ii.validateRequiredProperties(this),this.getCoinsFromPlayerData(),this.prepareCoinCollection(),this.prepareCoinTextPopup(),this.listenToCoinEvents()}},{key:"start",value:function(){this.emitCoinAmount()}},{key:"init",value:function(){this.updateCoins({coins:this.coins})}},{key:"listenToCoinEvents",value:function(){this.node.scene.on(Us.ADD_COINS,this.addCoins,this),this.node.scene.on(Us.REMOVE_COINS,this.removeCoins,this),this.node.scene.on(Us.ABORT_COIN_ANIMATION,this.abortCoinAnimation,this)}},{key:"prepareCoinCollection",value:function(){for(var e=0;e<Nw;e++){var t=he(this.coinPrefab);t.setParent(this.coinAnimContainer),t.setPosition(0,0),t.active=!1,this.coinObjects.push(t.getComponent(iw))}}},{key:"prepareCoinTextPopup",value:function(){var e=he(this.coinTextPopup);e.setParent(this.node),e.active=!1,this.coinTextPopupNode=e.getComponent(Tw)}},{key:"handleCollectionAnim",value:(d=a(o().mark((function e(t,n,i,r,a){var s,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return console.warn("No target coin container assigned to CoinManager. No coin collection animation will be played"),e.abrupt("return");case 3:if(0!==(s=this.coinObjects.slice(0,this.getShortAmount(t))).length){e.next=8;break}return console.warn("Requested coins amount is ".concat(t,". Shortened to ").concat(this.getShortAmount(t),". No coin objects was found to animate collection.")),null==Dw||Dw.sendException(new Error("Requested coins amount is ".concat(t,". Shortened to ").concat(this.getShortAmount(t),". No coin objects was found to animate collection.")),{coins:t,animatedCoins:s.length,hasCoinTextPopup:!!this.coinTextPopupNode,hasTargetContainer:!!n,coinCollectionCount:this.coinObjects.length}),e.abrupt("return");case 8:return Ve.playSound(Ji.COLLECT_STOCK_COINS),e.next=11,Promise.all([this.playCoinFlyAndexplodeAnimation(n,s,i,r,a),Ue.waitTweenAsync(i+r/2,a).then((function(){return l.animateCoinTextPopup(t,a)}))]);case 11:a.abort();case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r){return d.apply(this,arguments)})},{key:"playCoinFlyAndexplodeAnimation",value:(h=a(o().mark((function e(t,n,i,r,a){var s,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i+r,e.next=3,Promise.all([].concat(v(n.flatMap((function(e){e.node.active=!0,e.stopParticles();var n=[0,.5*Math.min(i,r)],o=ce.apply(void 0,n),s=i-o,u=r+o;return[l.animateCoinExplode(e.node,s,a),Ue.waitTweenAsync(s,a).then((function(){return l.animateCoinFlyBack(t,e,u,a)}))]}))),[Ue.waitTweenAsync(s,a).then((function(){return t.emitExplodeEffect(a)}))]));case 3:case"end":return e.stop()}}),e)}))),function(e,t,n,i,r){return h.apply(this,arguments)})},{key:"animateCoinTextPopup",value:function(e,t){return this.coinTextPopupNode.show(e,t)}},{key:"animateCoinFlyBack",value:(p=a(o().mark((function e(t,n,i,r){var a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.node.worldPosition.clone(),s=q.ZERO.clone(),l=t.getCoinIconWorldScale(),e.next=5,Ue.runTweenAsync(L(n.node).to(i,{scale:l},{onStart:function(){n.playSpinAnimationAfterDelay(0,r),n.playTrailParticles()},onUpdate:function(e,i){if(void 0!==i){var r=z.cubicIn(i),o=t.getCoinIconWorldPosition();n.node.worldPosition=q.lerp(s,a,o,r)}},onComplete:function(){n.emittingParticles.stopSystem(),n.stopAnimation(),n.hide()}}),r);case 5:return e.next=7,Ue.waitTweenAsync(1,r);case 7:n.resetDisabled();case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,i){return p.apply(this,arguments)})},{key:"animateCoinExplode",value:(c=a(o().mark((function e(t,n,i){var r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[-200,200],s=ce((r=[-200,200])[0],r[1]),l=ce(a[0],a[1]),t.setPosition(0,0,t.position.z),t.setScale(q.ZERO),u=new q(s,l,t.position.z),e.next=9,Promise.all([Ue.runTweenAsync(L(t).delay(.1*n).to(.8*n,{scale:q.ONE},{easing:"elasticOut"}),i),Ue.runTweenAsync(L(t).to(n,{position:u},{easing:"circOut"}),i)]);case 9:case"end":return e.stop()}}),e)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"getCoinsFromPlayerData",value:function(){var e=_w.getGameData();this.coins=e?e.coins:0}},{key:"getCoins",value:function(){return this.coins}},{key:"updateCoins",value:function(e){var t,n;if(this.coins>Mw&&(this.coins=Mw),e.coins!==this.coins){var i=Math.max(0,e.coins-this.coins);this.coins=e.coins,_w.setGameData({coins:this.coins});var r=e.collectionAnimation;null===(t=this.collectionAnimSignal)||void 0===t||t.abort();var a=new An;if(this.collectionAnimSignal=a,null==r||null===(n=r.signal)||void 0===n||n.chain(a),void 0===r||r.animateTextOnly)this.node.scene.emit(Us.COIN_CHANGED,u(u({},e),{},{collectionAnimation:{animateTextOnly:!0,signal:null==r?void 0:r.signal}}));else{var o=r.floatDuration,s=void 0===o?Bw:o,l=r.flyDuration,c=void 0===l?zw:l,p=r.target,h=void 0===p?this.targetContainer:p;this.collectionAnimSignal=a,this.targetContainer=h;var d=u(u({},e),{},{collectionAnimation:{floatDuration:s,flyDuration:c,animateTextOnly:!1,signal:a,target:h}});this.node.scene.emit(Us.COIN_CHANGED,d),this.handleCollectionAnim(i,this.targetContainer,s,c,a)}}}},{key:"addCoins",value:function(e){this.updateCoins(u(u({},e),{},{coins:this.coins+e.coins}))}},{key:"removeCoins",value:function(e){this.coins<e.coins?this.node.scene.emit(Us.REMOVE_COINS_FAILED):(this.updateCoins(u(u({},e),{},{coins:this.coins-e.coins})),this.node.scene.emit(Us.REMOVE_COINS_SUCCESS))}},{key:"emitCoinAmount",value:function(){this.node.scene.emit(Us.COIN_CHANGED,{coins:this.coins})}},{key:"getShortAmount",value:function(e){return Math.min(e,Nw)}},{key:"abortCoinAnimation",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}},{key:"untilFinishesCollectAnim",value:function(){return void 0===this.collectionAnimSignal?Promise.resolve():this.collectionAnimSignal.untilAborted()}},{key:"setTargetContainer",value:function(e){this.targetContainer=e}},{key:"getTargetContainer",value:function(){return this.targetContainer}},{key:"onDestroy",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}}]),f}(x)).prototype,"coinPrefab",[aw,ow],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ww=r(gw.prototype,"coinTextPopup",[sw,lw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kw=r(gw.prototype,"coinAnimContainer",[uw,cw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(gw.prototype,"handleCollectionAnim",[pw],Object.getOwnPropertyDescriptor(gw.prototype,"handleCollectionAnim"),gw.prototype),r(gw.prototype,"playCoinFlyAndexplodeAnimation",[hw],Object.getOwnPropertyDescriptor(gw.prototype,"playCoinFlyAndexplodeAnimation"),gw.prototype),r(gw.prototype,"animateCoinTextPopup",[dw],Object.getOwnPropertyDescriptor(gw.prototype,"animateCoinTextPopup"),gw.prototype),r(gw.prototype,"animateCoinFlyBack",[yw],Object.getOwnPropertyDescriptor(gw.prototype,"animateCoinFlyBack"),gw.prototype),r(gw.prototype,"animateCoinExplode",[fw],Object.getOwnPropertyDescriptor(gw.prototype,"animateCoinExplode"),gw.prototype),r(gw.prototype,"untilFinishesCollectAnim",[vw],Object.getOwnPropertyDescriptor(gw.prototype,"untilFinishesCollectAnim"),gw.prototype),mw=gw))||mw)||mw);w._RF.pop(),w._RF.push({},"3afb9sM0KZKyod8UtofqZYu","ComboManager",void 0);var Uw,Gw,Hw,qw,Vw,Ww,Kw,jw,Yw,Jw,Zw,Xw=S.ccclass,Qw=[Ji.COMBO_1,Ji.COMBO_2,Ji.COMBO_3,Ji.COMBO_4,Ji.COMBO_5,Ji.COMBO_6,Ji.COMBO_7,Ji.COMBO_8,Ji.COMBO_9,Ji.COMBO_10,Ji.COMBO_11,Ji.COMBO_12,Ji.COMBO_13],$w=Xw("ComboManager")(Pw=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"init",value:function(){this.currentCombo=0,this.setEmitEvent(!0),this.node.scene.on(Us.COMBO_ENDED,this.resetCombo,this),this.node.scene.on(Us.GAME_FINISH,this.resetCombo,this),this.node.scene.on(Us.GAME_REPLAY,this.resetCombo,this),this.node.scene.on(Us.NEXT_LEVEL,this.resetCombo,this),this.node.scene.on(Us.ADD_COMBO,this.addCombo,this)}},{key:"addCombo",value:function(){this.setCombo(this.currentCombo+1)}},{key:"resetCombo",value:function(){this.setCombo(0)}},{key:"getCombo",value:function(){return this.currentCombo}},{key:"setCombo",value:function(e){if(this.currentCombo=e,e>0){var t=Math.min(e-1,Qw.length-1);Ve.playSound(Qw[t]),this.vibrate(e)}this.emitEvent&&this.node.scene.emit(Us.COMBO_UPDATED,e)}},{key:"vibrate",value:function(e){var t;null===(t=re("Vibrate"))||void 0===t||null===(t=t.getComponent(xd))||void 0===t||t.vibrate(Math.min(20+20*e,220))}},{key:"setEmitEvent",value:function(e){this.emitEvent=e}}]),o}(x))||Pw;w._RF.pop(),w._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var ek=S.ccclass,tk=S.property,nk=(Uw=ek("Burst"),Gw=tk(P),Hw=tk(T),qw=tk(P),Vw=tk(T),Uw((jw=r((Kw=function(){function n(){t(this,n),s(this,"time",jw,this),s(this,"repeatCount",Yw,this),s(this,"repeatInterval",Jw,this),s(this,"count",Zw,this),this.remainingCount=0,this.curTime=0}return e(n,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=fe(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=fe(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),n}()).prototype,"time",[Gw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Yw=r(Kw.prototype,"repeatCount",[Hw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Jw=r(Kw.prototype,"repeatInterval",[qw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Zw=r(Kw.prototype,"count",[Vw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ww=Kw))||Ww);w._RF.pop(),w._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var ik,rk,ak,ok,sk,lk,uk,ck,pk,hk,dk,yk,fk,vk,mk,gk,bk,wk=new q(0,0,0),kk=function(){function n(){t(this,n),this.pos=new q(0,0,0),this.color=new j(255,255,255,255),this.size=new q(0,0,0),this.startSize=new q(0,0,0),this.rotation=new q(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new q(0,0),this.width=0,this.height=0}return e(n,[{key:"init",value:function(){this.pos.set(wk),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(wk),this.startColor=j.WHITE.clone(),this.velocity.set(wk),this.randomSeed=0}}]),n}(),Sk=new(function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"get",value:function(){return this._get()||new kk}}]),o}(ve.Pool))((function(e){e.pos.set(wk),e.color._val=4294967295,e.size.set(wk),e.rotation.set(wk)}),1024),Ck=function(){function n(e){t(this,n),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new ge,this.sys=e,this.particles=[],this.active=!1,this.uvFilled=0}return e(n,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;Sk.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=Sk.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var r=i.uv,a=e?0:this.uvFilled,o=this.particles.length,s=a;s<o;s++){var l=9*s*4;n[l+3]=r[0],n[l+4]=r[1],n[l+12]=r[2],n[l+13]=r[3],n[l+21]=r[4],n[l+22]=r[5],n[l+30]=r[6],n[l+31]=r[7]}this.uvFilled=o}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var r=n.vData,a=t.x,o=t.y,s=t.z,l=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,p=e.rotation.y||0,h=e.rotation.z||0;if(0===c&&0===p&&0===h)r[i]=a-l,r[i+1]=o-u,r[i+2]=s,r[i+9]=a+l,r[i+10]=o-u,r[i+11]=s,r[i+18]=a-l,r[i+19]=o+u,r[i+20]=s,r[i+27]=a+l,r[i+28]=o+u,r[i+29]=s;else{var d=-me.degreesToRadians(c),y=-me.degreesToRadians(p),f=-me.degreesToRadians(h),v=Math.cos(d),m=Math.sin(d),g=Math.cos(y),b=Math.sin(y),w=Math.cos(f),k=Math.sin(f);function S(e,t,n){var i=t*v-n*m,r=t*m+n*v,a=e*g+r*b;return new q(a*w-i*k,a*k+i*w,r*g-e*b)}var C=[S(-l,-u,0),S(l,-u,0),S(-l,u,0),S(l,u,0)];r[i]=C[0].x+a,r[i+1]=C[0].y+o,r[i+2]=C[0].z+s,r[i+9]=C[1].x+a,r[i+10]=C[1].y+o,r[i+11]=C[1].z+s,r[i+18]=C[2].x+a,r[i+19]=C[2].y+o,r[i+20]=C[2].z+s,r[i+27]=C[3].x+a,r[i+28]=C[3].y+o,r[i+29]=C[3].z+s}j.toArray(r,e.color,i+5),j.toArray(r,e.color,i+14),j.toArray(r,e.color,i+23),j.toArray(r,e.color,i+32)}},{key:"step",value:function(e){var t=this.sys.node,n=this.particles;t.updateWorldTransform(),this.active&&this.sys.emitting(e);var i=this.renderData,r=n.length;i.reset(),this.requestData(4*r,6*r),r>this.uvFilled&&this.updateUVs();for(var a=0;a<n.length;){var o=n[a];if(o)if(o.remainingLifetime-=e,o.remainingLifetime>0){var s=9*a*4;this.updateParticleBuffer(o,o.pos,i,s),++a}else{var l=n[a];a!==n.length-1&&(n[a]=n[n.length-1]),Sk.put(l),n.length--,i.resize(i.vertexCount-4,i.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,i.setRenderDrawInfoAttributes()}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,r=this.renderData.iData,a=n;a<i;a++){var o=4*a;r[n++]=o,r[n++]=o+1,r[n++]=o+2,r[n++]=o+1,r[n++]=o+3,r[n++]=o+2}}},{key:"initDrawInfo",value:function(){this.renderData.setRenderDrawInfoAttributes()}}]),n}();w._RF.pop(),w._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var Ek,xk,Ak,Tk,Pk,Rk,Lk,Ik,Ok,_k,Dk,Mk,Nk,Bk,zk,Fk,Uk,Gk=S.ccclass,Hk=S.property,qk=B({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),Vk=(ik=Gk("CurveRange"),rk=Hk({type:B(qk)}),ak=Hk({visible:function(){return this.mode===qk.Constant}}),ok=Hk({visible:function(){return this.mode===qk.Curve}}),sk=Hk({visible:function(){return this.mode===qk.TwoCurves}}),lk=Hk({visible:function(){return this.mode===qk.TwoCurves}}),uk=Hk({visible:function(){return this.mode===qk.TwoConstants}}),ck=Hk({visible:function(){return this.mode===qk.TwoConstants}}),ik((dk=r((hk=function(){function n(){t(this,n),s(this,"mode",dk,this),s(this,"constant",yk,this),s(this,"spline",fk,this),s(this,"splineMin",vk,this),s(this,"splineMax",mk,this),s(this,"constantMin",gk,this),s(this,"constantMax",bk,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case qk.Curve:return this.spline.evaluate(e);case qk.TwoCurves:return be(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case qk.TwoConstants:return be(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case qk.Curve:return 1;case qk.TwoConstants:return this.constantMax;case qk.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case qk.Curve:return we(1,0,ke);case qk.TwoConstants:return we(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,ke);case qk.TwoCurves:return we(1,0,ke);default:return we(this.constant,0,ke)}}}]),n}()).prototype,"mode",[rk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return qk.Constant}}),yk=r(hk.prototype,"constant",[ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),fk=r(hk.prototype,"spline",[ok],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Se}}),vk=r(hk.prototype,"splineMin",[sk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Se}}),mk=r(hk.prototype,"splineMax",[lk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Se}}),gk=r(hk.prototype,"constantMin",[uk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),bk=r(hk.prototype,"constantMax",[ck],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pk=hk))||pk);w._RF.pop(),w._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var Wk=S.ccclass,Kk=S.property,jk=B({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),Yk=new j,Jk=new j,Zk=(Ek=Wk("GradientRange"),xk=Kk({type:B(jk)}),Ak=Kk({visible:function(){return this.mode===jk.Color}}),Tk=Kk({visible:function(){return this.mode===jk.TwoColors}}),Pk=Kk({visible:function(){return this.mode===jk.TwoColors}}),Rk=Kk({visible:function(){return this.mode===jk.Gradient||this.mode===jk.RandomColor}}),Lk=Kk({visible:function(){return this.mode===jk.TwoGradients}}),Ik=Kk({visible:function(){return this.mode===jk.TwoGradients}}),Ek((Dk=r((_k=function(){function n(){t(this,n),s(this,"mode",Dk,this),s(this,"color",Mk,this),s(this,"colorMin",Nk,this),s(this,"colorMax",Bk,this),s(this,"gradient",zk,this),s(this,"gradientMin",Fk,this),s(this,"gradientMax",Uk,this),this._color=j.WHITE.clone()}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case jk.Color:return this.color;case jk.TwoColors:return j.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case jk.RandomColor:return this.gradient.getRandomColor(this._color);case jk.Gradient:return this.gradient.evaluateFast(this._color,e);case jk.TwoGradients:return j.lerp(this._color,this.gradientMin.evaluateFast(Yk,e),this.gradientMax.evaluateFast(Jk,e),t),this._color;default:return this.color}}}]),n}()).prototype,"mode",[xk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return jk.Color}}),Mk=r(_k.prototype,"color",[Ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.WHITE.clone()}}),Nk=r(_k.prototype,"colorMin",[Tk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.WHITE.clone()}}),Bk=r(_k.prototype,"colorMax",[Pk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.WHITE.clone()}}),zk=r(_k.prototype,"gradient",[Rk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),Fk=r(_k.prototype,"gradientMin",[Lk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),Uk=r(_k.prototype,"gradientMax",[Ik],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),Ok=_k))||Ok);function Xk(e,t,n,i){!function(e,t){ne.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,q.multiplyScalar(e,e,t+(n-t)*xe())}function Qk(e){var t=qk;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}w._RF.pop(),w._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),w._RF.pop(),w._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var $k,eS,tS,nS,iS,rS,aS,oS=23541,sS=39825,lS=91041,uS=125292,cS=197866,pS=156497;w._RF.pop(),w._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var hS,dS,yS,fS,vS,mS,gS,bS,wS,kS=S.ccclass,SS=S.property,CS=lS,ES=($k=kS("ColorOvertimeModule"),eS=SS({type:W}),tS=SS({type:Zk}),$k((rS=r((iS=function(){function n(){t(this,n),s(this,"enable",rS,this),s(this,"color",aS,this)}return e(n,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=jk;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?pe(e.randomSeed+CS):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),n}()).prototype,"enable",[eS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aS=r(iS.prototype,"color",[tS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Zk}}),nS=iS))||nS);w._RF.pop(),w._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var xS,AS,TS,PS,RS,LS,IS,OS,_S,DS,MS,NS,BS,zS=S.ccclass,FS=S.property,US=oS,GS=(hS=zS("LimitVelocityOvertimeModule"),dS=FS({type:W}),yS=FS({type:Vk}),fS=FS({type:Vk}),hS((gS=r((mS=function(){function n(){t(this,n),s(this,"enable",gS,this),s(this,"limit",bS,this),s(this,"dampen",wS,this),this.limit.constant=500,this.dampen.constant=.2}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),r=Qk(this.limit)?pe(e.randomSeed+US):0,a=Qk(this.dampen)?pe(e.randomSeed+US+1):0,o=e.velocity.length(),s=this.limit.evaluate(n,r),l=this.dampen.evaluate(n,a);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(o,s,l,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var r=1-Math.exp(-n*i);return $.lerp(e,t,r)}}]),n}()).prototype,"enable",[dS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bS=r(mS.prototype,"limit",[yS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),wS=r(mS.prototype,"dampen",[fS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),vS=mS))||vS);w._RF.pop(),w._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var HS,qS,VS,WS,KS,jS,YS,JS,ZS,XS,QS,$S,eC,tC,nC,iC,rC,aC,oC,sC,lC,uC,cC,pC=S.ccclass,hC=S.property,dC=uS,yC=(xS=pC("RotationOvertimeModule"),AS=hC({type:W}),TS=hC(W),PS=hC({type:Vk,visible:function(){return this.separateAxes}}),RS=hC({type:Vk,visible:function(){return this.separateAxes}}),LS=hC({type:Vk}),xS((_S=r((OS=function(){function n(){t(this,n),s(this,"enable",_S,this),s(this,"separateAxes",DS,this),s(this,"x",MS,this),s(this,"y",NS,this),s(this,"z",BS,this)}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+dC,r=Qk(this.z)?pe(i):0,a=this.z.evaluate(n,r)*t,o=0,s=0;if(this.separateAxes){var l=Qk(this.x)?pe(i):0,u=Qk(this.y)?pe(i):0;o=this.x.evaluate(n,l)*t,s=this.y.evaluate(n,u)*t}e.rotation.add3f(o,s,a)}}}]),n}()).prototype,"enable",[AS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DS=r(OS.prototype,"separateAxes",[TS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),MS=r(OS.prototype,"x",[PS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),NS=r(OS.prototype,"y",[RS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),BS=r(OS.prototype,"z",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),IS=OS))||IS);w._RF.pop(),w._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var fC,vC,mC,gC,bC,wC,kC,SC,CC,EC,xC,AC,TC,PC=S.ccclass,RC=S.property,LC=B({Circle:0,Rectangle:1}),IC=B({Base:0,Edge:1}),OC=function(){return this.shape===LC.Circle},_C=function(){return this.shape===LC.Rectangle},DC=[0,0],MC=(HS=PC("ShapeModule"),qS=RC({type:B(LC)}),VS=RC({type:B(IC),visible:_C}),WS=RC({}),KS=RC({}),jS=RC({}),YS=RC({range:[0,360],visible:OC}),JS=RC({range:[-360,360],visible:OC}),ZS=RC({min:0,visible:OC}),XS=RC({range:[0,1],step:.01,visible:OC}),QS=RC({visible:_C}),HS((tC=r((eC=function(){function n(){t(this,n),s(this,"shape",tC,this),s(this,"emitFrom",nC,this),s(this,"position",iC,this),s(this,"rotation",rC,this),s(this,"scale",aC,this),s(this,"arc",oC,this),s(this,"angle",sC,this),s(this,"radius",lC,this),s(this,"radiusThickness",uC,this),s(this,"rectangleThickness",cC,this)}return e(n,[{key:"emit",value:function(e){switch(this.shape){case LC.Circle:this.circleEmit(this.radius,this.radiusThickness,Ae(this.generateArcAngle()),e);break;case LC.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var r=i.pos;Xk(r,e*(1-t),e,n+Ae(this.angle)),i.velocity=r.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,r,a,o=n.pos;switch(e){case IC.Base:r=o,a=t,ne.set(r,ce(-a.x,a.x),ce(-a.y,a.y));break;case IC.Edge:DC[0]=ce(-1,1),DC[1]=(0===(i=ce(-1,1))&&i++,Ee.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+oe(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(DC),this.applyRectThickness(DC,t),ne.set(o,DC[0],DC[1])}n.velocity=o.clone().normalize()}},{key:"generateArcAngle",value:function(){return ce(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case LC.Circle:this.gizmoCircle(e);break;case LC.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(Ae(this.angle)),r=this.radius*Math.sin(Ae(this.angle)),a=this.radius*Math.cos(Ae(this.arc+this.angle)),o=this.radius*Math.sin(Ae(this.arc+this.angle));e.moveTo(i,r),e.lineTo(0,0),e.moveTo(a,o),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var r=(i-n)/48,a=0;a<=48;a++){var o=n+a*r,s=t*Math.cos(Ae(o)),l=t*Math.sin(Ae(o));0===a?e.moveTo(s,l):e.lineTo(s,l)}}}]),n}()).prototype,"shape",[qS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return LC.Circle}}),nC=r(eC.prototype,"emitFrom",[VS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return IC.Base}}),iC=r(eC.prototype,"position",[WS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(0,0,0)}}),rC=r(eC.prototype,"rotation",[KS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(0,0,0)}}),aC=r(eC.prototype,"scale",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(1,1,1)}}),oC=r(eC.prototype,"arc",[YS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),sC=r(eC.prototype,"angle",[JS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),lC=r(eC.prototype,"radius",[ZS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),uC=r(eC.prototype,"radiusThickness",[XS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),cC=r(eC.prototype,"rectangleThickness",[QS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ne(20,50)}}),$S=eC))||$S);w._RF.pop(),w._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var NC,BC,zC,FC,UC,GC,HC,qC,VC,WC=S.ccclass,KC=S.property,jC=sS,YC=(fC=WC("SizeOvertimeModule"),vC=KC({type:W}),mC=KC(W),gC=KC({type:Vk,visible:function(){return!this.separateAxes}}),bC=KC({type:Vk,visible:function(){return this.separateAxes}}),wC=KC({type:Vk,visible:function(){return this.separateAxes}}),fC((CC=r((SC=function(){function n(){t(this,n),s(this,"enable",CC,this),s(this,"separateAxes",EC,this),s(this,"size",xC,this),s(this,"x",AC,this),s(this,"y",TC,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return e(n,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+jC;if(this.separateAxes){var i=Qk(this.x)?pe(n):0,r=Qk(this.y)?pe(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,r)}else{var a=Qk(this.size)?pe(n):0,o=this.size.evaluate(t,a);q.multiplyScalar(e.size,e.startSize,o)}}}}]),n}()).prototype,"enable",[vC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EC=r(SC.prototype,"separateAxes",[mC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xC=r(SC.prototype,"size",[gC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),AC=r(SC.prototype,"x",[bC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),TC=r(SC.prototype,"y",[wC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),kC=SC))||kC);w._RF.pop(),w._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var JC,ZC,XC,QC,$C,eE,tE,nE,iE,rE,aE,oE,sE,lE,uE,cE,pE,hE,dE,yE,fE,vE,mE,gE,bE,wE,kE,SE,CE,EE,xE,AE,TE,PE,RE,LE,IE,OE,_E,DE,ME,NE,BE,zE,FE,UE,GE,HE,qE,VE,WE,KE,jE,YE,JE,ZE,XE,QE,$E,ex,tx,nx=S.ccclass,ix=S.property,rx=(NC=nx("VelocityOvertimeModule"),BC=ix({type:W}),zC=ix({type:Vk}),FC=ix({type:Vk}),NC((HC=r((GC=function(){function n(){t(this,n),s(this,"enable",HC,this),s(this,"x",qC,this),s(this,"y",VC,this),this._temp_v3=new q,this.x.constant=0,this.y.constant=0}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=Qk(this.x)?pe(e.randomSeed+cS):0,r=Qk(this.y)?pe(e.randomSeed+pS):0,a=q.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,r),0);e.velocity.add(a.multiplyScalar(t))}}}]),n}()).prototype,"enable",[BC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qC=r(GC.prototype,"x",[zC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),VC=r(GC.prototype,"y",[FC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),UC=GC))||UC);w._RF.pop(),w._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var ax,ox,sx,lx,ux,cx,px,hx,dx,yx,fx,vx,mx=S.ccclass,gx=S.property,bx=S.executeInEditMode,wx=S.disallowMultiple,kx=S.playOnFocus,Sx=Te.Attr.setClassAttr,Cx=B({World:0,Local:1}),Ex=(JC=mx("ParticleSystem"),ZC=bx(!0),XC=wx(!0),QC=kx(!0),$C=gx({}),eE=gx({formerlySerializedAs:"preview"}),tE=gx(W),nE=gx({type:B(Cx)}),iE=gx({formerlySerializedAs:"simulationSpace"}),rE=gx(P),aE=gx(W),oE=gx({type:Vk}),sE=gx({type:Vk}),lE=gx(Zk),uE=gx(W),cE=gx({type:Vk,formerlySerializedAs:"startSize"}),pE=gx({type:Vk,visible:function(){return this.startSize2D}}),hE=gx({type:Vk}),dE=gx(W),yE=gx({type:Vk,visible:function(){return this.startRotation3D}}),fE=gx({type:Vk,visible:function(){return this.startRotation3D}}),vE=gx({type:Vk,formerlySerializedAs:"startRotation"}),mE=gx({type:Vk}),gE=gx({type:Vk}),bE=gx({type:MC}),wE=gx({type:rx}),kE=gx({type:YC}),SE=gx({type:yC}),CE=gx({type:ES}),EE=gx({type:GS}),xE=gx(nk),AE=gx({serializable:!0}),TE=gx({type:se}),JC(PE=ZC(PE=XC(PE=QC((r((RE=function(r){n(o,r);var a=i(o);function o(){var e;return t(this,o),e=a.call(this),s(e,"_preview",LE,l(e)),s(e,"playOnAwake",IE,l(e)),s(e,"_simulationSpace",OE,l(e)),s(e,"duration",_E,l(e)),s(e,"loop",DE,l(e)),s(e,"startDelay",ME,l(e)),s(e,"startLifetime",NE,l(e)),s(e,"startColor",BE,l(e)),s(e,"startSize2D",zE,l(e)),s(e,"startSizeX",FE,l(e)),s(e,"startSizeY",UE,l(e)),s(e,"startSpeed",GE,l(e)),s(e,"startRotation3D",HE,l(e)),s(e,"startRotationX",qE,l(e)),s(e,"startRotationY",VE,l(e)),s(e,"startRotationZ",WE,l(e)),s(e,"gravityModifier",KE,l(e)),s(e,"rateOverTime",jE,l(e)),s(e,"shapeModule",YE,l(e)),s(e,"velocityOvertimeModule",JE,l(e)),s(e,"sizeOvertimeModule",ZE,l(e)),s(e,"rotationOvertimeModule",XE,l(e)),s(e,"colorOvertimeModule",QE,l(e)),s(e,"limitVelocityOvertimeModule",$E,l(e)),s(e,"bursts",ex,l(e)),s(e,"_spriteFrame",tx,l(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return e(o,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){p(h(o.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){p(h(o.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new Ck(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){p(h(o.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new q(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e,t=Q.Assembler.getAssembler(this);if(this._assembler!==t&&(this._assembler=t),null!==(e=this._assembler)&&void 0!==e&&e.createData){var n=this._simulator,i=n.renderData;i||(i=n.renderData=this._assembler.createData(this),n.uvFilled=0,i.particleInitRenderDrawInfo(this.renderEntity),n.initDrawInfo())}}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===Cx.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return p(h(o.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===Cx.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===Cx.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){var e;"function"==typeof(null===(e=this._renderEntity)||void 0===e?void 0:e.setRenderTransform)&&(this.simulationSpace===Cx.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===Cx.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1)))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var r,a=c(this.bursts);try{for(a.s();!(r=a.n()).done;){r.value.update(this,e)}}catch(e){a.e(e)}finally{a.f()}}var o=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,o),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var r=this._simulator.emitParticle();if(r.init(),this.shapeModule.emit(r),this.simulationSpace===Cx.World){var a=this.node.worldMatrix;r.pos.x+=a.m12,r.pos.y+=a.m13}var o=this.startSpeed.evaluate(n,this.rand());r.velocity.multiplyScalar(o),r.width=this.spriteFrame.width,r.height=this.spriteFrame.height;var s=this.startSizeX.evaluate(n,this.rand()),l=this.startSize2D?new q(s,this.startSizeY.evaluate(n,this.rand()),1):new q(s,s,1);r.startSize=l.clone(),r.size=l.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new q(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new q(0,0,u);r.rotation=c,r.startColor=this.startColor.evaluate(n,this.rand()).clone(),r.color=r.startColor.clone(),r.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,r.remainingLifetime=r.startLifetime,r.randomSeed=oe(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new q(0,-9.8*t,0))}},{key:"rand",value:function(){return pe(oe(0,Ee.INT_MAX))}}]),o}(Pe)).prototype,"preview",[$C],Object.getOwnPropertyDescriptor(RE.prototype,"preview"),RE.prototype),LE=r(RE.prototype,"_preview",[eE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),IE=r(RE.prototype,"playOnAwake",[tE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),r(RE.prototype,"simulationSpace",[nE],Object.getOwnPropertyDescriptor(RE.prototype,"simulationSpace"),RE.prototype),OE=r(RE.prototype,"_simulationSpace",[iE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Cx.Local}}),_E=r(RE.prototype,"duration",[rE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),DE=r(RE.prototype,"loop",[aE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ME=r(RE.prototype,"startDelay",[oE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),NE=r(RE.prototype,"startLifetime",[sE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),BE=r(RE.prototype,"startColor",[lE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Zk}}),zE=r(RE.prototype,"startSize2D",[uE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),FE=r(RE.prototype,"startSizeX",[cE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),UE=r(RE.prototype,"startSizeY",[pE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),GE=r(RE.prototype,"startSpeed",[hE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),HE=r(RE.prototype,"startRotation3D",[dE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qE=r(RE.prototype,"startRotationX",[yE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),VE=r(RE.prototype,"startRotationY",[fE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),WE=r(RE.prototype,"startRotationZ",[vE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),KE=r(RE.prototype,"gravityModifier",[mE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),jE=r(RE.prototype,"rateOverTime",[gE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Vk}}),YE=r(RE.prototype,"shapeModule",[bE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new MC}}),JE=r(RE.prototype,"velocityOvertimeModule",[wE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new rx}}),ZE=r(RE.prototype,"sizeOvertimeModule",[kE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new YC}}),XE=r(RE.prototype,"rotationOvertimeModule",[SE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yC}}),QE=r(RE.prototype,"colorOvertimeModule",[CE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ES}}),$E=r(RE.prototype,"limitVelocityOvertimeModule",[EE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new GS}}),ex=r(RE.prototype,"bursts",[gx,xE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tx=r(RE.prototype,"_spriteFrame",[AE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r(RE.prototype,"spriteFrame",[TE],Object.getOwnPropertyDescriptor(RE.prototype,"spriteFrame"),RE.prototype),PE=RE))||PE)||PE)||PE)||PE);Sx(Ex,"color","visible",!1),w._RF.pop(),w._RF.push({},"91e6dGDvN1FKLi7g/JQPwl8","ItemCollectionFX",void 0);var xx,Ax,Tx,Px,Rx,Lx,Ix,Ox,_x,Dx,Mx,Nx,Bx,zx,Fx,Ux,Gx,Hx,qx,Vx,Wx,Kx=S.ccclass,jx=S.property,Yx=(ax=Kx("ItemCollectionFX"),ox=Ii.required,sx=jx(N),lx=Ii.required,ux=jx(H),cx=Ii.required,px=jx(H),ax((yx=r((dx=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"sprite",yx,l(e)),s(e,"standardParticlesContainer",fx,l(e)),s(e,"quickParticlesContainer",vx,l(e)),e.standardParticles=[],e.quickParticles=[],e}return e(o,[{key:"__preload",value:function(){this.standardParticles=this.standardParticlesContainer.getComponentsInChildren(Ex),this.quickParticles=this.quickParticlesContainer.getComponentsInChildren(Ex),Ii.validateRequiredProperties(this,o)}},{key:"onDisable",value:function(){this.standardParticlesContainer.active=!1,this.quickParticlesContainer.active=!1}},{key:"playExplosionParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?(this.quickParticlesContainer.active=!0,this.playParticles(this.quickParticles)):(this.standardParticlesContainer.active=!0,this.playParticles(this.standardParticles))}},{key:"playParticles",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){t.value.play()}}catch(e){n.e(e)}finally{n.f()}}}]),o}(x)).prototype,"sprite",[ox,sx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fx=r(dx.prototype,"standardParticlesContainer",[lx,ux],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vx=r(dx.prototype,"quickParticlesContainer",[cx,px],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hx=dx))||hx);w._RF.pop(),w._RF.push({},"a7ff8uVnP1G3ppM9F/A5DYq","Cloud",void 0);var Jx=S.ccclass,Zx=S.property,Xx=new q(0,300),Qx=(xx=Jx("Cloud"),Ax=Ii.required,Tx=Zx(le),Px=Ii.required,Rx=Zx({type:H,group:"Ray"}),Lx=Ii.required,Ix=Zx({type:ye,group:"Ray"}),Ox=Ii.required,_x=Ii.required,Dx=Zx({type:ye,group:"Ray"}),Mx=Ii.required,Nx=Ii.onlyRunInLifeCycleAsync,Bx=Ii.onlyRunInLifeCycleAsync,xx((Ux=r((Fx=function(r){n(f,r);var u,c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"animation",Ux,l(e)),s(e,"raysContainer",Gx,l(e)),s(e,"rayPrefab",Hx,l(e)),s(e,"rayPool",qx,l(e)),s(e,"oldRayPrefab",Vx,l(e)),s(e,"oldRayPool",Wx,l(e)),e.cacheDirectionVector=new q,e.canvas=null,e.isSupportShade=!1,e}return e(f,[{key:"onLoad",value:function(){this.isSupportShade=this.checkSupportShade(),this.isSupportShade&&(this.rayPool=new zg(this.createRay.bind(this),2,this.allocRay.bind(this),this.freeRay.bind(this),this.destroyRay.bind(this)),this.oldRayPool=new zg(this.createOldRay.bind(this),2,this.allocOldRay.bind(this),this.freeOldRay.bind(this),this.destroyOldRay.bind(this))),Ii.validateRequiredProperties(this,f)}},{key:"checkSupportShade",value:function(){var e,t,n=(null!==(e=null===(t=E.root)||void 0===t?void 0:t.device)&&void 0!==e?e:{}).gfxAPI;return!!n&&n!==Re.API.WEBGL}},{key:"createRay",value:function(){var e=he(this.rayPrefab);e.active=!1,this.raysContainer.addChild(e);var t=e.getComponent(A),n=e.getComponent(le);if(!t||!n)throw new Error("Cloud.createRay: Invalid prefab");return{node:e,uiTransform:t,animation:n}}},{key:"allocRay",value:function(e){e.node.active=!0}},{key:"freeRay",value:function(e){e.node.active=!1}},{key:"destroyRay",value:function(e){e.node.isValid&&e.node.destroy()}},{key:"createOldRay",value:function(){var e=he(this.oldRayPrefab);e.active=!1,this.raysContainer.addChild(e);var t=e.getComponent(A);if(!t)throw new Error("Cloud.createOldRay: Invalid prefab");return{node:e,uiTransform:t}}},{key:"allocOldRay",value:function(e){e.node.active=!0}},{key:"freeOldRay",value:function(e){e.node.active=!1}},{key:"destroyOldRay",value:function(e){e.node.isValid&&e.node.destroy()}},{key:"playLightningAnimation",value:(d=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.rayPool){e.next=4;break}return e.next=3,this.playOldLightningAnimation(t);case 3:return e.abrupt("return");case 4:return n=this.rayPool.alloc(),i=n.node,r=n.uiTransform,a=n.animation,i.setWorldPosition(this.node.worldPosition),this.cacheDirectionVector.set(t),this.cacheDirectionVector.subtract(i.worldPosition),s=Math.atan2(this.cacheDirectionVector.y,this.cacheDirectionVector.x)*(180/Math.PI)+180-90,l=this.cacheDirectionVector.length(),u=r.height,c=l/u,i.setWorldScale(c<1?c:1,c,1),i.angle=s,p=[Ue.runAnimationAsync(this.animation)],e.next=20,Ue.waitTweenAsync(.2);case 20:return p.push(Ue.runAnimationAsync(a)),e.next=23,Promise.all(p);case 23:this.rayPool.free(n);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"playOldLightningAnimation",value:(h=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.oldRayPool){e.next=2;break}return e.abrupt("return");case 2:return n=this.oldRayPool.alloc(),i=n.node,r=n.uiTransform,i.setWorldPosition(this.node.worldPosition),this.cacheDirectionVector.set(t),this.cacheDirectionVector.subtract(i.worldPosition),a=Math.atan2(this.cacheDirectionVector.y,this.cacheDirectionVector.x)*(180/Math.PI)+180,s=this.cacheDirectionVector.length(),r.width=s/this.node.worldScale.x,i.angle=a,Ue.runAnimationAsync(this.animation),e.next=15,Ue.waitTweenAsync(.2);case 15:this.oldRayPool.free(n);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"moveToScreen",value:(p=a(o().mark((function e(t,n){var i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvas=null!==(i=null!==(r=this.canvas)&&void 0!==r?r:null===(a=re("Canvas"))||void 0===a?void 0:a.getComponent(A))&&void 0!==i?i:null,this.canvas){e.next=3;break}return e.abrupt("return");case 3:return s=this.canvas.width,l="left"===n?-300:s+300,u=L(this.node).set({worldPosition:new q(l,t.y)}).to(.6,{worldPosition:t},{easing:"quadOut"}),c=t.y<this.canvas.height/2?1.2:1.7-t.y/this.canvas.height,p=L(this.node).set({scale:new q(1.1*c,.9*c,1)}).to(.6,{scale:new q(c,c,1)},{easing:"quadIn"}),e.next=10,Promise.all([Ue.runTweenAsync(u),Ue.runTweenAsync(p)]);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"moveOutScreen",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvas=null!==(n=null!==(i=this.canvas)&&void 0!==i?i:null===(r=re("Canvas"))||void 0===r?void 0:r.getComponent(A))&&void 0!==n?n:null,this.canvas){e.next=3;break}return e.abrupt("return");case 3:return a=this.canvas,s=a.width,l=a.height,u=new q("left"===t?-s/2-300:s/2+300,this.node.position.y),c=L(this.node).to(.6,{position:u},{easing:"quadIn"}),e.next=9,Ue.runTweenAsync(c);case 9:this.node.position=new q(0,-l/2-500);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"moveToScreenCenter",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvas=null!==(t=null!==(n=this.canvas)&&void 0!==n?n:null===(i=re("Canvas"))||void 0===i?void 0:i.getComponent(A))&&void 0!==t?t:null,this.canvas){e.next=3;break}return e.abrupt("return");case 3:r=this.canvas,a=r.width,s=r.height,l=Math.floor(4*Math.random()),u=0,c=0,e.t0=l,e.next=0===e.t0?10:1===e.t0?13:2===e.t0?16:3===e.t0?19:22;break;case 10:return u=Math.random()*a-a/2,c=s/2+300,e.abrupt("break",22);case 13:return u=Math.random()*a-a/2,c=-s/2-300,e.abrupt("break",22);case 16:return u=-a/2-300,c=Math.random()*s-s/2,e.abrupt("break",22);case 19:return u=a/2+300,c=Math.random()*s-s/2,e.abrupt("break",22);case 22:return this.node.setPosition(u,c),p=L(this.node).to(.8,{position:Xx},{easing:"quadOut"}),e.next=26,Ue.runTweenAsync(p);case 26:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),f}(x)).prototype,"animation",[Ax,Tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gx=r(Fx.prototype,"raysContainer",[Px,Rx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hx=r(Fx.prototype,"rayPrefab",[Lx,Ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qx=r(Fx.prototype,"rayPool",[Ox],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vx=r(Fx.prototype,"oldRayPrefab",[_x,Dx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wx=r(Fx.prototype,"oldRayPool",[Mx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Fx.prototype,"playLightningAnimation",[Nx],Object.getOwnPropertyDescriptor(Fx.prototype,"playLightningAnimation"),Fx.prototype),r(Fx.prototype,"playOldLightningAnimation",[Bx],Object.getOwnPropertyDescriptor(Fx.prototype,"playOldLightningAnimation"),Fx.prototype),zx=Fx))||zx);w._RF.pop(),w._RF.push({},"7df59GGBIxFo7OyHCGrEKe5","addItemEffect",void 0);var $x=new q(.8,1.2,1),eA=new q(1.2,.8,1),tA=new q(.5,.5,.5),nA=new q(.65,.65,.65),iA=function(){var e=a(o().mark((function e(t,n){var i,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.length>2&&void 0!==r[2]&&r[2],t.playExplosionParticles(i),Ve.playSound(Ji.ITEM_REWARD),!i){e.next=8;break}return e.next=6,rA(t,n);case 6:e.next=10;break;case 8:return e.next=10,oA(t,n);case 10:Ve.playSound(Ji.BUTTON_CLICK);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function rA(e,t){return aA.apply(this,arguments)}function aA(){return(aA=a(o().mark((function e(t,n){var i,r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ue.runTweenAsync(L(t.node).to(.1,{scale:$x}).to(.1,{scale:eA}).to(.1,{scale:q.ONE}).to(.3,{scale:nA})),r=t.node.worldPosition.x,a=t.node.worldPosition.y,s=new q,l=Ue.runTweenAsync(L(t.node).update(.8,(function(e,i){n.node.getWorldPosition(s);var o=z.quadOut(i),l=be(r,s.x,o),u=Math.max(a,s.y),c=be(a,u+300,.5);if(i<.5){var p=z.cubicOut(2*i),h=be(a,c,p);t.node.setWorldPosition(l,h,0)}else{var d=z.cubicIn(2*(i-.5)),y=be(c,s.y,d);t.node.setWorldPosition(l,y,0)}}))),e.next=7,Promise.all([i,l]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oA(e,t){return sA.apply(this,arguments)}function sA(){return(sA=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xA(t);case 2:return e.next=4,Ue.waitTweenAsync(.8);case 4:return e.next=6,AA(t,n);case 6:return e.next=8,TA(t,n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var lA,uA,cA,pA,hA,dA,yA,fA,vA,mA,gA,bA,wA,kA,SA,CA,EA,xA=function(e){return Ue.runTweenAsync(L(e.node).to(.1,{scale:$x}).to(.1,{scale:eA}).to(.1,{scale:q.ONE}))},AA=function(e,t){return Ue.runTweenAsync(L(e.node).to(1,{worldPosition:new q(t.node.worldPosition.x,t.node.worldPosition.y+30,t.node.worldPosition.z),scale:tA},{easing:"cubicInOut"}))},TA=function(e,t){var n=t.node.worldPosition.clone(),i=new q(n.x,n.y+70,n.z);return Ue.runTweenAsync(L(e.node).to(.3,{worldPosition:i,scale:nA},{easing:"cubicOut"}).to(.5,{worldPosition:n},{easing:"cubicIn"}))};w._RF.pop(),w._RF.push({},"da8a1SD+ahMFpc6MIdiFP5H","ShiningStar",void 0);var PA,RA,LA,IA,OA,_A=S.ccclass,DA=S.property,MA=S.disallowMultiple,NA=(lA=_A("ShiningStar"),uA=DA(N),cA=DA({serializable:!0,visible:!1}),pA=DA({type:P,displayName:"Scale up duration",min:.001}),hA=DA({serializable:!0,visible:!1}),dA=DA({type:P,displayName:"Bounce and Fall duration",min:.001}),yA=DA({serializable:!0,visible:!1}),fA=DA({type:P,displayName:"Start scale"}),vA=DA({serializable:!0,visible:!1}),mA=DA({type:P,displayName:"End scale"}),lA(gA=MA((wA=r((bA=function(r){n(m,r);var u,c,p,h,d,y,f,v=i(m);function m(){var e;t(this,m);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=v.call.apply(v,[this].concat(i)),s(e,"shine",wA,l(e)),s(e,"twScaleUpDuration",kA,l(e)),s(e,"twBounceAndFallDuration",SA,l(e)),s(e,"twStartScale",CA,l(e)),s(e,"twEndScale",EA,l(e)),e.isBeingAnimated=!1,e}return e(m,[{key:"scaleUpDuration",get:function(){return this.twScaleUpDuration},set:function(e){this.twScaleUpDuration=e}},{key:"bounceAndFallDuration",get:function(){return this.twBounceAndFallDuration},set:function(e){this.twBounceAndFallDuration=e}},{key:"startScale",get:function(){return this.twStartScale},set:function(e){this.twStartScale=e}},{key:"endScale",get:function(){return this.twEndScale},set:function(e){this.twEndScale=e}},{key:"isAvailable",get:function(){return!this.isBeingAnimated}},{key:"__preload",value:function(){this.shineOpacity=this.shine.node.getComponent(M),this.uiOpacity=this.node.getComponent(M),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0}},{key:"playAnimation",value:(f=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAvailable){e.next=2;break}throw new Error("ShiningStar: This star is being animated.");case 2:return this.isBeingAnimated=!0,e.next=5,this.animateAppear();case 5:return e.next=7,this.animateDisappear();case 7:this.isBeingAnimated=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"animateAppear",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.shineOpacity.opacity=255,e.next=3,Promise.all([this.animateFadeIn(),this.animateScaleUp()]);case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"animateDisappear",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.animateBounceAndFall(),this.animateScaleDown()]);case 2:this.node.setScale(0,0),this.uiOpacity.opacity=0;case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"animateBounceAndFall",value:(h=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.node.position.x,n=this.node.position.y,i=[60,120],r=(Math.random()*(i[1]-i[0])+i[0])*(Math.PI/180),a=t+200*Math.cos(r),s=n+200*Math.sin(r),l=n-500,u=Ue.runTweenAsync(L(this.node).to(.2*this.twBounceAndFallDuration,{position:new q(a,s,this.node.position.z)},{easing:"sineOut"}).to(.4*this.twBounceAndFallDuration,{position:new q(a,l,this.node.position.z)},{easing:"cubicIn"})),c=[0,360],p=Ue.runTweenAsync(L(this.node).to(this.twBounceAndFallDuration,{eulerAngles:new q(0,0,Math.random()*(c[1]-c[0])*(a>t?-1:1))},{easing:"sineOut"})),e.next=13,Promise.all([u,p]);case 13:this.node.eulerAngles=new q(0,0,0);case 14:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"animateFadeIn",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.max(this.scaleUpDuration/4,.01),e.next=3,Ue.runTweenAsync(L(this.uiOpacity).to(t,{opacity:255}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"animateScaleUp",value:(c=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.setScale(this.startScale,this.startScale),t=new q(this.endScale,this.endScale,1),e.next=4,Ue.runTweenAsync(L(this.node).to(this.scaleUpDuration,{scale:t},{easing:"cubicOut"}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"animateScaleDown",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new q(0,0,1),e.next=3,Ue.runTweenAsync(L(this.node).delay(.1*this.bounceAndFallDuration).to(.5*this.bounceAndFallDuration,{scale:t},{easing:"cubicIn"}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),m}(x)).prototype,"shine",[uA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kA=r(bA.prototype,"twScaleUpDuration",[cA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),r(bA.prototype,"scaleUpDuration",[pA],Object.getOwnPropertyDescriptor(bA.prototype,"scaleUpDuration"),bA.prototype),SA=r(bA.prototype,"twBounceAndFallDuration",[hA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),r(bA.prototype,"bounceAndFallDuration",[dA],Object.getOwnPropertyDescriptor(bA.prototype,"bounceAndFallDuration"),bA.prototype),CA=r(bA.prototype,"twStartScale",[yA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),r(bA.prototype,"startScale",[fA],Object.getOwnPropertyDescriptor(bA.prototype,"startScale"),bA.prototype),EA=r(bA.prototype,"twEndScale",[vA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),r(bA.prototype,"endScale",[mA],Object.getOwnPropertyDescriptor(bA.prototype,"endScale"),bA.prototype),gA=bA))||gA)||gA);w._RF.pop(),w._RF.push({},"2e9aaj8L6lN1pTv2xGEj1sE","StarParticles",void 0);var BA,zA,FA,UA,GA,HA,qA,VA,WA,KA,jA,YA,JA,ZA,XA,QA,$A,eT,tT,nT,iT,rT,aT,oT,sT,lT,uT,cT,pT,hT,dT,yT,fT,vT,mT,gT,bT,wT,kT,ST,CT,ET,xT,AT,TT,PT,RT,LT,IT,OT,_T,DT,MT,NT=S.ccclass,BT=S.property,zT=S.disallowMultiple,FT=Ludex.Utils.Array,UT=(PA=NT("StarParticles"),RA=BT({type:[NA],displayName:"Prebuilt Shining stars"}),PA(LA=zT((OA=r((IA=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"shiningStars",OA,l(e)),e}return e(p,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"fireShiningStarAt",value:(u=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.getFirstAvailableShiningStar())){e.next=3;break}throw new Error("No available shining stars. Please add more prebuilt shining stars or calls this function later.");case 3:return i=g(t,2),r=i[0],a=i[1],s=new q(r,a,this.node.worldPosition.z),n.node.worldPosition=s,e.next=8,n.playAnimation();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getFirstAvailableShiningStar",value:function(){return FT.search(this.shiningStars,(function(e){return e.isAvailable}))}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),p}(x)).prototype,"shiningStars",[RA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),LA=IA))||LA)||LA);function GT(e,t,n,i){var r=e.position,a=t.position,o=ne.distance(r,a);if(o>=n)return!1;var s=new ne(a.x-r.x,a.y-r.y).normalize(),l=n-o;return e.isStatic||t.isStatic?e.isStatic?t.isStatic||a.add2f(s.x*l,s.y*l):r.add2f(-s.x*l,-s.y*l):(r.add2f(-s.x*l*.5,-s.y*l*.5),a.add2f(s.x*l*.5,s.y*l*.5)),HT(e,i),HT(t,i),!0}function HT(e,t){var n=e.position,i=e.radius;n.x=Math.max(t.xMin+i,Math.min(t.xMax-i,n.x)),n.y=Math.max(t.yMin+i,Math.min(t.yMax-i,n.y))}w._RF.pop(),w._RF.push({},"eb6c23usqxHPaoJcvF0LbY6","separatePositions",void 0),w._RF.pop(),w._RF.push({},"2913d3KShhIEaPfSLUhFqvA","EffectManager",void 0);var qT=Ludex.Utils.Valid,VT=S.ccclass,WT=S.property,KT=codex.monitorError,jT=(BA=VT("EffectManager"),zA=Ii.required,FA=WT({group:"Thunder Effect",type:H}),UA=Ii.required,GA=WT({group:"Thunder Effect",type:Qx}),HA=Ii.required,qA=WT({group:"Mask Effect",type:Ao}),VA=Ii.required,WA=WT({group:"Mask Effect",type:H}),KA=Ii.required,jA=WT({group:"Tornado Effect",type:H}),YA=Ii.required,JA=WT({group:"Clear Particle Effect",type:H,displayName:"Particle holder node"}),ZA=Ii.required,XA=WT({group:"Clear Particle Effect",type:Ex,displayName:"Emitter 1"}),QA=Ii.required,$A=WT({group:"Clear Particle Effect",type:Ex,displayName:"Emitter 2"}),eT=Ii.required,tT=WT({group:"Star Particles Effect",type:UT}),nT=Ii.required,iT=WT({group:"Confetti Effect",type:Ex}),rT=Ii.required,aT=WT({group:"Confetti Effect",type:Ex}),oT=WT({group:"Add Item Effect",type:Yx}),sT=WT({group:"Add Item Effect",type:se}),lT=WT({group:"Add Item Effect",type:se}),uT=WT({group:"Add Item Effect",type:se}),cT=WT({group:"Add Item Effect",type:se}),pT=Ii.required,hT=WT({type:H,displayName:"Clear Explosion Container",group:"Clear Explosion Effect"}),dT=Ii.onlyRunInLifeCycle,yT=Ii.onlyRunInLifeCycleAsync,BA(((DT=function(r){n(R,r);var u,p,h,d,y,f,v,m,b,w,k,S,C,x,T,P=i(R);function R(){var e;t(this,R);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=P.call.apply(P,[this].concat(i)),s(e,"cloudContainer",mT,l(e)),s(e,"clouds",gT,l(e)),s(e,"backgroundMask",bT,l(e)),s(e,"masks",wT,l(e)),s(e,"tornadoContainer",kT,l(e)),s(e,"clearParticleHolder",ST,l(e)),s(e,"clearParticle1",CT,l(e)),s(e,"clearParticle2",ET,l(e)),s(e,"starParticle",xT,l(e)),s(e,"leftConfetti",AT,l(e)),s(e,"rightConfetti",TT,l(e)),s(e,"itemEffect",PT,l(e)),s(e,"hintSpriteFrame",RT,l(e)),s(e,"thunderSpriteFrame",LT,l(e)),s(e,"tornadoSpriteFrame",IT,l(e)),s(e,"pliersSpriteFrame",OT,l(e)),e.maskTargets=[],e.vibrate=null,e.gameShakeSignal=new An,s(e,"clearExplosionContainer",_T,l(e)),e}return e(R,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,R)}},{key:"onLoad",value:function(){this.clearParticleHolder.active=!1,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1}},{key:"update",value:function(){if(this.maskTargets.length>0)for(var e=0;e<this.maskTargets.length;e++){var t=this.maskTargets[e];if(!t.isHidden()){var n=this.masks[e];n&&n.setWorldPosition(t.node.worldPosition)}}}},{key:"onEnable",value:function(){this.node.scene.on(Us.GRID_RESIZE,this.handleBoardResize,this)}},{key:"onDisable",value:function(){this.node.scene.off(Us.GRID_RESIZE,this.handleBoardResize,this)}},{key:"handleBoardResize",value:function(e){if(this.clearParticleHolder.setScale(e,e),this.clearExplosionContainer.setScale(e,e),Ye.isLandscape()){var t=$.clamp(e,1,1.5);this.cloudContainer.setScale(t,t)}else this.cloudContainer.setScale(1,1)}},{key:"playClearEffectAt",value:function(e){var t=this,n=e[0],i=n.x,r=n.y,a=e[1],o=a.x,s=a.y,l=this.clearParticle1.node.worldPosition.z,u=this.clearParticle2.node.worldPosition.z;this.clearParticleHolder.active=!0,this.clearParticle1.node.setWorldPosition(i,r,l),this.clearParticle2.node.setWorldPosition(o,s,u),this.clearParticle1.play(),this.clearParticle2.play(),this.scheduleOnce((function(){t.clearParticleHolder.active=!1}),this.clearParticle1.duration)}},{key:"playStarEffectAt",value:function(e){this.starParticle.fireShiningStarAt(e)}},{key:"playConfettiEffect",value:function(){var e,t,n=this;null===(e=this.node.parent)||void 0===e||e.addChild(this.leftConfetti.node),this.rightConfetti.node.parent!==this.node.parent&&(null===(t=this.node.parent)||void 0===t||t.addChild(this.rightConfetti.node));var i=Ye.isLandscape(),r=i?50:30,a=i?5e3:2e3,o=i?15e3:1e4,s=i?40:60,l=i?110:100,u=i?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=r,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=a,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=o,this.leftConfetti.shapeModule.angle=s,this.rightConfetti.shapeModule.angle=l,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=u,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1,this.leftConfetti.play(),this.rightConfetti.play(),this.scheduleOnce((function(){n.leftConfetti.node.active=!1}),this.leftConfetti.duration),this.scheduleOnce((function(){n.rightConfetti.node.active=!1}),this.rightConfetti.duration)}},{key:"playTornadoAnimation",value:(T=a(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.tornadoSpineNode.getComponent("sp.Skeleton")){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){n.tornadoSpineNode.active=!0,t.setAnimation(0,"tornado_alone",!1),t.setCompleteListener((function(){e(),n.tornadoSpineNode.active=!1}))})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"playThunderAnimation",value:(x=a(o().mark((function e(t,n){var i,r,a,s,l,u,c,p,h,d=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resetMasks(),i=g(t,2),r=g(i[0],2),a=r[0],s=r[1],l=g(i[1],2),u=l[0],c=l[1],this.maskTargets=[a,s,u,c],this.maskTargets.forEach((function(e,t){d.setMaskProperties(t,e.node.worldPosition,e.node.worldScale)})),e.next=6,this.setBackgroundMaskActive(!0);case 6:return p=this.getCloudPositions([a.node.worldPosition,s.node.worldPosition,u.node.worldPosition,c.node.worldPosition],n.getTileSize()[0]/2),h=[this.performCloudEffectFirstPair(a,s,p[0],n,.1),this.performCloudEffectSecondPair(u,c,p[1],p[2],n,.1)],e.next=10,Promise.all(h);case 10:this.setBackgroundMaskActive(!1);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"playItemAddAnimation",value:(C=a(o().mark((function e(t,n,i){var r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(a=null===(r=E.getScene())||void 0===r?void 0:r.getChildByName("Canvas"))){e.next=3;break}return e.abrupt("return");case 3:if(s=i.itemType){e.next=6;break}return e.abrupt("return");case 6:this.itemEffect.node.active=!0,this.itemEffect.node.setParent(a),this.itemEffect.node.setWorldPosition(t,n,this.itemEffect.node.worldPosition.z),this.itemEffect.node.setScale(q.ONE),e.t0=s,e.next=e.t0===Xe.HINT?13:e.t0===Xe.THUNDER?15:e.t0===Xe.STORM?17:e.t0===Xe.PLIERS?19:21;break;case 13:return this.itemEffect.sprite.spriteFrame=this.hintSpriteFrame,e.abrupt("break",21);case 15:return this.itemEffect.sprite.spriteFrame=this.thunderSpriteFrame,e.abrupt("break",21);case 17:return this.itemEffect.sprite.spriteFrame=this.tornadoSpriteFrame,e.abrupt("break",21);case 19:return this.itemEffect.sprite.spriteFrame=this.pliersSpriteFrame,e.abrupt("break",21);case 21:return l=R.FULL_ANIM_USED_ON_ADD_ITEM[s],R.FULL_ANIM_USED_ON_ADD_ITEM[s]=!0,e.next=25,iA(this.itemEffect,i,l);case 25:this.itemEffect.node.active=!1;case 26:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return C.apply(this,arguments)})},{key:"playMultiThunderAnimation",value:(S=a(o().mark((function e(t,n,i){var r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resetMasks(),(r=this.clouds[0]).node.active=!0,e.next=5,r.moveToScreenCenter();case 5:return e.next=7,Ue.waitTweenAsync(.2);case 7:n.clear({pairs:t,stagger:i,lightning:!0}),a=[],s=0,l=2*t.length;case 10:if(!(s<l)){e.next=29;break}if(u=Math.floor(s/2),void 0!==(c=t[u])){e.next=15;break}return e.abrupt("continue",26);case 15:if(void 0!==(p=c[s%2])){e.next=18;break}return e.abrupt("continue",26);case 18:if(0!==s&&s%2==0&&(this.node.scene.emit(Us.ADD_COMBO),this.node.scene.emit(Us.ADD_SCORE)),this.shakeGame(),this.shakeScreen(500),Ve.playSound(Ji.THUNDERBOLT),a.push(r.playLightningAnimation(p.node.worldPosition)),!i){e.next=26;break}return e.next=26,Ue.waitTweenAsync(i);case 26:s++,e.next=10;break;case 29:return e.next=31,Promise.all(a);case 31:return r.node.active=!1,e.next=34,this.setBackgroundMaskActive(!1);case 34:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return S.apply(this,arguments)})},{key:"performCloudEffectFirstPair",value:(k=a(o().mark((function e(t,n,i,r,a){var s,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=this.clouds[0]).node.active=!0,e.next=4,s.moveToScreen(i,"left");case 4:if(this.shakeGame(),this.shakeScreen(500),Ue.waitTweenAsync(.2).then((function(){Ve.playSound(Ji.THUNDERBOLT),r.clear({pairs:[[t,n]],stagger:a,lightning:!0,delay:1.5}),u.node.scene.emit(Us.ADD_COMBO),u.node.scene.emit(Us.ADD_SCORE)})),(l=[s.playLightningAnimation(t.node.worldPosition)]).push(Ue.waitTweenAsync(.2).then((function(){return u.createClearExplosionAt(t.node.worldPosition)}))),!a){e.next=12;break}return e.next=12,Ue.waitTweenAsync(a);case 12:return l.push(s.playLightningAnimation(n.node.worldPosition).then((function(){return s.moveOutScreen("left")}))),l.push(Ue.waitTweenAsync(.2).then((function(){return u.createClearExplosionAt(n.node.worldPosition)}))),e.next=16,Promise.all(l);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r){return k.apply(this,arguments)})},{key:"performCloudEffectSecondPair",value:(w=a(o().mark((function e(t,n,i,r,a,s){var l,u,c,p=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.clouds[1],u=this.clouds[2],l.node.active=!0,u.node.active=!0,l.moveToScreen(i,"right"),e.next=7,Ue.waitTweenAsync(.3);case 7:return e.next=9,u.moveToScreen(r,"left");case 9:if(this.shakeGame(),this.shakeScreen(500),Ue.waitTweenAsync(.2).then((function(){Ve.playSound(Ji.THUNDERBOLT),a.clear({pairs:[[t,n]],stagger:s,lightning:!0,delay:1.5}),p.node.scene.emit(Us.ADD_COMBO),p.node.scene.emit(Us.ADD_SCORE)})),(c=[l.playLightningAnimation(t.node.worldPosition).then((function(){return l.moveOutScreen("right")}))]).push(Ue.waitTweenAsync(.2).then((function(){return p.createClearExplosionAt(t.node.worldPosition)}))),!s){e.next=17;break}return e.next=17,Ue.waitTweenAsync(s);case 17:return c.push(u.playLightningAnimation(n.node.worldPosition).then((function(){return u.moveOutScreen("left")}))),c.push(Ue.waitTweenAsync(.2).then((function(){return p.createClearExplosionAt(n.node.worldPosition)}))),e.next=21,Promise.all(c);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r,a){return w.apply(this,arguments)})},{key:"shakeScreen",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.vibrate=null!==(e=this.vibrate)&&void 0!==e?e:this.node.getComponent(xd),null===(t=this.vibrate)||void 0===t||t.vibrate(n)}},{key:"preloadEffects",value:function(){this.loadDefuseExplosionPool(),this.loadBombExplosionPool(),this.loadClearExplosionPool(),this.loadTornadoSpine()}},{key:"loadDefuseExplosionPool",value:(b=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.defuseExplosionPool){e.next=2;break}return e.abrupt("return",this.defuseExplosionPool);case 2:return e.next=4,Fe.loadPrefabAsync(Qe.BOMB_DEFUSE_PREFAB);case 4:if(t=e.sent,this.isValid&&this.node.activeInHierarchy){e.next=7;break}return e.abrupt("return");case 7:if(null!==t){e.next=10;break}return this.reportOrThrowInDebugger("Failed to load prefab","createDefuseExplosionAt"),e.abrupt("return");case 10:return this.defuseExplosionPool=YT(t,this.node),e.abrupt("return",this.defuseExplosionPool);case 12:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"loadBombExplosionPool",value:(m=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.bombExplosionPool){e.next=2;break}return e.abrupt("return",this.bombExplosionPool);case 2:return e.next=4,Fe.loadPrefabAsync(Qe.BOMB_EXPLODE_PREFAB);case 4:if(t=e.sent,this.isValid&&this.node.activeInHierarchy){e.next=7;break}return e.abrupt("return");case 7:if(null!==t){e.next=10;break}return this.reportOrThrowInDebugger("Failed to load prefab","createBombExplosionAt"),e.abrupt("return");case 10:return this.bombExplosionPool=JT(t,this.node),e.abrupt("return",this.bombExplosionPool);case 12:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"loadClearExplosionPool",value:(v=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.clearExplosionPool){e.next=2;break}return e.abrupt("return",this.clearExplosionPool);case 2:return e.next=4,Fe.loadPrefabAsync(Qe.CLEAR_EXPLOSION_PREFAB);case 4:if(t=e.sent,this.isValid&&this.node.activeInHierarchy){e.next=7;break}return e.abrupt("return");case 7:if(null!==t){e.next=10;break}return this.reportOrThrowInDebugger("Failed to load prefab","createClearExplosionAt"),e.abrupt("return");case 10:return this.clearExplosionPool=ZT(t,this.clearExplosionContainer),e.abrupt("return",this.clearExplosionPool);case 12:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"loadTornadoSpine",value:(f=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.loadPrefabAsync(Qe.TORNADO_SPINE_PREFAB);case 2:if(t=e.sent,this.isValid&&this.node.activeInHierarchy){e.next=5;break}return e.abrupt("return");case 5:if(null!==t){e.next=8;break}return this.reportOrThrowInDebugger("Failed to load prefab","loadTornadoSpine"),e.abrupt("return");case 8:(n=he(t)).active=!1,this.tornadoContainer.addChild(n),this.tornadoSpineNode=n;case 12:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"createDefuseExplosionAt",value:(y=a(o().mark((function e(t,n){var i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDefuseExplosionPool();case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=i.alloc(),a=r.node,s=r.animation,a.setWorldPosition(t,n,0),e.next=11,Ue.runAnimationAsync(s);case 11:i.free(r);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"createBombExplosionAt",value:(d=a(o().mark((function e(t){var n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadBombExplosionPool();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:return i=n.alloc(),r=i.node,a=i.animation,r.setWorldPosition(t),e.next=11,Ue.runAnimationAsync(a);case 11:n.free(i);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"createClearExplosionAt",value:(h=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadClearExplosionPool();case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=i.alloc(),a=r.node,s=r.animation,a.setWorldPosition(t),null===(n=a.getComponentInChildren(Ex))||void 0===n||n.play(),e.next=12,Ue.runAnimationAsync(s);case 12:i.free(r);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setBackgroundMaskActive",value:(p=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(this.backgroundMask.node.active=!0),e.next=3,this.backgroundMask.changeStateFade(t,.25);case 3:t||(this.backgroundMask.node.active=!1);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"resetMasks",value:function(){var e,t=c(this.masks);try{for(t.s();!(e=t.n()).done;){e.value.worldPosition=new q(-9999,-9999,0)}}catch(e){t.e(e)}finally{t.f()}}},{key:"setMaskProperties",value:function(e,t,n){var i=this.masks[e];i&&(n&&(i.worldScale=n),i.worldPosition=t)}},{key:"shakeGame",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameShakeSignal.abort(),t=new An,this.gameShakeSignal=t,n=this.node.position.clone(),i=ce(-10,10),r=ce(-10,10),a=n.clone().add3f(i,r,0),s=n.clone().add3f(-i,-r,0),l=L(this.node).to(.05,{position:a}).to(.05,{position:s}).to(.05,{position:n}),u=function(){return c.node.setPosition(n)},t.addAbortListener(u),e.next=13,Ue.runTweenAsync(l,t);case 13:t.removeAbortListener(u);case 14:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getCloudPositions",value:function(e,t){var n=e[0],i=e[1],r=e[2],a=e[3],o=new ne((n.x+i.x)/2,Math.max(n.y,i.y)+ce(200,250)),s=new ne(r.x,r.y+ce(200,250)),l=new ne(a.x,a.y+ce(200,250)),u=Ye.isLandscape()?60:t,p=[{position:o,radius:u,isStatic:!1},{position:s,radius:u,isStatic:!1},{position:l,radius:u,isStatic:!1},{position:n.toVec2(),radius:t,isStatic:!0},{position:i.toVec2(),radius:t,isStatic:!0},{position:r.toVec2(),radius:t,isStatic:!0},{position:a.toVec2(),radius:t,isStatic:!0}];return function(e,t,n){for(var i=0;i++<30;){for(var r=!1,a=0;a<e.length;a++)for(var o=a+1;o<e.length;o++){var s=e[a],l=e[o],u=t+s.radius+l.radius;ne.distance(s.position,l.position)<u&&(r||(r=GT(s,l,u,n)))}if(!r)break}var p,h=c(e);try{for(h.s();!(p=h.n()).done;)HT(p.value,n)}catch(e){h.e(e)}finally{h.f()}}(p,100,re("Canvas").getComponent(A).getBoundingBoxToWorld()),p.slice(0,3).map((function(e){return e.position.toVec3()}))}},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if(qT.isDebugger())throw n;null==KT||KT.sendException(n)}}]),R}(x)).FULL_ANIM_USED_ON_ADD_ITEM=(m(MT={},Xe.HINT,!1),m(MT,Xe.THUNDER,!1),m(MT,Xe.STORM,!1),m(MT,Xe.PLIERS,!1),MT),mT=r((vT=DT).prototype,"cloudContainer",[zA,FA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gT=r(vT.prototype,"clouds",[UA,GA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bT=r(vT.prototype,"backgroundMask",[HA,qA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wT=r(vT.prototype,"masks",[VA,WA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kT=r(vT.prototype,"tornadoContainer",[KA,jA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ST=r(vT.prototype,"clearParticleHolder",[YA,JA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CT=r(vT.prototype,"clearParticle1",[ZA,XA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ET=r(vT.prototype,"clearParticle2",[QA,$A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xT=r(vT.prototype,"starParticle",[eT,tT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AT=r(vT.prototype,"leftConfetti",[nT,iT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TT=r(vT.prototype,"rightConfetti",[rT,aT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=r(vT.prototype,"itemEffect",[oT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RT=r(vT.prototype,"hintSpriteFrame",[sT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LT=r(vT.prototype,"thunderSpriteFrame",[lT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IT=r(vT.prototype,"tornadoSpriteFrame",[uT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OT=r(vT.prototype,"pliersSpriteFrame",[cT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_T=r(vT.prototype,"clearExplosionContainer",[pT,hT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(vT.prototype,"shakeScreen",[dT],Object.getOwnPropertyDescriptor(vT.prototype,"shakeScreen"),vT.prototype),r(vT.prototype,"shakeGame",[yT],Object.getOwnPropertyDescriptor(vT.prototype,"shakeGame"),vT.prototype),fT=vT))||fT);function YT(e,t){return new zg((function(){var n=he(e),i=n.getComponent(le);if(!i)throw new Error("DefuseExplosion: No animation component found in bombDefuseExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}function JT(e,t){return new zg((function(){var n=he(e),i=n.getComponent(le);if(!i)throw new Error("BombExplosion: No animation component found in bombExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}function ZT(e,t){return new zg((function(){var n=he(e),i=n.getComponent(A),r=n.getComponent(le);if(!i||!r)throw new Error("ClearExplosion: Invalid prefab");return t.addChild(n),n.active=!1,{node:n,uiTransform:i,animation:r}}),2,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}w._RF.pop(),w._RF.push({},"062f3AVHntKsIyireZmXg9P","GuideKeys",void 0);var XT="newbie",QT="timer",$T="combo",eP="hint-item",tP="thunder-item",nP="storm-item",iP="pliers-item",rP="custom-mode";w._RF.pop(),w._RF.push({},"6448denZfFEUru9tWmWGb7N","Guide01Newbie",void 0);var aP=function(){function n(e){var i=this;t(this,n),this.alignSkipButton=function(){var e=i.gameplay.board,t=i.manager.guideUi.guideSkipButton;if(t){var n=t.parent;if(n){var r=e.getBoundingBoxWorld(),a=r.yMax,o=r.xMax,s=He.cssSizeToWorldSize(He.getScreenHeightCss()),l=o-n.getComponent(A).width/2,u=Math.min(a+100,a+(s-a)/2);n.setWorldPosition(l,u,0)}}},this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:function(){this.currentStep=0,this.manager.node.scene.on(Us.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.on(Us.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.on(Us.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.on(A.EventType.SIZE_CHANGED,this.alignSkipButton,this),this.showStep(this.currentStep),this.manager.node.scene.emit(Us.HIDE_UI)}},{key:"showNextStep",value:function(){this.currentStep+1<lm.length?(this.currentStep+=1,this.showStep(this.currentStep)):this.close()}},{key:"showStep",value:(r=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h,d,y,f,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=lm[t]){e.next=3;break}return e.abrupt("return");case 3:if(i=this.gameplay,r=i.board,a=i.effectManager,s=n.startTile,l=n.endTile,u=r.getTileAt(s.x,s.y),c=r.getTileAt(l.x,l.y),u&&c){e.next=10;break}return e.abrupt("return");case 10:return p=u.node.worldPosition,h=c.node.worldPosition,a.resetMasks(),a.setMaskProperties(0,p,u.node.worldScale),a.setMaskProperties(1,h,c.node.worldScale),a.setBackgroundMaskActive(!0),d=this.manager.guideUi,y=d.guideHand,f=d.guideTextBox,v=d.guideSkipButton,y.node.active=!0,v.active=!0,y.playHandAnimation(p,h),this.alignGuideTextBox(),this.alignSkipButton(),e.next=24,f.hide();case 24:return f.setLocalizedText(n.localeTextKey),e.next=27,f.show();case 27:r.setIgnoreInput(!0),u.setIgnoreInput(!1),c.setIgnoreInput(!1),this.gameplay.comboManager.setEmitEvent(!1);case 31:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=lm[this.currentStep];if(e){var t=this.gameplay,n=t.board,i=t.effectManager,r=e.startTile,a=e.endTile,o=n.getTileAt(r.x,r.y),s=n.getTileAt(a.x,a.y);if(o&&s){var l=o.node.worldPosition,u=s.node.worldPosition;i.setMaskProperties(0,l,o.node.worldScale),i.setMaskProperties(1,u,s.node.worldScale),this.alignGuideTextBox(),this.alignSkipButton()}}}},{key:"alignGuideTextBox",value:function(){var e=this.gameplay.board,t=this.manager.guideUi.guideTextBox,n=e.getBoundingBoxWorld(),i=n.width,r=n.yMin,a=n.center.x,o=t.widget.bottom+(r-t.widget.bottom)/2;t.node.setWorldPosition(a,o,0);var s=Math.max(Math.min(223,.85*(r-t.widget.bottom)),10);t.uiTransform.setContentSize(i,s)}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.gameplay,n=t.board,i=t.effectManager,this.manager.node.scene.off(Us.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.off(Us.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.off(Us.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.off(A.EventType.SIZE_CHANGED,this.alignSkipButton,this),n.setIgnoreInput(!1),e.next=8,Promise.all([this.manager.guideUi.guideTextBox.hide(),i.setBackgroundMaskActive(!1)]);case 8:this.manager.guideUi.guideHand.node.active=!1,this.manager.completeGuide(XT);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}]),n}();w._RF.pop(),w._RF.push({},"a52daB3sGxP8JyGBZo5K1+X","Guide02Timer",void 0);var oP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,e.next=3,this.gameplay.handleShowUI();case 3:return n.node.active=!0,i.node.active=!0,r.key="guide.timer",i.horizontalAlign=Le.CENTER,i.getComponent(A).setAnchorPoint(.5,.5),this.handleViewResized(),e.next=11,n.show();case 11:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 15:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.currentLayout.clock,r=i.getComponent(A).contentSize,a=r.width,o=r.height,s=i.node.worldPosition,l=Ye.isPortrait()?s.y-o/2-50:s.y+o/2+70;a*=1.5,o*=1.5,t.setOtherMaskTransform(s.x,s.y,a,o),n.node.setWorldPosition(s.x,l,0)}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideInfoText,i=t.guideMasks,this.gameplay.comboManager.setEmitEvent(!0),this.gameplay.stateManager.isPlaying()&&this.manager.node.scene.emit(Us.RESUME_TIME),e.next=5,i.hide();case 5:n.node.active=!1,this.manager.completeGuide(QT),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"add56o6JFNHAZiCO6F+Z9jK","Guide03Combo",void 0);var sP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,n.node.active=!0,i.node.active=!0,r.key="guide.combo",i.horizontalAlign=Le.RIGHT,i.getComponent(A).setAnchorPoint(1,.5),this.handleViewResized(),e.next=9,n.show();case 9:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.comboContainer,r=i.getComponent(A).contentSize,a=r.width,o=r.height,s=1.5*i.node.scale.x,l=i.node.worldPosition;a*=s,o*=s,t.setOtherMaskTransform(l.x,l.y,a,o),n.node.setWorldPosition(l.x-a/2-10,l.y,0)}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,this.manager.node.scene.emit(Us.RESUME_TIME),n.node.off(H.EventType.TOUCH_START,this.close,this),e.next=5,n.hide();case 5:i.node.active=!1,this.manager.completeGuide($T),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"fd93d+WLXVHk4yJGmVeSjmR","Guide04Hint",void 0);var lP=Ludex.Utils.Array,uP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,lP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.HINT}))){e.next=4;break}return e.abrupt("return");case 4:return n.node.active=!0,i.node.active=!0,r.key="guide.hint",i.horizontalAlign=Le.CENTER,i.getComponent(A).setAnchorPoint(.5,.5),this.handleViewResized(),e.next=12,n.show();case 12:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Us.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 17:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,r=lP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.HINT}));if(r){var a=r.node.worldPosition,o=r.getComponent(A).contentSize,s=o.width,l=o.height;if(s+=40,l+=40,t.setItemMaskTransform(a.x,a.y,s,l),i.node.active=!0,i.setTransform(a.x,a.y,s,l),Ye.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,a.y+l/2+30,0);else if(Ye.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new q(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideItemButton,this.manager.node.scene.emit(Us.RESUME_TIME),e.next=4,n.hide();case 4:i.node.active=!1,r.node.active=!1,this.manager.completeGuide(eP),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Us.USE_ITEM,Xe.HINT),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Us.ITEM_MASK_CLICKED,this.useItem,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"b08f4dC/r1EPbsfAe1wtcBg","Guide05Thunder",void 0);var cP=Ludex.Utils.Array,pP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,cP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.THUNDER}))){e.next=4;break}return e.abrupt("return");case 4:return n.node.active=!0,i.node.active=!0,r.key="guide.thunder",i.horizontalAlign=Le.CENTER,i.getComponent(A).setAnchorPoint(.5,.5),this.handleViewResized(),e.next=12,n.show();case 12:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Us.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 17:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,r=cP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.THUNDER}));if(r){var a=r.node.worldPosition,o=r.getComponent(A).contentSize,s=o.width,l=o.height;if(s+=40,l+=40,t.setItemMaskTransform(a.x,a.y,s,l),i.node.active=!0,i.setTransform(a.x,a.y,s,l),Ye.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,a.y+l/2+30,0);else if(Ye.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new q(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideItemButton,this.manager.node.scene.emit(Us.RESUME_TIME),e.next=4,n.hide();case 4:i.node.active=!1,r.node.active=!1,this.manager.completeGuide(tP),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Us.USE_ITEM,Xe.THUNDER),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Us.ITEM_MASK_CLICKED,this.useItem,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"f4ef8MBZxxKC4bfuDzsLQ5X","Guide06Storm",void 0);var hP=Ludex.Utils.Array,dP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,hP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.STORM}))){e.next=4;break}return e.abrupt("return");case 4:return n.node.active=!0,i.node.active=!0,r.key="guide.storm",i.horizontalAlign=Le.CENTER,i.getComponent(A).setAnchorPoint(.5,.5),this.handleViewResized(),e.next=12,n.show();case 12:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Us.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 17:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,r=hP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.STORM}));if(r){var a=r.node.worldPosition,o=r.getComponent(A).contentSize,s=o.width,l=o.height;if(s+=40,l+=40,t.setItemMaskTransform(a.x,a.y,s,l),i.node.active=!0,i.setTransform(a.x,a.y,s,l),Ye.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,a.y+l/2+30,0);else if(Ye.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new q(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideItemButton,this.manager.node.scene.emit(Us.RESUME_TIME),e.next=4,n.hide();case 4:i.node.active=!1,r.node.active=!1,this.manager.completeGuide(nP),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Us.USE_ITEM,Xe.STORM),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Us.ITEM_MASK_CLICKED,this.useItem,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"9920dDqYP9ITJp0bSlZ+K9R","Guide07Pliers",void 0);var yP,fP,vP,mP,gP,bP,wP,kP,SP,CP=Ludex.Utils.Array,EP=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,r;return e(n,[{key:"setup",value:(r=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideInfoTextLocalizer,CP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.PLIERS}))){e.next=4;break}return e.abrupt("return");case 4:return n.node.active=!0,i.node.active=!0,r.key="guide.pliers",i.horizontalAlign=Le.CENTER,i.getComponent(A).setAnchorPoint(.5,.5),this.handleViewResized(),e.next=12,n.show();case 12:this.manager.node.scene.once(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Us.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Us.PAUSE_TIME),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),O.on(Ge.ORIENTATION_CHANGED,this.handleViewResized,this);case 17:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,r=CP.search(this.gameplay.uiManager.items,(function(e){return e.itemType===Xe.PLIERS}));if(r){var a=r.node.worldPosition,o=r.getComponent(A).contentSize,s=o.width,l=o.height;if(s+=40,l+=40,t.setItemMaskTransform(a.x,a.y,s,l),i.node.active=!0,i.setTransform(a.x,a.y,s,l),Ye.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,a.y+l/2+30,0);else if(Ye.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new q(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manager.guideUi,n=t.guideMasks,i=t.guideInfoText,r=t.guideItemButton,this.manager.node.scene.emit(Us.RESUME_TIME),e.next=4,n.hide();case 4:i.node.active=!1,r.node.active=!1,this.manager.completeGuide(iP),this.unlistenEvents();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Us.USE_ITEM,Xe.PLIERS),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Us.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Us.ITEM_MASK_CLICKED,this.useItem,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this),O.off(Ge.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();w._RF.pop(),w._RF.push({},"8ab11Ocp6VMg5ZkRHXv4Odu","GuideHand",void 0);var xP,AP=S.ccclass,TP=S.property,PP=(yP=AP("GuideHand"),fP=TP(H),vP=TP(H),mP=TP(M),yP((wP=r((bP=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"hand",wP,l(e)),s(e,"circleHighlight",kP,l(e)),s(e,"circleHighlightOpacity",SP,l(e)),e}return e(o,[{key:"start",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255}},{key:"playHandAnimation",value:function(e,t){var n=this;this.handTween&&this.handTween.stop();var i=L(this.hand).to(.8,{worldPosition:t},{easing:"quartOut"}).to(.2,{scale:new q(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:q.ONE,angle:0}).to(.8,{worldPosition:e},{easing:"quartOut"}).to(.2,{scale:new q(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:q.ONE,angle:0});this.handTween=L(this.hand).repeatForever(i).start()}},{key:"playHighlightAnimation",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255,this.circleHighlight.position=this.hand.position.clone(),L(this.circleHighlight).to(.6,{scale:new q(1.5,1.5)},{easing:"quadOut"}).start(),L(this.circleHighlightOpacity).to(.6,{opacity:0},{easing:"quadIn"}).start()}}]),o}(x)).prototype,"hand",[fP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kP=r(bP.prototype,"circleHighlight",[vP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SP=r(bP.prototype,"circleHighlightOpacity",[mP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gP=bP))||gP);w._RF.pop(),w._RF.push({},"763fe/xz6FAU5qOW2sRJ//R","GuideItemButton",void 0);var RP,LP,IP,OP,_P,DP,MP,NP=(0,S.ccclass)("GuideItemButton")(xP=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"__preload",value:function(){this.uiTransform=this.node.getComponent(A)}},{key:"setTransform",value:function(e,t,n,i){this.node.setWorldPosition(e,t,0),this.uiTransform.setContentSize(n,i)}},{key:"onClick",value:function(){this.node.scene.emit(Us.ITEM_MASK_CLICKED)}}]),o}(x))||xP;w._RF.pop(),w._RF.push({},"b2213ccDllApaGIouur6a6b","GameMask",void 0);var BP,zP,FP,UP,GP,HP,qP,VP,WP=S.ccclass,KP=S.property,jP=(RP=WP("GameMask"),LP=KP(A),IP=KP(N),RP((DP=r((_P=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"uiTransform",DP,l(e)),s(e,"sprite",MP,l(e)),e}return e(o,[{key:"texture",get:function(){return this.sprite.spriteFrame.texture}}]),o}(x)).prototype,"uiTransform",[LP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MP=r(_P.prototype,"sprite",[IP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OP=_P))||OP);w._RF.pop(),w._RF.push({},"ad9c7KiarJHXpRRfn9GOaVx","AlphaMasks",void 0);var YP,JP,ZP,XP,QP,$P,eR,tR=S.ccclass,nR=S.property,iR=S.executeInEditMode,rR=(BP=tR("AlphaMasks"),zP=iR(!0),FP=nR(jP),UP=Ii.required(),BP(GP=zP((qP=r((HP=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"masks",qP,l(e)),s(e,"UITransform",VP,l(e)),e}return e(o,[{key:"__preload",value:function(){this.UITransform=this.node.getComponent(A)}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this)}},{key:"start",value:function(){var e;this.material=null===(e=this.getComponent(N))||void 0===e?void 0:e.getMaterialInstance(0)}},{key:"update",value:function(){var e=this;if(this.material){var t=this.UITransform,n=t.width,i=t.height;this.masks.forEach((function(t,r){var a=t.uiTransform,o=a.width,s=a.height,l=a.anchorX,u=a.anchorY,c=o*t.node.scale.x,p=s*t.node.scale.y,h=new ne(c/n,p/i),d=new ne(.5+(.5-l)*h.x,.5-(.5-u)*h.y),y=new ne(d.x+(t.node.worldPosition.x-e.node.worldPosition.x)/n,d.y-(t.node.worldPosition.y-e.node.worldPosition.y)/i);e.material.setProperty("mask".concat(r,"Texture"),t.texture),e.material.setProperty("ratio".concat(r),h),e.material.setProperty("center".concat(r),y)}))}}},{key:"setMaskActive",value:function(e,t){var n;e>=this.masks.length||null===(n=this.material)||void 0===n||n.setProperty("useMask".concat(e),t?1:0)}}]),o}(x)).prototype,"masks",[FP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),VP=r(HP.prototype,"UITransform",[UP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GP=HP))||GP)||GP);w._RF.pop(),w._RF.push({},"69569cXv55L852IkWTL0swz","GuideMasks",void 0);var aR,oR,sR,lR,uR,cR,pR,hR,dR,yR,fR,vR,mR,gR,bR,wR,kR,SR,CR=S.ccclass,ER=S.property,xR=(YP=CR("GuideMasks"),JP=ER(Ao),ZP=ER(rR),YP(($P=r((QP=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"background",$P,l(e)),s(e,"alphaMasks",eR,l(e)),e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"show",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.background.node.active=!0,e.next=3,this.background.changeStateFade(!0,.25);case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hide",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.background.changeStateFade(!1,.25);case 2:this.background.node.active=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"onClick",value:function(){this.node.scene.emit(Us.GUIDE_MASK_CLICKED)}},{key:"setOtherMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[1].node.worldPosition=new q(-9999,-9999,0);var r=this.alphaMasks.masks[0];this.setMaskTransform(r,e,t,n,i)}},{key:"setItemMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[0].node.worldPosition=new q(-9999,-9999,0);var r=this.alphaMasks.masks[1];this.setMaskTransform(r,e,t,n,i)}},{key:"setMaskTransform",value:function(e,t,n,i,r){e.uiTransform.setContentSize(i,r),e.node.setWorldPosition(t,n,0)}}]),h}(x)).prototype,"background",[JP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eR=r(QP.prototype,"alphaMasks",[ZP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XP=QP))||XP);w._RF.pop(),w._RF.push({},"abfb9zudJhHdZfeUgbnBrs0","GuideTextBox",void 0);var AR,TR,PR,RR,LR,IR,OR,_R,DR,MR,NR,BR,zR,FR,UR,GR,HR,qR,VR,WR,KR,jR,YR,JR,ZR=S.ccclass,XR=S.property,QR=(aR=ZR("GuideTextBox"),oR=Ii.required(),sR=XR(Y),lR=Ii.required(),uR=XR(R),cR=Ii.required(),pR=XR(A),hR=Ii.required(),dR=XR(Ao),yR=Ii.required(),fR=XR(cp),aR((gR=r((mR=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"guideText",gR,l(e)),s(e,"widget",bR,l(e)),s(e,"uiTransform",wR,l(e)),s(e,"opacityToggler",kR,l(e)),s(e,"localizer",SR,l(e)),e}return e(h,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this)}},{key:"setLocalizedText",value:function(e){this.localizer.key=e}},{key:"show",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.opacityToggler.changeStateFade(!0);case 2:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hide",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.opacityToggler.changeStateFade(!1);case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"guideText",[oR,sR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bR=r(mR.prototype,"widget",[lR,uR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wR=r(mR.prototype,"uiTransform",[cR,pR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kR=r(mR.prototype,"opacityToggler",[hR,dR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SR=r(mR.prototype,"localizer",[yR,fR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vR=mR))||vR);w._RF.pop(),w._RF.push({},"a2522Y5Q6JGSr90yCp/4qCm","GuideUI",void 0);var $R,eL,tL,nL,iL,rL=S.ccclass,aL=S.property,oL=(AR=rL("GuideUI"),TR=Ii.required(),PR=aL(PP),RR=Ii.required(),LR=aL(QR),IR=Ii.required(),OR=aL(Y),_R=Ii.required(),DR=aL(cp),MR=Ii.required(),NR=aL(xR),BR=Ii.required(),zR=aL(H),FR=Ii.required(),UR=aL(NP),AR((qR=r((HR=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"guideHand",qR,l(e)),s(e,"guideTextBox",VR,l(e)),s(e,"guideInfoText",WR,l(e)),s(e,"guideInfoTextLocalizer",KR,l(e)),s(e,"guideMasks",jR,l(e)),s(e,"guideSkipButton",YR,l(e)),s(e,"guideItemButton",JR,l(e)),e}return e(o,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this)}}]),o}(x)).prototype,"guideHand",[TR,PR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VR=r(HR.prototype,"guideTextBox",[RR,LR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WR=r(HR.prototype,"guideInfoText",[IR,OR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KR=r(HR.prototype,"guideInfoTextLocalizer",[_R,DR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jR=r(HR.prototype,"guideMasks",[MR,NR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YR=r(HR.prototype,"guideSkipButton",[BR,zR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JR=r(HR.prototype,"guideItemButton",[FR,UR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GR=HR))||GR);w._RF.pop(),w._RF.push({},"4d800jyvxFJIYnkeNGud6KJ","GuidelinesManager",void 0);var sL=codex,lL=sL.player,uL=sL.analytics,cL=S.ccclass,pL=S.property,hL=Ludex,dL=hL.Match.Modes,yL=hL.Plugins.Analytics,fL=(void 0===yL?{}:yL).Events,vL=hL.Utils.Array,mL=new ne(0,10),gL=new ne(0,10),bL="READY",wL="RUNNING",kL=($R=cL("GuidelinesManager"),eL=pL(oL),$R((iL=r((nL=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"guideUi",iL,l(e)),e.guideHintDelay=null,e.guideStormDelay=null,e}return e(p,[{key:"init",value:function(e){this.gameplay=e,this.status=bL,this.node.scene.on(Us.COMBO_UPDATED,this.startComboGuide,this),this.node.scene.on(Us.TILE_CLICK,this.startAutoGuides,this),this.node.scene.on(Us.USE_ITEM,this.handleUseItem,this),this.node.scene.on(Us.GAME_FINISH,this.stopAutoGuides,this),this.node.scene.on(Us.GAME_REPLAY,this.stopAutoGuides,this),this.node.scene.on(Us.GAME_PAUSE,this.stopAutoGuides,this)}},{key:"show",value:function(){this.isNewbieGuideLevel()?(this.hasGuideItemShowed(XT)&&this.resetGuideItemShowed(),this.startGuide(XT)):this.startGuide(QT)}},{key:"startGuide",value:function(e){if(this.status===wL)return!1;if(this.hasGuideItemShowed(e))return!1;switch(this.addGuideItemShowed(e),this.status=wL,e){case XT:fL&&uL.event(fL.TUTORIAL_BEGIN),this.guide1=new aP(this),this.guide1.setup();break;case QT:this.guide2=new oP(this),this.guide2.setup();break;case $T:this.guide3=new sP(this),this.guide3.setup();break;case eP:this.guide4=new uP(this),this.guide4.setup();break;case tP:this.guide5=new pP(this),this.guide5.setup();break;case nP:this.guide6=new dP(this),this.guide6.setup();break;case iP:this.guide7=new EP(this),this.guide7.setup()}return!0}},{key:"completeGuide",value:function(e){fL&&uL.event(fL.TUTORIAL_STEP,{step:e}),this.status=bL,this.addGuideItemShowed(e),this.gameplay.stateManager.isPlaying()&&this.startAutoGuides()}},{key:"isHintGuideLevel",value:function(){var e=this.getCurrentLevel(),t=mL.x,n=mL.y;return e>=t&&e<=n}},{key:"isShowErrorPathLevel",value:function(){if(hy.getMatchMode()===dL.TOURNAMENT)return!1;var e=this.getCurrentLevel(),t=gL.x,n=gL.y;return e>=t&&e<=n}},{key:"isNewbieGuideLevel",value:function(){return 0===this.getCurrentLevel()}},{key:"hasGuideItemShowed",value:function(e){return vL.has(this.getGuideItemShowed(),e)}},{key:"addGuideItemShowed",value:function(e){if(!this.hasGuideItemShowed(e)){var t=this.getGuideItemShowed();t.push(e),lL.setGameData({guideItemShowed:t})}}},{key:"resetGuideItemShowed",value:function(){lL.setGameData({guideItemShowed:[]})}},{key:"getGuideItemShowed",value:function(){var e,t;return null!==(e=null===(t=lL.getGameData())||void 0===t?void 0:t.guideItemShowed)&&void 0!==e?e:[]}},{key:"getCurrentLevel",value:function(){return this.gameplay.levelManager.getLevelData().level}},{key:"startComboGuide",value:function(e){this.isNewbieGuideLevel()||e<2||(this.startGuide($T),this.node.scene.off(Us.COMBO_UPDATED,this.startComboGuide,this))}},{key:"startAutoGuides",value:function(){this.startHintGuide(),this.startStormGuide()}},{key:"stopAutoGuides",value:function(){null!==this.guideHintDelay&&this.guideHintDelay.stop(),null!==this.guideStormDelay&&this.guideStormDelay.stop()}},{key:"startHintGuide",value:function(){var e=this;this.isHintGuideLevel()&&(null===this.guideHintDelay&&(this.guideHintDelay=L(this.node).delay(5).call((function(){e.isNewbieGuideLevel()||(e.hasGuideItemShowed(eP)&&e.status===bL?e.node.scene.emit(Us.SHOW_HINT):e.startGuide(eP),e.startHintGuide())}))),this.guideHintDelay.stop(),this.guideHintDelay.start())}},{key:"startStormGuide",value:function(){var e=this;null===this.guideStormDelay&&(this.guideStormDelay=new Ie(this.node).delay(10).call((function(){e.isNewbieGuideLevel()||e.hasGuideItemShowed(nP)||e.gameplay.itemManager.canUseItem(Xe.STORM)&&(e.startGuide(nP)||e.startStormGuide())}))),this.guideStormDelay.stop(),this.guideStormDelay.start()}},{key:"startThunderGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(tP)}},{key:"startPliersGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(iP)}},{key:"handleUseItem",value:function(e){switch(this.startAutoGuides(),e){case Xe.HINT:this.addGuideItemShowed(eP);break;case Xe.THUNDER:this.addGuideItemShowed(tP);break;case Xe.STORM:this.addGuideItemShowed(nP);break;case Xe.PLIERS:this.addGuideItemShowed(iP)}}},{key:"skipNewbieGuide",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.guideUi.guideSkipButton.active=!1,e.next=3,this.guide1.close();case 3:t=this.getCurrentLevel()+1,lL.setGameData({level:t}),this.node.scene.emit(Us.NEXT_LEVEL);case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"onDestroy",value:function(){var e,t,n,i,r,a;null===(e=this.guide2)||void 0===e||e.unlistenEvents(),null===(t=this.guide3)||void 0===t||t.unlistenEvents(),null===(n=this.guide4)||void 0===n||n.unlistenEvents(),null===(i=this.guide5)||void 0===i||i.unlistenEvents(),null===(r=this.guide6)||void 0===r||r.unlistenEvents(),null===(a=this.guide7)||void 0===a||a.unlistenEvents()}}]),p}(x)).prototype,"guideUi",[eL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tL=nL))||tL);w._RF.pop(),w._RF.push({},"aa973zMvtZFD6GO7rUb6TBF","canUseHintItem",void 0);w._RF.pop(),w._RF.push({},"f3464SQfFhIs5PVRx8JpCO1","canUsePliersItem",void 0);w._RF.pop(),w._RF.push({},"ad5b3eazZ1B3YR8JJm+qvM6","canUseThunderItem",void 0);w._RF.pop(),w._RF.push({},"3b5b1bQTVlDaaFOGKDB5VZk","canUseTornadoItem",void 0);var SL,CL;w._RF.pop(),w._RF.push({},"e1fd9AcoshNdK0i6vow/F2P","ItemManager",void 0);var EL,xL=S.ccclass,AL=codex.player,TL=(m(SL={},Xe.HINT,{canActivate:!1,quantity:0}),m(SL,Xe.THUNDER,{canActivate:!1,quantity:0}),m(SL,Xe.STORM,{canActivate:!1,quantity:0}),m(SL,Xe.PLIERS,{canActivate:!1,quantity:0}),SL),PL=xL("ItemManager")(CL=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).itemConfigs=TL,e}return e(o,[{key:"onLoad",value:function(){this.node.scene.on(Us.GRID_CREATE,this.updateItemsConfig,this),this.node.scene.on(Us.GRID_MATCH,this.updateItemsConfig,this),this.node.scene.on(Us.GRID_CLEAR,this.updateItemsConfig,this),this.node.scene.on(Us.GRID_SPAWN,this.updateItemsConfig,this),this.node.scene.on(Us.BOMB_EXPLODE,this.updateItemsConfig,this),this.node.scene.on(Us.REFRESH_ITEMS,this.updateItemsConfig,this)}},{key:"init",value:function(e){this.game=e}},{key:"getQuantity",value:function(e){return this.itemConfigs[e].quantity}},{key:"setQuantity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.max(0,t);this.itemConfigs[e].quantity=i,this.saveQuantity(e,t),this.updateItemConfig(e,n)}},{key:"saveQuantity",value:function(e,t){var n=AL.getGameData();n&&AL.setGameData({items:u(u({},n.items),{},m({},e,t))})}},{key:"canUseItem",value:function(e){var t=this.game,n=t.board,i=t.pathDraw;switch(e){case Xe.HINT:return function(e,t){return e.getUncleared().length>0&&!1===t.isDrawingHint}(n,i);case Xe.PLIERS:return function(e){return e.getBombTiles().length>0}(n);case Xe.STORM:return function(e){return e.getUncleared().length>4}(n);case Xe.THUNDER:return function(e){return e.getUncleared().length>=4}(n);default:return!1}}},{key:"updateItemsConfig",value:function(){var e=AL.getGameData();if(e&&e.items){for(var t=0,n=Object.keys(this.itemConfigs);t<n.length;t++){var i=n[t],r=this.itemConfigs[i];r.canActivate=this.canUseItem(i),r.quantity=e.items[i]||0}this.game.uiManager.currentLayout.updateStatus({items:this.itemConfigs})}}},{key:"updateItemConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=AL.getGameData();n&&(this.itemConfigs[e].canActivate=this.canUseItem(e),this.itemConfigs[e].quantity=n.items[e]||0,this.game.uiManager.currentLayout.updateStatus(u({items:u(u({},this.itemConfigs),{},m({},e,u({animate:t},this.itemConfigs[e])))},this.game.uiManager.config)))}}]),o}(x))||CL;w._RF.pop(),w._RF.push({},"3f8fenpEyBKaaNxBYL5960v","ScoreManager",void 0);var RL=S.ccclass,LL=Ludex.Match.Modes,IL=RL("ScoreManager")(EL=function(r){n(u,r);var s,l=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=l.call.apply(l,[this].concat(i))).currentScore=0,e}return e(u,[{key:"addScore",value:function(e,t,n){var i=this.getLevelMultiplier(e),r=this.getComboMultiplier(t),a=this.getTimeMultiplier(e,n),o=this.getCustomBonusScoreMultiplier(),s=Math.floor(this.currentScore+10*i*r*a*o),l=10*Math.ceil(s/10);this.setScore(l)}},{key:"init",value:function(){this.initCurrentScore(),this.updateScore()}},{key:"initCurrentScore",value:function(){var e;hy.getMatchMode()!==LL.TOURNAMENT?this.currentScore=0:this.currentScore=(null===(e=hy.getMatchCustomData())||void 0===e?void 0:e.score)||0}},{key:"setScore",value:function(e){this.currentScore=e,this.updateScore()}},{key:"updateScore",value:(s=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.scene.emit(Us.SCORE_UPDATED,this.currentScore);case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getLevelMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getComboMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getTimeMultiplier",value:function(e,t){return e<=2?4:1+.05*t}},{key:"getCustomBonusScoreMultiplier",value:function(){return hy.getMatchMode()!==vy?1:1+Ry.getCustomBonus()/100}}]),u}(x))||EL;w._RF.pop(),w._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var OL=function(){function n(e){t(this,n),this.game=null,this.data={},this.game=e.getGameplay(),this.manager=e,this.updateStateData(),this.logDebug()}return e(n,[{key:"logDebug",value:function(){var e=this.constructor.name;console.debug("[STATE] ".concat(e),this.data)}},{key:"updateStateData",value:function(){if(this.game){var e=this.game.getGameData();e&&(this.data=e)}}},{key:"updateGameData",value:function(e){var t;null===(t=this.game)||void 0===t||t.setGameData(e)}}]),n}();w._RF.pop(),w._RF.push({},"e4ee7Ho9zJPVKobpdsCwGlp","FailState",void 0);var _L=codex,DL=_L.analytics,ML=_L.storage,NL=Ludex.Match.Modes,BL=function(r){n(h,r);var s,l,u,c,p=i(h);function h(e,n){var i;return t(this,h),i=p.call(this,e),Ve.stopAllSounds(),i.vibrateDevice(),i.pauseCountdown(),i.updateMatchCustomData(),i.handleGameOver(n),i.logLevelFailAnalytics(),i}return e(h,[{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseTime()}},{key:"vibrateDevice",value:function(){var e;null===(e=re("Vibrate"))||void 0===e||null===(e=e.getComponent(xd))||void 0===e||e.vibrate(500)}},{key:"handleGameOver",value:function(e){var t=hy.getMatchMode();t===NL.SINGLE||t===vy?this.handleSingleGameOver(e):t===NL.TOURNAMENT?this.handleTournamentGameOver():t===NL.CHALLENGE_FRIEND?this.handleChallengeGameOver():this.handleSingleGameOver(e)}},{key:"handleSingleGameOver",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.openFailScreenAndWaitForClose(t);case 4:if(r=e.sent,a=null!==(n=r.screenData)&&void 0!==n?n:{},s=a.customMode,l=a.rescue,s){e.next=9;break}return l?(this.game.node.scene.emit(Us.SHOW_UI),this.game.node.scene.emit(Us.RESCUE_START)):this.game.node.scene.emit(Us.GAME_REPLAY),e.abrupt("return");case 9:return e.next=11,nt.openScreenAndWaitForClose(it.CUSTOM_GAME_SCREEN);case 11:u=e.sent,c=null!==(i=u.screenData)&&void 0!==i?i:{},p=c.customMode,h=p?vy:NL.SINGLE,this.game.node.scene.emit(Us.GAME_REPLAY,h);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"handleTournamentGameOver",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h,d,y,f=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:if(i=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},r=i.tournamentId){e.next=5;break}return e.abrupt("return");case 5:if(!rt.validateTournamentExpired(r)){e.next=12;break}return ML.setStorageData("tournament","animateTournamentLeader",!1),nt.showNotificationScreenWithLocalizedKey("error.tourEnded",2),null===(a=this.game)||void 0===a||a.scheduleOnce((function(){var e;null===(e=f.game)||void 0===e||e.node.scene.emit(Us.GAME_EXIT)}),2),e.abrupt("return");case 12:if(tt.setBlockInput(!0),e.prev=13,l=null!==(s=ML.getStorageData("tournament","previousScore"))&&void 0!==s?s:0,u=this.game.scoreManager.getCurrentScore(),!(c=u>l)){e.next=22;break}if(d=null!==(p=hy.getMatchCustomData())&&void 0!==p?p:{},y=d.tournamentId){e.next=21;break}return e.abrupt("return");case 21:rt.saveTournamentProgress(null!==(h=this.data.level)&&void 0!==h?h:1,u,y);case 22:return ML.setStorageData("tournament","animateTournamentLeader",c),e.next=25,hy.finishMatchAsync();case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(13),console.warn(e.t0);case 30:tt.setBlockInput(!1),null===(n=this.game)||void 0===n||n.node.scene.emit(Us.GAME_EXIT);case 32:case"end":return e.stop()}}),e,this,[[13,27]])}))),function(){return u.apply(this,arguments)})},{key:"handleChallengeGameOver",value:(l=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return tt.setBlockInput(!0),e.prev=3,n=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},i=n.challengeData,e.next=7,hy.finishMatchAsync({extraData:{challengeData:i}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.warn(e.t0);case 12:tt.setBlockInput(!1),this.game.node.scene.emit(Us.SHOW_CHALLENGE_RESULTS);case 14:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(){return l.apply(this,arguments)})},{key:"openFailScreenAndWaitForClose",value:(s=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.data.level,t===dy&&Ve.playSound(Ji.LEVEL_FAIL_TIMEOUT),Ve.playSound(Ji.LEVEL_FAIL),e.abrupt("return",nt.openScreenAndWaitForClose(it.RESCUES_SCREEN,{level:n,failKey:t}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"updateMatchCustomData",value:function(){var e;if(this.game){var t=this.data.level,n=void 0===t?1:t,i=null===(e=this.game)||void 0===e?void 0:e.scoreManager.getCurrentScore();hy.updateMatchStateAfterLevelFinish(n,i)}}},{key:"logLevelFailAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=hy.getMatchMode()||void 0;null==DL||DL.levelFail(t,n,i)}}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){}}]),h}(OL);w._RF.pop(),w._RF.push({},"a9bc11SkV9L/5L+Y+fhswfJ","FinishState",void 0);var zL=codex,FL=zL.analytics,UL=zL.player,GL=zL.leaderboard,HL=Ludex,qL=HL.Match.Modes,VL=HL.Utils.Time,WL=HL.Plugins.Ads,KL=(void 0===WL?{}:WL).Types,jL=Ludex.Configs.Ads.NotifyPlayerBeforeShow,YL=function(r){n(m,r);var s,l,u,c,p,h,d,y,f,v=i(m);function m(e){var n;return t(this,m),(n=v.call(this,e)).handleFinishStateFlow(),n}return e(m,[{key:"handleFinishStateFlow",value:(f=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:this.processCrazyGamesEvent(),this.attemptCallCreateShortcut(),this.game.uiManager.pauseTime(),t=hy.getMatchMode(),this.updatePlayerProgress(),this.updateMatchCustomData(),t===qL.CHALLENGE_FRIEND?this.handleFinishChallenge():t===qL.TOURNAMENT?this.handleFinishTournament():this.handleFinishSingle(),this.logLevelCompleteAnalytics();case 10:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"attemptCallCreateShortcut",value:function(){var e=this.data.level;(void 0===e?0:e)<2||KL&&at.isReadyAdShowable(KL.INTERSTITIAL)||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("createShortcutAsync",e)}))}},{key:"updatePlayerProgress",value:function(){var e=this.data.level,t=UL.getGameData();if(this.game&&e&&t){var n=hy.getMatchMode(),i=t.level,r=e+1,a=Math.max(i,r);if(n===qL.SINGLE||n===vy)UL.setGameData({level:a});else if(n===qL.TOURNAMENT){var o,s=(null!==(o=hy.getMatchCustomData())&&void 0!==o?o:{}).tournamentId;if(!s)return;var l=this.game.scoreManager.getCurrentScore();rt.saveTournamentProgress(e,l,s)}}}},{key:"updateMatchCustomData",value:function(){if(this.game){var e=this.data.level,t=void 0===e?1:e,n=this.game.scoreManager.getCurrentScore();hy.updateMatchStateAfterLevelFinish(t,n)}}},{key:"logLevelCompleteAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=hy.getMatchMode()||void 0;null==FL||FL.levelComplete(t,n,i)}}},{key:"handleFinishChallenge",value:(y=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,nt.showLoadingScreen(),n=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},i=n.challengeData,e.next=7,hy.finishMatchAsync({extraData:{challengeData:i}});case 7:this.game.node.scene.emit(Us.SHOW_CHALLENGE_RESULTS),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.warn("finish challenge error",e.t0);case 13:return e.prev=13,nt.closeLoadingScreen(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(){return y.apply(this,arguments)})},{key:"handleFinishTournament",value:(d=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.handlePostTournamentScore(),this.game){e.next=3;break}return e.abrupt("return");case 3:return t=this.data.level,n=void 0===t?1:t,Ve.playSound(Ji.LEVEL_COMPLETE,{volume:.5}),this.game.effectManager.playConfettiEffect(),e.next=8,VL.sleepAsync(500);case 8:return e.next=10,at.showInterstitialAdAsync({forLevel:n});case 10:this.game.node.scene.emit(Us.NEXT_LEVEL);case 11:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handlePostTournamentScore",value:(h=a(o().mark((function e(){var t,n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:if(n=null===(t=this.game)||void 0===t?void 0:t.scoreManager.getCurrentScore()){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,GameSDK.tournament.postScoreAsync(n);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.warn("GameSDK post score async",e.t0);case 13:if(i=hy.getMatchCustomData()){e.next=16;break}return e.abrupt("return");case 16:if(r=i.leaderboardId,a=i.playerId,r&&a){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,GL.setLeaderboardScoreAsync(r,a,n);case 21:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(){return h.apply(this,arguments)})},{key:"handleFinishSingle",value:(p=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ve.turnUpMusic(),t=this.data.level,i=(n=void 0===t?0:t)>0&&n%5==0,12!==n){e.next=8;break}return e.next=7,this.handleUnlockCustomMode();case 7:return e.abrupt("return");case 8:if(!i){e.next=13;break}return e.next=11,this.handleFinishHardLevel();case 11:e.next=15;break;case 13:return e.next=15,this.handleFinishNormalLevel();case 15:this.handleNextLevelSingle();case 16:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleFinishNormalLevel",value:(c=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:if(i=this.data.level,r=void 0===i?0:i,a=null!==(t=UL.getGameData())&&void 0!==t?t:{},s=a.coins,l=void 0===s?0:s,u=null!==(n=hy.getMatchCustomData())&&void 0!==n?n:{},c=u.score,p=void 0===c?0:c,!jL){e.next=8;break}return e.next=8,this.game.uiManager.interstitialAdIndicator.flash();case 8:if(h=GameSDK.isGameSDK("Yandex")){e.next=12;break}return e.next=12,this.showAdsNormalLevel(.8);case 12:return Ve.playSound(Ji.LEVEL_COMPLETE,{volume:.5}),e.next=15,nt.openScreenAndWaitForClose(it.LEVEL_COMPLETE_SCREEN,{level:r,coins:l,score:p,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1});case 15:if(!h){e.next=18;break}return e.next=18,this.showAdsNormalLevel();case 18:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"showAdsNormalLevel",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>0&&void 0!==l[0]?l[0]:0,this.game){e.next=3;break}return e.abrupt("return");case 3:if(i=this.data.level,r=void 0===i?0:i,a=null!==(t=UL.getGameData())&&void 0!==t?t:{},s=a.custom,hy.getMatchMode()!==vy||null==s||!s.ads){e.next=13;break}return this.game.node.scene.emit(Us.HIDE_UI),e.next=9,Ue.waitTweenAsync(n);case 9:return e.next=11,at.showRewardedInterstitialAdAsync({forceLoad:!0,showError:!1});case 11:e.next=19;break;case 13:if(!KL||!at.isReadyAdShowable(KL.INTERSTITIAL)){e.next=19;break}return this.game.node.scene.emit(Us.HIDE_UI),e.next=17,Ue.waitTweenAsync(n);case 17:return e.next=19,at.showInterstitialAdAsync({forLevel:r});case 19:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleFinishHardLevel",value:(l=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h,d,y,f,v,m,g,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.data.level,s=void 0===a?0:a,l=null!==(t=null===(n=UL.getGameData())||void 0===n?void 0:n.coins)&&void 0!==t?t:0,u=null!==(i=null===(r=hy.getMatchCustomData())||void 0===r?void 0:r.score)&&void 0!==i?i:0,Ve.playSound(Ji.LEVEL_COMPLETE,{volume:.5}),e.next=6,nt.openScreenAndWaitForClose(it.LEVEL_COMPLETE_SCREEN,{level:s,coins:l,score:u,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!0});case 6:if(c=e.sent,p=c.screenData,void 0!==(h=(null!=p?p:{}).canShowRewardsAd)&&h){e.next=13;break}return e.next=12,at.showInterstitialAdAsync({forLevel:s});case 12:return e.abrupt("return");case 13:return e.next=15,nt.openScreenAndWaitForClose(it.GET_REWARDS_SCREEN);case 15:return d=e.sent,y=d.screenData,v=(f=null!=y?y:{}).getRewardsSuccess,m=void 0!==v&&v,g=f.rewardsAdShown,b=void 0!==g&&g,m&&this.getRewardItems(),e.next=21,nt.openScreenAndWaitForClose(it.LEVEL_COMPLETE_SCREEN,{level:s,coins:l,score:u,getRewardsSuccess:m,lookingForRewards:!1});case 21:if(!m&&!b){e.next=23;break}return e.abrupt("return");case 23:return e.next=25,at.showInterstitialAdAsync({forLevel:s});case 25:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleUnlockCustomMode",value:(s=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return i=this.data.level,r=void 0===i?0:i,a=null!==(t=UL.getGameData())&&void 0!==t?t:{},s=a.coins,l=void 0===s?0:s,u=null!==(n=hy.getMatchCustomData())&&void 0!==n?n:{},c=u.score,p=void 0===c?0:c,Ve.playSound(Ji.LEVEL_COMPLETE,{volume:.5}),e.next=8,nt.openScreenAndWaitForClose(it.LEVEL_COMPLETE_SCREEN,{level:r,coins:l,score:p,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1});case 8:ot.switchToDashboardScene();case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleNextLevelSingle",value:function(){var e=this.data.level,t=UL.getGameData();this.game&&e&&t&&this.game.node.scene.emit(Us.NEXT_LEVEL)}},{key:"getRewardItems",value:function(){this.game&&(this.game.node.scene.emit(Us.ADD_ITEM,{item:Xe.STORM,quantity:1}),this.game.node.scene.emit(Us.ADD_ITEM,{item:Xe.THUNDER,quantity:1}))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),m}(OL);w._RF.pop(),w._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var JL=codex,ZL=JL.player,XL=JL.match,QL=Ludex.Match.Modes,$L=function(r){n(f,r);var s,l,c,p,h,d,y=i(f);function f(e){var n;return t(this,f),(n=y.call(this,e)).clearBoard(),n.initAdPreload(),n.initCountdown(),n.initScore(),n.loadLevelAndUI(),n}return e(f,[{key:"loadLevelAndUI",value:function(){var e=this;this.setAdVisibility(),this.loadLevel().then((function(){e.updateUI()}))}},{key:"clearBoard",value:function(){this.game&&(this.game.rescueTiles=[],this.game.board.destroyTiles(),this.game.board.clearAnimationQueue(),this.game.pathDraw.clearMatchPath())}},{key:"setAdVisibility",value:function(){var e=this.data.level,t=void 0!==e&&e>st.NUM_LEVEL_WITHOUT_BANNER_ADS;at.setAvoidBannerShowed(!t),at.updateBannerAdsByLayout(Ye.getCurrentLayout()),at.refreshBannerAdVisibility()}},{key:"loadLevel",value:(d=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:if(t=hy.getMatchMode(),e.prev=3,t!==QL.CHALLENGE_FRIEND){e.next=11;break}return e.next=7,this.loadChallengeFriendMode();case 7:return n=e.sent,Ve.playSound(Ji.LEVEL_START),this.handleChallengeFriendModeStart(n),e.abrupt("return");case 11:if(t!==QL.TOURNAMENT){e.next=17;break}return e.next=14,this.loadSingleMode();case 14:return Ve.playSound(Ji.LEVEL_START),this.handleTournamentModeStart(),e.abrupt("return");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),console.error("Error loading level:",e.t0);case 22:return e.next=24,this.loadSingleMode();case 24:Ve.playSound(Ji.LEVEL_START),this.handleSingleModeStart();case 26:case"end":return e.stop()}}),e,this,[[3,19]])}))),function(){return d.apply(this,arguments)})},{key:"loadChallengeFriendMode",value:(h=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}throw new Error("Game is not initialized");case 2:return e.next=4,hy.getMatchCustomDataAsync();case 4:if(null!=(t=XL.getMatchState().customData.challengeData)){e.next=7;break}throw new Error("Challenge friend mode need to have data.");case 7:return n=this.game.levelManager,e.next=10,n.loadLevel(t.level);case 10:return this.updateGameData({level:t.level,levelData:n.getLevelData()}),e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"loadSingleMode",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.game){e.next=2;break}throw new Error("Game is not initialized");case 2:return t=this.game.levelManager,e.next=5,t.loadLevel(this.data.level);case 5:this.updateGameData({levelData:t.getLevelData()});case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleChallengeFriendModeStart",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return n=this.game.levelManager.getLevelData(),i=t.level,r=t.fen,a=t.gravity,s=t.rules,l=t.time,c=ZL.getPlayerId(),e.next=7,Promise.all([hy.setMatchCustomDataAsync({level:i,score:0}),hy.setProfileMatchDataAsync({id:c,score:0})]);case 7:return p=$d.loadLevelSpriteFrames(t.level),e.next=10,this.game.board.create(p,u(u({},n),{},{level:i,customFen:r,mode:a,rules:s,time:l}));case 10:return this.game.board.setIgnoreInput(!0),e.next=13,this.game.board.animateTilesAppear();case 13:return this.game.board.setIgnoreInput(!1),e.next=16,p;case 16:this.ready();case 17:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"handleSingleModeStart",value:(l=a(o().mark((function e(){var t,n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return i=this.game.levelManager.getLevelData(),r=null!==(t=this.data.level)&&void 0!==t?t:1,a=ZL.getPlayerId(),e.next=7,Promise.all([hy.setMatchCustomDataAsync({level:r,score:0}),hy.setProfileMatchDataAsync({id:a,score:0})]);case 7:return s=$d.loadLevelSpriteFrames(r),e.next=10,this.game.board.create(s,i);case 10:return this.game.board.setIgnoreInput(!0),e.next=13,this.game.board.animateTilesAppear();case 13:if(null!==(n=this.game.guidelinesManager)&&void 0!==n&&n.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),!(r&&r>0&&r%5==0)){e.next=26;break}return Ye.isLandscape()&&this.game.handleShowUI(),e.next=19,nt.openScreen(it.HARD_LEVEL_SCREEN);case 19:return e.next=21,Ue.waitTweenAsync(1.3);case 21:return nt.closeScreen(it.HARD_LEVEL_SCREEN),tt.setBlockInput(!0),e.next=25,this.game.board.animateTilesWave();case 25:tt.setBlockInput(!1);case 26:this.ready();case 27:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"handleTournamentModeStart",value:(s=a(o().mark((function e(){var t,n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.game){e.next=2;break}return e.abrupt("return");case 2:return i=this.game.levelManager.getLevelData(),r=null!==(t=this.data.level)&&void 0!==t?t:1,a=ZL.getPlayerId(),e.next=7,Promise.all([hy.setMatchCustomDataAsync({level:r}),hy.setProfileMatchDataAsync({id:a})]);case 7:return s=$d.loadLevelSpriteFrames(r,this.data.themeId),e.next=10,this.game.board.create(s,i);case 10:return this.game.board.setIgnoreInput(!0),e.next=13,this.game.board.animateTilesAppear();case 13:return null!==(n=this.game.guidelinesManager)&&void 0!==n&&n.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),e.next=16,s;case 16:this.ready();case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"initAdPreload",value:function(){this.game&&(this.game.isAdPreloadedForCurrentLevel=!1)}},{key:"initScore",value:function(){this.game&&this.game.scoreManager.init()}},{key:"initCountdown",value:function(){this.game&&this.game.clockManager.init()}},{key:"updateUI",value:function(){if(this.game){var e=this.game.getGameData();if(e){var t=e.level,n=void 0===t?0:t,i=e.levelData;this.game.uiManager.setLevelText(n),i&&this.game.clockManager.setTime(i.time)}}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),f}(OL);w._RF.pop(),w._RF.push({},"e3b372NaI5HvY5HnTleBQKd","PlayingState",void 0);var eI=Ludex.Plugins.Ads,tI=(void 0===eI?{}:eI).Types,nI=function(r){n(o,r);var a=i(o);function o(e){var n;return t(this,o),(n=a.call(this,e)).startCountdown(),n.preloadNextLevelSkins(),tI&&at.preloadAdsByType(tI.INTERSTITIAL),n}return e(o,[{key:"preloadNextLevelSkins",value:function(){var e,t=null!==(e=this.data.level)&&void 0!==e?e:1;$d.preloadLevelSpriteFrames(t+1)}},{key:"startCountdown",value:function(){var e;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||(this.game.clockManager.startCountdown(),this.game.uiManager.startCountdown()))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(e){var t=this.manager.createFailState(this.manager,e);this.manager.change(t)}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){this.updateStateData()}}]),o}(OL);w._RF.pop(),w._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var iI,rI=codex.analytics,aI=Ludex.Utils.Valid,oI=[Ji.COMBO_1,Ji.COMBO_2,Ji.COMBO_3,Ji.COMBO_4,Ji.COMBO_5,Ji.COMBO_6,Ji.COMBO_7,Ji.COMBO_8,Ji.COMBO_9,Ji.COMBO_10,Ji.COMBO_11,Ji.COMBO_12,Ji.COMBO_13,Ji.TILE_MATCH,Ji.BOMB_DEFUSE,Ji.BOMB_EXPLODE_1,Ji.BOMB_EXPLODE_2,Ji.TILE_SELECT,Ji.THUNDERBOLT,Ji.SHUFFLE_ITEM,Ji.LEVEL_START,Ji.LEVEL_COMPLETE,Ji.LEVEL_FAIL],sI=function(r){n(o,r);var a=i(o);function o(e){var n;return t(this,o),n=a.call(this,e),Ve.stopAllSounds(),Ve.turnDownMusic(),n.preloadAssets(),n.handleGuideFlow(),n.setGridPlayable(),n.logLevelStartAnalytics(),n}return e(o,[{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(e){if(aI.isDebugger()){var t=this.manager.createFailState(this.manager);this.manager.change(t)}}},{key:"finish",value:function(){if(aI.isDebugger()){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}}},{key:"update",value:function(){}},{key:"preloadAssets",value:function(){var e;this.preloadSounds(),null===(e=this.game)||void 0===e||e.effectManager.preloadEffects()}},{key:"preloadSounds",value:function(){for(var e=0,t=oI;e<t.length;e++){var n=t[e];Fe.loadAudioAsync(n)}}},{key:"setGridPlayable",value:function(){var e;null!==(e=this.manager.getGameplay().guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||this.manager.getGameplay().board.setIgnoreInput(!1)}},{key:"handleGuideFlow",value:function(){var e,t;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||this.game.handleShowUI(),null===(t=this.game.guidelinesManager)||void 0===t||t.show())}},{key:"logLevelStartAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=(hy.getMatchCustomData()||{}).score,i=void 0===n?0:n,r=hy.getMatchMode()||void 0;null==rI||rI.levelStart(t,i,r)}}}]),o}(OL);w._RF.pop(),w._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var lI=(0,S.ccclass)("StateManager")(iI=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"getGameplay",value:function(){return this.gameplay}},{key:"init",value:function(e){this.gameplay=e,this.state=new $L(this)}},{key:"change",value:function(e){this.state=e}},{key:"initialize",value:function(){this.state.initialize()}},{key:"isInitialize",value:function(){return this.state instanceof $L}},{key:"ready",value:function(){this.state.ready()}},{key:"isReady",value:function(){return this.state instanceof sI}},{key:"playing",value:function(){this.state.playing()}},{key:"isPlaying",value:function(){return this.state instanceof nI}},{key:"fail",value:function(e){this.state.fail(e)}},{key:"isFail",value:function(){return this.state instanceof BL}},{key:"finish",value:function(){this.state.finish()}},{key:"isFinished",value:function(){return this.state instanceof YL}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b($L,t)}},{key:"createReadyState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(sI,t)}},{key:"createPlayingState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(nI,t)}},{key:"createFailState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(BL,t)}},{key:"createFinishState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(YL,t)}}]),o}(x))||iI;w._RF.pop(),w._RF.push({},"e80e4nIcfdLN56j5b9SMhvH","LeaderboardUtils",void 0);var uI,cI=codex.leaderboard,pI=function(){function n(){t(this,n)}var i,r,s;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"getAllLeaderboardAsync",value:(s=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cI){e.next=2;break}return e.abrupt("return",null);case 2:if(n=cI.getLeaderboardName(t)){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,cI.getLeaderboardResponseAsync(t);case 7:if(i=e.sent){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,this.requestLeaderboardAsync(n,i.amountPlayer);case 12:return e.abrupt("return",cI.getLeaderboard(n));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"requestLeaderboardAsync",value:(r=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLeaderboardRequesting(t)){e.next=4;break}return e.next=3,this.waitForLeaderboardFinishAsync(t);case 3:return e.abrupt("return");case 4:return e.next=6,cI.requestLeaderboardAsync(t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"waitForLeaderboardFinishAsync",value:(i=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLeaderboardRequesting(t)){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){var i=setInterval((function(){n.isLeaderboardRequesting(t)||(clearInterval(i),e())}),100)})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"isLeaderboardRequesting",value:function(e){var t;return(null===(t=cI.getLeaderboard(e))||void 0===t?void 0:t.isRequesting)||!1}}]),n}();try{new pI}catch(e){console.error("LeaderboardUtils",e)}w._RF.pop(),w._RF.push({},"a95ba1U+uJB66zZU7UYL4e5","TournamentManager",void 0);var hI,dI,yI,fI,vI,mI,gI,bI,wI,kI=S.ccclass,SI=Ludex.Utils.Object,CI=codex,EI=CI.player,xI=CI.leaderboard,AI=kI("TournamentManager")(uI=function(r){n(h,r);var s,l,u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=p.call.apply(p,[this].concat(i))).leaderData=[],e.tournamentData=null,e.leaderboardData=null,e.leaderboardName=null,e}return e(h,[{key:"init",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestTournamentData();case 2:return e.next=4,this.requestLeaderData();case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"requestTournamentData",value:(u=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},r=i.tournamentId){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,rt.requestTournamentDataAsync();case 5:this.tournamentData=null!==(n=rt.getTournamentDataById(r))&&void 0!==n?n:null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"requestLeaderData",value:(l=a(o().mark((function e(){var t,n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},i=n.leaderboardId){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.requestLeaderboardData(i);case 5:if(this.leaderboardData){e.next=7;break}return e.abrupt("return");case 7:r=EI.getPlayerId(),this.leaderData=SI.vals(this.leaderboardData.leaders).reduce((function(e,t){if(t.playerId!==r&&t.score>0){var n={score:t.score,rank:t.rank};e.push(n)}return e}),[]).sort((function(e,t){return e.score-t.score})),this.leaderData.forEach((function(e,t){e.rank=a.leaderData.length-t}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"requestLeaderboardData",value:(s=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.leaderboardName=xI.getLeaderboardName(t),e.next=3,pI.getAllLeaderboardAsync(t);case 3:this.leaderboardData=e.sent;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})}]),h}(x))||uI;w._RF.pop(),w._RF.push({},"2b89dXjcudIaZRJFuh5TAAI","InterstitialAdIndicator",void 0);var TI=S.ccclass,PI=S.property,RI=["ads.interNotice.backInSec","ads.interNotice.hangTight","ads.interNotice.quickAd"];var LI,II=Ludex.Configs.Ads.NotifyPlayerBeforeShow,OI=(hI=TI("InterstitialAdIndicator"),dI=Ii.required(),yI=PI(M),fI=Ii.required(),vI=PI(cp),hI((bI=r((gI=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"uiOpacity",bI,l(e)),s(e,"labelLocalizer",wI,l(e)),e}return e(p,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this)}},{key:"flash",value:(u=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=void 0,a=Math.floor(Math.random()*RI.length),n=RI[a],!1!==II&&n){e.next=3;break}return e.abrupt("return");case 3:return null===(t=this.signal)||void 0===t||t.abort(),i=new An,this.signal=i,this.labelLocalizer.key=n,r=L(this.uiOpacity).to(.25,{opacity:255},{easing:"linear"}).delay(.25).to(.25,{opacity:100},{easing:"linear"}).delay(.125),e.next=10,Ue.runTweenAsync(L(this.uiOpacity).repeat(2,r).to(.25,{opacity:0},{easing:"linear"}),i);case 10:this.uiOpacity.opacity=0;case 11:case"end":return e.stop()}var a}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(x)).prototype,"uiOpacity",[dI,yI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wI=r(gI.prototype,"labelLocalizer",[fI,vI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mI=gI))||mI);w._RF.pop(),w._RF.push({},"dfab8xSeglD/abIKphEhi4g","ComboContainer",void 0);var _I,DI=S.ccclass,MI=Ludex.Match.Modes,NI=DI("ComboContainer")(LI=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"__preload",value:function(){this.widget=this.node.getComponent(R),this.node.scene.on(Us.GRID_RESIZE,this.handleViewResized,this)}},{key:"init",value:function(e){this.board=e}},{key:"updateWidget",value:function(){if(Ye.isPortrait())return this.node.scale=new q(1,1,1),this.widget.right=22.5,void(this.widget.top=hy.getMatchMode()===MI.TOURNAMENT?180:160);if(this.board){this.node.scale=new q(1.5,1.5,1.5);var e=this.board.getBoundingBoxWorld().yMax,t=He.cssSizeToWorldSize(He.getScreenHeightCss());this.widget.right=142.5,this.widget.top=(t-e)/2}}},{key:"updateStatus",value:function(){this.updateWidget()}},{key:"handleViewResized",value:function(){this.updateWidget()}}]),o}(x))||LI;w._RF.pop(),w._RF.push({},"ed00dMDxYRJP4fZMawN9JnW","ComboProgressBar",void 0);var BI,zI,FI,UI,GI,HI,qI,VI,WI,KI,jI,YI,JI,ZI,XI,QI,$I,eO,tO,nO,iO,rO,aO,oO,sO,lO,uO=S.ccclass,cO=uO("ComboProgressBar")(_I=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"start",value:function(){this.progressBar=this.getComponent(Fu),this.opacity=this.getComponent(M),this.comboTimer=0,this.isActive=!1,this.node.scene.on(Us.COMBO_UPDATED,this.handleComboUpdated,this)}},{key:"update",value:function(e){this.isActive&&(this.comboTimer>0?(this.comboTimer-=e,this.progressBar.progress=this.comboTimer/2):(this.isActive=!1,this.opacity.opacity=0,this.node.scene.emit(Us.COMBO_ENDED)))}},{key:"handleComboUpdated",value:function(e){0===e?this.opacity.opacity=0:e>0&&(this.isActive=!0,this.comboTimer=2),e>1&&(this.opacity.opacity=255)}},{key:"pause",value:function(){this.isActive=!1}},{key:"resume",value:function(){this.isActive=!0}}]),o}(x))||_I;w._RF.pop(),w._RF.push({},"c3d9fl9+INO3ac7Q2zvmRKy","SpecialItem",void 0);var pO,hO,dO,yO,fO,vO,mO,gO=S.ccclass,bO=S.property,wO=(m(BI={},Xe.HINT,"item.hintDesc"),m(BI,Xe.PLIERS,"item.pliersDesc"),m(BI,Xe.STORM,"item.stormDesc"),m(BI,Xe.THUNDER,"item.thunderDesc"),BI),kO=(zI=gO("SpecialItem"),FI=bO({editorOnly:!0,tooltip:"A debug button has infinite quantity"}),UI=Ii.required,GI=bO({type:U,tooltip:"The button that activates the item"}),HI=bO({type:T,group:"Quantity",tooltip:"The starting quantity of the item",displayName:"Quantity"}),qI=Ii.required,VI=bO({type:Y,group:"Quantity",tooltip:"The label that shows the quantity",displayName:"Label"}),WI=Ii.required,KI=bO({type:H,group:"Quantity",tooltip:"The node that shows the quantity of the item",displayName:"Quantity node"}),jI=Ii.required,YI=bO({type:H,group:"Quantity",tooltip:"The node that shows the plus icon when there is no item",displayName:"Plus node"}),JI=Ii.required,ZI=bO({type:M,group:"Animation"}),XI=Ii.required,QI=bO({type:M,tooltip:"The opacity component of the button",displayName:"Button UI Opacity"}),zI((tO=r((eO=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"isDevButton",tO,l(e)),s(e,"button",nO,l(e)),s(e,"quantity",iO,l(e)),s(e,"quantityLabel",rO,l(e)),s(e,"quantityNode",aO,l(e)),s(e,"plusNode",oO,l(e)),s(e,"glowUIOpacity",sO,l(e)),s(e,"uiOpacity",lO,l(e)),e.vibrateComp=null,e}return e(h,[{key:"itemType",get:function(){}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this,h)}},{key:"updateStatus",value:function(e){var t;if(void 0!==this.itemType){var n=null===(t=e.items)||void 0===t?void 0:t[this.itemType];n&&(this.setActiveStatus(n.canActivate),this.setQuantity(n.quantity,n.animate))}}},{key:"setActiveStatus",value:function(e){var t;null===(t=this.signal)||void 0===t||t.abort();var n=new An;this.signal=n,this.button.interactable=e,Ue.runTweenAsync(L(this.uiOpacity).to(.2,{opacity:e?255:128}),n)}},{key:"activate",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.quantity<=0)){e.next=3;break}return this.requestItem(),e.abrupt("return");case 3:this.vibrate(),this.node.scene.emit(Us.USE_ITEM,this.itemType);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"setQuantity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;if(this.isDevButton)return this.quantityLabel.string="i",this.quantityNode.active=!0,void(this.plusNode.active=!1);n=Math.max(0,n),this.quantity=n,this.quantityLabel.string="".concat(this.quantity),n<=0?(this.quantityNode.active=!1,this.plusNode.active=!0):(this.quantityNode.active=!0,this.plusNode.active=!1),t&&this.animateAddItem()}},{key:"requestItem",value:function(){void 0!==this.itemType?nt.openScreen(it.GET_ITEM_SCREEN,{item:this.itemType,localizedMessageKey:wO[this.itemType],quantity:1}):console.warn("Item type is not defined")}},{key:"vibrate",value:function(){var e,t;this.vibrateComp=null!==(e=this.vibrateComp)&&void 0!==e?e:this.node.getComponent(xd),null===(t=this.vibrateComp)||void 0===t||t.vibrate(50)}},{key:"animateAddItem",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.glowUIOpacity.opacity=0,e.abrupt("return",Promise.all([Ue.runTweenAsync(L(this.node).to(.1,{scale:new q(1.15,1.15,1.15)},{easing:"cubicOut"}).delay(.2).to(.7,{scale:q.ONE},{easing:"elasticOut"})),Ue.runTweenAsync(L(this.glowUIOpacity).to(.1,{opacity:100}).delay(.2).to(.6,{opacity:0}))]));case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"isDevButton",[FI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nO=r(eO.prototype,"button",[UI,GI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iO=r(eO.prototype,"quantity",[HI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),rO=r(eO.prototype,"quantityLabel",[qI,VI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aO=r(eO.prototype,"quantityNode",[WI,KI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oO=r(eO.prototype,"plusNode",[jI,YI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sO=r(eO.prototype,"glowUIOpacity",[JI,ZI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lO=r(eO.prototype,"uiOpacity",[XI,QI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$I=eO))||$I);w._RF.pop(),w._RF.push({},"9e40aEq56tMKLFoeACyl+eH","Clock",void 0);var SO=S.ccclass,CO=S.disallowMultiple,EO=S.property,xO=(pO=SO("Clock"),hO=EO(H),dO=EO(Y),pO(yO=CO((vO=r((fO=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"clockIcon",vO,l(e)),s(e,"timeLabel",mO,l(e)),e}return e(h,[{key:"__preload",value:function(){this.node.scene.on(Us.TIME_UPDATED,this.updateTimeLabel,this),this.node.scene.on(Us.RESCUE_START,this.handleRescueStart,this),this.node.scene.on(Us.RESCUE_FINISHED,this.handleRescueFinished,this)}},{key:"updateStatus",value:function(e){void 0!==e.time&&this.updateTimeLabel(e.time)}},{key:"updateTimeLabel",value:function(e){var t=this.convertSecondsToMmSs(e);this.timeLabel.string=t}},{key:"convertSecondsToMmSs",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60),i=this.padZero(t),r=this.padZero(n);return"".concat(i,":").concat(r)}},{key:"padZero",value:function(e){return e<10?"0".concat(e):"".concat(e)}},{key:"handleRescueStart",value:(c=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=L(this.node).to(.5,{scale:new q(1.1,1.1,1)}),n=L(this.clockIcon).to(.15,{angle:-15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}).to(.15,{angle:15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}),i=L(this.clockIcon).repeat(5,n),Ue.runTweenAsync(i),Ue.runTweenAsync(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleRescueFinished",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=L(this.node).to(.5,{scale:new q(1,1,1)}),Ue.runTweenAsync(t);case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"clockIcon",[hO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mO=r(fO.prototype,"timeLabel",[dO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yO=fO))||yO)||yO);w._RF.pop(),w._RF.push({},"af947t5g91EkZVWXv5upZaV","CacheUtils",void 0);var AO,TO,PO,RO,LO,IO,OO,_O,DO,MO,NO,BO=Ludex.Utils.Image,zO=codex.frameCapture,FO=function(){function n(){t(this,n)}var i,r,s;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"getPlayerAvatar",value:(s=a(o().mark((function e(t,n,i,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.playerAvatarCache$.get("".concat(n,":").concat(i))){e.next=5;break}return e.next=4,this.loadPlayerAvatar(t,n,i,r);case 4:a=e.sent;case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return s.apply(this,arguments)})},{key:"loadPlayerAvatar",value:(r=a(o().mark((function e(t,n,i,r){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadImage(t,i,i,"".concat(n,":").concat(i));case 2:if(a=e.sent,(null==r||!r.aborted)&&a){e.next=5;break}return e.abrupt("return");case 5:return s=se.createWithImage(a),this.playerAvatarCache$.set("".concat(n,":").concat(i),s),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"isAvatarCached",value:function(e,t){return this.playerAvatarCache$.has("".concat(e,":").concat(t))}},{key:"loadImage",value:(i=a(o().mark((function e(t,n,i,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zO.captureAsync({width:n,height:i,name:"LeaderAvatar",renderOptions:m({},r,{name:r,type:"image",depth:0,position:[0,0],size:[n,i],image:t})});case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,BO.loadImage(a);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),function(e,t,n,r){return i.apply(this,arguments)})}]),n}();FO.playerAvatarCache$=new Map;try{new FO}catch(e){console.error("CacheUtils",e)}w._RF.pop(),w._RF.push({},"540108ucKBPYbN9gW5TFh/q","LeaderRail",void 0);var UO,GO,HO,qO,VO,WO=S.ccclass,KO=S.property,jO=(AO=WO("LeaderRail"),TO=KO(Y),PO=KO(H),RO=KO(N),LO=KO(Ex),AO((_O=r((OO=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"scoreLabel",_O,l(e)),s(e,"crown",DO,l(e)),s(e,"avatar",MO,l(e)),s(e,"spark",NO,l(e)),e.score=0,e}return e(h,[{key:"__preload",value:function(){this.defaultAvatar=this.avatar.spriteFrame,this.uiOpacity=this.getComponent(M)}},{key:"updateScore",value:(c=a(o().mark((function e(t,n){var i,r,a,s,l=this,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]&&u[2],r=t-this.score,a=i?0:.5,s=L(this.node).to(a,{},{onUpdate:function(e,t){if(t){var n=Math.floor(r*t)+l.score;l.scoreLabel.string=n.toString()}}}),e.next=6,Ue.runTweenAsync(s,n);case 6:this.score=t,this.scoreLabel.string=t.toString();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"updatePhoto",value:(u=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameSDK.player.getPhoto(),n=GameSDK.player.getID(),t&&n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,FO.getPlayerAvatar(t,n,50);case 6:if(i=e.sent){e.next=10;break}return this.avatar.spriteFrame=this.defaultAvatar,e.abrupt("return");case 10:i.packable=!0,this.avatar.spriteFrame=i;case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setCrown",value:function(e){this.crown.active=e}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"playSparkParticle",value:function(){this.spark.play()}},{key:"stopSparkParticle",value:function(){this.spark.stop()}}]),h}(x)).prototype,"scoreLabel",[TO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DO=r(OO.prototype,"crown",[PO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MO=r(OO.prototype,"avatar",[RO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NO=r(OO.prototype,"spark",[LO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IO=OO))||IO);w._RF.pop(),w._RF.push({},"00759vwS/dHS6GvHKvVE5Q1","TournamentProgressBar",void 0);var YO,JO,ZO,XO,QO,$O,e_,t_,n_,i_,r_,a_,o_,s_,l_,u_,c_,p_,h_,d_,y_=S.ccclass,f_=S.property,v_=474,m_=(UO=y_("TournamentProgressBar"),GO=f_(jO),UO((VO=r((qO=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"playerLeader",VO,l(e)),e.onUpdate=function(){e.playerLeader&&e.playerLeader.node&&(e.playerLeader.node.position=new q(e.progressBar.progress*v_-237,0,0))},e}return e(p,[{key:"__preload",value:function(){this.progressBar=this.getComponent(te)}},{key:"updateProgress",value:(u=a(o().mark((function e(t,n){var i,r,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:.5,r=s.length>3&&void 0!==s[3]?s[3]:"cubicOut",a=L(this.progressBar).to(i,{progress:t},{easing:r,onUpdate:this.onUpdate}),e.next=5,Ue.runTweenAsync(a,n);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"getProgress",value:function(){return this.progressBar.progress}}]),p}(x)).prototype,"playerLeader",[GO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HO=qO))||HO);w._RF.pop(),w._RF.push({},"16d68fBLT1Ha7lXADThDtfC","TournamentRail",void 0);var g_,b_,w_,k_,S_,C_,E_,x_,A_,T_=S.ccclass,P_=S.property,R_=Ludex,L_=R_.Utils,I_=L_.Array,O_=L_.Signal,__=L_.Valid,D_=R_.Match.Modes,M_=(YO=T_("TournamentRail"),JO=P_(m_),ZO=P_(jO),XO=P_(H),QO=P_(H),$O=P_(cp),e_=P_(cp),t_=P_(H),n_=P_(M),i_=Ii.onlyRunInLifeCycleAsync,YO((o_=r((a_=function(r){n(m,r);var u,p,h,d,y,f,v=i(m);function m(){var e;t(this,m);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=v.call.apply(v,[this].concat(i)),s(e,"progressBar",o_,l(e)),s(e,"playerLeader",s_,l(e)),s(e,"flag",l_,l(e)),s(e,"sword",u_,l(e)),s(e,"currentRankLocalizer",c_,l(e)),s(e,"nextRankLocalizer",p_,l(e)),s(e,"devTools",h_,l(e)),s(e,"challengerJoinedUiOpacity",d_,l(e)),e.challengerJoinedY=0,e.leaderData=[],e.nextLeaderIndex=0,e.score=0,e.minScore=0,e.maxScore=0,e.signal=new O_.SignalController,e}return e(m,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),this.playerLeader.updatePhoto(),this.devTools.active=__.isDebugger(),this.challengerJoinedY=this.challengerJoinedUiOpacity.node.position.y}},{key:"updateStatus",value:(f=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hy.getMatchMode()===D_.TOURNAMENT){e.next=3;break}return this.uiOpacity.opacity=0,e.abrupt("return");case 3:if(this.uiOpacity.opacity=255,n=t.leaderData,i=t.score,n&&void 0!==i){e.next=7;break}return e.abrupt("return");case 7:r=this.signal.renew(),this.score=i,this.nextLeaderIndex=this.getScoreReachedLeaderIndex(this.score,n),this.syncRail(n,r,!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"syncRail",value:(y=a(o().mark((function e(t,n){var i,r,a,s,l,u,c,p=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>2&&void 0!==p[2]&&p[2],r=t[this.nextLeaderIndex-1],a=t[this.nextLeaderIndex],s=r?r.rank:a?a.rank+1:1,this.setRankLabel(s,this.currentRankLocalizer),l=!a,this.nextRankLocalizer.node.active=!l,this.runActiveAnimation(this.sword,!l,n,i),this.playerLeader.setCrown(l),this.playerLeader.updateScore(this.score,n,i),u=i?0:void 0,l){e.next=23;break}return this.playerLeader.stopSparkParticle(),this.setRankLabel(a.rank,this.nextRankLocalizer),this.minScore=r?r.score:0,this.maxScore=a.score,(c=.8*(c=(this.score-this.minScore)/(this.maxScore-this.minScore))+.1)<this.progressBar.getProgress()&&this.showScoreUpdatedNotice(n),e.next=21,this.progressBar.updateProgress(c,n,u);case 21:e.next=26;break;case 23:return this.playerLeader.playSparkParticle(),e.next=26,this.progressBar.updateProgress(1,n,u);case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"handleScoreUpdated",value:(d=a(o().mark((function e(t){var n,i,r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.score,i=t.leaderData,void 0!==n&&i){e.next=3;break}return e.abrupt("return");case 3:if(this.leaderData=i,r=this.signal.renew(),this.score=n,!((a=this.getScoreReachedLeaderIndex(n,i))>this.nextLeaderIndex)){e.next=19;break}return this.nextLeaderIndex=a,s=(1-this.progressBar.getProgress())/1.5,s=Math.min(s,.5),e.next=13,this.progressBar.updateProgress(1,r,s,"cubicIn");case 13:return this.runBubbleAnimation(this.sword,r),e.next=16,this.progressBar.updateProgress(0,r,0);case 16:this.runBubbleAnimation(this.flag,r),e.next=29;break;case 19:if(!(a<this.nextLeaderIndex)){e.next=29;break}return this.nextLeaderIndex=a,l=this.progressBar.getProgress()/1.5,l=Math.min(l,.5),e.next=25,this.progressBar.updateProgress(0,r,l,"cubicIn");case 25:return this.runBubbleAnimation(this.flag,r),e.next=28,this.progressBar.updateProgress(1,r,0);case 28:this.runBubbleAnimation(this.sword,r);case 29:this.syncRail(i,r);case 30:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"runBubbleAnimation",value:(h=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.scale=q.ONE,i=L(t).to(.1,{scale:new q(1.2,1.2,1.2)}).to(.2,{scale:q.ONE},{easing:"backOut"}),e.next=4,Ue.runTweenAsync(i,n);case 4:t.scale=q.ONE;case 5:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"runActiveAnimation",value:(p=a(o().mark((function e(t,n,i){var r,a,s,l,u,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>3&&void 0!==c[3]&&c[3],a=n?q.ZERO:q.ONE,s=n?q.ONE:q.ZERO,!r){e.next=6;break}return t.scale=s,e.abrupt("return");case 6:if(!t.scale.equals(s)){e.next=8;break}return e.abrupt("return");case 8:return l=n?"backOut":"quadOut",t.scale=a,u=L(t).to(.1,{scale:new q(1.2,1.2,1.2)}).to(.2,{scale:s},{easing:l}),e.next=13,Ue.runTweenAsync(u,i);case 13:t.scale=s;case 14:case"end":return e.stop()}}),e)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"getScoreReachedLeaderIndex",value:function(e,t){var n=I_.searchIndex(t,(function(t){return t.score>=e}));return-1===n?t.length:n}},{key:"setRankLabel",value:function(e,t){1!==e?2!==e?3!==e?(t.key="status.nth",t.setParams([e.toString()])):t.key="status.third":t.key="status.second":t.key="status.first"}},{key:"handleDecreaseRank",value:function(){var e,t=c(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score+=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"handleIncreaseRank",value:function(){var e,t=c(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score-=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"getMedianScore",value:function(){return(this.leaderData[this.leaderData.length-1].score-this.leaderData[0].score)/this.leaderData.length}},{key:"showScoreUpdatedNotice",value:(u=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.challengerJoinedUiOpacity.node.active=!0,this.challengerJoinedUiOpacity.opacity=0,n=function(){h.challengerJoinedUiOpacity.node.active=!1,h.challengerJoinedUiOpacity.opacity=0},t.once(n),i=new q(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY-10,this.challengerJoinedUiOpacity.node.position.z),r=new q(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY,this.challengerJoinedUiOpacity.node.position.z),a=new q(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY+10,this.challengerJoinedUiOpacity.node.position.z),this.challengerJoinedUiOpacity.node.setPosition(i),s=Ue.runTweenAsync(L(this.challengerJoinedUiOpacity).to(.5,{opacity:255}),t),l=Ue.runTweenAsync(L(this.challengerJoinedUiOpacity.node).to(.5,{position:r},{easing:"cubicOut"}),t),u=Ue.waitTweenAsync(1,t),e.next=13,Promise.all([s,l,u]);case 13:return c=Ue.runTweenAsync(L(this.challengerJoinedUiOpacity.node).to(.5,{position:a},{easing:"cubicIn"}),t),p=Ue.runTweenAsync(L(this.challengerJoinedUiOpacity).to(.5,{opacity:0}),t),e.next=17,Promise.all([c,p]);case 17:t.off(n);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),m}(x)).prototype,"progressBar",[JO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=r(a_.prototype,"playerLeader",[ZO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l_=r(a_.prototype,"flag",[XO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u_=r(a_.prototype,"sword",[QO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c_=r(a_.prototype,"currentRankLocalizer",[$O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p_=r(a_.prototype,"nextRankLocalizer",[e_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h_=r(a_.prototype,"devTools",[t_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d_=r(a_.prototype,"challengerJoinedUiOpacity",[n_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(a_.prototype,"updateStatus",[i_],Object.getOwnPropertyDescriptor(a_.prototype,"updateStatus"),a_.prototype),r_=a_))||r_);w._RF.pop(),w._RF.push({},"ac5371+oVZBLoBKwAM7rH3r","GameSceneLayout",void 0);var N_,B_,z_,F_,U_,G_,H_,q_,V_,W_,K_=S.ccclass,j_=S.property,Y_=(g_=K_("GameSceneLayout"),b_=j_(M_),w_=j_(xO),k_=j_(kO),g_((E_=r((C_=function(r){n(y,r);var u,p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=d.call.apply(d,[this].concat(i)),s(e,"tournamentRail",E_,l(e)),s(e,"clock",x_,l(e)),s(e,"items",A_,l(e)),e.isInited=!1,e.entranceSignal=new An,e.exitSignal=new An,e}return e(y,[{key:"waitForInitAsync",value:(h=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInited){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){var n=setInterval((function(){t.isInited&&(clearInterval(n),e())}),100)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"setLevelText",value:function(e){}},{key:"disableLayout",value:function(){}},{key:"enableLayout",value:function(){}},{key:"updateStatus",value:function(e){this.clock.updateStatus(e),this.tournamentRail.updateStatus(e);var t,n=c(this.items);try{for(n.s();!(t=n.n()).done;){t.value.updateStatus(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"playExitAnimUI",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){}},{key:"unHighlightCoinContainer",value:function(){}},{key:"handleScoreUpdated",value:function(e){}}]),y}(x)).prototype,"tournamentRail",[b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x_=r(C_.prototype,"clock",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A_=r(C_.prototype,"items",[k_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S_=C_))||S_);w._RF.pop(),w._RF.push({},"46f05OkhTtGz6xBJuPMZGqH","ScoreBlock",void 0);var J_,Z_,X_,Q_,$_,eD,tD,nD=S.ccclass,iD=S.property,rD=S.disallowMultiple,aD=(N_=nD("ScoreBlock"),B_=iD(Y),z_=iD(W),F_=iD({visible:function(){return this.isResizeWidth}}),U_=Ii.onlyRunInLifeCycle,N_(G_=rD((q_=r((H_=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"scoreText",q_,l(e)),s(e,"isResizeWidth",V_,l(e)),s(e,"maxScoreWidth",W_,l(e)),e.panelWidthDiff=0,e}return e(h,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(A),this.scoreUITransform=this.scoreText.node.getComponent(A),this.panelWidthDiff=this.uiTransform.width-this.maxScoreWidth,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateScore",value:(c=a(o().mark((function e(t){var n,i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t-this.score,i=L(this.node).to(.1,{},{onUpdate:function(e,t){if(t){var i=Math.floor(n*t)+r.score;r.scoreText.string=i.toString(),r.resizeWidth()}}}),e.next=4,Ue.runTweenAsync(i);case 4:return this.setScore(t),e.next=7,this.resizeWidth();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setScore",value:function(e){var t=null!=e?e:0;this.score=t,this.scoreText.string=t.toString()}},{key:"resizeWidth",value:(u=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isResizeWidth){e.next=2;break}return e.abrupt("return");case 2:if(t=this.uiTransform.width,!((n=(this.scoreUITransform.width>this.maxScoreWidth?this.scoreUITransform.width:this.maxScoreWidth)+this.panelWidthDiff)<=t&&0!==this.score)){e.next=6;break}return e.abrupt("return");case 6:return this.uiTween&&this.uiTween.stop(),this.uiTween=L(this.node).to(.05,{},{easing:"sineOut",onUpdate:function(e,r){r&&(i.uiTransform.width=$.lerp(t,n,r))}}),e.next=10,Ue.runTweenAsync(this.uiTween);case 10:this.uiTransform.width=n;case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"scoreText",[B_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V_=r(H_.prototype,"isResizeWidth",[z_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),W_=r(H_.prototype,"maxScoreWidth",[F_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r(H_.prototype,"setScore",[U_],Object.getOwnPropertyDescriptor(H_.prototype,"setScore"),H_.prototype),G_=H_))||G_)||G_);w._RF.pop(),w._RF.push({},"424745QWUlDPabdCe8UcRwy","ChallengeScoreBlock",void 0);var oD,sD,lD,uD,cD,pD,hD,dD=S.ccclass,yD=S.property,fD=(J_=dD("ChallengeScoreBlock"),Z_=yD(N),X_=yD(se),J_((eD=r(($_=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"avatar",eD,l(e)),s(e,"defaultAvatar",tD,l(e)),e}return e(p,[{key:"updateInfo",value:(u=a(o().mark((function e(t,n,i){var r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setScore(i),this.scheduleOnce((function(){return a.resizeWidth()}),0),e.prev=2,e.next=5,FO.getPlayerAvatar(t,n,50);case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return");case 8:r.packable=!0,this.setAvatarSpriteFrame(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.setAvatarSpriteFrame(this.defaultAvatar);case 15:case"end":return e.stop()}}),e,this,[[2,12]])}))),function(e,t,n){return u.apply(this,arguments)})},{key:"setAvatarSpriteFrame",value:function(e){this.isValid&&(this.avatar.spriteFrame=e)}}]),p}(aD)).prototype,"avatar",[Z_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tD=r($_.prototype,"defaultAvatar",[X_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q_=$_))||Q_);w._RF.pop(),w._RF.push({},"aa96ehFCjBCy6vss3wBcr+l","CustomScoreContainer",void 0);var vD,mD,gD,bD,wD,kD,SD,CD,ED,xD,AD,TD,PD,RD,LD,ID,OD,_D,DD,MD,ND,BD,zD=S.ccclass,FD=S.property,UD=S.disallowMultiple,GD=(oD=zD("CustomScoreContainer"),sD=FD(H),lD=FD(Y),oD(uD=UD((pD=r((cD=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"customScoreBlock",pD,l(e)),s(e,"scoreText",hD,l(e)),e}return e(o,[{key:"updateStatus",value:function(){hy.getMatchMode()===vy?(this.customScoreBlock.active=!0,this.scoreText.string="".concat(Ry.getCustomBonus(),"%")):this.customScoreBlock.active=!1}}]),o}(x)).prototype,"customScoreBlock",[sD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hD=r(cD.prototype,"scoreText",[lD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uD=cD))||uD)||uD);w._RF.pop(),w._RF.push({},"b1ef276tNtH+oc5BqYfDMXl","Sidebar",void 0);var HD,qD,VD,WD,KD,jD,YD,JD,ZD,XD,QD,$D=S.ccclass,eM=S.property,tM=S.disallowMultiple,nM={score:-589.003,item:-861.836,sidebar:1114},iM={score:-568.518,item:-981.836,sidebar:1222},rM=(vD=$D("Sidebar"),mD=eM(aD),gD=eM(H),bD=eM(Y),wD=eM(H),kD=eM(R),SD=eM(H),CD=eM(GD),ED=eM(Se),xD=eM(M),AD=Ii.onlyRunInLifeCycle,vD(TD=tM((RD=r((PD=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"scoreBlock",RD,l(e)),s(e,"itemContainer",LD,l(e)),s(e,"levelNumber",ID,l(e)),s(e,"sidebarContainer",OD,l(e)),s(e,"sidebarBackground",_D,l(e)),s(e,"leavesContainer",DD,l(e)),s(e,"customScoreContainer",MD,l(e)),s(e,"entranceCurve",ND,l(e)),s(e,"uiOpacity",BD,l(e)),e.originSidebarPosition=0,e.originLeavesPosition=0,e}return e(h,[{key:"saveOriginPos",value:function(){this.originSidebarPosition=this.sidebarContainer.position.y,this.originLeavesPosition=this.leavesContainer.position.y}},{key:"initUIPos",value:function(){this.sidebarContainer.setPosition(this.sidebarContainer.position.x,this.originSidebarPosition+1250),this.leavesContainer.setPosition(this.leavesContainer.position.x,this.originLeavesPosition+150)}},{key:"playExitAnimUI",value:(c=a(o().mark((function e(t){var n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){return a.setActive(!1)},t.addAbortListener(n),i=L(this.sidebarContainer).to(.2,{position:new q(this.sidebarContainer.position.x,this.originSidebarPosition+1250,0)},{easing:"quadIn"}),(r=L(this.leavesContainer)).delay(.1).to(.2,{position:new q(this.leavesContainer.position.x,this.originLeavesPosition+150,0)},{easing:"quadIn"}),e.next=7,Promise.all([Ue.runTweenAsync(i,t),Ue.runTweenAsync(r,t)]);case 7:t.removeAbortListener(n),t.aborted||this.setActive(!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(u=a(o().mark((function e(t){var n,i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setActive(!0),n=L(this.sidebarContainer).to(.3,{position:new q(this.sidebarContainer.position.x,this.originSidebarPosition,0)},{easing:function(e){return r.entranceCurve.evaluate(e)}}),(i=L(this.leavesContainer)).to(.2,{position:new q(this.leavesContainer.position.x,this.originLeavesPosition,0)},{easing:"quadIn"}),e.next=6,Promise.all([Ue.runTweenAsync(n,t),Ue.runTweenAsync(i,t)]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setActive",value:function(e){this.uiOpacity&&(this.uiOpacity.opacity=e?255:0)}},{key:"setLevelText",value:function(e){this.levelNumber.string=e.toString()}},{key:"updateStatus",value:function(e){void 0!==e.score&&this.scoreBlock.setScore(e.score),void 0!==e.level&&this.setLevelText(e.level),this.customScoreContainer.updateStatus(),this.updateUIByMode()}},{key:"updateScore",value:function(e){this.scoreBlock.updateScore(e)}},{key:"updateUIByMode",value:function(){var e=hy.getMatchMode()===vy?iM:nM;this.scoreBlock.node.position.set(this.scoreBlock.node.position.x,e.score),this.itemContainer.position.set(this.itemContainer.position.x,e.item),this.sidebarContainer.getComponent(A).height=e.sidebar,this.sidebarBackground.updateAlignment()}}]),h}(x)).prototype,"scoreBlock",[mD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LD=r(PD.prototype,"itemContainer",[gD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ID=r(PD.prototype,"levelNumber",[bD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OD=r(PD.prototype,"sidebarContainer",[wD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_D=r(PD.prototype,"sidebarBackground",[kD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DD=r(PD.prototype,"leavesContainer",[SD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MD=r(PD.prototype,"customScoreContainer",[CD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ND=r(PD.prototype,"entranceCurve",[ED],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Se}}),BD=r(PD.prototype,"uiOpacity",[xD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(PD.prototype,"setActive",[AD],Object.getOwnPropertyDescriptor(PD.prototype,"setActive"),PD.prototype),TD=PD))||TD)||TD);w._RF.pop(),w._RF.push({},"0ff4fFbKylIvaONtaTZkRQV","LandscapeLayout",void 0);var aM,oM,sM,lM,uM,cM,pM,hM=S.ccclass,dM=S.property,yM=codex.match,fM=Ludex.Match.Modes,vM=(HD=hM("LandscapeLayout"),qD=dM({type:rM,group:"Sidebar"}),VD=dM({type:fD,group:"ChallengeScore"}),WD=dM({type:fD,group:"ChallengeScore"}),KD=dM(H),HD((JD=r((YD=function(r){n(f,r);var u,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"sidebar",JD,l(e)),s(e,"playerScoreBlock",ZD,l(e)),s(e,"opponentScoreBlock",XD,l(e)),s(e,"topAnimNodes",QD,l(e)),e.originTopNodesPos=[],e}return e(f,[{key:"onLoad",value:function(){var e=this;E.once(J.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"saveOriginPos",value:function(){this.sidebar.saveOriginPos();var e,t=c(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}}},{key:"initUIPos",value:function(){var e=this;this.sidebar.initUIPos(),this.topAnimNodes.forEach((function(t,n){var i=e.originTopNodesPos[n].clone();i.y+=100,t.setPosition(i)}))}},{key:"playExitAnimUI",value:(d=a(o().mark((function e(){var t,n,i=this,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.2,this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new An,n=[],this.topAnimNodes.forEach((function(e,r){var a=new q(i.node.position.x,i.originTopNodesPos[r].y+100,0),o=L(e);o.to(t,{position:a},{easing:"backIn"}),n.push(Ue.runTweenAsync(o,i.exitSignal))})),n.push(this.sidebar.playExitAnimUI(this.exitSignal)),e.next=9,Promise.all(n);case 9:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(u=a(o().mark((function e(){var t,n,i=this,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.17,this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new An,n=[],this.topAnimNodes.forEach((function(e,r){var a=new q(i.node.position.x,i.originTopNodesPos[r].y,0),o=L(e);o.to(t,{position:a},{easing:"backOut"}),n.push(Ue.runTweenAsync(o,i.entranceSignal))})),n.push(this.sidebar.playEntranceAnimUI(this.entranceSignal)),e.next=9,Promise.all(n);case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setLevelText",value:function(e){this.sidebar.setLevelText(e)}},{key:"updateStatus",value:function(e){p(h(f.prototype),"updateStatus",this).call(this,e),this.sidebar.updateStatus(e),this.updateScoreBlockStatus(e)}},{key:"updateScoreBlockStatus",value:function(e){var t;if(hy.getMatchMode()!==fM.CHALLENGE_FRIEND)return this.playerScoreBlock.node.active=!1,void(this.opponentScoreBlock.node.active=!1);if(!this.playerScoreBlock.node.active){var n=yM.getMatchState(),i=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},r=i.playerId,a=i.opponentId;if(r&&a){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var o=n.profiles[r],s=n.profiles[a];o&&this.playerScoreBlock.updateInfo(o.photo,r,o.score),s&&this.opponentScoreBlock.updateInfo(s.photo,a,s.score),void 0!==e.score&&this.playerScoreBlock.setScore(e.score)}}}},{key:"handleScoreUpdated",value:function(e){this.sidebar.updateScore(e),this.playerScoreBlock.node.active&&this.playerScoreBlock.updateScore(e)}}]),f}(Y_)).prototype,"sidebar",[qD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZD=r(YD.prototype,"playerScoreBlock",[VD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XD=r(YD.prototype,"opponentScoreBlock",[WD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QD=r(YD.prototype,"topAnimNodes",[KD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),jD=YD))||jD);w._RF.pop(),w._RF.push({},"396015KIPBL3bHTUOHN7pCl","UIMasks",void 0);var mM,gM,bM,wM,kM,SM,CM,EM,xM,AM,TM,PM,RM,LM,IM,OM,_M=S.ccclass,DM=S.property,MM=(aM=_M("UIMasks"),oM=DM(Ao),sM=DM(rR),aM((cM=r((uM=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"background",cM,l(e)),s(e,"alphaMasks",pM,l(e)),e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"show",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.alphaMasks.setMaskActive(0,Ye.isPortrait()),this.alphaMasks.setMaskActive(1,Ye.isLandscape()),this.background.node.active=!0,e.next=5,this.background.changeStateFade(!0,.25);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hide",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.background.changeStateFade(!1,.25);case 2:this.background.node.active=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"background",[oM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pM=r(uM.prototype,"alphaMasks",[sM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lM=uM))||lM);w._RF.pop(),w._RF.push({},"755d1r2cMRLvo4fObNWxss/","CoinContainer",void 0);var NM,BM,zM,FM,UM,GM,HM,qM,VM,WM=S.ccclass,KM=S.property,jM=Ludex.Utils.Number,YM=(mM=WM("CoinContainer"),gM=KM(Y),bM=KM(N),wM=KM(M),kM=KM(Q),SM=Ii.onlyRunInLifeCycle,CM=Ii.onlyRunInLifeCycleAsync,EM=Ii.onlyRunInLifeCycleAsync,xM=Ii.onlyRunInLifeCycle,AM=Ii.onlyRunInLifeCycle,mM((RM=r((PM=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"coinLabel",RM,l(e)),s(e,"coinIcon",LM,l(e)),s(e,"explosionCircle",IM,l(e)),s(e,"explosionParticles",OM,l(e)),e.currentCoin=0,e}return e(d,[{key:"setCoinTextFromNumber",value:function(e){var t=jM.getShortNumber(e,3);this.coinLabel.string=t}},{key:"handleAddCoinButton",value:function(){nt.openScreen(it.GET_COIN_SCREEN,{quantity:Od})}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenToEvents(),this.explosionParticles.node.active=!1}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenToEvents",value:function(){this.node.scene.on(Us.COIN_CHANGED,this.updateCoins,this)}},{key:"updateCoins",value:(p=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.coins,s=t.collectionAnimation,l=t.playSound,void 0!==s&&!1!==this.node.activeInHierarchy){e.next=4;break}return this.setCoins(a),e.abrupt("return");case 4:if(u=s.signal,null===(n=this.animAbortSignal)||void 0===n||n.abort(),this.animAbortSignal=null!=u?u:new An,!s.animateTextOnly){e.next=12;break}return e.next=10,this.animateCoinText(a,0,l,u);case 10:return this.setCoins(a),e.abrupt("return");case 12:return c=null!==(i=s.flyDuration)&&void 0!==i?i:0,p=null!==(r=s.floatDuration)&&void 0!==r?r:0,h=p+c,e.next=17,this.animateCoinText(a,h,l,u);case 17:this.setCoins(a);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setCoins",value:function(e){this.setCoinTextFromNumber(e),this.currentCoin=e}},{key:"animateCoinText",value:(c=a(o().mark((function e(t,n){var i,r,a,s=this,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!(l.length>2&&void 0!==l[2])||l[2],r=l.length>3?l[3]:void 0,a=this.currentCoin,e.next=5,Ue.waitTweenAsync(n,r);case 5:return i&&Ve.playSound(Ji.COLLECT_COINS),e.next=8,Ue.runOnUpdateAsync(this.node,1,(function(e){var n=Math.round(a+(t-a)*e);s.setCoinTextFromNumber(n)}),r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"emitExplodeEffect",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initializeExplosionCircle(),this.explosionParticles.node.active=!0,this.explosionParticles.resetSystem(),e.next=5,Promise.all([Ue.runTweenAsync(L(this.explosionCircle.node).to(.4,{scale:new q(3,3,3)},{easing:"quadOut"}),t),Ue.runTweenAsync(L(this.explosionCircle).delay(.2).to(.2,{opacity:0}),t)]);case 5:this.resetExplosionCircle();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"resetExplosionCircle",value:function(){this.explosionCircle.node.setScale(0,0),this.explosionCircle.opacity=0,this.explosionParticles.node.active=!1}},{key:"initializeExplosionCircle",value:function(){this.explosionCircle.opacity=255,this.explosionCircle.node.setScale(0,0)}},{key:"getCoinIconWorldPosition",value:function(){return this.coinIcon.node.worldPosition}},{key:"getCoinIconWorldScale",value:function(){return this.coinIcon.node.worldScale}},{key:"onDestroy",value:function(){var e;null===(e=this.animAbortSignal)||void 0===e||e.abort()}}]),d}(x)).prototype,"coinLabel",[gM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LM=r(PM.prototype,"coinIcon",[bM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IM=r(PM.prototype,"explosionCircle",[wM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OM=r(PM.prototype,"explosionParticles",[kM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(PM.prototype,"setCoins",[SM],Object.getOwnPropertyDescriptor(PM.prototype,"setCoins"),PM.prototype),r(PM.prototype,"animateCoinText",[CM],Object.getOwnPropertyDescriptor(PM.prototype,"animateCoinText"),PM.prototype),r(PM.prototype,"emitExplodeEffect",[EM],Object.getOwnPropertyDescriptor(PM.prototype,"emitExplodeEffect"),PM.prototype),r(PM.prototype,"resetExplosionCircle",[xM],Object.getOwnPropertyDescriptor(PM.prototype,"resetExplosionCircle"),PM.prototype),r(PM.prototype,"initializeExplosionCircle",[AM],Object.getOwnPropertyDescriptor(PM.prototype,"initializeExplosionCircle"),PM.prototype),TM=PM))||TM);w._RF.pop(),w._RF.push({},"f963aJjCvtD0Y2LplwjDer1","ScoreContainer",void 0);var JM,ZM,XM,QM,$M,eN,tN,nN,iN,rN,aN,oN,sN,lN,uN,cN,pN,hN,dN,yN,fN=S.ccclass,vN=S.property,mN=Ludex.Match.Modes,gN=codex.match,bN=(NM=fN("ScoreContainer"),BM=vN(aD),zM=vN(fD),FM=vN(fD),NM((HM=r((GM=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"scoreBlock",HM,l(e)),s(e,"playerScoreBlock",qM,l(e)),s(e,"opponentScoreBlock",VM,l(e)),e.scoreBlockShown=!0,e.challengeScoreBlockShown=!1,e}return e(o,[{key:"updateStatus",value:function(e){switch(gN.getMatchState().mode){case mN.CHALLENGE_FRIEND:this.showChallengeScoreBlock(),this.hideScoreBlock(),void 0!==e.score&&this.playerScoreBlock.setScore(e.score);break;case mN.SINGLE:case vy:this.hideChallengeScoreBlock(),this.showScoreBlock(),void 0!==e.score&&this.scoreBlock.setScore(e.score);break;default:this.hideScoreBlock(),this.hideChallengeScoreBlock()}}},{key:"showChallengeScoreBlock",value:function(){var e;if(!this.challengeScoreBlockShown){this.challengeScoreBlockShown=!0;var t=gN.getMatchState(),n=null!==(e=hy.getMatchCustomData())&&void 0!==e?e:{},i=n.playerId,r=n.opponentId;if(i&&r){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var a=t.profiles[i],o=t.profiles[r];a&&o&&(this.playerScoreBlock.updateInfo(a.photo,i,a.score),this.opponentScoreBlock.updateInfo(o.photo,r,o.score))}}}},{key:"hideChallengeScoreBlock",value:function(){this.challengeScoreBlockShown&&(this.challengeScoreBlockShown=!1,this.playerScoreBlock.node.active=!1,this.opponentScoreBlock.node.active=!1)}},{key:"showScoreBlock",value:function(){var e;if(!this.scoreBlockShown){this.scoreBlockShown=!0;var t=(null!==(e=hy.getMatchCustomData())&&void 0!==e?e:{}).score;this.scoreBlock.node.active=!0,this.scoreBlock.setScore(t)}}},{key:"hideScoreBlock",value:function(){this.scoreBlockShown&&(this.scoreBlockShown=!1,this.scoreBlock.node.active=!1)}},{key:"updateScore",value:function(e){this.challengeScoreBlockShown?this.playerScoreBlock.updateScore(e):this.scoreBlockShown&&this.scoreBlock.updateScore(e)}}]),o}(x)).prototype,"scoreBlock",[BM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qM=r(GM.prototype,"playerScoreBlock",[zM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VM=r(GM.prototype,"opponentScoreBlock",[FM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UM=GM))||UM);w._RF.pop(),w._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var wN,kN,SN,CN,EN,xN,AN,TN,PN,RN=S.ccclass,LN=S.property,IN=(JM=RN("Header"),ZM=LN(cp),XM=LN(H),QM=LN(H),$M=LN(H),eN=LN(H),tN=LN(bN),nN=LN(YM),iN=LN(GD),rN=Ii.onlyRunInLifeCycle,JM((sN=r((oN=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"levelTextLocalizer",sN,l(e)),s(e,"settingNode",lN,l(e)),s(e,"homeNode",uN,l(e)),s(e,"leftNode",cN,l(e)),s(e,"coinNode",pN,l(e)),s(e,"scoreContainer",hN,l(e)),s(e,"coinContainer",dN,l(e)),s(e,"customScoreContainer",yN,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.uiOpacity=this.node.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateStatus",value:function(e){this.scoreContainer.updateStatus(e),void 0!==e.coins&&this.coinContainer.setCoins(e.coins),void 0!==e.level&&this.setLevelText(e.level)}},{key:"highlightCoinContainer",value:function(){var e=re("Canvas/Screens");if(e){var t=this.coinNode.worldPosition.clone();this.coinNode.parent=e,this.coinNode.worldPosition=t}}},{key:"removeCoinContainerHighlight",value:function(){var e=this.coinNode.worldPosition.clone();this.coinNode.parent=this.leftNode,this.coinNode.worldPosition=e}},{key:"setLevelText",value:function(e){this.levelTextLocalizer.setParams([e.toString()])}},{key:"setButtonsInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.settingNode.getComponent(U).interactable=e,this.homeNode.getComponent(U).interactable=e}},{key:"setActive",value:function(e){this.uiOpacity.opacity=e?255:0}}]),o}(x)).prototype,"levelTextLocalizer",[ZM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lN=r(oN.prototype,"settingNode",[XM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uN=r(oN.prototype,"homeNode",[QM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cN=r(oN.prototype,"leftNode",[$M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pN=r(oN.prototype,"coinNode",[eN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hN=r(oN.prototype,"scoreContainer",[tN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dN=r(oN.prototype,"coinContainer",[nN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yN=r(oN.prototype,"customScoreContainer",[iN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(oN.prototype,"setActive",[rN],Object.getOwnPropertyDescriptor(oN.prototype,"setActive"),oN.prototype),aN=oN))||aN);w._RF.pop(),w._RF.push({},"456584ngz9FupmxndAXqCbY","PortraitLayout",void 0);var ON=S.ccclass,_N=S.property,DN=(wN=ON("PortraitLayout"),kN=_N(IN),SN=_N([H]),CN=_N([H]),wN((AN=r((xN=function(r){n(f,r);var u,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"header",AN,l(e)),s(e,"topAnimNodes",TN,l(e)),e.originTopNodesPos=[],s(e,"botAnimNodes",PN,l(e)),e.originBotNodesPos=[],e.hideBotWorldY=-80,e}return e(f,[{key:"onLoad",value:function(){var e=this;this.validateRequiredComponents(),E.once(J.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"saveOriginPos",value:function(){var e,t=c(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}var i,r=c(this.botAnimNodes);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.originBotNodesPos.push(a.position.clone())}}catch(e){r.e(e)}finally{r.f()}}},{key:"initUIPos",value:function(){var e=this;this.topAnimNodes.forEach((function(t,n){var i,r,a=null!==(i=null===(r=e.originTopNodesPos[n])||void 0===r?void 0:r.clone())&&void 0!==i?i:new q(0,0,0);a.y+=200,t.setPosition(a)}));var t=new q(0,this.hideBotWorldY,0);this.botAnimNodes.forEach((function(n,i){var r,a,o,s,l=null!==(r=null===(a=e.originBotNodesPos[i])||void 0===a?void 0:a.clone())&&void 0!==r?r:new q(0,0,0);t.y=e.hideBotWorldY;var u=null!==(o=null===(s=n.parent)||void 0===s?void 0:s.inverseTransformPoint(t,t).y)&&void 0!==o?o:200;l.y=u,n.setPosition(l)}))}},{key:"setLevelText",value:function(e){this.header.setLevelText(e)}},{key:"disableLayout",value:function(){this.header.setButtonsInteractable(!1)}},{key:"enableLayout",value:function(){this.header.setButtonsInteractable()}},{key:"updateStatus",value:function(e){p(h(f.prototype),"updateStatus",this).call(this,e),this.header.updateStatus(e)}},{key:"playExitAnimUI",value:(d=a(o().mark((function e(){var t,n,i,r,a,s,l,u,p,h,d,y=this,f=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=f.length>0&&void 0!==f[0]?f[0]:.17,this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new An,n=[],this.topAnimNodes.forEach((function(e,i){var r,a,o=new q(e.position.x,(null!==(r=null===(a=y.originTopNodesPos[i])||void 0===a?void 0:a.y)&&void 0!==r?r:0)+200,0),s=L(e);s.to(t,{position:o},{easing:"backIn"}),n.push(Ue.runTweenAsync(s,y.exitSignal))})),i=new q(0,this.hideBotWorldY,0),r=c(this.botAnimNodes);try{for(r.s();!(a=r.n()).done;)u=a.value,i.y=this.hideBotWorldY,p=null!==(s=null===(l=u.parent)||void 0===l?void 0:l.inverseTransformPoint(i,i).y)&&void 0!==s?s:200,h=new q(u.position.x,p,0),(d=L(u)).to(t,{position:h},{easing:"backIn"}),n.push(Ue.runTweenAsync(d,this.exitSignal))}catch(e){r.e(e)}finally{r.f()}return e.next=11,Promise.all(n);case 11:if(!this.exitSignal.aborted){e.next=13;break}return e.abrupt("return");case 13:this.header.setActive(!1);case 14:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(u=a(o().mark((function e(){var t,n,i=this,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:.2,this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new An,this.header.setActive(!0),n=[],this.topAnimNodes.forEach((function(e,r){var a,o,s=new q(e.position.x,null!==(a=null===(o=i.originTopNodesPos[r])||void 0===o?void 0:o.y)&&void 0!==a?a:0,0),l=L(e);l.to(t,{position:s},{easing:"backOut"}),n.push(Ue.runTweenAsync(l,i.entranceSignal))})),this.botAnimNodes.forEach((function(e,r){var a,o,s=new q(e.position.x,null!==(a=null===(o=i.originBotNodesPos[r])||void 0===o?void 0:o.y)&&void 0!==a?a:0,0),l=L(e);l.to(t,{position:s},{easing:"backOut"}),n.push(Ue.runTweenAsync(l,i.entranceSignal))})),e.next=10,Promise.all(n);case 10:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.header.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.header.removeCoinContainerHighlight()}},{key:"handleScoreUpdated",value:function(e){this.header.scoreContainer.updateScore(e)}}]),f}(Y_)).prototype,"header",[kN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TN=r(xN.prototype,"topAnimNodes",[SN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),PN=r(xN.prototype,"botAnimNodes",[CN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),EN=xN))||EN);w._RF.pop(),w._RF.push({},"805dbJxaCpKBpzq9ejSgrc8","TileType",void 0);var MN,NN,BN,zN,FN,UN="bomb";w._RF.pop(),w._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var GN,HN,qN,VN,WN,KN,jN,YN,JN,ZN,XN,QN,$N,eB,tB,nB,iB,rB=Ludex,aB=rB.Dtos.Player,oB=rB.Utils.Function,sB=S.ccclass,lB=S.property,uB=codex,cB=uB.player,pB=uB.language,hB=(MN=sB("DevToolsContainer"),NN=lB(H),MN((FN=r((zN=function(r){n(f,r);var u,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"devToolsToggle",FN,l(e)),e.isActive=!0,e.game=null,e.bundleName="lowest",e.currentLocaleIndex=0,e.debouncedStarsNotification=oB.debounce((function(){var e=cB.getGameData();e&&nt.showNotificationScreen("Stars added. Current stars: ".concat(e.stars))}),700),e}return e(f,[{key:"injectGameplay",value:function(e){this.game=e}},{key:"start",value:function(){this.initCurrentLocale()}},{key:"initCurrentLocale",value:function(){var e=pB.getCurrentLocale();this.currentLocaleIndex=Je.indexOf(e)}},{key:"hideAllButtons",value:function(){var e,t=this.getComponentsInChildren(U),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!1))}}catch(e){n.e(e)}finally{n.f()}}},{key:"showAllButtons",value:function(){var e,t=this.getComponentsInChildren(U),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!0))}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleClickDevToolsButton",value:function(){this.isActive?(this.hideAllButtons(),this.isActive=!1):(this.showAllButtons(),this.isActive=!0)}},{key:"handleResetData",value:function(){cB.setPlayerData(aB.Data.getDefaults()),nt.openScreen(it.NOTIFICATION_SCREEN,{duration:3,message:"Items and stars will only be reset if you refresh the game page now."}),this.node.scene.emit(Us.START_OVER,0)}},{key:"handleNextLevel",value:(d=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(null!==(t=null===(n=this.game)||void 0===n||null===(n=n.getGameData())||void 0===n?void 0:n.level)&&void 0!==t?t:1)+1,null===(i=this.game)||void 0===i||i.setGameData({level:r-1}),cB.setGameData({level:r}),this.node.scene.emit(Us.NEXT_LEVEL);case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handlePrevLevel",value:(h=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Math.max((null!==(t=null===(n=this.game)||void 0===n||null===(n=n.getGameData())||void 0===n?void 0:n.level)&&void 0!==t?t:2)-1,1),null===(i=this.game)||void 0===i||i.setGameData({level:r-1}),cB.setGameData({level:r}),this.node.scene.emit(Us.NEXT_LEVEL);case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleEnterSelectLevel",value:(p=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Number(t.string),null===(n=this.game)||void 0===n||n.setGameData({level:i-1}),cB.setGameData({level:i}),this.node.scene.emit(Us.NEXT_LEVEL);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"handleClickBuildVersionButton",value:function(){var e=codex.getBuildVersion();nt.showNotificationScreen("Build version: ".concat(e))}},{key:"handleClickWinLevelButton",value:function(){this.node.scene.emit(Us.GAME_FINISH)}},{key:"handleClickTimeOutButton",value:function(){var e;null===(e=this.game)||void 0===e||e.clockManager.setTime(.1)}},{key:"handleClickExplodeButton",value:function(){var e,t,n=this.game;if(n){var i=null===(e=n.getGameData())||void 0===e||null===(e=e.levelData)||void 0===e?void 0:e.specials.bomb;if(i&&!(i<=0)){var r=n.board.getBombTiles();if(0!==r.length){var a=r[0];if(!a||(null===(t=a.special)||void 0===t?void 0:t.type)!==UN)throw new Error("Invalid bomb tile");a.special.detonateImmediately()}else console.info("No bomb tiles found")}}}},{key:"handleFillItem",value:function(){this.node.scene.emit(Us.ADD_ITEM,{item:Xe.HINT,quantity:2}),this.node.scene.emit(Us.ADD_ITEM,{item:Xe.STORM,quantity:2}),this.node.scene.emit(Us.ADD_ITEM,{item:Xe.THUNDER,quantity:2}),this.node.scene.emit(Us.ADD_ITEM,{item:Xe.PLIERS,quantity:2})}},{key:"handleAutoPlay",value:function(){this.node.scene.emit(Us.AUTO_PLAY)}},{key:"handleAddStars",value:function(){var e=cB.getGameData();e&&(cB.setGameData({stars:e.stars+10}),this.debouncedStarsNotification())}},{key:"handleSwitchQualityAssets",value:function(){switch(this.bundleName){case"lowest":this.bundleName="highest";break;case"highest":this.bundleName="lowest"}O.emit(Ge.REQUEST_UPGRADE_ASSET,{quality:this.bundleName})}},{key:"handleSwitchLocale",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentLocaleIndex=(this.currentLocaleIndex+1)%Je.length,t=Je[this.currentLocaleIndex],nt.showLoadingNotificationScreen(),e.prev=3,t){e.next=6;break}throw new Error("Locale is undefined");case 6:return e.next=8,this.preloadLanguageAsync(t);case 8:O.emit(Ge.CHOOSE_LANGUAGE,{locale:t,saveToPlayerData:!0}),nt.showNotificationScreen("Language changed to ".concat(t)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0),nt.showNotificationScreen("Failed to change language");case 16:case"end":return e.stop()}}),e,this,[[3,12]])}))),function(){return u.apply(this,arguments)})},{key:"preloadLanguageAsync",value:function(e){return new Promise((function(t,n){O.emit(Ge.PRELOAD_LANGUAGE,{locale:e,onLoad:t,onError:n})}))}}]),f}(x)).prototype,"devToolsToggle",[NN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BN=zN))||BN);w._RF.pop(),w._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var dB,yB,fB,vB,mB,gB,bB,wB,kB,SB=S.ccclass,CB=S.property,EB=Ludex,xB=EB.Utils.Valid,AB=EB.Match.Modes,TB=qe.Layout,PB=(GN=SB("UIManager"),HN=CB(OI),qN=CB(DN),VN=CB(vM),WN=CB(hB),KN=CB(cO),jN=CB(NI),YN=CB(MM),GN((XN=r((ZN=function(r){n(v,r);var u,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"interstitialAdIndicator",XN,l(e)),s(e,"portraitLayout",QN,l(e)),s(e,"landscapeLayout",$N,l(e)),s(e,"devTools",eB,l(e)),s(e,"comboProgressBar",tB,l(e)),s(e,"comboContainer",nB,l(e)),s(e,"uiMasks",iB,l(e)),e.uiShown=!1,e.config={},e.isResetDataListener=!1,e.showDevTools=function(){e.devTools&&(e.devTools.node.active=!0)},e}return e(v,[{key:"onLoad",value:function(){this.node.scene.on(Fd.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.on(Us.RESCUE_START,this.showRescueAnimation,this),this.node.scene.on(Us.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.on(Us.SCORE_UPDATED,this.handleScoreUpdated,this),O.on(Ge.ORIENTATION_CHANGED,this.onOrientationChanged,this),this.onOrientationChanged(Ye.getCurrentLayout())}},{key:"onDestroy",value:function(){this.node.scene.off(Fd.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.off(Us.RESCUE_START,this.showRescueAnimation,this),this.node.scene.off(Us.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.off(Us.SCORE_UPDATED,this.handleScoreUpdated,this),O.off(Ge.ORIENTATION_CHANGED,this.onOrientationChanged,this)}},{key:"init",value:function(e){this.currentLayout=this.portraitLayout,this.game=e,this.initDevTools(e),this.comboContainer.init(e.board)}},{key:"initDevTools",value:function(e){var t=this;this.isResetDataListener||(window.addEventListener("reset-game-data",(function(){var e;null===(e=t.devTools)||void 0===e||e.handleResetData()})),this.isResetDataListener=!0),this.devTools&&(this.devTools.node.active=xB.isDebugger(),this.devTools.injectGameplay(e))}},{key:"setLevelText",value:function(e){this.config.level=e,this.currentLayout.setLevelText(e)}},{key:"startCountdown",value:function(){this.comboProgressBar.resume()}},{key:"pauseTime",value:function(){this.comboProgressBar.pause()}},{key:"resumeTime",value:function(){this.comboProgressBar.resume()}},{key:"setComboUI",value:function(e){this.comboContainer.getComponent(Ao).changeStateFade(e,.1)}},{key:"disableLayout",value:function(){this.currentLayout.disableLayout()}},{key:"enableLayout",value:function(){this.currentLayout.enableLayout()}},{key:"updateStatus",value:function(){var e;this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),score:this.game.scoreManager.getCurrentScore(),leaderData:null===(e=this.game.tournamentManager)||void 0===e?void 0:e.leaderData,items:this.game.itemManager.itemConfigs}),this.comboContainer.updateStatus()}},{key:"showRescueAnimation",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uiMasks.show();case 2:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"hideRescueAnimation",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uiMasks.hide();case 2:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"playExitAnimUI",value:(h=a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:.2,this.uiShown=!1,e.next=4,this.currentLayout.playExitAnimUI(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(p=a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:.17,this.uiShown=!0,e.next=4,this.currentLayout.playEntranceAnimUI(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.currentLayout.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.currentLayout.unHighlightCoinContainer()}},{key:"handleClickedPauseGame",value:function(){nt.openScreen(it.PAUSE_SCREEN),this.node.scene.emit(Us.GAME_PAUSE)}},{key:"handleReturnHome",value:function(){nt.openScreen(it.QUIT_LEVEL_SCREEN),this.node.scene.emit(Us.GAME_PAUSE)}},{key:"items",get:function(){return this.currentLayout.items}},{key:"setInteractableItems",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=c(this.items);try{for(n.s();!(e=n.n()).done;){var i=e.value;t?void 0!==i.itemType?i.button.interactable=this.game.itemManager.canUseItem(i.itemType):console.warn("Item type is not defined"):i.button.interactable=!1}}catch(e){n.e(e)}finally{n.f()}}},{key:"onOrientationChanged",value:(u=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===TB.Portrait?(this.landscapeLayout.node.active=!1,this.portraitLayout.node.active=!0,this.currentLayout=this.portraitLayout):t===TB.Landscape&&(this.portraitLayout.node.active=!1,this.landscapeLayout.node.active=!0,this.currentLayout=this.landscapeLayout),this.currentLayout){e.next=3;break}return e.abrupt("return");case 3:return this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),level:this.config.level,score:this.game.scoreManager.getCurrentScore(),time:this.game.clockManager.getRemainingTime(),leaderData:null===(n=this.game.tournamentManager)||void 0===n?void 0:n.leaderData,items:this.game.itemManager.itemConfigs}),e.next=6,this.currentLayout.waitForInitAsync();case 6:this.uiShown?this.playEntranceAnimUI(0):this.playExitAnimUI(0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleScoreUpdated",value:function(e){var t;this.config.score=e,this.currentLayout.handleScoreUpdated(e),hy.getMatchMode()===AB.TOURNAMENT&&this.currentLayout.tournamentRail.handleScoreUpdated({score:e,leaderData:null===(t=this.game.tournamentManager)||void 0===t?void 0:t.leaderData})}}]),v}(x)).prototype,"interstitialAdIndicator",[HN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QN=r(ZN.prototype,"portraitLayout",[qN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$N=r(ZN.prototype,"landscapeLayout",[VN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eB=r(ZN.prototype,"devTools",[WN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tB=r(ZN.prototype,"comboProgressBar",[KN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nB=r(ZN.prototype,"comboContainer",[jN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iB=r(ZN.prototype,"uiMasks",[YN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JN=ZN))||JN);w._RF.pop(),w._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var RB=codex,LB=RB.player,IB=RB.event,OB=RB.match,_B=RB.storage,DB=RB.analytics,MB=RB.monitorError,NB=RB.leaderboard,BB=Ludex,zB=BB.Events,FB=BB.Utils,UB=FB.Time,GB=FB.Array,HB=FB.Valid,qB=BB.Configs.Gameplay,VB=BB.Match.Modes,WB=BB.Plugins.Ads,KB=(void 0===WB?{}:WB).Types,jB=S.ccclass,YB=S.property,JB={level:1,isFromLoader:!1};dB=jB("Gameplay"),yB=YB(ag),fB=YB(Ao),vB=YB(Sb),dB((bB=r((gB=function(r){n(y,r);var p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=d.call.apply(d,[this].concat(i)),s(e,"board",bB,l(e)),s(e,"opacityToggler",wB,l(e)),s(e,"pathDraw",kB,l(e)),e.gameData=null,e.rescueTiles=[],e.isAutoPlayEnabled=!1,e.isAdPreloadedForCurrentLevel=!1,e.handleOpenScreen=function(t){t.screenName===lt[it.GET_ITEM_SCREEN]&&e.uiManager.highlightCoinContainer()},e.handleShowUI=a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.uiManager.updateStatus(),e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),t.next=5,e.uiManager.playEntranceAnimUI();case 5:e.uiManager.enableLayout(),e.uiManager.setInteractableItems(!0);case 7:case"end":return t.stop()}}),t)}))),e.handleHideUI=a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),t.next=4,e.uiManager.playExitAnimUI();case 4:case"end":return t.stop()}}),t)}))),e.handleCloseScreen=function(t){t.screenName===lt[it.GET_ITEM_SCREEN]&&e.uiManager.unHighlightCoinContainer()},e.handlePauseGame=function(){e.node.scene.emit(Us.PAUSE_TIME),e.node.pauseSystemEvents(!0),e.opacityToggler.changeStateFade(!1,.1),e.uiManager.setComboUI(!1),e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(){var t;e.node.resumeSystemEvents(!0),e.stateManager.isPlaying()&&e.node.scene.emit(Us.RESUME_TIME),e.processCrazyGamesGameplayStart(),e.opacityToggler.changeStateFade(!0,.1),e.uiManager.setComboUI(!0),null===(t=e.guidelinesManager)||void 0===t||t.startAutoGuides()},e.handleReplayGame=function(){var t=a(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.handleHideHint(),t.prev=1,(i=hy.getMatchMode())!==VB.SINGLE&&i!==vy){t.next=6;break}return t.next=6,hy.finishMatchAsync();case 6:if(i===VB.CHALLENGE_FRIEND){t.next=9;break}return t.next=9,hy.startMatchAsync(n);case 9:if(i!==VB.TOURNAMENT){t.next=13;break}return t.next=12,hy.setMatchCustomDataAsync({level:1,score:0});case 12:e.setGameData({level:1});case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.warn("handleReplayGame",t.t0);case 18:e.stateManager.initialize();case 19:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e){return t.apply(this,arguments)}}(),e.handleFinishGame=function(){var t;e.attemptCallCreateShortcut(),null!==(t=e.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()?(e.guidelinesManager.guideUi.guideSkipButton.active=!1,e.handleNextLevel()):e.stateManager.finish()},e.handleNextLevel=a(o().mark((function t(){var n,i,r,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.gameData){t.next=2;break}return t.abrupt("return");case 2:if(i=hy.getMatchMode(),t.prev=3,i!==VB.SINGLE&&i!==vy){t.next=7;break}return t.next=7,hy.finishMatchAsync();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.warn("handleNextLevel",t.t0);case 12:if(r=null!==(n=e.gameData.level)&&void 0!==n?n:1,a=r+1,e.setGameData({level:a}),i!==VB.TOURNAMENT){t.next=20;break}return t.next=18,hy.setMatchCustomDataAsync({level:a});case 18:t.next=24;break;case 20:return t.next=22,hy.setMatchCustomDataAsync({level:a,score:0});case 22:return t.next=24,hy.startMatchAsync();case 24:e.stateManager.initialize(),console.log("Next level",e.gameData.level);case 26:case"end":return t.stop()}}),t,null,[[3,9]])}))),e.handleStartOver=function(){var t=a(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return LB.setGameData({level:null!=n?n:1}),t.next=3,hy.setMatchCustomDataAsync({level:n,score:0});case 3:e.gameData=LB.getGameData(),e.stateManager.initialize(),console.info("Start over",null===(i=e.gameData)||void 0===i?void 0:i.level);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleMaxLevel=function(){e.gameData&&(e.initData(),nt.openScreen(it.CONGRATULATION_SCREEN,{level:e.gameData.level}),console.info("Max level",e.gameData.level))},e.handleExitGame=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{_B.setStorageData("dashboard","animateToCurrentLevel",!0),_B.setStorageData("collection","animateMapPackUnlock",!0)}catch(e){console.warn("handleExitGame",e)}case 1:case"end":return e.stop()}}),e)}))),e.handleTileClick=function(t){e.stateManager.playing(),e.board.handleTileClick(t),e.handleHideHint()},e.handleGridMatchSuccess=function(t,n){e.pathDraw.drawMatchPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)})),e.comboManager.addCombo(),e.handleAddScore(),e.effectManager.playClearEffectAt([n[0].node.worldPosition,n[1].node.worldPosition])},e.handleGridMatchFail=function(t){var n;null!==(n=e.guidelinesManager)&&void 0!==n&&n.isShowErrorPathLevel()&&e.pathDraw.drawErrorPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)}))},e.handleGridClear=a(o().mark((function t(){var n,i,r,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.board.getUncleared(),KB&&10===n.length&&!e.isAdPreloadedForCurrentLevel&&(e.isAdPreloadedForCurrentLevel=!0,at.preloadAdsByType(KB.INTERSTITIAL)),0===n.length&&e.node.scene.emit(Us.GAME_FINISH),8!==n.length){t.next=7;break}return t.next=6,null===(i=e.tournamentManager)||void 0===i?void 0:i.requestLeaderData();case 6:null===(r=e.uiManager)||void 0===r||r.currentLayout.tournamentRail.handleScoreUpdated({score:e.scoreManager.getCurrentScore(),leaderData:null===(a=e.tournamentManager)||void 0===a?void 0:a.leaderData});case 7:case"end":return t.stop()}}),t)}))),e.handlePauseTime=function(){e.clockManager.pause(),e.uiManager.pauseTime()},e.handleResumeTime=function(){e.clockManager.resume(),e.uiManager.resumeTime()},e.handleClockTimeout=function(){e.stateManager.fail(dy)},e.handleHalfTime=function(){void 0!==e.guidelinesManager&&(e.board.getUncleared().length>=e.board.getCleared().length&&e.guidelinesManager.startThunderGuide()||e.board.getBombTiles().length>0&&e.guidelinesManager.startPliersGuide())},e.handleStartRescue=function(){var t,n,i;if(Ve.turnDownMusic(),tt.setBlockInput(!0),e.board.setIgnoreInput(!0),e.rescueTiles.length>0){var r,a=c(e.rescueTiles);try{for(a.s();!(r=a.n()).done;){r.value.restore()}}catch(e){a.e(e)}finally{a.f()}e.rescueTiles=[]}var o=null!==(t=hy.getMatchMode())&&void 0!==t?t:void 0;null==DB||DB.levelRescue(null!==(n=null===(i=e.gameData)||void 0===i?void 0:i.level)&&void 0!==n?n:1,void 0,o)},e.handleFinishRescue=function(){tt.setBlockInput(!1),e.board.setIgnoreInput(!1)},e.handleBombExplode=function(){var t=a(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.rescueTiles.push(n),e.board.setIgnoreInput(!0),tt.getBlockInput()||(Ve.playSound(Ji.BOMB_EXPLODE_1),tt.setBlockInput(!0)),i=n.node.worldPosition,t.next=6,e.effectManager.createBombExplosionAt(new q(i.x,i.y,0));case 6:if(tt.setBlockInput(!1),!e.stateManager.isFail()){t.next=9;break}return t.abrupt("return");case 9:e.stateManager.fail(yy);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleShowHint=function(){if(!e.pathDraw.isDrawingHint){var t=e.board.getHintPath();t&&(Ve.playSound(Ji.HINT_ITEM),e.pathDraw.drawHintPath(t,(function(t){return e.board.getAnyTileWorldPosition(t.x,t.y)})),e.board.showHint(),e.node.scene.emit(Us.REFRESH_ITEMS))}},e.handleGridOrientationChange=function(){e.handleHideHint()},e.handleHideHint=function(){e.pathDraw.isDrawingHint&&(e.pathDraw.clearHintPath(),e.board.hideHint(),e.node.scene.emit(Us.REFRESH_ITEMS))},e.handleAddScore=function(){var t=e.levelManager.getLevelData().level,n=e.comboManager.getCombo(),i=e.clockManager.getRemainingTime();e.scoreManager.addScore(t,n,i)},e.handleUseItem=function(){var t=a(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.stateManager.playing(),n!==Xe.HINT&&e.handleHideHint(),e.itemManager.setQuantity(n,e.itemManager.getQuantity(n)-1),t.t0=n,t.next=t.t0===Xe.HINT?6:t.t0===Xe.PLIERS?9:t.t0===Xe.STORM?12:t.t0===Xe.THUNDER?19:25;break;case 6:return cg(e.board,e.pathDraw),e.node.scene.emit(Us.REFRESH_ITEMS),t.abrupt("break",25);case 9:return pg(e.board,e.effectManager),e.node.scene.emit(Us.REFRESH_ITEMS),t.abrupt("break",25);case 12:return e.node.scene.emit(Us.HIDE_UI),e.node.scene.emit(Us.PAUSE_TIME),t.next=16,xg(e.board,e.effectManager);case 16:return e.node.scene.emit(Us.RESUME_TIME),e.node.scene.emit(Us.SHOW_UI),t.abrupt("break",25);case 19:return e.node.scene.emit(Us.HIDE_UI),e.node.scene.emit(Us.PAUSE_TIME),t.next=23,mg(e.board,e.effectManager);case 23:e.board.getUncleared().length>0&&(e.node.scene.emit(Us.RESUME_TIME),e.node.scene.emit(Us.SHOW_UI));case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleAutoPlay=function(){e.isAutoPlayEnabled?e.disableAutoPlay():e.enableAutoPlay()},e.enableAutoPlay=function(){e.isAutoPlayEnabled=!0,e.schedule(e.autoPlay,.5)},e.disableAutoPlay=function(){e.isAutoPlayEnabled=!1,e.unschedule(e.autoPlay)},e.autoPlay=function(){if(e.stateManager.isReady()||e.stateManager.isPlaying()){var t=e.board.getHintPath();if(!t)throw new Error("No path found");var n=t[0],i=t.slice(-1)[0];if(void 0!==n&&void 0!==i){var r=n.a,a=i.b,o=e.board.getTileAt(r.x,r.y),s=e.board.getTileAt(a.x,a.y);if(!o||!s)throw new Error("Tile is null");o.onClick(),s.onClick()}else{var l=new Error("No path found");if(HB.isDebugger())throw l;null==MB||MB.sendException(l)}}},e.handleAddStars=function(t){var n=LB.getGameData();if(!n)return Promise.resolve([]);LB.setGameData({stars:n.stars+1});var i=t.startAnimationAt;i&&e.effectManager.playStarEffectAt(i)},e.handleChallengeFriends=a(o().mark((function t(){var n,i,r,a,s,l,u,c,p,h,d,y,f,v,m;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,nt.showLoadingScreen(),a=e.board.generateFenFromCurrentLevel(),s=null!==(n=LB.getGameData())&&void 0!==n?n:{},l=s.level,u=void 0===l?1:l,u=Math.max(1,u),c=null!==(i=null===(r=e.gameData)||void 0===r?void 0:r.levelData)&&void 0!==i?i:{},p=c.mode,h=void 0===p?"":p,d=c.rules,y=void 0===d?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:d,f=c.time,v=void 0===f?0:f,t.next=8,null==OB?void 0:OB.context.choose.processAsync({playerId:LB.getPlayerId(),fallbackSingleMode:!1,extraData:{challengeData:{level:u,fen:a,gravity:h,rules:y,time:v}}});case 8:if(hy.getMatchMode()!==VB.TOURNAMENT){t.next=11;break}return t.next=11,e.tryInitTournamentMode();case 11:nt.closeLoadingScreen(),e.node.scene.emit(Us.UPDATE_MUSIC),e.node.scene.emit(Us.GAME_RESUME),e.node.scene.emit(Us.GAME_REPLAY,{level:u}),t.next=25;break;case 17:t.prev=17,t.t0=t.catch(0),m=t.t0 instanceof Error?t.t0:new Error("Unable to invite friends"),null==MB||MB.sendException(m),nt.closeLoadingScreen(),nt.showNotificationScreenWithLocalizedKey("error.tryLater"),e.node.scene.emit(Us.GAME_RESUME),e.node.scene.emit(Us.SHOW_UI);case 25:case"end":return t.stop()}}),t,null,[[0,17]])}))),e.handleAddItem=function(){var t=a(o().mark((function t(n){var i,r,a,s,l,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.animate,r=n.item,a=n.quantity,void 0!==(s=GB.search(e.uiManager.items,(function(e){return e.itemType===r})))){t.next=5;break}return console.warn("Item ".concat(r," not found")),t.abrupt("return");case 5:if(l=e.itemManager.getQuantity(r),u=l+a,e.itemManager.saveQuantity(r,u),e.uiManager.setInteractableItems(!1),!i){t.next=13;break}return c=i.startWorldPosition,t.next=13,e.effectManager.playItemAddAnimation(c.x,c.y,s);case 13:e.itemManager.setQuantity(r,u,!0),e.uiManager.setInteractableItems(!0);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return e(y,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenCoreEvents(),this.listenInputEvents(),this.listenFlowEvents()}},{key:"onLoad",value:function(){$d.init()}},{key:"onDestroy",value:function(){this.unlistenCoreEvents()}},{key:"initComponents",value:function(){this.initUIManager(),this.initLevelManager(),this.initStateManager(),this.initEffectManager(),this.initItemManager(),this.initCoinManager(),this.initComboManager(),this.initClockManager(),this.initScoreManager(),this.initInputController(),this.initGuidelinesManager(),this.initPathDraw()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(PB),this.uiManager.init(this)}},{key:"initLevelManager",value:function(){this.levelManager=this.getComponent(tf)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(lI)}},{key:"initInputController",value:function(){this.inputController=this.getComponent(my)}},{key:"initEffectManager",value:function(){this.effectManager=this.getComponent(jT)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(PL),this.itemManager.init(this)}},{key:"initCoinManager",value:function(){this.coinManager=this.getComponent(Fw)}},{key:"initComboManager",value:function(){this.comboManager=this.getComponent($w),this.comboManager.init()}},{key:"initClockManager",value:function(){this.clockManager=this.getComponent(qb),this.clockManager.init()}},{key:"initScoreManager",value:function(){this.scoreManager=this.getComponent(IL),this.scoreManager.init()}},{key:"initGuidelinesManager",value:function(){qB.Tutorial.Enabled&&(this.guidelinesManager=this.getComponent(kL),this.guidelinesManager.init(this))}},{key:"initPathDraw",value:function(){this.pathDraw.init(this.board)}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenCoreEvents",value:function(){IB.on(zB.OPENING_SCREEN,this.handleOpenScreen),IB.on(zB.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"unlistenCoreEvents",value:function(){IB.off(zB.OPENING_SCREEN,this.handleOpenScreen),IB.off(zB.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"listenInputEvents",value:function(){this.node.scene.on(Us.SHOW_UI,this.handleShowUI),this.node.scene.on(Us.HIDE_UI,this.handleHideUI),this.node.scene.on(Us.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(Us.GAME_RESUME,this.handleResumeGame),this.node.scene.on(Us.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(Us.GAME_FINISH,this.handleFinishGame),this.node.scene.on(Us.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(Us.START_OVER,this.handleStartOver),this.node.scene.on(Us.MAX_LEVEL,this.handleMaxLevel),this.node.scene.on(Us.GAME_EXIT,this.handleExitGame),this.node.scene.on(Us.TILE_CLICK,this.handleTileClick),this.node.scene.on(Us.GRID_MATCH_SUCCESS,this.handleGridMatchSuccess),this.node.scene.on(Us.GRID_MATCH_FAIL,this.handleGridMatchFail),this.node.scene.on(Us.GRID_ORIENTATION_CHANGE,this.handleGridOrientationChange),this.node.scene.on(Us.PAUSE_TIME,this.handlePauseTime),this.node.scene.on(Us.RESUME_TIME,this.handleResumeTime),this.node.scene.on(Us.TIME_OUT,this.handleClockTimeout),this.node.scene.on(Us.HALF_TIME,this.handleHalfTime),this.node.scene.on(Us.RESCUE_START,this.handleStartRescue),this.node.scene.on(Us.RESCUE_FINISHED,this.handleFinishRescue),this.node.scene.on(Us.BOMB_EXPLODE,this.handleBombExplode),this.node.scene.on(Us.SHOW_HINT,this.handleShowHint),this.node.scene.on(Us.ADD_SCORE,this.handleAddScore),this.node.scene.on(Us.GRID_CLEAR,this.handleGridClear),this.node.scene.on(Us.USE_ITEM,this.handleUseItem),this.node.scene.on(Us.ADD_ITEM,this.handleAddItem),this.node.scene.on(Us.AUTO_PLAY,this.handleAutoPlay),this.node.scene.on(Us.ADD_STARS,this.handleAddStars)}},{key:"listenFlowEvents",value:function(){this.node.scene.on(Us.CHALLENGE_FRIENDS,this.handleChallengeFriends)}},{key:"start",value:(h=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initDataFirstTime(),e.next=3,this.tryInitTournamentMode();case 3:this.initGame();case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"initDataFirstTime",value:function(){this.initData();var e,t,n=this.getSceneData(),i=(null!=n?n:{}).isFromLoader,r=void 0!==i&&i,a=(null!=n?n:{}).level;void 0===a&&(a=hy.getMatchMode()===VB.TOURNAMENT?1:null!==(e=null===(t=LB.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:0);this.setGameData({level:a,isFromLoader:r})}},{key:"initData",value:function(){var e,t=this.getSceneData(),n=(null!=t?t:{}).isFromLoader,i=void 0!==n&&n,r=null!==(e=LB.getGameData())&&void 0!==e?e:{},a=r.level,o=void 0===a?1:a,s=r.items;0===o&&i&&s?(s.hint=2,s.thunder=1,s.storm=1,s.pliers=0,LB.setGameData({items:s,coins:500,lastRewardedItems:Date.now()}),this.node.scene.emit(Us.ADD_COINS,{coins:500,playSound:!1})):s&&this.checkItemsRewardable()&&(s.hint<5&&(s.hint+=1),s.thunder<5&&(s.thunder+=1),s.storm<5&&(s.storm+=1),s.pliers<5&&(s.pliers+=1),LB.setGameData({items:s,lastRewardedItems:Date.now()})),this.setGameData(u(u({},JB),{},{level:o}))}},{key:"checkItemsRewardable",value:function(){var e,t=(null!==(e=LB.getGameData())&&void 0!==e?e:{}).lastRewardedItems,n=void 0===t?0:t;return!UB.isToday(n)}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.initialize()}},{key:"tryInitTournamentMode",value:(p=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hy.getMatchMode()===VB.TOURNAMENT){e.next=3;break}return e.abrupt("return");case 3:return this.tournamentManager=this.getComponent(AI),e.next=6,this.tournamentManager.init();case 6:if(i=this.tournamentManager,r=i.leaderboardData,a=i.leaderboardName,s=i.tournamentData){e.next=9;break}return e.abrupt("return");case 9:if(l=s.payload.themeId,this.setGameData({themeId:l}),r&&a){e.next=13;break}return e.abrupt("return");case 13:if(u=LB.getPlayerId(),(c=r.leaders[u])||!NB){e.next=22;break}return e.next=18,NB.getLeadersByPlayerIdsAsync(a,[u]);case 18:if(0!==(p=e.sent).length){e.next=21;break}return e.abrupt("return");case 21:c=p[0];case 22:_B.setStorageData("tournament","previousScore",null!==(t=null===(n=c)||void 0===n?void 0:n.score)&&void 0!==t?t:0);case 23:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"setGameData",value:function(e){var t,n,i,r=null!==(t=null!==(n=e.level)&&void 0!==n?n:null===(i=this.gameData)||void 0===i?void 0:i.level)&&void 0!==t?t:1;this.gameData=u(u(u({},this.gameData),e),{},{level:r})}},{key:"getGameData",value:function(){return this.gameData}},{key:"getSceneData",value:function(){return ot.getSceneData(this.node.scene)}},{key:"attemptCallCreateShortcut",value:function(){var e,t=null!==(e=this.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?0:n,r=t.nextLevelCount;i<2||(void 0===r?0:r)<2||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)}))}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){GameSDK.isGameSDK("CrazyGames")}}]),y}(x)).prototype,"board",[yB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wB=r(gB.prototype,"opacityToggler",[fB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kB=r(gB.prototype,"pathDraw",[vB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mB=gB));w._RF.pop(),w._RF.push({},"c863f/bTTdAjqEM+Kj9OaKi","DashboardEventButtonTypes",void 0);var ZB=function(e){return e[e.STAR_CHEST=0]="STAR_CHEST",e[e.BALLOON=1]="BALLOON",e[e.DAILY_REWARDS=2]="DAILY_REWARDS",e}(ZB||{});_(ZB),w._RF.pop(),w._RF.push({},"17fa4eEXEhIfZh+ad9Oqcmw","Leaderboard",void 0);var XB,QB=function(e){return e.WORLD_TAB_SELECTED="world-tab-selected",e.WEEKLY_TAB_SELECTED="weekly-tab-selected",e}(QB||{}),$B="#AE4212",ez="#3D5172",tz="#92200C",nz="#8F5542",iz="#8A4733",rz="#3e7110",az="#3e7110";w._RF.pop(),w._RF.push({},"4cd93d4ECxKDYSG9apAx603","LevelMission",void 0),w._RF.pop(),w._RF.push({},"2737dY5lxxEY6mKDXeUQJUc","ThemeLocaleKeys",void 0);var oz,sz=(m(XB={},ut.SUMMER,"theme.summer"),m(XB,ut.AUTUMN,"theme.autumn"),m(XB,ut.WINTER,"theme.winter"),m(XB,ut.SPRING_FESTIVAL,"theme.springFestival"),m(XB,ut.TREE_PLANTING_FESTIVAL,"theme.treePlantingFestival"),m(XB,ut.BLUE_SEA_FESTIVAL,"theme.blueSeaFestival"),m(XB,ut.MUSIC_FESTIVAL,"theme.musicFestival"),m(XB,ut.HARVEST_FESTIVAL,"theme.harvestFestival"),m(XB,ut.FOOD_FESTIVAL,"theme.foodFestival"),m(XB,ut.SNOW_FESTIVAL,"theme.snowFestival"),m(XB,ut.LIGHT_FESTIVAL,"theme.lightFestival"),m(XB,ut.PEACE_FESTIVAL,"theme.peaceFestival"),m(XB,ut.FLOWER_FESTIVAL,"theme.flowerFestival"),m(XB,ut.STREET_FESTIVAL,"theme.streetFestival"),m(XB,ut.COLOR_GARDEN,"theme.colorGarden"),m(XB,ut.COLOR_FESTIVAL,"theme.colorFestival"),m(XB,ut.NATURE_SUMMER,"theme.natureSummer"),m(XB,ut.SNOW_MOUNTAIN,"theme.snowMountain"),m(XB,ut.ICE_FESTIVAL,"theme.iceFestival"),m(XB,ut.GREEN_GRASS_FESTIVAL,"theme.greenGrassFestival"),m(XB,ut.COMMUNITY_FESTIVAL,"theme.communityFestival"),m(XB,ut.WATER_FESTIVAL,"theme.waterFestival"),m(XB,ut.ANIMAL_FESTIVAL,"theme.animalFestival"),m(XB,ut.LOST_FESTIVAL,"theme.lostFestival"),m(XB,ut.HALLOWEEN_FESTIVAL,"theme.halloweenFestival"),m(XB,ut.SNOW_MUSIC_FESTIVAL,"theme.snowMusicFestival"),m(XB,ut.CHRISTMAS,"theme.christmas"),m(XB,ut.SPRING_FLOWER_FESTIVAL,"theme.springFlowerFestival"),m(XB,ut.TET_HOLIDAY,"theme.tetHoliday"),m(XB,ut.SEA_FESTIVAL,"theme.seaFestival"),m(XB,ut.FIREWORK_FESTIVAL,"theme.fireworkFestival"),m(XB,ut.HALLOWEEN_HORROR,"theme.halloweenHorror"),m(XB,ut.MID_AUTUMN,"theme.midAutumn"),m(XB,ut.CHRISTMAS_SWEET,"theme.christmasSweet"),m(XB,ut.NEW_YEAR_COUNTDOWN,"theme.newYearCountdown"),m(XB,ut.HAPPY_NEW_YEAR,"theme.happyNewYear"),XB);w._RF.pop(),w._RF.push({},"78297LLtrJKMpOIidCw/BA9","index",void 0),w._RF.pop(),w._RF.push({},"176c3V0yoFEhIdpVcCIhDz7","isEmptyBoard",void 0),w._RF.pop(),w._RF.push({},"5262atLmldNy7Q3MtHgiSRI","HintItem",void 0);var lz;(0,S.ccclass)("HintItem")(oz=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"itemType",get:function(){return Xe.HINT}}]),o}(kO));w._RF.pop(),w._RF.push({},"3f4c1AB+jdNFqylpogoaiDZ","PliersItem",void 0);var uz;(0,S.ccclass)("PliersItem")(lz=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"itemType",get:function(){return Xe.PLIERS}}]),o}(kO));w._RF.pop(),w._RF.push({},"d6e51+oy6NCF7cKvf6KOWiu","StormItem",void 0);var cz;(0,S.ccclass)("StormItem")(uz=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"itemType",get:function(){return Xe.STORM}}]),o}(kO));w._RF.pop(),w._RF.push({},"b30ffJjU2lAH5yu2NkzVVnO","ThunderItem",void 0);var pz,hz,dz,yz,fz,vz,mz;(0,S.ccclass)("ThunderItem")(cz=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"itemType",get:function(){return Xe.THUNDER}}]),o}(kO));w._RF.pop(),w._RF.push({},"28c5eNXZLBE+50Dno043fmy","useTornadoThunderCombined",void 0),w._RF.pop(),w._RF.push({},"d2a57+mB4NG9rcdh+dy1VPe","traverse4",void 0),w._RF.pop(),w._RF.push({},"ca614iJ+X5LrL1rX/wDQDTD","shuffle",void 0),w._RF.pop(),w._RF.push({},"1cf4cygDSdP5JL+7w3wIJL7","traverseRandom",void 0),w._RF.pop(),w._RF.push({},"1faa9NgJrBE7p8Zs/HBWrZn","pad",void 0),w._RF.pop(),w._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var gz,bz=S.ccclass,wz=S.property;pz=bz("RendererModule"),hz=wz(Oe),dz=wz(se),pz((vz=r((fz=e((function e(){t(this,e),s(this,"material",vz,this),s(this,"spriteFrame",mz,this)}))).prototype,"material",[hz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mz=r(fz.prototype,"spriteFrame",[dz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yz=fz));w._RF.pop(),w._RF.push({},"c20acgKcuRFP6+Am/XjOFeP","ParticleSystem2DExtra",void 0);var kz,Sz=S.ccclass,Cz=S.disallowMultiple,Ez=S.executeInEditMode,xz=S.requireComponent,Az=Sz("ParticleSystem2DExtra")(gz=Ez(!0)(gz=Cz(!0)(gz=xz(Q)(gz=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,r=e.particleSystem._simulator.particles[i-1];e.initParticle(r)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,r=0;r<i.length;r++){var a=i[r];e.updateParticle(a,n)}t(n)}},e}return e(o,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(Q),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),o}(x))||gz)||gz)||gz)||gz;w._RF.pop(),w._RF.push({},"664feJL84ZOTaM99dgWY4x0","ExampleParticleSystem2DExtra",void 0);var Tz;(0,S.ccclass)("ExampleParticleSystem2DExtra")(kz=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"initParticle",value:function(e){e.maxSize=$.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=$.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+$.randomRange(-350,350),e.y=n+$.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),o}(Az));w._RF.pop(),w._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var Pz,Rz,Lz,Iz,Oz,_z,Dz,Mz,Nz,Bz,zz,Fz=S.ccclass,Uz=S.disallowMultiple,Gz=Ludex,Hz=Gz.Events,qz=Gz.Utils.Valid,Vz=Gz.Configs.Core.StartSDKAfterLoadGame,Wz=codex,Kz=Wz.ads,jz=Wz.player,Yz=Wz.event,Jz=Wz.context;Fz("BootScene")(Tz=Uz(Tz=function(r){n(y,r);var s,l,p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=d.call.apply(d,[this].concat(i))).setupLoadingFullScreen=function(){Vz?(nt.addShowedScene(ct.BOOT_SCENE),jz.isFirstSession()?nt.addShowedScene(ct.GAME_SCENE):nt.addShowedScene(ct.DASHBOARD_SCENE)):nt.showLoadingFullScreen(ct.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.setupGameData(),e.sendMsGamesDailyNotification()},e.loadBundles=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Fe.loadBundle("loadable"),Fe.loadBundle("animations")]);case 2:case"end":return e.stop()}}),e)}))),e.loadWasmModules=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SOLO"===Jz.getContextType()&&!jz.isFirstSession()){e.next=3;break}return e.next=3,Promise.all([pt.loadModuleAsync("spine")]);case 3:case"end":return e.stop()}}),e)}))),e.lazyLoadWasmModules=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([pt.loadModuleAsync("spine")]);case 2:case"end":return e.stop()}}),e)}))),e.handlePauseAudio=function(){Yz.on(Hz.VISIBILITY_HIDDEN,e.handleMuteAudio),Yz.on(Hz.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){Ve.muteAudio(!0)},e.handleUnMuteAudio=function(){null!=Kz&&Kz.isAdFullSizeShowing()||Ve.muteAudio(!1)},e}return e(y,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.preloadAssets(),this.listenEvents()}},{key:"preloadAssets",value:(h=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O.pause(),e.next=4,Promise.all([this.loadWasmModules(),this.loadBundles(),this.loadCurrentPlayerTheme(),this.loadGuideSkin()]);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn("processPreloadAssets",e.t0);case 9:return e.prev=9,null!=Kz&&Kz.isAdFullSizeShowing()||O.resume(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[0,6,9,12]])}))),function(){return h.apply(this,arguments)})},{key:"onLoad",value:function(){this.handlePauseAudio(),this.overrideGameSDK(),this.setupLoadingFullScreen()}},{key:"start",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.extra.waitSDKInitiatedAsync();case 2:this.processCrazyGamesLoadingStop(),this.disableBannerAdsOnStartingLevels();case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"listenEvents",value:function(){Yz.catchUp(Hz.GAME_READY,this.lazyLoadWasmModules),Yz.catchUp(Hz.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"overrideGameSDK",value:function(){if("FBInstant"in window&&"shareAsync"in FBInstant){var e=FBInstant.shareAsync;FBInstant.shareAsync=function(){var t=a(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u({},n),t.abrupt("return",e(i));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}},{key:"setupGameData",value:function(){var e=jz.getGameData();if(e){var t=e.totalLevel,n=Math.max(t,$e),i=u(u({},e),{},{totalLevel:n});jz.setGameData(i)}}},{key:"disableBannerAdsOnStartingLevels",value:function(){var e=jz.getGameData();if(e){var t=e.level,n=void 0!==t&&t>st.NUM_LEVEL_WITHOUT_BANNER_ADS;at.setAvoidBannerShowed(!n)}}},{key:"loadCurrentPlayerTheme",value:(l=a(o().mark((function e(){var t,n,i,r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=jd.mapOrder,n=t[0],qz.isObject(n)){e.next=4;break}return e.abrupt("return");case 4:if(i=jz.getGameData(),r=null==i?void 0:i.level,qz.isNumber(r)){e.next=10;break}return e.next=9,Fe.loadThemeAsync(n.theme);case 9:return e.abrupt("return");case 10:a=c(t),e.prev=11,a.s();case 13:if((s=a.n()).done){e.next=21;break}if(l=s.value,!((r-=l.levelCount)<=0)){e.next=19;break}return n=l,e.abrupt("break",21);case 19:e.next=13;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(11),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:return e.next=31,Fe.loadThemeAsync(n.theme);case 31:case"end":return e.stop()}}),e,null,[[11,23,26,29]])}))),function(){return l.apply(this,arguments)})},{key:"loadGuideSkin",value:(s=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(jz.isFirstSession()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$d.loadLevelSpriteFrames(0);case 4:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}}]),y}(x))||Tz);w._RF.pop(),w._RF.push({},"29f874DL75LO5NzzNYZvHDh","RigidBodyObject",void 0);var Zz,Xz,Qz,$z,eF,tF,nF,iF,rF,aF,oF,sF,lF=S.ccclass,uF=S.property;Pz=lF("RigidBodyObject"),Rz=uF(P),Lz=uF(ne),Iz=uF(P),Oz=uF(W),Pz((Mz=r((Dz=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"gravityScale",Mz,l(e)),s(e,"linearVelocity",Nz,l(e)),s(e,"bounce",Bz,l(e)),s(e,"simulate",zz,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.canvas=this.node.scene.getComponentInChildren(_e).getComponent(A),this.uiTransform=this.node.getComponent(A)}},{key:"update",value:function(e){if(this.simulate){this.applyGravity();var t=this.node.worldPosition.clone();t.add(new q(this.linearVelocity.x*e,this.linearVelocity.y*e,0)),t=this.applyBounce(t),this.node.setWorldPosition(t)}}},{key:"applyForce",value:function(e){this.linearVelocity.add(e)}},{key:"applyGravity",value:function(){var e=new ne(0,-9.8*this.gravityScale);this.applyForce(e)}},{key:"applyBounce",value:function(e){var t=this.uiTransform.getBoundingBoxToWorld();t.yMin<0&&(e.y=t.height/2,this.linearVelocity.y*=-this.bounce),t.xMin<0&&(e.x=t.width/2,this.linearVelocity.x*=-1);var n=this.canvas.width;return t.xMax>n&&(e.x=n-t.width/2,this.linearVelocity.x*=-1),e}}]),o}(x)).prototype,"gravityScale",[Rz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Nz=r(Dz.prototype,"linearVelocity",[Lz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ne(0,0)}}),Bz=r(Dz.prototype,"bounce",[Iz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zz=r(Dz.prototype,"simulate",[Oz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_z=Dz));w._RF.pop(),w._RF.push({},"93d88BQCU5B0L/TmaCaYNfm","AnimSkipOverlay",void 0);var cF,pF,hF,dF,yF,fF,vF,mF,gF,bF=S.ccclass,wF=S.property,kF=S.disallowMultiple,SF=function(){},CF=(Zz=bF("AnimSkipOverlay"),Xz=wF(M),Qz=wF(M),$z=wF(U),eF=Ii.onlyRunInLifeCycleAsync,tF=Ii.onlyRunInLifeCycleAsync,nF=Ii.onlyRunInLifeCycleAsync,Zz(iF=kF((aF=r((rF=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"containerUIOpacity",aF,l(e)),s(e,"maskUIOpacity",oF,l(e)),s(e,"skipButton",sF,l(e)),e.isOpened=!1,e.currentCallback=SF,e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.containerUIOpacity.node.active=!1,this.skipButton.interactable=!1}},{key:"onSkipButtonPress",value:function(){this.currentCallback(),this.close()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"open",value:(c=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.containerUIOpacity.node.active=!0,n=t.onSkip,i=t.opacity,r=void 0===i?255:i,a=t.transitionDuration,s=void 0===a?.2:a,this.maskUIOpacity.opacity=r,e.next=5,this.animateUIOpacity(0,255,s);case 5:this.currentCallback=n,this.skipButton.interactable=!0,this.isOpened=!0,this.node.scene.emit(Ge.OPENED_SKIP_OVERLAY,t);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"close",value:(u=a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:.2,this.skipButton.interactable=!1,this.currentCallback=SF,e.next=5,this.animateUIOpacity(255,0,t);case 5:this.maskUIOpacity.opacity=0,this.containerUIOpacity.node.active=!1,this.isOpened=!1,this.node.scene.emit(Ge.CLOSED_SKIP_OVERLAY);case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"animateUIOpacity",value:function(e,t,n){return this.containerUIOpacity.opacity=e,Ue.runTweenAsync(L(this.containerUIOpacity).to(n,{opacity:t}))}},{key:"untilClosed",value:function(){var e=this;return!1===this.isOpened?Promise.resolve():new Promise((function(t){e.node.scene.once(Ge.CLOSED_SKIP_OVERLAY,t)}))}}]),h}(x)).prototype,"containerUIOpacity",[Xz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oF=r(rF.prototype,"maskUIOpacity",[Qz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sF=r(rF.prototype,"skipButton",[$z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(rF.prototype,"open",[eF],Object.getOwnPropertyDescriptor(rF.prototype,"open"),rF.prototype),r(rF.prototype,"close",[tF],Object.getOwnPropertyDescriptor(rF.prototype,"close"),rF.prototype),r(rF.prototype,"untilClosed",[nF],Object.getOwnPropertyDescriptor(rF.prototype,"untilClosed"),rF.prototype),iF=rF))||iF)||iF);w._RF.pop(),w._RF.push({},"95ba56f1qVFfLLdPv++OfLw","SmoothScrollView",void 0);var EF,xF=S.ccclass,AF=S.property,TF=(cF=xF("SmoothScrollView"),pF=AF({type:W,group:"Mouse Scroll"}),hF=AF({type:P,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),dF=AF({type:P,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),cF((vF=r((fF=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"mouseScroll",vF,l(e)),s(e,"mouseScrollSpeed",mF,l(e)),s(e,"mouseScrollDuration",gF,l(e)),e}return e(o,[{key:"_onMouseWheel",value:function(e,t){if(this.mouseScroll){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(e,t)){var n=new q,i=e.getScrollY()<0?1:-1;this.vertical?n.set(0,i*this.mouseScrollSpeed,0):this.horizontal&&n.set(i*this.mouseScrollSpeed,0,0),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._startAutoScroll(n,this.mouseScrollDuration,!0),this._stopPropagationIfTargetIsMe(e)}}else p(h(o.prototype),"_onMouseWheel",this).call(this,e,t)}}]),o}(De)).prototype,"mouseScroll",[pF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mF=r(fF.prototype,"mouseScrollSpeed",[hF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),gF=r(fF.prototype,"mouseScrollDuration",[dF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),yF=fF))||yF);w._RF.pop(),w._RF.push({},"904917NfYBJy781QxKjEPIO","ViewNode",void 0);var PF,RF,LF,IF,OF,_F,DF,MF,NF,BF,zF,FF,UF,GF,HF,qF,VF,WF,KF,jF,YF,JF,ZF,XF,QF,$F,eU,tU,nU,iU=S.ccclass,rU=S.requireComponent,aU=iU("ViewNode")(EF=rU(M)(EF=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).order=0,e}return e(o,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"setVisible",value:function(e){this.uiOpacity.opacity=e?255:0}},{key:"isVisible",value:function(){return this.uiOpacity.opacity>0}}]),o}(x))||EF)||EF;w._RF.pop(),w._RF.push({},"0b250nSw/RHRq8vKigzgfhs","ScrollViewLayout",void 0);var oU=S.ccclass,sU=S.property,lU=S.requireComponent,uU=Ludex.Utils,cU=uU.Array,pU=uU.Signal,hU=(PF=oU("ScrollViewLayout"),RF=lU(TF),LF=Ii.required,IF=sU(A),OF=sU(P),_F=sU(ye),DF=sU(T),MF=Ii.required,NF=sU(T),BF=Ii.required,zF=Ii.required,FF=Ii.required,UF=Ii.onlyRunInLifeCycleAsync,GF=Ii.onlyRunInLifeCycleAsync,HF=Ii.onlyRunInLifeCycleAsync,qF=Ii.onlyRunInLifeCycle,VF=Ii.onlyRunInLifeCycle,WF=Ii.onlyRunInLifeCycle,KF=Ii.onlyRunInLifeCycle,PF(jF=RF((JF=r((YF=function(r){n(f,r);var u,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"viewport",JF,l(e)),s(e,"spacing",ZF,l(e)),s(e,"nodePrefab",XF,l(e)),s(e,"maxNodeCount",QF,l(e)),s(e,"extendCount",$F,l(e)),s(e,"scrollView",eU,l(e)),s(e,"uiTransform",tU,l(e)),s(e,"contentUiTransform",nU,l(e)),e.nodePool=[],e.nodeHeight=0,e.scrollSignalController=new pU.SignalController,e.onNodeVisible=function(){},e.onNodeInvisible=function(){},e}return e(f,[{key:"__preload",value:function(){var e;this.scrollView=this.getComponent(TF),this.uiTransform=this.getComponent(A),this.contentUiTransform=null===(e=this.scrollView.content)||void 0===e?void 0:e.getComponent(A)}},{key:"onDestroy",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized,this)}},{key:"start",value:function(){var e=he(this.nodePrefab);this.nodeHeight=e.getComponent(A).height,e.destroy(),Ii.validateRequiredProperties(this,f)}},{key:"init",value:function(e,t){this.createNodePool(),this.onNodeVisible=null!=e?e:this.onNodeVisible,this.onNodeInvisible=null!=t?t:this.onNodeInvisible;for(var n=0;n<this.nodePool.length;n++){var i;null===(i=this.nodePool[n])||void 0===i||i.setVisible(!1)}this.updateVisibility()}},{key:"updateNodeVisibility",value:function(){for(var e=0;e<this.nodePool.length;e++){var t=this.nodePool[e];t&&(t.isVisible()?this.onNodeVisible(t):this.onNodeInvisible(t))}}},{key:"listenEvents",value:function(){this.scrollView.node.on(De.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.on(Me.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.on(Me.MOUSE_WHEEL,this.abortScrollSignal,this),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(De.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.off(Me.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.off(Me.MOUSE_WHEEL,this.abortScrollSignal,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this)}},{key:"scrollToOrder",value:(d=a(o().mark((function e(t,n){var i,r,a,s,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>2&&void 0!==l[2]?l[2]:2,r=this.getNodeScrollOffset(t),a=this.scrollView.getScrollOffset().y,r=Math.max(r,0),a=Math.max(a,0),s=r-a,!(Math.abs(s)<5)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.scrollToOffset(new ne(0,r),i,n);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"scrollToTop",value:(h=a(o().mark((function e(t){var n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:2,e.next=3,this.scrollToOffset(new ne(0,0),n,t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"scrollToOffset",value:(p=a(o().mark((function e(t,n,i){var r,a,s,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.scrollSignalController.renew(),this.scrollView.scrollToOffset(t,n),a=function(){return l.handleScrollSignalAborted()},s=function(){r.aborted||l.handleExternalSignalAborted(t)},r.once(a),i.addAbortListener(s),e.next=8,Ue.waitTweenAsync(n,i);case 8:r.off(a),i.removeAbortListener(s);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"updateVisibility",value:function(){for(var e=this.viewport.getBoundingBoxToWorld(),t=e.yMax,n=e.yMin,i=0;i<this.maxNodeCount;i++){var r=this.getNodeBoundingBoxWorld(i),a=r.top,o=r.bot;if(a<n||o>t){var s=this.getNodeByOrder(i);s&&(this.onNodeInvisible(s),s.setVisible(!1))}else{var l=this.getNodeByOrder(i);if(l)l.isVisible()||(l.order=i,this.onNodeVisible(l),l.setVisible(!0));else{var u=this.getInvisibleNode();u&&(u.node.setPosition(this.getNodePosition(i)),u.order=i,this.onNodeVisible(u),u.setVisible(!0))}}}}},{key:"updateLayout",value:function(){var e,t=this.getVisibleNodes(),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.node.setPosition(this.getNodePosition(i.order))}}catch(e){n.e(e)}finally{n.f()}}},{key:"setMaxNodeCount",value:function(e){this.maxNodeCount=e,this.contentUiTransform.height=(this.nodeHeight+this.spacing)*this.maxNodeCount}},{key:"getAllNodes",value:function(){return this.nodePool}},{key:"getVisibleNodes",value:function(){return this.nodePool.filter((function(e){return e.isVisible()}))}},{key:"getNodePosition",value:function(e){return new q(0,-(this.nodeHeight+this.spacing)*e-this.nodeHeight/2,0)}},{key:"getNodeScrollOffset",value:function(e){return-this.getNodePosition(e).y-this.uiTransform.node.worldPosition.y-this.uiTransform.height/2+this.viewport.node.worldPosition.y}},{key:"getNodeByOrder",value:function(e){return cU.search(this.nodePool,(function(t){return t.order===e}))}},{key:"getInvisibleNode",value:function(){return cU.search(this.nodePool,(function(e){return!e.isVisible()}))}},{key:"createNodePool",value:function(){var e=Math.ceil(this.viewport.height/this.nodeHeight)+1+this.extendCount;if(!(this.nodePool.length>=e)){var t=e-this.nodePool.length;this.setMaxNodeCount(this.maxNodeCount);for(var n=0;n<t;n++){var i,r=he(this.nodePrefab);null===(i=this.scrollView.content)||void 0===i||i.addChild(r),r.setPosition(this.getNodePosition(this.nodePool.length));var a=r.addComponent(aU);a.order=this.nodePool.length,a.setVisible(!1),this.nodePool.push(a)}}}},{key:"getNodeBoundingBoxWorld",value:function(e){var t,n,i=this.getNodePosition(e).y+(null!==(t=null===(n=this.scrollView.content)||void 0===n?void 0:n.worldPosition.y)&&void 0!==t?t:0);return{top:i+this.nodeHeight/2,bot:i-this.nodeHeight/2}}},{key:"abortScrollSignal",value:function(){this.scrollSignalController.abort()}},{key:"handleScrollSignalAborted",value:function(){this.scrollView.stopAutoScroll(),this.updateVisibility()}},{key:"handleExternalSignalAborted",value:function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToOffset(e,0),this.updateVisibility()}},{key:"handleViewResized",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.waitTweenAsync(0);case 2:this.createNodePool(),this.updateVisibility();case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),f}(x)).prototype,"viewport",[LF,IF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZF=r(YF.prototype,"spacing",[OF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),XF=r(YF.prototype,"nodePrefab",[_F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QF=r(YF.prototype,"maxNodeCount",[DF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$F=r(YF.prototype,"extendCount",[MF,NF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),eU=r(YF.prototype,"scrollView",[BF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tU=r(YF.prototype,"uiTransform",[zF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nU=r(YF.prototype,"contentUiTransform",[FF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(YF.prototype,"scrollToOrder",[UF],Object.getOwnPropertyDescriptor(YF.prototype,"scrollToOrder"),YF.prototype),r(YF.prototype,"scrollToTop",[GF],Object.getOwnPropertyDescriptor(YF.prototype,"scrollToTop"),YF.prototype),r(YF.prototype,"scrollToOffset",[HF],Object.getOwnPropertyDescriptor(YF.prototype,"scrollToOffset"),YF.prototype),r(YF.prototype,"updateVisibility",[qF],Object.getOwnPropertyDescriptor(YF.prototype,"updateVisibility"),YF.prototype),r(YF.prototype,"createNodePool",[VF],Object.getOwnPropertyDescriptor(YF.prototype,"createNodePool"),YF.prototype),r(YF.prototype,"handleScrollSignalAborted",[WF],Object.getOwnPropertyDescriptor(YF.prototype,"handleScrollSignalAborted"),YF.prototype),r(YF.prototype,"handleExternalSignalAborted",[KF],Object.getOwnPropertyDescriptor(YF.prototype,"handleExternalSignalAborted"),YF.prototype),jF=YF))||jF)||jF);w._RF.pop(),w._RF.push({},"a3bd3opU7JJh4TqZ3uorJHi","DailyRewardsUtils",void 0);var dU,yU,fU,vU,mU,gU,bU,wU,kU,SU,CU,EU=codex,xU=EU.player,AU=EU.storage,TU=EU.dailyRewards,PU=Ludex,RU=PU.Utils.Array,LU=PU.Configs.DailyRewards,IU=LU.MockTime,OU=LU.MaxDays,_U=LU.CheckInterrupt,DU=IU>0?IU:864e5,MU=function(){function n(){t(this,n)}var i,r,s,l,c,p;return e(n,null,[{key:"setDirty",value:function(){this.lastUpdate=0}},{key:"logLoginReward",value:function(){TU.logLoginReward(),this.setDirty(),this.tryUpdateData()}},{key:"tryUpdateData",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shouldUpdateData()){e.next=2;break}return e.abrupt("return");case 2:return this.lastUpdate=Date.now(),e.next=5,TU.requestDailyRewardsAsync();case 5:t=this.getCurrentRemainingTime(),this.updateInterval=t/2;case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"hasClaimableRewards",value:(c=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tryUpdateData();case 2:if(null!==(t=TU.getDailyRewards())){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",void 0!==RU.search(Object.values(t),(function(e){return"ready"===e.status})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hasShownPopup",value:function(){return AU.getStorage("dashboardDailyRewards").hasShownPopup}},{key:"getRewardsData",value:(l=a(o().mark((function e(){var t,n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tryUpdateData();case 2:if(null!==(t=TU.getDailyRewards())){e.next=5;break}return e.abrupt("return",null);case 5:n=[],i=0;case 7:if(!(i<OU)){e.next=16;break}if(r=_d[i]){e.next=11;break}return e.abrupt("continue",13);case 11:a=t[i+1],n.push(u(u({id:r.id,type:r.type,status:r.status},a),{},{value:r.value,items:r.items?u({},r.items):void 0}));case 13:i++,e.next=7;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"setHasShownPopup",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];AU.setStorageData("dashboardDailyRewards","hasShownPopup",e)}},{key:"openPopupScreen",value:(s=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.openScreen(it.DAILY_REWARDS_SCREEN);case 2:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"openPopupScreenAndWaitForClose",value:(r=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.openScreenAndWaitForClose(it.DAILY_REWARDS_SCREEN);case 2:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getRemainingTime",value:(i=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tryUpdateData();case 2:return e.abrupt("return",this.getCurrentRemainingTime());case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getCurrentRemainingTime",value:function(){var e;if(null===TU.getDailyRewards())return 0;var t=null!==(e=xU.getPlayerData().dailyRewardedData)&&void 0!==e?e:{},n=t.firstReward,i=void 0===n?0:n,r=t.lastReward,a=void 0===r?0:r;if(_U){var o=this.findLastRewardedIndex();if(-1===o)return 0;var s=i+(o+1)*DU;return Math.max(s-Date.now(),0)}var l=a+DU;return Math.max(l-Date.now(),0)}},{key:"findLastRewardedIndex",value:function(){for(var e,t=(null!==(e=xU.getPlayerData().dailyRewardedData)&&void 0!==e?e:{}).logDays,n=void 0===t?[]:t,i=n.length-1;i>=0;i--)if(n[i])return i;return-1}},{key:"shouldUpdateData",value:function(){return Date.now()-this.lastUpdate>this.updateInterval}}]),n}();MU.lastUpdate=0,MU.updateInterval=0,w._RF.pop(),w._RF.push({},"18bbbp5z2VHVKp4jjjmsAhu","ThemeProgressBar",void 0);var NU,BU,zU,FU,UU,GU,HU,qU,VU,WU,KU,jU,YU,JU,ZU,XU,QU,$U=S.ccclass,eG=S.property,tG=(dU=$U("ThemeProgressBar"),yU=eG(H),fU=eG(H),vU=eG(H),mU=eG(H),dU((wU=r((bU=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"progressBar",wU,l(e)),s(e,"progressText",kU,l(e)),s(e,"leftCap",SU,l(e)),s(e,"rightCap",CU,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("ThemeProgressBar: progressBar not found");if(!this.progressText)throw new Error("ThemeProgressBar: progressText not found");if(!this.leftCap)throw new Error("ThemeProgressBar: leftCap not found");if(!this.rightCap)throw new Error("ThemeProgressBar: rightCap not found")}},{key:"setProgress",value:function(e,t){e<=0?(this.leftCap.active=!1,this.rightCap.active=!1):(this.leftCap.active=!0,this.rightCap.active=!0);var n=this.progressBar.getComponent(te);if(!n)throw new Error("ThemeProgressBar: progressBarComponent not found");n.progress=e/t;var i=this.progressText.getComponent(Y);if(!i)throw new Error("ThemeProgressBar: progressTextComponent not found");i.string="".concat(e,"/").concat(t)}}]),o}(x)).prototype,"progressBar",[yU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kU=r(bU.prototype,"progressText",[fU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SU=r(bU.prototype,"leftCap",[vU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CU=r(bU.prototype,"rightCap",[mU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gU=bU))||gU);w._RF.pop(),w._RF.push({},"e62f9TdkTxOyJy6vcnplnCB","LockAnimator",void 0);var nG,iG,rG,aG,oG,sG,lG,uG,cG,pG,hG,dG,yG,fG,vG,mG,gG,bG,wG,kG,SG,CG,EG,xG,AG,TG,PG,RG,LG,IG,OG,_G,DG,MG,NG,BG,zG,FG,UG=S.ccclass,GG=S.disallowMultiple,HG=S.property,qG=[50,160],VG=(NU=UG("LockAnimator"),BU=HG(Q),zU=HG(le),FU=HG(ue),UU=HG(ue),GU=HG(ue),HU=HG(zh),qU=HG({type:T,min:0}),NU(VU=GG((KU=r((WU=function(r){n(f,r);var u,c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"floatingParticles",KU,l(e)),s(e,"iconAnimation",jU,l(e)),s(e,"lockClip",YU,l(e)),s(e,"unlockClip",JU,l(e)),s(e,"tryToUnlockClip",ZU,l(e)),s(e,"trailTemplate",XU,l(e)),s(e,"trailCount",QU,l(e)),e.trails=[],e}return e(f,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.prepareTrails(),this.floatingParticles.node.active=!1}},{key:"unlock",value:(d=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.floatingParticles.node.active=!0,this.floatingParticles.resetSystem(),this.scheduleOnce((function(){n.explodeTrails(t)}),1.1),e.next=5,this.playAnimation(this.unlockClip.name,t);case 5:this.floatingParticles.stopSystem();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"lock",value:function(){this.playAnimation(this.lockClip.name),this.floatingParticles.node.active&&this.floatingParticles.stopSystem()}},{key:"explodeTrails",value:(h=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.trails.map((function(e){return n.getExplodeTrail(e,0,t)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getExplodeTrail",value:(p=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:0,i=p.length>2?p[2]:void 0,r=ce(0,2*Math.PI),a=ce(qG[0],qG[1])*Math.cos(r),s=ce(qG[0],qG[1])*Math.sin(r),l=new q(a,s,t.node.position.z),u=t.node.scale.clone(),c=L(t.node).delay(n).call((function(){t.node.setPosition(0,0),t.reset(),t.node.active=!0})).to(.5,{position:l.clone()},{easing:"expoOut"}).to(.5,{scale:new q(0,0,1)},{easing:"expoIn"}),e.next=10,Ue.runTweenAsync(c,i);case 10:t.node.setPosition(0,0),t.node.scale=u,t.reset(),t.node.active=!1;case 14:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"prepareTrails",value:function(){this.trailTemplate.node.active=!1;for(var e=0;e<this.trailCount;e++){var t=he(this.trailTemplate.node);t.setParent(this.node),t.active=!1,this.trails.push(t.getComponent(zh))}}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"playAnimation",value:(c=a(o().mark((function e(t,n){var i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.aborted){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.abrupt("return",new Promise((function(e){i.iconAnimation.once(le.EventType.FINISHED,(function(){e()})),null==n||n.addAbortListener((function(){i.iconAnimation.off(le.EventType.FINISHED),i.iconAnimation.stop(),e()})),i.iconAnimation.play(t)})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},{key:"playTryToUnlockAnimation",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.playAnimation(this.tryToUnlockClip.name));case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),f}(x)).prototype,"floatingParticles",[BU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jU=r(WU.prototype,"iconAnimation",[zU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YU=r(WU.prototype,"lockClip",[FU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JU=r(WU.prototype,"unlockClip",[UU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZU=r(WU.prototype,"tryToUnlockClip",[GU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XU=r(WU.prototype,"trailTemplate",[HU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QU=r(WU.prototype,"trailCount",[qU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),VU=WU))||VU)||VU);w._RF.pop(),w._RF.push({},"aef0d6qo8hNUJ7qNl2wuT29","ThemeBlock",void 0);var WG,KG,jG,YG,JG,ZG,XG,QG,$G,eH,tH,nH,iH,rH=S.ccclass,aH=S.property,oH={progress:0,max:10,isLocked:!0,theme:ut.SUMMER,skins:[Iy.FRUIT]},sH=Ludex.Utils.Array,lH=(nG=rH("ThemeBlock"),iG=Ii.required,rG=aH(H),aG=Ii.required,oG=aH(H),sG=Ii.required,lG=aH(VG),uG=Ii.required,cG=aH({type:H,group:"Container"}),pG=Ii.required,hG=aH({type:M,group:"Container"}),dG=Ii.required,yG=aH({type:H,group:"Theme"}),fG=Ii.required,vG=aH({type:N,group:"Theme"}),mG=Ii.required,gG=aH({type:cp,group:"Title"}),bG=Ii.required,wG=aH({type:M,group:"Title"}),kG=Ii.required,SG=aH({type:N,group:"Tile"}),CG=Ii.required,EG=aH({type:M,group:"Tile"}),xG=aH(W),AG=Ii.onlyRunInLifeCycleAsync,nG((RG=r((PG=function(r){n(f,r);var c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"mask",RG,l(e)),s(e,"progressBar",LG,l(e)),s(e,"lockAnimator",IG,l(e)),s(e,"container",OG,l(e)),s(e,"containerOpacity",_G,l(e)),s(e,"themeLoadingRing",DG,l(e)),s(e,"themeSprite",MG,l(e)),s(e,"titleLocalizer",NG,l(e)),s(e,"titleOpacity",BG,l(e)),s(e,"tileBlockIconSprite",zG,l(e)),s(e,"newTilesOpacity",FG,l(e)),e.signal=new An,e.payload=oH,e}return e(f,[{key:"isLocked",get:function(){return this.payload.isLocked},set:function(e){this.payload.isLocked=e,this.updateInfo()}},{key:"__preload",value:function(){this.maskUIOpacity=this.mask.getComponent(M),Ii.validateRequiredProperties(this,f)}},{key:"updateInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oH;this.payload=e;var t=e.progress,n=e.max,i=e.isLocked,r=e.theme,a=e.skins;this.signal.abort();var o=new An;this.signal=o,this.updateTitle(r),this.updateSkinAsync(a,o),this.updateThemeAsync(r,o);var s=this.progressBar.getComponent(tG);if(!s)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=i,this.progressBar.active=!i,this.lockAnimator.node.active=i,i&&this.lockAnimator.lock(),this.maskUIOpacity.opacity=i?128:0,i||s.setProgress(t,n)}},{key:"playUnlockAnim",value:(d=a(o().mark((function e(t){var n,i,r,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:oH,this.payload=u(u({},n),{},{isLocked:!1}),i=n.progress,r=n.max,a=this.progressBar.getComponent(tG)){e.next=6;break}throw new Error("ThemeBlock: progressBarComponent not found");case 6:return this.mask.active=!0,this.progressBar.active=!1,this.lockAnimator.node.active=!0,a.setProgress(i,r),e.next=12,this.animateUnlockedState(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"updateTitle",value:function(e){var t=sz[e];this.titleLocalizer.key=t}},{key:"updateSkinAsync",value:(h=a(o().mark((function e(t,n){var i,r,s,l,u,c,p,h,d,y,f,m,g,b,w,k,S,C,E,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.tileBlockIconSprite.length,r=t.length,s=t.map(function(){var e=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe.loadSkinPreviewAsync(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(s);case 5:if(l=e.sent,!n.aborted&&this.tileBlockIconSprite){e.next=8;break}return e.abrupt("return");case 8:if(r<=i){for(u=Math.floor(i/r),c=i%r,p=v(sH.fillWith(r,(function(){return u}))),h=0;h<c;h++)d=p[h],p[h]=d+1;for(y=0,f=0;f<r;f++)for(m=p[f],g=0;g<m&&y<i;g++,y++)b=l[f],w=b[g],this.tileBlockIconSprite[y].spriteFrame=w}else for(k=0,S=this.tileBlockIconSprite.length;k<S;k++)C=this.tileBlockIconSprite[k],E=l[k%r],x=E[0],C.spriteFrame=x;case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"updateThemeAsync",value:(p=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.themeSprite.spriteFrame=null,i=Fe.getAsset("".concat(ht[t],"/spriteFrame"),se)){e.next=11;break}return this.themeLoadingRing.active=!0,e.next=6,Ue.waitTweenAsync(.1,n);case 6:if(!n.aborted){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Fe.loadThemePreviewAsync(t);case 10:i=e.sent;case 11:if(i){e.next=15;break}return e.next=14,Fe.loadThemePreviewAsync(ut.SUMMER);case 14:i=e.sent;case 15:if(this.themeSprite&&i&&!n.aborted){e.next=17;break}return e.abrupt("return");case 17:this.themeSprite.spriteFrame=i,this.themeLoadingRing.active=!1;case 19:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"animateUnlockedState",value:(c=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.progressBar.getComponent(M)){e.next=3;break}throw new Error("ThemeBlock: progressBarUIOpacity not found");case 3:return this.mask.active=!0,this.maskUIOpacity.opacity=null!==(n=this.maskUIOpacity.opacity)&&void 0!==n?n:255,this.progressBar.active=!0,i.opacity=0,e.next=9,this.lockAnimator.unlock(t);case 9:return this.lockAnimator.node.active=!1,e.next=12,Promise.all([Ue.runTweenAsync(L(this.maskUIOpacity).to(.25,{opacity:0}),t),Ue.runTweenAsync(L(i).to(.25,{opacity:255}),t)]);case 12:this.mask.active=!1,this.maskUIOpacity.opacity=0,i.opacity=255;case 15:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setVisible",value:function(e){this.containerOpacity.opacity=e?255:0,this.titleOpacity.opacity=e?255:0,this.newTilesOpacity.opacity=e?255:0}}]),f}(x)).prototype,"mask",[iG,rG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LG=r(PG.prototype,"progressBar",[aG,oG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IG=r(PG.prototype,"lockAnimator",[sG,lG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OG=r(PG.prototype,"container",[uG,cG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_G=r(PG.prototype,"containerOpacity",[pG,hG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DG=r(PG.prototype,"themeLoadingRing",[dG,yG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MG=r(PG.prototype,"themeSprite",[fG,vG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NG=r(PG.prototype,"titleLocalizer",[mG,gG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BG=r(PG.prototype,"titleOpacity",[bG,wG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zG=r(PG.prototype,"tileBlockIconSprite",[kG,SG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),FG=r(PG.prototype,"newTilesOpacity",[CG,EG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(PG.prototype,"isLocked",[xG],Object.getOwnPropertyDescriptor(PG.prototype,"isLocked"),PG.prototype),r(PG.prototype,"updateSkinAsync",[AG],Object.getOwnPropertyDescriptor(PG.prototype,"updateSkinAsync"),PG.prototype),TG=PG))||TG);w._RF.pop(),w._RF.push({},"b3a4dy5XgpIT6stybzgYjnu","CollectionsContent",void 0);var uH,cH,pH,hH,dH,yH,fH,vH,mH,gH,bH,wH,kH,SH,CH=S.ccclass,EH=S.property,xH=codex.storage,AH=(WG=CH("CollectionsContent"),KG=EH(pl),jG=EH(hU),YG=EH(Ao),JG=EH({type:P,displayName:"Offset from top of scroll view",tooltip:"The offset between the first theme tab and the top of the scroll view"}),ZG=Ii.onlyRunInLifeCycleAsync,XG=Ii.onlyRunInLifeCycleAsync,WG((eH=r(($G=function(r){n(d,r);var c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=h.call.apply(h,[this].concat(i))).animateThemeBlockUnlockIndex=null,s(e,"panelAnimator",eH,l(e)),s(e,"themeScrollView",tH,l(e)),s(e,"contentOpacity",nH,l(e)),e.themeScrollViewInited=!1,e.payloads=[],e.preservedScrollPosition=new ne,s(e,"offsetFromTopOfScrollView",iH,l(e)),e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"listenEvents",value:function(){this.node.scene.on(Us.HIDE_UI,this.hideContent),this.node.scene.on(Us.SHOW_UI,this.showContent),this.themeScrollView.listenEvents()}},{key:"unlistenEvents",value:function(){this.unlistenUIEvents(),this.themeScrollView.unlistenEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Us.HIDE_UI,this.hideContent),this.node.scene.off(Us.SHOW_UI,this.showContent)}},{key:"init",value:function(e){var t=this;this.payloads=e,this.themeScrollViewInited||(this.themeScrollViewInited=!0,this.themeScrollView.init((function(e){var n,i=t.animateThemeBlockUnlockIndex===e.order,r=t.payloads[e.order],a=e.getComponent(lH);r&&(a.updateInfo(u(u({},r),{},{skins:null!==(n=r.skins)&&void 0!==n?n:[],isLocked:!!i||r.isLocked})),a.setVisible(!0),a.container.scale=new q(.4,.4,.4),L(a.container).to(.3,{scale:q.ONE},{easing:"quadOut"}).start())})))}},{key:"preserveScrollPosition",value:function(){this.themeScrollView.scrollView.stopAutoScroll(),this.preservedScrollPosition.set(this.themeScrollView.scrollView.getScrollOffset())}},{key:"restoreScrollPosition",value:function(){this.themeScrollView.scrollView.scrollToOffset(this.preservedScrollPosition,0)}},{key:"updateUnlockedProgress",value:function(e){var t=this,n=xH.getStorageData("collection","animateMapPackUnlock"),i=xH.getStorageData("collection","lastMapPack");e.forEach((function(e,r){var a=e.progress,o=e.max,s=e.isLocked;if(a<o&&!s&&n&&i!==r+1)return t.animateThemeBlockUnlockIndex=r,xH.setStorageData("collection","animateMapPackUnlock",!1),void xH.setStorageData("collection","lastMapPack",r+1)}))}},{key:"shouldAnimateThemeBlockUnlock",value:function(){return null!==this.animateThemeBlockUnlockIndex}},{key:"playThemeTabUnlockAnim",value:(p=a(o().mark((function e(t){var n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.animateThemeBlockUnlockIndex){e.next=2;break}return e.abrupt("return");case 2:if((i=this.themeScrollView.getNodeByOrder(this.animateThemeBlockUnlockIndex))&&i.isVisible()){e.next=5;break}return e.abrupt("return");case 5:if(r=i.getComponent(lH)){e.next=8;break}return e.abrupt("return");case 8:if(a=$d.getCollectionUnlockProgress()[this.animateThemeBlockUnlockIndex]){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,r.playUnlockAnim(t,u(u({},a),{},{skins:null!==(n=a.skins)&&void 0!==n?n:[],isLocked:!0}));case 13:this.animateThemeBlockUnlockIndex=null;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"scrollToCurrentUnlockingTheme",value:(c=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.themeScrollView.scrollToOrder(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),d}(x)).prototype,"panelAnimator",[KG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tH=r($G.prototype,"themeScrollView",[jG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nH=r($G.prototype,"contentOpacity",[YG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iH=r($G.prototype,"offsetFromTopOfScrollView",[JG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 407.5}}),r($G.prototype,"playThemeTabUnlockAnim",[ZG],Object.getOwnPropertyDescriptor($G.prototype,"playThemeTabUnlockAnim"),$G.prototype),r($G.prototype,"scrollToCurrentUnlockingTheme",[XG],Object.getOwnPropertyDescriptor($G.prototype,"scrollToCurrentUnlockingTheme"),$G.prototype),QG=$G))||QG);w._RF.pop(),w._RF.push({},"500274Qu9dAjJwYv27wMaMU","StarProgressBar",void 0);var TH,PH,RH,LH,IH,OH,_H,DH,MH,NH,BH,zH,FH,UH,GH,HH,qH,VH,WH,KH,jH,YH=S.ccclass,JH=S.property,ZH=(uH=YH("StarProgressBar"),cH=JH(Fu),pH=JH(Y),hH=JH(T),dH=JH(T),yH=JH(C),fH=Ii.onlyRunInLifeCycle,uH((gH=r((mH=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"progressBar",gH,l(e)),s(e,"progressLabel",bH,l(e)),s(e,"current",wH,l(e)),s(e,"total",kH,l(e)),s(e,"separator",SH,l(e)),e}return e(p,[{key:"setRange",value:function(e,t){this.total=t,this.current=e,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"updateProgress",value:function(){this.progressBar.progress=Math.min(this.current,this.total)/this.total,this.updateProgressLabel()}},{key:"updateProgressLabel",value:function(){this.progressLabel.string="".concat(this.current).concat(this.separator).concat(this.total)}},{key:"animateTo",value:(u=a(o().mark((function e(t,n,i){var r,a,s,l,u,c=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.min(t,this.total)/this.total,a=this.current,s=1,l=L(this.progressBar).to(3,{progress:r},{easing:"quadOut",onUpdate:function(e,n){n&&(c.current=a+Math.floor((t-a)*n),null==i||i(c.current),c.current===a-s&&(s++,L(c.progressLabel.node).to(.05,{scale:new q(1.2,1.2,1.2)}).to(.05,{scale:q.ONE}).start()),c.updateProgressLabel())}}),u=function(){c.current=t,c.updateProgress()},null==n||n.addAbortListener(u),e.next=8,Ue.runTweenAsync(l,n);case 8:null==n||n.removeAbortListener(u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),p}(x)).prototype,"progressBar",[cH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bH=r(mH.prototype,"progressLabel",[pH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wH=r(mH.prototype,"current",[hH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kH=r(mH.prototype,"total",[dH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SH=r(mH.prototype,"separator",[yH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(mH.prototype,"updateProgress",[fH],Object.getOwnPropertyDescriptor(mH.prototype,"updateProgress"),mH.prototype),vH=mH))||vH);w._RF.pop(),w._RF.push({},"62d0dndWgNMpLpyrC7yEEUL","DailyRewardsWidget",void 0);var XH,QH,$H,eq,tq,nq,iq=S.ccclass,rq=S.property,aq=Ludex,oq=aq.Utils,sq=oq.Signal,lq=oq.String,uq=aq.Configs.DailyRewards.MockTime,cq=aq.Events,pq=codex.event,hq=uq>0?uq:864e5,dq=(TH=iq("DailyRewardsWidget"),PH=Ii.required,RH=rq("cc.animation.AnimationController"),LH=Ii.required,IH=rq(Ex),OH=Ii.required,_H=rq(Y),DH=Ii.required,MH=rq(Fu),NH=Ii.required,BH=rq(H),zH=Ii.onlyRunInLifeCycle,FH=Ii.onlyRunInLifeCycle,UH=Ii.onlyRunInLifeCycle,TH((qH=r((HH=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"animationController",qH,l(e)),s(e,"particles",VH,l(e)),s(e,"timeLabel",WH,l(e)),s(e,"progressBar",KH,l(e)),s(e,"progressBarAndLabel",jH,l(e)),e.signalController=new sq.SignalController,e.handleScreenClosed=function(t){t.screenName===lt[it.DAILY_REWARDS_SCREEN]&&e.refresh()},e}return e(h,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,h)}},{key:"onEnable",value:function(){pq.on(cq.CLOSED_SCREEN,this.handleScreenClosed)}},{key:"onDisable",value:function(){pq.off(cq.CLOSED_SCREEN,this.handleScreenClosed),this.signalController.abort()}},{key:"onDestroy",value:function(){this.signalController.abort()}},{key:"setParticles",value:function(e){e?this.particles.play():this.particles.stop()}},{key:"setProgressBarAndLabelVisibility",value:function(e,t){Ue.runTweenAsync(L(this.progressBarAndLabel).to(e?.5:.2,{scale:e?q.ONE:q.ZERO},{easing:e?"backOut":"sineIn"}),t)}},{key:"startUpdateRemainingTimeSchedule",value:function(e){var t=this,n=new sq.SignalController,i=function(){var r=a(o().mark((function r(){var a,s;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=n.renew()).chain(e),r.next=4,MU.getRemainingTime();case 4:if(s=r.sent,!a.aborted){r.next=7;break}return r.abrupt("return");case 7:t.updateRemainingTime(s),0===s&&t.unschedule(i);case 9:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();i(),this.schedule(i,1),e.once((function(){return t.unschedule(i)}))}},{key:"startSelfRefreshSchedule",value:(c=a(o().mark((function e(t){var n,i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MU.getRemainingTime();case 2:if(n=e.sent,!t.aborted){e.next=5;break}return e.abrupt("return");case 5:if(0!==n){e.next=7;break}return e.abrupt("return");case 7:i=function e(){t.aborted||r.refresh(),r.unschedule(e)},this.schedule(i,n/1e3),t.once((function(){return r.unschedule(i)}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateRemainingTime",value:function(e){if(0===e)this.updateTimeLabel("00:00:00");else{var t=lq.padStart(Math.floor(e/36e5).toString(),2,"0"),n=lq.padStart(Math.floor(e%36e5/6e4).toString(),2,"0"),i=lq.padStart(Math.floor(e%6e4/1e3).toString(),2,"0"),r="".concat(t,":").concat(n,":").concat(i);this.updateTimeLabel(r)}var a=1-e/hq;this.updateProgressBar(a)}},{key:"updateTimeLabel",value:function(e){this.timeLabel.string=e}},{key:"updateProgressBar",value:function(e){this.progressBar.progress=e}},{key:"refresh",value:(u=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.signalController.renew(),e.next=3,MU.hasClaimableRewards();case 3:if(n=e.sent,!t.aborted){e.next=6;break}return e.abrupt("return");case 6:this.animationController.setValue("claimable",n),this.setParticles(n),this.setProgressBarAndLabelVisibility(!n,t),this.startUpdateRemainingTimeSchedule(t),this.startSelfRefreshSchedule(t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"animationController",[PH,RH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VH=r(HH.prototype,"particles",[LH,IH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WH=r(HH.prototype,"timeLabel",[OH,_H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KH=r(HH.prototype,"progressBar",[DH,MH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jH=r(HH.prototype,"progressBarAndLabel",[NH,BH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(HH.prototype,"updateRemainingTime",[zH],Object.getOwnPropertyDescriptor(HH.prototype,"updateRemainingTime"),HH.prototype),r(HH.prototype,"updateTimeLabel",[FH],Object.getOwnPropertyDescriptor(HH.prototype,"updateTimeLabel"),HH.prototype),r(HH.prototype,"updateProgressBar",[UH],Object.getOwnPropertyDescriptor(HH.prototype,"updateProgressBar"),HH.prototype),GH=HH))||GH);w._RF.pop(),w._RF.push({},"83036ocqiZHXrI3Aq0dBJRD","EventButton",void 0);var yq,fq,vq,mq,gq,bq,wq,kq,Sq,Cq,Eq,xq,Aq,Tq,Pq,Rq=S.ccclass,Lq=S.property,Iq=(XH=Rq("EventButton"),QH=Lq({type:B(ZB)}),$H=Lq(W),XH((nq=r((tq=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"eventType",nq,l(e)),e._isAvailable=!1,e}return e(o,[{key:"isAvailable",get:function(){return this._isAvailable},set:function(e){this._isAvailable=e,this.fakeClick()}},{key:"handleClick",value:function(){this.node.scene.emit(Cn,{type:this.eventType})}},{key:"setAnimationState",value:function(e){this.animationController.setValue("RESET-SPECIAL",this._isAvailable),p(h(o.prototype),"setAnimationState",this).call(this,e)}}]),o}(bo)).prototype,"eventType",[QH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ZB.STAR_CHEST}}),r(tq.prototype,"isAvailable",[$H],Object.getOwnPropertyDescriptor(tq.prototype,"isAvailable"),tq.prototype),eq=tq))||eq);w._RF.pop(),w._RF.push({},"87a11fQFYVFcphsqf5ivVof","DashboardHeader",void 0);var Oq,_q,Dq,Mq,Nq,Bq,zq,Fq,Uq,Gq,Hq,qq,Vq,Wq,Kq,jq,Yq,Jq,Zq=S.ccclass,Xq=S.property,Qq=codex.player,$q=(yq=Zq("DashboardHeader"),fq=Xq({type:ZH,displayName:"Progress bar",group:"Star Chest"}),vq=Xq({type:Iq,displayName:"Button Component",group:"Star Chest"}),mq=Xq(dq),gq=Xq(A),bq=Xq(R),wq=Xq(A),yq((Cq=r((Sq=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"starProgressBar",Cq,l(e)),s(e,"chestButton",Eq,l(e)),s(e,"dailyRewardsWidget",xq,l(e)),s(e,"uiTransform",Aq,l(e)),s(e,"containerWidget",Tq,l(e)),s(e,"containerUITransform",Pq,l(e)),e}return e(o,[{key:"__preload",value:function(){O.on(gn,this.handleStarsUpdateEvent,this),O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),O.on(Ge.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"start",value:function(){this.handleOrientationChanged()}},{key:"onDestroy",value:function(){O.off(gn,this.handleStarsUpdateEvent,this),O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),O.off(Ge.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"updateDailyRewardsButton",value:function(){this.dailyRewardsWidget.refresh()}},{key:"updateStarProgress",value:function(e){this.handleStarsUpdateEvent(e)}},{key:"updateStarChestButtonAnimation",value:function(e){this.chestButton.isAvailable=e>=20}},{key:"handleStarsUpdateEvent",value:function(e){var t,n=null!=e?e:null===(t=Qq.getGameData())||void 0===t?void 0:t.stars;void 0!==n&&(this.starProgressBar.setRange(n,20),this.updateStarChestButtonAnimation(n))}},{key:"handleOrientationChanged",value:function(){Ye.isPortrait()?this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!0:Ye.isLandscape()&&(this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!1,this.containerUITransform.width=Math.min(this.uiTransform.width,1366)),this.containerWidget.getComponentsInChildren(R).forEach((function(e,t){e.updateAlignment()}))}},{key:"handleClickedSettingsButton",value:function(){nt.openScreen(it.SETTINGS_SCREEN)}}]),o}(x)).prototype,"starProgressBar",[fq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eq=r(Sq.prototype,"chestButton",[vq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xq=r(Sq.prototype,"dailyRewardsWidget",[mq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aq=r(Sq.prototype,"uiTransform",[gq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tq=r(Sq.prototype,"containerWidget",[bq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pq=r(Sq.prototype,"containerUITransform",[wq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kq=Sq))||kq);w._RF.pop(),w._RF.push({},"3b954Re2cRHvYJeBVAukYp9","JourneyLevelAvatar",void 0);var eV,tV,nV,iV,rV,aV,oV,sV,lV,uV,cV,pV,hV,dV=S.ccclass,yV=S.property,fV=S.executeInEditMode,vV=(Oq=dV("JourneyLevelAvatar"),_q=yV({type:N,displayName:"Avatar node"}),Dq=yV(H),Mq=yV(le),Nq=yV(M),Bq=yV({type:ue,group:"Animation"}),zq=yV({type:ue,group:"Animation"}),Fq=yV({type:ue,group:"Animation"}),Uq=yV({type:se,displayName:"Avatar sprite"}),Oq(Gq=fV((qq=r((Hq=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"sprite",qq,l(e)),s(e,"lockIcon",Vq,l(e)),s(e,"animation",Wq,l(e)),s(e,"opacity",Kq,l(e)),s(e,"flashAnimation",jq,l(e)),s(e,"unlockAnimation",Yq,l(e)),s(e,"spawnAnimation",Jq,l(e)),e}return e(d,[{key:"avatarSprite",get:function(){var e,t;return null!==(e=null===(t=this.sprite)||void 0===t?void 0:t.spriteFrame)&&void 0!==e?e:null},set:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"playUnlockAnimation",value:(p=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.playAnimation(this.unlockAnimation),n=this.lockIcon.position.x,i=this.lockIcon.position.y,r=[45,135],a=(Math.random()*(r[1]-r[0])+r[0])*(Math.PI/180),s=this.lockIcon.position.x+150*Math.cos(a),l=this.lockIcon.position.y+150*Math.sin(a),u=i-400,c=Ue.runTweenAsync(L(this.lockIcon).delay(.3).to(.2,{position:new q(s,l,this.lockIcon.position.z)},{easing:"sineOut"}).to(.4,{position:new q(s,u,this.lockIcon.position.z)},{easing:"cubicIn"})),p=[0,360],h=Ue.runTweenAsync(L(this.lockIcon).delay(.3).to(.6,{eulerAngles:new q(0,0,Math.random()*(p[1]-p[0])*(s>n?-1:1))},{easing:"sineOut"})),e.next=14,Promise.all([t,c,h]);case 14:this.lockIcon.position=new q(n,i,this.lockIcon.position.z),this.lockIcon.eulerAngles=new q(0,0,0);case 16:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"playFlashAnimation",value:(c=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.node.position.y,i=this.playAnimation(this.flashAnimation),r=Ue.runTweenAsync(L(this.node).to(.1,{position:new q(this.node.position.x,this.node.position.y+10,this.node.position.z)},{easing:"sineOut"}).to(.1,{position:new q(this.node.position.x,n,this.node.position.z)},{easing:"sineIn"}),t),e.next=5,Promise.all([i,r]);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"playSpawnAnimation",value:function(){this.opacity.opacity=255,this.playAnimation(this.spawnAnimation)}},{key:"hideImmediately",value:function(){this.opacity.opacity=0,this.node.setScale(q.ZERO)}},{key:"playAnimation",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runAnimationAsync(this.animation,t.name);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){var e=this;if(!this.sprite)throw new Error("JourneyLevelAvatar: Avatar node is required");if(!this.lockIcon)throw new Error("JourneyLevelAvatar: Lock icon is required");if(!this.flashAnimation)throw new Error("JourneyLevelAvatar: Flash animation is required");if(!this.unlockAnimation)throw new Error("JourneyLevelAvatar: Unlock animation is required");if(!this.animation)throw new Error("JourneyLevelAvatar: Animation component is required");if(!this.animation.clips.some((function(t){return null!==t&&(t.name===e.flashAnimation.name||t.name===e.unlockAnimation.name||t.name===e.spawnAnimation.name)})))throw new Error("JourneyLevelAvatar: Animation component does not contain required animations")}}]),d}(x)).prototype,"sprite",[_q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vq=r(Hq.prototype,"lockIcon",[Dq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wq=r(Hq.prototype,"animation",[Mq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kq=r(Hq.prototype,"opacity",[Nq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jq=r(Hq.prototype,"flashAnimation",[Bq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yq=r(Hq.prototype,"unlockAnimation",[zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jq=r(Hq.prototype,"spawnAnimation",[Fq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Hq.prototype,"avatarSprite",[Uq],Object.getOwnPropertyDescriptor(Hq.prototype,"avatarSprite"),Hq.prototype),Gq=Hq))||Gq)||Gq);w._RF.pop(),w._RF.push({},"a392bibG75JPKzG0y2ZS2YY","JourneyProgressBar",void 0);var mV,gV,bV,wV,kV,SV,CV,EV,xV,AV,TV,PV,RV,LV,IV,OV,_V,DV,MV,NV,BV,zV,FV,UV,GV,HV,qV=S.ccclass,VV=S.property,WV=S.executeInEditMode,KV=(eV=qV("JourneyProgressBar"),tV=VV(Fu),nV=VV(Y),iV=VV(M),rV=VV(T),aV=VV(T),oV=VV(C),sV=Ii.onlyRunInLifeCycle,eV(lV=WV((cV=r((uV=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"progressBar",cV,l(e)),s(e,"progressLabel",pV,l(e)),s(e,"labelUIOpacity",hV,l(e)),e.currentProgress=10,e.totalProgress=10,e.labelSeparator="/",e}return e(p,[{key:"total",get:function(){return this.totalProgress}},{key:"current",get:function(){return this.currentProgress}},{key:"separator",get:function(){return this.labelSeparator},set:function(e){this.labelSeparator=e,this.updateProgress()}},{key:"setRange",value:function(e,t){this.totalProgress=t;var n=e;n>t&&(n=t),this.currentProgress=n,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"animateTo",value:(u=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h,d,y,f,v,m,g=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nextCurr,i=t.nextTotal,r=t.numberOfProgressBar,a=void 0===r?0:r,s=t.onProgressBarPassed,l=t.signal,u=n/i,c=L(this.labelUIOpacity).to(.2,{opacity:0}),p=L(this.labelUIOpacity).to(.2,{opacity:255}),h=a<1?1:Math.sqrt(a)+1,d=0===a?u:a+u,y=1,f=this.progressBar.progress,v=d,m=Ue.runOnUpdateAsync(this.node,h,(function(e){var t=z.sineInOut(e),n=be(f,v,t);g.progressBar.progress=n%1,n>y&&(y=0===n?1:Math.ceil(n),null==s||s())}),l),e.next=12,Promise.all([Ue.runTweenAsync(c,l),m]);case 12:return this.currentProgress=n,this.totalProgress=i,this.updateProgress(),e.next=17,Ue.runTweenAsync(p,l);case 17:return this.labelUIOpacity.opacity=255,e.abrupt("return",u);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"updateProgress",value:function(){this.progressBar.progress=this.currentProgress/this.totalProgress,this.progressLabel.string="".concat(this.currentProgress).concat(this.separator).concat(this.totalProgress)}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),p}(x)).prototype,"progressBar",[tV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pV=r(uV.prototype,"progressLabel",[nV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hV=r(uV.prototype,"labelUIOpacity",[iV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(uV.prototype,"total",[rV],Object.getOwnPropertyDescriptor(uV.prototype,"total"),uV.prototype),r(uV.prototype,"current",[aV],Object.getOwnPropertyDescriptor(uV.prototype,"current"),uV.prototype),r(uV.prototype,"separator",[oV],Object.getOwnPropertyDescriptor(uV.prototype,"separator"),uV.prototype),r(uV.prototype,"updateProgress",[sV],Object.getOwnPropertyDescriptor(uV.prototype,"updateProgress"),uV.prototype),lV=uV))||lV)||lV);w._RF.pop(),w._RF.push({},"8a41bfxLylDhLk57kewW14A","JourneyProgressAnimator",void 0);var jV,YV,JV,ZV,XV,QV,$V,eW,tW,nW,iW,rW=S.ccclass,aW=S.property,oW=(mV=rW("ProgressConfiguration"),gV=aW(se),bV=aW(C),mV((SV=r((kV=e((function e(){t(this,e),s(this,"avatar",SV,this),s(this,"themeId",CV,this)}))).prototype,"avatar",[gV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CV=r(kV.prototype,"themeId",[bV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wV=kV)),EV=rW("JourneyProgressAnimator"),xV=Ii.required,AV=aW(KV),TV=Ii.required,PV=aW(H),RV=Ii.required,LV=aW(N),IV=Ii.required,OV=aW(vV),_V=aW({type:P,displayName:"Next Level Y Offset on Animation",group:"Unlocked Animation"}),DV=Ii.onlyRunInLifeCycleAsync,MV=Ii.onlyRunInLifeCycle,EV((zV=r((BV=function(r){n(v,r);var u,c,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"progressBar",zV,l(e)),s(e,"currentLevelAvatarNode",FV,l(e)),s(e,"currentLevelAvatar",UV,l(e)),s(e,"nextLevelAvatar",GV,l(e)),s(e,"nextLevelYOffset",HV,l(e)),e.isAnimating=!1,e}return e(v,[{key:"setRange",value:function(e,t){this.progressBar.setRange(e,t)}},{key:"animateTo",value:(y=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAnimating){e.next=3;break}return console.warn("JourneyProgressAnimator: animation already in progress"),e.abrupt("return",Promise.resolve());case 3:if(this.isAnimating=!0,t===this.progressBar.current){e.next=7;break}return e.next=7,this.progressBar.animateTo({nextCurr:t,nextTotal:this.progressBar.total,signal:n});case 7:this.isAnimating=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"animateToNextLevel",value:(d=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p,h=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.nextCurr,i=t.nextTotal,r=t.mapsPassed,a=t.signal,!this.isAnimating){e.next=4;break}return console.warn("JourneyProgressAnimator: animation already in progress"),e.abrupt("return");case 4:if(this.isAnimating=!0,0!=(s=r.length-2)){e.next=11;break}return e.next=9,this.progressBar.animateTo({nextCurr:n,nextTotal:i,signal:a});case 9:return this.isAnimating=!1,e.abrupt("return");case 11:return e.next=13,this.animateTargetAvaToCenter(a);case 13:return l=function(){if(1===u)return h.nextLevelAvatar.playUnlockAnimation(),void(u+=1);if(u>=r.length)throw new Error("JourneyProgressAnimator: currThemeIndex out of bounds");h.nextLevelAvatar.playFlashAnimation(a),h.setNextLevelAvatar(r[u].theme),u+=1},u=1,e.next=17,this.progressBar.animateTo({signal:a,nextCurr:n,nextTotal:i,numberOfProgressBar:s,onProgressBarPassed:l});case 17:return e.next=19,this.animateTargetAvaToPrev(a);case 19:return c=r[r.length-1].theme,p=r[r.length-2].theme,this.setCurrentLevelAvatar(p),this.nextLevelAvatar.hideImmediately(),this.moveTargetAvaToOriginal(),e.next=26,this.getSpriteFrameByThemeId(c);case 26:this.nextLevelAvatar.avatarSprite=e.sent,this.nextLevelAvatar.playSpawnAnimation(),this.isAnimating=!1;case 29:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"animateTargetAvaToCenter",value:(h=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new q(0,this.nextLevelYOffset+this.nextLevelAvatar.node.position.y,this.nextLevelAvatar.node.position.z),e.next=3,Ue.runTweenAsync(L(this.nextLevelAvatar.node).to(1,{position:n},{easing:"cubicInOut"}),t);case 3:this.nextLevelAvatar.node.position=n;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"moveTargetAvaToOriginal",value:function(){this.nextLevelAvatar.node.position=this.originalNextLevelAvatarPosition.clone()}},{key:"animateTargetAvaToPrev",value:(p=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentLevelAvatarNode.position.clone(),e.next=3,Ue.runTweenAsync(L(this.nextLevelAvatar.node).to(1,{position:n},{easing:"cubicInOut"}),t);case 3:this.nextLevelAvatar.node.position=n;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getSpriteFrameByThemeId",value:(c=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Fe.loadThemeThumbnailAsync(t),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"loadAndSetAvatar",value:(u=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSpriteFrameByThemeId(t);case 2:if(i=e.sent){e.next=6;break}return console.warn("JourneyProgressAnimator: ".concat(t," is null")),e.abrupt("return");case 6:this.setAvatar(i,n);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"setAvatar",value:function(e,t){t instanceof vV?t.avatarSprite=e:t.spriteFrame=e}},{key:"setCurrentLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.currentLevelAvatar)}},{key:"setNextLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.nextLevelAvatar)}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this,v),this.originalNextLevelAvatarPosition=this.nextLevelAvatar.node.position.clone()}}]),v}(x)).prototype,"progressBar",[xV,AV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FV=r(BV.prototype,"currentLevelAvatarNode",[TV,PV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UV=r(BV.prototype,"currentLevelAvatar",[RV,LV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GV=r(BV.prototype,"nextLevelAvatar",[IV,OV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HV=r(BV.prototype,"nextLevelYOffset",[_V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r(BV.prototype,"loadAndSetAvatar",[DV],Object.getOwnPropertyDescriptor(BV.prototype,"loadAndSetAvatar"),BV.prototype),r(BV.prototype,"setAvatar",[MV],Object.getOwnPropertyDescriptor(BV.prototype,"setAvatar"),BV.prototype),NV=BV))||NV);w._RF.pop(),w._RF.push({},"4b935BmCjhBf73yEp1PitwH","LandscapeMask",void 0);var sW,lW,uW,cW,pW,hW,dW,yW,fW,vW,mW,gW,bW,wW=S.ccclass,kW=S.property,SW=(jV=wW("LandscapeMask"),YV=kW(Ao),JV=kW(A),ZV=kW(A),XV=kW(A),jV((eW=r(($V=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"opacityToggler",eW,l(e)),s(e,"uiTransform",tW,l(e)),s(e,"leftMask",nW,l(e)),s(e,"rightMask",iW,l(e)),e}return e(o,[{key:"__preload",value:function(){O.on(Ge.VIEW_RESIZED,this.onViewResized,this)}},{key:"onDestroy",value:function(){O.off(Ge.VIEW_RESIZED,this.onViewResized,this)}},{key:"onViewResized",value:function(){this.updateMaskPosition()}},{key:"updateMaskPosition",value:function(){var e=this.uiTransform.contentSize,t=e.width,n=e.height;this.leftMask.width=this.rightMask.width=2*n;var i=this.leftMask.height>.3*t?this.leftMask.height-.3*t:0;this.leftMask.node.setWorldPosition(-i,this.leftMask.node.worldPosition.y,0),this.rightMask.node.setWorldPosition(t+i,this.rightMask.node.worldPosition.y,0)}},{key:"show",value:function(){this.opacityToggler.changeStateFade(!0,.2)}},{key:"hide",value:function(){this.opacityToggler.changeStateFade(!1,.1)}}]),o}(x)).prototype,"opacityToggler",[YV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tW=r($V.prototype,"uiTransform",[JV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nW=r($V.prototype,"leftMask",[ZV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iW=r($V.prototype,"rightMask",[XV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QV=$V))||QV);w._RF.pop(),w._RF.push({},"ee748sgCHxCTaIJcL1SUIFl","CustomButton",void 0);var CW,EW,xW,AW,TW,PW,RW,LW,IW,OW,_W,DW,MW,NW,BW=S.ccclass,zW=S.property,FW=(sW=BW("CustomButton"),lW=zW(N),uW=zW(se),cW=zW(se),pW=zW(U),hW=zW(H),sW((fW=r((yW=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"sprite",fW,l(e)),s(e,"lockedSprite",vW,l(e)),s(e,"unlockedSprite",mW,l(e)),s(e,"button",gW,l(e)),s(e,"unlockContainer",bW,l(e)),e}return e(p,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e>=13;this.button.interactable=t,this.unlockContainer.active=!t,this.sprite.spriteFrame=t?this.unlockedSprite:this.lockedSprite}},{key:"handleOnClicked",value:(u=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.openScreenAndWaitForClose(it.CUSTOM_GAME_SCREEN);case 2:n=e.sent,(null!==(t=n.screenData)&&void 0!==t?t:{}).customMode&&this.node.scene.emit(wn);case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(x)).prototype,"sprite",[lW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vW=r(yW.prototype,"lockedSprite",[uW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mW=r(yW.prototype,"unlockedSprite",[cW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gW=r(yW.prototype,"button",[pW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bW=r(yW.prototype,"unlockContainer",[hW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dW=yW))||dW);w._RF.pop(),w._RF.push({},"a479fLcnJ9AtqhT/3Hs2xco","CustomGuideUI",void 0);var UW,GW,HW,qW,VW,WW,KW,jW,YW,JW,ZW,XW,QW,$W,eK,tK=S.ccclass,nK=S.property,iK=(CW=tK("CustomGuideUI"),EW=Ii.required(),xW=nK(FW),AW=Ii.required(),TW=nK(xR),PW=Ii.required(),RW=nK(Y),LW=Ii.onlyRunInLifeCycleAsync,IW=Ii.onlyRunInLifeCycleAsync,CW((DW=r((_W=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"customButton",DW,l(e)),s(e,"guideMasks",MW,l(e)),s(e,"guideInfoText",NW,l(e)),e.guideShown=!1,e}return e(p,[{key:"update",value:function(){if(this.guideShown){var e=this.customButton.node.worldPosition;this.guideInfoText.node.worldPosition=new q(e.x-100,e.y,0),this.guideMasks.setOtherMaskTransform(e.x,e.y,150,150)}}},{key:"startGuide",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.guideShown=!0,this.guideInfoText.node.active=!0,e.next=4,this.guideMasks.show();case 4:return e.next=6,Promise.race([this.waitForClick(),Ue.waitTweenAsync(3)]);case 6:return e.next=8,null===(t=this.guideMasks)||void 0===t?void 0:t.hide();case 8:this.guideInfoText.node.active=!1,this.guideShown=!1;case 10:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"waitForClick",value:function(){var e=this;return new Promise((function(t){e.node.scene.once(Us.GUIDE_MASK_CLICKED,(function(){t()}))}))}}]),p}(x)).prototype,"customButton",[EW,xW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MW=r(_W.prototype,"guideMasks",[AW,TW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NW=r(_W.prototype,"guideInfoText",[PW,RW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(_W.prototype,"startGuide",[LW],Object.getOwnPropertyDescriptor(_W.prototype,"startGuide"),_W.prototype),r(_W.prototype,"waitForClick",[IW],Object.getOwnPropertyDescriptor(_W.prototype,"waitForClick"),_W.prototype),OW=_W))||OW);w._RF.pop(),w._RF.push({},"21121NZ8PtCJJpkj1j2/qOg","PlayButton",void 0);var rK,aK,oK,sK,lK,uK,cK,pK,hK,dK,yK,fK,vK,mK,gK,bK,wK,kK,SK,CK,EK,xK,AK,TK,PK,RK,LK,IK,OK,_K,DK,MK,NK,BK,zK,FK,UK,GK,HK,qK,VK,WK=S.ccclass,KK=S.property,jK=(UW=WK("PlayButton"),GW=Ii.required(),HW=KK(cp),qW=Ii.required(),VW=KK(H),WW=Ii.required(),KW=KK(H),jW=Ii.required(),YW=KK(U),UW((XW=r((ZW=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"localizer",XW,l(e)),s(e,"defaultBackground",QW,l(e)),s(e,"hardLevelBackground",$W,l(e)),s(e,"button",eK,l(e)),e}return e(o,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e%5==0;this.localizer.setParams([e.toString()]),this.defaultBackground.active=!t,this.hardLevelBackground.active=t}},{key:"handleOnClicked",value:function(){this.node.scene.emit(bn)}}]),o}(x)).prototype,"localizer",[GW,HW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QW=r(ZW.prototype,"defaultBackground",[qW,VW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$W=r(ZW.prototype,"hardLevelBackground",[WW,KW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eK=r(ZW.prototype,"button",[jW,YW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JW=ZW))||JW);w._RF.pop(),w._RF.push({},"c2ddaEnKBVFvrM5x5nbfT7h","HomeContent",void 0);var YK,JK,ZK,XK,QK,$K,ej,tj,nj,ij,rj,aj,oj,sj,lj,uj,cj,pj,hj,dj,yj,fj,vj,mj,gj,bj,wj,kj,Sj,Cj,Ej,xj,Aj=S.ccclass,Tj=S.property,Pj=codex,Rj=Pj.storage,Lj=Pj.monitorError,Ij=Pj.player,Oj=Ludex.Utils,_j=Oj.Array,Dj=Oj.Json,Mj=(rK=Aj("HomeContent"),aK=Ii.required(),oK=Tj({type:jK,group:"Play Button"}),sK=Ii.required(),lK=Tj({type:FW,group:"Play Button"}),uK=Ii.required(),cK=Tj(Ao),pK=Ii.required(),hK=Tj(oW),dK=Ii.required(),yK=Tj($q),fK=Ii.required(),vK=Tj(M),mK=Ii.required(),gK=Tj(YM),bK=Ii.required(),wK=Tj(H),kK=Ii.required(),SK=Tj(SW),CK=Ii.required(),EK=Tj(iK),xK=Ii.onlyRunInLifeCycleAsync,AK=Ii.onlyRunInLifeCycleAsync,TK=Ii.onlyRunInLifeCycleAsync,PK=Ii.onlyRunInLifeCycleAsync,RK=Ii.onlyRunInLifeCycleAsync,LK=Ii.onlyRunInLifeCycle,IK=Ii.onlyRunInLifeCycle,OK=Ii.onlyRunInLifeCycleAsync,rK((MK=r((DK=function(r){n(v,r);var c,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"playButton",MK,l(e)),s(e,"customButton",NK,l(e)),s(e,"contentOpacity",BK,l(e)),s(e,"journeyProgressAnimator",zK,l(e)),s(e,"dashboardHeader",FK,l(e)),s(e,"overlayDuringAnim",UK,l(e)),s(e,"coinContainer",GK,l(e)),s(e,"leavesContainer",HK,l(e)),s(e,"landscapeMask",qK,l(e)),s(e,"customGuideUI",VK,l(e)),e}return e(v,[{key:"onLoad",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(),Ii.validateRequiredProperties(this)}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"listenEvents",value:function(){this.node.scene.on(Us.HIDE_UI,this.hideContent,this),this.node.scene.on(Us.SHOW_UI,this.showContent,this)}},{key:"unlistenEvents",value:function(){this.node.scene.off(Us.HIDE_UI,this.hideContent,this),this.node.scene.off(Us.SHOW_UI,this.showContent,this)}},{key:"getCoinContainer",value:function(){return this.coinContainer}},{key:"updateStatus",value:function(){var e,t=null!==(e=Ij.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?1:n,r=t.stars,a=void 0===r?0:r;this.playButton.updateStatus(i),this.customButton.updateStatus(i),this.dashboardHeader.updateStarProgress(a),this.dashboardHeader.updateDailyRewardsButton()}},{key:"updateDailyRewardsButton",value:function(){this.dashboardHeader.updateDailyRewardsButton()}},{key:"setUnlockProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setProgress(e),this.updateCurrentMapInStorage(e,t)}},{key:"shouldPlayUnlockAnimation",value:function(){var e,t,n=Rj.getStorage("dashboard");if(null==n)return null==Lj||Lj.sendException(new Error("DashboardScene: dashboardStorage not found")),!1;if(!(null!==(e=n.animateToCurrentLevel)&&void 0!==e&&e))return!1;var i=Rj.getStorage("tournament");if(null==i)return null==Lj||Lj.sendException(new Error("DashboardScene: tournamentStorage not found")),!1;if(null!==(t=i.animateTournamentLeader)&&void 0!==t&&t)return!1;var r=n.lastMapPayload,a=$d.getCurrentMapProgress();return Dj.encode(r)!==Dj.encode(a)&&!(_j.searchIndex(jd.mapOrder,(function(e){return e.id===r.id}))>_j.searchIndex(jd.mapOrder,(function(e){return e.id===a.id})))}},{key:"playUnlockProgressAnimation",value:function(e){var t=Rj.getStorage("dashboard");if(null==t)throw new Error("DashboardScene: dashboardStorage not found");var n=t.lastMapPayload,i=$d.getCurrentMapProgress(),r=_j.searchIndex(jd.mapOrder,(function(e){return e.id===n.id})),a=_j.searchIndex(jd.mapOrder,(function(e){return e.id===i.id})),o=jd.mapOrder.slice(r,a+2);return n.id===i.id?this.playUnlockProgressAnimationOnly(i,n,e):this.playUnlockProgressAndPackAnimation(n,i,o,e)}},{key:"playUnlockProgressAndPackAnimation",value:(y=a(o().mark((function e(t,n,i,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setProgress(u({},t)),this.updateCurrentMapInStorage(u({},n),!0),this.playButton.interactable=!1,e.next=5,this.showOwnOverlay(r);case 5:return e.next=7,this.journeyProgressAnimator.animateToNextLevel({nextCurr:n.progress,nextTotal:n.max,mapsPassed:i,signal:r});case 7:return e.next=9,this.hideOwnOverlay(r);case 9:this.playButton.interactable=!0;case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return y.apply(this,arguments)})},{key:"playUnlockProgressAnimationOnly",value:(d=a(o().mark((function e(t,n,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setProgress(u(u({},t),{},{progress:n.progress})),this.updateCurrentMapInStorage(u({},t),!0),r=t.progress,e.next=5,this.showOwnOverlay(i);case 5:return e.next=7,this.journeyProgressAnimator.animateTo(r,i);case 7:return e.next=9,this.hideOwnOverlay(i);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"hideOwnOverlay",value:(h=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.overlayDuringAnim).to(.3,{opacity:0}),t);case 2:if(this.node.activeInHierarchy){e.next=4;break}return e.abrupt("return");case 4:this.overlayDuringAnim.opacity=0;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"showOwnOverlay",value:(p=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.overlayDuringAnim).to(.3,{opacity:150}),t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setProgress",value:function(e){var t=e.currentTheme,n=e.nextTheme,i=e.progress,r=e.max;this.journeyProgressAnimator.setCurrentLevelAvatar(t),this.journeyProgressAnimator.setNextLevelAvatar(null!=n?n:t),this.journeyProgressAnimator.setRange(i,r)}},{key:"updateCurrentMapInStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rj.getStorage("dashboard");if(null!=n){var i=n.animateToCurrentLevel;Rj.setStorageData("dashboard","animateToCurrentLevel",!t&&i),Rj.setStorageData("dashboard","lastMapPayload",e)}else null==Lj||Lj.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"handleOrientationChanged",value:function(){this.leavesContainer.active=Ye.isLandscape(),this.landscapeMask.node.active=Ye.isLandscape()}},{key:"transitionIn",value:function(){this.listenEvents(),this.landscapeMask.node.active&&(this.landscapeMask.updateMaskPosition(),this.landscapeMask.show())}},{key:"transitionOut",value:function(){this.unlistenEvents(),this.landscapeMask.node.active&&this.landscapeMask.hide()}},{key:"hideContent",value:function(){this.contentOpacity.changeStateFade(!1,.5)}},{key:"showContent",value:function(){this.contentOpacity.changeStateFade(!0,.1)}},{key:"showCustomGuide",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.customGuideUI.startGuide();case 2:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})}]),v}(x)).prototype,"playButton",[aK,oK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NK=r(DK.prototype,"customButton",[sK,lK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BK=r(DK.prototype,"contentOpacity",[uK,cK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zK=r(DK.prototype,"journeyProgressAnimator",[pK,hK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FK=r(DK.prototype,"dashboardHeader",[dK,yK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UK=r(DK.prototype,"overlayDuringAnim",[fK,vK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GK=r(DK.prototype,"coinContainer",[mK,gK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HK=r(DK.prototype,"leavesContainer",[bK,wK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qK=r(DK.prototype,"landscapeMask",[kK,SK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VK=r(DK.prototype,"customGuideUI",[CK,EK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(DK.prototype,"playUnlockProgressAnimation",[xK],Object.getOwnPropertyDescriptor(DK.prototype,"playUnlockProgressAnimation"),DK.prototype),r(DK.prototype,"playUnlockProgressAndPackAnimation",[AK],Object.getOwnPropertyDescriptor(DK.prototype,"playUnlockProgressAndPackAnimation"),DK.prototype),r(DK.prototype,"playUnlockProgressAnimationOnly",[TK],Object.getOwnPropertyDescriptor(DK.prototype,"playUnlockProgressAnimationOnly"),DK.prototype),r(DK.prototype,"hideOwnOverlay",[PK],Object.getOwnPropertyDescriptor(DK.prototype,"hideOwnOverlay"),DK.prototype),r(DK.prototype,"showOwnOverlay",[RK],Object.getOwnPropertyDescriptor(DK.prototype,"showOwnOverlay"),DK.prototype),r(DK.prototype,"hideContent",[LK],Object.getOwnPropertyDescriptor(DK.prototype,"hideContent"),DK.prototype),r(DK.prototype,"showContent",[IK],Object.getOwnPropertyDescriptor(DK.prototype,"showContent"),DK.prototype),r(DK.prototype,"showCustomGuide",[OK],Object.getOwnPropertyDescriptor(DK.prototype,"showCustomGuide"),DK.prototype),_K=DK))||_K);w._RF.pop(),w._RF.push({},"ba822axo49BibgkqkEhhqVp","DashboardPage",void 0);var Nj,Bj,zj,Fj,Uj,Gj,Hj,qj,Vj,Wj=S.ccclass,Kj=S.property,jj=S.disallowMultiple,Yj=S.requireComponent,Jj=(YK=Wj("DashboardPage"),JK=Yj(R),ZK=Yj(M),XK=Ii.required(),QK=Kj({type:H,displayName:"Page's container"}),$K=Ii.required(),ej=Ii.required(),tj=Kj({type:H,displayName:"Placeholder"}),nj=Ii.required(),ij=Kj({displayName:"Don't create prefab",tooltip:"Tell the component to not create the prefab even if it hasn't create yet"}),rj=Kj({displayName:"Darken background"}),aj=Kj({type:T,min:0,max:255,displayName:"Background opacity",visible:function(){return this.darkenBackground}}),oj=Kj({displayName:"Use navbar shadow"}),sj=Kj({type:T,min:0,max:255,displayName:"Navbar shadow opacity",visible:function(){return this.useNavbarShadow}}),lj=Ii.required(),uj=Ii.required(),cj=Ii.onlyRunInLifeCycleAsync,pj=Ii.onlyRunInLifeCycle,hj=Ii.onlyRunInLifeCycleAsync,YK(dj=jj(dj=JK(dj=ZK((fj=r((yj=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"container",fj,l(e)),s(e,"containerUIOpacity",vj,l(e)),s(e,"placeholder",mj,l(e)),s(e,"placeholderUIOpacity",gj,l(e)),s(e,"hasCreated",bj,l(e)),e.pagePrefab=null,s(e,"darkenBackground",wj,l(e)),s(e,"backgroundOpacity",kj,l(e)),s(e,"useNavbarShadow",Sj,l(e)),s(e,"navbarShadowOpacity",Cj,l(e)),s(e,"uiOpacity",Ej,l(e)),s(e,"widgetComponent",xj,l(e)),e}return e(h,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(M),this.widgetComponent=this.getComponent(R),this.containerUIOpacity=this.container.getComponent(M),this.placeholderUIOpacity=this.placeholder.getComponent(M),Ii.validateRequiredProperties(this)}},{key:"start",value:function(){this.container.active=!0,this.placeholder.active=!0}},{key:"getWidget",value:function(){return this.widgetComponent}},{key:"show",value:function(){this.uiOpacity.opacity=255}},{key:"hide",value:function(){this.uiOpacity.opacity=0}},{key:"mount",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasCreated){e.next=3;break}return e.next=3,this.create();case 3:this.mountInLifeCycle();case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"mountInLifeCycle",value:function(){this.placeholderUIOpacity.opacity=0,this.containerUIOpacity.opacity=255,We.trackCurrentPage(this.node.name,!0)}},{key:"unmount",value:function(){255===this.placeholderUIOpacity.opacity&&0===this.containerUIOpacity.opacity||(this.placeholderUIOpacity.opacity=255,this.containerUIOpacity.opacity=0)}},{key:"transitionIn",value:function(){return Promise.resolve()}},{key:"transitionOut",value:function(){return Promise.resolve()}},{key:"hasLoadedPage",value:function(){return!0}},{key:"getContainer",value:function(){return this.container}},{key:"getDarkenBackground",value:function(){return this.darkenBackground?this.backgroundOpacity:0}},{key:"getNavbarShadow",value:function(){return this.useNavbarShadow?this.navbarShadowOpacity:0}},{key:"create",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pagePrefab&&!this.hasCreated){e.next=2;break}return e.abrupt("return");case 2:return t=he(this.pagePrefab),this.container.addChild(t),e.next=6,Ue.waitTweenAsync(0);case 6:this.hasCreated=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"container",[XK,QK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vj=r(yj.prototype,"containerUIOpacity",[$K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mj=r(yj.prototype,"placeholder",[ej,tj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gj=r(yj.prototype,"placeholderUIOpacity",[nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bj=r(yj.prototype,"hasCreated",[ij],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wj=r(yj.prototype,"darkenBackground",[rj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kj=r(yj.prototype,"backgroundOpacity",[aj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),Sj=r(yj.prototype,"useNavbarShadow",[oj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cj=r(yj.prototype,"navbarShadowOpacity",[sj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),Ej=r(yj.prototype,"uiOpacity",[lj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xj=r(yj.prototype,"widgetComponent",[uj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(yj.prototype,"mount",[cj],Object.getOwnPropertyDescriptor(yj.prototype,"mount"),yj.prototype),r(yj.prototype,"mountInLifeCycle",[pj],Object.getOwnPropertyDescriptor(yj.prototype,"mountInLifeCycle"),yj.prototype),r(yj.prototype,"create",[hj],Object.getOwnPropertyDescriptor(yj.prototype,"create"),yj.prototype),dj=yj))||dj)||dj)||dj)||dj);w._RF.pop(),w._RF.push({},"dab8cbliOBAeZ7iVs959mBm","CollectionsPage",void 0);var Zj,Xj,Qj,$j,eY,tY,nY,iY,rY,aY,oY,sY,lY,uY,cY,pY,hY,dY,yY,fY,vY,mY,gY,bY,wY,kY,SY,CY,EY,xY,AY,TY,PY,RY,LY,IY,OY,_Y,DY,MY=(Nj=(0,S.ccclass)("CollectionsPage"),Bj=Ii.required(),zj=Ii.onlyRunInLifeCycleAsync,Fj=Ii.onlyRunInLifeCycle,Uj=Ii.onlyRunInLifeCycleAsync,Gj=Ii.onlyRunInLifeCycleAsync,Nj((Vj=r((qj=function(r){n(v,r);var u,c,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=f.call.apply(f,[this].concat(i))).payload=null,s(e,"panelAnimationController",Vj,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(al),p(h(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(h(v.prototype),"start",this).call(this);case 1:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"setPayload",value:function(e){this.payload=e}},{key:"mount",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"mount",this).call(this);case 2:this.onMount();case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,!this.themeContent&&(this.themeContent=this.container.getComponentInChildren(AH),!this.themeContent))throw new Error("No theme content found");var e=$d.getCollectionUnlockProgress();this.themeContent.updateUnlockedProgress(e),this.payload&&this.themeContent.init(this.payload)}},{key:"transitionIn",value:(c=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"transitionIn",this).call(this);case 2:return this.themeContent.restoreScrollPosition(),this.themeContent.listenEvents(),t=Ue.runTweenAsync(L(this.containerUIOpacity).to(.2,{opacity:255})),n=this.panelAnimationController.showUI(),e.next=8,Promise.all([t,n]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"transitionOut",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"transitionOut",this).call(this);case 2:return this.themeContent.preserveScrollPosition(),this.themeContent.unlistenUIEvents(),e.next=6,this.panelAnimationController.hideUI();case 6:this.themeContent.unlistenEvents();case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),v}(Jj)).prototype,"panelAnimationController",[Bj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(qj.prototype,"mount",[zj],Object.getOwnPropertyDescriptor(qj.prototype,"mount"),qj.prototype),r(qj.prototype,"onMount",[Fj],Object.getOwnPropertyDescriptor(qj.prototype,"onMount"),qj.prototype),r(qj.prototype,"transitionIn",[Uj],Object.getOwnPropertyDescriptor(qj.prototype,"transitionIn"),qj.prototype),r(qj.prototype,"transitionOut",[Gj],Object.getOwnPropertyDescriptor(qj.prototype,"transitionOut"),qj.prototype),Hj=qj))||Hj);w._RF.pop(),w._RF.push({},"2381b1mKt1PUq5W+fsaaOYP","PageManager",void 0);var NY,BY,zY,FY,UY,GY,HY,qY,VY,WY,KY,jY,YY,JY,ZY,XY,QY,$Y=S.ccclass,eJ=S.property,tJ=S.disallowMultiple,nJ=S.requireComponent,iJ=Ludex.Utils.Array,rJ=(Zj=$Y("PageManagerItem"),Xj=eJ(Jj),Qj=eJ({type:B(En)}),Zj((tY=r((eY=e((function e(){t(this,e),s(this,"page",tY,this),s(this,"pageType",nY,this)}))).prototype,"page",[Xj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nY=r(eY.prototype,"pageType",[Qj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$j=eY))||$j),aJ=(iY=$Y("PageManager"),rY=nJ(A),aY=Ii.required(),oY=eJ({type:M,displayName:"Background Mask",group:"Background Mask"}),sY=eJ({type:P,displayName:"Transition duration",group:"Background Mask"}),lY=eJ({type:P,displayName:"Transition delay",group:"Background Mask"}),uY=Ii.required(),cY=eJ({type:M,displayName:"Nav Bar Shadow",group:"Nav Bar Shadow"}),pY=eJ({type:P,displayName:"Transition duration",group:"Nav Bar Shadow"}),hY=eJ({type:P,displayName:"Transition delay",group:"Nav Bar Shadow"}),dY=eJ({type:[rJ]}),yY=eJ({type:B(En)}),fY=Ii.required(),vY=Ii.onlyRunInLifeCycleAsync,mY=Ii.onlyRunInLifeCycleAsync,gY=Ii.onlyRunInLifeCycle,bY=Ii.onlyRunInLifeCycle,wY=Ii.onlyRunInLifeCycle,kY=Ii.onlyRunInLifeCycleAsync,SY=Ii.onlyRunInLifeCycleAsync,CY=Ii.onlyRunInLifeCycleAsync,iY(EY=tJ(EY=rY((AY=r((xY=function(r){n(w,r);var u,p,h,d,y,f,v,m,g,b=i(w);function w(){var e;t(this,w);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=b.call.apply(b,[this].concat(i)),s(e,"backgroundMask",AY,l(e)),s(e,"backgroundMaskTransitionDuration",TY,l(e)),s(e,"backgroundMaskTransitionDelay",PY,l(e)),s(e,"navBarShadow",RY,l(e)),s(e,"navBarShadowTransitionDuration",LY,l(e)),s(e,"navBarShadowTransitionDelay",IY,l(e)),s(e,"pageItems",OY,l(e)),s(e,"currentScreen",_Y,l(e)),s(e,"uiTransform",DY,l(e)),e}return e(w,[{key:"unmountAndHideAll",value:function(){var e=this;this.pageItems.forEach((function(t){var n=t.page;t.pageType!==e.currentScreen&&(n.unmount(),n.hide())}))}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(A),Ii.validateRequiredProperties(this),O.on(Ge.VIEW_RESIZED,this.init,this)}},{key:"onDestroy",value:function(){O.off(Ge.VIEW_RESIZED,this.init,this)}},{key:"init",value:function(){var e=this;this.pageItems.forEach((function(t,n){var i=t.page.getWidget(),r=e.getPageIndex(e.currentScreen);i.right=-(n-r)*e.uiTransform.width,i.left=(n-r)*e.uiTransform.width,i.updateAlignment()}))}},{key:"updateCollectionsContentPayload",value:function(e){var t=this.getPage(En.collections);t&&t instanceof MY&&t.setPayload(e)}},{key:"navigate",value:(g=a(o().mark((function e(t,n,i,r){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.from,s=t.to,null!==a){e.next=5;break}return e.next=4,this.navigateFromNull(s,i,r);case 4:return e.abrupt("return");case 5:return e.next=7,this.navigateFromPage(a,s,n,i,r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return g.apply(this,arguments)})},{key:"navigateFromPage",value:(m=a(o().mark((function e(t,n,i,r,a){var s,l,u,c,p,h,d,y,f,v,m,g,b,w,k=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.validateNavigationRequest(t,n),l=s.toPage,u=s.fromPage,this.currentScreen=n,c=this.uiTransform.width,p=this.getPageIndex(t),h=this.getPageIndex(n),d=Math.min(p,h),y=Math.max(p,h),f=(y-d)*c,v=p<h?1:-1,(m=this.pageItems.slice(d,y+1)).forEach((function(e,t){var n=e.page;n.show(),n.getWidget().enabled=!1,n.node.position=new q((t+d-p)*c,n.node.position.y,n.node.position.z)})),(g=!l.hasLoadedPage())&&this.showLoadingScreen(),b=this.pageItems.filter((function(e){return e.pageType!==n})),w=function(){return k.cleanupPages(l,b)},i.addAbortListener(w),e.next=18,this.mountPage(l,r);case 18:return e.next=20,i.callAsync((function(){return k.performFullTransition({from:t,to:n,fromPage:u,toPage:l,distance:f,direction:v,items:m})}));case 20:return i.removeAbortListener(w),i.call(w),e.next=24,i.callAsync((function(){return k.transitionInPage(l,a)}));case 24:g&&this.hideLoadingScreen();case 25:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r){return m.apply(this,arguments)})},{key:"hideLoadingScreen",value:function(){nt.closeLoadingScreen()}},{key:"showLoadingScreen",value:function(){nt.showLoadingScreen()}},{key:"cleanupPages",value:function(e,t){var n=e.getWidget();n.enabled=!0,n.left=0,n.right=0,ee.instance.emit("canvas-resize");var i,r=c(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.page.unmount(),a.page.hide()}}catch(e){r.e(e)}finally{r.f()}}},{key:"performFullTransition",value:(v=a(o().mark((function e(t){var n,i,r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,i=t.to,r=t.fromPage,a=t.distance,s=t.direction,l=t.items,u=t.toPage,this.node.scene.emit(Sn,{from:n,to:i}),e.next=4,Promise.all([r.transitionOut(),this.transition(a,s,l),this.handleBackgroundMask(this.backgroundMaskTransitionDuration,u.getDarkenBackground()),this.handleNavBarShadow(this.navBarShadowTransitionDuration,u.getNavbarShadow())]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"mountPage",value:(f=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.mount();case 2:return e.next=4,null==n?void 0:n(t);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)})},{key:"validateNavigationRequest",value:function(e,t){if(e!==this.currentScreen)throw new Error("PageManager: Cannot navigate from a different screen. Perhaps you forgot to update the currentScreen property.");var n=this.getPage(this.currentScreen),i=this.getPage(t);if(!i||!n)throw new Error("PageManager: Cannot navigate to/from a null page. Perhaps you forgot to add the page to the pageItems array in the editor.");return{toPage:i,fromPage:n}}},{key:"navigateFromNull",value:(y=a(o().mark((function e(t,n,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.getPage(this.currentScreen)).show(),this.currentScreen=t,e.next=5,this.mountPage(a,n);case 5:if(null!==(r=this.node)&&void 0!==r&&r.scene){e.next=7;break}return e.abrupt("return");case 7:return this.node.scene.emit(Sn,{from:null,to:t}),e.next=10,this.transitionInPage(a,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"transitionInPage",value:(d=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.transitionIn();case 2:return e.next=4,null==n?void 0:n(t);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"getPage",value:function(e){var t,n,i=this.getPageIndex(e);return-1!==i&&null!==(t=null===(n=this.pageItems[i])||void 0===n?void 0:n.page)&&void 0!==t?t:null}},{key:"handleBackgroundMask",value:(h=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.backgroundMask).delay(this.backgroundMaskTransitionDelay).to(t,{opacity:n}).start());case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"handleNavBarShadow",value:(p=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.navBarShadow).delay(this.navBarShadowTransitionDelay).to(t,{opacity:n}).start());case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"getPageIndex",value:function(e){return iJ.searchIndex(this.pageItems,(function(t){return t.pageType===e}))}},{key:"transition",value:(u=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(i.map((function(e){var i=e.page;return Ue.runTweenAsync(L(i.node).to(.5,{position:new q(i.node.position.x-t*n,i.node.position.y,i.node.position.z)},{easing:z.quintInOut}))})));case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}]),w}(x)).prototype,"backgroundMask",[aY,oY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TY=r(xY.prototype,"backgroundMaskTransitionDuration",[sY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),PY=r(xY.prototype,"backgroundMaskTransitionDelay",[lY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),RY=r(xY.prototype,"navBarShadow",[uY,cY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LY=r(xY.prototype,"navBarShadowTransitionDuration",[pY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),IY=r(xY.prototype,"navBarShadowTransitionDelay",[hY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),OY=r(xY.prototype,"pageItems",[dY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_Y=r(xY.prototype,"currentScreen",[yY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return En.home}}),DY=r(xY.prototype,"uiTransform",[fY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(xY.prototype,"navigate",[vY],Object.getOwnPropertyDescriptor(xY.prototype,"navigate"),xY.prototype),r(xY.prototype,"navigateFromPage",[mY],Object.getOwnPropertyDescriptor(xY.prototype,"navigateFromPage"),xY.prototype),r(xY.prototype,"hideLoadingScreen",[gY],Object.getOwnPropertyDescriptor(xY.prototype,"hideLoadingScreen"),xY.prototype),r(xY.prototype,"showLoadingScreen",[bY],Object.getOwnPropertyDescriptor(xY.prototype,"showLoadingScreen"),xY.prototype),r(xY.prototype,"cleanupPages",[wY],Object.getOwnPropertyDescriptor(xY.prototype,"cleanupPages"),xY.prototype),r(xY.prototype,"performFullTransition",[kY],Object.getOwnPropertyDescriptor(xY.prototype,"performFullTransition"),xY.prototype),r(xY.prototype,"mountPage",[SY],Object.getOwnPropertyDescriptor(xY.prototype,"mountPage"),xY.prototype),r(xY.prototype,"navigateFromNull",[CY],Object.getOwnPropertyDescriptor(xY.prototype,"navigateFromNull"),xY.prototype),EY=xY))||EY)||EY)||EY);w._RF.pop(),w._RF.push({},"f555belwQ1NHJr4np65OtcU","NavManager",void 0);var oJ,sJ,lJ,uJ,cJ,pJ,hJ,dJ,yJ,fJ,vJ,mJ,gJ,bJ,wJ,kJ,SJ,CJ,EJ,xJ,AJ,TJ,PJ,RJ,LJ,IJ,OJ,_J,DJ,MJ,NJ,BJ,zJ,FJ,UJ,GJ,HJ,qJ,VJ,WJ,KJ,jJ,YJ=S.ccclass,JJ=S.property,ZJ=Ludex.Utils,XJ=ZJ.Array,QJ=ZJ.Signal,$J=qe.Layout,eZ=(NY=YJ("NavManager"),BY=JJ(H),zY=JJ(H),FY=JJ(mn),UY=JJ({type:R,group:"Widgets"}),GY=JJ({type:R,group:"Widgets"}),HY=JJ({type:R,group:"Widgets"}),qY=JJ(A),NY((KY=r((WY=function(r){n(v,r);var u,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"selectorNode",KY,l(e)),s(e,"selectedButtonNode",jY,l(e)),s(e,"autoLayout",YY,l(e)),s(e,"navWidget",JY,l(e)),s(e,"backgroundWidget",ZY,l(e)),s(e,"layoutWidget",XY,l(e)),s(e,"uiTransform",QY,l(e)),e.navButtons=[],e.selectorAnimationSignal=new QJ.SignalController,e.isNavigating=!1,e}return e(v,[{key:"currentButton",get:function(){return this.selectedButton}},{key:"onLoad",value:function(){var e;this.navButtons=this.node.getComponentsInChildren("NavButton"),this.selectedButton=null===(e=this.selectedButtonNode)||void 0===e?void 0:e.getComponentInChildren("NavButton"),O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),O.on(Ge.VIEW_RESIZED,this.handleViewResized,this),this.handleOrientationChanged(Ye.getCurrentLayout())}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),O.off(Ge.VIEW_RESIZED,this.handleViewResized,this)}},{key:"select",value:(y=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isNavigating){e.next=2;break}return e.abrupt("return");case 2:if(XJ.has(this.navButtons,t)){e.next=4;break}throw new Error("NavManager: Button not found");case 4:if(t!==this.selectedButton){e.next=6;break}return e.abrupt("return");case 6:if(!t.isWIP){e.next=9;break}return this.handleWIPButton(),e.abrupt("return");case 9:return this.isNavigating=!0,this.node.scene.emit(kn,{from:this.selectedButton.buttonType,to:t.buttonType}),e.abrupt("return",new Promise((function(e){n.node.scene.once(Sn,(function(){var i=n.selectedButton.deselect();n.autoLayout.selectedIndex=n.navButtons.indexOf(t),n.selectedButton=t;var r=n.autoLayout.getSelectedWorldX()-t.getSelectedWorldDistanceX(),a=n.playSelectorAnimation(r),o=t.select();Promise.all([i,o,a]).then((function(){n.isNavigating=!1,e()}))}))})));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"selectUsingSceneTransition",value:(d=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isNavigating){e.next=2;break}return e.abrupt("return");case 2:if(!XJ.has([En.store],t.buttonType)){e.next=5;break}return this.handleWIPButton(),e.abrupt("return");case 5:return e.next=7,this.select(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"selectByType",value:(h=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=XJ.search(this.navButtons,(function(e){return e.buttonType===t}))){e.next=3;break}throw new Error("NavManager: Button not found");case 3:return e.next=5,this.selectUsingSceneTransition(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"handleWIPButton",value:function(){nt.openScreen(it.STAR_CHEST_SCREEN)}},{key:"selectDefaultNavBtn",value:(p=a(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentButton&&XJ.has(this.navButtons,this.currentButton)){e.next=2;break}throw new Error("NavManager: Button not found");case 2:return t=this.currentButton.buttonType,this.node.scene.emit(kn,{from:null,to:t}),e.abrupt("return",new Promise((function(e){n.node.scene.once(Sn,(function(){n.autoLayout.selectedIndex=n.navButtons.indexOf(n.currentButton);var t=n.navButtons.map((function(e){return e===n.currentButton?e.select(!1):e.deselect(!1,!0)})),i=n.autoLayout.getSelectedWorldX()-n.currentButton.getSelectedWorldDistanceX();n.selectorNode.worldPosition=new q(i,n.selectorNode.worldPosition.y,0),Promise.all(t).then((function(){e()}))}))})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"playSelectorAnimation",value:(u=a(o().mark((function e(t){var n,i,r,a,s,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.selectorAnimationSignal.renew(),i=new q(1,1,1),r=this.selectorNode.worldPosition.clone(),a=new q(1.2*i.x,.8*i.y,1),s=L(this.selectorNode).to(.3,{worldPosition:new q(t,r.y,0)},{easing:"quintInOut",onUpdate:function(e,t){if(void 0!==t){var n=l.calculateCurrentSquashScale(i,a,t);l.selectorNode.scale=n}}}),e.next=9,Ue.runTweenAsync(s,n);case 9:this.selectorNode.scale=i;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=c(this.navButtons);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.getComponentInChildren(U);r&&(r.interactable=!t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"calculateCurrentSquashScale",value:function(e,t,n){var i=this.splitIntoSquashRatio(n);return e.clone().lerp(t,i)}},{key:"splitIntoSquashRatio",value:function(e){return e<.5?2*e:1-2*(e-.5)}},{key:"handleOrientationChanged",value:function(e){e===$J.Portrait?(this.navWidget.isAlignLeft=!0,this.navWidget.isAlignRight=!0,this.backgroundWidget.left=-50,this.backgroundWidget.right=-50,this.layoutWidget.left=0,this.layoutWidget.right=0):e===$J.Landscape&&(this.navWidget.isAlignLeft=!1,this.navWidget.isAlignRight=!1,this.backgroundWidget.left=0,this.backgroundWidget.right=0,this.layoutWidget.left=25,this.layoutWidget.right=25,this.uiTransform.width=1e3)}},{key:"handleViewResized",value:function(){this.selectedButton&&(this.selectorAnimationSignal.abort(),this.selectorNode.worldPositionX=this.selectedButton.node.worldPosition.x,this.selectorNode.y=-164.5)}}]),v}(x)).prototype,"selectorNode",[BY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jY=r(WY.prototype,"selectedButtonNode",[zY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YY=r(WY.prototype,"autoLayout",[FY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JY=r(WY.prototype,"navWidget",[UY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZY=r(WY.prototype,"backgroundWidget",[GY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XY=r(WY.prototype,"layoutWidget",[HY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QY=r(WY.prototype,"uiTransform",[qY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VY=WY))||VY);w._RF.pop(),w._RF.push({},"d48a1TnKg1F4YRzzKmQOD5k","DashboardScene",void 0);var tZ,nZ=S.ccclass,iZ=S.disallowMultiple,rZ=S.property,aZ=codex,oZ=aZ.storage,sZ=aZ.player,lZ=(aZ.event,aZ.monitorError),uZ=Ludex,cZ=uZ.Match.Modes,pZ=(uZ.Events,uZ.Utils.Array);oJ=nZ("DashboardScene"),sJ=Ii.required(),lJ=rZ(Fw),uJ=Ii.required(),cJ=rZ(eZ),pJ=Ii.required(),hJ=rZ(Bi),dJ=Ii.required(),yJ=rZ(aJ),fJ=Ii.required(),vJ=rZ(CF),mJ=Ii.required(),gJ=rZ(Ao),bJ=Ii.onlyRunInLifeCycle,wJ=Ii.onlyRunInLifeCycle,kJ=Ii.onlyRunInLifeCycle,SJ=Ii.onlyRunInLifeCycle,CJ=Ii.onlyRunInLifeCycle,EJ=Ii.onlyRunInLifeCycle,xJ=Ii.onlyRunInLifeCycle,AJ=Ii.onlyRunInLifeCycleAsync,TJ=Ii.onlyRunInLifeCycleAsync,PJ=Ii.onlyRunInLifeCycleAsync,RJ=Ii.onlyRunInLifeCycleAsync,LJ=Ii.onlyRunInLifeCycle,IJ=Ii.onlyRunInLifeCycleAsync,OJ=Ii.onlyRunInLifeCycleAsync,_J=Ii.onlyRunInLifeCycleAsync,DJ=Ii.onlyRunInLifeCycleAsync,MJ=Ii.onlyRunInLifeCycleAsync,NJ=Ii.onlyRunInLifeCycleAsync,BJ=Ii.onlyRunInLifeCycle,zJ=Ii.onlyRunInLifeCycleAsync,FJ=Ii.onlyRunInLifeCycle,oJ(UJ=iZ((HJ=r((GJ=function(r){n(A,r);var p,h,d,y,f,v,m,g,b,w,k,S,C,E,x=i(A);function A(){var e;t(this,A);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=x.call.apply(x,[this].concat(i)),s(e,"coinManager",HJ,l(e)),s(e,"navManager",qJ,l(e)),s(e,"bgComp",VJ,l(e)),s(e,"pageManager",WJ,l(e)),s(e,"pageAnimSkipOverlay",KJ,l(e)),s(e,"transitionOpacityToggler",jJ,l(e)),e.firstNavigation=!0,e.isFirstNavToCollections=!0,e.isFirstNavToTournament=!0,e.navigationSignal=null,e}return e(A,[{key:"listenNavigationEvents",value:function(){this.node.scene.on(kn,this.onNavigate,this)}},{key:"listenDashboardEvents",value:function(){this.node.scene.on(bn,this.handleDashboardPlayButtonPress,this),this.node.scene.on(wn,this.handleCustomPlayButtonPress,this),this.node.scene.on(Cn,this.handleEventButtonPress,this)}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this),this.listenNavigationEvents(),this.listenDashboardEvents(),this.coinManager.init(),$d.init(),this.setPlayerLevel(),this.updateBackgroundImageToCurrentTheme(),this.pageManager.updateCollectionsContentPayload($d.getCollectionUnlockProgress())}},{key:"setPlayerLevel",value:function(){var e,t=(null!==(e=sZ.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;n=0===n?1:n,sZ.setGameData({level:n})}},{key:"start",value:function(){sZ.getPlayerSetting("music")&&this.updateMusic(),this.pageManager.init(),this.navManager.selectDefaultNavBtn(),this.scheduleOnce(this.preloadScene,5),this.scheduleOnce(this.preloadSkins,3),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScene",value:function(){ot.isSceneLoaded(ct.GAME_SCENE)||ot.preloadGameScene()}},{key:"preloadScreens",value:function(){var e;nt.preloadScreen(it.LOADING_SCREEN),nt.preloadScreen(it.NOTIFICATION_SCREEN),nt.preloadScreen(it.SETTINGS_SCREEN),nt.preloadScreen(it.GET_COIN_SCREEN),nt.preloadScreen(it.STAR_CHEST_SCREEN),nt.preloadScreen(it.DAILY_REWARDS_SCREEN);var t=sZ.getGameData();(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)>=13&&nt.preloadScreen(it.CUSTOM_GAME_SCREEN)}},{key:"preloadSkins",value:function(){var e,t=$d.getUnlockedSkins(),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r="".concat(Qe.TILE_SKIN_FOLDER,"/").concat(i);Fe.loadSpriteFramesDirAsync(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"attemptCallSubscribeBot",value:function(){GameSDK.isGameSDK("FacebookInstant")&&GameSDK.extra.checkAndSubscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))}},{key:"updateBackgroundImageToCurrentTheme",value:function(){var e,t=oZ.getStorage("dashboard");if(null!=t){var n=null!==(e=t.animateToCurrentLevel)&&void 0!==e&&e,i=u({},t.lastMapPayload),r=$d.getCurrentMapProgress(),a=i.currentTheme===r.currentTheme&&i.nextTheme===r.nextTheme,o=r.currentTheme;!n||a||this.isDevToolTimeTravel(i.id,r.id)?this.bgComp.setCurrentTheme(o):this.bgComp.setCurrentTheme(i.currentTheme)}else null==lZ||lZ.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"isDevToolTimeTravel",value:function(e,t){return pZ.searchIndex(jd.mapOrder,(function(t){return t.id===e}))>pZ.searchIndex(jd.mapOrder,(function(e){return e.id===t}))}},{key:"handleDashboardPlayButtonPress",value:function(){this.handlePlayButtonPress(cZ.SINGLE)}},{key:"handleCustomPlayButtonPress",value:function(){this.handlePlayButtonPress(vy)}},{key:"handlePlayButtonPress",value:(E=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,tt.setBlockInput(!0),i=$d.getCurrentMapProgress(),r=null!==(n=sZ.getGameData())&&void 0!==n?n:{},a=r.level,s=void 0===a?1:a,e.next=6,hy.setMatchCustomDataAsync({level:s});case 6:return e.next=8,hy.startMatchAsync(t);case 8:return this.updateCurrentMapInStorage(i),oZ.setStorageData("collection","lastMapPack",i.id),oZ.setStorageData("collection","animateMapPackUnlock",!1),e.next=13,this.switchToGameScene(s);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),tt.setBlockInput(!1),console.error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(e){return E.apply(this,arguments)})},{key:"switchToGameScene",value:(C=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ot.isSceneLoaded(ct.GAME_SCENE)){e.next=3;break}return e.next=3,this.transitionOpacityToggler.changeStateFade(!0,.25);case 3:ot.switchToGameScene({level:t});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"updateCurrentMapInStorage",value:function(e){oZ.setStorageData("dashboard","animateToCurrentLevel",!1),oZ.setStorageData("dashboard","lastMapPayload",e)}},{key:"updateMusic",value:(S=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ve.getCurrentMusic()===Ji.BG_MUSIC){e.next=5;break}return e.next=3,Ve.setVolumeMusic(0,!0);case 3:return e.next=5,Ue.waitTweenAsync(1);case 5:Ve.playMusic(Ji.BG_MUSIC),Ve.turnUpMusic();case 7:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"onNavigate",value:(k=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.firstNavigation&&(this.firstNavigation=!1,this.pageManager.unmountAndHideAll()),e.t0=t.to,e.next=e.t0===En.store?4:e.t0===En.collections?5:e.t0===En.tournaments?11:e.t0===En.leaderboard?16:e.t0===En.home?20:23;break;case 4:return e.abrupt("break",24);case 5:return e.next=7,this.triggerPageNavigation(t);case 7:return e.next=9,this.handleLogicAfterNavigateToCollections();case 9:return this.cleanupAfterPageNavigation(),e.abrupt("break",24);case 11:return nt.preloadScreen(it.TOURNAMENT_DETAIL_SCREEN),e.next=14,this.triggerPageNavigation(t);case 14:return this.cleanupAfterPageNavigation(),e.abrupt("break",24);case 16:return e.next=18,this.triggerPageNavigation(t);case 18:return this.cleanupAfterPageNavigation(),e.abrupt("break",24);case 20:return e.next=22,this.handleNavigateToHome(t);case 22:return e.abrupt("break",24);case 23:throw new Error("DashboardScene: Unhandled page name");case 24:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"handleLogicAfterNavigateToCollections",value:(w=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=null===(t=this.pageManager.getPage(En.collections))||void 0===t?void 0:t.getContainer().getComponentInChildren(AH))){e.next=3;break}throw new Error("CollectionsContent not found");case 3:if(i=new An,!(r=n.shouldAnimateThemeBlockUnlock())){e.next=8;break}return e.next=8,this.openSkipOverlay(i);case 8:return e.next=10,this.tryPlayScrollToCollectionAnim(n,i);case 10:return e.next=12,n.playThemeTabUnlockAnim(i);case 12:if(!r){e.next=15;break}return e.next=15,this.closeSkipOverlay();case 15:i.abort();case 16:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"closeSkipOverlay",value:(b=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pageAnimSkipOverlay.close();case 2:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"openSkipOverlay",value:(g=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pageAnimSkipOverlay.open({onSkip:function(){return t.abort()},opacity:200});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"tryPlayScrollToCollectionAnim",value:(m=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$d.getCurrentUnlockingThemeIndex(),!this.isFirstNavToCollections||null===i){e.next=5;break}return e.next=4,t.scrollToCurrentUnlockingTheme(i,n);case 4:this.isFirstNavToCollections=!1;case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"cleanupAfterPageNavigation",value:function(){this.navManager.setIgnoreInput(!1)}},{key:"triggerPageNavigation",value:(v=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.navigationSignal)||void 0===n||n.abort(),this.navigationSignal=new An,e.next=4,this.pageManager.navigate(t,this.navigationSignal);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"handleNavigateToHome",value:(f=a(o().mark((function e(t){var n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.navigationSignal)||void 0===n||n.abort(),this.navigationSignal=new An,e.next=4,this.pageManager.navigate(t,this.navigationSignal,a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.initializeHomepageCoinManager();case 1:case"end":return e.stop()}}),e)}))));case 4:return e.next=6,this.handleLogicAfterNavigateToHome();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"handleLogicAfterNavigateToHome",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(MU.hasShownPopup()||this.shouldPlayLevelUpAnimation()){e.next=6;break}return e.next=3,MU.hasClaimableRewards();case 3:if(!e.sent){e.next=6;break}return e.next=6,MU.openPopupScreenAndWaitForClose();case 6:return this.attemptCallSubscribeBot(),e.next=9,this.waitUntilCoinManagerFinishesAnyAnimation();case 9:return e.next=11,this.waitUntilPageAnimSkipOverlayCloses();case 11:return e.next=13,this.tryNavigateToTournament();case 13:return e.next=15,this.tryPlayLevelUpAnimation();case 15:return e.next=17,this.tryShowCustomModeGuide();case 17:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"waitUntilCoinManagerFinishesAnyAnimation",value:function(){return this.coinManager.untilFinishesCollectAnim()}},{key:"waitUntilPageAnimSkipOverlayCloses",value:function(){return this.pageAnimSkipOverlay.untilClosed()}},{key:"tryNavigateToTournament",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oZ.getStorage("tournament").animateTournamentLeader){e.next=5;break}return e.next=4,this.navManager.selectByType(En.tournaments);case 4:return e.abrupt("return",e.sent);case 5:if(this.isFirstNavToTournament){e.next=7;break}return e.abrupt("return");case 7:if(this.isFirstNavToTournament=!1,e.prev=8,"getTournamentAsync"in GameSDK){e.next=11;break}throw new Error("Unavailable feature: tournament");case 11:return e.next=13,GameSDK.getTournamentAsync();case 13:if(!(e.sent.getEndTime()<Date.now()/1e3)){e.next=18;break}return e.next=17,this.navManager.selectByType(En.tournaments);case 17:return e.abrupt("return",e.sent);case 18:e.next=22;break;case 20:e.prev=20,e.t0=e.catch(8);case 22:case"end":return e.stop()}}),e,this,[[8,20]])}))),function(){return d.apply(this,arguments)})},{key:"shouldPlayLevelUpAnimation",value:function(){var e;if(!this.enabledInHierarchy)return!1;var t=null===(e=this.pageManager.getPage(En.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(Mj);if(null==t)return!1;var n=t.shouldPlayUnlockAnimation(),i=this.shouldPlayPackUnlockAnimation();return n||i}},{key:"tryPlayLevelUpAnimation",value:(h=a(o().mark((function e(){var t,n,i,r,a,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=null===(t=this.pageManager.getPage(En.home))||void 0===t?void 0:t.getContainer().getComponentInChildren(Mj))){e.next=3;break}throw new Error("DashboardScene: Homepage not found");case 3:if(i=new An,this.navigationSignal&&i.chain(this.navigationSignal),r=n.shouldPlayUnlockAnimation(),a=this.shouldPlayPackUnlockAnimation(),r){e.next=9;break}return e.abrupt("return");case 9:if(!a){e.next=12;break}return e.next=12,this.pageAnimSkipOverlay.open({onSkip:function(){return i.abort()},opacity:150});case 12:return e.next=14,n.playUnlockProgressAnimation(i);case 14:if(this.updateBackgroundImageToCurrentTheme(),!a){e.next=20;break}return e.next=18,this.pageAnimSkipOverlay.close();case 18:return e.next=20,i.callAsync((function(){return s.navManager.selectByType(En.collections)}));case 20:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"shouldPlayPackUnlockAnimation",value:function(){var e=oZ.getStorage("dashboard");if(null==e)throw new Error("DashboardScene: dashboardStorage not found");var t=e.lastMapPayload,n=$d.getCurrentMapProgress();return!(pZ.searchIndex(jd.mapOrder,(function(e){return e.id===t.id}))===pZ.searchIndex(jd.mapOrder,(function(e){return e.id===n.id})))}},{key:"initializeHomepageCoinManager",value:function(){var e,t=null===(e=this.pageManager.getPage(En.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(Mj);if(null==t)throw new Error("DashboardScene: Homepage not found");this.coinManager.setTargetContainer(t.getCoinContainer()),this.coinManager.emitCoinAmount()}},{key:"tryShowCustomModeGuide",value:(p=a(o().mark((function e(){var t,n,i,r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!==(t=sZ.getGameData())&&void 0!==t?t:{},r=i.level,a=void 0===r?1:r,s=i.guideItemShowed,l=void 0===s?[]:s,13===a&&!pZ.has(l,rP)){e.next=3;break}return e.abrupt("return");case 3:if(l.push(rP),sZ.setGameData({guideItemShowed:l}),null!=(u=null===(n=this.pageManager.getPage(En.home))||void 0===n?void 0:n.getContainer().getComponentInChildren(Mj))){e.next=8;break}throw new Error("DashboardScene: Homepage not found");case 8:return e.next=10,u.showCustomGuide();case 10:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleEventButtonPress",value:function(e){switch(e.type){case ZB.STAR_CHEST:nt.openScreen(it.STAR_CHEST_SCREEN);break;case ZB.DAILY_REWARDS:MU.openPopupScreen();break;case ZB.BALLOON:nt.showNotificationScreenWithLocalizedKey("error.soon");break;default:throw new Error("DashboardScene: Unhandled event button type")}}},{key:"handleTestLayoutButtonClicked",value:function(){}}]),A}(x)).prototype,"coinManager",[sJ,lJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qJ=r(GJ.prototype,"navManager",[uJ,cJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VJ=r(GJ.prototype,"bgComp",[pJ,hJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WJ=r(GJ.prototype,"pageManager",[dJ,yJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KJ=r(GJ.prototype,"pageAnimSkipOverlay",[fJ,vJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jJ=r(GJ.prototype,"transitionOpacityToggler",[mJ,gJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(GJ.prototype,"preloadScene",[bJ],Object.getOwnPropertyDescriptor(GJ.prototype,"preloadScene"),GJ.prototype),r(GJ.prototype,"preloadScreens",[wJ],Object.getOwnPropertyDescriptor(GJ.prototype,"preloadScreens"),GJ.prototype),r(GJ.prototype,"preloadSkins",[kJ],Object.getOwnPropertyDescriptor(GJ.prototype,"preloadSkins"),GJ.prototype),r(GJ.prototype,"attemptCallSubscribeBot",[SJ],Object.getOwnPropertyDescriptor(GJ.prototype,"attemptCallSubscribeBot"),GJ.prototype),r(GJ.prototype,"updateBackgroundImageToCurrentTheme",[CJ],Object.getOwnPropertyDescriptor(GJ.prototype,"updateBackgroundImageToCurrentTheme"),GJ.prototype),r(GJ.prototype,"handleDashboardPlayButtonPress",[EJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handleDashboardPlayButtonPress"),GJ.prototype),r(GJ.prototype,"handleCustomPlayButtonPress",[xJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handleCustomPlayButtonPress"),GJ.prototype),r(GJ.prototype,"handlePlayButtonPress",[AJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handlePlayButtonPress"),GJ.prototype),r(GJ.prototype,"onNavigate",[TJ],Object.getOwnPropertyDescriptor(GJ.prototype,"onNavigate"),GJ.prototype),r(GJ.prototype,"handleLogicAfterNavigateToCollections",[PJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handleLogicAfterNavigateToCollections"),GJ.prototype),r(GJ.prototype,"tryPlayScrollToCollectionAnim",[RJ],Object.getOwnPropertyDescriptor(GJ.prototype,"tryPlayScrollToCollectionAnim"),GJ.prototype),r(GJ.prototype,"cleanupAfterPageNavigation",[LJ],Object.getOwnPropertyDescriptor(GJ.prototype,"cleanupAfterPageNavigation"),GJ.prototype),r(GJ.prototype,"triggerPageNavigation",[IJ],Object.getOwnPropertyDescriptor(GJ.prototype,"triggerPageNavigation"),GJ.prototype),r(GJ.prototype,"handleNavigateToHome",[OJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handleNavigateToHome"),GJ.prototype),r(GJ.prototype,"waitUntilCoinManagerFinishesAnyAnimation",[_J],Object.getOwnPropertyDescriptor(GJ.prototype,"waitUntilCoinManagerFinishesAnyAnimation"),GJ.prototype),r(GJ.prototype,"waitUntilPageAnimSkipOverlayCloses",[DJ],Object.getOwnPropertyDescriptor(GJ.prototype,"waitUntilPageAnimSkipOverlayCloses"),GJ.prototype),r(GJ.prototype,"tryNavigateToTournament",[MJ],Object.getOwnPropertyDescriptor(GJ.prototype,"tryNavigateToTournament"),GJ.prototype),r(GJ.prototype,"tryPlayLevelUpAnimation",[NJ],Object.getOwnPropertyDescriptor(GJ.prototype,"tryPlayLevelUpAnimation"),GJ.prototype),r(GJ.prototype,"initializeHomepageCoinManager",[BJ],Object.getOwnPropertyDescriptor(GJ.prototype,"initializeHomepageCoinManager"),GJ.prototype),r(GJ.prototype,"tryShowCustomModeGuide",[zJ],Object.getOwnPropertyDescriptor(GJ.prototype,"tryShowCustomModeGuide"),GJ.prototype),r(GJ.prototype,"handleEventButtonPress",[FJ],Object.getOwnPropertyDescriptor(GJ.prototype,"handleEventButtonPress"),GJ.prototype),UJ=GJ))||UJ);w._RF.pop(),w._RF.push({},"1be4fAboTNK3IFk6IiygYLZ","PageContent",void 0);var hZ,dZ,yZ,fZ,vZ,mZ,gZ,bZ=S.ccclass,wZ=qe.Layout;bZ("PageContent")(tZ=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"__preload",value:function(){this.widget=this.getComponent(R),this.uiTransform=this.getComponent(A)}},{key:"onLoad",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ye.getCurrentLayout())}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(e){e===wZ.Portrait?(this.widget.isAlignLeft=!0,this.widget.isAlignRight=!0):e===wZ.Landscape&&(this.widget.isAlignLeft=!1,this.widget.isAlignRight=!1,this.uiTransform.width=1e3)}}]),o}(x));w._RF.pop(),w._RF.push({},"c68178FyxlCOqbCt/+wktvw","PageHeader",void 0);var kZ,SZ,CZ,EZ,xZ,AZ,TZ,PZ,RZ,LZ,IZ,OZ,_Z=S.ccclass,DZ=S.property,MZ=qe.Layout;hZ=_Z("PageHeader"),dZ=Ii.required,yZ=DZ(R),fZ=Ii.onlyRunInLifeCycleAsync,hZ((gZ=r((mZ=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"widget",gZ,l(e)),e}return e(h,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,h),Ye.isLandscape()&&this.loadLeaves()}},{key:"onLoad",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ye.getCurrentLayout())}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:(c=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==MZ.Portrait){e.next=6;break}this.leaves&&(this.leaves.active=!1),this.widget.left=-80,this.widget.right=-80,e.next=12;break;case 6:if(t!==MZ.Landscape){e.next=12;break}return this.widget.left=0,this.widget.right=0,e.next=11,this.loadLeaves();case 11:this.leaves&&(this.leaves.active=!0);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"loadLeaves",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.leaves){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Fe.loadPrefabAsync(Qe.PAGE_LEAVES_PREFAB);case 4:if(t=e.sent,!this.leaves&&t&&this.enabledInHierarchy){e.next=7;break}return e.abrupt("return");case 7:this.leaves=he(t),this.node.addChild(this.leaves);case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"widget",[dZ,yZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(mZ.prototype,"loadLeaves",[fZ],Object.getOwnPropertyDescriptor(mZ.prototype,"loadLeaves"),mZ.prototype),vZ=mZ));w._RF.pop(),w._RF.push({},"53f87ljsxFJUKsBbXk8WVkJ","HomePage",void 0);var NZ,BZ,zZ,FZ,UZ,GZ,HZ,qZ,VZ,WZ,KZ,jZ,YZ=S.ccclass,JZ=S.property,ZZ=codex,XZ=ZZ.player,QZ=ZZ.storage,$Z=ZZ.monitorError,eX=Ludex.Utils.Number;kZ=YZ("HomePage"),SZ=Ii.required(),CZ=JZ({type:Y,group:"Placeholders"}),EZ=Ii.required(),xZ=Ii.onlyRunInLifeCycleAsync,AZ=Ii.onlyRunInLifeCycle,TZ=Ii.onlyRunInLifeCycleAsync,PZ=Ii.onlyRunInLifeCycleAsync,kZ((IZ=r((LZ=function(r){n(m,r);var c,d,y,f,v=i(m);function m(){var e;t(this,m);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=v.call.apply(v,[this].concat(i)),s(e,"coinLabel",IZ,l(e)),s(e,"panelAnimationController",OZ,l(e)),e}return e(m,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(al),p(h(m.prototype),"onLoad",this).call(this)}},{key:"onEnable",value:function(){this.node.scene.on(Us.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"onDisable",value:function(){this.node.scene.off(Us.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"updatePlaceholderCoins",value:(f=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.coinLabel.string=eX.getShortNumber(t.coins,3);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"mount",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(m.prototype),"mount",this).call(this);case 2:this.onMount();case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"onMount",value:function(){var e;if(!this.homeContent&&(this.homeContent=this.container.getComponentInChildren(Mj),!this.homeContent))throw new Error("HomePage: homeContent not found");var t=(null!==(e=XZ.getGameData())&&void 0!==e?e:{}).coins,n=void 0===t?0:t;this.updatePlaceholderCoins({coins:n}),this.homeContent.updateStatus(),this.initUnlockProgressData()}},{key:"initUnlockProgressData",value:function(){var e=this.homeContent.shouldPlayUnlockAnimation(),t=u({},$d.getCurrentMapProgress()),n=QZ.getStorage("dashboard");if(null==n)return null==$Z||$Z.sendException(new Error("DashboardScene: dashboardStorage not found")),void(e||this.homeContent.setUnlockProgress(t));var i=u({},n.lastMapPayload);e?this.homeContent.setUnlockProgress(i):this.homeContent.setUnlockProgress(t)}},{key:"transitionIn",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.homeContent.transitionIn(),e.next=3,p(h(m.prototype),"transitionIn",this).call(this);case 3:return e.next=5,this.panelAnimationController.showUI();case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"transitionOut",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.homeContent.transitionOut(),e.next=3,p(h(m.prototype),"transitionOut",this).call(this);case 3:return e.next=5,this.panelAnimationController.hideUI();case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"hasLoadedPage",value:function(){return!0}}]),m}(Jj)).prototype,"coinLabel",[SZ,CZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OZ=r(LZ.prototype,"panelAnimationController",[EZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(LZ.prototype,"mount",[xZ],Object.getOwnPropertyDescriptor(LZ.prototype,"mount"),LZ.prototype),r(LZ.prototype,"onMount",[AZ],Object.getOwnPropertyDescriptor(LZ.prototype,"onMount"),LZ.prototype),r(LZ.prototype,"transitionIn",[TZ],Object.getOwnPropertyDescriptor(LZ.prototype,"transitionIn"),LZ.prototype),r(LZ.prototype,"transitionOut",[PZ],Object.getOwnPropertyDescriptor(LZ.prototype,"transitionOut"),LZ.prototype),RZ=LZ));w._RF.pop(),w._RF.push({},"73dd1GUhlNKPJc27Ls4gr6D","JoinLeaderboardContainer",void 0);var tX,nX,iX,rX,aX,oX,sX,lX,uX,cX,pX,hX,dX,yX,fX,vX,mX,gX,bX,wX,kX=S.ccclass,SX=S.property,CX=(NZ=kX("JoinLeaderboardContainer"),BZ=Ii.required,zZ=SX(R),FZ=Ii.required,UZ=SX(A),GZ=Ii.required,HZ=SX(H),NZ((WZ=r((VZ=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"widget",WZ,l(e)),s(e,"uiTransform",KZ,l(e)),s(e,"joinButton",jZ,l(e)),e}return e(p,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,p)}},{key:"updatePosition",value:function(e){void 0!==e?(this.widget.enabled=!1,this.node.setWorldPosition(this.node.worldPosition.x,e,this.node.worldPosition.z)):(this.widget.enabled=!0,this.widget.updateAlignment())}},{key:"show",value:(u=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t||!t.aborted){e.next=2;break}return e.abrupt("return");case 2:return this.joinButton.active=!0,n=L(this.joinButton).set({scale:q.ZERO}).to(.5,{scale:q.ONE},{easing:"backOut"}),e.next=6,Ue.runTweenAsync(n,t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"hide",value:function(){this.joinButton.active=!1}}]),p}(x)).prototype,"widget",[BZ,zZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KZ=r(VZ.prototype,"uiTransform",[FZ,UZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jZ=r(VZ.prototype,"joinButton",[GZ,HZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qZ=VZ))||qZ);w._RF.pop(),w._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var EX,xX,AX,TX,PX,RX,LX,IX=S.ccclass,OX=S.property,_X=S.requireComponent,DX=codex.analytics,MX=Ludex,NX=MX.Utils,BX=NX.Array,zX=NX.Valid,FX=MX.Plugins.Analytics,UX=(void 0===FX?{}:FX).Events,GX=(tX=IX("SwitchButton"),nX=_X([U,le]),iX=OX(W),rX=OX(H),aX=OX(H),oX=OX(W),sX=OX({visible:function(){return this.useSound},type:Xi}),lX=OX(W),uX=OX({visible:function(){return this.useDesktopHover},type:ue}),cX=OX({visible:function(){return this.useDesktopHover},type:ue}),tX(pX=nX((dX=r((hX=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"enable",dX,l(e)),s(e,"nodeOn",yX,l(e)),s(e,"nodeOff",fX,l(e)),s(e,"useSound",vX,l(e)),s(e,"soundKey",mX,l(e)),s(e,"useDesktopHover",gX,l(e)),s(e,"mouseEnterClip",bX,l(e)),s(e,"mouseLeaveClip",wX,l(e)),e.isMouseLeaved=!1,e.onMouseEnter=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved=!1,e.animationComponent.play(e.mouseEnterClip.name))},e.onMouseLeave=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved||(e.isMouseLeaved=!0,e.animationComponent.play(e.mouseLeaveClip.name)))},e}return e(o,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(U),this.animationComponent=this.getComponent(le),this.validateRequiredComponents()}},{key:"onLoad",value:function(){var e=this.animationComponent.clips.map((function(e){return null==e?void 0:e.name})).filter((function(e){return null!=e&&"string"==typeof e}));this.useDesktopHover&&(BX.has(e,this.mouseEnterClip.name)||this.animationComponent.addClip(this.mouseEnterClip),BX.has(e,this.mouseLeaveClip.name)||this.animationComponent.addClip(this.mouseLeaveClip))}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.node.on(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"switch",value:function(){return!!this.node.active&&(UX&&DX.event(UX.BUTTON_CLICK,{button_name:this.node.name,enable:!this.enable}),this.useSound&&zX.isString(this.soundKey)&&Ve.playSound(Tr[this.soundKey]),this.updateStatus(!this.enable))}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable===e||(this.onMouseLeave(null),this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e),this.enable}}]),o}(x)).prototype,"enable",[iX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),yX=r(hX.prototype,"nodeOn",[rX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fX=r(hX.prototype,"nodeOff",[aX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vX=r(hX.prototype,"useSound",[oX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),mX=r(hX.prototype,"soundKey",[sX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xi[Ji.BUTTON_CLICK]}}),gX=r(hX.prototype,"useDesktopHover",[lX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),bX=r(hX.prototype,"mouseEnterClip",[uX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wX=r(hX.prototype,"mouseLeaveClip",[cX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pX=hX))||pX)||pX);w._RF.pop(),w._RF.push({},"2871awUXL9J0I+rBEFNHN7o","Tabs",void 0);var HX,qX,VX,WX,KX,jX,YX,JX,ZX,XX=S.ccclass,QX=S.property,$X=codex.analytics,eQ=Ludex.Plugins.Analytics,tQ=(void 0===eQ?{}:eQ).Events,nQ=(EX=XX("Tabs"),xX=QX(GX),AX=QX(GX),EX((RX=r((PX=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"tabDaily",RX,l(e)),s(e,"tabWeekly",LX,l(e)),e}return e(o,[{key:"setInteractableButtons",value:function(e){this.tabDaily.getComponent(U).interactable=e,this.tabWeekly.getComponent(U).interactable=e}},{key:"updateStatus",value:function(e){this.tabDaily.setEnabled(e===Hd),this.tabWeekly.setEnabled(e===qd)}},{key:"handleTabDailySelect",value:function(){this.tabDaily.setEnabled(!0),this.tabWeekly.setEnabled(!1),Ve.playSound(Ji.BUTTON_CLICK),tQ&&$X.event(tQ.BUTTON_CLICK,{button_name:this.node.name,screen_name:We.getCurrentPage()}),this.node.scene.emit(QB.WORLD_TAB_SELECTED)}},{key:"handleTabWeeklySelect",value:function(){this.tabDaily.setEnabled(!1),this.tabWeekly.setEnabled(!0),Ve.playSound(Ji.BUTTON_CLICK),tQ&&$X.event(tQ.BUTTON_CLICK,{button_name:this.node.name,screen_name:We.getCurrentPage()}),this.node.scene.emit(QB.WEEKLY_TAB_SELECTED)}}]),o}(x)).prototype,"tabDaily",[xX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LX=r(PX.prototype,"tabWeekly",[AX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TX=PX))||TX);w._RF.pop(),w._RF.push({},"91613SO4bxPDq9dH9zxyIef","LeaderboardTimer",void 0);var iQ,rQ,aQ,oQ,sQ,lQ=S.ccclass,uQ=S.property,cQ=Ludex.Utils.Time,pQ=codex.language,hQ=(HX=lQ("LeaderboardTimer"),qX=uQ(A),VX=uQ(H),WX=uQ(cp),HX((YX=r((jX=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"background",YX,l(e)),s(e,"calendar",JX,l(e)),s(e,"timerLocalizer",ZX,l(e)),e.alreadyShown=!1,e}return e(p,[{key:"onLoad",value:function(){this.timerOpacity=this.timerLocalizer.node.getComponent(M),this.validateRequiredComponents(),this.backgroundDefaultWidth=this.background.width,this.calendarDefaultPosition=this.calendar.position.clone()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"show",value:(u=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alreadyShown&&!t.aborted){e.next=2;break}return e.abrupt("return");case 2:return this.alreadyShown=!0,n=L(this.calendar).to(.3,{scale:q.ONE},{easing:"backOut"}).to(.3,{position:this.calendarDefaultPosition.clone()},{easing:"quadOut"}),i=L(this.background).delay(.3).to(.3,{width:this.backgroundDefaultWidth},{easing:"quadOut"}),r=L(this.timerOpacity).to(.3,{opacity:255}),e.next=8,Promise.all([Ue.runTweenAsync(n,t),Ue.runTweenAsync(i,t)]);case 8:return this.calendar.scale=q.ONE,this.calendar.position=this.calendarDefaultPosition.clone(),this.background.width=this.backgroundDefaultWidth,e.next=13,Ue.runTweenAsync(r,t);case 13:this.timerOpacity.opacity=255;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"reset",value:function(){this.alreadyShown||(this.calendar.position=this.background.node.position.clone(),this.calendar.scale=q.ZERO,this.background.width=0,this.timerOpacity.opacity=0)}},{key:"setTimeLabel",value:function(e){if(e){var t=new Date,n=0;if("manually"===e)n=0;else if("daily"===e)n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);else if("weekly"===e){var i=t.getUTCDay(),r=0===i?1:8-i;n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+r)}else n="monthly"===e?Date.UTC(t.getUTCFullYear(),t.getUTCMonth()+1):Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);try{var a=cQ.getRelativeTime(n/1e3,pQ.getCurrentLocale());this.timerLocalizer.key="game.endsIn",this.timerLocalizer.setParams([a])}catch(e){this.timerLocalizer.key="game.endsSoon"}}else this.timerLocalizer.key="status.loading"}}]),p}(x)).prototype,"background",[qX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JX=r(jX.prototype,"calendar",[VX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZX=r(jX.prototype,"timerLocalizer",[WX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KX=jX))||KX);w._RF.pop(),w._RF.push({},"69c90PvoTtGfZyDw8FbbOvV","LeaderSkeleton",void 0);var dQ,yQ,fQ,vQ,mQ,gQ,bQ,wQ,kQ,SQ,CQ,EQ,xQ,AQ,TQ,PQ,RQ,LQ,IQ,OQ,_Q,DQ,MQ,NQ,BQ,zQ,FQ,UQ,GQ,HQ,qQ,VQ,WQ,KQ,jQ,YQ,JQ,ZQ,XQ,QQ,$Q,e$,t$,n$,i$=S.ccclass,r$=S.disallowMultiple,a$=S.property,o$=(iQ=i$("LeaderSkeleton"),rQ=a$(H),iQ(aQ=r$((sQ=r((oQ=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"container",sQ,l(e)),e}return e(h,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"hide",value:(c=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.uiOpacity).to(.2,{opacity:0}).call((function(){n.node.active=!1})),t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"show",value:(u=a(o().mark((function e(t,n){var i,r,a,s,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,this.uiOpacity.opacity=0,i=this.container.position.clone(),this.container.position=new q(i.x,i.y-100,i.z),(r=L(this.container).delay(t)).to(.2,{position:i},{easing:"cubicOut"}),(a=L(this.uiOpacity).delay(t)).to(.2,{opacity:255},{easing:"cubicOut"}),s=function(){l.container.position=i,l.uiOpacity.opacity=255},n.addAbortListener(s),e.next=12,Promise.all([Ue.runTweenAsync(r,n),Ue.runTweenAsync(a,n)]);case 12:n.removeAbortListener(s);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),h}(x)).prototype,"container",[rQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aQ=oQ))||aQ)||aQ);w._RF.pop(),w._RF.push({},"53da1+ne4RJ4p0kTjp52K/1","Leader",void 0);var s$,l$,u$,c$,p$,h$,d$,y$,f$,v$,m$,g$,b$,w$=S.ccclass,k$=S.property,S$=Ludex.Utils,C$=S$.Number,E$=S$.Signal,x$=(dQ=w$("Leader"),yQ=k$(Y),fQ=k$(M),vQ=k$({type:H,group:"Container"}),mQ=k$({type:N,group:"Background"}),gQ=k$({type:se,group:"Background"}),bQ=k$({type:N,group:"Rank"}),wQ=k$({type:Y,group:"Rank"}),kQ=k$({type:se,group:"Rank"}),SQ=k$({type:se,group:"Rank"}),CQ=k$({type:se,group:"Rank"}),EQ=k$({type:se,group:"Rank"}),xQ=k$({type:N,group:"Avatar"}),AQ=k$({type:M,group:"Avatar"}),TQ=k$({type:N,group:"Score"}),PQ=k$({type:Y,group:"Score"}),RQ=k$({type:se,group:"Score"}),LQ=k$({type:M,group:"Score"}),IQ=k$({type:M}),OQ=k$({type:A}),_Q=Ii.onlyRunInLifeCycle,DQ=Ii.onlyRunInLifeCycleAsync,MQ=Ii.onlyRunInLifeCycle,dQ((zQ=r((BQ=function(r){n(f,r);var u,c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"nameLabel",zQ,l(e)),s(e,"nameOpacity",FQ,l(e)),s(e,"container",UQ,l(e)),s(e,"background",GQ,l(e)),s(e,"highlightBackground",HQ,l(e)),s(e,"rankSprite",qQ,l(e)),s(e,"rankLabel",VQ,l(e)),s(e,"goldRank",WQ,l(e)),s(e,"silverRank",KQ,l(e)),s(e,"bronzeRank",jQ,l(e)),s(e,"highlightRank",YQ,l(e)),s(e,"avatar",JQ,l(e)),s(e,"avatarOpacity",ZQ,l(e)),s(e,"scoreBackground",XQ,l(e)),s(e,"scoreLabel",QQ,l(e)),s(e,"highlightScoreBackground",$Q,l(e)),s(e,"scoreOpacity",e$,l(e)),s(e,"uiOpacity",t$,l(e)),s(e,"uiTransform",n$,l(e)),e.signalController=new E$.SignalController,e}return e(f,[{key:"onLoad",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultRank=this.rankSprite.spriteFrame,this.defaultScoreBackground=this.scoreBackground.spriteFrame,this.defaultAvatar=this.avatar.spriteFrame,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e,t){this.updateBackground(e),this.updateRank(e,t),this.updatePhoto(e),this.updateUsername(e),this.updateScore(e)}},{key:"updateBackground",value:function(e){this.background.spriteFrame=e.isHighlight?this.highlightBackground:this.defaultBackground}},{key:"updateRank",value:function(e,t){var n=e.rank;this.rankLabel.string=t&&n>t?"".concat(t,"+"):n.toString(),this.rankSprite.spriteFrame=this.defaultRank;var i=new j(iz);switch(e.isHighlight&&(this.rankSprite.spriteFrame=this.highlightRank,i=new j(az)),n){case 1:this.rankSprite.spriteFrame=this.goldRank,i=new j($B);break;case 2:this.rankSprite.spriteFrame=this.silverRank,i=new j(ez);break;case 3:this.rankSprite.spriteFrame=this.bronzeRank,i=new j(tz)}this.rankLabel.shadowColor=i,this.rankLabel.outlineColor=i}},{key:"updatePhoto",value:(d=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.signalController.renew(),this.avatar){e.next=3;break}return e.abrupt("return");case 3:if(i=t.playerId,r=t.photo,!FO.isAvatarCached(t.playerId,70)){e.next=12;break}return e.next=7,FO.getPlayerAvatar(r,i,70,n);case 7:if((a=e.sent)&&!n.aborted){e.next=10;break}return e.abrupt("return");case 10:return this.setPhoto(a),e.abrupt("return");case 12:return this.avatar.spriteFrame=this.defaultAvatar,e.next=15,Ue.waitTweenAsync(.1,n);case 15:if(!n.aborted){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,FO.getPlayerAvatar(r,i,70,n);case 19:if((s=e.sent)&&!n.aborted){e.next=22;break}return e.abrupt("return");case 22:this.setPhoto(s);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"setPhoto",value:function(e){this.node.active&&(e.packable=!0,this.avatar.spriteFrame=e)}},{key:"updateUsername",value:function(e){this.nameLabel.string=e.name,this.nameLabel.color=new j(e.isHighlight?rz:nz)}},{key:"updateScore",value:function(e){var t=Math.floor(e.score);this.scoreLabel.string=C$.getShortNumber(t,7);var n=this.scoreLabel.getComponent(Y);n.outlineColor=new j(e.isHighlight?az:iz),n.shadowColor=new j(e.isHighlight?az:iz),this.scoreBackground.spriteFrame=e.isHighlight?this.highlightScoreBackground:this.defaultScoreBackground}},{key:"runShowUpAnimation",value:(h=a(o().mark((function e(t,n){var i,r,a,s,l,u=this,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]?c[2]:.3,this.setVisible(!1),r=this.container.position.clone(),this.container.position=new q(r.x,r.y-100,r.z),(a=L(this.container).delay(n)).to(i,{position:r},{easing:"backOut"}),(s=L(this.uiOpacity).delay(n)).to(i,{opacity:255},{easing:"cubicOut",onUpdate:function(){u.nameOpacity.opacity=u.uiOpacity.opacity,u.scoreOpacity.opacity=u.uiOpacity.opacity,u.avatarOpacity.opacity=u.uiOpacity.opacity}}),l=function(){u.enabledInHierarchy&&(u.container.position=r,u.uiOpacity.opacity=255,u.avatar.node.active=!0)},t.addAbortListener(l),e.next=12,Promise.all([Ue.runTweenAsync(a,t),Ue.runTweenAsync(s,t)]);case 12:t.removeAbortListener(l);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"runWorldPositionAnimation",value:(p=a(o().mark((function e(t,n,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=L(this.node).to(n,{worldPosition:t},{easing:"quadOut"}),e.next=3,Ue.runTweenAsync(r,i);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"runScaleAnimation",value:(c=a(o().mark((function e(t,n,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=L(this.node).to(n,{scale:new q(t,t,t)},{easing:"backOut"}),e.next=3,Ue.runTweenAsync(r,i);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"runUpdateDataAnimation",value:(u=a(o().mark((function e(t,n,i,r,a,s){var l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runOnUpdateAsync(this.node,a,(function(e){var a=Math.floor(t+(n-t)*e),o=Math.floor(i+(r-i)*e);l.updateRank({rank:a,isHighlight:!0}),l.updateScore({score:o,isHighlight:!0})}),s);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r,a){return u.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.nameOpacity.opacity=t,this.scoreOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),f}(x)).prototype,"nameLabel",[yQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FQ=r(BQ.prototype,"nameOpacity",[fQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UQ=r(BQ.prototype,"container",[vQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GQ=r(BQ.prototype,"background",[mQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HQ=r(BQ.prototype,"highlightBackground",[gQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qQ=r(BQ.prototype,"rankSprite",[bQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VQ=r(BQ.prototype,"rankLabel",[wQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WQ=r(BQ.prototype,"goldRank",[kQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KQ=r(BQ.prototype,"silverRank",[SQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jQ=r(BQ.prototype,"bronzeRank",[CQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YQ=r(BQ.prototype,"highlightRank",[EQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JQ=r(BQ.prototype,"avatar",[xQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZQ=r(BQ.prototype,"avatarOpacity",[AQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XQ=r(BQ.prototype,"scoreBackground",[TQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QQ=r(BQ.prototype,"scoreLabel",[PQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$Q=r(BQ.prototype,"highlightScoreBackground",[RQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e$=r(BQ.prototype,"scoreOpacity",[LQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t$=r(BQ.prototype,"uiOpacity",[IQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n$=r(BQ.prototype,"uiTransform",[OQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(BQ.prototype,"updateInfo",[_Q],Object.getOwnPropertyDescriptor(BQ.prototype,"updateInfo"),BQ.prototype),r(BQ.prototype,"updatePhoto",[DQ],Object.getOwnPropertyDescriptor(BQ.prototype,"updatePhoto"),BQ.prototype),r(BQ.prototype,"setPhoto",[MQ],Object.getOwnPropertyDescriptor(BQ.prototype,"setPhoto"),BQ.prototype),NQ=BQ))||NQ);w._RF.pop(),w._RF.push({},"173acdyc/VOnLkPsoSfdfnr","Leaders",void 0);var A$=S.ccclass,T$=S.property,P$=codex.player,R$=Ludex.Utils.Array,L$=(s$=A$("Leaders"),l$=T$(hU),u$=T$(x$),c$=T$(T),p$=Ii.onlyRunInLifeCycleAsync,h$=Ii.onlyRunInLifeCycleAsync,d$=Ii.onlyRunInLifeCycleAsync,y$=Ii.onlyRunInLifeCycleAsync,s$((m$=r((v$=function(r){n(g,r);var p,h,d,y,f,v,m=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=m.call.apply(m,[this].concat(i)),s(e,"scrollView",m$,l(e)),s(e,"tempLeader",g$,l(e)),s(e,"maxLeader",b$,l(e)),e.leaderData=[],e.displayLeaderData=[],e.displayPlayerLeader=null,e.isHidden=!0,e}return e(g,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(A),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"__preload",value:function(){this.currentPlayerId=P$.getPlayerId()}},{key:"updateData",value:(v=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isHidden=!1,this.leaderData=t,this.leaderData.forEach((function(e,t){e.rank=t+1})),this.setupDisplayLeadersData();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"initScrollViews",value:function(){var e=this;this.scrollView.setMaxNodeCount(this.leaderData.length),this.scrollView.init((function(t){var n=t.getComponent(x$),i=e.displayLeaderData[t.order];if(i){var r=i.playerId,a=i.photo,o=i.name,s=i.score;n.setVisible(!0),n.updateInfo({playerId:r,isHighlight:e.currentPlayerId===r,name:o,photo:a,rank:t.order+1,score:s},e.maxLeader)}}))}},{key:"playRankChangeAnimation",value:(f=a(o().mark((function e(t,n,i,r){var a,s,l,u,c,p,h,d,y,f,v,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n>=i)){e.next=2;break}return e.abrupt("return");case 2:if(a=this.displayLeaderData,s=R$.search(a,(function(e){return e.playerId===P$.getPlayerId()}))){e.next=6;break}return e.abrupt("return");case 6:if(l=s.rank,a[r-1]){e.next=10;break}return e.abrupt("return");case 10:if(u=this.scrollView.getNodeByOrder(s.rank-1)){e.next=13;break}return e.abrupt("return");case 13:if(c=null==u?void 0:u.getComponent(x$)){e.next=16;break}return e.abrupt("return");case 16:return c.setVisible(!1),this.tempLeader.setVisible(!0),this.tempLeader.updatePhoto({playerId:P$.getPlayerId(),photo:s.photo}),this.tempLeader.node.worldPosition=u.node.worldPosition.clone(),e.next=22,this.tempLeader.runScaleAnimation(1.1,.5,t);case 22:return p=Math.min(.5*(l-r),2),h=[this.tempLeader.runUpdateDataAnimation(l,r,n,i,p,t),this.scrollToLeaderRank(r,p,t)],d=this.scrollView.scrollView.getMaxScrollOffset().y,y=this.scrollView.getNodeScrollOffset(r-1),f=q.ZERO,y<0?f=new q(this.tempLeader.node.worldPosition.x,this.node.worldPosition.y+this.scrollView.getNodePosition(r-1).y+this.uiTransform.height/2,this.tempLeader.node.worldPosition.z):this.scrollView.scrollView.getScrollOffset().y>=d-5&&(y<d?f=new q(this.tempLeader.node.worldPosition.x,this.scrollView.viewport.node.worldPosition.y,this.tempLeader.node.worldPosition.z):(m=this.scrollView.getNodeByOrder(r-1),f=null!==(v=null==m?void 0:m.node.worldPosition.clone())&&void 0!==v?v:q.ZERO)),f.equals(q.ZERO)||h.push(this.tempLeader.runWorldPositionAnimation(f,p,t)),e.next=31,Promise.all(h);case 31:return e.next=33,Promise.all([this.tempLeader.runScaleAnimation(1,.25,t),this.playPostRankChangeAnimation(r,l,t)]);case 33:this.tempLeader.setVisible(!1),u.node.worldPosition=this.tempLeader.node.worldPosition.clone(),this.setupDisplayLeadersData(),this.scrollView.updateNodeVisibility(),this.scrollView.updateLayout();case 38:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return f.apply(this,arguments)})},{key:"playShowLeadersAnimation",value:(y=a(o().mark((function e(t){var n,i,r,s,l=this,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:.1,!this.isHidden){e.next=3;break}return e.abrupt("return");case 3:if(i=[],(r=this.scrollView.getAllNodes()).sort((function(e,t){return e.order-t.order})).forEach((function(e,t){var n=e.getComponent(x$);n.setVisible(t<l.leaderData.length),e.isVisible()&&i.push(n)})),!(i.length<1)){e.next=8;break}return e.abrupt("return");case 8:return i=i.slice(0,r.length-1),s=.3,e.next=12,Promise.all(i.map(function(){var e=a(o().mark((function e(i,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isHidden){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,i.runShowUpAnimation(t,r*n,s);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"scrollToPlayerLeader",value:(d=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.displayPlayerLeader){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.scrollToLeaderRank(this.displayPlayerLeader.rank,t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"updateDisplayPlayerLeaderForRankChanging",value:function(e,t,n){if(!this.displayPlayerLeader)return!1;this.displayPlayerLeader.score=e,this.displayLeaderData.sort((function(e,t){return t.score-e.score}));var i=this.displayLeaderData.indexOf(this.displayPlayerLeader)+1;return n===i?(this.displayPlayerLeader.score=t,this.displayPlayerLeader.rank=n,!1):(this.displayPlayerLeader.rank=i,this.tempLeader.updateInfo({playerId:P$.getPlayerId(),isHighlight:!0,name:this.displayPlayerLeader.name,photo:this.displayPlayerLeader.photo,rank:this.displayPlayerLeader.rank,score:e}),!0)}},{key:"hideLeaders",value:function(){this.isHidden=!0;var e,t=this.scrollView.getAllNodes().map((function(e){return e.getComponent(x$)})),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;null==i||i.setVisible(!1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"getLeaderData",value:function(){return this.leaderData}},{key:"setupDisplayLeadersData",value:function(){var e=this,t=R$.search(this.leaderData,(function(t){return t.playerId===e.currentPlayerId}));t?(this.displayLeaderData=this.leaderData.filter((function(t){return t.playerId!==e.currentPlayerId})),this.displayPlayerLeader=u({},t),this.displayLeaderData.splice(t.rank-1,0,this.displayPlayerLeader)):(this.displayPlayerLeader=null,this.displayLeaderData=this.leaderData)}},{key:"playPostRankChangeAnimation",value:(h=a(o().mark((function e(t,n,i){var r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null!=t?t:0,a=this.scrollView.getVisibleNodes().filter((function(e){return e.order>=r-1&&e.order<n})),s=a.map((function(e){return e.getComponent(x$)})),l=this.scrollView.nodeHeight+this.scrollView.spacing,u=[],s.forEach((function(e,t){var n=a[t];if(n){e.updateRank({rank:n.order+2,isHighlight:!1});var r=e.node.worldPosition.clone();u.push(e.runWorldPositionAnimation(r.add3f(0,-l,0),.25,i))}})),e.next=8,Promise.all(u);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"scrollToLeaderRank",value:(p=a(o().mark((function e(t,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scrollView.scrollToOrder(t-1,i,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})}]),g}(x)).prototype,"scrollView",[l$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g$=r(v$.prototype,"tempLeader",[u$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b$=r(v$.prototype,"maxLeader",[c$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(v$.prototype,"updateData",[p$],Object.getOwnPropertyDescriptor(v$.prototype,"updateData"),v$.prototype),r(v$.prototype,"playRankChangeAnimation",[h$],Object.getOwnPropertyDescriptor(v$.prototype,"playRankChangeAnimation"),v$.prototype),r(v$.prototype,"scrollToPlayerLeader",[d$],Object.getOwnPropertyDescriptor(v$.prototype,"scrollToPlayerLeader"),v$.prototype),r(v$.prototype,"scrollToLeaderRank",[y$],Object.getOwnPropertyDescriptor(v$.prototype,"scrollToLeaderRank"),v$.prototype),f$=v$))||f$);w._RF.pop(),w._RF.push({},"9f98ebQ6z1GMZv6FqGBHkpb","LeaderboardContentOverlay",void 0);var I$,O$=Ludex.Utils.Device,_$=function(){function n(){var e=this;t(this,n),this.overlayElements=[],this.getGameScaleFactor$=function(){var t=qe.DesignSize,n=t.Resolution,i=t.Portrait,r=t.Landscape,a=O$.pixelRatio(),o=He.getScreenWidthCss(),s=He.getScreenHeightCss(),l=e.isLandscape$(),u=o/(l?r.WIDTH:i.WIDTH),c=s/(l?r.HEIGHT:i.HEIGHT);switch(console.debug("🔥 Scale factor",{scaleX:u,scaleY:c,dpr:a,Resolution:n}),e.getViewResolutionPolicy$().getContentStrategy()){case Ne.ContentStrategy.FIXED_WIDTH:return u;case Ne.ContentStrategy.FIXED_HEIGHT:return c;default:return Math.max(u,c)}},this.getViewResolutionPolicy$=function(){return Be.getResolutionPolicy()},this.getScreenRatio$=function(){return He.getScreenWidthCss()/He.getScreenHeightCss()},this.isLandscape$=function(){var t=qe.AcceptPortraitRatio;switch(qe.PRIMARY_LAYOUT){case"landscape":return!0;case"portrait":return!1;default:return e.getScreenRatio$()>t}},this.createMainDiv()}var i,r;return e(n,[{key:"createMainDiv",value:function(){this.mainDiv=document.createElement("div"),this.mainDiv.style.position="absolute",this.mainDiv.style.width="95vw",this.mainDiv.style.height="calc(100vh - ".concat(441*this.getGameScaleFactor$(),"px)"),this.mainDiv.style.top="".concat(291*this.getGameScaleFactor$(),"px"),this.mainDiv.style.scrollbarWidth="none",this.mainDiv.style.alignItems="start",this.mainDiv.style.overflow="auto",this.mainDiv.style.backgroundColor="transparent",this.mainDiv.style.display="none",document.body.appendChild(this.mainDiv)}},{key:"updateOverlay",value:(r=a(o().mark((function e(t){var n,i,r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameSDK.isGameSDK("FacebookInstant")){e.next=2;break}return e.abrupt("return");case 2:if("overlayViews"in GameSDK){e.next=4;break}return e.abrupt("return");case 4:if(this.overlayElements.length>0){n=c(this.overlayElements);try{for(n.s();!(i=n.n()).done;)r=i.value,a=r.getIFrameElement(),this.mainDiv.removeChild(a)}catch(e){n.e(e)}finally{n.f()}this.overlayElements=[]}return s=this.validateOverlayPayload(t),e.prev=6,l=s.leaderboardPlayers.length,e.next=10,FBInstant.overlayViews.createOverlayViewAsync("wideframes/leaderboard-overlay/leaderboard-overlay.xml",this.mainDiv,this.getDefaultOverlayCss$(l),"wideframes/leaderboard-overlay/leaderboard-overlay-styles.css",s);case 10:u=e.sent,this.overlayElements=[u],this.appendOverlayElements(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(6),console.error("Error creating overlay view:",e.t0);case 18:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e){return r.apply(this,arguments)})},{key:"appendOverlayElements",value:function(){var e,t=c(this.overlayElements);try{for(t.s();!(e=t.n()).done;){e.value.showAsync()}}catch(e){t.e(e)}finally{t.f()}this.mainDiv.style.display="block",this.mainDiv.scrollTop=0}},{key:"validateOverlayPayload",value:function(e){var t,n={leaderboardPlayers:[]},i=/^\d+$/,r=c(e.leaderboardPlayers);try{for(r.s();!(t=r.n()).done;){var a=t.value;i.test(a.playerId)&&n.leaderboardPlayers.push(u(u({},a),{},{rank:a.rank.toString(),score:a.score.toString()}))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"hideOverlay",value:(i=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.overlayElements.length){e.next=2;break}return e.abrupt("return");case 2:e.prev=2,t=c(this.overlayElements),e.prev=4,t.s();case 6:if((n=t.n()).done){e.next=14;break}return(i=n.value).getIFrameElement().style.display="none",e.next=12,i.dismissAsync();case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),t.e(e.t0);case 19:return e.prev=19,t.f(),e.finish(19);case 22:this.overlayElements=[],this.mainDiv.style.display="none",this.mainDiv.innerHTML="",e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),console.error("Hide overlay failed:",e.t1);case 30:case"end":return e.stop()}}),e,this,[[2,27],[4,16,19,22]])}))),function(){return i.apply(this,arguments)})},{key:"getDefaultOverlayCss$",value:function(e){var t="height: calc(95vw * (121 / 1000) * ".concat(e," + (12px * ").concat(e,"));");return"".concat("width: 95vw;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat(t,"   ")}}]),n}();w._RF.pop(),w._RF.push({},"332aaP3dkhKxZNHiMFB1bKn","LeaderboardIsEmpty",void 0);var D$,M$,N$,B$,z$,F$,U$,G$,H$,q$,V$,W$,K$,j$,Y$,J$,Z$,X$,Q$,$$,e0,t0,n0,i0,r0,a0,o0,s0,l0,u0,c0=(0,S.ccclass)("LeaderboardIsEmpty")(I$=function(r){n(u,r);var s,l=i(u);function u(){return t(this,u),l.apply(this,arguments)}return e(u,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"show",value:(s=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uiOpacity.opacity=255,t=this.node.position.clone(),(n=L(this.node)).to(.05,{position:t.clone().add3f(5,0,0)}),n.to(.05,{position:t.clone().add3f(-5,0,0)}),(i=L(this.node).repeat(2,n)).to(.05,{position:t}),e.next=9,Ue.runTweenAsync(i);case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"hide",value:function(){this.uiOpacity.opacity=0}}]),u}(x))||I$;w._RF.pop(),w._RF.push({},"2aa67vEWR9HaJkCtpsuUyRX","LeaderboardContent",void 0);var p0,h0,d0,y0,f0,v0,m0,g0,b0=S.ccclass,w0=S.property,k0=codex,S0=k0.storage,C0=k0.leaderboard,E0=k0.player,x0=k0.monitorError,A0=Ludex,T0=A0.Utils.Object,P0=A0.Configs.Leaderboards,R0=function(r){n(o,r);var a=i(o);function o(e){var n;return t(this,o),(n=a.call(this,e)).name="EmptyLeaderboardError",n}return e(o)}(y(Error)),L0=(D$=b0("LeaderboardContent"),M$=Ii.required(),N$=w0(nQ),B$=Ii.required(),z$=w0(hQ),F$=Ii.required(),U$=w0({type:L$,group:"Leaderboard"}),G$=w0({type:[o$],group:"Leaderboard"}),H$=Ii.required(),q$=w0({type:c0,group:"Leaderboard"}),V$=Ii.required(),W$=w0(Ao),K$=Ii.required(),j$=w0(CX),Y$=Ii.onlyRunInLifeCycleAsync,J$=Ii.onlyRunInLifeCycleAsync,Z$=Ii.onlyRunInLifeCycleAsync,X$=Ii.onlyRunInLifeCycleAsync,Q$=Ii.onlyRunInLifeCycleAsync,$$=Ii.onlyRunInLifeCycleAsync,e0=Ii.onlyRunInLifeCycle,D$((i0=r((n0=function(r){n(g,r);var u,c,p,h,d,y,f,v,m=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=m.call.apply(m,[this].concat(i)),s(e,"tabs",i0,l(e)),s(e,"timer",r0,l(e)),s(e,"leaders",a0,l(e)),s(e,"leaderSkeletons",o0,l(e)),s(e,"leaderboardIsEmpty",s0,l(e)),s(e,"contentOpacity",l0,l(e)),s(e,"joinLeaderboardContainer",u0,l(e)),e.isHidden=!0,e.currentLb=null,e.animAbortSignal=new An,e.hasPlayedAppearAnim={friends:!1,global:!1,global_weekly:!1},e.handleViewResized=function(){e.updateJoinLeaderboardButton()},e.handleWeeklyTabSelected=a(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S0.setStorageData("leaderboard_content","lastTabOpened",qd),e.cleanupSideEffects(),n=e.animAbortSignal,t.prev=3,t.next=6,e.updateStatus(n,qd);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),n.call((function(){var e=t.t0 instanceof Error?t.t0:new Error("Unknown error during loading global weekly leaderboard.");console.error("LeaderboardContent",e),null==x0||x0.sendException(e),nt.showNotificationScreenWithLocalizedKey("error.noFriendsLb",2)}));case 11:case"end":return t.stop()}}),t,null,[[3,8]])}))),e.handleDailyTabSelected=a(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S0.setStorageData("leaderboard_content","lastTabOpened",Hd),e.cleanupSideEffects(),n=e.animAbortSignal,t.prev=3,t.next=6,e.updateStatus(n,Hd);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),n.call((function(){var e=t.t0 instanceof Error?t.t0:new Error("Unknown error during loading global leaderboard.");console.error("LeaderboardContent",e),null==x0||x0.sendException(e),nt.showNotificationScreenWithLocalizedKey("error.noWorldLb",2)}));case 11:case"end":return t.stop()}}),t,null,[[3,8]])}))),e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(g,[{key:"__preload",value:function(){var e,t;this.leaders.maxLeader=null!==(e=null===(t=P0.LeaderboardList[0])||void 0===t?void 0:t.Limit)&&void 0!==e?e:0}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this),this.leaderboardContentOverlay=new _$,this.hideSkeletons()}},{key:"listenEvents",value:function(){O.on(Ge.VIEW_RESIZED,this.handleViewResized),this.node.scene.on(QB.WEEKLY_TAB_SELECTED,this.handleWeeklyTabSelected),this.node.scene.on(QB.WORLD_TAB_SELECTED,this.handleDailyTabSelected),this.node.scene.on(Us.HIDE_UI,this.hideContent),this.node.scene.on(Us.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){O.off(Ge.VIEW_RESIZED,this.handleViewResized),this.node.scene.off(QB.WEEKLY_TAB_SELECTED,this.handleWeeklyTabSelected),this.node.scene.off(QB.WORLD_TAB_SELECTED,this.handleDailyTabSelected),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Us.HIDE_UI,this.hideContent),this.node.scene.off(Us.SHOW_UI,this.showContent)}},{key:"loadLeaderboard",value:(v=a(o().mark((function e(t,n){var i,r,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=this.getLeaderboardName(t))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.callAsync((function(){return C0.requestLeaderboardAsync(i,s.leaders.maxLeader)}));case 5:return n.call((function(){var e=C0.getLeaderboard(i);s.currentLb=null!=e?e:s.currentLb})),e.next=8,n.callAsync(a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.loadPlayerLeaderData(t));case 1:case"end":return e.stop()}}),e)}))));case 8:if(!this.currentLb){e.next=13;break}return(r=T0.vals(this.currentLb.leaders)).sort((function(e,t){return t.score-e.score})),e.next=13,this.updateLeaderboardOverlay(r);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"getLeaderboardName",value:function(e){var t=e===qd?Gd.WEEKLY:Gd.DAILY;return C0.getLeaderboardName(t)}},{key:"showLoading",value:(f=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideSkeletons(),e.next=3,Promise.all([this.leaders.scrollView.unlistenEvents(),this.leaders.scrollView.scrollToTop(t).then((function(){n.leaders&&(n.leaders.scrollView.scrollView.enabled=!1,n.leaders.scrollView.listenEvents())}))]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"hideLoading",value:(y=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.hideSkeletons();case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"hideSkeletons",value:function(){this.leaderSkeletons.forEach((function(e){e.node.active=!1}))}},{key:"showSkeletons",value:function(){this.leaderSkeletons.forEach((function(e){e.node.active=!0}))}},{key:"entering",value:function(){this.timer.reset(),this.isHidden=!1;var e=S0.getStorageData("leaderboard_content","lastTabOpened");e===qd?this.handleWeeklyTabSelected():e===Hd&&this.handleDailyTabSelected()}},{key:"hide",value:function(){this.isHidden=!0}},{key:"cleanup",value:function(){this.leaders.scrollView.unlistenEvents(),this.unlistenEvents(),this.cleanupSideEffects(),this.hideSkeletons(),this.leaderboardContentOverlay.hideOverlay()}},{key:"cleanupSideEffects",value:function(){this.animAbortSignal.abort(),this.animAbortSignal=new An,this.hideSkeletons(),this.leaders.hideLeaders(),this.leaderboardIsEmpty.hide(),this.joinLeaderboardContainer.hide()}},{key:"updateStatus",value:(d=a(o().mark((function e(t,n){var i,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!this.isHidden){e.next=4;break}return e.abrupt("return");case 4:return this.tabs.updateStatus(n),this.timer.setTimeLabel(),e.prev=6,e.next=9,this.showLoading(t);case 9:return e.next=11,this.loadLeaderboard(n,t);case 11:if(this.hideLoading(t),t.call((function(){var e,n,i;null===(e=r.timer)||void 0===e||e.setTimeLabel(null===(n=r.currentLb)||void 0===n?void 0:n.resettable),null===(i=r.timer)||void 0===i||i.show(t)})),GameSDK.extra.isGuest){e.next=15;break}return e.abrupt("return");case 15:return this.updateJoinLeaderboardButton(),e.next=18,null===(i=this.joinLeaderboardContainer)||void 0===i?void 0:i.show(t);case 18:e.next=25;break;case 20:if(e.prev=20,e.t0=e.catch(6),e.t0 instanceof R0){e.next=24;break}throw e.t0;case 24:t.call((function(){var e,n,i;r.leaderboardIsEmpty.show(),r.leaders.scrollView.setMaxNodeCount(0),r.hideLoading(t),null===(e=r.timer)||void 0===e||e.setTimeLabel(null===(n=r.currentLb)||void 0===n?void 0:n.resettable),null===(i=r.timer)||void 0===i||i.show(t)}));case 25:case"end":return e.stop()}}),e,this,[[6,20]])}))),function(e,t){return d.apply(this,arguments)})},{key:"playLeadersShowupAnimation",value:(h=a(o().mark((function e(t,n){var i,r,a,s,l,u,c,p,h=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentLb){e.next=2;break}return e.abrupt("return");case 2:return i=E0.getPlayerId(),r=this.currentLb.leaders[i],a=S0.getStorage("leaderboard_content"),s=a.previousScore,(l=T0.vals(this.currentLb.leaders)).sort((function(e,t){return t.score-e.score})),GameSDK.extra.isGuest&&(l=l.slice(0,5)),u=r&&-1!==s&&s<r.score&&r.rank<=this.leaders.maxLeader,c=!1,u&&(c=this.leaders.updateDisplayPlayerLeaderForRankChanging(s,r.score,r.rank)),this.leaders.initScrollViews(),this.leaders.scrollView.scrollView.enabled=!0,p=this.hasPlayedAppearAnim[t]?0:.1,e.next=16,n.callAsync((function(){return h.leaders.playShowLeadersAnimation(n,p)}));case 16:if(this.hasPlayedAppearAnim[t]=!0,r){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,n.callAsync((function(){return h.leaders.scrollToPlayerLeader(1,n)}));case 21:if(c&&-1!==s){e.next=23;break}return e.abrupt("return");case 23:return e.next=25,n.callAsync((function(e){return h.leaders.playRankChangeAnimation(e,s,r.score,r.rank)}));case 25:S0.setStorageData("leaderboard_content","previousScore",r.score);case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"updateLeaderboardOverlay",value:(p=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.map((function(e){return{playerId:e.playerId,rank:e.rank,score:e.score}})),e.next=4,this.leaderboardContentOverlay.updateOverlay({leaderboardPlayers:n});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn("Failed to update leaderboard overlay:",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return p.apply(this,arguments)})},{key:"loadPlayerLeaderData",value:(c=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=E0.getPlayerId(),null!==this.currentLb){e.next=3;break}throw new Error("LeaderboardContent: Leaderboard is not found.");case 3:if(i=this.currentLb.leaders,0!==Object.keys(i).length){e.next=6;break}throw new R0("LeaderboardContent: Leaderboard is empty.");case 6:if(!i[n]){e.next=9;break}return e.abrupt("return");case 9:if(null!==(r=this.getLeaderboardName(t))){e.next=12;break}throw new Error("LeaderboardContent: Leaderboard name is not found.");case 12:return e.next=14,C0.getLeadersByPlayerIdsAsync(r,[n]);case 14:if(0!==(a=e.sent).length){e.next=17;break}return e.abrupt("return");case 17:if(s=a[0]){e.next=20;break}return e.abrupt("return");case 20:i[n]=s;case 21:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateJoinLeaderboardButton",value:function(){if(GameSDK.extra.isGuest){var e=void 0,t=this.leaders.scrollView.getVisibleNodes();if(0===t.length)e=this.leaders.scrollView.viewport.getBoundingBoxToWorld().center.y;else{var n=t[t.length-1],i=this.joinLeaderboardContainer.uiTransform.height,r=n.node.worldPosition.y-i-20;r-i/2>=this.leaders.scrollView.viewport.getBoundingBoxToWorld().yMin&&(e=r)}this.joinLeaderboardContainer.updatePosition(e)}}},{key:"handleJoinLeaderboard",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"initPlayerAsync"in GameSDK.player){e.next=3;break}return e.abrupt("return");case 3:return nt.showLoadingScreen(),e.next=6,GameSDK.player.initPlayerAsync();case 6:if(nt.closeLoadingScreen(),!GameSDK.extra.isGuest){e.next=10;break}return nt.showNotificationScreenWithLocalizedKey("error.joinLb",1),e.abrupt("return");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),nt.closeLoadingScreen(),nt.showNotificationScreenWithLocalizedKey("error.joinLb",1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),function(){return u.apply(this,arguments)})}]),g}(x)).prototype,"tabs",[M$,N$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r0=r(n0.prototype,"timer",[B$,z$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a0=r(n0.prototype,"leaders",[F$,U$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o0=r(n0.prototype,"leaderSkeletons",[G$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),s0=r(n0.prototype,"leaderboardIsEmpty",[H$,q$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l0=r(n0.prototype,"contentOpacity",[V$,W$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u0=r(n0.prototype,"joinLeaderboardContainer",[K$,j$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(n0.prototype,"loadLeaderboard",[Y$],Object.getOwnPropertyDescriptor(n0.prototype,"loadLeaderboard"),n0.prototype),r(n0.prototype,"showLoading",[J$],Object.getOwnPropertyDescriptor(n0.prototype,"showLoading"),n0.prototype),r(n0.prototype,"hideLoading",[Z$],Object.getOwnPropertyDescriptor(n0.prototype,"hideLoading"),n0.prototype),r(n0.prototype,"updateStatus",[X$],Object.getOwnPropertyDescriptor(n0.prototype,"updateStatus"),n0.prototype),r(n0.prototype,"playLeadersShowupAnimation",[Q$],Object.getOwnPropertyDescriptor(n0.prototype,"playLeadersShowupAnimation"),n0.prototype),r(n0.prototype,"loadPlayerLeaderData",[$$],Object.getOwnPropertyDescriptor(n0.prototype,"loadPlayerLeaderData"),n0.prototype),r(n0.prototype,"updateJoinLeaderboardButton",[e0],Object.getOwnPropertyDescriptor(n0.prototype,"updateJoinLeaderboardButton"),n0.prototype),t0=n0))||t0);w._RF.pop(),w._RF.push({},"ae514KD4phHMYC0AD3CIw68","LeaderboardPage",void 0);var I0,O0,_0,D0,M0,N0,B0,z0,F0,U0,G0,H0,q0,V0,W0,K0,j0,Y0,J0,Z0;p0=(0,S.ccclass)("LeaderboardPage"),h0=Ii.required(),d0=Ii.onlyRunInLifeCycleAsync,y0=Ii.onlyRunInLifeCycleAsync,f0=Ii.onlyRunInLifeCycleAsync,p0((g0=r((m0=function(r){n(v,r);var u,c,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"panelAnimationController",g0,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(al),p(h(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(h(v.prototype),"start",this).call(this);case 1:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"mount",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"mount",this).call(this);case 2:if(this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(L0),this.content){e.next=6;break}throw new Error("LeaderboardPage: Leaders not found");case 6:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"transitionIn",value:(c=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.content.entering(),e.next=3,p(h(v.prototype),"transitionIn",this).call(this);case 3:return t=Ue.runTweenAsync(L(this.containerUIOpacity).to(.2,{opacity:255})),n=this.panelAnimationController.showUI(),this.content.listenEvents(),e.next=8,Promise.all([t,n]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"transitionOut",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"transitionOut",this).call(this);case 2:return this.content.unlistenUIEvents(),e.next=5,this.panelAnimationController.hideUI();case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"unmount",value:function(){var e,t;null===(e=this.content)||void 0===e||e.hide(),null===(t=this.content)||void 0===t||t.cleanup(),p(h(v.prototype),"unmount",this).call(this)}}]),v}(Jj)).prototype,"panelAnimationController",[h0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(m0.prototype,"mount",[d0],Object.getOwnPropertyDescriptor(m0.prototype,"mount"),m0.prototype),r(m0.prototype,"transitionIn",[y0],Object.getOwnPropertyDescriptor(m0.prototype,"transitionIn"),m0.prototype),r(m0.prototype,"transitionOut",[f0],Object.getOwnPropertyDescriptor(m0.prototype,"transitionOut"),m0.prototype),v0=m0));w._RF.pop(),w._RF.push({},"0d1c02Npp9IXrjlFdl8co2L","TopLeader",void 0);var X0,Q0,$0,e1,t1,n1,i1,r1,a1,o1,s1,l1,u1,c1,p1,h1,d1,y1,f1,v1,m1,g1,b1,w1,k1,S1,C1,E1,x1,A1,T1,P1,R1,L1,I1,O1,_1,D1,M1,N1,B1,z1=S.ccclass,F1=S.property,U1=Ludex.Utils.Number,G1=(I0=z1("TopLeader"),O0=F1(Y),_0=F1(H),D0=F1({type:N}),M0=F1({type:ze}),N0=F1({type:M}),B0=F1({type:Y}),z0=F1({type:M}),F0=Ii.onlyRunInLifeCycle,U0=Ii.onlyRunInLifeCycleAsync,G0=Ii.onlyRunInLifeCycleAsync,I0((V0=r((q0=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"nameLabel",V0,l(e)),s(e,"defaultAvatar",W0,l(e)),s(e,"avatar",K0,l(e)),s(e,"mask",j0,l(e)),s(e,"avatarOpacity",Y0,l(e)),s(e,"scoreLabel",J0,l(e)),s(e,"uiOpacity",Z0,l(e)),e.signal=new An,e}return e(d,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e){this.updateUsername(e),this.updatePhoto(e),this.updateScore(e)}},{key:"updateUsername",value:function(e){this.nameLabel&&(this.nameLabel.string=e.name)}},{key:"updatePhoto",value:(p=a(o().mark((function e(t){var n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.signal.abort(),n=new An,this.signal=n,this.mask.enabled=!1,this.defaultAvatar.active=!FO.isAvatarCached(t.playerId,128),this.avatar.spriteFrame=null,i=t.playerId,r=t.photo,e.next=9,FO.getPlayerAvatar(r,i,128,n);case 9:if((a=e.sent)&&!n.aborted){e.next=12;break}return e.abrupt("return");case 12:this.setPhoto(a);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setPhoto",value:(c=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.node.active){e.next=2;break}return e.abrupt("return");case 2:return t.packable=!0,this.avatar.spriteFrame=t,n=L(this.avatarOpacity).to(.2,{opacity:255}),e.next=7,Ue.runTweenAsync(n,this.signal);case 7:if(this.enabledInHierarchy){e.next=9;break}return e.abrupt("return");case 9:this.mask.enabled=!0,this.defaultAvatar.active=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateScore",value:function(e){if(this.scoreLabel){var t=Math.floor(e.score);this.scoreLabel.string=U1.getShortNumber(t,7)}}},{key:"runShowUpAnimation",value:(u=a(o().mark((function e(t){var n,i,r,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:.3,i=s.length>2?s[2]:void 0,this.node.scale=q.ZERO,r=L(this.node).delay(t).to(n,{scale:new q(1,1,1)},{easing:"backOut"}),a=L(this.uiOpacity).delay(t).to(n,{opacity:255}),e.next=7,Promise.all([Ue.runTweenAsync(r,i),Ue.runTweenAsync(a,i)]);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),d}(x)).prototype,"nameLabel",[O0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W0=r(q0.prototype,"defaultAvatar",[_0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0=r(q0.prototype,"avatar",[D0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0=r(q0.prototype,"mask",[M0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y0=r(q0.prototype,"avatarOpacity",[N0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J0=r(q0.prototype,"scoreLabel",[B0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z0=r(q0.prototype,"uiOpacity",[z0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(q0.prototype,"updateInfo",[F0],Object.getOwnPropertyDescriptor(q0.prototype,"updateInfo"),q0.prototype),r(q0.prototype,"updatePhoto",[U0],Object.getOwnPropertyDescriptor(q0.prototype,"updatePhoto"),q0.prototype),r(q0.prototype,"setPhoto",[G0],Object.getOwnPropertyDescriptor(q0.prototype,"setPhoto"),q0.prototype),H0=q0))||H0);w._RF.pop(),w._RF.push({},"8cd04RxbahLDaxq9FJf6hBh","TournamentBlock",void 0);var H1,q1,V1,W1,K1,j1=S.ccclass,Y1=S.property,J1=codex,Z1=J1.leaderboard,X1=J1.player,Q1=J1.language,$1=Ludex.Utils,e2=$1.Time,t2=$1.Object,n2=$1.Array,i2=$1.Number,r2=(X0=j1("TournamentBlock"),Q0=Ii.required,$0=Y1(H),e1=Ii.required,t1=Y1(Y),n1=Ii.required,i1=Y1({type:cp,group:"Localize"}),r1=Ii.required,a1=Y1({type:cp,group:"Localize"}),o1=Ii.required,s1=Y1({type:cp,group:"Localize"}),l1=Ii.required,u1=Y1({type:cp,group:"Localize"}),c1=Ii.required,p1=Y1(A),h1=Ii.required,d1=Y1(M),y1=Ii.required,f1=Y1({type:N,group:"Banner"}),v1=Ii.required,m1=Y1({type:H,group:"Banner"}),g1=Ii.required,b1=Y1({type:H,group:"Banner"}),w1=Ii.required,k1=Y1(G1),S1=Ii.onlyRunInLifeCycleAsync,C1=Ii.onlyRunInLifeCycle,X0((A1=r((x1=function(r){n(v,r);var u,c,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"container",A1,l(e)),s(e,"title",T1,l(e)),s(e,"titleLocalizer",P1,l(e)),s(e,"timeLocalizer",R1,l(e)),s(e,"playerCountLocalizer",L1,l(e)),s(e,"playButtonLocalize",I1,l(e)),s(e,"uiTransform",O1,l(e)),s(e,"uiOpacity",_1,l(e)),s(e,"banner",D1,l(e)),s(e,"bannerMask",M1,l(e)),s(e,"bannerLoadingRing",N1,l(e)),s(e,"topLeader",B1,l(e)),e.hasPlayedAnimation=!1,e}return e(v,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,v)}},{key:"updateInfo",value:(y=a(o().mark((function e(t){var n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.payload=t,n=t.endTime,i=t.title,r=t.payload.playerName,a=t.tournamentType,s=t.payload,l=s.leaderboardId,u=s.themeId,c=void 0===u?ut.AUTUMN:u,l){e.next=5;break}return e.abrupt("return");case 5:return this.topLeader.setVisible(!1),this.topLeader.node.active=!1,this.setPlayerCountWaiting(),"PAGE_HOSTED"===a?this.updateTitleTournamentTitle(i):this.updateTitleWithPlayerName(null!=r?r:i),this.updateEndTime(n),this.updateTournamentBanner(c),p={leaders:[],amountPlayer:0},e.next=14,this.fetchAndUpdateLeadersPayload(l,p,i);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"fetchAndUpdateLeadersPayload",value:(d=a(o().mark((function e(t,n,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n,e.prev=1,e.next=4,this.getLeadersPayload(t);case 4:(a=e.sent)&&(r=a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Fetch lb for tournament ".concat(i),e.t0);case 11:this.updateLeadersPayload(r);case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e,t,n){return d.apply(this,arguments)})},{key:"updateLeadersPayload",value:function(e){this.leadersPayload=e;var t=this.leadersPayload,n=t.player,i=t.amountPlayer,r=t.leaders;this.updatePlayerCount(i),this.updatePlayButtonLabel(void 0!==n),this.updateTopLeader(null!=r?r:[])}},{key:"updateTitleWithPlayerName",value:function(e){void 0!==e&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([e]))}},{key:"updateTitleTournamentTitle",value:function(e){this.titleLocalizer.enabled=!1,this.title.string=e}},{key:"updateEndTime",value:function(e){try{var t=e2.getRelativeTime(e,Q1.getCurrentLocale());this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([t])}catch(e){this.timeLocalizer.key="game.endsSoon"}}},{key:"updatePlayerCount",value:function(e){var t=i2.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"updateTopLeader",value:(h=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return");case 2:if(n=t[0]){e.next=5;break}return e.abrupt("return");case 5:Ludex.Configs.Mockup.Leaderboards.Enabled&&(n=null!==(i=n2.search(t,(function(e){return 1===e.rank})))&&void 0!==i?i:n),this.topLeader.node.active=!0,this.topLeader.updateInfo(n),this.topLeader.runShowUpAnimation(0,.2);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"updateTournamentBanner",value:(p=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Fe.getAsset("".concat(ht[t],"/spriteFrame"),se)){e.next=7;break}return this.bannerMask.active=!0,this.bannerLoadingRing.active=!0,e.next=6,Fe.loadThemePreviewAsync(t);case 6:n=e.sent;case 7:if(n){e.next=11;break}return e.next=10,Fe.loadThemePreviewAsync(ut.SUMMER);case 10:n=e.sent;case 11:if(this.banner&&n){e.next=13;break}return e.abrupt("return");case 13:this.banner.spriteFrame=n,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"updatePlayButtonLabel",value:function(e){this.playButtonLocalize.key=e?"game.continue":"game.join"}},{key:"getLeadersPayload",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Z1.getLeaderboardName(t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,pI.getAllLeaderboardAsync(t);case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return(a=t2.vals(r.leaders)).sort((function(e,t){return e.rank-t.rank})),s=X1.getPlayerId(),e.next=13,Z1.getLeadersByPlayerIdsAsync(i,[s]);case 13:return l=e.sent,u={leaders:a,amountPlayer:null!==(n=r.amountPlayer)&&void 0!==n?n:0},l.length>0&&(u.player=l[0]),e.abrupt("return",u);case 17:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"runShowPopUpAnimation",value:(u=a(o().mark((function e(t,n,i){var r,a,s,l,u,c=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.scale=new q(.8,.8,.8),this.uiOpacity.opacity=0,r=this.container.position.clone(),this.container.position=new q(r.x,r.y-100,r.z),(a=L(this.node).delay(t)).to(n,{scale:q.ONE},{easing:"elasticOut"}),(s=L(this.container).delay(t)).to(n,{position:r},{easing:"backOut"}),(l=L(this.uiOpacity).delay(t)).to(n,{opacity:255},{easing:"cubicOut"}),u=function(){c.node.setScale(q.ONE),c.container.setPosition(r),c.uiOpacity.opacity=255},i.addAbortListener(u),e.next=14,Promise.all([Ue.runTweenAsync(a,i),Ue.runTweenAsync(s,i),Ue.runTweenAsync(l,i)]);case 14:i.removeAbortListener(u);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"handleOnTournamentClicked",value:function(){var e=this.payload.id||"";if(rt.validateTournamentExpired(e))return this.node.scene.emit(Vd.RELOAD_TOURNAMENT),void nt.showNotificationScreenWithLocalizedKey("error.tourEnded",2);try{var t=JSON.stringify(this.payload),n=this.leadersPayload.player?"tournament_end":"tournament_start";nt.showTournamentDetailScreen(t,n,this.hasPlayedAnimation),this.hasPlayedAnimation=!0}catch(e){console.warn("handleOnTournamentClicked",e)}}}]),v}(x)).prototype,"container",[Q0,$0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T1=r(x1.prototype,"title",[e1,t1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P1=r(x1.prototype,"titleLocalizer",[n1,i1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R1=r(x1.prototype,"timeLocalizer",[r1,a1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=r(x1.prototype,"playerCountLocalizer",[o1,s1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I1=r(x1.prototype,"playButtonLocalize",[l1,u1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O1=r(x1.prototype,"uiTransform",[c1,p1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_1=r(x1.prototype,"uiOpacity",[h1,d1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D1=r(x1.prototype,"banner",[y1,f1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M1=r(x1.prototype,"bannerMask",[v1,m1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N1=r(x1.prototype,"bannerLoadingRing",[g1,b1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B1=r(x1.prototype,"topLeader",[w1,k1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(x1.prototype,"fetchAndUpdateLeadersPayload",[S1],Object.getOwnPropertyDescriptor(x1.prototype,"fetchAndUpdateLeadersPayload"),x1.prototype),r(x1.prototype,"updateLeadersPayload",[C1],Object.getOwnPropertyDescriptor(x1.prototype,"updateLeadersPayload"),x1.prototype),E1=x1))||E1);w._RF.pop(),w._RF.push({},"a409buwLfZLQq7cmBGiqhF5","TournamentBlockSkeleton",void 0);var a2,o2,s2,l2,u2,c2,p2,h2,d2,y2,f2,v2=S.ccclass,m2=S.property,g2=(H1=v2("TournamentBlockSkeleton"),q1=m2(H),H1((K1=r((W1=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"container",K1,l(e)),e}return e(h,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"hide",value:(c=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.uiOpacity).to(.2,{opacity:0}).call((function(){n.node.active=!1})),t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"show",value:(u=a(o().mark((function e(t,n){var i,r,a,s,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,this.node.scale=new q(.8,.8,.8),this.uiOpacity.opacity=0,i=this.container.position.clone(),this.container.position=new q(i.x,i.y-100,i.z),(r=L(this.node).delay(t)).to(.2,{scale:q.ONE},{easing:"elasticOut"}),(a=L(this.container).delay(t)).to(.2,{position:i},{easing:"backOut"}),(s=L(this.uiOpacity).delay(t)).to(.2,{opacity:255},{easing:"cubicOut"}),l=function(){u.node.setScale(q.ONE),u.container.setPosition(i),u.uiOpacity.opacity=255},n.addAbortListener(l),e.next=15,Promise.all([Ue.runTweenAsync(r,n),Ue.runTweenAsync(a,n),Ue.runTweenAsync(s,n)]);case 15:n.removeAbortListener(l);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})}]),h}(x)).prototype,"container",[q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V1=W1))||V1);w._RF.pop(),w._RF.push({},"5f82fye3oxHQrxKbP9TC2di","TournamentsBoard",void 0);var b2,w2=S.ccclass,k2=S.property,S2=codex.player,C2=(a2=w2("TournamentsBoard"),o2=k2(ye),s2=k2(I),l2=k2(H),u2=k2(A),a2((h2=r((p2=function(r){n(h,r);var u,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"tournamentBlockPrefab",h2,l(e)),e.tournamentBlockArray=[],s(e,"layout",d2,l(e)),s(e,"createTournamentButton",y2,l(e)),s(e,"viewport",f2,l(e)),e}return e(h,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"start",value:function(){for(var e=0;e<6;e++)this.addTournamentBlock();var t=this.tournamentBlockArray[0];t&&(this.tournamentBlockContentHeight=t.uiTransform.contentSize.height+this.layout.spacingY)}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateData",value:function(e){var t=this,n=!1;e.forEach((function(e,i){var r=t.tournamentBlockArray[i];e.payload.playerId===S2.getPlayerId()&&(n=!0),r||(r=t.addTournamentBlock()),r.node.active=!0,r.updateInfo(e)})),n||this.setCreateTournamentButtonActive(!0)}},{key:"addTournamentBlock",value:function(){var e=he(this.tournamentBlockPrefab);this.layout.node.addChild(e),e.active=!1;var t=e.getComponent(r2);return this.tournamentBlockArray.push(t),t}},{key:"removeTournamentBlocks",value:function(){var e,t=this.getActiveTournamentBlocks(),n=c(t);try{for(n.s();!(e=n.n()).done;){e.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}this.setCreateTournamentButtonActive(!1)}},{key:"getActiveTournamentBlocks",value:function(){var e=this;return this.tournamentBlockArray.filter((function(t){return t.node.parent===e.layout.node}))}},{key:"setCreateTournamentButtonActive",value:function(e){GameSDK.isGameSDK("FacebookInstant")&&(e?this.layout.node.addChild(this.createTournamentButton):this.layout.node.removeChild(this.createTournamentButton),this.createTournamentButton.active=e)}},{key:"showTournamentBlocks",value:(u=a(o().mark((function e(t,n){var i,r,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=this.getActiveTournamentBlocks()).length<1)){e.next=3;break}return e.abrupt("return");case 3:return r=Math.ceil(t/this.tournamentBlockContentHeight),s=Math.min(i.length,r),e.next=8,Promise.all(i.map(function(){var e=a(o().mark((function e(t,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<s)){e.next=4;break}return e.next=3,t.runShowPopUpAnimation(.1*i,.3,n);case 3:return e.abrupt("return");case 4:t.uiOpacity.opacity=255;case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"updateVisibility",value:function(){var e,t=this.viewport.getBoundingBoxToWorld(),n=t.yMax,i=t.yMin,r=this.getActiveTournamentBlocks(),a=c(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=o.uiTransform;if(void 0!==s){var l=s.getBoundingBoxToWorld(),u=l.yMax,p=l.yMin,h=u<i||p>n;o.uiOpacity.opacity=h?0:255}}}catch(e){a.e(e)}finally{a.f()}}}]),h}(x)).prototype,"tournamentBlockPrefab",[o2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d2=r(p2.prototype,"layout",[s2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y2=r(p2.prototype,"createTournamentButton",[l2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f2=r(p2.prototype,"viewport",[u2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c2=p2))||c2);w._RF.pop(),w._RF.push({},"f8a7b0St3FAkb1PvvvJTLCh","TournamentsNotAvailable",void 0);var E2,x2,A2,T2,P2,R2,L2,I2,O2,_2,D2,M2,N2,B2,z2,F2=(0,S.ccclass)("TournamentsNotAvailable")(b2=function(r){n(u,r);var s,l=i(u);function u(){return t(this,u),l.apply(this,arguments)}return e(u,[{key:"onLoad",value:function(){this.hide()}},{key:"show",value:(s=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,t=this.node.position.clone(),(n=L(this.node)).to(.05,{position:t.clone().add3f(5,0,0)}),n.to(.05,{position:t.clone().add3f(-5,0,0)}),(i=L(this.node).repeat(2,n)).to(.05,{position:t}),e.next=9,Ue.runTweenAsync(i);case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"hide",value:function(){this.node.active=!1}}]),u}(x))||b2;w._RF.pop(),w._RF.push({},"199fcQ5IEZFbJCfSrGNrGDQ","TournamentContent",void 0);var U2,G2,H2,q2,V2,W2,K2,j2,Y2,J2=S.ccclass,Z2=S.property,X2=codex,Q2=X2.storage,$2=X2.match,e5=Ludex.Utils,t5=e5.Object,n5=e5.Array,i5=(E2=J2("TournamentContent"),x2=Z2({type:pl}),A2=Z2(C2),T2=Z2(F2),P2=Z2(De),R2=Z2({type:[g2]}),L2=Z2(Ao),E2((_2=r((O2=function(r){n(y,r);var u,c,p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=d.call.apply(d,[this].concat(i)),s(e,"panelAnimator",_2,l(e)),s(e,"tournamentsBoard",D2,l(e)),s(e,"tournamentsNotAvailable",M2,l(e)),s(e,"scrollView",N2,l(e)),s(e,"skeletons",B2,l(e)),s(e,"contentOpacity",z2,l(e)),e.animAbortSignal=null,e.softAbortSignal=null,e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(y,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(A),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.scrollView.node.on(De.EventType.SCROLLING,this.onScrolling,this),this.node.scene.on(Vd.RELOAD_TOURNAMENT,this.reload,this),this.node.scene.on(Us.HIDE_UI,this.hideContent),this.node.scene.on(Us.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(De.EventType.SCROLLING,this.onScrolling,this),this.node.scene.off(Vd.RELOAD_TOURNAMENT,this.reload,this),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Us.HIDE_UI,this.hideContent),this.node.scene.off(Us.SHOW_UI,this.showContent)}},{key:"onScrolling",value:function(){this.tournamentsBoard.updateVisibility()}},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"enter",value:(h=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.animAbortSignal&&null===this.softAbortSignal){e.next=2;break}return e.abrupt("return");case 2:return this.animAbortSignal=new An,this.softAbortSignal=new An,e.next=6,this.showLoading(this.animAbortSignal);case 6:if(!this.isAborted()){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,rt.requestTournamentDataAsync();case 10:if(n=e.sent,!this.isAborted()){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.hideLoading(this.animAbortSignal);case 15:if(!this.isAborted()){e.next=17;break}return e.abrupt("return");case 17:if(0!==n.length||null!==(t=this.softAbortSignal)&&void 0!==t&&t.aborted){e.next=20;break}return this.tournamentsNotAvailable.show(),e.abrupt("return");case 20:return this.tournamentsNotAvailable.hide(),this.tryShowTournamentResult(),this.scrollView.enabled=!0,this.tournamentsBoard.updateData(n),e.next=26,this.tournamentsBoard.showTournamentBlocks(this.uiTransform.contentSize.height-this.tournamentsBoard.layout.paddingTop,this.animAbortSignal);case 26:this.tournamentsBoard.updateVisibility();case 27:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"showLoading",value:(p=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scrollView.scrollToTop(0),this.scrollView.enabled=!1,e.next=4,Promise.all([this.skeletons.map((function(e){return e.show(0,t)}))]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"hideLoading",value:(c=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.skeletons.map((function(e){return e.hide(t)}))]);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"tryShowTournamentResult",value:function(){try{if(!Q2.getStorage("tournament").animateTournamentLeader)return;var e=rt.getAllTournamentData(),t=$2.getMatchState().customData.tournamentId;if(!t)throw new Error("Tournament ID not found");var n=n5.search(e,(function(e){return e.id===t}));if(!n)throw new Error("Tournament not found");var i=JSON.stringify(n);nt.showTournamentDetailScreen(i,"tournament_end")}catch(e){Q2.setStorageData("tournament","animateTournamentLeader",!1),console.warn("showTournamentResult",e)}}},{key:"processCreateTournament",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hy.processCreateTournamentAsync();case 3:e.next=17;break;case 5:if(e.prev=5,e.t0=e.catch(0),t5.hasOwn(e.t0,"code")){e.next=10;break}return nt.showNotificationScreenWithLocalizedKey("error.createTourFail",2),e.abrupt("return");case 10:if("USER_INPUT"!==e.t0.code){e.next=12;break}return e.abrupt("return");case 12:if("PLAYER_HAS_TOURNAMENT"!==e.t0.code){e.next=15;break}return nt.showNotificationScreenWithLocalizedKey("error.tourExists",2),e.abrupt("return");case 15:"INVALID_OPERATION"===e.t0.code&&t5.hasOwn(e.t0,"message")&&"string"==typeof e.t0.message&&nt.showNotificationScreen(e.t0.message,2),nt.showNotificationScreenWithLocalizedKey("error.createTourFail",2);case 17:this.reload();case 18:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return u.apply(this,arguments)})},{key:"isAborted",value:function(){var e,t;return null===(e=null===(t=this.animAbortSignal)||void 0===t?void 0:t.aborted)||void 0===e||e}},{key:"cleanup",value:function(){var e;this.unlistenEvents(),null===(e=this.animAbortSignal)||void 0===e||e.abort(),this.animAbortSignal=null,this.tournamentsBoard.removeTournamentBlocks(),this.tournamentsNotAvailable.hide()}},{key:"softAbort",value:function(){var e;null===(e=this.softAbortSignal)||void 0===e||e.abort(),this.softAbortSignal=null}},{key:"reload",value:function(){this.softAbort(),this.cleanup(),this.listenEvents(),this.enter()}}]),y}(x)).prototype,"panelAnimator",[x2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D2=r(O2.prototype,"tournamentsBoard",[A2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M2=r(O2.prototype,"tournamentsNotAvailable",[T2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N2=r(O2.prototype,"scrollView",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B2=r(O2.prototype,"skeletons",[R2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z2=r(O2.prototype,"contentOpacity",[L2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I2=O2))||I2);w._RF.pop(),w._RF.push({},"bce5eh0LHVP2bCJ6u+kFjuA","TournamentPage",void 0);var r5,a5,o5,s5,l5,u5;U2=(0,S.ccclass)("TournamentPage"),G2=Ii.required(),H2=Ii.onlyRunInLifeCycleAsync,q2=Ii.onlyRunInLifeCycle,V2=Ii.onlyRunInLifeCycleAsync,W2=Ii.onlyRunInLifeCycleAsync,U2((Y2=r((j2=function(r){n(v,r);var u,c,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"panelAnimationController",Y2,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(al),p(h(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(h(v.prototype),"start",this).call(this);case 1:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"mount",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"mount",this).call(this);case 2:this.onMount();case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(i5),!this.content)throw new Error("LeaderboardPage: Leaders not found")}},{key:"transitionIn",value:(c=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(h(v.prototype),"transitionIn",this).call(this);case 2:return t=Ue.runTweenAsync(L(this.containerUIOpacity).to(.2,{opacity:255})),n=this.panelAnimationController.showUI(),this.content.listenEvents(),e.next=7,Promise.all([t,n]);case 7:this.content.enter();case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"transitionOut",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.content)||void 0===t||t.softAbort(),this.content.unlistenUIEvents(),e.next=4,p(h(v.prototype),"transitionOut",this).call(this);case 4:return e.next=6,this.panelAnimationController.hideUI();case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"unmount",value:function(){var e;null===(e=this.content)||void 0===e||e.cleanup(),p(h(v.prototype),"unmount",this).call(this)}}]),v}(Jj)).prototype,"panelAnimationController",[G2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(j2.prototype,"mount",[H2],Object.getOwnPropertyDescriptor(j2.prototype,"mount"),j2.prototype),r(j2.prototype,"onMount",[q2],Object.getOwnPropertyDescriptor(j2.prototype,"onMount"),j2.prototype),r(j2.prototype,"transitionIn",[V2],Object.getOwnPropertyDescriptor(j2.prototype,"transitionIn"),j2.prototype),r(j2.prototype,"transitionOut",[W2],Object.getOwnPropertyDescriptor(j2.prototype,"transitionOut"),j2.prototype),K2=j2));w._RF.pop(),w._RF.push({},"b8271vI+3pO9q8SKMYpqLKv","EventBadge",void 0);var c5,p5,h5,d5,y5,f5,v5,m5,g5,b5=S.ccclass,w5=S.property;r5=b5("EventBadge"),a5=w5(Y),o5=w5(C),r5((u5=r((l5=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"label",u5,l(e)),e}return e(o,[{key:"text",get:function(){return this.label.string},set:function(e){this.label.string=e}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.label)throw new Error("EventBadge: Missing required component Label")}}]),o}(x)).prototype,"label",[a5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(l5.prototype,"text",[o5],Object.getOwnPropertyDescriptor(l5.prototype,"text"),l5.prototype),s5=l5));w._RF.pop(),w._RF.push({},"7712cs4XLJAgpKqlO3gPqkF","EventProgressBar",void 0);var k5,S5,C5,E5,x5,A5,T5,P5,R5,L5,I5,O5,_5,D5,M5,N5,B5,z5,F5,U5,G5,H5,q5,V5,W5,K5,j5,Y5,J5,Z5,X5,Q5,$5,e3,t3,n3,i3,r3,a3,o3,s3,l3,u3,c3,p3,h3,d3,y3,f3=S.ccclass,v3=S.property;c5=f3("EventProgressBar"),p5=v3(Fu),h5=v3(Y),d5=v3(C),y5=v3({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress"}),c5((m5=r((v5=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"progressBar",m5,l(e)),s(e,"progressLabel",g5,l(e)),e}return e(o,[{key:"text",get:function(){return this.progressLabel.string},set:function(e){this.progressLabel.string=e}},{key:"progress",get:function(){return this.progressBar.progress},set:function(e){this.progressBar.progress=e}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("EventProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("EventProgressBar: Missing required component Label")}}]),o}(x)).prototype,"progressBar",[p5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g5=r(v5.prototype,"progressLabel",[h5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(v5.prototype,"text",[d5],Object.getOwnPropertyDescriptor(v5.prototype,"text"),v5.prototype),r(v5.prototype,"progress",[y5],Object.getOwnPropertyDescriptor(v5.prototype,"progress"),v5.prototype),f5=v5));w._RF.pop(),w._RF.push({},"7741dWPNcdHRqGVvif/L/MP","NavButton",void 0);var m3,g3,b3,w3,k3,S3,C3,E3=S.ccclass,x3=S.property,A3=S.executeInEditMode,T3=codex.analytics,P3=(null!==(k5=Ludex.Plugins.Analytics)&&void 0!==k5?k5:{}).Events;S5=E3("NavButton"),C5=x3(W),E5=x3({group:{name:"Animation"},displayName:"Is Selected",tooltip:"This is for the editor only and will be ignored at runtime",editorOnly:!0}),x5=x3({type:P,group:{name:"Animation"}}),A5=x3({type:P,group:{name:"Animation"}}),T5=x3({type:P,group:{name:"Animation"}}),P5=x3({type:P,group:{name:"Animation"}}),R5=x3({type:P,group:{name:"Animation"}}),L5=x3({group:{name:"Animation"}}),I5=x3({type:P,group:{name:"Animation"}}),O5=x3({type:P,group:{name:"Animation"}}),_5=x3({group:{name:"Animation"}}),D5=x3({type:P,group:{name:"Animation"}}),M5=x3({type:P,group:{name:"Animation"}}),N5=x3({type:P,group:{name:"Animation"}}),B5=x3({type:P,group:{name:"Animation"}}),z5=x3({type:P,group:{name:"Animation"}}),F5=x3({type:A}),U5=x3(H),G5=x3(M),H5=x3({type:A}),q5=x3({type:B(En)}),V5=x3(eZ),S5(W5=A3((j5=r((K5=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"wip",j5,l(e)),s(e,"isSelectedInEditor",Y5,l(e)),s(e,"animationDuration",J5,l(e)),s(e,"selectedSpacing",Z5,l(e)),s(e,"deselectedSpacing",X5,l(e)),s(e,"selectedIconY",Q5,l(e)),s(e,"selectedIconX",$5,l(e)),s(e,"selectedIconScale",e3,l(e)),s(e,"deselectedIconY",t3,l(e)),s(e,"deselectedIconX",n3,l(e)),s(e,"deselectedIconScale",i3,l(e)),s(e,"initTextY",r3,l(e)),s(e,"selectedTextY",a3,l(e)),s(e,"selectedTextX",o3,l(e)),s(e,"deselectedTextY",s3,l(e)),s(e,"deselectedTextX",l3,l(e)),s(e,"spacer",u3,l(e)),s(e,"icon",c3,l(e)),s(e,"text",p3,l(e)),s(e,"uiTransform",h3,l(e)),s(e,"screenType",d3,l(e)),s(e,"navManager",y3,l(e)),e.isSelected=!1,e.onMouseEnter=function(t){e.isSelected||e.playHoverOnAnimation()},e.onMouseLeave=function(t){e.isSelected||e.playHoverOffAnimation()},e}return e(h,[{key:"isWIP",get:function(){return this.wip}},{key:"buttonType",get:function(){return this.screenType}},{key:"update",value:function(){}},{key:"onEnable",value:function(){this.node.on(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(H.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(H.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onEditorUpdate",value:function(){null!==this.icon&&void 0!==this.icon&&null!==this.text&&void 0!==this.icon&&null!==this.spacer&&void 0!==this.spacer&&(this.isSelectedInEditor?(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.initTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0))}},{key:"setSelected",value:function(){var e,t;this.isSelected||(Ve.playSound(Ji.PATCH_SHIFT),this.navManager.selectUsingSceneTransition(this),P3&&T3.event(P3.BUTTON_CLICK,{button_name:null!==(e=null===(t=this.node.parent)||void 0===t?void 0:t.name)&&void 0!==e?e:this.node.name,screen_name:We.getCurrentPage()}))}},{key:"select",value:(c=a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(n.length>0&&void 0!==n[0])||n[0],!this.isSelected){e.next=3;break}throw new Error("NavButton: Already selected");case 3:if(this.isSelected=!0,!t){e.next=9;break}return e.next=7,Ue.runTweenAsync(this.playSelectAnimation());case 7:e.next=14;break;case 9:this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255;case 14:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"deselect",value:(u=a(o().mark((function e(){var t,n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],n=i.length>1&&void 0!==i[1]&&i[1],this.isSelected||n){e.next=4;break}throw new Error("NavButton: Already deselected");case 4:if(this.isSelected=!1,!t){e.next=10;break}return e.next=8,Ue.runTweenAsync(this.deselectAnimation());case 8:e.next=15;break;case 10:this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.deselectedTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0;case 15:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getSelectedWorldDistanceX",value:function(){var e=new q(this.selectedIconX,this.selectedIconY,0),t=new q(this.deselectedIconX,this.deselectedIconY,0),n=this.node.scale.clone();this.node.scale=this.selectedIconScale;var i=this.uiTransform.convertToWorldSpaceAR(e),r=this.uiTransform.convertToWorldSpaceAR(t);return this.node.scale=n,r.x-i.x}},{key:"playHoverOnAnimation",value:function(){var e=L(this.icon);return e.to(.1,{scale:this.deselectedIconScale.clone().add3f(.1,.1,0)},{easing:"cubicIn"}),Ue.runTweenAsync(e)}},{key:"playHoverOffAnimation",value:function(){var e=L(this.icon);return e.to(.1,{scale:this.deselectedIconScale},{easing:"cubicOut"}),Ue.runTweenAsync(e)}},{key:"playSelectAnimation",value:function(){var e=this;return L(this.spacer).to(this.animationDuration,{width:this.selectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=z.quintInOut(n),r=z.backOut(n),a=z.linear(n),o=n<.5?2*n:1,s=e.deselectedIconY+(e.selectedIconY-e.deselectedIconY)*r,l=e.deselectedIconX+(e.selectedIconX-e.deselectedIconX)*a;e.icon.setPosition(l,s,0);var u=e.deselectedIconScale.clone().lerp(e.selectedIconScale,i);e.icon.setScale(u.x,u.y,e.icon.scale.z);var c=255*o,p=e.deselectedTextY+(e.selectedTextY-e.deselectedTextY)*a,h=e.deselectedTextX+(e.selectedTextX-e.deselectedTextX)*a;e.text.opacity=c,e.text.node.setPosition(h,p,0)}}})}},{key:"deselectAnimation",value:function(){var e=this;return L(this.spacer).to(this.animationDuration,{width:this.deselectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=be(e.selectedIconY,e.deselectedIconY,n),r=be(e.selectedIconX,e.deselectedIconX,n);e.icon.setPosition(r,i,0);var a=be(255,0,n<.5?2*n:1);e.text.opacity=a;var o=be(e.selectedTextY,e.deselectedTextY,n),s=be(e.selectedTextX,e.deselectedTextX,n);e.text.node.setPosition(s,o,0);var l=e.selectedIconScale.clone().lerp(e.deselectedIconScale,z.quintInOut(n));e.icon.setScale(l.x,l.y,e.icon.scale.z)}}})}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(A),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}}]),h}(x)).prototype,"wip",[C5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y5=r(K5.prototype,"isSelectedInEditor",[E5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),J5=r(K5.prototype,"animationDuration",[x5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),Z5=r(K5.prototype,"selectedSpacing",[A5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),X5=r(K5.prototype,"deselectedSpacing",[T5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 88}}),Q5=r(K5.prototype,"selectedIconY",[P5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),$5=r(K5.prototype,"selectedIconX",[R5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e3=r(K5.prototype,"selectedIconScale",[L5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(1,1,1)}}),t3=r(K5.prototype,"deselectedIconY",[I5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n3=r(K5.prototype,"deselectedIconX",[O5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),i3=r(K5.prototype,"deselectedIconScale",[_5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new q(.8,.8,1)}}),r3=r(K5.prototype,"initTextY",[D5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-100}}),a3=r(K5.prototype,"selectedTextY",[M5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-10}}),o3=r(K5.prototype,"selectedTextX",[N5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s3=r(K5.prototype,"deselectedTextY",[B5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l3=r(K5.prototype,"deselectedTextX",[z5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),u3=r(K5.prototype,"spacer",[F5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c3=r(K5.prototype,"icon",[U5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p3=r(K5.prototype,"text",[G5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h3=r(K5.prototype,"uiTransform",[H5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d3=r(K5.prototype,"screenType",[q5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y3=r(K5.prototype,"navManager",[V5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W5=K5))||W5);w._RF.pop(),w._RF.push({},"091aai5+ANDeZfFN8JFkbyi","TournamentButton",void 0);var R3,L3,I3,O3,_3,D3,M3,N3,B3=Ludex.Utils.Signal,z3=S.ccclass,F3=S.property,U3=new q(1.1,1.1);m3=z3("TournamentButton"),g3=Ii.required,b3=F3(H),w3=Ii.onlyRunInLifeCycle,m3((C3=r((S3=function(r){n(f,r);var u,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"hotIcon",C3,l(e)),e.requestController=new B3.SignalController,e}return e(f,[{key:"__preload",value:function(){Ii.validateRequiredProperties(this,f)}},{key:"onLoad",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleHotIconAppearance();case 2:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"onDestroy",value:function(){this.requestController.abort()}},{key:"handleHotIconAppearance",value:(h=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:GameSDK.isGameSDK("MsGames")?this.handleMsGamesHotIconCheck():this.handleNormalHotIconCheck();case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleMsGamesHotIconCheck",value:(p=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.requestController.renew(),e.next=4,rt.requestTournamentDataAsync();case 4:if(n=e.sent,!t.aborted){e.next=7;break}return e.abrupt("return");case 7:n.filter((function(e){return!rt.validateTournamentExpired(e.id)})).length>=2&&this.showHotIcon(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.info("Error in TournamentButton",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return p.apply(this,arguments)})},{key:"handleNormalHotIconCheck",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.requestController.renew(),e.next=4,rt.requestTournamentDataAsync();case 4:if(n=e.sent,!t.aborted){e.next=7;break}return e.abrupt("return");case 7:i=c(n),e.prev=8,i.s();case 10:if((r=i.n()).done){e.next=25;break}if(a=r.value,s=a.payload,l=s.leaderboardId,u=s.playerId,l&&"global"===u){e.next=15;break}return e.abrupt("continue",23);case 15:return e.next=17,pI.getAllLeaderboardAsync(l);case 17:if(p=e.sent){e.next=20;break}return e.abrupt("continue",23);case 20:if(!(p.amountPlayer>=30)){e.next=23;break}return this.showHotIcon(t),e.abrupt("break",25);case 23:e.next=10;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(8),i.e(e.t0);case 30:return e.prev=30,i.f(),e.finish(30);case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(0),console.info("Error in TournamentButton",e.t1);case 38:case"end":return e.stop()}}),e,this,[[0,35],[8,27,30,33]])}))),function(){return u.apply(this,arguments)})},{key:"showHotIcon",value:function(e){this.hotIcon.active=!0,this.hotIcon.setScale(q.ZERO);var t=L(this.hotIcon).delay(1).to(.3,{scale:U3},{easing:"backIn"}).to(.3,{scale:q.ONE},{easing:"backOut"});Ue.runTweenAsync(L(this.hotIcon).to(.5,{scale:q.ONE},{easing:"backOut"}).repeatForever(t),e)}}]),f}(x)).prototype,"hotIcon",[g3,b3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(S3.prototype,"showHotIcon",[w3],Object.getOwnPropertyDescriptor(S3.prototype,"showHotIcon"),S3.prototype),k3=S3));w._RF.pop(),w._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var G3,H3,q3,V3,W3,K3,j3,Y3=S.ccclass,J3=S.property,Z3=S.disallowMultiple,X3=codex,Q3=X3.player,$3=X3.event,e4=qe.Layout,t4=Ludex,n4=t4.Match.Modes,i4=t4.Events;R3=Y3("GameScene"),L3=Ii.required,I3=J3(Fw),O3=Ii.onlyRunInLifeCycle,_3=Ii.onlyRunInLifeCycle,R3(D3=Z3((N3=r((M3=function(r){n(c,r);var u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=u.call.apply(u,[this].concat(i)),s(e,"coinManager",N3,l(e)),e.handleGameExit=function(){ot.switchToDashboardScene()},e.handleShowResults=function(){ot.switchScene(ct.CHALLENGE_RESULT_SCENE)},e.handleGameMaskWhenLayoutChanged=function(e){var t=re("Canvas/Game/GameObjects");if(t){var n=t.getComponent(ze);n&&(n.enabled=e===e4.Landscape)}},e.updateMusic=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=hy.getMatchMode(),n=t===n4.TOURNAMENT,i=n?Ji.TOURNAMENT_MUSIC:Ji.BG_MUSIC,Ve.getCurrentMusic()===i){e.next=8;break}return e.next=6,Ve.setVolumeMusic(0,!0);case 6:return e.next=8,Ue.waitTweenAsync(1);case 8:Ve.playMusic(i,n),Ve.setVolumeMusic(n?.4:.3,!0);case 10:case"end":return e.stop()}}),e)}))),e}return e(c,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"onLoad",value:function(){this.coinManager.init()}},{key:"validateRequiredComponents",value:function(){Ii.validateRequiredProperties(this,c)}},{key:"listenGameEvents",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(Us.GAME_EXIT,this.handleGameExit),this.node.scene.on(Us.SHOW_CHALLENGE_RESULTS,this.handleShowResults),this.node.scene.on(Us.UPDATE_MUSIC,this.updateMusic)}},{key:"start",value:function(){Q3.getPlayerSetting("music")&&this.updateMusic(),this.scheduleOnce(this.preloadScenes,20),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScenes",value:function(){ot.preloadDashboardScene()}},{key:"preloadScreens",value:function(){var e,t=Q3.getGameData(),n=null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1;n%5==0&&nt.preloadScreen(it.HARD_LEVEL_SCREEN),n>=$e&&(nt.preloadScreen(it.CONGRATULATION_SCREEN),nt.preloadScreen(it.START_OVER_SCREEN)),nt.preloadScreen(it.PAUSE_SCREEN),nt.preloadScreen(it.LOADING_SCREEN),nt.preloadScreen(it.GET_ITEM_SCREEN),nt.preloadScreen(it.NOTIFICATION_SCREEN),this.node.scene.once(Us.GAME_FINISH,(function(){nt.preloadScreen(it.LEVEL_COMPLETE_SCREEN),nt.preloadScreen(it.GET_REWARDS_SCREEN)})),$3.once(i4.OPENED_SCREEN,(function(e){e.screenName===lt[it.PAUSE_SCREEN]&&(nt.preloadScreen(it.QUIT_LEVEL_SCREEN),nt.preloadScreen(it.START_OVER_SCREEN),nt.preloadScreen(it.CUSTOM_GAME_SCREEN))}))}}]),c}(x)).prototype,"coinManager",[L3,I3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(M3.prototype,"preloadScenes",[O3],Object.getOwnPropertyDescriptor(M3.prototype,"preloadScenes"),M3.prototype),r(M3.prototype,"preloadScreens",[_3],Object.getOwnPropertyDescriptor(M3.prototype,"preloadScreens"),M3.prototype),D3=M3))||D3);w._RF.pop(),w._RF.push({},"0c0b4cnFOFJ6pJmGNHnMo7m","ComboEffect",void 0);var r4,a4,o4,s4,l4,u4,c4,p4=S.ccclass,h4=S.property;G3=p4("ComboEffect"),H3=h4(M),q3=h4(Q),G3((K3=r((W3=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"circleOpacity",K3,l(e)),s(e,"particle",j3,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Us.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){e>1&&(this.circleOpacity.node.scale=q.ZERO,this.circleOpacity.opacity=60,this.particle.resetSystem(),L(this.circleOpacity.node).to(.2,{scale:new q(1.3,1.3,1.3)},{easing:"quadOut"}).start(),L(this.circleOpacity).delay(.3).to(.2,{opacity:0},{easing:"expoIn"}).start())}}]),o}(x)).prototype,"circleOpacity",[H3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j3=r(W3.prototype,"particle",[q3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V3=W3));w._RF.pop(),w._RF.push({},"0506aJZ1EdPqJejQ2PpB980","ComboLabel",void 0);var d4,y4,f4,v4,m4,g4,b4,w4,k4,S4,C4,E4,x4=S.ccclass,A4=S.property;r4=x4("ComboLabel"),a4=A4(Y),o4=A4(H),r4((u4=r((l4=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"comboNumber",u4,l(e)),s(e,"comboContainer",c4,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.opacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Us.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){0===e?this.opacity.opacity=0:e>1?(this.opacity.opacity=255,this.comboNumber.string="".concat(e),L(this.comboContainer).to(.1,{scale:new q(1.3,1.3,1.3)},{easing:"sineIn"}).to(.1,{scale:q.ONE},{easing:"sineOut"}).start()):this.opacity.opacity=0}}]),o}(x)).prototype,"comboNumber",[a4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c4=r(l4.prototype,"comboContainer",[o4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s4=l4));w._RF.pop(),w._RF.push({},"51871oF8CFOkp81rgCf90UQ","ComboPopup",void 0);var T4,P4,R4,L4,I4,O4,_4,D4,M4,N4,B4,z4,F4,U4,G4,H4,q4,V4,W4=Ludex.Utils.Signal,K4=S.ccclass,j4=S.property,Y4=qe.Layout,J4=["good","great","excellent"];d4=K4("ComboPopup"),y4=Ii.required(),f4=j4(cp),v4=Ii.required(),m4=j4(le),g4=Ii.required(),b4=j4(M),d4((S4=r((k4=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"spriteLocalizer",S4,l(e)),s(e,"animation",C4,l(e)),s(e,"textUiOpacity",E4,l(e)),e.comboController=new W4.SignalController,e}return e(p,[{key:"__preload",value:function(){this.widget=this.getComponent(R),Ii.validateRequiredProperties(this)}},{key:"onLoad",value:function(){O.on(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ye.getCurrentLayout())}},{key:"onDestroy",value:function(){O.off(Ge.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.comboController.abort()}},{key:"start",value:function(){this.node.scene.on(Us.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:(u=a(o().mark((function e(t){var n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<2)){e.next=2;break}return e.abrupt("return");case 2:n=J4.length-1;case 3:if(!(n>=0)){e.next=19;break}if(i=J4[n],!(t>=n+2)){e.next=16;break}return r=this.comboController.renew(),this.spriteLocalizer.key=i,this.textUiOpacity.opacity=0,e.next=11,this.spriteLocalizer.waitUntilLocalized();case 11:if(!r.aborted){e.next=13;break}return e.abrupt("return");case 13:return Ue.runTweenAsync(L(this.textUiOpacity).to(.25,{opacity:255}),r),this.animation.play(),e.abrupt("return");case 16:n--,e.next=3;break;case 19:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){e===Y4.Portrait?(this.widget.left=20,this.widget.right=20):e===Y4.Landscape&&(this.widget.left=700,this.widget.right=120)}}]),p}(x)).prototype,"spriteLocalizer",[y4,f4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C4=r(k4.prototype,"animation",[v4,m4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E4=r(k4.prototype,"textUiOpacity",[g4,b4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w4=k4));w._RF.pop(),w._RF.push({},"11abe47Ss1CtabSFT1/cPKt","PlayableScene",void 0);var Z4,X4,Q4,$4,e6,t6,n6,i6,r6,a6,o6,s6,l6,u6,c6=S.ccclass,p6=S.property,h6=S.disallowMultiple,d6=codex.analytics;T4=c6("PlayableScene"),P4=Ii.required(),R4=p6({type:Y}),L4=Ii.required(),I4=p6({type:Ex}),O4=Ii.required(),_4=p6({type:Ex}),D4=Ii.required(),M4=p6({type:le}),N4=Ii.onlyRunInLifeCycleAsync,B4=Ii.onlyRunInLifeCycle,z4=Ii.onlyRunInLifeCycle,T4(F4=h6((G4=r((U4=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;return t(this,d),e=h.call(this),s(e,"label",G4,l(e)),s(e,"particleLeft",H4,l(e)),s(e,"particleRight",q4,l(e)),s(e,"backgroundAnimation",V4,l(e)),ot.markIsTestScene(ct.PLAYABLE_SCENE),e}return e(d,[{key:"__preload",value:function(){this.listenEvents()}},{key:"onLoad",value:function(){Ii.validateRequiredProperties(this)}},{key:"listenEvents",value:function(){}},{key:"start",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d6.event("ready_playable"),e.next=3,this.waitViewable();case 3:this.playTweens(),this.playParticles(),this.playAnimations(),d6.event("showing_playable"),setTimeout((function(){"openAppStore"in GameSDK.extra&&GameSDK.extra.openAppStore()}),1e4);case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"waitViewable",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("isViewable"in GameSDK.extra){e.next=2;break}return e.abrupt("return");case 2:if(!GameSDK.extra.isViewable()){e.next=4;break}return e.abrupt("return");case 4:if("waitViewableChange"in GameSDK.extra){e.next=6;break}return e.abrupt("return");case 6:return O.pause(),e.next=9,GameSDK.extra.waitViewableChange();case 9:if(e.sent){e.next=14;break}return e.next=13,this.waitViewable();case 13:return e.abrupt("return");case 14:O.resume();case 15:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"playTweens",value:(u=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=L(this.label.node).to(10,{position:new q(0,200,0)},{easing:"cubicInOut"}).to(6,{position:new q(0,-100,0)},{easing:"cubicInOut"}),Ue.runTweenAsync(L(this.label.node).repeat(999,t));case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"playParticles",value:function(){console.log("playParticles",this.particleLeft,this.particleRight),this.particleLeft.play(),this.particleRight.play()}},{key:"playAnimations",value:function(){this.backgroundAnimation.play()}}]),d}(x)).prototype,"label",[P4,R4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H4=r(U4.prototype,"particleLeft",[L4,I4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q4=r(U4.prototype,"particleRight",[O4,_4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V4=r(U4.prototype,"backgroundAnimation",[D4,M4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(U4.prototype,"playTweens",[N4],Object.getOwnPropertyDescriptor(U4.prototype,"playTweens"),U4.prototype),r(U4.prototype,"playParticles",[B4],Object.getOwnPropertyDescriptor(U4.prototype,"playParticles"),U4.prototype),r(U4.prototype,"playAnimations",[z4],Object.getOwnPropertyDescriptor(U4.prototype,"playAnimations"),U4.prototype),F4=U4))||F4);w._RF.pop(),w._RF.push({},"a0819yK3HpO2505QqLUOChz","PlayerScore",void 0);var y6,f6,v6,m6,g6,b6,w6,k6,S6,C6,E6,x6,A6,T6,P6,R6,L6,I6,O6,_6,D6,M6,N6,B6,z6,F6,U6,G6,H6=S.ccclass,q6=S.property,V6=(Z4=H6("PlayerScore"),X4=q6(H),Q4=q6(Y),$4=q6(M),e6=q6(M),t6=q6(N),n6=Ii.onlyRunInLifeCycleAsync,Z4((a6=r((r6=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"crown",a6,l(e)),s(e,"playerScore",o6,l(e)),s(e,"playerScoreUiOpacity",s6,l(e)),s(e,"waitingUiOpacity",l6,l(e)),s(e,"avatar",u6,l(e)),e}return e(p,[{key:"showCrown",value:function(e){this.crown.active=e}},{key:"setPlayerScore",value:function(e){this.playerScore.string=e.toString()}},{key:"playWaitingAnimation",value:function(){this.waitingUiOpacity.node.active=!0,this.playerScoreUiOpacity.node.active=!1,this.waitingUiOpacity.opacity=130,this.playerScoreUiOpacity.opacity=0;var e=L(this.waitingUiOpacity).to(1,{opacity:130},{easing:"sineInOut"}).to(1,{opacity:255},{easing:"sineInOut"}).delay(.25);this.waitingAnimation=L(this.waitingUiOpacity).repeatForever(e).start()}},{key:"stopWaitingAnimation",value:function(){this.waitingAnimation&&this.waitingAnimation.stop(),this.waitingUiOpacity.opacity=0,this.playerScoreUiOpacity.opacity=255,this.waitingUiOpacity.node.active=!1,this.playerScoreUiOpacity.node.active=!0}},{key:"loadPhoto",value:(u=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FO.getPlayerAvatar(t,n,128);case 3:if(i=e.sent){e.next=6;break}throw new Error("Failed to create sprite frame");case 6:if(this.node.activeInHierarchy){e.next=8;break}return e.abrupt("return");case 8:i.packable=!0,this.avatar.spriteFrame=i,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,t){return u.apply(this,arguments)})}]),p}(x)).prototype,"crown",[X4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o6=r(r6.prototype,"playerScore",[Q4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s6=r(r6.prototype,"playerScoreUiOpacity",[$4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l6=r(r6.prototype,"waitingUiOpacity",[e6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u6=r(r6.prototype,"avatar",[t6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(r6.prototype,"loadPhoto",[n6],Object.getOwnPropertyDescriptor(r6.prototype,"loadPhoto"),r6.prototype),i6=r6))||i6);w._RF.pop(),w._RF.push({},"4b062RYQK5PQbgs7yH66gDw","ChallengeResultScene",void 0);var W6,K6,j6,Y6,J6,Z6=S.ccclass,X6=S.disallowMultiple,Q6=S.property,$6=codex,e8=$6.match,t8=$6.player,n8=$6.monitorError,i8=Ludex.Utils.Object;y6=Z6("ChallengeResultScene"),f6=Q6(cp),v6=Q6(cp),m6=Q6(cp),g6=Q6(cp),b6=Q6({type:V6,group:"Score"}),w6=Q6({type:V6,group:"Score"}),k6=Q6({group:"Confetti Effect",type:Ex}),S6=Q6({group:"Confetti Effect",type:Ex}),C6=Q6(tf),E6=Q6(le),x6=Ii.onlyRunInLifeCycle,A6=Ii.onlyRunInLifeCycle,T6=Ii.onlyRunInLifeCycle,P6=Ii.onlyRunInLifeCycle,R6=Ii.onlyRunInLifeCycle,y6(L6=X6((O6=r((I6=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"drawLocalizer",O6,l(e)),s(e,"winLocalizer",_6,l(e)),s(e,"loseLocalizer",D6,l(e)),s(e,"waitingLocalizer",M6,l(e)),s(e,"playerScore",N6,l(e)),s(e,"opponentScore",B6,l(e)),s(e,"leftConfetti",z6,l(e)),s(e,"rightConfetti",F6,l(e)),s(e,"levelManager",U6,l(e)),s(e,"headerAnimation",G6,l(e)),e.goToDashboardScene=function(){ot.switchToDashboardScene()},e}return e(p,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.node.scene.on(Ge.RESULT_SCENE_HOME,this.goToDashboardScene),this.node.scene.on(Ge.RESULT_SCENE_REPLAY,this.handleTryAgainClicked,this)}},{key:"start",value:function(){this.scheduleOnce(this.preloadScenes,3);try{var e,t,n=e8.getMatchState(),i=n.customData,r=i.playerId,a=i.opponentId;if(!r||!a)throw new Error("ResultScene: playerId is ".concat(r," and opponentId is ").concat(a,". Expected to not be null."));var o=t8.getPlayer().photo,s=null!==(e=n.profiles[r])&&void 0!==e?e:{},l=s.score,u=void 0===l?0:l,c=s.finished,p=void 0!==c&&c,h=null!==(t=n.profiles[a])&&void 0!==t?t:{},d=h.photo,y=void 0===d?"":d,f=h.score,v=void 0===f?0:f,m=h.finished,g=void 0!==m&&m,b=p&&g,w=b&&u>v,k=b&&v>u;this.playerScore.loadPhoto(o,r),this.opponentScore.loadPhoto(y,a),this.playerScore.setPlayerScore(u),this.opponentScore.setPlayerScore(v),this.playerScore.showCrown(w),this.opponentScore.showCrown(k),p&&g?u===v?this.playStatusAnimation("Draw"):w?this.playStatusAnimation("Win"):k&&this.playStatusAnimation("Lose"):(p||this.playerScore.playWaitingAnimation(),g||this.opponentScore.playWaitingAnimation(),this.playStatusAnimation("Waiting"))}catch(e){console.warn("ResultScene: Error on load",e),this.goToDashboardScene()}}},{key:"preloadScenes",value:function(){ot.preloadDashboardScene()}},{key:"handleTryAgainClicked",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h,d,y,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null!==(t=t8.getGameData())&&void 0!==t?t:{},i=n.level,r=void 0===i?1:i,r=Math.max(1,r),e.next=4,this.levelManager.loadLevelData(r);case 4:if(a=e.sent,e.prev=5,a){e.next=8;break}throw new Error("Level data is not found");case 8:if(s=e8.getMatchState().customData.opponentId){e.next=11;break}throw new Error("Opponent id is not found");case 11:return nt.showLoadingScreen(),l=ag.generateFen(a),u=a.mode,c=void 0===u?"":u,p=a.rules,h=void 0===p?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:p,d=a.time,y=void 0===d?0:d,f=a.level,e.next=16,e8.challenge.friend.processAsync({playerId:t8.getPlayerId(),opponentId:s,extraData:{challengeData:{level:f,fen:l,gravity:c,rules:h,time:y}}});case 16:nt.closeLoadingScreen(),ot.switchToGameScene(),e.next=31;break;case 20:if(e.prev=20,e.t0=e.catch(5),!i8.hasOwn(e.t0,"code")||"USER_INPUT"!==e.t0.code){e.next=25;break}return nt.closeLoadingScreen(),e.abrupt("return");case 25:console.warn("ReplayChallengeFriend",e.t0),nt.closeLoadingScreen(),nt.showNotificationScreenWithLocalizedKey("error.challengeFail",2),null==n8||n8.sendException(e.t0 instanceof Error?e.t0:new Error("ReplayChallengeFriend"+JSON.stringify(e.t0))),this.scheduleOnce(this.goToDashboardScene,2);case 31:case"end":return e.stop()}}),e,this,[[5,20]])}))),function(){return u.apply(this,arguments)})},{key:"handleHomeClicked",value:function(){this.goToDashboardScene()}},{key:"playStatusAnimation",value:function(e){var t=this;"Win"!==e&&"Waiting"!==e||this.triggerConfettiAnimation();var n=this.getSpriteLocalizer(e);n.node.active=!0,n.waitUntilLocalized().then((function(){switch(e){case"Draw":t.playDrawAnimation();break;case"Win":t.playWinAnimation();break;case"Lose":t.playLoseAnimation();break;case"Waiting":t.playWaitingAnimation()}}))}},{key:"getSpriteLocalizer",value:function(e){switch(e){case"Draw":return this.drawLocalizer;case"Win":return this.winLocalizer;case"Lose":return this.loseLocalizer;case"Waiting":return this.waitingLocalizer}}},{key:"playDrawAnimation",value:function(){this.headerAnimation.play("RibbonDraw"),Ve.playSound(Ji.LEVEL_FAIL)}},{key:"playWinAnimation",value:function(){this.headerAnimation.play("RibbonWin"),Ve.playSound(Ji.LEVEL_COMPLETE)}},{key:"playLoseAnimation",value:function(){this.headerAnimation.play("RibbonLose"),Ve.playSound(Ji.LEVEL_FAIL)}},{key:"playWaitingAnimation",value:function(){this.headerAnimation.play("RibbonWaiting"),Ve.playSound(Ji.LEVEL_COMPLETE)}},{key:"triggerConfettiAnimation",value:function(){var e=this,t=Ye.isLandscape(),n=t?50:30,i=t?5e3:2e3,r=t?15e3:1e4,a=t?40:60,o=t?110:100,s=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=r,this.leftConfetti.shapeModule.angle=a,this.rightConfetti.shapeModule.angle=o,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=s,this.scheduleOnce((function(){e.leftConfetti.play(),e.rightConfetti.play()}),.2)}}]),p}(x)).prototype,"drawLocalizer",[f6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_6=r(I6.prototype,"winLocalizer",[v6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D6=r(I6.prototype,"loseLocalizer",[m6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M6=r(I6.prototype,"waitingLocalizer",[g6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N6=r(I6.prototype,"playerScore",[b6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B6=r(I6.prototype,"opponentScore",[w6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z6=r(I6.prototype,"leftConfetti",[k6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F6=r(I6.prototype,"rightConfetti",[S6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U6=r(I6.prototype,"levelManager",[C6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G6=r(I6.prototype,"headerAnimation",[E6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(I6.prototype,"playDrawAnimation",[x6],Object.getOwnPropertyDescriptor(I6.prototype,"playDrawAnimation"),I6.prototype),r(I6.prototype,"playWinAnimation",[A6],Object.getOwnPropertyDescriptor(I6.prototype,"playWinAnimation"),I6.prototype),r(I6.prototype,"playLoseAnimation",[T6],Object.getOwnPropertyDescriptor(I6.prototype,"playLoseAnimation"),I6.prototype),r(I6.prototype,"playWaitingAnimation",[P6],Object.getOwnPropertyDescriptor(I6.prototype,"playWaitingAnimation"),I6.prototype),r(I6.prototype,"triggerConfettiAnimation",[R6],Object.getOwnPropertyDescriptor(I6.prototype,"triggerConfettiAnimation"),I6.prototype),L6=I6))||L6);w._RF.pop(),w._RF.push({},"c0a5fPghzxBxpXiudxt+Qd4","TestParticleSystemScene",void 0);var r8,a8,o8,s8,l8,u8,c8,p8,h8,d8=S.ccclass,y8=S.property;W6=d8("TestParticleSystemScene"),K6=y8(Ex),W6((J6=r((Y6=function(r){n(o,r);var a=i(o);function o(){var e;return t(this,o),e=a.call(this),s(e,"starParticleSystem",J6,l(e)),ot.markIsTestScene(ct.TEST_PARTICLE_SYSTEM_SCENE),e}return e(o,[{key:"start",value:function(){var e=this;this.isValid&&this.scheduleOnce((function(){e.starParticleSystem.play()}),1)}}]),o}(x)).prototype,"starParticleSystem",[K6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j6=Y6));w._RF.pop(),w._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var f8,v8=S.ccclass,m8=S.property,g8=S.disallowMultiple,b8=Ludex.Events,w8=codex.event,k8=(r8=v8("BaseScreen"),a8=m8(H),o8=m8(H),s8=m8(M),r8(l8=g8((c8=r((u8=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"container",c8,l(e)),s(e,"backgroundMask",p8,l(e)),s(e,"screenOpacity",h8,l(e)),e.data={},e}return e(o,[{key:"__preload",value:function(){this.animation=this.getComponent(le),this.backgroundMaskButton=this.backgroundMask.getComponent(U),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"setScreenOpacity",value:function(e){this.screenOpacity.opacity=e}},{key:"open",value:function(e){var t,n,i=this;e&&(this.data=e),this.animation.once(le.EventType.PLAY,(function(){i.show()})),w8.emit(b8.OPENED_SCREEN,{screenName:this.node.name,screenData:this.data}),this.runAnimation(null!==(t=null===(n=this.data.overrideAnimation)||void 0===n?void 0:n.openScreen)&&void 0!==t?t:"OpenScreen")}},{key:"close",value:function(){var e,t,n=this;this.node.active&&(this.animation.once(le.EventType.FINISHED,(function(){w8.emit(b8.CLOSED_SCREEN,{screenName:n.node.name}),n.hide()})),this.runAnimation(null!==(e=null===(t=this.data.overrideAnimation)||void 0===t?void 0:t.closeScreen)&&void 0!==e?e:"CloseScreen"))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(M);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(M);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){this.node.active=!0;var e=this.node.getComponent(R);if(e){e.enabled=!0,e.updateAlignment();var t,n=this.node.getComponentsInChildren(R),i=c(n);try{for(i.s();!(t=i.n()).done;){t.value.updateAlignment()}}catch(e){i.e(e)}finally{i.f()}}}},{key:"hide",value:function(){this.node.active=!1}}]),o}(x)).prototype,"container",[a8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p8=r(u8.prototype,"backgroundMask",[o8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h8=r(u8.prototype,"screenOpacity",[s8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l8=u8))||l8)||l8);w._RF.pop(),w._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var S8,C8,E8,x8,A8,T8=S.ccclass,P8=S.requireComponent;T8("BackgroundMask")(f8=P8([M])(f8=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"onLoad",value:function(){var e=this.getComponent(M);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),o}(x))||f8);w._RF.pop(),w._RF.push({},"d25c5ZVzYVC/YcfG5prmRdB","Screens",void 0);var R8,L8,I8,O8,_8,D8,M8,N8,B8,z8,F8,U8,G8,H8,q8=S.ccclass,V8=S.property,W8=S.executeInEditMode;S8=q8("Screens"),C8=V8({type:B(it)}),S8(E8=W8((A8=r((x8=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"screenKeys",A8,l(e)),e}return e(o,[{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"onChildrenChanged",value:function(){}}]),o}(x)).prototype,"screenKeys",[C8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E8=x8))||E8);w._RF.pop(),w._RF.push({},"cecf2nUBzhIWZw7uJgVliXz","CongratulationScreen",void 0);var K8,j8,Y8,J8,Z8,X8,Q8,$8,e9,t9,n9,i9,r9,a9,o9,s9=S.ccclass,l9=S.property,u9=S.disallowMultiple,c9=S.requireComponent,p9=Ludex.Events,h9=codex.event;R8=s9("CongratulationScreen"),L8=c9(k8),I8=l9(H),O8=l9(H),_8=l9(U),D8=l9(U),M8=l9(U),R8(N8=u9(N8=L8((z8=r((B8=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"congratulation",z8,l(e)),s(e,"confirmation",F8,l(e)),s(e,"closeButtonComponent",U8,l(e)),s(e,"yesButtonComponent",G8,l(e)),s(e,"noButtonComponent",H8,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("CongratulationScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.yesButtonComponent.interactable=!0,e.noButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(o,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.confirmationUIOpacity=this.confirmation.getComponent(M),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){h9.on(p9.OPENING_SCREEN,this.handleOpeningScreen),h9.on(p9.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){h9.off(p9.OPENING_SCREEN,this.handleOpeningScreen),h9.off(p9.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.confirmation.active=!1,this.congratulation.active=!0}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.yesButtonComponent.interactable=!1,this.noButtonComponent.interactable=!1,nt.closeScreen(it.CONGRATULATION_SCREEN)}},{key:"handleStartOver",value:function(){this.confirmation.active=!0,this.congratulation.active=!1,L(this.confirmationUIOpacity).set({opacity:0}).to(.2,{opacity:255}).start(),L(this.confirmation).set({scale:new q(.8,.8,.8)}).to(.2,{scale:new q(1,1,1)},{easing:"backOut"}).start()}},{key:"handleYesStartOver",value:function(){this.close(),this.node.scene.emit(Us.START_OVER,1)}},{key:"handleNoStartOver",value:function(){this.requestGameReplay()}},{key:"handleClickedClose",value:function(){this.requestGameReplay()}},{key:"requestGameReplay",value:function(){this.close(),this.node.scene.emit(Us.GAME_REPLAY)}}]),o}(x)).prototype,"congratulation",[I8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F8=r(B8.prototype,"confirmation",[O8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U8=r(B8.prototype,"closeButtonComponent",[_8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G8=r(B8.prototype,"yesButtonComponent",[D8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H8=r(B8.prototype,"noButtonComponent",[M8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N8=B8))||N8)||N8);w._RF.pop(),w._RF.push({},"dc7da51sglB44qYIJOboZkL","HorizontalSelector",void 0);var d9,y9,f9,v9,m9,g9,b9,w9,k9,S9,C9,E9,x9,A9,T9,P9,R9=S.ccclass,L9=S.property,I9=(K8=R9("HorizontalSelector"),j8=L9({type:W,tooltip:"Component initializes on its own in its preload method. Turn off if you want to initialize it manually."}),Y8=L9({type:C,visible:function(){return!this.selfInitialize}}),J8=L9({type:T,visible:function(){return!this.selfInitialize}}),Z8=L9(W),X8=L9(Y),Q8=L9(F),K8((t9=r((e9=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"selfInitialize",t9,l(e)),s(e,"items",n9,l(e)),s(e,"currentIndex",i9,l(e)),s(e,"loop",r9,l(e)),s(e,"selectedItemLabel",a9,l(e)),s(e,"onSelectEvents",o9,l(e)),e.selectedItem="",e}return e(o,[{key:"__preload",value:function(){this.selfInitialize||this.init(this.items,this.currentIndex)}},{key:"init",value:function(e,t,n){this.items=e,this.currentIndex=t,void 0!==n&&(this.loop=n),this.selectedItem=this.items[this.currentIndex],this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem)}},{key:"selectNext",value:function(){(this.loop||this.currentIndex!==this.items.length-1)&&(this.currentIndex=(this.currentIndex+1)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"selectPrevious",value:function(){(this.loop||0!==this.currentIndex)&&(this.currentIndex=(this.currentIndex-1+this.items.length)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"getSelectedItem",value:function(){return this.selectedItem}},{key:"getSelectedIndex",value:function(){return this.currentIndex}},{key:"getItems",value:function(){return this.items}},{key:"setSelectedItem",value:function(e){this.selectedItem=this.items[e],this.currentIndex=e,this.emitOnSelectedEvents()}},{key:"emitOnSelectedEvents",value:function(){this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem);var e,t=c(this.onSelectEvents);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.emit([this.selectedItem,n.customEventData])}}catch(e){t.e(e)}finally{t.f()}}}]),o}(x)).prototype,"selfInitialize",[j8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n9=r(e9.prototype,"items",[Y8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i9=r(e9.prototype,"currentIndex",[J8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r9=r(e9.prototype,"loop",[Z8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a9=r(e9.prototype,"selectedItemLabel",[X8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o9=r(e9.prototype,"onSelectEvents",[Q8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$8=e9))||$8);w._RF.pop(),w._RF.push({},"50306JI4lZMEqIc8ZHjuEgn","CustomGameScreen",void 0);var O9,_9,D9,M9,N9,B9,z9,F9,U9,G9,H9,q9,V9,W9,K9,j9,Y9,J9,Z9,X9,Q9,$9,e7,t7=S.ccclass,n7=S.property,i7=S.requireComponent,r7=Ludex.Events,a7=codex,o7=a7.event,s7=a7.player;d9=t7("CustomGameScreen"),y9=i7(k8),f9=n7(U),v9=n7({type:I9,group:"Selectors"}),m9=n7({type:I9,group:"Selectors"}),g9=n7({type:I9,group:"Selectors"}),b9=n7({type:GX,group:"Selectors"}),w9=n7(Y),d9(k9=y9((C9=r((S9=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"playButton",C9,l(e)),s(e,"timeSelector",E9,l(e)),s(e,"difficultySelector",x9,l(e)),s(e,"bombsSelector",A9,l(e)),s(e,"extraAdsSwitch",T9,l(e)),s(e,"bonusLabel",P9,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StartLevelScreen: screen not found");e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){o7.on(r7.OPENING_SCREEN,this.handleOpeningScreen),o7.on(r7.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){o7.off(r7.OPENING_SCREEN,this.handleOpeningScreen),o7.off(r7.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(e){this.setInteractableButtons(!1),this.node.scene.emit(Us.SHOW_UI),o7.emit(r7.CLOSE_SCREEN,{screenName:this.node.name,screenData:{customMode:e}})}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"updateStatus",value:function(){var e=Ly.time,t=Ly.difficulty,n=Ly.bombs,i=Ry.getCustomData();this.timeSelector.init(e.map((function(e){return e<0?"".concat(e,"%"):"+".concat(e,"%")})),i.time),this.difficultySelector.init(v(t),i.difficulty),this.bombsSelector.init(n.map((function(e){return"".concat(e)})),i.bombs),this.extraAdsSwitch.setEnabled(i.ads),this.calculateBonus()}},{key:"handleClickedPlay",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.close(!0);case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleSelectedTime",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedDifficulty",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedBombs",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSwitchedExtraAds",value:function(){this.extraAdsSwitch.switch(),this.updateCustomGameData(),this.calculateBonus()}},{key:"updateCustomGameData",value:function(){var e=this.timeSelector.getSelectedIndex(),t=this.difficultySelector.getSelectedIndex(),n=this.bombsSelector.getSelectedIndex();s7.setGameData({custom:{time:e,difficulty:t,bombs:n,ads:this.extraAdsSwitch.enable}})}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.screen.backgroundMask.getComponent(U).interactable=e}},{key:"calculateBonus",value:function(){var e=Ry.getCustomBonus();this.bonusLabel.string=e>=0?"+".concat(e,"%"):"".concat(e,"%")}}]),p}(x)).prototype,"playButton",[f9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E9=r(S9.prototype,"timeSelector",[v9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x9=r(S9.prototype,"difficultySelector",[m9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A9=r(S9.prototype,"bombsSelector",[g9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T9=r(S9.prototype,"extraAdsSwitch",[b9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P9=r(S9.prototype,"bonusLabel",[w9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k9=S9))||k9);w._RF.pop(),w._RF.push({},"01c067hcjNDc7prJzSE6UEq","DayBlock",void 0);var l7,u7,c7,p7,h7,d7,y7,f7,v7,m7,g7,b7,w7,k7,S7,C7,E7,x7,A7,T7,P7,R7,L7,I7,O7,_7,D7,M7,N7,B7,z7,F7,U7,G7,H7,q7,V7,W7,K7,j7,Y7,J7,Z7,X7=S.ccclass,Q7=S.property,$7=(O9=X7("DayBlock"),_9=Q7({type:N,group:"Background"}),D9=Q7({type:N,group:"Background"}),M9=Q7({type:se,group:"Background"}),N9=Q7({type:se,group:"Background"}),B9=Q7(Y),z9=Q7(cp),F9=Q7(Y),U9=Q7(H),G9=Q7(H),H9=Q7(H),O9((W9=r((V9=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"background",W9,l(e)),s(e,"topBackground",K9,l(e)),s(e,"blueBackground",j9,l(e)),s(e,"blueTopBackground",Y9,l(e)),s(e,"dayLabel",J9,l(e)),s(e,"dayLocalizer",Z9,l(e)),s(e,"coinLabel",X9,l(e)),s(e,"rewardItemsNode",Q9,l(e)),s(e,"checkNode",$9,l(e)),s(e,"glowNodes",e7,l(e)),e}return e(o,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(M),this.initDefaultProperties(),this.validateRequiredComponents()}},{key:"initDefaultProperties",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultTopBackground=this.topBackground.spriteFrame,this.defaultDayLabelOutlineColor=new j(this.dayLabel.outlineColor),this.blueDayLabelOutlineColor=new j("#3469bf")}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e){this.updateBackground(e),this.updateDayLabel(e),this.coinLabel.string=e.value.toString(),this.updateRewardItems(e)}},{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"rewarded":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"rewarded"!==e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.outlineColor=t,this.dayLabel.shadowColor=t}},{key:"updateRewardItems",value:function(e){switch(e.status){case"ready":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!0);break;case"waiting":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!1);break;case"rewarded":this.rewardItemsNode.active=!1,this.checkNode.active=!0,this.setGlowNodesActive(!1)}}},{key:"setGlowNodesActive",value:function(e){this.glowNodes&&this.glowNodes.forEach((function(t){t.active=e}))}}]),o}(x)).prototype,"background",[_9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K9=r(V9.prototype,"topBackground",[D9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j9=r(V9.prototype,"blueBackground",[M9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y9=r(V9.prototype,"blueTopBackground",[N9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J9=r(V9.prototype,"dayLabel",[B9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z9=r(V9.prototype,"dayLocalizer",[z9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X9=r(V9.prototype,"coinLabel",[F9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q9=r(V9.prototype,"rewardItemsNode",[U9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$9=r(V9.prototype,"checkNode",[G9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e7=r(V9.prototype,"glowNodes",[H9],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q9=V9))||q9);w._RF.pop(),w._RF.push({},"cc662r8eR5Al6FdOBdcAkHG","DailyRewardsScreen",void 0);var eee,tee=S.ccclass,nee=S.property,iee=S.requireComponent,ree=Ludex,aee=ree.Events,oee=ree.Utils,see=oee.Array,lee=oee.Signal,uee=ree.Plugins.Ads,cee=(void 0===uee?{}:uee).Types,pee=codex,hee=pee.event,dee=pee.player;l7=tee("DailyRewardsScreen"),u7=iee(k8),c7=Ii.required(),p7=Ii.required(),h7=nee(H),d7=Ii.required(),y7=nee(U),f7=Ii.required(),v7=nee(U),m7=Ii.required(),g7=nee(U),b7=Ii.required(),w7=nee(U),k7=Ii.required(),S7=nee(U),C7=Ii.required(),E7=nee(H),x7=Ii.required(),A7=nee(H),T7=Ii.required(),P7=nee(H),R7=nee([$7]),L7=Ii.onlyRunInLifeCycle,I7=Ii.onlyRunInLifeCycleAsync,O7=Ii.onlyRunInLifeCycle,_7=Ii.onlyRunInLifeCycleAsync,D7=Ii.onlyRunInLifeCycleAsync,M7=Ii.onlyRunInLifeCycle,N7=Ii.onlyRunInLifeCycle,B7=Ii.onlyRunInLifeCycle,l7(z7=u7((U7=r((F7=function(r){n(v,r);var u,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"screen",U7,l(e)),e.rewardsData=[],s(e,"loadingRing",G7,l(e)),s(e,"claimButton",H7,l(e)),s(e,"claimX2Button",q7,l(e)),s(e,"closeButton",V7,l(e)),s(e,"backgroundButton",W7,l(e)),s(e,"continueButton",K7,l(e)),s(e,"claimButtonScallableNode",j7,l(e)),s(e,"claimX2ButtonScallableNode",Y7,l(e)),s(e,"continueButtonScallableNode",J7,l(e)),s(e,"dailyBlocks",Z7,l(e)),e.dailyLoadingController=new lee.SignalController,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.setLoading())},e.handleOpenedScreen=function(){var t=a(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validateEventPayload(n)){t.next=2;break}return t.abrupt("return");case 2:e.open();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return e(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),Ii.validateRequiredProperties(this,v),this.listenScreenEvents(),cee&&at.preloadAdsByType(cee.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){hee.on(aee.OPENING_SCREEN,this.handleOpeningScreen),hee.on(aee.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){hee.off(aee.OPENING_SCREEN,this.handleOpeningScreen),hee.off(aee.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"setLoading",value:function(){this.loadingRing.active=!0;var e,t=c(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){e.value.uiOpacity.opacity=0}}catch(e){t.e(e)}finally{t.f()}this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.setInteractableButtons(!0),this.node.scene.emit(Us.HIDE_UI),this.openAsync()}},{key:"openAsync",value:(y=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.dailyLoadingController.renew(),n=!MU.hasShownPopup(),e.next=4,MU.getRewardsData();case 4:if(null!==(i=e.sent)){e.next=8;break}return this.close(),e.abrupt("return");case 8:if(r=see.search(i,(function(e){return"ready"===e.status})),this.updateScreenData(i,r),!n){e.next=15;break}return e.next=13,this.runPopUpAnim(t);case 13:e.next=16;break;case 15:this.showElements();case 16:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"updateScreenData",value:function(e,t){this.rewardsData=e,this.currentRewardsData=t;for(var n=0,i=this.dailyBlocks.length;n<i;n++){var r=this.rewardsData[n],a=this.dailyBlocks[n],o=r.id,s=r.type,l=r.value,u=r.status;a.updateInfo({day:o,type:s,value:l,status:u})}}},{key:"close",value:function(){MU.setHasShownPopup(),this.setInteractableButtons(!1),this.dailyLoadingController.abort(),hee.emit(aee.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Us.SHOW_UI)}},{key:"runPopUpAnim",value:(d=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingRing.active=!1,e.next=3,Promise.all(this.dailyBlocks.map((function(e,i){return n.runBlockPopUpAnim(e,.15*i,t)})));case 3:return e.next=5,this.runButtonPopUpAnim(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"showElements",value:function(){this.loadingRing.active=!1;var e,t=c(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.uiOpacity.opacity=255,n.node.setScale(1,1,1)}}catch(e){t.e(e)}finally{t.f()}void 0===this.currentRewardsData?(this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(1,1,1)):(this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(1,1,1),this.claimX2ButtonScallableNode.setScale(1,1,1))}},{key:"runButtonPopUpAnim",value:(h=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.currentRewardsData){e.next=8;break}return this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(0,0,0),e.next=7,Ue.runTweenAsync(L(this.continueButtonScallableNode).to(.3,{scale:q.ONE},{easing:"backOut"}),t);case 7:return e.abrupt("return");case 8:return this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(0,0,0),this.claimX2ButtonScallableNode.setScale(0,0,0),e.next=15,Promise.all([Ue.runTweenAsync(L(this.claimButtonScallableNode).to(.3,{scale:q.ONE},{easing:"backOut"}),t),Ue.runTweenAsync(L(this.claimX2ButtonScallableNode).delay(.1).to(.3,{scale:q.ONE},{easing:"backOut"}),t)]);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"runBlockPopUpAnim",value:(p=a(o().mark((function e(t,n,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.node.setScale(1.2,1.2,1.2),t.uiOpacity.opacity=0,r=Ue.runTweenAsync(L(t.uiOpacity).delay(n).to(.3,{opacity:255},{easing:"quadOut"}),i),a=Ue.runTweenAsync(L(t.node).delay(n).to(.3,{scale:q.ONE},{easing:"backOut"}),i),e.next=6,Promise.all([r,a]);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"handleOnClaim",value:function(){void 0!==this.currentRewardsData?(this.setInteractableButtons(!1),this.claimReward(this.currentRewardsData)):nt.showNotificationScreenWithLocalizedKey("error.rewardFail",2)}},{key:"handleOnClaimX2",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.currentRewardsData){e.next=3;break}return nt.showNotificationScreenWithLocalizedKey("error.rewardFail",2),e.abrupt("return");case 3:return this.setInteractableButtons(!1),e.next=6,at.showRewardVideoAdAsync();case 6:if(e.sent){e.next=10;break}return this.setInteractableButtons(!0),e.abrupt("return");case 10:this.claimReward(this.currentRewardsData,!0);case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"claimReward",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];MU.logLoginReward();var n=e.value*(t?2:1);this.node.scene.emit(Us.ADD_COINS,{coins:n,collectionAnimation:{animateTextOnly:!1}});var i=dee.getGameData();if(e.items&&i){var r=e.items.hint*(t?2:1),a=e.items.thunder*(t?2:1),o=e.items.storm*(t?2:1);dee.setGameData({items:{hint:i.items.hint+r,thunder:i.items.thunder+a,storm:i.items.storm+o,pliers:i.items.pliers}})}this.close()}},{key:"setInteractableButtons",value:function(e){this.claimButton.interactable=e,this.claimX2Button.interactable=e,this.closeButton.interactable=e,this.backgroundButton.interactable=e,this.continueButton.interactable=e}}]),v}(x)).prototype,"screen",[c7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G7=r(F7.prototype,"loadingRing",[p7,h7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H7=r(F7.prototype,"claimButton",[d7,y7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q7=r(F7.prototype,"claimX2Button",[f7,v7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V7=r(F7.prototype,"closeButton",[m7,g7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W7=r(F7.prototype,"backgroundButton",[b7,w7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K7=r(F7.prototype,"continueButton",[k7,S7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j7=r(F7.prototype,"claimButtonScallableNode",[C7,E7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y7=r(F7.prototype,"claimX2ButtonScallableNode",[x7,A7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J7=r(F7.prototype,"continueButtonScallableNode",[T7,P7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z7=r(F7.prototype,"dailyBlocks",[R7],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),r(F7.prototype,"updateScreenData",[L7],Object.getOwnPropertyDescriptor(F7.prototype,"updateScreenData"),F7.prototype),r(F7.prototype,"runPopUpAnim",[I7],Object.getOwnPropertyDescriptor(F7.prototype,"runPopUpAnim"),F7.prototype),r(F7.prototype,"showElements",[O7],Object.getOwnPropertyDescriptor(F7.prototype,"showElements"),F7.prototype),r(F7.prototype,"runButtonPopUpAnim",[_7],Object.getOwnPropertyDescriptor(F7.prototype,"runButtonPopUpAnim"),F7.prototype),r(F7.prototype,"runBlockPopUpAnim",[D7],Object.getOwnPropertyDescriptor(F7.prototype,"runBlockPopUpAnim"),F7.prototype),r(F7.prototype,"handleOnClaim",[M7],Object.getOwnPropertyDescriptor(F7.prototype,"handleOnClaim"),F7.prototype),r(F7.prototype,"claimReward",[N7],Object.getOwnPropertyDescriptor(F7.prototype,"claimReward"),F7.prototype),r(F7.prototype,"setInteractableButtons",[B7],Object.getOwnPropertyDescriptor(F7.prototype,"setInteractableButtons"),F7.prototype),z7=F7))||z7);w._RF.pop(),w._RF.push({},"5a6aeaMAdtMGYA8B1wIuhDa","DayBlockRed",void 0);var yee,fee,vee,mee,gee,bee,wee,kee,See,Cee;(0,S.ccclass)("DayBlockRed")(eee=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o,[{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"ready"===e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.shadowColor=t,this.dayLabel.outlineColor=t}}]),o}($7));w._RF.pop(),w._RF.push({},"6fed95tFh5MRKzFqaFB2Ts8","GetCoinScreen",void 0);var Eee,xee,Aee,Tee,Pee,Ree,Lee,Iee,Oee,_ee,Dee,Mee,Nee,Bee,zee,Fee,Uee,Gee,Hee,qee,Vee,Wee,Kee,jee,Yee,Jee,Zee,Xee,Qee,$ee,ete,tte=S.ccclass,nte=S.property,ite=S.requireComponent,rte=codex.event,ate=Ludex,ote=ate.Events,ste=ate.Plugins.Ads,lte=(void 0===ste?{}:ste).Types;yee=tte("GetCoinScreen"),fee=ite(k8),vee=nte(Y),mee=nte(U),gee=nte(U),yee(bee=fee((kee=r((wee=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"quantityLabel",kee,l(e)),s(e,"closeButtonComponent",See,l(e)),s(e,"getNowButtonComponent",Cee,l(e)),e.handleOpeningScreen=function(t){console.log("GetCoinScreen.OPENING_SCREEN",t),e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),lte&&at.preloadAdsByType(lte.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){rte.on(ote.OPENING_SCREEN,this.handleOpeningScreen),rte.on(ote.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){rte.off(ote.OPENING_SCREEN,this.handleOpeningScreen),rte.off(ote.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return"screenName"in e&&(e.screenName===this.node.name&&(this.payload=e,!0))}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),rte.emit(ote.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Us.SHOW_UI)}},{key:"updateStatus",value:function(){this.updateCoinQuantity()}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("GetCoinScreen: screen not found")}},{key:"updateCoinQuantity",value:function(){var e=this.getQuantity();e&&this.updateQuantityLabel(e)}},{key:"updateQuantityLabel",value:function(e){this.quantityLabel.string="x".concat(e.toString())}},{key:"getQuantity",value:function(){var e=this.payload.screenData;return e&&"quantity"in e&&e.quantity&&"number"==typeof e.quantity?e.quantity:0}},{key:"handleAddCoin",value:function(){var e=this.getQuantity();this.node.scene.emit(Us.ADD_COINS,{coins:e,collectionAnimation:{animateTextOnly:!1},skipAnimation:!0}),this.close()}},{key:"handleGetNowButtonClicked",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ve.stopAllSounds(),e.next=3,at.showRewardVideoAdAsync();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:this.handleAddCoin();case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),p}(x)).prototype,"quantityLabel",[vee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),See=r(wee.prototype,"closeButtonComponent",[mee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cee=r(wee.prototype,"getNowButtonComponent",[gee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bee=wee))||bee);w._RF.pop(),w._RF.push({},"f016fTAlsNKRYkdu72AyCLI","GetItemScreen",void 0);var ute,cte,pte,hte,dte,yte,fte,vte,mte,gte,bte=S.ccclass,wte=S.property,kte=codex,Ste=kte.event,Cte=kte.player,Ete=kte.analytics,xte=kte.language,Ate=Ludex,Tte=Ate.Events,Pte=Ate.Utils.Array,Rte=Ate.Plugins,Lte=Rte.Ads,Ite=(void 0===Lte?{}:Lte).Types,Ote=Rte.Analytics,_te=(void 0===Ote?{}:Ote).Events,Dte=Object.values(Xe);Eee=bte("GetItemScreen"),xee=wte({type:ye,group:"Item"}),Aee=wte({type:N,group:"Item"}),Tee=wte({type:se,group:"Item"}),Pee=wte({type:se,group:"Item"}),Ree=wte({type:se,group:"Item"}),Lee=wte({type:se,group:"Item"}),Iee=wte({type:Y,group:"Title"}),Oee=wte({type:cp,group:"Title"}),_ee=wte({type:Y,group:"Description"}),Dee=wte({type:cp,group:"Description"}),Mee=wte(Y),Nee=wte({type:U,group:"Buttons"}),Bee=wte({type:U,group:"Buttons"}),zee=wte({type:U,group:"Buttons"}),Eee((Gee=r((Uee=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"itemFxPrefab",Gee,l(e)),s(e,"itemSprite",Hee,l(e)),s(e,"hintSpriteFrame",qee,l(e)),s(e,"stormSpriteFrame",Vee,l(e)),s(e,"thunderSpriteFrame",Wee,l(e)),s(e,"pliersSpriteFrame",Kee,l(e)),s(e,"titleLabel",jee,l(e)),s(e,"titleLocalizer",Yee,l(e)),s(e,"descriptionLabel",Jee,l(e)),s(e,"descriptionLocalizer",Zee,l(e)),s(e,"coinLabel",Xee,l(e)),s(e,"closeButtonComponent",Qee,l(e)),s(e,"buyItemButtonComponent",$ee,l(e)),s(e,"getNowButtonComponent",ete,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("GetItemScreen: screen not found");e.validateEventPayload(t)&&e.validateEventPayloadData(t.screenData)&&(e.setInteractableButtons(!0),e.data=t.screenData,e.updateStatus(t.screenData))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(d,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),Ite&&at.preloadAdsByType(Ite.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Ste.on(Tte.OPENING_SCREEN,this.handleOpeningScreen),Ste.on(Tte.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Ste.off(Tte.OPENING_SCREEN,this.handleOpeningScreen),Ste.off(Tte.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"validateEventPayloadData",value:function(e){return!!e&&(!(!("item"in e)||!Pte.has(Dte,e.item))&&("quantity"in e&&"number"==typeof e.quantity&&!("localizedMessageKey"in e&&void 0!==e.localizedMessageKey&&!xte.hasTextKey(e.localizedMessageKey))))}},{key:"open",value:function(){this.node.scene.emit(Us.GAME_PAUSE)}},{key:"close",value:function(){this.setInteractableButtons(!1),Ste.emit(Tte.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Us.GAME_RESUME)}},{key:"updateStatus",value:function(e){this.updateItemIcon(e.item),this.updateTitle(e.item),e.localizedMessageKey&&this.updateDescription(e.localizedMessageKey),this.updateButtons(e.item)}},{key:"updateItemIcon",value:function(e){switch(e){case Xe.HINT:this.itemSprite.spriteFrame=this.hintSpriteFrame;break;case Xe.STORM:this.itemSprite.spriteFrame=this.stormSpriteFrame;break;case Xe.THUNDER:this.itemSprite.spriteFrame=this.thunderSpriteFrame;break;case Xe.PLIERS:this.itemSprite.spriteFrame=this.pliersSpriteFrame}}},{key:"getItemLocalizedTitleKey",value:function(e){switch(e){case Xe.HINT:return"item.hint";case Xe.STORM:return"item.storm";case Xe.THUNDER:return"item.thunder";case Xe.PLIERS:return"item.pliers"}}},{key:"updateTitle",value:function(e){this.titleLocalizer.key=this.getItemLocalizedTitleKey(e)}},{key:"updateDescription",value:function(e){this.descriptionLocalizer.key=e}},{key:"updateButtons",value:function(e){var t=this.canBuyItem(e);this.buyItemButtonComponent.node.active=t,this.getNowButtonComponent.node.active=!t,t&&(this.coinLabel.string="".concat(3*Ld[e]))}},{key:"canBuyItem",value:function(e){var t=Cte.getGameData();return!!t&&t.coins>=3*Ld[e]}},{key:"handleAddItem",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data.item){e.next=2;break}return e.abrupt("return");case 2:_te&&Ete.event(_te.EARN_ITEM,{item_name:this.data.item,value:3}),this.node.scene.emit(Us.ADD_ITEM,{animate:{startWorldPosition:this.itemSprite.node.worldPosition.clone()},item:this.data.item,quantity:3});case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleGetNowButtonClicked",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopAllSounds(),e.next=3,at.showRewardVideoAdAsync();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:this.handleAddItem(),this.close();case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleBuyItemButtonClicked",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.scene.emit(Us.REMOVE_COINS,{coins:3*Ld[this.data.item],collectionAnimation:{animateTextOnly:!0}}),this.handleAddItem(),this.close();case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"stopAllSounds",value:function(){var e;null===(e=re("Sound"))||void 0===e||null===(e=e.getComponent(hn))||void 0===e||e.stopAll()}},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.buyItemButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),d}(x)).prototype,"itemFxPrefab",[xee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hee=r(Uee.prototype,"itemSprite",[Aee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qee=r(Uee.prototype,"hintSpriteFrame",[Tee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vee=r(Uee.prototype,"stormSpriteFrame",[Pee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wee=r(Uee.prototype,"thunderSpriteFrame",[Ree],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kee=r(Uee.prototype,"pliersSpriteFrame",[Lee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jee=r(Uee.prototype,"titleLabel",[Iee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yee=r(Uee.prototype,"titleLocalizer",[Oee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jee=r(Uee.prototype,"descriptionLabel",[_ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zee=r(Uee.prototype,"descriptionLocalizer",[Dee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xee=r(Uee.prototype,"coinLabel",[Mee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qee=r(Uee.prototype,"closeButtonComponent",[Nee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$ee=r(Uee.prototype,"buyItemButtonComponent",[Bee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ete=r(Uee.prototype,"getNowButtonComponent",[zee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fee=Uee));w._RF.pop(),w._RF.push({},"4d6710xA7hAk65cGA4Dgdrc","GetRewardsScreen",void 0);var Mte,Nte=S.ccclass,Bte=S.requireComponent,zte=S.property,Fte=Ludex,Ute=Fte.Events,Gte=Fte.Plugins.Ads,Hte=(void 0===Gte?{}:Gte).Types,qte=codex.event;ute=Nte("GetRewardsScreen"),cte=Bte(k8),pte=zte(cp),hte=zte(U),dte=zte(U),ute(yte=cte((vte=r((fte=function(r){n(d,r);var u,c,p,h=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=h.call.apply(h,[this].concat(i)),s(e,"countDownLocalizer",vte,l(e)),s(e,"skipButton",mte,l(e)),s(e,"claimButton",gte,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(d,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),Hte&&at.preloadAdsByType(Hte.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){qte.on(Ute.OPENING_SCREEN,this.handleOpeningScreen),qte.on(Ute.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){qte.off(Ute.OPENING_SCREEN,this.handleOpeningScreen),qte.off(Ute.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.runCountdownAnimation()}},{key:"close",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setInteractableButtons(!1),qte.emit(Ute.CLOSE_SCREEN,{screenName:this.node.name,screenData:{getRewardsSuccess:e,rewardsAdShown:t}})}},{key:"runCountdownAnimation",value:function(){var e=this,t=5;this.countDownLocalizer.setParams([t.toString()]);this.schedule((function(){t<=0?e.stopCountdownAnimation():(3===--t&&e.runButtonAnimation(),e.countDownLocalizer.setParams([t.toString()]))}),1,6)}},{key:"stopCountdownAnimation",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.unscheduleAllCallbacks(),!GameSDK.isGameSDK("Yandex")){e.next=4;break}return this.close(!1),e.abrupt("return");case 4:return e.next=6,at.showRewardedInterstitialAdAsync();case 6:t=e.sent,this.close(t,!0);case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleClickedSkip",value:function(){this.unscheduleAllCallbacks(),this.close(!1)}},{key:"handleClickedClaim",value:(c=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.unscheduleAllCallbacks(),e.next=3,at.showRewardedInterstitialAdAsync();case 3:t=e.sent,this.close(t,!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"runButtonAnimation",value:(u=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameSDK.isGameSDK("Yandex")?this.claimButton:this.skipButton,n=t.node.getComponent(M)){e.next=4;break}return e.abrupt("return");case 4:return i=L(n).to(.3,{opacity:255}),e.next=7,Ue.runTweenAsync(i);case 7:this.setInteractableButtons(!0);case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"updateStatus",value:function(){var e=GameSDK.isGameSDK("Yandex");this.skipButton.node.active=!e,this.claimButton.node.active=e,this.countDownLocalizer.key=e?"ads.levelAfterT":"ads.adAfterT",this.skipButton.getComponent(M).opacity=0,this.claimButton.getComponent(M).opacity=0}},{key:"setInteractableButtons",value:function(e){this.skipButton.interactable=e,this.claimButton.interactable=e}}]),d}(x)).prototype,"countDownLocalizer",[pte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mte=r(fte.prototype,"skipButton",[hte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gte=r(fte.prototype,"claimButton",[dte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yte=fte))||yte);w._RF.pop(),w._RF.push({},"bfe1eXch0ZMKIz1ofLKc2Iv","HardLevelScreen",void 0);var Vte,Wte,Kte,jte,Yte,Jte,Zte,Xte,Qte,$te,ene,tne,nne,ine=S.ccclass,rne=S.requireComponent,ane=Ludex,one=ane.Events,sne=ane.Plugins.Ads,lne=(void 0===sne?{}:sne).Types,une=codex.event;ine("HardLevelScreen")(Mte=rne(k8)(Mte=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(o,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),lne&&at.preloadAdsByType(lne.REWARDED_INTERSTITIAL)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){une.on(one.OPENING_SCREEN,this.handleOpeningScreen),une.on(one.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){une.off(one.OPENING_SCREEN,this.handleOpeningScreen),une.off(one.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation()}},{key:"close",value:function(){nt.closeScreen(it.HARD_LEVEL_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}}]),o}(x))||Mte);w._RF.pop(),w._RF.push({},"2db0dg4dI9GCKCdFOMrBFsQ","GetRewardsEffect",void 0);var cne,pne,hne,dne,yne,fne,vne,mne,gne,bne,wne,kne,Sne,Cne,Ene,xne,Ane,Tne,Pne,Rne,Lne,Ine,One,_ne,Dne,Mne,Nne,Bne,zne,Fne,Une,Gne,Hne,qne,Vne,Wne,Kne,jne,Yne,Jne,Zne,Xne,Qne,$ne,eie=S.ccclass,tie=S.property,nie=(Vte=eie("GetRewardsEffect"),Wte=tie(se),Kte=tie(se),jte=tie(se),Yte=tie(se),Jte=tie(Ex),Vte((Qte=r((Xte=function(r){n(h,r);var u,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"hint",Qte,l(e)),s(e,"thunder",$te,l(e)),s(e,"storm",ene,l(e)),s(e,"pliers",tne,l(e)),s(e,"particles",nne,l(e)),e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"playAnimation",value:(u=a(o().mark((function e(t,n){var i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=30*(t.length-1),r=-i/2+90,e.next=4,Promise.all(t.map((function(e,t){var i=a.createSprite(e),o=r+30*t,s=.15*t;i.node.position=new q(300*Math.cos(o*(Math.PI/180)),300*Math.sin(o*(Math.PI/180)),0);var l=L(i.node);return l.delay(s),l.to(.6,{position:q.ZERO,scale:new q(.7,.7,.7)},{easing:"backIn"}),Ue.runTweenAsync(l).then((function(){n(),Ve.playSound(Ji.COLLECT_STARS),a.playExplodeEffect(),i.node.destroy()}))})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})},{key:"playExplodeEffect",value:function(){var e,t=c(this.particles);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.play()}}catch(e){t.e(e)}finally{t.f()}}},{key:"createSprite",value:function(e){var t=this.getSpriteFrame(e),n=(new H).addComponent(N);return n.spriteFrame=t,n.node.parent=this.node,n.node.scale=new q(1.5,1.5,1.5),n}},{key:"getSpriteFrame",value:function(e){switch(e){case"hint":return this.hint;case"thunder":return this.thunder;case"storm":return this.storm;case"pliers":return this.pliers;default:return null}}}]),h}(x)).prototype,"hint",[Wte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$te=r(Xte.prototype,"thunder",[Kte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ene=r(Xte.prototype,"storm",[jte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tne=r(Xte.prototype,"pliers",[Yte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nne=r(Xte.prototype,"particles",[Jte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zte=Xte))||Zte);w._RF.pop(),w._RF.push({},"31829DUddVEq6NgIYHvnI68","LevelCompleteScreen",void 0);var iie,rie,aie,oie,sie,lie,uie,cie,pie,hie,die,yie=S.ccclass,fie=S.property,vie=S.requireComponent,mie=Ludex,gie=mie.Events,bie=mie.Utils,wie=bie.Valid,kie=bie.Signal,Sie=mie.Plugins.Ads,Cie=(void 0===Sie?{}:Sie).Types,Eie=codex,xie=Eie.event,Aie=Eie.player;cne=yie("LevelCompleteScreen"),pne=vie(k8),hne=fie(Y),dne=fie(Y),yne=fie(M),fne=fie(nie),vne=fie({type:U,group:"Play Button"}),mne=fie({type:H,group:"Play Button"}),gne=fie({type:M,group:"Play Button"}),bne=fie({type:H,group:"Play Button"}),wne=fie({type:H,group:"Play Button"}),kne=fie({type:U,group:"Home Button"}),Sne=fie({type:le,group:"Coin Container"}),Cne=fie({type:YM,group:"Coin Container"}),Ene=fie({type:le,group:"Coin Container"}),xne=fie({type:ue,group:"Coin Container"}),Ane=fie({type:ue,group:"Coin Container"}),Tne=fie({type:Ex,group:"Particles"}),Pne=fie({type:Ex,group:"Particles"}),Rne=fie({type:Ex,group:"Particles"}),Lne=fie(M),Ine=fie(cp),cne(One=pne((Dne=r((_ne=function(r){n(b,r);var u,c,p,h,d,y,f,v,m,g=i(b);function b(){var e;t(this,b);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=g.call.apply(g,[this].concat(i))).level=1,e.coins=40,e.currentCoins=0,e.score=0,e.playAnimation=!1,e.getRewardsSuccess=!1,e.lookingForRewards=!1,e.playAnimationSignal=new An,s(e,"coinText",Dne,l(e)),s(e,"scoreText",Mne,l(e)),s(e,"lookingForRewardsText",Nne,l(e)),s(e,"getRewardsEffect",Bne,l(e)),s(e,"playButton",zne,l(e)),s(e,"playBackground",Fne,l(e)),s(e,"shineBackground",Une,l(e)),s(e,"hardLevelBackground",Gne,l(e)),s(e,"buttonsContainer",Hne,l(e)),s(e,"homeButton",qne,l(e)),s(e,"coinAnimation",Vne,l(e)),s(e,"coinContainer",Wne,l(e)),s(e,"coinContainerAnimation",Kne,l(e)),s(e,"coinContainerEnterClip",jne,l(e)),s(e,"coinContainerExitClip",Yne,l(e)),s(e,"leftConfetti",Jne,l(e)),s(e,"rightConfetti",Zne,l(e)),s(e,"bokehParticles",Xne,l(e)),s(e,"welldoneUiOpacity",Qne,l(e)),s(e,"welldoneLocalize",$ne,l(e)),e.localizeVisibilityController=new kie.SignalController,e.coinContainerShown=!1,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.hideTextUntilLocalized())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleParticleEnd=a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.level){t.next=3;break}return t.next=3,Ue.waitTweenAsync(.15);case 3:return t.next=5,Promise.all([e.animateCoin(),e.animateScore()]);case 5:if(!e.lookingForRewards){t.next=10;break}return t.next=8,e.handleLookingForRewards();case 8:t.next=12;break;case 10:return t.next=12,e.animateVisibleButtonContainer(!0);case 12:case"end":return t.stop()}}),t)}))),e}return e(b,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.localizeVisibilityController.abort()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){xie.on(gie.OPENING_SCREEN,this.handleOpeningScreen),xie.on(gie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){xie.off(gie.OPENING_SCREEN,this.handleOpeningScreen),xie.off(gie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"hideTextUntilLocalized",value:(m=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.localizeVisibilityController.renew(),this.welldoneUiOpacity.opacity=0,e.next=4,this.welldoneLocalize.waitUntilLocalized();case 4:if(!t.aborted){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Ue.runTweenAsync(L(this.welldoneUiOpacity).to(.5,{opacity:255}),t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){var t=null!=e?e:{},n=t.screenName,i=t.screenData;return n===this.node.name&&(!!wie.isObject(i)&&(wie.isNumber(i.level)&&(this.level=i.level,this.coins=this.level<5?Td:Pd),wie.isNumber(i.coins)&&(this.currentCoins=i.coins),wie.isNumber(i.score)&&(this.score=i.score),this.playAnimation=!1,wie.isObject(i.overrideAnimation)&&(this.playAnimation="LevelCompleteOpenScreen"===i.overrideAnimation.openScreen),this.lookingForRewards=!1,wie.isBoolean(i.lookingForRewards)&&(this.lookingForRewards=i.lookingForRewards),this.getRewardsSuccess=!1,wie.isBoolean(i.getRewardsSuccess)&&(this.getRewardsSuccess=i.getRewardsSuccess),!0))}},{key:"open",value:function(){this.updateStatus(),this.node.scene.emit(Us.HIDE_UI),this.tryPlayAnimation()}},{key:"close",value:(v=a(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],this.localizeVisibilityController.abort(),this.stopParticles(),!this.coinContainerShown){e.next=7;break}return this.coinContainerShown=!1,e.next=7,Ue.runAnimationAsync(this.coinContainerAnimation,this.coinContainerExitClip.name);case 7:xie.emit(gie.CLOSE_SCREEN,{screenName:this.node.name,screenData:{canShowRewardsAd:t}}),this.node.scene.emit(Us.ABORT_COIN_ANIMATION);case 9:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"updateStatus",value:function(){this.updateCoinContainer(),this.updateButtonsContainer(),this.lookingForRewardsText.opacity=0}},{key:"updateCoinContainer",value:function(){this.coinContainer.updateCoins({coins:this.currentCoins})}},{key:"updateButtonsContainer",value:function(){var e=Aie.getGameData();if(e){var t=this.level+1>e.totalLevel?this.level:this.level+1,n=t%5==0,i=13===t;this.playButton.node.active=!1,this.homeButton.node.active=!1,i?this.homeButton.node.active=!0:(this.playButton.node.active=!0,this.playBackground.active=!n,this.hardLevelBackground.active=n)}}},{key:"tryPlayAnimation",value:function(){if(this.playAnimation){this.screen.setScreenOpacity(255),this.coinText.string="x0",this.scoreText.string="0",this.animateVisibleButtonContainer(!1,!1),this.playParticles();var e=this.screen.getComponent(le);e?e.once(le.EventType.FINISHED,this.handleParticleEnd):this.handleParticleEnd()}else{if(this.animateVisibleButtonContainer(!0,!1),!this.getRewardsSuccess)return;this.getRewardsEffect.playAnimation(["storm","thunder"],this.triggerCollectItemPlayButtonAnimation.bind(this))}}},{key:"handleLookingForRewards",value:(f=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.animateLookingForRewards();case 2:Cie&&at.isReadyAdShowable(Cie.REWARDED_INTERSTITIAL)?this.close(!0):this.animateVisibleButtonContainer(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"animateCoin",value:(y=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.screen.container){e.next=3;break}return console.warn("LevelCompleteScreen: screen not found"),e.abrupt("return");case 3:return this.coinAnimation.play(),e.next=6,Ue.runOnUpdateAsync(this.node,.8,(function(e){var n=be(0,t.coins,e),i=Math.floor(n);t.coinText.string="x".concat(i)}));case 6:return e.next=8,this.animateCoinCollection();case 8:this.coinText.string="x".concat(this.coins);case 9:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"animateScore",value:(d=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ue.runOnUpdateAsync(this.scoreText.node,.8,(function(e){var n=be(0,t.score,e);t.scoreText.string="".concat(Math.floor(n))})),this.scoreText.node.setScale(1,1,1),this.scoreText.string="".concat(this.score);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"animateCoinCollection",value:(h=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.coinContainerShown=!0,e.next=3,Ue.runAnimationAsync(this.coinContainerAnimation,this.coinContainerEnterClip.name);case 3:this.node.scene.emit(Us.ADD_COINS,{coins:this.coins,collectionAnimation:{floatDuration:.5,flyDuration:.5,animateTextOnly:!1,target:this.coinContainer}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"animateLookingForRewards",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=L(this.lookingForRewardsText)).to(.25,{opacity:255},{easing:"linear"}).delay(.25),t.to(.25,{opacity:100},{easing:"linear"}).delay(.125),e.next=5,Ue.runTweenAsync(L(this.lookingForRewardsText).repeat(2,t).to(.25,{opacity:0},{easing:"linear"}));case 5:this.lookingForRewardsText.opacity=0;case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"animateVisibleButtonContainer",value:(c=a(o().mark((function e(t){var n,i,r,a,s,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(l.length>1&&void 0!==l[1])||l[1],i=t?1:0,!n){e.next=15;break}return this.playAnimationSignal.abort(),r=new An,this.playAnimationSignal=r,a=t?0:1,this.buttonsContainer.setScale(a,a,this.buttonsContainer.scale.z),s=L(this.buttonsContainer).to(.5,{scale:new q(i,i,1)},{easing:"backOut"}),t||this.setInteractableButtons(!1),e.next=12,Ue.runTweenAsync(s,r);case 12:t&&this.setInteractableButtons(!0),e.next=17;break;case 15:this.setInteractableButtons(t),this.buttonsContainer.setScale(i,i,this.buttonsContainer.scale.z);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"triggerCollectItemPlayButtonAnimation",value:(u=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playAnimationSignal.abort(),t=new An,this.playAnimationSignal=t,n=L(this.buttonsContainer).to(.08,{scale:new q(.95,1.05,1)}).to(.08,{scale:new q(1.05,.95,1)}).to(.08,{scale:new q(1,1,1)}),i=L(this.shineBackground).to(.08,{opacity:50},{easing:"quadOut"}).to(.08,{opacity:0},{easing:"quadIn"}),e.next=7,Promise.all([Ue.runTweenAsync(n,t),Ue.runTweenAsync(i,t)]);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"playParticles",value:function(){var e=Ye.isLandscape(),t=e?50:30,n=e?5e3:2e3,i=e?15e3:1e4,r=e?40:60,a=e?110:100,o=e?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=t,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=n,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=i,this.leftConfetti.shapeModule.angle=r,this.rightConfetti.shapeModule.angle=a,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=o,this.leftConfetti.play(),this.rightConfetti.play(),this.bokehParticles.play()}},{key:"stopParticles",value:function(){this.leftConfetti.stop(),this.rightConfetti.stop(),this.bokehParticles.stop()}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.homeButton.interactable=e}},{key:"handleClickedPlay",value:function(){this.setInteractableButtons(!1),this.close()}},{key:"handleClickedHome",value:function(){this.setInteractableButtons(!1),this.close()}}]),b}(x)).prototype,"coinText",[hne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mne=r(_ne.prototype,"scoreText",[dne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nne=r(_ne.prototype,"lookingForRewardsText",[yne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bne=r(_ne.prototype,"getRewardsEffect",[fne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zne=r(_ne.prototype,"playButton",[vne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fne=r(_ne.prototype,"playBackground",[mne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Une=r(_ne.prototype,"shineBackground",[gne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gne=r(_ne.prototype,"hardLevelBackground",[bne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hne=r(_ne.prototype,"buttonsContainer",[wne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qne=r(_ne.prototype,"homeButton",[kne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vne=r(_ne.prototype,"coinAnimation",[Sne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wne=r(_ne.prototype,"coinContainer",[Cne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kne=r(_ne.prototype,"coinContainerAnimation",[Ene],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jne=r(_ne.prototype,"coinContainerEnterClip",[xne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yne=r(_ne.prototype,"coinContainerExitClip",[Ane],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jne=r(_ne.prototype,"leftConfetti",[Tne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zne=r(_ne.prototype,"rightConfetti",[Pne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xne=r(_ne.prototype,"bokehParticles",[Rne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qne=r(_ne.prototype,"welldoneUiOpacity",[Lne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$ne=r(_ne.prototype,"welldoneLocalize",[Ine],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),One=_ne))||One);w._RF.pop(),w._RF.push({},"46b8aK6CThLtpMhZPEfDrNs","LoadingFullScreen",void 0);var Tie,Pie,Rie,Lie,Iie,Oie=S.ccclass,_ie=S.property,Die=["interMsg.reviveAd","interMsg.doubleAd","interMsg.ranked","interMsg.friendChallenge","interMsg.bragChallenge","interMsg.clearTiles","interMsg.beatClock","interMsg.clearBombs","interMsg.seasonPack","interMsg.collectStars","interMsg.competeInLb","interMsg.competeWithFriends","interMsg.thunder","interMsg.hint","interMsg.pliers","interMsg.tornado","interMsg.coins","interMsg.seasonTiles","interMsg.dailyLogin","interMsg.levelUp","interMsg.seasonRewards"],Mie=(iie=Oie("LoadingFullScreen"),rie=Ii.required(),aie=_ie(te),oie=Ii.required(),sie=Ii.required(),lie=_ie(cp),iie((pie=r((cie=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"progressBar",pie,l(e)),s(e,"uiOpacity",hie,l(e)),s(e,"loadingLabelLocalizer",die,l(e)),e}return e(h,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),Ii.validateRequiredProperties(this)}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0,this.progressBar.progress=0}},{key:"show",value:(c=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uiOpacity.opacity=0,this.progressBar.progress=0,n=L(this.uiOpacity).to(.5,{opacity:255},{easing:"cubicOut"}),i=L(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"}),this.runLoadingTextAnimation(),Ue.runTweenAsync(n),e.next=8,Ue.runTweenAsync(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"hide",value:(u=a(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uiOpacity&&this.progressBar){e.next=2;break}return e.abrupt("return");case 2:return this.uiOpacity.opacity=255,this.progressBar.progress=.9,n=L(this.uiOpacity).to(.5,{opacity:0},{easing:"cubicIn"}),i=L(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"}),this.runLoadingTextAnimation(),e.next=9,Ue.runTweenAsync(i);case 9:return this.stopLoadingTextAnimation(),e.next=12,Ue.runTweenAsync(n);case 12:this.node.active=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"runLoadingTextAnimation",value:function(){var e=this;this.updateHintText(),this.schedule((function(){return e.updateHintText()}),5)}},{key:"updateHintText",value:function(){if(this.loadingLabelLocalizer){var e=this.getHintText();e&&(this.loadingLabelLocalizer.key=e)}}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"getHintText",value:function(){return Die[Math.floor(Math.random()*Die.length)]}}]),h}(x)).prototype,"progressBar",[rie,aie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hie=r(cie.prototype,"uiOpacity",[oie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),die=r(cie.prototype,"loadingLabelLocalizer",[sie,lie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uie=cie))||uie);w._RF.pop(),w._RF.push({},"74caciRBKZLu7ymXYJK2GYy","Loading",void 0);var Nie,Bie=S.ccclass,zie=S.property;Tie=Bie("Loading"),Pie=zie(ye),Tie((Iie=r((Lie=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"loadingPrefab",Iie,l(e)),e.loadingNode=null,e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){E.isPersistRootNode(this.node)||E.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=re("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=he(this.loadingPrefab));var n=he._clone(this.loadingNode);this.loadingFullScreen=n.getComponent(Mie),null===(e=re("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(c=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.createLoadingFullScreen(),e.next=3,this.loadingFullScreen.show(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"hide",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadingFullScreen){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadingFullScreen.hide(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),h}(x)).prototype,"loadingPrefab",[Pie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rie=Lie));w._RF.pop(),w._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var Fie,Uie,Gie,Hie,qie,Vie,Wie,Kie,jie,Yie,Jie=S.ccclass,Zie=S.disallowMultiple,Xie=S.requireComponent,Qie=Ludex.Events,$ie=codex.event;Jie("LoadingScreen")(Nie=Zie(Nie=Xie(k8)(Nie=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=a.call.apply(a,[this].concat(i))).isClosing=!1,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.isClosing=!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.isClosing=!0,e.unscheduleAllCallbacks())},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1,e.isClosing=!1)},e.handleOnCloseScreen=function(){nt.closeScreen(it.LOADING_SCREEN)},e}return e(o,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.validateRequiredProperties(this,o)}},{key:"listenScreenEvents",value:function(){$ie.on(Qie.OPENING_SCREEN,this.handleOpeningScreen),$ie.on(Qie.OPENED_SCREEN,this.handleOpenedScreen),$ie.on(Qie.CLOSING_SCREEN,this.handleClosingScreen),$ie.on(Qie.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){$ie.off(Qie.OPENING_SCREEN,this.handleOpeningScreen),$ie.off(Qie.OPENED_SCREEN,this.handleOpenedScreen),$ie.off(Qie.CLOSING_SCREEN,this.handleClosingScreen),$ie.off(Qie.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled&&!this.isClosing){var e=this.screen.data.duration;e&&e>0&&this.scheduleOnce(this.handleOnCloseScreen,e)}}}]),o}(x))||Nie)||Nie);w._RF.pop(),w._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var ere,tre,nre,ire,rre,are,ore,sre,lre,ure,cre,pre,hre,dre,yre,fre,vre=S.ccclass,mre=S.disallowMultiple,gre=S.requireComponent,bre=S.property,wre=Ludex,kre=wre.Events,Sre=wre.Utils.Valid,Cre=codex.event;Fie=vre("NotificationScreen"),Uie=gre(k8),Gie=bre(Y),Hie=bre(cp),qie=bre(U),Fie(Vie=mre(Vie=Uie((Kie=r((Wie=function(r){n(o,r);var a=i(o);function o(){var e;t(this,o);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=a.call.apply(a,[this].concat(i)),s(e,"message",Kie,l(e)),s(e,"messageLocalizer",jie,l(e)),s(e,"touchZone",Yie,l(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.screen.backgroundMaskButton.interactable=e.enableCloseOnTouch)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return e(o,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.screen=this.getComponent(k8),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Cre.on(kre.OPENING_SCREEN,this.handleOpeningScreen),Cre.on(kre.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){Cre.off(kre.OPENING_SCREEN,this.handleOpeningScreen),Cre.off(kre.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;Sre.isObject(t)?(void 0!==t.message?this.setMessageManually(t.message):void 0!==t.localizedMessageKey&&this.setMessageUsingLocalizeKey(t.localizedMessageKey),t.duration&&t.duration>0&&this.scheduleOnce((function(){nt.closeScreen(it.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"setMessageManually",value:function(e){this.messageLocalizer.enabled=!1,this.message.string=e}},{key:"setMessageUsingLocalizeKey",value:function(e){this.messageLocalizer.enabled=!0,this.messageLocalizer.key=e}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),this.screen.backgroundMaskButton.interactable=!1,nt.closeScreen(it.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),o}(x)).prototype,"message",[Gie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jie=r(Wie.prototype,"messageLocalizer",[Hie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yie=r(Wie.prototype,"touchZone",[qie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vie=Wie))||Vie)||Vie);w._RF.pop(),w._RF.push({},"7129ca71jRMGaTHxWhEL4F4","QuitLevelScreen",void 0);var Ere,xre,Are,Tre,Pre,Rre,Lre,Ire,Ore,_re,Dre,Mre,Nre,Bre,zre,Fre,Ure,Gre,Hre,qre,Vre,Wre,Kre=S.ccclass,jre=S.property,Yre=S.requireComponent,Jre=Ludex,Zre=Jre.Events,Xre=Jre.Match.Modes,Qre=codex,$re=Qre.event,eae=Qre.storage;ere=Kre("QuitLevelScreen"),tre=Yre(k8),nre=jre(Y),ire=jre(Y),rre=jre(U),are=jre(Y),ore=jre(Y),sre=jre(U),ere(lre=tre((cre=r((ure=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"singleDescription",cre,l(e)),s(e,"tournamentDescription",pre,l(e)),s(e,"quitButton",hre,l(e)),s(e,"quitLabel",dre,l(e)),s(e,"endLabel",yre,l(e)),s(e,"continueButton",fre,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){$re.on(Zre.OPENING_SCREEN,this.handleOpeningScreen),$re.on(Zre.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){$re.off(Zre.OPENING_SCREEN,this.handleOpeningScreen),$re.off(Zre.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),nt.closeScreen(it.QUIT_LEVEL_SCREEN),this.node.scene.emit(Us.SHOW_UI),this.node.scene.emit(Us.GAME_RESUME)}},{key:"updateStatus",value:function(){var e=hy.getMatchMode()===Xre.TOURNAMENT;this.singleDescription.node.active=!e,this.tournamentDescription.node.active=e,this.quitLabel.node.active=!e,this.endLabel.node.active=e}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.quitButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedContinue",value:function(){this.close()}},{key:"handleClickedQuit",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setInteractableButtons(!1),hy.getMatchMode()!==Xre.TOURNAMENT){e.next=4;break}return e.next=4,this.handleTournamentQuit();case 4:this.node.scene.emit(Us.GAME_EXIT);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleTournamentQuit",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null!==(t=hy.getMatchCustomData())&&void 0!==t?t:{},r=i.score,a=void 0===r?0:r,s=i.level,l=void 0===s?1:s,u=i.tournamentId,c=null!==(n=eae.getStorageData("tournament","previousScore"))&&void 0!==n?n:0,(p=a>c)&&u&&rt.saveTournamentProgress(l,a,u),eae.setStorageData("tournament","animateTournamentLeader",p),e.next=7,hy.finishMatchAsync();case 7:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})}]),h}(x)).prototype,"singleDescription",[nre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pre=r(ure.prototype,"tournamentDescription",[ire],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hre=r(ure.prototype,"quitButton",[rre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dre=r(ure.prototype,"quitLabel",[are],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yre=r(ure.prototype,"endLabel",[ore],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fre=r(ure.prototype,"continueButton",[sre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lre=ure))||lre);w._RF.pop(),w._RF.push({},"85907Tnp/NBq7myeciP/4h3","RescuesScreen",void 0);var tae,nae,iae,rae,aae,oae,sae,lae,uae,cae,pae,hae,dae,yae,fae,vae,mae,gae,bae,wae,kae,Sae,Cae,Eae,xae,Aae,Tae,Pae,Rae,Lae,Iae=S.ccclass,Oae=S.property,_ae=S.disallowMultiple,Dae=S.requireComponent,Mae=Ludex,Nae=Mae.Events,Bae=Mae.Plugins.Ads,zae=(void 0===Bae?{}:Bae).Types,Fae=codex,Uae=Fae.event,Gae=Fae.player;Ere=Iae("RescuesScreen"),xre=Dae(k8),Are=Oae(M),Tre=Oae([H]),Pre=Oae(cp),Rre=Oae(cp),Lre=Oae(H),Ire=Oae(H),Ore=Oae(le),_re=Oae(H),Dre=Oae(H),Ere(Mre=_ae(Mre=xre((Bre=r((Nre=function(r){n(v,r);var u,c,p,h,d,y,f=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=f.call.apply(f,[this].concat(i)),s(e,"adOpacity",Bre,l(e)),s(e,"animNodes",zre,l(e)),s(e,"titleLocalizer",Fre,l(e)),s(e,"descriptionLocalizer",Ure,l(e)),s(e,"timer",Gre,l(e)),s(e,"bomb",Hre,l(e)),s(e,"bombAnim",qre,l(e)),s(e,"replayButton",Vre,l(e)),s(e,"buyTimeButton",Wre,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("RescuesScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),zae&&at.preloadAdsByType(zae.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Uae.on(Nae.OPENING_SCREEN,this.handleOpeningScreen),Uae.on(Nae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Uae.off(Nae.OPENING_SCREEN,this.handleOpeningScreen),Uae.off(Nae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name&&(this.payload=e,!0)}},{key:"open",value:(y=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ve.turnOffMusic(),this.resetState(),this.runOpenAnimation(),this.node.scene.emit(Us.HIDE_UI);case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"close",value:function(e){Ve.turnUpMusic(),Uae.emit(Nae.CLOSE_SCREEN,{screenName:this.node.name,screenData:e})}},{key:"resetState",value:function(){var e,t=(null===(e=this.payload.screenData)||void 0===e?void 0:e.failKey)===yy;this.titleLocalizer.key=t?"game.boom":"game.timesUp",this.descriptionLocalizer.key=t?"game.bombDesc":"game.timesUpDesc",this.timer.active=!t,this.bomb.active=t,t&&this.bombAnim.play();var n=Gae.getGameData();if(n){var i=n.coins>=Id;this.replayButton.active=!i,this.buyTimeButton.active=i,this.adOpacity.opacity=0}}},{key:"runOpenAnimation",value:(d=a(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.screen.container){e.next=3;break}return console.warn("TimeUpScreen: screen not found"),e.abrupt("return");case 3:return e.next=5,Promise.all(this.animNodes.map((function(e,n){t.runAppearTween(e,.1*n)})));case 5:return e.next=7,this.runShowAdContainer();case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"runAppearTween",value:(h=a(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(t).set({scale:new q(0,0,0)}).delay(n).to(1,{scale:new q(1,1,1)},{easing:function(e){return Ue.elasticOut(e,.1,.45)}}));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"runShowAdContainer",value:(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=L(this.adOpacity)).delay(1),t.to(.5,{opacity:255}),e.next=5,Ue.runTweenAsync(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleClickReplay",value:(c=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.screen.data.level,!GameSDK.isGameSDK("Yandex")){e.next=4;break}return e.next=4,at.showInterstitialAdAsync({forLevel:t});case 4:this.close();case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickBuyTime",value:function(){this.node.scene.emit(Us.REMOVE_COINS,{coins:Id,collectionAnimation:{animateTextOnly:!0}}),this.close({rescue:!0})}},{key:"handleClickAd",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at.showRewardVideoAdAsync();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:this.close({rescue:!0});case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleClickClose",value:function(){var e,t,n=(null!==(e=null===(t=Gae.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1)>=13;this.close({customMode:n})}}]),v}(x)).prototype,"adOpacity",[Are],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zre=r(Nre.prototype,"animNodes",[Tre],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fre=r(Nre.prototype,"titleLocalizer",[Pre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ure=r(Nre.prototype,"descriptionLocalizer",[Rre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gre=r(Nre.prototype,"timer",[Lre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hre=r(Nre.prototype,"bomb",[Ire],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qre=r(Nre.prototype,"bombAnim",[Ore],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vre=r(Nre.prototype,"replayButton",[_re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wre=r(Nre.prototype,"buyTimeButton",[Dre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mre=Nre))||Mre)||Mre);w._RF.pop(),w._RF.push({},"726c9oCUUBDpboDnHRz7SGZ","PauseScreen",void 0);var Hae=S.ccclass,qae=S.property,Vae=S.requireComponent,Wae=Ludex,Kae=Wae.Events,jae=Wae.Utils.Device,Yae=Wae.Match.Modes,Jae=codex,Zae=Jae.player,Xae=Jae.event;tae=Hae("PauseScreen"),nae=Vae(k8),iae=qae(H),rae=qae(H),aae=qae(H),oae=qae(GX),sae=qae(GX),lae=qae(GX),uae=qae(U),cae=qae({type:U,group:"Button Container"}),pae=qae({type:U,group:"Button Container"}),hae=qae({type:U,group:"Button Container"}),dae=qae({type:U,group:"Button Container"}),yae=qae({type:U,group:"Button Container"}),fae=qae(M),tae(vae=nae((gae=r((mae=function(r){n(y,r);var u,c,p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=d.call.apply(d,[this].concat(i)),s(e,"musicSetting",gae,l(e)),s(e,"soundSetting",bae,l(e)),s(e,"vibrateSetting",wae,l(e)),s(e,"musicSwitch",kae,l(e)),s(e,"soundSwitch",Sae,l(e)),s(e,"vibrateSwitch",Cae,l(e)),s(e,"closeButtonComponent",Eae,l(e)),s(e,"resumeButton",xae,l(e)),s(e,"restartButton",Aae,l(e)),s(e,"challengeFriendsButton",Tae,l(e)),s(e,"createShortcutButton",Pae,l(e)),s(e,"customModeButton",Rae,l(e)),s(e,"containerUIOpacity",Lae,l(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus(),e.updateButtonsStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){if("code"in t){var n=t.code,i=Fd.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(Fd.Events.UNLOCK_DEV_TOOLS),e.node.off(Fd.Events.TRIGGER_UNLOCK_KEY)))}},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(U),n=e.vibrateSetting.getComponentInChildren(GX),i=e.vibrateSetting.getComponentInChildren(Ao);if(t&&n&&i)if(jae.isMobile()){var r,a=null!==(r=Zae.getPlayerSetting("vibrate"))&&void 0!==r&&r;n.setEnabled(a)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(y,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Xae.on(Kae.OPENING_SCREEN,this.handleOpeningScreen),Xae.on(Kae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Xae.off(Kae.OPENING_SCREEN,this.handleOpeningScreen),Xae.off(Kae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(Fd.Events.TRIGGER_UNLOCK_KEY),this.node.on(Fd.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(Fd.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(Fd.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(Fd.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.node.emit(Fd.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(Fd.Events.TRIGGER_RESET_SEQUENCE),nt.closeScreen(it.PAUSE_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=Zae.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=Zae.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=Zae.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.resumeButton.interactable=e,this.closeButtonComponent.interactable=e,this.restartButton.interactable=e,this.challengeFriendsButton.interactable=e,this.screen.backgroundMaskButton.interactable=e,this.customModeButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e,t=GameSDK.isGameSDK("Yandex"),n=hy.getMatchMode()===Yae.SINGLE||hy.getMatchMode()===vy,i=(null!==(e=Zae.getGameData())&&void 0!==e?e:{}).level,r=void 0===i?1:i;this.setActiveButton(this.challengeFriendsButton,!t),this.setActiveButton(this.createShortcutButton,t&&jae.isDesktop()),this.setActiveButton(this.customModeButton,n&&r>=13),this.setActiveButton(this.resumeButton,!n)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(Zae.setSetting("music",e),this.node.emit(Fd.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e){var t=hy.getMatchMode();Ve.playMusic(t===Yae.TOURNAMENT?Ji.TOURNAMENT_MUSIC:Ji.BG_MUSIC)}else Ve.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();Zae.setSetting("sound",e),this.node.emit(Fd.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();Zae.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedResume",value:function(){this.resumeGame()}},{key:"handleClickedCustomMode",value:(h=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setVisible(!1),e.next=3,nt.openScreenAndWaitForClose(it.CUSTOM_GAME_SCREEN);case 3:if(n=e.sent,i=null!==(t=n.screenData)&&void 0!==t?t:{},r=i.customMode){e.next=9;break}return this.node.scene.emit(Us.HIDE_UI),this.setVisible(!0),e.abrupt("return");case 9:this.close(),this.node.scene.emit(Us.GAME_RESUME),this.node.scene.emit(Us.GAME_REPLAY,r?vy:void 0);case 12:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.resumeGame()}},{key:"handleClickedRestart",value:(p=a(o().mark((function e(){var t,n,i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.close(),n=null!==(t=Zae.getGameData())&&void 0!==t?t:{},i=n.level,r=void 0===i?1:i,hy.getMatchMode()!==vy){e.next=7;break}return e.next=5,at.showRewardedInterstitialAdAsync({forceLoad:!0,showError:!1});case 5:e.next=9;break;case 7:return e.next=9,at.showInterstitialAdAsync({forLevel:r});case 9:if(hy.getMatchMode()!==Yae.TOURNAMENT){e.next=12;break}return nt.openScreen(it.START_OVER_SCREEN),e.abrupt("return");case 12:this.node.scene.emit(Us.GAME_RESUME),this.node.scene.emit(Us.GAME_REPLAY);case 14:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"handleClickedChallengeFriends",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.isGameSDK("MsGames")){e.next=6;break}return nt.showLoadingScreen(),e.next=4,GameSDK.extra.shareAsync();case 4:return nt.closeLoadingScreen(),e.abrupt("return");case 6:this.close(),this.node.scene.emit(Us.CHALLENGE_FRIENDS);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleClickedCreateShortcut",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.extra.checkAndCreateShortcutAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),nt.showNotificationScreenWithLocalizedKey("error.shortcutFail");case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return u.apply(this,arguments)})},{key:"resumeGame",value:function(){this.close(),this.node.scene.emit(Us.GAME_RESUME),this.node.scene.emit(Us.SHOW_UI)}},{key:"setVisible",value:function(e){this.containerUIOpacity.opacity=e?255:0}}]),y}(x)).prototype,"musicSetting",[iae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bae=r(mae.prototype,"soundSetting",[rae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wae=r(mae.prototype,"vibrateSetting",[aae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kae=r(mae.prototype,"musicSwitch",[oae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sae=r(mae.prototype,"soundSwitch",[sae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cae=r(mae.prototype,"vibrateSwitch",[lae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eae=r(mae.prototype,"closeButtonComponent",[uae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xae=r(mae.prototype,"resumeButton",[cae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aae=r(mae.prototype,"restartButton",[pae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tae=r(mae.prototype,"challengeFriendsButton",[hae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pae=r(mae.prototype,"createShortcutButton",[dae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rae=r(mae.prototype,"customModeButton",[yae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lae=r(mae.prototype,"containerUIOpacity",[fae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vae=mae))||vae);w._RF.pop(),w._RF.push({},"9ecd9Kte0VJN4rRVFlb6CzI","OverlayUtils",void 0);var Qae,$ae,eoe,toe,noe,ioe,roe,aoe,ooe,soe,loe,uoe,coe,poe,hoe,doe,yoe,foe,voe,moe,goe,boe,woe,koe,Soe,Coe,Eoe,xoe,Aoe=codex,Toe=Aoe.player,Poe=Aoe.analytics,Roe=Ludex.Plugins.Analytics.Events,Loe=function(){function n(){t(this,n)}var i,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new n),this.inst$}},{key:"shareBestScoreWithOverlay",value:(r=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=Toe.getPlayer(),n=t.data,i=(n||{}).score,"shareAsync"in GameSDK.extra){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,GameSDK.extra.shareAsync({text:"Great! I have a best score!",intent:"SHARE",imageOverlayPath:"wideframes/share-async.xml",pathToCSS:"wideframes/share-async-styles.css",initialData:{score:null!=i?i:0},shareDestination:["NEWSFEED","GROUP","COPY_LINK","MESSENGER"],switchContext:!1});case 7:Poe.event(Roe.SHARE,{share_content_type:"BestScore",success:!0}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),Poe.event(Roe.SHARE,{share_content_type:"BestScore",success:!1}),console.error("Overlay sharing failed:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(){return r.apply(this,arguments)})},{key:"inviteFriendsWithOverlay",value:(i=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=Toe.getPlayer(),n=t.data,i=(n||{}).score,"inviteAsync"in GameSDK.extra){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,GameSDK.extra.inviteAsync({initialData:{score:null!=i?i:0},text:{default:"Great! I have a best score!",localizations:{vi_VN:"Thật tuyệt! Mình vừa phá kỷ lục này!"}},imageOverlayPath:"wideframes/invite-async.xml",pathToCSS:"wideframes/invite-async-styles.css"});case 7:Poe.event(Roe.INVITE,{invite_content_type:"BestScore",success:!0}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),Poe.event(Roe.INVITE,{invite_content_type:"BestScore",success:!1}),console.error("Overlay inviting failed:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(){return i.apply(this,arguments)})}]),n}();w._RF.pop(),w._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var Ioe,Ooe,_oe,Doe,Moe,Noe,Boe,zoe,Foe,Uoe,Goe,Hoe,qoe,Voe,Woe,Koe,joe,Yoe,Joe,Zoe,Xoe,Qoe,$oe,ese=S.ccclass,tse=S.property,nse=S.requireComponent,ise=Ludex,rse=ise.Events,ase=ise.Utils.Device,ose=ise.Match.Modes,sse=ise.Configs.Debugger.MonitorError,lse=ise.Plugins.Analytics,use=(void 0===lse?{}:lse).Events,cse=codex,pse=cse.player,hse=cse.event,dse=cse.monitorError,yse=cse.frameCapture,fse=cse.analytics;Qae=ese("SettingsScreen"),$ae=nse(k8),eoe=tse({type:H,group:"SettingContainer"}),toe=tse({type:H,group:"SettingContainer"}),noe=tse({type:H,group:"SettingContainer"}),ioe=tse({type:GX,group:"Switch Container"}),roe=tse({type:GX,group:"Switch Container"}),aoe=tse({type:GX,group:"Switch Container"}),ooe=tse(U),soe=tse({type:U,group:"Button Container"}),loe=tse({type:U,group:"Button Container"}),uoe=tse({type:U,group:"Button Container"}),coe=tse({type:U,group:"Button Container"}),poe=tse({type:U,group:"Button Container"}),Qae(hoe=$ae((yoe=r((doe=function(r){n(f,r);var u,c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"musicSetting",yoe,l(e)),s(e,"soundSetting",foe,l(e)),s(e,"vibrateSetting",voe,l(e)),s(e,"musicSwitch",moe,l(e)),s(e,"soundSwitch",goe,l(e)),s(e,"vibrateSwitch",boe,l(e)),s(e,"closeButton",woe,l(e)),s(e,"reportButton",koe,l(e)),s(e,"shareButton",Soe,l(e)),s(e,"inviteFriendsButton",Coe,l(e)),s(e,"feedbackButton",Eoe,l(e)),s(e,"createShortcutButton",xoe,l(e)),e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(U),n=e.vibrateSetting.getComponentInChildren(GX),i=e.vibrateSetting.getComponentInChildren(Ao);if(t&&n&&i)if(ase.isMobile()){var r,a=null!==(r=pse.getPlayerSetting("vibrate"))&&void 0!==r&&r;n.setEnabled(a)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(f,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.listenScreenEvents(),this.updateButtonsStatus()}},{key:"onDestroy",value:function(){this.unlistenScreenEvents()}},{key:"listenScreenEvents",value:function(){hse.on(rse.OPENING_SCREEN,this.handleOpeningScreen),hse.on(rse.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unlistenScreenEvents",value:function(){hse.off(rse.OPENING_SCREEN,this.handleOpeningScreen),hse.off(rse.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.node.emit(Fd.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(Fd.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Us.SHOW_UI),nt.closeScreen(it.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=pse.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=pse.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=pse.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.closeButton.interactable=e,this.reportButton.interactable=e,this.shareButton.interactable=e,this.inviteFriendsButton.interactable=e,this.feedbackButton.interactable=e,this.createShortcutButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e=GameSDK.isGameSDK("Yandex"),t=GameSDK.isGameSDK("MsGames");this.setActiveButton(this.reportButton,sse.Feedback),this.setActiveButton(this.shareButton,!e&&!t),this.setActiveButton(this.inviteFriendsButton,!e),this.setActiveButton(this.feedbackButton,e),this.setActiveButton(this.createShortcutButton,e&&ase.isDesktop()||t)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(pse.setSetting("music",e),e){var t=hy.getMatchMode();Ve.playMusic(t===ose.TOURNAMENT?Ji.TOURNAMENT_MUSIC:Ji.BG_MUSIC)}else Ve.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();pse.setSetting("sound",e)}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();pse.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedReport",value:function(){null==dse||dse.feedbackAsync()}},{key:"handleClickedShare",value:(d=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.isGameSDK("FacebookInstant")){e.next=13;break}if(nt.showLoadingScreen(),!("isNEZP"in GameSDK.extra)||!GameSDK.extra.isNEZP()){e.next=8;break}return e.next=6,Loe.shareBestScoreWithOverlay();case 6:e.next=11;break;case 8:if(!("shareBestScoreAsync"in GameSDK.extra)){e.next=11;break}return e.next=11,GameSDK.extra.shareBestScoreAsync();case 11:return nt.closeLoadingScreen(),e.abrupt("return");case 13:this.close();case 14:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"handleClickedInviteFriends",value:(h=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nt.showLoadingScreen(),!GameSDK.isGameSDK("MsGames")){e.next=4;break}return e.next=4,GameSDK.extra.shareAsync();case 4:if(!GameSDK.isGameSDK("FacebookInstant")){e.next=7;break}return e.next=7,this.inviteWithBestScoreFbInstant();case 7:nt.closeLoadingScreen();case 8:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleClickedFeedback",value:function(){var e="error.ratingFail";"ratingAsync"in GameSDK.extra?GameSDK.extra.ratingAsync().catch((function(t){if("code"in t){switch(t.code){case"NO_AUTH":e="error.ratingNoAuth";break;case"GAME_RATED":e="error.ratingGameRated"}nt.showNotificationScreenWithLocalizedKey(e)}else nt.showNotificationScreenWithLocalizedKey(e)})):nt.showNotificationScreenWithLocalizedKey(e)}},{key:"handleClickedCreateShortcut",value:(p=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.extra.checkAndCreateShortcutAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),nt.showNotificationScreenWithLocalizedKey("error.shortcutFail");case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(){return p.apply(this,arguments)})},{key:"inviteWithBestScoreFbInstant",value:(c=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameSDK.isGameSDK("FacebookInstant")){e.next=2;break}return e.abrupt("return");case 2:if(!GameSDK.extra.isNEZP()){e.next=7;break}return e.next=5,Loe.inviteFriendsWithOverlay();case 5:e.next=9;break;case 7:return e.next=9,this.inviteWithBestScoreAsync();case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"inviteWithBestScoreAsync",value:(u=a(o().mark((function e(){var t,n,i,r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameSDK.isGameSDK("FacebookInstant")){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,yse){e.next=5;break}throw new Error("FrameCapture not found");case 5:return t=pse.getPlayer(),n=t.playerId,i=t.name,r=t.photo,a=t.data,s=(a||{}).score,e.next=9,yse.renderAsync("share-score-with-invite",{playerId:n,playerPhoto:r,playerScore:s});case 9:if(null!==(l=e.sent)){e.next=12;break}throw new Error("Failed to render share score wideframe");case 12:return e.next=14,GameSDK.extra.inviteAsync({text:{default:"Great! I got a new best score!",localizations:{vi_VN:"Thật tuyệt! Mình vừa phá kỷ lục này!"}},image:l,data:{playerId:n,playerName:i,playerPhoto:r,type:"share_invite"}});case 14:use&&fse.event(use.INVITE,{invite_content_type:"BestScore",success:!0}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),use&&fse.event(use.INVITE,{invite_content_type:"BestScore",success:!1}),console.warn(e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,17]])}))),function(){return u.apply(this,arguments)})}]),f}(x)).prototype,"musicSetting",[eoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),foe=r(doe.prototype,"soundSetting",[toe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),voe=r(doe.prototype,"vibrateSetting",[noe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),moe=r(doe.prototype,"musicSwitch",[ioe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),goe=r(doe.prototype,"soundSwitch",[roe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),boe=r(doe.prototype,"vibrateSwitch",[aoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),woe=r(doe.prototype,"closeButton",[ooe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),koe=r(doe.prototype,"reportButton",[soe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Soe=r(doe.prototype,"shareButton",[loe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Coe=r(doe.prototype,"inviteFriendsButton",[uoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eoe=r(doe.prototype,"feedbackButton",[coe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xoe=r(doe.prototype,"createShortcutButton",[poe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hoe=doe))||hoe);w._RF.pop(),w._RF.push({},"891d37NJ6lLdp3CNLPHxZ6d","StarChest",void 0);var vse,mse,gse,bse,wse,kse,Sse,Cse,Ese,xse,Ase,Tse,Pse,Rse,Lse,Ise,Ose,_se,Dse,Mse,Nse=S.ccclass,Bse=S.property,zse=(Ioe=Nse("StarChest"),Ooe=Bse(N),_oe=Bse(M),Doe=Bse(Q),Moe=Bse(M),Noe=Bse(M),Boe=Bse({type:P,readonly:!0,displayName:"Starting Offset X",group:"Reward Animations"}),zoe=Bse({type:P,readonly:!0,displayName:"Starting Offset Y",group:"Reward Animations"}),Foe=Bse({type:P,displayName:"Centered Offset X",group:"Reward Animations"}),Uoe=Bse({type:P,displayName:"Centered Offset Y",group:"Reward Animations"}),Goe=Bse({type:P,min:0,displayName:"Starting Scale",group:"Reward Animations"}),Hoe=Bse({type:P,min:0,displayName:"Ending Scale",group:"Reward Animations"}),Ioe((Woe=r((Voe=function(r){n(f,r);var u,c,p,h,d,y=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=y.call.apply(y,[this].concat(i)),s(e,"sprite",Woe,l(e)),s(e,"glowOpacity",Koe,l(e)),s(e,"explosionParticles",joe,l(e)),s(e,"circle",Yoe,l(e)),s(e,"uiOpacity",Joe,l(e)),e.ogCenterX=0,e.ogCenterY=0,s(e,"endingOffsetX",Zoe,l(e)),s(e,"endingOffsetY",Xoe,l(e)),s(e,"startingScale",Qoe,l(e)),s(e,"endingScale",$oe,l(e)),e}return e(f,[{key:"startingOffsetX",get:function(){return this.node.position.x}},{key:"startingOffsetY",get:function(){return this.node.position.y}},{key:"__preload",value:function(){this.validateRequiredComponents(),this.ogCenterX=this.startingOffsetX,this.ogCenterY=this.startingOffsetY}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"moveToCenter",value:(d=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new q(this.endingOffsetX,this.endingOffsetY,this.node.position.z),e.next=3,Ue.runTweenAsync(L(this.node).to(.7,{position:n},{easing:"quintInOut"}),t);case 3:this.node.position=n;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"respawnAtStartingState",value:function(){this.node.position=new q(this.ogCenterX,this.ogCenterY,this.node.position.z),this.glowOpacity.opacity=0,this.sprite.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.glowOpacity.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.uiOpacity.opacity=255}},{key:"scale",value:(h=a(o().mark((function e(t,n){var i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.startingScale+(this.endingScale-this.startingScale)*t,r=new q(i,i,i),e.next=4,Promise.all([Ue.runTweenAsync(L(this.sprite.node).to(.2,{scale:r},{easing:"backOut"}),n),Ue.runTweenAsync(L(this.glowOpacity.node).to(.2,{scale:r},{easing:"backOut"}),n)]);case 4:this.sprite.node.setScale(r),this.glowOpacity.node.setScale(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"startShaking",value:function(){var e=this,t=this.node.position.clone();this.shakingTween={ogPos:t,tw:L(this.node).to(.1,{},{onUpdate:function(n,i){if(i){var r=t.x+10*(i-.5);e.node.position=new q(r,t.y,t.z)}}}).repeatForever().start()}}},{key:"stopShaking",value:function(){this.shakingTween&&(this.shakingTween.tw.stop(),this.node.position=this.shakingTween.ogPos,this.shakingTween=void 0)}},{key:"glow",value:(p=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sprite.node.scale.clone().multiplyScalar(1.1),e.next=3,Promise.all([Ue.runTweenAsync(L(this.sprite.node).to(.2,{scale:n},{easing:"cubicInOut"}),t),Ue.runTweenAsync(L(this.glowOpacity.node).to(.2,{scale:n}),t),Ue.runTweenAsync(L(this.glowOpacity).to(.5,{opacity:255}),t)]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"explode",value:(c=a(o().mark((function e(t){var n,i,r,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new q(8,8,8),i=function(){var e=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.circle.opacity=255,s.circle.node.setScale(q.ZERO),e.next=4,Promise.all([Ue.runTweenAsync(L(s.circle).to(.3,{opacity:0}),t),Ue.runTweenAsync(L(s.circle.node).to(.3,{scale:n},{easing:"cubicOut"}),t)]);case 4:s.circle.opacity=0,s.circle.node.scale=n;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Ue.runTweenAsync(L(s.glowOpacity.node).to(.3,{scale:q.ZERO},{easing:"cubicOut"}),t),Ue.runTweenAsync(L(s.sprite.node).to(.3,{scale:q.ZERO},{easing:"cubicOut"}),t)]);case 2:s.sprite.node.setScale(q.ZERO),s.glowOpacity.node.setScale(q.ZERO);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=5,Promise.all([this.explodeParticles(t),i(),r()]);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"explodeParticles",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aborted){e.next=2;break}return e.abrupt("return");case 2:return this.explosionParticles.node.active=!0,this.explosionParticles.resetSystem(),e.next=6,Ue.waitTweenAsync(1);case 6:this.explosionParticles.node.active=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})}]),f}(x)).prototype,"sprite",[Ooe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Koe=r(Voe.prototype,"glowOpacity",[_oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),joe=r(Voe.prototype,"explosionParticles",[Doe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yoe=r(Voe.prototype,"circle",[Moe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Joe=r(Voe.prototype,"uiOpacity",[Noe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(Voe.prototype,"startingOffsetX",[Boe],Object.getOwnPropertyDescriptor(Voe.prototype,"startingOffsetX"),Voe.prototype),r(Voe.prototype,"startingOffsetY",[zoe],Object.getOwnPropertyDescriptor(Voe.prototype,"startingOffsetY"),Voe.prototype),Zoe=r(Voe.prototype,"endingOffsetX",[Foe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xoe=r(Voe.prototype,"endingOffsetY",[Uoe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Qoe=r(Voe.prototype,"startingScale",[Goe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),$oe=r(Voe.prototype,"endingScale",[Hoe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),qoe=Voe))||qoe);w._RF.pop(),w._RF.push({},"e414bczbutHJKcOfhl1sc4p","StarChestScreen",void 0);var Fse,Use,Gse,Hse,qse,Vse,Wse,Kse,jse=S.ccclass,Yse=S.property,Jse=S.requireComponent,Zse=Ludex.Events,Xse=codex,Qse=Xse.event,$se=Xse.player;vse=jse("StarChestScreen"),mse=Jse(k8),gse=Yse(ZH),bse=Yse(U),wse=Yse(U),kse=Yse(le),Sse=Yse(zse),Cse=Yse(M),Ese=Yse(CF),xse=Yse(cp),vse(Ase=mse((Pse=r((Tse=function(r){n(y,r);var u,c,p,h,d=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=d.call.apply(d,[this].concat(i)),s(e,"starProgressBar",Pse,l(e)),s(e,"openButton",Rse,l(e)),s(e,"continueButton",Lse,l(e)),s(e,"chestAnimation",Ise,l(e)),s(e,"starChest",Ose,l(e)),s(e,"chestUnlockFXMask",_se,l(e)),s(e,"skipOverlay",Dse,l(e)),s(e,"messageLabelLocalizer",Mse,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(y,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Qse.on(Zse.OPENING_SCREEN,this.handleOpeningScreen),Qse.on(Zse.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Qse.off(Zse.OPENING_SCREEN,this.handleOpeningScreen),Qse.off(Zse.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Us.HIDE_UI);var e=$se.getGameData();if(e){var t=e.stars;this.numChestAvailable=Math.floor(t/20),this.starProgressBar.setRange(t,20);var n=this.numChestAvailable>0;this.setInteractableButtons(!0),this.openButton.node.active=n,this.openButton.interactable=n,this.continueButton.node.active=!n,this.continueButton.interactable=!n,this.messageLabelLocalizer.key=this.numChestAvailable?"reward.starChestAvailable":"reward.starChestUnavailable",this.numChestAvailable?this.chestAnimation.play():this.chestAnimation.stop(),this.chestUnlockFXMask.node.active=!1,this.chestUnlockFXMask.opacity=0,this.starChest.respawnAtStartingState()}}},{key:"close",value:function(){this.setInteractableButtons(!1),Qse.emit(Zse.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Us.SHOW_UI)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StarChestScreen: screen not found")}},{key:"handleClickButton",value:(h=a(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.numChestAvailable){e.next=3;break}return this.close(),e.abrupt("return");case 3:if(Ve.turnDownMusic(),t=$se.getGameData()){e.next=7;break}return e.abrupt("return");case 7:return this.setInteractableButtons(!1),n=t.stars,$se.setGameData({stars:t.stars-20*this.numChestAvailable}),i=new An,e.next=13,this.skipOverlay.open({opacity:200,onSkip:function(){return i.abort()}});case 13:return e.next=15,this.handleUnlockAnimation(n,t.stars,i);case 15:return e.next=17,this.skipOverlay.close();case 17:Ve.turnUpMusic(),O.emit(gn),this.close();case 20:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"handleUnlockAnimation",value:(p=a(o().mark((function e(t,n,i){var r,a,s,l,u,c=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.starChest.moveToCenter(i),this.fadeInChestUnlockFX(i)]);case 2:return this.chestAnimation.stop(),this.starChest.startShaking(),e.next=6,Ve.playSound(Ji.STAR_CHEST_DRUM_ROLL,{loop:!0});case 6:return e.next=8,Ue.waitTweenAsync(0);case 8:return r=t,a=this.numChestAvailable,s=function(e){return c.numChestAvailable>2?1-e/c.numChestAvailable:.35*(1-e/c.numChestAvailable)},l=function(e){r-e>=20&&(r=e,a--,c.starChest.scale(s(a),i),Ve.playSound(Ji.STAR_CHEST_OPEN))},e.next=14,Promise.all([this.starProgressBar.animateTo(n,i,l)]);case 14:return e.next=16,Ue.waitTweenAsync(1,i);case 16:return this.starChest.stopShaking(),e.next=19,this.starChest.glow(i);case 19:return Ve.stopSound(Ji.STAR_CHEST_DRUM_ROLL),u=Rd*this.numChestAvailable,this.node.scene.emit(Us.ADD_COINS,{coins:u,collectionAnimation:{animateTextOnly:!1,floatDuration:3,signal:i},skipAnimation:!0}),e.next=24,this.starChest.explode(i);case 24:return e.next=26,Ue.waitTweenAsync(1,i);case 26:return e.next=28,Promise.all([this.fadeOutChestUnlockFX(i)]);case 28:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"fadeInChestUnlockFX",value:(c=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chestUnlockFXMask.node.active=!0,e.next=3,Ue.runTweenAsync(L(this.chestUnlockFXMask).to(.5,{opacity:150}),t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"fadeOutChestUnlockFX",value:(u=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.chestUnlockFXMask).to(.3,{opacity:0}),t);case 2:this.chestUnlockFXMask.opacity=0,this.chestUnlockFXMask.node.active=!1;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.openButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),y}(x)).prototype,"starProgressBar",[gse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rse=r(Tse.prototype,"openButton",[bse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lse=r(Tse.prototype,"continueButton",[wse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ise=r(Tse.prototype,"chestAnimation",[kse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ose=r(Tse.prototype,"starChest",[Sse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_se=r(Tse.prototype,"chestUnlockFXMask",[Cse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dse=r(Tse.prototype,"skipOverlay",[Ese],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mse=r(Tse.prototype,"messageLabelLocalizer",[xse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ase=Tse))||Ase);w._RF.pop(),w._RF.push({},"2f7694kcVZNWq3iTCp1piqI","StartOverScreen",void 0);var ele,tle,nle,ile,rle,ale=S.ccclass,ole=S.property,sle=S.requireComponent,lle=Ludex.Events,ule=codex,cle=ule.event;ule.player,Fse=ale("StartOverScreen"),Use=sle(k8),Gse=ole(U),Hse=ole(U),Fse(qse=Use((Wse=r((Vse=function(r){n(p,r);var u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=c.call.apply(c,[this].concat(i)),s(e,"restartButton",Wse,l(e)),s(e,"cancelButton",Kse,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Ii.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){cle.on(lle.OPENING_SCREEN,this.handleOpeningScreen),cle.on(lle.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){cle.off(lle.OPENING_SCREEN,this.handleOpeningScreen),cle.off(lle.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),nt.closeScreen(it.START_OVER_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.restartButton.interactable=e,this.cancelButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedCancel",value:function(){this.close(),this.node.scene.emit(Us.GAME_RESUME),this.node.scene.emit(Us.SHOW_UI)}},{key:"handleClickedRestart",value:(u=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.close(),this.node.scene.emit(Us.GAME_RESUME),this.node.scene.emit(Us.GAME_REPLAY);case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}]),p}(x)).prototype,"restartButton",[Gse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kse=r(Vse.prototype,"cancelButton",[Hse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qse=Vse))||qse);w._RF.pop(),w._RF.push({},"d6d78U+W5xDwqln9pXXQOaF","TopLeaders",void 0);var ple,hle,dle,yle,fle,vle=S.ccclass,mle=S.property,gle=(ele=vle("TopLeaders"),tle=mle(G1),ele((rle=r((ile=function(r){n(h,r);var u,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"topLeaders",rle,l(e)),e.leaderData=[],e}return e(h,[{key:"updateData",value:function(e){var t=this;this.leaderData=e.slice(0,3),this.leaderData.slice(0,3).forEach((function(e,n){t.topLeaders[n].updateInfo({playerId:e.playerId,name:e.name,photo:e.photo,score:e.score})}))}},{key:"playShowLeadersAnimation",value:(u=a(o().mark((function e(t){var n,i,r=this,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:.1,i=.3,e.next=4,Promise.all(this.leaderData.map(function(){var e=a(o().mark((function e(a,s){var l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=r.topLeaders[s],e.next=3,l.runShowUpAnimation(s*n,i,t);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"hideLeaders",value:function(){var e,t=c(this.topLeaders);try{for(t.s();!(e=t.n()).done;){e.value.setVisible(!1)}}catch(e){t.e(e)}finally{t.f()}}}]),h}(x)).prototype,"topLeaders",[tle],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nle=ile))||nle);w._RF.pop(),w._RF.push({},"fe274iMNmBCzZ13Ie1nGU1R","TournamentLeaderSkeleton",void 0);var ble,wle,kle,Sle,Cle,Ele,xle,Ale,Tle,Ple,Rle,Lle,Ile,Ole,_le,Dle,Mle,Nle,Ble,zle,Fle,Ule,Gle,Hle,qle,Vle,Wle,Kle,jle,Yle,Jle,Zle,Xle,Qle,$le,eue,tue,nue,iue,rue,aue,oue,sue,lue,uue,cue,pue,hue,due,yue,fue,vue,mue,gue,bue,wue,kue,Sue,Cue,Eue,xue,Aue,Tue,Pue,Rue,Lue,Iue,Oue=S.ccclass,_ue=S.property,Due=(ple=Oue("TournamentLeaderSkeleton"),hle=_ue(H),ple((fle=r((yle=function(r){n(h,r);var u,c,p=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=p.call.apply(p,[this].concat(i)),s(e,"container",fle,l(e)),e}return e(h,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(M),this.validateRequiredComponents()}},{key:"hide",value:(c=a(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue.runTweenAsync(L(this.uiOpacity).to(.2,{opacity:0}).call((function(){n.node.active=!1})),t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"show",value:(u=a(o().mark((function e(t,n){var i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,this.node.scale=new q(.8,.8,.8),this.uiOpacity.opacity=0,i=this.container.position.clone(),this.container.position=new q(i.x,i.y-100,i.z),(r=L(this.node).delay(t)).to(.2,{scale:q.ONE},{easing:"elasticOut"}),(a=L(this.container).delay(t)).to(.2,{position:i},{easing:"backOut"}),(s=L(this.uiOpacity).delay(t)).to(.2,{opacity:255},{easing:"cubicOut"}),e.next=13,Promise.all([Ue.runTweenAsync(r,n),Ue.runTweenAsync(a,n),Ue.runTweenAsync(s,n)]);case 13:this.node.scale=q.ONE,this.container.position=i,this.uiOpacity.opacity=255;case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),h}(x)).prototype,"container",[hle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dle=yle))||dle);w._RF.pop(),w._RF.push({},"cdaa9B4pK9PFrDmP6/GQcMn","TournamentDetailScreen",void 0);var Mue,Nue=S.ccclass,Bue=S.property,zue=S.requireComponent,Fue=Ludex,Uue=Fue.Events,Gue=Fue.Utils,Hue=Gue.Object,que=Gue.Time,Vue=Gue.Number,Wue=codex,Kue=Wue.event,jue=Wue.storage,Yue=Wue.player,Jue=Wue.leaderboard,Zue=Wue.language,Xue=1166;ble=Nue("TournamentDetailScreen"),wle=zue(k8),kle=Ii.required,Sle=Ii.required,Cle=Bue(Y),Ele=Ii.required,xle=Bue(cp),Ale=Ii.required,Tle=Bue(cp),Ple=Ii.required,Rle=Bue(cp),Lle=Ii.required,Ile=Bue(L$),Ole=Ii.required,_le=Bue(gle),Dle=Ii.required,Mle=Bue({type:H,group:"Buttons"}),Nle=Ii.required,Ble=Bue({type:H,group:"Buttons"}),zle=Ii.required,Fle=Bue({type:H,group:"Buttons"}),Ule=Ii.required,Gle=Bue({type:H,group:"Buttons"}),Hle=Ii.required,qle=Bue({type:I,group:"Buttons"}),Vle=Ii.required,Wle=Bue({type:N}),Kle=Ii.required,jle=Bue({type:H}),Yle=Ii.required,Jle=Bue({type:H}),Zle=Bue({type:[Due]}),Xle=Bue({type:Ex,group:"Confetti"}),Qle=Bue({type:Ex,group:"Confetti"}),$le=Ii.required,eue=Bue({type:A,group:"Container"}),tue=Ii.required,nue=Bue({type:A,group:"Container"}),iue=Ii.onlyRunInLifeCycleAsync,rue=Ii.onlyRunInLifeCycleAsync,aue=Ii.onlyRunInLifeCycleAsync,oue=Ii.onlyRunInLifeCycleAsync,sue=Ii.onlyRunInLifeCycleAsync,lue=Ii.onlyRunInLifeCycle,uue=Ii.onlyRunInLifeCycle,ble(cue=wle((hue=r((pue=function(r){n(P,r);var p,h,d,y,f,v,g,b,w,k,S,C,E,x,A,T=i(P);function P(){var e;t(this,P);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=T.call.apply(T,[this].concat(i)),s(e,"screen",hue,l(e)),s(e,"title",due,l(e)),s(e,"titleLocalizer",yue,l(e)),s(e,"timeLocalizer",fue,l(e)),s(e,"playerCountLocalizer",vue,l(e)),s(e,"tournamentLeaders",mue,l(e)),s(e,"topLeaders",gue,l(e)),s(e,"playButton",bue,l(e)),s(e,"continueButton",wue,l(e)),s(e,"replayButton",kue,l(e)),s(e,"logInButton",Sue,l(e)),s(e,"buttonsLayout",Cue,l(e)),s(e,"banner",Eue,l(e)),s(e,"bannerLoadingRing",xue,l(e)),s(e,"bannerMask",Aue,l(e)),s(e,"leaderSkeletons",Tue,l(e)),s(e,"leftConfetti",Pue,l(e)),s(e,"rightConfetti",Rue,l(e)),s(e,"container",Lue,l(e)),s(e,"tempContainer",Iue,l(e)),e.signal=new An,e.leadersPayload=null,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("TournamentDetailScreen: screen not found");e.validateEventPayload(t)&&(e.enabled=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(P,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(k8),Ii.validateRequiredProperties(this,P),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.signal.abort(),this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){Kue.on(Uue.OPENING_SCREEN,this.handleOpeningScreen),Kue.on(Uue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Kue.off(Uue.OPENING_SCREEN,this.handleOpeningScreen),Kue.off(Uue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name&&(this.payload=e,!0)}},{key:"open",value:function(){this.updateContainer(),this.updateInfo(),this.setInteractableButtons(!0),this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders(),this.updateButtonVisibility(),this.setPlayerCountWaiting(),this.node.scene.emit(Us.HIDE_UI)}},{key:"close",value:function(){nt.closeTournamentDetailScreen(),this.setInteractableButtons(!1),this.tournamentLeaders.scrollView.unlistenEvents(),this.node.scene.emit(Us.SHOW_UI),this.cleanup()}},{key:"cleanup",value:function(){var e;null===(e=this.signal)||void 0===e||e.abort(),this.signal=new An,this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders()}},{key:"updateInfo",value:(A=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c,p,h,d,y,f,v,m,g,b,w,k,S,C,E,x,A,T,P,R,L,I,O,_=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=this.signal,u=null===(t=this.payload)||void 0===t||null===(t=t.screenData)||void 0===t?void 0:t.tournament){e.next=4;break}return e.abrupt("return");case 4:return c=null===(n=null===(i=this.payload.screenData)||void 0===i?void 0:i.playAnimation)||void 0===n||n,(p=JSON.parse(u)).id=p.id.toString(),this.tournamentPayload=p,h=this.tournamentPayload,d=h.endTime,y=h.payload,f=h.title,v=h.tournamentType,m=y.leaderboardId,g=void 0===m?"":m,b=y.themeId,w=void 0===b?ut.AUTUMN:b,k=y.playerName,"PAGE_HOSTED"===v?this.updateTitleTournamentTitle(f):this.updateTitleWithPlayerName(null!=k?k:f),this.updateEndTime(d),this.updateTournamentBanner(w,l),S=jue.getStorage("tournament"),C=S.previousScore,E=S.animateTournamentLeader,jue.setStorageData("tournament","animateTournamentLeader",!1),e.next=17,this.showLoading(l);case 17:return e.next=19,this.loadLeaders(g);case 19:if(this.leadersPayload&&0!==this.leadersPayload.leaders.length&&!l.aborted){e.next=24;break}return this.updatePlayerCount(0),e.next=23,this.hideLoading(l);case 23:return e.abrupt("return");case 24:return x=this.leadersPayload,A=x.player,T=x.amountPlayer,(P=null!==(r=this.leadersPayload.leaders)&&void 0!==r?r:[]).sort((function(e,t){return e.rank-t.rank})),e.next=29,this.hideLoading(l);case 29:if(this.topLeaders&&this.tournamentLeaders&&!l.aborted){e.next=31;break}return e.abrupt("return");case 31:return this.updatePlayerCount(T),this.topLeaders.updateData(P),this.topLeaders.playShowLeadersAnimation(l),R=null!==(a=null==A?void 0:A.score)&&void 0!==a?a:0,L=null!==(s=null==A?void 0:A.rank)&&void 0!==s?s:0,I=E&&-1!==C&&C<R,this.tournamentLeaders.updateData(P),O=!1,A&&I&&(O=this.tournamentLeaders.updateDisplayPlayerLeaderForRankChanging(C,R,L)),this.tournamentLeaders.initScrollViews(),this.tournamentLeaders.scrollView.scrollView.enabled=!0,e.next=44,l.callAsync((function(e){return _.runShowUpAnimation(e,c)}));case 44:if(E&&O&&-1!==C&&this.tournamentLeaders){e.next=46;break}return e.abrupt("return");case 46:return e.next=48,l.callAsync((function(e){return _.tournamentLeaders.playRankChangeAnimation(e,C,R,L)}));case 48:this.tryPlayConfettiEffect(L);case 49:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"updateContainer",value:(x=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.tempContainer.height,this.container.node.position=this.tempContainer.node.position.clone(),t<Xue&&this.container.height!==t?(this.container.height=t,ee.instance.emit("canvas-resize")):t>Xue&&this.container.height<Xue&&(this.container.height=Xue,ee.instance.emit("canvas-resize"));case 3:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"loadLeaders",value:(E=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLeadersPayload(t);case 2:this.leadersPayload=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"showLoading",value:(C=a(o().mark((function e(t){var n,i=this,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.next=3,Promise.all([this.tournamentLeaders.scrollView.unlistenEvents(),this.tournamentLeaders.scrollView.scrollToTop(t,.1).then((function(){i.tournamentLeaders.scrollView.scrollView.enabled=!1,i.tournamentLeaders.scrollView.listenEvents()})),this.leaderSkeletons.map((function(e,i){return e.show(i*n,t)}))]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"hideLoading",value:(S=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.leaderSkeletons.map((function(e){return e.hide(t)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"runShowUpAnimation",value:(k=a(o().mark((function e(t){var n,i,r,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(s.length>1&&void 0!==s[1])||s[1],a=r?0:.1,e.next=4,null===(n=this.tournamentLeaders)||void 0===n?void 0:n.playShowLeadersAnimation(t,a);case 4:return e.next=6,null===(i=this.tournamentLeaders)||void 0===i?void 0:i.scrollToPlayerLeader(1.5,t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"tryPlayConfettiEffect",value:function(e){if(!(e>10)){var t=Ye.isLandscape(),n=t?50:30,i=t?5e3:2e3,r=t?15e3:1e4,a=t?40:60,o=t?110:100,s=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=r,this.leftConfetti.shapeModule.angle=a,this.rightConfetti.shapeModule.angle=o,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=s,this.leftConfetti.play(),this.rightConfetti.play(),Ve.playSound(Ji.LEADERBOARD_TRIUMPH)}}},{key:"updateTitleWithPlayerName",value:function(e){void 0!==e&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([e]))}},{key:"updateTitleTournamentTitle",value:function(e){this.titleLocalizer.enabled=!1,this.title.string=e}},{key:"updateEndTime",value:function(e){try{var t=que.getRelativeTime(e,Zue.getCurrentLocale(),{style:"short"});this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([t])}catch(e){this.timeLocalizer.key="game.endsSoon"}}},{key:"updateTournamentBanner",value:(w=a(o().mark((function e(t,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.banner.spriteFrame=null,i=Fe.getAsset("".concat(dt[t],"/spriteFrame"),se)){e.next=8;break}return this.bannerMask.active=!0,this.bannerLoadingRing.active=!0,e.next=7,Fe.loadThemeTournamentAsync(t);case 7:i=e.sent;case 8:if(i){e.next=12;break}return e.next=11,Fe.loadThemeTournamentAsync(ut.SUMMER);case 11:i=e.sent;case 12:if(this.banner&&i&&!n.aborted){e.next=14;break}return e.abrupt("return");case 14:this.banner.spriteFrame=i,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1;case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"updatePlayerCount",value:function(e){var t=Vue.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"updateButtonVisibility",value:function(){var e,t;if(this.playButton.active=!1,this.continueButton.active=!1,this.replayButton.active=!1,this.logInButton.active=!1,GameSDK.extra.isGuest)this.logInButton.active=!0;else{var n=(null!==(e=null===(t=this.payload)||void 0===t?void 0:t.screenData)&&void 0!==e?e:{}).tournamentContextType;switch(void 0===n?"tournament_start":n){case"tournament_end":var i,r,a=(null!==(i=null===(r=Yue.getGameData())||void 0===r?void 0:r.tournamentProgress[this.tournamentPayload.id])&&void 0!==i?i:{}).replayCount,o=void 0===a?0:a;this.continueButton.active=o>1,this.replayButton.active=!0,this.buttonsLayout.updateLayout(!0);break;case"tournament_start":this.playButton.active=!0}}}},{key:"getLeadersPayload",value:(b=a(o().mark((function e(t){var n,i,r,a,s,l,u,p,h,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Jue.getLeaderboardName(t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,pI.getAllLeaderboardAsync(t);case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:r=Hue.vals(i.leaders),a=Yue.getPlayerId(),s={leaders:[],amountPlayer:i.amountPlayer},l=c(r);try{for(l.s();!(u=l.n()).done;)(p=u.value).playerId===a?(s.player=p,s.leaders.push(p)):s.leaders.push(p)}catch(e){l.e(e)}finally{l.f()}if(s.player){e.next=19;break}return e.next=16,Jue.getLeadersByPlayerIdsAsync(n,[a]);case 16:h=e.sent,(d=h[0])&&(s.player=d,s.leaders.push(d));case 19:return e.abrupt("return",s);case 20:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"handleOnLogIn",value:(g=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"initPlayerAsync"in GameSDK.player){e.next=3;break}return e.abrupt("return");case 3:return nt.showLoadingScreen(),e.next=6,GameSDK.player.initPlayerAsync();case 6:if(nt.closeLoadingScreen(),!GameSDK.extra.isGuest){e.next=10;break}return nt.showNotificationScreenWithLocalizedKey("error.login",1),e.abrupt("return");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),nt.closeLoadingScreen(),nt.showNotificationScreenWithLocalizedKey("error.login",1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),function(){return g.apply(this,arguments)})},{key:"handleOnPlay",value:(v=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.isGameSDK("Yandex")){e.next=3;break}return e.next=3,at.showInterstitialAdAsync();case 3:return e.next=5,this.processPlayTournament({level:1,score:0,replay:!1});case 5:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"handleOnReplay",value:(f=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameSDK.isGameSDK("Yandex")){e.next=3;break}return e.next=3,at.showInterstitialAdAsync();case 3:return e.next=5,this.processPlayTournament({level:1,score:0,replay:!0});case 5:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"handleOnContinue",value:(y=a(o().mark((function e(){var t,n,i,r,a,s,l,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at.showRewardVideoAdAsync();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return i=null!==(t=null===(n=Yue.getGameData())||void 0===n?void 0:n.tournamentProgress[this.tournamentPayload.id])&&void 0!==t?t:{},r=i.level,a=void 0===r?1:r,s=i.score,l=void 0===s?0:s,u=a>1?Math.floor(a/2):1,c=Math.floor(l/2),e.next=10,this.processPlayTournament({level:u,score:c,replay:!1});case 10:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"processPlayTournament",value:(d=a(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.tournamentPayload.id||"",i=rt.validateTournamentExpired(n),rt.syncTournamentProgress(),!i){e.next=8;break}return this.close(),this.node.scene.emit(Vd.RELOAD_TOURNAMENT),nt.showNotificationScreenWithLocalizedKey("error.tourEnded",2),e.abrupt("return");case 8:return r=t.level,a=t.score,s=t.replay,e.prev=9,nt.showLoadingScreen(),e.next=13,hy.setMatchCustomDataAsync({level:r,score:a});case 13:return e.next=15,this.processJoinTournament(r);case 15:s&&this.increaseTournamentReplayCount(),e.next=34;break;case 18:if(e.prev=18,e.t0=e.catch(9),!Hue.hasOwn(e.t0,"code")||"USER_INPUT"!==e.t0.code){e.next=22;break}return e.abrupt("return");case 22:return e.prev=22,e.next=25,this.processContinueTournament(r);case 25:s&&this.increaseTournamentReplayCount(),e.next=34;break;case 28:if(e.prev=28,e.t1=e.catch(22),!Hue.hasOwn(e.t1,"code")||"USER_INPUT"!==e.t1.code){e.next=32;break}return e.abrupt("return");case 32:console.error("processPlayButtonPressed",e.t1),nt.showNotificationScreenWithLocalizedKey("error.tourJoinFail",2);case 34:return e.prev=34,nt.closeLoadingScreen(),e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[9,18,34,37],[22,28]])}))),function(e){return d.apply(this,arguments)})},{key:"processJoinTournament",value:(h=a(o().mark((function e(){var t,n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,e.prev=1,n=this.tournamentPayload.id||"",e.next=5,hy.joinTournamentAsync(n);case 5:ot.switchToGameScene({level:t}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),console.warn("processJoinTournament",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return h.apply(this,arguments)})},{key:"processContinueTournament",value:(p=a(o().mark((function e(){var t,n,i,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:1,e.prev=1,i=null!==(n=GameSDK.context.getID())&&void 0!==n?n:"",e.next=5,hy.continueTournamentAsync(i);case 5:ot.switchToGameScene({level:t}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),console.warn("processContinueTournament",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(){return p.apply(this,arguments)})},{key:"increaseTournamentReplayCount",value:function(){var e,t,n=(null!==(e=hy.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;if(n){var i=Yue.getGameData();if(i){var r=i.tournamentProgress,a=(null!==(t=r[n])&&void 0!==t?t:{}).replayCount,o=void 0===a?0:a;Yue.setGameData({tournamentProgress:m({},n,u(u({level:1,score:0},r[n]),{},{replayCount:o+1}))})}}}},{key:"setInteractableButtons",value:function(e){this.screen.backgroundMaskButton.interactable=e}}]),P}(x)).prototype,"screen",[kle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),due=r(pue.prototype,"title",[Sle,Cle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yue=r(pue.prototype,"titleLocalizer",[Ele,xle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fue=r(pue.prototype,"timeLocalizer",[Ale,Tle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vue=r(pue.prototype,"playerCountLocalizer",[Ple,Rle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mue=r(pue.prototype,"tournamentLeaders",[Lle,Ile],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gue=r(pue.prototype,"topLeaders",[Ole,_le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bue=r(pue.prototype,"playButton",[Dle,Mle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wue=r(pue.prototype,"continueButton",[Nle,Ble],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kue=r(pue.prototype,"replayButton",[zle,Fle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sue=r(pue.prototype,"logInButton",[Ule,Gle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cue=r(pue.prototype,"buttonsLayout",[Hle,qle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eue=r(pue.prototype,"banner",[Vle,Wle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xue=r(pue.prototype,"bannerLoadingRing",[Kle,jle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aue=r(pue.prototype,"bannerMask",[Yle,Jle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tue=r(pue.prototype,"leaderSkeletons",[Zle],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Pue=r(pue.prototype,"leftConfetti",[Xle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rue=r(pue.prototype,"rightConfetti",[Qle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lue=r(pue.prototype,"container",[$le,eue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iue=r(pue.prototype,"tempContainer",[tue,nue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r(pue.prototype,"updateInfo",[iue],Object.getOwnPropertyDescriptor(pue.prototype,"updateInfo"),pue.prototype),r(pue.prototype,"loadLeaders",[rue],Object.getOwnPropertyDescriptor(pue.prototype,"loadLeaders"),pue.prototype),r(pue.prototype,"showLoading",[aue],Object.getOwnPropertyDescriptor(pue.prototype,"showLoading"),pue.prototype),r(pue.prototype,"hideLoading",[oue],Object.getOwnPropertyDescriptor(pue.prototype,"hideLoading"),pue.prototype),r(pue.prototype,"runShowUpAnimation",[sue],Object.getOwnPropertyDescriptor(pue.prototype,"runShowUpAnimation"),pue.prototype),r(pue.prototype,"tryPlayConfettiEffect",[lue],Object.getOwnPropertyDescriptor(pue.prototype,"tryPlayConfettiEffect"),pue.prototype),r(pue.prototype,"updatePlayerCount",[uue],Object.getOwnPropertyDescriptor(pue.prototype,"updatePlayerCount"),pue.prototype),cue=pue))||cue);w._RF.pop(),w._RF.push({},"36d58kn8v5POaqgX4C8S3ct","TournamentLeader",void 0);(0,S.ccclass)("TournamentLeader")(Mue=function(r){n(o,r);var a=i(o);function o(){return t(this,o),a.apply(this,arguments)}return e(o)}(x$));w._RF.pop(),w._RF.push({},"88f2b4WH6NBlaGD7WvCOA2j","VibrateUtils",void 0);Ludex.Utils.Browser,codex.player;w._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});