"use strict";var jh=Object.create,Ct=Object.defineProperty,Wh=Object.defineProperties,Ai=Object.getOwnPropertyDescriptor,zh=Object.getOwnPropertyDescriptors,qh=Object.getOwnPropertyNames,Zt=Object.getOwnPropertySymbols,Qh=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty,$i=Object.prototype.propertyIsEnumerable,tt=Math.pow,Pi=(t,e,a)=>e in t?Ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,T=(t,e)=>{for(var a in e||={})bn.call(e,a)&&Pi(t,a,e[a]);if(Zt)for(var a of Zt(e))$i.call(e,a)&&Pi(t,a,e[a]);return t},de=(t,e)=>Wh(t,zh(e)),vn=(t,e)=>{var a={};for(var r in t)bn.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&Zt)for(var r of Zt(t))e.indexOf(r)<0&&$i.call(t,r)&&(a[r]=t[r]);return a},N=(t,e)=>()=>(t&&(e=t(t=0)),e),Yh=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Sn=(t,e)=>{for(var a in e)Ct(t,a,{get:e[a],enumerable:!0})},Jh=(t,e,a,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of qh(e))!bn.call(t,n)&&n!==a&&Ct(t,n,{get:()=>e[n],enumerable:!(r=Ai(e,n))||r.enumerable});return t},Xh=(t,e,a)=>(a=t!=null?jh(Qh(t)):{},Jh(e||!t||!t.__esModule?Ct(a,"default",{value:t,enumerable:!0}):a,t)),se=(t,e,a,r)=>{for(var n=r>1?void 0:r?Ai(e,a):e,y=t.length-1,g;y>=0;y--)(g=t[y])&&(n=(r?g(e,a,n):g(n))||n);return r&&n&&Ct(e,a,n),n},A,s=N(()=>{A={AppId:"886427089750257",AppDescription:"",ApiHost:"https://igs-singleplay.suncs.app",OtherHost:"https://igs-leaderboard.suncs.app",Ads:{Enabled:!0,PreloadAds:!0,NotifyPlayerBeforeShow:!1,ShowAdOnLoad:{Enabled:!1,DelaySeconds:0,PlacementId:"interstitial_demo"},DegradationTracking:{ResetTimeMinutes:5,MaxFailedAttempts:8},AdServiceConfigs:{AdSense:{Enabled:!1,UsePreload:!1,DataAdClient:"ca-pub-1234567890",DataAdChannel:"1234567890",DataAdBreakTest:!1,DataAdFrequencyHint:30},Savana:{Enabled:!1,UsePreload:!1,DataAdClient:"ca-pub-1234567890",DataAdChannel:"1234567890",DataAdBreakTest:!1,DataAdFrequencyHint:45,BannerAdSlotId:"1234567890"},AppLovin:{Enabled:!1,UsePreload:!1}},InterstitialAdOptions:[{AdService:"platform",PlacementId:"interstitial_demo",SecondsFirstTime:30,SecondsBetweenAds:45},{AdService:"adsense",PlacementId:"interstitial_adsense",SecondsFirstTime:30,SecondsBetweenAds:45}],RewardedVideoAdOptions:[{AdService:"platform",PlacementId:"rewarded_video_demo",SecondsFirstTime:0,SecondsBetweenAds:0},{AdService:"adsense",PlacementId:"rewarded_video_adsense",SecondsFirstTime:0,SecondsBetweenAds:0}],RewardedInterstitialAdOptions:[{AdService:"platform",PlacementId:"rewarded_interstitial_demo",SecondsFirstTime:0,SecondsBetweenAds:0},{AdService:"adsense",PlacementId:"rewarded_interstitial_adsense",SecondsFirstTime:0,SecondsBetweenAds:0}],BannerDisplayAdOptions:[{AdService:"platform",PlacementId:"banner_demo",Position:"bottom",BannerHeight:50,SecondsReload:60,Platform:"ALL"}]},Languages:{Enabled:!0,DetectPlayerLocale:!0},GameSDKOptions:{AllowWithoutSDK:!0,UseNameGenerator:!0,MSGames:{LoginOnStart:!1,MaxLoginAttemptsPerDay:1},Yandex:{LoginOnStart:!1,MaxLoginAttemptsPerDay:1},Playable:{AppleAppStoreUrl:"https://apps.apple.com/us/app/ad-testing/id1463016906",GooglePlayStoreUrl:"https://play.google.com/store/apps/details?id=com.unity3d.auicreativetestapp"},TranssionH5:{GaId:"G-XXXXXXXXXX"}},Core:{InitAsync:!0,AverageLoadTime:3,StartSDKAfterLoadGame:!0,FastCheckTournamentContext:!0},GameEngine:{ForceDesktopDPR:2,AutoResizeCanvas:!0,PreferredFPS:{Mobile:60,Desktop:60},DynamicAtlas:{IOS:{Enabled:!0,MaxAtlasCount:1,MaxAtlasSize:2048,MaxFrameSize:512},Android:{Enabled:!0,MaxAtlasCount:1,MaxAtlasSize:2048,MaxFrameSize:512},Desktop:{Enabled:!0,MaxAtlasCount:1,MaxAtlasSize:4096,MaxFrameSize:1024},AutoAtlasSize:!0,UsePowerOfTwo:!1,TextureBleeding:!0,AllowNonePackable:!1,TextureAtlasOptimize:!0,OnlyOptimizeWhenRenderTooLong:!0},DynamicAssets:{Enabled:!0,Debug:!1,Resolution:{Adjust:2,Original:2},Compression:{PNG:{colors:256,quality:50,dither:.6,palette:!0,compressionLevel:8},JPEG:{quality:50,mozjpeg:!0},WEBP:{quality:35,lossless:!1,alphaQuality:40,smartSubsample:!0,preset:"drawing"}},IgnoreFiles:[]},HybridFileCache:{Enabled:!0,BuildMode:{Enabled:!0,InvalidateMode:"both",SupportedExtensions:[".json",".cconb"]},PreviewMode:{Enabled:!1,CacheScene:!1,CachePrefab:!1,CacheUuidExtension:!1,InvalidateMode:"commitId",SupportedExtensions:[".json",".cconb"]}}},Gameplay:{StartAdAtLevel:1,MaxRescueCount:1,Tutorial:{Enabled:!0,ForceUseTutorial:!1}},Firebase:{Enabled:!1,Options:{AppId:"",ApiKey:"",ProjectId:"",AuthDomain:"",StorageBucket:"",MeasurementId:"",MessagingSenderId:""},Services:{Analytics:{Enabled:!1},Performance:{Enabled:!1},RemoteConfig:{Enabled:!1}}},Analytics:{Enabled:!0,GoogleAnalytics:{Enabled:!0,ConsoleLog:!1},ClarityAnalytics:{Enabled:!1,ConsoleLog:!1,ScreenshotCanvas:{Interval:1500,ByEvent:["APP_READY","PAGE_VIEW","BUTTON_CLICK","AD_SHOWING","LEVEL_START","LEVEL_END"]}},FirebaseAnalytics:{Enabled:!1,ConsoleLog:!1},FacebookAnalytics:{Prefix:"fba",Enabled:!1,ConsoleLog:!1}},PerformanceMonitor:{CoreFlows:!1,EngineFlows:!1,GameSDKFlows:!1,LoadResources:!1,FpsTracking:{Enabled:!1,TrackingDuration:60,TrackingInterval:10}},RemoteConfig:{Enabled:!1,Options:{ForceReloadGame:!1,FetchIntervalInSeconds:300},ServiceType:"mockup",DefaultConfigId:"default",SupportedDataTypes:["Ludex","Gameplay"],MockupConfig:{Enabled:!0},SelfHostedConfig:{Enabled:!1,AppId:"",ApiKey:"",ApiUrl:""}},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Leaderboards:{Enabled:!0,LeaderboardList:[{Name:"Daily",Id:"5fed5ccff033f2477a624a66",Mode:"single",Limit:50},{Name:"Weekly",Id:"5fed5ccff033f2477a624a65",Mode:"single",Limit:50}]},Notification:{Enabled:!1,ApiUrl:"https://notifications.sunstudio.io"},DailyRewards:{Enabled:!1,MaxDays:7,MockTime:0,CheckInterrupt:!1},Mockup:{Ads:{Enabled:!1,ErrorRate:5,GiphyApiKey:"VmjHIRsfrwCAssDS4mDo9DoImxJm1lLM",SafeAreaBottom:0},Match:{Enabled:!1,ErrorRate:5,PlayerInfo:{Id:"player-mock",Name:"Player Mock",Photo:"",Signature:""},OpponentInfo:{Id:"opponent-mock",Name:"Opponent Mock",Photo:"",Signature:""}},GameSDK:{SlowAPI:{Enabled:!1,ErrorRate:5,StartDelay:1e3,InitialDelay:1e3,PlayerDataDelay:1e3},Context:{Enabled:!1},Player:{SubscribeBot:{Enabled:!1,CanSubscribeBot:!0},ConnectedPlayers:{Enabled:!1,ErrorRate:5,RandomDelayMs:1e3,NumOfPlayers:3}},AddShortcut:{Enabled:!1,CanCreateShortcut:!0},Tournament:{Enabled:!1,ErrorRates:5,RandomDelayMs:1e3,NumOfTournament:{Normal:10,HostPage:2}},Payments:{Enabled:!1,ErrorRates:5,RandomDelayMs:1e3,Products:[]}},Profile:{Enabled:!1,ErrorRate:5,RandomDelayMs:1e3,AvatarUrl:"https://picsum.photos/seed/%1/300/300",RandomNameApiKey:"a1f7164dc9d2468b953aef67b0a19355"},Leaderboards:{Enabled:!1,MinScore:10,MaxScore:100,ErrorRate:5,NumOfLeaders:{Min:10,Max:50},DefaultLimit:60,RandomDelayMs:1e3},LoadingScreen:{Enabled:!1}},Debugger:{Console:{Enabled:!1},Profiler:{Enabled:!1},EventLogging:{Enabled:!1},CanvasRecorder:{Enabled:!1,OnlyCore:!1,PanelExpanded:!1,Options:{Type:"png",Quality:.85,RecordFps:60,SyncFps:!0}},MonitorError:{Enabled:!1,ApiKey:"",Service:"BugSnag",TrackUser:!1,TrackPerformance:!1,FilterErrors:{Codes:{Accepted:[],Ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{Accepted:[],Ignored:["Load image failed"]}},Feedback:!1},ListPlayerDevIds:["0000"],InputRecorder:{Enabled:!1,Logging:!0,PlaybackDelay:0,TimeScale:1,UseVisualizer:!0,SkipInactivity:{Enabled:!0,MinTime:3e3},MouseEvents:{mousedown:!0,mouseup:!0,mousemove:!0,mouseenter:!0,mouseleave:!0,mouseout:!0,mouseover:!0}}},AdaptivePerformance:{Enabled:!0,Quality:{Min:1,Max:2,AdjustStep:.1},Options:{FpsThreshold:48,CheckInterval:2e3,AutoUpgradeQuality:!0,OnlyUpdateWhenSwitchScene:!1},TrackingSceneNames:["GameScene"]},FrameCapture:{Enabled:!0,Options:{Quality:.85,RenderType:"jpeg",UseBlobIfPossible:!0,FallbackWithWideframe:"Default"}},Auth:{Enabled:!0},Audio:{Enabled:!0},Match:{Enabled:!0},Player:{Enabled:!0},Profile:{Enabled:!0},Context:{Enabled:!0},Missions:{Enabled:!1}}}),P,o=N(()=>{P={AllowWithoutSDK:!0,UseNameGenerator:!0}}),rt,tm,rm,i=N(()=>{"use strict";rt={},window.__listeners=rt,tm=window.addEventListener.bind(window),rm=100,window.addEventListener=(t,e,a)=>{rt[t]||(rt[t]=[]),rt[t].length>=rm&&(rt[t].length=0),rt[t].push(e),tm(t,e,a)}});function am(){let t=["error","unhandledrejection"],e=window.__listeners??[];for(let a of t)e[a]?.[0]&&window.removeEventListener(a,window.__listeners[a].shift())}function xi(t){window.__errorQueue&&(window.__errorQueue.length>=nm&&(window.__errorQueue.length=0),window.__errorQueue.push(typeof t=="string"?new Error(t):t))}function sm(){window.addEventListener("error",t=>{xi(t.error)}),window.addEventListener("unhandledrejection",t=>{xi(t.reason)})}var nm,c=N(()=>{"use strict";window.__errorQueue=[],nm=100,window.addEventListener("load",()=>{am(),sm()})}),nt,om,im,Dn,er,In,cm,tr,lm,Ln,dm,um,pm,hm,mm,wi,fm,l=N(()=>{"use strict";window.__sdkLoadingCount=window.__sdkLoadingCount??0,window.__errorQueue=window.__errorQueue??[],nt=t=>{let e=Ludex?.Utils.Function.toError(t);e?.message&&(Dn("app_crash_handle",{error:e.message}),window.__errorQueue?.push(e),codex?.monitorError?.sendException(e))},om="GameSDK Initialize",im=()=>{let t=console.time,e=console.timeEnd,a=console.timeLog,r=n=>n[0]===om;console.time=(...n)=>{if(!r(n))return t},console.timeEnd=(...n)=>{if(!r(n))return e},console.timeLog=(...n)=>{if(!r(n))return a}},Dn=(t,e)=>{t&&codex?.analytics?.event(t,e)},er=null,In=()=>{er&&(clearInterval(er),er=null)},cm=()=>{if(In(),!(window.__sdkLoadingCount>=70)){let t=70-window.__sdkLoadingCount,e=t>0?3e3/t:3e3;er=setInterval(()=>{if(window.__sdkLoadingCount>=70){In();return}window.__sdkLoadingCount++,GameSDK?.setLoadingProgress(window.__sdkLoadingCount)},e)}},tr=null,lm=()=>{Ln(),tr=setTimeout(()=>{window.__sdkLoadingCount<=1&&GameSDK?.extra?.displayWarnLoading?.(!0)},8e3)},Ln=()=>{tr!==null&&(clearTimeout(tr),tr=null),GameSDK?.extra?.displayWarnLoading?.(!1)},dm=async t=>{let e=document.createElement("script");return e.src=`https://www.googletagmanager.com/gtag/js?id=${t}`,e.async=!0,new Promise((a,r)=>{let n=!1,y=null,g=null,w=null,v=()=>{y!==null&&clearTimeout(y),g&&e.removeEventListener("load",g),w&&e.removeEventListener("error",w)};y=setTimeout(()=>{n||(n=!0,v(),r(new Error(`Timeout loading GA script after ${1e4/1e3}s`)))},1e4),g=()=>{n||(n=!0,v(),a())},w=()=>{n||(n=!0,v(),r(new Error("Failed to load GA script")))},e.addEventListener("load",g),e.addEventListener("error",w),document.head.appendChild(e)})},um=(t,e,a)=>{try{if(typeof window.gtag!="function")return;let r=GameSDK?.getEntryPointData()||{},{fbig_ad_id:n,fbig_adset_id:y,fbig_campaign_id:g,fb_instant_game_adset_id:w,fb_instant_game_ad_id:v,fb_instant_game_campaign_id:S}=r,D=n??v??void 0,x=y??w??void 0,b=g??S??void 0;window.dataLayer=window.dataLayer||[],window.gtag("js",new Date),window.gtag("set",{client_id:`100.${t}`,user_id:t,send_page_view:!1});let _=446;for(let C of a)window.gtag("config",C,{cookie_flags:"SameSite=None;Secure",build:_,medium:e,campaign:b,groups:"GA"});let M=(Ludex?.Utils?.Browser?.getQueryParams()||{}).entry_point||e,B={user_id:t,player_id:t,app_version:_,traffic_source:e,traffic_source_detail:M,ad_id:D,adset_id:x,campaign_id:b,new_user:void 0,coins:void 0,score:void 0};window.gtag("set","user_properties",B)}catch(r){nt(r)}},pm=async()=>{let t=[],e;try{return}catch(a){nt(a)}finally{mm()}},hm=()=>{try{if(!codex?.player||typeof window.gtag!="function")return;let t=codex.player.getBestScore()??0,e=codex.player.getGameData()?.coins??0,a=codex.player.isFirstSession()??void 0,r=GameSDK?.getEntryPointData()||{},{content:n,notif_id:y}=r,g={new_user:a,coins:e,score:t};(n||y)&&(g.traffic_source_detail=n??`notif_${y}`);let w=Object.entries(g).filter(([v,S])=>S!==void 0).reduce((v,[S,D])=>(v[S]=D,v),{});Object.keys(w).length>0&&window.gtag("set","user_properties",w)}catch(t){nt(t)}},mm=()=>{try{let{Events:t,Plugins:e}=Ludex,{Events:a}=e.Analytics??{};if(!a)return;Dn(a.APP_LAUNCH),codex.event.catchUp(t.GAME_SDK_READY,()=>{Dn(a.APP_INITIALIZED)}),codex.event.catchUp(Ludex.Events.PLAYER_INFO_LOADED,hm)}catch(t){nt(t)}},wi=async(t=0)=>{try{lm(),await GameSDK.initializeAsync(),Ln(),window.__sdkLoadingCount=1,GameSDK.setLoadingProgress(window.__sdkLoadingCount),cm();let e=pm();codex.event.emit(Ludex.Events.GAME_SDK_READY)}catch(e){if(Ln(),In(),t>=5){nt(e);return}setTimeout(()=>wi(t+1),2e3)}finally{}},fm=()=>{let t=0,e=()=>{"GameSDK"in window?wi():t<1e4?(t+=50,setTimeout(e,50)):nt(new Error(`GameSDK not found after ${1e4/1e3}s`))};e()},im(),fm()}),ym,d=N(()=>{"use strict";ym=window.navigator.getGamepads,window.navigator.getGamepads=()=>{try{return ym()}catch{return[]}}}),u=N(()=>{"use strict";window.performance=window.performance||{},(typeof performance.mark!="function"||typeof performance.measure!="function")&&(window.performance={mark:()=>{},measure:()=>{}}),performance.mark("load-start")}),Cn,En,gm,Pm,Am,$m,xm,p=N(()=>{"use strict";Cn="0",En="0",gm=()=>{if(!URLSearchParams)return;let t=new URLSearchParams(window.location.search);Cn=t.get("no-toolbar")||Cn,En=t.get("no-vconsole")||En,Cn==="1"&&Pm(),En==="1"&&Am()},Pm=()=>{let t=setInterval(()=>{let e=document.querySelector(".toolbar");e instanceof HTMLDivElement&&(clearInterval(t),e.style.display="none")},100)},Am=()=>{if(!("vConsole"in window)||!("VConsole"in window))return;let t={value:null,writable:!1,enumerable:!1,configurable:!1},e=setInterval(()=>{window.vConsole.isInited&&(window.vConsole.destroy(),window.vConsole.printLog=()=>{},Object.defineProperty(window,"vConsole",t),clearInterval(e))},10);Object.defineProperty(window,"VConsole",t)},gm(),$m=["Init Base","Init Infrastructure","Init SubSystem","Init Project"],xm=()=>{let t=console.time,e=console.timeEnd,a=console.timeLog,r=n=>!!$m.includes(n[0]);console.time=(...n)=>{if(!r(n))return t},console.timeEnd=(...n)=>{if(!r(n))return e},console.timeLog=(...n)=>{if(!r(n))return a}},xm()}),wm,bm,h=N(()=>{"use strict";wm=()=>{System.register(["./application.js"],()=>{let t;function e(r){return System.import(r)}function a(){let r=document.getElementById("GameCanvas"),n=r?.parentElement;if(!n){setTimeout(a,300);return}r.style.position="relative";let y=n.getBoundingClientRect();r.width=y.width,r.height=y.height;let g=new t;e("cc").then(w=>new Promise(v=>{codex.event.catchUp(Ludex.Events.CORE_BOOTING,()=>{window.__sdkLoadingCount<30&&(window.__sdkLoadingCount=30),v(g.init(w))})})).then(()=>(window.__sdkLoadingCount<40&&(window.__sdkLoadingCount=40),g.start())).then(()=>{window.__sdkLoadingCount<50&&(window.__sdkLoadingCount=50)}).catch(w=>{let v=Ludex.Utils.Function.toError(w);codex.monitorError?.sendException(v)})}return{setters:[r=>{t=r.Application}],execute:a}})},bm=setInterval(()=>{"System"in window&&(clearInterval(bm),wm())},5)});function vm(){let t=arguments;t[0]==="event"&&(typeof t[2]!="object"&&(t[2]={}),t[2].build=446,t[2].send_to="GA",t[2].extend_session=1),window.dataLayer.push(t)}function Sm(){try{return}catch{}}var m=N(()=>{"use strict";window.dataLayer=window.dataLayer||[],window.gtag=vm,Sm()}),Q={};Sn(Q,{default:()=>E});var E,O=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),E=null}),Tn,at,rr=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Tn=class{i;e;$=null;W="SOLO";Ee=[];it=null;v=null;ot=null;te;xe=[];wt;constructor(t){this.i=t,this.e=t.extra}setCurrentContextId(t){this.At(t),this.$=t,this.W="THREAD"}initContextInfo(t,e){let{Array:a,String:r}=Ludex.Utils;this.te={},this.wt={},this.xe=a.fillWith(10,()=>r.generateObjectId()),!(!t||!e)&&(["SOLO","THREAD","POST","GROUP"].indexOf(e)<0||(this.$=t,this.W=e))}getID(){return this.$}getType(){return this.W}async Da(){if(this.ot)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.ot=new t,await this.ot.setupTemplate())}async Ea(){if(this.it)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.it=new t,await this.it.setupTemplate())}async xa(){if(this.v)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.v=new t,await this.v.setupTemplate())}async switchAsync(t,e=!1){if(this.e.checkPopupShown(),await this.e.awaitRandomDelay(),this.ba(t),t==="SOLO"&&e){this.$=null,this.W="SOLO",this.ee([]);return}await this.Da(),await new Promise((r,n)=>{this.ot||this.i.extra.exceptionUnsupported(),this.ot.onYes(this.z(r)),this.ot.onNo(this.q(n)),this.ot.show(t),this.e.isPopupShown=!0}),this.$=t,this.W="THREAD",this.As(t,10);let a=this.wt[t].map(r=>this.be(r));this.ee(a)}async chooseAsync(t){this.e.checkPopupShown(),await this.e.awaitRandomDelay(),await this.Ea(),await new Promise((n,y)=>{this.it||this.i.extra.exceptionUnsupported(),this.it.onYes(this.z(n)),this.it.onNo(this.q(y)),this.it.show(),this.e.isPopupShown=!0});let e=Math.floor(Math.random()*this.xe.length),a=this.xe[e];this.At(a),this.$=a,this.W="THREAD",this.As(a,2);let r=this.wt[a].map(n=>this.be(n));this.ee(r)}async createAsync(t){if(this.e.checkPopupShown(),await this.e.awaitRandomDelay(),await this.Pa(t),await this.xa(),await new Promise((r,n)=>{this.v||this.i.extra.exceptionUnsupported(),this.v.onYes(this.z(r)),this.v.onNo(this.q(n)),this.v.show(t),this.e.isPopupShown=!0}),!this.te[t]){let{Utils:{String:r}}=Ludex;this.te[t]=r.generateObjectId()}let e=this.te[t];this.At(e),this.$=e,this.W="THREAD";let a=this.be(t);this.ee([a])}z=t=>()=>{this.e.isPopupShown=!1,t(!0)};q=t=>()=>{this.e.isPopupShown=!1;try{this.e.exceptionUserInput("Player closed the context menu")}catch(e){t(e)}};async getPlayersAsync(){return await this.e.awaitRandomDelay(),this.Ee}As(t,e){if(!this.wt[t]){let{Array:a,String:r}=Ludex.Utils,n=Math.floor(Math.random()*e),y=a.fillWith(n,()=>r.generateObjectId());this.wt[t]=y}return this.wt[t]}be(t){return{getID:()=>t,getName:()=>`Player ${t}`,getPhoto:()=>""}}ee(t){if(this.W==="SOLO"){this.Ee=[];return}this.Ee=t}At(t){this.$===t&&this.e.exceptionSameContext()}async Pa(t){if((!t||Array.isArray(t))&&this.e.exceptionClientUnsupportedOperation("Client does not support no player IDS or multiple player IDs yet"),!Ludex.Utils.Valid.isString(t)){let a=`Array of type String contained a value of another type: ${t}`;this.e.exceptionInvalidParam(a)}if(t===GameSDK.player.getID()&&this.e.exceptionInvalidParam("At least one player id besides the current player must be provided."),(await GameSDK.player.getConnectedPlayersAsync()).some(a=>a.getID()===t))return;let e=`Provided ID ${t} is not a connected player of the current player.`;this.e.exceptionInvalidParam(e)}ba(t){this.At(t),!Ludex.Utils.Valid.isString(t)&&this.e.exceptionClientUnsupportedOperation("Client requires update to support this operation")}},at=Tn}),Mn,bi,vi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Mn=class extends Error{code;constructor(t,e){super(e),this.code=t}},bi=Mn}),Dm,On,nr,_n=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),vi(),Dm=1e4,On=class{i;isGuest=!1;isPopupShown=!1;Y=null;constructor(t){this.i=t}async checkAndSubscribeBotAsync(){if(!await this.i.player.canSubscribeBotAsync())return!1;let{analytics:t}=codex,{Plugins:{Analytics:{Events:e}={}}}=Ludex;e&&t.event(e.BOT_SUBSCRIBE_POPUP);try{return await this.waitSDKInitiatedAsync(),await this.i.player.subscribeBotAsync(),e&&t.event(e.BOT_SUBSCRIBE,{success:!0}),!0}catch{return e&&t.event(e.BOT_SUBSCRIBE,{success:!1}),!1}}async checkAndCreateShortcutAsync(){if(!await this.i.canCreateShortcutAsync())return;let{analytics:t}=codex,{Plugins:{Analytics:{Events:e}={}}}=Ludex;e&&t.event(e.SHORTCUT_CREATE_POPUP);try{await this.waitSDKInitiatedAsync(),await this.i.createShortcutAsync(),e&&t.event(e.SHORTCUT_CREATE,{success:!0})}catch{e&&t.event(e.SHORTCUT_CREATE,{success:!1})}}waitSDKInitiatedAsync(){let{Events:{GAME_SDK_READY:t}}=Ludex;return new Promise(e=>{codex.event.catchUp(t,e)})}async waitLudexReadyAsync(){let t=0;return new Promise(e=>{let a=setInterval(()=>{if("Ludex"in window){clearInterval(a),e();return}t+=10,t>Dm&&(t=0)},10)})}async createLoadingElement(){if(this.Y)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.Y=new t)}setLoadingElementProgress(t){this.Y&&this.Y.setLoadingProgress(t)}displayWarnLoading(t){this.Y&&this.Y.displayWarnLoading(t)}destroyLoadingElement(){this.Y&&this.Y.removeLoadingElement()}checkPopupShown(){this.isPopupShown&&this.exceptionPendingRequest("Please wait for the popup to close")}async delayInitialAsync(){let{Utils:{Time:t},Configs:{Mockup:{GameSDK:{SlowAPI:e}}}}=Ludex;!e.Enabled||e.InitialDelay<=0||await t.sleepAsync(e.InitialDelay)}async delayStartAsync(){let{Configs:{Mockup:{GameSDK:{SlowAPI:t}}},Utils:{Time:e}}=Ludex;!t.Enabled||t.StartDelay<=0||await e.sleepAsync(t.StartDelay)}async delayPlayerDataAsync(){let{Configs:{Mockup:{GameSDK:{SlowAPI:t}}},Utils:{Time:e}}=Ludex;!t.Enabled||t.PlayerDataDelay<=0||await e.sleepAsync(t.PlayerDataDelay)}awaitRandomDelay(t=1e3){let{Utils:{Time:e}}=Ludex;return e.sleepAsync(Math.random()*t)}randomException(t){let e=Math.floor(Math.random()*t.length),a=t[e];this[`exception${a}`]()}getErrorMessage(t){let{Valid:e,Object:a}=Ludex.Utils;return!a.hasOwn(t,"message")||!e.isString(t.message)?null:t.message}x(t,e){throw new bi(t,e)}exceptionUserInput(t){this.x("USER_INPUT",t)}exceptionUnsupported(){this.x("UNSUPPORTED","Unsupported method")}exceptionInvalidParam(t){this.x("INVALID_PARAM",t)}exceptionPendingRequest(t){this.x("PENDING_REQUEST",t)}exceptionMethodNotImplemented(){this.x("METHOD_NOT_IMPLEMENTED","Method not implemented")}exceptionTournamentNotFound(t){this.x("TOURNAMENT_NOT_FOUND",t)}exceptionSameContext(){this.x("SAME_CONTEXT","Must specify a context other than the current one.")}exceptionInvalidOperation(t){this.x("INVALID_OPERATION",t)}exceptionNetworkFailure(t="Request failed to be processed"){this.x("NETWORK_FAILURE",t)}exceptionUnknown(t){this.x("UNKNOWN",t)}exceptionClientUnsupportedOperation(t){this.x("CLIENT_UNSUPPORTED_OPERATION",t)}exceptionRateLimited(t){this.x("RATE_LIMITED",t)}},nr=On}),ar,Im,Lm,Cm,Em,Si,Nn,kn,sr,Rn=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),ar=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],Im=[...ar,"InvalidParam"],Lm=[...ar,"InvalidParam","UserInput"],Cm=[...ar,"NetworkFailure"],Em=[...ar,"InvalidParam","UserInput"],Si="ProductsDataMockKey",Nn="PurchasesDataMockKey",kn=class{i;e;o;lt=null;constructor(t){this.i=t,this.e=t.extra,this.o=t.context}async initPaymentInfoAsync(){let{Configs:{Mockup:{GameSDK:{Payments:{Enabled:t}}}}}=Ludex;t&&await this.La()}async getCatalogAsync(){await this.T(),this.se(Im);let t=this.Pe();return Object.values(t)}async _a(){if(this.lt)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.lt=new t,await this.lt.setupTemplate())}async purchaseAsync(t){return this.e.checkPopupShown(),await this.T(),this.Oa(t),this.se(Lm),await this._a(),await new Promise((e,a)=>{this.lt||this.i.extra.exceptionUnsupported(),this.lt.onYes(this.z(e)),this.lt.onNo(this.q(a)),this.lt.show(t),this.e.isPopupShown=!0}),this.Ca(t)}async getPurchasesAsync(){await this.T(),this.se(Cm);let t=this.i.player.getID();return t?this.Le()[t]||[]:[]}async consumePurchaseAsync(t){await this.T(),this.Na(t),this.se(Em);let e=this.i.player.getID();if(!e)return;let a=(this.Le()[e]||[]).filter(r=>r.purchaseToken!==t);this.vs(e,a)}onReady(t){t()}async T(){let{Configs:{Mockup:{GameSDK:{Payments:{RandomDelayMs:t}}}}}=Ludex;return this.e.awaitRandomDelay(t)}se(t){let{Configs:{Mockup:{GameSDK:{Payments:{ErrorRates:e}}}}}=Ludex;Math.random()*100<e&&this.e.randomException(t)}Oa(t){let{Utils:{Object:e,Valid:a}}=Ludex;a.isObject(t)||this.e.exceptionInvalidParam("Config must be an object"),e.hasOwn(t,"productID")||this.e.exceptionInvalidParam("Config must have productID");let{productID:r}=t;a.isString(r)||this.e.exceptionInvalidParam("productID must be a string"),e.hasOwn(t,"developerPayload")&&!a.isString(t.developerPayload)&&this.e.exceptionInvalidParam("developerPayload must be a string")}Na(t){let{Utils:{Valid:e}}=Ludex;e.isString(t)||this.e.exceptionInvalidParam("Purchase token must be a string")}Ca(t){let{Utils:{String:e}}=Ludex,a={productID:t.productID,paymentID:e.generateObjectId(),purchaseToken:e.generateObjectId(),purchaseTime:new Date().toISOString(),developerPayload:t.developerPayload,signedRequest:e.generateObjectId()},r=this.i.player.getID();if(r){let n=this.Le()[r]||[];n.push(a),this.vs(r,n)}return a}async La(){let{Configs:{Mockup:{GameSDK:{Payments:{Enabled:t,Products:e}}}}}=Ludex;if(!t)return;let a=this.Pe();if(Object.values(a).length>=e.length)return;let r=this.Ta();await Promise.all(r)}Ta(){let{Configs:{Mockup:{GameSDK:{Payments:{Products:t}}}}}=Ludex;return t.map(e=>{let a={productID:e.id,title:`Product ${e.id}`,description:`Description for ${e.id}`,price:e.price.toString(),priceCurrencyCode:"USD",priceAmount:e.price};return this.Ra(e.id,a),a})}Pe(){let{Utils:{Browser:t,Valid:e}}=Ludex,a=t.getLocalStorage(Si);return e.isObject(a)?a:{}}Ra(t,e){let a=this.Pe();a[t]=e,this.Ma(a)}Ma(t){let{Utils:{Browser:e,Valid:a}}=Ludex;a.isObject(t)&&e.writeLocalStorage(Si,t)}Le(){let{Utils:{Browser:t,Valid:e}}=Ludex,a=t.getLocalStorage(Nn);return e.isObject(a)?a:{}}vs(t,e){let{Utils:{Browser:a}}=Ludex;if(!Array.isArray(e))return;let r=a.getLocalStorage(Nn)??{};r[t]=e,a.writeLocalStorage(Nn,r)}z=t=>()=>{this.e.isPopupShown=!1,t(!0)};q=t=>()=>{this.e.isPopupShown=!1;try{this.e.exceptionUserInput("Player closed the context menu")}catch(e){t(e)}}},sr=kn}),Di,Ii,Gn,or,Fn=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Di="Tile Connect Remaster".replace(/ /g,"-"),Ii="https://picsum.photos/seed/%1/300/300",Gn=class{i;e;Is;O;Ss=`${Di}_PlayerInfo`;Ds=`${Di}_PlayerData`;vt=null;ae=null;constructor(t){this.i=t,this.e=t.extra,this.Ga()}Ga(){let t="guest-007";this.Is={playerId:t,playerName:"Guest",playerPhoto:Ii.replace("%1",t)},this.e.isGuest=!0,this.O=T({},this.Is)}initPlayerInfo(t){this.Ua(t);let{Utils:{Browser:e}}=Ludex;e.writeLocalStorage(this.Ss,this.O)}async canSubscribeBotAsync(){return await this.Es(),this.vt||this.e.exceptionUnsupported(),this.vt.canSubscribeBotAsync()}async subscribeBotAsync(){return await this.Es(),this.vt||this.e.exceptionUnsupported(),this.vt.subscribeBotAsync()}getID(){return this.O.playerId}getName(){return this.O.playerName}getPhoto(){return this.O.playerPhoto}async getDataAsync(t){if(t.length<1)return{};await this.e.delayPlayerDataAsync();let{Utils:{Browser:e,Valid:a,Object:r}}=Ludex,n=e.getLocalStorage(this.Ds);if(!a.isObject(n))return{};let y={};for(let g of t)r.hasOwn(n,g)&&(y[g]=n[g]);return y}async setDataAsync(t){await this.e.delayPlayerDataAsync();let{Utils:{Browser:e}}=Ludex;e.writeLocalStorage(this.Ds,t)}async getSignedPlayerInfoAsync(){return{getPlayerID:()=>this.getID()??"",getSignature:this.ka}}async getConnectedPlayersAsync(){return await this.Fa(),this.ae||this.e.exceptionUnsupported(),this.ae.getConnectedPlayersAsync()}Ua(t){let{Utils:{Browser:e,Valid:a,Object:r,String:n}}=Ludex,y=t??"",g="Nameless";if(this.e.isGuest){let w=e.getLocalStorage(this.Ss);a.isObject(w)&&r.hasOwn(w,"playerId")&&a.isString(w.playerId)&&(y=w.playerId),a.isObject(w)&&r.hasOwn(w,"playerName")&&a.isString(w.playerName)&&(g=w.playerName)}a.isEmpty(y)&&(y=n.generateObjectId()),g==="Nameless"&&this.Ba()&&(g=n.generateNameUsingString(y)),this.O.playerId=y,this.O.playerName=g,this.O.playerPhoto=Ii.replace("%1",y),this.ja(y)}Ba(){return P?.UseNameGenerator===!0}Ka(){let{Match:t}=Ludex.Configs.Mockup;return t.Enabled?t.PlayerInfo:null}Ha(){let{Match:t}=Ludex.Configs.Mockup;return t.Enabled?t.OpponentInfo:null}ja(t){let e=this.Ha();t!==e?.Id&&(e=this.Ka()),e&&(this.O.playerId=e.Id,e.Name&&(this.O.playerName=e.Name),e.Photo&&(this.O.playerPhoto=e.Photo))}ka=()=>{let t=this.Va();return Ludex.Utils.Valid.isString(t)?t:"default_token"};Va(){let{Configs:{Mockup:{Match:t}}}=Ludex,e=t.PlayerInfo.Id===this.getID(),a=t.OpponentInfo.Id===this.getID();return e?t.PlayerInfo.Signature:a?t.OpponentInfo.Signature:null}async Es(){if(this.vt)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.vt=new t(this.i))}async Fa(){if(this.ae)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.ae=new t(this.e))}},or=Gn}),Bn,Li,Ci=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Bn=class{ct;_e;Oe;t;Ce;Ne;constructor(t,e,a=!1){let{config:r,data:n}=e;this.ct=t,this._e=r.title,this.Oe=`0123${this.ct}`,this.t=JSON.stringify(n??{}),this.Ce=r.endTime??this.$a(),this.Ne=a?"PAGE_HOSTED":"DEFAULT"}$a(){return Math.round((Date.now()+1e3*60*60*24*7)/1e3)}getID(){return this.ct}getTitle(){return this._e}getPayload(){return this.t}getEndTime(){return this.Ce}getContextID(){return this.Oe}getTournamentType(){return this.Ne}toObject(){return{id:this.ct,title:this._e,payload:this.t,endTime:this.Ce,contextId:this.Oe,tournamentType:this.Ne}}},Li=Bn}),Et,Tm,Mm,Om,_m,Nm,Ei,Vn,Un,ir,Kn=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),rr(),Ci(),Et=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],Tm=[...Et,"InvalidParam","UserInput"],Mm=[...Et,"InvalidOperation","UserInput"],Om=[...Et,"InvalidParam","UserInput"],_m=[...Et,"InvalidParam","UserInput"],Nm=[...Et,"NetworkFailure"],Ei="TournamentsDataMockKey",Vn="TournamentLeadersMockKey",Un=class{i;e;o;ht=null;v=null;constructor(t){this.i=t,this.e=t.extra,this.o=t.context}async initTournamentInfoAsync(t){let{Configs:{Mockup:{GameSDK:{Tournament:{Enabled:e}}}}}=Ludex;e&&(await this.createMockTournamentsData(),t&&await this.Wa(t))}Wa=async t=>{this.xs(t)&&await this.joinAsync(t)};async createMockTournamentsData(){let{Utils:{Object:t},Configs:{Mockup:{GameSDK:{Tournament:{Enabled:e,NumOfTournament:a}}}}}=Ludex,{Normal:r,HostPage:n}=a;if(!e)return;let y=this._t(),g=t.vals(y),w=this.za(g),v=w.filter(C=>C.tournamentType==="DEFAULT"),S=w.filter(C=>C.tournamentType==="PAGE_HOSTED"),{length:D}=v,{length:x}=S,b=r-D,_=n-x,M=this.qa(b),B=this.Ya(_);await Promise.all([...M,...B])}za(t){let e=Date.now()/1e3,a=t.filter(n=>n.endTime>e),r={};for(let n of a)r[n.id]=n;return this.bs(r),a}qa(t){let{Utils:{String:e,Array:a,Number:r},Configs:{Mockup:{GameSDK:{Tournament:{ExtraPlayerTournamentPayload:n}}}}}=Ludex,{leaderboard:y}=codex,g=GameSDK.player.getID(),w=GameSDK.player.getName();return a.length(t).map(async()=>{let v=`${w}'s Tournament ${e.generateObjectId()}`,S=await y.createLeaderboardAsync({name:v}),D=this.Te({initialScore:0,config:{title:v,tournamentTitle:v},data:T({playerId:g,playerName:w,leaderboardId:S},n)}).getID().toString();if(this.re(D))return;let x=r.random(2),b=codex.player.getConnectedPlayerIds(x,0).map(_=>({playerId:_,score:r.random(4)}));b.sort((_,M)=>_.score-M.score),this.Re(D,b)})}Ya(t){let{Utils:{String:e,Array:a,Number:r},Configs:{Mockup:{GameSDK:{Tournament:{ExtraGlobalTournamentPayload:n}}}}}=Ludex,{leaderboard:y}=codex;return a.length(t).map(async()=>{let g=e.generateObjectId(),w=T({leaderboardId:g,playerId:"global"},n),v=`Global Tournament ${g}`;await y.createLeaderboardAsync({name:v,_id:g,type:"world_tournament_leaderboard",description:JSON.stringify(w)});let S=this.Te({initialScore:0,config:{title:v,tournamentTitle:v},data:w},!0).getID().toString();if(this.re(S))return;let D=r.random(2),x=a.length(D).map(()=>({playerId:e.generateObjectId(),score:r.random(4)}));x.sort((b,_)=>b.score-_.score),this.Re(S,x)})}async T(){let{Configs:{Mockup:{GameSDK:{Tournament:{RandomDelayMs:t}}}}}=Ludex;return this.e.awaitRandomDelay(t)}randomError(t){let{Configs:{Mockup:{GameSDK:{Tournament:{ErrorRates:e}}}}}=Ludex;Math.random()*100<e&&this.e.randomException(t)}async Qa(){if(this.v)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.v=new t,await this.v.setupTemplate())}async Ja(){if(this.ht)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.ht=new t,await this.ht.setupTemplate())}async createAsync(t){this.e.checkPopupShown(),await this.T(),this.o.getID()!==null&&this.e.exceptionInvalidOperation("Cannot create tournament while in a context"),this.Xa(t),this.randomError(Tm),await this.Qa(),await new Promise((r,n)=>{this.v||this.i.extra.exceptionUnsupported(),this.v.onYes(this.z(r)),this.v.onNo(this.q(n)),this.v.show(t),this.e.isPopupShown=!0});let e=this.Te(t),a=e.getContextID();return this.Za(a),e}Te(t,e=!1){let{Utils:{String:a}}=Ludex,r=a.generateObjectId(),n=new Li(r,t,e),y=n.toObject();return this.tr(r,y),n}async postScoreAsync(t){await this.T(),this.Ps(),t<0&&this.e.exceptionInvalidParam("Score must be a positive number"),this.randomError(_m);let e=codex.player.getPlayerId();this.Ls(e,t)}async shareAsync(t){this.e.checkPopupShown(),await this.T(),this.Ps(),this.er(t),this.randomError(Om),await this.Ja();let{score:e}=t,a=e,r=this.Me();if(r){let y=codex.player.getPlayerId(),g=r.getID().toString(),w=this.sr(g,y);w&&w<e&&(a=w)}await new Promise((y,g)=>{this.ht||this.i.extra.exceptionUnsupported(),this.ht.onYes(this.z(y)),this.ht.onNo(this.q(g)),this.ht.show(a),this.e.isPopupShown=!0});let n=codex.player.getPlayerId();this.Ls(n,e)}async getTournamentsAsync(){await this.T(),this.randomError(Nm);let t=this._t(),{Utils:{Object:e}}=Ludex;return e.vals(t).map(a=>this.Ge(a.id)).filter(a=>a!==null)}async joinAsync(t){await this.T();let{Utils:{Valid:e}}=Ludex;e.isString(t)||this.e.exceptionInvalidParam("Tournament ID must be a string");let a=this.Ge(t);a||this.e.exceptionTournamentNotFound("Tournament could not be found."),this.randomError(Mm);let r=a.getContextID();await GameSDK.context.switchAsync(r)}Za(t){this.o instanceof at&&this.o.setCurrentContextId(t)}z=t=>()=>{this.e.isPopupShown=!1,t(!0)};q=t=>()=>{this.e.isPopupShown=!1;try{this.e.exceptionUserInput("Player closed the context menu")}catch(e){t(e)}};Me(){let t=this.o.getID();if(!t)return null;let e=this._t();for(let a in e)if(Object.hasOwn(e,a)&&e[a].contextId===t)return this.Ge(a);return null}Xa(t){let{Utils:{Object:e,Valid:a}}=Ludex;a.isObject(t)||this.e.exceptionInvalidParam("Payload must be an object"),e.hasOwn(t,"initialScore")||this.e.exceptionInvalidParam("Payload must have initialScore"),e.hasOwn(t,"config")||this.e.exceptionInvalidParam("Payload must have config");let{initialScore:r,config:n}=t;a.isNumber(r)||this.e.exceptionInvalidParam("initialScore must be a number"),a.isObject(n)||this.e.exceptionInvalidParam("Config must be an object"),e.hasOwn(n,"title")||this.e.exceptionInvalidParam("Config must have title"),e.hasOwn(n,"tournamentTitle")||this.e.exceptionInvalidParam("Config must have tournamentTitle"),e.hasOwn(t,"data")&&!a.isObject(t.data)&&this.e.exceptionInvalidParam("Data must be an object")}er(t){let{Utils:{Object:e,Valid:a}}=Ludex;a.isObject(t)||this.e.exceptionInvalidParam("Payload must be an object"),e.hasOwn(t,"score")||this.e.exceptionInvalidParam("Payload must have score");let{score:r}=t;a.isNumber(r)||this.e.exceptionInvalidParam("Score must be a number"),e.hasOwn(t,"data")&&!a.isObject(t.data)&&this.e.exceptionInvalidParam("Data must be an object")}Ps(){this.Me()||this.e.exceptionTournamentNotFound("There is no tournament for this context.")}Ge(t){let e=this.xs(t);return e?{getID:()=>e.id,getTitle:()=>e.title,getPayload:()=>e.payload,getEndTime:()=>e.endTime,getContextID:()=>e.contextId,getTournamentType:()=>e.tournamentType}:null}xs(t){let e=this._t();return e[t]?e[t]:null}tr(t,e){let a=this._t();a[t]=e,this.bs(a)}_t(){let{Utils:{Browser:t,Valid:e}}=Ludex,a=t.getLocalStorage(Ei);return e.isObject(a)?a:{}}bs(t){let{Utils:{Browser:e,Valid:a}}=Ludex;a.isObject(t)&&e.writeLocalStorage(Ei,t)}sr(t,e){let a=this._s(t,e);return a?a.score??null:null}Ls(t,e){let a=this.Me();if(!a)return;let r=a.getID().toString();if(!r)return;let n=this._s(r,t);if(!n){this.Os(r,{playerId:t,score:e});return}n.score<e&&(n.score=e,this.Os(r,n))}_s(t,e){let a=this.re(t);if(!a.length)return null;let{Utils:{Array:r}}=Ludex;return r.search(a,n=>n.playerId===e)??null}re(t){let{Utils:{Browser:e,Object:a}}=Ludex,r=e.getLocalStorage(Vn);if(!a.hasOwn(r,t))return[];let n=r[t];return Array.isArray(n)?(n.sort((y,g)=>g.score-y.score),n):[]}Os(t,e){let{Utils:{Array:a}}=Ludex,r=this.re(t),n=a.searchIndex(r,y=>y.playerId===e.playerId);n===-1?r.push(e):r[n]=e,this.Re(t,r)}Re(t,e){let{Utils:{Browser:a,Object:r}}=Ludex;if(!Array.isArray(e))return;let n=a.getLocalStorage(Vn)??{};r.assign(n,{[t]:e}),a.writeLocalStorage(Vn,n)}},ir=Un}),Hn,cr,jn=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),rr(),_n(),Rn(),Fn(),Kn(),Hn=class{extra;player;context;tournament;payments;It=null;isInitialized=!1;St={};Ue=null;ke=null;Fe=null;Be(){this.extra=new nr(this),this.player=new or(this),this.context=new at(this),this.tournament=new ir(this),this.payments=new sr(this)}Cs(){return P?.AllowWithoutSDK!==!0}getLocale(){return Ludex.Utils.Browser.getLocale()}getPlatform(){let{Device:t}=Ludex.Utils;return t.isAndroid()?"ANDROID":t.isIOS()?"IOS":t.isDesktop()?"WEB":t.isMobile()?"MOBILE_WEB":null}isGameSDK(t){return this.getSDKName()===t}getSDKName(){return"Ludex"}getSDKVersion(){return"1.0.0"}async initializeAsync(){if(this.isInitialized)return;this.Be(),await this.extra.createLoadingElement(),this.Cs()&&await this.Ns(),await this.extra.waitLudexReadyAsync(),await this.extra.delayInitialAsync();let t=Ludex.Utils.Browser.getQueryParams();if(t.splashPreview){this.extra.destroyLoadingElement();return}let e=t.playerId;this.player.initPlayerInfo(e);let a=t.context_source_id,r=t.context_type;this.context.initContextInfo(a,r),this.isInitialized=!0}async Ns(){this.extra.exceptionInvalidOperation("GameSDK requires AllowWithoutSDK=true in game config")}async startGameAsync(t=!0){this.isInitialized||this.extra.exceptionInvalidOperation("GameSDK is not initialized"),await this.extra.delayStartAsync();let e=90;window.__sdkLoadingCount=e,this.setLoadingProgress(e),this.extra.destroyLoadingElement();let{Events:a,Utils:{Browser:{getQueryParams:r}}}=Ludex,n=r().tournament_id;await this.tournament.initTournamentInfoAsync(n),await this.payments.initPaymentInfoAsync(),t&&codex.event.emit(a.GAME_SDK_STARTED)}setLoadingProgress(t){this.extra?.setLoadingElementProgress?.(t)}getEntryPointData(){let{Utils:{Browser:t,Json:e}}=Ludex,{payload:a="{}"}=t.getQueryParams();return typeof a!="string"?{}:e.decode(a)}async getEntryPointAsync(){return"no_entry"}async loadBannerAdAsync(t){if(t){if(!this.St[t]){let e=(await Promise.resolve().then(()=>(O(),Q))).default;typeof e!="function"&&this.extra.exceptionInvalidOperation("Banner ads mock is not enabled"),this.St[t]=new e("banner",t)}await this.St[t].loadAsync(),await this.St[t].showAsync()}}async hideBannerAdAsync(t){this.St[t]&&await this.St[t].hideAsync()}getBannerHeight(t){return t.BannerHeight}async getInterstitialAdAsync(t){if(!this.ke){let e=(await Promise.resolve().then(()=>(O(),Q))).default;typeof e!="function"&&this.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled"),this.ke=new e("interstitial",t)}return this.ke}async getRewardedVideoAsync(t){if(!this.Ue){let e=(await Promise.resolve().then(()=>(O(),Q))).default;typeof e!="function"&&this.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled"),this.Ue=new e("rewarded",t)}return this.Ue}async getRewardedInterstitialAsync(t){if(!this.Fe){let e=(await Promise.resolve().then(()=>(O(),Q))).default;typeof e!="function"&&this.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled"),this.Fe=new e("rewarded_interstitial",t)}return this.Fe}async getTournamentAsync(){this.tournament.randomError(["Unsupported","NetworkFailure"]);let t=this.context.getID(),{Array:e,Valid:a}=Ludex.Utils;a.isString(t)||this.extra.exceptionInvalidOperation("Not in a context");let r=await this.tournament.getTournamentsAsync(),n=e.search(r,y=>y.getContextID()===t);return n||this.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),n}getSupportedAPIs(){let{Player:{SubscribeBot:{CanSubscribeBot:t}},AddShortcut:{CanCreateShortcut:e}}=Ludex.Configs.Mockup.GameSDK,a=[];return t&&a.push("player.canSubscribeBotAsync"),e&&a.push("canCreateShortcutAsync"),a}async canCreateShortcutAsync(){return await this.Ts(),this.It||this.extra.exceptionUnsupported(),this.It.canCreateShortcutAsync()}async createShortcutAsync(){return await this.Ts(),this.It||this.extra.exceptionUnsupported(),this.It.createShortcutAsync()}async Ts(){if(this.It)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;typeof t=="function"&&(this.It=new t(this))}},cr=Hn}),Wn,Ti,Mi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Wn=class{ar;Rs;constructor(t,e){this.ar=t,this.Rs=e}getPlacementID(){return this.Rs}async hideAsync(){}},Ti=Wn}),_e,km,Rm,zn,lr,Oi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Mi(),_e={CREATED:"CREATED",LOADED:"LOADED",WAITING_FOR_NO_FILL:"WAITING_FOR_NO_FILL",DISABLED:"DISABLED",SHOWN:"SHOWN"},km=3e4,Rm=3,zn=class extends Ti{y=null;Ms=0;Gs=0;S=_e.CREATED;ko="facebook";constructor(t,e){super(t,e.getPlacementID()),this.y=e,this.S=_e.CREATED}async loadAsync(){let{Utils:{Object:t},Plugins:{Ads:{AdError:e}}}=Ludex;if(this.y===null)throw new e("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");try{await this.y.loadAsync(),this.S=_e.LOADED}catch(a){throw a instanceof Object&&t.hasOwn(a,"code")&&a.code==="ADS_NO_FILL"&&(this.Gs=Date.now(),this.Ms++,this.Ms>=Rm?this.S=_e.DISABLED:this.S=_e.WAITING_FOR_NO_FILL),a}}async showAsync(){if(this.y===null){let{AdError:t}=Ludex.Plugins.Ads;throw new t("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.")}await this.y.showAsync(),this.S=_e.SHOWN}isLoaded(){return this.S===_e.LOADED}isDisabled(){return this.S===_e.DISABLED}rr(){return this.S===_e.WAITING_FOR_NO_FILL}canLoad(){return this.rr()?Date.now()-this.Gs>=km:this.isLoaded()}},lr=zn}),qn,_i,Ni=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),rr(),qn=class extends at{a;constructor(t){super(t),this.a=t.sdk.context}D(){return Ludex.Configs.Mockup.GameSDK.Context.Enabled}E(){return this.D()?!0:!this.i.isInitialized}getID(){return this.E()?super.getID():this.a.getID()}getType(){return this.E()?super.getType():"getType"in this.a?this.a.getType():super.getType()}isSizeBetween(t,e){return"isSizeBetween"in this.a?this.a.isSizeBetween(t,e):null}async switchAsync(t,e=!1){return this.E()?super.switchAsync(t,e):this.a.switchAsync(t,e)}async chooseAsync(t){return this.E()?super.chooseAsync(t):this.a.chooseAsync(t)}async createAsync(t){if(this.E())return super.createAsync(t);if("createAsync"in this.a)return this.a.createAsync(t)}async getPlayersAsync(){return this.E()?super.getPlayersAsync():"getPlayersAsync"in this.a?this.a.getPlayersAsync():[]}},_i=qn}),Qn,Gm,ki,Ri=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Qn=!1,Gm=async()=>{if(!Qn)try{let{analytics:t}=codex,{Plugins:{Analytics:{Events:e}={}}}=Ludex;if(await GameSDK.extra.waitSDKInitiatedAsync(),!(GameSDK.getSupportedAPIs().indexOf("canCreateShortcutAsync")>-1))return;let a=(await GameSDK.player.getDataAsync(["lastCallCreateShortcut"])||{}).lastCallCreateShortcut||0;if(a&&Ludex.Utils.Time.isToday(+a)){Qn=!0;return}let r=Date.now();if(GameSDK.player.setDataAsync({lastCallCreateShortcut:r}),await GameSDK.canCreateShortcutAsync()){Qn=!0,e&&t.event(e.SHORTCUT_CREATE_POPUP);try{await GameSDK.createShortcutAsync(),e&&t.event(e.SHORTCUT_CREATE,{success:!0})}catch{e&&t.event(e.SHORTCUT_CREATE,{success:!1})}}}catch{}},ki=Gm}),Yn,dr,Jn=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Yn=class extends Error{payload;constructor(t,e){super(t),this.name="WideFrameRenderFail",this.message=t??"Wide frame render fail",this.payload=e}},dr=Yn}),Gi,Fi,Bi,Vi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Jn(),Gi=async t=>{if(typeof t!="string"||!t)throw new dr(void 0,{imageShare:t})},Fi=async()=>{let{match:t,player:e,analytics:a,frameCapture:r}=codex;if(!r||!t)return;let{Plugins:{Analytics:{Events:n}={}}}=Ludex;try{let{playerId:y,name:g,photo:w}=e.getPlayer(),{profiles:v}=t.getMatchState(),{score:S=0}=v[y]||{},D=await r.renderAsync("share-score",{playerId:y,playerPhoto:w,playerScore:S});await Gi(D),await FBInstant.inviteAsync({text:{default:"Easy! I have a new score!",localizations:{vi_VN:"A ha! M\xECnh v\u1EEBa \u0111\u1EA1t m\u1ED9t \u0111i\u1EC3m m\u1EDBi!"}},image:D??"",data:{playerId:y,playerName:g,playerPhoto:w,type:"share_invite"}}),n&&a.event(n.INVITE,{invite_content_type:"CurrentScore",success:!0})}catch{n&&a.event(n.INVITE,{invite_content_type:"CurrentScore",success:!1})}},Bi=async()=>{let{player:t,analytics:e,frameCapture:a}=codex;if(!a)return;let{Plugins:{Analytics:{Events:r}={}}}=Ludex;try{let{playerId:n,name:y,photo:g,data:w}=t.getPlayer(),{score:v}=w||{},S=await a.renderAsync("share-score",{playerId:n,playerPhoto:g,playerScore:v});await Gi(S),await FBInstant.inviteAsync({text:{default:"Great! I have a best score!",localizations:{vi_VN:"Th\u1EADt tuy\u1EC7t! M\xECnh v\u1EEBa ph\xE1 k\u1EF7 l\u1EE5c n\xE0y!"}},image:S??"",data:{playerId:n,playerName:y,playerPhoto:g,type:"share_invite"}}),r&&e.event(r.INVITE,{invite_content_type:"BestScore",success:!0})}catch{r&&e.event(r.INVITE,{invite_content_type:"BestScore",success:!1})}}}),Xn,Ui,Ki,Fm,Bm,Vm,Hi,Um,ji=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Jn(),Xn=async t=>{if(typeof t!="string"||!t)throw new dr(void 0,{imageShare:t})},Ui=async()=>{let{Plugins:{Analytics:{Events:t}={}}}=Ludex,{player:e,analytics:a,frameCapture:r}=codex;try{let{playerId:n,name:y,photo:g,data:w}=e.getPlayer(),{score:v}=w||{},S=await r.renderAsync("share-score",{playerId:n,playerPhoto:g,playerScore:v});await Xn(S),await FBInstant.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:S??"",data:{playerId:n,playerName:y,playerPhoto:g,type:"share_invite"}}),t&&a.event(t.SHARE,{share_content_type:"BestScore",success:!0})}catch{t&&a.event(t.SHARE,{share_content_type:"BestScore",success:!1})}},Ki=async()=>{let{player:t,analytics:e}=codex,{Plugins:{Analytics:{Events:a}={}}}=Ludex;try{let r=await Bm();Xn(r);let{playerId:n,name:y,photo:g}=t.getPlayer();await FBInstant.shareAsync({text:"A ha, I'm the best!",intent:"CHALLENGE",image:r??"",data:{playerId:n,playerName:y,playerPhoto:g,type:"share_invite"}}),a&&e.event(a.SHARE,{share_content_type:"Leaderboard",success:!0})}catch{a&&e.event(a.SHARE,{share_content_type:"Leaderboard",success:!1})}},Fm={id:"10",name:"",photo:"./assets/images/others/avatar.png",score:0},Bm=async()=>{let{Utils:{Object:t}}=Ludex,{player:e,frameCapture:a,leaderboard:r}=codex,{playerId:n,photo:y}=e.getPlayer(),g=e.getConnectedPlayerIds(10,0);g.push(n);let w="friends";r.isLeaderboardEmpty(w)&&await r.requestLeaderboardAsync(w,g.length);let v=r.getLeaderboard(w);if(!v)return null;let{leaders:S}=v,D=T({},Fm);t.hasOwn(S,n)&&(D.id=n,D.score=S[n].score);let x=[];if(x.push(D),Vm(S,x,D),x.length<3){let _=0;for(;_<=3-x.length;)x.push({id:`bot${_}`,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),_++}let b={playerId:n,playerPhoto:y,leaders:x};return a.renderAsync("share-leaderboard",b)},Vm=(t,e,a)=>{let{Utils:{Object:r}}=Ludex;for(let n in t)if(r.hasOwn(t,n)){let y=t[n];if(e.length===3)break;if(y.playerId===a.id||Number(y.score)>Number(a.score))continue;e.push({id:y.playerId,name:y.name,photo:y.photo,score:y.score})}},Hi=async()=>{let{Plugins:{Analytics:{Events:t}={}}}=Ludex,{player:e,analytics:a}=codex;try{let r=await Um();Xn(r);let{playerId:n,name:y,photo:g}=e.getPlayer();await FBInstant.shareAsync({text:"Phew, a great match!",intent:"SHARE",image:r??"",data:{playerId:n,playerName:y,playerPhoto:g,type:"share_invite"}}),t&&a.event(t.SHARE,{share_content_type:"MatchResult",success:!0})}catch{t&&a.event(t.SHARE,{share_content_type:"MatchResult",success:!1})}},Um=async()=>{let{match:t,frameCapture:e}=codex,a=t.getMatchState(),{profiles:r,customData:n}=a,{playerId:y,opponentId:g}=n;if(!y||!g)return null;let w=r[y],v=r[g];if(!w||!v)return null;let{photo:S,score:D=0,finished:x=!1}=w,{photo:b,score:_=0,finished:M=!1}=v,B={playerId:y,playerPhoto:S,playerScore:D,opponentId:g,opponentPhoto:b,opponentScore:_,isPlayerFinished:x,isOpponentFinished:M};return e.renderAsync("result-challenge",B)}}),Wi,Km,zi,qi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Wi=!1,Km=async()=>{if(Wi)return!1;try{let{Utils:{Time:t},Plugins:{Analytics:{Events:e}={}}}=Ludex,{analytics:a}=codex;if(await GameSDK.extra.waitSDKInitiatedAsync(),!(GameSDK.getSupportedAPIs().indexOf("player.canSubscribeBotAsync")>-1))return!1;if(await GameSDK.player.canSubscribeBotAsync()){let r=(await GameSDK.player.getDataAsync(["lastCallSubscribeBot"])||{}).lastCallSubscribeBot||0;if(Wi=!0,r&&t.isToday(+r))return!1;let n=Date.now();GameSDK.player.setDataAsync({lastCallSubscribeBot:n}),e&&a.event(e.BOT_SUBSCRIBE_POPUP);try{return await GameSDK.player.subscribeBotAsync(),e&&a.event(e.BOT_SUBSCRIBE,{success:!0}),!0}catch{return e&&a.event(e.BOT_SUBSCRIBE,{success:!1}),!1}}return!1}catch{return!1}},zi=Km}),Zn,Qi,Yi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),_n(),Ri(),Vi(),ji(),qi(),Zn=class extends nr{a;constructor(t){super(t),this.a=t.sdk,this.i=t}isNEZP(){return!0}isRestricted(){return!1}quit(){this.a.quit()}logEvent(t,e,a){return!this.i.isInitialized||!("logEvent"in this.a)?null:this.a.logEvent(t,e,a)}onPause(t){FBInstant.onPause(t)}onResume(t){FBInstant.onResume(t)}async checkAndSubscribeBotAsync(){return Ludex.Configs.Mockup.GameSDK.Player.SubscribeBot.Enabled?super.checkAndSubscribeBotAsync():zi()}async shareAsync(t){return FBInstant.shareAsync(t)}async updateAsync(t){let e=!1;try{await this.a.updateAsync(t),e=!0}finally{this.nr(t,e)}}nr(t,e){if(!codex?.analytics)return;let a="";"data"in t&&(a=t.data.type);let{Events:r}=Ludex.Plugins.Analytics??{};r&&codex.analytics.event(r.MESSAGE,{success:e,message_content_type:a||"Unknown"})}async switchGameAsync(t,e){return this.a.switchGameAsync(t,e)}setSessionData(t){this.a.setSessionData(t)}async getLeaderboardAsync(t){return this.a.getLeaderboardAsync(t)}async postSessionScoreAsync(t){return this.a.postSessionScoreAsync(t)}async checkCanPlayerMatchAsync(){return this.a.checkCanPlayerMatchAsync()}async matchPlayerAsync(t,e,a){return this.a.matchPlayerAsync(t,e,a)}async canFollowOfficialPageAsync(){return FBInstant.community.canFollowOfficialPageAsync()}async followOfficialPageAsync(){return FBInstant.community.followOfficialPageAsync()}async canJoinOfficialGroupAsync(){return FBInstant.community.canJoinOfficialGroupAsync()}async joinOfficialGroupAsync(){return FBInstant.community.joinOfficialGroupAsync()}async performHapticFeedbackAsync(){return FBInstant.performHapticFeedbackAsync()}async inviteAsync(t){return this.a.inviteAsync(t)}async shareLinkAsync(t){return this.a.shareLinkAsync(t)}async inviteWithBestScoreAsync(){return Bi()}async inviteWithCurrentScoreAsync(){return Fi()}async shareBestScoreAsync(){return Ui()}async shareLeaderboardsAsync(){return Ki()}async shareGameResultAsync(){return Hi()}createLoadingElement(){return Promise.resolve()}async checkAndCreateShortcutAsync(){return ki()}canLoadAd(t){return t.canLoad()}async autoOverlayView(t,e,a){if(!("overlayViews"in this.i.sdk))return null;let{overlayViews:r}=this.i.sdk;return this.ir(a),new Promise((n,y)=>{r.createOverlayViewWithXMLString(t,void 0,e,g=>{n(g)},(g,w)=>{y(w)})})}ir(t){let e=document.createElement("style");for(let[a,r]of Object.entries(t))e.textContent+=`${a} { ${Object.entries(r).map(([n,y])=>`${n}: ${y}`).join(";")} }`;document.head.appendChild(e)}},Qi=Zn}),ea,Ji,Xi=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),ea=class{a;i;constructor(t){this.i=t,this.a=this.i.sdk.graphApi}async requestAsync(t,e,a){return this.a.requestAsync(t,e,a)}async initPlatformAsync(){return this.a.initPlatformAsync()}async getPlayerASIDAsync(){return this.a.getPlayerASIDAsync()}},Ji=ea}),ta,Zi,ec=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),ta=class{a;i;constructor(t){this.i=t,this.a=this.i.sdk.overlayViews}createOverlayView(t,e,a,r,n){return this.a.createOverlayView(t,e,a,r,n)}createOverlayViewWithXMLString(t,e,a,r,n){return this.a.createOverlayViewWithXMLString(t,e,a,r,n)}setCustomEventHandler(t){this.a.setCustomEventHandler(t)}},Zi=ta}),ra,tc,rc=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Rn(),ra=class extends sr{a;constructor(t){super(t),this.a=t.sdk.payments}D(){let{Mockup:t}=Ludex.Configs;return t.GameSDK.Payments.Enabled}async getCatalogAsync(){return this.D()?super.getCatalogAsync():FBInstant.payments.getCatalogAsync()}async purchaseAsync(t){return this.D()?super.purchaseAsync(t):FBInstant.payments.purchaseAsync(t)}async getPurchasesAsync(){return this.D()?super.getPurchasesAsync():FBInstant.payments.getPurchasesAsync()}async consumePurchaseAsync(t){return this.D()?super.consumePurchaseAsync(t):FBInstant.payments.consumePurchaseAsync(t)}onReady(t){this.D()?super.onReady(t):this.a.onReady(t)}},tc=ra}),na,nc,ac=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Fn(),na=class extends or{a;e;constructor(t){super(t),this.a=t.sdk.player,this.e=t.extra}E(){return!this.i.isInitialized}getID(){let t=this.a.getID();return!t||this.E()?super.getID():t}getName(){let t=null;return"getName"in this.a&&(t=this.a.getName()),!t||this.E()?super.getName():t}getPhoto(){let t=null;return"getPhoto"in this.a&&(t=this.a.getPhoto()),!t||this.E()?super.getPhoto():t}async getDataAsync(t){return this.E()?super.getDataAsync(t):this.a.getDataAsync(t)}async setDataAsync(t){return this.E()?super.setDataAsync(t):this.a.setDataAsync(t)}async flushDataAsync(){return this.a.flushDataAsync()}async getASIDAsync(){return"getASIDAsync"in this.a?this.a.getASIDAsync():null}async getSignedASIDAsync(){return"getSignedASIDAsync"in this.a?this.a.getSignedASIDAsync():null}async getSignedPlayerInfoAsync(t){return this.E()?super.getSignedPlayerInfoAsync():(this.e.isRestricted()&&this.e.exceptionUnsupported(),this.a.getSignedPlayerInfoAsync(t))}async canSubscribeBotAsync(){return Ludex.Configs.Mockup.GameSDK.Player.SubscribeBot.Enabled?super.canSubscribeBotAsync():this.i.getSDKVersion()==="8.0"?!0:this.a.canSubscribeBotAsync()}async subscribeBotAsync(){return Ludex.Configs.Mockup.GameSDK.Player.SubscribeBot.Enabled?super.subscribeBotAsync():this.a.subscribeBotAsync()}async getConnectedPlayersAsync(){return Ludex.Configs.Mockup.GameSDK.Player.ConnectedPlayers.Enabled?super.getConnectedPlayersAsync():"getConnectedPlayersAsync"in this.a?(await this.a.getConnectedPlayersAsync()).map(t=>({getID:()=>t.getID(),getName:()=>"getName"in t?t.getName():null,getPhoto:()=>"getPhoto"in t?t.getPhoto():null})):[]}},nc=na}),aa,sc,oc=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Kn(),aa=class extends ir{a;e;constructor(t){super(t),this.a=t.sdk.tournament,this.e=t.extra}D(){let{Mockup:t}=Ludex.Configs;return t.GameSDK.Tournament.Enabled}async createAsync(t){return this.D()?super.createAsync(t):this.a.createAsync(t)}async shareAsync(t){return this.D()?super.shareAsync(t):this.a.shareAsync(t)}async joinAsync(t){return this.D()?super.joinAsync(t):this.a.joinAsync(t)}async postScoreAsync(t){return this.D()?super.postScoreAsync(t):this.a.postScoreAsync(t)}async getTournamentsAsync(){return this.D()?super.getTournamentsAsync():(this.e.isRestricted()&&this.e.exceptionUnsupported(),this.a.getTournamentsAsync())}},sc=aa}),sa,ic,cc=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),jn(),Oi(),Ni(),Yi(),Xi(),ec(),rc(),ac(),oc(),sa=class extends cr{sdk;graphApi;overlayViews;Ot=[];constructor(t){super(),this.sdk=t}Be(){super.Be(),this.extra=new Qi(this),this.player=new nc(this),this.context=new _i(this),this.graphApi=new Ji(this),this.payments=new tc(this),this.tournament=new sc(this),this.overlayViews=new Zi(this)}getLocale(){return this.isInitialized?this.sdk.getLocale():super.getLocale()}getPlatform(){return this.isInitialized?this.sdk.getPlatform():super.getPlatform()}getSDKName(){return"FacebookInstant"}getSDKVersion(){return this.sdk.getSDKVersion()}async Ns(){this.sdk||this.extra.exceptionInvalidOperation("Facebook Instant Games SDK is not initialized")}async initializeAsync(){if(!this.isInitialized){await super.initializeAsync(),this.isInitialized=!1;try{let{Utils:{Function:t}}=Ludex,[e,a]=await t.handleAsync(this.sdk.initializeAsync(),15e3);if(a)throw a;this.isInitialized=!0,this.setLoadingProgress(1)}catch(t){let e=this.extra.getErrorMessage(t);if(e&&e.indexOf("already")>-1){this.isInitialized=!0;return}if(this.Cs())throw new Error("Can't initialize Facebook Instant SDK")}finally{this.extra.isGuest=!this.player.getID()}}}setLoadingProgress(t){this.isInitialized?this.sdk.setLoadingProgress(t):super.setLoadingProgress(t)}async startGameAsync(){await super.startGameAsync(!1),this.isInitialized&&(await this.sdk.startGameAsync(),this.setLoadingProgress(100),codex.event.emit(Ludex.Events.GAME_SDK_STARTED))}getSupportedAPIs(){return this.Ot.length<1&&(this.Ot=this.sdk.getSupportedAPIs(),this.getSDKVersion()==="8.0"&&(this.Ot.push("player.canSubscribeBotAsync"),this.Ot.push("canCreateShortcutAsync"))),this.Ot}getEntryPointData(){return this.sdk.getEntryPointData()||{}}async getEntryPointAsync(){return this.extra.isRestricted()?"no_entry":this.sdk.getEntryPointAsync()}async canCreateShortcutAsync(){let{AddShortcut:t}=Ludex.Configs.Mockup.GameSDK;return t.Enabled?super.canCreateShortcutAsync():this.getSDKVersion()==="8.0"?!0:this.sdk.canCreateShortcutAsync()}async createShortcutAsync(){let{AddShortcut:t}=Ludex.Configs.Mockup.GameSDK;return t.Enabled?super.createShortcutAsync():this.sdk.createShortcutAsync()}async getInterstitialAdAsync(t){let{Ads:e}=Ludex.Configs.Mockup;if(e.Enabled)return super.getInterstitialAdAsync(t);let a=await this.sdk.getInterstitialAdAsync(t);return new lr("interstitial",a)}async getRewardedVideoAsync(t){let{Ads:e}=Ludex.Configs.Mockup;if(e.Enabled)return super.getRewardedVideoAsync(t);let a=await this.sdk.getRewardedVideoAsync(t);return new lr("rewarded",a)}async getRewardedInterstitialAsync(t){let{Ads:e}=Ludex.Configs.Mockup;if(e.Enabled)return super.getRewardedInterstitialAsync(t);let a=await this.sdk.getRewardedInterstitialAsync(t);return new lr("rewarded_interstitial",a)}async loadBannerAdAsync(t){let{Ads:e}=Ludex.Configs.Mockup;return e.Enabled?super.loadBannerAdAsync(t):this.sdk.loadBannerAdAsync(t)}async hideBannerAdAsync(){let{Ads:{BannerDisplayAdOptions:t},Mockup:{Ads:e}}=Ludex.Configs;if(e.Enabled){for(let{PlacementId:a}of t)await super.hideBannerAdAsync(a);return}return this.sdk.hideBannerAdAsync()}getBannerHeight(t){let{Device:e}=Ludex.Utils;return e.isDesktop()?70:50}async getTournamentAsync(){let{Tournament:t}=Ludex.Configs.Mockup.GameSDK;return t.Enabled?super.getTournamentAsync():(this.extra.isRestricted()&&this.extra.exceptionInvalidOperation("Tournament is not supported in restricted mode"),this.sdk.getTournamentAsync())}},ic=sa}),oa,Hm,jm,st,ur=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),oa=class{je;constructor(){this.je=Object.create(null)}or(){let t=new Error;if(!t.stack)return null;let e=t.stack.split(`
`)[4];return e?e.trim():null}blockAccess(){try{let t=this.or();if(!t||this.je[t])return!1;if(["eval","at <","(<"].some(e=>t.includes(e)))throw new Error(`Access blocked for the caller: ${t}`);return this.je[t]=!0,!1}catch{return!0}}},Hm=new oa,jm=(t,e)=>{let a=Object.getOwnPropertyDescriptor(t,e);if(!a)return;let{value:r,get:n,initializer:y}=a;r&&typeof r!="object"||n&&typeof n!="function"||y&&typeof y!="function"||Object.defineProperty(t,e,{enumerable:!1,get(){if(!Hm.blockAccess())return r??y?.call(this)??n?.call(this)},set(){}})},st=jm});function Wm(){let t,e=window,a="GameSDK";return"FBInstant"in e?(a="FBInstant",t=new ic(e.FBInstant)):"YaGames"in e?(a="Yandex",t=new E(window.YaGames)):"funmax"in e?(a="Xiaomi",t=new E(window.funmax)):"$msstart"in e?(a="MsGames",t=new E(window.$msstart)):"gdsdk"in e?(a="GameDistribution",t=new E(window.gdsdk)):"h5sdk"in e?(a="TranssionH5",t=new E(window.h5sdk)):"CrazyGames"in e?(a="CrazyGames",t=new E(window.CrazyGames.SDK)):"GlanceGamingAdInterface"in e?(a="Glance",t=new E(window.GlanceGamingAdInterface)):"mraid"in e?(a="Playable",t=new E(window.mraid)):"MetaHorizon"in e?(a="Horizon",t=new E(window.MetaHorizon)):t=new cr,t}var f=N(()=>{"use strict";O(),cc(),O(),O(),O(),O(),O(),O(),O(),O(),jn(),ur(),window.GameSDK=Object.seal(Wm()),st(window,"GameSDK")}),lc,pe,pr=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),lc=(t=>(t.CORE_BOOTING="core-booting",t.REQUEST_CORE_START="core-start",t.CORE_STARTING="core-starting",t.CORE_READY="core-ready",t.GAME_SDK_READY="game-sdk-ready",t.GAME_SDK_STARTED="game-sdk-started",t.CONTEXT_DATA_PROCESSED="context-data-processed",t.CONTEXT_SESSION_TYPE_DETECTED="context-session-type-detected",t.GAME_READY="game-ready",t.BUNDLE_READY="bundle-ready",t.PLAYER_INFO_LOADED="player-info-loaded",t.REQUEST_SHOW_BANNER_ADS="request-show-banner-ads",t.SWITCH_SCENE="switch-scene",t.SCENE_LOADED="scene-loaded",t.PRELOAD_SCENE="preload-scene",t.SCENE_PROGRESS="scene-progress",t.SCENE_LAUNCHED="scene-launched",t.SCENE_RENDERED="scene-rendered",t.SCENE_BEFORE_RENDERED="scene-before-rendered",t.MARK_IS_TEST_SCENE="mark-is-test-scene",t.PRELOAD_SCREEN="preload-screen",t.PRELOAD_SCREENS="preload-screens",t.OPENING_SCREEN="opening-screen",t.OPEN_SCREEN="open-screen",t.OPENED_SCREEN="opened-screen",t.CLOSING_SCREEN="closing-screen",t.CLOSE_SCREEN="close-screen",t.CLOSED_SCREEN="closed-screen",t.CORE_PLUGIN_READY="core-plugin-ready",t.MODULE_PLUGIN_READY="module-plugin-ready",t.AD_SHOWING="ad-showing",t.AD_CLOSED="ad-closed",t.AD_FAILED="ad-failed",t.LANGUAGE_CHANGED="language-changed",t.REQUEST_LANGUAGE="request-language",t.REQUEST_HOT_RELOAD="request-hot-reload",t.REQUEST_SAVE_CONFIG="request-save-config",t.REQUEST_UPDATE_CONFIG="request-update-config",t.REMOTE_CONFIG_UPDATED="remote-config-updated",t.VISIBILITY_HIDDEN="visibility-hidden",t.VISIBILITY_VISIBLE="visibility-visible",t.REQUEST_RESIZE_GAME="request-resize-game",t.REQUEST_QUALITY_UPGRADED="request-quality-upgraded",t.REQUEST_QUALITY_DOWNGRADED="request-quality-downgraded",t))(lc||{}),pe=lc}),Au=Yh((t,e)=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var a=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function y(S,D,x){this.fn=S,this.context=D,this.once=x||!1}function g(S,D,x,b,_){if(typeof x!="function")throw new TypeError("The listener must be a function");var M=new y(x,b||S,_),B=r?r+D:D;return S._events[B]?S._events[B].fn?S._events[B]=[S._events[B],M]:S._events[B].push(M):(S._events[B]=M,S._eventsCount++),S}function w(S,D){--S._eventsCount===0?S._events=new n:delete S._events[D]}function v(){this._events=new n,this._eventsCount=0}v.prototype.eventNames=function(){var S=[],D,x;if(this._eventsCount===0)return S;for(x in D=this._events)a.call(D,x)&&S.push(r?x.slice(1):x);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(D)):S},v.prototype.listeners=function(S){var D=r?r+S:S,x=this._events[D];if(!x)return[];if(x.fn)return[x.fn];for(var b=0,_=x.length,M=new Array(_);b<_;b++)M[b]=x[b].fn;return M},v.prototype.listenerCount=function(S){var D=r?r+S:S,x=this._events[D];return x?x.fn?1:x.length:0},v.prototype.emit=function(S,D,x,b,_,M){var B=r?r+S:S;if(!this._events[B])return!1;var C=this._events[B],J=arguments.length,Bt,$;if(C.fn){switch(C.once&&this.removeListener(S,C.fn,void 0,!0),J){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,D),!0;case 3:return C.fn.call(C.context,D,x),!0;case 4:return C.fn.call(C.context,D,x,b),!0;case 5:return C.fn.call(C.context,D,x,b,_),!0;case 6:return C.fn.call(C.context,D,x,b,_,M),!0}for($=1,Bt=new Array(J-1);$<J;$++)Bt[$-1]=arguments[$];C.fn.apply(C.context,Bt)}else{var Zh=C.length,ce;for($=0;$<Zh;$++)switch(C[$].once&&this.removeListener(S,C[$].fn,void 0,!0),J){case 1:C[$].fn.call(C[$].context);break;case 2:C[$].fn.call(C[$].context,D);break;case 3:C[$].fn.call(C[$].context,D,x);break;case 4:C[$].fn.call(C[$].context,D,x,b);break;default:if(!Bt)for(ce=1,Bt=new Array(J-1);ce<J;ce++)Bt[ce-1]=arguments[ce];C[$].fn.apply(C[$].context,Bt)}}return!0},v.prototype.on=function(S,D,x){return g(this,S,D,x,!1)},v.prototype.once=function(S,D,x){return g(this,S,D,x,!0)},v.prototype.removeListener=function(S,D,x,b){var _=r?r+S:S;if(!this._events[_])return this;if(!D)return w(this,_),this;var M=this._events[_];if(M.fn)M.fn===D&&(!b||M.once)&&(!x||M.context===x)&&w(this,_);else{for(var B=0,C=[],J=M.length;B<J;B++)(M[B].fn!==D||b&&!M[B].once||x&&M[B].context!==x)&&C.push(M[B]);C.length?this._events[_]=C.length===1?C[0]:C:w(this,_)}return this},v.prototype.removeAllListeners=function(S){var D;return S?(D=r?r+S:S,this._events[D]&&w(this,D)):(this._events=new n,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=r,v.EventEmitter=v,typeof e<"u"&&(e.exports=v)}),hi,Eh,Th=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),hi=class{R;ne;Ct=!1;ie;Dt;actualFPS=0;constructor(t,e){this.R=e,this.ne=t}start=()=>{this.Ct||(this.Ct=!0,this.ie=this.R.CheckInterval,this.Dt=[])};stop=()=>{this.Ct&&(this.Ct=!1,this.R.OnlyUpdateWhenSwitchScene&&this.Us())};postStep=t=>{this.Ct&&(this.ie-=t,!(this.ie>0)&&(this.ie+=this.R.CheckInterval,this.Dt.push(this.actualFPS),this.R.OnlyUpdateWhenSwitchScene||this.Dt.length>=5&&this.Us()))};Us(){let{ads:t}=this.ne.codex;if(t?.isAdFullSizeShowing()||this.Dt.length===0)return;let e=!1;this.R.AutoUpgradeQuality&&this.lr()&&(e=this.ne.upgradeGraphicsQuality()),this.cr()&&(e=this.ne.downgradeGraphicsQuality()),e&&(this.Dt=[])}ks(){return this.hr(this.Dt)}hr(t){if(t.length===0)return Number.NaN;let e=t.sort((r,n)=>r-n),a=Math.floor(e.length/2);return e.length%2===0?(e[a-1]+e[a])/2:e[a]}cr(){return this.ks()<this.R.FpsThreshold}lr(){return this.ks()>this.R.FpsThreshold*1.2}},Eh=hi}),XA,mi,Mh,Oh=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),pr(),Th(),{Utils:{Device:XA}}=Ludex,mi=class extends Ludex.Plugins.BasePlugin{enabled=!1;Ke;Nt;Q;Fs=[];configure(t){let{Enabled:e,Quality:a,Options:r,TrackingSceneNames:n}=t;this.enabled=e,this.Ke=a,this.Q=XA.pixelRatio(),this.Fs=n,this.dr(r)}trackingScene=t=>{this.Fs.indexOf(t)<0||(this.ur(),this.yr())};getCurrentQuality(){return this.Q}downgradeGraphicsQuality(){this.event.emit(pe.REQUEST_QUALITY_DOWNGRADED);let{Min:t,AdjustStep:e}=this.Ke,a=this.Q;if(a<=t)return!1;let r=+(a-e).toFixed(2);return r<t?!1:(this.Q=r,this.Bs(this.Q),!0)}upgradeGraphicsQuality(){this.event.emit(pe.REQUEST_QUALITY_UPGRADED);let{Max:t,AdjustStep:e}=this.Ke,a=this.Q;if(a>=t)return!1;let r=+(a+e).toFixed(2);return r>t?!1:(this.Q=r,this.Bs(this.Q),!0)}dr(t){this.Nt=new Eh(this,t)}get event(){return this.codex.event}yr=()=>{this.Nt.start()};ur=()=>{this.Nt.stop()};Bs(t){let e={forcePixelRatio:t};this.event.emit(pe.REQUEST_RESIZE_GAME,e)}updatePostStepDeltaTime(t){this.Nt.postStep(t)}updateActualFPS(t){this.Nt.actualFPS=t}},Mh=mi}),_h={};Sn(_h,{default:()=>ZA});var ZA,Nh=N(()=>{"use strict";s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),Oh(),ZA=Mh});s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),pr(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var dc=(t=>(t.DRAFT="draft",t.SINGLE="single",t.TOURNAMENT="tournament",t.MATCHING_GROUP="matching-group",t.CHALLENGE_FRIEND="challenge-friend",t))(dc||{}),H=dc,zm=H,hr=zm;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var qm=t=>t,uc=qm;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Qm=()=>{},pc=Qm,hc={asConst:uc,noop:pc};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ym=(t,e)=>{if(t)return e<0?t[t.length+e]:t[e]},mc=Ym;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Jm=(t,e)=>{let a=[];for(let r=0;r<t;r++)a.push(e(r));return a},mr=Jm,Xm=t=>mr(t,()=>{}),ot=Xm,Zm=(t,e)=>{let a=Math.ceil(t.length/e);return ot(a).map((r,n)=>t.slice(n*e,n*e+e))},fc=Zm;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ef=(t,e)=>t.filter(a=>e.indexOf(a)<0),yc=ef;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var tf=t=>t.reduce((e,a)=>e.concat(a),[]),gc=tf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var rf=(t,e)=>t.indexOf(e)>=0,Pc=rf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var nf=(t,e)=>(t.length=Math.min(t.length,e),t),Ac=nf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var af=(t,e)=>{for(let a=0;a<t.length;a++)if(e(t[a],a))return t[a]},fr=af;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var sf=(t,e)=>{for(let a=0;a<t.length;a++)if(e(t[a],a))return a;return-1},yr=sf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var of=t=>{for(let e=t.length-1;e>0;e--){let a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}},gr=of;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var cf=t=>{let e=[...t];return gr(e),e},$c=cf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var lf=(t,e,a)=>a.indexOf(t)===e&&t!==null&&t!==void 0,df=t=>t.filter(lf),xc=df,wc={at:mc,chunk:fc,difference:yc,fillWith:mr,length:ot,limit:Ac,search:fr,searchIndex:yr,has:Pc,shuffle:gr,toShuffled:$c,unique:xc,flatten:gc};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var uf=()=>"OffscreenCanvas"in window&&typeof OffscreenCanvas<"u",pf=(t,e)=>{let a=new OffscreenCanvas(0,0),r=a.getContext(t,e);return r?{canvas:a,context:r}:null},hf=(t,e)=>{let a=document.createElement("canvas"),r=a.getContext(t,e);return r?{canvas:a,context:r}:null},mf=t=>{let{contextType:e="2d",contextAttributes:a={},type:r="auto"}=t,n=null;return r!=="canvas"&&uf()&&(n=pf(e,a)),!n&&r!=="offscreen"&&(n=hf(e,a)),n},it=mf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ff=t=>!t||t===""||t===0||typeof t=="number"&&isNaN(t),Pr=ff,yf=t=>Pr(t)?t!==!1&&t!==0:typeof t=="string"||Array.isArray(t)?t.length===0:typeof t=="object"&&t!==null?Object.keys(t).length===0:!1,ct=yf,bc="Tile Connect Remaster",ia={},Ar=t=>ct(t)?GameSDK.getSDKName()??"Storage":t??"Storage",gf=t=>{let e=`${bc}_${t}`;return ia[e]?Promise.resolve(ia[e]):new Promise((a,r)=>{let n=1,y,g=w=>{y=indexedDB.open(bc,w),y.onerror=v=>{let S=v.target.error;S?.name==="VersionError"?(n++,g(n)):r(S)},y.onsuccess=v=>{let S=y.result;if(!S.objectStoreNames.contains(t)){n++,g(n);return}ia[e]=S,a(S)},y.onupgradeneeded=v=>{let S=v.target.result;n=S.version,S.objectStoreNames.contains(t)||S.createObjectStore(t)}};g(n)})},$r=gf,Pf=async(t,e)=>{try{let a=Ar(e),r=await $r(a);if(!r.objectStoreNames.contains(a))return{};let n=r.transaction(a,"readonly").objectStore(a);return new Promise((y,g)=>{let w=n.get(t);w.onerror=()=>g(w.error),w.onsuccess=()=>y(w.result)})}catch{return{}}},vc=Pf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Af=t=>{try{return JSON.parse(t)}catch{return null}},lt=Af,$f=t=>{try{if(!localStorage)return null;let e=localStorage.getItem(t);return e===null?null:lt(e)}catch{return null}},xr=$f;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xf=t=>{try{return JSON.stringify(t,null,0)}catch{return""}},dt=xf,wf=t=>lt(dt(t)),wr=wf,bf=()=>{let t="en_US",e=wr(window.navigator.languages)||[],a=fr(e,r=>r.indexOf("-")>-1);return!a||a.indexOf("-")===-1?t:a.replace("-","_")},Sc=bf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var vf=()=>{let t=window.location.search.substring(1);if(!t)return{};let e=t.split("&"),a={};for(let r of e){let n=r.split("=");a[n[0]]=decodeURIComponent(n[1])}return a},Dc=vf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Sf=()=>{let{body:t,documentElement:e}=document,{clientHeight:a}=t,{clientHeight:r}=e;return Math.max(r,a)||0},Ic=Sf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Df=()=>{let{body:t,documentElement:e}=document,{clientWidth:a}=t,{clientWidth:r}=e;return Math.max(r,a)||0},Lc=Df;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var If=t=>{try{localStorage.removeItem(t)}catch{}},Cc=If;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Lf=async(t,e,a)=>{try{if(ct(e))return;let r=Ar(a),n=await $r(r);if(!n.objectStoreNames.contains(r))return;let y=n.transaction(r,"readwrite").objectStore(r);return new Promise((g,w)=>{try{let v=y.put(e,t);v.onsuccess=()=>g(),v.onerror=()=>w(v.error)}catch(v){w(v)}})}catch{}},Ec=Lf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Cf=()=>{let t="vibrate"in window.navigator;if(t)try{window.navigator.vibrate(0)}catch{return!1}return t},Ef=t=>{try{return Cf()?(window.navigator.vibrate(0),window.navigator.vibrate(t),!0):!1}catch{return!1}},Tc=Ef;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Tf=(t,e,a)=>{let r,n=!1;return function(...y){if(a&&!n){n=!0,t.apply(this,y);return}clearTimeout(r),r=setTimeout(()=>{t.apply(this,y)},e)}},Tt=Tf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Mf=t=>{let e=Object.create(null);return function(...a){let r=`__memoize__${JSON.stringify(a)}`;if(r in e)return e[r];let n=t.apply(this,a);return e[r]=n,n}},we=Mf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Of=(t,e,a)=>{let r,n=!1,y=!1;return function(...g){if(a&&!y){y=!0,t.apply(this,g);return}n&&(n=!1,t.apply(this,g)),clearTimeout(r),r=setTimeout(()=>{n=!0},e)}},Mt=Of;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var _f=(t,e)=>{let a=t.value;return t.value=async function(...r){await e.apply(this,r);let n=a.apply(this,r);return n instanceof Promise?await n:n},t},Mc=_f;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Nf=t=>{if(t instanceof Error)return t;if(t!==null&&typeof t=="object"&&"message"in t&&typeof t.message=="string"){let e=new Error(t.message);return"stack"in t&&typeof t.stack=="string"&&(e.stack=t.stack),"name"in t&&typeof t.name=="string"&&(e.name=t.name),"code"in t&&typeof t.code=="string"&&Object.assign(e,{code:t.code}),e}if(t!==null&&typeof t=="object")try{return new Error(JSON.stringify(t,null,2))}catch{return new Error(`[Object conversion failed] ${String(t)}`)}return new Error(String(t))},he=Nf,kf=(t,e)=>{let a=t.value;return t.value=async function(...r){let n;try{let y=a.apply(this,r);return y instanceof Promise?await y:y}catch(y){n=he(y)}finally{e?.(n)}},t},Oc=kf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Rf=t=>{let e=typeof t=="object"||typeof t=="function",a=Array.isArray(t);return t!==null&&e&&!a},K=Rf,_c=(t,e)=>{if(typeof t!==e)throw new Error(`Value ${t} is not type of ${e} (${typeof t})`)},Gf=(t,e,a)=>{let r;return a||_c(t,e),!K(t)||!a?t:Object.defineProperty(t,a,{get(){return r},set(n){_c(n,e),r=n}})},ut=Gf,Ff=(t,e)=>{let a=t.value;return t.value=function(...r){return e.forEach((n,y)=>{try{ut(r[y],n)}catch(g){let w="[Decorator:validateParams]";throw g instanceof Error?(g.message=`${w}: ${g.message}`,g):new Error(`${w}: ${g}`)}}),a.apply(this,r)},t},Nc=Ff;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Bf=(t,e)=>{for(let a of e)try{return ut(t,a),!1}catch{}return!0},Vf=(t,e)=>{let a=t.value;return t.value=function(...r){let n=a.apply(this,r);if(Bf(n,e))throw new Error(`[Decorator:validateReturn] ${n} (${typeof n}) is not type of ${e.join(" | ")}`);return n},t},kc=Vf,ca=class q{static pr(e,a,r){return!!(r&&(typeof r.value<"u"||r.get||r.set))}static dt(e,a,r){return!!(r&&(typeof r.value=="function"||typeof r.initializer=="function"))}static trace=(e,a,r)=>{try{let{value:n,initializer:y,get:g,set:w}=r??{};try{if(!(g||w)&&typeof n!="function")if(typeof y=="function"){let v=y?.();if(typeof v!="function"&&typeof v>"u")throw new Error("Initializer returned undefined")}else if(n){let v=typeof n}else throw new Error("Unsupported decorator")}catch{}}catch{}finally{}return r};static locked(e,a,r){return de(T({},r),{value:()=>{throw new Error("Method is locked")}})}static preStart(e){return(a,r,n)=>q.dt("preStart",r,n)?Mc(n,e):n}static tryCatch(e){return(a,r,n)=>q.dt("tryCatch",r,n)?Oc(n,e):n}static debounce(e){return(a,r,n)=>{if(!q.dt("debounce",r,n))return n;let y=n.value;return y?n.value=Tt(y,e):n.initializer&&(y=n.initializer,n.initializer=function(){return Tt(y.call(this),e)}),n}}static throttle(e){return(a,r,n)=>{if(!q.dt("throttle",r,n))return n;let y=n.value;return y?n.value=Mt(y,e):n.initializer&&(y=n.initializer,n.initializer=function(){return Mt(y.call(this),e,!0)}),n}}static memoize(e,a,r){if(!q.dt("memoize",a,r))return r;let n=r.value;return n?r.value=we(n):r.initializer&&(n=r.initializer,r.initializer=function(){return we(n.call(this))}),r}static validateValue(e){return(a,r,n)=>{if(!q.pr("validateValue",r,n))return n;try{return ut(a,e,r)}catch(y){return y instanceof Error,n}}}static validateReturn=(...e)=>(a,r,n)=>q.dt("validateReturn",r,n)?kc(n,e):n;static validateParams=(...e)=>(a,r,n)=>q.dt("validateParams",r,n)?Nc(n,e):n},Ot=ca,Uf=()=>{self.onmessage=r=>{let{action:n,payload:y}=r.data;switch(n){case"drawImage":break;case"saveData":break;case"getData":break;default:}};function t(r){}function e(r){}function a(r){}},_t=class xe{He=null;static ut;constructor(){this.init()}static get inst(){return this.ut||(this.ut=new xe),this.ut}init(){let e=new Blob([`(${Uf.toString()})()`],{type:"application/javascript"});this.He=new Worker(URL.createObjectURL(e))}static postMessage(e,a){if(!this.inst.He)throw new Error("Worker is not initialized");this.inst.He.postMessage({action:e,payload:a})}};se([Ot.tryCatch()],_t.prototype,"init",1),se([Ot.tryCatch()],_t,"postMessage",1);var la=_t,Rc=la;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Kf=t=>t==null,Gc=t=>{if(!K(t))return t;for(let e in t)if(Kf(t[e]))delete t[e];else{let a=t[e];K(a)&&(t[e]=Gc(a))}return t},br=Gc;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Fc=Object,Hf=(t,e)=>{if("assign"in Fc)return Fc.assign(t,e);let a=t;for(let r in e)a[r]=e[r];return a},De=Hf,jf=t=>typeof t!="object"||t===null?null:De(t,{}),vr=jf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Bc=(t,e)=>{for(let a in e)K(t[a])&&K(e[a])?Bc(t[a],e[a]):De(t,{[a]:e[a]});return t},Sr=Bc,Wf=(t,e)=>{try{if(!localStorage)return!1;let a=xr(t),r={};K(a)&&(r=a);let n=vr(e);if(!K(n))return!1;let y=br(n),g=Sr(r,y),w=dt(g);return localStorage.setItem(t,w),!0}catch{return!1}},Vc=Wf,Uc={createCanvas:it,getLocale:Sc,getLocalStorage:xr,getQueryParams:Dc,getScreenHeight:Ic,getScreenWidth:Lc,writeLocalStorage:Vc,vibrate:Tc,getIndexedDB:vc,WebWorker:Rc,setIndexedDB:Ec,removeKeyLocalStorage:Cc};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var zf=()=>window.devicePixelRatio??1,Dr=zf,qf=t=>t*Dr(),Kc=qf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Qf=()=>/Android/i.test(navigator.userAgent),Hc=Qf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Yf=()=>!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),jc=Yf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Jf=()=>/iPhone|iPad|iPod/i.test(navigator.userAgent),Wc=Jf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Xf=()=>/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),zc=Xf,qc={getPhysicPixels:Kc,isDesktop:jc,isMobile:zc,isAndroid:Hc,isIOS:Wc,pixelRatio:Dr};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Zf=t=>[null,t],Fe=Zf;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ey=t=>t[1]!==null,pt=ey;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ty=t=>[t,null],Pe=ty,ry=t=>e=>{if(pt(e))return e;try{return Pe(t(e[0]))}catch(a){return Fe(he(a))}},Ir=ry;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ny=t=>async e=>{if(pt(e))return e;try{return Pe(await t(e[0]))}catch(a){return Fe(he(a))}},Lr=ny;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ay=t=>{try{return Pe(t())}catch(e){return Fe(he(e))}},Qc=ay;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var sy=async t=>{try{return Pe(await t())}catch(e){return Fe(he(e))}},Yc=sy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var oy=t=>t[1],Jc=oy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var iy=t=>t[0],Xc=iy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var cy=t=>t[1]===null,Zc=cy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ly=Pe,el=ly;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var dy=(...t)=>e=>t.reduce((a,r)=>Ir(r)(a),e),tl=dy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var uy=(...t)=>async e=>{let a=e;for(let r of t)a=await Lr(r)(a);return a},rl=uy,nl={apply:Ir,applyAsync:Lr,applyImmediate:Qc,applyImmediateAsync:Yc,lift:el,success:Pe,pipe:tl,pipeAsync:rl,extractSuccess:Xc,extractFailure:Jc,isFailure:pt,isSuccess:Zc};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),ur(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var py=t=>{let e=t.map(a=>Promise.resolve(a).then(r=>({status:"fulfilled",value:r}),r=>({status:"rejected",reason:r})));return Promise.all(e)},al=py;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var hy=t=>typeof Promise.any=="function"?Promise.any(t):new Promise((e,a)=>{let r=[],n=0,y=g=>{if(!(g<t.length))if(r.length>0)e(r[0]);else{let w=new Error("All promises were rejected");w.errors=r,a(w)}};t.forEach((g,w)=>{g.then(v=>{r[w]=v,n++,y(n)}).catch(v=>{r[w]=v,n++,y(n)})})}),sl=hy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var my=async(t,e)=>{try{if(e){let a=new Promise((r,n)=>setTimeout(()=>n(new Error("Timeout")),e));return[await Promise.race([t,a]),null]}return[await t,null]}catch(a){return[null,he(a)]}},ol=my;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();function da(){let t={},e=r=>{let n=!1,y={release:()=>{n||(n=!0,a(r))}};return t[r]?new Promise(g=>{t[r].push(()=>g(y))}):(t[r]=[],Promise.resolve(y))},a=r=>{let n=t[r].shift();n?n():delete t[r]};return{use:e}}s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var fy=(t,e)=>{try{return t()}catch(a){try{return e()}catch{throw a}}},il=fy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var yy=async(t,e)=>{try{return await t()}catch(a){try{return await e()}catch{throw a}}},cl=yy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var gy=t=>{let{generate:e,generateSeed:a=()=>Math.random()*1e6,seed:r=Date.now()}=t,n=r;return(...y)=>(n=a(n),e(n,...y))},ll=gy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var dl=(t,e)=>{t.__proto__.valueOf=()=>e,t.__proto__.toString=()=>`${e}`},Py=t=>t.constructor(de(T({},t),{__proto__:t.__proto__})),ul=t=>{let e=Object.keys(t);for(let a of e){let r=Object.getOwnPropertyDescriptor(t,a)?.value;if(K(r)){ul(r);continue}try{let n=r;dl(n,r),Object.defineProperty(t,a,{enumerable:!1,configurable:!0,get(){return Py(n)},set(y){De(n,y),dl(n,y)}})}catch{}}},pl=ul;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ay=(t,e,a=setTimeout)=>e<=0?Promise.resolve(t).then(r=>({status:"fulfilled",value:r})):Promise.race([Promise.resolve(t).then(r=>({status:"fulfilled",value:r})),new Promise(r=>a(()=>r({status:"timeout",duration:e,promise:t}),e))]),hl=Ay;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var $y=t=>t.reduce((e,a)=>(a.status==="fulfilled"?e.successes.push(a.value):e.failures.push(a.reason),e),{successes:[],failures:[]}),ml=$y,fl={debounce:Tt,throttle:Mt,syncVars:pl,memoize:we,retry:il,retryAsync:cl,allSettled:al,timeOut:hl,any:sl,accessBlocker:st,rng:ll,handleAsync:ol,toError:he,mutex:da,unwrapAllSettled:ml};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xy=t=>{let e={};for(let a in t){let r=t[a];e[r]=a}return e},Cr=xy,wy=we((t,e)=>{let a=t.toLowerCase();if(typeof t=="string"){let r=e[a];if(typeof r=="string")return r}return"?"}),by=we(t=>{let e=[],a=/:([A-Z0-9?]+)/gm,r=null;for(;r=a.exec(t),r!==null;)e.push(r[1]);return e}),vy=we(t=>{let e=[],a=/(\d+[A-Z?]|[A-Z?])/gm,r=null;for(;r=a.exec(t),r!==null;){let n=r[0];if(n.length>=2){let{length:y}=n,g=n.slice(0,y-1),w=n[y-1],v=ot(+g).map(()=>w);e.push(...v);continue}e.push(n)}return e}),Sy=(t,e)=>{let a=t,r=Cr(e),n={},y=0,g=0,w=by(a);for(let v of w){y=0,g++,n[g]||(n[g]={});let S=vy(v);for(let D of S){y++;let x=wy(D,r);n[g][y]=x}}return n},yl=Sy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Dy=(t,e)=>K(t)?typeof Object.hasOwn=="function"?Object.hasOwn(t,e):Object.prototype.hasOwnProperty.call(t,e):!1,oe=Dy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Iy=t=>typeof t=="string",Er=Iy,Ly=we((t,e)=>{if(!K(e)||!oe(e,t))return"?";let a=e[t];return typeof a=="string"?`${a.toUpperCase()}`:"?"}),gl=(t,e,a=!1)=>{let r="";if(!K(t))return r;let n="",y=1;for(let g in t){if(!oe(t,g))continue;let w=t[g];if(K(w)){r+=`:${gl(w,e,!0)}`;continue}if(!Er(w))continue;let v=Ly(w,e);v===n?(y++,r=r.slice(0,-2)):y=1,r+=`${y}${v}`,n=v}return r=r.replace(/1([A-Z])/g,"$1"),r},Pl=gl;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Cy=(t,e)=>{try{if(!t)return"";if(e){let a=atob(t),r=btoa(e);return a=a.replace(r,"="),atob(a)}return atob(t)}catch{return""}},Al=Cy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ey=()=>({}),ua={},Nt=t=>(ua[t]||(ua[t]=Ey()),ua[t]),$l=(t,e)=>{let a=Nt(e),r=Object.keys(a).length;a[t]=r+1},Ty=(t,e,a=1)=>{let r=t[0],n=[],y=Nt(a);if(e)for(let v in e)$l(v,a);for(let v=1;v<t.length;v++){let S=t[v],D=`${r}${S}`;v++,r=t[v],y[D]===void 0&&($l(D,a),y=Nt(a))}r=t[0];let g=1,w=0;for(;g<t.length;){let v=t[g],S=`${r}${v}`,D=My(t.slice(w),y);if(D!==null){n.push(y[D]),g+=D.length-S.length,r="",w=g+1,g++;continue}y[S]===void 0?r=S:(n.push(y[S]),r="",w=g+1),g++}return n},My=(t,e)=>{let a=Object.keys(e);return a=a.filter(r=>t.indexOf(r)>-1&&t!==r),a.length===0?null:a.sort((r,n)=>n.length-r.length)[0]},xl=Ty;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Oy=t=>{let e={};for(let a in t)e[t[a]]=a;return e},_y=(t,e,a=1)=>{let r="",n="",y=Nt(a);e&&(y=T(T({},e),y));let g=Oy(y);for(let w in t){let v=t[w];g[v]!==void 0?r=g[v]:r="?",n+=r}return n},wl=_y;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ny=(t,e)=>{try{if(!t)return"";if(e){let a=btoa(t),r=btoa(e);return a=a.replace("=",r),btoa(a)}return btoa(t)}catch{return""}},bl=Ny,vl={decodeMap:yl,encodeMap:Pl,hashToString:Al,stringToHash:bl,lwzCompress:xl,lwzDecompress:wl};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ky=(t,e)=>{let a=t.split(","),r=a[0].match(/:(.*?);/);if(!r)return null;let n=r[1],y=atob(a[a.length-1]),g=y.length,w=new Uint8Array(g);for(;g--;)w[g]=y.charCodeAt(g);return new File([w],e,{type:n})},Sl=ky;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ry=t=>new Promise((e,a)=>{let r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=a,r.readAsDataURL(t)}),Dl=Ry;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ht=new Image,Gy=(t,e=!0,a=!0)=>new Promise(r=>{e&&(ht=new Image),ht.onload=()=>{r(ht),a&&URL.revokeObjectURL(ht.src)},ht.onerror=()=>{r(null)},ht.src=URL.createObjectURL(t)}),Il=Gy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Fy=async(t,e)=>{let a=await fetch(t).then(r=>r.blob()).catch(()=>null);return a?new File([a],e):null},Ll=Fy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var qe=it({contextType:"2d",contextAttributes:{willReadFrequently:!0}}),By=async t=>new Promise((e,a)=>{let r=new FileReader;r.onload=()=>e(r.result),r.onerror=a,r.readAsDataURL(t)}),Vy=async(t,e="png")=>{let{width:a,height:r}=t;if(!a||!r)throw new Error("Element has no width or height");if(!qe)throw new Error("Failed to create canvas");if(qe.canvas.width=a,qe.canvas.height=r,qe.context.drawImage(t,0,0,a,r),qe.canvas instanceof HTMLCanvasElement)return qe.canvas.toDataURL(`image/${e}`,.85);let n=await qe.canvas.convertToBlob({type:`image/${e}`});return By(n)},Cl=Vy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var El=it({contextType:"2d",contextAttributes:{willReadFrequently:!0}}),Uy=async(t,e="png")=>{try{if(!El)throw new Error("Failed to create canvas");let{canvas:a,context:r}=El;return a.width=t.width,a.height=t.height,r.drawImage(t,0,0,t.width,t.height),a instanceof HTMLCanvasElement?new Promise(n=>{a.toBlob(y=>n(y),`image/${e}`,.9)}):a.convertToBlob({type:`image/${e}`,quality:.9})}catch{return null}},Tl=Uy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ky=async t=>{if(!t)throw new Error("url is empty");try{let e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");return await e.blob()}catch(e){throw e instanceof Error?e:new Error("Failed to fetch image")}},Ml=Ky;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Hy=async t=>new Promise((e,a)=>{t||a(new Error("url is empty"));let r=new Image;r.crossOrigin="anonymous",r.onload=()=>{e(r)},r.onerror=n=>{a(n)},r.src=t}),Ol=Hy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var jy=(t,e)=>{if(isNaN(t)||isNaN(e))throw new Error("width and height must be numbers");return{string:"+",style:`font-size: 1px; padding: ${Math.floor(e/2)}px ${Math.floor(t/2)}px;`}},Wy=(t,e=1)=>{let a=new Image;a.onload=function(){let r=this,n=r.width*e,y=r.height*e,g=jy(n,y)},a.src=t},_l=Wy,Nl={base64ToFile:Sl,blobToDataImage:Dl,blobToHtmlImage:Il,blobUrlToFile:Ll,elementToBase64:Cl,elementToBlob:Tl,fetchImage:Ml,loadImage:Ol,logImage:_l};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var kl={clone:wr,decode:lt,encode:dt};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var pa=class Za{I=null;static ut;static get inst(){return this.ut||(this.ut=new Za),this.ut}static setService(e){this.inst.I=e??null}static measure(e){this.inst.I&&this.inst.I.measure(e)}static start(e){this.inst.I?.start(e)}static stop(e){if(this.inst.I)try{this.inst.I.stop(e)}catch{}}static putMetric(e,a,r=Date.now()){this.inst.I&&this.inst.I.putMetric(e,a,r)}static incMetric(e,a,r=1){this.inst.I&&this.inst.I.incrementMetric(e,a,r)}static putAttr(e,a,r){let n=r.slice(0,100);this.inst.I&&this.inst.I.putAttr(e,a,n)}static rmAttr(e,a){this.inst.I&&this.inst.I.removeAttr(e,a)}},Rl=pa,Gl={Mark:Rl};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var zy=(t,e)=>{if(typeof t!="number")return"0";let a=tt(10,e),r=t,n=0;for(;r>=a;)r=Math.floor(r/1e3),n++;let y=r.toString(),g=["","K","M","B","T","Qa","Qi","Sx","Sp","Oc","No","Dc","Ud","Dd","Td","Qad","Qid","Sxd","Spd"][n];return`${y}${g}`},Fl=zy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var qy=(t,e,a="0")=>{let r=t.toString(),n=r.length;for(let y=0;y<e-n;y++)r=r+a;return r},Bl=qy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Qy=(t,e,a="0")=>{let r=t.toString(),n=r.length;for(let y=0;y<e-n;y++)r=a+r;return r},Vl=Qy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Yy=(t,e)=>{let a=e?Math.random()>.5?1:-1:1;return Math.floor(Math.random()*t)*a},kt=Yy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Jy=t=>t>0?1:t<0?-1:t===0?0:Number.NaN,Ul=Jy;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Xy=(t,e)=>{let{fractionalDigits:a=0,startAbbreviate:r=1e3,abbreviateStep:n=3,maxLength:y=-1,removeLastZero:g=!0,suffixes:w=["","k","m","b","t","q"]}=e||{},v=y===-1?99999999:y;if(t>=r){let b=Math.floor(t/tt(10,n)),_=Math.floor((b.toString().length-1)/n)+1,M=(t/tt(tt(10,n),_)).toFixed(a),B=v-w[_].length,C=M.substring(0,B);return(g?Kl(C):C)+w[_]}let S=t.toFixed(a),D=v-w[0].length,x=S.substring(0,D);return g?Kl(x):x+w[0]},Kl=t=>{if(t.indexOf(".")<0)return t;for(let e=t.length-1;e>=0;e--){if(t[e]===".")return t.substring(0,e);if(t[e]!=="0")return t.substring(0,e+1)}return t},Hl=Xy,jl={getShortNumber:Fl,sign:Ul,padEnd:Bl,padStart:Vl,random:kt,toAbbreviatedString:Hl};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Wl=t=>{let e=t.replace(/[-_\s.]+(.)?/g,(a,r)=>r?r.toUpperCase():"");return e.substring(0,1).toUpperCase()+e.substring(1)},Tr=t=>{let e=t.replace(/[-_\s.]+(.)?/g,(a,r)=>r?r.toUpperCase():"");return e.substring(0,1).toLowerCase()+e.substring(1)},ha=t=>{let e={};for(let a in t){let r=t[a],n=Tr(a);Array.isArray(r)?e[n]=r.map(y=>typeof y=="object"?ha(y):y):typeof r=="object"?e[n]=ha(r):e[n]=t[a]}return e},zl=ha;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ql=(t,e)=>{let a={};for(let r in e)if(oe(e,r))if(oe(t,r)){let n=t[r],y=e[r];if(K(n)&&K(y)&&n!==null&&y!==null&&typeof n!="function"&&typeof y!="function"){let g=ql(n,y);Object.keys(g).length>0&&(a[r]=g)}else Object.is(n,y)||(a[r]=y)}else a[r]=e[r];for(let r in t)oe(t,r)&&!oe(e,r)&&(a[r]=void 0);return a},Ql=ql;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Yl=(t,e)=>{let a={};for(let r in e)if(oe(e,r))if(K(e[r])&&e[r]!==null)if(K(t[r])&&t[r]!==null){if(typeof e[r]=="function")continue;let n=Yl(t[r],e[r]);Object.keys(n).length>0&&(a[r]=n)}else oe(t,r)||(a[r]=De({},e[r]));else oe(t,r)||(a[r]=e[r]);return a},Jl=Yl;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Zy=t=>["string","number","symbol"].indexOf(typeof t)>-1,Mr=Zy,eg=(t,e)=>{let a={};for(let r of t){let n=r[e];Mr(n)&&(a[n]=r)}return a},Xl=eg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Or=t=>t.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toLowerCase(),ma=t=>{let e={};for(let a in t){let r=t[a],n=Or(a);Array.isArray(r)?e[n]=r.map(y=>typeof y=="object"?ma(y):y):typeof r=="object"?e[n]=ma(r):e[n]=t[a]}return e},Zl=ma;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var tg=t=>Object.keys(t).map(e=>t[e]),ed=tg,td={assign:De,camelCaseKeys:zl,clone:vr,clear:br,diff:Ql,hasOwn:oe,invert:Cr,keyBy:Xl,merge:Sr,snakeCaseKeys:Zl,vals:ed,filterDeep:Jl};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ya={};Sn(ya,{Signal:()=>_r,SignalAbortedError:()=>Rt,SignalController:()=>fa}),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Rt=class extends Error{constructor(t="Signal aborted with no reason"){super(t),this.name="SignalAbortedStopped"}},_r=class Qr{S={type:"running"};Tt=[];once(e){this.Tt.push(e)}off(e){this.Tt=this.Tt.filter(a=>a!==e)}abort(e){let a=this.constructReason(e);this.S={type:"stopped",reason:a};for(let r of this.Tt)r(a);this.Tt=[]}get aborted(){return this.S.type==="stopped"}get reason(){if(this.S.type==="stopped")return this.S.reason}wrap(e){if(!this.aborted)return e}chain(e){e instanceof Qr?e.once(a=>this.abort(a)):e.addEventListener("abort",()=>this.abort(e.reason),{once:!0})}promise(){return this.aborted?Promise.resolve(this.reason):new Promise(e=>{this.once(a=>e(a))})}constructReason(e){return e instanceof Error?e:typeof e=="string"?new Rt(e):new Rt}},fa=class{Rt;renew(){this.Rt?.abort();let t=new _r;return this.Rt=t,t}abort(){this.Rt?.abort()}promise(){return this.Rt===void 0?Promise.resolve(void 0):this.Rt.promise()}},rd=ya;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var rg=t=>t&&t[0].toUpperCase()+t.slice(1),nd=rg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();function ng(t,e=2){let a=[],r=t.split(" "),n=r.length;for(let y=n;y>=1;y--)for(let g=0;g<=n-y;g++){let w=r.slice(g,g+y).join(" ");t.split(w).length-1>=e&&a.indexOf(w)<0&&w.length>1&&a.push(w)}return a.sort((y,g)=>y.length-g.length)}var ad=ng;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Qe=null,ag="Anonymous",sg=async()=>{let t="https://randommer.io/api/Name",{RandomNameApiKey:e}=Ludex.Configs.Mockup.Profile,a=await fetch(t,{method:"GET",headers:{"X-Api-Key":e,"Content-Type":"application/json"},body:JSON.stringify({nameType:"surname",quantity:1e3})});if(!a.ok)throw new Error("Can't fetch names");let r=await a.json();if(!K(r)||!oe(r,"data")||!Array.isArray(r.data))throw new Error("Invalid names response");return r.data},og=async()=>{try{if(!Qe&&(Qe=await sg(),!Qe))throw new Error("Cannot fetch names");let t=Qe[kt(Qe.length)],e=Qe[kt(Qe.length)];return`${t} ${e}`}catch{return ag}},sd=og;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ig=(t=16)=>{let e=n=>Math.floor(n).toString(t),a=e(Date.now()/1e3),r=Array(t+1).join(" ");return a+r.replace(/./g,()=>e(Math.random()*t))},od=ig;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var cg=t=>{let e=t?t.split("_"):[],a=e.length>0?e[0]:"en_US";switch(a){case"id":case"in":a="id";break}return a},id=cg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var lg=(t,e)=>{let a=t.split(" "),r=(a.length<=1?[...a]:[a[0],a.pop()]).join(" "),n=r.lastIndexOf(" ")||0,y=n>=0?n:e;return(r.length>e?r.substring(0,y):r).substring(0,e)},cd=lg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var dg=t=>{let e=0;if(t.length===0)return e;for(let a=0;a<t.length;a++){let r=t.charCodeAt(a);e=(e<<5)-e+r,e=e&e}return e},ld=dg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ug=(t,e)=>{for(let a=0;a<e.length;a++)if(t[a]!==e[a])return!1;return!0},dd=ug;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var pg=(t,e,a=" ")=>{let r=Math.floor(e);if(t.length>=r)return t;let n=r-t.length,y="";for(let g=0;g<n;g++)y+=a;return y.slice(0,n)+t},ud=pg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var hg=t=>Object.keys(t).reduce((e,a)=>{let r=t[a];return r!==void 0&&e.push(`${a}=${r}`),e},[]).join("&"),pd=hg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var mg=(t,e)=>{let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",r="",n=t;e!==void 0&&(n-=e.length,r+=e);for(let y=0;y<n;y++){let g=Math.floor(Math.random()*a.length);r+=a.charAt(g)}return r},hd=mg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var fg="0123456789ABCDEF",yg=(t="0x")=>{let e=t;for(let a=0;a<6;a++)e+=fg[Math.floor(Math.random()*16)];return e},md=yg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var gg=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[đĐ]/g,e=>e==="\u0111"?"d":"D"),fd=gg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();function Pd(t){let e=Pg(t),a=e%yd.length,r=(e>>8)%gd.length,n=(e>>16)%1e4;return`${yd[a]}${gd[r]}${n}`}var Pg=t=>{let e=0;for(let a=0;a<t.length;a++){let r=t.charCodeAt(a);e=(e<<5)-e+r,e=e|0}return e=Math.abs(e),e},yd=["James","Mary","John","Patricia","Robert","Jennifer","Michael","Linda","William","Elizabeth","David","Susan","Richard","Jessica","Joseph","Sarah","Thomas","Karen","Charles","Nancy","Christopher","Lisa","Daniel","Margaret","Matthew","Betty","Anthony","Sandra","Mark","Ashley","Donald","Dorothy","Steven","Kimberly","Paul","Emily","Andrew","Donna","Joshua","Michelle","Kenneth","Carol","Kevin","Amanda","Brian","Melissa","George","Deborah"],gd=["Smith","Johnson","Williams","Jones","Brown","Davis","Miller","Wilson","Moore","Taylor","Anderson","Thomas","Jackson","White","Harris","Martin","Thompson","Garcia","Martinez","Robinson","Clark","Rodriguez","Lewis","Lee","Walker","Hall","Allen","Young","Hernandez","King","Wright","Lopez","Hill","Scott","Green","Adams","Baker","Gonzalez","Nelson","Carter","Mitchell","Perez","Roberts","Turner","Phillips","Campbell","Parker","Evans"],Ad={toCamelCase:Tr,toUpperCamelCase:Wl,capitalize:nd,generateObjectId:od,getLanguageCode:id,getShortName:cd,hashCode:ld,matchStart:dd,padStart:ud,params:pd,random:hd,randomColor:md,removeDiacritics:fd,findDuplicateSubstrings:ad,generateNameAsync:sd,toSnakeCase:Or,generateNameUsingString:Pd};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var $d=[60,3600,86400,86400*7,86400*30,86400*365,Number.POSITIVE_INFINITY],Ag=["second","minute","hour","day","week","month","year"],$g=(t,e,a,r="Soon")=>{try{let n=e??"en",y=a??{numeric:"auto"},g=Math.round((t*1e3-Date.now())/1e3),w=Math.abs(Math.round((t*1e3-Date.now())/1e3)),v=yr($d,D=>D>w),S=v?$d[v-1]:1;return new Intl.RelativeTimeFormat(n,y).format(Math.floor(g/S),Ag[v])}catch(n){if(r!==void 0)return"Soon";throw n}},xd=$g;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xg=t=>{let e=new Date(t),a=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),y=e.getUTCMilliseconds(),g=a<10?`0${a}`:`${a}`,w=r<10?`0${r}`:`${r}`,v=n<10?`0${n}`:`${n}`,S=`${y}`;return y<10?S=`00${y}`:y<100&&(S=`0${y}`),`${g}:${w}:${v}:${S}`},wd=xg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var wg=t=>{let e=new Date(t),a=new Date;return e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()},bd=wg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var bg=t=>new Promise(e=>setTimeout(e,t)),vd=bg,Sd={isToday:bd,sleepAsync:vd,getRelativeTime:xd,getTimeString:wd};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var vg=t=>typeof t=="boolean",Dd=vg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Sg=()=>!!codex?.player?.getPlayerDataByKey("debug"),Id=Sg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Dg=t=>typeof t=="function",Nr=Dg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ig=t=>typeof t=="number",Ld=Ig;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Lg=t=>Nr(t)?t instanceof Promise||"then"in t&&typeof t.then=="function"?!0:t.constructor.name==="AsyncFunction":!1,Cd=Lg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Cg=(t,e,a)=>{let{timeout:r=1e3,checkInterval:n=16}=a??{},y,g;return new Promise((w,v)=>{if(typeof t!="function")throw new Error("Input from must be a function");g=setInterval(()=>{let S=t(),D=typeof e=="function"?e():e;S===D&&(clearTimeout(y),clearInterval(g),w(!0))},n),r>0&&(clearTimeout(y),y=setTimeout(()=>{clearInterval(g),v(new Error("Timeout"))},r))})},Ed=Cg,Td={isBoolean:Dd,isDebugger:Id,isEmpty:ct,isFalsy:Pr,isFunction:Nr,isNumber:Ld,isObject:K,isPromise:Cd,isPropertyKey:Mr,isString:Er,isValueChangeAsync:Ed},Eg={Array:wc,Browser:Uc,Decorator:Ot,Device:qc,Function:fl,Hash:vl,Image:Nl,Json:kl,Mark:Gl.Mark,Object:td,Signal:rd,String:Ad,Number:jl,Time:Sd,Valid:Td,Error:nl},Md=Eg,Tg=Object.preventExtensions({Dtos:{},Utils:Object.freeze(Md),Match:Object.freeze({Modes:Object.freeze(hr)}),Events:Object.freeze(pe),Configs:Object.seal(A),Plugins:Object.seal({Ads:null,Audio:null,Analytics:null})});window.Ludex=Tg,window.TypeGuard=hc,window.GameName="Tile Connect Remaster",window.CommitId="f80c7a94-05c10d6f",window.BuildVersion=446,s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Be,Object:mt,String:ga,Json:Pa}=Ludex.Utils,Aa="is invalid",Ye={},$a=class ue{static loose={};static addDefaults(e){Be.isObject(e)||this.prototype.s("default data",Aa);let a=Pa.clone(e),{name:r}=this;Be.isObject(Ye[r])||(Ye[r]={});let n=Ye[r];Ye[r]=mt.merge(n,a)}static getDefaults(){let{name:e}=this;return Pa.clone(Ye[e])}static addValidator(e,a){Be.isString(e)||this.prototype.s("validate key",Aa),typeof a!="function"&&this.prototype.s("validate function",Aa);let r=`validate${ga.capitalize(e)}`;mt.assign(this.prototype,{[r]:a})}constructor(e){this.mr(e)}static makeStrict(){this.loose[this.name]=!1}static makeLoose(){this.loose[this.name]=!0}mr(e){Be.isObject(e)||this.s("input data","is not an object");let a=this.constructor.getDefaults(),r=mt.merge(a,e);this.js(r),this.J(r),this.c(r),this.X(r)}js(e){}Z(e){Be.isObject(e)||this.s("structure","is not an object");let a=this.oe(),r=Object.keys(e),{name:n}=this.constructor;if(!ue.loose[n]){let y=r.filter(g=>!a.includes(g));if(y.length>0&&Be.isObject(e))for(let g of y)mt.assign(e,{[g]:null})}for(let y of a)mt.hasOwn(e,y)||this.s("structure",`is missing key: ${y}`)}tt(e){let{name:a}=this.constructor;for(let r of this.oe()){let n=e[r],y=ga.removeDiacritics(r).replace(/[^a-zA-Z0-9]/g,""),g=`validate${ga.capitalize(y)}`,w=this[g];if(typeof w=="function")try{w.call(this,n)}catch(v){if(!ue.loose[a])throw v;let S=Ye[a]?.[r];S!==void 0&&Be.isObject(e)&&(e[r]=Pa.clone(S))}else ue.loose[a]||this.s("validator",`is missing for key '${r}'`)}}et(e){for(let a of this.oe())mt.assign(this,{[a]:e[a]})}s(e,a){throw new Error(`${this.constructor.name}: ${e} ${a}`)}toObject(){let e={};for(let a of this.oe())e[a]=this[a];return e}oe(){let{name:e}=this.constructor,a=Ye[e];return Be.isObject(a)?Object.keys(a):[]}},ee=$a;Ludex.Dtos={Base:ee},s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xa=class{codex;Ve;constructor(t){this.codex=t,this.Ve={}}install(t,e,a,r){if(typeof e!="function")return!1;let n=new e(this.codex);return this.Ve[t]=n,a&&Object.defineProperty(this.codex,r,{get:()=>n}),n.init(),!0}get(t){return this.Ve[t]}},Od=xa;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var wa=class{codex;constructor(t){this.codex=t}init(){}},_d=wa,ba=class{codex;plugins;ads;auth;audio;event;match;player;profile;context;storage;language;missions;analytics;visibility;leaderboard;dailyRewards;remoteConfig;frameCapture;firebase;monitorError;adaptivePerformance;inputRecorder;console;profiler;canvasRecorder;constructor(){this.codex=this,this.plugins=new Od(this.codex)}async boot(){}async start(){}getBuildVersion(){return 0}};window.Ludex.Plugins={BasePlugin:_d};var Nd=ba;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var va=class extends Error{payload;constructor(t,e){super(t),this.name="BadRequest",this.message=t??"This request is bad",this.payload=e}},kr=va;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Sa=class extends Error{payload;constructor(t,e){super(t),this.name="RequestTimeout",this.message=t??"This request is timeout",this.payload=e}},Rr=Sa,{Utils:{Valid:Mg,Time:Og},Configs:{AppId:kd,Network:Da}}=Ludex,_g=t=>{if(!t.ok)throw new kr(void 0,{response:t})},Rd=()=>{let t=codex.auth?.getToken();return{token:t,timeout:Da.Timeout,headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}},Gd=(t,e,a,r)=>async()=>{try{if(!kd)throw new kr("AppId is not defined");let n=`${t}/apps/${kd}/${e}`,y=new AbortController;a.signal=y.signal;let g=setTimeout(()=>{y.abort()},a.timeout);Mg.isObject(r)&&(a.body=JSON.stringify(r));let w=await fetch(n,a);return clearTimeout(g),_g(w),await w.json()||{}}catch(n){if(n instanceof kr)return null;throw n instanceof Object&&"name"in n&&n.name==="AbortError"?new Rr:n}},Ia=async(t,e)=>{try{return t()}catch(a){if(a instanceof Rr&&e>0)try{return await Og.sleepAsync(600),await Ia(t,e-1)}catch{return{}}return a instanceof Rr?{}:{}}},Ne=async(t,e,a,r=Da.Retries)=>{try{let n=de(T(T({},Rd()),e),{method:"GET"}),y=Gd(a,t,n);return await Ia(y,r)}catch{return{}}},me=async(t,e,a,r,n=Da.Retries)=>{try{let y=de(T(T({},Rd()),a),{method:"POST"}),g=Gd(r,t,y,e);return await Ia(g,n)}catch{return{}}},{Configs:{Notification:{ApiUrl:Ng}},Utils:{Object:kg}}=Ludex,Fd=async t=>{if(!kg.hasOwn(t,"playerId"))throw new Error("Missing playerId");let{playerId:e}=t;await me(`players/${e}`,t,{},Ng,10)};s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Rg={score:"score",settings:"settings",isFirstLogin:"isFirstLogin",gameData:"gameData",missionsData:"missionsData",notificationData:"notificationData",dailyRewardedData:"dailyRewardedData",lastCallSwitchGame:"lastCallSwitchGame",remoteConfig:"remoteConfig"},Bd=Rg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Gg={ASID:null,playerId:"0000",name:"Guest",photo:"",locale:"en_US",connectedPlayers:{},data:{score:0,isFirstLogin:!0,settings:{sound:!0,music:!0,vibrate:!0,language:"en"},gameData:{coins:0,level:1},notificationData:{D1:{arrivalDate:0},D2:{arrivalDate:0},D3:{arrivalDate:0},D4:{arrivalDate:0},D5:{arrivalDate:0},D6:{arrivalDate:0},D7:{arrivalDate:0}},missionsData:{process:{}},dailyRewardedData:{logDays:[],firstReward:0,lastReward:0},lastCallSwitchGame:0}},ge=Gg,{Valid:Gt}=Ludex.Utils,{playerId:Fg,name:Bg,photo:Vg,locale:Ug}=ge,Ft="is invalid",Gr=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateId(t){(!Gt.isString(t)||!t)&&this.s("_id",Ft)}validatePlayerId(t){(!Gt.isString(t)||!t)&&this.s("playerId",Ft)}validateName(t){(!Gt.isString(t)||!t)&&this.s("name",Ft)}validatePhoto(t){Gt.isString(t)||this.s("photo",Ft)}validateLocale(t){(!Gt.isString(t)||!t)&&this.s("locale",Ft)}toObject(){return super.toObject()}};Gr.addDefaults({playerId:Fg,name:Bg,photo:Vg,locale:Ug});var ft=Gr,Kg=new ft({playerId:"10",name:"Your Friend"}).toObject(),ie=Kg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var La=class extends Error{code;constructor(t){super(t),this.code="CREATE_MATCH_FAILED"}},te=La,Ca=class extends te{constructor(t){super(t),this.name="PlayerIdNotValid",this.message=t??"Player id is not valid"}},G=Ca,{Dtos:Ea,Utils:{Array:Hg,Object:jg,Json:Dse,Valid:Ta},Events:Wg,Configs:{Context:zg,Player:qg}}=Ludex,Ma=class{r;constructor(t){this.r=t}initContext=()=>{if(!zg.Enabled)return;let t={contextId:GameSDK.context.getID()??"",contextType:GameSDK.context.getType(),entryPointData:GameSDK.getEntryPointData()},e=new Ea.Context.Info(t),{contextId:a,contextType:r,entryPointData:n}=e.toObject();this.r.context.receiveContext(a,r,n)};initPlayer=async()=>{try{if(!qg.Enabled)return;let{player:t}=this.r,e=this.gr(),a=Hg.unique(jg.vals(Bd)),r=await GameSDK.player.getDataAsync(a),n=new Ea.Player.Data(r).toObject();t.receiveData(e,n)}catch{}finally{this.r.event.emit(Wg.PLAYER_INFO_LOADED)}};gr=()=>{try{let t=GameSDK.player.getID(),e=GameSDK.player.getName(),a=GameSDK.player.getPhoto(),r=GameSDK.getLocale();if(!Ta.isString(t))throw new G;return Ta.isString(e)||(e="You"),(!Ta.isString(r)||!r)&&(r="en"),new Ea.Player.Info({playerId:t,name:e,photo:a,locale:r}).toObject()}catch{return ie}}},Vd=Ma;pr(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ud=(t=>(t.IDLE="idle",t.LOADING="loading",t.FILLED="filled",t.SHOWING="showing",t))(Ud||{}),Fr=Ud;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Kd=(t=>(t.BANNER="banner",t.INTERSTITIAL="interstitial",t.REWARDED_VIDEO="rewarded_video",t.REWARDED_INTERSTITIAL="rewarded_interstitial",t))(Kd||{}),be=Kd;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Oa=class extends Error{code;constructor(t,e){super(e),this.code=t,this.message=e}},yt=Oa;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var _a=class{type;service;placementId;le;constructor(t,e){this.type=t,this.le=Fr.IDLE,this.placementId=e}setStatus(t){this.le!==t&&(this.le=t)}get status(){return this.le}s(t){throw new yt("AD_INSTANCE_ERROR",t)}},Hd=_a,Na=class extends Hd{loadAsync(){this.s("This method is not implemented")}showAsync(){this.s("This method is not implemented")}hideAsync(){this.s("Unsupported method")}},Br=Na;Ludex.Plugins.Ads={Types:be,Status:Fr,AdError:yt,AdInstance:Br};var{Utils:{Array:Vr,Object:jd,Function:Qg}}=Ludex,ka=class extends Ludex.Plugins.BasePlugin{enabled;yt;ce;he;de={};st;ue={failedAttempts:0,lastSuccessTime:0};init(){let t=Date.now()/1e3;this.ce={[be.BANNER]:t,[be.INTERSTITIAL]:t,[be.REWARDED_VIDEO]:t,[be.REWARDED_INTERSTITIAL]:t},this.he=!1,this.$e(),this.We()}$e(){try{let t=getComputedStyle(document.documentElement).getPropertyValue("--sab");this.st=parseInt(t,10),isNaN(this.st)&&(this.st=0)}catch{this.st=0}}configure(t){this.yt=t,this.enabled=this.yt.Enabled}Et(){if(!this.enabled)throw new yt("ADS_NOT_ENABLED","Ads is't enabled")}isAdFullSizeShowing(){return this.he}setAdInstance(t,e,a){let r=`${t}-${e}`;this.de[r]||(this.de[r]={type:t,placementId:e,interval:null,instance:new a(t,e)})}async loadAdAsync(t,e){this.Et();try{await this.getAd(t,e).instance.loadAsync()}catch(a){throw this.ue.failedAttempts++,a}}async showAdAsync(t,e){if(this.Et(),!this.canShowAd(t,e))return;let{event:a}=this.codex,r=this.getAd(t,e);try{a.emit(Ludex.Events.AD_SHOWING,{type:t,placementId:e}),this.he=!0,await r.instance.showAsync(),this.We(),this.ce[t]=Date.now()/1e3}catch(n){throw this.ue.failedAttempts++,n}finally{a.emit(Ludex.Events.AD_CLOSED,{type:t,placementId:e}),this.he=!1}}getAdStatus(t,e){return this.Et(),this.getAd(t,e).instance.status}getAd(t,e){let a=null;if(e?a=this.getAdByPlacementId(e,t):a=this.Ks(t),!a)throw new yt("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");return a}getAdsByType(t){return jd.vals(this.de).filter(e=>e.type===t)}getAdByPlacementId(t,e){let a=jd.vals(this.de);return Vr.search(a,n=>n.placementId===t&&(!e||n.type===e))||null}Ks(t){let e=this.getAdsByType(t);return e.length&&Vr.search(e,r=>r.type===t)||null}canShowAd(t,e){return this.fr(t,e)}fr(t,e){try{let a=Date.now()/1e3,r;if(e)r=this.Hs(e);else{let S=this.Ks(t);if(!S)return!1;r=this.Hs(S.placementId)}let{SecondsBetweenAds:n,SecondsFirstTime:y}=r,g=a-this.ce[t],w=g>n,v=g>y;return this.ce[t]>0?w:v}catch{return!1}}canShowBannerAd(t){try{let e=this.getBannerConfig(t),{Platform:a}=e;if(a==="ALL")return!0;let r=GameSDK.getPlatform();return r?r===a:!1}catch{return!1}}async showBannerAdAsync(t,e=!0){this.Et();let a=this.getAd(be.BANNER,t);if(!this.canShowBannerAd(a.placementId))throw new Error("Banner ad can not be shown");this.Vs(a),e?await this.$s(a):await this.Ws(a)}async Ws(t){let{event:e}=this.codex;if(!this.isAdFullSizeShowing())try{await t.instance.loadAsync(),await t.instance.showAsync(),e.emit(Ludex.Events.AD_SHOWING,{type:be.BANNER,placementId:t.placementId})}catch(a){let r=Qg.toError(a);if(r.code!=="AD_NOT_FILLED")try{await t.instance.hideAsync()}catch{}e.emit(Ludex.Events.AD_FAILED,{type:be.BANNER,placementId:t.placementId,error:r})}}async $s(t){await this.Ws(t);let e=this.getBannerConfig(t.placementId),{SecondsReload:a}=e;if(a<=0||!a)return;let r=()=>this.$s(t);t.interval=setTimeout(r,a*1e3)}async hideBannerAdAsync(t){this.Et();let e=this.getAd(be.BANNER,t);this.Vs(e),await e.instance.hideAsync();let{event:a}=this.codex;a.emit(Ludex.Events.AD_CLOSED,{type:be.BANNER,placementId:t})}Vs(t){try{let{interval:e}=t;if(!e)return;clearInterval(e)}catch{}}Hs(t){let e=[...this.yt.InterstitialAdOptions,...this.yt.RewardedVideoAdOptions,...this.yt.RewardedInterstitialAdOptions],a=Vr.search(e,r=>r.PlacementId===t);if(!a)throw new Error(`Ad config with placementId ${t} not found`);return a}getBannerConfig(t){let e=Vr.search(this.yt.BannerDisplayAdOptions,a=>a.PlacementId===t);if(!e)throw new Error(`Banner config with placementId ${t} not found`);return e}getBannerHeight(t,e,a=!0){this.Et();let r=this.getBannerConfig(t),n=GameSDK.getBannerHeight(r);return a?(this.st<=0&&this.$e(),(n+this.st)*e):n*e}getSafeAreaBottom(t){return this.st<=0&&this.$e(),this.st*t}We(){this.ue={failedAttempts:0,lastSuccessTime:Date.now()}}isServiceDegraded(){let t=Date.now(),{MaxFailedAttempts:e,ResetTimeMinutes:a}=this.yt.DegradationTracking,{lastSuccessTime:r,failedAttempts:n}=this.ue;return t-r>a*60*1e3&&this.We(),n>=e}},Wd=ka,zd=Wd;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Yg={APP_LAUNCH:"app_launch",APP_INITIALIZED:"app_initialized",ENGINE_READY:"engine_ready",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",PAGE_VIEW:"page_view",SCREEN_OPEN:"screen_open",BUTTON_CLICK:"button_click",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",USE_ITEM:"use_item",EARN_ITEM:"earn_item",GET_FREE_ITEM:"get_free_item",SHARE:"share",INVITE:"invite",MESSAGE:"message",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_INIT:"ad_init",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOWING:"ad_showing",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",AD_REWARD:"ad_reward",NEW_USER:"new_user",RETURNING_USER:"returning_user",JOIN_GROUP:"join_group",TOURNAMENT_START:"tournament_start",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",SWITCH_GAME_POPUP:"switch_game_popup",SWITCH_GAME:"switch_game"},I=Yg;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ra=class{M=[];Mt=[];ze=[];qe=!1;Ye=!1;zs=[];Gt=!1;qs=!1;addEvent(t,e){if(this.qe||this.Ye){this.wr("Skip event:",t);return}this.M.push(t),this.Ar(t)}Ar(t){let e=this.vr();if(e.hasFailed){this.Ye=!0,this.Ir();return}e.hasWarnings&&this.Sr(e.warnings),this.Dr(t)}vr(){let t={hasFailed:!1,hasWarnings:!1,warnings:[]},e=this.Er().filter(r=>r.l);for(let r=0;r<e.length;r++){let n=e[r],y=this.M.indexOf(n.name);if(y===-1)return this.Mt=[n.name],t.hasFailed=!0,t;if(r>0){let g=e[r-1];if(this.M.indexOf(g.name)>y)return this.Mt=[g.name],t.hasFailed=!0,t}}let a=this.xr();return a.length>0&&(t.hasWarnings=!0,t.warnings=a,this.ze=a),t}Er(){let t=this.M[this.M.length-1],e=this.k.findIndex(a=>a.name===t);return this.k.slice(0,e+1)}xr(){let t=[];return this.M.forEach((e,a)=>{let r=this.k.find(y=>y.name===e);if(!r?.w?.length)return;let n=r.w.find(y=>!this.M.includes(y)||this.M.indexOf(y)>a);n&&!this.zs.includes(e)&&(t.push({event:e,missingDependency:n}),this.zs.push(e))}),t}Dr(t){let e=this.k[this.k.length-1];t===e.name&&this.k.filter(a=>a.l).every(a=>this.M.includes(a.name))&&(this.qe=!0,this.br())}Sr(t){for(let e of t);}Ir(){let t=this.constructor.name;if(this.Mt.length,this.qs)throw new Error(`[${t}] Funnel is required to be completed ! (missing: ${this.Mt.join(", ")})`)}br(){let t=this.constructor.name,e=this.ze.length>0}wr(...t){this.Gt}isFunnelCompleted(){return this.qe}isFunnelFailed(){return this.Ye}getEventHistory(){return[...this.M]}getMissingEvents(){return[...this.Mt]}getOutOfOrderEvents(){return[...this.ze]}},Ie=Ra,Ga=class extends Ie{Gt=!1;k=[{name:I.AD_INIT,l:!0,t:{service:"adsense"},h:"Init adsense ad"},{name:I.AD_LOAD_FAILED,l:!1,t:{service:this.service},h:"Platform ad load failed (trigger for adsense)"},{name:I.AD_LOAD,l:!0,t:{service:"adsense"},h:"Start loading adsense ad"},{name:I.AD_LOAD_FAILED,l:!1,w:[I.AD_LOAD],t:{service:"adsense"},h:"Adsense ad load failed"},{name:I.AD_SHOWING,l:!0,w:[I.AD_LOAD],t:{service:"adsense"},h:"Adsense ad is showing"},{name:I.AD_SHOW,l:!1,w:[I.AD_SHOWING],t:{service:"adsense"},h:"Adsense ad shown successfully"},{name:I.AD_SHOW_FAILED,l:!1,w:[I.AD_SHOWING],t:{service:"adsense"},h:"Adsense ad show failed"},{name:I.AD_LOAD,l:!1,t:{service:"adsense"},h:"Preload adsense ad"}];get service(){return GameSDK?.getSDKName()??"Ludex"}addEvent(t,e){let{service:a}=e??{};!a||!(a==="adsense"||t===I.AD_LOAD_FAILED&&a==="platform")||super.addEvent(t,e)}},qd=Ga;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Fa=class extends Ie{Gt=!1;qs=!1;k=[{name:I.ENGINE_READY,l:!1,h:"Game engine initialized"},{name:I.APP_LAUNCH,l:!0,h:"Application launched"},{name:I.APP_INITIALIZED,l:!0,w:[I.APP_LAUNCH],h:"Application initialized"},{name:I.LOAD_START,l:!0,w:[I.APP_INITIALIZED],h:"Start loading game assets"},{name:I.LOAD_COMPLETE,l:!0,w:[I.LOAD_START],h:"Game assets loaded completely"},{name:I.APP_READY,l:!0,w:[I.LOAD_COMPLETE],h:"Game is ready to play"}]},Qd=Fa;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ba=class extends Ie{Gt=!1;k=[{name:I.AD_INIT,l:!0,t:{service:this.service},h:"Init platform ad"},{name:I.AD_LOAD,l:!0,t:{service:this.service},h:"Start loading platform ad"},{name:I.AD_LOAD_FAILED,l:!1,w:[I.AD_LOAD],t:{service:this.service},h:"Platform ad load failed"},{name:I.AD_SHOWING,l:!0,w:[I.AD_LOAD],t:{service:this.service},h:"Platform ad is showing"},{name:I.AD_SHOW,l:!1,w:[I.AD_SHOWING],t:{service:this.service},h:"Platform ad shown successfully"},{name:I.AD_SHOW_FAILED,l:!1,w:[I.AD_SHOWING],t:{service:this.service},h:"Platform ad show failed"},{name:I.AD_LOAD,l:!1,t:{service:this.service},h:"Preload platform ad"}];get service(){return"platform"}addEvent(t,e){e?.service===this.service&&super.addEvent(t,e)}},Yd=Ba;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Match:{Modes:gt}}=Ludex,Va=class extends Ie{Gt=!1;k=[{name:I.MATCH_START,l:!0,t:{game_mode:gt.SINGLE},h:"Match started"},{name:I.LEVEL_START,l:!0,w:[I.MATCH_START],t:{game_mode:gt.SINGLE},h:"Level started"},{name:I.LEVEL_RESCUE,l:!1,w:[I.LEVEL_START],t:{game_mode:gt.SINGLE},h:"User was rescued"},{name:I.LEVEL_END,l:!0,w:[I.LEVEL_START],t:{game_mode:gt.SINGLE},h:"Level ended"},{name:I.MATCH_END,l:!0,w:[I.LEVEL_START],t:{game_mode:gt.SINGLE},h:"Match ended"}];addEvent(t,e){let{game_mode:a}=e??{};!a||a.toLowerCase()!==gt.SINGLE||super.addEvent(t,e)}},Jd=Va;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Utils:{String:Je,Valid:Jg}}=Ludex,Ua=class{codex;name;Pr;R;Ys;Lr;constructor(t,e,a){this.codex=t,this.name=e,this.R=a,this.Pr=a.color||"#FFF",this.Ys=a.log,this.Lr="/"}event(t,e){this._r("event",{name:t,payload:e});let a=this.Or(t);this.Qs(a,e)}_r(t,e){this.Ys}pageview(t){let e=this.Cr(t);e=this.Nr(e),document.title=e,this.event(I.PAGE_VIEW,{page_path:t,page_title:e})}levelStart(t,e,a){this.event(I.LEVEL_START,{level:t,score:e,level_name:this.getLevelName(t),game_mode:a?Je.toUpperCamelCase(a):void 0})}levelFail(t,e,a){this.event(I.LEVEL_END,{level:t,score:e,success:!1,level_name:this.getLevelName(t),game_mode:a?Je.toUpperCamelCase(a):void 0})}levelRescue(t,e,a){this.event(I.LEVEL_RESCUE,{level:t,score:e,level_name:this.getLevelName(t),game_mode:a?Je.toUpperCamelCase(a):void 0})}levelComplete(t,e,a){this.event(I.LEVEL_END,{level:t,score:e,success:!0,level_name:this.getLevelName(t),game_mode:a?Je.toUpperCamelCase(a):void 0})}initAdEvent(t){let{adService:e,state:a}=t;this.event(I.AD_INIT,{ad_service:e,state:a})}Qe(t){let{type:e,placement:a,service:r}=t;this.event(I.AD_LOAD,{ad_type:e,screen_name:a,ad_service:r})}Je(t){let{type:e,placement:a,service:r}=t;this.event(I.AD_SHOW,{ad_type:e,screen_name:a,ad_service:r})}loadInterstitialAd(t){let{placement:e,service:a}=t;this.Qe({type:"interstitial",placement:e,service:a})}showInterstitialAd(t){let{placement:e,service:a}=t;this.Je({type:"interstitial",placement:e,service:a})}loadRewardedVideoAd(t){let{placement:e,service:a}=t;this.Qe({type:"rewarded_video",placement:e,service:a})}showRewardedVideoAd(t){let{placement:e,service:a}=t;this.Je({type:"rewarded_video",placement:e,service:a})}receiveVideoReward(t){let{placement:e,service:a}=t;this.event(I.AD_REWARD,{screen_name:e,ad_service:a})}loadRewardedInterstitialAd(t){let{placement:e,service:a}=t;this.Qe({type:"rewarded_interstitial",placement:e,service:a})}showRewardedInterstitialAd(t){let{placement:e,service:a}=t;this.Je({type:"rewarded_interstitial",placement:e,service:a})}receiveInterstitialReward(t){let{placement:e,service:a}=t;this.event(I.AD_REWARD,{screen_name:e,ad_service:a})}loadAdFail(t){let{type:e,placement:a,service:r}=t;this.event(I.AD_LOAD_FAILED,{ad_type:e,screen_name:a,ad_service:r})}showAdFail(t){let{type:e,placement:a,service:r}=t;this.event(I.AD_SHOW_FAILED,{ad_type:e,screen_name:a,ad_service:r})}showingAd(t){let{type:e,placement:a,service:r}=t;this.event(I.AD_SHOWING,{ad_type:e,screen_name:a,ad_service:r})}Or(t){return t.toLowerCase().replace(/:/g,"_")}getLevelName(t){return`Level ${Je.padStart(t.toString(),5,"0")}`}Cr(t){let e=t.split("/").pop();if(!Jg.isString(e))return t;let a=e.replace(/([-_\s.])/g," $1");return Je.toUpperCamelCase(a)}Nr(t){let{match:e}=this.codex;if(!e)return t;let a=e.getMatchState(),{mode:r}=a;return r||(r="Normal"),`${Je.toUpperCamelCase(r)}::${t}`}},Xd=Ua;Ludex.Plugins.Analytics={Events:I,BaseFunnel:Ie,BaseAnalytics:Xd};var Ka=class extends Ludex.Plugins.BasePlugin{u=[];b="unknown";Js=[];constructor(t){super(t),this.Tr()}C(t,e){let{Utils:{Object:a}}=Ludex;return a.merge(t,e)}add(t){let e=this.u.findIndex(a=>a.name===t.name);e!==-1?this.u[e]=t:this.u.push(t)}f(){return this.u.length>=1}Tr(){this.addFunnel(new Qd),this.addFunnel(new qd),this.addFunnel(new Yd),this.addFunnel(new Jd)}addFunnel(t){this.Js.push(t)}A(t,e){for(let a of this.Js)a.addEvent(t,e)}pageview=t=>{if(!this.f())return;this.b=t;let e=this.Rr(t);for(let a of this.u)a.pageview(e);this.A(I.PAGE_VIEW)};event(t,e){if(this.f()){for(let a of this.u)a.event(t,e);this.A(t,e)}}levelStart(t,e,a){if(this.f()){for(let r of this.u)r.levelStart(t,e,a);this.A(I.LEVEL_START,{score:e,game_mode:a})}}levelRescue(t,e,a){if(this.f()){for(let r of this.u)r.levelRescue(t,e,a);this.A(I.LEVEL_RESCUE,{score:e,game_mode:a})}}levelFail(t,e,a){if(this.f()){for(let r of this.u)r.levelFail(t,e,a);this.A(I.LEVEL_END,{score:e,game_mode:a})}}levelComplete(t,e,a){if(this.f()){for(let r of this.u)r.levelComplete(t,e,a);this.A(I.LEVEL_END,{score:e,game_mode:a})}}async initAdEvent(t){if(this.f()){await new Promise(e=>{let{Events:a}=Ludex;this.codex.event.catchUp(a.GAME_READY,e)});for(let e of this.u)e.initAdEvent(t)}}loadInterstitialAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.loadInterstitialAd(e);this.A(I.AD_LOAD,e)}showInterstitialAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.showInterstitialAd(e);this.A(I.AD_SHOW,e)}loadRewardedVideoAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.loadRewardedVideoAd(e);this.A(I.AD_LOAD,e)}showRewardedVideoAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.showRewardedVideoAd(e);this.A(I.AD_SHOW,e)}receiveVideoReward(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.receiveVideoReward(e);this.A(I.AD_REWARD,e)}loadRewardedInterstitialAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.loadRewardedInterstitialAd(e);this.A(I.AD_LOAD,e)}showRewardedInterstitialAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.showRewardedInterstitialAd(e);this.A(I.AD_SHOW,e)}receiveInterstitialReward(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.receiveInterstitialReward(e);this.A(I.AD_REWARD,e)}loadAdFail(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.loadAdFail(e);this.A(I.AD_LOAD_FAILED,e)}showAdFail(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.showAdFail(e);this.A(I.AD_SHOW_FAILED,e)}showingAd(t){if(!this.f())return;let e=this.C(t,{placement:this.b});for(let a of this.u)a.showingAd(e);this.A(I.AD_SHOWING,e)}Rr(t){let e=t;if(e.indexOf("_")>-1){let n=e.replace(/_/g,"-");return n=n.toLowerCase(),n}let a=e.length-1,r="";for(;a>0;){r=e.charAt(a);let n=isNaN(parseInt(r,10)),y=r===r.toUpperCase();n&&y&&(e=`${e.slice(0,a)}-${e.slice(a)}`),a--}return e.toLowerCase()}},Zd=Ka,eu=Zd;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ha=class{Xs;constructor(t){this.Xs=t}getKey(){return this.Xs}},tu=Ha;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Decorator:ru}=Ludex.Utils,Ur=class{ct;Ut;kt;xt;constructor(t){this.ct=t,this.kt=1,this.Ut=!1,this.xt={}}getId(){return this.ct}getAudioClip(t){return this.xt[t]?this.xt[t]:null}setAudioClip(t,e){this.xt[t]=T(T({},this.xt[t]),e)}async play(t,e){let a=this.getAudioClip(t);if(a){let{audioPlayer:r}=a;this.Zs(r,e)}else await this.loadAndPlay(t,e)}async loadAndPlay(t,e){let a=await this.onLoadAudio(t,e);if(!a)return;let{volume:r=1}=e||{};this.setAudioClip(t,{volume:r,audioPlayer:a}),this.Zs(a,e)}Zs(t,e){if(e){let{volume:a=1}=e;e.volume=this.kt*a}t.play(e)}pause(t){let e=this.getAudioClip(t);if(!e)return!1;let{audioPlayer:a}=e;return a.pause(),!0}resume(t){let e=this.getAudioClip(t);if(!e)return!1;let{audioPlayer:a}=e;return a.resume(),!0}stop(t){let e=this.getAudioClip(t);if(!e)return!1;let{audioPlayer:a}=e;return a.stop(),!0}stopAll(){this.ye("stop")}muteAll(){this.Ut||(this.Ut=!0,this.ye("mute"))}unmuteAll(){this.Ut&&(this.Ut=!1,this.ye("unmute"))}setVolume(t){this.kt=t,this.ye("setVolume")}getVolume(){return this.kt}Mr(t,e){try{let{audioPlayer:a,volume:r=1}=t;switch(e){case"play":a.play();break;case"pause":a.pause();break;case"resume":a.resume();break;case"stop":a.stop();break;case"mute":a.setVolume(0);break;case"unmute":case"setVolume":a.setVolume(this.kt*r);break;default:throw new Error(`Unsupported function: ${e}`)}}catch{}}ye(t){let{Object:e}=Ludex.Utils,a=e.vals(this.xt);for(let r of a)this.Mr(r,t)}};se([ru.tryCatch(),ru.validateParams("string")],Ur.prototype,"loadAndPlay",1);var nu=Ur;Ludex.Plugins.Audio={BaseAudioPlayer:tu,BaseChannelManager:nu};var{Decorator:au}=Ludex.Utils,Kr=class extends Ludex.Plugins.BasePlugin{Xe;Ze={};addChannel(t){let e=t.getId();this.Ze[e]=t,this.Xe||(this.Xe=e)}F(t){if(t===void 0)return this.Ze[this.Xe];let e=this.Ze[t];if(!e)throw new Error(`Channel ${t} not found`);return e}async play(t,e,a){await this.F(a).play(t,e)}pause(t,e){try{this.F(e).pause(t)}catch{}}resume(t,e){try{this.F(e).resume(t)}catch{}}stop(t,e){try{this.F(e).stop(t)}catch{}}stopAll(t){try{this.F(t).stopAll()}catch{}}mute(t){try{this.F(t).muteAll()}catch{}}unmute(t){try{this.F(t).unmuteAll()}catch{}}setVolume(t,e){try{this.F(e).setVolume(t)}catch{}}getVolume(t){try{return this.F(t).getVolume()}catch{return-1}}};se([au.tryCatch(),au.validateParams("string")],Kr.prototype,"play",1);var su=Kr,ou=su;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Xg={token:"",isRequesting:!1},iu=Xg,{Utils:{Object:Zg}}=Ludex,ja=class extends Ludex.Plugins.BasePlugin{init(){let{storage:t}=this.codex;t.addStorage("auth",iu)}async requestToken(){let{storage:t}=this.codex;try{if(t.getStorageData("auth","isRequesting")||t.getStorageData("auth","token")!=="")return;t.setStorageData("auth","isRequesting",!0);let e=(await GameSDK.player.getSignedPlayerInfoAsync()).getSignature();t.setStorageData("auth","token",e)}catch(e){if(Zg.hasOwn(e,"code")&&e.code==="PENDING_REQUEST")return;t.setStorageData("auth","token","")}finally{t.setStorageData("auth","isRequesting",!1)}}getToken(){let{storage:t}=this.codex;return t.getStorageData("auth","token")??""}},cu=ja,lu=cu;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var du=(t=>(t.SOLO="solo",t.TOURNAMENT="tournament",t.SHARE_INVITE="share_invite",t.MATCHING_GROUP="matching_group_match",t.CHALLENGE_FRIEND="challenge_friend_match",t))(du||{}),ve=du;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var eP=hr,ke=eP,{Configs:tP,Utils:{Array:rP,Valid:nP,Browser:aP}}=Ludex,Wa=class{r;constructor(t){this.r=t}Gr(t){return["THREAD","POST","SOLO","GROUP"].indexOf(t)>=0}Ur(t){return nP.isObject(t)}kr(t){return rP.has(["facebook~game_list~tournaments","fb_feed_tournament_unit","messenger~bot_thread~tournaments"],t)}receiveContext(t,e,a){let{storage:r}=this.r;r.setStorageData("context","contextId",t),this.Ur(a)&&r.setStorageData("context","entryPointData",a),this.Gr(e)&&r.setStorageData("context","contextType",e)}getContextId(){let{storage:t}=this.r;return t.getStorageData("context","contextId")??""}getContextType(){let{storage:t}=this.r;return t.getStorageData("context","contextType")??"SOLO"}getContextData(){let{storage:t}=this.r;return t.getStorageData("context","entryPointData")??{}}getSessionContextType(){let{storage:t}=this.r;return t.getStorageData("context","sessionContextType")??"unknown"}async detectContextSessionType(){let{storage:t}=this.r,e=this.getContextData(),{type:a}=e??{},{SOLO:r,TOURNAMENT:n,MATCHING_GROUP:y,SHARE_INVITE:g,CHALLENGE_FRIEND:w}=ve,v=r;a===n&&(v=n),a===y&&(v=y),(a===w||a===g)&&(v=w),v===r&&(tP.Core.FastCheckTournamentContext?v=this.Fr()||v:v=await this.Br()||v),t.setStorageData("context","sessionContextType",v)}Fr(){let t=aP.getQueryParams().entry_point;return typeof t!="string"||!this.kr(t)?!1:ve.TOURNAMENT}async Br(){let{storage:t}=this.r;if(!("getTournamentAsync"in GameSDK))return!1;try{let e=await GameSDK.getTournamentAsync();return t.setStorageData("context","contextId",e.getContextID()),e.getEndTime()>Date.now()/1e3?ve.TOURNAMENT:!1}catch{return!1}}detectContextGameMode(){let{player:t,storage:e}=this.r,a=this.getContextData(),r=this.getSessionContextType(),n=t.getPlayerId(),{matchId:y,playerId:g,opponentId:w=ie.playerId}=a??{},v=n===g,S=w===ie.playerId||[w,g].indexOf(n)>=0,{TOURNAMENT:D,MATCHING_GROUP:x,SHARE_INVITE:b,CHALLENGE_FRIEND:_}=ve,M=ke.SINGLE;r===D&&(M=ke.TOURNAMENT),r===b&&!v&&(M=ke.CHALLENGE_FRIEND),r===_&&y&&S&&(M=ke.CHALLENGE_FRIEND),r===x&&(M=ke.MATCHING_GROUP),e.setStorageData("context","contextGameMode",M)}},uu=Wa;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var za=class extends Error{constructor(t){super(t),this.name="PlayerHasFinishedMatch",this.message=t??"Player has finished match"}},Hr=za;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var qa=class extends Error{constructor(t){super(t),this.name="PlayerNotJoinInMatch",this.message=t||"Player is not join in match"}},Pt=qa,{Events:jr,Plugins:{Analytics:pu},Utils:{Valid:sP}}=Ludex,Qa=class{r;constructor(t){this.r=t}async processContextData(){let{player:t,context:e}=this.r,a=e.getContextId(),r=e.getContextData(),n=e.getSessionContextType(),{type:y,matchId:g,playerId:w,opponentId:v,playerScore:S,action:D}=r;D&&await this.jr(D);let x=t.isFirstSession();setTimeout(()=>{this.Kr(x)},1e3);let{TOURNAMENT:b,SHARE_INVITE:_,MATCHING_GROUP:M,CHALLENGE_FRIEND:B}=ve;if(n===b)try{await this.Hr(a);return}catch{}if(n===B){if(y===_&&typeof w=="string"){await this.Vr(w);return}if(y===B&&typeof g=="string"&&typeof w=="string"&&typeof v=="string"){await this.$r({contextId:a,matchId:g,playerId:w,opponentId:v});return}}if(n===M&&typeof w=="string"&&typeof S=="number"){await this.Wr(w,S);return}if(x){await this.zr(!0),t.loggedIn();return}this.Ft()}Kr(t){try{let{player:e,analytics:a}=this.r;if(t)a?.event(pu.Events.NEW_USER);else{let{coins:r}=e.getPlayerData().gameData;a?.event(pu.Events.RETURNING_USER,{coins:r})}}catch{}}async jr(t){try{let{player:e}=this.r;switch(t){case"reset_data":e.setPlayerDataByName("score",0),e.setGameData({coins:0,level:1}),await e.syncProfileToServer();break;case"enable_debug":e.setPlayerDataByName("debug",!0);break;case"set_locale_en":this.ta("en");break;case"set_locale_ru":this.ta("ru");break}}catch{}}ta(t){let{event:e}=this.r;e.emit(jr.REQUEST_LANGUAGE,{locale:t})}async Hr(t){let{match:e,player:a}=this.r,r=a.getPlayerId();if(sP.isEmpty(t))throw new Error("Cannot get contextId");await e.tournament.continue.processAsync({playerId:r,contextId:t}),this.bt()}async Vr(t){let{match:e,player:a}=this.r,r=a.getPlayerId();if(r===t)await e.single.start.processAsync({playerId:r});else try{await e.challenge.friend.processAsync({playerId:r,opponentId:t})}catch{await e.single.start.processAsync({playerId:r})}this.bt()}async $r(t){try{await this.qr(t)}catch(e){if(e instanceof Hr){await this.Yr(t);return}if(e instanceof Pt){await this.Qr(t);return}this.Ft()}}async qr(t){let{contextId:e,matchId:a,playerId:r,opponentId:n}=t,{match:y,player:g}=this.r,w=g.getPlayerId();if(r===w)await y.challenge.continue.processAsync({contextId:e,matchId:a,playerId:w,opponentId:n});else{let v=n===ie.playerId;await y.challenge.continue.processAsync({contextId:e,matchId:a,playerId:w,opponentId:v?n:r})}this.bt()}async Qr(t){let{contextId:e,matchId:a,playerId:r}=t,{match:n,player:y}=this.r,g=y.getPlayerId();await n.challenge.join.processAsync({contextId:e,matchId:a,playerId:g,opponentId:r}),this.bt()}async Yr(t){let{contextId:e,matchId:a,playerId:r}=t,{match:n,player:y}=this.r,g=y.getPlayerId();try{await n.challenge.await.processAsync({contextId:e,matchId:a,playerId:g,opponentId:r}),this.ea()}catch{await this.Jr(t)}}async Jr(t){let{contextId:e,matchId:a,playerId:r}=t,{match:n,player:y}=this.r,g=y.getPlayerId();try{await n.challenge.result.processAsync({contextId:e,matchId:a,playerId:g,opponentId:r}),this.ea()}catch{this.Ft()}}async Wr(t,e){let{match:a,player:r}=this.r;await a.group.join.processAsync({playerId:r.getPlayerId(),opponentId:t,opponentScore:e}),this.bt()}async zr(t){let{match:e,player:a}=this.r,r=a.getPlayerId();t&&await e.handler.setMatchCustomData({playerId:r,contextId:"SOLO"}),await e.single.start.processAsync({playerId:r}),this.bt()}Ft(){let{event:t}=this.r;t.emit(jr.SWITCH_SCENE,{sceneName:"DashboardScene",sceneData:{isFromLoader:!0}})}bt(){let{event:t}=this.r;t.emit(jr.SWITCH_SCENE,{sceneName:"GameScene",sceneData:{isFromLoader:!0}})}ea(){let{event:t}=this.r;t.emit(jr.SWITCH_SCENE,{sceneName:"ChallengeResultScene",sceneData:{isFromLoader:!0}})}},hu=Qa;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var oP={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},contextGameMode:"",sessionContextType:""},Wr=oP,{Events:zr,Utils:{Function:mu}}=Ludex,Ya=class extends Ludex.Plugins.BasePlugin{o;sa;constructor(t){super(t),this.sa=new hu(t),this.o=new uu(t)}init(){let{storage:t}=this.codex;t.addStorage("context",Wr)}getSessionContextTypes(){return ve}async processContextData(){let{event:t,monitorError:e}=this.codex;t.catchUp(zr.CONTEXT_SESSION_TYPE_DETECTED,async()=>{try{await this.sa.processContextData(),t.emit(zr.CONTEXT_DATA_PROCESSED)}catch(a){this.Ft(),e?.sendException(mu.toError(a))}})}async detectContextSessionType(){let{event:t,monitorError:e}=this.codex;try{await this.o.detectContextSessionType()}catch(a){e?.sendException(mu.toError(a))}finally{t.emit(zr.CONTEXT_SESSION_TYPE_DETECTED)}}detectContextGameMode(){this.o.detectContextGameMode()}receiveContext(t,e,a){this.o.receiveContext(t,e,a)}getContextId(){return this.o.getContextId()}getContextType(){return this.o.getContextType()}getContextData(){return this.o.getContextData()}getSessionContextType(){return this.o.getSessionContextType()}Ft(){let{event:t}=this.codex;t.emit(zr.SWITCH_SCENE,{sceneName:"DashboardScene"})}},fu=Ya;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Ja}=Ludex.Utils,{contextId:iP,contextType:cP,entryPointData:lP}=Wr,Xa="is invalid",qr=class extends ee{pe;X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateContextId(t){Ja.isString(t)||this.s("contextId",Xa)}validateContextType(t){(!Ja.isString(t)||!t)&&this.s("contextType",Xa)}validateEntryPointData(t){Ja.isObject(t)||this.s("entryPointData",Xa)}toObject(){return super.toObject()}};qr.addDefaults({contextId:iP,contextType:cP,entryPointData:lP});var yu=qr;Ludex.Dtos.Context={Info:yu};var gu=fu;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var $u=Xh(Au(),1),xu=$u.default,pP=new xu,Ve=pP;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var hP={names:[],history:[]},wu=hP,{Utils:{Decorator:Ue,Array:mP}}=Ludex,Se=class extends Ludex.Plugins.BasePlugin{aa=!1;ts=[];init(){let{storage:t}=this.codex;t.addStorage("event",wu)}enableLogEvent(){this.aa=!0}on(t,e){this.ra(t),this.Bt(t,"on","listening"),Ve.on(t,e)}once(t,e){this.ra(t),this.Bt(t,"once","listening"),Ve.once(t,e)}waitTo(t,e){return new Promise((a,r)=>{let n,y=g=>{clearTimeout(n),a(g)};this.once(t,y),e&&e>0&&(n=setTimeout(()=>{this.off(t,y),r(new Error(`Event ${t} timeout`))},e))})}catchUp(t,e){if(this.once(t,e),!(this.getEventEmitCount(t)>0))return;let{payload:a}=this.getLastEventInfo(t)??{};this.emit(t,a)}off(t,e){Ve.off(t,e),this.Bt(t,"action","removed")}mute(t){this.ts.indexOf(t)>-1||this.ts.push(t)}clear(t){Ve.removeAllListeners(t),this.Bt(t,"action","removed")}emit(t,e){if(this.ts.indexOf(t)>-1)return;let a=[];e&&(a=[e]),this.Bt(t,"action","called",e),Ve.emit(t,...a)}ra(t){let{storage:e}=this.codex,a=e.getStorageData("event","names");a&&a.indexOf(t)<0&&a.push(t)}Xr(t){return t.length<=1e3?t:mP.limit(t,1e3)}getEventListeners(t){return this.getHistory().filter(e=>e.name===t&&e.status==="listening").map(e=>e.name)}getHistory(){let{storage:t}=this.codex,e=t.getStorageData("event","history")??[];return this.Xr(e)}getEventEmitCount(t){return this.getHistory().filter(e=>e.name===t&&e.status==="called").length}getLastEventInfo(t){let e=this.getHistory(),a=null;for(let r=e.length-1;r>=0;r--)if(e[r].name===t){a=e[r];break}return a}Zr(t){return this.getLastEventInfo(t)?.type??null}tn(t){return this.getLastEventInfo(t)?.called??0}Bt(t,e,a,r){let n=this.Zr(t)??e,y=this.tn(t),g=a==="called"?y+1:y;this.getHistory().push({type:n,status:a,name:t,called:g,payload:r??{}}),this.en(t,n,a,g)}en(t,e,a,r){this.aa&&(a==="listening"&&Ve.listenerCount(t)>1,a==="called"&&Ve.listenerCount(t)<=0)}};se([Ue.validateParams("string","function")],Se.prototype,"on",1),se([Ue.validateParams("string","function")],Se.prototype,"once",1),se([Ue.validateParams("string")],Se.prototype,"waitTo",1),se([Ue.validateParams("string","function")],Se.prototype,"catchUp",1),se([Ue.validateParams("string","function")],Se.prototype,"off",1),se([Ue.validateParams("string")],Se.prototype,"mute",1),se([Ue.validateParams("string")],Se.prototype,"clear",1),se([Ue.validateParams("string")],Se.prototype,"emit",1);var bu=Se,vu=bu;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Su='nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',{Configs:{FrameCapture:{Enabled:fP,Options:es}},Utils:{Browser:yP,Image:Yr,Object:Vt,Valid:Ut}}=Ludex,ts=class extends Ludex.Plugins.BasePlugin{es;ss;P=null;o=null;as=null;me={};rs={};async preloadAsync(t){let{renderOptions:e}=t;await this.na(e)}async captureAsync(t){let{width:e,height:a,renderOptions:r}=t;return await this.na(r),this.es=e,this.ss=a,this.sn(),this.an(r),this.rn()}async renderAsync(t,e){if(!fP)return null;let a=this.rs[t];if(a===void 0)throw new Error(`Renderer ${t} has not been set`);return await a(e)}setRenderer(t,e){this.rs[t]=e}unsetRenderer(t){delete this.rs[t]}setTestRenderOptions(t){if(!t){this.as=null;return}let e=Vt.camelCaseKeys(t);this.as=Vt.merge(this.as,e)}sn(){if(!this.P){let t=yP.createCanvas({type:"canvas",contextAttributes:{alpha:!1,desynchronized:!0,willReadFrequently:!0},contextType:"2d"});this.P=t?.canvas,this.o=t?.context}if(!this.P)throw new Error("Failed to create canvas");this.o&&this.o.clearRect(0,0,this.es,this.ss),this.P.width=this.es,this.P.height=this.ss}async na(t){let e=this.nn(t),a=this.ln(e),r=Vt.vals(a);if(r.length<1)return;let n=await Promise.all(r);this.cn(a,n)}nn(t){let e=Vt.vals(t).filter(a=>a.type==="image");for(let a of e){let{name:r,image:n,fallbackImage:y}=a,g=Ut.isString(n)&&n!=="";if(!r){let w=g?n:y;w&&(a.name=w)}!g&&y&&(a.image=y)}return e}ln(t){let e={};for(let a of t){let{name:r,image:n,fallbackImage:y}=a,g=this.me[r];!Ut.isString(n)||g||(n===""&&Ut.isString(y)&&(a.image=y),e[r]=new Promise(w=>{Yr.loadImage(n).then(v=>{w(v)}).catch(()=>{Ut.isString(y)?(a.image=y,Yr.loadImage(a.image).then(v=>{w(v)}).catch(()=>{w(null)})):w(null)})}))}return e}cn(t,e){for(let a in t){let r=e.shift();r&&(this.me[a]=r)}}an(t){let e=Vt.vals(t).sort((a,r)=>a.depth-r.depth);for(let a of e)switch(a.type){case"text":this.hn(a);break;case"image":this.dn(a);break}}hn(t){if(!this.P||!this.o)return;let{position:e,font:a,text:r,color:n,lineWidth:y,textAlign:g}=t;this.o.font=`${a} ${Su}`,this.o.fillStyle=n??"#ffffff",y&&(this.o.lineWidth=y),g&&(this.o.textAlign=g);let[w,v]=e;this.o.fillText(r,w,v)}dn(t){if(!this.P||!this.o)return;let{name:e,size:a,position:r,fallbackImage:n}=t,y=this.me[e];if(!y&&n&&(y=this.me[n]),!y)throw new Error(`Image ${e} not found`);let[g,w]=r,[v,S]=a;this.o.drawImage(y,g,w,v,S)}async rn(){if(!this.P)return null;let t=null;if(es.UseBlobIfPossible&&"toBlob"in this.P?t=await this.un():t=this.yn(),!t)throw new Error("Image data is null");return Ut.isDebugger()&&Yr.logImage(t),t}yn(){if(!this.P||!this.o)return null;let{Quality:t,RenderType:e}=es;return this.o.canvas.toDataURL(`image/${e}`,t)}un(){return new Promise(t=>{if(!this.P){t(null);return}let{Quality:e,RenderType:a}=es;this.P.toBlob(r=>{if(!r){t(null);return}Yr.blobToDataImage(r).then(n=>{t(n)})},`image/${a}`,e)})}},Du=ts,Iu=Du;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var rs=class extends Error{locale;constructor(t){super(`Locale "${t}" not found`),this.name="LocaleNotFoundError",this.locale=t}},Jr=rs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ns=class extends Error{key;locale;constructor(t,e){let a=String(t);super(`Text with key "${a}" not found in locale "${e}"`),this.name="MissingKeyInLocaleError",this.key=a,this.locale=e}},Kt=ns,{Utils:{Object:as,Function:Lu,Browser:gP,Valid:PP},Configs:{Languages:{DetectPlayerLocale:AP}}}=Ludex;function ss(t){return PP.isEmpty(t)?null:t}var os=class extends Ludex.Plugins.BasePlugin{ia;jt;pe={};setFallbackLocale(t){this.jt=t}hasTextKey(t,e){let a=e??this.getCurrentLocale(),{text:r}=this.ge(a);return as.hasOwn(r,t)}hasTextureKey(t,e){let a=e??this.getCurrentLocale(),{texture:r}=this.ge(a);return as.hasOwn(r,t)}add(t,e,a=!1){this.pe[t]=e,a&&this.setFallbackLocale(t)}choose(t){this.ia=t;let{event:e}=this.codex;e.emit(Ludex.Events.LANGUAGE_CHANGED,{locale:t})}getText(t,e,a,r=!1){try{return this.pn(t,e,a,!r)}catch(n){return n instanceof Kt||n instanceof Jr,String(t)}}getTexture(t,e,a=!1){return this.mn(t,e,!a)}pn(t,e=[],a,r=!0){if(!r||this.jt===void 0){let g=this.ns(t,a??this.getCurrentLocale());return this.oa(g,e)}let n=this.jt,y=Lu.retry(()=>this.ns(t,a??this.getCurrentLocale()),()=>this.ns(t,n));return this.oa(y,e)}ns(t,e){if(!this.hasTextKey(t,e))throw new Kt(t,e);let{text:a}=this.ge(e);return a[t]}mn(t,e,a=!0){if(!a||this.jt===void 0)return this.os(t,e??this.getCurrentLocale());let r=this.jt;return Lu.retry(()=>this.os(t,e??this.getCurrentLocale()),()=>this.os(t,r))}os(t,e){if(!this.hasTextureKey(t,e))throw new Kt(t,e);let{texture:a}=this.ge(e);return a[t]}getCurrentLocale(){return this.ia??"en"}ge(t){let e=t??this.getCurrentLocale();if(!as.hasOwn(this.pe,e))throw new Jr(e);return this.pe[e]}oa(t,e){let a=e.length;if(a===0)return t;let r=t;for(let n=0;n<a;n++){let y=e[n],g=`%{${n}}`;r=r.replace(g,y)}return r}getPlayerLanguage(){let{player:t}=this.codex,e=GameSDK.getLocale(),a=ss(e?.trim().split(/[-_]/)[0]),r=ss(this.getBrowserLanguage());return t.isFirstSession()?a??r??"en":ss(t.getPlayerSetting("language"))??a??r??"en"}getBrowserLanguage(){return AP===!1?"en":gP.getLocale()?.trim()?.split(/[-_]/)[0]}},Cu=os,Eu=Cu;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var $P={_id:"",name:"",createdBy:"",description:"",expireTime:6048e5,type:"app_leaderboard",timezone:"utc+0",createdAt:"2024-01-01T09:00:00.000Z",sortOrder:"desc",statistics:"max",resettable:"manually",resetScore:0,numberOfLeaders:15,amountPlayer:15},Tu=$P,{Configs:{OtherHost:Ht,Mockup:jt,AppId:xP},Utils:{Object:Wt,String:is,Valid:wP}}=Ludex,cs=class{L;async pt(){if(this.L)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof t!="function")throw new Error("Cannot load LeaderboardAPIMock");this.L=new t}async getLeadersAsync(t,e,a){let r=is.params(a),n;return jt.Leaderboards.Enabled?(await this.pt(),"playerIds"in a?n=await this.L.getPlayers(t,a):n=await this.L.getLeaders(t,a)):n=await Ne(`${e}?${r}`,{},Ht),!Wt.hasOwn(n,"data")||!Array.isArray(n.data)?[]:n.data}async getLeaderboardAsync(t){let e,a=`leaderboards/${t}`;return jt.Leaderboards.Enabled?(await this.pt(),e=await this.L.getLeaderboardAsync(t)):(e=await Ne(a,{},Ht),Wt.hasOwn(e,"data")&&typeof e.data=="object"&&(e=e.data)),e}async getLeaderboardsAsync(t){let e,a=is.params(t);return jt.Leaderboards.Enabled?(await this.pt(),e=await this.L.getLeaderboardsAsync(t)):(e=await Ne(`leaderboards?${a}`,{},Ht),Wt.hasOwn(e,"data")&&Array.isArray(e.data)?e=e.data:e=[]),e}async setLeaderboardScoreAsync(t){let{leaderboardId:e,playerId:a,score:r}=t;jt.Leaderboards.Enabled?(await this.pt(),await this.L.setScoreAsync(e,a,r)):await me(`leaderboards/${e}/players/${a}`,{score:r},{},Ht)}async createLeaderboardAsync(t){let e=t._id??is.generateObjectId(),a=t.numberOfLeaders,r=de(T(T({},Tu),t),{_id:e,appId:xP,numberOfLeaders:a}),n="leaderboards",y;if(jt.Leaderboards.Enabled?(await this.pt(),y=await this.L.createLeaderboard(r)):(y=await me(n,r,{},Ht),Wt.hasOwn(y,"data")&&wP.isObject(y.data)&&(y=y.data)),!Wt.hasOwn(y,"_id")||y._id!==e)throw new Error("Create leaderboard failed");return e}},Mu=cs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var bP={limit:0,offset:0,leaders:{},isRequesting:!1,amountPlayer:0},ls=bP;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var vP={leaderboards:{}},Ou=vP,{Utils:{Array:SP,Valid:DP,Json:_u,Object:Xe},Configs:{Mockup:{Leaderboards:IP}}}=Ludex,ds=class extends Ludex.Plugins.BasePlugin{B=new Mu;_;init(){let{storage:t}=this.codex;t.addStorage("leaderboard",Ou),this._={}}addLeaderboard(t){let{name:e,type:a,leaderboardId:r,autoSortRank:n}=t;if(this.getLeaderboard(e))return;let y=`leaderboards/${r}/`;(a==="global"||a==="tournament")&&(y+="leaders"),a==="friends"&&(y+="players"),this._[e]={id:r,name:e,type:a,host:y,autoSortRank:n};let g=_u.clone(ls);this.G(e,g)}async requestLeaderboardsAsync(t){try{return await this.B.getLeaderboardsAsync(t)}catch{return[]}}async requestLeaderboardAsync(t,e){try{this.Kt(t),this.clearLeaderboard(t),this.G(t,{isRequesting:!0});let{id:a,type:r,host:n}=this._[t],y=[];if(r==="friends"){let{player:g}=this.codex,w=g.getPlayerId(),v=g.getConnectedPlayerIds(e,0),S=[w,...v];this._[t].playerIds=[...S],y=await this.B.getLeadersAsync(a,n,{playerIds:S})}else y=await this.B.getLeadersAsync(a,n,{limit:e,offset:0});if(y.length===0)return;await this.la(t,y),this.G(t,{limit:e,offset:0})}finally{let a=await this.B.getLeaderboardAsync(this._[t].id),r=a?a.resettable:"",n=a?a.amountPlayer:0;this.G(t,{isRequesting:!1,resettable:r,amountPlayer:n})}}async loadMoreLeaderboardAsync(t,e){let a=this.getLeaderboard(t);if(a&&this._[t].type!=="friends")try{this.G(t,{isRequesting:!0});let{id:r,host:n}=this._[t],{offset:y,limit:g}=a,w=y+g,v=await this.B.getLeadersAsync(r,n,{limit:e,offset:w});if(v.length===0)return;this.la(t,v),this.G(t,{limit:e,offset:w})}finally{this.G(t,{isRequesting:!1})}}getLeaderboard(t){let{storage:e}=this.codex,a=e.getStorageData("leaderboard","leaderboards");return!a||!a[t]?null:a[t]}async getLeadersByPlayerIdsAsync(t,e){try{this.Kt(t);let{id:a}=this._[t],r=`leaderboards/${a}/players`,n=await this.B.getLeadersAsync(a,r,{playerIds:e});return n.length===0?[]:this.ca(n)}catch{return[]}}async getLeaderboardResponseAsync(t){return this.B.getLeaderboardAsync(t)}clearLeaderboard(t){try{this.Kt(t);let e=_u.clone(ls);this.G(t,null),this.G(t,e)}catch{}}isLeaderboardEmpty(t){let e=this.getLeaderboard(t);if(!e)return!0;let{leaders:a}=e;return Object.keys(a).length===0}isExistLeaderboardId(t){let{_:e}=this;return Xe.vals(e).some(a=>a.id===t)}getLeaderboardName(t){let{_:e}=this,a=SP.search(Xe.vals(e),r=>r.id===t);return a?a.name:null}async setLeaderboardScoreAsync(t,e,a){try{if(GameSDK.extra.isGuest&&!IP.Enabled)return;this.Kt(t);let{id:r}=this._[t],n=await this.gn(t,e);if(n&&a<=n)return;await this.B.setLeaderboardScoreAsync({leaderboardId:r,playerId:e,score:a})}catch{}}async gn(t,e){let a=await this.getLeadersByPlayerIdsAsync(t,[e]);return a.length===0?null:a[0].score}async createLeaderboardAsync(t){return this.B.createLeaderboardAsync(t)}Kt(t){let e=this.getLeaderboard(t);if(!DP.isObject(e))throw new Error(`Leaderboard with name ${t} not found`)}G(t,e){if(!e)return;let{storage:a}=this.codex;a.setStorageData("leaderboard","leaderboards",{[t]:e})}async la(t,e){this.Kt(t);let a=(await this.ca(e)).filter(v=>v.name&&v.photo),{leaders:r={}}=this.getLeaderboard(t)??{},n=a.filter(v=>r[v.playerId]?(r[v.playerId]=v,!1):!0),y=Xe.vals(r);n.length>0&&y.unshift(...n);let g=y.sort((v,S)=>S.score-v.score);this._[t].autoSortRank&&(g=g.map((v,S)=>Xe.merge(v,{rank:S+1})));let w=Xe.keyBy(g,"playerId");this.G(t,{leaders:w})}async ca(t){let{profile:e}=this.codex,a=t.map(n=>n.playerId);await e.requestProfiles(a);let r=e.getProfiles();return t.map(n=>{let{playerId:y}=n,g=r[y];if(!g){let{language:w}=this.codex,v=w.getText("core.nameless")??"Nameless";return Xe.merge(n,{name:v,photo:"default"})}return Xe.merge(n,{name:g.name,photo:g.photo})}).map(n=>de(T({},n),{score:parseInt(n.score,10)}))}},Nu=ds,ku=Nu;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var us=class{ha;setAPIHost(t){this.ha=t}getAPIHost(){return this.ha}},Ru=us,{Utils:Gu}=Ludex,ps=class extends Ru{async createSingleMatchAsync(t){let e=await me("single-matches",t,{},this.getAPIHost());return this.rt(e)}async getSingleMatchDetailAsync(){let t=await Ne("single-matches/active",{},this.getAPIHost());return this.rt(t)}async updateSingleMatchMoveAsync(t,e){let a=`single-matches/${t}/move`,r=await me(a,e,{},this.getAPIHost());return this.rt(r)}async finishSingleMatchAsync(t){let e=`single-matches/${t}/finish`,a=await me(e,{},{},this.getAPIHost());return this.rt(a)}async createMatchAsync(t){let e=await me("matches",t,{},this.getAPIHost());return this.rt(e)}async joinMatchAsync(t){let e=`matches/${t}/join`,a=await me(e,{},{},this.getAPIHost());return this.rt(a)}async getMatchDetailByIdAsync(t){let e=`matches/${t}`,a=await Ne(e,{},this.getAPIHost());return this.rt(a)}async finishMatchAsync(t){let{matchId:e="",score:a=0,level:r=0,extraData:n={}}=t,y=`matches/${e}/finish`,g=await me(y,{matchId:e,score:a,level:r,extraData:n},{},this.getAPIHost());return this.rt(g)}rt(t){return Gu.Valid.isObject(t)?Gu.Object.hasOwn(t,"data")?t.data??{}:{}:{}}},Fu=ps,hs=class{fe;constructor(t){this.wn(),this.setAPIConfig(t)}wn(){this.fe=new Fu}setAPIConfig(t){t.matchAPIHost&&this.fe.setAPIHost(t.matchAPIHost)}setMatchAPIInstance(t){this.fe=t}getMatchAPI(){return this.fe}},Bu=hs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ms=class{codex;match;constructor(t,e){this.codex=t,this.match=e}p(t){this.match.useCPUProfile}m(){this.match.useCPUProfile}async processAsync(t){throw new Error("Not implemented")}},k=ms;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Object:LP,Valid:zt,Json:CP}=Ludex.Utils,fs=class{r;nt;Pt;Ht;constructor(t){this.r=t.codex,this.nt=t.match,this.Pt=null,this.Ht={Before:null,After:null}}setNext(t){return this.Pt=t,t}async processAsync(t){this.da("Before",t)}async n(t){this.da("After",t),this.An(),this.Pt&&await this.Pt.processAsync(t)}da(t,e){if(!zt.isDebugger())return;this.Ht[t]=CP.clone(e);let a=e,{profiles:r,customData:n}=a,y=vn(a,["profiles","customData"])}An(){let{After:t,Before:e}=this.Ht;if(!t||!e)return;let a=LP.diff(e,t);if(!zt.isEmpty(a)){let r=a,{profiles:n={},customData:y={}}=r,g=vn(r,["profiles","customData"]);zt.isEmpty(g),zt.isEmpty(n),zt.isEmpty(y)}this.Ht.After=null,this.Ht.Before=null}},L=fs,ys=class extends L{async processAsync(t){await this.n(t)}async n(t){this.Pt&&await this.Pt.processAsync(t)}},R=ys;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var gs=class extends te{constructor(t){super(t),this.name="LevelNotDefined",this.message=t??"Level is not defined"}},Xr=gs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ps=class extends te{constructor(t){super(t),this.name="MatchModeNotDefined",this.message=t??"Match id is not defined"}},At=Ps,{Plugins:{Analytics:{Events:Vu}={}},Utils:{String:Uu,Valid:Ku}}=Ludex,As=class extends L{async processAsync(t){super.processAsync(t);let{mode:e,customData:a}=t,{level:r}=a;this.Vt(e),this.ls(r);let{analytics:n}=this.r;Vu&&n.event(Vu.MATCH_START,{level:r,game_mode:Uu.toUpperCamelCase(e),level_name:this.cs(r)}),await this.n(t)}Vt(t){if(!Ku.isString(t))throw new At}ls(t){if(!Ku.isNumber(t))throw new Xr}cs(t){return`Level ${Uu.padStart(t.toString(),5,"0")}`}},Y=As;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var EP={OPEN:"open",ACTIVE:"active",FINISHED:"finished"},j=EP,$s=class extends L{async processAsync(t){super.processAsync(t);let{mode:e,status:a}=t,r=e??ke.SINGLE;a===j.FINISHED&&(r=ke.SINGLE),this.vn(r),await this.n(t)}vn(t){let{storage:e}=this.r;e.setStorageData("context","contextGameMode",t)}},F=$s;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xs=class extends Error{constructor(t){super(t),this.name="GetMatchDetailFailed",this.message=t??"Get match detail failed"}},$t=xs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ws=class extends Error{constructor(t){super(t),this.name="MatchAreNotActive",this.message=t??"Match are not active"}},Zr=ws;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var bs=class extends te{constructor(t){super(t),this.name="MatchIdNotValid",this.message=t??"Match id is not valid"}},re=bs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var vs=class extends Error{constructor(t){super(t),this.name="OpponentHasFinishedMatch",this.message=t||"Opponent has finished match"}},Hu=vs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ss=class extends te{constructor(t){super(t),this.name="OpponentIdNotValid",this.message=t??"Opponent id is not valid"}},z=Ss;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ds=class extends Error{constructor(t){super(t),this.name="PlayerNotCurrentInMatch",this.message=t??"The player is not currently in this match"}},xt=Ds;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Is=class extends Error{constructor(t){super(t),this.name="PlayerNotFinishedMatch",this.message=t||"Player not finished match"}},en=Is,{Dtos:TP,Utils:{Object:MP}}=Ludex,Ls=class extends L{async processAsync(t){super.processAsync(t),this.j(t);let e=await this.$t(t),a=new TP.Match.Data(e).toObject();this.In(t,a),this.N(t,a),this.Sn(t),this.Wt(t),this.hs(t),await this.n(t)}j(t){let{id:e}=t;if(typeof e!="string")throw new re}Sn(t){let{status:e}=t;if(e!==j.ACTIVE)throw new Zr}In(t,e){let{id:a,customData:r}=t,{_id:n,whitePlayerId:y,blackPlayerId:g}=e;if(typeof n!="string"||n!==a)throw new $t;let{playerId:w}=r,v=y===w,S=g===w;if(!v&&g===ie.playerId)throw new Pt;if(!v&&!S)throw new xt}Wt(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(typeof r!="string")throw new G;let{finished:n}=e[r];if(!n)throw new en}hs(t){let{profiles:e,customData:a}=t,{opponentId:r}=a;if(typeof r!="string")throw new z;let{finished:n}=e[r];if(n)throw new Hu}async $t(t){let{id:e}=t;return e?this.nt.api.getMatchAPI().getMatchDetailByIdAsync(e):{}}N(t,e){this.K(t,e),this.H(t,e),this.V(t),this.mt(t,e)}K(t,e){let{status:a,extraData:r}=e;t.status=a,t.customData=MP.merge(t.customData,r)}H(t,e){let{whitePlayerId:a,blackPlayerId:r}=e,n=a===t.customData.playerId;t.customData.playerId=n?a:r,t.customData.opponentId=n?r:a}V(t){let{playerId:e,opponentId:a}=t.customData;if(!e||!a)return;let r={name:"",photo:"",finished:!1};t.profiles[e]||(t.profiles[e]=T({id:e},r)),t.profiles[a]||(t.profiles[a]=T({id:a},r))}mt(t,e){let{playerId:a,opponentId:r}=t.customData;if(!a||!r)return;let{whitePlayerId:n,whitePlayerScore:y,whitePlayerFinish:g,blackPlayerScore:w,blackPlayerFinish:v}=e,S=n===a;t.profiles[a].score=S?y:w,t.profiles[r].score=S?w:y,t.profiles[a].finished=S?g:v,t.profiles[r].finished=S?v:g}},ju=Ls;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var OP={level:1,rescued:0,contextId:null,playerId:null,opponentId:null,tournamentId:null,leaderboardId:null},wt=OP,Cs=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.Dn(t),await this.n(t)}Dn(t){let{id:e,mode:a,customData:r}=this.t;t.id=e??null,t.mode=a||null,t.status=j.OPEN,t.startAt=0,t.finishAt=0,t.profiles={},t.customData=T(T(T({},wt),t.customData),r)}},W=Cs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var _P=ve,Ae=_P;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Es=class extends Error{constructor(t){super(t),this.name="UnavailableFeature",this.message=`Unavailable feature: ${t}`}},V=Es;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ts=class extends te{constructor(t){super(t),this.name="ContextIdNotValid",this.message=t??"Context id is not valid"}},X=Ts;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ms=class extends te{constructor(t){super(t),this.name="ProfileNotFound",this.message=t??"Profile not found"}},U=Ms,Os=class extends L{async processAsync(t){super.processAsync(t),this.c(t);let e=await this.En(t);e&&this.gt(t,e),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async En(t){try{let{frameCapture:e}=this.r,{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||!y)return null;let g=a[n],w=a[y];if(!g||!w)return null;let{photo:v,score:S=0,finished:D}=g;if(!D)return null;let{photo:x,score:b=0,finished:_}=w;return _?null:await e.renderAsync("result-challenge",{playerId:n,playerPhoto:v,playerScore:S,opponentId:y,opponentPhoto:x,opponentScore:b,isPlayerFinished:!0,isOpponentFinished:!1})}catch{return null}}async gt(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let w=r[y];if(!w)throw new U;let{name:v}=w,S={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${v} is waiting for you to finish this game. Play now!`,localizations:{vi_VN:`${v} \u0111ang ch\u1EDD b\u1EA1n k\u1EBFt th\xFAc tr\u1EADn \u0111\u1EA5u. Ch\u01A1i ngay!`}},image:e,strategy:"LAST",notification:"PUSH"};await GameSDK.extra.updateAsync(S)}},Wu=Os;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:NP}=Ludex,_s=class extends L{async processAsync(t){super.processAsync(t),this.c(t);let{customData:e}=t,{playerId:a,opponentId:r}=e,n=a,y=await this.ua(n);if(!y)throw new U;if(this.ds(t,n,y),n=r,n!==ie.playerId){let g=await this.ua(n);if(!g)throw new U;this.ds(t,n,g)}else this.ds(t,n);await this.n(t)}c(t){let{customData:e}=t,{playerId:a,opponentId:r}=e;if(!a||typeof a!="string")throw new G;if(!r||typeof r!="string")throw new z}async ua(t){let{profile:e}=this.r;return await e.requestProfiles([t]),e.getProfiles()[t]}ds(t,e,a){let{name:r,photo:n}=a??ie,y=new NP.Match.Profile({id:e,name:r,photo:n}).toObject();t.profiles[e]?(t.profiles[e].name=y.name,t.profiles[e].photo=y.photo):t.profiles[e]=y}},le=_s,Ns=class extends k{async processAsync(t){try{this.p(t);let{matchId:e,playerId:a,opponentId:r}=t,n=new R(this),y=new W(this,{id:e,mode:H.CHALLENGE_FRIEND,customData:{playerId:a,opponentId:r}});n.setNext(y);let g=new ju(this);y.setNext(g);let w=new le(this);g.setNext(w);let v=new Wu(this);w.setNext(v);let S=new Y(this);v.setNext(S);let D=new F(this);S.setNext(D);let x=this.match.getMatchState();await n.processAsync(x)}finally{this.m()}}},zu=Ns;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ks=class extends te{constructor(t){super(t),this.name="CreateContextFailed",this.message=t??"Create context failed"}},bt=ks,{Valid:qu,Object:Qu}=Ludex.Utils,Rs=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t);let{opponentId:e}=this.t,a=await this.xn(e);t.customData.contextId=a,await this.n(t)}async xn(t){try{await GameSDK.context.createAsync(t)}catch(a){this.bn(a)}let e=GameSDK.context.getID();if(!qu.isString(e))throw new bt;return e}bn(t){if(!Qu.hasOwn(t,"code"))throw t;if(t.code!=="SAME_CONTEXT"){if(t.code==="INVALID_PARAM"){if(!this.Pn(t))throw t;return}throw t}}Ln(t){if(!Qu.hasOwn(t,"message")||!qu.isString(t.message))throw t}Pn(t){return this.Ln(t),t.message.indexOf("is not a connected player of the current player")>-1}},Yu=Rs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Gs=class extends te{constructor(t){super(t),this.name="MatchAreNotOpen",this.message=t??"Match are not open"}},Ke=Gs,{Dtos:kP,Utils:{Object:RP}}=Ludex,Fs=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.c(t);let e=await this._n(t),a=new kP.Match.Data(e).toObject();this.us(t,a),await this.n(t)}c(t){let{status:e,customData:a}=t,{opponentId:r}=a;if(typeof r!="string")throw new z;if(e!==j.OPEN)throw new Ke}async _n(t){let{opponentId:e}=t.customData,{extraData:a}=this.t;if(!e)return{};let r={opponentPlayerId:e,extraData:a};return this.nt.api.getMatchAPI().createMatchAsync(r)}us(t,e){this.K(t,e),this.H(t,e),this.V(t),this.On(t,e)}K(t,e){let{_id:a,extraData:r}=e;t.id=a||null,t.customData=RP.merge(t.customData,r)}H(t,e){let{whitePlayerId:a,blackPlayerId:r}=e,{customData:n}=t,y=a===n.opponentId,g=y?r:a,w=y?a:r;t.customData.playerId=g,t.customData.opponentId=w}V(t){let{playerId:e,opponentId:a}=t.customData;if(!e||!a)return;let r={name:"",photo:"",finished:!1};t.profiles[e]||(t.profiles[e]=T({id:e},r)),t.profiles[a]||(t.profiles[a]=T({id:a},r))}On(t,e){let{playerId:a,opponentId:r}=t.customData;if(!a||!r)return;let{whitePlayerId:n,whitePlayerFinish:y,blackPlayerFinish:g}=e,w=n===t.customData.opponentId,v=w?g:y,S=w?y:g;t.profiles[a].finished=v,t.profiles[r].finished=S}},tn=Fs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Bs=class extends L{async processAsync(t){if(super.processAsync(t),t.status!==j.OPEN)throw new Ke;this.Cn(t),await this.n(t)}Cn(t){t.status=j.ACTIVE,t.startAt=Date.now()}},Z=Bs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Vs=class extends L{async processAsync(t){super.processAsync(t),this.c(t);let e=await this.Nn(t);e&&this.gt(t,e),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async Nn(t){try{let{frameCapture:e}=this.r,{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||!y)return null;let g=a[n],w=a[y];if(!g||!w)return null;let{photo:v,score:S=0}=g,{photo:D,score:x=0}=w;return await e.renderAsync("result-challenge",{playerId:n,playerPhoto:v,playerScore:S,opponentId:y,opponentPhoto:D,opponentScore:x,isPlayerFinished:!1,isOpponentFinished:!1})}catch{return null}}async gt(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let{name:w}=r[y],v={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${w} challenges you`,localizations:{vi_VN:`${w} th\u1EED th\xE1ch b\u1EA1n trong tr\u1EADn \u0111\u1EA5u n\xE0y. Ch\u01A1i ngay!`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};await GameSDK.extra.updateAsync(v)}},rn=Vs,Us=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,opponentId:a,extraData:r}=t,n=new R(this),y=new Yu(this,{opponentId:a});n.setNext(y);let g=new W(this,{mode:H.CHALLENGE_FRIEND,customData:{playerId:e,opponentId:a}});y.setNext(g);let w=new tn(this,{extraData:r});g.setNext(w);let v=new le(this);w.setNext(v);let S=new Z(this);v.setNext(S);let D=new Y(this);S.setNext(D);let x=new rn(this);D.setNext(x);let b=new F(this);x.setNext(b);let _=this.match.getMatchState();await n.processAsync(_)}finally{this.m()}}},Ju=Us;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ks=class extends Error{constructor(t){super(t),this.name="SameContext",this.message=t??"Same context"}},nn=Ks,{Utils:Xu}=Ludex,Hs=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t);let{contextId:e}=this.t;await this.Tn(e),t.customData.contextId=e,await this.n(t)}At(t){let e=t==="SOLO",a=GameSDK.context.getID();if(a===t)throw new nn;if(e&&a===null)throw new nn}async Tn(t){let e=t==="SOLO";try{this.At(t),await GameSDK.context.switchAsync(t,e)}catch(a){if(a instanceof nn)return;if(!Xu.Object.hasOwn(a,"code"))throw a;if(Xu.Device.isAndroid()&&e&&a.code==="INVALID_PARAM")return;if(a.code!=="SAME_CONTEXT")throw a}}},He=Hs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:GP,Utils:{Object:FP}}=Ludex,js=class extends L{async processAsync(t){super.processAsync(t),this.j(t);let e=await this.$t(t),a=new GP.Match.Data(e).toObject();this.Rn(t,a),this.N(t,a),this.Wt(t),await this.n(t)}j(t){let{id:e,status:a}=t;if(typeof e!="string")throw new re;if(a!==j.OPEN)throw new Ke}Rn(t,e){let{id:a,customData:r}=t,{_id:n,whitePlayerId:y,blackPlayerId:g}=e;if(typeof n!="string"||n!==a)throw new $t;let{playerId:w}=r,v=y===w,S=g===w;if(!v&&g===ie.playerId)throw new Pt;if(!v&&!S)throw new xt}Wt(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(typeof r!="string")throw new G;let{finished:n}=e[r];if(n)throw new Hr}async $t(t){let{id:e}=t;return e?this.nt.api.getMatchAPI().getMatchDetailByIdAsync(e):{}}N(t,e){this.K(t,e),this.H(t,e),this.V(t),this.mt(t,e)}K(t,e){let{extraData:a}=e;t.customData=FP.merge(t.customData,a)}H(t,e){let{whitePlayerId:a,blackPlayerId:r}=e,n=a===t.customData.playerId;t.customData.playerId=n?a:r,t.customData.opponentId=n?r:a}V(t){let{playerId:e,opponentId:a}=t.customData;if(!e||!a)return;let r={name:"",photo:"",finished:!1};t.profiles[e]||(t.profiles[e]=T({id:e},r)),t.profiles[a]||(t.profiles[a]=T({id:a},r))}mt(t,e){let{playerId:a,opponentId:r}=t.customData;if(!a||!r)return;let{whitePlayerId:n,whitePlayerScore:y,whitePlayerFinish:g,blackPlayerScore:w,blackPlayerFinish:v}=e,S=n===a;t.profiles[a].score=S?y:w,t.profiles[r].score=S?w:y,t.profiles[a].finished=S?g:v,t.profiles[r].finished=S?v:g}},Zu=js;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ws=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){if(super.processAsync(t),this.t.ignore){await this.n(t);return}this.c(t);let e=await this.Mn(t);e&&this.gt(t,e),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async Mn(t){try{let{player:e,frameCapture:a}=this.r,{playerId:r,photo:n}=e.getPlayer(),{opponentId:y}=t.customData;if(y==null)return null;let g=t.profiles[y];if(!g)return null;let w=g.photo;return await a.renderAsync("update-challenge",{playerId:r,playerPhoto:n,opponentId:y,opponentPhoto:w})}catch{return null}}async gt(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let w=r[y];if(!w)throw new U;let{name:v}=w,S={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${v} made an update.`,localizations:{vi_VN:`${v} \u0111\xE3 c\u1EADp nh\u1EADt tr\u1EADn \u0111\u1EA5u. Ch\u01A1i ngay!`}},image:e,strategy:"LAST",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(S)}},ep=Ws,zs=class extends k{async processAsync(t){try{this.p(t);let{contextId:e,matchId:a,playerId:r,opponentId:n,sendUpdateMessage:y=!0}=t,g=new R(this),w=new He(this,{contextId:e});g.setNext(w);let v=new W(this,{id:a,mode:H.CHALLENGE_FRIEND,customData:{playerId:r,opponentId:n}});w.setNext(v);let S=new Zu(this);v.setNext(S);let D=new le(this);S.setNext(D);let x=new Z(this);D.setNext(x);let b=new ep(this,{ignore:!y});x.setNext(b);let _=new Y(this);b.setNext(_);let M=new F(this);_.setNext(M);let B=this.match.getMatchState();await g.processAsync(B)}finally{this.m()}}},tp=zs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Plugins:{Analytics:{Events:rp}={}},Utils:{String:np,Valid:ap}}=Ludex,qs=class extends L{async processAsync(t){super.processAsync(t);let{customData:e,mode:a,startAt:r,finishAt:n}=t,{level:y}=e;this.Vt(a),this.ls(y);let g=Math.floor((n-r)/1e3),{analytics:w}=this.r;rp&&w.event(rp.MATCH_END,{level:y,game_mode:np.toUpperCamelCase(a),level_name:this.cs(y),time_played:g}),await this.n(t)}Vt(t){if(!ap.isString(t))throw new At}ls(t){if(!ap.isNumber(t))throw new Xr}cs(t){return`Level ${np.padStart(t.toString(),5,"0")}`}},Le=qs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Qs=class extends Error{constructor(t){super(t),this.name="LeaderboardNotExist",this.message=t??"Leaderboard not exist in game"}},an=Qs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ys=class extends Error{constructor(t){super(t),this.name="ScoreNotValid",this.message=t??"Score is not valid"}},vt=Ys,{Utils:{Valid:BP},Configs:{Leaderboards:{LeaderboardList:VP}}}=Ludex,Js=class extends L{t;ya;constructor(t,e){super(t),this.t={score:0,playerId:""},this.ya=!!e?.ignore}async processAsync(t){if(super.processAsync(t),this.ya){await this.n(t);return}this.zt(t),"submitGameResultsAsync"in GameSDK.extra&&await GameSDK.extra.submitGameResultsAsync(this.t.score);for(let e of VP){let{Id:a,Mode:r}=e;!t.mode||!this.Gn(r,t.mode)||this.ys(T({leaderboardId:a},this.t))}await this.n(t)}Gn(t,e){return t===e}async zt(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(!r||!e[r])throw new U;let{score:n}=e[r];if(!BP.isNumber(n))throw new vt;this.t={score:n,playerId:r}}async ys(t){try{let{playerId:e,score:a,leaderboardId:r}=t,n=this.r.leaderboard.getLeaderboardName(r);if(!n)throw new an;await this.r.leaderboard.setLeaderboardScoreAsync(n,e,a)}catch{}}},je=Js;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:UP,Utils:KP}=Ludex,{Valid:sn,Object:HP}=KP,Xs=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.j(t);let{useAPI:e}=this.t;if(e){let a=await this.Un(t),r=new UP.Match.Data(a).toObject();this.kn(t,r)}else this.N(t);this.us(t),await this.n(t)}j(t){let{status:e,profiles:a,customData:r}=t;if(e!==j.ACTIVE)throw new Zr;let{playerId:n}=r;if(!n||!HP.hasOwn(a,n))throw new xt}N(t){let{playerId:e}=t.customData;if(!sn.isString(e))throw new G;t.profiles[e].finished=!0}us(t){t.status=j.FINISHED,t.finishAt=Date.now()}async Un(t){let{id:e,profiles:a,customData:r}=t,{level:n,playerId:y}=r;if(!sn.isString(y))throw new G;let{score:g}=a[y],{extraData:w}=this.t,v={matchId:e??"",score:g,level:n,extraData:w};return this.nt.api.getMatchAPI().finishMatchAsync(v)}kn(t,e){let{playerId:a,opponentId:r}=t.customData;if(!sn.isString(a))throw new G;if(!sn.isString(r))throw new z;let{whitePlayerId:n,whitePlayerScore:y,blackPlayerScore:g,whitePlayerFinish:w,blackPlayerFinish:v}=e,S=a===n,D=S?y:g,x=S?g:y,b=S?w:v,_=S?v:w;t.profiles[a].score=D,t.profiles[r].score=x,t.profiles[a].finished=b,t.profiles[r].finished=_}},Ce=Xs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Zs=class extends L{async processAsync(t){super.processAsync(t),this.c(t);let e=await this.Fn(t);e&&this.Bn(t,e),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async Fn(t){try{let{frameCapture:e}=this.r,{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||!y)return null;let g=a[n],w=a[y];if(!g||!w)return null;let{photo:v,score:S=0,finished:D}=g,{photo:x,score:b=0,finished:_}=w;return await e.renderAsync("result-challenge",{playerId:n,playerPhoto:v,playerScore:S,opponentId:y,opponentPhoto:x,opponentScore:b,isPlayerFinished:!!D,isOpponentFinished:!!_})}catch{return null}}Bn(t,e){let{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||typeof n!="string")throw new G;if(!y||typeof y!="string")throw new z;if(!a[n]||!a[y])throw new U;let{score:g=0,finished:w}=a[n],{score:v=0,finished:S}=a[y];w?this.jn(t,e):S&&g>v?this.ps(t,e):this.Kn(t,e)}async jn(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let w=r[y];if(!w)throw new U;let{name:v}=w,S={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g,status:j.FINISHED},action:"CUSTOM",template:"finished",cta:{default:"See result",localizations:{vi_VN:"Xem k\u1EBFt qu\u1EA3"}},text:{default:`${v} just finished. Check them now.`,localizations:{vi_VN:`${v} v\u1EEBa ho\xE0n th\xE0nh m\xE0n ch\u01A1i. Nh\u1EA5n \u0111\u1EC3 xem k\u1EBFt qu\u1EA3 tr\u1EADn \u0111\u1EA5u.`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(S)}async Kn(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;let w=r[y];if(!w)throw new U;let{name:v,score:S}=w,D={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g,status:j.ACTIVE},action:"CUSTOM",template:"finished",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${v} got ${S} scores. So easy! Can you?`,localizations:{vi_VN:`${v} \u0111\xE3 \u0111\u1EA1t ${S} \u0111i\u1EC3m! Nh\u1EA5n Ch\u01A1i \u0111\u1EC3 so t\xE0i!`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(D)}async ps(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;let w=r[y];if(!w)throw new U;let{name:v,score:S}=w,D={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g,status:j.FINISHED},action:"CUSTOM",template:"pass_score",cta:{default:"See result",localizations:{vi_VN:"Xem k\u1EBFt qu\u1EA3"}},text:{default:`${v} beat your high score. Their score: ${S}`,localizations:{vi_VN:`${v} \u0111\xE3 v\u01B0\u1EE3t qua \u0111i\u1EC3m s\u1ED1 c\u1EE7a b\u1EA1n, v\u1EDBi ${S} \u0111i\u1EC3m!`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(D)}},sp=Zs;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var eo=class extends L{pa;constructor(t,e){super(t),this.pa=!!e?.ignore}async processAsync(t){super.processAsync(t),this.Hn(t),await this.n(t)}Hn(t){if(this.pa)return;let{profiles:e,customData:a}=t,{playerId:r}=a;if(!r||!e[r])throw new U;let{player:n}=this.r,y=n.getBestScore()||0,{score:g=0}=e[r];g<=y||(n.setBestScore(g),e[r].bestScore=g)}},Ee=eo,to=class extends k{async processAsync(t){try{this.p(t);let{extraData:e}=t??{},a=new R(this),r=new Ce(this,{useAPI:!0,extraData:e});a.setNext(r);let n=new sp(this);r.setNext(n);let y=new Le(this);n.setNext(y);let g=new Ee(this);y.setNext(g);let w=new je(this);g.setNext(w);let v=new F(this);w.setNext(v);let S=this.match.getMatchState();await a.processAsync(S)}finally{this.m()}}},op=to;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ro=class extends Error{constructor(t){super(t),this.name="ContextAreSolo",this.message=t??"Context are solo"}},ip=ro;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var no=class extends Error{constructor(t){super(t),this.name="ContextNotChallenge",this.message=t??"Context is not a challenge"}},cp=no;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ao=class extends Error{constructor(t){super(t),this.name="NetworkFailure",this.message=t??"Network failure"}},lp=ao,{Utils:jP,Dtos:WP}=Ludex,{Array:zP,Object:qP}=jP,so=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.Vn();let e=await this.$n();t.customData.opponentId=e,await this.n(t)}Vn(){let t=GameSDK.context.getID();if(typeof t!="string")throw new X;if(t==="SOLO")throw new ip}async $n(){let{ignoreId:t}=this.t,e=await this.Wn([t]);if(e.length>1)throw new cp;let a=ie;return e.length===1&&(a=e[0]),a.playerId}async Wn(t){try{let e=await GameSDK.context.getPlayersAsync(),a=[];for(let r of e){let n=r.getID();if(t.indexOf(n)>-1)continue;let y=r.getName();if(!y)continue;let g=r.getPhoto();a.push(new WP.Player.Info({playerId:n,name:y,photo:g}).toObject())}return zP.unique(a)}catch(e){if(qP.hasOwn(e,"code")&&e.code==="NETWORK_FAILURE")throw new lp;return[]}}},on=so;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var oo=class extends Error{constructor(t){super(t),this.name="ContextIsTournament",this.message=t??"Context is a tournament"}},qt=oo,{Object:QP}=Ludex.Utils,io=class extends L{async processAsync(t){super.processAsync(t);let e=await this.zn();await this.qn(),t.customData.contextId=e,await this.n(t)}async zn(){try{await GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2})}catch(e){if(!QP.hasOwn(e,"code")||e.code!=="SAME_CONTEXT")throw e}let t=GameSDK.context.getID();if(typeof t!="string")throw new bt;return t}async qn(){try{if(!GameSDK.context.getID())return;throw"getTournamentAsync"in GameSDK?(await GameSDK.getTournamentAsync(),new qt):new V("getTournamentAsync")}catch(t){if(t instanceof qt)throw t}}},dp=io,co=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,extraData:a}=t,r=new R(this),n=new dp(this);r.setNext(n);let y=new W(this,{mode:H.CHALLENGE_FRIEND,customData:{playerId:e}});n.setNext(y);let g=new on(this,{ignoreId:e});y.setNext(g);let w=new tn(this,{extraData:a});g.setNext(w);let v=new le(this);w.setNext(v);let S=new Z(this);v.setNext(S);let D=new Y(this);S.setNext(D);let x=new rn(this);D.setNext(x);let b=new F(this);x.setNext(b);let _=this.match.getMatchState();await r.processAsync(_)}finally{this.m()}}},up=co;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var lo=class extends Error{constructor(t){super(t),this.name="JoinMatchFailed",this.message=t??"Join match failed"}},pp=lo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var uo=class extends Error{constructor(t){super(t),this.name="MatchAreFinished",this.message=t??"Match are finished"}},hp=uo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var po=class extends Error{constructor(t){super(t),this.name="OtherPlayerHasJoinedMatch",this.message=t??"Other player has joined match"}},mp=po,{Dtos:YP,Utils:{Object:JP}}=Ludex,ho=class extends L{async processAsync(t){super.processAsync(t),this.j(t);let e=await this.Yn(t),a=new YP.Match.Data(e).toObject();this.Qn(t,a),this.N(t,a),await this.n(t)}j(t){let{status:e}=t;if(e!==j.OPEN)throw new Ke}Qn(t,e){let{id:a,customData:r}=t,{_id:n,blackPlayerId:y,whitePlayerId:g,whitePlayerFinish:w,blackPlayerFinish:v}=e,S=y===r.playerId,D=g===r.opponentId;if(typeof n!="string"||n!==a||!D)throw new pp;if(w&&v)throw new hp;if(!S)throw new mp}async Yn(t){let{id:e}=t;return e?this.nt.api.getMatchAPI().joinMatchAsync(e):{}}N(t,e){this.K(t,e),this.H(t,e),this.V(t),this.mt(t,e)}K(t,e){let{extraData:a}=e;t.customData=JP.merge(t.customData,a)}H(t,e){let{whitePlayerId:a,blackPlayerId:r}=e,{customData:n}=t,y=a===n.playerId,g=y?a:r,w=y?r:a;t.customData.playerId=g,t.customData.opponentId=w}V(t){let{playerId:e,opponentId:a}=t.customData;if(!e||!a)return;let r={name:"",photo:"",finished:!1};t.profiles[e]||(t.profiles[e]=T({id:e},r)),t.profiles[a]||(t.profiles[a]=T({id:a},r))}mt(t,e){let{playerId:a,opponentId:r}=t.customData;if(!a||!r)return;let{whitePlayerId:n,whitePlayerScore:y,whitePlayerFinish:g,blackPlayerScore:w,blackPlayerFinish:v}=e,S=n===t.customData.playerId;t.profiles[a].score=S?y:w,t.profiles[r].score=S?w:y,t.profiles[a].finished=S?g:v,t.profiles[r].finished=S?v:g}},fp=ho;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var mo=class extends L{async processAsync(t){super.processAsync(t),this.c(t);let e=await this.Jn(t);e&&this.gt(t,e),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async Jn(t){try{let{frameCapture:e}=this.r,{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||!y)return null;let g=a[n],w=a[y];if(!g||!w)return null;let{photo:v,score:S=0,finished:D}=g;if(D)return null;let{photo:x,score:b=0,finished:_}=w;return _?await e.renderAsync("result-challenge",{playerId:n,playerPhoto:v,playerScore:S,opponentId:y,opponentPhoto:x,opponentScore:b,isPlayerFinished:!1,isOpponentFinished:!0}):null}catch{return null}}async gt(t,e){let{id:a,profiles:r,customData:n}=t,{playerId:y,opponentId:g}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let w=r[y];if(!w)throw new U;let{name:v}=w,S={data:{type:Ae.CHALLENGE_FRIEND,matchId:a,playerId:y,opponentId:g},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${v} accepted the challenge.`,localizations:{vi_VN:`${v} \u0111\xE3 ch\u1EA5p nh\u1EADn tham gia tr\u1EADn \u0111\u1EA5u.`}},image:e,strategy:"LAST",notification:"PUSH"};await GameSDK.extra.updateAsync(S)}},yp=mo,fo=class extends k{async processAsync(t){try{this.p(t);let{matchId:e,playerId:a,opponentId:r}=t,n=new R(this),y=new W(this,{id:e,mode:H.CHALLENGE_FRIEND,customData:{playerId:a,opponentId:r}});n.setNext(y);let g=new fp(this);y.setNext(g);let w=new le(this);g.setNext(w);let v=new Z(this);w.setNext(v);let S=new yp(this);v.setNext(S);let D=new Y(this);S.setNext(D);let x=new F(this);D.setNext(x);let b=this.match.getMatchState();await n.processAsync(b)}finally{this.m()}}},gp=fo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var XP={_id:"",status:"",appId:"",createdAt:"",startedAt:null,finishedAt:null,winnerId:"",whitePlayerId:"",blackPlayerId:"",whitePlayerScore:0,blackPlayerScore:0,whitePlayerFinish:!1,blackPlayerFinish:!1,extraData:{}},Pp=XP,{Configs:{AppId:ZP},Utils:{Valid:fe}}=Ludex,ye="is invalid",Qt=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateId(t){(!fe.isString(t)||!t)&&this.s("_id",ye)}validateStatus(t){(!fe.isString(t)||!t)&&this.s("status",ye)}validateAppId(t){(!fe.isString(t)||t!==ZP)&&this.s("appId",ye)}validateCreatedAt(t){fe.isString(t)||this.s("createdAt",ye)}validateStartedAt(t){t!==null&&(fe.isString(t)||this.s("startedAt",ye))}validateFinishedAt(t){t!==null&&(fe.isString(t)||this.s("finishedAt",ye))}validateExtraData(t){t!==null&&(fe.isObject(t)||this.s("extraData",ye))}validateWinnerId(t){t!==null&&(!fe.isString(t)||!t)&&this.s("winnerId",ye)}validateWhitePlayerId(t){(!fe.isString(t)||!t)&&this.s("whitePlayerId",ye)}validateBlackPlayerId(t){(!fe.isString(t)||!t)&&this.s("blackPlayerId",ye)}validateWhitePlayerScore(t){fe.isNumber(t)||this.s("whitePlayerScore",ye)}validateBlackPlayerScore(t){fe.isNumber(t)||this.s("blackPlayerScore",ye)}validateWhitePlayerFinish(t){fe.isBoolean(t)||this.s("whitePlayerFinish",ye)}validateBlackPlayerFinish(t){fe.isBoolean(t)||this.s("blackPlayerFinish",ye)}toObject(){return super.toObject()}};Qt.makeStrict(),Qt.addDefaults(Pp);var cn=Qt;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var yo=class extends Error{constructor(t){super(t),this.name="MatchAreNotFinished",this.message=t||"Match are not finished"}},Ap=yo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var go=class extends Error{constructor(t){super(t),this.name="OpponentNotFinishedMatch",this.message=t||"Opponent not finished match"}},$p=go,{Utils:{Object:eA}}=Ludex,Po=class extends L{async processAsync(t){super.processAsync(t),this.j(t);let e=await this.$t(t),a=new cn(e).toObject();this.Xn(t,a),this.N(t,a),this.Wt(t),this.hs(t),await this.n(t)}j(t){let{id:e}=t;if(typeof e!="string")throw new re}Xn(t,e){let{id:a}=t,{_id:r,whitePlayerFinish:n,blackPlayerFinish:y}=e;if(typeof r!="string"||r!==a)throw new $t;if(!n&&!y)throw new Ap}Wt(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(typeof r!="string")throw new G;let{finished:n}=e[r];if(!n)throw new en}hs(t){let{profiles:e,customData:a}=t,{opponentId:r}=a;if(typeof r!="string")throw new z;let{finished:n}=e[r];if(!n)throw new $p}async $t(t){let{id:e}=t;return e?this.nt.api.getMatchAPI().getMatchDetailByIdAsync(e):null}N(t,e){this.K(t,e),this.H(t,e),this.V(t),this.mt(t,e)}K(t,e){let{extraData:a}=e;t.status=j.FINISHED,t.customData=eA.merge(t.customData,a)}H(t,e){let{whitePlayerId:a,blackPlayerId:r}=e,{customData:n}=t,y=a===n.playerId,g=y?a:r,w=y?r:a;t.customData.playerId=g,t.customData.opponentId=w}V(t){let{playerId:e,opponentId:a}=t.customData;if(!e||!a)return;let r={name:"",photo:"",finished:!0};t.profiles[e]||(t.profiles[e]=T({id:e},r)),t.profiles[a]||(t.profiles[a]=T({id:a},r))}mt(t,e){let{playerId:a,opponentId:r}=t.customData;if(!a||!r)return;let{whitePlayerId:n,whitePlayerScore:y,whitePlayerFinish:g,blackPlayerScore:w,blackPlayerFinish:v}=e,S=n===t.customData.playerId;t.profiles[a].score=S?y:w,t.profiles[r].score=S?w:y,t.profiles[a].finished=S?g:v,t.profiles[r].finished=S?v:g}},xp=Po,Ao=class extends k{async processAsync(t){try{this.p(t);let{matchId:e,playerId:a,opponentId:r}=t,n=new R(this),y=new W(this,{id:e,mode:H.CHALLENGE_FRIEND,customData:{playerId:a,opponentId:r}});n.setNext(y);let g=new xp(this);y.setNext(g);let w=new le(this);g.setNext(w);let v=new F(this);w.setNext(v);let S=this.match.getMatchState();await n.processAsync(S)}finally{this.m()}}},wp=Ao;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var $o=class extends k{ma;async processAsync(t){try{this.p(t);let{playerId:e,extraData:a,fallbackSingleMode:r}=t;this.ma=r;let n=await this.Zn({playerId:e,extraData:a});if(n===!0)return;if(n instanceof qt)await this.ti(e);else if(this.ma)await this.ga(e);else throw n}finally{this.m()}}Zn=async t=>{try{return await this.match.challenge.invite.processAsync(t),!0}catch(e){return e}};ti=async t=>{try{let e=GameSDK.context.getID();if(typeof e!="string")throw new X;await this.match.tournament.continue.processAsync({playerId:t,contextId:e})}catch{await this.ga(t)}};ga=async t=>this.match.single.start.processAsync({playerId:t})},bp=$o;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var xo=class extends Error{constructor(t){super(t),this.name="LeaderboardIdNotValid",this.message=t??"Leaderboard id is not valid"}},Te=xo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:vp}=Ludex.Utils,wo=class extends L{t;qt;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.zt(t),"submitGameResultsAsync"in GameSDK.extra&&await GameSDK.extra.submitGameResultsAsync(this.t.score),this.ys(),await this.n(t)}async zt(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(!r||!e[r])throw new U;let{score:n,leaderboardId:y}=this.t;if(!vp.isNumber(n))throw new vt;if(!vp.isString(y))throw new Te;this.qt={score:n,playerId:r,leaderboardId:y}}async ys(){try{let{playerId:t,score:e,leaderboardId:a}=this.qt,r=this.r.leaderboard.getLeaderboardName(a);if(!r)throw new an;await this.r.leaderboard.setLeaderboardScoreAsync(r,t,e)}catch{}}},ln=wo,{Utils:{Valid:tA}}=Ludex,bo=class extends ln{constructor(t){super(t,{score:0,leaderboardId:""})}async zt(t){let{profiles:e,customData:a}=t,{playerId:r,leaderboardId:n}=a;if(!n)throw new Te;if(!r||!e[r])throw new U;let{score:y}=e[r];if(!tA.isNumber(y))throw new vt;this.t.score=y,this.t.leaderboardId=n,super.zt(t)}},St=bo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var vo=class extends L{async processAsync(t){super.processAsync(t),this.c(t),this.ei(t),await this.n(t)}c(t){let{id:e,customData:a}=t,{contextId:r,opponentId:n}=a;if(!e||typeof e!="string")throw new re;if(!r||typeof r!="string")throw new X;if(!n||typeof n!="string")throw new z}async si(t){try{let{frameCapture:e}=this.r,{profiles:a,customData:r}=t,{playerId:n,opponentId:y}=r;if(!n||!y)return null;let g=a[n],w=a[y];if(!g||!w)return null;let{photo:v,score:S=0}=g,{photo:D,score:x=0}=w;return await e.renderAsync("result-challenge",{playerId:n,playerPhoto:v,playerScore:S,opponentId:y,opponentPhoto:D,opponentScore:x,isPlayerFinished:!0,isOpponentFinished:!0})}catch{return null}}async ai(t){try{let{player:e,frameCapture:a}=this.r,{playerId:r}=t.customData,{playerId:n,photo:y,data:g}=e.getPlayer();if(r!==n)return null;let{score:w}=g||{};return await a.renderAsync("share-score",{playerId:n,playerPhoto:y,playerScore:w})}catch{return null}}async ei(t){let{profiles:e,customData:a}=t,{playerId:r,opponentId:n}=a;if(n&&typeof n=="string"){if(!r||typeof r!="string")throw new G;let g=e[r],w=e[n];if(!g||!w)return;let{score:v=0}=g,{score:S=0}=w;if(v>S){let D=await this.si(t);if(!D)return;this.ps(t,D);return}}let y=await this.ai(t);y&&this.ri(t,y)}async ps(t,e){let{profiles:a,customData:r}=t,{playerId:n}=r;if(!n||typeof n!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");let y=a[n];if(!y)throw new U;let{name:g,score:w}=y,v={data:{type:this.r.context.getSessionContextTypes().MATCHING_GROUP,playerId:n,playerName:g,playerScore:w},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i"}},text:{default:`${g} beats your high score. Their score: ${w}.`,localizations:{vi_VN:`${g} v\u1EEBa v\u01B0\u1EE3t \u0111i\u1EC3m s\u1ED1 cao nh\u1EA5t c\u1EE7a b\u1EA1n! Ch\u01A1i l\u1EA7n n\u1EEFa ch\u1EE9?`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(v)}async ri(t,e){let{profiles:a,customData:r}=t,{playerId:n}=r;if(!n||typeof n!="string")throw new G;let y=a[n];if(!y)throw new U;let{name:g,score:w}=y,v={data:{type:this.r.context.getSessionContextTypes().MATCHING_GROUP,playerId:n,playerName:g,playerScore:w},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${g} got ${w} scores. So easy! Can you?`,localizations:{vi_VN:`${g} \u0111\xE3 \u0111\u1EA1t ${w} \u0111i\u1EC3m! Qu\xE1 d\u1EC5 lu\xF4n. Ch\u01A1i l\u1EA1i n\xE0o!`}},image:e,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new V("updateAsync");await GameSDK.extra.updateAsync(v)}},Sp=vo,So=class extends k{async processAsync(){try{this.p();let t=new R(this),e=new Ce(this,{useAPI:!1});t.setNext(e);let a=new Sp(this);e.setNext(a);let r=new Le(this);a.setNext(r);let n=new Ee(this);r.setNext(n);let y=new St(this);n.setNext(y);let g=new F(this);y.setNext(g);let w=this.match.getMatchState();await t.processAsync(w)}finally{this.m()}}},Dp=So;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:rA,Utils:{Object:nA}}=Ludex,Do=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.ni(t),await this.n(t)}ni(t){let{id:e}=this.t,{profiles:a}=t;if(!a[e])throw new U;let r=nA.merge(a[e],this.t),n=new rA.Match.Profile(r).toObject();a[n.id]=n}},We=Do,Io=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,opponentId:a,opponentScore:r}=t,n=new R(this),y=new W(this,{id:"7749",mode:H.MATCHING_GROUP,customData:{playerId:e,opponentId:a}});n.setNext(y);let g=new le(this);y.setNext(g);let w=new We(this,{id:e,score:r});g.setNext(w);let v=new Z(this);w.setNext(v);let S=new Y(this);v.setNext(S);let D=new F(this);S.setNext(D);let x=this.match.getMatchState();await n.processAsync(x)}finally{this.m()}}},Ip=Io;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Lo=class extends Error{constructor(t){super(t),this.name="MatchGroupNotSupported",this.message=t??"Match group is not supported"}},Co=Lo,Eo=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),await this.ii();let e=await this.oi();t.customData.contextId=e,await this.n(t)}async ii(){if(!("getSupportedAPIs"in GameSDK))throw new V("getSupportedAPIs");if(!("checkCanPlayerMatchAsync"in GameSDK.extra))throw new V("checkCanPlayerMatchAsync");if(!(GameSDK.getSupportedAPIs().indexOf("checkCanPlayerMatchAsync")>-1))throw new Co;if(!await GameSDK.extra.checkCanPlayerMatchAsync())throw new Co}async oi(){if(!("matchPlayerAsync"in GameSDK.extra))throw new V("matchPlayerAsync");let{matchTag:t,autoSwitch:e=!1,onlyExisting:a=!1}=this.t;await GameSDK.extra.matchPlayerAsync(t,e,a);let r=GameSDK.context.getID();if(typeof r!="string")throw new bt;return r}},Lp=Eo,To=class extends k{async processAsync(t){try{this.p(t);let{matchTag:e,playerId:a,options:r}=t,n=new R(this),y=new Lp(this,T({matchTag:e},r));n.setNext(y);let g=new W(this,{id:"7749",mode:H.MATCHING_GROUP,customData:{playerId:a}});y.setNext(g);let w=new on(this,{ignoreId:a});g.setNext(w);let v=new Z(this);w.setNext(v);let S=new le(this);v.setNext(S);let D=new Y(this);S.setNext(D);let x=new F(this);D.setNext(x);let b=this.match.getMatchState();await n.processAsync(b)}finally{this.m()}}},Cp=To;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Mo=class extends k{async processAsync(){try{this.p();let t=new R(this),e=new Ce(this,{useAPI:!1});t.setNext(e);let a=new Le(this);e.setNext(a);let r=new Ee(this);a.setNext(r);let n=new je(this);r.setNext(n);let y=new F(this);n.setNext(y);let g=this.match.getMatchState();await t.processAsync(g)}finally{this.m()}}},Ep=Mo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Oo=class extends Error{constructor(t){super(t),this.name="ProfileIdNotDefined",this.message=t??"Profile id is not defined"}},Tp=Oo,{Dtos:aA}=Ludex,_o=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t);let{profileId:e}=this.t;if(!e)throw new Tp;let{player:a}=this.r,r=a.getPlayerId(),n;if(e===r)n=this.we();else if(n=await this.li(e),!n)throw new U;this.N(n,t),await this.n(t)}we(){let{player:t}=this.r,{playerId:e,name:a,photo:r,locale:n}=t.getPlayer();return{playerId:e,name:a,photo:r,locale:n}}async li(t){let{profile:e}=this.r;return await e.requestProfiles([t]),e.getProfiles()[t]}N(t,e){let{playerId:a,name:r,photo:n}=t,y=new aA.Match.Profile({id:a,name:r,photo:n}).toObject();e.profiles[a]=y}},Me=_o,No=class extends k{async processAsync(t){try{this.p(t);let{playerId:e}=t,a=new R(this),r=new He(this,{contextId:"SOLO"});a.setNext(r);let n=new W(this,{id:"123456",mode:H.SINGLE,customData:{playerId:e}});r.setNext(n);let y=new Z(this);n.setNext(y);let g=new Me(this,{profileId:e});y.setNext(g);let w=new Y(this);g.setNext(w);let v=new F(this);w.setNext(v);let S=this.match.getMatchState();await a.processAsync(S)}finally{this.m()}}},Mp=No;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ko=class extends k{async processAsync(t){try{this.p(t);let{setPlayerBestScore:e=!1,postGlobalLeaderboard:a=!1}=t??{},r=new R(this),n=new Ce(this,{useAPI:!1});r.setNext(n);let y=new Le(this);n.setNext(y);let g=new Ee(this,{ignore:!e});y.setNext(g);let w=new je(this,{ignore:!a});g.setNext(w);let v=new F(this);w.setNext(v);let S=this.match.getMatchState();await r.processAsync(S)}finally{this.m()}}},Op=ko;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ro=class extends k{async processAsync(t){try{this.p(t);let{matchId:e,playerId:a,gameMode:r,extraData:n={}}=t,y=new R(this),g=new He(this,{contextId:"SOLO"});y.setNext(g);let w=new W(this,{id:e,mode:r,customData:T({playerId:a},n)});g.setNext(w);let v=new Z(this);w.setNext(v);let S=new Me(this,{profileId:a});v.setNext(S);let D=new Y(this);S.setNext(D);let x=new F(this);D.setNext(x);let b=this.match.getMatchState();await y.processAsync(b)}finally{this.m()}}},_p=Ro;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Plugins:{Analytics:{Events:Np}={}},Utils:{String:sA,Valid:oA}}=Ludex,Go=class extends L{async processAsync(t){super.processAsync(t);let{mode:e,customData:a}=t;this.Vt(e);let{analytics:r}=this.r,{tournamentId:n,leaderboardId:y}=a;Np&&r?.event(Np.TOURNAMENT_START,{success:!0,game_mode:sA.toUpperCamelCase(e),tournament_id:n,leaderboard_id:y}),await this.n(t)}Vt(t){if(!oA.isString(t))throw new At}},dn=Go;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Fo=class extends Error{constructor(t){super(t),this.name="TournamentIdNotValid",this.message=t??"Tournament id is not valid"}},un=Fo,{Valid:Bo}=Ludex.Utils,Vo=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t);let{contextId:e}=this.t;this.ms(e);let a=await GameSDK.getTournamentAsync(),r=a.getID().toString(),n=a.getTournamentType();if(this.gs(r),t.customData.contextId=e,t.customData.tournamentId=r,n!=="DAILY"){let y=JSON.parse(a.getPayload()||"{}"),{leaderboardId:g}=y;this.fs(g),t.customData.leaderboardId=g}await this.n(t)}ms(t){if(!Bo.isString(t))throw new X}gs(t){if(!Bo.isString(t))throw new un}fs(t){if(!Bo.isString(t)||t==="")throw new Te}},kp=Vo,Uo=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,contextId:a}=t,r=new R(this),n=new kp(this,{contextId:a});r.setNext(n);let y=new W(this,{id:"1997",mode:H.TOURNAMENT,customData:{playerId:e}});n.setNext(y);let g=new Z(this);y.setNext(g);let w=new Me(this,{profileId:e});g.setNext(w);let v=new Y(this);w.setNext(v);let S=new dn(this);v.setNext(S);let D=new F(this);v.setNext(D);let x=this.match.getMatchState();await r.processAsync(x)}finally{this.m()}}},Rp=Uo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Plugins:{Analytics:{Events:Gp}={}}}=Ludex,Ko=class extends L{async processAsync(t){super.processAsync(t);let{customData:e}=t,{analytics:a}=this.r,{tournamentId:r,leaderboardId:n}=e;Gp&&a.event(Gp.TOURNAMENT_CREATE,{success:!0,tournament_id:r,leaderboard_id:n}),await this.n(t)}},Fp=Ko;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var Ho=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),await this.ci(),await this.hi(t),await this.n(t)}async ci(){let{name:t,score:e,customData:a}=this.t;await GameSDK.tournament.createAsync({initialScore:e,config:{title:t,tournamentTitle:t},data:a})}async hi(t){try{if(!("getTournamentAsync"in GameSDK))throw new V("getTournamentAsync");let e=await GameSDK.getTournamentAsync(),a=e.getContextID(),r=e.getID().toString(),{playerId:n}=this.t;t.customData.playerId=n,t.customData.contextId=a,t.customData.tournamentId=r}catch(e){if(e instanceof V)return}}},Bp=Ho;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Vp}=Ludex.Utils,jo=class extends L{t;qt;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.di(),await this.ui(t),await this.yi(t),await this.n(t)}di(){let{leaderboardId:t}=this.t;if(!Vp.isString(t))throw new Te}Ae(t){if(!Vp.isString(t))throw new G}async ui(t){let{playerId:e}=t.customData;this.Ae(e);let{name:a,leaderboardId:r,customData:n}=this.t;this.qt={_id:r,name:a??"",createdBy:e,description:JSON.stringify(n)}}async yi(t){let e=await this.r.leaderboard.createLeaderboardAsync(this.qt);t.customData.leaderboardId=e}},Up=jo,Wo=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,name:a,score:r,leaderboardId:n,payload:y}=t,g=new R(this),w=new He(this,{contextId:"SOLO"});g.setNext(w);let v=new Bp(this,{name:a,score:r,playerId:e,customData:y});w.setNext(v);let S=new Me(this,{profileId:e});v.setNext(S);let D=new We(this,{id:e,score:r});S.setNext(D);let x=new Up(this,{name:a,customData:y,leaderboardId:n});D.setNext(x);let b=new St(this);x.setNext(b);let _=new Fp(this);b.setNext(_);let M=this.match.getMatchState();await g.processAsync(M)}finally{this.m()}}},Kp=Wo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Plugins:{Analytics:Hp},Utils:{Valid:iA}}=Ludex,zo=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.c(t),await this.pi(t),await this.n(t)}c(t){let{profiles:e,customData:a}=t,{playerId:r}=a;if(this.Ae(r),!e[r])throw new U}Ae(t){if(!iA.isString(t))throw new G}we(t){let{profiles:e,customData:a}=t,{playerId:r}=a;return this.Ae(r),e[r]}mi(t){let e=this.we(t),{score:a=0,bestScore:r=0}=e;return a>r}async pi(t){let{analytics:e}=codex,a=this.we(t),{score:r=0}=a,n=null,y=!1,{checkBestScore:g}=this.t,w=this.mi(t);try{if(!("getTournamentAsync"in GameSDK))throw new V("getTournamentAsync");await GameSDK.getTournamentAsync(),!g||w?(n=Hp.Events.TOURNAMENT_SHARE,await GameSDK.tournament.shareAsync({score:r})):(n=Hp.Events.TOURNAMENT_POST_SCORE,await GameSDK.tournament.postScoreAsync(r)),y=!0}catch{}finally{n&&e?.event(n,{success:y})}}},jp=zo,qo=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,bestScore:a,checkBestScore:r=!1}=t,n=new R(this),y=new Ce(this,{useAPI:!1});n.setNext(y);let g=new We(this,{id:e,bestScore:a});y.setNext(g);let w=new jp(this,{checkBestScore:r});g.setNext(w);let v=new Le(this);w.setNext(v);let S=new Ee(this);v.setNext(S);let D=new St(this);S.setNext(D);let x=new je(this);D.setNext(x);let b=new F(this);x.setNext(b);let _=this.match.getMatchState();await n.processAsync(_)}finally{this.m()}}},Wp=qo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Qo,Object:cA}=Ludex.Utils,Yo=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t);let{tournamentId:e}=this.t;this.gs(e),await this.gi(e);let a=await GameSDK.getTournamentAsync(),r=a.getContextID();this.ms(r);let n=JSON.parse(a.getPayload()||"{}"),{leaderboardId:y}=n;this.fs(y),t.customData.contextId=r,t.customData.tournamentId=e,t.customData.leaderboardId=y,await this.n(t)}gs(t){if(!Qo.isString(t))throw new un}ms(t){if(!Qo.isString(t))throw new X}fs(t){if(!Qo.isString(t)||t==="")throw new Te}async gi(t){if(!("tournament"in GameSDK))throw new V("tournament");try{await GameSDK.tournament.joinAsync(t)}catch(e){if(!cA.hasOwn(e,"code")||e.code!=="SAME_CONTEXT")throw e}}},zp=Yo,Jo=class extends k{async processAsync(t){try{this.p(t);let{playerId:e,tournamentId:a}=t,r=new R(this),n=new zp(this,{tournamentId:a});r.setNext(n);let y=new W(this,{id:"1997",mode:H.TOURNAMENT,customData:{playerId:e}});n.setNext(y);let g=new Z(this);y.setNext(g);let w=new Me(this,{profileId:e});g.setNext(w);let v=new Y(this);w.setNext(v);let S=new dn(this);v.setNext(S);let D=new F(this);S.setNext(D);let x=this.match.getMatchState();await r.processAsync(x)}finally{this.m()}}},qp=Jo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:lA,Utils:dA}=Ludex,{Object:uA}=dA,Xo=class extends L{async processAsync(t){super.processAsync(t);let e=await this.fi(t);this.ws(t,e),await this.n(t)}async fi(t){let{id:e}=t;return e?(await this.nt.api.getMatchAPI().getMatchDetailByIdAsync(e))?.extraData??{}:{}}ws(t,e){let a=uA.merge(t.customData,e),r=new lA.Match.CustomData(a).toObject();t.customData=r}},Qp=Xo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:pA,Utils:hA}=Ludex,{Object:mA}=hA,Zo=class extends L{t;constructor(t,e){super(t),this.t=e}async processAsync(t){super.processAsync(t),this.ws(t),await this.n(t)}ws(t){let e=mA.merge(t.customData,this.t),a=new pA.Match.CustomData(e).toObject();t.customData=a}},Yp=Zo;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var fA={id:null,mode:null,status:null,startAt:0,finishAt:0,profiles:{},customData:T({},wt)},Jp=fA,{Configs:Xp}=Ludex,ei=class extends Ludex.Plugins.BasePlugin{Yt;group;single;context;strategy;challenge;tournament;api;handler;useCPUProfile;init(){this.wi(),this.Ai(),this.vi(),this.Ii(),this.Si()}setUseCPUProfile(t){this.useCPUProfile=t}wi(){let{storage:t}=this.codex;t.addStorage("match",Jp)}getMatchState(){let{storage:t}=this.codex;return t.getStorage("match")}vi(){this.Yt=new k(this.codex,this)}Ii(){this.Di(),this.Ei(),this.xi(),this.bi(),this.Pi(),this.Li()}Si(){this.handler={setProfileData:async t=>{let e=new We(this.Yt,t);await this.ve(e)},setMatchCustomData:async t=>{let e=new Yp(this.Yt,t);await this.ve(e)},getMatchCustomData:async()=>{let t=new Qp(this.Yt);await this.ve(t)},setLeaderboardScore:async t=>{let e=new ln(this.Yt,t);await this.ve(e)}}}Ai(){let t={appId:Xp.AppId,matchAPIHost:Xp.ApiHost};this.api=new Bu(t)}Di(){this.group={join:new Ip(this.codex,this),start:new Cp(this.codex,this),finish:new Dp(this.codex,this)}}Ei(){this.single={start:new Mp(this.codex,this),finish:new Ep(this.codex,this)}}bi(){this.strategy={start:new _p(this.codex,this),finish:new Op(this.codex,this)}}xi(){this.context={choose:new bp(this.codex,this)}}Pi(){this.challenge={invite:new up(this.codex,this),friend:new Ju(this.codex,this),join:new gp(this.codex,this),await:new zu(this.codex,this),result:new wp(this.codex,this),finish:new op(this.codex,this),continue:new tp(this.codex,this)}}Li(){this.tournament={join:new qp(this.codex,this),create:new Kp(this.codex,this),finish:new Wp(this.codex,this),continue:new Rp(this.codex,this)}}ve(t){let e=this.getMatchState();return t.processAsync(e)}},Zp=ei;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Ze}=Ludex.Utils,et="is invalid",Yt=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateLevel(t){(!Ze.isNumber(t)||t<0)&&this.s("level",et)}validateRescued(t){(!Ze.isNumber(t)||t<0)&&this.s("rescued",et)}validateContextId(t){Ze.isString(t)||this.s("contextId",et)}validatePlayerId(t){Ze.isString(t)||this.s("playerId",et)}validateOpponentId(t){!Ze.isString(t)&&t!==null&&this.s("opponentId",et)}validateTournamentId(t){!Ze.isString(t)&&t!==null&&this.s("tournamentId",et)}validateLeaderboardId(t){!Ze.isString(t)&&t!==null&&this.s("leaderboardId",et)}toObject(){return super.toObject()}};Yt.makeStrict(),Yt.addDefaults(wt);var eh=Yt;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:Dt}=Ludex.Utils,It="is invalid",pn=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateId(t){(!Dt.isString(t)||!t)&&this.s("id",It)}validateName(t){(!Dt.isString(t)||!t)&&this.s("name",It)}validatePhoto(t){Dt.isString(t)||this.s("photo",It)}validateScore(t){(!Dt.isNumber(t)||t<0)&&this.s("score",It)}validateBestScore(t){(!Dt.isNumber(t)||t<0)&&this.s("bestScore",It)}validateFinished(t){Dt.isBoolean(t)||this.s("finished",It)}toObject(){return super.toObject()}};pn.addDefaults({id:"10",name:"Your Friend",score:0,bestScore:0,finished:!1});var th=pn;Ludex.Dtos.Match={Data:cn,Profile:th,CustomData:eh};var rh=Zp;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Utils:{Object:yA},Configs:{ApiHost:nh}}=Ludex,gA=()=>{let t="players";return GameSDK.isGameSDK("MsGames")?t+="?platform=ms-games":GameSDK.isGameSDK("Yandex")&&(t+="?platform=yandex"),t},ah=async t=>{if(!nh)return{};let e=gA(),a=await me(e,t,{},nh,10);return yA.hasOwn(a,"data")?a.data||{}:{}},{Utils:{Array:PA,Object:hn,Valid:AA,Function:$A},Configs:{AppId:xA}}=Ludex,ti=class extends Ludex.Plugins.BasePlugin{fa=!1;init(){let{storage:t}=this.codex;t.addStorage("player",ge)}receiveData(t,e){let{storage:a}=this.codex,{playerId:r,name:n,photo:y,locale:g}=t;a.setStorageData("player","playerId",r),a.setStorageData("player","name",n),a.setStorageData("player","photo",y),a.setStorageData("player","locale",g),e&&(this.setPlayerData(e),this.fa=!e.isFirstLogin)}async syncDataToSDK(){try{let t=this.getPlayerData();await GameSDK.player.setDataAsync(t)}catch{}}async syncProfileToServer(){if(GameSDK.extra.isGuest)throw new Error("Guest player cannot sync profile to server");let{storage:t}=this.codex,e=this.getPlayer(),{playerId:a,name:r,photo:n,locale:y}=e,g=this.getPlayerASID();if(!AA.isString(g)&&"getASIDAsync"in GameSDK.player){let[w,v]=await $A.handleAsync(GameSDK.player.getASIDAsync(),1e4);!v&&w&&(g=w,t.setStorageData("player","ASID",g))}await ah({appId:xA,ASID:g,playerId:a,name:r,photo:n,locale:y})}setPlayerDataByName(t,e){this.setPlayerData({[t]:e})}setPlayerData(t){let{storage:e}=this.codex;e.setStorageData("player","data",t),this.syncDataToSDK()}setBestScore(t){this.setPlayerDataByName("score",t)}setSetting(t,e){this.setPlayerDataByName("settings",{[t]:e})}setGameData(t){let e=this.getGameData()??{},a=hn.merge(e,t);this.setPlayerDataByName("gameData",a)}async requestConnectedPlayers(){let{storage:t}=this.codex,e=(await GameSDK.player.getConnectedPlayersAsync()).map(n=>{let y=n.getID(),g=n.getName(),w=n.getPhoto();return!y||!g||!w?null:new ft({playerId:y,name:g,photo:w}).toObject()}),a=PA.unique(e);if(a.length<1)return;let r=hn.keyBy(a,"playerId");t.setStorageData("player","connectedPlayers",r)}getPlayer(){let{storage:t}=this.codex;return t.getStorage("player")}getPlayerId(){let{storage:t}=this.codex;return t.getStorageData("player","playerId")??""}getPlayerASID(){let{storage:t}=this.codex;return t.getStorageData("player","ASID")??null}getPlayerLocale(){let{storage:t}=this.codex;return t.getStorageData("player","locale")??""}getPlayerData(){let{storage:t}=this.codex;return t.getStorageData("player","data")??ge.data}getPlayerDataByKey(t){let e=this.getPlayerData();return hn.hasOwn(e,t)?e[t]:null}getGameData(){return this.getPlayerDataByKey("gameData")}getPlayerSetting(t){let e=this.getPlayerSettings();return hn.hasOwn(e,t)?e[t]:null}getPlayerSettings(){let{settings:t}=this.getPlayerData();return t}isFirstLogin(){return this.getPlayerDataByKey("isFirstLogin")??ge.data.isFirstLogin}isFirstSession(){return!this.fa}loggedIn(){this.setPlayerDataByName("isFirstLogin",!1)}getBestScore(){let{score:t}=this.getPlayerData();return t}getConnectedPlayers(){let{storage:t}=this.codex;return t.getStorageData("player","connectedPlayers")??{}}getConnectedPlayerIds(t,e){let a=this.getConnectedPlayers();return Object.keys(a).slice(e,e+t)}getNotificationData(){return this.getPlayerDataByKey("notificationData")??ge.data.notificationData}},sh=ti;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Dtos:oh,Utils:{Valid:ne,Object:kze}}=Ludex,{score:wA,settings:bA,gameData:vA,isFirstLogin:SA,missionsData:DA,notificationData:IA,dailyRewardedData:LA,lastCallSwitchGame:CA}=ge.data,ae="is invalid",mn=class extends ee{js(t){ne.isObject(t)&&(t.settings=new oh.Player.Settings(t.settings).toObject(),t.gameData=new oh.Player.GameData(t.gameData).toObject())}X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateScore(t){(!ne.isNumber(t)||t<0)&&this.s("score",ae)}validateSettings(t){ne.isObject(t)||this.s("settings",ae)}validateMissionsData(t){ne.isObject(t)||this.s("missionsData",ae),(!("process"in t)||!ne.isObject(t.process))&&this.s("missionsData.process",ae)}validateNotificationData(t){ne.isObject(t)||this.s("notificationData",ae),(!("D1"in t)||!ne.isObject(t.D1))&&this.s("notificationData.D1",ae),(!("D2"in t)||!ne.isObject(t.D2))&&this.s("notificationData.D2",ae),(!("D3"in t)||!ne.isObject(t.D3))&&this.s("notificationData.D3",ae),(!("D4"in t)||!ne.isObject(t.D4))&&this.s("notificationData.D4",ae),(!("D5"in t)||!ne.isObject(t.D5))&&this.s("notificationData.D5",ae),(!("D6"in t)||!ne.isObject(t.D6))&&this.s("notificationData.D6",ae),(!("D7"in t)||!ne.isObject(t.D7))&&this.s("notificationData.D7",ae)}validateGameData(t){ne.isObject(t)||this.s("gameData",ae)}validateIsFirstLogin(t){ne.isBoolean(t)||this.s("isFirstLogin",ae)}validateDailyRewardedData(t){ne.isObject(t)||this.s("dailyRewardedData",ae)}validateLastCallSwitchGame(t){ne.isNumber(t)||this.s("lastCallSwitchGame",ae),t<0&&this.s("lastCallSwitchGame",ae)}toObject(){return super.toObject()}};mn.addDefaults({score:wA,settings:bA,gameData:vA,isFirstLogin:SA,missionsData:DA,notificationData:IA,dailyRewardedData:LA,lastCallSwitchGame:CA});var ih=mn;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:ch}=Ludex.Utils,{level:EA,coins:TA}=ge.data.gameData,fn=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateLevel(t){(!ch.isNumber(t)||t<0)&&this.s("level","is invalid")}validateCoins(t){(!ch.isNumber(t)||t<0)&&this.s("coins","is invalid")}toObject(){return super.toObject()}};fn.addDefaults({level:EA,coins:TA});var lh=fn;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Valid:yn}=Ludex.Utils,{sound:MA,music:OA,vibrate:_A,language:NA}=ge.data.settings,gn="is invalid",Pn=class extends ee{X(t){this.et(t)}J(t){this.Z(t)}c(t){this.tt(t)}validateSound(t){yn.isBoolean(t)||this.s("sound",gn)}validateMusic(t){yn.isBoolean(t)||this.s("music",gn)}validateVibrate(t){yn.isBoolean(t)||this.s("vibrate",gn)}validateLanguage(t){(!yn.isString(t)||!t)&&this.s("language",gn)}toObject(){return super.toObject()}};Pn.addDefaults({sound:MA,music:OA,vibrate:_A,language:NA});var dh=Pn;Ludex.Dtos.Player={Info:ft,Data:ih,Settings:dh,GameData:lh};var uh=sh;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Configs:{ApiHost:ph,Mockup:kA},Utils:{Object:RA,String:GA}}=Ludex,ri=class{L;async pt(){if(this.L)return;let t=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof t!="function")throw new Error("Cannot load ProfileAPIMock");this.L=new t}async getPlayersAsync(t){let e=GA.params(t),a;if(kA.Profile.Enabled)await this.pt(),a=await this.L.getPlayersAsync(t);else{if(!ph)return[];a=await Ne(`players?${e}`,{},ph)}return!RA.hasOwn(a,"data")||!Array.isArray(a.data)?[]:a.data}},hh=ri;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var FA={profiles:{},profileIds:[]},ni=FA,{Utils:BA,Dtos:VA}=Ludex,{Array:mh,Valid:UA,Object:KA,Function:HA}=BA,ai=class extends Ludex.Plugins.BasePlugin{_i=new hh;init(){let{storage:t}=this.codex;t.addStorage("profile",ni)}async requestProfiles(t){let e=this.getProfileIds(),a=mh.difference(t,e);if(a.length<1)return;let r=mh.chunk(a,400).map(g=>this._i.getPlayersAsync({playerIds:g})),n=(await HA.allSettled(r)).reduce((g,w)=>w.status==="fulfilled"?g.concat(w.value):g,[]);if(!this.Oi(n))return;let y=this.Ci(n);this.Ni(y)}getProfile(t){return this.getProfiles()[t]??null}getProfiles(){let{storage:t}=this.codex;return t.getStorageData("profile","profiles")??ni.profiles}Ni(t){let{storage:e}=this.codex;e.setStorageData("profile","profiles",t),e.setStorageData("profile","profileIds",Object.keys(t))}getProfileIds(){let{storage:t}=this.codex;return t.getStorageData("profile","profileIds")??[]}Oi(t){return!(!Array.isArray(t)||t.length<1)}Ci(t){let e={};for(let a of t)KA.hasOwn(a,"playerId")&&UA.isString(a.playerId)&&(e[a.playerId]=new VA.Player.Info(a).toObject());return e}},fh=ai,yh=fh;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var gh="Tile Connect Remaster",{Utils:{Object:Ph,Valid:Ah,Browser:$h}}=Ludex,si=class extends Ludex.Plugins.BasePlugin{Lt;wa={};constructor(t){super(t),this.Lt={}}async addStorage(t,e,a=!1){this.Lt[t]=e,a&&await this.Ti(t,e)}async Ti(t,e){this.wa[t]=!0;let a=await $h.getIndexedDB(`${gh}_S_${t}`);if(!Ah.isObject(a))return;let r=Object.keys(e);for(let n of r)Ph.hasOwn(a,n)&&typeof e[n]==typeof a[n]&&this.setStorageData(t,n,a[n])}initStorageData(t,e,a){this.Lt[t][e]=a}setStorageData(t,e,a){let r;if(Ah.isObject(a)){let n=this.getStorageData(t,e);r=Ph.merge(n,a)}else r=a;this.Lt[t][e]=r}getStorageData(t,e){return this.getStorage(t)[e]}getStorage(t){return this.Lt[t]}async updateToWebStorage(t,e=!1){if(this.wa[t])return this.Ri(t,e)}async Ri(t,e=!1){let a=this.getStorage(t);await $h.setIndexedDB(`${gh}_S_${t}`,a),e&&Object.assign(this.Lt[t],{})}},xh=si,wh=xh;s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var oi=class extends Ludex.Plugins.BasePlugin{Qt=!0;Mi=["moz","ms","o","","webkit"];init(){let t=this.Aa(),e=[this.Gi(t),"focus","blur"];for(let a of e)this.Ie(window,a),this.Ie(document,a);GameSDK.extra&&("onPause"in GameSDK.extra&&GameSDK.extra.onPause(()=>this.Se("blur")),"onResume"in GameSDK.extra&&GameSDK.extra.onResume(()=>this.Se("focus"))),this.Ie(window,"pageshow"),this.Ie(window,"pagehide"),window.addEventListener("message",a=>{(a.data==="nativePause"||a.data==="nativeResume")&&this.Se(a.data)},!1)}isGameVisible(){return this.Qt}va(t){return t?`${t}Hidden`:"hidden"}Gi(t){return`${t||""}visibilitychange`}Aa(){for(let t of this.Mi)if(this.va(t)in document)return t;return""}Jt(){this.Qt||(this.Qt=!0,this.codex.event.emit(Ludex.Events.VISIBILITY_VISIBLE))}Xt(){this.Qt&&(this.Qt=!1,this.codex.event.emit(Ludex.Events.VISIBILITY_HIDDEN))}Ie(t,e){t.addEventListener(e,()=>{this.Se(e)},!1)}Se=t=>{let e={focus:this.Jt.bind(this),pageshow:this.Jt.bind(this),nativeResume:this.Jt.bind(this),blur:this.Xt.bind(this),pagehide:this.Xt.bind(this),nativePause:this.Xt.bind(this)};if(e[t]){e[t]();return}if(document.visibilityState){document.visibilityState==="hidden"?this.Xt():this.Jt();return}let a=this.Aa(),r=this.va(a);r in document&&(document[r]?this.Xt():this.Jt())}},bh=oi,vh=bh;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var ii=class extends Br{async loadAsync(){this.s("This method is not implemented")}async showAsync(){this.s("This method is not implemented")}async hideAsync(){this.s("This method is not implemented")}},Sh=ii,{Status:ci}=Ludex.Plugins.Ads,li=class extends Sh{async loadAsync(){await GameSDK.loadBannerAdAsync(this.placementId),this.setStatus(ci.FILLED)}async showAsync(){this.setStatus(ci.SHOWING)}async hideAsync(){await GameSDK.hideBannerAdAsync(this.placementId),this.setStatus(ci.IDLE)}},Dh=li;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{Utils:{Object:Ih},Plugins:{Ads:{Status:$e,Types:Re,AdError:An,AdInstance:jA}}}=Ludex,di=class extends jA{U;y;Zt=[];constructor(t,e){super(t,e),this.U=GameSDK.getSDKName(),this.y=null}async loadAsync(){if(!(this.y&&this.status===$e.FILLED)){if(this.status!==$e.IDLE)throw new An("AD_NOT_READY","Ad is not ready.");try{if(this.y=await this.Ui(this.type),this.y===null)throw new An("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");this.setStatus($e.LOADING),await this.y.loadAsync(),this.setStatus($e.FILLED),this.ki()}catch(t){throw this.setStatus($e.IDLE),t instanceof Object&&"code"in t&&t.code==="INVALID_PARAM"&&(this.y=null),this.y&&this.Fi(this.y),self.codex.analytics?.loadAdFail({type:this.type,service:this.U}),t}}}async showAsync(){if(this.status!==$e.FILLED)throw new An("AD_NOT_FILLED","Ad is not filled.");if(this.y===null)throw new An("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");let t=!1;try{this.setStatus($e.SHOWING),self.codex.analytics?.showingAd({type:this.type,service:this.U}),await this.y.showAsync(),t=!0,this.setStatus($e.IDLE),this.y=null}catch(e){throw Ih.hasOwn(e,"code")&&(e.code==="AD_NOT_LOADED"&&this.setStatus($e.IDLE),["INVALID_PARAM","INVALID_OPERATION","USER_INPUT"].indexOf(`${e.code}`)>-1&&(this.setStatus($e.IDLE),this.y=null),e.code==="USER_INPUT"&&(t=!0)),this.status===$e.SHOWING&&(this.setStatus($e.IDLE),this.y=null),e}finally{t?this.Bi():self.codex.analytics?.showAdFail({type:this.type,service:this.U})}}async Ui(t){try{return await this.ji(t)}catch(e){return Ih.hasOwn(e,"code")&&e.code==="ADS_TOO_MANY_INSTANCES"?this.Ki():null}}async ji(t){switch(t){case Re.REWARDED_VIDEO:return await GameSDK.getRewardedVideoAsync(this.placementId);case Re.INTERSTITIAL:return await GameSDK.getInterstitialAdAsync(this.placementId);case Re.REWARDED_INTERSTITIAL:return await GameSDK.getRewardedInterstitialAsync(this.placementId);default:return null}}Ki(){if("canLoadAd"in GameSDK.extra){for(let t of this.Zt)if(GameSDK.extra.canLoadAd(t))return this.Zt.splice(this.Zt.indexOf(t),1),t}else return this.Zt.shift()||null;return null}ki(){switch(this.type){case Re.INTERSTITIAL:self.codex.analytics?.loadInterstitialAd({service:this.U});break;case Re.REWARDED_VIDEO:self.codex.analytics?.loadRewardedVideoAd({service:this.U});break;case Re.REWARDED_INTERSTITIAL:self.codex.analytics?.loadRewardedInterstitialAd({service:this.U});break}}Bi(){switch(this.type){case Re.INTERSTITIAL:self.codex.analytics?.showInterstitialAd({service:this.U});break;case Re.REWARDED_VIDEO:self.codex.analytics?.showRewardedVideoAd({service:this.U});break;case Re.REWARDED_INTERSTITIAL:self.codex.analytics?.showRewardedInterstitialAd({service:this.U});break}}Fi(t){this.Zt.push(t)}},Lh=di;O(),O(),O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{BaseAnalytics:WA,Events:Ch}=Ludex.Plugins.Analytics,zA=[Ch.BUTTON_CLICK,Ch.SCREEN_OPEN],{Utils:{Array:qA}}=Ludex,ui=class extends WA{Ia;constructor(t,e){super(t,"FacebookAnalytics",de(T({},e),{color:"#0F52BA"})),this.Ia=e.prefix}Qs(t,e){if(GameSDK.extra&&"logEvent"in GameSDK.extra&&!qA.has(zA,t))try{let a=this.Hi(t);GameSDK.extra.logEvent(a,1,e)}catch{}}Hi(t){return`${this.Ia}_${t}`}},$n=ui;O(),s(),o(),i(),c(),f(),l(),d(),u(),p(),h(),m();var{BaseAnalytics:QA,Events:Lt}=Ludex.Plugins.Analytics,YA=[Lt.SCREEN_OPEN],{Utils:{Array:JA}}=Ludex,pi=class extends QA{constructor(t,e){super(t,"GoogleAnalytics",de(T({},e),{color:"#E35335"}))}Qs(t,e){JA.has(YA,t)||(this.Vi(t,e),gtag("event",t,e))}Vi(t,e){switch(t){case Lt.AD_SHOW:case Lt.AD_SHOW_FAILED:case Lt.AD_SHOWING:case Lt.USE_ITEM:case Lt.EARN_ITEM:this.$i(e);break;default:break}}$i(t){if(!t||!this.codex?.match)return;let e=this.codex.match.getMatchState().customData.level;!e||e<0||(t.level_name=this.getLevelName(e))}},xn=pi;O(),O(),O(),O(),ur();var kh="production",fi=446,{Dtos:e$,Events:ze,Configs:{AppId:t$,Ads:Ge,Context:r$,Debugger:Oe,Firebase:Rh,Analytics:Jt,Notification:n$,RemoteConfig:a$,PerformanceMonitor:s$,AdaptivePerformance:Gh},Plugins:o$,Utils:{Device:i$,Object:Fh,Json:Xt,String:Bh,Valid:c$,Time:l$,Function:d$,Mark:Vh}}=Ludex,yi=class extends Nd{g="Core Initialize";ft=[];getBuildVersion(){return parseInt(`${fi}`)||0}async boot(){super.boot(),this.Wi(),this.zi(),this.event.emit(ze.CORE_BOOTING),this.qi(),this.Yi(),this.Qi(),Jt.Enabled&&(this.mark?.putAttr(this.g,"Step","Init Analytics"),this.Ji(),this.Xi(),this.Zi(),this.to(),this.eo(),this.so(),this.ao(),this.ro()),this.mark?.putAttr(this.g,"Step","Init Plugins"),this.no(),this.io(),this.oo(),this.mark?.putAttr(this.g,"Step","Load Lazy Plugins"),c$.isDebugger()||this.event.on(ze.MODULE_PLUGIN_READY,this.lo),this.co().then(this.ho),this.uo().then(this.yo),this.po().then(this.mo),this.go().then(this.fo),this.mark?.putAttr(this.g,"Step","Load Dev Plugins"),this.event.catchUp(ze.GAME_SDK_READY,this.wo)}async qi(){await l$.sleepAsync(5e3),this.event.getEventListeners(ze.CORE_BOOTING).length}async start(){super.start(),this.mark?.putAttr(this.g,"Step","Core Start"),this.event.emit(ze.CORE_STARTING),this.mark?.putAttr(this.g,"Step","Request Token"),await this.auth?.requestToken(),this.mark?.putAttr(this.g,"Step","Init States"),await this.Ao(),this.mark?.putAttr(this.g,"Step","Process Player Profile"),this.vo(),GameSDK.isGameSDK("FacebookInstant")&&i$.isIOS()?this.event.catchUp(ze.GAME_SDK_STARTED,this.Sa):await this.Sa(),this.mark?.putAttr(this.g,"Step","Core Ready"),this.mark?.putAttr(this.g,"Success","true"),this.event.emit(ze.CORE_READY),this.mark?.stop(this.g)}Sa=async()=>{if(!r$.Enabled)return;this.mark?.putAttr(this.g,"Step","Process Context Payload"),await this.context?.detectContextSessionType(),this.context?.detectContextGameMode();let t=this.context?.getSessionContextType();this.mark?.putAttr(this.g,"Context Mode",t??"unknown")};Wi(){this.d("Storage",wh),this.d("Event",vu),this.d("Ads",zd),this.d("Auth",lu),this.d("Audio",ou),this.d("Match",rh),this.d("Player",uh),this.d("Profile",yh),this.d("Context",gu),this.d("Language",Eu),this.d("Missions",E),this.d("Analytics",eu),this.d("Visibility",vh),this.d("Leaderboard",ku),this.d("DailyRewards",E),this.d("FrameCapture",Iu),this.d("RemoteConfig",E),"Proxy"in window&&this.d("Firebase",E)}d(t,e,a=!1){let r=Bh.toCamelCase(Bh.capitalize(t));this.plugins.install(t,e,!0,r)&&t!=="Storage"&&(a?this.Io(t):this.So(t))}async co(){try{let{MonitorError:t}=Oe;if(!t.Enabled)return;this.ft.push("MonitorError");let e=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof e!="function")return;this.d("MonitorError",e,!0)}catch{}}async uo(){try{let{CanvasRecorder:t}=Oe;if(!t.Enabled)return;this.ft.push("CanvasRecorder");let e=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof e!="function")throw new Error("CanvasRecorderPlugin is not a function");this.d("CanvasRecorder",e,!0)}catch{}}async po(){try{if(!Gh.Enabled)return;this.ft.push("AdaptivePerformance");let t=(await Promise.resolve().then(()=>(Nh(),_h))).default;if(typeof t!="function")return;this.d("AdaptivePerformance",t,!0)}catch{}}async go(){try{let{InputRecorder:t}=Oe;if(!t.Enabled)return;this.ft.push("InputRecorder");let e=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof e!="function")return;this.d("InputRecorder",e,!0)}catch{}}wo=()=>{let{ListPlayerDevIds:t}=Oe,e=this.player?.getPlayerId();kh!=="development"&&e&&t.indexOf(e)<0||(this.Do(),this.Eo())};async Do(){try{let{Console:t}=Oe;if(!t.Enabled)return;this.ft.push("Console");let e=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof e!="function")throw new Error("ConsolePlugin is not a function");this.d("Console",e,!0),this.xo()}catch{}}async Eo(){try{let{Profiler:t}=Oe;if(!t.Enabled)return;this.ft.push("Profiler");let e=(await Promise.resolve().then(()=>(O(),Q))).default;if(typeof e!="function")throw new Error("ProfilerPlugin is not a function");this.d("Profiler",e,!0),this.bo()}catch{}}So(t){this.event.emit(pe.CORE_PLUGIN_READY,{name:t})}Io(t){this.event.emit(pe.MODULE_PLUGIN_READY,{name:t})}lo=()=>{let t=this.event.getEventEmitCount(pe.MODULE_PLUGIN_READY),e=this.ft.length;t<e||(window.codex=Object.freeze(window.codex),st(window,"codex"))};zi(){let{EventLogging:t}=Oe;t.Enabled&&this.event.enableLogEvent()}io(){this.match&&this.match.setUseCPUProfile(!1)}no(){Ge.Enabled&&(this.ads?.configure(Ge),this.Po(),this.Lo(),this._o(),this.analytics?.initAdEvent({adService:"platform",state:"loaded"}))}async Po(){try{let{AdSense:t}=Ge.AdServiceConfigs;if(!t.Enabled)return;let e=new E(this);await e.initAsync({usePreload:t.UsePreload,dataAdHost:t.DataAdHost,dataAdClient:t.DataAdClient,dataAdChannel:t.DataAdChannel,dataAdBreakTest:t.DataAdBreakTest,dataAdFrequencyHint:t.DataAdFrequencyHint}),window.GoogleAds=e}catch{}}async Lo(){try{let{Savana:t}=Ge.AdServiceConfigs;if(!t.Enabled)return;let e=new E(this);await e.initAsync({usePreload:t.UsePreload,dataAdHost:t.DataAdHost,dataAdClient:t.DataAdClient,dataAdChannel:t.DataAdChannel,dataAdBreakTest:t.DataAdBreakTest,dataAdFrequencyHint:t.DataAdFrequencyHint}),window.TranssionH5Ads=e}catch{}}De(t,e=!1){let{AdSense:a,AppLovin:r,Savana:n}=Ge.AdServiceConfigs;switch(t){case"adsense":if(a.Enabled)return E;break;case"applovin":r.Enabled;break;case"savana":if(n.Enabled)return E;break;default:return e?Dh:Lh}return null}_o(){let{Types:t}=o$.Ads;for(let a of Ge.InterstitialAdOptions){let r=this.De(a.AdService);r&&this.ads?.setAdInstance(t.INTERSTITIAL,a.PlacementId,r)}for(let a of Ge.RewardedVideoAdOptions){let r=this.De(a.AdService);r&&this.ads?.setAdInstance(t.REWARDED_VIDEO,a.PlacementId,r)}for(let a of Ge.RewardedInterstitialAdOptions){let r=this.De(a.AdService);r&&this.ads?.setAdInstance(t.REWARDED_INTERSTITIAL,a.PlacementId,r)}let e=!0;for(let a of Ge.BannerDisplayAdOptions){let r=this.De(a.AdService,e);r&&this.ads?.setAdInstance(t.BANNER,a.PlacementId,r)}}async Ao(){try{let t=new Vd(this);t.initContext(),await t.initPlayer()}catch{}}xo(){this.console&&this.console.configure()}bo(){this.profiler&&this.profiler.configure()}yo=()=>{if(!this.canvasRecorder)return;let{CanvasRecorder:t}=Oe,{Type:e,Quality:a,RecordFps:r,SyncFps:n}=t.Options;this.canvasRecorder.configure({type:e,quality:a,syncFps:n,recordFps:r}),this.canvasRecorder.setPanelExpanded(t.PanelExpanded);let y=document.querySelector("canvas");y&&this.canvasRecorder.setCanvas(y)};ho=()=>{if(!this.monitorError)return;let{MonitorError:t,ListPlayerDevIds:e}=Oe,{ApiKey:a,Service:r,Feedback:n,TrackUser:y,FilterErrors:g}=t,{playerId:w,name:v}=this.player?.getPlayer()??{};w&&e.indexOf(w)>=0||(window.disableSimpleTrackErrors?.(),this.monitorError.configure({apiKey:a,service:r,feedback:n,trackUser:y,releaseStage:kh,buildVersion:`${fi??1}`}),this.monitorError.setUser({id:w??null,name:v??null}),this.monitorError.addFilterErrors(g),this.monitorError.initFeedbackTrackErrors(),this.Oo(),this.Co())};Oo=()=>{this.event.catchUp(ze.PLAYER_INFO_LOADED,this.No)};Co=()=>{if(this.monitorError&&Array.isArray(window.__errorQueue)){for(let t of window.__errorQueue)if(t instanceof Error)this.monitorError.sendException(t);else{let e=d$.toError(t);this.monitorError.sendException(e)}window.__errorQueue=null}};No=()=>{if(!this.player||!this.monitorError)return;let{playerId:t,name:e}=this.player.getPlayer();this.monitorError.setUser({id:t,name:e}),this.monitorError.addMetadata({isFirstSession:this.player.isFirstSession()})};oo(){if(!this.remoteConfig)return;let t=Xt.clone(a$);this.remoteConfig.configure(t),this.event.on(pe.REQUEST_SAVE_CONFIG,this.To),this.event.on(pe.REQUEST_UPDATE_CONFIG,this.Ro),this.event.catchUp(pe.PLAYER_INFO_LOADED,this.Mo)}To=t=>{try{let e={[t.type]:t};this.player?.setPlayerDataByName("remoteConfig",e)}catch{}};Ro=t=>{try{let{id:e,type:a}=t;if(a!=="Ludex")return;Ludex.Configs=Fh.merge(Ludex.Configs,t.config);let{Ads:r}=Ludex.Configs;this.ads?.configure(r),this.event.emit(pe.REMOTE_CONFIG_UPDATED,{id:e,type:a})}catch{}};Mo=()=>{if(!this.player||!this.remoteConfig)return;let t=this.player.getPlayerDataByKey("remoteConfig");if(t){for(let e in t)if(Fh.hasOwn(t,e)){let a=t[e],r=Xt.clone(a),n=new e$.RemoteConfig.Data(r).toObject();this.remoteConfig.setRemoteConfig(n),this.remoteConfig.processUpdateConfig(n.id,n.type)}}};Yi(){if(!Rh.Enabled||!this.firebase)return;let t=Xt.clone(Rh);this.firebase.configure(t),Vh.setService(this.firebase.services.performance)}get mark(){return s$.CoreFlows?Vh:null}Qi(){let t=this.mark;t&&(t.measure(this.g),t.putAttr(this.g,"Build",`${fi}`),t.putAttr(this.g,"GameSDK",GameSDK.getSDKName()),t.putAttr(this.g,"Platform",GameSDK.getPlatform()),t.putAttr(this.g,"Success","false"),t.start(this.g))}mo=()=>{if(!this.adaptivePerformance)return;let t=Xt.clone(Gh);this.adaptivePerformance.configure(t)};fo=()=>{if(!this.inputRecorder)return;let{InputRecorder:t}=Oe,e=Xt.clone(t);e&&this.inputRecorder.configure(e)};async vo(){try{if(!this.player)return;await this.player.syncProfileToServer(),this.Go()}catch{}}Go=()=>{n$.Enabled&&this.Uo()};async Uo(){try{if(!this.player)return;let t=this.player.getPlayer(),{playerId:e}=t,a=!1;"isNEZP"in GameSDK.extra&&(a=GameSDK.extra.isNEZP()),!a&&"isRestricted"in GameSDK.extra&&(a=GameSDK.extra.isRestricted());let r={appId:t$,playerId:e,platform:GameSDK.getPlatform(),platformMode:a?"NEZP":"NORMAL"};await Fd(r)}catch{}}Ji(){if(!this.analytics)return;let{Enabled:t,ConsoleLog:e}=Jt.GoogleAnalytics??{};t&&(typeof xn!="function"||!(xn.prototype instanceof Object)||this.analytics.add(new xn(this.codex,{log:!!e})))}Xi(){if(!this.analytics)return;let{Enabled:t,ConsoleLog:e}=Jt.ClarityAnalytics??{};if(!t||typeof E!="function"||!(E.prototype instanceof Object))return;let a=new E(this.codex,{log:!!e}),{playerId:r}=this.player?.getPlayer()??{};r&&a.setUser(r,GameSDK.extra?.isGuest??!0),this.analytics.add(a)}Zi(){if(!this.analytics)return;let{Enabled:t,ConsoleLog:e}=Jt.FirebaseAnalytics??{};if(!t||typeof E!="function"||!(E.prototype instanceof Object))return;let a=new E(this.codex,{log:!!e});this.analytics.add(a);let r="no_entry";GameSDK.getEntryPointAsync().then(n=>{r=n}).catch(n=>{}).finally(()=>{let{playerId:n,locale:y}=this.player?.getPlayer()??{},{fbig_ad_id:g,fbig_adset_id:w,fbig_campaign_id:v,fb_instant_game_adset_id:S,fb_instant_game_ad_id:D,fb_instant_game_campaign_id:x}=GameSDK.getEntryPointData()||{},b=g||D,_=w||S,M=v||x;n&&a.setUser(n,{locale:y,ad_id:b,adset_id:_,campaign_id:M,traffic_source:r})})}to(){this.analytics&&GameSDK.isGameSDK("Yandex")&&(typeof E!="function"||!(E.prototype instanceof Object)||this.analytics.add(new E(this.codex)))}eo(){this.analytics&&GameSDK.isGameSDK("Xiaomi")&&(typeof E!="function"||!(E.prototype instanceof Object)||this.analytics.add(new E(this.codex)))}ao(){this.analytics&&GameSDK.isGameSDK("Playable")&&(typeof E!="function"||!(E.prototype instanceof Object)||this.analytics.add(new E(this.codex)))}so(){if(!this.analytics)return;let{Enabled:t,Prefix:e,ConsoleLog:a}=Jt.FacebookAnalytics??{};!t||!GameSDK.isGameSDK("FacebookInstant")||typeof e=="string"&&(typeof $n!="function"||!($n.prototype instanceof Object)||this.analytics.add(new $n(this.codex,{prefix:e,log:!!a})))}ro(){this.analytics&&GameSDK.isGameSDK("TranssionH5")&&(typeof E!="function"||!(E.prototype instanceof Object)||this.analytics.add(new E(this.codex)))}},Uh=yi,{Configs:{GameEngine:{ForceDesktopDPR:wn}},Utils:{Device:u$},Events:gi}=Ludex,p$=async()=>{let t=new Uh;window.codex=t,typeof globalThis<"u"&&(globalThis.codex=t);let e=20;window.__sdkLoadingCount<e&&(window.__sdkLoadingCount=e),await t.boot(),t.event.catchUp(gi.REQUEST_CORE_START,Hh)},Kh=!1,Hh=()=>{if(Kh)return;if(codex.event.getEventEmitCount(gi.GAME_SDK_READY)<1){codex.event.catchUp(gi.GAME_SDK_READY,Hh);return}codex.start(),Kh=!0;let t=25;window.__sdkLoadingCount<t&&(window.__sdkLoadingCount=t)};wn!==!1&&u$.isDesktop()&&typeof wn=="number"&&wn>0&&(window.devicePixelRatio=wn),p$();
