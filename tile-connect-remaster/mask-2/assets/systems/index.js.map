{"version":3,"sources":["file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/scenes/common/locales/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/scenes/common/locales/en.json","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/AdsManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/EngineManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/LayoutManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/MatchManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/PlayerManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/AdaptivePerformance.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/CanvasRecorder.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DailyRewards.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DynamicAssets.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DynamicAtlas.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/node_modules/potpack/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/node_modules/potpack/index.js","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderResultChallenge.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareLeaderboard.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareScore.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareScoreWithInvite.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderUpdateChallenge.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/FrameCapture.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/HybridFileCache.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/Languages.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/Leaderboards.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/PerformanceMonitor.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/RemoteConfig.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/PluginsManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/SceneManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/ScreenManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/LudosSystem.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/PipelineData.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/Optimized2DPipeline.ts"],"names":["text","core.nameless","game.resume","game.restart","game.cancel","game.challenge","game.next","game.completed","game.tryAgain","game.retry","game.startOverQ","game.startOverMsg","game.startOver","game.paused","game.end","game.quit","game.join","game.joinLeaderboard","game.continue","game.letsPlay","game.logIn","game.create","game.quitLevelShortMsg","game.quitSingleMsg","game.quitTourMsg","game.level","game.levelX","game.hardLevel","game.result","game.nextLevel","game.win","game.lose","game.draw","game.replay","game.boom","game.timesUp","game.bombDesc","game.timesUpDesc","game.daily","game.weekly","game.endsSoon","game.endsIn","game.player","game.nPlayers","game.pTour","game.combo","game.tourLbUpdated","settings.level","settings.settings","settings.music","settings.sound","settings.vibrate","settings.on","settings.off","settings.notification","settings.report","settings.share","settings.invite","settings.feedback","settings.createShortcut","settings.or","settings.customMode","custom.customLevel","custom.time","custom.difficulty","custom.easy","custom.normal","custom.hard","custom.extreme","custom.bombs","custom.ads","custom.score","custom.play","ads.cancelled","ads.loading","ads.notReady","ads.adAfterT","ads.levelAfterT","ads.rewardNotice","ads.skip","ads.daily","ads.claim","ads.claimX2","ads.claimNow","ads.await","ads.open","ads.coins","ads.getNow","ads.freeMinutes","ads.interNotice.hangTight","ads.interNotice.backInSec","ads.interNotice.quickAd","status.loading","status.congrats","status.allLevels","status.later","status.confirm","status.confirmReset","status.resetInfo","status.no","status.yes","status.first","status.second","status.third","status.nth","status.tap","status.waitingX","status.lbNotAvail","status.tourNotAvail","pages.shop","pages.collections","pages.home","pages.leaderboard","pages.tournament","guide.step1","guide.step2","guide.step3","guide.step4","guide.step5","guide.timer","guide.combo","guide.hint","guide.thunder","guide.storm","guide.pliers","guide.custom","interMsg.reviveAd","interMsg.doubleAd","interMsg.ranked","interMsg.friendChallenge","interMsg.bragChallenge","interMsg.clearTiles","interMsg.beatClock","interMsg.clearBombs","interMsg.seasonPack","interMsg.collectStars","interMsg.competeInLb","interMsg.competeWithFriends","interMsg.thunder","interMsg.hint","interMsg.pliers","interMsg.tornado","interMsg.coins","interMsg.seasonTiles","interMsg.dailyLogin","interMsg.levelUp","interMsg.seasonRewards","error.tryLater","error.soon","error.noFriendsLb","error.noWorldLb","error.createTourFail","error.tourExists","error.challengeFail","error.rewardFail","error.tourEnded","error.tourJoinFail","error.noAd","error.ratingNoAuth","error.ratingGameRated","error.ratingFail","error.shortcutFail","error.login","error.joinLb","reward.day","reward.dayX","reward.starChestTitle","reward.starChestAvailable","reward.starChestUnavailable","item.hint","item.thunder","item.storm","item.pliers","item.hintDesc","item.thunderDesc","item.stormDesc","item.pliersDesc","theme.newTiles","theme.summer","theme.autumn","theme.winter","theme.springFestival","theme.treePlantingFestival","theme.blueSeaFestival","theme.musicFestival","theme.harvestFestival","theme.foodFestival","theme.snowFestival","theme.lightFestival","theme.peaceFestival","theme.flowerFestival","theme.streetFestival","theme.colorGarden","theme.colorFestival","theme.natureSummer","theme.snowMountain","theme.iceFestival","theme.greenGrassFestival","theme.communityFestival","theme.waterFestival","theme.animalFestival","theme.lostFestival","theme.halloweenFestival","theme.snowMusicFestival","theme.christmas","theme.springFlowerFestival","theme.tetHoliday","theme.seaFestival","theme.fireworkFestival","theme.halloweenHorror","theme.midAutumn","theme.christmasSweet","theme.newYearCountdown","theme.happyNewYear","share.canYouDoBetter","dashboard.unlockLevel","texture","draw","lose","victory","waiting","excellent","good","great","wellDone","freeRewards","_Ludex","Ludex","Events","_Ludex$Configs$Ads","Configs","Ads","Enabled","PreloadAds","ShowAdOnLoad","_Ludex$Utils","Utils","T","Time","Decorator","event","codex","AdsManager","_dec","tryCatch","_descriptor","_applyDecoratedDescriptor","_class","_this","_classCallCheck","this","listenEvents$","on","AD_CLOSED","requestResizeGame$","catchUp","GAME_READY","processPreloadAds$","GAME_SDK_READY","processShowFirstInterstitialAd","CONTEXT_DATA_PROCESSED","processShowBannerAds$","game","GameEvents","LAYOUT_CHANGED","handleLayoutChanged$","emit","REQUEST_RESIZE_GAME","_asyncToGenerator","sleepAsync","AdsUtils","updateBannerAdsByLayout","LayoutUtils","getCurrentLayout","refreshBannerAdVisibility","preloadAds","_initializerDefineProperty","_createClass","key","value","console","debug","prototype","configurable","enumerable","writable","initializer","ShowAdOnLoadEnabled","DelaySeconds","isYandex","GameSDK","isGameSDK","pause","showInterstitialAdAsync","forceLoad","contextType","resume","_RF","pop","_Ludex$Configs$GameEn","GameEngine","DynamicAtlasConfig","DynamicAtlas","PreferredFPS","V","Valid","D","Device","EngineManager","overrideSettings$","settings","overrideSettings","Settings","Category","ENGINE","isDebugger","View","instance","resizeWithBrowserSize","isDesktop","frameRate","Desktop","Mobile","setupAutoAtlas$","AssetManager","cacheAsset","setupAssetDownloader$","downloader","maxConcurrency","maxRequestsPerFrame","webpSupport","checkWebpSupport$","sys","hasFeature","Feature","WEBP","originHasFeature","feature","Promise","resolve","image","Image","onload","onerror","src","getPipelineFlows$","_ref2","_director$root","director","root","pipeline","flows","getRenderQueues$","stageIndex","forwardFlow","stages","renderQueues","setupOptimalPipelines$","transformPipeline","remove","isValueChangeAsync","timeout","shift","setupEngineRunningState$","input","Input","EventType","TOUCH_START","handleResumeEngine$","VISIBILITY_HIDDEN","handlePauseEngine$","VISIBILITY_VISIBLE","isPaused","setupDynamicAtlas$","isBrowser","setupDynamicAtlasForBrowser$","isNative","setupDynamicAtlasForNative$","disableDynamicAtlas$","os","OS","IOS","setupDynamicAtlasForIOS$","ANDROID","setupDynamicAtlasForAndroid$","OSX","LINUX","WINDOWS","setupDynamicAtlasForDesktop$","setupDynamicAtlasDefault$","platform","Platform","setDynamicAtlas$","options","MaxAtlasCount","MaxAtlasSize","MaxFrameSize","DynamicAtlasManager","macro","CLEANUP_IMAGE_CACHE","enabled","textureSize","maxFrameSize","maxAtlasCount","textureBleeding","OptimizeAtlas","TextureBleeding","maxSize","getMaxTextureSize$","correctSize","Math","min","maxTextureSize","device","capabilities","_DynamicAtlasManager$","Android","setupBatcherLimit$","BATCHER2D_MEM_INCREMENT","MAX_LABEL_CANVAS_POOL_SIZE","Layout","GameWorld","_GameWorld$DesignSize","DesignSize","Portrait","Landscape","AcceptPortraitRatio","AutoResizeCanvas","_codex","ads","LayoutManager","debounce","listenResizeEvent$","ResizeObserver","_window$__listeners$r","resizeEventCallbacks","window","__listeners","resize","length","_step","_iterator","_createForOfIteratorHelper","s","n","done","callback","removeEventListener","err","e","f","handleBodyResize","observe","document","body","handleViewResizeBySystem$","setupResolutionPolicy$","view","setOrientation","ORIENTATION_AUTO","resolutionPolicy$","getResolutionPolicy","setContentStrategy","ResolutionPolicy","ContentStrategy","EXACT_FIT","setContainerStrategy","ContainerStrategy","PROPORTION_TO_FRAME","isAdShowing$","isAdFullSizeShowing","error","payload","maxDpr","CocosUtils","getMaxPixelRatio","_ref$forcePixelRatio","forcePixelRatio","devicePixelRatio","setupOrientationByCanvasSize$","screenRatio","getScreenRatio$","PRIMARY_LAYOUT","setPortraitView$","setLandscapeView$","WIDTH","HEIGHT","isPrimaryLayoutPortrait","currentLayout$","setupLayoutStrategy$","resizeGameView$","isPrimaryLayoutLandscape","designWidth","designHeight","_view$getDesignResolu","getDesignResolutionSize","width","height","contentStrategy","getContentStrategy","containerStrategy","_containerStrategy","name","isPortrait","isLandscape","FIXED_WIDTH","FIXED_HEIGHT","FULL_PORTRAIT_SIZE","SHOW_ALL","FULL_LANDSCAPE_SIZE","EQUAL_TO_FRAME","setDesignResolutionSize","Resolution","worldSize","Size","screenWidth","getScreenWidthCss","screenHeight","getScreenHeightCss","scaleX","scaleY","gameSize","isFullPortraitSize","isFullLandscapeSize","scale","viewWidth","worldSizeToCssSize","viewHeight","viewSize","screen","windowSize","VIEW_RESIZED","info","_this2","O","Object","A","Array","_Ludex$Dtos$Match","Dtos","Match","MatchCustomData","CustomData","LevelFenKeys","LevelRulesKeys","MatchManager","setupMatchCustomData$","addDefaults","DefaultMatchCustomData","addValidator","score","isNumber","Error","concat","setupMatchData$","challengeData","isObject","challengeDataObj","keysForChallengeData","keys","has","level","validateFen$","fen","isString","gravity","validateLevelRules$","rules","time","validFenObject","validateKeys$","idSize","code","rows","cols","encoding","validEncoding","vals","TileSpecialTypes","entries","forEach","_ref","_slicedToArray","validRules","addRandomTilesPerMove","maxSpaceOfPair","obj","B","Browser","Player","player","GameName","replace","PlayerManager","Data","makeLoose","GameData","PlayerData","stars","totalLevel","levelVersion","lastRewardedItems","lastCreateTournamentShown","guideItemShowed","isArray","items","values","ItemKeys","HINT","THUNDER","STORM","PLIERS","tournamentProgress","custom","endlessScore","syncOldPlayerDataForMsGames","oldLocalStorageKey","oldVersionData","getLocalStorage","oldPlayerData","toObject","currentPlayerData","getPlayerData","gameData","setPlayerData","requestConnectedPlayers","catch","warn","adaptivePerformance","AdaptivePerformance","once","Director","EVENT_BEGIN_FRAME","handleBeginFrame$","EVENT_AFTER_SCENE_LAUNCH","handleAfterSceneLaunch$","EVENT_AFTER_UPDATE","lateUpdate$","EVENT_BEFORE_UPDATE","updateActualFPS$","scene","trackingScene","dtInMs","deltaTime","updatePostStepDeltaTime","actualFPS","fps","updateActualFPS","canvasRecorder","CanvasRecorder","canvas","setCanvas","getOptions","nextFrame","step","originWaitNextFrame","waitNextFrame","force","arguments","undefined","reject","isCapturing","syncFps","EVENT_AFTER_RENDER","then","storage","DailyRewards","initStorage$","addStorage","hasShownPopup","DynamicAssets","IgnoreFiles","Compression","F","Function","getBuildVersion","IMAGE_EXTS","ASSET","isProcessing$","yield10msIfNeeded$","timeSlice","targetScale$","sessionQuality$","failedAssets$","Set","isAssetUpgraded$","upgradableAssets$","Map","currentQuality","buildVersion","getOptimalScale$","dpr","round","pixelRatio","Available","Source","sortedScales","_toConsumableArray","sort","a","b","getCurrentQuality$","checkCacheVersion$","toString","cacheConfig","getStorage","_ref2$currentQuality","cacheCurrentQuality","cacheBuildVersion","setStorageData","updateToWebStorage","REQUEST_UPGRADE_ASSET","handleChangeQuality","injectSpriteUpdate$","defineProperty","Sprite","get","_spriteFrame","set","refreshed","lastSprite","markForUpdateRenderData","_applySpriteFrame","sizeMode","SizeMode","CUSTOM","uiTransform","node","getComponent","UITransform","_value$originalSize","originalSize","previousSize","setContentSize","injectSpriteFrameCheckRect$","_scale","originalCheckRect","SpriteFrame","checkRect","_len","args","_key","apply","injectSpriteFrameSlicedUV$","originalCalculateSlicedUV","_calculateSlicedUV","_this$_capInsets","capInsets","_capInsets","newCapInsets","map","cap","injectSpriteFrameResolution$","originalRefreshTexture","_refreshTexture","_len2","_key2","_this$rect","rect","x","y","xF","Number","toFixed","yF","widthF","heightF","newRect","Rect","newOriginalSize","reset","getAssetQuality$","uuid","path","replaceAssetUrl$","url","includes","saveStateToStorage$","updateSpriteFrames$","getScene","_step2","sprites","getComponentsInChildren","_iterator2","spriteFrame","original","_texture","updateImage","requestUpdateDynamicAssets$","REQUEST_DYNAMIC_ATLAS","collectUpgradableAssets$","task","_step3","output","hasUpgradableAsset","_iterator3","item","ext","originalUrl","upgradedUrl","cacheItem","resolution","processUpgradeQualityAsync$","_ref4","add","asset","assetManager","assets","ImageAsset","mediumPath","qualityPath","originalUrlConcept","loadItem","loadAny","data","slice","_nativeUrl","ASSET_QUALITY_CHANGE","_x","_init","insert","_step4","promiseRequest","initialUpgradedCount","size","_iterator4","promise","push","allSettled","AtlasDebug","AutoAtlasSize","UsePowerOfTwo","AllowNonePackable","OnlyOptimizeWhenRenderTooLong","J","Json","I","Mark","CONFIG","MAX_INTERVAL_MS","THROTTLE_UPDATE_MS","INTERVAL_INCREASE_MS","MEAN_LAG_THRESHOLD_MS","MAX_RECORDED_RENDER_TIMES","RENDER_TIME_CHECK_INTERVAL_MS","PACK_PADDING","MIN_FILL_RATE","BLEEDING_SPACE","COLLECT_PADDING","BLEED_SENSITIVE_SIZE","ENABLED","FONT","TEXT_HEIGHT","TEXT_PADDING","IMAGE_QUALITY","isEffective$","forceUpdateDynamicAtlas$","mutex$","mutex","renderTimes$","lastRenderTime$","renderTimeInterval$","atlasInfo$","lastAtlasInfo$","atlasIds$","collectInfo$","packedFrames$","debugCanvases$","requestUpdateDynamicAtlas$","SCENE_LAUNCHED","onSceneLaunched$","setupRenderListeners$","resetPendingInfo$","resetAllAtlases$","frame","isValid","_resetDynamicAtlasFrame","clear","overrideDynamicAtlasManager$","packToDynamicAtlas","collectSpriteFrame$","deleteAtlasSpriteFrame","deleteSpriteFrame$","createPendingDebugCanvas$","createDebugCanvas$","canvasId","checkRenderTimeThreshold$","calculateMeanRenderTimeAndReset$","handleLaggyFrame$","setTimeout","EVENT_BEFORE_RENDER","updateBeforeRenderTime$","updateAfterRenderTime$","performance","now","renderTime","meanRenderTime","reduce","sum","comp","hasOwn","isSpriteFrameValidForAtlas$","getTexture$","texId","getId","texSize","getTextureSizeFromTexture$","addTextureToCollectInfo$","atlas","getAtlas$","deleteInnerTexture","delete","active","activeInHierarchy","packable","currentTexture","originalTexture","isSameTexture","isSameTextureId","color","current","opacityComp","UIOpacity","opacity","parent","getTextureSize$","isTextureTooLarge$","padding","w","h","id","components","_spriteFrame$original","_spriteFrame$original2","tex","_tex$width","_tex$height","rebuildAtlasIfNecessary$","_atlas","isSame","isSameAtlas$","packedInfo","_atlas$_texture","currentWidth","currentHeight","packedWidth","packedHeight","max","maxDimension","newWidth","newHeight","resetAtlas$","initWithSize","debugCanvas","getAtlasIndex$","_debugCanvas$getConte","getContext","clearRect","clone","createAtlas$","newAtlas","atlasIndex","createElement","_atlases","indexOf","destroy","splice","_atlasIndex","index","_atlases2","_DynamicAtlasManager$2","getAtlasSize$","_payload$force","updateDynamicAtlas$","lock","use","start","prepareDrawInfo$","packCollectedTextures$","FINISHED_DYNAMIC_ATLAS","requestAnimationFrame","printAtlasTextures$","_unused","stop","release","texturesToPack","calculateOptimizedAtlas$","textures","_potpack","boxes","area","maxWidth","box","spaces","ceil","sqrt","Infinity","i","space","last","fill","potpack","atlasSize","excessTextures","excessTextures$","excessSet","remainingTextures","filter","t","fillRate","_this$calculateExcess","calculateExcessDimensions$","excessWidth","excessHeight","tryRemoveExcessTextures$","removedWidth","removedHeight","removedTextures","_this$atlasIds$$textu","componentsToPack","textureCount","texturesInCollectInfo","_textureCount$get","_i","_componentsToPack","packComponentIntoAtlas$","tryInsertSpriteFrame$","packedFrame","drawTexture$","_setDynamicAtlasFrame","setTextureDirty","updateLabelUVs$","_assembler$updateUVs","Label","renderData","vertDirty","assembler","Assembler","getAssembler","updateUVs","call","base64","toDataURL","logImage","_info$x","_info$y","_texInfo$x","_texInfo$y","_atlas$_texture2","drawX","drawY","texInfo","_innerTextureInfos","drawToAtlas$","usageCount","drawDebugFrame$","_count","atlasTexture","drawTextureAt","ctx","willReadFrequently","imgData","isDrawableImage","drawDebugImageWithBleed$","drawDebugOutlineAndOverlay$","drawDebugText$","drawImage","outlineX","outlineY","outlineWidth","outlineHeight","hue","fillStyle","fillRect","font","textAlign","textBaseline","textMetrics","measureText","textX","textY","fillText","HTMLCanvasElement","HTMLImageElement","E","WIDEFRAME_PATH","WIDEFRAME_IMAGE_WITH_SCORE_BOX","WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX","FALLBACK_IMAGE","DEFAULT_RENDER_OPTIONS","wideframe","type","depth","position","playerPhoto","fallbackImage","opponentPhoto","leftScore","rightScore","leftCrown","rightCrown","StatusImage","win","renderResultChallenge","initial","lift","pipe","addPlayerPhotos","addScores","addStatusImages","addWideframe","result","applyAsync","applyCaptureAsync","isFailure","extractFailure","extractSuccess","renderOptions","frameCapture","captureAsync","isPlayerFinished","isOpponentFinished","hasFinishedPlayer","_objectSpread","playerId","opponentId","_payload$playerScore","playerScore","_payload$opponentScor","opponentScore","leftScoreText","rightScoreText","status","getStatus","statusImage","crown","_payload$playerScore2","_payload$opponentScor2","WIDEFRAME_IMAGE","avatar","leaderPhoto","leaderName","leaderScore","renderShareLeaderboard","addPlayerAvatar","addLeaderAvatars","leaders","out","leader","photo","photoY","captionY","language","monitorError","message","renderShareScore","addPlayerScore","addMessage","fontStyle","fontName","getLocalizedFontName","fontSize","getLocalizedFontSize","messageText","getLocalizedMessage","locale","getCurrentLocale","fontPath","LocaleFontPaths","fileName","getFileName","_LocaleFrameCaptureFo","LocaleFrameCaptureFontSize","_fragments","fragments","split","fullFileName","extension","lastIndexOf","substring","getText","sendException","toError","en","ru","renderShareScoreWithInvite","renderUpdateChallenge","addAvatars","FrameCapture","setRenderer","HybridFileCache","PreviewMode","BuildMode","_AssetManager$instanc","fetchPipeline","CACHE_KEY_REGEX","throttle","supportTypes$","bundledFiles$","originHandler$","nativeAssetDictionary$","commitId","cachedFiles","cachedBundles","cachedExtensions","invalidateMode","InvalidateMode","CommitId","cacheCommitId","getStorageData","isCommitDifferent","isBuildVersionDifferent","clearCache$","requestUpdateStorage","initSupportedTypes$","SupportedExtensions","setupBundledFiles$","BUILD","downloadPromises","getCachedBundles$","downloadBundledFile$","BUNDLE_READY","bundledFile","toUpperCase","res","fetch","method","headers","Content-Type","json","setBundledCache$","injectOptimalFetchPipeline$","fetchPipe","pipes","injectOptimalLoadPipeline$","loadPipe","injectCacheExtensionPipeline$","CacheUuidExtension","cachedExtension","checkCacheExtension","cachedExt","getCacheExtension$","saveAndOverrideIsNative","originalPipeline","_item$isNative","isCached","restoreAndCacheExt","_this$nativeAssetDict","recordedInfo","setCacheExtension$","beforePipelines","beforeFetchPipelines","pipeToWrap","fetchPipeToWrap","afterPipelines","afterFetchPipelines","saveOriginDownloaders$","handler","handlers","registerCustomDownloader$","register","downloadFile$","SCENE_LOADED","CLEAR_HYBRID_FILE_CACHE","getDownloadHandler$","_this$originHandler$$","onComplete","cache","getCache$","setCache$","getCacheKey$","match","_match","validateDataType$","cacheKey","encodedData","_defineProperty","cacheData","getFileCaches$","getBundledCache$","_storage$getStorageDa","_bundledFile$key","getCachedExtensions$","_storage$getStorageDa2","initStorageData","supportTypes","Languages","initDefaultLanguage$","DefaultLanguageData","setLanguage$","initPlayerLanguage$","_player$getPlayerData","playerLocale","getPlayerLanguage","isSupportedLocale$","addLanguage$","saveToPlayerData","getPlayerDataByKey","lang","AvailableLocales","listenEvent$","REQUEST_LANGUAGE","handleLanguageRequested$","PRELOAD_LANGUAGE","handlePreloadLanguage$","CHOOSE_LANGUAGE","handleChooseLanguage$","_ref3","setAsFallback","langData","getLangData$","choose","setSetting","_ref5","onLoad","onError","toError$","_x2","_ref6","_ref6$saveToPlayerDat","_ref7","ResourceUtils","loadJsonAsync","LocaleFilePaths","_x3","_ref8","_payload$saveToPlayer","_x4","module","_Ludex$Configs","_Ludex$Configs$Mockup","Mockup","LeaderboardsMockupConfig","Leaderboards","PlayerMockupConfig","LeaderboardsConfig","N","leaderboard","handleWhenGameSDKStarted$","setupLeaderboardsMockup$","setupLeaderboards$","setupLeaderboardByConfigs$","LeaderboardList","LeaderboardConfig","Id","Name","addLeaderboard","autoSortRank","leaderboardId","setupMockGlobalLeaderboards$","setupMockFriendsLeaderboard$","setupMockGlobalTournamentLeaderboard$","NumOfLeaders","_id","createLeaderboardAsync","numberOfLeaders","random","Max","Min","ConnectedPlayers","NumOfPlayers","TournamentUtils","requestTournamentDataAsync","tournament","isExistLeaderboardId","FpsTracking","PerformanceMonitor","markName$","handleStartTraceFps$","unListenEvents$","off","handleLateUpdate$","startTraceFps$","mark","measure","fpsTraceDuration$","CCGame","traceStopped$","updateFPS$","fpsTraceIntervalTimer$","fpsTraceInterval$","_this$minFps$","_this$maxFps$","getFPS$","drawCalls","getDrawCalls$","deviceRender","getDeviceRender$","textureMemory","getTextureMemory$","minFps$","maxFps$","putMetric","putAttr","title","floor","numDrawCalls","renderer","memoryStatus","TrackingDuration","TrackingInterval","RemoteConfig","REQUEST_HOT_RELOAD","handleHotReload$","REQUEST_UPDATE_CONFIG","handleUpdateConfig$","restart","GAMEPLAY_UPDATE_CONFIG","config","REMOTE_CONFIG_UPDATED","_Ludex$Configs$Debugg","Debugger","Profiler","PluginsManager","initHybridFileCache$","HybridFileCachePlugin","init","LanguagesPlugin","LeaderboardsPlugin","RemoteConfigPlugin","DynamicAtlasPlugin","DynamicAssetsPlugin","CanvasRecorderPlugin","PerformanceMonitorPlugin","AdaptivePerformancePlugin","FrameCapturePlugin","DailyRewardsPlugin","sdk","SceneManager","testScene$","isClearedMark$","callbackSwitchScene$","MARK_IS_TEST_SCENE","setTestScene$","SWITCH_SCENE","switchScene$","PRELOAD_SCENE","preloadScene$","correctSceneName$","sceneName","testScene","getTestScene$","sceneData","SceneUtils","isSceneLoaded","ScreenUtils","showLoadingFullScreen","startScene$","startMeasure$","sceneAsset","loadSceneAsync$","onSceneProgress$","runSceneAsync$","setSceneData$","markIsSceneLoaded","clearTestMark$","stopMeasure$","handleSceneLaunched$","isPreload","onProgress","bundle","main","loadScene","runScene","action","groupCollapsed","success","rmAttr","groupEnd","finished","total","progress","percent","setLoadingProgress","_this$callbackSwitchS","hideLoadingFullScreen","AnalyticsUtils","switchSceneTracking","addMetadata","currentScene","SCENE_RENDERED","_Object$keys$","onSwitchScene","attr","currentData","LoadResources","resetScreenEntry","entry","state","removeFromParent","order","prefab","useCount","ScreenManager","screens$","onPrefabReadyCallbacks$","bindEventHandlers$","OPEN_SCREEN","handleOpenScreen$","CLOSE_SCREEN","handleCloseScreen$","PRELOAD_SCREEN","handlePreloadScreen$","PRELOAD_SCREENS","handlePreloadScreens$","handleSwitchScene$","openScreen","screenName","screenData","closeScreen","addScreenQueues$","loadScreen$","validateScene$","initScreens$","preloadScreens$","resetAllScreenParents$","screenHolder","getScreenHolder$","configs","screens","ScreenNames","isEmpty","screenNames","join","addScreens$","_scene$getComponentIn","getComponentInChildren","_entry$order","isScreenNameValid$","reorderScreens$","loadPrefabAsync","emitPrefabReady$","autoPreload","getScreen$","Prefab","screenNode","instantiate","addChild","readyEntries","_entry$screen","setSiblingIndex","getOrTryAddScreen$","queueScreen$","GeneralUtils","setBlockInput","incrementUseCount$","showScreen$","_this$onPrefabReadyCa","callbacks","eventPayload","OPENING_SCREEN","open","updateAnalytics$","_x5","_x6","_x7","updateCurrentPage","CLOSING_SCREEN","close","_x8","isOpening","trackCurrentPage","currentScreen","removeMetadata","closeAllScreens","_this$onPrefabReadyCa2","Core","_Ludex$Plugins$Analyt","Plugins","Analytics","AnalyticsEvents","context","analytics","LudosSystem","adsManager$","matchManager$","playerManager$","logEngineReady$","ANALYTICS_READY","ENGINE_READY","createManager$","sceneManager$","screenManager$","engineManager$","layoutManager$","pluginsManager$","initManagers$","_this$adsManager$","_this$matchManager$","_this$playerManager$","CORE_BOOTING","handleWhenCoreBoot$","CORE_STARTING","handleWhenCoreStart$","CORE_READY","handleWhenCoreReady$","listenLayoutChanges","inited","handleCocosInit$","Game","EVENT_GAME_INITED","REQUEST_CORE_START","_this$playerManager$2","_this$matchManager$2","setupDefaultGameData","setupDefaultMatchData","_this$playerManager$3","initPlugins$","syncPlatformPlayerData","LOAD_START","processPreStartGame$","preloadScenes$","processBootSceneLaunched$","runBootScene$","StartSDKAfterLoadGame","waitTo","extra","waitSDKInitiatedAsync","waitGameResume$","processStartGame$","EVENT_RESUME","switchScene","SceneKeys","PLAYABLE_SCENE","BOOT_SCENE","getSessionContextType","preloadDashboardScene","preloadGameScene","LOAD_COMPLETE","PLAYER_INFO_LOADED","startProcessContextData$","startGameAsync$","preloadScreens","retries","startGameAsync","JSON","stringify","APP_READY","_this$playerManager$4","processContextData","trackDeviceInfo$","addEventListener","initLanguages","initFrameCapture","initDailyRewards","initLeaderboards","initDynamicAtlas","initDynamicAssets","initCanvasRecorder","initPerformanceMonitor","initAdaptivePerformance","getDeviceInfo$","isES5","heapMemory","audioState","orientation","gpuRenderer","supportWebp","isSupportWebp","log_type","is_es5","pixel_ratio","sdk_platform","getPlatform","screen_orientation","audio_state","heap_memory","support_webp","gpu_renderer","webgl_version","webglVersion","max_texture_size","hardware_concurrency","hardwareConcurrency","deviceInfo","trackDeviceInfo","__sdkLoad","ensure","cclegacy","user","windowID","windows","WeakMap","_decorator","ccclass"],"mappings":"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","file":"all.js","sourcesContent":["export default {\n  text: {\n    'core.nameless': 'Nameless',\n    'game.resume': 'Resume',\n    'game.restart': 'Restart',\n    'game.cancel': 'Cancel',\n    'game.challenge': 'Challenge\\nFriends',\n    'game.next': 'NEXT',\n    'game.completed': 'COMPLETED',\n    'game.tryAgain': 'Try again',\n    'game.retry': 'RETRY',\n    'game.startOverQ': 'Start Over?',\n    'game.startOverMsg': 'Start over? You\\'ll lose your current progress and begin from the start. Are you sure you want to restart?',\n    'game.startOver': 'START OVER',\n    'game.paused': 'Paused',\n    'game.end': 'End',\n    'game.quit': 'Quit',\n    'game.join': 'Join',\n    'game.joinLeaderboard': 'Join Leaderboard',\n    'game.continue': 'Continue',\n    'game.letsPlay': 'Let\\'s Play',\n    'game.logIn': 'Log in',\n    'game.create': 'Create',\n    'game.quitLevelShortMsg': 'Quit Level?',\n    'game.quitSingleMsg': 'Quit now? You\\'re so close to completing this level!',\n    'game.quitTourMsg': 'Quit now? You\\'re just a few levels away from ranking up!',\n    'game.level': 'Level',\n    'game.levelX': 'Level %{0}',\n    'game.hardLevel': 'Hard Level',\n    'game.result': 'Your Result',\n    'game.nextLevel': 'Next Level',\n    'game.win': 'You Win',\n    'game.lose': 'You Lose',\n    'game.draw': 'Draw',\n    'game.replay': 'Replay',\n    'game.boom': 'Boom!',\n    'game.timesUp': 'Time\\'s Up!',\n    'game.bombDesc': 'The bomb exploded!',\n    'game.timesUpDesc': 'Restart or add 2 minutes?',\n    'game.daily': 'Daily',\n    'game.weekly': 'Weekly',\n    'game.endsSoon': 'Ends Soon',\n    'game.endsIn': 'Ends %{0}',\n    'game.player': '1 player',\n    'game.nPlayers': '%{0} players',\n    'game.pTour': '%{0}\\'s Tournament',\n    'game.combo': 'Combo',\n    'game.tourLbUpdated': 'Duel!',\n    'settings.level': 'Level',\n    'settings.settings': 'Settings',\n    'settings.music': 'Music',\n    'settings.sound': 'Sound',\n    'settings.vibrate': 'Vibrate',\n    'settings.on': 'ON',\n    'settings.off': 'OFF',\n    'settings.notification': 'Notification',\n    'settings.report': 'Report',\n    'settings.share': 'Share',\n    'settings.invite': 'Invite Friends',\n    'settings.feedback': 'Feedback',\n    'settings.createShortcut': 'Create\\nShortcut',\n    'settings.or': 'OR',\n    'settings.customMode': 'Custom\\nMode',\n    'custom.customLevel': 'Custom Level',\n    'custom.time': 'Time',\n    'custom.difficulty': 'Difficulty',\n    'custom.easy': 'Easy',\n    'custom.normal': 'Normal',\n    'custom.hard': 'Hard',\n    'custom.extreme': 'Extreme',\n    'custom.bombs': 'Bombs',\n    'custom.ads': 'Extra ads duration',\n    'custom.score': 'Score increase:',\n    'custom.play': 'Play',\n    'ads.cancelled': 'Sorry, No Rewards!\\nYou have cancelled the ad!',\n    'ads.loading': 'Loading ads...',\n    'ads.notReady': 'No ads to display!',\n    'ads.adAfterT': 'AD starting in %{0}...',\n    'ads.levelAfterT': 'Next level in %{0}...',\n    'ads.rewardNotice': 'Watch a short ad to receive\\nthese rewards:',\n    'ads.skip': 'Skip',\n    'ads.daily': 'Daily Rewards',\n    'ads.claim': 'Claim',\n    'ads.claimX2': 'Claim x2',\n    'ads.claimNow': 'Claim Now!',\n    'ads.await': 'Looking for rewards...',\n    'ads.open': 'Open',\n    'ads.coins': 'Get Coins',\n    'ads.getNow': 'Get Now',\n    'ads.freeMinutes': 'Get %{0} FREE minutes',\n    'ads.interNotice.hangTight': 'Short ad break, hang tight!',\n    'ads.interNotice.backInSec': 'Back to the game in just a sec!',\n    'ads.interNotice.quickAd': 'Quick ad, then more fun!',\n    'status.loading': 'Loading',\n    'status.congrats': 'Congratulations',\n    'status.allLevels': 'You have passed all levels.',\n    'status.later': 'Please come back later,\\nwe will update soon!',\n    'status.confirm': 'CONFIRMATION',\n    'status.confirmReset': 'ARE YOU SURE TO START OVER?',\n    'status.resetInfo': 'You will play the game again\\nfrom the beginning, at level 1.',\n    'status.no': 'NO',\n    'status.yes': 'YES',\n    'status.first': '1st',\n    'status.second': '2nd',\n    'status.third': '3rd',\n    'status.nth': '%{0}th',\n    'status.tap': 'Tap to continue',\n    'status.waitingX': 'Waiting%{0}',\n    'status.lbNotAvail': 'Leaderboard is empty.',\n    'status.tourNotAvail': 'No tournaments available.',\n    'pages.shop': 'Shop',\n    'pages.collections': 'Collections',\n    'pages.home': 'Home',\n    'pages.leaderboard': 'Leaderboard',\n    'pages.tournament': 'Tournament',\n    'guide.step1': 'Tap to connect',\n    'guide.step2': 'Connect similar tiles with less than 2 turns',\n    'guide.step3': 'Connect similar tiles with less than 2 turns',\n    'guide.step4': 'More than 2 turns are NOT allowed',\n    'guide.step5': 'There\\'s obstacle between the tiles',\n    'guide.timer': 'Remove all tiles before\\nthe time end',\n    'guide.combo': 'Remove tiles continuously\\nto increase combo!',\n    'guide.hint': 'Tap to reveal a connectable pair',\n    'guide.thunder': 'Tap to remove 2 pairs',\n    'guide.storm': 'Tap to rearrange the tiles',\n    'guide.pliers': 'Tap to remove bomb',\n    'guide.custom': 'Custom mode unlocked.\\n Press this button to set your own difficulty',\n    'interMsg.reviveAd': 'Watch an ad to revive yourself\\nKeep playing and don\\'t give up!',\n    'interMsg.doubleAd': 'Watching an ad doubles your rewards!',\n    'interMsg.ranked': 'Test your skills\\nin ranked tournaments',\n    'interMsg.friendChallenge': 'Challenge your friend\\nSee who can score higher!',\n    'interMsg.bragChallenge': 'Send a challenge to your friend\\nClaim bragging rights!',\n    'interMsg.clearTiles': 'Clear all tiles to\\nwin the level!',\n    'interMsg.beatClock': 'Beat the clock before\\ntime runs out!',\n    'interMsg.clearBombs': 'Clear bombs before\\nthey explode',\n    'interMsg.seasonPack': 'A season pack unlock\\nnew tile sets!',\n    'interMsg.collectStars': 'The more stars you collect\\nThe more coins you\\'ll be rewarded!',\n    'interMsg.competeInLb': 'Compete globally or with friends\\nRise to the top in tournaments!',\n    'interMsg.competeWithFriends': 'You can challenge a friend\\nTest each other\\'s reflexes!',\n    'interMsg.thunder': 'The Thunder power-up\\nblasts tiles away',\n    'interMsg.hint': 'A Hint power-up reveals\\nthe next pair',\n    'interMsg.pliers': 'Pliers can remove\\nany bomb instantly',\n    'interMsg.tornado': 'The Tornado power-up\\nshuffles the board!',\n    'interMsg.coins': 'Earn coins by completing levels\\nWin tournaments for even more!',\n    'interMsg.seasonTiles': 'A new tile set is unlocked\\nevery season packs',\n    'interMsg.dailyLogin': 'Log in daily to claim\\nbetter rewards!',\n    'interMsg.levelUp': 'Level up and earn coins\\nwith each victory!',\n    'interMsg.seasonRewards': 'Each season pack offers\\nnew tiles!',\n    'error.tryLater': 'Sorry, please try again later',\n    'error.soon': 'Coming Soon',\n    'error.noFriendsLb': 'Unable to load friends leaderboard. Please try again later.',\n    'error.noWorldLb': 'Unable to load world leaderboard. Please try again later.',\n    'error.createTourFail': 'Unknown error. Failed to Create Tournament',\n    'error.tourExists': 'You already have a tournament',\n    'error.challengeFail': 'Sorry, you cannot replay\\nat this time.',\n    'error.rewardFail': 'Unable to validate rewards. Please try again later...',\n    'error.tourEnded': 'Tournament has ended',\n    'error.tourJoinFail': 'Sorry, you cannot join\\nat this time.',\n    'error.noAd': 'No ads to display.',\n    'error.ratingNoAuth': 'You need to log in to rate the game.',\n    'error.ratingGameRated': 'You have already rated the game.',\n    'error.ratingFail': 'Failed to rate the game.',\n    'error.shortcutFail': 'Failed to create shortcut.',\n    'error.login': 'Failed to log in.',\n    'error.joinLb': 'Failed to join the leaderboard.',\n    'reward.day': 'Day',\n    'reward.dayX': 'Day %{0}',\n    'reward.starChestTitle': 'Star Chest',\n    'reward.starChestAvailable': 'Congrats, you have enough stars to open the chest!',\n    'reward.starChestUnavailable': 'Win more stars to open!',\n    'item.hint': 'Hint',\n    'item.thunder': 'Thunder',\n    'item.storm': 'Storm',\n    'item.pliers': 'Pliers',\n    'item.hintDesc': 'Shows a pair of tiles\\nthat can be connected.',\n    'item.thunderDesc': 'Remove 2 pair of tiles\\non the game field.',\n    'item.stormDesc': 'Randomly rearranges the \\ntiles on the game field.',\n    'item.pliersDesc': 'Removes a random bomb\\nfrom the game field.',\n    'theme.newTiles': 'New tiles',\n    'theme.summer': 'Summer Levels',\n    'theme.autumn': 'Autumn Levels',\n    'theme.winter': 'Winter Levels',\n    'theme.springFestival': 'Spring Festival Levels',\n    'theme.treePlantingFestival': 'Tree Planting Festival Levels',\n    'theme.blueSeaFestival': 'Blue Sea Festival Levels',\n    'theme.musicFestival': 'Music Festival Levels',\n    'theme.harvestFestival': 'Harvest Festival Levels',\n    'theme.foodFestival': 'Food Festival Levels',\n    'theme.snowFestival': 'Snow Festival Levels',\n    'theme.lightFestival': 'Light Festival Levels',\n    'theme.peaceFestival': 'Peace Festival Levels',\n    'theme.flowerFestival': 'Flower Festival Levels',\n    'theme.streetFestival': 'Street Festival Levels',\n    'theme.colorGarden': 'Color Garden Levels',\n    'theme.colorFestival': 'Color Festival Levels',\n    'theme.natureSummer': 'Nature Summer Levels',\n    'theme.snowMountain': 'Snow Mountain Levels',\n    'theme.iceFestival': 'Ice Festival Levels',\n    'theme.greenGrassFestival': 'Green Grass Festival Levels',\n    'theme.communityFestival': 'Community Festival Levels',\n    'theme.waterFestival': 'Water Festival Levels',\n    'theme.animalFestival': 'Animal Festival Levels',\n    'theme.lostFestival': 'Lost Festival Levels',\n    'theme.halloweenFestival': 'Halloween Festival Levels',\n    'theme.snowMusicFestival': 'Snow Music Festival Levels',\n    'theme.christmas': 'Christmas Levels',\n    'theme.springFlowerFestival': 'Spring Flower Festival Levels',\n    'theme.tetHoliday': 'Tet Holiday Levels',\n    'theme.seaFestival': 'Sea Festival Levels',\n    'theme.fireworkFestival': 'Firework Festival Levels',\n    'theme.halloweenHorror': 'Halloween Horror Levels',\n    'theme.midAutumn': 'Mid Autumn Levels',\n    'theme.christmasSweet': 'Christmas Sweet Levels',\n    'theme.newYearCountdown': 'New Year Countdown Levels',\n    'theme.happyNewYear': 'Happy New Year Levels',\n    'share.canYouDoBetter': 'Can you do better?',\n    'dashboard.unlockLevel': 'Unlock lv.%{0}'\n  },\n  texture: {\n    draw: 'locales/en/scenes/result-scene/resources/text_draw',\n    lose: 'locales/en/scenes/result-scene/resources/text_lose',\n    victory: 'locales/en/scenes/result-scene/resources/text_victory',\n    waiting: 'locales/en/scenes/result-scene/resources/text_waiting',\n    excellent: 'locales/en/scenes/game-scene/resources/effects/text-effect/excellent',\n    good: 'locales/en/scenes/game-scene/resources/effects/text-effect/good',\n    great: 'locales/en/scenes/game-scene/resources/effects/text-effect/great',\n    wellDone: 'locales/en/screens/level-complete-screen/resources/well_done',\n    freeRewards: 'locales/en/screens/get-rewards-screen/resources/free_rewards'\n  }\n}","import { game } from 'cc'\nimport GameEvents from '../constants/GameEvents'\nimport AdsUtils from '../utils/AdsUtils'\nimport LayoutUtils from '../utils/LayoutUtils'\n\nconst {\n    Events,\n    Configs: {\n        Ads: { Enabled, PreloadAds, ShowAdOnLoad },\n    },\n    Utils: { Time: T, Decorator },\n} = Ludex\n\nconst { event } = codex\n\nclass AdsManager {\n    public init() {\n        this.listenEvents$()\n        console.debug('Ads Manager: Initialized', { Enabled, PreloadAds, ShowAdOnLoad })\n    }\n\n    private listenEvents$ = (): void => {\n        event.on(Events.AD_CLOSED, this.requestResizeGame$)\n\n        event.catchUp(Events.GAME_READY, this.processPreloadAds$)\n\n        event.catchUp(Events.GAME_SDK_READY, this.processShowFirstInterstitialAd)\n\n        event.catchUp(Events.CONTEXT_DATA_PROCESSED, this.processShowBannerAds$)\n\n        event.catchUp(Events.CONTEXT_DATA_PROCESSED, () => {\n            game.on(GameEvents.LAYOUT_CHANGED, this.handleLayoutChanged$)\n        })\n    }\n\n    private requestResizeGame$ = () => {\n        event.emit(Events.REQUEST_RESIZE_GAME)\n    }\n\n    private processShowBannerAds$ = async () => {\n        if (!Enabled) return\n\n        await T.sleepAsync(5000)\n\n        AdsUtils.updateBannerAdsByLayout(LayoutUtils.getCurrentLayout())\n        AdsUtils.refreshBannerAdVisibility()\n    }\n\n    private processPreloadAds$ = async () => {\n        if (!PreloadAds) return\n        await T.sleepAsync(3 * 1000)\n\n        AdsUtils.preloadAds()\n    }\n\n    @Decorator.tryCatch()\n    private processShowFirstInterstitialAd = async () => {\n        if (!Enabled) return\n\n        const { Enabled: ShowAdOnLoadEnabled, DelaySeconds } = ShowAdOnLoad\n        if (!ShowAdOnLoadEnabled) return\n\n        if (DelaySeconds > 0) {\n            await T.sleepAsync(DelaySeconds * 1000)\n        }\n\n        // ? In Yandex, must be paused when showing interstitial ad\n        const isYandex = GameSDK.isGameSDK('Yandex')\n\n        if (isYandex) {\n            game.pause()\n        }\n\n        await AdsUtils.showInterstitialAdAsync({ forceLoad: true, contextType: 'preroll' })\n\n        if (isYandex) {\n            game.resume()\n        }\n    }\n\n    private handleLayoutChanged$ = () => {\n        AdsUtils.updateBannerAdsByLayout(LayoutUtils.getCurrentLayout())\n        AdsUtils.refreshBannerAdVisibility()\n    }\n}\n\nexport default AdsManager\n","import type { RenderFlow } from 'cc'\nimport {\n    AssetManager,\n    DynamicAtlasManager,\n    director,\n    game,\n    Input,\n    input,\n    macro,\n    Settings,\n    settings,\n    sys,\n    View,\n} from 'cc'\nimport { DEV, EDITOR_NOT_IN_PREVIEW } from 'cc/env'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: { DynamicAtlas: DynamicAtlasConfig, PreferredFPS },\n    },\n    Utils: { Valid: V, Device: D },\n} = Ludex\n\nconst { event } = codex\n\ntype DynamicAtlasConfig = Ludex.Configs.DynamicAtlasConfig\n\nclass EngineManager {\n    public init() {\n        this.overrideSettings$()\n\n        this.setupAutoAtlas$()\n        this.setupBatcherLimit$()\n        this.setupDynamicAtlas$()\n        this.setupAssetDownloader$()\n        // this.setupOptimalCoreLoop$()\n        this.setupOptimalPipelines$()\n        this.setupEngineRunningState$()\n\n        console.debug('Engine Manager: Initialized', { PreferredFPS })\n    }\n\n    private overrideSettings$ = (): void => {\n        settings.overrideSettings(Settings.Category.ENGINE, 'debug', V.isDebugger())\n        // settings.overrideSettings(Settings.Category.ENGINE, 'platform', 'web-desktop')\n\n        // ? Don't allow resize when resizing\n        View.instance.resizeWithBrowserSize(false)\n\n        // ? frameRate in here not target frame rate, as preferred FPS.\n        if (D.isDesktop()) {\n            game.frameRate = PreferredFPS.Desktop\n        } else {\n            game.frameRate = PreferredFPS.Mobile\n        }\n    }\n\n    private setupAutoAtlas$ = (): void => {\n        AssetManager.instance.cacheAsset = true\n    }\n\n    private setupAssetDownloader$ = async (): Promise<void> => {\n        const { downloader } = AssetManager.instance\n\n        downloader.maxConcurrency = DEV ? 60 : 24\n        downloader.maxRequestsPerFrame = DEV ? 60 : 24\n\n        const webpSupport = await this.checkWebpSupport$()\n\n        // ? Double check webp support\n        // * Only need for test form DevTools, it block requests, not block webp feature in webgl\n        if (sys.hasFeature(sys.Feature.WEBP)) {\n            const originHasFeature = sys.hasFeature\n            sys.hasFeature = (feature: sys.Feature) => {\n                if (feature === sys.Feature.WEBP) {\n                    return webpSupport\n                }\n\n                return originHasFeature(feature)\n            }\n        }\n    }\n\n    private checkWebpSupport$ = () => {\n        // ? Use image to check webp support\n        return new Promise<boolean>((resolve) => {\n            const image = new Image()\n            image.onload = () => resolve(true)\n            image.onerror = () => resolve(false)\n            image.src = 'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA='\n        })\n    }\n\n    private getPipelineFlows$ = () => {\n        // @ts-expect-error - flows is private\n        return (director.root?.pipeline?.flows satisfies RenderFlow[]) ?? []\n    }\n\n    private getRenderQueues$ = (stageIndex: number) => {\n        const flows = this.getPipelineFlows$()\n        const forwardFlow = flows[0]\n\n        if (!forwardFlow?.stages) return []\n\n        return forwardFlow.stages[stageIndex].renderQueues\n    }\n\n    /* private setupOptimalCoreLoop$ = () => {\n        const scheduler = director.getScheduler()\n        // scheduler.setIn\n    } */\n\n    private setupOptimalPipelines$ = async () => {\n        const { transformPipeline } = AssetManager.instance\n\n        // ? Remove replaceOverrideAsset\n        transformPipeline.remove(1)\n\n        if (EDITOR_NOT_IN_PREVIEW) return\n\n        await V.isValueChangeAsync(() => !!director.root, true, {\n            timeout: 10000,\n        })\n\n        const flows = this.getPipelineFlows$()\n\n        // ? Remove ShadowFlow\n        flows.shift()\n\n        // ? Remove ReflectionProbeFlow\n        flows.shift()\n\n        // ? Get from ForwardStage\n        const renderQueues = this.getRenderQueues$(0)\n\n        // ? Remove unnecessary stages (3D)\n        renderQueues.shift()\n        renderQueues.shift()\n    }\n\n    private setupEngineRunningState$ = (): void => {\n        // Resume engine when tap to game\n        input.on(Input.EventType.TOUCH_START, this.handleResumeEngine$)\n\n        // ? Only enable when game is ready, avoid pause when loading\n        event.catchUp(Events.GAME_READY, () => {\n            event.on(Events.VISIBILITY_HIDDEN, this.handlePauseEngine$)\n            event.on(Events.VISIBILITY_VISIBLE, this.handleResumeEngine$)\n        })\n    }\n\n    private handlePauseEngine$ = async () => {\n        console.debug('Engine: Paused', game.isPaused())\n        if (game.isPaused()) return\n\n        // TODO: save last volume\n        // await AudioUtils.turnOffMusic()\n        // game.pause()\n    }\n\n    private handleResumeEngine$ = async () => {\n        console.debug('Engine: Resumed', game.isPaused())\n        if (!game.isPaused()) return\n\n        // game.resume()\n        // await AudioUtils.turnUpMusic()\n    }\n\n    private setupDynamicAtlas$ = (): void => {\n        if (sys.isBrowser) {\n            this.setupDynamicAtlasForBrowser$()\n        } else if (sys.isNative) {\n            this.setupDynamicAtlasForNative$()\n        } else {\n            this.disableDynamicAtlas$()\n        }\n    }\n\n    private setupDynamicAtlasForBrowser$ = (): void => {\n        switch (sys.os) {\n            case sys.OS.IOS:\n                this.setupDynamicAtlasForIOS$()\n                break\n            case sys.OS.ANDROID:\n                this.setupDynamicAtlasForAndroid$()\n                break\n            case sys.OS.OSX:\n            case sys.OS.LINUX:\n            case sys.OS.WINDOWS:\n                this.setupDynamicAtlasForDesktop$()\n                break\n            default:\n                this.setupDynamicAtlasDefault$()\n                break\n        }\n    }\n\n    private setupDynamicAtlasForNative$ = (): void => {\n        switch (sys.platform) {\n            case sys.Platform.ANDROID:\n                this.setupDynamicAtlasForAndroid$()\n                break\n            case sys.Platform.IOS:\n                this.setupDynamicAtlasForIOS$()\n                break\n            default:\n                this.setupDynamicAtlasDefault$()\n                break\n        }\n    }\n\n    private setDynamicAtlas$ = (options: DynamicAtlasConfig): void => {\n        const { Enabled, MaxAtlasCount, MaxAtlasSize, MaxFrameSize } = options\n        const { instance } = DynamicAtlasManager\n\n        macro.CLEANUP_IMAGE_CACHE = !Enabled\n\n        instance.enabled = Enabled\n        instance.textureSize = MaxAtlasSize\n        instance.maxFrameSize = MaxFrameSize\n        instance.maxAtlasCount = MaxAtlasCount\n\n        // ? Set to false to save some memory, but textures may not fit as expected.\n        instance.textureBleeding = DynamicAtlasConfig.OptimizeAtlas.TextureBleeding\n\n        const maxSize = this.getMaxTextureSize$() || MaxAtlasSize\n\n        const correctSize = Math.min(MaxAtlasSize, maxSize)\n        instance.textureSize = correctSize\n\n        if (MaxFrameSize > correctSize) {\n            instance.maxFrameSize = correctSize\n        }\n    }\n\n    private getMaxTextureSize$ = (): number => {\n        if (!director.root) return -1\n        const { capabilities } = director.root.device\n        const { maxTextureSize } = capabilities\n\n        const textureSize = Math.min(D.maxTextureSize(), maxTextureSize)\n\n        // ? 1024 is the safe memory for other textures\n        const safeMemory = 1024\n\n        // ? Limit max texture size to 8192, almost games don't need more than this\n        if (textureSize > 8192) return 8192 - safeMemory\n\n        const { maxFrameSize = 0 } = DynamicAtlasManager.instance\n        const maxSize = textureSize - safeMemory\n\n        if (maxSize <= maxFrameSize || maxSize <= 0) return -1\n\n        return maxSize\n    }\n\n    private setupDynamicAtlasForIOS$ = (): void => {\n        const { IOS } = DynamicAtlasConfig\n        this.setDynamicAtlas$(IOS)\n    }\n\n    private setupDynamicAtlasForAndroid$ = (): void => {\n        const { Android } = DynamicAtlasConfig\n        this.setDynamicAtlas$(Android)\n    }\n\n    private setupDynamicAtlasForDesktop$ = (): void => {\n        const { Desktop } = DynamicAtlasConfig\n        this.setDynamicAtlas$(Desktop)\n    }\n\n    private setupDynamicAtlasDefault$ = (): void => {\n        const config: DynamicAtlasConfig = {\n            Enabled: true,\n            MaxAtlasCount: 1,\n            MaxAtlasSize: 4096,\n            MaxFrameSize: 1024,\n        }\n\n        this.setDynamicAtlas$(config)\n    }\n\n    private disableDynamicAtlas$ = (): void => {\n        macro.CLEANUP_IMAGE_CACHE = true\n        DynamicAtlasManager.instance.enabled = false\n    }\n\n    private setupBatcherLimit$ = (): void => {\n        macro.BATCHER2D_MEM_INCREMENT = 288\n        macro.MAX_LABEL_CANVAS_POOL_SIZE = 125\n    }\n}\n\nexport default EngineManager\n","import { game, macro, ResolutionPolicy, Size, screen, view } from 'cc'\nimport GameEvents from '../constants/GameEvents'\nimport GameWorld from '../constants/GameWorld'\nimport CocosUtils from '../utils/CocosUtils'\n\nconst {\n    Layout,\n    DesignSize: { Portrait, Landscape },\n    AcceptPortraitRatio,\n} = GameWorld\n\nconst {\n    Utils: { Decorator },\n    Configs: {\n        GameEngine: { AutoResizeCanvas },\n    },\n    Events,\n} = Ludex\n\nconst { ads, event } = codex\n\ntype Layout = (typeof Layout)[keyof typeof Layout]\ntype ResizeEventPayload = {\n    forcePixelRatio: number\n}\n\nclass LayoutManager {\n    private currentLayout$?: Layout\n    private resolutionPolicy$!: ResolutionPolicy\n\n    public init() {\n        this.listenResizeEvent$()\n        this.setupResolutionPolicy$()\n\n        console.debug('Layout Manager: Initialized', { AcceptPortraitRatio, AutoResizeCanvas })\n    }\n\n    private listenResizeEvent$ = (): void => {\n        if (AutoResizeCanvas && ResizeObserver) {\n            const resizeEventCallbacks = window.__listeners.resize ?? []\n            if (resizeEventCallbacks.length > 0) {\n                for (const callback of resizeEventCallbacks) {\n                    window.removeEventListener('resize', callback)\n                }\n            }\n\n            const observer = new ResizeObserver(this.handleBodyResize)\n            observer.observe(window.document.body)\n        }\n\n        event.on(Events.REQUEST_RESIZE_GAME, this.handleViewResizeBySystem$)\n    }\n\n    private setupResolutionPolicy$ = (): void => {\n        view.setOrientation(macro.ORIENTATION_AUTO)\n\n        this.resolutionPolicy$ = view.getResolutionPolicy()\n\n        this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.EXACT_FIT)\n\n        // ? Make canvas fit to world size\n        this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n    }\n\n    private isAdShowing$ = (): boolean => {\n        if (ads?.isAdFullSizeShowing()) {\n            console.error(' LayoutManager:handleViewResize skipped because ad is showing')\n            return true\n        }\n\n        return false\n    }\n\n    private readonly handleViewResizeBySystem$ = (payload: ResizeEventPayload) => {\n        if (this.isAdShowing$()) return\n\n        const maxDpr = CocosUtils.getMaxPixelRatio()\n        const { forcePixelRatio = maxDpr } = payload ?? {}\n\n        console.debug(' View resize by system', { forcePixelRatio, maxDpr })\n\n        window.devicePixelRatio = forcePixelRatio ?? maxDpr\n\n        this.setupOrientationByCanvasSize$()\n    }\n\n    @Decorator.debounce(100)\n    private handleBodyResize = (): void => {\n        if (this.isAdShowing$()) return\n\n        const maxDpr = CocosUtils.getMaxPixelRatio()\n\n        console.debug(' View resize by body', { maxDpr })\n\n        window.devicePixelRatio = maxDpr\n\n        this.setupOrientationByCanvasSize$()\n    }\n\n    private setupOrientationByCanvasSize$ = (): void => {\n        const screenRatio = this.getScreenRatio$()\n\n        // console.debug(' Screen Ratio', screenRatio)\n        // console.debug(' Portrait Ratio', AcceptPortraitRatio)\n        // console.debug(' Current Layout', this.currentLayout)\n\n        switch (GameWorld.PRIMARY_LAYOUT) {\n            case 'portrait':\n                this.setPortraitView$()\n                break\n            case 'landscape':\n                this.setLandscapeView$()\n                break\n            case 'auto':\n                if (screenRatio <= AcceptPortraitRatio) {\n                    this.setPortraitView$()\n                } else {\n                    this.setLandscapeView$()\n                }\n                break\n        }\n    }\n\n    private setPortraitView$ = (): void => {\n        const { WIDTH, HEIGHT } = Portrait\n\n        const isPrimaryLayoutPortrait = GameWorld.PRIMARY_LAYOUT === Layout.Portrait\n        if (this.currentLayout$ !== Layout.Portrait || isPrimaryLayoutPortrait) {\n            this.currentLayout$ = Layout.Portrait\n            this.setupLayoutStrategy$(WIDTH, HEIGHT)\n        }\n\n        this.resizeGameView$(WIDTH, HEIGHT)\n    }\n\n    private setLandscapeView$ = (): void => {\n        const { WIDTH, HEIGHT } = Landscape\n\n        const isPrimaryLayoutLandscape = GameWorld.PRIMARY_LAYOUT === Layout.Landscape\n        if (this.currentLayout$ !== Layout.Landscape || isPrimaryLayoutLandscape) {\n            this.currentLayout$ = Layout.Landscape\n            this.setupLayoutStrategy$(WIDTH, HEIGHT)\n        }\n\n        this.resizeGameView$(WIDTH, HEIGHT)\n    }\n\n    private setupLayoutStrategy$ = (designWidth: number, designHeight: number): void => {\n        const { width, height } = view.getDesignResolutionSize()\n        const contentStrategy = this.resolutionPolicy$.getContentStrategy()\n\n        // @ts-expect-error - This is a private property\n        const containerStrategy = this.resolutionPolicy$._containerStrategy.name\n\n        const isPortrait = this.currentLayout$ === Layout.Portrait\n        const isLandscape = this.currentLayout$ === Layout.Landscape\n\n        if (isPortrait) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_WIDTH)\n        }\n\n        if (isLandscape) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_HEIGHT)\n        }\n\n        if (isPortrait && !GameWorld.FULL_PORTRAIT_SIZE) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.SHOW_ALL)\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n        }\n\n        if (isLandscape && !GameWorld.FULL_LANDSCAPE_SIZE) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.EXACT_FIT)\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n        }\n\n        const screenRatio = this.getScreenRatio$()\n        const { AcceptPortraitRatio } = GameWorld\n\n        if (screenRatio > AcceptPortraitRatio && isPortrait) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_HEIGHT)\n        }\n\n        if (GameWorld.FULL_PORTRAIT_SIZE && isPortrait) {\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.EQUAL_TO_FRAME)\n        }\n\n        if (GameWorld.FULL_LANDSCAPE_SIZE && isLandscape) {\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.EQUAL_TO_FRAME)\n        }\n\n        if (\n            width !== designWidth ||\n            height !== designHeight ||\n            contentStrategy !== this.resolutionPolicy$.getContentStrategy() ||\n            // @ts-expect-error - This is a private property\n            containerStrategy !== this.resolutionPolicy$._containerStrategy.name\n        ) {\n            view.setDesignResolutionSize(designWidth, designHeight, this.resolutionPolicy$)\n        }\n\n        console.debug(' Change layout to', this.currentLayout$, this.resolutionPolicy$)\n\n        game.emit(GameEvents.LAYOUT_CHANGED, this.currentLayout$)\n    }\n\n    private resizeGameView$ = (designWidth: number, designHeight: number): void => {\n        // console.debug(' Design Size', { designWidth, designHeight })\n\n        const { Resolution } = GameWorld.DesignSize\n        const worldSize = new Size(designWidth / Resolution, designHeight / Resolution)\n\n        // console.debug(' World Size', worldSize)\n\n        // const canvasSize = screen.windowSize\n        // console.debug(' Canvas Size', canvasSize)\n\n        const screenWidth = CocosUtils.getScreenWidthCss()\n        const screenHeight = CocosUtils.getScreenHeightCss()\n\n        // console.debug(' Screen Size', { screenWidth, screenHeight })\n\n        const scaleX = screenWidth / worldSize.width\n        const scaleY = screenHeight / worldSize.height\n\n        // console.debug(' Scale factor', { scaleX, scaleY })\n\n        const gameSize = new Size(worldSize.width, worldSize.height)\n\n        const isFullPortraitSize = GameWorld.FULL_PORTRAIT_SIZE && this.currentLayout$ === Layout.Portrait\n        const isFullLandscapeSize = GameWorld.FULL_LANDSCAPE_SIZE && this.currentLayout$ === Layout.Landscape\n\n        if (isFullPortraitSize || isFullLandscapeSize) {\n            gameSize.width *= scaleX\n            gameSize.height *= scaleY\n        } else {\n            const scale = Math.min(scaleX, scaleY)\n            gameSize.width *= scale\n            gameSize.height *= scale\n        }\n\n        // console.debug(' Game Size', gameSize)\n\n        const viewWidth = CocosUtils.worldSizeToCssSize(gameSize.width)\n        const viewHeight = CocosUtils.worldSizeToCssSize(gameSize.height)\n\n        const viewSize = new Size(viewWidth, viewHeight)\n        screen.windowSize = viewSize\n\n        game.emit(GameEvents.VIEW_RESIZED, viewSize)\n\n        console.info(' View Resized', viewSize)\n    }\n\n    private getScreenRatio$ = (): number => {\n        const screenWidth = CocosUtils.getScreenWidthCss()\n        const screenHeight = CocosUtils.getScreenHeightCss()\n        return screenWidth / screenHeight\n    }\n}\n\nexport default LayoutManager\n","import DefaultMatchCustomData from '../constants/MatchCustomData'\nimport TileSpecialTypes from '../gameplay/game-objects/board/constants/TileSpecialTypes'\n\nconst {\n    Utils: { Valid: V, Object: O, Array: A },\n    Dtos: {\n        Match: { CustomData: MatchCustomData } = {},\n    },\n} = Ludex\n\ntype RequiredKeys<T> = {\n    [K in keyof T]-?: Record<string, unknown> extends Pick<T, K> ? never : K\n}[keyof T]\n\ntype LevelFenRequiredKeys = RequiredKeys<LevelFen>\nconst LevelFenKeys: Array<LevelFenRequiredKeys> = ['code', 'cols', 'encoding', 'idSize', 'rows']\n\ntype LevelRulesRequiredKeys = RequiredKeys<LevelRules>\nconst LevelRulesKeys: Array<LevelRulesRequiredKeys> = ['addRandomTilesPerMove', 'maxSpaceOfPair']\n\nclass MatchManager {\n    public init() {\n        console.debug('Match Manager: Initialized')\n    }\n\n    public setupDefaultMatchData(): void {\n        this.setupMatchData$()\n        this.setupMatchCustomData$()\n    }\n\n    private setupMatchCustomData$ = () => {\n        if (!MatchCustomData) return\n\n        // * Add default custom match data\n        // ? Check interface from /types/corecos/match.d.ts\n        MatchCustomData.addDefaults(DefaultMatchCustomData)\n\n        // ? Override validate function or add new validate function\n        MatchCustomData.addValidator('score', (score: unknown) => {\n            if (!V.isNumber(score) || score < 0) {\n                throw new Error(`score ${score} is invalid`)\n            }\n        })\n    }\n\n    private setupMatchData$ = () => {\n        if (!MatchCustomData) return\n\n        MatchCustomData.addValidator('challengeData', (challengeData: unknown) => {\n            if (challengeData === undefined || challengeData === null) {\n                return // * Allow undefined and null\n            }\n\n            if (!V.isObject(challengeData)) {\n                throw new Error(`challengeData ${challengeData} must be a record of string keys`)\n            }\n\n            const challengeDataObj = challengeData as Record<string, unknown>\n            const keysForChallengeData = Object.keys(challengeDataObj)\n\n            if (!A.has(keysForChallengeData, 'level')) {\n                throw new Error('challengeData.level is missing')\n            }\n\n            if (!V.isNumber(challengeDataObj.level)) {\n                throw new Error(`challengeData.level ${challengeDataObj.level} must be a number`)\n            }\n\n            if (!A.has(keysForChallengeData, 'fen')) {\n                throw new Error('challengeData.fen is missing')\n            }\n\n            this.validateFen$(challengeDataObj.fen)\n\n            if (!A.has(keysForChallengeData, 'gravity')) {\n                throw new Error('challengeData.gravity is missing')\n            }\n\n            if (!V.isString(challengeDataObj.gravity)) {\n                throw new Error(`challengeData.gravity ${challengeDataObj.gravity} must be a string`)\n            }\n\n            if (!A.has(keysForChallengeData, 'rules')) {\n                throw new Error('challengeData.rules is missing')\n            }\n\n            this.validateLevelRules$(challengeDataObj.rules)\n\n            if (!A.has(keysForChallengeData, 'time')) {\n                throw new Error('challengeData.time is missing')\n            }\n\n            if (!V.isNumber(challengeDataObj.time)) {\n                throw new Error(`challengeData.time ${challengeDataObj.time} must be a number`)\n            }\n        })\n    }\n\n    private validateFen$ = (fen: unknown) => {\n        if (!V.isObject(fen)) {\n            throw new Error(`challengeData.fen ${fen} must be a record of string keys`)\n        }\n\n        const validFenObject = this.validateKeys$(fen as Record<string, unknown>, LevelFenKeys)\n\n        if (!V.isNumber(validFenObject.idSize)) {\n            throw new Error('fen.idSize must be a number')\n        }\n\n        if (!V.isString(validFenObject.code)) {\n            throw new Error('fen.code must be a string')\n        }\n\n        if (!V.isNumber(validFenObject.rows)) {\n            throw new Error('fen.rows must be a number')\n        }\n\n        if (!V.isNumber(validFenObject.cols)) {\n            throw new Error('fen.cols must be a number')\n        }\n\n        if (!V.isObject(validFenObject.encoding)) {\n            throw new Error('fen.encoding must be a record of string keys')\n        }\n\n        const validEncoding = this.validateKeys$(\n            validFenObject.encoding as Record<string, unknown>,\n            O.vals(TileSpecialTypes),\n        )\n\n        // biome-ignore lint/complexity/noForEach: simple\n        Object.entries(validEncoding).forEach(([key, value]) => {\n            if (!V.isString(value)) {\n                throw new Error(`fen.encoding.${key} ${value} must be a string`)\n            }\n        })\n    }\n\n    private validateLevelRules$ = (rules: unknown) => {\n        if (!V.isObject(rules)) {\n            throw new Error(`challengeData.rules ${rules} must be a record of string keys`)\n        }\n\n        const validRules = this.validateKeys$(rules as Record<string, unknown>, LevelRulesKeys)\n\n        if (!V.isNumber(validRules.addRandomTilesPerMove)) {\n            throw new Error('rules.addRandomTilesPerMove must be a number')\n        }\n\n        if (!V.isNumber(validRules.maxSpaceOfPair)) {\n            throw new Error('rules.maxSpaceOfPair must be a number')\n        }\n    }\n\n    private validateKeys$ = <T extends string>(\n        obj: Record<string, unknown>,\n        keys: ReadonlyArray<T>,\n    ): Record<T, unknown> => {\n        const objKeys = Object.keys(obj) as Array<T>\n\n        // biome-ignore lint/complexity/noForEach: simple\n        objKeys.forEach((key) => {\n            if (!A.has(keys, key)) {\n                throw new Error(`Key ${key} is missing`)\n            }\n        })\n\n        return obj\n    }\n}\n\nexport default MatchManager\n","import GameData from '../constants/GameData'\nimport PlayerData from '../constants/PlayerData'\nimport ItemKeys from '../gameplay/constants/ItemKeys'\n\nconst {\n    Utils: { Valid: V, Array: A, Object: O, Browser: B },\n    Dtos: { Player },\n} = Ludex\n\nconst { player } = codex\nconst GameName = window.GameName.replace(/ /g, '-')\n\nclass PlayerManager {\n    public init() {\n        console.debug('Player Manager: Initialized')\n    }\n\n    public setupDefaultGameData(): void {\n        // * Make player dtos is loose\n        // ? Use default value if value is invalid\n        Player.Data.makeLoose()\n        Player.GameData.makeLoose()\n\n        // * Add default player game data\n        // ? Check interface from /types/ludex/player.d.ts\n        Player.Data.addDefaults(PlayerData)\n        Player.GameData.addDefaults(GameData)\n\n        // ? Override validate function or add new validate function\n        Player.GameData.addValidator('stars', (stars: unknown) => {\n            if (!V.isNumber(stars) || stars < 0) {\n                throw new Error(`stars ${stars} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('totalLevel', (totalLevel: number) => {\n            if (!V.isNumber(totalLevel) || totalLevel < 1) {\n                // throw new Error(`totalLevel ${totalLevel} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('levelVersion', (levelVersion: number) => {\n            if (!V.isNumber(levelVersion) || levelVersion < 0) {\n                throw new Error(`levelVersion ${levelVersion} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('lastRewardedItems', (lastRewardedItems: number) => {\n            if (!V.isNumber(lastRewardedItems) || lastRewardedItems < 0) {\n                throw new Error(`lastRewardedItems ${lastRewardedItems} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('lastCreateTournamentShown', (lastCreateTournamentShown: number) => {\n            if (!V.isNumber(lastCreateTournamentShown) || lastCreateTournamentShown < 0) {\n                throw new Error(`lastCreateTournamentShown ${lastCreateTournamentShown} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('guideItemShowed', (guideItemShowed: unknown) => {\n            if (!Array.isArray(guideItemShowed)) {\n                throw new Error(`guideItemShowed ${guideItemShowed} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('items', (items: unknown) => {\n            if (!V.isObject(items)) {\n                throw new Error(`items ${items} is invalid`)\n            }\n\n            const keys = Object.keys(items)\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const values = O.vals(items) as any[]\n\n            if (!A.has(keys, ItemKeys.HINT)) {\n                throw new Error(`item ${ItemKeys.HINT} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.THUNDER)) {\n                throw new Error(`item ${ItemKeys.THUNDER} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.STORM)) {\n                throw new Error(`item ${ItemKeys.STORM} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.PLIERS)) {\n                throw new Error(`item ${ItemKeys.PLIERS} not found`)\n            }\n\n            // biome-ignore lint/complexity/noForEach: simple\n            values.forEach((value) => {\n                if (!V.isNumber(value) || value < 0) {\n                    throw new Error(`item ${value} is invalid`)\n                }\n            })\n        })\n\n        Player.GameData.addValidator('tournamentProgress', (tournamentProgress: unknown) => {\n            if (!V.isObject(tournamentProgress)) {\n                throw new Error(`tournamentProgress ${tournamentProgress} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('custom', (custom: unknown) => {\n            if (!V.isObject(custom)) {\n                throw new Error(`custom ${custom} is invalid`)\n            }\n\n            const keys = Object.keys(custom)\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n            if (!A.has(keys, 'time')) {\n                throw new Error('custom time not found')\n            }\n\n            if (!A.has(keys, 'difficulty')) {\n                throw new Error('custom tiles not found')\n            }\n\n            if (!A.has(keys, 'bombs')) {\n                throw new Error('custom bombs not found')\n            }\n\n            if (!A.has(keys, 'ads')) {\n                throw new Error('custom ads not found')\n            }\n        })\n\n        Player.GameData.addValidator('endlessScore', (endlessScore: number) => {\n            if (!V.isNumber(endlessScore) || endlessScore < 0) {\n                throw new Error(`endlessScore ${endlessScore} is invalid`)\n            }\n        })\n    }\n\n    public syncPlatformPlayerData(): void {\n        if (GameSDK.isGameSDK('MsGames')) {\n            this.syncOldPlayerDataForMsGames()\n            return\n        }\n    }\n\n    private syncOldPlayerDataForMsGames(): void {\n        const oldLocalStorageKey = `${GameName}_PlayerData`\n        const oldVersionData = B.getLocalStorage(oldLocalStorageKey)\n        if (!V.isObject(oldVersionData)) return\n\n        const oldPlayerData = new Player.Data(oldVersionData).toObject()\n\n        const currentPlayerData = player.getPlayerData()\n        if (!V.isObject(currentPlayerData)) return\n\n        const { level: currentLevel } = currentPlayerData.gameData\n        const { level: oldLevel } = oldPlayerData.gameData\n\n        if (currentLevel >= oldLevel) return\n\n        player.setPlayerData(oldPlayerData)\n    }\n\n    public requestConnectedPlayers(): void {\n        player.requestConnectedPlayers().catch((error) => {\n            console.warn('player.requestConnectedPlayers', error)\n        })\n    }\n}\n\nexport default PlayerManager\n","import { Director, type Scene, director, game } from 'cc'\n\nconst {\n    Utils: { Valid: V },\n} = Ludex\nconst { adaptivePerformance } = codex\n\nclass AdaptivePerformance {\n    public init() {\n        if (!adaptivePerformance) return\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        director.once(Director.EVENT_BEGIN_FRAME, this.handleBeginFrame$)\n        director.on(Director.EVENT_AFTER_SCENE_LAUNCH, this.handleAfterSceneLaunch$)\n    }\n\n    private handleBeginFrame$ = () => {\n        director.on(Director.EVENT_AFTER_UPDATE, this.lateUpdate$)\n        director.on(Director.EVENT_BEFORE_UPDATE, this.updateActualFPS$)\n    }\n\n    private handleAfterSceneLaunch$ = (scene: Scene) => {\n        if (!adaptivePerformance) return\n\n        adaptivePerformance.trackingScene(scene.name)\n    }\n\n    private lateUpdate$ = () => {\n        const dtInMs = game.deltaTime * 1000\n        adaptivePerformance?.updatePostStepDeltaTime(dtInMs)\n    }\n\n    private updateActualFPS$ = () => {\n        const actualFPS = director.root?.fps\n        if (!V.isNumber(actualFPS)) return\n        adaptivePerformance?.updateActualFPS(actualFPS)\n    }\n}\n\nexport default AdaptivePerformance\n","import { Director, director, game } from 'cc'\n\nconst { canvasRecorder } = codex\n\nclass CanvasRecorder {\n    public init() {\n        if (!game.canvas || !canvasRecorder) return\n\n        canvasRecorder.setCanvas(game.canvas)\n\n        // canvasRecorder.runTestCanvas()\n        // return\n\n        const options = canvasRecorder.getOptions()\n\n        const nextFrame = () => {\n            game.pause()\n            game.step()\n        }\n\n        const originWaitNextFrame = canvasRecorder.waitNextFrame\n        canvasRecorder.waitNextFrame = (force = false) => {\n            return new Promise((resolve, reject) => {\n                if (!force && !canvasRecorder.isCapturing()) {\n                    game.resume()\n                    return\n                }\n\n                if (options.syncFps) {\n                    director.once(Director.EVENT_AFTER_RENDER, resolve)\n                    nextFrame()\n                } else {\n                    originWaitNextFrame(force).then(resolve).catch(reject)\n                }\n            })\n        }\n    }\n}\n\nexport default CanvasRecorder\n","const { storage } = codex\n\nexport default class DailyRewards {\n    public init(): void {\n        this.initStorage$()\n    }\n\n    private initStorage$ = (): void => {\n        storage.addStorage('dashboardDailyRewards', {\n            hasShownPopup: false,\n        })\n    }\n}\n","import {\n    type AssetManager,\n    assetManager,\n    director,\n    game,\n    ImageAsset,\n    Rect,\n    type SimplifiedRequestItem,\n    Size,\n    Sprite,\n    SpriteFrame,\n    UITransform,\n} from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW } from 'cc/env'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Configs: {\n        GameEngine: {\n            DynamicAssets: { Resolution, IgnoreFiles, Compression },\n        },\n    },\n    Events,\n    Utils: { Array: A, Function: F, Device: D, Decorator },\n} = Ludex\n\nconst { event, storage, getBuildVersion } = codex\n\nconst IMAGE_EXTS = ['.png', '.jpg', '.jpeg', '.webp']\n\nconst ASSET = {\n    NONE: 0,\n    MEDIUM: 1,\n    QUALITY: 2,\n    ORIGINAL: 3,\n}\n\nclass DynamicAssets {\n    private isProcessing$ = false\n    private yield10msIfNeeded$ = F.timeSlice(10)\n\n    private targetScale$: number = 1\n    private sessionQuality$: number = ASSET.ORIGINAL\n\n    private failedAssets$: Set<string> = new Set()\n    private isAssetUpgraded$: Set<string> = new Set()\n    private upgradableAssets$: Map<string, SimplifiedRequestItem> = new Map()\n\n    public async init() {\n        if (EDITOR_NOT_IN_PREVIEW) return\n\n        this.targetScale$ = this.getOptimalScale$()\n        this.sessionQuality$ = this.getCurrentQuality$()\n\n        await this.initStorage$()\n        this.checkCacheVersion$()\n\n        const { transformPipeline } = assetManager\n        transformPipeline.insert(this.collectUpgradableAssets$, 2)\n\n        if (this.sessionQuality$ < ASSET.ORIGINAL) {\n            const scale = this.targetScale$ / Resolution.Source\n\n            this.injectSpriteUpdate$(scale)\n\n            this.injectSpriteFrameSlicedUV$(scale)\n            this.injectSpriteFrameCheckRect$(scale)\n            this.injectSpriteFrameResolution$(scale)\n        }\n\n        this.listenEvents$()\n    }\n\n    private initStorage$ = async () => {\n        await storage.addStorage(\n            'DynamicAssets',\n            {\n                currentQuality: 0,\n                buildVersion: '0',\n            },\n            true,\n        )\n    }\n\n    private getOptimalScale$ = (): number => {\n        const dpr = Math.round(D.pixelRatio())\n        const { Available, Source } = Resolution\n        const sortedScales = [...Available].sort((a, b) => a - b)\n\n        for (const scale of sortedScales) {\n            if (scale >= dpr) {\n                return Math.min(scale, Source)\n            }\n        }\n        return Source\n    }\n\n    private getCurrentQuality$ = (): number => {\n        if (this.targetScale$ === Resolution.Source && !Compression.Enabled) {\n            return ASSET.ORIGINAL\n        }\n\n        if (Compression.Enabled) {\n            return ASSET.MEDIUM\n        }\n\n        return ASSET.QUALITY\n    }\n\n    private checkCacheVersion$ = () => {\n        const buildVersion = getBuildVersion().toString()\n        const cacheConfig = storage.getStorage('DynamicAssets')\n        const { currentQuality: cacheCurrentQuality = 0, buildVersion: cacheBuildVersion } = cacheConfig ?? {}\n\n        const isLowQuality = this.sessionQuality$ < cacheCurrentQuality\n        const isSameBuildVersion = buildVersion === cacheBuildVersion\n\n        if (isLowQuality && isSameBuildVersion) {\n            this.sessionQuality$ = cacheCurrentQuality\n        }\n\n        storage.setStorageData('DynamicAssets', 'buildVersion', buildVersion)\n        storage.updateToWebStorage('DynamicAssets')\n    }\n\n    private listenEvents$ = (): void => {\n        if (!Compression.Enabled || this.sessionQuality$ === ASSET.ORIGINAL) return\n\n        event.catchUp(Events.GAME_READY, () => {\n            game.emit(GameEvents.REQUEST_UPGRADE_ASSET)\n        })\n\n        game.on(GameEvents.REQUEST_UPGRADE_ASSET, this.handleChangeQuality)\n    }\n\n    private injectSpriteUpdate$ = (scale: number) => {\n        Object.defineProperty(Sprite.prototype, 'spriteFrame', {\n            get: function () {\n                return this._spriteFrame\n            },\n            set: function (value) {\n                if (!value || !value.refreshed || this._spriteFrame === value) return\n\n                const lastSprite = this._spriteFrame\n                this._spriteFrame = value\n                this.markForUpdateRenderData(true)\n                this._applySpriteFrame(lastSprite)\n\n                const requiresAutoSize = this.sizeMode !== Sprite.SizeMode.CUSTOM\n                if (!requiresAutoSize) return\n\n                const uiTransform = this.node.getComponent(UITransform)\n                if (!uiTransform) return\n\n                // * A Sprite can change its size when its spriteFrame changes\n                const { width, height } = value.originalSize\n\n                // ? Restore resolution when replace new spriteFrame\n                const previousSize = new Size(width / scale, height / scale)\n                uiTransform.setContentSize(previousSize)\n            },\n        })\n    }\n\n    private injectSpriteFrameCheckRect$ = (_scale: number) => {\n        const originalCheckRect = SpriteFrame.prototype.checkRect\n\n        SpriteFrame.prototype.checkRect = function (...args) {\n            if (this.refreshed) return true\n\n            return originalCheckRect.apply(this, args)\n        }\n    }\n\n    private injectSpriteFrameSlicedUV$ = (scale: number) => {\n        // @ts-expect-error - This is a private method\n        const originalCalculateSlicedUV = SpriteFrame.prototype._calculateSlicedUV\n\n        // @ts-expect-error - This is a private method\n        SpriteFrame.prototype._calculateSlicedUV = function () {\n            const capInsets: number[] = this._capInsets ?? [0, 0, 0, 0]\n\n            const newCapInsets = capInsets.map((cap) => (cap + 1) * scale)\n\n            this._capInsets = newCapInsets\n\n            originalCalculateSlicedUV.apply(this)\n\n            this._capInsets = capInsets\n        }\n    }\n\n    private injectSpriteFrameResolution$ = (scale: number) => {\n        // @ts-expect-error - This is a private method\n        const originalRefreshTexture = SpriteFrame.prototype._refreshTexture\n\n        // @ts-expect-error - This is a private method\n        SpriteFrame.prototype._refreshTexture = function (...args) {\n            if (!this.name || this.refreshed) {\n                originalRefreshTexture.apply(this, args)\n                return\n            }\n\n            const { x, y, width, height } = this.rect\n\n            const xF = Number((x * scale).toFixed(2))\n            const yF = Number((y * scale).toFixed(2))\n            const widthF = Math.round(width * scale)\n            const heightF = Math.round(height * scale)\n\n            const newRect = new Rect(xF, yF, widthF, heightF)\n            const newOriginalSize = new Size(newRect.width, newRect.height)\n\n            this.refreshed = true\n\n            this.reset({\n                rect: newRect,\n                originalSize: newOriginalSize,\n            })\n\n            return originalRefreshTexture.apply(this, args)\n        }\n    }\n\n    @Decorator.debounce(1000)\n    private handleChangeQuality = async (): Promise<void> => {\n        if (this.isProcessing$ || !Compression.Enabled || this.sessionQuality$ >= ASSET.QUALITY) return\n\n        try {\n            this.isProcessing$ = true\n            const promiseRequest: Promise<boolean>[] = []\n            const initialUpgradedCount = this.isAssetUpgraded$.size\n\n            for (const item of this.upgradableAssets$.values()) {\n                const promise = this.processUpgradeQualityAsync$(item)\n                promiseRequest.push(promise)\n            }\n\n            if (promiseRequest.length < 1) {\n                return\n            }\n\n            await F.allSettled(promiseRequest)\n\n            if (this.isAssetUpgraded$.size > initialUpgradedCount) {\n                this.sessionQuality$++\n                this.saveStateToStorage$()\n            }\n\n            await this.updateSpriteFrames$()\n\n            this.requestUpdateDynamicAssets$()\n        } catch (error) {\n            console.warn('DynamicAssets: Handle change quality error', error)\n        } finally {\n            this.isProcessing$ = false\n        }\n    }\n\n    private getAssetQuality$ = (uuid: string): string => {\n        const path = `/native@${this.targetScale$}x/`\n        switch (this.sessionQuality$) {\n            case ASSET.QUALITY:\n                return `${path}quality/`\n            case ASSET.MEDIUM:\n                if (A.has(IgnoreFiles, uuid)) {\n                    return `${path}quality/`\n                }\n\n                return `${path}medium/`\n            default:\n                return '/native/'\n        }\n    }\n\n    private replaceAssetUrl$ = (uuid: string, url: string): string => {\n        if (this.sessionQuality$ === ASSET.ORIGINAL || !url.includes('/native/')) {\n            return url\n        }\n\n        if (EDITOR_NOT_IN_PREVIEW) {\n            return `${url}?v=${this.targetScale$}&q=${this.sessionQuality$}`\n        }\n\n        return url.replace('/native/', this.getAssetQuality$(uuid))\n    }\n\n    private saveStateToStorage$ = () => {\n        // ? Save for next launch game, use cache from current launch\n        storage.setStorageData('DynamicAssets', 'currentQuality', this.sessionQuality$)\n\n        storage.updateToWebStorage('DynamicAssets', true)\n    }\n\n    private updateSpriteFrames$ = async () => {\n        const scene = director.getScene()\n        if (!scene) return\n\n        const sprites = scene.getComponentsInChildren<Sprite>('cc.Sprite')\n\n        for (const sprite of sprites) {\n            const { spriteFrame } = sprite\n            if (!spriteFrame) continue\n\n            const { texture, original } = spriteFrame\n            let uuid = texture.uuid\n            if (original) {\n                uuid = original._texture.uuid\n            }\n\n            if (!this.isAssetUpgraded$.has(uuid)) continue\n\n            // @ts-expect-error - This is a private method\n            texture.updateImage()\n\n            await this.yield10msIfNeeded$()\n        }\n    }\n\n    private requestUpdateDynamicAssets$ = (): void => {\n        game.emit(GameEvents.REQUEST_DYNAMIC_ATLAS, { force: true })\n    }\n\n    private collectUpgradableAssets$ = (task: AssetManager.Task): void => {\n        // biome-ignore lint/suspicious/noAssignInExpressions: special\n        const input: Array<AssetManager.RequestItem> = (task.output = task.input)\n\n        let hasUpgradableAsset = false\n        for (const item of input) {\n            if (!A.has(IMAGE_EXTS, item.ext)) continue\n\n            const originalUrl = item.url\n            const upgradedUrl = this.replaceAssetUrl$(item.uuid, originalUrl)\n            if (upgradedUrl === originalUrl) continue\n\n            item.url = upgradedUrl\n\n            if (!this.upgradableAssets$.has(item.uuid)) {\n                const cacheItem: SimplifiedRequestItem = {\n                    ext: item.ext,\n                    url: item.url,\n                    uuid: item.uuid,\n                    options: item.options,\n                    resolution: this.targetScale$,\n                }\n                this.upgradableAssets$.set(item.uuid, cacheItem)\n                hasUpgradableAsset = true\n            }\n        }\n\n        if (hasUpgradableAsset) {\n            game.emit(GameEvents.REQUEST_UPGRADE_ASSET)\n        }\n    }\n\n    private processUpgradeQualityAsync$ = async (item: SimplifiedRequestItem): Promise<boolean> => {\n        const { uuid, url, ext, options, resolution } = item\n\n        if (!uuid || !url || !ext || !options || !resolution) return false\n\n        if (this.isAssetUpgraded$.has(uuid)) return true\n        if (this.failedAssets$.has(uuid)) return false\n\n        if (A.has(IgnoreFiles, uuid)) {\n            this.isAssetUpgraded$.add(uuid)\n            return true\n        }\n\n        const asset = assetManager.assets.get(uuid)\n\n        if (!(asset instanceof ImageAsset)) {\n            console.warn('DynamicAssets: Asset not found for upgrade', uuid)\n            // this.isAssetUpgraded$.add(uuid)\n            return false\n        }\n\n        const path = `/native@${resolution}x/`\n        const mediumPath = `${path}medium/`\n        const qualityPath = `${path}quality/`\n\n        const originalUrlConcept = url.replace(mediumPath, qualityPath)\n\n        if (originalUrlConcept === url) {\n            this.isAssetUpgraded$.add(uuid)\n            return true\n        }\n\n        const loadItem = { uuid, url: originalUrlConcept, options, resolution, ext }\n\n        return new Promise((resolve) => {\n            assetManager.loadAny(loadItem, options, (err, data: HTMLImageElement) => {\n                if (err) {\n                    console.warn(`[DynamicAssets] processUpgrade: Upgrade error for ${uuid.slice(0, 5)}`, err)\n                    this.failedAssets$.add(uuid)\n                    resolve(false)\n                    return\n                }\n\n                // O.assign(asset, { data: null })\n\n                asset.reset(data)\n                asset._nativeUrl = originalUrlConcept\n                this.isAssetUpgraded$.add(uuid)\n                game.emit(GameEvents.ASSET_QUALITY_CHANGE, { asset, item: loadItem })\n\n                resolve(true)\n            })\n        })\n    }\n}\n\nexport default DynamicAssets\n","import type {\n    Atlas,\n    AtlasInfo,\n    DebugData,\n    DrawAtlas,\n    DrawData,\n    Node,\n    PackedFrame,\n    SpriteFrame,\n    TexPack,\n    TexSize,\n    Texture2D,\n    TextureInfo,\n    UIRenderer,\n} from 'cc'\nimport { Director, DynamicAtlasManager, director, game, Label, UIOpacity } from 'cc'\nimport potpack from 'potpack'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: {\n            DynamicAtlas: {\n                OptimizeAtlas: {\n                    AtlasDebug,\n                    AutoAtlasSize,\n                    UsePowerOfTwo,\n                    AllowNonePackable,\n                    OnlyOptimizeWhenRenderTooLong,\n                },\n            },\n        },\n    },\n    Utils: { Json: J, Image: I, Function: F, Object: O, Mark },\n} = Ludex\n\nconst { event } = codex\n\nconst CONFIG = {\n    // Timing and Performance Thresholds\n    TIMING: {\n        MAX_INTERVAL_MS: 10000,\n        THROTTLE_UPDATE_MS: 800,\n        INTERVAL_INCREASE_MS: 1000,\n        MEAN_LAG_THRESHOLD_MS: 8,\n        MAX_RECORDED_RENDER_TIMES: 100,\n        RENDER_TIME_CHECK_INTERVAL_MS: 5000,\n    },\n    // Atlas Sizing and Packing Rules\n    PACKING: {\n        PACK_PADDING: 5,\n        MIN_FILL_RATE: 0.6,\n        BLEEDING_SPACE: 1,\n        COLLECT_PADDING: 2,\n        BLEED_SENSITIVE_SIZE: 16,\n    },\n    // Debugging Visualization Options\n    DEBUG: {\n        ENABLED: AtlasDebug,\n        FONT: '22px Arial',\n        TEXT_HEIGHT: 22,\n        TEXT_PADDING: 4,\n        IMAGE_QUALITY: 0.6,\n    },\n} as const\n\nclass DynamicAtlas {\n    // --- State Management ---\n    private isEffective$: boolean = true\n    private forceUpdateDynamicAtlas$: boolean = false\n    private readonly mutex$ = F.mutex()\n\n    // --- Render Time Tracking ---\n    private renderTimes$: number[] = []\n    private lastRenderTime$: number = 0\n    private renderTimeInterval$: number = CONFIG.TIMING.RENDER_TIME_CHECK_INTERVAL_MS\n\n    private atlasInfo$: AtlasInfo | null = null\n    private lastAtlasInfo$: AtlasInfo | null = null\n\n    // --- Collected Texture Info ---\n    private atlasIds$: Record<string, number> = {}\n    private collectInfo$: Map<string, TextureInfo> = new Map()\n    private packedFrames$: Set<SpriteFrame> = new Set()\n\n    // --- Debugging ---\n    private readonly debugCanvases$: Record<number, HTMLCanvasElement> = {}\n\n    public init() {\n        this.listenEvents$()\n        this.overrideDynamicAtlasManager$()\n\n        if (CONFIG.DEBUG.ENABLED) {\n            // Mark.setService(performance)\n            this.createPendingDebugCanvas$()\n        }\n    }\n\n    private listenEvents$ = (): void => {\n        game.on(GameEvents.REQUEST_DYNAMIC_ATLAS, this.requestUpdateDynamicAtlas$)\n\n        event.on(Events.SCENE_LAUNCHED, this.onSceneLaunched$)\n\n        event.catchUp(Events.GAME_READY, this.setupRenderListeners$)\n    }\n\n    private onSceneLaunched$ = (): void => {\n        this.resetPendingInfo$()\n        this.resetAllAtlases$()\n    }\n\n    private resetAllAtlases$ = (): void => {\n        // Reset all tracked frames\n        this.packedFrames$.forEach((frame) => {\n            if (frame.isValid) {\n                frame._resetDynamicAtlasFrame()\n            }\n        })\n        this.packedFrames$.clear()\n\n        // Reset manager\n        DynamicAtlasManager.instance.reset()\n\n        // Reset local state\n        this.atlasInfo$ = null\n        this.lastAtlasInfo$ = null\n\n        // Clear debug canvases\n        for (const key in this.debugCanvases$) {\n            delete this.debugCanvases$[key]\n        }\n    }\n\n    private overrideDynamicAtlasManager$ = (): void => {\n        const { instance } = DynamicAtlasManager\n\n        instance.packToDynamicAtlas = this.collectSpriteFrame$\n        instance.deleteAtlasSpriteFrame = this.deleteSpriteFrame$\n    }\n\n    private createPendingDebugCanvas$ = (): void => {\n        const canvas = this.createDebugCanvas$()\n        const canvasId = DynamicAtlasManager.instance.maxAtlasCount + 1\n        this.debugCanvases$[canvasId] = canvas\n    }\n\n    private checkRenderTimeThreshold$ = (): void => {\n        const meanRenderTime = this.calculateMeanRenderTimeAndReset$()\n\n        if (meanRenderTime > CONFIG.TIMING.MEAN_LAG_THRESHOLD_MS) {\n            this.handleLaggyFrame$()\n        }\n\n        director.once(Director.EVENT_AFTER_RENDER, () => {\n            setTimeout(() => {\n                this.checkRenderTimeThreshold$()\n            }, this.renderTimeInterval$)\n        })\n    }\n\n    private handleLaggyFrame$ = (): void => {\n        if (!this.isEffective$) {\n            this.renderTimeInterval$ = Math.min(\n                this.renderTimeInterval$ + CONFIG.TIMING.INTERVAL_INCREASE_MS,\n                CONFIG.TIMING.MAX_INTERVAL_MS,\n            )\n        }\n\n        this.requestUpdateDynamicAtlas$({ force: true })\n    }\n\n    private resetPendingInfo$ = (): void => {\n        this.atlasIds$ = {}\n        this.collectInfo$.clear()\n    }\n\n    private setupRenderListeners$ = (): void => {\n        director.on(Director.EVENT_BEFORE_RENDER, this.updateBeforeRenderTime$)\n        director.on(Director.EVENT_AFTER_RENDER, this.updateAfterRenderTime$)\n\n        if (OnlyOptimizeWhenRenderTooLong) {\n            event.catchUp(Events.SCENE_LAUNCHED, () => {\n                director.once(Director.EVENT_AFTER_RENDER, this.checkRenderTimeThreshold$)\n            })\n        }\n    }\n\n    private updateBeforeRenderTime$ = (): void => {\n        this.lastRenderTime$ = performance.now()\n    }\n\n    private updateAfterRenderTime$ = (): void => {\n        if (this.renderTimes$.length >= CONFIG.TIMING.MAX_RECORDED_RENDER_TIMES) {\n            this.renderTimes$.shift()\n        }\n\n        const renderTime = performance.now() - this.lastRenderTime$\n        this.renderTimes$.push(renderTime)\n    }\n\n    private calculateMeanRenderTimeAndReset$ = (): number => {\n        if (this.renderTimes$.length === 0) return 0\n\n        const totalRenderTime = this.renderTimes$.reduce((sum, time) => sum + time, 0)\n        const meanRenderTime = totalRenderTime / this.renderTimes$.length\n\n        this.renderTimes$.length = 0 // Clear the array for the next measurement interval\n\n        return meanRenderTime\n    }\n\n    private collectSpriteFrame$ = (comp: UIRenderer): void => {\n        if (!O.hasOwn(comp, 'spriteFrame')) return\n\n        const spriteFrame = comp.spriteFrame as SpriteFrame\n        const isValid = this.isSpriteFrameValidForAtlas$(comp, spriteFrame)\n        if (!isValid) return\n\n        const texture = this.getTexture$(spriteFrame)\n        const texId = texture?.getId()\n        if (!texId) return\n\n        const texSize = this.getTextureSizeFromTexture$(texture)\n        this.addTextureToCollectInfo$(texId, texSize, comp)\n\n        !OnlyOptimizeWhenRenderTooLong && this.requestUpdateDynamicAtlas$()\n    }\n\n    private deleteSpriteFrame$ = (spriteFrame: SpriteFrame): void => {\n        const texture = this.getTexture$(spriteFrame)\n        if (!texture) return\n\n        const atlas = this.getAtlas$()\n        atlas?.deleteInnerTexture(texture)\n\n        this.packedFrames$.delete(spriteFrame)\n        spriteFrame._resetDynamicAtlasFrame()\n    }\n\n    private isSpriteFrameValidForAtlas$ = (comp: UIRenderer, spriteFrame: SpriteFrame): boolean => {\n        const { enabled, node } = comp\n\n        if (!enabled || !spriteFrame) return false\n\n        if (!node.active || !node.activeInHierarchy) return false\n\n        if (!spriteFrame.packable && !AllowNonePackable) return false\n\n        if (spriteFrame.original) {\n            const currentTexture = spriteFrame.texture\n            const originalTexture = spriteFrame.original._texture\n            const isSameTexture = currentTexture === originalTexture\n            const isSameTextureId = currentTexture?.getId() === originalTexture?.getId()\n            if (isSameTexture || isSameTextureId) return false\n        }\n\n        if (comp.color.a < 1) return false\n\n        let current: Node | null = node\n        while (current) {\n            const opacityComp = current.getComponent(UIOpacity)\n            if (opacityComp && opacityComp.opacity < 1) return false\n            current = current.parent\n        }\n\n        const texSize = this.getTextureSize$(spriteFrame)\n        return !this.isTextureTooLarge$(texSize)\n    }\n\n    private addTextureToCollectInfo$ = (texId: string, texSize: TexSize, comp: UIRenderer): void => {\n        let info = this.collectInfo$.get(texId)\n        const padding = CONFIG.PACKING.COLLECT_PADDING\n        const w = texSize.w + padding\n        const h = texSize.h + padding\n\n        if (w <= padding || h <= padding) return\n\n        if (!info) {\n            info = { id: texId, w, h, x: -1, y: -1, components: new Set() }\n            this.collectInfo$.set(texId, info)\n        } else {\n            info.w = w\n            info.h = h\n        }\n\n        if (!info.components.has(comp)) {\n            info.components.add(comp)\n        }\n    }\n\n    private getTexture$ = (spriteFrame: SpriteFrame): Texture2D | null => {\n        return (spriteFrame.original?._texture ?? spriteFrame.texture) as Texture2D\n    }\n\n    private getTextureSize$ = (spriteFrame: SpriteFrame): TexSize => {\n        const tex = this.getTexture$(spriteFrame)\n        return this.getTextureSizeFromTexture$(tex)\n    }\n\n    private getTextureSizeFromTexture$ = (tex: Texture2D | null): TexSize => {\n        if (tex?.image) {\n            return { w: tex.image.width, h: tex.image.height }\n        }\n        return { w: tex?.width ?? 0, h: tex?.height ?? 0 }\n    }\n\n    private isTextureTooLarge$ = (texSize: TexSize): boolean => {\n        const { maxFrameSize } = DynamicAtlasManager.instance\n        return texSize.w >= maxFrameSize || texSize.h >= maxFrameSize\n    }\n\n    private rebuildAtlasIfNecessary$ = (): boolean => {\n        if (!this.atlasInfo$) return false\n\n        if (this.lastAtlasInfo$ && !this.forceUpdateDynamicAtlas$) {\n            const isSame = this.isSameAtlas$(this.lastAtlasInfo$, this.atlasInfo$)\n            this.isEffective$ = !isSame\n\n            if (isSame) {\n                return false\n            }\n        }\n\n        let atlas = this.getAtlas$()\n        if (!atlas?._texture) {\n            return false\n        }\n\n        const { packedInfo } = this.atlasInfo$\n        const { width: currentWidth, height: currentHeight } = atlas._texture\n\n        const packedWidth = packedInfo.width + CONFIG.PACKING.PACK_PADDING\n        const packedHeight = packedInfo.height + CONFIG.PACKING.PACK_PADDING\n\n        if (Math.max(packedWidth, packedHeight) <= CONFIG.PACKING.PACK_PADDING) return false\n\n        const maxDimension = Math.max(packedWidth, packedHeight)\n        const newWidth = UsePowerOfTwo ? maxDimension : packedWidth\n        const newHeight = UsePowerOfTwo ? maxDimension : packedHeight\n\n        atlas = this.resetAtlas$(atlas)\n        if (!atlas) {\n            return false\n        }\n\n        const isSizeIncreased = newWidth > currentWidth || newHeight > currentHeight\n        if (AutoAtlasSize || isSizeIncreased) {\n            atlas._texture.initWithSize(newWidth, newHeight)\n            const debugCanvas = this.debugCanvases$[this.getAtlasIndex$()]\n            if (debugCanvas) {\n                debugCanvas.width = newWidth\n                debugCanvas.height = newHeight\n            }\n        } else {\n            const debugCanvas = this.debugCanvases$[this.getAtlasIndex$()]\n            if (debugCanvas) {\n                debugCanvas.getContext('2d')?.clearRect(0, 0, debugCanvas.width, debugCanvas.height)\n            }\n        }\n\n        this.lastAtlasInfo$ = J.clone(this.atlasInfo$)\n        return true\n    }\n\n    private createAtlas$ = (): Atlas | null => {\n        const atlas = DynamicAtlasManager.instance.newAtlas()\n\n        if (atlas && CONFIG.DEBUG.ENABLED) {\n            const canvas = this.createDebugCanvas$()\n            const atlasIndex = this.getAtlasIndex$()\n            this.debugCanvases$[atlasIndex] = canvas\n        }\n\n        return atlas\n    }\n\n    private createDebugCanvas$ = (): HTMLCanvasElement => {\n        const { textureSize } = DynamicAtlasManager.instance\n        const canvas = document.createElement('canvas')\n        canvas.width = textureSize\n        canvas.height = textureSize\n        return canvas\n    }\n\n    private resetAtlas$ = (atlas: Atlas): Atlas | null => {\n        const { instance } = DynamicAtlasManager\n        const atlasIndex = instance._atlases.indexOf(atlas)\n\n        this.packedFrames$.forEach((frame) => {\n            if (frame.isValid) {\n                frame._resetDynamicAtlasFrame()\n            }\n        })\n        this.packedFrames$.clear()\n\n        atlas.destroy()\n\n        if (atlasIndex > -1) {\n            instance._atlases.splice(atlasIndex, 1)\n            if (instance._atlasIndex >= atlasIndex) {\n                instance._atlasIndex--\n            }\n        }\n\n        const newAtlas = this.getAtlas$()\n        return newAtlas\n    }\n\n    private getAtlas$ = (index?: number): Atlas | null => {\n        const { _atlases = [], _atlasIndex } = DynamicAtlasManager.instance\n        return _atlases[index ?? _atlasIndex] ?? this.createAtlas$()\n    }\n\n    private getAtlasIndex$ = (): number => {\n        return DynamicAtlasManager.instance._atlasIndex\n    }\n\n    private getAtlasSize$ = (): TexSize => {\n        const atlas = this.getAtlas$()\n        const { textureSize } = DynamicAtlasManager.instance\n        if (!atlas?._texture) return { w: textureSize, h: textureSize }\n\n        return {\n            w: Math.max(atlas._texture.width, textureSize),\n            h: Math.max(atlas._texture.height, textureSize),\n        }\n    }\n\n    private requestUpdateDynamicAtlas$ = F.debounce((payload?: { force?: boolean }): void => {\n        this.forceUpdateDynamicAtlas$ ||= payload?.force ?? false\n        this.updateDynamicAtlas$()\n    }, CONFIG.TIMING.THROTTLE_UPDATE_MS)\n\n    private updateDynamicAtlas$ = async () => {\n        if (!director.getScene()) return\n\n        const lock = await this.mutex$.use('updateDynamicAtlas')\n\n        Mark.start('DynamicAtlas Process')\n\n        try {\n            director.pause()\n            this.atlasInfo$ = null\n            this.prepareDrawInfo$()\n\n            const rebuildResult = this.rebuildAtlasIfNecessary$()\n\n            if (!rebuildResult) return\n\n            const success = this.packCollectedTextures$()\n            if (!success) return\n\n            game.emit(GameEvents.FINISHED_DYNAMIC_ATLAS)\n\n            requestAnimationFrame(this.printAtlasTextures$)\n        } catch {\n            // Error handled silently\n        } finally {\n            this.forceUpdateDynamicAtlas$ = false\n            Mark.stop('DynamicAtlas Process')\n            director.resume()\n            lock.release()\n        }\n    }\n\n    private prepareDrawInfo$ = (): void => {\n        if (this.collectInfo$.size < 1) return\n\n        const texturesToPack: TexPack[] = []\n\n        this.collectInfo$.forEach((info) => {\n            if (info.components.size < 1) return\n            texturesToPack.push(info)\n        })\n\n        this.calculateOptimizedAtlas$(texturesToPack)\n    }\n\n    private calculateOptimizedAtlas$ = (textures: TexPack[]): void => {\n        if (textures.length === 0) return\n\n        const { w, h, fill } = potpack(textures)\n\n        if (fill < CONFIG.PACKING.MIN_FILL_RATE) return\n\n        const atlasSize = this.getAtlasSize$()\n        if (w > atlasSize.w || h > atlasSize.h) {\n            const excessTextures = this.excessTextures$(textures, atlasSize)\n            if (excessTextures.length < 1) return\n\n            const excessSet = new Set(excessTextures)\n            const remainingTextures = textures.filter((t) => !excessSet.has(t))\n            this.calculateOptimizedAtlas$(remainingTextures)\n            return\n        }\n\n        this.atlasInfo$ = {\n            atlasSize,\n            atlasIndex: this.getAtlasIndex$(),\n            packedInfo: {\n                width: Math.round(w),\n                height: Math.round(h),\n                fillRate: fill,\n            },\n        }\n    }\n\n    private excessTextures$ = (textures: TexPack[], atlasSize: TexSize): TexPack[] => {\n        const { w, h } = atlasSize\n        const { excessWidth, excessHeight } = this.calculateExcessDimensions$(w, h, atlasSize)\n        return this.tryRemoveExcessTextures$(textures, excessWidth, excessHeight)\n    }\n\n    private calculateExcessDimensions$ = (packedWidth: number, packedHeight: number, atlasSize: TexSize) => {\n        const excessWidth = Math.max(0, packedWidth - atlasSize.w)\n        const excessHeight = Math.max(0, packedHeight - atlasSize.h)\n\n        return { excessWidth, excessHeight }\n    }\n\n    private tryRemoveExcessTextures$ = (textures: TexPack[], excessWidth: number, excessHeight: number) => {\n        let removedWidth = 0\n        let removedHeight = 0\n\n        const removedTextures: TexPack[] = []\n        const atlasIndex = this.getAtlasIndex$()\n\n        for (const texture of textures) {\n            const isExcessWidth = excessWidth > 0 && removedWidth < excessWidth\n            const isExcessHeight = excessHeight > 0 && removedHeight < excessHeight\n\n            if (!isExcessWidth && !isExcessHeight) continue\n\n            removedWidth += texture.w\n            removedHeight += texture.h\n\n            this.atlasIds$[texture.id] = Math.min(this.atlasIds$[texture.id] ?? atlasIndex, atlasIndex)\n\n            // * Reset coordinates to prevent drawing\n            texture.x = -1\n            texture.y = -1\n\n            removedTextures.push(texture)\n        }\n\n        return removedTextures\n    }\n\n    private packCollectedTextures$ = () => {\n        if (!this.atlasInfo$) return false\n\n        const atlas = this.getAtlas$()\n        if (!atlas) return false\n\n        const componentsToPack: UIRenderer[] = []\n        const textureCount = new Map<string, number>()\n        const texturesInCollectInfo = new Set<string>()\n\n        this.collectInfo$.forEach((info) => {\n            texturesInCollectInfo.add(info.id)\n\n            for (const comp of info.components) {\n                componentsToPack.push(comp)\n                const spriteFrame = (comp as UIRenderer & { spriteFrame?: SpriteFrame })?.spriteFrame\n                if (!spriteFrame) continue\n\n                const texture = this.getTexture$(spriteFrame)\n                const texId = texture?.getId()\n                if (!texId) continue\n\n                textureCount.set(texId, (textureCount.get(texId) ?? 0) + 1)\n            }\n        })\n\n        for (const comp of componentsToPack) {\n            this.packComponentIntoAtlas$(atlas, comp)\n        }\n\n        return true\n    }\n\n    private packComponentIntoAtlas$ = (atlas: Atlas, comp: UIRenderer): void => {\n        if (!O.hasOwn(comp, 'spriteFrame')) return\n\n        const frame = comp.spriteFrame as SpriteFrame\n        if (!frame) return\n\n        this.tryInsertSpriteFrame$(atlas, frame, comp)\n    }\n\n    private tryInsertSpriteFrame$ = (atlas: Atlas, spriteFrame: SpriteFrame, comp: UIRenderer) => {\n        if (spriteFrame.original) {\n            spriteFrame._resetDynamicAtlasFrame()\n        }\n\n        const { textureBleeding } = DynamicAtlasManager.instance\n        const packedFrame = this.drawTexture$(atlas, spriteFrame, textureBleeding)\n        if (!packedFrame) return\n\n        spriteFrame._setDynamicAtlasFrame(packedFrame)\n        this.packedFrames$.add(spriteFrame)\n\n        comp.setTextureDirty()\n        comp.markForUpdateRenderData(true)\n\n        this.updateLabelUVs$(comp)\n    }\n\n    private updateLabelUVs$ = (comp: UIRenderer): void => {\n        if (!(comp instanceof Label)) return\n\n        const renderData = comp.renderData\n        if (!renderData) return\n\n        renderData.vertDirty = false\n\n        const assembler = Label.Assembler.getAssembler(comp)\n        assembler?.updateUVs?.(comp)\n    }\n\n    private printAtlasTextures$ = (): void => {\n        if (!CONFIG.DEBUG.ENABLED) return\n\n        const { maxAtlasCount } = DynamicAtlasManager.instance\n\n        for (const index in this.debugCanvases$) {\n            const canvas = this.debugCanvases$[index]\n            if (canvas && Number(index) <= maxAtlasCount) {\n                const base64 = canvas.toDataURL('image/jpeg', CONFIG.DEBUG.IMAGE_QUALITY)\n                I.logImage(base64, 0.5)\n            }\n        }\n    }\n\n    private drawTexture$ = (atlas: Atlas, spriteFrame: SpriteFrame, textureBleeding: boolean): PackedFrame | null => {\n        const texture = this.getTexture$(spriteFrame)\n        if (!texture) return null\n\n        const texId = texture.getId()\n        const info = this.collectInfo$.get(texId)\n        if (!info) return null\n\n        const x = info.x ?? -1\n        const y = info.y ?? -1\n\n        if (x === -1 || y === -1) return null\n\n        const { width, height } = atlas._texture\n        if (x + info.w > width || y + info.h > height) return null\n\n        const { image } = texture\n        if (!image) return null\n\n        const space = textureBleeding ? CONFIG.PACKING.BLEEDING_SPACE : 0\n        const drawX = x + space\n        const drawY = y + space\n\n        let texInfo = atlas._innerTextureInfos[texId]\n\n        if (!texInfo) {\n            this.drawToAtlas$({ atlas, texId, image, drawX, drawY, space })\n\n            if (CONFIG.DEBUG.ENABLED) {\n                const usageCount = info.components.size\n                this.drawDebugFrame$({ image, texId, drawX, drawY, usageCount, space })\n            }\n\n            atlas._count++\n            texInfo = { texture, x: drawX, y: drawY }\n            atlas._innerTextureInfos[texId] = texInfo\n        }\n\n        const sx = spriteFrame.rect.x + (texInfo.x ?? drawX)\n        const sy = spriteFrame.rect.y + (texInfo.y ?? drawY)\n\n        return { x: sx, y: sy, texture: atlas._texture }\n    }\n\n    private drawToAtlas$ = (payload: DrawAtlas): void => {\n        const { atlas, image, drawX: x, drawY: y, space } = payload\n\n        const { _texture: atlasTexture } = atlas\n\n        if (space > 0) {\n            // Smaller frames are more likely to be affected by linear filtering\n            if (\n                image.width <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE ||\n                image.height <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE\n            ) {\n                atlasTexture.drawTextureAt(image, x - space, y - space)\n                atlasTexture.drawTextureAt(image, x - space, y + space)\n                atlasTexture.drawTextureAt(image, x + space, y - space)\n                atlasTexture.drawTextureAt(image, x + space, y + space)\n            }\n        }\n\n        atlasTexture.drawTextureAt(image, x, y)\n    }\n\n    private drawDebugFrame$ = (data: DebugData) => {\n        const atlasIndex = this.getAtlasIndex$()\n        const debugCanvas = this.debugCanvases$[atlasIndex]\n        if (!debugCanvas) return\n\n        const { image, texId, drawX, drawY, usageCount, space } = data\n        const ctx = debugCanvas.getContext('2d', { willReadFrequently: true })\n        const imgData = image?.data\n\n        if (!ctx || !imgData || !this.isDrawableImage(imgData)) return\n\n        this.drawDebugImageWithBleed$({ ctx, image, drawX, drawY, space })\n        this.drawDebugOutlineAndOverlay$({ ctx, image, drawX, drawY, space, usageCount })\n        this.drawDebugText$({ ctx, image, drawX, drawY, space, texId })\n    }\n\n    private isDrawableImage(data: unknown): data is HTMLCanvasElement | HTMLImageElement {\n        return data instanceof HTMLCanvasElement || data instanceof HTMLImageElement\n    }\n\n    private drawDebugImageWithBleed$ = (data: DrawData & { ctx: CanvasRenderingContext2D }) => {\n        const { ctx, image, drawX: x, drawY: y, space } = data\n\n        const imgData = image.data as HTMLCanvasElement | HTMLImageElement\n\n        if (space > 0) {\n            if (\n                image.width <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE ||\n                image.height <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE\n            ) {\n                ctx.drawImage(imgData, x - space, y - space)\n                ctx.drawImage(imgData, x - space, y + space)\n                ctx.drawImage(imgData, x + space, y - space)\n                ctx.drawImage(imgData, x + space, y + space)\n            }\n        }\n\n        ctx.drawImage(imgData, x, y)\n    }\n\n    private drawDebugOutlineAndOverlay$ = (data: DrawData & { ctx: CanvasRenderingContext2D; usageCount: number }) => {\n        const { ctx, image, drawX: x, drawY: y, space, usageCount } = data\n\n        let outlineX = x\n        let outlineY = y\n        let outlineWidth = image.width\n        let outlineHeight = image.height\n\n        if (space > 0) {\n            outlineX -= space\n            outlineY -= space\n            outlineWidth += space * 2\n            outlineHeight += space * 2\n        }\n\n        const ratio = Math.min(usageCount / 15, 1)\n        const hue = 240 * (1 - ratio)\n        ctx.fillStyle = `hsla(${hue}, 100%, 50%, 0.2)`\n        ctx.fillRect(outlineX + 0.5, outlineY + 0.5, outlineWidth, outlineHeight)\n    }\n\n    private drawDebugText$ = (data: DrawData & { ctx: CanvasRenderingContext2D; texId: string }) => {\n        const { ctx, drawX: x, drawY: y, space, texId } = data\n\n        ctx.font = CONFIG.DEBUG.FONT\n        ctx.textAlign = 'left'\n        ctx.textBaseline = 'top'\n\n        const textMetrics = ctx.measureText(texId.replace('Tex.', ''))\n        const padding = CONFIG.DEBUG.TEXT_PADDING\n        const textX = x - space + 10\n        const textY = y - space + 10\n\n        ctx.fillStyle = 'rgba(0, 50, 0, 0.8)'\n        ctx.fillRect(\n            textX - padding,\n            textY - padding,\n            textMetrics.width + padding * 2,\n            CONFIG.DEBUG.TEXT_HEIGHT + padding * 2,\n        )\n\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.95)'\n        ctx.fillText(texId, textX, textY)\n    }\n\n    private isSameAtlas$ = (a: AtlasInfo, b: AtlasInfo): boolean => {\n        if (!a || !b || a.atlasIndex !== b.atlasIndex) return false\n\n        if (a.packedInfo.fillRate !== b.packedInfo.fillRate) return false\n        if (a.packedInfo.width !== b.packedInfo.width || a.packedInfo.height !== b.packedInfo.height) return false\n        return true\n    }\n}\n\nexport default DynamicAtlas\n","/**\n * @typedef {Object} PotpackBox\n * @property {number} w Box width.\n * @property {number} h Box height.\n * @property {number} [x] X coordinate in the resulting container.\n * @property {number} [y] Y coordinate in the resulting container.\n */\n\n/**\n * @typedef {Object} PotpackStats\n * @property {number} w Width of the resulting container.\n * @property {number} h Height of the resulting container.\n * @property {number} fill The space utilization value (0 to 1). Higher is better.\n */\n\n/**\n * Packs 2D rectangles into a near-square container.\n *\n * Mutates the {@link boxes} array: it's sorted (by height/width),\n * and box objects are augmented with `x`, `y` coordinates.\n *\n * @param {PotpackBox[]} boxes\n * @return {PotpackStats}\n */\nexport default function potpack(boxes) {\n\n    // calculate total box area and maximum box width\n    let area = 0;\n    let maxWidth = 0;\n\n    for (const box of boxes) {\n        area += box.w * box.h;\n        maxWidth = Math.max(maxWidth, box.w);\n    }\n\n    // sort the boxes for insertion by height, descending\n    boxes.sort((a, b) => b.h - a.h);\n\n    // aim for a squarish resulting container,\n    // slightly adjusted for sub-100% space utilization\n    const startWidth = Math.max(Math.ceil(Math.sqrt(area / 0.95)), maxWidth);\n\n    // start with a single empty space, unbounded at the bottom\n    const spaces = [{x: 0, y: 0, w: startWidth, h: Infinity}];\n\n    let width = 0;\n    let height = 0;\n\n    for (const box of boxes) {\n        // look through spaces backwards so that we check smaller spaces first\n        for (let i = spaces.length - 1; i >= 0; i--) {\n            const space = spaces[i];\n\n            // look for empty spaces that can accommodate the current box\n            if (box.w > space.w || box.h > space.h) continue;\n\n            // found the space; add the box to its top-left corner\n            // |-------|-------|\n            // |  box  |       |\n            // |_______|       |\n            // |         space |\n            // |_______________|\n            box.x = space.x;\n            box.y = space.y;\n\n            height = Math.max(height, box.y + box.h);\n            width = Math.max(width, box.x + box.w);\n\n            if (box.w === space.w && box.h === space.h) {\n                // space matches the box exactly; remove it\n                const last = spaces.pop();\n                if (last && i < spaces.length) spaces[i] = last;\n\n            } else if (box.h === space.h) {\n                // space matches the box height; update it accordingly\n                // |-------|---------------|\n                // |  box  | updated space |\n                // |_______|_______________|\n                space.x += box.w;\n                space.w -= box.w;\n\n            } else if (box.w === space.w) {\n                // space matches the box width; update it accordingly\n                // |---------------|\n                // |      box      |\n                // |_______________|\n                // | updated space |\n                // |_______________|\n                space.y += box.h;\n                space.h -= box.h;\n\n            } else {\n                // otherwise the box splits the space into two spaces\n                // |-------|-----------|\n                // |  box  | new space |\n                // |_______|___________|\n                // | updated space     |\n                // |___________________|\n                spaces.push({\n                    x: space.x + box.w,\n                    y: space.y,\n                    w: space.w - box.w,\n                    h: box.h\n                });\n                space.y += box.h;\n                space.h -= box.h;\n            }\n            break;\n        }\n    }\n\n    return {\n        w: width, // container width\n        h: height, // container height\n        fill: (area / (width * height)) || 0 // space utilization\n    };\n}\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype ResultChallengePayload = Ludex.Plugins.FrameCapture.Wideframe.ResultChallengePayload\n\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\ntype Status = 'win' | 'lose' | 'draw' | 'none'\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE_WITH_SCORE_BOX = `${WIDEFRAME_PATH}/result-challenge.png`\nconst WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX = `${WIDEFRAME_PATH}/update-challenge.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        depth: 0,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    playerPhoto: {\n        type: 'image',\n        depth: -2,\n        size: [160, 160],\n        position: [50, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    opponentPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [740, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    leftScore: {\n        type: 'text',\n        name: 'left-score',\n        depth: 3,\n        font: 'normal bold 44px',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [123, 372],\n    },\n    rightScore: {\n        type: 'text',\n        name: 'right-score',\n        depth: 3,\n        font: 'normal bold 44px',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [820, 372],\n    },\n    leftCrown: {\n        type: 'image',\n        name: 'crown',\n        depth: 3,\n        size: [92, 63],\n        position: [80, 80],\n        image: `${WIDEFRAME_PATH}/images/crown-icon.png`,\n    },\n    rightCrown: {\n        type: 'image',\n        name: 'crown',\n        depth: 3,\n        size: [92, 63],\n        position: [775, 80],\n        image: `${WIDEFRAME_PATH}/images/crown-icon.png`,\n    },\n} as const satisfies {\n    wideframe: Omit<RenderImage, 'image' | 'name'>\n    playerPhoto: Omit<RenderImage, 'image' | 'name'>\n    opponentPhoto: Omit<RenderImage, 'image' | 'name'>\n    leftScore: Omit<RenderText, 'text'>\n    rightScore: Omit<RenderText, 'text'>\n    leftCrown: RenderImage\n    rightCrown: RenderImage\n}\n\nconst StatusImage = {\n    win: {\n        name: 'win-image',\n        type: 'image',\n        depth: 2,\n        size: [277, 144],\n        position: [337.5, 174],\n        image: `${WIDEFRAME_PATH}/images/win.png`,\n    },\n    lose: {\n        name: 'lose-image',\n        type: 'image',\n        depth: 2,\n        size: [326, 145],\n        position: [313, 173.5],\n        image: `${WIDEFRAME_PATH}/images/lose.png`,\n    },\n    draw: {\n        name: 'draw-image',\n        type: 'image',\n        depth: 2,\n        size: [390, 144],\n        position: [281, 174],\n        image: `${WIDEFRAME_PATH}/images/draw.png`,\n    },\n} as const satisfies Record<Exclude<Status, 'none'>, RenderImage>\n\nconst renderResultChallenge = async (payload: ResultChallengePayload) => {\n    const initial = E.lift<RenderOptions>({})\n\n    const options = E.pipe(\n        addPlayerPhotos(payload),\n        addScores(payload),\n        addStatusImages(payload),\n        addWideframe(payload),\n    )(initial)\n\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'ResultChallenge',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { isPlayerFinished, isOpponentFinished } = payload\n        const hasFinishedPlayer = isPlayerFinished || isOpponentFinished\n        const name = hasFinishedPlayer ? 'result-challenge-with-score-box' : 'result-challenge-without-score-box'\n        const image = hasFinishedPlayer ? WIDEFRAME_IMAGE_WITH_SCORE_BOX : WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX\n\n        return {\n            ...data,\n            wideframe: {\n                ...DEFAULT_RENDER_OPTIONS.wideframe,\n                image,\n                name,\n            },\n        }\n    }\n\nconst addPlayerPhotos =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        playerPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.playerPhoto,\n            name: payload.playerId,\n            image: payload.playerPhoto,\n        },\n        opponentPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.opponentPhoto,\n            name: payload.opponentId,\n            image: payload.opponentPhoto,\n        },\n    })\n\nconst addScores =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { isPlayerFinished, isOpponentFinished } = payload\n        const { playerScore = 0, opponentScore = 0 } = payload\n\n        const hasFinishedPlayer = isPlayerFinished || isOpponentFinished\n\n        if (!hasFinishedPlayer) {\n            return data\n        }\n\n        const leftScoreText = isPlayerFinished ? `${playerScore}` : '???'\n        const rightScoreText = isOpponentFinished ? `${opponentScore}` : '???'\n\n        return {\n            ...data,\n            leftScore: {\n                ...DEFAULT_RENDER_OPTIONS.leftScore,\n                text: leftScoreText,\n            },\n            rightScore: {\n                ...DEFAULT_RENDER_OPTIONS.rightScore,\n                text: rightScoreText,\n            },\n        }\n    }\n\nconst addStatusImages =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const status = getStatus(payload)\n        if (status === 'none') return data\n\n        const statusImage = StatusImage[status]\n\n        if (status === 'draw') {\n            return {\n                ...data,\n                statusImage,\n            }\n        }\n\n        const crown = status === 'win' ? DEFAULT_RENDER_OPTIONS.leftCrown : DEFAULT_RENDER_OPTIONS.rightCrown\n\n        return {\n            ...data,\n            crown,\n            statusImage,\n        }\n    }\n\nconst getStatus = (payload: ResultChallengePayload): Status => {\n    const { playerScore = 0, opponentScore = 0, isPlayerFinished, isOpponentFinished } = payload\n\n    const isGameFinished = isPlayerFinished && isOpponentFinished\n    if (!isGameFinished) return 'none'\n\n    const isDraw = playerScore === opponentScore\n    if (isDraw) return 'draw'\n\n    const isPlayerWin = playerScore > opponentScore\n    if (isPlayerWin) return 'win'\n\n    return 'lose'\n}\n\nexport default renderResultChallenge\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype ShareLeaderboardPayload = Ludex.Plugins.FrameCapture.Wideframe.ShareLeaderboardPayload\n\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/share-leaderboard.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 1500\nconst WIDEFRAME_HEIGHT = 2000\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        name: 'share-leaderboard',\n        type: 'image',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    avatar: {\n        type: 'image',\n        depth: -2,\n        size: [510, 510],\n        position: [510, 278],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    leaderPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [100, 100],\n        fallbackImage: FALLBACK_IMAGE,\n        // override position[1] to correct position at runtime\n        position: [436, 0],\n    },\n    leaderName: {\n        type: 'text',\n        depth: 1,\n        font: '600 48px',\n        // override position[1] to correct position at runtime\n        position: [600, 0],\n    },\n    leaderScore: {\n        type: 'text',\n        depth: 1,\n        font: '600 48px',\n        // override position[1] to correct position at runtime\n        position: [100, 0],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    leaderPhoto: Omit<RenderImage, 'image' | 'name'>\n    leaderName: Omit<RenderText, 'text' | 'name'>\n    leaderScore: Omit<RenderText, 'text' | 'name'>\n}\n\nconst renderShareLeaderboard = async (payload: ShareLeaderboardPayload): Promise<string | null> => {\n    const initial = E.lift<RenderOptions>({})\n    const options = E.pipe(addPlayerAvatar(payload), addLeaderAvatars(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'ShareLeaderboard',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareLeaderboardPayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: payload.playerId,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addLeaderAvatars =\n    (payload: ShareLeaderboardPayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { leaders } = payload\n        const out = { ...data }\n\n        for (let index = 0; index < leaders.length; index++) {\n            const leader = leaders[index] as (typeof leaders)[number]\n            const { id, name, photo, score } = leader\n\n            const photoY = 1292 + 180 * index\n            const captionY = 1360 + 180 * index\n\n            out[`photo_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderPhoto,\n                position: [DEFAULT_RENDER_OPTIONS.leaderPhoto.position[0], photoY],\n                name: id,\n                image: photo,\n            }\n\n            out[`name_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderName,\n                position: [DEFAULT_RENDER_OPTIONS.leaderName.position[0], captionY],\n                name: id,\n                text: name,\n            }\n\n            out[`score_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderScore,\n                position: [DEFAULT_RENDER_OPTIONS.leaderScore.position[0], captionY],\n                name: id,\n                text: `${score}`,\n            }\n        }\n\n        return out\n    }\n\nexport default renderShareLeaderboard\n","import { LocaleFontPaths, LocaleFrameCaptureFontSize } from '../../../constants/Locales'\n\nconst {\n    Utils: { Error: E, Valid: V, Function: F },\n} = Ludex\n\nconst { frameCapture, language, monitorError } = codex\n\ntype ShareScorePayload = Ludex.Plugins.FrameCapture.Wideframe.ShareScorePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/share-score.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 1500\nconst WIDEFRAME_HEIGHT = 2000\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'share-score',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    avatar: {\n        type: 'image',\n        depth: -1,\n        size: [500, 500],\n        position: [500, 410],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    playerScore: {\n        type: 'text',\n        name: 'player-score',\n        depth: 1,\n        // ! to be extended with localized font\n        font: 'normal bold',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [750, 1120],\n    },\n    message: {\n        type: 'text',\n        name: 'message',\n        depth: 2,\n        color: '#8f5543',\n        textAlign: 'center',\n        position: [760, 1560],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    playerScore: Omit<RenderText, 'text'>\n    message: Omit<RenderText, 'text' | 'font'>\n}\n\nconst renderShareScore = async (payload: ShareScorePayload): Promise<string | null> => {\n    const initial = E.lift({})\n    const options = E.pipe(addPlayerAvatar(payload), addPlayerScore(payload), addMessage, addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    frameCapture.captureAsync({\n        name: 'ShareScore',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: `${payload.playerId}`,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addPlayerScore =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const fontStyle = DEFAULT_RENDER_OPTIONS.playerScore.font\n        const fontName = getLocalizedFontName()\n        const fontSize = getLocalizedFontSize()\n\n        return {\n            ...data,\n            playerScore: {\n                ...DEFAULT_RENDER_OPTIONS.playerScore,\n                text: `${payload.playerScore}`,\n                font: `${fontStyle} ${fontSize} ${fontName},`,\n            },\n        }\n    }\n\nconst addMessage = (data: RenderOptions): RenderOptions => {\n    const fontName = getLocalizedFontName()\n    const fontSize = getLocalizedFontSize()\n    const messageText = getLocalizedMessage()\n\n    const message = {\n        ...DEFAULT_RENDER_OPTIONS.message,\n        font: `normal ${fontSize} ${fontName},`,\n        text: messageText,\n    }\n\n    return { ...data, message }\n}\n\nconst getLocalizedFontName = () => {\n    const locale = language.getCurrentLocale()\n    const fontPath = LocaleFontPaths[locale]\n    const fileName = getFileName(fontPath)\n    return `${fileName}_LABEL`\n}\n\nconst getLocalizedFontSize = () => {\n    const locale = language.getCurrentLocale()\n    return LocaleFrameCaptureFontSize[locale] ?? '104px'\n}\n\nconst getFileName = (path: string) => {\n    const fragments = path.split('/')\n    const fullFileName = fragments[fragments.length - 1] ?? ''\n    const extension = fullFileName.lastIndexOf('.')\n\n    if (extension === -1) return fullFileName\n\n    const fileName = fullFileName.substring(0, extension)\n    return fileName\n}\n\nconst getLocalizedMessage = () => {\n    try {\n        return language.getText('share.canYouDoBetter')\n    } catch (error) {\n        monitorError?.sendException(F.toError(error), {\n            locale: language.getCurrentLocale(),\n            message: 'share.canYouDoBetter',\n        })\n\n        return 'share.canYouDoBetter'\n    }\n}\n\nexport default renderShareScore\n","import { LocaleFontPaths } from '../../../constants/Locales'\n\nconst {\n    Utils: { Error: E },\n} = Ludex\n\nconst { frameCapture, language } = codex\n\ntype Locale = Ludex.Plugins.Language.Locale\ntype ShareScorePayload = Ludex.Plugins.FrameCapture.Wideframe.ShareScorePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/invite-score.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'share-score-with-invite',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    avatar: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [85, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    playerScore: {\n        type: 'text',\n        name: 'player-score',\n        depth: 1,\n        // ! to be extended with localized font\n        font: 'normal bold',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [165, 384],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    playerScore: Omit<RenderText, 'text'>\n}\n\nexport const LocaleFrameCaptureFontSize = {\n    en: '44px',\n    ru: '40px',\n} as const satisfies Record<Locale, string>\n\nconst renderShareScoreWithInvite = async (payload: ShareScorePayload): Promise<string | null> => {\n    const initial = E.lift({})\n    const options = E.pipe(addPlayerAvatar(payload), addPlayerScore(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    frameCapture.captureAsync({\n        name: 'ShareScore',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: `${payload.playerId}`,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addPlayerScore =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const fontStyle = DEFAULT_RENDER_OPTIONS.playerScore.font\n        const fontName = getLocalizedFontName()\n        const fontSize = getLocalizedFontSize()\n\n        return {\n            ...data,\n            playerScore: {\n                ...DEFAULT_RENDER_OPTIONS.playerScore,\n                text: `${payload.playerScore}`,\n                font: `${fontStyle} ${fontSize} ${fontName},`,\n            },\n        }\n    }\n\nconst getLocalizedFontName = () => {\n    const locale = language.getCurrentLocale()\n    const fontPath = LocaleFontPaths[locale]\n    const fileName = getFileName(fontPath)\n    return `${fileName}_LABEL`\n}\n\nconst getLocalizedFontSize = () => {\n    const locale = language.getCurrentLocale()\n    return LocaleFrameCaptureFontSize[locale] ?? '44px'\n}\n\nconst getFileName = (path: string) => {\n    const fragments = path.split('/')\n    const fullFileName = fragments[fragments.length - 1] ?? ''\n    const extension = fullFileName.lastIndexOf('.')\n\n    if (extension === -1) return fullFileName\n\n    const fileName = fullFileName.substring(0, extension)\n    return fileName\n}\n\nexport default renderShareScoreWithInvite\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype UpdateChallengePayload = Ludex.Plugins.FrameCapture.Wideframe.UpdateChallengePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/update-challenge.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'update-challenge',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    playerPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [50, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    opponentPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [740, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    playerPhoto: Omit<RenderImage, 'image' | 'name'>\n    opponentPhoto: Omit<RenderImage, 'image' | 'name'>\n}\n\nconst renderUpdateChallenge = async (payload: UpdateChallengePayload): Promise<string | null> => {\n    const initial = E.lift<RenderOptions>({})\n    const options = E.pipe(addAvatars(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'UpdateChallenge',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addAvatars =\n    (payload: UpdateChallengePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        playerPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.playerPhoto,\n            image: payload.playerPhoto,\n            name: payload.playerId,\n        },\n        opponentPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.opponentPhoto,\n            image: payload.opponentPhoto,\n            name: payload.opponentId,\n        },\n    })\n\nexport default renderUpdateChallenge\n","import renderResultChallenge from './wideframes/renderResultChallenge'\nimport renderShareLeaderboard from './wideframes/renderShareLeaderboard'\nimport renderShareScore from './wideframes/renderShareScore'\nimport renderShareScoreWithInvite from './wideframes/renderShareScoreWithInvite'\nimport renderUpdateChallenge from './wideframes/renderUpdateChallenge'\n\nconst { frameCapture } = codex\n\nclass FrameCapture {\n    public async init() {\n        frameCapture.setRenderer('share-score', renderShareScore)\n        frameCapture.setRenderer('result-challenge', renderResultChallenge)\n        frameCapture.setRenderer('update-challenge', renderUpdateChallenge)\n        frameCapture.setRenderer('share-leaderboard', renderShareLeaderboard)\n        frameCapture.setRenderer('share-score-with-invite', renderShareScoreWithInvite)\n    }\n}\n\nexport default FrameCapture\n","import { AssetManager, game } from 'cc'\nimport { BUILD, PREVIEW } from 'cc/env'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: {\n            HybridFileCache: { Enabled, PreviewMode, BuildMode },\n        },\n    },\n    Utils: { Object: O, Function: F, Json: J, Decorator },\n} = Ludex\n\nconst { event, storage, getBuildVersion } = codex\n\nconst { downloader, pipeline, fetchPipeline } = AssetManager.instance\n\nconst CACHE_KEY_REGEX = /.*\\/([-a-z0-9@]+)\\.([^\\.]+)$/\n\nclass HybridFileCache {\n    private supportTypes$: string[] = []\n    private bundledFiles$: Record<string, BundledFile> = {}\n    private originHandler$: Record<string, Handler> = {}\n    private nativeAssetDictionary$: Record<string, boolean> = {}\n\n    public async init() {\n        if (!Enabled) return\n\n        await this.initStorage$()\n        await this.checkCacheVersion$()\n\n        this.initSupportedTypes$()\n        this.injectOptimalLoadPipeline$()\n        this.injectOptimalFetchPipeline$()\n        this.injectCacheExtensionPipeline$()\n\n        this.saveOriginDownloaders$()\n        this.registerCustomDownloader$()\n\n        this.setupBundledFiles$()\n\n        this.listenEvents$()\n\n        console.debug('Hybrid File Cache: Initialized', { supportTypes: this.supportTypes$ })\n    }\n\n    private initStorage$ = async () => {\n        return storage.addStorage(\n            'HybridFileCache',\n            {\n                commitId: 'unknown',\n                buildVersion: '0',\n                cachedFiles: {},\n                cachedBundles: {},\n                cachedExtensions: {},\n            },\n            true,\n        )\n    }\n\n    private checkCacheVersion$ = async () => {\n        let invalidateMode = BuildMode.InvalidateMode\n        if (PREVIEW) {\n            invalidateMode = PreviewMode.InvalidateMode\n        }\n\n        const commitId = window.CommitId\n        const buildVersion = getBuildVersion().toString()\n\n        const cacheCommitId = storage.getStorageData('HybridFileCache', 'commitId')\n        const cacheBuildVersion = storage.getStorageData('HybridFileCache', 'buildVersion')\n\n        storage.setStorageData('HybridFileCache', 'commitId', commitId)\n        storage.setStorageData('HybridFileCache', 'buildVersion', buildVersion)\n\n        const isCommitDifferent = cacheCommitId !== commitId\n        const isBuildVersionDifferent = cacheBuildVersion !== buildVersion\n\n        switch (invalidateMode) {\n            case 'version':\n                if (isBuildVersionDifferent) {\n                    await this.clearCache$()\n                }\n                break\n            case 'commitId':\n                if (isCommitDifferent) {\n                    await this.clearCache$()\n                }\n                break\n            default:\n                if (isBuildVersionDifferent || isCommitDifferent) {\n                    await this.clearCache$()\n                }\n                break\n        }\n\n        this.requestUpdateStorage()\n    }\n\n    private initSupportedTypes$ = () => {\n        if (PREVIEW) {\n            this.supportTypes$ = PreviewMode.SupportedExtensions\n        } else if (BUILD) {\n            this.supportTypes$ = BuildMode.SupportedExtensions\n        }\n    }\n\n    private setupBundledFiles$ = async () => {\n        try {\n            if (!BUILD || !BuildMode.Enabled) return\n\n            const downloadPromises = []\n\n            // ? Supported types has init at initSupportedTypes method\n            for (const type of this.supportTypes$) {\n                const bundleCache = this.getCachedBundles$(type)\n                if (bundleCache) continue\n\n                downloadPromises.push(this.downloadBundledFile$(type))\n            }\n\n            if (downloadPromises.length > 0) {\n                await F.allSettled(downloadPromises)\n            }\n\n            // ! Current not support load bundles\n            // await this.loadBundles()\n        } finally {\n            event.emit(Events.BUNDLE_READY)\n        }\n    }\n\n    private downloadBundledFile$ = async (type: string) => {\n        try {\n            const extension = type.replace('.', '')\n\n            let bundledFile = `./cache/bundle${extension.toUpperCase()}.${extension}`\n\n            if (type === 'bundle') {\n                bundledFile = './cache/bundleBUNDLE.json'\n            }\n\n            const res = await fetch(bundledFile, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            })\n\n            const data = await res.json()\n\n            this.setBundledCache$(type, data)\n\n            // console.log('Hybrid File Cache: Downloaded bundled file', { type, data: this.bundledFiles[type] })\n        } catch (error) {\n            console.error('Hybrid File Cache: Downloaded bundled file', { type, error })\n        }\n    }\n\n    /* private async loadBundles$ = () => {\n        try {\n            if (!A.has(this.supportTypes, 'bundle')) return\n\n            const bundles = ['internal', 'main', 'loadable']\n            const bundlePromises = []\n\n            for (const name of bundles) {\n                const promise = new Promise((resolve, reject) => {\n                    try {\n                        const bundleCache = this.getBundledCache('bundle', `config:${name}`)\n                        if (!bundleCache) return reject(new Error('Bundle cache not found'))\n\n                        console.log('Hybrid File Cache: Load bundle', { bundleCache })\n\n                        // ? Fix base path\n                        // @ts-expect-error - private property\n                        bundleCache.base = `assets/${name}/`\n\n                        let bundle = assetManager.getBundle(name)\n                        if (!bundle) {\n                            bundle = new AssetManager.Bundle()\n                        }\n\n                        bundle.init(bundleCache as any)\n\n                        assetManager.bundles.add(name, bundle)\n\n                        console.log('Hybrid File Cache: bundle added', { name, bundle })\n\n                        this.loadBundleAssets(name, bundle).then(resolve).catch(reject)\n                    } catch (error) {\n                        console.error('Hybrid File Cache: Load bundle assets', { name, error })\n                        reject(error)\n                    }\n                })\n\n                bundlePromises.push(promise)\n            }\n\n            await F.allSettled(bundlePromises)\n        } catch (error) {\n            console.error('Hybrid File Cache: loadBundleAssets', { error })\n        }\n    } */\n\n    /* private loadBundleAssets$ = (name: string, bundle: AssetManager.Bundle) => {\n        return new Promise((resolve, reject) => {\n            // TODO: research why loadAny not work\n            const opts = {\n                preset: 'bundle',\n                ext: 'bundle',\n                __isNative__: true,\n            }\n\n            assetManager.loadAny({ url: name }, opts, (err: Error | null, assets: any): void => {\n                if (err) {\n                    console.warn('Hybrid File Cache: Load bundle assets', { name, err })\n                    reject(err)\n                } else {\n                    console.log('Hybrid File Cache: Load bundle assets', { name, assets })\n                }\n\n                if (name === 'internal') return\n                resolve(assets)\n            })\n\n            if (name !== 'internal') return resolve([])\n\n            // @ts-expect-error - private property\n            const paths = Object.values(bundle.config.paths.map)\n\n            console.log('Hybrid File Cache: Load internal assets', { bundle, paths })\n\n            const uuids = paths.map((path) => {\n                // @ts-expect-error - private property\n                const path0 = path[0]\n                // console.log('Hybrid File Cache: Load internal assets', path0)\n                return path0.uuid\n            })\n\n            if (uuids.length < 1) return resolve([])\n\n            builtinResMgr._materialsToBeCompiled = []\n            assetManager.loadAny(uuids, {}, (err: Error | null, assets: any): void => {\n                if (err) {\n                    console.warn('Hybrid File Cache: Load internal assets', { err })\n                    reject(err)\n                } else {\n                    console.log('Hybrid File Cache: Load internal assets', { assets })\n                    for (const asset of assets) {\n                        builtinResMgr.addAsset(asset.name, asset)\n\n                        if (asset instanceof Material || Array.isArray(asset.passes)) {\n                            builtinResMgr._materialsToBeCompiled.push(asset)\n                        }\n                    }\n\n                    builtinResMgr.compileBuiltinMaterial()\n                }\n\n                resolve(assets)\n            })\n        })\n    } */\n\n    private injectOptimalFetchPipeline$ = () => {\n        if (!PreviewMode.Enabled && !BuildMode.Enabled) return\n\n        // ? Idx 2 is fetch pipeline\n        const fetchPipe = fetchPipeline.pipes[2]\n\n        // console.debug('Hybrid File Cache: inject optimal fetch pipeline', [...fetchPipeline.pipes])\n\n        if (!fetchPipe) return\n\n        const optimizedFetchPipe = (task: AssetManager.Task, done: Func) => {\n            try {\n                fetchPipe(task, done)\n            } catch (error) {\n                console.error('Hybrid File Cache: optimized fetch pipeline', { error })\n            }\n        }\n\n        fetchPipeline.remove(2)\n        fetchPipeline.insert(optimizedFetchPipe, 2)\n\n        // console.debug('Hybrid File Cache: injected optimal fetch pipeline', [...fetchPipeline.pipes])\n    }\n\n    private injectOptimalLoadPipeline$ = () => {\n        if (!PreviewMode.Enabled && !BuildMode.Enabled) return\n\n        // ? Idx 2 is load pipeline\n        const loadPipe = pipeline.pipes[2]\n\n        // console.debug('Hybrid File Cache: inject optimal load pipeline', [...pipeline.pipes])\n\n        if (!loadPipe) return\n\n        const optimizedLoadPipe = (task: AssetManager.Task, done: Func) => {\n            try {\n                loadPipe(task, done)\n            } catch (error) {\n                console.warn('Hybrid File Cache: optimized load pipeline', { error })\n                done(error)\n            }\n        }\n\n        pipeline.remove(2)\n        pipeline.insert(optimizedLoadPipe, 2)\n\n        // console.debug('Hybrid File Cache: injected optimal load pipeline', [...pipeline.pipes])\n    }\n\n    private injectCacheExtensionPipeline$ = () => {\n        if (!PreviewMode.Enabled) return\n        if (!PreviewMode.CacheUuidExtension) return\n\n        const cachedExtension: Record<string, boolean> = {}\n\n        const checkCacheExtension = (task: AssetManager.Task, done: Func) => {\n            task.output = task.input\n\n            for (let i = 0; i < task.input.length; i++) {\n                const item = task.input[i]\n                if (!item.id) continue\n\n                const cachedExt = this.getCacheExtension$(item.id)\n                if (!cachedExt) {\n                    cachedExtension[item.id] = false\n                    continue\n                }\n\n                item.url = item.url.replace(item.ext, cachedExt)\n                item.ext = cachedExt\n                cachedExtension[item.id] = true\n            }\n\n            done(null, null)\n        }\n\n        const saveAndOverrideIsNative = (originalPipeline: Func) => (task: AssetManager.Task, done: Func) => {\n            const input = [...task.input]\n\n            for (let i = 0; i < input.length; i++) {\n                const item = input[i]\n                if (!item.id) continue\n\n                const isCached = cachedExtension[item.id]\n\n                const isNativeRecorded = O.hasOwn(this.nativeAssetDictionary$, item.id)\n\n                if (!isNativeRecorded) {\n                    this.nativeAssetDictionary$[item.id] = item.isNative ?? false\n                }\n\n                if (isCached) {\n                    item.isNative = true\n                }\n            }\n\n            if (task.input.length > 0) {\n                // console.debug('Hybrid File Cache: process cache extension')\n            }\n\n            originalPipeline(task, done)\n        }\n\n        const restoreAndCacheExt = (task: AssetManager.Task, done: Func) => {\n            task.output = task.input\n\n            for (let i = 0; i < task.output.length; i++) {\n                const item = task.output[i]\n                if (!item.id) continue\n\n                const recordedInfo = this.nativeAssetDictionary$[item.id] ?? false\n                item.isNative = recordedInfo\n\n                const isCached = cachedExtension[item.id]\n\n                if (isCached) continue\n\n                this.setCacheExtension$(item.id, item.ext)\n            }\n\n            done(null, null)\n        }\n\n        pipeline.insert(checkCacheExtension, 1)\n        fetchPipeline.insert(checkCacheExtension, 1)\n\n        pipeline.insert(restoreAndCacheExt, 3)\n        fetchPipeline.insert(restoreAndCacheExt, 3)\n\n        const beforePipelines = [...pipeline.pipes]\n        const beforeFetchPipelines = [...fetchPipeline.pipes]\n\n        const pipeToWrap = beforePipelines[2]\n        if (pipeToWrap) {\n            pipeline.pipes[2] = saveAndOverrideIsNative(pipeToWrap)\n        }\n\n        const fetchPipeToWrap = beforeFetchPipelines[2]\n        if (fetchPipeToWrap) {\n            fetchPipeline.pipes[2] = saveAndOverrideIsNative(fetchPipeToWrap)\n        }\n\n        const afterPipelines = [...pipeline.pipes]\n        const afterFetchPipelines = [...fetchPipeline.pipes]\n\n        console.debug(\n            'Hybrid File Cache: inject cache extension pipelines',\n            beforePipelines,\n            beforeFetchPipelines,\n            afterPipelines,\n            afterFetchPipelines,\n        )\n    }\n\n    private saveOriginDownloaders$ = () => {\n        for (const type of this.supportTypes$) {\n            const handler = downloader.handlers[type]\n            if (!handler) continue\n\n            this.originHandler$[type] = handler\n        }\n\n        // console.debug('Hybrid File Cache: save origin downloaders', this.originDownloaders)\n    }\n\n    private registerCustomDownloader$ = () => {\n        for (const type of this.supportTypes$) {\n            if (type === 'bundle') continue\n            downloader.register(type, this.downloadFile$(type))\n        }\n\n        // console.debug('Hybrid File Cache: register custom downloaders', downloader.handlers)\n    }\n\n    private listenEvents$ = () => {\n        event.on(Events.SCENE_LOADED, this.requestUpdateStorage)\n\n        game.on(GameEvents.CLEAR_HYBRID_FILE_CACHE, this.clearCache$)\n    }\n\n    private getDownloadHandler$ = (type: string): Handler | null => {\n        return this.originHandler$[type] ?? null\n    }\n\n    private downloadFile$ = (type: string) => (url: string, options: Options, onComplete: Callback) => {\n        // console.log('Hybrid File Cache: Downloading file', { type, url, options, cache })\n        const cache = this.getCache$(type, url)\n\n        if (cache) {\n            // console.info('Hybrid File Cache: Cache hit', { url, options, cache })\n            return onComplete(null, cache)\n        }\n\n        const downloader = this.getDownloadHandler$(type)\n        if (!downloader) return onComplete(new Error('Downloader not found'), null)\n\n        downloader(url, options, (error: Error | null, data: unknown) => {\n            // console.info('Hybrid File Cache: Downloaded', { url, options, error, data })\n\n            !error && this.setCache$(type, url, data)\n            return onComplete(error, data)\n        })\n\n        // console.info('Hybrid File Cache: Downloading file', { type, url, options })\n    }\n\n    private getCacheKey$ = (type: string, url: string) => {\n        const match = url.match(CACHE_KEY_REGEX)\n        // console.info('Hybrid File Cache: Get cache key', { match, type, url })\n        if (!match) return null\n\n        const [_, uuid, extension] = match\n        // console.info('Hybrid File Cache: Get cache key', { uuid, extension, type })\n        if (!extension || type.indexOf(extension) < 0) return null\n\n        return `${uuid}:${type}`\n    }\n\n    private validateDataType$ = (data: unknown) => {\n        const isPreview = PREVIEW && PreviewMode.Enabled\n        const isDataJsonValid = Array.isArray(data) && O.hasOwn(data[0], '__type__')\n\n        if (isPreview && isDataJsonValid) {\n            const bundle = data[0].__type__\n            if (!PreviewMode.CachePrefab && bundle === 'cc.Prefab') {\n                return false\n            }\n\n            if (!PreviewMode.CacheScene && bundle === 'cc.SceneAsset') {\n                return false\n            }\n        }\n\n        return true\n    }\n\n    private setCache$ = (type: string, url: string, data: unknown) => {\n        const cacheKey = this.getCacheKey$(type, url)\n        if (!cacheKey) return\n\n        if (!this.validateDataType$(data)) return\n\n        const encodedData = J.clone(data)\n        // console.log('Hybrid File Cache: Encoded data', { type, url, data, encodedData })\n\n        storage.setStorageData('HybridFileCache', 'cachedFiles', { [cacheKey]: encodedData ?? {} })\n        this.requestUpdateStorage()\n    }\n\n    private getCache$ = (type: string, url: string) => {\n        const cacheKey = this.getCacheKey$(type, url)\n        // console.log('Hybrid File Cache: Get cache', { cacheKey, type, url })\n        if (!cacheKey) return null\n\n        const cachedFiles = this.getFileCaches$()\n\n        let cacheData = cachedFiles[cacheKey]\n        // console.info('Hybrid File Cache: Get cache data', { cachedFiles, cacheData })\n\n        if (!cacheData) {\n            cacheData = this.getBundledCache$(type, cacheKey)\n            // console.info('Hybrid File Cache: Get bundled cache', { cacheData })\n        }\n\n        if (!cacheData) {\n            // console.warn('Hybrid File Cache: Cache not found', { cacheKey, type, url })\n            return null\n        }\n\n        const decodedData = J.clone(cacheData)\n        // console.log('Hybrid File Cache: Decoded data', { type, url, decodedData })\n\n        return decodedData\n    }\n\n    private getFileCaches$ = () => {\n        return storage.getStorageData('HybridFileCache', 'cachedFiles') ?? {}\n    }\n\n    private getCachedBundles$ = (type: string) => {\n        const cachedBundles = storage.getStorageData('HybridFileCache', 'cachedBundles')\n        if (!cachedBundles) return null\n\n        const bundledFile = cachedBundles[type]\n        if (!bundledFile) return null\n\n        this.bundledFiles$[type] = bundledFile\n\n        return bundledFile\n    }\n\n    private getBundledCache$ = (type: string, cacheKey: string): AssetManager.Bundle | null => {\n        const bundledFile = this.bundledFiles$[type]\n        if (!bundledFile) return null\n\n        const key = cacheKey.replace(`:${type}`, '')\n\n        return bundledFile[key] ?? null\n    }\n\n    private setBundledCache$ = (type: string, data: BundledFile) => {\n        this.bundledFiles$[type] = data\n        storage.setStorageData('HybridFileCache', 'cachedBundles', { [type]: data })\n        this.requestUpdateStorage()\n    }\n\n    private getCacheExtension$ = (uuid: string) => {\n        const cacheExt = this.getCachedExtensions$()\n        return cacheExt[uuid]\n    }\n\n    private setCacheExtension$ = (uuid: string, ext: string) => {\n        storage.setStorageData('HybridFileCache', 'cachedExtensions', { [uuid]: ext })\n        this.requestUpdateStorage()\n    }\n\n    private getCachedExtensions$ = () => {\n        return storage.getStorageData('HybridFileCache', 'cachedExtensions') ?? {}\n    }\n\n    @Decorator.throttle(1000)\n    private requestUpdateStorage = () => {\n        // console.debug('Hybrid File Cache: request update storage')\n        storage.updateToWebStorage('HybridFileCache', false)\n    }\n\n    private clearCache$ = () => {\n        storage.initStorageData('HybridFileCache', 'cachedFiles', {})\n        storage.initStorageData('HybridFileCache', 'cachedBundles', {})\n\n        // ! Experimental: asset id will be not change often\n        // storage.initStorageData('HybridFileCache', 'cachedExtensions', {})\n\n        storage.updateToWebStorage('HybridFileCache', true)\n    }\n}\n\nexport default HybridFileCache\n","import { game } from 'cc'\nimport GameEvents from '../../constants/GameEvents'\nimport { AvailableLocales, LocaleFilePaths, type LocalesWithoutDefault } from '../../constants/Locales'\nimport DefaultLanguageData from '../../scenes/common/locales/en.json'\nimport ResourceUtils from '../../utils/ResourceUtils'\n\nconst {\n    Events,\n    Utils: { Array: A },\n} = Ludex\nconst { player, event, language, monitorError } = codex\n\ntype Locale = Ludex.Plugins.Language.Locale\ntype Locales = Ludex.Plugins.Language.Locales\n\nclass Languages {\n    public async init() {\n        try {\n            await this.initDefaultLanguage$()\n            this.listenEvent$()\n            await this.initPlayerLanguage$()\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n        }\n    }\n\n    private initDefaultLanguage$ = async () => {\n        language.add('en', DefaultLanguageData, true)\n        this.setLanguage$('en')\n    }\n\n    private initPlayerLanguage$ = async () => {\n        const playerLocale = language.getPlayerLanguage()\n\n        if (!playerLocale || !this.isSupportedLocale$(playerLocale)) {\n            console.warn(`Language ${playerLocale} not supported. Overriding with default language`)\n            this.setLanguage$('en', true)\n            return\n        }\n\n        await this.addLanguage$(playerLocale)\n\n        const saveToPlayerData = player.getPlayerDataByKey('isFirstLogin') ?? false\n        this.setLanguage$(playerLocale, saveToPlayerData)\n    }\n\n    private isSupportedLocale$ = (lang: string): lang is Locale => {\n        return A.has(AvailableLocales, lang)\n    }\n\n    private listenEvent$ = () => {\n        event.on(Events.REQUEST_LANGUAGE, this.handleLanguageRequested$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(Events.REQUEST_LANGUAGE, this.handleLanguageRequested$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(GameEvents.PRELOAD_LANGUAGE, this.handlePreloadLanguage$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(GameEvents.CHOOSE_LANGUAGE, this.handleChooseLanguage$)\n    }\n\n    private addLanguage$ = async (lang: Locale, setAsFallback = false) => {\n        const langData = await this.getLangData$(lang)\n        language.add(lang, langData, setAsFallback)\n    }\n\n    private setLanguage$ = (lang: Locale, saveToPlayerData = false) => {\n        language.choose(lang)\n\n        if (saveToPlayerData) {\n            player.setSetting('language', lang)\n        }\n    }\n\n    private readonly handlePreloadLanguage$ = async ({ locale, onLoad, onError }: PreloadLanguagePayload) => {\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Preload language ${locale} not found`)\n            onError?.(new Error(`Language ${locale} not found`))\n            return\n        }\n\n        try {\n            await this.addLanguage$(locale)\n            onLoad?.(locale)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n            onError?.(error)\n        }\n    }\n\n    private readonly handleChooseLanguage$ = ({ locale, saveToPlayerData = false }: ChooseLanguagePayload) => {\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Choose language ${locale} not found`)\n            return\n        }\n\n        try {\n            this.setLanguage$(locale, saveToPlayerData)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n        }\n    }\n\n    private getLangData$ = async <L extends Locale>(lang: L): Promise<Locales[L]> => {\n        if (lang === 'en') {\n            return DefaultLanguageData as Locales[L]\n        }\n\n        const data = await ResourceUtils.loadJsonAsync(LocaleFilePaths[lang as LocalesWithoutDefault])\n\n        if (data === null) {\n            throw new Error(`Language ${lang} not found`)\n        }\n\n        if (data.json === null) {\n            throw new Error(`Language ${lang} is empty`)\n        }\n\n        return data.json as Locales[L]\n    }\n\n    private readonly handleLanguageRequested$ = async (payload: RequestLanguagePayload) => {\n        const { locale, saveToPlayerData = false, onLoad, onError } = payload\n\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Request language ${locale} not found`)\n            onError?.(new Error(`Language ${locale} not found`))\n            return\n        }\n\n        try {\n            await this.addLanguage$(locale)\n            onLoad?.(locale)\n            this.setLanguage$(locale, saveToPlayerData)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n            onError?.(err)\n        }\n    }\n\n    private toError$ = (error: unknown, module: string) => {\n        if (error instanceof Error) {\n            return error\n        }\n\n        if (typeof error === 'string') {\n            return new Error(`LanguagePlugin: ${error}`)\n        }\n\n        return new Error(`LanguagePlugin: Unknown error in module: <${module}>`)\n    }\n}\n\nexport default Languages\n","import TournamentUtils from '../../utils/TournamentUtils'\n\nconst {\n    Configs: {\n        Mockup: {\n            Leaderboards: LeaderboardsMockupConfig,\n            GameSDK: { Player: PlayerMockupConfig },\n        },\n        Leaderboards: LeaderboardsConfig,\n    },\n    Utils: { Number: N },\n} = Ludex\n\nconst { leaderboard } = codex\n\n// * use CoreLeaderboard instead?\n\nclass Leaderboards {\n    public init() {\n        this.handleWhenGameSDKStarted$()\n    }\n\n    private handleWhenGameSDKStarted$ = () => {\n        if (!LeaderboardsMockupConfig.Enabled) {\n            this.setupLeaderboards$()\n        } else {\n            this.setupLeaderboardsMockup$()\n        }\n    }\n\n    private setupLeaderboards$ = async () => {\n        this.setupLeaderboardByConfigs$()\n    }\n\n    private setupLeaderboardByConfigs$ = () => {\n        const { LeaderboardList } = LeaderboardsConfig\n\n        for (const LeaderboardConfig of LeaderboardList) {\n            const { Id, Name } = LeaderboardConfig\n\n            leaderboard.addLeaderboard({\n                name: Name,\n                type: 'global',\n                autoSortRank: true,\n                leaderboardId: Id,\n            })\n        }\n    }\n\n    // ! Mock specific\n    private setupLeaderboardsMockup$ = async () => {\n        this.setupMockGlobalLeaderboards$()\n        this.setupMockFriendsLeaderboard$()\n        this.setupMockGlobalTournamentLeaderboard$()\n    }\n\n    private setupMockGlobalLeaderboards$ = async () => {\n        const { NumOfLeaders } = LeaderboardsMockupConfig\n        const { LeaderboardList } = LeaderboardsConfig\n\n        for (const LeaderboardConfig of LeaderboardList) {\n            const { Name: name, Id: _id } = LeaderboardConfig\n            if (!name) continue\n\n            const leaderboardId = await leaderboard.createLeaderboardAsync({\n                _id,\n                name,\n                numberOfLeaders: N.random(NumOfLeaders.Max - NumOfLeaders.Min) + NumOfLeaders.Min,\n            })\n\n            leaderboard.addLeaderboard({\n                name,\n                type: 'global',\n                autoSortRank: true,\n                leaderboardId,\n            })\n        }\n    }\n\n    private setupMockFriendsLeaderboard$ = async () => {\n        const name = 'Mock Friends Leaderboard'\n        const mockId = 'friends-leaderboard-id'\n\n        let numberOfLeaders = 0\n\n        // ? If mock connected players is enabled, we will use it to set number of leaders\n        const { ConnectedPlayers } = PlayerMockupConfig\n        if (ConnectedPlayers.Enabled) {\n            numberOfLeaders = N.random(ConnectedPlayers.NumOfPlayers - 1) + 1\n        }\n\n        // * Create a mock leaderboard data\n        const leaderboardId = await leaderboard.createLeaderboardAsync({\n            _id: mockId,\n            name,\n            numberOfLeaders,\n        })\n\n        leaderboard.addLeaderboard({\n            name,\n            type: 'friends',\n            autoSortRank: true,\n            leaderboardId,\n        })\n    }\n\n    private setupMockGlobalTournamentLeaderboard$ = async () => {\n        const tournaments = await TournamentUtils.requestTournamentDataAsync()\n\n        tournaments.forEach((tournament) => {\n            const { payload } = tournament\n            const { leaderboardId } = payload\n\n            if (!leaderboardId) return\n            if (leaderboard.isExistLeaderboardId(leaderboardId)) return\n\n            leaderboard.addLeaderboard({\n                type: 'tournament',\n                name: leaderboardId,\n                autoSortRank: true,\n                leaderboardId,\n            })\n        })\n    }\n}\n\nexport default Leaderboards\n","import { game as CCGame, Director, director } from 'cc'\n\nconst {\n    Utils: { Mark },\n    Events,\n    Configs: {\n        PerformanceMonitor: { FpsTracking },\n    },\n} = Ludex\n\nconst { event } = codex\n\nconst FPS_TRACE_DURATION = 60\nconst FPS_TRACE_INTERVAL = 10\n\nclass PerformanceMonitor {\n    private markName$ = 'FPS Tracking'\n\n    private minFps$!: number\n    private maxFps$!: number\n\n    private fpsTraceDuration$!: number\n\n    private fpsTraceInterval$!: number\n    private fpsTraceIntervalTimer$!: number\n\n    private traceStopped$!: boolean\n\n    public get mark(): typeof Mark | null {\n        if (!FpsTracking.Enabled) return null\n        return Mark\n    }\n\n    public init() {\n        const { TrackingDuration, TrackingInterval } = FpsTracking\n\n        if (!this.mark) return\n\n        this.fpsTraceDuration$ = TrackingDuration ?? FPS_TRACE_DURATION\n        this.fpsTraceInterval$ = TrackingInterval ?? FPS_TRACE_INTERVAL\n\n        this.fpsTraceIntervalTimer$ = this.fpsTraceInterval$\n\n        this.traceStopped$ = false\n\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        event.catchUp(Events.GAME_READY, this.handleStartTraceFps$)\n    }\n\n    private unListenEvents$ = () => {\n        director.off(Director.EVENT_AFTER_UPDATE, this.handleLateUpdate$)\n    }\n\n    private handleStartTraceFps$ = () => {\n        this.startTraceFps$()\n        director.on(Director.EVENT_AFTER_UPDATE, this.handleLateUpdate$)\n    }\n\n    private startTraceFps$ = (): void => {\n        if (!this.mark) return\n\n        this.mark.measure(this.markName$)\n\n        this.mark.start(this.markName$)\n\n        // console.info('Start trace FPS')\n    }\n\n    private handleLateUpdate$ = (): void => {\n        if (!this.mark) return\n\n        this.fpsTraceDuration$ -= CCGame.deltaTime\n\n        if (this.fpsTraceDuration$ <= 0 && !this.traceStopped$) {\n            this.traceStopped$ = true\n\n            this.unListenEvents$()\n\n            this.updateFPS$()\n\n            this.mark.stop(this.markName$)\n            return\n        }\n\n        this.fpsTraceIntervalTimer$ -= CCGame.deltaTime\n        if (this.fpsTraceIntervalTimer$ > 0) return\n\n        this.fpsTraceIntervalTimer$ = this.fpsTraceInterval$\n\n        this.updateFPS$()\n        this.mark.stop(this.markName$)\n\n        this.startTraceFps$()\n    }\n\n    private updateFPS$ = (): void => {\n        if (!this.mark) return\n\n        const fps = this.getFPS$()\n        const drawCalls = this.getDrawCalls$()\n        const deviceRender = this.getDeviceRender$()\n        const textureMemory = this.getTextureMemory$()\n\n        this.minFps$ = Math.min(this.minFps$ ?? fps, fps)\n        this.maxFps$ = Math.max(this.maxFps$ ?? 0, fps)\n\n        this.mark.putMetric(this.markName$, 'FPS Metric', fps)\n\n        this.mark.putAttr(this.markName$, 'Page Title', document.title)\n        this.mark.putAttr(this.markName$, 'Device Render', deviceRender)\n\n        this.mark.putAttr(this.markName$, 'Draw Calls', drawCalls.toString())\n        this.mark.putAttr(this.markName$, 'Texture Memory', textureMemory.toFixed(2))\n\n        this.mark.putAttr(this.markName$, 'Min FPS', this.minFps$.toString())\n        this.mark.putAttr(this.markName$, 'Max FPS', this.maxFps$.toString())\n\n        console.debug(\n            `FPS: ${fps} Min: ${this.minFps$} Max: ${\n                this.maxFps$\n            }, draw calls: ${drawCalls}, texture memory: ${textureMemory.toFixed(2)}MB`,\n        )\n    }\n\n    private getFPS$ = (): number => {\n        if (!director.root) return 0\n\n        const { fps } = director.root\n        return Math.floor(fps) || 0\n    }\n\n    private getDrawCalls$ = (): number => {\n        if (!director.root) return 0\n\n        const { numDrawCalls } = director.root.device\n        return numDrawCalls || 0\n    }\n\n    private getDeviceRender$ = (): string => {\n        if (!director.root) return 'Unknown'\n\n        const { renderer } = director.root.device\n        return renderer || 'Unknown'\n    }\n\n    private getTextureMemory$ = (): number => {\n        if (!director.root) return 0\n\n        const { memoryStatus } = director.root.device\n        return memoryStatus.textureSize / (1024 * 1024) || 0\n    }\n}\n\nexport default PerformanceMonitor\n","import { game } from 'cc'\nimport GameEvents from '../../constants/GameEvents'\n\ntype Data = Ludex.Plugins.RemoteConfig.Data\n\nconst { Events } = Ludex\nconst { event } = codex\n\nclass RemoteConfig {\n    public init() {\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        event.on(Events.REQUEST_HOT_RELOAD, this.handleHotReload$)\n        event.on(Events.REQUEST_UPDATE_CONFIG, this.handleUpdateConfig$)\n    }\n\n    private handleHotReload$ = () => {\n        game.restart()\n    }\n\n    private handleUpdateConfig$ = (data: Data) => {\n        if (data.type !== 'Gameplay') return\n\n        // ? Broadcast to all node that config is need to update\n        game.emit(GameEvents.GAMEPLAY_UPDATE_CONFIG, data.config)\n\n        const { id, type } = data\n\n        // ? Tell RemoteConfig plugin that config is updated\n        event.emit(Events.REMOTE_CONFIG_UPDATED, { id, type })\n    }\n}\n\nexport default RemoteConfig\n","import { DynamicAtlasManager } from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW } from 'cc/env'\nimport AdaptivePerformancePlugin from './plugins/AdaptivePerformance'\nimport CanvasRecorderPlugin from './plugins/CanvasRecorder'\nimport DailyRewardsPlugin from './plugins/DailyRewards'\nimport DynamicAssetsPlugin from './plugins/DynamicAssets'\nimport DynamicAtlasPlugin from './plugins/DynamicAtlas'\nimport FrameCapturePlugin from './plugins/FrameCapture'\nimport HybridFileCachePlugin from './plugins/HybridFileCache'\nimport LanguagesPlugin from './plugins/Languages'\nimport LeaderboardsPlugin from './plugins/Leaderboards'\nimport PerformanceMonitorPlugin from './plugins/PerformanceMonitor'\nimport RemoteConfigPlugin from './plugins/RemoteConfig'\n\nconst {\n    Configs: {\n        Languages,\n        Leaderboards,\n        RemoteConfig,\n        FrameCapture,\n        DailyRewards,\n        AdaptivePerformance,\n        Debugger: { CanvasRecorder, Profiler },\n        GameEngine: { HybridFileCache, DynamicAssets, DynamicAtlas },\n    },\n} = Ludex\n\nclass PluginsManager {\n    public init() {\n        // ? Special case, need to override engine pipelines\n        this.initHybridFileCache$()\n\n        console.debug('Plugins Manager: Initialized')\n    }\n\n    public initLanguages(): void {\n        if (!Languages.Enabled) return\n\n        const languages = new LanguagesPlugin()\n        languages.init()\n    }\n\n    public initLeaderboards(): void {\n        if (!Leaderboards.Enabled) return\n\n        const leaderboards = new LeaderboardsPlugin()\n        leaderboards.init()\n    }\n\n    public initRemoteConfig(): void {\n        if (!RemoteConfig.Enabled) return\n\n        const remoteConfig = new RemoteConfigPlugin()\n        remoteConfig.init()\n    }\n\n    public initDynamicAtlas(): void {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!DynamicAtlas.OptimizeAtlas.Enabled) return\n\n        const { instance } = DynamicAtlasManager\n        if (!instance.enabled) return\n\n        const dynamicAtlas = new DynamicAtlasPlugin()\n        dynamicAtlas.init()\n    }\n\n    public initDynamicAssets(): void {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!DynamicAssets.Enabled) return\n\n        const dynamicAssets = new DynamicAssetsPlugin()\n        dynamicAssets.init()\n    }\n\n    private initHybridFileCache$ = (): void => {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!HybridFileCache.Enabled) return\n\n        const hybridFileCache = new HybridFileCachePlugin()\n        hybridFileCache.init()\n    }\n\n    public initCanvasRecorder(): void {\n        if (!CanvasRecorder.Enabled) return\n\n        const canvasRecorder = new CanvasRecorderPlugin()\n        canvasRecorder.init()\n    }\n\n    public initPerformanceMonitor(): void {\n        if (!Profiler.Enabled) return\n\n        const performanceMonitor = new PerformanceMonitorPlugin()\n        performanceMonitor.init()\n    }\n\n    public initAdaptivePerformance(): void {\n        if (!AdaptivePerformance.Enabled) return\n\n        const adaptivePerformance = new AdaptivePerformancePlugin()\n        adaptivePerformance.init()\n    }\n\n    public initFrameCapture(): void {\n        if (!FrameCapture.Enabled) return\n\n        const frameCapture = new FrameCapturePlugin()\n        frameCapture.init()\n    }\n\n    public initDailyRewards(): void {\n        if (!DailyRewards.Enabled) return\n\n        const dailyRewards = new DailyRewardsPlugin()\n        dailyRewards.init()\n    }\n}\n\nexport default PluginsManager\n","import { type AssetManager, assetManager, Director, director, type Scene, type SceneAsset } from 'cc'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport SceneUtils from '../utils/SceneUtils'\nimport ScreenUtils from '../utils/ScreenUtils'\n\nconst { event, monitorError } = codex\nconst {\n    Events,\n    Configs: { PerformanceMonitor },\n    Utils: { Mark, Function: F },\n} = Ludex\n\ntype SceneEventPayload = {\n    sceneName: string\n    sceneData?: SceneData\n}\n\ntype SwitchSceneCallback = (payload: { sceneName: string; sceneData: SceneData | undefined }) => void\n\nconst sdk = GameSDK\n\nclass SceneManager {\n    private markName$: string = 'Load Scene'\n    private testScene$: Record<string, boolean> = {}\n    private isClearedMark$: boolean = false\n    private callbackSwitchScene$: SwitchSceneCallback | null = null\n\n    // ? Use mutex because Cocos doesn't like it when\n    // ? we call `loadScene` in parallel\n    private mutex$ = F.mutex()\n\n    public init() {\n        this.listenEvents$()\n\n        console.debug('Scene Manager: Initialized')\n    }\n\n    private listenEvents$ = (): void => {\n        event.catchUp(Events.MARK_IS_TEST_SCENE, this.setTestScene$)\n\n        event.on(Events.SWITCH_SCENE, this.switchScene$)\n        event.on(Events.PRELOAD_SCENE, this.preloadScene$)\n    }\n\n    private correctSceneName$ = (sceneName: string): string | null => {\n        // ? Some scene (name) not exits in build settings or not exist in project\n        // * This will stop scene switch and prevent error\n\n        const scene = director.getScene()\n\n        const testScene = this.getTestScene$()\n\n        // console.warn('Current scene', scene?.name, { scene, testScene })\n\n        if (testScene) {\n            if (testScene === scene?.name) return null\n            return testScene\n        }\n\n        // ? If current scene is null, we can't check scene name\n        // * Alway has scene in game running, so this will never happen\n        if (!scene?.isValid) return sceneName\n\n        if (sceneName === scene.name) return null\n\n        return sceneName\n    }\n\n    private switchScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName, sceneData } = payload\n\n        const name = this.correctSceneName$(sceneName)\n        console.debug('Switching', name, sceneData ?? {})\n\n        if (!name) return\n\n        if (!SceneUtils.isSceneLoaded(name)) {\n            ScreenUtils.showLoadingFullScreen(name)\n        }\n\n        this.startScene$({ ...payload, sceneName: name })\n    }\n\n    private startScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName, sceneData } = payload\n        const lock = await this.mutex$.use(sceneName)\n\n        try {\n            this.startMeasure$('start', payload)\n\n            const sceneAsset = await this.loadSceneAsync$(sceneName, this.onSceneProgress$)\n            const scene = await this.runSceneAsync$(sceneAsset)\n            this.setSceneData$(scene, sceneData ?? {})\n\n            SceneUtils.markIsSceneLoaded(sceneName)\n            event.emit(Events.SCENE_LOADED, { sceneName })\n\n            this.clearTestMark$()\n\n            this.stopMeasure$()\n            this.handleSceneLaunched$(sceneName, sceneData)\n        } catch (e) {\n            const error = F.toError(e)\n            console.warn('SceneManager.startScene', error)\n\n            this.stopMeasure$(false)\n        } finally {\n            lock.release()\n        }\n    }\n\n    private preloadScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName } = payload\n\n        const lock = await this.mutex$.use(sceneName)\n\n        try {\n            this.startMeasure$('preload', payload)\n\n            await this.loadSceneAsync$(sceneName, this.onSceneProgress$)\n\n            SceneUtils.markIsSceneLoaded(sceneName)\n            event.emit(Events.SCENE_LOADED, { sceneName, isPreload: true })\n\n            this.stopMeasure$()\n            lock.release()\n        } catch (e) {\n            const error = F.toError(e)\n            console.warn('SceneManager.preloadScene', error)\n\n            this.stopMeasure$(false)\n            lock.release()\n        }\n    }\n\n    private loadSceneAsync$ = (\n        sceneName: string,\n        onProgress: ((finished: number, total: number, item: AssetManager.RequestItem) => void) | null = null,\n    ): Promise<SceneAsset> => {\n        return new Promise<SceneAsset>((resolve, reject) => {\n            const bundle = assetManager.main\n            if (!bundle) {\n                reject(new Error('Main bundle not found'))\n                return\n            }\n\n            bundle.loadScene(sceneName, onProgress ?? null, (error, sceneAsset) => {\n                if (error) {\n                    reject(error)\n                    return\n                }\n\n                resolve(sceneAsset)\n            })\n        })\n    }\n\n    private runSceneAsync$ = (sceneAsset: SceneAsset): Promise<Scene> => {\n        return new Promise<Scene>((resolve, reject) => {\n            director.runScene(sceneAsset, undefined, (error, scene) => {\n                if (error) return reject(error)\n                if (!scene) throw new Error('Scene not found')\n                resolve(scene)\n            })\n        })\n    }\n\n    public get mark(): typeof Mark | null {\n        if (!PerformanceMonitor.LoadResources) return null\n        return Mark\n    }\n\n    private startMeasure$ = (action: 'start' | 'preload', payload: SceneEventPayload): void => {\n        if (!this.mark) return\n\n        const { sceneName } = payload\n\n        console.groupCollapsed(` ${sceneName}: ${action} progress`)\n\n        this.mark.measure(this.markName$)\n\n        this.mark.putAttr(this.markName$, 'Cancel', 'false')\n        this.mark.putAttr(this.markName$, 'Success', 'false')\n        this.mark.putMetric(this.markName$, sceneName)\n\n        this.mark.start(this.markName$)\n    }\n\n    private stopMeasure$ = (success: boolean = true): void => {\n        if (!this.mark) return\n\n        this.mark.rmAttr(this.markName$, 'File')\n        this.mark.putAttr(this.markName$, 'Success', success ? 'true' : 'false')\n\n        this.mark.stop(this.markName$)\n\n        console.groupEnd()\n    }\n\n    private onSceneProgress$ = (finished: number, total: number, item: AssetManager.RequestItem): void => {\n        /* event.emit(Events.SCENE_PROGRESS, {\n                item,\n                total,\n                finished,\n                sceneName,\n            }) */\n\n        // Ludex will start at 30%, next 70% will be your game\n        const progress = finished / total\n\n        if (this.mark) {\n            // ? Mark attr to this file for log last file load fail (if have)\n            this.mark.putAttr(this.markName$, 'Last File', `${item.id} (${item.ext})`)\n            // console.info(sceneName, `${(progress * 100).toFixed(2)}%`)\n        }\n\n        const percent = Math.floor(progress * 70 + 30)\n\n        sdk.setLoadingProgress(percent)\n    }\n\n    private clearTestMark$ = (): void => {\n        // ? Clear mark is test scene event when any scene loaded\n        if (!this.isClearedMark$) {\n            event.clear(Events.MARK_IS_TEST_SCENE)\n            this.isClearedMark$ = true\n        }\n    }\n\n    private handleSceneLaunched$ = (sceneName: string, sceneData?: SceneData): void => {\n        // ? Don't await closing loading screen\n        ScreenUtils.hideLoadingFullScreen(sceneName)\n\n        AnalyticsUtils.switchSceneTracking()\n\n        monitorError?.addMetadata({ currentScene: sceneName })\n\n        this.callbackSwitchScene$?.({ sceneName, sceneData })\n\n        event.emit(Events.SCENE_LAUNCHED, { sceneName })\n\n        director.once(Director.EVENT_AFTER_RENDER, () => {\n            event.emit(Events.SCENE_RENDERED, { sceneName })\n        })\n    }\n\n    private getTestScene$ = (): string | null => {\n        return Object.keys(this.testScene$)[0] ?? null\n    }\n\n    private setTestScene$ = (payload: SceneEventPayload): void => {\n        const { sceneName } = payload\n        console.warn('SceneManager.setTestScene', sceneName)\n        this.testScene$[sceneName] = true\n    }\n\n    public onSwitchScene = (callback: SwitchSceneCallback): void => {\n        this.callbackSwitchScene$ = callback\n    }\n\n    private setSceneData$ = (scene: Scene, sceneData: SceneData): void => {\n        if (!sceneData) return\n\n        // Create data if not exist\n        if (!('data' in scene)) {\n            scene.scene.attr({ data: {} })\n        }\n\n        if (!('data' in scene)) return\n\n        // Merge current data\n        const currentData = scene.data || {}\n        scene.scene.attr({ data: { ...currentData, ...sceneData } })\n\n        console.debug('SceneManager.setSceneData', { sceneName: scene.name, sceneData, currentData })\n    }\n}\n\nexport default SceneManager\n","import { director, instantiate, type Node, Prefab, type Scene } from 'cc'\nimport { ScreenNames } from '../constants/ScreenKeys'\nimport type { BaseScreen } from '../screens/BaseScreen'\nimport type { Screens } from '../screens/components/Screens'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport GeneralUtils from '../utils/GeneralUtils'\nimport ResourceUtils from '../utils/ResourceUtils'\n\nconst {\n    Events,\n    Utils: { Object: O, Valid: V, Time: T },\n} = Ludex\nconst { event, monitorError } = codex\n\ntype BaseScreenState = {\n    order: number\n    name: string\n}\n\ntype QueuedScreenState = BaseScreenState & {\n    state: 'queued'\n}\n\ntype LoadingScreenState = BaseScreenState & {\n    state: 'loading'\n}\n\ntype PrefabScreenState = BaseScreenState & {\n    state: 'prefab'\n    prefab: Prefab | Node\n    useCount: number\n}\n\ntype ReadyScreenState = BaseScreenState & {\n    state: 'ready'\n    prefab: Prefab | Node\n    useCount: number\n    screen: BaseScreen\n}\n\n/**\n * ? Type union is used as a simple state management pattern\n * ? where some properties are only accessible in certain states\n * ? to avoid the complexity of OOP state machine patterns (state transitions and value checks)\n */\ntype ScreenEntry = QueuedScreenState | LoadingScreenState | PrefabScreenState | ReadyScreenState\n\nfunction resetScreenEntry(entry: ScreenEntry): ScreenEntry {\n    if (entry.state === 'ready') {\n        entry.screen.node.removeFromParent()\n        entry.screen.node.destroy()\n        return {\n            state: 'prefab',\n            order: entry.order,\n            name: entry.name,\n            prefab: entry.prefab,\n            useCount: entry.useCount,\n        }\n    }\n\n    if (entry.state === 'prefab') {\n        return { ...entry }\n    }\n\n    return {\n        state: 'queued',\n        order: entry.order,\n        name: entry.name,\n    }\n}\n\nclass ScreenManager {\n    private screens$: Record<string, ScreenEntry> = {}\n    private onPrefabReadyCallbacks$: Record<string, Array<() => void>> = {}\n\n    public init(): void {\n        this.bindEventHandlers$()\n        console.debug('Screen Manager: Initialized')\n    }\n\n    private bindEventHandlers$ = (): void => {\n        event.on(Events.OPEN_SCREEN, this.handleOpenScreen$)\n        event.on(Events.CLOSE_SCREEN, this.handleCloseScreen$)\n        event.on(Events.PRELOAD_SCREEN, this.handlePreloadScreen$)\n        event.on(Events.PRELOAD_SCREENS, this.handlePreloadScreens$)\n        event.on(Events.SWITCH_SCENE, this.handleSwitchScene$)\n    }\n\n    private readonly handleOpenScreen$ = (payload: SwitchScreenPayload): void => {\n        this.openScreen(payload.screenName, payload.screenData)\n    }\n\n    private readonly handleCloseScreen$ = (payload: SwitchScreenPayload): void => {\n        this.closeScreen(payload.screenName, true)\n    }\n\n    private readonly handlePreloadScreen$ = (payload: PreloadScreenPayload): void => {\n        const { screenName } = payload\n        this.addScreenQueues$([screenName])\n        const entry = this.screens$[screenName]\n        if (entry?.state !== 'queued') return\n\n        this.loadScreen$(entry)\n    }\n\n    private readonly handlePreloadScreens$ = (): void => {\n        const scene = director.getScene()\n        if (!this.validateScene$(scene)) return\n\n        this.initScreens$(scene)\n        this.preloadScreens$()\n    }\n\n    private readonly handleSwitchScene$ = (): void => {\n        this.resetAllScreenParents$()\n        this.onPrefabReadyCallbacks$ = {}\n    }\n\n    private resetAllScreenParents$ = (): void => {\n        for (const name in this.screens$) {\n            const entry = this.screens$[name]\n            if (entry !== undefined) {\n                this.screens$[name] = resetScreenEntry(entry)\n            }\n        }\n    }\n\n    private validateScene$ = (scene: Scene | null): scene is Scene => {\n        if (!scene) {\n            console.warn('No scene found for preloading screens')\n            return false\n        }\n        return true\n    }\n\n    private initScreens$ = (scene: Scene): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.enabled) return\n\n        // Initialize screens from configuration\n        const configs = screenHolder.screens\n        for (const config of configs) {\n            const screenName = ScreenNames[config.key]\n            if (!screenName) continue\n\n            const entry = this.screens$[screenName]\n            if (entry) {\n                this.screens$[screenName] = { ...entry, order: config.depth }\n                continue\n            }\n\n            this.screens$[screenName] = {\n                state: 'queued',\n                order: config.depth,\n                name: screenName,\n            }\n        }\n\n        // ? Get all screens nodes from scene\n        // ! Don't use BaseScreen class to avoid circular dependency (systems <-> main)\n        const screens = scene.getComponentsInChildren<BaseScreen>('BaseScreen')\n\n        if (!V.isEmpty(screens)) {\n            const screenNames = screens.map((s) => s?.node.name).join(', ')\n            console.info(` Active Screens in ${scene.name}: ${screenNames}`)\n            this.addScreens$(screens)\n        }\n    }\n\n    private getScreenHolder$ = (): Screens | null => {\n        const scene = director.getScene()\n        return scene?.getComponentInChildren<Screens>('Screens') ?? null\n    }\n\n    private addScreens$ = (screens: BaseScreen[]): void => {\n        for (let index = 0; index < screens.length; index++) {\n            const screen = screens[index]\n            if (!screen) {\n                console.warn(`ScreenManager.addScreens: Invalid screen ${index}`)\n                continue\n            }\n\n            const screenName = screen.node.name\n            if (!this.isScreenNameValid$(screenName)) {\n                console.warn(`ScreenManager.addScreens: Invalid screen name ${screenName}`)\n                continue\n            }\n\n            const entry = this.screens$[screenName]\n            // If entry exists (from config), use its order (depth). Otherwise default to 0.\n            const order = entry?.order ?? 0\n\n            this.screens$[screenName] = {\n                state: 'ready',\n                order: order,\n                screen: screen,\n                prefab: screen.node,\n                name: screenName,\n                useCount: 0,\n            }\n        }\n\n        // Reorder immediately to ensure correct depth for existing screens\n        this.reorderScreens$()\n    }\n\n    private isScreenNameValid$ = (screenName: unknown): screenName is string => {\n        return V.isString(screenName) && O.vals(ScreenNames).includes(screenName)\n    }\n\n    private addScreenQueues$ = (screenNames: string[]): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) {\n            console.warn('ScreenManager.addScreenQueues: No valid screen holder found')\n            return\n        }\n\n        for (const screenName of screenNames) {\n            if (!this.isScreenNameValid$(screenName)) {\n                console.warn(`ScreenManager.addScreenQueues: Invalid screen name ${screenName}`)\n                continue\n            }\n\n            const entry = this.screens$[screenName]\n            if (entry !== undefined) {\n                continue\n            }\n\n            // If not in config, default depth to 0\n            this.screens$[screenName] = {\n                state: 'queued',\n                order: 0,\n                name: screenName,\n            }\n        }\n    }\n\n    private loadScreen$ = async (entry: QueuedScreenState): Promise<void> => {\n        try {\n            this.screens$[entry.name] = { ...entry, state: 'loading' }\n            const prefab = await ResourceUtils.loadPrefabAsync(`screens/${entry.name}`)\n\n            if (prefab === null) {\n                throw new Error(`ScreenManager.loadScreen: Failed to load prefab: ${entry.name}`)\n            }\n\n            this.screens$[entry.name] = { ...entry, state: 'prefab', prefab, useCount: 0 }\n            console.debug(`ScreenManager.loadScreen: ${entry.name} loaded successfully`)\n            this.emitPrefabReady$(entry.name)\n        } catch (error) {\n            console.warn(`ScreenManager.loadScreen: Failed to load ${entry.name}`, error)\n            this.screens$[entry.name] = {\n                state: 'queued',\n                order: entry.order,\n                name: entry.name,\n            }\n        }\n    }\n\n    private preloadScreens$ = (): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) return\n        if (!screenHolder?.autoPreload) return\n\n        // Load in order of depth (optional, but good for consistency)\n        const entries = Object.values(this.screens$).sort((a, b) => a.order - b.order)\n\n        for (const entry of entries) {\n            if (entry.state === 'queued') {\n                this.loadScreen$(entry)\n            }\n        }\n    }\n\n    private getScreen$ = async (entry: PrefabScreenState | ReadyScreenState): Promise<BaseScreen | null> => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) {\n            throw new Error('ScreenManager.getScreen: Invalid screen holder')\n        }\n\n        if (entry.state === 'ready') {\n            return entry.screen\n        }\n\n        if (!(entry.prefab instanceof Prefab)) {\n            throw new Error(`ScreenManager.getScreen: Invalid prefab ${entry.name}`)\n        }\n\n        const screenNode = instantiate(entry.prefab)\n        screenNode.name = entry.name\n\n        const screen = screenNode.getComponent<BaseScreen>('BaseScreen')\n        if (!screen) {\n            throw new Error(`ScreenManager.getScreen: Invalid screen ${entry.name}`)\n        }\n\n        screenHolder.node.addChild(screenNode)\n        screenNode.active = false\n\n        this.screens$[entry.name] = { ...entry, state: 'ready', screen }\n        this.reorderScreens$()\n\n        console.debug(`ScreenManager.getScreen: Retrieved ${entry.name}`, entry)\n\n        return screen\n    }\n\n    private reorderScreens$ = (): void => {\n        const readyEntries: ReadyScreenState[] = []\n\n        for (const name in this.screens$) {\n            const entry = this.screens$[name]\n            if (entry?.state === 'ready' && entry?.screen.isValid) {\n                readyEntries.push(entry)\n            }\n        }\n\n        // Sort by depth (order)\n        readyEntries.sort((a, b) => a.order - b.order)\n\n        // Apply sibling index based on sorted order\n        for (let i = 0; i < readyEntries.length; i++) {\n            const entry = readyEntries[i]\n            if (entry?.screen?.isValid) {\n                entry.screen.node.setSiblingIndex(i)\n            }\n        }\n    }\n\n    public openScreen = async (screenName: string, screenData?: ScreenData): Promise<void> => {\n        if (!this.isScreenNameValid$(screenName)) return\n\n        const entry = this.getOrTryAddScreen$(screenName)\n\n        if (entry === undefined) {\n            console.warn(`ScreenManager.openScreen: Screen ${screenName} not found`)\n            return\n        }\n\n        if (entry.state !== 'ready' && entry.state !== 'prefab') {\n            if (entry.state === 'queued') this.loadScreen$(entry)\n            return await this.queueScreen$(screenName, screenData)\n        }\n\n        try {\n            GeneralUtils.setBlockInput(true)\n\n            const screen = await this.getScreen$(entry)\n\n            if (!screen?.isValid) {\n                throw new Error(`ScreenManager.performScreenOpen: Invalid screen ${screenName}`)\n            }\n\n            this.incrementUseCount$(screenName)\n\n            await this.showScreen$(screen, screenName, screenData)\n        } catch (error) {\n            console.error(`ScreenManager.openScreen: Error opening ${screenName}`, error)\n        } finally {\n            GeneralUtils.setBlockInput(false)\n        }\n    }\n\n    private queueScreen$ = (screenName: string, screenData?: ScreenData): Promise<void> => {\n        console.debug(`ScreenManager.queueScreen: Queuing ${screenName}`)\n        const callbacks = this.onPrefabReadyCallbacks$[screenName] ?? []\n\n        return new Promise<void>((resolve) => {\n            const callback = async () => {\n                await this.openScreen(screenName, screenData)\n                resolve()\n            }\n\n            this.onPrefabReadyCallbacks$[screenName] = [...callbacks, callback]\n        })\n    }\n\n    private incrementUseCount$ = (screenName: string): void => {\n        const entry = this.screens$[screenName]\n        if (entry?.state === 'ready' || entry?.state === 'prefab') {\n            this.screens$[screenName] = { ...entry, useCount: entry.useCount + 1 }\n        }\n    }\n\n    private showScreen$ = async (screen: BaseScreen, screenName: string, screenData?: ScreenData): Promise<void> => {\n        const eventPayload: SwitchScreenPayload = { screenName, screenData }\n        event.emit(Events.OPENING_SCREEN, eventPayload)\n\n        await T.sleepAsync(0)\n        screen.node.active = true\n\n        screen.open(screenData)\n        this.updateAnalytics$(screenName)\n\n        // Reorder again just in case\n        this.reorderScreens$()\n    }\n\n    public closeScreen = async (screenName: string, updateCurrentPage: boolean = false): Promise<void> => {\n        if (!this.isScreenNameValid$(screenName)) return\n\n        const entry = this.screens$[screenName]\n\n        if (entry === undefined) {\n            console.debug(`ScreenManager.closeScreen: Screen ${screenName} not found`)\n            return\n        }\n\n        if (entry.state !== 'ready') {\n            console.debug(`ScreenManager.closeScreen: ${screenName} is not ready`)\n            delete this.onPrefabReadyCallbacks$[screenName]\n            return\n        }\n\n        try {\n            if (!entry.screen.isValid || !entry.screen.node.active) return\n\n            event.emit(Events.CLOSING_SCREEN, { screenName })\n            entry.screen.close()\n\n            if (updateCurrentPage) {\n                this.updateAnalytics$(screenName, false)\n            }\n        } catch (error) {\n            console.error(`ScreenManager.closeScreen: Error closing ${screenName}`, error)\n        }\n    }\n\n    private updateAnalytics$ = (screenName: string, isOpening: boolean = true): void => {\n        AnalyticsUtils.trackCurrentPage(screenName, isOpening)\n        if (isOpening) {\n            monitorError?.addMetadata({ currentScreen: screenName })\n        } else {\n            monitorError?.removeMetadata('currentScreen')\n        }\n    }\n\n    public closeAllScreens = (): void => {\n        const logCurrentPage = false\n        for (const screenName in this.screens$) {\n            this.closeScreen(screenName, logCurrentPage)\n        }\n    }\n\n    private getOrTryAddScreen$ = (screenName: string): ScreenEntry | undefined => {\n        const entry = this.screens$[screenName]\n\n        if (entry === undefined) {\n            console.debug(`ScreenManager.getOrTryAddScreen: Adding new screen (${screenName}) to queue`)\n            this.addScreenQueues$([screenName])\n            const newEntry = this.screens$[screenName]\n            return newEntry\n        }\n\n        return entry\n    }\n\n    private emitPrefabReady$ = (screenName: string): void => {\n        const callbacks = this.onPrefabReadyCallbacks$[screenName] ?? []\n\n        for (const callback of callbacks) {\n            callback()\n        }\n\n        delete this.onPrefabReadyCallbacks$[screenName]\n    }\n}\n\nexport default ScreenManager\n","/**\n * Ludos System is a bridge between Ludex and Cocos\n */\nimport { Director, director, Game, game } from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW, PREVIEW } from 'cc/env'\nimport SceneKeys from '../constants/SceneKeys'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport LayoutUtils from '../utils/LayoutUtils'\nimport SceneUtils from '../utils/SceneUtils'\nimport ScreenUtils from '../utils/ScreenUtils'\nimport AdsManager from './AdsManager'\nimport EngineManager from './EngineManager'\nimport LayoutManager from './LayoutManager'\nimport MatchManager from './MatchManager'\nimport PlayerManager from './PlayerManager'\nimport PluginsManager from './PluginsManager'\nimport SceneManager from './SceneManager'\nimport ScreenManager from './ScreenManager'\n\nconst {\n    Configs: {\n        Core,\n        Ads,\n        Match,\n        Player,\n        GameEngine: { HybridFileCache },\n    },\n    Events,\n    Plugins: { Analytics: { Events: AnalyticsEvents } = {} },\n    Utils: { Device: D, Time: T },\n} = Ludex\n\nconst { context, event, analytics, monitorError } = codex\n\nclass LudosSystem {\n    private sceneManager$!: SceneManager\n    private screenManager$!: ScreenManager\n    private engineManager$!: EngineManager\n    private layoutManager$!: LayoutManager\n    private pluginsManager$!: PluginsManager\n\n    private adsManager$: AdsManager | null = null\n    private matchManager$: MatchManager | null = null\n    private playerManager$: PlayerManager | null = null\n\n    constructor() {\n        console.groupCollapsed(' Ludos System')\n\n        this.logEngineReady$()\n        this.createManager$()\n        this.initManagers$()\n        this.listenEvents$()\n\n        console.groupEnd()\n\n        window.__sdkLoad.ensure(10)\n    }\n\n    private logEngineReady$ = () => {\n        event.catchUp(Events.ANALYTICS_READY, () => {\n            AnalyticsEvents && analytics.event(AnalyticsEvents.ENGINE_READY)\n        })\n    }\n\n    private createManager$ = () => {\n        this.sceneManager$ = new SceneManager()\n        this.screenManager$ = new ScreenManager()\n        this.engineManager$ = new EngineManager()\n        this.layoutManager$ = new LayoutManager()\n        this.pluginsManager$ = new PluginsManager()\n\n        if (Ads.Enabled) {\n            this.adsManager$ = new AdsManager()\n        }\n\n        if (Match.Enabled) {\n            this.matchManager$ = new MatchManager()\n        }\n\n        if (Player.Enabled) {\n            this.playerManager$ = new PlayerManager()\n        }\n    }\n\n    private initManagers$ = (): void => {\n        this.sceneManager$.init()\n        this.screenManager$.init()\n        this.engineManager$.init()\n        this.layoutManager$.init()\n        this.pluginsManager$.init()\n\n        this.adsManager$?.init()\n        this.matchManager$?.init()\n        this.playerManager$?.init()\n    }\n\n    private listenEvents$ = (): void => {\n        event.catchUp(Events.CORE_BOOTING, this.handleWhenCoreBoot$)\n        event.catchUp(Events.CORE_STARTING, this.handleWhenCoreStart$)\n        event.catchUp(Events.CORE_READY, this.handleWhenCoreReady$)\n\n        LayoutUtils.listenLayoutChanges()\n        this.sceneManager$.onSwitchScene(this.handleSwitchScene$)\n    }\n\n    private handleWhenCoreBoot$ = (): void => {\n        console.warn('Ludos System: Core boot', { inited: game.inited, game })\n        if (game.inited) {\n            this.handleCocosInit$()\n        } else {\n            game.once(Game.EVENT_GAME_INITED, this.handleCocosInit$)\n        }\n    }\n\n    private handleCocosInit$ = (): void => {\n        // ? Only request start core, but maybe game-sdk will auto start core after inited\n        event.emit(Events.REQUEST_CORE_START)\n    }\n\n    private handleWhenCoreStart$ = (): void => {\n        this.playerManager$?.setupDefaultGameData()\n        this.matchManager$?.setupDefaultMatchData()\n    }\n\n    private handleWhenCoreReady$ = (): void => {\n        if (!HybridFileCache.Enabled) {\n            event.emit(Events.BUNDLE_READY)\n        }\n\n        this.initPlugins$()\n        this.playerManager$?.syncPlatformPlayerData()\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.LOAD_START)\n\n        // ? Wait bundle ready, first scene will be loaded\n        event.catchUp(Events.BUNDLE_READY, this.processPreStartGame$)\n    }\n\n    private processPreStartGame$ = (): void => {\n        if (PREVIEW) {\n            // ? In preview mode, BootScene will be auto launched\n            director.once(Director.EVENT_AFTER_SCENE_LAUNCH, () => {\n                this.preloadScenes$()\n                this.processBootSceneLaunched$()\n            })\n            return\n        }\n\n        event.catchUp(Events.SCENE_LOADED, this.preloadScenes$)\n        event.catchUp(Events.SCENE_LAUNCHED, this.processBootSceneLaunched$)\n\n        this.runBootScene$()\n    }\n\n    private processBootSceneLaunched$ = async () => {\n        if (Core.StartSDKAfterLoadGame) {\n            // ? Wait main scene loaded\n            await event.waitTo(Events.SCENE_LOADED)\n        }\n\n        await GameSDK.extra.waitSDKInitiatedAsync()\n\n        console.debug('Game paused', game.isPaused())\n\n        // ? If game is paused, we need wait game resume\n        // * Some game will pause game in BootScene for preload assets\n        if (game.isPaused()) {\n            await this.waitGameResume$()\n        }\n\n        this.processStartGame$()\n    }\n\n    private waitGameResume$ = async (): Promise<void> => {\n        return new Promise((resolve) => {\n            game.once(Game.EVENT_RESUME, resolve)\n        })\n    }\n\n    private runBootScene$ = (): void => {\n        if (GameSDK.isGameSDK('Playable')) {\n            SceneUtils.switchScene(SceneKeys.PLAYABLE_SCENE)\n        } else {\n            SceneUtils.switchScene(SceneKeys.BOOT_SCENE)\n        }\n    }\n\n    private preloadScenes$ = (): void => {\n        if (GameSDK.isGameSDK('Playable')) return\n\n        // ? Facebook App on iOS: sessionContextType may be null in tournament context, if run before GameSDK started\n        const contextSessionType = context.getSessionContextType()\n\n        if (contextSessionType === 'solo') {\n            SceneUtils.preloadDashboardScene()\n        } else {\n            SceneUtils.preloadGameScene()\n        }\n    }\n\n    private processStartGame$ = async (): Promise<void> => {\n        // ? End group forCorecos\n        console.groupEnd()\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.LOAD_COMPLETE)\n\n        event.catchUp(Events.PLAYER_INFO_LOADED, this.startProcessContextData$)\n\n        // * Make transition from sdk to game smoother\n        await event.waitTo(Events.SCENE_RENDERED, 1000).catch(() => {\n            // ? Safe to continue\n        })\n\n        // ? Wait 100ms to make sure all game objects created\n        await T.sleepAsync(100)\n\n        await this.startGameAsync$()\n    }\n\n    private handleSwitchScene$ = (): void => {\n        ScreenUtils.preloadScreens()\n        console.groupEnd()\n    }\n\n    // ? Why call startGameAsync here?\n    // * We want to make sure that the game is ready to start, not show\n    private startGameAsync$ = async (retries = 0): Promise<void> => {\n        try {\n            await GameSDK.startGameAsync()\n        } catch (error) {\n            console.warn('GameSDK.startGameAsync', error)\n\n            if (retries <= 3) {\n                setTimeout(() => {\n                    this.startGameAsync$(retries + 1)\n                }, 1000)\n            } else {\n                monitorError?.sendException(error instanceof Error ? error : new Error(JSON.stringify(error)))\n            }\n        }\n    }\n\n    private startProcessContextData$ = async (): Promise<void> => {\n        // processContextData method will be auto switch to next scene\n        // * It will also automatically call the flows from the match plugin and context plugin\n        // ? This means that the match flow of the GameScene will need to be skipped when first entering your game\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.APP_READY)\n\n        try {\n            this.playerManager$?.requestConnectedPlayers()\n\n            await context.processContextData()\n        } catch (error) {\n            console.error('startProcessContextData', error)\n\n            if (error instanceof Error) {\n                monitorError?.sendException(error)\n            }\n        } finally {\n            event.emit(Events.GAME_READY)\n\n            this.trackDeviceInfo$('begin')\n\n            window.addEventListener('beforeunload', () => {\n                this.trackDeviceInfo$('end')\n            })\n        }\n    }\n\n    private initPlugins$ = (): void => {\n        this.pluginsManager$.initLanguages()\n        this.pluginsManager$.initFrameCapture()\n        this.pluginsManager$.initDailyRewards()\n        this.pluginsManager$.initLeaderboards()\n        // this.pluginsManager.initRemoteConfig()\n        this.pluginsManager$.initDynamicAtlas()\n        this.pluginsManager$.initDynamicAssets()\n        this.pluginsManager$.initCanvasRecorder()\n        this.pluginsManager$.initPerformanceMonitor()\n        this.pluginsManager$.initAdaptivePerformance()\n    }\n\n    private getDeviceInfo$ = (type: string) => {\n        try {\n            const isES5 = D.isES5()\n            const heapMemory = D.heapMemory()\n            const pixelRatio = D.pixelRatio()\n            const audioState = D.audioState()\n            const orientation = D.orientation()\n            const gpuRenderer = D.gpuRenderer()\n            const supportWebp = D.isSupportWebp()\n            const sdkPlatform = GameSDK.getPlatform()\n            const webglVersion = D.webglVersion()\n            const maxTextureSize = D.maxTextureSize()\n            const hardwareConcurrency = D.hardwareConcurrency()\n\n            return {\n                log_type: type,\n                is_es5: isES5,\n                pixel_ratio: pixelRatio,\n                sdk_platform: sdkPlatform,\n                screen_orientation: orientation,\n                audio_state: audioState,\n                heap_memory: heapMemory,\n                support_webp: supportWebp,\n                gpu_renderer: gpuRenderer,\n                webgl_version: webglVersion,\n                max_texture_size: maxTextureSize,\n                hardware_concurrency: hardwareConcurrency,\n            }\n        } catch (error) {\n            console.warn('Error getting device info', error)\n            return null\n        }\n    }\n\n    private trackDeviceInfo$ = (type: 'begin' | 'end'): void => {\n        const deviceInfo = this.getDeviceInfo$(type)\n        if (!deviceInfo) return\n\n        AnalyticsUtils.trackDeviceInfo(deviceInfo)\n    }\n}\n\nif (!EDITOR_NOT_IN_PREVIEW) {\n    new LudosSystem()\n}\n","import { cclegacy, gfx, type renderer } from 'cc'\n\nexport class WindowInfo {\n    constructor(id: number, width: number, height: number, framebuffer: gfx.Framebuffer) {\n        this.id = id\n        this.width = width\n        this.height = height\n        this.framebuffer = framebuffer\n    }\n    id = 0xffffffff\n    width = 0\n    height = 0\n    framebuffer: gfx.Framebuffer\n}\n\ncclegacy.user ||= {\n    windowID: 0,\n    windows: new WeakMap<any, WindowInfo>(),\n}\n\nexport function getWindowInfo(camera: renderer.scene.Camera): WindowInfo {\n    let info = cclegacy.user.windows.get(camera.window)\n    if (info !== undefined) {\n        return info\n    }\n    info = new WindowInfo(cclegacy.user.windowID, 0, 0, camera.window.framebuffer)\n    ++cclegacy.user.windowID\n    cclegacy.user.windows.set(camera.window, info)\n    return info\n}\n\nexport function needClearColor(camera: renderer.scene.Camera): boolean {\n    return (camera.clearFlag & gfx.ClearFlagBit.COLOR) !== 0\n}\n","import { _decorator, gfx, type renderer, rendering } from 'cc'\nimport { getWindowInfo, needClearColor, type WindowInfo } from './PipelineData'\n\nconst { ccclass } = _decorator\n\n/**\n * Optimized render pipeline for 2D games\n * Reduces draw calls and optimizes batching for better performance\n */\nclass Optimized2DPipeline implements rendering.PipelineBuilder {\n    /**\n     * Setup render passes for each camera\n     */\n    public setup(cameras: renderer.scene.Camera[], ppl: rendering.BasicPipeline): void {\n        for (let i = 0; i < cameras.length; i++) {\n            const camera = cameras[i]\n            if (!camera || camera.scene === null || camera.window === null) {\n                continue\n            }\n            const info = this.prepareCameraResources$(ppl, camera)\n            this.buildForward$(ppl, camera, info.id, info.width, info.height)\n        }\n    }\n\n    private prepareCameraResources$ = (ppl: rendering.BasicPipeline, camera: renderer.scene.Camera): WindowInfo => {\n        const info = getWindowInfo(camera)\n\n        if (info.width === 0 && info.height === 0) {\n            info.width = camera.window.width\n            info.height = camera.window.height\n            this.initCameraResources$(ppl, camera, info.id, info.width, info.height)\n        } else if (\n            info.framebuffer !== camera.window.framebuffer ||\n            info.width !== camera.window.width ||\n            info.height !== camera.window.height\n        ) {\n            info.framebuffer = camera.window.framebuffer\n            info.width = camera.window.width\n            info.height = camera.window.height\n            this.initCameraResources$(ppl, camera, info.id, info.width, info.height)\n        }\n\n        return info\n    }\n\n    private initCameraResources$ = (\n        ppl: rendering.BasicPipeline,\n        camera: renderer.scene.Camera,\n        id: number,\n        width: number,\n        height: number,\n    ): void => {\n        ppl.addRenderWindow(`Color${id}`, gfx.Format.RGBA8, width, height, camera.window)\n        if (this.usesMask$) {\n            ppl.addDepthStencil(`DepthStencil${id}`, gfx.Format.DEPTH_STENCIL, width, height)\n        }\n    }\n\n    private buildForward$ = (\n        ppl: rendering.BasicPipeline,\n        camera: renderer.scene.Camera,\n        id: number,\n        width: number,\n        height: number,\n    ): void => {\n        // Setup viewport v clear color\n        this.clearColor$.x = camera.clearColor.x\n        this.clearColor$.y = camera.clearColor.y\n        this.clearColor$.z = camera.clearColor.z\n        this.clearColor$.w = camera.clearColor.w\n\n        this.viewport$.left = camera.viewport.x * width\n        this.viewport$.top = camera.viewport.y * height\n        this.viewport$.width = camera.viewport.z * width\n        this.viewport$.height = camera.viewport.w * height\n\n        // Create render pass\n        const pass = ppl.addRenderPass(width, height, 'default')\n        pass.setViewport(this.viewport$)\n\n        // Bind color target\n        if (needClearColor(camera)) {\n            pass.addRenderTarget(`Color${id}`, gfx.LoadOp.CLEAR, gfx.StoreOp.STORE, this.clearColor$)\n        } else {\n            pass.addRenderTarget(`Color${id}`, gfx.LoadOp.LOAD)\n        }\n\n        // Bind depth stencil nu cn\n        if (this.usesMask$) {\n            if (camera.clearFlag & gfx.ClearFlagBit.DEPTH_STENCIL) {\n                pass.addDepthStencil(\n                    `DepthStencil${id}`,\n                    gfx.LoadOp.CLEAR,\n                    gfx.StoreOp.STORE,\n                    camera.clearDepth,\n                    camera.clearStencil,\n                    camera.clearFlag & gfx.ClearFlagBit.DEPTH_STENCIL,\n                )\n            } else {\n                pass.addDepthStencil(`DepthStencil${id}`, gfx.LoadOp.LOAD)\n            }\n        }\n\n        // Setup render queues\n        const lightInfo = new rendering.LightInfo()\n\n        // Opaque queue (for non-transparent 2D elements like tilemaps)\n        pass.addQueue(rendering.QueueHint.NONE).addSceneOfCamera(\n            camera,\n            lightInfo,\n            this.usesMask$ ? rendering.SceneFlags.OPAQUE | rendering.SceneFlags.MASK : rendering.SceneFlags.OPAQUE,\n        )\n\n        // Transparent queue (main queue for 2D sprites with alpha)\n        pass.addQueue(rendering.QueueHint.BLEND).addSceneOfCamera(\n            camera,\n            lightInfo,\n            rendering.SceneFlags.BLEND | rendering.SceneFlags.DRAW_INSTANCING,\n        )\n\n        // UI queue (for UI elements that should render on top)\n        pass.addQueue(rendering.QueueHint.BLEND).addSceneOfCamera(camera, lightInfo, rendering.SceneFlags.UI)\n    }\n\n    private readonly viewport$ = new gfx.Viewport()\n    private readonly clearColor$ = new gfx.Color(0, 0, 0, 1)\n    private usesMask$ = false // Set to false for better 2D performance (only enable if using stencil masks)\n}\n\n// Register pipeline\n/* if (rendering) {\n    rendering.setCustomPipeline('Optimized2DPipeline', new Optimized2DPipeline())\n    console.info('Registered Optimized2DPipeline')\n} */\n\n/* @ccclass('Optimized2DPipeline')\nexport class Optimized2DPipelineComponent extends Component {\n    start() {\n        // Component to attach to camera for pipeline settings\n    }\n\n    update(_deltaTime: number) {\n        // No per-frame updates needed\n    }\n} */\n"]}