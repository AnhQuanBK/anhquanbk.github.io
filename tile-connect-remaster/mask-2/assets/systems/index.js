System.register("chunks:///systems.js",["./env-5304ac8c.js","cc","./TournamentUtils-0964e80a.js"],(function(){var e,t,n,a,r,i,s,o,c,l,u,d,h,f,m,p,g,v,y,$,S,E,w,A,b,D,C,T,R,L,F,x,_,I,M,P,N,k,O,U,G,z,B,H,V,Y,j,q,Q,K,W,X,Z,J,ee,te,ne,ae,re,ie,se,oe;return{setters:[function(d){e=d._,t=d.f,n=d.h,a=d.c,r=d.d,i=d.g,s=d.o,o=d.q,c=d.i,l=d.B,u=d.r},function(e){d=e.cclegacy,h=e.game,f=e.settings,m=e.Settings,p=e.View,g=e.AssetManager,v=e.sys,y=e.director,$=e.input,S=e.Input,E=e.DynamicAtlasManager,w=e.macro,A=e.view,b=e.ResolutionPolicy,D=e.Size,C=e.screen,T=e.Director,R=e.Sprite,L=e.UITransform,F=e.SpriteFrame,x=e.Rect,_=e.assetManager,I=e.ImageAsset,M=e.UIOpacity,P=e.Label,N=e.Prefab,k=e.instantiate,O=e.Game,U=e._decorator},function(e){G=e.d,z=e.G,B=e.L,H=e.C,V=e.a,Y=e.M,j=e.j,q=e.P,Q=e.u,K=e.I,W=e.v,X=e.h,Z=e.g,J=e.R,ee=e.w,te=e.m,ne=e.S,ae=e.c,re=e.n,ie=e.p,se=e.k,oe=e.r}],execute:function(){var ce,le,ue,de={text:{"core.nameless":"Nameless","game.resume":"Resume","game.restart":"Restart","game.cancel":"Cancel","game.challenge":"Challenge\nFriends","game.next":"NEXT","game.completed":"COMPLETED","game.tryAgain":"Try again","game.retry":"RETRY","game.startOverQ":"Start Over?","game.startOverMsg":"Start over? You'll lose your current progress and begin from the start. Are you sure you want to restart?","game.startOver":"START OVER","game.paused":"Paused","game.end":"End","game.quit":"Quit","game.join":"Join","game.joinLeaderboard":"Join Leaderboard","game.continue":"Continue","game.letsPlay":"Let's Play","game.logIn":"Log in","game.create":"Create","game.quitLevelShortMsg":"Quit Level?","game.quitSingleMsg":"Quit now? You're so close to completing this level!","game.quitTourMsg":"Quit now? You're just a few levels away from ranking up!","game.level":"Level","game.levelX":"Level %{0}","game.hardLevel":"Hard Level","game.result":"Your Result","game.nextLevel":"Next Level","game.win":"You Win","game.lose":"You Lose","game.draw":"Draw","game.replay":"Replay","game.boom":"Boom!","game.timesUp":"Time's Up!","game.bombDesc":"The bomb exploded!","game.timesUpDesc":"Restart or add 2 minutes?","game.daily":"Daily","game.weekly":"Weekly","game.endsSoon":"Ends Soon","game.endsIn":"Ends %{0}","game.player":"1 player","game.nPlayers":"%{0} players","game.pTour":"%{0}'s Tournament","game.combo":"Combo","game.tourLbUpdated":"Duel!","settings.level":"Level","settings.settings":"Settings","settings.music":"Music","settings.sound":"Sound","settings.vibrate":"Vibrate","settings.on":"ON","settings.off":"OFF","settings.notification":"Notification","settings.report":"Report","settings.share":"Share","settings.invite":"Invite Friends","settings.feedback":"Feedback","settings.createShortcut":"Create\nShortcut","settings.or":"OR","settings.customMode":"Custom\nMode","custom.customLevel":"Custom Level","custom.time":"Time","custom.difficulty":"Difficulty","custom.easy":"Easy","custom.normal":"Normal","custom.hard":"Hard","custom.extreme":"Extreme","custom.bombs":"Bombs","custom.ads":"Extra ads duration","custom.score":"Score increase:","custom.play":"Play","ads.cancelled":"Sorry, No Rewards!\nYou have cancelled the ad!","ads.loading":"Loading ads...","ads.notReady":"No ads to display!","ads.adAfterT":"AD starting in %{0}...","ads.levelAfterT":"Next level in %{0}...","ads.rewardNotice":"Watch a short ad to receive\nthese rewards:","ads.skip":"Skip","ads.daily":"Daily Rewards","ads.claim":"Claim","ads.claimX2":"Claim x2","ads.claimNow":"Claim Now!","ads.await":"Looking for rewards...","ads.open":"Open","ads.coins":"Get Coins","ads.getNow":"Get Now","ads.freeMinutes":"Get %{0} FREE minutes","ads.interNotice.hangTight":"Short ad break, hang tight!","ads.interNotice.backInSec":"Back to the game in just a sec!","ads.interNotice.quickAd":"Quick ad, then more fun!","status.loading":"Loading","status.congrats":"Congratulations","status.allLevels":"You have passed all levels.","status.later":"Please come back later,\nwe will update soon!","status.confirm":"CONFIRMATION","status.confirmReset":"ARE YOU SURE TO START OVER?","status.resetInfo":"You will play the game again\nfrom the beginning, at level 1.","status.no":"NO","status.yes":"YES","status.first":"1st","status.second":"2nd","status.third":"3rd","status.nth":"%{0}th","status.tap":"Tap to continue","status.waitingX":"Waiting%{0}","status.lbNotAvail":"Leaderboard is empty.","status.tourNotAvail":"No tournaments available.","pages.shop":"Shop","pages.collections":"Collections","pages.home":"Home","pages.leaderboard":"Leaderboard","pages.tournament":"Tournament","guide.step1":"Tap to connect","guide.step2":"Connect similar tiles with less than 2 turns","guide.step3":"Connect similar tiles with less than 2 turns","guide.step4":"More than 2 turns are NOT allowed","guide.step5":"There's obstacle between the tiles","guide.timer":"Remove all tiles before\nthe time end","guide.combo":"Remove tiles continuously\nto increase combo!","guide.hint":"Tap to reveal a connectable pair","guide.thunder":"Tap to remove 2 pairs","guide.storm":"Tap to rearrange the tiles","guide.pliers":"Tap to remove bomb","guide.custom":"Custom mode unlocked.\n Press this button to set your own difficulty","interMsg.reviveAd":"Watch an ad to revive yourself\nKeep playing and don't give up!","interMsg.doubleAd":"Watching an ad doubles your rewards!","interMsg.ranked":"Test your skills\nin ranked tournaments","interMsg.friendChallenge":"Challenge your friend\nSee who can score higher!","interMsg.bragChallenge":"Send a challenge to your friend\nClaim bragging rights!","interMsg.clearTiles":"Clear all tiles to\nwin the level!","interMsg.beatClock":"Beat the clock before\ntime runs out!","interMsg.clearBombs":"Clear bombs before\nthey explode","interMsg.seasonPack":"A season pack unlock\nnew tile sets!","interMsg.collectStars":"The more stars you collect\nThe more coins you'll be rewarded!","interMsg.competeInLb":"Compete globally or with friends\nRise to the top in tournaments!","interMsg.competeWithFriends":"You can challenge a friend\nTest each other's reflexes!","interMsg.thunder":"The Thunder power-up\nblasts tiles away","interMsg.hint":"A Hint power-up reveals\nthe next pair","interMsg.pliers":"Pliers can remove\nany bomb instantly","interMsg.tornado":"The Tornado power-up\nshuffles the board!","interMsg.coins":"Earn coins by completing levels\nWin tournaments for even more!","interMsg.seasonTiles":"A new tile set is unlocked\nevery season packs","interMsg.dailyLogin":"Log in daily to claim\nbetter rewards!","interMsg.levelUp":"Level up and earn coins\nwith each victory!","interMsg.seasonRewards":"Each season pack offers\nnew tiles!","error.tryLater":"Sorry, please try again later","error.soon":"Coming Soon","error.noFriendsLb":"Unable to load friends leaderboard. Please try again later.","error.noWorldLb":"Unable to load world leaderboard. Please try again later.","error.createTourFail":"Unknown error. Failed to Create Tournament","error.tourExists":"You already have a tournament","error.challengeFail":"Sorry, you cannot replay\nat this time.","error.rewardFail":"Unable to validate rewards. Please try again later...","error.tourEnded":"Tournament has ended","error.tourJoinFail":"Sorry, you cannot join\nat this time.","error.noAd":"No ads to display.","error.ratingNoAuth":"You need to log in to rate the game.","error.ratingGameRated":"You have already rated the game.","error.ratingFail":"Failed to rate the game.","error.shortcutFail":"Failed to create shortcut.","error.login":"Failed to log in.","error.joinLb":"Failed to join the leaderboard.","reward.day":"Day","reward.dayX":"Day %{0}","reward.starChestTitle":"Star Chest","reward.starChestAvailable":"Congrats, you have enough stars to open the chest!","reward.starChestUnavailable":"Win more stars to open!","item.hint":"Hint","item.thunder":"Thunder","item.storm":"Storm","item.pliers":"Pliers","item.hintDesc":"Shows a pair of tiles\nthat can be connected.","item.thunderDesc":"Remove 2 pair of tiles\non the game field.","item.stormDesc":"Randomly rearranges the \ntiles on the game field.","item.pliersDesc":"Removes a random bomb\nfrom the game field.","theme.newTiles":"New tiles","theme.summer":"Summer Levels","theme.autumn":"Autumn Levels","theme.winter":"Winter Levels","theme.springFestival":"Spring Festival Levels","theme.treePlantingFestival":"Tree Planting Festival Levels","theme.blueSeaFestival":"Blue Sea Festival Levels","theme.musicFestival":"Music Festival Levels","theme.harvestFestival":"Harvest Festival Levels","theme.foodFestival":"Food Festival Levels","theme.snowFestival":"Snow Festival Levels","theme.lightFestival":"Light Festival Levels","theme.peaceFestival":"Peace Festival Levels","theme.flowerFestival":"Flower Festival Levels","theme.streetFestival":"Street Festival Levels","theme.colorGarden":"Color Garden Levels","theme.colorFestival":"Color Festival Levels","theme.natureSummer":"Nature Summer Levels","theme.snowMountain":"Snow Mountain Levels","theme.iceFestival":"Ice Festival Levels","theme.greenGrassFestival":"Green Grass Festival Levels","theme.communityFestival":"Community Festival Levels","theme.waterFestival":"Water Festival Levels","theme.animalFestival":"Animal Festival Levels","theme.lostFestival":"Lost Festival Levels","theme.halloweenFestival":"Halloween Festival Levels","theme.snowMusicFestival":"Snow Music Festival Levels","theme.christmas":"Christmas Levels","theme.springFlowerFestival":"Spring Flower Festival Levels","theme.tetHoliday":"Tet Holiday Levels","theme.seaFestival":"Sea Festival Levels","theme.fireworkFestival":"Firework Festival Levels","theme.halloweenHorror":"Halloween Horror Levels","theme.midAutumn":"Mid Autumn Levels","theme.christmasSweet":"Christmas Sweet Levels","theme.newYearCountdown":"New Year Countdown Levels","theme.happyNewYear":"Happy New Year Levels","share.canYouDoBetter":"Can you do better?","dashboard.unlockLevel":"Unlock lv.%{0}"},texture:{draw:"locales/en/scenes/result-scene/resources/text_draw",lose:"locales/en/scenes/result-scene/resources/text_lose",victory:"locales/en/scenes/result-scene/resources/text_victory",waiting:"locales/en/scenes/result-scene/resources/text_waiting",excellent:"locales/en/scenes/game-scene/resources/effects/text-effect/excellent",good:"locales/en/scenes/game-scene/resources/effects/text-effect/good",great:"locales/en/scenes/game-scene/resources/effects/text-effect/great",wellDone:"locales/en/screens/level-complete-screen/resources/well_done",freeRewards:"locales/en/screens/get-rewards-screen/resources/free_rewards"}};d._RF.push({},"0b4bc6YT6ZGg4lnXfh/zL6J","AdsManager",void 0);var he=Ludex,fe=he.Events,me=he.Configs.Ads,pe=me.Enabled,ge=me.PreloadAds,ve=me.ShowAdOnLoad,ye=he.Utils,$e=ye.Time,Se=ye.Decorator,Ee=codex.event,we=(ce=Se.tryCatch(),ue=e((le=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){Ee.on(fe.AD_CLOSED,t.requestResizeGame$),Ee.catchUp(fe.GAME_READY,t.processPreloadAds$),Ee.catchUp(fe.GAME_SDK_READY,t.processShowFirstInterstitialAd),Ee.catchUp(fe.CONTEXT_DATA_PROCESSED,t.processShowBannerAds$),Ee.catchUp(fe.CONTEXT_DATA_PROCESSED,(function(){h.on(z.LAYOUT_CHANGED,t.handleLayoutChanged$)}))},this.requestResizeGame$=function(){Ee.emit(fe.REQUEST_RESIZE_GAME)},this.processShowBannerAds$=n((function*(){pe&&(yield $e.sleepAsync(5e3),G.updateBannerAdsByLayout(B.getCurrentLayout()),G.refreshBannerAdVisibility())})),this.processPreloadAds$=n((function*(){ge&&(yield $e.sleepAsync(3e3),G.preloadAds())})),r(this,"processShowFirstInterstitialAd",ue,this),this.handleLayoutChanged$=function(){G.updateBannerAdsByLayout(B.getCurrentLayout()),G.refreshBannerAdVisibility()}}return t(e,[{key:"init",value:function(){this.listenEvents$(),console.debug("Ads Manager: Initialized",{Enabled:pe,PreloadAds:ge,ShowAdOnLoad:ve})}}]),e}()).prototype,"processShowFirstInterstitialAd",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return n((function*(){if(pe){var e=ve.Enabled,t=ve.DelaySeconds;if(e){t>0&&(yield $e.sleepAsync(1e3*t));var n=GameSDK.isGameSDK("Yandex");n&&h.pause(),yield G.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"}),n&&h.resume()}}}))}}),le);d._RF.pop(),d._RF.push({},"b4ad5mMokdAa6EVNGzNedpF","EngineManager",void 0);var Ae,be,De,Ce=Ludex,Te=Ce.Events,Re=Ce.Configs.GameEngine,Le=Re.DynamicAtlas,Fe=Re.PreferredFPS,xe=Ce.Utils,_e=xe.Valid,Ie=xe.Device,Me=codex.event,Pe=function(){function e(){var t=this;a(this,e),this.overrideSettings$=function(){f.overrideSettings(m.Category.ENGINE,"debug",_e.isDebugger()),p.instance.resizeWithBrowserSize(!1),Ie.isDesktop()?h.frameRate=Fe.Desktop:h.frameRate=Fe.Mobile},this.setupAutoAtlas$=function(){g.instance.cacheAsset=!0},this.setupAssetDownloader$=n((function*(){var e=g.instance.downloader;e.maxConcurrency=24,e.maxRequestsPerFrame=24;var n=yield t.checkWebpSupport$();if(v.hasFeature(v.Feature.WEBP)){var a=v.hasFeature;v.hasFeature=function(e){return e===v.Feature.WEBP?n:a(e)}}})),this.checkWebpSupport$=function(){return new Promise((function(e){var t=new Image;t.onload=function(){return e(!0)},t.onerror=function(){return e(!1)},t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}))},this.getPipelineFlows$=function(){var e,t;return null!==(e=null===(t=y.root)||void 0===t||null===(t=t.pipeline)||void 0===t?void 0:t.flows)&&void 0!==e?e:[]},this.getRenderQueues$=function(e){var n=t.getPipelineFlows$()[0];return null!=n&&n.stages?n.stages[e].renderQueues:[]},this.setupOptimalPipelines$=n((function*(){g.instance.transformPipeline.remove(1),yield _e.isValueChangeAsync((function(){return!!y.root}),!0,{timeout:1e4});var e=t.getPipelineFlows$();e.shift(),e.shift();var n=t.getRenderQueues$(0);n.shift(),n.shift()})),this.setupEngineRunningState$=function(){$.on(S.EventType.TOUCH_START,t.handleResumeEngine$),Me.catchUp(Te.GAME_READY,(function(){Me.on(Te.VISIBILITY_HIDDEN,t.handlePauseEngine$),Me.on(Te.VISIBILITY_VISIBLE,t.handleResumeEngine$)}))},this.handlePauseEngine$=n((function*(){console.debug("Engine: Paused",h.isPaused()),h.isPaused()})),this.handleResumeEngine$=n((function*(){console.debug("Engine: Resumed",h.isPaused()),h.isPaused()})),this.setupDynamicAtlas$=function(){v.isBrowser?t.setupDynamicAtlasForBrowser$():v.isNative?t.setupDynamicAtlasForNative$():t.disableDynamicAtlas$()},this.setupDynamicAtlasForBrowser$=function(){switch(v.os){case v.OS.IOS:t.setupDynamicAtlasForIOS$();break;case v.OS.ANDROID:t.setupDynamicAtlasForAndroid$();break;case v.OS.OSX:case v.OS.LINUX:case v.OS.WINDOWS:t.setupDynamicAtlasForDesktop$();break;default:t.setupDynamicAtlasDefault$()}},this.setupDynamicAtlasForNative$=function(){switch(v.platform){case v.Platform.ANDROID:t.setupDynamicAtlasForAndroid$();break;case v.Platform.IOS:t.setupDynamicAtlasForIOS$();break;default:t.setupDynamicAtlasDefault$()}},this.setDynamicAtlas$=function(e){var n=e.Enabled,a=e.MaxAtlasCount,r=e.MaxAtlasSize,i=e.MaxFrameSize,s=E.instance;w.CLEANUP_IMAGE_CACHE=!n,s.enabled=n,s.textureSize=r,s.maxFrameSize=i,s.maxAtlasCount=a,s.textureBleeding=Le.OptimizeAtlas.TextureBleeding;var o=t.getMaxTextureSize$()||r,c=Math.min(r,o);s.textureSize=c,i>c&&(s.maxFrameSize=c)},this.getMaxTextureSize$=function(){if(!y.root)return-1;var e=y.root.device.capabilities.maxTextureSize,t=Math.min(Ie.maxTextureSize(),e);if(t>8192)return 7168;var n=E.instance.maxFrameSize,a=t-1024;return a<=(void 0===n?0:n)||a<=0?-1:a},this.setupDynamicAtlasForIOS$=function(){var e=Le.IOS;t.setDynamicAtlas$(e)},this.setupDynamicAtlasForAndroid$=function(){var e=Le.Android;t.setDynamicAtlas$(e)},this.setupDynamicAtlasForDesktop$=function(){var e=Le.Desktop;t.setDynamicAtlas$(e)},this.setupDynamicAtlasDefault$=function(){t.setDynamicAtlas$({Enabled:!0,MaxAtlasCount:1,MaxAtlasSize:4096,MaxFrameSize:1024})},this.disableDynamicAtlas$=function(){w.CLEANUP_IMAGE_CACHE=!0,E.instance.enabled=!1},this.setupBatcherLimit$=function(){w.BATCHER2D_MEM_INCREMENT=288,w.MAX_LABEL_CANVAS_POOL_SIZE=125}}return t(e,[{key:"init",value:function(){this.overrideSettings$(),this.setupAutoAtlas$(),this.setupBatcherLimit$(),this.setupDynamicAtlas$(),this.setupAssetDownloader$(),this.setupOptimalPipelines$(),this.setupEngineRunningState$(),console.debug("Engine Manager: Initialized",{PreferredFPS:Fe})}}]),e}();d._RF.pop(),d._RF.push({},"9f0a0l1uXlNwqKEKardFRyv","LayoutManager",void 0);var Ne=V.Layout,ke=V.DesignSize,Oe=ke.Portrait,Ue=ke.Landscape,Ge=V.AcceptPortraitRatio,ze=Ludex,Be=ze.Utils.Decorator,He=ze.Configs.GameEngine.AutoResizeCanvas,Ve=ze.Events,Ye=codex,je=Ye.ads,qe=Ye.event,Qe=(Ae=Be.debounce(100),De=e((be=function(){function e(){var t=this;a(this,e),this.listenResizeEvent$=function(){if(He&&ResizeObserver){var e,n=null!==(e=window.__listeners.resize)&&void 0!==e?e:[];if(n.length>0){var a,r=i(n);try{for(r.s();!(a=r.n()).done;){var s=a.value;window.removeEventListener("resize",s)}}catch(e){r.e(e)}finally{r.f()}}new ResizeObserver(t.handleBodyResize).observe(window.document.body)}qe.on(Ve.REQUEST_RESIZE_GAME,t.handleViewResizeBySystem$)},this.setupResolutionPolicy$=function(){A.setOrientation(w.ORIENTATION_AUTO),t.resolutionPolicy$=A.getResolutionPolicy(),t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.EXACT_FIT),t.resolutionPolicy$.setContainerStrategy(b.ContainerStrategy.PROPORTION_TO_FRAME)},this.isAdShowing$=function(){return!(null==je||!je.isAdFullSizeShowing())&&(console.error("‚ö†Ô∏è LayoutManager:handleViewResize skipped because ad is showing"),!0)},this.handleViewResizeBySystem$=function(e){if(!t.isAdShowing$()){var n=H.getMaxPixelRatio(),a=(null!=e?e:{}).forcePixelRatio,r=void 0===a?n:a;console.debug("üì± View resize by system",{forcePixelRatio:r,maxDpr:n}),window.devicePixelRatio=null!=r?r:n,t.setupOrientationByCanvasSize$()}},r(this,"handleBodyResize",De,this),this.setupOrientationByCanvasSize$=function(){var e=t.getScreenRatio$();switch(V.PRIMARY_LAYOUT){case"portrait":t.setPortraitView$();break;case"landscape":t.setLandscapeView$();break;case"auto":e<=Ge?t.setPortraitView$():t.setLandscapeView$()}},this.setPortraitView$=function(){var e=Oe.WIDTH,n=Oe.HEIGHT,a=V.PRIMARY_LAYOUT===Ne.Portrait;(t.currentLayout$!==Ne.Portrait||a)&&(t.currentLayout$=Ne.Portrait,t.setupLayoutStrategy$(e,n)),t.resizeGameView$(e,n)},this.setLandscapeView$=function(){var e=Ue.WIDTH,n=Ue.HEIGHT,a=V.PRIMARY_LAYOUT===Ne.Landscape;(t.currentLayout$!==Ne.Landscape||a)&&(t.currentLayout$=Ne.Landscape,t.setupLayoutStrategy$(e,n)),t.resizeGameView$(e,n)},this.setupLayoutStrategy$=function(e,n){var a=A.getDesignResolutionSize(),r=a.width,i=a.height,s=t.resolutionPolicy$.getContentStrategy(),o=t.resolutionPolicy$._containerStrategy.name,c=t.currentLayout$===Ne.Portrait,l=t.currentLayout$===Ne.Landscape;c&&t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.FIXED_WIDTH),l&&t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.FIXED_HEIGHT),c&&!V.FULL_PORTRAIT_SIZE&&(t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.SHOW_ALL),t.resolutionPolicy$.setContainerStrategy(b.ContainerStrategy.PROPORTION_TO_FRAME)),l&&!V.FULL_LANDSCAPE_SIZE&&(t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.EXACT_FIT),t.resolutionPolicy$.setContainerStrategy(b.ContainerStrategy.PROPORTION_TO_FRAME)),t.getScreenRatio$()>V.AcceptPortraitRatio&&c&&t.resolutionPolicy$.setContentStrategy(b.ContentStrategy.FIXED_HEIGHT),c&&t.resolutionPolicy$.setContainerStrategy(b.ContainerStrategy.EQUAL_TO_FRAME),l&&t.resolutionPolicy$.setContainerStrategy(b.ContainerStrategy.EQUAL_TO_FRAME),r===e&&i===n&&s===t.resolutionPolicy$.getContentStrategy()&&o===t.resolutionPolicy$._containerStrategy.name||A.setDesignResolutionSize(e,n,t.resolutionPolicy$),console.debug("üî• Change layout to",t.currentLayout$,t.resolutionPolicy$),h.emit(z.LAYOUT_CHANGED,t.currentLayout$)},this.resizeGameView$=function(e,n){var a=V.DesignSize.Resolution,r=new D(e/a,n/a),i=H.getScreenWidthCss(),s=H.getScreenHeightCss(),o=i/r.width,c=s/r.height,l=new D(r.width,r.height),u=t.currentLayout$===Ne.Portrait,d=t.currentLayout$===Ne.Landscape;if(u||d)l.width*=o,l.height*=c;else{var f=Math.min(o,c);l.width*=f,l.height*=f}var m=H.worldSizeToCssSize(l.width),p=H.worldSizeToCssSize(l.height),g=new D(m,p);C.windowSize=g,h.emit(z.VIEW_RESIZED,g),console.info("üìê View Resized",g)},this.getScreenRatio$=function(){return H.getScreenWidthCss()/H.getScreenHeightCss()}}return t(e,[{key:"init",value:function(){this.listenResizeEvent$(),this.setupResolutionPolicy$(),console.debug("Layout Manager: Initialized",{AcceptPortraitRatio:Ge,AutoResizeCanvas:He})}}]),e}()).prototype,"handleBodyResize",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(!e.isAdShowing$()){var t=H.getMaxPixelRatio();console.debug("üì± View resize by body",{maxDpr:t}),window.devicePixelRatio=t,e.setupOrientationByCanvasSize$()}}}}),be);d._RF.pop(),d._RF.push({},"535cbXcmXdEzLn3H3LOIS27","MatchManager",void 0);var Ke=Ludex,We=Ke.Utils,Xe=We.Valid,Ze=We.Object,Je=We.Array,et=Ke.Dtos.Match,tt=(void 0===et?{}:et).CustomData,nt=["code","cols","encoding","idSize","rows"],at=["addRandomTilesPerMove","maxSpaceOfPair"],rt=function(){function e(){var t=this;a(this,e),this.setupMatchCustomData$=function(){tt&&(tt.addDefaults(Y),tt.addValidator("score",(function(e){if(!Xe.isNumber(e)||e<0)throw new Error("score ".concat(e," is invalid"))})))},this.setupMatchData$=function(){tt&&tt.addValidator("challengeData",(function(e){if(null!=e){if(!Xe.isObject(e))throw new Error("challengeData ".concat(e," must be a record of string keys"));var n=e,a=Object.keys(n);if(!Je.has(a,"level"))throw new Error("challengeData.level is missing");if(!Xe.isNumber(n.level))throw new Error("challengeData.level ".concat(n.level," must be a number"));if(!Je.has(a,"fen"))throw new Error("challengeData.fen is missing");if(t.validateFen$(n.fen),!Je.has(a,"gravity"))throw new Error("challengeData.gravity is missing");if(!Xe.isString(n.gravity))throw new Error("challengeData.gravity ".concat(n.gravity," must be a string"));if(!Je.has(a,"rules"))throw new Error("challengeData.rules is missing");if(t.validateLevelRules$(n.rules),!Je.has(a,"time"))throw new Error("challengeData.time is missing");if(!Xe.isNumber(n.time))throw new Error("challengeData.time ".concat(n.time," must be a number"))}}))},this.validateFen$=function(e){if(!Xe.isObject(e))throw new Error("challengeData.fen ".concat(e," must be a record of string keys"));var n=t.validateKeys$(e,nt);if(!Xe.isNumber(n.idSize))throw new Error("fen.idSize must be a number");if(!Xe.isString(n.code))throw new Error("fen.code must be a string");if(!Xe.isNumber(n.rows))throw new Error("fen.rows must be a number");if(!Xe.isNumber(n.cols))throw new Error("fen.cols must be a number");if(!Xe.isObject(n.encoding))throw new Error("fen.encoding must be a record of string keys");var a=t.validateKeys$(n.encoding,Ze.vals(j));Object.entries(a).forEach((function(e){var t=s(e,2),n=t[0],a=t[1];if(!Xe.isString(a))throw new Error("fen.encoding.".concat(n," ").concat(a," must be a string"))}))},this.validateLevelRules$=function(e){if(!Xe.isObject(e))throw new Error("challengeData.rules ".concat(e," must be a record of string keys"));var n=t.validateKeys$(e,at);if(!Xe.isNumber(n.addRandomTilesPerMove))throw new Error("rules.addRandomTilesPerMove must be a number");if(!Xe.isNumber(n.maxSpaceOfPair))throw new Error("rules.maxSpaceOfPair must be a number")},this.validateKeys$=function(e,t){return Object.keys(e).forEach((function(e){if(!Je.has(t,e))throw new Error("Key ".concat(e," is missing"))})),e}}return t(e,[{key:"init",value:function(){console.debug("Match Manager: Initialized")}},{key:"setupDefaultMatchData",value:function(){this.setupMatchData$(),this.setupMatchCustomData$()}}]),e}();d._RF.pop(),d._RF.push({},"d675ctpYslBHp4qqiYEki+q","PlayerManager",void 0);var it=Ludex,st=it.Utils,ot=st.Valid,ct=st.Array,lt=st.Object,ut=st.Browser,dt=it.Dtos.Player,ht=codex.player,ft=window.GameName.replace(/ /g,"-"),mt=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){console.debug("Player Manager: Initialized")}},{key:"setupDefaultGameData",value:function(){dt.Data.makeLoose(),dt.GameData.makeLoose(),dt.Data.addDefaults(q),dt.GameData.addDefaults(Q),dt.GameData.addValidator("stars",(function(e){if(!ot.isNumber(e)||e<0)throw new Error("stars ".concat(e," is invalid"))})),dt.GameData.addValidator("totalLevel",(function(e){ot.isNumber(e)})),dt.GameData.addValidator("levelVersion",(function(e){if(!ot.isNumber(e)||e<0)throw new Error("levelVersion ".concat(e," is invalid"))})),dt.GameData.addValidator("lastRewardedItems",(function(e){if(!ot.isNumber(e)||e<0)throw new Error("lastRewardedItems ".concat(e," is invalid"))})),dt.GameData.addValidator("lastCreateTournamentShown",(function(e){if(!ot.isNumber(e)||e<0)throw new Error("lastCreateTournamentShown ".concat(e," is invalid"))})),dt.GameData.addValidator("guideItemShowed",(function(e){if(!Array.isArray(e))throw new Error("guideItemShowed ".concat(e," is invalid"))})),dt.GameData.addValidator("items",(function(e){if(!ot.isObject(e))throw new Error("items ".concat(e," is invalid"));var t=Object.keys(e),n=lt.vals(e);if(!ct.has(t,K.HINT))throw new Error("item ".concat(K.HINT," not found"));if(!ct.has(t,K.THUNDER))throw new Error("item ".concat(K.THUNDER," not found"));if(!ct.has(t,K.STORM))throw new Error("item ".concat(K.STORM," not found"));if(!ct.has(t,K.PLIERS))throw new Error("item ".concat(K.PLIERS," not found"));n.forEach((function(e){if(!ot.isNumber(e)||e<0)throw new Error("item ".concat(e," is invalid"))}))})),dt.GameData.addValidator("tournamentProgress",(function(e){if(!ot.isObject(e))throw new Error("tournamentProgress ".concat(e," is invalid"))})),dt.GameData.addValidator("custom",(function(e){if(!ot.isObject(e))throw new Error("custom ".concat(e," is invalid"));var t=Object.keys(e);if(!ct.has(t,"time"))throw new Error("custom time not found");if(!ct.has(t,"difficulty"))throw new Error("custom tiles not found");if(!ct.has(t,"bombs"))throw new Error("custom bombs not found");if(!ct.has(t,"ads"))throw new Error("custom ads not found")})),dt.GameData.addValidator("endlessScore",(function(e){if(!ot.isNumber(e)||e<0)throw new Error("endlessScore ".concat(e," is invalid"))}))}},{key:"syncPlatformPlayerData",value:function(){GameSDK.isGameSDK("MsGames")&&this.syncOldPlayerDataForMsGames()}},{key:"syncOldPlayerDataForMsGames",value:function(){var e="".concat(ft,"_PlayerData"),t=ut.getLocalStorage(e);if(ot.isObject(t)){var n=new dt.Data(t).toObject(),a=ht.getPlayerData();if(ot.isObject(a))a.gameData.level>=n.gameData.level||ht.setPlayerData(n)}}},{key:"requestConnectedPlayers",value:function(){ht.requestConnectedPlayers().catch((function(e){console.warn("player.requestConnectedPlayers",e)}))}}]),e}();d._RF.pop(),d._RF.push({},"51079bCfn9MZK6cuxbahS7M","AdaptivePerformance",void 0);var pt=Ludex.Utils.Valid,gt=codex.adaptivePerformance,vt=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){y.once(T.EVENT_BEGIN_FRAME,t.handleBeginFrame$),y.on(T.EVENT_AFTER_SCENE_LAUNCH,t.handleAfterSceneLaunch$)},this.handleBeginFrame$=function(){y.on(T.EVENT_AFTER_UPDATE,t.lateUpdate$),y.on(T.EVENT_BEFORE_UPDATE,t.updateActualFPS$)},this.handleAfterSceneLaunch$=function(e){gt&&gt.trackingScene(e.name)},this.lateUpdate$=function(){var e=1e3*h.deltaTime;null==gt||gt.updatePostStepDeltaTime(e)},this.updateActualFPS$=function(){var e,t=null===(e=y.root)||void 0===e?void 0:e.fps;pt.isNumber(t)&&(null==gt||gt.updateActualFPS(t))}}return t(e,[{key:"init",value:function(){gt&&this.listenEvents$()}}]),e}();d._RF.pop(),d._RF.push({},"0bbd4wf2fRDcKljBcls6K8a","CanvasRecorder",void 0);var yt=codex.canvasRecorder,$t=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){if(h.canvas&&yt){yt.setCanvas(h.canvas);var e=yt.getOptions(),t=function(){h.pause(),h.step()},n=yt.waitNextFrame;yt.waitNextFrame=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,i){a||yt.isCapturing()?e.syncFps?(y.once(T.EVENT_AFTER_RENDER,r),t()):n(a).then(r).catch(i):h.resume()}))}}}}]),e}();d._RF.pop(),d._RF.push({},"e8b3dVomjtKZ68ykoRs82vP","DailyRewards",void 0);var St,Et,wt,At=codex.storage,bt=function(){function e(){a(this,e),this.initStorage$=function(){At.addStorage("dashboardDailyRewards",{hasShownPopup:!1})}}return t(e,[{key:"init",value:function(){this.initStorage$()}}]),e}();d._RF.pop(),d._RF.push({},"49a72YoKFFCKbOm5Xgp9R+k","DynamicAssets",void 0);var Dt=Ludex,Ct=Dt.Configs.GameEngine.DynamicAssets,Tt=Ct.Resolution,Rt=Ct.IgnoreFiles,Lt=Ct.Compression,Ft=Dt.Events,xt=Dt.Utils,_t=xt.Array,It=xt.Function,Mt=xt.Device,Pt=xt.Decorator,Nt=codex,kt=Nt.event,Ot=Nt.storage,Ut=Nt.getBuildVersion,Gt=[".png",".jpg",".jpeg",".webp"],zt=1,Bt=2,Ht=3,Vt=(St=Pt.debounce(1e3),wt=e((Et=function(){function e(){var t=this;a(this,e),this.isProcessing$=!1,this.yield10msIfNeeded$=It.timeSlice(10),this.targetScale$=1,this.sessionQuality$=Ht,this.failedAssets$=new Set,this.isAssetUpgraded$=new Set,this.upgradableAssets$=new Map,this.initStorage$=n((function*(){yield Ot.addStorage("DynamicAssets",{currentQuality:0,buildVersion:"0"},!0)})),this.getOptimalScale$=function(){var e,t=Math.round(Mt.pixelRatio()),n=Tt.Available,a=Tt.Source,r=o(n).sort((function(e,t){return e-t})),s=i(r);try{for(s.s();!(e=s.n()).done;){var c=e.value;if(c>=t)return Math.min(c,a)}}catch(e){s.e(e)}finally{s.f()}return a},this.getCurrentQuality$=function(){return t.targetScale$!==Tt.Source||Lt.Enabled?Lt.Enabled?zt:Bt:Ht},this.checkCacheVersion$=function(){var e=Ut().toString(),n=Ot.getStorage("DynamicAssets"),a=null!=n?n:{},r=a.currentQuality,i=void 0===r?0:r,s=a.buildVersion;t.sessionQuality$<i&&e===s&&(t.sessionQuality$=i),Ot.setStorageData("DynamicAssets","buildVersion",e),Ot.updateToWebStorage("DynamicAssets")},this.listenEvents$=function(){Lt.Enabled&&t.sessionQuality$!==Ht&&(kt.catchUp(Ft.GAME_READY,(function(){h.emit(z.REQUEST_UPGRADE_ASSET)})),h.on(z.REQUEST_UPGRADE_ASSET,t.handleChangeQuality))},this.injectSpriteUpdate$=function(e){Object.defineProperty(R.prototype,"spriteFrame",{get:function(){return this._spriteFrame},set:function(t){if(t&&t.refreshed&&this._spriteFrame!==t){var n=this._spriteFrame;if(this._spriteFrame=t,this.markForUpdateRenderData(!0),this._applySpriteFrame(n),this.sizeMode!==R.SizeMode.CUSTOM){var a=this.node.getComponent(L);if(a){var r=t.originalSize,i=r.width,s=r.height,o=new D(i/e,s/e);a.setContentSize(o)}}}}})},this.injectSpriteFrameCheckRect$=function(e){var t=F.prototype.checkRect;F.prototype.checkRect=function(){if(this.refreshed)return!0;for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.apply(this,n)}},this.injectSpriteFrameSlicedUV$=function(e){var t=F.prototype._calculateSlicedUV;F.prototype._calculateSlicedUV=function(){var n,a=null!==(n=this._capInsets)&&void 0!==n?n:[0,0,0,0],r=a.map((function(t){return(t+1)*e}));this._capInsets=r,t.apply(this),this._capInsets=a}},this.injectSpriteFrameResolution$=function(e){var t=F.prototype._refreshTexture;F.prototype._refreshTexture=function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];if(this.name&&!this.refreshed){var i=this.rect,s=i.x,o=i.y,c=i.width,l=i.height,u=Number((s*e).toFixed(2)),d=Number((o*e).toFixed(2)),h=Math.round(c*e),f=Math.round(l*e),m=new x(u,d,h,f),p=new D(m.width,m.height);return this.refreshed=!0,this.reset({rect:m,originalSize:p}),t.apply(this,a)}t.apply(this,a)}},r(this,"handleChangeQuality",wt,this),this.getAssetQuality$=function(e){var n="/native@".concat(t.targetScale$,"x/");switch(t.sessionQuality$){case Bt:return"".concat(n,"quality/");case zt:return _t.has(Rt,e)?"".concat(n,"quality/"):"".concat(n,"medium/");default:return"/native/"}},this.replaceAssetUrl$=function(e,n){return t.sessionQuality$!==Ht&&n.includes("/native/")?n.replace("/native/",t.getAssetQuality$(e)):n},this.saveStateToStorage$=function(){Ot.setStorageData("DynamicAssets","currentQuality",t.sessionQuality$),Ot.updateToWebStorage("DynamicAssets",!0)},this.updateSpriteFrames$=n((function*(){var e=y.getScene();if(e){var n,a=e.getComponentsInChildren("cc.Sprite"),r=i(a);try{for(r.s();!(n=r.n()).done;){var s=n.value.spriteFrame;if(s){var o=s.texture,c=s.original,l=o.uuid;c&&(l=c._texture.uuid),t.isAssetUpgraded$.has(l)&&(o.updateImage(),yield t.yield10msIfNeeded$())}}}catch(e){r.e(e)}finally{r.f()}}})),this.requestUpdateDynamicAssets$=function(){h.emit(z.REQUEST_DYNAMIC_ATLAS,{force:!0})},this.collectUpgradableAssets$=function(e){var n,a=e.output=e.input,r=!1,s=i(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(_t.has(Gt,o.ext)){var c=o.url,l=t.replaceAssetUrl$(o.uuid,c);if(l!==c&&(o.url=l,!t.upgradableAssets$.has(o.uuid))){var u={ext:o.ext,url:o.url,uuid:o.uuid,options:o.options,resolution:t.targetScale$};t.upgradableAssets$.set(o.uuid,u),r=!0}}}}catch(e){s.e(e)}finally{s.f()}r&&h.emit(z.REQUEST_UPGRADE_ASSET)},this.processUpgradeQualityAsync$=function(){var e=n((function*(e){var n=e.uuid,a=e.url,r=e.ext,i=e.options,s=e.resolution;if(!(n&&a&&r&&i&&s))return!1;if(t.isAssetUpgraded$.has(n))return!0;if(t.failedAssets$.has(n))return!1;if(_t.has(Rt,n))return t.isAssetUpgraded$.add(n),!0;var o=_.assets.get(n);if(!(o instanceof I))return console.warn("DynamicAssets: Asset not found for upgrade",n),!1;var c="/native@".concat(s,"x/"),l="".concat(c,"medium/"),u="".concat(c,"quality/"),d=a.replace(l,u);if(d===a)return t.isAssetUpgraded$.add(n),!0;var f={uuid:n,url:d,options:i,resolution:s,ext:r};return new Promise((function(e){_.loadAny(f,i,(function(a,r){if(a)return console.warn("[DynamicAssets] processUpgrade: Upgrade error for ".concat(n.slice(0,5)),a),t.failedAssets$.add(n),void e(!1);o.reset(r),o._nativeUrl=d,t.isAssetUpgraded$.add(n),h.emit(z.ASSET_QUALITY_CHANGE,{asset:o,item:f}),e(!0)}))}))}));return function(t){return e.apply(this,arguments)}}()}var s;return t(e,[{key:"init",value:(s=n((function*(){if(this.targetScale$=this.getOptimalScale$(),this.sessionQuality$=this.getCurrentQuality$(),yield this.initStorage$(),this.checkCacheVersion$(),_.transformPipeline.insert(this.collectUpgradableAssets$,2),this.sessionQuality$<Ht){var e=this.targetScale$/Tt.Source;this.injectSpriteUpdate$(e),this.injectSpriteFrameSlicedUV$(e),this.injectSpriteFrameCheckRect$(e),this.injectSpriteFrameResolution$(e)}this.listenEvents$()})),function(){return s.apply(this,arguments)})}]),e}()).prototype,"handleChangeQuality",[St],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return n((function*(){if(!(e.isProcessing$||!Lt.Enabled||e.sessionQuality$>=Bt))try{e.isProcessing$=!0;var t,n=[],a=e.isAssetUpgraded$.size,r=i(e.upgradableAssets$.values());try{for(r.s();!(t=r.n()).done;){var s=t.value,o=e.processUpgradeQualityAsync$(s);n.push(o)}}catch(e){r.e(e)}finally{r.f()}if(n.length<1)return;yield It.allSettled(n),e.isAssetUpgraded$.size>a&&(e.sessionQuality$++,e.saveStateToStorage$()),yield e.updateSpriteFrames$(),e.requestUpdateDynamicAssets$()}catch(e){console.warn("DynamicAssets: Handle change quality error",e)}finally{e.isProcessing$=!1}}))}}),Et);d._RF.pop(),d._RF.push({},"15ecbqnx5lFtYRSJp2lOLCm","DynamicAtlas",void 0);var Yt=Ludex,jt=Yt.Events,qt=Yt.Configs.GameEngine.DynamicAtlas.OptimizeAtlas,Qt=qt.AtlasDebug,Kt=qt.AutoAtlasSize,Wt=qt.UsePowerOfTwo,Xt=qt.AllowNonePackable,Zt=qt.OnlyOptimizeWhenRenderTooLong,Jt=Yt.Utils,en=Jt.Json,tn=Jt.Image,nn=Jt.Function,an=Jt.Object,rn=Jt.Mark,sn=codex.event,on={MAX_INTERVAL_MS:1e4,THROTTLE_UPDATE_MS:800,INTERVAL_INCREASE_MS:1e3,MEAN_LAG_THRESHOLD_MS:8,MAX_RECORDED_RENDER_TIMES:100,RENDER_TIME_CHECK_INTERVAL_MS:5e3},cn={PACK_PADDING:5,MIN_FILL_RATE:.6,BLEEDING_SPACE:1,COLLECT_PADDING:2,BLEED_SENSITIVE_SIZE:16},ln={ENABLED:Qt,FONT:"22px Arial",TEXT_HEIGHT:22,TEXT_PADDING:4,IMAGE_QUALITY:.6},un=function(){function e(){var t=this;a(this,e),this.isEffective$=!0,this.forceUpdateDynamicAtlas$=!1,this.mutex$=nn.mutex(),this.renderTimes$=[],this.lastRenderTime$=0,this.renderTimeInterval$=on.RENDER_TIME_CHECK_INTERVAL_MS,this.atlasInfo$=null,this.lastAtlasInfo$=null,this.atlasIds$={},this.collectInfo$=new Map,this.packedFrames$=new Set,this.debugCanvases$={},this.listenEvents$=function(){h.on(z.REQUEST_DYNAMIC_ATLAS,t.requestUpdateDynamicAtlas$),sn.on(jt.SCENE_LAUNCHED,t.onSceneLaunched$),sn.catchUp(jt.GAME_READY,t.setupRenderListeners$)},this.onSceneLaunched$=function(){t.resetPendingInfo$(),t.resetAllAtlases$()},this.resetAllAtlases$=function(){for(var e in t.packedFrames$.forEach((function(e){e.isValid&&e._resetDynamicAtlasFrame()})),t.packedFrames$.clear(),E.instance.reset(),t.atlasInfo$=null,t.lastAtlasInfo$=null,t.debugCanvases$)delete t.debugCanvases$[e]},this.overrideDynamicAtlasManager$=function(){var e=E.instance;e.packToDynamicAtlas=t.collectSpriteFrame$,e.deleteAtlasSpriteFrame=t.deleteSpriteFrame$},this.createPendingDebugCanvas$=function(){var e=t.createDebugCanvas$(),n=E.instance.maxAtlasCount+1;t.debugCanvases$[n]=e},this.checkRenderTimeThreshold$=function(){t.calculateMeanRenderTimeAndReset$()>on.MEAN_LAG_THRESHOLD_MS&&t.handleLaggyFrame$(),y.once(T.EVENT_AFTER_RENDER,(function(){setTimeout((function(){t.checkRenderTimeThreshold$()}),t.renderTimeInterval$)}))},this.handleLaggyFrame$=function(){t.isEffective$||(t.renderTimeInterval$=Math.min(t.renderTimeInterval$+on.INTERVAL_INCREASE_MS,on.MAX_INTERVAL_MS)),t.requestUpdateDynamicAtlas$({force:!0})},this.resetPendingInfo$=function(){t.atlasIds$={},t.collectInfo$.clear()},this.setupRenderListeners$=function(){y.on(T.EVENT_BEFORE_RENDER,t.updateBeforeRenderTime$),y.on(T.EVENT_AFTER_RENDER,t.updateAfterRenderTime$),Zt&&sn.catchUp(jt.SCENE_LAUNCHED,(function(){y.once(T.EVENT_AFTER_RENDER,t.checkRenderTimeThreshold$)}))},this.updateBeforeRenderTime$=function(){t.lastRenderTime$=performance.now()},this.updateAfterRenderTime$=function(){t.renderTimes$.length>=on.MAX_RECORDED_RENDER_TIMES&&t.renderTimes$.shift();var e=performance.now()-t.lastRenderTime$;t.renderTimes$.push(e)},this.calculateMeanRenderTimeAndReset$=function(){if(0===t.renderTimes$.length)return 0;var e=t.renderTimes$.reduce((function(e,t){return e+t}),0)/t.renderTimes$.length;return t.renderTimes$.length=0,e},this.collectSpriteFrame$=function(e){if(an.hasOwn(e,"spriteFrame")){var n=e.spriteFrame;if(t.isSpriteFrameValidForAtlas$(e,n)){var a=t.getTexture$(n),r=null==a?void 0:a.getId();if(r){var i=t.getTextureSizeFromTexture$(a);t.addTextureToCollectInfo$(r,i,e),!Zt&&t.requestUpdateDynamicAtlas$()}}}},this.deleteSpriteFrame$=function(e){var n=t.getTexture$(e);if(n){var a=t.getAtlas$();null==a||a.deleteInnerTexture(n),t.packedFrames$.delete(e),e._resetDynamicAtlasFrame()}},this.isSpriteFrameValidForAtlas$=function(e,n){var a=e.enabled,r=e.node;if(!a||!n)return!1;if(!r.active||!r.activeInHierarchy)return!1;if(!n.packable&&!Xt)return!1;if(n.original){var i=n.texture,s=n.original._texture,o=i===s,c=(null==i?void 0:i.getId())===(null==s?void 0:s.getId());if(o||c)return!1}if(e.color.a<1)return!1;for(var l=r;l;){var u=l.getComponent(M);if(u&&u.opacity<1)return!1;l=l.parent}var d=t.getTextureSize$(n);return!t.isTextureTooLarge$(d)},this.addTextureToCollectInfo$=function(e,n,a){var r=t.collectInfo$.get(e),i=cn.COLLECT_PADDING,s=n.w+i,o=n.h+i;s<=i||o<=i||(r?(r.w=s,r.h=o):(r={id:e,w:s,h:o,x:-1,y:-1,components:new Set},t.collectInfo$.set(e,r)),r.components.has(a)||r.components.add(a))},this.getTexture$=function(e){var t,n;return null!==(t=null===(n=e.original)||void 0===n?void 0:n._texture)&&void 0!==t?t:e.texture},this.getTextureSize$=function(e){var n=t.getTexture$(e);return t.getTextureSizeFromTexture$(n)},this.getTextureSizeFromTexture$=function(e){var t,n;return null!=e&&e.image?{w:e.image.width,h:e.image.height}:{w:null!==(t=null==e?void 0:e.width)&&void 0!==t?t:0,h:null!==(n=null==e?void 0:e.height)&&void 0!==n?n:0}},this.isTextureTooLarge$=function(e){var t=E.instance.maxFrameSize;return e.w>=t||e.h>=t},this.rebuildAtlasIfNecessary$=function(){var e;if(!t.atlasInfo$)return!1;if(t.lastAtlasInfo$&&!t.forceUpdateDynamicAtlas$){var n=t.isSameAtlas$(t.lastAtlasInfo$,t.atlasInfo$);if(t.isEffective$=!n,n)return!1}var a=t.getAtlas$();if(null===(e=a)||void 0===e||!e._texture)return!1;var r=t.atlasInfo$.packedInfo,i=a._texture,s=i.width,o=i.height,c=r.width+cn.PACK_PADDING,l=r.height+cn.PACK_PADDING;if(Math.max(c,l)<=cn.PACK_PADDING)return!1;var u=Math.max(c,l),d=Wt?u:c,h=Wt?u:l;if(!(a=t.resetAtlas$(a)))return!1;if(Kt||(d>s||h>o)){a._texture.initWithSize(d,h);var f=t.debugCanvases$[t.getAtlasIndex$()];f&&(f.width=d,f.height=h)}else{var m,p=t.debugCanvases$[t.getAtlasIndex$()];if(p)null===(m=p.getContext("2d"))||void 0===m||m.clearRect(0,0,p.width,p.height)}return t.lastAtlasInfo$=en.clone(t.atlasInfo$),!0},this.createAtlas$=function(){var e=E.instance.newAtlas();if(e&&ln.ENABLED){var n=t.createDebugCanvas$(),a=t.getAtlasIndex$();t.debugCanvases$[a]=n}return e},this.createDebugCanvas$=function(){var e=E.instance.textureSize,t=document.createElement("canvas");return t.width=e,t.height=e,t},this.resetAtlas$=function(e){var n=E.instance,a=n._atlases.indexOf(e);return t.packedFrames$.forEach((function(e){e.isValid&&e._resetDynamicAtlasFrame()})),t.packedFrames$.clear(),e.destroy(),a>-1&&(n._atlases.splice(a,1),n._atlasIndex>=a&&n._atlasIndex--),t.getAtlas$()},this.getAtlas$=function(e){var n,a=E.instance,r=a._atlases,i=void 0===r?[]:r,s=a._atlasIndex;return null!==(n=i[null!=e?e:s])&&void 0!==n?n:t.createAtlas$()},this.getAtlasIndex$=function(){return E.instance._atlasIndex},this.getAtlasSize$=function(){var e=t.getAtlas$(),n=E.instance.textureSize;return null!=e&&e._texture?{w:Math.max(e._texture.width,n),h:Math.max(e._texture.height,n)}:{w:n,h:n}},this.requestUpdateDynamicAtlas$=nn.debounce((function(e){var n;t.forceUpdateDynamicAtlas$||(t.forceUpdateDynamicAtlas$=null!==(n=null==e?void 0:e.force)&&void 0!==n&&n),t.updateDynamicAtlas$()}),on.THROTTLE_UPDATE_MS),this.updateDynamicAtlas$=n((function*(){if(y.getScene()){var e=yield t.mutex$.use("updateDynamicAtlas");rn.start("DynamicAtlas Process");try{if(y.pause(),t.atlasInfo$=null,t.prepareDrawInfo$(),!t.rebuildAtlasIfNecessary$())return;if(!t.packCollectedTextures$())return;h.emit(z.FINISHED_DYNAMIC_ATLAS),requestAnimationFrame(t.printAtlasTextures$)}catch(e){}finally{t.forceUpdateDynamicAtlas$=!1,rn.stop("DynamicAtlas Process"),y.resume(),e.release()}}})),this.prepareDrawInfo$=function(){if(!(t.collectInfo$.size<1)){var e=[];t.collectInfo$.forEach((function(t){t.components.size<1||e.push(t)})),t.calculateOptimizedAtlas$(e)}},this.calculateOptimizedAtlas$=function(e){if(0!==e.length){var n=function(e){var t,n=0,a=0,r=i(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n+=s.w*s.h,a=Math.max(a,s.w)}}catch(e){r.e(e)}finally{r.f()}e.sort((function(e,t){return t.h-e.h}));var o,c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}],l=0,u=0,d=i(e);try{for(d.s();!(o=d.n()).done;)for(var h=o.value,f=c.length-1;f>=0;f--){var m=c[f];if(!(h.w>m.w||h.h>m.h)){if(h.x=m.x,h.y=m.y,u=Math.max(u,h.y+h.h),l=Math.max(l,h.x+h.w),h.w===m.w&&h.h===m.h){var p=c.pop();p&&f<c.length&&(c[f]=p)}else h.h===m.h?(m.x+=h.w,m.w-=h.w):h.w===m.w?(m.y+=h.h,m.h-=h.h):(c.push({x:m.x+h.w,y:m.y,w:m.w-h.w,h:h.h}),m.y+=h.h,m.h-=h.h);break}}}catch(e){d.e(e)}finally{d.f()}return{w:l,h:u,fill:n/(l*u)||0}}(e),a=n.w,r=n.h,s=n.fill;if(!(s<cn.MIN_FILL_RATE)){var o=t.getAtlasSize$();if(a>o.w||r>o.h){var c=t.excessTextures$(e,o);if(c.length<1)return;var l=new Set(c),u=e.filter((function(e){return!l.has(e)}));t.calculateOptimizedAtlas$(u)}else t.atlasInfo$={atlasSize:o,atlasIndex:t.getAtlasIndex$(),packedInfo:{width:Math.round(a),height:Math.round(r),fillRate:s}}}}},this.excessTextures$=function(e,n){var a=n.w,r=n.h,i=t.calculateExcessDimensions$(a,r,n),s=i.excessWidth,o=i.excessHeight;return t.tryRemoveExcessTextures$(e,s,o)},this.calculateExcessDimensions$=function(e,t,n){return{excessWidth:Math.max(0,e-n.w),excessHeight:Math.max(0,t-n.h)}},this.tryRemoveExcessTextures$=function(e,n,a){var r,s=0,o=0,c=[],l=t.getAtlasIndex$(),u=i(e);try{for(u.s();!(r=u.n()).done;){var d,h=r.value;(n>0&&s<n||a>0&&o<a)&&(s+=h.w,o+=h.h,t.atlasIds$[h.id]=Math.min(null!==(d=t.atlasIds$[h.id])&&void 0!==d?d:l,l),h.x=-1,h.y=-1,c.push(h))}}catch(e){u.e(e)}finally{u.f()}return c},this.packCollectedTextures$=function(){if(!t.atlasInfo$)return!1;var e=t.getAtlas$();if(!e)return!1;var n=[],a=new Map,r=new Set;t.collectInfo$.forEach((function(e){r.add(e.id);var s,o=i(e.components);try{for(o.s();!(s=o.n()).done;){var c,l=s.value;n.push(l);var u=null==l?void 0:l.spriteFrame;if(u){var d=t.getTexture$(u),h=null==d?void 0:d.getId();h&&a.set(h,(null!==(c=a.get(h))&&void 0!==c?c:0)+1)}}}catch(e){o.e(e)}finally{o.f()}}));for(var s=0,o=n;s<o.length;s++){var c=o[s];t.packComponentIntoAtlas$(e,c)}return!0},this.packComponentIntoAtlas$=function(e,n){if(an.hasOwn(n,"spriteFrame")){var a=n.spriteFrame;a&&t.tryInsertSpriteFrame$(e,a,n)}},this.tryInsertSpriteFrame$=function(e,n,a){n.original&&n._resetDynamicAtlasFrame();var r=E.instance.textureBleeding,i=t.drawTexture$(e,n,r);i&&(n._setDynamicAtlasFrame(i),t.packedFrames$.add(n),a.setTextureDirty(),a.markForUpdateRenderData(!0),t.updateLabelUVs$(a))},this.updateLabelUVs$=function(e){var t;if(e instanceof P){var n=e.renderData;if(n){n.vertDirty=!1;var a=P.Assembler.getAssembler(e);null==a||null===(t=a.updateUVs)||void 0===t||t.call(a,e)}}},this.printAtlasTextures$=function(){if(ln.ENABLED){var e=E.instance.maxAtlasCount;for(var n in t.debugCanvases$){var a=t.debugCanvases$[n];if(a&&Number(n)<=e){var r=a.toDataURL("image/jpeg",ln.IMAGE_QUALITY);tn.logImage(r,.5)}}}},this.drawTexture$=function(e,n,a){var r,i,s,o,c=t.getTexture$(n);if(!c)return null;var l=c.getId(),u=t.collectInfo$.get(l);if(!u)return null;var d=null!==(r=u.x)&&void 0!==r?r:-1,h=null!==(i=u.y)&&void 0!==i?i:-1;if(-1===d||-1===h)return null;var f=e._texture,m=f.width,p=f.height;if(d+u.w>m||h+u.h>p)return null;var g=c.image;if(!g)return null;var v=a?cn.BLEEDING_SPACE:0,y=d+v,$=h+v,S=e._innerTextureInfos[l];if(!S){if(t.drawToAtlas$({atlas:e,texId:l,image:g,drawX:y,drawY:$,space:v}),ln.ENABLED){var E=u.components.size;t.drawDebugFrame$({image:g,texId:l,drawX:y,drawY:$,usageCount:E,space:v})}e._count++,S={texture:c,x:y,y:$},e._innerTextureInfos[l]=S}return{x:n.rect.x+(null!==(s=S.x)&&void 0!==s?s:y),y:n.rect.y+(null!==(o=S.y)&&void 0!==o?o:$),texture:e._texture}},this.drawToAtlas$=function(e){var t=e.atlas,n=e.image,a=e.drawX,r=e.drawY,i=e.space,s=t._texture;i>0&&(n.width<=cn.BLEED_SENSITIVE_SIZE||n.height<=cn.BLEED_SENSITIVE_SIZE)&&(s.drawTextureAt(n,a-i,r-i),s.drawTextureAt(n,a-i,r+i),s.drawTextureAt(n,a+i,r-i),s.drawTextureAt(n,a+i,r+i)),s.drawTextureAt(n,a,r)},this.drawDebugFrame$=function(e){var n=t.getAtlasIndex$(),a=t.debugCanvases$[n];if(a){var r=e.image,i=e.texId,s=e.drawX,o=e.drawY,c=e.usageCount,l=e.space,u=a.getContext("2d",{willReadFrequently:!0}),d=null==r?void 0:r.data;u&&d&&t.isDrawableImage(d)&&(t.drawDebugImageWithBleed$({ctx:u,image:r,drawX:s,drawY:o,space:l}),t.drawDebugOutlineAndOverlay$({ctx:u,image:r,drawX:s,drawY:o,space:l,usageCount:c}),t.drawDebugText$({ctx:u,image:r,drawX:s,drawY:o,space:l,texId:i}))}},this.drawDebugImageWithBleed$=function(e){var t=e.ctx,n=e.image,a=e.drawX,r=e.drawY,i=e.space,s=n.data;i>0&&(n.width<=cn.BLEED_SENSITIVE_SIZE||n.height<=cn.BLEED_SENSITIVE_SIZE)&&(t.drawImage(s,a-i,r-i),t.drawImage(s,a-i,r+i),t.drawImage(s,a+i,r-i),t.drawImage(s,a+i,r+i)),t.drawImage(s,a,r)},this.drawDebugOutlineAndOverlay$=function(e){var t=e.ctx,n=e.image,a=e.drawX,r=e.drawY,i=e.space,s=e.usageCount,o=a,c=r,l=n.width,u=n.height;i>0&&(o-=i,c-=i,l+=2*i,u+=2*i);var d=240*(1-Math.min(s/15,1));t.fillStyle="hsla(".concat(d,", 100%, 50%, 0.2)"),t.fillRect(o+.5,c+.5,l,u)},this.drawDebugText$=function(e){var t=e.ctx,n=e.drawX,a=e.drawY,r=e.space,i=e.texId;t.font=ln.FONT,t.textAlign="left",t.textBaseline="top";var s=t.measureText(i.replace("Tex.","")),o=ln.TEXT_PADDING,c=n-r+10,l=a-r+10;t.fillStyle="rgba(0, 50, 0, 0.8)",t.fillRect(c-o,l-o,s.width+2*o,ln.TEXT_HEIGHT+2*o),t.fillStyle="rgba(255, 255, 255, 0.95)",t.fillText(i,c,l)},this.isSameAtlas$=function(e,t){return!(!e||!t||e.atlasIndex!==t.atlasIndex)&&(e.packedInfo.fillRate===t.packedInfo.fillRate&&(e.packedInfo.width===t.packedInfo.width&&e.packedInfo.height===t.packedInfo.height))}}return t(e,[{key:"init",value:function(){this.listenEvents$(),this.overrideDynamicAtlasManager$(),ln.ENABLED&&this.createPendingDebugCanvas$()}},{key:"isDrawableImage",value:function(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement}}]),e}();d._RF.pop(),d._RF.push({},"f18351KuT9C+7suAM5eHst5","renderResultChallenge",void 0);var dn=Ludex.Utils.Error,hn="./wideframes",fn="".concat(hn,"/result-challenge.png"),mn="".concat(hn,"/update-challenge.png"),pn="".concat(hn,"/images/avatar-fallback.png"),gn={wideframe:{type:"image",depth:0,size:[952,492],position:[0,0]},playerPhoto:{type:"image",depth:-2,size:[160,160],position:[50,140],fallbackImage:pn},opponentPhoto:{type:"image",depth:-1,size:[160,160],position:[740,140],fallbackImage:pn},leftScore:{type:"text",name:"left-score",depth:3,font:"normal bold 44px",color:"#f2a62e",textAlign:"center",position:[123,372]},rightScore:{type:"text",name:"right-score",depth:3,font:"normal bold 44px",color:"#f2a62e",textAlign:"center",position:[820,372]},leftCrown:{type:"image",name:"crown",depth:3,size:[92,63],position:[80,80],image:"".concat(hn,"/images/crown-icon.png")},rightCrown:{type:"image",name:"crown",depth:3,size:[92,63],position:[775,80],image:"".concat(hn,"/images/crown-icon.png")}},vn={win:{name:"win-image",type:"image",depth:2,size:[277,144],position:[337.5,174],image:"".concat(hn,"/images/win.png")},lose:{name:"lose-image",type:"image",depth:2,size:[326,145],position:[313,173.5],image:"".concat(hn,"/images/lose.png")},draw:{name:"draw-image",type:"image",depth:2,size:[390,144],position:[281,174],image:"".concat(hn,"/images/draw.png")}},yn=function(){var e=n((function*(e){var t=dn.lift({}),n=dn.pipe(En(e),wn(e),An(e),Sn(e))(t),a=yield dn.applyAsync($n)(n);if(dn.isFailure(a)){var r=dn.extractFailure(a);return console.error(r),null}return dn.extractSuccess(a)}));return function(t){return e.apply(this,arguments)}}(),$n=function(e){return codex.frameCapture.captureAsync({name:"ResultChallenge",width:952,height:492,renderOptions:e})},Sn=function(e){return function(t){var n=e.isPlayerFinished,a=e.isOpponentFinished,r=n||a,i=r?"result-challenge-with-score-box":"result-challenge-without-score-box",s=r?fn:mn;return c(c({},t),{},{wideframe:c(c({},gn.wideframe),{},{image:s,name:i})})}},En=function(e){return function(t){return c(c({},t),{},{playerPhoto:c(c({},gn.playerPhoto),{},{name:e.playerId,image:e.playerPhoto}),opponentPhoto:c(c({},gn.opponentPhoto),{},{name:e.opponentId,image:e.opponentPhoto})})}},wn=function(e){return function(t){var n=e.isPlayerFinished,a=e.isOpponentFinished,r=e.playerScore,i=void 0===r?0:r,s=e.opponentScore,o=void 0===s?0:s;if(!(n||a))return t;var l=n?"".concat(i):"???",u=a?"".concat(o):"???";return c(c({},t),{},{leftScore:c(c({},gn.leftScore),{},{text:l}),rightScore:c(c({},gn.rightScore),{},{text:u})})}},An=function(e){return function(t){var n=bn(e);if("none"===n)return t;var a=vn[n];if("draw"===n)return c(c({},t),{},{statusImage:a});var r="win"===n?gn.leftCrown:gn.rightCrown;return c(c({},t),{},{crown:r,statusImage:a})}},bn=function(e){var t=e.playerScore,n=void 0===t?0:t,a=e.opponentScore,r=void 0===a?0:a,i=e.isPlayerFinished,s=e.isOpponentFinished;return i&&s?n===r?"draw":n>r?"win":"lose":"none"};d._RF.pop(),d._RF.push({},"46949HU2K9PdYlSXXZkfABn","renderShareLeaderboard",void 0);var Dn=Ludex.Utils.Error,Cn="./wideframes",Tn="".concat(Cn,"/share-leaderboard.png"),Rn="".concat(Cn,"/images/avatar-fallback.png"),Ln={wideframe:{name:"share-leaderboard",type:"image",depth:0,image:Tn,size:[1500,2e3],position:[0,0],fallbackImage:Rn},avatar:{type:"image",depth:-2,size:[510,510],position:[510,278],fallbackImage:Rn},leaderPhoto:{type:"image",depth:-1,size:[100,100],fallbackImage:Rn,position:[436,0]},leaderName:{type:"text",depth:1,font:"600 48px",position:[600,0]},leaderScore:{type:"text",depth:1,font:"600 48px",position:[100,0]}},Fn=function(){var e=n((function*(e){var t=Dn.lift({}),n=Dn.pipe(In(e),Mn(e),_n)(t),a=yield Dn.applyAsync(xn)(n);if(Dn.isFailure(a)){var r=Dn.extractFailure(a);return console.error(r),null}return Dn.extractSuccess(a)}));return function(t){return e.apply(this,arguments)}}(),xn=function(e){return codex.frameCapture.captureAsync({name:"ShareLeaderboard",width:1500,height:2e3,renderOptions:e})},_n=function(e){return c(c({},e),{},{wideframe:Ln.wideframe})},In=function(e){return function(t){return c(c({},t),{},{avatar:c(c({},Ln.avatar),{},{name:e.playerId,image:e.playerPhoto})})}},Mn=function(e){return function(t){for(var n=e.leaders,a=c({},t),r=0;r<n.length;r++){var i=n[r],s=i.id,o=i.name,l=i.photo,u=i.score,d=1292+180*r,h=1360+180*r;a["photo_".concat(s)]=c(c({},Ln.leaderPhoto),{},{position:[Ln.leaderPhoto.position[0],d],name:s,image:l}),a["name_".concat(s)]=c(c({},Ln.leaderName),{},{position:[Ln.leaderName.position[0],h],name:s,text:o}),a["score_".concat(s)]=c(c({},Ln.leaderScore),{},{position:[Ln.leaderScore.position[0],h],name:s,text:"".concat(u)})}return a}};d._RF.pop(),d._RF.push({},"c5f1cF6b7dGYLU3X1NOhOPG","renderShareScore",void 0);var Pn=Ludex.Utils,Nn=Pn.Error,kn=(Pn.Valid,Pn.Function),On=codex,Un=On.frameCapture,Gn=On.language,zn=On.monitorError,Bn="./wideframes",Hn="".concat(Bn,"/share-score.png"),Vn="".concat(Bn,"/images/avatar-fallback.png"),Yn={wideframe:{type:"image",name:"share-score",depth:0,image:Hn,size:[1500,2e3],position:[0,0]},avatar:{type:"image",depth:-1,size:[500,500],position:[500,410],fallbackImage:Vn},playerScore:{type:"text",name:"player-score",depth:1,font:"normal bold",color:"#f2a62e",textAlign:"center",position:[750,1120]},message:{type:"text",name:"message",depth:2,color:"#8f5543",textAlign:"center",position:[760,1560]}},jn=function(){var e=n((function*(e){var t=Nn.lift({}),n=Nn.pipe(Kn(e),Wn(e),Xn,Qn)(t),a=yield Nn.applyAsync(qn)(n);if(Nn.isFailure(a)){var r=Nn.extractFailure(a);return console.error(r),null}return Nn.extractSuccess(a)}));return function(t){return e.apply(this,arguments)}}(),qn=function(e){return Un.captureAsync({name:"ShareScore",width:1500,height:2e3,renderOptions:e})},Qn=function(e){return c(c({},e),{},{wideframe:Yn.wideframe})},Kn=function(e){return function(t){return c(c({},t),{},{avatar:c(c({},Yn.avatar),{},{name:"".concat(e.playerId),image:e.playerPhoto})})}},Wn=function(e){return function(t){var n=Yn.playerScore.font,a=Zn(),r=Jn();return c(c({},t),{},{playerScore:c(c({},Yn.playerScore),{},{text:"".concat(e.playerScore),font:"".concat(n," ").concat(r," ").concat(a,",")})})}},Xn=function(e){var t=Zn(),n=Jn(),a=ta(),r=c(c({},Yn.message),{},{font:"normal ".concat(n," ").concat(t,","),text:a});return c(c({},e),{},{message:r})},Zn=function(){var e=Gn.getCurrentLocale(),t=X[e],n=ea(t);return"".concat(n,"_LABEL")},Jn=function(){var e,t=Gn.getCurrentLocale();return null!==(e=W[t])&&void 0!==e?e:"104px"},ea=function(e){var t,n=e.split("/"),a=null!==(t=n[n.length-1])&&void 0!==t?t:"",r=a.lastIndexOf(".");return-1===r?a:a.substring(0,r)},ta=function(){try{return Gn.getText("share.canYouDoBetter")}catch(e){return null==zn||zn.sendException(kn.toError(e),{locale:Gn.getCurrentLocale(),message:"share.canYouDoBetter"}),"share.canYouDoBetter"}};d._RF.pop(),d._RF.push({},"3639a1RbypBKqHUo6gIZVdm","renderShareScoreWithInvite",void 0);var na=Ludex.Utils.Error,aa=codex,ra=aa.frameCapture,ia=aa.language,sa="./wideframes",oa="".concat(sa,"/invite-score.png"),ca="".concat(sa,"/images/avatar-fallback.png"),la={wideframe:{type:"image",name:"share-score-with-invite",depth:0,image:oa,size:[952,492],position:[0,0]},avatar:{type:"image",depth:-1,size:[160,160],position:[85,140],fallbackImage:ca},playerScore:{type:"text",name:"player-score",depth:1,font:"normal bold",color:"#f2a62e",textAlign:"center",position:[165,384]}},ua={en:"44px",ru:"40px"},da=function(){var e=n((function*(e){var t=na.lift({}),n=na.pipe(ma(e),pa(e),fa)(t),a=yield na.applyAsync(ha)(n);if(na.isFailure(a)){var r=na.extractFailure(a);return console.error(r),null}return na.extractSuccess(a)}));return function(t){return e.apply(this,arguments)}}(),ha=function(e){return ra.captureAsync({name:"ShareScore",width:952,height:492,renderOptions:e})},fa=function(e){return c(c({},e),{},{wideframe:la.wideframe})},ma=function(e){return function(t){return c(c({},t),{},{avatar:c(c({},la.avatar),{},{name:"".concat(e.playerId),image:e.playerPhoto})})}},pa=function(e){return function(t){var n=la.playerScore.font,a=ga(),r=va();return c(c({},t),{},{playerScore:c(c({},la.playerScore),{},{text:"".concat(e.playerScore),font:"".concat(n," ").concat(r," ").concat(a,",")})})}},ga=function(){var e=ia.getCurrentLocale(),t=X[e],n=ya(t);return"".concat(n,"_LABEL")},va=function(){var e,t=ia.getCurrentLocale();return null!==(e=ua[t])&&void 0!==e?e:"44px"},ya=function(e){var t,n=e.split("/"),a=null!==(t=n[n.length-1])&&void 0!==t?t:"",r=a.lastIndexOf(".");return-1===r?a:a.substring(0,r)};d._RF.pop(),d._RF.push({},"407a0rBEoFPs6GoXuwQofW2","renderUpdateChallenge",void 0);var $a=Ludex.Utils.Error,Sa="./wideframes",Ea="".concat(Sa,"/update-challenge.png"),wa="".concat(Sa,"/images/avatar-fallback.png"),Aa={wideframe:{type:"image",name:"update-challenge",depth:0,image:Ea,size:[952,492],position:[0,0]},playerPhoto:{type:"image",depth:-1,size:[160,160],position:[50,140],fallbackImage:wa},opponentPhoto:{type:"image",depth:-1,size:[160,160],position:[740,140],fallbackImage:wa}},ba=function(){var e=n((function*(e){var t=$a.lift({}),n=$a.pipe(Ta(e),Ca)(t),a=yield $a.applyAsync(Da)(n);if($a.isFailure(a)){var r=$a.extractFailure(a);return console.error(r),null}return $a.extractSuccess(a)}));return function(t){return e.apply(this,arguments)}}(),Da=function(e){return codex.frameCapture.captureAsync({name:"UpdateChallenge",width:952,height:492,renderOptions:e})},Ca=function(e){return c(c({},e),{},{wideframe:Aa.wideframe})},Ta=function(e){return function(t){return c(c({},t),{},{playerPhoto:c(c({},Aa.playerPhoto),{},{image:e.playerPhoto,name:e.playerId}),opponentPhoto:c(c({},Aa.opponentPhoto),{},{image:e.opponentPhoto,name:e.opponentId})})}};d._RF.pop(),d._RF.push({},"5cf47s8lohMlZGIaMKBpDK0","FrameCapture",void 0);var Ra,La,Fa,xa=codex.frameCapture,_a=function(){function e(){a(this,e)}var r;return t(e,[{key:"init",value:(r=n((function*(){xa.setRenderer("share-score",jn),xa.setRenderer("result-challenge",yn),xa.setRenderer("update-challenge",ba),xa.setRenderer("share-leaderboard",Fn),xa.setRenderer("share-score-with-invite",da)})),function(){return r.apply(this,arguments)})}]),e}();d._RF.pop(),d._RF.push({},"2f36c+IsKJAU5s61TqQdaJ6","HybridFileCache",void 0);var Ia=Ludex,Ma=Ia.Events,Pa=Ia.Configs.GameEngine.HybridFileCache,Na=Pa.Enabled,ka=Pa.PreviewMode,Oa=Pa.BuildMode,Ua=Ia.Utils,Ga=Ua.Object,za=Ua.Function,Ba=Ua.Json,Ha=Ua.Decorator,Va=codex,Ya=Va.event,ja=Va.storage,qa=Va.getBuildVersion,Qa=g.instance,Ka=Qa.downloader,Wa=Qa.pipeline,Xa=Qa.fetchPipeline,Za=/.*\/([-a-z0-9@]+)\.([^\.]+)$/,Ja=(Ra=Ha.throttle(1e3),Fa=e((La=function(){function e(){var t=this;a(this,e),this.supportTypes$=[],this.bundledFiles$={},this.originHandler$={},this.nativeAssetDictionary$={},this.initStorage$=n((function*(){return ja.addStorage("HybridFileCache",{commitId:"unknown",buildVersion:"0",cachedFiles:{},cachedBundles:{},cachedExtensions:{}},!0)})),this.checkCacheVersion$=n((function*(){var e=Oa.InvalidateMode,n=window.CommitId,a=qa().toString(),r=ja.getStorageData("HybridFileCache","commitId"),i=ja.getStorageData("HybridFileCache","buildVersion");ja.setStorageData("HybridFileCache","commitId",n),ja.setStorageData("HybridFileCache","buildVersion",a);var s=r!==n,o=i!==a;switch(e){case"version":o&&(yield t.clearCache$());break;case"commitId":s&&(yield t.clearCache$());break;default:(o||s)&&(yield t.clearCache$())}t.requestUpdateStorage()})),this.initSupportedTypes$=function(){t.supportTypes$=Oa.SupportedExtensions},this.setupBundledFiles$=n((function*(){try{if(!l||!Oa.Enabled)return;var e,n=[],a=i(t.supportTypes$);try{for(a.s();!(e=a.n()).done;){var r=e.value;t.getCachedBundles$(r)||n.push(t.downloadBundledFile$(r))}}catch(e){a.e(e)}finally{a.f()}n.length>0&&(yield za.allSettled(n))}finally{Ya.emit(Ma.BUNDLE_READY)}})),this.downloadBundledFile$=function(){var e=n((function*(e){try{var n=e.replace(".",""),a="./cache/bundle".concat(n.toUpperCase(),".").concat(n);"bundle"===e&&(a="./cache/bundleBUNDLE.json");var r=yield fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}),i=yield r.json();t.setBundledCache$(e,i)}catch(t){console.error("Hybrid File Cache: Downloaded bundled file",{type:e,error:t})}}));return function(t){return e.apply(this,arguments)}}(),this.injectOptimalFetchPipeline$=function(){if(ka.Enabled||Oa.Enabled){var e=Xa.pipes[2];if(e){Xa.remove(2),Xa.insert((function(t,n){try{e(t,n)}catch(e){console.error("Hybrid File Cache: optimized fetch pipeline",{error:e})}}),2)}}},this.injectOptimalLoadPipeline$=function(){if(ka.Enabled||Oa.Enabled){var e=Wa.pipes[2];if(e){Wa.remove(2),Wa.insert((function(t,n){try{e(t,n)}catch(e){console.warn("Hybrid File Cache: optimized load pipeline",{error:e}),n(e)}}),2)}}},this.injectCacheExtensionPipeline$=function(){if(ka.Enabled&&ka.CacheUuidExtension){var e={},n=function(n,a){n.output=n.input;for(var r=0;r<n.input.length;r++){var i=n.input[r];if(i.id){var s=t.getCacheExtension$(i.id);s?(i.url=i.url.replace(i.ext,s),i.ext=s,e[i.id]=!0):e[i.id]=!1}}a(null,null)},a=function(n){return function(a,r){for(var i=o(a.input),s=0;s<i.length;s++){var c=i[s];if(c.id){var l,u=e[c.id];if(!Ga.hasOwn(t.nativeAssetDictionary$,c.id))t.nativeAssetDictionary$[c.id]=null!==(l=c.isNative)&&void 0!==l&&l;u&&(c.isNative=!0)}}a.input.length,n(a,r)}},r=function(n,a){n.output=n.input;for(var r=0;r<n.output.length;r++){var i,s=n.output[r];if(s.id){var o=null!==(i=t.nativeAssetDictionary$[s.id])&&void 0!==i&&i;s.isNative=o,e[s.id]||t.setCacheExtension$(s.id,s.ext)}}a(null,null)};Wa.insert(n,1),Xa.insert(n,1),Wa.insert(r,3),Xa.insert(r,3);var i=o(Wa.pipes),s=o(Xa.pipes),c=i[2];c&&(Wa.pipes[2]=a(c));var l=s[2];l&&(Xa.pipes[2]=a(l));var u=o(Wa.pipes),d=o(Xa.pipes);console.debug("Hybrid File Cache: inject cache extension pipelines",i,s,u,d)}},this.saveOriginDownloaders$=function(){var e,n=i(t.supportTypes$);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=Ka.handlers[a];r&&(t.originHandler$[a]=r)}}catch(e){n.e(e)}finally{n.f()}},this.registerCustomDownloader$=function(){var e,n=i(t.supportTypes$);try{for(n.s();!(e=n.n()).done;){var a=e.value;"bundle"!==a&&Ka.register(a,t.downloadFile$(a))}}catch(e){n.e(e)}finally{n.f()}},this.listenEvents$=function(){Ya.on(Ma.SCENE_LOADED,t.requestUpdateStorage),h.on(z.CLEAR_HYBRID_FILE_CACHE,t.clearCache$)},this.getDownloadHandler$=function(e){var n;return null!==(n=t.originHandler$[e])&&void 0!==n?n:null},this.downloadFile$=function(e){return function(n,a,r){var i=t.getCache$(e,n);if(i)return r(null,i);var s=t.getDownloadHandler$(e);if(!s)return r(new Error("Downloader not found"),null);s(n,a,(function(a,i){return!a&&t.setCache$(e,n,i),r(a,i)}))}},this.getCacheKey$=function(e,t){var n=t.match(Za);if(!n)return null;var a=s(n,3),r=(a[0],a[1]),i=a[2];return!i||e.indexOf(i)<0?null:"".concat(r,":").concat(e)},this.validateDataType$=function(e){Array.isArray(e)&&Ga.hasOwn(e[0],"__type__");return!0},this.setCache$=function(e,n,a){var r=t.getCacheKey$(e,n);if(r&&t.validateDataType$(a)){var i=Ba.clone(a);ja.setStorageData("HybridFileCache","cachedFiles",u({},r,null!=i?i:{})),t.requestUpdateStorage()}},this.getCache$=function(e,n){var a=t.getCacheKey$(e,n);if(!a)return null;var r=t.getFileCaches$()[a];return r||(r=t.getBundledCache$(e,a)),r?Ba.clone(r):null},this.getFileCaches$=function(){var e;return null!==(e=ja.getStorageData("HybridFileCache","cachedFiles"))&&void 0!==e?e:{}},this.getCachedBundles$=function(e){var n=ja.getStorageData("HybridFileCache","cachedBundles");if(!n)return null;var a=n[e];return a?(t.bundledFiles$[e]=a,a):null},this.getBundledCache$=function(e,n){var a,r=t.bundledFiles$[e];return r&&null!==(a=r[n.replace(":".concat(e),"")])&&void 0!==a?a:null},this.setBundledCache$=function(e,n){t.bundledFiles$[e]=n,ja.setStorageData("HybridFileCache","cachedBundles",u({},e,n)),t.requestUpdateStorage()},this.getCacheExtension$=function(e){return t.getCachedExtensions$()[e]},this.setCacheExtension$=function(e,n){ja.setStorageData("HybridFileCache","cachedExtensions",u({},e,n)),t.requestUpdateStorage()},this.getCachedExtensions$=function(){var e;return null!==(e=ja.getStorageData("HybridFileCache","cachedExtensions"))&&void 0!==e?e:{}},r(this,"requestUpdateStorage",Fa,this),this.clearCache$=function(){ja.initStorageData("HybridFileCache","cachedFiles",{}),ja.initStorageData("HybridFileCache","cachedBundles",{}),ja.updateToWebStorage("HybridFileCache",!0)}}var c;return t(e,[{key:"init",value:(c=n((function*(){Na&&(yield this.initStorage$(),yield this.checkCacheVersion$(),this.initSupportedTypes$(),this.injectOptimalLoadPipeline$(),this.injectOptimalFetchPipeline$(),this.injectCacheExtensionPipeline$(),this.saveOriginDownloaders$(),this.registerCustomDownloader$(),this.setupBundledFiles$(),this.listenEvents$(),console.debug("Hybrid File Cache: Initialized",{supportTypes:this.supportTypes$}))})),function(){return c.apply(this,arguments)})}]),e}()).prototype,"requestUpdateStorage",[Ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){ja.updateToWebStorage("HybridFileCache",!1)}}}),La);d._RF.pop(),d._RF.push({},"14b76Yew19JgY7K+L9F5mmu","Languages",void 0);var er=Ludex,tr=er.Events,nr=er.Utils.Array,ar=codex,rr=ar.player,ir=ar.event,sr=ar.language,or=ar.monitorError,cr=function(){function e(){var t=this;a(this,e),this.initDefaultLanguage$=n((function*(){sr.add("en",de,!0),t.setLanguage$("en")})),this.initPlayerLanguage$=n((function*(){var e,n=sr.getPlayerLanguage();if(!n||!t.isSupportedLocale$(n))return console.warn("Language ".concat(n," not supported. Overriding with default language")),void t.setLanguage$("en",!0);yield t.addLanguage$(n);var a=null!==(e=rr.getPlayerDataByKey("isFirstLogin"))&&void 0!==e&&e;t.setLanguage$(n,a)})),this.isSupportedLocale$=function(e){return nr.has(Z,e)},this.listenEvent$=function(){ir.on(tr.REQUEST_LANGUAGE,t.handleLanguageRequested$),h.on(tr.REQUEST_LANGUAGE,t.handleLanguageRequested$),h.on(z.PRELOAD_LANGUAGE,t.handlePreloadLanguage$),h.on(z.CHOOSE_LANGUAGE,t.handleChooseLanguage$)},this.addLanguage$=function(){var e=n((function*(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=yield t.getLangData$(e);sr.add(e,a,n)}));return function(t){return e.apply(this,arguments)}}(),this.setLanguage$=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];sr.choose(e),t&&rr.setSetting("language",e)},this.handlePreloadLanguage$=function(){var e=n((function*(e){var n=e.locale,a=e.onLoad,r=e.onError;if(!t.isSupportedLocale$(n))return console.warn("Preload language ".concat(n," not found")),void(null==r||r(new Error("Language ".concat(n," not found"))));try{yield t.addLanguage$(n),null==a||a(n)}catch(e){var i=t.toError$(e,"handleLanguageRequested");console.error(i),null==or||or.sendException(i),null==r||r(e)}}));return function(t){return e.apply(this,arguments)}}(),this.handleChooseLanguage$=function(e){var n=e.locale,a=e.saveToPlayerData,r=void 0!==a&&a;if(t.isSupportedLocale$(n))try{t.setLanguage$(n,r)}catch(e){var i=t.toError$(e,"handleLanguageRequested");console.error(i),null==or||or.sendException(i)}else console.warn("Choose language ".concat(n," not found"))},this.getLangData$=function(){var e=n((function*(e){if("en"===e)return de;var t=yield J.loadJsonAsync(ee[e]);if(null===t)throw new Error("Language ".concat(e," not found"));if(null===t.json)throw new Error("Language ".concat(e," is empty"));return t.json}));return function(t){return e.apply(this,arguments)}}(),this.handleLanguageRequested$=function(){var e=n((function*(e){var n=e.locale,a=e.saveToPlayerData,r=void 0!==a&&a,i=e.onLoad,s=e.onError;if(!t.isSupportedLocale$(n))return console.warn("Request language ".concat(n," not found")),void(null==s||s(new Error("Language ".concat(n," not found"))));try{yield t.addLanguage$(n),null==i||i(n),t.setLanguage$(n,r)}catch(e){var o=t.toError$(e,"handleLanguageRequested");console.error(o),null==or||or.sendException(o),null==s||s(o)}}));return function(t){return e.apply(this,arguments)}}(),this.toError$=function(e,t){return e instanceof Error?e:"string"==typeof e?new Error("LanguagePlugin: ".concat(e)):new Error("LanguagePlugin: Unknown error in module: <".concat(t,">"))}}var r;return t(e,[{key:"init",value:(r=n((function*(){try{yield this.initDefaultLanguage$(),this.listenEvent$(),yield this.initPlayerLanguage$()}catch(t){var e=this.toError$(t,"handleLanguageRequested");console.error(e),null==or||or.sendException(e)}})),function(){return r.apply(this,arguments)})}]),e}();d._RF.pop(),d._RF.push({},"fb33bK/6Y5FAas5AwmmBM/X","Leaderboards",void 0);var lr=Ludex,ur=lr.Configs,dr=ur.Mockup,hr=dr.Leaderboards,fr=dr.GameSDK.Player,mr=ur.Leaderboards,pr=lr.Utils.Number,gr=codex.leaderboard,vr=function(){function e(){var t=this;a(this,e),this.handleWhenGameSDKStarted$=function(){hr.Enabled?t.setupLeaderboardsMockup$():t.setupLeaderboards$()},this.setupLeaderboards$=n((function*(){t.setupLeaderboardByConfigs$()})),this.setupLeaderboardByConfigs$=function(){var e,t=mr.LeaderboardList,n=i(t);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=a.Id,s=a.Name;gr.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:r})}}catch(e){n.e(e)}finally{n.f()}},this.setupLeaderboardsMockup$=n((function*(){t.setupMockGlobalLeaderboards$(),t.setupMockFriendsLeaderboard$(),t.setupMockGlobalTournamentLeaderboard$()})),this.setupMockGlobalLeaderboards$=n((function*(){var e,t=hr.NumOfLeaders,n=mr.LeaderboardList,a=i(n);try{for(a.s();!(e=a.n()).done;){var r=e.value,s=r.Name,o=r.Id;if(s){var c=yield gr.createLeaderboardAsync({_id:o,name:s,numberOfLeaders:pr.random(t.Max-t.Min)+t.Min});gr.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:c})}}}catch(e){a.e(e)}finally{a.f()}})),this.setupMockFriendsLeaderboard$=n((function*(){var e="Mock Friends Leaderboard",t=0,n=fr.ConnectedPlayers;n.Enabled&&(t=pr.random(n.NumOfPlayers-1)+1);var a=yield gr.createLeaderboardAsync({_id:"friends-leaderboard-id",name:e,numberOfLeaders:t});gr.addLeaderboard({name:e,type:"friends",autoSortRank:!0,leaderboardId:a})})),this.setupMockGlobalTournamentLeaderboard$=n((function*(){(yield te.requestTournamentDataAsync()).forEach((function(e){var t=e.payload.leaderboardId;t&&(gr.isExistLeaderboardId(t)||gr.addLeaderboard({type:"tournament",name:t,autoSortRank:!0,leaderboardId:t}))}))}))}return t(e,[{key:"init",value:function(){this.handleWhenGameSDKStarted$()}}]),e}();d._RF.pop(),d._RF.push({},"e7bf73g4jJGuI9FqvW5YBsS","PerformanceMonitor",void 0);var yr=Ludex,$r=yr.Utils.Mark,Sr=yr.Events,Er=yr.Configs.PerformanceMonitor.FpsTracking,wr=codex.event,Ar=function(){function e(){var t=this;a(this,e),this.markName$="FPS Tracking",this.listenEvents$=function(){wr.catchUp(Sr.GAME_READY,t.handleStartTraceFps$)},this.unListenEvents$=function(){y.off(T.EVENT_AFTER_UPDATE,t.handleLateUpdate$)},this.handleStartTraceFps$=function(){t.startTraceFps$(),y.on(T.EVENT_AFTER_UPDATE,t.handleLateUpdate$)},this.startTraceFps$=function(){t.mark&&(t.mark.measure(t.markName$),t.mark.start(t.markName$))},this.handleLateUpdate$=function(){if(t.mark){if(t.fpsTraceDuration$-=h.deltaTime,t.fpsTraceDuration$<=0&&!t.traceStopped$)return t.traceStopped$=!0,t.unListenEvents$(),t.updateFPS$(),void t.mark.stop(t.markName$);t.fpsTraceIntervalTimer$-=h.deltaTime,t.fpsTraceIntervalTimer$>0||(t.fpsTraceIntervalTimer$=t.fpsTraceInterval$,t.updateFPS$(),t.mark.stop(t.markName$),t.startTraceFps$())}},this.updateFPS$=function(){var e,n;if(t.mark){var a=t.getFPS$(),r=t.getDrawCalls$(),i=t.getDeviceRender$(),s=t.getTextureMemory$();t.minFps$=Math.min(null!==(e=t.minFps$)&&void 0!==e?e:a,a),t.maxFps$=Math.max(null!==(n=t.maxFps$)&&void 0!==n?n:0,a),t.mark.putMetric(t.markName$,"FPS Metric",a),t.mark.putAttr(t.markName$,"Page Title",document.title),t.mark.putAttr(t.markName$,"Device Render",i),t.mark.putAttr(t.markName$,"Draw Calls",r.toString()),t.mark.putAttr(t.markName$,"Texture Memory",s.toFixed(2)),t.mark.putAttr(t.markName$,"Min FPS",t.minFps$.toString()),t.mark.putAttr(t.markName$,"Max FPS",t.maxFps$.toString()),console.debug("FPS: ".concat(a," Min: ").concat(t.minFps$," Max: ").concat(t.maxFps$,", draw calls: ").concat(r,", texture memory: ").concat(s.toFixed(2),"MB"))}},this.getFPS$=function(){if(!y.root)return 0;var e=y.root.fps;return Math.floor(e)||0},this.getDrawCalls$=function(){return y.root&&y.root.device.numDrawCalls||0},this.getDeviceRender$=function(){return y.root&&y.root.device.renderer||"Unknown"},this.getTextureMemory$=function(){return y.root&&y.root.device.memoryStatus.textureSize/1048576||0}}return t(e,[{key:"mark",get:function(){return Er.Enabled?$r:null}},{key:"init",value:function(){var e=Er.TrackingDuration,t=Er.TrackingInterval;this.mark&&(this.fpsTraceDuration$=null!=e?e:60,this.fpsTraceInterval$=null!=t?t:10,this.fpsTraceIntervalTimer$=this.fpsTraceInterval$,this.traceStopped$=!1,this.listenEvents$())}}]),e}();d._RF.pop(),d._RF.push({},"58248LBip1DBrMjK0UWw2rM","RemoteConfig",void 0);var br=Ludex.Events,Dr=codex.event,Cr=function(){function e(){var t=this;a(this,e),this.listenEvents$=function(){Dr.on(br.REQUEST_HOT_RELOAD,t.handleHotReload$),Dr.on(br.REQUEST_UPDATE_CONFIG,t.handleUpdateConfig$)},this.handleHotReload$=function(){h.restart()},this.handleUpdateConfig$=function(e){if("Gameplay"===e.type){h.emit(z.GAMEPLAY_UPDATE_CONFIG,e.config);var t=e.id,n=e.type;Dr.emit(br.REMOTE_CONFIG_UPDATED,{id:t,type:n})}}}return t(e,[{key:"init",value:function(){this.listenEvents$()}}]),e}();d._RF.pop(),d._RF.push({},"c34a93D1BREiKms1T21AkQS","PluginsManager",void 0);var Tr=Ludex.Configs,Rr=Tr.Languages,Lr=Tr.Leaderboards,Fr=Tr.RemoteConfig,xr=Tr.FrameCapture,_r=Tr.DailyRewards,Ir=Tr.AdaptivePerformance,Mr=Tr.Debugger,Pr=Mr.CanvasRecorder,Nr=Mr.Profiler,kr=Tr.GameEngine,Or=kr.HybridFileCache,Ur=kr.DynamicAssets,Gr=kr.DynamicAtlas,zr=function(){function e(){a(this,e),this.initHybridFileCache$=function(){Or.Enabled&&(new Ja).init()}}return t(e,[{key:"init",value:function(){this.initHybridFileCache$(),console.debug("Plugins Manager: Initialized")}},{key:"initLanguages",value:function(){Rr.Enabled&&(new cr).init()}},{key:"initLeaderboards",value:function(){Lr.Enabled&&(new vr).init()}},{key:"initRemoteConfig",value:function(){Fr.Enabled&&(new Cr).init()}},{key:"initDynamicAtlas",value:function(){Gr.OptimizeAtlas.Enabled&&(E.instance.enabled&&(new un).init())}},{key:"initDynamicAssets",value:function(){Ur.Enabled&&(new Vt).init()}},{key:"initCanvasRecorder",value:function(){Pr.Enabled&&(new $t).init()}},{key:"initPerformanceMonitor",value:function(){Nr.Enabled&&(new Ar).init()}},{key:"initAdaptivePerformance",value:function(){Ir.Enabled&&(new vt).init()}},{key:"initFrameCapture",value:function(){xr.Enabled&&(new _a).init()}},{key:"initDailyRewards",value:function(){_r.Enabled&&(new bt).init()}}]),e}();d._RF.pop(),d._RF.push({},"ac8b03T+rFB061sXoEEsCUH","SceneManager",void 0);var Br=codex,Hr=Br.event,Vr=Br.monitorError,Yr=Ludex,jr=Yr.Events,qr=Yr.Configs.PerformanceMonitor,Qr=Yr.Utils,Kr=Qr.Mark,Wr=Qr.Function,Xr=GameSDK,Zr=function(){function e(){var t=this;a(this,e),this.markName$="Load Scene",this.testScene$={},this.isClearedMark$=!1,this.callbackSwitchScene$=null,this.mutex$=Wr.mutex(),this.listenEvents$=function(){Hr.catchUp(jr.MARK_IS_TEST_SCENE,t.setTestScene$),Hr.on(jr.SWITCH_SCENE,t.switchScene$),Hr.on(jr.PRELOAD_SCENE,t.preloadScene$)},this.correctSceneName$=function(e){var n=y.getScene(),a=t.getTestScene$();return a?a===(null==n?void 0:n.name)?null:a:null!=n&&n.isValid&&e===n.name?null:e},this.switchScene$=function(){var e=n((function*(e){var n=e.sceneName,a=e.sceneData,r=t.correctSceneName$(n);console.debug("Switching",r,null!=a?a:{}),r&&(re.isSceneLoaded(r)||ne.showLoadingFullScreen(r),t.startScene$(c(c({},e),{},{sceneName:r})))}));return function(t){return e.apply(this,arguments)}}(),this.startScene$=function(){var e=n((function*(e){var n=e.sceneName,a=e.sceneData,r=yield t.mutex$.use(n);try{t.startMeasure$("start",e);var i=yield t.loadSceneAsync$(n,t.onSceneProgress$),s=yield t.runSceneAsync$(i);t.setSceneData$(s,null!=a?a:{}),re.markIsSceneLoaded(n),Hr.emit(jr.SCENE_LOADED,{sceneName:n}),t.clearTestMark$(),t.stopMeasure$(),t.handleSceneLaunched$(n,a)}catch(e){var o=Wr.toError(e);console.warn("SceneManager.startScene",o),t.stopMeasure$(!1)}finally{r.release()}}));return function(t){return e.apply(this,arguments)}}(),this.preloadScene$=function(){var e=n((function*(e){var n=e.sceneName,a=yield t.mutex$.use(n);try{t.startMeasure$("preload",e),yield t.loadSceneAsync$(n,t.onSceneProgress$),re.markIsSceneLoaded(n),Hr.emit(jr.SCENE_LOADED,{sceneName:n,isPreload:!0}),t.stopMeasure$(),a.release()}catch(e){var r=Wr.toError(e);console.warn("SceneManager.preloadScene",r),t.stopMeasure$(!1),a.release()}}));return function(t){return e.apply(this,arguments)}}(),this.loadSceneAsync$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,a){var r=_.main;r?r.loadScene(e,null!=t?t:null,(function(e,t){e?a(e):n(t)})):a(new Error("Main bundle not found"))}))},this.runSceneAsync$=function(e){return new Promise((function(t,n){y.runScene(e,void 0,(function(e,a){if(e)return n(e);if(!a)throw new Error("Scene not found");t(a)}))}))},this.startMeasure$=function(e,n){if(t.mark){var a=n.sceneName;console.groupCollapsed("üì¶ ".concat(a,": ").concat(e," progress")),t.mark.measure(t.markName$),t.mark.putAttr(t.markName$,"Cancel","false"),t.mark.putAttr(t.markName$,"Success","false"),t.mark.putMetric(t.markName$,a),t.mark.start(t.markName$)}},this.stopMeasure$=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.mark&&(t.mark.rmAttr(t.markName$,"File"),t.mark.putAttr(t.markName$,"Success",e?"true":"false"),t.mark.stop(t.markName$),console.groupEnd())},this.onSceneProgress$=function(e,n,a){var r=e/n;t.mark&&t.mark.putAttr(t.markName$,"Last File","".concat(a.id," (").concat(a.ext,")"));var i=Math.floor(70*r+30);Xr.setLoadingProgress(i)},this.clearTestMark$=function(){t.isClearedMark$||(Hr.clear(jr.MARK_IS_TEST_SCENE),t.isClearedMark$=!0)},this.handleSceneLaunched$=function(e,n){var a;ne.hideLoadingFullScreen(e),ae.switchSceneTracking(),null==Vr||Vr.addMetadata({currentScene:e}),null===(a=t.callbackSwitchScene$)||void 0===a||a.call(t,{sceneName:e,sceneData:n}),Hr.emit(jr.SCENE_LAUNCHED,{sceneName:e}),y.once(T.EVENT_AFTER_RENDER,(function(){Hr.emit(jr.SCENE_RENDERED,{sceneName:e})}))},this.getTestScene$=function(){var e;return null!==(e=Object.keys(t.testScene$)[0])&&void 0!==e?e:null},this.setTestScene$=function(e){var n=e.sceneName;console.warn("SceneManager.setTestScene",n),t.testScene$[n]=!0},this.onSwitchScene=function(e){t.callbackSwitchScene$=e},this.setSceneData$=function(e,t){if(t&&("data"in e||e.scene.attr({data:{}}),"data"in e)){var n=e.data||{};e.scene.attr({data:c(c({},n),t)}),console.debug("SceneManager.setSceneData",{sceneName:e.name,sceneData:t,currentData:n})}}}return t(e,[{key:"init",value:function(){this.listenEvents$(),console.debug("Scene Manager: Initialized")}},{key:"mark",get:function(){return qr.LoadResources?Kr:null}}]),e}();d._RF.pop(),d._RF.push({},"617b2SRAL5CyL75C998xBnx","ScreenManager",void 0);var Jr=Ludex,ei=Jr.Events,ti=Jr.Utils,ni=ti.Object,ai=ti.Valid,ri=ti.Time,ii=codex,si=ii.event,oi=ii.monitorError;function ci(e){return"ready"===e.state?(e.screen.node.removeFromParent(),e.screen.node.destroy(),{state:"prefab",order:e.order,name:e.name,prefab:e.prefab,useCount:e.useCount}):"prefab"===e.state?c({},e):{state:"queued",order:e.order,name:e.name}}var li=function(){function e(){var t=this;a(this,e),this.screens$={},this.onPrefabReadyCallbacks$={},this.bindEventHandlers$=function(){si.on(ei.OPEN_SCREEN,t.handleOpenScreen$),si.on(ei.CLOSE_SCREEN,t.handleCloseScreen$),si.on(ei.PRELOAD_SCREEN,t.handlePreloadScreen$),si.on(ei.PRELOAD_SCREENS,t.handlePreloadScreens$),si.on(ei.SWITCH_SCENE,t.handleSwitchScene$)},this.handleOpenScreen$=function(e){t.openScreen(e.screenName,e.screenData)},this.handleCloseScreen$=function(e){t.closeScreen(e.screenName,!0)},this.handlePreloadScreen$=function(e){var n=e.screenName;t.addScreenQueues$([n]);var a=t.screens$[n];"queued"===(null==a?void 0:a.state)&&t.loadScreen$(a)},this.handlePreloadScreens$=function(){var e=y.getScene();t.validateScene$(e)&&(t.initScreens$(e),t.preloadScreens$())},this.handleSwitchScene$=function(){t.resetAllScreenParents$(),t.onPrefabReadyCallbacks$={}},this.resetAllScreenParents$=function(){for(var e in t.screens$){var n=t.screens$[e];void 0!==n&&(t.screens$[e]=ci(n))}},this.validateScene$=function(e){return!!e||(console.warn("No scene found for preloading screens"),!1)},this.initScreens$=function(e){var n=t.getScreenHolder$();if(null!=n&&n.enabled){var a,r=n.screens,s=i(r);try{for(s.s();!(a=s.n()).done;){var o=a.value,l=ie[o.key];if(l){var u=t.screens$[l];t.screens$[l]=u?c(c({},u),{},{order:o.depth}):{state:"queued",order:o.depth,name:l}}}}catch(e){s.e(e)}finally{s.f()}var d=e.getComponentsInChildren("BaseScreen");if(!ai.isEmpty(d)){var h=d.map((function(e){return null==e?void 0:e.node.name})).join(", ");console.info("üì∫ Active Screens in ".concat(e.name,": ").concat(h)),t.addScreens$(d)}}},this.getScreenHolder$=function(){var e,t=y.getScene();return null!==(e=null==t?void 0:t.getComponentInChildren("Screens"))&&void 0!==e?e:null},this.addScreens$=function(e){for(var n=0;n<e.length;n++){var a,r=e[n];if(r){var i=r.node.name;if(t.isScreenNameValid$(i)){var s=t.screens$[i],o=null!==(a=null==s?void 0:s.order)&&void 0!==a?a:0;t.screens$[i]={state:"ready",order:o,screen:r,prefab:r.node,name:i,useCount:0}}else console.warn("ScreenManager.addScreens: Invalid screen name ".concat(i))}else console.warn("ScreenManager.addScreens: Invalid screen ".concat(n))}t.reorderScreens$()},this.isScreenNameValid$=function(e){return ai.isString(e)&&ni.vals(ie).includes(e)},this.addScreenQueues$=function(e){var n=t.getScreenHolder$();if(null!=n&&n.isValid){var a,r=i(e);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(t.isScreenNameValid$(s))void 0===t.screens$[s]&&(t.screens$[s]={state:"queued",order:0,name:s});else console.warn("ScreenManager.addScreenQueues: Invalid screen name ".concat(s))}}catch(e){r.e(e)}finally{r.f()}}else console.warn("ScreenManager.addScreenQueues: No valid screen holder found")},this.loadScreen$=function(){var e=n((function*(e){try{t.screens$[e.name]=c(c({},e),{},{state:"loading"});var n=yield J.loadPrefabAsync("screens/".concat(e.name));if(null===n)throw new Error("ScreenManager.loadScreen: Failed to load prefab: ".concat(e.name));t.screens$[e.name]=c(c({},e),{},{state:"prefab",prefab:n,useCount:0}),console.debug("ScreenManager.loadScreen: ".concat(e.name," loaded successfully")),t.emitPrefabReady$(e.name)}catch(n){console.warn("ScreenManager.loadScreen: Failed to load ".concat(e.name),n),t.screens$[e.name]={state:"queued",order:e.order,name:e.name}}}));return function(t){return e.apply(this,arguments)}}(),this.preloadScreens$=function(){var e=t.getScreenHolder$();if(null!=e&&e.isValid&&null!=e&&e.autoPreload){var n,a=Object.values(t.screens$).sort((function(e,t){return e.order-t.order})),r=i(a);try{for(r.s();!(n=r.n()).done;){var s=n.value;"queued"===s.state&&t.loadScreen$(s)}}catch(e){r.e(e)}finally{r.f()}}},this.getScreen$=function(){var e=n((function*(e){var n=t.getScreenHolder$();if(null==n||!n.isValid)throw new Error("ScreenManager.getScreen: Invalid screen holder");if("ready"===e.state)return e.screen;if(!(e.prefab instanceof N))throw new Error("ScreenManager.getScreen: Invalid prefab ".concat(e.name));var a=k(e.prefab);a.name=e.name;var r=a.getComponent("BaseScreen");if(!r)throw new Error("ScreenManager.getScreen: Invalid screen ".concat(e.name));return n.node.addChild(a),a.active=!1,t.screens$[e.name]=c(c({},e),{},{state:"ready",screen:r}),t.reorderScreens$(),console.debug("ScreenManager.getScreen: Retrieved ".concat(e.name),e),r}));return function(t){return e.apply(this,arguments)}}(),this.reorderScreens$=function(){var e=[];for(var n in t.screens$){var a=t.screens$[n];"ready"===(null==a?void 0:a.state)&&null!=a&&a.screen.isValid&&e.push(a)}e.sort((function(e,t){return e.order-t.order}));for(var r=0;r<e.length;r++){var i,s=e[r];null!=s&&null!==(i=s.screen)&&void 0!==i&&i.isValid&&s.screen.node.setSiblingIndex(r)}},this.openScreen=function(){var e=n((function*(e,n){if(t.isScreenNameValid$(e)){var a=t.getOrTryAddScreen$(e);if(void 0!==a){if("ready"!==a.state&&"prefab"!==a.state)return"queued"===a.state&&t.loadScreen$(a),yield t.queueScreen$(e,n);try{se.setBlockInput(!0);var r=yield t.getScreen$(a);if(null==r||!r.isValid)throw new Error("ScreenManager.performScreenOpen: Invalid screen ".concat(e));t.incrementUseCount$(e),yield t.showScreen$(r,e,n)}catch(t){console.error("ScreenManager.openScreen: Error opening ".concat(e),t)}finally{se.setBlockInput(!1)}}else console.warn("ScreenManager.openScreen: Screen ".concat(e," not found"))}}));return function(t,n){return e.apply(this,arguments)}}(),this.queueScreen$=function(e,a){var r;console.debug("ScreenManager.queueScreen: Queuing ".concat(e));var i=null!==(r=t.onPrefabReadyCallbacks$[e])&&void 0!==r?r:[];return new Promise((function(r){var s=function(){var i=n((function*(){yield t.openScreen(e,a),r()}));return function(){return i.apply(this,arguments)}}();t.onPrefabReadyCallbacks$[e]=[].concat(o(i),[s])}))},this.incrementUseCount$=function(e){var n=t.screens$[e];"ready"!==(null==n?void 0:n.state)&&"prefab"!==(null==n?void 0:n.state)||(t.screens$[e]=c(c({},n),{},{useCount:n.useCount+1}))},this.showScreen$=function(){var e=n((function*(e,n,a){var r={screenName:n,screenData:a};si.emit(ei.OPENING_SCREEN,r),yield ri.sleepAsync(0),e.node.active=!0,e.open(a),t.updateAnalytics$(n),t.reorderScreens$()}));return function(t,n,a){return e.apply(this,arguments)}}(),this.closeScreen=function(){var e=n((function*(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isScreenNameValid$(e)){var a=t.screens$[e];if(void 0!==a){if("ready"!==a.state)return console.debug("ScreenManager.closeScreen: ".concat(e," is not ready")),void delete t.onPrefabReadyCallbacks$[e];try{if(!a.screen.isValid||!a.screen.node.active)return;si.emit(ei.CLOSING_SCREEN,{screenName:e}),a.screen.close(),n&&t.updateAnalytics$(e,!1)}catch(t){console.error("ScreenManager.closeScreen: Error closing ".concat(e),t)}}else console.debug("ScreenManager.closeScreen: Screen ".concat(e," not found"))}}));return function(t){return e.apply(this,arguments)}}(),this.updateAnalytics$=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ae.trackCurrentPage(e,t),t?null==oi||oi.addMetadata({currentScreen:e}):null==oi||oi.removeMetadata("currentScreen")},this.closeAllScreens=function(){for(var e in t.screens$)t.closeScreen(e,false)},this.getOrTryAddScreen$=function(e){var n=t.screens$[e];return void 0===n?(console.debug("ScreenManager.getOrTryAddScreen: Adding new screen (".concat(e,") to queue")),t.addScreenQueues$([e]),t.screens$[e]):n},this.emitPrefabReady$=function(e){var n,a,r=null!==(n=t.onPrefabReadyCallbacks$[e])&&void 0!==n?n:[],s=i(r);try{for(s.s();!(a=s.n()).done;){(0,a.value)()}}catch(e){s.e(e)}finally{s.f()}delete t.onPrefabReadyCallbacks$[e]}}return t(e,[{key:"init",value:function(){this.bindEventHandlers$(),console.debug("Screen Manager: Initialized")}}]),e}();d._RF.pop(),d._RF.push({},"9d892ZsSyxHSITF2VHJ1zpy","LudosSystem",void 0);var ui=Ludex,di=ui.Configs,hi=di.Core,fi=di.Ads,mi=di.Match,pi=di.Player,gi=di.GameEngine.HybridFileCache,vi=ui.Events,yi=ui.Plugins.Analytics,$i=(void 0===yi?{}:yi).Events,Si=ui.Utils,Ei=Si.Device,wi=Si.Time,Ai=codex,bi=Ai.context,Di=Ai.event,Ci=Ai.analytics,Ti=Ai.monitorError;new(t((function e(){var t=this;a(this,e),this.adsManager$=null,this.matchManager$=null,this.playerManager$=null,this.logEngineReady$=function(){Di.catchUp(vi.ANALYTICS_READY,(function(){$i&&Ci.event($i.ENGINE_READY)}))},this.createManager$=function(){t.sceneManager$=new Zr,t.screenManager$=new li,t.engineManager$=new Pe,t.layoutManager$=new Qe,t.pluginsManager$=new zr,fi.Enabled&&(t.adsManager$=new we),mi.Enabled&&(t.matchManager$=new rt),pi.Enabled&&(t.playerManager$=new mt)},this.initManagers$=function(){var e,n,a;t.sceneManager$.init(),t.screenManager$.init(),t.engineManager$.init(),t.layoutManager$.init(),t.pluginsManager$.init(),null===(e=t.adsManager$)||void 0===e||e.init(),null===(n=t.matchManager$)||void 0===n||n.init(),null===(a=t.playerManager$)||void 0===a||a.init()},this.listenEvents$=function(){Di.catchUp(vi.CORE_BOOTING,t.handleWhenCoreBoot$),Di.catchUp(vi.CORE_STARTING,t.handleWhenCoreStart$),Di.catchUp(vi.CORE_READY,t.handleWhenCoreReady$),B.listenLayoutChanges(),t.sceneManager$.onSwitchScene(t.handleSwitchScene$)},this.handleWhenCoreBoot$=function(){console.warn("Ludos System: Core boot",{inited:h.inited,game:h}),h.inited?t.handleCocosInit$():h.once(O.EVENT_GAME_INITED,t.handleCocosInit$)},this.handleCocosInit$=function(){Di.emit(vi.REQUEST_CORE_START)},this.handleWhenCoreStart$=function(){var e,n;null===(e=t.playerManager$)||void 0===e||e.setupDefaultGameData(),null===(n=t.matchManager$)||void 0===n||n.setupDefaultMatchData()},this.handleWhenCoreReady$=function(){var e;gi.Enabled||Di.emit(vi.BUNDLE_READY),t.initPlugins$(),null===(e=t.playerManager$)||void 0===e||e.syncPlatformPlayerData(),$i&&Ci.event($i.LOAD_START),Di.catchUp(vi.BUNDLE_READY,t.processPreStartGame$)},this.processPreStartGame$=function(){Di.catchUp(vi.SCENE_LOADED,t.preloadScenes$),Di.catchUp(vi.SCENE_LAUNCHED,t.processBootSceneLaunched$),t.runBootScene$()},this.processBootSceneLaunched$=n((function*(){hi.StartSDKAfterLoadGame&&(yield Di.waitTo(vi.SCENE_LOADED)),yield GameSDK.extra.waitSDKInitiatedAsync(),console.debug("Game paused",h.isPaused()),h.isPaused()&&(yield t.waitGameResume$()),t.processStartGame$()})),this.waitGameResume$=n((function*(){return new Promise((function(e){h.once(O.EVENT_RESUME,e)}))})),this.runBootScene$=function(){GameSDK.isGameSDK("Playable")?re.switchScene(oe.PLAYABLE_SCENE):re.switchScene(oe.BOOT_SCENE)},this.preloadScenes$=function(){GameSDK.isGameSDK("Playable")||("solo"===bi.getSessionContextType()?re.preloadDashboardScene():re.preloadGameScene())},this.processStartGame$=n((function*(){console.groupEnd(),$i&&Ci.event($i.LOAD_COMPLETE),Di.catchUp(vi.PLAYER_INFO_LOADED,t.startProcessContextData$),yield Di.waitTo(vi.SCENE_RENDERED,1e3).catch((function(){})),yield wi.sleepAsync(100),yield t.startGameAsync$()})),this.handleSwitchScene$=function(){ne.preloadScreens(),console.groupEnd()},this.startGameAsync$=n((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{yield GameSDK.startGameAsync()}catch(n){console.warn("GameSDK.startGameAsync",n),e<=3?setTimeout((function(){t.startGameAsync$(e+1)}),1e3):null==Ti||Ti.sendException(n instanceof Error?n:new Error(JSON.stringify(n)))}})),this.startProcessContextData$=n((function*(){$i&&Ci.event($i.APP_READY);try{var e;null===(e=t.playerManager$)||void 0===e||e.requestConnectedPlayers(),yield bi.processContextData()}catch(e){console.error("startProcessContextData",e),e instanceof Error&&(null==Ti||Ti.sendException(e))}finally{Di.emit(vi.GAME_READY),t.trackDeviceInfo$("begin"),window.addEventListener("beforeunload",(function(){t.trackDeviceInfo$("end")}))}})),this.initPlugins$=function(){t.pluginsManager$.initLanguages(),t.pluginsManager$.initFrameCapture(),t.pluginsManager$.initDailyRewards(),t.pluginsManager$.initLeaderboards(),t.pluginsManager$.initDynamicAtlas(),t.pluginsManager$.initDynamicAssets(),t.pluginsManager$.initCanvasRecorder(),t.pluginsManager$.initPerformanceMonitor(),t.pluginsManager$.initAdaptivePerformance()},this.getDeviceInfo$=function(e){try{var t=Ei.isES5(),n=Ei.heapMemory(),a=Ei.pixelRatio(),r=Ei.audioState(),i=Ei.orientation(),s=Ei.gpuRenderer(),o=Ei.isSupportWebp();return{log_type:e,is_es5:t,pixel_ratio:a,sdk_platform:GameSDK.getPlatform(),screen_orientation:i,audio_state:r,heap_memory:n,support_webp:o,gpu_renderer:s,webgl_version:Ei.webglVersion(),max_texture_size:Ei.maxTextureSize(),hardware_concurrency:Ei.hardwareConcurrency()}}catch(e){return console.warn("Error getting device info",e),null}},this.trackDeviceInfo$=function(e){var n=t.getDeviceInfo$(e);n&&ae.trackDeviceInfo(n)},console.groupCollapsed("üì¶ Ludos System"),this.logEngineReady$(),this.createManager$(),this.initManagers$(),this.listenEvents$(),console.groupEnd(),window.__sdkLoad.ensure(10)}))),d._RF.pop(),d._RF.push({},"826b3i39nhICrG3S59Y/cpR","PipelineData",void 0),d.user||(d.user={windowID:0,windows:new WeakMap}),d._RF.pop(),d._RF.push({},"c7df3pBHqRChZTjXMfWIy6H","Optimized2DPipeline",void 0);U.ccclass;d._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/systems', 'chunks:///systems.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map