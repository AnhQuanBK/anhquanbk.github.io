System.register("chunks:///main.js",["./env-5304ac8c.js","cc","./TournamentUtils-0964e80a.js"],(function(){var e,t,n,i,a,o,r,l,s,u,c,d,h,p,y,v,f,g,m,b,w,S,k,C,E,A,T,P,O,L,I,R,_,D,M,N,B,F,x,z,U,G,H,q,V,$,W,K,j,Y,X,J,Z,Q,ee,te,ne,ie,ae,oe,re,le,se,ue,ce,de,he,pe,ye,ve,fe,ge,me,be,we,Se,ke,Ce,Ee,Ae,Te,Pe,Oe,Le,Ie,Re,_e,De,Me,Ne,Be,Fe,xe,ze,Ue,Ge,He,qe,Ve,$e,We,Ke,je,Ye,Xe,Je,Ze,Qe,et,tt,nt,it,at,ot,rt,lt,st,ut,ct,dt,ht,pt,yt,vt,ft,gt;return{setters:[function(S){e=S.f,t=S.c,n=S.a,i=S.b,a=S._,o=S.h,r=S.d,l=S.e,s=S.i,u=S.g,c=S.j,d=S.k,h=S.l,p=S.m,y=S.n,v=S.o,f=S.p,g=S.q,m=S.r,b=S.s,w=S.t},function(e){S=e.cclegacy,k=e.AudioSource,C=e._decorator,E=e.CCString,A=e.director,T=e.Component,P=e.UITransform,O=e.CCInteger,L=e.CCFloat,I=e.Widget,R=e.tween,_=e.Layout,D=e.game,M=e.ccenum,N=e.isCCObject,B=e.UIOpacity,F=e.Sprite,x=e.Enum,z=e.easing,U=e.EventHandler,G=e.Button,H=e.Input,q=e.Node,V=e.Vec3,$=e.animation,W=e.CCBoolean,K=e.Label,j=e.RichText,Y=e.Graphics,X=e.Color,J=e.sys,Z=e.Director,Q=e.EventTarget,ee=e.ParticleSystem2D,te=e.math,ne=e.View,ie=e.ProgressBar,ae=e.Vec2,oe=e.Layers,re=e.find,le=e.pseudoRandomRangeInt,se=e.randomRangeInt,ue=e.SpriteFrame,ce=e.Animation,de=e.AnimationClip,he=e.randomRange,pe=e.pseudoRandom,ye=e.instantiate,ve=e.Pool,fe=e.Prefab,ge=e.repeat,me=e.js,be=e.misc,we=e.MeshRenderData,Se=e.lerp,ke=e.approx,Ce=e.EPSILON,Ee=e.RealCurve,Ae=e.Gradient,Te=e.bits,Pe=e.random,Oe=e.toRadian,Le=e.CCClass,Ie=e.UIRenderer,Re=e.pseudoRandomRange,_e=e.assert,De=e.clamp,Me=e.HorizontalTextAlignment,Ne=e.Tween,Be=e.ResolutionPolicy,Fe=e.view,xe=e.NodeEventType,ze=e.Material,Ue=e.Canvas,Ge=e.ScrollView,He=e.Mask},function(e){qe=e.R,Ve=e.A,$e=e.G,We=e.C,Ke=e.a,je=e.b,Ye=e.c,Xe=e.d,Je=e.e,Ze=e.L,Qe=e.f,et=e.g,tt=e.h,nt=e.I,it=e.i,at=e.T,ot=e.j,rt=e.k,lt=e.S,st=e.l,ut=e.m,ct=e.n,dt=e.o,ht=e.p,pt=e.q,yt=e.r,vt=e.W,ft=e.s,gt=e.t}],execute:function(){var mt;S._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var bt=null===(mt=Ludex.Plugins.Audio)||void 0===mt?void 0:mt.BaseAudioPlayer;bt||(bt=e((function e(n){t(this,e),console.warn("BaseAudioPlayer is not defined",n)})));var wt,St,kt,Ct=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,e)).audioSource=n,i}return e(r,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,a=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=a}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===k.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),r}(bt);S._RF.pop(),S._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var Et=Ludex.Utils,At=Et.Array,Tt=Et.Decorator,Pt=null===(wt=Ludex.Plugins.Audio)||void 0===wt?void 0:wt.BaseChannelManager;Pt||(Pt=e((function e(n){t(this,e),console.warn("BaseChannelManager is not defined",n)})));var Ot,Lt,It,Rt,_t,Dt=(St=Tt.tryCatch(),a((kt=function(a){n(s,a);var r,l=i(s);function s(e,n){var i;return t(this,s),(i=l.call(this,n)).allowMultipleTracking={},i.handleLoadedAudio=function(e,t){var n=i.node.addComponent(k);return n.clip=t,n.playOnAwake=!1,new Ct(e,n)},i.node=e,i}return e(s,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof Ct)&&n.getAudioSource().state===k.AudioState.PLAYING}},{key:"onLoadAudio",value:(r=o((function*(e,t){var n=yield qe.loadAudioAsync(e);return n&&this.node.isValid?this.handleLoadedAudio(e,n):null})),function(e,t){return r.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,a=t.allowMultiple,o=void 0!==a&&a;if(t.volume=this.getVolume()*i,o){var r=e.getAudioSource().clip;if(!r)return;return void this.requestDuplicateAudioPlayer(e.getKey(),r,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof Ct)return i.getAudioSource().state===k.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var a=i.key,o=n.volume,r=void 0===o?1:o;this.setAudioClip(a,{volume:r})}return i.audioPlayer}var l=this.allowMultipleTracking[e];if(!l)throw new Error("Allow multiple tracking is not found");var s="".concat(e,"_").concat(l.currentPostFix),u=this.handleLoadedAudio(s,t);return l.list.push({audioPlayer:u,key:s}),l.currentPostFix+=1,this.setAudioClip(s,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=At.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==k.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),s}(Pt)).prototype,"onLoadAudio",[St],Object.getOwnPropertyDescriptor(kt.prototype,"onLoadAudio"),kt.prototype),kt);S._RF.pop(),S._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var Mt,Nt,Bt,Ft,xt,zt=C.ccclass,Ut=C.property,Gt=codex,Ht=Gt.audio,qt=Gt.player;Ot=zt("Music"),Lt=Ut(E),Ot((_t=a((Rt=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"channelId",_t,l(e)),e.channel=null,e.isMute=!1,e.volume=1,e}return e(s,[{key:"__preload",value:function(){Ht&&(this.makePersistent(),this.channel=new Dt(this.node,this.channelId),Ht.addChannel(this.channel))}},{key:"makePersistent",value:function(){A.isPersistRootNode(this.node)||A.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),Ht.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!qt.getPlayerSetting("music")}},{key:"setVolume",value:function(e){this.volume=e,this.isMute||Ht.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return Ht.getVolume(this.channelId)}},{key:"pause",value:function(e){Ht.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&Ht.resume(e,this.channelId)}},{key:"stop",value:function(e){Ht.stop(e,this.channelId)}},{key:"mute",value:function(e){this.isMute=e,e?Ht.mute(this.channelId):(this.setVolume(this.volume),Ht.unmute(this.channelId))}}]),s}(T)).prototype,"channelId",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),It=Rt));S._RF.pop(),S._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var Vt,$t,Wt,Kt,jt,Yt,Xt,Jt,Zt,Qt,en,tn,nn,an,on,rn,ln,sn,un,cn,dn=C.ccclass,hn=C.property,pn=codex,yn=pn.audio,vn=pn.player,fn=(Mt=dn("Sound"),Nt=hn(E),Mt((xt=a((Ft=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"channelId",xt,l(e)),e.channel=null,e}return e(s,[{key:"__preload",value:function(){yn&&(this.channel=new Dt(this.node,this.channelId),yn.addChannel(this.channel))}},{key:"onLoad",value:function(){""===this.channelId&&(this.channelId=this.node.uuid)}},{key:"makePersistent",value:function(){A.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){A.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){if(this.isSoundEnable())return yn.play(e,t,this.channelId)}},{key:"isSoundEnable",value:function(){return!!vn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){yn.setVolume(e,this.channelId)}},{key:"pause",value:function(e){yn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&yn.resume(e,this.channelId)}},{key:"stop",value:function(e){yn.stop(e,this.channelId)}},{key:"stopAll",value:function(){yn.stopAll(this.channelId)}},{key:"mute",value:function(e){e?yn.mute(this.channelId):yn.unmute(this.channelId)}}]),s}(T)).prototype,"channelId",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Bt=Ft))||Bt);S._RF.pop(),S._RF.push({},"84a2dB5IaRJ8JB+n9yXfBc7","AutoLayout",void 0);var gn,mn=C.ccclass,bn=C.property,wn=(Vt=mn("AutoLayoutWrappee"),$t=bn({type:P}),Wt=bn({type:P}),Vt((Yt=a((jt=e((function e(){t(this,e),r(this,"wrapeeContainer",Yt,this),r(this,"wrapee",Xt,this)}))).prototype,"wrapeeContainer",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=a(jt.prototype,"wrapee",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=jt))||Kt),Sn=(Jt=mn("AutoLayout"),Zt=bn({displayName:"Use Auto Layout"}),Qt=bn({type:[wn],displayName:"Children",visible:function(){return this.useAutoLayout}}),en=bn({visible:!1,serializable:!0}),tn=bn({type:O,displayName:"Selected Index",visible:function(){return this.useAutoLayout}}),nn=bn({type:L,displayName:"Deselected Icon Width",group:"Edge Icons",visible:function(){return this.useAutoLayout}}),an=bn({visible:!1,serializable:!0}),Jt((ln=a((rn=function(a){n(y,a);var h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"useAutoLayout",ln,l(e)),r(e,"children",sn,l(e)),e.mappedChildren=[],r(e,"selected",un,l(e)),r(e,"deselectedIconW",cn,l(e)),e.tweens=[],e}return e(y,[{key:"selectedIndex",get:function(){return this.selected},set:function(e){this.selected=e,this.updateLayout(!0)}},{key:"deselectedIconWidth",get:function(){return this.deselectedIconW},set:function(e){this.deselectedIconW=e,this.updateLayout(!0)}},{key:"__preload",value:function(){this.mappedChildren=this.children.map((function(e){var t=e.wrapeeContainer.getComponent(I);if(!t)throw new Error("AutoLayout: Widget component not found");return s(s({},e),{},{wrapeeContainerWidget:t})}))}},{key:"updateLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._layoutDirty||e){this.updateChildrenAnchors();var t,n=u(this.mappedChildren);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.wrapeeContainerWidget.updateAlignment()}}catch(e){n.e(e)}finally{n.f()}}c(d(y.prototype),"updateLayout",this).call(this,e)}},{key:"getSelectedWorldX",value:function(){var e=this.mappedChildren[this.selectedIndex].wrapeeContainer;return 0===this.selectedIndex||this.selectedIndex===this.children.length-1?e.getBoundingBoxToWorld().xMin+this.getAnchorX(this.selectedIndex)*e.width:e.getBoundingBoxToWorld().center.x}},{key:"getAnchorX",value:function(e){if(e<this.selectedIndex)return 0;if(e>this.selectedIndex)return 1;if(0===e){var t=this.mappedChildren[e].wrapeeContainer.width,n=this.deselectedIconWidth/2,i=this.paddingLeft;return((i+t+(t-n+this.spacingX))/2-i)/t}if(e===this.children.length-1){var a=this.mappedChildren[e].wrapeeContainer.width,o=a-this.deselectedIconWidth/2+this.spacingX;return((o+a+this.paddingRight)/2-o)/a}return.5}},{key:"updateChildrenAnchors",value:(h=o((function*(){var e,t=this,n=u(this.tweens);try{for(n.s();!(e=n.n()).done;)e.value.stop()}catch(e){n.e(e)}finally{n.f()}this.tweens=[],yield Promise.all([this.children.flatMap((function(e,n){return t.getChildrenAnchorsTweens(e,t.getAnchorX(n))})).map((function(e){return Ve.runTweenAsync(e)}))])})),function(){return h.apply(this,arguments)})},{key:"updateChildrenAnchorsEditor",value:function(){var e=this;this.children.forEach((function(t,n){var i=e.getAnchorX(n);t.wrapee.setAnchorPoint(i,t.wrapee.anchorY),t.wrapeeContainer.setAnchorPoint(i,t.wrapeeContainer.anchorY)}))}},{key:"getChildrenAnchorsTweens",value:function(e,t){return[R(e.wrapee).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapee.setAnchorPoint(t,e.wrapee.anchorY)})),R(e.wrapeeContainer).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapeeContainer.setAnchorPoint(t,e.wrapeeContainer.anchorY)}))]}}]),y}(_)).prototype,"useAutoLayout",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),sn=a(rn.prototype,"children",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),un=a(rn.prototype,"selected",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(rn.prototype,"selectedIndex",[tn],Object.getOwnPropertyDescriptor(rn.prototype,"selectedIndex"),rn.prototype),a(rn.prototype,"deselectedIconWidth",[nn],Object.getOwnPropertyDescriptor(rn.prototype,"deselectedIconWidth"),rn.prototype),cn=a(rn.prototype,"deselectedIconW",[an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),on=rn))||on);S._RF.pop(),S._RF.push({},"32a77jcKOREvpuCe9wamBRu","Background",void 0);(0,C.ccclass)("Background")(gn=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.uiTransform=this.getComponent(P),this.ratio=this.uiTransform.width/this.uiTransform.height,this.listenGameEvents(),this.handleViewResized()}},{key:"listenGameEvents",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this),D.on($e.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenGameEvents",value:function(){D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}},{key:"handleViewResized",value:function(){var e=We.cssSizeToWorldSize(We.getScreenWidthCss()),t=We.cssSizeToWorldSize(We.getScreenHeightCss());e/t<this.ratio?(this.uiTransform.width=t*this.ratio,this.uiTransform.height=t):(this.uiTransform.width=e,this.uiTransform.height=e/this.ratio)}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}}]),r}(T));S._RF.pop(),S._RF.push({},"bf320amyc1I86bS3oK0M9NR","DashboardEvents",void 0);var kn="STARS_UPDATED",Cn="PLAY_BUTTON_PRESS",En="CUSTOM_PLAY_BUTTON_PRESS",An="REQUEST_NAVIGATION",Tn="REQUEST_NAVIGATION_ANIMATION",Pn="DASHBOARD_EVENTS_BUTTON_PRESS";S._RF.pop(),S._RF.push({},"68b8bf0Va5JT7NVPECDNC5l","DashboardScreens",void 0);var On=function(e){return e[e.store=0]="store",e[e.collections=1]="collections",e[e.home=2]="home",e[e.leaderboard=3]="leaderboard",e[e.tournaments=4]="tournaments",e}(On||{});function Ln(e,t,n){var i;if("object"!==h(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var a=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(i.call(this))return null==a?void 0:a.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}};!function(e,t,n){var i=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}(0,t,n)}function In(e,t,n){var i;if("object"!==h(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var a=n.value,r=function(){var e=o((function*(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(i.call(this))return yield null==a?void 0:a.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}));return function(){return e.apply(this,arguments)}}();n.value=r};!function(e,t,n){var i=n.value,a=function(){var e=o((function*(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return yield null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}));return function(){return e.apply(this,arguments)}}();n.value=a}(0,t,n)}M(On),S._RF.pop(),S._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),S._RF.pop(),S._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),S._RF.pop(),S._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),S._RF.pop(),S._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var Rn=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"".concat(e," is missing these required properties: [").concat(n.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,i.errors=n,i}return e(r)}(p(Error));S._RF.pop(),S._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var _n=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"".concat(e," is missing the required property: <").concat(n,">"))).className=e,i.propertyName=n,i}return e(r)}(p(Error));S._RF.pop(),S._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var Dn=Ludex.Utils,Mn=Dn.String,Nn=Dn.Valid,Bn=codex.monitorError,Fn="_compUtils_ReqPropsMap";function xn(e){return null===e}function zn(e){return void 0===e}function Un(e){return xn(e)||zn(e)}function Gn(e){if("function"==typeof e)return e;switch(e){case"null-check":return xn;case"undefined-check":return zn;default:return Un}}function Hn(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var i,a=t.constructor.name,o=(i=n,"".concat("_compUtils_ReqPropsMethod","_").concat(Mn.capitalize(i)));if(void 0!==t[o])throw new Error("The required decorator found that property name ".concat(o," already exists. The reserved method name ").concat(o," is used already or the decorator was applied multiple times."));t[o]=function(t){if(e(this[n]))throw new _n(t,n)},void 0===t[Fn]&&(t[Fn]={}),void 0===t[Fn][a]&&(t[Fn][a]=[]),t[Fn][a].push(o)}}function qn(e,t){if("string"!=typeof t)return Hn(Gn(e));var n=e;Hn(Gn())(n,t)}S._RF.pop(),S._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),S._RF.pop(),S._RF.push({},"95972yG/ulEg4gycbc+QB5Y","ComponentUtils",void 0);var Vn=Ludex.Utils,$n=Vn.Array,Wn=Vn.Object,Kn=Vn.Valid,jn=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],Yn=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n),this.validComponentCalled$={}}return e(n,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredComponentNames(i),o=u(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(!e.getComponent(r))throw new Error("".concat(n,": Missing required ").concat(r," component"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredPropNames(i),o=u(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(!Wn.hasOwn(e,r))throw new Error("".concat(n,": Missing required ").concat(r," property"));var l=this.getProperty(r,e);if(!N(l))throw new Error("".concat(n,": ").concat(r," property is not a cc object"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,i=this.getCustomPropNames(e),a=u(i);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!Wn.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var r=this.getProperty(o,e);if(!N(r))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"getProperty",value:function(e,t){var n;if(Wn.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!Wn.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!Wn.hasOwn(e,t)&&(!!N(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=jn;t<n.length;t++){var i=n[t];if(i.indexOf(e)>=0)return i}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!Wn.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),i=this.getProps(e.constructor);return $n.difference(n,i).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!Wn.hasOwn(e,n))return!1;var i=t.getProperty(n,e);return!(!Kn.isObject(i)||!N(i))}))}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"required",value:function(e,t){return"string"==typeof t?qn(e,t):qn(e)}},{key:"onlyRunInLifeCycle",value:function(e,t,n){return"object"===h(e)&&void 0!==t&&void 0!==n?Ln(e,t,n):Ln(e)}},{key:"onlyRunInLifeCycleAsync",value:function(e,t,n){return"object"===h(e)&&void 0!==t&&void 0!==n?In(e,t,n):In(e)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,i=n.name;if(!this.inst.validComponentCalled$[i])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled$[i]=!0}}}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,i,a=t?t.name:e.constructor.name,o=t?t.prototype[Fn]:e.constructor.prototype[Fn],r=null!==(n=null==o?void 0:o[a])&&void 0!==n?n:[],l=[],s=e,c=u(r);try{for(c.s();!(i=c.n()).done;){var d=i.value;if("function"==typeof s[d])try{s[d](a)}catch(h){if(!(h instanceof _n))throw h;l.push(h)}}}catch(e){c.e(e)}finally{c.f()}if(0!==l.length){var h=new Rn(a,l);if(Nn.isDebugger())throw h;console.error(h),null==Bn||Bn.sendException(h)}}(e,t)}}]),n}());S._RF.pop(),S._RF.push({},"adccaBKYItKsqE+ZU1nBitm","AnimAbortSignal",void 0);var Xn,Jn,Zn,Qn,ei,ti,ni,ii,ai,oi,ri,li,si,ui,ci,di,hi,pi,yi,vi,fi,gi,mi,bi,wi,Si,ki,Ci,Ei,Ai,Ti,Pi,Oi,Li,Ii,Ri,_i,Di,Mi=Ludex.Utils.Array,Ni=function(){function n(){t(this,n),this.callbacks$=[],this.isAborted$=!1,this.abortReason$="",this.callbacks$=[]}var i;return e(n,[{key:"aborted",get:function(){return this.isAborted$}},{key:"reason",get:function(){return this.abortReason$}},{key:"addAbortListener",value:function(e){this.callbacks$.push(e)}},{key:"removeAbortListener",value:function(e){var t=Mi.searchIndex(this.callbacks$,(function(t){return t===e}));-1!==t&&this.callbacks$.splice(t,1)}},{key:"abort",value:function(e){if(!this.isAborted$){this.isAborted$=!0,this.abortReason$=e;var t,n=u(this.callbacks$);try{for(n.s();!(t=n.n()).done;){var i=t.value;"function"==typeof i&&i()}}catch(e){n.e(e)}finally{n.f()}this.callbacks$=[]}}},{key:"untilAborted",value:(i=o((function*(){var e=this;if(!this.isAborted$)return new Promise((function(t){e.addAbortListener((function(){return t()}))}))})),function(){return i.apply(this,arguments)})},{key:"call",value:function(e){this.aborted||e(this)}},{key:"callAsync",value:function(e){return this.aborted?Promise.resolve():e(this)}},{key:"chain",value:function(e){var t=this;e instanceof n?e.addAbortListener((function(){return t.abort()})):e.addEventListener("abort",(function(){return t.abort()}))}}],[{key:"hasBeenAborted",value:function(e){return null==e||e.aborted}}]),n}();S._RF.pop(),S._RF.push({},"ab9cd/wERRKYqhDoYtJ1L3w","MultiBackground",void 0);var Bi=C.ccclass,Fi=C.property,xi=codex.monitorError,zi=Ludex.Utils.Number,Ui=Ke.Layout,Gi=(Xn=Bi("MultiBackground"),Jn=Yn.required(),Zn=Fi({type:B}),Qn=Yn.required(),ei=Fi({type:F}),ti=Yn.required(),ni=Fi({type:F}),ii=Yn.required(),ai=Fi({type:B}),oi=Yn.required(),ri=Fi({type:B}),li=Yn.required(),si=Fi({type:P}),ui=Yn.required(),ci=Fi({type:P}),di=Yn.required(),hi=Fi({type:P}),pi=Fi(O),yi=Yn.required(),vi=Fi(I),fi=Fi({type:x(On)}),gi=Fi({type:x(On)}),mi=Yn.onlyRunInLifeCycleAsync,bi=Yn.onlyRunInLifeCycleAsync,Xn((ki=a((Si=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"fallbackBackground",ki,l(e)),r(e,"background1",Ci,l(e)),r(e,"background2",Ei,l(e)),r(e,"background1UiOpacity",Ai,l(e)),r(e,"background2UiOpacity",Ti,l(e)),r(e,"screenUiTransform",Pi,l(e)),r(e,"background1UiTransform",Oi,l(e)),r(e,"background2UiTransform",Li,l(e)),r(e,"backgroundNudgeAmount",Ii,l(e)),r(e,"nudgeableWidget",Ri,l(e)),r(e,"pageOrder",_i,l(e)),r(e,"homePage",Di,l(e)),e.currentPage=On.home,e.tryNudgeBackground=function(t){var n=t.to;e.currentPage=n;var i=e.getDirection(e.homePage,n),a=zi.sign(i),o=Math.abs(i),r=e.backgroundNudgeAmount*o,l=Math.min(e.background1UiTransform.width,e.background2UiTransform.width),s=Math.max(0,(l-e.screenUiTransform.width)/2),u=Math.min(s,r)*a;R(e.nudgeableWidget).to(.5,{horizontalCenter:u},{easing:z.cubicInOut}).start()},e}return e(d,[{key:"__preload",value:function(){this.currentBackground=this.background1,this.nextBackground=this.background2,this.currentBackgroundUiOpacity=this.background1UiOpacity,this.nextBackgroundUiOpacity=this.background2UiOpacity}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,d),this.listenToNavigationEvents()}},{key:"onDestroy",value:function(){this.unlistenToNavigationEvents()}},{key:"listenToNavigationEvents",value:function(){this.node.scene.on(Tn,this.tryNudgeBackground),D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"unlistenToNavigationEvents",value:function(){this.node.scene.off(Tn,this.tryNudgeBackground),D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"getDirection",value:function(e,t){var n=this.pageOrder.indexOf(e),i=this.pageOrder.indexOf(t);return-1===n||-1===i?(null==xi||xi.sendException(new Error("MultiBackground.getDirection: fromIndex or toIndex is -1")),0):n-i}},{key:"setCurrentTheme",value:(u=o((function*(e,t){var n;if(this.currentThemeId!==e){this.currentThemeId=e,null===(n=this.tweenSignal)||void 0===n||n.abort();var i=new Ni;null==t||t.chain(i),this.tweenSignal=i;var a=yield qe.loadThemeAsync(e);a?i.aborted||(yield this.updateBackground(a,i)):null==xi||xi.sendException(new Error("MultiBackground.setCurrentTheme: Failed to load theme ".concat(e,"'s sprite.")))}})),function(e,t){return u.apply(this,arguments)})},{key:"updateBackground",value:(s=o((function*(e,t){e.packable=!1;var n=this.currentBackground,i=this.nextBackground,a=this.currentBackgroundUiOpacity,o=this.nextBackgroundUiOpacity,r=this.fallbackBackground;i.spriteFrame=e,i.node.setSiblingIndex(1),o.opacity=0,r.opacity=255,yield Ve.runTweenAsync(R(o).to(.25,{opacity:255}),t),a.opacity=0,r.opacity=0,this.currentBackground=i,this.nextBackground=n,this.currentBackgroundUiOpacity=i===this.background1?this.background1UiOpacity:this.background2UiOpacity,this.nextBackgroundUiOpacity=n===this.background1?this.background1UiOpacity:this.background2UiOpacity})),function(e,t){return s.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){if(e===Ui.Portrait){var t=this.getDirection(this.homePage,this.currentPage),n=zi.sign(t),i=Math.abs(t),a=this.backgroundNudgeAmount*i,o=Math.min(this.background1UiTransform.width,this.background2UiTransform.width),r=Math.max(0,(o-this.screenUiTransform.width)/2),l=Math.min(r,a)*n;this.nudgeableWidget.horizontalCenter=l}else e===Ui.Landscape&&(this.nudgeableWidget.horizontalCenter=0)}}]),d}(T)).prototype,"fallbackBackground",[Jn,Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=a(Si.prototype,"background1",[Qn,ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=a(Si.prototype,"background2",[ti,ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=a(Si.prototype,"background1UiOpacity",[ii,ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=a(Si.prototype,"background2UiOpacity",[oi,ri],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pi=a(Si.prototype,"screenUiTransform",[li,si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oi=a(Si.prototype,"background1UiTransform",[ui,ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=a(Si.prototype,"background2UiTransform",[di,hi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ii=a(Si.prototype,"backgroundNudgeAmount",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Ri=a(Si.prototype,"nudgeableWidget",[yi,vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i=a(Si.prototype,"pageOrder",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Di=a(Si.prototype,"homePage",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return On.home}}),a(Si.prototype,"setCurrentTheme",[mi],Object.getOwnPropertyDescriptor(Si.prototype,"setCurrentTheme"),Si.prototype),a(Si.prototype,"updateBackground",[bi],Object.getOwnPropertyDescriptor(Si.prototype,"updateBackground"),Si.prototype),wi=Si))||wi);S._RF.pop(),S._RF.push({},"cb1abhXDs1A57EPVKbvTJg/","ButtonPlusEvents",void 0);var Hi="TRANSITION_DOWN",qi="TRANSITION_HOVER",Vi="TRANSITION_RESET",$i="TRANSITION_DISABLED",Wi="CLICK_START",Ki="CLICK",ji="CLICK_END",Yi="CLICK_CANCEL";S._RF.pop(),S._RF.push({},"d159egaUVVLHKLg1UL865ub","SoundKeys",void 0);var Xi="musics/",Ji="sounds/",Zi=Ludex.Utils.Object,Qi={BUTTON_CLICK:"".concat(Ji,"use_item_click"),BOMB_DEFUSE:"".concat(Ji,"bomb_defuse"),BOMB_EXPLODE_1:"".concat(Ji,"bomb_explode_1"),BOMB_EXPLODE_2:"".concat(Ji,"bomb_explode_2"),CLICKS:"".concat(Ji,"clicks"),CLOSE_POPUP_CLICK:"".concat(Ji,"close_popup_click"),COLLECT_STARS:"".concat(Ji,"collect_stars"),COMBO_1:"".concat(Ji,"combo_1"),COMBO_2:"".concat(Ji,"combo_2"),COMBO_3:"".concat(Ji,"combo_3"),COMBO_4:"".concat(Ji,"combo_4"),COMBO_5:"".concat(Ji,"combo_5"),DAILY_REWARD:"".concat(Ji,"daily_reward"),EXTRA_TIME_SPAWN:"".concat(Ji,"extra_time_spawn"),GIFT_CHARGE:"".concat(Ji,"gift_charge"),GIFT_EXPLODE:"".concat(Ji,"gift_explode"),GIFT_REVEAL:"".concat(Ji,"gift_reveal"),HINT_ITEM:"".concat(Ji,"hint_item"),INVALID_MATCH:"".concat(Ji,"invalid_match"),LEVEL_COMPLETE:"".concat(Ji,"level_complete"),LEVEL_FAIL:"".concat(Ji,"level_fail"),LEVEL_START:"".concat(Ji,"level_start"),PROGRESS_STAR:"".concat(Ji,"progress_star"),RESCUE_TIMER:"".concat(Ji,"rescue_timer"),ROCKET_FLY:"".concat(Ji,"rocket_fly"),SHUFFLE_ITEM:"".concat(Ji,"shuffle_item"),THREE_STARS:"".concat(Ji,"three_stars"),TICKING_BOMB_BEFORE_EXPLODE:"".concat(Ji,"ticking_bomb_before_explode"),TILE_SELECT:"".concat(Ji,"tile_select"),USE_ITEM_CLICK:"".concat(Ji,"use_item_click"),BG_MUSIC:"".concat(Xi,"bg_music"),PATCH_SHIFT:"".concat(Ji,"patch_shift"),THUNDERBOLT:"".concat(Ji,"thunderbolt"),WIND:"".concat(Ji,"wind"),COLLECT_COINS:"".concat(Ji,"collect_coins"),COLLECT_STOCK_COINS:"".concat(Ji,"collect_stock_coins"),LEVEL_FAIL_TIMEOUT:"".concat(Ji,"level_fail_timeout"),STAR_CHEST_DRUM_ROLL:"".concat(Ji,"star_chest_drum_roll"),STAR_CHEST_OPEN:"".concat(Ji,"star_chest_open"),LEADERBOARD_TRIUMPH:"".concat(Ji,"leaderboard_triumph"),ITEM_REWARD:"".concat(Ji,"item_reward"),COMBO_6:"".concat(Ji,"combo_6"),COMBO_7:"".concat(Ji,"combo_7"),COMBO_8:"".concat(Ji,"combo_8"),COMBO_9:"".concat(Ji,"combo_9"),COMBO_10:"".concat(Ji,"combo_10"),COMBO_11:"".concat(Ji,"combo_11"),COMBO_12:"".concat(Ji,"combo_12"),COMBO_13:"".concat(Ji,"combo_13"),TILE_MATCH:"".concat(Ji,"tile_match"),TOURNAMENT_MUSIC:"".concat(Xi,"tournament_music")},ea=Zi.vals(Qi),ta=ea.reduce((function(e,t,n){return e[t]=n,e}),{});M(ta);var na,ia,aa,oa,ra,la,sa,ua,ca,da,ha,pa,ya,va,fa,ga,ma,ba,wa,Sa,ka,Ca,Ea,Aa,Ta,Pa,Oa,La,Ia,Ra=ea;S._RF.pop(),S._RF.push({},"56710cJAPhPd4KK3hV3y8m6","ButtonPlus",void 0);var _a,Da,Ma,Na,Ba,Fa,xa,za,Ua,Ga,Ha,qa=C.ccclass,Va=C.property,$a=C.disallowMultiple,Wa=C.menu,Ka=(na=qa("ButtonPlus"),ia=Wa("Ludex/ButtonPlus/ButtonPlus"),aa=Va(U),oa=Va(U),ra=Va(U),la=Va({override:!0,visible:!1}),sa=Va({override:!0,visible:!1}),ua=Va({override:!0,visible:!1}),ca=Va({override:!0,visible:!1}),da=Va({override:!0,visible:!1}),ha=Va({override:!0,visible:!1}),pa=Va({override:!0,visible:!1}),ya=Va({override:!0,visible:!1}),va=Va({override:!0,visible:!1}),fa=Va({override:!0,visible:!1}),ga=Va({override:!0,visible:!1}),ma=Va({visible:function(){return this.makeSound},type:ta}),ba=Va({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),wa=Va({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),na(Sa=$a(Sa=ia((Ca=a((ka=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"onClickStartEvents",Ca,l(e)),r(e,"onClickEndEvents",Ea,l(e)),r(e,"onClickCancelEvents",Aa,l(e)),r(e,"makeSound",Ta,l(e)),r(e,"soundKey",Pa,l(e)),r(e,"disableSpamClick",Oa,l(e)),r(e,"disableSpamDelay",La,l(e)),r(e,"performBoundsCheckOnClickCancel",Ia,l(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.hasBeenDisabled=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=We.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(e.performBoundsCheckOnClickCancel){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickCancelEvents(t),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.emitTransitionEvent(qi)))},e.onMouseLeave=function(t){e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.emitTransitionEvent(Vi)},e}return e(s,[{key:"transition",get:function(){return G.Transition.NONE},set:function(e){y(d(s.prototype),"transition",G.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return c(d(s.prototype),"normalColor",this)},set:function(e){y(d(s.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return c(d(s.prototype),"pressedColor",this)},set:function(e){y(d(s.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return c(d(s.prototype),"hoverColor",this)},set:function(e){y(d(s.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return c(d(s.prototype),"disabledColor",this)},set:function(e){y(d(s.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return c(d(s.prototype),"normalSprite",this)},set:function(e){y(d(s.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return c(d(s.prototype),"pressedSprite",this)},set:function(e){y(d(s.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return c(d(s.prototype),"hoverSprite",this)},set:function(e){y(d(s.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return c(d(s.prototype),"disabledSprite",this)},set:function(e){y(d(s.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return c(d(s.prototype),"duration",this)},set:function(e){y(d(s.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return c(d(s.prototype),"zoomScale",this)},set:function(e){y(d(s.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){c(d(s.prototype),"__preload",this).call(this)}},{key:"onDestroy",value:function(){var e;null===(e=c(d(s.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=c(d(s.prototype),"onEnable",this))||void 0===e||e.call(this),this.hasBeenDisabled=!this.interactable,this.node.off(H.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(q.EventType.TOUCH_START,this.onTouchStart),this.node.on(q.EventType.TOUCH_END,this.onTouchEnd),this.node.on(q.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=c(d(s.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(q.EventType.TOUCH_START,this.onTouchStart),this.node.off(q.EventType.TOUCH_END,this.onTouchEnd),this.node.off(q.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(q.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"_updateState",value:function(){c(d(s.prototype),"_updateState",this).call(this),this.patchEmitTransitionDisabled()}},{key:"patchEmitTransitionDisabled",value:function(){var e=3===this._getButtonState();this.hasBeenDisabled!==e&&(e?this.emitTransitionEvent($i):this.emitTransitionEvent(Vi),this.hasBeenDisabled=e)}},{key:"handleDown",value:function(e){this.hasDown=!0,this.makeSound&&je.playSound(Ra[this.soundKey]),this.emitTransitionEvent(Hi),this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=u(this.onClickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Wi,this)}},{key:"emitClickEndEvents",value:function(e){var t,n=u(this.onClickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ji,this)}},{key:"emitClickCancelEvents",value:function(e){var t,n=u(this.onClickCancelEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Yi,this)}},{key:"handleUp",value:function(e){this.hasUp=!0,this._pressed=!1,this.hasFinishClickCycle=!0,this.emitTransitionEvent(Vi),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){var t,n=u(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Ki,this),this.node.emit(G.EventType.CLICK,this)}}},{key:"emitTransitionEvent",value:function(e){this.node.emit(e,this)}},{key:"fakeClick",value:function(){var e=this;this.emitTransitionEvent(Hi),this.scheduleOnce((function(){e.emitTransitionEvent(Vi)}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}},{key:"setInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.interactable=e,t&&(this.enabled=e)}}]),s}(G)).prototype,"onClickStartEvents",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ea=a(ka.prototype,"onClickEndEvents",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Aa=a(ka.prototype,"onClickCancelEvents",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(ka.prototype,"transition",[la],Object.getOwnPropertyDescriptor(ka.prototype,"transition"),ka.prototype),a(ka.prototype,"normalColor",[sa],Object.getOwnPropertyDescriptor(ka.prototype,"normalColor"),ka.prototype),a(ka.prototype,"pressedColor",[ua],Object.getOwnPropertyDescriptor(ka.prototype,"pressedColor"),ka.prototype),a(ka.prototype,"hoverColor",[ca],Object.getOwnPropertyDescriptor(ka.prototype,"hoverColor"),ka.prototype),a(ka.prototype,"disabledColor",[da],Object.getOwnPropertyDescriptor(ka.prototype,"disabledColor"),ka.prototype),a(ka.prototype,"normalSprite",[ha],Object.getOwnPropertyDescriptor(ka.prototype,"normalSprite"),ka.prototype),a(ka.prototype,"pressedSprite",[pa],Object.getOwnPropertyDescriptor(ka.prototype,"pressedSprite"),ka.prototype),a(ka.prototype,"hoverSprite",[ya],Object.getOwnPropertyDescriptor(ka.prototype,"hoverSprite"),ka.prototype),a(ka.prototype,"disabledSprite",[va],Object.getOwnPropertyDescriptor(ka.prototype,"disabledSprite"),ka.prototype),a(ka.prototype,"duration",[fa],Object.getOwnPropertyDescriptor(ka.prototype,"duration"),ka.prototype),a(ka.prototype,"zoomScale",[ga],Object.getOwnPropertyDescriptor(ka.prototype,"zoomScale"),ka.prototype),Ta=a(ka.prototype,"makeSound",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pa=a(ka.prototype,"soundKey",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),Oa=a(ka.prototype,"disableSpamClick",[ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),La=a(ka.prototype,"disableSpamDelay",[wa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ia=a(ka.prototype,"performBoundsCheckOnClickCancel",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sa=ka))||Sa)||Sa)||Sa);S._RF.pop(),S._RF.push({},"b7001YamGNLeauE1hUAtFfj","ButtonPlusAnalytics",void 0);var ja,Ya,Xa,Ja,Za,Qa,eo,to,no,io,ao,oo,ro,lo,so,uo,co,ho,po,yo,vo=C.ccclass,fo=C.property,go=C.disallowMultiple,mo=C.requireComponent,bo=C.menu,wo=Ludex.Plugins.Analytics,So=(void 0===wo?{}:wo).Events,ko=codex.analytics;_a=vo("ButtonPlusAnalytics"),Da=mo(Ka),Ma=bo("Ludex/ButtonPlus/ButtonPlusAnalytics"),Na=Yn.required(),Ba=fo(Ka),Fa=fo({visible:function(){return this.useCustomButtonName}}),_a(xa=go(xa=Da(xa=Ma((Ua=a((za=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"button",Ua,l(e)),r(e,"useCustomButtonName",Ga,l(e)),r(e,"customButtonName",Ha,l(e)),e}return e(s,[{key:"onEnable",value:function(){this.button.node.on(Ki,this.onClick,this)}},{key:"onDisable",value:function(){this.button.node.off(Hi,this.onClick,this)}},{key:"onClick",value:function(){So&&ko.event(So.BUTTON_CLICK,{button_name:this.useCustomButtonName?this.customButtonName:this.node.name,screen_name:Ye.getCurrentPage()})}}]),s}(T)).prototype,"button",[Na,Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ga=a(za.prototype,"useCustomButtonName",[fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ha=a(za.prototype,"customButtonName",[Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),xa=za))||xa)||xa)||xa);S._RF.pop(),S._RF.push({},"a89b3F866FGO68YNa+5Tsqh","ButtonPlusScale",void 0);var Co,Eo,Ao,To,Po,Oo,Lo,Io,Ro,_o,Do,Mo,No,Bo,Fo,xo,zo,Uo,Go,Ho,qo,Vo,$o,Wo,Ko,jo,Yo,Xo,Jo,Zo,Qo,er,tr,nr,ir,ar=C.ccclass,or=C.property,rr=C.disallowMultiple,lr=C.requireComponent,sr=C.menu,ur=Ludex.Utils.Signal;ja=ar("ButtonPlusScale"),Ya=lr(Ka),Xa=sr("Ludex/ButtonPlus/ButtonPlusScale"),Ja=Yn.required(),Za=or(Ka),Qa=or({group:{name:"Normal",style:"section"},displayName:"Scale"}),eo=or({group:{name:"Normal",style:"section"},displayName:"Duration"}),to=or({group:{name:"Hover",style:"section"},displayName:"Scale"}),no=or({group:{name:"Hover",style:"section"},displayName:"Duration"}),io=or({group:{name:"Click",style:"section"},displayName:"Scale"}),ao=or({group:{name:"Click",style:"section"},displayName:"Duration"}),ja(oo=rr(oo=Ya(oo=Xa((lo=a((ro=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"button",lo,l(e)),r(e,"normalScale",so,l(e)),r(e,"normalDuration",uo,l(e)),r(e,"hoverScale",co,l(e)),r(e,"hoverDuration",ho,l(e)),r(e,"clickScale",po,l(e)),r(e,"clickDuration",yo,l(e)),e.animStateController=new ur.SignalController,e}return e(s,[{key:"start",value:function(){this.button.node.setScale(this.normalScale)}},{key:"onEnable",value:function(){this.button.node.on(Hi,this.onTransitionDown,this),this.button.node.on(qi,this.onTransitionHover,this),this.button.node.on(Vi,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(Hi,this.onTransitionDown,this),this.button.node.off(qi,this.onTransitionHover,this),this.button.node.off(Vi,this.onTransitionReset,this)}},{key:"onTransitionDown",value:function(){Ve.runTweenAsync(R(this.button.node).to(this.clickDuration,{scale:this.clickScale},{easing:"cubicOut"}),this.animStateController.renew())}},{key:"onTransitionHover",value:function(){Ve.runTweenAsync(R(this.button.node).to(this.hoverDuration,{scale:this.hoverScale},{easing:"backOut"}),this.animStateController.renew())}},{key:"onTransitionReset",value:function(){Ve.runTweenAsync(R(this.button.node).to(this.normalDuration,{scale:this.normalScale},{easing:"cubicOut"}),this.animStateController.renew())}}]),s}(T)).prototype,"button",[Ja,Za],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=a(ro.prototype,"normalScale",[Qa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(1,1,1)}}),uo=a(ro.prototype,"normalDuration",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),co=a(ro.prototype,"hoverScale",[to],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(1.1,1.1,1.1)}}),ho=a(ro.prototype,"hoverDuration",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),po=a(ro.prototype,"clickScale",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(.9,.9,.9)}}),yo=a(ro.prototype,"clickDuration",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),oo=ro))||oo)||oo)||oo);S._RF.pop(),S._RF.push({},"ef63ctZn6BPAout9ufUgFVq","ExtendedButton",void 0);var cr,dr,hr,pr,yr=C.ccclass,vr=C.property,fr=C.disallowMultiple,gr=C.executionOrder,mr=codex.analytics,br=Ludex,wr=br.Plugins.Analytics,Sr=(void 0===wr?{}:wr).Events,kr=br.Utils.Valid,Cr=(Co=yr("ExtendedButton"),Eo=gr(111),Ao=vr(U),To=vr(U),Po=vr($.AnimationController),Oo=vr({override:!0,visible:!1}),Lo=vr({override:!0,visible:!1}),Io=vr({override:!0,visible:!1}),Ro=vr({override:!0,visible:!1}),_o=vr({override:!0,visible:!1}),Do=vr({override:!0,visible:!1}),Mo=vr({override:!0,visible:!1}),No=vr({override:!0,visible:!1}),Bo=vr({override:!0,visible:!1}),Fo=vr({override:!0,visible:!1}),xo=vr({override:!0,visible:!1}),zo=vr(W),Uo=vr(W),Go=vr(W),Ho=vr({visible:function(){return this.makeSound},type:ta}),qo=vr({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),Vo=vr({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),$o=vr({}),Co(Wo=fr(Wo=Eo((jo=a((Ko=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"clickStartEvents",jo,l(e)),r(e,"clickEndEvents",Yo,l(e)),r(e,"animationController",Xo,l(e)),r(e,"useDesktopHover",Jo,l(e)),r(e,"emitAnalyticsEvents",Zo,l(e)),r(e,"makeSound",Qo,l(e)),r(e,"soundKey",er,l(e)),r(e,"disableSpamClick",tr,l(e)),r(e,"disableSpamDelay",nr,l(e)),r(e,"isScrollViewCancelInnerEvents",ir,l(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=We.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(!e.isScrollViewCancelInnerEvents){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.setAnimationState("HOVER")))},e.onMouseLeave=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.setAnimationState("RESET")},e}return e(s,[{key:"transition",get:function(){return G.Transition.NONE},set:function(e){y(d(s.prototype),"transition",G.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return c(d(s.prototype),"normalColor",this)},set:function(e){y(d(s.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return c(d(s.prototype),"pressedColor",this)},set:function(e){y(d(s.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return c(d(s.prototype),"hoverColor",this)},set:function(e){y(d(s.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return c(d(s.prototype),"disabledColor",this)},set:function(e){y(d(s.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return c(d(s.prototype),"normalSprite",this)},set:function(e){y(d(s.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return c(d(s.prototype),"pressedSprite",this)},set:function(e){y(d(s.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return c(d(s.prototype),"hoverSprite",this)},set:function(e){y(d(s.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return c(d(s.prototype),"disabledSprite",this)},set:function(e){y(d(s.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return c(d(s.prototype),"duration",this)},set:function(e){y(d(s.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return c(d(s.prototype),"zoomScale",this)},set:function(e){y(d(s.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){c(d(s.prototype),"__preload",this).call(this),Yn.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){var e;null===(e=c(d(s.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=c(d(s.prototype),"onEnable",this))||void 0===e||e.call(this),this.node.off(H.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(q.EventType.TOUCH_START,this.onTouchStart),this.node.on(q.EventType.TOUCH_END,this.onTouchEnd),this.node.on(q.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=c(d(s.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(q.EventType.TOUCH_START,this.onTouchStart),this.node.off(q.EventType.TOUCH_END,this.onTouchEnd),this.node.off(q.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(q.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleDown",value:function(e){if(this.hasDown=!0,this.setAnimationState("DOWN"),this.makeSound&&kr.isString(this.soundKey)){var t=Ra[this.soundKey];t&&je.playSound(t)}this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=u(this.clickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"emitClickEndEvents",value:function(e){var t,n=u(this.clickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleUp",value:function(e){this.hasUp=!0,this._pressed=!1,this.hasFinishClickCycle=!0,this.setAnimationState("RESET"),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){if(this.emitAnalyticsEvents&&Sr){var t=Ye.getCurrentPage();mr.event(Sr.BUTTON_CLICK,{button_name:this.node.name,screen_name:t})}var n,i=u(this.clickEvents);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.emit([e,a.customEventData])}}catch(e){i.e(e)}finally{i.f()}this.node.emit(G.EventType.CLICK,this)}}},{key:"setAnimationState",value:function(e){this.animationController&&(this.animationController.setValue("DOWN","DOWN"===e),this.animationController.setValue("HOVER","HOVER"===e),this.animationController.setValue("RESET","RESET"===e))}},{key:"fakeClick",value:function(){var e=this;this.setAnimationState("DOWN"),this.scheduleOnce((function(){e.setAnimationState("RESET")}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}}]),s}(G)).prototype,"clickStartEvents",[Ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yo=a(Ko.prototype,"clickEndEvents",[To],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xo=a(Ko.prototype,"animationController",[Po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Ko.prototype,"transition",[Oo],Object.getOwnPropertyDescriptor(Ko.prototype,"transition"),Ko.prototype),a(Ko.prototype,"normalColor",[Lo],Object.getOwnPropertyDescriptor(Ko.prototype,"normalColor"),Ko.prototype),a(Ko.prototype,"pressedColor",[Io],Object.getOwnPropertyDescriptor(Ko.prototype,"pressedColor"),Ko.prototype),a(Ko.prototype,"hoverColor",[Ro],Object.getOwnPropertyDescriptor(Ko.prototype,"hoverColor"),Ko.prototype),a(Ko.prototype,"disabledColor",[_o],Object.getOwnPropertyDescriptor(Ko.prototype,"disabledColor"),Ko.prototype),a(Ko.prototype,"normalSprite",[Do],Object.getOwnPropertyDescriptor(Ko.prototype,"normalSprite"),Ko.prototype),a(Ko.prototype,"pressedSprite",[Mo],Object.getOwnPropertyDescriptor(Ko.prototype,"pressedSprite"),Ko.prototype),a(Ko.prototype,"hoverSprite",[No],Object.getOwnPropertyDescriptor(Ko.prototype,"hoverSprite"),Ko.prototype),a(Ko.prototype,"disabledSprite",[Bo],Object.getOwnPropertyDescriptor(Ko.prototype,"disabledSprite"),Ko.prototype),a(Ko.prototype,"duration",[Fo],Object.getOwnPropertyDescriptor(Ko.prototype,"duration"),Ko.prototype),a(Ko.prototype,"zoomScale",[xo],Object.getOwnPropertyDescriptor(Ko.prototype,"zoomScale"),Ko.prototype),Jo=a(Ko.prototype,"useDesktopHover",[zo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Zo=a(Ko.prototype,"emitAnalyticsEvents",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Qo=a(Ko.prototype,"makeSound",[Go],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),er=a(Ko.prototype,"soundKey",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),tr=a(Ko.prototype,"disableSpamClick",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),nr=a(Ko.prototype,"disableSpamDelay",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),ir=a(Ko.prototype,"isScrollViewCancelInnerEvents",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wo=Ko))||Wo)||Wo)||Wo);S._RF.pop(),S._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var Er,Ar,Tr,Pr,Or,Lr,Ir,Rr,_r,Dr,Mr,Nr,Br,Fr,xr,zr,Ur=C.ccclass,Gr=C.requireComponent,Hr=C.property,qr=Ur("OpacityToggler")(cr=Gr([B])((hr=a((dr=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"activeValue",hr,l(e)),r(e,"inActiveValue",pr,l(e)),e.signal=new Ni,e}return e(c,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.signal.abort(),this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}},{key:"changeStateFade",value:(s=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;this.signal.abort(),this.signal=new Ni;var n=e?this.activeValue:this.inActiveValue;yield Ve.runTweenAsync(R(this.opacityComponent).to(t,{opacity:n}),this.signal)})),function(){return s.apply(this,arguments)})}]),c}(T)).prototype,"activeValue",[Hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),pr=a(dr.prototype,"inActiveValue",[Hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),cr=dr))||cr)||cr;S._RF.pop(),S._RF.push({},"08623z7mLxP/4DVAyNB9srK","DebugAdsPlugin",void 0);var Vr,$r,Wr,Kr=C.ccclass,jr=C.property,Yr=C.requireComponent,Xr=Ludex,Jr=Xr.Events,Zr=Xr.Plugins.Ads.Types,Qr=codex,el=Qr.event,tl=Qr.ads,nl={color:"#00FFFF",prefix:"LOADING"},il={color:"#00FF00",prefix:"LOADED"},al={color:"#FF00FF",prefix:"LOAD FAIL"},ol={color:"#FFFF00",prefix:"SHOWING..."},rl={color:"#00FF00",prefix:"SHOW"},ll={color:"#FF0000",prefix:"SHOW FAIL"},sl={color:"#AAAAAA",prefix:"CLOSED"};Er=Kr("DebugAdsPlugin"),Ar=Yr(B),Tr=Yn.required(),Pr=jr(K),Or=Yn.required(),Lr=jr(K),Ir=Yn.required(),Rr=jr(j),_r=Yn.required(),Dr=jr(B),Er(Mr=Ar((Br=a((Nr=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"statusLabel",Br,l(e)),r(e,"timersLabel",Fr,l(e)),r(e,"logLabel",xr,l(e)),r(e,"opacity",zr,l(e)),e.logLines$=[],e.touchMs$=0,e.setupEventListeners$=function(t){[[Jr.AD_LOADING,e.onAdLoading$],[Jr.AD_LOADED,e.onAdLoaded$],[Jr.AD_LOAD_FAILED,e.onAdLoadFailed$],[Jr.AD_SHOWING,e.onAdShowing$],[Jr.AD_SHOW,e.onAdShow$],[Jr.AD_SHOW_FAILED,e.onAdShowFailed$],[Jr.AD_CLOSED,e.onAdClosed$]].forEach((function(e){var n=v(e,2),i=n[0],a=n[1];el[t](i,a)})),e.node[t](H.EventType.TOUCH_END,e.handleTouchEnd$),e.node[t](H.EventType.TOUCH_START,e.handleTouchStart$)},e.logInitializedAds$=function(){if(tl){var t=tl.getAdsInstances();t&&0!==Object.keys(t).length?(e.addLog$("Initialized ".concat(Object.keys(t).length," ad instances:"),"#00FF00"),Object.entries(t).forEach((function(t){var n=v(t,2),i=(n[0],n[1]),a=i.deviceOS,o=i.placementId;e.addLog$("".concat(o," on ").concat(a),"#00FFFF")}))):e.addLog$("No ad instances initialized","#FFFF00")}else e.addLog$("Ads plugin not available","#FF0000")},e.handleTouchStart$=function(t){(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity)&&(Date.now()-e.touchMs$<300&&(255===e.opacity.opacity?e.opacity.opacity=0:e.opacity.opacity=255),e.touchMs$=Date.now())},e.handleTouchEnd$=function(t){t.preventSwallow=0===e.opacity.opacity},e.onAdLoading$=function(t){return e.logEvent$(nl,t)},e.onAdLoaded$=function(t){return e.logEvent$(il,t)},e.onAdLoadFailed$=function(t){return e.logEvent$(al,t)},e.onAdShowing$=function(t){return e.logEvent$(ol,t)},e.onAdShow$=function(t){return e.logEvent$(rl,t)},e.onAdShowFailed$=function(t){return e.logEvent$(ll,t)},e.onAdClosed$=function(t){return e.logEvent$(sl,t)},e.logEvent$=function(t,n){var i=n.type,a=n.placementId;e.addLog$("".concat(t.prefix,": ").concat(i," (").concat(a,")"),t.color)},e.addLog$=function(t,n){var i=(new Date).toLocaleTimeString().split(" ")[0],a="<color=".concat(n,">[").concat(i,"] ").concat(t,"</color>");e.logLines$.push(a),e.logLines$.length>20&&e.logLines$.shift(),e.logLabel&&(e.logLabel.string=e.logLines$.join("\n"))},e.updateStatus$=function(){var t=tl.enabled,n=tl.getDeviceOS(),i=tl.getDegradationTracking(),a=tl.getSafeAreaBottom(1),o=Xe.getBannerAdHeight(),r="N/A",l="N/A";if(i){var s=i.lastSuccessTime;l=s>0?new Date(s).toLocaleTimeString():"Never",r="".concat(i.failedAttempts)}var u=Object.values(Zr).filter((function(e){return!Xe.isAdEnabled(e)}));e.statusLabel.string=["Enabled: ".concat(t),"DeviceOS: ".concat(n),"Last Success: ".concat(l),"Banner Height: ".concat(o),"SafeAreaBottom: ".concat(a),"Degradation Attempts: ".concat(r),"Disabled: ".concat(u.length?u.join(", "):"None")].join("\n")},e.updateTimers$=function(){var t=tl.getLastCallAdShownTime();if(t){var n=Date.now()/1e3,i=Object.values(Zr).map((function(e){var i=t[e]||0,a=i>0?(n-i).toFixed(1):"Never";return"".concat(e,": ").concat(a,"s")})).join("\n");e.timersLabel.string="Time Since Last Show\n".concat(i)}},e}return e(s,[{key:"onLoad",value:function(){var e=this;this.logInitializedAds$(),this.setupEventListeners$("on"),this.schedule((function(){e.updateStatus$(),e.updateTimers$()}),.5)}},{key:"onDestroy",value:function(){this.setupEventListeners$("off"),this.unscheduleAllCallbacks()}}]),s}(T)).prototype,"statusLabel",[Tr,Pr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fr=a(Nr.prototype,"timersLabel",[Or,Lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xr=a(Nr.prototype,"logLabel",[Ir,Rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=a(Nr.prototype,"opacity",[_r,Dr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Nr))||Mr);S._RF.pop(),S._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var ul=C.ccclass,cl=C.property,dl=C.requireComponent,hl=C.disallowMultiple,pl=C.executeInEditMode,yl=Ke.DesignSize,vl=yl.Portrait,fl=yl.Landscape;ul("DebugResolution")(Vr=hl(Vr=dl([Y])(Vr=pl(!0)(((Wr=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return e(r,[{key:"drawPortrait",get:function(){return r._drawPortrait},set:function(e){e!==r._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),r._drawPortrait=e,r._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return r._drawLandscape},set:function(e){e!==r._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),r._drawLandscape=e,r._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(Y),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){D.on($e.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=vl.WIDTH,n=vl.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=X.GREEN,e.rect(i,a,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=fl.WIDTH,n=fl.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=X.CYAN,e.rect(i,a,t,n),e.stroke()}}}]),r}(T))._drawPortrait=!0,Wr._drawLandscape=!0,a(($r=Wr).prototype,"drawPortrait",[cl],Object.getOwnPropertyDescriptor($r.prototype,"drawPortrait"),$r.prototype),a($r.prototype,"drawLandscape",[cl],Object.getOwnPropertyDescriptor($r.prototype,"drawLandscape"),$r.prototype),Vr=$r))||Vr)||Vr)||Vr);S._RF.pop(),S._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var gl,ml,bl,wl,Sl,kl,Cl,El,Al,Tl,Pl,Ol,Ll,Il,Rl,_l,Dl,Ml,Nl,Bl,Fl,xl,zl,Ul,Gl,Hl,ql,Vl,$l,Wl,Kl,jl,Yl,Xl,Jl,Zl,Ql,es,ts,ns,is,as,os,rs,ls=function(){function n(){t(this,n),this.time=0,this._value=0,this.time=0,this._value=0}return e(n,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),n}();S._RF.pop(),S._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var ss=C.ccclass,us=C.executionOrder,cs=C.property,ds=C.requireComponent,hs=Ludex,ps=hs.Utils,ys=ps.Valid,vs=ps.Array,fs=ps.Device,gs=hs.Configs.Debugger.ListPlayerDevIds,ms=codex.player,bs=X.RED,ws=X.YELLOW,Ss=X.WHITE,ks=X.BLACK;gl=ss("GameStats"),ml=us(-1e3),bl=ds([B]),wl=Yn.required(),Sl=cs(K),kl=Yn.required(),Cl=cs(K),El=Yn.required(),Al=cs(K),Tl=Yn.required(),Pl=cs(K),Ol=Yn.required(),Ll=cs(K),Il=Yn.required(),Rl=cs(K),_l=Yn.required(),Dl=cs(K),Ml=Yn.required(),Nl=cs(K),Bl=Yn.required(),Fl=cs(K),xl=Yn.required(),zl=cs(K),Ul=Yn.required(),Gl=cs(K),Hl=Yn.required(),ql=cs(F),Vl=Yn.required(),$l=cs(B),gl(Wl=ml(Wl=bl((jl=a((Kl=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"dprLabel",jl,l(e)),r(e,"fpsLabel",Yl,l(e)),r(e,"fpsRawLabel",Xl,l(e)),r(e,"drawCountLabel",Jl,l(e)),r(e,"rafTimeLabel",Zl,l(e)),r(e,"deltaTimeLabel",Ql,l(e)),r(e,"logicTimeLabel",es,l(e)),r(e,"physicTimeLabel",ts,l(e)),r(e,"renderTimeLabel",ns,l(e)),r(e,"objectMemoryUsageLabel",is,l(e)),r(e,"textureMemoryUsageLabel",as,l(e)),r(e,"bg",os,l(e)),r(e,"opacity",rs,l(e)),e.lastRafTime$=0,e.slowRefreshInterval$=1,e.mediumRefreshInterval$=.5,e.fastRefreshInterval$=.16,e.isBackgroundEnabled$=!1,e.touchMs$=0,e.isDragging$=!1,e.listenInputEvents$=function(){e.node.on(H.EventType.TOUCH_START,e.handleTouchStart$),e.node.on(H.EventType.TOUCH_MOVE,e.handleTouchMove$),e.node.on(H.EventType.TOUCH_END,e.handleTouchEnd$),e.node.on(H.EventType.TOUCH_CANCEL,e.handleTouchEnd$),e.node.on(H.EventType.MOUSE_WHEEL,(function(){console.info(l(e)),D.emit($e.REQUEST_DYNAMIC_ATLAS)}))},e.handleTouchStart$=function(t){(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity)&&(e.isDragging$=!1,Date.now()-e.touchMs$<300&&(255===e.opacity.opacity?e.opacity.opacity=0:(e.opacity.opacity=255,D.emit($e.REQUEST_DYNAMIC_ATLAS))),e.touchMs$=Date.now())},e.handleTouchMove$=function(t){if(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity){var n=t.touch.getUIDelta();!e.isDragging$&&n.length()>10&&(e.isDragging$=!0),e.isDragging$&&e.node.setPosition(e.node.position.x+n.x,e.node.position.y+n.y)}},e.handleTouchEnd$=function(t){t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity&&(e.isDragging$||(e.bg.enabled=!e.bg.enabled,e.isBackgroundEnabled$=e.bg.enabled),e.isDragging$=!1)},e.canDisplayStats$=function(){return ys.isDebugger()||vs.has(gs,ms.getPlayerId())},e.startUpdateStats$=function(){e.schedule(e.updateFastStats$,e.fastRefreshInterval$),e.schedule(e.updateSlowStats$,e.slowRefreshInterval$),e.schedule(e.updateMediumStats$,e.mediumRefreshInterval$),requestAnimationFrame(e.handleRequestAnimationFrame$)},e.updateFastStats$=function(){e.updateFpsRaw$(),e.updateRafTime$(),e.updateDeltaTime$()},e.updateSlowStats$=function(){e.updateDPR$(),e.updateDrawCalls$(),e.updateObjectMemoryUsage$(),e.updateTextureMemoryUsage$()},e.updateMediumStats$=function(){e.updateFps$(),e.updateLogicTime$(),e.updatePhysicTime$(),e.updateRenderTime$()},e.calcRafTime$=function(t){var n;null!==(n=e.node)&&void 0!==n&&n.isValid&&(e.rafTimeCounter$.end(t),e.lastRafTime$=t,e.handleRequestAnimationFrame$())},e.handleRequestAnimationFrame$=function(){e.rafTimeCounter$.start(e.lastRafTime$),requestAnimationFrame(e.calcRafTime$)},e.updateFps$=function(){var t=e.getFps$();e.updateFpsColor$(t),e.fpsLabel.string="FPS: ".concat(t)},e.updateFpsColor$=function(t){t<30?e.fpsLabel.color=bs:t<48?e.fpsLabel.color=ws:e.setColorWithBackground$(e.fpsLabel)},e.updateFpsRaw$=function(){var t=e.getFpsRaw$();e.updateFpsRawColor$(t),e.fpsRawLabel.string="FPS Raw: ".concat(t)},e.updateFpsRawColor$=function(t){t<30?e.fpsRawLabel.color=bs:t<48?e.fpsRawLabel.color=ws:e.setColorWithBackground$(e.fpsRawLabel)},e.updateDrawCalls$=function(){var t=e.getDrawCalls$();e.updateDrawCallsColor$(t),e.drawCountLabel.string="Draw Calls: ".concat(t)},e.updateDrawCallsColor$=function(t){var n=J.os===J.OS.IOS,i=n?60:25;t>(n?80:40)?e.drawCountLabel.color=bs:t>i?e.drawCountLabel.color=ws:e.setColorWithBackground$(e.drawCountLabel)},e.updateRafTime$=function(){var t=e.getRafTime$();e.updateRafTimeColor$(t),e.rafTimeLabel.string="RAF Time: ".concat(t,"ms")},e.updateRafTimeColor$=function(t){t>33?e.rafTimeLabel.color=bs:t>20?e.rafTimeLabel.color=ws:e.setColorWithBackground$(e.rafTimeLabel)},e.updateDeltaTime$=function(){var t=e.getDeltaTime$();e.updateDeltaTimeColor$(t),e.deltaTimeLabel.string="Delta Time: ".concat(t,"ms")},e.updateDeltaTimeColor$=function(t){t>33?e.deltaTimeLabel.color=bs:t>20?e.deltaTimeLabel.color=ws:e.setColorWithBackground$(e.deltaTimeLabel)},e.updateLogicTime$=function(){var t=e.getLogicTime$();e.updateLogicTimeColor$(t),e.logicTimeLabel.string="Logic Time: ".concat(t,"ms")},e.updateLogicTimeColor$=function(t){t>10?e.logicTimeLabel.color=bs:t>5?e.logicTimeLabel.color=ws:e.setColorWithBackground$(e.logicTimeLabel)},e.updatePhysicTime$=function(){var t=e.getPhysicTime$();e.updatePhysicTimeColor$(t),e.physicTimeLabel.string="Physic Time: ".concat(t,"ms")},e.updatePhysicTimeColor$=function(t){t>10?e.physicTimeLabel.color=bs:t>5?e.physicTimeLabel.color=ws:e.setColorWithBackground$(e.physicTimeLabel)},e.updateRenderTime$=function(){var t=e.getRenderTime$();e.updateRenderTimeColor$(t),e.renderTimeLabel.string="Render Time: ".concat(t,"ms")},e.updateRenderTimeColor$=function(t){t>10?e.renderTimeLabel.color=bs:t>5?e.renderTimeLabel.color=ws:e.setColorWithBackground$(e.renderTimeLabel)},e.updateObjectMemoryUsage$=function(){var t=e.getObjectMemoryUsage$();e.updateObjectMemoryUsageColor$(t),e.objectMemoryUsageLabel.string="Object Mem: ".concat(t,"MB")},e.updateObjectMemoryUsageColor$=function(t){t>40?e.objectMemoryUsageLabel.color=bs:t>25?e.objectMemoryUsageLabel.color=ws:e.setColorWithBackground$(e.objectMemoryUsageLabel)},e.updateTextureMemoryUsage$=function(){var t=e.getTextureMemoryUsage$();e.updateTextureMemoryUsageColor$(t),e.textureMemoryUsageLabel.string="Texture Mem: ".concat(t,"MB")},e.updateTextureMemoryUsageColor$=function(t){t>200?e.textureMemoryUsageLabel.color=bs:t>100?e.textureMemoryUsageLabel.color=ws:e.setColorWithBackground$(e.textureMemoryUsageLabel)},e.updateDPR$=function(){var t=fs.pixelRatio();e.updateDPRColor$(t),e.dprLabel.string="DPR: ".concat(t)},e.updateDPRColor$=function(t){t>2?e.dprLabel.color=bs:t<=1?e.dprLabel.color=ws:e.setColorWithBackground$(e.dprLabel)},e.setColorWithBackground$=function(t){var n=e.isBackgroundEnabled$?ks:Ss;t.color.equals(n)||(t.color=n)},e.getFps$=function(){if(!A.root)return 0;var e=A.root.fps;return Math.round(e)||0},e.getDrawCalls$=function(){return A.root&&A.root.device.numDrawCalls||0},e.toFixed$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(t))||0},e.getFpsRaw$=function(){return e.toFixed$(1e3/e.rafTimeCounter$.value,0)},e.getRafTime$=function(){return e.toFixed$(e.rafTimeCounter$.value)},e.getDeltaTime$=function(){return e.toFixed$(1e3*D.deltaTime)},e.getLogicTime$=function(){return e.toFixed$(e.logicTimeCounter$.value)},e.getPhysicTime$=function(){return e.toFixed$(e.physicTimeCounter$.value)},e.getRenderTime$=function(){return e.toFixed$(e.renderTimeCounter$.value)},e.getObjectMemoryUsage$=function(){if(!A.root)return 0;var t=A.root.device.memoryStatus;return e.toFixed$(t.bufferSize/1048576,4)||0},e.getTextureMemoryUsage$=function(){if(!A.root)return 0;var t=A.root.device.memoryStatus;return e.toFixed$(t.textureSize/1048576,4)||0},e.beforeUpdate$=function(){var t=performance.now();e.logicTimeCounter$.start(t)},e.afterUpdate$=function(){var t=performance.now();e.logicTimeCounter$.end(t)},e.beforePhysics$=function(){var t=performance.now();e.physicTimeCounter$.start(t)},e.afterPhysics$=function(){var t=performance.now();e.physicTimeCounter$.end(t)},e.beforeDraw$=function(){var t=performance.now();e.renderTimeCounter$.start(t)},e.afterDraw$=function(){var t=performance.now();e.renderTimeCounter$.end(t)},e}return e(s,[{key:"__preload",value:function(){this.listenInputEvents$()}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.bg.enabled=!1,this.canDisplayStats$()?(this.node.active=!0,this.rafTimeCounter$=new ls,this.logicTimeCounter$=new ls,this.physicTimeCounter$=new ls,this.renderTimeCounter$=new ls,A.on(Z.EVENT_BEFORE_UPDATE,this.beforeUpdate$,this),A.on(Z.EVENT_AFTER_UPDATE,this.afterUpdate$,this),A.on(Z.EVENT_BEFORE_PHYSICS,this.beforePhysics$,this),A.on(Z.EVENT_AFTER_PHYSICS,this.afterPhysics$,this),A.on(Z.EVENT_BEFORE_DRAW,this.beforeDraw$,this),A.on(Z.EVENT_AFTER_DRAW,this.afterDraw$,this),this.startUpdateStats$()):this.node.active=!1}},{key:"onDestroy",value:function(){this.canDisplayStats$()&&(A.off(Z.EVENT_BEFORE_UPDATE,this.beforeUpdate$,this),A.off(Z.EVENT_AFTER_UPDATE,this.afterUpdate$,this),A.off(Z.EVENT_BEFORE_PHYSICS,this.beforePhysics$,this),A.off(Z.EVENT_AFTER_PHYSICS,this.afterPhysics$,this),A.off(Z.EVENT_BEFORE_DRAW,this.beforeDraw$,this),A.off(Z.EVENT_AFTER_DRAW,this.afterDraw$,this),this.unschedule(this.updateSlowStats$),this.unschedule(this.updateFastStats$),this.unschedule(this.updateMediumStats$),this.node.off(H.EventType.TOUCH_START,this.handleTouchStart$),this.node.off(H.EventType.TOUCH_MOVE,this.handleTouchMove$),this.node.off(H.EventType.TOUCH_END,this.handleTouchEnd$),this.node.off(H.EventType.TOUCH_CANCEL,this.handleTouchEnd$))}}]),s}(T)).prototype,"dprLabel",[wl,Sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yl=a(Kl.prototype,"fpsLabel",[kl,Cl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xl=a(Kl.prototype,"fpsRawLabel",[El,Al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jl=a(Kl.prototype,"drawCountLabel",[Tl,Pl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zl=a(Kl.prototype,"rafTimeLabel",[Ol,Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ql=a(Kl.prototype,"deltaTimeLabel",[Il,Rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),es=a(Kl.prototype,"logicTimeLabel",[_l,Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ts=a(Kl.prototype,"physicTimeLabel",[Ml,Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns=a(Kl.prototype,"renderTimeLabel",[Bl,Fl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=a(Kl.prototype,"objectMemoryUsageLabel",[xl,zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as=a(Kl.prototype,"textureMemoryUsageLabel",[Ul,Gl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=a(Kl.prototype,"bg",[Hl,ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs=a(Kl.prototype,"opacity",[Vl,$l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wl=Kl))||Wl)||Wl);S._RF.pop(),S._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var Cs,Es=function(e){return e.CHALLENGE_FRIENDS="challenge-friends",e.REPLAY_FRIENDS="replay-friends",e.SHOW_CHALLENGE_RESULTS="show-challenge-results",e.UPDATE_MUSIC="update-music",e.NEXT_LEVEL="next-level",e.MAX_LEVEL="max-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.GAME_FINISH="game-finish",e.GAME_EXIT="game-exit",e.USE_ITEM="use-item",e.SKIP_LEVEL="skip-level",e.ADD_ITEM="add-item",e.ADD_ITEMS="add-items",e.REFRESH_ITEMS="refresh-items",e.ADD_COINS="add-coins",e.REMOVE_COINS="remove-coins",e.REMOVE_COINS_SUCCESS="remove-coins-success",e.REMOVE_COINS_FAILED="remove-coins-failed",e.COIN_CHANGED="coin-changed",e.ABORT_COIN_ANIMATION="abort-coin-animation",e.ADD_STARS="add-stars",e.PAUSE_TIME="pause-time",e.RESUME_TIME="resume-time",e.TIME_OUT="time-out",e.HALF_TIME="half-time",e.RESCUE_START="rescue-time",e.RESCUE_FINISHED="clock-animation-finished",e.TIME_UPDATED="time-updated",e.APPLY_GRAVITY="apply-gravity",e.GRID_ORIENTATION_CHANGE="grid-orientation-change",e.IDLE_ENTER="idle-enter",e.IDLE_EXIT="idle-exit",e.GRID_MATCH="grid-match",e.GRID_MATCH_SUCCESS="grid-match-success",e.GRID_MATCH_FAIL="grid-match-fail",e.GRID_CLEAR="grid-clear",e.GRID_SPAWN="grid-spawn",e.GRID_CREATE="grid-create",e.GRID_RESIZE="grid-resize",e.TILE_CLICK="tile-click",e.BOMB_EXPLODE="bomb-explode",e.SHOW_HINT="show-hint",e.ADD_COMBO="add-combo",e.COMBO_UPDATED="combo-updated",e.COMBO_ENDED="combo-ended",e.COMBO_PROGRESS="combo-progress",e.ADD_SCORE="add-score",e.SCORE_UPDATED="score-updated",e.SHOW_UI="show-ui",e.HIDE_UI="hide-ui",e.AUTO_PLAY="auto-play",e.GUIDE_MASK_CLICKED="guide-mask-clicked",e.ITEM_MASK_CLICKED="item-mask-clicked",e.EFFECTS_ANIMATION_START="effects-start",e.EFFECTS_ANIMATION_END="effects-end",e}(Es||{});S._RF.pop(),S._RF.push({},"8249dDH5xBEc4nnCGRgSjaW","PanelAnimationController",void 0);var As,Ts,Ps,Os,Ls,Is,Rs,_s,Ds,Ms,Ns,Bs,Fs,xs,zs,Us,Gs,Hs,qs=(0,C.ccclass)("PanelAnimationController")(Cs=function(a){n(l,a);var r=i(l);function l(){var e;t(this,l);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=r.call.apply(r,[this].concat(i))).animators=new Set,e.eventTarget=new Q,e.handleRegistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)&&console.warn("Animator already registered."),e.animators.add(t)},e.handleUnregistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)||console.warn("Animator not registered."),e.animators.delete(t)},e.handleShowUIs=function(){var t=o((function*(t){var n,i,a,o=!1,r=[],l=u(e.animators);try{for(l.s();!(a=l.n()).done;){var s=a.value;r.push(s)}}catch(e){l.e(e)}finally{l.f()}for(var c=[],d=0,h=r;d<h.length;d++){var p,y=h[d];if(!y.isReadyForAnimation()&&!o)o=!0,null==t||null===(p=t.fallback)||void 0===p||p.call(t);c.push(y.handleShowUI())}yield Promise.all(c),null==t||null===(n=t.onComplete)||void 0===n||n.call(t),null===(i=e.eventTarget)||void 0===i||i.emit(Es.SHOW_UI)}));return function(e){return t.apply(this,arguments)}}(),e.handleHideUIs=function(){var t=o((function*(t){var n,i,a,o=!1,r=[],l=u(e.animators);try{for(l.s();!(a=l.n()).done;){var s=a.value;r.push(s)}}catch(e){l.e(e)}finally{l.f()}for(var c=[],d=0,h=r;d<h.length;d++){var p,y=h[d];if(!y.isReadyForAnimation()&&!o)o=!0,null==t||null===(p=t.fallback)||void 0===p||p.call(t);c.push(y.handleHideUI())}yield Promise.all(c),null==t||null===(n=t.onComplete)||void 0===n||n.call(t),null===(i=e.eventTarget)||void 0===i||i.emit(Es.HIDE_UI)}));return function(e){return t.apply(this,arguments)}}(),e}return e(l,[{key:"onEnable",value:function(){this.node.scene.on(Es.SHOW_UI,this.handleShowUIs,this),this.node.scene.on(Es.HIDE_UI,this.handleHideUIs,this)}},{key:"onDisable",value:function(){this.node.scene.off(Es.SHOW_UI,this.handleShowUIs,this),this.node.scene.off(Es.HIDE_UI,this.handleHideUIs,this)}},{key:"showUI",value:function(){return this.handleShowUIs()}},{key:"hideUI",value:function(){return this.handleHideUIs()}},{key:"on",value:function(e,t,n,i){this.eventTarget.on(e,t,n,i)}},{key:"off",value:function(e,t,n){this.eventTarget.off(e,t,n)}}],[{key:"getController",value:function(e){for(var t=null,n=e;null!==n;){if(t=n.getComponent(l))return t;n=n.parent}return t}},{key:"registerAnimator",value:function(e){var t=this.getController(e.node);t?t.handleRegistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}},{key:"unregisterAnimator",value:function(e){var t=this.getController(e.node);t?t.handleUnregistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}}]),l}(T))||Cs;S._RF.pop(),S._RF.push({},"f190aWZvVlGiplYX4XrZG3a","PanelAnimator",void 0);var Vs,$s=C.ccclass,Ws=C.property,Ks=Ludex.Utils.Object,js=(As=$s("AnimationConfig"),Ts=Ws({type:[I]}),As((Ls=a((Os=function(){function n(){t(this,n),r(this,"startHidden",Ls,this),r(this,"nodes",Is,this),r(this,"posOffset",Rs,this),r(this,"showEase",_s,this),r(this,"hideEase",Ds,this),r(this,"showDuration",Ms,this),r(this,"hideDuration",Ns,this)}return e(n,[{key:"setConfig",value:function(e){e&&Ks.assign(this,e)}}]),n}()).prototype,"startHidden",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Is=a(Os.prototype,"nodes",[Ts],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Rs=a(Os.prototype,"posOffset",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_s=a(Os.prototype,"showEase",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),Ds=a(Os.prototype,"hideEase",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backIn"}}),Ms=a(Os.prototype,"showDuration",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ns=a(Os.prototype,"hideDuration",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ps=Os))||Ps),Ys=(Bs=$s("PanelAnimator"),Fs=Ws({type:js,displayName:"Top animation nodes"}),xs=Ws({type:js,displayName:"Bottom animation nodes"}),Bs((Gs=a((Us=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"topConfig",Gs,l(e)),r(e,"botConfig",Hs,l(e)),e.isReady=!1,e}return e(d,[{key:"onEnable",value:function(){qs.registerAnimator(this)}},{key:"onDisable",value:function(){qs.unregisterAnimator(this)}},{key:"onLoad",value:function(){this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos(),this.isReady=!0}},{key:"initUIPos",value:function(){this.topAnimator.switchState(this.topConfig.startHidden?"hidden":"shown",!0),this.botAnimator.switchState(this.botConfig.startHidden?"hidden":"shown",!0)}},{key:"isReadyForAnimation",value:function(){return this.isReady}},{key:"handleShowUI",value:(u=o((function*(){if(this.isReady)return Promise.all([this.topAnimator.switchState("shown"),this.botAnimator.switchState("shown")]);console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"))})),function(){return u.apply(this,arguments)})},{key:"handleHideUI",value:(s=o((function*(){if(this.isReady)return Promise.all([this.topAnimator.switchState("hidden"),this.botAnimator.switchState("hidden")]);console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"))})),function(){return s.apply(this,arguments)})},{key:"createAnimator",value:function(e,t){var n=e.nodes,i=e.posOffset,a=e.showEase,r=e.hideEase,l=e.showDuration,s=e.hideDuration,u=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom}:{mode:"position",value:e.node.position.y}})),c=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top+i}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom-i}:{mode:"position",value:e.node.position.y+i}})),h="shown",p=new Ni;return{switchState:function(){var e=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];p.abort();var i=new Ni;if(p=i,h!==e){h=e;var o="hidden"===e?u:c,y="hidden"===e?c:u,v="hidden"===e?s:l,f="hidden"===e?r:a,g=function(){for(var e=0,t=n.length;e<t;e++){var i=n[e],a=o[e],r=y[e].value;d.setToTargetImmediately(i,a,r)}};t?g():(i.addAbortListener(g),yield Promise.all(n.map((function(e,t){var n=o[t],a=y[t].value;return Ve.runTweenAsync(d.getTween({widget:e,config:n,target:a,easing:f,duration:v}),i)}))),i.aborted||i.removeAbortListener(g))}}));return function(t){return e.apply(this,arguments)}}()}}},{key:"setAnimator",value:function(e){var t=e.topConfig,n=e.botConfig,i=new js,a=new js;i.setConfig(t),a.setConfig(n),this.topConfig=i,this.botConfig=a,this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos()}}],[{key:"getTween",value:function(e){var t=e.widget,n=e.config,i=e.target,a=e.easing,o=e.duration;return"top"===n.mode?R(t).call((function(){t.top=n.value})).to(o,{top:i},{easing:a}):"bottom"===n.mode?R(t).call((function(){t.bottom=n.value})).to(o,{bottom:i},{easing:a}):R(t.node.position).call((function(){t.node.setPosition(t.node.position.x,n.value,t.node.position.z)})).to(o,{y:i},{easing:a})}},{key:"setToTargetImmediately",value:function(e,t,n){"top"===t.mode&&(e.top=n),"bottom"===t.mode&&(e.bottom=n);var i=e.node.position.x,a=n,o=e.node.position.z;e.node.setPosition(i,a,o)}}]),d}(T)).prototype,"topConfig",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new js}}),Hs=a(Us.prototype,"botConfig",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new js}}),zs=Us))||zs);S._RF.pop(),S._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var Xs,Js=C.ccclass,Zs=C.disallowMultiple,Qs=C.executeInEditMode,eu=C.requireComponent,tu=Js("ParticleSystem2DExtra")(Vs=Qs(!0)(Vs=Zs(!0)(Vs=eu(ee)(Vs=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var o=i[a];e.updateParticle(o,n)}t(n)}},e}return e(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(ee),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),r}(T))||Vs)||Vs)||Vs)||Vs;S._RF.pop(),S._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);var nu,iu,au,ou,ru,lu,su,uu,cu,du,hu,pu,yu,vu,fu,gu,mu,bu,wu,Su,ku,Cu;(0,C.ccclass)("ExampleParticleSystem2DExtra")(Xs=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"initParticle",value:function(e){e.maxSize=te.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=te.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+te.randomRange(-350,350),e.y=n+te.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(tu));S._RF.pop(),S._RF.push({},"6ea01hdw/9MHb28SCDAiRss","ResizeWithBannerAd",void 0);var Eu,Au,Tu,Pu,Ou,Lu,Iu,Ru,_u,Du,Mu,Nu,Bu=C.ccclass,Fu=C.requireComponent,xu=C.property,zu=codex,Uu=zu.ads,Gu=zu.event,Hu=Ludex,qu=Hu.Events,Vu=Hu.Plugins.Ads,$u=void 0===Vu?{}:Vu,Wu=$u.Types,Ku=$u.Status,ju=Hu.Utils,Yu=ju.Array,Xu=ju.Function,Ju=ju.Device,Zu=["top","topleft","topright"],Qu=["bottom","bottomleft","bottomright"],ec=["left","topleft","bottomleft"],tc=["right","topright","bottomright"];nu=Bu("ResizeWithBannerAd"),iu=Fu(I),au=Yn.required(),ou=xu(W),ru=Yn.required(),lu=xu(W),su=Yn.required(),uu=xu(W),cu=Yn.required(),du=xu(W),hu=Yn.required(),pu=xu(W),yu=Yn.required(),vu=xu(I),nu(fu=iu((mu=a((gu=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"includeSAB",mu,l(e)),r(e,"includeRightBanner",bu,l(e)),r(e,"includeBottomBanner",wu,l(e)),r(e,"includeLeftBanner",Su,l(e)),r(e,"closeWhenAdFailed",ku,l(e)),r(e,"widget",Cu,l(e)),e.setupEventListeners$=function(t){[[qu.AD_SHOWING,e.handleOnAdShowing$],[qu.AD_CLOSED,e.handleOnAdClosed$],[qu.AD_SHOW_FAILED,e.handleOnAdFailed$],[$e.VIEW_RESIZED,e.handleOnResize$]].forEach((function(e){var n=v(e,2),i=n[0],a=n[1];Gu[t](i,a)}))},e.handleOnAdShowing$=function(t){var n=t.placementId,i=t.type;if(e.checkValid$()&&n&&Wu&&i===Wu.BANNER){try{if(!Uu.getAd(Wu.BANNER,n))return}catch(e){return void console.debug("Error getting banner ad:",e)}e.resizeWhenBannerAdShow$(n),e.emitResizeEvent()}},e.handleOnAdClosed$=function(t){var n=t.placementId,i=t.type;if(e.checkValid$()&&n&&Wu&&i===Wu.BANNER){try{if(!Uu.getAd(Wu.BANNER,n))return}catch(e){return void console.debug("Error getting banner ad:",e)}e.resizeWhenBannerAdClose$(n),e.emitResizeEvent()}},e.handleOnAdFailed$=function(t){var n=t.placementId,i=t.type;e.closeWhenAdFailed&&e.checkValid$()&&n&&Wu&&i===Wu.BANNER&&(e.resizeWhenBannerAdClose$(n),e.emitResizeEvent())},e.handleOnResize$=function(){if(e.checkValid$()&&Wu&&Ku)if(Xe.isAdEnabled(Wu.BANNER)){var t=Uu.getAdsByType(Wu.BANNER);0!==t.length?t.forEach((function(t){var n=Uu.getAdStatus(Wu.BANNER,t.placementId);n&&(n===Ku.SHOWING||Ju.isIOS()?e.resizeWhenBannerAdShow$(t.placementId):n===Ku.IDLE&&e.resizeWhenBannerAdClose$(t.placementId))})):e.resizeSafeAreaBottom$()}else e.resizeSafeAreaBottom$()},e.getBannerHeight$=function(t,n){try{var i=Uu.getBannerConfig(t),a=i.PlacementId,o=i.Position,r=e.includeSAB&&"bottom"===o;return Uu.getBannerHeight(a,n,r)}catch(e){return console.debug("[ResizeWithBannerAd] Error getting banner ad:",e),0}},e.resizeWhenBannerAdShow$=function(t){var n,i,a,o,r=We.cssSizeToWorldSize(1),l=e.getBannerHeight$(t,r),s=Uu.getBannerConfig(t),u=s.BannerWidth,c=s.Position;if("top"===c)n=l;else if("bottom"===c)e.includeBottomBanner?i=l:e.includeSAB&&(i=Uu.getSafeAreaBottom(r));else if("left"===c||"right"===c){if(void 0===u)return;var d=u;"getBannerOffset"in GameSDK.extra&&(d+=GameSDK.extra.getBannerOffset()),"left"===c&&e.includeLeftBanner?a=d*r:"right"===c&&e.includeRightBanner&&(o=d*r)}e.updateWidgets$({top:n,bottom:i,left:a,right:o})},e.resizeWhenBannerAdClose$=function(t){var n=Uu.getBannerConfig(t).Position,i=We.cssSizeToWorldSize(1),a=e.includeSAB?Uu.getSafeAreaBottom(i):0;e.updateWidgets$({top:Yu.has(Zu,n)?0:void 0,bottom:Yu.has(Qu,n)?a:void 0,left:Yu.has(ec,n)?0:void 0,right:Yu.has(tc,n)?0:void 0})},e.resizeSafeAreaBottom$=function(){var t=We.cssSizeToWorldSize(1),n=e.includeSAB?Uu.getSafeAreaBottom(t):0;e.updateWidgets$({bottom:n})},e.updateWidgets$=function(t){var n=t.top,i=t.bottom,a=t.left,o=t.right;e.widget.top=null!=n?n:e.widget.top,e.widget.bottom=null!=i?i:e.widget.bottom,e.widget.left=null!=a?a:e.widget.left,e.widget.right=null!=o?o:e.widget.right,ne.instance.emit("canvas-resize")},e.emitResizeEvent=Xu.debounce((function(){D.emit($e.WIDGET_RESIZED)}),100),e.checkValid$=function(){return e.node.activeInHierarchy&&null!==e.node.parent&&void 0!==e.node.parent},e}return e(s,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this),this.setupEventListeners$("on")}},{key:"onDestroy",value:function(){this.setupEventListeners$("off")}},{key:"start",value:function(){this.handleOnResize$()}}]),s}(T)).prototype,"includeSAB",[au,ou],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),bu=a(gu.prototype,"includeRightBanner",[ru,lu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),wu=a(gu.prototype,"includeBottomBanner",[su,uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Su=a(gu.prototype,"includeLeftBanner",[cu,du],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ku=a(gu.prototype,"closeWhenAdFailed",[hu,pu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cu=a(gu.prototype,"widget",[yu,vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fu=gu))||fu);S._RF.pop(),S._RF.push({},"3825fBvhGRPUK6d/ohif+v0","PreloadSprite",void 0);var nc=C.ccclass,ic=C.property,ac=C.requireComponent,oc=Ke.Layout,rc=function(e){return e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape",e}(rc||{}),lc=[oc.Portrait,oc.Landscape];M(rc);var sc,uc,cc,dc,hc,pc,yc,vc,fc,gc,mc;Eu=nc("PreloadSprite"),Au=ac(F),Tu=ic({type:rc}),Pu=ic({type:Je}),Ou=ic({type:W}),Lu=Yn.required(),Eu(Iu=Au((_u=a((Ru=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"layout",_u,l(e)),r(e,"path",Du,l(e)),r(e,"packable",Mu,l(e)),r(e,"sprite",Nu,l(e)),e}return e(c,[{key:"__preload",value:function(){this.sprite=this.getComponent(F),Yn.validateRequiredProperties(this,c),D.on($e.ORIENTATION_CHANGED,this.loadSpriteFrame,this),this.loadSpriteFrame()}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}},{key:"loadSpriteFrame",value:(s=o((function*(){if(this.sprite.spriteFrame)this.unlistenEvent();else if(Ze.getCurrentLayout()===lc[this.layout]&&this.path){var e="".concat(Qe[this.path],"/spriteFrame");if(e){var t=yield qe.loadSpriteFrameAsync(e,this.packable);this.enabledInHierarchy&&!this.sprite.spriteFrame?(this.sprite.spriteFrame=t,this.unlistenEvent()):this.unlistenEvent()}}})),function(){return s.apply(this,arguments)})},{key:"unlistenEvent",value:function(){D.off($e.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}}]),c}(T)).prototype,"layout",[Tu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Du=a(Ru.prototype,"path",[Pu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Mu=a(Ru.prototype,"packable",[Ou],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nu=a(Ru.prototype,"sprite",[Lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iu=Ru))||Iu);S._RF.pop(),S._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var bc,wc,Sc,kc,Cc,Ec,Ac,Tc=C.ccclass,Pc=C.property,Oc=C.executeInEditMode,Lc=C.requireComponent,Ic=(sc=Tc("TapperedProgressBar"),uc=Lc(B),cc=Pc({type:B,displayName:"Fill opacity"}),dc=Pc({type:F,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),hc=Pc({type:F,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),pc=Pc({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),sc(yc=Oc(yc=uc((fc=a((vc=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"uiOpacity",fc,l(e)),r(e,"leftCap",gc,l(e)),r(e,"rightCap",mc,l(e)),e}return e(s,[{key:"progress",get:function(){return c(d(s.prototype),"progress",this)},set:function(e){y(d(s.prototype),"progress",e,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity)if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var e=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=e}}},{key:"start",value:function(){this.updateAppearance()}}]),s}(ie)).prototype,"uiOpacity",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gc=a(vc.prototype,"leftCap",[dc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mc=a(vc.prototype,"rightCap",[hc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a(vc.prototype,"progress",[pc],Object.getOwnPropertyDescriptor(vc.prototype,"progress"),vc.prototype),yc=vc))||yc)||yc)||yc);S._RF.pop(),S._RF.push({},"aa60frMJLtIlJZh2yJhMp1s","DynamicLabel",void 0);var Rc,_c,Dc,Mc,Nc,Bc,Fc,xc,zc,Uc,Gc,Hc,qc,Vc,$c,Wc,Kc,jc,Yc,Xc,Jc,Zc,Qc,ed,td,nd,id,ad,od,rd,ld,sd,ud,cd,dd,hd,pd,yd,vd,fd,gd=C.ccclass,md=C.property,bd=C.executeInEditMode,wd=C.requireComponent;bc=gd("DynamicLabel"),wc=wd(K),Sc=bd(!0),kc=md({type:L,min:1,max:200}),Cc=md({type:L,min:.1,max:4}),bc(Ec=wc(Ec=Sc((a((Ac=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i)))._quality=1,e._size=1,e._outlineWidth=0,e._shadowOffset=new ae(0,0),e}return e(r,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.label.fontSize=this.size*this.quality}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.node.scale=new V(1/this.quality,1/this.quality,1),this.label.fontSize=this.size*this.quality,this.label.outlineWidth=this._outlineWidth*this.quality,this.label.shadowOffset=this._shadowOffset.multiplyScalar(this.quality)}},{key:"__preload",value:function(){this.label=this.getComponent(K)}},{key:"start",value:function(){this._quality=1/this.node.scale.x,this._size=this.label.fontSize/this.quality,this._outlineWidth=this.label.outlineWidth,this._shadowOffset=this.label.shadowOffset,this.quality=window.devicePixelRatio,console.info(" ".concat(this.node.name,"<Label> quality:"),this.quality)}}]),r}(T)).prototype,"size",[kc],Object.getOwnPropertyDescriptor(Ac.prototype,"size"),Ac.prototype),a(Ac.prototype,"quality",[Cc],Object.getOwnPropertyDescriptor(Ac.prototype,"quality"),Ac.prototype),Ec=Ac))||Ec)||Ec);S._RF.pop(),S._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var Sd=C.ccclass,kd=C.property,Cd=C.executeInEditMode,Ed=C.disallowMultiple,Ad=Ludex,Td=Ad.Utils,Pd=Td.Signal,Od=(Td.Function,Td.Array),Ld=Ad.Events,Id=codex,Rd=Id.language,_d=Id.event,Dd=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});M(Dd);var Md,Nd,Bd,Fd,xd,zd,Ud,Gd,Hd,qd,Vd,$d,Wd,Kd,jd,Yd,Xd,Jd,Zd,Qd="localize-params-updated",eh=(Rc=Sd("LocalizeParams"),_c=kd({visible:!1}),Dc=kd(E),Rc((Bc=a((Nc=function(){function n(){t(this,n),r(this,"_text",Bc,this)}return e(n,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,D.emit(Qd,{text:e,param:this})}}]),n}()).prototype,"_text",[_c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(Nc.prototype,"text",[Dc],Object.getOwnPropertyDescriptor(Nc.prototype,"text"),Nc.prototype),Mc=Nc))||Mc),th=(Fc=Sd("Localize"),xc=Cd(!0),zc=kd({visible:!1}),Uc=kd({type:E,visible:function(){return this.l10nType===Dd.Texture}}),Gc=kd({visible:!1}),Hc=kd({type:x(Dd)}),qc=kd({type:K,visible:function(){return this.l10nType===Dd.Text}}),Vc=kd({visible:function(){return this.l10nType===Dd.Text}}),$c=kd({type:[eh],visible:function(){return this.l10nType===Dd.Text}}),Wc=kd({type:F,visible:function(){return this.l10nType===Dd.Texture}}),Kc=kd({visible:function(){return this.l10nType===Dd.Texture}}),jc=kd({visible:!1}),Yc=kd({type:E}),Xc=Yn.onlyRunInLifeCycleAsync,Jc=Yn.onlyRunInLifeCycleAsync,Zc=Yn.onlyRunInLifeCycleAsync,Qc=Yn.onlyRunInLifeCycleAsync,ed=Yn.onlyRunInLifeCycle,td=Yn.onlyRunInLifeCycleAsync,nd=Yn.onlyRunInLifeCycleAsync,id=Yn.onlyRunInLifeCycleAsync,ad=Yn.onlyRunInLifeCycleAsync,od=Yn.onlyRunInLifeCycle,rd=Yn.onlyRunInLifeCycleAsync,Fc(ld=Ed(ld=xc((ud=a((sd=function(a){n(k,a);var s,u,c,d,h,p,y,v,g,m,b,w,S=i(k);function k(){var e;t(this,k);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=S.call.apply(S,[this].concat(i))).localized=!1,r(e,"_defaultLocale",ud,l(e)),r(e,"_l10nType",cd,l(e)),r(e,"label",dd,l(e)),r(e,"updateFont",hd,l(e)),r(e,"params",pd,l(e)),r(e,"sprite",yd,l(e)),r(e,"packable",vd,l(e)),r(e,"_key",fd,l(e)),e.updateSignalController=new Pd.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;Od.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return e(k,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return Od.has(et,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(et.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===Dd.Texture&&(this.label=void 0,this.params=[]),e===Dd.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new eh);for(var t=0,n=this.params.length;t<n;t++){var i,a=this.params[t];a.text=null!==(i=e[t])&&void 0!==i?i:a.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once($e.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===Dd.Text&&Rd.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===Dd.Texture&&Rd.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){_d.on(Ld.LANGUAGE_CHANGED,this.updateLocalization),D.on(Qd,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){_d.off(Ld.LANGUAGE_CHANGED,this.updateLocalization),D.off(Qd,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(w=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.enabledInHierarchy&&void 0!==this.key){var t=this.updateSignalController.renew();try{if(this.localized=!1,this.isTextKey(this.key))yield this.updateTextLocalization(this.key,t);else{if(!this.isTextureKey(this.key))throw new Error("Key ".concat(this.key," not found in locales"));var n=Rd.getCurrentLocale(),i=!f&&e&&n===this.defaultLocale;i||(yield this.updateTextureLocalization(this.key,t))}if(t.aborted)return;this.localized=!0,D.emit($e.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit($e.LOCALIZE_APPLIED,{localize:this,key:this.key})}catch(e){console.warn(e)}}})),function(){return w.apply(this,arguments)})},{key:"updateTextLocalization",value:(b=o((function*(e,t){var n,i,a=this,o=Rd.getCurrentLocale(),r=Rd.getText(e,this.params.map((function(e){return e.text})),o),l=this.label;if(void 0===l)throw new Error("Text localize component <".concat(this.node.name,"> has no label"));null===(n=t.wrap((function(){return a.setText(l,r)})))||void 0===n||n(),this.updateFont&&(yield null===(i=t.wrap((function(){return a.setTextFont(l,o,t)})))||void 0===i?void 0:i())})),function(e,t){return b.apply(this,arguments)})},{key:"setText",value:(m=o((function*(e,t){e.string=t})),function(e,t){return m.apply(this,arguments)})},{key:"setTextFont",value:(g=o((function*(e,t,n){yield this.setTextFontRuntime(e,t,n)})),function(e,t,n){return g.apply(this,arguments)})},{key:"setTextFontRuntime",value:(v=o((function*(e,t,n){var i=yield qe.loadFontAsync(t);n.aborted||null!==i&&this.setLabelFontInLifeCycle(e,i)})),function(e,t,n){return v.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(y=o((function*(e,t,n){var i,a,o=this,r=yield this.requestFontUuid(t);if(null!==r){var l=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==l){var s=Od.searchIndex(l.__comps__,(function(e){return"cc.Label"===e.type})),u="__comps__.".concat(s,".font");yield null===(a=n.wrap((function(){return o.requestUpdateLabelFont(e.node.uuid,u,r)})))||void 0===a?void 0:a()}}})),function(e,t,n){return y.apply(this,arguments)})},{key:"requestFontUuid",value:(p=o((function*(e){return yield Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(tt[e]))})),function(e){return p.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(h=o((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.Font",value:{uuid:n}}})})),function(e,t,n){return h.apply(this,arguments)})},{key:"updateTextureLocalization",value:(d=o((function*(e,t){if(void 0===this.sprite)throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));var n=Rd.getTexture(e);yield this.setSpriteRuntime(this.sprite,n,t)})),function(e,t){return d.apply(this,arguments)})},{key:"setSpriteRuntime",value:(c=o((function*(e,t,n){var i=yield qe.loadSpriteFrameAsync("".concat(t,"/spriteFrame"),this.packable);n.aborted||(null!==i?this.setSprite(e,i):console.warn("Sprite not found by path: ".concat(t)))})),function(e,t,n){return c.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(u=o((function*(e,t,n){var i,a,o=this,r=yield this.requestSpriteFrameInfo(t);if(0!==r.length)if(r.length>1){var l=r.slice(0,5).map((function(e){return e.path})),s="".concat(l.join(",")).concat(l.length<r.length?"...":"");console.warn("Ambiguous sprite's path: ".concat(t,". Found ").concat(s))}else{var u=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==u){var c=r[0].uuid,d=Od.searchIndex(u.__comps__,(function(e){return"cc.Sprite"===e.type})),h="__comps__.".concat(d,".spriteFrame");yield null===(a=n.wrap((function(){return o.requestUpdateSpriteSpriteFrame(e.node.uuid,h,c)})))||void 0===a?void 0:a()}}else console.error("Sprite not found by path: ".concat(t))})),function(e,t,n){return u.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(s=o((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.SpriteFrame",value:{uuid:n}}})})),function(e,t,n){return s.apply(this,arguments)})}]),k}(T)).prototype,"_defaultLocale",[zc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),a(sd.prototype,"defaultLocale",[Uc],Object.getOwnPropertyDescriptor(sd.prototype,"defaultLocale"),sd.prototype),cd=a(sd.prototype,"_l10nType",[Gc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Dd.Text}}),a(sd.prototype,"l10nType",[Hc],Object.getOwnPropertyDescriptor(sd.prototype,"l10nType"),sd.prototype),dd=a(sd.prototype,"label",[qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hd=a(sd.prototype,"updateFont",[Vc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),pd=a(sd.prototype,"params",[$c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yd=a(sd.prototype,"sprite",[Wc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vd=a(sd.prototype,"packable",[Kc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),fd=a(sd.prototype,"_key",[jc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(sd.prototype,"key",[Yc],Object.getOwnPropertyDescriptor(sd.prototype,"key"),sd.prototype),a(sd.prototype,"updateTextLocalization",[Xc],Object.getOwnPropertyDescriptor(sd.prototype,"updateTextLocalization"),sd.prototype),a(sd.prototype,"setText",[Jc],Object.getOwnPropertyDescriptor(sd.prototype,"setText"),sd.prototype),a(sd.prototype,"setTextFont",[Zc],Object.getOwnPropertyDescriptor(sd.prototype,"setTextFont"),sd.prototype),a(sd.prototype,"setTextFontRuntime",[Qc],Object.getOwnPropertyDescriptor(sd.prototype,"setTextFontRuntime"),sd.prototype),a(sd.prototype,"setLabelFontInLifeCycle",[ed],Object.getOwnPropertyDescriptor(sd.prototype,"setLabelFontInLifeCycle"),sd.prototype),a(sd.prototype,"setTextFontEditor",[td],Object.getOwnPropertyDescriptor(sd.prototype,"setTextFontEditor"),sd.prototype),a(sd.prototype,"requestUpdateLabelFont",[nd],Object.getOwnPropertyDescriptor(sd.prototype,"requestUpdateLabelFont"),sd.prototype),a(sd.prototype,"updateTextureLocalization",[id],Object.getOwnPropertyDescriptor(sd.prototype,"updateTextureLocalization"),sd.prototype),a(sd.prototype,"setSpriteRuntime",[ad],Object.getOwnPropertyDescriptor(sd.prototype,"setSpriteRuntime"),sd.prototype),a(sd.prototype,"setSprite",[od],Object.getOwnPropertyDescriptor(sd.prototype,"setSprite"),sd.prototype),a(sd.prototype,"setSpriteEditor",[rd],Object.getOwnPropertyDescriptor(sd.prototype,"setSpriteEditor"),sd.prototype),ld=sd))||ld)||ld)||ld);S._RF.pop(),S._RF.push({},"060a722v8VBE68QPm8fKcyQ","LocalizePreloader",void 0);var nh,ih,ah,oh,rh,lh,sh,uh,ch,dh,hh,ph,yh,vh,fh,gh,mh=C.ccclass,bh=C.property,wh=Ludex.Utils,Sh=wh.Array,kh=wh.Valid,Ch=codex.language,Eh=(Md=mh("LocalizeTextureKey"),Nd=bh({visible:!1}),Bd=bh(E),Md((zd=a((xd=function(){function n(){t(this,n),r(this,"_key",zd,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){Ch.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),n}()).prototype,"_key",[Nd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(xd.prototype,"key",[Bd],Object.getOwnPropertyDescriptor(xd.prototype,"key"),xd.prototype),Fd=xd))||Fd),Ah=(Ud=mh("SupportedLocaleKey"),Gd=bh({visible:!1}),Hd=bh(E),Ud(($d=a((Vd=function(){function n(){t(this,n),r(this,"_key",$d,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){Sh.has(et,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(et.join(", ")))}}]),n}()).prototype,"_key",[Gd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(Vd.prototype,"key",[Hd],Object.getOwnPropertyDescriptor(Vd.prototype,"key"),Vd.prototype),qd=Vd))||qd);Wd=mh("LocalizePreloader"),Kd=bh([Eh]),jd=bh({type:Ah,tooltip:"Preload only for these locales"}),Wd((Jd=a((Xd=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"keys",Jd,l(e)),r(e,"locales",Zd,l(e)),e}return e(s,[{key:"__preload",value:function(){this.preloadTextures()}},{key:"preloadTextures",value:function(){var e=Ch.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(Sh.has(t,e)){var n,i=[],a=u(this.keys);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!1!==Ch.hasTextureKey(o.key)){var r=Ch.getTexture(o.key),l="".concat(r,"/spriteFrame");i.push(l)}}}catch(e){a.e(e)}finally{a.f()}qe.loadSpriteFramesAsync(i)}else kh.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),s}(T)).prototype,"keys",[Kd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zd=a(Xd.prototype,"locales",[jd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yd=Xd));S._RF.pop(),S._RF.push({},"3f364xnTJtDR5yeow2MWHhm","LocalizedLayout",void 0);var Th,Ph,Oh,Lh,Ih,Rh,_h,Dh,Mh,Nh=C.ccclass,Bh=C.property,Fh=C.executeInEditMode,xh=C.disallowMultiple,zh=C.requireComponent;nh=Nh("LocalizedLayout"),ih=Fh(!0),ah=zh(P),oh=Bh(th),rh=Yn.required(),lh=Bh(P),sh=Bh({visible:!1}),uh=Bh({visible:!1}),ch=Bh({type:L,group:"Padding"}),dh=Bh({type:L,group:"Padding"}),nh(hh=xh(hh=ih(hh=ah((yh=a((ph=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"label",yh,l(e)),r(e,"layout",vh,l(e)),r(e,"_horizontal",fh,l(e)),r(e,"_vertical",gh,l(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(P))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,a=e.node.getComponentsInChildren(I),o=u(a);try{for(o.s();!(i=o.n()).done;){i.value.updateAlignment()}}catch(e){o.e(e)}finally{o.f()}}}},e}return e(s,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(P),Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on($e.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off($e.LOCALIZE_APPLIED,this.updateContentSize)}}]),s}(T)).prototype,"label",[oh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vh=a(ph.prototype,"layout",[rh,lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fh=a(ph.prototype,"_horizontal",[sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),gh=a(ph.prototype,"_vertical",[uh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(ph.prototype,"horizontal",[ch],Object.getOwnPropertyDescriptor(ph.prototype,"horizontal"),ph.prototype),a(ph.prototype,"vertical",[dh],Object.getOwnPropertyDescriptor(ph.prototype,"vertical"),ph.prototype),hh=ph))||hh)||hh)||hh);S._RF.pop(),S._RF.push({},"aef305TaZhKVo1f4/qH1kf+","SecondOrderDynamics",void 0);var Uh,Gh,Hh,qh,Vh,$h,Wh,Kh,jh,Yh=C.ccclass,Xh=C.property,Jh=function(){function n(e,i){t(this,n);var a=null!=i?i:{response:1,dampen:1,eager:1};this.k1=n.calcK1(a),this.k2=n.calcK2(a),this.k3=n.calcK3(a),this.xp=e.clone(),this.y=e.clone(),this.yd=new ae(0,0)}return e(n,[{key:"update",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n;null===i&&(i=new ae((t.x-this.xp.x)/e,(t.y-this.xp.y)/e),this.xp.x=t.x,this.xp.y=t.y);var a=Math.max(this.k2,e*e/2+e*this.k1/2,e*this.k1);return this.y.x=this.y.x+e*this.yd.x,this.y.y=this.y.y+e*this.yd.y,this.yd.x=this.yd.x+e*(t.x+this.k3*i.x-this.y.x-this.k1*this.yd.x)/a,this.yd.y=this.yd.y+e*(t.y+this.k3*i.y-this.y.y-this.k1*this.yd.y)/a,this.y}},{key:"setDynamics",value:function(e){this.k1=n.calcK1(e),this.k2=n.calcK2(e),this.k3=n.calcK3(e)}},{key:"reset",value:function(e){this.xp.set(e.x,e.y),this.y.set(e.x,e.y),this.yd.set(0,0)}},{key:"currentState",get:function(){return this.y}}],[{key:"calcK1",value:function(e){return e.dampen/(Math.PI*e.response)}},{key:"calcK2",value:function(e){return 1/(2*Math.PI*e.response*(2*Math.PI*e.response))}},{key:"calcK3",value:function(e){return e.eager*e.dampen/(2*Math.PI*e.response)}}]),n}(),Zh=(Th=Yh("SODConfig"),Ph=Xh({type:L,displayName:"Responsiveness",tooltip:"Higher values will result shorter response times."}),Oh=Xh({type:L,displayName:"Dampening",tooltip:"Higher values will result in less overshoot and oscillation."}),Lh=Xh({type:L,displayName:"Eagerness",tooltip:"Higher values will result in more overshoot and oscillation, negative values will result in anticipation."}),Th((_h=a((Rh=e((function e(){t(this,e),r(this,"response",_h,this),r(this,"dampen",Dh,this),r(this,"eager",Mh,this)}))).prototype,"response",[Ph],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),Dh=a(Rh.prototype,"dampen",[Oh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Mh=a(Rh.prototype,"eager",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ih=Rh))||Ih);S._RF.pop(),S._RF.push({},"e9e74FEHyRLvar32WZD/F11","Trail",void 0);var Qh,ep,tp,np,ip,ap,op,rp,lp,sp,up,cp,dp,hp,pp,yp,vp,fp,gp,mp,bp,wp,Sp,kp,Cp,Ep,Ap,Tp,Pp=C.ccclass,Op=C.property,Lp=(Uh=Pp("Trail"),Gh=Op({type:q,displayName:"Target"}),Hh=Op({type:Y,displayName:"Graphics"}),qh=Op({type:[Zh],displayName:"Trail Nodes"}),Uh((Wh=a(($h=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"target",Wh,l(e)),r(e,"graphics",Kh,l(e)),r(e,"trailNodes",jh,l(e)),e.trailNodeInstances=[],e}return e(s,[{key:"reset",value:function(){var e,t=u(this.trailNodeInstances);try{for(t.s();!(e=t.n()).done;){e.value.reset(new ae(this.node.worldPosition.x,this.node.worldPosition.y))}}catch(e){t.e(e)}finally{t.f()}this.graphics.clear()}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.spawnTrailNodes()}},{key:"update",value:function(e){this.graphics.clear();var t=this.trailNodeInstances[0];this.drawTrail(e,t,this.target.worldPosition.x,this.target.worldPosition.y);for(var n=1;n<this.trailNodeInstances.length;n++){var i=this.trailNodeInstances[n-1],a=this.trailNodeInstances[n];this.drawTrail(e,a,i.currentState.x,i.currentState.y)}}},{key:"drawTrail",value:function(e,t,n,i){var a=this.graphics;if(this.target.activeInHierarchy){var o=new ae(n,i),r=t.update(e,o),l=new V(o.x,o.y,0),s=new V(r.x,r.y,0);a.node.inverseTransformPoint(l,l),a.node.inverseTransformPoint(s,s),a.moveTo(l.x,l.y),a.lineTo(s.x,s.y),a.stroke()}}},{key:"spawnTrailNodes",value:function(){var e,t=u(this.trailNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=new ae(this.node.worldPosition.x,this.node.worldPosition.y),a=new Jh(i,n);this.trailNodeInstances.push(a)}}catch(e){t.e(e)}finally{t.f()}}},{key:"validateRequiredComponents",value:function(){if(!this.target)throw new Error("Target is not set");if(!this.graphics)throw new Error("Graphics is not set");0===this.trailNodes.length&&console.warn("No trail nodes are set")}}]),s}(T)).prototype,"target",[Gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=a($h.prototype,"graphics",[Hh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jh=a($h.prototype,"trailNodes",[qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vh=$h))||Vh);S._RF.pop(),S._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var Ip,Rp,_p,Dp,Mp,Np,Bp,Fp,xp,zp,Up,Gp,Hp,qp,Vp,$p,Wp,Kp,jp,Yp,Xp=C.ccclass,Jp=C.executionOrder,Zp=C.property,Qp=Ludex.Utils,ey=Qp.Decorator,ty=Qp.Array,ny="Batch By Name",iy="Batch Label",ay="Batch Sprite";Qh=Xp("BatchNodes"),ep=Jp(99999),tp=Zp({group:{name:ny}}),np=Zp({type:[O],group:{name:ny}}),ip=Zp({type:[E],group:{name:ny}}),ap=Zp({group:{name:iy}}),op=Zp({group:{name:iy}}),rp=Zp({group:{name:iy}}),lp=Zp({group:{name:ay}}),sp=Zp({group:{name:ay}}),up=Zp({readonly:!0}),cp=Zp({readonly:!0}),dp=Zp({readonly:!0}),hp=ey.debounce(1e3),Qh(pp=ep((vp=a((yp=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"batchByName",vp,l(e)),r(e,"depthNames",fp,l(e)),r(e,"listName",gp,l(e)),r(e,"batchLabel",mp,l(e)),r(e,"depthLabel",bp,l(e)),r(e,"typeLabel",wp,l(e)),r(e,"batchSprite",Sp,l(e)),r(e,"depthSprite",kp,l(e)),r(e,"batchAllNodes",Cp,l(e)),r(e,"batchDepth",Ep,l(e)),r(e,"checkOverlap",Ap,l(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,r(e,"handleNodeChange",Tp,l(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return e(s,[{key:"__preload",value:function(){this.enabled&&(A.on(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.on(Z.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){A.off(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.off(Z.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(A.on(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.on(Z.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(q.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),A.off(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.off(Z.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,a=i.depthNames[t];void 0!==a?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(a):console.warn("BatchNodes: depth is undefined",e,t,a)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new q("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=u(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var a=new q(i);a.active=!0,this.batchNode[i]=a,e.addChild(a)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new q("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new q("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(g(this.labelChildren),g(this.spriteChildren)),n=this.nameChildren,i=u(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.parent&&(this.handleActiveChange(a.node),this.originalParents[a.uuid]=a.node.parent)}}catch(e){i.e(e)}finally{i.f()}var o,r=u(n);try{for(r.s();!(o=r.n()).done;){var l=o.value;l.parent&&(this.handleActiveChange(l),this.originalParents[l.uuid]=l.parent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=u(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.saveLabelChildren(a),this.saveSpriteChildren(a),this.saveNodeChildrenByName(a),this.saveNodeChildrenByType(a)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(K),i={none:K.CacheMode.NONE,char:K.CacheMode.CHAR,bitmap:K.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,g(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(F);0!==n.length&&(t=this.spriteChildren).push.apply(t,g(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=u(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;ty.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(T);if((t=this.allChildren).push.apply(t,g(i)),!(this.batchDepth<1||n>=this.batchDepth)){var a,o=u(this.allChildren);try{for(o.s();!(a=o.n()).done;){var r=a.value;this.saveNodeChildrenByType(r.node,this.batchDepth)}}catch(e){o.e(e)}finally{o.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=oe.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=u(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var a,o=u(this.spriteChildren);try{for(o.s();!(a=o.n()).done;){t(a.value,this.batchNode.sprite)}}catch(e){o.e(e)}finally{o.f()}var r,l=u(this.allChildren);try{for(l.s();!(r=l.n()).done;){t(r.value,this.batchNode.node)}}catch(e){l.e(e)}finally{l.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var s,c=u(this.nameChildren);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(d.isValid&&d.activeInHierarchy&&d.isTransformDirty()){var h=d.getComponent(B);if(!(h&&h.opacity<1||ty.has(n,d.name))){var p=this.batchNode[d.name];p&&(d.isChildOf(p)||(d.setParent(p,!0),d.layer=oe.Enum.UI_2D))}}}}catch(e){c.e(e)}finally{c.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(g(this.labelChildren),g(this.spriteChildren));if(e.length>0){var t,n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.originalParents[i.uuid];a&&(i.node.isChildOf(a)||i.node.setParent(a,!0))}}catch(e){n.e(e)}finally{n.f()}}var o,r=u(this.nameChildren);try{for(r.s();!(o=r.n()).done;){var l=o.value,s=this.originalParents[l.uuid];s&&(l.isChildOf(s)||l.setParent(s,!0))}}catch(e){r.e(e)}finally{r.f()}}}]),s}(T)).prototype,"batchByName",[tp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fp=a(yp.prototype,"depthNames",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gp=a(yp.prototype,"listName",[ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mp=a(yp.prototype,"batchLabel",[ap],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bp=a(yp.prototype,"depthLabel",[op],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),wp=a(yp.prototype,"typeLabel",[rp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Sp=a(yp.prototype,"batchSprite",[lp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kp=a(yp.prototype,"depthSprite",[sp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Cp=a(yp.prototype,"batchAllNodes",[up],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ep=a(yp.prototype,"batchDepth",[cp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ap=a(yp.prototype,"checkOverlap",[dp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Tp=a(yp.prototype,"handleNodeChange",[hp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),pp=yp))||pp);S._RF.pop(),S._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var oy,ry=C.ccclass,ly=C.executionOrder,sy=C.property,uy=Ludex.Utils,cy=uy.Array,dy=uy.Object;Ip=ry("BatchNodesV2"),Rp=ly(99999),_p=sy({group:"Batch Settings"}),Dp=sy({type:[E],group:"Batch Settings",visible:function(){return this.batchByName}}),Mp=sy({type:[O],group:"Batch Settings",visible:function(){return this.batchByName}}),Np=sy({group:"Label Settings"}),Bp=sy({group:"Label Settings",visible:function(){return this.batchLabel}}),Fp=sy({group:"Label Settings",visible:function(){return this.batchLabel}}),xp=sy({group:"Sprite Settings"}),zp=sy({group:"Sprite Settings",visible:function(){return this.batchSprite}}),Ip(Up=Rp((Hp=a((Gp=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"batchByName",Hp,l(e)),r(e,"listName",qp,l(e)),r(e,"depthNames",Vp,l(e)),r(e,"batchLabel",$p,l(e)),r(e,"typeLabel",Wp,l(e)),r(e,"depthLabel",Kp,l(e)),r(e,"batchSprite",jp,l(e)),r(e,"depthSprite",Yp,l(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return e(s,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(K);t&&("all"===this.typeLabel?t.cacheMode===K.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===K.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(F)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:K.CacheMode.NONE,char:K.CacheMode.CHAR,bitmap:K.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,a={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(a)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var o=0;o<this.listName.length;o++){var r=this.listName[o];if(r){var l=this.depthNames[o]||0,s=this.batchNodes[r];s&&s.setSiblingIndex(l)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=oe.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=dy.vals(this.batchNodes);return cy.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],a=0;a<i.length;a++){var o=i[a];o&&t(o)}else for(var r=0;r<this.labelNodes.length;r++){var l=this.labelNodes[r];l&&t(l)}if(this.batchSprite)for(var s=0;s<this.spriteNodes.length;s++){var u=this.spriteNodes[s];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var d=this.namedNodes[c];if(d)for(var h=0;h<d.length;h++){var p=d[h];p&&t(p)}}}},{key:"setupEventListeners",value:function(){A.on(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.on(Z.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){A.off(Z.EVENT_AFTER_UPDATE,this.onAfterUpdate),A.off(Z.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new q("BatchLabel_".concat(n));i.layer=oe.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var a=new q("BatchLabel");a.layer=oe.Enum.UI_2D,this.node.addChild(a),this.batchNodes.label=a}if(this.batchSprite){var o=new q("BatchSprite");o.layer=oe.Enum.UI_2D,this.node.addChild(o),this.batchNodes.sprite=o}if(this.batchByName)for(var r=0;r<this.listName.length;r++){var l=this.listName[r];if(l){var s=new q("Batch_".concat(l));s.layer=oe.Enum.UI_2D,this.node.addChild(s),this.batchNodes[l]=s,this.namedNodes[l]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),s}(T)).prototype,"batchByName",[_p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qp=a(Gp.prototype,"listName",[Dp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vp=a(Gp.prototype,"depthNames",[Mp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$p=a(Gp.prototype,"batchLabel",[Np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wp=a(Gp.prototype,"typeLabel",[Bp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Kp=a(Gp.prototype,"depthLabel",[Fp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),jp=a(Gp.prototype,"batchSprite",[xp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Yp=a(Gp.prototype,"depthSprite",[zp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Up=Gp))||Up);S._RF.pop(),S._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var hy,py=C.ccclass,yy=Ludex.Utils.Browser,vy=codex.player,fy=py("Vibrate")(oy=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!yy.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!vy.getPlayerSetting("vibrate")}}]),r}(T))||oy;S._RF.pop(),S._RF.push({},"21fbd1aIo9DNoKfAoZaF1DC","WidgetCanvasTarget",void 0);var gy;(0,C.ccclass)("WidgetCanvasTarget")(hy=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){var e=this.getComponent(I);if(e){var t=re("Canvas");t&&(e.target=t)}}}]),r}(T));S._RF.pop(),S._RF.push({},"62927KYr+tCcIzOaPtVc/q8","CoinData",void 0);var my=10,by=20,wy=100,Sy=(m(gy={},nt.HINT,80),m(gy,nt.THUNDER,200),m(gy,nt.STORM,150),m(gy,nt.PLIERS,150),gy),ky=2e3,Cy=300;S._RF.pop(),S._RF.push({},"8328a20Ku5GF4anma0sBaxm","DailyRewardsData",void 0);var Ey={0:{id:1,type:"coin",value:20},1:{id:2,type:"coin",value:30},2:{id:3,type:"coin",value:50},3:{id:4,type:"coin",value:100},4:{id:5,type:"coin",value:150},5:{id:6,type:"coin",value:200},6:{id:7,type:"coin",value:250,items:{hint:3,thunder:3,storm:3,pliers:3}}};S._RF.pop(),S._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Ay,Ty,Py,Oy,Ly=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(Ly||{}),Iy={Events:Ly,UNLOCK_SEQUENCE:"101013012031"};S._RF.pop(),S._RF.push({},"52b52FNwvhBKY/becAy420o","Leaderboard",void 0);var Ry=Ludex.Configs.Leaderboards.LeaderboardList,_y={DAILY:null!==(Ay=null===(Ty=Ry[0])||void 0===Ty?void 0:Ty.Id)&&void 0!==Ay?Ay:"daily-leaderboard-id",WEEKLY:null!==(Py=null===(Oy=Ry[1])||void 0===Oy?void 0:Oy.Id)&&void 0!==Py?Py:"weekly-leaderboard-id"},Dy="daily",My="weekly";S._RF.pop(),S._RF.push({},"f16ffbXQPtDK58g6BNFwzJv","Tournament",void 0);var Ny=function(e){return e.RELOAD_TOURNAMENT="reload-tournament",e}(Ny||{});S._RF.pop(),S._RF.push({},"7e0c9Khhb1DD7wE1NBWi3Py","VibrateStyle",void 0),S._RF.pop(),S._RF.push({},"ad7acMQ2iJNKKA2RkT+nGNI","CommonError",void 0);var By=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,n)).code=e,i}return e(r)}(p(Error));S._RF.pop(),S._RF.push({},"5ff78u05/tPepABfMzNaOjM","PlayerHasTournamentError",void 0);var Fy=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"PLAYER_HAS_TOURNAMENT","Player has a tournament")).playerId=e,i.tournamentId=n,i}return e(r)}(By);S._RF.pop(),S._RF.push({},"e14dbcdc89LQJIggfi5qO6U","MapData",void 0);var xy={mapOrder:[{id:1,theme:"summer",skins:["fruit"],levelCount:10},{id:2,theme:"autumn",skins:["flower"],levelCount:10},{id:3,theme:"winter",skins:["tool"],levelCount:10},{id:4,theme:"summer",skins:["sport"],levelCount:10},{id:5,theme:"autumn",skins:["cosmetics"],levelCount:10},{id:6,theme:"winter",skins:["ice-cream"],levelCount:10},{id:7,theme:"summer",skins:["cakes"],levelCount:10},{id:8,theme:"happy-new-year",skins:["cosmetics","car"],levelCount:10},{id:9,theme:"spring-festival",skins:["flower","ice-cream"],levelCount:10},{id:10,theme:"tree-planting-festival",skins:["fruit","flower","tool"],levelCount:10},{id:11,theme:"blue-sea-festival",skins:["sport","ice-cream"],levelCount:10},{id:12,theme:"music-festival",skins:["cakes","cosmetics"],levelCount:10},{id:13,theme:"harvest-festival",skins:["fruit","flower","tool"],levelCount:10},{id:14,theme:"food-festival",skins:["cakes","ice-cream","flower"],levelCount:10},{id:15,theme:"snow-festival",skins:["ice-cream","sport"],levelCount:10},{id:16,theme:"light-festival",skins:["flower","cakes"],levelCount:10},{id:17,theme:"peace-festival",skins:["flower","sport"],levelCount:10},{id:18,theme:"flower-festival",skins:["flower","fruit"],levelCount:10},{id:19,theme:"street-festival",skins:["car","ice-cream","sport"],levelCount:10},{id:20,theme:"color-garden",skins:["cakes","fruit"],levelCount:10},{id:21,theme:"color-festival",skins:["car","cosmetics","flower"],levelCount:10},{id:22,theme:"nature-summer",skins:["tool","sport"],levelCount:10},{id:23,theme:"snow-mountain",skins:["cakes","ice-cream"],levelCount:10},{id:24,theme:"ice-festival",skins:["ice-cream"],levelCount:10},{id:25,theme:"green-grass-festival",skins:["flower","fruit"],levelCount:10},{id:26,theme:"community-festival",skins:["car","cakes","cosmetics"],levelCount:10},{id:27,theme:"water-festival",skins:["sport","car"],levelCount:10},{id:28,theme:"animal-festival",skins:["flower","fruit"],levelCount:10},{id:29,theme:"lost-festival",skins:["flower"],levelCount:10},{id:30,theme:"halloween-festival",skins:["cakes","cosmetics"],levelCount:10},{id:31,theme:"snow-music-festival",skins:["ice-cream","cosmetics"],levelCount:10},{id:32,theme:"christmas",skins:["ice-cream","tool","cosmetics"],levelCount:10},{id:33,theme:"spring-flower-festival",skins:["flower","fruit"],levelCount:10},{id:34,theme:"tet-holiday",skins:["flower","cosmetics","fruit"],levelCount:10},{id:35,theme:"sea-festival",skins:["car","sport"],levelCount:10},{id:36,theme:"firework-festival",skins:["cosmetics","car","flower"],levelCount:10},{id:37,theme:"halloween-horror",skins:["cakes","cosmetics"],levelCount:10},{id:38,theme:"mid-autumn",skins:["flower","cakes"],levelCount:10},{id:39,theme:"christmas-sweet",skins:["ice-cream","cakes","sport"],levelCount:10},{id:40,theme:"new-year-countdown",skins:["cosmetics","car"],levelCount:10}]};S._RF.pop(),S._RF.push({},"6093adbLQZKpqgUpTV/sHj1","ThemeUtils",void 0);var zy=Ludex.Utils.Function,Uy=codex,Gy=Uy.player,Hy=Uy.storage,qy=xy.mapOrder.map((function(e){return{skins:e.skins,themeId:e.theme,currentProgress:0,maxProgress:e.levelCount,isLocked:!0}})),Vy=function(a){n(d,a);var r,l,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=c.call.apply(c,[this].concat(i))).playerSkinProgress=qy.map((function(e){return s({},e)})),e}return e(d,[{key:"initDefaultPlayerSkinProgress",value:function(){this.playerSkinProgress=qy.map((function(e){return s({},e)}))}},{key:"initDashboardSceneStorage",value:function(){var e=Hy.getStorage("dashboard");if(null==e){var t=this.getCurrentMapProgressInstance();Hy.addStorage("dashboard",{lastMapPayload:t,numOfMapsPassed:0,animateToCurrentLevel:!1});var n=Hy.getStorage("collection");if(null==n){Hy.addStorage("collection",{lastMapPack:t.id,animateMapPackUnlock:!1});var i=Hy.getStorage("leaderboard_content");if(null==i){Hy.addStorage("leaderboard_content",{lastTabOpened:Dy,previousScore:-1});var a=Hy.getStorage("tournament");null==a&&Hy.addStorage("tournament",{animateTournamentLeader:!1,previousScore:-1})}}}}},{key:"getCurrentMapProgressInstance",value:function(){for(var e=void 0,t=void 0,n=0,i=0,a=0,o=0,r=xy.mapOrder.length;o<r;o++){var l=this.playerSkinProgress[o],s=xy.mapOrder[o],u=xy.mapOrder[o+1];if(l.currentProgress<l.maxProgress){var c;a=s.id,e=s.theme,t=null!==(c=null==u?void 0:u.theme)&&void 0!==c?c:e,n=l.currentProgress,i=l.maxProgress;break}}if(void 0===e||void 0===t){var d=xy.mapOrder[xy.mapOrder.length-1];return{id:a=d.id,currentTheme:e=d.theme,nextTheme:t=d.theme,progress:n=d.levelCount,max:i=d.levelCount}}return{id:a,currentTheme:e,nextTheme:t,progress:n,max:i}}},{key:"getUnlockedSkinsInstance",value:function(){var e,t=[],n=u(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!i.isLocked&&1===i.skins.length){var a=i.skins[0];a&&t.push(a)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getLevelSkinsInstance",value:function(e){var t,n=null!=e?e:1,i=0,a=u(xy.mapOrder);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(i+o.levelCount>=n)return o.skins;i+=o.levelCount}}catch(e){a.e(e)}finally{a.f()}return xy.mapOrder[xy.mapOrder.length-1].skins}},{key:"getLevelThemeInstance",value:function(e){var t,n=null!=e?e:1,i=0,a=u(xy.mapOrder);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(i+o.levelCount>=n)return o.theme;i+=o.levelCount}}catch(e){a.e(e)}finally{a.f()}return xy.mapOrder[xy.mapOrder.length-1].theme}},{key:"getThemeSkinsInstance",value:function(e){var t,n=u(xy.mapOrder);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.theme===e)return i.skins}}catch(e){n.e(e)}finally{n.f()}return[]}},{key:"getCollectionUnlockProgressInstance",value:function(){var e,t=[],n=u(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push({skins:i.skins,theme:i.themeId,progress:i.currentProgress,max:i.maxProgress,isLocked:i.isLocked})}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"updatePlayerSkinProgress",value:function(){var e,t=Gy.getGameData(),n=(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)-1;this.playerSkinProgress[0].isLocked=!1;for(var i=0,a=xy.mapOrder.length;i<a;i++){var o=xy.mapOrder[i];if(o&&!(n<=0)){var r=n-o.levelCount>=0?o.levelCount:n;n-=r,this.increaseProgress(i,r)}}}},{key:"increaseProgress",value:function(e,t){if(e<0||e>=this.playerSkinProgress.length)throw new Error("increaseProgress: index out of range");var n,i=this.playerSkinProgress[e],a=i.currentProgress,o=i.maxProgress,r=a+t>o?o:a+t;(r>0&&(i.isLocked=!1),r===o)&&((null===(n=xy.mapOrder[e+1])||void 0===n?void 0:n.skins)&&(this.playerSkinProgress[e+1].isLocked=!1));i.currentProgress=r,i.maxProgress=o}}],[{key:"init",value:function(){var e=this.inst;e.initDefaultPlayerSkinProgress(),e.updatePlayerSkinProgress(),e.initDashboardSceneStorage()}},{key:"getCurrentMapProgress",value:function(){return this.inst.getCurrentMapProgressInstance()}},{key:"getUnlockedSkins",value:function(){return this.inst.getUnlockedSkinsInstance()}},{key:"getLevelSkins",value:function(e){return this.inst.getLevelSkinsInstance(e)}},{key:"getLevelTheme",value:function(e){return this.inst.getLevelThemeInstance(e)}},{key:"getThemeSkins",value:function(e){return this.inst.getThemeSkinsInstance(e)}},{key:"getCollectionUnlockProgress",value:function(){return this.inst.getCollectionUnlockProgressInstance()}},{key:"getCurrentUnlockingThemeIndex",value:function(){var e=this.getCollectionUnlockProgress();if(0===e.length)return null;var t=0;return e.forEach((function(e,n){e.isLocked||(t=n)})),t}},{key:"preloadLevelSpriteFrames",value:function(e){var t=this.getLevelSkins(e);this.preloadSkinsFrames(t)}},{key:"preloadSkinsFrames",value:function(e){var t,n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.preloadSkinFrames(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"preloadSkinFrames",value:function(e){var t="".concat(it.TILE_SKIN_FOLDER,"/").concat(e);qe.loadSpriteFramesDirAsync(t)}},{key:"loadLevelSpriteFrames",value:(l=o((function*(e,t,n){var i=zy.rng({generate:function(e,t,n){return le(e,t,n)},generateSeed:function(e){return le(e,0,1e6)},seed:null!=n?n:Date.now()});if(void 0!==t&&0===i(0,2)){var a=this.getThemeSkins(t),o=a[i(0,a.length)];return yield this.loadSkinFrames(o)}if(0===i(0,2)){var r=this.getUnlockedSkins();if(r.length>1){var l=r[i(0,r.length)];return yield this.loadSkinFrames(l)}}var s=this.getLevelSkins(e);if(0===s.length)throw new Error("No skins found for level ".concat(e));var u=yield this.loadSkinsFrames(s);return u[i(0,u.length)]})),function(e,t,n){return l.apply(this,arguments)})},{key:"loadSkinFrames",value:function(e){var t="".concat(it.TILE_SKIN_FOLDER,"/").concat(e);return qe.loadSpriteFramesDirAsync(t)}},{key:"loadSkinsFrames",value:(r=o((function*(e){var t=e.map(this.loadSkinFrames),n=yield zy.allSettled(t),i=zy.unwrapAllSettled(n),a=i.successes,o=i.failures;if(o.length>0)throw new Error("Failed to load skins frames: ".concat(o.join(", ")));return a})),function(e){return r.apply(this,arguments)})}]),d}(function(){function n(){t(this,n)}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}}]),n}());S._RF.pop(),S._RF.push({},"0397cr2IpZEwbRzwQhlVHMO","MatchUtils",void 0);var $y=codex,Wy=$y.match,Ky=$y.player,jy=$y.leaderboard,Yy=Ludex,Xy=Yy.Utils,Jy=Xy.Object,Zy=Xy.Valid,Qy=Xy.String,ev=Xy.Array,tv=Yy.Match.Modes,nv=["Champion","Ultimate","Grand","Elite","Master's","Premier","Epic","Pro's","Supreme","Legendary","Victory","Prime","Titan's","Hero's","Star's"],iv=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"createTournamentPayload",value:function(){return c(d(r.prototype),"createTournamentPayload",this).call(this)}}]),r}(function(){function n(){var e=this;t(this,n),this.processStartSingleModeAsync$=o((function*(){var e=Ky.getPlayerId();return Wy.single.start.processAsync({playerId:e})})),this.processFinishSingleModeAsync$=o((function*(){return Wy.single.finish.processAsync()})),this.processStartTournamentModeAsync$=o((function*(){var e=Ky.getPlayerId(),t=GameSDK.context.getID();return Wy.tournament.continue.processAsync({playerId:e,contextId:t})})),this.processFinishTournamentModeAsync$=o((function*(){var e=Ky.getPlayerId(),t=Ky.getBestScore();return Wy.tournament.finish.processAsync({playerId:e,bestScore:t})})),this.processStartChallengeModeAsync$=o((function*(){try{return e.processContinueChallengeAsync$()}catch(t){if(!Jy.hasOwn(t,"name")||Zy.isString(t.name))throw t;if("PlayerHasFinishedMatch"===t.name)return e.processChallengeNewOpponentAsync$();if("PlayerNotJoinInMatch"===t.name)return e.processJoinChallengeAsync$()}})),this.processFinishChallengeModeAsync$=function(){var e=o((function*(e){return Wy.challenge.finish.processAsync(e)}));return function(t){return e.apply(this,arguments)}}(),this.processContinueChallengeAsync$=o((function*(){var t=e.getMatchState$(),n=t.id,i=t.customData,a=i.playerId,o=i.opponentId;if(!Zy.isString(n))throw new Error("Invalid match id");if(!Zy.isString(a))throw new Error("Invalid player id");if(!Zy.isString(o))throw new Error("Invalid opponent id");var r=GameSDK.context.getID();if(!r)throw new Error("Cannot get contextId");return Wy.challenge.continue.processAsync({matchId:n,contextId:r,playerId:a,opponentId:o})})),this.processChallengeNewOpponentAsync$=o((function*(){var e=Ky.getConnectedPlayerIds(100,0),t=Math.floor(Math.random()*e.length),n=Ky.getPlayerId(),i=e[t];if(!Zy.isString(i)||Zy.isEmpty(i))throw new Error("Invalid opponent id");return Wy.challenge.friend.processAsync({playerId:n,opponentId:i})})),this.processJoinChallengeAsync$=o((function*(){var t=e.getMatchState$(),n=t.id,i=t.customData,a=i.playerId,o=i.opponentId;if(!Zy.isString(n))throw new Error("Invalid match id");if(!Zy.isString(a))throw new Error("Invalid player id");if(!Zy.isString(o))throw new Error("Invalid opponent id");return Wy.challenge.join.processAsync({matchId:n,playerId:a,opponentId:o})})),this.processStartGameModeAsync$=function(){var e=o((function*(e){var t=Ky.getPlayerId();return Wy.strategy.start.processAsync({matchId:"123456",gameMode:e,playerId:t})}));return function(t){return e.apply(this,arguments)}}(),this.processFinishGameModeAsync$=o((function*(){return Wy.strategy.finish.processAsync({postGlobalLeaderboard:!0,setPlayerBestScore:!0})})),this.getMatchState$=function(){var e=Wy.getMatchState();if(!e)throw new Error("Match state not found");return e},this.createTournamentName=function(){var e=nv[te.randomRangeInt(0,nv.length-1)],t="".concat(e," Tournament"),n=Qy.removeDiacritics(t);return"".concat(n)},this.getTournamentsAsync$=o((function*(){try{return yield GameSDK.tournament.getTournamentsAsync()}catch(e){return console.error(e),[]}}))}var i,a,r,l,s,u,c,d,h;return e(n,[{key:"createTournamentPayload",value:function(){var e,t,n,i=Qy.generateObjectId(),a=Ky.getPlayerId(),o=Ky.getPlayer().name,r=Ky.getGameData(),l=null!==(e=null==r?void 0:r.level)&&void 0!==e?e:1,s=Vy.getLevelTheme(l),u=this.getMatchState$().profiles;return{score:null!==(t=null===(n=(void 0===u?{}:u)[a])||void 0===n?void 0:n.score)&&void 0!==t?t:0,playerId:a,mode:tv.TOURNAMENT,name:this.createTournamentName(),leaderboardId:i,payload:{playerId:a,playerName:o,leaderboardId:i,themeId:s}}}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"startMatchAsync",value:(h=o((function*(e){try{var t=null!=e?e:this.getMatchMode();switch(t){case tv.SINGLE:yield this.inst.processStartSingleModeAsync$();break;case tv.TOURNAMENT:yield this.inst.processStartTournamentModeAsync$();break;case tv.CHALLENGE_FRIEND:yield this.inst.processStartChallengeModeAsync$();break;default:t?yield this.inst.processStartGameModeAsync$(t):yield this.inst.processStartSingleModeAsync$()}}catch(e){console.warn("startMatchAsync",e)}})),function(e){return h.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(d=o((function*(e){try{yield Wy.handler.setProfileData(e)}catch(e){console.warn("setProfileMatchDataAsync",e)}})),function(e){return d.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(c=o((function*(e){try{yield Wy.handler.setMatchCustomData(e)}catch(e){console.warn("setMatchCustomDataAsync",e)}})),function(e){return c.apply(this,arguments)})},{key:"getMatchCustomDataAsync",value:(u=o((function*(){try{yield Wy.handler.getMatchCustomData()}catch(e){console.warn("getMatchCustomDataAsync",e)}})),function(){return u.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(s=o((function*(e){try{yield Wy.handler.setLeaderboardScore(e)}catch(e){console.warn("setLeaderboardScoreAsync",e)}})),function(e){return s.apply(this,arguments)})},{key:"finishMatchAsync",value:(l=o((function*(e){try{var t=this.getMatchMode();switch(t){case tv.SINGLE:yield this.inst.processFinishSingleModeAsync$();break;case tv.TOURNAMENT:yield this.inst.processFinishTournamentModeAsync$();break;case tv.CHALLENGE_FRIEND:yield this.inst.processFinishChallengeModeAsync$(e);break;default:t?yield this.inst.processFinishGameModeAsync$():yield this.inst.processFinishSingleModeAsync$()}}catch(e){console.warn("finishMatchAsync",e)}})),function(e){return l.apply(this,arguments)})},{key:"joinTournamentAsync",value:(r=o((function*(e){var t=Ky.getPlayerId();return Wy.tournament.join.processAsync({tournamentId:e,playerId:t})})),function(e){return r.apply(this,arguments)})},{key:"continueTournamentAsync",value:(a=o((function*(e){var t=Ky.getPlayerId();return Wy.tournament.continue.processAsync({playerId:t,contextId:e})})),function(e){return a.apply(this,arguments)})},{key:"getMatchMode",value:function(){var e=this.inst.getMatchState$();return Zy.isString(e.mode)?e.mode:null}},{key:"getMatchCustomData",value:function(){var e=this.inst.getMatchState$();return Zy.isObject(e.customData)?e.customData:null}},{key:"updateMatchStateAfterLevelFinish",value:function(e,t){this.setMatchCustomDataAsync({level:e,score:t});var n=Ky.getPlayerId();this.setProfileMatchDataAsync({id:n,score:t})}},{key:"processCreateTournamentAsync",value:(i=o((function*(){var e=yield this.inst.getTournamentsAsync$(),t=ev.search(e,(function(e){var t=e.getPayload(),n=JSON.parse(Zy.isString(t)?t:"{}");return"DEFAULT"===e.getTournamentType()&&n.playerId===Ky.getPlayerId()}));if(t)throw new Fy(Ky.getPlayerId(),t.getID());var n=this.inst.createTournamentPayload();Ky.setGameData({lastCreateTournamentShown:Date.now()}),yield Wy.tournament.create.processAsync(n);var i=n.leaderboardId;jy.addLeaderboard({name:i,type:"tournament",autoSortRank:!0,leaderboardId:i})})),function(){return i.apply(this,arguments)})}]),n}());S._RF.pop(),S._RF.push({},"d90c4WisP9LybAFqNuS6imZ","FailKeys",void 0);var av="time",ov="bomb";S._RF.pop(),S._RF.push({},"43ee9veYalAU7wfruC56uJv","GameMode",void 0);var rv,lv="custom";S._RF.pop(),S._RF.push({},"44b50YkamZDD5fO9vdZKeG7","InputController",void 0);var sv=(0,C.ccclass)("InputController")(rv=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleElementPointerDown=function(){},e.handleElementPointerUp=function(e){},e}return e(r,[{key:"onLoad",value:function(){this.listenInputEvents()}},{key:"listenInputEvents",value:function(){J.os!==J.OS.WINDOWS&&J.os!==J.OS.OSX||(document.addEventListener("pointerup",this.handleElementPointerUp),document.addEventListener("pointerdown",this.handleElementPointerDown))}},{key:"onDestroy",value:function(){J.os!==J.OS.WINDOWS&&J.os!==J.OS.OSX||(document.removeEventListener("pointerup",this.handleElementPointerUp),document.removeEventListener("pointerdown",this.handleElementPointerDown))}}]),r}(T))||rv;S._RF.pop(),S._RF.push({},"7f144HjLfBLWbFvbRFCCt8e","Directions",void 0);var uv={Up:{x:0,y:1},Down:{x:0,y:-1},Left:{x:-1,y:0},Right:{x:1,y:0}};S._RF.pop(),S._RF.push({},"361eckT3VBO5ZFyetePNmNY","LevelGravity",void 0);var cv="fall-down",dv="fly-up",hv="push-left",pv="push-right",yv="put-columns-middle",vv="put-rows-middle",fv=[cv,dv,hv,pv,yv,vv],gv=[cv,dv,vv],mv=[hv,pv,yv];S._RF.pop(),S._RF.push({},"636f3vmmpVFBLNjr6WR2MSa","CustomModeUtils",void 0);var bv=codex.player,wv=function(){function n(){t(this,n)}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getCustomBonus",value:function(){var e=this.getCustomData(),t=e.time,n=e.difficulty,i=e.bombs,a=e.ads;return this.getTimeBonus(t)+this.getDifficultyBonus(n)+this.getBombsBonus(i)+this.getExtraAdsBonus(a)}},{key:"getCustomData",value:function(){var e,t=(null!==(e=bv.getGameData())&&void 0!==e?e:{}).custom;return void 0===t?{time:4,difficulty:1,bombs:0,ads:!1}:t}},{key:"getTimeBonus",value:function(e){return 5*(e-4)}},{key:"getDifficultyBonus",value:function(e){return 3===e?30:20*(e-1)}},{key:"getBombsBonus",value:function(e){return 5*e}},{key:"getExtraAdsBonus",value:function(e){return e?75:0}}]),n}();S._RF.pop(),S._RF.push({},"f0eaf/DUO9MpretbO/JIGbt","CustomGameData",void 0);var Sv={time:[40,30,20,10,0,-10,-20,-30,-40],difficulty:["Easy","Normal","Hard","Extreme"],bombs:[0,1,2,3,4]};S._RF.pop(),S._RF.push({},"c0656MbbYRE+KSk63rv74ZI","SkinKeys",void 0);var kv={CAKES:"cakes",CAR:"car",COSMETIC:"cosmetics",FLOWER:"flower",FRUIT:"fruit",ICE_CREAM:"ice-cream",SPORT:"sport",TOOL:"tool"};S._RF.pop(),S._RF.push({},"5c321EpuONCAq5BAh+AQCcd","RandomizedLevelDataConfig",void 0);var Cv=5,Ev=[90,200],Av=[6,30],Tv={bombRange:[1,8],rocketRange:[0,2]},Pv={maxSpaceOfPairRange:[2,10],addRandomTilesPerMoveRange:[0,8]},Ov=[5,7],Lv=[6,12];S._RF.pop(),S._RF.push({},"4e7344vPB1EoI9uMkZu5Zd0","createRandomizedLevelData",void 0);var Iv,Rv,_v=function(e,t){return function(n){return n<=0?[e,t]:n>=1?[t,t]:[Math.floor(e+n*(t-e)),t]}},Dv=function(e,t){var n=Math.ceil(e),i=Math.floor(t);return Math.floor(Math.random()*(i-n+1))+n},Mv=function(e){return function(t){return Dv.apply(void 0,g(e(t)))}},Nv={generateDifficulty:(Iv=Cv,function(e){return Iv<=1?0:(e-1)%Iv/(Iv-1)}),generateTime:Mv(function(e,t){var n=_v(t,e);return function(e){return n(e)}}.apply(void 0,g(Ev))),generateColors:Mv(_v.apply(void 0,g(Av))),specials:{generateBomb:Mv(_v.apply(void 0,g(Tv.bombRange))),generateRocket:Mv(_v.apply(void 0,g(Tv.rocketRange)))},rules:{generateMaxSpaceOfPair:Mv(_v.apply(void 0,g(Pv.maxSpaceOfPairRange))),generateAddRandomTilesPerMove:Mv(_v.apply(void 0,g(Pv.addRandomTilesPerMoveRange)))},generateColumns:Mv(_v.apply(void 0,g(Ov))),generateRows:Mv(_v.apply(void 0,g(Lv)))};S._RF.pop(),S._RF.push({},"bbe87JDGgVEkJdgCL2ydwxX","LevelManager",void 0);var Bv=C.ccclass,Fv=Ludex.Utils,xv=Fv.Json,zv=Fv.Array,Uv=codex.monitorError,Gv=Object.values(kv),Hv=[[4,6],[4,8],[5,8],[6,8],[5,10],[6,10],[7,10],[7,12]],qv=[-2,0,2,5],Vv={level:1,mode:"normal",time:900,colors:12,specials:{bomb:0,rocket:0},rules:{maxSpaceOfPair:1,addRandomTilesPerMove:0},columns:5,rows:6,theme:["flower"]},$v=function(){var e={};return function(t){if(e[t])return e[t];var n=function(e){var t=Nv.generateDifficulty(e),n=Nv.generateColumns(t),i=Nv.generateRows(t);return{rows:n%2==1&&i%2==1?i+1:i,columns:n,colors:Nv.generateColors(t),gravity:Math.random()>.75?"normal":Math.random()>.5?fv[Math.floor(Math.random()*fv.length)]:[gv[Math.floor(Math.random()*gv.length)],mv[Math.floor(Math.random()*mv.length)]].join("-"),rules:{addRandomTilesPerMove:Nv.rules.generateAddRandomTilesPerMove(t),maxSpaceOfPair:Nv.rules.generateMaxSpaceOfPair(t)},specials:{bomb:Nv.specials.generateBomb(t),rocket:Nv.specials.generateRocket(t)},time:Nv.generateTime(t)}}(t);return e[t]={level:t,theme:Gv,rows:n.rows,columns:n.columns,colors:n.colors,mode:n.gravity,rules:{maxSpaceOfPair:n.rules.maxSpaceOfPair,addRandomTilesPerMove:n.rules.addRandomTilesPerMove},specials:{bomb:n.specials.bomb,rocket:n.specials.rocket},time:n.time},e[t]}},Wv=Bv("LevelManager")(Rv=function(a){n(u,a);var r,l,s=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=s.call.apply(s,[this].concat(i))).getRandomizedLevelData=$v(),e}return e(u,[{key:"loadLevel",value:(l=o((function*(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=yield this.loadLevelData(t);this.levelData=null!==(e=null!=n?n:this.levelData)&&void 0!==e?e:Vv,null==Uv||Uv.addMetadata({level:t})})),function(){return l.apply(this,arguments)})},{key:"loadLevelData",value:(r=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=null;if(e>=at)t=this.getRandomizedLevelData(e);else{var n=10,i=this.paddingZero("".concat(Math.floor(e/n)+1),3),a=e%n,o=yield qe.loadJsonAsync("".concat(it.LEVEL_DATA_FOLDER,"/").concat(i));if(!o)return null;if(null===o.json)return null;t=o.json[a]}if(!(t=xv.clone(t)))return null;if(iv.getMatchMode()===lv){var r,l,s,u=wv.getCustomData(),c=t.time*(1+(null!==(r=Sv.time[u.time])&&void 0!==r?r:0)/100),d=t.specials.bomb+(null!==(l=Sv.bombs[u.bombs])&&void 0!==l?l:0),h=Math.min(t.colors+(null!==(s=qv[u.difficulty])&&void 0!==s?s:0),30),p=this.getDifficulty(t.columns,t.rows);if(void 0!==p){var y;p+=u.difficulty-1;var f=null!==(y=this.getCustomColumnAndRow(p))&&void 0!==y?y:[t.columns,t.rows],g=v(f,2),m=g[0],b=g[1];t.rows=b,t.columns=m}t.time=c,t.specials.bomb=d,t.colors=h}return t})),function(){return r.apply(this,arguments)})},{key:"getLevelData",value:function(){return this.levelData}},{key:"getCustomColumnAndRow",value:function(e){return Hv[te.clamp(e,0,Hv.length-1)]}},{key:"getDifficulty",value:function(e,t){var n=zv.searchIndex(Hv,(function(n){var i=v(n,2),a=i[0],o=i[1];return a===e&&o===t}));return-1===n?void 0:n}},{key:"paddingZero",value:function(e,t){for(var n="",i=0;i<t-e.length;i++)n+="0";return n+e}}]),u}(T))||Rv;function Kv(e){for(var t=e.array,n=e.isLighter,i=e.out,a=void 0===i?new Set:i,o=0;o<t.length;o++)if(n(t.get(o)))for(var r=o+1;r<t.length;r++)if(!n(t.get(r))){t.swap(o,r),a.add(t.get(o));break}return a}S._RF.pop(),S._RF.push({},"bfb989Gr/dArq4M9uSSrF5/","stagger",void 0),S._RF.pop(),S._RF.push({},"cf506DevntPeIl9QrpMEBY0","Grid",void 0);var jv,Yv,Xv,Jv,Zv,Qv,ef,tf,nf,af,of,rf,lf,sf,uf,cf,df,hf,pf,yf,vf,ff,gf,mf,bf,wf,Sf,kf,Cf,Ef,Af,Tf,Pf,Of,Lf,If,Rf,_f,Df,Mf,Nf,Bf,Ff,xf,zf,Uf,Gf,Hf,qf,Vf,$f,Wf,Kf,jf,Yf,Xf,Jf,Zf,Qf,eg,tg,ng,ig,ag,og,rg,lg,sg,ug,cg,dg,hg,pg,yg,vg=function(){function n(e){var i;t(this,n),this.array=[];var a=null!=e?e:{},o=a.width,r=void 0===o?1:o,l=a.height,s=void 0===l?1:l,u=e instanceof n?e.array:null!==(i=null==e?void 0:e.content)&&void 0!==i?i:[];if(u.length!==r*s)throw new Error("Invalid content length");this.width=r,this.height=s,this.array=g(u)}return e(n,[{key:"asArray",value:function(){return this.array}},{key:"get",value:function(e,t){if(!this.isInBounds(e,t))throw new Error("Out of bounds");return this.array[t*this.width+e]}},{key:"set",value:function(e,t,n){this.array[t*this.width+e]=n}},{key:"isInBounds",value:function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height}},{key:"each",value:function(e){for(var t=0;t<this.height;t++)for(var n=0;n<this.width;n++)e(this.get(n,t),n,t)}},{key:"map",value:function(e){for(var t=[],n=0;n<this.height;n++)for(var i=0;i<this.width;i++)t.push(e(this.get(i,n),i,n));return t}},{key:"reduce",value:function(e,t){for(var n=t,i=0;i<this.height;i++)for(var a=0;a<this.width;a++)n=e(n,this.get(a,i),a,i);return n}},{key:"swap",value:function(e,t){var n=v(e,2),i=n[0],a=n[1],o=v(t,2),r=o[0],l=o[1],s=this.get(i,a);this.set(i,a,this.get(r,l)),this.set(r,l,s)}},{key:"shuffle",value:function(e){for(var t=null!=e?e:this.map((function(e,t,n){return[t,n]})),n=g(t),i=new Set,a=n.length-1;a>0;a--){var o=se(0,a+1),r=n[a],l=n[o];n[a]=l,n[o]=r,i.add(this.get(r[0],r[1])),i.add(this.get(l[0],l[1]))}for(var s=0;s<n.length;s++){var u=t[s],c=v(u,2),d=c[0],h=c[1],p=n[s],y=v(p,2),f=y[0],m=y[1];this.swap([d,h],[f,m])}return i}},{key:"toShuffled",value:function(e){var t=new n({width:this.width,height:this.height,content:this.array}),i=t.shuffle(e);return[t,i]}},{key:"gravitate",value:function(e){var t=this,n=v(e.rowRange,2),i=n[0],a=n[1],o=v(e.colRange,2),r=o[0],l=o[1],s=e.direction,u=e.isLighter,c=e.onSwap,d=e.out,h=void 0===d?new Set:d,p=l-r+1,y=a-i+1;switch(s){case uv.Up:for(var f=function(e){Kv({array:{length:y,get:function(n){return t.get(e,a-n)},swap:function(n,i){var o=t.get(e,a-n),r=t.get(e,a-i);t.swap([e,a-n],[e,a-i]),null==c||c(o,r)}},isLighter:u,out:h})},g=r;g<=l;g++)f(g);return h;case uv.Down:for(var m=function(e){Kv({array:{length:y,get:function(n){return t.get(e,i+n)},swap:function(n,a){var o=t.get(e,i+n),r=t.get(e,i+a);t.swap([e,i+n],[e,i+a]),null==c||c(o,r)}},isLighter:u,out:h})},b=r;b<=l;b++)m(b);return h;case uv.Left:for(var w=function(e){Kv({array:{length:p,get:function(n){return t.get(r+n,e)},swap:function(n,i){var a=t.get(r+n,e),o=t.get(r+i,e);t.swap([r+n,e],[r+i,e]),null==c||c(a,o)}},isLighter:u,out:h})},S=i;S<=a;S++)w(S);return h;case uv.Right:for(var k=function(e){Kv({array:{length:p,get:function(n){return t.get(l-n,e)},swap:function(n,i){var a=t.get(l-n,e),o=t.get(l-i,e);t.swap([l-n,e],[l-i,e]),null==c||c(a,o)}},isLighter:u,out:h})},C=i;C<=a;C++)k(C);return h;default:throw new Error("Invalid direction")}}},{key:"toGravitated",value:function(){var e=new n({width:this.width,height:this.height,content:this.array}),t=e.gravitate.apply(e,arguments);return[e,t]}},{key:"toRotated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new n({width:this.height,height:this.width,content:new Array(this.width*this.height)});if(e)for(var i=0;i<this.height;i++)for(var a=this.width-1;a>=0;a--)t.set(i,this.width-1-a,this.get(a,i));else for(var o=this.height-1;o>=0;o--)for(var r=0;r<this.width;r++)t.set(this.height-1-o,r,this.get(r,o));return t}}]),n}();S._RF.pop(),S._RF.push({},"4046cPYak1BDIVFKksVPsnk","index",void 0),S._RF.pop(),S._RF.push({},"ea140gA27tJa4LD9MT3t93/","Tile",void 0);var fg=C.ccclass,gg=C.property,mg=C.requireComponent,bg=Ludex.Utils,wg=bg.Signal,Sg=bg.Function,kg=(jv=fg("Tile"),Yv=mg([P]),Xv=mg([B]),Jv=Yn.required(),Zv=gg({type:F,group:"Sprite"}),Qv=Yn.required(),ef=gg({type:F,group:"Sprite"}),tf=Yn.required(),nf=gg({type:F,group:"Sprite"}),af=Yn.required(),of=gg({type:F,group:"Sprite"}),rf=Yn.required(),lf=gg({type:F,group:"Sprite"}),sf=Yn.required(),uf=gg({type:P,displayName:"Background UI Transform"}),cf=Yn.required(),df=gg(ue),hf=Yn.required(),pf=gg({type:B,group:"Opacity"}),yf=Yn.required(),vf=gg({type:B,group:"Opacity"}),ff=Yn.required(),gf=gg({type:B,group:"Opacity"}),mf=Yn.required(),bf=gg({type:B,group:"Opacity"}),wf=Yn.required(),Sf=gg({type:B,group:"Opacity"}),kf=Yn.required(),Cf=gg({type:B,group:"Opacity"}),Ef=Yn.required(),Af=gg({type:B,group:"Opacity"}),Tf=Yn.required(),Pf=gg(Cr),Of=Yn.required(),Lf=gg(q),If=Yn.required(),Rf=gg({type:ce,group:"Animation"}),_f=Yn.required(),Df=gg({type:de,group:"Animation"}),Mf=Yn.required(),Nf=gg({type:de,group:"Animation"}),Bf=Yn.required(),Ff=gg({type:de,group:"Animation"}),xf=Yn.required(),zf=gg({type:de,group:"Animation"}),Uf=Yn.onlyRunInLifeCycle,Gf=Yn.onlyRunInLifeCycle,Hf=Yn.onlyRunInLifeCycle,qf=Yn.onlyRunInLifeCycle,Vf=Yn.onlyRunInLifeCycleAsync,$f=Yn.onlyRunInLifeCycleAsync,jv(Wf=Yv(Wf=Xv((jf=a((Kf=function(a){n(w,a);var s,u,c,d,h,p,y,f,g,m,b=i(w);function w(){var e;t(this,w);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=b.call.apply(b,[this].concat(i)),r(e,"iconPlaceholder",jf,l(e)),r(e,"icon",Yf,l(e)),r(e,"bombComponent",Xf,l(e)),r(e,"starComponent",Jf,l(e)),r(e,"background",Zf,l(e)),r(e,"bgUITransform",Qf,l(e)),r(e,"defaultBackground",eg,l(e)),r(e,"uiOpacity",tg,l(e)),r(e,"shineOpacity",ng,l(e)),r(e,"glowOpacity",ig,l(e)),r(e,"iconOpacity",ag,l(e)),r(e,"iconPlaceholderOpacity",og,l(e)),r(e,"bombUiOpacity",rg,l(e)),r(e,"startUiOpacity",lg,l(e)),r(e,"button",sg,l(e)),r(e,"container",ug,l(e)),r(e,"animationComponent",cg,l(e)),r(e,"clearClip",dg,l(e)),r(e,"shakeClip",hg,l(e)),r(e,"breakClip",pg,l(e)),r(e,"lightningClearClip",yg,l(e)),e.id=null,e.frames=[],e.isEmpty=!1,e.coord=new ae,e.mainSignalController=new wg.SignalController,e.identitySignalController=new wg.SignalController,e.placeholderSignalController=new wg.SignalController,e.specialSignalController=new wg.SignalController,e}return e(w,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,w),this.special=this.createSpecialHandler(ot.none)}},{key:"update",value:function(e){var t;(null===(t=this.special)||void 0===t?void 0:t.type)===ot.bomb&&this.special.update(e)}},{key:"onDestroy",value:function(){var e,t;(null===(e=this.special)||void 0===e?void 0:e.type)!==ot.none&&(null===(t=this.special)||void 0===t||t.onDestroy())}},{key:"setIgnoreInput",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.button.interactable=!e}},{key:"getCoord",value:function(){return this.coord}},{key:"setCoord",value:function(e,t){this.coord.set(e,t)}},{key:"isSimilarTo",value:function(e){return this.id===e.id}},{key:"inSamePositionAs",value:function(e,t){return e instanceof w?this.coord.equals(e.getCoord()):this.coord.x===e&&this.coord.y===t}},{key:"isHidden",value:function(){return this.isEmpty}},{key:"getSize",value:function(){return[this.bgUITransform.width,this.bgUITransform.height]}},{key:"onClick",value:function(){this.isHidden()||this.node.scene.emit(Es.TILE_CLICK,this)}},{key:"setIdentity",value:function(e,t){this.id=e,this.frames=t,this.updateIdentityFrame()}},{key:"updateIdentityFrame",value:(m=o((function*(){var e,t=this;if(null!==this.id){var n=this.identitySignalController.renew();if(!Array.isArray(this.frames)){this.setPlaceholderVisible(!0,n);var i=yield this.frames;if(n.aborted)return;this.frames=i}var a=this.frames[this.id];a?(this.setPlaceholderVisible(!1,n),null===(e=n.wrap((function(){return t.setIdentityFrame(a)})))||void 0===e||e()):console.error("Failed to load identity frame. ".concat(this.id," is not in the frames array."))}})),function(){return m.apply(this,arguments)})},{key:"setPlaceholderVisible",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this.placeholderSignalController.renew();if(t&&n.chain(t),e)return Ve.runTweenAsync(R(this.iconPlaceholder.node).to(.15,{scale:V.ONE},{easing:"backOut"}),n),void Ve.runTweenAsync(R(this.iconPlaceholderOpacity).delay(he(0,.75)).to(.15,{opacity:255}).repeatForever(R(this.iconPlaceholderOpacity).to(.25,{opacity:80}).delay(.25).to(.25,{opacity:255}).delay(.75)),n);Ve.runTweenAsync(R(this.iconPlaceholder.node).to(.15,{scale:V.ZERO},{easing:"backIn"}),n),Ve.runTweenAsync(R(this.iconPlaceholderOpacity).to(.15,{opacity:0}),n)}},{key:"setIdentityFrame",value:function(e,t){var n=this;this.icon.spriteFrame=e;var i=this.getSize(),a=v(i,2),o=a[0],r=a[1],l=e.originalSize,s=l.width,u=l.height,c=Math.max(s/(.7*o),u/(.7*r));this.icon.node.setScale(0,0,0);var d=function(){n.icon.node.setScale(1/c,1/c,1)};null==t||t.once(d),Ve.runTweenAsync(R(this.icon.node).delay(he(0,.2)).to(.15,{scale:new V(1/c,1/c,1)},{easing:"sineOut"}),t),null==t||t.off(d)}},{key:"setSpecialType",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot.none,a=arguments.length>1?arguments[1]:void 0;if(null===(e=this.special)||void 0===e||e.switch(i,a),(null===(t=this.special)||void 0===t?void 0:t.type)===ot.bomb||(null===(n=this.special)||void 0===n?void 0:n.type)===ot.star){var o=this.special;if(!Array.isArray(this.frames)){var r=this.specialSignalController.renew();o.hide(r,!0),this.frames.then((function(){o.isDestroyed||o.show(r)}))}}}},{key:"setFocused",value:(g=o((function*(e){var t=R(this.shineOpacity).to(.15,{opacity:e?255:0},{easing:"cubicOut"});this.shineOpacity.node.scale=e?V.ZERO:V.ONE;var n=R(this.shineOpacity.node).to(.15,{scale:e?V.ONE:V.ZERO},{easing:"cubicOut"});if(e){var i=R(this.glowOpacity).to(2,{opacity:150});i.to(2,{opacity:20}),this.glowOpacityTween=R(this.glowOpacity).repeatForever(i).start()}else this.glowOpacityTween&&this.glowOpacityTween.stop(),this.glowOpacity.opacity=0;yield Promise.all([Ve.runTweenAsync(t),Ve.runTweenAsync(n)])})),function(e){return g.apply(this,arguments)})},{key:"setEmpty",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isEmpty||(this.mainSignalController.abort(),this.isEmpty=!0,this.setIgnoreInput(!0),this.button.resetButtonState(),i||(null===(e=this.special)||void 0===e?void 0:e.type)!==ot.star&&(null===(t=this.special)||void 0===t?void 0:t.type)!==ot.bomb||this.special.clear(),this.setOpacity(0),null===(n=this.special)||void 0===n||n.switch(ot.none))}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"setHint",value:(f=o((function*(e){var t,n=this.mainSignalController.renew();if(e)yield this.runAnimation(this.shakeClip.name,n);else if(null===(t=this.animationComponent)||void 0===t||t.stop(),this.container){var i=R(this.container).to(.1,{scale:V.ONE,eulerAngles:V.ZERO});yield Ve.runTweenAsync(i,n)}})),function(e){return f.apply(this,arguments)})},{key:"playClearFX",value:(y=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mainSignalController.renew();this.setOpacity(255);var a=function(){return t.setOpacity(0)},o=n?this.lightningClearClip:this.clearClip;i.once(a),yield this.runAnimationAfterDelay(o.name,e,i),i.off(a),i.aborted||a()})),function(e){return y.apply(this,arguments)})},{key:"playOldLightningClearFX",value:(p=o((function*(){var e=this,t=this.mainSignalController.renew();this.setOpacity(255);var n=function(){return e.setOpacity(0)};t.once(n),yield this.runAnimation(this.breakClip.name,t),t.off(n),t.aborted||n()})),function(){return p.apply(this,arguments)})},{key:"runAnimationAfterDelay",value:(h=o((function*(e,t,n){t&&(yield Ve.waitTweenAsync(t,n)),yield this.runAnimation(e,n)})),function(e,t,n){return h.apply(this,arguments)})},{key:"runAnimation",value:function(e,t){return Ve.runAnimationAsync(this.animationComponent,e,t)}},{key:"restore",value:(d=o((function*(e,t){var n=this.mainSignalController.renew();this.animationComponent.stop(),this.isEmpty=!1,this.setIgnoreInput(!0),void 0!==e&&t&&this.setIdentity(e,t),this.setOpacity(255),this.iconOpacity.opacity=255,this.node.setScale(V.ZERO),this.background.spriteFrame=this.defaultBackground,this.button.fakeClick(),yield Ve.runTweenAsync(R(this.node).to(.3,{scale:V.ONE},{easing:"backOut"}),n),this.node.setScale(V.ONE),this.setIgnoreInput(!1)})),function(e,t){return d.apply(this,arguments)})},{key:"sync",value:(c=o((function*(e){var t=e.duration,n=void 0===t?.3:t,i=e.delay,a=void 0===i?0:i,o=e.easing,r=void 0===o?"cubicOut":o,l=(0,e.getTargetPosition)(this.coord),s=new V(l.x,l.y,this.node.position.z);yield Ve.runTweenAsync(R(this.node).delay(a).to(n,{position:s},{easing:r}))})),function(e){return c.apply(this,arguments)})},{key:"fly",value:(u=o((function*(e){var t=this,n=300,i=Math.sqrt(Math.pow(this.node.position.x,2)+Math.pow(this.node.position.y,2)),a=Math.max(n-.7*i,0),o=i/1e3,r=this.node.position.clone(),l=e.getTilePosition(this.coord),s=new V(l.x,l.y,this.node.position.z),u=this.container,c=2,d=1,h=360,p=.0025*a,y=0,v=new V(0,0,0),f=.75-p,g={value:0,prevElapsed:0},m=R(g);return m.delay(o),m.to(.5,{value:0},{progress:function(e,n,i,a){var o=(c*=-1)*a,l=r.clone();return l.x+=o,t.node.setPosition(l),i}}),m.to(p,{value:1},{progress:function(e,i,o,r){var l=Ve.easeOutExpo(r),s=p*r-g.prevElapsed,c=p*r,y=a*l;t.setHeight(y,n);var v=t.node.position.clone();d+=.1,V.rotateZ(v,v,new V(0,0,0),d*Math.PI*s),t.node.setPosition(new V(v.x,v.y,v.z));var f=(h+=10)*s;return u.angle+=f,g.prevElapsed=c,o}}),m.call((function(){v.set((t.node.position.x+s.x)/2,(t.node.position.y+s.y)/2,0),g.prevElapsed=0,u.angle%=360,u.angle-=360,y=u.angle})),m.to(f,{value:0},{progress:function(e,i,o,r){var l=f*r-g.prevElapsed,s=f*r,c=a*(1-r);t.setHeight(c,n);var d=t.node.position.clone();return V.rotateZ(d,d,v,Math.PI/f*l),t.node.setPosition(new V(d.x,d.y,d.z)),u.angle+=-y/f*l,g.prevElapsed=s,o}}),m.call((function(){t.node.setPosition(s),t.setHeight(0,n),u.angle=0})),Ve.runTweenAsync(m)})),function(e){return u.apply(this,arguments)})},{key:"moveAround",value:(s=o((function*(){for(var e=[{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],t=this.container.position.clone(),n=-1,i=0;i<5;i++){for(var a=te.randomRangeInt(0,4);n===a;)a=te.randomRangeInt(0,4);n=a;var o=e[a];if(o){var r=t.clone().add(new V(5*o.x,5*o.y)),l=R(this.container).to(.1,{position:r},{easing:"smooth"});yield Ve.runTweenAsync(l)}}var s=R(this.container).to(.1,{position:t},{easing:"smooth"});yield Ve.runTweenAsync(s)})),function(){return s.apply(this,arguments)})},{key:"setHeight",value:function(e,t){if(this.container){var n=this.container;n.setPosition(new V(n.position.x,e,0)),n.setScale(new V(1+e/t*.3,1+e/t*.3,1))}}},{key:"createSpecialHandler",value:function(e,t){var n=this;switch(e){case ot.bomb:return this.createBombHandler(null!=t?t:90);case ot.star:return this.createStarHandler();default:return{type:ot.none,switch:function(e,t){n.special=n.createSpecialHandler(e,t)}}}}},{key:"createBombHandler",value:function(e){var t=this,n=!1,i=!1,a=e,o=function(){i=!0},r=function(){i=!1};this.node.scene.on(Es.TILE_CLICK,o),this.node.scene.on(Es.USE_ITEM,o),this.node.scene.on(Es.RESUME_TIME,o),this.node.scene.on(Es.PAUSE_TIME,r),this.node.scene.on(Es.TIME_OUT,r),this.bombComponent.node.active=!0;var l=function(){n=!0,i=!1,t.bombComponent.node.active=!1,a=e,t.node.scene.off(Es.TILE_CLICK,o),t.node.scene.off(Es.USE_ITEM,o),t.node.scene.off(Es.GAME_RESUME,o),t.node.scene.off(Es.GAME_PAUSE,r),t.node.scene.off(Es.TIME_OUT,r)};return{type:ot.bomb,get isDestroyed(){return n},update:function(n){i&&(a-=n,t.bombComponent.fillRange=-a/e,a<=0&&(i=!1,t.bombComponent.node.active=!1,t.setEmpty(!0),t.node.scene.emit(Es.BOMB_EXPLODE,t)))},clear:function(){je.playSound(Qi.BOMB_DEFUSE)},cleanup:l,onDestroy:function(){n=!0,t.node.scene.off(Es.TILE_CLICK,o),t.node.scene.off(Es.USE_ITEM,o),t.node.scene.off(Es.GAME_RESUME,o),t.node.scene.off(Es.GAME_PAUSE,r),t.node.scene.off(Es.TIME_OUT,r)},switch:function(e,n){l(),t.special=t.createSpecialHandler(e,n)},show:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=255})),Sg.allSettled([Ve.runTweenAsync(R(t.bombUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=255},hide:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=0})),Sg.allSettled([Ve.runTweenAsync(R(t.bombUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=0},detonateImmediately:function(){a=0}}}},{key:"createStarHandler",value:function(){var e=this,t=!1;this.starComponent.node.active=!0;var n=function(){t=!0,e.starComponent.node.active=!1};return{type:ot.star,get isDestroyed(){return t},clear:function(){e.starComponent.node.active=!1,je.playSound(Qi.COLLECT_STARS);var t=e.node.worldPosition,n=t.x,i=t.y;e.node.scene.emit(Es.ADD_STARS,{startAnimationAt:[n,i]})},cleanup:n,onDestroy:function(){t=!0},show:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=255})),Sg.allSettled([Ve.runTweenAsync(R(e.startUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=255},hide:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=0})),Sg.allSettled([Ve.runTweenAsync(R(e.startUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=0},switch:function(t){n(),e.special=e.createSpecialHandler(t)}}}}]),w}(T)).prototype,"iconPlaceholder",[Jv,Zv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf=a(Kf.prototype,"icon",[Qv,ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xf=a(Kf.prototype,"bombComponent",[tf,nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jf=a(Kf.prototype,"starComponent",[af,of],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zf=a(Kf.prototype,"background",[rf,lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=a(Kf.prototype,"bgUITransform",[sf,uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg=a(Kf.prototype,"defaultBackground",[cf,df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tg=a(Kf.prototype,"uiOpacity",[hf,pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ng=a(Kf.prototype,"shineOpacity",[yf,vf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ig=a(Kf.prototype,"glowOpacity",[ff,gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ag=a(Kf.prototype,"iconOpacity",[mf,bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),og=a(Kf.prototype,"iconPlaceholderOpacity",[wf,Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rg=a(Kf.prototype,"bombUiOpacity",[kf,Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lg=a(Kf.prototype,"startUiOpacity",[Ef,Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sg=a(Kf.prototype,"button",[Tf,Pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ug=a(Kf.prototype,"container",[Of,Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cg=a(Kf.prototype,"animationComponent",[If,Rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dg=a(Kf.prototype,"clearClip",[_f,Df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hg=a(Kf.prototype,"shakeClip",[Mf,Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pg=a(Kf.prototype,"breakClip",[Bf,Ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yg=a(Kf.prototype,"lightningClearClip",[xf,zf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Kf.prototype,"setIgnoreInput",[Uf],Object.getOwnPropertyDescriptor(Kf.prototype,"setIgnoreInput"),Kf.prototype),a(Kf.prototype,"setPlaceholderVisible",[Gf],Object.getOwnPropertyDescriptor(Kf.prototype,"setPlaceholderVisible"),Kf.prototype),a(Kf.prototype,"setIdentityFrame",[Hf],Object.getOwnPropertyDescriptor(Kf.prototype,"setIdentityFrame"),Kf.prototype),a(Kf.prototype,"setOpacity",[qf],Object.getOwnPropertyDescriptor(Kf.prototype,"setOpacity"),Kf.prototype),a(Kf.prototype,"runAnimationAfterDelay",[Vf],Object.getOwnPropertyDescriptor(Kf.prototype,"runAnimationAfterDelay"),Kf.prototype),a(Kf.prototype,"runAnimation",[$f],Object.getOwnPropertyDescriptor(Kf.prototype,"runAnimation"),Kf.prototype),Wf=Kf))||Wf)||Wf)||Wf);S._RF.pop(),S._RF.push({},"d6995j9hvVJYKs6vvV+rs1I","index",void 0),S._RF.pop(),S._RF.push({},"d65b2oe6HRJU7zJnHC2Jubi","BoardScale",void 0);function Cg(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n.x,o=n.y,r=v(t,2),l=r[0],s=r[1],u=l*(a-(e.width-1)/2)+i*(a-e.width/2),c=s*(o-(e.height-1)/2)+i*(o-e.height/2);return-1===a&&(u+=t[0]/4),a===e.width&&(u-=t[0]/4),-1===o&&(c+=t[1]/4),o===e.height&&(c-=t[1]/4),{x:u,y:c}}function Eg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=v(e,2),i=n[0],a=n[1],o=v(t,2),r=o[0],l=o[1],s=1-r,u=1-l,c=i*s,d=a*u;return[c,d]}function Ag(e){for(var t=e.split("-"),n=[],i=0;i<t.length;){var a=null;switch(t[i]){case"normal":i+=1;break;case"fall":a=cv,i+=2;break;case"fly":a=dv,i+=2;break;case"push":"left"===t[i+1]?(a=hv,i+=2):(a=pv,i+=2);break;case"put":"columns"===t[i+1]?(a=yv,i+=3):(a=vv,i+=3)}a&&n.push(a)}return n}function Tg(e){switch(e){case cv:return pv;case dv:return hv;case hv:return cv;case pv:return dv;case yv:return vv;case vv:return yv}}function Pg(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.x,o=e.y,r=i?o:n-1-o,l=i?t-1-a:a;return{x:r,y:l}}function Og(e){return(e instanceof vg?e.asArray():e).filter((function(e){return!e.isHidden()}))}function Lg(e){return(e instanceof vg?e.asArray():e).filter((function(e){return e.isHidden()}))}S._RF.pop(),S._RF.push({},"cb8ddC2w59DpqVoQENbYYcU","calcBoardScale",void 0),S._RF.pop(),S._RF.push({},"305c7LJx+ROLI4g8tTiAFyb","calcTilePosition",void 0),S._RF.pop(),S._RF.push({},"c522ca1UPhDYaToWf66t1X2","calcTileSize",void 0),S._RF.pop(),S._RF.push({},"37667B66RZBc5chlMqN6mH8","parseLevelGravity",void 0),S._RF.pop(),S._RF.push({},"60475oElENLe7C3g+jd0ZEl","rotateGravity",void 0),S._RF.pop(),S._RF.push({},"a1c1a/tPEpHy4ITkE80K0lL","rotatePath",void 0),S._RF.pop(),S._RF.push({},"f0f0bXgdxJHIJWOmA6n0Ood","getUncleared",void 0),S._RF.pop(),S._RF.push({},"a90bcq22hlMzbYdivjPpm0h","getBombTiles",void 0),S._RF.pop(),S._RF.push({},"92e23drVfRIgbDVZLTSdEkI","getCleared",void 0),S._RF.pop(),S._RF.push({},"7105bfR+Y5F1a0SDiMXZ9mV","getNearbyTiles",void 0);var Ig=Ludex.Utils.Object;function Rg(e){return Array.isArray(e)}function _g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=Rg(e)?e:e.asArray();return n[le(t,0,n.length)]}S._RF.pop(),S._RF.push({},"d1b9bBg+dBA+7n/Sz+RCIAX","getRandomTile",void 0),S._RF.pop(),S._RF.push({},"c4bf3uyS1pEdrTrwDEXeuZP","getRandomPair",void 0);var Dg=Ludex.Utils.Array;function Mg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=e instanceof vg?e.asArray():e,i=_g(n,t),a=Dg.search(n,(function(e){return e.isSimilarTo(i)&&!e.inSamePositionAs(i)}));if(void 0===a)throw new Error("Could not find a matching tile");return[i,a]}S._RF.pop(),S._RF.push({},"cf8d6gfx2ZIsqm978cNLWaV","pseudoRandomIterable",void 0);var Ng=function(e){return e};function Bg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ng;return function*(){var i=e,a=t;i<=0&&(i=Number.POSITIVE_INFINITY);for(var o=0;o<i;o++)yield n(a),a=1e9*pe(a)}()}function Fg(e){return Array.isArray(e)}function xg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=Fg(e)?e:e.asArray();if(i.length<t)return new Set(i);for(var a=new Set,o=Bg(-1,n),r=o.next();a.size<t;){if(r.done)throw new Error("RNG exhausted");a.add(_g(i,r.value)),r=o.next()}return a}S._RF.pop(),S._RF.push({},"718b6Wu0pdGVK5KYSUDctVX","getRandomTiles",void 0),S._RF.pop(),S._RF.push({},"17ccarKybRNwYcZnBQhCUYy","index",void 0),S._RF.pop(),S._RF.push({},"bab6dqrPz9AaaBN5cy+QzPj","assignSpecialTiles",void 0);var zg=[1,2];function Ug(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=t.specials,o=a.bomb,r=le.apply(void 0,[i].concat(zg)),l=xg(e,o,i),s=e.asArray().filter((function(e){return!l.has(e)})),c=xg(s,r,i),d=u(l);try{for(d.s();!(n=d.n()).done;){var h=n.value,p=2*t.time/3;h.setSpecialType(ot.bomb,p)}}catch(e){d.e(e)}finally{d.f()}var y,v=u(c);try{for(v.s();!(y=v.n()).done;){var f=y.value;f.setSpecialType(ot.star)}}catch(e){v.e(e)}finally{v.f()}}S._RF.pop(),S._RF.push({},"228efPdzUNCMp4yYcBs9r+3","index",void 0),S._RF.pop(),S._RF.push({},"09be7lmGLNMvIObiqskePhz","createGrid",void 0);var Gg=Ludex.Utils.Array;function Hg(e){var t=e.levelData,n=t.columns,i=t.rows,a=e.identities,o=e.setTileIdentity,r=e.createTile,l=e.seed,s=function(e,t,n){var i,a=[],o=u(Bg(t/2,e,(function(e){return le(e,0,n.length)})));try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(n[r]),a.push(n[r])}}catch(e){o.e(e)}finally{o.f()}return Gg.shuffle(a),a}(void 0===l?Date.now():l,n*i,a),c=qg(e.levelData,a,s).reverse(),d=qg(e.levelData,a,c).reverse().map((function(e){var t=r(e);return o(t,e),t}));return new vg({width:n,height:i,content:d})}function qg(e,t,n){var i=e.rows,a=e.columns,o=e.rules;if(!o.maxSpaceOfPair)return n;var r,l=function(e,t,n){for(var i=[],a=0;a<t;a++){i[a]=[];for(var o=0;o<n;o++)i[a][o]=e[a*n+o]}return i}(n,i,a),s=u(t);try{for(s.s();!(r=s.n()).done;)for(var c=r.value,d=null,h=null,p=0;p<i;p++)for(var y=0;y<a;y++){if(l[p][y]===c)if(d&&h){var v=o.maxSpaceOfPair+1;if(Math.abs(p-d)+Math.abs(y-h)<=v)h=y,d=p;else{var f=Vg(d,h,p,y),g=l[f.row][f.column];l[f.row][f.column]=l[p][y],l[p][y]=g}}else d=p,h=y}}catch(e){s.e(e)}finally{s.f()}return function(e){var t,n=[],i=u(e);try{for(i.s();!(t=i.n()).done;){var a,o=t.value,r=u(o);try{for(r.s();!(a=r.n()).done;){var l=a.value;n.push(l)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){i.e(e)}finally{i.f()}return n}(l)}function Vg(e,t,n,i){var a=e,o=t;return n>e&&(a=e+1),n<e&&(a=e-1),i>t&&(o=t+1),i<t&&(o=t-1),{row:a,column:o}}S._RF.pop(),S._RF.push({},"5d998xlab9FLIpvw+sXMIYw","createGridFromFen",void 0);var $g=Ludex.Utils.Array;function Wg(e){var t=e.customFen,n=e.identities,i=e.createTile,a=t.idSize,o=t.cols,r=t.rows,l=t.code;if(n.length<t.idSize)throw new Error("Invalid grid code. There are not enough identities/frames ".concat(n.length," to fill it according to fen code ").concat(a));var s=l.split(":");if(s.length!==r)throw new Error("Invalid grid code");var c=/[a-zA-Z]+\d+|./g,d=/[a-zA-Z]+/,h=/\d+/,p=s.reduceRight((function(e,a){var o,r=[],l=a.matchAll(c),s=u(l);try{for(s.s();!(o=s.n()).done;){var p,y,v=o.value[0],f=null===(p=h.exec(v))||void 0===p?void 0:p[0],g=void 0!==f?parseInt(f,10):void 0,m=void 0!==g&&!isNaN(g)&&g<n.length?n[g]:void 0,b=i(void 0!==m?m:n[0]),w=null===(y=d.exec(v))||void 0===y?void 0:y[0],S=void 0!==w?Kg(w,t.encoding):void 0;void 0!==S&&void 0!==m?b.setSpecialType(S):b.setEmpty(),r.push(b)}}catch(e){s.e(e)}finally{s.f()}return e.concat(r)}),[]);return new vg({width:o,height:r,content:p})}function Kg(e,t){var n=$g.search(Object.entries(t),(function(t){var n=v(t,2);n[0];return n[1]===e}));if(void 0===n)throw new Error("Invalid special type ".concat(e));return n[0]}function jg(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.toRotated(t);return n.each((function(e,t,n){e.setCoord(t,n)})),n}S._RF.pop(),S._RF.push({},"30de5d+cW5OjKyEubKVREbU","createRotatedGrid",void 0),S._RF.pop(),S._RF.push({},"9ceb6vNbn9PKozkdGjjZD67","ensureOneMatch",void 0);var Yg=Ludex.Utils.Array;function Xg(e){var t=e.grid,n=e.setIdentity,i=e.seed,a=void 0===i?Date.now():i,o=t.asArray(),r=_g(t,a),l=function(e,t){var n=t.getCoord(),i=n.x,a=n.y;return Ig.vals(uv).reduce((function(t,n){var o=n.x,r=n.y,l=i+o,s=a+r;return e.isInBounds(l,s)&&t.push(e.get(l,s)),t}),[])}(t,r);if(!l.some((function(e){return e.isSimilarTo(r)}))){var s=_g(l,a),u=Yg.search(o,(function(e){return!e.inSamePositionAs(r)&&!e.inSamePositionAs(s)&&e.isSimilarTo(s)}));if(void 0===u||null===r.id)throw new Error("Could not find a sacrifice tile");n(u,r.id),n(s,r.id)}}S._RF.pop(),S._RF.push({},"89318H0TDxMlJsVFwuKgrh3","index",void 0),S._RF.pop(),S._RF.push({},"fb4a9VOCxBBvpXFCcSt4P3J","NewbieSteps",void 0);var Jg=[{startTile:{x:0,y:1},endTile:{x:3,y:1},localeTextKey:"guide.step1"},{startTile:{x:2,y:2},endTile:{x:3,y:0},localeTextKey:"guide.step2"},{startTile:{x:0,y:0},endTile:{x:3,y:3},localeTextKey:"guide.step3"},{startTile:{x:0,y:4},endTile:{x:2,y:3},localeTextKey:"guide.step4"},{startTile:{x:1,y:4},endTile:{x:1,y:2},localeTextKey:"guide.step5"}];S._RF.pop(),S._RF.push({},"627d5N3oStP8q9+ABNqnHBq","getBestPath",void 0);var Zg=Ludex.Utils.Array;function Qg(e,t){return e[0]===t[0]&&e[1]===t[1]}function em(e){return new ae(e[0],e[1])}function tm(e,t){return e.x>=-1&&e.x<t.width+1&&e.y>=-1&&e.y<t.height+1}function nm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:am;return t.map((function(t){return[e.tile[0]+t.x,e.tile[1]+t.y]}))}var im,am=[uv.Up,uv.Down,uv.Left,uv.Right],om=function(){function n(e,i){var a;if(t(this,n),this.f=0,this.g=0,this.h=0,i&&Qg(e,i.tile))throw new Error("Tile cannot be its own parent");this.tile=e,this.parent=i;var o=n.calcDirection(this),r=i&&o&&i.cache.direction&&!o.equals(i.cache.direction)?1:0;this.cache={direction:o,turns:r+(null!==(a=null==i?void 0:i.cache.turns)&&void 0!==a?a:0)}}return e(n,[{key:"getKey",value:function(){var e;return"x:".concat(this.tile[0],",y:").concat(this.tile[1],",d:").concat(null===(e=this.cache.direction)||void 0===e?void 0:e.toString())}},{key:"equals",value:function(e){return this.getKey()===e.getKey()}}],[{key:"calcDirection",value:function(e){if(e.parent){var t=e.parent.tile,n=e.tile;return new ae(n[0]-t[0],n[1]-t[1])}return null}}]),n}();function rm(e,t,n){var i=um(e,t),a=um(e,n);if(0===i.length||0===a.length)return lm(t,n);var o=function(e,t,n){var i=[],a=[],o=new om(t,null),r=new om(n,null),l=[r.tile];i.push(o);for(;i.length>0;){var s=i.shift();if(a.push(s),Qg(s.tile,r.tile)){for(var c=[],d=s,h=s,p=s.parent;p;)p.cache.turns!==h.cache.turns&&(c.unshift({a:em(p.tile),b:em(d.tile)}),d=p),h=p,p=p.parent;return c.unshift({a:em(h.tile),b:em(d.tile)}),c}var y,v=nm(s,um(e,s.tile,l)),f=u(v);try{var g=function(){var e=y.value,t=new om(e,s);if(t.cache.turns>8)return 0;var n=Qg(t.tile,r.tile),o=a.some((function(e){return e.equals(t)}));if(i.some((function(e){return e.equals(t)}))||o&&!n)return 0;t.g=s.g+1+t.cache.turns,t.h=sm(t,r),t.f=t.g+t.h,i.push(t)};for(f.s();!(y=f.n()).done;)g()}catch(e){f.e(e)}finally{f.f()}i.sort((function(e,t){return e.f-t.f}))}return null}(e,t,n);return o||lm(t,n)}function lm(e,t){var n=em(e),i=em(t);return n.x===i.x||n.y===i.y?[{a:n,b:i}]:[{a:n,b:{x:n.x,y:i.y}},{a:{x:n.x,y:i.y},b:i}]}function sm(e,t){var n=e.tile,i=t.tile;return Math.abs(n[0]-i[0])+Math.abs(n[1]-i[1])}function um(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[],o=u(am);try{var r=function(){var o=n.value,r={x:t[0]+o.x,y:t[1]+o.y};if(e.isInBounds(r.x,r.y))return(e.get(r.x,r.y).isHidden()||Zg.search(i,(function(e){return Qg(e,[r.x,r.y])})))&&a.push(o),1;tm(r,e)&&a.push(o)};for(o.s();!(n=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}return a}S._RF.pop(),S._RF.push({},"b622ea7Aw5LT5yfRAx8qSap","getErrorPath",void 0),S._RF.pop(),S._RF.push({},"716f6/ILpZCPp1nebbdk8Oj","getGridFen",void 0);var cm=(m(im={},ot.bomb,"b"),m(im,ot.star,"s"),m(im,ot.none,"t"),im);function dm(e){return e.reduce((function(e,t,n,i){return t.inSamePositionAs(n,i)||e.push([t,[n,i]]),e}),[])}function*hm(e,t){for(var n=0,i=e-1,a=0,o=t-1;n<=i&&a<=o;){for(var r=n;r<=i;r++)yield{x:r,y:a};for(var l=++a;l<=o;l++)yield{x:i,y:l};for(var s=--i;s>=n;s--)yield{x:s,y:o};for(var u=--o;u>=a;u--)yield{x:n,y:u};n++}}S._RF.pop(),S._RF.push({},"badfeEqwgFEorJVHO9tJSXZ","getOutOfSync",void 0),S._RF.pop(),S._RF.push({},"cd0d548/WxD7KCyW2hwySVO","traverseSpiralIn",void 0),S._RF.pop(),S._RF.push({},"373ceVkYCtMTrQObvzJgg7s","getValidPath",void 0);var pm,ym,vm,fm,gm,mm,bm,wm,Sm,km,Cm,Em,Am=Ludex.Utils.Array,Tm=function(){function n(e,i){t(this,n),this.coord=new ae(e,i)}return e(n,[{key:"isHidden",value:function(){return!0}},{key:"isSimilarTo",value:function(){return!1}}]),n}();function Pm(e){return new ae(e[0],e[1])}function Om(e,t,n){if(void 0===t||void 0===n)return function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hm,i=[],a=u(n(e.width,e.height));try{for(a.s();!(t=a.n()).done;){var o=t.value,r=e.get(o.x,o.y);r.isHidden()||i.push([r,[o.x,o.y]])}}catch(e){a.e(e)}finally{a.f()}var l,s=[],c=function(){var t=i.shift(),n=v(t,2),a=n[0],o=n[1];if(Am.search(s,(function(e){return Rm(e,o)})))return 0;s.push(o);for(var r,l=function(){var t=v(c[u],2),n=t[0],i=t[1];if(!n.isSimilarTo(a)||Am.search(s,(function(e){return Rm(e,i)})))return 0;var r=Om(e,o,i);return null!==r?{v:{v:r}}:void 0},u=0,c=i;u<c.length;u++)if(0!==(r=l())&&r)return r.v};for(;i.length>0;)if(0!==(l=c())&&l)return l.v;return null}(e);var i,a=[t[0]+1,t[1]+1],o=[n[0]+1,n[1]+1],r=function(e){var t=Am.fillWith(e.width+2,(function(e){return new Tm(e-1,-1)})),n=Am.fillWith(e.width+2,(function(t){return new Tm(t-1,e.height)})),i=Am.fillWith(e.height,(function(e){return new Tm(-1,e)})),a=Am.fillWith(e.height,(function(t){return new Tm(e.width,t)})),o=function(o,r){var l=o-1,s=r-1;return-1===l?i[s]:l===e.width?a[s]:-1===s?t[l]:s===e.height?n[l]:e.get(l,s)};return{get:function(e,t){return o(e,t)},width:e.width+2,height:e.height+2}}(e),l=[a,o];if(a[0]===o[0]&&Dm(r,l,a[1],o[1],a[0])||a[1]===o[1]&&Mm(r,l,a[0],o[0],a[1]))return Fm([{a:Pm(a),b:Pm(o)}],{x:-1,y:-1});var s=a[1]<=o[1]?a:o,c=a[1]<=o[1]?o:a,d=a[0]<=o[0]?a:o,h=a[0]<=o[0]?o:a,p=[],y=[],f=Nm(r,l,1,Pm(s),Pm(c)),g=Nm(r,l,-1,Pm(s),Pm(c));-1===f&&-1===g||(i=-1!==f?f:g,p=[{a:Pm(a),b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:{x:o[0],y:i}},{a:{x:o[0],y:i},b:Pm(o)}]);var m=Bm(r,l,1,Pm(d),Pm(h)),b=Bm(r,l,-1,Pm(d),Pm(h));-1===m&&-1===b||(i=-1!==m?m:b,p=[{a:Pm(a),b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:{x:i,y:o[1]}},{a:{x:i,y:o[1]},b:Pm(o)}]);var w=function(e,t,n,i){for(var a=n.y+1;a<i.y;a++)if(Dm(e,t,n.y,a,n.x)&&Mm(e,t,n.x,i.x,a)&&Dm(e,t,a,i.y,i.x))return a;return-1}(r,l,Pm(s),Pm(c));-1!==w&&(i=w,y=[{a:Pm(a),b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:{x:o[0],y:i}},{a:{x:o[0],y:i},b:Pm(o)}]);var S=function(e,t,n,i){for(var a=n.x+1;a<i.x;a++)if(Mm(e,t,n.x,a,n.y)&&Dm(e,t,n.y,i.y,a)&&Mm(e,t,a,i.x,i.y))return a;return-1}(r,l,Pm(d),Pm(h));return-1!==S&&(i=S,y=[{a:Pm(a),b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:{x:i,y:o[1]}},{a:{x:i,y:o[1]},b:Pm(o)}]),p.length>0&&y.length>0?Fm(Lm(p)<=Lm(y)?p:y,{x:-1,y:-1}):p.length>0?Fm(p,{x:-1,y:-1}):y.length>0?Fm(y,{x:-1,y:-1}):null}function Lm(e){var t,n=0,i=u(e);try{for(i.s();!(t=i.n()).done;){n+=Im(t.value)}}catch(e){i.e(e)}finally{i.f()}return n}function Im(e){return e.a.x===e.b.x?Math.abs(e.a.y-e.b.y):e.a.y===e.b.y?Math.abs(e.a.x-e.b.x):0}function Rm(e,t){return e[0]===t[0]&&e[1]===t[1]}function _m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.get.apply(e,g(t));return i.isHidden()||n.some((function(e){return Rm(e,t)}))}function Dm(e,t,n,i,a){for(var o=Math.min(n,i),r=Math.max(n,i),l=o;l<=r;l++)if(!_m(e,[a,l],t))return!1;return!0}function Mm(e,t,n,i,a){for(var o=Math.min(n,i),r=Math.max(n,i),l=o;l<=r;l++)if(!_m(e,[l,a],t))return!1;return!0}function Nm(e,t,n,i,a){var o=1===n?a.y:i.y,r=1===n?i.x:a.x;if(Dm(e,t,i.y,a.y,r))for(;o>=0&&o<e.height&&_m(e,[i.x,o],t)&&_m(e,[a.x,o],t);){if(Mm(e,t,i.x,a.x,o))return o;o+=n}return-1}function Bm(e,t,n,i,a){var o=1===n?a.x:i.x,r=1===n?i.y:a.y;if(Mm(e,t,i.x,a.x,r))for(;o>=0&&o<e.width&&_m(e,[o,i.y],t)&&_m(e,[o,a.y],t);){if(Dm(e,t,i.y,a.y,o))return o;o+=n}return-1}function Fm(e,t){return e.map((function(e){return{a:{x:e.a.x+t.x,y:e.a.y+t.y},b:{x:e.b.x+t.x,y:e.b.y+t.y}}}))}S._RF.pop(),S._RF.push({},"0cceagmIDZNoZTxP8hBPplh","Board",void 0);var xm=C.ccclass,zm=C.property,Um=C.requireComponent,Gm=codex.monitorError,Hm=Ludex.Utils,qm=Hm.Array,Vm=Hm.Function,$m=Hm.Valid,Wm=Ke.Layout,Km=(pm=xm("Board"),ym=Um(P),vm=Yn.required(),fm=zm(kg),gm=Yn.required(),mm=zm(q),bm=zm({displayName:"Tile Spacing",group:"Create config"}),pm(wm=ym((km=a((Sm=function(a){n(y,a);var s,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"tilePrefab",km,l(e)),r(e,"tilesHolder",Cm,l(e)),r(e,"tileTrim",Em,l(e)),e.tileSize=[0,0],e.selectedTile=null,e.isPlayingEffect=!1,e.useRotatedGameplay=!1,e.dirtyGameplayRotation=!1,e.parsedGravityRules=[],e.normalMatches=0,e.normalMatchesSinceLastSpawn=0,e.spawnAttempts=0,e.hintPath=null,e.hintTiles=null,e.isAnimating=!1,e.animationQueue=[],e.isConsumingAnimation=!1,e.handleViewResized=Vm.debounce((function(){if(!e.isPlayingEffect&&(e.updateTilesHolderScale(),e.levelData)){var t=e.shouldRotate(e.levelData);e.dirtyGameplayRotation=e.useRotatedGameplay!==t,e.dirtyGameplayRotation&&e.consumeAnimationQueue()}}),100),e}return e(y,[{key:"onLoad",value:function(){this.widget=this.getComponent(I),this.uiTransform=this.getComponent(P),Yn.validateRequiredProperties(this,y),this.tilePrefab.node.active=!1,this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"shouldRotate",value:function(e){return 0!==e.level&&e.rows>e.columns!==this.uiTransform.height>this.uiTransform.width}},{key:"create",value:(h=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();this.levelData=t,this.handleOrientationChanged(Ze.getCurrentLayout()),yield Ve.waitTweenAsync(0);var a=e.then((function(e){var n=g(e);qm.shuffle(n);var i=n.slice(0,t.colors);return null==Gm||Gm.addMetadata({frames:i.map((function(e){return e.name}))}),i})),o=qm.fillWith(t.colors,(function(e){return e}));this.useRotatedGameplay=this.shouldRotate(t)&&0!==this.levelData.level,this.parsedGravityRules=Ag(t.mode);var r=function(e){var t=ye(n.tilePrefab.node),i=t.getComponent(kg);return i.setIdentity(e,a),n.tilesHolder.addChild(t),t.active=!0,i},l=!1;if(void 0!==t.customFen)try{l=!0,this.grid=Wg({customFen:t.customFen,identities:o,createTile:r}),this.useRotatedGameplay&&(this.grid=jg(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)}))}catch(e){console.error("Error creating grid from custom fen",e,"falling back to random grid"),l=!1}l||(this.grid=Hg({levelData:t,seed:i,identities:o,createTile:r,setTileIdentity:function(e,t){return e.setIdentity(t,a)}}),this.useRotatedGameplay&&(this.grid=jg(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)})),Xg({grid:this.grid,setIdentity:function(e,t){return e.setIdentity(t,a)},seed:i}),Ug(this.grid,t,i));var s=[this.tileTrim.x,this.tileTrim.y];this.tileSize=Eg(this.tilePrefab.getSize(),s),this.updateTilesHolderScale(),this.node.scene.emit(Es.GRID_CREATE,this),this.selectedTile=null,this.animationQueue=[],this.normalMatches=0,this.normalMatchesSinceLastSpawn=0,this.spawnAttempts=0,this.hintPath=null,this.processGameplayCycle()})),function(e,t){return h.apply(this,arguments)})},{key:"updateTilesHolderScale",value:function(){if(this.grid){var e=[this.grid.width,this.grid.height],t=[this.uiTransform.width,this.uiTransform.height],n=function(e,t,n){var i=v(e,2),a=i[0],o=i[1],r=v(t,2),l=r[0],s=r[1],u=v(n,2),c=u[0]/(a*l),d=u[1]/(o*s);return Math.min(Math.min(c,d),2.25)}(e,this.tilePrefab.getSize(),t);this.tilesHolder.setScale(n,n),this.node.scene.emit(Es.GRID_RESIZE,n)}}},{key:"destroyTiles",value:function(){var e;null===(e=this.grid)||void 0===e||e.each((function(e){return e.node.destroy()}))}},{key:"animateTilesAppear",value:function(){var e=this;if(!this.grid){var t=new Error("animateTilesAppear: Grid is not initialized");if($m.isDebugger())throw t;return null==Gm||Gm.sendException(t),Promise.resolve()}var n=this.grid;return new Promise((function(t){var i=function(){var i=o((function*(){var i=function(t){return Cg(n,e.tileSize,t)};yield Promise.all(n.map((function(t,a,o){var r=he(0,.5),l=t.node.scale.clone(),s=function(t,n){var i,a=ae.ZERO.clone(),o=u(e.parsedGravityRules);try{for(o.s();!(i=o.n()).done;){var r=i.value,l=e.useRotatedGameplay?Tg(r):r,s=e.getPrimitiveDirection(t,n,l);a.subtract2f(s.x,s.y)}}catch(e){o.e(e)}finally{o.f()}return a.normalize()}(a,o),c=Cg(n,e.tileSize,{x:a,y:o}),d=s.multiplyScalar(100).add2f(c.x,c.y);return t.node.setPosition(d.x,d.y),t.node.setScale(0,0),Promise.all([Ve.runTweenAsync(R(t.node).delay(r).to(.5,{scale:l},{easing:"elasticOut"})),t.sync({getTargetPosition:i,easing:"backOut",duration:.5,delay:r})])}))),t()}));return function(){return i.apply(this,arguments)}}();e.animationQueue.push(i),e.consumeAnimationQueue()}))}},{key:"animateTilesWave",value:function(){var e=this;if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesWave"),Promise.resolve();var t=this.grid;return new Promise((function(n){var i=function(){var e=o((function*(){var e=function(e,t){for(var n=t.x,i=t.y,a="center"===e?{x:(n-1)/2,y:(i-1)/2}:e,o=a.x,r=a.y,l=[],s=0;s<n;s++){for(var u=[],c=0;c<i;c++){var d=o-s,h=r-c,p=Math.sqrt(d*d+h*h);u.push(p)}l.push(u)}return l}("center",{x:t.width,y:t.height});yield Promise.all(t.map((function(t,n,i){var a,o,r=.1*(null!==(a=null===(o=e[n])||void 0===o?void 0:o[i])&&void 0!==a?a:0),l=t.node.scale.clone();return Promise.all([Ve.runTweenAsync(R(t.node).delay(r).to(.25,{scale:l.clone().multiplyScalar(1.2)},{easing:"quadOut"}).to(.25,{scale:l},{easing:"quadIn"}))])}))),n()}));return function(){return e.apply(this,arguments)}}();e.animationQueue.push(i),e.consumeAnimationQueue()}))}},{key:"animateTilesError",value:(d=o((function*(e){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesError"),Promise.resolve();this.isAnimating||(this.isAnimating=!0,yield Promise.all(e.map((function(e){return e.moveAround()}))),this.isAnimating=!1)})),function(e){return d.apply(this,arguments)})},{key:"handleTileClick",value:function(e){if(!e.isHidden()){if(this.selectedTile===e)return je.playSound(Qi.TILE_SELECT),this.selectedTile=null,void e.setFocused(!1);if(!this.selectedTile)return je.playSound(Qi.TILE_SELECT),this.selectedTile=e,void e.setFocused(!0);if(!this.selectedTile.isSimilarTo(e))return je.playSound(Qi.TILE_SELECT),this.selectedTile.setFocused(!1),this.selectedTile=e,void e.setFocused(!0);this.selectedTile.setFocused(!1),this.match(this.selectedTile,e),this.selectedTile=null}}},{key:"clearSelectedTile",value:function(){this.selectedTile&&(this.selectedTile.setFocused(!1),this.selectedTile=null)}},{key:"match",value:function(e,t){if(this.grid&&this.levelData){var n=[e.getCoord().x,e.getCoord().y],i=[t.getCoord().x,t.getCoord().y],a=Om(this.grid,n,i);if(null===a){je.playSound(Qi.INVALID_MATCH),this.animateTilesError([e,t]);var o=0===this.levelData.level,r=function(e,t,n,i){if(i){var a=Jg[4].startTile,o=Jg[4].endTile;if(t[0]===a.x&&t[1]===a.y&&n[0]===o.x&&n[1]===o.y)return[{a:a,b:o}];if(t[0]===o.x&&t[1]===o.y&&n[0]===a.x&&n[1]===a.y)return[{a:a,b:o}]}return rm(e,t,n)}(this.grid,n,i,o);return this.node.scene.emit(Es.GRID_MATCH,[e,t]),void this.node.scene.emit(Es.GRID_MATCH_FAIL,r)}je.playSound(Qi.TILE_MATCH),this.node.scene.emit(Es.GRID_MATCH,[e,t]),this.node.scene.emit(Es.GRID_MATCH_SUCCESS,a,[e,t]),this.clear({pairs:[[e,t]]})}else this.reportOrThrowInDebugger("Grid is not initialized","match")}},{key:"clear",value:function(e){var t=this,n=e.pairs,i=e.stagger,a=void 0===i?0:i,o=e.delay,r=void 0===o?0:o,l=e.lightning,s=void 0!==l&&l;this.normalMatches+=n.length;for(var u=0;u<n.length;u++){var c=n[u],d=v(c,2),h=d[0],p=d[1],y=a?2*u*a:0,f=a?(2*u+1)*a:0;h.setEmpty(),p.setEmpty(),h.playClearFX(y,s),p.playClearFX(f,s),this.node.scene.emit(Es.GRID_CLEAR,[h,p])}Ve.waitTweenAsync(r).then((function(){t.processGameplayCycle()}))}},{key:"clearUsingOldLightningFX",value:function(e){this.normalMatches+=e.length;var t,n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=v(i,2),o=a[0],r=a[1];o.setEmpty(),r.setEmpty(),o.playOldLightningClearFX(),r.playOldLightningClearFX(),this.node.scene.emit(Es.GRID_CLEAR,[o,r])}}catch(e){n.e(e)}finally{n.f()}this.processGameplayCycle()}},{key:"showHint",value:function(){if(this.hintPath){var e=this.hintPath[0],t=this.hintPath[this.hintPath.length-1];if(e&&t){var n=e.a,i=t.b,a=this.getTileAt(n.x,n.y),o=this.getTileAt(i.x,i.y);a&&o?(a.setHint(!0),o.setHint(!0),this.hintTiles=[a,o]):this.reportOrThrowInDebugger("Hint tiles are not valid","showHint")}else this.reportOrThrowInDebugger("Hint path is not valid","showHint")}}},{key:"hideHint",value:function(){if(this.hintTiles){var e=v(this.hintTiles,2),t=e[0],n=e[1];t.setHint(!1),n.setHint(!1),this.hintTiles=null}}},{key:"getHintPath",value:function(){return this.hintPath}},{key:"getTileAt",value:function(e,t){return this.grid&&this.grid.isInBounds(e,t)?this.grid.get(e,t):null}},{key:"getAnyTileWorldPosition",value:function(e,t){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getAnyTileWorldPosition"),{x:0,y:0};var n=Cg(this.grid,this.tileSize,{x:e,y:t});this.tilePrefab.node.setPosition(n.x,n.y);var i=this.tilePrefab.node.getWorldPosition();return{x:i.x,y:i.y}}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getGridSize",value:function(){return this.grid?[this.grid.width,this.grid.height]:(this.reportOrThrowInDebugger("Grid is not initialized","getGridSize"),[0,0])}},{key:"getUncleared",value:function(){return this.grid?Og(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getUncleared"),[])}},{key:"getCleared",value:function(){return this.grid?Lg(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getCleared"),[])}},{key:"getBombTiles",value:function(){return this.grid?Og((e=this.grid)instanceof vg?e.asArray():e).filter((function(e){var t;return(null===(t=e.special)||void 0===t?void 0:t.type)===ot.bomb})):(this.reportOrThrowInDebugger("Grid is not initialized","getBombTiles"),[]);var e}},{key:"getPairs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPairs"),[];for(var n=[],i=t?Og(this.grid):Lg(this.grid),a=function(){var e=Mg(i),t=v(e,2),a=t[0],o=t[1];n.push([a,o]),i=i.filter((function(e){return e!==a&&e!==o}))};n.length<e;)a();return n}},{key:"getBoundingBoxWorld",value:function(){var e=this.tilesHolder.getWorldScale().x,t=this.getGridSize(),n=this.tileSize[0]*e*t[0],i=this.tileSize[1]*e*t[1],a=this.node.getWorldPosition().subtract3f(n/2,i/2,0);return new te.Rect(a.x,a.y,n,i)}},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this.grid)||void 0===e||e.each((function(e){return e.setIgnoreInput(t)}))}},{key:"processShuffleRequest",value:function(e){if(this.grid){var t=this.processShuffleStep(this.grid,!0,e);this.grid=t[0],this.hintPath=t[1],this.consumeAnimationQueue()}else this.reportOrThrowInDebugger("Grid is not initialized","processShuffleRequest")}},{key:"generateFenFromCurrentLevel",value:function(e){var t;return this.levelData||this.reportOrThrowInDebugger("Level data is not initialized","generateFenFromCurrentLevel"),y.generateFen(null!==(t=null!=e?e:this.levelData)&&void 0!==t?t:Vv)}},{key:"listenEvents",value:function(){D.on($e.VIEW_RESIZED,this.handleViewResized),D.on($e.WIDGET_RESIZED,this.handleViewResized),D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.on(Es.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.on(Es.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"unlistenEvents",value:function(){D.off($e.VIEW_RESIZED,this.handleViewResized),D.off($e.WIDGET_RESIZED,this.handleViewResized),D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.off(Es.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.off(Es.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"onEffectAnimStarted",value:function(){this.isPlayingEffect=!0}},{key:"onEffectAnimEnded",value:function(){this.isPlayingEffect=!1,this.handleOrientationChanged(Ze.getCurrentLayout()),this.handleViewResized()}},{key:"getWidgetMargins",value:function(e){return e!==Wm.Landscape||void 0!==this.levelData&&0===this.levelData.level?{top:160,bottom:160,left:20,right:20}:{top:80,bottom:80,left:640,right:60}}},{key:"handleOrientationChanged",value:function(e){if(!this.isPlayingEffect){var t=this.getWidgetMargins(e),n=t.top,i=t.bottom,a=t.left,o=t.right;this.widget.top=n,this.widget.bottom=i,this.widget.left=a,this.widget.right=o}}},{key:"processGameplayCycle",value:function(){if(this.node.activeInHierarchy&&this.grid&&this.levelData){var e=Og(this.grid);if(0!==e.length){var t=this.grid,n=e.length>=2&&this.spawnAttempts<this.levelData.rules.addRandomTilesPerMove&&this.normalMatches>=5,i=this.normalMatchesSinceLastSpawn>=2;n&&(i?(this.spawnAttempts++,this.normalMatchesSinceLastSpawn=0,this.processSpawnStep()):this.normalMatchesSinceLastSpawn++),e.length%2==1&&this.processSpawnSingleTileStep(),e.length>14&&(t=this.processGravitationStep(t));var a=this.processShuffleStep(t);this.consumeAnimationQueue(),this.grid=a[0],this.hintPath=a[1]}}else this.reportOrThrowInDebugger("Grid is not initialized","processGameplayCycle")}},{key:"processSpawnStep",value:function(){var e,t;if(this.grid){var n=xg(Lg(this.grid),2),i=v(n,2),a=i[0],o=i[1],r=null!==(e=null==a?void 0:a.id)&&void 0!==e?e:void 0,l=null!==(t=null==a?void 0:a.frames)&&void 0!==t?t:void 0;void 0!==a&&void 0!==r&&void 0!==l&&void 0!==o?(a.restore(),o.restore(r,l),this.node.scene.emit(Es.GRID_SPAWN,[a,o])):this.reportOrThrowInDebugger("Failed to get random tiles","processSpawnStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnStep")}},{key:"processGravitationStep",value:function(e){var t,n=this,i=e,a=[],r=u(this.parsedGravityRules);try{var l=function(){var e=t.value,r=n.useRotatedGameplay?Tg(e):e,l=dm(i=n.toGravitated(i,r));if(0===l.length)return 1;var s,c=u(l);try{for(c.s();!(s=c.n()).done;){var d=v(s.value,2),h=d[0],p=v(d[1],2),y=p[0],f=p[1];h.setCoord(y,f)}}catch(e){c.e(e)}finally{c.f()}i.each((function(e){e.node.setSiblingIndex(0)}));var g=function(){var e=o((function*(){yield Promise.all(l.map((function(e){var t=v(e,2),a=t[0],o=v(t[1],2),r=o[0],l=o[1];return a.sync({delay:.25,duration:.25,getTargetPosition:function(){return Cg(i,n.tileSize,{x:r,y:l})}})})))}));return function(){return e.apply(this,arguments)}}();a.push(g)};for(r.s();!(t=r.n()).done;)l()}catch(e){r.e(e)}finally{r.f()}var s=function(){var e=o((function*(){for(var e=0,t=a;e<t.length;e++){var n=t[e];yield n()}}));return function(){return e.apply(this,arguments)}}();return this.animationQueue.push(s),i}},{key:"toGravitated",value:function(e,t){var n=new vg(e),i=e.height-1,a=e.width-1,o=[0,i],r=[0,a],l=Math.floor(e.height/2),s=Math.floor(e.width/2),u=function(e){return e.isHidden()};switch(t){case cv:n.gravitate({rowRange:o,colRange:r,direction:uv.Down,isLighter:u});break;case dv:n.gravitate({rowRange:o,colRange:r,direction:uv.Up,isLighter:u});break;case hv:n.gravitate({rowRange:o,colRange:r,direction:uv.Left,isLighter:u});break;case pv:n.gravitate({rowRange:o,colRange:r,direction:uv.Right,isLighter:u});break;case yv:n.gravitate({rowRange:o,colRange:[s,a],direction:uv.Left,isLighter:u,out:n.gravitate({rowRange:o,colRange:[0,s-1],direction:uv.Right,isLighter:u})});break;case vv:n.gravitate({rowRange:[l,i],colRange:r,direction:uv.Down,isLighter:u,out:n.gravitate({rowRange:[0,l-1],colRange:r,direction:uv.Up,isLighter:u})})}return n}},{key:"getPrimitiveDirection",value:function(e,t,n){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPrimitiveDirection"),uv.Down;var i=Math.floor(this.grid.height/2),a=Math.floor(this.grid.width/2);switch(n){case cv:return uv.Down;case dv:return uv.Up;case hv:return uv.Left;case pv:return uv.Right;case yv:return e>=a?uv.Left:uv.Right;case vv:return t>=i?uv.Down:uv.Up}}},{key:"processShuffleStep",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,o=Om(e),r=Og(e).map((function(e){var t=e.getCoord();return[t.x,t.y]}));if(null!==o&&!i)return[e,o];var l=100;do{var s=e.toShuffled(r),c=v(s,1);o=Om(n=c[0]),l--}while(null===o&&l>0);if(l<=0){var d,h,p,y,f=n.asArray().map((function(e){var t;return{name:e.id,type:null===(t=e.special)||void 0===t?void 0:t.type,active:!e.isHidden()}}));return null==Gm||Gm.sendException(new Error("No paths found after 100 shuffle attempts"),{message:"No paths found after 100 shuffle attempts",level:null===(d=this.levelData)||void 0===d?void 0:d.level,rules:null===(h=this.levelData)||void 0===h?void 0:h.rules,mode:null===(p=this.levelData)||void 0===p?void 0:p.mode,gridAsArray:f}),this.node.scene.emit(Es.GAME_EXIT),[e,null!==(y=o)&&void 0!==y?y:[]]}var g,m=dm(n),b=u(m);try{for(b.s();!(g=b.n()).done;){var w=v(g.value,2),S=w[0],k=v(w[1],2),C=k[0],E=k[1];S.setCoord(C,E)}}catch(e){b.e(e)}finally{b.f()}var A=void 0!==a?function(){return a(e,n)}:this.createShuffleAnimationHandler(e,n);return this.animationQueue.push(A),[n,null!==(t=o)&&void 0!==t?t:[]]}},{key:"createShuffleAnimationHandler",value:function(e,t){var n=this,i=function(){var i=o((function*(){yield Promise.all(e.map((function(e,i,a){return e.sync({duration:.3,easing:"smooth",getTargetPosition:function(){return Cg(t,n.tileSize,{x:i,y:a},10)}})})))}));return function(){return i.apply(this,arguments)}}(),a=function(){var e=o((function*(){t.each((function(e){e.node.setSiblingIndex(0)})),yield Promise.all(t.map((function(e){return e.sync({duration:.4,easing:"smooth",delay:he(0,.2),getTargetPosition:function(e){return Cg(t,n.tileSize,e)}})})))}));return function(){return e.apply(this,arguments)}}();return function(){var e=o((function*(){yield i(),yield a()}));return function(){return e.apply(this,arguments)}}()}},{key:"processSpawnSingleTileStep",value:function(){if(this.grid){var e,t=xg(Lg(this.grid),1),n=v(t,1)[0],i=Og(this.grid),a={},o=u(i);try{for(o.s();!(e=o.n()).done;){var r,l=e.value.id;null!==l&&(a[l]=(null!==(r=a[l])&&void 0!==r?r:0)+1)}}catch(e){o.e(e)}finally{o.f()}var s=qm.search(i,(function(e){var t=e.id;if(null===t)return!1;var n=a[t];return void 0!==n&&n%2==1}));n&&s&&null!==s.id?(n.restore(s.id,s.frames),this.node.scene.emit(Es.GRID_SPAWN,[n])):this.reportOrThrowInDebugger("Failed to get a random tile","processSpawnSingleTileStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnSingleTileStep")}},{key:"consumeAnimationQueue",value:(c=o((function*(){if(!this.isConsumingAnimation){for(this.isConsumingAnimation=!0;this.animationQueue.length>0;){if(0===this.getUncleared().length){this.animationQueue=[];break}var e=this.animationQueue.shift();yield null==e?void 0:e()}for(;this.dirtyGameplayRotation&&void 0!==this.levelData;)this.dirtyGameplayRotation=!1,this.shouldRotate(this.levelData)!==this.useRotatedGameplay&&(yield this.updateGameplayRotation());this.isConsumingAnimation=!1}})),function(){return c.apply(this,arguments)})},{key:"updateGameplayRotation",value:(s=o((function*(){var e=this;if(this.levelData){var t=this.shouldRotate(this.levelData),n=this.useRotatedGameplay&&!t;if(this.useRotatedGameplay=t,this.grid&&this.levelData&&this.hintPath){this.node.scene.emit(Es.GRID_ORIENTATION_CHANGE,this.useRotatedGameplay),this.hintPath=function(e,t,n){var i,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],r=u(n);try{for(r.s();!(i=r.n()).done;){var l=i.value,s=l.a,c=l.b,d=Pg(s,e,t,a),h=Pg(c,e,t,a);o.push({a:d,b:h})}}catch(e){r.e(e)}finally{r.f()}return o}(this.grid.width,this.grid.height,this.hintPath,n),this.setIgnoreInput(!0);var i=jg(this.grid,n);this.grid=i,this.updateTilesHolderScale(),yield Promise.all(i.map((function(t){return t.sync({delay:.3,duration:.3,easing:"quartInOut",getTargetPosition:function(){return Cg(i,e.tileSize,t.getCoord(),10)}})}))),i.each((function(e){e.node.setSiblingIndex(0)})),yield Promise.all(i.map((function(t){return t.sync({duration:.2,easing:"sineInOut",getTargetPosition:function(){return Cg(i,e.tileSize,t.getCoord())}})}))),this.setIgnoreInput(!1)}}})),function(){return s.apply(this,arguments)})},{key:"clearAnimationQueue",value:function(){this.isConsumingAnimation=!1,this.animationQueue=[]}},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if($m.isDebugger())throw n;null==Gm||Gm.sendException(n)}}],[{key:"generateFen",value:function(e){for(var t=e,n=[],i=0;i<t.colors;i++)n.push(i+1);var a=Date.now(),o=Hg({levelData:t,seed:a,identities:n,setTileIdentity:function(e,t){return e.setIdentity(t)},createTile:function(e){var t=e,n=void 0,i=new ae(0,0);return{get id(){return t},get special(){return n},get coord(){return i},setIdentity:function(e){t=e},isHidden:function(){return!1},setSpecialType:function(e){n={type:e}},setCoord:function(e,t){return i.set(e,t)},getCoord:function(){return i},isSimilarTo:function(e){return e.id===t},inSamePositionAs:function(e){return e.getCoord().equals(i)}}}});return o.each((function(e,t,n){e.setCoord(t,n)})),Xg({grid:o,seed:a,setIdentity:function(e,t){return e.setIdentity(t)}}),Ug(o,t,a),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cm,n=e.width,i=e.height,a=[],o=new Map,r=i-1;r>=0;r--){for(var l=[],s=0;s<n;s++){var u,c,d=e.get(s,r),h=d.isHidden()?null:d.id;if(null!==h){var p=t[null!==(u=null===(c=d.special)||void 0===c?void 0:c.type)&&void 0!==u?u:ot.none];if(!o.has(h)){var y=o.size.toString();o.set(h,y)}var v="".concat(p).concat(o.get(h));l.push(v)}else l.push(".")}a.push(l.join(""))}return{code:a.join(":"),idSize:o.size,encoding:t,rows:i,cols:n}}(o)}}]),y}(T)).prototype,"tilePrefab",[vm,fm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cm=a(Sm.prototype,"tilesHolder",[gm,mm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Em=a(Sm.prototype,"tileTrim",[bm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ae(.025,.1)}}),wm=Sm))||wm)||wm);S._RF.pop(),S._RF.push({},"f7e1byg/txJGqnuJJ7xQV1M","withItemAnalytics",void 0);var jm=Ludex.Plugins.Analytics,Ym=(void 0===jm?{}:jm).Events,Xm=codex.analytics,Jm=function(e,t){return function(){return Ym&&Xm.event(Ym.USE_ITEM,{item_name:e}),t.apply(void 0,arguments)}};S._RF.pop(),S._RF.push({},"bc704Yz8bdJzYja7TsWcGMN","useHintItem",void 0);var Zm=Jm(nt.PLIERS,(function(e,t){if(!t.isDrawingHint){var n=e.getHintPath();null!==n&&(je.playSound(Qi.HINT_ITEM),t.drawHintPath(n,(function(t){return e.getAnyTileWorldPosition(t.x,t.y)})),e.showHint())}}));S._RF.pop(),S._RF.push({},"0a2423JE25HLIm5td77YE7e","usePliersItem",void 0);var Qm=Jm(nt.PLIERS,(function(e,t){var n,i=_g(e.getBombTiles()),a=i.node.worldPosition;t.createDefuseExplosionAt(a.x,a.y),je.playSound(Qi.BOMB_DEFUSE),null===(n=i.special)||void 0===n||n.switch(ot.none)}));S._RF.pop(),S._RF.push({},"004c93sHsBHnpww25v/ilqP","withBlockedInput",void 0);S._RF.pop(),S._RF.push({},"33523Q0FqxMp6H+SNCi8//7","withCenteredBoard",void 0);var eb=function(e,t){return o((function*(){var n=e.widget,i=n.left,a=n.right,o=(i+a)/2;yield Ve.runTweenAsync(R(e.widget).to(.2,{left:o,right:o},{easing:"cubicOut"}));var r=yield t.apply(void 0,arguments),l=e.getWidgetMargins(Ze.getCurrentLayout()),s=l.top,u=l.bottom,c=l.left,d=l.right;return yield Ve.runTweenAsync(R(e.widget).to(.2,{top:s,bottom:u,left:c,right:d},{easing:"cubicOut"})),r}))};S._RF.pop(),S._RF.push({},"975e3Ao0kxHW6RlBkPl5kbh","withEffectAnimationEvents",void 0);var tb=function(e,t){return o((function*(){e.node.scene.emit(Es.EFFECTS_ANIMATION_START);var n=yield t.apply(void 0,arguments);return e.node.scene.emit(Es.EFFECTS_ANIMATION_END),n}))};S._RF.pop(),S._RF.push({},"d2cd0VZLwhNMJwc3ppHvOtA","withLoweredVolume",void 0);var nb=function(e){return o((function*(){je.setVolumeMusic(0,!0);var t=yield e.apply(void 0,arguments);return je.setVolumeMusic(.3,!0),t}))};S._RF.pop(),S._RF.push({},"a62ebriH15FfI8l0x1GBX1p","useThunderItem",void 0);var ib,ab=function(){var e=o((function*(e,t){if(!(e.getUncleared().length<4)){var n=e.getPairs(2),i=tb(e,eb(e,rb));e.clearSelectedTile(),yield i(t,n,e)}}));return function(t,n){return e.apply(this,arguments)}}(),ob=Jm(nt.THUNDER,nb((ib=ab,o((function*(){rt.setBlockInput(!0);var e=yield ib.apply(void 0,arguments);return rt.setBlockInput(!1),e})))));function rb(e,t,n){return e.playThunderAnimation(t,n)}S._RF.pop(),S._RF.push({},"0e50bRTLUtMgYDDkS0nbFm5","useTornadoItem",void 0);var lb,sb=Ludex.Utils.Function,ub=function(){var e=o((function*(e,t){var n=yield sb.allSettled(e.map((function(n,i,a){return n.sync({duration:.4,easing:"smooth",getTargetPosition:function(){return Cg(e,t,{x:i,y:a},10)}})})));n.some((function(e){return"rejected"===e.status}))&&console.error("Error playing padding animation",n.filter((function(e){return"rejected"===e.status})))}));return function(t,n){return e.apply(this,arguments)}}(),cb=function(){var e=o((function*(e,t){var n=e.asArray().length;e.each((function(t,i,a){t.node.setSiblingIndex(n-1-(i+a*e.width))}));var i=yield sb.allSettled(e.map((function(n){return n.fly({getTilePosition:function(n){return Cg(e,t,n)}})})));i.some((function(e){return"rejected"===e.status}))&&console.error("Error playing shuffle animation",i.filter((function(e){return"rejected"===e.status})))}));return function(t,n){return e.apply(this,arguments)}}(),db=function(){var e=o((function*(e,t,n,i){je.playSound(Qi.SHUFFLE_ITEM),je.playSound(Qi.WIND),yield ub(e,n()),i(),yield cb(t,n())}));return function(t,n,i,a){return e.apply(this,arguments)}}(),hb=function(){var e=o((function*(e,t){var n=function(){return e.getTileSize()},i=function(){return t.playTornadoAnimation()},a=tb(e,eb(e,nb((function(e,t){return db(e,t,n,i)}))));return new Promise((function(t){e.processShuffleRequest(function(){var n=o((function*(n,i){e.clearSelectedTile(),yield a(n,i),t()}));return function(e,t){return n.apply(this,arguments)}}())}))}));return function(t,n){return e.apply(this,arguments)}}(),pb=Jm(nt.THUNDER,nb(hb));S._RF.pop(),S._RF.push({},"c92ec8pmUJGbrL9PLjum+i5","Line",void 0);var yb=(0,C.ccclass)("Line")(lb=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(P)}},{key:"setPoints",value:function(e,t){this.node.setWorldPosition((e.x+t.x)/2,(e.y+t.y)/2,0),this.uiTransform.width=ae.distance(e,t)+10,this.uiTransform.width/=this.node.worldScale.x;var n=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI;this.node.eulerAngles=new V(0,0,n)}}]),r}(T))||lb;S._RF.pop(),S._RF.push({},"1e7cch8i/5DkYHOwJowrjeg","AFPool",void 0);var vb,fb,gb,mb,bb,wb,Sb,kb,Cb,Eb,Ab,Tb=function(a){n(r,a);var o=i(r);function r(e,n,i,a,l){var s;return t(this,r),(s=o.call(this,e,n,l)).ator=i,s.ftor=a,s}return e(r,[{key:"alloc",value:function(){var e=c(d(r.prototype),"alloc",this).call(this);return this.ator&&this.ator(e),e}},{key:"free",value:function(e){this.ftor&&this.ftor(e),c(d(r.prototype),"free",this).call(this,e)}}]),r}(ve);S._RF.pop(),S._RF.push({},"6f7a1msxIxIbYLx5PpbL/BZ","PathDrawer",void 0);var Pb,Ob,Lb,Ib,Rb,_b,Db,Mb,Nb,Bb=C.ccclass,Fb=C.property,xb=(vb=Bb("PathDrawer"),fb=Fb({group:"Line",displayName:"Prefab",type:fe}),gb=Fb({group:"Line",displayName:"Holder",type:q,tooltip:"Line Prefab"}),mb=Fb({group:"Point",displayName:"Prefab",type:fe}),bb=Fb({group:"Point",displayName:"Holder",type:q}),vb((kb=a((Sb=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"linePrefab",kb,l(e)),r(e,"lineHolder",Cb,l(e)),e.lineNodes=[],r(e,"pointPrefab",Eb,l(e)),r(e,"pointHolder",Ab,l(e)),e.pointNodes=[],e}return e(s,[{key:"start",value:function(){var e=this;this.linePool=new Tb((function(){var t=ye(e.linePrefab);return e.lineHolder.addChild(t),t.parent=e.lineHolder,t.active=!1,t}),0,(function(t){e.lineNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()})),this.pointPool=new Tb((function(){var t=ye(e.pointPrefab);return e.pointHolder.addChild(t),t.active=!1,t}),0,(function(t){e.pointNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()}))}},{key:"drawPath",value:function(e){this.clearPath();var t,n=u(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value;null===(i=this.linePool.alloc().getComponent(yb))||void 0===i||i.setPoints(a.a,a.b)}}catch(e){n.e(e)}finally{n.f()}}},{key:"clearPath",value:function(){var e,t=u(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.linePool.free(n)}}catch(e){t.e(e)}finally{t.f()}this.lineNodes=[];var i,a=u(this.pointNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.pointPool.free(o)}}catch(e){a.e(e)}finally{a.f()}this.pointNodes=[]}}]),s}(T)).prototype,"linePrefab",[fb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cb=a(Sb.prototype,"lineHolder",[gb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eb=a(Sb.prototype,"pointPrefab",[mb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ab=a(Sb.prototype,"pointHolder",[bb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wb=Sb))||wb);S._RF.pop(),S._RF.push({},"5cc7bAmTI1JL7nwLzZcp45u","ErrorDrawer",void 0);var zb,Ub,Gb,Hb,qb=C.ccclass,Vb=C.property,$b=(Pb=qb("ErrorDrawer"),Ob=Vb(ue),Lb=Vb(ue),Ib=Vb(ue),Pb((Db=a((_b=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"one",Db,l(e)),r(e,"two",Mb,l(e)),r(e,"error",Nb,l(e)),e}return e(s,[{key:"start",value:function(){c(d(s.prototype),"start",this).call(this),this.pathAppearDuration=0}},{key:"drawPath",value:function(e){var t=this;if(this.clearPath(),e.forEach((function(n,i){var a;if(null===(a=t.linePool.alloc().getComponent(yb))||void 0===a||a.setPoints(n.a,n.b),0!==i){var o=t.pointPool.alloc();o.setWorldPosition(new V(n.a.x,n.a.y,0));var r=o.getComponent(F);1===i&&e.length>3?r.spriteFrame=t.one:2===i&&e.length>3?r.spriteFrame=t.two:r.spriteFrame=t.error}})),1===e.length){var n=this.pointPool.alloc();n.setWorldPosition(new V(e[0].a.x+e[0].b.x,e[0].a.y+e[0].b.y,0).multiplyScalar(.5)),n.getComponent(F).spriteFrame=this.error}this.pathAppearDuration=.8}},{key:"update",value:function(e){this.pathAppearDuration>0&&(this.pathAppearDuration-=e,this.pathAppearDuration<=0&&this.clearPath())}}]),s}(xb)).prototype,"one",[Ob],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mb=a(_b.prototype,"two",[Lb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nb=a(_b.prototype,"error",[Ib],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rb=_b))||Rb);S._RF.pop(),S._RF.push({},"880e8aL9NFPj68zH2xVRIFR","HintDrawer",void 0);var Wb,Kb,jb,Yb,Xb=(zb=(0,C.ccclass)("HintDrawer"),Ub=Yn.onlyRunInLifeCycle,zb((a((Hb=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"drawPath",value:function(e){this.clearPath(),this.createPath(e),this.showPath()}},{key:"createPath",value:function(e){if(0!==e.length){var t=e.length-1;if(!(t<0)){var n=e[t];if(n){var i,a=u(e);try{for(a.s();!(i=a.n()).done;){var o,r=i.value;null===(o=this.linePool.alloc().getComponent(yb))||void 0===o||o.setPoints(r.a,r.b),this.pointPool.alloc().setWorldPosition(r.a.x,r.a.y,0)}}catch(e){a.e(e)}finally{a.f()}this.pointPool.alloc().setWorldPosition(n.b.x,n.b.y,0)}}}}},{key:"showPath",value:function(){var e,t=u(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value.getComponent(B);n.opacity=0,R(n).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){t.e(e)}finally{t.f()}var i,a=u(this.pointNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value.getComponent(B);o.opacity=0,R(o).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){a.e(e)}finally{a.f()}}},{key:"clearPath",value:function(){var e,t=this,n=u(this.lineNodes);try{var i=function(){var n=e.value,i=n.getComponent(B),a=R(i).to(.15,{opacity:0});Ve.runTweenAsync(a).then((function(){t.node.activeInHierarchy&&(i.opacity=255,t.linePool.free(n))}))};for(n.s();!(e=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}var a,o=u(this.pointNodes);try{var r=function(){var e=a.value,n=e.getComponent(B),i=R(n).to(.15,{opacity:0});Ve.runTweenAsync(i).then((function(){t.node.activeInHierarchy&&(n.opacity=255,t.pointPool.free(e))}))};for(o.s();!(a=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}this.lineNodes=[],this.pointNodes=[]}}]),r}(xb)).prototype,"clearPath",[Ub],Object.getOwnPropertyDescriptor(Hb.prototype,"clearPath"),Hb.prototype),Gb=Hb))||Gb);S._RF.pop(),S._RF.push({},"25f67BW5/5Jzox4v+yBBbyS","MatchDrawer",void 0);var Jb,Zb,Qb,ew,tw,nw,iw,aw,ow,rw=(Wb=(0,C.ccclass)("MatchDrawer"),Kb=Yn.onlyRunInLifeCycleAsync,Wb((a((Yb=function(a){n(u,a);var r,l,s=i(u);function u(){return t(this,u),s.apply(this,arguments)}return e(u,[{key:"drawPath",value:function(e){var t=this;if(0!==e.length){var n=e.length-1;if(!(n<0)){var i=e[n];if(i){e.forEach((function(e,n){var i,a=t.linePool.alloc();null===(i=a.getComponent(yb))||void 0===i||i.setPoints(e.a,e.b),t.animateLine(a);var o=t.pointPool.alloc();o.setWorldPosition(e.a.x,e.a.y,0),t.animatePoint(o,n)}));var a=this.pointPool.alloc();a.setWorldPosition(i.b.x,i.b.y,0),this.animatePoint(a,e.length)}}}}},{key:"animateLine",value:(l=o((function*(e){var t=e.getComponent(B);t.opacity=0;var n=R(t).to(.25,{opacity:255},{easing:"quadOut"}).delay(.1).to(.2,{opacity:0});yield Ve.runTweenAsync(n),t.opacity=255,this.linePool.free(e)})),function(e){return l.apply(this,arguments)})},{key:"animatePoint",value:(r=o((function*(e,t){e.scale=V.ZERO;var n=R(e).delay(.03*t).to(.2,{scale:V.ONE},{easing:"quadOut"}).delay(.1).to(.2,{scale:V.ZERO},{easing:"backIn"});yield Ve.runTweenAsync(n),this.node.activeInHierarchy&&this.pointPool.free(e)})),function(e,t){return r.apply(this,arguments)})},{key:"clearPath",value:function(){this.lineNodes=[],this.pointNodes=[]}}]),u}(xb)).prototype,"animatePoint",[Kb],Object.getOwnPropertyDescriptor(Yb.prototype,"animatePoint"),Yb.prototype),jb=Yb))||jb);S._RF.pop(),S._RF.push({},"bfdf2THr9lPJ4TOVDN8VgE4","PathDraw",void 0);var lw,sw=C.ccclass,uw=C.property,cw=(Jb=sw("PathDraw"),Zb=uw({group:{name:"Path Drawer"},type:rw}),Qb=uw({group:{name:"Path Drawer"},type:Xb}),ew=uw({group:{name:"Path Drawer"},type:$b}),Jb((iw=a((nw=function(a){n(c,a);var o=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"matchPath",iw,l(e)),r(e,"hintPath",aw,l(e)),r(e,"errorPath",ow,l(e)),e.isDrawingHint=!1,e}return e(c,[{key:"onLoad",value:function(){var e=this;this.node.scene.on(Es.GRID_RESIZE,(function(t){e.node.setScale(t,t),e.node.position=e.board.node.position.clone()}))}},{key:"init",value:function(e){this.board=e}},{key:"drawMatchPath",value:function(e,t){var n,i=e.map((function(e){return s({},e)})),a=u(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.matchPath.drawPath(i)}},{key:"clearMatchPath",value:function(){this.matchPath.clearPath()}},{key:"drawHintPath",value:function(e,t){if(!this.isDrawingHint){this.isDrawingHint=!0;var n,i=e.map((function(e){return s({},e)})),a=u(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.hintPath.drawPath(i)}}},{key:"clearHintPath",value:function(){this.isDrawingHint&&(this.isDrawingHint=!1,this.hintPath.clearPath())}},{key:"drawErrorPath",value:function(e,t){var n,i=e.map((function(e){return s({},e)})),a=u(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.errorPath.drawPath(i)}}]),c}(T)).prototype,"matchPath",[Zb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aw=a(nw.prototype,"hintPath",[Qb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ow=a(nw.prototype,"errorPath",[ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tw=nw))||tw);S._RF.pop(),S._RF.push({},"1a5c0RyWQJOipSvNtPLsTHS","ClockManager",void 0);var dw,hw,pw,yw,vw,fw,gw,mw,bw,ww,Sw,kw,Cw,Ew,Aw,Tw,Pw,Ow,Lw=C.ccclass,Iw=C.disallowMultiple,Rw=Lw("ClockManager")(lw=Iw(lw=function(a){n(s,a);var r,l=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=l.call.apply(l,[this].concat(i))).time=0,e.remaining=0,e.running=!1,e.halfTime=!1,e}return e(s,[{key:"onLoad",value:function(){this.node.scene.on(Es.RESCUE_START,this.refillTime,this)}},{key:"init",value:function(){this.running=!1,this.halfTime=!1}},{key:"setTime",value:function(e){this.time=e,this.remaining=e,this.node.scene.emit(Es.TIME_UPDATED,this.remaining)}},{key:"getRemainingTime",value:function(){return this.remaining}},{key:"startCountdown",value:function(){this.running=!0,this.remaining=this.time}},{key:"pause",value:function(){this.running=!1}},{key:"resume",value:function(){this.running=!0}},{key:"endCountDown",value:function(){this.running=!1,this.remaining=0,this.node.scene.emit(Es.TIME_OUT)}},{key:"update",value:function(e){this.running&&(this.remaining<=0?this.endCountDown():(this.remaining-=e,!this.halfTime&&this.remaining<=this.time/2&&(this.halfTime=!0,this.node.scene.emit(Es.HALF_TIME)),this.remaining>=0&&this.node.scene.emit(Es.TIME_UPDATED,this.remaining)))}},{key:"refillTime",value:(r=o((function*(){var e=this,t=R(this.node).to(3,{},{onUpdate:function(t,n){if(n){var i=te.lerp(0,120,n);e.setTime(i)}}});yield Ve.runTweenAsync(t),this.setTime(120),this.node.scene.emit(Es.RESCUE_FINISHED)})),function(){return r.apply(this,arguments)})}]),s}(T))||lw)||lw;S._RF.pop(),S._RF.push({},"944cbG3+yRMsJZimXjukGdn","Coin",void 0);var _w,Dw,Mw,Nw,Bw,Fw,xw,zw,Uw,Gw,Hw,qw=C.ccclass,Vw=C.property,$w=(dw=qw("Coin"),hw=Vw(ee),pw=Vw(ce),yw=Vw(de),vw=Vw(de),fw=Yn.onlyRunInLifeCycle,gw=Yn.onlyRunInLifeCycle,mw=Yn.onlyRunInLifeCycle,bw=Yn.onlyRunInLifeCycle,ww=Yn.onlyRunInLifeCycleAsync,Sw=Yn.onlyRunInLifeCycleAsync,kw=Yn.onlyRunInLifeCycle,dw((Aw=a((Ew=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"emittingParticles",Aw,l(e)),r(e,"animation",Tw,l(e)),r(e,"spin",Pw,l(e)),r(e,"rest",Ow,l(e)),e}return e(c,[{key:"__preload",value:function(){Yn.lazyValidateProperties(this)}},{key:"resetDisabled",value:function(){this.stopParticles(),this.stopAnimation(),this.hide(),this.node.active=!1,this.node.setPosition(0,0,this.node.position.z)}},{key:"hide",value:function(){this.node.setScale(V.ZERO)}},{key:"stopParticles",value:function(){this.emittingParticles.stopSystem()}},{key:"playTrailParticles",value:function(){this.emittingParticles.resetSystem()}},{key:"playSpinAnimationAfterDelay",value:(s=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;e>0&&(yield Ve.waitTweenAsync(e)),yield this.playSpinAnimation(t)})),function(){return s.apply(this,arguments)})},{key:"playSpinAnimation",value:function(e){return Ve.runAnimationAsync(this.animation,this.spin.name,e)}},{key:"stopAnimation",value:function(){this.animation.play(this.rest.name)}}]),c}(T)).prototype,"emittingParticles",[hw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tw=a(Ew.prototype,"animation",[pw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pw=a(Ew.prototype,"spin",[yw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ow=a(Ew.prototype,"rest",[vw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Ew.prototype,"resetDisabled",[fw],Object.getOwnPropertyDescriptor(Ew.prototype,"resetDisabled"),Ew.prototype),a(Ew.prototype,"hide",[gw],Object.getOwnPropertyDescriptor(Ew.prototype,"hide"),Ew.prototype),a(Ew.prototype,"stopParticles",[mw],Object.getOwnPropertyDescriptor(Ew.prototype,"stopParticles"),Ew.prototype),a(Ew.prototype,"playTrailParticles",[bw],Object.getOwnPropertyDescriptor(Ew.prototype,"playTrailParticles"),Ew.prototype),a(Ew.prototype,"playSpinAnimationAfterDelay",[ww],Object.getOwnPropertyDescriptor(Ew.prototype,"playSpinAnimationAfterDelay"),Ew.prototype),a(Ew.prototype,"playSpinAnimation",[Sw],Object.getOwnPropertyDescriptor(Ew.prototype,"playSpinAnimation"),Ew.prototype),a(Ew.prototype,"stopAnimation",[kw],Object.getOwnPropertyDescriptor(Ew.prototype,"stopAnimation"),Ew.prototype),Cw=Ew))||Cw);S._RF.pop(),S._RF.push({},"0c6a8vx5IhFvKJ5IUimm0Je","CoinTextPopup",void 0);var Ww,Kw,jw,Yw,Xw,Jw,Zw,Qw,eS,tS,nS,iS,aS,oS,rS,lS,sS,uS,cS=C.ccclass,dS=C.property,hS=V.ZERO.clone().add3f(0,-100,0),pS=V.ZERO.clone().add3f(0,100,0),yS=Ludex.Utils.Number,vS=(_w=cS("CoinTextPopup"),Dw=dS(K),Mw=dS(B),Nw=Yn.onlyRunInLifeCycle,Bw=Yn.onlyRunInLifeCycle,Fw=Yn.onlyRunInLifeCycleAsync,xw=Yn.onlyRunInLifeCycleAsync,_w((Gw=a((Uw=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"label",Gw,l(e)),r(e,"uiOpacity",Hw,l(e)),e}return e(h,[{key:"__preload",value:function(){Yn.lazyValidateProperties(this),this.node.active=!1}},{key:"show",value:(c=o((function*(e,t){this.enableNode(),this.initializePopup(e),yield this.showTextPopupAnimation(t),yield this.hidePopup(),this.disableNode()})),function(e,t){return c.apply(this,arguments)})},{key:"enableNode",value:function(){this.node.active=!0}},{key:"disableNode",value:function(){this.node.active=!1}},{key:"initializePopup",value:function(e){var t=yS.getShortNumber(e,3);this.label.string=t,this.uiOpacity.opacity=255,this.node.setScale(.5,.5,.5),this.node.setPosition(hS)}},{key:"hidePopup",value:(u=o((function*(){this.node.setScale(V.ONE),this.node.setPosition(pS),yield Ve.runTweenAsync(R(this.uiOpacity).to(.5,{opacity:0}))})),function(){return u.apply(this,arguments)})},{key:"showTextPopupAnimation",value:(s=o((function*(e){yield Promise.all([Ve.runTweenAsync(R(this.node).to(1.5,{position:pS},{easing:"sineOut"}),e),Ve.runTweenAsync(R(this.node).to(.5,{scale:V.ONE},{easing:"backOut"}),e)])})),function(e){return s.apply(this,arguments)})}]),h}(T)).prototype,"label",[Dw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=a(Uw.prototype,"uiOpacity",[Mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Uw.prototype,"disableNode",[Nw],Object.getOwnPropertyDescriptor(Uw.prototype,"disableNode"),Uw.prototype),a(Uw.prototype,"initializePopup",[Bw],Object.getOwnPropertyDescriptor(Uw.prototype,"initializePopup"),Uw.prototype),a(Uw.prototype,"hidePopup",[Fw],Object.getOwnPropertyDescriptor(Uw.prototype,"hidePopup"),Uw.prototype),a(Uw.prototype,"showTextPopupAnimation",[xw],Object.getOwnPropertyDescriptor(Uw.prototype,"showTextPopupAnimation"),Uw.prototype),zw=Uw))||zw);S._RF.pop(),S._RF.push({},"8a5c3m7o41LNqGBKPo0oqf1","CoinManager",void 0);var fS,gS=C.ccclass,mS=C.disallowMultiple,bS=C.property,wS=codex,SS=wS.player,kS=wS.monitorError,CS=999999999,ES=10,AS=1,TS=1,PS=(Ww=gS("CoinManager"),Kw=Yn.required(),jw=bS(fe),Yw=Yn.required(),Xw=bS(fe),Jw=Yn.required(),Zw=bS(q),Qw=Yn.onlyRunInLifeCycleAsync,eS=Yn.onlyRunInLifeCycleAsync,tS=Yn.onlyRunInLifeCycleAsync,nS=Yn.onlyRunInLifeCycleAsync,iS=Yn.onlyRunInLifeCycleAsync,aS=Yn.onlyRunInLifeCycleAsync,Ww(oS=mS((lS=a((rS=function(a){n(y,a);var u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=p.call.apply(p,[this].concat(i))).coins=0,r(e,"coinPrefab",lS,l(e)),r(e,"coinTextPopup",sS,l(e)),r(e,"coinAnimContainer",uS,l(e)),e.coinObjects=[],e}return e(y,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.getCoinsFromPlayerData(),this.prepareCoinCollection(),this.prepareCoinTextPopup(),this.listenToCoinEvents()}},{key:"start",value:function(){this.emitCoinAmount()}},{key:"init",value:function(){this.updateCoins({coins:this.coins})}},{key:"listenToCoinEvents",value:function(){this.node.scene.on(Es.ADD_COINS,this.addCoins,this),this.node.scene.on(Es.REMOVE_COINS,this.removeCoins,this),this.node.scene.on(Es.ABORT_COIN_ANIMATION,this.abortCoinAnimation,this)}},{key:"prepareCoinCollection",value:function(){for(var e=0;e<ES;e++){var t=ye(this.coinPrefab);t.setParent(this.coinAnimContainer),t.setPosition(0,0),t.active=!1,this.coinObjects.push(t.getComponent($w))}}},{key:"prepareCoinTextPopup",value:function(){var e=ye(this.coinTextPopup);e.setParent(this.node),e.active=!1,this.coinTextPopupNode=e.getComponent(vS)}},{key:"handleCollectionAnim",value:(h=o((function*(e,t,n,i,a){var o=this;if(t){var r=this.coinObjects.slice(0,this.getShortAmount(e));if(0===r.length)return console.warn("Requested coins amount is ".concat(e,". Shortened to ").concat(this.getShortAmount(e),". No coin objects was found to animate collection.")),void(null==kS||kS.sendException(new Error("Requested coins amount is ".concat(e,". Shortened to ").concat(this.getShortAmount(e),". No coin objects was found to animate collection.")),{coins:e,animatedCoins:r.length,hasCoinTextPopup:!!this.coinTextPopupNode,hasTargetContainer:!!t,coinCollectionCount:this.coinObjects.length}));je.playSound(Qi.COLLECT_STOCK_COINS),yield Promise.all([this.playCoinFlyAndexplodeAnimation(t,r,n,i,a),Ve.waitTweenAsync(n+i/2,a).then((function(){return o.animateCoinTextPopup(e,a)}))]),a.abort()}else console.warn("No target coin container assigned to CoinManager. No coin collection animation will be played")})),function(e,t,n,i,a){return h.apply(this,arguments)})},{key:"playCoinFlyAndexplodeAnimation",value:(d=o((function*(e,t,n,i,a){var o=this,r=n+i;yield Promise.all([].concat(g(t.flatMap((function(t){t.node.active=!0,t.stopParticles();var r=[0,.5*Math.min(n,i)],l=he.apply(void 0,r),s=n-l,u=i+l;return[o.animateCoinExplode(t.node,s,a),Ve.waitTweenAsync(s,a).then((function(){return o.animateCoinFlyBack(e,t,u,a)}))]}))),[Ve.waitTweenAsync(r,a).then((function(){return e.emitExplodeEffect(a)}))]))})),function(e,t,n,i,a){return d.apply(this,arguments)})},{key:"animateCoinTextPopup",value:function(e,t){return this.coinTextPopupNode.show(e,t)}},{key:"animateCoinFlyBack",value:(c=o((function*(e,t,n,i){var a=t.node.worldPosition.clone(),o=V.ZERO.clone(),r=e.getCoinIconWorldScale();yield Ve.runTweenAsync(R(t.node).to(n,{scale:r},{onStart:function(){t.playSpinAnimationAfterDelay(0,i),t.playTrailParticles()},onUpdate:function(n,i){if(void 0!==i){var r=z.cubicIn(i),l=e.getCoinIconWorldPosition();t.node.worldPosition=V.lerp(o,a,l,r)}},onComplete:function(){t.emittingParticles.stopSystem(),t.stopAnimation(),t.hide()}}),i),yield Ve.waitTweenAsync(1,i),t.resetDisabled()})),function(e,t,n,i){return c.apply(this,arguments)})},{key:"animateCoinExplode",value:(u=o((function*(e,t,n){var i=[-200,200],a=[-200,200],o=he(i[0],i[1]),r=he(a[0],a[1]);e.setPosition(0,0,e.position.z),e.setScale(V.ZERO);var l=new V(o,r,e.position.z);yield Promise.all([Ve.runTweenAsync(R(e).delay(.1*t).to(.8*t,{scale:V.ONE},{easing:"elasticOut"}),n),Ve.runTweenAsync(R(e).to(t,{position:l},{easing:"circOut"}),n)])})),function(e,t,n){return u.apply(this,arguments)})},{key:"getCoinsFromPlayerData",value:function(){var e=SS.getGameData();this.coins=e?e.coins:0}},{key:"getCoins",value:function(){return this.coins}},{key:"updateCoins",value:function(e){var t,n;if(this.coins>CS&&(this.coins=CS),e.coins!==this.coins){var i=Math.max(0,e.coins-this.coins);this.coins=e.coins,SS.setGameData({coins:this.coins});var a=e.collectionAnimation;null===(t=this.collectionAnimSignal)||void 0===t||t.abort();var o=new Ni;if(this.collectionAnimSignal=o,null==a||null===(n=a.signal)||void 0===n||n.chain(o),void 0===a||a.animateTextOnly)this.node.scene.emit(Es.COIN_CHANGED,s(s({},e),{},{collectionAnimation:{animateTextOnly:!0,signal:null==a?void 0:a.signal}}));else{var r=a.floatDuration,l=void 0===r?AS:r,u=a.flyDuration,c=void 0===u?TS:u,d=a.target,h=void 0===d?this.targetContainer:d;this.collectionAnimSignal=o,this.targetContainer=h;var p=s(s({},e),{},{collectionAnimation:{floatDuration:l,flyDuration:c,animateTextOnly:!1,signal:o,target:h}});this.node.scene.emit(Es.COIN_CHANGED,p),this.handleCollectionAnim(i,this.targetContainer,l,c,o)}}}},{key:"addCoins",value:function(e){this.updateCoins(s(s({},e),{},{coins:this.coins+e.coins}))}},{key:"removeCoins",value:function(e){this.coins<e.coins?this.node.scene.emit(Es.REMOVE_COINS_FAILED):(this.updateCoins(s(s({},e),{},{coins:this.coins-e.coins})),this.node.scene.emit(Es.REMOVE_COINS_SUCCESS))}},{key:"emitCoinAmount",value:function(){this.node.scene.emit(Es.COIN_CHANGED,{coins:this.coins})}},{key:"getShortAmount",value:function(e){return Math.min(e,ES)}},{key:"abortCoinAnimation",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}},{key:"untilFinishesCollectAnim",value:function(){return void 0===this.collectionAnimSignal?Promise.resolve():this.collectionAnimSignal.untilAborted()}},{key:"setTargetContainer",value:function(e){this.targetContainer=e}},{key:"getTargetContainer",value:function(){return this.targetContainer}},{key:"onDestroy",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}}]),y}(T)).prototype,"coinPrefab",[Kw,jw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sS=a(rS.prototype,"coinTextPopup",[Yw,Xw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uS=a(rS.prototype,"coinAnimContainer",[Jw,Zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(rS.prototype,"handleCollectionAnim",[Qw],Object.getOwnPropertyDescriptor(rS.prototype,"handleCollectionAnim"),rS.prototype),a(rS.prototype,"playCoinFlyAndexplodeAnimation",[eS],Object.getOwnPropertyDescriptor(rS.prototype,"playCoinFlyAndexplodeAnimation"),rS.prototype),a(rS.prototype,"animateCoinTextPopup",[tS],Object.getOwnPropertyDescriptor(rS.prototype,"animateCoinTextPopup"),rS.prototype),a(rS.prototype,"animateCoinFlyBack",[nS],Object.getOwnPropertyDescriptor(rS.prototype,"animateCoinFlyBack"),rS.prototype),a(rS.prototype,"animateCoinExplode",[iS],Object.getOwnPropertyDescriptor(rS.prototype,"animateCoinExplode"),rS.prototype),a(rS.prototype,"untilFinishesCollectAnim",[aS],Object.getOwnPropertyDescriptor(rS.prototype,"untilFinishesCollectAnim"),rS.prototype),oS=rS))||oS)||oS);S._RF.pop(),S._RF.push({},"3afb9sM0KZKyod8UtofqZYu","ComboManager",void 0);var OS,LS,IS,RS,_S,DS,MS,NS,BS,FS,xS,zS=C.ccclass,US=[Qi.COMBO_1,Qi.COMBO_2,Qi.COMBO_3,Qi.COMBO_4,Qi.COMBO_5,Qi.COMBO_6,Qi.COMBO_7,Qi.COMBO_8,Qi.COMBO_9,Qi.COMBO_10,Qi.COMBO_11,Qi.COMBO_12,Qi.COMBO_13],GS=zS("ComboManager")(fS=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"init",value:function(){this.currentCombo=0,this.setEmitEvent(!0),this.node.scene.on(Es.COMBO_ENDED,this.resetCombo,this),this.node.scene.on(Es.GAME_FINISH,this.resetCombo,this),this.node.scene.on(Es.GAME_REPLAY,this.resetCombo,this),this.node.scene.on(Es.NEXT_LEVEL,this.resetCombo,this),this.node.scene.on(Es.ADD_COMBO,this.addCombo,this)}},{key:"addCombo",value:function(){this.setCombo(this.currentCombo+1)}},{key:"resetCombo",value:function(){this.setCombo(0)}},{key:"getCombo",value:function(){return this.currentCombo}},{key:"setCombo",value:function(e){if(this.currentCombo=e,e>0){var t=Math.min(e-1,US.length-1);je.playSound(US[t]),this.vibrate(e)}this.emitEvent&&this.node.scene.emit(Es.COMBO_UPDATED,e)}},{key:"vibrate",value:function(e){var t;null===(t=re("Vibrate"))||void 0===t||null===(t=t.getComponent(fy))||void 0===t||t.vibrate(Math.min(20+20*e,220))}},{key:"setEmitEvent",value:function(e){this.emitEvent=e}}]),r}(T))||fS;S._RF.pop(),S._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var HS=C.ccclass,qS=C.property,VS=(OS=HS("Burst"),LS=qS(L),IS=qS(O),RS=qS(L),_S=qS(O),OS((NS=a((MS=function(){function n(){t(this,n),r(this,"time",NS,this),r(this,"repeatCount",BS,this),r(this,"repeatInterval",FS,this),r(this,"count",xS,this),this.remainingCount=0,this.curTime=0}return e(n,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=ge(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=ge(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),n}()).prototype,"time",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),BS=a(MS.prototype,"repeatCount",[IS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),FS=a(MS.prototype,"repeatInterval",[RS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),xS=a(MS.prototype,"count",[_S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),DS=MS))||DS);S._RF.pop(),S._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var $S,WS,KS,jS,YS,XS,JS,ZS,QS,ek,tk,nk,ik,ak,ok,rk,lk,sk=new V(0,0,0),uk=function(){function n(){t(this,n),this.pos=new V(0,0,0),this.color=new X(255,255,255,255),this.size=new V(0,0,0),this.startSize=new V(0,0,0),this.rotation=new V(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new V(0,0),this.width=0,this.height=0}return e(n,[{key:"init",value:function(){this.pos.set(sk),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(sk),this.startColor=X.WHITE.clone(),this.velocity.set(sk),this.randomSeed=0}}]),n}(),ck=new(function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"get",value:function(){return this._get()||new uk}}]),r}(me.Pool))((function(e){e.pos.set(sk),e.color.set(255,255,255,255),e.size.set(sk),e.rotation.set(sk)}),1024),dk=function(){function n(e){t(this,n),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new we,this.sys=e,this.particles=[],this.active=!1,this.uvFilled=0}return e(n,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;ck.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=ck.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var a=i.uv,o=e?0:this.uvFilled,r=this.particles.length,l=o;l<r;l++){var s,u,c,d,h,p,y,v,f=9*l*4;n[f+3]=null!==(s=a[0])&&void 0!==s?s:0,n[f+4]=null!==(u=a[1])&&void 0!==u?u:0,n[f+12]=null!==(c=a[2])&&void 0!==c?c:0,n[f+13]=null!==(d=a[3])&&void 0!==d?d:0,n[f+21]=null!==(h=a[4])&&void 0!==h?h:0,n[f+22]=null!==(p=a[5])&&void 0!==p?p:0,n[f+30]=null!==(y=a[6])&&void 0!==y?y:0,n[f+31]=null!==(v=a[7])&&void 0!==v?v:0}this.uvFilled=r}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var a=n.vData,o=t.x,r=t.y,l=t.z,s=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,d=e.rotation.y||0,h=e.rotation.z||0;if(0===c&&0===d&&0===h)a[i]=o-s,a[i+1]=r-u,a[i+2]=l,a[i+9]=o+s,a[i+10]=r-u,a[i+11]=l,a[i+18]=o-s,a[i+19]=r+u,a[i+20]=l,a[i+27]=o+s,a[i+28]=r+u,a[i+29]=l;else{var p=function(e,t,n){var i=t*g-n*m,a=t*m+n*g,o=e*b+a*w;return new V(o*S-i*k,o*k+i*S,a*b-e*w)},y=-be.degreesToRadians(c),v=-be.degreesToRadians(d),f=-be.degreesToRadians(h),g=Math.cos(y),m=Math.sin(y),b=Math.cos(v),w=Math.sin(v),S=Math.cos(f),k=Math.sin(f),C=[p(-s,-u,0),p(s,-u,0),p(-s,u,0),p(s,u,0)];a[i]=C[0].x+o,a[i+1]=C[0].y+r,a[i+2]=C[0].z+l,a[i+9]=C[1].x+o,a[i+10]=C[1].y+r,a[i+11]=C[1].z+l,a[i+18]=C[2].x+o,a[i+19]=C[2].y+r,a[i+20]=C[2].z+l,a[i+27]=C[3].x+o,a[i+28]=C[3].y+r,a[i+29]=C[3].z+l}X.toArray(a,e.color,i+5),X.toArray(a,e.color,i+14),X.toArray(a,e.color,i+23),X.toArray(a,e.color,i+32)}},{key:"step",value:function(e){var t,n=this.sys.node,i=this.particles;n.updateWorldTransform(),this.active&&this.sys.emitting(e);var a=this.renderData,o=i.length;a.reset(),this.requestData(4*o,6*o),o>this.uvFilled&&this.updateUVs();for(var r=0;r<i.length;){var l=i[r];if(l)if(l.remainingLifetime-=e,l.remainingLifetime>0){var s=9*r*4;this.updateParticleBuffer(l,l.pos,a,s),++r}else{var u=i[r];if(!u)continue;if(r!==i.length-1){var c=i[i.length-1];c&&(i[r]=c)}ck.put(u),i.length--,a.resize(a.vertexCount-4,a.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,null==a||null===(t=a.setRenderDrawInfoAttributes)||void 0===t||t.call(a)}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,o=n;o<i;o++){var r=4*o;a[n++]=r,a[n++]=r+1,a[n++]=r+2,a[n++]=r+1,a[n++]=r+3,a[n++]=r+2}}},{key:"initDrawInfo",value:function(){var e,t=this.renderData;null==t||null===(e=t.setRenderDrawInfoAttributes)||void 0===e||e.call(t)}}]),n}();S._RF.pop(),S._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var hk,pk,yk,vk,fk,gk,mk,bk,wk,Sk,kk,Ck,Ek,Ak,Tk,Pk,Ok,Lk=C.ccclass,Ik=C.property,Rk=x({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),_k=($S=Lk("CurveRange"),WS=Ik({type:x(Rk)}),KS=Ik({visible:function(){return this.mode===Rk.Constant}}),jS=Ik({visible:function(){return this.mode===Rk.Curve}}),YS=Ik({visible:function(){return this.mode===Rk.TwoCurves}}),XS=Ik({visible:function(){return this.mode===Rk.TwoCurves}}),JS=Ik({visible:function(){return this.mode===Rk.TwoConstants}}),ZS=Ik({visible:function(){return this.mode===Rk.TwoConstants}}),$S((tk=a((ek=function(){function n(){t(this,n),r(this,"mode",tk,this),r(this,"constant",nk,this),r(this,"spline",ik,this),r(this,"splineMin",ak,this),r(this,"splineMax",ok,this),r(this,"constantMin",rk,this),r(this,"constantMax",lk,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case Rk.Curve:return this.spline.evaluate(e);case Rk.TwoCurves:return Se(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case Rk.TwoConstants:return Se(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case Rk.Curve:return 1;case Rk.TwoConstants:return this.constantMax;case Rk.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case Rk.Curve:return ke(1,0,Ce);case Rk.TwoConstants:return ke(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,Ce);case Rk.TwoCurves:return ke(1,0,Ce);default:return ke(this.constant,0,Ce)}}}]),n}()).prototype,"mode",[WS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rk.Constant}}),nk=a(ek.prototype,"constant",[KS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ik=a(ek.prototype,"spline",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ee}}),ak=a(ek.prototype,"splineMin",[YS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ee}}),ok=a(ek.prototype,"splineMax",[XS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ee}}),rk=a(ek.prototype,"constantMin",[JS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lk=a(ek.prototype,"constantMax",[ZS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),QS=ek))||QS);S._RF.pop(),S._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var Dk=C.ccclass,Mk=C.property,Nk=x({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),Bk=new X,Fk=new X,xk=(hk=Dk("GradientRange"),pk=Mk({type:x(Nk)}),yk=Mk({visible:function(){return this.mode===Nk.Color}}),vk=Mk({visible:function(){return this.mode===Nk.TwoColors}}),fk=Mk({visible:function(){return this.mode===Nk.TwoColors}}),gk=Mk({visible:function(){return this.mode===Nk.Gradient||this.mode===Nk.RandomColor}}),mk=Mk({visible:function(){return this.mode===Nk.TwoGradients}}),bk=Mk({visible:function(){return this.mode===Nk.TwoGradients}}),hk((kk=a((Sk=function(){function n(){t(this,n),r(this,"mode",kk,this),r(this,"color",Ck,this),r(this,"colorMin",Ek,this),r(this,"colorMax",Ak,this),r(this,"gradient",Tk,this),r(this,"gradientMin",Pk,this),r(this,"gradientMax",Ok,this),this._color=X.WHITE.clone()}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case Nk.Color:return this.color;case Nk.TwoColors:return X.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case Nk.RandomColor:return this.gradient.getRandomColor(this._color);case Nk.Gradient:return this.gradient.evaluateFast(this._color,e);case Nk.TwoGradients:return X.lerp(this._color,this.gradientMin.evaluateFast(Bk,e),this.gradientMax.evaluateFast(Fk,e),t),this._color;default:return this.color}}}]),n}()).prototype,"mode",[pk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Nk.Color}}),Ck=a(Sk.prototype,"color",[yk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.WHITE.clone()}}),Ek=a(Sk.prototype,"colorMin",[vk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.WHITE.clone()}}),Ak=a(Sk.prototype,"colorMax",[fk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.WHITE.clone()}}),Tk=a(Sk.prototype,"gradient",[gk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ae}}),Pk=a(Sk.prototype,"gradientMin",[mk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ae}}),Ok=a(Sk.prototype,"gradientMax",[bk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ae}}),wk=Sk))||wk);function zk(e,t,n,i){!function(e,t){ae.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,V.multiplyScalar(e,e,t+(n-t)*Pe())}function Uk(e){var t=Rk;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}S._RF.pop(),S._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),S._RF.pop(),S._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var Gk,Hk,qk,Vk,$k,Wk,Kk,jk=23541,Yk=39825,Xk=91041,Jk=125292,Zk=197866,Qk=156497;S._RF.pop(),S._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var eC,tC,nC,iC,aC,oC,rC,lC,sC,uC=C.ccclass,cC=C.property,dC=Xk,hC=(Gk=uC("ColorOvertimeModule"),Hk=cC({type:W}),qk=cC({type:xk}),Gk((Wk=a(($k=function(){function n(){t(this,n),r(this,"enable",Wk,this),r(this,"color",Kk,this)}return e(n,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=Nk;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?pe(e.randomSeed+dC):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),n}()).prototype,"enable",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kk=a($k.prototype,"color",[qk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xk}}),Vk=$k))||Vk);S._RF.pop(),S._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var pC,yC,vC,fC,gC,mC,bC,wC,SC,kC,CC,EC,AC,TC=C.ccclass,PC=C.property,OC=jk,LC=(eC=TC("LimitVelocityOvertimeModule"),tC=PC({type:W}),nC=PC({type:_k}),iC=PC({type:_k}),eC((rC=a((oC=function(){function n(){t(this,n),r(this,"enable",rC,this),r(this,"limit",lC,this),r(this,"dampen",sC,this),this.limit.constant=500,this.dampen.constant=.2}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),a=Uk(this.limit)?pe(e.randomSeed+OC):0,o=Uk(this.dampen)?pe(e.randomSeed+OC+1):0,r=e.velocity.length(),l=this.limit.evaluate(n,a),s=this.dampen.evaluate(n,o);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(r,l,s,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var a=1-Math.exp(-n*i);return te.lerp(e,t,a)}}]),n}()).prototype,"enable",[tC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lC=a(oC.prototype,"limit",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),sC=a(oC.prototype,"dampen",[iC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),aC=oC))||aC);S._RF.pop(),S._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var IC,RC,_C,DC,MC,NC,BC,FC,xC,zC,UC,GC,HC,qC,VC,$C,WC,KC,jC,YC,XC,JC,ZC,QC=C.ccclass,eE=C.property,tE=Jk,nE=(pC=QC("RotationOvertimeModule"),yC=eE({type:W}),vC=eE(W),fC=eE({type:_k,visible:function(){return this.separateAxes}}),gC=eE({type:_k,visible:function(){return this.separateAxes}}),mC=eE({type:_k}),pC((SC=a((wC=function(){function n(){t(this,n),r(this,"enable",SC,this),r(this,"separateAxes",kC,this),r(this,"x",CC,this),r(this,"y",EC,this),r(this,"z",AC,this)}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+tE,a=Uk(this.z)?pe(i):0,o=this.z.evaluate(n,a)*t,r=0,l=0;if(this.separateAxes){var s=Uk(this.x)?pe(i):0,u=Uk(this.y)?pe(i):0;r=this.x.evaluate(n,s)*t,l=this.y.evaluate(n,u)*t}e.rotation.add3f(r,l,o)}}}]),n}()).prototype,"enable",[yC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kC=a(wC.prototype,"separateAxes",[vC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CC=a(wC.prototype,"x",[fC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),EC=a(wC.prototype,"y",[gC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),AC=a(wC.prototype,"z",[mC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),bC=wC))||bC);S._RF.pop(),S._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var iE,aE,oE,rE,lE,sE,uE,cE,dE,hE,pE,yE,vE,fE=C.ccclass,gE=C.property,mE=x({Circle:0,Rectangle:1}),bE=x({Base:0,Edge:1}),wE=function(){return this.shape===mE.Circle},SE=function(){return this.shape===mE.Rectangle},kE=[0,0],CE=(IC=fE("ShapeModule"),RC=gE({type:x(mE)}),_C=gE({type:x(bE),visible:SE}),DC=gE({}),MC=gE({}),NC=gE({}),BC=gE({range:[0,360],visible:wE}),FC=gE({range:[-360,360],visible:wE}),xC=gE({min:0,visible:wE}),zC=gE({range:[0,1],step:.01,visible:wE}),UC=gE({visible:SE}),IC((qC=a((HC=function(){function n(){t(this,n),r(this,"shape",qC,this),r(this,"emitFrom",VC,this),r(this,"position",$C,this),r(this,"rotation",WC,this),r(this,"scale",KC,this),r(this,"arc",jC,this),r(this,"angle",YC,this),r(this,"radius",XC,this),r(this,"radiusThickness",JC,this),r(this,"rectangleThickness",ZC,this)}return e(n,[{key:"emit",value:function(e){switch(this.shape){case mE.Circle:this.circleEmit(this.radius,this.radiusThickness,Oe(this.generateArcAngle()),e);break;case mE.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var a=i.pos;zk(a,e*(1-t),e,n+Oe(this.angle)),i.velocity=a.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,a,o,r=n.pos;switch(e){case bE.Base:a=r,o=t,ae.set(a,he(-o.x,o.x),he(-o.y,o.y));break;case bE.Edge:kE[0]=he(-1,1),kE[1]=(0===(i=he(-1,1))&&i++,Te.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+se(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(kE),this.applyRectThickness(kE,t),ae.set(r,kE[0],kE[1])}n.velocity=r.clone().normalize()}},{key:"generateArcAngle",value:function(){return he(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case mE.Circle:this.gizmoCircle(e);break;case mE.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(Oe(this.angle)),a=this.radius*Math.sin(Oe(this.angle)),o=this.radius*Math.cos(Oe(this.arc+this.angle)),r=this.radius*Math.sin(Oe(this.arc+this.angle));e.moveTo(i,a),e.lineTo(0,0),e.moveTo(o,r),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var a=(i-n)/48,o=0;o<=48;o++){var r=n+o*a,l=t*Math.cos(Oe(r)),s=t*Math.sin(Oe(r));0===o?e.moveTo(l,s):e.lineTo(l,s)}}}]),n}()).prototype,"shape",[RC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return mE.Circle}}),VC=a(HC.prototype,"emitFrom",[_C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return bE.Base}}),$C=a(HC.prototype,"position",[DC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(0,0,0)}}),WC=a(HC.prototype,"rotation",[MC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(0,0,0)}}),KC=a(HC.prototype,"scale",[NC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(1,1,1)}}),jC=a(HC.prototype,"arc",[BC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),YC=a(HC.prototype,"angle",[FC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),XC=a(HC.prototype,"radius",[xC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),JC=a(HC.prototype,"radiusThickness",[zC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ZC=a(HC.prototype,"rectangleThickness",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ae(20,50)}}),GC=HC))||GC);S._RF.pop(),S._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var EE,AE,TE,PE,OE,LE,IE,RE,_E,DE=C.ccclass,ME=C.property,NE=Yk,BE=(iE=DE("SizeOvertimeModule"),aE=ME({type:W}),oE=ME(W),rE=ME({type:_k,visible:function(){return!this.separateAxes}}),lE=ME({type:_k,visible:function(){return this.separateAxes}}),sE=ME({type:_k,visible:function(){return this.separateAxes}}),iE((dE=a((cE=function(){function n(){t(this,n),r(this,"enable",dE,this),r(this,"separateAxes",hE,this),r(this,"size",pE,this),r(this,"x",yE,this),r(this,"y",vE,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return e(n,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+NE;if(this.separateAxes){var i=Uk(this.x)?pe(n):0,a=Uk(this.y)?pe(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,a)}else{var o=Uk(this.size)?pe(n):0,r=this.size.evaluate(t,o);e.size.multiplyScalar(r)}}}}]),n}()).prototype,"enable",[aE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hE=a(cE.prototype,"separateAxes",[oE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pE=a(cE.prototype,"size",[rE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),yE=a(cE.prototype,"x",[lE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),vE=a(cE.prototype,"y",[sE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),uE=cE))||uE);S._RF.pop(),S._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var FE,xE,zE,UE,GE,HE,qE,VE,$E,WE,KE,jE,YE,XE,JE,ZE,QE,eA,tA,nA,iA,aA,oA,rA,lA,sA,uA,cA,dA,hA,pA,yA,vA,fA,gA,mA,bA,wA,SA,kA,CA,EA,AA,TA,PA,OA,LA,IA,RA,_A,DA,MA,NA,BA,FA,xA,zA,UA,GA,HA,qA,VA=C.ccclass,$A=C.property,WA=(EE=VA("VelocityOvertimeModule"),AE=$A({type:W}),TE=$A({type:_k}),PE=$A({type:_k}),EE((IE=a((LE=function(){function n(){t(this,n),r(this,"enable",IE,this),r(this,"x",RE,this),r(this,"y",_E,this),this._temp_v3=new V,this.x.constant=0,this.y.constant=0}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=Uk(this.x)?pe(e.randomSeed+Zk):0,a=Uk(this.y)?pe(e.randomSeed+Qk):0,o=V.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,a),0);e.velocity.add(o.multiplyScalar(t))}}}]),n}()).prototype,"enable",[AE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RE=a(LE.prototype,"x",[TE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),_E=a(LE.prototype,"y",[PE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),OE=LE))||OE);S._RF.pop(),S._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var KA,jA,YA,XA,JA,ZA,QA,eT,tT,nT,iT,aT,oT=C.ccclass,rT=C.property,lT=C.executeInEditMode,sT=C.disallowMultiple,uT=C.playOnFocus,cT=Le.Attr.setClassAttr,dT=x({World:0,Local:1}),hT=(FE=oT("ParticleSystem"),xE=lT(!0),zE=sT(!0),UE=uT(!0),GE=rT({}),HE=rT({formerlySerializedAs:"preview"}),qE=rT(W),VE=rT({type:x(dT)}),$E=rT({formerlySerializedAs:"simulationSpace"}),WE=rT(L),KE=rT(W),jE=rT({type:_k}),YE=rT({type:_k}),XE=rT(xk),JE=rT(W),ZE=rT({type:_k,formerlySerializedAs:"startSize"}),QE=rT({type:_k,visible:function(){return this.startSize2D}}),eA=rT({type:_k}),tA=rT(W),nA=rT({type:_k,visible:function(){return this.startRotation3D}}),iA=rT({type:_k,visible:function(){return this.startRotation3D}}),aA=rT({type:_k,formerlySerializedAs:"startRotation"}),oA=rT({type:_k}),rA=rT({type:_k}),lA=rT({type:CE}),sA=rT({type:WA}),uA=rT({type:BE}),cA=rT({type:nE}),dA=rT({type:hC}),hA=rT({type:LC}),pA=rT(VS),yA=rT({serializable:!0}),vA=rT({type:ue}),FE(fA=xE(fA=zE(fA=UE((a((gA=function(a){n(s,a);var o=i(s);function s(){var e;return t(this,s),e=o.call(this),r(e,"_preview",mA,l(e)),r(e,"playOnAwake",bA,l(e)),r(e,"_simulationSpace",wA,l(e)),r(e,"duration",SA,l(e)),r(e,"loop",kA,l(e)),r(e,"startDelay",CA,l(e)),r(e,"startLifetime",EA,l(e)),r(e,"startColor",AA,l(e)),r(e,"startSize2D",TA,l(e)),r(e,"startSizeX",PA,l(e)),r(e,"startSizeY",OA,l(e)),r(e,"startSpeed",LA,l(e)),r(e,"startRotation3D",IA,l(e)),r(e,"startRotationX",RA,l(e)),r(e,"startRotationY",_A,l(e)),r(e,"startRotationZ",DA,l(e)),r(e,"gravityModifier",MA,l(e)),r(e,"rateOverTime",NA,l(e)),r(e,"shapeModule",BA,l(e)),r(e,"velocityOvertimeModule",FA,l(e)),r(e,"sizeOvertimeModule",xA,l(e)),r(e,"rotationOvertimeModule",zA,l(e)),r(e,"colorOvertimeModule",UA,l(e)),r(e,"limitVelocityOvertimeModule",GA,l(e)),r(e,"bursts",HA,l(e)),r(e,"_spriteFrame",qA,l(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return e(s,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){c(d(s.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){c(d(s.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new dk(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){c(d(s.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new V(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e,t=ee.Assembler.getAssembler(this);if(this._assembler!==t&&(this._assembler=t),null!==(e=this._assembler)&&void 0!==e&&e.createData){var n=this._simulator,i=n.renderData;i||(i=n.renderData=this._assembler.createData(this),n.uvFilled=0,i.particleInitRenderDrawInfo(this.renderEntity),n.initDrawInfo())}}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===dT.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return c(d(s.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===dT.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===dT.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){var e;"function"==typeof(null===(e=this._renderEntity)||void 0===e?void 0:e.setRenderTransform)&&(this.simulationSpace===dT.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===dT.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1)))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var a,o=u(this.bursts);try{for(o.s();!(a=o.n()).done;){a.value.update(this,e)}}catch(e){o.e(e)}finally{o.f()}}var r=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,r),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var a=this._simulator.emitParticle();if(a.init(),this.shapeModule.emit(a),this.simulationSpace===dT.World){var o=this.node.worldMatrix;a.pos.x+=o.m12,a.pos.y+=o.m13}var r=this.startSpeed.evaluate(n,this.rand());a.velocity.multiplyScalar(r),a.width=this.spriteFrame.width,a.height=this.spriteFrame.height;var l=this.startSizeX.evaluate(n,this.rand()),s=this.startSize2D?new V(l,this.startSizeY.evaluate(n,this.rand()),1):new V(l,l,1);a.startSize=s.clone(),a.size=s.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new V(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new V(0,0,u);a.rotation=c,a.startColor=this.startColor.evaluate(n,this.rand()).clone(),a.color=a.startColor.clone(),a.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,a.remainingLifetime=a.startLifetime,a.randomSeed=se(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new V(0,-9.8*t,0))}},{key:"rand",value:function(){return pe(se(0,Te.INT_MAX))}}]),s}(Ie)).prototype,"preview",[GE],Object.getOwnPropertyDescriptor(gA.prototype,"preview"),gA.prototype),mA=a(gA.prototype,"_preview",[HE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bA=a(gA.prototype,"playOnAwake",[qE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),a(gA.prototype,"simulationSpace",[VE],Object.getOwnPropertyDescriptor(gA.prototype,"simulationSpace"),gA.prototype),wA=a(gA.prototype,"_simulationSpace",[$E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return dT.Local}}),SA=a(gA.prototype,"duration",[WE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),kA=a(gA.prototype,"loop",[KE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CA=a(gA.prototype,"startDelay",[jE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),EA=a(gA.prototype,"startLifetime",[YE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),AA=a(gA.prototype,"startColor",[XE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xk}}),TA=a(gA.prototype,"startSize2D",[JE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),PA=a(gA.prototype,"startSizeX",[ZE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),OA=a(gA.prototype,"startSizeY",[QE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),LA=a(gA.prototype,"startSpeed",[eA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),IA=a(gA.prototype,"startRotation3D",[tA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),RA=a(gA.prototype,"startRotationX",[nA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),_A=a(gA.prototype,"startRotationY",[iA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),DA=a(gA.prototype,"startRotationZ",[aA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),MA=a(gA.prototype,"gravityModifier",[oA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),NA=a(gA.prototype,"rateOverTime",[rA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _k}}),BA=a(gA.prototype,"shapeModule",[lA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new CE}}),FA=a(gA.prototype,"velocityOvertimeModule",[sA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new WA}}),xA=a(gA.prototype,"sizeOvertimeModule",[uA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new BE}}),zA=a(gA.prototype,"rotationOvertimeModule",[cA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new nE}}),UA=a(gA.prototype,"colorOvertimeModule",[dA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hC}}),GA=a(gA.prototype,"limitVelocityOvertimeModule",[hA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new LC}}),HA=a(gA.prototype,"bursts",[rT,pA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qA=a(gA.prototype,"_spriteFrame",[yA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a(gA.prototype,"spriteFrame",[vA],Object.getOwnPropertyDescriptor(gA.prototype,"spriteFrame"),gA.prototype),fA=gA))||fA)||fA)||fA)||fA);cT(hT,"color","visible",!1),S._RF.pop(),S._RF.push({},"91e6dGDvN1FKLi7g/JQPwl8","ItemCollectionFX",void 0);var pT=C.ccclass,yT=C.property,vT=(KA=pT("ItemCollectionFX"),jA=Yn.required(),YA=yT(F),XA=Yn.required(),JA=yT(q),ZA=Yn.required(),QA=yT(q),KA((nT=a((tT=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"sprite",nT,l(e)),r(e,"standardParticlesContainer",iT,l(e)),r(e,"quickParticlesContainer",aT,l(e)),e.standardParticles=[],e.quickParticles=[],e}return e(s,[{key:"__preload",value:function(){this.standardParticles=this.standardParticlesContainer.getComponentsInChildren(hT),this.quickParticles=this.quickParticlesContainer.getComponentsInChildren(hT),Yn.validateRequiredProperties(this,s)}},{key:"onDisable",value:function(){this.standardParticlesContainer.active=!1,this.quickParticlesContainer.active=!1}},{key:"playExplosionParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?(this.quickParticlesContainer.active=!0,this.playParticles(this.quickParticles)):(this.standardParticlesContainer.active=!0,this.playParticles(this.standardParticles))}},{key:"playParticles",value:function(e){var t,n=u(e);try{for(n.s();!(t=n.n()).done;){t.value.play()}}catch(e){n.e(e)}finally{n.f()}}}]),s}(T)).prototype,"sprite",[jA,YA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iT=a(tT.prototype,"standardParticlesContainer",[XA,JA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aT=a(tT.prototype,"quickParticlesContainer",[ZA,QA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eT=tT))||eT);S._RF.pop(),S._RF.push({},"7df59GGBIxFo7OyHCGrEKe5","addItemEffect",void 0);var fT=new V(.8,1.2,1),gT=new V(1.2,.8,1),mT=new V(.5,.5,.5),bT=new V(.65,.65,.65),wT=function(){var e=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.playExplosionParticles(n),je.playSound(Qi.ITEM_REWARD),n?yield ST(e,t):yield CT(e,t),je.playSound(Qi.BUTTON_CLICK)}));return function(t,n){return e.apply(this,arguments)}}();function ST(e,t){return kT.apply(this,arguments)}function kT(){return(kT=o((function*(e,t){var n=Ve.runTweenAsync(R(e.node).to(.1,{scale:fT}).to(.1,{scale:gT}).to(.1,{scale:V.ONE}).to(.3,{scale:bT})),i=e.node.worldPosition.x,a=e.node.worldPosition.y,o=new V,r=Ve.runTweenAsync(R(e.node).update(.8,(function(n,r){t.node.getWorldPosition(o);var l=z.quadOut(r),s=Se(i,o.x,l),u=Math.max(a,o.y),c=Se(a,u+300,.5);if(r<.5){var d=z.cubicOut(2*r),h=Se(a,c,d);e.node.setWorldPosition(s,h,0)}else{var p=z.cubicIn(2*(r-.5)),y=Se(c,o.y,p);e.node.setWorldPosition(s,y,0)}})));yield Promise.all([n,r])}))).apply(this,arguments)}function CT(e,t){return ET.apply(this,arguments)}function ET(){return(ET=o((function*(e,t){yield HT(e),yield Ve.waitTweenAsync(.8),yield qT(e,t),yield VT(e,t)}))).apply(this,arguments)}var AT,TT,PT,OT,LT,IT,RT,_T,DT,MT,NT,BT,FT,xT,zT,UT,GT,HT=function(e){return Ve.runTweenAsync(R(e.node).to(.1,{scale:fT}).to(.1,{scale:gT}).to(.1,{scale:V.ONE}))},qT=function(e,t){return Ve.runTweenAsync(R(e.node).to(1,{worldPosition:new V(t.node.worldPosition.x,t.node.worldPosition.y+30,t.node.worldPosition.z),scale:mT},{easing:"cubicInOut"}))},VT=function(e,t){var n=t.node.worldPosition.clone(),i=new V(n.x,n.y+70,n.z);return Ve.runTweenAsync(R(e.node).to(.3,{worldPosition:i,scale:bT},{easing:"cubicOut"}).to(.5,{worldPosition:n},{easing:"cubicIn"}))};S._RF.pop(),S._RF.push({},"da8a1SD+ahMFpc6MIdiFP5H","ShiningStar",void 0);var $T,WT,KT,jT,YT,XT=C.ccclass,JT=C.property,ZT=C.disallowMultiple,QT=(AT=XT("ShiningStar"),TT=JT(F),PT=JT({serializable:!0,visible:!1}),OT=JT({type:L,displayName:"Scale up duration",min:.001}),LT=JT({serializable:!0,visible:!1}),IT=JT({type:L,displayName:"Bounce and Fall duration",min:.001}),RT=JT({serializable:!0,visible:!1}),_T=JT({type:L,displayName:"Start scale"}),DT=JT({serializable:!0,visible:!1}),MT=JT({type:L,displayName:"End scale"}),AT(NT=ZT((FT=a((BT=function(a){n(f,a);var s,u,c,d,h,p,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),r(e,"shine",FT,l(e)),r(e,"twScaleUpDuration",xT,l(e)),r(e,"twBounceAndFallDuration",zT,l(e)),r(e,"twStartScale",UT,l(e)),r(e,"twEndScale",GT,l(e)),e.isBeingAnimated=!1,e}return e(f,[{key:"scaleUpDuration",get:function(){return this.twScaleUpDuration},set:function(e){this.twScaleUpDuration=e}},{key:"bounceAndFallDuration",get:function(){return this.twBounceAndFallDuration},set:function(e){this.twBounceAndFallDuration=e}},{key:"startScale",get:function(){return this.twStartScale},set:function(e){this.twStartScale=e}},{key:"endScale",get:function(){return this.twEndScale},set:function(e){this.twEndScale=e}},{key:"isAvailable",get:function(){return!this.isBeingAnimated}},{key:"__preload",value:function(){this.shineOpacity=this.shine.node.getComponent(B),this.uiOpacity=this.node.getComponent(B),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0}},{key:"playAnimation",value:(y=o((function*(){if(!this.isAvailable)throw new Error("ShiningStar: This star is being animated.");this.isBeingAnimated=!0,yield this.animateAppear(),yield this.animateDisappear(),this.isBeingAnimated=!1})),function(){return y.apply(this,arguments)})},{key:"animateAppear",value:(p=o((function*(){this.shineOpacity.opacity=255,yield Promise.all([this.animateFadeIn(),this.animateScaleUp()])})),function(){return p.apply(this,arguments)})},{key:"animateDisappear",value:(h=o((function*(){yield Promise.all([this.animateBounceAndFall(),this.animateScaleDown()]),this.node.setScale(0,0),this.uiOpacity.opacity=0})),function(){return h.apply(this,arguments)})},{key:"animateBounceAndFall",value:(d=o((function*(){var e=this.node.position.x,t=this.node.position.y,n=[60,120],i=(Math.random()*(n[1]-n[0])+n[0])*(Math.PI/180),a=e+200*Math.cos(i),o=t+200*Math.sin(i),r=t-500,l=Ve.runTweenAsync(R(this.node).to(.2*this.twBounceAndFallDuration,{position:new V(a,o,this.node.position.z)},{easing:"sineOut"}).to(.4*this.twBounceAndFallDuration,{position:new V(a,r,this.node.position.z)},{easing:"cubicIn"})),s=[0,360],u=Ve.runTweenAsync(R(this.node).to(this.twBounceAndFallDuration,{eulerAngles:new V(0,0,Math.random()*(s[1]-s[0])*(a>e?-1:1))},{easing:"sineOut"}));yield Promise.all([l,u]),this.node.eulerAngles=new V(0,0,0)})),function(){return d.apply(this,arguments)})},{key:"animateFadeIn",value:(c=o((function*(){var e=Math.max(this.scaleUpDuration/4,.01);yield Ve.runTweenAsync(R(this.uiOpacity).to(e,{opacity:255}))})),function(){return c.apply(this,arguments)})},{key:"animateScaleUp",value:(u=o((function*(){this.node.setScale(this.startScale,this.startScale);var e=new V(this.endScale,this.endScale,1);yield Ve.runTweenAsync(R(this.node).to(this.scaleUpDuration,{scale:e},{easing:"cubicOut"}))})),function(){return u.apply(this,arguments)})},{key:"animateScaleDown",value:(s=o((function*(){var e=new V(0,0,1);yield Ve.runTweenAsync(R(this.node).delay(.1*this.bounceAndFallDuration).to(.5*this.bounceAndFallDuration,{scale:e},{easing:"cubicIn"}))})),function(){return s.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),f}(T)).prototype,"shine",[TT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xT=a(BT.prototype,"twScaleUpDuration",[PT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(BT.prototype,"scaleUpDuration",[OT],Object.getOwnPropertyDescriptor(BT.prototype,"scaleUpDuration"),BT.prototype),zT=a(BT.prototype,"twBounceAndFallDuration",[LT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(BT.prototype,"bounceAndFallDuration",[IT],Object.getOwnPropertyDescriptor(BT.prototype,"bounceAndFallDuration"),BT.prototype),UT=a(BT.prototype,"twStartScale",[RT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(BT.prototype,"startScale",[_T],Object.getOwnPropertyDescriptor(BT.prototype,"startScale"),BT.prototype),GT=a(BT.prototype,"twEndScale",[DT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),a(BT.prototype,"endScale",[MT],Object.getOwnPropertyDescriptor(BT.prototype,"endScale"),BT.prototype),NT=BT))||NT)||NT);S._RF.pop(),S._RF.push({},"2e9aaj8L6lN1pTv2xGEj1sE","StarParticles",void 0);var eP=C.ccclass,tP=C.property,nP=C.disallowMultiple,iP=Ludex.Utils.Array,aP=($T=eP("StarParticles"),WT=tP({type:[QT],displayName:"Prebuilt Shining stars"}),$T(KT=nP((YT=a((jT=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"shiningStars",YT,l(e)),e}return e(c,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"fireShiningStarAt",value:(s=o((function*(e){var t=this.getFirstAvailableShiningStar();if(void 0===t)throw new Error("No available shining stars. Please add more prebuilt shining stars or calls this function later.");var n=v(e,2),i=n[0],a=n[1],o=new V(i,a,this.node.worldPosition.z);t.node.worldPosition=o,yield t.playAnimation()})),function(e){return s.apply(this,arguments)})},{key:"getFirstAvailableShiningStar",value:function(){return iP.search(this.shiningStars,(function(e){return e.isAvailable}))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),c}(T)).prototype,"shiningStars",[WT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),KT=jT))||KT)||KT);S._RF.pop(),S._RF.push({},"d10c8b8p8RD45oVz5qSL2LD","clampToBoundingBox",void 0);S._RF.pop(),S._RF.push({},"02e30BdQXxIEbItBFTh00UT","getClosestPair",void 0);var oP=function e(t){var n=uP(t);return function(i,a,o,r){if(o===r)return[i,a];if(o>r)return e(t)(i,a,r,o);var l=n(o,r);return l>=sP(i,t.length)(a[0],a[1])?[i,a]:[lP(i,t.length)(o,r,l),[o,r]]}},rP=function(e){return function(t,n){return t*(2*e-t-1)/2+(n-t-1)}},lP=function e(t,n){return function(i,a,o){if(i===a)return t;if(i>a)return e(t,n)(a,i,o);var r=rP(n)(i,a);return[].concat(g(t.slice(0,r)),[o],g(t.slice(r+1)))}},sP=function e(t,n){return function(i,a){var o;if(i===a)return 1/0;if(i>a)return e(t,n)(a,i);var r=rP(n)(i,a);return null!==(o=t[r])&&void 0!==o?o:1/0}},uP=function(e){return function(t,n){var i=e[t],a=e[n];return ae.distance(i,a)}};S._RF.pop(),S._RF.push({},"a70090n5pRBdIZb/GuW6wDs","toSortedIndices",void 0);var cP=Ludex.Utils.Array,dP=function(e,t){var n,i=e.map((function(e,t){return{data:e,index:t}}));return i.sort((function(e,n){return t(e.data,n.data)})),i.reduce((function(e,t,n){return e[t.index]=n,e}),(n=e.length,cP.fillWith(n,(function(){return 0}))))};S._RF.pop(),S._RF.push({},"56e87lhVSNJ8LMUzQpgUomc","randomSign",void 0);var hP,pP,yP,vP,fP,gP,mP,bP,wP,SP,kP,CP,EP,AP=function(){return Pe()>.5?1:-1};S._RF.pop(),S._RF.push({},"ce29fBj4hlOb5ZB/FQ77PpP","Ray",void 0);var TP,PP,OP,LP,IP,RP,_P,DP,MP,NP,BP,FP=C.ccclass,xP=C.property,zP=(hP=FP("Ray"),pP=Yn.required(),yP=xP(P),vP=Yn.required(),fP=xP(F),gP=xP({type:B}),mP=xP({type:L}),hP((SP=a((wP=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"uiTransform",SP,l(e)),r(e,"sprite",kP,l(e)),r(e,"uiOpacity",CP,l(e)),r(e,"widthOffset",EP,l(e)),e}return e(s,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,s)}}]),s}(T)).prototype,"uiTransform",[pP,yP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kP=a(wP.prototype,"sprite",[vP,fP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CP=a(wP.prototype,"uiOpacity",[gP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EP=a(wP.prototype,"widthOffset",[mP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),bP=wP))||bP);S._RF.pop(),S._RF.push({},"a20fagfOq5En6C68G/OaEAy","RayManagerProperties",void 0);var UP,GP,HP,qP,VP,$P,WP,KP,jP,YP,XP,JP,ZP,QP,eO=C.ccclass,tO=C.property,nO=(TP=eO("RayManagerProperties"),PP=tO({type:L}),OP=tO({type:L}),LP=tO({type:O,min:1}),IP=tO({type:L,min:0,max:1,slide:!0,step:.01}),TP((DP=a((_P=e((function e(){t(this,e),r(this,"thicknessStart",DP,this),r(this,"thicknessEnd",MP,this),r(this,"segments",NP,this),r(this,"jaggedness",BP,this)}))).prototype,"thicknessStart",[PP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),MP=a(_P.prototype,"thicknessEnd",[OP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),NP=a(_P.prototype,"segments",[LP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),BP=a(_P.prototype,"jaggedness",[IP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),RP=_P))||RP);S._RF.pop(),S._RF.push({},"19a4dTqUJdEXb8HsBhOcSyI","RayManager",void 0);var iO,aO,oO,rO,lO,sO,uO,cO,dO=C.ccclass,hO=C.property,pO=(UP=dO("RayManager"),GP=Yn.required(),HP=hO({type:fe}),qP=Yn.required(),VP=hO({type:B}),$P=Yn.required(),WP=hO({type:P}),KP=hO({type:nO}),UP((XP=a((YP=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"rayPrefab",XP,l(e)),r(e,"uiOpacity",JP,l(e)),r(e,"uiTransform",ZP,l(e)),r(e,"properties",QP,l(e)),e}return e(s,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,s),this.rayPool=yO(this.rayPrefab,this.node),this.rayPool=gO(this.rayPool,this.properties.segments)}},{key:"onEnable",value:function(){this.rayPool=gO(this.rayPool,this.properties.segments)}},{key:"onDestroy",value:function(){this.rayPool=wO(this.rayPool)}},{key:"createRayAnimation",value:function(e,t){var n=this,i=fO(this.rayPool,this.properties.segments),a=v(i,2),o=a[0],r=a[1];this.rayPool=r;var l=OO(t);return TO(this,o,e,l).call((function(){n.rayPool=bO(o,n.rayPool)}))}}]),s}(T)).prototype,"rayPrefab",[GP,HP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JP=a(YP.prototype,"uiOpacity",[qP,VP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZP=a(YP.prototype,"uiTransform",[$P,WP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QP=a(YP.prototype,"properties",[KP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new nO}}),jP=YP))||jP),yO=function(e,t){return{prefab:e,container:t,activeRays:[],inactiveRays:[]}},vO=function(e){var t;return null!==(t=SO(e))&&void 0!==t?t:kO(e)},fO=function(e,t){for(var n=[],i=e,a=0;a<t;a++){var o=vO(i),r=v(o,2),l=r[0],s=r[1];n.push(l),i=s}return[n,i]},gO=function(e,t){if(e.inactiveRays.length>=t)return e;for(var n=t-e.inactiveRays.length,i=e,a=0;a<n;a++){var o=kO(i),r=v(o,2),l=r[0],s=r[1];i=mO(l,s)}return i},mO=function(e,t){e.node.active=!1;var n=[].concat(g(t.inactiveRays),[e]),i=t.activeRays.filter((function(t){return t!==e}));return s(s({},t),{},{activeRays:i,inactiveRays:n})},bO=function(e,t){var n,i=u(e);try{for(i.s();!(n=i.n()).done;){n.value.node.active=!1}}catch(e){i.e(e)}finally{i.f()}var a=[].concat(g(t.inactiveRays),g(e)),o=t.activeRays.filter((function(t){return!e.includes(t)}));return s(s({},t),{},{activeRays:o,inactiveRays:a})},wO=function(e){e.container.destroyAllChildren();return s(s({},e),{},{activeRays:[],inactiveRays:[]})},SO=function(e){if(0!==e.inactiveRays.length){var t=b(e.inactiveRays),n=t[0],i=t.slice(1),a=n,o=[].concat(g(e.activeRays),[a]),r=i;return a.node.active=!0,[a,s(s({},e),{},{activeRays:o,inactiveRays:r})]}},kO=function(e){var t=ye(e.prefab);e.container.addChild(t);var n=t.getComponent(zP);if(!n)throw new Error("Ray component not found");var i=[].concat(g(e.activeRays),[n]);return n.node.active=!0,[n,s(s({},e),{},{activeRays:i})]},CO=function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=PO(e.properties.segments,e.uiTransform.height*e.node.worldScale.y,e.uiTransform.width*e.node.worldScale.x,e.properties.jaggedness),o={start:{x:0,y:0},end:{x:0,y:e.uiTransform.height*e.node.worldScale.y}},r={start:e.node.worldPosition,end:null!=n?n:{x:0,y:e.node.worldPosition.y+e.uiTransform.height*e.node.worldScale.y}},l=LO(o.start,o.end)(r.start,r.end),s=EO(),u=function(e,t,n){return s(e,l(t),l(n))},c={x:0,y:0},d=i,h=0;h<e.properties.segments;h++){var p=a(c,h,d),y=p.start,v=p.end,f=p.seed,g=AO(e,h/(e.properties.segments-1)),m=t[h],b=u(m,y,v);b.uiTransform.setContentSize(b.uiTransform.width,g),c=v,d=f}return t},EO=function(){var e={x:0,y:0};return function(t,n,i){var a=(n.x+i.x)/2,o=(n.y+i.y)/2;ae.subtract(e,i,n);var r=ae.len(e)/t.node.worldScale.x+t.widthOffset;ae.normalize(e,e);var l=180*Math.atan2(e.y,e.x)/Math.PI;return t.node.setWorldPosition(a,o,0),t.node.setRotationFromEuler(0,0,l),t.uiTransform.setContentSize(r,t.uiTransform.height),t}},AO=function(e,t){return Se(e.properties.thicknessStart,e.properties.thicknessEnd,t)},TO=function(e,t,n,i){var a,o=OO(i),r=OO(o);return(a=R(e.uiOpacity).call((function(){return CO(e,t,n,i)})).call((function(){var e,n=u(t);try{for(n.s();!(e=n.n()).done;){e.value.uiOpacity.opacity=255}}catch(e){n.e(e)}finally{n.f()}})).set({opacity:255}).delay(.05).set({opacity:0}).delay(.05).call((function(){return CO(e,t,n,o)})).set({opacity:255}).delay(.05).set({opacity:0}).delay(.05).call((function(){return CO(e,t,n,r)})).set({opacity:255})).parallel.apply(a,[R(e.uiOpacity).delay(.2).set({opacity:0}).call((function(){var e,n=u(t);try{for(n.s();!(e=n.n()).done;){e.value.uiOpacity.opacity=0}}catch(e){n.e(e)}finally{n.f()}}))].concat(g(t.map((function(t,n,i){return R(t.node).update(.2,(function(a,o){t.uiTransform.setContentSize(t.uiTransform.width,Se(AO(e,n/(i.length-1)),e.properties.thicknessEnd,z.cubicIn(o)))}))})))))},PO=function(e,t,n,i){return function(a,o,r){if(0===o)return{start:{x:0,y:0},end:{x:0,y:0},seed:r};if(o===e-1)return{start:{x:a.x,y:a.y},end:{x:0,y:t},seed:r};var l=OO(r),s=OO(l),u=a.x,c=a.y,d=(o-1)/(e-1),h=o/(e-1),p=Math.max(-n,Se(u,u-n,i)),y=Math.min(n,Se(u,u+n,i)),v=Re(s,p,y)*Se(1,0,h),f=Se(0,t,d),g=Se(0,t,h);return{start:{x:u,y:c},end:{x:v,y:Re(l,f,g)},seed:s}}},OO=function(e){return Re(null!=e?e:se(0,1e6),0,1e6)},LO=function(e,t){var n={x:t.x-e.x,y:t.y-e.y};return function(t,i){var a={x:i.x-t.x,y:i.y-t.y},o=Math.atan2(n.y,n.x),r=Math.atan2(a.y,a.x)-o,l=Math.cos(r),s=Math.sin(r),u=ae.len(a)/ae.len(n),c=t.x-e.x,d=t.y-e.y,h={x:0,y:0};return function(e){return h.x=e.x*l-e.y*s,h.y=e.x*s+e.y*l,h.x*=u,h.y*=u,h.x+=c,h.y+=d,{x:h.x,y:h.y}}}};S._RF.pop(),S._RF.push({},"a7ff8uVnP1G3ppM9F/A5DYq","Cloud",void 0);var IO,RO,_O,DO,MO,NO,BO,FO,xO,zO,UO,GO,HO,qO,VO,$O=C.ccclass,WO=C.property,KO=new V(0,300),jO=(iO=$O("Cloud"),aO=Yn.required(),oO=WO(ce),rO=WO({type:[pO]}),iO((uO=a((sO=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"animation",uO,l(e)),r(e,"rays",cO,l(e)),e.cachedCanvasUiTransform=null,e}return e(s,[{key:"canvas",get:function(){var e,t,n=null!==(e=this.cachedCanvasUiTransform)&&void 0!==e?e:null===(t=re("Canvas"))||void 0===t?void 0:t.getComponent(P);return _e(null!=n,"Cloud: canvasUiTransform is null"),n}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,s)}},{key:"getLightningTween",value:function(e){var t,n=this;return(t=R(this.node).call((function(){Ve.runAnimationAsync(n.animation)})).delay(.2)).parallel.apply(t,g(this.rays.map((function(t){return t.createRayAnimation(e)}))))}},{key:"getMoveToScreenTween",value:function(e,t){var n=this.canvas.width,i="left"===t?-300:n+300,a=R(this.node).set({worldPosition:new V(i,e.y)}).to(.6,{worldPosition:new V(e.x,e.y,0)},{easing:"quadOut"}),o=De(e.y<this.canvas.height/2?1.2:1.7-e.y/this.canvas.height,.7,2),r=R(this.node).set({scale:new V(1.1*o,.9*o,1)}).to(.6,{scale:new V(o,o,1)},{easing:"quadIn"});return R(this.node).parallel(a,r)}},{key:"getMoveOutScreenTween",value:function(e){var t=this,n=this.canvas,i=n.width,a=n.height,o=new V("left"===e?-i/2-300:i/2+300,this.node.position.y),r=new V(0,-a/2-500);return R(this.node).call((function(){o.set(o.x,t.node.position.y)})).to(.6,{position:function(){return o}},{easing:"quadIn"}).set({position:r})}},{key:"getMoveToScreenCenterTween",value:function(){var e=this.canvas,t=e.width,n=e.height,i=this.getRandomInitialPosition(t,n),a=i.x,o=i.y;return R(this.node).set({position:new V(a,o,0)}).to(.8,{position:KO},{easing:"quadOut"})}},{key:"getRandomInitialPosition",value:function(e,t){switch(se(0,4)){case 0:return{x:Math.random()*e-e/2,y:t/2+300};case 1:return{x:Math.random()*e-e/2,y:-t/2-300};case 2:return{x:-e/2-300,y:Math.random()*t-t/2};case 3:return{x:e/2+300,y:Math.random()*t-t/2}}}}]),s}(T)).prototype,"animation",[aO,oO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cO=a(sO.prototype,"rays",[rO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),lO=sO))||lO);S._RF.pop(),S._RF.push({},"e6e5eBLV4pKT6u5MYHNZfQd","CloudEffectProperties",void 0);var YO,XO,JO,ZO,QO,eL,tL=C.ccclass,nL=C.property,iL=(IO=tL("CloudEffectProperties"),RO=Yn.required(),_O=nL({group:{name:"Thunder Effect",style:"section"},type:q}),DO=Yn.required(),MO=nL({group:{name:"Thunder Effect",style:"section"},type:jO}),NO=Yn.required(),BO=nL({group:{name:"Thunder Effect",style:"section"},type:jO}),FO=Yn.required(),xO=nL({group:{name:"Thunder Effect",style:"section"},type:jO}),IO((GO=a((UO=e((function e(){t(this,e),r(this,"cloudContainer",GO,this),r(this,"cloud1",HO,this),r(this,"cloud2",qO,this),r(this,"cloud3",VO,this)}))).prototype,"cloudContainer",[RO,_O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HO=a(UO.prototype,"cloud1",[DO,MO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qO=a(UO.prototype,"cloud2",[NO,BO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VO=a(UO.prototype,"cloud3",[FO,xO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zO=UO))||zO);S._RF.pop(),S._RF.push({},"d716cluEdBCx5J3CuLcUQc6","CloudEffect",void 0);var aL,oL,rL,lL,sL,uL,cL,dL,hL,pL,yL,vL,fL,gL,mL,bL,wL,SL,kL,CL,EL,AL,TL,PL,OL,LL,IL,RL,_L,DL,ML,NL,BL,FL,xL,zL,UL,GL,HL,qL,VL,$L,WL,KL,jL,YL,XL,JL,ZL,QL,eI=C.ccclass,tI=C.property,nI=Ludex.Utils.Array,iI=(YO=eI("CloudEffect"),XO=Yn.required(),JO=tI({type:iL}),YO((eL=a((QO=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"properties",eL,l(e)),e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,d)}},{key:"onEnable",value:function(){var e,t=null===(e=re("Canvas"))||void 0===e?void 0:e.getComponent(P);_e(null!=t,"Canvas UI transform not found"),this.canvasUiTransform=t}},{key:"playThunderAnimations",value:(u=o((function*(e){var t,n=this,i=e.manager,a=e.pairs,o=e.board,r=a.flat(),l=[this.properties.cloud1,this.properties.cloud2,this.properties.cloud3],s=this.getSimpleCloudPositions(r,l),u=(t=R(this.node)).parallel.apply(t,g(s.map((function(e,t){return n.getCloudFxTween({manager:i,board:o,effect:e,delay:.1*t})}))));yield Ve.runTweenAsync(u)})),function(e){return u.apply(this,arguments)})},{key:"playMultiThunderAnimation",value:(s=o((function*(e){var t=e.manager,n=e.pairs,i=e.board,a=e.stagger,o=this.properties.cloud1;o.node.active=!0,yield Ve.runTweenAsync(o.getMoveToScreenCenterTween()),yield Ve.waitTweenAsync(.2),i.clear({pairs:n,stagger:a,lightning:!0});for(var r=[],l=0,s=2*n.length;l<s;l++){var u=n[Math.floor(l/2)];if(void 0!==u){var c=u[l%2];void 0!==c&&(0!==l&&l%2==0&&(t.node.scene.emit(Es.ADD_COMBO),t.node.scene.emit(Es.ADD_SCORE)),t.shakeGame(),t.shakeScreen(500),je.playSound(Qi.THUNDERBOLT),r.push(Ve.runTweenAsync(o.getLightningTween(c.node.worldPosition))),a&&(yield Ve.waitTweenAsync(a)))}}yield Promise.all(r),o.node.active=!1})),function(e){return s.apply(this,arguments)})},{key:"getSimpleCloudPositions",value:function(e,t){var n=function(e){if(e.length<2)throw new Error("Not enough points to find a closest pair");for(var t=e[0],n=e[1],i=[ae.distance(t,n)],a=[0,1],o=oP(e),r=0;r<e.length-1;r++)for(var l=r+1;l<e.length;l++){var s=o(i,a,r,l),u=v(s,2);i=u[0],a=u[1]}return a}([e[0].node.worldPosition,e[1].node.worldPosition,e[2].node.worldPosition,e[3].node.worldPosition]),i=nI.split(e,(function(e,t){return n.includes(t)})),a=i.left,o=i.right;_e(2===a.length,"Closest pair must have 2 tiles"),_e(2===o.length,"Other tiles must have 2 tiles");var r,l,s=a[0],u=a[1],c=o[0],d=o[1],h=c.node.worldPosition,p=d.node.worldPosition,y=(r=this.canvasUiTransform.getBoundingBoxToWorld(),l=100,function(e){return{x:Math.max(r.xMin+l,Math.min(r.xMax-l,e.x)),y:Math.max(r.yMin+l,Math.min(r.yMax-l,e.y))}}),f=Math.max(s.node.worldPosition.y,u.node.worldPosition.y)+he(150,200),g=h.y+he(150,200),m=p.y+he(150,200),b=(s.node.worldPosition.x+u.node.worldPosition.x)/2+he(50,100)*AP(),w=h.x+he(50,100)*AP(),S=p.x+he(50,100)*AP(),k=y({x:b,y:f}),C=y({x:w,y:g}),E=y({x:S,y:m}),A=dP([k,C,E],(function(e,t){return t.y-e.y}));return[{type:"multi-tile-cloud",cloud:t[A[0]],worldPosition:k,tiles:[s,u]},{type:"single-tile-cloud",clouds:[{cloud:t[A[1]],worldPosition:C,tile:c},{cloud:t[A[2]],worldPosition:E,tile:d}],tiles:[c,d]}]}},{key:"getCloudFxTween",value:function(e){return"multi-tile-cloud"===e.effect.type?this.getMultiTileCloudFxTween(e.effect,e):this.getSingleTileCloudFxTween(e.effect,e)}},{key:"getMultiTileCloudFxTween",value:function(e,t){var n=t.manager,i=t.board,a=t.delay,o=void 0===a?0:a;e.cloud.node.active=!0;var r=e.cloud.getMoveToScreenTween(e.worldPosition,"left"),l=R(this.node).delay(.4).call(this.clearTiles.bind(this,n,i,[e.tiles],.05)),s=R(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,e.tiles[0].node.worldPosition)),u=e.cloud.getLightningTween(e.tiles[0].node.worldPosition),c=e.cloud.getLightningTween(e.tiles[1].node.worldPosition),d=R(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,e.tiles[1].node.worldPosition)),h=R(this.node).parallel(u,s),p=R(this.node).delay(.3).parallel(c,d),y=e.cloud.getMoveOutScreenTween("left");return R(this.node).delay(o).then(r).parallel(l,h,p).then(y).call((function(){e.cloud.node.active=!1}))}},{key:"getSingleTileCloudFxTween",value:function(e,t){var n=t.manager,i=t.board,a=t.delay,o=void 0===a?0:a,r=e.clouds[0],l=e.clouds[1];r.cloud.node.active=!0,l.cloud.node.active=!0;var s=R(this.node).delay(.6).call(this.clearTiles.bind(this,n,i,[e.tiles],.1)),u=r.cloud.getMoveToScreenTween(r.worldPosition,"right"),c=r.cloud.getLightningTween(e.tiles[0].node.worldPosition).then(r.cloud.getMoveOutScreenTween("right")),d=R(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,r.tile.node.worldPosition)),h=R(this.node).delay(.1).then(l.cloud.getMoveToScreenTween(l.worldPosition,"left")),p=l.cloud.getLightningTween(e.tiles[1].node.worldPosition).then(l.cloud.getMoveOutScreenTween("left")),y=R(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,l.tile.node.worldPosition)),v=R(this.node).then(u).parallel(c,d).call((function(){r.cloud.node.active=!1})),f=R(this.node).then(h).parallel(p,y).call((function(){l.cloud.node.active=!1}));return R(this.node).delay(o).parallel(v,f,s)}},{key:"clearTiles",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.shakeGame(),e.shakeScreen(500),je.playSound(Qi.THUNDERBOLT),t.clear({pairs:n,stagger:i,lightning:!0,delay:1.5}),e.node.scene.emit(Es.ADD_COMBO),e.node.scene.emit(Es.ADD_SCORE)}}]),d}(T)).prototype,"properties",[XO,JO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new iL}}),ZO=QO))||ZO);S._RF.pop(),S._RF.push({},"2913d3KShhIEaPfSLUhFqvA","EffectManager",void 0);var aI=Ludex.Utils.Valid,oI=C.ccclass,rI=C.property,lI=codex.monitorError,sI=(aL=oI("EffectManager"),oL=Yn.required(),rL=rI({group:{name:"Thunder Effect",style:"section"},type:iI}),lL=Yn.required(),sL=rI({group:{name:"Mask Effect",style:"section"},type:qr}),uL=Yn.required(),cL=rI({group:{name:"Mask Effect",style:"section"},type:q}),dL=Yn.required(),hL=rI({group:{name:"Tornado Effect",style:"section"},type:q}),pL=Yn.required(),yL=rI({group:{name:"Clear Particle Effect",style:"section"},type:q,displayName:"Particle holder node"}),vL=Yn.required(),fL=rI({group:{name:"Clear Particle Effect",style:"section"},type:hT,displayName:"Emitter 1"}),gL=Yn.required(),mL=rI({group:{name:"Clear Particle Effect",style:"section"},type:hT,displayName:"Emitter 2"}),bL=Yn.required(),wL=rI({group:{name:"Star Particles Effect",style:"section"},type:aP}),SL=Yn.required(),kL=rI({group:{name:"Confetti Effect",style:"section"},type:hT}),CL=Yn.required(),EL=rI({group:{name:"Confetti Effect",style:"section"},type:hT}),AL=rI({group:{name:"Add Item Effect",style:"section"},type:vT}),TL=rI({group:{name:"Add Item Effect",style:"section"},type:ue}),PL=rI({group:{name:"Add Item Effect",style:"section"},type:ue}),OL=rI({group:{name:"Add Item Effect",style:"section"},type:ue}),LL=rI({group:{name:"Add Item Effect",style:"section"},type:ue}),IL=Yn.required(),RL=rI({type:q,displayName:"Clear Explosion Container",group:{name:"Clear Explosion Effect",style:"section"}}),_L=Yn.onlyRunInLifeCycle,DL=Yn.onlyRunInLifeCycleAsync,aL(((ZL=function(a){n(E,a);var s,c,d,h,p,y,f,g,m,b,w,S,k,C=i(E);function E(){var e;t(this,E);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=C.call.apply(C,[this].concat(i)),r(e,"cloudEffect",BL,l(e)),r(e,"backgroundMask",FL,l(e)),r(e,"masks",xL,l(e)),r(e,"tornadoContainer",zL,l(e)),r(e,"clearParticleHolder",UL,l(e)),r(e,"clearParticle1",GL,l(e)),r(e,"clearParticle2",HL,l(e)),r(e,"starParticle",qL,l(e)),r(e,"leftConfetti",VL,l(e)),r(e,"rightConfetti",$L,l(e)),r(e,"itemEffect",WL,l(e)),r(e,"hintSpriteFrame",KL,l(e)),r(e,"thunderSpriteFrame",jL,l(e)),r(e,"tornadoSpriteFrame",YL,l(e)),r(e,"pliersSpriteFrame",XL,l(e)),e.maskTargets=[],e.vibrate=null,e.gameShakeSignal=new Ni,r(e,"clearExplosionContainer",JL,l(e)),e}return e(E,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,E)}},{key:"onLoad",value:function(){this.clearParticleHolder.active=!1,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1}},{key:"update",value:function(){if(this.maskTargets.length>0)for(var e=0;e<this.maskTargets.length;e++){var t=this.maskTargets[e];if(!t.isHidden()){var n=this.masks[e];n&&n.setWorldPosition(t.node.worldPosition)}}}},{key:"onEnable",value:function(){this.node.scene.on(Es.GRID_RESIZE,this.handleBoardResize,this)}},{key:"onDisable",value:function(){this.node.scene.off(Es.GRID_RESIZE,this.handleBoardResize,this)}},{key:"handleBoardResize",value:function(e){if(this.clearParticleHolder.setScale(e,e),this.clearExplosionContainer.setScale(e,e),Ze.isLandscape()){var t=te.clamp(e,1,1.5);this.cloudEffect.node.setScale(t,t)}else this.cloudEffect.node.setScale(1,1)}},{key:"playClearEffectAt",value:function(e){var t=this,n=e[0],i=n.x,a=n.y,o=e[1],r=o.x,l=o.y,s=this.clearParticle1.node.worldPosition.z,u=this.clearParticle2.node.worldPosition.z;this.clearParticleHolder.active=!0,this.clearParticle1.node.setWorldPosition(i,a,s),this.clearParticle2.node.setWorldPosition(r,l,u),this.clearParticle1.play(),this.clearParticle2.play(),this.scheduleOnce((function(){t.clearParticleHolder.active=!1}),this.clearParticle1.duration)}},{key:"playStarEffectAt",value:function(e){this.starParticle.fireShiningStarAt(e)}},{key:"playConfettiEffect",value:function(){var e,t,n=this;null===(e=this.node.parent)||void 0===e||e.addChild(this.leftConfetti.node),this.rightConfetti.node.parent!==this.node.parent&&(null===(t=this.node.parent)||void 0===t||t.addChild(this.rightConfetti.node));var i=Ze.isLandscape(),a=i?50:30,o=i?5e3:2e3,r=i?15e3:1e4,l=i?40:60,s=i?110:100,u=i?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=a,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=o,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=r,this.leftConfetti.shapeModule.angle=l,this.rightConfetti.shapeModule.angle=s,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=u,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1,this.leftConfetti.play(),this.rightConfetti.play(),this.scheduleOnce((function(){n.leftConfetti.node.active=!1}),this.leftConfetti.duration),this.scheduleOnce((function(){n.rightConfetti.node.active=!1}),this.rightConfetti.duration)}},{key:"playTornadoAnimation",value:(k=o((function*(){var e=this,t=this.tornadoSpineNode.getComponent("sp.Skeleton");if(t)return new Promise((function(n){e.tornadoSpineNode.active=!0,t.setAnimation(0,"tornado_alone",!1),t.setCompleteListener((function(){n(),e.tornadoSpineNode.active=!1}))}))})),function(){return k.apply(this,arguments)})},{key:"playThunderAnimation",value:(S=o((function*(e,t){var n=this;this.resetMasks();var i=v(e,2),a=v(i[0],2),o=a[0],r=a[1],l=v(i[1],2),s=l[0],u=l[1];this.maskTargets=[o,r,s,u],this.maskTargets.forEach((function(e,t){n.setMaskProperties(t,e.node.worldPosition,e.node.worldScale)})),yield this.setBackgroundMaskActive(!0),yield this.cloudEffect.playThunderAnimations({manager:this,board:t,pairs:e}),this.setBackgroundMaskActive(!1)})),function(e,t){return S.apply(this,arguments)})},{key:"playItemAddAnimation",value:(w=o((function*(e,t,n){var i,a=null===(i=A.getScene())||void 0===i?void 0:i.getChildByName("Canvas");if(null!=a){var o=n.itemType;if(o){switch(this.itemEffect.node.active=!0,this.itemEffect.node.setParent(a),this.itemEffect.node.setWorldPosition(e,t,this.itemEffect.node.worldPosition.z),this.itemEffect.node.setScale(V.ONE),o){case nt.HINT:this.itemEffect.sprite.spriteFrame=this.hintSpriteFrame;break;case nt.THUNDER:this.itemEffect.sprite.spriteFrame=this.thunderSpriteFrame;break;case nt.STORM:this.itemEffect.sprite.spriteFrame=this.tornadoSpriteFrame;break;case nt.PLIERS:this.itemEffect.sprite.spriteFrame=this.pliersSpriteFrame}var r=E.FULL_ANIM_USED_ON_ADD_ITEM[o];E.FULL_ANIM_USED_ON_ADD_ITEM[o]=!0,yield wT(this.itemEffect,n,r),this.itemEffect.node.active=!1}}})),function(e,t,n){return w.apply(this,arguments)})},{key:"playMultiThunderAnimation",value:(b=o((function*(e,t,n){this.resetMasks(),yield this.cloudEffect.playMultiThunderAnimation({manager:this,pairs:e,board:t,stagger:n}),yield this.setBackgroundMaskActive(!1)})),function(e,t,n){return b.apply(this,arguments)})},{key:"shakeScreen",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.vibrate=null!==(e=this.vibrate)&&void 0!==e?e:this.node.getComponent(fy),null===(t=this.vibrate)||void 0===t||t.vibrate(n)}},{key:"preloadEffects",value:function(){this.loadDefuseExplosionPool(),this.loadBombExplosionPool(),this.loadClearExplosionPool(),this.loadTornadoSpine()}},{key:"loadDefuseExplosionPool",value:(m=o((function*(){if(this.defuseExplosionPool)return this.defuseExplosionPool;var e=yield qe.loadPrefabAsync(it.BOMB_DEFUSE_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.defuseExplosionPool=function(e,t){return new Tb((function(){var n=ye(e),i=n.getComponent(ce);if(!i)throw new Error("DefuseExplosion: No animation component found in bombDefuseExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.node),this.defuseExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createDefuseExplosionAt")}})),function(){return m.apply(this,arguments)})},{key:"loadBombExplosionPool",value:(g=o((function*(){if(this.bombExplosionPool)return this.bombExplosionPool;var e=yield qe.loadPrefabAsync(it.BOMB_EXPLODE_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.bombExplosionPool=function(e,t){return new Tb((function(){var n=ye(e),i=n.getComponent(ce);if(!i)throw new Error("BombExplosion: No animation component found in bombExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.node),this.bombExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createBombExplosionAt")}})),function(){return g.apply(this,arguments)})},{key:"loadClearExplosionPool",value:(f=o((function*(){if(this.clearExplosionPool)return this.clearExplosionPool;var e=yield qe.loadPrefabAsync(it.CLEAR_EXPLOSION_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.clearExplosionPool=function(e,t){return new Tb((function(){var n=ye(e),i=n.getComponent(P),a=n.getComponent(ce);if(!i||!a)throw new Error("ClearExplosion: Invalid prefab");return t.addChild(n),n.active=!1,{node:n,uiTransform:i,animation:a}}),2,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.clearExplosionContainer),this.clearExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createClearExplosionAt")}})),function(){return f.apply(this,arguments)})},{key:"loadTornadoSpine",value:(y=o((function*(){var e=yield qe.loadPrefabAsync(it.TORNADO_SPINE_PREFAB);if(this.isValid&&this.node.activeInHierarchy)if(null!==e){var t=ye(e);t.active=!1,this.tornadoContainer.addChild(t),this.tornadoSpineNode=t}else this.reportOrThrowInDebugger("Failed to load prefab","loadTornadoSpine")})),function(){return y.apply(this,arguments)})},{key:"createDefuseExplosionAt",value:(p=o((function*(e,t){var n=yield this.loadDefuseExplosionPool();if(n){var i=n.alloc(),a=i.node,o=i.animation;a.setWorldPosition(e,t,0),yield Ve.runAnimationAsync(o),n.free(i)}})),function(e,t){return p.apply(this,arguments)})},{key:"createBombExplosionAt",value:(h=o((function*(e){var t=yield this.loadBombExplosionPool();if(t){var n=t.alloc(),i=n.node,a=n.animation;i.setWorldPosition(e),yield Ve.runAnimationAsync(a),t.free(n)}})),function(e){return h.apply(this,arguments)})},{key:"createClearExplosionAt",value:(d=o((function*(e){var t,n=yield this.loadClearExplosionPool();if(n){var i=n.alloc(),a=i.node,o=i.animation;a.setWorldPosition(e),null===(t=a.getComponentInChildren(hT))||void 0===t||t.play(),yield Ve.runAnimationAsync(o),n.free(i)}})),function(e){return d.apply(this,arguments)})},{key:"setBackgroundMaskActive",value:(c=o((function*(e){yield this.backgroundMask.changeStateFade(e,.25)})),function(e){return c.apply(this,arguments)})},{key:"resetMasks",value:function(){var e,t=u(this.masks);try{for(t.s();!(e=t.n()).done;){e.value.worldPosition=new V(-9999,-9999,0)}}catch(e){t.e(e)}finally{t.f()}}},{key:"setMaskProperties",value:function(e,t,n){var i=this.masks[e];i&&(n&&(i.worldScale=n),i.worldPosition=t)}},{key:"shakeGame",value:(s=o((function*(){var e=this;this.gameShakeSignal.abort();var t=new Ni;this.gameShakeSignal=t;var n=this.node.position.clone(),i=he(-10,10),a=he(-10,10),o=n.clone().add3f(i,a,0),r=n.clone().add3f(-i,-a,0),l=R(this.node).to(.05,{position:o}).to(.05,{position:r}).to(.05,{position:n}),s=function(){return e.node.setPosition(n)};t.addAbortListener(s),yield Ve.runTweenAsync(l,t),t.removeAbortListener(s)})),function(){return s.apply(this,arguments)})},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if(aI.isDebugger())throw n;null==lI||lI.sendException(n)}}]),E}(T)).FULL_ANIM_USED_ON_ADD_ITEM=(m(QL={},nt.HINT,!1),m(QL,nt.THUNDER,!1),m(QL,nt.STORM,!1),m(QL,nt.PLIERS,!1),QL),BL=a((NL=ZL).prototype,"cloudEffect",[oL,rL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FL=a(NL.prototype,"backgroundMask",[lL,sL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xL=a(NL.prototype,"masks",[uL,cL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zL=a(NL.prototype,"tornadoContainer",[dL,hL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UL=a(NL.prototype,"clearParticleHolder",[pL,yL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GL=a(NL.prototype,"clearParticle1",[vL,fL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HL=a(NL.prototype,"clearParticle2",[gL,mL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qL=a(NL.prototype,"starParticle",[bL,wL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VL=a(NL.prototype,"leftConfetti",[SL,kL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$L=a(NL.prototype,"rightConfetti",[CL,EL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WL=a(NL.prototype,"itemEffect",[AL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KL=a(NL.prototype,"hintSpriteFrame",[TL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jL=a(NL.prototype,"thunderSpriteFrame",[PL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YL=a(NL.prototype,"tornadoSpriteFrame",[OL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XL=a(NL.prototype,"pliersSpriteFrame",[LL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JL=a(NL.prototype,"clearExplosionContainer",[IL,RL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(NL.prototype,"shakeScreen",[_L],Object.getOwnPropertyDescriptor(NL.prototype,"shakeScreen"),NL.prototype),a(NL.prototype,"shakeGame",[DL],Object.getOwnPropertyDescriptor(NL.prototype,"shakeGame"),NL.prototype),ML=NL))||ML);S._RF.pop(),S._RF.push({},"062f3AVHntKsIyireZmXg9P","GuideKeys",void 0);var uI="newbie",cI="timer",dI="combo",hI="hint-item",pI="thunder-item",yI="storm-item",vI="pliers-item",fI="custom-mode";S._RF.pop(),S._RF.push({},"6448denZfFEUru9tWmWGb7N","Guide01Newbie",void 0);var gI=function(){function n(e){var i=this;t(this,n),this.alignSkipButton=function(){var e=i.gameplay.board,t=i.manager.guideUi.guideSkipButton;if(t){var n=t.parent;if(n){var a=e.getBoundingBoxWorld(),o=a.yMax,r=a.xMax,l=We.cssSizeToWorldSize(We.getScreenHeightCss()),s=r-n.getComponent(P).width/2,u=Math.min(o+100,o+(l-o)/2);n.setWorldPosition(s,u,0)}}},this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:function(){this.currentStep=0,this.manager.node.scene.on(Es.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.on(Es.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.on(Es.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.on(P.EventType.SIZE_CHANGED,this.alignSkipButton,this),this.showStep(this.currentStep),this.manager.node.scene.emit(Es.HIDE_UI)}},{key:"showNextStep",value:function(){this.currentStep+1<Jg.length?(this.currentStep+=1,this.showStep(this.currentStep)):this.close()}},{key:"showStep",value:(a=o((function*(e){var t=Jg[e];if(t){var n=this.gameplay,i=n.board,a=n.effectManager,o=t.startTile,r=t.endTile,l=i.getTileAt(o.x,o.y),s=i.getTileAt(r.x,r.y);if(l&&s){var u=l.node.worldPosition,c=s.node.worldPosition;a.resetMasks(),a.setMaskProperties(0,u,l.node.worldScale),a.setMaskProperties(1,c,s.node.worldScale),a.setBackgroundMaskActive(!0);var d=this.manager.guideUi,h=d.guideHand,p=d.guideTextBox,y=d.guideSkipButton;h.node.active=!0,y.active=!0,h.playHandAnimation(u,c),this.alignGuideTextBox(),this.alignSkipButton(),yield p.hide(),p.setLocalizedText(t.localeTextKey),yield p.show(),i.setIgnoreInput(!0),l.setIgnoreInput(!1),s.setIgnoreInput(!1),this.gameplay.comboManager.setEmitEvent(!1)}}})),function(e){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=Jg[this.currentStep];if(e){var t=this.gameplay,n=t.board,i=t.effectManager,a=e.startTile,o=e.endTile,r=n.getTileAt(a.x,a.y),l=n.getTileAt(o.x,o.y);if(r&&l){var s=r.node.worldPosition,u=l.node.worldPosition;i.setMaskProperties(0,s,r.node.worldScale),i.setMaskProperties(1,u,l.node.worldScale),this.alignGuideTextBox(),this.alignSkipButton()}}}},{key:"alignGuideTextBox",value:function(){var e=this.gameplay.board,t=this.manager.guideUi.guideTextBox,n=e.getBoundingBoxWorld(),i=n.width,a=n.yMin,o=n.center.x,r=t.widget.bottom+(a-t.widget.bottom)/2;t.node.setWorldPosition(o,r,0);var l=Math.max(Math.min(223,.85*(a-t.widget.bottom)),10);t.uiTransform.setContentSize(i,l)}},{key:"close",value:(i=o((function*(){var e=this.gameplay,t=e.board,n=e.effectManager;this.manager.node.scene.off(Es.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.off(Es.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.off(Es.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.off(P.EventType.SIZE_CHANGED,this.alignSkipButton,this),t.setIgnoreInput(!1),yield Promise.all([this.manager.guideUi.guideTextBox.hide(),n.setBackgroundMaskActive(!1)]),this.manager.guideUi.guideHand.node.active=!1,this.manager.completeGuide(uI)})),function(){return i.apply(this,arguments)})}]),n}();S._RF.pop(),S._RF.push({},"a52daB3sGxP8JyGBZo5K1+X","Guide02Timer",void 0);var mI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;yield this.gameplay.handleShowUI(),t.node.active=!0,n.node.active=!0,i.key="guide.timer",n.horizontalAlign=Me.CENTER,n.getComponent(P).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this)})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.currentLayout.clock,a=i.getComponent(P).contentSize,o=a.width,r=a.height,l=i.node.worldPosition,s=Ze.isPortrait()?l.y-r/2-50:l.y+r/2+70;o*=1.5,r*=1.5,t.setOtherMaskTransform(l.x,l.y,o,r),n.node.setWorldPosition(l.x,s,0)}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideInfoText,n=e.guideMasks;this.gameplay.comboManager.setEmitEvent(!0),this.gameplay.stateManager.isPlaying()&&this.manager.node.scene.emit(Es.RESUME_TIME),yield n.hide(),t.node.active=!1,this.manager.completeGuide(cI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"add56o6JFNHAZiCO6F+Z9jK","Guide03Combo",void 0);var bI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;t.node.active=!0,n.node.active=!0,i.key="guide.combo",n.horizontalAlign=Me.RIGHT,n.getComponent(P).setAnchorPoint(1,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this)})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.comboContainer,a=i.getComponent(P).contentSize,o=a.width,r=a.height,l=1.5*i.node.scale.x,s=i.node.worldPosition;o*=l,r*=l,t.setOtherMaskTransform(s.x,s.y,o,r),n.node.setWorldPosition(s.x-o/2-10,s.y,0)}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText;this.manager.node.scene.emit(Es.RESUME_TIME),t.node.off(q.EventType.TOUCH_START,this.close,this),yield t.hide(),n.node.active=!1,this.manager.completeGuide(dI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"fd93d+WLXVHk4yJGmVeSjmR","Guide04Hint",void 0);var wI=Ludex.Utils.Array,SI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;wI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.HINT}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.hint",n.horizontalAlign=Me.CENTER,n.getComponent(P).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Es.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=wI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.HINT}));if(a){var o=a.node.worldPosition,r=a.getComponent(P).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),Ze.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(Ze.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new V(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Es.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(hI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Es.USE_ITEM,nt.HINT),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Es.ITEM_MASK_CLICKED,this.useItem,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"b08f4dC/r1EPbsfAe1wtcBg","Guide05Thunder",void 0);var kI=Ludex.Utils.Array,CI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;kI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.THUNDER}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.thunder",n.horizontalAlign=Me.CENTER,n.getComponent(P).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Es.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=kI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.THUNDER}));if(a){var o=a.node.worldPosition,r=a.getComponent(P).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),Ze.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(Ze.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new V(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Es.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(pI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Es.USE_ITEM,nt.THUNDER),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Es.ITEM_MASK_CLICKED,this.useItem,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"f4ef8MBZxxKC4bfuDzsLQ5X","Guide06Storm",void 0);var EI=Ludex.Utils.Array,AI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;EI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.STORM}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.storm",n.horizontalAlign=Me.CENTER,n.getComponent(P).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Es.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=EI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.STORM}));if(a){var o=a.node.worldPosition,r=a.getComponent(P).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),Ze.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(Ze.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new V(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Es.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(yI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Es.USE_ITEM,nt.STORM),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Es.ITEM_MASK_CLICKED,this.useItem,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"9920dDqYP9ITJp0bSlZ+K9R","Guide07Pliers",void 0);var TI,PI,OI,LI,II,RI,_I,DI,MI,NI=Ludex.Utils.Array,BI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;NI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.PLIERS}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.pliers",n.horizontalAlign=Me.CENTER,n.getComponent(P).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Es.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Es.PAUSE_TIME),D.on($e.VIEW_RESIZED,this.handleViewResized,this),D.on($e.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=NI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===nt.PLIERS}));if(a){var o=a.node.worldPosition,r=a.getComponent(P).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),Ze.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(Ze.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new V(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Es.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(vI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Es.USE_ITEM,nt.PLIERS),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Es.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Es.ITEM_MASK_CLICKED,this.useItem,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this),D.off($e.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();S._RF.pop(),S._RF.push({},"8ab11Ocp6VMg5ZkRHXv4Odu","GuideHand",void 0);var FI,xI=C.ccclass,zI=C.property,UI=(TI=xI("GuideHand"),PI=zI(q),OI=zI(q),LI=zI(B),TI((_I=a((RI=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"hand",_I,l(e)),r(e,"circleHighlight",DI,l(e)),r(e,"circleHighlightOpacity",MI,l(e)),e}return e(s,[{key:"start",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255}},{key:"playHandAnimation",value:function(e,t){var n=this;this.handTween&&this.handTween.stop();var i=R(this.hand).to(.8,{worldPosition:t},{easing:"quartOut"}).to(.2,{scale:new V(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:V.ONE,angle:0}).to(.8,{worldPosition:e},{easing:"quartOut"}).to(.2,{scale:new V(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:V.ONE,angle:0});this.handTween=R(this.hand).repeatForever(i).start()}},{key:"playHighlightAnimation",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255,this.circleHighlight.position=this.hand.position.clone(),R(this.circleHighlight).to(.6,{scale:new V(1.5,1.5)},{easing:"quadOut"}).start(),R(this.circleHighlightOpacity).to(.6,{opacity:0},{easing:"quadIn"}).start()}}]),s}(T)).prototype,"hand",[PI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DI=a(RI.prototype,"circleHighlight",[OI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MI=a(RI.prototype,"circleHighlightOpacity",[LI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),II=RI))||II);S._RF.pop(),S._RF.push({},"763fe/xz6FAU5qOW2sRJ//R","GuideItemButton",void 0);var GI,HI,qI,VI,$I,WI,KI,jI=(0,C.ccclass)("GuideItemButton")(FI=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.uiTransform=this.node.getComponent(P)}},{key:"setTransform",value:function(e,t,n,i){this.node.setWorldPosition(e,t,0),this.uiTransform.setContentSize(n,i)}},{key:"onClick",value:function(){this.node.scene.emit(Es.ITEM_MASK_CLICKED)}}]),r}(T))||FI;S._RF.pop(),S._RF.push({},"b2213ccDllApaGIouur6a6b","GameMask",void 0);var YI,XI,JI,ZI,QI,eR,tR,nR,iR=C.ccclass,aR=C.property,oR=(GI=iR("GameMask"),HI=aR(P),qI=aR(F),GI((WI=a(($I=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"uiTransform",WI,l(e)),r(e,"sprite",KI,l(e)),e}return e(s,[{key:"texture",get:function(){return this.sprite.spriteFrame.texture}}]),s}(T)).prototype,"uiTransform",[HI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KI=a($I.prototype,"sprite",[qI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VI=$I))||VI);S._RF.pop(),S._RF.push({},"ad9c7KiarJHXpRRfn9GOaVx","AlphaMasks",void 0);var rR,lR,sR,uR,cR,dR,hR,pR,yR,vR=C.ccclass,fR=C.property,gR=C.executeInEditMode,mR=(YI=vR("AlphaMasks"),XI=gR(!0),JI=fR(oR),ZI=Yn.required(),YI(QI=XI((tR=a((eR=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"masks",tR,l(e)),r(e,"UITransform",nR,l(e)),e}return e(s,[{key:"__preload",value:function(){this.UITransform=this.node.getComponent(P)}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"start",value:function(){var e,t;this.material=null===(e=this.getComponent(F))||void 0===e?void 0:e.getMaterialInstance(0),console.log("Alphamasks",this.masks,null===(t=this.node.parent)||void 0===t?void 0:t.name);for(var n=0;n<this.masks.length;n++){var i=this.masks[n];i&&(console.log("mask",i.texture),this.material.setProperty("mask".concat(n,"Texture"),i.texture))}}},{key:"update",value:function(){var e=this;if(this.material){var t=this.UITransform,n=t.width,i=t.height;this.masks.forEach((function(t,a){var o=t.uiTransform,r=o.width,l=o.height,s=o.anchorX,u=o.anchorY,c=r*t.node.scale.x,d=l*t.node.scale.y,h=new ae(c/n,d/i),p=new ae(.5+(.5-s)*h.x,.5-(.5-u)*h.y),y=new ae(p.x+(t.node.worldPosition.x-e.node.worldPosition.x)/n,p.y-(t.node.worldPosition.y-e.node.worldPosition.y)/i);e.material.setProperty("ratio".concat(a),h),e.material.setProperty("center".concat(a),y)}))}}},{key:"setMaskActive",value:function(e,t){e>=this.masks.length||!this.material||this.material.setProperty("useMask".concat(e),t?1:0)}}]),s}(T)).prototype,"masks",[JI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nR=a(eR.prototype,"UITransform",[ZI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QI=eR))||QI)||QI);S._RF.pop(),S._RF.push({},"69569cXv55L852IkWTL0swz","GuideMasks",void 0);var bR,wR,SR,kR,CR,ER,AR,TR,PR,OR,LR,IR,RR,_R,DR,MR,NR,BR,FR=C.ccclass,xR=C.property,zR=(rR=FR("GuideMasks"),lR=xR(qr),sR=xR(mR),uR=xR(G),rR((hR=a((dR=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"background",hR,l(e)),r(e,"alphaMasks",pR,l(e)),r(e,"maskButtonComponent",yR,l(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(u=o((function*(){this.maskButtonComponent.enabled=!0,yield this.background.changeStateFade(!0,.25)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(s=o((function*(){this.maskButtonComponent.enabled=!1,yield this.background.changeStateFade(!1,.25)})),function(){return s.apply(this,arguments)})},{key:"onClick",value:function(){this.node.scene.emit(Es.GUIDE_MASK_CLICKED)}},{key:"setOtherMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[1].node.worldPosition=new V(-9999,-9999,0);var a=this.alphaMasks.masks[0];this.setMaskTransform(a,e,t,n,i)}},{key:"setItemMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[0].node.worldPosition=new V(-9999,-9999,0);var a=this.alphaMasks.masks[1];this.setMaskTransform(a,e,t,n,i)}},{key:"setMaskTransform",value:function(e,t,n,i,a){e.uiTransform.setContentSize(i,a),e.node.setWorldPosition(t,n,0)}}]),d}(T)).prototype,"background",[lR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pR=a(dR.prototype,"alphaMasks",[sR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yR=a(dR.prototype,"maskButtonComponent",[uR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cR=dR))||cR);S._RF.pop(),S._RF.push({},"abfb9zudJhHdZfeUgbnBrs0","GuideTextBox",void 0);var UR,GR,HR,qR,VR,$R,WR,KR,jR,YR,XR,JR,ZR,QR,e_,t_,n_,i_,a_,o_,r_,l_,s_,u_,c_=C.ccclass,d_=C.property,h_=(bR=c_("GuideTextBox"),wR=Yn.required(),SR=d_(K),kR=Yn.required(),CR=d_(I),ER=Yn.required(),AR=d_(P),TR=Yn.required(),PR=d_(qr),OR=Yn.required(),LR=d_(th),bR((_R=a((RR=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"guideText",_R,l(e)),r(e,"widget",DR,l(e)),r(e,"uiTransform",MR,l(e)),r(e,"opacityToggler",NR,l(e)),r(e,"localizer",BR,l(e)),e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}},{key:"setLocalizedText",value:function(e){this.localizer.key=e}},{key:"show",value:(u=o((function*(){yield this.opacityToggler.changeStateFade(!0)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(s=o((function*(){yield this.opacityToggler.changeStateFade(!1)})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"guideText",[wR,SR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DR=a(RR.prototype,"widget",[kR,CR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MR=a(RR.prototype,"uiTransform",[ER,AR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NR=a(RR.prototype,"opacityToggler",[TR,PR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BR=a(RR.prototype,"localizer",[OR,LR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IR=RR))||IR);S._RF.pop(),S._RF.push({},"a2522Y5Q6JGSr90yCp/4qCm","GuideUI",void 0);var p_,y_,v_,f_,g_,m_=C.ccclass,b_=C.property,w_=(UR=m_("GuideUI"),GR=Yn.required(),HR=b_(UI),qR=Yn.required(),VR=b_(h_),$R=Yn.required(),WR=b_(K),KR=Yn.required(),jR=b_(th),YR=Yn.required(),XR=b_(zR),JR=Yn.required(),ZR=b_(q),QR=Yn.required(),e_=b_(jI),UR((i_=a((n_=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"guideHand",i_,l(e)),r(e,"guideTextBox",a_,l(e)),r(e,"guideInfoText",o_,l(e)),r(e,"guideInfoTextLocalizer",r_,l(e)),r(e,"guideMasks",l_,l(e)),r(e,"guideSkipButton",s_,l(e)),r(e,"guideItemButton",u_,l(e)),e}return e(s,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}}]),s}(T)).prototype,"guideHand",[GR,HR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a_=a(n_.prototype,"guideTextBox",[qR,VR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o_=a(n_.prototype,"guideInfoText",[$R,WR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r_=a(n_.prototype,"guideInfoTextLocalizer",[KR,jR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l_=a(n_.prototype,"guideMasks",[YR,XR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=a(n_.prototype,"guideSkipButton",[JR,ZR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u_=a(n_.prototype,"guideItemButton",[QR,e_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t_=n_))||t_);S._RF.pop(),S._RF.push({},"4d800jyvxFJIYnkeNGud6KJ","GuidelinesManager",void 0);var S_=codex,k_=S_.player,C_=S_.analytics,E_=C.ccclass,A_=C.property,T_=Ludex,P_=T_.Match.Modes,O_=T_.Plugins.Analytics,L_=(void 0===O_?{}:O_).Events,I_=T_.Utils.Array,R_=new ae(0,10),__=new ae(0,10),D_="READY",M_="RUNNING",N_=(p_=E_("GuidelinesManager"),y_=A_(w_),p_((g_=a((f_=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"guideUi",g_,l(e)),e.guideHintDelay=null,e.guideStormDelay=null,e}return e(c,[{key:"init",value:function(e){this.gameplay=e,this.status=D_,this.node.scene.on(Es.COMBO_UPDATED,this.startComboGuide,this),this.node.scene.on(Es.TILE_CLICK,this.startAutoGuides,this),this.node.scene.on(Es.USE_ITEM,this.handleUseItem,this),this.node.scene.on(Es.GAME_FINISH,this.stopAutoGuides,this),this.node.scene.on(Es.GAME_REPLAY,this.stopAutoGuides,this),this.node.scene.on(Es.GAME_PAUSE,this.stopAutoGuides,this)}},{key:"show",value:function(){this.isNewbieGuideLevel()?(this.hasGuideItemShowed(uI)&&this.resetGuideItemShowed(),this.startGuide(uI)):this.startGuide(cI)}},{key:"startGuide",value:function(e){if(this.status===M_)return!1;if(this.hasGuideItemShowed(e))return!1;switch(this.addGuideItemShowed(e),this.status=M_,e){case uI:L_&&C_.event(L_.TUTORIAL_BEGIN),this.guide1=new gI(this),this.guide1.setup();break;case cI:this.guide2=new mI(this),this.guide2.setup();break;case dI:this.guide3=new bI(this),this.guide3.setup();break;case hI:this.guide4=new SI(this),this.guide4.setup();break;case pI:this.guide5=new CI(this),this.guide5.setup();break;case yI:this.guide6=new AI(this),this.guide6.setup();break;case vI:this.guide7=new BI(this),this.guide7.setup()}return!0}},{key:"completeGuide",value:function(e){L_&&C_.event(L_.TUTORIAL_STEP,{step:e}),this.status=D_,this.addGuideItemShowed(e),this.gameplay.stateManager.isPlaying()&&this.startAutoGuides()}},{key:"isHintGuideLevel",value:function(){var e=this.getCurrentLevel(),t=R_.x,n=R_.y;return e>=t&&e<=n}},{key:"isShowErrorPathLevel",value:function(){if(iv.getMatchMode()===P_.TOURNAMENT)return!1;var e=this.getCurrentLevel(),t=__.x,n=__.y;return e>=t&&e<=n}},{key:"isNewbieGuideLevel",value:function(){return 0===this.getCurrentLevel()}},{key:"hasGuideItemShowed",value:function(e){return I_.has(this.getGuideItemShowed(),e)}},{key:"addGuideItemShowed",value:function(e){if(!this.hasGuideItemShowed(e)){var t=this.getGuideItemShowed();t.push(e),k_.setGameData({guideItemShowed:t})}}},{key:"resetGuideItemShowed",value:function(){k_.setGameData({guideItemShowed:[]})}},{key:"getGuideItemShowed",value:function(){var e,t;return null!==(e=null===(t=k_.getGameData())||void 0===t?void 0:t.guideItemShowed)&&void 0!==e?e:[]}},{key:"getCurrentLevel",value:function(){return this.gameplay.levelManager.getLevelData().level}},{key:"startComboGuide",value:function(e){this.isNewbieGuideLevel()||e<2||(this.startGuide(dI),this.node.scene.off(Es.COMBO_UPDATED,this.startComboGuide,this))}},{key:"startAutoGuides",value:function(){this.startHintGuide(),this.startStormGuide()}},{key:"stopAutoGuides",value:function(){null!==this.guideHintDelay&&this.guideHintDelay.stop(),null!==this.guideStormDelay&&this.guideStormDelay.stop()}},{key:"startHintGuide",value:function(){var e=this;this.isHintGuideLevel()&&(null===this.guideHintDelay&&(this.guideHintDelay=R(this.node).delay(5).call((function(){e.isNewbieGuideLevel()||(e.hasGuideItemShowed(hI)&&e.status===D_?e.node.scene.emit(Es.SHOW_HINT):e.startGuide(hI),e.startHintGuide())}))),this.guideHintDelay.stop(),this.guideHintDelay.start())}},{key:"startStormGuide",value:function(){var e=this;null===this.guideStormDelay&&(this.guideStormDelay=new Ne(this.node).delay(10).call((function(){e.isNewbieGuideLevel()||e.hasGuideItemShowed(yI)||e.gameplay.itemManager.canUseItem(nt.STORM)&&(e.startGuide(yI)||e.startStormGuide())}))),this.guideStormDelay.stop(),this.guideStormDelay.start()}},{key:"startThunderGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(pI)}},{key:"startPliersGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(vI)}},{key:"handleUseItem",value:function(e){switch(this.startAutoGuides(),e){case nt.HINT:this.addGuideItemShowed(hI);break;case nt.THUNDER:this.addGuideItemShowed(pI);break;case nt.STORM:this.addGuideItemShowed(yI);break;case nt.PLIERS:this.addGuideItemShowed(vI)}}},{key:"skipNewbieGuide",value:(s=o((function*(){this.guideUi.guideSkipButton.active=!1,yield this.guide1.close();var e=this.getCurrentLevel()+1;k_.setGameData({level:e}),this.node.scene.emit(Es.NEXT_LEVEL)})),function(){return s.apply(this,arguments)})},{key:"onDestroy",value:function(){var e,t,n,i,a,o;null===(e=this.guide2)||void 0===e||e.unlistenEvents(),null===(t=this.guide3)||void 0===t||t.unlistenEvents(),null===(n=this.guide4)||void 0===n||n.unlistenEvents(),null===(i=this.guide5)||void 0===i||i.unlistenEvents(),null===(a=this.guide6)||void 0===a||a.unlistenEvents(),null===(o=this.guide7)||void 0===o||o.unlistenEvents()}}]),c}(T)).prototype,"guideUi",[y_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v_=f_))||v_);S._RF.pop(),S._RF.push({},"aa973zMvtZFD6GO7rUb6TBF","canUseHintItem",void 0);S._RF.pop(),S._RF.push({},"f3464SQfFhIs5PVRx8JpCO1","canUsePliersItem",void 0);S._RF.pop(),S._RF.push({},"ad5b3eazZ1B3YR8JJm+qvM6","canUseThunderItem",void 0);S._RF.pop(),S._RF.push({},"3b5b1bQTVlDaaFOGKDB5VZk","canUseTornadoItem",void 0);var B_,F_;S._RF.pop(),S._RF.push({},"e1fd9AcoshNdK0i6vow/F2P","ItemManager",void 0);var x_,z_=C.ccclass,U_=codex.player,G_=(m(B_={},nt.HINT,{canActivate:!1,quantity:0}),m(B_,nt.THUNDER,{canActivate:!1,quantity:0}),m(B_,nt.STORM,{canActivate:!1,quantity:0}),m(B_,nt.PLIERS,{canActivate:!1,quantity:0}),B_),H_=z_("ItemManager")(F_=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).itemConfigs=G_,e}return e(r,[{key:"onLoad",value:function(){this.node.scene.on(Es.GRID_CREATE,this.updateItemsConfig,this),this.node.scene.on(Es.GRID_MATCH,this.updateItemsConfig,this),this.node.scene.on(Es.GRID_CLEAR,this.updateItemsConfig,this),this.node.scene.on(Es.GRID_SPAWN,this.updateItemsConfig,this),this.node.scene.on(Es.BOMB_EXPLODE,this.updateItemsConfig,this),this.node.scene.on(Es.REFRESH_ITEMS,this.updateItemsConfig,this)}},{key:"init",value:function(e){this.game=e}},{key:"getQuantity",value:function(e){return this.itemConfigs[e].quantity}},{key:"setQuantity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.max(0,t);this.itemConfigs[e].quantity=i,this.saveQuantity(e,t),this.updateItemConfig(e,n)}},{key:"saveQuantity",value:function(e,t){var n=U_.getGameData();n&&U_.setGameData({items:s(s({},n.items),{},m({},e,t))})}},{key:"canUseItem",value:function(e){var t=this.game,n=t.board,i=t.pathDraw;switch(e){case nt.HINT:return function(e,t){return e.getUncleared().length>0&&!1===t.isDrawingHint}(n,i);case nt.PLIERS:return function(e){return e.getBombTiles().length>0}(n);case nt.STORM:return function(e){return e.getUncleared().length>4}(n);case nt.THUNDER:return function(e){return e.getUncleared().length>=4}(n);default:return!1}}},{key:"updateItemsConfig",value:function(){var e=U_.getGameData();if(e&&e.items){for(var t=0,n=Object.keys(this.itemConfigs);t<n.length;t++){var i=n[t],a=this.itemConfigs[i];a.canActivate=this.canUseItem(i),a.quantity=e.items[i]||0}this.game.uiManager.currentLayout.updateStatus({items:this.itemConfigs})}}},{key:"updateItemConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=U_.getGameData();n&&(this.itemConfigs[e].canActivate=this.canUseItem(e),this.itemConfigs[e].quantity=n.items[e]||0,this.game.uiManager.currentLayout.updateStatus(s({items:s(s({},this.itemConfigs),{},m({},e,s({animate:t},this.itemConfigs[e])))},this.game.uiManager.config)))}}]),r}(T))||F_;S._RF.pop(),S._RF.push({},"3f8fenpEyBKaaNxBYL5960v","ScoreManager",void 0);var q_=C.ccclass,V_=Ludex.Match.Modes,$_=q_("ScoreManager")(x_=function(a){n(s,a);var r,l=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=l.call.apply(l,[this].concat(i))).currentScore=0,e}return e(s,[{key:"addScore",value:function(e,t,n){var i=this.getLevelMultiplier(e),a=this.getComboMultiplier(t),o=this.getTimeMultiplier(e,n),r=this.getCustomBonusScoreMultiplier(),l=Math.floor(this.currentScore+10*i*a*o*r),s=10*Math.ceil(l/10);this.setScore(s)}},{key:"init",value:function(){this.initCurrentScore(),this.updateScore()}},{key:"initCurrentScore",value:function(){var e;iv.getMatchMode()!==V_.TOURNAMENT?this.currentScore=0:this.currentScore=(null===(e=iv.getMatchCustomData())||void 0===e?void 0:e.score)||0}},{key:"setScore",value:function(e){this.currentScore=e,this.updateScore()}},{key:"updateScore",value:(r=o((function*(){this.node.scene.emit(Es.SCORE_UPDATED,this.currentScore)})),function(){return r.apply(this,arguments)})},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getLevelMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getComboMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getTimeMultiplier",value:function(e,t){return e<=2?4:1+.05*t}},{key:"getCustomBonusScoreMultiplier",value:function(){return iv.getMatchMode()!==lv?1:1+wv.getCustomBonus()/100}}]),s}(T))||x_;S._RF.pop(),S._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var W_=function(){function n(e){t(this,n),this.game=null,this.data={},this.game=e.getGameplay(),this.manager=e,this.updateStateData(),this.logDebug()}return e(n,[{key:"logDebug",value:function(){var e=this.constructor.name;console.debug("[STATE] ".concat(e),this.data)}},{key:"updateStateData",value:function(){if(this.game){var e=this.game.getGameData();e&&(this.data=e)}}},{key:"updateGameData",value:function(e){var t;null===(t=this.game)||void 0===t||t.setGameData(e)}}]),n}();S._RF.pop(),S._RF.push({},"e4ee7Ho9zJPVKobpdsCwGlp","FailState",void 0);var K_=codex,j_=K_.analytics,Y_=K_.storage,X_=Ludex.Match.Modes,J_=function(a){n(d,a);var r,l,s,u,c=i(d);function d(e,n){var i;return t(this,d),i=c.call(this,e),je.stopAllSounds(),i.vibrateDevice(),i.pauseCountdown(),i.updateMatchCustomData(),i.handleGameOver(n),i.logLevelFailAnalytics(),i}return e(d,[{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseTime()}},{key:"vibrateDevice",value:function(){var e;null===(e=re("Vibrate"))||void 0===e||null===(e=e.getComponent(fy))||void 0===e||e.vibrate(500)}},{key:"handleGameOver",value:function(e){var t=iv.getMatchMode();t===X_.SINGLE||t===lv?this.handleSingleGameOver(e):t===X_.TOURNAMENT?this.handleTournamentGameOver():t===X_.CHALLENGE_FRIEND?this.handleChallengeGameOver():this.handleSingleGameOver(e)}},{key:"handleSingleGameOver",value:(u=o((function*(e){var t,n;if(this.game){var i=null!==(t=(yield this.openFailScreenAndWaitForClose(e)).screenData)&&void 0!==t?t:{},a=i.customMode,o=i.rescue;if(a){var r=(null!==(n=(yield lt.openScreenAndWaitForClose(st.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==n?n:{}).customMode?lv:X_.SINGLE;this.game.node.scene.emit(Es.GAME_REPLAY,r)}else o?(this.game.node.scene.emit(Es.SHOW_UI),this.game.node.scene.emit(Es.RESCUE_START)):this.game.node.scene.emit(Es.GAME_REPLAY)}})),function(e){return u.apply(this,arguments)})},{key:"handleTournamentGameOver",value:(s=o((function*(){var e,t,n=this;if(this.game){var i=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;if(i){var a;if(ut.validateTournamentExpired(i))return Y_.setStorageData("tournament","animateTournamentLeader",!1),lt.showNotificationScreenWithLocalizedKey("error.tourEnded",2),void(null===(a=this.game)||void 0===a||a.scheduleOnce((function(){var e;null===(e=n.game)||void 0===e||e.node.scene.emit(Es.GAME_EXIT)}),2));rt.setBlockInput(!0);try{var o,r=null!==(o=Y_.getStorageData("tournament","previousScore"))&&void 0!==o?o:0,l=this.game.scoreManager.getCurrentScore(),s=l>r;if(s){var u,c,d=(null!==(u=iv.getMatchCustomData())&&void 0!==u?u:{}).tournamentId;if(!d)return;ut.saveTournamentProgress(null!==(c=this.data.level)&&void 0!==c?c:1,l,d)}Y_.setStorageData("tournament","animateTournamentLeader",s),yield iv.finishMatchAsync()}catch(e){console.warn(e)}rt.setBlockInput(!1),null===(t=this.game)||void 0===t||t.node.scene.emit(Es.GAME_EXIT)}}})),function(){return s.apply(this,arguments)})},{key:"handleChallengeGameOver",value:(l=o((function*(){if(this.game){rt.setBlockInput(!0);try{var e,t=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).challengeData;yield iv.finishMatchAsync({extraData:{challengeData:t}})}catch(e){console.warn(e)}rt.setBlockInput(!1),this.game.node.scene.emit(Es.SHOW_CHALLENGE_RESULTS)}})),function(){return l.apply(this,arguments)})},{key:"openFailScreenAndWaitForClose",value:(r=o((function*(e){var t=this.data.level;return e===av&&je.playSound(Qi.LEVEL_FAIL_TIMEOUT),je.playSound(Qi.LEVEL_FAIL),lt.openScreenAndWaitForClose(st.RESCUES_SCREEN,{level:t,failKey:e})})),function(e){return r.apply(this,arguments)})},{key:"updateMatchCustomData",value:function(){var e;if(this.game){var t=this.data.level,n=void 0===t?1:t,i=null===(e=this.game)||void 0===e?void 0:e.scoreManager.getCurrentScore();iv.updateMatchStateAfterLevelFinish(n,i)}}},{key:"logLevelFailAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=iv.getMatchMode()||void 0;null==j_||j_.levelFail(t,n,i)}}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){}}]),d}(W_);S._RF.pop(),S._RF.push({},"a9bc11SkV9L/5L+Y+fhswfJ","FinishState",void 0);var Z_=codex,Q_=Z_.analytics,eD=Z_.player,tD=Z_.leaderboard,nD=Ludex,iD=nD.Match.Modes,aD=nD.Utils.Time,oD=nD.Plugins.Ads,rD=(void 0===oD?{}:oD).Types,lD=Ludex.Configs.Ads.NotifyPlayerBeforeShow,sD=function(a){n(f,a);var r,l,s,u,c,d,h,p,y,v=i(f);function f(e){var n;return t(this,f),(n=v.call(this,e)).handleFinishStateFlow(),n}return e(f,[{key:"handleFinishStateFlow",value:(y=o((function*(){if(this.game){this.processCrazyGamesEvent(),this.attemptCallCreateShortcut(),this.game.uiManager.pauseTime();var e=iv.getMatchMode();this.updatePlayerProgress(),this.updateMatchCustomData(),e===iD.CHALLENGE_FRIEND?this.handleFinishChallenge():e===iD.TOURNAMENT?this.handleFinishTournament():this.handleFinishSingle(),this.logLevelCompleteAnalytics()}})),function(){return y.apply(this,arguments)})},{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"attemptCallCreateShortcut",value:function(){var e=this.data.level;(void 0===e?0:e)<2||rD&&Xe.isReadyAdShowable(rD.INTERSTITIAL)||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("createShortcutAsync",e)}))}},{key:"updatePlayerProgress",value:function(){var e=this.data.level,t=eD.getGameData();if(this.game&&e&&t){var n=iv.getMatchMode(),i=t.level,a=e+1,o=Math.max(i,a);if(n===iD.SINGLE||n===lv)eD.setGameData({level:o});else if(n===iD.TOURNAMENT){var r,l=(null!==(r=iv.getMatchCustomData())&&void 0!==r?r:{}).tournamentId;if(!l)return;var s=this.game.scoreManager.getCurrentScore();ut.saveTournamentProgress(e,s,l)}}}},{key:"updateMatchCustomData",value:function(){if(this.game){var e=this.data.level,t=void 0===e?1:e,n=this.game.scoreManager.getCurrentScore();iv.updateMatchStateAfterLevelFinish(t,n)}}},{key:"logLevelCompleteAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=iv.getMatchMode()||void 0;null==Q_||Q_.levelComplete(t,n,i)}}},{key:"handleFinishChallenge",value:(p=o((function*(){if(this.game)try{var e;lt.showLoadingScreen();var t=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).challengeData;yield iv.finishMatchAsync({extraData:{challengeData:t}}),this.game.node.scene.emit(Es.SHOW_CHALLENGE_RESULTS)}catch(e){console.warn("finish challenge error",e)}finally{lt.closeLoadingScreen()}})),function(){return p.apply(this,arguments)})},{key:"handleFinishTournament",value:(h=o((function*(){if(this.handlePostTournamentScore(),this.game){var e=this.data.level,t=void 0===e?1:e;je.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),this.game.effectManager.playConfettiEffect(),yield aD.sleepAsync(500),yield Xe.showInterstitialAdAsync({forLevel:t}),this.game.node.scene.emit(Es.NEXT_LEVEL)}})),function(){return h.apply(this,arguments)})},{key:"handlePostTournamentScore",value:(d=o((function*(){var e;if(this.game){var t=null===(e=this.game)||void 0===e?void 0:e.scoreManager.getCurrentScore();if(t){try{yield GameSDK.tournament.postScoreAsync(t)}catch(e){console.warn("GameSDK post score async",e)}var n=iv.getMatchCustomData();if(n){var i=n.leaderboardId,a=n.playerId;i&&a&&(yield tD.setLeaderboardScoreAsync(i,a,t))}}}})),function(){return d.apply(this,arguments)})},{key:"handleFinishSingle",value:(c=o((function*(){je.turnUpMusic();var e=this.data.level,t=void 0===e?0:e,n=t>0&&t%5==0;12===t?yield this.handleUnlockCustomMode():(n?yield this.handleFinishHardLevel():yield this.handleFinishNormalLevel(),this.handleNextLevelSingle())})),function(){return c.apply(this,arguments)})},{key:"handleFinishNormalLevel",value:(u=o((function*(){var e,t;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=(null!==(e=eD.getGameData())&&void 0!==e?e:{}).coins,o=void 0===a?0:a,r=(null!==(t=iv.getMatchCustomData())&&void 0!==t?t:{}).score,l=void 0===r?0:r;lD&&(yield this.game.uiManager.interstitialAdIndicator.flash());var s=GameSDK.isGameSDK("Yandex");s||(yield this.showAdsNormalLevel(.8)),je.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),yield lt.openScreenAndWaitForClose(st.LEVEL_COMPLETE_SCREEN,{level:i,coins:o,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1}),s&&(yield this.showAdsNormalLevel())}})),function(){return u.apply(this,arguments)})},{key:"showAdsNormalLevel",value:(s=o((function*(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=null!==(e=eD.getGameData())&&void 0!==e?e:{},o=a.custom;iv.getMatchMode()===lv&&null!=o&&o.ads?(this.game.node.scene.emit(Es.HIDE_UI),yield Ve.waitTweenAsync(t),yield Xe.showRewardedInterstitialAdAsync({showError:!1})):rD&&Xe.isReadyAdShowable(rD.INTERSTITIAL)&&(this.game.node.scene.emit(Es.HIDE_UI),yield Ve.waitTweenAsync(t),yield Xe.showInterstitialAdAsync({forLevel:i}))}})),function(){return s.apply(this,arguments)})},{key:"handleFinishHardLevel",value:(l=o((function*(){var e,t,n,i,a=this.data.level,o=void 0===a?0:a,r=null!==(e=null===(t=eD.getGameData())||void 0===t?void 0:t.coins)&&void 0!==e?e:0,l=null!==(n=null===(i=iv.getMatchCustomData())||void 0===i?void 0:i.score)&&void 0!==n?n:0;je.playSound(Qi.LEVEL_COMPLETE,{volume:.5});var s=(yield lt.openScreenAndWaitForClose(st.LEVEL_COMPLETE_SCREEN,{level:o,coins:r,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!0})).screenData,u=(null!=s?s:{}).canShowRewardsAd;if(void 0!==u&&u){var c=(yield lt.openScreenAndWaitForClose(st.GET_REWARDS_SCREEN)).screenData,d=null!=c?c:{},h=d.getRewardsSuccess,p=void 0!==h&&h,y=d.rewardsAdShown,v=void 0!==y&&y;p&&this.getRewardItems(),yield lt.openScreenAndWaitForClose(st.LEVEL_COMPLETE_SCREEN,{level:o,coins:r,score:l,getRewardsSuccess:p,lookingForRewards:!1}),p||v||(yield Xe.showInterstitialAdAsync({forLevel:o}))}else yield Xe.showInterstitialAdAsync({forLevel:o})})),function(){return l.apply(this,arguments)})},{key:"handleUnlockCustomMode",value:(r=o((function*(){var e,t;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=(null!==(e=eD.getGameData())&&void 0!==e?e:{}).coins,o=void 0===a?0:a,r=(null!==(t=iv.getMatchCustomData())&&void 0!==t?t:{}).score,l=void 0===r?0:r;je.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),yield lt.openScreenAndWaitForClose(st.LEVEL_COMPLETE_SCREEN,{level:i,coins:o,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1}),ct.switchToDashboardScene()}})),function(){return r.apply(this,arguments)})},{key:"handleNextLevelSingle",value:function(){var e=this.data.level,t=eD.getGameData();this.game&&e&&t&&this.game.node.scene.emit(Es.NEXT_LEVEL)}},{key:"getRewardItems",value:function(){this.game&&(this.game.node.scene.emit(Es.ADD_ITEM,{item:nt.STORM,quantity:1}),this.game.node.scene.emit(Es.ADD_ITEM,{item:nt.THUNDER,quantity:1}))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),f}(W_);S._RF.pop(),S._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var uD=codex,cD=uD.player,dD=uD.match,hD=Ludex,pD=hD.Match.Modes,yD=hD.Plugins.Ads,vD=(void 0===yD?{}:yD).Types,fD=function(a){n(y,a);var r,l,u,c,d,h,p=i(y);function y(e){var n;return t(this,y),(n=p.call(this,e)).clearBoard(),n.initAdPreload(),n.initCountdown(),n.initScore(),n.loadLevelAndUI(),n}return e(y,[{key:"loadLevelAndUI",value:function(){var e=this;this.setAdVisibility(),this.loadLevel().then((function(){e.updateUI()}))}},{key:"clearBoard",value:function(){this.game&&(this.game.rescueTiles=[],this.game.board.destroyTiles(),this.game.board.clearAnimationQueue(),this.game.pathDraw.clearMatchPath())}},{key:"setAdVisibility",value:function(){if(vD){var e=this.data.level,t=void 0!==e&&e>dt.NUM_LEVEL_WITHOUT_BANNER_ADS;Xe.setAdEnable(vD.BANNER,!t),Xe.updateBannerAdsByLayout(Ze.getCurrentLayout()),Xe.refreshBannerAdVisibility()}}},{key:"loadLevel",value:(h=o((function*(){if(this.game){var e=iv.getMatchMode();try{if(e===pD.CHALLENGE_FRIEND){var t=yield this.loadChallengeFriendMode();return je.playSound(Qi.LEVEL_START),void this.handleChallengeFriendModeStart(t)}if(e===pD.TOURNAMENT)return yield this.loadSingleMode(),je.playSound(Qi.LEVEL_START),void this.handleTournamentModeStart()}catch(e){console.error("Error loading level:",e)}yield this.loadSingleMode(),je.playSound(Qi.LEVEL_START),this.handleSingleModeStart()}})),function(){return h.apply(this,arguments)})},{key:"loadChallengeFriendMode",value:(d=o((function*(){if(!this.game)throw new Error("Game is not initialized");yield iv.getMatchCustomDataAsync();var e=dD.getMatchState().customData.challengeData;if(null==e)throw new Error("Challenge friend mode need to have data.");var t=this.game.levelManager;return yield t.loadLevel(e.level),this.updateGameData({level:e.level,levelData:t.getLevelData()}),e})),function(){return d.apply(this,arguments)})},{key:"loadSingleMode",value:(c=o((function*(){if(null===this.game)throw new Error("Game is not initialized");var e=this.game.levelManager;yield e.loadLevel(this.data.level),this.updateGameData({levelData:e.getLevelData()})})),function(){return c.apply(this,arguments)})},{key:"handleChallengeFriendModeStart",value:(u=o((function*(e){if(this.game){var t=this.game.levelManager.getLevelData(),n=e.level,i=e.fen,a=e.gravity,o=e.rules,r=e.time,l=cD.getPlayerId();yield Promise.all([iv.setMatchCustomDataAsync({level:n,score:0}),iv.setProfileMatchDataAsync({id:l,score:0})]);var u=Vy.loadLevelSpriteFrames(e.level);yield this.game.board.create(u,s(s({},t),{},{level:n,customFen:i,mode:a,rules:o,time:r})),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),this.game.board.setIgnoreInput(!1),yield u,this.ready()}})),function(e){return u.apply(this,arguments)})},{key:"handleSingleModeStart",value:(l=o((function*(){var e,t;if(this.game){var n=this.game.levelManager.getLevelData(),i=null!==(e=this.data.level)&&void 0!==e?e:1,a=cD.getPlayerId();yield Promise.all([iv.setMatchCustomDataAsync({level:i,score:0}),iv.setProfileMatchDataAsync({id:a,score:0})]);var o=Vy.loadLevelSpriteFrames(i);yield this.game.board.create(o,n),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),null!==(t=this.game.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),i&&i>0&&i%5==0&&(Ze.isLandscape()&&this.game.handleShowUI(),yield lt.openScreen(st.HARD_LEVEL_SCREEN),yield Ve.waitTweenAsync(1.3),lt.closeScreen(st.HARD_LEVEL_SCREEN),rt.setBlockInput(!0),yield this.game.board.animateTilesWave(),rt.setBlockInput(!1)),this.ready()}})),function(){return l.apply(this,arguments)})},{key:"handleTournamentModeStart",value:(r=o((function*(){var e,t;if(this.game){var n=this.game.levelManager.getLevelData(),i=null!==(e=this.data.level)&&void 0!==e?e:1,a=cD.getPlayerId();yield Promise.all([iv.setMatchCustomDataAsync({level:i}),iv.setProfileMatchDataAsync({id:a})]);var o=Vy.loadLevelSpriteFrames(i,this.data.themeId);yield this.game.board.create(o,n),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),null!==(t=this.game.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),yield o,this.ready()}})),function(){return r.apply(this,arguments)})},{key:"initAdPreload",value:function(){this.game&&(this.game.isAdPreloadedForCurrentLevel=!1)}},{key:"initScore",value:function(){this.game&&this.game.scoreManager.init()}},{key:"initCountdown",value:function(){this.game&&this.game.clockManager.init()}},{key:"updateUI",value:function(){if(this.game){var e=this.game.getGameData();if(e){var t=e.level,n=void 0===t?0:t,i=e.levelData;this.game.uiManager.setLevelText(n),i&&this.game.clockManager.setTime(i.time)}}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),y}(W_);S._RF.pop(),S._RF.push({},"e3b372NaI5HvY5HnTleBQKd","PlayingState",void 0);var gD=Ludex.Plugins.Ads,mD=(void 0===gD?{}:gD).Types,bD=function(a){n(r,a);var o=i(r);function r(e){var n;return t(this,r),(n=o.call(this,e)).startCountdown(),n.preloadNextLevelSkins(),mD&&Xe.preloadAdsByType(mD.INTERSTITIAL),n}return e(r,[{key:"preloadNextLevelSkins",value:function(){var e,t=null!==(e=this.data.level)&&void 0!==e?e:1;Vy.preloadLevelSpriteFrames(t+1)}},{key:"startCountdown",value:function(){var e;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||(this.game.clockManager.startCountdown(),this.game.uiManager.startCountdown()))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(e){var t=this.manager.createFailState(this.manager,e);this.manager.change(t)}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){this.updateStateData()}}]),r}(W_);S._RF.pop(),S._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var wD,SD=codex.analytics,kD=Ludex.Utils.Valid,CD=[Qi.COMBO_1,Qi.COMBO_2,Qi.COMBO_3,Qi.COMBO_4,Qi.COMBO_5,Qi.COMBO_6,Qi.COMBO_7,Qi.COMBO_8,Qi.COMBO_9,Qi.COMBO_10,Qi.COMBO_11,Qi.COMBO_12,Qi.COMBO_13,Qi.TILE_MATCH,Qi.BOMB_DEFUSE,Qi.BOMB_EXPLODE_1,Qi.BOMB_EXPLODE_2,Qi.TILE_SELECT,Qi.THUNDERBOLT,Qi.SHUFFLE_ITEM,Qi.LEVEL_START,Qi.LEVEL_COMPLETE,Qi.LEVEL_FAIL],ED=function(a){n(r,a);var o=i(r);function r(e){var n;return t(this,r),n=o.call(this,e),je.stopAllSounds(),je.turnDownMusic(),n.preloadAssets(),n.handleGuideFlow(),n.setGridPlayable(),n.logLevelStartAnalytics(),n}return e(r,[{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(e){if(kD.isDebugger()){var t=this.manager.createFailState(this.manager);this.manager.change(t)}}},{key:"finish",value:function(){if(kD.isDebugger()){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}}},{key:"update",value:function(){}},{key:"preloadAssets",value:function(){var e;this.preloadSounds(),null===(e=this.game)||void 0===e||e.effectManager.preloadEffects()}},{key:"preloadSounds",value:function(){for(var e=0,t=CD;e<t.length;e++){var n=t[e];qe.loadAudioAsync(n)}}},{key:"setGridPlayable",value:function(){var e;null!==(e=this.manager.getGameplay().guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||this.manager.getGameplay().board.setIgnoreInput(!1)}},{key:"handleGuideFlow",value:function(){var e,t;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||this.game.handleShowUI(),null===(t=this.game.guidelinesManager)||void 0===t||t.show())}},{key:"logLevelStartAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=(iv.getMatchCustomData()||{}).score,i=void 0===n?0:n,a=iv.getMatchMode()||void 0;null==SD||SD.levelStart(t,i,a)}}}]),r}(W_);S._RF.pop(),S._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var AD=(0,C.ccclass)("StateManager")(wD=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"getGameplay",value:function(){return this.gameplay}},{key:"init",value:function(e){this.gameplay=e,this.state=new fD(this)}},{key:"change",value:function(e){this.state=e}},{key:"initialize",value:function(){this.state.initialize()}},{key:"isInitialize",value:function(){return this.state instanceof fD}},{key:"ready",value:function(){this.state.ready()}},{key:"isReady",value:function(){return this.state instanceof ED}},{key:"playing",value:function(){this.state.playing()}},{key:"isPlaying",value:function(){return this.state instanceof bD}},{key:"fail",value:function(e){this.state.fail(e)}},{key:"isFail",value:function(){return this.state instanceof J_}},{key:"finish",value:function(){this.state.finish()}},{key:"isFinished",value:function(){return this.state instanceof sD}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(fD,t)}},{key:"createReadyState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(ED,t)}},{key:"createPlayingState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(bD,t)}},{key:"createFailState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(J_,t)}},{key:"createFinishState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(sD,t)}}]),r}(T))||wD;S._RF.pop(),S._RF.push({},"e80e4nIcfdLN56j5b9SMhvH","LeaderboardUtils",void 0);var TD,PD=codex.leaderboard,OD=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getAllLeaderboardAsync",value:(r=o((function*(e){if(!PD)return null;var t=PD.getLeaderboardName(e);if(!t)return null;var n=yield PD.getLeaderboardResponseAsync(e);return n?(yield this.requestLeaderboardAsync(t,n.amountPlayer),PD.getLeaderboard(t)):null})),function(e){return r.apply(this,arguments)})},{key:"requestLeaderboardAsync",value:(a=o((function*(e,t){this.isLeaderboardRequesting(e)?yield this.waitForLeaderboardFinishAsync(e):yield PD.requestLeaderboardAsync(e,t)})),function(e,t){return a.apply(this,arguments)})},{key:"waitForLeaderboardFinishAsync",value:(i=o((function*(e){var t=this;if(this.isLeaderboardRequesting(e))return new Promise((function(n){var i=setInterval((function(){t.isLeaderboardRequesting(e)||(clearInterval(i),n())}),100)}))})),function(e){return i.apply(this,arguments)})},{key:"isLeaderboardRequesting",value:function(e){var t;return(null===(t=PD.getLeaderboard(e))||void 0===t?void 0:t.isRequesting)||!1}}]),n}());S._RF.pop(),S._RF.push({},"a95ba1U+uJB66zZU7UYL4e5","TournamentManager",void 0);var LD,ID,RD,_D,DD,MD,ND,BD,FD,xD=C.ccclass,zD=Ludex.Utils.Object,UD=codex,GD=UD.player,HD=UD.leaderboard,qD=xD("TournamentManager")(TD=function(a){n(d,a);var r,l,s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=c.call.apply(c,[this].concat(i))).leaderData=[],e.tournamentData=null,e.leaderboardData=null,e.leaderboardName=null,e}return e(d,[{key:"init",value:(u=o((function*(){yield this.requestTournamentData(),yield this.requestLeaderData()})),function(){return u.apply(this,arguments)})},{key:"requestTournamentData",value:(s=o((function*(){var e,t,n=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;n&&(yield ut.requestTournamentDataAsync(),this.tournamentData=null!==(t=ut.getTournamentDataById(n))&&void 0!==t?t:null)})),function(){return s.apply(this,arguments)})},{key:"requestLeaderData",value:(l=o((function*(){var e,t=this,n=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).leaderboardId;if(n&&(yield this.requestLeaderboardData(n),this.leaderboardData)){var i=GD.getPlayerId();this.leaderData=zD.vals(this.leaderboardData.leaders).reduce((function(e,t){if(t.playerId!==i&&t.score>0){var n={score:t.score,rank:t.rank};e.push(n)}return e}),[]).sort((function(e,t){return e.score-t.score})),this.leaderData.forEach((function(e,n){e.rank=t.leaderData.length-n}))}})),function(){return l.apply(this,arguments)})},{key:"requestLeaderboardData",value:(r=o((function*(e){this.leaderboardName=HD.getLeaderboardName(e),this.leaderboardData=yield OD.getAllLeaderboardAsync(e)})),function(e){return r.apply(this,arguments)})}]),d}(T))||TD;S._RF.pop(),S._RF.push({},"2b89dXjcudIaZRJFuh5TAAI","InterstitialAdIndicator",void 0);var VD=C.ccclass,$D=C.property,WD=["ads.interNotice.backInSec","ads.interNotice.hangTight","ads.interNotice.quickAd"];var KD,jD=Ludex.Configs.Ads.NotifyPlayerBeforeShow,YD=(LD=VD("InterstitialAdIndicator"),ID=Yn.required(),RD=$D(B),_D=Yn.required(),DD=$D(th),LD((BD=a((ND=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"uiOpacity",BD,l(e)),r(e,"labelLocalizer",FD,l(e)),e}return e(c,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}},{key:"flash",value:(s=o((function*(){var e,t,n=(t=Math.floor(Math.random()*WD.length),WD[t]);if(!1!==jD&&n){null===(e=this.signal)||void 0===e||e.abort();var i=new Ni;this.signal=i,this.labelLocalizer.key=n;var a=R(this.uiOpacity).to(.25,{opacity:255},{easing:"linear"}).delay(.25).to(.25,{opacity:100},{easing:"linear"}).delay(.125);yield Ve.runTweenAsync(R(this.uiOpacity).repeat(2,a).to(.25,{opacity:0},{easing:"linear"}),i),this.uiOpacity.opacity=0}})),function(){return s.apply(this,arguments)})}]),c}(T)).prototype,"uiOpacity",[ID,RD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FD=a(ND.prototype,"labelLocalizer",[_D,DD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MD=ND))||MD);S._RF.pop(),S._RF.push({},"dfab8xSeglD/abIKphEhi4g","ComboContainer",void 0);var XD,JD=C.ccclass,ZD=Ludex.Match.Modes,QD=JD("ComboContainer")(KD=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.widget=this.node.getComponent(I),this.node.scene.on(Es.GRID_RESIZE,this.handleViewResized,this)}},{key:"init",value:function(e){this.board=e}},{key:"updateWidget",value:function(){if(Ze.isPortrait())return this.node.scale=new V(1,1,1),this.widget.right=22.5,void(this.widget.top=iv.getMatchMode()===ZD.TOURNAMENT?180:160);if(this.board){this.node.scale=new V(1.5,1.5,1.5);var e=this.board.getBoundingBoxWorld().yMax,t=We.cssSizeToWorldSize(We.getScreenHeightCss());this.widget.right=142.5,this.widget.top=(t-e)/2}}},{key:"updateStatus",value:function(){this.updateWidget()}},{key:"handleViewResized",value:function(){this.updateWidget()}}]),r}(T))||KD;S._RF.pop(),S._RF.push({},"ed00dMDxYRJP4fZMawN9JnW","ComboProgressBar",void 0);var eM,tM,nM,iM,aM,oM,rM,lM,sM,uM,cM,dM,hM,pM,yM,vM,fM,gM,mM,bM,wM,SM,kM,CM,EM,AM,TM=C.ccclass,PM=TM("ComboProgressBar")(XD=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"start",value:function(){this.progressBar=this.getComponent(Ic),this.opacity=this.getComponent(B),this.comboTimer=0,this.isActive=!1,this.node.scene.on(Es.COMBO_UPDATED,this.handleComboUpdated,this)}},{key:"update",value:function(e){this.isActive&&(this.comboTimer>0?(this.comboTimer-=e,this.progressBar.progress=this.comboTimer/2):(this.isActive=!1,this.opacity.opacity=0,this.node.scene.emit(Es.COMBO_ENDED)))}},{key:"handleComboUpdated",value:function(e){0===e?this.opacity.opacity=0:e>0&&(this.isActive=!0,this.comboTimer=2),e>1&&(this.opacity.opacity=255)}},{key:"pause",value:function(){this.isActive=!1}},{key:"resume",value:function(){this.isActive=!0}}]),r}(T))||XD;S._RF.pop(),S._RF.push({},"c3d9fl9+INO3ac7Q2zvmRKy","SpecialItem",void 0);var OM,LM,IM,RM,_M,DM,MM,NM=C.ccclass,BM=C.property,FM=(m(eM={},nt.HINT,"item.hintDesc"),m(eM,nt.PLIERS,"item.pliersDesc"),m(eM,nt.STORM,"item.stormDesc"),m(eM,nt.THUNDER,"item.thunderDesc"),eM),xM=(tM=NM("SpecialItem"),nM=BM({editorOnly:!0,tooltip:"A debug button has infinite quantity"}),iM=Yn.required(),aM=BM({type:G,tooltip:"The button that activates the item"}),oM=BM({type:O,group:"Quantity",tooltip:"The starting quantity of the item",displayName:"Quantity"}),rM=Yn.required(),lM=BM({type:K,group:"Quantity",tooltip:"The label that shows the quantity",displayName:"Label"}),sM=Yn.required(),uM=BM({type:q,group:"Quantity",tooltip:"The node that shows the quantity of the item",displayName:"Quantity node"}),cM=Yn.required(),dM=BM({type:q,group:"Quantity",tooltip:"The node that shows the plus icon when there is no item",displayName:"Plus node"}),hM=Yn.required(),pM=BM({type:B,group:"Animation"}),yM=Yn.required(),vM=BM({type:B,tooltip:"The opacity component of the button",displayName:"Button UI Opacity"}),tM((mM=a((gM=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"isDevButton",mM,l(e)),r(e,"button",bM,l(e)),r(e,"quantity",wM,l(e)),r(e,"quantityLabel",SM,l(e)),r(e,"quantityNode",kM,l(e)),r(e,"plusNode",CM,l(e)),r(e,"glowUIOpacity",EM,l(e)),r(e,"uiOpacity",AM,l(e)),e.vibrateComp=null,e}return e(d,[{key:"itemType",get:function(){}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,d)}},{key:"updateStatus",value:function(e){var t;if(void 0!==this.itemType){var n=null===(t=e.items)||void 0===t?void 0:t[this.itemType];n&&(this.setActiveStatus(n.canActivate),this.setQuantity(n.quantity,n.animate))}}},{key:"setActiveStatus",value:function(e){var t;null===(t=this.signal)||void 0===t||t.abort();var n=new Ni;this.signal=n,this.button.interactable=e,Ve.runTweenAsync(R(this.uiOpacity).to(.2,{opacity:e?255:128}),n)}},{key:"activate",value:(u=o((function*(){this.quantity<=0?this.requestItem():(this.vibrate(),this.node.scene.emit(Es.USE_ITEM,this.itemType))})),function(){return u.apply(this,arguments)})},{key:"setQuantity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;if(this.isDevButton)return this.quantityLabel.string="i",this.quantityNode.active=!0,void(this.plusNode.active=!1);n=Math.max(0,n),this.quantity=n,this.quantityLabel.string="".concat(this.quantity),n<=0?(this.quantityNode.active=!1,this.plusNode.active=!0):(this.quantityNode.active=!0,this.plusNode.active=!1),t&&this.animateAddItem()}},{key:"requestItem",value:function(){void 0!==this.itemType?lt.openScreen(st.GET_ITEM_SCREEN,{item:this.itemType,localizedMessageKey:FM[this.itemType],quantity:1}):console.warn("Item type is not defined")}},{key:"vibrate",value:function(){var e,t;this.vibrateComp=null!==(e=this.vibrateComp)&&void 0!==e?e:this.node.getComponent(fy),null===(t=this.vibrateComp)||void 0===t||t.vibrate(50)}},{key:"animateAddItem",value:(s=o((function*(){return this.glowUIOpacity.opacity=0,Promise.all([Ve.runTweenAsync(R(this.node).to(.1,{scale:new V(1.15,1.15,1.15)},{easing:"cubicOut"}).delay(.2).to(.7,{scale:V.ONE},{easing:"elasticOut"})),Ve.runTweenAsync(R(this.glowUIOpacity).to(.1,{opacity:100}).delay(.2).to(.6,{opacity:0}))])})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"isDevButton",[nM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bM=a(gM.prototype,"button",[iM,aM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wM=a(gM.prototype,"quantity",[oM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),SM=a(gM.prototype,"quantityLabel",[rM,lM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kM=a(gM.prototype,"quantityNode",[sM,uM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CM=a(gM.prototype,"plusNode",[cM,dM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EM=a(gM.prototype,"glowUIOpacity",[hM,pM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AM=a(gM.prototype,"uiOpacity",[yM,vM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fM=gM))||fM);S._RF.pop(),S._RF.push({},"9e40aEq56tMKLFoeACyl+eH","Clock",void 0);var zM=C.ccclass,UM=C.disallowMultiple,GM=C.property,HM=(OM=zM("Clock"),LM=GM(q),IM=GM(K),OM(RM=UM((DM=a((_M=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"clockIcon",DM,l(e)),r(e,"timeLabel",MM,l(e)),e}return e(d,[{key:"__preload",value:function(){this.node.scene.on(Es.TIME_UPDATED,this.updateTimeLabel,this),this.node.scene.on(Es.RESCUE_START,this.handleRescueStart,this),this.node.scene.on(Es.RESCUE_FINISHED,this.handleRescueFinished,this)}},{key:"updateStatus",value:function(e){void 0!==e.time&&this.updateTimeLabel(e.time)}},{key:"updateTimeLabel",value:function(e){var t=this.convertSecondsToMmSs(e);this.timeLabel.string=t}},{key:"convertSecondsToMmSs",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60),i=this.padZero(t),a=this.padZero(n);return"".concat(i,":").concat(a)}},{key:"padZero",value:function(e){return e<10?"0".concat(e):"".concat(e)}},{key:"handleRescueStart",value:(u=o((function*(){var e=R(this.node).to(.5,{scale:new V(1.1,1.1,1)}),t=R(this.clockIcon).to(.15,{angle:-15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}).to(.15,{angle:15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}),n=R(this.clockIcon).repeat(5,t);Ve.runTweenAsync(n),Ve.runTweenAsync(e)})),function(){return u.apply(this,arguments)})},{key:"handleRescueFinished",value:(s=o((function*(){var e=R(this.node).to(.5,{scale:new V(1,1,1)});Ve.runTweenAsync(e)})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"clockIcon",[LM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MM=a(_M.prototype,"timeLabel",[IM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RM=_M))||RM)||RM);S._RF.pop(),S._RF.push({},"9ecd9Kte0VJN4rRVFlb6CzI","OverlayUtils",void 0);var qM=codex,VM=qM.player,$M=qM.analytics,WM=Ludex.Plugins.Analytics,KM=(void 0===WM?{}:WM).Events,jM=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"shareBestScoreWithOverlay",value:(r=o((function*(){try{var e=(VM.getPlayer().data||{}).score;this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.extra.shareAsync({text:"Great! I have a best score!",intent:"SHARE",imageOverlayPath:"wideframes/share-async.xml",pathToCSS:"wideframes/share-async-styles.css",initialData:{score:null!=e?e:0},shareDestination:["NEWSFEED","GROUP","COPY_LINK","MESSENGER"],switchContext:!1}),KM&&$M.event(KM.SHARE,{share_content_type:"BestScore",success:!0})}catch(e){KM&&$M.event(KM.SHARE,{share_content_type:"BestScore",success:!1}),console.error("Overlay sharing failed:",e)}})),function(){return r.apply(this,arguments)})},{key:"inviteFriendsWithOverlay",value:(a=o((function*(){try{var e=(VM.getPlayer().data||{}).score;this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.extra.inviteAsync({initialData:{score:null!=e?e:0},text:{default:"Great! I have a best score!",localizations:{vi_VN:"Tht tuyt! Mnh va ph k lc ny!"}},imageOverlayPath:"wideframes/invite-async.xml",pathToCSS:"wideframes/invite-async-styles.css"}),KM&&$M.event(KM.INVITE,{invite_content_type:"BestScore",success:!0})}catch(e){KM&&$M.event(KM.INVITE,{invite_content_type:"BestScore",success:!1}),console.error("Overlay inviting failed:",e)}})),function(){return a.apply(this,arguments)})},{key:"isOverlayViewAPIAvailable",value:function(e){if(!e.isGameSDK("FacebookInstant"))throw new Error("GameSDK is not FacebookInstant");if(!e.extra.isNEZP()||e.extra.isRestricted())throw new Error("GameSDK is not NEZP or Restricted");if(!("overlayViews"in e))throw new Error("GameSDK does not have overlayViews")}},{key:"createOverlayViewAsync",value:(i=o((function*(e,t,n,i,a){return this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.overlayViews.createOverlayViewAsync(e,t,n,i,a)})),function(e,t,n,a,o){return i.apply(this,arguments)})},{key:"getGameScaleFactor",value:function(){var e=Ke.DesignSize,t=e.Portrait,n=e.Landscape,i=We.getScreenWidthCss(),a=We.getScreenHeightCss(),o=Ze.isLandscape(),r=i/(o?n.WIDTH:t.WIDTH),l=a/(o?n.HEIGHT:t.HEIGHT);switch(this.getViewResolutionPolicy().getContentStrategy()){case Be.ContentStrategy.FIXED_WIDTH:return r;case Be.ContentStrategy.FIXED_HEIGHT:return l;default:return Math.max(r,l)}}},{key:"getViewResolutionPolicy",value:function(){return Fe.getResolutionPolicy()}}]),n}());S._RF.pop(),S._RF.push({},"782f7aiDpVF869fWzGqeFHO","PlayerAvatarOverlay",void 0);var YM=Ludex.Utils,XM=YM.Time,JM=YM.Object,ZM=function(){function n(e){var i=this;t(this,n),this.createMainDiv$=function(){i.mainDiv$=document.createElement("div"),JM.assign(i.mainDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",scrollbarWidth:"none",alignItems:"center",overflow:"hidden",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none"}),i.updateContainerWidth$(55),document.body.appendChild(i.mainDiv$)},this.isPlayerIdValid$=function(e){return/^\d+$/.test(e)},this.showOverlay$=o((function*(){i.overlayView&&(JM.assign(i.mainDiv$.style,{opacity:"0",display:"none",pointerEvents:"none"}),yield i.overlayView.showAsync(),yield i.fadeIn())})),this.updateContainerWidth$=function(e){var t=Ze.isLandscape()?2.4:1.2,n="".concat(e*t*jM.getGameScaleFactor(),"px");JM.assign(i.mainDiv$.style,{width:n,height:n})},this.getIframeCss$=function(){return"".concat("width: 100%;"," ").concat("height: 100%;"," ").concat("overflow: hidden;"," ").concat("background-color: transparent;"," ").concat("border-width: 0px;"," ").concat("align-items: center;")},this.scene=e,this.createMainDiv$()}var i,a,r,l;return e(n,[{key:"moveOverlayTo",value:function(e,t){var n=jM.getGameScaleFactor();Object.assign(this.mainDiv$.style,{top:"calc(100vh - ".concat(t*n,"px)"),left:"calc(".concat(e*n,"px)")})}},{key:"updateOverlay",value:(l=o((function*(e){try{var t=e.playerId,n=e.worldX,i=e.worldY,a=e.avatarWidth,o=void 0===a?55:a,r=e.customCss,l=void 0===r?"overlays/avatar/avatar-overlay-styles.css":r;if(!this.isPlayerIdValid$(t))return!1;if(this.updateContainerWidth$(o),this.moveOverlayTo(n,i),this.currentPlayerId===t)return yield this.showOverlay$(),!0;this.overlayView=yield jM.createOverlayViewAsync("overlays/avatar/avatar-overlay.xml",this.mainDiv$,this.getIframeCss$(),l,{playerId:t}),this.currentPlayerId=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return l.apply(this,arguments)})},{key:"hideOverlay",value:(r=o((function*(){if(this.overlayView){JM.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none"});try{yield XM.sleepAsync(300),this.mainDiv$.style.display="none",yield this.overlayView.dismissAsync()}catch(e){console.error("Hide overlay failed:",e)}}})),function(){return r.apply(this,arguments)})},{key:"fadeIn",value:(a=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";JM.assign(this.mainDiv$.style,{transition:"opacity ".concat(t,"ms ").concat(n),display:"block"}),requestAnimationFrame((function(){JM.assign(e.mainDiv$.style,{opacity:"1",pointerEvents:"auto"})})),yield XM.sleepAsync(t)})),function(){return a.apply(this,arguments)})},{key:"fadeOut",value:(i=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";JM.assign(this.mainDiv$.style,{transition:"opacity ".concat(e,"ms ").concat(t),opacity:"0",pointerEvents:"none"}),yield XM.sleepAsync(e),this.mainDiv$.style.display="none"})),function(){return i.apply(this,arguments)})}]),n}();S._RF.pop(),S._RF.push({},"af947t5g91EkZVWXv5upZaV","CacheUtils",void 0);var QM=Ludex.Utils.Image,eN=codex.frameCapture,tN=function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getPlayerAvatar",value:(r=o((function*(e,t,n,i){var a=this.playerAvatarCache$.get("".concat(t,":").concat(n));return a||(a=yield this.loadPlayerAvatar(e,t,n,i)),a})),function(e,t,n,i){return r.apply(this,arguments)})},{key:"loadPlayerAvatar",value:(a=o((function*(e,t,n,i){var a=yield this.loadImage(e,n,n,"".concat(t,":").concat(n));if((null==i||!i.aborted)&&a){var o=ue.createWithImage(a);return this.playerAvatarCache$.set("".concat(t,":").concat(n),o),o}})),function(e,t,n,i){return a.apply(this,arguments)})},{key:"isAvatarCached",value:function(e,t){return this.playerAvatarCache$.has("".concat(e,":").concat(t))}},{key:"loadImage",value:(i=o((function*(e,t,n,i){try{var a=yield eN.captureAsync({width:t,height:n,name:"LeaderAvatar",renderOptions:m({},i,{name:i,type:"image",depth:0,position:[0,0],size:[t,n],image:e})});return a?yield QM.loadImage(a):null}catch(e){return null}})),function(e,t,n,a){return i.apply(this,arguments)})}]),n}();tN.playerAvatarCache$=new Map;var nN,iN,aN,oN,rN,lN,sN,uN,cN,dN,hN,pN=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(tN);S._RF.pop(),S._RF.push({},"540108ucKBPYbN9gW5TFh/q","LeaderRail",void 0);var yN,vN,fN,gN,mN,bN=C.ccclass,wN=C.property,SN="overlays/avatar/tournament-rail-overlay-styles.css",kN=(nN=bN("LeaderRail"),iN=wN(K),aN=wN(q),oN=wN(F),rN=wN(hT),nN((uN=a((sN=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"scoreLabel",uN,l(e)),r(e,"crown",cN,l(e)),r(e,"avatar",dN,l(e)),r(e,"spark",hN,l(e)),e.score=0,e.isOverlayMode=!1,e.playerAvatarOverlay=null,e.showAvatarOverlay$=function(){var t=o((function*(t){var n,i=e.getAvatarPosition$(),a=i.worldX,o=i.worldY,r=yield null===(n=e.playerAvatarOverlay)||void 0===n?void 0:n.updateOverlay({playerId:t,worldX:a,worldY:o,avatarWidth:e.getAvatarWidth$(),customCss:SN});return null!=r&&r}));return function(e){return t.apply(this,arguments)}}(),e.getAvatarWidth$=function(){var t=e.avatar.node.getComponent(P);return t?t.width:0},e.getAvatarPosition$=function(){var t=e.avatar.node;return{worldX:t.worldPositionX,worldY:t.worldPositionY}},e.createAvatarOverlay$=function(){try{jM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.playerAvatarOverlay=new ZM(e.node.scene)}catch(e){return}},e.handleAvatarPositionChanged$=function(){var t;if(e.isOverlayMode){var n=e.getAvatarPosition$(),i=n.worldX,a=n.worldY;null===(t=e.playerAvatarOverlay)||void 0===t||t.moveOverlayTo(i,a)}},e}return e(d,[{key:"__preload",value:function(){this.defaultAvatar=this.avatar.spriteFrame,this.uiOpacity=this.getComponent(B)}},{key:"onLoad",value:function(){this.createAvatarOverlay$()}},{key:"onDisable",value:function(){this.cleanupOverlay()}},{key:"updateScore",value:(u=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e-this.score,o=i?0:.5,r=R(this.node).to(o,{},{onUpdate:function(e,t){if(t){var i=Math.floor(a*t)+n.score;n.scoreLabel.string=i.toString()}}});yield Ve.runTweenAsync(r,t),this.score=e,this.scoreLabel.string=e.toString()})),function(e,t){return u.apply(this,arguments)})},{key:"updatePhoto",value:(s=o((function*(){var e=GameSDK.player.getID();if(e){if(this.isOverlayMode){if(yield this.showAvatarOverlay$(e))return;this.isOverlayMode=!1}var t=GameSDK.player.getPhoto();if(t){var n=yield pN.getPlayerAvatar(t,e,50);n?(n.packable=!0,this.avatar.spriteFrame=n):this.avatar.spriteFrame=this.defaultAvatar}}})),function(){return s.apply(this,arguments)})},{key:"setCrown",value:function(e){this.crown.active=e}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"playSparkParticle",value:function(){this.spark.play()}},{key:"stopSparkParticle",value:function(){this.spark.stop()}},{key:"cleanupOverlay",value:function(){var e;null===(e=this.playerAvatarOverlay)||void 0===e||e.hideOverlay()}},{key:"update",value:function(e){this.handleAvatarPositionChanged$()}}]),d}(T)).prototype,"scoreLabel",[iN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cN=a(sN.prototype,"crown",[aN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dN=a(sN.prototype,"avatar",[oN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hN=a(sN.prototype,"spark",[rN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lN=sN))||lN);S._RF.pop(),S._RF.push({},"00759vwS/dHS6GvHKvVE5Q1","TournamentProgressBar",void 0);var CN,EN,AN,TN,PN,ON,LN,IN,RN,_N,DN,MN,NN,BN,FN,xN,zN,UN,GN,HN,qN=C.ccclass,VN=C.property,$N=474,WN=(yN=qN("TournamentProgressBar"),vN=VN(kN),yN((mN=a((gN=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"playerLeader",mN,l(e)),e.onUpdate=function(){e.playerLeader&&e.playerLeader.node&&(e.playerLeader.node.position=new V(e.progressBar.progress*$N-237,0,0))},e}return e(c,[{key:"__preload",value:function(){this.progressBar=this.getComponent(ie)}},{key:"updateProgress",value:(s=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cubicOut",a=R(this.progressBar).to(n,{progress:e},{easing:i,onUpdate:this.onUpdate});yield Ve.runTweenAsync(a,t)})),function(e,t){return s.apply(this,arguments)})},{key:"getProgress",value:function(){return this.progressBar.progress}}]),c}(T)).prototype,"playerLeader",[vN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fN=gN))||fN);S._RF.pop(),S._RF.push({},"16d68fBLT1Ha7lXADThDtfC","TournamentRail",void 0);var KN,jN,YN,XN,JN,ZN,QN,eB,tB,nB=C.ccclass,iB=C.property,aB=Ludex,oB=aB.Utils,rB=oB.Array,lB=oB.Signal,sB=oB.Valid,uB=aB.Match.Modes,cB=(CN=nB("TournamentRail"),EN=iB(WN),AN=iB(kN),TN=iB(q),PN=iB(q),ON=iB(th),LN=iB(th),IN=iB(q),RN=iB(B),_N=Yn.onlyRunInLifeCycleAsync,CN((NN=a((MN=function(a){n(f,a);var s,c,d,h,p,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),r(e,"progressBar",NN,l(e)),r(e,"playerLeader",BN,l(e)),r(e,"flag",FN,l(e)),r(e,"sword",xN,l(e)),r(e,"currentRankLocalizer",zN,l(e)),r(e,"nextRankLocalizer",UN,l(e)),r(e,"devTools",GN,l(e)),r(e,"challengerJoinedUiOpacity",HN,l(e)),e.challengerJoinedY=0,e.leaderData=[],e.nextLeaderIndex=0,e.score=0,e.minScore=0,e.maxScore=0,e.signal=new lB.SignalController,e}return e(f,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),this.playerLeader.updatePhoto(),this.devTools.active=sB.isDebugger(),this.challengerJoinedY=this.challengerJoinedUiOpacity.node.position.y}},{key:"updateStatus",value:(y=o((function*(e){if(iv.getMatchMode()!==uB.TOURNAMENT)return this.uiOpacity.opacity=0,void this.playerLeader.cleanupOverlay();this.uiOpacity.opacity=255,this.playerLeader.updatePhoto();var t=e.leaderData,n=e.score;if(t&&void 0!==n){var i=this.signal.renew();this.score=n,this.nextLeaderIndex=this.getScoreReachedLeaderIndex(this.score,t),this.syncRail(t,i,!0)}})),function(e){return y.apply(this,arguments)})},{key:"syncRail",value:(p=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e[this.nextLeaderIndex-1],a=e[this.nextLeaderIndex],o=i?i.rank:a?a.rank+1:1;this.setRankLabel(o,this.currentRankLocalizer);var r=!a;this.nextRankLocalizer.node.active=!r,this.runActiveAnimation(this.sword,!r,t,n),this.playerLeader.setCrown(r),this.playerLeader.updateScore(this.score,t,n);var l=n?0:void 0;if(r)this.playerLeader.playSparkParticle(),yield this.progressBar.updateProgress(1,t,l);else{this.playerLeader.stopSparkParticle(),this.setRankLabel(a.rank,this.nextRankLocalizer),this.minScore=i?i.score:0,this.maxScore=a.score;var s=(this.score-this.minScore)/(this.maxScore-this.minScore);(s=.8*s+.1)<this.progressBar.getProgress()&&this.showScoreUpdatedNotice(t),yield this.progressBar.updateProgress(s,t,l)}})),function(e,t){return p.apply(this,arguments)})},{key:"handleScoreUpdated",value:(h=o((function*(e){var t=e.score,n=e.leaderData;if(void 0!==t&&n){this.leaderData=n;var i=this.signal.renew();this.score=t;var a=this.getScoreReachedLeaderIndex(t,n);if(a>this.nextLeaderIndex){this.nextLeaderIndex=a;var o=(1-this.progressBar.getProgress())/1.5;o=Math.min(o,.5),yield this.progressBar.updateProgress(1,i,o,"cubicIn"),this.runBubbleAnimation(this.sword,i),yield this.progressBar.updateProgress(0,i,0),this.runBubbleAnimation(this.flag,i)}else if(a<this.nextLeaderIndex){this.nextLeaderIndex=a;var r=this.progressBar.getProgress()/1.5;r=Math.min(r,.5),yield this.progressBar.updateProgress(0,i,r,"cubicIn"),this.runBubbleAnimation(this.flag,i),yield this.progressBar.updateProgress(1,i,0),this.runBubbleAnimation(this.sword,i)}this.syncRail(n,i)}})),function(e){return h.apply(this,arguments)})},{key:"runBubbleAnimation",value:(d=o((function*(e,t){e.scale=V.ONE;var n=R(e).to(.1,{scale:new V(1.2,1.2,1.2)}).to(.2,{scale:V.ONE},{easing:"backOut"});yield Ve.runTweenAsync(n,t),e.scale=V.ONE})),function(e,t){return d.apply(this,arguments)})},{key:"runActiveAnimation",value:(c=o((function*(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t?V.ZERO:V.ONE,o=t?V.ONE:V.ZERO;if(i)e.scale=o;else if(!e.scale.equals(o)){var r=t?"backOut":"quadOut";e.scale=a;var l=R(e).to(.1,{scale:new V(1.2,1.2,1.2)}).to(.2,{scale:o},{easing:r});yield Ve.runTweenAsync(l,n),e.scale=o}})),function(e,t,n){return c.apply(this,arguments)})},{key:"getScoreReachedLeaderIndex",value:function(e,t){var n=rB.searchIndex(t,(function(t){return t.score>=e}));return-1===n?t.length:n}},{key:"setRankLabel",value:function(e,t){1!==e?2!==e?3!==e?(t.key="status.nth",t.setParams([e.toString()])):t.key="status.third":t.key="status.second":t.key="status.first"}},{key:"handleDecreaseRank",value:function(){var e,t=u(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score+=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"handleIncreaseRank",value:function(){var e,t=u(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score-=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"getMedianScore",value:function(){return(this.leaderData[this.leaderData.length-1].score-this.leaderData[0].score)/this.leaderData.length}},{key:"showScoreUpdatedNotice",value:(s=o((function*(e){var t=this;this.challengerJoinedUiOpacity.node.active=!0,this.challengerJoinedUiOpacity.opacity=0;var n=function(){t.challengerJoinedUiOpacity.node.active=!1,t.challengerJoinedUiOpacity.opacity=0};e.once(n);var i=new V(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY-10,this.challengerJoinedUiOpacity.node.position.z),a=new V(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY,this.challengerJoinedUiOpacity.node.position.z),o=new V(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY+10,this.challengerJoinedUiOpacity.node.position.z);this.challengerJoinedUiOpacity.node.setPosition(i);var r=Ve.runTweenAsync(R(this.challengerJoinedUiOpacity).to(.5,{opacity:255}),e),l=Ve.runTweenAsync(R(this.challengerJoinedUiOpacity.node).to(.5,{position:a},{easing:"cubicOut"}),e),s=Ve.waitTweenAsync(1,e);yield Promise.all([r,l,s]);var u=Ve.runTweenAsync(R(this.challengerJoinedUiOpacity.node).to(.5,{position:o},{easing:"cubicIn"}),e),c=Ve.runTweenAsync(R(this.challengerJoinedUiOpacity).to(.5,{opacity:0}),e);yield Promise.all([u,c]),e.off(n)})),function(e){return s.apply(this,arguments)})}]),f}(T)).prototype,"progressBar",[EN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BN=a(MN.prototype,"playerLeader",[AN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FN=a(MN.prototype,"flag",[TN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xN=a(MN.prototype,"sword",[PN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zN=a(MN.prototype,"currentRankLocalizer",[ON],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UN=a(MN.prototype,"nextRankLocalizer",[LN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GN=a(MN.prototype,"devTools",[IN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HN=a(MN.prototype,"challengerJoinedUiOpacity",[RN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(MN.prototype,"updateStatus",[_N],Object.getOwnPropertyDescriptor(MN.prototype,"updateStatus"),MN.prototype),DN=MN))||DN);S._RF.pop(),S._RF.push({},"ac5371+oVZBLoBKwAM7rH3r","GameSceneLayout",void 0);var dB=C.ccclass,hB=C.property,pB=(KN=dB("GameSceneLayout"),jN=hB(cB),YN=hB(HM),XN=hB(xM),KN((QN=a((ZN=function(a){n(p,a);var s,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"tournamentRail",QN,l(e)),r(e,"clock",eB,l(e)),r(e,"items",tB,l(e)),e.isInited=!1,e.entranceSignal=new Ni,e.exitSignal=new Ni,e}return e(p,[{key:"waitForInitAsync",value:(d=o((function*(){var e=this;if(!this.isInited)return new Promise((function(t){var n=setInterval((function(){e.isInited&&(clearInterval(n),t())}),100)}))})),function(){return d.apply(this,arguments)})},{key:"setLevelText",value:function(e){}},{key:"disableLayout",value:function(){}},{key:"enableLayout",value:function(){}},{key:"updateStatus",value:function(e){this.clock.updateStatus(e),this.tournamentRail.updateStatus(e);var t,n=u(this.items);try{for(n.s();!(t=n.n()).done;){t.value.updateStatus(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"playExitAnimUI",value:(c=o((function*(){})),function(){return c.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(s=o((function*(){})),function(){return s.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){}},{key:"unHighlightCoinContainer",value:function(){}},{key:"handleScoreUpdated",value:function(e){}}]),p}(T)).prototype,"tournamentRail",[jN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eB=a(ZN.prototype,"clock",[YN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tB=a(ZN.prototype,"items",[XN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),JN=ZN))||JN);S._RF.pop(),S._RF.push({},"36e26OmHk5GXL6+/b4UibIf","SortNodeUtils",void 0);var yB,vB,fB,gB,mB,bB,wB,SB,kB,CB,EB=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){var e=this;t(this,n),this.layerNodes=new Map,this.nodeMetadata=new Map,this.movedNodes=new Set,this.listenEvents$=function(){A.on(Z.EVENT_AFTER_UPDATE,e.onAfterUpdate$),A.on(Z.EVENT_AFTER_RENDER,e.onAfterRender$)},this.onAfterUpdate$=function(){e.sortNodes$()},this.onAfterRender$=function(){e.restoreNodes$()},this.sortNodes$=function(){0!==e.layerNodes.size&&0!==e.nodeMetadata.size&&e.nodeMetadata.forEach((function(t,n){var i=t.node,a=t.layer,o=t.needsPositionUpdate;if(null!=i&&i.isValid&&i.activeInHierarchy){var r=e.layerNodes.get(a);if(null!=r&&r.isValid)return o?(e.revertNodeTransform$(t),t.needsPositionUpdate=!1,void e.movedNodes.add(n)):void(i.parent!==r&&(i.setParent(r,!0),e.movedNodes.add(n)))}}))},this.revertNodeTransform$=function(e){var t=e.node,n=e.originalParent,i=e.originalLocalTransform,a=i.position,o=i.rotation,r=i.scale;t.setParent(n,!0),t.setPosition(a),t.setRotation(o),t.setScale(r)},this.restoreNodes$=function(){0!==e.movedNodes.size&&(e.movedNodes.forEach((function(t){var n=e.nodeMetadata.get(t);n&&n.node.parent!==n.originalParent&&e.restoreNode$(n)})),e.movedNodes.clear())},this.restoreNode$=function(e){var t=e.node,n=e.originalParent;e.keepInLayer||t.parent!==n&&t.setParent(n,!0)},this.revertNodeSiblingIndex$=function(e){var t=e.node,n=e.originalSiblingIndex;if(null!=t&&t.isValid&&t.activeInHierarchy){var i=t.parent;if(null!=i&&i.isValid){var a=t.getSiblingIndex(),o=i.children.length;a!==n&&(n>=o||t.setSiblingIndex(n))}}},this.listenEvents$()}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"setLayerPrefab",value:function(e){this.inst.layerPrefab$=e}},{key:"createLayer",value:function(e,t,n){var i=this.inst;if(null!=e&&e.isValid)if(i.layerNodes.has(t))console.warn('[SortNode] createLayer: Layer "'.concat(t,'" already exists'));else{var a;if(i.layerPrefab$){(a=ye(i.layerPrefab$)).name="Layer:".concat(t);var o=a.getComponentInChildren(K);o&&(o.string=t)}else a=new q("Layer:".concat(t));e.insertChild(a,n),i.layerNodes.set(t,a),console.debug('[SortNode] createLayer: "'.concat(t,'" in ').concat(e.name," at depth ").concat(n))}else console.warn('[SortNode] createLayer: Invalid container for layer "'.concat(t,'"'))}},{key:"setNodeToLayer",value:function(e,t){var n=this,i=this.inst;if(null!=e&&e.isValid)if(i.layerNodes.get(t)){if(!i.nodeMetadata.has(e.uuid)){var a=e.parent;if(a){var o=function(){n.removeNodeFromLayer(e)};e.once(xe.NODE_DESTROYED,o);var r=function(){var t=i.nodeMetadata.get(e.uuid);t&&(t.needsPositionUpdate=!0)};a.on(xe.TRANSFORM_CHANGED,r),i.nodeMetadata.set(e.uuid,{node:e,layer:t,originalParent:a,originalSiblingIndex:e.getSiblingIndex(),originalLocalTransform:{position:e.getPosition().clone(),rotation:e.getRotation().clone(),scale:e.getScale().clone()},eventHandler:o,parentTransformHandler:r,keepInLayer:!1,needsPositionUpdate:!1})}else console.warn("[SortNode] setNodeToLayer: Node has no parent")}}else console.error('[SortNode] setNodeToLayer: Layer "'.concat(t,'" not found'));else console.warn('[SortNode] setNodeToLayer: Invalid node for layer "'.concat(t,'"'))}},{key:"removeNodeFromLayer",value:function(e){var t=this.inst,n=t.nodeMetadata.get(e.uuid);n&&(e.off(xe.NODE_DESTROYED,n.eventHandler),n.originalParent.off(xe.TRANSFORM_CHANGED,n.parentTransformHandler),n.keepInLayer=!1,t.restoreNode$(n),t.revertNodeSiblingIndex$(n),t.movedNodes.delete(e.uuid),t.nodeMetadata.delete(e.uuid))}},{key:"keepNodeInLayer",value:function(e){var t=this.inst;if(null!=e&&e.isValid){var n=t.nodeMetadata.get(e.uuid);n?n.keepInLayer=!0:console.warn("[SortNode] keepNodeInLayer: Node not found in layer")}else console.warn("[SortNode] keepNodeInLayer: Invalid node")}},{key:"setActiveLayer",value:function(e,t){var n=this.inst;if(n.layerNodes.has(e)){var i=n.layerNodes.get(e);i&&(i.active=t),console.debug('[SortNode] setActiveLayer: Layer "'.concat(e,'" ').concat(t?"enabled":"disabled"))}else console.warn('[SortNode] setActiveLayer: Layer "'.concat(e,'" not found'))}}]),n}());S._RF.pop(),S._RF.push({},"46f05OkhTtGz6xBJuPMZGqH","ScoreBlock",void 0);var AB,TB,PB,OB,LB,IB,RB,_B,DB,MB=C.ccclass,NB=C.property,BB=C.disallowMultiple,FB=(yB=MB("ScoreBlock"),vB=NB(K),fB=NB(W),gB=NB({visible:function(){return this.isResizeWidth}}),mB=Yn.onlyRunInLifeCycle,yB(bB=BB((SB=a((wB=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"scoreText",SB,l(e)),r(e,"isResizeWidth",kB,l(e)),r(e,"maxScoreWidth",CB,l(e)),e.panelWidthDiff=0,e}return e(d,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(P),this.scoreUITransform=this.scoreText.node.getComponent(P),this.panelWidthDiff=this.uiTransform.width-this.maxScoreWidth,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateScore",value:(u=o((function*(e){var t=this,n=e-this.score,i=R(this.node).to(.1,{},{onUpdate:function(e,i){if(i){var a=Math.floor(n*i)+t.score;t.scoreText.string=a.toString(),t.resizeWidth()}}});yield Ve.runTweenAsync(i),this.setScore(e),yield this.resizeWidth()})),function(e){return u.apply(this,arguments)})},{key:"setScore",value:function(e){var t=null!=e?e:0;this.score=t,this.scoreText.string=t.toString()}},{key:"resizeWidth",value:(s=o((function*(){var e=this;if(this.isResizeWidth){var t=this.uiTransform.width,n=(this.scoreUITransform.width>this.maxScoreWidth?this.scoreUITransform.width:this.maxScoreWidth)+this.panelWidthDiff;n<=t&&0!==this.score||(this.uiTween&&this.uiTween.stop(),this.uiTween=R(this.node).to(.05,{},{easing:"sineOut",onUpdate:function(i,a){a&&(e.uiTransform.width=te.lerp(t,n,a))}}),yield Ve.runTweenAsync(this.uiTween),this.uiTransform.width=n,EB.setNodeToLayer(this.scoreText.node,"GameUnpackLabel"))}})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"scoreText",[vB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kB=a(wB.prototype,"isResizeWidth",[fB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),CB=a(wB.prototype,"maxScoreWidth",[gB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(wB.prototype,"setScore",[mB],Object.getOwnPropertyDescriptor(wB.prototype,"setScore"),wB.prototype),bB=wB))||bB)||bB);S._RF.pop(),S._RF.push({},"424745QWUlDPabdCe8UcRwy","ChallengeScoreBlock",void 0);var xB,zB,UB,GB,HB,qB,VB,$B=C.ccclass,WB=C.property,KB=(AB=$B("ChallengeScoreBlock"),TB=WB(F),PB=WB(ue),OB=WB(q),AB((RB=a((IB=function(a){n(p,a);var s,u,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"avatar",RB,l(e)),r(e,"defaultAvatar",_B,l(e)),r(e,"defaultAvatarNode",DB,l(e)),e.playerAvatarOverlay=null,e.isOverlayMode=!1,e.setAvatarSpriteFrame$=function(t){e.isValid&&(e.avatar.spriteFrame=t)},e.createAvatarOverlay$=function(){try{jM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.playerAvatarOverlay=new ZM(e.node.scene)}catch(e){return}},e.handleScoreBlockPositionChange$=function(){var t;if(e.isOverlayMode){var n=e.getDefaultAvatarPosition$(),i=n.worldX,a=n.worldY;null===(t=e.playerAvatarOverlay)||void 0===t||t.moveOverlayTo(i,a)}},e.getDefaultAvatarPosition$=function(){var t=e.defaultAvatarNode;return{worldX:t.worldPositionX,worldY:t.worldPositionY}},e.getDefaultAvatarWidth$=function(){var t=e.defaultAvatarNode.getComponent(P);return t?t.width:0},e}return e(p,[{key:"onLoad",value:function(){c(d(p.prototype),"onLoad",this).call(this),this.createAvatarOverlay$()}},{key:"onDisable",value:function(){this.cleanupOverlay()}},{key:"updateInfo",value:(u=o((function*(e,t,n){var i=this;this.setScore(n),this.scheduleOnce((function(){return i.resizeWidth()}),0);try{if(this.isOverlayMode){if(yield this.showAvatarOverlay(t))return;this.isOverlayMode=!1}var a=yield pN.getPlayerAvatar(e,t,50);if(!a)return;a.packable=!0,this.setAvatarSpriteFrame$(a)}catch(e){this.setAvatarSpriteFrame$(this.defaultAvatar)}})),function(e,t,n){return u.apply(this,arguments)})},{key:"showAvatarOverlay",value:(s=o((function*(e){var t,n=this.getDefaultAvatarPosition$(),i=n.worldX,a=n.worldY,o=yield null===(t=this.playerAvatarOverlay)||void 0===t?void 0:t.updateOverlay({playerId:e,worldX:i,worldY:a,avatarWidth:this.getDefaultAvatarWidth$()});return null!=o&&o})),function(e){return s.apply(this,arguments)})},{key:"cleanupOverlay",value:function(){var e;null===(e=this.playerAvatarOverlay)||void 0===e||e.hideOverlay()}},{key:"update",value:function(e){this.handleScoreBlockPositionChange$()}}]),p}(FB)).prototype,"avatar",[TB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_B=a(IB.prototype,"defaultAvatar",[PB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DB=a(IB.prototype,"defaultAvatarNode",[OB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LB=IB))||LB);S._RF.pop(),S._RF.push({},"aa96ehFCjBCy6vss3wBcr+l","CustomScoreContainer",void 0);var jB,YB,XB,JB,ZB,QB,eF,tF,nF,iF,aF,oF,rF,lF,sF,uF,cF,dF,hF,pF,yF,vF,fF=C.ccclass,gF=C.property,mF=C.disallowMultiple,bF=(xB=fF("CustomScoreContainer"),zB=gF(q),UB=gF(K),xB(GB=mF((qB=a((HB=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"customScoreBlock",qB,l(e)),r(e,"scoreText",VB,l(e)),e}return e(s,[{key:"updateStatus",value:function(){iv.getMatchMode()===lv?(this.customScoreBlock.active=!0,this.scoreText.string="".concat(wv.getCustomBonus(),"%")):this.customScoreBlock.active=!1}}]),s}(T)).prototype,"customScoreBlock",[zB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VB=a(HB.prototype,"scoreText",[UB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GB=HB))||GB)||GB);S._RF.pop(),S._RF.push({},"b1ef276tNtH+oc5BqYfDMXl","Sidebar",void 0);var wF,SF,kF,CF,EF,AF,TF,PF,OF,LF,IF,RF=C.ccclass,_F=C.property,DF=C.disallowMultiple,MF={score:-589.003,item:-861.836,sidebar:1114},NF={score:-568.518,item:-981.836,sidebar:1222},BF=(jB=RF("Sidebar"),YB=_F(FB),XB=_F(q),JB=_F(K),ZB=_F(q),QB=_F(I),eF=_F(q),tF=_F(bF),nF=_F(Ee),iF=_F(B),aF=Yn.onlyRunInLifeCycle,jB(oF=DF((lF=a((rF=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"scoreBlock",lF,l(e)),r(e,"itemContainer",sF,l(e)),r(e,"levelNumber",uF,l(e)),r(e,"sidebarContainer",cF,l(e)),r(e,"sidebarBackground",dF,l(e)),r(e,"leavesContainer",hF,l(e)),r(e,"customScoreContainer",pF,l(e)),r(e,"entranceCurve",yF,l(e)),r(e,"uiOpacity",vF,l(e)),e.originSidebarPosition=0,e.originLeavesPosition=0,e}return e(d,[{key:"saveOriginPos",value:function(){this.originSidebarPosition=this.sidebarContainer.position.y,this.originLeavesPosition=this.leavesContainer.position.y}},{key:"initUIPos",value:function(){this.sidebarContainer.setPosition(this.sidebarContainer.position.x,this.originSidebarPosition+1250),this.leavesContainer.setPosition(this.leavesContainer.position.x,this.originLeavesPosition+150)}},{key:"playExitAnimUI",value:(u=o((function*(e){var t=this,n=function(){return t.setActive(!1)};e.addAbortListener(n);var i=R(this.sidebarContainer).to(.2,{position:new V(this.sidebarContainer.position.x,this.originSidebarPosition+1250,0)},{easing:"quadIn"}),a=R(this.leavesContainer);a.delay(.1).to(.2,{position:new V(this.leavesContainer.position.x,this.originLeavesPosition+150,0)},{easing:"quadIn"}),yield Promise.all([Ve.runTweenAsync(i,e),Ve.runTweenAsync(a,e)]),e.removeAbortListener(n),e.aborted||this.setActive(!1)})),function(e){return u.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(s=o((function*(e){var t=this;this.setActive(!0);var n=R(this.sidebarContainer).to(.3,{position:new V(this.sidebarContainer.position.x,this.originSidebarPosition,0)},{easing:function(e){return t.entranceCurve.evaluate(e)}}),i=R(this.leavesContainer);i.to(.2,{position:new V(this.leavesContainer.position.x,this.originLeavesPosition,0)},{easing:"quadIn"}),yield Promise.all([Ve.runTweenAsync(n,e),Ve.runTweenAsync(i,e)])})),function(e){return s.apply(this,arguments)})},{key:"setActive",value:function(e){this.uiOpacity&&(this.uiOpacity.opacity=e?255:0)}},{key:"setLevelText",value:function(e){this.levelNumber.string=e.toString()}},{key:"updateStatus",value:function(e){void 0!==e.score&&this.scoreBlock.setScore(e.score),void 0!==e.level&&this.setLevelText(e.level),this.customScoreContainer.updateStatus(),this.updateUIByMode()}},{key:"updateScore",value:function(e){this.scoreBlock.updateScore(e)}},{key:"updateUIByMode",value:function(){var e=iv.getMatchMode()===lv?NF:MF;this.scoreBlock.node.position.set(this.scoreBlock.node.position.x,e.score),this.itemContainer.position.set(this.itemContainer.position.x,e.item),this.sidebarContainer.getComponent(P).height=e.sidebar,this.sidebarBackground.updateAlignment()}}]),d}(T)).prototype,"scoreBlock",[YB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sF=a(rF.prototype,"itemContainer",[XB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uF=a(rF.prototype,"levelNumber",[JB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cF=a(rF.prototype,"sidebarContainer",[ZB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dF=a(rF.prototype,"sidebarBackground",[QB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hF=a(rF.prototype,"leavesContainer",[eF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pF=a(rF.prototype,"customScoreContainer",[tF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yF=a(rF.prototype,"entranceCurve",[nF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ee}}),vF=a(rF.prototype,"uiOpacity",[iF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(rF.prototype,"setActive",[aF],Object.getOwnPropertyDescriptor(rF.prototype,"setActive"),rF.prototype),oF=rF))||oF)||oF);S._RF.pop(),S._RF.push({},"0ff4fFbKylIvaONtaTZkRQV","LandscapeLayout",void 0);var FF,xF,zF,UF,GF,HF,qF,VF=C.ccclass,$F=C.property,WF=codex.match,KF=Ludex.Match.Modes,jF=(wF=VF("LandscapeLayout"),SF=$F({type:BF,group:"Sidebar"}),kF=$F({type:KB,group:"ChallengeScore"}),CF=$F({type:KB,group:"ChallengeScore"}),EF=$F(q),wF((PF=a((TF=function(a){n(y,a);var s,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"sidebar",PF,l(e)),r(e,"playerScoreBlock",OF,l(e)),r(e,"opponentScoreBlock",LF,l(e)),r(e,"topAnimNodes",IF,l(e)),e.originTopNodesPos=[],e}return e(y,[{key:"onLoad",value:function(){var e=this;A.once(Z.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"saveOriginPos",value:function(){this.sidebar.saveOriginPos();var e,t=u(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}}},{key:"initUIPos",value:function(){var e=this;this.sidebar.initUIPos(),this.topAnimNodes.forEach((function(t,n){var i=e.originTopNodesPos[n].clone();i.y+=100,t.setPosition(i)}))}},{key:"playExitAnimUI",value:(h=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new Ni;var n=[];this.topAnimNodes.forEach((function(i,a){var o=new V(e.node.position.x,e.originTopNodesPos[a].y+100,0),r=R(i);r.to(t,{position:o},{easing:"backIn"}),n.push(Ve.runTweenAsync(r,e.exitSignal))})),n.push(this.sidebar.playExitAnimUI(this.exitSignal)),yield Promise.all(n)})),function(){return h.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(s=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new Ni;var n=[];this.topAnimNodes.forEach((function(i,a){var o=new V(e.node.position.x,e.originTopNodesPos[a].y,0),r=R(i);r.to(t,{position:o},{easing:"backOut"}),n.push(Ve.runTweenAsync(r,e.entranceSignal))})),n.push(this.sidebar.playEntranceAnimUI(this.entranceSignal)),yield Promise.all(n)})),function(){return s.apply(this,arguments)})},{key:"setLevelText",value:function(e){this.sidebar.setLevelText(e)}},{key:"updateStatus",value:function(e){c(d(y.prototype),"updateStatus",this).call(this,e),this.sidebar.updateStatus(e),this.updateScoreBlockStatus(e)}},{key:"updateScoreBlockStatus",value:function(e){var t;if(iv.getMatchMode()!==KF.CHALLENGE_FRIEND)return this.playerScoreBlock.node.active=!1,void(this.opponentScoreBlock.node.active=!1);if(!this.playerScoreBlock.node.active){var n=WF.getMatchState(),i=null!==(t=iv.getMatchCustomData())&&void 0!==t?t:{},a=i.playerId,o=i.opponentId;if(a&&o){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var r=n.profiles[a],l=n.profiles[o];r&&this.playerScoreBlock.updateInfo(r.photo,a,r.score),l&&this.opponentScoreBlock.updateInfo(l.photo,o,l.score),void 0!==e.score&&this.playerScoreBlock.setScore(e.score)}}}},{key:"handleScoreUpdated",value:function(e){this.sidebar.updateScore(e),this.playerScoreBlock.node.active&&this.playerScoreBlock.updateScore(e)}}]),y}(pB)).prototype,"sidebar",[SF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OF=a(TF.prototype,"playerScoreBlock",[kF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LF=a(TF.prototype,"opponentScoreBlock",[CF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IF=a(TF.prototype,"topAnimNodes",[EF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),AF=TF))||AF);S._RF.pop(),S._RF.push({},"396015KIPBL3bHTUOHN7pCl","UIMasks",void 0);var YF,XF,JF,ZF,QF,ex,tx,nx,ix,ax,ox,rx,lx,sx,ux,cx,dx=C.ccclass,hx=C.property,px=(FF=dx("UIMasks"),xF=hx(qr),zF=hx(mR),FF((HF=a((GF=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"background",HF,l(e)),r(e,"alphaMasks",qF,l(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(u=o((function*(){this.alphaMasks.setMaskActive(0,Ze.isPortrait()),this.alphaMasks.setMaskActive(1,Ze.isLandscape()),yield this.background.changeStateFade(!0,.25)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(s=o((function*(){yield this.background.changeStateFade(!1,.25)})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"background",[xF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qF=a(GF.prototype,"alphaMasks",[zF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UF=GF))||UF);S._RF.pop(),S._RF.push({},"755d1r2cMRLvo4fObNWxss/","CoinContainer",void 0);var yx,vx,fx,gx,mx,bx,wx,Sx,kx,Cx=C.ccclass,Ex=C.property,Ax=Ludex.Utils.Number,Tx=(YF=Cx("CoinContainer"),XF=Ex(K),JF=Ex(F),ZF=Ex(B),QF=Ex(ee),ex=Yn.onlyRunInLifeCycle,tx=Yn.onlyRunInLifeCycleAsync,nx=Yn.onlyRunInLifeCycleAsync,ix=Yn.onlyRunInLifeCycle,ax=Yn.onlyRunInLifeCycle,YF((lx=a((rx=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"coinLabel",lx,l(e)),r(e,"coinIcon",sx,l(e)),r(e,"explosionCircle",ux,l(e)),r(e,"explosionParticles",cx,l(e)),e.currentCoin=0,e}return e(h,[{key:"setCoinTextFromNumber",value:function(e){var t=Ax.getShortNumber(e,3);this.coinLabel.string=t}},{key:"handleAddCoinButton",value:function(){lt.openScreen(st.GET_COIN_SCREEN,{quantity:Cy})}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenToEvents(),this.explosionParticles.node.active=!1}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenToEvents",value:function(){this.node.scene.on(Es.COIN_CHANGED,this.updateCoins,this)}},{key:"updateCoins",value:(c=o((function*(e){var t,n,i,a=e.coins,o=e.collectionAnimation,r=e.playSound;if(void 0!==o&&!1!==this.node.activeInHierarchy){var l=o.signal;if(null===(t=this.animAbortSignal)||void 0===t||t.abort(),this.animAbortSignal=null!=l?l:new Ni,o.animateTextOnly)return yield this.animateCoinText(a,0,r,l),void this.setCoins(a);var s=null!==(n=o.flyDuration)&&void 0!==n?n:0,u=(null!==(i=o.floatDuration)&&void 0!==i?i:0)+s;yield this.animateCoinText(a,u,r,l),this.setCoins(a)}else this.setCoins(a)})),function(e){return c.apply(this,arguments)})},{key:"setCoins",value:function(e){this.setCoinTextFromNumber(e),this.currentCoin=e}},{key:"animateCoinText",value:(u=o((function*(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3?arguments[3]:void 0,o=this.currentCoin;yield Ve.waitTweenAsync(t,a),i&&je.playSound(Qi.COLLECT_COINS),yield Ve.runOnUpdateAsync(this.node,1,(function(t){var i=Math.round(o+(e-o)*t);n.setCoinTextFromNumber(i)}),a)})),function(e,t){return u.apply(this,arguments)})},{key:"emitExplodeEffect",value:(s=o((function*(e){this.initializeExplosionCircle(),this.explosionParticles.resetSystem(),yield Promise.all([Ve.runTweenAsync(R(this.explosionCircle.node).to(.4,{scale:new V(3,3,3)},{easing:"quadOut"}),e),Ve.runTweenAsync(R(this.explosionCircle).delay(.2).to(.2,{opacity:0}),e)]),this.resetExplosionCircle()})),function(e){return s.apply(this,arguments)})},{key:"resetExplosionCircle",value:function(){this.explosionCircle.node.setScale(0,0),this.explosionCircle.opacity=0,this.explosionCircle.node.active=!1,this.explosionParticles.node.active=!1}},{key:"initializeExplosionCircle",value:function(){this.explosionCircle.node.active=!0,this.explosionParticles.node.active=!0,this.explosionCircle.opacity=255,this.explosionCircle.node.setScale(0,0)}},{key:"getCoinIconWorldPosition",value:function(){return this.coinIcon.node.worldPosition}},{key:"getCoinIconWorldScale",value:function(){return this.coinIcon.node.worldScale}},{key:"onDestroy",value:function(){var e;null===(e=this.animAbortSignal)||void 0===e||e.abort()}}]),h}(T)).prototype,"coinLabel",[XF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sx=a(rx.prototype,"coinIcon",[JF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ux=a(rx.prototype,"explosionCircle",[ZF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cx=a(rx.prototype,"explosionParticles",[QF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(rx.prototype,"setCoins",[ex],Object.getOwnPropertyDescriptor(rx.prototype,"setCoins"),rx.prototype),a(rx.prototype,"animateCoinText",[tx],Object.getOwnPropertyDescriptor(rx.prototype,"animateCoinText"),rx.prototype),a(rx.prototype,"emitExplodeEffect",[nx],Object.getOwnPropertyDescriptor(rx.prototype,"emitExplodeEffect"),rx.prototype),a(rx.prototype,"resetExplosionCircle",[ix],Object.getOwnPropertyDescriptor(rx.prototype,"resetExplosionCircle"),rx.prototype),a(rx.prototype,"initializeExplosionCircle",[ax],Object.getOwnPropertyDescriptor(rx.prototype,"initializeExplosionCircle"),rx.prototype),ox=rx))||ox);S._RF.pop(),S._RF.push({},"f963aJjCvtD0Y2LplwjDer1","ScoreContainer",void 0);var Px,Ox,Lx,Ix,Rx,_x,Dx,Mx,Nx,Bx,Fx,xx,zx,Ux,Gx,Hx,qx,Vx,$x,Wx,Kx=C.ccclass,jx=C.property,Yx=Ludex.Match.Modes,Xx=codex.match,Jx=(yx=Kx("ScoreContainer"),vx=jx(FB),fx=jx(KB),gx=jx(KB),yx((wx=a((bx=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"scoreBlock",wx,l(e)),r(e,"playerScoreBlock",Sx,l(e)),r(e,"opponentScoreBlock",kx,l(e)),e.scoreBlockShown=!0,e.challengeScoreBlockShown=!1,e}return e(s,[{key:"updateStatus",value:function(e){switch(Xx.getMatchState().mode){case Yx.CHALLENGE_FRIEND:this.showChallengeScoreBlock(),this.hideScoreBlock(),void 0!==e.score&&this.playerScoreBlock.setScore(e.score);break;case Yx.SINGLE:case lv:this.hideChallengeScoreBlock(),this.showScoreBlock(),void 0!==e.score&&this.scoreBlock.setScore(e.score);break;default:this.hideScoreBlock(),this.hideChallengeScoreBlock()}}},{key:"showChallengeScoreBlock",value:function(){var e;if(!this.challengeScoreBlockShown){this.challengeScoreBlockShown=!0;var t=Xx.getMatchState(),n=null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{},i=n.playerId,a=n.opponentId;if(i&&a){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var o=t.profiles[i],r=t.profiles[a];o&&r&&(this.playerScoreBlock.updateInfo(o.photo,i,o.score),this.opponentScoreBlock.updateInfo(r.photo,a,r.score))}}}},{key:"hideChallengeScoreBlock",value:function(){this.challengeScoreBlockShown&&(this.challengeScoreBlockShown=!1,this.playerScoreBlock.node.active=!1,this.opponentScoreBlock.node.active=!1,this.playerScoreBlock.cleanupOverlay(),this.opponentScoreBlock.cleanupOverlay())}},{key:"showScoreBlock",value:function(){var e;if(!this.scoreBlockShown){this.scoreBlockShown=!0;var t=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).score;this.scoreBlock.node.active=!0,this.scoreBlock.setScore(t)}}},{key:"hideScoreBlock",value:function(){this.scoreBlockShown&&(this.scoreBlockShown=!1,this.scoreBlock.node.active=!1)}},{key:"updateScore",value:function(e){this.challengeScoreBlockShown?this.playerScoreBlock.updateScore(e):this.scoreBlockShown&&this.scoreBlock.updateScore(e)}}]),s}(T)).prototype,"scoreBlock",[vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sx=a(bx.prototype,"playerScoreBlock",[fx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kx=a(bx.prototype,"opponentScoreBlock",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mx=bx))||mx);S._RF.pop(),S._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var Zx,Qx,ez,tz,nz,iz,az,oz,rz,lz=C.ccclass,sz=C.property,uz=(Px=lz("Header"),Ox=sz(th),Lx=sz(q),Ix=sz(q),Rx=sz(q),_x=sz(q),Dx=sz(Jx),Mx=sz(Tx),Nx=sz(bF),Bx=Yn.onlyRunInLifeCycle,Px((zx=a((xx=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"levelTextLocalizer",zx,l(e)),r(e,"settingNode",Ux,l(e)),r(e,"homeNode",Gx,l(e)),r(e,"leftNode",Hx,l(e)),r(e,"coinNode",qx,l(e)),r(e,"scoreContainer",Vx,l(e)),r(e,"coinContainer",$x,l(e)),r(e,"customScoreContainer",Wx,l(e)),e}return e(s,[{key:"onLoad",value:function(){this.uiOpacity=this.node.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateStatus",value:function(e){this.scoreContainer.updateStatus(e),void 0!==e.coins&&this.coinContainer.setCoins(e.coins),void 0!==e.level&&this.setLevelText(e.level)}},{key:"highlightCoinContainer",value:function(){var e=re("Canvas/Screens");if(e){var t=this.coinNode.worldPosition.clone();this.coinNode.parent=e,this.coinNode.worldPosition=t}}},{key:"removeCoinContainerHighlight",value:function(){var e=this.coinNode.worldPosition.clone();this.coinNode.parent=this.leftNode,this.coinNode.worldPosition=e}},{key:"setLevelText",value:function(e){this.levelTextLocalizer.setParams([e.toString()])}},{key:"setButtonsInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.settingNode.getComponent(G).interactable=e,this.homeNode.getComponent(G).interactable=e}},{key:"setActive",value:function(e){this.uiOpacity.opacity=e?255:0}}]),s}(T)).prototype,"levelTextLocalizer",[Ox],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ux=a(xx.prototype,"settingNode",[Lx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gx=a(xx.prototype,"homeNode",[Ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hx=a(xx.prototype,"leftNode",[Rx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qx=a(xx.prototype,"coinNode",[_x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vx=a(xx.prototype,"scoreContainer",[Dx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$x=a(xx.prototype,"coinContainer",[Mx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wx=a(xx.prototype,"customScoreContainer",[Nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(xx.prototype,"setActive",[Bx],Object.getOwnPropertyDescriptor(xx.prototype,"setActive"),xx.prototype),Fx=xx))||Fx);S._RF.pop(),S._RF.push({},"456584ngz9FupmxndAXqCbY","PortraitLayout",void 0);var cz=C.ccclass,dz=C.property,hz=(Zx=cz("PortraitLayout"),Qx=dz(uz),ez=dz([q]),tz=dz([q]),Zx((az=a((iz=function(a){n(y,a);var s,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"header",az,l(e)),r(e,"topAnimNodes",oz,l(e)),e.originTopNodesPos=[],r(e,"botAnimNodes",rz,l(e)),e.originBotNodesPos=[],e.hideBotWorldY=-80,e}return e(y,[{key:"onLoad",value:function(){var e=this;this.validateRequiredComponents(),A.once(Z.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"saveOriginPos",value:function(){var e,t=u(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}var i,a=u(this.botAnimNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.originBotNodesPos.push(o.position.clone())}}catch(e){a.e(e)}finally{a.f()}}},{key:"initUIPos",value:function(){var e=this;this.topAnimNodes.forEach((function(t,n){var i,a,o=null!==(i=null===(a=e.originTopNodesPos[n])||void 0===a?void 0:a.clone())&&void 0!==i?i:new V(0,0,0);o.y+=200,t.setPosition(o)}));var t=new V(0,this.hideBotWorldY,0);this.botAnimNodes.forEach((function(n,i){var a,o,r,l,s=null!==(a=null===(o=e.originBotNodesPos[i])||void 0===o?void 0:o.clone())&&void 0!==a?a:new V(0,0,0);t.y=e.hideBotWorldY;var u=null!==(r=null===(l=n.parent)||void 0===l?void 0:l.inverseTransformPoint(t,t).y)&&void 0!==r?r:200;s.y=u,n.setPosition(s)}))}},{key:"setLevelText",value:function(e){this.header.setLevelText(e)}},{key:"disableLayout",value:function(){this.header.setButtonsInteractable(!1)}},{key:"enableLayout",value:function(){this.header.setButtonsInteractable()}},{key:"updateStatus",value:function(e){c(d(y.prototype),"updateStatus",this).call(this,e),this.header.updateStatus(e)}},{key:"playExitAnimUI",value:(h=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new Ni;var n=[];this.topAnimNodes.forEach((function(i,a){var o,r,l=new V(i.position.x,(null!==(o=null===(r=e.originTopNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0)+200,0),s=R(i);s.to(t,{position:l},{easing:"backIn"}),n.push(Ve.runTweenAsync(s,e.exitSignal))}));var i,a=new V(0,this.hideBotWorldY,0),o=u(this.botAnimNodes);try{for(o.s();!(i=o.n()).done;){var r,l,s=i.value;a.y=this.hideBotWorldY;var c=null!==(r=null===(l=s.parent)||void 0===l?void 0:l.inverseTransformPoint(a,a).y)&&void 0!==r?r:200,d=new V(s.position.x,c,0),h=R(s);h.to(t,{position:d},{easing:"backIn"}),n.push(Ve.runTweenAsync(h,this.exitSignal))}}catch(e){o.e(e)}finally{o.f()}yield Promise.all(n),this.exitSignal.aborted||this.header.setActive(!1)})),function(){return h.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(s=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new Ni,this.header.setActive(!0);var n=[];this.topAnimNodes.forEach((function(i,a){var o,r,l=new V(i.position.x,null!==(o=null===(r=e.originTopNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0,0),s=R(i);s.to(t,{position:l},{easing:"backOut"}),n.push(Ve.runTweenAsync(s,e.entranceSignal))})),this.botAnimNodes.forEach((function(i,a){var o,r,l=new V(i.position.x,null!==(o=null===(r=e.originBotNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0,0),s=R(i);s.to(t,{position:l},{easing:"backOut"}),n.push(Ve.runTweenAsync(s,e.entranceSignal))})),yield Promise.all(n)})),function(){return s.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.header.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.header.removeCoinContainerHighlight()}},{key:"handleScoreUpdated",value:function(e){this.header.scoreContainer.updateScore(e)}}]),y}(pB)).prototype,"header",[Qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oz=a(iz.prototype,"topAnimNodes",[ez],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rz=a(iz.prototype,"botAnimNodes",[tz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nz=iz))||nz);S._RF.pop(),S._RF.push({},"805dbJxaCpKBpzq9ejSgrc8","TileType",void 0);var pz,yz,vz,fz,gz,mz="bomb";S._RF.pop(),S._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var bz,wz,Sz,kz,Cz,Ez,Az,Tz,Pz,Oz,Lz,Iz,Rz,_z,Dz,Mz,Nz,Bz=Ludex,Fz=Bz.Dtos.Player,xz=Bz.Utils.Function,zz=C.ccclass,Uz=C.property,Gz=codex,Hz=Gz.player,qz=Gz.language,Vz=(pz=zz("DevToolsContainer"),yz=Uz(q),pz((gz=a((fz=function(a){n(y,a);var s,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"devToolsToggle",gz,l(e)),e.isActive=!0,e.game=null,e.bundleName="lowest",e.currentLocaleIndex=0,e.debouncedStarsNotification=xz.debounce((function(){var e=Hz.getGameData();e&&lt.showNotificationScreen("Stars added. Current stars: ".concat(e.stars))}),700),e}return e(y,[{key:"injectGameplay",value:function(e){this.game=e}},{key:"start",value:function(){this.initCurrentLocale()}},{key:"initCurrentLocale",value:function(){var e=qz.getCurrentLocale();this.currentLocaleIndex=et.indexOf(e)}},{key:"hideAllButtons",value:function(){var e,t=this.getComponentsInChildren(G),n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!1))}}catch(e){n.e(e)}finally{n.f()}}},{key:"showAllButtons",value:function(){var e,t=this.getComponentsInChildren(G),n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!0))}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleClickDevToolsButton",value:function(){this.isActive?(this.hideAllButtons(),this.isActive=!1):(this.showAllButtons(),this.isActive=!0)}},{key:"handleResetData",value:function(){Hz.setPlayerData(Fz.Data.getDefaults()),lt.openScreen(st.NOTIFICATION_SCREEN,{duration:3,message:"Items and stars will only be reset if you refresh the game page now."}),this.node.scene.emit(Es.START_OVER,0)}},{key:"handleNextLevel",value:(h=o((function*(){var e,t,n,i=(null!==(e=null===(t=this.game)||void 0===t||null===(t=t.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1)+1;null===(n=this.game)||void 0===n||n.setGameData({level:i-1}),Hz.setGameData({level:i}),this.node.scene.emit(Es.NEXT_LEVEL)})),function(){return h.apply(this,arguments)})},{key:"handlePrevLevel",value:(d=o((function*(){var e,t,n,i=Math.max((null!==(e=null===(t=this.game)||void 0===t||null===(t=t.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:2)-1,1);null===(n=this.game)||void 0===n||n.setGameData({level:i-1}),Hz.setGameData({level:i}),this.node.scene.emit(Es.NEXT_LEVEL)})),function(){return d.apply(this,arguments)})},{key:"handleEnterSelectLevel",value:(c=o((function*(e){var t,n=Number(e.string);null===(t=this.game)||void 0===t||t.setGameData({level:n-1}),Hz.setGameData({level:n}),this.node.scene.emit(Es.NEXT_LEVEL)})),function(e){return c.apply(this,arguments)})},{key:"handleClickBuildVersionButton",value:function(){var e=codex.getBuildVersion();lt.showNotificationScreen("Build version: ".concat(e))}},{key:"handleClickWinLevelButton",value:function(){this.node.scene.emit(Es.GAME_FINISH)}},{key:"handleClickTimeOutButton",value:function(){var e;null===(e=this.game)||void 0===e||e.clockManager.setTime(.1)}},{key:"handleClickExplodeButton",value:function(){var e,t,n=this.game;if(n){var i=null===(e=n.getGameData())||void 0===e||null===(e=e.levelData)||void 0===e?void 0:e.specials.bomb;if(i&&!(i<=0)){var a=n.board.getBombTiles();if(0!==a.length){var o=a[0];if(!o||(null===(t=o.special)||void 0===t?void 0:t.type)!==mz)throw new Error("Invalid bomb tile");o.special.detonateImmediately()}else console.info("No bomb tiles found")}}}},{key:"handleFillItem",value:function(){this.node.scene.emit(Es.ADD_ITEM,{item:nt.HINT,quantity:2}),this.node.scene.emit(Es.ADD_ITEM,{item:nt.STORM,quantity:2}),this.node.scene.emit(Es.ADD_ITEM,{item:nt.THUNDER,quantity:2}),this.node.scene.emit(Es.ADD_ITEM,{item:nt.PLIERS,quantity:2})}},{key:"handleAutoPlay",value:function(){this.node.scene.emit(Es.AUTO_PLAY)}},{key:"handleAddStars",value:function(){var e=Hz.getGameData();e&&(Hz.setGameData({stars:e.stars+10}),this.debouncedStarsNotification())}},{key:"handleSwitchQualityAssets",value:function(){switch(this.bundleName){case"lowest":this.bundleName="highest";break;case"highest":this.bundleName="lowest"}D.emit($e.REQUEST_UPGRADE_ASSET,{quality:this.bundleName})}},{key:"handleSwitchLocale",value:(s=o((function*(){this.currentLocaleIndex=(this.currentLocaleIndex+1)%et.length;var e=et[this.currentLocaleIndex];lt.showLoadingNotificationScreen();try{if(!e)throw new Error("Locale is undefined");yield this.preloadLanguageAsync(e),D.emit($e.CHOOSE_LANGUAGE,{locale:e,saveToPlayerData:!0}),lt.showNotificationScreen("Language changed to ".concat(e))}catch(e){console.error(e),lt.showNotificationScreen("Failed to change language")}})),function(){return s.apply(this,arguments)})},{key:"preloadLanguageAsync",value:function(e){return new Promise((function(t,n){D.emit($e.PRELOAD_LANGUAGE,{locale:e,onLoad:t,onError:n})}))}}]),y}(T)).prototype,"devToolsToggle",[yz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vz=fz))||vz);S._RF.pop(),S._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var $z,Wz,Kz,jz,Yz,Xz,Jz,Zz,Qz,eU=C.ccclass,tU=C.property,nU=Ludex,iU=nU.Utils.Valid,aU=nU.Match.Modes,oU=Ke.Layout,rU=(bz=eU("UIManager"),wz=tU(YD),Sz=tU(hz),kz=tU(jF),Cz=tU(Vz),Ez=tU(PM),Az=tU(QD),Tz=tU(px),bz((Lz=a((Oz=function(a){n(v,a);var s,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"interstitialAdIndicator",Lz,l(e)),r(e,"portraitLayout",Iz,l(e)),r(e,"landscapeLayout",Rz,l(e)),r(e,"devTools",_z,l(e)),r(e,"comboProgressBar",Dz,l(e)),r(e,"comboContainer",Mz,l(e)),r(e,"uiMasks",Nz,l(e)),e.uiShown=!1,e.config={},e.isResetDataListener=!1,e.showDevTools=function(){e.devTools&&(e.devTools.node.active=!0)},e}return e(v,[{key:"onLoad",value:function(){this.node.scene.on(Iy.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.on(Es.RESCUE_START,this.showRescueAnimation,this),this.node.scene.on(Es.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.on(Es.SCORE_UPDATED,this.handleScoreUpdated,this),D.on($e.ORIENTATION_CHANGED,this.onOrientationChanged,this),this.onOrientationChanged(Ze.getCurrentLayout())}},{key:"onDestroy",value:function(){this.node.scene.off(Iy.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.off(Es.RESCUE_START,this.showRescueAnimation,this),this.node.scene.off(Es.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.off(Es.SCORE_UPDATED,this.handleScoreUpdated,this),D.off($e.ORIENTATION_CHANGED,this.onOrientationChanged,this)}},{key:"init",value:function(e){this.currentLayout=this.portraitLayout,this.game=e,this.initDevTools(e),this.comboContainer.init(e.board)}},{key:"initDevTools",value:function(e){var t=this;this.isResetDataListener||(window.addEventListener("reset-game-data",(function(){var e;null===(e=t.devTools)||void 0===e||e.handleResetData()})),this.isResetDataListener=!0),this.devTools&&(this.devTools.node.active=iU.isDebugger(),this.devTools.injectGameplay(e))}},{key:"setLevelText",value:function(e){this.config.level=e,this.currentLayout.setLevelText(e)}},{key:"startCountdown",value:function(){this.comboProgressBar.resume()}},{key:"pauseTime",value:function(){this.comboProgressBar.pause()}},{key:"resumeTime",value:function(){this.comboProgressBar.resume()}},{key:"setComboUI",value:function(e){this.comboContainer.getComponent(qr).changeStateFade(e,.1)}},{key:"disableLayout",value:function(){this.currentLayout.disableLayout()}},{key:"enableLayout",value:function(){this.currentLayout.enableLayout()}},{key:"updateStatus",value:function(){var e;this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),score:this.game.scoreManager.getCurrentScore(),leaderData:null===(e=this.game.tournamentManager)||void 0===e?void 0:e.leaderData,items:this.game.itemManager.itemConfigs}),this.comboContainer.updateStatus()}},{key:"showRescueAnimation",value:(p=o((function*(){yield this.uiMasks.show()})),function(){return p.apply(this,arguments)})},{key:"hideRescueAnimation",value:(h=o((function*(){yield this.uiMasks.hide()})),function(){return h.apply(this,arguments)})},{key:"playExitAnimUI",value:(d=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.uiShown=!1,yield this.currentLayout.playExitAnimUI(e)})),function(){return d.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(c=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.uiShown=!0,yield this.currentLayout.playEntranceAnimUI(e)})),function(){return c.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.currentLayout.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.currentLayout.unHighlightCoinContainer()}},{key:"handleClickedPauseGame",value:function(){lt.openScreen(st.PAUSE_SCREEN),this.node.scene.emit(Es.GAME_PAUSE)}},{key:"handleReturnHome",value:function(){lt.openScreen(st.QUIT_LEVEL_SCREEN),this.node.scene.emit(Es.GAME_PAUSE)}},{key:"items",get:function(){return this.currentLayout.items}},{key:"setInteractableItems",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=u(this.items);try{for(n.s();!(e=n.n()).done;){var i=e.value;t?void 0!==i.itemType?i.button.interactable=this.game.itemManager.canUseItem(i.itemType):console.warn("Item type is not defined"):i.button.interactable=!1}}catch(e){n.e(e)}finally{n.f()}}},{key:"onOrientationChanged",value:(s=o((function*(e){var t;e===oU.Portrait?(this.landscapeLayout.node.active=!1,this.portraitLayout.node.active=!0,this.currentLayout=this.portraitLayout):e===oU.Landscape&&(this.portraitLayout.node.active=!1,this.landscapeLayout.node.active=!0,this.currentLayout=this.landscapeLayout),this.currentLayout&&(this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),level:this.config.level,score:this.game.scoreManager.getCurrentScore(),time:this.game.clockManager.getRemainingTime(),leaderData:null===(t=this.game.tournamentManager)||void 0===t?void 0:t.leaderData,items:this.game.itemManager.itemConfigs}),yield this.currentLayout.waitForInitAsync(),this.uiShown?this.playEntranceAnimUI(0):this.playExitAnimUI(0))})),function(e){return s.apply(this,arguments)})},{key:"handleScoreUpdated",value:function(e){var t;this.config.score=e,this.currentLayout.handleScoreUpdated(e),iv.getMatchMode()===aU.TOURNAMENT&&this.currentLayout.tournamentRail.handleScoreUpdated({score:e,leaderData:null===(t=this.game.tournamentManager)||void 0===t?void 0:t.leaderData})}}]),v}(T)).prototype,"interstitialAdIndicator",[wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iz=a(Oz.prototype,"portraitLayout",[Sz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rz=a(Oz.prototype,"landscapeLayout",[kz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_z=a(Oz.prototype,"devTools",[Cz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dz=a(Oz.prototype,"comboProgressBar",[Ez],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mz=a(Oz.prototype,"comboContainer",[Az],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nz=a(Oz.prototype,"uiMasks",[Tz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pz=Oz))||Pz);S._RF.pop(),S._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var lU=codex,sU=lU.player,uU=lU.event,cU=lU.match,dU=lU.storage,hU=lU.analytics,pU=lU.monitorError,yU=lU.leaderboard,vU=Ludex,fU=vU.Events,gU=vU.Utils,mU=gU.Time,bU=gU.Array,wU=gU.Valid,SU=vU.Configs.Gameplay,kU=vU.Match.Modes,CU=vU.Plugins.Ads,EU=(void 0===CU?{}:CU).Types,AU=C.ccclass,TU=C.property,PU={level:1,isFromLoader:!1};$z=AU("Gameplay"),Wz=TU(Km),Kz=TU(qr),jz=TU(cw),$z((Jz=a((Xz=function(a){n(p,a);var c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"board",Jz,l(e)),r(e,"opacityToggler",Zz,l(e)),r(e,"pathDraw",Qz,l(e)),e.gameData=null,e.rescueTiles=[],e.isAutoPlayEnabled=!1,e.isAdPreloadedForCurrentLevel=!1,e.handleOpenScreen=function(t){t.screenName===ht[st.GET_ITEM_SCREEN]&&e.uiManager.highlightCoinContainer()},e.handleShowUI=o((function*(){e.uiManager.updateStatus(),e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),yield e.uiManager.playEntranceAnimUI(),e.uiManager.enableLayout(),e.uiManager.setInteractableItems(!0)})),e.handleHideUI=o((function*(){e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),yield e.uiManager.playExitAnimUI()})),e.handleCloseScreen=function(t){t.screenName===ht[st.GET_ITEM_SCREEN]&&e.uiManager.unHighlightCoinContainer()},e.handlePauseGame=function(){e.node.scene.emit(Es.PAUSE_TIME),e.node.pauseSystemEvents(!0),e.opacityToggler.changeStateFade(!1,.1),e.uiManager.setComboUI(!1),e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(){var t;e.node.resumeSystemEvents(!0),e.stateManager.isPlaying()&&e.node.scene.emit(Es.RESUME_TIME),e.processCrazyGamesGameplayStart(),e.opacityToggler.changeStateFade(!0,.1),e.uiManager.setComboUI(!0),null===(t=e.guidelinesManager)||void 0===t||t.startAutoGuides()},e.handleReplayGame=function(){var t=o((function*(t){e.handleHideHint();try{var n=iv.getMatchMode();n!==kU.SINGLE&&n!==lv||(yield iv.finishMatchAsync()),n!==kU.CHALLENGE_FRIEND&&(yield iv.startMatchAsync(t)),n===kU.TOURNAMENT&&(yield iv.setMatchCustomDataAsync({level:1,score:0}),e.setGameData({level:1}))}catch(e){console.warn("handleReplayGame",e)}e.stateManager.initialize()}));return function(e){return t.apply(this,arguments)}}(),e.handleFinishGame=function(){var t;e.attemptCallCreateShortcut(),null!==(t=e.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()?(e.guidelinesManager.guideUi.guideSkipButton.active=!1,e.handleNextLevel()):e.stateManager.finish()},e.handleNextLevel=o((function*(){var t;if(e.gameData){var n=iv.getMatchMode();try{n!==kU.SINGLE&&n!==lv||(yield iv.finishMatchAsync())}catch(e){console.warn("handleNextLevel",e)}var i=(null!==(t=e.gameData.level)&&void 0!==t?t:1)+1;e.setGameData({level:i}),n===kU.TOURNAMENT?yield iv.setMatchCustomDataAsync({level:i}):(yield iv.setMatchCustomDataAsync({level:i,score:0}),yield iv.startMatchAsync()),e.stateManager.initialize(),console.log("Next level",e.gameData.level)}})),e.handleStartOver=function(){var t=o((function*(t){var n;sU.setGameData({level:null!=t?t:1}),yield iv.setMatchCustomDataAsync({level:t,score:0}),e.gameData=sU.getGameData(),e.stateManager.initialize(),console.info("Start over",null===(n=e.gameData)||void 0===n?void 0:n.level)}));return function(e){return t.apply(this,arguments)}}(),e.handleMaxLevel=function(){e.gameData&&(e.initData(),lt.openScreen(st.CONGRATULATION_SCREEN,{level:e.gameData.level}),console.info("Max level",e.gameData.level))},e.handleExitGame=o((function*(){try{dU.setStorageData("dashboard","animateToCurrentLevel",!0),dU.setStorageData("collection","animateMapPackUnlock",!0)}catch(e){console.warn("handleExitGame",e)}})),e.handleTileClick=function(t){e.stateManager.playing(),e.board.handleTileClick(t),e.handleHideHint()},e.handleGridMatchSuccess=function(t,n){e.pathDraw.drawMatchPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)})),e.comboManager.addCombo(),e.handleAddScore(),e.effectManager.playClearEffectAt([n[0].node.worldPosition,n[1].node.worldPosition])},e.handleGridMatchFail=function(t){var n;null!==(n=e.guidelinesManager)&&void 0!==n&&n.isShowErrorPathLevel()&&e.pathDraw.drawErrorPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)}))},e.handleGridClear=o((function*(){var t,n,i,a=e.board.getUncleared();(EU&&10===a.length&&!e.isAdPreloadedForCurrentLevel&&(e.isAdPreloadedForCurrentLevel=!0,Xe.preloadAdsByType(EU.INTERSTITIAL)),0===a.length&&e.node.scene.emit(Es.GAME_FINISH),8===a.length)&&(yield null===(t=e.tournamentManager)||void 0===t?void 0:t.requestLeaderData(),null===(n=e.uiManager)||void 0===n||n.currentLayout.tournamentRail.handleScoreUpdated({score:e.scoreManager.getCurrentScore(),leaderData:null===(i=e.tournamentManager)||void 0===i?void 0:i.leaderData}))})),e.handlePauseTime=function(){e.clockManager.pause(),e.uiManager.pauseTime()},e.handleResumeTime=function(){e.clockManager.resume(),e.uiManager.resumeTime()},e.handleClockTimeout=function(){e.stateManager.fail(av)},e.handleHalfTime=function(){void 0!==e.guidelinesManager&&(e.board.getUncleared().length>=e.board.getCleared().length&&e.guidelinesManager.startThunderGuide()||e.board.getBombTiles().length>0&&e.guidelinesManager.startPliersGuide())},e.handleStartRescue=function(){var t,n,i;if(je.turnDownMusic(),rt.setBlockInput(!0),e.board.setIgnoreInput(!0),e.rescueTiles.length>0){var a,o=u(e.rescueTiles);try{for(o.s();!(a=o.n()).done;){a.value.restore()}}catch(e){o.e(e)}finally{o.f()}e.rescueTiles=[]}var r=null!==(t=iv.getMatchMode())&&void 0!==t?t:void 0;null==hU||hU.levelRescue(null!==(n=null===(i=e.gameData)||void 0===i?void 0:i.level)&&void 0!==n?n:1,void 0,r)},e.handleFinishRescue=function(){rt.setBlockInput(!1),e.board.setIgnoreInput(!1)},e.handleBombExplode=function(){var t=o((function*(t){e.rescueTiles.push(t),e.board.setIgnoreInput(!0),rt.getBlockInput()||(je.playSound(Qi.BOMB_EXPLODE_1),rt.setBlockInput(!0));var n=t.node.worldPosition;yield e.effectManager.createBombExplosionAt(new V(n.x,n.y,0)),rt.setBlockInput(!1),e.stateManager.isFail()||e.stateManager.fail(ov)}));return function(e){return t.apply(this,arguments)}}(),e.handleShowHint=function(){if(!e.pathDraw.isDrawingHint){var t=e.board.getHintPath();t&&(je.playSound(Qi.HINT_ITEM),e.pathDraw.drawHintPath(t,(function(t){return e.board.getAnyTileWorldPosition(t.x,t.y)})),e.board.showHint(),e.node.scene.emit(Es.REFRESH_ITEMS))}},e.handleGridOrientationChange=function(){e.handleHideHint()},e.handleHideHint=function(){e.pathDraw.isDrawingHint&&(e.pathDraw.clearHintPath(),e.board.hideHint(),e.node.scene.emit(Es.REFRESH_ITEMS))},e.handleAddScore=function(){var t=e.levelManager.getLevelData().level,n=e.comboManager.getCombo(),i=e.clockManager.getRemainingTime();e.scoreManager.addScore(t,n,i)},e.handleUseItem=function(){var t=o((function*(t){switch(e.stateManager.playing(),t!==nt.HINT&&e.handleHideHint(),e.itemManager.setQuantity(t,e.itemManager.getQuantity(t)-1),t){case nt.HINT:Zm(e.board,e.pathDraw),e.node.scene.emit(Es.REFRESH_ITEMS);break;case nt.PLIERS:Qm(e.board,e.effectManager),e.node.scene.emit(Es.REFRESH_ITEMS);break;case nt.STORM:e.node.scene.emit(Es.HIDE_UI),e.node.scene.emit(Es.PAUSE_TIME),yield pb(e.board,e.effectManager),e.node.scene.emit(Es.RESUME_TIME),e.node.scene.emit(Es.SHOW_UI);break;case nt.THUNDER:e.node.scene.emit(Es.HIDE_UI),e.node.scene.emit(Es.PAUSE_TIME),yield ob(e.board,e.effectManager),e.board.getUncleared().length>0&&(e.node.scene.emit(Es.RESUME_TIME),e.node.scene.emit(Es.SHOW_UI))}}));return function(e){return t.apply(this,arguments)}}(),e.handleAutoPlay=function(){e.isAutoPlayEnabled?e.disableAutoPlay():e.enableAutoPlay()},e.enableAutoPlay=function(){e.isAutoPlayEnabled=!0,e.schedule(e.autoPlay,.5)},e.disableAutoPlay=function(){e.isAutoPlayEnabled=!1,e.unschedule(e.autoPlay)},e.autoPlay=function(){if(e.stateManager.isReady()||e.stateManager.isPlaying()){var t=e.board.getHintPath();if(!t)throw new Error("No path found");var n=t[0],i=t.slice(-1)[0];if(void 0!==n&&void 0!==i){var a=n.a,o=i.b,r=e.board.getTileAt(a.x,a.y),l=e.board.getTileAt(o.x,o.y);if(!r||!l)throw new Error("Tile is null");r.onClick(),l.onClick()}else{var s=new Error("No path found");if(wU.isDebugger())throw s;null==pU||pU.sendException(s)}}},e.handleAddStars=function(t){var n=sU.getGameData();if(!n)return Promise.resolve([]);sU.setGameData({stars:n.stars+1});var i=t.startAnimationAt;i&&e.effectManager.playStarEffectAt(i)},e.handleChallengeFriends=o((function*(){try{var t,n,i;lt.showLoadingScreen();var a=e.board.generateFenFromCurrentLevel(),o=(null!==(t=sU.getGameData())&&void 0!==t?t:{}).level,r=void 0===o?1:o;r=Math.max(1,r);var l=null!==(n=null===(i=e.gameData)||void 0===i?void 0:i.levelData)&&void 0!==n?n:{},s=l.mode,u=void 0===s?"":s,c=l.rules,d=void 0===c?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:c,h=l.time,p=void 0===h?0:h;yield null==cU?void 0:cU.context.choose.processAsync({playerId:sU.getPlayerId(),fallbackSingleMode:!1,extraData:{challengeData:{level:r,fen:a,gravity:u,rules:d,time:p}}}),iv.getMatchMode()===kU.TOURNAMENT&&(yield e.tryInitTournamentMode()),lt.closeLoadingScreen(),e.node.scene.emit(Es.UPDATE_MUSIC),e.node.scene.emit(Es.GAME_RESUME),e.node.scene.emit(Es.GAME_REPLAY,{level:r})}catch(t){var y=t instanceof Error?t:new Error("Unable to invite friends");null==pU||pU.sendException(y),lt.closeLoadingScreen(),lt.showNotificationScreenWithLocalizedKey("error.tryLater"),e.node.scene.emit(Es.GAME_RESUME),e.node.scene.emit(Es.SHOW_UI)}})),e.handleAddItem=function(){var t=o((function*(t){var n=t.animate,i=t.item,a=t.quantity,o=bU.search(e.uiManager.items,(function(e){return e.itemType===i}));if(void 0!==o){var r=e.itemManager.getQuantity(i)+a;if(e.itemManager.saveQuantity(i,r),e.uiManager.setInteractableItems(!1),n){var l=n.startWorldPosition;yield e.effectManager.playItemAddAnimation(l.x,l.y,o)}e.itemManager.setQuantity(i,r,!0),e.uiManager.setInteractableItems(!0)}else console.warn("Item ".concat(i," not found"))}));return function(e){return t.apply(this,arguments)}}(),e}return e(p,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenCoreEvents(),this.listenInputEvents(),this.listenFlowEvents()}},{key:"onLoad",value:function(){Vy.init()}},{key:"onDestroy",value:function(){this.unlistenCoreEvents()}},{key:"initComponents",value:function(){this.initUIManager(),this.initLevelManager(),this.initStateManager(),this.initEffectManager(),this.initItemManager(),this.initCoinManager(),this.initComboManager(),this.initClockManager(),this.initScoreManager(),this.initInputController(),this.initGuidelinesManager(),this.initPathDraw()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(rU),this.uiManager.init(this)}},{key:"initLevelManager",value:function(){this.levelManager=this.getComponent(Wv)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(AD)}},{key:"initInputController",value:function(){this.inputController=this.getComponent(sv)}},{key:"initEffectManager",value:function(){this.effectManager=this.getComponent(sI)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(H_),this.itemManager.init(this)}},{key:"initCoinManager",value:function(){this.coinManager=this.getComponent(PS)}},{key:"initComboManager",value:function(){this.comboManager=this.getComponent(GS),this.comboManager.init()}},{key:"initClockManager",value:function(){this.clockManager=this.getComponent(Rw),this.clockManager.init()}},{key:"initScoreManager",value:function(){this.scoreManager=this.getComponent($_),this.scoreManager.init()}},{key:"initGuidelinesManager",value:function(){SU.Tutorial.Enabled&&(this.guidelinesManager=this.getComponent(N_),this.guidelinesManager.init(this))}},{key:"initPathDraw",value:function(){this.pathDraw.init(this.board)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenCoreEvents",value:function(){uU.on(fU.OPENING_SCREEN,this.handleOpenScreen),uU.on(fU.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"unlistenCoreEvents",value:function(){uU.off(fU.OPENING_SCREEN,this.handleOpenScreen),uU.off(fU.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"listenInputEvents",value:function(){this.node.scene.on(Es.SHOW_UI,this.handleShowUI),this.node.scene.on(Es.HIDE_UI,this.handleHideUI),this.node.scene.on(Es.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(Es.GAME_RESUME,this.handleResumeGame),this.node.scene.on(Es.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(Es.GAME_FINISH,this.handleFinishGame),this.node.scene.on(Es.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(Es.START_OVER,this.handleStartOver),this.node.scene.on(Es.MAX_LEVEL,this.handleMaxLevel),this.node.scene.on(Es.GAME_EXIT,this.handleExitGame),this.node.scene.on(Es.TILE_CLICK,this.handleTileClick),this.node.scene.on(Es.GRID_MATCH_SUCCESS,this.handleGridMatchSuccess),this.node.scene.on(Es.GRID_MATCH_FAIL,this.handleGridMatchFail),this.node.scene.on(Es.GRID_ORIENTATION_CHANGE,this.handleGridOrientationChange),this.node.scene.on(Es.PAUSE_TIME,this.handlePauseTime),this.node.scene.on(Es.RESUME_TIME,this.handleResumeTime),this.node.scene.on(Es.TIME_OUT,this.handleClockTimeout),this.node.scene.on(Es.HALF_TIME,this.handleHalfTime),this.node.scene.on(Es.RESCUE_START,this.handleStartRescue),this.node.scene.on(Es.RESCUE_FINISHED,this.handleFinishRescue),this.node.scene.on(Es.BOMB_EXPLODE,this.handleBombExplode),this.node.scene.on(Es.SHOW_HINT,this.handleShowHint),this.node.scene.on(Es.ADD_SCORE,this.handleAddScore),this.node.scene.on(Es.GRID_CLEAR,this.handleGridClear),this.node.scene.on(Es.USE_ITEM,this.handleUseItem),this.node.scene.on(Es.ADD_ITEM,this.handleAddItem),this.node.scene.on(Es.AUTO_PLAY,this.handleAutoPlay),this.node.scene.on(Es.ADD_STARS,this.handleAddStars)}},{key:"listenFlowEvents",value:function(){this.node.scene.on(Es.CHALLENGE_FRIENDS,this.handleChallengeFriends)}},{key:"start",value:(d=o((function*(){this.initDataFirstTime(),yield this.tryInitTournamentMode(),this.initGame()})),function(){return d.apply(this,arguments)})},{key:"initDataFirstTime",value:function(){this.initData();var e,t,n=this.getSceneData(),i=(null!=n?n:{}).isFromLoader,a=void 0!==i&&i,o=(null!=n?n:{}).level;void 0===o&&(o=iv.getMatchMode()===kU.TOURNAMENT?1:null!==(e=null===(t=sU.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:0);this.setGameData({level:o,isFromLoader:a})}},{key:"initData",value:function(){var e,t=this.getSceneData(),n=(null!=t?t:{}).isFromLoader,i=void 0!==n&&n,a=null!==(e=sU.getGameData())&&void 0!==e?e:{},o=a.level,r=void 0===o?1:o,l=a.items;0===r&&i&&l?(l.hint=2,l.thunder=1,l.storm=1,l.pliers=0,sU.setGameData({items:l,coins:500,lastRewardedItems:Date.now()}),this.node.scene.emit(Es.ADD_COINS,{coins:500,playSound:!1})):l&&this.checkItemsRewardable()&&(l.hint<5&&(l.hint+=1),l.thunder<5&&(l.thunder+=1),l.storm<5&&(l.storm+=1),l.pliers<5&&(l.pliers+=1),sU.setGameData({items:l,lastRewardedItems:Date.now()})),this.setGameData(s(s({},PU),{},{level:r}))}},{key:"checkItemsRewardable",value:function(){var e,t=(null!==(e=sU.getGameData())&&void 0!==e?e:{}).lastRewardedItems,n=void 0===t?0:t;return!mU.isToday(n)}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.initialize()}},{key:"tryInitTournamentMode",value:(c=o((function*(){var e,t;if(iv.getMatchMode()===kU.TOURNAMENT){this.tournamentManager=this.getComponent(qD),yield this.tournamentManager.init();var n=this.tournamentManager,i=n.leaderboardData,a=n.leaderboardName,o=n.tournamentData;if(o){var r=o.payload.themeId;if(this.setGameData({themeId:r}),i&&a){var l=sU.getPlayerId(),s=i.leaders[l];if(!s&&yU){var u=yield yU.getLeadersByPlayerIdsAsync(a,[l]);if(0===u.length)return;s=u[0]}dU.setStorageData("tournament","previousScore",null!==(e=null===(t=s)||void 0===t?void 0:t.score)&&void 0!==e?e:0)}}}})),function(){return c.apply(this,arguments)})},{key:"setGameData",value:function(e){var t,n,i,a=null!==(t=null!==(n=e.level)&&void 0!==n?n:null===(i=this.gameData)||void 0===i?void 0:i.level)&&void 0!==t?t:1;this.gameData=s(s(s({},this.gameData),e),{},{level:a})}},{key:"getGameData",value:function(){return this.gameData}},{key:"getSceneData",value:function(){return ct.getSceneData(this.node.scene)}},{key:"attemptCallCreateShortcut",value:function(){var e,t=null!==(e=this.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?0:n,a=t.nextLevelCount;i<2||(void 0===a?0:a)<2||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)}))}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){GameSDK.isGameSDK("CrazyGames")}}]),p}(T)).prototype,"board",[Wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zz=a(Xz.prototype,"opacityToggler",[Kz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qz=a(Xz.prototype,"pathDraw",[jz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yz=Xz));S._RF.pop(),S._RF.push({},"c863f/bTTdAjqEM+Kj9OaKi","DashboardEventButtonTypes",void 0);var OU=function(e){return e[e.STAR_CHEST=0]="STAR_CHEST",e[e.BALLOON=1]="BALLOON",e[e.DAILY_REWARDS=2]="DAILY_REWARDS",e}(OU||{});M(OU),S._RF.pop(),S._RF.push({},"17fa4eEXEhIfZh+ad9Oqcmw","Leaderboard",void 0);var LU,IU=function(e){return e.WORLD_TAB_SELECTED="world-tab-selected",e.WEEKLY_TAB_SELECTED="weekly-tab-selected",e.OVERLAY_SHOW_STARTED="overlay-show-started",e.OVERLAY_SHOW_COMPLETED="overlay-show-completed",e}(IU||{}),RU="#AE4212",_U="#3D5172",DU="#92200C",MU="#8F5542",NU="#8A4733",BU="#3e7110",FU="#3e7110";S._RF.pop(),S._RF.push({},"4cd93d4ECxKDYSG9apAx603","LevelMission",void 0),S._RF.pop(),S._RF.push({},"2737dY5lxxEY6mKDXeUQJUc","ThemeLocaleKeys",void 0);var xU,zU=(m(LU={},pt.SUMMER,"theme.summer"),m(LU,pt.AUTUMN,"theme.autumn"),m(LU,pt.WINTER,"theme.winter"),m(LU,pt.SPRING_FESTIVAL,"theme.springFestival"),m(LU,pt.TREE_PLANTING_FESTIVAL,"theme.treePlantingFestival"),m(LU,pt.BLUE_SEA_FESTIVAL,"theme.blueSeaFestival"),m(LU,pt.MUSIC_FESTIVAL,"theme.musicFestival"),m(LU,pt.HARVEST_FESTIVAL,"theme.harvestFestival"),m(LU,pt.FOOD_FESTIVAL,"theme.foodFestival"),m(LU,pt.SNOW_FESTIVAL,"theme.snowFestival"),m(LU,pt.LIGHT_FESTIVAL,"theme.lightFestival"),m(LU,pt.PEACE_FESTIVAL,"theme.peaceFestival"),m(LU,pt.FLOWER_FESTIVAL,"theme.flowerFestival"),m(LU,pt.STREET_FESTIVAL,"theme.streetFestival"),m(LU,pt.COLOR_GARDEN,"theme.colorGarden"),m(LU,pt.COLOR_FESTIVAL,"theme.colorFestival"),m(LU,pt.NATURE_SUMMER,"theme.natureSummer"),m(LU,pt.SNOW_MOUNTAIN,"theme.snowMountain"),m(LU,pt.ICE_FESTIVAL,"theme.iceFestival"),m(LU,pt.GREEN_GRASS_FESTIVAL,"theme.greenGrassFestival"),m(LU,pt.COMMUNITY_FESTIVAL,"theme.communityFestival"),m(LU,pt.WATER_FESTIVAL,"theme.waterFestival"),m(LU,pt.ANIMAL_FESTIVAL,"theme.animalFestival"),m(LU,pt.LOST_FESTIVAL,"theme.lostFestival"),m(LU,pt.HALLOWEEN_FESTIVAL,"theme.halloweenFestival"),m(LU,pt.SNOW_MUSIC_FESTIVAL,"theme.snowMusicFestival"),m(LU,pt.CHRISTMAS,"theme.christmas"),m(LU,pt.SPRING_FLOWER_FESTIVAL,"theme.springFlowerFestival"),m(LU,pt.TET_HOLIDAY,"theme.tetHoliday"),m(LU,pt.SEA_FESTIVAL,"theme.seaFestival"),m(LU,pt.FIREWORK_FESTIVAL,"theme.fireworkFestival"),m(LU,pt.HALLOWEEN_HORROR,"theme.halloweenHorror"),m(LU,pt.MID_AUTUMN,"theme.midAutumn"),m(LU,pt.CHRISTMAS_SWEET,"theme.christmasSweet"),m(LU,pt.NEW_YEAR_COUNTDOWN,"theme.newYearCountdown"),m(LU,pt.HAPPY_NEW_YEAR,"theme.happyNewYear"),LU);S._RF.pop(),S._RF.push({},"78297LLtrJKMpOIidCw/BA9","index",void 0),S._RF.pop(),S._RF.push({},"176c3V0yoFEhIdpVcCIhDz7","isEmptyBoard",void 0),S._RF.pop(),S._RF.push({},"5262atLmldNy7Q3MtHgiSRI","HintItem",void 0);var UU;(0,C.ccclass)("HintItem")(xU=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return nt.HINT}}]),r}(xM));S._RF.pop(),S._RF.push({},"3f4c1AB+jdNFqylpogoaiDZ","PliersItem",void 0);var GU;(0,C.ccclass)("PliersItem")(UU=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return nt.PLIERS}}]),r}(xM));S._RF.pop(),S._RF.push({},"d6e51+oy6NCF7cKvf6KOWiu","StormItem",void 0);var HU;(0,C.ccclass)("StormItem")(GU=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return nt.STORM}}]),r}(xM));S._RF.pop(),S._RF.push({},"b30ffJjU2lAH5yu2NkzVVnO","ThunderItem",void 0);var qU,VU,$U,WU,KU,jU,YU;(0,C.ccclass)("ThunderItem")(HU=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return nt.THUNDER}}]),r}(xM));S._RF.pop(),S._RF.push({},"28c5eNXZLBE+50Dno043fmy","useTornadoThunderCombined",void 0),S._RF.pop(),S._RF.push({},"eb6c23usqxHPaoJcvF0LbY6","separatePositions",void 0),S._RF.pop(),S._RF.push({},"d2a57+mB4NG9rcdh+dy1VPe","traverse4",void 0),S._RF.pop(),S._RF.push({},"ca614iJ+X5LrL1rX/wDQDTD","shuffle",void 0),S._RF.pop(),S._RF.push({},"1cf4cygDSdP5JL+7w3wIJL7","traverseRandom",void 0),S._RF.pop(),S._RF.push({},"1faa9NgJrBE7p8Zs/HBWrZn","pad",void 0),S._RF.pop(),S._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var XU,JU=C.ccclass,ZU=C.property;qU=JU("RendererModule"),VU=ZU(ze),$U=ZU(ue),qU((jU=a((KU=e((function e(){t(this,e),r(this,"material",jU,this),r(this,"spriteFrame",YU,this)}))).prototype,"material",[VU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YU=a(KU.prototype,"spriteFrame",[$U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WU=KU));S._RF.pop(),S._RF.push({},"c20acgKcuRFP6+Am/XjOFeP","ParticleSystem2DExtra",void 0);var QU,eG=C.ccclass,tG=C.disallowMultiple,nG=C.executeInEditMode,iG=C.requireComponent,aG=eG("ParticleSystem2DExtra")(XU=nG(!0)(XU=tG(!0)(XU=iG(ee)(XU=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var o=i[a];e.updateParticle(o,n)}t(n)}},e}return e(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(ee),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),r}(T))||XU)||XU)||XU)||XU;S._RF.pop(),S._RF.push({},"664feJL84ZOTaM99dgWY4x0","ExampleParticleSystem2DExtra",void 0);var oG;(0,C.ccclass)("ExampleParticleSystem2DExtra")(QU=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"initParticle",value:function(e){e.maxSize=te.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=te.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+te.randomRange(-350,350),e.y=n+te.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(aG));S._RF.pop(),S._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var rG,lG,sG,uG,cG,dG,hG,pG,yG,vG,fG,gG=C.ccclass,mG=C.disallowMultiple,bG=Ludex,wG=bG.Events,SG=bG.Utils.Valid,kG=bG.Configs.Core.StartSDKAfterLoadGame,CG=bG.Plugins.Ads,EG=(void 0===CG?{}:CG).Types,AG=codex,TG=AG.ads,PG=AG.player,OG=AG.event,LG=AG.context;gG("BootScene")(oG=mG(oG=function(a){n(p,a);var r,l,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=h.call.apply(h,[this].concat(i))).setupLoadingFullScreen=function(){kG?(lt.addShowedScene(yt.BOOT_SCENE),PG.isFirstSession()?lt.addShowedScene(yt.GAME_SCENE):lt.addShowedScene(yt.DASHBOARD_SCENE)):lt.showLoadingFullScreen(yt.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.setupGameData(),e.sendMsGamesDailyNotification()},e.loadBundles=o((function*(){return Promise.all([qe.loadBundle("loadable")])})),e.loadWasmModules=o((function*(){if("SOLO"!==LG.getContextType()||PG.isFirstSession())return Promise.all([vt.loadModuleAsync("spine")])})),e.lazyLoadWasmModules=o((function*(){yield Promise.all([vt.loadModuleAsync("spine")])})),e.handlePauseAudio=function(){OG.on(wG.VISIBILITY_HIDDEN,e.handleMuteAudio),OG.on(wG.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){je.muteAudio(!0)},e.handleUnMuteAudio=function(){null!=TG&&TG.isAdFullSizeShowing()||je.muteAudio(!1)},e}return e(p,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.preloadAssets(),this.listenEvents()}},{key:"preloadAssets",value:(d=o((function*(){try{D.pause(),yield Promise.all([this.loadWasmModules(),this.loadBundles(),this.loadCurrentPlayerTheme(),this.loadGuideSkin()])}catch(e){console.warn("processPreloadAssets",e)}finally{null!=TG&&TG.isAdFullSizeShowing()||D.resume()}})),function(){return d.apply(this,arguments)})},{key:"onLoad",value:function(){this.handlePauseAudio(),this.overrideGameSDK(),this.setupLoadingFullScreen()}},{key:"start",value:(c=o((function*(){yield GameSDK.extra.waitSDKInitiatedAsync(),this.processCrazyGamesLoadingStop(),this.disableBannerAdsOnStartingLevels()})),function(){return c.apply(this,arguments)})},{key:"listenEvents",value:function(){OG.catchUp(wG.GAME_READY,this.lazyLoadWasmModules),OG.catchUp(wG.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"overrideGameSDK",value:function(){if("FBInstant"in window&&"shareAsync"in FBInstant){var e=FBInstant.shareAsync;FBInstant.shareAsync=function(){var t=o((function*(t){var n=s({},t);return e(n)}));return function(e){return t.apply(this,arguments)}}()}}},{key:"setupGameData",value:function(){var e=PG.getGameData();if(e){var t=e.totalLevel,n=Math.max(t,at),i=s(s({},e),{},{totalLevel:n});PG.setGameData(i)}}},{key:"disableBannerAdsOnStartingLevels",value:function(){if(EG){var e=PG.getGameData();if(e){var t=e.level,n=void 0!==t&&t>dt.NUM_LEVEL_WITHOUT_BANNER_ADS;Xe.setAdEnable(EG.BANNER,n)}}}},{key:"loadCurrentPlayerTheme",value:(l=o((function*(){var e=xy.mapOrder,t=e[0];if(SG.isObject(t)){var n=PG.getGameData(),i=null==n?void 0:n.level;if(!SG.isNumber(i))return qe.loadThemeAsync(t.theme);var a,o=u(e);try{for(o.s();!(a=o.n()).done;){var r=a.value;if((i-=r.levelCount)<=0){t=r;break}}}catch(e){o.e(e)}finally{o.f()}return qe.loadThemeAsync(t.theme)}})),function(){return l.apply(this,arguments)})},{key:"loadGuideSkin",value:(r=o((function*(){if(PG.isFirstSession())return Vy.loadLevelSpriteFrames(0)})),function(){return r.apply(this,arguments)})},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}}]),p}(T))||oG);S._RF.pop(),S._RF.push({},"29f874DL75LO5NzzNYZvHDh","RigidBodyObject",void 0);var IG,RG,_G,DG,MG,NG,BG,FG,xG,zG,UG,GG,HG=C.ccclass,qG=C.property;rG=HG("RigidBodyObject"),lG=qG(L),sG=qG(ae),uG=qG(L),cG=qG(W),rG((pG=a((hG=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"gravityScale",pG,l(e)),r(e,"linearVelocity",yG,l(e)),r(e,"bounce",vG,l(e)),r(e,"simulate",fG,l(e)),e}return e(s,[{key:"onLoad",value:function(){this.canvas=this.node.scene.getComponentInChildren(Ue).getComponent(P),this.uiTransform=this.node.getComponent(P)}},{key:"update",value:function(e){if(this.simulate){this.applyGravity();var t=this.node.worldPosition.clone();t.add(new V(this.linearVelocity.x*e,this.linearVelocity.y*e,0)),t=this.applyBounce(t),this.node.setWorldPosition(t)}}},{key:"applyForce",value:function(e){this.linearVelocity.add(e)}},{key:"applyGravity",value:function(){var e=new ae(0,-9.8*this.gravityScale);this.applyForce(e)}},{key:"applyBounce",value:function(e){var t=this.uiTransform.getBoundingBoxToWorld();t.yMin<0&&(e.y=t.height/2,this.linearVelocity.y*=-this.bounce),t.xMin<0&&(e.x=t.width/2,this.linearVelocity.x*=-1);var n=this.canvas.width;return t.xMax>n&&(e.x=n-t.width/2,this.linearVelocity.x*=-1),e}}]),s}(T)).prototype,"gravityScale",[lG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),yG=a(hG.prototype,"linearVelocity",[sG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ae(0,0)}}),vG=a(hG.prototype,"bounce",[uG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fG=a(hG.prototype,"simulate",[cG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dG=hG));S._RF.pop(),S._RF.push({},"93d88BQCU5B0L/TmaCaYNfm","AnimSkipOverlay",void 0);var VG,$G,WG,KG,jG,YG,XG,JG,ZG,QG=C.ccclass,eH=C.property,tH=C.disallowMultiple,nH=function(){},iH=(IG=QG("AnimSkipOverlay"),RG=eH(B),_G=eH(B),DG=eH(G),MG=Yn.onlyRunInLifeCycleAsync,NG=Yn.onlyRunInLifeCycleAsync,BG=Yn.onlyRunInLifeCycleAsync,IG(FG=tH((zG=a((xG=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"containerUIOpacity",zG,l(e)),r(e,"maskUIOpacity",UG,l(e)),r(e,"skipButton",GG,l(e)),e.isOpened=!1,e.currentCallback=nH,e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.containerUIOpacity.node.active=!1,this.skipButton.interactable=!1}},{key:"onSkipButtonPress",value:function(){this.currentCallback(),this.close()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"open",value:(u=o((function*(e){this.containerUIOpacity.node.active=!0;var t=e.onSkip,n=e.opacity,i=void 0===n?255:n,a=e.transitionDuration,o=void 0===a?.2:a;this.maskUIOpacity.opacity=i,yield this.animateUIOpacity(0,255,o),this.currentCallback=t,this.skipButton.interactable=!0,this.isOpened=!0,this.node.scene.emit($e.OPENED_SKIP_OVERLAY,e)})),function(e){return u.apply(this,arguments)})},{key:"close",value:(s=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.skipButton.interactable=!1,this.currentCallback=nH,yield this.animateUIOpacity(255,0,e),this.maskUIOpacity.opacity=0,this.containerUIOpacity.node.active=!1,this.isOpened=!1,this.node.scene.emit($e.CLOSED_SKIP_OVERLAY)})),function(){return s.apply(this,arguments)})},{key:"animateUIOpacity",value:function(e,t,n){return this.containerUIOpacity.opacity=e,Ve.runTweenAsync(R(this.containerUIOpacity).to(n,{opacity:t}))}},{key:"untilClosed",value:function(){var e=this;return!1===this.isOpened?Promise.resolve():new Promise((function(t){e.node.scene.once($e.CLOSED_SKIP_OVERLAY,t)}))}}]),d}(T)).prototype,"containerUIOpacity",[RG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UG=a(xG.prototype,"maskUIOpacity",[_G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GG=a(xG.prototype,"skipButton",[DG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(xG.prototype,"open",[MG],Object.getOwnPropertyDescriptor(xG.prototype,"open"),xG.prototype),a(xG.prototype,"close",[NG],Object.getOwnPropertyDescriptor(xG.prototype,"close"),xG.prototype),a(xG.prototype,"untilClosed",[BG],Object.getOwnPropertyDescriptor(xG.prototype,"untilClosed"),xG.prototype),FG=xG))||FG)||FG);S._RF.pop(),S._RF.push({},"95ba56f1qVFfLLdPv++OfLw","SmoothScrollView",void 0);var aH,oH=C.ccclass,rH=C.property,lH=(VG=oH("SmoothScrollView"),$G=rH({type:W,group:"Mouse Scroll"}),WG=rH({type:L,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),KG=rH({type:L,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),VG((XG=a((YG=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"mouseScroll",XG,l(e)),r(e,"mouseScrollSpeed",JG,l(e)),r(e,"mouseScrollDuration",ZG,l(e)),e}return e(s,[{key:"_onMouseWheel",value:function(e,t){if(this.mouseScroll){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(e,t)){var n=new V,i=e.getScrollY()<0?1:-1;this.vertical?n.set(0,i*this.mouseScrollSpeed,0):this.horizontal&&n.set(i*this.mouseScrollSpeed,0,0),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._startAutoScroll(n,this.mouseScrollDuration,!0),this._stopPropagationIfTargetIsMe(e)}}else c(d(s.prototype),"_onMouseWheel",this).call(this,e,t)}}]),s}(Ge)).prototype,"mouseScroll",[$G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JG=a(YG.prototype,"mouseScrollSpeed",[WG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),ZG=a(YG.prototype,"mouseScrollDuration",[KG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),jG=YG))||jG);S._RF.pop(),S._RF.push({},"904917NfYBJy781QxKjEPIO","ViewNode",void 0);var sH,uH,cH,dH,hH,pH,yH,vH,fH,gH,mH,bH,wH,SH,kH,CH,EH,AH,TH,PH,OH,LH,IH,RH,_H,DH,MH,NH,BH,FH=C.ccclass,xH=C.requireComponent,zH=FH("ViewNode")(aH=xH(B)(aH=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).order=0,e}return e(r,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"setVisible",value:function(e){this.uiOpacity.opacity=e?255:0}},{key:"isVisible",value:function(){return this.uiOpacity.opacity>0}}]),r}(T))||aH)||aH;S._RF.pop(),S._RF.push({},"0b250nSw/RHRq8vKigzgfhs","ScrollViewLayout",void 0);var UH,GH=C.ccclass,HH=C.property,qH=C.requireComponent,VH=Ludex.Utils,$H=VH.Array,WH=VH.Signal,KH=(sH=GH("ScrollViewLayout"),uH=qH(lH),cH=Yn.required(),dH=HH(P),hH=HH(L),pH=HH(fe),yH=HH(O),vH=Yn.required(),fH=HH(O),gH=Yn.required(),mH=Yn.required(),bH=Yn.required(),wH=Yn.onlyRunInLifeCycleAsync,SH=Yn.onlyRunInLifeCycleAsync,kH=Yn.onlyRunInLifeCycleAsync,CH=Yn.onlyRunInLifeCycle,EH=Yn.onlyRunInLifeCycle,AH=Yn.onlyRunInLifeCycle,TH=Yn.onlyRunInLifeCycle,sH(PH=uH((LH=a((OH=function(a){n(y,a);var s,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"viewport",LH,l(e)),r(e,"spacing",IH,l(e)),r(e,"nodePrefab",RH,l(e)),r(e,"maxNodeCount",_H,l(e)),r(e,"extendCount",DH,l(e)),r(e,"scrollView",MH,l(e)),r(e,"uiTransform",NH,l(e)),r(e,"contentUiTransform",BH,l(e)),e.nodePool=[],e.nodeHeight=0,e.scrollSignalController=new WH.SignalController,e.onNodeVisible=function(){},e.onNodeInvisible=function(){},e}return e(y,[{key:"__preload",value:function(){var e;this.scrollView=this.getComponent(lH),this.uiTransform=this.getComponent(P),this.contentUiTransform=null===(e=this.scrollView.content)||void 0===e?void 0:e.getComponent(P)}},{key:"onDestroy",value:function(){D.off($e.VIEW_RESIZED,this.handleViewResized,this)}},{key:"start",value:function(){var e=ye(this.nodePrefab);this.nodeHeight=e.getComponent(P).height,e.destroy(),Yn.validateRequiredProperties(this,y)}},{key:"init",value:function(e,t){this.createNodePool(),this.onNodeVisible=null!=e?e:this.onNodeVisible,this.onNodeInvisible=null!=t?t:this.onNodeInvisible;for(var n=0;n<this.nodePool.length;n++){var i;null===(i=this.nodePool[n])||void 0===i||i.setVisible(!1)}this.updateVisibility()}},{key:"updateNodeVisibility",value:function(){for(var e=0;e<this.nodePool.length;e++){var t=this.nodePool[e];t&&(t.isVisible()?this.onNodeVisible(t):this.onNodeInvisible(t))}}},{key:"listenEvents",value:function(){this.scrollView.node.on(Ge.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.on(xe.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.on(xe.MOUSE_WHEEL,this.abortScrollSignal,this),D.on($e.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(Ge.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.off(xe.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.off(xe.MOUSE_WHEEL,this.abortScrollSignal,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this)}},{key:"scrollToOrder",value:(h=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=this.getNodeScrollOffset(e),a=this.scrollView.getScrollOffset().y,o=(i=Math.max(i,0))-(a=Math.max(a,0));Math.abs(o)<5||(yield this.scrollToOffset(new ae(0,i),n,t))})),function(e,t){return h.apply(this,arguments)})},{key:"scrollToTop",value:(d=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;yield this.scrollToOffset(new ae(0,0),t,e)})),function(e){return d.apply(this,arguments)})},{key:"scrollToOffset",value:(c=o((function*(e,t,n){var i=this,a=this.scrollSignalController.renew();this.scrollView.scrollToOffset(e,t);var o=function(){return i.handleScrollSignalAborted()},r=function(){a.aborted||i.handleExternalSignalAborted(e)};a.once(o),n.addAbortListener(r),yield Ve.waitTweenAsync(t,n),a.off(o),n.removeAbortListener(r)})),function(e,t,n){return c.apply(this,arguments)})},{key:"updateVisibility",value:function(){for(var e=this.viewport.getBoundingBoxToWorld(),t=e.yMax,n=e.yMin,i=0;i<this.maxNodeCount;i++){var a=this.getNodeBoundingBoxWorld(i),o=a.top,r=a.bot;if(o<n||r>t){var l=this.getNodeByOrder(i);l&&(this.onNodeInvisible(l),l.setVisible(!1))}else{var s=this.getNodeByOrder(i);if(s)s.isVisible()||(s.order=i,this.onNodeVisible(s),s.setVisible(!0));else{var u=this.getInvisibleNode();u&&(u.node.setPosition(this.getNodePosition(i)),u.order=i,this.onNodeVisible(u),u.setVisible(!0))}}}}},{key:"updateLayout",value:function(){var e,t=this.getVisibleNodes(),n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.node.setPosition(this.getNodePosition(i.order))}}catch(e){n.e(e)}finally{n.f()}}},{key:"setMaxNodeCount",value:function(e){this.maxNodeCount=e,this.contentUiTransform.height=(this.nodeHeight+this.spacing)*this.maxNodeCount}},{key:"getAllNodes",value:function(){return this.nodePool}},{key:"getVisibleNodes",value:function(){return this.nodePool.filter((function(e){return e.isVisible()}))}},{key:"getNodePosition",value:function(e){return new V(0,-(this.nodeHeight+this.spacing)*e-this.nodeHeight/2,0)}},{key:"getNodeScrollOffset",value:function(e){return-this.getNodePosition(e).y-this.uiTransform.node.worldPosition.y-this.uiTransform.height/2+this.viewport.node.worldPosition.y}},{key:"getNodeByOrder",value:function(e){return $H.search(this.nodePool,(function(t){return t.order===e}))}},{key:"getInvisibleNode",value:function(){return $H.search(this.nodePool,(function(e){return!e.isVisible()}))}},{key:"createNodePool",value:function(){var e=Math.ceil(this.viewport.height/this.nodeHeight)+1+this.extendCount;if(!(this.nodePool.length>=e)){var t=e-this.nodePool.length;this.setMaxNodeCount(this.maxNodeCount);for(var n=0;n<t;n++){var i,a=ye(this.nodePrefab);null===(i=this.scrollView.content)||void 0===i||i.addChild(a),a.setPosition(this.getNodePosition(this.nodePool.length));var o=a.addComponent(zH);o.order=this.nodePool.length,o.setVisible(!1),this.nodePool.push(o)}}}},{key:"getNodeBoundingBoxWorld",value:function(e){var t,n,i=this.getNodePosition(e).y+(null!==(t=null===(n=this.scrollView.content)||void 0===n?void 0:n.worldPosition.y)&&void 0!==t?t:0);return{top:i+this.nodeHeight/2,bot:i-this.nodeHeight/2}}},{key:"abortScrollSignal",value:function(){this.scrollSignalController.abort()}},{key:"handleScrollSignalAborted",value:function(){this.scrollView.stopAutoScroll(),this.updateVisibility()}},{key:"handleExternalSignalAborted",value:function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToOffset(e,0),this.updateVisibility()}},{key:"handleViewResized",value:(s=o((function*(){yield Ve.waitTweenAsync(0),this.createNodePool(),this.updateVisibility()})),function(){return s.apply(this,arguments)})}]),y}(T)).prototype,"viewport",[cH,dH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IH=a(OH.prototype,"spacing",[hH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),RH=a(OH.prototype,"nodePrefab",[pH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_H=a(OH.prototype,"maxNodeCount",[yH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),DH=a(OH.prototype,"extendCount",[vH,fH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),MH=a(OH.prototype,"scrollView",[gH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NH=a(OH.prototype,"uiTransform",[mH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BH=a(OH.prototype,"contentUiTransform",[bH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(OH.prototype,"scrollToOrder",[wH],Object.getOwnPropertyDescriptor(OH.prototype,"scrollToOrder"),OH.prototype),a(OH.prototype,"scrollToTop",[SH],Object.getOwnPropertyDescriptor(OH.prototype,"scrollToTop"),OH.prototype),a(OH.prototype,"scrollToOffset",[kH],Object.getOwnPropertyDescriptor(OH.prototype,"scrollToOffset"),OH.prototype),a(OH.prototype,"updateVisibility",[CH],Object.getOwnPropertyDescriptor(OH.prototype,"updateVisibility"),OH.prototype),a(OH.prototype,"createNodePool",[EH],Object.getOwnPropertyDescriptor(OH.prototype,"createNodePool"),OH.prototype),a(OH.prototype,"handleScrollSignalAborted",[AH],Object.getOwnPropertyDescriptor(OH.prototype,"handleScrollSignalAborted"),OH.prototype),a(OH.prototype,"handleExternalSignalAborted",[TH],Object.getOwnPropertyDescriptor(OH.prototype,"handleExternalSignalAborted"),OH.prototype),PH=OH))||PH)||PH);S._RF.pop(),S._RF.push({},"a3bd3opU7JJh4TqZ3uorJHi","DailyRewardsUtils",void 0);var jH=codex,YH=jH.player,XH=jH.storage,JH=jH.dailyRewards,ZH=Ludex,QH=ZH.Utils.Array,eq=ZH.Configs.DailyRewards,tq=eq.MockTime,nq=eq.MaxDays,iq=eq.CheckInterrupt,aq=tq>0?tq:864e5,oq=function(){function n(){t(this,n)}var i,a,r,l;return e(n,null,[{key:"logLoginReward",value:function(){JH.logLoginReward(),this.setDirty$(),this.tryUpdateData()}},{key:"tryUpdateData",value:(l=o((function*(){if(this.shouldUpdateData$()){this.lastUpdate=Date.now(),yield JH.requestDailyRewardsAsync();var e=this.getCurrentRemainingTime$();this.updateInterval=e/2}})),function(){return l.apply(this,arguments)})},{key:"hasClaimableRewards",value:(r=o((function*(){yield this.tryUpdateData();var e=JH.getDailyRewards();return null!==e&&void 0!==QH.search(Object.values(e),(function(e){return"ready"===e.status}))})),function(){return r.apply(this,arguments)})},{key:"getRewardsData",value:(a=o((function*(){yield this.tryUpdateData();var e=JH.getDailyRewards();if(null===e)return null;for(var t=[],n=0;n<nq;n++){var i=Ey[n];if(i){var a=e[n+1];t.push(s(s({id:i.id,type:i.type,status:i.status},a),{},{value:i.value,items:i.items?s({},i.items):void 0}))}}return t})),function(){return a.apply(this,arguments)})},{key:"getRemainingTime",value:(i=o((function*(){return yield this.tryUpdateData(),this.getCurrentRemainingTime$()})),function(){return i.apply(this,arguments)})}]),n}();UH=oq,oq.lastUpdate=0,oq.updateInterval=0,oq.setDirty$=function(){UH.lastUpdate=0},oq.getCurrentRemainingTime$=function(){var e;if(null===JH.getDailyRewards())return 0;var t=null!==(e=YH.getPlayerData().dailyRewardedData)&&void 0!==e?e:{},n=t.firstReward,i=void 0===n?0:n,a=t.lastReward,o=void 0===a?0:a;if(iq){var r=UH.findLastRewardedIndex$();if(-1===r)return 0;var l=i+(r+1)*aq;return Math.max(l-Date.now(),0)}var s=o+aq;return Math.max(s-Date.now(),0)},oq.findLastRewardedIndex$=function(){for(var e,t=(null!==(e=YH.getPlayerData().dailyRewardedData)&&void 0!==e?e:{}).logDays,n=void 0===t?[]:t,i=n.length-1;i>=0;i--)if(n[i])return i;return-1},oq.shouldUpdateData$=function(){return Date.now()-UH.lastUpdate>UH.updateInterval};var rq,lq,sq,uq,cq,dq,hq,pq,yq,vq,fq,gq,mq,bq,wq,Sq,kq,Cq=function(a){n(u,a);var r,l,s=i(u);function u(){return t(this,u),s.apply(this,arguments)}return e(u,null,[{key:"hasShownPopup",value:function(){return XH.getStorage("dashboardDailyRewards").hasShownPopup}},{key:"setHasShownPopup",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];XH.setStorageData("dashboardDailyRewards","hasShownPopup",e)}},{key:"openPopupScreen",value:(l=o((function*(){yield lt.openScreen(st.DAILY_REWARDS_SCREEN)})),function(){return l.apply(this,arguments)})},{key:"openPopupScreenAndWaitForClose",value:(r=o((function*(){yield lt.openScreenAndWaitForClose(st.DAILY_REWARDS_SCREEN)})),function(){return r.apply(this,arguments)})}]),u}(oq);S._RF.pop(),S._RF.push({},"e62f9TdkTxOyJy6vcnplnCB","LockAnimator",void 0);var Eq,Aq,Tq,Pq,Oq,Lq,Iq,Rq,_q,Dq,Mq,Nq=C.ccclass,Bq=C.disallowMultiple,Fq=C.property,xq=[50,160],zq=(rq=Nq("LockAnimator"),lq=Fq(ee),sq=Fq(ce),uq=Fq(de),cq=Fq(de),dq=Fq(de),hq=Fq(Lp),pq=Fq({type:O,min:0}),rq(yq=Bq((fq=a((vq=function(a){n(y,a);var s,u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"floatingParticles",fq,l(e)),r(e,"iconAnimation",gq,l(e)),r(e,"lockClip",mq,l(e)),r(e,"unlockClip",bq,l(e)),r(e,"tryToUnlockClip",wq,l(e)),r(e,"trailTemplate",Sq,l(e)),r(e,"trailCount",kq,l(e)),e.trails=[],e}return e(y,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.prepareTrails(),this.floatingParticles.node.active=!1}},{key:"unlock",value:(h=o((function*(e){var t=this;this.floatingParticles.node.active=!0,this.floatingParticles.resetSystem(),this.scheduleOnce((function(){t.explodeTrails(e)}),1.1),yield this.playAnimation(this.unlockClip.name,e),this.floatingParticles.stopSystem()})),function(e){return h.apply(this,arguments)})},{key:"lock",value:function(){this.playAnimation(this.lockClip.name),this.floatingParticles.node.active&&this.floatingParticles.stopSystem()}},{key:"explodeTrails",value:(d=o((function*(e){var t=this;yield Promise.all(this.trails.map((function(n){return t.getExplodeTrail(n,0,e)})))})),function(e){return d.apply(this,arguments)})},{key:"getExplodeTrail",value:(c=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=he(0,2*Math.PI),a=he(xq[0],xq[1])*Math.cos(i),o=he(xq[0],xq[1])*Math.sin(i),r=new V(a,o,e.node.position.z),l=e.node.scale.clone(),s=R(e.node).delay(t).call((function(){e.node.setPosition(0,0),e.reset(),e.node.active=!0})).to(.5,{position:r.clone()},{easing:"expoOut"}).to(.5,{scale:new V(0,0,1)},{easing:"expoIn"});yield Ve.runTweenAsync(s,n),e.node.setPosition(0,0),e.node.scale=l,e.reset(),e.node.active=!1})),function(e){return c.apply(this,arguments)})},{key:"prepareTrails",value:function(){this.trailTemplate.node.active=!1;for(var e=0;e<this.trailCount;e++){var t=ye(this.trailTemplate.node);t.setParent(this.node),t.active=!1,this.trails.push(t.getComponent(Lp))}}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"playAnimation",value:(u=o((function*(e,t){var n=this;return null!=t&&t.aborted?Promise.resolve():new Promise((function(i){n.iconAnimation.once(ce.EventType.FINISHED,(function(){i()})),null==t||t.addAbortListener((function(){n.iconAnimation.off(ce.EventType.FINISHED),n.iconAnimation.stop(),i()})),n.iconAnimation.play(e)}))})),function(e,t){return u.apply(this,arguments)})},{key:"playTryToUnlockAnimation",value:(s=o((function*(){return this.playAnimation(this.tryToUnlockClip.name)})),function(){return s.apply(this,arguments)})}]),y}(T)).prototype,"floatingParticles",[lq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gq=a(vq.prototype,"iconAnimation",[sq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mq=a(vq.prototype,"lockClip",[uq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bq=a(vq.prototype,"unlockClip",[cq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wq=a(vq.prototype,"tryToUnlockClip",[dq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sq=a(vq.prototype,"trailTemplate",[hq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kq=a(vq.prototype,"trailCount",[pq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),yq=vq))||yq)||yq);S._RF.pop(),S._RF.push({},"18bbbp5z2VHVKp4jjjmsAhu","ThemeProgressBar",void 0);var Uq,Gq,Hq,qq,Vq,$q,Wq,Kq,jq,Yq,Xq,Jq,Zq,Qq,eV,tV,nV,iV,aV,oV,rV,lV,sV,uV,cV,dV,hV,pV,yV,vV,fV,gV,mV,bV,wV,SV,kV,CV,EV=C.ccclass,AV=C.property,TV=(Eq=EV("ThemeProgressBar"),Aq=AV(q),Tq=AV(q),Pq=AV(q),Oq=AV(q),Eq((Rq=a((Iq=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"progressBar",Rq,l(e)),r(e,"progressText",_q,l(e)),r(e,"leftCap",Dq,l(e)),r(e,"rightCap",Mq,l(e)),e}return e(s,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("ThemeProgressBar: progressBar not found");if(!this.progressText)throw new Error("ThemeProgressBar: progressText not found");if(!this.leftCap)throw new Error("ThemeProgressBar: leftCap not found");if(!this.rightCap)throw new Error("ThemeProgressBar: rightCap not found")}},{key:"setProgress",value:function(e,t){e<=0?(this.leftCap.active=!1,this.rightCap.active=!1):(this.leftCap.active=!0,this.rightCap.active=!0);var n=this.progressBar.getComponent(ie);if(!n)throw new Error("ThemeProgressBar: progressBarComponent not found");n.progress=e/t;var i=this.progressText.getComponent(K);if(!i)throw new Error("ThemeProgressBar: progressTextComponent not found");i.string="".concat(e,"/").concat(t)}}]),s}(T)).prototype,"progressBar",[Aq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_q=a(Iq.prototype,"progressText",[Tq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dq=a(Iq.prototype,"leftCap",[Pq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mq=a(Iq.prototype,"rightCap",[Oq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lq=Iq))||Lq);S._RF.pop(),S._RF.push({},"aef0d6qo8hNUJ7qNl2wuT29","ThemeBlock",void 0);var PV,OV,LV,IV,RV,_V,DV,MV,NV,BV,FV,xV,zV,UV=C.ccclass,GV=C.property,HV={progress:0,max:10,isLocked:!0,theme:pt.SUMMER,skins:[kv.FRUIT]},qV=Ludex.Utils.Array,VV=(Uq=UV("ThemeBlock"),Gq=Yn.required(),Hq=GV(q),qq=Yn.required(),Vq=GV(q),$q=Yn.required(),Wq=GV(zq),Kq=Yn.required(),jq=GV({type:q,group:"Container"}),Yq=Yn.required(),Xq=GV({type:B,group:"Container"}),Jq=Yn.required(),Zq=GV({type:q,group:"Theme"}),Qq=Yn.required(),eV=GV({type:F,group:"Theme"}),tV=Yn.required(),nV=GV({type:th,group:"Title"}),iV=Yn.required(),aV=GV({type:B,group:"Title"}),oV=Yn.required(),rV=GV({type:F,group:"Tile"}),lV=Yn.required(),sV=GV({type:B,group:"Tile"}),uV=GV(W),cV=Yn.onlyRunInLifeCycleAsync,Uq((pV=a((hV=function(a){n(y,a);var u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"mask",pV,l(e)),r(e,"progressBar",yV,l(e)),r(e,"lockAnimator",vV,l(e)),r(e,"container",fV,l(e)),r(e,"containerOpacity",gV,l(e)),r(e,"themeLoadingRing",mV,l(e)),r(e,"themeSprite",bV,l(e)),r(e,"titleLocalizer",wV,l(e)),r(e,"titleOpacity",SV,l(e)),r(e,"tileBlockIconSprite",kV,l(e)),r(e,"newTilesOpacity",CV,l(e)),e.signal=new Ni,e.payload=HV,e}return e(y,[{key:"isLocked",get:function(){return this.payload.isLocked},set:function(e){this.payload.isLocked=e,this.updateInfo()}},{key:"__preload",value:function(){this.maskUIOpacity=this.mask.getComponent(B),Yn.validateRequiredProperties(this,y)}},{key:"updateInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:HV;this.payload=e;var t=e.progress,n=e.max,i=e.isLocked,a=e.theme,o=e.skins;this.signal.abort();var r=new Ni;this.signal=r,this.updateTitle(a),this.updateSkinAsync(o,r),this.updateThemeAsync(a,r);var l=this.progressBar.getComponent(TV);if(!l)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=i,this.progressBar.active=!i,this.lockAnimator.node.active=i,i&&this.lockAnimator.lock(),this.maskUIOpacity.opacity=i?128:0,i||l.setProgress(t,n)}},{key:"playUnlockAnim",value:(h=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HV;this.payload=s(s({},t),{},{isLocked:!1});var n=t.progress,i=t.max,a=this.progressBar.getComponent(TV);if(!a)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=!0,this.progressBar.active=!1,this.lockAnimator.node.active=!0,a.setProgress(n,i),yield this.animateUnlockedState(e)})),function(e){return h.apply(this,arguments)})},{key:"updateTitle",value:function(e){var t=zU[e];this.titleLocalizer.key=t}},{key:"updateSkinAsync",value:(d=o((function*(e,t){var n=this.tileBlockIconSprite.length,i=e.length,a=e.map(function(){var e=o((function*(e){return yield qe.loadSkinPreviewAsync(e)}));return function(t){return e.apply(this,arguments)}}()),r=yield Promise.all(a);if(!t.aborted&&this.tileBlockIconSprite)if(i<=n){for(var l=Math.floor(n/i),s=n%i,u=g(qV.fillWith(i,(function(){return l}))),c=0;c<s;c++){var d=u[c];u[c]=d+1}for(var h=0,p=0;p<i;p++)for(var y=u[p],v=0;v<y&&h<n;v++,h++){var f=r[p][v];this.tileBlockIconSprite[h].spriteFrame=f}}else for(var m=0,b=this.tileBlockIconSprite.length;m<b;m++){var w=this.tileBlockIconSprite[m],S=r[m%i][0];w.spriteFrame=S}})),function(e,t){return d.apply(this,arguments)})},{key:"updateThemeAsync",value:(c=o((function*(e,t){this.themeSprite.spriteFrame=null;var n=qe.getAsset("".concat(ft[e],"/spriteFrame"),ue);if(!n){if(this.themeLoadingRing.active=!0,yield Ve.waitTweenAsync(.1,t),t.aborted)return;n=yield qe.loadThemePreviewAsync(e)}n||(n=yield qe.loadThemePreviewAsync(pt.SUMMER)),this.themeSprite&&n&&!t.aborted&&(this.themeSprite.spriteFrame=n,this.themeLoadingRing.active=!1)})),function(e,t){return c.apply(this,arguments)})},{key:"animateUnlockedState",value:(u=o((function*(e){var t,n=this.progressBar.getComponent(B);if(!n)throw new Error("ThemeBlock: progressBarUIOpacity not found");this.mask.active=!0,this.maskUIOpacity.opacity=null!==(t=this.maskUIOpacity.opacity)&&void 0!==t?t:255,this.progressBar.active=!0,n.opacity=0,yield this.lockAnimator.unlock(e),this.lockAnimator.node.active=!1,yield Promise.all([Ve.runTweenAsync(R(this.maskUIOpacity).to(.25,{opacity:0}),e),Ve.runTweenAsync(R(n).to(.25,{opacity:255}),e)]),this.mask.active=!1,this.maskUIOpacity.opacity=0,n.opacity=255})),function(e){return u.apply(this,arguments)})},{key:"setVisible",value:function(e){this.containerOpacity.opacity=e?255:0,this.titleOpacity.opacity=e?255:0,this.newTilesOpacity.opacity=e?255:0}}]),y}(T)).prototype,"mask",[Gq,Hq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yV=a(hV.prototype,"progressBar",[qq,Vq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vV=a(hV.prototype,"lockAnimator",[$q,Wq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fV=a(hV.prototype,"container",[Kq,jq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gV=a(hV.prototype,"containerOpacity",[Yq,Xq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mV=a(hV.prototype,"themeLoadingRing",[Jq,Zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bV=a(hV.prototype,"themeSprite",[Qq,eV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wV=a(hV.prototype,"titleLocalizer",[tV,nV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SV=a(hV.prototype,"titleOpacity",[iV,aV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kV=a(hV.prototype,"tileBlockIconSprite",[oV,rV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),CV=a(hV.prototype,"newTilesOpacity",[lV,sV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(hV.prototype,"isLocked",[uV],Object.getOwnPropertyDescriptor(hV.prototype,"isLocked"),hV.prototype),a(hV.prototype,"updateSkinAsync",[cV],Object.getOwnPropertyDescriptor(hV.prototype,"updateSkinAsync"),hV.prototype),dV=hV))||dV);S._RF.pop(),S._RF.push({},"b3a4dy5XgpIT6stybzgYjnu","CollectionsContent",void 0);var $V,WV,KV,jV,YV,XV,JV,ZV,QV,e$,t$,n$,i$,a$,o$=C.ccclass,r$=C.property,l$=codex.storage,s$=(PV=o$("CollectionsContent"),OV=r$(Ys),LV=r$(KH),IV=r$(qr),RV=r$({type:L,displayName:"Offset from top of scroll view",tooltip:"The offset between the first theme tab and the top of the scroll view"}),_V=Yn.onlyRunInLifeCycleAsync,DV=Yn.onlyRunInLifeCycleAsync,PV((BV=a((NV=function(a){n(h,a);var u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=d.call.apply(d,[this].concat(i))).animateThemeBlockUnlockIndex=null,r(e,"panelAnimator",BV,l(e)),r(e,"themeScrollView",FV,l(e)),r(e,"contentOpacity",xV,l(e)),e.themeScrollViewInited=!1,e.payloads=[],e.preservedScrollPosition=new ae,r(e,"offsetFromTopOfScrollView",zV,l(e)),e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"listenEvents",value:function(){this.node.scene.on(Es.HIDE_UI,this.hideContent),this.node.scene.on(Es.SHOW_UI,this.showContent),this.themeScrollView.listenEvents()}},{key:"unlistenEvents",value:function(){this.unlistenUIEvents(),this.themeScrollView.unlistenEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Es.HIDE_UI,this.hideContent),this.node.scene.off(Es.SHOW_UI,this.showContent)}},{key:"init",value:function(e){var t=this;this.payloads=e,this.themeScrollViewInited||(this.themeScrollViewInited=!0,this.themeScrollView.init((function(e){var n,i=t.animateThemeBlockUnlockIndex===e.order,a=t.payloads[e.order],o=e.getComponent(VV);a&&(o.updateInfo(s(s({},a),{},{skins:null!==(n=a.skins)&&void 0!==n?n:[],isLocked:!!i||a.isLocked})),o.setVisible(!0),o.container.scale=new V(.4,.4,.4),R(o.container).to(.3,{scale:V.ONE},{easing:"quadOut"}).start())})))}},{key:"preserveScrollPosition",value:function(){this.themeScrollView.scrollView.stopAutoScroll(),this.preservedScrollPosition.set(this.themeScrollView.scrollView.getScrollOffset())}},{key:"restoreScrollPosition",value:function(){this.themeScrollView.scrollView.scrollToOffset(this.preservedScrollPosition,0)}},{key:"updateUnlockedProgress",value:function(e){var t=this,n=l$.getStorageData("collection","animateMapPackUnlock"),i=l$.getStorageData("collection","lastMapPack");e.forEach((function(e,a){var o=e.progress,r=e.max,l=e.isLocked;if(o<r&&!l&&n&&i!==a+1)return t.animateThemeBlockUnlockIndex=a,l$.setStorageData("collection","animateMapPackUnlock",!1),void l$.setStorageData("collection","lastMapPack",a+1)}))}},{key:"shouldAnimateThemeBlockUnlock",value:function(){return null!==this.animateThemeBlockUnlockIndex}},{key:"playThemeTabUnlockAnim",value:(c=o((function*(e){var t;if(this.animateThemeBlockUnlockIndex){var n=this.themeScrollView.getNodeByOrder(this.animateThemeBlockUnlockIndex);if(n&&n.isVisible()){var i=n.getComponent(VV);if(i){var a=Vy.getCollectionUnlockProgress()[this.animateThemeBlockUnlockIndex];a&&(yield i.playUnlockAnim(e,s(s({},a),{},{skins:null!==(t=a.skins)&&void 0!==t?t:[],isLocked:!0})),this.animateThemeBlockUnlockIndex=null)}}}})),function(e){return c.apply(this,arguments)})},{key:"scrollToCurrentUnlockingTheme",value:(u=o((function*(e,t){yield this.themeScrollView.scrollToOrder(e,t)})),function(e,t){return u.apply(this,arguments)})},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),h}(T)).prototype,"panelAnimator",[OV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FV=a(NV.prototype,"themeScrollView",[LV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xV=a(NV.prototype,"contentOpacity",[IV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zV=a(NV.prototype,"offsetFromTopOfScrollView",[RV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 407.5}}),a(NV.prototype,"playThemeTabUnlockAnim",[_V],Object.getOwnPropertyDescriptor(NV.prototype,"playThemeTabUnlockAnim"),NV.prototype),a(NV.prototype,"scrollToCurrentUnlockingTheme",[DV],Object.getOwnPropertyDescriptor(NV.prototype,"scrollToCurrentUnlockingTheme"),NV.prototype),MV=NV))||MV);S._RF.pop(),S._RF.push({},"500274Qu9dAjJwYv27wMaMU","StarProgressBar",void 0);var u$,c$,d$,h$,p$,y$,v$,f$,g$,m$,b$,w$,S$,k$,C$,E$,A$,T$,P$,O$,L$,I$=C.ccclass,R$=C.property,_$=($V=I$("StarProgressBar"),WV=R$(Ic),KV=R$(K),jV=R$(O),YV=R$(O),XV=R$(E),JV=Yn.onlyRunInLifeCycle,$V((e$=a((QV=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"progressBar",e$,l(e)),r(e,"progressLabel",t$,l(e)),r(e,"current",n$,l(e)),r(e,"total",i$,l(e)),r(e,"separator",a$,l(e)),e}return e(c,[{key:"setRange",value:function(e,t){this.total=t,this.current=e,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"updateProgress",value:function(){this.progressBar.progress=Math.min(this.current,this.total)/this.total,this.updateProgressLabel()}},{key:"updateProgressLabel",value:function(){this.progressLabel.string="".concat(this.current).concat(this.separator).concat(this.total)}},{key:"animateTo",value:(s=o((function*(e,t,n){var i=this,a=Math.min(e,this.total)/this.total,o=this.current,r=1,l=R(this.progressBar).to(3,{progress:a},{easing:"quadOut",onUpdate:function(t,a){a&&(i.current=o+Math.floor((e-o)*a),null==n||n(i.current),i.current===o-r&&(r++,R(i.progressLabel.node).to(.05,{scale:new V(1.2,1.2,1.2)}).to(.05,{scale:V.ONE}).start()),i.updateProgressLabel())}}),s=function(){i.current=e,i.updateProgress()};null==t||t.addAbortListener(s),yield Ve.runTweenAsync(l,t),null==t||t.removeAbortListener(s)})),function(e,t,n){return s.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),c}(T)).prototype,"progressBar",[WV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t$=a(QV.prototype,"progressLabel",[KV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n$=a(QV.prototype,"current",[jV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i$=a(QV.prototype,"total",[YV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a$=a(QV.prototype,"separator",[XV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(QV.prototype,"updateProgress",[JV],Object.getOwnPropertyDescriptor(QV.prototype,"updateProgress"),QV.prototype),ZV=QV))||ZV);S._RF.pop(),S._RF.push({},"62d0dndWgNMpLpyrC7yEEUL","DailyRewardsWidget",void 0);var D$,M$,N$,B$,F$,x$,z$=C.ccclass,U$=C.property,G$=Ludex,H$=G$.Utils,q$=H$.Signal,V$=H$.String,$$=G$.Configs.DailyRewards.MockTime,W$=G$.Events,K$=codex.event,j$=$$>0?$$:864e5,Y$=(u$=z$("DailyRewardsWidget"),c$=Yn.required(),d$=U$("cc.animation.AnimationController"),h$=Yn.required(),p$=U$(hT),y$=Yn.required(),v$=U$(K),f$=Yn.required(),g$=U$(Ic),m$=Yn.required(),b$=U$(q),w$=Yn.onlyRunInLifeCycle,S$=Yn.onlyRunInLifeCycle,k$=Yn.onlyRunInLifeCycle,u$((A$=a((E$=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"animationController",A$,l(e)),r(e,"particles",T$,l(e)),r(e,"timeLabel",P$,l(e)),r(e,"progressBar",O$,l(e)),r(e,"progressBarAndLabel",L$,l(e)),e.signalController=new q$.SignalController,e.handleScreenClosed=function(t){t.screenName===ht[st.DAILY_REWARDS_SCREEN]&&e.refresh()},e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,d)}},{key:"onEnable",value:function(){K$.on(W$.CLOSED_SCREEN,this.handleScreenClosed)}},{key:"onDisable",value:function(){K$.off(W$.CLOSED_SCREEN,this.handleScreenClosed),this.signalController.abort()}},{key:"onDestroy",value:function(){this.signalController.abort()}},{key:"setParticles",value:function(e){e?(this.particles.node.active=!0,this.particles.play()):(this.particles.stop(),this.particles.node.active=!1)}},{key:"setProgressBarAndLabelVisibility",value:function(e,t){Ve.runTweenAsync(R(this.progressBarAndLabel).to(e?.5:.2,{scale:e?V.ONE:V.ZERO},{easing:e?"backOut":"sineIn"}),t)}},{key:"startUpdateRemainingTimeSchedule",value:function(e){var t=this,n=new q$.SignalController,i=function(){var a=o((function*(){var a=n.renew();a.chain(e);var o=yield Cq.getRemainingTime();a.aborted||(t.updateRemainingTime(o),0===o&&t.unschedule(i))}));return function(){return a.apply(this,arguments)}}();i(),this.schedule(i,1),e.once((function(){return t.unschedule(i)}))}},{key:"startSelfRefreshSchedule",value:(u=o((function*(e){var t=this,n=yield Cq.getRemainingTime();if(!e.aborted&&0!==n){var i=function n(){e.aborted||t.refresh(),t.unschedule(n)};this.schedule(i,n/1e3),e.once((function(){return t.unschedule(i)}))}})),function(e){return u.apply(this,arguments)})},{key:"updateRemainingTime",value:function(e){if(0===e)this.updateTimeLabel("00:00:00");else{var t=V$.padStart(Math.floor(e/36e5).toString(),2,"0"),n=V$.padStart(Math.floor(e%36e5/6e4).toString(),2,"0"),i=V$.padStart(Math.floor(e%6e4/1e3).toString(),2,"0"),a="".concat(t,":").concat(n,":").concat(i);this.updateTimeLabel(a)}var o=1-e/j$;this.updateProgressBar(o)}},{key:"updateTimeLabel",value:function(e){this.timeLabel.string=e}},{key:"updateProgressBar",value:function(e){this.progressBar.progress=e}},{key:"refresh",value:(s=o((function*(){var e=this.signalController.renew(),t=yield Cq.hasClaimableRewards();e.aborted||(this.animationController.setValue("claimable",t),this.setParticles(t),this.setProgressBarAndLabelVisibility(!t,e),this.startUpdateRemainingTimeSchedule(e),this.startSelfRefreshSchedule(e))})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"animationController",[c$,d$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T$=a(E$.prototype,"particles",[h$,p$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P$=a(E$.prototype,"timeLabel",[y$,v$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O$=a(E$.prototype,"progressBar",[f$,g$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L$=a(E$.prototype,"progressBarAndLabel",[m$,b$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(E$.prototype,"updateRemainingTime",[w$],Object.getOwnPropertyDescriptor(E$.prototype,"updateRemainingTime"),E$.prototype),a(E$.prototype,"updateTimeLabel",[S$],Object.getOwnPropertyDescriptor(E$.prototype,"updateTimeLabel"),E$.prototype),a(E$.prototype,"updateProgressBar",[k$],Object.getOwnPropertyDescriptor(E$.prototype,"updateProgressBar"),E$.prototype),C$=E$))||C$);S._RF.pop(),S._RF.push({},"83036ocqiZHXrI3Aq0dBJRD","EventButton",void 0);var X$,J$,Z$,Q$,eW,tW,nW,iW,aW,oW,rW,lW,sW,uW,cW,dW=C.ccclass,hW=C.property,pW=(D$=dW("EventButton"),M$=hW({type:x(OU)}),N$=hW(W),D$((x$=a((F$=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"eventType",x$,l(e)),e._isAvailable=!1,e}return e(s,[{key:"isAvailable",get:function(){return this._isAvailable},set:function(e){this._isAvailable=e,this.fakeClick()}},{key:"handleClick",value:function(){this.node.scene.emit(Pn,{type:this.eventType})}},{key:"setAnimationState",value:function(e){this.animationController.setValue("RESET-SPECIAL",this._isAvailable),c(d(s.prototype),"setAnimationState",this).call(this,e)}}]),s}(Cr)).prototype,"eventType",[M$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return OU.STAR_CHEST}}),a(F$.prototype,"isAvailable",[N$],Object.getOwnPropertyDescriptor(F$.prototype,"isAvailable"),F$.prototype),B$=F$))||B$);S._RF.pop(),S._RF.push({},"87a11fQFYVFcphsqf5ivVof","DashboardHeader",void 0);var yW,vW,fW,gW,mW,bW,wW,SW,kW,CW,EW,AW,TW,PW,OW,LW,IW,RW,_W=C.ccclass,DW=C.property,MW=codex.player,NW=(X$=_W("DashboardHeader"),J$=DW({type:_$,displayName:"Progress bar",group:"Star Chest"}),Z$=DW({type:pW,displayName:"Button Component",group:"Star Chest"}),Q$=DW(Y$),eW=DW(P),tW=DW(I),nW=DW(P),X$((oW=a((aW=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"starProgressBar",oW,l(e)),r(e,"chestButton",rW,l(e)),r(e,"dailyRewardsWidget",lW,l(e)),r(e,"uiTransform",sW,l(e)),r(e,"containerWidget",uW,l(e)),r(e,"containerUITransform",cW,l(e)),e}return e(s,[{key:"__preload",value:function(){D.on(kn,this.handleStarsUpdateEvent,this),D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),D.on($e.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"start",value:function(){this.handleOrientationChanged()}},{key:"onDestroy",value:function(){D.off(kn,this.handleStarsUpdateEvent,this),D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),D.off($e.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"updateDailyRewardsButton",value:function(){this.dailyRewardsWidget.refresh()}},{key:"updateStarProgress",value:function(e){this.handleStarsUpdateEvent(e)}},{key:"updateStarChestButtonAnimation",value:function(e){this.chestButton.isAvailable=e>=20}},{key:"handleStarsUpdateEvent",value:function(e){var t,n=null!=e?e:null===(t=MW.getGameData())||void 0===t?void 0:t.stars;void 0!==n&&(this.starProgressBar.setRange(n,20),this.updateStarChestButtonAnimation(n))}},{key:"handleOrientationChanged",value:function(){Ze.isPortrait()?this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!0:Ze.isLandscape()&&(this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!1,this.containerUITransform.width=Math.min(this.uiTransform.width,1366)),this.containerWidget.getComponentsInChildren(I).forEach((function(e,t){e.updateAlignment()}))}},{key:"handleClickedSettingsButton",value:function(){lt.openScreen(st.SETTINGS_SCREEN)}}]),s}(T)).prototype,"starProgressBar",[J$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rW=a(aW.prototype,"chestButton",[Z$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lW=a(aW.prototype,"dailyRewardsWidget",[Q$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sW=a(aW.prototype,"uiTransform",[eW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uW=a(aW.prototype,"containerWidget",[tW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cW=a(aW.prototype,"containerUITransform",[nW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iW=aW))||iW);S._RF.pop(),S._RF.push({},"3b954Re2cRHvYJeBVAukYp9","JourneyLevelAvatar",void 0);var BW,FW,xW,zW,UW,GW,HW,qW,VW,$W,WW,KW,jW,YW=C.ccclass,XW=C.property,JW=C.executeInEditMode,ZW=(yW=YW("JourneyLevelAvatar"),vW=XW({type:F,displayName:"Avatar node"}),fW=XW(q),gW=XW(ce),mW=XW(B),bW=XW({type:de,group:"Animation"}),wW=XW({type:de,group:"Animation"}),SW=XW({type:de,group:"Animation"}),kW=XW({type:ue,displayName:"Avatar sprite"}),yW(CW=JW((AW=a((EW=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"sprite",AW,l(e)),r(e,"lockIcon",TW,l(e)),r(e,"animation",PW,l(e)),r(e,"opacity",OW,l(e)),r(e,"flashAnimation",LW,l(e)),r(e,"unlockAnimation",IW,l(e)),r(e,"spawnAnimation",RW,l(e)),e}return e(h,[{key:"avatarSprite",get:function(){var e,t;return null!==(e=null===(t=this.sprite)||void 0===t?void 0:t.spriteFrame)&&void 0!==e?e:null},set:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"playUnlockAnimation",value:(c=o((function*(){var e=this.playAnimation(this.unlockAnimation),t=this.lockIcon.position.x,n=this.lockIcon.position.y,i=[45,135],a=(Math.random()*(i[1]-i[0])+i[0])*(Math.PI/180),o=this.lockIcon.position.x+150*Math.cos(a),r=this.lockIcon.position.y+150*Math.sin(a),l=n-400,s=Ve.runTweenAsync(R(this.lockIcon).delay(.3).to(.2,{position:new V(o,r,this.lockIcon.position.z)},{easing:"sineOut"}).to(.4,{position:new V(o,l,this.lockIcon.position.z)},{easing:"cubicIn"})),u=[0,360],c=Ve.runTweenAsync(R(this.lockIcon).delay(.3).to(.6,{eulerAngles:new V(0,0,Math.random()*(u[1]-u[0])*(o>t?-1:1))},{easing:"sineOut"}));yield Promise.all([e,s,c]),this.lockIcon.position=new V(t,n,this.lockIcon.position.z),this.lockIcon.eulerAngles=new V(0,0,0)})),function(){return c.apply(this,arguments)})},{key:"playFlashAnimation",value:(u=o((function*(e){var t=this.node.position.y,n=this.playAnimation(this.flashAnimation),i=Ve.runTweenAsync(R(this.node).to(.1,{position:new V(this.node.position.x,this.node.position.y+10,this.node.position.z)},{easing:"sineOut"}).to(.1,{position:new V(this.node.position.x,t,this.node.position.z)},{easing:"sineIn"}),e);yield Promise.all([n,i])})),function(e){return u.apply(this,arguments)})},{key:"playSpawnAnimation",value:function(){this.opacity.opacity=255,this.playAnimation(this.spawnAnimation)}},{key:"hideImmediately",value:function(){this.opacity.opacity=0,this.node.setScale(V.ZERO)}},{key:"playAnimation",value:(s=o((function*(e){yield Ve.runAnimationAsync(this.animation,e.name)})),function(e){return s.apply(this,arguments)})},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){var e=this;if(!this.sprite)throw new Error("JourneyLevelAvatar: Avatar node is required");if(!this.lockIcon)throw new Error("JourneyLevelAvatar: Lock icon is required");if(!this.flashAnimation)throw new Error("JourneyLevelAvatar: Flash animation is required");if(!this.unlockAnimation)throw new Error("JourneyLevelAvatar: Unlock animation is required");if(!this.animation)throw new Error("JourneyLevelAvatar: Animation component is required");if(!this.animation.clips.some((function(t){return null!==t&&(t.name===e.flashAnimation.name||t.name===e.unlockAnimation.name||t.name===e.spawnAnimation.name)})))throw new Error("JourneyLevelAvatar: Animation component does not contain required animations")}}]),h}(T)).prototype,"sprite",[vW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),TW=a(EW.prototype,"lockIcon",[fW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PW=a(EW.prototype,"animation",[gW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OW=a(EW.prototype,"opacity",[mW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LW=a(EW.prototype,"flashAnimation",[bW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IW=a(EW.prototype,"unlockAnimation",[wW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RW=a(EW.prototype,"spawnAnimation",[SW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(EW.prototype,"avatarSprite",[kW],Object.getOwnPropertyDescriptor(EW.prototype,"avatarSprite"),EW.prototype),CW=EW))||CW)||CW);S._RF.pop(),S._RF.push({},"a392bibG75JPKzG0y2ZS2YY","JourneyProgressBar",void 0);var QW,eK,tK,nK,iK,aK,oK,rK,lK,sK,uK,cK,dK,hK,pK,yK,vK,fK,gK,mK,bK,wK,SK,kK,CK,EK,AK=C.ccclass,TK=C.property,PK=C.executeInEditMode,OK=(BW=AK("JourneyProgressBar"),FW=TK(Ic),xW=TK(K),zW=TK(B),UW=TK(O),GW=TK(O),HW=TK(E),qW=Yn.onlyRunInLifeCycle,BW(VW=PK((WW=a(($W=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"progressBar",WW,l(e)),r(e,"progressLabel",KW,l(e)),r(e,"labelUIOpacity",jW,l(e)),e.currentProgress=10,e.totalProgress=10,e.labelSeparator="/",e}return e(c,[{key:"total",get:function(){return this.totalProgress}},{key:"current",get:function(){return this.currentProgress}},{key:"separator",get:function(){return this.labelSeparator},set:function(e){this.labelSeparator=e,this.updateProgress()}},{key:"setRange",value:function(e,t){this.totalProgress=t;var n=e;n>t&&(n=t),this.currentProgress=n,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"animateTo",value:(s=o((function*(e){var t=this,n=e.nextCurr,i=e.nextTotal,a=e.numberOfProgressBar,o=void 0===a?0:a,r=e.onProgressBarPassed,l=e.signal,s=n/i,u=R(this.labelUIOpacity).to(.2,{opacity:0}),c=R(this.labelUIOpacity).to(.2,{opacity:255}),d=o<1?1:Math.sqrt(o)+1,h=0===o?s:o+s,p=1,y=this.progressBar.progress,v=h,f=Ve.runOnUpdateAsync(this.node,d,(function(e){var n=z.sineInOut(e),i=Se(y,v,n);t.progressBar.progress=i%1,i>p&&(p=0===i?1:Math.ceil(i),null==r||r())}),l);return yield Promise.all([Ve.runTweenAsync(u,l),f]),this.currentProgress=n,this.totalProgress=i,this.updateProgress(),yield Ve.runTweenAsync(c,l),this.labelUIOpacity.opacity=255,s})),function(e){return s.apply(this,arguments)})},{key:"updateProgress",value:function(){this.progressBar.progress=this.currentProgress/this.totalProgress,this.progressLabel.string="".concat(this.currentProgress).concat(this.separator).concat(this.totalProgress)}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),c}(T)).prototype,"progressBar",[FW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KW=a($W.prototype,"progressLabel",[xW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jW=a($W.prototype,"labelUIOpacity",[zW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a($W.prototype,"total",[UW],Object.getOwnPropertyDescriptor($W.prototype,"total"),$W.prototype),a($W.prototype,"current",[GW],Object.getOwnPropertyDescriptor($W.prototype,"current"),$W.prototype),a($W.prototype,"separator",[HW],Object.getOwnPropertyDescriptor($W.prototype,"separator"),$W.prototype),a($W.prototype,"updateProgress",[qW],Object.getOwnPropertyDescriptor($W.prototype,"updateProgress"),$W.prototype),VW=$W))||VW)||VW);S._RF.pop(),S._RF.push({},"8a41bfxLylDhLk57kewW14A","JourneyProgressAnimator",void 0);var LK,IK,RK,_K,DK,MK,NK,BK,FK,xK,zK,UK=C.ccclass,GK=C.property,HK=(QW=UK("ProgressConfiguration"),eK=GK(ue),tK=GK(E),QW((aK=a((iK=e((function e(){t(this,e),r(this,"avatar",aK,this),r(this,"themeId",oK,this)}))).prototype,"avatar",[eK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oK=a(iK.prototype,"themeId",[tK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nK=iK)),rK=UK("JourneyProgressAnimator"),lK=Yn.required(),sK=GK(OK),uK=Yn.required(),cK=GK(q),dK=Yn.required(),hK=GK(F),pK=Yn.required(),yK=GK(ZW),vK=GK({type:L,displayName:"Next Level Y Offset on Animation",group:"Unlocked Animation"}),fK=Yn.onlyRunInLifeCycleAsync,gK=Yn.onlyRunInLifeCycle,rK((wK=a((bK=function(a){n(v,a);var s,u,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"progressBar",wK,l(e)),r(e,"currentLevelAvatarNode",SK,l(e)),r(e,"currentLevelAvatar",kK,l(e)),r(e,"nextLevelAvatar",CK,l(e)),r(e,"nextLevelYOffset",EK,l(e)),e.isAnimating=!1,e}return e(v,[{key:"setRange",value:function(e,t){this.progressBar.setRange(e,t)}},{key:"animateTo",value:(p=o((function*(e,t){if(this.isAnimating)return console.warn("JourneyProgressAnimator: animation already in progress"),Promise.resolve();this.isAnimating=!0,e!==this.progressBar.current&&(yield this.progressBar.animateTo({nextCurr:e,nextTotal:this.progressBar.total,signal:t})),this.isAnimating=!1})),function(e,t){return p.apply(this,arguments)})},{key:"animateToNextLevel",value:(h=o((function*(e){var t=this,n=e.nextCurr,i=e.nextTotal,a=e.mapsPassed,o=e.signal;if(this.isAnimating)console.warn("JourneyProgressAnimator: animation already in progress");else{this.isAnimating=!0;var r=a.length-2;if(0===r)return yield this.progressBar.animateTo({nextCurr:n,nextTotal:i,signal:o}),void(this.isAnimating=!1);yield this.animateTargetAvaToCenter(o);var l=1;yield this.progressBar.animateTo({signal:o,nextCurr:n,nextTotal:i,numberOfProgressBar:r,onProgressBarPassed:function(){if(1===l)return t.nextLevelAvatar.playUnlockAnimation(),void(l+=1);if(l>=a.length)throw new Error("JourneyProgressAnimator: currThemeIndex out of bounds");t.nextLevelAvatar.playFlashAnimation(o),t.setNextLevelAvatar(a[l].theme),l+=1}}),yield this.animateTargetAvaToPrev(o);var s=a[a.length-1].theme,u=a[a.length-2].theme;this.setCurrentLevelAvatar(u),this.nextLevelAvatar.hideImmediately(),this.moveTargetAvaToOriginal(),this.nextLevelAvatar.avatarSprite=yield this.getSpriteFrameByThemeId(s),this.nextLevelAvatar.playSpawnAnimation(),this.isAnimating=!1}})),function(e){return h.apply(this,arguments)})},{key:"animateTargetAvaToCenter",value:(d=o((function*(e){var t=new V(0,this.nextLevelYOffset+this.nextLevelAvatar.node.position.y,this.nextLevelAvatar.node.position.z);yield Ve.runTweenAsync(R(this.nextLevelAvatar.node).to(1,{position:t},{easing:"cubicInOut"}),e),this.nextLevelAvatar.node.position=t})),function(e){return d.apply(this,arguments)})},{key:"moveTargetAvaToOriginal",value:function(){this.nextLevelAvatar.node.position=this.originalNextLevelAvatarPosition.clone()}},{key:"animateTargetAvaToPrev",value:(c=o((function*(e){var t=this.currentLevelAvatarNode.position.clone();yield Ve.runTweenAsync(R(this.nextLevelAvatar.node).to(1,{position:t},{easing:"cubicInOut"}),e),this.nextLevelAvatar.node.position=t})),function(e){return c.apply(this,arguments)})},{key:"getSpriteFrameByThemeId",value:(u=o((function*(e){return qe.loadThemeThumbnailAsync(e)})),function(e){return u.apply(this,arguments)})},{key:"loadAndSetAvatar",value:(s=o((function*(e,t){var n=yield this.getSpriteFrameByThemeId(e);n?this.setAvatar(n,t):console.warn("JourneyProgressAnimator: ".concat(e," is null"))})),function(e,t){return s.apply(this,arguments)})},{key:"setAvatar",value:function(e,t){t instanceof ZW?t.avatarSprite=e:t.spriteFrame=e}},{key:"setCurrentLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.currentLevelAvatar)}},{key:"setNextLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.nextLevelAvatar)}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,v),this.originalNextLevelAvatarPosition=this.nextLevelAvatar.node.position.clone()}}]),v}(T)).prototype,"progressBar",[lK,sK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SK=a(bK.prototype,"currentLevelAvatarNode",[uK,cK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kK=a(bK.prototype,"currentLevelAvatar",[dK,hK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CK=a(bK.prototype,"nextLevelAvatar",[pK,yK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EK=a(bK.prototype,"nextLevelYOffset",[vK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(bK.prototype,"loadAndSetAvatar",[fK],Object.getOwnPropertyDescriptor(bK.prototype,"loadAndSetAvatar"),bK.prototype),a(bK.prototype,"setAvatar",[gK],Object.getOwnPropertyDescriptor(bK.prototype,"setAvatar"),bK.prototype),mK=bK))||mK);S._RF.pop(),S._RF.push({},"4b935BmCjhBf73yEp1PitwH","LandscapeMask",void 0);var qK,VK,$K,WK,KK,jK,YK,XK,JK,ZK,QK,ej,tj,nj=C.ccclass,ij=C.property,aj=(LK=nj("LandscapeMask"),IK=ij(qr),RK=ij(P),_K=ij(P),DK=ij(P),LK((BK=a((NK=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"opacityToggler",BK,l(e)),r(e,"uiTransform",FK,l(e)),r(e,"leftMask",xK,l(e)),r(e,"rightMask",zK,l(e)),e}return e(s,[{key:"__preload",value:function(){D.on($e.VIEW_RESIZED,this.onViewResized,this)}},{key:"onDestroy",value:function(){D.off($e.VIEW_RESIZED,this.onViewResized,this)}},{key:"onViewResized",value:function(){this.updateMaskPosition()}},{key:"updateMaskPosition",value:function(){var e=this.uiTransform.contentSize,t=e.width,n=e.height;this.leftMask.width=this.rightMask.width=2*n;var i=this.leftMask.height>.3*t?this.leftMask.height-.3*t:0;this.leftMask.node.setWorldPosition(-i,this.leftMask.node.worldPosition.y,0),this.rightMask.node.setWorldPosition(t+i,this.rightMask.node.worldPosition.y,0)}},{key:"show",value:function(){this.opacityToggler.changeStateFade(!0,.2)}},{key:"hide",value:function(){this.opacityToggler.changeStateFade(!1,.1)}}]),s}(T)).prototype,"opacityToggler",[IK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FK=a(NK.prototype,"uiTransform",[RK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xK=a(NK.prototype,"leftMask",[_K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zK=a(NK.prototype,"rightMask",[DK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MK=NK))||MK);S._RF.pop(),S._RF.push({},"ee748sgCHxCTaIJcL1SUIFl","CustomButton",void 0);var oj,rj,lj,sj,uj,cj,dj,hj,pj,yj,vj,fj,gj,mj,bj=C.ccclass,wj=C.property,Sj=(qK=bj("CustomButton"),VK=wj(F),$K=wj(ue),WK=wj(ue),KK=wj(G),jK=wj(q),qK((JK=a((XK=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"sprite",JK,l(e)),r(e,"lockedSprite",ZK,l(e)),r(e,"unlockedSprite",QK,l(e)),r(e,"button",ej,l(e)),r(e,"unlockContainer",tj,l(e)),e}return e(c,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e>=13;this.button.interactable=t,this.unlockContainer.active=!t,this.sprite.spriteFrame=t?this.unlockedSprite:this.lockedSprite}},{key:"handleOnClicked",value:(s=o((function*(){var e;(null!==(e=(yield lt.openScreenAndWaitForClose(st.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==e?e:{}).customMode&&this.node.scene.emit(En)})),function(){return s.apply(this,arguments)})}]),c}(T)).prototype,"sprite",[VK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZK=a(XK.prototype,"lockedSprite",[$K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QK=a(XK.prototype,"unlockedSprite",[WK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ej=a(XK.prototype,"button",[KK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tj=a(XK.prototype,"unlockContainer",[jK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YK=XK))||YK);S._RF.pop(),S._RF.push({},"a479fLcnJ9AtqhT/3Hs2xco","CustomGuideUI",void 0);var kj,Cj,Ej,Aj,Tj,Pj,Oj,Lj,Ij,Rj,_j,Dj,Mj,Nj,Bj,Fj=C.ccclass,xj=C.property,zj=(oj=Fj("CustomGuideUI"),rj=Yn.required(),lj=xj(Sj),sj=Yn.required(),uj=xj(zR),cj=Yn.required(),dj=xj(K),hj=Yn.onlyRunInLifeCycleAsync,pj=Yn.onlyRunInLifeCycleAsync,oj((fj=a((vj=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"customButton",fj,l(e)),r(e,"guideMasks",gj,l(e)),r(e,"guideInfoText",mj,l(e)),e.guideShown=!1,e}return e(c,[{key:"update",value:function(){if(this.guideShown){var e=this.customButton.node.worldPosition;this.guideInfoText.node.worldPosition=new V(e.x-100,e.y,0),this.guideMasks.setOtherMaskTransform(e.x,e.y,150,150)}}},{key:"startGuide",value:(s=o((function*(){var e;this.guideShown=!0,this.guideInfoText.node.active=!0,yield this.guideMasks.show(),yield Promise.race([this.waitForClick(),Ve.waitTweenAsync(3)]),yield null===(e=this.guideMasks)||void 0===e?void 0:e.hide(),this.guideInfoText.node.active=!1,this.guideShown=!1})),function(){return s.apply(this,arguments)})},{key:"waitForClick",value:function(){var e=this;return new Promise((function(t){e.node.scene.once(Es.GUIDE_MASK_CLICKED,(function(){t()}))}))}}]),c}(T)).prototype,"customButton",[rj,lj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gj=a(vj.prototype,"guideMasks",[sj,uj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mj=a(vj.prototype,"guideInfoText",[cj,dj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(vj.prototype,"startGuide",[hj],Object.getOwnPropertyDescriptor(vj.prototype,"startGuide"),vj.prototype),a(vj.prototype,"waitForClick",[pj],Object.getOwnPropertyDescriptor(vj.prototype,"waitForClick"),vj.prototype),yj=vj))||yj);S._RF.pop(),S._RF.push({},"21121NZ8PtCJJpkj1j2/qOg","PlayButton",void 0);var Uj,Gj,Hj,qj,Vj,$j,Wj,Kj,jj,Yj,Xj,Jj,Zj,Qj,eY,tY,nY,iY,aY,oY,rY,lY,sY,uY,cY,dY,hY,pY,yY,vY,fY,gY,mY,bY,wY,SY,kY,CY,EY,AY,TY,PY=C.ccclass,OY=C.property,LY=(kj=PY("PlayButton"),Cj=Yn.required(),Ej=OY(th),Aj=Yn.required(),Tj=OY(q),Pj=Yn.required(),Oj=OY(q),Lj=Yn.required(),Ij=OY(G),kj((Dj=a((_j=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"localizer",Dj,l(e)),r(e,"defaultBackground",Mj,l(e)),r(e,"hardLevelBackground",Nj,l(e)),r(e,"button",Bj,l(e)),e}return e(s,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e%5==0;this.localizer.setParams([e.toString()]),this.defaultBackground.active=!t,this.hardLevelBackground.active=t}},{key:"handleOnClicked",value:function(){this.node.scene.emit(Cn)}}]),s}(T)).prototype,"localizer",[Cj,Ej],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mj=a(_j.prototype,"defaultBackground",[Aj,Tj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nj=a(_j.prototype,"hardLevelBackground",[Pj,Oj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bj=a(_j.prototype,"button",[Lj,Ij],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rj=_j))||Rj);S._RF.pop(),S._RF.push({},"c2ddaEnKBVFvrM5x5nbfT7h","HomeContent",void 0);var IY,RY,_Y,DY,MY,NY,BY,FY,xY,zY,UY,GY,HY,qY,VY,$Y,WY,KY,jY,YY,XY,JY,ZY,QY,eX,tX,nX,iX,aX,oX,rX,lX,sX=C.ccclass,uX=C.property,cX=codex,dX=cX.storage,hX=cX.monitorError,pX=cX.player,yX=Ludex.Utils,vX=yX.Array,fX=yX.Json,gX=(Uj=sX("HomeContent"),Gj=Yn.required(),Hj=uX({type:LY,group:"Play Button"}),qj=Yn.required(),Vj=uX({type:Sj,group:"Play Button"}),$j=Yn.required(),Wj=uX(qr),Kj=Yn.required(),jj=uX(HK),Yj=Yn.required(),Xj=uX(NW),Jj=Yn.required(),Zj=uX(B),Qj=Yn.required(),eY=uX(Tx),tY=Yn.required(),nY=uX(q),iY=Yn.required(),aY=uX(aj),oY=Yn.required(),rY=uX(zj),lY=Yn.onlyRunInLifeCycleAsync,sY=Yn.onlyRunInLifeCycleAsync,uY=Yn.onlyRunInLifeCycleAsync,cY=Yn.onlyRunInLifeCycleAsync,dY=Yn.onlyRunInLifeCycleAsync,hY=Yn.onlyRunInLifeCycle,pY=Yn.onlyRunInLifeCycle,yY=Yn.onlyRunInLifeCycleAsync,Uj((gY=a((fY=function(a){n(v,a);var u,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"playButton",gY,l(e)),r(e,"customButton",mY,l(e)),r(e,"contentOpacity",bY,l(e)),r(e,"journeyProgressAnimator",wY,l(e)),r(e,"dashboardHeader",SY,l(e)),r(e,"overlayDuringAnim",kY,l(e)),r(e,"coinContainer",CY,l(e)),r(e,"leavesContainer",EY,l(e)),r(e,"landscapeMask",AY,l(e)),r(e,"customGuideUI",TY,l(e)),e}return e(v,[{key:"onLoad",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(),Yn.validateRequiredProperties(this)}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"listenEvents",value:function(){this.node.scene.on(Es.HIDE_UI,this.hideContent,this),this.node.scene.on(Es.SHOW_UI,this.showContent,this)}},{key:"unlistenEvents",value:function(){this.node.scene.off(Es.HIDE_UI,this.hideContent,this),this.node.scene.off(Es.SHOW_UI,this.showContent,this)}},{key:"getCoinContainer",value:function(){return this.coinContainer}},{key:"updateStatus",value:function(){var e,t=null!==(e=pX.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?1:n,a=t.stars,o=void 0===a?0:a;this.playButton.updateStatus(i),this.customButton.updateStatus(i),this.dashboardHeader.updateStarProgress(o),this.dashboardHeader.updateDailyRewardsButton()}},{key:"updateDailyRewardsButton",value:function(){this.dashboardHeader.updateDailyRewardsButton()}},{key:"setUnlockProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setProgress(e),this.updateCurrentMapInStorage(e,t)}},{key:"shouldPlayUnlockAnimation",value:function(){var e,t,n=dX.getStorage("dashboard");if(null==n)return null==hX||hX.sendException(new Error("DashboardScene: dashboardStorage not found")),!1;if(!(null!==(e=n.animateToCurrentLevel)&&void 0!==e&&e))return!1;var i=dX.getStorage("tournament");if(null==i)return null==hX||hX.sendException(new Error("DashboardScene: tournamentStorage not found")),!1;if(null!==(t=i.animateTournamentLeader)&&void 0!==t&&t)return!1;var a=n.lastMapPayload,o=Vy.getCurrentMapProgress();return fX.encode(a)!==fX.encode(o)&&!(vX.searchIndex(xy.mapOrder,(function(e){return e.id===a.id}))>vX.searchIndex(xy.mapOrder,(function(e){return e.id===o.id})))}},{key:"playUnlockProgressAnimation",value:function(e){var t=dX.getStorage("dashboard");if(null==t)throw new Error("DashboardScene: dashboardStorage not found");var n=t.lastMapPayload,i=Vy.getCurrentMapProgress(),a=vX.searchIndex(xy.mapOrder,(function(e){return e.id===n.id})),o=vX.searchIndex(xy.mapOrder,(function(e){return e.id===i.id})),r=xy.mapOrder.slice(a,o+2);return n.id===i.id?this.playUnlockProgressAnimationOnly(i,n,e):this.playUnlockProgressAndPackAnimation(n,i,r,e)}},{key:"playUnlockProgressAndPackAnimation",value:(p=o((function*(e,t,n,i){this.setProgress(s({},e)),this.updateCurrentMapInStorage(s({},t),!0),this.playButton.interactable=!1,yield this.showOwnOverlay(i),yield this.journeyProgressAnimator.animateToNextLevel({nextCurr:t.progress,nextTotal:t.max,mapsPassed:n,signal:i}),yield this.hideOwnOverlay(i),this.playButton.interactable=!0})),function(e,t,n,i){return p.apply(this,arguments)})},{key:"playUnlockProgressAnimationOnly",value:(h=o((function*(e,t,n){this.setProgress(s(s({},e),{},{progress:t.progress})),this.updateCurrentMapInStorage(s({},e),!0);var i=e.progress;yield this.showOwnOverlay(n),yield this.journeyProgressAnimator.animateTo(i,n),yield this.hideOwnOverlay(n)})),function(e,t,n){return h.apply(this,arguments)})},{key:"hideOwnOverlay",value:(d=o((function*(e){yield Ve.runTweenAsync(R(this.overlayDuringAnim).to(.3,{opacity:0}),e),this.node.activeInHierarchy&&(this.overlayDuringAnim.opacity=0)})),function(e){return d.apply(this,arguments)})},{key:"showOwnOverlay",value:(c=o((function*(e){yield Ve.runTweenAsync(R(this.overlayDuringAnim).to(.3,{opacity:150}),e)})),function(e){return c.apply(this,arguments)})},{key:"setProgress",value:function(e){var t=e.currentTheme,n=e.nextTheme,i=e.progress,a=e.max;this.journeyProgressAnimator.setCurrentLevelAvatar(t),this.journeyProgressAnimator.setNextLevelAvatar(null!=n?n:t),this.journeyProgressAnimator.setRange(i,a)}},{key:"updateCurrentMapInStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=dX.getStorage("dashboard");if(null!=n){var i=n.animateToCurrentLevel;dX.setStorageData("dashboard","animateToCurrentLevel",!t&&i),dX.setStorageData("dashboard","lastMapPayload",e)}else null==hX||hX.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"handleOrientationChanged",value:function(){this.leavesContainer.active=Ze.isLandscape(),this.landscapeMask.node.active=Ze.isLandscape()}},{key:"transitionIn",value:function(){this.listenEvents(),this.landscapeMask.node.active&&(this.landscapeMask.updateMaskPosition(),this.landscapeMask.show())}},{key:"transitionOut",value:function(){this.unlistenEvents(),this.landscapeMask.node.active&&this.landscapeMask.hide()}},{key:"hideContent",value:function(){this.contentOpacity.changeStateFade(!1,.5)}},{key:"showContent",value:function(){this.contentOpacity.changeStateFade(!0,.1)}},{key:"showCustomGuide",value:(u=o((function*(){yield this.customGuideUI.startGuide()})),function(){return u.apply(this,arguments)})}]),v}(T)).prototype,"playButton",[Gj,Hj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mY=a(fY.prototype,"customButton",[qj,Vj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bY=a(fY.prototype,"contentOpacity",[$j,Wj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wY=a(fY.prototype,"journeyProgressAnimator",[Kj,jj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SY=a(fY.prototype,"dashboardHeader",[Yj,Xj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kY=a(fY.prototype,"overlayDuringAnim",[Jj,Zj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CY=a(fY.prototype,"coinContainer",[Qj,eY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EY=a(fY.prototype,"leavesContainer",[tY,nY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AY=a(fY.prototype,"landscapeMask",[iY,aY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TY=a(fY.prototype,"customGuideUI",[oY,rY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(fY.prototype,"playUnlockProgressAnimation",[lY],Object.getOwnPropertyDescriptor(fY.prototype,"playUnlockProgressAnimation"),fY.prototype),a(fY.prototype,"playUnlockProgressAndPackAnimation",[sY],Object.getOwnPropertyDescriptor(fY.prototype,"playUnlockProgressAndPackAnimation"),fY.prototype),a(fY.prototype,"playUnlockProgressAnimationOnly",[uY],Object.getOwnPropertyDescriptor(fY.prototype,"playUnlockProgressAnimationOnly"),fY.prototype),a(fY.prototype,"hideOwnOverlay",[cY],Object.getOwnPropertyDescriptor(fY.prototype,"hideOwnOverlay"),fY.prototype),a(fY.prototype,"showOwnOverlay",[dY],Object.getOwnPropertyDescriptor(fY.prototype,"showOwnOverlay"),fY.prototype),a(fY.prototype,"hideContent",[hY],Object.getOwnPropertyDescriptor(fY.prototype,"hideContent"),fY.prototype),a(fY.prototype,"showContent",[pY],Object.getOwnPropertyDescriptor(fY.prototype,"showContent"),fY.prototype),a(fY.prototype,"showCustomGuide",[yY],Object.getOwnPropertyDescriptor(fY.prototype,"showCustomGuide"),fY.prototype),vY=fY))||vY);S._RF.pop(),S._RF.push({},"ba822axo49BibgkqkEhhqVp","DashboardPage",void 0);var mX,bX,wX,SX,kX,CX,EX,AX,TX,PX=C.ccclass,OX=C.property,LX=C.disallowMultiple,IX=C.requireComponent,RX=(IY=PX("DashboardPage"),RY=IX(I),_Y=IX(B),DY=Yn.required(),MY=OX({type:q,displayName:"Page's container"}),NY=Yn.required(),BY=Yn.required(),FY=OX({type:q,displayName:"Placeholder"}),xY=Yn.required(),zY=OX({displayName:"Don't create prefab",tooltip:"Tell the component to not create the prefab even if it hasn't create yet"}),UY=OX({displayName:"Darken background"}),GY=OX({type:O,min:0,max:255,displayName:"Background opacity",visible:function(){return this.darkenBackground}}),HY=OX({displayName:"Use navbar shadow"}),qY=OX({type:O,min:0,max:255,displayName:"Navbar shadow opacity",visible:function(){return this.useNavbarShadow}}),VY=Yn.required(),$Y=Yn.required(),WY=Yn.onlyRunInLifeCycleAsync,KY=Yn.onlyRunInLifeCycle,jY=Yn.onlyRunInLifeCycleAsync,IY(YY=LX(YY=RY(YY=_Y((JY=a((XY=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"container",JY,l(e)),r(e,"containerUIOpacity",ZY,l(e)),r(e,"placeholder",QY,l(e)),r(e,"placeholderUIOpacity",eX,l(e)),r(e,"hasCreated",tX,l(e)),e.pagePrefab=null,r(e,"darkenBackground",nX,l(e)),r(e,"backgroundOpacity",iX,l(e)),r(e,"useNavbarShadow",aX,l(e)),r(e,"navbarShadowOpacity",oX,l(e)),r(e,"uiOpacity",rX,l(e)),r(e,"widgetComponent",lX,l(e)),e}return e(d,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(B),this.widgetComponent=this.getComponent(I),this.containerUIOpacity=this.container.getComponent(B),this.placeholderUIOpacity=this.placeholder.getComponent(B),Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.container.active=!0,this.placeholder.active=!0}},{key:"getWidget",value:function(){return this.widgetComponent}},{key:"show",value:function(){this.uiOpacity.opacity=255}},{key:"hide",value:function(){this.uiOpacity.opacity=0}},{key:"mount",value:(u=o((function*(){this.hasCreated||(yield this.create()),this.mountInLifeCycle()})),function(){return u.apply(this,arguments)})},{key:"mountInLifeCycle",value:function(){this.placeholderUIOpacity.opacity=0,this.containerUIOpacity.opacity=255,Ye.trackCurrentPage(this.node.name,!0)}},{key:"unmount",value:function(){255===this.placeholderUIOpacity.opacity&&0===this.containerUIOpacity.opacity||(this.placeholderUIOpacity.opacity=255,this.containerUIOpacity.opacity=0)}},{key:"transitionIn",value:function(){return Promise.resolve()}},{key:"transitionOut",value:function(){return Promise.resolve()}},{key:"hasLoadedPage",value:function(){return!0}},{key:"getContainer",value:function(){return this.container}},{key:"getDarkenBackground",value:function(){return this.darkenBackground?this.backgroundOpacity:0}},{key:"getNavbarShadow",value:function(){return this.useNavbarShadow?this.navbarShadowOpacity:0}},{key:"create",value:(s=o((function*(){if(this.pagePrefab&&!this.hasCreated){var e=ye(this.pagePrefab);this.container.addChild(e),yield Ve.waitTweenAsync(0),this.hasCreated=!0}})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"container",[DY,MY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZY=a(XY.prototype,"containerUIOpacity",[NY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QY=a(XY.prototype,"placeholder",[BY,FY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eX=a(XY.prototype,"placeholderUIOpacity",[xY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tX=a(XY.prototype,"hasCreated",[zY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nX=a(XY.prototype,"darkenBackground",[UY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),iX=a(XY.prototype,"backgroundOpacity",[GY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),aX=a(XY.prototype,"useNavbarShadow",[HY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oX=a(XY.prototype,"navbarShadowOpacity",[qY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),rX=a(XY.prototype,"uiOpacity",[VY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lX=a(XY.prototype,"widgetComponent",[$Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(XY.prototype,"mount",[WY],Object.getOwnPropertyDescriptor(XY.prototype,"mount"),XY.prototype),a(XY.prototype,"mountInLifeCycle",[KY],Object.getOwnPropertyDescriptor(XY.prototype,"mountInLifeCycle"),XY.prototype),a(XY.prototype,"create",[jY],Object.getOwnPropertyDescriptor(XY.prototype,"create"),XY.prototype),YY=XY))||YY)||YY)||YY)||YY);S._RF.pop(),S._RF.push({},"dab8cbliOBAeZ7iVs959mBm","CollectionsPage",void 0);var _X,DX,MX,NX,BX,FX,xX,zX,UX,GX,HX,qX,VX,$X,WX,KX,jX,YX,XX,JX,ZX,QX,eJ,tJ,nJ,iJ,aJ,oJ,rJ,lJ,sJ,uJ,cJ,dJ,hJ,pJ,yJ,vJ,fJ,gJ=(mX=(0,C.ccclass)("CollectionsPage"),bX=Yn.required(),wX=Yn.onlyRunInLifeCycleAsync,SX=Yn.onlyRunInLifeCycle,kX=Yn.onlyRunInLifeCycleAsync,CX=Yn.onlyRunInLifeCycleAsync,mX((TX=a((AX=function(a){n(v,a);var s,u,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=y.call.apply(y,[this].concat(i))).payload=null,r(e,"panelAnimationController",TX,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(qs),c(d(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(p=o((function*(){c(d(v.prototype),"start",this).call(this)})),function(){return p.apply(this,arguments)})},{key:"setPayload",value:function(e){this.payload=e}},{key:"mount",value:(h=o((function*(){yield c(d(v.prototype),"mount",this).call(this),this.onMount()})),function(){return h.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,!this.themeContent&&(this.themeContent=this.container.getComponentInChildren(s$),!this.themeContent))throw new Error("No theme content found");var e=Vy.getCollectionUnlockProgress();this.themeContent.updateUnlockedProgress(e),this.payload&&this.themeContent.init(this.payload)}},{key:"transitionIn",value:(u=o((function*(){yield c(d(v.prototype),"transitionIn",this).call(this),this.themeContent.restoreScrollPosition(),this.themeContent.listenEvents();var e=Ve.runTweenAsync(R(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();yield Promise.all([e,t])})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(s=o((function*(){yield c(d(v.prototype),"transitionOut",this).call(this),this.themeContent.preserveScrollPosition(),this.themeContent.unlistenUIEvents(),yield this.panelAnimationController.hideUI(),this.themeContent.unlistenEvents()})),function(){return s.apply(this,arguments)})}]),v}(RX)).prototype,"panelAnimationController",[bX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(AX.prototype,"mount",[wX],Object.getOwnPropertyDescriptor(AX.prototype,"mount"),AX.prototype),a(AX.prototype,"onMount",[SX],Object.getOwnPropertyDescriptor(AX.prototype,"onMount"),AX.prototype),a(AX.prototype,"transitionIn",[kX],Object.getOwnPropertyDescriptor(AX.prototype,"transitionIn"),AX.prototype),a(AX.prototype,"transitionOut",[CX],Object.getOwnPropertyDescriptor(AX.prototype,"transitionOut"),AX.prototype),EX=AX))||EX);S._RF.pop(),S._RF.push({},"2381b1mKt1PUq5W+fsaaOYP","PageManager",void 0);var mJ,bJ,wJ,SJ,kJ,CJ,EJ,AJ,TJ,PJ,OJ,LJ,IJ,RJ,_J,DJ,MJ,NJ=C.ccclass,BJ=C.property,FJ=C.disallowMultiple,xJ=C.requireComponent,zJ=Ludex.Utils.Array,UJ=(_X=NJ("PageManagerItem"),DX=BJ(RX),MX=BJ({type:x(On)}),_X((FX=a((BX=e((function e(){t(this,e),r(this,"page",FX,this),r(this,"pageType",xX,this)}))).prototype,"page",[DX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xX=a(BX.prototype,"pageType",[MX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NX=BX))||NX),GJ=(zX=NJ("PageManager"),UX=xJ(P),GX=Yn.required(),HX=BJ({type:B,displayName:"Background Mask",group:"Background Mask"}),qX=BJ({type:L,displayName:"Transition duration",group:"Background Mask"}),VX=BJ({type:L,displayName:"Transition delay",group:"Background Mask"}),$X=Yn.required(),WX=BJ({type:B,displayName:"Nav Bar Shadow",group:"Nav Bar Shadow"}),KX=BJ({type:L,displayName:"Transition duration",group:"Nav Bar Shadow"}),jX=BJ({type:L,displayName:"Transition delay",group:"Nav Bar Shadow"}),YX=BJ({type:[UJ]}),XX=BJ({type:x(On)}),JX=Yn.required(),ZX=Yn.onlyRunInLifeCycleAsync,QX=Yn.onlyRunInLifeCycleAsync,eJ=Yn.onlyRunInLifeCycle,tJ=Yn.onlyRunInLifeCycle,nJ=Yn.onlyRunInLifeCycle,iJ=Yn.onlyRunInLifeCycleAsync,aJ=Yn.onlyRunInLifeCycleAsync,oJ=Yn.onlyRunInLifeCycleAsync,zX(rJ=FJ(rJ=UX((sJ=a((lJ=function(a){n(b,a);var s,c,d,h,p,y,v,f,g,m=i(b);function b(){var e;t(this,b);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=m.call.apply(m,[this].concat(i)),r(e,"backgroundMask",sJ,l(e)),r(e,"backgroundMaskTransitionDuration",uJ,l(e)),r(e,"backgroundMaskTransitionDelay",cJ,l(e)),r(e,"navBarShadow",dJ,l(e)),r(e,"navBarShadowTransitionDuration",hJ,l(e)),r(e,"navBarShadowTransitionDelay",pJ,l(e)),r(e,"pageItems",yJ,l(e)),r(e,"currentScreen",vJ,l(e)),r(e,"uiTransform",fJ,l(e)),e}return e(b,[{key:"unmountAndHideAll",value:function(){var e=this;this.pageItems.forEach((function(t){var n=t.page;t.pageType!==e.currentScreen&&(n.unmount(),n.hide())}))}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(P),Yn.validateRequiredProperties(this),D.on($e.VIEW_RESIZED,this.init,this)}},{key:"onDestroy",value:function(){D.off($e.VIEW_RESIZED,this.init,this)}},{key:"init",value:function(){var e=this;this.pageItems.forEach((function(t,n){var i=t.page.getWidget(),a=e.getPageIndex(e.currentScreen);i.right=-(n-a)*e.uiTransform.width,i.left=(n-a)*e.uiTransform.width,i.updateAlignment()}))}},{key:"updateCollectionsContentPayload",value:function(e){var t=this.getPage(On.collections);t&&t instanceof gJ&&t.setPayload(e)}},{key:"navigate",value:(g=o((function*(e,t,n,i){var a=e.from,o=e.to;null!==a?yield this.navigateFromPage(a,o,t,n,i):yield this.navigateFromNull(o,n,i)})),function(e,t,n,i){return g.apply(this,arguments)})},{key:"navigateFromPage",value:(f=o((function*(e,t,n,i,a){var o=this,r=this.validateNavigationRequest(e,t),l=r.toPage,s=r.fromPage;this.currentScreen=t;var u=this.uiTransform.width,c=this.getPageIndex(e),d=this.getPageIndex(t),h=Math.min(c,d),p=Math.max(c,d),y=(p-h)*u,v=c<d?1:-1,f=this.pageItems.slice(h,p+1);f.forEach((function(e,t){var n=e.page;n.show(),n.getWidget().enabled=!1,n.node.position=new V((t+h-c)*u,n.node.position.y,n.node.position.z)}));var g=!l.hasLoadedPage();g&&this.showLoadingScreen();var m=this.pageItems.filter((function(e){return e.pageType!==t})),b=function(){return o.cleanupPages(l,m)};n.addAbortListener(b),yield this.mountPage(l,i),yield n.callAsync((function(){return o.performFullTransition({from:e,to:t,fromPage:s,toPage:l,distance:y,direction:v,items:f})})),n.removeAbortListener(b),n.call(b),yield n.callAsync((function(){return o.transitionInPage(l,a)})),g&&this.hideLoadingScreen()})),function(e,t,n,i,a){return f.apply(this,arguments)})},{key:"hideLoadingScreen",value:function(){lt.closeLoadingScreen()}},{key:"showLoadingScreen",value:function(){lt.showLoadingScreen()}},{key:"cleanupPages",value:function(e,t){var n=e.getWidget();n.enabled=!0,n.left=0,n.right=0,ne.instance.emit("canvas-resize");var i,a=u(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.page.unmount(),o.page.hide()}}catch(e){a.e(e)}finally{a.f()}}},{key:"performFullTransition",value:(v=o((function*(e){var t=e.from,n=e.to,i=e.fromPage,a=e.distance,o=e.direction,r=e.items,l=e.toPage;this.node.scene.emit(Tn,{from:t,to:n}),yield Promise.all([i.transitionOut(),this.transition(a,o,r),this.handleBackgroundMask(this.backgroundMaskTransitionDuration,l.getDarkenBackground()),this.handleNavBarShadow(this.navBarShadowTransitionDuration,l.getNavbarShadow())])})),function(e){return v.apply(this,arguments)})},{key:"mountPage",value:(y=o((function*(e,t){yield e.mount(),yield null==t?void 0:t(e)})),function(e,t){return y.apply(this,arguments)})},{key:"validateNavigationRequest",value:function(e,t){if(e!==this.currentScreen)throw new Error("PageManager: Cannot navigate from a different screen. Perhaps you forgot to update the currentScreen property.");var n=this.getPage(this.currentScreen),i=this.getPage(t);if(!i||!n)throw new Error("PageManager: Cannot navigate to/from a null page. Perhaps you forgot to add the page to the pageItems array in the editor.");return{toPage:i,fromPage:n}}},{key:"navigateFromNull",value:(p=o((function*(e,t,n){var i,a=this.getPage(this.currentScreen);a.show(),this.currentScreen=e,yield this.mountPage(a,t),null!==(i=this.node)&&void 0!==i&&i.scene&&(this.node.scene.emit(Tn,{from:null,to:e}),yield this.transitionInPage(a,n))})),function(e,t,n){return p.apply(this,arguments)})},{key:"transitionInPage",value:(h=o((function*(e,t){yield e.transitionIn(),yield null==t?void 0:t(e)})),function(e,t){return h.apply(this,arguments)})},{key:"getPage",value:function(e){var t,n,i=this.getPageIndex(e);return-1!==i&&null!==(t=null===(n=this.pageItems[i])||void 0===n?void 0:n.page)&&void 0!==t?t:null}},{key:"handleBackgroundMask",value:(d=o((function*(e,t){yield Ve.runTweenAsync(R(this.backgroundMask).delay(this.backgroundMaskTransitionDelay).to(e,{opacity:t}).start())})),function(e,t){return d.apply(this,arguments)})},{key:"handleNavBarShadow",value:(c=o((function*(e,t){yield Ve.runTweenAsync(R(this.navBarShadow).delay(this.navBarShadowTransitionDelay).to(e,{opacity:t}).start())})),function(e,t){return c.apply(this,arguments)})},{key:"getPageIndex",value:function(e){return zJ.searchIndex(this.pageItems,(function(t){return t.pageType===e}))}},{key:"transition",value:(s=o((function*(e,t,n){yield Promise.all(n.map((function(n){var i=n.page;return Ve.runTweenAsync(R(i.node).to(.5,{position:new V(i.node.position.x-e*t,i.node.position.y,i.node.position.z)},{easing:z.quintInOut}))})))})),function(e,t,n){return s.apply(this,arguments)})}]),b}(T)).prototype,"backgroundMask",[GX,HX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uJ=a(lJ.prototype,"backgroundMaskTransitionDuration",[qX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),cJ=a(lJ.prototype,"backgroundMaskTransitionDelay",[VX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),dJ=a(lJ.prototype,"navBarShadow",[$X,WX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hJ=a(lJ.prototype,"navBarShadowTransitionDuration",[KX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),pJ=a(lJ.prototype,"navBarShadowTransitionDelay",[jX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),yJ=a(lJ.prototype,"pageItems",[YX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vJ=a(lJ.prototype,"currentScreen",[XX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return On.home}}),fJ=a(lJ.prototype,"uiTransform",[JX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(lJ.prototype,"navigate",[ZX],Object.getOwnPropertyDescriptor(lJ.prototype,"navigate"),lJ.prototype),a(lJ.prototype,"navigateFromPage",[QX],Object.getOwnPropertyDescriptor(lJ.prototype,"navigateFromPage"),lJ.prototype),a(lJ.prototype,"hideLoadingScreen",[eJ],Object.getOwnPropertyDescriptor(lJ.prototype,"hideLoadingScreen"),lJ.prototype),a(lJ.prototype,"showLoadingScreen",[tJ],Object.getOwnPropertyDescriptor(lJ.prototype,"showLoadingScreen"),lJ.prototype),a(lJ.prototype,"cleanupPages",[nJ],Object.getOwnPropertyDescriptor(lJ.prototype,"cleanupPages"),lJ.prototype),a(lJ.prototype,"performFullTransition",[iJ],Object.getOwnPropertyDescriptor(lJ.prototype,"performFullTransition"),lJ.prototype),a(lJ.prototype,"mountPage",[aJ],Object.getOwnPropertyDescriptor(lJ.prototype,"mountPage"),lJ.prototype),a(lJ.prototype,"navigateFromNull",[oJ],Object.getOwnPropertyDescriptor(lJ.prototype,"navigateFromNull"),lJ.prototype),rJ=lJ))||rJ)||rJ)||rJ);S._RF.pop(),S._RF.push({},"f555belwQ1NHJr4np65OtcU","NavManager",void 0);var HJ,qJ,VJ,$J,WJ,KJ,jJ,YJ,XJ,JJ,ZJ,QJ,eZ,tZ,nZ,iZ,aZ,oZ,rZ,lZ,sZ,uZ,cZ,dZ,hZ,pZ,yZ,vZ,fZ,gZ,mZ,bZ,wZ,SZ,kZ,CZ,EZ,AZ,TZ,PZ,OZ,LZ,IZ=C.ccclass,RZ=C.property,_Z=Ludex.Utils,DZ=_Z.Array,MZ=_Z.Signal,NZ=Ke.Layout,BZ=(mJ=IZ("NavManager"),bJ=RZ(q),wJ=RZ(q),SJ=RZ(Sn),kJ=RZ({type:I,group:"Widgets"}),CJ=RZ({type:I,group:"Widgets"}),EJ=RZ({type:I,group:"Widgets"}),AJ=RZ(P),mJ((OJ=a((PJ=function(a){n(v,a);var s,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"selectorNode",OJ,l(e)),r(e,"selectedButtonNode",LJ,l(e)),r(e,"autoLayout",IJ,l(e)),r(e,"navWidget",RJ,l(e)),r(e,"backgroundWidget",_J,l(e)),r(e,"layoutWidget",DJ,l(e)),r(e,"uiTransform",MJ,l(e)),e.navButtons=[],e.selectorAnimationSignal=new MZ.SignalController,e.isNavigating=!1,e}return e(v,[{key:"currentButton",get:function(){return this.selectedButton}},{key:"onLoad",value:function(){var e;this.navButtons=this.node.getComponentsInChildren("NavButton"),this.selectedButton=null===(e=this.selectedButtonNode)||void 0===e?void 0:e.getComponentInChildren("NavButton"),D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),D.on($e.VIEW_RESIZED,this.handleViewResized,this),this.handleOrientationChanged(Ze.getCurrentLayout())}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),D.off($e.VIEW_RESIZED,this.handleViewResized,this)}},{key:"select",value:(p=o((function*(e){var t=this;if(!this.isNavigating){if(!DZ.has(this.navButtons,e))throw new Error("NavManager: Button not found");if(e!==this.selectedButton){if(!e.isWIP)return this.isNavigating=!0,this.node.scene.emit(An,{from:this.selectedButton.buttonType,to:e.buttonType}),new Promise((function(n){t.node.scene.once(Tn,(function(){var i=t.selectedButton.deselect();t.autoLayout.selectedIndex=t.navButtons.indexOf(e),t.selectedButton=e;var a=t.autoLayout.getSelectedWorldX()-e.getSelectedWorldDistanceX(),o=t.playSelectorAnimation(a),r=e.select();Promise.all([i,r,o]).then((function(){t.isNavigating=!1,n()}))}))}));this.handleWIPButton()}}})),function(e){return p.apply(this,arguments)})},{key:"selectUsingSceneTransition",value:(h=o((function*(e){this.isNavigating||(DZ.has([On.store],e.buttonType)?this.handleWIPButton():yield this.select(e))})),function(e){return h.apply(this,arguments)})},{key:"selectByType",value:(d=o((function*(e){var t=DZ.search(this.navButtons,(function(t){return t.buttonType===e}));if(!t)throw new Error("NavManager: Button not found");yield this.selectUsingSceneTransition(t)})),function(e){return d.apply(this,arguments)})},{key:"handleWIPButton",value:function(){lt.openScreen(st.STAR_CHEST_SCREEN)}},{key:"selectDefaultNavBtn",value:(c=o((function*(){var e=this;if(!this.currentButton||!DZ.has(this.navButtons,this.currentButton))throw new Error("NavManager: Button not found");var t=this.currentButton.buttonType;return this.node.scene.emit(An,{from:null,to:t}),new Promise((function(t){e.node.scene.once(Tn,(function(){e.autoLayout.selectedIndex=e.navButtons.indexOf(e.currentButton);var n=e.navButtons.map((function(t){return t===e.currentButton?t.select(!1):t.deselect(!1,!0)})),i=e.autoLayout.getSelectedWorldX()-e.currentButton.getSelectedWorldDistanceX();e.selectorNode.worldPosition=new V(i,e.selectorNode.worldPosition.y,0),Promise.all(n).then((function(){t()}))}))}))})),function(){return c.apply(this,arguments)})},{key:"playSelectorAnimation",value:(s=o((function*(e){var t=this,n=this.selectorAnimationSignal.renew(),i=new V(1,1,1),a=this.selectorNode.worldPosition.clone(),o=new V(1.2*i.x,.8*i.y,1),r=R(this.selectorNode).to(.3,{worldPosition:new V(e,a.y,0)},{easing:"quintInOut",onUpdate:function(e,n){if(void 0!==n){var a=t.calculateCurrentSquashScale(i,o,n);t.selectorNode.scale=a}}});yield Ve.runTweenAsync(r,n),this.selectorNode.scale=i})),function(e){return s.apply(this,arguments)})},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=u(this.navButtons);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.getComponentInChildren(G);a&&(a.interactable=!t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"calculateCurrentSquashScale",value:function(e,t,n){var i=this.splitIntoSquashRatio(n);return e.clone().lerp(t,i)}},{key:"splitIntoSquashRatio",value:function(e){return e<.5?2*e:1-2*(e-.5)}},{key:"handleOrientationChanged",value:function(e){e===NZ.Portrait?(this.navWidget.isAlignLeft=!0,this.navWidget.isAlignRight=!0,this.backgroundWidget.left=-50,this.backgroundWidget.right=-50,this.layoutWidget.left=0,this.layoutWidget.right=0):e===NZ.Landscape&&(this.navWidget.isAlignLeft=!1,this.navWidget.isAlignRight=!1,this.backgroundWidget.left=0,this.backgroundWidget.right=0,this.layoutWidget.left=25,this.layoutWidget.right=25,this.uiTransform.width=1e3)}},{key:"handleViewResized",value:function(){this.selectedButton&&(this.selectorAnimationSignal.abort(),this.selectorNode.worldPositionX=this.selectedButton.node.worldPosition.x,this.selectorNode.y=-164.5)}}]),v}(T)).prototype,"selectorNode",[bJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LJ=a(PJ.prototype,"selectedButtonNode",[wJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IJ=a(PJ.prototype,"autoLayout",[SJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RJ=a(PJ.prototype,"navWidget",[kJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_J=a(PJ.prototype,"backgroundWidget",[CJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DJ=a(PJ.prototype,"layoutWidget",[EJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MJ=a(PJ.prototype,"uiTransform",[AJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TJ=PJ))||TJ);S._RF.pop(),S._RF.push({},"d48a1TnKg1F4YRzzKmQOD5k","DashboardScene",void 0);var FZ,xZ=C.ccclass,zZ=C.disallowMultiple,UZ=C.property,GZ=codex,HZ=GZ.storage,qZ=GZ.player,VZ=GZ.monitorError,$Z=Ludex,WZ=$Z.Match.Modes,KZ=$Z.Utils.Array;HJ=xZ("DashboardScene"),qJ=Yn.required(),VJ=UZ(PS),$J=Yn.required(),WJ=UZ(BZ),KJ=Yn.required(),jJ=UZ(Gi),YJ=Yn.required(),XJ=UZ(GJ),JJ=Yn.required(),ZJ=UZ(iH),QJ=Yn.required(),eZ=UZ(qr),tZ=Yn.onlyRunInLifeCycle,nZ=Yn.onlyRunInLifeCycle,iZ=Yn.onlyRunInLifeCycle,aZ=Yn.onlyRunInLifeCycle,oZ=Yn.onlyRunInLifeCycle,rZ=Yn.onlyRunInLifeCycle,lZ=Yn.onlyRunInLifeCycle,sZ=Yn.onlyRunInLifeCycleAsync,uZ=Yn.onlyRunInLifeCycleAsync,cZ=Yn.onlyRunInLifeCycleAsync,dZ=Yn.onlyRunInLifeCycleAsync,hZ=Yn.onlyRunInLifeCycle,pZ=Yn.onlyRunInLifeCycleAsync,yZ=Yn.onlyRunInLifeCycleAsync,vZ=Yn.onlyRunInLifeCycleAsync,fZ=Yn.onlyRunInLifeCycleAsync,gZ=Yn.onlyRunInLifeCycleAsync,mZ=Yn.onlyRunInLifeCycleAsync,bZ=Yn.onlyRunInLifeCycle,wZ=Yn.onlyRunInLifeCycleAsync,SZ=Yn.onlyRunInLifeCycle,HJ(kZ=zZ((EZ=a((CZ=function(a){n(A,a);var c,d,h,p,y,v,f,g,m,b,w,S,k,C,E=i(A);function A(){var e;t(this,A);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=E.call.apply(E,[this].concat(i)),r(e,"coinManager",EZ,l(e)),r(e,"navManager",AZ,l(e)),r(e,"bgComp",TZ,l(e)),r(e,"pageManager",PZ,l(e)),r(e,"pageAnimSkipOverlay",OZ,l(e)),r(e,"transitionOpacityToggler",LZ,l(e)),e.firstNavigation=!0,e.isFirstNavToCollections=!0,e.isFirstNavToTournament=!0,e.navigationSignal=null,e}return e(A,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.listenNavigationEvents(),this.listenDashboardEvents(),EB.createLayer(this.node,"Particles",6),this.coinManager.init(),Vy.init(),this.setPlayerLevel(),this.updateBackgroundImageToCurrentTheme(),this.pageManager.updateCollectionsContentPayload(Vy.getCollectionUnlockProgress())}},{key:"listenNavigationEvents",value:function(){this.node.scene.on(An,this.onNavigate,this)}},{key:"listenDashboardEvents",value:function(){this.node.scene.on(Cn,this.handleDashboardPlayButtonPress,this),this.node.scene.on(En,this.handleCustomPlayButtonPress,this),this.node.scene.on(Pn,this.handleEventButtonPress,this)}},{key:"setPlayerLevel",value:function(){var e,t=(null!==(e=qZ.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;n=0===n?1:n,qZ.setGameData({level:n})}},{key:"start",value:function(){qZ.getPlayerSetting("music")&&this.updateMusic(),this.pageManager.init(),this.navManager.selectDefaultNavBtn(),this.scheduleOnce(this.preloadScene,5),this.scheduleOnce(this.preloadSkins,3),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScene",value:function(){ct.isSceneLoaded(yt.GAME_SCENE)||ct.preloadGameScene()}},{key:"preloadScreens",value:function(){var e;lt.preloadScreen(st.LOADING_SCREEN),lt.preloadScreen(st.NOTIFICATION_SCREEN),lt.preloadScreen(st.SETTINGS_SCREEN),lt.preloadScreen(st.GET_COIN_SCREEN),lt.preloadScreen(st.STAR_CHEST_SCREEN),lt.preloadScreen(st.DAILY_REWARDS_SCREEN);var t=qZ.getGameData();(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)>=13&&lt.preloadScreen(st.CUSTOM_GAME_SCREEN)}},{key:"preloadSkins",value:function(){var e,t=Vy.getUnlockedSkins(),n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a="".concat(it.TILE_SKIN_FOLDER,"/").concat(i);qe.loadSpriteFramesDirAsync(a)}}catch(e){n.e(e)}finally{n.f()}}},{key:"attemptCallSubscribeBot",value:function(){GameSDK.isGameSDK("FacebookInstant")&&GameSDK.extra.checkAndSubscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))}},{key:"updateBackgroundImageToCurrentTheme",value:function(){var e,t=HZ.getStorage("dashboard");if(null!=t){var n=null!==(e=t.animateToCurrentLevel)&&void 0!==e&&e,i=s({},t.lastMapPayload),a=Vy.getCurrentMapProgress(),o=i.currentTheme===a.currentTheme&&i.nextTheme===a.nextTheme,r=a.currentTheme;!n||o||this.isDevToolTimeTravel(i.id,a.id)?this.bgComp.setCurrentTheme(r):this.bgComp.setCurrentTheme(i.currentTheme)}else null==VZ||VZ.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"isDevToolTimeTravel",value:function(e,t){return KZ.searchIndex(xy.mapOrder,(function(t){return t.id===e}))>KZ.searchIndex(xy.mapOrder,(function(e){return e.id===t}))}},{key:"handleDashboardPlayButtonPress",value:function(){this.handlePlayButtonPress(WZ.SINGLE)}},{key:"handleCustomPlayButtonPress",value:function(){this.handlePlayButtonPress(lv)}},{key:"handlePlayButtonPress",value:(C=o((function*(e){try{var t;rt.setBlockInput(!0);var n=Vy.getCurrentMapProgress(),i=(null!==(t=qZ.getGameData())&&void 0!==t?t:{}).level,a=void 0===i?1:i;yield iv.setMatchCustomDataAsync({level:a}),yield iv.startMatchAsync(e),this.updateCurrentMapInStorage(n),HZ.setStorageData("collection","lastMapPack",n.id),HZ.setStorageData("collection","animateMapPackUnlock",!1),yield this.switchToGameScene(a)}catch(e){rt.setBlockInput(!1),console.error(e)}})),function(e){return C.apply(this,arguments)})},{key:"switchToGameScene",value:(k=o((function*(e){ct.isSceneLoaded(yt.GAME_SCENE)&&(yield this.transitionOpacityToggler.changeStateFade(!0,.25)),ct.switchToGameScene({level:e})})),function(e){return k.apply(this,arguments)})},{key:"updateCurrentMapInStorage",value:function(e){HZ.setStorageData("dashboard","animateToCurrentLevel",!1),HZ.setStorageData("dashboard","lastMapPayload",e)}},{key:"updateMusic",value:(S=o((function*(){je.getCurrentMusic()!==Qi.BG_MUSIC&&(yield je.setVolumeMusic(0,!0),yield Ve.waitTweenAsync(1)),je.playMusic(Qi.BG_MUSIC),je.turnUpMusic()})),function(){return S.apply(this,arguments)})},{key:"onNavigate",value:(w=o((function*(e){switch(this.firstNavigation&&(this.firstNavigation=!1,this.pageManager.unmountAndHideAll()),e.to){case On.store:break;case On.collections:yield this.triggerPageNavigation(e),yield this.handleLogicAfterNavigateToCollections(),this.cleanupAfterPageNavigation();break;case On.tournaments:lt.preloadScreen(st.TOURNAMENT_DETAIL_SCREEN),yield this.triggerPageNavigation(e),this.cleanupAfterPageNavigation();break;case On.leaderboard:yield this.triggerPageNavigation(e),this.cleanupAfterPageNavigation();break;case On.home:yield this.handleNavigateToHome(e);break;default:throw new Error("DashboardScene: Unhandled page name")}})),function(e){return w.apply(this,arguments)})},{key:"handleLogicAfterNavigateToCollections",value:(b=o((function*(){var e,t=null===(e=this.pageManager.getPage(On.collections))||void 0===e?void 0:e.getContainer().getComponentInChildren(s$);if(null==t)throw new Error("CollectionsContent not found");var n=new Ni,i=t.shouldAnimateThemeBlockUnlock();i&&(yield this.openSkipOverlay(n)),yield this.tryPlayScrollToCollectionAnim(t,n),yield t.playThemeTabUnlockAnim(n),i&&(yield this.closeSkipOverlay()),n.abort()})),function(){return b.apply(this,arguments)})},{key:"closeSkipOverlay",value:(m=o((function*(){yield this.pageAnimSkipOverlay.close()})),function(){return m.apply(this,arguments)})},{key:"openSkipOverlay",value:(g=o((function*(e){yield this.pageAnimSkipOverlay.open({onSkip:function(){return e.abort()},opacity:200})})),function(e){return g.apply(this,arguments)})},{key:"tryPlayScrollToCollectionAnim",value:(f=o((function*(e,t){var n=Vy.getCurrentUnlockingThemeIndex();this.isFirstNavToCollections&&null!==n&&(yield e.scrollToCurrentUnlockingTheme(n,t),this.isFirstNavToCollections=!1)})),function(e,t){return f.apply(this,arguments)})},{key:"cleanupAfterPageNavigation",value:function(){this.navManager.setIgnoreInput(!1)}},{key:"triggerPageNavigation",value:(v=o((function*(e){var t;null===(t=this.navigationSignal)||void 0===t||t.abort(),this.navigationSignal=new Ni,yield this.pageManager.navigate(e,this.navigationSignal)})),function(e){return v.apply(this,arguments)})},{key:"handleNavigateToHome",value:(y=o((function*(e){var t,n=this;null===(t=this.navigationSignal)||void 0===t||t.abort(),this.navigationSignal=new Ni,yield this.pageManager.navigate(e,this.navigationSignal,o((function*(){n.initializeHomepageCoinManager()}))),yield this.handleLogicAfterNavigateToHome()})),function(e){return y.apply(this,arguments)})},{key:"handleLogicAfterNavigateToHome",value:(p=o((function*(){Cq.hasShownPopup()||this.shouldPlayLevelUpAnimation()||(yield Cq.hasClaimableRewards())&&(yield Cq.openPopupScreenAndWaitForClose()),this.attemptCallSubscribeBot(),yield this.waitUntilCoinManagerFinishesAnyAnimation(),yield this.waitUntilPageAnimSkipOverlayCloses(),yield this.tryNavigateToTournament(),yield this.tryPlayLevelUpAnimation(),yield this.tryShowCustomModeGuide()})),function(){return p.apply(this,arguments)})},{key:"waitUntilCoinManagerFinishesAnyAnimation",value:function(){return this.coinManager.untilFinishesCollectAnim()}},{key:"waitUntilPageAnimSkipOverlayCloses",value:function(){return this.pageAnimSkipOverlay.untilClosed()}},{key:"tryNavigateToTournament",value:(h=o((function*(){if(HZ.getStorage("tournament").animateTournamentLeader)return yield this.navManager.selectByType(On.tournaments);if(this.isFirstNavToTournament){this.isFirstNavToTournament=!1;try{if(!("getTournamentAsync"in GameSDK))throw new Error("Unavailable feature: tournament");if((yield GameSDK.getTournamentAsync()).getEndTime()<Date.now()/1e3)return yield this.navManager.selectByType(On.tournaments)}catch(e){}}})),function(){return h.apply(this,arguments)})},{key:"shouldPlayLevelUpAnimation",value:function(){var e;if(!this.enabledInHierarchy)return!1;var t=null===(e=this.pageManager.getPage(On.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(gX);if(null==t)return!1;var n=t.shouldPlayUnlockAnimation(),i=this.shouldPlayPackUnlockAnimation();return n||i}},{key:"tryPlayLevelUpAnimation",value:(d=o((function*(){var e,t=this,n=null===(e=this.pageManager.getPage(On.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(gX);if(null==n)throw new Error("DashboardScene: Homepage not found");var i=new Ni;this.navigationSignal&&i.chain(this.navigationSignal);var a=n.shouldPlayUnlockAnimation(),o=this.shouldPlayPackUnlockAnimation();a&&(o&&(yield this.pageAnimSkipOverlay.open({onSkip:function(){return i.abort()},opacity:150})),yield n.playUnlockProgressAnimation(i),this.updateBackgroundImageToCurrentTheme(),o&&(yield this.pageAnimSkipOverlay.close(),yield i.callAsync((function(){return t.navManager.selectByType(On.collections)}))))})),function(){return d.apply(this,arguments)})},{key:"shouldPlayPackUnlockAnimation",value:function(){var e=HZ.getStorage("dashboard");if(null==e)throw new Error("DashboardScene: dashboardStorage not found");var t=e.lastMapPayload,n=Vy.getCurrentMapProgress();return!(KZ.searchIndex(xy.mapOrder,(function(e){return e.id===t.id}))===KZ.searchIndex(xy.mapOrder,(function(e){return e.id===n.id})))}},{key:"initializeHomepageCoinManager",value:function(){var e,t=null===(e=this.pageManager.getPage(On.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(gX);if(null==t)throw new Error("DashboardScene: Homepage not found");this.coinManager.setTargetContainer(t.getCoinContainer()),this.coinManager.emitCoinAmount()}},{key:"tryShowCustomModeGuide",value:(c=o((function*(){var e,t,n=null!==(e=qZ.getGameData())&&void 0!==e?e:{},i=n.level,a=void 0===i?1:i,o=n.guideItemShowed,r=void 0===o?[]:o;if(13===a&&!KZ.has(r,fI)){r.push(fI),qZ.setGameData({guideItemShowed:r});var l=null===(t=this.pageManager.getPage(On.home))||void 0===t?void 0:t.getContainer().getComponentInChildren(gX);if(null==l)throw new Error("DashboardScene: Homepage not found");yield l.showCustomGuide()}})),function(){return c.apply(this,arguments)})},{key:"handleEventButtonPress",value:function(e){switch(e.type){case OU.STAR_CHEST:lt.openScreen(st.STAR_CHEST_SCREEN);break;case OU.DAILY_REWARDS:Cq.openPopupScreen();break;case OU.BALLOON:lt.showNotificationScreenWithLocalizedKey("error.soon");break;default:throw new Error("DashboardScene: Unhandled event button type")}}},{key:"handleTestLayoutButtonClicked",value:function(){}}]),A}(T)).prototype,"coinManager",[qJ,VJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AZ=a(CZ.prototype,"navManager",[$J,WJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TZ=a(CZ.prototype,"bgComp",[KJ,jJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PZ=a(CZ.prototype,"pageManager",[YJ,XJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OZ=a(CZ.prototype,"pageAnimSkipOverlay",[JJ,ZJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LZ=a(CZ.prototype,"transitionOpacityToggler",[QJ,eZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(CZ.prototype,"preloadScene",[tZ],Object.getOwnPropertyDescriptor(CZ.prototype,"preloadScene"),CZ.prototype),a(CZ.prototype,"preloadScreens",[nZ],Object.getOwnPropertyDescriptor(CZ.prototype,"preloadScreens"),CZ.prototype),a(CZ.prototype,"preloadSkins",[iZ],Object.getOwnPropertyDescriptor(CZ.prototype,"preloadSkins"),CZ.prototype),a(CZ.prototype,"attemptCallSubscribeBot",[aZ],Object.getOwnPropertyDescriptor(CZ.prototype,"attemptCallSubscribeBot"),CZ.prototype),a(CZ.prototype,"updateBackgroundImageToCurrentTheme",[oZ],Object.getOwnPropertyDescriptor(CZ.prototype,"updateBackgroundImageToCurrentTheme"),CZ.prototype),a(CZ.prototype,"handleDashboardPlayButtonPress",[rZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handleDashboardPlayButtonPress"),CZ.prototype),a(CZ.prototype,"handleCustomPlayButtonPress",[lZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handleCustomPlayButtonPress"),CZ.prototype),a(CZ.prototype,"handlePlayButtonPress",[sZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handlePlayButtonPress"),CZ.prototype),a(CZ.prototype,"onNavigate",[uZ],Object.getOwnPropertyDescriptor(CZ.prototype,"onNavigate"),CZ.prototype),a(CZ.prototype,"handleLogicAfterNavigateToCollections",[cZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handleLogicAfterNavigateToCollections"),CZ.prototype),a(CZ.prototype,"tryPlayScrollToCollectionAnim",[dZ],Object.getOwnPropertyDescriptor(CZ.prototype,"tryPlayScrollToCollectionAnim"),CZ.prototype),a(CZ.prototype,"cleanupAfterPageNavigation",[hZ],Object.getOwnPropertyDescriptor(CZ.prototype,"cleanupAfterPageNavigation"),CZ.prototype),a(CZ.prototype,"triggerPageNavigation",[pZ],Object.getOwnPropertyDescriptor(CZ.prototype,"triggerPageNavigation"),CZ.prototype),a(CZ.prototype,"handleNavigateToHome",[yZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handleNavigateToHome"),CZ.prototype),a(CZ.prototype,"waitUntilCoinManagerFinishesAnyAnimation",[vZ],Object.getOwnPropertyDescriptor(CZ.prototype,"waitUntilCoinManagerFinishesAnyAnimation"),CZ.prototype),a(CZ.prototype,"waitUntilPageAnimSkipOverlayCloses",[fZ],Object.getOwnPropertyDescriptor(CZ.prototype,"waitUntilPageAnimSkipOverlayCloses"),CZ.prototype),a(CZ.prototype,"tryNavigateToTournament",[gZ],Object.getOwnPropertyDescriptor(CZ.prototype,"tryNavigateToTournament"),CZ.prototype),a(CZ.prototype,"tryPlayLevelUpAnimation",[mZ],Object.getOwnPropertyDescriptor(CZ.prototype,"tryPlayLevelUpAnimation"),CZ.prototype),a(CZ.prototype,"initializeHomepageCoinManager",[bZ],Object.getOwnPropertyDescriptor(CZ.prototype,"initializeHomepageCoinManager"),CZ.prototype),a(CZ.prototype,"tryShowCustomModeGuide",[wZ],Object.getOwnPropertyDescriptor(CZ.prototype,"tryShowCustomModeGuide"),CZ.prototype),a(CZ.prototype,"handleEventButtonPress",[SZ],Object.getOwnPropertyDescriptor(CZ.prototype,"handleEventButtonPress"),CZ.prototype),kZ=CZ))||kZ);S._RF.pop(),S._RF.push({},"1be4fAboTNK3IFk6IiygYLZ","PageContent",void 0);var jZ,YZ,XZ,JZ,ZZ,QZ,eQ,tQ=C.ccclass,nQ=Ke.Layout;tQ("PageContent")(FZ=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.widget=this.getComponent(I),this.uiTransform=this.getComponent(P)}},{key:"onLoad",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ze.getCurrentLayout())}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(e){e===nQ.Portrait?(this.widget.isAlignLeft=!0,this.widget.isAlignRight=!0):e===nQ.Landscape&&(this.widget.isAlignLeft=!1,this.widget.isAlignRight=!1,this.uiTransform.width=1e3)}}]),r}(T));S._RF.pop(),S._RF.push({},"c68178FyxlCOqbCt/+wktvw","PageHeader",void 0);var iQ,aQ,oQ,rQ,lQ,sQ,uQ,cQ,dQ,hQ,pQ,yQ,vQ=C.ccclass,fQ=C.property,gQ=Ke.Layout;jZ=vQ("PageHeader"),YZ=Yn.required(),XZ=fQ(I),JZ=Yn.onlyRunInLifeCycleAsync,jZ((eQ=a((QZ=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"widget",eQ,l(e)),e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,d),Ze.isLandscape()&&this.loadLeaves()}},{key:"onLoad",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ze.getCurrentLayout())}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:(u=o((function*(e){e===gQ.Portrait?(this.leaves&&(this.leaves.active=!1),this.widget.left=-80,this.widget.right=-80):e===gQ.Landscape&&(this.widget.left=0,this.widget.right=0,yield this.loadLeaves(),this.leaves&&(this.leaves.active=!0))})),function(e){return u.apply(this,arguments)})},{key:"loadLeaves",value:(s=o((function*(){if(!this.leaves){var e=yield qe.loadPrefabAsync(it.PAGE_LEAVES_PREFAB);!this.leaves&&e&&this.enabledInHierarchy&&(this.leaves=ye(e),this.node.addChild(this.leaves))}})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"widget",[YZ,XZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(QZ.prototype,"loadLeaves",[JZ],Object.getOwnPropertyDescriptor(QZ.prototype,"loadLeaves"),QZ.prototype),ZZ=QZ));S._RF.pop(),S._RF.push({},"53f87ljsxFJUKsBbXk8WVkJ","HomePage",void 0);var mQ,bQ,wQ,SQ,kQ,CQ,EQ,AQ,TQ,PQ,OQ,LQ,IQ=C.ccclass,RQ=C.property,_Q=codex,DQ=_Q.player,MQ=_Q.storage,NQ=_Q.monitorError,BQ=Ludex.Utils.Number;iQ=IQ("HomePage"),aQ=Yn.required(),oQ=RQ({type:K,group:"Placeholders"}),rQ=Yn.required(),lQ=Yn.onlyRunInLifeCycleAsync,sQ=Yn.onlyRunInLifeCycle,uQ=Yn.onlyRunInLifeCycleAsync,cQ=Yn.onlyRunInLifeCycleAsync,iQ((pQ=a((hQ=function(a){n(f,a);var u,h,p,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),r(e,"coinLabel",pQ,l(e)),r(e,"panelAnimationController",yQ,l(e)),e}return e(f,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(qs),c(d(f.prototype),"onLoad",this).call(this)}},{key:"onEnable",value:function(){this.node.scene.on(Es.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"onDisable",value:function(){this.node.scene.off(Es.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"updatePlaceholderCoins",value:(y=o((function*(e){this.coinLabel.string=BQ.getShortNumber(e.coins,3)})),function(e){return y.apply(this,arguments)})},{key:"mount",value:(p=o((function*(){yield c(d(f.prototype),"mount",this).call(this),this.onMount()})),function(){return p.apply(this,arguments)})},{key:"onMount",value:function(){var e;if(!this.homeContent&&(this.homeContent=this.container.getComponentInChildren(gX),!this.homeContent))throw new Error("HomePage: homeContent not found");var t=(null!==(e=DQ.getGameData())&&void 0!==e?e:{}).coins,n=void 0===t?0:t;this.updatePlaceholderCoins({coins:n}),this.homeContent.updateStatus(),this.initUnlockProgressData()}},{key:"initUnlockProgressData",value:function(){var e=this.homeContent.shouldPlayUnlockAnimation(),t=s({},Vy.getCurrentMapProgress()),n=MQ.getStorage("dashboard");if(null==n)return null==NQ||NQ.sendException(new Error("DashboardScene: dashboardStorage not found")),void(e||this.homeContent.setUnlockProgress(t));var i=s({},n.lastMapPayload);e?this.homeContent.setUnlockProgress(i):this.homeContent.setUnlockProgress(t)}},{key:"transitionIn",value:(h=o((function*(){this.homeContent.transitionIn(),yield c(d(f.prototype),"transitionIn",this).call(this),yield this.panelAnimationController.showUI()})),function(){return h.apply(this,arguments)})},{key:"transitionOut",value:(u=o((function*(){this.homeContent.transitionOut(),yield c(d(f.prototype),"transitionOut",this).call(this),yield this.panelAnimationController.hideUI()})),function(){return u.apply(this,arguments)})},{key:"hasLoadedPage",value:function(){return!0}}]),f}(RX)).prototype,"coinLabel",[aQ,oQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yQ=a(hQ.prototype,"panelAnimationController",[rQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(hQ.prototype,"mount",[lQ],Object.getOwnPropertyDescriptor(hQ.prototype,"mount"),hQ.prototype),a(hQ.prototype,"onMount",[sQ],Object.getOwnPropertyDescriptor(hQ.prototype,"onMount"),hQ.prototype),a(hQ.prototype,"transitionIn",[uQ],Object.getOwnPropertyDescriptor(hQ.prototype,"transitionIn"),hQ.prototype),a(hQ.prototype,"transitionOut",[cQ],Object.getOwnPropertyDescriptor(hQ.prototype,"transitionOut"),hQ.prototype),dQ=hQ));S._RF.pop(),S._RF.push({},"73dd1GUhlNKPJc27Ls4gr6D","JoinLeaderboardContainer",void 0);var FQ,xQ,zQ,UQ,GQ,HQ,qQ,VQ,$Q,WQ,KQ,jQ,YQ,XQ,JQ,ZQ,QQ,e0,t0,n0,i0=C.ccclass,a0=C.property,o0=(mQ=i0("JoinLeaderboardContainer"),bQ=Yn.required(),wQ=a0(I),SQ=Yn.required(),kQ=a0(P),CQ=Yn.required(),EQ=a0(q),mQ((PQ=a((TQ=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"widget",PQ,l(e)),r(e,"uiTransform",OQ,l(e)),r(e,"joinButton",LQ,l(e)),e}return e(c,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,c)}},{key:"updatePosition",value:function(e){void 0!==e?(this.widget.enabled=!1,this.node.setWorldPosition(this.node.worldPosition.x,e,this.node.worldPosition.z)):(this.widget.enabled=!0,this.widget.updateAlignment())}},{key:"show",value:(s=o((function*(e){if(null==e||!e.aborted){this.joinButton.active=!0;var t=R(this.joinButton).set({scale:V.ZERO}).to(.5,{scale:V.ONE},{easing:"backOut"});yield Ve.runTweenAsync(t,e)}})),function(e){return s.apply(this,arguments)})},{key:"hide",value:function(){this.joinButton.active=!1}}]),c}(T)).prototype,"widget",[bQ,wQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OQ=a(TQ.prototype,"uiTransform",[SQ,kQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LQ=a(TQ.prototype,"joinButton",[CQ,EQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AQ=TQ))||AQ);S._RF.pop(),S._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var r0,l0,s0,u0,c0,d0,h0,p0=C.ccclass,y0=C.property,v0=C.requireComponent,f0=codex.analytics,g0=Ludex,m0=g0.Utils,b0=m0.Array,w0=m0.Valid,S0=g0.Plugins.Analytics,k0=(void 0===S0?{}:S0).Events,C0=(FQ=p0("SwitchButton"),xQ=v0([G,ce]),zQ=y0(W),UQ=y0(q),GQ=y0(q),HQ=y0(W),qQ=y0({visible:function(){return this.useSound},type:ta}),VQ=y0(W),$Q=y0({visible:function(){return this.useDesktopHover},type:de}),WQ=y0({visible:function(){return this.useDesktopHover},type:de}),FQ(KQ=xQ((YQ=a((jQ=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"enable",YQ,l(e)),r(e,"nodeOn",XQ,l(e)),r(e,"nodeOff",JQ,l(e)),r(e,"useSound",ZQ,l(e)),r(e,"soundKey",QQ,l(e)),r(e,"useDesktopHover",e0,l(e)),r(e,"mouseEnterClip",t0,l(e)),r(e,"mouseLeaveClip",n0,l(e)),e.isMouseLeaved=!1,e.onMouseEnter=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved=!1,e.animationComponent.play(e.mouseEnterClip.name))},e.onMouseLeave=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved||(e.isMouseLeaved=!0,e.animationComponent.play(e.mouseLeaveClip.name)))},e}return e(s,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(G),this.animationComponent=this.getComponent(ce),this.validateRequiredComponents()}},{key:"onLoad",value:function(){var e=this.animationComponent.clips.map((function(e){return null==e?void 0:e.name})).filter((function(e){return null!=e&&"string"==typeof e}));this.useDesktopHover&&(b0.has(e,this.mouseEnterClip.name)||this.animationComponent.addClip(this.mouseEnterClip),b0.has(e,this.mouseLeaveClip.name)||this.animationComponent.addClip(this.mouseLeaveClip))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.node.on(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"switch",value:function(){return!!this.node.active&&(k0&&f0.event(k0.BUTTON_CLICK,{button_name:this.node.name,enable:!this.enable}),this.useSound&&w0.isString(this.soundKey)&&je.playSound(Ra[this.soundKey]),this.updateStatus(!this.enable))}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable===e||(this.onMouseLeave(null),this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e),this.enable}}]),s}(T)).prototype,"enable",[zQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),XQ=a(jQ.prototype,"nodeOn",[UQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JQ=a(jQ.prototype,"nodeOff",[GQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZQ=a(jQ.prototype,"useSound",[HQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),QQ=a(jQ.prototype,"soundKey",[qQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),e0=a(jQ.prototype,"useDesktopHover",[VQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),t0=a(jQ.prototype,"mouseEnterClip",[$Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n0=a(jQ.prototype,"mouseLeaveClip",[WQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KQ=jQ))||KQ)||KQ);S._RF.pop(),S._RF.push({},"2871awUXL9J0I+rBEFNHN7o","Tabs",void 0);var E0,A0,T0,P0,O0,L0,I0,R0,_0,D0=C.ccclass,M0=C.property,N0=codex.analytics,B0=Ludex.Plugins.Analytics,F0=(void 0===B0?{}:B0).Events,x0=(r0=D0("Tabs"),l0=M0(C0),s0=M0(C0),r0((d0=a((c0=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"tabDaily",d0,l(e)),r(e,"tabWeekly",h0,l(e)),e}return e(s,[{key:"setInteractableButtons",value:function(e){this.tabDaily.getComponent(G).interactable=e,this.tabWeekly.getComponent(G).interactable=e}},{key:"updateStatus",value:function(e){this.tabDaily.setEnabled(e===Dy),this.tabWeekly.setEnabled(e===My)}},{key:"handleTabDailySelect",value:function(){this.tabDaily.setEnabled(!0),this.tabWeekly.setEnabled(!1),je.playSound(Qi.BUTTON_CLICK),F0&&N0.event(F0.BUTTON_CLICK,{button_name:this.node.name,screen_name:Ye.getCurrentPage()}),this.node.scene.emit(IU.WORLD_TAB_SELECTED)}},{key:"handleTabWeeklySelect",value:function(){this.tabDaily.setEnabled(!1),this.tabWeekly.setEnabled(!0),je.playSound(Qi.BUTTON_CLICK),F0&&N0.event(F0.BUTTON_CLICK,{button_name:this.node.name,screen_name:Ye.getCurrentPage()}),this.node.scene.emit(IU.WEEKLY_TAB_SELECTED)}}]),s}(T)).prototype,"tabDaily",[l0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h0=a(c0.prototype,"tabWeekly",[s0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u0=c0))||u0);S._RF.pop(),S._RF.push({},"91613SO4bxPDq9dH9zxyIef","LeaderboardTimer",void 0);var z0,U0,G0,H0,q0,V0=C.ccclass,$0=C.property,W0=Ludex.Utils.Time,K0=codex.language,j0=(E0=V0("LeaderboardTimer"),A0=$0(P),T0=$0(q),P0=$0(th),E0((I0=a((L0=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"background",I0,l(e)),r(e,"calendar",R0,l(e)),r(e,"timerLocalizer",_0,l(e)),e.alreadyShown=!1,e}return e(c,[{key:"onLoad",value:function(){this.timerOpacity=this.timerLocalizer.node.getComponent(B),this.validateRequiredComponents(),this.backgroundDefaultWidth=this.background.width,this.calendarDefaultPosition=this.calendar.position.clone()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(s=o((function*(e){if(!this.alreadyShown&&!e.aborted){this.alreadyShown=!0;var t=R(this.calendar).to(.3,{scale:V.ONE},{easing:"backOut"}).to(.3,{position:this.calendarDefaultPosition.clone()},{easing:"quadOut"}),n=R(this.background).delay(.3).to(.3,{width:this.backgroundDefaultWidth},{easing:"quadOut"}),i=R(this.timerOpacity).to(.3,{opacity:255});yield Promise.all([Ve.runTweenAsync(t,e),Ve.runTweenAsync(n,e)]),this.calendar.scale=V.ONE,this.calendar.position=this.calendarDefaultPosition.clone(),this.background.width=this.backgroundDefaultWidth,yield Ve.runTweenAsync(i,e),this.timerOpacity.opacity=255}})),function(e){return s.apply(this,arguments)})},{key:"reset",value:function(){this.alreadyShown||(this.calendar.position=this.background.node.position.clone(),this.calendar.scale=V.ZERO,this.background.width=0,this.timerOpacity.opacity=0)}},{key:"setTimeLabel",value:function(e){if(e){var t=new Date,n=0;if("manually"===e)n=0;else if("daily"===e)n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);else if("weekly"===e){var i=t.getUTCDay(),a=0===i?1:8-i;n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+a)}else n="monthly"===e?Date.UTC(t.getUTCFullYear(),t.getUTCMonth()+1):Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);try{var o=W0.getRelativeTime(n/1e3,K0.getCurrentLocale());this.timerLocalizer.key="game.endsIn",this.timerLocalizer.setParams([o])}catch(e){this.timerLocalizer.key="game.endsSoon"}}else this.timerLocalizer.key="status.loading"}}]),c}(T)).prototype,"background",[A0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R0=a(L0.prototype,"calendar",[T0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_0=a(L0.prototype,"timerLocalizer",[P0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O0=L0))||O0);S._RF.pop(),S._RF.push({},"69c90PvoTtGfZyDw8FbbOvV","LeaderSkeleton",void 0);var Y0,X0,J0,Z0,Q0,e1,t1,n1,i1,a1,o1,r1,l1,s1,u1,c1,d1,h1,p1,y1,v1,f1,g1,m1,b1,w1,S1,k1,C1,E1,A1,T1,P1,O1,L1,I1,R1,_1,D1,M1,N1,B1,F1,x1,z1=C.ccclass,U1=C.disallowMultiple,G1=C.property,H1=(z0=z1("LeaderSkeleton"),U0=G1(q),z0(G0=U1((q0=a((H0=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"container",q0,l(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"hide",value:(u=o((function*(e){var t=this;yield Ve.runTweenAsync(R(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(s=o((function*(e,t){var n=this;this.node.active=!0,this.uiOpacity.opacity=0;var i=this.container.position.clone();this.container.position=new V(i.x,i.y-100,i.z);var a=R(this.container).delay(e);a.to(.2,{position:i},{easing:"cubicOut"});var o=R(this.uiOpacity).delay(e);o.to(.2,{opacity:255},{easing:"cubicOut"});var r=function(){n.container.position=i,n.uiOpacity.opacity=255};t.addAbortListener(r),yield Promise.all([Ve.runTweenAsync(a,t),Ve.runTweenAsync(o,t)]),t.removeAbortListener(r)})),function(e,t){return s.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),d}(T)).prototype,"container",[U0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G0=H0))||G0)||G0);S._RF.pop(),S._RF.push({},"53da1+ne4RJ4p0kTjp52K/1","Leader",void 0);var q1,V1,$1,W1,K1,j1,Y1,X1,J1,Z1,Q1,e2,t2,n2=C.ccclass,i2=C.property,a2=Ludex.Utils,o2=a2.Number,r2=a2.Signal,l2=(Y0=n2("Leader"),X0=i2(K),J0=i2(B),Z0=i2({type:q,group:"Container"}),Q0=i2({type:F,group:"Background"}),e1=i2({type:ue,group:"Background"}),t1=i2({type:F,group:"Rank"}),n1=i2({type:K,group:"Rank"}),i1=i2({type:ue,group:"Rank"}),a1=i2({type:ue,group:"Rank"}),o1=i2({type:ue,group:"Rank"}),r1=i2({type:ue,group:"Rank"}),l1=i2({type:F,group:"Avatar"}),s1=i2({type:B,group:"Avatar"}),u1=i2({type:F,group:"Score"}),c1=i2({type:K,group:"Score"}),d1=i2({type:ue,group:"Score"}),h1=i2({type:B,group:"Score"}),p1=i2({type:B}),y1=i2({type:P}),v1=Yn.onlyRunInLifeCycle,f1=Yn.onlyRunInLifeCycleAsync,g1=Yn.onlyRunInLifeCycle,Y0((w1=a((b1=function(a){n(y,a);var s,u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"nameLabel",w1,l(e)),r(e,"nameOpacity",S1,l(e)),r(e,"container",k1,l(e)),r(e,"background",C1,l(e)),r(e,"highlightBackground",E1,l(e)),r(e,"rankSprite",A1,l(e)),r(e,"rankLabel",T1,l(e)),r(e,"goldRank",P1,l(e)),r(e,"silverRank",O1,l(e)),r(e,"bronzeRank",L1,l(e)),r(e,"highlightRank",I1,l(e)),r(e,"avatar",R1,l(e)),r(e,"avatarOpacity",_1,l(e)),r(e,"scoreBackground",D1,l(e)),r(e,"scoreLabel",M1,l(e)),r(e,"highlightScoreBackground",N1,l(e)),r(e,"scoreOpacity",B1,l(e)),r(e,"uiOpacity",F1,l(e)),r(e,"uiTransform",x1,l(e)),e.signalController=new r2.SignalController,e}return e(y,[{key:"onLoad",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultRank=this.rankSprite.spriteFrame,this.defaultScoreBackground=this.scoreBackground.spriteFrame,this.defaultAvatar=this.avatar.spriteFrame,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e,t){this.updateBackground(e),this.updateRank(e,t),this.updatePhoto(e),this.updateUsername(e),this.updateScore(e)}},{key:"updateBackground",value:function(e){this.background.spriteFrame=e.isHighlight?this.highlightBackground:this.defaultBackground}},{key:"updateRank",value:function(e,t){var n=e.rank;this.rankLabel.string=t&&n>t?"".concat(t,"+"):n.toString(),this.rankSprite.spriteFrame=this.defaultRank;var i=new X(NU);switch(e.isHighlight&&(this.rankSprite.spriteFrame=this.highlightRank,i=new X(FU)),n){case 1:this.rankSprite.spriteFrame=this.goldRank,i=new X(RU);break;case 2:this.rankSprite.spriteFrame=this.silverRank,i=new X(_U);break;case 3:this.rankSprite.spriteFrame=this.bronzeRank,i=new X(DU)}this.rankLabel.shadowColor=i,this.rankLabel.outlineColor=i}},{key:"updatePhoto",value:(h=o((function*(e){var t=this.signalController.renew();if(this.avatar){var n=e.playerId,i=e.photo;if(pN.isAvatarCached(e.playerId,70)){var a=yield pN.getPlayerAvatar(i,n,70,t);if(!a||t.aborted)return;this.setPhoto(a)}else if(this.avatar.spriteFrame=this.defaultAvatar,yield Ve.waitTweenAsync(.1,t),!t.aborted){var o=yield pN.getPlayerAvatar(i,n,70,t);o&&!t.aborted&&this.setPhoto(o)}}})),function(e){return h.apply(this,arguments)})},{key:"setPhoto",value:function(e){this.node.active&&(e.packable=!0,this.avatar.spriteFrame=e)}},{key:"updateUsername",value:function(e){this.nameLabel.string=e.name,this.nameLabel.color=new X(e.isHighlight?BU:MU)}},{key:"updateScore",value:function(e){var t=Math.floor(e.score);this.scoreLabel.string=o2.getShortNumber(t,7);var n=this.scoreLabel.getComponent(K);n.outlineColor=new X(e.isHighlight?FU:NU),n.shadowColor=new X(e.isHighlight?FU:NU),this.scoreBackground.spriteFrame=e.isHighlight?this.highlightScoreBackground:this.defaultScoreBackground}},{key:"runShowUpAnimation",value:(d=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3;this.setVisible(!1);var a=this.container.position.clone();this.container.position=new V(a.x,a.y-100,a.z);var o=R(this.container).delay(t);o.to(i,{position:a},{easing:"backOut"});var r=R(this.uiOpacity).delay(t);r.to(i,{opacity:255},{easing:"cubicOut",onUpdate:function(){n.nameOpacity.opacity=n.uiOpacity.opacity,n.scoreOpacity.opacity=n.uiOpacity.opacity,n.avatarOpacity.opacity=n.uiOpacity.opacity}});var l=function(){n.enabledInHierarchy&&(n.container.position=a,n.uiOpacity.opacity=255,n.avatar.node.active=!0)};e.addAbortListener(l),yield Promise.all([Ve.runTweenAsync(o,e),Ve.runTweenAsync(r,e)]),e.removeAbortListener(l)})),function(e,t){return d.apply(this,arguments)})},{key:"runWorldPositionAnimation",value:(c=o((function*(e,t,n){var i=R(this.node).to(t,{worldPosition:e},{easing:"quadOut"});yield Ve.runTweenAsync(i,n)})),function(e,t,n){return c.apply(this,arguments)})},{key:"runScaleAnimation",value:(u=o((function*(e,t,n){var i=R(this.node).to(t,{scale:new V(e,e,e)},{easing:"backOut"});yield Ve.runTweenAsync(i,n)})),function(e,t,n){return u.apply(this,arguments)})},{key:"runUpdateDataAnimation",value:(s=o((function*(e,t,n,i,a,o){var r=this;yield Ve.runOnUpdateAsync(this.node,a,(function(a){var o=Math.floor(e+(t-e)*a),l=Math.floor(n+(i-n)*a);r.updateRank({rank:o,isHighlight:!0}),r.updateScore({score:l,isHighlight:!0})}),o)})),function(e,t,n,i,a,o){return s.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.nameOpacity.opacity=t,this.scoreOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),y}(T)).prototype,"nameLabel",[X0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S1=a(b1.prototype,"nameOpacity",[J0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k1=a(b1.prototype,"container",[Z0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C1=a(b1.prototype,"background",[Q0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E1=a(b1.prototype,"highlightBackground",[e1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A1=a(b1.prototype,"rankSprite",[t1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T1=a(b1.prototype,"rankLabel",[n1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P1=a(b1.prototype,"goldRank",[i1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O1=a(b1.prototype,"silverRank",[a1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=a(b1.prototype,"bronzeRank",[o1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I1=a(b1.prototype,"highlightRank",[r1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R1=a(b1.prototype,"avatar",[l1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_1=a(b1.prototype,"avatarOpacity",[s1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D1=a(b1.prototype,"scoreBackground",[u1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M1=a(b1.prototype,"scoreLabel",[c1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N1=a(b1.prototype,"highlightScoreBackground",[d1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B1=a(b1.prototype,"scoreOpacity",[h1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F1=a(b1.prototype,"uiOpacity",[p1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x1=a(b1.prototype,"uiTransform",[y1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(b1.prototype,"updateInfo",[v1],Object.getOwnPropertyDescriptor(b1.prototype,"updateInfo"),b1.prototype),a(b1.prototype,"updatePhoto",[f1],Object.getOwnPropertyDescriptor(b1.prototype,"updatePhoto"),b1.prototype),a(b1.prototype,"setPhoto",[g1],Object.getOwnPropertyDescriptor(b1.prototype,"setPhoto"),b1.prototype),m1=b1))||m1);S._RF.pop(),S._RF.push({},"173acdyc/VOnLkPsoSfdfnr","Leaders",void 0);var s2=C.ccclass,u2=C.property,c2=codex.player,d2=Ludex.Utils.Array,h2=(q1=s2("Leaders"),V1=u2(KH),$1=u2(l2),W1=u2(O),K1=Yn.onlyRunInLifeCycleAsync,j1=Yn.onlyRunInLifeCycleAsync,Y1=Yn.onlyRunInLifeCycleAsync,X1=Yn.onlyRunInLifeCycleAsync,q1((Q1=a((Z1=function(a){n(g,a);var c,d,h,p,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),r(e,"scrollView",Q1,l(e)),r(e,"tempLeader",e2,l(e)),r(e,"maxLeader",t2,l(e)),e.leaderData=[],e.displayLeaderData=[],e.displayPlayerLeader=null,e.isHidden=!0,e}return e(g,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(P),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"__preload",value:function(){this.currentPlayerId=c2.getPlayerId()}},{key:"updateData",value:(v=o((function*(e){this.isHidden=!1,this.leaderData=e,this.leaderData.forEach((function(e,t){e.rank=t+1})),this.setupDisplayLeadersData()})),function(e){return v.apply(this,arguments)})},{key:"initScrollViews",value:function(){var e=this;this.scrollView.setMaxNodeCount(this.leaderData.length),this.scrollView.init((function(t){var n=t.getComponent(l2),i=e.displayLeaderData[t.order];if(i){var a=i.playerId,o=i.photo,r=i.name,l=i.score;n.setVisible(!0),n.updateInfo({playerId:a,isHighlight:e.currentPlayerId===a,name:r,photo:o,rank:t.order+1,score:l},e.maxLeader)}}))}},{key:"playRankChangeAnimation",value:(y=o((function*(e,t,n,i){if(!(t>=n)){var a=this.displayLeaderData,o=d2.search(a,(function(e){return e.playerId===c2.getPlayerId()}));if(o){var r=o.rank;if(a[i-1]){var l=this.scrollView.getNodeByOrder(o.rank-1);if(l){var s=null==l?void 0:l.getComponent(l2);if(s){s.setVisible(!1),this.tempLeader.setVisible(!0),this.tempLeader.updatePhoto({playerId:c2.getPlayerId(),photo:o.photo}),this.tempLeader.node.worldPosition=l.node.worldPosition.clone(),yield this.tempLeader.runScaleAnimation(1.1,.5,e);var u=Math.min(.5*(r-i),2),c=[this.tempLeader.runUpdateDataAnimation(r,i,t,n,u,e),this.scrollToLeaderRank(i,u,e)],d=this.scrollView.scrollView.getMaxScrollOffset().y,h=this.scrollView.getNodeScrollOffset(i-1),p=V.ZERO;if(h<0)p=new V(this.tempLeader.node.worldPosition.x,this.node.worldPosition.y+this.scrollView.getNodePosition(i-1).y+this.uiTransform.height/2,this.tempLeader.node.worldPosition.z);else if(this.scrollView.scrollView.getScrollOffset().y>=d-5)if(h<d)p=new V(this.tempLeader.node.worldPosition.x,this.scrollView.viewport.node.worldPosition.y,this.tempLeader.node.worldPosition.z);else{var y,v=this.scrollView.getNodeByOrder(i-1);p=null!==(y=null==v?void 0:v.node.worldPosition.clone())&&void 0!==y?y:V.ZERO}p.equals(V.ZERO)||c.push(this.tempLeader.runWorldPositionAnimation(p,u,e)),yield Promise.all(c),yield Promise.all([this.tempLeader.runScaleAnimation(1,.25,e),this.playPostRankChangeAnimation(i,r,e)]),this.tempLeader.setVisible(!1),l.node.worldPosition=this.tempLeader.node.worldPosition.clone(),this.setupDisplayLeadersData(),this.scrollView.updateNodeVisibility(),this.scrollView.updateLayout()}}}}}})),function(e,t,n,i){return y.apply(this,arguments)})},{key:"playShowLeadersAnimation",value:(p=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(!this.isHidden){var i=[],a=this.scrollView.getAllNodes();if(a.sort((function(e,t){return e.order-t.order})).forEach((function(e,n){var a=e.getComponent(l2);a.setVisible(n<t.leaderData.length),e.isVisible()&&i.push(a)})),!(i.length<1)){i=i.slice(0,a.length-1);var r=.3;yield Promise.all(i.map(function(){var i=o((function*(i,a){t.isHidden||(yield i.runShowUpAnimation(e,a*n,r))}));return function(e,t){return i.apply(this,arguments)}}()))}}})),function(e){return p.apply(this,arguments)})},{key:"scrollToPlayerLeader",value:(h=o((function*(e,t){this.displayPlayerLeader&&(yield this.scrollToLeaderRank(this.displayPlayerLeader.rank,e,t))})),function(e,t){return h.apply(this,arguments)})},{key:"updateDisplayPlayerLeaderForRankChanging",value:function(e,t,n){if(!this.displayPlayerLeader)return!1;this.displayPlayerLeader.score=e,this.displayLeaderData.sort((function(e,t){return t.score-e.score}));var i=this.displayLeaderData.indexOf(this.displayPlayerLeader)+1;return n===i?(this.displayPlayerLeader.score=t,this.displayPlayerLeader.rank=n,!1):(this.displayPlayerLeader.rank=i,this.tempLeader.updateInfo({playerId:c2.getPlayerId(),isHighlight:!0,name:this.displayPlayerLeader.name,photo:this.displayPlayerLeader.photo,rank:this.displayPlayerLeader.rank,score:e}),!0)}},{key:"hideLeaders",value:function(){this.isHidden=!0;var e,t=this.scrollView.getAllNodes().map((function(e){return e.getComponent(l2)})),n=u(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;null==i||i.setVisible(!1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"getLeaderData",value:function(){return this.leaderData}},{key:"setupDisplayLeadersData",value:function(){var e=this,t=d2.search(this.leaderData,(function(t){return t.playerId===e.currentPlayerId}));t?(this.displayLeaderData=this.leaderData.filter((function(t){return t.playerId!==e.currentPlayerId})),this.displayPlayerLeader=s({},t),this.displayLeaderData.splice(t.rank-1,0,this.displayPlayerLeader)):(this.displayPlayerLeader=null,this.displayLeaderData=this.leaderData)}},{key:"playPostRankChangeAnimation",value:(d=o((function*(e,t,n){var i=null!=e?e:0,a=this.scrollView.getVisibleNodes().filter((function(e){return e.order>=i-1&&e.order<t})),o=a.map((function(e){return e.getComponent(l2)})),r=this.scrollView.nodeHeight+this.scrollView.spacing,l=[];o.forEach((function(e,t){var i=a[t];if(i){e.updateRank({rank:i.order+2,isHighlight:!1});var o=e.node.worldPosition.clone();l.push(e.runWorldPositionAnimation(o.add3f(0,-r,0),.25,n))}})),yield Promise.all(l)})),function(e,t,n){return d.apply(this,arguments)})},{key:"scrollToLeaderRank",value:(c=o((function*(e,t,n){yield this.scrollView.scrollToOrder(e-1,n,t)})),function(e,t,n){return c.apply(this,arguments)})}]),g}(T)).prototype,"scrollView",[V1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e2=a(Z1.prototype,"tempLeader",[$1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t2=a(Z1.prototype,"maxLeader",[W1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Z1.prototype,"updateData",[K1],Object.getOwnPropertyDescriptor(Z1.prototype,"updateData"),Z1.prototype),a(Z1.prototype,"playRankChangeAnimation",[j1],Object.getOwnPropertyDescriptor(Z1.prototype,"playRankChangeAnimation"),Z1.prototype),a(Z1.prototype,"scrollToPlayerLeader",[Y1],Object.getOwnPropertyDescriptor(Z1.prototype,"scrollToPlayerLeader"),Z1.prototype),a(Z1.prototype,"scrollToLeaderRank",[X1],Object.getOwnPropertyDescriptor(Z1.prototype,"scrollToLeaderRank"),Z1.prototype),J1=Z1))||J1);S._RF.pop(),S._RF.push({},"9f98ebQ6z1GMZv6FqGBHkpb","LeaderboardContentOverlay",void 0);var p2,y2=Ludex.Utils,v2=y2.Time,f2=y2.Object,g2=function(){function n(e){var i=this;t(this,n),this.isPageMounted=!1,this.createMainDiv$=function(){i.mainDiv$=document.createElement("div");var e=jM.getGameScaleFactor();f2.assign(i.mainDiv$.style,{position:"absolute",transform:"translateX(-50%)",left:"50%",top:"".concat(295*e,"px"),scrollbarWidth:"none",alignItems:"start",overflow:"auto",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.1s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.mainDiv$)},this.isPayloadChanged$=function(e){if(!i.currentPayload$)return!0;if(i.currentPayload$.leaderboardPlayers.length!==e.leaderboardPlayers.length)return!0;for(var t=0;t<e.leaderboardPlayers.length;t++){var n=i.currentPayload$.leaderboardPlayers[t],a=e.leaderboardPlayers[t];if(!n||!a)return!0;if(n.playerId!==a.playerId||n.rank!==a.rank||n.score!==a.score)return!0}return!1},this.showOverlay$=o((function*(){i.overlayElement$&&(yield i.overlayElement$.showAsync(),i.revealMainDiv$())})),this.revealMainDiv$=function(){i.overlayElement$&&i.isPageMounted&&(i.scene.emit(IU.OVERLAY_SHOW_COMPLETED),i.mainDiv$.style.display="block",i.mainDiv$.scrollTop=0,requestAnimationFrame((function(){i.isPageMounted?f2.assign(i.mainDiv$.style,{opacity:"1",pointerEvents:"auto"}):i.mainDiv$.style.display="none"})))},this.validateOverlayPayload$=function(e){var t,n=s(s({},e),{},{leaderboardPlayers:[]}),i=/^\d+$/,a=u(e.leaderboardPlayers);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.test(o.playerId)&&n.leaderboardPlayers.push(o)}}catch(e){a.e(e)}finally{a.f()}return n},this.getIframeCss$=function(e){var t="100cqw",n=e.leaderboardPosition,a=e.leaderboardPlayers.length;n&&(t="".concat(i.getElementDivWidth$(n),"px"));var o="height: calc((".concat(t," * (121 / 1000) + 4px) * ").concat(a,");");return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat(o,"   ")},this.updateMainDivPosition$=function(e){if(i.mainDiv$){var t="".concat(i.getElementDivWidth$(e),"px"),n="".concat(i.getElementDivHeight$(),"px"),a="".concat(i.getElementDivTopOffset$(),"px");f2.assign(i.mainDiv$.style,{width:t,height:"calc(100vh - ".concat(n,")"),top:a})}},this.getElementDivWidth$=function(e){return e.width*jM.getGameScaleFactor()},this.getElementDivHeight$=function(){return jM.getGameScaleFactor()*(450+Xe.getBannerAdHeight())},this.getElementDivTopOffset$=function(){return 295*jM.getGameScaleFactor()},this.scene=e,this.createMainDiv$()}var i,a,r,l;return e(n,[{key:"updateOverlay",value:(l=o((function*(e){try{if(!this.isPageMounted)return!1;this.scene.emit(IU.OVERLAY_SHOW_STARTED);var t=this.validateOverlayPayload$(e);if(t.leaderboardPosition&&this.moveMainDiv(t.leaderboardPosition),!this.isPayloadChanged$(t))return this.revealMainDiv$(),!0;this.overlayElement$?yield this.overlayElement$.updateAsync(t):this.overlayElement$=yield jM.createOverlayViewAsync("overlays/leaderboard/leaderboard-overlay.xml",this.mainDiv$,this.getIframeCss$(e),"overlays/leaderboard/leaderboard-overlay-styles.css",t),this.currentPayload$=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return l.apply(this,arguments)})},{key:"hideOverlay",value:(r=o((function*(){if(this.overlayElement$){f2.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none"});try{yield v2.sleepAsync(100),this.mainDiv$.style.display="none"}catch(e){console.error("Hide overlay failed:",e)}}})),function(){return r.apply(this,arguments)})},{key:"handleHideUICall",value:(a=o((function*(){f2.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"})})),function(){return a.apply(this,arguments)})},{key:"handleShowUICall",value:(i=o((function*(){f2.assign(this.mainDiv$.style,{opacity:"1",pointerEvents:"auto",display:"block"})})),function(){return i.apply(this,arguments)})},{key:"setIsPageMounted",value:function(e){this.isPageMounted=e}},{key:"moveMainDiv",value:function(e){this.updateMainDivPosition$(e)}}]),n}();S._RF.pop(),S._RF.push({},"332aaP3dkhKxZNHiMFB1bKn","LeaderboardIsEmpty",void 0);var m2,b2,w2,S2,k2,C2,E2,A2,T2,P2,O2,L2,I2,R2,_2,D2,M2,N2,B2,F2,x2,z2,U2,G2,H2,q2,V2,$2,W2,K2,j2,Y2,X2,J2=(0,C.ccclass)("LeaderboardIsEmpty")(p2=function(a){n(s,a);var r,l=i(s);function s(){return t(this,s),l.apply(this,arguments)}return e(s,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(r=o((function*(){this.uiOpacity.opacity=255;var e=this.node.position.clone(),t=R(this.node);t.to(.05,{position:e.clone().add3f(5,0,0)}),t.to(.05,{position:e.clone().add3f(-5,0,0)});var n=R(this.node).repeat(2,t);n.to(.05,{position:e}),yield Ve.runTweenAsync(n)})),function(){return r.apply(this,arguments)})},{key:"hide",value:function(){this.uiOpacity.opacity=0}}]),s}(T))||p2;S._RF.pop(),S._RF.push({},"2aa67vEWR9HaJkCtpsuUyRX","LeaderboardContent",void 0);var Z2,Q2,e5,t5,n5,i5,a5,o5,r5=C.ccclass,l5=C.property,s5=codex,u5=s5.storage,c5=s5.leaderboard,d5=s5.player,h5=s5.monitorError,p5=Ludex,y5=p5.Utils.Object,v5=p5.Configs.Leaderboards,f5=function(a){n(r,a);var o=i(r);function r(e){var n;return t(this,r),(n=o.call(this,e)).name="EmptyLeaderboardError",n}return e(r)}(p(Error)),g5=(m2=r5("LeaderboardContent"),b2=Yn.required(),w2=l5(x0),S2=Yn.required(),k2=l5(j0),C2=Yn.required(),E2=l5({type:h2,group:"Leaderboard"}),A2=l5({type:[H1],group:"Leaderboard"}),T2=Yn.required(),P2=l5({type:J2,group:"Leaderboard"}),O2=Yn.required(),L2=l5(qr),I2=Yn.required(),R2=l5(o0),_2=Yn.required(),D2=l5(q),M2=Yn.onlyRunInLifeCycleAsync,N2=Yn.onlyRunInLifeCycleAsync,B2=Yn.onlyRunInLifeCycleAsync,F2=Yn.onlyRunInLifeCycleAsync,x2=Yn.onlyRunInLifeCycleAsync,z2=Yn.onlyRunInLifeCycleAsync,U2=Yn.onlyRunInLifeCycle,m2((q2=a((H2=function(a){n(f,a);var s,u,c,d,h,p,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),r(e,"tabs",q2,l(e)),r(e,"timer",V2,l(e)),r(e,"leaders",$2,l(e)),r(e,"leaderSkeletons",W2,l(e)),r(e,"leaderboardIsEmpty",K2,l(e)),r(e,"contentOpacity",j2,l(e)),r(e,"joinLeaderboardContainer",Y2,l(e)),r(e,"loadingNode",X2,l(e)),e.isHidden=!0,e.isOverlayMode=!1,e.currentLb=null,e.currentTab=Dy,e.animAbortSignal=new Ni,e.hasPlayedAppearAnim={friends:!1,global:!1,global_weekly:!1},e.dailyFBOverlay=null,e.weeklyFBOverlay=null,e.unlistenEvents$=function(){D.off($e.VIEW_RESIZED,e.handleViewResized$),e.node.scene.off(IU.WEEKLY_TAB_SELECTED,e.handleWeeklyTabSelected$),e.node.scene.off(IU.WORLD_TAB_SELECTED,e.handleDailyTabSelected$),e.node.scene.off(IU.OVERLAY_SHOW_STARTED,e.enableOverlayLoadingNode$),e.node.scene.off(IU.OVERLAY_SHOW_COMPLETED,e.disableOverlayLoadingNode$),e.unlistenUIEvents()},e.getLeaderboardName$=function(e){var t=e===My?_y.WEEKLY:_y.DAILY;return c5.getLeaderboardName(t)},e.cleanupSideEffects$=function(){e.animAbortSignal.abort(),e.animAbortSignal=new Ni,e.leaders.hideLeaders(),e.leaderboardIsEmpty.hide(),e.joinLeaderboardContainer.hide()},e.initializeStatusUpdate$=function(t){e.tabs.updateStatus(t),e.timer.setTimeLabel()},e.loadLeaderboardData$=function(){var t=o((function*(t,n){yield e.showLoading(t,n),yield e.loadLeaderboard(t,n),e.hideLoading(t,n)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleSuccessfulLoad$=function(){var t=o((function*(t,n){e.isOverlayMode?yield e.handleOverlayMode$(t,n):yield e.handleRegularMode$(t,n),yield e.handleGuestUserFlow$(t)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleOverlayMode$=function(){var t=o((function*(t,n){t.call((function(){var i;null===(i=e.timer)||void 0===i||i.show(t),e.handleUpdateOverlayAfterSignal$(t,n)}))}));return function(e,n){return t.apply(this,arguments)}}(),e.handleUpdateOverlayAfterSignal$=function(){var t=o((function*(t,n){if(!(yield e.updateOverlay$(n)))return e.isOverlayMode=!1,e.disableOverlayLoadingNode$(),void e.handleRegularMode$(t,n);e.setupTimerWithLeaderboard$(t)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleRegularMode$=function(){var t=o((function*(t,n){t.call((function(){e.setupTimerWithLeaderboard$(t)})),yield t.callAsync((function(t){return e.playLeadersShowupAnimation(n,t)}))}));return function(e,n){return t.apply(this,arguments)}}(),e.setupTimerWithLeaderboard$=function(t){var n,i,a;null===(n=e.timer)||void 0===n||n.setTimeLabel(null===(i=e.currentLb)||void 0===i?void 0:i.resettable),null===(a=e.timer)||void 0===a||a.show(t)},e.handleGuestUserFlow$=function(){var t=o((function*(t){var n;GameSDK.extra.isGuest&&(e.updateJoinLeaderboardButton(),yield null===(n=e.joinLeaderboardContainer)||void 0===n?void 0:n.show(t))}));return function(e){return t.apply(this,arguments)}}(),e.handleLoadError$=function(t,n,i){if(!(i instanceof f5))throw i;t.call((function(){e.handleEmptyLeaderboard$(t,n)}))},e.handleEmptyLeaderboard$=function(t,n){e.leaderboardIsEmpty.show(),e.leaders.scrollView.setMaxNodeCount(0),e.hideLoading(t,n),e.setupTimerWithLeaderboard$(t)},e.updateOverlay$=function(){var t=o((function*(t){if(!e.currentLb)return!1;var n=y5.vals(e.currentLb.leaders);n.sort((function(e,t){return t.score-e.score}));var i=n.map((function(e){var t=e.rank>50?"50+":"".concat(e.rank);return{playerId:e.playerId,rank:t,score:e.score}})),a=e.getCorrectOverlay$(t);if(!a)return!1;var o=yield null==a?void 0:a.updateOverlay({leaderboardPlayers:i,leaderboardPosition:e.getLeaderboardSize$(),currentPlayerId:d5.getPlayerId()});return null!=o&&o}));return function(e){return t.apply(this,arguments)}}(),e.handleViewResized$=function(){e.updateJoinLeaderboardButton()},e.handleWeeklyTabSelected$=o((function*(){u5.setStorageData("leaderboard_content","lastTabOpened",My),e.cleanupSideEffects$(),e.currentTab=My;var t=e.animAbortSignal;try{yield e.updateStatus(t,My)}catch(e){t.call((function(){var t=e instanceof Error?e:new Error("Unknown error during loading global weekly leaderboard.");console.error("LeaderboardContent",t),null==h5||h5.sendException(t),lt.showNotificationScreenWithLocalizedKey("error.noFriendsLb",2)}))}})),e.handleDailyTabSelected$=o((function*(){u5.setStorageData("leaderboard_content","lastTabOpened",Dy),e.cleanupSideEffects$(),e.currentTab=Dy;var t=e.animAbortSignal;try{yield e.updateStatus(t,Dy)}catch(e){t.call((function(){var t=e instanceof Error?e:new Error("Unknown error during loading global leaderboard.");console.error("LeaderboardContent",t),null==h5||h5.sendException(t),lt.showNotificationScreenWithLocalizedKey("error.noWorldLb",2)}))}})),e.hideContent$=function(){var t,n;e.contentOpacity.changeStateFade(!1,.1),e.updateOverlayMountStatus(!1),null===(t=e.dailyFBOverlay)||void 0===t||t.handleHideUICall(),null===(n=e.weeklyFBOverlay)||void 0===n||n.handleHideUICall()},e.showContent$=function(){e.contentOpacity.changeStateFade(!0,.1),e.updateOverlayMountStatus(!0),e.handleOverlayShowUICall$()},e.handleOverlayShowUICall$=function(){var t,n;e.isOverlayMode&&(e.currentTab===My?null===(t=e.weeklyFBOverlay)||void 0===t||t.handleShowUICall():null===(n=e.dailyFBOverlay)||void 0===n||n.handleShowUICall())},e.createFBOverlay$=function(){try{jM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.dailyFBOverlay=new g2(e.node.scene),e.weeklyFBOverlay=new g2(e.node.scene)}catch(e){return}},e.getLeaderboardSize$=function(){var t=e.leaders.getComponent(P);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.leaders.node;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.getCorrectOverlay$=function(t){return t===Dy?e.dailyFBOverlay:e.weeklyFBOverlay},e.enableOverlayLoadingNode$=function(){e.loadingNode.active=!0},e.disableOverlayLoadingNode$=function(){e.loadingNode.active=!1},e}return e(f,[{key:"__preload",value:function(){var e,t;this.leaders.maxLeader=null!==(e=null===(t=v5.LeaderboardList[0])||void 0===t?void 0:t.Limit)&&void 0!==e?e:0}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.createFBOverlay$()}},{key:"listenEvents",value:function(){D.on($e.VIEW_RESIZED,this.handleViewResized$),this.node.scene.on(IU.WEEKLY_TAB_SELECTED,this.handleWeeklyTabSelected$),this.node.scene.on(IU.WORLD_TAB_SELECTED,this.handleDailyTabSelected$),this.node.scene.on(IU.OVERLAY_SHOW_STARTED,this.enableOverlayLoadingNode$),this.node.scene.on(IU.OVERLAY_SHOW_COMPLETED,this.disableOverlayLoadingNode$),this.node.scene.on(Es.HIDE_UI,this.hideContent$),this.node.scene.on(Es.SHOW_UI,this.showContent$)}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Es.HIDE_UI,this.hideContent$),this.node.scene.off(Es.SHOW_UI,this.showContent$)}},{key:"loadLeaderboard",value:(y=o((function*(e,t){var n=this,i=this.getLeaderboardName$(t);null!==i&&(yield e.callAsync((function(){return c5.requestLeaderboardAsync(i,n.leaders.maxLeader)})),e.call((function(){var e=c5.getLeaderboard(i);n.currentLb=null!=e?e:n.currentLb})),yield e.callAsync(o((function*(){return n.loadPlayerLeaderData(t)}))))})),function(e,t){return y.apply(this,arguments)})},{key:"showLoading",value:(p=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.isOverlayMode)return this.enableOverlayLoadingNode$(),void this.cleanupOverlay();yield Promise.all([this.leaders.scrollView.unlistenEvents(),this.leaders.scrollView.scrollToTop(e).then((function(){n.leaders&&(n.leaders.scrollView.scrollView.enabled=!1,n.leaders.scrollView.listenEvents())})),this.leaderSkeletons.map((function(t,n){return t.show(n*i,e)}))])})),function(e,t){return p.apply(this,arguments)})},{key:"hideLoading",value:(h=o((function*(e,t){this.isOverlayMode||(yield Promise.all(this.leaderSkeletons.map((function(t){return t.hide(e)}))))})),function(e,t){return h.apply(this,arguments)})},{key:"entering",value:function(){this.timer.reset(),this.isHidden=!1;var e=u5.getStorageData("leaderboard_content","lastTabOpened");e===My?this.handleWeeklyTabSelected$():e===Dy&&this.handleDailyTabSelected$()}},{key:"hide",value:function(){this.isHidden=!0}},{key:"cleanup",value:function(){this.leaders.scrollView.unlistenEvents(),this.unlistenEvents$(),this.cleanupSideEffects$(),this.cleanupOverlay()}},{key:"cleanupOverlay",value:function(){var e,t;null===(e=this.dailyFBOverlay)||void 0===e||e.hideOverlay(),null===(t=this.weeklyFBOverlay)||void 0===t||t.hideOverlay()}},{key:"updateOverlayMountStatus",value:function(e){var t,n;null===(t=this.dailyFBOverlay)||void 0===t||t.setIsPageMounted(e),null===(n=this.weeklyFBOverlay)||void 0===n||n.setIsPageMounted(e)}},{key:"updateStatus",value:(d=o((function*(e,t){if(void 0!==e&&!this.isHidden){this.initializeStatusUpdate$(t);try{yield this.loadLeaderboardData$(e,t),yield this.handleSuccessfulLoad$(e,t)}catch(n){this.handleLoadError$(e,t,n)}}})),function(e,t){return d.apply(this,arguments)})},{key:"playLeadersShowupAnimation",value:(c=o((function*(e,t){var n=this;if(this.currentLb){var i=d5.getPlayerId(),a=this.currentLb.leaders[i],o=u5.getStorage("leaderboard_content").previousScore,r=y5.vals(this.currentLb.leaders);r.sort((function(e,t){return t.score-e.score})),GameSDK.extra.isGuest&&(r=r.slice(0,5));var l=a&&-1!==o&&o<a.score&&a.rank<=this.leaders.maxLeader;this.leaders.updateData(r);var s=!1;l&&(s=this.leaders.updateDisplayPlayerLeaderForRankChanging(o,a.score,a.rank)),this.leaders.initScrollViews(),this.leaders.scrollView.scrollView.enabled=!0;var u=this.hasPlayedAppearAnim[e]?0:.1;yield t.callAsync((function(){return n.leaders.playShowLeadersAnimation(t,u)})),this.hasPlayedAppearAnim[e]=!0,a&&(yield t.callAsync((function(){return n.leaders.scrollToPlayerLeader(1,t)})),s&&-1!==o&&(yield t.callAsync((function(e){return n.leaders.playRankChangeAnimation(e,o,a.score,a.rank)})),u5.setStorageData("leaderboard_content","previousScore",a.score)))}})),function(e,t){return c.apply(this,arguments)})},{key:"loadPlayerLeaderData",value:(u=o((function*(e){var t=d5.getPlayerId();if(null===this.currentLb)throw new Error("LeaderboardContent: Leaderboard is not found.");var n=this.currentLb.leaders;if(0===Object.keys(n).length)throw new f5("LeaderboardContent: Leaderboard is empty.");if(!n[t]){var i=this.getLeaderboardName$(e);if(null===i)throw new Error("LeaderboardContent: Leaderboard name is not found.");var a=yield c5.getLeadersByPlayerIdsAsync(i,[t]);if(0!==a.length){var o=a[0];o&&(n[t]=o)}}})),function(e){return u.apply(this,arguments)})},{key:"updateJoinLeaderboardButton",value:function(){if(GameSDK.extra.isGuest&&!this.isOverlayMode){var e=void 0,t=this.leaders.scrollView.getVisibleNodes();if(0===t.length)e=this.leaders.scrollView.viewport.getBoundingBoxToWorld().center.y;else{var n=t[t.length-1],i=this.joinLeaderboardContainer.uiTransform.height,a=n.node.worldPosition.y-i-20;a-i/2>=this.leaders.scrollView.viewport.getBoundingBoxToWorld().yMin&&(e=a)}this.joinLeaderboardContainer.updatePosition(e)}}},{key:"handleJoinLeaderboard",value:(s=o((function*(){try{if(!("initPlayerAsync"in GameSDK.player))return;if(lt.showLoadingScreen(),yield GameSDK.player.initPlayerAsync(),lt.closeLoadingScreen(),GameSDK.extra.isGuest)return void lt.showNotificationScreenWithLocalizedKey("error.joinLb",1)}catch(e){console.warn("Join leaderboard failed",e),lt.closeLoadingScreen(),lt.showNotificationScreenWithLocalizedKey("error.joinLb",1)}})),function(){return s.apply(this,arguments)})}]),f}(T)).prototype,"tabs",[b2,w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V2=a(H2.prototype,"timer",[S2,k2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$2=a(H2.prototype,"leaders",[C2,E2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W2=a(H2.prototype,"leaderSkeletons",[A2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K2=a(H2.prototype,"leaderboardIsEmpty",[T2,P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j2=a(H2.prototype,"contentOpacity",[O2,L2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y2=a(H2.prototype,"joinLeaderboardContainer",[I2,R2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X2=a(H2.prototype,"loadingNode",[_2,D2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(H2.prototype,"loadLeaderboard",[M2],Object.getOwnPropertyDescriptor(H2.prototype,"loadLeaderboard"),H2.prototype),a(H2.prototype,"showLoading",[N2],Object.getOwnPropertyDescriptor(H2.prototype,"showLoading"),H2.prototype),a(H2.prototype,"hideLoading",[B2],Object.getOwnPropertyDescriptor(H2.prototype,"hideLoading"),H2.prototype),a(H2.prototype,"updateStatus",[F2],Object.getOwnPropertyDescriptor(H2.prototype,"updateStatus"),H2.prototype),a(H2.prototype,"playLeadersShowupAnimation",[x2],Object.getOwnPropertyDescriptor(H2.prototype,"playLeadersShowupAnimation"),H2.prototype),a(H2.prototype,"loadPlayerLeaderData",[z2],Object.getOwnPropertyDescriptor(H2.prototype,"loadPlayerLeaderData"),H2.prototype),a(H2.prototype,"updateJoinLeaderboardButton",[U2],Object.getOwnPropertyDescriptor(H2.prototype,"updateJoinLeaderboardButton"),H2.prototype),G2=H2))||G2);S._RF.pop(),S._RF.push({},"ae514KD4phHMYC0AD3CIw68","LeaderboardPage",void 0);var m5,b5,w5,S5,k5,C5,E5,A5,T5,P5,O5,L5,I5,R5,_5,D5,M5,N5,B5,F5;Z2=(0,C.ccclass)("LeaderboardPage"),Q2=Yn.required(),e5=Yn.onlyRunInLifeCycleAsync,t5=Yn.onlyRunInLifeCycleAsync,n5=Yn.onlyRunInLifeCycleAsync,Z2((o5=a((a5=function(a){n(v,a);var s,u,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"panelAnimationController",o5,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(qs),c(d(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(p=o((function*(){c(d(v.prototype),"start",this).call(this)})),function(){return p.apply(this,arguments)})},{key:"mount",value:(h=o((function*(){if(yield c(d(v.prototype),"mount",this).call(this),this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(g5),this.content.updateOverlayMountStatus(!0),!this.content)throw new Error("LeaderboardPage: Leaders not found")})),function(){return h.apply(this,arguments)})},{key:"transitionIn",value:(u=o((function*(){this.content.entering(),yield c(d(v.prototype),"transitionIn",this).call(this);var e=Ve.runTweenAsync(R(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();this.content.listenEvents(),yield Promise.all([e,t])})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(s=o((function*(){yield c(d(v.prototype),"transitionOut",this).call(this),this.content.cleanupOverlay(),this.content.unlistenUIEvents(),yield this.panelAnimationController.hideUI()})),function(){return s.apply(this,arguments)})},{key:"unmount",value:function(){var e,t,n;null===(e=this.content)||void 0===e||e.hide(),null===(t=this.content)||void 0===t||t.cleanup(),null===(n=this.content)||void 0===n||n.updateOverlayMountStatus(!1),c(d(v.prototype),"unmount",this).call(this)}}]),v}(RX)).prototype,"panelAnimationController",[Q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(a5.prototype,"mount",[e5],Object.getOwnPropertyDescriptor(a5.prototype,"mount"),a5.prototype),a(a5.prototype,"transitionIn",[t5],Object.getOwnPropertyDescriptor(a5.prototype,"transitionIn"),a5.prototype),a(a5.prototype,"transitionOut",[n5],Object.getOwnPropertyDescriptor(a5.prototype,"transitionOut"),a5.prototype),i5=a5));S._RF.pop(),S._RF.push({},"0d1c02Npp9IXrjlFdl8co2L","TopLeader",void 0);var x5,z5,U5,G5,H5,q5,V5,$5,W5,K5,j5,Y5,X5,J5,Z5,Q5,e3,t3,n3,i3,a3,o3,r3,l3,s3,u3,c3,d3,h3,p3,y3,v3,f3,g3,m3,b3,w3,S3,k3,C3,E3,A3=C.ccclass,T3=C.property,P3=Ludex.Utils.Number,O3=(m5=A3("TopLeader"),b5=T3(K),w5=T3(q),S5=T3({type:F}),k5=T3({type:He}),C5=T3({type:B}),E5=T3({type:K}),A5=T3({type:B}),T5=Yn.onlyRunInLifeCycle,P5=Yn.onlyRunInLifeCycleAsync,O5=Yn.onlyRunInLifeCycleAsync,m5((R5=a((I5=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"nameLabel",R5,l(e)),r(e,"defaultAvatar",_5,l(e)),r(e,"avatar",D5,l(e)),r(e,"mask",M5,l(e)),r(e,"avatarOpacity",N5,l(e)),r(e,"scoreLabel",B5,l(e)),r(e,"uiOpacity",F5,l(e)),e.signal=new Ni,e}return e(h,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e){this.updateUsername(e),this.updatePhoto(e),this.updateScore(e)}},{key:"updateUsername",value:function(e){this.nameLabel&&(this.nameLabel.string=e.name)}},{key:"updatePhoto",value:(c=o((function*(e){this.signal.abort();var t=new Ni;this.signal=t,this.mask.enabled=!1,this.defaultAvatar.active=!pN.isAvatarCached(e.playerId,128),this.avatar.spriteFrame=null;var n=e.playerId,i=e.photo,a=yield pN.getPlayerAvatar(i,n,128,t);a&&!t.aborted&&this.setPhoto(a)})),function(e){return c.apply(this,arguments)})},{key:"setPhoto",value:(u=o((function*(e){if(this.node.active){e.packable=!0,this.avatar.spriteFrame=e;var t=R(this.avatarOpacity).to(.2,{opacity:255});yield Ve.runTweenAsync(t,this.signal),this.enabledInHierarchy&&(this.mask.enabled=!0,this.defaultAvatar.active=!1)}})),function(e){return u.apply(this,arguments)})},{key:"updateScore",value:function(e){if(this.scoreLabel){var t=Math.floor(e.score);this.scoreLabel.string=P3.getShortNumber(t,7)}}},{key:"runShowUpAnimation",value:(s=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,n=arguments.length>2?arguments[2]:void 0;this.node.scale=V.ZERO;var i=R(this.node).delay(e).to(t,{scale:new V(1,1,1)},{easing:"backOut"}),a=R(this.uiOpacity).delay(e).to(t,{opacity:255});yield Promise.all([Ve.runTweenAsync(i,n),Ve.runTweenAsync(a,n)])})),function(e){return s.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),h}(T)).prototype,"nameLabel",[b5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_5=a(I5.prototype,"defaultAvatar",[w5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D5=a(I5.prototype,"avatar",[S5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M5=a(I5.prototype,"mask",[k5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N5=a(I5.prototype,"avatarOpacity",[C5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B5=a(I5.prototype,"scoreLabel",[E5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F5=a(I5.prototype,"uiOpacity",[A5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(I5.prototype,"updateInfo",[T5],Object.getOwnPropertyDescriptor(I5.prototype,"updateInfo"),I5.prototype),a(I5.prototype,"updatePhoto",[P5],Object.getOwnPropertyDescriptor(I5.prototype,"updatePhoto"),I5.prototype),a(I5.prototype,"setPhoto",[O5],Object.getOwnPropertyDescriptor(I5.prototype,"setPhoto"),I5.prototype),L5=I5))||L5);S._RF.pop(),S._RF.push({},"8cd04RxbahLDaxq9FJf6hBh","TournamentBlock",void 0);var L3,I3,R3,_3,D3,M3=C.ccclass,N3=C.property,B3=codex,F3=B3.leaderboard,x3=B3.player,z3=B3.language,U3=Ludex.Utils,G3=U3.Time,H3=U3.Object,q3=U3.Array,V3=U3.Number,$3=(x5=M3("TournamentBlock"),z5=Yn.required(),U5=N3(q),G5=Yn.required(),H5=N3(K),q5=Yn.required(),V5=N3({type:th,group:"Localize"}),$5=Yn.required(),W5=N3({type:th,group:"Localize"}),K5=Yn.required(),j5=N3({type:th,group:"Localize"}),Y5=Yn.required(),X5=N3({type:th,group:"Localize"}),J5=Yn.required(),Z5=N3(P),Q5=Yn.required(),e3=N3(B),t3=Yn.required(),n3=N3({type:F,group:"Banner"}),i3=Yn.required(),a3=N3({type:q,group:"Banner"}),o3=Yn.required(),r3=N3({type:q,group:"Banner"}),l3=Yn.required(),s3=N3(O3),u3=Yn.onlyRunInLifeCycleAsync,c3=Yn.onlyRunInLifeCycle,x5((p3=a((h3=function(a){n(v,a);var s,u,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"container",p3,l(e)),r(e,"title",y3,l(e)),r(e,"titleLocalizer",v3,l(e)),r(e,"timeLocalizer",f3,l(e)),r(e,"playerCountLocalizer",g3,l(e)),r(e,"playButtonLocalize",m3,l(e)),r(e,"uiTransform",b3,l(e)),r(e,"uiOpacity",w3,l(e)),r(e,"banner",S3,l(e)),r(e,"bannerMask",k3,l(e)),r(e,"bannerLoadingRing",C3,l(e)),r(e,"topLeader",E3,l(e)),e.hasPlayedAnimation=!1,e}return e(v,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,v)}},{key:"updateInfo",value:(p=o((function*(e){this.payload=e;var t=e.endTime,n=e.title,i=e.payload.playerName,a=e.tournamentType,o=e.payload,r=o.leaderboardId,l=o.themeId,s=void 0===l?pt.AUTUMN:l;r&&(this.topLeader.setVisible(!1),this.topLeader.node.active=!1,this.setPlayerCountWaiting(),"PAGE_HOSTED"===a?this.updateTitleTournamentTitle(n):this.updateTitleWithPlayerName(null!=i?i:n),this.updateEndTime(t),this.updateTournamentBanner(s),yield this.fetchAndUpdateLeadersPayload(r,{leaders:[],amountPlayer:0},n))})),function(e){return p.apply(this,arguments)})},{key:"fetchAndUpdateLeadersPayload",value:(h=o((function*(e,t,n){var i=t;try{var a=yield this.getLeadersPayload(e);a&&(i=a)}catch(e){console.error("Fetch lb for tournament ".concat(n),e)}this.updateLeadersPayload(i)})),function(e,t,n){return h.apply(this,arguments)})},{key:"updateLeadersPayload",value:function(e){this.leadersPayload=e;var t=this.leadersPayload,n=t.player,i=t.amountPlayer,a=t.leaders;this.updatePlayerCount(i),this.updatePlayButtonLabel(void 0!==n),this.updateTopLeader(null!=a?a:[])}},{key:"updateTitleWithPlayerName",value:function(e){void 0!==e&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([e]))}},{key:"updateTitleTournamentTitle",value:function(e){this.titleLocalizer.enabled=!1,this.title.string=e}},{key:"updateEndTime",value:function(e){try{var t=G3.getRelativeTime(e,z3.getCurrentLocale());this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([t])}catch(e){this.timeLocalizer.key="game.endsSoon"}}},{key:"updatePlayerCount",value:function(e){var t=V3.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"updateTopLeader",value:(d=o((function*(e){if(0!==e.length){var t,n=e[0];if(n)Ludex.Configs.Mockup.Leaderboards.Enabled&&(n=null!==(t=q3.search(e,(function(e){return 1===e.rank})))&&void 0!==t?t:n),this.topLeader.node.active=!0,this.topLeader.updateInfo(n),this.topLeader.runShowUpAnimation(0,.2)}})),function(e){return d.apply(this,arguments)})},{key:"updateTournamentBanner",value:(c=o((function*(e){var t=qe.getAsset("".concat(ft[e],"/spriteFrame"),ue);t||(this.bannerMask.active=!0,this.bannerLoadingRing.active=!0,t=yield qe.loadThemePreviewAsync(e)),t||(t=yield qe.loadThemePreviewAsync(pt.SUMMER)),this.banner&&t&&(this.banner.spriteFrame=t,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1)})),function(e){return c.apply(this,arguments)})},{key:"updatePlayButtonLabel",value:function(e){this.playButtonLocalize.key=e?"game.continue":"game.join"}},{key:"getLeadersPayload",value:(u=o((function*(e){var t,n=F3.getLeaderboardName(e);if(!n)return null;var i=yield OD.getAllLeaderboardAsync(e);if(!i)return null;var a=H3.vals(i.leaders);a.sort((function(e,t){return e.rank-t.rank}));var o=x3.getPlayerId(),r=yield F3.getLeadersByPlayerIdsAsync(n,[o]),l={leaders:a,amountPlayer:null!==(t=i.amountPlayer)&&void 0!==t?t:0};return r.length>0&&(l.player=r[0]),l})),function(e){return u.apply(this,arguments)})},{key:"runShowPopUpAnimation",value:(s=o((function*(e,t,n){var i=this;this.node.scale=new V(.8,.8,.8),this.uiOpacity.opacity=0;var a=this.container.position.clone();this.container.position=new V(a.x,a.y-100,a.z);var o=R(this.node).delay(e);o.to(t,{scale:V.ONE},{easing:"elasticOut"});var r=R(this.container).delay(e);r.to(t,{position:a},{easing:"backOut"});var l=R(this.uiOpacity).delay(e);l.to(t,{opacity:255},{easing:"cubicOut"});var s=function(){i.node.setScale(V.ONE),i.container.setPosition(a),i.uiOpacity.opacity=255};n.addAbortListener(s),yield Promise.all([Ve.runTweenAsync(o,n),Ve.runTweenAsync(r,n),Ve.runTweenAsync(l,n)]),n.removeAbortListener(s)})),function(e,t,n){return s.apply(this,arguments)})},{key:"handleOnTournamentClicked",value:function(){var e=this.payload.id||"";if(ut.validateTournamentExpired(e))return this.node.scene.emit(Ny.RELOAD_TOURNAMENT),void lt.showNotificationScreenWithLocalizedKey("error.tourEnded",2);try{var t=JSON.stringify(this.payload),n=this.leadersPayload.player?"tournament_end":"tournament_start";lt.showTournamentDetailScreen(t,n,this.hasPlayedAnimation),this.hasPlayedAnimation=!0}catch(e){console.warn("handleOnTournamentClicked",e)}}}]),v}(T)).prototype,"container",[z5,U5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y3=a(h3.prototype,"title",[G5,H5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v3=a(h3.prototype,"titleLocalizer",[q5,V5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f3=a(h3.prototype,"timeLocalizer",[$5,W5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g3=a(h3.prototype,"playerCountLocalizer",[K5,j5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m3=a(h3.prototype,"playButtonLocalize",[Y5,X5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b3=a(h3.prototype,"uiTransform",[J5,Z5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w3=a(h3.prototype,"uiOpacity",[Q5,e3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S3=a(h3.prototype,"banner",[t3,n3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k3=a(h3.prototype,"bannerMask",[i3,a3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C3=a(h3.prototype,"bannerLoadingRing",[o3,r3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E3=a(h3.prototype,"topLeader",[l3,s3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(h3.prototype,"fetchAndUpdateLeadersPayload",[u3],Object.getOwnPropertyDescriptor(h3.prototype,"fetchAndUpdateLeadersPayload"),h3.prototype),a(h3.prototype,"updateLeadersPayload",[c3],Object.getOwnPropertyDescriptor(h3.prototype,"updateLeadersPayload"),h3.prototype),d3=h3))||d3);S._RF.pop(),S._RF.push({},"a409buwLfZLQq7cmBGiqhF5","TournamentBlockSkeleton",void 0);var W3,K3,j3,Y3,X3,J3,Z3,Q3,e6,t6,n6,i6=C.ccclass,a6=C.property,o6=(L3=i6("TournamentBlockSkeleton"),I3=a6(q),L3((D3=a((_3=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"container",D3,l(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"hide",value:(u=o((function*(e){var t=this;yield Ve.runTweenAsync(R(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(s=o((function*(e,t){var n=this;this.node.active=!0,this.node.scale=new V(.8,.8,.8),this.uiOpacity.opacity=0;var i=this.container.position.clone();this.container.position=new V(i.x,i.y-100,i.z);var a=R(this.node).delay(e);a.to(.2,{scale:V.ONE},{easing:"elasticOut"});var o=R(this.container).delay(e);o.to(.2,{position:i},{easing:"backOut"});var r=R(this.uiOpacity).delay(e);r.to(.2,{opacity:255},{easing:"cubicOut"});var l=function(){n.node.setScale(V.ONE),n.container.setPosition(i),n.uiOpacity.opacity=255};t.addAbortListener(l),yield Promise.all([Ve.runTweenAsync(a,t),Ve.runTweenAsync(o,t),Ve.runTweenAsync(r,t)]),t.removeAbortListener(l)})),function(e,t){return s.apply(this,arguments)})}]),d}(T)).prototype,"container",[I3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R3=_3))||R3);S._RF.pop(),S._RF.push({},"5f82fye3oxHQrxKbP9TC2di","TournamentsBoard",void 0);var r6,l6=C.ccclass,s6=C.property,u6=codex.player,c6=(W3=l6("TournamentsBoard"),K3=s6(fe),j3=s6(_),Y3=s6(q),X3=s6(P),W3((Q3=a((Z3=function(a){n(d,a);var s,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"tournamentBlockPrefab",Q3,l(e)),e.tournamentBlockArray=[],r(e,"layout",e6,l(e)),r(e,"createTournamentButton",t6,l(e)),r(e,"viewport",n6,l(e)),e}return e(d,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"start",value:function(){for(var e=0;e<6;e++)this.addTournamentBlock();var t=this.tournamentBlockArray[0];t&&(this.tournamentBlockContentHeight=t.uiTransform.contentSize.height+this.layout.spacingY)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateData",value:function(e){var t=this,n=!1;e.forEach((function(e,i){var a=t.tournamentBlockArray[i];e.payload.playerId===u6.getPlayerId()&&(n=!0),a||(a=t.addTournamentBlock()),a.node.active=!0,a.updateInfo(e)})),n||this.setCreateTournamentButtonActive(!0)}},{key:"addTournamentBlock",value:function(){var e=ye(this.tournamentBlockPrefab);this.layout.node.addChild(e),e.active=!1;var t=e.getComponent($3);return this.tournamentBlockArray.push(t),t}},{key:"removeTournamentBlocks",value:function(){var e,t=this.getActiveTournamentBlocks(),n=u(t);try{for(n.s();!(e=n.n()).done;){e.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}this.setCreateTournamentButtonActive(!1)}},{key:"getActiveTournamentBlocks",value:function(){var e=this;return this.tournamentBlockArray.filter((function(t){return t.node.parent===e.layout.node}))}},{key:"setCreateTournamentButtonActive",value:function(e){GameSDK.isGameSDK("FacebookInstant")&&(e?this.layout.node.addChild(this.createTournamentButton):this.layout.node.removeChild(this.createTournamentButton),this.createTournamentButton.active=e)}},{key:"showTournamentBlocks",value:(s=o((function*(e,t){var n=this.getActiveTournamentBlocks();if(!(n.length<1)){var i=Math.ceil(e/this.tournamentBlockContentHeight),a=Math.min(n.length,i);yield Promise.all(n.map(function(){var e=o((function*(e,n){n<a?yield e.runShowPopUpAnimation(.1*n,.3,t):e.uiOpacity.opacity=255}));return function(t,n){return e.apply(this,arguments)}}()))}})),function(e,t){return s.apply(this,arguments)})},{key:"updateVisibility",value:function(){var e,t=this.viewport.getBoundingBoxToWorld(),n=t.yMax,i=t.yMin,a=this.getActiveTournamentBlocks(),o=u(a);try{for(o.s();!(e=o.n()).done;){var r=e.value,l=r.uiTransform;if(void 0!==l){var s=l.getBoundingBoxToWorld(),c=s.yMax,d=s.yMin,h=c<i||d>n;r.uiOpacity.opacity=h?0:255}}}catch(e){o.e(e)}finally{o.f()}}}]),d}(T)).prototype,"tournamentBlockPrefab",[K3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e6=a(Z3.prototype,"layout",[j3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t6=a(Z3.prototype,"createTournamentButton",[Y3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n6=a(Z3.prototype,"viewport",[X3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J3=Z3))||J3);S._RF.pop(),S._RF.push({},"f8a7b0St3FAkb1PvvvJTLCh","TournamentsNotAvailable",void 0);var d6,h6,p6,y6,v6,f6,g6,m6,b6,w6,S6,k6,C6,E6,A6,T6=(0,C.ccclass)("TournamentsNotAvailable")(r6=function(a){n(s,a);var r,l=i(s);function s(){return t(this,s),l.apply(this,arguments)}return e(s,[{key:"onLoad",value:function(){this.hide()}},{key:"show",value:(r=o((function*(){this.node.active=!0;var e=this.node.position.clone(),t=R(this.node);t.to(.05,{position:e.clone().add3f(5,0,0)}),t.to(.05,{position:e.clone().add3f(-5,0,0)});var n=R(this.node).repeat(2,t);n.to(.05,{position:e}),yield Ve.runTweenAsync(n)})),function(){return r.apply(this,arguments)})},{key:"hide",value:function(){this.node.active=!1}}]),s}(T))||r6;S._RF.pop(),S._RF.push({},"199fcQ5IEZFbJCfSrGNrGDQ","TournamentContent",void 0);var P6,O6,L6,I6,R6,_6,D6,M6,N6,B6=C.ccclass,F6=C.property,x6=codex,z6=x6.storage,U6=x6.match,G6=Ludex.Utils,H6=G6.Object,q6=G6.Array,V6=(d6=B6("TournamentContent"),h6=F6({type:Ys}),p6=F6(c6),y6=F6(T6),v6=F6(Ge),f6=F6({type:[o6]}),g6=F6(qr),d6((w6=a((b6=function(a){n(p,a);var s,u,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"panelAnimator",w6,l(e)),r(e,"tournamentsBoard",S6,l(e)),r(e,"tournamentsNotAvailable",k6,l(e)),r(e,"scrollView",C6,l(e)),r(e,"skeletons",E6,l(e)),r(e,"contentOpacity",A6,l(e)),e.animAbortSignal=null,e.softAbortSignal=null,e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(p,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(P),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.scrollView.node.on(Ge.EventType.SCROLLING,this.onScrolling,this),this.node.scene.on(Ny.RELOAD_TOURNAMENT,this.reload,this),this.node.scene.on(Es.HIDE_UI,this.hideContent),this.node.scene.on(Es.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(Ge.EventType.SCROLLING,this.onScrolling,this),this.node.scene.off(Ny.RELOAD_TOURNAMENT,this.reload,this),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Es.HIDE_UI,this.hideContent),this.node.scene.off(Es.SHOW_UI,this.showContent)}},{key:"onScrolling",value:function(){this.tournamentsBoard.updateVisibility()}},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"enter",value:(d=o((function*(){var e;if(null===this.animAbortSignal&&null===this.softAbortSignal&&(this.animAbortSignal=new Ni,this.softAbortSignal=new Ni,yield this.showLoading(this.animAbortSignal),!this.isAborted())){var t=yield ut.requestTournamentDataAsync();this.isAborted()||(yield this.hideLoading(this.animAbortSignal),this.isAborted()||(0!==t.length||null!==(e=this.softAbortSignal)&&void 0!==e&&e.aborted?(this.tournamentsNotAvailable.hide(),this.tryShowTournamentResult(),this.scrollView.enabled=!0,this.tournamentsBoard.updateData(t),yield this.tournamentsBoard.showTournamentBlocks(this.uiTransform.contentSize.height-this.tournamentsBoard.layout.paddingTop,this.animAbortSignal),this.tournamentsBoard.updateVisibility()):this.tournamentsNotAvailable.show()))}})),function(){return d.apply(this,arguments)})},{key:"showLoading",value:(c=o((function*(e){this.scrollView.scrollToTop(0),this.scrollView.enabled=!1,yield Promise.all([this.skeletons.map((function(t){return t.show(0,e)}))])})),function(e){return c.apply(this,arguments)})},{key:"hideLoading",value:(u=o((function*(e){yield Promise.all([this.skeletons.map((function(t){return t.hide(e)}))])})),function(e){return u.apply(this,arguments)})},{key:"tryShowTournamentResult",value:function(){try{if(!z6.getStorage("tournament").animateTournamentLeader)return;var e=ut.getAllTournamentData(),t=U6.getMatchState().customData.tournamentId;if(!t)throw new Error("Tournament ID not found");var n=q6.search(e,(function(e){return e.id===t}));if(!n)throw new Error("Tournament not found");var i=JSON.stringify(n);lt.showTournamentDetailScreen(i,"tournament_end")}catch(e){z6.setStorageData("tournament","animateTournamentLeader",!1),console.warn("showTournamentResult",e)}}},{key:"processCreateTournament",value:(s=o((function*(){try{yield iv.processCreateTournamentAsync()}catch(e){if(!H6.hasOwn(e,"code"))return void lt.showNotificationScreenWithLocalizedKey("error.createTourFail",2);if("USER_INPUT"===e.code)return;if("PLAYER_HAS_TOURNAMENT"===e.code)return void lt.showNotificationScreenWithLocalizedKey("error.tourExists",2);"INVALID_OPERATION"===e.code&&H6.hasOwn(e,"message")&&"string"==typeof e.message&&lt.showNotificationScreen(e.message,2),lt.showNotificationScreenWithLocalizedKey("error.createTourFail",2)}this.reload()})),function(){return s.apply(this,arguments)})},{key:"isAborted",value:function(){var e,t;return null===(e=null===(t=this.animAbortSignal)||void 0===t?void 0:t.aborted)||void 0===e||e}},{key:"cleanup",value:function(){var e;this.unlistenEvents(),null===(e=this.animAbortSignal)||void 0===e||e.abort(),this.animAbortSignal=null,this.tournamentsBoard.removeTournamentBlocks(),this.tournamentsNotAvailable.hide()}},{key:"softAbort",value:function(){var e;null===(e=this.softAbortSignal)||void 0===e||e.abort(),this.softAbortSignal=null}},{key:"reload",value:function(){this.softAbort(),this.cleanup(),this.listenEvents(),this.enter()}}]),p}(T)).prototype,"panelAnimator",[h6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S6=a(b6.prototype,"tournamentsBoard",[p6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k6=a(b6.prototype,"tournamentsNotAvailable",[y6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C6=a(b6.prototype,"scrollView",[v6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E6=a(b6.prototype,"skeletons",[f6],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A6=a(b6.prototype,"contentOpacity",[g6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m6=b6))||m6);S._RF.pop(),S._RF.push({},"bce5eh0LHVP2bCJ6u+kFjuA","TournamentPage",void 0);var $6,W6,K6,j6,Y6,X6;P6=(0,C.ccclass)("TournamentPage"),O6=Yn.required(),L6=Yn.onlyRunInLifeCycleAsync,I6=Yn.onlyRunInLifeCycle,R6=Yn.onlyRunInLifeCycleAsync,_6=Yn.onlyRunInLifeCycleAsync,P6((N6=a((M6=function(a){n(v,a);var s,u,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"panelAnimationController",N6,l(e)),e}return e(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(qs),c(d(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(p=o((function*(){c(d(v.prototype),"start",this).call(this)})),function(){return p.apply(this,arguments)})},{key:"mount",value:(h=o((function*(){yield c(d(v.prototype),"mount",this).call(this),this.onMount()})),function(){return h.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(V6),!this.content)throw new Error("LeaderboardPage: Leaders not found")}},{key:"transitionIn",value:(u=o((function*(){yield c(d(v.prototype),"transitionIn",this).call(this);var e=Ve.runTweenAsync(R(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();this.content.listenEvents(),yield Promise.all([e,t]),this.content.enter()})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(s=o((function*(){var e;null===(e=this.content)||void 0===e||e.softAbort(),this.content.unlistenUIEvents(),yield c(d(v.prototype),"transitionOut",this).call(this),yield this.panelAnimationController.hideUI()})),function(){return s.apply(this,arguments)})},{key:"unmount",value:function(){var e;null===(e=this.content)||void 0===e||e.cleanup(),c(d(v.prototype),"unmount",this).call(this)}}]),v}(RX)).prototype,"panelAnimationController",[O6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(M6.prototype,"mount",[L6],Object.getOwnPropertyDescriptor(M6.prototype,"mount"),M6.prototype),a(M6.prototype,"onMount",[I6],Object.getOwnPropertyDescriptor(M6.prototype,"onMount"),M6.prototype),a(M6.prototype,"transitionIn",[R6],Object.getOwnPropertyDescriptor(M6.prototype,"transitionIn"),M6.prototype),a(M6.prototype,"transitionOut",[_6],Object.getOwnPropertyDescriptor(M6.prototype,"transitionOut"),M6.prototype),D6=M6));S._RF.pop(),S._RF.push({},"b8271vI+3pO9q8SKMYpqLKv","EventBadge",void 0);var J6,Z6,Q6,e4,t4,n4,i4,a4,o4,r4=C.ccclass,l4=C.property;$6=r4("EventBadge"),W6=l4(K),K6=l4(E),$6((X6=a((Y6=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"label",X6,l(e)),e}return e(s,[{key:"text",get:function(){return this.label.string},set:function(e){this.label.string=e}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.label)throw new Error("EventBadge: Missing required component Label")}}]),s}(T)).prototype,"label",[W6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Y6.prototype,"text",[K6],Object.getOwnPropertyDescriptor(Y6.prototype,"text"),Y6.prototype),j6=Y6));S._RF.pop(),S._RF.push({},"7712cs4XLJAgpKqlO3gPqkF","EventProgressBar",void 0);var s4,u4,c4,d4,h4,p4,y4,v4,f4,g4,m4,b4,w4,S4,k4,C4,E4,A4,T4,P4,O4,L4,I4,R4,_4,D4,M4,N4,B4,F4,x4,z4,U4,G4,H4,q4,V4,$4,W4,K4,j4,Y4,X4,J4,Z4,Q4,e9,t9,n9=C.ccclass,i9=C.property;J6=n9("EventProgressBar"),Z6=i9(Ic),Q6=i9(K),e4=i9(E),t4=i9({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress"}),J6((a4=a((i4=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"progressBar",a4,l(e)),r(e,"progressLabel",o4,l(e)),e}return e(s,[{key:"text",get:function(){return this.progressLabel.string},set:function(e){this.progressLabel.string=e}},{key:"progress",get:function(){return this.progressBar.progress},set:function(e){this.progressBar.progress=e}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("EventProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("EventProgressBar: Missing required component Label")}}]),s}(T)).prototype,"progressBar",[Z6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o4=a(i4.prototype,"progressLabel",[Q6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(i4.prototype,"text",[e4],Object.getOwnPropertyDescriptor(i4.prototype,"text"),i4.prototype),a(i4.prototype,"progress",[t4],Object.getOwnPropertyDescriptor(i4.prototype,"progress"),i4.prototype),n4=i4));S._RF.pop(),S._RF.push({},"7741dWPNcdHRqGVvif/L/MP","NavButton",void 0);var a9,o9,r9,l9,s9,u9,c9,d9=C.ccclass,h9=C.property,p9=C.executeInEditMode,y9=codex.analytics,v9=(null!==(s4=Ludex.Plugins.Analytics)&&void 0!==s4?s4:{}).Events;u4=d9("NavButton"),c4=h9(W),d4=h9({group:{name:"Animation"},displayName:"Is Selected",tooltip:"This is for the editor only and will be ignored at runtime",editorOnly:!0}),h4=h9({type:L,group:{name:"Animation"}}),p4=h9({type:L,group:{name:"Animation"}}),y4=h9({type:L,group:{name:"Animation"}}),v4=h9({type:L,group:{name:"Animation"}}),f4=h9({type:L,group:{name:"Animation"}}),g4=h9({group:{name:"Animation"}}),m4=h9({type:L,group:{name:"Animation"}}),b4=h9({type:L,group:{name:"Animation"}}),w4=h9({group:{name:"Animation"}}),S4=h9({type:L,group:{name:"Animation"}}),k4=h9({type:L,group:{name:"Animation"}}),C4=h9({type:L,group:{name:"Animation"}}),E4=h9({type:L,group:{name:"Animation"}}),A4=h9({type:L,group:{name:"Animation"}}),T4=h9({type:P}),P4=h9(q),O4=h9(B),L4=h9({type:P}),I4=h9({type:x(On)}),R4=h9(BZ),u4(_4=p9((M4=a((D4=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"wip",M4,l(e)),r(e,"isSelectedInEditor",N4,l(e)),r(e,"animationDuration",B4,l(e)),r(e,"selectedSpacing",F4,l(e)),r(e,"deselectedSpacing",x4,l(e)),r(e,"selectedIconY",z4,l(e)),r(e,"selectedIconX",U4,l(e)),r(e,"selectedIconScale",G4,l(e)),r(e,"deselectedIconY",H4,l(e)),r(e,"deselectedIconX",q4,l(e)),r(e,"deselectedIconScale",V4,l(e)),r(e,"initTextY",$4,l(e)),r(e,"selectedTextY",W4,l(e)),r(e,"selectedTextX",K4,l(e)),r(e,"deselectedTextY",j4,l(e)),r(e,"deselectedTextX",Y4,l(e)),r(e,"spacer",X4,l(e)),r(e,"icon",J4,l(e)),r(e,"text",Z4,l(e)),r(e,"uiTransform",Q4,l(e)),r(e,"screenType",e9,l(e)),r(e,"navManager",t9,l(e)),e.isSelected=!1,e.onMouseEnter=function(t){e.isSelected||e.playHoverOnAnimation()},e.onMouseLeave=function(t){e.isSelected||e.playHoverOffAnimation()},e}return e(d,[{key:"isWIP",get:function(){return this.wip}},{key:"buttonType",get:function(){return this.screenType}},{key:"update",value:function(){}},{key:"onEnable",value:function(){this.node.on(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(q.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(q.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onEditorUpdate",value:function(){null!==this.icon&&void 0!==this.icon&&null!==this.text&&void 0!==this.icon&&null!==this.spacer&&void 0!==this.spacer&&(this.isSelectedInEditor?(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.initTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0))}},{key:"setSelected",value:function(){var e,t;this.isSelected||(je.playSound(Qi.PATCH_SHIFT),this.navManager.selectUsingSceneTransition(this),v9&&y9.event(v9.BUTTON_CLICK,{button_name:null!==(e=null===(t=this.node.parent)||void 0===t?void 0:t.name)&&void 0!==e?e:this.node.name,screen_name:Ye.getCurrentPage()}))}},{key:"select",value:(u=o((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.isSelected)throw new Error("NavButton: Already selected");this.isSelected=!0,e?yield Ve.runTweenAsync(this.playSelectAnimation()):(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255)})),function(){return u.apply(this,arguments)})},{key:"deselect",value:(s=o((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isSelected&&!t)throw new Error("NavButton: Already deselected");this.isSelected=!1,e?yield Ve.runTweenAsync(this.deselectAnimation()):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.deselectedTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0)})),function(){return s.apply(this,arguments)})},{key:"getSelectedWorldDistanceX",value:function(){var e=new V(this.selectedIconX,this.selectedIconY,0),t=new V(this.deselectedIconX,this.deselectedIconY,0),n=this.node.scale.clone();this.node.scale=this.selectedIconScale;var i=this.uiTransform.convertToWorldSpaceAR(e),a=this.uiTransform.convertToWorldSpaceAR(t);return this.node.scale=n,a.x-i.x}},{key:"playHoverOnAnimation",value:function(){var e=R(this.icon);return e.to(.1,{scale:this.deselectedIconScale.clone().add3f(.1,.1,0)},{easing:"cubicIn"}),Ve.runTweenAsync(e)}},{key:"playHoverOffAnimation",value:function(){var e=R(this.icon);return e.to(.1,{scale:this.deselectedIconScale},{easing:"cubicOut"}),Ve.runTweenAsync(e)}},{key:"playSelectAnimation",value:function(){var e=this;return R(this.spacer).to(this.animationDuration,{width:this.selectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=z.quintInOut(n),a=z.backOut(n),o=z.linear(n),r=n<.5?2*n:1,l=e.deselectedIconY+(e.selectedIconY-e.deselectedIconY)*a,s=e.deselectedIconX+(e.selectedIconX-e.deselectedIconX)*o;e.icon.setPosition(s,l,0);var u=e.deselectedIconScale.clone().lerp(e.selectedIconScale,i);e.icon.setScale(u.x,u.y,e.icon.scale.z);var c=255*r,d=e.deselectedTextY+(e.selectedTextY-e.deselectedTextY)*o,h=e.deselectedTextX+(e.selectedTextX-e.deselectedTextX)*o;e.text.opacity=c,e.text.node.setPosition(h,d,0)}}})}},{key:"deselectAnimation",value:function(){var e=this;return R(this.spacer).to(this.animationDuration,{width:this.deselectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=Se(e.selectedIconY,e.deselectedIconY,n),a=Se(e.selectedIconX,e.deselectedIconX,n);e.icon.setPosition(a,i,0);var o=Se(255,0,n<.5?2*n:1);e.text.opacity=o;var r=Se(e.selectedTextY,e.deselectedTextY,n),l=Se(e.selectedTextX,e.deselectedTextX,n);e.text.node.setPosition(l,r,0);var s=e.selectedIconScale.clone().lerp(e.deselectedIconScale,z.quintInOut(n));e.icon.setScale(s.x,s.y,e.icon.scale.z)}}})}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(P),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),d}(T)).prototype,"wip",[c4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),N4=a(D4.prototype,"isSelectedInEditor",[d4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B4=a(D4.prototype,"animationDuration",[h4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),F4=a(D4.prototype,"selectedSpacing",[p4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),x4=a(D4.prototype,"deselectedSpacing",[y4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 88}}),z4=a(D4.prototype,"selectedIconY",[v4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),U4=a(D4.prototype,"selectedIconX",[f4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G4=a(D4.prototype,"selectedIconScale",[g4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(1,1,1)}}),H4=a(D4.prototype,"deselectedIconY",[m4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),q4=a(D4.prototype,"deselectedIconX",[b4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),V4=a(D4.prototype,"deselectedIconScale",[w4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V(.8,.8,1)}}),$4=a(D4.prototype,"initTextY",[S4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-100}}),W4=a(D4.prototype,"selectedTextY",[k4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-10}}),K4=a(D4.prototype,"selectedTextX",[C4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),j4=a(D4.prototype,"deselectedTextY",[E4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y4=a(D4.prototype,"deselectedTextX",[A4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X4=a(D4.prototype,"spacer",[T4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J4=a(D4.prototype,"icon",[P4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z4=a(D4.prototype,"text",[O4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q4=a(D4.prototype,"uiTransform",[L4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e9=a(D4.prototype,"screenType",[I4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t9=a(D4.prototype,"navManager",[R4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_4=D4))||_4);S._RF.pop(),S._RF.push({},"091aai5+ANDeZfFN8JFkbyi","TournamentButton",void 0);var f9,g9,m9,b9,w9,S9,k9,C9,E9=Ludex.Utils.Signal,A9=C.ccclass,T9=C.property,P9=new V(1.1,1.1);a9=A9("TournamentButton"),o9=Yn.required(),r9=T9(q),l9=Yn.onlyRunInLifeCycle,a9((c9=a((u9=function(a){n(y,a);var s,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"hotIcon",c9,l(e)),e.requestController=new E9.SignalController,e}return e(y,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,y)}},{key:"onLoad",value:(h=o((function*(){yield this.handleHotIconAppearance()})),function(){return h.apply(this,arguments)})},{key:"onDestroy",value:function(){this.requestController.abort()}},{key:"handleHotIconAppearance",value:(d=o((function*(){GameSDK.isGameSDK("MsGames")?this.handleMsGamesHotIconCheck():this.handleNormalHotIconCheck()})),function(){return d.apply(this,arguments)})},{key:"handleMsGamesHotIconCheck",value:(c=o((function*(){try{var e=this.requestController.renew(),t=yield ut.requestTournamentDataAsync();if(e.aborted)return;t.filter((function(e){return!ut.validateTournamentExpired(e.id)})).length>=2&&this.showHotIcon(e)}catch(e){console.info("Error in TournamentButton",e)}})),function(){return c.apply(this,arguments)})},{key:"handleNormalHotIconCheck",value:(s=o((function*(){try{var e=this.requestController.renew(),t=yield ut.requestTournamentDataAsync();if(e.aborted)return;var n,i=u(t);try{for(i.s();!(n=i.n()).done;){var a=n.value.payload,o=a.leaderboardId,r=a.playerId;if(o&&"global"===r){var l=yield OD.getAllLeaderboardAsync(o);if(l&&l.amountPlayer>=30){this.showHotIcon(e);break}}}}catch(e){i.e(e)}finally{i.f()}}catch(e){console.info("Error in TournamentButton",e)}})),function(){return s.apply(this,arguments)})},{key:"showHotIcon",value:function(e){this.hotIcon.active=!0,this.hotIcon.setScale(V.ZERO);var t=R(this.hotIcon).delay(1).to(.3,{scale:P9},{easing:"backIn"}).to(.3,{scale:V.ONE},{easing:"backOut"});Ve.runTweenAsync(R(this.hotIcon).to(.5,{scale:V.ONE},{easing:"backOut"}).repeatForever(t),e)}}]),y}(T)).prototype,"hotIcon",[o9,r9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(u9.prototype,"showHotIcon",[l9],Object.getOwnPropertyDescriptor(u9.prototype,"showHotIcon"),u9.prototype),s9=u9));S._RF.pop(),S._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var O9,L9,I9,R9,_9,D9,M9,N9=C.ccclass,B9=C.property,F9=C.disallowMultiple,x9=codex,z9=x9.player,U9=x9.event,G9=Ke.Layout,H9=Ludex,q9=H9.Match.Modes,V9=H9.Events;f9=N9("GameScene"),g9=Yn.required(),m9=B9(PS),b9=Yn.onlyRunInLifeCycle,w9=Yn.onlyRunInLifeCycle,f9(S9=F9((C9=a((k9=function(a){n(u,a);var s=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=s.call.apply(s,[this].concat(i)),r(e,"coinManager",C9,l(e)),e.handleGameExit=function(){ct.switchToDashboardScene()},e.handleShowResults=function(){ct.switchScene(yt.CHALLENGE_RESULT_SCENE)},e.handleGameMaskWhenLayoutChanged=function(e){var t=re("Canvas/Game/GameObjects");if(t){var n=t.getComponent(He);n&&(n.enabled=e===G9.Landscape)}},e.updateMusic=o((function*(){var e=iv.getMatchMode()===q9.TOURNAMENT,t=e?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC;je.getCurrentMusic()!==t&&(yield je.setVolumeMusic(0,!0),yield Ve.waitTweenAsync(1)),je.playMusic(t,e),je.setVolumeMusic(e?.4:.3,!0)})),e}return e(u,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this),EB.createLayer(this.node,"Particles",6),EB.createLayer(this.node,"GameUnpackLabel",5),this.listenGameEvents()}},{key:"onLoad",value:function(){this.coinManager.init()}},{key:"listenGameEvents",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(Es.GAME_EXIT,this.handleGameExit),this.node.scene.on(Es.SHOW_CHALLENGE_RESULTS,this.handleShowResults),this.node.scene.on(Es.UPDATE_MUSIC,this.updateMusic)}},{key:"start",value:function(){z9.getPlayerSetting("music")&&this.updateMusic(),this.scheduleOnce(this.preloadScenes,20),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScenes",value:function(){ct.preloadDashboardScene()}},{key:"preloadScreens",value:function(){var e,t=z9.getGameData(),n=null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1;n%5==0&&lt.preloadScreen(st.HARD_LEVEL_SCREEN),n>=at&&(lt.preloadScreen(st.CONGRATULATION_SCREEN),lt.preloadScreen(st.START_OVER_SCREEN)),lt.preloadScreen(st.PAUSE_SCREEN),lt.preloadScreen(st.LOADING_SCREEN),lt.preloadScreen(st.GET_ITEM_SCREEN),lt.preloadScreen(st.NOTIFICATION_SCREEN),this.node.scene.once(Es.GAME_FINISH,(function(){lt.preloadScreen(st.LEVEL_COMPLETE_SCREEN),lt.preloadScreen(st.GET_REWARDS_SCREEN)})),U9.once(V9.OPENED_SCREEN,(function(e){e.screenName===ht[st.PAUSE_SCREEN]&&(lt.preloadScreen(st.QUIT_LEVEL_SCREEN),lt.preloadScreen(st.START_OVER_SCREEN),lt.preloadScreen(st.CUSTOM_GAME_SCREEN))}))}}]),u}(T)).prototype,"coinManager",[g9,m9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(k9.prototype,"preloadScenes",[b9],Object.getOwnPropertyDescriptor(k9.prototype,"preloadScenes"),k9.prototype),a(k9.prototype,"preloadScreens",[w9],Object.getOwnPropertyDescriptor(k9.prototype,"preloadScreens"),k9.prototype),S9=k9))||S9);S._RF.pop(),S._RF.push({},"0c0b4cnFOFJ6pJmGNHnMo7m","ComboEffect",void 0);var $9,W9,K9,j9,Y9,X9,J9,Z9=C.ccclass,Q9=C.property;O9=Z9("ComboEffect"),L9=Q9(B),I9=Q9(ee),O9((D9=a((_9=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"circleOpacity",D9,l(e)),r(e,"particle",M9,l(e)),e}return e(s,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Es.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){e>1&&(this.circleOpacity.node.scale=V.ZERO,this.circleOpacity.opacity=60,this.particle.node.active=!0,this.particle.resetSystem(),R(this.circleOpacity.node).to(.2,{scale:new V(1.3,1.3,1.3)},{easing:"quadOut"}).start(),R(this.circleOpacity).delay(.3).to(.2,{opacity:0},{easing:"expoIn"}).start()),0===e&&(this.particle.node.active=!1)}}]),s}(T)).prototype,"circleOpacity",[L9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M9=a(_9.prototype,"particle",[I9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R9=_9));S._RF.pop(),S._RF.push({},"0506aJZ1EdPqJejQ2PpB980","ComboLabel",void 0);var e8,t8,n8,i8,a8,o8,r8,l8,s8,u8,c8,d8,h8=C.ccclass,p8=C.property;$9=h8("ComboLabel"),W9=p8(K),K9=p8(q),$9((X9=a((Y9=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"comboNumber",X9,l(e)),r(e,"comboContainer",J9,l(e)),e}return e(s,[{key:"onLoad",value:function(){this.opacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Es.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){e>1?(this.opacity.opacity=255,this.comboNumber.string="".concat(e),EB.setNodeToLayer(this.comboNumber.node,"GameUnpackLabel"),R(this.comboContainer).to(.1,{scale:new V(1.3,1.3,1.3)},{easing:"sineIn"}).to(.1,{scale:V.ONE},{easing:"sineOut"}).start()):(EB.removeNodeFromLayer(this.comboNumber.node),this.opacity.opacity=0)}}]),s}(T)).prototype,"comboNumber",[W9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J9=a(Y9.prototype,"comboContainer",[K9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j9=Y9));S._RF.pop(),S._RF.push({},"51871oF8CFOkp81rgCf90UQ","ComboPopup",void 0);var y8,v8,f8,g8,m8,b8,w8,S8,k8,C8,E8,A8,T8,P8,O8,L8,I8,R8,_8=Ludex.Utils.Signal,D8=C.ccclass,M8=C.property,N8=Ke.Layout,B8=["good","great","excellent"];e8=D8("ComboPopup"),t8=Yn.required(),n8=M8(th),i8=Yn.required(),a8=M8(ce),o8=Yn.required(),r8=M8(B),e8((u8=a((s8=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"spriteLocalizer",u8,l(e)),r(e,"animation",c8,l(e)),r(e,"textUiOpacity",d8,l(e)),e.comboController=new _8.SignalController,e}return e(c,[{key:"__preload",value:function(){this.widget=this.getComponent(I),Yn.validateRequiredProperties(this)}},{key:"onLoad",value:function(){D.on($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(Ze.getCurrentLayout())}},{key:"onDestroy",value:function(){D.off($e.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.comboController.abort()}},{key:"start",value:function(){this.node.scene.on(Es.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:(s=o((function*(e){if(!(e<2))for(var t=B8.length-1;t>=0;t--){var n=B8[t];if(e>=t+2){var i=this.comboController.renew();if(this.spriteLocalizer.key=n,this.textUiOpacity.opacity=0,yield this.spriteLocalizer.waitUntilLocalized(),i.aborted)return;return Ve.runTweenAsync(R(this.textUiOpacity).to(.25,{opacity:255}),i),void this.animation.play()}}})),function(e){return s.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){e===N8.Portrait?(this.widget.left=20,this.widget.right=20):e===N8.Landscape&&(this.widget.left=700,this.widget.right=120)}}]),c}(T)).prototype,"spriteLocalizer",[t8,n8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c8=a(s8.prototype,"animation",[i8,a8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d8=a(s8.prototype,"textUiOpacity",[o8,r8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l8=s8));S._RF.pop(),S._RF.push({},"11abe47Ss1CtabSFT1/cPKt","PlayableScene",void 0);var F8,x8,z8,U8,G8,H8,q8,V8,$8,W8,K8,j8,Y8,X8,J8,Z8,Q8=C.ccclass,e7=C.property,t7=C.disallowMultiple,n7=codex.analytics;y8=Q8("PlayableScene"),v8=Yn.required(),f8=e7({type:K}),g8=Yn.required(),m8=e7({type:hT}),b8=Yn.required(),w8=e7({type:hT}),S8=Yn.required(),k8=e7({type:ce}),C8=Yn.onlyRunInLifeCycleAsync,E8=Yn.onlyRunInLifeCycle,A8=Yn.onlyRunInLifeCycle,y8(T8=t7((O8=a((P8=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;return t(this,h),e=d.call(this),r(e,"label",O8,l(e)),r(e,"particleLeft",L8,l(e)),r(e,"particleRight",I8,l(e)),r(e,"backgroundAnimation",R8,l(e)),ct.markIsTestScene(yt.PLAYABLE_SCENE),e}return e(h,[{key:"__preload",value:function(){this.listenEvents()}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"listenEvents",value:function(){}},{key:"start",value:(c=o((function*(){n7.event("ready_playable"),yield this.waitViewable(),this.playTweens(),this.playParticles(),this.playAnimations(),n7.event("showing_playable"),setTimeout((function(){"openAppStore"in GameSDK.extra&&GameSDK.extra.openAppStore()}),1e4)})),function(){return c.apply(this,arguments)})},{key:"waitViewable",value:(u=o((function*(){"isViewable"in GameSDK.extra&&(GameSDK.extra.isViewable()||"waitViewableChange"in GameSDK.extra&&(D.pause(),(yield GameSDK.extra.waitViewableChange())?D.resume():yield this.waitViewable()))})),function(){return u.apply(this,arguments)})},{key:"playTweens",value:(s=o((function*(){var e=R(this.label.node).to(10,{position:new V(0,200,0)},{easing:"cubicInOut"}).to(6,{position:new V(0,-100,0)},{easing:"cubicInOut"});Ve.runTweenAsync(R(this.label.node).repeat(999,e))})),function(){return s.apply(this,arguments)})},{key:"playParticles",value:function(){console.log("playParticles",this.particleLeft,this.particleRight),this.particleLeft.play(),this.particleRight.play()}},{key:"playAnimations",value:function(){this.backgroundAnimation.play()}}]),h}(T)).prototype,"label",[v8,f8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L8=a(P8.prototype,"particleLeft",[g8,m8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I8=a(P8.prototype,"particleRight",[b8,w8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R8=a(P8.prototype,"backgroundAnimation",[S8,k8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(P8.prototype,"playTweens",[C8],Object.getOwnPropertyDescriptor(P8.prototype,"playTweens"),P8.prototype),a(P8.prototype,"playParticles",[E8],Object.getOwnPropertyDescriptor(P8.prototype,"playParticles"),P8.prototype),a(P8.prototype,"playAnimations",[A8],Object.getOwnPropertyDescriptor(P8.prototype,"playAnimations"),P8.prototype),T8=P8))||T8);S._RF.pop(),S._RF.push({},"a0819yK3HpO2505QqLUOChz","PlayerScore",void 0);var i7,a7,o7,r7,l7,s7,u7,c7,d7,h7,p7,y7,v7,f7,g7,m7,b7,w7,S7,k7,C7,E7,A7,T7,P7,O7,L7,I7,R7=C.ccclass,_7=C.property,D7=(F8=R7("PlayerScore"),x8=_7(q),z8=_7(K),U8=_7(B),G8=_7(B),H8=_7(F),q8=_7(q),V8=Yn.onlyRunInLifeCycleAsync,F8((K8=a((W8=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"crown",K8,l(e)),r(e,"playerScore",j8,l(e)),r(e,"playerScoreUiOpacity",Y8,l(e)),r(e,"waitingUiOpacity",X8,l(e)),r(e,"avatar",J8,l(e)),r(e,"defaultAvatarNode",Z8,l(e)),e.avatarOverlay=null,e.isOverlayMode=!1,e}return e(d,[{key:"onLoad",value:function(){this.createAvatarOverlay()}},{key:"createAvatarOverlay",value:function(){try{jM.isOverlayViewAPIAvailable(GameSDK),this.isOverlayMode=!0,this.avatarOverlay=new ZM(this.node.scene)}catch(e){return}}},{key:"showCrown",value:function(e){this.crown.active=e}},{key:"setPlayerScore",value:function(e){this.playerScore.string=e.toString()}},{key:"playWaitingAnimation",value:function(){this.waitingUiOpacity.node.active=!0,this.playerScoreUiOpacity.node.active=!1,this.waitingUiOpacity.opacity=130,this.playerScoreUiOpacity.opacity=0;var e=R(this.waitingUiOpacity).to(1,{opacity:130},{easing:"sineInOut"}).to(1,{opacity:255},{easing:"sineInOut"}).delay(.25);this.waitingAnimation=R(this.waitingUiOpacity).repeatForever(e).start()}},{key:"stopWaitingAnimation",value:function(){this.waitingAnimation&&this.waitingAnimation.stop(),this.waitingUiOpacity.opacity=0,this.playerScoreUiOpacity.opacity=255,this.waitingUiOpacity.node.active=!1,this.playerScoreUiOpacity.node.active=!0}},{key:"loadPhoto",value:(u=o((function*(e,t){try{var n="10"===t;if(this.isOverlayMode&&!n){if(yield this.showAvatarOverlay(t))return;this.isOverlayMode=!1}var i=yield pN.getPlayerAvatar(e,t,128);if(!i)throw new Error("Failed to create sprite frame");if(!this.node.activeInHierarchy)return;i.packable=!0,this.avatar.spriteFrame=i}catch(e){return void console.error(e)}})),function(e,t){return u.apply(this,arguments)})},{key:"showAvatarOverlay",value:(s=o((function*(e){if(!this.avatarOverlay)return!1;var t=this.getDefaultAvatarPosition(),n=t.worldX,i=t.worldY,a=yield this.avatarOverlay.updateOverlay({playerId:e,worldX:n,worldY:i,avatarWidth:this.getDefaultAvatarWidth()});return null!=a&&a})),function(e){return s.apply(this,arguments)})},{key:"cleanupOverlay",value:function(){var e;null===(e=this.avatarOverlay)||void 0===e||e.hideOverlay()}},{key:"getDefaultAvatarPosition",value:function(){var e=this.defaultAvatarNode;return{worldX:e.worldPositionX,worldY:e.worldPositionY}}},{key:"getDefaultAvatarWidth",value:function(){return this.defaultAvatarNode.getComponent(P).width}}]),d}(T)).prototype,"crown",[x8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j8=a(W8.prototype,"playerScore",[z8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y8=a(W8.prototype,"playerScoreUiOpacity",[U8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X8=a(W8.prototype,"waitingUiOpacity",[G8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J8=a(W8.prototype,"avatar",[H8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z8=a(W8.prototype,"defaultAvatarNode",[q8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(W8.prototype,"loadPhoto",[V8],Object.getOwnPropertyDescriptor(W8.prototype,"loadPhoto"),W8.prototype),$8=W8))||$8);S._RF.pop(),S._RF.push({},"4b062RYQK5PQbgs7yH66gDw","ChallengeResultScene",void 0);var M7,N7,B7,F7,x7,z7,U7,G7,H7,q7=C.ccclass,V7=C.disallowMultiple,$7=C.property,W7=codex,K7=W7.match,j7=W7.player,Y7=W7.monitorError,X7=Ludex.Utils.Object;i7=q7("ChallengeResultScene"),a7=$7(th),o7=$7(th),r7=$7(th),l7=$7(th),s7=$7({type:D7,group:"Score"}),u7=$7({type:D7,group:"Score"}),c7=$7({group:"Confetti Effect",type:hT}),d7=$7({group:"Confetti Effect",type:hT}),h7=$7(Wv),p7=$7(ce),y7=Yn.onlyRunInLifeCycle,v7=Yn.onlyRunInLifeCycle,f7=Yn.onlyRunInLifeCycle,g7=Yn.onlyRunInLifeCycle,m7=Yn.onlyRunInLifeCycle,i7(b7=V7((S7=a((w7=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"drawLocalizer",S7,l(e)),r(e,"winLocalizer",k7,l(e)),r(e,"loseLocalizer",C7,l(e)),r(e,"waitingLocalizer",E7,l(e)),r(e,"playerScore",A7,l(e)),r(e,"opponentScore",T7,l(e)),r(e,"leftConfetti",P7,l(e)),r(e,"rightConfetti",O7,l(e)),r(e,"levelManager",L7,l(e)),r(e,"headerAnimation",I7,l(e)),e.goToDashboardScene=function(){e.playerScore.cleanupOverlay(),e.opponentScore.cleanupOverlay(),ct.switchToDashboardScene()},e.goToGameScene=function(){e.playerScore.cleanupOverlay(),e.opponentScore.cleanupOverlay(),ct.switchToGameScene()},e}return e(c,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.node.scene.on($e.RESULT_SCENE_HOME,this.goToDashboardScene),this.node.scene.on($e.RESULT_SCENE_REPLAY,this.handleTryAgainClicked,this)}},{key:"start",value:function(){this.scheduleOnce(this.preloadScenes,3);try{var e,t,n=K7.getMatchState(),i=n.customData,a=i.playerId,o=i.opponentId;if(!a||!o)throw new Error("ResultScene: playerId is ".concat(a," and opponentId is ").concat(o,". Expected to not be null."));var r=j7.getPlayer().photo,l=null!==(e=n.profiles[a])&&void 0!==e?e:{},s=l.score,u=void 0===s?0:s,c=l.finished,d=void 0!==c&&c,h=null!==(t=n.profiles[o])&&void 0!==t?t:{},p=h.photo,y=void 0===p?"":p,v=h.score,f=void 0===v?0:v,g=h.finished,m=void 0!==g&&g,b=d&&m,w=b&&u>f,S=b&&f>u;this.playerScore.loadPhoto(r,a),this.opponentScore.loadPhoto(y,o),this.playerScore.setPlayerScore(u),this.opponentScore.setPlayerScore(f),this.playerScore.showCrown(w),this.opponentScore.showCrown(S),d&&m?u===f?this.playStatusAnimation("Draw"):w?this.playStatusAnimation("Win"):S&&this.playStatusAnimation("Lose"):(d||this.playerScore.playWaitingAnimation(),m||this.opponentScore.playWaitingAnimation(),this.playStatusAnimation("Waiting"))}catch(e){console.warn("ResultScene: Error on load",e),this.goToDashboardScene()}}},{key:"preloadScenes",value:function(){ct.preloadDashboardScene()}},{key:"handleTryAgainClicked",value:(s=o((function*(){var e,t=(null!==(e=j7.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;n=Math.max(1,n);var i=yield this.levelManager.loadLevelData(n);try{if(!i)throw new Error("Level data is not found");var a=K7.getMatchState().customData.opponentId;if(!a)throw new Error("Opponent id is not found");lt.showLoadingScreen();var o=Km.generateFen(i),r=i.mode,l=void 0===r?"":r,s=i.rules,u=void 0===s?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:s,c=i.time,d=void 0===c?0:c,h=i.level;yield K7.challenge.friend.processAsync({playerId:j7.getPlayerId(),opponentId:a,extraData:{challengeData:{level:h,fen:o,gravity:l,rules:u,time:d}}}),lt.closeLoadingScreen(),this.goToGameScene()}catch(e){if(X7.hasOwn(e,"code")&&"USER_INPUT"===e.code)return void lt.closeLoadingScreen();console.warn("ReplayChallengeFriend",e),lt.closeLoadingScreen(),lt.showNotificationScreenWithLocalizedKey("error.challengeFail",2),null==Y7||Y7.sendException(e instanceof Error?e:new Error("ReplayChallengeFriend"+JSON.stringify(e))),this.scheduleOnce(this.goToDashboardScene,2)}})),function(){return s.apply(this,arguments)})},{key:"handleHomeClicked",value:function(){this.goToDashboardScene()}},{key:"playStatusAnimation",value:function(e){var t=this;"Win"!==e&&"Waiting"!==e||this.triggerConfettiAnimation();var n=this.getSpriteLocalizer(e);n.node.active=!0,n.waitUntilLocalized().then((function(){switch(e){case"Draw":t.playDrawAnimation();break;case"Win":t.playWinAnimation();break;case"Lose":t.playLoseAnimation();break;case"Waiting":t.playWaitingAnimation()}}))}},{key:"getSpriteLocalizer",value:function(e){switch(e){case"Draw":return this.drawLocalizer;case"Win":return this.winLocalizer;case"Lose":return this.loseLocalizer;case"Waiting":return this.waitingLocalizer}}},{key:"playDrawAnimation",value:function(){this.headerAnimation.play("RibbonDraw"),je.playSound(Qi.LEVEL_FAIL)}},{key:"playWinAnimation",value:function(){this.headerAnimation.play("RibbonWin"),je.playSound(Qi.LEVEL_COMPLETE)}},{key:"playLoseAnimation",value:function(){this.headerAnimation.play("RibbonLose"),je.playSound(Qi.LEVEL_FAIL)}},{key:"playWaitingAnimation",value:function(){this.headerAnimation.play("RibbonWaiting"),je.playSound(Qi.LEVEL_COMPLETE)}},{key:"triggerConfettiAnimation",value:function(){var e=this,t=Ze.isLandscape(),n=t?50:30,i=t?5e3:2e3,a=t?15e3:1e4,o=t?40:60,r=t?110:100,l=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=a,this.leftConfetti.shapeModule.angle=o,this.rightConfetti.shapeModule.angle=r,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=l,this.scheduleOnce((function(){e.leftConfetti.play(),e.rightConfetti.play()}),.2)}}]),c}(T)).prototype,"drawLocalizer",[a7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k7=a(w7.prototype,"winLocalizer",[o7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C7=a(w7.prototype,"loseLocalizer",[r7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E7=a(w7.prototype,"waitingLocalizer",[l7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A7=a(w7.prototype,"playerScore",[s7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T7=a(w7.prototype,"opponentScore",[u7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P7=a(w7.prototype,"leftConfetti",[c7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O7=a(w7.prototype,"rightConfetti",[d7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L7=a(w7.prototype,"levelManager",[h7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I7=a(w7.prototype,"headerAnimation",[p7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(w7.prototype,"playDrawAnimation",[y7],Object.getOwnPropertyDescriptor(w7.prototype,"playDrawAnimation"),w7.prototype),a(w7.prototype,"playWinAnimation",[v7],Object.getOwnPropertyDescriptor(w7.prototype,"playWinAnimation"),w7.prototype),a(w7.prototype,"playLoseAnimation",[f7],Object.getOwnPropertyDescriptor(w7.prototype,"playLoseAnimation"),w7.prototype),a(w7.prototype,"playWaitingAnimation",[g7],Object.getOwnPropertyDescriptor(w7.prototype,"playWaitingAnimation"),w7.prototype),a(w7.prototype,"triggerConfettiAnimation",[m7],Object.getOwnPropertyDescriptor(w7.prototype,"triggerConfettiAnimation"),w7.prototype),b7=w7))||b7);S._RF.pop(),S._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var J7,Z7=C.ccclass,Q7=C.property,eee=C.disallowMultiple,tee=Ludex.Events,nee=codex.event,iee=(M7=Z7("BaseScreen"),N7=Q7(q),B7=Q7(q),F7=Q7(B),M7(x7=eee((U7=a((z7=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"container",U7,l(e)),r(e,"backgroundMask",G7,l(e)),r(e,"screenOpacity",H7,l(e)),e.data={},e}return e(s,[{key:"__preload",value:function(){this.animation=this.getComponent(ce),this.backgroundMaskButton=this.backgroundMask.getComponent(G),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"setScreenOpacity",value:function(e){this.screenOpacity.opacity=e}},{key:"open",value:function(e){var t,n,i=this;e&&(this.data=e),this.animation.once(ce.EventType.PLAY,(function(){i.show()})),nee.emit(tee.OPENED_SCREEN,{screenName:this.node.name,screenData:this.data}),this.runAnimation(null!==(t=null===(n=this.data.overrideAnimation)||void 0===n?void 0:n.openScreen)&&void 0!==t?t:"OpenScreen")}},{key:"close",value:function(){var e,t,n=this;this.node.active&&(this.animation.once(ce.EventType.FINISHED,(function(){nee.emit(tee.CLOSED_SCREEN,{screenName:n.node.name}),n.hide()})),this.runAnimation(null!==(e=null===(t=this.data.overrideAnimation)||void 0===t?void 0:t.closeScreen)&&void 0!==e?e:"CloseScreen"))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(B);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(B);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){this.node.active=!0;var e=this.node.getComponent(I);if(e){e.enabled=!0,e.updateAlignment();var t,n=this.node.getComponentsInChildren(I),i=u(n);try{for(i.s();!(t=i.n()).done;){t.value.updateAlignment()}}catch(e){i.e(e)}finally{i.f()}}}},{key:"hide",value:function(){this.node.active=!1}}]),s}(T)).prototype,"container",[N7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G7=a(z7.prototype,"backgroundMask",[B7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H7=a(z7.prototype,"screenOpacity",[F7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x7=z7))||x7)||x7);S._RF.pop(),S._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var aee,oee,ree,lee,see,uee,cee,dee,hee,pee,yee,vee,fee,gee,mee=C.ccclass,bee=C.requireComponent;mee("BackgroundMask")(J7=bee([B])(J7=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"onLoad",value:function(){var e=this.getComponent(B);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),r}(T))||J7);S._RF.pop(),S._RF.push({},"d25c5ZVzYVC/YcfG5prmRdB","Screens",void 0);var wee,See,kee,Cee,Eee,Aee,Tee,Pee,Oee,Lee,Iee,Ree,_ee,Dee,Mee=C.ccclass,Nee=C.property,Bee=C.executeInEditMode,Fee=(aee=Mee("ScreenConfig"),oee=Nee({type:x(st)}),ree=Nee({type:O}),aee((uee=a((see=e((function e(){t(this,e),r(this,"key",uee,this),r(this,"depth",cee,this)}))).prototype,"key",[oee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return st.LOADING_SCREEN}}),cee=a(see.prototype,"depth",[ree],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lee=see))||lee);dee=Mee("Screens"),hee=Nee({type:[Fee]}),pee=Nee({tooltip:"Preload all the screens automatically in ScreenDepth when the scene starts."}),dee(yee=Bee((fee=a((vee=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"screens",fee,l(e)),r(e,"autoPreload",gee,l(e)),e}return e(s,[{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"onChildrenChanged",value:function(){}}]),s}(T)).prototype,"screens",[hee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gee=a(vee.prototype,"autoPreload",[pee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yee=vee))||yee);S._RF.pop(),S._RF.push({},"cecf2nUBzhIWZw7uJgVliXz","CongratulationScreen",void 0);var xee,zee,Uee,Gee,Hee,qee,Vee,$ee,Wee,Kee,jee,Yee,Xee,Jee,Zee,Qee=C.ccclass,ete=C.property,tte=C.disallowMultiple,nte=C.requireComponent,ite=Ludex.Events,ate=codex.event;wee=Qee("CongratulationScreen"),See=nte(iee),kee=ete(q),Cee=ete(q),Eee=ete(G),Aee=ete(G),Tee=ete(G),wee(Pee=tte(Pee=See((Lee=a((Oee=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"congratulation",Lee,l(e)),r(e,"confirmation",Iee,l(e)),r(e,"closeButtonComponent",Ree,l(e)),r(e,"yesButtonComponent",_ee,l(e)),r(e,"noButtonComponent",Dee,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("CongratulationScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.yesButtonComponent.interactable=!0,e.noButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(s,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.confirmationUIOpacity=this.confirmation.getComponent(B),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){ate.on(ite.OPENING_SCREEN,this.handleOpeningScreen),ate.on(ite.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){ate.off(ite.OPENING_SCREEN,this.handleOpeningScreen),ate.off(ite.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.confirmation.active=!1,this.congratulation.active=!0}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.yesButtonComponent.interactable=!1,this.noButtonComponent.interactable=!1,lt.closeScreen(st.CONGRATULATION_SCREEN)}},{key:"handleStartOver",value:function(){this.confirmation.active=!0,this.congratulation.active=!1,R(this.confirmationUIOpacity).set({opacity:0}).to(.2,{opacity:255}).start(),R(this.confirmation).set({scale:new V(.8,.8,.8)}).to(.2,{scale:new V(1,1,1)},{easing:"backOut"}).start()}},{key:"handleYesStartOver",value:function(){this.close(),this.node.scene.emit(Es.START_OVER,1)}},{key:"handleNoStartOver",value:function(){this.requestGameReplay()}},{key:"handleClickedClose",value:function(){this.requestGameReplay()}},{key:"requestGameReplay",value:function(){this.close(),this.node.scene.emit(Es.GAME_REPLAY)}}]),s}(T)).prototype,"congratulation",[kee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iee=a(Oee.prototype,"confirmation",[Cee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ree=a(Oee.prototype,"closeButtonComponent",[Eee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_ee=a(Oee.prototype,"yesButtonComponent",[Aee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dee=a(Oee.prototype,"noButtonComponent",[Tee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pee=Oee))||Pee)||Pee);S._RF.pop(),S._RF.push({},"dc7da51sglB44qYIJOboZkL","HorizontalSelector",void 0);var ote,rte,lte,ste,ute,cte,dte,hte,pte,yte,vte,fte,gte,mte,bte,wte,Ste=C.ccclass,kte=C.property,Cte=(xee=Ste("HorizontalSelector"),zee=kte({type:W,tooltip:"Component initializes on its own in its preload method. Turn off if you want to initialize it manually."}),Uee=kte({type:E,visible:function(){return!this.selfInitialize}}),Gee=kte({type:O,visible:function(){return!this.selfInitialize}}),Hee=kte(W),qee=kte(K),Vee=kte(U),xee((Kee=a((Wee=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"selfInitialize",Kee,l(e)),r(e,"items",jee,l(e)),r(e,"currentIndex",Yee,l(e)),r(e,"loop",Xee,l(e)),r(e,"selectedItemLabel",Jee,l(e)),r(e,"onSelectEvents",Zee,l(e)),e.selectedItem="",e}return e(s,[{key:"__preload",value:function(){this.selfInitialize||this.init(this.items,this.currentIndex)}},{key:"init",value:function(e,t,n){this.items=e,this.currentIndex=t,void 0!==n&&(this.loop=n),this.selectedItem=this.items[this.currentIndex],this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem)}},{key:"selectNext",value:function(){(this.loop||this.currentIndex!==this.items.length-1)&&(this.currentIndex=(this.currentIndex+1)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"selectPrevious",value:function(){(this.loop||0!==this.currentIndex)&&(this.currentIndex=(this.currentIndex-1+this.items.length)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"getSelectedItem",value:function(){return this.selectedItem}},{key:"getSelectedIndex",value:function(){return this.currentIndex}},{key:"getItems",value:function(){return this.items}},{key:"setSelectedItem",value:function(e){this.selectedItem=this.items[e],this.currentIndex=e,this.emitOnSelectedEvents()}},{key:"emitOnSelectedEvents",value:function(){this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem);var e,t=u(this.onSelectEvents);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.emit([this.selectedItem,n.customEventData])}}catch(e){t.e(e)}finally{t.f()}}}]),s}(T)).prototype,"selfInitialize",[zee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jee=a(Wee.prototype,"items",[Uee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yee=a(Wee.prototype,"currentIndex",[Gee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xee=a(Wee.prototype,"loop",[Hee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jee=a(Wee.prototype,"selectedItemLabel",[qee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zee=a(Wee.prototype,"onSelectEvents",[Vee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$ee=Wee))||$ee);S._RF.pop(),S._RF.push({},"50306JI4lZMEqIc8ZHjuEgn","CustomGameScreen",void 0);var Ete,Ate,Tte,Pte,Ote,Lte,Ite,Rte,_te,Dte,Mte,Nte,Bte,Fte,xte,zte,Ute,Gte,Hte,qte,Vte,$te,Wte,Kte,jte,Yte,Xte,Jte,Zte,Qte,ene,tne,nne,ine,ane,one,rne=C.ccclass,lne=C.property,sne=C.requireComponent,une=Ludex.Events,cne=codex,dne=cne.event,hne=cne.player;ote=rne("CustomGameScreen"),rte=sne(iee),lte=lne(G),ste=lne({type:Cte,group:"Selectors"}),ute=lne({type:Cte,group:"Selectors"}),cte=lne({type:Cte,group:"Selectors"}),dte=lne({type:C0,group:"Selectors"}),hte=lne(K),ote(pte=rte((vte=a((yte=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"playButton",vte,l(e)),r(e,"timeSelector",fte,l(e)),r(e,"difficultySelector",gte,l(e)),r(e,"bombsSelector",mte,l(e)),r(e,"extraAdsSwitch",bte,l(e)),r(e,"bonusLabel",wte,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StartLevelScreen: screen not found");e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){dne.on(une.OPENING_SCREEN,this.handleOpeningScreen),dne.on(une.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){dne.off(une.OPENING_SCREEN,this.handleOpeningScreen),dne.off(une.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(e){this.setInteractableButtons(!1),this.node.scene.emit(Es.SHOW_UI),dne.emit(une.CLOSE_SCREEN,{screenName:this.node.name,screenData:{customMode:e}})}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"updateStatus",value:function(){var e=Sv.time,t=Sv.difficulty,n=Sv.bombs,i=wv.getCustomData();this.timeSelector.init(e.map((function(e){return e<0?"".concat(e,"%"):"+".concat(e,"%")})),i.time),this.difficultySelector.init(g(t),i.difficulty),this.bombsSelector.init(n.map((function(e){return"".concat(e)})),i.bombs),this.extraAdsSwitch.setEnabled(i.ads),this.calculateBonus()}},{key:"handleClickedPlay",value:(s=o((function*(){this.close(!0)})),function(){return s.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleSelectedTime",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedDifficulty",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedBombs",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSwitchedExtraAds",value:function(){this.extraAdsSwitch.switch(),this.updateCustomGameData(),this.calculateBonus()}},{key:"updateCustomGameData",value:function(){var e=this.timeSelector.getSelectedIndex(),t=this.difficultySelector.getSelectedIndex(),n=this.bombsSelector.getSelectedIndex();hne.setGameData({custom:{time:e,difficulty:t,bombs:n,ads:this.extraAdsSwitch.enable}})}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.screen.backgroundMask.getComponent(G).interactable=e}},{key:"calculateBonus",value:function(){var e=wv.getCustomBonus();this.bonusLabel.string=e>=0?"+".concat(e,"%"):"".concat(e,"%")}}]),c}(T)).prototype,"playButton",[lte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fte=a(yte.prototype,"timeSelector",[ste],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gte=a(yte.prototype,"difficultySelector",[ute],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mte=a(yte.prototype,"bombsSelector",[cte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bte=a(yte.prototype,"extraAdsSwitch",[dte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wte=a(yte.prototype,"bonusLabel",[hte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pte=yte))||pte);S._RF.pop(),S._RF.push({},"01c067hcjNDc7prJzSE6UEq","DayBlock",void 0);var pne,yne,vne,fne,gne,mne,bne,wne,Sne,kne,Cne,Ene,Ane,Tne,Pne,One,Lne,Ine,Rne,_ne,Dne,Mne,Nne,Bne,Fne,xne,zne,Une,Gne,Hne,qne,Vne,$ne,Wne,Kne,jne,Yne,Xne,Jne,Zne,Qne,eie=C.ccclass,tie=C.property,nie=(Ete=eie("DayBlock"),Ate=Yn.required(),Tte=tie({type:F,group:"Background"}),Pte=Yn.required(),Ote=tie({type:F,group:"Background"}),Lte=Yn.required(),Ite=tie({type:ue,group:"Background"}),Rte=Yn.required(),_te=tie({type:ue,group:"Background"}),Dte=Yn.required(),Mte=tie(K),Nte=Yn.required(),Bte=tie(th),Fte=Yn.required(),xte=tie(K),zte=Yn.required(),Ute=tie(q),Gte=Yn.required(),Hte=tie(q),qte=Yn.required(),Vte=tie(q),$te=Yn.required(),Wte=tie({type:B}),Ete((Yte=a((jte=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"background",Yte,l(e)),r(e,"topBackground",Xte,l(e)),r(e,"blueBackground",Jte,l(e)),r(e,"blueTopBackground",Zte,l(e)),r(e,"dayLabel",Qte,l(e)),r(e,"dayLocalizer",ene,l(e)),r(e,"coinLabel",tne,l(e)),r(e,"rewardItemsNode",nne,l(e)),r(e,"checkNode",ine,l(e)),r(e,"glowNodes",ane,l(e)),r(e,"uiOpacity",one,l(e)),e}return e(s,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,s),this.initDefaultProperties()}},{key:"initDefaultProperties",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultTopBackground=this.topBackground.spriteFrame,this.defaultDayLabelOutlineColor=new X(this.dayLabel.outlineColor),this.blueDayLabelOutlineColor=new X("#3469bf")}},{key:"updateInfo",value:function(e){this.updateBackground(e),this.updateDayLabel(e),this.coinLabel.string=e.value.toString(),this.updateRewardItems(e)}},{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"rewarded":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"rewarded"!==e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.outlineColor=t,this.dayLabel.shadowColor=t}},{key:"updateRewardItems",value:function(e){switch(e.status){case"ready":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!0);break;case"waiting":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!1);break;case"rewarded":this.rewardItemsNode.active=!1,this.checkNode.active=!0,this.setGlowNodesActive(!1)}}},{key:"setGlowNodesActive",value:function(e){this.glowNodes&&this.glowNodes.forEach((function(t){t.active=e}))}}]),s}(T)).prototype,"background",[Ate,Tte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xte=a(jte.prototype,"topBackground",[Pte,Ote],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jte=a(jte.prototype,"blueBackground",[Lte,Ite],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zte=a(jte.prototype,"blueTopBackground",[Rte,_te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qte=a(jte.prototype,"dayLabel",[Dte,Mte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ene=a(jte.prototype,"dayLocalizer",[Nte,Bte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tne=a(jte.prototype,"coinLabel",[Fte,xte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nne=a(jte.prototype,"rewardItemsNode",[zte,Ute],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ine=a(jte.prototype,"checkNode",[Gte,Hte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ane=a(jte.prototype,"glowNodes",[qte,Vte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),one=a(jte.prototype,"uiOpacity",[$te,Wte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kte=jte))||Kte);S._RF.pop(),S._RF.push({},"cc662r8eR5Al6FdOBdcAkHG","DailyRewardsScreen",void 0);var iie,aie=C.ccclass,oie=C.property,rie=C.requireComponent,lie=Ludex,sie=lie.Events,uie=lie.Utils,cie=uie.Array,die=uie.Signal,hie=lie.Plugins.Ads,pie=(void 0===hie?{}:hie).Types,yie=codex,vie=yie.event,fie=yie.player;pne=aie("DailyRewardsScreen"),yne=rie(iee),vne=Yn.required(),fne=oie(q),gne=Yn.required(),mne=oie(G),bne=Yn.required(),wne=oie(G),Sne=Yn.required(),kne=oie(G),Cne=Yn.required(),Ene=oie(G),Ane=Yn.required(),Tne=oie(G),Pne=Yn.required(),One=oie(q),Lne=Yn.required(),Ine=oie(q),Rne=Yn.required(),_ne=oie(q),Dne=oie([nie]),Mne=Yn.onlyRunInLifeCycle,Nne=Yn.onlyRunInLifeCycleAsync,Bne=Yn.onlyRunInLifeCycle,Fne=Yn.onlyRunInLifeCycleAsync,xne=Yn.onlyRunInLifeCycleAsync,zne=Yn.onlyRunInLifeCycle,Une=Yn.onlyRunInLifeCycle,Gne=Yn.onlyRunInLifeCycle,pne(Hne=yne((Vne=a((qne=function(a){n(v,a);var s,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=y.call.apply(y,[this].concat(i))).rewardsData=[],r(e,"loadingRing",Vne,l(e)),r(e,"claimButton",$ne,l(e)),r(e,"claimX2Button",Wne,l(e)),r(e,"closeButton",Kne,l(e)),r(e,"backgroundButton",jne,l(e)),r(e,"continueButton",Yne,l(e)),r(e,"claimButtonScallableNode",Xne,l(e)),r(e,"claimX2ButtonScallableNode",Jne,l(e)),r(e,"continueButtonScallableNode",Zne,l(e)),r(e,"dailyBlocks",Qne,l(e)),e.dailyLoadingController=new die.SignalController,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.setLoading())},e.handleOpenedScreen=function(){var t=o((function*(t){e.validateEventPayload(t)&&e.open()}));return function(e){return t.apply(this,arguments)}}(),e}return e(v,[{key:"__preload",value:function(){this.enabled=!1,Yn.validateRequiredProperties(this,v),this.listenScreenEvents(),pie&&Xe.preloadAdsByType(pie.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){vie.on(sie.OPENING_SCREEN,this.handleOpeningScreen),vie.on(sie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){vie.off(sie.OPENING_SCREEN,this.handleOpeningScreen),vie.off(sie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"setLoading",value:function(){this.loadingRing.active=!0;var e,t=u(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){e.value.uiOpacity.opacity=0}}catch(e){t.e(e)}finally{t.f()}this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.setInteractableButtons(!0),this.node.scene.emit(Es.HIDE_UI),this.openAsync()}},{key:"openAsync",value:(p=o((function*(){var e=this.dailyLoadingController.renew(),t=!Cq.hasShownPopup(),n=yield Cq.getRewardsData();if(null!==n){var i=cie.search(n,(function(e){return"ready"===e.status}));this.updateScreenData(n,i),t?yield this.runPopUpAnim(e):this.showElements()}else this.close()})),function(){return p.apply(this,arguments)})},{key:"updateScreenData",value:function(e,t){this.rewardsData=e,this.currentRewardsData=t;for(var n=0,i=this.dailyBlocks.length;n<i;n++){var a=this.rewardsData[n],o=this.dailyBlocks[n],r=a.id,l=a.type,s=a.value,u=a.status;o.updateInfo({day:r,type:l,value:s,status:u})}}},{key:"close",value:function(){Cq.setHasShownPopup(),this.setInteractableButtons(!1),this.dailyLoadingController.abort(),vie.emit(sie.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Es.SHOW_UI)}},{key:"runPopUpAnim",value:(h=o((function*(e){var t=this;this.loadingRing.active=!1,yield Promise.all(this.dailyBlocks.map((function(n,i){return t.runBlockPopUpAnim(n,.15*i,e)}))),yield this.runButtonPopUpAnim(e)})),function(e){return h.apply(this,arguments)})},{key:"showElements",value:function(){this.loadingRing.active=!1;var e,t=u(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.uiOpacity.opacity=255,n.node.setScale(1,1,1)}}catch(e){t.e(e)}finally{t.f()}void 0===this.currentRewardsData?(this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(1,1,1)):(this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(1,1,1),this.claimX2ButtonScallableNode.setScale(1,1,1))}},{key:"runButtonPopUpAnim",value:(d=o((function*(e){if(void 0===this.currentRewardsData)return this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(0,0,0),void(yield Ve.runTweenAsync(R(this.continueButtonScallableNode).to(.3,{scale:V.ONE},{easing:"backOut"}),e));this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(0,0,0),this.claimX2ButtonScallableNode.setScale(0,0,0),yield Promise.all([Ve.runTweenAsync(R(this.claimButtonScallableNode).to(.3,{scale:V.ONE},{easing:"backOut"}),e),Ve.runTweenAsync(R(this.claimX2ButtonScallableNode).delay(.1).to(.3,{scale:V.ONE},{easing:"backOut"}),e)])})),function(e){return d.apply(this,arguments)})},{key:"runBlockPopUpAnim",value:(c=o((function*(e,t,n){e.node.setScale(1.2,1.2,1.2),e.uiOpacity.opacity=0;var i=Ve.runTweenAsync(R(e.uiOpacity).delay(t).to(.3,{opacity:255},{easing:"quadOut"}),n),a=Ve.runTweenAsync(R(e.node).delay(t).to(.3,{scale:V.ONE},{easing:"backOut"}),n);yield Promise.all([i,a])})),function(e,t,n){return c.apply(this,arguments)})},{key:"handleOnClaim",value:function(){void 0!==this.currentRewardsData?(this.setInteractableButtons(!1),this.claimReward(this.currentRewardsData)):lt.showNotificationScreenWithLocalizedKey("error.rewardFail",2)}},{key:"handleOnClaimX2",value:(s=o((function*(){void 0!==this.currentRewardsData?(this.setInteractableButtons(!1),(yield Xe.showRewardVideoAdAsync())?this.claimReward(this.currentRewardsData,!0):this.setInteractableButtons(!0)):lt.showNotificationScreenWithLocalizedKey("error.rewardFail",2)})),function(){return s.apply(this,arguments)})},{key:"claimReward",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Cq.logLoginReward();var n=e.value*(t?2:1);this.node.scene.emit(Es.ADD_COINS,{coins:n,collectionAnimation:{animateTextOnly:!1}});var i=fie.getGameData();if(e.items&&i){var a=e.items.hint*(t?2:1),o=e.items.thunder*(t?2:1),r=e.items.storm*(t?2:1);fie.setGameData({items:{hint:i.items.hint+a,thunder:i.items.thunder+o,storm:i.items.storm+r,pliers:i.items.pliers}})}this.close()}},{key:"setInteractableButtons",value:function(e){this.claimButton.interactable=e,this.claimX2Button.interactable=e,this.closeButton.interactable=e,this.backgroundButton.interactable=e,this.continueButton.interactable=e}}]),v}(T)).prototype,"loadingRing",[vne,fne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$ne=a(qne.prototype,"claimButton",[gne,mne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wne=a(qne.prototype,"claimX2Button",[bne,wne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kne=a(qne.prototype,"closeButton",[Sne,kne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jne=a(qne.prototype,"backgroundButton",[Cne,Ene],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yne=a(qne.prototype,"continueButton",[Ane,Tne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xne=a(qne.prototype,"claimButtonScallableNode",[Pne,One],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jne=a(qne.prototype,"claimX2ButtonScallableNode",[Lne,Ine],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zne=a(qne.prototype,"continueButtonScallableNode",[Rne,_ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qne=a(qne.prototype,"dailyBlocks",[Dne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(qne.prototype,"updateScreenData",[Mne],Object.getOwnPropertyDescriptor(qne.prototype,"updateScreenData"),qne.prototype),a(qne.prototype,"runPopUpAnim",[Nne],Object.getOwnPropertyDescriptor(qne.prototype,"runPopUpAnim"),qne.prototype),a(qne.prototype,"showElements",[Bne],Object.getOwnPropertyDescriptor(qne.prototype,"showElements"),qne.prototype),a(qne.prototype,"runButtonPopUpAnim",[Fne],Object.getOwnPropertyDescriptor(qne.prototype,"runButtonPopUpAnim"),qne.prototype),a(qne.prototype,"runBlockPopUpAnim",[xne],Object.getOwnPropertyDescriptor(qne.prototype,"runBlockPopUpAnim"),qne.prototype),a(qne.prototype,"handleOnClaim",[zne],Object.getOwnPropertyDescriptor(qne.prototype,"handleOnClaim"),qne.prototype),a(qne.prototype,"claimReward",[Une],Object.getOwnPropertyDescriptor(qne.prototype,"claimReward"),qne.prototype),a(qne.prototype,"setInteractableButtons",[Gne],Object.getOwnPropertyDescriptor(qne.prototype,"setInteractableButtons"),qne.prototype),Hne=qne))||Hne);S._RF.pop(),S._RF.push({},"5a6aeaMAdtMGYA8B1wIuhDa","DayBlockRed",void 0);var gie,mie,bie,wie,Sie,kie,Cie,Eie,Aie,Tie,Pie,Oie,Lie,Iie,Rie,_ie;(0,C.ccclass)("DayBlockRed")(iie=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"ready"===e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.shadowColor=t,this.dayLabel.outlineColor=t}}]),r}(nie));S._RF.pop(),S._RF.push({},"6fed95tFh5MRKzFqaFB2Ts8","GetCoinScreen",void 0);var Die,Mie,Nie,Bie,Fie,xie,zie,Uie,Gie,Hie,qie,Vie,$ie,Wie,Kie,jie,Yie,Xie,Jie,Zie,Qie,eae,tae,nae,iae,aae,oae,rae,lae,sae,uae,cae=C.ccclass,dae=C.property,hae=C.requireComponent,pae=codex.event,yae=Ludex,vae=yae.Events,fae=yae.Plugins.Ads,gae=(void 0===fae?{}:fae).Types;gie=cae("GetCoinScreen"),mie=hae(iee),bie=Yn.required(),wie=dae(K),Sie=Yn.required(),kie=dae(G),Cie=Yn.required(),Eie=dae(G),Aie=Yn.required(),Tie=dae(q),gie(Pie=mie((Lie=a((Oie=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"quantityLabel",Lie,l(e)),r(e,"closeButtonComponent",Iie,l(e)),r(e,"getNowButtonComponent",Rie,l(e)),r(e,"particle",_ie,l(e)),e.handleOpeningScreen=function(t){console.log("GetCoinScreen.OPENING_SCREEN",t),e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.listenScreenEvents()}},{key:"onLoad",value:function(){EB.setNodeToLayer(this.particle,"Particles"),gae&&Xe.preloadAdsByType(gae.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){pae.on(vae.OPENING_SCREEN,this.handleOpeningScreen),pae.on(vae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){pae.off(vae.OPENING_SCREEN,this.handleOpeningScreen),pae.off(vae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return"screenName"in e&&(e.screenName===this.node.name&&(this.payload=e,!0))}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),pae.emit(vae.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Es.SHOW_UI)}},{key:"updateStatus",value:function(){this.updateCoinQuantity()}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("GetCoinScreen: screen not found")}},{key:"updateCoinQuantity",value:function(){var e=this.getQuantity();e&&this.updateQuantityLabel(e)}},{key:"updateQuantityLabel",value:function(e){this.quantityLabel.string="x".concat(e.toString())}},{key:"getQuantity",value:function(){var e=this.payload.screenData;return e&&"quantity"in e&&e.quantity&&"number"==typeof e.quantity?e.quantity:0}},{key:"handleAddCoin",value:function(){var e=this.getQuantity();this.node.scene.emit(Es.ADD_COINS,{coins:e,collectionAnimation:{animateTextOnly:!1},skipAnimation:!0}),this.close()}},{key:"handleGetNowButtonClicked",value:(s=o((function*(){je.stopAllSounds(),(yield Xe.showRewardVideoAdAsync())&&this.handleAddCoin()})),function(){return s.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),c}(T)).prototype,"quantityLabel",[bie,wie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iie=a(Oie.prototype,"closeButtonComponent",[Sie,kie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rie=a(Oie.prototype,"getNowButtonComponent",[Cie,Eie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_ie=a(Oie.prototype,"particle",[Aie,Tie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pie=Oie))||Pie);S._RF.pop(),S._RF.push({},"f016fTAlsNKRYkdu72AyCLI","GetItemScreen",void 0);var mae,bae,wae,Sae,kae,Cae,Eae,Aae,Tae,Pae,Oae=C.ccclass,Lae=C.property,Iae=codex,Rae=Iae.event,_ae=Iae.player,Dae=Iae.analytics,Mae=Iae.language,Nae=Ludex,Bae=Nae.Events,Fae=Nae.Utils.Array,xae=Nae.Plugins,zae=xae.Ads,Uae=(void 0===zae?{}:zae).Types,Gae=xae.Analytics,Hae=(void 0===Gae?{}:Gae).Events,qae=Object.values(nt);Die=Oae("GetItemScreen"),Mie=Lae({type:fe,group:"Item"}),Nie=Lae({type:F,group:"Item"}),Bie=Lae({type:ue,group:"Item"}),Fie=Lae({type:ue,group:"Item"}),xie=Lae({type:ue,group:"Item"}),zie=Lae({type:ue,group:"Item"}),Uie=Lae({type:K,group:"Title"}),Gie=Lae({type:th,group:"Title"}),Hie=Lae({type:K,group:"Description"}),qie=Lae({type:th,group:"Description"}),Vie=Lae(K),$ie=Lae({type:G,group:"Buttons"}),Wie=Lae({type:G,group:"Buttons"}),Kie=Lae({type:G,group:"Buttons"}),Die((Xie=a((Yie=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"itemFxPrefab",Xie,l(e)),r(e,"itemSprite",Jie,l(e)),r(e,"hintSpriteFrame",Zie,l(e)),r(e,"stormSpriteFrame",Qie,l(e)),r(e,"thunderSpriteFrame",eae,l(e)),r(e,"pliersSpriteFrame",tae,l(e)),r(e,"titleLabel",nae,l(e)),r(e,"titleLocalizer",iae,l(e)),r(e,"descriptionLabel",aae,l(e)),r(e,"descriptionLocalizer",oae,l(e)),r(e,"coinLabel",rae,l(e)),r(e,"closeButtonComponent",lae,l(e)),r(e,"buyItemButtonComponent",sae,l(e)),r(e,"getNowButtonComponent",uae,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("GetItemScreen: screen not found");e.validateEventPayload(t)&&e.validateEventPayloadData(t.screenData)&&(e.setInteractableButtons(!0),e.data=t.screenData,e.updateStatus(t.screenData))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents(),Uae&&Xe.preloadAdsByType(Uae.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Rae.on(Bae.OPENING_SCREEN,this.handleOpeningScreen),Rae.on(Bae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Rae.off(Bae.OPENING_SCREEN,this.handleOpeningScreen),Rae.off(Bae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"validateEventPayloadData",value:function(e){return!!e&&(!(!("item"in e)||!Fae.has(qae,e.item))&&("quantity"in e&&"number"==typeof e.quantity&&!("localizedMessageKey"in e&&void 0!==e.localizedMessageKey&&!Mae.hasTextKey(e.localizedMessageKey))))}},{key:"open",value:function(){this.node.scene.emit(Es.GAME_PAUSE)}},{key:"close",value:function(){this.setInteractableButtons(!1),Rae.emit(Bae.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Es.GAME_RESUME)}},{key:"updateStatus",value:function(e){this.updateItemIcon(e.item),this.updateTitle(e.item),e.localizedMessageKey&&this.updateDescription(e.localizedMessageKey),this.updateButtons(e.item)}},{key:"updateItemIcon",value:function(e){switch(e){case nt.HINT:this.itemSprite.spriteFrame=this.hintSpriteFrame;break;case nt.STORM:this.itemSprite.spriteFrame=this.stormSpriteFrame;break;case nt.THUNDER:this.itemSprite.spriteFrame=this.thunderSpriteFrame;break;case nt.PLIERS:this.itemSprite.spriteFrame=this.pliersSpriteFrame}}},{key:"getItemLocalizedTitleKey",value:function(e){switch(e){case nt.HINT:return"item.hint";case nt.STORM:return"item.storm";case nt.THUNDER:return"item.thunder";case nt.PLIERS:return"item.pliers"}}},{key:"updateTitle",value:function(e){this.titleLocalizer.key=this.getItemLocalizedTitleKey(e)}},{key:"updateDescription",value:function(e){this.descriptionLocalizer.key=e}},{key:"updateButtons",value:function(e){var t=this.canBuyItem(e);this.buyItemButtonComponent.node.active=t,this.getNowButtonComponent.node.active=!t,t&&(this.coinLabel.string="".concat(3*Sy[e]))}},{key:"canBuyItem",value:function(e){var t=_ae.getGameData();return!!t&&t.coins>=3*Sy[e]}},{key:"handleAddItem",value:(c=o((function*(){this.data.item&&(Hae&&Dae.event(Hae.EARN_ITEM,{item_name:this.data.item,value:3}),this.node.scene.emit(Es.ADD_ITEM,{animate:{startWorldPosition:this.itemSprite.node.worldPosition.clone()},item:this.data.item,quantity:3}))})),function(){return c.apply(this,arguments)})},{key:"handleGetNowButtonClicked",value:(u=o((function*(){this.stopAllSounds(),(yield Xe.showRewardVideoAdAsync())&&(this.handleAddItem(),this.close())})),function(){return u.apply(this,arguments)})},{key:"handleBuyItemButtonClicked",value:(s=o((function*(){this.node.scene.emit(Es.REMOVE_COINS,{coins:3*Sy[this.data.item],collectionAnimation:{animateTextOnly:!0}}),this.handleAddItem(),this.close()})),function(){return s.apply(this,arguments)})},{key:"stopAllSounds",value:function(){var e;null===(e=re("Sound"))||void 0===e||null===(e=e.getComponent(fn))||void 0===e||e.stopAll()}},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.buyItemButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),h}(T)).prototype,"itemFxPrefab",[Mie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jie=a(Yie.prototype,"itemSprite",[Nie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zie=a(Yie.prototype,"hintSpriteFrame",[Bie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qie=a(Yie.prototype,"stormSpriteFrame",[Fie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eae=a(Yie.prototype,"thunderSpriteFrame",[xie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tae=a(Yie.prototype,"pliersSpriteFrame",[zie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nae=a(Yie.prototype,"titleLabel",[Uie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iae=a(Yie.prototype,"titleLocalizer",[Gie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aae=a(Yie.prototype,"descriptionLabel",[Hie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oae=a(Yie.prototype,"descriptionLocalizer",[qie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rae=a(Yie.prototype,"coinLabel",[Vie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lae=a(Yie.prototype,"closeButtonComponent",[$ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sae=a(Yie.prototype,"buyItemButtonComponent",[Wie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uae=a(Yie.prototype,"getNowButtonComponent",[Kie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jie=Yie));S._RF.pop(),S._RF.push({},"4d6710xA7hAk65cGA4Dgdrc","GetRewardsScreen",void 0);var Vae,$ae=C.ccclass,Wae=C.requireComponent,Kae=C.property,jae=Ludex,Yae=jae.Events,Xae=jae.Plugins.Ads,Jae=(void 0===Xae?{}:Xae).Types,Zae=codex.event;mae=$ae("GetRewardsScreen"),bae=Wae(iee),wae=Kae(th),Sae=Kae(G),kae=Kae(G),mae(Cae=bae((Aae=a((Eae=function(a){n(h,a);var s,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),r(e,"countDownLocalizer",Aae,l(e)),r(e,"skipButton",Tae,l(e)),r(e,"claimButton",Pae,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents(),Jae&&Xe.preloadAdsByType(Jae.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Zae.on(Yae.OPENING_SCREEN,this.handleOpeningScreen),Zae.on(Yae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Zae.off(Yae.OPENING_SCREEN,this.handleOpeningScreen),Zae.off(Yae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.runCountdownAnimation()}},{key:"close",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setInteractableButtons(!1),Zae.emit(Yae.CLOSE_SCREEN,{screenName:this.node.name,screenData:{getRewardsSuccess:e,rewardsAdShown:t}})}},{key:"runCountdownAnimation",value:function(){var e=this,t=5;this.countDownLocalizer.setParams([t.toString()]);this.schedule((function(){t<=0?e.stopCountdownAnimation():(3===--t&&e.runButtonAnimation(),e.countDownLocalizer.setParams([t.toString()]))}),1,6)}},{key:"stopCountdownAnimation",value:(c=o((function*(){if(this.unscheduleAllCallbacks(),GameSDK.isGameSDK("Yandex"))this.close(!1);else{var e=yield Xe.showRewardedInterstitialAdAsync();this.close(e,!0)}})),function(){return c.apply(this,arguments)})},{key:"handleClickedSkip",value:function(){this.unscheduleAllCallbacks(),this.close(!1)}},{key:"handleClickedClaim",value:(u=o((function*(){this.unscheduleAllCallbacks();var e=yield Xe.showRewardedInterstitialAdAsync();this.close(e,!0)})),function(){return u.apply(this,arguments)})},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"runButtonAnimation",value:(s=o((function*(){var e=(GameSDK.isGameSDK("Yandex")?this.claimButton:this.skipButton).node.getComponent(B);if(e){var t=R(e).to(.3,{opacity:255});yield Ve.runTweenAsync(t),this.setInteractableButtons(!0)}})),function(){return s.apply(this,arguments)})},{key:"updateStatus",value:function(){var e=GameSDK.isGameSDK("Yandex");this.skipButton.node.active=!e,this.claimButton.node.active=e,this.countDownLocalizer.key=e?"ads.levelAfterT":"ads.adAfterT",this.skipButton.getComponent(B).opacity=0,this.claimButton.getComponent(B).opacity=0}},{key:"setInteractableButtons",value:function(e){this.skipButton.interactable=e,this.claimButton.interactable=e}}]),h}(T)).prototype,"countDownLocalizer",[wae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tae=a(Eae.prototype,"skipButton",[Sae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pae=a(Eae.prototype,"claimButton",[kae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cae=Eae))||Cae);S._RF.pop(),S._RF.push({},"bfe1eXch0ZMKIz1ofLKc2Iv","HardLevelScreen",void 0);var Qae,eoe,toe,noe,ioe,aoe,ooe,roe,loe,soe,uoe,coe,doe,hoe=C.ccclass,poe=C.requireComponent,yoe=Ludex,voe=yoe.Events,foe=yoe.Plugins.Ads,goe=(void 0===foe?{}:foe).Types,moe=codex.event;hoe("HardLevelScreen")(Vae=poe(iee)(Vae=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(r,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents(),goe&&Xe.preloadAdsByType(goe.REWARDED_INTERSTITIAL)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){moe.on(voe.OPENING_SCREEN,this.handleOpeningScreen),moe.on(voe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){moe.off(voe.OPENING_SCREEN,this.handleOpeningScreen),moe.off(voe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation()}},{key:"close",value:function(){lt.closeScreen(st.HARD_LEVEL_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}}]),r}(T))||Vae);S._RF.pop(),S._RF.push({},"2db0dg4dI9GCKCdFOMrBFsQ","GetRewardsEffect",void 0);var boe,woe,Soe,koe,Coe,Eoe,Aoe,Toe,Poe,Ooe,Loe,Ioe,Roe,_oe,Doe,Moe,Noe,Boe,Foe,xoe,zoe,Uoe,Goe,Hoe,qoe,Voe,$oe,Woe,Koe,joe,Yoe,Xoe,Joe,Zoe,Qoe,ere,tre,nre,ire,are,ore,rre,lre,sre,ure=C.ccclass,cre=C.property,dre=(Qae=ure("GetRewardsEffect"),eoe=cre(ue),toe=cre(ue),noe=cre(ue),ioe=cre(ue),aoe=cre(hT),Qae((loe=a((roe=function(a){n(d,a);var s,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"hint",loe,l(e)),r(e,"thunder",soe,l(e)),r(e,"storm",uoe,l(e)),r(e,"pliers",coe,l(e)),r(e,"particles",doe,l(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"playAnimation",value:(s=o((function*(e,t){var n=this,i=-30*(e.length-1)/2+90;yield Promise.all(e.map((function(e,a){var o=n.createSprite(e),r=i+30*a,l=.15*a;o.node.position=new V(300*Math.cos(r*(Math.PI/180)),300*Math.sin(r*(Math.PI/180)),0);var s=R(o.node);return s.delay(l),s.to(.6,{position:V.ZERO,scale:new V(.7,.7,.7)},{easing:"backIn"}),Ve.runTweenAsync(s).then((function(){t(),je.playSound(Qi.COLLECT_STARS),n.playExplodeEffect(),o.node.destroy()}))})))})),function(e,t){return s.apply(this,arguments)})},{key:"playExplodeEffect",value:function(){var e,t=u(this.particles);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.play()}}catch(e){t.e(e)}finally{t.f()}}},{key:"createSprite",value:function(e){var t=this.getSpriteFrame(e),n=(new q).addComponent(F);return n.spriteFrame=t,n.node.parent=this.node,n.node.scale=new V(1.5,1.5,1.5),n}},{key:"getSpriteFrame",value:function(e){switch(e){case"hint":return this.hint;case"thunder":return this.thunder;case"storm":return this.storm;case"pliers":return this.pliers;default:return null}}}]),d}(T)).prototype,"hint",[eoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),soe=a(roe.prototype,"thunder",[toe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uoe=a(roe.prototype,"storm",[noe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),coe=a(roe.prototype,"pliers",[ioe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),doe=a(roe.prototype,"particles",[aoe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ooe=roe))||ooe);S._RF.pop(),S._RF.push({},"31829DUddVEq6NgIYHvnI68","LevelCompleteScreen",void 0);var hre,pre,yre,vre,fre,gre,mre,bre,wre,Sre,kre,Cre=C.ccclass,Ere=C.property,Are=C.requireComponent,Tre=Ludex,Pre=Tre.Events,Ore=Tre.Utils,Lre=Ore.Valid,Ire=Ore.Signal,Rre=Tre.Plugins.Ads,_re=(void 0===Rre?{}:Rre).Types,Dre=codex,Mre=Dre.event,Nre=Dre.player;boe=Cre("LevelCompleteScreen"),woe=Are(iee),Soe=Ere(K),koe=Ere(K),Coe=Ere(B),Eoe=Ere(dre),Aoe=Ere({type:G,group:"Play Button"}),Toe=Ere({type:q,group:"Play Button"}),Poe=Ere({type:B,group:"Play Button"}),Ooe=Ere({type:q,group:"Play Button"}),Loe=Ere({type:q,group:"Play Button"}),Ioe=Ere({type:G,group:"Home Button"}),Roe=Ere({type:ce,group:"Coin Container"}),_oe=Ere({type:Tx,group:"Coin Container"}),Doe=Ere({type:ce,group:"Coin Container"}),Moe=Ere({type:de,group:"Coin Container"}),Noe=Ere({type:de,group:"Coin Container"}),Boe=Ere({type:hT,group:"Particles"}),Foe=Ere({type:hT,group:"Particles"}),xoe=Ere({type:hT,group:"Particles"}),zoe=Ere(B),Uoe=Ere(th),boe(Goe=woe((qoe=a((Hoe=function(a){n(m,a);var s,u,c,d,h,p,y,v,f,g=i(m);function m(){var e;t(this,m);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=g.call.apply(g,[this].concat(i))).level=1,e.coins=40,e.currentCoins=0,e.score=0,e.playAnimation=!1,e.getRewardsSuccess=!1,e.lookingForRewards=!1,e.playAnimationSignal=new Ni,r(e,"coinText",qoe,l(e)),r(e,"scoreText",Voe,l(e)),r(e,"lookingForRewardsText",$oe,l(e)),r(e,"getRewardsEffect",Woe,l(e)),r(e,"playButton",Koe,l(e)),r(e,"playBackground",joe,l(e)),r(e,"shineBackground",Yoe,l(e)),r(e,"hardLevelBackground",Xoe,l(e)),r(e,"buttonsContainer",Joe,l(e)),r(e,"homeButton",Zoe,l(e)),r(e,"coinAnimation",Qoe,l(e)),r(e,"coinContainer",ere,l(e)),r(e,"coinContainerAnimation",tre,l(e)),r(e,"coinContainerEnterClip",nre,l(e)),r(e,"coinContainerExitClip",ire,l(e)),r(e,"leftConfetti",are,l(e)),r(e,"rightConfetti",ore,l(e)),r(e,"bokehParticles",rre,l(e)),r(e,"welldoneUiOpacity",lre,l(e)),r(e,"welldoneLocalize",sre,l(e)),e.localizeVisibilityController=new Ire.SignalController,e.coinContainerShown=!1,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.hideTextUntilLocalized())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleParticleEnd=o((function*(){e.level&&(yield Ve.waitTweenAsync(.15)),yield Promise.all([e.animateCoin(),e.animateScore()]),e.lookingForRewards?yield e.handleLookingForRewards():yield e.animateVisibleButtonContainer(!0)})),e}return e(m,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.localizeVisibilityController.abort()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Mre.on(Pre.OPENING_SCREEN,this.handleOpeningScreen),Mre.on(Pre.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Mre.off(Pre.OPENING_SCREEN,this.handleOpeningScreen),Mre.off(Pre.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"hideTextUntilLocalized",value:(f=o((function*(){var e=this.localizeVisibilityController.renew();this.welldoneUiOpacity.opacity=0,yield this.welldoneLocalize.waitUntilLocalized(),e.aborted||(yield Ve.runTweenAsync(R(this.welldoneUiOpacity).to(.5,{opacity:255}),e))})),function(){return f.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){var t=null!=e?e:{},n=t.screenName,i=t.screenData;return n===this.node.name&&(!!Lre.isObject(i)&&(Lre.isNumber(i.level)&&(this.level=i.level,this.coins=this.level<5?my:by),Lre.isNumber(i.coins)&&(this.currentCoins=i.coins),Lre.isNumber(i.score)&&(this.score=i.score),this.playAnimation=!1,Lre.isObject(i.overrideAnimation)&&(this.playAnimation="LevelCompleteOpenScreen"===i.overrideAnimation.openScreen),this.lookingForRewards=!1,Lre.isBoolean(i.lookingForRewards)&&(this.lookingForRewards=i.lookingForRewards),this.getRewardsSuccess=!1,Lre.isBoolean(i.getRewardsSuccess)&&(this.getRewardsSuccess=i.getRewardsSuccess),!0))}},{key:"open",value:function(){this.updateStatus(),this.node.scene.emit(Es.HIDE_UI),this.tryPlayAnimation()}},{key:"close",value:(v=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.localizeVisibilityController.abort(),this.stopParticles(),this.coinContainerShown&&(this.coinContainerShown=!1,yield Ve.runAnimationAsync(this.coinContainerAnimation,this.coinContainerExitClip.name)),Mre.emit(Pre.CLOSE_SCREEN,{screenName:this.node.name,screenData:{canShowRewardsAd:e}}),this.node.scene.emit(Es.ABORT_COIN_ANIMATION)})),function(){return v.apply(this,arguments)})},{key:"updateStatus",value:function(){this.updateCoinContainer(),this.updateButtonsContainer(),this.lookingForRewardsText.opacity=0}},{key:"updateCoinContainer",value:function(){this.coinContainer.updateCoins({coins:this.currentCoins})}},{key:"updateButtonsContainer",value:function(){var e=Nre.getGameData();if(e){var t=this.level+1>e.totalLevel?this.level:this.level+1,n=t%5==0,i=13===t;this.playButton.node.active=!1,this.homeButton.node.active=!1,i?this.homeButton.node.active=!0:(this.playButton.node.active=!0,this.playBackground.active=!n,this.hardLevelBackground.active=n)}}},{key:"tryPlayAnimation",value:function(){if(this.playAnimation){this.screen.setScreenOpacity(255),this.coinText.string="x0",this.scoreText.string="0",this.animateVisibleButtonContainer(!1,!1),this.playParticles();var e=this.screen.getComponent(ce);e?e.once(ce.EventType.FINISHED,this.handleParticleEnd):this.handleParticleEnd()}else{if(this.animateVisibleButtonContainer(!0,!1),!this.getRewardsSuccess)return;this.getRewardsEffect.playAnimation(["storm","thunder"],this.triggerCollectItemPlayButtonAnimation.bind(this))}}},{key:"handleLookingForRewards",value:(y=o((function*(){yield this.animateLookingForRewards(),_re&&Xe.isReadyAdShowable(_re.REWARDED_INTERSTITIAL)?this.close(!0):this.animateVisibleButtonContainer(!0)})),function(){return y.apply(this,arguments)})},{key:"animateCoin",value:(p=o((function*(){var e=this;this.screen.container?(this.coinAnimation.play(),yield Ve.runOnUpdateAsync(this.node,.8,(function(t){var n=Se(0,e.coins,t),i=Math.floor(n);e.coinText.string="x".concat(i)})),yield this.animateCoinCollection(),this.coinText.string="x".concat(this.coins)):console.warn("LevelCompleteScreen: screen not found")})),function(){return p.apply(this,arguments)})},{key:"animateScore",value:(h=o((function*(){var e=this;Ve.runOnUpdateAsync(this.scoreText.node,.8,(function(t){var n=Se(0,e.score,t);e.scoreText.string="".concat(Math.floor(n))})),this.scoreText.node.setScale(1,1,1),this.scoreText.string="".concat(this.score)})),function(){return h.apply(this,arguments)})},{key:"animateCoinCollection",value:(d=o((function*(){this.coinContainerShown=!0,yield Ve.runAnimationAsync(this.coinContainerAnimation,this.coinContainerEnterClip.name),this.node.scene.emit(Es.ADD_COINS,{coins:this.coins,collectionAnimation:{floatDuration:.5,flyDuration:.5,animateTextOnly:!1,target:this.coinContainer}})})),function(){return d.apply(this,arguments)})},{key:"animateLookingForRewards",value:(c=o((function*(){var e=R(this.lookingForRewardsText);e.to(.25,{opacity:255},{easing:"linear"}).delay(.25),e.to(.25,{opacity:100},{easing:"linear"}).delay(.125),yield Ve.runTweenAsync(R(this.lookingForRewardsText).repeat(2,e).to(.25,{opacity:0},{easing:"linear"})),this.lookingForRewardsText.opacity=0})),function(){return c.apply(this,arguments)})},{key:"animateVisibleButtonContainer",value:(u=o((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e?1:0;if(t){this.playAnimationSignal.abort();var i=new Ni;this.playAnimationSignal=i;var a=e?0:1;this.buttonsContainer.setScale(a,a,this.buttonsContainer.scale.z);var o=R(this.buttonsContainer).to(.5,{scale:new V(n,n,1)},{easing:"backOut"});e||this.setInteractableButtons(!1),yield Ve.runTweenAsync(o,i),e&&this.setInteractableButtons(!0)}else this.setInteractableButtons(e),this.buttonsContainer.setScale(n,n,this.buttonsContainer.scale.z)})),function(e){return u.apply(this,arguments)})},{key:"triggerCollectItemPlayButtonAnimation",value:(s=o((function*(){this.playAnimationSignal.abort();var e=new Ni;this.playAnimationSignal=e;var t=R(this.buttonsContainer).to(.08,{scale:new V(.95,1.05,1)}).to(.08,{scale:new V(1.05,.95,1)}).to(.08,{scale:new V(1,1,1)}),n=R(this.shineBackground).to(.08,{opacity:50},{easing:"quadOut"}).to(.08,{opacity:0},{easing:"quadIn"});yield Promise.all([Ve.runTweenAsync(t,e),Ve.runTweenAsync(n,e)])})),function(){return s.apply(this,arguments)})},{key:"playParticles",value:function(){var e=Ze.isLandscape(),t=e?50:30,n=e?5e3:2e3,i=e?15e3:1e4,a=e?40:60,o=e?110:100,r=e?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=t,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=n,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=i,this.leftConfetti.shapeModule.angle=a,this.rightConfetti.shapeModule.angle=o,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=r,this.leftConfetti.play(),this.rightConfetti.play(),this.bokehParticles.play()}},{key:"stopParticles",value:function(){this.leftConfetti.stop(),this.rightConfetti.stop(),this.bokehParticles.stop()}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.homeButton.interactable=e}},{key:"handleClickedPlay",value:function(){this.setInteractableButtons(!1),this.close()}},{key:"handleClickedHome",value:function(){this.setInteractableButtons(!1),this.close()}}]),m}(T)).prototype,"coinText",[Soe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Voe=a(Hoe.prototype,"scoreText",[koe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$oe=a(Hoe.prototype,"lookingForRewardsText",[Coe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Woe=a(Hoe.prototype,"getRewardsEffect",[Eoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Koe=a(Hoe.prototype,"playButton",[Aoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),joe=a(Hoe.prototype,"playBackground",[Toe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yoe=a(Hoe.prototype,"shineBackground",[Poe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xoe=a(Hoe.prototype,"hardLevelBackground",[Ooe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Joe=a(Hoe.prototype,"buttonsContainer",[Loe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zoe=a(Hoe.prototype,"homeButton",[Ioe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qoe=a(Hoe.prototype,"coinAnimation",[Roe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ere=a(Hoe.prototype,"coinContainer",[_oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tre=a(Hoe.prototype,"coinContainerAnimation",[Doe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nre=a(Hoe.prototype,"coinContainerEnterClip",[Moe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ire=a(Hoe.prototype,"coinContainerExitClip",[Noe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),are=a(Hoe.prototype,"leftConfetti",[Boe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ore=a(Hoe.prototype,"rightConfetti",[Foe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rre=a(Hoe.prototype,"bokehParticles",[xoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lre=a(Hoe.prototype,"welldoneUiOpacity",[zoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sre=a(Hoe.prototype,"welldoneLocalize",[Uoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Goe=Hoe))||Goe);S._RF.pop(),S._RF.push({},"46b8aK6CThLtpMhZPEfDrNs","LoadingFullScreen",void 0);var Bre,Fre,xre,zre,Ure,Gre=C.ccclass,Hre=C.property,qre=["interMsg.reviveAd","interMsg.doubleAd","interMsg.ranked","interMsg.friendChallenge","interMsg.bragChallenge","interMsg.clearTiles","interMsg.beatClock","interMsg.clearBombs","interMsg.seasonPack","interMsg.collectStars","interMsg.competeInLb","interMsg.competeWithFriends","interMsg.thunder","interMsg.hint","interMsg.pliers","interMsg.tornado","interMsg.coins","interMsg.seasonTiles","interMsg.dailyLogin","interMsg.levelUp","interMsg.seasonRewards"],Vre=(hre=Gre("LoadingFullScreen"),pre=Yn.required(),yre=Hre(ie),vre=Yn.required(),fre=Yn.required(),gre=Hre(th),hre((wre=a((bre=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"progressBar",wre,l(e)),r(e,"uiOpacity",Sre,l(e)),r(e,"loadingLabelLocalizer",kre,l(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),Yn.validateRequiredProperties(this)}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0,this.progressBar.progress=0}},{key:"show",value:(u=o((function*(e){this.uiOpacity.opacity=0,this.progressBar.progress=0;var t=R(this.uiOpacity).to(.5,{opacity:255},{easing:"cubicOut"}),n=R(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"});this.runLoadingTextAnimation(),Ve.runTweenAsync(t),yield Ve.runTweenAsync(n)})),function(e){return u.apply(this,arguments)})},{key:"hide",value:(s=o((function*(e){if(this.uiOpacity&&this.progressBar){this.uiOpacity.opacity=255,this.progressBar.progress=.9;var t=R(this.uiOpacity).to(.5,{opacity:0},{easing:"cubicIn"}),n=R(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"});this.runLoadingTextAnimation(),yield Ve.runTweenAsync(n),this.stopLoadingTextAnimation(),yield Ve.runTweenAsync(t),this.node.active=!1}})),function(e){return s.apply(this,arguments)})},{key:"runLoadingTextAnimation",value:function(){var e=this;this.updateHintText(),this.schedule((function(){return e.updateHintText()}),5)}},{key:"updateHintText",value:function(){if(this.loadingLabelLocalizer){var e=this.getHintText();e&&(this.loadingLabelLocalizer.key=e)}}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"getHintText",value:function(){return qre[Math.floor(Math.random()*qre.length)]}}]),d}(T)).prototype,"progressBar",[pre,yre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sre=a(bre.prototype,"uiOpacity",[vre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kre=a(bre.prototype,"loadingLabelLocalizer",[fre,gre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mre=bre))||mre);S._RF.pop(),S._RF.push({},"74caciRBKZLu7ymXYJK2GYy","Loading",void 0);var $re,Wre=C.ccclass,Kre=C.property;Bre=Wre("Loading"),Fre=Kre(fe),Bre((Ure=a((zre=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"loadingPrefab",Ure,l(e)),e.loadingNode=null,e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){A.isPersistRootNode(this.node)||A.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=re("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=ye(this.loadingPrefab));var n=ye._clone(this.loadingNode);this.loadingFullScreen=n.getComponent(Vre),null===(e=re("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(u=o((function*(e){this.createLoadingFullScreen(),yield this.loadingFullScreen.show(e)})),function(e){return u.apply(this,arguments)})},{key:"hide",value:(s=o((function*(e){this.loadingFullScreen&&(yield this.loadingFullScreen.hide(e))})),function(e){return s.apply(this,arguments)})}]),d}(T)).prototype,"loadingPrefab",[Fre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xre=zre));S._RF.pop(),S._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var jre,Yre,Xre,Jre,Zre,Qre,ele,tle,nle,ile,ale=C.ccclass,ole=C.disallowMultiple,rle=C.requireComponent,lle=Ludex.Events,sle=codex.event;ale("LoadingScreen")($re=ole($re=rle(iee)($re=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).isClosing=!1,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.isClosing=!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.isClosing=!0,e.unscheduleAllCallbacks())},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1,e.isClosing=!1)},e.handleOnCloseScreen=function(){lt.closeScreen(st.LOADING_SCREEN)},e}return e(r,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.validateRequiredProperties(this,r)}},{key:"listenScreenEvents",value:function(){sle.on(lle.OPENING_SCREEN,this.handleOpeningScreen),sle.on(lle.OPENED_SCREEN,this.handleOpenedScreen),sle.on(lle.CLOSING_SCREEN,this.handleClosingScreen),sle.on(lle.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){sle.off(lle.OPENING_SCREEN,this.handleOpeningScreen),sle.off(lle.OPENED_SCREEN,this.handleOpenedScreen),sle.off(lle.CLOSING_SCREEN,this.handleClosingScreen),sle.off(lle.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled&&!this.isClosing){var e=this.screen.data.duration;e&&e>0&&this.scheduleOnce(this.handleOnCloseScreen,e)}}}]),r}(T))||$re)||$re);S._RF.pop(),S._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var ule,cle,dle,hle,ple,yle,vle,fle,gle,mle,ble,wle,Sle,kle,Cle,Ele,Ale=C.ccclass,Tle=C.disallowMultiple,Ple=C.requireComponent,Ole=C.property,Lle=Ludex,Ile=Lle.Events,Rle=Lle.Utils.Valid,_le=codex.event;jre=Ale("NotificationScreen"),Yre=Ple(iee),Xre=Ole(K),Jre=Ole(th),Zre=Ole(G),jre(Qre=Tle(Qre=Yre((tle=a((ele=function(a){n(s,a);var o=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),r(e,"message",tle,l(e)),r(e,"messageLocalizer",nle,l(e)),r(e,"touchZone",ile,l(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.screen.backgroundMaskButton.interactable=e.enableCloseOnTouch)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return e(s,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.screen=this.getComponent(iee),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){_le.on(Ile.OPENING_SCREEN,this.handleOpeningScreen),_le.on(Ile.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){_le.off(Ile.OPENING_SCREEN,this.handleOpeningScreen),_le.off(Ile.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;Rle.isObject(t)?(void 0!==t.message?this.setMessageManually(t.message):void 0!==t.localizedMessageKey&&this.setMessageUsingLocalizeKey(t.localizedMessageKey),t.duration&&t.duration>0&&this.scheduleOnce((function(){lt.closeScreen(st.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"setMessageManually",value:function(e){this.messageLocalizer.enabled=!1,this.message.string=e}},{key:"setMessageUsingLocalizeKey",value:function(e){this.messageLocalizer.enabled=!0,this.messageLocalizer.key=e}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),this.screen.backgroundMaskButton.interactable=!1,lt.closeScreen(st.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),s}(T)).prototype,"message",[Xre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nle=a(ele.prototype,"messageLocalizer",[Jre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ile=a(ele.prototype,"touchZone",[Zre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qre=ele))||Qre)||Qre);S._RF.pop(),S._RF.push({},"7129ca71jRMGaTHxWhEL4F4","QuitLevelScreen",void 0);var Dle,Mle,Nle,Ble,Fle,xle,zle,Ule,Gle,Hle,qle,Vle,$le,Wle,Kle,jle,Yle,Xle,Jle,Zle,Qle,ese,tse=C.ccclass,nse=C.property,ise=C.requireComponent,ase=Ludex,ose=ase.Events,rse=ase.Match.Modes,lse=codex,sse=lse.event,use=lse.storage;ule=tse("QuitLevelScreen"),cle=ise(iee),dle=nse(K),hle=nse(K),ple=nse(G),yle=nse(K),vle=nse(K),fle=nse(G),ule(gle=cle((ble=a((mle=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"singleDescription",ble,l(e)),r(e,"tournamentDescription",wle,l(e)),r(e,"quitButton",Sle,l(e)),r(e,"quitLabel",kle,l(e)),r(e,"endLabel",Cle,l(e)),r(e,"continueButton",Ele,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(d,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){sse.on(ose.OPENING_SCREEN,this.handleOpeningScreen),sse.on(ose.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){sse.off(ose.OPENING_SCREEN,this.handleOpeningScreen),sse.off(ose.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),lt.closeScreen(st.QUIT_LEVEL_SCREEN),this.node.scene.emit(Es.SHOW_UI),this.node.scene.emit(Es.GAME_RESUME)}},{key:"updateStatus",value:function(){var e=iv.getMatchMode()===rse.TOURNAMENT;this.singleDescription.node.active=!e,this.tournamentDescription.node.active=e,this.quitLabel.node.active=!e,this.endLabel.node.active=e}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.quitButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedContinue",value:function(){this.close()}},{key:"handleClickedQuit",value:(u=o((function*(){this.setInteractableButtons(!1),iv.getMatchMode()===rse.TOURNAMENT&&(yield this.handleTournamentQuit()),this.node.scene.emit(Es.GAME_EXIT)})),function(){return u.apply(this,arguments)})},{key:"handleTournamentQuit",value:(s=o((function*(){var e,t,n=null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{},i=n.score,a=void 0===i?0:i,o=n.level,r=void 0===o?1:o,l=n.tournamentId,s=a>(null!==(t=use.getStorageData("tournament","previousScore"))&&void 0!==t?t:0);s&&l&&ut.saveTournamentProgress(r,a,l),use.setStorageData("tournament","animateTournamentLeader",s),yield iv.finishMatchAsync()})),function(){return s.apply(this,arguments)})}]),d}(T)).prototype,"singleDescription",[dle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wle=a(mle.prototype,"tournamentDescription",[hle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sle=a(mle.prototype,"quitButton",[ple],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kle=a(mle.prototype,"quitLabel",[yle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cle=a(mle.prototype,"endLabel",[vle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ele=a(mle.prototype,"continueButton",[fle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gle=mle))||gle);S._RF.pop(),S._RF.push({},"85907Tnp/NBq7myeciP/4h3","RescuesScreen",void 0);var cse,dse,hse,pse,yse,vse,fse,gse,mse,bse,wse,Sse,kse,Cse,Ese,Ase,Tse,Pse,Ose,Lse,Ise,Rse,_se,Dse,Mse,Nse,Bse,Fse,xse,zse,Use=C.ccclass,Gse=C.property,Hse=C.disallowMultiple,qse=C.requireComponent,Vse=Ludex,$se=Vse.Events,Wse=Vse.Plugins.Ads,Kse=(void 0===Wse?{}:Wse).Types,jse=codex,Yse=jse.event,Xse=jse.player;Dle=Use("RescuesScreen"),Mle=qse(iee),Nle=Gse(B),Ble=Gse([q]),Fle=Gse(th),xle=Gse(th),zle=Gse(q),Ule=Gse(q),Gle=Gse(ce),Hle=Gse(q),qle=Gse(q),Dle(Vle=Hse(Vle=Mle((Wle=a(($le=function(a){n(v,a);var s,u,c,d,h,p,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),r(e,"adOpacity",Wle,l(e)),r(e,"animNodes",Kle,l(e)),r(e,"titleLocalizer",jle,l(e)),r(e,"descriptionLocalizer",Yle,l(e)),r(e,"timer",Xle,l(e)),r(e,"bomb",Jle,l(e)),r(e,"bombAnim",Zle,l(e)),r(e,"replayButton",Qle,l(e)),r(e,"buyTimeButton",ese,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("RescuesScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents(),Kse&&Xe.preloadAdsByType(Kse.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Yse.on($se.OPENING_SCREEN,this.handleOpeningScreen),Yse.on($se.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Yse.off($se.OPENING_SCREEN,this.handleOpeningScreen),Yse.off($se.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name&&(this.payload=e,!0)}},{key:"open",value:(p=o((function*(){je.turnOffMusic(),this.resetState(),this.runOpenAnimation(),this.node.scene.emit(Es.HIDE_UI)})),function(){return p.apply(this,arguments)})},{key:"close",value:function(e){je.turnUpMusic(),Yse.emit($se.CLOSE_SCREEN,{screenName:this.node.name,screenData:e})}},{key:"resetState",value:function(){var e,t=(null===(e=this.payload.screenData)||void 0===e?void 0:e.failKey)===ov;this.titleLocalizer.key=t?"game.boom":"game.timesUp",this.descriptionLocalizer.key=t?"game.bombDesc":"game.timesUpDesc",this.timer.active=!t,this.bomb.active=t,t&&this.bombAnim.play();var n=Xse.getGameData();if(n){var i=n.coins>=ky;this.replayButton.active=!i,this.buyTimeButton.active=i,this.adOpacity.opacity=0}}},{key:"runOpenAnimation",value:(h=o((function*(){var e=this;this.screen.container?(yield Promise.all(this.animNodes.map((function(t,n){return e.runAppearTween(t,.1*n)}))),yield this.runShowAdContainer()):console.warn("TimeUpScreen: screen not found")})),function(){return h.apply(this,arguments)})},{key:"runAppearTween",value:(d=o((function*(e,t){yield Ve.runTweenAsync(R(e).set({scale:new V(0,0,0)}).delay(t).to(1,{scale:new V(1,1,1)},{easing:function(e){return Ve.elasticOut(e,.1,.45)}}))})),function(e,t){return d.apply(this,arguments)})},{key:"runShowAdContainer",value:(c=o((function*(){var e=R(this.adOpacity);e.delay(1),e.to(.5,{opacity:255}),yield Ve.runTweenAsync(e)})),function(){return c.apply(this,arguments)})},{key:"handleClickReplay",value:(u=o((function*(){var e=this.screen.data.level;GameSDK.isGameSDK("Yandex")&&(yield Xe.showInterstitialAdAsync({forLevel:e})),this.close()})),function(){return u.apply(this,arguments)})},{key:"handleClickBuyTime",value:function(){this.node.scene.emit(Es.REMOVE_COINS,{coins:ky,collectionAnimation:{animateTextOnly:!0}}),this.close({rescue:!0})}},{key:"handleClickAd",value:(s=o((function*(){(yield Xe.showRewardVideoAdAsync())&&this.close({rescue:!0})})),function(){return s.apply(this,arguments)})},{key:"handleClickClose",value:function(){var e,t,n=(null!==(e=null===(t=Xse.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1)>=13;this.close({customMode:n})}}]),v}(T)).prototype,"adOpacity",[Nle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kle=a($le.prototype,"animNodes",[Ble],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),jle=a($le.prototype,"titleLocalizer",[Fle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yle=a($le.prototype,"descriptionLocalizer",[xle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xle=a($le.prototype,"timer",[zle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jle=a($le.prototype,"bomb",[Ule],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zle=a($le.prototype,"bombAnim",[Gle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qle=a($le.prototype,"replayButton",[Hle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ese=a($le.prototype,"buyTimeButton",[qle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vle=$le))||Vle)||Vle);S._RF.pop(),S._RF.push({},"726c9oCUUBDpboDnHRz7SGZ","PauseScreen",void 0);var Jse,Zse,Qse,eue,tue,nue,iue,aue,oue,rue,lue,sue,uue,cue,due,hue,pue,yue,vue,fue,gue,mue,bue,wue,Sue,kue,Cue,Eue,Aue=C.ccclass,Tue=C.property,Pue=C.requireComponent,Oue=Ludex,Lue=Oue.Events,Iue=Oue.Utils.Device,Rue=Oue.Match.Modes,_ue=codex,Due=_ue.player,Mue=_ue.event;cse=Aue("PauseScreen"),dse=Pue(iee),hse=Tue(q),pse=Tue(q),yse=Tue(q),vse=Tue(C0),fse=Tue(C0),gse=Tue(C0),mse=Tue(G),bse=Tue({type:G,group:"Button Container"}),wse=Tue({type:G,group:"Button Container"}),Sse=Tue({type:G,group:"Button Container"}),kse=Tue({type:G,group:"Button Container"}),Cse=Tue({type:G,group:"Button Container"}),Ese=Tue(B),cse(Ase=dse((Pse=a((Tse=function(a){n(p,a);var s,u,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"musicSetting",Pse,l(e)),r(e,"soundSetting",Ose,l(e)),r(e,"vibrateSetting",Lse,l(e)),r(e,"musicSwitch",Ise,l(e)),r(e,"soundSwitch",Rse,l(e)),r(e,"vibrateSwitch",_se,l(e)),r(e,"closeButtonComponent",Dse,l(e)),r(e,"resumeButton",Mse,l(e)),r(e,"restartButton",Nse,l(e)),r(e,"challengeFriendsButton",Bse,l(e)),r(e,"createShortcutButton",Fse,l(e)),r(e,"customModeButton",xse,l(e)),r(e,"containerUIOpacity",zse,l(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus(),e.updateButtonsStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){if("code"in t){var n=t.code,i=Iy.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(Iy.Events.UNLOCK_DEV_TOOLS),e.node.off(Iy.Events.TRIGGER_UNLOCK_KEY)))}},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(G),n=e.vibrateSetting.getComponentInChildren(C0),i=e.vibrateSetting.getComponentInChildren(qr);if(t&&n&&i)if(Iue.isMobile()){var a,o=null!==(a=Due.getPlayerSetting("vibrate"))&&void 0!==a&&a;n.setEnabled(o)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(p,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Mue.on(Lue.OPENING_SCREEN,this.handleOpeningScreen),Mue.on(Lue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Mue.off(Lue.OPENING_SCREEN,this.handleOpeningScreen),Mue.off(Lue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(Iy.Events.TRIGGER_UNLOCK_KEY),this.node.on(Iy.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(Iy.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(Iy.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(Iy.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.node.emit(Iy.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(Iy.Events.TRIGGER_RESET_SEQUENCE),lt.closeScreen(st.PAUSE_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=Due.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=Due.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=Due.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.resumeButton.interactable=e,this.closeButtonComponent.interactable=e,this.restartButton.interactable=e,this.challengeFriendsButton.interactable=e,this.screen.backgroundMaskButton.interactable=e,this.customModeButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e,t=GameSDK.isGameSDK("Yandex"),n=iv.getMatchMode()===Rue.SINGLE||iv.getMatchMode()===lv,i=(null!==(e=Due.getGameData())&&void 0!==e?e:{}).level,a=void 0===i?1:i;this.setActiveButton(this.challengeFriendsButton,!t),this.setActiveButton(this.createShortcutButton,t&&Iue.isDesktop()),this.setActiveButton(this.customModeButton,n&&a>=13),this.setActiveButton(this.resumeButton,!n)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(Due.setSetting("music",e),this.node.emit(Iy.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e){var t=iv.getMatchMode();je.playMusic(t===Rue.TOURNAMENT?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC)}else je.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();Due.setSetting("sound",e),this.node.emit(Iy.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();Due.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedResume",value:function(){this.resumeGame()}},{key:"handleClickedCustomMode",value:(d=o((function*(){var e;this.setVisible(!1);var t=(null!==(e=(yield lt.openScreenAndWaitForClose(st.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==e?e:{}).customMode;if(!t)return this.node.scene.emit(Es.HIDE_UI),void this.setVisible(!0);this.close(),this.node.scene.emit(Es.GAME_RESUME),this.node.scene.emit(Es.GAME_REPLAY,t?lv:void 0)})),function(){return d.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.resumeGame()}},{key:"handleClickedRestart",value:(c=o((function*(){var e;this.close();var t=(null!==(e=Due.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;iv.getMatchMode()===lv?yield Xe.showRewardedInterstitialAdAsync({showError:!1}):yield Xe.showInterstitialAdAsync({forLevel:n}),iv.getMatchMode()!==Rue.TOURNAMENT?(this.node.scene.emit(Es.GAME_RESUME),this.node.scene.emit(Es.GAME_REPLAY)):lt.openScreen(st.START_OVER_SCREEN)})),function(){return c.apply(this,arguments)})},{key:"handleClickedChallengeFriends",value:(u=o((function*(){if(GameSDK.isGameSDK("MsGames"))return lt.showLoadingScreen(),yield GameSDK.extra.shareAsync(),void lt.closeLoadingScreen();this.close(),this.node.scene.emit(Es.CHALLENGE_FRIENDS)})),function(){return u.apply(this,arguments)})},{key:"handleClickedCreateShortcut",value:(s=o((function*(){try{yield GameSDK.extra.checkAndCreateShortcutAsync()}catch(e){lt.showNotificationScreenWithLocalizedKey("error.shortcutFail")}})),function(){return s.apply(this,arguments)})},{key:"resumeGame",value:function(){this.close(),this.node.scene.emit(Es.GAME_RESUME),this.node.scene.emit(Es.SHOW_UI)}},{key:"setVisible",value:function(e){this.containerUIOpacity.opacity=e?255:0}}]),p}(T)).prototype,"musicSetting",[hse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ose=a(Tse.prototype,"soundSetting",[pse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lse=a(Tse.prototype,"vibrateSetting",[yse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ise=a(Tse.prototype,"musicSwitch",[vse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rse=a(Tse.prototype,"soundSwitch",[fse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_se=a(Tse.prototype,"vibrateSwitch",[gse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dse=a(Tse.prototype,"closeButtonComponent",[mse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mse=a(Tse.prototype,"resumeButton",[bse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nse=a(Tse.prototype,"restartButton",[wse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bse=a(Tse.prototype,"challengeFriendsButton",[Sse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fse=a(Tse.prototype,"createShortcutButton",[kse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xse=a(Tse.prototype,"customModeButton",[Cse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zse=a(Tse.prototype,"containerUIOpacity",[Ese],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ase=Tse))||Ase);S._RF.pop(),S._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var Nue,Bue,Fue,xue,zue,Uue,Gue,Hue,que,Vue,$ue,Wue,Kue,jue,Yue,Xue,Jue,Zue,Que,ece,tce,nce,ice,ace=C.ccclass,oce=C.property,rce=C.requireComponent,lce=Ludex,sce=lce.Events,uce=lce.Utils.Device,cce=lce.Match.Modes,dce=lce.Configs.Debugger.MonitorError,hce=lce.Plugins.Analytics,pce=(void 0===hce?{}:hce).Events,yce=codex,vce=yce.player,fce=yce.event,gce=yce.monitorError,mce=yce.frameCapture,bce=yce.analytics;Jse=ace("SettingsScreen"),Zse=rce(iee),Qse=oce({type:q,group:"SettingContainer"}),eue=oce({type:q,group:"SettingContainer"}),tue=oce({type:q,group:"SettingContainer"}),nue=oce({type:C0,group:"Switch Container"}),iue=oce({type:C0,group:"Switch Container"}),aue=oce({type:C0,group:"Switch Container"}),oue=oce(G),rue=oce({type:G,group:"Button Container"}),lue=oce({type:G,group:"Button Container"}),sue=oce({type:G,group:"Button Container"}),uue=oce({type:G,group:"Button Container"}),cue=oce({type:G,group:"Button Container"}),Jse(due=Zse((pue=a((hue=function(a){n(y,a);var s,u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"musicSetting",pue,l(e)),r(e,"soundSetting",yue,l(e)),r(e,"vibrateSetting",vue,l(e)),r(e,"musicSwitch",fue,l(e)),r(e,"soundSwitch",gue,l(e)),r(e,"vibrateSwitch",mue,l(e)),r(e,"closeButton",bue,l(e)),r(e,"reportButton",wue,l(e)),r(e,"shareButton",Sue,l(e)),r(e,"inviteFriendsButton",kue,l(e)),r(e,"feedbackButton",Cue,l(e)),r(e,"createShortcutButton",Eue,l(e)),e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(G),n=e.vibrateSetting.getComponentInChildren(C0),i=e.vibrateSetting.getComponentInChildren(qr);if(t&&n&&i)if(uce.isMobile()){var a,o=null!==(a=vce.getPlayerSetting("vibrate"))&&void 0!==a&&a;n.setEnabled(o)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(y,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.listenScreenEvents(),this.updateButtonsStatus()}},{key:"onDestroy",value:function(){this.unlistenScreenEvents()}},{key:"listenScreenEvents",value:function(){fce.on(sce.OPENING_SCREEN,this.handleOpeningScreen),fce.on(sce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unlistenScreenEvents",value:function(){fce.off(sce.OPENING_SCREEN,this.handleOpeningScreen),fce.off(sce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.node.emit(Iy.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(Iy.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Es.SHOW_UI),lt.closeScreen(st.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=vce.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=vce.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=vce.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.closeButton.interactable=e,this.reportButton.interactable=e,this.shareButton.interactable=e,this.inviteFriendsButton.interactable=e,this.feedbackButton.interactable=e,this.createShortcutButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e=GameSDK.isGameSDK("Yandex"),t=GameSDK.isGameSDK("MsGames");this.setActiveButton(this.reportButton,dce.Feedback),this.setActiveButton(this.shareButton,!e&&!t),this.setActiveButton(this.inviteFriendsButton,!e),this.setActiveButton(this.feedbackButton,e),this.setActiveButton(this.createShortcutButton,e&&uce.isDesktop()||t)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(vce.setSetting("music",e),e){var t=iv.getMatchMode();je.playMusic(t===cce.TOURNAMENT?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC)}else je.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();vce.setSetting("sound",e)}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();vce.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedReport",value:function(){null==gce||gce.feedbackAsync()}},{key:"handleClickedShare",value:(h=o((function*(){if(GameSDK.isGameSDK("FacebookInstant"))return lt.showLoadingScreen(),GameSDK.extra.isNEZP()?yield jM.shareBestScoreWithOverlay():yield GameSDK.extra.shareBestScoreAsync(),void lt.closeLoadingScreen();this.close()})),function(){return h.apply(this,arguments)})},{key:"handleClickedInviteFriends",value:(d=o((function*(){lt.showLoadingScreen(),GameSDK.isGameSDK("MsGames")&&(yield GameSDK.extra.shareAsync()),GameSDK.isGameSDK("FacebookInstant")&&(yield this.inviteWithBestScoreFbInstant()),lt.closeLoadingScreen()})),function(){return d.apply(this,arguments)})},{key:"handleClickedFeedback",value:function(){var e="error.ratingFail";"ratingAsync"in GameSDK.extra?GameSDK.extra.ratingAsync().catch((function(t){if("code"in t){switch(t.code){case"NO_AUTH":e="error.ratingNoAuth";break;case"GAME_RATED":e="error.ratingGameRated"}lt.showNotificationScreenWithLocalizedKey(e)}else lt.showNotificationScreenWithLocalizedKey(e)})):lt.showNotificationScreenWithLocalizedKey(e)}},{key:"handleClickedCreateShortcut",value:(c=o((function*(){try{yield GameSDK.extra.checkAndCreateShortcutAsync()}catch(e){lt.showNotificationScreenWithLocalizedKey("error.shortcutFail")}})),function(){return c.apply(this,arguments)})},{key:"inviteWithBestScoreFbInstant",value:(u=o((function*(){GameSDK.isGameSDK("FacebookInstant")&&(GameSDK.extra.isNEZP()?yield jM.inviteFriendsWithOverlay():yield this.inviteWithBestScoreAsync())})),function(){return u.apply(this,arguments)})},{key:"inviteWithBestScoreAsync",value:(s=o((function*(){if(GameSDK.isGameSDK("FacebookInstant"))try{if(!mce)throw new Error("FrameCapture not found");var e=vce.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=(e.data||{}).score,o=yield mce.renderAsync("share-score-with-invite",{playerId:t,playerPhoto:i,playerScore:a});if(null===o)throw new Error("Failed to render share score wideframe");yield GameSDK.extra.inviteAsync({text:{default:"Great! I got a new best score!",localizations:{vi_VN:"Tht tuyt! Mnh va ph k lc ny!"}},image:o,data:{playerId:t,playerName:n,playerPhoto:i,type:"share_invite"}}),pce&&bce.event(pce.INVITE,{invite_content_type:"BestScore",success:!0})}catch(e){pce&&bce.event(pce.INVITE,{invite_content_type:"BestScore",success:!1}),console.warn(e)}})),function(){return s.apply(this,arguments)})}]),y}(T)).prototype,"musicSetting",[Qse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yue=a(hue.prototype,"soundSetting",[eue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vue=a(hue.prototype,"vibrateSetting",[tue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fue=a(hue.prototype,"musicSwitch",[nue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gue=a(hue.prototype,"soundSwitch",[iue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mue=a(hue.prototype,"vibrateSwitch",[aue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bue=a(hue.prototype,"closeButton",[oue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wue=a(hue.prototype,"reportButton",[rue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sue=a(hue.prototype,"shareButton",[lue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kue=a(hue.prototype,"inviteFriendsButton",[sue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cue=a(hue.prototype,"feedbackButton",[uue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eue=a(hue.prototype,"createShortcutButton",[cue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),due=hue))||due);S._RF.pop(),S._RF.push({},"891d37NJ6lLdp3CNLPHxZ6d","StarChest",void 0);var wce,Sce,kce,Cce,Ece,Ace,Tce,Pce,Oce,Lce,Ice,Rce,_ce,Dce,Mce,Nce,Bce,Fce,xce,zce,Uce=C.ccclass,Gce=C.property,Hce=(Nue=Uce("StarChest"),Bue=Gce(F),Fue=Gce(B),xue=Gce(ee),zue=Gce(B),Uue=Gce(B),Gue=Gce({type:L,readonly:!0,displayName:"Starting Offset X",group:"Reward Animations"}),Hue=Gce({type:L,readonly:!0,displayName:"Starting Offset Y",group:"Reward Animations"}),que=Gce({type:L,displayName:"Centered Offset X",group:"Reward Animations"}),Vue=Gce({type:L,displayName:"Centered Offset Y",group:"Reward Animations"}),$ue=Gce({type:L,min:0,displayName:"Starting Scale",group:"Reward Animations"}),Wue=Gce({type:L,min:0,displayName:"Ending Scale",group:"Reward Animations"}),Nue((Yue=a((jue=function(a){n(y,a);var s,u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),r(e,"sprite",Yue,l(e)),r(e,"glowOpacity",Xue,l(e)),r(e,"explosionParticles",Jue,l(e)),r(e,"circle",Zue,l(e)),r(e,"uiOpacity",Que,l(e)),e.ogCenterX=0,e.ogCenterY=0,r(e,"endingOffsetX",ece,l(e)),r(e,"endingOffsetY",tce,l(e)),r(e,"startingScale",nce,l(e)),r(e,"endingScale",ice,l(e)),e}return e(y,[{key:"startingOffsetX",get:function(){return this.node.position.x}},{key:"startingOffsetY",get:function(){return this.node.position.y}},{key:"__preload",value:function(){this.validateRequiredComponents(),this.ogCenterX=this.startingOffsetX,this.ogCenterY=this.startingOffsetY}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"moveToCenter",value:(h=o((function*(e){var t=new V(this.endingOffsetX,this.endingOffsetY,this.node.position.z);yield Ve.runTweenAsync(R(this.node).to(.7,{position:t},{easing:"quintInOut"}),e),this.node.position=t})),function(e){return h.apply(this,arguments)})},{key:"respawnAtStartingState",value:function(){this.node.position=new V(this.ogCenterX,this.ogCenterY,this.node.position.z),this.glowOpacity.opacity=0,this.sprite.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.glowOpacity.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.uiOpacity.opacity=255}},{key:"scale",value:(d=o((function*(e,t){var n=this.startingScale+(this.endingScale-this.startingScale)*e,i=new V(n,n,n);yield Promise.all([Ve.runTweenAsync(R(this.sprite.node).to(.2,{scale:i},{easing:"backOut"}),t),Ve.runTweenAsync(R(this.glowOpacity.node).to(.2,{scale:i},{easing:"backOut"}),t)]),this.sprite.node.setScale(i),this.glowOpacity.node.setScale(i)})),function(e,t){return d.apply(this,arguments)})},{key:"startShaking",value:function(){var e=this,t=this.node.position.clone();this.shakingTween={ogPos:t,tw:R(this.node).to(.1,{},{onUpdate:function(n,i){if(i){var a=t.x+10*(i-.5);e.node.position=new V(a,t.y,t.z)}}}).repeatForever().start()}}},{key:"stopShaking",value:function(){this.shakingTween&&(this.shakingTween.tw.stop(),this.node.position=this.shakingTween.ogPos,this.shakingTween=void 0)}},{key:"glow",value:(c=o((function*(e){var t=this.sprite.node.scale.clone().multiplyScalar(1.1);yield Promise.all([Ve.runTweenAsync(R(this.sprite.node).to(.2,{scale:t},{easing:"cubicInOut"}),e),Ve.runTweenAsync(R(this.glowOpacity.node).to(.2,{scale:t}),e),Ve.runTweenAsync(R(this.glowOpacity).to(.5,{opacity:255}),e)])})),function(e){return c.apply(this,arguments)})},{key:"explode",value:(u=o((function*(e){var t=this,n=new V(8,8,8),i=function(){var i=o((function*(){t.circle.opacity=255,t.circle.node.setScale(V.ZERO),yield Promise.all([Ve.runTweenAsync(R(t.circle).to(.3,{opacity:0}),e),Ve.runTweenAsync(R(t.circle.node).to(.3,{scale:n},{easing:"cubicOut"}),e)]),t.circle.opacity=0,t.circle.node.scale=n}));return function(){return i.apply(this,arguments)}}(),a=function(){var n=o((function*(){yield Promise.all([Ve.runTweenAsync(R(t.glowOpacity.node).to(.3,{scale:V.ZERO},{easing:"cubicOut"}),e),Ve.runTweenAsync(R(t.sprite.node).to(.3,{scale:V.ZERO},{easing:"cubicOut"}),e)]),t.sprite.node.setScale(V.ZERO),t.glowOpacity.node.setScale(V.ZERO)}));return function(){return n.apply(this,arguments)}}();yield Promise.all([this.explodeParticles(e),i(),a()])})),function(e){return u.apply(this,arguments)})},{key:"explodeParticles",value:(s=o((function*(e){e.aborted||(this.explosionParticles.node.active=!0,this.explosionParticles.resetSystem(),yield Ve.waitTweenAsync(1),this.explosionParticles.node.active=!1)})),function(e){return s.apply(this,arguments)})}]),y}(T)).prototype,"sprite",[Bue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xue=a(jue.prototype,"glowOpacity",[Fue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jue=a(jue.prototype,"explosionParticles",[xue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zue=a(jue.prototype,"circle",[zue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Que=a(jue.prototype,"uiOpacity",[Uue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(jue.prototype,"startingOffsetX",[Gue],Object.getOwnPropertyDescriptor(jue.prototype,"startingOffsetX"),jue.prototype),a(jue.prototype,"startingOffsetY",[Hue],Object.getOwnPropertyDescriptor(jue.prototype,"startingOffsetY"),jue.prototype),ece=a(jue.prototype,"endingOffsetX",[que],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),tce=a(jue.prototype,"endingOffsetY",[Vue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),nce=a(jue.prototype,"startingScale",[$ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),ice=a(jue.prototype,"endingScale",[Wue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Kue=jue))||Kue);S._RF.pop(),S._RF.push({},"e414bczbutHJKcOfhl1sc4p","StarChestScreen",void 0);var qce,Vce,$ce,Wce,Kce,jce,Yce,Xce,Jce=C.ccclass,Zce=C.property,Qce=C.requireComponent,ede=Ludex.Events,tde=codex,nde=tde.event,ide=tde.player;wce=Jce("StarChestScreen"),Sce=Qce(iee),kce=Zce(_$),Cce=Zce(G),Ece=Zce(G),Ace=Zce(ce),Tce=Zce(Hce),Pce=Zce(B),Oce=Zce(iH),Lce=Zce(th),wce(Ice=Sce((_ce=a((Rce=function(a){n(p,a);var s,u,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),r(e,"starProgressBar",_ce,l(e)),r(e,"openButton",Dce,l(e)),r(e,"continueButton",Mce,l(e)),r(e,"chestAnimation",Nce,l(e)),r(e,"starChest",Bce,l(e)),r(e,"chestUnlockFXMask",Fce,l(e)),r(e,"skipOverlay",xce,l(e)),r(e,"messageLabelLocalizer",zce,l(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){nde.on(ede.OPENING_SCREEN,this.handleOpeningScreen),nde.on(ede.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){nde.off(ede.OPENING_SCREEN,this.handleOpeningScreen),nde.off(ede.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Es.HIDE_UI);var e=ide.getGameData();if(e){var t=e.stars;this.numChestAvailable=Math.floor(t/20),this.starProgressBar.setRange(t,20);var n=this.numChestAvailable>0;this.setInteractableButtons(!0),this.openButton.node.active=n,this.openButton.interactable=n,this.continueButton.node.active=!n,this.continueButton.interactable=!n,this.messageLabelLocalizer.key=this.numChestAvailable?"reward.starChestAvailable":"reward.starChestUnavailable",this.numChestAvailable?this.chestAnimation.play():this.chestAnimation.stop(),this.chestUnlockFXMask.node.active=!1,this.chestUnlockFXMask.opacity=0,this.starChest.respawnAtStartingState()}}},{key:"close",value:function(){this.setInteractableButtons(!1),nde.emit(ede.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Es.SHOW_UI)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StarChestScreen: screen not found")}},{key:"handleClickButton",value:(d=o((function*(){if(0!==this.numChestAvailable){je.turnDownMusic();var e=ide.getGameData();if(e){this.setInteractableButtons(!1);var t=e.stars;ide.setGameData({stars:e.stars-20*this.numChestAvailable});var n=new Ni;yield this.skipOverlay.open({opacity:200,onSkip:function(){return n.abort()}}),yield this.handleUnlockAnimation(t,e.stars,n),yield this.skipOverlay.close(),je.turnUpMusic(),D.emit(kn),this.close()}}else this.close()})),function(){return d.apply(this,arguments)})},{key:"handleUnlockAnimation",value:(c=o((function*(e,t,n){var i=this;yield Promise.all([this.starChest.moveToCenter(n),this.fadeInChestUnlockFX(n)]),this.chestAnimation.stop(),this.starChest.startShaking(),yield je.playSound(Qi.STAR_CHEST_DRUM_ROLL,{loop:!0}),yield Ve.waitTweenAsync(0);var a=e,o=this.numChestAvailable;yield Promise.all([this.starProgressBar.animateTo(t,n,(function(e){var t;a-e>=20&&(a=e,o--,i.starChest.scale((t=o,i.numChestAvailable>2?1-t/i.numChestAvailable:.35*(1-t/i.numChestAvailable)),n),je.playSound(Qi.STAR_CHEST_OPEN))}))]),yield Ve.waitTweenAsync(1,n),this.starChest.stopShaking(),yield this.starChest.glow(n),je.stopSound(Qi.STAR_CHEST_DRUM_ROLL);var r=wy*this.numChestAvailable;this.node.scene.emit(Es.ADD_COINS,{coins:r,collectionAnimation:{animateTextOnly:!1,floatDuration:3,signal:n},skipAnimation:!0}),yield this.starChest.explode(n),yield Ve.waitTweenAsync(1,n),yield Promise.all([this.fadeOutChestUnlockFX(n)])})),function(e,t,n){return c.apply(this,arguments)})},{key:"fadeInChestUnlockFX",value:(u=o((function*(e){this.chestUnlockFXMask.node.active=!0,yield Ve.runTweenAsync(R(this.chestUnlockFXMask).to(.5,{opacity:150}),e)})),function(e){return u.apply(this,arguments)})},{key:"fadeOutChestUnlockFX",value:(s=o((function*(e){yield Ve.runTweenAsync(R(this.chestUnlockFXMask).to(.3,{opacity:0}),e),this.chestUnlockFXMask.opacity=0,this.chestUnlockFXMask.node.active=!1})),function(e){return s.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.openButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),p}(T)).prototype,"starProgressBar",[kce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dce=a(Rce.prototype,"openButton",[Cce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mce=a(Rce.prototype,"continueButton",[Ece],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nce=a(Rce.prototype,"chestAnimation",[Ace],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bce=a(Rce.prototype,"starChest",[Tce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fce=a(Rce.prototype,"chestUnlockFXMask",[Pce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xce=a(Rce.prototype,"skipOverlay",[Oce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zce=a(Rce.prototype,"messageLabelLocalizer",[Lce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ice=Rce))||Ice);S._RF.pop(),S._RF.push({},"2f7694kcVZNWq3iTCp1piqI","StartOverScreen",void 0);var ade,ode,rde,lde,sde,ude=C.ccclass,cde=C.property,dde=C.requireComponent,hde=Ludex.Events,pde=codex,yde=pde.event;pde.player,qce=ude("StartOverScreen"),Vce=dde(iee),$ce=cde(G),Wce=cde(G),qce(Kce=Vce((Yce=a((jce=function(a){n(c,a);var s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),r(e,"restartButton",Yce,l(e)),r(e,"cancelButton",Xce,l(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){yde.on(hde.OPENING_SCREEN,this.handleOpeningScreen),yde.on(hde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){yde.off(hde.OPENING_SCREEN,this.handleOpeningScreen),yde.off(hde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),lt.closeScreen(st.START_OVER_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.restartButton.interactable=e,this.cancelButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedCancel",value:function(){this.close(),this.node.scene.emit(Es.GAME_RESUME),this.node.scene.emit(Es.SHOW_UI)}},{key:"handleClickedRestart",value:(s=o((function*(){this.close(),this.node.scene.emit(Es.GAME_RESUME),this.node.scene.emit(Es.GAME_REPLAY)})),function(){return s.apply(this,arguments)})}]),c}(T)).prototype,"restartButton",[$ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xce=a(jce.prototype,"cancelButton",[Wce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kce=jce))||Kce);S._RF.pop(),S._RF.push({},"d6d78U+W5xDwqln9pXXQOaF","TopLeaders",void 0);var vde=C.ccclass,fde=C.property,gde=(ade=vde("TopLeaders"),ode=fde(O3),ade((sde=a((lde=function(a){n(d,a);var s,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"topLeaders",sde,l(e)),e.leaderData=[],e}return e(d,[{key:"updateData",value:function(e){var t=this;this.leaderData=e.slice(0,3),this.leaderData.slice(0,3).forEach((function(e,n){t.topLeaders[n].updateInfo({playerId:e.playerId,name:e.name,photo:e.photo,score:e.score})}))}},{key:"playShowLeadersAnimation",value:(s=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,i=.3;yield Promise.all(this.leaderData.map(function(){var a=o((function*(a,o){var r=t.topLeaders[o];yield r.runShowUpAnimation(o*n,i,e)}));return function(e,t){return a.apply(this,arguments)}}()))})),function(e){return s.apply(this,arguments)})},{key:"hideLeaders",value:function(){var e,t=u(this.topLeaders);try{for(t.s();!(e=t.n()).done;){e.value.setVisible(!1)}}catch(e){t.e(e)}finally{t.f()}}}]),d}(T)).prototype,"topLeaders",[ode],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rde=lde))||rde);S._RF.pop(),S._RF.push({},"c4670J4h0NFE5fCQacNQNsB","TournamentDetailOverlay",void 0);var mde,bde,wde,Sde,kde,Cde=Ludex.Utils,Ede=(Cde.Time,Cde.Object),Ade=function(){function n(e){var i=this;t(this,n),this.isScreenActive=!1,this.createLeaderboardDiv$=function(){i.leaderboardDiv$=document.createElement("div"),Ede.assign(i.leaderboardDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",left:"50%",scrollbarWidth:"none",alignItems:"start",overflow:"auto",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.leaderboardDiv$)},this.createTopPlayerDiv$=function(){i.topPlayerDiv$=document.createElement("div"),Ede.assign(i.topPlayerDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",left:"50%",scrollbarWidth:"none",alignItems:"start",overflow:"hidden",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.topPlayerDiv$)},this.updateTopPlayerElement$=function(){var e=o((function*(e){var t=e.tournamentPlayers.slice().sort((function(e,t){return e.rank-t.rank})).slice(0,3),n=s(s({},e),{},{tournamentPlayers:t,leaderboardPosition:e.leaderboardPosition,topPlayerPosition:e.topPlayerPosition});return i.topPlayerElement$?(yield i.topPlayerElement$.updateAsync(n),i.topPlayerElement$):yield jM.createOverlayViewAsync("overlays/tournament/top-player-overlay.xml",i.topPlayerDiv$,i.getTopPlayerIframeCss$(),"overlays/tournament/top-player-overlay-styles.css",n)}));return function(t){return e.apply(this,arguments)}}(),this.updateLeaderboardElement$=function(){var e=o((function*(e){if(i.leaderboardElement$){yield i.leaderboardElement$.updateAsync(e);var t=i.leaderboardElement$.getIFrameElement(),n=i.getLeaderboardIframeCss$(e);return t.style.cssText=n,i.leaderboardElement$}return yield jM.createOverlayViewAsync("overlays/tournament/leaderboard-overlay.xml",i.leaderboardDiv$,i.getLeaderboardIframeCss$(e),"overlays/tournament/leaderboard-overlay-styles.css",e)}));return function(t){return e.apply(this,arguments)}}(),this.isPayloadChanged$=function(e){if(!i.currentPayload$)return!0;if(i.currentPayload$.tournamentPlayers.length!==e.tournamentPlayers.length)return!0;for(var t=0;t<e.tournamentPlayers.length;t++){var n=i.currentPayload$.tournamentPlayers[t],a=e.tournamentPlayers[t];if(!n||!a)return!0;if(n.playerId!==a.playerId||n.rank!==a.rank||n.score!==a.score)return!0}return!1},this.showOverlay$=o((function*(){if(i.leaderboardElement$&&i.topPlayerElement$){var e=i.leaderboardElement$.showAsync(),t=i.topPlayerElement$.showAsync();yield Promise.all([e,t]),i.revealMainDivs$()}})),this.revealMainDivs$=function(){i.isScreenActive&&i.leaderboardElement$&&i.topPlayerElement$&&(Ede.assign(i.leaderboardDiv$.style,{display:"block"}),i.leaderboardDiv$.scrollTop=0,Ede.assign(i.topPlayerDiv$.style,{display:"block"}),requestAnimationFrame((function(){if(!i.isScreenActive)return i.leaderboardDiv$.style.display="none",void(i.topPlayerDiv$.style.display="none");Ede.assign(i.leaderboardDiv$.style,{opacity:"1",pointerEvents:"auto"}),Ede.assign(i.topPlayerDiv$.style,{opacity:"1",pointerEvents:"auto"})})))},this.validateOverlayPayload$=function(e){var t,n=s(s({},e),{},{tournamentPlayers:[]}),i=/^\d+$/,a=u(e.tournamentPlayers);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.test(o.playerId)&&n.tournamentPlayers.push(o)}}catch(e){a.e(e)}finally{a.f()}return n},this.getLeaderboardIframeCss$=function(e){var t=e.tournamentPlayers,n=e.leaderboardPosition,a=i.getElementDivWidth$(n),o=t.length,r="height: calc((".concat(a,"px * (107 / 593) - 2px) * ").concat(o," + 15px);");return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat(r,"   ")},this.getTopPlayerIframeCss$=function(){return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat("height: 130%;"," ").concat("top: -23%;"," ").concat("position: absolute;")},this.getElementDivWidth$=function(e){return e.width*jM.getGameScaleFactor()},this.getElementDivHeight$=function(e){return e.height*jM.getGameScaleFactor()},this.getElementDivTopOffset$=function(e){return e.worldY*jM.getGameScaleFactor()},this.getElementDivLeftOffset$=function(e){return e.worldX*jM.getGameScaleFactor()},this.moveAndResizeOverlays$=function(e){var t=e.leaderboardPosition,n=e.topPlayerPosition;i.updateDivPosition$(i.leaderboardDiv$,t),i.updateDivPosition$(i.topPlayerDiv$,n)},this.updateDivPosition$=function(e,t){if(e){var n="".concat(i.getElementDivWidth$(t),"px"),a="".concat(i.getElementDivHeight$(t),"px"),o="".concat(i.getElementDivLeftOffset$(t),"px"),r="".concat(i.getElementDivTopOffset$(t),"px");Ede.assign(e.style,{width:n,height:a,left:o,top:"calc(100vh - ".concat(r,")")})}},this.scene=e,this.createLeaderboardDiv$(),this.createTopPlayerDiv$()}var i,a;return e(n,[{key:"updateOverlay",value:(a=o((function*(e){try{if(!this.isScreenActive)return!1;var t=this.validateOverlayPayload$(e);if(this.moveAndResizeOverlays$(t),!this.isPayloadChanged$(t))return yield this.revealMainDivs$(),!0;this.topPlayerElement$=yield this.updateTopPlayerElement$(t),this.leaderboardElement$=yield this.updateLeaderboardElement$(t),this.currentPayload$=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return a.apply(this,arguments)})},{key:"hideOverlay",value:(i=o((function*(){this.leaderboardElement$&&this.topPlayerElement$&&(Ede.assign(this.leaderboardDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"}),Ede.assign(this.topPlayerDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"}))})),function(){return i.apply(this,arguments)})},{key:"setIsScreenActive",value:function(e){this.isScreenActive=e}}]),n}();S._RF.pop(),S._RF.push({},"fe274iMNmBCzZ13Ie1nGU1R","TournamentLeaderSkeleton",void 0);var Tde,Pde,Ode,Lde,Ide,Rde,_de,Dde,Mde,Nde,Bde,Fde,xde,zde,Ude,Gde,Hde,qde,Vde,$de,Wde,Kde,jde,Yde,Xde,Jde,Zde,Qde,ehe,the,nhe,ihe,ahe,ohe,rhe,lhe,she,uhe,che,dhe,hhe,phe,yhe,vhe,fhe,ghe,mhe,bhe,whe,She,khe,Che,Ehe,Ahe,The,Phe,Ohe,Lhe,Ihe,Rhe,_he,Dhe,Mhe,Nhe,Bhe,Fhe,xhe,zhe,Uhe,Ghe,Hhe=C.ccclass,qhe=C.property,Vhe=(mde=Hhe("TournamentLeaderSkeleton"),bde=qhe(q),mde((kde=a((Sde=function(a){n(d,a);var s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),r(e,"container",kde,l(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(B),this.validateRequiredComponents()}},{key:"hide",value:(u=o((function*(e){var t=this;yield Ve.runTweenAsync(R(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(s=o((function*(e,t){this.node.active=!0,this.node.scale=new V(.8,.8,.8),this.uiOpacity.opacity=0;var n=this.container.position.clone();this.container.position=new V(n.x,n.y-100,n.z);var i=R(this.node).delay(e);i.to(.2,{scale:V.ONE},{easing:"elasticOut"});var a=R(this.container).delay(e);a.to(.2,{position:n},{easing:"backOut"});var o=R(this.uiOpacity).delay(e);o.to(.2,{opacity:255},{easing:"cubicOut"}),yield Promise.all([Ve.runTweenAsync(i,t),Ve.runTweenAsync(a,t),Ve.runTweenAsync(o,t)]),this.node.scale=V.ONE,this.container.position=n,this.uiOpacity.opacity=255})),function(e,t){return s.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),d}(T)).prototype,"container",[bde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wde=Sde))||wde);S._RF.pop(),S._RF.push({},"cdaa9B4pK9PFrDmP6/GQcMn","TournamentDetailScreen",void 0);var $he,Whe=C.ccclass,Khe=C.property,jhe=C.requireComponent,Yhe=Ludex,Xhe=Yhe.Events,Jhe=Yhe.Utils,Zhe=Jhe.Object,Qhe=Jhe.Time,epe=Jhe.Number,tpe=codex,npe=tpe.event,ipe=tpe.storage,ape=tpe.player,ope=tpe.leaderboard,rpe=tpe.language,lpe=1166;Tde=Whe("TournamentDetailScreen"),Pde=jhe(iee),Ode=Yn.required(),Lde=Yn.required(),Ide=Khe(K),Rde=Yn.required(),_de=Khe(th),Dde=Yn.required(),Mde=Khe(th),Nde=Yn.required(),Bde=Khe(th),Fde=Yn.required(),xde=Khe(h2),zde=Yn.required(),Ude=Khe(gde),Gde=Yn.required(),Hde=Khe({type:q,group:"Buttons"}),qde=Yn.required(),Vde=Khe({type:q,group:"Buttons"}),$de=Yn.required(),Wde=Khe({type:q,group:"Buttons"}),Kde=Yn.required(),jde=Khe({type:q,group:"Buttons"}),Yde=Yn.required(),Xde=Khe({type:_,group:"Buttons"}),Jde=Yn.required(),Zde=Khe({type:F}),Qde=Yn.required(),ehe=Khe({type:q}),the=Yn.required(),nhe=Khe({type:q}),ihe=Khe({type:[Vhe]}),ahe=Khe({type:hT,group:"Confetti"}),ohe=Khe({type:hT,group:"Confetti"}),rhe=Yn.required(),lhe=Khe({type:P,group:"Container"}),she=Yn.required(),uhe=Khe({type:P,group:"Container"}),che=Yn.required(),dhe=Khe({type:q,group:"Container"}),hhe=Yn.onlyRunInLifeCycleAsync,phe=Yn.onlyRunInLifeCycleAsync,yhe=Yn.onlyRunInLifeCycleAsync,vhe=Yn.onlyRunInLifeCycleAsync,fhe=Yn.onlyRunInLifeCycleAsync,ghe=Yn.onlyRunInLifeCycle,mhe=Yn.onlyRunInLifeCycle,Tde(bhe=Pde((She=a((whe=function(a){n(S,a);var c,d,h,p,y,v,f,g,b,w=i(S);function S(){var e;t(this,S);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=w.call.apply(w,[this].concat(i)),r(e,"screen",She,l(e)),r(e,"title",khe,l(e)),r(e,"titleLocalizer",Che,l(e)),r(e,"timeLocalizer",Ehe,l(e)),r(e,"playerCountLocalizer",Ahe,l(e)),r(e,"tournamentLeaders",The,l(e)),r(e,"topLeaders",Phe,l(e)),r(e,"playButton",Ohe,l(e)),r(e,"continueButton",Lhe,l(e)),r(e,"replayButton",Ihe,l(e)),r(e,"logInButton",Rhe,l(e)),r(e,"buttonsLayout",_he,l(e)),r(e,"banner",Dhe,l(e)),r(e,"bannerLoadingRing",Mhe,l(e)),r(e,"bannerMask",Nhe,l(e)),r(e,"leaderSkeletons",Bhe,l(e)),r(e,"leftConfetti",Fhe,l(e)),r(e,"rightConfetti",xhe,l(e)),r(e,"container",zhe,l(e)),r(e,"tempContainer",Uhe,l(e)),r(e,"topPlayerOverlayRef",Ghe,l(e)),e.signal$=new Ni,e.isOverlayMode$=!1,e.leadersPayload$=null,e.tournamentDetailOverlay$=null,e.listenScreenEvents$=function(){npe.on(Xhe.OPENING_SCREEN,e.handleOpeningScreen$),npe.on(Xhe.OPENED_SCREEN,e.handleOpenedScreen$)},e.unListenScreenEvents$=function(){npe.off(Xhe.OPENING_SCREEN,e.handleOpeningScreen$),npe.off(Xhe.OPENED_SCREEN,e.handleOpenedScreen$)},e.handleOpeningScreen$=function(t){if(!e.screen)throw new Error("TournamentDetailScreen: screen not found");e.validateEventPayload$(t)&&(e.enabled=!0)},e.handleOpenedScreen$=function(t){e.validateEventPayload$(t)&&e.open()},e.validateEventPayload$=function(t){return(null!=t?t:{}).screenName===e.node.name&&(e.payload$=t,!0)},e.cleanup$=function(){var t;null===(t=e.signal$)||void 0===t||t.abort(),e.signal$=new Ni,e.tournamentLeaders.hideLeaders(),e.topLeaders.hideLeaders(),e.cleanupOverlay$()},e.cleanupOverlay$=function(){var t;null===(t=e.tournamentDetailOverlay$)||void 0===t||t.hideOverlay()},e.handleOverlayMode$=function(){var t=o((function*(t){return!!e.leadersPayload$&&new Promise((function(n){t.call((function(){e.updateOverlay$().then((function(t){e.isOverlayMode$=t,n(t)}))}))}))}));return function(e){return t.apply(this,arguments)}}(),e.updateOverlay$=o((function*(){var t;if(!e.leadersPayload$||!e.tournamentDetailOverlay$)return!1;var n=null!==(t=e.leadersPayload$.leaders)&&void 0!==t?t:[];n.sort((function(e,t){return e.rank-t.rank}));var i=n.map((function(e){return{playerId:e.playerId,rank:e.rank,score:e.score}})),a=yield e.tournamentDetailOverlay$.updateOverlay({tournamentPlayers:i,leaderboardPosition:e.getLeaderboardPosition$(),topPlayerPosition:e.getTopPlayerPosition$(),currentPlayerId:ape.getPlayerId()});return null!=a&&a})),e.updateContainer$=o((function*(){var t=e.tempContainer.height;e.container.node.position=e.tempContainer.node.position.clone(),t<lpe&&e.container.height!==t?(e.container.height=t,ne.instance.emit("canvas-resize")):t>lpe&&e.container.height<lpe&&(e.container.height=lpe,ne.instance.emit("canvas-resize"))})),e.updateTitleWithPlayerName$=function(t){void 0!==t&&(e.titleLocalizer.enabled=!0,e.titleLocalizer.setParams([t]))},e.updateTitleTournamentTitle$=function(t){e.titleLocalizer.enabled=!1,e.title.string=t},e.updateEndTime$=function(t){try{var n=Qhe.getRelativeTime(t,rpe.getCurrentLocale(),{style:"short"});e.timeLocalizer.key="game.endsIn",e.timeLocalizer.setParams([n])}catch(t){e.timeLocalizer.key="game.endsSoon"}},e.updateTournamentBanner$=function(){var t=o((function*(t,n){e.banner.spriteFrame=null;var i=qe.getAsset("".concat(gt[t],"/spriteFrame"),ue);i||(e.bannerMask.active=!0,e.bannerLoadingRing.active=!0,i=yield qe.loadThemeTournamentAsync(t)),i||(i=yield qe.loadThemeTournamentAsync(pt.SUMMER)),e.banner&&i&&!n.aborted&&(e.banner.spriteFrame=i,e.bannerMask.active=!1,e.bannerLoadingRing.active=!1)}));return function(e,n){return t.apply(this,arguments)}}(),e.setPlayerCountWaiting$=function(){e.playerCountLocalizer.key="status.loading"},e.updateButtonVisibility$=function(){var t,n;if(e.playButton.active=!1,e.continueButton.active=!1,e.replayButton.active=!1,e.logInButton.active=!1,GameSDK.extra.isGuest)e.logInButton.active=!0;else{var i=(null!==(t=null===(n=e.payload$)||void 0===n?void 0:n.screenData)&&void 0!==t?t:{}).tournamentContextType;switch(void 0===i?"tournament_start":i){case"tournament_end":var a,o,r=(null!==(a=null===(o=ape.getGameData())||void 0===o?void 0:o.tournamentProgress[e.tournamentPayload$.id])&&void 0!==a?a:{}).replayCount,l=void 0===r?0:r;e.continueButton.active=l>1,e.replayButton.active=!0,e.buttonsLayout.updateLayout(!0);break;case"tournament_start":e.playButton.active=!0}}},e.getLeadersPayload$=function(){var e=o((function*(e){var t=ope.getLeaderboardName(e);if(!t)return null;var n=yield OD.getAllLeaderboardAsync(e);if(!n)return null;var i,a=Zhe.vals(n.leaders),o=ape.getPlayerId(),r={leaders:[],amountPlayer:n.amountPlayer},l=u(a);try{for(l.s();!(i=l.n()).done;){var s=i.value;s.playerId===o?(r.player=s,r.leaders.push(s)):r.leaders.push(s)}}catch(e){l.e(e)}finally{l.f()}if(!r.player){var c=(yield ope.getLeadersByPlayerIdsAsync(t,[o]))[0];c&&(r.player=c,r.leaders.push(c))}return r}));return function(t){return e.apply(this,arguments)}}(),e.processPlayTournament$=function(){var t=o((function*(t){var n=e.tournamentPayload$.id||"",i=ut.validateTournamentExpired(n);if(ut.syncTournamentProgress(),i)return e.close(),e.node.scene.emit(Ny.RELOAD_TOURNAMENT),void lt.showNotificationScreenWithLocalizedKey("error.tourEnded",2);var a=t.level,o=t.score,r=t.replay;try{lt.showLoadingScreen(),yield iv.setMatchCustomDataAsync({level:a,score:o}),yield e.processJoinTournament$(a),r&&e.increaseTournamentReplayCount$()}catch(t){if(Zhe.hasOwn(t,"code")&&"USER_INPUT"===t.code)return;try{yield e.processContinueTournament$(a),r&&e.increaseTournamentReplayCount$()}catch(e){if(Zhe.hasOwn(e,"code")&&"USER_INPUT"===e.code)return;console.error("processPlayButtonPressed",e),lt.showNotificationScreenWithLocalizedKey("error.tourJoinFail",2)}}finally{lt.closeLoadingScreen()}}));return function(e){return t.apply(this,arguments)}}(),e.processJoinTournament$=o((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{var n=e.tournamentPayload$.id||"";yield iv.joinTournamentAsync(n),ct.switchToGameScene({level:t})}catch(e){throw console.warn("processJoinTournament",e),e}})),e.processContinueTournament$=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{var t,n=null!==(t=GameSDK.context.getID())&&void 0!==t?t:"";yield iv.continueTournamentAsync(n),ct.switchToGameScene({level:e})}catch(e){throw console.warn("processContinueTournament",e),e}})),e.increaseTournamentReplayCount$=function(){var e,t,n=(null!==(e=iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;if(n){var i=ape.getGameData();if(i){var a=i.tournamentProgress,o=(null!==(t=a[n])&&void 0!==t?t:{}).replayCount,r=void 0===o?0:o;ape.setGameData({tournamentProgress:m({},n,s(s({level:1,score:0},a[n]),{},{replayCount:r+1}))})}}},e.setInteractableButtons$=function(t){e.screen.backgroundMaskButton.interactable=t},e.createTournamentOverlay$=function(){try{jM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode$=!0,e.tournamentDetailOverlay$=new Ade(e.node.scene)}catch(e){return}},e.getLeaderboardPosition$=function(){var t=e.tournamentLeaders.getComponent(P);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.tournamentLeaders.node;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.getTopPlayerPosition$=function(){var t=e.topPlayerOverlayRef.getComponent(P);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.topPlayerOverlayRef;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.updateOverlayScreenStatus$=function(t){var n;null===(n=e.tournamentDetailOverlay$)||void 0===n||n.setIsScreenActive(t)},e}return e(S,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(iee),Yn.validateRequiredProperties(this,S),this.listenScreenEvents$(),this.createTournamentOverlay$()}},{key:"onDestroy",value:function(){this.signal$.abort(),this.unListenScreenEvents$(),this.cleanupOverlay$()}},{key:"open",value:function(){this.updateContainer$(),this.updateInfo(),this.updateOverlayScreenStatus$(!0),this.setInteractableButtons$(!0),this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders(),this.updateButtonVisibility$(),this.setPlayerCountWaiting$(),this.node.scene.emit(Es.HIDE_UI)}},{key:"close",value:function(){lt.closeTournamentDetailScreen(),this.setInteractableButtons$(!1),this.tournamentLeaders.scrollView.unlistenEvents(),this.updateOverlayScreenStatus$(!1),this.node.scene.emit(Es.SHOW_UI),this.cleanup$()}},{key:"updateInfo",value:(b=o((function*(){var e,t,n,i,a,o,r=this,l=this.signal$,s=null===(e=this.payload$)||void 0===e||null===(e=e.screenData)||void 0===e?void 0:e.tournament;if(s){var u=null===(t=null===(n=this.payload$.screenData)||void 0===n?void 0:n.playAnimation)||void 0===t||t,c=JSON.parse(s);c.id=c.id.toString(),this.tournamentPayload$=c;var d=this.tournamentPayload$,h=d.endTime,p=d.payload,y=d.title,v=d.tournamentType,f=p.leaderboardId,g=void 0===f?"":f,m=p.themeId,b=void 0===m?pt.AUTUMN:m,w=p.playerName;"PAGE_HOSTED"===v?this.updateTitleTournamentTitle$(y):this.updateTitleWithPlayerName$(null!=w?w:y),this.updateEndTime$(h),this.updateTournamentBanner$(b,l);var S=ipe.getStorage("tournament"),k=S.previousScore,C=S.animateTournamentLeader;if(ipe.setStorageData("tournament","animateTournamentLeader",!1),yield this.showLoading(l),yield this.loadLeaders(g),!this.leadersPayload$||0===this.leadersPayload$.leaders.length||l.aborted)return this.updatePlayerCount(0),void(yield this.hideLoading(l));var E=this.leadersPayload$,A=E.player,T=E.amountPlayer,P=null!==(i=this.leadersPayload$.leaders)&&void 0!==i?i:[];if(P.sort((function(e,t){return e.rank-t.rank})),yield this.hideLoading(l),this.isOverlayMode$&&(yield this.handleOverlayMode$(l)))return;if(this.topLeaders&&this.tournamentLeaders&&!l.aborted){this.updatePlayerCount(T),this.topLeaders.updateData(P),this.topLeaders.playShowLeadersAnimation(l);var O=null!==(a=null==A?void 0:A.score)&&void 0!==a?a:0,L=null!==(o=null==A?void 0:A.rank)&&void 0!==o?o:0,I=C&&-1!==k&&k<O;this.tournamentLeaders.updateData(P);var R=!1;A&&I&&(R=this.tournamentLeaders.updateDisplayPlayerLeaderForRankChanging(k,O,L)),this.tournamentLeaders.initScrollViews(),this.tournamentLeaders.scrollView.scrollView.enabled=!0,yield l.callAsync((function(e){return r.runShowUpAnimation(e,u)})),C&&R&&-1!==k&&this.tournamentLeaders&&(yield l.callAsync((function(e){return r.tournamentLeaders.playRankChangeAnimation(e,k,O,L)})),this.tryPlayConfettiEffect(L))}}})),function(){return b.apply(this,arguments)})},{key:"loadLeaders",value:(g=o((function*(e){this.leadersPayload$=yield this.getLeadersPayload$(e)})),function(e){return g.apply(this,arguments)})},{key:"showLoading",value:(f=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isOverlayMode$?this.cleanupOverlay$():yield Promise.all([this.tournamentLeaders.scrollView.unlistenEvents(),this.tournamentLeaders.scrollView.scrollToTop(e,.1).then((function(){t.tournamentLeaders.scrollView.scrollView.enabled=!1,t.tournamentLeaders.scrollView.listenEvents()})),this.leaderSkeletons.map((function(t,i){return t.show(i*n,e)}))])})),function(e){return f.apply(this,arguments)})},{key:"hideLoading",value:(v=o((function*(e){this.isOverlayMode$||(yield Promise.all(this.leaderSkeletons.map((function(t){return t.hide(e)}))))})),function(e){return v.apply(this,arguments)})},{key:"runShowUpAnimation",value:(y=o((function*(e){var t,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=i?0:.1;yield null===(t=this.tournamentLeaders)||void 0===t?void 0:t.playShowLeadersAnimation(e,a),yield null===(n=this.tournamentLeaders)||void 0===n?void 0:n.scrollToPlayerLeader(1.5,e)})),function(e){return y.apply(this,arguments)})},{key:"tryPlayConfettiEffect",value:function(e){if(!(e>10)){var t=Ze.isLandscape(),n=t?50:30,i=t?5e3:2e3,a=t?15e3:1e4,o=t?40:60,r=t?110:100,l=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=a,this.leftConfetti.shapeModule.angle=o,this.rightConfetti.shapeModule.angle=r,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=l,this.leftConfetti.play(),this.rightConfetti.play(),je.playSound(Qi.LEADERBOARD_TRIUMPH)}}},{key:"updatePlayerCount",value:function(e){var t=epe.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"handleOnLogIn",value:(p=o((function*(){try{if(!("initPlayerAsync"in GameSDK.player))return;if(lt.showLoadingScreen(),yield GameSDK.player.initPlayerAsync(),lt.closeLoadingScreen(),GameSDK.extra.isGuest)return void lt.showNotificationScreenWithLocalizedKey("error.login",1)}catch(e){lt.closeLoadingScreen(),lt.showNotificationScreenWithLocalizedKey("error.login",1)}})),function(){return p.apply(this,arguments)})},{key:"handleOnPlay",value:(h=o((function*(){GameSDK.isGameSDK("Yandex")&&(yield Xe.showInterstitialAdAsync()),yield this.processPlayTournament$({level:1,score:0,replay:!1})})),function(){return h.apply(this,arguments)})},{key:"handleOnReplay",value:(d=o((function*(){GameSDK.isGameSDK("Yandex")&&(yield Xe.showInterstitialAdAsync()),yield this.processPlayTournament$({level:1,score:0,replay:!0})})),function(){return d.apply(this,arguments)})},{key:"handleOnContinue",value:(c=o((function*(){var e,t;if(yield Xe.showRewardVideoAdAsync()){var n=null!==(e=null===(t=ape.getGameData())||void 0===t?void 0:t.tournamentProgress[this.tournamentPayload$.id])&&void 0!==e?e:{},i=n.level,a=void 0===i?1:i,o=n.score,r=void 0===o?0:o,l=a>1?Math.floor(a/2):1,s=Math.floor(r/2);yield this.processPlayTournament$({level:l,score:s,replay:!1})}})),function(){return c.apply(this,arguments)})}]),S}(T)).prototype,"screen",[Ode],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),khe=a(whe.prototype,"title",[Lde,Ide],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Che=a(whe.prototype,"titleLocalizer",[Rde,_de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ehe=a(whe.prototype,"timeLocalizer",[Dde,Mde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ahe=a(whe.prototype,"playerCountLocalizer",[Nde,Bde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),The=a(whe.prototype,"tournamentLeaders",[Fde,xde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Phe=a(whe.prototype,"topLeaders",[zde,Ude],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ohe=a(whe.prototype,"playButton",[Gde,Hde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lhe=a(whe.prototype,"continueButton",[qde,Vde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ihe=a(whe.prototype,"replayButton",[$de,Wde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rhe=a(whe.prototype,"logInButton",[Kde,jde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_he=a(whe.prototype,"buttonsLayout",[Yde,Xde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dhe=a(whe.prototype,"banner",[Jde,Zde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mhe=a(whe.prototype,"bannerLoadingRing",[Qde,ehe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nhe=a(whe.prototype,"bannerMask",[the,nhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bhe=a(whe.prototype,"leaderSkeletons",[ihe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fhe=a(whe.prototype,"leftConfetti",[ahe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xhe=a(whe.prototype,"rightConfetti",[ohe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zhe=a(whe.prototype,"container",[rhe,lhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uhe=a(whe.prototype,"tempContainer",[she,uhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ghe=a(whe.prototype,"topPlayerOverlayRef",[che,dhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(whe.prototype,"updateInfo",[hhe],Object.getOwnPropertyDescriptor(whe.prototype,"updateInfo"),whe.prototype),a(whe.prototype,"loadLeaders",[phe],Object.getOwnPropertyDescriptor(whe.prototype,"loadLeaders"),whe.prototype),a(whe.prototype,"showLoading",[yhe],Object.getOwnPropertyDescriptor(whe.prototype,"showLoading"),whe.prototype),a(whe.prototype,"hideLoading",[vhe],Object.getOwnPropertyDescriptor(whe.prototype,"hideLoading"),whe.prototype),a(whe.prototype,"runShowUpAnimation",[fhe],Object.getOwnPropertyDescriptor(whe.prototype,"runShowUpAnimation"),whe.prototype),a(whe.prototype,"tryPlayConfettiEffect",[ghe],Object.getOwnPropertyDescriptor(whe.prototype,"tryPlayConfettiEffect"),whe.prototype),a(whe.prototype,"updatePlayerCount",[mhe],Object.getOwnPropertyDescriptor(whe.prototype,"updatePlayerCount"),whe.prototype),bhe=whe))||bhe);S._RF.pop(),S._RF.push({},"36d58kn8v5POaqgX4C8S3ct","TournamentLeader",void 0);(0,C.ccclass)("TournamentLeader")($he=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(l2));S._RF.pop(),S._RF.push({},"88f2b4WH6NBlaGD7WvCOA2j","VibrateUtils",void 0);Ludex.Utils.Browser,codex.player;S._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map