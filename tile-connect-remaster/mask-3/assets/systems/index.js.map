{"version":3,"sources":["file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/scenes/common/locales/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/scenes/common/locales/en.json","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/AdsManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/EngineManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/LayoutManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/MatchManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/PlayerManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/AdaptivePerformance.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/CanvasRecorder.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DailyRewards.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DynamicAssets.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/DynamicAtlas.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/node_modules/potpack/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/node_modules/potpack/index.js","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderResultChallenge.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareLeaderboard.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareScore.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderShareScoreWithInvite.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/wideframes/renderUpdateChallenge.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/FrameCapture.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/HybridFileCache.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/Languages.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/Leaderboards.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/PerformanceMonitor.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/plugins/RemoteConfig.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/PluginsManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/SceneManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/ScreenManager.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/LudosSystem.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/Optimized2DPipeline.ts","file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/file:/Users/anhquan/Desktop/Repository/tile-connect-remaster-game/assets/systems/pipelines/PipelineData.ts"],"names":["text","core.nameless","game.resume","game.restart","game.cancel","game.challenge","game.next","game.completed","game.tryAgain","game.retry","game.startOverQ","game.startOverMsg","game.startOver","game.paused","game.end","game.quit","game.join","game.joinLeaderboard","game.continue","game.letsPlay","game.logIn","game.create","game.quitLevelShortMsg","game.quitSingleMsg","game.quitTourMsg","game.level","game.levelX","game.hardLevel","game.result","game.nextLevel","game.win","game.lose","game.draw","game.replay","game.boom","game.timesUp","game.bombDesc","game.timesUpDesc","game.daily","game.weekly","game.endsSoon","game.endsIn","game.player","game.nPlayers","game.pTour","game.combo","game.tourLbUpdated","settings.level","settings.settings","settings.music","settings.sound","settings.vibrate","settings.on","settings.off","settings.notification","settings.report","settings.share","settings.invite","settings.feedback","settings.createShortcut","settings.or","settings.customMode","custom.customLevel","custom.time","custom.difficulty","custom.easy","custom.normal","custom.hard","custom.extreme","custom.bombs","custom.ads","custom.score","custom.play","ads.cancelled","ads.loading","ads.notReady","ads.adAfterT","ads.levelAfterT","ads.rewardNotice","ads.skip","ads.daily","ads.claim","ads.claimX2","ads.claimNow","ads.await","ads.open","ads.coins","ads.getNow","ads.freeMinutes","ads.interNotice.hangTight","ads.interNotice.backInSec","ads.interNotice.quickAd","status.loading","status.congrats","status.allLevels","status.later","status.confirm","status.confirmReset","status.resetInfo","status.no","status.yes","status.first","status.second","status.third","status.nth","status.tap","status.waitingX","status.lbNotAvail","status.tourNotAvail","pages.shop","pages.collections","pages.home","pages.leaderboard","pages.tournament","guide.step1","guide.step2","guide.step3","guide.step4","guide.step5","guide.timer","guide.combo","guide.hint","guide.thunder","guide.storm","guide.pliers","guide.custom","interMsg.reviveAd","interMsg.doubleAd","interMsg.ranked","interMsg.friendChallenge","interMsg.bragChallenge","interMsg.clearTiles","interMsg.beatClock","interMsg.clearBombs","interMsg.seasonPack","interMsg.collectStars","interMsg.competeInLb","interMsg.competeWithFriends","interMsg.thunder","interMsg.hint","interMsg.pliers","interMsg.tornado","interMsg.coins","interMsg.seasonTiles","interMsg.dailyLogin","interMsg.levelUp","interMsg.seasonRewards","error.tryLater","error.soon","error.noFriendsLb","error.noWorldLb","error.createTourFail","error.tourExists","error.challengeFail","error.rewardFail","error.tourEnded","error.tourJoinFail","error.noAd","error.ratingNoAuth","error.ratingGameRated","error.ratingFail","error.shortcutFail","error.login","error.joinLb","reward.day","reward.dayX","reward.starChestTitle","reward.starChestAvailable","reward.starChestUnavailable","item.hint","item.thunder","item.storm","item.pliers","item.hintDesc","item.thunderDesc","item.stormDesc","item.pliersDesc","theme.newTiles","theme.summer","theme.autumn","theme.winter","theme.springFestival","theme.treePlantingFestival","theme.blueSeaFestival","theme.musicFestival","theme.harvestFestival","theme.foodFestival","theme.snowFestival","theme.lightFestival","theme.peaceFestival","theme.flowerFestival","theme.streetFestival","theme.colorGarden","theme.colorFestival","theme.natureSummer","theme.snowMountain","theme.iceFestival","theme.greenGrassFestival","theme.communityFestival","theme.waterFestival","theme.animalFestival","theme.lostFestival","theme.halloweenFestival","theme.snowMusicFestival","theme.christmas","theme.springFlowerFestival","theme.tetHoliday","theme.seaFestival","theme.fireworkFestival","theme.halloweenHorror","theme.midAutumn","theme.christmasSweet","theme.newYearCountdown","theme.happyNewYear","share.canYouDoBetter","dashboard.unlockLevel","texture","draw","lose","victory","waiting","excellent","good","great","wellDone","freeRewards","_Ludex","Ludex","Events","_Ludex$Configs$Ads","Configs","Ads","Enabled","PreloadAds","ShowAdOnLoad","_Ludex$Utils","Utils","T","Time","Decorator","event","codex","AdsManager","_dec","tryCatch","_descriptor","_applyDecoratedDescriptor","_class","_this","_classCallCheck","this","listenEvents$","on","AD_CLOSED","requestResizeGame$","catchUp","GAME_READY","processPreloadAds$","GAME_SDK_READY","processShowFirstInterstitialAd","CONTEXT_DATA_PROCESSED","processShowBannerAds$","game","GameEvents","LAYOUT_CHANGED","handleLayoutChanged$","emit","REQUEST_RESIZE_GAME","_asyncToGenerator","GameSDK","isGameSDK","sleepAsync","AdsUtils","updateBannerAdsByLayout","LayoutUtils","getCurrentLayout","refreshBannerAdVisibility","preloadAds","_initializerDefineProperty","_createClass","key","value","console","debug","prototype","configurable","enumerable","writable","initializer","ShowAdOnLoadEnabled","DelaySeconds","isYandex","pause","showInterstitialAdAsync","forceLoad","contextType","resume","_RF","pop","_Ludex$Configs$GameEn","GameEngine","DynamicAtlasConfig","DynamicAtlas","PreferredFPS","V","Valid","D","Device","EngineManager","overrideSettings$","settings","overrideSettings","Settings","Category","ENGINE","isDebugger","View","instance","resizeWithBrowserSize","isDesktop","frameRate","Desktop","Mobile","setupAutoAtlas$","AssetManager","cacheAsset","setupAssetDownloader$","downloader","allowImageBitmap","maxConcurrency","maxRequestsPerFrame","webpSupport","checkWebpSupport$","sys","hasFeature","Feature","WEBP","originHasFeature","feature","Promise","resolve","image","Image","onload","onerror","src","setupOptimalPipelines$","transformPipeline","remove","setupEngineRunningState$","input","Input","EventType","TOUCH_START","handleResumeEngine$","VISIBILITY_HIDDEN","handlePauseEngine$","VISIBILITY_VISIBLE","isPaused","setupDynamicAtlas$","isBrowser","setupDynamicAtlasForBrowser$","isNative","setupDynamicAtlasForNative$","disableDynamicAtlas$","os","OS","IOS","setupDynamicAtlasForIOS$","ANDROID","setupDynamicAtlasForAndroid$","OSX","LINUX","WINDOWS","setupDynamicAtlasForDesktop$","setupDynamicAtlasDefault$","platform","Platform","setDynamicAtlas$","options","MaxAtlasCount","MaxAtlasSize","MaxFrameSize","DynamicAtlasManager","macro","CLEANUP_IMAGE_CACHE","enabled","textureSize","maxFrameSize","maxAtlasCount","textureBleeding","OptimizeAtlas","TextureBleeding","maxSize","getMaxTextureSize$","correctSize","Math","min","director","root","maxTextureSize","device","capabilities","_DynamicAtlasManager$","Android","setupBatcherLimit$","BATCHER2D_MEM_INCREMENT","MAX_LABEL_CANVAS_POOL_SIZE","Layout","GameWorld","_GameWorld$DesignSize","DesignSize","Portrait","Landscape","AcceptPortraitRatio","AutoResizeCanvas","_codex","ads","LayoutManager","debounce","listenResizeEvent$","ResizeObserver","_window$__listeners$r","resizeEventCallbacks","window","__listeners","resize","length","_step","_iterator","_createForOfIteratorHelper","s","n","done","callback","removeEventListener","err","e","f","handleBodyResize","observe","document","body","handleViewResizeBySystem$","setupResolutionPolicy$","view","setOrientation","ORIENTATION_AUTO","resolutionPolicy$","getResolutionPolicy","setContentStrategy","ResolutionPolicy","ContentStrategy","EXACT_FIT","setContainerStrategy","ContainerStrategy","PROPORTION_TO_FRAME","isAdShowing$","isAdFullSizeShowing","error","payload","maxDpr","CocosUtils","getMaxPixelRatio","_ref$forcePixelRatio","forcePixelRatio","devicePixelRatio","setupOrientationByCanvasSize$","screenRatio","getScreenRatio$","PRIMARY_LAYOUT","setPortraitView$","setLandscapeView$","WIDTH","HEIGHT","isPrimaryLayoutPortrait","currentLayout$","setupLayoutStrategy$","resizeGameView$","isPrimaryLayoutLandscape","designWidth","designHeight","_view$getDesignResolu","getDesignResolutionSize","width","height","contentStrategy","getContentStrategy","containerStrategy","_containerStrategy","name","isPortrait","isLandscape","FIXED_WIDTH","FIXED_HEIGHT","FULL_PORTRAIT_SIZE","SHOW_ALL","FULL_LANDSCAPE_SIZE","EQUAL_TO_FRAME","setDesignResolutionSize","Resolution","worldSize","Size","screenWidth","getScreenWidthCss","screenHeight","getScreenHeightCss","scaleX","scaleY","gameSize","isFullPortraitSize","isFullLandscapeSize","scale","viewWidth","worldSizeToCssSize","viewHeight","viewSize","screen","windowSize","VIEW_RESIZED","info","_this2","O","Object","A","Array","_Ludex$Dtos$Match","Dtos","Match","MatchCustomData","CustomData","LevelFenKeys","LevelRulesKeys","MatchManager","setupMatchCustomData$","addDefaults","DefaultMatchCustomData","addValidator","score","isNumber","Error","concat","setupMatchData$","challengeData","isObject","challengeDataObj","keysForChallengeData","keys","has","level","validateFen$","fen","isString","gravity","validateLevelRules$","rules","time","validFenObject","validateKeys$","idSize","code","rows","cols","encoding","validEncoding","vals","TileSpecialTypes","entries","forEach","_ref","_ref2","_slicedToArray","validRules","addRandomTilesPerMove","maxSpaceOfPair","obj","B","Browser","Player","player","GameName","replace","PlayerManager","Data","makeLoose","GameData","PlayerData","stars","totalLevel","levelVersion","lastRewardedItems","lastCreateTournamentShown","guideItemShowed","isArray","items","values","ItemKeys","HINT","THUNDER","STORM","PLIERS","tournamentProgress","custom","endlessScore","syncOldPlayerDataForMsGames","oldLocalStorageKey","oldVersionData","getLocalStorage","oldPlayerData","toObject","currentPlayerData","getPlayerData","gameData","setPlayerData","requestConnectedPlayers","catch","warn","adaptivePerformance","AdaptivePerformance","once","Director","EVENT_BEGIN_FRAME","handleBeginFrame$","EVENT_AFTER_SCENE_LAUNCH","handleAfterSceneLaunch$","EVENT_AFTER_UPDATE","lateUpdate$","EVENT_BEFORE_UPDATE","updateActualFPS$","scene","trackingScene","dtInMs","deltaTime","updatePostStepDeltaTime","_director$root","actualFPS","fps","updateActualFPS","canvasRecorder","CanvasRecorder","canvas","setCanvas","getOptions","nextFrame","step","originWaitNextFrame","waitNextFrame","force","arguments","undefined","reject","isCapturing","syncFps","EVENT_AFTER_RENDER","then","storage","DailyRewards","initStorage$","addStorage","hasShownPopup","DynamicAssets","IgnoreFiles","Compression","F","Function","getBuildVersion","IMAGE_EXTS","ASSET","isProcessing$","yield10msIfNeeded$","timeSlice","targetScale$","sessionQuality$","failedAssets$","Set","isAssetUpgraded$","upgradableAssets$","Map","currentQuality","buildVersion","getOptimalScale$","dpr","round","pixelRatio","Available","Source","sortedScales","_toConsumableArray","sort","a","b","getCurrentQuality$","checkCacheVersion$","toString","cacheConfig","getStorage","_ref2$currentQuality","cacheCurrentQuality","cacheBuildVersion","setStorageData","updateToWebStorage","REQUEST_UPGRADE_ASSET","handleChangeQuality","injectSpriteUpdate$","defineProperty","Sprite","get","_spriteFrame","set","refreshed","lastSprite","markForUpdateRenderData","_applySpriteFrame","sizeMode","SizeMode","CUSTOM","uiTransform","node","getComponent","UITransform","_value$originalSize","originalSize","previousSize","setContentSize","injectSpriteFrameCheckRect$","_scale","originalCheckRect","SpriteFrame","checkRect","_len","args","_key","apply","injectSpriteFrameSlicedUV$","originalCalculateSlicedUV","_calculateSlicedUV","_this$_capInsets","capInsets","_capInsets","newCapInsets","map","cap","injectSpriteFrameResolution$","originalRefreshTexture","_refreshTexture","_len2","_key2","_this$rect","rect","x","y","xF","Number","toFixed","yF","widthF","heightF","newRect","Rect","newOriginalSize","reset","getAssetQuality$","uuid","path","replaceAssetUrl$","url","includes","saveStateToStorage$","updateSpriteFrames$","getScene","_step2","sprites","getComponentsInChildren","_iterator2","spriteFrame","original","_texture","updateImage","requestUpdateDynamicAssets$","REQUEST_DYNAMIC_ATLAS","collectUpgradableAssets$","task","_step3","output","hasUpgradableAsset","_iterator3","item","ext","originalUrl","upgradedUrl","cacheItem","resolution","processUpgradeQualityAsync$","_ref4","add","asset","assetManager","assets","ImageAsset","mediumPath","qualityPath","originalUrlConcept","loadItem","loadAny","data","slice","_nativeUrl","ASSET_QUALITY_CHANGE","_x","_init","insert","_step4","promiseRequest","initialUpgradedCount","size","_iterator4","promise","push","allSettled","AtlasDebug","AutoAtlasSize","UsePowerOfTwo","AllowNonePackable","OnlyOptimizeWhenRenderTooLong","J","Json","I","Mark","CONFIG","MAX_INTERVAL_MS","THROTTLE_UPDATE_MS","INTERVAL_INCREASE_MS","MEAN_LAG_THRESHOLD_MS","MAX_RECORDED_RENDER_TIMES","RENDER_TIME_CHECK_INTERVAL_MS","PACK_PADDING","MIN_FILL_RATE","BLEEDING_SPACE","COLLECT_PADDING","BLEED_SENSITIVE_SIZE","ENABLED","FONT","TEXT_HEIGHT","TEXT_PADDING","IMAGE_QUALITY","isEffective$","forceUpdateDynamicAtlas$","mutex$","mutex","renderTimes$","lastRenderTime$","renderTimeInterval$","atlasInfo$","lastAtlasInfo$","atlasIds$","collectInfo$","packedFrames$","debugCanvases$","requestUpdateDynamicAtlas$","SCENE_LAUNCHED","onSceneLaunched$","setupRenderListeners$","resetPendingInfo$","resetAllAtlases$","frame","isValid","_resetDynamicAtlasFrame","clear","overrideDynamicAtlasManager$","packToDynamicAtlas","collectSpriteFrame$","deleteAtlasSpriteFrame","deleteSpriteFrame$","createPendingDebugCanvas$","createDebugCanvas$","canvasId","checkRenderTimeThreshold$","calculateMeanRenderTimeAndReset$","handleLaggyFrame$","setTimeout","EVENT_BEFORE_RENDER","updateBeforeRenderTime$","updateAfterRenderTime$","performance","now","shift","renderTime","meanRenderTime","reduce","sum","comp","hasOwn","isSpriteFrameValidForAtlas$","getTexture$","texId","getId","texSize","getTextureSizeFromTexture$","addTextureToCollectInfo$","atlas","getAtlas$","deleteInnerTexture","delete","active","activeInHierarchy","packable","currentTexture","originalTexture","isSameTexture","isSameTextureId","color","current","opacityComp","UIOpacity","opacity","parent","getTextureSize$","isTextureTooLarge$","padding","w","h","id","components","_spriteFrame$original","_spriteFrame$original2","tex","_tex$width","_tex$height","rebuildAtlasIfNecessary$","_atlas","isSame","isSameAtlas$","packedInfo","_atlas$_texture","currentWidth","currentHeight","packedWidth","packedHeight","max","maxDimension","newWidth","newHeight","resetAtlas$","initWithSize","debugCanvas","getAtlasIndex$","_debugCanvas$getConte","getContext","clearRect","clone","createAtlas$","newAtlas","atlasIndex","createElement","_atlases","indexOf","destroy","splice","_atlasIndex","index","_atlases2","_DynamicAtlasManager$2","getAtlasSize$","_payload$force","updateDynamicAtlas$","lock","use","start","prepareDrawInfo$","packCollectedTextures$","FINISHED_DYNAMIC_ATLAS","requestAnimationFrame","printAtlasTextures$","_unused","stop","release","texturesToPack","calculateOptimizedAtlas$","textures","_potpack","boxes","area","maxWidth","box","spaces","ceil","sqrt","Infinity","i","space","last","fill","potpack","atlasSize","excessTextures","excessTextures$","excessSet","remainingTextures","filter","t","fillRate","_this$calculateExcess","calculateExcessDimensions$","excessWidth","excessHeight","tryRemoveExcessTextures$","removedWidth","removedHeight","removedTextures","_this$atlasIds$$textu","componentsToPack","textureCount","texturesInCollectInfo","_textureCount$get","_i","_componentsToPack","packComponentIntoAtlas$","tryInsertSpriteFrame$","packedFrame","drawTexture$","_setDynamicAtlasFrame","setTextureDirty","updateLabelUVs$","_assembler$updateUVs","Label","renderData","vertDirty","assembler","Assembler","getAssembler","updateUVs","call","base64","toDataURL","logImage","_info$x","_info$y","_texInfo$x","_texInfo$y","_atlas$_texture2","drawX","drawY","texInfo","_innerTextureInfos","drawToAtlas$","usageCount","drawDebugFrame$","_count","atlasTexture","drawTextureAt","ctx","willReadFrequently","imgData","isDrawableImage","drawDebugImageWithBleed$","drawDebugOutlineAndOverlay$","drawDebugText$","drawImage","outlineX","outlineY","outlineWidth","outlineHeight","hue","fillStyle","fillRect","font","textAlign","textBaseline","textMetrics","measureText","textX","textY","fillText","HTMLCanvasElement","HTMLImageElement","E","WIDEFRAME_PATH","WIDEFRAME_IMAGE_WITH_SCORE_BOX","WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX","FALLBACK_IMAGE","DEFAULT_RENDER_OPTIONS","wideframe","type","depth","position","playerPhoto","fallbackImage","opponentPhoto","leftScore","rightScore","leftCrown","rightCrown","StatusImage","win","renderResultChallenge","initial","lift","pipe","addPlayerPhotos","addScores","addStatusImages","addWideframe","result","applyAsync","applyCaptureAsync","isFailure","extractFailure","extractSuccess","renderOptions","frameCapture","captureAsync","isPlayerFinished","isOpponentFinished","hasFinishedPlayer","_objectSpread","playerId","opponentId","_payload$playerScore","playerScore","_payload$opponentScor","opponentScore","leftScoreText","rightScoreText","status","getStatus","statusImage","crown","_payload$playerScore2","_payload$opponentScor2","WIDEFRAME_IMAGE","avatar","leaderPhoto","leaderName","leaderScore","renderShareLeaderboard","addPlayerAvatar","addLeaderAvatars","leaders","out","leader","photo","photoY","captionY","language","monitorError","message","renderShareScore","addPlayerScore","addMessage","fontStyle","fontName","getLocalizedFontName","fontSize","getLocalizedFontSize","messageText","getLocalizedMessage","locale","getCurrentLocale","fontPath","LocaleFontPaths","fileName","getFileName","_LocaleFrameCaptureFo","LocaleFrameCaptureFontSize","_fragments","fragments","split","fullFileName","extension","lastIndexOf","substring","getText","sendException","toError","en","ru","renderShareScoreWithInvite","renderUpdateChallenge","addAvatars","FrameCapture","setRenderer","HybridFileCache","PreviewMode","BuildMode","_AssetManager$instanc","pipeline","fetchPipeline","CACHE_KEY_REGEX","throttle","supportTypes$","bundledFiles$","originHandler$","nativeAssetDictionary$","commitId","cachedFiles","cachedBundles","cachedExtensions","invalidateMode","InvalidateMode","CommitId","cacheCommitId","getStorageData","isCommitDifferent","isBuildVersionDifferent","clearCache$","requestUpdateStorage","initSupportedTypes$","SupportedExtensions","setupBundledFiles$","BUILD","downloadPromises","getCachedBundles$","downloadBundledFile$","BUNDLE_READY","bundledFile","toUpperCase","res","fetch","method","headers","Content-Type","json","setBundledCache$","injectOptimalFetchPipeline$","fetchPipe","pipes","injectOptimalLoadPipeline$","loadPipe","injectCacheExtensionPipeline$","CacheUuidExtension","cachedExtension","checkCacheExtension","cachedExt","getCacheExtension$","saveAndOverrideIsNative","originalPipeline","_item$isNative","isCached","restoreAndCacheExt","_this$nativeAssetDict","recordedInfo","setCacheExtension$","beforePipelines","beforeFetchPipelines","pipeToWrap","fetchPipeToWrap","afterPipelines","afterFetchPipelines","saveOriginDownloaders$","handler","handlers","registerCustomDownloader$","register","downloadFile$","SCENE_LOADED","CLEAR_HYBRID_FILE_CACHE","getDownloadHandler$","_this$originHandler$$","onComplete","cache","getCache$","setCache$","getCacheKey$","match","_match","validateDataType$","cacheKey","encodedData","_defineProperty","cacheData","getFileCaches$","getBundledCache$","_storage$getStorageDa","_bundledFile$key","getCachedExtensions$","_storage$getStorageDa2","initStorageData","supportTypes","Languages","initDefaultLanguage$","DefaultLanguageData","setLanguage$","initPlayerLanguage$","_player$getPlayerData","playerLocale","getPlayerLanguage","isSupportedLocale$","addLanguage$","saveToPlayerData","getPlayerDataByKey","lang","AvailableLocales","listenEvent$","REQUEST_LANGUAGE","handleLanguageRequested$","PRELOAD_LANGUAGE","handlePreloadLanguage$","CHOOSE_LANGUAGE","handleChooseLanguage$","_ref3","setAsFallback","langData","getLangData$","choose","setSetting","_ref5","onLoad","onError","toError$","_x2","_ref6","_ref6$saveToPlayerDat","_ref7","ResourceUtils","loadJsonAsync","LocaleFilePaths","_x3","_ref8","_payload$saveToPlayer","_x4","module","_Ludex$Configs","_Ludex$Configs$Mockup","Mockup","LeaderboardsMockupConfig","Leaderboards","PlayerMockupConfig","LeaderboardsConfig","N","leaderboard","handleWhenGameSDKStarted$","setupLeaderboardsMockup$","setupLeaderboards$","setupLeaderboardByConfigs$","LeaderboardList","LeaderboardConfig","Id","Name","addLeaderboard","autoSortRank","leaderboardId","setupMockGlobalLeaderboards$","setupMockFriendsLeaderboard$","setupMockGlobalTournamentLeaderboard$","NumOfLeaders","_id","createLeaderboardAsync","numberOfLeaders","random","Max","Min","ConnectedPlayers","NumOfPlayers","TournamentUtils","requestTournamentDataAsync","tournament","isExistLeaderboardId","FpsTracking","PerformanceMonitor","markName$","handleStartTraceFps$","unListenEvents$","off","handleLateUpdate$","startTraceFps$","mark","measure","fpsTraceDuration$","CCGame","traceStopped$","updateFPS$","fpsTraceIntervalTimer$","fpsTraceInterval$","_this$minFps$","_this$maxFps$","getFPS$","drawCalls","getDrawCalls$","deviceRender","getDeviceRender$","textureMemory","getTextureMemory$","minFps$","maxFps$","putMetric","putAttr","title","floor","numDrawCalls","renderer","memoryStatus","TrackingDuration","TrackingInterval","RemoteConfig","REQUEST_HOT_RELOAD","handleHotReload$","REQUEST_UPDATE_CONFIG","handleUpdateConfig$","restart","GAMEPLAY_UPDATE_CONFIG","config","REMOTE_CONFIG_UPDATED","_Ludex$Configs$Debugg","Debugger","Profiler","PluginsManager","initHybridFileCache$","HybridFileCachePlugin","init","LanguagesPlugin","LeaderboardsPlugin","RemoteConfigPlugin","DynamicAtlasPlugin","DynamicAssetsPlugin","CanvasRecorderPlugin","PerformanceMonitorPlugin","AdaptivePerformancePlugin","FrameCapturePlugin","DailyRewardsPlugin","sdk","SceneManager","testScene$","isClearedMark$","callbackSwitchScene$","MARK_IS_TEST_SCENE","setTestScene$","SWITCH_SCENE","switchScene$","PRELOAD_SCENE","preloadScene$","correctSceneName$","sceneName","testScene","getTestScene$","sceneData","SceneUtils","isSceneLoaded","ScreenUtils","showLoadingFullScreen","startScene$","startMeasure$","sceneAsset","loadSceneAsync$","onSceneProgress$","runSceneAsync$","setSceneData$","markIsSceneLoaded","clearTestMark$","stopMeasure$","handleSceneLaunched$","isPreload","onProgress","bundle","main","loadScene","runScene","action","groupCollapsed","success","rmAttr","groupEnd","finished","total","progress","percent","setLoadingProgress","_this$callbackSwitchS","hideLoadingFullScreen","AnalyticsUtils","switchSceneTracking","addMetadata","currentScene","SCENE_RENDERED","_Object$keys$","onSwitchScene","attr","currentData","LoadResources","resetScreenEntry","entry","state","removeFromParent","order","prefab","useCount","ScreenManager","screens$","onPrefabReadyCallbacks$","bindEventHandlers$","OPEN_SCREEN","handleOpenScreen$","CLOSE_SCREEN","handleCloseScreen$","PRELOAD_SCREEN","handlePreloadScreen$","PRELOAD_SCREENS","handlePreloadScreens$","handleSwitchScene$","openScreen","screenName","screenData","closeScreen","addScreenQueues$","loadScreen$","validateScene$","initScreens$","preloadScreens$","resetAllScreenParents$","screenHolder","getScreenHolder$","configs","screens","ScreenNames","isEmpty","screenNames","join","addScreens$","_scene$getComponentIn","getComponentInChildren","_entry$order","isScreenNameValid$","reorderScreens$","loadPrefabAsync","emitPrefabReady$","autoPreload","getScreen$","Prefab","screenNode","instantiate","addChild","readyEntries","_entry$screen","setSiblingIndex","getOrTryAddScreen$","queueScreen$","GeneralUtils","setBlockInput","incrementUseCount$","showScreen$","_this$onPrefabReadyCa","callbacks","eventPayload","OPENING_SCREEN","open","updateAnalytics$","_x5","_x6","_x7","updateCurrentPage","CLOSING_SCREEN","close","_x8","isOpening","trackCurrentPage","currentScreen","removeMetadata","closeAllScreens","_this$onPrefabReadyCa2","Core","_Ludex$Plugins$Analyt","Plugins","Analytics","AnalyticsEvents","context","analytics","LudosSystem","adsManager$","matchManager$","playerManager$","logEngineReady$","ANALYTICS_READY","ENGINE_READY","createManager$","sceneManager$","screenManager$","engineManager$","layoutManager$","pluginsManager$","initManagers$","_this$adsManager$","_this$matchManager$","_this$playerManager$","CORE_BOOTING","handleWhenCoreBoot$","CORE_STARTING","handleWhenCoreStart$","CORE_READY","handleWhenCoreReady$","listenLayoutChanges","inited","handleCocosInit$","Game","EVENT_GAME_INITED","REQUEST_CORE_START","_this$playerManager$2","_this$matchManager$2","setupDefaultGameData","setupDefaultMatchData","_this$playerManager$3","initPlugins$","syncPlatformPlayerData","LOAD_START","processPreStartGame$","preloadScenes$","processBootSceneLaunched$","runBootScene$","StartSDKAfterLoadGame","waitTo","extra","waitSDKInitiatedAsync","waitGameResume$","processStartGame$","EVENT_RESUME","switchScene","SceneKeys","PLAYABLE_SCENE","BOOT_SCENE","getSessionContextType","preloadDashboardScene","preloadGameScene","LOAD_COMPLETE","PLAYER_INFO_LOADED","startProcessContextData$","startGameAsync$","preloadScreens","retries","startGameAsync","JSON","stringify","APP_READY","_this$playerManager$4","processContextData","trackDeviceInfo$","addEventListener","initLanguages","initFrameCapture","initDailyRewards","initLeaderboards","initDynamicAtlas","initDynamicAssets","initCanvasRecorder","initPerformanceMonitor","initAdaptivePerformance","getDeviceInfo$","isES5","heapMemory","audioState","orientation","gpuRenderer","supportWebp","isSupportWebp","log_type","is_es5","pixel_ratio","sdk_platform","getPlatform","screen_orientation","audio_state","heap_memory","support_webp","gpu_renderer","webgl_version","webglVersion","max_texture_size","hardware_concurrency","hardwareConcurrency","deviceInfo","trackDeviceInfo","__sdkLoad","ensure","ccclass","_decorator","executeInEditMode","PIPELINE_NAME","LAYOUT_NAME","RENDER_FLAGS","rendering","SceneFlags","UI","BLEND","OPAQUE","DRAW_INSTANCING","Optimized2DPipelineBuilder","clearColor$","gfx","Color","viewport$","Viewport","lightInfo$","LightInfo","isValidCamera$","camera","getOrGenerateWindowID$","_pipelineInfo","user","cclegacy","currentID","windowID","syncViewport$","vp","viewport","left","top","z","syncClearColor$","cc","clearColor","cameras","ppl","colorName","addRenderWindow","Format","RGBA8","pass","addRenderPass","setViewport","loadOp","clearFlag","ClearFlagBit","COLOR","LoadOp","CLEAR","LOAD","addRenderTarget","StoreOp","STORE","addQueue","QueueHint","addSceneOfCamera","builder","setCustomPipeline","_class2","_Component","_inherits","Optimized2DPipelineComponent","_super","_createSuper","Component","windows","WeakMap"],"mappings":"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","file":"all.js","sourcesContent":["export default {\n  text: {\n    'core.nameless': 'Nameless',\n    'game.resume': 'Resume',\n    'game.restart': 'Restart',\n    'game.cancel': 'Cancel',\n    'game.challenge': 'Challenge\\nFriends',\n    'game.next': 'NEXT',\n    'game.completed': 'COMPLETED',\n    'game.tryAgain': 'Try again',\n    'game.retry': 'RETRY',\n    'game.startOverQ': 'Start Over?',\n    'game.startOverMsg': 'Start over? You\\'ll lose your current progress and begin from the start. Are you sure you want to restart?',\n    'game.startOver': 'START OVER',\n    'game.paused': 'Paused',\n    'game.end': 'End',\n    'game.quit': 'Quit',\n    'game.join': 'Join',\n    'game.joinLeaderboard': 'Join Leaderboard',\n    'game.continue': 'Continue',\n    'game.letsPlay': 'Let\\'s Play',\n    'game.logIn': 'Log in',\n    'game.create': 'Create',\n    'game.quitLevelShortMsg': 'Quit Level?',\n    'game.quitSingleMsg': 'Quit now? You\\'re so close to completing this level!',\n    'game.quitTourMsg': 'Quit now? You\\'re just a few levels away from ranking up!',\n    'game.level': 'Level',\n    'game.levelX': 'Level %{0}',\n    'game.hardLevel': 'Hard Level',\n    'game.result': 'Your Result',\n    'game.nextLevel': 'Next Level',\n    'game.win': 'You Win',\n    'game.lose': 'You Lose',\n    'game.draw': 'Draw',\n    'game.replay': 'Replay',\n    'game.boom': 'Boom!',\n    'game.timesUp': 'Time\\'s Up!',\n    'game.bombDesc': 'The bomb exploded!',\n    'game.timesUpDesc': 'Restart or add 2 minutes?',\n    'game.daily': 'Daily',\n    'game.weekly': 'Weekly',\n    'game.endsSoon': 'Ends Soon',\n    'game.endsIn': 'Ends %{0}',\n    'game.player': '1 player',\n    'game.nPlayers': '%{0} players',\n    'game.pTour': '%{0}\\'s Tournament',\n    'game.combo': 'Combo',\n    'game.tourLbUpdated': 'Duel!',\n    'settings.level': 'Level',\n    'settings.settings': 'Settings',\n    'settings.music': 'Music',\n    'settings.sound': 'Sound',\n    'settings.vibrate': 'Vibrate',\n    'settings.on': 'ON',\n    'settings.off': 'OFF',\n    'settings.notification': 'Notification',\n    'settings.report': 'Report',\n    'settings.share': 'Share',\n    'settings.invite': 'Invite Friends',\n    'settings.feedback': 'Feedback',\n    'settings.createShortcut': 'Create\\nShortcut',\n    'settings.or': 'OR',\n    'settings.customMode': 'Custom\\nMode',\n    'custom.customLevel': 'Custom Level',\n    'custom.time': 'Time',\n    'custom.difficulty': 'Difficulty',\n    'custom.easy': 'Easy',\n    'custom.normal': 'Normal',\n    'custom.hard': 'Hard',\n    'custom.extreme': 'Extreme',\n    'custom.bombs': 'Bombs',\n    'custom.ads': 'Extra ads duration',\n    'custom.score': 'Score increase:',\n    'custom.play': 'Play',\n    'ads.cancelled': 'Sorry, No Rewards!\\nYou have cancelled the ad!',\n    'ads.loading': 'Loading ads...',\n    'ads.notReady': 'No ads to display!',\n    'ads.adAfterT': 'AD starting in %{0}...',\n    'ads.levelAfterT': 'Next level in %{0}...',\n    'ads.rewardNotice': 'Watch a short ad to receive\\nthese rewards:',\n    'ads.skip': 'Skip',\n    'ads.daily': 'Daily Rewards',\n    'ads.claim': 'Claim',\n    'ads.claimX2': 'Claim x2',\n    'ads.claimNow': 'Claim Now!',\n    'ads.await': 'Looking for rewards...',\n    'ads.open': 'Open',\n    'ads.coins': 'Get Coins',\n    'ads.getNow': 'Get Now',\n    'ads.freeMinutes': 'Get %{0} FREE minutes',\n    'ads.interNotice.hangTight': 'Short ad break, hang tight!',\n    'ads.interNotice.backInSec': 'Back to the game in just a sec!',\n    'ads.interNotice.quickAd': 'Quick ad, then more fun!',\n    'status.loading': 'Loading',\n    'status.congrats': 'Congratulations',\n    'status.allLevels': 'You have passed all levels.',\n    'status.later': 'Please come back later,\\nwe will update soon!',\n    'status.confirm': 'CONFIRMATION',\n    'status.confirmReset': 'ARE YOU SURE TO START OVER?',\n    'status.resetInfo': 'You will play the game again\\nfrom the beginning, at level 1.',\n    'status.no': 'NO',\n    'status.yes': 'YES',\n    'status.first': '1st',\n    'status.second': '2nd',\n    'status.third': '3rd',\n    'status.nth': '%{0}th',\n    'status.tap': 'Tap to continue',\n    'status.waitingX': 'Waiting%{0}',\n    'status.lbNotAvail': 'Leaderboard is empty.',\n    'status.tourNotAvail': 'No tournaments available.',\n    'pages.shop': 'Shop',\n    'pages.collections': 'Collections',\n    'pages.home': 'Home',\n    'pages.leaderboard': 'Leaderboard',\n    'pages.tournament': 'Tournament',\n    'guide.step1': 'Tap to connect',\n    'guide.step2': 'Connect similar tiles with less than 2 turns',\n    'guide.step3': 'Connect similar tiles with less than 2 turns',\n    'guide.step4': 'More than 2 turns are NOT allowed',\n    'guide.step5': 'There\\'s obstacle between the tiles',\n    'guide.timer': 'Remove all tiles before\\nthe time end',\n    'guide.combo': 'Remove tiles continuously\\nto increase combo!',\n    'guide.hint': 'Tap to reveal a connectable pair',\n    'guide.thunder': 'Tap to remove 2 pairs',\n    'guide.storm': 'Tap to rearrange the tiles',\n    'guide.pliers': 'Tap to remove bomb',\n    'guide.custom': 'Custom mode unlocked.\\n Press this button to set your own difficulty',\n    'interMsg.reviveAd': 'Watch an ad to revive yourself\\nKeep playing and don\\'t give up!',\n    'interMsg.doubleAd': 'Watching an ad doubles your rewards!',\n    'interMsg.ranked': 'Test your skills\\nin ranked tournaments',\n    'interMsg.friendChallenge': 'Challenge your friend\\nSee who can score higher!',\n    'interMsg.bragChallenge': 'Send a challenge to your friend\\nClaim bragging rights!',\n    'interMsg.clearTiles': 'Clear all tiles to\\nwin the level!',\n    'interMsg.beatClock': 'Beat the clock before\\ntime runs out!',\n    'interMsg.clearBombs': 'Clear bombs before\\nthey explode',\n    'interMsg.seasonPack': 'A season pack unlock\\nnew tile sets!',\n    'interMsg.collectStars': 'The more stars you collect\\nThe more coins you\\'ll be rewarded!',\n    'interMsg.competeInLb': 'Compete globally or with friends\\nRise to the top in tournaments!',\n    'interMsg.competeWithFriends': 'You can challenge a friend\\nTest each other\\'s reflexes!',\n    'interMsg.thunder': 'The Thunder power-up\\nblasts tiles away',\n    'interMsg.hint': 'A Hint power-up reveals\\nthe next pair',\n    'interMsg.pliers': 'Pliers can remove\\nany bomb instantly',\n    'interMsg.tornado': 'The Tornado power-up\\nshuffles the board!',\n    'interMsg.coins': 'Earn coins by completing levels\\nWin tournaments for even more!',\n    'interMsg.seasonTiles': 'A new tile set is unlocked\\nevery season packs',\n    'interMsg.dailyLogin': 'Log in daily to claim\\nbetter rewards!',\n    'interMsg.levelUp': 'Level up and earn coins\\nwith each victory!',\n    'interMsg.seasonRewards': 'Each season pack offers\\nnew tiles!',\n    'error.tryLater': 'Sorry, please try again later',\n    'error.soon': 'Coming Soon',\n    'error.noFriendsLb': 'Unable to load friends leaderboard. Please try again later.',\n    'error.noWorldLb': 'Unable to load world leaderboard. Please try again later.',\n    'error.createTourFail': 'Unknown error. Failed to Create Tournament',\n    'error.tourExists': 'You already have a tournament',\n    'error.challengeFail': 'Sorry, you cannot replay\\nat this time.',\n    'error.rewardFail': 'Unable to validate rewards. Please try again later...',\n    'error.tourEnded': 'Tournament has ended',\n    'error.tourJoinFail': 'Sorry, you cannot join\\nat this time.',\n    'error.noAd': 'No ads to display.',\n    'error.ratingNoAuth': 'You need to log in to rate the game.',\n    'error.ratingGameRated': 'You have already rated the game.',\n    'error.ratingFail': 'Failed to rate the game.',\n    'error.shortcutFail': 'Failed to create shortcut.',\n    'error.login': 'Failed to log in.',\n    'error.joinLb': 'Failed to join the leaderboard.',\n    'reward.day': 'Day',\n    'reward.dayX': 'Day %{0}',\n    'reward.starChestTitle': 'Star Chest',\n    'reward.starChestAvailable': 'Congrats, you have enough stars to open the chest!',\n    'reward.starChestUnavailable': 'Win more stars to open!',\n    'item.hint': 'Hint',\n    'item.thunder': 'Thunder',\n    'item.storm': 'Storm',\n    'item.pliers': 'Pliers',\n    'item.hintDesc': 'Shows a pair of tiles\\nthat can be connected.',\n    'item.thunderDesc': 'Remove 2 pair of tiles\\non the game field.',\n    'item.stormDesc': 'Randomly rearranges the \\ntiles on the game field.',\n    'item.pliersDesc': 'Removes a random bomb\\nfrom the game field.',\n    'theme.newTiles': 'New tiles',\n    'theme.summer': 'Summer Levels',\n    'theme.autumn': 'Autumn Levels',\n    'theme.winter': 'Winter Levels',\n    'theme.springFestival': 'Spring Festival Levels',\n    'theme.treePlantingFestival': 'Tree Planting Festival Levels',\n    'theme.blueSeaFestival': 'Blue Sea Festival Levels',\n    'theme.musicFestival': 'Music Festival Levels',\n    'theme.harvestFestival': 'Harvest Festival Levels',\n    'theme.foodFestival': 'Food Festival Levels',\n    'theme.snowFestival': 'Snow Festival Levels',\n    'theme.lightFestival': 'Light Festival Levels',\n    'theme.peaceFestival': 'Peace Festival Levels',\n    'theme.flowerFestival': 'Flower Festival Levels',\n    'theme.streetFestival': 'Street Festival Levels',\n    'theme.colorGarden': 'Color Garden Levels',\n    'theme.colorFestival': 'Color Festival Levels',\n    'theme.natureSummer': 'Nature Summer Levels',\n    'theme.snowMountain': 'Snow Mountain Levels',\n    'theme.iceFestival': 'Ice Festival Levels',\n    'theme.greenGrassFestival': 'Green Grass Festival Levels',\n    'theme.communityFestival': 'Community Festival Levels',\n    'theme.waterFestival': 'Water Festival Levels',\n    'theme.animalFestival': 'Animal Festival Levels',\n    'theme.lostFestival': 'Lost Festival Levels',\n    'theme.halloweenFestival': 'Halloween Festival Levels',\n    'theme.snowMusicFestival': 'Snow Music Festival Levels',\n    'theme.christmas': 'Christmas Levels',\n    'theme.springFlowerFestival': 'Spring Flower Festival Levels',\n    'theme.tetHoliday': 'Tet Holiday Levels',\n    'theme.seaFestival': 'Sea Festival Levels',\n    'theme.fireworkFestival': 'Firework Festival Levels',\n    'theme.halloweenHorror': 'Halloween Horror Levels',\n    'theme.midAutumn': 'Mid Autumn Levels',\n    'theme.christmasSweet': 'Christmas Sweet Levels',\n    'theme.newYearCountdown': 'New Year Countdown Levels',\n    'theme.happyNewYear': 'Happy New Year Levels',\n    'share.canYouDoBetter': 'Can you do better?',\n    'dashboard.unlockLevel': 'Unlock lv.%{0}'\n  },\n  texture: {\n    draw: 'locales/en/scenes/result-scene/resources/text_draw',\n    lose: 'locales/en/scenes/result-scene/resources/text_lose',\n    victory: 'locales/en/scenes/result-scene/resources/text_victory',\n    waiting: 'locales/en/scenes/result-scene/resources/text_waiting',\n    excellent: 'locales/en/scenes/game-scene/resources/effects/text-effect/excellent',\n    good: 'locales/en/scenes/game-scene/resources/effects/text-effect/good',\n    great: 'locales/en/scenes/game-scene/resources/effects/text-effect/great',\n    wellDone: 'locales/en/screens/level-complete-screen/resources/well_done',\n    freeRewards: 'locales/en/screens/get-rewards-screen/resources/free_rewards'\n  }\n}","import { game } from 'cc'\nimport GameEvents from '../constants/GameEvents'\nimport AdsUtils from '../utils/AdsUtils'\nimport LayoutUtils from '../utils/LayoutUtils'\n\nconst {\n    Events,\n    Configs: {\n        Ads: { Enabled, PreloadAds, ShowAdOnLoad },\n    },\n    Utils: { Time: T, Decorator },\n} = Ludex\n\nconst { event } = codex\n\nclass AdsManager {\n    public init() {\n        this.listenEvents$()\n        console.debug('Ads Manager: Initialized', { Enabled, PreloadAds, ShowAdOnLoad })\n    }\n\n    private listenEvents$ = (): void => {\n        event.on(Events.AD_CLOSED, this.requestResizeGame$)\n\n        event.catchUp(Events.GAME_READY, this.processPreloadAds$)\n\n        event.catchUp(Events.GAME_SDK_READY, this.processShowFirstInterstitialAd)\n\n        event.catchUp(Events.CONTEXT_DATA_PROCESSED, this.processShowBannerAds$)\n\n        event.catchUp(Events.CONTEXT_DATA_PROCESSED, () => {\n            game.on(GameEvents.LAYOUT_CHANGED, this.handleLayoutChanged$)\n        })\n    }\n\n    private requestResizeGame$ = () => {\n        event.emit(Events.REQUEST_RESIZE_GAME)\n    }\n\n    private processShowBannerAds$ = async () => {\n        if (!Enabled) return\n\n        // ? In Facebook, must wait for 5 seconds before showing banner ad (ad not ready)\n        if (GameSDK.isGameSDK('FacebookInstant')) {\n            await T.sleepAsync(5000)\n        }\n\n        AdsUtils.updateBannerAdsByLayout(LayoutUtils.getCurrentLayout())\n        AdsUtils.refreshBannerAdVisibility()\n    }\n\n    private processPreloadAds$ = async () => {\n        if (!PreloadAds) return\n        await T.sleepAsync(3 * 1000)\n\n        AdsUtils.preloadAds()\n    }\n\n    @Decorator.tryCatch()\n    private processShowFirstInterstitialAd = async () => {\n        if (!Enabled) return\n\n        const { Enabled: ShowAdOnLoadEnabled, DelaySeconds } = ShowAdOnLoad\n        if (!ShowAdOnLoadEnabled) return\n\n        if (DelaySeconds > 0) {\n            await T.sleepAsync(DelaySeconds * 1000)\n        }\n\n        // ? In Yandex, must be paused when showing interstitial ad\n        const isYandex = GameSDK.isGameSDK('Yandex')\n\n        if (isYandex) {\n            game.pause()\n        }\n\n        await AdsUtils.showInterstitialAdAsync({ forceLoad: true, contextType: 'preroll' })\n\n        if (isYandex) {\n            game.resume()\n        }\n    }\n\n    private handleLayoutChanged$ = () => {\n        AdsUtils.updateBannerAdsByLayout(LayoutUtils.getCurrentLayout())\n        AdsUtils.refreshBannerAdVisibility()\n    }\n}\n\nexport default AdsManager\n","import {\n    AssetManager,\n    DynamicAtlasManager,\n    director,\n    game,\n    Input,\n    input,\n    macro,\n    Settings,\n    settings,\n    sys,\n    View,\n} from 'cc'\nimport { DEV } from 'cc/env'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: { DynamicAtlas: DynamicAtlasConfig, PreferredFPS },\n    },\n    Utils: { Valid: V, Device: D },\n} = Ludex\n\nconst { event } = codex\n\ntype DynamicAtlasConfig = Ludex.Configs.DynamicAtlasConfig\n\nclass EngineManager {\n    public init() {\n        this.overrideSettings$()\n\n        this.setupAutoAtlas$()\n        this.setupBatcherLimit$()\n        this.setupDynamicAtlas$()\n        this.setupAssetDownloader$()\n        // this.setupOptimalCoreLoop$()\n        this.setupOptimalPipelines$()\n        this.setupEngineRunningState$()\n\n        console.debug('Engine Manager: Initialized', { PreferredFPS })\n    }\n\n    private overrideSettings$ = (): void => {\n        settings.overrideSettings(Settings.Category.ENGINE, 'debug', V.isDebugger())\n        // settings.overrideSettings(Settings.Category.ENGINE, 'platform', 'web-desktop')\n\n        // ? Don't allow resize when resizing\n        View.instance.resizeWithBrowserSize(false)\n\n        // ? frameRate in here not target frame rate, as preferred FPS.\n        if (D.isDesktop()) {\n            game.frameRate = PreferredFPS.Desktop\n        } else {\n            game.frameRate = PreferredFPS.Mobile\n        }\n    }\n\n    private setupAutoAtlas$ = (): void => {\n        AssetManager.instance.cacheAsset = true\n    }\n\n    private setupAssetDownloader$ = async (): Promise<void> => {\n        const { downloader } = AssetManager.instance\n\n        // ? Allow WebGL to load image faster (~5x), but memory usage will increase.\n        AssetManager.instance.allowImageBitmap = true\n\n        downloader.maxConcurrency = DEV ? 60 : 24\n        downloader.maxRequestsPerFrame = DEV ? 60 : 24\n\n        const webpSupport = await this.checkWebpSupport$()\n\n        // ? Double check webp support\n        // * Only need for test form DevTools, it block requests, not block webp feature in webgl\n        if (sys.hasFeature(sys.Feature.WEBP)) {\n            const originHasFeature = sys.hasFeature\n            sys.hasFeature = (feature: sys.Feature) => {\n                if (feature === sys.Feature.WEBP) {\n                    return webpSupport\n                }\n\n                return originHasFeature(feature)\n            }\n        }\n    }\n\n    private checkWebpSupport$ = () => {\n        // ? Use image to check webp support\n        return new Promise<boolean>((resolve) => {\n            const image = new Image()\n            image.onload = () => resolve(true)\n            image.onerror = () => resolve(false)\n            image.src = 'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA='\n        })\n    }\n\n    private setupOptimalPipelines$ = async () => {\n        const { transformPipeline } = AssetManager.instance\n\n        // ? Remove replaceOverrideAsset\n        transformPipeline.remove(1)\n    }\n\n    private setupEngineRunningState$ = (): void => {\n        // Resume engine when tap to game\n        input.on(Input.EventType.TOUCH_START, this.handleResumeEngine$)\n\n        // ? Only enable when game is ready, avoid pause when loading\n        event.catchUp(Events.GAME_READY, () => {\n            event.on(Events.VISIBILITY_HIDDEN, this.handlePauseEngine$)\n            event.on(Events.VISIBILITY_VISIBLE, this.handleResumeEngine$)\n        })\n    }\n\n    private handlePauseEngine$ = async () => {\n        console.debug('Engine: Paused', game.isPaused())\n        if (game.isPaused()) return\n\n        // TODO: save last volume\n        // await AudioUtils.turnOffMusic()\n        // game.pause()\n    }\n\n    private handleResumeEngine$ = async () => {\n        console.debug('Engine: Resumed', game.isPaused())\n        if (!game.isPaused()) return\n\n        // game.resume()\n        // await AudioUtils.turnUpMusic()\n    }\n\n    private setupDynamicAtlas$ = (): void => {\n        if (sys.isBrowser) {\n            this.setupDynamicAtlasForBrowser$()\n        } else if (sys.isNative) {\n            this.setupDynamicAtlasForNative$()\n        } else {\n            this.disableDynamicAtlas$()\n        }\n    }\n\n    private setupDynamicAtlasForBrowser$ = (): void => {\n        switch (sys.os) {\n            case sys.OS.IOS:\n                this.setupDynamicAtlasForIOS$()\n                break\n            case sys.OS.ANDROID:\n                this.setupDynamicAtlasForAndroid$()\n                break\n            case sys.OS.OSX:\n            case sys.OS.LINUX:\n            case sys.OS.WINDOWS:\n                this.setupDynamicAtlasForDesktop$()\n                break\n            default:\n                this.setupDynamicAtlasDefault$()\n                break\n        }\n    }\n\n    private setupDynamicAtlasForNative$ = (): void => {\n        switch (sys.platform) {\n            case sys.Platform.ANDROID:\n                this.setupDynamicAtlasForAndroid$()\n                break\n            case sys.Platform.IOS:\n                this.setupDynamicAtlasForIOS$()\n                break\n            default:\n                this.setupDynamicAtlasDefault$()\n                break\n        }\n    }\n\n    private setDynamicAtlas$ = (options: DynamicAtlasConfig): void => {\n        const { Enabled, MaxAtlasCount, MaxAtlasSize, MaxFrameSize } = options\n        const { instance } = DynamicAtlasManager\n\n        macro.CLEANUP_IMAGE_CACHE = !Enabled\n\n        instance.enabled = Enabled\n        instance.textureSize = MaxAtlasSize\n        instance.maxFrameSize = MaxFrameSize\n        instance.maxAtlasCount = MaxAtlasCount\n\n        // ? Set to false to save some memory, but textures may not fit as expected.\n        instance.textureBleeding = DynamicAtlasConfig.OptimizeAtlas.TextureBleeding\n\n        const maxSize = this.getMaxTextureSize$() || MaxAtlasSize\n\n        const correctSize = Math.min(MaxAtlasSize, maxSize)\n        instance.textureSize = correctSize\n\n        if (MaxFrameSize > correctSize) {\n            instance.maxFrameSize = correctSize\n        }\n    }\n\n    private getMaxTextureSize$ = (): number => {\n        if (!director.root) return -1\n        const { capabilities } = director.root.device\n        const { maxTextureSize } = capabilities\n\n        const textureSize = Math.min(D.maxTextureSize(), maxTextureSize)\n\n        // ? 1024 is the safe memory for other textures\n        const safeMemory = 1024\n\n        // ? Limit max texture size to 8192, almost games don't need more than this\n        if (textureSize > 8192) return 8192 - safeMemory\n\n        const { maxFrameSize = 0 } = DynamicAtlasManager.instance\n        const maxSize = textureSize - safeMemory\n\n        if (maxSize <= maxFrameSize || maxSize <= 0) return -1\n\n        return maxSize\n    }\n\n    private setupDynamicAtlasForIOS$ = (): void => {\n        const { IOS } = DynamicAtlasConfig\n        this.setDynamicAtlas$(IOS)\n    }\n\n    private setupDynamicAtlasForAndroid$ = (): void => {\n        const { Android } = DynamicAtlasConfig\n        this.setDynamicAtlas$(Android)\n    }\n\n    private setupDynamicAtlasForDesktop$ = (): void => {\n        const { Desktop } = DynamicAtlasConfig\n        this.setDynamicAtlas$(Desktop)\n    }\n\n    private setupDynamicAtlasDefault$ = (): void => {\n        const config: DynamicAtlasConfig = {\n            Enabled: true,\n            MaxAtlasCount: 1,\n            MaxAtlasSize: 4096,\n            MaxFrameSize: 1024,\n        }\n\n        this.setDynamicAtlas$(config)\n    }\n\n    private disableDynamicAtlas$ = (): void => {\n        macro.CLEANUP_IMAGE_CACHE = true\n        DynamicAtlasManager.instance.enabled = false\n    }\n\n    private setupBatcherLimit$ = (): void => {\n        macro.BATCHER2D_MEM_INCREMENT = 288\n        macro.MAX_LABEL_CANVAS_POOL_SIZE = 125\n    }\n}\n\nexport default EngineManager\n","import { game, macro, ResolutionPolicy, Size, screen, view } from 'cc'\nimport GameEvents from '../constants/GameEvents'\nimport GameWorld from '../constants/GameWorld'\nimport CocosUtils from '../utils/CocosUtils'\n\nconst {\n    Layout,\n    DesignSize: { Portrait, Landscape },\n    AcceptPortraitRatio,\n} = GameWorld\n\nconst {\n    Utils: { Decorator },\n    Configs: {\n        GameEngine: { AutoResizeCanvas },\n    },\n    Events,\n} = Ludex\n\nconst { ads, event } = codex\n\ntype Layout = (typeof Layout)[keyof typeof Layout]\ntype ResizeEventPayload = {\n    forcePixelRatio: number\n}\n\nclass LayoutManager {\n    private currentLayout$?: Layout\n    private resolutionPolicy$!: ResolutionPolicy\n\n    public init() {\n        this.listenResizeEvent$()\n        this.setupResolutionPolicy$()\n\n        console.debug('Layout Manager: Initialized', { AcceptPortraitRatio, AutoResizeCanvas })\n    }\n\n    private listenResizeEvent$ = (): void => {\n        if (AutoResizeCanvas && ResizeObserver) {\n            const resizeEventCallbacks = window.__listeners.resize ?? []\n            if (resizeEventCallbacks.length > 0) {\n                for (const callback of resizeEventCallbacks) {\n                    window.removeEventListener('resize', callback)\n                }\n            }\n\n            const observer = new ResizeObserver(this.handleBodyResize)\n            observer.observe(window.document.body)\n        }\n\n        event.on(Events.REQUEST_RESIZE_GAME, this.handleViewResizeBySystem$)\n    }\n\n    private setupResolutionPolicy$ = (): void => {\n        view.setOrientation(macro.ORIENTATION_AUTO)\n\n        this.resolutionPolicy$ = view.getResolutionPolicy()\n\n        this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.EXACT_FIT)\n\n        // ? Make canvas fit to world size\n        this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n    }\n\n    private isAdShowing$ = (): boolean => {\n        if (ads?.isAdFullSizeShowing()) {\n            console.error(' LayoutManager:handleViewResize skipped because ad is showing')\n            return true\n        }\n\n        return false\n    }\n\n    private readonly handleViewResizeBySystem$ = (payload: ResizeEventPayload) => {\n        if (this.isAdShowing$()) return\n\n        const maxDpr = CocosUtils.getMaxPixelRatio()\n        const { forcePixelRatio = maxDpr } = payload ?? {}\n\n        console.debug(' View resize by system', { forcePixelRatio, maxDpr })\n\n        window.devicePixelRatio = forcePixelRatio ?? maxDpr\n\n        this.setupOrientationByCanvasSize$()\n    }\n\n    @Decorator.debounce(100)\n    private handleBodyResize = (): void => {\n        if (this.isAdShowing$()) return\n\n        const maxDpr = CocosUtils.getMaxPixelRatio()\n\n        console.debug(' View resize by body', { maxDpr })\n\n        window.devicePixelRatio = maxDpr\n\n        this.setupOrientationByCanvasSize$()\n    }\n\n    private setupOrientationByCanvasSize$ = (): void => {\n        const screenRatio = this.getScreenRatio$()\n\n        // console.debug(' Screen Ratio', screenRatio)\n        // console.debug(' Portrait Ratio', AcceptPortraitRatio)\n        // console.debug(' Current Layout', this.currentLayout)\n\n        switch (GameWorld.PRIMARY_LAYOUT) {\n            case 'portrait':\n                this.setPortraitView$()\n                break\n            case 'landscape':\n                this.setLandscapeView$()\n                break\n            case 'auto':\n                if (screenRatio <= AcceptPortraitRatio) {\n                    this.setPortraitView$()\n                } else {\n                    this.setLandscapeView$()\n                }\n                break\n        }\n    }\n\n    private setPortraitView$ = (): void => {\n        const { WIDTH, HEIGHT } = Portrait\n\n        const isPrimaryLayoutPortrait = GameWorld.PRIMARY_LAYOUT === Layout.Portrait\n        if (this.currentLayout$ !== Layout.Portrait || isPrimaryLayoutPortrait) {\n            this.currentLayout$ = Layout.Portrait\n            this.setupLayoutStrategy$(WIDTH, HEIGHT)\n        }\n\n        this.resizeGameView$(WIDTH, HEIGHT)\n    }\n\n    private setLandscapeView$ = (): void => {\n        const { WIDTH, HEIGHT } = Landscape\n\n        const isPrimaryLayoutLandscape = GameWorld.PRIMARY_LAYOUT === Layout.Landscape\n        if (this.currentLayout$ !== Layout.Landscape || isPrimaryLayoutLandscape) {\n            this.currentLayout$ = Layout.Landscape\n            this.setupLayoutStrategy$(WIDTH, HEIGHT)\n        }\n\n        this.resizeGameView$(WIDTH, HEIGHT)\n    }\n\n    private setupLayoutStrategy$ = (designWidth: number, designHeight: number): void => {\n        const { width, height } = view.getDesignResolutionSize()\n        const contentStrategy = this.resolutionPolicy$.getContentStrategy()\n\n        // @ts-expect-error - This is a private property\n        const containerStrategy = this.resolutionPolicy$._containerStrategy.name\n\n        const isPortrait = this.currentLayout$ === Layout.Portrait\n        const isLandscape = this.currentLayout$ === Layout.Landscape\n\n        if (isPortrait) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_WIDTH)\n        }\n\n        if (isLandscape) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_HEIGHT)\n        }\n\n        if (isPortrait && !GameWorld.FULL_PORTRAIT_SIZE) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.SHOW_ALL)\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n        }\n\n        if (isLandscape && !GameWorld.FULL_LANDSCAPE_SIZE) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.EXACT_FIT)\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.PROPORTION_TO_FRAME)\n        }\n\n        const screenRatio = this.getScreenRatio$()\n        const { AcceptPortraitRatio } = GameWorld\n\n        if (screenRatio > AcceptPortraitRatio && isPortrait) {\n            this.resolutionPolicy$.setContentStrategy(ResolutionPolicy.ContentStrategy.FIXED_HEIGHT)\n        }\n\n        if (GameWorld.FULL_PORTRAIT_SIZE && isPortrait) {\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.EQUAL_TO_FRAME)\n        }\n\n        if (GameWorld.FULL_LANDSCAPE_SIZE && isLandscape) {\n            this.resolutionPolicy$.setContainerStrategy(ResolutionPolicy.ContainerStrategy.EQUAL_TO_FRAME)\n        }\n\n        if (\n            width !== designWidth ||\n            height !== designHeight ||\n            contentStrategy !== this.resolutionPolicy$.getContentStrategy() ||\n            // @ts-expect-error - This is a private property\n            containerStrategy !== this.resolutionPolicy$._containerStrategy.name\n        ) {\n            view.setDesignResolutionSize(designWidth, designHeight, this.resolutionPolicy$)\n        }\n\n        console.debug(' Change layout to', this.currentLayout$, this.resolutionPolicy$)\n\n        game.emit(GameEvents.LAYOUT_CHANGED, this.currentLayout$)\n    }\n\n    private resizeGameView$ = (designWidth: number, designHeight: number): void => {\n        // console.debug(' Design Size', { designWidth, designHeight })\n\n        const { Resolution } = GameWorld.DesignSize\n        const worldSize = new Size(designWidth / Resolution, designHeight / Resolution)\n\n        // console.debug(' World Size', worldSize)\n\n        // const canvasSize = screen.windowSize\n        // console.debug(' Canvas Size', canvasSize)\n\n        const screenWidth = CocosUtils.getScreenWidthCss()\n        const screenHeight = CocosUtils.getScreenHeightCss()\n\n        // console.debug(' Screen Size', { screenWidth, screenHeight })\n\n        const scaleX = screenWidth / worldSize.width\n        const scaleY = screenHeight / worldSize.height\n\n        // console.debug(' Scale factor', { scaleX, scaleY })\n\n        const gameSize = new Size(worldSize.width, worldSize.height)\n\n        const isFullPortraitSize = GameWorld.FULL_PORTRAIT_SIZE && this.currentLayout$ === Layout.Portrait\n        const isFullLandscapeSize = GameWorld.FULL_LANDSCAPE_SIZE && this.currentLayout$ === Layout.Landscape\n\n        if (isFullPortraitSize || isFullLandscapeSize) {\n            gameSize.width *= scaleX\n            gameSize.height *= scaleY\n        } else {\n            const scale = Math.min(scaleX, scaleY)\n            gameSize.width *= scale\n            gameSize.height *= scale\n        }\n\n        // console.debug(' Game Size', gameSize)\n\n        const viewWidth = CocosUtils.worldSizeToCssSize(gameSize.width)\n        const viewHeight = CocosUtils.worldSizeToCssSize(gameSize.height)\n\n        const viewSize = new Size(viewWidth, viewHeight)\n        screen.windowSize = viewSize\n\n        game.emit(GameEvents.VIEW_RESIZED, viewSize)\n\n        console.info(' View Resized', viewSize)\n    }\n\n    private getScreenRatio$ = (): number => {\n        const screenWidth = CocosUtils.getScreenWidthCss()\n        const screenHeight = CocosUtils.getScreenHeightCss()\n        return screenWidth / screenHeight\n    }\n}\n\nexport default LayoutManager\n","import DefaultMatchCustomData from '../constants/MatchCustomData'\nimport TileSpecialTypes from '../gameplay/game-objects/board/constants/TileSpecialTypes'\n\nconst {\n    Utils: { Valid: V, Object: O, Array: A },\n    Dtos: {\n        Match: { CustomData: MatchCustomData } = {},\n    },\n} = Ludex\n\ntype RequiredKeys<T> = {\n    [K in keyof T]-?: Record<string, unknown> extends Pick<T, K> ? never : K\n}[keyof T]\n\ntype LevelFenRequiredKeys = RequiredKeys<LevelFen>\nconst LevelFenKeys: Array<LevelFenRequiredKeys> = ['code', 'cols', 'encoding', 'idSize', 'rows']\n\ntype LevelRulesRequiredKeys = RequiredKeys<LevelRules>\nconst LevelRulesKeys: Array<LevelRulesRequiredKeys> = ['addRandomTilesPerMove', 'maxSpaceOfPair']\n\nclass MatchManager {\n    public init() {\n        console.debug('Match Manager: Initialized')\n    }\n\n    public setupDefaultMatchData(): void {\n        this.setupMatchData$()\n        this.setupMatchCustomData$()\n    }\n\n    private setupMatchCustomData$ = () => {\n        if (!MatchCustomData) return\n\n        // * Add default custom match data\n        // ? Check interface from /types/corecos/match.d.ts\n        MatchCustomData.addDefaults(DefaultMatchCustomData)\n\n        // ? Override validate function or add new validate function\n        MatchCustomData.addValidator('score', (score: unknown) => {\n            if (!V.isNumber(score) || score < 0) {\n                throw new Error(`score ${score} is invalid`)\n            }\n        })\n    }\n\n    private setupMatchData$ = () => {\n        if (!MatchCustomData) return\n\n        MatchCustomData.addValidator('challengeData', (challengeData: unknown) => {\n            if (challengeData === undefined || challengeData === null) {\n                return // * Allow undefined and null\n            }\n\n            if (!V.isObject(challengeData)) {\n                throw new Error(`challengeData ${challengeData} must be a record of string keys`)\n            }\n\n            const challengeDataObj = challengeData as Record<string, unknown>\n            const keysForChallengeData = Object.keys(challengeDataObj)\n\n            if (!A.has(keysForChallengeData, 'level')) {\n                throw new Error('challengeData.level is missing')\n            }\n\n            if (!V.isNumber(challengeDataObj.level)) {\n                throw new Error(`challengeData.level ${challengeDataObj.level} must be a number`)\n            }\n\n            if (!A.has(keysForChallengeData, 'fen')) {\n                throw new Error('challengeData.fen is missing')\n            }\n\n            this.validateFen$(challengeDataObj.fen)\n\n            if (!A.has(keysForChallengeData, 'gravity')) {\n                throw new Error('challengeData.gravity is missing')\n            }\n\n            if (!V.isString(challengeDataObj.gravity)) {\n                throw new Error(`challengeData.gravity ${challengeDataObj.gravity} must be a string`)\n            }\n\n            if (!A.has(keysForChallengeData, 'rules')) {\n                throw new Error('challengeData.rules is missing')\n            }\n\n            this.validateLevelRules$(challengeDataObj.rules)\n\n            if (!A.has(keysForChallengeData, 'time')) {\n                throw new Error('challengeData.time is missing')\n            }\n\n            if (!V.isNumber(challengeDataObj.time)) {\n                throw new Error(`challengeData.time ${challengeDataObj.time} must be a number`)\n            }\n        })\n    }\n\n    private validateFen$ = (fen: unknown) => {\n        if (!V.isObject(fen)) {\n            throw new Error(`challengeData.fen ${fen} must be a record of string keys`)\n        }\n\n        const validFenObject = this.validateKeys$(fen as Record<string, unknown>, LevelFenKeys)\n\n        if (!V.isNumber(validFenObject.idSize)) {\n            throw new Error('fen.idSize must be a number')\n        }\n\n        if (!V.isString(validFenObject.code)) {\n            throw new Error('fen.code must be a string')\n        }\n\n        if (!V.isNumber(validFenObject.rows)) {\n            throw new Error('fen.rows must be a number')\n        }\n\n        if (!V.isNumber(validFenObject.cols)) {\n            throw new Error('fen.cols must be a number')\n        }\n\n        if (!V.isObject(validFenObject.encoding)) {\n            throw new Error('fen.encoding must be a record of string keys')\n        }\n\n        const validEncoding = this.validateKeys$(\n            validFenObject.encoding as Record<string, unknown>,\n            O.vals(TileSpecialTypes),\n        )\n\n        // biome-ignore lint/complexity/noForEach: simple\n        Object.entries(validEncoding).forEach(([key, value]) => {\n            if (!V.isString(value)) {\n                throw new Error(`fen.encoding.${key} ${value} must be a string`)\n            }\n        })\n    }\n\n    private validateLevelRules$ = (rules: unknown) => {\n        if (!V.isObject(rules)) {\n            throw new Error(`challengeData.rules ${rules} must be a record of string keys`)\n        }\n\n        const validRules = this.validateKeys$(rules as Record<string, unknown>, LevelRulesKeys)\n\n        if (!V.isNumber(validRules.addRandomTilesPerMove)) {\n            throw new Error('rules.addRandomTilesPerMove must be a number')\n        }\n\n        if (!V.isNumber(validRules.maxSpaceOfPair)) {\n            throw new Error('rules.maxSpaceOfPair must be a number')\n        }\n    }\n\n    private validateKeys$ = <T extends string>(\n        obj: Record<string, unknown>,\n        keys: ReadonlyArray<T>,\n    ): Record<T, unknown> => {\n        const objKeys = Object.keys(obj) as Array<T>\n\n        // biome-ignore lint/complexity/noForEach: simple\n        objKeys.forEach((key) => {\n            if (!A.has(keys, key)) {\n                throw new Error(`Key ${key} is missing`)\n            }\n        })\n\n        return obj\n    }\n}\n\nexport default MatchManager\n","import GameData from '../constants/GameData'\nimport PlayerData from '../constants/PlayerData'\nimport ItemKeys from '../gameplay/constants/ItemKeys'\n\nconst {\n    Utils: { Valid: V, Array: A, Object: O, Browser: B },\n    Dtos: { Player },\n} = Ludex\n\nconst { player } = codex\nconst GameName = window.GameName.replace(/ /g, '-')\n\nclass PlayerManager {\n    public init() {\n        console.debug('Player Manager: Initialized')\n    }\n\n    public setupDefaultGameData(): void {\n        // * Make player dtos is loose\n        // ? Use default value if value is invalid\n        Player.Data.makeLoose()\n        Player.GameData.makeLoose()\n\n        // * Add default player game data\n        // ? Check interface from /types/ludex/player.d.ts\n        Player.Data.addDefaults(PlayerData)\n        Player.GameData.addDefaults(GameData)\n\n        // ? Override validate function or add new validate function\n        Player.GameData.addValidator('stars', (stars: unknown) => {\n            if (!V.isNumber(stars) || stars < 0) {\n                throw new Error(`stars ${stars} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('totalLevel', (totalLevel: number) => {\n            if (!V.isNumber(totalLevel) || totalLevel < 1) {\n                // throw new Error(`totalLevel ${totalLevel} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('levelVersion', (levelVersion: number) => {\n            if (!V.isNumber(levelVersion) || levelVersion < 0) {\n                throw new Error(`levelVersion ${levelVersion} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('lastRewardedItems', (lastRewardedItems: number) => {\n            if (!V.isNumber(lastRewardedItems) || lastRewardedItems < 0) {\n                throw new Error(`lastRewardedItems ${lastRewardedItems} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('lastCreateTournamentShown', (lastCreateTournamentShown: number) => {\n            if (!V.isNumber(lastCreateTournamentShown) || lastCreateTournamentShown < 0) {\n                throw new Error(`lastCreateTournamentShown ${lastCreateTournamentShown} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('guideItemShowed', (guideItemShowed: unknown) => {\n            if (!Array.isArray(guideItemShowed)) {\n                throw new Error(`guideItemShowed ${guideItemShowed} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('items', (items: unknown) => {\n            if (!V.isObject(items)) {\n                throw new Error(`items ${items} is invalid`)\n            }\n\n            const keys = Object.keys(items)\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const values = O.vals(items) as any[]\n\n            if (!A.has(keys, ItemKeys.HINT)) {\n                throw new Error(`item ${ItemKeys.HINT} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.THUNDER)) {\n                throw new Error(`item ${ItemKeys.THUNDER} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.STORM)) {\n                throw new Error(`item ${ItemKeys.STORM} not found`)\n            }\n\n            if (!A.has(keys, ItemKeys.PLIERS)) {\n                throw new Error(`item ${ItemKeys.PLIERS} not found`)\n            }\n\n            // biome-ignore lint/complexity/noForEach: simple\n            values.forEach((value) => {\n                if (!V.isNumber(value) || value < 0) {\n                    throw new Error(`item ${value} is invalid`)\n                }\n            })\n        })\n\n        Player.GameData.addValidator('tournamentProgress', (tournamentProgress: unknown) => {\n            if (!V.isObject(tournamentProgress)) {\n                throw new Error(`tournamentProgress ${tournamentProgress} is invalid`)\n            }\n        })\n\n        Player.GameData.addValidator('custom', (custom: unknown) => {\n            if (!V.isObject(custom)) {\n                throw new Error(`custom ${custom} is invalid`)\n            }\n\n            const keys = Object.keys(custom)\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n            if (!A.has(keys, 'time')) {\n                throw new Error('custom time not found')\n            }\n\n            if (!A.has(keys, 'difficulty')) {\n                throw new Error('custom tiles not found')\n            }\n\n            if (!A.has(keys, 'bombs')) {\n                throw new Error('custom bombs not found')\n            }\n\n            if (!A.has(keys, 'ads')) {\n                throw new Error('custom ads not found')\n            }\n        })\n\n        Player.GameData.addValidator('endlessScore', (endlessScore: number) => {\n            if (!V.isNumber(endlessScore) || endlessScore < 0) {\n                throw new Error(`endlessScore ${endlessScore} is invalid`)\n            }\n        })\n    }\n\n    public syncPlatformPlayerData(): void {\n        if (GameSDK.isGameSDK('MsGames')) {\n            this.syncOldPlayerDataForMsGames()\n            return\n        }\n    }\n\n    private syncOldPlayerDataForMsGames(): void {\n        const oldLocalStorageKey = `${GameName}_PlayerData`\n        const oldVersionData = B.getLocalStorage(oldLocalStorageKey)\n        if (!V.isObject(oldVersionData)) return\n\n        const oldPlayerData = new Player.Data(oldVersionData).toObject()\n\n        const currentPlayerData = player.getPlayerData()\n        if (!V.isObject(currentPlayerData)) return\n\n        const { level: currentLevel } = currentPlayerData.gameData\n        const { level: oldLevel } = oldPlayerData.gameData\n\n        if (currentLevel >= oldLevel) return\n\n        player.setPlayerData(oldPlayerData)\n    }\n\n    public requestConnectedPlayers(): void {\n        player.requestConnectedPlayers().catch((error) => {\n            console.warn('player.requestConnectedPlayers', error)\n        })\n    }\n}\n\nexport default PlayerManager\n","import { Director, type Scene, director, game } from 'cc'\n\nconst {\n    Utils: { Valid: V },\n} = Ludex\nconst { adaptivePerformance } = codex\n\nclass AdaptivePerformance {\n    public init() {\n        if (!adaptivePerformance) return\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        director.once(Director.EVENT_BEGIN_FRAME, this.handleBeginFrame$)\n        director.on(Director.EVENT_AFTER_SCENE_LAUNCH, this.handleAfterSceneLaunch$)\n    }\n\n    private handleBeginFrame$ = () => {\n        director.on(Director.EVENT_AFTER_UPDATE, this.lateUpdate$)\n        director.on(Director.EVENT_BEFORE_UPDATE, this.updateActualFPS$)\n    }\n\n    private handleAfterSceneLaunch$ = (scene: Scene) => {\n        if (!adaptivePerformance) return\n\n        adaptivePerformance.trackingScene(scene.name)\n    }\n\n    private lateUpdate$ = () => {\n        const dtInMs = game.deltaTime * 1000\n        adaptivePerformance?.updatePostStepDeltaTime(dtInMs)\n    }\n\n    private updateActualFPS$ = () => {\n        const actualFPS = director.root?.fps\n        if (!V.isNumber(actualFPS)) return\n        adaptivePerformance?.updateActualFPS(actualFPS)\n    }\n}\n\nexport default AdaptivePerformance\n","import { Director, director, game } from 'cc'\n\nconst { canvasRecorder } = codex\n\nclass CanvasRecorder {\n    public init() {\n        if (!game.canvas || !canvasRecorder) return\n\n        canvasRecorder.setCanvas(game.canvas)\n\n        // canvasRecorder.runTestCanvas()\n        // return\n\n        const options = canvasRecorder.getOptions()\n\n        const nextFrame = () => {\n            game.pause()\n            game.step()\n        }\n\n        const originWaitNextFrame = canvasRecorder.waitNextFrame\n        canvasRecorder.waitNextFrame = (force = false) => {\n            return new Promise((resolve, reject) => {\n                if (!force && !canvasRecorder.isCapturing()) {\n                    game.resume()\n                    return\n                }\n\n                if (options.syncFps) {\n                    director.once(Director.EVENT_AFTER_RENDER, resolve)\n                    nextFrame()\n                } else {\n                    originWaitNextFrame(force).then(resolve).catch(reject)\n                }\n            })\n        }\n    }\n}\n\nexport default CanvasRecorder\n","const { storage } = codex\n\nexport default class DailyRewards {\n    public init(): void {\n        this.initStorage$()\n    }\n\n    private initStorage$ = (): void => {\n        storage.addStorage('dashboardDailyRewards', {\n            hasShownPopup: false,\n        })\n    }\n}\n","import {\n    type AssetManager,\n    assetManager,\n    director,\n    game,\n    ImageAsset,\n    Rect,\n    type SimplifiedRequestItem,\n    Size,\n    Sprite,\n    SpriteFrame,\n    UITransform,\n} from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW } from 'cc/env'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Configs: {\n        GameEngine: {\n            DynamicAssets: { Resolution, IgnoreFiles, Compression },\n        },\n    },\n    Events,\n    Utils: { Array: A, Function: F, Device: D, Decorator },\n} = Ludex\n\nconst { event, storage, getBuildVersion } = codex\n\nconst IMAGE_EXTS = ['.png', '.jpg', '.jpeg', '.webp']\n\nconst ASSET = {\n    NONE: 0,\n    MEDIUM: 1,\n    QUALITY: 2,\n    ORIGINAL: 3,\n}\n\nclass DynamicAssets {\n    private isProcessing$ = false\n    private yield10msIfNeeded$ = F.timeSlice(10)\n\n    private targetScale$: number = 1\n    private sessionQuality$: number = ASSET.ORIGINAL\n\n    private failedAssets$: Set<string> = new Set()\n    private isAssetUpgraded$: Set<string> = new Set()\n    private upgradableAssets$: Map<string, SimplifiedRequestItem> = new Map()\n\n    public async init() {\n        if (EDITOR_NOT_IN_PREVIEW) return\n\n        this.targetScale$ = this.getOptimalScale$()\n        this.sessionQuality$ = this.getCurrentQuality$()\n\n        await this.initStorage$()\n        this.checkCacheVersion$()\n\n        const { transformPipeline } = assetManager\n        transformPipeline.insert(this.collectUpgradableAssets$, 2)\n\n        if (this.sessionQuality$ < ASSET.ORIGINAL) {\n            const scale = this.targetScale$ / Resolution.Source\n\n            this.injectSpriteUpdate$(scale)\n\n            this.injectSpriteFrameSlicedUV$(scale)\n            this.injectSpriteFrameCheckRect$(scale)\n            this.injectSpriteFrameResolution$(scale)\n        }\n\n        this.listenEvents$()\n    }\n\n    private initStorage$ = async () => {\n        await storage.addStorage(\n            'DynamicAssets',\n            {\n                currentQuality: 0,\n                buildVersion: '0',\n            },\n            true,\n        )\n    }\n\n    private getOptimalScale$ = (): number => {\n        const dpr = Math.round(D.pixelRatio())\n        const { Available, Source } = Resolution\n        const sortedScales = [...Available].sort((a, b) => a - b)\n\n        for (const scale of sortedScales) {\n            if (scale >= dpr) {\n                return Math.min(scale, Source)\n            }\n        }\n        return Source\n    }\n\n    private getCurrentQuality$ = (): number => {\n        if (this.targetScale$ === Resolution.Source && !Compression.Enabled) {\n            return ASSET.ORIGINAL\n        }\n\n        if (Compression.Enabled) {\n            return ASSET.MEDIUM\n        }\n\n        return ASSET.QUALITY\n    }\n\n    private checkCacheVersion$ = () => {\n        const buildVersion = getBuildVersion().toString()\n        const cacheConfig = storage.getStorage('DynamicAssets')\n        const { currentQuality: cacheCurrentQuality = 0, buildVersion: cacheBuildVersion } = cacheConfig ?? {}\n\n        const isLowQuality = this.sessionQuality$ < cacheCurrentQuality\n        const isSameBuildVersion = buildVersion === cacheBuildVersion\n\n        if (isLowQuality && isSameBuildVersion) {\n            this.sessionQuality$ = cacheCurrentQuality\n        }\n\n        storage.setStorageData('DynamicAssets', 'buildVersion', buildVersion)\n        storage.updateToWebStorage('DynamicAssets')\n    }\n\n    private listenEvents$ = (): void => {\n        if (!Compression.Enabled || this.sessionQuality$ === ASSET.ORIGINAL) return\n\n        event.catchUp(Events.GAME_READY, () => {\n            game.emit(GameEvents.REQUEST_UPGRADE_ASSET)\n        })\n\n        game.on(GameEvents.REQUEST_UPGRADE_ASSET, this.handleChangeQuality)\n    }\n\n    private injectSpriteUpdate$ = (scale: number) => {\n        Object.defineProperty(Sprite.prototype, 'spriteFrame', {\n            get: function () {\n                return this._spriteFrame\n            },\n            set: function (value) {\n                if (!value || !value.refreshed || this._spriteFrame === value) return\n\n                const lastSprite = this._spriteFrame\n                this._spriteFrame = value\n                this.markForUpdateRenderData(true)\n                this._applySpriteFrame(lastSprite)\n\n                const requiresAutoSize = this.sizeMode !== Sprite.SizeMode.CUSTOM\n                if (!requiresAutoSize) return\n\n                const uiTransform = this.node.getComponent(UITransform)\n                if (!uiTransform) return\n\n                // * A Sprite can change its size when its spriteFrame changes\n                const { width, height } = value.originalSize\n\n                // ? Restore resolution when replace new spriteFrame\n                const previousSize = new Size(width / scale, height / scale)\n                uiTransform.setContentSize(previousSize)\n            },\n        })\n    }\n\n    private injectSpriteFrameCheckRect$ = (_scale: number) => {\n        const originalCheckRect = SpriteFrame.prototype.checkRect\n\n        SpriteFrame.prototype.checkRect = function (...args) {\n            if (this.refreshed) return true\n\n            return originalCheckRect.apply(this, args)\n        }\n    }\n\n    private injectSpriteFrameSlicedUV$ = (scale: number) => {\n        // @ts-expect-error - This is a private method\n        const originalCalculateSlicedUV = SpriteFrame.prototype._calculateSlicedUV\n\n        // @ts-expect-error - This is a private method\n        SpriteFrame.prototype._calculateSlicedUV = function () {\n            const capInsets: number[] = this._capInsets ?? [0, 0, 0, 0]\n\n            const newCapInsets = capInsets.map((cap) => (cap + 1) * scale)\n\n            this._capInsets = newCapInsets\n\n            originalCalculateSlicedUV.apply(this)\n\n            this._capInsets = capInsets\n        }\n    }\n\n    private injectSpriteFrameResolution$ = (scale: number) => {\n        // @ts-expect-error - This is a private method\n        const originalRefreshTexture = SpriteFrame.prototype._refreshTexture\n\n        // @ts-expect-error - This is a private method\n        SpriteFrame.prototype._refreshTexture = function (...args) {\n            if (!this.name || this.refreshed) {\n                originalRefreshTexture.apply(this, args)\n                return\n            }\n\n            const { x, y, width, height } = this.rect\n\n            const xF = Number((x * scale).toFixed(2))\n            const yF = Number((y * scale).toFixed(2))\n            const widthF = Math.round(width * scale)\n            const heightF = Math.round(height * scale)\n\n            const newRect = new Rect(xF, yF, widthF, heightF)\n            const newOriginalSize = new Size(newRect.width, newRect.height)\n\n            this.refreshed = true\n\n            this.reset({\n                rect: newRect,\n                originalSize: newOriginalSize,\n            })\n\n            return originalRefreshTexture.apply(this, args)\n        }\n    }\n\n    @Decorator.debounce(1000)\n    private handleChangeQuality = async (): Promise<void> => {\n        if (this.isProcessing$ || !Compression.Enabled || this.sessionQuality$ >= ASSET.QUALITY) return\n\n        try {\n            this.isProcessing$ = true\n            const promiseRequest: Promise<boolean>[] = []\n            const initialUpgradedCount = this.isAssetUpgraded$.size\n\n            for (const item of this.upgradableAssets$.values()) {\n                const promise = this.processUpgradeQualityAsync$(item)\n                promiseRequest.push(promise)\n            }\n\n            if (promiseRequest.length < 1) {\n                return\n            }\n\n            await F.allSettled(promiseRequest)\n\n            if (this.isAssetUpgraded$.size > initialUpgradedCount) {\n                this.sessionQuality$++\n                this.saveStateToStorage$()\n            }\n\n            await this.updateSpriteFrames$()\n\n            this.requestUpdateDynamicAssets$()\n        } catch (error) {\n            console.warn('DynamicAssets: Handle change quality error', error)\n        } finally {\n            this.isProcessing$ = false\n        }\n    }\n\n    private getAssetQuality$ = (uuid: string): string => {\n        const path = `/native@${this.targetScale$}x/`\n        switch (this.sessionQuality$) {\n            case ASSET.QUALITY:\n                return `${path}quality/`\n            case ASSET.MEDIUM:\n                if (A.has(IgnoreFiles, uuid)) {\n                    return `${path}quality/`\n                }\n\n                return `${path}medium/`\n            default:\n                return '/native/'\n        }\n    }\n\n    private replaceAssetUrl$ = (uuid: string, url: string): string => {\n        if (this.sessionQuality$ === ASSET.ORIGINAL || !url.includes('/native/')) {\n            return url\n        }\n\n        if (EDITOR_NOT_IN_PREVIEW) {\n            return `${url}?v=${this.targetScale$}&q=${this.sessionQuality$}`\n        }\n\n        return url.replace('/native/', this.getAssetQuality$(uuid))\n    }\n\n    private saveStateToStorage$ = () => {\n        // ? Save for next launch game, use cache from current launch\n        storage.setStorageData('DynamicAssets', 'currentQuality', this.sessionQuality$)\n\n        storage.updateToWebStorage('DynamicAssets', true)\n    }\n\n    private updateSpriteFrames$ = async () => {\n        const scene = director.getScene()\n        if (!scene) return\n\n        const sprites = scene.getComponentsInChildren<Sprite>('cc.Sprite')\n\n        for (const sprite of sprites) {\n            const { spriteFrame } = sprite\n            if (!spriteFrame) continue\n\n            const { texture, original } = spriteFrame\n            let uuid = texture.uuid\n            if (original) {\n                uuid = original._texture.uuid\n            }\n\n            if (!this.isAssetUpgraded$.has(uuid)) continue\n\n            // @ts-expect-error - This is a private method\n            texture.updateImage()\n\n            await this.yield10msIfNeeded$()\n        }\n    }\n\n    private requestUpdateDynamicAssets$ = (): void => {\n        game.emit(GameEvents.REQUEST_DYNAMIC_ATLAS, { force: true })\n    }\n\n    private collectUpgradableAssets$ = (task: AssetManager.Task): void => {\n        // biome-ignore lint/suspicious/noAssignInExpressions: special\n        const input: Array<AssetManager.RequestItem> = (task.output = task.input)\n\n        let hasUpgradableAsset = false\n        for (const item of input) {\n            if (!A.has(IMAGE_EXTS, item.ext)) continue\n\n            const originalUrl = item.url\n            const upgradedUrl = this.replaceAssetUrl$(item.uuid, originalUrl)\n            if (upgradedUrl === originalUrl) continue\n\n            item.url = upgradedUrl\n\n            if (!this.upgradableAssets$.has(item.uuid)) {\n                const cacheItem: SimplifiedRequestItem = {\n                    ext: item.ext,\n                    url: item.url,\n                    uuid: item.uuid,\n                    options: item.options,\n                    resolution: this.targetScale$,\n                }\n                this.upgradableAssets$.set(item.uuid, cacheItem)\n                hasUpgradableAsset = true\n            }\n        }\n\n        if (hasUpgradableAsset) {\n            game.emit(GameEvents.REQUEST_UPGRADE_ASSET)\n        }\n    }\n\n    private processUpgradeQualityAsync$ = async (item: SimplifiedRequestItem): Promise<boolean> => {\n        const { uuid, url, ext, options, resolution } = item\n\n        if (!uuid || !url || !ext || !options || !resolution) return false\n\n        if (this.isAssetUpgraded$.has(uuid)) return true\n        if (this.failedAssets$.has(uuid)) return false\n\n        if (A.has(IgnoreFiles, uuid)) {\n            this.isAssetUpgraded$.add(uuid)\n            return true\n        }\n\n        const asset = assetManager.assets.get(uuid)\n\n        if (!(asset instanceof ImageAsset)) {\n            console.warn('DynamicAssets: Asset not found for upgrade', uuid)\n            // this.isAssetUpgraded$.add(uuid)\n            return false\n        }\n\n        const path = `/native@${resolution}x/`\n        const mediumPath = `${path}medium/`\n        const qualityPath = `${path}quality/`\n\n        const originalUrlConcept = url.replace(mediumPath, qualityPath)\n\n        if (originalUrlConcept === url) {\n            this.isAssetUpgraded$.add(uuid)\n            return true\n        }\n\n        const loadItem = { uuid, url: originalUrlConcept, options, resolution, ext }\n\n        return new Promise((resolve) => {\n            assetManager.loadAny(loadItem, options, (err, data: HTMLImageElement) => {\n                if (err) {\n                    console.warn(`[DynamicAssets] processUpgrade: Upgrade error for ${uuid.slice(0, 5)}`, err)\n                    this.failedAssets$.add(uuid)\n                    resolve(false)\n                    return\n                }\n\n                // O.assign(asset, { data: null })\n\n                asset.reset(data)\n                asset._nativeUrl = originalUrlConcept\n                this.isAssetUpgraded$.add(uuid)\n                game.emit(GameEvents.ASSET_QUALITY_CHANGE, { asset, item: loadItem })\n\n                resolve(true)\n            })\n        })\n    }\n}\n\nexport default DynamicAssets\n","import type {\n    Atlas,\n    AtlasInfo,\n    DebugData,\n    DrawAtlas,\n    DrawData,\n    Node,\n    PackedFrame,\n    SpriteFrame,\n    TexPack,\n    TexSize,\n    Texture2D,\n    TextureInfo,\n    UIRenderer,\n} from 'cc'\nimport { Director, DynamicAtlasManager, director, game, Label, UIOpacity } from 'cc'\nimport potpack from 'potpack'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: {\n            DynamicAtlas: {\n                OptimizeAtlas: {\n                    AtlasDebug,\n                    AutoAtlasSize,\n                    UsePowerOfTwo,\n                    AllowNonePackable,\n                    OnlyOptimizeWhenRenderTooLong,\n                },\n            },\n        },\n    },\n    Utils: { Json: J, Image: I, Function: F, Object: O, Mark },\n} = Ludex\n\nconst { event } = codex\n\nconst CONFIG = {\n    // Timing and Performance Thresholds\n    TIMING: {\n        MAX_INTERVAL_MS: 10000,\n        THROTTLE_UPDATE_MS: 800,\n        INTERVAL_INCREASE_MS: 1000,\n        MEAN_LAG_THRESHOLD_MS: 8,\n        MAX_RECORDED_RENDER_TIMES: 100,\n        RENDER_TIME_CHECK_INTERVAL_MS: 5000,\n    },\n    // Atlas Sizing and Packing Rules\n    PACKING: {\n        PACK_PADDING: 5,\n        MIN_FILL_RATE: 0.6,\n        BLEEDING_SPACE: 1,\n        COLLECT_PADDING: 2,\n        BLEED_SENSITIVE_SIZE: 16,\n    },\n    // Debugging Visualization Options\n    DEBUG: {\n        ENABLED: AtlasDebug,\n        FONT: '22px Arial',\n        TEXT_HEIGHT: 22,\n        TEXT_PADDING: 4,\n        IMAGE_QUALITY: 0.6,\n    },\n} as const\n\nclass DynamicAtlas {\n    // --- State Management ---\n    private isEffective$: boolean = true\n    private forceUpdateDynamicAtlas$: boolean = false\n    private readonly mutex$ = F.mutex()\n\n    // --- Render Time Tracking ---\n    private renderTimes$: number[] = []\n    private lastRenderTime$: number = 0\n    private renderTimeInterval$: number = CONFIG.TIMING.RENDER_TIME_CHECK_INTERVAL_MS\n\n    private atlasInfo$: AtlasInfo | null = null\n    private lastAtlasInfo$: AtlasInfo | null = null\n\n    // --- Collected Texture Info ---\n    private atlasIds$: Record<string, number> = {}\n    private collectInfo$: Map<string, TextureInfo> = new Map()\n    private packedFrames$: Set<SpriteFrame> = new Set()\n\n    // --- Debugging ---\n    private readonly debugCanvases$: Record<number, HTMLCanvasElement> = {}\n\n    public init() {\n        this.listenEvents$()\n        this.overrideDynamicAtlasManager$()\n\n        if (CONFIG.DEBUG.ENABLED) {\n            // Mark.setService(performance)\n            this.createPendingDebugCanvas$()\n        }\n    }\n\n    private listenEvents$ = (): void => {\n        game.on(GameEvents.REQUEST_DYNAMIC_ATLAS, this.requestUpdateDynamicAtlas$)\n\n        event.on(Events.SCENE_LAUNCHED, this.onSceneLaunched$)\n\n        event.catchUp(Events.GAME_READY, this.setupRenderListeners$)\n    }\n\n    private onSceneLaunched$ = (): void => {\n        this.resetPendingInfo$()\n        this.resetAllAtlases$()\n    }\n\n    private resetAllAtlases$ = (): void => {\n        // Reset all tracked frames\n        this.packedFrames$.forEach((frame) => {\n            if (frame.isValid) {\n                frame._resetDynamicAtlasFrame()\n            }\n        })\n        this.packedFrames$.clear()\n\n        // Reset manager\n        DynamicAtlasManager.instance.reset()\n\n        // Reset local state\n        this.atlasInfo$ = null\n        this.lastAtlasInfo$ = null\n\n        // Clear debug canvases\n        for (const key in this.debugCanvases$) {\n            delete this.debugCanvases$[key]\n        }\n    }\n\n    private overrideDynamicAtlasManager$ = (): void => {\n        const { instance } = DynamicAtlasManager\n\n        instance.packToDynamicAtlas = this.collectSpriteFrame$\n        instance.deleteAtlasSpriteFrame = this.deleteSpriteFrame$\n    }\n\n    private createPendingDebugCanvas$ = (): void => {\n        const canvas = this.createDebugCanvas$()\n        const canvasId = DynamicAtlasManager.instance.maxAtlasCount + 1\n        this.debugCanvases$[canvasId] = canvas\n    }\n\n    private checkRenderTimeThreshold$ = (): void => {\n        const meanRenderTime = this.calculateMeanRenderTimeAndReset$()\n\n        if (meanRenderTime > CONFIG.TIMING.MEAN_LAG_THRESHOLD_MS) {\n            this.handleLaggyFrame$()\n        }\n\n        director.once(Director.EVENT_AFTER_RENDER, () => {\n            setTimeout(() => {\n                this.checkRenderTimeThreshold$()\n            }, this.renderTimeInterval$)\n        })\n    }\n\n    private handleLaggyFrame$ = (): void => {\n        if (!this.isEffective$) {\n            this.renderTimeInterval$ = Math.min(\n                this.renderTimeInterval$ + CONFIG.TIMING.INTERVAL_INCREASE_MS,\n                CONFIG.TIMING.MAX_INTERVAL_MS,\n            )\n        }\n\n        this.requestUpdateDynamicAtlas$({ force: true })\n    }\n\n    private resetPendingInfo$ = (): void => {\n        this.atlasIds$ = {}\n        this.collectInfo$.clear()\n    }\n\n    private setupRenderListeners$ = (): void => {\n        director.on(Director.EVENT_BEFORE_RENDER, this.updateBeforeRenderTime$)\n        director.on(Director.EVENT_AFTER_RENDER, this.updateAfterRenderTime$)\n\n        if (OnlyOptimizeWhenRenderTooLong) {\n            event.catchUp(Events.SCENE_LAUNCHED, () => {\n                director.once(Director.EVENT_AFTER_RENDER, this.checkRenderTimeThreshold$)\n            })\n        }\n    }\n\n    private updateBeforeRenderTime$ = (): void => {\n        this.lastRenderTime$ = performance.now()\n    }\n\n    private updateAfterRenderTime$ = (): void => {\n        if (this.renderTimes$.length >= CONFIG.TIMING.MAX_RECORDED_RENDER_TIMES) {\n            this.renderTimes$.shift()\n        }\n\n        const renderTime = performance.now() - this.lastRenderTime$\n        this.renderTimes$.push(renderTime)\n    }\n\n    private calculateMeanRenderTimeAndReset$ = (): number => {\n        if (this.renderTimes$.length === 0) return 0\n\n        const totalRenderTime = this.renderTimes$.reduce((sum, time) => sum + time, 0)\n        const meanRenderTime = totalRenderTime / this.renderTimes$.length\n\n        this.renderTimes$.length = 0 // Clear the array for the next measurement interval\n\n        return meanRenderTime\n    }\n\n    private collectSpriteFrame$ = (comp: UIRenderer): void => {\n        if (!O.hasOwn(comp, 'spriteFrame')) return\n\n        const spriteFrame = comp.spriteFrame as SpriteFrame\n        const isValid = this.isSpriteFrameValidForAtlas$(comp, spriteFrame)\n        if (!isValid) return\n\n        const texture = this.getTexture$(spriteFrame)\n        const texId = texture?.getId()\n        if (!texId) return\n\n        const texSize = this.getTextureSizeFromTexture$(texture)\n        this.addTextureToCollectInfo$(texId, texSize, comp)\n\n        !OnlyOptimizeWhenRenderTooLong && this.requestUpdateDynamicAtlas$()\n    }\n\n    private deleteSpriteFrame$ = (spriteFrame: SpriteFrame): void => {\n        const texture = this.getTexture$(spriteFrame)\n        if (!texture) return\n\n        const atlas = this.getAtlas$()\n        atlas?.deleteInnerTexture(texture)\n\n        this.packedFrames$.delete(spriteFrame)\n        spriteFrame._resetDynamicAtlasFrame()\n    }\n\n    private isSpriteFrameValidForAtlas$ = (comp: UIRenderer, spriteFrame: SpriteFrame): boolean => {\n        const { enabled, node } = comp\n\n        if (!enabled || !spriteFrame) return false\n\n        if (!node.active || !node.activeInHierarchy) return false\n\n        if (!spriteFrame.packable && !AllowNonePackable) return false\n\n        if (spriteFrame.original) {\n            const currentTexture = spriteFrame.texture\n            const originalTexture = spriteFrame.original._texture\n            const isSameTexture = currentTexture === originalTexture\n            const isSameTextureId = currentTexture?.getId() === originalTexture?.getId()\n            if (isSameTexture || isSameTextureId) return false\n        }\n\n        if (comp.color.a < 1) return false\n\n        let current: Node | null = node\n        while (current) {\n            const opacityComp = current.getComponent(UIOpacity)\n            if (opacityComp && opacityComp.opacity < 1) return false\n            current = current.parent\n        }\n\n        const texSize = this.getTextureSize$(spriteFrame)\n        return !this.isTextureTooLarge$(texSize)\n    }\n\n    private addTextureToCollectInfo$ = (texId: string, texSize: TexSize, comp: UIRenderer): void => {\n        let info = this.collectInfo$.get(texId)\n        const padding = CONFIG.PACKING.COLLECT_PADDING\n        const w = texSize.w + padding\n        const h = texSize.h + padding\n\n        if (w <= padding || h <= padding) return\n\n        if (!info) {\n            info = { id: texId, w, h, x: -1, y: -1, components: new Set() }\n            this.collectInfo$.set(texId, info)\n        } else {\n            info.w = w\n            info.h = h\n        }\n\n        if (!info.components.has(comp)) {\n            info.components.add(comp)\n        }\n    }\n\n    private getTexture$ = (spriteFrame: SpriteFrame): Texture2D | null => {\n        return (spriteFrame.original?._texture ?? spriteFrame.texture) as Texture2D\n    }\n\n    private getTextureSize$ = (spriteFrame: SpriteFrame): TexSize => {\n        const tex = this.getTexture$(spriteFrame)\n        return this.getTextureSizeFromTexture$(tex)\n    }\n\n    private getTextureSizeFromTexture$ = (tex: Texture2D | null): TexSize => {\n        if (tex?.image) {\n            return { w: tex.image.width, h: tex.image.height }\n        }\n        return { w: tex?.width ?? 0, h: tex?.height ?? 0 }\n    }\n\n    private isTextureTooLarge$ = (texSize: TexSize): boolean => {\n        const { maxFrameSize } = DynamicAtlasManager.instance\n        return texSize.w >= maxFrameSize || texSize.h >= maxFrameSize\n    }\n\n    private rebuildAtlasIfNecessary$ = (): boolean => {\n        if (!this.atlasInfo$) return false\n\n        if (this.lastAtlasInfo$ && !this.forceUpdateDynamicAtlas$) {\n            const isSame = this.isSameAtlas$(this.lastAtlasInfo$, this.atlasInfo$)\n            this.isEffective$ = !isSame\n\n            if (isSame) {\n                return false\n            }\n        }\n\n        let atlas = this.getAtlas$()\n        if (!atlas?._texture) {\n            return false\n        }\n\n        const { packedInfo } = this.atlasInfo$\n        const { width: currentWidth, height: currentHeight } = atlas._texture\n\n        const packedWidth = packedInfo.width + CONFIG.PACKING.PACK_PADDING\n        const packedHeight = packedInfo.height + CONFIG.PACKING.PACK_PADDING\n\n        if (Math.max(packedWidth, packedHeight) <= CONFIG.PACKING.PACK_PADDING) return false\n\n        const maxDimension = Math.max(packedWidth, packedHeight)\n        const newWidth = UsePowerOfTwo ? maxDimension : packedWidth\n        const newHeight = UsePowerOfTwo ? maxDimension : packedHeight\n\n        atlas = this.resetAtlas$(atlas)\n        if (!atlas) {\n            return false\n        }\n\n        const isSizeIncreased = newWidth > currentWidth || newHeight > currentHeight\n        if (AutoAtlasSize || isSizeIncreased) {\n            atlas._texture.initWithSize(newWidth, newHeight)\n            const debugCanvas = this.debugCanvases$[this.getAtlasIndex$()]\n            if (debugCanvas) {\n                debugCanvas.width = newWidth\n                debugCanvas.height = newHeight\n            }\n        } else {\n            const debugCanvas = this.debugCanvases$[this.getAtlasIndex$()]\n            if (debugCanvas) {\n                debugCanvas.getContext('2d')?.clearRect(0, 0, debugCanvas.width, debugCanvas.height)\n            }\n        }\n\n        this.lastAtlasInfo$ = J.clone(this.atlasInfo$)\n        return true\n    }\n\n    private createAtlas$ = (): Atlas | null => {\n        const atlas = DynamicAtlasManager.instance.newAtlas()\n\n        if (atlas && CONFIG.DEBUG.ENABLED) {\n            const canvas = this.createDebugCanvas$()\n            const atlasIndex = this.getAtlasIndex$()\n            this.debugCanvases$[atlasIndex] = canvas\n        }\n\n        return atlas\n    }\n\n    private createDebugCanvas$ = (): HTMLCanvasElement => {\n        const { textureSize } = DynamicAtlasManager.instance\n        const canvas = document.createElement('canvas')\n        canvas.width = textureSize\n        canvas.height = textureSize\n        return canvas\n    }\n\n    private resetAtlas$ = (atlas: Atlas): Atlas | null => {\n        const { instance } = DynamicAtlasManager\n        const atlasIndex = instance._atlases.indexOf(atlas)\n\n        this.packedFrames$.forEach((frame) => {\n            if (frame.isValid) {\n                frame._resetDynamicAtlasFrame()\n            }\n        })\n        this.packedFrames$.clear()\n\n        atlas.destroy()\n\n        if (atlasIndex > -1) {\n            instance._atlases.splice(atlasIndex, 1)\n            if (instance._atlasIndex >= atlasIndex) {\n                instance._atlasIndex--\n            }\n        }\n\n        const newAtlas = this.getAtlas$()\n        return newAtlas\n    }\n\n    private getAtlas$ = (index?: number): Atlas | null => {\n        const { _atlases = [], _atlasIndex } = DynamicAtlasManager.instance\n        return _atlases[index ?? _atlasIndex] ?? this.createAtlas$()\n    }\n\n    private getAtlasIndex$ = (): number => {\n        return DynamicAtlasManager.instance._atlasIndex\n    }\n\n    private getAtlasSize$ = (): TexSize => {\n        const atlas = this.getAtlas$()\n        const { textureSize } = DynamicAtlasManager.instance\n        if (!atlas?._texture) return { w: textureSize, h: textureSize }\n\n        return {\n            w: Math.max(atlas._texture.width, textureSize),\n            h: Math.max(atlas._texture.height, textureSize),\n        }\n    }\n\n    private requestUpdateDynamicAtlas$ = F.debounce((payload?: { force?: boolean }): void => {\n        this.forceUpdateDynamicAtlas$ ||= payload?.force ?? false\n        this.updateDynamicAtlas$()\n    }, CONFIG.TIMING.THROTTLE_UPDATE_MS)\n\n    private updateDynamicAtlas$ = async () => {\n        if (!director.getScene()) return\n\n        const lock = await this.mutex$.use('updateDynamicAtlas')\n\n        Mark.start('DynamicAtlas Process')\n\n        try {\n            director.pause()\n            this.atlasInfo$ = null\n            this.prepareDrawInfo$()\n\n            const rebuildResult = this.rebuildAtlasIfNecessary$()\n\n            if (!rebuildResult) return\n\n            const success = this.packCollectedTextures$()\n            if (!success) return\n\n            game.emit(GameEvents.FINISHED_DYNAMIC_ATLAS)\n\n            requestAnimationFrame(this.printAtlasTextures$)\n        } catch {\n            // Error handled silently\n        } finally {\n            this.forceUpdateDynamicAtlas$ = false\n            Mark.stop('DynamicAtlas Process')\n            director.resume()\n            lock.release()\n        }\n    }\n\n    private prepareDrawInfo$ = (): void => {\n        if (this.collectInfo$.size < 1) return\n\n        const texturesToPack: TexPack[] = []\n\n        this.collectInfo$.forEach((info) => {\n            if (info.components.size < 1) return\n            texturesToPack.push(info)\n        })\n\n        this.calculateOptimizedAtlas$(texturesToPack)\n    }\n\n    private calculateOptimizedAtlas$ = (textures: TexPack[]): void => {\n        if (textures.length === 0) return\n\n        const { w, h, fill } = potpack(textures)\n\n        if (fill < CONFIG.PACKING.MIN_FILL_RATE) return\n\n        const atlasSize = this.getAtlasSize$()\n        if (w > atlasSize.w || h > atlasSize.h) {\n            const excessTextures = this.excessTextures$(textures, atlasSize)\n            if (excessTextures.length < 1) return\n\n            const excessSet = new Set(excessTextures)\n            const remainingTextures = textures.filter((t) => !excessSet.has(t))\n            this.calculateOptimizedAtlas$(remainingTextures)\n            return\n        }\n\n        this.atlasInfo$ = {\n            atlasSize,\n            atlasIndex: this.getAtlasIndex$(),\n            packedInfo: {\n                width: Math.round(w),\n                height: Math.round(h),\n                fillRate: fill,\n            },\n        }\n    }\n\n    private excessTextures$ = (textures: TexPack[], atlasSize: TexSize): TexPack[] => {\n        const { w, h } = atlasSize\n        const { excessWidth, excessHeight } = this.calculateExcessDimensions$(w, h, atlasSize)\n        return this.tryRemoveExcessTextures$(textures, excessWidth, excessHeight)\n    }\n\n    private calculateExcessDimensions$ = (packedWidth: number, packedHeight: number, atlasSize: TexSize) => {\n        const excessWidth = Math.max(0, packedWidth - atlasSize.w)\n        const excessHeight = Math.max(0, packedHeight - atlasSize.h)\n\n        return { excessWidth, excessHeight }\n    }\n\n    private tryRemoveExcessTextures$ = (textures: TexPack[], excessWidth: number, excessHeight: number) => {\n        let removedWidth = 0\n        let removedHeight = 0\n\n        const removedTextures: TexPack[] = []\n        const atlasIndex = this.getAtlasIndex$()\n\n        for (const texture of textures) {\n            const isExcessWidth = excessWidth > 0 && removedWidth < excessWidth\n            const isExcessHeight = excessHeight > 0 && removedHeight < excessHeight\n\n            if (!isExcessWidth && !isExcessHeight) continue\n\n            removedWidth += texture.w\n            removedHeight += texture.h\n\n            this.atlasIds$[texture.id] = Math.min(this.atlasIds$[texture.id] ?? atlasIndex, atlasIndex)\n\n            // * Reset coordinates to prevent drawing\n            texture.x = -1\n            texture.y = -1\n\n            removedTextures.push(texture)\n        }\n\n        return removedTextures\n    }\n\n    private packCollectedTextures$ = () => {\n        if (!this.atlasInfo$) return false\n\n        const atlas = this.getAtlas$()\n        if (!atlas) return false\n\n        const componentsToPack: UIRenderer[] = []\n        const textureCount = new Map<string, number>()\n        const texturesInCollectInfo = new Set<string>()\n\n        this.collectInfo$.forEach((info) => {\n            texturesInCollectInfo.add(info.id)\n\n            for (const comp of info.components) {\n                componentsToPack.push(comp)\n                const spriteFrame = (comp as UIRenderer & { spriteFrame?: SpriteFrame })?.spriteFrame\n                if (!spriteFrame) continue\n\n                const texture = this.getTexture$(spriteFrame)\n                const texId = texture?.getId()\n                if (!texId) continue\n\n                textureCount.set(texId, (textureCount.get(texId) ?? 0) + 1)\n            }\n        })\n\n        for (const comp of componentsToPack) {\n            this.packComponentIntoAtlas$(atlas, comp)\n        }\n\n        return true\n    }\n\n    private packComponentIntoAtlas$ = (atlas: Atlas, comp: UIRenderer): void => {\n        if (!O.hasOwn(comp, 'spriteFrame')) return\n\n        const frame = comp.spriteFrame as SpriteFrame\n        if (!frame) return\n\n        this.tryInsertSpriteFrame$(atlas, frame, comp)\n    }\n\n    private tryInsertSpriteFrame$ = (atlas: Atlas, spriteFrame: SpriteFrame, comp: UIRenderer) => {\n        if (spriteFrame.original) {\n            spriteFrame._resetDynamicAtlasFrame()\n        }\n\n        const { textureBleeding } = DynamicAtlasManager.instance\n        const packedFrame = this.drawTexture$(atlas, spriteFrame, textureBleeding)\n        if (!packedFrame) return\n\n        spriteFrame._setDynamicAtlasFrame(packedFrame)\n        this.packedFrames$.add(spriteFrame)\n\n        comp.setTextureDirty()\n        comp.markForUpdateRenderData(true)\n\n        this.updateLabelUVs$(comp)\n    }\n\n    private updateLabelUVs$ = (comp: UIRenderer): void => {\n        if (!(comp instanceof Label)) return\n\n        const renderData = comp.renderData\n        if (!renderData) return\n\n        renderData.vertDirty = false\n\n        const assembler = Label.Assembler.getAssembler(comp)\n        assembler?.updateUVs?.(comp)\n    }\n\n    private printAtlasTextures$ = (): void => {\n        if (!CONFIG.DEBUG.ENABLED) return\n\n        const { maxAtlasCount } = DynamicAtlasManager.instance\n\n        for (const index in this.debugCanvases$) {\n            const canvas = this.debugCanvases$[index]\n            if (canvas && Number(index) <= maxAtlasCount) {\n                const base64 = canvas.toDataURL('image/jpeg', CONFIG.DEBUG.IMAGE_QUALITY)\n                I.logImage(base64, 0.5)\n            }\n        }\n    }\n\n    private drawTexture$ = (atlas: Atlas, spriteFrame: SpriteFrame, textureBleeding: boolean): PackedFrame | null => {\n        const texture = this.getTexture$(spriteFrame)\n        if (!texture) return null\n\n        const texId = texture.getId()\n        const info = this.collectInfo$.get(texId)\n        if (!info) return null\n\n        const x = info.x ?? -1\n        const y = info.y ?? -1\n\n        if (x === -1 || y === -1) return null\n\n        const { width, height } = atlas._texture\n        if (x + info.w > width || y + info.h > height) return null\n\n        const { image } = texture\n        if (!image) return null\n\n        const space = textureBleeding ? CONFIG.PACKING.BLEEDING_SPACE : 0\n        const drawX = x + space\n        const drawY = y + space\n\n        let texInfo = atlas._innerTextureInfos[texId]\n\n        if (!texInfo) {\n            this.drawToAtlas$({ atlas, texId, image, drawX, drawY, space })\n\n            if (CONFIG.DEBUG.ENABLED) {\n                const usageCount = info.components.size\n                this.drawDebugFrame$({ image, texId, drawX, drawY, usageCount, space })\n            }\n\n            atlas._count++\n            texInfo = { texture, x: drawX, y: drawY }\n            atlas._innerTextureInfos[texId] = texInfo\n        }\n\n        const sx = spriteFrame.rect.x + (texInfo.x ?? drawX)\n        const sy = spriteFrame.rect.y + (texInfo.y ?? drawY)\n\n        return { x: sx, y: sy, texture: atlas._texture }\n    }\n\n    private drawToAtlas$ = (payload: DrawAtlas): void => {\n        const { atlas, image, drawX: x, drawY: y, space } = payload\n\n        const { _texture: atlasTexture } = atlas\n\n        if (space > 0) {\n            // Smaller frames are more likely to be affected by linear filtering\n            if (\n                image.width <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE ||\n                image.height <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE\n            ) {\n                atlasTexture.drawTextureAt(image, x - space, y - space)\n                atlasTexture.drawTextureAt(image, x - space, y + space)\n                atlasTexture.drawTextureAt(image, x + space, y - space)\n                atlasTexture.drawTextureAt(image, x + space, y + space)\n            }\n        }\n\n        atlasTexture.drawTextureAt(image, x, y)\n    }\n\n    private drawDebugFrame$ = (data: DebugData) => {\n        const atlasIndex = this.getAtlasIndex$()\n        const debugCanvas = this.debugCanvases$[atlasIndex]\n        if (!debugCanvas) return\n\n        const { image, texId, drawX, drawY, usageCount, space } = data\n        const ctx = debugCanvas.getContext('2d', { willReadFrequently: true })\n        const imgData = image?.data\n\n        if (!ctx || !imgData || !this.isDrawableImage(imgData)) return\n\n        this.drawDebugImageWithBleed$({ ctx, image, drawX, drawY, space })\n        this.drawDebugOutlineAndOverlay$({ ctx, image, drawX, drawY, space, usageCount })\n        this.drawDebugText$({ ctx, image, drawX, drawY, space, texId })\n    }\n\n    private isDrawableImage(data: unknown): data is HTMLCanvasElement | HTMLImageElement {\n        return data instanceof HTMLCanvasElement || data instanceof HTMLImageElement\n    }\n\n    private drawDebugImageWithBleed$ = (data: DrawData & { ctx: CanvasRenderingContext2D }) => {\n        const { ctx, image, drawX: x, drawY: y, space } = data\n\n        const imgData = image.data as HTMLCanvasElement | HTMLImageElement\n\n        if (space > 0) {\n            if (\n                image.width <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE ||\n                image.height <= CONFIG.PACKING.BLEED_SENSITIVE_SIZE\n            ) {\n                ctx.drawImage(imgData, x - space, y - space)\n                ctx.drawImage(imgData, x - space, y + space)\n                ctx.drawImage(imgData, x + space, y - space)\n                ctx.drawImage(imgData, x + space, y + space)\n            }\n        }\n\n        ctx.drawImage(imgData, x, y)\n    }\n\n    private drawDebugOutlineAndOverlay$ = (data: DrawData & { ctx: CanvasRenderingContext2D; usageCount: number }) => {\n        const { ctx, image, drawX: x, drawY: y, space, usageCount } = data\n\n        let outlineX = x\n        let outlineY = y\n        let outlineWidth = image.width\n        let outlineHeight = image.height\n\n        if (space > 0) {\n            outlineX -= space\n            outlineY -= space\n            outlineWidth += space * 2\n            outlineHeight += space * 2\n        }\n\n        const ratio = Math.min(usageCount / 15, 1)\n        const hue = 240 * (1 - ratio)\n        ctx.fillStyle = `hsla(${hue}, 100%, 50%, 0.2)`\n        ctx.fillRect(outlineX + 0.5, outlineY + 0.5, outlineWidth, outlineHeight)\n    }\n\n    private drawDebugText$ = (data: DrawData & { ctx: CanvasRenderingContext2D; texId: string }) => {\n        const { ctx, drawX: x, drawY: y, space, texId } = data\n\n        ctx.font = CONFIG.DEBUG.FONT\n        ctx.textAlign = 'left'\n        ctx.textBaseline = 'top'\n\n        const textMetrics = ctx.measureText(texId.replace('Tex.', ''))\n        const padding = CONFIG.DEBUG.TEXT_PADDING\n        const textX = x - space + 10\n        const textY = y - space + 10\n\n        ctx.fillStyle = 'rgba(0, 50, 0, 0.8)'\n        ctx.fillRect(\n            textX - padding,\n            textY - padding,\n            textMetrics.width + padding * 2,\n            CONFIG.DEBUG.TEXT_HEIGHT + padding * 2,\n        )\n\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.95)'\n        ctx.fillText(texId, textX, textY)\n    }\n\n    private isSameAtlas$ = (a: AtlasInfo, b: AtlasInfo): boolean => {\n        if (!a || !b || a.atlasIndex !== b.atlasIndex) return false\n\n        if (a.packedInfo.fillRate !== b.packedInfo.fillRate) return false\n        if (a.packedInfo.width !== b.packedInfo.width || a.packedInfo.height !== b.packedInfo.height) return false\n        return true\n    }\n}\n\nexport default DynamicAtlas\n","/**\n * @typedef {Object} PotpackBox\n * @property {number} w Box width.\n * @property {number} h Box height.\n * @property {number} [x] X coordinate in the resulting container.\n * @property {number} [y] Y coordinate in the resulting container.\n */\n\n/**\n * @typedef {Object} PotpackStats\n * @property {number} w Width of the resulting container.\n * @property {number} h Height of the resulting container.\n * @property {number} fill The space utilization value (0 to 1). Higher is better.\n */\n\n/**\n * Packs 2D rectangles into a near-square container.\n *\n * Mutates the {@link boxes} array: it's sorted (by height/width),\n * and box objects are augmented with `x`, `y` coordinates.\n *\n * @param {PotpackBox[]} boxes\n * @return {PotpackStats}\n */\nexport default function potpack(boxes) {\n\n    // calculate total box area and maximum box width\n    let area = 0;\n    let maxWidth = 0;\n\n    for (const box of boxes) {\n        area += box.w * box.h;\n        maxWidth = Math.max(maxWidth, box.w);\n    }\n\n    // sort the boxes for insertion by height, descending\n    boxes.sort((a, b) => b.h - a.h);\n\n    // aim for a squarish resulting container,\n    // slightly adjusted for sub-100% space utilization\n    const startWidth = Math.max(Math.ceil(Math.sqrt(area / 0.95)), maxWidth);\n\n    // start with a single empty space, unbounded at the bottom\n    const spaces = [{x: 0, y: 0, w: startWidth, h: Infinity}];\n\n    let width = 0;\n    let height = 0;\n\n    for (const box of boxes) {\n        // look through spaces backwards so that we check smaller spaces first\n        for (let i = spaces.length - 1; i >= 0; i--) {\n            const space = spaces[i];\n\n            // look for empty spaces that can accommodate the current box\n            if (box.w > space.w || box.h > space.h) continue;\n\n            // found the space; add the box to its top-left corner\n            // |-------|-------|\n            // |  box  |       |\n            // |_______|       |\n            // |         space |\n            // |_______________|\n            box.x = space.x;\n            box.y = space.y;\n\n            height = Math.max(height, box.y + box.h);\n            width = Math.max(width, box.x + box.w);\n\n            if (box.w === space.w && box.h === space.h) {\n                // space matches the box exactly; remove it\n                const last = spaces.pop();\n                if (last && i < spaces.length) spaces[i] = last;\n\n            } else if (box.h === space.h) {\n                // space matches the box height; update it accordingly\n                // |-------|---------------|\n                // |  box  | updated space |\n                // |_______|_______________|\n                space.x += box.w;\n                space.w -= box.w;\n\n            } else if (box.w === space.w) {\n                // space matches the box width; update it accordingly\n                // |---------------|\n                // |      box      |\n                // |_______________|\n                // | updated space |\n                // |_______________|\n                space.y += box.h;\n                space.h -= box.h;\n\n            } else {\n                // otherwise the box splits the space into two spaces\n                // |-------|-----------|\n                // |  box  | new space |\n                // |_______|___________|\n                // | updated space     |\n                // |___________________|\n                spaces.push({\n                    x: space.x + box.w,\n                    y: space.y,\n                    w: space.w - box.w,\n                    h: box.h\n                });\n                space.y += box.h;\n                space.h -= box.h;\n            }\n            break;\n        }\n    }\n\n    return {\n        w: width, // container width\n        h: height, // container height\n        fill: (area / (width * height)) || 0 // space utilization\n    };\n}\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype ResultChallengePayload = Ludex.Plugins.FrameCapture.Wideframe.ResultChallengePayload\n\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\ntype Status = 'win' | 'lose' | 'draw' | 'none'\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE_WITH_SCORE_BOX = `${WIDEFRAME_PATH}/result-challenge.png`\nconst WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX = `${WIDEFRAME_PATH}/update-challenge.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        depth: 0,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    playerPhoto: {\n        type: 'image',\n        depth: -2,\n        size: [160, 160],\n        position: [50, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    opponentPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [740, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    leftScore: {\n        type: 'text',\n        name: 'left-score',\n        depth: 3,\n        font: 'normal bold 44px',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [123, 372],\n    },\n    rightScore: {\n        type: 'text',\n        name: 'right-score',\n        depth: 3,\n        font: 'normal bold 44px',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [820, 372],\n    },\n    leftCrown: {\n        type: 'image',\n        name: 'crown',\n        depth: 3,\n        size: [92, 63],\n        position: [80, 80],\n        image: `${WIDEFRAME_PATH}/images/crown-icon.png`,\n    },\n    rightCrown: {\n        type: 'image',\n        name: 'crown',\n        depth: 3,\n        size: [92, 63],\n        position: [775, 80],\n        image: `${WIDEFRAME_PATH}/images/crown-icon.png`,\n    },\n} as const satisfies {\n    wideframe: Omit<RenderImage, 'image' | 'name'>\n    playerPhoto: Omit<RenderImage, 'image' | 'name'>\n    opponentPhoto: Omit<RenderImage, 'image' | 'name'>\n    leftScore: Omit<RenderText, 'text'>\n    rightScore: Omit<RenderText, 'text'>\n    leftCrown: RenderImage\n    rightCrown: RenderImage\n}\n\nconst StatusImage = {\n    win: {\n        name: 'win-image',\n        type: 'image',\n        depth: 2,\n        size: [277, 144],\n        position: [337.5, 174],\n        image: `${WIDEFRAME_PATH}/images/win.png`,\n    },\n    lose: {\n        name: 'lose-image',\n        type: 'image',\n        depth: 2,\n        size: [326, 145],\n        position: [313, 173.5],\n        image: `${WIDEFRAME_PATH}/images/lose.png`,\n    },\n    draw: {\n        name: 'draw-image',\n        type: 'image',\n        depth: 2,\n        size: [390, 144],\n        position: [281, 174],\n        image: `${WIDEFRAME_PATH}/images/draw.png`,\n    },\n} as const satisfies Record<Exclude<Status, 'none'>, RenderImage>\n\nconst renderResultChallenge = async (payload: ResultChallengePayload) => {\n    const initial = E.lift<RenderOptions>({})\n\n    const options = E.pipe(\n        addPlayerPhotos(payload),\n        addScores(payload),\n        addStatusImages(payload),\n        addWideframe(payload),\n    )(initial)\n\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'ResultChallenge',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { isPlayerFinished, isOpponentFinished } = payload\n        const hasFinishedPlayer = isPlayerFinished || isOpponentFinished\n        const name = hasFinishedPlayer ? 'result-challenge-with-score-box' : 'result-challenge-without-score-box'\n        const image = hasFinishedPlayer ? WIDEFRAME_IMAGE_WITH_SCORE_BOX : WIDEFRAME_IMAGE_WITHOUT_SCORE_BOX\n\n        return {\n            ...data,\n            wideframe: {\n                ...DEFAULT_RENDER_OPTIONS.wideframe,\n                image,\n                name,\n            },\n        }\n    }\n\nconst addPlayerPhotos =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        playerPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.playerPhoto,\n            name: payload.playerId,\n            image: payload.playerPhoto,\n        },\n        opponentPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.opponentPhoto,\n            name: payload.opponentId,\n            image: payload.opponentPhoto,\n        },\n    })\n\nconst addScores =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { isPlayerFinished, isOpponentFinished } = payload\n        const { playerScore = 0, opponentScore = 0 } = payload\n\n        const hasFinishedPlayer = isPlayerFinished || isOpponentFinished\n\n        if (!hasFinishedPlayer) {\n            return data\n        }\n\n        const leftScoreText = isPlayerFinished ? `${playerScore}` : '???'\n        const rightScoreText = isOpponentFinished ? `${opponentScore}` : '???'\n\n        return {\n            ...data,\n            leftScore: {\n                ...DEFAULT_RENDER_OPTIONS.leftScore,\n                text: leftScoreText,\n            },\n            rightScore: {\n                ...DEFAULT_RENDER_OPTIONS.rightScore,\n                text: rightScoreText,\n            },\n        }\n    }\n\nconst addStatusImages =\n    (payload: ResultChallengePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const status = getStatus(payload)\n        if (status === 'none') return data\n\n        const statusImage = StatusImage[status]\n\n        if (status === 'draw') {\n            return {\n                ...data,\n                statusImage,\n            }\n        }\n\n        const crown = status === 'win' ? DEFAULT_RENDER_OPTIONS.leftCrown : DEFAULT_RENDER_OPTIONS.rightCrown\n\n        return {\n            ...data,\n            crown,\n            statusImage,\n        }\n    }\n\nconst getStatus = (payload: ResultChallengePayload): Status => {\n    const { playerScore = 0, opponentScore = 0, isPlayerFinished, isOpponentFinished } = payload\n\n    const isGameFinished = isPlayerFinished && isOpponentFinished\n    if (!isGameFinished) return 'none'\n\n    const isDraw = playerScore === opponentScore\n    if (isDraw) return 'draw'\n\n    const isPlayerWin = playerScore > opponentScore\n    if (isPlayerWin) return 'win'\n\n    return 'lose'\n}\n\nexport default renderResultChallenge\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype ShareLeaderboardPayload = Ludex.Plugins.FrameCapture.Wideframe.ShareLeaderboardPayload\n\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/share-leaderboard.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 1500\nconst WIDEFRAME_HEIGHT = 2000\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        name: 'share-leaderboard',\n        type: 'image',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    avatar: {\n        type: 'image',\n        depth: -2,\n        size: [510, 510],\n        position: [510, 278],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    leaderPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [100, 100],\n        fallbackImage: FALLBACK_IMAGE,\n        // override position[1] to correct position at runtime\n        position: [436, 0],\n    },\n    leaderName: {\n        type: 'text',\n        depth: 1,\n        font: '600 48px',\n        // override position[1] to correct position at runtime\n        position: [600, 0],\n    },\n    leaderScore: {\n        type: 'text',\n        depth: 1,\n        font: '600 48px',\n        // override position[1] to correct position at runtime\n        position: [100, 0],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    leaderPhoto: Omit<RenderImage, 'image' | 'name'>\n    leaderName: Omit<RenderText, 'text' | 'name'>\n    leaderScore: Omit<RenderText, 'text' | 'name'>\n}\n\nconst renderShareLeaderboard = async (payload: ShareLeaderboardPayload): Promise<string | null> => {\n    const initial = E.lift<RenderOptions>({})\n    const options = E.pipe(addPlayerAvatar(payload), addLeaderAvatars(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'ShareLeaderboard',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareLeaderboardPayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: payload.playerId,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addLeaderAvatars =\n    (payload: ShareLeaderboardPayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const { leaders } = payload\n        const out = { ...data }\n\n        for (let index = 0; index < leaders.length; index++) {\n            const leader = leaders[index] as (typeof leaders)[number]\n            const { id, name, photo, score } = leader\n\n            const photoY = 1292 + 180 * index\n            const captionY = 1360 + 180 * index\n\n            out[`photo_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderPhoto,\n                position: [DEFAULT_RENDER_OPTIONS.leaderPhoto.position[0], photoY],\n                name: id,\n                image: photo,\n            }\n\n            out[`name_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderName,\n                position: [DEFAULT_RENDER_OPTIONS.leaderName.position[0], captionY],\n                name: id,\n                text: name,\n            }\n\n            out[`score_${id}`] = {\n                ...DEFAULT_RENDER_OPTIONS.leaderScore,\n                position: [DEFAULT_RENDER_OPTIONS.leaderScore.position[0], captionY],\n                name: id,\n                text: `${score}`,\n            }\n        }\n\n        return out\n    }\n\nexport default renderShareLeaderboard\n","import { LocaleFontPaths, LocaleFrameCaptureFontSize } from '../../../constants/Locales'\n\nconst {\n    Utils: { Error: E, Valid: V, Function: F },\n} = Ludex\n\nconst { frameCapture, language, monitorError } = codex\n\ntype ShareScorePayload = Ludex.Plugins.FrameCapture.Wideframe.ShareScorePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/share-score.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 1500\nconst WIDEFRAME_HEIGHT = 2000\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'share-score',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    avatar: {\n        type: 'image',\n        depth: -1,\n        size: [500, 500],\n        position: [500, 410],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    playerScore: {\n        type: 'text',\n        name: 'player-score',\n        depth: 1,\n        // ! to be extended with localized font\n        font: 'normal bold',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [750, 1120],\n    },\n    message: {\n        type: 'text',\n        name: 'message',\n        depth: 2,\n        color: '#8f5543',\n        textAlign: 'center',\n        position: [760, 1560],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    playerScore: Omit<RenderText, 'text'>\n    message: Omit<RenderText, 'text' | 'font'>\n}\n\nconst renderShareScore = async (payload: ShareScorePayload): Promise<string | null> => {\n    const initial = E.lift({})\n    const options = E.pipe(addPlayerAvatar(payload), addPlayerScore(payload), addMessage, addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    frameCapture.captureAsync({\n        name: 'ShareScore',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: `${payload.playerId}`,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addPlayerScore =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const fontStyle = DEFAULT_RENDER_OPTIONS.playerScore.font\n        const fontName = getLocalizedFontName()\n        const fontSize = getLocalizedFontSize()\n\n        return {\n            ...data,\n            playerScore: {\n                ...DEFAULT_RENDER_OPTIONS.playerScore,\n                text: `${payload.playerScore}`,\n                font: `${fontStyle} ${fontSize} ${fontName},`,\n            },\n        }\n    }\n\nconst addMessage = (data: RenderOptions): RenderOptions => {\n    const fontName = getLocalizedFontName()\n    const fontSize = getLocalizedFontSize()\n    const messageText = getLocalizedMessage()\n\n    const message = {\n        ...DEFAULT_RENDER_OPTIONS.message,\n        font: `normal ${fontSize} ${fontName},`,\n        text: messageText,\n    }\n\n    return { ...data, message }\n}\n\nconst getLocalizedFontName = () => {\n    const locale = language.getCurrentLocale()\n    const fontPath = LocaleFontPaths[locale]\n    const fileName = getFileName(fontPath)\n    return `${fileName}_LABEL`\n}\n\nconst getLocalizedFontSize = () => {\n    const locale = language.getCurrentLocale()\n    return LocaleFrameCaptureFontSize[locale] ?? '104px'\n}\n\nconst getFileName = (path: string) => {\n    const fragments = path.split('/')\n    const fullFileName = fragments[fragments.length - 1] ?? ''\n    const extension = fullFileName.lastIndexOf('.')\n\n    if (extension === -1) return fullFileName\n\n    const fileName = fullFileName.substring(0, extension)\n    return fileName\n}\n\nconst getLocalizedMessage = () => {\n    try {\n        return language.getText('share.canYouDoBetter')\n    } catch (error) {\n        monitorError?.sendException(F.toError(error), {\n            locale: language.getCurrentLocale(),\n            message: 'share.canYouDoBetter',\n        })\n\n        return 'share.canYouDoBetter'\n    }\n}\n\nexport default renderShareScore\n","import { LocaleFontPaths } from '../../../constants/Locales'\n\nconst {\n    Utils: { Error: E },\n} = Ludex\n\nconst { frameCapture, language } = codex\n\ntype Locale = Ludex.Plugins.Language.Locale\ntype ShareScorePayload = Ludex.Plugins.FrameCapture.Wideframe.ShareScorePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\ntype RenderText = Ludex.Plugins.FrameCapture.RenderText\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/invite-score.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'share-score-with-invite',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    avatar: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [85, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    playerScore: {\n        type: 'text',\n        name: 'player-score',\n        depth: 1,\n        // ! to be extended with localized font\n        font: 'normal bold',\n        color: '#f2a62e',\n        textAlign: 'center',\n        position: [165, 384],\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    avatar: Omit<RenderImage, 'image' | 'name'>\n    playerScore: Omit<RenderText, 'text'>\n}\n\nexport const LocaleFrameCaptureFontSize = {\n    en: '44px',\n    ru: '40px',\n} as const satisfies Record<Locale, string>\n\nconst renderShareScoreWithInvite = async (payload: ShareScorePayload): Promise<string | null> => {\n    const initial = E.lift({})\n    const options = E.pipe(addPlayerAvatar(payload), addPlayerScore(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    frameCapture.captureAsync({\n        name: 'ShareScore',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addPlayerAvatar =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        avatar: {\n            ...DEFAULT_RENDER_OPTIONS.avatar,\n            name: `${payload.playerId}`,\n            image: payload.playerPhoto,\n        },\n    })\n\nconst addPlayerScore =\n    (payload: ShareScorePayload) =>\n    (data: RenderOptions): RenderOptions => {\n        const fontStyle = DEFAULT_RENDER_OPTIONS.playerScore.font\n        const fontName = getLocalizedFontName()\n        const fontSize = getLocalizedFontSize()\n\n        return {\n            ...data,\n            playerScore: {\n                ...DEFAULT_RENDER_OPTIONS.playerScore,\n                text: `${payload.playerScore}`,\n                font: `${fontStyle} ${fontSize} ${fontName},`,\n            },\n        }\n    }\n\nconst getLocalizedFontName = () => {\n    const locale = language.getCurrentLocale()\n    const fontPath = LocaleFontPaths[locale]\n    const fileName = getFileName(fontPath)\n    return `${fileName}_LABEL`\n}\n\nconst getLocalizedFontSize = () => {\n    const locale = language.getCurrentLocale()\n    return LocaleFrameCaptureFontSize[locale] ?? '44px'\n}\n\nconst getFileName = (path: string) => {\n    const fragments = path.split('/')\n    const fullFileName = fragments[fragments.length - 1] ?? ''\n    const extension = fullFileName.lastIndexOf('.')\n\n    if (extension === -1) return fullFileName\n\n    const fileName = fullFileName.substring(0, extension)\n    return fileName\n}\n\nexport default renderShareScoreWithInvite\n","const {\n    Utils: { Error: E },\n} = Ludex\n\ntype UpdateChallengePayload = Ludex.Plugins.FrameCapture.Wideframe.UpdateChallengePayload\ntype RenderOptions = Ludex.Plugins.FrameCapture.RenderOptions\ntype RenderImage = Ludex.Plugins.FrameCapture.RenderImage\n\nconst WIDEFRAME_PATH = './wideframes'\nconst WIDEFRAME_IMAGE = `${WIDEFRAME_PATH}/update-challenge.png`\nconst FALLBACK_IMAGE = `${WIDEFRAME_PATH}/images/avatar-fallback.png`\nconst WIDEFRAME_WIDTH = 952\nconst WIDEFRAME_HEIGHT = 492\n\nconst DEFAULT_RENDER_OPTIONS = {\n    wideframe: {\n        type: 'image',\n        name: 'update-challenge',\n        depth: 0,\n        image: WIDEFRAME_IMAGE,\n        size: [WIDEFRAME_WIDTH, WIDEFRAME_HEIGHT],\n        position: [0, 0],\n    },\n    playerPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [50, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n    opponentPhoto: {\n        type: 'image',\n        depth: -1,\n        size: [160, 160],\n        position: [740, 140],\n        fallbackImage: FALLBACK_IMAGE,\n    },\n} as const satisfies {\n    wideframe: RenderImage\n    playerPhoto: Omit<RenderImage, 'image' | 'name'>\n    opponentPhoto: Omit<RenderImage, 'image' | 'name'>\n}\n\nconst renderUpdateChallenge = async (payload: UpdateChallengePayload): Promise<string | null> => {\n    const initial = E.lift<RenderOptions>({})\n    const options = E.pipe(addAvatars(payload), addWideframe)(initial)\n    const result = await E.applyAsync(applyCaptureAsync)(options)\n\n    if (E.isFailure(result)) {\n        const error = E.extractFailure(result)\n        console.error(error)\n        return null\n    }\n\n    return E.extractSuccess(result)\n}\n\nconst applyCaptureAsync = (renderOptions: RenderOptions) =>\n    codex.frameCapture.captureAsync({\n        name: 'UpdateChallenge',\n        width: WIDEFRAME_WIDTH,\n        height: WIDEFRAME_HEIGHT,\n        renderOptions,\n    })\n\nconst addWideframe = (data: RenderOptions): RenderOptions => ({\n    ...data,\n    wideframe: DEFAULT_RENDER_OPTIONS.wideframe,\n})\n\nconst addAvatars =\n    (payload: UpdateChallengePayload) =>\n    (data: RenderOptions): RenderOptions => ({\n        ...data,\n        playerPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.playerPhoto,\n            image: payload.playerPhoto,\n            name: payload.playerId,\n        },\n        opponentPhoto: {\n            ...DEFAULT_RENDER_OPTIONS.opponentPhoto,\n            image: payload.opponentPhoto,\n            name: payload.opponentId,\n        },\n    })\n\nexport default renderUpdateChallenge\n","import renderResultChallenge from './wideframes/renderResultChallenge'\nimport renderShareLeaderboard from './wideframes/renderShareLeaderboard'\nimport renderShareScore from './wideframes/renderShareScore'\nimport renderShareScoreWithInvite from './wideframes/renderShareScoreWithInvite'\nimport renderUpdateChallenge from './wideframes/renderUpdateChallenge'\n\nconst { frameCapture } = codex\n\nclass FrameCapture {\n    public async init() {\n        frameCapture.setRenderer('share-score', renderShareScore)\n        frameCapture.setRenderer('result-challenge', renderResultChallenge)\n        frameCapture.setRenderer('update-challenge', renderUpdateChallenge)\n        frameCapture.setRenderer('share-leaderboard', renderShareLeaderboard)\n        frameCapture.setRenderer('share-score-with-invite', renderShareScoreWithInvite)\n    }\n}\n\nexport default FrameCapture\n","import { AssetManager, game } from 'cc'\nimport { BUILD, PREVIEW } from 'cc/env'\nimport GameEvents from '../../constants/GameEvents'\n\nconst {\n    Events,\n    Configs: {\n        GameEngine: {\n            HybridFileCache: { Enabled, PreviewMode, BuildMode },\n        },\n    },\n    Utils: { Object: O, Function: F, Json: J, Decorator },\n} = Ludex\n\nconst { event, storage, getBuildVersion } = codex\n\nconst { downloader, pipeline, fetchPipeline } = AssetManager.instance\n\nconst CACHE_KEY_REGEX = /.*\\/([-a-z0-9@]+)\\.([^\\.]+)$/\n\nclass HybridFileCache {\n    private supportTypes$: string[] = []\n    private bundledFiles$: Record<string, BundledFile> = {}\n    private originHandler$: Record<string, Handler> = {}\n    private nativeAssetDictionary$: Record<string, boolean> = {}\n\n    public async init() {\n        if (!Enabled) return\n\n        await this.initStorage$()\n        await this.checkCacheVersion$()\n\n        this.initSupportedTypes$()\n        this.injectOptimalLoadPipeline$()\n        this.injectOptimalFetchPipeline$()\n        this.injectCacheExtensionPipeline$()\n\n        this.saveOriginDownloaders$()\n        this.registerCustomDownloader$()\n\n        this.setupBundledFiles$()\n\n        this.listenEvents$()\n\n        console.debug('Hybrid File Cache: Initialized', { supportTypes: this.supportTypes$ })\n    }\n\n    private initStorage$ = async () => {\n        return storage.addStorage(\n            'HybridFileCache',\n            {\n                commitId: 'unknown',\n                buildVersion: '0',\n                cachedFiles: {},\n                cachedBundles: {},\n                cachedExtensions: {},\n            },\n            true,\n        )\n    }\n\n    private checkCacheVersion$ = async () => {\n        let invalidateMode = BuildMode.InvalidateMode\n        if (PREVIEW) {\n            invalidateMode = PreviewMode.InvalidateMode\n        }\n\n        const commitId = window.CommitId\n        const buildVersion = getBuildVersion().toString()\n\n        const cacheCommitId = storage.getStorageData('HybridFileCache', 'commitId')\n        const cacheBuildVersion = storage.getStorageData('HybridFileCache', 'buildVersion')\n\n        storage.setStorageData('HybridFileCache', 'commitId', commitId)\n        storage.setStorageData('HybridFileCache', 'buildVersion', buildVersion)\n\n        const isCommitDifferent = cacheCommitId !== commitId\n        const isBuildVersionDifferent = cacheBuildVersion !== buildVersion\n\n        switch (invalidateMode) {\n            case 'version':\n                if (isBuildVersionDifferent) {\n                    await this.clearCache$()\n                }\n                break\n            case 'commitId':\n                if (isCommitDifferent) {\n                    await this.clearCache$()\n                }\n                break\n            default:\n                if (isBuildVersionDifferent || isCommitDifferent) {\n                    await this.clearCache$()\n                }\n                break\n        }\n\n        this.requestUpdateStorage()\n    }\n\n    private initSupportedTypes$ = () => {\n        if (PREVIEW) {\n            this.supportTypes$ = PreviewMode.SupportedExtensions\n        } else if (BUILD) {\n            this.supportTypes$ = BuildMode.SupportedExtensions\n        }\n    }\n\n    private setupBundledFiles$ = async () => {\n        try {\n            if (!BUILD || !BuildMode.Enabled) return\n\n            const downloadPromises = []\n\n            // ? Supported types has init at initSupportedTypes method\n            for (const type of this.supportTypes$) {\n                const bundleCache = this.getCachedBundles$(type)\n                if (bundleCache) continue\n\n                downloadPromises.push(this.downloadBundledFile$(type))\n            }\n\n            if (downloadPromises.length > 0) {\n                await F.allSettled(downloadPromises)\n            }\n\n            // ! Current not support load bundles\n            // await this.loadBundles()\n        } finally {\n            event.emit(Events.BUNDLE_READY)\n        }\n    }\n\n    private downloadBundledFile$ = async (type: string) => {\n        try {\n            const extension = type.replace('.', '')\n\n            let bundledFile = `./cache/bundle${extension.toUpperCase()}.${extension}`\n\n            if (type === 'bundle') {\n                bundledFile = './cache/bundleBUNDLE.json'\n            }\n\n            const res = await fetch(bundledFile, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            })\n\n            const data = await res.json()\n\n            this.setBundledCache$(type, data)\n\n            // console.log('Hybrid File Cache: Downloaded bundled file', { type, data: this.bundledFiles[type] })\n        } catch (error) {\n            console.error('Hybrid File Cache: Downloaded bundled file', { type, error })\n        }\n    }\n\n    /* private async loadBundles$ = () => {\n        try {\n            if (!A.has(this.supportTypes, 'bundle')) return\n\n            const bundles = ['internal', 'main', 'loadable']\n            const bundlePromises = []\n\n            for (const name of bundles) {\n                const promise = new Promise((resolve, reject) => {\n                    try {\n                        const bundleCache = this.getBundledCache('bundle', `config:${name}`)\n                        if (!bundleCache) return reject(new Error('Bundle cache not found'))\n\n                        console.log('Hybrid File Cache: Load bundle', { bundleCache })\n\n                        // ? Fix base path\n                        // @ts-expect-error - private property\n                        bundleCache.base = `assets/${name}/`\n\n                        let bundle = assetManager.getBundle(name)\n                        if (!bundle) {\n                            bundle = new AssetManager.Bundle()\n                        }\n\n                        bundle.init(bundleCache as any)\n\n                        assetManager.bundles.add(name, bundle)\n\n                        console.log('Hybrid File Cache: bundle added', { name, bundle })\n\n                        this.loadBundleAssets(name, bundle).then(resolve).catch(reject)\n                    } catch (error) {\n                        console.error('Hybrid File Cache: Load bundle assets', { name, error })\n                        reject(error)\n                    }\n                })\n\n                bundlePromises.push(promise)\n            }\n\n            await F.allSettled(bundlePromises)\n        } catch (error) {\n            console.error('Hybrid File Cache: loadBundleAssets', { error })\n        }\n    } */\n\n    /* private loadBundleAssets$ = (name: string, bundle: AssetManager.Bundle) => {\n        return new Promise((resolve, reject) => {\n            // TODO: research why loadAny not work\n            const opts = {\n                preset: 'bundle',\n                ext: 'bundle',\n                __isNative__: true,\n            }\n\n            assetManager.loadAny({ url: name }, opts, (err: Error | null, assets: any): void => {\n                if (err) {\n                    console.warn('Hybrid File Cache: Load bundle assets', { name, err })\n                    reject(err)\n                } else {\n                    console.log('Hybrid File Cache: Load bundle assets', { name, assets })\n                }\n\n                if (name === 'internal') return\n                resolve(assets)\n            })\n\n            if (name !== 'internal') return resolve([])\n\n            // @ts-expect-error - private property\n            const paths = Object.values(bundle.config.paths.map)\n\n            console.log('Hybrid File Cache: Load internal assets', { bundle, paths })\n\n            const uuids = paths.map((path) => {\n                // @ts-expect-error - private property\n                const path0 = path[0]\n                // console.log('Hybrid File Cache: Load internal assets', path0)\n                return path0.uuid\n            })\n\n            if (uuids.length < 1) return resolve([])\n\n            builtinResMgr._materialsToBeCompiled = []\n            assetManager.loadAny(uuids, {}, (err: Error | null, assets: any): void => {\n                if (err) {\n                    console.warn('Hybrid File Cache: Load internal assets', { err })\n                    reject(err)\n                } else {\n                    console.log('Hybrid File Cache: Load internal assets', { assets })\n                    for (const asset of assets) {\n                        builtinResMgr.addAsset(asset.name, asset)\n\n                        if (asset instanceof Material || Array.isArray(asset.passes)) {\n                            builtinResMgr._materialsToBeCompiled.push(asset)\n                        }\n                    }\n\n                    builtinResMgr.compileBuiltinMaterial()\n                }\n\n                resolve(assets)\n            })\n        })\n    } */\n\n    private injectOptimalFetchPipeline$ = () => {\n        if (!PreviewMode.Enabled && !BuildMode.Enabled) return\n\n        // ? Idx 2 is fetch pipeline\n        const fetchPipe = fetchPipeline.pipes[2]\n\n        // console.debug('Hybrid File Cache: inject optimal fetch pipeline', [...fetchPipeline.pipes])\n\n        if (!fetchPipe) return\n\n        const optimizedFetchPipe = (task: AssetManager.Task, done: Func) => {\n            try {\n                fetchPipe(task, done)\n            } catch (error) {\n                console.error('Hybrid File Cache: optimized fetch pipeline', { error })\n            }\n        }\n\n        fetchPipeline.remove(2)\n        fetchPipeline.insert(optimizedFetchPipe, 2)\n\n        // console.debug('Hybrid File Cache: injected optimal fetch pipeline', [...fetchPipeline.pipes])\n    }\n\n    private injectOptimalLoadPipeline$ = () => {\n        if (!PreviewMode.Enabled && !BuildMode.Enabled) return\n\n        // ? Idx 2 is load pipeline\n        const loadPipe = pipeline.pipes[2]\n\n        // console.debug('Hybrid File Cache: inject optimal load pipeline', [...pipeline.pipes])\n\n        if (!loadPipe) return\n\n        const optimizedLoadPipe = (task: AssetManager.Task, done: Func) => {\n            try {\n                loadPipe(task, done)\n            } catch (error) {\n                console.warn('Hybrid File Cache: optimized load pipeline', { error })\n                done(error)\n            }\n        }\n\n        pipeline.remove(2)\n        pipeline.insert(optimizedLoadPipe, 2)\n\n        // console.debug('Hybrid File Cache: injected optimal load pipeline', [...pipeline.pipes])\n    }\n\n    private injectCacheExtensionPipeline$ = () => {\n        if (!PreviewMode.Enabled) return\n        if (!PreviewMode.CacheUuidExtension) return\n\n        const cachedExtension: Record<string, boolean> = {}\n\n        const checkCacheExtension = (task: AssetManager.Task, done: Func) => {\n            task.output = task.input\n\n            for (let i = 0; i < task.input.length; i++) {\n                const item = task.input[i]\n                if (!item.id) continue\n\n                const cachedExt = this.getCacheExtension$(item.id)\n                if (!cachedExt) {\n                    cachedExtension[item.id] = false\n                    continue\n                }\n\n                item.url = item.url.replace(item.ext, cachedExt)\n                item.ext = cachedExt\n                cachedExtension[item.id] = true\n            }\n\n            done(null, null)\n        }\n\n        const saveAndOverrideIsNative = (originalPipeline: Func) => (task: AssetManager.Task, done: Func) => {\n            const input = [...task.input]\n\n            for (let i = 0; i < input.length; i++) {\n                const item = input[i]\n                if (!item.id) continue\n\n                const isCached = cachedExtension[item.id]\n\n                const isNativeRecorded = O.hasOwn(this.nativeAssetDictionary$, item.id)\n\n                if (!isNativeRecorded) {\n                    this.nativeAssetDictionary$[item.id] = item.isNative ?? false\n                }\n\n                if (isCached) {\n                    item.isNative = true\n                }\n            }\n\n            if (task.input.length > 0) {\n                // console.debug('Hybrid File Cache: process cache extension')\n            }\n\n            originalPipeline(task, done)\n        }\n\n        const restoreAndCacheExt = (task: AssetManager.Task, done: Func) => {\n            task.output = task.input\n\n            for (let i = 0; i < task.output.length; i++) {\n                const item = task.output[i]\n                if (!item.id) continue\n\n                const recordedInfo = this.nativeAssetDictionary$[item.id] ?? false\n                item.isNative = recordedInfo\n\n                const isCached = cachedExtension[item.id]\n\n                if (isCached) continue\n\n                this.setCacheExtension$(item.id, item.ext)\n            }\n\n            done(null, null)\n        }\n\n        pipeline.insert(checkCacheExtension, 1)\n        fetchPipeline.insert(checkCacheExtension, 1)\n\n        pipeline.insert(restoreAndCacheExt, 3)\n        fetchPipeline.insert(restoreAndCacheExt, 3)\n\n        const beforePipelines = [...pipeline.pipes]\n        const beforeFetchPipelines = [...fetchPipeline.pipes]\n\n        const pipeToWrap = beforePipelines[2]\n        if (pipeToWrap) {\n            pipeline.pipes[2] = saveAndOverrideIsNative(pipeToWrap)\n        }\n\n        const fetchPipeToWrap = beforeFetchPipelines[2]\n        if (fetchPipeToWrap) {\n            fetchPipeline.pipes[2] = saveAndOverrideIsNative(fetchPipeToWrap)\n        }\n\n        const afterPipelines = [...pipeline.pipes]\n        const afterFetchPipelines = [...fetchPipeline.pipes]\n\n        console.debug(\n            'Hybrid File Cache: inject cache extension pipelines',\n            beforePipelines,\n            beforeFetchPipelines,\n            afterPipelines,\n            afterFetchPipelines,\n        )\n    }\n\n    private saveOriginDownloaders$ = () => {\n        for (const type of this.supportTypes$) {\n            const handler = downloader.handlers[type]\n            if (!handler) continue\n\n            this.originHandler$[type] = handler\n        }\n\n        // console.debug('Hybrid File Cache: save origin downloaders', this.originDownloaders)\n    }\n\n    private registerCustomDownloader$ = () => {\n        for (const type of this.supportTypes$) {\n            if (type === 'bundle') continue\n            downloader.register(type, this.downloadFile$(type))\n        }\n\n        // console.debug('Hybrid File Cache: register custom downloaders', downloader.handlers)\n    }\n\n    private listenEvents$ = () => {\n        event.on(Events.SCENE_LOADED, this.requestUpdateStorage)\n\n        game.on(GameEvents.CLEAR_HYBRID_FILE_CACHE, this.clearCache$)\n    }\n\n    private getDownloadHandler$ = (type: string): Handler | null => {\n        return this.originHandler$[type] ?? null\n    }\n\n    private downloadFile$ = (type: string) => (url: string, options: Options, onComplete: Callback) => {\n        // console.log('Hybrid File Cache: Downloading file', { type, url, options, cache })\n        const cache = this.getCache$(type, url)\n\n        if (cache) {\n            // console.info('Hybrid File Cache: Cache hit', { url, options, cache })\n            return onComplete(null, cache)\n        }\n\n        const downloader = this.getDownloadHandler$(type)\n        if (!downloader) return onComplete(new Error('Downloader not found'), null)\n\n        downloader(url, options, (error: Error | null, data: unknown) => {\n            // console.info('Hybrid File Cache: Downloaded', { url, options, error, data })\n\n            !error && this.setCache$(type, url, data)\n            return onComplete(error, data)\n        })\n\n        // console.info('Hybrid File Cache: Downloading file', { type, url, options })\n    }\n\n    private getCacheKey$ = (type: string, url: string) => {\n        const match = url.match(CACHE_KEY_REGEX)\n        // console.info('Hybrid File Cache: Get cache key', { match, type, url })\n        if (!match) return null\n\n        const [_, uuid, extension] = match\n        // console.info('Hybrid File Cache: Get cache key', { uuid, extension, type })\n        if (!extension || type.indexOf(extension) < 0) return null\n\n        return `${uuid}:${type}`\n    }\n\n    private validateDataType$ = (data: unknown) => {\n        const isPreview = PREVIEW && PreviewMode.Enabled\n        const isDataJsonValid = Array.isArray(data) && O.hasOwn(data[0], '__type__')\n\n        if (isPreview && isDataJsonValid) {\n            const bundle = data[0].__type__\n            if (!PreviewMode.CachePrefab && bundle === 'cc.Prefab') {\n                return false\n            }\n\n            if (!PreviewMode.CacheScene && bundle === 'cc.SceneAsset') {\n                return false\n            }\n        }\n\n        return true\n    }\n\n    private setCache$ = (type: string, url: string, data: unknown) => {\n        const cacheKey = this.getCacheKey$(type, url)\n        if (!cacheKey) return\n\n        if (!this.validateDataType$(data)) return\n\n        const encodedData = J.clone(data)\n        // console.log('Hybrid File Cache: Encoded data', { type, url, data, encodedData })\n\n        storage.setStorageData('HybridFileCache', 'cachedFiles', { [cacheKey]: encodedData ?? {} })\n        this.requestUpdateStorage()\n    }\n\n    private getCache$ = (type: string, url: string) => {\n        const cacheKey = this.getCacheKey$(type, url)\n        // console.log('Hybrid File Cache: Get cache', { cacheKey, type, url })\n        if (!cacheKey) return null\n\n        const cachedFiles = this.getFileCaches$()\n\n        let cacheData = cachedFiles[cacheKey]\n        // console.info('Hybrid File Cache: Get cache data', { cachedFiles, cacheData })\n\n        if (!cacheData) {\n            cacheData = this.getBundledCache$(type, cacheKey)\n            // console.info('Hybrid File Cache: Get bundled cache', { cacheData })\n        }\n\n        if (!cacheData) {\n            // console.warn('Hybrid File Cache: Cache not found', { cacheKey, type, url })\n            return null\n        }\n\n        const decodedData = J.clone(cacheData)\n        // console.log('Hybrid File Cache: Decoded data', { type, url, decodedData })\n\n        return decodedData\n    }\n\n    private getFileCaches$ = () => {\n        return storage.getStorageData('HybridFileCache', 'cachedFiles') ?? {}\n    }\n\n    private getCachedBundles$ = (type: string) => {\n        const cachedBundles = storage.getStorageData('HybridFileCache', 'cachedBundles')\n        if (!cachedBundles) return null\n\n        const bundledFile = cachedBundles[type]\n        if (!bundledFile) return null\n\n        this.bundledFiles$[type] = bundledFile\n\n        return bundledFile\n    }\n\n    private getBundledCache$ = (type: string, cacheKey: string): AssetManager.Bundle | null => {\n        const bundledFile = this.bundledFiles$[type]\n        if (!bundledFile) return null\n\n        const key = cacheKey.replace(`:${type}`, '')\n\n        return bundledFile[key] ?? null\n    }\n\n    private setBundledCache$ = (type: string, data: BundledFile) => {\n        this.bundledFiles$[type] = data\n        storage.setStorageData('HybridFileCache', 'cachedBundles', { [type]: data })\n        this.requestUpdateStorage()\n    }\n\n    private getCacheExtension$ = (uuid: string) => {\n        const cacheExt = this.getCachedExtensions$()\n        return cacheExt[uuid]\n    }\n\n    private setCacheExtension$ = (uuid: string, ext: string) => {\n        storage.setStorageData('HybridFileCache', 'cachedExtensions', { [uuid]: ext })\n        this.requestUpdateStorage()\n    }\n\n    private getCachedExtensions$ = () => {\n        return storage.getStorageData('HybridFileCache', 'cachedExtensions') ?? {}\n    }\n\n    @Decorator.throttle(1000)\n    private requestUpdateStorage = () => {\n        // console.debug('Hybrid File Cache: request update storage')\n        storage.updateToWebStorage('HybridFileCache', false)\n    }\n\n    private clearCache$ = () => {\n        storage.initStorageData('HybridFileCache', 'cachedFiles', {})\n        storage.initStorageData('HybridFileCache', 'cachedBundles', {})\n\n        // ! Experimental: asset id will be not change often\n        // storage.initStorageData('HybridFileCache', 'cachedExtensions', {})\n\n        storage.updateToWebStorage('HybridFileCache', true)\n    }\n}\n\nexport default HybridFileCache\n","import { game } from 'cc'\nimport GameEvents from '../../constants/GameEvents'\nimport { AvailableLocales, LocaleFilePaths, type LocalesWithoutDefault } from '../../constants/Locales'\nimport DefaultLanguageData from '../../scenes/common/locales/en.json'\nimport ResourceUtils from '../../utils/ResourceUtils'\n\nconst {\n    Events,\n    Utils: { Array: A },\n} = Ludex\nconst { player, event, language, monitorError } = codex\n\ntype Locale = Ludex.Plugins.Language.Locale\ntype Locales = Ludex.Plugins.Language.Locales\n\nclass Languages {\n    public async init() {\n        try {\n            await this.initDefaultLanguage$()\n            this.listenEvent$()\n            await this.initPlayerLanguage$()\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n        }\n    }\n\n    private initDefaultLanguage$ = async () => {\n        language.add('en', DefaultLanguageData, true)\n        this.setLanguage$('en')\n    }\n\n    private initPlayerLanguage$ = async () => {\n        const playerLocale = language.getPlayerLanguage()\n\n        if (!playerLocale || !this.isSupportedLocale$(playerLocale)) {\n            console.warn(`Language ${playerLocale} not supported. Overriding with default language`)\n            this.setLanguage$('en', true)\n            return\n        }\n\n        await this.addLanguage$(playerLocale)\n\n        const saveToPlayerData = player.getPlayerDataByKey('isFirstLogin') ?? false\n        this.setLanguage$(playerLocale, saveToPlayerData)\n    }\n\n    private isSupportedLocale$ = (lang: string): lang is Locale => {\n        return A.has(AvailableLocales, lang)\n    }\n\n    private listenEvent$ = () => {\n        event.on(Events.REQUEST_LANGUAGE, this.handleLanguageRequested$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(Events.REQUEST_LANGUAGE, this.handleLanguageRequested$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(GameEvents.PRELOAD_LANGUAGE, this.handlePreloadLanguage$)\n\n        // @ts-expect-error - This event has custom payload\n        game.on(GameEvents.CHOOSE_LANGUAGE, this.handleChooseLanguage$)\n    }\n\n    private addLanguage$ = async (lang: Locale, setAsFallback = false) => {\n        const langData = await this.getLangData$(lang)\n        language.add(lang, langData, setAsFallback)\n    }\n\n    private setLanguage$ = (lang: Locale, saveToPlayerData = false) => {\n        language.choose(lang)\n\n        if (saveToPlayerData) {\n            player.setSetting('language', lang)\n        }\n    }\n\n    private readonly handlePreloadLanguage$ = async ({ locale, onLoad, onError }: PreloadLanguagePayload) => {\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Preload language ${locale} not found`)\n            onError?.(new Error(`Language ${locale} not found`))\n            return\n        }\n\n        try {\n            await this.addLanguage$(locale)\n            onLoad?.(locale)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n            onError?.(error)\n        }\n    }\n\n    private readonly handleChooseLanguage$ = ({ locale, saveToPlayerData = false }: ChooseLanguagePayload) => {\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Choose language ${locale} not found`)\n            return\n        }\n\n        try {\n            this.setLanguage$(locale, saveToPlayerData)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n        }\n    }\n\n    private getLangData$ = async <L extends Locale>(lang: L): Promise<Locales[L]> => {\n        if (lang === 'en') {\n            return DefaultLanguageData as Locales[L]\n        }\n\n        const data = await ResourceUtils.loadJsonAsync(LocaleFilePaths[lang as LocalesWithoutDefault])\n\n        if (data === null) {\n            throw new Error(`Language ${lang} not found`)\n        }\n\n        if (data.json === null) {\n            throw new Error(`Language ${lang} is empty`)\n        }\n\n        return data.json as Locales[L]\n    }\n\n    private readonly handleLanguageRequested$ = async (payload: RequestLanguagePayload) => {\n        const { locale, saveToPlayerData = false, onLoad, onError } = payload\n\n        if (!this.isSupportedLocale$(locale)) {\n            console.warn(`Request language ${locale} not found`)\n            onError?.(new Error(`Language ${locale} not found`))\n            return\n        }\n\n        try {\n            await this.addLanguage$(locale)\n            onLoad?.(locale)\n            this.setLanguage$(locale, saveToPlayerData)\n        } catch (error) {\n            const err = this.toError$(error, 'handleLanguageRequested')\n            console.error(err)\n            monitorError?.sendException(err)\n            onError?.(err)\n        }\n    }\n\n    private toError$ = (error: unknown, module: string) => {\n        if (error instanceof Error) {\n            return error\n        }\n\n        if (typeof error === 'string') {\n            return new Error(`LanguagePlugin: ${error}`)\n        }\n\n        return new Error(`LanguagePlugin: Unknown error in module: <${module}>`)\n    }\n}\n\nexport default Languages\n","import TournamentUtils from '../../utils/TournamentUtils'\n\nconst {\n    Configs: {\n        Mockup: {\n            Leaderboards: LeaderboardsMockupConfig,\n            GameSDK: { Player: PlayerMockupConfig },\n        },\n        Leaderboards: LeaderboardsConfig,\n    },\n    Utils: { Number: N },\n} = Ludex\n\nconst { leaderboard } = codex\n\n// * use CoreLeaderboard instead?\n\nclass Leaderboards {\n    public init() {\n        this.handleWhenGameSDKStarted$()\n    }\n\n    private handleWhenGameSDKStarted$ = () => {\n        if (!LeaderboardsMockupConfig.Enabled) {\n            this.setupLeaderboards$()\n        } else {\n            this.setupLeaderboardsMockup$()\n        }\n    }\n\n    private setupLeaderboards$ = async () => {\n        this.setupLeaderboardByConfigs$()\n    }\n\n    private setupLeaderboardByConfigs$ = () => {\n        const { LeaderboardList } = LeaderboardsConfig\n\n        for (const LeaderboardConfig of LeaderboardList) {\n            const { Id, Name } = LeaderboardConfig\n\n            leaderboard.addLeaderboard({\n                name: Name,\n                type: 'global',\n                autoSortRank: true,\n                leaderboardId: Id,\n            })\n        }\n    }\n\n    // ! Mock specific\n    private setupLeaderboardsMockup$ = async () => {\n        this.setupMockGlobalLeaderboards$()\n        this.setupMockFriendsLeaderboard$()\n        this.setupMockGlobalTournamentLeaderboard$()\n    }\n\n    private setupMockGlobalLeaderboards$ = async () => {\n        const { NumOfLeaders } = LeaderboardsMockupConfig\n        const { LeaderboardList } = LeaderboardsConfig\n\n        for (const LeaderboardConfig of LeaderboardList) {\n            const { Name: name, Id: _id } = LeaderboardConfig\n            if (!name) continue\n\n            const leaderboardId = await leaderboard.createLeaderboardAsync({\n                _id,\n                name,\n                numberOfLeaders: N.random(NumOfLeaders.Max - NumOfLeaders.Min) + NumOfLeaders.Min,\n            })\n\n            leaderboard.addLeaderboard({\n                name,\n                type: 'global',\n                autoSortRank: true,\n                leaderboardId,\n            })\n        }\n    }\n\n    private setupMockFriendsLeaderboard$ = async () => {\n        const name = 'Mock Friends Leaderboard'\n        const mockId = 'friends-leaderboard-id'\n\n        let numberOfLeaders = 0\n\n        // ? If mock connected players is enabled, we will use it to set number of leaders\n        const { ConnectedPlayers } = PlayerMockupConfig\n        if (ConnectedPlayers.Enabled) {\n            numberOfLeaders = N.random(ConnectedPlayers.NumOfPlayers - 1) + 1\n        }\n\n        // * Create a mock leaderboard data\n        const leaderboardId = await leaderboard.createLeaderboardAsync({\n            _id: mockId,\n            name,\n            numberOfLeaders,\n        })\n\n        leaderboard.addLeaderboard({\n            name,\n            type: 'friends',\n            autoSortRank: true,\n            leaderboardId,\n        })\n    }\n\n    private setupMockGlobalTournamentLeaderboard$ = async () => {\n        const tournaments = await TournamentUtils.requestTournamentDataAsync()\n\n        tournaments.forEach((tournament) => {\n            const { payload } = tournament\n            const { leaderboardId } = payload\n\n            if (!leaderboardId) return\n            if (leaderboard.isExistLeaderboardId(leaderboardId)) return\n\n            leaderboard.addLeaderboard({\n                type: 'tournament',\n                name: leaderboardId,\n                autoSortRank: true,\n                leaderboardId,\n            })\n        })\n    }\n}\n\nexport default Leaderboards\n","import { game as CCGame, Director, director } from 'cc'\n\nconst {\n    Utils: { Mark },\n    Events,\n    Configs: {\n        PerformanceMonitor: { FpsTracking },\n    },\n} = Ludex\n\nconst { event } = codex\n\nconst FPS_TRACE_DURATION = 60\nconst FPS_TRACE_INTERVAL = 10\n\nclass PerformanceMonitor {\n    private markName$ = 'FPS Tracking'\n\n    private minFps$!: number\n    private maxFps$!: number\n\n    private fpsTraceDuration$!: number\n\n    private fpsTraceInterval$!: number\n    private fpsTraceIntervalTimer$!: number\n\n    private traceStopped$!: boolean\n\n    public get mark(): typeof Mark | null {\n        if (!FpsTracking.Enabled) return null\n        return Mark\n    }\n\n    public init() {\n        const { TrackingDuration, TrackingInterval } = FpsTracking\n\n        if (!this.mark) return\n\n        this.fpsTraceDuration$ = TrackingDuration ?? FPS_TRACE_DURATION\n        this.fpsTraceInterval$ = TrackingInterval ?? FPS_TRACE_INTERVAL\n\n        this.fpsTraceIntervalTimer$ = this.fpsTraceInterval$\n\n        this.traceStopped$ = false\n\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        event.catchUp(Events.GAME_READY, this.handleStartTraceFps$)\n    }\n\n    private unListenEvents$ = () => {\n        director.off(Director.EVENT_AFTER_UPDATE, this.handleLateUpdate$)\n    }\n\n    private handleStartTraceFps$ = () => {\n        this.startTraceFps$()\n        director.on(Director.EVENT_AFTER_UPDATE, this.handleLateUpdate$)\n    }\n\n    private startTraceFps$ = (): void => {\n        if (!this.mark) return\n\n        this.mark.measure(this.markName$)\n\n        this.mark.start(this.markName$)\n\n        // console.info('Start trace FPS')\n    }\n\n    private handleLateUpdate$ = (): void => {\n        if (!this.mark) return\n\n        this.fpsTraceDuration$ -= CCGame.deltaTime\n\n        if (this.fpsTraceDuration$ <= 0 && !this.traceStopped$) {\n            this.traceStopped$ = true\n\n            this.unListenEvents$()\n\n            this.updateFPS$()\n\n            this.mark.stop(this.markName$)\n            return\n        }\n\n        this.fpsTraceIntervalTimer$ -= CCGame.deltaTime\n        if (this.fpsTraceIntervalTimer$ > 0) return\n\n        this.fpsTraceIntervalTimer$ = this.fpsTraceInterval$\n\n        this.updateFPS$()\n        this.mark.stop(this.markName$)\n\n        this.startTraceFps$()\n    }\n\n    private updateFPS$ = (): void => {\n        if (!this.mark) return\n\n        const fps = this.getFPS$()\n        const drawCalls = this.getDrawCalls$()\n        const deviceRender = this.getDeviceRender$()\n        const textureMemory = this.getTextureMemory$()\n\n        this.minFps$ = Math.min(this.minFps$ ?? fps, fps)\n        this.maxFps$ = Math.max(this.maxFps$ ?? 0, fps)\n\n        this.mark.putMetric(this.markName$, 'FPS Metric', fps)\n\n        this.mark.putAttr(this.markName$, 'Page Title', document.title)\n        this.mark.putAttr(this.markName$, 'Device Render', deviceRender)\n\n        this.mark.putAttr(this.markName$, 'Draw Calls', drawCalls.toString())\n        this.mark.putAttr(this.markName$, 'Texture Memory', textureMemory.toFixed(2))\n\n        this.mark.putAttr(this.markName$, 'Min FPS', this.minFps$.toString())\n        this.mark.putAttr(this.markName$, 'Max FPS', this.maxFps$.toString())\n\n        console.debug(\n            `FPS: ${fps} Min: ${this.minFps$} Max: ${\n                this.maxFps$\n            }, draw calls: ${drawCalls}, texture memory: ${textureMemory.toFixed(2)}MB`,\n        )\n    }\n\n    private getFPS$ = (): number => {\n        if (!director.root) return 0\n\n        const { fps } = director.root\n        return Math.floor(fps) || 0\n    }\n\n    private getDrawCalls$ = (): number => {\n        if (!director.root) return 0\n\n        const { numDrawCalls } = director.root.device\n        return numDrawCalls || 0\n    }\n\n    private getDeviceRender$ = (): string => {\n        if (!director.root) return 'Unknown'\n\n        const { renderer } = director.root.device\n        return renderer || 'Unknown'\n    }\n\n    private getTextureMemory$ = (): number => {\n        if (!director.root) return 0\n\n        const { memoryStatus } = director.root.device\n        return memoryStatus.textureSize / (1024 * 1024) || 0\n    }\n}\n\nexport default PerformanceMonitor\n","import { game } from 'cc'\nimport GameEvents from '../../constants/GameEvents'\n\ntype Data = Ludex.Plugins.RemoteConfig.Data\n\nconst { Events } = Ludex\nconst { event } = codex\n\nclass RemoteConfig {\n    public init() {\n        this.listenEvents$()\n    }\n\n    private listenEvents$ = () => {\n        event.on(Events.REQUEST_HOT_RELOAD, this.handleHotReload$)\n        event.on(Events.REQUEST_UPDATE_CONFIG, this.handleUpdateConfig$)\n    }\n\n    private handleHotReload$ = () => {\n        game.restart()\n    }\n\n    private handleUpdateConfig$ = (data: Data) => {\n        if (data.type !== 'Gameplay') return\n\n        // ? Broadcast to all node that config is need to update\n        game.emit(GameEvents.GAMEPLAY_UPDATE_CONFIG, data.config)\n\n        const { id, type } = data\n\n        // ? Tell RemoteConfig plugin that config is updated\n        event.emit(Events.REMOTE_CONFIG_UPDATED, { id, type })\n    }\n}\n\nexport default RemoteConfig\n","import { DynamicAtlasManager } from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW } from 'cc/env'\nimport AdaptivePerformancePlugin from './plugins/AdaptivePerformance'\nimport CanvasRecorderPlugin from './plugins/CanvasRecorder'\nimport DailyRewardsPlugin from './plugins/DailyRewards'\nimport DynamicAssetsPlugin from './plugins/DynamicAssets'\nimport DynamicAtlasPlugin from './plugins/DynamicAtlas'\nimport FrameCapturePlugin from './plugins/FrameCapture'\nimport HybridFileCachePlugin from './plugins/HybridFileCache'\nimport LanguagesPlugin from './plugins/Languages'\nimport LeaderboardsPlugin from './plugins/Leaderboards'\nimport PerformanceMonitorPlugin from './plugins/PerformanceMonitor'\nimport RemoteConfigPlugin from './plugins/RemoteConfig'\n\nconst {\n    Configs: {\n        Languages,\n        Leaderboards,\n        RemoteConfig,\n        FrameCapture,\n        DailyRewards,\n        AdaptivePerformance,\n        Debugger: { CanvasRecorder, Profiler },\n        GameEngine: { HybridFileCache, DynamicAssets, DynamicAtlas },\n    },\n} = Ludex\n\nclass PluginsManager {\n    public init() {\n        // ? Special case, need to override engine pipelines\n        this.initHybridFileCache$()\n\n        console.debug('Plugins Manager: Initialized')\n    }\n\n    public initLanguages(): void {\n        if (!Languages.Enabled) return\n\n        const languages = new LanguagesPlugin()\n        languages.init()\n    }\n\n    public initLeaderboards(): void {\n        if (!Leaderboards.Enabled) return\n\n        const leaderboards = new LeaderboardsPlugin()\n        leaderboards.init()\n    }\n\n    public initRemoteConfig(): void {\n        if (!RemoteConfig.Enabled) return\n\n        const remoteConfig = new RemoteConfigPlugin()\n        remoteConfig.init()\n    }\n\n    public initDynamicAtlas(): void {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!DynamicAtlas.OptimizeAtlas.Enabled) return\n\n        const { instance } = DynamicAtlasManager\n        if (!instance.enabled) return\n\n        const dynamicAtlas = new DynamicAtlasPlugin()\n        dynamicAtlas.init()\n    }\n\n    public initDynamicAssets(): void {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!DynamicAssets.Enabled) return\n\n        const dynamicAssets = new DynamicAssetsPlugin()\n        dynamicAssets.init()\n    }\n\n    private initHybridFileCache$ = (): void => {\n        if (EDITOR_NOT_IN_PREVIEW) return\n        if (!HybridFileCache.Enabled) return\n\n        const hybridFileCache = new HybridFileCachePlugin()\n        hybridFileCache.init()\n    }\n\n    public initCanvasRecorder(): void {\n        if (!CanvasRecorder.Enabled) return\n\n        const canvasRecorder = new CanvasRecorderPlugin()\n        canvasRecorder.init()\n    }\n\n    public initPerformanceMonitor(): void {\n        if (!Profiler.Enabled) return\n\n        const performanceMonitor = new PerformanceMonitorPlugin()\n        performanceMonitor.init()\n    }\n\n    public initAdaptivePerformance(): void {\n        if (!AdaptivePerformance.Enabled) return\n\n        const adaptivePerformance = new AdaptivePerformancePlugin()\n        adaptivePerformance.init()\n    }\n\n    public initFrameCapture(): void {\n        if (!FrameCapture.Enabled) return\n\n        const frameCapture = new FrameCapturePlugin()\n        frameCapture.init()\n    }\n\n    public initDailyRewards(): void {\n        if (!DailyRewards.Enabled) return\n\n        const dailyRewards = new DailyRewardsPlugin()\n        dailyRewards.init()\n    }\n}\n\nexport default PluginsManager\n","import { type AssetManager, assetManager, Director, director, type Scene, type SceneAsset } from 'cc'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport SceneUtils from '../utils/SceneUtils'\nimport ScreenUtils from '../utils/ScreenUtils'\n\nconst { event, monitorError } = codex\nconst {\n    Events,\n    Configs: { PerformanceMonitor },\n    Utils: { Mark, Function: F },\n} = Ludex\n\ntype SceneEventPayload = {\n    sceneName: string\n    sceneData?: SceneData\n}\n\ntype SwitchSceneCallback = (payload: { sceneName: string; sceneData: SceneData | undefined }) => void\n\nconst sdk = GameSDK\n\nclass SceneManager {\n    private markName$: string = 'Load Scene'\n    private testScene$: Record<string, boolean> = {}\n    private isClearedMark$: boolean = false\n    private callbackSwitchScene$: SwitchSceneCallback | null = null\n\n    // ? Use mutex because Cocos doesn't like it when\n    // ? we call `loadScene` in parallel\n    private mutex$ = F.mutex()\n\n    public init() {\n        this.listenEvents$()\n\n        console.debug('Scene Manager: Initialized')\n    }\n\n    private listenEvents$ = (): void => {\n        event.catchUp(Events.MARK_IS_TEST_SCENE, this.setTestScene$)\n\n        event.on(Events.SWITCH_SCENE, this.switchScene$)\n        event.on(Events.PRELOAD_SCENE, this.preloadScene$)\n    }\n\n    private correctSceneName$ = (sceneName: string): string | null => {\n        // ? Some scene (name) not exits in build settings or not exist in project\n        // * This will stop scene switch and prevent error\n\n        const scene = director.getScene()\n\n        const testScene = this.getTestScene$()\n\n        // console.warn('Current scene', scene?.name, { scene, testScene })\n\n        if (testScene) {\n            if (testScene === scene?.name) return null\n            return testScene\n        }\n\n        // ? If current scene is null, we can't check scene name\n        // * Alway has scene in game running, so this will never happen\n        if (!scene?.isValid) return sceneName\n\n        if (sceneName === scene.name) return null\n\n        return sceneName\n    }\n\n    private switchScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName, sceneData } = payload\n\n        const name = this.correctSceneName$(sceneName)\n        console.debug('Switching', name, sceneData ?? {})\n\n        if (!name) return\n\n        if (!SceneUtils.isSceneLoaded(name)) {\n            ScreenUtils.showLoadingFullScreen(name)\n        }\n\n        this.startScene$({ ...payload, sceneName: name })\n    }\n\n    private startScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName, sceneData } = payload\n        const lock = await this.mutex$.use(sceneName)\n\n        try {\n            this.startMeasure$('start', payload)\n\n            const sceneAsset = await this.loadSceneAsync$(sceneName, this.onSceneProgress$)\n            const scene = await this.runSceneAsync$(sceneAsset)\n            this.setSceneData$(scene, sceneData ?? {})\n\n            SceneUtils.markIsSceneLoaded(sceneName)\n            event.emit(Events.SCENE_LOADED, { sceneName })\n\n            this.clearTestMark$()\n\n            this.stopMeasure$()\n            this.handleSceneLaunched$(sceneName, sceneData)\n        } catch (e) {\n            const error = F.toError(e)\n            console.warn('SceneManager.startScene', error)\n\n            this.stopMeasure$(false)\n        } finally {\n            lock.release()\n        }\n    }\n\n    private preloadScene$ = async (payload: SceneEventPayload): Promise<void> => {\n        const { sceneName } = payload\n\n        const lock = await this.mutex$.use(sceneName)\n\n        try {\n            this.startMeasure$('preload', payload)\n\n            await this.loadSceneAsync$(sceneName, this.onSceneProgress$)\n\n            SceneUtils.markIsSceneLoaded(sceneName)\n            event.emit(Events.SCENE_LOADED, { sceneName, isPreload: true })\n\n            this.stopMeasure$()\n            lock.release()\n        } catch (e) {\n            const error = F.toError(e)\n            console.warn('SceneManager.preloadScene', error)\n\n            this.stopMeasure$(false)\n            lock.release()\n        }\n    }\n\n    private loadSceneAsync$ = (\n        sceneName: string,\n        onProgress: ((finished: number, total: number, item: AssetManager.RequestItem) => void) | null = null,\n    ): Promise<SceneAsset> => {\n        return new Promise<SceneAsset>((resolve, reject) => {\n            const bundle = assetManager.main\n            if (!bundle) {\n                reject(new Error('Main bundle not found'))\n                return\n            }\n\n            bundle.loadScene(sceneName, onProgress ?? null, (error, sceneAsset) => {\n                if (error) {\n                    reject(error)\n                    return\n                }\n\n                resolve(sceneAsset)\n            })\n        })\n    }\n\n    private runSceneAsync$ = (sceneAsset: SceneAsset): Promise<Scene> => {\n        return new Promise<Scene>((resolve, reject) => {\n            director.runScene(sceneAsset, undefined, (error, scene) => {\n                if (error) return reject(error)\n                if (!scene) throw new Error('Scene not found')\n                resolve(scene)\n            })\n        })\n    }\n\n    public get mark(): typeof Mark | null {\n        if (!PerformanceMonitor.LoadResources) return null\n        return Mark\n    }\n\n    private startMeasure$ = (action: 'start' | 'preload', payload: SceneEventPayload): void => {\n        if (!this.mark) return\n\n        const { sceneName } = payload\n\n        console.groupCollapsed(` ${sceneName}: ${action} progress`)\n\n        this.mark.measure(this.markName$)\n\n        this.mark.putAttr(this.markName$, 'Cancel', 'false')\n        this.mark.putAttr(this.markName$, 'Success', 'false')\n        this.mark.putMetric(this.markName$, sceneName)\n\n        this.mark.start(this.markName$)\n    }\n\n    private stopMeasure$ = (success: boolean = true): void => {\n        if (!this.mark) return\n\n        this.mark.rmAttr(this.markName$, 'File')\n        this.mark.putAttr(this.markName$, 'Success', success ? 'true' : 'false')\n\n        this.mark.stop(this.markName$)\n\n        console.groupEnd()\n    }\n\n    private onSceneProgress$ = (finished: number, total: number, item: AssetManager.RequestItem): void => {\n        /* event.emit(Events.SCENE_PROGRESS, {\n                item,\n                total,\n                finished,\n                sceneName,\n            }) */\n\n        // Ludex will start at 30%, next 70% will be your game\n        const progress = finished / total\n\n        if (this.mark) {\n            // ? Mark attr to this file for log last file load fail (if have)\n            this.mark.putAttr(this.markName$, 'Last File', `${item.id} (${item.ext})`)\n            // console.info(sceneName, `${(progress * 100).toFixed(2)}%`)\n        }\n\n        const percent = Math.floor(progress * 70 + 30)\n\n        sdk.setLoadingProgress(percent)\n    }\n\n    private clearTestMark$ = (): void => {\n        // ? Clear mark is test scene event when any scene loaded\n        if (!this.isClearedMark$) {\n            event.clear(Events.MARK_IS_TEST_SCENE)\n            this.isClearedMark$ = true\n        }\n    }\n\n    private handleSceneLaunched$ = (sceneName: string, sceneData?: SceneData): void => {\n        // ? Don't await closing loading screen\n        ScreenUtils.hideLoadingFullScreen(sceneName)\n\n        AnalyticsUtils.switchSceneTracking()\n\n        monitorError?.addMetadata({ currentScene: sceneName })\n\n        this.callbackSwitchScene$?.({ sceneName, sceneData })\n\n        event.emit(Events.SCENE_LAUNCHED, { sceneName })\n\n        director.once(Director.EVENT_AFTER_RENDER, () => {\n            event.emit(Events.SCENE_RENDERED, { sceneName })\n        })\n    }\n\n    private getTestScene$ = (): string | null => {\n        return Object.keys(this.testScene$)[0] ?? null\n    }\n\n    private setTestScene$ = (payload: SceneEventPayload): void => {\n        const { sceneName } = payload\n        console.warn('SceneManager.setTestScene', sceneName)\n        this.testScene$[sceneName] = true\n    }\n\n    public onSwitchScene = (callback: SwitchSceneCallback): void => {\n        this.callbackSwitchScene$ = callback\n    }\n\n    private setSceneData$ = (scene: Scene, sceneData: SceneData): void => {\n        if (!sceneData) return\n\n        // Create data if not exist\n        if (!('data' in scene)) {\n            scene.scene.attr({ data: {} })\n        }\n\n        if (!('data' in scene)) return\n\n        // Merge current data\n        const currentData = scene.data || {}\n        scene.scene.attr({ data: { ...currentData, ...sceneData } })\n\n        console.debug('SceneManager.setSceneData', { sceneName: scene.name, sceneData, currentData })\n    }\n}\n\nexport default SceneManager\n","import { director, instantiate, type Node, Prefab, type Scene } from 'cc'\nimport { ScreenNames } from '../constants/ScreenKeys'\nimport type { BaseScreen } from '../screens/BaseScreen'\nimport type { Screens } from '../screens/components/Screens'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport GeneralUtils from '../utils/GeneralUtils'\nimport ResourceUtils from '../utils/ResourceUtils'\n\nconst {\n    Events,\n    Utils: { Object: O, Valid: V, Time: T },\n} = Ludex\nconst { event, monitorError } = codex\n\ntype BaseScreenState = {\n    order: number\n    name: string\n}\n\ntype QueuedScreenState = BaseScreenState & {\n    state: 'queued'\n}\n\ntype LoadingScreenState = BaseScreenState & {\n    state: 'loading'\n}\n\ntype PrefabScreenState = BaseScreenState & {\n    state: 'prefab'\n    prefab: Prefab | Node\n    useCount: number\n}\n\ntype ReadyScreenState = BaseScreenState & {\n    state: 'ready'\n    prefab: Prefab | Node\n    useCount: number\n    screen: BaseScreen\n}\n\n/**\n * ? Type union is used as a simple state management pattern\n * ? where some properties are only accessible in certain states\n * ? to avoid the complexity of OOP state machine patterns (state transitions and value checks)\n */\ntype ScreenEntry = QueuedScreenState | LoadingScreenState | PrefabScreenState | ReadyScreenState\n\nfunction resetScreenEntry(entry: ScreenEntry): ScreenEntry {\n    if (entry.state === 'ready') {\n        entry.screen.node.removeFromParent()\n        entry.screen.node.destroy()\n        return {\n            state: 'prefab',\n            order: entry.order,\n            name: entry.name,\n            prefab: entry.prefab,\n            useCount: entry.useCount,\n        }\n    }\n\n    if (entry.state === 'prefab') {\n        return { ...entry }\n    }\n\n    return {\n        state: 'queued',\n        order: entry.order,\n        name: entry.name,\n    }\n}\n\nclass ScreenManager {\n    private screens$: Record<string, ScreenEntry> = {}\n    private onPrefabReadyCallbacks$: Record<string, Array<() => void>> = {}\n\n    public init(): void {\n        this.bindEventHandlers$()\n        console.debug('Screen Manager: Initialized')\n    }\n\n    private bindEventHandlers$ = (): void => {\n        event.on(Events.OPEN_SCREEN, this.handleOpenScreen$)\n        event.on(Events.CLOSE_SCREEN, this.handleCloseScreen$)\n        event.on(Events.PRELOAD_SCREEN, this.handlePreloadScreen$)\n        event.on(Events.PRELOAD_SCREENS, this.handlePreloadScreens$)\n        event.on(Events.SWITCH_SCENE, this.handleSwitchScene$)\n    }\n\n    private readonly handleOpenScreen$ = (payload: SwitchScreenPayload): void => {\n        this.openScreen(payload.screenName, payload.screenData)\n    }\n\n    private readonly handleCloseScreen$ = (payload: SwitchScreenPayload): void => {\n        this.closeScreen(payload.screenName, true)\n    }\n\n    private readonly handlePreloadScreen$ = (payload: PreloadScreenPayload): void => {\n        const { screenName } = payload\n        this.addScreenQueues$([screenName])\n        const entry = this.screens$[screenName]\n        if (entry?.state !== 'queued') return\n\n        this.loadScreen$(entry)\n    }\n\n    private readonly handlePreloadScreens$ = (): void => {\n        const scene = director.getScene()\n        if (!this.validateScene$(scene)) return\n\n        this.initScreens$(scene)\n        this.preloadScreens$()\n    }\n\n    private readonly handleSwitchScene$ = (): void => {\n        this.resetAllScreenParents$()\n        this.onPrefabReadyCallbacks$ = {}\n    }\n\n    private resetAllScreenParents$ = (): void => {\n        for (const name in this.screens$) {\n            const entry = this.screens$[name]\n            if (entry !== undefined) {\n                this.screens$[name] = resetScreenEntry(entry)\n            }\n        }\n    }\n\n    private validateScene$ = (scene: Scene | null): scene is Scene => {\n        if (!scene) {\n            console.warn('No scene found for preloading screens')\n            return false\n        }\n        return true\n    }\n\n    private initScreens$ = (scene: Scene): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.enabled) return\n\n        // Initialize screens from configuration\n        const configs = screenHolder.screens\n        for (const config of configs) {\n            const screenName = ScreenNames[config.key]\n            if (!screenName) continue\n\n            const entry = this.screens$[screenName]\n            if (entry) {\n                this.screens$[screenName] = { ...entry, order: config.depth }\n                continue\n            }\n\n            this.screens$[screenName] = {\n                state: 'queued',\n                order: config.depth,\n                name: screenName,\n            }\n        }\n\n        // ? Get all screens nodes from scene\n        // ! Don't use BaseScreen class to avoid circular dependency (systems <-> main)\n        const screens = scene.getComponentsInChildren<BaseScreen>('BaseScreen')\n\n        if (!V.isEmpty(screens)) {\n            const screenNames = screens.map((s) => s?.node.name).join(', ')\n            console.info(` Active Screens in ${scene.name}: ${screenNames}`)\n            this.addScreens$(screens)\n        }\n    }\n\n    private getScreenHolder$ = (): Screens | null => {\n        const scene = director.getScene()\n        return scene?.getComponentInChildren<Screens>('Screens') ?? null\n    }\n\n    private addScreens$ = (screens: BaseScreen[]): void => {\n        for (let index = 0; index < screens.length; index++) {\n            const screen = screens[index]\n            if (!screen) {\n                console.warn(`ScreenManager.addScreens: Invalid screen ${index}`)\n                continue\n            }\n\n            const screenName = screen.node.name\n            if (!this.isScreenNameValid$(screenName)) {\n                console.warn(`ScreenManager.addScreens: Invalid screen name ${screenName}`)\n                continue\n            }\n\n            const entry = this.screens$[screenName]\n            // If entry exists (from config), use its order (depth). Otherwise default to 0.\n            const order = entry?.order ?? 0\n\n            this.screens$[screenName] = {\n                state: 'ready',\n                order: order,\n                screen: screen,\n                prefab: screen.node,\n                name: screenName,\n                useCount: 0,\n            }\n        }\n\n        // Reorder immediately to ensure correct depth for existing screens\n        this.reorderScreens$()\n    }\n\n    private isScreenNameValid$ = (screenName: unknown): screenName is string => {\n        return V.isString(screenName) && O.vals(ScreenNames).includes(screenName)\n    }\n\n    private addScreenQueues$ = (screenNames: string[]): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) {\n            console.warn('ScreenManager.addScreenQueues: No valid screen holder found')\n            return\n        }\n\n        for (const screenName of screenNames) {\n            if (!this.isScreenNameValid$(screenName)) {\n                console.warn(`ScreenManager.addScreenQueues: Invalid screen name ${screenName}`)\n                continue\n            }\n\n            const entry = this.screens$[screenName]\n            if (entry !== undefined) {\n                continue\n            }\n\n            // If not in config, default depth to 0\n            this.screens$[screenName] = {\n                state: 'queued',\n                order: 0,\n                name: screenName,\n            }\n        }\n    }\n\n    private loadScreen$ = async (entry: QueuedScreenState): Promise<void> => {\n        try {\n            this.screens$[entry.name] = { ...entry, state: 'loading' }\n            const prefab = await ResourceUtils.loadPrefabAsync(`screens/${entry.name}`)\n\n            if (prefab === null) {\n                throw new Error(`ScreenManager.loadScreen: Failed to load prefab: ${entry.name}`)\n            }\n\n            this.screens$[entry.name] = { ...entry, state: 'prefab', prefab, useCount: 0 }\n            console.debug(`ScreenManager.loadScreen: ${entry.name} loaded successfully`)\n            this.emitPrefabReady$(entry.name)\n        } catch (error) {\n            console.warn(`ScreenManager.loadScreen: Failed to load ${entry.name}`, error)\n            this.screens$[entry.name] = {\n                state: 'queued',\n                order: entry.order,\n                name: entry.name,\n            }\n        }\n    }\n\n    private preloadScreens$ = (): void => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) return\n        if (!screenHolder?.autoPreload) return\n\n        // Load in order of depth (optional, but good for consistency)\n        const entries = Object.values(this.screens$).sort((a, b) => a.order - b.order)\n\n        for (const entry of entries) {\n            if (entry.state === 'queued') {\n                this.loadScreen$(entry)\n            }\n        }\n    }\n\n    private getScreen$ = async (entry: PrefabScreenState | ReadyScreenState): Promise<BaseScreen | null> => {\n        const screenHolder = this.getScreenHolder$()\n        if (!screenHolder?.isValid) {\n            throw new Error('ScreenManager.getScreen: Invalid screen holder')\n        }\n\n        if (entry.state === 'ready') {\n            return entry.screen\n        }\n\n        if (!(entry.prefab instanceof Prefab)) {\n            throw new Error(`ScreenManager.getScreen: Invalid prefab ${entry.name}`)\n        }\n\n        const screenNode = instantiate(entry.prefab)\n        screenNode.name = entry.name\n\n        const screen = screenNode.getComponent<BaseScreen>('BaseScreen')\n        if (!screen) {\n            throw new Error(`ScreenManager.getScreen: Invalid screen ${entry.name}`)\n        }\n\n        screenHolder.node.addChild(screenNode)\n        screenNode.active = false\n\n        this.screens$[entry.name] = { ...entry, state: 'ready', screen }\n        this.reorderScreens$()\n\n        console.debug(`ScreenManager.getScreen: Retrieved ${entry.name}`, entry)\n\n        return screen\n    }\n\n    private reorderScreens$ = (): void => {\n        const readyEntries: ReadyScreenState[] = []\n\n        for (const name in this.screens$) {\n            const entry = this.screens$[name]\n            if (entry?.state === 'ready' && entry?.screen.isValid) {\n                readyEntries.push(entry)\n            }\n        }\n\n        // Sort by depth (order)\n        readyEntries.sort((a, b) => a.order - b.order)\n\n        // Apply sibling index based on sorted order\n        for (let i = 0; i < readyEntries.length; i++) {\n            const entry = readyEntries[i]\n            if (entry?.screen?.isValid) {\n                entry.screen.node.setSiblingIndex(i)\n            }\n        }\n    }\n\n    public openScreen = async (screenName: string, screenData?: ScreenData): Promise<void> => {\n        if (!this.isScreenNameValid$(screenName)) return\n\n        const entry = this.getOrTryAddScreen$(screenName)\n\n        if (entry === undefined) {\n            console.warn(`ScreenManager.openScreen: Screen ${screenName} not found`)\n            return\n        }\n\n        if (entry.state !== 'ready' && entry.state !== 'prefab') {\n            if (entry.state === 'queued') this.loadScreen$(entry)\n            return await this.queueScreen$(screenName, screenData)\n        }\n\n        try {\n            GeneralUtils.setBlockInput(true)\n\n            const screen = await this.getScreen$(entry)\n\n            if (!screen?.isValid) {\n                throw new Error(`ScreenManager.performScreenOpen: Invalid screen ${screenName}`)\n            }\n\n            this.incrementUseCount$(screenName)\n\n            await this.showScreen$(screen, screenName, screenData)\n        } catch (error) {\n            console.error(`ScreenManager.openScreen: Error opening ${screenName}`, error)\n        } finally {\n            GeneralUtils.setBlockInput(false)\n        }\n    }\n\n    private queueScreen$ = (screenName: string, screenData?: ScreenData): Promise<void> => {\n        console.debug(`ScreenManager.queueScreen: Queuing ${screenName}`)\n        const callbacks = this.onPrefabReadyCallbacks$[screenName] ?? []\n\n        return new Promise<void>((resolve) => {\n            const callback = async () => {\n                await this.openScreen(screenName, screenData)\n                resolve()\n            }\n\n            this.onPrefabReadyCallbacks$[screenName] = [...callbacks, callback]\n        })\n    }\n\n    private incrementUseCount$ = (screenName: string): void => {\n        const entry = this.screens$[screenName]\n        if (entry?.state === 'ready' || entry?.state === 'prefab') {\n            this.screens$[screenName] = { ...entry, useCount: entry.useCount + 1 }\n        }\n    }\n\n    private showScreen$ = async (screen: BaseScreen, screenName: string, screenData?: ScreenData): Promise<void> => {\n        const eventPayload: SwitchScreenPayload = { screenName, screenData }\n        event.emit(Events.OPENING_SCREEN, eventPayload)\n\n        await T.sleepAsync(0)\n        screen.node.active = true\n\n        screen.open(screenData)\n        this.updateAnalytics$(screenName)\n\n        // Reorder again just in case\n        this.reorderScreens$()\n    }\n\n    public closeScreen = async (screenName: string, updateCurrentPage: boolean = false): Promise<void> => {\n        if (!this.isScreenNameValid$(screenName)) return\n\n        const entry = this.screens$[screenName]\n\n        if (entry === undefined) {\n            console.debug(`ScreenManager.closeScreen: Screen ${screenName} not found`)\n            return\n        }\n\n        if (entry.state !== 'ready') {\n            console.debug(`ScreenManager.closeScreen: ${screenName} is not ready`)\n            delete this.onPrefabReadyCallbacks$[screenName]\n            return\n        }\n\n        try {\n            if (!entry.screen.isValid || !entry.screen.node.active) return\n\n            event.emit(Events.CLOSING_SCREEN, { screenName })\n            entry.screen.close()\n\n            if (updateCurrentPage) {\n                this.updateAnalytics$(screenName, false)\n            }\n        } catch (error) {\n            console.error(`ScreenManager.closeScreen: Error closing ${screenName}`, error)\n        }\n    }\n\n    private updateAnalytics$ = (screenName: string, isOpening: boolean = true): void => {\n        AnalyticsUtils.trackCurrentPage(screenName, isOpening)\n        if (isOpening) {\n            monitorError?.addMetadata({ currentScreen: screenName })\n        } else {\n            monitorError?.removeMetadata('currentScreen')\n        }\n    }\n\n    public closeAllScreens = (): void => {\n        const logCurrentPage = false\n        for (const screenName in this.screens$) {\n            this.closeScreen(screenName, logCurrentPage)\n        }\n    }\n\n    private getOrTryAddScreen$ = (screenName: string): ScreenEntry | undefined => {\n        const entry = this.screens$[screenName]\n\n        if (entry === undefined) {\n            console.debug(`ScreenManager.getOrTryAddScreen: Adding new screen (${screenName}) to queue`)\n            this.addScreenQueues$([screenName])\n            const newEntry = this.screens$[screenName]\n            return newEntry\n        }\n\n        return entry\n    }\n\n    private emitPrefabReady$ = (screenName: string): void => {\n        const callbacks = this.onPrefabReadyCallbacks$[screenName] ?? []\n\n        for (const callback of callbacks) {\n            callback()\n        }\n\n        delete this.onPrefabReadyCallbacks$[screenName]\n    }\n}\n\nexport default ScreenManager\n","/**\n * Ludos System is a bridge between Ludex and Cocos\n */\nimport { Director, director, Game, game } from 'cc'\nimport { EDITOR_NOT_IN_PREVIEW, PREVIEW } from 'cc/env'\nimport SceneKeys from '../constants/SceneKeys'\nimport AnalyticsUtils from '../utils/AnalyticsUtils'\nimport LayoutUtils from '../utils/LayoutUtils'\nimport SceneUtils from '../utils/SceneUtils'\nimport ScreenUtils from '../utils/ScreenUtils'\nimport AdsManager from './AdsManager'\nimport EngineManager from './EngineManager'\nimport LayoutManager from './LayoutManager'\nimport MatchManager from './MatchManager'\nimport PlayerManager from './PlayerManager'\nimport PluginsManager from './PluginsManager'\nimport SceneManager from './SceneManager'\nimport ScreenManager from './ScreenManager'\n\nconst {\n    Configs: {\n        Core,\n        Ads,\n        Match,\n        Player,\n        GameEngine: { HybridFileCache },\n    },\n    Events,\n    Plugins: { Analytics: { Events: AnalyticsEvents } = {} },\n    Utils: { Device: D, Time: T },\n} = Ludex\n\nconst { context, event, analytics, monitorError } = codex\n\nclass LudosSystem {\n    private sceneManager$!: SceneManager\n    private screenManager$!: ScreenManager\n    private engineManager$!: EngineManager\n    private layoutManager$!: LayoutManager\n    private pluginsManager$!: PluginsManager\n\n    private adsManager$: AdsManager | null = null\n    private matchManager$: MatchManager | null = null\n    private playerManager$: PlayerManager | null = null\n\n    constructor() {\n        console.groupCollapsed(' Ludos System')\n\n        this.logEngineReady$()\n        this.createManager$()\n        this.initManagers$()\n        this.listenEvents$()\n\n        console.groupEnd()\n\n        window.__sdkLoad.ensure(10)\n    }\n\n    private logEngineReady$ = () => {\n        event.catchUp(Events.ANALYTICS_READY, () => {\n            AnalyticsEvents && analytics.event(AnalyticsEvents.ENGINE_READY)\n        })\n    }\n\n    private createManager$ = () => {\n        this.sceneManager$ = new SceneManager()\n        this.screenManager$ = new ScreenManager()\n        this.engineManager$ = new EngineManager()\n        this.layoutManager$ = new LayoutManager()\n        this.pluginsManager$ = new PluginsManager()\n\n        if (Ads.Enabled) {\n            this.adsManager$ = new AdsManager()\n        }\n\n        if (Match.Enabled) {\n            this.matchManager$ = new MatchManager()\n        }\n\n        if (Player.Enabled) {\n            this.playerManager$ = new PlayerManager()\n        }\n    }\n\n    private initManagers$ = (): void => {\n        this.sceneManager$.init()\n        this.screenManager$.init()\n        this.engineManager$.init()\n        this.layoutManager$.init()\n        this.pluginsManager$.init()\n\n        this.adsManager$?.init()\n        this.matchManager$?.init()\n        this.playerManager$?.init()\n    }\n\n    private listenEvents$ = (): void => {\n        event.catchUp(Events.CORE_BOOTING, this.handleWhenCoreBoot$)\n        event.catchUp(Events.CORE_STARTING, this.handleWhenCoreStart$)\n        event.catchUp(Events.CORE_READY, this.handleWhenCoreReady$)\n\n        LayoutUtils.listenLayoutChanges()\n        this.sceneManager$.onSwitchScene(this.handleSwitchScene$)\n    }\n\n    private handleWhenCoreBoot$ = (): void => {\n        console.warn('Ludos System: Core boot', { inited: game.inited, game })\n        if (game.inited) {\n            this.handleCocosInit$()\n        } else {\n            game.once(Game.EVENT_GAME_INITED, this.handleCocosInit$)\n        }\n    }\n\n    private handleCocosInit$ = (): void => {\n        // ? Only request start core, but maybe game-sdk will auto start core after inited\n        event.emit(Events.REQUEST_CORE_START)\n    }\n\n    private handleWhenCoreStart$ = (): void => {\n        this.playerManager$?.setupDefaultGameData()\n        this.matchManager$?.setupDefaultMatchData()\n    }\n\n    private handleWhenCoreReady$ = (): void => {\n        if (!HybridFileCache.Enabled) {\n            event.emit(Events.BUNDLE_READY)\n        }\n\n        this.initPlugins$()\n        this.playerManager$?.syncPlatformPlayerData()\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.LOAD_START)\n\n        // ? Wait bundle ready, first scene will be loaded\n        event.catchUp(Events.BUNDLE_READY, this.processPreStartGame$)\n    }\n\n    private processPreStartGame$ = (): void => {\n        if (PREVIEW) {\n            // ? In preview mode, BootScene will be auto launched\n            director.once(Director.EVENT_AFTER_SCENE_LAUNCH, () => {\n                this.preloadScenes$()\n                this.processBootSceneLaunched$()\n            })\n            return\n        }\n\n        event.catchUp(Events.SCENE_LOADED, this.preloadScenes$)\n        event.catchUp(Events.SCENE_LAUNCHED, this.processBootSceneLaunched$)\n\n        this.runBootScene$()\n    }\n\n    private processBootSceneLaunched$ = async () => {\n        if (Core.StartSDKAfterLoadGame) {\n            // ? Wait main scene loaded\n            await event.waitTo(Events.SCENE_LOADED)\n        }\n\n        await GameSDK.extra.waitSDKInitiatedAsync()\n\n        console.debug('Game paused', game.isPaused())\n\n        // ? If game is paused, we need wait game resume\n        // * Some game will pause game in BootScene for preload assets\n        if (game.isPaused()) {\n            await this.waitGameResume$()\n        }\n\n        this.processStartGame$()\n    }\n\n    private waitGameResume$ = async (): Promise<void> => {\n        return new Promise((resolve) => {\n            game.once(Game.EVENT_RESUME, resolve)\n        })\n    }\n\n    private runBootScene$ = (): void => {\n        if (GameSDK.isGameSDK('Playable')) {\n            SceneUtils.switchScene(SceneKeys.PLAYABLE_SCENE)\n        } else {\n            SceneUtils.switchScene(SceneKeys.BOOT_SCENE)\n        }\n    }\n\n    private preloadScenes$ = (): void => {\n        if (GameSDK.isGameSDK('Playable')) return\n\n        // ? Facebook App on iOS: sessionContextType may be null in tournament context, if run before GameSDK started\n        const contextSessionType = context.getSessionContextType()\n\n        if (contextSessionType === 'solo') {\n            SceneUtils.preloadDashboardScene()\n        } else {\n            SceneUtils.preloadGameScene()\n        }\n    }\n\n    private processStartGame$ = async (): Promise<void> => {\n        // ? End group forCorecos\n        console.groupEnd()\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.LOAD_COMPLETE)\n\n        event.catchUp(Events.PLAYER_INFO_LOADED, this.startProcessContextData$)\n\n        // * Make transition from sdk to game smoother\n        await event.waitTo(Events.SCENE_RENDERED, 1000).catch(() => {\n            // ? Safe to continue\n        })\n\n        // ? Wait 100ms to make sure all game objects created\n        await T.sleepAsync(100)\n\n        await this.startGameAsync$()\n    }\n\n    private handleSwitchScene$ = (): void => {\n        ScreenUtils.preloadScreens()\n        console.groupEnd()\n    }\n\n    // ? Why call startGameAsync here?\n    // * We want to make sure that the game is ready to start, not show\n    private startGameAsync$ = async (retries = 0): Promise<void> => {\n        try {\n            await GameSDK.startGameAsync()\n        } catch (error) {\n            console.warn('GameSDK.startGameAsync', error)\n\n            if (retries <= 3) {\n                setTimeout(() => {\n                    this.startGameAsync$(retries + 1)\n                }, 1000)\n            } else {\n                monitorError?.sendException(error instanceof Error ? error : new Error(JSON.stringify(error)))\n            }\n        }\n    }\n\n    private startProcessContextData$ = async (): Promise<void> => {\n        // processContextData method will be auto switch to next scene\n        // * It will also automatically call the flows from the match plugin and context plugin\n        // ? This means that the match flow of the GameScene will need to be skipped when first entering your game\n\n        AnalyticsEvents && analytics.event(AnalyticsEvents.APP_READY)\n\n        try {\n            this.playerManager$?.requestConnectedPlayers()\n\n            await context.processContextData()\n        } catch (error) {\n            console.error('startProcessContextData', error)\n\n            if (error instanceof Error) {\n                monitorError?.sendException(error)\n            }\n        } finally {\n            event.emit(Events.GAME_READY)\n\n            this.trackDeviceInfo$('begin')\n\n            window.addEventListener('beforeunload', () => {\n                this.trackDeviceInfo$('end')\n            })\n        }\n    }\n\n    private initPlugins$ = (): void => {\n        this.pluginsManager$.initLanguages()\n        this.pluginsManager$.initFrameCapture()\n        this.pluginsManager$.initDailyRewards()\n        this.pluginsManager$.initLeaderboards()\n        // this.pluginsManager.initRemoteConfig()\n        this.pluginsManager$.initDynamicAtlas()\n        this.pluginsManager$.initDynamicAssets()\n        this.pluginsManager$.initCanvasRecorder()\n        this.pluginsManager$.initPerformanceMonitor()\n        this.pluginsManager$.initAdaptivePerformance()\n    }\n\n    private getDeviceInfo$ = (type: string) => {\n        try {\n            const isES5 = D.isES5()\n            const heapMemory = D.heapMemory()\n            const pixelRatio = D.pixelRatio()\n            const audioState = D.audioState()\n            const orientation = D.orientation()\n            const gpuRenderer = D.gpuRenderer()\n            const supportWebp = D.isSupportWebp()\n            const sdkPlatform = GameSDK.getPlatform()\n            const webglVersion = D.webglVersion()\n            const maxTextureSize = D.maxTextureSize()\n            const hardwareConcurrency = D.hardwareConcurrency()\n\n            return {\n                log_type: type,\n                is_es5: isES5,\n                pixel_ratio: pixelRatio,\n                sdk_platform: sdkPlatform,\n                screen_orientation: orientation,\n                audio_state: audioState,\n                heap_memory: heapMemory,\n                support_webp: supportWebp,\n                gpu_renderer: gpuRenderer,\n                webgl_version: webglVersion,\n                max_texture_size: maxTextureSize,\n                hardware_concurrency: hardwareConcurrency,\n            }\n        } catch (error) {\n            console.warn('Error getting device info', error)\n            return null\n        }\n    }\n\n    private trackDeviceInfo$ = (type: 'begin' | 'end'): void => {\n        const deviceInfo = this.getDeviceInfo$(type)\n        if (!deviceInfo) return\n\n        AnalyticsUtils.trackDeviceInfo(deviceInfo)\n    }\n}\n\nif (!EDITOR_NOT_IN_PREVIEW) {\n    new LudosSystem()\n}\n","import { _decorator, Component, cclegacy, gfx, type renderer, rendering } from 'cc'\n\nconst { ccclass, executeInEditMode } = _decorator\n\n// --- Constants ---\nconst PIPELINE_NAME = 'Optimized2DPipeline'\nconst LAYOUT_NAME = 'default' // Standard Cocos layout\nconst RENDER_FLAGS =\n    rendering.SceneFlags.UI |\n    rendering.SceneFlags.BLEND |\n    rendering.SceneFlags.OPAQUE |\n    rendering.SceneFlags.DRAW_INSTANCING\n\n/**\n * Optimized2DPipelineBuilder\n *\n * A minimal custom pipeline builder designed specifically for 2D games.\n *\n * Key Optimizations:\n * 1. Single RenderPass: Removes unnecessary Depth/Stencil buffers for pure 2D.\n * 2. Single Queue: Batches UI, Transparent, and Opaque objects together.\n * 3. No Lighting: Skips light culling and shadow map generation.\n * 4. Standalone: Zero dependencies on the deprecated PostProcess module.\n */\nclass Optimized2DPipelineBuilder implements rendering.PipelineBuilder {\n    private readonly clearColor$ = new gfx.Color(0, 0, 0, 1)\n    private readonly viewport$ = new gfx.Viewport()\n    private readonly lightInfo$ = new rendering.LightInfo()\n\n    public setup(cameras: renderer.scene.Camera[], ppl: rendering.BasicPipeline): void {\n        for (let i = 0; i < cameras.length; i++) {\n            const camera = cameras[i]!\n            if (!this.isValidCamera$(camera)) continue\n\n            // 1. Prepare Camera & Window Info\n            const w = camera.window!\n            const width = Math.max(Math.floor(w.width), 1)\n            const height = Math.max(Math.floor(w.height), 1)\n            const windowID = this.getOrGenerateWindowID$(camera)\n            const colorName = `Color${windowID}`\n\n            // 2. Setup RenderWindow (No DepthStencil)\n            ppl.addRenderWindow(colorName, gfx.Format.RGBA8, width, height, w)\n\n            // 3. Update Viewport & Clear Color\n            this.syncViewport$(camera, width, height)\n            this.syncClearColor$(camera)\n\n            // 4. Create Single RenderPass\n            const pass = ppl.addRenderPass(width, height, LAYOUT_NAME)\n            pass.setViewport(this.viewport$)\n\n            // 5. Configure Render Target\n            const loadOp = camera.clearFlag & gfx.ClearFlagBit.COLOR ? gfx.LoadOp.CLEAR : gfx.LoadOp.LOAD\n\n            pass.addRenderTarget(colorName, loadOp, gfx.StoreOp.STORE, this.clearColor$)\n\n            // 6. Add Single Render Queue\n            // Combining all 2D flags into one queue maximizes batching potential\n            pass.addQueue(rendering.QueueHint.BLEND, LAYOUT_NAME).addSceneOfCamera(\n                camera,\n                this.lightInfo$,\n                RENDER_FLAGS,\n            )\n        }\n    }\n\n    // --- Private Helpers ---\n\n    private isValidCamera$ = (camera: renderer.scene.Camera): boolean => {\n        return !!(camera?.scene && camera?.window)\n    }\n\n    private getOrGenerateWindowID$ = (camera: renderer.scene.Camera): number => {\n        const w = camera.window!\n        // Cache ID on the window object to ensure stability across frames\n\n        // @ts-expect-error - allow private property\n        let info = w._pipelineInfo\n        if (!info) {\n            const { user } = cclegacy\n            const currentID = (user.windowID || 0) + 1\n            user.windowID = currentID\n            info = { id: currentID }\n            // @ts-expect-error - allow private property\n            w._pipelineInfo = info\n        }\n\n        return info.id\n    }\n\n    private syncViewport$ = (camera: renderer.scene.Camera, width: number, height: number) => {\n        const vp = camera.viewport\n        this.viewport$.left = vp.x * width\n        this.viewport$.top = vp.y * height\n        this.viewport$.width = vp.z * width\n        this.viewport$.height = vp.w * height\n    }\n\n    private syncClearColor$ = (camera: renderer.scene.Camera) => {\n        const cc = camera.clearColor\n        this.clearColor$.x = cc.x\n        this.clearColor$.y = cc.y\n        this.clearColor$.z = cc.z\n        this.clearColor$.w = cc.w\n    }\n}\n\n// --- Auto Registration ---\n\nif (rendering) {\n    const builder = new Optimized2DPipelineBuilder()\n    rendering.setCustomPipeline(PIPELINE_NAME, builder)\n    console.info(`[${PIPELINE_NAME}] Registered successfully.`)\n}\n\n/**\n * Optimized2DPipelineComponent\n *\n * Attach this component to your Camera to easily identify or configure\n * pipeline-specific settings in the future.\n */\n@ccclass('Optimized2DPipeline')\n@executeInEditMode\nexport class Optimized2DPipelineComponent extends Component {\n    // Future configuration properties can go here\n    // @property\n    // public someSetting: boolean = true;\n\n    start() {\n        // Placeholder for component logic\n    }\n}\n","import { cclegacy, gfx, type renderer } from 'cc'\n\nexport class WindowInfo {\n    constructor(id: number, width: number, height: number, framebuffer: gfx.Framebuffer) {\n        this.id = id\n        this.width = width\n        this.height = height\n        this.framebuffer = framebuffer\n    }\n    id = 0xffffffff\n    width = 0\n    height = 0\n    framebuffer: gfx.Framebuffer\n}\n\ncclegacy.user ||= {\n    windowID: 0,\n    windows: new WeakMap<any, WindowInfo>(),\n}\n\nexport function getWindowInfo(camera: renderer.scene.Camera): WindowInfo {\n    let info = cclegacy.user.windows.get(camera.window)\n    if (info !== undefined) {\n        return info\n    }\n    info = new WindowInfo(cclegacy.user.windowID, 0, 0, camera.window.framebuffer)\n    ++cclegacy.user.windowID\n    cclegacy.user.windows.set(camera.window, info)\n    return info\n}\n\nexport function needClearColor(camera: renderer.scene.Camera): boolean {\n    return (camera.clearFlag & gfx.ClearFlagBit.COLOR) !== 0\n}\n"]}