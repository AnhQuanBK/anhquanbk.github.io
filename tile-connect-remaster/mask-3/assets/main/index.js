System.register("chunks:///main.js",["./TournamentUtils-e88d6822.js","cc"],(function(){var e,t,n,i,a,o,r,l,s,u,c,d,h,p,y,v,f,g,m,b,w,S,k,C,E,A,T,P,L,O,I,R,_,D,N,M,F,B,x,z,U,G,H,q,V,$,W,K,j,Y,X,J,Z,Q,ee,te,ne,ie,ae,oe,re,le,se,ue,ce,de,he,pe,ye,ve,fe,ge,me,be,we,Se,ke,Ce,Ee,Ae,Te,Pe,Le,Oe,Ie,Re,_e,De,Ne,Me,Fe,Be,xe,ze,Ue,Ge,He,qe,Ve,$e,We,Ke,je,Ye,Xe,Je,Ze,Qe,et,tt,nt,it,at,ot,rt,lt,st,ut,ct,dt,ht,pt,yt,vt,ft,gt;return{setters:[function(X){e=X._,t=X.a,n=X.b,i=X.c,a=X.d,o=X.e,r=X.R,l=X.f,s=X.g,u=X.h,c=X.i,d=X.j,h=X.k,p=X.A,y=X.G,v=X.C,f=X.l,g=X.m,m=X.n,b=X.o,w=X.p,S=X.q,k=X.r,C=X.s,E=X.t,A=X.u,T=X.v,P=X.L,L=X.w,O=X.x,I=X.E,R=X.y,_=X.I,D=X.z,N=X.T,M=X.B,F=X.D,B=X.F,x=X.S,z=X.H,U=X.J,G=X.K,H=X.M,q=X.N,V=X.O,$=X.P,W=X.Q,K=X.W,j=X.U,Y=X.V},function(e){X=e.cclegacy,J=e.AudioSource,Z=e._decorator,Q=e.CCString,ee=e.director,te=e.Component,ne=e.UITransform,ie=e.CCInteger,ae=e.CCFloat,oe=e.Widget,re=e.tween,le=e.Layout,se=e.game,ue=e.ccenum,ce=e.isCCObject,de=e.UIOpacity,he=e.Sprite,pe=e.Enum,ye=e.easing,ve=e.EventHandler,fe=e.Button,ge=e.Input,me=e.Node,be=e.Vec3,we=e.animation,Se=e.CCBoolean,ke=e.Label,Ce=e.RichText,Ee=e.Graphics,Ae=e.Color,Te=e.sys,Pe=e.Director,Le=e.EventTarget,Oe=e.ParticleSystem2D,Ie=e.math,Re=e.View,_e=e.ProgressBar,De=e.Vec2,Ne=e.Layers,Me=e.find,Fe=e.pseudoRandomRangeInt,Be=e.randomRangeInt,xe=e.SpriteFrame,ze=e.Animation,Ue=e.AnimationClip,Ge=e.randomRange,He=e.pseudoRandom,qe=e.instantiate,Ve=e.Pool,$e=e.Prefab,We=e.repeat,Ke=e.js,je=e.misc,Ye=e.MeshRenderData,Xe=e.lerp,Je=e.approx,Ze=e.EPSILON,Qe=e.RealCurve,et=e.Gradient,tt=e.bits,nt=e.random,it=e.toRadian,at=e.CCClass,ot=e.UIRenderer,rt=e.pseudoRandomRange,lt=e.assert,st=e.clamp,ut=e.HorizontalTextAlignment,ct=e.Tween,dt=e.ResolutionPolicy,ht=e.view,pt=e.NodeEventType,yt=e.Material,vt=e.Canvas,ft=e.ScrollView,gt=e.Mask}],execute:function(){var mt;X._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var bt=null===(mt=Ludex.Plugins.Audio)||void 0===mt?void 0:mt.BaseAudioPlayer;bt||(bt=e((function e(n){t(this,e),console.warn("BaseAudioPlayer is not defined",n)})));var wt,St,kt,Ct=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,e)).audioSource=n,i}return e(r,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,a=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=a}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===J.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),r}(bt);X._RF.pop(),X._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var Et=Ludex.Utils,At=Et.Array,Tt=Et.Decorator,Pt=null===(wt=Ludex.Plugins.Audio)||void 0===wt?void 0:wt.BaseChannelManager;Pt||(Pt=e((function e(n){t(this,e),console.warn("BaseChannelManager is not defined",n)})));var Lt,Ot,It,Rt,_t,Dt=(St=Tt.tryCatch(),a((kt=function(a){n(u,a);var l,s=i(u);function u(e,n){var i;return t(this,u),(i=s.call(this,n)).allowMultipleTracking={},i.handleLoadedAudio=function(e,t){var n=i.node.addComponent(J);return n.clip=t,n.playOnAwake=!1,new Ct(e,n)},i.node=e,i}return e(u,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof Ct)&&n.getAudioSource().state===J.AudioState.PLAYING}},{key:"onLoadAudio",value:(l=o((function*(e,t){var n=yield r.loadAudioAsync(e);return n&&this.node.isValid?this.handleLoadedAudio(e,n):null})),function(e,t){return l.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,a=t.allowMultiple,o=void 0!==a&&a;if(t.volume=this.getVolume()*i,o){var r=e.getAudioSource().clip;if(!r)return;return void this.requestDuplicateAudioPlayer(e.getKey(),r,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof Ct)return i.getAudioSource().state===J.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var a=i.key,o=n.volume,r=void 0===o?1:o;this.setAudioClip(a,{volume:r})}return i.audioPlayer}var l=this.allowMultipleTracking[e];if(!l)throw new Error("Allow multiple tracking is not found");var s="".concat(e,"_").concat(l.currentPostFix),u=this.handleLoadedAudio(s,t);return l.list.push({audioPlayer:u,key:s}),l.currentPostFix+=1,this.setAudioClip(s,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=At.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==J.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),u}(Pt)).prototype,"onLoadAudio",[St],Object.getOwnPropertyDescriptor(kt.prototype,"onLoadAudio"),kt.prototype),kt);X._RF.pop(),X._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var Nt,Mt,Ft,Bt,xt,zt=Z.ccclass,Ut=Z.property,Gt=codex,Ht=Gt.audio,qt=Gt.player;Lt=zt("Music"),Ot=Ut(Q),Lt((_t=a((Rt=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"channelId",_t,s(e)),e.channel=null,e.isMute=!1,e.volume=1,e}return e(r,[{key:"__preload",value:function(){Ht&&(this.makePersistent(),this.channel=new Dt(this.node,this.channelId),Ht.addChannel(this.channel))}},{key:"makePersistent",value:function(){ee.isPersistRootNode(this.node)||ee.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),Ht.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!qt.getPlayerSetting("music")}},{key:"setVolume",value:function(e){this.volume=e,this.isMute||Ht.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return Ht.getVolume(this.channelId)}},{key:"pause",value:function(e){Ht.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&Ht.resume(e,this.channelId)}},{key:"stop",value:function(e){Ht.stop(e,this.channelId)}},{key:"mute",value:function(e){this.isMute=e,e?Ht.mute(this.channelId):(this.setVolume(this.volume),Ht.unmute(this.channelId))}}]),r}(te)).prototype,"channelId",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),It=Rt));X._RF.pop(),X._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var Vt,$t,Wt,Kt,jt,Yt,Xt,Jt,Zt,Qt,en,tn,nn,an,on,rn,ln,sn,un,cn,dn=Z.ccclass,hn=Z.property,pn=codex,yn=pn.audio,vn=pn.player,fn=(Nt=dn("Sound"),Mt=hn(Q),Nt((xt=a((Bt=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"channelId",xt,s(e)),e.channel=null,e}return e(r,[{key:"__preload",value:function(){yn&&(this.channel=new Dt(this.node,this.channelId),yn.addChannel(this.channel))}},{key:"onLoad",value:function(){""===this.channelId&&(this.channelId=this.node.uuid)}},{key:"makePersistent",value:function(){ee.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){ee.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){if(this.isSoundEnable())return yn.play(e,t,this.channelId)}},{key:"isSoundEnable",value:function(){return!!vn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){yn.setVolume(e,this.channelId)}},{key:"pause",value:function(e){yn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&yn.resume(e,this.channelId)}},{key:"stop",value:function(e){yn.stop(e,this.channelId)}},{key:"stopAll",value:function(){yn.stopAll(this.channelId)}},{key:"mute",value:function(e){e?yn.mute(this.channelId):yn.unmute(this.channelId)}}]),r}(te)).prototype,"channelId",[Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ft=Bt))||Ft);X._RF.pop(),X._RF.push({},"84a2dB5IaRJ8JB+n9yXfBc7","AutoLayout",void 0);var gn,mn=Z.ccclass,bn=Z.property,wn=(Vt=mn("AutoLayoutWrappee"),$t=bn({type:ne}),Wt=bn({type:ne}),Vt((Yt=a((jt=e((function e(){t(this,e),l(this,"wrapeeContainer",Yt,this),l(this,"wrapee",Xt,this)}))).prototype,"wrapeeContainer",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=a(jt.prototype,"wrapee",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=jt))||Kt),Sn=(Jt=mn("AutoLayout"),Zt=bn({displayName:"Use Auto Layout"}),Qt=bn({type:[wn],displayName:"Children",visible:function(){return this.useAutoLayout}}),en=bn({visible:!1,serializable:!0}),tn=bn({type:ie,displayName:"Selected Index",visible:function(){return this.useAutoLayout}}),nn=bn({type:ae,displayName:"Deselected Icon Width",group:"Edge Icons",visible:function(){return this.useAutoLayout}}),an=bn({visible:!1,serializable:!0}),Jt((ln=a((rn=function(a){n(v,a);var r,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"useAutoLayout",ln,s(e)),l(e,"children",sn,s(e)),e.mappedChildren=[],l(e,"selected",un,s(e)),l(e,"deselectedIconW",cn,s(e)),e.tweens=[],e}return e(v,[{key:"selectedIndex",get:function(){return this.selected},set:function(e){this.selected=e,this.updateLayout(!0)}},{key:"deselectedIconWidth",get:function(){return this.deselectedIconW},set:function(e){this.deselectedIconW=e,this.updateLayout(!0)}},{key:"__preload",value:function(){this.mappedChildren=this.children.map((function(e){var t=e.wrapeeContainer.getComponent(oe);if(!t)throw new Error("AutoLayout: Widget component not found");return u(u({},e),{},{wrapeeContainerWidget:t})}))}},{key:"updateLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._layoutDirty||e){this.updateChildrenAnchors();var t,n=c(this.mappedChildren);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.wrapeeContainerWidget.updateAlignment()}}catch(e){n.e(e)}finally{n.f()}}d(h(v.prototype),"updateLayout",this).call(this,e)}},{key:"getSelectedWorldX",value:function(){var e=this.mappedChildren[this.selectedIndex].wrapeeContainer;return 0===this.selectedIndex||this.selectedIndex===this.children.length-1?e.getBoundingBoxToWorld().xMin+this.getAnchorX(this.selectedIndex)*e.width:e.getBoundingBoxToWorld().center.x}},{key:"getAnchorX",value:function(e){if(e<this.selectedIndex)return 0;if(e>this.selectedIndex)return 1;if(0===e){var t=this.mappedChildren[e].wrapeeContainer.width,n=this.deselectedIconWidth/2,i=this.paddingLeft;return((i+t+(t-n+this.spacingX))/2-i)/t}if(e===this.children.length-1){var a=this.mappedChildren[e].wrapeeContainer.width,o=a-this.deselectedIconWidth/2+this.spacingX;return((o+a+this.paddingRight)/2-o)/a}return.5}},{key:"updateChildrenAnchors",value:(r=o((function*(){var e,t=this,n=c(this.tweens);try{for(n.s();!(e=n.n()).done;)e.value.stop()}catch(e){n.e(e)}finally{n.f()}this.tweens=[],yield Promise.all([this.children.flatMap((function(e,n){return t.getChildrenAnchorsTweens(e,t.getAnchorX(n))})).map((function(e){return p.runTweenAsync(e)}))])})),function(){return r.apply(this,arguments)})},{key:"updateChildrenAnchorsEditor",value:function(){var e=this;this.children.forEach((function(t,n){var i=e.getAnchorX(n);t.wrapee.setAnchorPoint(i,t.wrapee.anchorY),t.wrapeeContainer.setAnchorPoint(i,t.wrapeeContainer.anchorY)}))}},{key:"getChildrenAnchorsTweens",value:function(e,t){return[re(e.wrapee).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapee.setAnchorPoint(t,e.wrapee.anchorY)})),re(e.wrapeeContainer).to(.3,{anchorX:t},{easing:"sineInOut"}).call((function(){e.wrapeeContainer.setAnchorPoint(t,e.wrapeeContainer.anchorY)}))]}}]),v}(le)).prototype,"useAutoLayout",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),sn=a(rn.prototype,"children",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),un=a(rn.prototype,"selected",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(rn.prototype,"selectedIndex",[tn],Object.getOwnPropertyDescriptor(rn.prototype,"selectedIndex"),rn.prototype),a(rn.prototype,"deselectedIconWidth",[nn],Object.getOwnPropertyDescriptor(rn.prototype,"deselectedIconWidth"),rn.prototype),cn=a(rn.prototype,"deselectedIconW",[an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),on=rn))||on);X._RF.pop(),X._RF.push({},"32a77jcKOREvpuCe9wamBRu","Background",void 0);(0,Z.ccclass)("Background")(gn=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.uiTransform=this.getComponent(ne),this.ratio=this.uiTransform.width/this.uiTransform.height,this.listenGameEvents(),this.handleViewResized()}},{key:"listenGameEvents",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this),se.on(y.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenGameEvents",value:function(){se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}},{key:"handleViewResized",value:function(){var e=v.cssSizeToWorldSize(v.getScreenWidthCss()),t=v.cssSizeToWorldSize(v.getScreenHeightCss());e/t<this.ratio?(this.uiTransform.width=t*this.ratio,this.uiTransform.height=t):(this.uiTransform.width=e,this.uiTransform.height=e/this.ratio)}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}}]),r}(te));X._RF.pop(),X._RF.push({},"bf320amyc1I86bS3oK0M9NR","DashboardEvents",void 0);var kn="STARS_UPDATED",Cn="PLAY_BUTTON_PRESS",En="CUSTOM_PLAY_BUTTON_PRESS",An="REQUEST_NAVIGATION",Tn="REQUEST_NAVIGATION_ANIMATION",Pn="DASHBOARD_EVENTS_BUTTON_PRESS";X._RF.pop(),X._RF.push({},"68b8bf0Va5JT7NVPECDNC5l","DashboardScreens",void 0);var Ln=function(e){return e[e.store=0]="store",e[e.collections=1]="collections",e[e.home=2]="home",e[e.leaderboard=3]="leaderboard",e[e.tournaments=4]="tournaments",e}(Ln||{});function On(e,t,n){var i;if("object"!==f(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var a=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(i.call(this))return null==a?void 0:a.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}};!function(e,t,n){var i=n.value;n.value=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}(0,t,n)}function In(e,t,n){var i;if("object"!==f(e)||void 0===t||void 0===n)return i=e,function(e,t,n){var a=n.value,r=function(){var e=o((function*(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(i.call(this))return yield null==a?void 0:a.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}));return function(){return e.apply(this,arguments)}}();n.value=r};!function(e,t,n){var i=n.value,a=function(){var e=o((function*(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(this.isValid)return yield null==i?void 0:i.apply(this,n);console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}));return function(){return e.apply(this,arguments)}}();n.value=a}(0,t,n)}ue(Ln),X._RF.pop(),X._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),X._RF.pop(),X._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),X._RF.pop(),X._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),X._RF.pop(),X._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var Rn=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"".concat(e," is missing these required properties: [").concat(n.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,i.errors=n,i}return e(r)}(g(Error));X._RF.pop(),X._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var _n=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"".concat(e," is missing the required property: <").concat(n,">"))).className=e,i.propertyName=n,i}return e(r)}(g(Error));X._RF.pop(),X._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var Dn=Ludex.Utils,Nn=Dn.String,Mn=Dn.Valid,Fn=codex.monitorError,Bn="_compUtils_ReqPropsMap";function xn(e){return null===e}function zn(e){return void 0===e}function Un(e){return xn(e)||zn(e)}function Gn(e){if("function"==typeof e)return e;switch(e){case"null-check":return xn;case"undefined-check":return zn;default:return Un}}function Hn(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var i,a=t.constructor.name,o=(i=n,"".concat("_compUtils_ReqPropsMethod","_").concat(Nn.capitalize(i)));if(void 0!==t[o])throw new Error("The required decorator found that property name ".concat(o," already exists. The reserved method name ").concat(o," is used already or the decorator was applied multiple times."));t[o]=function(t){if(e(this[n]))throw new _n(t,n)},void 0===t[Bn]&&(t[Bn]={}),void 0===t[Bn][a]&&(t[Bn][a]=[]),t[Bn][a].push(o)}}function qn(e,t){if("string"!=typeof t)return Hn(Gn(e));var n=e;Hn(Gn())(n,t)}X._RF.pop(),X._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),X._RF.pop(),X._RF.push({},"95972yG/ulEg4gycbc+QB5Y","ComponentUtils",void 0);var Vn=Ludex.Utils,$n=Vn.Array,Wn=Vn.Object,Kn=Vn.Valid,jn=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],Yn=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n),this.validComponentCalled$={}}return e(n,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredComponentNames(i),o=c(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(!e.getComponent(r))throw new Error("".concat(n,": Missing required ").concat(r," component"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredPropNames(i),o=c(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(!Wn.hasOwn(e,r))throw new Error("".concat(n,": Missing required ").concat(r," property"));var l=this.getProperty(r,e);if(!ce(l))throw new Error("".concat(n,": ").concat(r," property is not a cc object"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,i=this.getCustomPropNames(e),a=c(i);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!Wn.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var r=this.getProperty(o,e);if(!ce(r))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"getProperty",value:function(e,t){var n;if(Wn.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!Wn.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!Wn.hasOwn(e,t)&&(!!ce(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=jn;t<n.length;t++){var i=n[t];if(i.indexOf(e)>=0)return i}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!Wn.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),i=this.getProps(e.constructor);return $n.difference(n,i).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!Wn.hasOwn(e,n))return!1;var i=t.getProperty(n,e);return!(!Kn.isObject(i)||!ce(i))}))}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"required",value:function(e,t){return"string"==typeof t?qn(e,t):qn(e)}},{key:"onlyRunInLifeCycle",value:function(e,t,n){return"object"===f(e)&&void 0!==t&&void 0!==n?On(e,t,n):On(e)}},{key:"onlyRunInLifeCycleAsync",value:function(e,t,n){return"object"===f(e)&&void 0!==t&&void 0!==n?In(e,t,n):In(e)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,i=n.name;if(!this.inst.validComponentCalled$[i])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled$[i]=!0}}}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,i,a=t?t.name:e.constructor.name,o=t?t.prototype[Bn]:e.constructor.prototype[Bn],r=null!==(n=null==o?void 0:o[a])&&void 0!==n?n:[],l=[],s=e,u=c(r);try{for(u.s();!(i=u.n()).done;){var d=i.value;if("function"==typeof s[d])try{s[d](a)}catch(h){if(!(h instanceof _n))throw h;l.push(h)}}}catch(e){u.e(e)}finally{u.f()}if(0!==l.length){var h=new Rn(a,l);if(Mn.isDebugger())throw h;console.error(h),null==Fn||Fn.sendException(h)}}(e,t)}}]),n}());X._RF.pop(),X._RF.push({},"adccaBKYItKsqE+ZU1nBitm","AnimAbortSignal",void 0);var Xn,Jn,Zn,Qn,ei,ti,ni,ii,ai,oi,ri,li,si,ui,ci,di,hi,pi,yi,vi,fi,gi,mi,bi,wi,Si,ki,Ci,Ei,Ai,Ti,Pi,Li,Oi,Ii,Ri,_i,Di,Ni=Ludex.Utils.Array,Mi=function(){function n(){t(this,n),this.callbacks$=[],this.isAborted$=!1,this.abortReason$="",this.callbacks$=[]}var i;return e(n,[{key:"aborted",get:function(){return this.isAborted$}},{key:"reason",get:function(){return this.abortReason$}},{key:"addAbortListener",value:function(e){this.callbacks$.push(e)}},{key:"removeAbortListener",value:function(e){var t=Ni.searchIndex(this.callbacks$,(function(t){return t===e}));-1!==t&&this.callbacks$.splice(t,1)}},{key:"abort",value:function(e){if(!this.isAborted$){this.isAborted$=!0,this.abortReason$=e;var t,n=c(this.callbacks$);try{for(n.s();!(t=n.n()).done;){var i=t.value;"function"==typeof i&&i()}}catch(e){n.e(e)}finally{n.f()}this.callbacks$=[]}}},{key:"untilAborted",value:(i=o((function*(){var e=this;if(!this.isAborted$)return new Promise((function(t){e.addAbortListener((function(){return t()}))}))})),function(){return i.apply(this,arguments)})},{key:"call",value:function(e){this.aborted||e(this)}},{key:"callAsync",value:function(e){return this.aborted?Promise.resolve():e(this)}},{key:"chain",value:function(e){var t=this;e instanceof n?e.addAbortListener((function(){return t.abort()})):e.addEventListener("abort",(function(){return t.abort()}))}}],[{key:"hasBeenAborted",value:function(e){return null==e||e.aborted}}]),n}();X._RF.pop(),X._RF.push({},"ab9cd/wERRKYqhDoYtJ1L3w","MultiBackground",void 0);var Fi=Z.ccclass,Bi=Z.property,xi=codex.monitorError,zi=Ludex.Utils.Number,Ui=m.Layout,Gi=(Xn=Fi("MultiBackground"),Jn=Yn.required(),Zn=Bi({type:de}),Qn=Yn.required(),ei=Bi({type:he}),ti=Yn.required(),ni=Bi({type:he}),ii=Yn.required(),ai=Bi({type:de}),oi=Yn.required(),ri=Bi({type:de}),li=Yn.required(),si=Bi({type:ne}),ui=Yn.required(),ci=Bi({type:ne}),di=Yn.required(),hi=Bi({type:ne}),pi=Bi(ie),yi=Yn.required(),vi=Bi(oe),fi=Bi({type:pe(Ln)}),gi=Bi({type:pe(Ln)}),mi=Yn.onlyRunInLifeCycleAsync,bi=Yn.onlyRunInLifeCycleAsync,Xn((ki=a((Si=function(a){n(h,a);var u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"fallbackBackground",ki,s(e)),l(e,"background1",Ci,s(e)),l(e,"background2",Ei,s(e)),l(e,"background1UiOpacity",Ai,s(e)),l(e,"background2UiOpacity",Ti,s(e)),l(e,"screenUiTransform",Pi,s(e)),l(e,"background1UiTransform",Li,s(e)),l(e,"background2UiTransform",Oi,s(e)),l(e,"backgroundNudgeAmount",Ii,s(e)),l(e,"nudgeableWidget",Ri,s(e)),l(e,"pageOrder",_i,s(e)),l(e,"homePage",Di,s(e)),e.currentPage=Ln.home,e.tryNudgeBackground=function(t){var n=t.to;e.currentPage=n;var i=e.getDirection(e.homePage,n),a=zi.sign(i),o=Math.abs(i),r=e.backgroundNudgeAmount*o,l=Math.min(e.background1UiTransform.width,e.background2UiTransform.width),s=Math.max(0,(l-e.screenUiTransform.width)/2),u=Math.min(s,r)*a;re(e.nudgeableWidget).to(.5,{horizontalCenter:u},{easing:ye.cubicInOut}).start()},e}return e(h,[{key:"__preload",value:function(){this.currentBackground=this.background1,this.nextBackground=this.background2,this.currentBackgroundUiOpacity=this.background1UiOpacity,this.nextBackgroundUiOpacity=this.background2UiOpacity}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,h),this.listenToNavigationEvents()}},{key:"onDestroy",value:function(){this.unlistenToNavigationEvents()}},{key:"listenToNavigationEvents",value:function(){this.node.scene.on(Tn,this.tryNudgeBackground),se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"unlistenToNavigationEvents",value:function(){this.node.scene.off(Tn,this.tryNudgeBackground),se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"getDirection",value:function(e,t){var n=this.pageOrder.indexOf(e),i=this.pageOrder.indexOf(t);return-1===n||-1===i?(null==xi||xi.sendException(new Error("MultiBackground.getDirection: fromIndex or toIndex is -1")),0):n-i}},{key:"setCurrentTheme",value:(c=o((function*(e,t){var n;if(this.currentThemeId!==e){this.currentThemeId=e,null===(n=this.tweenSignal)||void 0===n||n.abort();var i=new Mi;null==t||t.chain(i),this.tweenSignal=i;var a=yield r.loadThemeAsync(e);a?i.aborted||(yield this.updateBackground(a,i)):null==xi||xi.sendException(new Error("MultiBackground.setCurrentTheme: Failed to load theme ".concat(e,"'s sprite.")))}})),function(e,t){return c.apply(this,arguments)})},{key:"updateBackground",value:(u=o((function*(e,t){e.packable=!1;var n=this.currentBackground,i=this.nextBackground,a=this.currentBackgroundUiOpacity,o=this.nextBackgroundUiOpacity,r=this.fallbackBackground;i.spriteFrame=e,i.node.setSiblingIndex(1),o.opacity=0,r.opacity=255,yield p.runTweenAsync(re(o).to(.25,{opacity:255}),t),a.opacity=0,r.opacity=0,this.currentBackground=i,this.nextBackground=n,this.currentBackgroundUiOpacity=i===this.background1?this.background1UiOpacity:this.background2UiOpacity,this.nextBackgroundUiOpacity=n===this.background1?this.background1UiOpacity:this.background2UiOpacity})),function(e,t){return u.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){if(e===Ui.Portrait){var t=this.getDirection(this.homePage,this.currentPage),n=zi.sign(t),i=Math.abs(t),a=this.backgroundNudgeAmount*i,o=Math.min(this.background1UiTransform.width,this.background2UiTransform.width),r=Math.max(0,(o-this.screenUiTransform.width)/2),l=Math.min(r,a)*n;this.nudgeableWidget.horizontalCenter=l}else e===Ui.Landscape&&(this.nudgeableWidget.horizontalCenter=0)}}]),h}(te)).prototype,"fallbackBackground",[Jn,Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=a(Si.prototype,"background1",[Qn,ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=a(Si.prototype,"background2",[ti,ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=a(Si.prototype,"background1UiOpacity",[ii,ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=a(Si.prototype,"background2UiOpacity",[oi,ri],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pi=a(Si.prototype,"screenUiTransform",[li,si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=a(Si.prototype,"background1UiTransform",[ui,ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oi=a(Si.prototype,"background2UiTransform",[di,hi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ii=a(Si.prototype,"backgroundNudgeAmount",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Ri=a(Si.prototype,"nudgeableWidget",[yi,vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i=a(Si.prototype,"pageOrder",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Di=a(Si.prototype,"homePage",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ln.home}}),a(Si.prototype,"setCurrentTheme",[mi],Object.getOwnPropertyDescriptor(Si.prototype,"setCurrentTheme"),Si.prototype),a(Si.prototype,"updateBackground",[bi],Object.getOwnPropertyDescriptor(Si.prototype,"updateBackground"),Si.prototype),wi=Si))||wi);X._RF.pop(),X._RF.push({},"cb1abhXDs1A57EPVKbvTJg/","ButtonPlusEvents",void 0);var Hi="TRANSITION_DOWN",qi="TRANSITION_HOVER",Vi="TRANSITION_RESET",$i="TRANSITION_DISABLED",Wi="CLICK_START",Ki="CLICK",ji="CLICK_END",Yi="CLICK_CANCEL";X._RF.pop(),X._RF.push({},"d159egaUVVLHKLg1UL865ub","SoundKeys",void 0);var Xi="musics/",Ji="sounds/",Zi=Ludex.Utils.Object,Qi={BUTTON_CLICK:"".concat(Ji,"use_item_click"),BOMB_DEFUSE:"".concat(Ji,"bomb_defuse"),BOMB_EXPLODE_1:"".concat(Ji,"bomb_explode_1"),BOMB_EXPLODE_2:"".concat(Ji,"bomb_explode_2"),CLICKS:"".concat(Ji,"clicks"),CLOSE_POPUP_CLICK:"".concat(Ji,"close_popup_click"),COLLECT_STARS:"".concat(Ji,"collect_stars"),COMBO_1:"".concat(Ji,"combo_1"),COMBO_2:"".concat(Ji,"combo_2"),COMBO_3:"".concat(Ji,"combo_3"),COMBO_4:"".concat(Ji,"combo_4"),COMBO_5:"".concat(Ji,"combo_5"),DAILY_REWARD:"".concat(Ji,"daily_reward"),EXTRA_TIME_SPAWN:"".concat(Ji,"extra_time_spawn"),GIFT_CHARGE:"".concat(Ji,"gift_charge"),GIFT_EXPLODE:"".concat(Ji,"gift_explode"),GIFT_REVEAL:"".concat(Ji,"gift_reveal"),HINT_ITEM:"".concat(Ji,"hint_item"),INVALID_MATCH:"".concat(Ji,"invalid_match"),LEVEL_COMPLETE:"".concat(Ji,"level_complete"),LEVEL_FAIL:"".concat(Ji,"level_fail"),LEVEL_START:"".concat(Ji,"level_start"),PROGRESS_STAR:"".concat(Ji,"progress_star"),RESCUE_TIMER:"".concat(Ji,"rescue_timer"),ROCKET_FLY:"".concat(Ji,"rocket_fly"),SHUFFLE_ITEM:"".concat(Ji,"shuffle_item"),THREE_STARS:"".concat(Ji,"three_stars"),TICKING_BOMB_BEFORE_EXPLODE:"".concat(Ji,"ticking_bomb_before_explode"),TILE_SELECT:"".concat(Ji,"tile_select"),USE_ITEM_CLICK:"".concat(Ji,"use_item_click"),BG_MUSIC:"".concat(Xi,"bg_music"),PATCH_SHIFT:"".concat(Ji,"patch_shift"),THUNDERBOLT:"".concat(Ji,"thunderbolt"),WIND:"".concat(Ji,"wind"),COLLECT_COINS:"".concat(Ji,"collect_coins"),COLLECT_STOCK_COINS:"".concat(Ji,"collect_stock_coins"),LEVEL_FAIL_TIMEOUT:"".concat(Ji,"level_fail_timeout"),STAR_CHEST_DRUM_ROLL:"".concat(Ji,"star_chest_drum_roll"),STAR_CHEST_OPEN:"".concat(Ji,"star_chest_open"),LEADERBOARD_TRIUMPH:"".concat(Ji,"leaderboard_triumph"),ITEM_REWARD:"".concat(Ji,"item_reward"),COMBO_6:"".concat(Ji,"combo_6"),COMBO_7:"".concat(Ji,"combo_7"),COMBO_8:"".concat(Ji,"combo_8"),COMBO_9:"".concat(Ji,"combo_9"),COMBO_10:"".concat(Ji,"combo_10"),COMBO_11:"".concat(Ji,"combo_11"),COMBO_12:"".concat(Ji,"combo_12"),COMBO_13:"".concat(Ji,"combo_13"),TILE_MATCH:"".concat(Ji,"tile_match"),TOURNAMENT_MUSIC:"".concat(Xi,"tournament_music")},ea=Zi.vals(Qi),ta=ea.reduce((function(e,t,n){return e[t]=n,e}),{});ue(ta);var na,ia,aa,oa,ra,la,sa,ua,ca,da,ha,pa,ya,va,fa,ga,ma,ba,wa,Sa,ka,Ca,Ea,Aa,Ta,Pa,La,Oa,Ia,Ra=ea;X._RF.pop(),X._RF.push({},"56710cJAPhPd4KK3hV3y8m6","ButtonPlus",void 0);var _a,Da,Na,Ma,Fa,Ba,xa,za,Ua,Ga,Ha,qa=Z.ccclass,Va=Z.property,$a=Z.disallowMultiple,Wa=Z.menu,Ka=(na=qa("ButtonPlus"),ia=Wa("Ludex/ButtonPlus/ButtonPlus"),aa=Va(ve),oa=Va(ve),ra=Va(ve),la=Va({override:!0,visible:!1}),sa=Va({override:!0,visible:!1}),ua=Va({override:!0,visible:!1}),ca=Va({override:!0,visible:!1}),da=Va({override:!0,visible:!1}),ha=Va({override:!0,visible:!1}),pa=Va({override:!0,visible:!1}),ya=Va({override:!0,visible:!1}),va=Va({override:!0,visible:!1}),fa=Va({override:!0,visible:!1}),ga=Va({override:!0,visible:!1}),ma=Va({visible:function(){return this.makeSound},type:ta}),ba=Va({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),wa=Va({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),na(Sa=$a(Sa=ia((Ca=a((ka=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"onClickStartEvents",Ca,s(e)),l(e,"onClickEndEvents",Ea,s(e)),l(e,"onClickCancelEvents",Aa,s(e)),l(e,"makeSound",Ta,s(e)),l(e,"soundKey",Pa,s(e)),l(e,"disableSpamClick",La,s(e)),l(e,"disableSpamDelay",Oa,s(e)),l(e,"performBoundsCheckOnClickCancel",Ia,s(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.hasBeenDisabled=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=v.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(e.performBoundsCheckOnClickCancel){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickCancelEvents(t),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.emitTransitionEvent(qi)))},e.onMouseLeave=function(t){e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.emitTransitionEvent(Vi)},e}return e(r,[{key:"transition",get:function(){return fe.Transition.NONE},set:function(e){b(h(r.prototype),"transition",fe.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return d(h(r.prototype),"normalColor",this)},set:function(e){b(h(r.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return d(h(r.prototype),"pressedColor",this)},set:function(e){b(h(r.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return d(h(r.prototype),"hoverColor",this)},set:function(e){b(h(r.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return d(h(r.prototype),"disabledColor",this)},set:function(e){b(h(r.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return d(h(r.prototype),"normalSprite",this)},set:function(e){b(h(r.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return d(h(r.prototype),"pressedSprite",this)},set:function(e){b(h(r.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return d(h(r.prototype),"hoverSprite",this)},set:function(e){b(h(r.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return d(h(r.prototype),"disabledSprite",this)},set:function(e){b(h(r.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return d(h(r.prototype),"duration",this)},set:function(e){b(h(r.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return d(h(r.prototype),"zoomScale",this)},set:function(e){b(h(r.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){d(h(r.prototype),"__preload",this).call(this)}},{key:"onDestroy",value:function(){var e;null===(e=d(h(r.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=d(h(r.prototype),"onEnable",this))||void 0===e||e.call(this),this.hasBeenDisabled=!this.interactable,this.node.off(ge.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(me.EventType.TOUCH_START,this.onTouchStart),this.node.on(me.EventType.TOUCH_END,this.onTouchEnd),this.node.on(me.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=d(h(r.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(me.EventType.TOUCH_START,this.onTouchStart),this.node.off(me.EventType.TOUCH_END,this.onTouchEnd),this.node.off(me.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(me.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"_updateState",value:function(){d(h(r.prototype),"_updateState",this).call(this),this.patchEmitTransitionDisabled()}},{key:"patchEmitTransitionDisabled",value:function(){var e=3===this._getButtonState();this.hasBeenDisabled!==e&&(e?this.emitTransitionEvent($i):this.emitTransitionEvent(Vi),this.hasBeenDisabled=e)}},{key:"handleDown",value:function(e){this.hasDown=!0,this.makeSound&&w.playSound(Ra[this.soundKey]),this.emitTransitionEvent(Hi),this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=c(this.onClickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Wi,this)}},{key:"emitClickEndEvents",value:function(e){var t,n=c(this.onClickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(ji,this)}},{key:"emitClickCancelEvents",value:function(e){var t,n=c(this.onClickCancelEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Yi,this)}},{key:"handleUp",value:function(e){this.hasUp=!0,this._pressed=!1,this.hasFinishClickCycle=!0,this.emitTransitionEvent(Vi),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){var t,n=c(this.clickEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}this.node.emit(Ki,this),this.node.emit(fe.EventType.CLICK,this)}}},{key:"emitTransitionEvent",value:function(e){this.node.emit(e,this)}},{key:"fakeClick",value:function(){var e=this;this.emitTransitionEvent(Hi),this.scheduleOnce((function(){e.emitTransitionEvent(Vi)}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}},{key:"setInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.interactable=e,t&&(this.enabled=e)}}]),r}(fe)).prototype,"onClickStartEvents",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ea=a(ka.prototype,"onClickEndEvents",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Aa=a(ka.prototype,"onClickCancelEvents",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(ka.prototype,"transition",[la],Object.getOwnPropertyDescriptor(ka.prototype,"transition"),ka.prototype),a(ka.prototype,"normalColor",[sa],Object.getOwnPropertyDescriptor(ka.prototype,"normalColor"),ka.prototype),a(ka.prototype,"pressedColor",[ua],Object.getOwnPropertyDescriptor(ka.prototype,"pressedColor"),ka.prototype),a(ka.prototype,"hoverColor",[ca],Object.getOwnPropertyDescriptor(ka.prototype,"hoverColor"),ka.prototype),a(ka.prototype,"disabledColor",[da],Object.getOwnPropertyDescriptor(ka.prototype,"disabledColor"),ka.prototype),a(ka.prototype,"normalSprite",[ha],Object.getOwnPropertyDescriptor(ka.prototype,"normalSprite"),ka.prototype),a(ka.prototype,"pressedSprite",[pa],Object.getOwnPropertyDescriptor(ka.prototype,"pressedSprite"),ka.prototype),a(ka.prototype,"hoverSprite",[ya],Object.getOwnPropertyDescriptor(ka.prototype,"hoverSprite"),ka.prototype),a(ka.prototype,"disabledSprite",[va],Object.getOwnPropertyDescriptor(ka.prototype,"disabledSprite"),ka.prototype),a(ka.prototype,"duration",[fa],Object.getOwnPropertyDescriptor(ka.prototype,"duration"),ka.prototype),a(ka.prototype,"zoomScale",[ga],Object.getOwnPropertyDescriptor(ka.prototype,"zoomScale"),ka.prototype),Ta=a(ka.prototype,"makeSound",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pa=a(ka.prototype,"soundKey",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),La=a(ka.prototype,"disableSpamClick",[ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Oa=a(ka.prototype,"disableSpamDelay",[wa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ia=a(ka.prototype,"performBoundsCheckOnClickCancel",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sa=ka))||Sa)||Sa)||Sa);X._RF.pop(),X._RF.push({},"b7001YamGNLeauE1hUAtFfj","ButtonPlusAnalytics",void 0);var ja,Ya,Xa,Ja,Za,Qa,eo,to,no,io,ao,oo,ro,lo,so,uo,co,ho,po,yo,vo=Z.ccclass,fo=Z.property,go=Z.disallowMultiple,mo=Z.requireComponent,bo=Z.menu,wo=Ludex.Plugins.Analytics,So=(void 0===wo?{}:wo).Events,ko=codex.analytics;_a=vo("ButtonPlusAnalytics"),Da=mo(Ka),Na=bo("Ludex/ButtonPlus/ButtonPlusAnalytics"),Ma=Yn.required(),Fa=fo(Ka),Ba=fo({visible:function(){return this.useCustomButtonName}}),_a(xa=go(xa=Da(xa=Na((Ua=a((za=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"button",Ua,s(e)),l(e,"useCustomButtonName",Ga,s(e)),l(e,"customButtonName",Ha,s(e)),e}return e(r,[{key:"onEnable",value:function(){this.button.node.on(Ki,this.onClick,this)}},{key:"onDisable",value:function(){this.button.node.off(Hi,this.onClick,this)}},{key:"onClick",value:function(){So&&ko.event(So.BUTTON_CLICK,{button_name:this.useCustomButtonName?this.customButtonName:this.node.name,screen_name:S.getCurrentPage()})}}]),r}(te)).prototype,"button",[Ma,Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ga=a(za.prototype,"useCustomButtonName",[fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ha=a(za.prototype,"customButtonName",[Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),xa=za))||xa)||xa)||xa);X._RF.pop(),X._RF.push({},"a89b3F866FGO68YNa+5Tsqh","ButtonPlusScale",void 0);var Co,Eo,Ao,To,Po,Lo,Oo,Io,Ro,_o,Do,No,Mo,Fo,Bo,xo,zo,Uo,Go,Ho,qo,Vo,$o,Wo,Ko,jo,Yo,Xo,Jo,Zo,Qo,er,tr,nr,ir,ar=Z.ccclass,or=Z.property,rr=Z.disallowMultiple,lr=Z.requireComponent,sr=Z.menu,ur=Ludex.Utils.Signal;ja=ar("ButtonPlusScale"),Ya=lr(Ka),Xa=sr("Ludex/ButtonPlus/ButtonPlusScale"),Ja=Yn.required(),Za=or(Ka),Qa=or({group:{name:"Normal",style:"section"},displayName:"Scale"}),eo=or({group:{name:"Normal",style:"section"},displayName:"Duration"}),to=or({group:{name:"Hover",style:"section"},displayName:"Scale"}),no=or({group:{name:"Hover",style:"section"},displayName:"Duration"}),io=or({group:{name:"Click",style:"section"},displayName:"Scale"}),ao=or({group:{name:"Click",style:"section"},displayName:"Duration"}),ja(oo=rr(oo=Ya(oo=Xa((lo=a((ro=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"button",lo,s(e)),l(e,"normalScale",so,s(e)),l(e,"normalDuration",uo,s(e)),l(e,"hoverScale",co,s(e)),l(e,"hoverDuration",ho,s(e)),l(e,"clickScale",po,s(e)),l(e,"clickDuration",yo,s(e)),e.animStateController=new ur.SignalController,e}return e(r,[{key:"start",value:function(){this.button.node.setScale(this.normalScale)}},{key:"onEnable",value:function(){this.button.node.on(Hi,this.onTransitionDown,this),this.button.node.on(qi,this.onTransitionHover,this),this.button.node.on(Vi,this.onTransitionReset,this)}},{key:"onDisable",value:function(){this.button.node.off(Hi,this.onTransitionDown,this),this.button.node.off(qi,this.onTransitionHover,this),this.button.node.off(Vi,this.onTransitionReset,this)}},{key:"onTransitionDown",value:function(){p.runTweenAsync(re(this.button.node).to(this.clickDuration,{scale:this.clickScale},{easing:"cubicOut"}),this.animStateController.renew())}},{key:"onTransitionHover",value:function(){p.runTweenAsync(re(this.button.node).to(this.hoverDuration,{scale:this.hoverScale},{easing:"backOut"}),this.animStateController.renew())}},{key:"onTransitionReset",value:function(){p.runTweenAsync(re(this.button.node).to(this.normalDuration,{scale:this.normalScale},{easing:"cubicOut"}),this.animStateController.renew())}}]),r}(te)).prototype,"button",[Ja,Za],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=a(ro.prototype,"normalScale",[Qa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(1,1,1)}}),uo=a(ro.prototype,"normalDuration",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),co=a(ro.prototype,"hoverScale",[to],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(1.1,1.1,1.1)}}),ho=a(ro.prototype,"hoverDuration",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),po=a(ro.prototype,"clickScale",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(.9,.9,.9)}}),yo=a(ro.prototype,"clickDuration",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),oo=ro))||oo)||oo)||oo);X._RF.pop(),X._RF.push({},"ef63ctZn6BPAout9ufUgFVq","ExtendedButton",void 0);var cr,dr,hr,pr,yr=Z.ccclass,vr=Z.property,fr=Z.disallowMultiple,gr=Z.executionOrder,mr=codex.analytics,br=Ludex,wr=br.Plugins.Analytics,Sr=(void 0===wr?{}:wr).Events,kr=br.Utils.Valid,Cr=(Co=yr("ExtendedButton"),Eo=gr(111),Ao=vr(ve),To=vr(ve),Po=vr(we.AnimationController),Lo=vr({override:!0,visible:!1}),Oo=vr({override:!0,visible:!1}),Io=vr({override:!0,visible:!1}),Ro=vr({override:!0,visible:!1}),_o=vr({override:!0,visible:!1}),Do=vr({override:!0,visible:!1}),No=vr({override:!0,visible:!1}),Mo=vr({override:!0,visible:!1}),Fo=vr({override:!0,visible:!1}),Bo=vr({override:!0,visible:!1}),xo=vr({override:!0,visible:!1}),zo=vr(Se),Uo=vr(Se),Go=vr(Se),Ho=vr({visible:function(){return this.makeSound},type:ta}),qo=vr({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),Vo=vr({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),$o=vr({}),Co(Wo=fr(Wo=Eo((jo=a((Ko=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"clickStartEvents",jo,s(e)),l(e,"clickEndEvents",Yo,s(e)),l(e,"animationController",Xo,s(e)),l(e,"useDesktopHover",Jo,s(e)),l(e,"emitAnalyticsEvents",Zo,s(e)),l(e,"makeSound",Qo,s(e)),l(e,"soundKey",er,s(e)),l(e,"disableSpamClick",tr,s(e)),l(e,"disableSpamDelay",nr,s(e)),l(e,"isScrollViewCancelInnerEvents",ir,s(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.hasFinishClickCycle=!1,e.onTouchStart=function(t){e.interactable&&(e.hasDown||(e.currentClickBoundingBox=v.getBoundingBoxToWorld(e.node),e.handleDown(t)))},e.onTouchEnd=function(t){e.scheduleOnce((function(){e.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))}),0)},e.onTouchCancel=function(t){if(e.interactable&&e.hasDown&&!e.hasUp){if(!e.isScrollViewCancelInnerEvents){var n,i,a=t.getUILocation();if(null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n)return void e.handleUp(t)}e.hasUp=!0,e.hasFinishClickCycle=!0,e.handleResetButtonState(),e.emitClickEndEvents(t)}},e.onMouseEnter=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||(e.hasFinishClickCycle=!1,e.setAnimationState("HOVER")))},e.onMouseLeave=function(t){e.useDesktopHover&&e.interactable&&(e.hasDown||e.hasUp||e.hasFinishClickCycle||e.handleResetButtonState())},e.handleResetButtonState=function(){e.hasDown=!1,e.hasUp=!1,e.setAnimationState("RESET")},e}return e(r,[{key:"transition",get:function(){return fe.Transition.NONE},set:function(e){b(h(r.prototype),"transition",fe.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return d(h(r.prototype),"normalColor",this)},set:function(e){b(h(r.prototype),"normalColor",e,this,!0)}},{key:"pressedColor",get:function(){return d(h(r.prototype),"pressedColor",this)},set:function(e){b(h(r.prototype),"pressedColor",e,this,!0)}},{key:"hoverColor",get:function(){return d(h(r.prototype),"hoverColor",this)},set:function(e){b(h(r.prototype),"hoverColor",e,this,!0)}},{key:"disabledColor",get:function(){return d(h(r.prototype),"disabledColor",this)},set:function(e){b(h(r.prototype),"disabledColor",e,this,!0)}},{key:"normalSprite",get:function(){return d(h(r.prototype),"normalSprite",this)},set:function(e){b(h(r.prototype),"normalSprite",e,this,!0)}},{key:"pressedSprite",get:function(){return d(h(r.prototype),"pressedSprite",this)},set:function(e){b(h(r.prototype),"pressedSprite",e,this,!0)}},{key:"hoverSprite",get:function(){return d(h(r.prototype),"hoverSprite",this)},set:function(e){b(h(r.prototype),"hoverSprite",e,this,!0)}},{key:"disabledSprite",get:function(){return d(h(r.prototype),"disabledSprite",this)},set:function(e){b(h(r.prototype),"disabledSprite",e,this,!0)}},{key:"duration",get:function(){return d(h(r.prototype),"duration",this)},set:function(e){b(h(r.prototype),"duration",e,this,!0)}},{key:"zoomScale",get:function(){return d(h(r.prototype),"zoomScale",this)},set:function(e){b(h(r.prototype),"zoomScale",e,this,!0)}},{key:"__preload",value:function(){d(h(r.prototype),"__preload",this).call(this),Yn.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){var e;null===(e=d(h(r.prototype),"onDestroy",this))||void 0===e||e.call(this)}},{key:"onEnable",value:function(){var e;null===(e=d(h(r.prototype),"onEnable",this))||void 0===e||e.call(this),this.node.off(ge.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(me.EventType.TOUCH_START,this.onTouchStart),this.node.on(me.EventType.TOUCH_END,this.onTouchEnd),this.node.on(me.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var e;null===(e=d(h(r.prototype),"onDisable",this))||void 0===e||e.call(this),this.node.off(me.EventType.TOUCH_START,this.onTouchStart),this.node.off(me.EventType.TOUCH_END,this.onTouchEnd),this.node.off(me.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(me.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleDown",value:function(e){if(this.hasDown=!0,this.setAnimationState("DOWN"),this.makeSound&&kr.isString(this.soundKey)){var t=Ra[this.soundKey];t&&w.playSound(t)}this.emitClickStartEvents(e)}},{key:"emitClickStartEvents",value:function(e){var t,n=c(this.clickStartEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"emitClickEndEvents",value:function(e){var t,n=c(this.clickEndEvents);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.emit([e,i.customEventData])}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleUp",value:function(e){this.hasUp=!0,this._pressed=!1,this.hasFinishClickCycle=!0,this.setAnimationState("RESET"),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(e),this.emitClickEndEvents(e)}},{key:"emitButtonEvents",value:function(e){if(this.interactable){if(this.emitAnalyticsEvents&&Sr){var t=S.getCurrentPage();mr.event(Sr.BUTTON_CLICK,{button_name:this.node.name,screen_name:t})}var n,i=c(this.clickEvents);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.emit([e,a.customEventData])}}catch(e){i.e(e)}finally{i.f()}this.node.emit(fe.EventType.CLICK,this)}}},{key:"setAnimationState",value:function(e){this.animationController&&(this.animationController.setValue("DOWN","DOWN"===e),this.animationController.setValue("HOVER","HOVER"===e),this.animationController.setValue("RESET","RESET"===e))}},{key:"fakeClick",value:function(){var e=this;this.setAnimationState("DOWN"),this.scheduleOnce((function(){e.setAnimationState("RESET")}),0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}}]),r}(fe)).prototype,"clickStartEvents",[Ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yo=a(Ko.prototype,"clickEndEvents",[To],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xo=a(Ko.prototype,"animationController",[Po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Ko.prototype,"transition",[Lo],Object.getOwnPropertyDescriptor(Ko.prototype,"transition"),Ko.prototype),a(Ko.prototype,"normalColor",[Oo],Object.getOwnPropertyDescriptor(Ko.prototype,"normalColor"),Ko.prototype),a(Ko.prototype,"pressedColor",[Io],Object.getOwnPropertyDescriptor(Ko.prototype,"pressedColor"),Ko.prototype),a(Ko.prototype,"hoverColor",[Ro],Object.getOwnPropertyDescriptor(Ko.prototype,"hoverColor"),Ko.prototype),a(Ko.prototype,"disabledColor",[_o],Object.getOwnPropertyDescriptor(Ko.prototype,"disabledColor"),Ko.prototype),a(Ko.prototype,"normalSprite",[Do],Object.getOwnPropertyDescriptor(Ko.prototype,"normalSprite"),Ko.prototype),a(Ko.prototype,"pressedSprite",[No],Object.getOwnPropertyDescriptor(Ko.prototype,"pressedSprite"),Ko.prototype),a(Ko.prototype,"hoverSprite",[Mo],Object.getOwnPropertyDescriptor(Ko.prototype,"hoverSprite"),Ko.prototype),a(Ko.prototype,"disabledSprite",[Fo],Object.getOwnPropertyDescriptor(Ko.prototype,"disabledSprite"),Ko.prototype),a(Ko.prototype,"duration",[Bo],Object.getOwnPropertyDescriptor(Ko.prototype,"duration"),Ko.prototype),a(Ko.prototype,"zoomScale",[xo],Object.getOwnPropertyDescriptor(Ko.prototype,"zoomScale"),Ko.prototype),Jo=a(Ko.prototype,"useDesktopHover",[zo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Zo=a(Ko.prototype,"emitAnalyticsEvents",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Qo=a(Ko.prototype,"makeSound",[Go],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),er=a(Ko.prototype,"soundKey",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),tr=a(Ko.prototype,"disableSpamClick",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),nr=a(Ko.prototype,"disableSpamDelay",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),ir=a(Ko.prototype,"isScrollViewCancelInnerEvents",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wo=Ko))||Wo)||Wo)||Wo);X._RF.pop(),X._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var Er,Ar,Tr,Pr,Lr,Or,Ir,Rr,_r,Dr,Nr,Mr,Fr,Br,xr,zr,Ur=Z.ccclass,Gr=Z.requireComponent,Hr=Z.property,qr=Ur("OpacityToggler")(cr=Gr([de])((hr=a((dr=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"activeValue",hr,s(e)),l(e,"inActiveValue",pr,s(e)),e.signal=new Mi,e}return e(c,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.signal.abort(),this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}},{key:"changeStateFade",value:(r=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;this.signal.abort(),this.signal=new Mi;var n=e?this.activeValue:this.inActiveValue;yield p.runTweenAsync(re(this.opacityComponent).to(t,{opacity:n}),this.signal)})),function(){return r.apply(this,arguments)})}]),c}(te)).prototype,"activeValue",[Hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),pr=a(dr.prototype,"inActiveValue",[Hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),cr=dr))||cr)||cr;X._RF.pop(),X._RF.push({},"08623z7mLxP/4DVAyNB9srK","DebugAdsPlugin",void 0);var Vr,$r,Wr,Kr=Z.ccclass,jr=Z.property,Yr=Z.requireComponent,Xr=Ludex,Jr=Xr.Events,Zr=Xr.Plugins.Ads.Types,Qr=codex,el=Qr.event,tl=Qr.ads,nl={color:"#00FFFF",prefix:"LOADING"},il={color:"#00FF00",prefix:"LOADED"},al={color:"#FF00FF",prefix:"LOAD FAIL"},ol={color:"#FFFF00",prefix:"SHOWING..."},rl={color:"#00FF00",prefix:"SHOW"},ll={color:"#FF0000",prefix:"SHOW FAIL"},sl={color:"#AAAAAA",prefix:"CLOSED"};Er=Kr("DebugAdsPlugin"),Ar=Yr(de),Tr=Yn.required(),Pr=jr(ke),Lr=Yn.required(),Or=jr(ke),Ir=Yn.required(),Rr=jr(Ce),_r=Yn.required(),Dr=jr(de),Er(Nr=Ar((Fr=a((Mr=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"statusLabel",Fr,s(e)),l(e,"timersLabel",Br,s(e)),l(e,"logLabel",xr,s(e)),l(e,"opacity",zr,s(e)),e.logLines$=[],e.touchMs$=0,e.setupEventListeners$=function(t){[[Jr.AD_LOADING,e.onAdLoading$],[Jr.AD_LOADED,e.onAdLoaded$],[Jr.AD_LOAD_FAILED,e.onAdLoadFailed$],[Jr.AD_SHOWING,e.onAdShowing$],[Jr.AD_SHOW,e.onAdShow$],[Jr.AD_SHOW_FAILED,e.onAdShowFailed$],[Jr.AD_CLOSED,e.onAdClosed$]].forEach((function(e){var n=k(e,2),i=n[0],a=n[1];el[t](i,a)})),e.node[t](ge.EventType.TOUCH_END,e.handleTouchEnd$),e.node[t](ge.EventType.TOUCH_START,e.handleTouchStart$)},e.logInitializedAds$=function(){if(tl){var t=tl.getAdsInstances();t&&0!==Object.keys(t).length?(e.addLog$("Initialized ".concat(Object.keys(t).length," ad instances:"),"#00FF00"),Object.entries(t).forEach((function(t){var n=k(t,2),i=(n[0],n[1]),a=i.deviceOS,o=i.placementId;e.addLog$("".concat(o," on ").concat(a),"#00FFFF")}))):e.addLog$("No ad instances initialized","#FFFF00")}else e.addLog$("Ads plugin not available","#FF0000")},e.handleTouchStart$=function(t){(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity)&&(Date.now()-e.touchMs$<300&&(255===e.opacity.opacity?e.opacity.opacity=0:e.opacity.opacity=255),e.touchMs$=Date.now())},e.handleTouchEnd$=function(t){t.preventSwallow=0===e.opacity.opacity},e.onAdLoading$=function(t){return e.logEvent$(nl,t)},e.onAdLoaded$=function(t){return e.logEvent$(il,t)},e.onAdLoadFailed$=function(t){return e.logEvent$(al,t)},e.onAdShowing$=function(t){return e.logEvent$(ol,t)},e.onAdShow$=function(t){return e.logEvent$(rl,t)},e.onAdShowFailed$=function(t){return e.logEvent$(ll,t)},e.onAdClosed$=function(t){return e.logEvent$(sl,t)},e.logEvent$=function(t,n){var i=n.type,a=n.placementId;e.addLog$("".concat(t.prefix,": ").concat(i," (").concat(a,")"),t.color)},e.addLog$=function(t,n){var i=(new Date).toLocaleTimeString().split(" ")[0],a="<color=".concat(n,">[").concat(i,"] ").concat(t,"</color>");e.logLines$.push(a),e.logLines$.length>20&&e.logLines$.shift(),e.logLabel&&(e.logLabel.string=e.logLines$.join("\n"))},e.updateStatus$=function(){var t=tl.enabled,n=tl.getDeviceOS(),i=tl.getDegradationTracking(),a=tl.getSafeAreaBottom(1),o=C.getBannerAdHeight(),r="N/A",l="N/A";if(i){var s=i.lastSuccessTime;l=s>0?new Date(s).toLocaleTimeString():"Never",r="".concat(i.failedAttempts)}var u=Object.values(Zr).filter((function(e){return!C.isAdEnabled(e)}));e.statusLabel.string=["Enabled: ".concat(t),"DeviceOS: ".concat(n),"Last Success: ".concat(l),"Banner Height: ".concat(o),"SafeAreaBottom: ".concat(a),"Degradation Attempts: ".concat(r),"Disabled: ".concat(u.length?u.join(", "):"None")].join("\n")},e.updateTimers$=function(){var t=tl.getLastCallAdShownTime();if(t){var n=Date.now()/1e3,i=Object.values(Zr).map((function(e){var i=t[e]||0,a=i>0?(n-i).toFixed(1):"Never";return"".concat(e,": ").concat(a,"s")})).join("\n");e.timersLabel.string="Time Since Last Show\n".concat(i)}},e}return e(r,[{key:"onLoad",value:function(){var e=this;this.logInitializedAds$(),this.setupEventListeners$("on"),this.schedule((function(){e.updateStatus$(),e.updateTimers$()}),.5)}},{key:"onDestroy",value:function(){this.setupEventListeners$("off"),this.unscheduleAllCallbacks()}}]),r}(te)).prototype,"statusLabel",[Tr,Pr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Br=a(Mr.prototype,"timersLabel",[Lr,Or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xr=a(Mr.prototype,"logLabel",[Ir,Rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=a(Mr.prototype,"opacity",[_r,Dr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr=Mr))||Nr);X._RF.pop(),X._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var ul,cl,dl,hl,pl,yl,vl,fl,gl,ml,bl,wl,Sl,kl,Cl,El,Al=Z.ccclass,Tl=Z.property,Pl=Z.requireComponent,Ll=Z.disallowMultiple,Ol=Z.executeInEditMode,Il=m.DesignSize,Rl=Il.Portrait,_l=Il.Landscape;Al("DebugResolution")(Vr=Ll(Vr=Pl([Ee])(Vr=Ol(!0)(((Wr=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return e(r,[{key:"drawPortrait",get:function(){return r._drawPortrait},set:function(e){e!==r._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),r._drawPortrait=e,r._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return r._drawLandscape},set:function(e){e!==r._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),r._drawLandscape=e,r._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(Ee),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){se.on(y.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=Rl.WIDTH,n=Rl.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=Ae.GREEN,e.rect(i,a,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=_l.WIDTH,n=_l.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=Ae.CYAN,e.rect(i,a,t,n),e.stroke()}}}]),r}(te))._drawPortrait=!0,Wr._drawLandscape=!0,a(($r=Wr).prototype,"drawPortrait",[Tl],Object.getOwnPropertyDescriptor($r.prototype,"drawPortrait"),$r.prototype),a($r.prototype,"drawLandscape",[Tl],Object.getOwnPropertyDescriptor($r.prototype,"drawLandscape"),$r.prototype),Vr=$r))||Vr)||Vr)||Vr);X._RF.pop(),X._RF.push({},"c4718hmr29IBpiwZUE/Uo4H","DebugScreenManager",void 0);var Dl=Z.ccclass,Nl=Z.property,Ml=Z.requireComponent,Fl=Ludex.Events,Bl=codex.event,xl={color:"#00FFFF",prefix:"OPEN REQ"},zl={color:"#FFFF00",prefix:"OPENING..."},Ul={color:"#00FF00",prefix:"OPENED"},Gl={color:"#FF00FF",prefix:"CLOSE REQ"},Hl={color:"#FF0000",prefix:"CLOSING..."},ql={color:"#AAAAAA",prefix:"CLOSED"};ul=Dl("DebugScreenManager"),cl=Ml(de),dl=Yn.required(),hl=Nl(ke),pl=Yn.required(),yl=Nl(ke),vl=Yn.required(),fl=Nl(Ce),gl=Yn.required(),ml=Nl(de),ul(bl=cl((Sl=a((wl=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"statusLabel",Sl,s(e)),l(e,"timersLabel",kl,s(e)),l(e,"logLabel",Cl,s(e)),l(e,"opacity",El,s(e)),e.logLines$=[],e.touchMs$=0,e.lastSwitchTime$=0,e.eventHandlers$={},e.initEventHandlers$=function(){var t;e.eventHandlers$=(E(t={},Fl.OPEN_SCREEN,(function(t){return e.logEvent$(xl,t)})),E(t,Fl.OPENING_SCREEN,(function(t){e.logEvent$(zl,t),e.lastSwitchTime$=Date.now()})),E(t,Fl.OPENED_SCREEN,(function(t){return e.logEvent$(Ul,t)})),E(t,Fl.CLOSE_SCREEN,(function(t){return e.logEvent$(Gl,t)})),E(t,Fl.CLOSING_SCREEN,(function(t){e.logEvent$(Hl,t),e.lastSwitchTime$=Date.now()})),E(t,Fl.CLOSED_SCREEN,(function(t){return e.logEvent$(ql,t)})),t)},e.setupEventListeners$=function(t){Object.entries(e.eventHandlers$).forEach((function(e){var n=k(e,2),i=n[0],a=n[1];Bl[t](i,a)})),e.node[t](ge.EventType.TOUCH_END,e.handleTouchEnd$),e.node[t](ge.EventType.TOUCH_START,e.handleTouchStart$)},e.getScreensInScene$=function(){var e=ee.getScene(),t=(null==e?void 0:e.getComponentsInChildren("BaseScreen"))||[],n=t.filter((function(e){return e.node.active}));return{sceneName:(null==e?void 0:e.name)||"Unknown",all:t,active:n}},e.logActiveScreens$=function(){var t=e.getScreensInScene$(),n=t.all,i=t.active;n.length>0?(e.addLog$("Found ".concat(n.length," screens in scene"),"#00FF00"),i.forEach((function(t){e.addLog$("Active: ".concat(t.node.name),"#00FFFF")}))):e.addLog$("No screens found in scene","#FFFF00")},e.handleTouchStart$=function(t){if(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity){if(Date.now()-e.touchMs$<300){var n=e.opacity.opacity;e.opacity.opacity=255===n?0:255}e.touchMs$=Date.now()}},e.handleTouchEnd$=function(t){t.preventSwallow=0===e.opacity.opacity},e.logEvent$=function(t,n){var i=n.screenName;e.addLog$("".concat(t.prefix,": ").concat(i),t.color)},e.addLog$=function(t,n){var i=(new Date).toLocaleTimeString().split(" ")[0],a="<color=".concat(n,">[").concat(i,"] ").concat(t,"</color>");e.logLines$.push(a),e.logLines$.length>20&&e.logLines$.shift(),e.logLabel&&(e.logLabel.string=e.logLines$.join("\n"))},e.updateStatus$=function(){var t=e.getScreensInScene$(),n=t.sceneName,i=t.all,a=t.active,o=i.length-a.length;e.statusLabel.string=["Scene: ".concat(n),"Total Screens: ".concat(i.length),"Active (".concat(a.length,"):")].concat(A(a.map((function(e){return" - ".concat(e.node.name)}))),["Inactive: ".concat(o)]).join("\n")},e.updateTimers$=function(){if(0!==e.lastSwitchTime$){var t=((Date.now()-e.lastSwitchTime$)/1e3).toFixed(1);e.timersLabel.string="Last Switch: ".concat(t,"s ago")}else e.timersLabel.string="Last Switch: Never"},e}return e(r,[{key:"onLoad",value:function(){var e=this;this.initEventHandlers$(),this.logActiveScreens$(),this.setupEventListeners$("on"),this.schedule((function(){e.updateStatus$(),e.updateTimers$()}),.5)}},{key:"onDestroy",value:function(){this.setupEventListeners$("off"),this.unscheduleAllCallbacks()}}]),r}(te)).prototype,"statusLabel",[dl,hl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=a(wl.prototype,"timersLabel",[pl,yl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cl=a(wl.prototype,"logLabel",[vl,fl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),El=a(wl.prototype,"opacity",[gl,ml],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=wl))||bl);X._RF.pop(),X._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var Vl,$l,Wl,Kl,jl,Yl,Xl,Jl,Zl,Ql,es,ts,ns,is,as,os,rs,ls,ss,us,cs,ds,hs,ps,ys,vs,fs,gs,ms,bs,ws,Ss,ks,Cs,Es,As,Ts,Ps,Ls,Os,Is,Rs,_s,Ds,Ns=function(){function n(){t(this,n),this.time=0,this._value=0,this.time=0,this._value=0}return e(n,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),n}();X._RF.pop(),X._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var Ms=Z.ccclass,Fs=Z.executionOrder,Bs=Z.property,xs=Z.requireComponent,zs=Ludex,Us=zs.Utils,Gs=Us.Valid,Hs=Us.Array,qs=Us.Device,Vs=zs.Configs.Debugger.ListPlayerDevIds,$s=codex.player,Ws=Ae.RED,Ks=Ae.YELLOW,js=Ae.WHITE,Ys=Ae.BLACK;Vl=Ms("GameStats"),$l=Fs(-1e3),Wl=xs([de]),Kl=Yn.required(),jl=Bs(ke),Yl=Yn.required(),Xl=Bs(ke),Jl=Yn.required(),Zl=Bs(ke),Ql=Yn.required(),es=Bs(ke),ts=Yn.required(),ns=Bs(ke),is=Yn.required(),as=Bs(ke),os=Yn.required(),rs=Bs(ke),ls=Yn.required(),ss=Bs(ke),us=Yn.required(),cs=Bs(ke),ds=Yn.required(),hs=Bs(ke),ps=Yn.required(),ys=Bs(ke),vs=Yn.required(),fs=Bs(he),gs=Yn.required(),ms=Bs(de),Vl(bs=$l(bs=Wl((Ss=a((ws=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"dprLabel",Ss,s(e)),l(e,"fpsLabel",ks,s(e)),l(e,"fpsRawLabel",Cs,s(e)),l(e,"drawCountLabel",Es,s(e)),l(e,"rafTimeLabel",As,s(e)),l(e,"deltaTimeLabel",Ts,s(e)),l(e,"logicTimeLabel",Ps,s(e)),l(e,"physicTimeLabel",Ls,s(e)),l(e,"renderTimeLabel",Os,s(e)),l(e,"objectMemoryUsageLabel",Is,s(e)),l(e,"textureMemoryUsageLabel",Rs,s(e)),l(e,"bg",_s,s(e)),l(e,"opacity",Ds,s(e)),e.lastRafTime$=0,e.slowRefreshInterval$=1,e.mediumRefreshInterval$=.5,e.fastRefreshInterval$=.16,e.isBackgroundEnabled$=!1,e.touchMs$=0,e.isDragging$=!1,e.listenInputEvents$=function(){e.node.on(ge.EventType.TOUCH_START,e.handleTouchStart$),e.node.on(ge.EventType.TOUCH_MOVE,e.handleTouchMove$),e.node.on(ge.EventType.TOUCH_END,e.handleTouchEnd$),e.node.on(ge.EventType.TOUCH_CANCEL,e.handleTouchEnd$),e.node.on(ge.EventType.MOUSE_WHEEL,(function(){console.info(s(e)),se.emit(y.REQUEST_DYNAMIC_ATLAS)}))},e.handleTouchStart$=function(t){(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity)&&(e.isDragging$=!1,Date.now()-e.touchMs$<300&&(255===e.opacity.opacity?e.opacity.opacity=0:(e.opacity.opacity=255,se.emit(y.REQUEST_DYNAMIC_ATLAS))),e.touchMs$=Date.now())},e.handleTouchMove$=function(t){if(t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity){var n=t.touch.getUIDelta();!e.isDragging$&&n.length()>10&&(e.isDragging$=!0),e.isDragging$&&e.node.setPosition(e.node.position.x+n.x,e.node.position.y+n.y)}},e.handleTouchEnd$=function(t){t.preventSwallow=0===e.opacity.opacity,t.touch&&e.opacity&&(e.isDragging$||(e.bg.enabled=!e.bg.enabled,e.isBackgroundEnabled$=e.bg.enabled),e.isDragging$=!1)},e.canDisplayStats$=function(){return Gs.isDebugger()||Hs.has(Vs,$s.getPlayerId())},e.startUpdateStats$=function(){e.schedule(e.updateFastStats$,e.fastRefreshInterval$),e.schedule(e.updateSlowStats$,e.slowRefreshInterval$),e.schedule(e.updateMediumStats$,e.mediumRefreshInterval$),requestAnimationFrame(e.handleRequestAnimationFrame$)},e.updateFastStats$=function(){e.updateFpsRaw$(),e.updateRafTime$(),e.updateDeltaTime$()},e.updateSlowStats$=function(){e.updateDPR$(),e.updateDrawCalls$(),e.updateObjectMemoryUsage$(),e.updateTextureMemoryUsage$()},e.updateMediumStats$=function(){e.updateFps$(),e.updateLogicTime$(),e.updatePhysicTime$(),e.updateRenderTime$()},e.calcRafTime$=function(t){var n;null!==(n=e.node)&&void 0!==n&&n.isValid&&(e.rafTimeCounter$.end(t),e.lastRafTime$=t,e.handleRequestAnimationFrame$())},e.handleRequestAnimationFrame$=function(){e.rafTimeCounter$.start(e.lastRafTime$),requestAnimationFrame(e.calcRafTime$)},e.updateFps$=function(){var t=e.getFps$();e.updateFpsColor$(t),e.fpsLabel.string="FPS: ".concat(t)},e.updateFpsColor$=function(t){t<30?e.fpsLabel.color=Ws:t<48?e.fpsLabel.color=Ks:e.setColorWithBackground$(e.fpsLabel)},e.updateFpsRaw$=function(){var t=e.getFpsRaw$();e.updateFpsRawColor$(t),e.fpsRawLabel.string="FPS Raw: ".concat(t)},e.updateFpsRawColor$=function(t){t<30?e.fpsRawLabel.color=Ws:t<48?e.fpsRawLabel.color=Ks:e.setColorWithBackground$(e.fpsRawLabel)},e.updateDrawCalls$=function(){var t=e.getDrawCalls$();e.updateDrawCallsColor$(t),e.drawCountLabel.string="Draw Calls: ".concat(t)},e.updateDrawCallsColor$=function(t){var n=Te.os===Te.OS.IOS,i=n?60:25;t>(n?80:40)?e.drawCountLabel.color=Ws:t>i?e.drawCountLabel.color=Ks:e.setColorWithBackground$(e.drawCountLabel)},e.updateRafTime$=function(){var t=e.getRafTime$();e.updateRafTimeColor$(t),e.rafTimeLabel.string="RAF Time: ".concat(t,"ms")},e.updateRafTimeColor$=function(t){t>33?e.rafTimeLabel.color=Ws:t>20?e.rafTimeLabel.color=Ks:e.setColorWithBackground$(e.rafTimeLabel)},e.updateDeltaTime$=function(){var t=e.getDeltaTime$();e.updateDeltaTimeColor$(t),e.deltaTimeLabel.string="Delta Time: ".concat(t,"ms")},e.updateDeltaTimeColor$=function(t){t>33?e.deltaTimeLabel.color=Ws:t>20?e.deltaTimeLabel.color=Ks:e.setColorWithBackground$(e.deltaTimeLabel)},e.updateLogicTime$=function(){var t=e.getLogicTime$();e.updateLogicTimeColor$(t),e.logicTimeLabel.string="Logic Time: ".concat(t,"ms")},e.updateLogicTimeColor$=function(t){t>10?e.logicTimeLabel.color=Ws:t>5?e.logicTimeLabel.color=Ks:e.setColorWithBackground$(e.logicTimeLabel)},e.updatePhysicTime$=function(){var t=e.getPhysicTime$();e.updatePhysicTimeColor$(t),e.physicTimeLabel.string="Physic Time: ".concat(t,"ms")},e.updatePhysicTimeColor$=function(t){t>10?e.physicTimeLabel.color=Ws:t>5?e.physicTimeLabel.color=Ks:e.setColorWithBackground$(e.physicTimeLabel)},e.updateRenderTime$=function(){var t=e.getRenderTime$();e.updateRenderTimeColor$(t),e.renderTimeLabel.string="Render Time: ".concat(t,"ms")},e.updateRenderTimeColor$=function(t){t>10?e.renderTimeLabel.color=Ws:t>5?e.renderTimeLabel.color=Ks:e.setColorWithBackground$(e.renderTimeLabel)},e.updateObjectMemoryUsage$=function(){var t=e.getObjectMemoryUsage$();e.updateObjectMemoryUsageColor$(t),e.objectMemoryUsageLabel.string="Object Mem: ".concat(t,"MB")},e.updateObjectMemoryUsageColor$=function(t){t>40?e.objectMemoryUsageLabel.color=Ws:t>25?e.objectMemoryUsageLabel.color=Ks:e.setColorWithBackground$(e.objectMemoryUsageLabel)},e.updateTextureMemoryUsage$=function(){var t=e.getTextureMemoryUsage$();e.updateTextureMemoryUsageColor$(t),e.textureMemoryUsageLabel.string="Texture Mem: ".concat(t,"MB")},e.updateTextureMemoryUsageColor$=function(t){t>200?e.textureMemoryUsageLabel.color=Ws:t>100?e.textureMemoryUsageLabel.color=Ks:e.setColorWithBackground$(e.textureMemoryUsageLabel)},e.updateDPR$=function(){var t=qs.pixelRatio();e.updateDPRColor$(t),e.dprLabel.string="DPR: ".concat(t)},e.updateDPRColor$=function(t){t>2?e.dprLabel.color=Ws:t<=1?e.dprLabel.color=Ks:e.setColorWithBackground$(e.dprLabel)},e.setColorWithBackground$=function(t){var n=e.isBackgroundEnabled$?Ys:js;t.color.equals(n)||(t.color=n)},e.getFps$=function(){if(!ee.root)return 0;var e=ee.root.fps;return Math.round(e)||0},e.getDrawCalls$=function(){return ee.root&&ee.root.device.numDrawCalls||0},e.toFixed$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(t))||0},e.getFpsRaw$=function(){return e.toFixed$(1e3/e.rafTimeCounter$.value,0)},e.getRafTime$=function(){return e.toFixed$(e.rafTimeCounter$.value)},e.getDeltaTime$=function(){return e.toFixed$(1e3*se.deltaTime)},e.getLogicTime$=function(){return e.toFixed$(e.logicTimeCounter$.value)},e.getPhysicTime$=function(){return e.toFixed$(e.physicTimeCounter$.value)},e.getRenderTime$=function(){return e.toFixed$(e.renderTimeCounter$.value)},e.getObjectMemoryUsage$=function(){if(!ee.root)return 0;var t=ee.root.device.memoryStatus;return e.toFixed$(t.bufferSize/1048576,4)||0},e.getTextureMemoryUsage$=function(){if(!ee.root)return 0;var t=ee.root.device.memoryStatus;return e.toFixed$(t.textureSize/1048576,4)||0},e.beforeUpdate$=function(){var t=performance.now();e.logicTimeCounter$.start(t)},e.afterUpdate$=function(){var t=performance.now();e.logicTimeCounter$.end(t)},e.beforePhysics$=function(){var t=performance.now();e.physicTimeCounter$.start(t)},e.afterPhysics$=function(){var t=performance.now();e.physicTimeCounter$.end(t)},e.beforeDraw$=function(){var t=performance.now();e.renderTimeCounter$.start(t)},e.afterDraw$=function(){var t=performance.now();e.renderTimeCounter$.end(t)},e}return e(r,[{key:"__preload",value:function(){this.listenInputEvents$()}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.bg.enabled=!1,this.canDisplayStats$()?(this.node.active=!0,this.rafTimeCounter$=new Ns,this.logicTimeCounter$=new Ns,this.physicTimeCounter$=new Ns,this.renderTimeCounter$=new Ns,ee.on(Pe.EVENT_BEFORE_UPDATE,this.beforeUpdate$,this),ee.on(Pe.EVENT_AFTER_UPDATE,this.afterUpdate$,this),ee.on(Pe.EVENT_BEFORE_PHYSICS,this.beforePhysics$,this),ee.on(Pe.EVENT_AFTER_PHYSICS,this.afterPhysics$,this),ee.on(Pe.EVENT_BEFORE_DRAW,this.beforeDraw$,this),ee.on(Pe.EVENT_AFTER_DRAW,this.afterDraw$,this),this.startUpdateStats$()):this.node.active=!1}},{key:"onDestroy",value:function(){this.canDisplayStats$()&&(ee.off(Pe.EVENT_BEFORE_UPDATE,this.beforeUpdate$,this),ee.off(Pe.EVENT_AFTER_UPDATE,this.afterUpdate$,this),ee.off(Pe.EVENT_BEFORE_PHYSICS,this.beforePhysics$,this),ee.off(Pe.EVENT_AFTER_PHYSICS,this.afterPhysics$,this),ee.off(Pe.EVENT_BEFORE_DRAW,this.beforeDraw$,this),ee.off(Pe.EVENT_AFTER_DRAW,this.afterDraw$,this),this.unschedule(this.updateSlowStats$),this.unschedule(this.updateFastStats$),this.unschedule(this.updateMediumStats$),this.node.off(ge.EventType.TOUCH_START,this.handleTouchStart$),this.node.off(ge.EventType.TOUCH_MOVE,this.handleTouchMove$),this.node.off(ge.EventType.TOUCH_END,this.handleTouchEnd$),this.node.off(ge.EventType.TOUCH_CANCEL,this.handleTouchEnd$))}}]),r}(te)).prototype,"dprLabel",[Kl,jl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=a(ws.prototype,"fpsLabel",[Yl,Xl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cs=a(ws.prototype,"fpsRawLabel",[Jl,Zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Es=a(ws.prototype,"drawCountLabel",[Ql,es],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),As=a(ws.prototype,"rafTimeLabel",[ts,ns],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts=a(ws.prototype,"deltaTimeLabel",[is,as],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ps=a(ws.prototype,"logicTimeLabel",[os,rs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls=a(ws.prototype,"physicTimeLabel",[ls,ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Os=a(ws.prototype,"renderTimeLabel",[us,cs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Is=a(ws.prototype,"objectMemoryUsageLabel",[ds,hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rs=a(ws.prototype,"textureMemoryUsageLabel",[ps,ys],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_s=a(ws.prototype,"bg",[vs,fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ds=a(ws.prototype,"opacity",[gs,ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=ws))||bs)||bs);X._RF.pop(),X._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var Xs,Js=function(e){return e.CHALLENGE_FRIENDS="challenge-friends",e.REPLAY_FRIENDS="replay-friends",e.SHOW_CHALLENGE_RESULTS="show-challenge-results",e.UPDATE_MUSIC="update-music",e.NEXT_LEVEL="next-level",e.MAX_LEVEL="max-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.GAME_FINISH="game-finish",e.GAME_EXIT="game-exit",e.USE_ITEM="use-item",e.SKIP_LEVEL="skip-level",e.ADD_ITEM="add-item",e.ADD_ITEMS="add-items",e.REFRESH_ITEMS="refresh-items",e.ADD_COINS="add-coins",e.REMOVE_COINS="remove-coins",e.REMOVE_COINS_SUCCESS="remove-coins-success",e.REMOVE_COINS_FAILED="remove-coins-failed",e.COIN_CHANGED="coin-changed",e.ABORT_COIN_ANIMATION="abort-coin-animation",e.ADD_STARS="add-stars",e.PAUSE_TIME="pause-time",e.RESUME_TIME="resume-time",e.TIME_OUT="time-out",e.HALF_TIME="half-time",e.RESCUE_START="rescue-time",e.RESCUE_FINISHED="clock-animation-finished",e.TIME_UPDATED="time-updated",e.APPLY_GRAVITY="apply-gravity",e.GRID_ORIENTATION_CHANGE="grid-orientation-change",e.IDLE_ENTER="idle-enter",e.IDLE_EXIT="idle-exit",e.GRID_MATCH="grid-match",e.GRID_MATCH_SUCCESS="grid-match-success",e.GRID_MATCH_FAIL="grid-match-fail",e.GRID_CLEAR="grid-clear",e.GRID_SPAWN="grid-spawn",e.GRID_CREATE="grid-create",e.GRID_RESIZE="grid-resize",e.TILE_CLICK="tile-click",e.BOMB_EXPLODE="bomb-explode",e.SHOW_HINT="show-hint",e.ADD_COMBO="add-combo",e.COMBO_UPDATED="combo-updated",e.COMBO_ENDED="combo-ended",e.COMBO_PROGRESS="combo-progress",e.ADD_SCORE="add-score",e.SCORE_UPDATED="score-updated",e.SHOW_UI="show-ui",e.HIDE_UI="hide-ui",e.AUTO_PLAY="auto-play",e.GUIDE_MASK_CLICKED="guide-mask-clicked",e.ITEM_MASK_CLICKED="item-mask-clicked",e.EFFECTS_ANIMATION_START="effects-start",e.EFFECTS_ANIMATION_END="effects-end",e}(Js||{});X._RF.pop(),X._RF.push({},"8249dDH5xBEc4nnCGRgSjaW","PanelAnimationController",void 0);var Zs,Qs,eu,tu,nu,iu,au,ou,ru,lu,su,uu,cu,du,hu,pu,yu,vu,fu=(0,Z.ccclass)("PanelAnimationController")(Xs=function(a){n(l,a);var r=i(l);function l(){var e;t(this,l);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=r.call.apply(r,[this].concat(i))).animators=new Set,e.eventTarget=new Le,e.handleRegistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)&&console.warn("Animator already registered."),e.animators.add(t)},e.handleUnregistration=function(t){if(!t)throw new Error("Invalid event payload.");e.animators.has(t)||console.warn("Animator not registered."),e.animators.delete(t)},e.handleShowUIs=function(){var t=o((function*(t){var n,i,a,o=!1,r=[],l=c(e.animators);try{for(l.s();!(a=l.n()).done;){var s=a.value;r.push(s)}}catch(e){l.e(e)}finally{l.f()}for(var u=[],d=0,h=r;d<h.length;d++){var p,y=h[d];if(!y.isReadyForAnimation()&&!o)o=!0,null==t||null===(p=t.fallback)||void 0===p||p.call(t);u.push(y.handleShowUI())}yield Promise.all(u),null==t||null===(n=t.onComplete)||void 0===n||n.call(t),null===(i=e.eventTarget)||void 0===i||i.emit(Js.SHOW_UI)}));return function(e){return t.apply(this,arguments)}}(),e.handleHideUIs=function(){var t=o((function*(t){var n,i,a,o=!1,r=[],l=c(e.animators);try{for(l.s();!(a=l.n()).done;){var s=a.value;r.push(s)}}catch(e){l.e(e)}finally{l.f()}for(var u=[],d=0,h=r;d<h.length;d++){var p,y=h[d];if(!y.isReadyForAnimation()&&!o)o=!0,null==t||null===(p=t.fallback)||void 0===p||p.call(t);u.push(y.handleHideUI())}yield Promise.all(u),null==t||null===(n=t.onComplete)||void 0===n||n.call(t),null===(i=e.eventTarget)||void 0===i||i.emit(Js.HIDE_UI)}));return function(e){return t.apply(this,arguments)}}(),e}return e(l,[{key:"onEnable",value:function(){this.node.scene.on(Js.SHOW_UI,this.handleShowUIs,this),this.node.scene.on(Js.HIDE_UI,this.handleHideUIs,this)}},{key:"onDisable",value:function(){this.node.scene.off(Js.SHOW_UI,this.handleShowUIs,this),this.node.scene.off(Js.HIDE_UI,this.handleHideUIs,this)}},{key:"showUI",value:function(){return this.handleShowUIs()}},{key:"hideUI",value:function(){return this.handleHideUIs()}},{key:"on",value:function(e,t,n,i){this.eventTarget.on(e,t,n,i)}},{key:"off",value:function(e,t,n){this.eventTarget.off(e,t,n)}}],[{key:"getController",value:function(e){for(var t=null,n=e;null!==n;){if(t=n.getComponent(l))return t;n=n.parent}return t}},{key:"registerAnimator",value:function(e){var t=this.getController(e.node);t?t.handleRegistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}},{key:"unregisterAnimator",value:function(e){var t=this.getController(e.node);t?t.handleUnregistration(e):console.warn("No PanelAnimationController found for animator ".concat(e.node.name))}}]),l}(te))||Xs;X._RF.pop(),X._RF.push({},"f190aWZvVlGiplYX4XrZG3a","PanelAnimator",void 0);var gu,mu=Z.ccclass,bu=Z.property,wu=Ludex.Utils.Object,Su=(Zs=mu("AnimationConfig"),Qs=bu({type:[oe]}),Zs((nu=a((tu=function(){function n(){t(this,n),l(this,"startHidden",nu,this),l(this,"nodes",iu,this),l(this,"posOffset",au,this),l(this,"showEase",ou,this),l(this,"hideEase",ru,this),l(this,"showDuration",lu,this),l(this,"hideDuration",su,this)}return e(n,[{key:"setConfig",value:function(e){e&&wu.assign(this,e)}}]),n}()).prototype,"startHidden",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),iu=a(tu.prototype,"nodes",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),au=a(tu.prototype,"posOffset",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ou=a(tu.prototype,"showEase",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),ru=a(tu.prototype,"hideEase",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backIn"}}),lu=a(tu.prototype,"showDuration",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),su=a(tu.prototype,"hideDuration",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),eu=tu))||eu),ku=(uu=mu("PanelAnimator"),cu=bu({type:Su,displayName:"Top animation nodes"}),du=bu({type:Su,displayName:"Bottom animation nodes"}),uu((yu=a((pu=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"topConfig",yu,s(e)),l(e,"botConfig",vu,s(e)),e.isReady=!1,e}return e(d,[{key:"onEnable",value:function(){fu.registerAnimator(this)}},{key:"onDisable",value:function(){fu.unregisterAnimator(this)}},{key:"onLoad",value:function(){this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos(),this.isReady=!0}},{key:"initUIPos",value:function(){this.topAnimator.switchState(this.topConfig.startHidden?"hidden":"shown",!0),this.botAnimator.switchState(this.botConfig.startHidden?"hidden":"shown",!0)}},{key:"isReadyForAnimation",value:function(){return this.isReady}},{key:"handleShowUI",value:(u=o((function*(){if(this.isReady)return Promise.all([this.topAnimator.switchState("shown"),this.botAnimator.switchState("shown")]);console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"))})),function(){return u.apply(this,arguments)})},{key:"handleHideUI",value:(r=o((function*(){if(this.isReady)return Promise.all([this.topAnimator.switchState("hidden"),this.botAnimator.switchState("hidden")]);console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"))})),function(){return r.apply(this,arguments)})},{key:"createAnimator",value:function(e,t){var n=e.nodes,i=e.posOffset,a=e.showEase,r=e.hideEase,l=e.showDuration,s=e.hideDuration,u=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom}:{mode:"position",value:e.node.position.y}})),c=n.map((function(e){return"top"===t&&e.isAlignTop?{mode:"top",value:e.top+i}:"bottom"===t&&e.isAlignBottom?{mode:"bottom",value:e.bottom-i}:{mode:"position",value:e.node.position.y+i}})),h="shown",y=new Mi;return{switchState:function(){var e=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y.abort();var i=new Mi;if(y=i,h!==e){h=e;var o="hidden"===e?u:c,v="hidden"===e?c:u,f="hidden"===e?s:l,g="hidden"===e?r:a,m=function(){for(var e=0,t=n.length;e<t;e++){var i=n[e],a=o[e],r=v[e].value;d.setToTargetImmediately(i,a,r)}};t?m():(i.addAbortListener(m),yield Promise.all(n.map((function(e,t){var n=o[t],a=v[t].value;return p.runTweenAsync(d.getTween({widget:e,config:n,target:a,easing:g,duration:f}),i)}))),i.aborted||i.removeAbortListener(m))}}));return function(t){return e.apply(this,arguments)}}()}}},{key:"setAnimator",value:function(e){var t=e.topConfig,n=e.botConfig,i=new Su,a=new Su;i.setConfig(t),a.setConfig(n),this.topConfig=i,this.botConfig=a,this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos()}}],[{key:"getTween",value:function(e){var t=e.widget,n=e.config,i=e.target,a=e.easing,o=e.duration;return"top"===n.mode?re(t).call((function(){t.top=n.value})).to(o,{top:i},{easing:a}):"bottom"===n.mode?re(t).call((function(){t.bottom=n.value})).to(o,{bottom:i},{easing:a}):re(t.node.position).call((function(){t.node.setPosition(t.node.position.x,n.value,t.node.position.z)})).to(o,{y:i},{easing:a})}},{key:"setToTargetImmediately",value:function(e,t,n){"top"===t.mode&&(e.top=n),"bottom"===t.mode&&(e.bottom=n);var i=e.node.position.x,a=n,o=e.node.position.z;e.node.setPosition(i,a,o)}}]),d}(te)).prototype,"topConfig",[cu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Su}}),vu=a(pu.prototype,"botConfig",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Su}}),hu=pu))||hu);X._RF.pop(),X._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var Cu,Eu=Z.ccclass,Au=Z.disallowMultiple,Tu=Z.executeInEditMode,Pu=Z.requireComponent,Lu=Eu("ParticleSystem2DExtra")(gu=Tu(!0)(gu=Au(!0)(gu=Pu(Oe)(gu=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var o=i[a];e.updateParticle(o,n)}t(n)}},e}return e(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(Oe),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),r}(te))||gu)||gu)||gu)||gu;X._RF.pop(),X._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);var Ou,Iu,Ru,_u,Du,Nu,Mu,Fu,Bu,xu,zu,Uu,Gu,Hu,qu,Vu,$u,Wu,Ku,ju,Yu,Xu;(0,Z.ccclass)("ExampleParticleSystem2DExtra")(Cu=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"initParticle",value:function(e){e.maxSize=Ie.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=Ie.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Ie.randomRange(-350,350),e.y=n+Ie.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(Lu));X._RF.pop(),X._RF.push({},"6ea01hdw/9MHb28SCDAiRss","ResizeWithBannerAd",void 0);var Ju,Zu,Qu,ec,tc,nc,ic,ac,oc,rc,lc,sc,uc=Z.ccclass,cc=Z.requireComponent,dc=Z.property,hc=codex,pc=hc.ads,yc=hc.event,vc=Ludex,fc=vc.Events,gc=vc.Plugins.Ads,mc=void 0===gc?{}:gc,bc=mc.Types,wc=mc.Status,Sc=vc.Utils,kc=Sc.Array,Cc=Sc.Function,Ec=Sc.Device,Ac=["top","topleft","topright"],Tc=["bottom","bottomleft","bottomright"],Pc=["left","topleft","bottomleft"],Lc=["right","topright","bottomright"];Ou=uc("ResizeWithBannerAd"),Iu=cc(oe),Ru=Yn.required(),_u=dc(Se),Du=Yn.required(),Nu=dc(Se),Mu=Yn.required(),Fu=dc(Se),Bu=Yn.required(),xu=dc(Se),zu=Yn.required(),Uu=dc(Se),Gu=Yn.required(),Hu=dc(oe),Ou(qu=Iu(($u=a((Vu=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"includeSAB",$u,s(e)),l(e,"includeRightBanner",Wu,s(e)),l(e,"includeBottomBanner",Ku,s(e)),l(e,"includeLeftBanner",ju,s(e)),l(e,"closeWhenAdFailed",Yu,s(e)),l(e,"widget",Xu,s(e)),e.setupEventListeners$=function(t){[[fc.AD_SHOWING,e.handleOnAdShowing$],[fc.AD_CLOSED,e.handleOnAdClosed$],[fc.AD_SHOW_FAILED,e.handleOnAdFailed$],[y.VIEW_RESIZED,e.handleOnResize$]].forEach((function(e){var n=k(e,2),i=n[0],a=n[1];yc[t](i,a)}))},e.handleOnAdShowing$=function(t){var n=t.placementId,i=t.type;if(e.checkValid$()&&n&&bc&&i===bc.BANNER){try{if(!pc.getAd(bc.BANNER,n))return}catch(e){return void console.debug("Error getting banner ad:",e)}e.resizeWhenBannerAdShow$(n),e.emitResizeEvent()}},e.handleOnAdClosed$=function(t){var n=t.placementId,i=t.type;if(e.checkValid$()&&n&&bc&&i===bc.BANNER){try{if(!pc.getAd(bc.BANNER,n))return}catch(e){return void console.debug("Error getting banner ad:",e)}e.resizeWhenBannerAdClose$(n),e.emitResizeEvent()}},e.handleOnAdFailed$=function(t){var n=t.placementId,i=t.type;e.closeWhenAdFailed&&e.checkValid$()&&n&&bc&&i===bc.BANNER&&(e.resizeWhenBannerAdClose$(n),e.emitResizeEvent())},e.handleOnResize$=function(){if(e.checkValid$()&&bc&&wc)if(C.isAdEnabled(bc.BANNER)){var t=pc.getAdsByType(bc.BANNER);0!==t.length?t.forEach((function(t){var n=pc.getAdStatus(bc.BANNER,t.placementId);n&&(n===wc.SHOWING||Ec.isIOS()?e.resizeWhenBannerAdShow$(t.placementId):n===wc.IDLE&&e.resizeWhenBannerAdClose$(t.placementId))})):e.resizeSafeAreaBottom$()}else e.resizeSafeAreaBottom$()},e.getBannerHeight$=function(t,n){try{var i=pc.getBannerConfig(t),a=i.PlacementId,o=i.Position,r=e.includeSAB&&"bottom"===o;return pc.getBannerHeight(a,n,r)}catch(e){return console.debug("[ResizeWithBannerAd] Error getting banner ad:",e),0}},e.resizeWhenBannerAdShow$=function(t){var n,i,a,o,r=v.cssSizeToWorldSize(1),l=e.getBannerHeight$(t,r),s=pc.getBannerConfig(t),u=s.BannerWidth,c=s.Position;if("top"===c)n=l;else if("bottom"===c)e.includeBottomBanner?i=l:e.includeSAB&&(i=pc.getSafeAreaBottom(r));else if("left"===c||"right"===c){if(void 0===u)return;var d=u;"getBannerOffset"in GameSDK.extra&&(d+=GameSDK.extra.getBannerOffset()),"left"===c&&e.includeLeftBanner?a=d*r:"right"===c&&e.includeRightBanner&&(o=d*r)}e.updateWidgets$({top:n,bottom:i,left:a,right:o})},e.resizeWhenBannerAdClose$=function(t){var n=pc.getBannerConfig(t).Position,i=v.cssSizeToWorldSize(1),a=e.includeSAB?pc.getSafeAreaBottom(i):0;e.updateWidgets$({top:kc.has(Ac,n)?0:void 0,bottom:kc.has(Tc,n)?a:void 0,left:kc.has(Pc,n)?0:void 0,right:kc.has(Lc,n)?0:void 0})},e.resizeSafeAreaBottom$=function(){var t=v.cssSizeToWorldSize(1),n=e.includeSAB?pc.getSafeAreaBottom(t):0;e.updateWidgets$({bottom:n})},e.updateWidgets$=function(t){var n=t.top,i=t.bottom,a=t.left,o=t.right;e.widget.top=null!=n?n:e.widget.top,e.widget.bottom=null!=i?i:e.widget.bottom,e.widget.left=null!=a?a:e.widget.left,e.widget.right=null!=o?o:e.widget.right,Re.instance.emit("canvas-resize")},e.emitResizeEvent=Cc.debounce((function(){se.emit(y.WIDGET_RESIZED)}),100),e.checkValid$=function(){return e.node.activeInHierarchy&&null!==e.node.parent&&void 0!==e.node.parent},e}return e(r,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this),this.setupEventListeners$("on")}},{key:"onDestroy",value:function(){this.setupEventListeners$("off")}},{key:"start",value:function(){this.handleOnResize$()}}]),r}(te)).prototype,"includeSAB",[Ru,_u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Wu=a(Vu.prototype,"includeRightBanner",[Du,Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ku=a(Vu.prototype,"includeBottomBanner",[Mu,Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ju=a(Vu.prototype,"includeLeftBanner",[Bu,xu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Yu=a(Vu.prototype,"closeWhenAdFailed",[zu,Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xu=a(Vu.prototype,"widget",[Gu,Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qu=Vu))||qu);X._RF.pop(),X._RF.push({},"3825fBvhGRPUK6d/ohif+v0","PreloadSprite",void 0);var Oc=Z.ccclass,Ic=Z.property,Rc=Z.requireComponent,_c=m.Layout,Dc=function(e){return e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape",e}(Dc||{}),Nc=[_c.Portrait,_c.Landscape];ue(Dc);var Mc,Fc,Bc,xc,zc,Uc,Gc,Hc,qc,Vc,$c;Ju=Oc("PreloadSprite"),Zu=Rc(he),Qu=Ic({type:Dc}),ec=Ic({type:T}),tc=Ic({type:Se}),nc=Yn.required(),Ju(ic=Zu((oc=a((ac=function(a){n(d,a);var u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"layout",oc,s(e)),l(e,"path",rc,s(e)),l(e,"packable",lc,s(e)),l(e,"sprite",sc,s(e)),e}return e(d,[{key:"__preload",value:function(){this.sprite=this.getComponent(he),Yn.validateRequiredProperties(this,d),se.on(y.ORIENTATION_CHANGED,this.loadSpriteFrame,this),this.loadSpriteFrame()}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}},{key:"loadSpriteFrame",value:(u=o((function*(){if(this.sprite.spriteFrame)this.unlistenEvent();else if(P.getCurrentLayout()===Nc[this.layout]&&this.path){var e="".concat(L[this.path],"/spriteFrame");if(e){var t=yield r.loadSpriteFrameAsync(e,this.packable);this.enabledInHierarchy&&!this.sprite.spriteFrame?(this.sprite.spriteFrame=t,this.unlistenEvent()):this.unlistenEvent()}}})),function(){return u.apply(this,arguments)})},{key:"unlistenEvent",value:function(){se.off(y.ORIENTATION_CHANGED,this.loadSpriteFrame,this)}}]),d}(te)).prototype,"layout",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc=a(ac.prototype,"path",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lc=a(ac.prototype,"packable",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sc=a(ac.prototype,"sprite",[nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic=ac))||ic);X._RF.pop(),X._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var Wc,Kc,jc,Yc,Xc,Jc,Zc,Qc=Z.ccclass,ed=Z.property,td=Z.executeInEditMode,nd=Z.requireComponent,id=(Mc=Qc("TapperedProgressBar"),Fc=nd(de),Bc=ed({type:de,displayName:"Fill opacity"}),xc=ed({type:he,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),zc=ed({type:he,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),Uc=ed({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),Mc(Gc=td(Gc=Fc((qc=a((Hc=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"uiOpacity",qc,s(e)),l(e,"leftCap",Vc,s(e)),l(e,"rightCap",$c,s(e)),e}return e(r,[{key:"progress",get:function(){return d(h(r.prototype),"progress",this)},set:function(e){b(h(r.prototype),"progress",e,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity)if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var e=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=e}}},{key:"start",value:function(){this.updateAppearance()}}]),r}(_e)).prototype,"uiOpacity",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vc=a(Hc.prototype,"leftCap",[xc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$c=a(Hc.prototype,"rightCap",[zc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a(Hc.prototype,"progress",[Uc],Object.getOwnPropertyDescriptor(Hc.prototype,"progress"),Hc.prototype),Gc=Hc))||Gc)||Gc)||Gc);X._RF.pop(),X._RF.push({},"aa60frMJLtIlJZh2yJhMp1s","DynamicLabel",void 0);var ad,od,rd,ld,sd,ud,cd,dd,hd,pd,yd,vd,fd,gd,md,bd,wd,Sd,kd,Cd,Ed,Ad,Td,Pd,Ld,Od,Id,Rd,_d,Dd,Nd,Md,Fd,Bd,xd,zd,Ud,Gd,Hd,qd,Vd=Z.ccclass,$d=Z.property,Wd=Z.executeInEditMode,Kd=Z.requireComponent;Wc=Vd("DynamicLabel"),Kc=Kd(ke),jc=Wd(!0),Yc=$d({type:ae,min:1,max:200}),Xc=$d({type:ae,min:.1,max:4}),Wc(Jc=Kc(Jc=jc((a((Zc=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i)))._quality=1,e._size=1,e._outlineWidth=0,e._shadowOffset=new De(0,0),e}return e(r,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.label.fontSize=this.size*this.quality}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.node.scale=new be(1/this.quality,1/this.quality,1),this.label.fontSize=this.size*this.quality,this.label.outlineWidth=this._outlineWidth*this.quality,this.label.shadowOffset=this._shadowOffset.multiplyScalar(this.quality)}},{key:"__preload",value:function(){this.label=this.getComponent(ke)}},{key:"start",value:function(){this._quality=1/this.node.scale.x,this._size=this.label.fontSize/this.quality,this._outlineWidth=this.label.outlineWidth,this._shadowOffset=this.label.shadowOffset,this.quality=window.devicePixelRatio,console.info(" ".concat(this.node.name,"<Label> quality:"),this.quality)}}]),r}(te)).prototype,"size",[Yc],Object.getOwnPropertyDescriptor(Zc.prototype,"size"),Zc.prototype),a(Zc.prototype,"quality",[Xc],Object.getOwnPropertyDescriptor(Zc.prototype,"quality"),Zc.prototype),Jc=Zc))||Jc)||Jc);X._RF.pop(),X._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var jd=Z.ccclass,Yd=Z.property,Xd=Z.executeInEditMode,Jd=Z.disallowMultiple,Zd=Ludex,Qd=Zd.Utils,eh=Qd.Signal,th=(Qd.Function,Qd.Array),nh=Zd.Events,ih=codex,ah=ih.language,oh=ih.event,rh=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});ue(rh);var lh,sh,uh,ch,dh,hh,ph,yh,vh,fh,gh,mh,bh,wh,Sh,kh,Ch,Eh,Ah,Th="localize-params-updated",Ph=(ad=jd("LocalizeParams"),od=Yd({visible:!1}),rd=Yd(Q),ad((ud=a((sd=function(){function n(){t(this,n),l(this,"_text",ud,this)}return e(n,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,se.emit(Th,{text:e,param:this})}}]),n}()).prototype,"_text",[od],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(sd.prototype,"text",[rd],Object.getOwnPropertyDescriptor(sd.prototype,"text"),sd.prototype),ld=sd))||ld),Lh=(cd=jd("Localize"),dd=Xd(!0),hd=Yd({visible:!1}),pd=Yd({type:Q,visible:function(){return this.l10nType===rh.Texture}}),yd=Yd({visible:!1}),vd=Yd({type:pe(rh)}),fd=Yd({type:ke,visible:function(){return this.l10nType===rh.Text}}),gd=Yd({visible:function(){return this.l10nType===rh.Text}}),md=Yd({type:[Ph],visible:function(){return this.l10nType===rh.Text}}),bd=Yd({type:he,visible:function(){return this.l10nType===rh.Texture}}),wd=Yd({visible:function(){return this.l10nType===rh.Texture}}),Sd=Yd({visible:!1}),kd=Yd({type:Q}),Cd=Yn.onlyRunInLifeCycleAsync,Ed=Yn.onlyRunInLifeCycleAsync,Ad=Yn.onlyRunInLifeCycleAsync,Td=Yn.onlyRunInLifeCycleAsync,Pd=Yn.onlyRunInLifeCycle,Ld=Yn.onlyRunInLifeCycleAsync,Od=Yn.onlyRunInLifeCycleAsync,Id=Yn.onlyRunInLifeCycleAsync,Rd=Yn.onlyRunInLifeCycleAsync,_d=Yn.onlyRunInLifeCycle,Dd=Yn.onlyRunInLifeCycleAsync,cd(Nd=Jd(Nd=dd((Fd=a((Md=function(a){n(C,a);var u,c,d,h,p,v,f,g,m,b,w,S,k=i(C);function C(){var e;t(this,C);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=k.call.apply(k,[this].concat(i))).localized=!1,l(e,"_defaultLocale",Fd,s(e)),l(e,"_l10nType",Bd,s(e)),l(e,"label",xd,s(e)),l(e,"updateFont",zd,s(e)),l(e,"params",Ud,s(e)),l(e,"sprite",Gd,s(e)),l(e,"packable",Hd,s(e)),l(e,"_key",qd,s(e)),e.updateSignalController=new eh.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;th.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return e(C,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return th.has(O,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(O.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===rh.Texture&&(this.label=void 0,this.params=[]),e===rh.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new Ph);for(var t=0,n=this.params.length;t<n;t++){var i,a=this.params[t];a.text=null!==(i=e[t])&&void 0!==i?i:a.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once(y.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===rh.Text&&ah.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===rh.Texture&&ah.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){oh.on(nh.LANGUAGE_CHANGED,this.updateLocalization),se.on(Th,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){oh.off(nh.LANGUAGE_CHANGED,this.updateLocalization),se.off(Th,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(S=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.enabledInHierarchy&&void 0!==this.key){var t=this.updateSignalController.renew();try{if(this.localized=!1,this.isTextKey(this.key))yield this.updateTextLocalization(this.key,t);else{if(!this.isTextureKey(this.key))throw new Error("Key ".concat(this.key," not found in locales"));var n=ah.getCurrentLocale(),i=!I&&e&&n===this.defaultLocale;i||(yield this.updateTextureLocalization(this.key,t))}if(t.aborted)return;this.localized=!0,se.emit(y.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit(y.LOCALIZE_APPLIED,{localize:this,key:this.key})}catch(e){console.warn(e)}}})),function(){return S.apply(this,arguments)})},{key:"updateTextLocalization",value:(w=o((function*(e,t){var n,i,a=this,o=ah.getCurrentLocale(),r=ah.getText(e,this.params.map((function(e){return e.text})),o),l=this.label;if(void 0===l)throw new Error("Text localize component <".concat(this.node.name,"> has no label"));null===(n=t.wrap((function(){return a.setText(l,r)})))||void 0===n||n(),this.updateFont&&(yield null===(i=t.wrap((function(){return a.setTextFont(l,o,t)})))||void 0===i?void 0:i())})),function(e,t){return w.apply(this,arguments)})},{key:"setText",value:(b=o((function*(e,t){e.string=t})),function(e,t){return b.apply(this,arguments)})},{key:"setTextFont",value:(m=o((function*(e,t,n){yield this.setTextFontRuntime(e,t,n)})),function(e,t,n){return m.apply(this,arguments)})},{key:"setTextFontRuntime",value:(g=o((function*(e,t,n){var i=yield r.loadFontAsync(t);n.aborted||null!==i&&this.setLabelFontInLifeCycle(e,i)})),function(e,t,n){return g.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(f=o((function*(e,t,n){var i,a,o=this,r=yield this.requestFontUuid(t);if(null!==r){var l=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==l){var s=th.searchIndex(l.__comps__,(function(e){return"cc.Label"===e.type})),u="__comps__.".concat(s,".font");yield null===(a=n.wrap((function(){return o.requestUpdateLabelFont(e.node.uuid,u,r)})))||void 0===a?void 0:a()}}})),function(e,t,n){return f.apply(this,arguments)})},{key:"requestFontUuid",value:(v=o((function*(e){return yield Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(R[e]))})),function(e){return v.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(p=o((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.Font",value:{uuid:n}}})})),function(e,t,n){return p.apply(this,arguments)})},{key:"updateTextureLocalization",value:(h=o((function*(e,t){if(void 0===this.sprite)throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));var n=ah.getTexture(e);yield this.setSpriteRuntime(this.sprite,n,t)})),function(e,t){return h.apply(this,arguments)})},{key:"setSpriteRuntime",value:(d=o((function*(e,t,n){var i=yield r.loadSpriteFrameAsync("".concat(t,"/spriteFrame"),this.packable);n.aborted||(null!==i?this.setSprite(e,i):console.warn("Sprite not found by path: ".concat(t)))})),function(e,t,n){return d.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(c=o((function*(e,t,n){var i,a,o=this,r=yield this.requestSpriteFrameInfo(t);if(0!==r.length)if(r.length>1){var l=r.slice(0,5).map((function(e){return e.path})),s="".concat(l.join(",")).concat(l.length<r.length?"...":"");console.warn("Ambiguous sprite's path: ".concat(t,". Found ").concat(s))}else{var u=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==u){var c=r[0].uuid,d=th.searchIndex(u.__comps__,(function(e){return"cc.Sprite"===e.type})),h="__comps__.".concat(d,".spriteFrame");yield null===(a=n.wrap((function(){return o.requestUpdateSpriteSpriteFrame(e.node.uuid,h,c)})))||void 0===a?void 0:a()}}else console.error("Sprite not found by path: ".concat(t))})),function(e,t,n){return c.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(u=o((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.SpriteFrame",value:{uuid:n}}})})),function(e,t,n){return u.apply(this,arguments)})}]),C}(te)).prototype,"_defaultLocale",[hd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),a(Md.prototype,"defaultLocale",[pd],Object.getOwnPropertyDescriptor(Md.prototype,"defaultLocale"),Md.prototype),Bd=a(Md.prototype,"_l10nType",[yd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return rh.Text}}),a(Md.prototype,"l10nType",[vd],Object.getOwnPropertyDescriptor(Md.prototype,"l10nType"),Md.prototype),xd=a(Md.prototype,"label",[fd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zd=a(Md.prototype,"updateFont",[gd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ud=a(Md.prototype,"params",[md],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Gd=a(Md.prototype,"sprite",[bd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hd=a(Md.prototype,"packable",[wd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qd=a(Md.prototype,"_key",[Sd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Md.prototype,"key",[kd],Object.getOwnPropertyDescriptor(Md.prototype,"key"),Md.prototype),a(Md.prototype,"updateTextLocalization",[Cd],Object.getOwnPropertyDescriptor(Md.prototype,"updateTextLocalization"),Md.prototype),a(Md.prototype,"setText",[Ed],Object.getOwnPropertyDescriptor(Md.prototype,"setText"),Md.prototype),a(Md.prototype,"setTextFont",[Ad],Object.getOwnPropertyDescriptor(Md.prototype,"setTextFont"),Md.prototype),a(Md.prototype,"setTextFontRuntime",[Td],Object.getOwnPropertyDescriptor(Md.prototype,"setTextFontRuntime"),Md.prototype),a(Md.prototype,"setLabelFontInLifeCycle",[Pd],Object.getOwnPropertyDescriptor(Md.prototype,"setLabelFontInLifeCycle"),Md.prototype),a(Md.prototype,"setTextFontEditor",[Ld],Object.getOwnPropertyDescriptor(Md.prototype,"setTextFontEditor"),Md.prototype),a(Md.prototype,"requestUpdateLabelFont",[Od],Object.getOwnPropertyDescriptor(Md.prototype,"requestUpdateLabelFont"),Md.prototype),a(Md.prototype,"updateTextureLocalization",[Id],Object.getOwnPropertyDescriptor(Md.prototype,"updateTextureLocalization"),Md.prototype),a(Md.prototype,"setSpriteRuntime",[Rd],Object.getOwnPropertyDescriptor(Md.prototype,"setSpriteRuntime"),Md.prototype),a(Md.prototype,"setSprite",[_d],Object.getOwnPropertyDescriptor(Md.prototype,"setSprite"),Md.prototype),a(Md.prototype,"setSpriteEditor",[Dd],Object.getOwnPropertyDescriptor(Md.prototype,"setSpriteEditor"),Md.prototype),Nd=Md))||Nd)||Nd)||Nd);X._RF.pop(),X._RF.push({},"060a722v8VBE68QPm8fKcyQ","LocalizePreloader",void 0);var Oh,Ih,Rh,_h,Dh,Nh,Mh,Fh,Bh,xh,zh,Uh,Gh,Hh,qh,Vh,$h=Z.ccclass,Wh=Z.property,Kh=Ludex.Utils,jh=Kh.Array,Yh=Kh.Valid,Xh=codex.language,Jh=(lh=$h("LocalizeTextureKey"),sh=Wh({visible:!1}),uh=Wh(Q),lh((hh=a((dh=function(){function n(){t(this,n),l(this,"_key",hh,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){Xh.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),n}()).prototype,"_key",[sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(dh.prototype,"key",[uh],Object.getOwnPropertyDescriptor(dh.prototype,"key"),dh.prototype),ch=dh))||ch),Zh=(ph=$h("SupportedLocaleKey"),yh=Wh({visible:!1}),vh=Wh(Q),ph((mh=a((gh=function(){function n(){t(this,n),l(this,"_key",mh,this)}return e(n,[{key:"key",get:function(){return this._key},set:function(e){jh.has(O,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(O.join(", ")))}}]),n}()).prototype,"_key",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a(gh.prototype,"key",[vh],Object.getOwnPropertyDescriptor(gh.prototype,"key"),gh.prototype),fh=gh))||fh);bh=$h("LocalizePreloader"),wh=Wh([Jh]),Sh=Wh({type:Zh,tooltip:"Preload only for these locales"}),bh((Eh=a((Ch=function(a){n(u,a);var o=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"keys",Eh,s(e)),l(e,"locales",Ah,s(e)),e}return e(u,[{key:"__preload",value:function(){this.preloadTextures()}},{key:"preloadTextures",value:function(){var e=Xh.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(jh.has(t,e)){var n,i=[],a=c(this.keys);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!1!==Xh.hasTextureKey(o.key)){var l=Xh.getTexture(o.key),s="".concat(l,"/spriteFrame");i.push(s)}}}catch(e){a.e(e)}finally{a.f()}r.loadSpriteFramesAsync(i)}else Yh.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),u}(te)).prototype,"keys",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ah=a(Ch.prototype,"locales",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kh=Ch));X._RF.pop(),X._RF.push({},"3f364xnTJtDR5yeow2MWHhm","LocalizedLayout",void 0);var Qh,ep,tp,np,ip,ap,op,rp,lp,sp=Z.ccclass,up=Z.property,cp=Z.executeInEditMode,dp=Z.disallowMultiple,hp=Z.requireComponent;Oh=sp("LocalizedLayout"),Ih=cp(!0),Rh=hp(ne),_h=up(Lh),Dh=Yn.required(),Nh=up(ne),Mh=up({visible:!1}),Fh=up({visible:!1}),Bh=up({type:ae,group:"Padding"}),xh=up({type:ae,group:"Padding"}),Oh(zh=dp(zh=Ih(zh=Rh((Gh=a((Uh=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"label",Gh,s(e)),l(e,"layout",Hh,s(e)),l(e,"_horizontal",qh,s(e)),l(e,"_vertical",Vh,s(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(ne))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,a=e.node.getComponentsInChildren(oe),o=c(a);try{for(o.s();!(i=o.n()).done;){i.value.updateAlignment()}}catch(e){o.e(e)}finally{o.f()}}}},e}return e(r,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(ne),Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on(y.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off(y.LOCALIZE_APPLIED,this.updateContentSize)}}]),r}(te)).prototype,"label",[_h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hh=a(Uh.prototype,"layout",[Dh,Nh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qh=a(Uh.prototype,"_horizontal",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Vh=a(Uh.prototype,"_vertical",[Fh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(Uh.prototype,"horizontal",[Bh],Object.getOwnPropertyDescriptor(Uh.prototype,"horizontal"),Uh.prototype),a(Uh.prototype,"vertical",[xh],Object.getOwnPropertyDescriptor(Uh.prototype,"vertical"),Uh.prototype),zh=Uh))||zh)||zh)||zh);X._RF.pop(),X._RF.push({},"aef305TaZhKVo1f4/qH1kf+","SecondOrderDynamics",void 0);var pp,yp,vp,fp,gp,mp,bp,wp,Sp,kp=Z.ccclass,Cp=Z.property,Ep=function(){function n(e,i){t(this,n);var a=null!=i?i:{response:1,dampen:1,eager:1};this.k1=n.calcK1(a),this.k2=n.calcK2(a),this.k3=n.calcK3(a),this.xp=e.clone(),this.y=e.clone(),this.yd=new De(0,0)}return e(n,[{key:"update",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n;null===i&&(i=new De((t.x-this.xp.x)/e,(t.y-this.xp.y)/e),this.xp.x=t.x,this.xp.y=t.y);var a=Math.max(this.k2,e*e/2+e*this.k1/2,e*this.k1);return this.y.x=this.y.x+e*this.yd.x,this.y.y=this.y.y+e*this.yd.y,this.yd.x=this.yd.x+e*(t.x+this.k3*i.x-this.y.x-this.k1*this.yd.x)/a,this.yd.y=this.yd.y+e*(t.y+this.k3*i.y-this.y.y-this.k1*this.yd.y)/a,this.y}},{key:"setDynamics",value:function(e){this.k1=n.calcK1(e),this.k2=n.calcK2(e),this.k3=n.calcK3(e)}},{key:"reset",value:function(e){this.xp.set(e.x,e.y),this.y.set(e.x,e.y),this.yd.set(0,0)}},{key:"currentState",get:function(){return this.y}}],[{key:"calcK1",value:function(e){return e.dampen/(Math.PI*e.response)}},{key:"calcK2",value:function(e){return 1/(2*Math.PI*e.response*(2*Math.PI*e.response))}},{key:"calcK3",value:function(e){return e.eager*e.dampen/(2*Math.PI*e.response)}}]),n}(),Ap=(Qh=kp("SODConfig"),ep=Cp({type:ae,displayName:"Responsiveness",tooltip:"Higher values will result shorter response times."}),tp=Cp({type:ae,displayName:"Dampening",tooltip:"Higher values will result in less overshoot and oscillation."}),np=Cp({type:ae,displayName:"Eagerness",tooltip:"Higher values will result in more overshoot and oscillation, negative values will result in anticipation."}),Qh((op=a((ap=e((function e(){t(this,e),l(this,"response",op,this),l(this,"dampen",rp,this),l(this,"eager",lp,this)}))).prototype,"response",[ep],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),rp=a(ap.prototype,"dampen",[tp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),lp=a(ap.prototype,"eager",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ip=ap))||ip);X._RF.pop(),X._RF.push({},"e9e74FEHyRLvar32WZD/F11","Trail",void 0);var Tp,Pp,Lp,Op,Ip,Rp,_p,Dp,Np,Mp,Fp,Bp,xp,zp,Up,Gp,Hp,qp,Vp,$p,Wp,Kp,jp,Yp,Xp,Jp,Zp,Qp,ey=Z.ccclass,ty=Z.property,ny=(pp=ey("Trail"),yp=ty({type:me,displayName:"Target"}),vp=ty({type:Ee,displayName:"Graphics"}),fp=ty({type:[Ap],displayName:"Trail Nodes"}),pp((bp=a((mp=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"target",bp,s(e)),l(e,"graphics",wp,s(e)),l(e,"trailNodes",Sp,s(e)),e.trailNodeInstances=[],e}return e(r,[{key:"reset",value:function(){var e,t=c(this.trailNodeInstances);try{for(t.s();!(e=t.n()).done;){e.value.reset(new De(this.node.worldPosition.x,this.node.worldPosition.y))}}catch(e){t.e(e)}finally{t.f()}this.graphics.clear()}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.spawnTrailNodes()}},{key:"update",value:function(e){this.graphics.clear();var t=this.trailNodeInstances[0];this.drawTrail(e,t,this.target.worldPosition.x,this.target.worldPosition.y);for(var n=1;n<this.trailNodeInstances.length;n++){var i=this.trailNodeInstances[n-1],a=this.trailNodeInstances[n];this.drawTrail(e,a,i.currentState.x,i.currentState.y)}}},{key:"drawTrail",value:function(e,t,n,i){var a=this.graphics;if(this.target.activeInHierarchy){var o=new De(n,i),r=t.update(e,o),l=new be(o.x,o.y,0),s=new be(r.x,r.y,0);a.node.inverseTransformPoint(l,l),a.node.inverseTransformPoint(s,s),a.moveTo(l.x,l.y),a.lineTo(s.x,s.y),a.stroke()}}},{key:"spawnTrailNodes",value:function(){var e,t=c(this.trailNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=new De(this.node.worldPosition.x,this.node.worldPosition.y),a=new Ep(i,n);this.trailNodeInstances.push(a)}}catch(e){t.e(e)}finally{t.f()}}},{key:"validateRequiredComponents",value:function(){if(!this.target)throw new Error("Target is not set");if(!this.graphics)throw new Error("Graphics is not set");0===this.trailNodes.length&&console.warn("No trail nodes are set")}}]),r}(te)).prototype,"target",[yp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wp=a(mp.prototype,"graphics",[vp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sp=a(mp.prototype,"trailNodes",[fp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gp=mp))||gp);X._RF.pop(),X._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var iy,ay,oy,ry,ly,sy,uy,cy,dy,hy,py,yy,vy,fy,gy,my,by,wy,Sy,ky,Cy=Z.ccclass,Ey=Z.executionOrder,Ay=Z.property,Ty=Ludex.Utils,Py=Ty.Decorator,Ly=Ty.Array,Oy="Batch By Name",Iy="Batch Label",Ry="Batch Sprite";Tp=Cy("BatchNodes"),Pp=Ey(99999),Lp=Ay({group:{name:Oy}}),Op=Ay({type:[ie],group:{name:Oy}}),Ip=Ay({type:[Q],group:{name:Oy}}),Rp=Ay({group:{name:Iy}}),_p=Ay({group:{name:Iy}}),Dp=Ay({group:{name:Iy}}),Np=Ay({group:{name:Ry}}),Mp=Ay({group:{name:Ry}}),Fp=Ay({readonly:!0}),Bp=Ay({readonly:!0}),xp=Ay({readonly:!0}),zp=Py.debounce(1e3),Tp(Up=Pp((Hp=a((Gp=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"batchByName",Hp,s(e)),l(e,"depthNames",qp,s(e)),l(e,"listName",Vp,s(e)),l(e,"batchLabel",$p,s(e)),l(e,"depthLabel",Wp,s(e)),l(e,"typeLabel",Kp,s(e)),l(e,"batchSprite",jp,s(e)),l(e,"depthSprite",Yp,s(e)),l(e,"batchAllNodes",Xp,s(e)),l(e,"batchDepth",Jp,s(e)),l(e,"checkOverlap",Zp,s(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,l(e,"handleNodeChange",Qp,s(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return e(r,[{key:"__preload",value:function(){this.enabled&&(ee.on(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.on(Pe.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){ee.off(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.off(Pe.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(ee.on(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.on(Pe.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(me.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),ee.off(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.off(Pe.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,a=i.depthNames[t];void 0!==a?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(a):console.warn("BatchNodes: depth is undefined",e,t,a)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new me("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=c(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var a=new me(i);a.active=!0,this.batchNode[i]=a,e.addChild(a)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new me("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new me("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(A(this.labelChildren),A(this.spriteChildren)),n=this.nameChildren,i=c(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.parent&&(this.handleActiveChange(a.node),this.originalParents[a.uuid]=a.node.parent)}}catch(e){i.e(e)}finally{i.f()}var o,r=c(n);try{for(r.s();!(o=r.n()).done;){var l=o.value;l.parent&&(this.handleActiveChange(l),this.originalParents[l.uuid]=l.parent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=c(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.saveLabelChildren(a),this.saveSpriteChildren(a),this.saveNodeChildrenByName(a),this.saveNodeChildrenByType(a)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(ke),i={none:ke.CacheMode.NONE,char:ke.CacheMode.CHAR,bitmap:ke.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,A(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(he);0!==n.length&&(t=this.spriteChildren).push.apply(t,A(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=c(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;Ly.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(te);if((t=this.allChildren).push.apply(t,A(i)),!(this.batchDepth<1||n>=this.batchDepth)){var a,o=c(this.allChildren);try{for(o.s();!(a=o.n()).done;){var r=a.value;this.saveNodeChildrenByType(r.node,this.batchDepth)}}catch(e){o.e(e)}finally{o.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=Ne.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=c(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var a,o=c(this.spriteChildren);try{for(o.s();!(a=o.n()).done;){t(a.value,this.batchNode.sprite)}}catch(e){o.e(e)}finally{o.f()}var r,l=c(this.allChildren);try{for(l.s();!(r=l.n()).done;){t(r.value,this.batchNode.node)}}catch(e){l.e(e)}finally{l.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var s,u=c(this.nameChildren);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(d.isValid&&d.activeInHierarchy&&d.isTransformDirty()){var h=d.getComponent(de);if(!(h&&h.opacity<1||Ly.has(n,d.name))){var p=this.batchNode[d.name];p&&(d.isChildOf(p)||(d.setParent(p,!0),d.layer=Ne.Enum.UI_2D))}}}}catch(e){u.e(e)}finally{u.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(A(this.labelChildren),A(this.spriteChildren));if(e.length>0){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.originalParents[i.uuid];a&&(i.node.isChildOf(a)||i.node.setParent(a,!0))}}catch(e){n.e(e)}finally{n.f()}}var o,r=c(this.nameChildren);try{for(r.s();!(o=r.n()).done;){var l=o.value,s=this.originalParents[l.uuid];s&&(l.isChildOf(s)||l.setParent(s,!0))}}catch(e){r.e(e)}finally{r.f()}}}]),r}(te)).prototype,"batchByName",[Lp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qp=a(Gp.prototype,"depthNames",[Op],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vp=a(Gp.prototype,"listName",[Ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$p=a(Gp.prototype,"batchLabel",[Rp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wp=a(Gp.prototype,"depthLabel",[_p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Kp=a(Gp.prototype,"typeLabel",[Dp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),jp=a(Gp.prototype,"batchSprite",[Np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Yp=a(Gp.prototype,"depthSprite",[Mp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xp=a(Gp.prototype,"batchAllNodes",[Fp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Jp=a(Gp.prototype,"batchDepth",[Bp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Zp=a(Gp.prototype,"checkOverlap",[xp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qp=a(Gp.prototype,"handleNodeChange",[zp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),Up=Gp))||Up);X._RF.pop(),X._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var _y,Dy=Z.ccclass,Ny=Z.executionOrder,My=Z.property,Fy=Ludex.Utils,By=Fy.Array,xy=Fy.Object;iy=Dy("BatchNodesV2"),ay=Ny(99999),oy=My({group:"Batch Settings"}),ry=My({type:[Q],group:"Batch Settings",visible:function(){return this.batchByName}}),ly=My({type:[ie],group:"Batch Settings",visible:function(){return this.batchByName}}),sy=My({group:"Label Settings"}),uy=My({group:"Label Settings",visible:function(){return this.batchLabel}}),cy=My({group:"Label Settings",visible:function(){return this.batchLabel}}),dy=My({group:"Sprite Settings"}),hy=My({group:"Sprite Settings",visible:function(){return this.batchSprite}}),iy(py=ay((vy=a((yy=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"batchByName",vy,s(e)),l(e,"listName",fy,s(e)),l(e,"depthNames",gy,s(e)),l(e,"batchLabel",my,s(e)),l(e,"typeLabel",by,s(e)),l(e,"depthLabel",wy,s(e)),l(e,"batchSprite",Sy,s(e)),l(e,"depthSprite",ky,s(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return e(r,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(ke);t&&("all"===this.typeLabel?t.cacheMode===ke.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===ke.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(he)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:ke.CacheMode.NONE,char:ke.CacheMode.CHAR,bitmap:ke.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,a={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(a)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var o=0;o<this.listName.length;o++){var r=this.listName[o];if(r){var l=this.depthNames[o]||0,s=this.batchNodes[r];s&&s.setSiblingIndex(l)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=Ne.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=xy.vals(this.batchNodes);return By.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],a=0;a<i.length;a++){var o=i[a];o&&t(o)}else for(var r=0;r<this.labelNodes.length;r++){var l=this.labelNodes[r];l&&t(l)}if(this.batchSprite)for(var s=0;s<this.spriteNodes.length;s++){var u=this.spriteNodes[s];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var d=this.namedNodes[c];if(d)for(var h=0;h<d.length;h++){var p=d[h];p&&t(p)}}}},{key:"setupEventListeners",value:function(){ee.on(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.on(Pe.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){ee.off(Pe.EVENT_AFTER_UPDATE,this.onAfterUpdate),ee.off(Pe.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new me("BatchLabel_".concat(n));i.layer=Ne.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var a=new me("BatchLabel");a.layer=Ne.Enum.UI_2D,this.node.addChild(a),this.batchNodes.label=a}if(this.batchSprite){var o=new me("BatchSprite");o.layer=Ne.Enum.UI_2D,this.node.addChild(o),this.batchNodes.sprite=o}if(this.batchByName)for(var r=0;r<this.listName.length;r++){var l=this.listName[r];if(l){var s=new me("Batch_".concat(l));s.layer=Ne.Enum.UI_2D,this.node.addChild(s),this.batchNodes[l]=s,this.namedNodes[l]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),r}(te)).prototype,"batchByName",[oy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fy=a(yy.prototype,"listName",[ry],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gy=a(yy.prototype,"depthNames",[ly],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),my=a(yy.prototype,"batchLabel",[sy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),by=a(yy.prototype,"typeLabel",[uy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),wy=a(yy.prototype,"depthLabel",[cy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Sy=a(yy.prototype,"batchSprite",[dy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ky=a(yy.prototype,"depthSprite",[hy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),py=yy))||py);X._RF.pop(),X._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var zy,Uy=Z.ccclass,Gy=Ludex.Utils.Browser,Hy=codex.player,qy=Uy("Vibrate")(_y=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!Gy.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!Hy.getPlayerSetting("vibrate")}}]),r}(te))||_y;X._RF.pop(),X._RF.push({},"21fbd1aIo9DNoKfAoZaF1DC","WidgetCanvasTarget",void 0);var Vy;(0,Z.ccclass)("WidgetCanvasTarget")(zy=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){var e=this.getComponent(oe);if(e){var t=Me("Canvas");t&&(e.target=t)}}}]),r}(te));X._RF.pop(),X._RF.push({},"62927KYr+tCcIzOaPtVc/q8","CoinData",void 0);var $y=10,Wy=20,Ky=100,jy=(E(Vy={},_.HINT,80),E(Vy,_.THUNDER,200),E(Vy,_.STORM,150),E(Vy,_.PLIERS,150),Vy),Yy=2e3,Xy=300;X._RF.pop(),X._RF.push({},"8328a20Ku5GF4anma0sBaxm","DailyRewardsData",void 0);var Jy={0:{id:1,type:"coin",value:20},1:{id:2,type:"coin",value:30},2:{id:3,type:"coin",value:50},3:{id:4,type:"coin",value:100},4:{id:5,type:"coin",value:150},5:{id:6,type:"coin",value:200},6:{id:7,type:"coin",value:250,items:{hint:3,thunder:3,storm:3,pliers:3}}};X._RF.pop(),X._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Zy,Qy,ev,tv,nv=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(nv||{}),iv={Events:nv,UNLOCK_SEQUENCE:"101013012031"};X._RF.pop(),X._RF.push({},"52b52FNwvhBKY/becAy420o","Leaderboard",void 0);var av=Ludex.Configs.Leaderboards.LeaderboardList,ov={DAILY:null!==(Zy=null===(Qy=av[0])||void 0===Qy?void 0:Qy.Id)&&void 0!==Zy?Zy:"daily-leaderboard-id",WEEKLY:null!==(ev=null===(tv=av[1])||void 0===tv?void 0:tv.Id)&&void 0!==ev?ev:"weekly-leaderboard-id"},rv="daily",lv="weekly";X._RF.pop(),X._RF.push({},"f16ffbXQPtDK58g6BNFwzJv","Tournament",void 0);var sv=function(e){return e.RELOAD_TOURNAMENT="reload-tournament",e}(sv||{});X._RF.pop(),X._RF.push({},"7e0c9Khhb1DD7wE1NBWi3Py","VibrateStyle",void 0),X._RF.pop(),X._RF.push({},"ad7acMQ2iJNKKA2RkT+nGNI","CommonError",void 0);var uv=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,n)).code=e,i}return e(r)}(g(Error));X._RF.pop(),X._RF.push({},"5ff78u05/tPepABfMzNaOjM","PlayerHasTournamentError",void 0);var cv=function(a){n(r,a);var o=i(r);function r(e,n){var i;return t(this,r),(i=o.call(this,"PLAYER_HAS_TOURNAMENT","Player has a tournament")).playerId=e,i.tournamentId=n,i}return e(r)}(uv);X._RF.pop(),X._RF.push({},"e14dbcdc89LQJIggfi5qO6U","MapData",void 0);var dv={mapOrder:[{id:1,theme:"summer",skins:["fruit"],levelCount:10},{id:2,theme:"autumn",skins:["flower"],levelCount:10},{id:3,theme:"winter",skins:["tool"],levelCount:10},{id:4,theme:"summer",skins:["sport"],levelCount:10},{id:5,theme:"autumn",skins:["cosmetics"],levelCount:10},{id:6,theme:"winter",skins:["ice-cream"],levelCount:10},{id:7,theme:"summer",skins:["cakes"],levelCount:10},{id:8,theme:"happy-new-year",skins:["cosmetics","car"],levelCount:10},{id:9,theme:"spring-festival",skins:["flower","ice-cream"],levelCount:10},{id:10,theme:"tree-planting-festival",skins:["fruit","flower","tool"],levelCount:10},{id:11,theme:"blue-sea-festival",skins:["sport","ice-cream"],levelCount:10},{id:12,theme:"music-festival",skins:["cakes","cosmetics"],levelCount:10},{id:13,theme:"harvest-festival",skins:["fruit","flower","tool"],levelCount:10},{id:14,theme:"food-festival",skins:["cakes","ice-cream","flower"],levelCount:10},{id:15,theme:"snow-festival",skins:["ice-cream","sport"],levelCount:10},{id:16,theme:"light-festival",skins:["flower","cakes"],levelCount:10},{id:17,theme:"peace-festival",skins:["flower","sport"],levelCount:10},{id:18,theme:"flower-festival",skins:["flower","fruit"],levelCount:10},{id:19,theme:"street-festival",skins:["car","ice-cream","sport"],levelCount:10},{id:20,theme:"color-garden",skins:["cakes","fruit"],levelCount:10},{id:21,theme:"color-festival",skins:["car","cosmetics","flower"],levelCount:10},{id:22,theme:"nature-summer",skins:["tool","sport"],levelCount:10},{id:23,theme:"snow-mountain",skins:["cakes","ice-cream"],levelCount:10},{id:24,theme:"ice-festival",skins:["ice-cream"],levelCount:10},{id:25,theme:"green-grass-festival",skins:["flower","fruit"],levelCount:10},{id:26,theme:"community-festival",skins:["car","cakes","cosmetics"],levelCount:10},{id:27,theme:"water-festival",skins:["sport","car"],levelCount:10},{id:28,theme:"animal-festival",skins:["flower","fruit"],levelCount:10},{id:29,theme:"lost-festival",skins:["flower"],levelCount:10},{id:30,theme:"halloween-festival",skins:["cakes","cosmetics"],levelCount:10},{id:31,theme:"snow-music-festival",skins:["ice-cream","cosmetics"],levelCount:10},{id:32,theme:"christmas",skins:["ice-cream","tool","cosmetics"],levelCount:10},{id:33,theme:"spring-flower-festival",skins:["flower","fruit"],levelCount:10},{id:34,theme:"tet-holiday",skins:["flower","cosmetics","fruit"],levelCount:10},{id:35,theme:"sea-festival",skins:["car","sport"],levelCount:10},{id:36,theme:"firework-festival",skins:["cosmetics","car","flower"],levelCount:10},{id:37,theme:"halloween-horror",skins:["cakes","cosmetics"],levelCount:10},{id:38,theme:"mid-autumn",skins:["flower","cakes"],levelCount:10},{id:39,theme:"christmas-sweet",skins:["ice-cream","cakes","sport"],levelCount:10},{id:40,theme:"new-year-countdown",skins:["cosmetics","car"],levelCount:10}]};X._RF.pop(),X._RF.push({},"6093adbLQZKpqgUpTV/sHj1","ThemeUtils",void 0);var hv=Ludex.Utils.Function,pv=codex,yv=pv.player,vv=pv.storage,fv=dv.mapOrder.map((function(e){return{skins:e.skins,themeId:e.theme,currentProgress:0,maxProgress:e.levelCount,isLocked:!0}})),gv=function(a){n(h,a);var l,s,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=d.call.apply(d,[this].concat(i))).playerSkinProgress=fv.map((function(e){return u({},e)})),e}return e(h,[{key:"initDefaultPlayerSkinProgress",value:function(){this.playerSkinProgress=fv.map((function(e){return u({},e)}))}},{key:"initDashboardSceneStorage",value:function(){var e=vv.getStorage("dashboard");if(null==e){var t=this.getCurrentMapProgressInstance();vv.addStorage("dashboard",{lastMapPayload:t,numOfMapsPassed:0,animateToCurrentLevel:!1});var n=vv.getStorage("collection");if(null==n){vv.addStorage("collection",{lastMapPack:t.id,animateMapPackUnlock:!1});var i=vv.getStorage("leaderboard_content");if(null==i){vv.addStorage("leaderboard_content",{lastTabOpened:rv,previousScore:-1});var a=vv.getStorage("tournament");null==a&&vv.addStorage("tournament",{animateTournamentLeader:!1,previousScore:-1})}}}}},{key:"getCurrentMapProgressInstance",value:function(){for(var e=void 0,t=void 0,n=0,i=0,a=0,o=0,r=dv.mapOrder.length;o<r;o++){var l=this.playerSkinProgress[o],s=dv.mapOrder[o],u=dv.mapOrder[o+1];if(l.currentProgress<l.maxProgress){var c;a=s.id,e=s.theme,t=null!==(c=null==u?void 0:u.theme)&&void 0!==c?c:e,n=l.currentProgress,i=l.maxProgress;break}}if(void 0===e||void 0===t){var d=dv.mapOrder[dv.mapOrder.length-1];return{id:a=d.id,currentTheme:e=d.theme,nextTheme:t=d.theme,progress:n=d.levelCount,max:i=d.levelCount}}return{id:a,currentTheme:e,nextTheme:t,progress:n,max:i}}},{key:"getUnlockedSkinsInstance",value:function(){var e,t=[],n=c(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!i.isLocked&&1===i.skins.length){var a=i.skins[0];a&&t.push(a)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getLevelSkinsInstance",value:function(e){var t,n=null!=e?e:1,i=0,a=c(dv.mapOrder);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(i+o.levelCount>=n)return o.skins;i+=o.levelCount}}catch(e){a.e(e)}finally{a.f()}return dv.mapOrder[dv.mapOrder.length-1].skins}},{key:"getLevelThemeInstance",value:function(e){var t,n=null!=e?e:1,i=0,a=c(dv.mapOrder);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(i+o.levelCount>=n)return o.theme;i+=o.levelCount}}catch(e){a.e(e)}finally{a.f()}return dv.mapOrder[dv.mapOrder.length-1].theme}},{key:"getThemeSkinsInstance",value:function(e){var t,n=c(dv.mapOrder);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.theme===e)return i.skins}}catch(e){n.e(e)}finally{n.f()}return[]}},{key:"getCollectionUnlockProgressInstance",value:function(){var e,t=[],n=c(this.playerSkinProgress);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push({skins:i.skins,theme:i.themeId,progress:i.currentProgress,max:i.maxProgress,isLocked:i.isLocked})}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"updatePlayerSkinProgress",value:function(){var e,t=yv.getGameData(),n=(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)-1;this.playerSkinProgress[0].isLocked=!1;for(var i=0,a=dv.mapOrder.length;i<a;i++){var o=dv.mapOrder[i];if(o&&!(n<=0)){var r=n-o.levelCount>=0?o.levelCount:n;n-=r,this.increaseProgress(i,r)}}}},{key:"increaseProgress",value:function(e,t){if(e<0||e>=this.playerSkinProgress.length)throw new Error("increaseProgress: index out of range");var n,i=this.playerSkinProgress[e],a=i.currentProgress,o=i.maxProgress,r=a+t>o?o:a+t;(r>0&&(i.isLocked=!1),r===o)&&((null===(n=dv.mapOrder[e+1])||void 0===n?void 0:n.skins)&&(this.playerSkinProgress[e+1].isLocked=!1));i.currentProgress=r,i.maxProgress=o}}],[{key:"init",value:function(){var e=this.inst;e.initDefaultPlayerSkinProgress(),e.updatePlayerSkinProgress(),e.initDashboardSceneStorage()}},{key:"getCurrentMapProgress",value:function(){return this.inst.getCurrentMapProgressInstance()}},{key:"getUnlockedSkins",value:function(){return this.inst.getUnlockedSkinsInstance()}},{key:"getLevelSkins",value:function(e){return this.inst.getLevelSkinsInstance(e)}},{key:"getLevelTheme",value:function(e){return this.inst.getLevelThemeInstance(e)}},{key:"getThemeSkins",value:function(e){return this.inst.getThemeSkinsInstance(e)}},{key:"getCollectionUnlockProgress",value:function(){return this.inst.getCollectionUnlockProgressInstance()}},{key:"getCurrentUnlockingThemeIndex",value:function(){var e=this.getCollectionUnlockProgress();if(0===e.length)return null;var t=0;return e.forEach((function(e,n){e.isLocked||(t=n)})),t}},{key:"preloadLevelSpriteFrames",value:function(e){var t=this.getLevelSkins(e);this.preloadSkinsFrames(t)}},{key:"preloadSkinsFrames",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.preloadSkinFrames(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"preloadSkinFrames",value:function(e){var t="".concat(D.TILE_SKIN_FOLDER,"/").concat(e);r.loadSpriteFramesDirAsync(t)}},{key:"loadLevelSpriteFrames",value:(s=o((function*(e,t,n){var i=hv.rng({generate:function(e,t,n){return Fe(e,t,n)},generateSeed:function(e){return Fe(e,0,1e6)},seed:null!=n?n:Date.now()});if(void 0!==t&&0===i(0,2)){var a=this.getThemeSkins(t),o=a[i(0,a.length)];return yield this.loadSkinFrames(o)}if(0===i(0,2)){var r=this.getUnlockedSkins();if(r.length>1){var l=r[i(0,r.length)];return yield this.loadSkinFrames(l)}}var s=this.getLevelSkins(e);if(0===s.length)throw new Error("No skins found for level ".concat(e));var u=yield this.loadSkinsFrames(s);return u[i(0,u.length)]})),function(e,t,n){return s.apply(this,arguments)})},{key:"loadSkinFrames",value:function(e){var t="".concat(D.TILE_SKIN_FOLDER,"/").concat(e);return r.loadSpriteFramesDirAsync(t)}},{key:"loadSkinsFrames",value:(l=o((function*(e){var t=e.map(this.loadSkinFrames),n=yield hv.allSettled(t),i=hv.unwrapAllSettled(n),a=i.successes,o=i.failures;if(o.length>0)throw new Error("Failed to load skins frames: ".concat(o.join(", ")));return a})),function(e){return l.apply(this,arguments)})}]),h}(function(){function n(){t(this,n)}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}}]),n}());X._RF.pop(),X._RF.push({},"0397cr2IpZEwbRzwQhlVHMO","MatchUtils",void 0);var mv=codex,bv=mv.match,wv=mv.player,Sv=mv.leaderboard,kv=Ludex,Cv=kv.Utils,Ev=Cv.Object,Av=Cv.Valid,Tv=Cv.String,Pv=Cv.Array,Lv=kv.Match.Modes,Ov=["Champion","Ultimate","Grand","Elite","Master's","Premier","Epic","Pro's","Supreme","Legendary","Victory","Prime","Titan's","Hero's","Star's"],Iv=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"createTournamentPayload",value:function(){return d(h(r.prototype),"createTournamentPayload",this).call(this)}}]),r}(function(){function n(){var e=this;t(this,n),this.processStartSingleModeAsync$=o((function*(){var e=wv.getPlayerId();return bv.single.start.processAsync({playerId:e})})),this.processFinishSingleModeAsync$=o((function*(){return bv.single.finish.processAsync()})),this.processStartTournamentModeAsync$=o((function*(){var e=wv.getPlayerId(),t=GameSDK.context.getID();return bv.tournament.continue.processAsync({playerId:e,contextId:t})})),this.processFinishTournamentModeAsync$=o((function*(){var e=wv.getPlayerId(),t=wv.getBestScore();return bv.tournament.finish.processAsync({playerId:e,bestScore:t})})),this.processStartChallengeModeAsync$=o((function*(){try{return e.processContinueChallengeAsync$()}catch(t){if(!Ev.hasOwn(t,"name")||Av.isString(t.name))throw t;if("PlayerHasFinishedMatch"===t.name)return e.processChallengeNewOpponentAsync$();if("PlayerNotJoinInMatch"===t.name)return e.processJoinChallengeAsync$()}})),this.processFinishChallengeModeAsync$=function(){var e=o((function*(e){return bv.challenge.finish.processAsync(e)}));return function(t){return e.apply(this,arguments)}}(),this.processContinueChallengeAsync$=o((function*(){var t=e.getMatchState$(),n=t.id,i=t.customData,a=i.playerId,o=i.opponentId;if(!Av.isString(n))throw new Error("Invalid match id");if(!Av.isString(a))throw new Error("Invalid player id");if(!Av.isString(o))throw new Error("Invalid opponent id");var r=GameSDK.context.getID();if(!r)throw new Error("Cannot get contextId");return bv.challenge.continue.processAsync({matchId:n,contextId:r,playerId:a,opponentId:o})})),this.processChallengeNewOpponentAsync$=o((function*(){var e=wv.getConnectedPlayerIds(100,0),t=Math.floor(Math.random()*e.length),n=wv.getPlayerId(),i=e[t];if(!Av.isString(i)||Av.isEmpty(i))throw new Error("Invalid opponent id");return bv.challenge.friend.processAsync({playerId:n,opponentId:i})})),this.processJoinChallengeAsync$=o((function*(){var t=e.getMatchState$(),n=t.id,i=t.customData,a=i.playerId,o=i.opponentId;if(!Av.isString(n))throw new Error("Invalid match id");if(!Av.isString(a))throw new Error("Invalid player id");if(!Av.isString(o))throw new Error("Invalid opponent id");return bv.challenge.join.processAsync({matchId:n,playerId:a,opponentId:o})})),this.processStartGameModeAsync$=function(){var e=o((function*(e){var t=wv.getPlayerId();return bv.strategy.start.processAsync({matchId:"123456",gameMode:e,playerId:t})}));return function(t){return e.apply(this,arguments)}}(),this.processFinishGameModeAsync$=o((function*(){return bv.strategy.finish.processAsync({postGlobalLeaderboard:!0,setPlayerBestScore:!0})})),this.getMatchState$=function(){var e=bv.getMatchState();if(!e)throw new Error("Match state not found");return e},this.createTournamentName=function(){var e=Ov[Ie.randomRangeInt(0,Ov.length-1)],t="".concat(e," Tournament"),n=Tv.removeDiacritics(t);return"".concat(n)},this.getTournamentsAsync$=o((function*(){try{return yield GameSDK.tournament.getTournamentsAsync()}catch(e){return console.error(e),[]}}))}var i,a,r,l,s,u,c,d,h;return e(n,[{key:"createTournamentPayload",value:function(){var e,t,n,i=Tv.generateObjectId(),a=wv.getPlayerId(),o=wv.getPlayer().name,r=wv.getGameData(),l=null!==(e=null==r?void 0:r.level)&&void 0!==e?e:1,s=gv.getLevelTheme(l),u=this.getMatchState$().profiles;return{score:null!==(t=null===(n=(void 0===u?{}:u)[a])||void 0===n?void 0:n.score)&&void 0!==t?t:0,playerId:a,mode:Lv.TOURNAMENT,name:this.createTournamentName(),leaderboardId:i,payload:{playerId:a,playerName:o,leaderboardId:i,themeId:s}}}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"startMatchAsync",value:(h=o((function*(e){try{var t=null!=e?e:this.getMatchMode();switch(t){case Lv.SINGLE:yield this.inst.processStartSingleModeAsync$();break;case Lv.TOURNAMENT:yield this.inst.processStartTournamentModeAsync$();break;case Lv.CHALLENGE_FRIEND:yield this.inst.processStartChallengeModeAsync$();break;default:t?yield this.inst.processStartGameModeAsync$(t):yield this.inst.processStartSingleModeAsync$()}}catch(e){console.warn("startMatchAsync",e)}})),function(e){return h.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(d=o((function*(e){try{yield bv.handler.setProfileData(e)}catch(e){console.warn("setProfileMatchDataAsync",e)}})),function(e){return d.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(c=o((function*(e){try{yield bv.handler.setMatchCustomData(e)}catch(e){console.warn("setMatchCustomDataAsync",e)}})),function(e){return c.apply(this,arguments)})},{key:"getMatchCustomDataAsync",value:(u=o((function*(){try{yield bv.handler.getMatchCustomData()}catch(e){console.warn("getMatchCustomDataAsync",e)}})),function(){return u.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(s=o((function*(e){try{yield bv.handler.setLeaderboardScore(e)}catch(e){console.warn("setLeaderboardScoreAsync",e)}})),function(e){return s.apply(this,arguments)})},{key:"finishMatchAsync",value:(l=o((function*(e){try{var t=this.getMatchMode();switch(t){case Lv.SINGLE:yield this.inst.processFinishSingleModeAsync$();break;case Lv.TOURNAMENT:yield this.inst.processFinishTournamentModeAsync$();break;case Lv.CHALLENGE_FRIEND:yield this.inst.processFinishChallengeModeAsync$(e);break;default:t?yield this.inst.processFinishGameModeAsync$():yield this.inst.processFinishSingleModeAsync$()}}catch(e){console.warn("finishMatchAsync",e)}})),function(e){return l.apply(this,arguments)})},{key:"joinTournamentAsync",value:(r=o((function*(e){var t=wv.getPlayerId();return bv.tournament.join.processAsync({tournamentId:e,playerId:t})})),function(e){return r.apply(this,arguments)})},{key:"continueTournamentAsync",value:(a=o((function*(e){var t=wv.getPlayerId();return bv.tournament.continue.processAsync({playerId:t,contextId:e})})),function(e){return a.apply(this,arguments)})},{key:"getMatchMode",value:function(){var e=this.inst.getMatchState$();return Av.isString(e.mode)?e.mode:null}},{key:"getMatchCustomData",value:function(){var e=this.inst.getMatchState$();return Av.isObject(e.customData)?e.customData:null}},{key:"updateMatchStateAfterLevelFinish",value:function(e,t){this.setMatchCustomDataAsync({level:e,score:t});var n=wv.getPlayerId();this.setProfileMatchDataAsync({id:n,score:t})}},{key:"processCreateTournamentAsync",value:(i=o((function*(){var e=yield this.inst.getTournamentsAsync$(),t=Pv.search(e,(function(e){var t=e.getPayload(),n=JSON.parse(Av.isString(t)?t:"{}");return"DEFAULT"===e.getTournamentType()&&n.playerId===wv.getPlayerId()}));if(t)throw new cv(wv.getPlayerId(),t.getID());var n=this.inst.createTournamentPayload();wv.setGameData({lastCreateTournamentShown:Date.now()}),yield bv.tournament.create.processAsync(n);var i=n.leaderboardId;Sv.addLeaderboard({name:i,type:"tournament",autoSortRank:!0,leaderboardId:i})})),function(){return i.apply(this,arguments)})}]),n}());X._RF.pop(),X._RF.push({},"d90c4WisP9LybAFqNuS6imZ","FailKeys",void 0);var Rv="time",_v="bomb";X._RF.pop(),X._RF.push({},"43ee9veYalAU7wfruC56uJv","GameMode",void 0);var Dv,Nv="custom";X._RF.pop(),X._RF.push({},"44b50YkamZDD5fO9vdZKeG7","InputController",void 0);var Mv=(0,Z.ccclass)("InputController")(Dv=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleElementPointerDown=function(){},e.handleElementPointerUp=function(e){},e}return e(r,[{key:"onLoad",value:function(){this.listenInputEvents()}},{key:"listenInputEvents",value:function(){Te.os!==Te.OS.WINDOWS&&Te.os!==Te.OS.OSX||(document.addEventListener("pointerup",this.handleElementPointerUp),document.addEventListener("pointerdown",this.handleElementPointerDown))}},{key:"onDestroy",value:function(){Te.os!==Te.OS.WINDOWS&&Te.os!==Te.OS.OSX||(document.removeEventListener("pointerup",this.handleElementPointerUp),document.removeEventListener("pointerdown",this.handleElementPointerDown))}}]),r}(te))||Dv;X._RF.pop(),X._RF.push({},"7f144HjLfBLWbFvbRFCCt8e","Directions",void 0);var Fv={Up:{x:0,y:1},Down:{x:0,y:-1},Left:{x:-1,y:0},Right:{x:1,y:0}};X._RF.pop(),X._RF.push({},"361eckT3VBO5ZFyetePNmNY","LevelGravity",void 0);var Bv="fall-down",xv="fly-up",zv="push-left",Uv="push-right",Gv="put-columns-middle",Hv="put-rows-middle",qv=[Bv,xv,zv,Uv,Gv,Hv],Vv=[Bv,xv,Hv],$v=[zv,Uv,Gv];X._RF.pop(),X._RF.push({},"636f3vmmpVFBLNjr6WR2MSa","CustomModeUtils",void 0);var Wv=codex.player,Kv=function(){function n(){t(this,n)}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getCustomBonus",value:function(){var e=this.getCustomData(),t=e.time,n=e.difficulty,i=e.bombs,a=e.ads;return this.getTimeBonus(t)+this.getDifficultyBonus(n)+this.getBombsBonus(i)+this.getExtraAdsBonus(a)}},{key:"getCustomData",value:function(){var e,t=(null!==(e=Wv.getGameData())&&void 0!==e?e:{}).custom;return void 0===t?{time:4,difficulty:1,bombs:0,ads:!1}:t}},{key:"getTimeBonus",value:function(e){return 5*(e-4)}},{key:"getDifficultyBonus",value:function(e){return 3===e?30:20*(e-1)}},{key:"getBombsBonus",value:function(e){return 5*e}},{key:"getExtraAdsBonus",value:function(e){return e?75:0}}]),n}();X._RF.pop(),X._RF.push({},"f0eaf/DUO9MpretbO/JIGbt","CustomGameData",void 0);var jv={time:[40,30,20,10,0,-10,-20,-30,-40],difficulty:["Easy","Normal","Hard","Extreme"],bombs:[0,1,2,3,4]};X._RF.pop(),X._RF.push({},"c0656MbbYRE+KSk63rv74ZI","SkinKeys",void 0);var Yv={CAKES:"cakes",CAR:"car",COSMETIC:"cosmetics",FLOWER:"flower",FRUIT:"fruit",ICE_CREAM:"ice-cream",SPORT:"sport",TOOL:"tool"};X._RF.pop(),X._RF.push({},"5c321EpuONCAq5BAh+AQCcd","RandomizedLevelDataConfig",void 0);var Xv=5,Jv=[90,200],Zv=[6,30],Qv={bombRange:[1,8],rocketRange:[0,2]},ef={maxSpaceOfPairRange:[2,10],addRandomTilesPerMoveRange:[0,8]},tf=[5,7],nf=[6,12];X._RF.pop(),X._RF.push({},"4e7344vPB1EoI9uMkZu5Zd0","createRandomizedLevelData",void 0);var af,of,rf=function(e,t){return function(n){return n<=0?[e,t]:n>=1?[t,t]:[Math.floor(e+n*(t-e)),t]}},lf=function(e,t){var n=Math.ceil(e),i=Math.floor(t);return Math.floor(Math.random()*(i-n+1))+n},sf=function(e){return function(t){return lf.apply(void 0,A(e(t)))}},uf={generateDifficulty:(af=Xv,function(e){return af<=1?0:(e-1)%af/(af-1)}),generateTime:sf(function(e,t){var n=rf(t,e);return function(e){return n(e)}}.apply(void 0,A(Jv))),generateColors:sf(rf.apply(void 0,A(Zv))),specials:{generateBomb:sf(rf.apply(void 0,A(Qv.bombRange))),generateRocket:sf(rf.apply(void 0,A(Qv.rocketRange)))},rules:{generateMaxSpaceOfPair:sf(rf.apply(void 0,A(ef.maxSpaceOfPairRange))),generateAddRandomTilesPerMove:sf(rf.apply(void 0,A(ef.addRandomTilesPerMoveRange)))},generateColumns:sf(rf.apply(void 0,A(tf))),generateRows:sf(rf.apply(void 0,A(nf)))};X._RF.pop(),X._RF.push({},"bbe87JDGgVEkJdgCL2ydwxX","LevelManager",void 0);var cf=Z.ccclass,df=Ludex.Utils,hf=df.Json,pf=df.Array,yf=codex.monitorError,vf=Object.values(Yv),ff=[[4,6],[4,8],[5,8],[6,8],[5,10],[6,10],[7,10],[7,12]],gf=[-2,0,2,5],mf={level:1,mode:"normal",time:900,colors:12,specials:{bomb:0,rocket:0},rules:{maxSpaceOfPair:1,addRandomTilesPerMove:0},columns:5,rows:6,theme:["flower"]},bf=function(){var e={};return function(t){if(e[t])return e[t];var n=function(e){var t=uf.generateDifficulty(e),n=uf.generateColumns(t),i=uf.generateRows(t);return{rows:n%2==1&&i%2==1?i+1:i,columns:n,colors:uf.generateColors(t),gravity:Math.random()>.75?"normal":Math.random()>.5?qv[Math.floor(Math.random()*qv.length)]:[Vv[Math.floor(Math.random()*Vv.length)],$v[Math.floor(Math.random()*$v.length)]].join("-"),rules:{addRandomTilesPerMove:uf.rules.generateAddRandomTilesPerMove(t),maxSpaceOfPair:uf.rules.generateMaxSpaceOfPair(t)},specials:{bomb:uf.specials.generateBomb(t),rocket:uf.specials.generateRocket(t)},time:uf.generateTime(t)}}(t);return e[t]={level:t,theme:vf,rows:n.rows,columns:n.columns,colors:n.colors,mode:n.gravity,rules:{maxSpaceOfPair:n.rules.maxSpaceOfPair,addRandomTilesPerMove:n.rules.addRandomTilesPerMove},specials:{bomb:n.specials.bomb,rocket:n.specials.rocket},time:n.time},e[t]}},wf=cf("LevelManager")(of=function(a){n(c,a);var l,s,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=u.call.apply(u,[this].concat(i))).getRandomizedLevelData=bf(),e}return e(c,[{key:"loadLevel",value:(s=o((function*(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=yield this.loadLevelData(t);this.levelData=null!==(e=null!=n?n:this.levelData)&&void 0!==e?e:mf,null==yf||yf.addMetadata({level:t})})),function(){return s.apply(this,arguments)})},{key:"loadLevelData",value:(l=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=null;if(e>=N)t=this.getRandomizedLevelData(e);else{var n=10,i=this.paddingZero("".concat(Math.floor(e/n)+1),3),a=e%n,o=yield r.loadJsonAsync("".concat(D.LEVEL_DATA_FOLDER,"/").concat(i));if(!o)return null;if(null===o.json)return null;t=o.json[a]}if(!(t=hf.clone(t)))return null;if(Iv.getMatchMode()===Nv){var l,s,u,c=Kv.getCustomData(),d=t.time*(1+(null!==(l=jv.time[c.time])&&void 0!==l?l:0)/100),h=t.specials.bomb+(null!==(s=jv.bombs[c.bombs])&&void 0!==s?s:0),p=Math.min(t.colors+(null!==(u=gf[c.difficulty])&&void 0!==u?u:0),30),y=this.getDifficulty(t.columns,t.rows);if(void 0!==y){var v;y+=c.difficulty-1;var f=null!==(v=this.getCustomColumnAndRow(y))&&void 0!==v?v:[t.columns,t.rows],g=k(f,2),m=g[0],b=g[1];t.rows=b,t.columns=m}t.time=d,t.specials.bomb=h,t.colors=p}return t})),function(){return l.apply(this,arguments)})},{key:"getLevelData",value:function(){return this.levelData}},{key:"getCustomColumnAndRow",value:function(e){return ff[Ie.clamp(e,0,ff.length-1)]}},{key:"getDifficulty",value:function(e,t){var n=pf.searchIndex(ff,(function(n){var i=k(n,2),a=i[0],o=i[1];return a===e&&o===t}));return-1===n?void 0:n}},{key:"paddingZero",value:function(e,t){for(var n="",i=0;i<t-e.length;i++)n+="0";return n+e}}]),c}(te))||of;function Sf(e){for(var t=e.array,n=e.isLighter,i=e.out,a=void 0===i?new Set:i,o=0;o<t.length;o++)if(n(t.get(o)))for(var r=o+1;r<t.length;r++)if(!n(t.get(r))){t.swap(o,r),a.add(t.get(o));break}return a}X._RF.pop(),X._RF.push({},"bfb989Gr/dArq4M9uSSrF5/","stagger",void 0),X._RF.pop(),X._RF.push({},"cf506DevntPeIl9QrpMEBY0","Grid",void 0);var kf,Cf,Ef,Af,Tf,Pf,Lf,Of,If,Rf,_f,Df,Nf,Mf,Ff,Bf,xf,zf,Uf,Gf,Hf,qf,Vf,$f,Wf,Kf,jf,Yf,Xf,Jf,Zf,Qf,eg,tg,ng,ig,ag,og,rg,lg,sg,ug,cg,dg,hg,pg,yg,vg,fg,gg,mg,bg,wg,Sg,kg,Cg,Eg,Ag,Tg,Pg,Lg,Og,Ig,Rg,_g,Dg,Ng,Mg,Fg,Bg,xg,zg,Ug,Gg,Hg=function(){function n(e){var i;t(this,n),this.array=[];var a=null!=e?e:{},o=a.width,r=void 0===o?1:o,l=a.height,s=void 0===l?1:l,u=e instanceof n?e.array:null!==(i=null==e?void 0:e.content)&&void 0!==i?i:[];if(u.length!==r*s)throw new Error("Invalid content length");this.width=r,this.height=s,this.array=A(u)}return e(n,[{key:"asArray",value:function(){return this.array}},{key:"get",value:function(e,t){if(!this.isInBounds(e,t))throw new Error("Out of bounds");return this.array[t*this.width+e]}},{key:"set",value:function(e,t,n){this.array[t*this.width+e]=n}},{key:"isInBounds",value:function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height}},{key:"each",value:function(e){for(var t=0;t<this.height;t++)for(var n=0;n<this.width;n++)e(this.get(n,t),n,t)}},{key:"map",value:function(e){for(var t=[],n=0;n<this.height;n++)for(var i=0;i<this.width;i++)t.push(e(this.get(i,n),i,n));return t}},{key:"reduce",value:function(e,t){for(var n=t,i=0;i<this.height;i++)for(var a=0;a<this.width;a++)n=e(n,this.get(a,i),a,i);return n}},{key:"swap",value:function(e,t){var n=k(e,2),i=n[0],a=n[1],o=k(t,2),r=o[0],l=o[1],s=this.get(i,a);this.set(i,a,this.get(r,l)),this.set(r,l,s)}},{key:"shuffle",value:function(e){for(var t=null!=e?e:this.map((function(e,t,n){return[t,n]})),n=A(t),i=new Set,a=n.length-1;a>0;a--){var o=Be(0,a+1),r=n[a],l=n[o];n[a]=l,n[o]=r,i.add(this.get(r[0],r[1])),i.add(this.get(l[0],l[1]))}for(var s=0;s<n.length;s++){var u=t[s],c=k(u,2),d=c[0],h=c[1],p=n[s],y=k(p,2),v=y[0],f=y[1];this.swap([d,h],[v,f])}return i}},{key:"toShuffled",value:function(e){var t=new n({width:this.width,height:this.height,content:this.array}),i=t.shuffle(e);return[t,i]}},{key:"gravitate",value:function(e){var t=this,n=k(e.rowRange,2),i=n[0],a=n[1],o=k(e.colRange,2),r=o[0],l=o[1],s=e.direction,u=e.isLighter,c=e.onSwap,d=e.out,h=void 0===d?new Set:d,p=l-r+1,y=a-i+1;switch(s){case Fv.Up:for(var v=function(e){Sf({array:{length:y,get:function(n){return t.get(e,a-n)},swap:function(n,i){var o=t.get(e,a-n),r=t.get(e,a-i);t.swap([e,a-n],[e,a-i]),null==c||c(o,r)}},isLighter:u,out:h})},f=r;f<=l;f++)v(f);return h;case Fv.Down:for(var g=function(e){Sf({array:{length:y,get:function(n){return t.get(e,i+n)},swap:function(n,a){var o=t.get(e,i+n),r=t.get(e,i+a);t.swap([e,i+n],[e,i+a]),null==c||c(o,r)}},isLighter:u,out:h})},m=r;m<=l;m++)g(m);return h;case Fv.Left:for(var b=function(e){Sf({array:{length:p,get:function(n){return t.get(r+n,e)},swap:function(n,i){var a=t.get(r+n,e),o=t.get(r+i,e);t.swap([r+n,e],[r+i,e]),null==c||c(a,o)}},isLighter:u,out:h})},w=i;w<=a;w++)b(w);return h;case Fv.Right:for(var S=function(e){Sf({array:{length:p,get:function(n){return t.get(l-n,e)},swap:function(n,i){var a=t.get(l-n,e),o=t.get(l-i,e);t.swap([l-n,e],[l-i,e]),null==c||c(a,o)}},isLighter:u,out:h})},C=i;C<=a;C++)S(C);return h;default:throw new Error("Invalid direction")}}},{key:"toGravitated",value:function(){var e=new n({width:this.width,height:this.height,content:this.array}),t=e.gravitate.apply(e,arguments);return[e,t]}},{key:"toRotated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new n({width:this.height,height:this.width,content:new Array(this.width*this.height)});if(e)for(var i=0;i<this.height;i++)for(var a=this.width-1;a>=0;a--)t.set(i,this.width-1-a,this.get(a,i));else for(var o=this.height-1;o>=0;o--)for(var r=0;r<this.width;r++)t.set(this.height-1-o,r,this.get(r,o));return t}}]),n}();X._RF.pop(),X._RF.push({},"4046cPYak1BDIVFKksVPsnk","index",void 0),X._RF.pop(),X._RF.push({},"ea140gA27tJa4LD9MT3t93/","Tile",void 0);var qg=Z.ccclass,Vg=Z.property,$g=Z.requireComponent,Wg=Ludex.Utils,Kg=Wg.Signal,jg=Wg.Function,Yg=(kf=qg("Tile"),Cf=$g([ne]),Ef=$g([de]),Af=Yn.required(),Tf=Vg({type:he,group:"Sprite"}),Pf=Yn.required(),Lf=Vg({type:he,group:"Sprite"}),Of=Yn.required(),If=Vg({type:he,group:"Sprite"}),Rf=Yn.required(),_f=Vg({type:he,group:"Sprite"}),Df=Yn.required(),Nf=Vg({type:he,group:"Sprite"}),Mf=Yn.required(),Ff=Vg({type:ne,displayName:"Background UI Transform"}),Bf=Yn.required(),xf=Vg(xe),zf=Yn.required(),Uf=Vg({type:de,group:"Opacity"}),Gf=Yn.required(),Hf=Vg({type:de,group:"Opacity"}),qf=Yn.required(),Vf=Vg({type:de,group:"Opacity"}),$f=Yn.required(),Wf=Vg({type:de,group:"Opacity"}),Kf=Yn.required(),jf=Vg({type:de,group:"Opacity"}),Yf=Yn.required(),Xf=Vg({type:de,group:"Opacity"}),Jf=Yn.required(),Zf=Vg({type:de,group:"Opacity"}),Qf=Yn.required(),eg=Vg(Cr),tg=Yn.required(),ng=Vg(me),ig=Yn.required(),ag=Vg({type:ze,group:"Animation"}),og=Yn.required(),rg=Vg({type:Ue,group:"Animation"}),lg=Yn.required(),sg=Vg({type:Ue,group:"Animation"}),ug=Yn.required(),cg=Vg({type:Ue,group:"Animation"}),dg=Yn.required(),hg=Vg({type:Ue,group:"Animation"}),pg=Yn.onlyRunInLifeCycle,yg=Yn.onlyRunInLifeCycle,vg=Yn.onlyRunInLifeCycle,fg=Yn.onlyRunInLifeCycle,gg=Yn.onlyRunInLifeCycleAsync,mg=Yn.onlyRunInLifeCycleAsync,kf(bg=Cf(bg=Ef((Sg=a((wg=function(a){n(S,a);var r,u,c,d,h,y,v,f,g,m,b=i(S);function S(){var e;t(this,S);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=b.call.apply(b,[this].concat(i)),l(e,"iconPlaceholder",Sg,s(e)),l(e,"icon",kg,s(e)),l(e,"bombComponent",Cg,s(e)),l(e,"starComponent",Eg,s(e)),l(e,"background",Ag,s(e)),l(e,"bgUITransform",Tg,s(e)),l(e,"defaultBackground",Pg,s(e)),l(e,"uiOpacity",Lg,s(e)),l(e,"shineOpacity",Og,s(e)),l(e,"glowOpacity",Ig,s(e)),l(e,"iconOpacity",Rg,s(e)),l(e,"iconPlaceholderOpacity",_g,s(e)),l(e,"bombUiOpacity",Dg,s(e)),l(e,"startUiOpacity",Ng,s(e)),l(e,"button",Mg,s(e)),l(e,"container",Fg,s(e)),l(e,"animationComponent",Bg,s(e)),l(e,"clearClip",xg,s(e)),l(e,"shakeClip",zg,s(e)),l(e,"breakClip",Ug,s(e)),l(e,"lightningClearClip",Gg,s(e)),e.id=null,e.frames=[],e.isEmpty=!1,e.coord=new De,e.mainSignalController=new Kg.SignalController,e.identitySignalController=new Kg.SignalController,e.placeholderSignalController=new Kg.SignalController,e.specialSignalController=new Kg.SignalController,e}return e(S,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,S),this.special=this.createSpecialHandler(M.none)}},{key:"update",value:function(e){var t;(null===(t=this.special)||void 0===t?void 0:t.type)===M.bomb&&this.special.update(e)}},{key:"onDestroy",value:function(){var e,t;(null===(e=this.special)||void 0===e?void 0:e.type)!==M.none&&(null===(t=this.special)||void 0===t||t.onDestroy())}},{key:"setIgnoreInput",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.button.interactable=!e}},{key:"getCoord",value:function(){return this.coord}},{key:"setCoord",value:function(e,t){this.coord.set(e,t)}},{key:"isSimilarTo",value:function(e){return this.id===e.id}},{key:"inSamePositionAs",value:function(e,t){return e instanceof S?this.coord.equals(e.getCoord()):this.coord.x===e&&this.coord.y===t}},{key:"isHidden",value:function(){return this.isEmpty}},{key:"getSize",value:function(){return[this.bgUITransform.width,this.bgUITransform.height]}},{key:"onClick",value:function(){this.isHidden()||this.node.scene.emit(Js.TILE_CLICK,this)}},{key:"setIdentity",value:function(e,t){this.id=e,this.frames=t,this.updateIdentityFrame()}},{key:"updateIdentityFrame",value:(m=o((function*(){var e,t=this;if(null!==this.id){var n=this.identitySignalController.renew();if(!Array.isArray(this.frames)){this.setPlaceholderVisible(!0,n);var i=yield this.frames;if(n.aborted)return;this.frames=i}var a=this.frames[this.id];a?(this.setPlaceholderVisible(!1,n),null===(e=n.wrap((function(){return t.setIdentityFrame(a)})))||void 0===e||e()):console.error("Failed to load identity frame. ".concat(this.id," is not in the frames array."))}})),function(){return m.apply(this,arguments)})},{key:"setPlaceholderVisible",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this.placeholderSignalController.renew();if(t&&n.chain(t),e)return p.runTweenAsync(re(this.iconPlaceholder.node).to(.15,{scale:be.ONE},{easing:"backOut"}),n),void p.runTweenAsync(re(this.iconPlaceholderOpacity).delay(Ge(0,.75)).to(.15,{opacity:255}).repeatForever(re(this.iconPlaceholderOpacity).to(.25,{opacity:80}).delay(.25).to(.25,{opacity:255}).delay(.75)),n);p.runTweenAsync(re(this.iconPlaceholder.node).to(.15,{scale:be.ZERO},{easing:"backIn"}),n),p.runTweenAsync(re(this.iconPlaceholderOpacity).to(.15,{opacity:0}),n)}},{key:"setIdentityFrame",value:function(e,t){var n=this;this.icon.spriteFrame=e;var i=this.getSize(),a=k(i,2),o=a[0],r=a[1],l=e.originalSize,s=l.width,u=l.height,c=Math.max(s/(.7*o),u/(.7*r));this.icon.node.setScale(0,0,0);var d=function(){n.icon.node.setScale(1/c,1/c,1)};null==t||t.once(d),p.runTweenAsync(re(this.icon.node).delay(Ge(0,.2)).to(.15,{scale:new be(1/c,1/c,1)},{easing:"sineOut"}),t),null==t||t.off(d)}},{key:"setSpecialType",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M.none,a=arguments.length>1?arguments[1]:void 0;if(null===(e=this.special)||void 0===e||e.switch(i,a),(null===(t=this.special)||void 0===t?void 0:t.type)===M.bomb||(null===(n=this.special)||void 0===n?void 0:n.type)===M.star){var o=this.special;if(!Array.isArray(this.frames)){var r=this.specialSignalController.renew();o.hide(r,!0),this.frames.then((function(){o.isDestroyed||o.show(r)}))}}}},{key:"setFocused",value:(g=o((function*(e){var t=re(this.shineOpacity).to(.15,{opacity:e?255:0},{easing:"cubicOut"});this.shineOpacity.node.scale=e?be.ZERO:be.ONE;var n=re(this.shineOpacity.node).to(.15,{scale:e?be.ONE:be.ZERO},{easing:"cubicOut"});if(e){var i=re(this.glowOpacity).to(2,{opacity:150});i.to(2,{opacity:20}),this.glowOpacityTween=re(this.glowOpacity).repeatForever(i).start()}else this.glowOpacityTween&&this.glowOpacityTween.stop(),this.glowOpacity.opacity=0;yield Promise.all([p.runTweenAsync(t),p.runTweenAsync(n)])})),function(e){return g.apply(this,arguments)})},{key:"setEmpty",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isEmpty||(this.mainSignalController.abort(),this.isEmpty=!0,this.setIgnoreInput(!0),this.button.resetButtonState(),i||(null===(e=this.special)||void 0===e?void 0:e.type)!==M.star&&(null===(t=this.special)||void 0===t?void 0:t.type)!==M.bomb||this.special.clear(),this.setOpacity(0),null===(n=this.special)||void 0===n||n.switch(M.none))}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"setHint",value:(f=o((function*(e){var t,n=this.mainSignalController.renew();if(e)yield this.runAnimation(this.shakeClip.name,n);else if(null===(t=this.animationComponent)||void 0===t||t.stop(),this.container){var i=re(this.container).to(.1,{scale:be.ONE,eulerAngles:be.ZERO});yield p.runTweenAsync(i,n)}})),function(e){return f.apply(this,arguments)})},{key:"playClearFX",value:(v=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mainSignalController.renew();this.setOpacity(255);var a=function(){return t.setOpacity(0)},o=n?this.lightningClearClip:this.clearClip;i.once(a),yield this.runAnimationAfterDelay(o.name,e,i),i.off(a),i.aborted||a()})),function(e){return v.apply(this,arguments)})},{key:"playOldLightningClearFX",value:(y=o((function*(){var e=this,t=this.mainSignalController.renew();this.setOpacity(255);var n=function(){return e.setOpacity(0)};t.once(n),yield this.runAnimation(this.breakClip.name,t),t.off(n),t.aborted||n()})),function(){return y.apply(this,arguments)})},{key:"runAnimationAfterDelay",value:(h=o((function*(e,t,n){t&&(yield p.waitTweenAsync(t,n)),yield this.runAnimation(e,n)})),function(e,t,n){return h.apply(this,arguments)})},{key:"runAnimation",value:function(e,t){return p.runAnimationAsync(this.animationComponent,e,t)}},{key:"restore",value:(d=o((function*(e,t){var n=this.mainSignalController.renew();this.animationComponent.stop(),this.isEmpty=!1,this.setIgnoreInput(!0),void 0!==e&&t&&this.setIdentity(e,t),this.setOpacity(255),this.iconOpacity.opacity=255,this.node.setScale(be.ZERO),this.background.spriteFrame=this.defaultBackground,this.button.fakeClick(),yield p.runTweenAsync(re(this.node).to(.3,{scale:be.ONE},{easing:"backOut"}),n),this.node.setScale(be.ONE),this.setIgnoreInput(!1)})),function(e,t){return d.apply(this,arguments)})},{key:"sync",value:(c=o((function*(e){var t=e.duration,n=void 0===t?.3:t,i=e.delay,a=void 0===i?0:i,o=e.easing,r=void 0===o?"cubicOut":o,l=(0,e.getTargetPosition)(this.coord),s=new be(l.x,l.y,this.node.position.z);yield p.runTweenAsync(re(this.node).delay(a).to(n,{position:s},{easing:r}))})),function(e){return c.apply(this,arguments)})},{key:"fly",value:(u=o((function*(e){var t=this,n=300,i=Math.sqrt(Math.pow(this.node.position.x,2)+Math.pow(this.node.position.y,2)),a=Math.max(n-.7*i,0),o=i/1e3,r=this.node.position.clone(),l=e.getTilePosition(this.coord),s=new be(l.x,l.y,this.node.position.z),u=this.container,c=2,d=1,h=360,y=.0025*a,v=0,f=new be(0,0,0),g=.75-y,m={value:0,prevElapsed:0},b=re(m);return b.delay(o),b.to(.5,{value:0},{progress:function(e,n,i,a){var o=(c*=-1)*a,l=r.clone();return l.x+=o,t.node.setPosition(l),i}}),b.to(y,{value:1},{progress:function(e,i,o,r){var l=p.easeOutExpo(r),s=y*r-m.prevElapsed,c=y*r,v=a*l;t.setHeight(v,n);var f=t.node.position.clone();d+=.1,be.rotateZ(f,f,new be(0,0,0),d*Math.PI*s),t.node.setPosition(new be(f.x,f.y,f.z));var g=(h+=10)*s;return u.angle+=g,m.prevElapsed=c,o}}),b.call((function(){f.set((t.node.position.x+s.x)/2,(t.node.position.y+s.y)/2,0),m.prevElapsed=0,u.angle%=360,u.angle-=360,v=u.angle})),b.to(g,{value:0},{progress:function(e,i,o,r){var l=g*r-m.prevElapsed,s=g*r,c=a*(1-r);t.setHeight(c,n);var d=t.node.position.clone();return be.rotateZ(d,d,f,Math.PI/g*l),t.node.setPosition(new be(d.x,d.y,d.z)),u.angle+=-v/g*l,m.prevElapsed=s,o}}),b.call((function(){t.node.setPosition(s),t.setHeight(0,n),u.angle=0})),p.runTweenAsync(b)})),function(e){return u.apply(this,arguments)})},{key:"moveAround",value:(r=o((function*(){for(var e=[{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],t=this.container.position.clone(),n=-1,i=0;i<5;i++){for(var a=Ie.randomRangeInt(0,4);n===a;)a=Ie.randomRangeInt(0,4);n=a;var o=e[a];if(o){var r=t.clone().add(new be(5*o.x,5*o.y)),l=re(this.container).to(.1,{position:r},{easing:"smooth"});yield p.runTweenAsync(l)}}var s=re(this.container).to(.1,{position:t},{easing:"smooth"});yield p.runTweenAsync(s)})),function(){return r.apply(this,arguments)})},{key:"setHeight",value:function(e,t){if(this.container){var n=this.container;n.setPosition(new be(n.position.x,e,0)),n.setScale(new be(1+e/t*.3,1+e/t*.3,1))}}},{key:"createSpecialHandler",value:function(e,t){var n=this;switch(e){case M.bomb:return this.createBombHandler(null!=t?t:90);case M.star:return this.createStarHandler();default:return{type:M.none,switch:function(e,t){n.special=n.createSpecialHandler(e,t)}}}}},{key:"createBombHandler",value:function(e){var t=this,n=!1,i=!1,a=e,o=function(){i=!0},r=function(){i=!1};this.node.scene.on(Js.TILE_CLICK,o),this.node.scene.on(Js.USE_ITEM,o),this.node.scene.on(Js.RESUME_TIME,o),this.node.scene.on(Js.PAUSE_TIME,r),this.node.scene.on(Js.TIME_OUT,r),this.bombComponent.node.active=!0;var l=function(){n=!0,i=!1,t.bombComponent.node.active=!1,a=e,t.node.scene.off(Js.TILE_CLICK,o),t.node.scene.off(Js.USE_ITEM,o),t.node.scene.off(Js.GAME_RESUME,o),t.node.scene.off(Js.GAME_PAUSE,r),t.node.scene.off(Js.TIME_OUT,r)};return{type:M.bomb,get isDestroyed(){return n},update:function(n){i&&(a-=n,t.bombComponent.fillRange=-a/e,a<=0&&(i=!1,t.bombComponent.node.active=!1,t.setEmpty(!0),t.node.scene.emit(Js.BOMB_EXPLODE,t)))},clear:function(){w.playSound(Qi.BOMB_DEFUSE)},cleanup:l,onDestroy:function(){n=!0,t.node.scene.off(Js.TILE_CLICK,o),t.node.scene.off(Js.USE_ITEM,o),t.node.scene.off(Js.GAME_RESUME,o),t.node.scene.off(Js.GAME_PAUSE,r),t.node.scene.off(Js.TIME_OUT,r)},switch:function(e,n){l(),t.special=t.createSpecialHandler(e,n)},show:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=255})),jg.allSettled([p.runTweenAsync(re(t.bombUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=255},hide:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==e||e.once((function(){t.bombUiOpacity.opacity=0})),jg.allSettled([p.runTweenAsync(re(t.bombUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),e)]);t.bombUiOpacity.opacity=0},detonateImmediately:function(){a=0}}}},{key:"createStarHandler",value:function(){var e=this,t=!1;this.starComponent.node.active=!0;var n=function(){t=!0,e.starComponent.node.active=!1};return{type:M.star,get isDestroyed(){return t},clear:function(){e.starComponent.node.active=!1,w.playSound(Qi.COLLECT_STARS);var t=e.node.worldPosition,n=t.x,i=t.y;e.node.scene.emit(Js.ADD_STARS,{startAnimationAt:[n,i]})},cleanup:n,onDestroy:function(){t=!0},show:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=255})),jg.allSettled([p.runTweenAsync(re(e.startUiOpacity).to(.1,{opacity:255},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=255},hide:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return null==t||t.once((function(){e.startUiOpacity.opacity=0})),jg.allSettled([p.runTweenAsync(re(e.startUiOpacity).to(.1,{opacity:0},{easing:"cubicOut"}),t)]);e.startUiOpacity.opacity=0},switch:function(t){n(),e.special=e.createSpecialHandler(t)}}}}]),S}(te)).prototype,"iconPlaceholder",[Af,Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kg=a(wg.prototype,"icon",[Pf,Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cg=a(wg.prototype,"bombComponent",[Of,If],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eg=a(wg.prototype,"starComponent",[Rf,_f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ag=a(wg.prototype,"background",[Df,Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tg=a(wg.prototype,"bgUITransform",[Mf,Ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pg=a(wg.prototype,"defaultBackground",[Bf,xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lg=a(wg.prototype,"uiOpacity",[zf,Uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Og=a(wg.prototype,"shineOpacity",[Gf,Hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ig=a(wg.prototype,"glowOpacity",[qf,Vf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rg=a(wg.prototype,"iconOpacity",[$f,Wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_g=a(wg.prototype,"iconPlaceholderOpacity",[Kf,jf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dg=a(wg.prototype,"bombUiOpacity",[Yf,Xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ng=a(wg.prototype,"startUiOpacity",[Jf,Zf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mg=a(wg.prototype,"button",[Qf,eg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fg=a(wg.prototype,"container",[tg,ng],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bg=a(wg.prototype,"animationComponent",[ig,ag],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xg=a(wg.prototype,"clearClip",[og,rg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zg=a(wg.prototype,"shakeClip",[lg,sg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ug=a(wg.prototype,"breakClip",[ug,cg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gg=a(wg.prototype,"lightningClearClip",[dg,hg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(wg.prototype,"setIgnoreInput",[pg],Object.getOwnPropertyDescriptor(wg.prototype,"setIgnoreInput"),wg.prototype),a(wg.prototype,"setPlaceholderVisible",[yg],Object.getOwnPropertyDescriptor(wg.prototype,"setPlaceholderVisible"),wg.prototype),a(wg.prototype,"setIdentityFrame",[vg],Object.getOwnPropertyDescriptor(wg.prototype,"setIdentityFrame"),wg.prototype),a(wg.prototype,"setOpacity",[fg],Object.getOwnPropertyDescriptor(wg.prototype,"setOpacity"),wg.prototype),a(wg.prototype,"runAnimationAfterDelay",[gg],Object.getOwnPropertyDescriptor(wg.prototype,"runAnimationAfterDelay"),wg.prototype),a(wg.prototype,"runAnimation",[mg],Object.getOwnPropertyDescriptor(wg.prototype,"runAnimation"),wg.prototype),bg=wg))||bg)||bg)||bg);X._RF.pop(),X._RF.push({},"d6995j9hvVJYKs6vvV+rs1I","index",void 0),X._RF.pop(),X._RF.push({},"d65b2oe6HRJU7zJnHC2Jubi","BoardScale",void 0);function Xg(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n.x,o=n.y,r=k(t,2),l=r[0],s=r[1],u=l*(a-(e.width-1)/2)+i*(a-e.width/2),c=s*(o-(e.height-1)/2)+i*(o-e.height/2);return-1===a&&(u+=t[0]/4),a===e.width&&(u-=t[0]/4),-1===o&&(c+=t[1]/4),o===e.height&&(c-=t[1]/4),{x:u,y:c}}function Jg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=k(e,2),i=n[0],a=n[1],o=k(t,2),r=o[0],l=o[1],s=1-r,u=1-l,c=i*s,d=a*u;return[c,d]}function Zg(e){for(var t=e.split("-"),n=[],i=0;i<t.length;){var a=null;switch(t[i]){case"normal":i+=1;break;case"fall":a=Bv,i+=2;break;case"fly":a=xv,i+=2;break;case"push":"left"===t[i+1]?(a=zv,i+=2):(a=Uv,i+=2);break;case"put":"columns"===t[i+1]?(a=Gv,i+=3):(a=Hv,i+=3)}a&&n.push(a)}return n}function Qg(e){switch(e){case Bv:return Uv;case xv:return zv;case zv:return Bv;case Uv:return xv;case Gv:return Hv;case Hv:return Gv}}function em(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.x,o=e.y,r=i?o:n-1-o,l=i?t-1-a:a;return{x:r,y:l}}function tm(e){return(e instanceof Hg?e.asArray():e).filter((function(e){return!e.isHidden()}))}function nm(e){return(e instanceof Hg?e.asArray():e).filter((function(e){return e.isHidden()}))}X._RF.pop(),X._RF.push({},"cb8ddC2w59DpqVoQENbYYcU","calcBoardScale",void 0),X._RF.pop(),X._RF.push({},"305c7LJx+ROLI4g8tTiAFyb","calcTilePosition",void 0),X._RF.pop(),X._RF.push({},"c522ca1UPhDYaToWf66t1X2","calcTileSize",void 0),X._RF.pop(),X._RF.push({},"37667B66RZBc5chlMqN6mH8","parseLevelGravity",void 0),X._RF.pop(),X._RF.push({},"60475oElENLe7C3g+jd0ZEl","rotateGravity",void 0),X._RF.pop(),X._RF.push({},"a1c1a/tPEpHy4ITkE80K0lL","rotatePath",void 0),X._RF.pop(),X._RF.push({},"f0f0bXgdxJHIJWOmA6n0Ood","getUncleared",void 0),X._RF.pop(),X._RF.push({},"a90bcq22hlMzbYdivjPpm0h","getBombTiles",void 0),X._RF.pop(),X._RF.push({},"92e23drVfRIgbDVZLTSdEkI","getCleared",void 0),X._RF.pop(),X._RF.push({},"7105bfR+Y5F1a0SDiMXZ9mV","getNearbyTiles",void 0);var im=Ludex.Utils.Object;function am(e){return Array.isArray(e)}function om(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=am(e)?e:e.asArray();return n[Fe(t,0,n.length)]}X._RF.pop(),X._RF.push({},"d1b9bBg+dBA+7n/Sz+RCIAX","getRandomTile",void 0),X._RF.pop(),X._RF.push({},"c4bf3uyS1pEdrTrwDEXeuZP","getRandomPair",void 0);var rm=Ludex.Utils.Array;function lm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=e instanceof Hg?e.asArray():e,i=om(n,t),a=rm.search(n,(function(e){return e.isSimilarTo(i)&&!e.inSamePositionAs(i)}));if(void 0===a)throw new Error("Could not find a matching tile");return[i,a]}X._RF.pop(),X._RF.push({},"cf8d6gfx2ZIsqm978cNLWaV","pseudoRandomIterable",void 0);var sm=function(e){return e};function um(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sm;return function*(){var i=e,a=t;i<=0&&(i=Number.POSITIVE_INFINITY);for(var o=0;o<i;o++)yield n(a),a=1e9*He(a)}()}function cm(e){return Array.isArray(e)}function dm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=cm(e)?e:e.asArray();if(i.length<t)return new Set(i);for(var a=new Set,o=um(-1,n),r=o.next();a.size<t;){if(r.done)throw new Error("RNG exhausted");a.add(om(i,r.value)),r=o.next()}return a}X._RF.pop(),X._RF.push({},"718b6Wu0pdGVK5KYSUDctVX","getRandomTiles",void 0),X._RF.pop(),X._RF.push({},"17ccarKybRNwYcZnBQhCUYy","index",void 0),X._RF.pop(),X._RF.push({},"bab6dqrPz9AaaBN5cy+QzPj","assignSpecialTiles",void 0);var hm=[1,2];function pm(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=t.specials,o=a.bomb,r=Fe.apply(void 0,[i].concat(hm)),l=dm(e,o,i),s=e.asArray().filter((function(e){return!l.has(e)})),u=dm(s,r,i),d=c(l);try{for(d.s();!(n=d.n()).done;){var h=n.value,p=2*t.time/3;h.setSpecialType(M.bomb,p)}}catch(e){d.e(e)}finally{d.f()}var y,v=c(u);try{for(v.s();!(y=v.n()).done;){var f=y.value;f.setSpecialType(M.star)}}catch(e){v.e(e)}finally{v.f()}}X._RF.pop(),X._RF.push({},"228efPdzUNCMp4yYcBs9r+3","index",void 0),X._RF.pop(),X._RF.push({},"09be7lmGLNMvIObiqskePhz","createGrid",void 0);var ym=Ludex.Utils.Array;function vm(e){var t=e.levelData,n=t.columns,i=t.rows,a=e.identities,o=e.setTileIdentity,r=e.createTile,l=e.seed,s=function(e,t,n){var i,a=[],o=c(um(t/2,e,(function(e){return Fe(e,0,n.length)})));try{for(o.s();!(i=o.n()).done;){var r=i.value;a.push(n[r]),a.push(n[r])}}catch(e){o.e(e)}finally{o.f()}return ym.shuffle(a),a}(void 0===l?Date.now():l,n*i,a),u=fm(e.levelData,a,s).reverse(),d=fm(e.levelData,a,u).reverse().map((function(e){var t=r(e);return o(t,e),t}));return new Hg({width:n,height:i,content:d})}function fm(e,t,n){var i=e.rows,a=e.columns,o=e.rules;if(!o.maxSpaceOfPair)return n;var r,l=function(e,t,n){for(var i=[],a=0;a<t;a++){i[a]=[];for(var o=0;o<n;o++)i[a][o]=e[a*n+o]}return i}(n,i,a),s=c(t);try{for(s.s();!(r=s.n()).done;)for(var u=r.value,d=null,h=null,p=0;p<i;p++)for(var y=0;y<a;y++){if(l[p][y]===u)if(d&&h){var v=o.maxSpaceOfPair+1;if(Math.abs(p-d)+Math.abs(y-h)<=v)h=y,d=p;else{var f=gm(d,h,p,y),g=l[f.row][f.column];l[f.row][f.column]=l[p][y],l[p][y]=g}}else d=p,h=y}}catch(e){s.e(e)}finally{s.f()}return function(e){var t,n=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var a,o=t.value,r=c(o);try{for(r.s();!(a=r.n()).done;){var l=a.value;n.push(l)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){i.e(e)}finally{i.f()}return n}(l)}function gm(e,t,n,i){var a=e,o=t;return n>e&&(a=e+1),n<e&&(a=e-1),i>t&&(o=t+1),i<t&&(o=t-1),{row:a,column:o}}X._RF.pop(),X._RF.push({},"5d998xlab9FLIpvw+sXMIYw","createGridFromFen",void 0);var mm=Ludex.Utils.Array;function bm(e){var t=e.customFen,n=e.identities,i=e.createTile,a=t.idSize,o=t.cols,r=t.rows,l=t.code;if(n.length<t.idSize)throw new Error("Invalid grid code. There are not enough identities/frames ".concat(n.length," to fill it according to fen code ").concat(a));var s=l.split(":");if(s.length!==r)throw new Error("Invalid grid code");var u=/[a-zA-Z]+\d+|./g,d=/[a-zA-Z]+/,h=/\d+/,p=s.reduceRight((function(e,a){var o,r=[],l=a.matchAll(u),s=c(l);try{for(s.s();!(o=s.n()).done;){var p,y,v=o.value[0],f=null===(p=h.exec(v))||void 0===p?void 0:p[0],g=void 0!==f?parseInt(f,10):void 0,m=void 0!==g&&!isNaN(g)&&g<n.length?n[g]:void 0,b=i(void 0!==m?m:n[0]),w=null===(y=d.exec(v))||void 0===y?void 0:y[0],S=void 0!==w?wm(w,t.encoding):void 0;void 0!==S&&void 0!==m?b.setSpecialType(S):b.setEmpty(),r.push(b)}}catch(e){s.e(e)}finally{s.f()}return e.concat(r)}),[]);return new Hg({width:o,height:r,content:p})}function wm(e,t){var n=mm.search(Object.entries(t),(function(t){var n=k(t,2);n[0];return n[1]===e}));if(void 0===n)throw new Error("Invalid special type ".concat(e));return n[0]}function Sm(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.toRotated(t);return n.each((function(e,t,n){e.setCoord(t,n)})),n}X._RF.pop(),X._RF.push({},"30de5d+cW5OjKyEubKVREbU","createRotatedGrid",void 0),X._RF.pop(),X._RF.push({},"9ceb6vNbn9PKozkdGjjZD67","ensureOneMatch",void 0);var km=Ludex.Utils.Array;function Cm(e){var t=e.grid,n=e.setIdentity,i=e.seed,a=void 0===i?Date.now():i,o=t.asArray(),r=om(t,a),l=function(e,t){var n=t.getCoord(),i=n.x,a=n.y;return im.vals(Fv).reduce((function(t,n){var o=n.x,r=n.y,l=i+o,s=a+r;return e.isInBounds(l,s)&&t.push(e.get(l,s)),t}),[])}(t,r);if(!l.some((function(e){return e.isSimilarTo(r)}))){var s=om(l,a),u=km.search(o,(function(e){return!e.inSamePositionAs(r)&&!e.inSamePositionAs(s)&&e.isSimilarTo(s)}));if(void 0===u||null===r.id)throw new Error("Could not find a sacrifice tile");n(u,r.id),n(s,r.id)}}X._RF.pop(),X._RF.push({},"89318H0TDxMlJsVFwuKgrh3","index",void 0),X._RF.pop(),X._RF.push({},"fb4a9VOCxBBvpXFCcSt4P3J","NewbieSteps",void 0);var Em=[{startTile:{x:0,y:1},endTile:{x:3,y:1},localeTextKey:"guide.step1"},{startTile:{x:2,y:2},endTile:{x:3,y:0},localeTextKey:"guide.step2"},{startTile:{x:0,y:0},endTile:{x:3,y:3},localeTextKey:"guide.step3"},{startTile:{x:0,y:4},endTile:{x:2,y:3},localeTextKey:"guide.step4"},{startTile:{x:1,y:4},endTile:{x:1,y:2},localeTextKey:"guide.step5"}];X._RF.pop(),X._RF.push({},"627d5N3oStP8q9+ABNqnHBq","getBestPath",void 0);var Am=Ludex.Utils.Array;function Tm(e,t){return e[0]===t[0]&&e[1]===t[1]}function Pm(e){return new De(e[0],e[1])}function Lm(e,t){return e.x>=-1&&e.x<t.width+1&&e.y>=-1&&e.y<t.height+1}function Om(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rm;return t.map((function(t){return[e.tile[0]+t.x,e.tile[1]+t.y]}))}var Im,Rm=[Fv.Up,Fv.Down,Fv.Left,Fv.Right],_m=function(){function n(e,i){var a;if(t(this,n),this.f=0,this.g=0,this.h=0,i&&Tm(e,i.tile))throw new Error("Tile cannot be its own parent");this.tile=e,this.parent=i;var o=n.calcDirection(this),r=i&&o&&i.cache.direction&&!o.equals(i.cache.direction)?1:0;this.cache={direction:o,turns:r+(null!==(a=null==i?void 0:i.cache.turns)&&void 0!==a?a:0)}}return e(n,[{key:"getKey",value:function(){var e;return"x:".concat(this.tile[0],",y:").concat(this.tile[1],",d:").concat(null===(e=this.cache.direction)||void 0===e?void 0:e.toString())}},{key:"equals",value:function(e){return this.getKey()===e.getKey()}}],[{key:"calcDirection",value:function(e){if(e.parent){var t=e.parent.tile,n=e.tile;return new De(n[0]-t[0],n[1]-t[1])}return null}}]),n}();function Dm(e,t,n){var i=Fm(e,t),a=Fm(e,n);if(0===i.length||0===a.length)return Nm(t,n);var o=function(e,t,n){var i=[],a=[],o=new _m(t,null),r=new _m(n,null),l=[r.tile];i.push(o);for(;i.length>0;){var s=i.shift();if(a.push(s),Tm(s.tile,r.tile)){for(var u=[],d=s,h=s,p=s.parent;p;)p.cache.turns!==h.cache.turns&&(u.unshift({a:Pm(p.tile),b:Pm(d.tile)}),d=p),h=p,p=p.parent;return u.unshift({a:Pm(h.tile),b:Pm(d.tile)}),u}var y,v=Om(s,Fm(e,s.tile,l)),f=c(v);try{var g=function(){var e=y.value,t=new _m(e,s);if(t.cache.turns>8)return 0;var n=Tm(t.tile,r.tile),o=a.some((function(e){return e.equals(t)}));if(i.some((function(e){return e.equals(t)}))||o&&!n)return 0;t.g=s.g+1+t.cache.turns,t.h=Mm(t,r),t.f=t.g+t.h,i.push(t)};for(f.s();!(y=f.n()).done;)g()}catch(e){f.e(e)}finally{f.f()}i.sort((function(e,t){return e.f-t.f}))}return null}(e,t,n);return o||Nm(t,n)}function Nm(e,t){var n=Pm(e),i=Pm(t);return n.x===i.x||n.y===i.y?[{a:n,b:i}]:[{a:n,b:{x:n.x,y:i.y}},{a:{x:n.x,y:i.y},b:i}]}function Mm(e,t){var n=e.tile,i=t.tile;return Math.abs(n[0]-i[0])+Math.abs(n[1]-i[1])}function Fm(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[],o=c(Rm);try{var r=function(){var o=n.value,r={x:t[0]+o.x,y:t[1]+o.y};if(e.isInBounds(r.x,r.y))return(e.get(r.x,r.y).isHidden()||Am.search(i,(function(e){return Tm(e,[r.x,r.y])})))&&a.push(o),1;Lm(r,e)&&a.push(o)};for(o.s();!(n=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}return a}X._RF.pop(),X._RF.push({},"b622ea7Aw5LT5yfRAx8qSap","getErrorPath",void 0),X._RF.pop(),X._RF.push({},"716f6/ILpZCPp1nebbdk8Oj","getGridFen",void 0);var Bm=(E(Im={},M.bomb,"b"),E(Im,M.star,"s"),E(Im,M.none,"t"),Im);function xm(e){return e.reduce((function(e,t,n,i){return t.inSamePositionAs(n,i)||e.push([t,[n,i]]),e}),[])}function*zm(e,t){for(var n=0,i=e-1,a=0,o=t-1;n<=i&&a<=o;){for(var r=n;r<=i;r++)yield{x:r,y:a};for(var l=++a;l<=o;l++)yield{x:i,y:l};for(var s=--i;s>=n;s--)yield{x:s,y:o};for(var u=--o;u>=a;u--)yield{x:n,y:u};n++}}X._RF.pop(),X._RF.push({},"badfeEqwgFEorJVHO9tJSXZ","getOutOfSync",void 0),X._RF.pop(),X._RF.push({},"cd0d548/WxD7KCyW2hwySVO","traverseSpiralIn",void 0),X._RF.pop(),X._RF.push({},"373ceVkYCtMTrQObvzJgg7s","getValidPath",void 0);var Um,Gm,Hm,qm,Vm,$m,Wm,Km,jm,Ym,Xm,Jm,Zm=Ludex.Utils.Array,Qm=function(){function n(e,i){t(this,n),this.coord=new De(e,i)}return e(n,[{key:"isHidden",value:function(){return!0}},{key:"isSimilarTo",value:function(){return!1}}]),n}();function eb(e){return new De(e[0],e[1])}function tb(e,t,n){if(void 0===t||void 0===n)return function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zm,i=[],a=c(n(e.width,e.height));try{for(a.s();!(t=a.n()).done;){var o=t.value,r=e.get(o.x,o.y);r.isHidden()||i.push([r,[o.x,o.y]])}}catch(e){a.e(e)}finally{a.f()}var l,s=[],u=function(){var t=i.shift(),n=k(t,2),a=n[0],o=n[1];if(Zm.search(s,(function(e){return ab(e,o)})))return 0;s.push(o);for(var r,l=function(){var t=k(c[u],2),n=t[0],i=t[1];if(!n.isSimilarTo(a)||Zm.search(s,(function(e){return ab(e,i)})))return 0;var r=tb(e,o,i);return null!==r?{v:{v:r}}:void 0},u=0,c=i;u<c.length;u++)if(0!==(r=l())&&r)return r.v};for(;i.length>0;)if(0!==(l=u())&&l)return l.v;return null}(e);var i,a=[t[0]+1,t[1]+1],o=[n[0]+1,n[1]+1],r=function(e){var t=Zm.fillWith(e.width+2,(function(e){return new Qm(e-1,-1)})),n=Zm.fillWith(e.width+2,(function(t){return new Qm(t-1,e.height)})),i=Zm.fillWith(e.height,(function(e){return new Qm(-1,e)})),a=Zm.fillWith(e.height,(function(t){return new Qm(e.width,t)})),o=function(o,r){var l=o-1,s=r-1;return-1===l?i[s]:l===e.width?a[s]:-1===s?t[l]:s===e.height?n[l]:e.get(l,s)};return{get:function(e,t){return o(e,t)},width:e.width+2,height:e.height+2}}(e),l=[a,o];if(a[0]===o[0]&&rb(r,l,a[1],o[1],a[0])||a[1]===o[1]&&lb(r,l,a[0],o[0],a[1]))return cb([{a:eb(a),b:eb(o)}],{x:-1,y:-1});var s=a[1]<=o[1]?a:o,u=a[1]<=o[1]?o:a,d=a[0]<=o[0]?a:o,h=a[0]<=o[0]?o:a,p=[],y=[],v=sb(r,l,1,eb(s),eb(u)),f=sb(r,l,-1,eb(s),eb(u));-1===v&&-1===f||(i=-1!==v?v:f,p=[{a:eb(a),b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:{x:o[0],y:i}},{a:{x:o[0],y:i},b:eb(o)}]);var g=ub(r,l,1,eb(d),eb(h)),m=ub(r,l,-1,eb(d),eb(h));-1===g&&-1===m||(i=-1!==g?g:m,p=[{a:eb(a),b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:{x:i,y:o[1]}},{a:{x:i,y:o[1]},b:eb(o)}]);var b=function(e,t,n,i){for(var a=n.y+1;a<i.y;a++)if(rb(e,t,n.y,a,n.x)&&lb(e,t,n.x,i.x,a)&&rb(e,t,a,i.y,i.x))return a;return-1}(r,l,eb(s),eb(u));-1!==b&&(i=b,y=[{a:eb(a),b:{x:a[0],y:i}},{a:{x:a[0],y:i},b:{x:o[0],y:i}},{a:{x:o[0],y:i},b:eb(o)}]);var w=function(e,t,n,i){for(var a=n.x+1;a<i.x;a++)if(lb(e,t,n.x,a,n.y)&&rb(e,t,n.y,i.y,a)&&lb(e,t,a,i.x,i.y))return a;return-1}(r,l,eb(d),eb(h));return-1!==w&&(i=w,y=[{a:eb(a),b:{x:i,y:a[1]}},{a:{x:i,y:a[1]},b:{x:i,y:o[1]}},{a:{x:i,y:o[1]},b:eb(o)}]),p.length>0&&y.length>0?cb(nb(p)<=nb(y)?p:y,{x:-1,y:-1}):p.length>0?cb(p,{x:-1,y:-1}):y.length>0?cb(y,{x:-1,y:-1}):null}function nb(e){var t,n=0,i=c(e);try{for(i.s();!(t=i.n()).done;){n+=ib(t.value)}}catch(e){i.e(e)}finally{i.f()}return n}function ib(e){return e.a.x===e.b.x?Math.abs(e.a.y-e.b.y):e.a.y===e.b.y?Math.abs(e.a.x-e.b.x):0}function ab(e,t){return e[0]===t[0]&&e[1]===t[1]}function ob(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.get.apply(e,A(t));return i.isHidden()||n.some((function(e){return ab(e,t)}))}function rb(e,t,n,i,a){for(var o=Math.min(n,i),r=Math.max(n,i),l=o;l<=r;l++)if(!ob(e,[a,l],t))return!1;return!0}function lb(e,t,n,i,a){for(var o=Math.min(n,i),r=Math.max(n,i),l=o;l<=r;l++)if(!ob(e,[l,a],t))return!1;return!0}function sb(e,t,n,i,a){var o=1===n?a.y:i.y,r=1===n?i.x:a.x;if(rb(e,t,i.y,a.y,r))for(;o>=0&&o<e.height&&ob(e,[i.x,o],t)&&ob(e,[a.x,o],t);){if(lb(e,t,i.x,a.x,o))return o;o+=n}return-1}function ub(e,t,n,i,a){var o=1===n?a.x:i.x,r=1===n?i.y:a.y;if(lb(e,t,i.x,a.x,r))for(;o>=0&&o<e.width&&ob(e,[o,i.y],t)&&ob(e,[o,a.y],t);){if(rb(e,t,i.y,a.y,o))return o;o+=n}return-1}function cb(e,t){return e.map((function(e){return{a:{x:e.a.x+t.x,y:e.a.y+t.y},b:{x:e.b.x+t.x,y:e.b.y+t.y}}}))}X._RF.pop(),X._RF.push({},"0cceagmIDZNoZTxP8hBPplh","Board",void 0);var db=Z.ccclass,hb=Z.property,pb=Z.requireComponent,yb=codex.monitorError,vb=Ludex.Utils,fb=vb.Array,gb=vb.Function,mb=vb.Valid,bb=m.Layout,wb=(Um=db("Board"),Gm=pb(ne),Hm=Yn.required(),qm=hb(Yg),Vm=Yn.required(),$m=hb(me),Wm=hb({displayName:"Tile Spacing",group:"Create config"}),Um(Km=Gm((Ym=a((jm=function(a){n(f,a);var r,u,d,h,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"tilePrefab",Ym,s(e)),l(e,"tilesHolder",Xm,s(e)),l(e,"tileTrim",Jm,s(e)),e.tileSize=[0,0],e.selectedTile=null,e.isPlayingEffect=!1,e.useRotatedGameplay=!1,e.dirtyGameplayRotation=!1,e.parsedGravityRules=[],e.normalMatches=0,e.normalMatchesSinceLastSpawn=0,e.spawnAttempts=0,e.hintPath=null,e.hintTiles=null,e.isAnimating=!1,e.animationQueue=[],e.isConsumingAnimation=!1,e.handleViewResized=gb.debounce((function(){if(!e.isPlayingEffect&&(e.updateTilesHolderScale(),e.levelData)){var t=e.shouldRotate(e.levelData);e.dirtyGameplayRotation=e.useRotatedGameplay!==t,e.dirtyGameplayRotation&&e.consumeAnimationQueue()}}),100),e}return e(f,[{key:"onLoad",value:function(){this.widget=this.getComponent(oe),this.uiTransform=this.getComponent(ne),Yn.validateRequiredProperties(this,f),this.tilePrefab.node.active=!1,this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"shouldRotate",value:function(e){return 0!==e.level&&e.rows>e.columns!==this.uiTransform.height>this.uiTransform.width}},{key:"create",value:(h=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();this.levelData=t,this.handleOrientationChanged(P.getCurrentLayout()),yield p.waitTweenAsync(0);var a=e.then((function(e){var n=A(e);fb.shuffle(n);var i=n.slice(0,t.colors);return null==yb||yb.addMetadata({frames:i.map((function(e){return e.name}))}),i})),o=fb.fillWith(t.colors,(function(e){return e}));this.useRotatedGameplay=this.shouldRotate(t)&&0!==this.levelData.level,this.parsedGravityRules=Zg(t.mode);var r=function(e){var t=qe(n.tilePrefab.node),i=t.getComponent(Yg);return i.setIdentity(e,a),n.tilesHolder.addChild(t),t.active=!0,i},l=!1;if(void 0!==t.customFen)try{l=!0,this.grid=bm({customFen:t.customFen,identities:o,createTile:r}),this.useRotatedGameplay&&(this.grid=Sm(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)}))}catch(e){console.error("Error creating grid from custom fen",e,"falling back to random grid"),l=!1}l||(this.grid=vm({levelData:t,seed:i,identities:o,createTile:r,setTileIdentity:function(e,t){return e.setIdentity(t,a)}}),this.useRotatedGameplay&&(this.grid=Sm(this.grid)),this.grid.each((function(e,t,n){e.setCoord(t,n),e.setIgnoreInput(!1),e.node.setSiblingIndex(0)})),Cm({grid:this.grid,setIdentity:function(e,t){return e.setIdentity(t,a)},seed:i}),pm(this.grid,t,i));var s=[this.tileTrim.x,this.tileTrim.y];this.tileSize=Jg(this.tilePrefab.getSize(),s),this.updateTilesHolderScale(),this.node.scene.emit(Js.GRID_CREATE,this),this.selectedTile=null,this.animationQueue=[],this.normalMatches=0,this.normalMatchesSinceLastSpawn=0,this.spawnAttempts=0,this.hintPath=null,this.processGameplayCycle()})),function(e,t){return h.apply(this,arguments)})},{key:"updateTilesHolderScale",value:function(){if(this.grid){var e=[this.grid.width,this.grid.height],t=[this.uiTransform.width,this.uiTransform.height],n=function(e,t,n){var i=k(e,2),a=i[0],o=i[1],r=k(t,2),l=r[0],s=r[1],u=k(n,2),c=u[0]/(a*l),d=u[1]/(o*s);return Math.min(Math.min(c,d),2.25)}(e,this.tilePrefab.getSize(),t);this.tilesHolder.setScale(n,n),this.node.scene.emit(Js.GRID_RESIZE,n)}}},{key:"destroyTiles",value:function(){var e;null===(e=this.grid)||void 0===e||e.each((function(e){return e.node.destroy()}))}},{key:"animateTilesAppear",value:function(){var e=this;if(!this.grid){var t=new Error("animateTilesAppear: Grid is not initialized");if(mb.isDebugger())throw t;return null==yb||yb.sendException(t),Promise.resolve()}var n=this.grid;return new Promise((function(t){var i=function(){var i=o((function*(){var i=function(t){return Xg(n,e.tileSize,t)};yield Promise.all(n.map((function(t,a,o){var r=Ge(0,.5),l=t.node.scale.clone(),s=function(t,n){var i,a=De.ZERO.clone(),o=c(e.parsedGravityRules);try{for(o.s();!(i=o.n()).done;){var r=i.value,l=e.useRotatedGameplay?Qg(r):r,s=e.getPrimitiveDirection(t,n,l);a.subtract2f(s.x,s.y)}}catch(e){o.e(e)}finally{o.f()}return a.normalize()}(a,o),u=Xg(n,e.tileSize,{x:a,y:o}),d=s.multiplyScalar(100).add2f(u.x,u.y);return t.node.setPosition(d.x,d.y),t.node.setScale(0,0),Promise.all([p.runTweenAsync(re(t.node).delay(r).to(.5,{scale:l},{easing:"elasticOut"})),t.sync({getTargetPosition:i,easing:"backOut",duration:.5,delay:r})])}))),t()}));return function(){return i.apply(this,arguments)}}();e.animationQueue.push(i),e.consumeAnimationQueue()}))}},{key:"animateTilesWave",value:function(){var e=this;if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesWave"),Promise.resolve();var t=this.grid;return new Promise((function(n){var i=function(){var e=o((function*(){var e=function(e,t){for(var n=t.x,i=t.y,a="center"===e?{x:(n-1)/2,y:(i-1)/2}:e,o=a.x,r=a.y,l=[],s=0;s<n;s++){for(var u=[],c=0;c<i;c++){var d=o-s,h=r-c,p=Math.sqrt(d*d+h*h);u.push(p)}l.push(u)}return l}("center",{x:t.width,y:t.height});yield Promise.all(t.map((function(t,n,i){var a,o,r=.1*(null!==(a=null===(o=e[n])||void 0===o?void 0:o[i])&&void 0!==a?a:0),l=t.node.scale.clone();return Promise.all([p.runTweenAsync(re(t.node).delay(r).to(.25,{scale:l.clone().multiplyScalar(1.2)},{easing:"quadOut"}).to(.25,{scale:l},{easing:"quadIn"}))])}))),n()}));return function(){return e.apply(this,arguments)}}();e.animationQueue.push(i),e.consumeAnimationQueue()}))}},{key:"animateTilesError",value:(d=o((function*(e){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesError"),Promise.resolve();this.isAnimating||(this.isAnimating=!0,yield Promise.all(e.map((function(e){return e.moveAround()}))),this.isAnimating=!1)})),function(e){return d.apply(this,arguments)})},{key:"handleTileClick",value:function(e){if(!e.isHidden()){if(this.selectedTile===e)return w.playSound(Qi.TILE_SELECT),this.selectedTile=null,void e.setFocused(!1);if(!this.selectedTile)return w.playSound(Qi.TILE_SELECT),this.selectedTile=e,void e.setFocused(!0);if(!this.selectedTile.isSimilarTo(e))return w.playSound(Qi.TILE_SELECT),this.selectedTile.setFocused(!1),this.selectedTile=e,void e.setFocused(!0);this.selectedTile.setFocused(!1),this.match(this.selectedTile,e),this.selectedTile=null}}},{key:"clearSelectedTile",value:function(){this.selectedTile&&(this.selectedTile.setFocused(!1),this.selectedTile=null)}},{key:"match",value:function(e,t){if(this.grid&&this.levelData){var n=[e.getCoord().x,e.getCoord().y],i=[t.getCoord().x,t.getCoord().y],a=tb(this.grid,n,i);if(null===a){w.playSound(Qi.INVALID_MATCH),this.animateTilesError([e,t]);var o=0===this.levelData.level,r=function(e,t,n,i){if(i){var a=Em[4].startTile,o=Em[4].endTile;if(t[0]===a.x&&t[1]===a.y&&n[0]===o.x&&n[1]===o.y)return[{a:a,b:o}];if(t[0]===o.x&&t[1]===o.y&&n[0]===a.x&&n[1]===a.y)return[{a:a,b:o}]}return Dm(e,t,n)}(this.grid,n,i,o);return this.node.scene.emit(Js.GRID_MATCH,[e,t]),void this.node.scene.emit(Js.GRID_MATCH_FAIL,r)}w.playSound(Qi.TILE_MATCH),this.node.scene.emit(Js.GRID_MATCH,[e,t]),this.node.scene.emit(Js.GRID_MATCH_SUCCESS,a,[e,t]),this.clear({pairs:[[e,t]]})}else this.reportOrThrowInDebugger("Grid is not initialized","match")}},{key:"clear",value:function(e){var t=this,n=e.pairs,i=e.stagger,a=void 0===i?0:i,o=e.delay,r=void 0===o?0:o,l=e.lightning,s=void 0!==l&&l;this.normalMatches+=n.length;for(var u=0;u<n.length;u++){var c=n[u],d=k(c,2),h=d[0],y=d[1],v=a?2*u*a:0,f=a?(2*u+1)*a:0;h.setEmpty(),y.setEmpty(),h.playClearFX(v,s),y.playClearFX(f,s),this.node.scene.emit(Js.GRID_CLEAR,[h,y])}p.waitTweenAsync(r).then((function(){t.processGameplayCycle()}))}},{key:"clearUsingOldLightningFX",value:function(e){this.normalMatches+=e.length;var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=k(i,2),o=a[0],r=a[1];o.setEmpty(),r.setEmpty(),o.playOldLightningClearFX(),r.playOldLightningClearFX(),this.node.scene.emit(Js.GRID_CLEAR,[o,r])}}catch(e){n.e(e)}finally{n.f()}this.processGameplayCycle()}},{key:"showHint",value:function(){if(this.hintPath){var e=this.hintPath[0],t=this.hintPath[this.hintPath.length-1];if(e&&t){var n=e.a,i=t.b,a=this.getTileAt(n.x,n.y),o=this.getTileAt(i.x,i.y);a&&o?(a.setHint(!0),o.setHint(!0),this.hintTiles=[a,o]):this.reportOrThrowInDebugger("Hint tiles are not valid","showHint")}else this.reportOrThrowInDebugger("Hint path is not valid","showHint")}}},{key:"hideHint",value:function(){if(this.hintTiles){var e=k(this.hintTiles,2),t=e[0],n=e[1];t.setHint(!1),n.setHint(!1),this.hintTiles=null}}},{key:"getHintPath",value:function(){return this.hintPath}},{key:"getTileAt",value:function(e,t){return this.grid&&this.grid.isInBounds(e,t)?this.grid.get(e,t):null}},{key:"getAnyTileWorldPosition",value:function(e,t){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getAnyTileWorldPosition"),{x:0,y:0};var n=Xg(this.grid,this.tileSize,{x:e,y:t});this.tilePrefab.node.setPosition(n.x,n.y);var i=this.tilePrefab.node.getWorldPosition();return{x:i.x,y:i.y}}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getGridSize",value:function(){return this.grid?[this.grid.width,this.grid.height]:(this.reportOrThrowInDebugger("Grid is not initialized","getGridSize"),[0,0])}},{key:"getUncleared",value:function(){return this.grid?tm(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getUncleared"),[])}},{key:"getCleared",value:function(){return this.grid?nm(this.grid):(this.reportOrThrowInDebugger("Grid is not initialized","getCleared"),[])}},{key:"getBombTiles",value:function(){return this.grid?tm((e=this.grid)instanceof Hg?e.asArray():e).filter((function(e){var t;return(null===(t=e.special)||void 0===t?void 0:t.type)===M.bomb})):(this.reportOrThrowInDebugger("Grid is not initialized","getBombTiles"),[]);var e}},{key:"getPairs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPairs"),[];for(var n=[],i=t?tm(this.grid):nm(this.grid),a=function(){var e=lm(i),t=k(e,2),a=t[0],o=t[1];n.push([a,o]),i=i.filter((function(e){return e!==a&&e!==o}))};n.length<e;)a();return n}},{key:"getBoundingBoxWorld",value:function(){var e=this.tilesHolder.getWorldScale().x,t=this.getGridSize(),n=this.tileSize[0]*e*t[0],i=this.tileSize[1]*e*t[1],a=this.node.getWorldPosition().subtract3f(n/2,i/2,0);return new Ie.Rect(a.x,a.y,n,i)}},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this.grid)||void 0===e||e.each((function(e){return e.setIgnoreInput(t)}))}},{key:"processShuffleRequest",value:function(e){if(this.grid){var t=this.processShuffleStep(this.grid,!0,e);this.grid=t[0],this.hintPath=t[1],this.consumeAnimationQueue()}else this.reportOrThrowInDebugger("Grid is not initialized","processShuffleRequest")}},{key:"generateFenFromCurrentLevel",value:function(e){var t;return this.levelData||this.reportOrThrowInDebugger("Level data is not initialized","generateFenFromCurrentLevel"),f.generateFen(null!==(t=null!=e?e:this.levelData)&&void 0!==t?t:mf)}},{key:"listenEvents",value:function(){se.on(y.VIEW_RESIZED,this.handleViewResized),se.on(y.WIDGET_RESIZED,this.handleViewResized),se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.on(Js.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.on(Js.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"unlistenEvents",value:function(){se.off(y.VIEW_RESIZED,this.handleViewResized),se.off(y.WIDGET_RESIZED,this.handleViewResized),se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.node.scene.off(Js.EFFECTS_ANIMATION_START,this.onEffectAnimStarted,this),this.node.scene.off(Js.EFFECTS_ANIMATION_END,this.onEffectAnimEnded,this)}},{key:"onEffectAnimStarted",value:function(){this.isPlayingEffect=!0}},{key:"onEffectAnimEnded",value:function(){this.isPlayingEffect=!1,this.handleOrientationChanged(P.getCurrentLayout()),this.handleViewResized()}},{key:"getWidgetMargins",value:function(e){return e!==bb.Landscape||void 0!==this.levelData&&0===this.levelData.level?{top:160,bottom:160,left:20,right:20}:{top:80,bottom:80,left:640,right:60}}},{key:"handleOrientationChanged",value:function(e){if(!this.isPlayingEffect){var t=this.getWidgetMargins(e),n=t.top,i=t.bottom,a=t.left,o=t.right;this.widget.top=n,this.widget.bottom=i,this.widget.left=a,this.widget.right=o}}},{key:"processGameplayCycle",value:function(){if(this.node.activeInHierarchy&&this.grid&&this.levelData){var e=tm(this.grid);if(0!==e.length){var t=this.grid,n=e.length>=2&&this.spawnAttempts<this.levelData.rules.addRandomTilesPerMove&&this.normalMatches>=5,i=this.normalMatchesSinceLastSpawn>=2;n&&(i?(this.spawnAttempts++,this.normalMatchesSinceLastSpawn=0,this.processSpawnStep()):this.normalMatchesSinceLastSpawn++),e.length%2==1&&this.processSpawnSingleTileStep(),e.length>14&&(t=this.processGravitationStep(t));var a=this.processShuffleStep(t);this.consumeAnimationQueue(),this.grid=a[0],this.hintPath=a[1]}}else this.reportOrThrowInDebugger("Grid is not initialized","processGameplayCycle")}},{key:"processSpawnStep",value:function(){var e,t;if(this.grid){var n=dm(nm(this.grid),2),i=k(n,2),a=i[0],o=i[1],r=null!==(e=null==a?void 0:a.id)&&void 0!==e?e:void 0,l=null!==(t=null==a?void 0:a.frames)&&void 0!==t?t:void 0;void 0!==a&&void 0!==r&&void 0!==l&&void 0!==o?(a.restore(),o.restore(r,l),this.node.scene.emit(Js.GRID_SPAWN,[a,o])):this.reportOrThrowInDebugger("Failed to get random tiles","processSpawnStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnStep")}},{key:"processGravitationStep",value:function(e){var t,n=this,i=e,a=[],r=c(this.parsedGravityRules);try{var l=function(){var e=t.value,r=n.useRotatedGameplay?Qg(e):e,l=xm(i=n.toGravitated(i,r));if(0===l.length)return 1;var s,u=c(l);try{for(u.s();!(s=u.n()).done;){var d=k(s.value,2),h=d[0],p=k(d[1],2),y=p[0],v=p[1];h.setCoord(y,v)}}catch(e){u.e(e)}finally{u.f()}i.each((function(e){e.node.setSiblingIndex(0)}));var f=function(){var e=o((function*(){yield Promise.all(l.map((function(e){var t=k(e,2),a=t[0],o=k(t[1],2),r=o[0],l=o[1];return a.sync({delay:.25,duration:.25,getTargetPosition:function(){return Xg(i,n.tileSize,{x:r,y:l})}})})))}));return function(){return e.apply(this,arguments)}}();a.push(f)};for(r.s();!(t=r.n()).done;)l()}catch(e){r.e(e)}finally{r.f()}var s=function(){var e=o((function*(){for(var e=0,t=a;e<t.length;e++){var n=t[e];yield n()}}));return function(){return e.apply(this,arguments)}}();return this.animationQueue.push(s),i}},{key:"toGravitated",value:function(e,t){var n=new Hg(e),i=e.height-1,a=e.width-1,o=[0,i],r=[0,a],l=Math.floor(e.height/2),s=Math.floor(e.width/2),u=function(e){return e.isHidden()};switch(t){case Bv:n.gravitate({rowRange:o,colRange:r,direction:Fv.Down,isLighter:u});break;case xv:n.gravitate({rowRange:o,colRange:r,direction:Fv.Up,isLighter:u});break;case zv:n.gravitate({rowRange:o,colRange:r,direction:Fv.Left,isLighter:u});break;case Uv:n.gravitate({rowRange:o,colRange:r,direction:Fv.Right,isLighter:u});break;case Gv:n.gravitate({rowRange:o,colRange:[s,a],direction:Fv.Left,isLighter:u,out:n.gravitate({rowRange:o,colRange:[0,s-1],direction:Fv.Right,isLighter:u})});break;case Hv:n.gravitate({rowRange:[l,i],colRange:r,direction:Fv.Down,isLighter:u,out:n.gravitate({rowRange:[0,l-1],colRange:r,direction:Fv.Up,isLighter:u})})}return n}},{key:"getPrimitiveDirection",value:function(e,t,n){if(!this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPrimitiveDirection"),Fv.Down;var i=Math.floor(this.grid.height/2),a=Math.floor(this.grid.width/2);switch(n){case Bv:return Fv.Down;case xv:return Fv.Up;case zv:return Fv.Left;case Uv:return Fv.Right;case Gv:return e>=a?Fv.Left:Fv.Right;case Hv:return t>=i?Fv.Down:Fv.Up}}},{key:"processShuffleStep",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,o=tb(e),r=tm(e).map((function(e){var t=e.getCoord();return[t.x,t.y]}));if(null!==o&&!i)return[e,o];var l=100;do{var s=e.toShuffled(r),u=k(s,1);o=tb(n=u[0]),l--}while(null===o&&l>0);if(l<=0){var d,h,p,y,v=n.asArray().map((function(e){var t;return{name:e.id,type:null===(t=e.special)||void 0===t?void 0:t.type,active:!e.isHidden()}}));return null==yb||yb.sendException(new Error("No paths found after 100 shuffle attempts"),{message:"No paths found after 100 shuffle attempts",level:null===(d=this.levelData)||void 0===d?void 0:d.level,rules:null===(h=this.levelData)||void 0===h?void 0:h.rules,mode:null===(p=this.levelData)||void 0===p?void 0:p.mode,gridAsArray:v}),this.node.scene.emit(Js.GAME_EXIT),[e,null!==(y=o)&&void 0!==y?y:[]]}var f,g=xm(n),m=c(g);try{for(m.s();!(f=m.n()).done;){var b=k(f.value,2),w=b[0],S=k(b[1],2),C=S[0],E=S[1];w.setCoord(C,E)}}catch(e){m.e(e)}finally{m.f()}var A=void 0!==a?function(){return a(e,n)}:this.createShuffleAnimationHandler(e,n);return this.animationQueue.push(A),[n,null!==(t=o)&&void 0!==t?t:[]]}},{key:"createShuffleAnimationHandler",value:function(e,t){var n=this,i=function(){var i=o((function*(){yield Promise.all(e.map((function(e,i,a){return e.sync({duration:.3,easing:"smooth",getTargetPosition:function(){return Xg(t,n.tileSize,{x:i,y:a},10)}})})))}));return function(){return i.apply(this,arguments)}}(),a=function(){var e=o((function*(){t.each((function(e){e.node.setSiblingIndex(0)})),yield Promise.all(t.map((function(e){return e.sync({duration:.4,easing:"smooth",delay:Ge(0,.2),getTargetPosition:function(e){return Xg(t,n.tileSize,e)}})})))}));return function(){return e.apply(this,arguments)}}();return function(){var e=o((function*(){yield i(),yield a()}));return function(){return e.apply(this,arguments)}}()}},{key:"processSpawnSingleTileStep",value:function(){if(this.grid){var e,t=dm(nm(this.grid),1),n=k(t,1)[0],i=tm(this.grid),a={},o=c(i);try{for(o.s();!(e=o.n()).done;){var r,l=e.value.id;null!==l&&(a[l]=(null!==(r=a[l])&&void 0!==r?r:0)+1)}}catch(e){o.e(e)}finally{o.f()}var s=fb.search(i,(function(e){var t=e.id;if(null===t)return!1;var n=a[t];return void 0!==n&&n%2==1}));n&&s&&null!==s.id?(n.restore(s.id,s.frames),this.node.scene.emit(Js.GRID_SPAWN,[n])):this.reportOrThrowInDebugger("Failed to get a random tile","processSpawnSingleTileStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnSingleTileStep")}},{key:"consumeAnimationQueue",value:(u=o((function*(){if(!this.isConsumingAnimation){for(this.isConsumingAnimation=!0;this.animationQueue.length>0;){if(0===this.getUncleared().length){this.animationQueue=[];break}var e=this.animationQueue.shift();yield null==e?void 0:e()}for(;this.dirtyGameplayRotation&&void 0!==this.levelData;)this.dirtyGameplayRotation=!1,this.shouldRotate(this.levelData)!==this.useRotatedGameplay&&(yield this.updateGameplayRotation());this.isConsumingAnimation=!1}})),function(){return u.apply(this,arguments)})},{key:"updateGameplayRotation",value:(r=o((function*(){var e=this;if(this.levelData){var t=this.shouldRotate(this.levelData),n=this.useRotatedGameplay&&!t;if(this.useRotatedGameplay=t,this.grid&&this.levelData&&this.hintPath){this.node.scene.emit(Js.GRID_ORIENTATION_CHANGE,this.useRotatedGameplay),this.hintPath=function(e,t,n){var i,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],r=c(n);try{for(r.s();!(i=r.n()).done;){var l=i.value,s=l.a,u=l.b,d=em(s,e,t,a),h=em(u,e,t,a);o.push({a:d,b:h})}}catch(e){r.e(e)}finally{r.f()}return o}(this.grid.width,this.grid.height,this.hintPath,n),this.setIgnoreInput(!0);var i=Sm(this.grid,n);this.grid=i,this.updateTilesHolderScale(),yield Promise.all(i.map((function(t){return t.sync({delay:.3,duration:.3,easing:"quartInOut",getTargetPosition:function(){return Xg(i,e.tileSize,t.getCoord(),10)}})}))),i.each((function(e){e.node.setSiblingIndex(0)})),yield Promise.all(i.map((function(t){return t.sync({duration:.2,easing:"sineInOut",getTargetPosition:function(){return Xg(i,e.tileSize,t.getCoord())}})}))),this.setIgnoreInput(!1)}}})),function(){return r.apply(this,arguments)})},{key:"clearAnimationQueue",value:function(){this.isConsumingAnimation=!1,this.animationQueue=[]}},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if(mb.isDebugger())throw n;null==yb||yb.sendException(n)}}],[{key:"generateFen",value:function(e){for(var t=e,n=[],i=0;i<t.colors;i++)n.push(i+1);var a=Date.now(),o=vm({levelData:t,seed:a,identities:n,setTileIdentity:function(e,t){return e.setIdentity(t)},createTile:function(e){var t=e,n=void 0,i=new De(0,0);return{get id(){return t},get special(){return n},get coord(){return i},setIdentity:function(e){t=e},isHidden:function(){return!1},setSpecialType:function(e){n={type:e}},setCoord:function(e,t){return i.set(e,t)},getCoord:function(){return i},isSimilarTo:function(e){return e.id===t},inSamePositionAs:function(e){return e.getCoord().equals(i)}}}});return o.each((function(e,t,n){e.setCoord(t,n)})),Cm({grid:o,seed:a,setIdentity:function(e,t){return e.setIdentity(t)}}),pm(o,t,a),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bm,n=e.width,i=e.height,a=[],o=new Map,r=i-1;r>=0;r--){for(var l=[],s=0;s<n;s++){var u,c,d=e.get(s,r),h=d.isHidden()?null:d.id;if(null!==h){var p=t[null!==(u=null===(c=d.special)||void 0===c?void 0:c.type)&&void 0!==u?u:M.none];if(!o.has(h)){var y=o.size.toString();o.set(h,y)}var v="".concat(p).concat(o.get(h));l.push(v)}else l.push(".")}a.push(l.join(""))}return{code:a.join(":"),idSize:o.size,encoding:t,rows:i,cols:n}}(o)}}]),f}(te)).prototype,"tilePrefab",[Hm,qm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xm=a(jm.prototype,"tilesHolder",[Vm,$m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jm=a(jm.prototype,"tileTrim",[Wm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new De(.025,.1)}}),Km=jm))||Km)||Km);X._RF.pop(),X._RF.push({},"f7e1byg/txJGqnuJJ7xQV1M","withItemAnalytics",void 0);var Sb=Ludex.Plugins.Analytics,kb=(void 0===Sb?{}:Sb).Events,Cb=codex.analytics,Eb=function(e,t){return function(){return kb&&Cb.event(kb.USE_ITEM,{item_name:e}),t.apply(void 0,arguments)}};X._RF.pop(),X._RF.push({},"bc704Yz8bdJzYja7TsWcGMN","useHintItem",void 0);var Ab=Eb(_.PLIERS,(function(e,t){if(!t.isDrawingHint){var n=e.getHintPath();null!==n&&(w.playSound(Qi.HINT_ITEM),t.drawHintPath(n,(function(t){return e.getAnyTileWorldPosition(t.x,t.y)})),e.showHint())}}));X._RF.pop(),X._RF.push({},"0a2423JE25HLIm5td77YE7e","usePliersItem",void 0);var Tb=Eb(_.PLIERS,(function(e,t){var n,i=om(e.getBombTiles()),a=i.node.worldPosition;t.createDefuseExplosionAt(a.x,a.y),w.playSound(Qi.BOMB_DEFUSE),null===(n=i.special)||void 0===n||n.switch(M.none)}));X._RF.pop(),X._RF.push({},"004c93sHsBHnpww25v/ilqP","withBlockedInput",void 0);X._RF.pop(),X._RF.push({},"33523Q0FqxMp6H+SNCi8//7","withCenteredBoard",void 0);var Pb=function(e,t){return o((function*(){var n=e.widget,i=n.left,a=n.right,o=(i+a)/2;yield p.runTweenAsync(re(e.widget).to(.2,{left:o,right:o},{easing:"cubicOut"}));var r=yield t.apply(void 0,arguments),l=e.getWidgetMargins(P.getCurrentLayout()),s=l.top,u=l.bottom,c=l.left,d=l.right;return yield p.runTweenAsync(re(e.widget).to(.2,{top:s,bottom:u,left:c,right:d},{easing:"cubicOut"})),r}))};X._RF.pop(),X._RF.push({},"975e3Ao0kxHW6RlBkPl5kbh","withEffectAnimationEvents",void 0);var Lb=function(e,t){return o((function*(){e.node.scene.emit(Js.EFFECTS_ANIMATION_START);var n=yield t.apply(void 0,arguments);return e.node.scene.emit(Js.EFFECTS_ANIMATION_END),n}))};X._RF.pop(),X._RF.push({},"d2cd0VZLwhNMJwc3ppHvOtA","withLoweredVolume",void 0);var Ob=function(e){return o((function*(){w.setVolumeMusic(0,!0);var t=yield e.apply(void 0,arguments);return w.setVolumeMusic(.3,!0),t}))};X._RF.pop(),X._RF.push({},"a62ebriH15FfI8l0x1GBX1p","useThunderItem",void 0);var Ib,Rb=function(){var e=o((function*(e,t){if(!(e.getUncleared().length<4)){var n=e.getPairs(2),i=Lb(e,Pb(e,Db));e.clearSelectedTile(),yield i(t,n,e)}}));return function(t,n){return e.apply(this,arguments)}}(),_b=Eb(_.THUNDER,Ob((Ib=Rb,o((function*(){F.setBlockInput(!0);var e=yield Ib.apply(void 0,arguments);return F.setBlockInput(!1),e})))));function Db(e,t,n){return e.playThunderAnimation(t,n)}X._RF.pop(),X._RF.push({},"0e50bRTLUtMgYDDkS0nbFm5","useTornadoItem",void 0);var Nb,Mb=Ludex.Utils.Function,Fb=function(){var e=o((function*(e,t){var n=yield Mb.allSettled(e.map((function(n,i,a){return n.sync({duration:.4,easing:"smooth",getTargetPosition:function(){return Xg(e,t,{x:i,y:a},10)}})})));n.some((function(e){return"rejected"===e.status}))&&console.error("Error playing padding animation",n.filter((function(e){return"rejected"===e.status})))}));return function(t,n){return e.apply(this,arguments)}}(),Bb=function(){var e=o((function*(e,t){var n=e.asArray().length;e.each((function(t,i,a){t.node.setSiblingIndex(n-1-(i+a*e.width))}));var i=yield Mb.allSettled(e.map((function(n){return n.fly({getTilePosition:function(n){return Xg(e,t,n)}})})));i.some((function(e){return"rejected"===e.status}))&&console.error("Error playing shuffle animation",i.filter((function(e){return"rejected"===e.status})))}));return function(t,n){return e.apply(this,arguments)}}(),xb=function(){var e=o((function*(e,t,n,i){w.playSound(Qi.SHUFFLE_ITEM),w.playSound(Qi.WIND),yield Fb(e,n()),i(),yield Bb(t,n())}));return function(t,n,i,a){return e.apply(this,arguments)}}(),zb=function(){var e=o((function*(e,t){var n=function(){return e.getTileSize()},i=function(){return t.playTornadoAnimation()},a=Lb(e,Pb(e,Ob((function(e,t){return xb(e,t,n,i)}))));return new Promise((function(t){e.processShuffleRequest(function(){var n=o((function*(n,i){e.clearSelectedTile(),yield a(n,i),t()}));return function(e,t){return n.apply(this,arguments)}}())}))}));return function(t,n){return e.apply(this,arguments)}}(),Ub=Eb(_.THUNDER,Ob(zb));X._RF.pop(),X._RF.push({},"c92ec8pmUJGbrL9PLjum+i5","Line",void 0);var Gb=(0,Z.ccclass)("Line")(Nb=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(ne)}},{key:"setPoints",value:function(e,t){this.node.setWorldPosition((e.x+t.x)/2,(e.y+t.y)/2,0),this.uiTransform.width=De.distance(e,t)+10,this.uiTransform.width/=this.node.worldScale.x;var n=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI;this.node.eulerAngles=new be(0,0,n)}}]),r}(te))||Nb;X._RF.pop(),X._RF.push({},"1e7cch8i/5DkYHOwJowrjeg","AFPool",void 0);var Hb,qb,Vb,$b,Wb,Kb,jb,Yb,Xb,Jb,Zb,Qb=function(a){n(r,a);var o=i(r);function r(e,n,i,a,l){var s;return t(this,r),(s=o.call(this,e,n,l)).ator=i,s.ftor=a,s}return e(r,[{key:"alloc",value:function(){var e=d(h(r.prototype),"alloc",this).call(this);return this.ator&&this.ator(e),e}},{key:"free",value:function(e){this.ftor&&this.ftor(e),d(h(r.prototype),"free",this).call(this,e)}}]),r}(Ve);X._RF.pop(),X._RF.push({},"6f7a1msxIxIbYLx5PpbL/BZ","PathDrawer",void 0);var ew,tw,nw,iw,aw,ow,rw,lw,sw,uw=Z.ccclass,cw=Z.property,dw=(Hb=uw("PathDrawer"),qb=cw({group:"Line",displayName:"Prefab",type:$e}),Vb=cw({group:"Line",displayName:"Holder",type:me,tooltip:"Line Prefab"}),$b=cw({group:"Point",displayName:"Prefab",type:$e}),Wb=cw({group:"Point",displayName:"Holder",type:me}),Hb((Yb=a((jb=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"linePrefab",Yb,s(e)),l(e,"lineHolder",Xb,s(e)),e.lineNodes=[],l(e,"pointPrefab",Jb,s(e)),l(e,"pointHolder",Zb,s(e)),e.pointNodes=[],e}return e(r,[{key:"start",value:function(){var e=this;this.linePool=new Qb((function(){var t=qe(e.linePrefab);return e.lineHolder.addChild(t),t.parent=e.lineHolder,t.active=!1,t}),0,(function(t){e.lineNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()})),this.pointPool=new Qb((function(){var t=qe(e.pointPrefab);return e.pointHolder.addChild(t),t.active=!1,t}),0,(function(t){e.pointNodes.push(t),t.active=!0}),(function(e){e.active=!1}),(function(e){e.isValid&&e.destroy()}))}},{key:"drawPath",value:function(e){this.clearPath();var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value;null===(i=this.linePool.alloc().getComponent(Gb))||void 0===i||i.setPoints(a.a,a.b)}}catch(e){n.e(e)}finally{n.f()}}},{key:"clearPath",value:function(){var e,t=c(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.linePool.free(n)}}catch(e){t.e(e)}finally{t.f()}this.lineNodes=[];var i,a=c(this.pointNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.pointPool.free(o)}}catch(e){a.e(e)}finally{a.f()}this.pointNodes=[]}}]),r}(te)).prototype,"linePrefab",[qb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xb=a(jb.prototype,"lineHolder",[Vb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jb=a(jb.prototype,"pointPrefab",[$b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zb=a(jb.prototype,"pointHolder",[Wb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kb=jb))||Kb);X._RF.pop(),X._RF.push({},"5cc7bAmTI1JL7nwLzZcp45u","ErrorDrawer",void 0);var hw,pw,yw,vw,fw=Z.ccclass,gw=Z.property,mw=(ew=fw("ErrorDrawer"),tw=gw(xe),nw=gw(xe),iw=gw(xe),ew((rw=a((ow=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"one",rw,s(e)),l(e,"two",lw,s(e)),l(e,"error",sw,s(e)),e}return e(r,[{key:"start",value:function(){d(h(r.prototype),"start",this).call(this),this.pathAppearDuration=0}},{key:"drawPath",value:function(e){var t=this;if(this.clearPath(),e.forEach((function(n,i){var a;if(null===(a=t.linePool.alloc().getComponent(Gb))||void 0===a||a.setPoints(n.a,n.b),0!==i){var o=t.pointPool.alloc();o.setWorldPosition(new be(n.a.x,n.a.y,0));var r=o.getComponent(he);1===i&&e.length>3?r.spriteFrame=t.one:2===i&&e.length>3?r.spriteFrame=t.two:r.spriteFrame=t.error}})),1===e.length){var n=this.pointPool.alloc();n.setWorldPosition(new be(e[0].a.x+e[0].b.x,e[0].a.y+e[0].b.y,0).multiplyScalar(.5)),n.getComponent(he).spriteFrame=this.error}this.pathAppearDuration=.8}},{key:"update",value:function(e){this.pathAppearDuration>0&&(this.pathAppearDuration-=e,this.pathAppearDuration<=0&&this.clearPath())}}]),r}(dw)).prototype,"one",[tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lw=a(ow.prototype,"two",[nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sw=a(ow.prototype,"error",[iw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aw=ow))||aw);X._RF.pop(),X._RF.push({},"880e8aL9NFPj68zH2xVRIFR","HintDrawer",void 0);var bw,ww,Sw,kw,Cw=(hw=(0,Z.ccclass)("HintDrawer"),pw=Yn.onlyRunInLifeCycle,hw((a((vw=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"drawPath",value:function(e){this.clearPath(),this.createPath(e),this.showPath()}},{key:"createPath",value:function(e){if(0!==e.length){var t=e.length-1;if(!(t<0)){var n=e[t];if(n){var i,a=c(e);try{for(a.s();!(i=a.n()).done;){var o,r=i.value;null===(o=this.linePool.alloc().getComponent(Gb))||void 0===o||o.setPoints(r.a,r.b),this.pointPool.alloc().setWorldPosition(r.a.x,r.a.y,0)}}catch(e){a.e(e)}finally{a.f()}this.pointPool.alloc().setWorldPosition(n.b.x,n.b.y,0)}}}}},{key:"showPath",value:function(){var e,t=c(this.lineNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value.getComponent(de);n.opacity=0,re(n).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){t.e(e)}finally{t.f()}var i,a=c(this.pointNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value.getComponent(de);o.opacity=0,re(o).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(e){a.e(e)}finally{a.f()}}},{key:"clearPath",value:function(){var e,t=this,n=c(this.lineNodes);try{var i=function(){var n=e.value,i=n.getComponent(de),a=re(i).to(.15,{opacity:0});p.runTweenAsync(a).then((function(){t.node.activeInHierarchy&&(i.opacity=255,t.linePool.free(n))}))};for(n.s();!(e=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}var a,o=c(this.pointNodes);try{var r=function(){var e=a.value,n=e.getComponent(de),i=re(n).to(.15,{opacity:0});p.runTweenAsync(i).then((function(){t.node.activeInHierarchy&&(n.opacity=255,t.pointPool.free(e))}))};for(o.s();!(a=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}this.lineNodes=[],this.pointNodes=[]}}]),r}(dw)).prototype,"clearPath",[pw],Object.getOwnPropertyDescriptor(vw.prototype,"clearPath"),vw.prototype),yw=vw))||yw);X._RF.pop(),X._RF.push({},"25f67BW5/5Jzox4v+yBBbyS","MatchDrawer",void 0);var Ew,Aw,Tw,Pw,Lw,Ow,Iw,Rw,_w,Dw=(bw=(0,Z.ccclass)("MatchDrawer"),ww=Yn.onlyRunInLifeCycleAsync,bw((a((kw=function(a){n(u,a);var r,l,s=i(u);function u(){return t(this,u),s.apply(this,arguments)}return e(u,[{key:"drawPath",value:function(e){var t=this;if(0!==e.length){var n=e.length-1;if(!(n<0)){var i=e[n];if(i){e.forEach((function(e,n){var i,a=t.linePool.alloc();null===(i=a.getComponent(Gb))||void 0===i||i.setPoints(e.a,e.b),t.animateLine(a);var o=t.pointPool.alloc();o.setWorldPosition(e.a.x,e.a.y,0),t.animatePoint(o,n)}));var a=this.pointPool.alloc();a.setWorldPosition(i.b.x,i.b.y,0),this.animatePoint(a,e.length)}}}}},{key:"animateLine",value:(l=o((function*(e){var t=e.getComponent(de);t.opacity=0;var n=re(t).to(.25,{opacity:255},{easing:"quadOut"}).delay(.1).to(.2,{opacity:0});yield p.runTweenAsync(n),t.opacity=255,this.linePool.free(e)})),function(e){return l.apply(this,arguments)})},{key:"animatePoint",value:(r=o((function*(e,t){e.scale=be.ZERO;var n=re(e).delay(.03*t).to(.2,{scale:be.ONE},{easing:"quadOut"}).delay(.1).to(.2,{scale:be.ZERO},{easing:"backIn"});yield p.runTweenAsync(n),this.node.activeInHierarchy&&this.pointPool.free(e)})),function(e,t){return r.apply(this,arguments)})},{key:"clearPath",value:function(){this.lineNodes=[],this.pointNodes=[]}}]),u}(dw)).prototype,"animatePoint",[ww],Object.getOwnPropertyDescriptor(kw.prototype,"animatePoint"),kw.prototype),Sw=kw))||Sw);X._RF.pop(),X._RF.push({},"bfdf2THr9lPJ4TOVDN8VgE4","PathDraw",void 0);var Nw,Mw=Z.ccclass,Fw=Z.property,Bw=(Ew=Mw("PathDraw"),Aw=Fw({group:{name:"Path Drawer"},type:Dw}),Tw=Fw({group:{name:"Path Drawer"},type:Cw}),Pw=Fw({group:{name:"Path Drawer"},type:mw}),Ew((Iw=a((Ow=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"matchPath",Iw,s(e)),l(e,"hintPath",Rw,s(e)),l(e,"errorPath",_w,s(e)),e.isDrawingHint=!1,e}return e(r,[{key:"onLoad",value:function(){var e=this;this.node.scene.on(Js.GRID_RESIZE,(function(t){e.node.setScale(t,t),e.node.position=e.board.node.position.clone()}))}},{key:"init",value:function(e){this.board=e}},{key:"drawMatchPath",value:function(e,t){var n,i=e.map((function(e){return u({},e)})),a=c(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.matchPath.drawPath(i)}},{key:"clearMatchPath",value:function(){this.matchPath.clearPath()}},{key:"drawHintPath",value:function(e,t){if(!this.isDrawingHint){this.isDrawingHint=!0;var n,i=e.map((function(e){return u({},e)})),a=c(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.hintPath.drawPath(i)}}},{key:"clearHintPath",value:function(){this.isDrawingHint&&(this.isDrawingHint=!1,this.hintPath.clearPath())}},{key:"drawErrorPath",value:function(e,t){var n,i=e.map((function(e){return u({},e)})),a=c(i);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.a=t(o.a),o.b=t(o.b)}}catch(e){a.e(e)}finally{a.f()}this.errorPath.drawPath(i)}}]),r}(te)).prototype,"matchPath",[Aw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rw=a(Ow.prototype,"hintPath",[Tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_w=a(Ow.prototype,"errorPath",[Pw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=Ow))||Lw);X._RF.pop(),X._RF.push({},"1a5c0RyWQJOipSvNtPLsTHS","ClockManager",void 0);var xw,zw,Uw,Gw,Hw,qw,Vw,$w,Ww,Kw,jw,Yw,Xw,Jw,Zw,Qw,eS,tS,nS=Z.ccclass,iS=Z.disallowMultiple,aS=nS("ClockManager")(Nw=iS(Nw=function(a){n(s,a);var r,l=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=l.call.apply(l,[this].concat(i))).time=0,e.remaining=0,e.running=!1,e.halfTime=!1,e}return e(s,[{key:"onLoad",value:function(){this.node.scene.on(Js.RESCUE_START,this.refillTime,this)}},{key:"init",value:function(){this.running=!1,this.halfTime=!1}},{key:"setTime",value:function(e){this.time=e,this.remaining=e,this.node.scene.emit(Js.TIME_UPDATED,this.remaining)}},{key:"getRemainingTime",value:function(){return this.remaining}},{key:"startCountdown",value:function(){this.running=!0,this.remaining=this.time}},{key:"pause",value:function(){this.running=!1}},{key:"resume",value:function(){this.running=!0}},{key:"endCountDown",value:function(){this.running=!1,this.remaining=0,this.node.scene.emit(Js.TIME_OUT)}},{key:"update",value:function(e){this.running&&(this.remaining<=0?this.endCountDown():(this.remaining-=e,!this.halfTime&&this.remaining<=this.time/2&&(this.halfTime=!0,this.node.scene.emit(Js.HALF_TIME)),this.remaining>=0&&this.node.scene.emit(Js.TIME_UPDATED,this.remaining)))}},{key:"refillTime",value:(r=o((function*(){var e=this,t=re(this.node).to(3,{},{onUpdate:function(t,n){if(n){var i=Ie.lerp(0,120,n);e.setTime(i)}}});yield p.runTweenAsync(t),this.setTime(120),this.node.scene.emit(Js.RESCUE_FINISHED)})),function(){return r.apply(this,arguments)})}]),s}(te))||Nw)||Nw;X._RF.pop(),X._RF.push({},"944cbG3+yRMsJZimXjukGdn","Coin",void 0);var oS,rS,lS,sS,uS,cS,dS,hS,pS,yS,vS,fS=Z.ccclass,gS=Z.property,mS=(xw=fS("Coin"),zw=gS(Oe),Uw=gS(ze),Gw=gS(Ue),Hw=gS(Ue),qw=Yn.onlyRunInLifeCycle,Vw=Yn.onlyRunInLifeCycle,$w=Yn.onlyRunInLifeCycle,Ww=Yn.onlyRunInLifeCycle,Kw=Yn.onlyRunInLifeCycleAsync,jw=Yn.onlyRunInLifeCycleAsync,Yw=Yn.onlyRunInLifeCycle,xw((Zw=a((Jw=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"emittingParticles",Zw,s(e)),l(e,"animation",Qw,s(e)),l(e,"spin",eS,s(e)),l(e,"rest",tS,s(e)),e}return e(c,[{key:"__preload",value:function(){Yn.lazyValidateProperties(this)}},{key:"resetDisabled",value:function(){this.stopParticles(),this.stopAnimation(),this.hide(),this.node.active=!1,this.node.setPosition(0,0,this.node.position.z)}},{key:"hide",value:function(){this.node.setScale(be.ZERO)}},{key:"stopParticles",value:function(){this.emittingParticles.stopSystem()}},{key:"playTrailParticles",value:function(){this.emittingParticles.resetSystem()}},{key:"playSpinAnimationAfterDelay",value:(r=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;e>0&&(yield p.waitTweenAsync(e)),yield this.playSpinAnimation(t)})),function(){return r.apply(this,arguments)})},{key:"playSpinAnimation",value:function(e){return p.runAnimationAsync(this.animation,this.spin.name,e)}},{key:"stopAnimation",value:function(){this.animation.play(this.rest.name)}}]),c}(te)).prototype,"emittingParticles",[zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qw=a(Jw.prototype,"animation",[Uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eS=a(Jw.prototype,"spin",[Gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tS=a(Jw.prototype,"rest",[Hw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Jw.prototype,"resetDisabled",[qw],Object.getOwnPropertyDescriptor(Jw.prototype,"resetDisabled"),Jw.prototype),a(Jw.prototype,"hide",[Vw],Object.getOwnPropertyDescriptor(Jw.prototype,"hide"),Jw.prototype),a(Jw.prototype,"stopParticles",[$w],Object.getOwnPropertyDescriptor(Jw.prototype,"stopParticles"),Jw.prototype),a(Jw.prototype,"playTrailParticles",[Ww],Object.getOwnPropertyDescriptor(Jw.prototype,"playTrailParticles"),Jw.prototype),a(Jw.prototype,"playSpinAnimationAfterDelay",[Kw],Object.getOwnPropertyDescriptor(Jw.prototype,"playSpinAnimationAfterDelay"),Jw.prototype),a(Jw.prototype,"playSpinAnimation",[jw],Object.getOwnPropertyDescriptor(Jw.prototype,"playSpinAnimation"),Jw.prototype),a(Jw.prototype,"stopAnimation",[Yw],Object.getOwnPropertyDescriptor(Jw.prototype,"stopAnimation"),Jw.prototype),Xw=Jw))||Xw);X._RF.pop(),X._RF.push({},"0c6a8vx5IhFvKJ5IUimm0Je","CoinTextPopup",void 0);var bS,wS,SS,kS,CS,ES,AS,TS,PS,LS,OS,IS,RS,_S,DS,NS,MS,FS,BS=Z.ccclass,xS=Z.property,zS=be.ZERO.clone().add3f(0,-100,0),US=be.ZERO.clone().add3f(0,100,0),GS=Ludex.Utils.Number,HS=(oS=BS("CoinTextPopup"),rS=xS(ke),lS=xS(de),sS=Yn.onlyRunInLifeCycle,uS=Yn.onlyRunInLifeCycle,cS=Yn.onlyRunInLifeCycleAsync,dS=Yn.onlyRunInLifeCycleAsync,oS((yS=a((pS=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"label",yS,s(e)),l(e,"uiOpacity",vS,s(e)),e}return e(h,[{key:"__preload",value:function(){Yn.lazyValidateProperties(this),this.node.active=!1}},{key:"show",value:(c=o((function*(e,t){this.enableNode(),this.initializePopup(e),yield this.showTextPopupAnimation(t),yield this.hidePopup(),this.disableNode()})),function(e,t){return c.apply(this,arguments)})},{key:"enableNode",value:function(){this.node.active=!0}},{key:"disableNode",value:function(){this.node.active=!1}},{key:"initializePopup",value:function(e){var t=GS.getShortNumber(e,3);this.label.string=t,this.uiOpacity.opacity=255,this.node.setScale(.5,.5,.5),this.node.setPosition(zS)}},{key:"hidePopup",value:(u=o((function*(){this.node.setScale(be.ONE),this.node.setPosition(US),yield p.runTweenAsync(re(this.uiOpacity).to(.5,{opacity:0}))})),function(){return u.apply(this,arguments)})},{key:"showTextPopupAnimation",value:(r=o((function*(e){yield Promise.all([p.runTweenAsync(re(this.node).to(1.5,{position:US},{easing:"sineOut"}),e),p.runTweenAsync(re(this.node).to(.5,{scale:be.ONE},{easing:"backOut"}),e)])})),function(e){return r.apply(this,arguments)})}]),h}(te)).prototype,"label",[rS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vS=a(pS.prototype,"uiOpacity",[lS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(pS.prototype,"disableNode",[sS],Object.getOwnPropertyDescriptor(pS.prototype,"disableNode"),pS.prototype),a(pS.prototype,"initializePopup",[uS],Object.getOwnPropertyDescriptor(pS.prototype,"initializePopup"),pS.prototype),a(pS.prototype,"hidePopup",[cS],Object.getOwnPropertyDescriptor(pS.prototype,"hidePopup"),pS.prototype),a(pS.prototype,"showTextPopupAnimation",[dS],Object.getOwnPropertyDescriptor(pS.prototype,"showTextPopupAnimation"),pS.prototype),hS=pS))||hS);X._RF.pop(),X._RF.push({},"8a5c3m7o41LNqGBKPo0oqf1","CoinManager",void 0);var qS,VS=Z.ccclass,$S=Z.disallowMultiple,WS=Z.property,KS=codex,jS=KS.player,YS=KS.monitorError,XS=999999999,JS=10,ZS=1,QS=1,ek=(bS=VS("CoinManager"),wS=Yn.required(),SS=WS($e),kS=Yn.required(),CS=WS($e),ES=Yn.required(),AS=WS(me),TS=Yn.onlyRunInLifeCycleAsync,PS=Yn.onlyRunInLifeCycleAsync,LS=Yn.onlyRunInLifeCycleAsync,OS=Yn.onlyRunInLifeCycleAsync,IS=Yn.onlyRunInLifeCycleAsync,RS=Yn.onlyRunInLifeCycleAsync,bS(_S=$S((NS=a((DS=function(a){n(v,a);var r,c,d,h,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=y.call.apply(y,[this].concat(i))).coins=0,l(e,"coinPrefab",NS,s(e)),l(e,"coinTextPopup",MS,s(e)),l(e,"coinAnimContainer",FS,s(e)),e.coinObjects=[],e}return e(v,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.getCoinsFromPlayerData(),this.prepareCoinCollection(),this.prepareCoinTextPopup(),this.listenToCoinEvents()}},{key:"start",value:function(){this.emitCoinAmount()}},{key:"init",value:function(){this.updateCoins({coins:this.coins})}},{key:"listenToCoinEvents",value:function(){this.node.scene.on(Js.ADD_COINS,this.addCoins,this),this.node.scene.on(Js.REMOVE_COINS,this.removeCoins,this),this.node.scene.on(Js.ABORT_COIN_ANIMATION,this.abortCoinAnimation,this)}},{key:"prepareCoinCollection",value:function(){for(var e=0;e<JS;e++){var t=qe(this.coinPrefab);t.setParent(this.coinAnimContainer),t.setPosition(0,0),t.active=!1,this.coinObjects.push(t.getComponent(mS))}}},{key:"prepareCoinTextPopup",value:function(){var e=qe(this.coinTextPopup);e.setParent(this.node),e.active=!1,this.coinTextPopupNode=e.getComponent(HS)}},{key:"handleCollectionAnim",value:(h=o((function*(e,t,n,i,a){var o=this;if(t){var r=this.coinObjects.slice(0,this.getShortAmount(e));if(0===r.length)return console.warn("Requested coins amount is ".concat(e,". Shortened to ").concat(this.getShortAmount(e),". No coin objects was found to animate collection.")),void(null==YS||YS.sendException(new Error("Requested coins amount is ".concat(e,". Shortened to ").concat(this.getShortAmount(e),". No coin objects was found to animate collection.")),{coins:e,animatedCoins:r.length,hasCoinTextPopup:!!this.coinTextPopupNode,hasTargetContainer:!!t,coinCollectionCount:this.coinObjects.length}));w.playSound(Qi.COLLECT_STOCK_COINS),yield Promise.all([this.playCoinFlyAndexplodeAnimation(t,r,n,i,a),p.waitTweenAsync(n+i/2,a).then((function(){return o.animateCoinTextPopup(e,a)}))]),a.abort()}else console.warn("No target coin container assigned to CoinManager. No coin collection animation will be played")})),function(e,t,n,i,a){return h.apply(this,arguments)})},{key:"playCoinFlyAndexplodeAnimation",value:(d=o((function*(e,t,n,i,a){var o=this,r=n+i;yield Promise.all([].concat(A(t.flatMap((function(t){t.node.active=!0,t.stopParticles();var r=[0,.5*Math.min(n,i)],l=Ge.apply(void 0,r),s=n-l,u=i+l;return[o.animateCoinExplode(t.node,s,a),p.waitTweenAsync(s,a).then((function(){return o.animateCoinFlyBack(e,t,u,a)}))]}))),[p.waitTweenAsync(r,a).then((function(){return e.emitExplodeEffect(a)}))]))})),function(e,t,n,i,a){return d.apply(this,arguments)})},{key:"animateCoinTextPopup",value:function(e,t){return this.coinTextPopupNode.show(e,t)}},{key:"animateCoinFlyBack",value:(c=o((function*(e,t,n,i){var a=t.node.worldPosition.clone(),o=be.ZERO.clone(),r=e.getCoinIconWorldScale();yield p.runTweenAsync(re(t.node).to(n,{scale:r},{onStart:function(){t.playSpinAnimationAfterDelay(0,i),t.playTrailParticles()},onUpdate:function(n,i){if(void 0!==i){var r=ye.cubicIn(i),l=e.getCoinIconWorldPosition();t.node.worldPosition=be.lerp(o,a,l,r)}},onComplete:function(){t.emittingParticles.stopSystem(),t.stopAnimation(),t.hide()}}),i),yield p.waitTweenAsync(1,i),t.resetDisabled()})),function(e,t,n,i){return c.apply(this,arguments)})},{key:"animateCoinExplode",value:(r=o((function*(e,t,n){var i=[-200,200],a=[-200,200],o=Ge(i[0],i[1]),r=Ge(a[0],a[1]);e.setPosition(0,0,e.position.z),e.setScale(be.ZERO);var l=new be(o,r,e.position.z);yield Promise.all([p.runTweenAsync(re(e).delay(.1*t).to(.8*t,{scale:be.ONE},{easing:"elasticOut"}),n),p.runTweenAsync(re(e).to(t,{position:l},{easing:"circOut"}),n)])})),function(e,t,n){return r.apply(this,arguments)})},{key:"getCoinsFromPlayerData",value:function(){var e=jS.getGameData();this.coins=e?e.coins:0}},{key:"getCoins",value:function(){return this.coins}},{key:"updateCoins",value:function(e){var t,n;if(this.coins>XS&&(this.coins=XS),e.coins!==this.coins){var i=Math.max(0,e.coins-this.coins);this.coins=e.coins,jS.setGameData({coins:this.coins});var a=e.collectionAnimation;null===(t=this.collectionAnimSignal)||void 0===t||t.abort();var o=new Mi;if(this.collectionAnimSignal=o,null==a||null===(n=a.signal)||void 0===n||n.chain(o),void 0===a||a.animateTextOnly)this.node.scene.emit(Js.COIN_CHANGED,u(u({},e),{},{collectionAnimation:{animateTextOnly:!0,signal:null==a?void 0:a.signal}}));else{var r=a.floatDuration,l=void 0===r?ZS:r,s=a.flyDuration,c=void 0===s?QS:s,d=a.target,h=void 0===d?this.targetContainer:d;this.collectionAnimSignal=o,this.targetContainer=h;var p=u(u({},e),{},{collectionAnimation:{floatDuration:l,flyDuration:c,animateTextOnly:!1,signal:o,target:h}});this.node.scene.emit(Js.COIN_CHANGED,p),this.handleCollectionAnim(i,this.targetContainer,l,c,o)}}}},{key:"addCoins",value:function(e){this.updateCoins(u(u({},e),{},{coins:this.coins+e.coins}))}},{key:"removeCoins",value:function(e){this.coins<e.coins?this.node.scene.emit(Js.REMOVE_COINS_FAILED):(this.updateCoins(u(u({},e),{},{coins:this.coins-e.coins})),this.node.scene.emit(Js.REMOVE_COINS_SUCCESS))}},{key:"emitCoinAmount",value:function(){this.node.scene.emit(Js.COIN_CHANGED,{coins:this.coins})}},{key:"getShortAmount",value:function(e){return Math.min(e,JS)}},{key:"abortCoinAnimation",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}},{key:"untilFinishesCollectAnim",value:function(){return void 0===this.collectionAnimSignal?Promise.resolve():this.collectionAnimSignal.untilAborted()}},{key:"setTargetContainer",value:function(e){this.targetContainer=e}},{key:"getTargetContainer",value:function(){return this.targetContainer}},{key:"onDestroy",value:function(){var e;null===(e=this.collectionAnimSignal)||void 0===e||e.abort()}}]),v}(te)).prototype,"coinPrefab",[wS,SS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MS=a(DS.prototype,"coinTextPopup",[kS,CS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FS=a(DS.prototype,"coinAnimContainer",[ES,AS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(DS.prototype,"handleCollectionAnim",[TS],Object.getOwnPropertyDescriptor(DS.prototype,"handleCollectionAnim"),DS.prototype),a(DS.prototype,"playCoinFlyAndexplodeAnimation",[PS],Object.getOwnPropertyDescriptor(DS.prototype,"playCoinFlyAndexplodeAnimation"),DS.prototype),a(DS.prototype,"animateCoinTextPopup",[LS],Object.getOwnPropertyDescriptor(DS.prototype,"animateCoinTextPopup"),DS.prototype),a(DS.prototype,"animateCoinFlyBack",[OS],Object.getOwnPropertyDescriptor(DS.prototype,"animateCoinFlyBack"),DS.prototype),a(DS.prototype,"animateCoinExplode",[IS],Object.getOwnPropertyDescriptor(DS.prototype,"animateCoinExplode"),DS.prototype),a(DS.prototype,"untilFinishesCollectAnim",[RS],Object.getOwnPropertyDescriptor(DS.prototype,"untilFinishesCollectAnim"),DS.prototype),_S=DS))||_S)||_S);X._RF.pop(),X._RF.push({},"3afb9sM0KZKyod8UtofqZYu","ComboManager",void 0);var tk,nk,ik,ak,ok,rk,lk,sk,uk,ck,dk,hk=Z.ccclass,pk=[Qi.COMBO_1,Qi.COMBO_2,Qi.COMBO_3,Qi.COMBO_4,Qi.COMBO_5,Qi.COMBO_6,Qi.COMBO_7,Qi.COMBO_8,Qi.COMBO_9,Qi.COMBO_10,Qi.COMBO_11,Qi.COMBO_12,Qi.COMBO_13],yk=hk("ComboManager")(qS=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"init",value:function(){this.currentCombo=0,this.setEmitEvent(!0),this.node.scene.on(Js.COMBO_ENDED,this.resetCombo,this),this.node.scene.on(Js.GAME_FINISH,this.resetCombo,this),this.node.scene.on(Js.GAME_REPLAY,this.resetCombo,this),this.node.scene.on(Js.NEXT_LEVEL,this.resetCombo,this),this.node.scene.on(Js.ADD_COMBO,this.addCombo,this)}},{key:"addCombo",value:function(){this.setCombo(this.currentCombo+1)}},{key:"resetCombo",value:function(){this.setCombo(0)}},{key:"getCombo",value:function(){return this.currentCombo}},{key:"setCombo",value:function(e){if(this.currentCombo=e,e>0){var t=Math.min(e-1,pk.length-1);w.playSound(pk[t]),this.vibrate(e)}this.emitEvent&&this.node.scene.emit(Js.COMBO_UPDATED,e)}},{key:"vibrate",value:function(e){var t;null===(t=Me("Vibrate"))||void 0===t||null===(t=t.getComponent(qy))||void 0===t||t.vibrate(Math.min(20+20*e,220))}},{key:"setEmitEvent",value:function(e){this.emitEvent=e}}]),r}(te))||qS;X._RF.pop(),X._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var vk=Z.ccclass,fk=Z.property,gk=(tk=vk("Burst"),nk=fk(ae),ik=fk(ie),ak=fk(ae),ok=fk(ie),tk((sk=a((lk=function(){function n(){t(this,n),l(this,"time",sk,this),l(this,"repeatCount",uk,this),l(this,"repeatInterval",ck,this),l(this,"count",dk,this),this.remainingCount=0,this.curTime=0}return e(n,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=We(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=We(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),n}()).prototype,"time",[nk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),uk=a(lk.prototype,"repeatCount",[ik],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ck=a(lk.prototype,"repeatInterval",[ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),dk=a(lk.prototype,"count",[ok],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),rk=lk))||rk);X._RF.pop(),X._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var mk,bk,wk,Sk,kk,Ck,Ek,Ak,Tk,Pk,Lk,Ok,Ik,Rk,_k,Dk,Nk,Mk=new be(0,0,0),Fk=function(){function n(){t(this,n),this.pos=new be(0,0,0),this.color=new Ae(255,255,255,255),this.size=new be(0,0,0),this.startSize=new be(0,0,0),this.rotation=new be(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new be(0,0),this.width=0,this.height=0}return e(n,[{key:"init",value:function(){this.pos.set(Mk),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(Mk),this.startColor=Ae.WHITE.clone(),this.velocity.set(Mk),this.randomSeed=0}}]),n}(),Bk=new(function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"get",value:function(){return this._get()||new Fk}}]),r}(Ke.Pool))((function(e){e.pos.set(Mk),e.color.set(255,255,255,255),e.size.set(Mk),e.rotation.set(Mk)}),1024),xk=function(){function n(e){t(this,n),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new Ye,this.sys=e,this.particles=[],this.active=!1,this.uvFilled=0}return e(n,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;Bk.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=Bk.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var a=i.uv,o=e?0:this.uvFilled,r=this.particles.length,l=o;l<r;l++){var s,u,c,d,h,p,y,v,f=9*l*4;n[f+3]=null!==(s=a[0])&&void 0!==s?s:0,n[f+4]=null!==(u=a[1])&&void 0!==u?u:0,n[f+12]=null!==(c=a[2])&&void 0!==c?c:0,n[f+13]=null!==(d=a[3])&&void 0!==d?d:0,n[f+21]=null!==(h=a[4])&&void 0!==h?h:0,n[f+22]=null!==(p=a[5])&&void 0!==p?p:0,n[f+30]=null!==(y=a[6])&&void 0!==y?y:0,n[f+31]=null!==(v=a[7])&&void 0!==v?v:0}this.uvFilled=r}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var a=n.vData,o=t.x,r=t.y,l=t.z,s=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,d=e.rotation.y||0,h=e.rotation.z||0;if(0===c&&0===d&&0===h)a[i]=o-s,a[i+1]=r-u,a[i+2]=l,a[i+9]=o+s,a[i+10]=r-u,a[i+11]=l,a[i+18]=o-s,a[i+19]=r+u,a[i+20]=l,a[i+27]=o+s,a[i+28]=r+u,a[i+29]=l;else{var p=function(e,t,n){var i=t*g-n*m,a=t*m+n*g,o=e*b+a*w;return new be(o*S-i*k,o*k+i*S,a*b-e*w)},y=-je.degreesToRadians(c),v=-je.degreesToRadians(d),f=-je.degreesToRadians(h),g=Math.cos(y),m=Math.sin(y),b=Math.cos(v),w=Math.sin(v),S=Math.cos(f),k=Math.sin(f),C=[p(-s,-u,0),p(s,-u,0),p(-s,u,0),p(s,u,0)];a[i]=C[0].x+o,a[i+1]=C[0].y+r,a[i+2]=C[0].z+l,a[i+9]=C[1].x+o,a[i+10]=C[1].y+r,a[i+11]=C[1].z+l,a[i+18]=C[2].x+o,a[i+19]=C[2].y+r,a[i+20]=C[2].z+l,a[i+27]=C[3].x+o,a[i+28]=C[3].y+r,a[i+29]=C[3].z+l}Ae.toArray(a,e.color,i+5),Ae.toArray(a,e.color,i+14),Ae.toArray(a,e.color,i+23),Ae.toArray(a,e.color,i+32)}},{key:"step",value:function(e){var t,n=this.sys.node,i=this.particles;n.updateWorldTransform(),this.active&&this.sys.emitting(e);var a=this.renderData,o=i.length;a.reset(),this.requestData(4*o,6*o),o>this.uvFilled&&this.updateUVs();for(var r=0;r<i.length;){var l=i[r];if(l)if(l.remainingLifetime-=e,l.remainingLifetime>0){var s=9*r*4;this.updateParticleBuffer(l,l.pos,a,s),++r}else{var u=i[r];if(!u)continue;if(r!==i.length-1){var c=i[i.length-1];c&&(i[r]=c)}Bk.put(u),i.length--,a.resize(a.vertexCount-4,a.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,null==a||null===(t=a.setRenderDrawInfoAttributes)||void 0===t||t.call(a)}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,o=n;o<i;o++){var r=4*o;a[n++]=r,a[n++]=r+1,a[n++]=r+2,a[n++]=r+1,a[n++]=r+3,a[n++]=r+2}}},{key:"initDrawInfo",value:function(){var e,t=this.renderData;null==t||null===(e=t.setRenderDrawInfoAttributes)||void 0===e||e.call(t)}}]),n}();X._RF.pop(),X._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var zk,Uk,Gk,Hk,qk,Vk,$k,Wk,Kk,jk,Yk,Xk,Jk,Zk,Qk,eC,tC,nC=Z.ccclass,iC=Z.property,aC=pe({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),oC=(mk=nC("CurveRange"),bk=iC({type:pe(aC)}),wk=iC({visible:function(){return this.mode===aC.Constant}}),Sk=iC({visible:function(){return this.mode===aC.Curve}}),kk=iC({visible:function(){return this.mode===aC.TwoCurves}}),Ck=iC({visible:function(){return this.mode===aC.TwoCurves}}),Ek=iC({visible:function(){return this.mode===aC.TwoConstants}}),Ak=iC({visible:function(){return this.mode===aC.TwoConstants}}),mk((Lk=a((Pk=function(){function n(){t(this,n),l(this,"mode",Lk,this),l(this,"constant",Ok,this),l(this,"spline",Ik,this),l(this,"splineMin",Rk,this),l(this,"splineMax",_k,this),l(this,"constantMin",Dk,this),l(this,"constantMax",Nk,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case aC.Curve:return this.spline.evaluate(e);case aC.TwoCurves:return Xe(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case aC.TwoConstants:return Xe(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case aC.Curve:return 1;case aC.TwoConstants:return this.constantMax;case aC.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case aC.Curve:return Je(1,0,Ze);case aC.TwoConstants:return Je(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,Ze);case aC.TwoCurves:return Je(1,0,Ze);default:return Je(this.constant,0,Ze)}}}]),n}()).prototype,"mode",[bk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return aC.Constant}}),Ok=a(Pk.prototype,"constant",[wk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ik=a(Pk.prototype,"spline",[Sk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Qe}}),Rk=a(Pk.prototype,"splineMin",[kk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Qe}}),_k=a(Pk.prototype,"splineMax",[Ck],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Qe}}),Dk=a(Pk.prototype,"constantMin",[Ek],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Nk=a(Pk.prototype,"constantMax",[Ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tk=Pk))||Tk);X._RF.pop(),X._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var rC=Z.ccclass,lC=Z.property,sC=pe({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),uC=new Ae,cC=new Ae,dC=(zk=rC("GradientRange"),Uk=lC({type:pe(sC)}),Gk=lC({visible:function(){return this.mode===sC.Color}}),Hk=lC({visible:function(){return this.mode===sC.TwoColors}}),qk=lC({visible:function(){return this.mode===sC.TwoColors}}),Vk=lC({visible:function(){return this.mode===sC.Gradient||this.mode===sC.RandomColor}}),$k=lC({visible:function(){return this.mode===sC.TwoGradients}}),Wk=lC({visible:function(){return this.mode===sC.TwoGradients}}),zk((Yk=a((jk=function(){function n(){t(this,n),l(this,"mode",Yk,this),l(this,"color",Xk,this),l(this,"colorMin",Jk,this),l(this,"colorMax",Zk,this),l(this,"gradient",Qk,this),l(this,"gradientMin",eC,this),l(this,"gradientMax",tC,this),this._color=Ae.WHITE.clone()}return e(n,[{key:"evaluate",value:function(e,t){switch(this.mode){case sC.Color:return this.color;case sC.TwoColors:return Ae.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case sC.RandomColor:return this.gradient.getRandomColor(this._color);case sC.Gradient:return this.gradient.evaluateFast(this._color,e);case sC.TwoGradients:return Ae.lerp(this._color,this.gradientMin.evaluateFast(uC,e),this.gradientMax.evaluateFast(cC,e),t),this._color;default:return this.color}}}]),n}()).prototype,"mode",[Uk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return sC.Color}}),Xk=a(jk.prototype,"color",[Gk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ae.WHITE.clone()}}),Jk=a(jk.prototype,"colorMin",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ae.WHITE.clone()}}),Zk=a(jk.prototype,"colorMax",[qk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ae.WHITE.clone()}}),Qk=a(jk.prototype,"gradient",[Vk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new et}}),eC=a(jk.prototype,"gradientMin",[$k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new et}}),tC=a(jk.prototype,"gradientMax",[Wk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new et}}),Kk=jk))||Kk);function hC(e,t,n,i){!function(e,t){De.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,be.multiplyScalar(e,e,t+(n-t)*nt())}function pC(e){var t=aC;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}X._RF.pop(),X._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),X._RF.pop(),X._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var yC,vC,fC,gC,mC,bC,wC,SC=23541,kC=39825,CC=91041,EC=125292,AC=197866,TC=156497;X._RF.pop(),X._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var PC,LC,OC,IC,RC,_C,DC,NC,MC,FC=Z.ccclass,BC=Z.property,xC=CC,zC=(yC=FC("ColorOvertimeModule"),vC=BC({type:Se}),fC=BC({type:dC}),yC((bC=a((mC=function(){function n(){t(this,n),l(this,"enable",bC,this),l(this,"color",wC,this)}return e(n,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=sC;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?He(e.randomSeed+xC):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),n}()).prototype,"enable",[vC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wC=a(mC.prototype,"color",[fC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new dC}}),gC=mC))||gC);X._RF.pop(),X._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var UC,GC,HC,qC,VC,$C,WC,KC,jC,YC,XC,JC,ZC,QC=Z.ccclass,eE=Z.property,tE=SC,nE=(PC=QC("LimitVelocityOvertimeModule"),LC=eE({type:Se}),OC=eE({type:oC}),IC=eE({type:oC}),PC((DC=a((_C=function(){function n(){t(this,n),l(this,"enable",DC,this),l(this,"limit",NC,this),l(this,"dampen",MC,this),this.limit.constant=500,this.dampen.constant=.2}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),a=pC(this.limit)?He(e.randomSeed+tE):0,o=pC(this.dampen)?He(e.randomSeed+tE+1):0,r=e.velocity.length(),l=this.limit.evaluate(n,a),s=this.dampen.evaluate(n,o);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(r,l,s,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var a=1-Math.exp(-n*i);return Ie.lerp(e,t,a)}}]),n}()).prototype,"enable",[LC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NC=a(_C.prototype,"limit",[OC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),MC=a(_C.prototype,"dampen",[IC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),RC=_C))||RC);X._RF.pop(),X._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var iE,aE,oE,rE,lE,sE,uE,cE,dE,hE,pE,yE,vE,fE,gE,mE,bE,wE,SE,kE,CE,EE,AE,TE=Z.ccclass,PE=Z.property,LE=EC,OE=(UC=TE("RotationOvertimeModule"),GC=PE({type:Se}),HC=PE(Se),qC=PE({type:oC,visible:function(){return this.separateAxes}}),VC=PE({type:oC,visible:function(){return this.separateAxes}}),$C=PE({type:oC}),UC((jC=a((KC=function(){function n(){t(this,n),l(this,"enable",jC,this),l(this,"separateAxes",YC,this),l(this,"x",XC,this),l(this,"y",JC,this),l(this,"z",ZC,this)}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+LE,a=pC(this.z)?He(i):0,o=this.z.evaluate(n,a)*t,r=0,l=0;if(this.separateAxes){var s=pC(this.x)?He(i):0,u=pC(this.y)?He(i):0;r=this.x.evaluate(n,s)*t,l=this.y.evaluate(n,u)*t}e.rotation.add3f(r,l,o)}}}]),n}()).prototype,"enable",[GC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YC=a(KC.prototype,"separateAxes",[HC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),XC=a(KC.prototype,"x",[qC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),JC=a(KC.prototype,"y",[VC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),ZC=a(KC.prototype,"z",[$C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),WC=KC))||WC);X._RF.pop(),X._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var IE,RE,_E,DE,NE,ME,FE,BE,xE,zE,UE,GE,HE,qE=Z.ccclass,VE=Z.property,$E=pe({Circle:0,Rectangle:1}),WE=pe({Base:0,Edge:1}),KE=function(){return this.shape===$E.Circle},jE=function(){return this.shape===$E.Rectangle},YE=[0,0],XE=(iE=qE("ShapeModule"),aE=VE({type:pe($E)}),oE=VE({type:pe(WE),visible:jE}),rE=VE({}),lE=VE({}),sE=VE({}),uE=VE({range:[0,360],visible:KE}),cE=VE({range:[-360,360],visible:KE}),dE=VE({min:0,visible:KE}),hE=VE({range:[0,1],step:.01,visible:KE}),pE=VE({visible:jE}),iE((fE=a((vE=function(){function n(){t(this,n),l(this,"shape",fE,this),l(this,"emitFrom",gE,this),l(this,"position",mE,this),l(this,"rotation",bE,this),l(this,"scale",wE,this),l(this,"arc",SE,this),l(this,"angle",kE,this),l(this,"radius",CE,this),l(this,"radiusThickness",EE,this),l(this,"rectangleThickness",AE,this)}return e(n,[{key:"emit",value:function(e){switch(this.shape){case $E.Circle:this.circleEmit(this.radius,this.radiusThickness,it(this.generateArcAngle()),e);break;case $E.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var a=i.pos;hC(a,e*(1-t),e,n+it(this.angle)),i.velocity=a.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,a,o,r=n.pos;switch(e){case WE.Base:a=r,o=t,De.set(a,Ge(-o.x,o.x),Ge(-o.y,o.y));break;case WE.Edge:YE[0]=Ge(-1,1),YE[1]=(0===(i=Ge(-1,1))&&i++,tt.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+Be(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(YE),this.applyRectThickness(YE,t),De.set(r,YE[0],YE[1])}n.velocity=r.clone().normalize()}},{key:"generateArcAngle",value:function(){return Ge(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case $E.Circle:this.gizmoCircle(e);break;case $E.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(it(this.angle)),a=this.radius*Math.sin(it(this.angle)),o=this.radius*Math.cos(it(this.arc+this.angle)),r=this.radius*Math.sin(it(this.arc+this.angle));e.moveTo(i,a),e.lineTo(0,0),e.moveTo(o,r),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var a=(i-n)/48,o=0;o<=48;o++){var r=n+o*a,l=t*Math.cos(it(r)),s=t*Math.sin(it(r));0===o?e.moveTo(l,s):e.lineTo(l,s)}}}]),n}()).prototype,"shape",[aE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $E.Circle}}),gE=a(vE.prototype,"emitFrom",[oE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return WE.Base}}),mE=a(vE.prototype,"position",[rE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(0,0,0)}}),bE=a(vE.prototype,"rotation",[lE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(0,0,0)}}),wE=a(vE.prototype,"scale",[sE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(1,1,1)}}),SE=a(vE.prototype,"arc",[uE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),kE=a(vE.prototype,"angle",[cE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),CE=a(vE.prototype,"radius",[dE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),EE=a(vE.prototype,"radiusThickness",[hE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),AE=a(vE.prototype,"rectangleThickness",[pE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new De(20,50)}}),yE=vE))||yE);X._RF.pop(),X._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var JE,ZE,QE,eA,tA,nA,iA,aA,oA,rA=Z.ccclass,lA=Z.property,sA=kC,uA=(IE=rA("SizeOvertimeModule"),RE=lA({type:Se}),_E=lA(Se),DE=lA({type:oC,visible:function(){return!this.separateAxes}}),NE=lA({type:oC,visible:function(){return this.separateAxes}}),ME=lA({type:oC,visible:function(){return this.separateAxes}}),IE((xE=a((BE=function(){function n(){t(this,n),l(this,"enable",xE,this),l(this,"separateAxes",zE,this),l(this,"size",UE,this),l(this,"x",GE,this),l(this,"y",HE,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return e(n,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+sA;if(this.separateAxes){var i=pC(this.x)?He(n):0,a=pC(this.y)?He(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,a)}else{var o=pC(this.size)?He(n):0,r=this.size.evaluate(t,o);e.size.multiplyScalar(r)}}}}]),n}()).prototype,"enable",[RE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zE=a(BE.prototype,"separateAxes",[_E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),UE=a(BE.prototype,"size",[DE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),GE=a(BE.prototype,"x",[NE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),HE=a(BE.prototype,"y",[ME],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),FE=BE))||FE);X._RF.pop(),X._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var cA,dA,hA,pA,yA,vA,fA,gA,mA,bA,wA,SA,kA,CA,EA,AA,TA,PA,LA,OA,IA,RA,_A,DA,NA,MA,FA,BA,xA,zA,UA,GA,HA,qA,VA,$A,WA,KA,jA,YA,XA,JA,ZA,QA,eT,tT,nT,iT,aT,oT,rT,lT,sT,uT,cT,dT,hT,pT,yT,vT,fT,gT=Z.ccclass,mT=Z.property,bT=(JE=gT("VelocityOvertimeModule"),ZE=mT({type:Se}),QE=mT({type:oC}),eA=mT({type:oC}),JE((iA=a((nA=function(){function n(){t(this,n),l(this,"enable",iA,this),l(this,"x",aA,this),l(this,"y",oA,this),this._temp_v3=new be,this.x.constant=0,this.y.constant=0}return e(n,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=pC(this.x)?He(e.randomSeed+AC):0,a=pC(this.y)?He(e.randomSeed+TC):0,o=be.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,a),0);e.velocity.add(o.multiplyScalar(t))}}}]),n}()).prototype,"enable",[ZE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aA=a(nA.prototype,"x",[QE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),oA=a(nA.prototype,"y",[eA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),tA=nA))||tA);X._RF.pop(),X._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var wT,ST,kT,CT,ET,AT,TT,PT,LT,OT,IT,RT,_T=Z.ccclass,DT=Z.property,NT=Z.executeInEditMode,MT=Z.disallowMultiple,FT=Z.playOnFocus,BT=at.Attr.setClassAttr,xT=pe({World:0,Local:1}),zT=(cA=_T("ParticleSystem"),dA=NT(!0),hA=MT(!0),pA=FT(!0),yA=DT({}),vA=DT({formerlySerializedAs:"preview"}),fA=DT(Se),gA=DT({type:pe(xT)}),mA=DT({formerlySerializedAs:"simulationSpace"}),bA=DT(ae),wA=DT(Se),SA=DT({type:oC}),kA=DT({type:oC}),CA=DT(dC),EA=DT(Se),AA=DT({type:oC,formerlySerializedAs:"startSize"}),TA=DT({type:oC,visible:function(){return this.startSize2D}}),PA=DT({type:oC}),LA=DT(Se),OA=DT({type:oC,visible:function(){return this.startRotation3D}}),IA=DT({type:oC,visible:function(){return this.startRotation3D}}),RA=DT({type:oC,formerlySerializedAs:"startRotation"}),_A=DT({type:oC}),DA=DT({type:oC}),NA=DT({type:XE}),MA=DT({type:bT}),FA=DT({type:uA}),BA=DT({type:OE}),xA=DT({type:zC}),zA=DT({type:nE}),UA=DT(gk),GA=DT({serializable:!0}),HA=DT({type:xe}),cA(qA=dA(qA=hA(qA=pA((a((VA=function(a){n(r,a);var o=i(r);function r(){var e;return t(this,r),e=o.call(this),l(e,"_preview",$A,s(e)),l(e,"playOnAwake",WA,s(e)),l(e,"_simulationSpace",KA,s(e)),l(e,"duration",jA,s(e)),l(e,"loop",YA,s(e)),l(e,"startDelay",XA,s(e)),l(e,"startLifetime",JA,s(e)),l(e,"startColor",ZA,s(e)),l(e,"startSize2D",QA,s(e)),l(e,"startSizeX",eT,s(e)),l(e,"startSizeY",tT,s(e)),l(e,"startSpeed",nT,s(e)),l(e,"startRotation3D",iT,s(e)),l(e,"startRotationX",aT,s(e)),l(e,"startRotationY",oT,s(e)),l(e,"startRotationZ",rT,s(e)),l(e,"gravityModifier",lT,s(e)),l(e,"rateOverTime",sT,s(e)),l(e,"shapeModule",uT,s(e)),l(e,"velocityOvertimeModule",cT,s(e)),l(e,"sizeOvertimeModule",dT,s(e)),l(e,"rotationOvertimeModule",hT,s(e)),l(e,"colorOvertimeModule",pT,s(e)),l(e,"limitVelocityOvertimeModule",yT,s(e)),l(e,"bursts",vT,s(e)),l(e,"_spriteFrame",fT,s(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return e(r,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){d(h(r.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){d(h(r.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new xk(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){d(h(r.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new be(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e,t=Oe.Assembler.getAssembler(this);if(this._assembler!==t&&(this._assembler=t),null!==(e=this._assembler)&&void 0!==e&&e.createData){var n=this._simulator,i=n.renderData;i||(i=n.renderData=this._assembler.createData(this),n.uvFilled=0,i.particleInitRenderDrawInfo(this.renderEntity),n.initDrawInfo())}}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===xT.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return d(h(r.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===xT.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===xT.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){var e;"function"==typeof(null===(e=this._renderEntity)||void 0===e?void 0:e.setRenderTransform)&&(this.simulationSpace===xT.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===xT.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1)))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var a,o=c(this.bursts);try{for(o.s();!(a=o.n()).done;){a.value.update(this,e)}}catch(e){o.e(e)}finally{o.f()}}var r=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,r),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var a=this._simulator.emitParticle();if(a.init(),this.shapeModule.emit(a),this.simulationSpace===xT.World){var o=this.node.worldMatrix;a.pos.x+=o.m12,a.pos.y+=o.m13}var r=this.startSpeed.evaluate(n,this.rand());a.velocity.multiplyScalar(r),a.width=this.spriteFrame.width,a.height=this.spriteFrame.height;var l=this.startSizeX.evaluate(n,this.rand()),s=this.startSize2D?new be(l,this.startSizeY.evaluate(n,this.rand()),1):new be(l,l,1);a.startSize=s.clone(),a.size=s.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new be(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new be(0,0,u);a.rotation=c,a.startColor=this.startColor.evaluate(n,this.rand()).clone(),a.color=a.startColor.clone(),a.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,a.remainingLifetime=a.startLifetime,a.randomSeed=Be(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new be(0,-9.8*t,0))}},{key:"rand",value:function(){return He(Be(0,tt.INT_MAX))}}]),r}(ot)).prototype,"preview",[yA],Object.getOwnPropertyDescriptor(VA.prototype,"preview"),VA.prototype),$A=a(VA.prototype,"_preview",[vA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),WA=a(VA.prototype,"playOnAwake",[fA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),a(VA.prototype,"simulationSpace",[gA],Object.getOwnPropertyDescriptor(VA.prototype,"simulationSpace"),VA.prototype),KA=a(VA.prototype,"_simulationSpace",[mA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return xT.Local}}),jA=a(VA.prototype,"duration",[bA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),YA=a(VA.prototype,"loop",[wA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),XA=a(VA.prototype,"startDelay",[SA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),JA=a(VA.prototype,"startLifetime",[kA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),ZA=a(VA.prototype,"startColor",[CA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new dC}}),QA=a(VA.prototype,"startSize2D",[EA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),eT=a(VA.prototype,"startSizeX",[AA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),tT=a(VA.prototype,"startSizeY",[TA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),nT=a(VA.prototype,"startSpeed",[PA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),iT=a(VA.prototype,"startRotation3D",[LA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),aT=a(VA.prototype,"startRotationX",[OA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),oT=a(VA.prototype,"startRotationY",[IA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),rT=a(VA.prototype,"startRotationZ",[RA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),lT=a(VA.prototype,"gravityModifier",[_A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),sT=a(VA.prototype,"rateOverTime",[DA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new oC}}),uT=a(VA.prototype,"shapeModule",[NA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new XE}}),cT=a(VA.prototype,"velocityOvertimeModule",[MA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new bT}}),dT=a(VA.prototype,"sizeOvertimeModule",[FA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new uA}}),hT=a(VA.prototype,"rotationOvertimeModule",[BA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new OE}}),pT=a(VA.prototype,"colorOvertimeModule",[xA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new zC}}),yT=a(VA.prototype,"limitVelocityOvertimeModule",[zA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new nE}}),vT=a(VA.prototype,"bursts",[DT,UA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fT=a(VA.prototype,"_spriteFrame",[GA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a(VA.prototype,"spriteFrame",[HA],Object.getOwnPropertyDescriptor(VA.prototype,"spriteFrame"),VA.prototype),qA=VA))||qA)||qA)||qA)||qA);BT(zT,"color","visible",!1),X._RF.pop(),X._RF.push({},"91e6dGDvN1FKLi7g/JQPwl8","ItemCollectionFX",void 0);var UT=Z.ccclass,GT=Z.property,HT=(wT=UT("ItemCollectionFX"),ST=Yn.required(),kT=GT(he),CT=Yn.required(),ET=GT(me),AT=Yn.required(),TT=GT(me),wT((OT=a((LT=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"sprite",OT,s(e)),l(e,"standardParticlesContainer",IT,s(e)),l(e,"quickParticlesContainer",RT,s(e)),e.standardParticles=[],e.quickParticles=[],e}return e(r,[{key:"__preload",value:function(){this.standardParticles=this.standardParticlesContainer.getComponentsInChildren(zT),this.quickParticles=this.quickParticlesContainer.getComponentsInChildren(zT),Yn.validateRequiredProperties(this,r)}},{key:"onDisable",value:function(){this.standardParticlesContainer.active=!1,this.quickParticlesContainer.active=!1}},{key:"playExplosionParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?(this.quickParticlesContainer.active=!0,this.playParticles(this.quickParticles)):(this.standardParticlesContainer.active=!0,this.playParticles(this.standardParticles))}},{key:"playParticles",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){t.value.play()}}catch(e){n.e(e)}finally{n.f()}}}]),r}(te)).prototype,"sprite",[ST,kT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IT=a(LT.prototype,"standardParticlesContainer",[CT,ET],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RT=a(LT.prototype,"quickParticlesContainer",[AT,TT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=LT))||PT);X._RF.pop(),X._RF.push({},"7df59GGBIxFo7OyHCGrEKe5","addItemEffect",void 0);var qT=new be(.8,1.2,1),VT=new be(1.2,.8,1),$T=new be(.5,.5,.5),WT=new be(.65,.65,.65),KT=function(){var e=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.playExplosionParticles(n),w.playSound(Qi.ITEM_REWARD),n?yield jT(e,t):yield XT(e,t),w.playSound(Qi.BUTTON_CLICK)}));return function(t,n){return e.apply(this,arguments)}}();function jT(e,t){return YT.apply(this,arguments)}function YT(){return(YT=o((function*(e,t){var n=p.runTweenAsync(re(e.node).to(.1,{scale:qT}).to(.1,{scale:VT}).to(.1,{scale:be.ONE}).to(.3,{scale:WT})),i=e.node.worldPosition.x,a=e.node.worldPosition.y,o=new be,r=p.runTweenAsync(re(e.node).update(.8,(function(n,r){t.node.getWorldPosition(o);var l=ye.quadOut(r),s=Xe(i,o.x,l),u=Math.max(a,o.y),c=Xe(a,u+300,.5);if(r<.5){var d=ye.cubicOut(2*r),h=Xe(a,c,d);e.node.setWorldPosition(s,h,0)}else{var p=ye.cubicIn(2*(r-.5)),y=Xe(c,o.y,p);e.node.setWorldPosition(s,y,0)}})));yield Promise.all([n,r])}))).apply(this,arguments)}function XT(e,t){return JT.apply(this,arguments)}function JT(){return(JT=o((function*(e,t){yield vP(e),yield p.waitTweenAsync(.8),yield fP(e,t),yield gP(e,t)}))).apply(this,arguments)}var ZT,QT,eP,tP,nP,iP,aP,oP,rP,lP,sP,uP,cP,dP,hP,pP,yP,vP=function(e){return p.runTweenAsync(re(e.node).to(.1,{scale:qT}).to(.1,{scale:VT}).to(.1,{scale:be.ONE}))},fP=function(e,t){return p.runTweenAsync(re(e.node).to(1,{worldPosition:new be(t.node.worldPosition.x,t.node.worldPosition.y+30,t.node.worldPosition.z),scale:$T},{easing:"cubicInOut"}))},gP=function(e,t){var n=t.node.worldPosition.clone(),i=new be(n.x,n.y+70,n.z);return p.runTweenAsync(re(e.node).to(.3,{worldPosition:i,scale:WT},{easing:"cubicOut"}).to(.5,{worldPosition:n},{easing:"cubicIn"}))};X._RF.pop(),X._RF.push({},"da8a1SD+ahMFpc6MIdiFP5H","ShiningStar",void 0);var mP,bP,wP,SP,kP,CP=Z.ccclass,EP=Z.property,AP=Z.disallowMultiple,TP=(ZT=CP("ShiningStar"),QT=EP(he),eP=EP({serializable:!0,visible:!1}),tP=EP({type:ae,displayName:"Scale up duration",min:.001}),nP=EP({serializable:!0,visible:!1}),iP=EP({type:ae,displayName:"Bounce and Fall duration",min:.001}),aP=EP({serializable:!0,visible:!1}),oP=EP({type:ae,displayName:"Start scale"}),rP=EP({serializable:!0,visible:!1}),lP=EP({type:ae,displayName:"End scale"}),ZT(sP=AP((cP=a((uP=function(a){n(g,a);var r,u,c,d,h,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"shine",cP,s(e)),l(e,"twScaleUpDuration",dP,s(e)),l(e,"twBounceAndFallDuration",hP,s(e)),l(e,"twStartScale",pP,s(e)),l(e,"twEndScale",yP,s(e)),e.isBeingAnimated=!1,e}return e(g,[{key:"scaleUpDuration",get:function(){return this.twScaleUpDuration},set:function(e){this.twScaleUpDuration=e}},{key:"bounceAndFallDuration",get:function(){return this.twBounceAndFallDuration},set:function(e){this.twBounceAndFallDuration=e}},{key:"startScale",get:function(){return this.twStartScale},set:function(e){this.twStartScale=e}},{key:"endScale",get:function(){return this.twEndScale},set:function(e){this.twEndScale=e}},{key:"isAvailable",get:function(){return!this.isBeingAnimated}},{key:"__preload",value:function(){this.shineOpacity=this.shine.node.getComponent(de),this.uiOpacity=this.node.getComponent(de),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0}},{key:"playAnimation",value:(v=o((function*(){if(!this.isAvailable)throw new Error("ShiningStar: This star is being animated.");this.isBeingAnimated=!0,yield this.animateAppear(),yield this.animateDisappear(),this.isBeingAnimated=!1})),function(){return v.apply(this,arguments)})},{key:"animateAppear",value:(y=o((function*(){this.shineOpacity.opacity=255,yield Promise.all([this.animateFadeIn(),this.animateScaleUp()])})),function(){return y.apply(this,arguments)})},{key:"animateDisappear",value:(h=o((function*(){yield Promise.all([this.animateBounceAndFall(),this.animateScaleDown()]),this.node.setScale(0,0),this.uiOpacity.opacity=0})),function(){return h.apply(this,arguments)})},{key:"animateBounceAndFall",value:(d=o((function*(){var e=this.node.position.x,t=this.node.position.y,n=[60,120],i=(Math.random()*(n[1]-n[0])+n[0])*(Math.PI/180),a=e+200*Math.cos(i),o=t+200*Math.sin(i),r=t-500,l=p.runTweenAsync(re(this.node).to(.2*this.twBounceAndFallDuration,{position:new be(a,o,this.node.position.z)},{easing:"sineOut"}).to(.4*this.twBounceAndFallDuration,{position:new be(a,r,this.node.position.z)},{easing:"cubicIn"})),s=[0,360],u=p.runTweenAsync(re(this.node).to(this.twBounceAndFallDuration,{eulerAngles:new be(0,0,Math.random()*(s[1]-s[0])*(a>e?-1:1))},{easing:"sineOut"}));yield Promise.all([l,u]),this.node.eulerAngles=new be(0,0,0)})),function(){return d.apply(this,arguments)})},{key:"animateFadeIn",value:(c=o((function*(){var e=Math.max(this.scaleUpDuration/4,.01);yield p.runTweenAsync(re(this.uiOpacity).to(e,{opacity:255}))})),function(){return c.apply(this,arguments)})},{key:"animateScaleUp",value:(u=o((function*(){this.node.setScale(this.startScale,this.startScale);var e=new be(this.endScale,this.endScale,1);yield p.runTweenAsync(re(this.node).to(this.scaleUpDuration,{scale:e},{easing:"cubicOut"}))})),function(){return u.apply(this,arguments)})},{key:"animateScaleDown",value:(r=o((function*(){var e=new be(0,0,1);yield p.runTweenAsync(re(this.node).delay(.1*this.bounceAndFallDuration).to(.5*this.bounceAndFallDuration,{scale:e},{easing:"cubicIn"}))})),function(){return r.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),g}(te)).prototype,"shine",[QT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dP=a(uP.prototype,"twScaleUpDuration",[eP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(uP.prototype,"scaleUpDuration",[tP],Object.getOwnPropertyDescriptor(uP.prototype,"scaleUpDuration"),uP.prototype),hP=a(uP.prototype,"twBounceAndFallDuration",[nP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(uP.prototype,"bounceAndFallDuration",[iP],Object.getOwnPropertyDescriptor(uP.prototype,"bounceAndFallDuration"),uP.prototype),pP=a(uP.prototype,"twStartScale",[aP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),a(uP.prototype,"startScale",[oP],Object.getOwnPropertyDescriptor(uP.prototype,"startScale"),uP.prototype),yP=a(uP.prototype,"twEndScale",[rP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),a(uP.prototype,"endScale",[lP],Object.getOwnPropertyDescriptor(uP.prototype,"endScale"),uP.prototype),sP=uP))||sP)||sP);X._RF.pop(),X._RF.push({},"2e9aaj8L6lN1pTv2xGEj1sE","StarParticles",void 0);var PP=Z.ccclass,LP=Z.property,OP=Z.disallowMultiple,IP=Ludex.Utils.Array,RP=(mP=PP("StarParticles"),bP=LP({type:[TP],displayName:"Prebuilt Shining stars"}),mP(wP=OP((kP=a((SP=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"shiningStars",kP,s(e)),e}return e(c,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"fireShiningStarAt",value:(r=o((function*(e){var t=this.getFirstAvailableShiningStar();if(void 0===t)throw new Error("No available shining stars. Please add more prebuilt shining stars or calls this function later.");var n=k(e,2),i=n[0],a=n[1],o=new be(i,a,this.node.worldPosition.z);t.node.worldPosition=o,yield t.playAnimation()})),function(e){return r.apply(this,arguments)})},{key:"getFirstAvailableShiningStar",value:function(){return IP.search(this.shiningStars,(function(e){return e.isAvailable}))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),c}(te)).prototype,"shiningStars",[bP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wP=SP))||wP)||wP);X._RF.pop(),X._RF.push({},"d10c8b8p8RD45oVz5qSL2LD","clampToBoundingBox",void 0);X._RF.pop(),X._RF.push({},"02e30BdQXxIEbItBFTh00UT","getClosestPair",void 0);var _P=function e(t){var n=FP(t);return function(i,a,o,r){if(o===r)return[i,a];if(o>r)return e(t)(i,a,r,o);var l=n(o,r);return l>=MP(i,t.length)(a[0],a[1])?[i,a]:[NP(i,t.length)(o,r,l),[o,r]]}},DP=function(e){return function(t,n){return t*(2*e-t-1)/2+(n-t-1)}},NP=function e(t,n){return function(i,a,o){if(i===a)return t;if(i>a)return e(t,n)(a,i,o);var r=DP(n)(i,a);return[].concat(A(t.slice(0,r)),[o],A(t.slice(r+1)))}},MP=function e(t,n){return function(i,a){var o;if(i===a)return 1/0;if(i>a)return e(t,n)(a,i);var r=DP(n)(i,a);return null!==(o=t[r])&&void 0!==o?o:1/0}},FP=function(e){return function(t,n){var i=e[t],a=e[n];return De.distance(i,a)}};X._RF.pop(),X._RF.push({},"a70090n5pRBdIZb/GuW6wDs","toSortedIndices",void 0);var BP=Ludex.Utils.Array,xP=function(e,t){var n,i=e.map((function(e,t){return{data:e,index:t}}));return i.sort((function(e,n){return t(e.data,n.data)})),i.reduce((function(e,t,n){return e[t.index]=n,e}),(n=e.length,BP.fillWith(n,(function(){return 0}))))};X._RF.pop(),X._RF.push({},"56e87lhVSNJ8LMUzQpgUomc","randomSign",void 0);var zP,UP,GP,HP,qP,VP,$P,WP,KP,jP,YP,XP,JP,ZP=function(){return nt()>.5?1:-1};X._RF.pop(),X._RF.push({},"ce29fBj4hlOb5ZB/FQ77PpP","Ray",void 0);var QP,eL,tL,nL,iL,aL,oL,rL,lL,sL,uL,cL=Z.ccclass,dL=Z.property,hL=(zP=cL("Ray"),UP=Yn.required(),GP=dL(ne),HP=Yn.required(),qP=dL(he),VP=dL({type:de}),$P=dL({type:ae}),zP((jP=a((KP=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"uiTransform",jP,s(e)),l(e,"sprite",YP,s(e)),l(e,"uiOpacity",XP,s(e)),l(e,"widthOffset",JP,s(e)),e}return e(r,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,r)}}]),r}(te)).prototype,"uiTransform",[UP,GP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YP=a(KP.prototype,"sprite",[HP,qP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XP=a(KP.prototype,"uiOpacity",[VP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JP=a(KP.prototype,"widthOffset",[$P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),WP=KP))||WP);X._RF.pop(),X._RF.push({},"a20fagfOq5En6C68G/OaEAy","RayManagerProperties",void 0);var pL,yL,vL,fL,gL,mL,bL,wL,SL,kL,CL,EL,AL,TL,PL=Z.ccclass,LL=Z.property,OL=(QP=PL("RayManagerProperties"),eL=LL({type:ae}),tL=LL({type:ae}),nL=LL({type:ie,min:1}),iL=LL({type:ae,min:0,max:1,slide:!0,step:.01}),QP((rL=a((oL=e((function e(){t(this,e),l(this,"thicknessStart",rL,this),l(this,"thicknessEnd",lL,this),l(this,"segments",sL,this),l(this,"jaggedness",uL,this)}))).prototype,"thicknessStart",[eL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),lL=a(oL.prototype,"thicknessEnd",[tL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),sL=a(oL.prototype,"segments",[nL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),uL=a(oL.prototype,"jaggedness",[iL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),aL=oL))||aL);X._RF.pop(),X._RF.push({},"19a4dTqUJdEXb8HsBhOcSyI","RayManager",void 0);var IL,RL,_L,DL,NL,ML,FL,BL,xL=Z.ccclass,zL=Z.property,UL=(pL=xL("RayManager"),yL=Yn.required(),vL=zL({type:$e}),fL=Yn.required(),gL=zL({type:de}),mL=Yn.required(),bL=zL({type:ne}),wL=zL({type:OL}),pL((CL=a((kL=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"rayPrefab",CL,s(e)),l(e,"uiOpacity",EL,s(e)),l(e,"uiTransform",AL,s(e)),l(e,"properties",TL,s(e)),e}return e(r,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,r),this.rayPool=GL(this.rayPrefab,this.node),this.rayPool=VL(this.rayPool,this.properties.segments)}},{key:"onEnable",value:function(){this.rayPool=VL(this.rayPool,this.properties.segments)}},{key:"onDestroy",value:function(){this.rayPool=KL(this.rayPool)}},{key:"createRayAnimation",value:function(e,t){var n=this,i=qL(this.rayPool,this.properties.segments),a=k(i,2),o=a[0],r=a[1];this.rayPool=r;var l=tO(t);return QL(this,o,e,l).call((function(){n.rayPool=WL(o,n.rayPool)}))}}]),r}(te)).prototype,"rayPrefab",[yL,vL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EL=a(kL.prototype,"uiOpacity",[fL,gL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AL=a(kL.prototype,"uiTransform",[mL,bL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TL=a(kL.prototype,"properties",[wL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new OL}}),SL=kL))||SL),GL=function(e,t){return{prefab:e,container:t,activeRays:[],inactiveRays:[]}},HL=function(e){var t;return null!==(t=jL(e))&&void 0!==t?t:YL(e)},qL=function(e,t){for(var n=[],i=e,a=0;a<t;a++){var o=HL(i),r=k(o,2),l=r[0],s=r[1];n.push(l),i=s}return[n,i]},VL=function(e,t){if(e.inactiveRays.length>=t)return e;for(var n=t-e.inactiveRays.length,i=e,a=0;a<n;a++){var o=YL(i),r=k(o,2),l=r[0],s=r[1];i=$L(l,s)}return i},$L=function(e,t){e.node.active=!1;var n=[].concat(A(t.inactiveRays),[e]),i=t.activeRays.filter((function(t){return t!==e}));return u(u({},t),{},{activeRays:i,inactiveRays:n})},WL=function(e,t){var n,i=c(e);try{for(i.s();!(n=i.n()).done;){n.value.node.active=!1}}catch(e){i.e(e)}finally{i.f()}var a=[].concat(A(t.inactiveRays),A(e)),o=t.activeRays.filter((function(t){return!e.includes(t)}));return u(u({},t),{},{activeRays:o,inactiveRays:a})},KL=function(e){e.container.destroyAllChildren();return u(u({},e),{},{activeRays:[],inactiveRays:[]})},jL=function(e){if(0!==e.inactiveRays.length){var t=B(e.inactiveRays),n=t[0],i=t.slice(1),a=n,o=[].concat(A(e.activeRays),[a]),r=i;return a.node.active=!0,[a,u(u({},e),{},{activeRays:o,inactiveRays:r})]}},YL=function(e){var t=qe(e.prefab);e.container.addChild(t);var n=t.getComponent(hL);if(!n)throw new Error("Ray component not found");var i=[].concat(A(e.activeRays),[n]);return n.node.active=!0,[n,u(u({},e),{},{activeRays:i})]},XL=function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=eO(e.properties.segments,e.uiTransform.height*e.node.worldScale.y,e.uiTransform.width*e.node.worldScale.x,e.properties.jaggedness),o={start:{x:0,y:0},end:{x:0,y:e.uiTransform.height*e.node.worldScale.y}},r={start:e.node.worldPosition,end:null!=n?n:{x:0,y:e.node.worldPosition.y+e.uiTransform.height*e.node.worldScale.y}},l=nO(o.start,o.end)(r.start,r.end),s=JL(),u=function(e,t,n){return s(e,l(t),l(n))},c={x:0,y:0},d=i,h=0;h<e.properties.segments;h++){var p=a(c,h,d),y=p.start,v=p.end,f=p.seed,g=ZL(e,h/(e.properties.segments-1)),m=t[h],b=u(m,y,v);b.uiTransform.setContentSize(b.uiTransform.width,g),c=v,d=f}return t},JL=function(){var e={x:0,y:0};return function(t,n,i){var a=(n.x+i.x)/2,o=(n.y+i.y)/2;De.subtract(e,i,n);var r=De.len(e)/t.node.worldScale.x+t.widthOffset;De.normalize(e,e);var l=180*Math.atan2(e.y,e.x)/Math.PI;return t.node.setWorldPosition(a,o,0),t.node.setRotationFromEuler(0,0,l),t.uiTransform.setContentSize(r,t.uiTransform.height),t}},ZL=function(e,t){return Xe(e.properties.thicknessStart,e.properties.thicknessEnd,t)},QL=function(e,t,n,i){var a,o=tO(i),r=tO(o);return(a=re(e.uiOpacity).call((function(){return XL(e,t,n,i)})).call((function(){var e,n=c(t);try{for(n.s();!(e=n.n()).done;){e.value.uiOpacity.opacity=255}}catch(e){n.e(e)}finally{n.f()}})).set({opacity:255}).delay(.05).set({opacity:0}).delay(.05).call((function(){return XL(e,t,n,o)})).set({opacity:255}).delay(.05).set({opacity:0}).delay(.05).call((function(){return XL(e,t,n,r)})).set({opacity:255})).parallel.apply(a,[re(e.uiOpacity).delay(.2).set({opacity:0}).call((function(){var e,n=c(t);try{for(n.s();!(e=n.n()).done;){e.value.uiOpacity.opacity=0}}catch(e){n.e(e)}finally{n.f()}}))].concat(A(t.map((function(t,n,i){return re(t.node).update(.2,(function(a,o){t.uiTransform.setContentSize(t.uiTransform.width,Xe(ZL(e,n/(i.length-1)),e.properties.thicknessEnd,ye.cubicIn(o)))}))})))))},eO=function(e,t,n,i){return function(a,o,r){if(0===o)return{start:{x:0,y:0},end:{x:0,y:0},seed:r};if(o===e-1)return{start:{x:a.x,y:a.y},end:{x:0,y:t},seed:r};var l=tO(r),s=tO(l),u=a.x,c=a.y,d=(o-1)/(e-1),h=o/(e-1),p=Math.max(-n,Xe(u,u-n,i)),y=Math.min(n,Xe(u,u+n,i)),v=rt(s,p,y)*Xe(1,0,h),f=Xe(0,t,d),g=Xe(0,t,h);return{start:{x:u,y:c},end:{x:v,y:rt(l,f,g)},seed:s}}},tO=function(e){return rt(null!=e?e:Be(0,1e6),0,1e6)},nO=function(e,t){var n={x:t.x-e.x,y:t.y-e.y};return function(t,i){var a={x:i.x-t.x,y:i.y-t.y},o=Math.atan2(n.y,n.x),r=Math.atan2(a.y,a.x)-o,l=Math.cos(r),s=Math.sin(r),u=De.len(a)/De.len(n),c=t.x-e.x,d=t.y-e.y,h={x:0,y:0};return function(e){return h.x=e.x*l-e.y*s,h.y=e.x*s+e.y*l,h.x*=u,h.y*=u,h.x+=c,h.y+=d,{x:h.x,y:h.y}}}};X._RF.pop(),X._RF.push({},"a7ff8uVnP1G3ppM9F/A5DYq","Cloud",void 0);var iO,aO,oO,rO,lO,sO,uO,cO,dO,hO,pO,yO,vO,fO,gO,mO=Z.ccclass,bO=Z.property,wO=new be(0,300),SO=(IL=mO("Cloud"),RL=Yn.required(),_L=bO(ze),DL=bO({type:[UL]}),IL((FL=a((ML=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"animation",FL,s(e)),l(e,"rays",BL,s(e)),e.cachedCanvasUiTransform=null,e}return e(r,[{key:"canvas",get:function(){var e,t,n=null!==(e=this.cachedCanvasUiTransform)&&void 0!==e?e:null===(t=Me("Canvas"))||void 0===t?void 0:t.getComponent(ne);return lt(null!=n,"Cloud: canvasUiTransform is null"),n}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,r)}},{key:"getLightningTween",value:function(e){var t,n=this;return(t=re(this.node).call((function(){p.runAnimationAsync(n.animation)})).delay(.2)).parallel.apply(t,A(this.rays.map((function(t){return t.createRayAnimation(e)}))))}},{key:"getMoveToScreenTween",value:function(e,t){var n=this.canvas.width,i="left"===t?-300:n+300,a=re(this.node).set({worldPosition:new be(i,e.y)}).to(.6,{worldPosition:new be(e.x,e.y,0)},{easing:"quadOut"}),o=st(e.y<this.canvas.height/2?1.2:1.7-e.y/this.canvas.height,.7,2),r=re(this.node).set({scale:new be(1.1*o,.9*o,1)}).to(.6,{scale:new be(o,o,1)},{easing:"quadIn"});return re(this.node).parallel(a,r)}},{key:"getMoveOutScreenTween",value:function(e){var t=this,n=this.canvas,i=n.width,a=n.height,o=new be("left"===e?-i/2-300:i/2+300,this.node.position.y),r=new be(0,-a/2-500);return re(this.node).call((function(){o.set(o.x,t.node.position.y)})).to(.6,{position:function(){return o}},{easing:"quadIn"}).set({position:r})}},{key:"getMoveToScreenCenterTween",value:function(){var e=this.canvas,t=e.width,n=e.height,i=this.getRandomInitialPosition(t,n),a=i.x,o=i.y;return re(this.node).set({position:new be(a,o,0)}).to(.8,{position:wO},{easing:"quadOut"})}},{key:"getRandomInitialPosition",value:function(e,t){switch(Be(0,4)){case 0:return{x:Math.random()*e-e/2,y:t/2+300};case 1:return{x:Math.random()*e-e/2,y:-t/2-300};case 2:return{x:-e/2-300,y:Math.random()*t-t/2};case 3:return{x:e/2+300,y:Math.random()*t-t/2}}}}]),r}(te)).prototype,"animation",[RL,_L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BL=a(ML.prototype,"rays",[DL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),NL=ML))||NL);X._RF.pop(),X._RF.push({},"e6e5eBLV4pKT6u5MYHNZfQd","CloudEffectProperties",void 0);var kO,CO,EO,AO,TO,PO,LO=Z.ccclass,OO=Z.property,IO=(iO=LO("CloudEffectProperties"),aO=Yn.required(),oO=OO({group:{name:"Thunder Effect",style:"section"},type:me}),rO=Yn.required(),lO=OO({group:{name:"Thunder Effect",style:"section"},type:SO}),sO=Yn.required(),uO=OO({group:{name:"Thunder Effect",style:"section"},type:SO}),cO=Yn.required(),dO=OO({group:{name:"Thunder Effect",style:"section"},type:SO}),iO((yO=a((pO=e((function e(){t(this,e),l(this,"cloudContainer",yO,this),l(this,"cloud1",vO,this),l(this,"cloud2",fO,this),l(this,"cloud3",gO,this)}))).prototype,"cloudContainer",[aO,oO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vO=a(pO.prototype,"cloud1",[rO,lO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fO=a(pO.prototype,"cloud2",[sO,uO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gO=a(pO.prototype,"cloud3",[cO,dO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hO=pO))||hO);X._RF.pop(),X._RF.push({},"d716cluEdBCx5J3CuLcUQc6","CloudEffect",void 0);var RO,_O,DO,NO,MO,FO,BO,xO,zO,UO,GO,HO,qO,VO,$O,WO,KO,jO,YO,XO,JO,ZO,QO,eI,tI,nI,iI,aI,oI,rI,lI,sI,uI,cI,dI,hI,pI,yI,vI,fI,gI,mI,bI,wI,SI,kI,CI,EI,AI,TI,PI=Z.ccclass,LI=Z.property,OI=Ludex.Utils.Array,II=(kO=PI("CloudEffect"),CO=Yn.required(),EO=LI({type:IO}),kO((PO=a((TO=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"properties",PO,s(e)),e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,d)}},{key:"onEnable",value:function(){var e,t=null===(e=Me("Canvas"))||void 0===e?void 0:e.getComponent(ne);lt(null!=t,"Canvas UI transform not found"),this.canvasUiTransform=t}},{key:"playThunderAnimations",value:(u=o((function*(e){var t,n=this,i=e.manager,a=e.pairs,o=e.board,r=a.flat(),l=[this.properties.cloud1,this.properties.cloud2,this.properties.cloud3],s=this.getSimpleCloudPositions(r,l),u=(t=re(this.node)).parallel.apply(t,A(s.map((function(e,t){return n.getCloudFxTween({manager:i,board:o,effect:e,delay:.1*t})}))));yield p.runTweenAsync(u)})),function(e){return u.apply(this,arguments)})},{key:"playMultiThunderAnimation",value:(r=o((function*(e){var t=e.manager,n=e.pairs,i=e.board,a=e.stagger,o=this.properties.cloud1;o.node.active=!0,yield p.runTweenAsync(o.getMoveToScreenCenterTween()),yield p.waitTweenAsync(.2),i.clear({pairs:n,stagger:a,lightning:!0});for(var r=[],l=0,s=2*n.length;l<s;l++){var u=n[Math.floor(l/2)];if(void 0!==u){var c=u[l%2];void 0!==c&&(0!==l&&l%2==0&&(t.node.scene.emit(Js.ADD_COMBO),t.node.scene.emit(Js.ADD_SCORE)),t.shakeGame(),t.shakeScreen(500),w.playSound(Qi.THUNDERBOLT),r.push(p.runTweenAsync(o.getLightningTween(c.node.worldPosition))),a&&(yield p.waitTweenAsync(a)))}}yield Promise.all(r),o.node.active=!1})),function(e){return r.apply(this,arguments)})},{key:"getSimpleCloudPositions",value:function(e,t){var n=function(e){if(e.length<2)throw new Error("Not enough points to find a closest pair");for(var t=e[0],n=e[1],i=[De.distance(t,n)],a=[0,1],o=_P(e),r=0;r<e.length-1;r++)for(var l=r+1;l<e.length;l++){var s=o(i,a,r,l),u=k(s,2);i=u[0],a=u[1]}return a}([e[0].node.worldPosition,e[1].node.worldPosition,e[2].node.worldPosition,e[3].node.worldPosition]),i=OI.split(e,(function(e,t){return n.includes(t)})),a=i.left,o=i.right;lt(2===a.length,"Closest pair must have 2 tiles"),lt(2===o.length,"Other tiles must have 2 tiles");var r,l,s=a[0],u=a[1],c=o[0],d=o[1],h=c.node.worldPosition,p=d.node.worldPosition,y=(r=this.canvasUiTransform.getBoundingBoxToWorld(),l=100,function(e){return{x:Math.max(r.xMin+l,Math.min(r.xMax-l,e.x)),y:Math.max(r.yMin+l,Math.min(r.yMax-l,e.y))}}),v=Math.max(s.node.worldPosition.y,u.node.worldPosition.y)+Ge(150,200),f=h.y+Ge(150,200),g=p.y+Ge(150,200),m=(s.node.worldPosition.x+u.node.worldPosition.x)/2+Ge(50,100)*ZP(),b=h.x+Ge(50,100)*ZP(),w=p.x+Ge(50,100)*ZP(),S=y({x:m,y:v}),C=y({x:b,y:f}),E=y({x:w,y:g}),A=xP([S,C,E],(function(e,t){return t.y-e.y}));return[{type:"multi-tile-cloud",cloud:t[A[0]],worldPosition:S,tiles:[s,u]},{type:"single-tile-cloud",clouds:[{cloud:t[A[1]],worldPosition:C,tile:c},{cloud:t[A[2]],worldPosition:E,tile:d}],tiles:[c,d]}]}},{key:"getCloudFxTween",value:function(e){return"multi-tile-cloud"===e.effect.type?this.getMultiTileCloudFxTween(e.effect,e):this.getSingleTileCloudFxTween(e.effect,e)}},{key:"getMultiTileCloudFxTween",value:function(e,t){var n=t.manager,i=t.board,a=t.delay,o=void 0===a?0:a;e.cloud.node.active=!0;var r=e.cloud.getMoveToScreenTween(e.worldPosition,"left"),l=re(this.node).delay(.4).call(this.clearTiles.bind(this,n,i,[e.tiles],.05)),s=re(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,e.tiles[0].node.worldPosition)),u=e.cloud.getLightningTween(e.tiles[0].node.worldPosition),c=e.cloud.getLightningTween(e.tiles[1].node.worldPosition),d=re(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,e.tiles[1].node.worldPosition)),h=re(this.node).parallel(u,s),p=re(this.node).delay(.3).parallel(c,d),y=e.cloud.getMoveOutScreenTween("left");return re(this.node).delay(o).then(r).parallel(l,h,p).then(y).call((function(){e.cloud.node.active=!1}))}},{key:"getSingleTileCloudFxTween",value:function(e,t){var n=t.manager,i=t.board,a=t.delay,o=void 0===a?0:a,r=e.clouds[0],l=e.clouds[1];r.cloud.node.active=!0,l.cloud.node.active=!0;var s=re(this.node).delay(.6).call(this.clearTiles.bind(this,n,i,[e.tiles],.1)),u=r.cloud.getMoveToScreenTween(r.worldPosition,"right"),c=r.cloud.getLightningTween(e.tiles[0].node.worldPosition).then(r.cloud.getMoveOutScreenTween("right")),d=re(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,r.tile.node.worldPosition)),h=re(this.node).delay(.1).then(l.cloud.getMoveToScreenTween(l.worldPosition,"left")),p=l.cloud.getLightningTween(e.tiles[1].node.worldPosition).then(l.cloud.getMoveOutScreenTween("left")),y=re(this.node).delay(.2).call(n.createClearExplosionAt.bind(n,l.tile.node.worldPosition)),v=re(this.node).then(u).parallel(c,d).call((function(){r.cloud.node.active=!1})),f=re(this.node).then(h).parallel(p,y).call((function(){l.cloud.node.active=!1}));return re(this.node).delay(o).parallel(v,f,s)}},{key:"clearTiles",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.shakeGame(),e.shakeScreen(500),w.playSound(Qi.THUNDERBOLT),t.clear({pairs:n,stagger:i,lightning:!0,delay:1.5}),e.node.scene.emit(Js.ADD_COMBO),e.node.scene.emit(Js.ADD_SCORE)}}]),d}(te)).prototype,"properties",[CO,EO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new IO}}),AO=TO))||AO);X._RF.pop(),X._RF.push({},"2913d3KShhIEaPfSLUhFqvA","EffectManager",void 0);var RI=Ludex.Utils.Valid,_I=Z.ccclass,DI=Z.property,NI=codex.monitorError,MI=(RO=_I("EffectManager"),_O=Yn.required(),DO=DI({group:{name:"Thunder Effect",style:"section"},type:II}),NO=Yn.required(),MO=DI({group:{name:"Mask Effect",style:"section"},type:qr}),FO=Yn.required(),BO=DI({group:{name:"Mask Effect",style:"section"},type:me}),xO=Yn.required(),zO=DI({group:{name:"Tornado Effect",style:"section"},type:me}),UO=Yn.required(),GO=DI({group:{name:"Clear Particle Effect",style:"section"},type:me,displayName:"Particle holder node"}),HO=Yn.required(),qO=DI({group:{name:"Clear Particle Effect",style:"section"},type:zT,displayName:"Emitter 1"}),VO=Yn.required(),$O=DI({group:{name:"Clear Particle Effect",style:"section"},type:zT,displayName:"Emitter 2"}),WO=Yn.required(),KO=DI({group:{name:"Star Particles Effect",style:"section"},type:RP}),jO=Yn.required(),YO=DI({group:{name:"Confetti Effect",style:"section"},type:zT}),XO=Yn.required(),JO=DI({group:{name:"Confetti Effect",style:"section"},type:zT}),ZO=DI({group:{name:"Add Item Effect",style:"section"},type:HT}),QO=DI({group:{name:"Add Item Effect",style:"section"},type:xe}),eI=DI({group:{name:"Add Item Effect",style:"section"},type:xe}),tI=DI({group:{name:"Add Item Effect",style:"section"},type:xe}),nI=DI({group:{name:"Add Item Effect",style:"section"},type:xe}),iI=Yn.required(),aI=DI({type:me,displayName:"Clear Explosion Container",group:{name:"Clear Explosion Effect",style:"section"}}),oI=Yn.onlyRunInLifeCycle,rI=Yn.onlyRunInLifeCycleAsync,RO(((AI=function(a){n(T,a);var u,d,h,y,v,f,g,m,b,w,S,C,E,A=i(T);function T(){var e;t(this,T);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=A.call.apply(A,[this].concat(i)),l(e,"cloudEffect",uI,s(e)),l(e,"backgroundMask",cI,s(e)),l(e,"masks",dI,s(e)),l(e,"tornadoContainer",hI,s(e)),l(e,"clearParticleHolder",pI,s(e)),l(e,"clearParticle1",yI,s(e)),l(e,"clearParticle2",vI,s(e)),l(e,"starParticle",fI,s(e)),l(e,"leftConfetti",gI,s(e)),l(e,"rightConfetti",mI,s(e)),l(e,"itemEffect",bI,s(e)),l(e,"hintSpriteFrame",wI,s(e)),l(e,"thunderSpriteFrame",SI,s(e)),l(e,"tornadoSpriteFrame",kI,s(e)),l(e,"pliersSpriteFrame",CI,s(e)),e.maskTargets=[],e.vibrate=null,e.gameShakeSignal=new Mi,l(e,"clearExplosionContainer",EI,s(e)),e}return e(T,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,T)}},{key:"onLoad",value:function(){this.clearParticleHolder.active=!1,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1}},{key:"update",value:function(){if(this.maskTargets.length>0)for(var e=0;e<this.maskTargets.length;e++){var t=this.maskTargets[e];if(!t.isHidden()){var n=this.masks[e];n&&n.setWorldPosition(t.node.worldPosition)}}}},{key:"onEnable",value:function(){this.node.scene.on(Js.GRID_RESIZE,this.handleBoardResize,this)}},{key:"onDisable",value:function(){this.node.scene.off(Js.GRID_RESIZE,this.handleBoardResize,this)}},{key:"handleBoardResize",value:function(e){if(this.clearParticleHolder.setScale(e,e),this.clearExplosionContainer.setScale(e,e),P.isLandscape()){var t=Ie.clamp(e,1,1.5);this.cloudEffect.node.setScale(t,t)}else this.cloudEffect.node.setScale(1,1)}},{key:"playClearEffectAt",value:function(e){var t=this,n=e[0],i=n.x,a=n.y,o=e[1],r=o.x,l=o.y,s=this.clearParticle1.node.worldPosition.z,u=this.clearParticle2.node.worldPosition.z;this.clearParticleHolder.active=!0,this.clearParticle1.node.setWorldPosition(i,a,s),this.clearParticle2.node.setWorldPosition(r,l,u),this.clearParticle1.play(),this.clearParticle2.play(),this.scheduleOnce((function(){t.clearParticleHolder.active=!1}),this.clearParticle1.duration)}},{key:"playStarEffectAt",value:function(e){this.starParticle.fireShiningStarAt(e)}},{key:"playConfettiEffect",value:function(){var e,t,n=this;null===(e=this.node.parent)||void 0===e||e.addChild(this.leftConfetti.node),this.rightConfetti.node.parent!==this.node.parent&&(null===(t=this.node.parent)||void 0===t||t.addChild(this.rightConfetti.node));var i=P.isLandscape(),a=i?50:30,o=i?5e3:2e3,r=i?15e3:1e4,l=i?40:60,s=i?110:100,u=i?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=a,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=o,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=r,this.leftConfetti.shapeModule.angle=l,this.rightConfetti.shapeModule.angle=s,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=u,this.leftConfetti.node.active=!1,this.rightConfetti.node.active=!1,this.leftConfetti.play(),this.rightConfetti.play(),this.scheduleOnce((function(){n.leftConfetti.node.active=!1}),this.leftConfetti.duration),this.scheduleOnce((function(){n.rightConfetti.node.active=!1}),this.rightConfetti.duration)}},{key:"playTornadoAnimation",value:(E=o((function*(){var e=this,t=this.tornadoSpineNode.getComponent("sp.Skeleton");if(t)return new Promise((function(n){e.tornadoSpineNode.active=!0,t.setAnimation(0,"tornado_alone",!1),t.setCompleteListener((function(){n(),e.tornadoSpineNode.active=!1}))}))})),function(){return E.apply(this,arguments)})},{key:"playThunderAnimation",value:(C=o((function*(e,t){var n=this;this.resetMasks();var i=k(e,2),a=k(i[0],2),o=a[0],r=a[1],l=k(i[1],2),s=l[0],u=l[1];this.maskTargets=[o,r,s,u],this.maskTargets.forEach((function(e,t){n.setMaskProperties(t,e.node.worldPosition,e.node.worldScale)})),yield this.setBackgroundMaskActive(!0),yield this.cloudEffect.playThunderAnimations({manager:this,board:t,pairs:e}),this.setBackgroundMaskActive(!1)})),function(e,t){return C.apply(this,arguments)})},{key:"playItemAddAnimation",value:(S=o((function*(e,t,n){var i,a=null===(i=ee.getScene())||void 0===i?void 0:i.getChildByName("Canvas");if(null!=a){var o=n.itemType;if(o){switch(this.itemEffect.node.active=!0,this.itemEffect.node.setParent(a),this.itemEffect.node.setWorldPosition(e,t,this.itemEffect.node.worldPosition.z),this.itemEffect.node.setScale(be.ONE),o){case _.HINT:this.itemEffect.sprite.spriteFrame=this.hintSpriteFrame;break;case _.THUNDER:this.itemEffect.sprite.spriteFrame=this.thunderSpriteFrame;break;case _.STORM:this.itemEffect.sprite.spriteFrame=this.tornadoSpriteFrame;break;case _.PLIERS:this.itemEffect.sprite.spriteFrame=this.pliersSpriteFrame}var r=T.FULL_ANIM_USED_ON_ADD_ITEM[o];T.FULL_ANIM_USED_ON_ADD_ITEM[o]=!0,yield KT(this.itemEffect,n,r),this.itemEffect.node.active=!1}}})),function(e,t,n){return S.apply(this,arguments)})},{key:"playMultiThunderAnimation",value:(w=o((function*(e,t,n){this.resetMasks(),yield this.cloudEffect.playMultiThunderAnimation({manager:this,pairs:e,board:t,stagger:n}),yield this.setBackgroundMaskActive(!1)})),function(e,t,n){return w.apply(this,arguments)})},{key:"shakeScreen",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.vibrate=null!==(e=this.vibrate)&&void 0!==e?e:this.node.getComponent(qy),null===(t=this.vibrate)||void 0===t||t.vibrate(n)}},{key:"preloadEffects",value:function(){this.loadDefuseExplosionPool(),this.loadBombExplosionPool(),this.loadClearExplosionPool(),this.loadTornadoSpine()}},{key:"loadDefuseExplosionPool",value:(b=o((function*(){if(this.defuseExplosionPool)return this.defuseExplosionPool;var e=yield r.loadPrefabAsync(D.BOMB_DEFUSE_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.defuseExplosionPool=function(e,t){return new Qb((function(){var n=qe(e),i=n.getComponent(ze);if(!i)throw new Error("DefuseExplosion: No animation component found in bombDefuseExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.node),this.defuseExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createDefuseExplosionAt")}})),function(){return b.apply(this,arguments)})},{key:"loadBombExplosionPool",value:(m=o((function*(){if(this.bombExplosionPool)return this.bombExplosionPool;var e=yield r.loadPrefabAsync(D.BOMB_EXPLODE_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.bombExplosionPool=function(e,t){return new Qb((function(){var n=qe(e),i=n.getComponent(ze);if(!i)throw new Error("BombExplosion: No animation component found in bombExplosionPrefab");return t.addChild(n),n.active=!1,{node:n,animation:i}}),1,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.node),this.bombExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createBombExplosionAt")}})),function(){return m.apply(this,arguments)})},{key:"loadClearExplosionPool",value:(g=o((function*(){if(this.clearExplosionPool)return this.clearExplosionPool;var e=yield r.loadPrefabAsync(D.CLEAR_EXPLOSION_PREFAB);if(this.isValid&&this.node.activeInHierarchy){if(null!==e)return this.clearExplosionPool=function(e,t){return new Qb((function(){var n=qe(e),i=n.getComponent(ne),a=n.getComponent(ze);if(!i||!a)throw new Error("ClearExplosion: Invalid prefab");return t.addChild(n),n.active=!1,{node:n,uiTransform:i,animation:a}}),2,(function(e){e.node.active=!0}),(function(e){e.node.active=!1}),(function(e){e.node.destroy()}))}(e,this.clearExplosionContainer),this.clearExplosionPool;this.reportOrThrowInDebugger("Failed to load prefab","createClearExplosionAt")}})),function(){return g.apply(this,arguments)})},{key:"loadTornadoSpine",value:(f=o((function*(){var e=yield r.loadPrefabAsync(D.TORNADO_SPINE_PREFAB);if(this.isValid&&this.node.activeInHierarchy)if(null!==e){var t=qe(e);t.active=!1,this.tornadoContainer.addChild(t),this.tornadoSpineNode=t}else this.reportOrThrowInDebugger("Failed to load prefab","loadTornadoSpine")})),function(){return f.apply(this,arguments)})},{key:"createDefuseExplosionAt",value:(v=o((function*(e,t){var n=yield this.loadDefuseExplosionPool();if(n){var i=n.alloc(),a=i.node,o=i.animation;a.setWorldPosition(e,t,0),yield p.runAnimationAsync(o),n.free(i)}})),function(e,t){return v.apply(this,arguments)})},{key:"createBombExplosionAt",value:(y=o((function*(e){var t=yield this.loadBombExplosionPool();if(t){var n=t.alloc(),i=n.node,a=n.animation;i.setWorldPosition(e),yield p.runAnimationAsync(a),t.free(n)}})),function(e){return y.apply(this,arguments)})},{key:"createClearExplosionAt",value:(h=o((function*(e){var t,n=yield this.loadClearExplosionPool();if(n){var i=n.alloc(),a=i.node,o=i.animation;a.setWorldPosition(e),null===(t=a.getComponentInChildren(zT))||void 0===t||t.play(),yield p.runAnimationAsync(o),n.free(i)}})),function(e){return h.apply(this,arguments)})},{key:"setBackgroundMaskActive",value:(d=o((function*(e){yield this.backgroundMask.changeStateFade(e,.25)})),function(e){return d.apply(this,arguments)})},{key:"resetMasks",value:function(){var e,t=c(this.masks);try{for(t.s();!(e=t.n()).done;){e.value.worldPosition=new be(-9999,-9999,0)}}catch(e){t.e(e)}finally{t.f()}}},{key:"setMaskProperties",value:function(e,t,n){var i=this.masks[e];i&&(n&&(i.worldScale=n),i.worldPosition=t)}},{key:"shakeGame",value:(u=o((function*(){var e=this;this.gameShakeSignal.abort();var t=new Mi;this.gameShakeSignal=t;var n=this.node.position.clone(),i=Ge(-10,10),a=Ge(-10,10),o=n.clone().add3f(i,a,0),r=n.clone().add3f(-i,-a,0),l=re(this.node).to(.05,{position:o}).to(.05,{position:r}).to(.05,{position:n}),s=function(){return e.node.setPosition(n)};t.addAbortListener(s),yield p.runTweenAsync(l,t),t.removeAbortListener(s)})),function(){return u.apply(this,arguments)})},{key:"reportOrThrowInDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown error thrown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Board",n=new Error("".concat(t,": ").concat(e));if(RI.isDebugger())throw n;null==NI||NI.sendException(n)}}]),T}(te)).FULL_ANIM_USED_ON_ADD_ITEM=(E(TI={},_.HINT,!1),E(TI,_.THUNDER,!1),E(TI,_.STORM,!1),E(TI,_.PLIERS,!1),TI),uI=a((sI=AI).prototype,"cloudEffect",[_O,DO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cI=a(sI.prototype,"backgroundMask",[NO,MO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dI=a(sI.prototype,"masks",[FO,BO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hI=a(sI.prototype,"tornadoContainer",[xO,zO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pI=a(sI.prototype,"clearParticleHolder",[UO,GO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yI=a(sI.prototype,"clearParticle1",[HO,qO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vI=a(sI.prototype,"clearParticle2",[VO,$O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fI=a(sI.prototype,"starParticle",[WO,KO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gI=a(sI.prototype,"leftConfetti",[jO,YO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mI=a(sI.prototype,"rightConfetti",[XO,JO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bI=a(sI.prototype,"itemEffect",[ZO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wI=a(sI.prototype,"hintSpriteFrame",[QO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SI=a(sI.prototype,"thunderSpriteFrame",[eI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kI=a(sI.prototype,"tornadoSpriteFrame",[tI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CI=a(sI.prototype,"pliersSpriteFrame",[nI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EI=a(sI.prototype,"clearExplosionContainer",[iI,aI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(sI.prototype,"shakeScreen",[oI],Object.getOwnPropertyDescriptor(sI.prototype,"shakeScreen"),sI.prototype),a(sI.prototype,"shakeGame",[rI],Object.getOwnPropertyDescriptor(sI.prototype,"shakeGame"),sI.prototype),lI=sI))||lI);X._RF.pop(),X._RF.push({},"062f3AVHntKsIyireZmXg9P","GuideKeys",void 0);var FI="newbie",BI="timer",xI="combo",zI="hint-item",UI="thunder-item",GI="storm-item",HI="pliers-item",qI="custom-mode";X._RF.pop(),X._RF.push({},"6448denZfFEUru9tWmWGb7N","Guide01Newbie",void 0);var VI=function(){function n(e){var i=this;t(this,n),this.alignSkipButton=function(){var e=i.gameplay.board,t=i.manager.guideUi.guideSkipButton;if(t){var n=t.parent;if(n){var a=e.getBoundingBoxWorld(),o=a.yMax,r=a.xMax,l=v.cssSizeToWorldSize(v.getScreenHeightCss()),s=r-n.getComponent(ne).width/2,u=Math.min(o+100,o+(l-o)/2);n.setWorldPosition(s,u,0)}}},this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:function(){this.currentStep=0,this.manager.node.scene.on(Js.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.on(Js.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.on(Js.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.on(ne.EventType.SIZE_CHANGED,this.alignSkipButton,this),this.showStep(this.currentStep),this.manager.node.scene.emit(Js.HIDE_UI)}},{key:"showNextStep",value:function(){this.currentStep+1<Em.length?(this.currentStep+=1,this.showStep(this.currentStep)):this.close()}},{key:"showStep",value:(a=o((function*(e){var t=Em[e];if(t){var n=this.gameplay,i=n.board,a=n.effectManager,o=t.startTile,r=t.endTile,l=i.getTileAt(o.x,o.y),s=i.getTileAt(r.x,r.y);if(l&&s){var u=l.node.worldPosition,c=s.node.worldPosition;a.resetMasks(),a.setMaskProperties(0,u,l.node.worldScale),a.setMaskProperties(1,c,s.node.worldScale),a.setBackgroundMaskActive(!0);var d=this.manager.guideUi,h=d.guideHand,p=d.guideTextBox,y=d.guideSkipButton;h.node.active=!0,y.active=!0,h.playHandAnimation(u,c),this.alignGuideTextBox(),this.alignSkipButton(),yield p.hide(),p.setLocalizedText(t.localeTextKey),yield p.show(),i.setIgnoreInput(!0),l.setIgnoreInput(!1),s.setIgnoreInput(!1),this.gameplay.comboManager.setEmitEvent(!1)}}})),function(e){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=Em[this.currentStep];if(e){var t=this.gameplay,n=t.board,i=t.effectManager,a=e.startTile,o=e.endTile,r=n.getTileAt(a.x,a.y),l=n.getTileAt(o.x,o.y);if(r&&l){var s=r.node.worldPosition,u=l.node.worldPosition;i.setMaskProperties(0,s,r.node.worldScale),i.setMaskProperties(1,u,l.node.worldScale),this.alignGuideTextBox(),this.alignSkipButton()}}}},{key:"alignGuideTextBox",value:function(){var e=this.gameplay.board,t=this.manager.guideUi.guideTextBox,n=e.getBoundingBoxWorld(),i=n.width,a=n.yMin,o=n.center.x,r=t.widget.bottom+(a-t.widget.bottom)/2;t.node.setWorldPosition(o,r,0);var l=Math.max(Math.min(223,.85*(a-t.widget.bottom)),10);t.uiTransform.setContentSize(i,l)}},{key:"close",value:(i=o((function*(){var e=this.gameplay,t=e.board,n=e.effectManager;this.manager.node.scene.off(Js.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.off(Js.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.off(Js.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.off(ne.EventType.SIZE_CHANGED,this.alignSkipButton,this),t.setIgnoreInput(!1),yield Promise.all([this.manager.guideUi.guideTextBox.hide(),n.setBackgroundMaskActive(!1)]),this.manager.guideUi.guideHand.node.active=!1,this.manager.completeGuide(FI)})),function(){return i.apply(this,arguments)})}]),n}();X._RF.pop(),X._RF.push({},"a52daB3sGxP8JyGBZo5K1+X","Guide02Timer",void 0);var $I=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;t.node.active=!0,n.node.active=!0,i.key="guide.timer",n.horizontalAlign=ut.CENTER,n.getComponent(ne).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this)})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.currentLayout.clock,a=i.getComponent(ne).contentSize,o=a.width,r=a.height,l=i.node.worldPosition,s=P.isPortrait()?l.y-r/2-50:l.y+r/2+70;o*=1.5,r*=1.5,t.setOtherMaskTransform(l.x,l.y,o,r),n.node.setWorldPosition(l.x,s,0)}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideInfoText,n=e.guideMasks;this.gameplay.comboManager.setEmitEvent(!0),this.gameplay.stateManager.isPlaying()&&this.manager.node.scene.emit(Js.RESUME_TIME),yield n.hide(),t.node.active=!1,this.manager.completeGuide(BI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"add56o6JFNHAZiCO6F+Z9jK","Guide03Combo",void 0);var WI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;t.node.active=!0,n.node.active=!0,i.key="guide.combo",n.horizontalAlign=ut.RIGHT,n.getComponent(ne).setAnchorPoint(1,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this)})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=this.gameplay.uiManager.comboContainer,a=i.getComponent(ne).contentSize,o=a.width,r=a.height,l=1.5*i.node.scale.x,s=i.node.worldPosition;o*=l,r*=l,t.setOtherMaskTransform(s.x,s.y,o,r),n.node.setWorldPosition(s.x-o/2-10,s.y,0)}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText;this.manager.node.scene.emit(Js.RESUME_TIME),t.node.off(me.EventType.TOUCH_START,this.close,this),yield t.hide(),n.node.active=!1,this.manager.completeGuide(xI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"unlistenEvents",value:function(){se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"fd93d+WLXVHk4yJGmVeSjmR","Guide04Hint",void 0);var KI=Ludex.Utils.Array,jI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;KI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.HINT}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.hint",n.horizontalAlign=ut.CENTER,n.getComponent(ne).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Js.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=KI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.HINT}));if(a){var o=a.node.worldPosition,r=a.getComponent(ne).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),P.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(P.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new be(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Js.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(zI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Js.USE_ITEM,_.HINT),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Js.ITEM_MASK_CLICKED,this.useItem,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"b08f4dC/r1EPbsfAe1wtcBg","Guide05Thunder",void 0);var YI=Ludex.Utils.Array,XI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;YI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.THUNDER}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.thunder",n.horizontalAlign=ut.CENTER,n.getComponent(ne).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Js.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=YI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.THUNDER}));if(a){var o=a.node.worldPosition,r=a.getComponent(ne).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),P.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(P.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new be(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Js.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(UI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Js.USE_ITEM,_.THUNDER),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Js.ITEM_MASK_CLICKED,this.useItem,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"f4ef8MBZxxKC4bfuDzsLQ5X","Guide06Storm",void 0);var JI=Ludex.Utils.Array,ZI=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;JI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.STORM}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.storm",n.horizontalAlign=ut.CENTER,n.getComponent(ne).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Js.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=JI.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.STORM}));if(a){var o=a.node.worldPosition,r=a.getComponent(ne).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),P.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(P.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new be(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Js.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(GI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Js.USE_ITEM,_.STORM),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Js.ITEM_MASK_CLICKED,this.useItem,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"9920dDqYP9ITJp0bSlZ+K9R","Guide07Pliers",void 0);var QI,eR,tR,nR,iR,aR,oR,rR,lR,sR=Ludex.Utils.Array,uR=function(){function n(e){t(this,n),this.manager=e,this.gameplay=e.gameplay}var i,a;return e(n,[{key:"setup",value:(a=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideInfoTextLocalizer;sR.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.PLIERS}))&&(t.node.active=!0,n.node.active=!0,i.key="guide.pliers",n.horizontalAlign=ut.CENTER,n.getComponent(ne).setAnchorPoint(.5,.5),this.handleViewResized(),yield t.show(),this.manager.node.scene.once(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.once(Js.ITEM_MASK_CLICKED,this.useItem,this),this.manager.node.scene.emit(Js.PAUSE_TIME),se.on(y.VIEW_RESIZED,this.handleViewResized,this),se.on(y.ORIENTATION_CHANGED,this.handleViewResized,this))})),function(){return a.apply(this,arguments)})},{key:"handleViewResized",value:function(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton,a=sR.search(this.gameplay.uiManager.items,(function(e){return e.itemType===_.PLIERS}));if(a){var o=a.node.worldPosition,r=a.getComponent(ne).contentSize,l=r.width,s=r.height;if(l+=40,s+=40,t.setItemMaskTransform(o.x,o.y,l,s),i.node.active=!0,i.setTransform(o.x,o.y,l,s),P.isPortrait())n.node.setPosition(0,0),n.node.setWorldPosition(n.node.worldPosition.x,o.y+s/2+30,0);else if(P.isLandscape()){var u=this.gameplay.uiManager.currentLayout.clock,c=new be(u.node.worldPosition.x,u.node.worldPosition.y-750,0);n.node.worldPosition=c}}}},{key:"close",value:(i=o((function*(){var e=this.manager.guideUi,t=e.guideMasks,n=e.guideInfoText,i=e.guideItemButton;this.manager.node.scene.emit(Js.RESUME_TIME),yield t.hide(),n.node.active=!1,i.node.active=!1,this.manager.completeGuide(HI),this.unlistenEvents()})),function(){return i.apply(this,arguments)})},{key:"useItem",value:function(){this.manager.node.scene.emit(Js.USE_ITEM,_.PLIERS),this.close()}},{key:"unlistenEvents",value:function(){this.manager.node.scene.off(Js.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.off(Js.ITEM_MASK_CLICKED,this.useItem,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this),se.off(y.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),n}();X._RF.pop(),X._RF.push({},"8ab11Ocp6VMg5ZkRHXv4Odu","GuideHand",void 0);var cR,dR=Z.ccclass,hR=Z.property,pR=(QI=dR("GuideHand"),eR=hR(me),tR=hR(me),nR=hR(de),QI((oR=a((aR=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"hand",oR,s(e)),l(e,"circleHighlight",rR,s(e)),l(e,"circleHighlightOpacity",lR,s(e)),e}return e(r,[{key:"start",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255}},{key:"playHandAnimation",value:function(e,t){var n=this;this.handTween&&this.handTween.stop();var i=re(this.hand).to(.8,{worldPosition:t},{easing:"quartOut"}).to(.2,{scale:new be(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:be.ONE,angle:0}).to(.8,{worldPosition:e},{easing:"quartOut"}).to(.2,{scale:new be(.9,.9,.9),angle:15}).call((function(){n.playHighlightAnimation()})).to(.2,{scale:be.ONE,angle:0});this.handTween=re(this.hand).repeatForever(i).start()}},{key:"playHighlightAnimation",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255,this.circleHighlight.position=this.hand.position.clone(),re(this.circleHighlight).to(.6,{scale:new be(1.5,1.5)},{easing:"quadOut"}).start(),re(this.circleHighlightOpacity).to(.6,{opacity:0},{easing:"quadIn"}).start()}}]),r}(te)).prototype,"hand",[eR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rR=a(aR.prototype,"circleHighlight",[tR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lR=a(aR.prototype,"circleHighlightOpacity",[nR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iR=aR))||iR);X._RF.pop(),X._RF.push({},"763fe/xz6FAU5qOW2sRJ//R","GuideItemButton",void 0);var yR,vR,fR,gR,mR,bR,wR,SR=(0,Z.ccclass)("GuideItemButton")(cR=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.uiTransform=this.node.getComponent(ne)}},{key:"setTransform",value:function(e,t,n,i){this.node.setWorldPosition(e,t,0),this.uiTransform.setContentSize(n,i)}},{key:"onClick",value:function(){this.node.scene.emit(Js.ITEM_MASK_CLICKED)}}]),r}(te))||cR;X._RF.pop(),X._RF.push({},"b2213ccDllApaGIouur6a6b","GameMask",void 0);var kR,CR,ER,AR,TR,PR,LR,OR,IR=Z.ccclass,RR=Z.property,_R=(yR=IR("GameMask"),vR=RR(ne),fR=RR(he),yR((bR=a((mR=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"uiTransform",bR,s(e)),l(e,"sprite",wR,s(e)),e}return e(r,[{key:"texture",get:function(){return this.sprite.spriteFrame.texture}}]),r}(te)).prototype,"uiTransform",[vR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wR=a(mR.prototype,"sprite",[fR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gR=mR))||gR);X._RF.pop(),X._RF.push({},"ad9c7KiarJHXpRRfn9GOaVx","AlphaMasks",void 0);var DR,NR,MR,FR,BR,xR,zR,UR,GR,HR=Z.ccclass,qR=Z.property,VR=Z.executeInEditMode,$R=(kR=HR("AlphaMasks"),CR=VR(!0),ER=qR(_R),AR=Yn.required(),kR(TR=CR((LR=a((PR=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"masks",LR,s(e)),l(e,"UITransform",OR,s(e)),e}return e(r,[{key:"__preload",value:function(){this.UITransform=this.node.getComponent(ne)}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"start",value:function(){var e;this.material=null===(e=this.getComponent(he))||void 0===e?void 0:e.getMaterialInstance(0);var t,n=c(this.masks.entries());try{for(n.s();!(t=n.n()).done;){var i=k(t.value,2),a=i[0],o=i[1];this.material.setProperty("mask".concat(a,"Texture"),o.texture)}}catch(e){n.e(e)}finally{n.f()}}},{key:"update",value:function(){var e=this;if(this.material){var t=this.UITransform,n=t.width,i=t.height;this.masks.forEach((function(t,a){var o=t.uiTransform,r=o.width,l=o.height,s=o.anchorX,u=o.anchorY,c=r*t.node.scale.x,d=l*t.node.scale.y,h=new De(c/n,d/i),p=new De(.5+(.5-s)*h.x,.5-(.5-u)*h.y),y=new De(p.x+(t.node.worldPosition.x-e.node.worldPosition.x)/n,p.y-(t.node.worldPosition.y-e.node.worldPosition.y)/i);e.material.setProperty("ratio".concat(a),h),e.material.setProperty("center".concat(a),y)}))}}},{key:"setMaskActive",value:function(e,t){var n;e>=this.masks.length||null===(n=this.material)||void 0===n||n.setProperty("useMask".concat(e),t?1:0)}}]),r}(te)).prototype,"masks",[ER],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),OR=a(PR.prototype,"UITransform",[AR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TR=PR))||TR)||TR);X._RF.pop(),X._RF.push({},"69569cXv55L852IkWTL0swz","GuideMasks",void 0);var WR,KR,jR,YR,XR,JR,ZR,QR,e_,t_,n_,i_,a_,o_,r_,l_,s_,u_,c_=Z.ccclass,d_=Z.property,h_=(DR=c_("GuideMasks"),NR=d_(qr),MR=d_($R),FR=d_(fe),DR((zR=a((xR=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"background",zR,s(e)),l(e,"alphaMasks",UR,s(e)),l(e,"maskButtonComponent",GR,s(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(u=o((function*(){this.maskButtonComponent.enabled=!0,yield this.background.changeStateFade(!0,.25)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(r=o((function*(){this.maskButtonComponent.enabled=!1,yield this.background.changeStateFade(!1,.25)})),function(){return r.apply(this,arguments)})},{key:"onClick",value:function(){this.node.scene.emit(Js.GUIDE_MASK_CLICKED)}},{key:"setOtherMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[1].node.worldPosition=new be(-9999,-9999,0);var a=this.alphaMasks.masks[0];this.setMaskTransform(a,e,t,n,i)}},{key:"setItemMaskTransform",value:function(e,t,n,i){this.alphaMasks.masks[0].node.worldPosition=new be(-9999,-9999,0);var a=this.alphaMasks.masks[1];this.setMaskTransform(a,e,t,n,i)}},{key:"setMaskTransform",value:function(e,t,n,i,a){e.uiTransform.setContentSize(i,a),e.node.setWorldPosition(t,n,0)}}]),d}(te)).prototype,"background",[NR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UR=a(xR.prototype,"alphaMasks",[MR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GR=a(xR.prototype,"maskButtonComponent",[FR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BR=xR))||BR);X._RF.pop(),X._RF.push({},"abfb9zudJhHdZfeUgbnBrs0","GuideTextBox",void 0);var p_,y_,v_,f_,g_,m_,b_,w_,S_,k_,C_,E_,A_,T_,P_,L_,O_,I_,R_,__,D_,N_,M_,F_,B_=Z.ccclass,x_=Z.property,z_=(WR=B_("GuideTextBox"),KR=Yn.required(),jR=x_(ke),YR=Yn.required(),XR=x_(oe),JR=Yn.required(),ZR=x_(ne),QR=Yn.required(),e_=x_(qr),t_=Yn.required(),n_=x_(Lh),WR((o_=a((a_=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"guideText",o_,s(e)),l(e,"widget",r_,s(e)),l(e,"uiTransform",l_,s(e)),l(e,"opacityToggler",s_,s(e)),l(e,"localizer",u_,s(e)),e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}},{key:"setLocalizedText",value:function(e){this.localizer.key=e}},{key:"show",value:(u=o((function*(){yield this.opacityToggler.changeStateFade(!0)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(r=o((function*(){yield this.opacityToggler.changeStateFade(!1)})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"guideText",[KR,jR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r_=a(a_.prototype,"widget",[YR,XR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l_=a(a_.prototype,"uiTransform",[JR,ZR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=a(a_.prototype,"opacityToggler",[QR,e_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u_=a(a_.prototype,"localizer",[t_,n_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=a_))||i_);X._RF.pop(),X._RF.push({},"a2522Y5Q6JGSr90yCp/4qCm","GuideUI",void 0);var U_,G_,H_,q_,V_,$_=Z.ccclass,W_=Z.property,K_=(p_=$_("GuideUI"),y_=Yn.required(),v_=W_(pR),f_=Yn.required(),g_=W_(z_),m_=Yn.required(),b_=W_(ke),w_=Yn.required(),S_=W_(Lh),k_=Yn.required(),C_=W_(h_),E_=Yn.required(),A_=W_(me),T_=Yn.required(),P_=W_(SR),p_((I_=a((O_=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"guideHand",I_,s(e)),l(e,"guideTextBox",R_,s(e)),l(e,"guideInfoText",__,s(e)),l(e,"guideInfoTextLocalizer",D_,s(e)),l(e,"guideMasks",N_,s(e)),l(e,"guideSkipButton",M_,s(e)),l(e,"guideItemButton",F_,s(e)),e}return e(r,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}}]),r}(te)).prototype,"guideHand",[y_,v_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_=a(O_.prototype,"guideTextBox",[f_,g_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),__=a(O_.prototype,"guideInfoText",[m_,b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D_=a(O_.prototype,"guideInfoTextLocalizer",[w_,S_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_=a(O_.prototype,"guideMasks",[k_,C_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M_=a(O_.prototype,"guideSkipButton",[E_,A_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F_=a(O_.prototype,"guideItemButton",[T_,P_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L_=O_))||L_);X._RF.pop(),X._RF.push({},"4d800jyvxFJIYnkeNGud6KJ","GuidelinesManager",void 0);var j_=codex,Y_=j_.player,X_=j_.analytics,J_=Z.ccclass,Z_=Z.property,Q_=Ludex,eD=Q_.Match.Modes,tD=Q_.Plugins.Analytics,nD=(void 0===tD?{}:tD).Events,iD=Q_.Utils.Array,aD=new De(0,10),oD=new De(0,10),rD="READY",lD="RUNNING",sD=(U_=J_("GuidelinesManager"),G_=Z_(K_),U_((V_=a((q_=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"guideUi",V_,s(e)),e.guideHintDelay=null,e.guideStormDelay=null,e}return e(c,[{key:"init",value:function(e){this.gameplay=e,this.status=rD,this.node.scene.on(Js.COMBO_UPDATED,this.startComboGuide,this),this.node.scene.on(Js.TILE_CLICK,this.startAutoGuides,this),this.node.scene.on(Js.USE_ITEM,this.handleUseItem,this),this.node.scene.on(Js.GAME_FINISH,this.stopAutoGuides,this),this.node.scene.on(Js.GAME_REPLAY,this.stopAutoGuides,this),this.node.scene.on(Js.GAME_PAUSE,this.stopAutoGuides,this)}},{key:"show",value:function(){this.isNewbieGuideLevel()?(this.hasGuideItemShowed(FI)&&this.resetGuideItemShowed(),this.startGuide(FI)):this.startGuide(BI)}},{key:"startGuide",value:function(e){if(this.status===lD)return!1;if(this.hasGuideItemShowed(e))return!1;switch(this.addGuideItemShowed(e),this.status=lD,e){case FI:nD&&X_.event(nD.TUTORIAL_BEGIN),this.guide1=new VI(this),this.guide1.setup();break;case BI:this.guide2=new $I(this),this.guide2.setup();break;case xI:this.guide3=new WI(this),this.guide3.setup();break;case zI:this.guide4=new jI(this),this.guide4.setup();break;case UI:this.guide5=new XI(this),this.guide5.setup();break;case GI:this.guide6=new ZI(this),this.guide6.setup();break;case HI:this.guide7=new uR(this),this.guide7.setup()}return!0}},{key:"completeGuide",value:function(e){nD&&X_.event(nD.TUTORIAL_STEP,{step:e}),this.status=rD,this.addGuideItemShowed(e),this.gameplay.stateManager.isPlaying()&&this.startAutoGuides()}},{key:"isHintGuideLevel",value:function(){var e=this.getCurrentLevel(),t=aD.x,n=aD.y;return e>=t&&e<=n}},{key:"isShowErrorPathLevel",value:function(){if(Iv.getMatchMode()===eD.TOURNAMENT)return!1;var e=this.getCurrentLevel(),t=oD.x,n=oD.y;return e>=t&&e<=n}},{key:"isNewbieGuideLevel",value:function(){return 0===this.getCurrentLevel()}},{key:"hasGuideItemShowed",value:function(e){return iD.has(this.getGuideItemShowed(),e)}},{key:"addGuideItemShowed",value:function(e){if(!this.hasGuideItemShowed(e)){var t=this.getGuideItemShowed();t.push(e),Y_.setGameData({guideItemShowed:t})}}},{key:"resetGuideItemShowed",value:function(){Y_.setGameData({guideItemShowed:[]})}},{key:"getGuideItemShowed",value:function(){var e,t;return null!==(e=null===(t=Y_.getGameData())||void 0===t?void 0:t.guideItemShowed)&&void 0!==e?e:[]}},{key:"getCurrentLevel",value:function(){return this.gameplay.levelManager.getLevelData().level}},{key:"startComboGuide",value:function(e){this.isNewbieGuideLevel()||e<2||(this.startGuide(xI),this.node.scene.off(Js.COMBO_UPDATED,this.startComboGuide,this))}},{key:"startAutoGuides",value:function(){this.startHintGuide(),this.startStormGuide()}},{key:"stopAutoGuides",value:function(){null!==this.guideHintDelay&&this.guideHintDelay.stop(),null!==this.guideStormDelay&&this.guideStormDelay.stop()}},{key:"startHintGuide",value:function(){var e=this;this.isHintGuideLevel()&&(null===this.guideHintDelay&&(this.guideHintDelay=re(this.node).delay(5).call((function(){e.isNewbieGuideLevel()||(e.hasGuideItemShowed(zI)&&e.status===rD?e.node.scene.emit(Js.SHOW_HINT):e.startGuide(zI),e.startHintGuide())}))),this.guideHintDelay.stop(),this.guideHintDelay.start())}},{key:"startStormGuide",value:function(){var e=this;null===this.guideStormDelay&&(this.guideStormDelay=new ct(this.node).delay(10).call((function(){e.isNewbieGuideLevel()||e.hasGuideItemShowed(GI)||e.gameplay.itemManager.canUseItem(_.STORM)&&(e.startGuide(GI)||e.startStormGuide())}))),this.guideStormDelay.stop(),this.guideStormDelay.start()}},{key:"startThunderGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(UI)}},{key:"startPliersGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(HI)}},{key:"handleUseItem",value:function(e){switch(this.startAutoGuides(),e){case _.HINT:this.addGuideItemShowed(zI);break;case _.THUNDER:this.addGuideItemShowed(UI);break;case _.STORM:this.addGuideItemShowed(GI);break;case _.PLIERS:this.addGuideItemShowed(HI)}}},{key:"skipNewbieGuide",value:(r=o((function*(){this.guideUi.guideSkipButton.active=!1,yield this.guide1.close();var e=this.getCurrentLevel()+1;Y_.setGameData({level:e}),this.node.scene.emit(Js.NEXT_LEVEL)})),function(){return r.apply(this,arguments)})},{key:"onDestroy",value:function(){var e,t,n,i,a,o;null===(e=this.guide2)||void 0===e||e.unlistenEvents(),null===(t=this.guide3)||void 0===t||t.unlistenEvents(),null===(n=this.guide4)||void 0===n||n.unlistenEvents(),null===(i=this.guide5)||void 0===i||i.unlistenEvents(),null===(a=this.guide6)||void 0===a||a.unlistenEvents(),null===(o=this.guide7)||void 0===o||o.unlistenEvents()}}]),c}(te)).prototype,"guideUi",[G_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H_=q_))||H_);X._RF.pop(),X._RF.push({},"aa973zMvtZFD6GO7rUb6TBF","canUseHintItem",void 0);X._RF.pop(),X._RF.push({},"f3464SQfFhIs5PVRx8JpCO1","canUsePliersItem",void 0);X._RF.pop(),X._RF.push({},"ad5b3eazZ1B3YR8JJm+qvM6","canUseThunderItem",void 0);X._RF.pop(),X._RF.push({},"3b5b1bQTVlDaaFOGKDB5VZk","canUseTornadoItem",void 0);var uD,cD;X._RF.pop(),X._RF.push({},"e1fd9AcoshNdK0i6vow/F2P","ItemManager",void 0);var dD,hD=Z.ccclass,pD=codex.player,yD=(E(uD={},_.HINT,{canActivate:!1,quantity:0}),E(uD,_.THUNDER,{canActivate:!1,quantity:0}),E(uD,_.STORM,{canActivate:!1,quantity:0}),E(uD,_.PLIERS,{canActivate:!1,quantity:0}),uD),vD=hD("ItemManager")(cD=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).itemConfigs=yD,e}return e(r,[{key:"onLoad",value:function(){this.node.scene.on(Js.GRID_CREATE,this.updateItemsConfig,this),this.node.scene.on(Js.GRID_MATCH,this.updateItemsConfig,this),this.node.scene.on(Js.GRID_CLEAR,this.updateItemsConfig,this),this.node.scene.on(Js.GRID_SPAWN,this.updateItemsConfig,this),this.node.scene.on(Js.BOMB_EXPLODE,this.updateItemsConfig,this),this.node.scene.on(Js.REFRESH_ITEMS,this.updateItemsConfig,this)}},{key:"init",value:function(e){this.game=e}},{key:"getQuantity",value:function(e){return this.itemConfigs[e].quantity}},{key:"setQuantity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.max(0,t);this.itemConfigs[e].quantity=i,this.saveQuantity(e,t),this.updateItemConfig(e,n)}},{key:"saveQuantity",value:function(e,t){var n=pD.getGameData();n&&pD.setGameData({items:u(u({},n.items),{},E({},e,t))})}},{key:"canUseItem",value:function(e){var t=this.game,n=t.board,i=t.pathDraw;switch(e){case _.HINT:return function(e,t){return e.getUncleared().length>0&&!1===t.isDrawingHint}(n,i);case _.PLIERS:return function(e){return e.getBombTiles().length>0}(n);case _.STORM:return function(e){return e.getUncleared().length>4}(n);case _.THUNDER:return function(e){return e.getUncleared().length>=4}(n);default:return!1}}},{key:"updateItemsConfig",value:function(){var e=pD.getGameData();if(e&&e.items){for(var t=0,n=Object.keys(this.itemConfigs);t<n.length;t++){var i=n[t],a=this.itemConfigs[i];a.canActivate=this.canUseItem(i),a.quantity=e.items[i]||0}this.game.uiManager.currentLayout.updateStatus({items:this.itemConfigs})}}},{key:"updateItemConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=pD.getGameData();n&&(this.itemConfigs[e].canActivate=this.canUseItem(e),this.itemConfigs[e].quantity=n.items[e]||0,this.game.uiManager.currentLayout.updateStatus(u({items:u(u({},this.itemConfigs),{},E({},e,u({animate:t},this.itemConfigs[e])))},this.game.uiManager.config)))}}]),r}(te))||cD;X._RF.pop(),X._RF.push({},"3f8fenpEyBKaaNxBYL5960v","ScoreManager",void 0);var fD=Z.ccclass,gD=Ludex.Match.Modes,mD=fD("ScoreManager")(dD=function(a){n(s,a);var r,l=i(s);function s(){var e;t(this,s);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=l.call.apply(l,[this].concat(i))).currentScore=0,e}return e(s,[{key:"addScore",value:function(e,t,n){var i=this.getLevelMultiplier(e),a=this.getComboMultiplier(t),o=this.getTimeMultiplier(e,n),r=this.getCustomBonusScoreMultiplier(),l=Math.floor(this.currentScore+10*i*a*o*r),s=10*Math.ceil(l/10);this.setScore(s)}},{key:"init",value:function(){this.initCurrentScore(),this.updateScore()}},{key:"initCurrentScore",value:function(){var e;Iv.getMatchMode()!==gD.TOURNAMENT?this.currentScore=0:this.currentScore=(null===(e=Iv.getMatchCustomData())||void 0===e?void 0:e.score)||0}},{key:"setScore",value:function(e){this.currentScore=e,this.updateScore()}},{key:"updateScore",value:(r=o((function*(){this.node.scene.emit(Js.SCORE_UPDATED,this.currentScore)})),function(){return r.apply(this,arguments)})},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getLevelMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getComboMultiplier",value:function(e){return 1+.1*(e-1)}},{key:"getTimeMultiplier",value:function(e,t){return e<=2?4:1+.05*t}},{key:"getCustomBonusScoreMultiplier",value:function(){return Iv.getMatchMode()!==Nv?1:1+Kv.getCustomBonus()/100}}]),s}(te))||dD;X._RF.pop(),X._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var bD=function(){function n(e){t(this,n),this.game=null,this.data={},this.game=e.getGameplay(),this.manager=e,this.updateStateData(),this.logDebug()}return e(n,[{key:"logDebug",value:function(){var e=this.constructor.name;console.debug("[STATE] ".concat(e),this.data)}},{key:"updateStateData",value:function(){if(this.game){var e=this.game.getGameData();e&&(this.data=e)}}},{key:"updateGameData",value:function(e){var t;null===(t=this.game)||void 0===t||t.setGameData(e)}}]),n}();X._RF.pop(),X._RF.push({},"e4ee7Ho9zJPVKobpdsCwGlp","FailState",void 0);var wD=codex,SD=wD.analytics,kD=wD.storage,CD=Ludex.Match.Modes,ED=function(a){n(d,a);var r,l,s,u,c=i(d);function d(e,n){var i;return t(this,d),i=c.call(this,e),w.stopAllSounds(),i.vibrateDevice(),i.pauseCountdown(),i.updateMatchCustomData(),i.handleGameOver(n),i.logLevelFailAnalytics(),i}return e(d,[{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseTime()}},{key:"vibrateDevice",value:function(){var e;null===(e=Me("Vibrate"))||void 0===e||null===(e=e.getComponent(qy))||void 0===e||e.vibrate(500)}},{key:"handleGameOver",value:function(e){var t=Iv.getMatchMode();t===CD.SINGLE||t===Nv?this.handleSingleGameOver(e):t===CD.TOURNAMENT?this.handleTournamentGameOver():t===CD.CHALLENGE_FRIEND?this.handleChallengeGameOver():this.handleSingleGameOver(e)}},{key:"handleSingleGameOver",value:(u=o((function*(e){var t,n;if(this.game){var i=null!==(t=(yield this.openFailScreenAndWaitForClose(e)).screenData)&&void 0!==t?t:{},a=i.customMode,o=i.rescue;if(a){var r=(null!==(n=(yield x.openScreenAndWaitForClose(z.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==n?n:{}).customMode?Nv:CD.SINGLE;this.game.node.scene.emit(Js.GAME_REPLAY,r)}else o?(this.game.node.scene.emit(Js.SHOW_UI),this.game.node.scene.emit(Js.RESCUE_START)):this.game.node.scene.emit(Js.GAME_REPLAY)}})),function(e){return u.apply(this,arguments)})},{key:"handleTournamentGameOver",value:(s=o((function*(){var e,t,n=this;if(this.game){var i=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;if(i){var a;if(U.validateTournamentExpired(i))return kD.setStorageData("tournament","animateTournamentLeader",!1),x.showNotificationScreenWithLocalizedKey("error.tourEnded",2),void(null===(a=this.game)||void 0===a||a.scheduleOnce((function(){var e;null===(e=n.game)||void 0===e||e.node.scene.emit(Js.GAME_EXIT)}),2));F.setBlockInput(!0);try{var o,r=null!==(o=kD.getStorageData("tournament","previousScore"))&&void 0!==o?o:0,l=this.game.scoreManager.getCurrentScore(),s=l>r;if(s){var u,c,d=(null!==(u=Iv.getMatchCustomData())&&void 0!==u?u:{}).tournamentId;if(!d)return;U.saveTournamentProgress(null!==(c=this.data.level)&&void 0!==c?c:1,l,d)}kD.setStorageData("tournament","animateTournamentLeader",s),yield Iv.finishMatchAsync()}catch(e){console.warn(e)}F.setBlockInput(!1),null===(t=this.game)||void 0===t||t.node.scene.emit(Js.GAME_EXIT)}}})),function(){return s.apply(this,arguments)})},{key:"handleChallengeGameOver",value:(l=o((function*(){if(this.game){F.setBlockInput(!0);try{var e,t=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).challengeData;yield Iv.finishMatchAsync({extraData:{challengeData:t}})}catch(e){console.warn(e)}F.setBlockInput(!1),this.game.node.scene.emit(Js.SHOW_CHALLENGE_RESULTS)}})),function(){return l.apply(this,arguments)})},{key:"openFailScreenAndWaitForClose",value:(r=o((function*(e){var t=this.data.level;return e===Rv&&w.playSound(Qi.LEVEL_FAIL_TIMEOUT),w.playSound(Qi.LEVEL_FAIL),x.openScreenAndWaitForClose(z.RESCUES_SCREEN,{level:t,failKey:e})})),function(e){return r.apply(this,arguments)})},{key:"updateMatchCustomData",value:function(){var e;if(this.game){var t=this.data.level,n=void 0===t?1:t,i=null===(e=this.game)||void 0===e?void 0:e.scoreManager.getCurrentScore();Iv.updateMatchStateAfterLevelFinish(n,i)}}},{key:"logLevelFailAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=Iv.getMatchMode()||void 0;null==SD||SD.levelFail(t,n,i)}}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){}}]),d}(bD);X._RF.pop(),X._RF.push({},"a9bc11SkV9L/5L+Y+fhswfJ","FinishState",void 0);var AD=codex,TD=AD.analytics,PD=AD.player,LD=AD.leaderboard,OD=Ludex,ID=OD.Match.Modes,RD=OD.Utils.Time,_D=OD.Plugins.Ads,DD=(void 0===_D?{}:_D).Types,ND=Ludex.Configs.Ads.NotifyPlayerBeforeShow,MD=function(a){n(g,a);var r,l,s,u,c,d,h,y,v,f=i(g);function g(e){var n;return t(this,g),(n=f.call(this,e)).handleFinishStateFlow(),n}return e(g,[{key:"handleFinishStateFlow",value:(v=o((function*(){if(this.game){this.processCrazyGamesEvent(),this.attemptCallCreateShortcut(),this.game.uiManager.pauseTime();var e=Iv.getMatchMode();this.updatePlayerProgress(),this.updateMatchCustomData(),e===ID.CHALLENGE_FRIEND?this.handleFinishChallenge():e===ID.TOURNAMENT?this.handleFinishTournament():this.handleFinishSingle(),this.logLevelCompleteAnalytics()}})),function(){return v.apply(this,arguments)})},{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"attemptCallCreateShortcut",value:function(){var e=this.data.level;(void 0===e?0:e)<2||DD&&C.isReadyAdShowable(DD.INTERSTITIAL)||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("createShortcutAsync",e)}))}},{key:"updatePlayerProgress",value:function(){var e=this.data.level,t=PD.getGameData();if(this.game&&e&&t){var n=Iv.getMatchMode(),i=t.level,a=e+1,o=Math.max(i,a);if(n===ID.SINGLE||n===Nv)PD.setGameData({level:o});else if(n===ID.TOURNAMENT){var r,l=(null!==(r=Iv.getMatchCustomData())&&void 0!==r?r:{}).tournamentId;if(!l)return;var s=this.game.scoreManager.getCurrentScore();U.saveTournamentProgress(e,s,l)}}}},{key:"updateMatchCustomData",value:function(){if(this.game){var e=this.data.level,t=void 0===e?1:e,n=this.game.scoreManager.getCurrentScore();Iv.updateMatchStateAfterLevelFinish(t,n)}}},{key:"logLevelCompleteAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.scoreManager.getCurrentScore(),i=Iv.getMatchMode()||void 0;null==TD||TD.levelComplete(t,n,i)}}},{key:"handleFinishChallenge",value:(y=o((function*(){if(this.game)try{var e;x.showLoadingScreen();var t=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).challengeData;yield Iv.finishMatchAsync({extraData:{challengeData:t}}),this.game.node.scene.emit(Js.SHOW_CHALLENGE_RESULTS)}catch(e){console.warn("finish challenge error",e)}finally{x.closeLoadingScreen()}})),function(){return y.apply(this,arguments)})},{key:"handleFinishTournament",value:(h=o((function*(){if(this.handlePostTournamentScore(),this.game){var e=this.data.level,t=void 0===e?1:e;w.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),this.game.effectManager.playConfettiEffect(),yield RD.sleepAsync(500),yield C.showInterstitialAdAsync({forLevel:t}),this.game.node.scene.emit(Js.NEXT_LEVEL)}})),function(){return h.apply(this,arguments)})},{key:"handlePostTournamentScore",value:(d=o((function*(){var e;if(this.game){var t=null===(e=this.game)||void 0===e?void 0:e.scoreManager.getCurrentScore();if(t){try{yield GameSDK.tournament.postScoreAsync(t)}catch(e){console.warn("GameSDK post score async",e)}var n=Iv.getMatchCustomData();if(n){var i=n.leaderboardId,a=n.playerId;i&&a&&(yield LD.setLeaderboardScoreAsync(i,a,t))}}}})),function(){return d.apply(this,arguments)})},{key:"handleFinishSingle",value:(c=o((function*(){w.turnUpMusic();var e=this.data.level,t=void 0===e?0:e,n=t>0&&t%5==0;12===t?yield this.handleUnlockCustomMode():(n?yield this.handleFinishHardLevel():yield this.handleFinishNormalLevel(),this.handleNextLevelSingle())})),function(){return c.apply(this,arguments)})},{key:"handleFinishNormalLevel",value:(u=o((function*(){var e,t;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=(null!==(e=PD.getGameData())&&void 0!==e?e:{}).coins,o=void 0===a?0:a,r=(null!==(t=Iv.getMatchCustomData())&&void 0!==t?t:{}).score,l=void 0===r?0:r;ND&&(yield this.game.uiManager.interstitialAdIndicator.flash());var s=GameSDK.isGameSDK("Yandex");s||(yield this.showAdsNormalLevel(.8)),w.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),yield x.openScreenAndWaitForClose(z.LEVEL_COMPLETE_SCREEN,{level:i,coins:o,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1}),s&&(yield this.showAdsNormalLevel())}})),function(){return u.apply(this,arguments)})},{key:"showAdsNormalLevel",value:(s=o((function*(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=null!==(e=PD.getGameData())&&void 0!==e?e:{},o=a.custom;Iv.getMatchMode()===Nv&&null!=o&&o.ads?(this.game.node.scene.emit(Js.HIDE_UI),yield p.waitTweenAsync(t),yield C.showRewardedInterstitialAdAsync({showError:!1})):DD&&C.isReadyAdShowable(DD.INTERSTITIAL)&&(this.game.node.scene.emit(Js.HIDE_UI),yield p.waitTweenAsync(t),yield C.showInterstitialAdAsync({forLevel:i}))}})),function(){return s.apply(this,arguments)})},{key:"handleFinishHardLevel",value:(l=o((function*(){var e,t,n,i,a=this.data.level,o=void 0===a?0:a,r=null!==(e=null===(t=PD.getGameData())||void 0===t?void 0:t.coins)&&void 0!==e?e:0,l=null!==(n=null===(i=Iv.getMatchCustomData())||void 0===i?void 0:i.score)&&void 0!==n?n:0;w.playSound(Qi.LEVEL_COMPLETE,{volume:.5});var s=(yield x.openScreenAndWaitForClose(z.LEVEL_COMPLETE_SCREEN,{level:o,coins:r,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!0})).screenData,u=(null!=s?s:{}).canShowRewardsAd;if(void 0!==u&&u){var c=(yield x.openScreenAndWaitForClose(z.GET_REWARDS_SCREEN)).screenData,d=null!=c?c:{},h=d.getRewardsSuccess,p=void 0!==h&&h,y=d.rewardsAdShown,v=void 0!==y&&y;p&&this.getRewardItems(),yield x.openScreenAndWaitForClose(z.LEVEL_COMPLETE_SCREEN,{level:o,coins:r,score:l,getRewardsSuccess:p,lookingForRewards:!1}),p||v||(yield C.showInterstitialAdAsync({forLevel:o}))}else yield C.showInterstitialAdAsync({forLevel:o})})),function(){return l.apply(this,arguments)})},{key:"handleUnlockCustomMode",value:(r=o((function*(){var e,t;if(this.game){var n=this.data.level,i=void 0===n?0:n,a=(null!==(e=PD.getGameData())&&void 0!==e?e:{}).coins,o=void 0===a?0:a,r=(null!==(t=Iv.getMatchCustomData())&&void 0!==t?t:{}).score,l=void 0===r?0:r;w.playSound(Qi.LEVEL_COMPLETE,{volume:.5}),yield x.openScreenAndWaitForClose(z.LEVEL_COMPLETE_SCREEN,{level:i,coins:o,score:l,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1}),G.switchToDashboardScene()}})),function(){return r.apply(this,arguments)})},{key:"handleNextLevelSingle",value:function(){var e=this.data.level,t=PD.getGameData();this.game&&e&&t&&this.game.node.scene.emit(Js.NEXT_LEVEL)}},{key:"getRewardItems",value:function(){this.game&&(this.game.node.scene.emit(Js.ADD_ITEM,{item:_.STORM,quantity:1}),this.game.node.scene.emit(Js.ADD_ITEM,{item:_.THUNDER,quantity:1}))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),g}(bD);X._RF.pop(),X._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var FD=codex,BD=FD.player,xD=FD.match,zD=Ludex,UD=zD.Match.Modes,GD=zD.Plugins.Ads,HD=(void 0===GD?{}:GD).Types,qD=function(a){n(v,a);var r,l,s,c,d,h,y=i(v);function v(e){var n;return t(this,v),(n=y.call(this,e)).clearBoard(),n.initAdPreload(),n.initCountdown(),n.initScore(),n.loadLevelAndUI(),n}return e(v,[{key:"loadLevelAndUI",value:function(){var e=this;this.setAdVisibility(),this.loadLevel().then((function(){e.updateUI()}))}},{key:"clearBoard",value:function(){this.game&&(this.game.rescueTiles=[],this.game.board.destroyTiles(),this.game.board.clearAnimationQueue(),this.game.pathDraw.clearMatchPath())}},{key:"setAdVisibility",value:function(){if(HD){var e=this.data.level;if(e){var t=e>H.NUM_LEVEL_WITHOUT_BANNER_ADS;C.setAdEnable(HD.BANNER,t)}C.updateBannerAdsByLayout(P.getCurrentLayout()),C.refreshBannerAdVisibility()}}},{key:"loadLevel",value:(h=o((function*(){if(this.game){var e=Iv.getMatchMode();try{if(e===UD.CHALLENGE_FRIEND){var t=yield this.loadChallengeFriendMode();return w.playSound(Qi.LEVEL_START),void this.handleChallengeFriendModeStart(t)}if(e===UD.TOURNAMENT)return yield this.loadSingleMode(),w.playSound(Qi.LEVEL_START),void this.handleTournamentModeStart()}catch(e){console.error("Error loading level:",e)}yield this.loadSingleMode(),w.playSound(Qi.LEVEL_START),this.handleSingleModeStart()}})),function(){return h.apply(this,arguments)})},{key:"loadChallengeFriendMode",value:(d=o((function*(){if(!this.game)throw new Error("Game is not initialized");yield Iv.getMatchCustomDataAsync();var e=xD.getMatchState().customData.challengeData;if(null==e)throw new Error("Challenge friend mode need to have data.");var t=this.game.levelManager;return yield t.loadLevel(e.level),this.updateGameData({level:e.level,levelData:t.getLevelData()}),e})),function(){return d.apply(this,arguments)})},{key:"loadSingleMode",value:(c=o((function*(){if(null===this.game)throw new Error("Game is not initialized");var e=this.game.levelManager;yield e.loadLevel(this.data.level),this.updateGameData({levelData:e.getLevelData()})})),function(){return c.apply(this,arguments)})},{key:"handleChallengeFriendModeStart",value:(s=o((function*(e){if(this.game){var t=this.game.levelManager.getLevelData(),n=e.level,i=e.fen,a=e.gravity,o=e.rules,r=e.time,l=BD.getPlayerId();yield Promise.all([Iv.setMatchCustomDataAsync({level:n,score:0}),Iv.setProfileMatchDataAsync({id:l,score:0})]);var s=gv.loadLevelSpriteFrames(e.level);yield this.game.board.create(s,u(u({},t),{},{level:n,customFen:i,mode:a,rules:o,time:r})),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),this.game.board.setIgnoreInput(!1),yield s,this.ready()}})),function(e){return s.apply(this,arguments)})},{key:"handleSingleModeStart",value:(l=o((function*(){var e,t;if(this.game){var n=this.game.levelManager.getLevelData(),i=null!==(e=this.data.level)&&void 0!==e?e:1,a=BD.getPlayerId();yield Promise.all([Iv.setMatchCustomDataAsync({level:i,score:0}),Iv.setProfileMatchDataAsync({id:a,score:0})]);var o=gv.loadLevelSpriteFrames(i);yield this.game.board.create(o,n),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),null!==(t=this.game.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),i&&i>0&&i%5==0&&(P.isLandscape()&&this.game.handleShowUI(),yield x.openScreen(z.HARD_LEVEL_SCREEN),yield p.waitTweenAsync(1.3),x.closeScreen(z.HARD_LEVEL_SCREEN),F.setBlockInput(!0),yield this.game.board.animateTilesWave(),F.setBlockInput(!1)),this.ready()}})),function(){return l.apply(this,arguments)})},{key:"handleTournamentModeStart",value:(r=o((function*(){var e,t;if(this.game){var n=this.game.levelManager.getLevelData(),i=null!==(e=this.data.level)&&void 0!==e?e:1,a=BD.getPlayerId();yield Promise.all([Iv.setMatchCustomDataAsync({level:i}),Iv.setProfileMatchDataAsync({id:a})]);var o=gv.loadLevelSpriteFrames(i,this.data.themeId);yield this.game.board.create(o,n),this.game.board.setIgnoreInput(!0),yield this.game.board.animateTilesAppear(),null!==(t=this.game.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),yield o,this.ready()}})),function(){return r.apply(this,arguments)})},{key:"initAdPreload",value:function(){this.game&&(this.game.isAdPreloadedForCurrentLevel=!1)}},{key:"initScore",value:function(){this.game&&this.game.scoreManager.init()}},{key:"initCountdown",value:function(){this.game&&this.game.clockManager.init()}},{key:"updateUI",value:function(){if(this.game){var e=this.game.getGameData();if(e){var t=e.level,n=void 0===t?0:t,i=e.levelData;this.game.uiManager.setLevelText(n),i&&this.game.clockManager.setTime(i.time)}}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),v}(bD);X._RF.pop(),X._RF.push({},"e3b372NaI5HvY5HnTleBQKd","PlayingState",void 0);var VD=Ludex.Plugins.Ads,$D=(void 0===VD?{}:VD).Types,WD=function(a){n(r,a);var o=i(r);function r(e){var n;return t(this,r),(n=o.call(this,e)).startCountdown(),n.preloadNextLevelSkins(),$D&&C.preloadAdsByType($D.INTERSTITIAL),n}return e(r,[{key:"preloadNextLevelSkins",value:function(){var e,t=null!==(e=this.data.level)&&void 0!==e?e:1;gv.preloadLevelSpriteFrames(t+1)}},{key:"startCountdown",value:function(){var e;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||(this.game.clockManager.startCountdown(),this.game.uiManager.startCountdown()))}},{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState(this.manager);this.manager.change(e)}},{key:"playing",value:function(){}},{key:"fail",value:function(e){var t=this.manager.createFailState(this.manager,e);this.manager.change(t)}},{key:"finish",value:function(){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}},{key:"update",value:function(){this.updateStateData()}}]),r}(bD);X._RF.pop(),X._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var KD,jD=codex.analytics,YD=Ludex.Utils.Valid,XD=[Qi.COMBO_1,Qi.COMBO_2,Qi.COMBO_3,Qi.COMBO_4,Qi.COMBO_5,Qi.COMBO_6,Qi.COMBO_7,Qi.COMBO_8,Qi.COMBO_9,Qi.COMBO_10,Qi.COMBO_11,Qi.COMBO_12,Qi.COMBO_13,Qi.TILE_MATCH,Qi.BOMB_DEFUSE,Qi.BOMB_EXPLODE_1,Qi.BOMB_EXPLODE_2,Qi.TILE_SELECT,Qi.THUNDERBOLT,Qi.SHUFFLE_ITEM,Qi.LEVEL_START,Qi.LEVEL_COMPLETE,Qi.LEVEL_FAIL],JD=function(a){n(u,a);var l,s=i(u);function u(e){var n;return t(this,u),n=s.call(this,e),w.stopAllSounds(),w.turnDownMusic(),n.preloadAssets(),n.handleGuideFlow(),n.setGridPlayable(),n.logLevelStartAnalytics(),n}return e(u,[{key:"initialize",value:function(){var e=this.manager.createInitializeState(this.manager);this.manager.change(e)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var e=this.manager.createPlayingState(this.manager);this.manager.change(e)}},{key:"fail",value:function(e){if(YD.isDebugger()){var t=this.manager.createFailState(this.manager);this.manager.change(t)}}},{key:"finish",value:function(){if(YD.isDebugger()){var e=this.manager.createFinishState(this.manager);this.manager.change(e)}}},{key:"update",value:function(){}},{key:"preloadAssets",value:function(){var e;this.preloadSounds(),null===(e=this.game)||void 0===e||e.effectManager.preloadEffects()}},{key:"preloadSounds",value:function(){for(var e=0,t=XD;e<t.length;e++){var n=t[e];r.loadAudioAsync(n)}}},{key:"setGridPlayable",value:function(){var e;null!==(e=this.manager.getGameplay().guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||this.manager.getGameplay().board.setIgnoreInput(!1)}},{key:"handleGuideFlow",value:(l=o((function*(){var e,t;this.game&&(null!==(e=this.game.guidelinesManager)&&void 0!==e&&e.isNewbieGuideLevel()||(yield this.game.handleShowUI()),null===(t=this.game.guidelinesManager)||void 0===t||t.show())})),function(){return l.apply(this,arguments)})},{key:"logLevelStartAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=(Iv.getMatchCustomData()||{}).score,i=void 0===n?0:n,a=Iv.getMatchMode()||void 0;null==jD||jD.levelStart(t,i,a)}}}]),u}(bD);X._RF.pop(),X._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var ZD=(0,Z.ccclass)("StateManager")(KD=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"getGameplay",value:function(){return this.gameplay}},{key:"init",value:function(e){this.gameplay=e,this.state=new qD(this)}},{key:"change",value:function(e){this.state=e}},{key:"initialize",value:function(){this.state.initialize()}},{key:"isInitialize",value:function(){return this.state instanceof qD}},{key:"ready",value:function(){this.state.ready()}},{key:"isReady",value:function(){return this.state instanceof JD}},{key:"playing",value:function(){this.state.playing()}},{key:"isPlaying",value:function(){return this.state instanceof WD}},{key:"fail",value:function(e){this.state.fail(e)}},{key:"isFail",value:function(){return this.state instanceof ED}},{key:"finish",value:function(){this.state.finish()}},{key:"isFinished",value:function(){return this.state instanceof MD}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return q(qD,t)}},{key:"createReadyState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return q(JD,t)}},{key:"createPlayingState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return q(WD,t)}},{key:"createFailState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return q(ED,t)}},{key:"createFinishState",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return q(MD,t)}}]),r}(te))||KD;X._RF.pop(),X._RF.push({},"e80e4nIcfdLN56j5b9SMhvH","LeaderboardUtils",void 0);var QD,eN=codex.leaderboard,tN=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getAllLeaderboardAsync",value:(r=o((function*(e){if(!eN)return null;var t=eN.getLeaderboardName(e);if(!t)return null;var n=yield eN.getLeaderboardResponseAsync(e);return n?(yield this.requestLeaderboardAsync(t,n.amountPlayer),eN.getLeaderboard(t)):null})),function(e){return r.apply(this,arguments)})},{key:"requestLeaderboardAsync",value:(a=o((function*(e,t){this.isLeaderboardRequesting(e)?yield this.waitForLeaderboardFinishAsync(e):yield eN.requestLeaderboardAsync(e,t)})),function(e,t){return a.apply(this,arguments)})},{key:"waitForLeaderboardFinishAsync",value:(i=o((function*(e){var t=this;if(this.isLeaderboardRequesting(e))return new Promise((function(n){var i=setInterval((function(){t.isLeaderboardRequesting(e)||(clearInterval(i),n())}),100)}))})),function(e){return i.apply(this,arguments)})},{key:"isLeaderboardRequesting",value:function(e){var t;return(null===(t=eN.getLeaderboard(e))||void 0===t?void 0:t.isRequesting)||!1}}]),n}());X._RF.pop(),X._RF.push({},"a95ba1U+uJB66zZU7UYL4e5","TournamentManager",void 0);var nN,iN,aN,oN,rN,lN,sN,uN,cN,dN=Z.ccclass,hN=Ludex.Utils.Object,pN=codex,yN=pN.player,vN=pN.leaderboard,fN=dN("TournamentManager")(QD=function(a){n(d,a);var r,l,s,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=c.call.apply(c,[this].concat(i))).leaderData=[],e.tournamentData=null,e.leaderboardData=null,e.leaderboardName=null,e}return e(d,[{key:"init",value:(u=o((function*(){yield this.requestTournamentData(),yield this.requestLeaderData()})),function(){return u.apply(this,arguments)})},{key:"requestTournamentData",value:(s=o((function*(){var e,t,n=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;n&&(yield U.requestTournamentDataAsync(),this.tournamentData=null!==(t=U.getTournamentDataById(n))&&void 0!==t?t:null)})),function(){return s.apply(this,arguments)})},{key:"requestLeaderData",value:(l=o((function*(){var e,t=this,n=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).leaderboardId;if(n&&(yield this.requestLeaderboardData(n),this.leaderboardData)){var i=yN.getPlayerId();this.leaderData=hN.vals(this.leaderboardData.leaders).reduce((function(e,t){if(t.playerId!==i&&t.score>0){var n={score:t.score,rank:t.rank};e.push(n)}return e}),[]).sort((function(e,t){return e.score-t.score})),this.leaderData.forEach((function(e,n){e.rank=t.leaderData.length-n}))}})),function(){return l.apply(this,arguments)})},{key:"requestLeaderboardData",value:(r=o((function*(e){this.leaderboardName=vN.getLeaderboardName(e),this.leaderboardData=yield tN.getAllLeaderboardAsync(e)})),function(e){return r.apply(this,arguments)})}]),d}(te))||QD;X._RF.pop(),X._RF.push({},"2b89dXjcudIaZRJFuh5TAAI","InterstitialAdIndicator",void 0);var gN=Z.ccclass,mN=Z.property,bN=["ads.interNotice.backInSec","ads.interNotice.hangTight","ads.interNotice.quickAd"];var wN,SN=Ludex.Configs.Ads.NotifyPlayerBeforeShow,kN=(nN=gN("InterstitialAdIndicator"),iN=Yn.required(),aN=mN(de),oN=Yn.required(),rN=mN(Lh),nN((uN=a((sN=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"uiOpacity",uN,s(e)),l(e,"labelLocalizer",cN,s(e)),e}return e(c,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}},{key:"flash",value:(r=o((function*(){var e,t,n=(t=Math.floor(Math.random()*bN.length),bN[t]);if(!1!==SN&&n){null===(e=this.signal)||void 0===e||e.abort();var i=new Mi;this.signal=i,this.labelLocalizer.key=n;var a=re(this.uiOpacity).to(.25,{opacity:255},{easing:"linear"}).delay(.25).to(.25,{opacity:100},{easing:"linear"}).delay(.125);yield p.runTweenAsync(re(this.uiOpacity).repeat(2,a).to(.25,{opacity:0},{easing:"linear"}),i),this.uiOpacity.opacity=0}})),function(){return r.apply(this,arguments)})}]),c}(te)).prototype,"uiOpacity",[iN,aN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cN=a(sN.prototype,"labelLocalizer",[oN,rN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lN=sN))||lN);X._RF.pop(),X._RF.push({},"dfab8xSeglD/abIKphEhi4g","ComboContainer",void 0);var CN,EN=Z.ccclass,AN=Ludex.Match.Modes,TN=EN("ComboContainer")(wN=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.widget=this.node.getComponent(oe),this.node.scene.on(Js.GRID_RESIZE,this.handleViewResized,this)}},{key:"init",value:function(e){this.board=e}},{key:"updateWidget",value:function(){if(P.isPortrait())return this.node.scale=new be(1,1,1),this.widget.right=22.5,void(this.widget.top=Iv.getMatchMode()===AN.TOURNAMENT?180:160);if(this.board){this.node.scale=new be(1.5,1.5,1.5);var e=this.board.getBoundingBoxWorld().yMax,t=v.cssSizeToWorldSize(v.getScreenHeightCss());this.widget.right=142.5,this.widget.top=(t-e)/2}}},{key:"updateStatus",value:function(){this.updateWidget()}},{key:"handleViewResized",value:function(){this.updateWidget()}}]),r}(te))||wN;X._RF.pop(),X._RF.push({},"ed00dMDxYRJP4fZMawN9JnW","ComboProgressBar",void 0);var PN,LN,ON,IN,RN,_N,DN,NN,MN,FN,BN,xN,zN,UN,GN,HN,qN,VN,$N,WN,KN,jN,YN,XN,JN,ZN,QN=Z.ccclass,eM=QN("ComboProgressBar")(CN=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"start",value:function(){this.progressBar=this.getComponent(id),this.opacity=this.getComponent(de),this.comboTimer=0,this.isActive=!1,this.node.scene.on(Js.COMBO_UPDATED,this.handleComboUpdated,this)}},{key:"update",value:function(e){this.isActive&&(this.comboTimer>0?(this.comboTimer-=e,this.progressBar.progress=this.comboTimer/2):(this.isActive=!1,this.opacity.opacity=0,this.node.scene.emit(Js.COMBO_ENDED)))}},{key:"handleComboUpdated",value:function(e){0===e?this.opacity.opacity=0:e>0&&(this.isActive=!0,this.comboTimer=2),e>1&&(this.opacity.opacity=255)}},{key:"pause",value:function(){this.isActive=!1}},{key:"resume",value:function(){this.isActive=!0}}]),r}(te))||CN;X._RF.pop(),X._RF.push({},"c3d9fl9+INO3ac7Q2zvmRKy","SpecialItem",void 0);var tM,nM,iM,aM,oM,rM,lM,sM=Z.ccclass,uM=Z.property,cM=(E(PN={},_.HINT,"item.hintDesc"),E(PN,_.PLIERS,"item.pliersDesc"),E(PN,_.STORM,"item.stormDesc"),E(PN,_.THUNDER,"item.thunderDesc"),PN),dM=(LN=sM("SpecialItem"),ON=uM({editorOnly:!0,tooltip:"A debug button has infinite quantity"}),IN=Yn.required(),RN=uM({type:fe,tooltip:"The button that activates the item"}),_N=uM({type:ie,group:"Quantity",tooltip:"The starting quantity of the item",displayName:"Quantity"}),DN=Yn.required(),NN=uM({type:ke,group:"Quantity",tooltip:"The label that shows the quantity",displayName:"Label"}),MN=Yn.required(),FN=uM({type:me,group:"Quantity",tooltip:"The node that shows the quantity of the item",displayName:"Quantity node"}),BN=Yn.required(),xN=uM({type:me,group:"Quantity",tooltip:"The node that shows the plus icon when there is no item",displayName:"Plus node"}),zN=Yn.required(),UN=uM({type:de,group:"Animation"}),GN=Yn.required(),HN=uM({type:de,tooltip:"The opacity component of the button",displayName:"Button UI Opacity"}),LN(($N=a((VN=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"isDevButton",$N,s(e)),l(e,"button",WN,s(e)),l(e,"quantity",KN,s(e)),l(e,"quantityLabel",jN,s(e)),l(e,"quantityNode",YN,s(e)),l(e,"plusNode",XN,s(e)),l(e,"glowUIOpacity",JN,s(e)),l(e,"uiOpacity",ZN,s(e)),e.vibrateComp=null,e}return e(d,[{key:"itemType",get:function(){}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,d)}},{key:"updateStatus",value:function(e){var t;if(void 0!==this.itemType){var n=null===(t=e.items)||void 0===t?void 0:t[this.itemType];n&&(this.setActiveStatus(n.canActivate),this.setQuantity(n.quantity,n.animate))}}},{key:"setActiveStatus",value:function(e){var t;null===(t=this.signal)||void 0===t||t.abort();var n=new Mi;this.signal=n,this.button.interactable=e,p.runTweenAsync(re(this.uiOpacity).to(.2,{opacity:e?255:128}),n)}},{key:"activate",value:(u=o((function*(){this.quantity<=0?this.requestItem():(this.vibrate(),this.node.scene.emit(Js.USE_ITEM,this.itemType))})),function(){return u.apply(this,arguments)})},{key:"setQuantity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;if(this.isDevButton)return this.quantityLabel.string="i",this.quantityNode.active=!0,void(this.plusNode.active=!1);n=Math.max(0,n),this.quantity=n,this.quantityLabel.string="".concat(this.quantity),n<=0?(this.quantityNode.active=!1,this.plusNode.active=!0):(this.quantityNode.active=!0,this.plusNode.active=!1),t&&this.animateAddItem()}},{key:"requestItem",value:function(){void 0!==this.itemType?x.openScreen(z.GET_ITEM_SCREEN,{item:this.itemType,localizedMessageKey:cM[this.itemType],quantity:1}):console.warn("Item type is not defined")}},{key:"vibrate",value:function(){var e,t;this.vibrateComp=null!==(e=this.vibrateComp)&&void 0!==e?e:this.node.getComponent(qy),null===(t=this.vibrateComp)||void 0===t||t.vibrate(50)}},{key:"animateAddItem",value:(r=o((function*(){return this.glowUIOpacity.opacity=0,Promise.all([p.runTweenAsync(re(this.node).to(.1,{scale:new be(1.15,1.15,1.15)},{easing:"cubicOut"}).delay(.2).to(.7,{scale:be.ONE},{easing:"elasticOut"})),p.runTweenAsync(re(this.glowUIOpacity).to(.1,{opacity:100}).delay(.2).to(.6,{opacity:0}))])})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"isDevButton",[ON],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),WN=a(VN.prototype,"button",[IN,RN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KN=a(VN.prototype,"quantity",[_N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),jN=a(VN.prototype,"quantityLabel",[DN,NN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YN=a(VN.prototype,"quantityNode",[MN,FN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XN=a(VN.prototype,"plusNode",[BN,xN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JN=a(VN.prototype,"glowUIOpacity",[zN,UN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZN=a(VN.prototype,"uiOpacity",[GN,HN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qN=VN))||qN);X._RF.pop(),X._RF.push({},"9e40aEq56tMKLFoeACyl+eH","Clock",void 0);var hM=Z.ccclass,pM=Z.disallowMultiple,yM=Z.property,vM=(tM=hM("Clock"),nM=yM(me),iM=yM(ke),tM(aM=pM((rM=a((oM=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"clockIcon",rM,s(e)),l(e,"timeLabel",lM,s(e)),e}return e(d,[{key:"__preload",value:function(){this.node.scene.on(Js.TIME_UPDATED,this.updateTimeLabel,this),this.node.scene.on(Js.RESCUE_START,this.handleRescueStart,this),this.node.scene.on(Js.RESCUE_FINISHED,this.handleRescueFinished,this)}},{key:"updateStatus",value:function(e){void 0!==e.time&&this.updateTimeLabel(e.time)}},{key:"updateTimeLabel",value:function(e){var t=this.convertSecondsToMmSs(e);this.timeLabel.string=t}},{key:"convertSecondsToMmSs",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60),i=this.padZero(t),a=this.padZero(n);return"".concat(i,":").concat(a)}},{key:"padZero",value:function(e){return e<10?"0".concat(e):"".concat(e)}},{key:"handleRescueStart",value:(u=o((function*(){var e=re(this.node).to(.5,{scale:new be(1.1,1.1,1)}),t=re(this.clockIcon).to(.15,{angle:-15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}).to(.15,{angle:15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}),n=re(this.clockIcon).repeat(5,t);p.runTweenAsync(n),p.runTweenAsync(e)})),function(){return u.apply(this,arguments)})},{key:"handleRescueFinished",value:(r=o((function*(){var e=re(this.node).to(.5,{scale:new be(1,1,1)});p.runTweenAsync(e)})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"clockIcon",[nM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lM=a(oM.prototype,"timeLabel",[iM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aM=oM))||aM)||aM);X._RF.pop(),X._RF.push({},"9ecd9Kte0VJN4rRVFlb6CzI","OverlayUtils",void 0);var fM=codex,gM=fM.player,mM=fM.analytics,bM=Ludex.Plugins.Analytics,wM=(void 0===bM?{}:bM).Events,SM=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"shareBestScoreWithOverlay",value:(r=o((function*(){try{var e=(gM.getPlayer().data||{}).score;this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.extra.shareAsync({text:"Great! I have a best score!",intent:"SHARE",imageOverlayPath:"wideframes/share-async.xml",pathToCSS:"wideframes/share-async-styles.css",initialData:{score:null!=e?e:0},shareDestination:["NEWSFEED","GROUP","COPY_LINK","MESSENGER"],switchContext:!1}),wM&&mM.event(wM.SHARE,{share_content_type:"BestScore",success:!0})}catch(e){wM&&mM.event(wM.SHARE,{share_content_type:"BestScore",success:!1}),console.error("Overlay sharing failed:",e)}})),function(){return r.apply(this,arguments)})},{key:"inviteFriendsWithOverlay",value:(a=o((function*(){try{var e=(gM.getPlayer().data||{}).score;this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.extra.inviteAsync({initialData:{score:null!=e?e:0},text:{default:"Great! I have a best score!",localizations:{vi_VN:"Tht tuyt! Mnh va ph k lc ny!"}},imageOverlayPath:"wideframes/invite-async.xml",pathToCSS:"wideframes/invite-async-styles.css"}),wM&&mM.event(wM.INVITE,{invite_content_type:"BestScore",success:!0})}catch(e){wM&&mM.event(wM.INVITE,{invite_content_type:"BestScore",success:!1}),console.error("Overlay inviting failed:",e)}})),function(){return a.apply(this,arguments)})},{key:"isOverlayViewAPIAvailable",value:function(e){if(!e.isGameSDK("FacebookInstant"))throw new Error("GameSDK is not FacebookInstant");if(!e.extra.isNEZP()||e.extra.isRestricted())throw new Error("GameSDK is not NEZP or Restricted");if(!("overlayViews"in e))throw new Error("GameSDK does not have overlayViews")}},{key:"createOverlayViewAsync",value:(i=o((function*(e,t,n,i,a){return this.isOverlayViewAPIAvailable(GameSDK),yield GameSDK.overlayViews.createOverlayViewAsync(e,t,n,i,a)})),function(e,t,n,a,o){return i.apply(this,arguments)})},{key:"getGameScaleFactor",value:function(){var e=m.DesignSize,t=e.Portrait,n=e.Landscape,i=v.getScreenWidthCss(),a=v.getScreenHeightCss(),o=P.isLandscape(),r=i/(o?n.WIDTH:t.WIDTH),l=a/(o?n.HEIGHT:t.HEIGHT);switch(this.getViewResolutionPolicy().getContentStrategy()){case dt.ContentStrategy.FIXED_WIDTH:return r;case dt.ContentStrategy.FIXED_HEIGHT:return l;default:return Math.max(r,l)}}},{key:"getViewResolutionPolicy",value:function(){return ht.getResolutionPolicy()}}]),n}());X._RF.pop(),X._RF.push({},"782f7aiDpVF869fWzGqeFHO","PlayerAvatarOverlay",void 0);var kM=Ludex.Utils,CM=kM.Time,EM=kM.Object,AM=function(){function n(e){var i=this;t(this,n),this.createMainDiv$=function(){i.mainDiv$=document.createElement("div"),EM.assign(i.mainDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",scrollbarWidth:"none",alignItems:"center",overflow:"hidden",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none"}),i.updateContainerWidth$(55),document.body.appendChild(i.mainDiv$)},this.isPlayerIdValid$=function(e){return/^\d+$/.test(e)},this.showOverlay$=o((function*(){i.overlayView&&(EM.assign(i.mainDiv$.style,{opacity:"0",display:"none",pointerEvents:"none"}),yield i.overlayView.showAsync(),yield i.fadeIn())})),this.updateContainerWidth$=function(e){var t=P.isLandscape()?2.4:1.2,n="".concat(e*t*SM.getGameScaleFactor(),"px");EM.assign(i.mainDiv$.style,{width:n,height:n})},this.getIframeCss$=function(){return"".concat("width: 100%;"," ").concat("height: 100%;"," ").concat("overflow: hidden;"," ").concat("background-color: transparent;"," ").concat("border-width: 0px;"," ").concat("align-items: center;")},this.scene=e,this.createMainDiv$()}var i,a,r,l;return e(n,[{key:"moveOverlayTo",value:function(e,t){var n=SM.getGameScaleFactor();Object.assign(this.mainDiv$.style,{top:"calc(100vh - ".concat(t*n,"px)"),left:"calc(".concat(e*n,"px)")})}},{key:"updateOverlay",value:(l=o((function*(e){try{var t=e.playerId,n=e.worldX,i=e.worldY,a=e.avatarWidth,o=void 0===a?55:a,r=e.customCss,l=void 0===r?"overlays/avatar/avatar-overlay-styles.css":r;if(!this.isPlayerIdValid$(t))return!1;if(this.updateContainerWidth$(o),this.moveOverlayTo(n,i),this.currentPlayerId===t)return yield this.showOverlay$(),!0;this.overlayView=yield SM.createOverlayViewAsync("overlays/avatar/avatar-overlay.xml",this.mainDiv$,this.getIframeCss$(),l,{playerId:t}),this.currentPlayerId=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return l.apply(this,arguments)})},{key:"hideOverlay",value:(r=o((function*(){if(this.overlayView){EM.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none"});try{yield CM.sleepAsync(300),this.mainDiv$.style.display="none",yield this.overlayView.dismissAsync()}catch(e){console.error("Hide overlay failed:",e)}}})),function(){return r.apply(this,arguments)})},{key:"fadeIn",value:(a=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";EM.assign(this.mainDiv$.style,{transition:"opacity ".concat(t,"ms ").concat(n),display:"block"}),requestAnimationFrame((function(){EM.assign(e.mainDiv$.style,{opacity:"1",pointerEvents:"auto"})})),yield CM.sleepAsync(t)})),function(){return a.apply(this,arguments)})},{key:"fadeOut",value:(i=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";EM.assign(this.mainDiv$.style,{transition:"opacity ".concat(e,"ms ").concat(t),opacity:"0",pointerEvents:"none"}),yield CM.sleepAsync(e),this.mainDiv$.style.display="none"})),function(){return i.apply(this,arguments)})}]),n}();X._RF.pop(),X._RF.push({},"af947t5g91EkZVWXv5upZaV","CacheUtils",void 0);var TM=Ludex.Utils.Image,PM=codex.frameCapture,LM=function(){function n(){t(this,n)}var i,a,r;return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getPlayerAvatar",value:(r=o((function*(e,t,n,i){var a=this.playerAvatarCache$.get("".concat(t,":").concat(n));return a||(a=yield this.loadPlayerAvatar(e,t,n,i)),a})),function(e,t,n,i){return r.apply(this,arguments)})},{key:"loadPlayerAvatar",value:(a=o((function*(e,t,n,i){var a=yield this.loadImage(e,n,n,"".concat(t,":").concat(n));if((null==i||!i.aborted)&&a){var o=xe.createWithImage(a);return this.playerAvatarCache$.set("".concat(t,":").concat(n),o),o}})),function(e,t,n,i){return a.apply(this,arguments)})},{key:"isAvatarCached",value:function(e,t){return this.playerAvatarCache$.has("".concat(e,":").concat(t))}},{key:"loadImage",value:(i=o((function*(e,t,n,i){try{var a=yield PM.captureAsync({width:t,height:n,name:"LeaderAvatar",renderOptions:E({},i,{name:i,type:"image",depth:0,position:[0,0],size:[t,n],image:e})});return a?yield TM.loadImage(a):null}catch(e){return null}})),function(e,t,n,a){return i.apply(this,arguments)})}]),n}();LM.playerAvatarCache$=new Map;var OM,IM,RM,_M,DM,NM,MM,FM,BM,xM,zM,UM=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(LM);X._RF.pop(),X._RF.push({},"540108ucKBPYbN9gW5TFh/q","LeaderRail",void 0);var GM,HM,qM,VM,$M,WM=Z.ccclass,KM=Z.property,jM="overlays/avatar/tournament-rail-overlay-styles.css",YM=(OM=WM("LeaderRail"),IM=KM(ke),RM=KM(me),_M=KM(he),DM=KM(zT),OM((FM=a((MM=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"scoreLabel",FM,s(e)),l(e,"crown",BM,s(e)),l(e,"avatar",xM,s(e)),l(e,"spark",zM,s(e)),e.score=0,e.isOverlayMode=!1,e.playerAvatarOverlay=null,e.showAvatarOverlay$=function(){var t=o((function*(t){var n,i=e.getAvatarPosition$(),a=i.worldX,o=i.worldY,r=yield null===(n=e.playerAvatarOverlay)||void 0===n?void 0:n.updateOverlay({playerId:t,worldX:a,worldY:o,avatarWidth:e.getAvatarWidth$(),customCss:jM});return null!=r&&r}));return function(e){return t.apply(this,arguments)}}(),e.getAvatarWidth$=function(){var t=e.avatar.node.getComponent(ne);return t?t.width:0},e.getAvatarPosition$=function(){var t=e.avatar.node;return{worldX:t.worldPositionX,worldY:t.worldPositionY}},e.createAvatarOverlay$=function(){try{SM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.playerAvatarOverlay=new AM(e.node.scene)}catch(e){return}},e.handleAvatarPositionChanged$=function(){var t;if(e.isOverlayMode){var n=e.getAvatarPosition$(),i=n.worldX,a=n.worldY;null===(t=e.playerAvatarOverlay)||void 0===t||t.moveOverlayTo(i,a)}},e}return e(d,[{key:"__preload",value:function(){this.defaultAvatar=this.avatar.spriteFrame,this.uiOpacity=this.getComponent(de)}},{key:"onLoad",value:function(){this.createAvatarOverlay$()}},{key:"onDisable",value:function(){this.cleanupOverlay()}},{key:"updateScore",value:(u=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e-this.score,o=i?0:.5,r=re(this.node).to(o,{},{onUpdate:function(e,t){if(t){var i=Math.floor(a*t)+n.score;n.scoreLabel.string=i.toString()}}});yield p.runTweenAsync(r,t),this.score=e,this.scoreLabel.string=e.toString()})),function(e,t){return u.apply(this,arguments)})},{key:"updatePhoto",value:(r=o((function*(){var e=GameSDK.player.getID();if(e){if(this.isOverlayMode){if(yield this.showAvatarOverlay$(e))return;this.isOverlayMode=!1}var t=GameSDK.player.getPhoto();if(t){var n=yield UM.getPlayerAvatar(t,e,50);n?(n.packable=!0,this.avatar.spriteFrame=n):this.avatar.spriteFrame=this.defaultAvatar}}})),function(){return r.apply(this,arguments)})},{key:"setCrown",value:function(e){this.crown.active=e}},{key:"setOpacity",value:function(e){this.uiOpacity.opacity=e}},{key:"playSparkParticle",value:function(){this.spark.play()}},{key:"stopSparkParticle",value:function(){this.spark.stop()}},{key:"cleanupOverlay",value:function(){var e;null===(e=this.playerAvatarOverlay)||void 0===e||e.hideOverlay()}},{key:"update",value:function(e){this.handleAvatarPositionChanged$()}}]),d}(te)).prototype,"scoreLabel",[IM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BM=a(MM.prototype,"crown",[RM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xM=a(MM.prototype,"avatar",[_M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zM=a(MM.prototype,"spark",[DM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NM=MM))||NM);X._RF.pop(),X._RF.push({},"00759vwS/dHS6GvHKvVE5Q1","TournamentProgressBar",void 0);var XM,JM,ZM,QM,eF,tF,nF,iF,aF,oF,rF,lF,sF,uF,cF,dF,hF,pF,yF,vF,fF=Z.ccclass,gF=Z.property,mF=474,bF=(GM=fF("TournamentProgressBar"),HM=gF(YM),GM(($M=a((VM=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"playerLeader",$M,s(e)),e.onUpdate=function(){e.playerLeader&&e.playerLeader.node&&(e.playerLeader.node.position=new be(e.progressBar.progress*mF-237,0,0))},e}return e(c,[{key:"__preload",value:function(){this.progressBar=this.getComponent(_e)}},{key:"updateProgress",value:(r=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cubicOut",a=re(this.progressBar).to(n,{progress:e},{easing:i,onUpdate:this.onUpdate});yield p.runTweenAsync(a,t)})),function(e,t){return r.apply(this,arguments)})},{key:"getProgress",value:function(){return this.progressBar.progress}}]),c}(te)).prototype,"playerLeader",[HM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qM=VM))||qM);X._RF.pop(),X._RF.push({},"16d68fBLT1Ha7lXADThDtfC","TournamentRail",void 0);var wF,SF,kF,CF,EF,AF,TF,PF,LF,OF=Z.ccclass,IF=Z.property,RF=Ludex,_F=RF.Utils,DF=_F.Array,NF=_F.Signal,MF=_F.Valid,FF=RF.Match.Modes,BF=(XM=OF("TournamentRail"),JM=IF(bF),ZM=IF(YM),QM=IF(me),eF=IF(me),tF=IF(Lh),nF=IF(Lh),iF=IF(me),aF=IF(de),oF=Yn.onlyRunInLifeCycleAsync,XM((sF=a((lF=function(a){n(g,a);var r,u,d,h,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"progressBar",sF,s(e)),l(e,"playerLeader",uF,s(e)),l(e,"flag",cF,s(e)),l(e,"sword",dF,s(e)),l(e,"currentRankLocalizer",hF,s(e)),l(e,"nextRankLocalizer",pF,s(e)),l(e,"devTools",yF,s(e)),l(e,"challengerJoinedUiOpacity",vF,s(e)),e.challengerJoinedY=0,e.leaderData=[],e.nextLeaderIndex=0,e.score=0,e.minScore=0,e.maxScore=0,e.signal=new NF.SignalController,e}return e(g,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),this.playerLeader.updatePhoto(),this.devTools.active=MF.isDebugger(),this.challengerJoinedY=this.challengerJoinedUiOpacity.node.position.y}},{key:"updateStatus",value:(v=o((function*(e){if(Iv.getMatchMode()!==FF.TOURNAMENT)return this.uiOpacity.opacity=0,void this.playerLeader.cleanupOverlay();this.uiOpacity.opacity=255,this.playerLeader.updatePhoto();var t=e.leaderData,n=e.score;if(t&&void 0!==n){var i=this.signal.renew();this.score=n,this.nextLeaderIndex=this.getScoreReachedLeaderIndex(this.score,t),this.syncRail(t,i,!0)}})),function(e){return v.apply(this,arguments)})},{key:"syncRail",value:(y=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e[this.nextLeaderIndex-1],a=e[this.nextLeaderIndex],o=i?i.rank:a?a.rank+1:1;this.setRankLabel(o,this.currentRankLocalizer);var r=!a;this.nextRankLocalizer.node.active=!r,this.runActiveAnimation(this.sword,!r,t,n),this.playerLeader.setCrown(r),this.playerLeader.updateScore(this.score,t,n);var l=n?0:void 0;if(r)this.playerLeader.playSparkParticle(),yield this.progressBar.updateProgress(1,t,l);else{this.playerLeader.stopSparkParticle(),this.setRankLabel(a.rank,this.nextRankLocalizer),this.minScore=i?i.score:0,this.maxScore=a.score;var s=(this.score-this.minScore)/(this.maxScore-this.minScore);(s=.8*s+.1)<this.progressBar.getProgress()&&this.showScoreUpdatedNotice(t),yield this.progressBar.updateProgress(s,t,l)}})),function(e,t){return y.apply(this,arguments)})},{key:"handleScoreUpdated",value:(h=o((function*(e){var t=e.score,n=e.leaderData;if(void 0!==t&&n){this.leaderData=n;var i=this.signal.renew();this.score=t;var a=this.getScoreReachedLeaderIndex(t,n);if(a>this.nextLeaderIndex){this.nextLeaderIndex=a;var o=(1-this.progressBar.getProgress())/1.5;o=Math.min(o,.5),yield this.progressBar.updateProgress(1,i,o,"cubicIn"),this.runBubbleAnimation(this.sword,i),yield this.progressBar.updateProgress(0,i,0),this.runBubbleAnimation(this.flag,i)}else if(a<this.nextLeaderIndex){this.nextLeaderIndex=a;var r=this.progressBar.getProgress()/1.5;r=Math.min(r,.5),yield this.progressBar.updateProgress(0,i,r,"cubicIn"),this.runBubbleAnimation(this.flag,i),yield this.progressBar.updateProgress(1,i,0),this.runBubbleAnimation(this.sword,i)}this.syncRail(n,i)}})),function(e){return h.apply(this,arguments)})},{key:"runBubbleAnimation",value:(d=o((function*(e,t){e.scale=be.ONE;var n=re(e).to(.1,{scale:new be(1.2,1.2,1.2)}).to(.2,{scale:be.ONE},{easing:"backOut"});yield p.runTweenAsync(n,t),e.scale=be.ONE})),function(e,t){return d.apply(this,arguments)})},{key:"runActiveAnimation",value:(u=o((function*(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t?be.ZERO:be.ONE,o=t?be.ONE:be.ZERO;if(i)e.scale=o;else if(!e.scale.equals(o)){var r=t?"backOut":"quadOut";e.scale=a;var l=re(e).to(.1,{scale:new be(1.2,1.2,1.2)}).to(.2,{scale:o},{easing:r});yield p.runTweenAsync(l,n),e.scale=o}})),function(e,t,n){return u.apply(this,arguments)})},{key:"getScoreReachedLeaderIndex",value:function(e,t){var n=DF.searchIndex(t,(function(t){return t.score>=e}));return-1===n?t.length:n}},{key:"setRankLabel",value:function(e,t){1!==e?2!==e?3!==e?(t.key="status.nth",t.setParams([e.toString()])):t.key="status.third":t.key="status.second":t.key="status.first"}},{key:"handleDecreaseRank",value:function(){var e,t=c(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score+=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"handleIncreaseRank",value:function(){var e,t=c(this.leaderData);try{for(t.s();!(e=t.n()).done;){e.value.score-=2*this.getMedianScore()}}catch(e){t.e(e)}finally{t.f()}this.handleScoreUpdated({score:this.score,leaderData:this.leaderData})}},{key:"getMedianScore",value:function(){return(this.leaderData[this.leaderData.length-1].score-this.leaderData[0].score)/this.leaderData.length}},{key:"showScoreUpdatedNotice",value:(r=o((function*(e){var t=this;this.challengerJoinedUiOpacity.node.active=!0,this.challengerJoinedUiOpacity.opacity=0;var n=function(){t.challengerJoinedUiOpacity.node.active=!1,t.challengerJoinedUiOpacity.opacity=0};e.once(n);var i=new be(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY-10,this.challengerJoinedUiOpacity.node.position.z),a=new be(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY,this.challengerJoinedUiOpacity.node.position.z),o=new be(this.challengerJoinedUiOpacity.node.position.x,this.challengerJoinedY+10,this.challengerJoinedUiOpacity.node.position.z);this.challengerJoinedUiOpacity.node.setPosition(i);var r=p.runTweenAsync(re(this.challengerJoinedUiOpacity).to(.5,{opacity:255}),e),l=p.runTweenAsync(re(this.challengerJoinedUiOpacity.node).to(.5,{position:a},{easing:"cubicOut"}),e),s=p.waitTweenAsync(1,e);yield Promise.all([r,l,s]);var u=p.runTweenAsync(re(this.challengerJoinedUiOpacity.node).to(.5,{position:o},{easing:"cubicIn"}),e),c=p.runTweenAsync(re(this.challengerJoinedUiOpacity).to(.5,{opacity:0}),e);yield Promise.all([u,c]),e.off(n)})),function(e){return r.apply(this,arguments)})}]),g}(te)).prototype,"progressBar",[JM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uF=a(lF.prototype,"playerLeader",[ZM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cF=a(lF.prototype,"flag",[QM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dF=a(lF.prototype,"sword",[eF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hF=a(lF.prototype,"currentRankLocalizer",[tF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pF=a(lF.prototype,"nextRankLocalizer",[nF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yF=a(lF.prototype,"devTools",[iF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vF=a(lF.prototype,"challengerJoinedUiOpacity",[aF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(lF.prototype,"updateStatus",[oF],Object.getOwnPropertyDescriptor(lF.prototype,"updateStatus"),lF.prototype),rF=lF))||rF);X._RF.pop(),X._RF.push({},"ac5371+oVZBLoBKwAM7rH3r","GameSceneLayout",void 0);var xF=Z.ccclass,zF=Z.property,UF=(wF=xF("GameSceneLayout"),SF=zF(BF),kF=zF(vM),CF=zF(dM),wF((TF=a((AF=function(a){n(p,a);var r,u,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),l(e,"tournamentRail",TF,s(e)),l(e,"clock",PF,s(e)),l(e,"items",LF,s(e)),e.isInited=!1,e.entranceSignal=new Mi,e.exitSignal=new Mi,e}return e(p,[{key:"waitForInitAsync",value:(d=o((function*(){var e=this;if(!this.isInited)return new Promise((function(t){var n=setInterval((function(){e.isInited&&(clearInterval(n),t())}),100)}))})),function(){return d.apply(this,arguments)})},{key:"setLevelText",value:function(e){}},{key:"disableLayout",value:function(){}},{key:"enableLayout",value:function(){}},{key:"updateStatus",value:function(e){this.clock.updateStatus(e),this.tournamentRail.updateStatus(e);var t,n=c(this.items);try{for(n.s();!(t=n.n()).done;){t.value.updateStatus(e)}}catch(e){n.e(e)}finally{n.f()}}},{key:"playExitAnimUI",value:(u=o((function*(){})),function(){return u.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(r=o((function*(){})),function(){return r.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){}},{key:"unHighlightCoinContainer",value:function(){}},{key:"handleScoreUpdated",value:function(e){}}]),p}(te)).prototype,"tournamentRail",[SF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PF=a(AF.prototype,"clock",[kF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LF=a(AF.prototype,"items",[CF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),EF=AF))||EF);X._RF.pop(),X._RF.push({},"36e26OmHk5GXL6+/b4UibIf","SortNodeUtils",void 0);var GF,HF,qF,VF,$F,WF,KF,jF,YF,XF,JF=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(function(){function n(){var e=this;t(this,n),this.layerNodes=new Map,this.nodeMetadata=new Map,this.movedNodes=new Set,this.listenEvents$=function(){ee.on(Pe.EVENT_AFTER_UPDATE,e.onAfterUpdate$),ee.on(Pe.EVENT_AFTER_RENDER,e.onAfterRender$)},this.onAfterUpdate$=function(){e.sortNodes$()},this.onAfterRender$=function(){e.restoreNodes$()},this.sortNodes$=function(){0!==e.layerNodes.size&&0!==e.nodeMetadata.size&&e.nodeMetadata.forEach((function(t,n){var i=t.node,a=t.layer,o=t.needsPositionUpdate;if(null!=i&&i.isValid&&i.activeInHierarchy){var r=e.layerNodes.get(a);if(null!=r&&r.isValid)return o?(e.revertNodeTransform$(t),t.needsPositionUpdate=!1,void e.movedNodes.add(n)):void(i.parent!==r&&(i.setParent(r,!0),e.movedNodes.add(n)))}}))},this.revertNodeTransform$=function(e){var t=e.node,n=e.originalParent,i=e.originalLocalTransform,a=i.position,o=i.rotation,r=i.scale;t.setParent(n,!0),t.setPosition(a),t.setRotation(o),t.setScale(r)},this.restoreNodes$=function(){0!==e.movedNodes.size&&(e.movedNodes.forEach((function(t){var n=e.nodeMetadata.get(t);n&&n.node.parent!==n.originalParent&&e.restoreNode$(n)})),e.movedNodes.clear())},this.restoreNode$=function(e){var t=e.node,n=e.originalParent;e.keepInLayer||t.parent!==n&&t.setParent(n,!0)},this.revertNodeSiblingIndex$=function(e){var t=e.node,n=e.originalSiblingIndex;if(null!=t&&t.isValid&&t.activeInHierarchy){var i=t.parent;if(null!=i&&i.isValid){var a=t.getSiblingIndex(),o=i.children.length;a!==n&&(n>=o||t.setSiblingIndex(n))}}},this.listenEvents$()}return e(n,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"setLayerPrefab",value:function(e){this.inst.layerPrefab$=e}},{key:"createLayer",value:function(e,t,n){var i=this.inst;if(null!=e&&e.isValid)if(i.layerNodes.has(t))console.warn('[SortNode] createLayer: Layer "'.concat(t,'" already exists'));else{var a;if(i.layerPrefab$){(a=qe(i.layerPrefab$)).name="Layer:".concat(t);var o=a.getComponentInChildren(ke);o&&(o.string=t)}else a=new me("Layer:".concat(t));e.insertChild(a,n),i.layerNodes.set(t,a),console.debug('[SortNode] createLayer: "'.concat(t,'" in ').concat(e.name," at depth ").concat(n))}else console.warn('[SortNode] createLayer: Invalid container for layer "'.concat(t,'"'))}},{key:"setNodeToLayer",value:function(e,t){var n=this,i=this.inst;if(null!=e&&e.isValid)if(i.layerNodes.get(t)){if(!i.nodeMetadata.has(e.uuid)){var a=e.parent;if(a){var o=function(){n.removeNodeFromLayer(e)};e.once(pt.NODE_DESTROYED,o);var r=function(){var t=i.nodeMetadata.get(e.uuid);t&&(t.needsPositionUpdate=!0)};a.on(pt.TRANSFORM_CHANGED,r),i.nodeMetadata.set(e.uuid,{node:e,layer:t,originalParent:a,originalSiblingIndex:e.getSiblingIndex(),originalLocalTransform:{position:e.getPosition().clone(),rotation:e.getRotation().clone(),scale:e.getScale().clone()},eventHandler:o,parentTransformHandler:r,keepInLayer:!1,needsPositionUpdate:!1})}else console.warn("[SortNode] setNodeToLayer: Node has no parent")}}else console.error('[SortNode] setNodeToLayer: Layer "'.concat(t,'" not found'));else console.warn('[SortNode] setNodeToLayer: Invalid node for layer "'.concat(t,'"'))}},{key:"removeNodeFromLayer",value:function(e){var t=this.inst,n=t.nodeMetadata.get(e.uuid);n&&(e.off(pt.NODE_DESTROYED,n.eventHandler),n.originalParent.off(pt.TRANSFORM_CHANGED,n.parentTransformHandler),n.keepInLayer=!1,t.restoreNode$(n),t.revertNodeSiblingIndex$(n),t.movedNodes.delete(e.uuid),t.nodeMetadata.delete(e.uuid))}},{key:"keepNodeInLayer",value:function(e){var t=this.inst;if(null!=e&&e.isValid){var n=t.nodeMetadata.get(e.uuid);n?n.keepInLayer=!0:console.warn("[SortNode] keepNodeInLayer: Node not found in layer")}else console.warn("[SortNode] keepNodeInLayer: Invalid node")}},{key:"setActiveLayer",value:function(e,t){var n=this.inst;if(n.layerNodes.has(e)){var i=n.layerNodes.get(e);i&&(i.active=t),console.debug('[SortNode] setActiveLayer: Layer "'.concat(e,'" ').concat(t?"enabled":"disabled"))}else console.warn('[SortNode] setActiveLayer: Layer "'.concat(e,'" not found'))}}]),n}());X._RF.pop(),X._RF.push({},"46f05OkhTtGz6xBJuPMZGqH","ScoreBlock",void 0);var ZF,QF,eB,tB,nB,iB,aB,oB,rB,lB=Z.ccclass,sB=Z.property,uB=Z.disallowMultiple,cB=(GF=lB("ScoreBlock"),HF=sB(ke),qF=sB(Se),VF=sB({visible:function(){return this.isResizeWidth}}),$F=Yn.onlyRunInLifeCycle,GF(WF=uB((jF=a((KF=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"scoreText",jF,s(e)),l(e,"isResizeWidth",YF,s(e)),l(e,"maxScoreWidth",XF,s(e)),e.panelWidthDiff=0,e}return e(d,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(ne),this.scoreUITransform=this.scoreText.node.getComponent(ne),this.panelWidthDiff=this.uiTransform.width-this.maxScoreWidth,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateScore",value:(u=o((function*(e){var t=this,n=e-this.score,i=re(this.node).to(.1,{},{onUpdate:function(e,i){if(i){var a=Math.floor(n*i)+t.score;t.scoreText.string=a.toString(),t.resizeWidth()}}});yield p.runTweenAsync(i),this.setScore(e),yield this.resizeWidth()})),function(e){return u.apply(this,arguments)})},{key:"setScore",value:function(e){var t=null!=e?e:0;this.score=t,this.scoreText.string=t.toString()}},{key:"resizeWidth",value:(r=o((function*(){var e=this;if(this.isResizeWidth){var t=this.uiTransform.width,n=(this.scoreUITransform.width>this.maxScoreWidth?this.scoreUITransform.width:this.maxScoreWidth)+this.panelWidthDiff;n<=t&&0!==this.score||(this.uiTween&&this.uiTween.stop(),this.uiTween=re(this.node).to(.05,{},{easing:"sineOut",onUpdate:function(i,a){a&&(e.uiTransform.width=Ie.lerp(t,n,a))}}),yield p.runTweenAsync(this.uiTween),this.uiTransform.width=n,JF.setNodeToLayer(this.scoreText.node,"GameUnpackLabel"))}})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"scoreText",[HF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YF=a(KF.prototype,"isResizeWidth",[qF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),XF=a(KF.prototype,"maxScoreWidth",[VF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(KF.prototype,"setScore",[$F],Object.getOwnPropertyDescriptor(KF.prototype,"setScore"),KF.prototype),WF=KF))||WF)||WF);X._RF.pop(),X._RF.push({},"424745QWUlDPabdCe8UcRwy","ChallengeScoreBlock",void 0);var dB,hB,pB,yB,vB,fB,gB,mB=Z.ccclass,bB=Z.property,wB=(ZF=mB("ChallengeScoreBlock"),QF=bB(he),eB=bB(xe),tB=bB(me),ZF((aB=a((iB=function(a){n(p,a);var r,u,c=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"avatar",aB,s(e)),l(e,"defaultAvatar",oB,s(e)),l(e,"defaultAvatarNode",rB,s(e)),e.playerAvatarOverlay=null,e.isOverlayMode=!1,e.setAvatarSpriteFrame$=function(t){e.isValid&&(e.avatar.spriteFrame=t)},e.createAvatarOverlay$=function(){try{SM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.playerAvatarOverlay=new AM(e.node.scene)}catch(e){return}},e.handleScoreBlockPositionChange$=function(){var t;if(e.isOverlayMode){var n=e.getDefaultAvatarPosition$(),i=n.worldX,a=n.worldY;null===(t=e.playerAvatarOverlay)||void 0===t||t.moveOverlayTo(i,a)}},e.getDefaultAvatarPosition$=function(){var t=e.defaultAvatarNode;return{worldX:t.worldPositionX,worldY:t.worldPositionY}},e.getDefaultAvatarWidth$=function(){var t=e.defaultAvatarNode.getComponent(ne);return t?t.width:0},e}return e(p,[{key:"onLoad",value:function(){d(h(p.prototype),"onLoad",this).call(this),this.createAvatarOverlay$()}},{key:"onDisable",value:function(){this.cleanupOverlay()}},{key:"updateInfo",value:(u=o((function*(e,t,n){var i=this;this.setScore(n),this.scheduleOnce((function(){return i.resizeWidth()}),0);try{if(this.isOverlayMode){if(yield this.showAvatarOverlay(t))return;this.isOverlayMode=!1}var a=yield UM.getPlayerAvatar(e,t,50);if(!a)return;a.packable=!0,this.setAvatarSpriteFrame$(a)}catch(e){this.setAvatarSpriteFrame$(this.defaultAvatar)}})),function(e,t,n){return u.apply(this,arguments)})},{key:"showAvatarOverlay",value:(r=o((function*(e){var t,n=this.getDefaultAvatarPosition$(),i=n.worldX,a=n.worldY,o=yield null===(t=this.playerAvatarOverlay)||void 0===t?void 0:t.updateOverlay({playerId:e,worldX:i,worldY:a,avatarWidth:this.getDefaultAvatarWidth$()});return null!=o&&o})),function(e){return r.apply(this,arguments)})},{key:"cleanupOverlay",value:function(){var e;null===(e=this.playerAvatarOverlay)||void 0===e||e.hideOverlay()}},{key:"update",value:function(e){this.handleScoreBlockPositionChange$()}}]),p}(cB)).prototype,"avatar",[QF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oB=a(iB.prototype,"defaultAvatar",[eB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rB=a(iB.prototype,"defaultAvatarNode",[tB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nB=iB))||nB);X._RF.pop(),X._RF.push({},"aa96ehFCjBCy6vss3wBcr+l","CustomScoreContainer",void 0);var SB,kB,CB,EB,AB,TB,PB,LB,OB,IB,RB,_B,DB,NB,MB,FB,BB,xB,zB,UB,GB,HB,qB=Z.ccclass,VB=Z.property,$B=Z.disallowMultiple,WB=(dB=qB("CustomScoreContainer"),hB=VB(me),pB=VB(ke),dB(yB=$B((fB=a((vB=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"customScoreBlock",fB,s(e)),l(e,"scoreText",gB,s(e)),e}return e(r,[{key:"updateStatus",value:function(){Iv.getMatchMode()===Nv?(this.customScoreBlock.active=!0,this.scoreText.string="".concat(Kv.getCustomBonus(),"%")):this.customScoreBlock.active=!1}}]),r}(te)).prototype,"customScoreBlock",[hB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gB=a(vB.prototype,"scoreText",[pB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yB=vB))||yB)||yB);X._RF.pop(),X._RF.push({},"b1ef276tNtH+oc5BqYfDMXl","Sidebar",void 0);var KB,jB,YB,XB,JB,ZB,QB,ex,tx,nx,ix,ax=Z.ccclass,ox=Z.property,rx=Z.disallowMultiple,lx={score:-589.003,item:-861.836,sidebar:1114},sx={score:-568.518,item:-981.836,sidebar:1222},ux=(SB=ax("Sidebar"),kB=ox(cB),CB=ox(me),EB=ox(ke),AB=ox(me),TB=ox(oe),PB=ox(me),LB=ox(WB),OB=ox(Qe),IB=ox(de),RB=Yn.onlyRunInLifeCycle,SB(_B=rx((NB=a((DB=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"scoreBlock",NB,s(e)),l(e,"itemContainer",MB,s(e)),l(e,"levelNumber",FB,s(e)),l(e,"sidebarContainer",BB,s(e)),l(e,"sidebarBackground",xB,s(e)),l(e,"leavesContainer",zB,s(e)),l(e,"customScoreContainer",UB,s(e)),l(e,"entranceCurve",GB,s(e)),l(e,"uiOpacity",HB,s(e)),e.originSidebarPosition=0,e.originLeavesPosition=0,e}return e(d,[{key:"saveOriginPos",value:function(){this.originSidebarPosition=this.sidebarContainer.position.y,this.originLeavesPosition=this.leavesContainer.position.y}},{key:"initUIPos",value:function(){this.sidebarContainer.setPosition(this.sidebarContainer.position.x,this.originSidebarPosition+1250),this.leavesContainer.setPosition(this.leavesContainer.position.x,this.originLeavesPosition+150)}},{key:"playExitAnimUI",value:(u=o((function*(e){var t=this,n=function(){return t.setActive(!1)};e.addAbortListener(n);var i=re(this.sidebarContainer).to(.2,{position:new be(this.sidebarContainer.position.x,this.originSidebarPosition+1250,0)},{easing:"quadIn"}),a=re(this.leavesContainer);a.delay(.1).to(.2,{position:new be(this.leavesContainer.position.x,this.originLeavesPosition+150,0)},{easing:"quadIn"}),yield Promise.all([p.runTweenAsync(i,e),p.runTweenAsync(a,e)]),e.removeAbortListener(n),e.aborted||this.setActive(!1)})),function(e){return u.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(r=o((function*(e){var t=this;this.setActive(!0);var n=re(this.sidebarContainer).to(.3,{position:new be(this.sidebarContainer.position.x,this.originSidebarPosition,0)},{easing:function(e){return t.entranceCurve.evaluate(e)}}),i=re(this.leavesContainer);i.to(.2,{position:new be(this.leavesContainer.position.x,this.originLeavesPosition,0)},{easing:"quadIn"}),yield Promise.all([p.runTweenAsync(n,e),p.runTweenAsync(i,e)])})),function(e){return r.apply(this,arguments)})},{key:"setActive",value:function(e){this.uiOpacity&&(this.uiOpacity.opacity=e?255:0)}},{key:"setLevelText",value:function(e){this.levelNumber.string=e.toString()}},{key:"updateStatus",value:function(e){void 0!==e.score&&this.scoreBlock.setScore(e.score),void 0!==e.level&&this.setLevelText(e.level),this.customScoreContainer.updateStatus(),this.updateUIByMode()}},{key:"updateScore",value:function(e){this.scoreBlock.updateScore(e)}},{key:"updateUIByMode",value:function(){var e=Iv.getMatchMode()===Nv?sx:lx;this.scoreBlock.node.position.set(this.scoreBlock.node.position.x,e.score),this.itemContainer.position.set(this.itemContainer.position.x,e.item),this.sidebarContainer.getComponent(ne).height=e.sidebar,this.sidebarBackground.updateAlignment()}}]),d}(te)).prototype,"scoreBlock",[kB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MB=a(DB.prototype,"itemContainer",[CB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FB=a(DB.prototype,"levelNumber",[EB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BB=a(DB.prototype,"sidebarContainer",[AB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xB=a(DB.prototype,"sidebarBackground",[TB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zB=a(DB.prototype,"leavesContainer",[PB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UB=a(DB.prototype,"customScoreContainer",[LB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GB=a(DB.prototype,"entranceCurve",[OB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Qe}}),HB=a(DB.prototype,"uiOpacity",[IB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(DB.prototype,"setActive",[RB],Object.getOwnPropertyDescriptor(DB.prototype,"setActive"),DB.prototype),_B=DB))||_B)||_B);X._RF.pop(),X._RF.push({},"0ff4fFbKylIvaONtaTZkRQV","LandscapeLayout",void 0);var cx,dx,hx,px,yx,vx,fx,gx=Z.ccclass,mx=Z.property,bx=codex.match,wx=Ludex.Match.Modes,Sx=(KB=gx("LandscapeLayout"),jB=mx({type:ux,group:"Sidebar"}),YB=mx({type:wB,group:"ChallengeScore"}),XB=mx({type:wB,group:"ChallengeScore"}),JB=mx(me),KB((ex=a((QB=function(a){n(v,a);var r,u,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"sidebar",ex,s(e)),l(e,"playerScoreBlock",tx,s(e)),l(e,"opponentScoreBlock",nx,s(e)),l(e,"topAnimNodes",ix,s(e)),e.originTopNodesPos=[],e}return e(v,[{key:"onLoad",value:function(){var e=this;ee.once(Pe.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"saveOriginPos",value:function(){this.sidebar.saveOriginPos();var e,t=c(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}}},{key:"initUIPos",value:function(){var e=this;this.sidebar.initUIPos(),this.topAnimNodes.forEach((function(t,n){var i=e.originTopNodesPos[n].clone();i.y+=100,t.setPosition(i)}))}},{key:"playExitAnimUI",value:(u=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new Mi;var n=[];this.topAnimNodes.forEach((function(i,a){var o=new be(e.node.position.x,e.originTopNodesPos[a].y+100,0),r=re(i);r.to(t,{position:o},{easing:"backIn"}),n.push(p.runTweenAsync(r,e.exitSignal))})),n.push(this.sidebar.playExitAnimUI(this.exitSignal)),yield Promise.all(n)})),function(){return u.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(r=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new Mi;var n=[];this.topAnimNodes.forEach((function(i,a){if(i.active){var o=new be(e.node.position.x,e.originTopNodesPos[a].y,0),r=re(i);r.to(t,{position:o},{easing:"backOut"});var l=p.runTweenAsync(r,e.entranceSignal);n.push(l)}})),n.push(this.sidebar.playEntranceAnimUI(this.entranceSignal)),yield Promise.all(n)})),function(){return r.apply(this,arguments)})},{key:"setLevelText",value:function(e){this.sidebar.setLevelText(e)}},{key:"updateStatus",value:function(e){d(h(v.prototype),"updateStatus",this).call(this,e),this.sidebar.updateStatus(e),this.updateScoreBlockStatus(e)}},{key:"updateScoreBlockStatus",value:function(e){var t;if(Iv.getMatchMode()!==wx.CHALLENGE_FRIEND)return this.playerScoreBlock.node.active=!1,void(this.opponentScoreBlock.node.active=!1);if(!this.playerScoreBlock.node.active){var n=bx.getMatchState(),i=null!==(t=Iv.getMatchCustomData())&&void 0!==t?t:{},a=i.playerId,o=i.opponentId;if(a&&o){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var r=n.profiles[a],l=n.profiles[o];r&&this.playerScoreBlock.updateInfo(r.photo,a,r.score),l&&this.opponentScoreBlock.updateInfo(l.photo,o,l.score),void 0!==e.score&&this.playerScoreBlock.setScore(e.score)}}}},{key:"handleScoreUpdated",value:function(e){this.sidebar.updateScore(e),this.playerScoreBlock.node.active&&this.playerScoreBlock.updateScore(e)}}]),v}(UF)).prototype,"sidebar",[jB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tx=a(QB.prototype,"playerScoreBlock",[YB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=a(QB.prototype,"opponentScoreBlock",[XB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ix=a(QB.prototype,"topAnimNodes",[JB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ZB=QB))||ZB);X._RF.pop(),X._RF.push({},"396015KIPBL3bHTUOHN7pCl","UIMasks",void 0);var kx,Cx,Ex,Ax,Tx,Px,Lx,Ox,Ix,Rx,_x,Dx,Nx,Mx,Fx,Bx,xx=Z.ccclass,zx=Z.property,Ux=(cx=xx("UIMasks"),dx=zx(qr),hx=zx($R),cx((vx=a((yx=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"background",vx,s(e)),l(e,"alphaMasks",fx,s(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(u=o((function*(){this.alphaMasks.setMaskActive(0,P.isPortrait()),this.alphaMasks.setMaskActive(1,P.isLandscape()),yield this.background.changeStateFade(!0,.25)})),function(){return u.apply(this,arguments)})},{key:"hide",value:(r=o((function*(){yield this.background.changeStateFade(!1,.25)})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"background",[dx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fx=a(yx.prototype,"alphaMasks",[hx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),px=yx))||px);X._RF.pop(),X._RF.push({},"755d1r2cMRLvo4fObNWxss/","CoinContainer",void 0);var Gx,Hx,qx,Vx,$x,Wx,Kx,jx,Yx,Xx=Z.ccclass,Jx=Z.property,Zx=Ludex.Utils.Number,Qx=(kx=Xx("CoinContainer"),Cx=Jx(ke),Ex=Jx(he),Ax=Jx(de),Tx=Jx(Oe),Px=Yn.onlyRunInLifeCycle,Lx=Yn.onlyRunInLifeCycleAsync,Ox=Yn.onlyRunInLifeCycleAsync,Ix=Yn.onlyRunInLifeCycle,Rx=Yn.onlyRunInLifeCycle,kx((Nx=a((Dx=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"coinLabel",Nx,s(e)),l(e,"coinIcon",Mx,s(e)),l(e,"explosionCircle",Fx,s(e)),l(e,"explosionParticles",Bx,s(e)),e.currentCoin=0,e}return e(h,[{key:"setCoinTextFromNumber",value:function(e){var t=Zx.getShortNumber(e,3);this.coinLabel.string=t}},{key:"handleAddCoinButton",value:function(){x.openScreen(z.GET_COIN_SCREEN,{quantity:Xy})}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenToEvents(),this.explosionParticles.node.active=!1}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenToEvents",value:function(){this.node.scene.on(Js.COIN_CHANGED,this.updateCoins,this)}},{key:"updateCoins",value:(c=o((function*(e){var t,n,i,a=e.coins,o=e.collectionAnimation,r=e.playSound;if(void 0!==o&&!1!==this.node.activeInHierarchy){var l=o.signal;if(null===(t=this.animAbortSignal)||void 0===t||t.abort(),this.animAbortSignal=null!=l?l:new Mi,o.animateTextOnly)return yield this.animateCoinText(a,0,r,l),void this.setCoins(a);var s=null!==(n=o.flyDuration)&&void 0!==n?n:0,u=(null!==(i=o.floatDuration)&&void 0!==i?i:0)+s;yield this.animateCoinText(a,u,r,l),this.setCoins(a)}else this.setCoins(a)})),function(e){return c.apply(this,arguments)})},{key:"setCoins",value:function(e){this.setCoinTextFromNumber(e),this.currentCoin=e}},{key:"animateCoinText",value:(u=o((function*(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3?arguments[3]:void 0,o=this.currentCoin;yield p.waitTweenAsync(t,a),i&&w.playSound(Qi.COLLECT_COINS),yield p.runOnUpdateAsync(this.node,1,(function(t){var i=Math.round(o+(e-o)*t);n.setCoinTextFromNumber(i)}),a)})),function(e,t){return u.apply(this,arguments)})},{key:"emitExplodeEffect",value:(r=o((function*(e){this.initializeExplosionCircle(),this.explosionParticles.resetSystem(),yield Promise.all([p.runTweenAsync(re(this.explosionCircle.node).to(.4,{scale:new be(3,3,3)},{easing:"quadOut"}),e),p.runTweenAsync(re(this.explosionCircle).delay(.2).to(.2,{opacity:0}),e)]),this.resetExplosionCircle()})),function(e){return r.apply(this,arguments)})},{key:"resetExplosionCircle",value:function(){this.explosionCircle.node.setScale(0,0),this.explosionCircle.opacity=0,this.explosionCircle.node.active=!1,this.explosionParticles.node.active=!1}},{key:"initializeExplosionCircle",value:function(){this.explosionCircle.node.active=!0,this.explosionParticles.node.active=!0,this.explosionCircle.opacity=255,this.explosionCircle.node.setScale(0,0)}},{key:"getCoinIconWorldPosition",value:function(){return this.coinIcon.node.worldPosition}},{key:"getCoinIconWorldScale",value:function(){return this.coinIcon.node.worldScale}},{key:"onDestroy",value:function(){var e;null===(e=this.animAbortSignal)||void 0===e||e.abort()}}]),h}(te)).prototype,"coinLabel",[Cx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mx=a(Dx.prototype,"coinIcon",[Ex],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fx=a(Dx.prototype,"explosionCircle",[Ax],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bx=a(Dx.prototype,"explosionParticles",[Tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Dx.prototype,"setCoins",[Px],Object.getOwnPropertyDescriptor(Dx.prototype,"setCoins"),Dx.prototype),a(Dx.prototype,"animateCoinText",[Lx],Object.getOwnPropertyDescriptor(Dx.prototype,"animateCoinText"),Dx.prototype),a(Dx.prototype,"emitExplodeEffect",[Ox],Object.getOwnPropertyDescriptor(Dx.prototype,"emitExplodeEffect"),Dx.prototype),a(Dx.prototype,"resetExplosionCircle",[Ix],Object.getOwnPropertyDescriptor(Dx.prototype,"resetExplosionCircle"),Dx.prototype),a(Dx.prototype,"initializeExplosionCircle",[Rx],Object.getOwnPropertyDescriptor(Dx.prototype,"initializeExplosionCircle"),Dx.prototype),_x=Dx))||_x);X._RF.pop(),X._RF.push({},"f963aJjCvtD0Y2LplwjDer1","ScoreContainer",void 0);var ez,tz,nz,iz,az,oz,rz,lz,sz,uz,cz,dz,hz,pz,yz,vz,fz,gz,mz,bz,wz=Z.ccclass,Sz=Z.property,kz=Ludex.Match.Modes,Cz=codex.match,Ez=(Gx=wz("ScoreContainer"),Hx=Sz(cB),qx=Sz(wB),Vx=Sz(wB),Gx((Kx=a((Wx=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"scoreBlock",Kx,s(e)),l(e,"playerScoreBlock",jx,s(e)),l(e,"opponentScoreBlock",Yx,s(e)),e.scoreBlockShown=!0,e.challengeScoreBlockShown=!1,e}return e(r,[{key:"updateStatus",value:function(e){switch(Cz.getMatchState().mode){case kz.CHALLENGE_FRIEND:this.showChallengeScoreBlock(),this.hideScoreBlock(),void 0!==e.score&&this.playerScoreBlock.setScore(e.score);break;case kz.SINGLE:case Nv:this.hideChallengeScoreBlock(),this.showScoreBlock(),void 0!==e.score&&this.scoreBlock.setScore(e.score);break;default:this.hideScoreBlock(),this.hideChallengeScoreBlock()}}},{key:"showChallengeScoreBlock",value:function(){var e;if(!this.challengeScoreBlockShown){this.challengeScoreBlockShown=!0;var t=Cz.getMatchState(),n=null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{},i=n.playerId,a=n.opponentId;if(i&&a){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var o=t.profiles[i],r=t.profiles[a];o&&r&&(this.playerScoreBlock.updateInfo(o.photo,i,o.score),this.opponentScoreBlock.updateInfo(r.photo,a,r.score))}}}},{key:"hideChallengeScoreBlock",value:function(){this.challengeScoreBlockShown&&(this.challengeScoreBlockShown=!1,this.playerScoreBlock.node.active=!1,this.opponentScoreBlock.node.active=!1,this.playerScoreBlock.cleanupOverlay(),this.opponentScoreBlock.cleanupOverlay())}},{key:"showScoreBlock",value:function(){var e;if(!this.scoreBlockShown){this.scoreBlockShown=!0;var t=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).score;this.scoreBlock.node.active=!0,this.scoreBlock.setScore(t)}}},{key:"hideScoreBlock",value:function(){this.scoreBlockShown&&(this.scoreBlockShown=!1,this.scoreBlock.node.active=!1)}},{key:"updateScore",value:function(e){this.challengeScoreBlockShown?this.playerScoreBlock.updateScore(e):this.scoreBlockShown&&this.scoreBlock.updateScore(e)}}]),r}(te)).prototype,"scoreBlock",[Hx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jx=a(Wx.prototype,"playerScoreBlock",[qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yx=a(Wx.prototype,"opponentScoreBlock",[Vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$x=Wx))||$x);X._RF.pop(),X._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var Az,Tz,Pz,Lz,Oz,Iz,Rz,_z,Dz,Nz=Z.ccclass,Mz=Z.property,Fz=(ez=Nz("Header"),tz=Mz(Lh),nz=Mz(me),iz=Mz(me),az=Mz(me),oz=Mz(me),rz=Mz(Ez),lz=Mz(Qx),sz=Mz(WB),uz=Yn.onlyRunInLifeCycle,ez((hz=a((dz=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"levelTextLocalizer",hz,s(e)),l(e,"settingNode",pz,s(e)),l(e,"homeNode",yz,s(e)),l(e,"leftNode",vz,s(e)),l(e,"coinNode",fz,s(e)),l(e,"scoreContainer",gz,s(e)),l(e,"coinContainer",mz,s(e)),l(e,"customScoreContainer",bz,s(e)),e}return e(r,[{key:"onLoad",value:function(){this.uiOpacity=this.node.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateStatus",value:function(e){this.scoreContainer.updateStatus(e),void 0!==e.coins&&this.coinContainer.setCoins(e.coins),void 0!==e.level&&this.setLevelText(e.level)}},{key:"highlightCoinContainer",value:function(){var e=Me("Canvas/Screens");if(e){var t=this.coinNode.worldPosition.clone();this.coinNode.parent=e,this.coinNode.worldPosition=t}}},{key:"removeCoinContainerHighlight",value:function(){var e=this.coinNode.worldPosition.clone();this.coinNode.parent=this.leftNode,this.coinNode.worldPosition=e}},{key:"setLevelText",value:function(e){this.levelTextLocalizer.setParams([e.toString()])}},{key:"setButtonsInteractable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.settingNode.getComponent(fe).interactable=e,this.homeNode.getComponent(fe).interactable=e}},{key:"setActive",value:function(e){this.uiOpacity.opacity=e?255:0}}]),r}(te)).prototype,"levelTextLocalizer",[tz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pz=a(dz.prototype,"settingNode",[nz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yz=a(dz.prototype,"homeNode",[iz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vz=a(dz.prototype,"leftNode",[az],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fz=a(dz.prototype,"coinNode",[oz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gz=a(dz.prototype,"scoreContainer",[rz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mz=a(dz.prototype,"coinContainer",[lz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bz=a(dz.prototype,"customScoreContainer",[sz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(dz.prototype,"setActive",[uz],Object.getOwnPropertyDescriptor(dz.prototype,"setActive"),dz.prototype),cz=dz))||cz);X._RF.pop(),X._RF.push({},"456584ngz9FupmxndAXqCbY","PortraitLayout",void 0);var Bz=Z.ccclass,xz=Z.property,zz=(Az=Bz("PortraitLayout"),Tz=xz(Fz),Pz=xz([me]),Lz=xz([me]),Az((Rz=a((Iz=function(a){n(v,a);var r,u,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"header",Rz,s(e)),l(e,"topAnimNodes",_z,s(e)),e.originTopNodesPos=[],l(e,"botAnimNodes",Dz,s(e)),e.originBotNodesPos=[],e.hideBotWorldY=-80,e}return e(v,[{key:"onLoad",value:function(){var e=this;this.validateRequiredComponents(),ee.once(Pe.EVENT_AFTER_UPDATE,(function(){e.saveOriginPos(),e.initUIPos(),e.isInited=!0}))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"saveOriginPos",value:function(){var e,t=c(this.topAnimNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.originTopNodesPos.push(n.position.clone())}}catch(e){t.e(e)}finally{t.f()}var i,a=c(this.botAnimNodes);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.originBotNodesPos.push(o.position.clone())}}catch(e){a.e(e)}finally{a.f()}}},{key:"initUIPos",value:function(){var e=this;this.topAnimNodes.forEach((function(t,n){var i,a,o=null!==(i=null===(a=e.originTopNodesPos[n])||void 0===a?void 0:a.clone())&&void 0!==i?i:new be(0,0,0);o.y+=200,t.setPosition(o)}));var t=new be(0,this.hideBotWorldY,0);this.botAnimNodes.forEach((function(n,i){var a,o,r,l,s=null!==(a=null===(o=e.originBotNodesPos[i])||void 0===o?void 0:o.clone())&&void 0!==a?a:new be(0,0,0);t.y=e.hideBotWorldY;var u=null!==(r=null===(l=n.parent)||void 0===l?void 0:l.inverseTransformPoint(t,t).y)&&void 0!==r?r:200;s.y=u,n.setPosition(s)}))}},{key:"setLevelText",value:function(e){this.header.setLevelText(e)}},{key:"disableLayout",value:function(){this.header.setButtonsInteractable(!1)}},{key:"enableLayout",value:function(){this.header.setButtonsInteractable()}},{key:"updateStatus",value:function(e){d(h(v.prototype),"updateStatus",this).call(this,e),this.header.updateStatus(e)}},{key:"playExitAnimUI",value:(u=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new Mi;var n=[];this.topAnimNodes.forEach((function(i,a){var o,r;if(i.active){var l=new be(i.position.x,(null!==(o=null===(r=e.originTopNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0)+200,0),s=re(i);s.to(t,{position:l},{easing:"backIn"}),n.push(p.runTweenAsync(s,e.exitSignal))}}));var i,a=new be(0,this.hideBotWorldY,0),o=c(this.botAnimNodes);try{for(o.s();!(i=o.n()).done;){var r,l,s=i.value;if(s.active){a.y=this.hideBotWorldY;var u=null!==(r=null===(l=s.parent)||void 0===l?void 0:l.inverseTransformPoint(a,a).y)&&void 0!==r?r:200,d=new be(s.position.x,u,0),h=re(s);h.to(t,{position:d},{easing:"backIn"}),n.push(p.runTweenAsync(h,this.exitSignal))}}}catch(e){o.e(e)}finally{o.f()}yield Promise.all(n),this.exitSignal.aborted||this.header.setActive(!1)})),function(){return u.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(r=o((function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new Mi,this.header.setActive(!0);var n=[];this.topAnimNodes.forEach((function(i,a){var o,r,l=new be(i.position.x,null!==(o=null===(r=e.originTopNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0,0),s=re(i);s.to(t,{position:l},{easing:"backOut"}),n.push(p.runTweenAsync(s,e.entranceSignal))})),this.botAnimNodes.forEach((function(i,a){var o,r,l=new be(i.position.x,null!==(o=null===(r=e.originBotNodesPos[a])||void 0===r?void 0:r.y)&&void 0!==o?o:0,0),s=re(i);s.to(t,{position:l},{easing:"backOut"}),n.push(p.runTweenAsync(s,e.entranceSignal))})),yield Promise.all(n)})),function(){return r.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.header.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.header.removeCoinContainerHighlight()}},{key:"handleScoreUpdated",value:function(e){this.header.scoreContainer.updateScore(e)}}]),v}(UF)).prototype,"header",[Tz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_z=a(Iz.prototype,"topAnimNodes",[Pz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Dz=a(Iz.prototype,"botAnimNodes",[Lz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Oz=Iz))||Oz);X._RF.pop(),X._RF.push({},"805dbJxaCpKBpzq9ejSgrc8","TileType",void 0);var Uz,Gz,Hz,qz,Vz,$z="bomb";X._RF.pop(),X._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var Wz,Kz,jz,Yz,Xz,Jz,Zz,Qz,eU,tU,nU,iU,aU,oU,rU,lU,sU,uU=Ludex,cU=uU.Dtos.Player,dU=uU.Utils.Function,hU=Z.ccclass,pU=Z.property,yU=codex,vU=yU.player,fU=yU.language,gU=(Uz=hU("DevToolsContainer"),Gz=pU(me),Uz((Vz=a((qz=function(a){n(v,a);var r,u,d,h,p=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),l(e,"devToolsToggle",Vz,s(e)),e.isActive=!0,e.game=null,e.bundleName="lowest",e.currentLocaleIndex=0,e.debouncedStarsNotification=dU.debounce((function(){var e=vU.getGameData();e&&x.showNotificationScreen("Stars added. Current stars: ".concat(e.stars))}),700),e}return e(v,[{key:"injectGameplay",value:function(e){this.game=e}},{key:"start",value:function(){this.initCurrentLocale()}},{key:"initCurrentLocale",value:function(){var e=fU.getCurrentLocale();this.currentLocaleIndex=O.indexOf(e)}},{key:"hideAllButtons",value:function(){var e,t=this.getComponentsInChildren(fe),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!1))}}catch(e){n.e(e)}finally{n.f()}}},{key:"showAllButtons",value:function(){var e,t=this.getComponentsInChildren(fe),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.node.parent;i&&(i.name!==this.devToolsToggle.name&&(i.active=!0))}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleClickDevToolsButton",value:function(){this.isActive?(this.hideAllButtons(),this.isActive=!1):(this.showAllButtons(),this.isActive=!0)}},{key:"handleResetData",value:function(){vU.setPlayerData(cU.Data.getDefaults()),x.openScreen(z.NOTIFICATION_SCREEN,{duration:3,message:"Items and stars will only be reset if you refresh the game page now."}),this.node.scene.emit(Js.START_OVER,0)}},{key:"handleNextLevel",value:(h=o((function*(){var e,t,n,i=(null!==(e=null===(t=this.game)||void 0===t||null===(t=t.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1)+1;null===(n=this.game)||void 0===n||n.setGameData({level:i-1}),vU.setGameData({level:i}),this.node.scene.emit(Js.NEXT_LEVEL)})),function(){return h.apply(this,arguments)})},{key:"handlePrevLevel",value:(d=o((function*(){var e,t,n,i=Math.max((null!==(e=null===(t=this.game)||void 0===t||null===(t=t.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:2)-1,1);null===(n=this.game)||void 0===n||n.setGameData({level:i-1}),vU.setGameData({level:i}),this.node.scene.emit(Js.NEXT_LEVEL)})),function(){return d.apply(this,arguments)})},{key:"handleEnterSelectLevel",value:(u=o((function*(e){var t,n=Number(e.string);null===(t=this.game)||void 0===t||t.setGameData({level:n-1}),vU.setGameData({level:n}),this.node.scene.emit(Js.NEXT_LEVEL)})),function(e){return u.apply(this,arguments)})},{key:"handleClickBuildVersionButton",value:function(){var e=codex.getBuildVersion();x.showNotificationScreen("Build version: ".concat(e))}},{key:"handleClickWinLevelButton",value:function(){this.node.scene.emit(Js.GAME_FINISH)}},{key:"handleClickTimeOutButton",value:function(){var e;null===(e=this.game)||void 0===e||e.clockManager.setTime(.1)}},{key:"handleClickExplodeButton",value:function(){var e,t,n=this.game;if(n){var i=null===(e=n.getGameData())||void 0===e||null===(e=e.levelData)||void 0===e?void 0:e.specials.bomb;if(i&&!(i<=0)){var a=n.board.getBombTiles();if(0!==a.length){var o=a[0];if(!o||(null===(t=o.special)||void 0===t?void 0:t.type)!==$z)throw new Error("Invalid bomb tile");o.special.detonateImmediately()}else console.info("No bomb tiles found")}}}},{key:"handleFillItem",value:function(){this.node.scene.emit(Js.ADD_ITEM,{item:_.HINT,quantity:2}),this.node.scene.emit(Js.ADD_ITEM,{item:_.STORM,quantity:2}),this.node.scene.emit(Js.ADD_ITEM,{item:_.THUNDER,quantity:2}),this.node.scene.emit(Js.ADD_ITEM,{item:_.PLIERS,quantity:2})}},{key:"handleAutoPlay",value:function(){this.node.scene.emit(Js.AUTO_PLAY)}},{key:"handleAddStars",value:function(){var e=vU.getGameData();e&&(vU.setGameData({stars:e.stars+10}),this.debouncedStarsNotification())}},{key:"handleSwitchQualityAssets",value:function(){switch(this.bundleName){case"lowest":this.bundleName="highest";break;case"highest":this.bundleName="lowest"}se.emit(y.REQUEST_UPGRADE_ASSET,{quality:this.bundleName})}},{key:"handleSwitchLocale",value:(r=o((function*(){this.currentLocaleIndex=(this.currentLocaleIndex+1)%O.length;var e=O[this.currentLocaleIndex];x.showLoadingNotificationScreen();try{if(!e)throw new Error("Locale is undefined");yield this.preloadLanguageAsync(e),se.emit(y.CHOOSE_LANGUAGE,{locale:e,saveToPlayerData:!0}),x.showNotificationScreen("Language changed to ".concat(e))}catch(e){console.error(e),x.showNotificationScreen("Failed to change language")}})),function(){return r.apply(this,arguments)})},{key:"preloadLanguageAsync",value:function(e){return new Promise((function(t,n){se.emit(y.PRELOAD_LANGUAGE,{locale:e,onLoad:t,onError:n})}))}}]),v}(te)).prototype,"devToolsToggle",[Gz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hz=qz))||Hz);X._RF.pop(),X._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var mU,bU,wU,SU,kU,CU,EU,AU,TU,PU=Z.ccclass,LU=Z.property,OU=Ludex,IU=OU.Utils.Valid,RU=OU.Match.Modes,_U=m.Layout,DU=(Wz=PU("UIManager"),Kz=LU(kN),jz=LU(zz),Yz=LU(Sx),Xz=LU(gU),Jz=LU(eM),Zz=LU(TN),Qz=LU(Ux),Wz((nU=a((tU=function(a){n(f,a);var r,u,d,h,p,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"interstitialAdIndicator",nU,s(e)),l(e,"portraitLayout",iU,s(e)),l(e,"landscapeLayout",aU,s(e)),l(e,"devTools",oU,s(e)),l(e,"comboProgressBar",rU,s(e)),l(e,"comboContainer",lU,s(e)),l(e,"uiMasks",sU,s(e)),e.uiShown=!1,e.config={},e.isResetDataListener=!1,e.showDevTools=function(){e.devTools&&(e.devTools.node.active=!0)},e}return e(f,[{key:"onLoad",value:function(){this.node.scene.on(iv.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.on(Js.RESCUE_START,this.showRescueAnimation,this),this.node.scene.on(Js.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.on(Js.SCORE_UPDATED,this.handleScoreUpdated,this),se.on(y.ORIENTATION_CHANGED,this.onOrientationChanged,this),this.onOrientationChanged(P.getCurrentLayout())}},{key:"onDestroy",value:function(){this.node.scene.off(iv.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.off(Js.RESCUE_START,this.showRescueAnimation,this),this.node.scene.off(Js.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.off(Js.SCORE_UPDATED,this.handleScoreUpdated,this),se.off(y.ORIENTATION_CHANGED,this.onOrientationChanged,this)}},{key:"init",value:function(e){this.currentLayout=this.portraitLayout,this.game=e,this.initDevTools(e),this.comboContainer.init(e.board)}},{key:"initDevTools",value:function(e){var t=this;this.isResetDataListener||(window.addEventListener("reset-game-data",(function(){var e;null===(e=t.devTools)||void 0===e||e.handleResetData()})),this.isResetDataListener=!0),this.devTools&&(this.devTools.node.active=IU.isDebugger(),this.devTools.injectGameplay(e))}},{key:"setLevelText",value:function(e){this.config.level=e,this.currentLayout.setLevelText(e)}},{key:"startCountdown",value:function(){this.comboProgressBar.resume()}},{key:"pauseTime",value:function(){this.comboProgressBar.pause()}},{key:"resumeTime",value:function(){this.comboProgressBar.resume()}},{key:"setComboUI",value:function(e){this.comboContainer.getComponent(qr).changeStateFade(e,.1)}},{key:"disableLayout",value:function(){this.currentLayout.disableLayout()}},{key:"enableLayout",value:function(){this.currentLayout.enableLayout()}},{key:"updateStatus",value:function(){var e;this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),score:this.game.scoreManager.getCurrentScore(),leaderData:null===(e=this.game.tournamentManager)||void 0===e?void 0:e.leaderData,items:this.game.itemManager.itemConfigs}),this.comboContainer.updateStatus()}},{key:"showRescueAnimation",value:(p=o((function*(){yield this.uiMasks.show()})),function(){return p.apply(this,arguments)})},{key:"hideRescueAnimation",value:(h=o((function*(){yield this.uiMasks.hide()})),function(){return h.apply(this,arguments)})},{key:"playExitAnimUI",value:(d=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.uiShown=!1,yield this.currentLayout.playExitAnimUI(e)})),function(){return d.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(u=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;this.uiShown=!0,yield this.currentLayout.playEntranceAnimUI(e)})),function(){return u.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.currentLayout.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.currentLayout.unHighlightCoinContainer()}},{key:"handleClickedPauseGame",value:function(){x.openScreen(z.PAUSE_SCREEN),this.node.scene.emit(Js.GAME_PAUSE)}},{key:"handleReturnHome",value:function(){x.openScreen(z.QUIT_LEVEL_SCREEN),this.node.scene.emit(Js.GAME_PAUSE)}},{key:"items",get:function(){return this.currentLayout.items}},{key:"setInteractableItems",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=c(this.items);try{for(n.s();!(e=n.n()).done;){var i=e.value;t?void 0!==i.itemType?i.button.interactable=this.game.itemManager.canUseItem(i.itemType):console.warn("Item type is not defined"):i.button.interactable=!1}}catch(e){n.e(e)}finally{n.f()}}},{key:"onOrientationChanged",value:(r=o((function*(e){var t;e===_U.Portrait?(this.landscapeLayout.node.active=!1,this.portraitLayout.node.active=!0,this.currentLayout=this.portraitLayout):e===_U.Landscape&&(this.portraitLayout.node.active=!1,this.landscapeLayout.node.active=!0,this.currentLayout=this.landscapeLayout),this.currentLayout&&(this.currentLayout.updateStatus({coins:this.game.coinManager.getCoins(),level:this.config.level,score:this.game.scoreManager.getCurrentScore(),time:this.game.clockManager.getRemainingTime(),leaderData:null===(t=this.game.tournamentManager)||void 0===t?void 0:t.leaderData,items:this.game.itemManager.itemConfigs}),yield this.currentLayout.waitForInitAsync(),this.uiShown?this.playEntranceAnimUI(0):this.playExitAnimUI(0))})),function(e){return r.apply(this,arguments)})},{key:"handleScoreUpdated",value:function(e){var t;this.config.score=e,this.currentLayout.handleScoreUpdated(e),Iv.getMatchMode()===RU.TOURNAMENT&&this.currentLayout.tournamentRail.handleScoreUpdated({score:e,leaderData:null===(t=this.game.tournamentManager)||void 0===t?void 0:t.leaderData})}}]),f}(te)).prototype,"interstitialAdIndicator",[Kz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iU=a(tU.prototype,"portraitLayout",[jz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aU=a(tU.prototype,"landscapeLayout",[Yz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oU=a(tU.prototype,"devTools",[Xz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rU=a(tU.prototype,"comboProgressBar",[Jz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lU=a(tU.prototype,"comboContainer",[Zz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sU=a(tU.prototype,"uiMasks",[Qz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eU=tU))||eU);X._RF.pop(),X._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var NU=codex,MU=NU.player,FU=NU.event,BU=NU.match,xU=NU.storage,zU=NU.analytics,UU=NU.monitorError,GU=NU.leaderboard,HU=Ludex,qU=HU.Events,VU=HU.Utils,$U=VU.Time,WU=VU.Array,KU=VU.Valid,jU=HU.Configs.Gameplay,YU=HU.Match.Modes,XU=HU.Plugins.Ads,JU=(void 0===XU?{}:XU).Types,ZU=Z.ccclass,QU=Z.property,eG={level:1,isFromLoader:!1};mU=ZU("Gameplay"),bU=QU(wb),wU=QU(qr),SU=QU(Bw),mU((EU=a((CU=function(a){n(p,a);var r,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),l(e,"board",EU,s(e)),l(e,"opacityToggler",AU,s(e)),l(e,"pathDraw",TU,s(e)),e.gameData=null,e.rescueTiles=[],e.isAutoPlayEnabled=!1,e.isAdPreloadedForCurrentLevel=!1,e.handleOpenScreen=function(t){t.screenName===V[z.GET_ITEM_SCREEN]&&e.uiManager.highlightCoinContainer()},e.handleShowUI=o((function*(){e.uiManager.updateStatus(),e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),yield e.uiManager.playEntranceAnimUI(),e.uiManager.enableLayout(),e.uiManager.setInteractableItems(!0)})),e.handleHideUI=o((function*(){e.uiManager.disableLayout(),e.uiManager.setInteractableItems(!1),yield e.uiManager.playExitAnimUI()})),e.handleCloseScreen=function(t){t.screenName===V[z.GET_ITEM_SCREEN]&&e.uiManager.unHighlightCoinContainer()},e.handlePauseGame=function(){e.node.scene.emit(Js.PAUSE_TIME),e.node.pauseSystemEvents(!0),e.opacityToggler.changeStateFade(!1,.1),e.uiManager.setComboUI(!1),e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(){var t;e.node.resumeSystemEvents(!0),e.stateManager.isPlaying()&&e.node.scene.emit(Js.RESUME_TIME),e.processCrazyGamesGameplayStart(),e.opacityToggler.changeStateFade(!0,.1),e.uiManager.setComboUI(!0),null===(t=e.guidelinesManager)||void 0===t||t.startAutoGuides()},e.handleReplayGame=function(){var t=o((function*(t){e.handleHideHint();try{var n=Iv.getMatchMode();n!==YU.SINGLE&&n!==Nv||(yield Iv.finishMatchAsync()),n!==YU.CHALLENGE_FRIEND&&(yield Iv.startMatchAsync(t)),n===YU.TOURNAMENT&&(yield Iv.setMatchCustomDataAsync({level:1,score:0}),e.setGameData({level:1}))}catch(e){console.warn("handleReplayGame",e)}e.stateManager.initialize()}));return function(e){return t.apply(this,arguments)}}(),e.handleFinishGame=function(){var t;e.attemptCallCreateShortcut(),null!==(t=e.guidelinesManager)&&void 0!==t&&t.isNewbieGuideLevel()?(e.guidelinesManager.guideUi.guideSkipButton.active=!1,e.handleNextLevel()):e.stateManager.finish()},e.handleNextLevel=o((function*(){var t;if(e.gameData){var n=Iv.getMatchMode();try{n!==YU.SINGLE&&n!==Nv||(yield Iv.finishMatchAsync())}catch(e){console.warn("handleNextLevel",e)}var i=(null!==(t=e.gameData.level)&&void 0!==t?t:1)+1;e.setGameData({level:i}),n===YU.TOURNAMENT?yield Iv.setMatchCustomDataAsync({level:i}):(yield Iv.setMatchCustomDataAsync({level:i,score:0}),yield Iv.startMatchAsync()),e.stateManager.initialize(),console.log("Next level",e.gameData.level)}})),e.handleStartOver=function(){var t=o((function*(t){var n;MU.setGameData({level:null!=t?t:1}),yield Iv.setMatchCustomDataAsync({level:t,score:0}),e.gameData=MU.getGameData(),e.stateManager.initialize(),console.info("Start over",null===(n=e.gameData)||void 0===n?void 0:n.level)}));return function(e){return t.apply(this,arguments)}}(),e.handleMaxLevel=function(){e.gameData&&(e.initData(),x.openScreen(z.CONGRATULATION_SCREEN,{level:e.gameData.level}),console.info("Max level",e.gameData.level))},e.handleExitGame=o((function*(){try{xU.setStorageData("dashboard","animateToCurrentLevel",!0),xU.setStorageData("collection","animateMapPackUnlock",!0)}catch(e){console.warn("handleExitGame",e)}})),e.handleTileClick=function(t){e.stateManager.playing(),e.board.handleTileClick(t),e.handleHideHint()},e.handleGridMatchSuccess=function(t,n){e.pathDraw.drawMatchPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)})),e.comboManager.addCombo(),e.handleAddScore(),e.effectManager.playClearEffectAt([n[0].node.worldPosition,n[1].node.worldPosition])},e.handleGridMatchFail=function(t){var n;null!==(n=e.guidelinesManager)&&void 0!==n&&n.isShowErrorPathLevel()&&e.pathDraw.drawErrorPath(t,(function(t){var n=t.x,i=t.y;return e.board.getAnyTileWorldPosition(n,i)}))},e.handleGridClear=o((function*(){var t,n,i,a=e.board.getUncleared();(JU&&10===a.length&&!e.isAdPreloadedForCurrentLevel&&(e.isAdPreloadedForCurrentLevel=!0,C.preloadAdsByType(JU.INTERSTITIAL)),0===a.length&&e.node.scene.emit(Js.GAME_FINISH),8===a.length)&&(yield null===(t=e.tournamentManager)||void 0===t?void 0:t.requestLeaderData(),null===(n=e.uiManager)||void 0===n||n.currentLayout.tournamentRail.handleScoreUpdated({score:e.scoreManager.getCurrentScore(),leaderData:null===(i=e.tournamentManager)||void 0===i?void 0:i.leaderData}))})),e.handlePauseTime=function(){e.clockManager.pause(),e.uiManager.pauseTime()},e.handleResumeTime=function(){e.clockManager.resume(),e.uiManager.resumeTime()},e.handleClockTimeout=function(){e.stateManager.fail(Rv)},e.handleHalfTime=function(){void 0!==e.guidelinesManager&&(e.board.getUncleared().length>=e.board.getCleared().length&&e.guidelinesManager.startThunderGuide()||e.board.getBombTiles().length>0&&e.guidelinesManager.startPliersGuide())},e.handleStartRescue=function(){var t,n,i;if(w.turnDownMusic(),F.setBlockInput(!0),e.board.setIgnoreInput(!0),e.rescueTiles.length>0){var a,o=c(e.rescueTiles);try{for(o.s();!(a=o.n()).done;){a.value.restore()}}catch(e){o.e(e)}finally{o.f()}e.rescueTiles=[]}var r=null!==(t=Iv.getMatchMode())&&void 0!==t?t:void 0;null==zU||zU.levelRescue(null!==(n=null===(i=e.gameData)||void 0===i?void 0:i.level)&&void 0!==n?n:1,void 0,r)},e.handleFinishRescue=function(){F.setBlockInput(!1),e.board.setIgnoreInput(!1)},e.handleBombExplode=function(){var t=o((function*(t){e.rescueTiles.push(t),e.board.setIgnoreInput(!0),F.getBlockInput()||(w.playSound(Qi.BOMB_EXPLODE_1),F.setBlockInput(!0));var n=t.node.worldPosition;yield e.effectManager.createBombExplosionAt(new be(n.x,n.y,0)),F.setBlockInput(!1),e.stateManager.isFail()||e.stateManager.fail(_v)}));return function(e){return t.apply(this,arguments)}}(),e.handleShowHint=function(){if(!e.pathDraw.isDrawingHint){var t=e.board.getHintPath();t&&(w.playSound(Qi.HINT_ITEM),e.pathDraw.drawHintPath(t,(function(t){return e.board.getAnyTileWorldPosition(t.x,t.y)})),e.board.showHint(),e.node.scene.emit(Js.REFRESH_ITEMS))}},e.handleGridOrientationChange=function(){e.handleHideHint()},e.handleHideHint=function(){e.pathDraw.isDrawingHint&&(e.pathDraw.clearHintPath(),e.board.hideHint(),e.node.scene.emit(Js.REFRESH_ITEMS))},e.handleAddScore=function(){var t=e.levelManager.getLevelData().level,n=e.comboManager.getCombo(),i=e.clockManager.getRemainingTime();e.scoreManager.addScore(t,n,i)},e.handleUseItem=function(){var t=o((function*(t){switch(e.stateManager.playing(),t!==_.HINT&&e.handleHideHint(),e.itemManager.setQuantity(t,e.itemManager.getQuantity(t)-1),t){case _.HINT:Ab(e.board,e.pathDraw),e.node.scene.emit(Js.REFRESH_ITEMS);break;case _.PLIERS:Tb(e.board,e.effectManager),e.node.scene.emit(Js.REFRESH_ITEMS);break;case _.STORM:e.node.scene.emit(Js.HIDE_UI),e.node.scene.emit(Js.PAUSE_TIME),yield Ub(e.board,e.effectManager),e.node.scene.emit(Js.RESUME_TIME),e.node.scene.emit(Js.SHOW_UI);break;case _.THUNDER:e.node.scene.emit(Js.HIDE_UI),e.node.scene.emit(Js.PAUSE_TIME),yield _b(e.board,e.effectManager),e.board.getUncleared().length>0&&(e.node.scene.emit(Js.RESUME_TIME),e.node.scene.emit(Js.SHOW_UI))}}));return function(e){return t.apply(this,arguments)}}(),e.handleAutoPlay=function(){e.isAutoPlayEnabled?e.disableAutoPlay():e.enableAutoPlay()},e.enableAutoPlay=function(){e.isAutoPlayEnabled=!0,e.schedule(e.autoPlay,.5)},e.disableAutoPlay=function(){e.isAutoPlayEnabled=!1,e.unschedule(e.autoPlay)},e.autoPlay=function(){if(e.stateManager.isReady()||e.stateManager.isPlaying()){var t=e.board.getHintPath();if(!t)throw new Error("No path found");var n=t[0],i=t.slice(-1)[0];if(void 0!==n&&void 0!==i){var a=n.a,o=i.b,r=e.board.getTileAt(a.x,a.y),l=e.board.getTileAt(o.x,o.y);if(!r||!l)throw new Error("Tile is null");r.onClick(),l.onClick()}else{var s=new Error("No path found");if(KU.isDebugger())throw s;null==UU||UU.sendException(s)}}},e.handleAddStars=function(t){var n=MU.getGameData();if(!n)return Promise.resolve([]);MU.setGameData({stars:n.stars+1});var i=t.startAnimationAt;i&&e.effectManager.playStarEffectAt(i)},e.handleChallengeFriends=o((function*(){try{var t,n,i;x.showLoadingScreen();var a=e.board.generateFenFromCurrentLevel(),o=(null!==(t=MU.getGameData())&&void 0!==t?t:{}).level,r=void 0===o?1:o;r=Math.max(1,r);var l=null!==(n=null===(i=e.gameData)||void 0===i?void 0:i.levelData)&&void 0!==n?n:{},s=l.mode,u=void 0===s?"":s,c=l.rules,d=void 0===c?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:c,h=l.time,p=void 0===h?0:h;yield null==BU?void 0:BU.context.choose.processAsync({playerId:MU.getPlayerId(),fallbackSingleMode:!1,extraData:{challengeData:{level:r,fen:a,gravity:u,rules:d,time:p}}}),Iv.getMatchMode()===YU.TOURNAMENT&&(yield e.tryInitTournamentMode()),x.closeLoadingScreen(),e.node.scene.emit(Js.UPDATE_MUSIC),e.node.scene.emit(Js.GAME_RESUME),e.node.scene.emit(Js.GAME_REPLAY,{level:r})}catch(t){var y=t instanceof Error?t:new Error("Unable to invite friends");null==UU||UU.sendException(y),x.closeLoadingScreen(),x.showNotificationScreenWithLocalizedKey("error.tryLater"),e.node.scene.emit(Js.GAME_RESUME),e.node.scene.emit(Js.SHOW_UI)}})),e.handleAddItem=function(){var t=o((function*(t){var n=t.animate,i=t.item,a=t.quantity,o=WU.search(e.uiManager.items,(function(e){return e.itemType===i}));if(void 0!==o){var r=e.itemManager.getQuantity(i)+a;if(e.itemManager.saveQuantity(i,r),e.uiManager.setInteractableItems(!1),n){var l=n.startWorldPosition;yield e.effectManager.playItemAddAnimation(l.x,l.y,o)}e.itemManager.setQuantity(i,r,!0),e.uiManager.setInteractableItems(!0)}else console.warn("Item ".concat(i," not found"))}));return function(e){return t.apply(this,arguments)}}(),e}return e(p,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenCoreEvents(),this.listenInputEvents(),this.listenFlowEvents()}},{key:"onLoad",value:function(){gv.init()}},{key:"onDestroy",value:function(){this.unlistenCoreEvents()}},{key:"initComponents",value:function(){this.initUIManager(),this.initLevelManager(),this.initStateManager(),this.initEffectManager(),this.initItemManager(),this.initCoinManager(),this.initComboManager(),this.initClockManager(),this.initScoreManager(),this.initInputController(),this.initGuidelinesManager(),this.initPathDraw()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(DU),this.uiManager.init(this)}},{key:"initLevelManager",value:function(){this.levelManager=this.getComponent(wf)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(ZD)}},{key:"initInputController",value:function(){this.inputController=this.getComponent(Mv)}},{key:"initEffectManager",value:function(){this.effectManager=this.getComponent(MI)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(vD),this.itemManager.init(this)}},{key:"initCoinManager",value:function(){this.coinManager=this.getComponent(ek)}},{key:"initComboManager",value:function(){this.comboManager=this.getComponent(yk),this.comboManager.init()}},{key:"initClockManager",value:function(){this.clockManager=this.getComponent(aS),this.clockManager.init()}},{key:"initScoreManager",value:function(){this.scoreManager=this.getComponent(mD),this.scoreManager.init()}},{key:"initGuidelinesManager",value:function(){jU.Tutorial.Enabled&&(this.guidelinesManager=this.getComponent(sD),this.guidelinesManager.init(this))}},{key:"initPathDraw",value:function(){this.pathDraw.init(this.board)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenCoreEvents",value:function(){FU.on(qU.OPENING_SCREEN,this.handleOpenScreen),FU.on(qU.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"unlistenCoreEvents",value:function(){FU.off(qU.OPENING_SCREEN,this.handleOpenScreen),FU.off(qU.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"listenInputEvents",value:function(){this.node.scene.on(Js.SHOW_UI,this.handleShowUI),this.node.scene.on(Js.HIDE_UI,this.handleHideUI),this.node.scene.on(Js.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(Js.GAME_RESUME,this.handleResumeGame),this.node.scene.on(Js.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(Js.GAME_FINISH,this.handleFinishGame),this.node.scene.on(Js.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(Js.START_OVER,this.handleStartOver),this.node.scene.on(Js.MAX_LEVEL,this.handleMaxLevel),this.node.scene.on(Js.GAME_EXIT,this.handleExitGame),this.node.scene.on(Js.TILE_CLICK,this.handleTileClick),this.node.scene.on(Js.GRID_MATCH_SUCCESS,this.handleGridMatchSuccess),this.node.scene.on(Js.GRID_MATCH_FAIL,this.handleGridMatchFail),this.node.scene.on(Js.GRID_ORIENTATION_CHANGE,this.handleGridOrientationChange),this.node.scene.on(Js.PAUSE_TIME,this.handlePauseTime),this.node.scene.on(Js.RESUME_TIME,this.handleResumeTime),this.node.scene.on(Js.TIME_OUT,this.handleClockTimeout),this.node.scene.on(Js.HALF_TIME,this.handleHalfTime),this.node.scene.on(Js.RESCUE_START,this.handleStartRescue),this.node.scene.on(Js.RESCUE_FINISHED,this.handleFinishRescue),this.node.scene.on(Js.BOMB_EXPLODE,this.handleBombExplode),this.node.scene.on(Js.SHOW_HINT,this.handleShowHint),this.node.scene.on(Js.ADD_SCORE,this.handleAddScore),this.node.scene.on(Js.GRID_CLEAR,this.handleGridClear),this.node.scene.on(Js.USE_ITEM,this.handleUseItem),this.node.scene.on(Js.ADD_ITEM,this.handleAddItem),this.node.scene.on(Js.AUTO_PLAY,this.handleAutoPlay),this.node.scene.on(Js.ADD_STARS,this.handleAddStars)}},{key:"listenFlowEvents",value:function(){this.node.scene.on(Js.CHALLENGE_FRIENDS,this.handleChallengeFriends)}},{key:"start",value:(d=o((function*(){this.initDataFirstTime(),yield this.tryInitTournamentMode(),this.initGame()})),function(){return d.apply(this,arguments)})},{key:"initDataFirstTime",value:function(){this.initData();var e,t,n=this.getSceneData(),i=(null!=n?n:{}).isFromLoader,a=void 0!==i&&i,o=(null!=n?n:{}).level;void 0===o&&(o=Iv.getMatchMode()===YU.TOURNAMENT?1:null!==(e=null===(t=MU.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:0);this.setGameData({level:o,isFromLoader:a})}},{key:"initData",value:function(){var e,t=this.getSceneData(),n=(null!=t?t:{}).isFromLoader,i=void 0!==n&&n,a=null!==(e=MU.getGameData())&&void 0!==e?e:{},o=a.level,r=void 0===o?1:o,l=a.items;0===r&&i&&l?(l.hint=2,l.thunder=1,l.storm=1,l.pliers=0,MU.setGameData({items:l,coins:500,lastRewardedItems:Date.now()}),this.node.scene.emit(Js.ADD_COINS,{coins:500,playSound:!1})):l&&this.checkItemsRewardable()&&(l.hint<5&&(l.hint+=1),l.thunder<5&&(l.thunder+=1),l.storm<5&&(l.storm+=1),l.pliers<5&&(l.pliers+=1),MU.setGameData({items:l,lastRewardedItems:Date.now()})),this.setGameData(u(u({},eG),{},{level:r}))}},{key:"checkItemsRewardable",value:function(){var e,t=(null!==(e=MU.getGameData())&&void 0!==e?e:{}).lastRewardedItems,n=void 0===t?0:t;return!$U.isToday(n)}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.initialize()}},{key:"tryInitTournamentMode",value:(r=o((function*(){var e,t;if(Iv.getMatchMode()===YU.TOURNAMENT){this.tournamentManager=this.getComponent(fN),yield this.tournamentManager.init();var n=this.tournamentManager,i=n.leaderboardData,a=n.leaderboardName,o=n.tournamentData;if(o){var r=o.payload.themeId;if(this.setGameData({themeId:r}),i&&a){var l=MU.getPlayerId(),s=i.leaders[l];if(!s&&GU){var u=yield GU.getLeadersByPlayerIdsAsync(a,[l]);if(0===u.length)return;s=u[0]}xU.setStorageData("tournament","previousScore",null!==(e=null===(t=s)||void 0===t?void 0:t.score)&&void 0!==e?e:0)}}}})),function(){return r.apply(this,arguments)})},{key:"setGameData",value:function(e){var t,n,i,a=null!==(t=null!==(n=e.level)&&void 0!==n?n:null===(i=this.gameData)||void 0===i?void 0:i.level)&&void 0!==t?t:1;this.gameData=u(u(u({},this.gameData),e),{},{level:a})}},{key:"getGameData",value:function(){return this.gameData}},{key:"getSceneData",value:function(){return G.getSceneData(this.node.scene)}},{key:"attemptCallCreateShortcut",value:function(){var e,t=null!==(e=this.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?0:n,a=t.nextLevelCount;i<2||(void 0===a?0:a)<2||GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)}))}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){GameSDK.isGameSDK("CrazyGames")}}]),p}(te)).prototype,"board",[bU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AU=a(CU.prototype,"opacityToggler",[wU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TU=a(CU.prototype,"pathDraw",[SU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kU=CU));X._RF.pop(),X._RF.push({},"c863f/bTTdAjqEM+Kj9OaKi","DashboardEventButtonTypes",void 0);var tG=function(e){return e[e.STAR_CHEST=0]="STAR_CHEST",e[e.BALLOON=1]="BALLOON",e[e.DAILY_REWARDS=2]="DAILY_REWARDS",e}(tG||{});ue(tG),X._RF.pop(),X._RF.push({},"17fa4eEXEhIfZh+ad9Oqcmw","Leaderboard",void 0);var nG,iG=function(e){return e.WORLD_TAB_SELECTED="world-tab-selected",e.WEEKLY_TAB_SELECTED="weekly-tab-selected",e.OVERLAY_SHOW_STARTED="overlay-show-started",e.OVERLAY_SHOW_COMPLETED="overlay-show-completed",e}(iG||{}),aG="#AE4212",oG="#3D5172",rG="#92200C",lG="#8F5542",sG="#8A4733",uG="#3e7110",cG="#3e7110";X._RF.pop(),X._RF.push({},"4cd93d4ECxKDYSG9apAx603","LevelMission",void 0),X._RF.pop(),X._RF.push({},"2737dY5lxxEY6mKDXeUQJUc","ThemeLocaleKeys",void 0);var dG,hG=(E(nG={},$.SUMMER,"theme.summer"),E(nG,$.AUTUMN,"theme.autumn"),E(nG,$.WINTER,"theme.winter"),E(nG,$.SPRING_FESTIVAL,"theme.springFestival"),E(nG,$.TREE_PLANTING_FESTIVAL,"theme.treePlantingFestival"),E(nG,$.BLUE_SEA_FESTIVAL,"theme.blueSeaFestival"),E(nG,$.MUSIC_FESTIVAL,"theme.musicFestival"),E(nG,$.HARVEST_FESTIVAL,"theme.harvestFestival"),E(nG,$.FOOD_FESTIVAL,"theme.foodFestival"),E(nG,$.SNOW_FESTIVAL,"theme.snowFestival"),E(nG,$.LIGHT_FESTIVAL,"theme.lightFestival"),E(nG,$.PEACE_FESTIVAL,"theme.peaceFestival"),E(nG,$.FLOWER_FESTIVAL,"theme.flowerFestival"),E(nG,$.STREET_FESTIVAL,"theme.streetFestival"),E(nG,$.COLOR_GARDEN,"theme.colorGarden"),E(nG,$.COLOR_FESTIVAL,"theme.colorFestival"),E(nG,$.NATURE_SUMMER,"theme.natureSummer"),E(nG,$.SNOW_MOUNTAIN,"theme.snowMountain"),E(nG,$.ICE_FESTIVAL,"theme.iceFestival"),E(nG,$.GREEN_GRASS_FESTIVAL,"theme.greenGrassFestival"),E(nG,$.COMMUNITY_FESTIVAL,"theme.communityFestival"),E(nG,$.WATER_FESTIVAL,"theme.waterFestival"),E(nG,$.ANIMAL_FESTIVAL,"theme.animalFestival"),E(nG,$.LOST_FESTIVAL,"theme.lostFestival"),E(nG,$.HALLOWEEN_FESTIVAL,"theme.halloweenFestival"),E(nG,$.SNOW_MUSIC_FESTIVAL,"theme.snowMusicFestival"),E(nG,$.CHRISTMAS,"theme.christmas"),E(nG,$.SPRING_FLOWER_FESTIVAL,"theme.springFlowerFestival"),E(nG,$.TET_HOLIDAY,"theme.tetHoliday"),E(nG,$.SEA_FESTIVAL,"theme.seaFestival"),E(nG,$.FIREWORK_FESTIVAL,"theme.fireworkFestival"),E(nG,$.HALLOWEEN_HORROR,"theme.halloweenHorror"),E(nG,$.MID_AUTUMN,"theme.midAutumn"),E(nG,$.CHRISTMAS_SWEET,"theme.christmasSweet"),E(nG,$.NEW_YEAR_COUNTDOWN,"theme.newYearCountdown"),E(nG,$.HAPPY_NEW_YEAR,"theme.happyNewYear"),nG);X._RF.pop(),X._RF.push({},"78297LLtrJKMpOIidCw/BA9","index",void 0),X._RF.pop(),X._RF.push({},"176c3V0yoFEhIdpVcCIhDz7","isEmptyBoard",void 0),X._RF.pop(),X._RF.push({},"5262atLmldNy7Q3MtHgiSRI","HintItem",void 0);var pG;(0,Z.ccclass)("HintItem")(dG=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return _.HINT}}]),r}(dM));X._RF.pop(),X._RF.push({},"3f4c1AB+jdNFqylpogoaiDZ","PliersItem",void 0);var yG;(0,Z.ccclass)("PliersItem")(pG=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return _.PLIERS}}]),r}(dM));X._RF.pop(),X._RF.push({},"d6e51+oy6NCF7cKvf6KOWiu","StormItem",void 0);var vG;(0,Z.ccclass)("StormItem")(yG=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return _.STORM}}]),r}(dM));X._RF.pop(),X._RF.push({},"b30ffJjU2lAH5yu2NkzVVnO","ThunderItem",void 0);var fG,gG,mG,bG,wG,SG,kG;(0,Z.ccclass)("ThunderItem")(vG=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"itemType",get:function(){return _.THUNDER}}]),r}(dM));X._RF.pop(),X._RF.push({},"28c5eNXZLBE+50Dno043fmy","useTornadoThunderCombined",void 0),X._RF.pop(),X._RF.push({},"eb6c23usqxHPaoJcvF0LbY6","separatePositions",void 0),X._RF.pop(),X._RF.push({},"d2a57+mB4NG9rcdh+dy1VPe","traverse4",void 0),X._RF.pop(),X._RF.push({},"ca614iJ+X5LrL1rX/wDQDTD","shuffle",void 0),X._RF.pop(),X._RF.push({},"1cf4cygDSdP5JL+7w3wIJL7","traverseRandom",void 0),X._RF.pop(),X._RF.push({},"1faa9NgJrBE7p8Zs/HBWrZn","pad",void 0),X._RF.pop(),X._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var CG,EG=Z.ccclass,AG=Z.property;fG=EG("RendererModule"),gG=AG(yt),mG=AG(xe),fG((SG=a((wG=e((function e(){t(this,e),l(this,"material",SG,this),l(this,"spriteFrame",kG,this)}))).prototype,"material",[gG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kG=a(wG.prototype,"spriteFrame",[mG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bG=wG));X._RF.pop(),X._RF.push({},"c20acgKcuRFP6+Am/XjOFeP","ParticleSystem2DExtra",void 0);var TG,PG=Z.ccclass,LG=Z.disallowMultiple,OG=Z.executeInEditMode,IG=Z.requireComponent,RG=PG("ParticleSystem2DExtra")(CG=OG(!0)(CG=LG(!0)(CG=IG(Oe)(CG=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var o=i[a];e.updateParticle(o,n)}t(n)}},e}return e(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(Oe),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),r}(te))||CG)||CG)||CG)||CG;X._RF.pop(),X._RF.push({},"664feJL84ZOTaM99dgWY4x0","ExampleParticleSystem2DExtra",void 0);var _G;(0,Z.ccclass)("ExampleParticleSystem2DExtra")(TG=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"initParticle",value:function(e){e.maxSize=Ie.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=Ie.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Ie.randomRange(-350,350),e.y=n+Ie.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(RG));X._RF.pop(),X._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var DG,NG,MG,FG,BG,xG,zG,UG,GG,HG,qG,VG=Z.ccclass,$G=Z.disallowMultiple,WG=Ludex,KG=WG.Events,jG=WG.Utils.Valid,YG=WG.Configs.Core.StartSDKAfterLoadGame,XG=WG.Plugins.Ads,JG=(void 0===XG?{}:XG).Types,ZG=codex,QG=ZG.ads,eH=ZG.player,tH=ZG.event,nH=ZG.context;VG("BootScene")(_G=$G(_G=function(a){n(y,a);var l,s,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=p.call.apply(p,[this].concat(i))).setupLoadingFullScreen=function(){YG?(x.addShowedScene(W.BOOT_SCENE),eH.isFirstSession()?x.addShowedScene(W.GAME_SCENE):x.addShowedScene(W.DASHBOARD_SCENE)):x.showLoadingFullScreen(W.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.setupGameData(),e.sendMsGamesDailyNotification()},e.loadBundles=o((function*(){return Promise.all([r.loadBundle("loadable")])})),e.loadWasmModules=o((function*(){if("SOLO"!==nH.getContextType()||eH.isFirstSession())return Promise.all([K.loadModuleAsync("spine")])})),e.lazyLoadWasmModules=o((function*(){yield Promise.all([K.loadModuleAsync("spine")])})),e.handlePauseAudio=function(){tH.on(KG.VISIBILITY_HIDDEN,e.handleMuteAudio),tH.on(KG.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){w.muteAudio(!0)},e.handleUnMuteAudio=function(){null!=QG&&QG.isAdFullSizeShowing()||w.muteAudio(!1)},e}return e(y,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.preloadAssets(),this.listenEvents()}},{key:"preloadAssets",value:(h=o((function*(){try{se.pause(),yield Promise.all([this.loadWasmModules(),this.loadBundles(),this.loadCurrentPlayerTheme(),this.loadGuideSkin()])}catch(e){console.warn("processPreloadAssets",e)}finally{null!=QG&&QG.isAdFullSizeShowing()||se.resume()}})),function(){return h.apply(this,arguments)})},{key:"onLoad",value:function(){this.handlePauseAudio(),this.overrideGameSDK(),this.setupLoadingFullScreen()}},{key:"start",value:(d=o((function*(){yield GameSDK.extra.waitSDKInitiatedAsync(),this.processCrazyGamesLoadingStop(),this.disableBannerAdsOnStartingLevels()})),function(){return d.apply(this,arguments)})},{key:"listenEvents",value:function(){tH.catchUp(KG.GAME_READY,this.lazyLoadWasmModules),tH.catchUp(KG.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"overrideGameSDK",value:function(){if("FBInstant"in window&&"shareAsync"in FBInstant){var e=FBInstant.shareAsync;FBInstant.shareAsync=function(){var t=o((function*(t){var n=u({},t);return e(n)}));return function(e){return t.apply(this,arguments)}}()}}},{key:"setupGameData",value:function(){var e=eH.getGameData();if(e){var t=e.totalLevel,n=Math.max(t,N),i=u(u({},e),{},{totalLevel:n});eH.setGameData(i)}}},{key:"disableBannerAdsOnStartingLevels",value:function(){if(JG){var e=eH.getGameData();if(e){var t=e.level,n=void 0!==t&&t>H.NUM_LEVEL_WITHOUT_BANNER_ADS;C.setAdEnable(JG.BANNER,n)}}}},{key:"loadCurrentPlayerTheme",value:(s=o((function*(){var e=dv.mapOrder,t=e[0];if(jG.isObject(t)){var n=eH.getGameData(),i=null==n?void 0:n.level;if(!jG.isNumber(i))return r.loadThemeAsync(t.theme);var a,o=c(e);try{for(o.s();!(a=o.n()).done;){var l=a.value;if((i-=l.levelCount)<=0){t=l;break}}}catch(e){o.e(e)}finally{o.f()}return r.loadThemeAsync(t.theme)}})),function(){return s.apply(this,arguments)})},{key:"loadGuideSkin",value:(l=o((function*(){if(eH.isFirstSession())return gv.loadLevelSpriteFrames(0)})),function(){return l.apply(this,arguments)})},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}}]),y}(te))||_G);X._RF.pop(),X._RF.push({},"29f874DL75LO5NzzNYZvHDh","RigidBodyObject",void 0);var iH,aH,oH,rH,lH,sH,uH,cH,dH,hH,pH,yH,vH=Z.ccclass,fH=Z.property;DG=vH("RigidBodyObject"),NG=fH(ae),MG=fH(De),FG=fH(ae),BG=fH(Se),DG((UG=a((zG=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"gravityScale",UG,s(e)),l(e,"linearVelocity",GG,s(e)),l(e,"bounce",HG,s(e)),l(e,"simulate",qG,s(e)),e}return e(r,[{key:"onLoad",value:function(){this.canvas=this.node.scene.getComponentInChildren(vt).getComponent(ne),this.uiTransform=this.node.getComponent(ne)}},{key:"update",value:function(e){if(this.simulate){this.applyGravity();var t=this.node.worldPosition.clone();t.add(new be(this.linearVelocity.x*e,this.linearVelocity.y*e,0)),t=this.applyBounce(t),this.node.setWorldPosition(t)}}},{key:"applyForce",value:function(e){this.linearVelocity.add(e)}},{key:"applyGravity",value:function(){var e=new De(0,-9.8*this.gravityScale);this.applyForce(e)}},{key:"applyBounce",value:function(e){var t=this.uiTransform.getBoundingBoxToWorld();t.yMin<0&&(e.y=t.height/2,this.linearVelocity.y*=-this.bounce),t.xMin<0&&(e.x=t.width/2,this.linearVelocity.x*=-1);var n=this.canvas.width;return t.xMax>n&&(e.x=n-t.width/2,this.linearVelocity.x*=-1),e}}]),r}(te)).prototype,"gravityScale",[NG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),GG=a(zG.prototype,"linearVelocity",[MG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new De(0,0)}}),HG=a(zG.prototype,"bounce",[FG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qG=a(zG.prototype,"simulate",[BG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xG=zG));X._RF.pop(),X._RF.push({},"93d88BQCU5B0L/TmaCaYNfm","AnimSkipOverlay",void 0);var gH,mH,bH,wH,SH,kH,CH,EH,AH,TH=Z.ccclass,PH=Z.property,LH=Z.disallowMultiple,OH=function(){},IH=(iH=TH("AnimSkipOverlay"),aH=PH(de),oH=PH(de),rH=PH(fe),lH=Yn.onlyRunInLifeCycleAsync,sH=Yn.onlyRunInLifeCycleAsync,uH=Yn.onlyRunInLifeCycleAsync,iH(cH=LH((hH=a((dH=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"containerUIOpacity",hH,s(e)),l(e,"maskUIOpacity",pH,s(e)),l(e,"skipButton",yH,s(e)),e.isOpened=!1,e.currentCallback=OH,e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.containerUIOpacity.node.active=!1,this.skipButton.interactable=!1}},{key:"onSkipButtonPress",value:function(){this.currentCallback(),this.close()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"open",value:(u=o((function*(e){this.containerUIOpacity.node.active=!0;var t=e.onSkip,n=e.opacity,i=void 0===n?255:n,a=e.transitionDuration,o=void 0===a?.2:a;this.maskUIOpacity.opacity=i,yield this.animateUIOpacity(0,255,o),this.currentCallback=t,this.skipButton.interactable=!0,this.isOpened=!0,this.node.scene.emit(y.OPENED_SKIP_OVERLAY,e)})),function(e){return u.apply(this,arguments)})},{key:"close",value:(r=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;this.skipButton.interactable=!1,this.currentCallback=OH,yield this.animateUIOpacity(255,0,e),this.maskUIOpacity.opacity=0,this.containerUIOpacity.node.active=!1,this.isOpened=!1,this.node.scene.emit(y.CLOSED_SKIP_OVERLAY)})),function(){return r.apply(this,arguments)})},{key:"animateUIOpacity",value:function(e,t,n){return this.containerUIOpacity.opacity=e,p.runTweenAsync(re(this.containerUIOpacity).to(n,{opacity:t}))}},{key:"untilClosed",value:function(){var e=this;return!1===this.isOpened?Promise.resolve():new Promise((function(t){e.node.scene.once(y.CLOSED_SKIP_OVERLAY,t)}))}}]),d}(te)).prototype,"containerUIOpacity",[aH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pH=a(dH.prototype,"maskUIOpacity",[oH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yH=a(dH.prototype,"skipButton",[rH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(dH.prototype,"open",[lH],Object.getOwnPropertyDescriptor(dH.prototype,"open"),dH.prototype),a(dH.prototype,"close",[sH],Object.getOwnPropertyDescriptor(dH.prototype,"close"),dH.prototype),a(dH.prototype,"untilClosed",[uH],Object.getOwnPropertyDescriptor(dH.prototype,"untilClosed"),dH.prototype),cH=dH))||cH)||cH);X._RF.pop(),X._RF.push({},"95ba56f1qVFfLLdPv++OfLw","SmoothScrollView",void 0);var RH,_H=Z.ccclass,DH=Z.property,NH=(gH=_H("SmoothScrollView"),mH=DH({type:Se,group:"Mouse Scroll"}),bH=DH({type:ae,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),wH=DH({type:ae,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),gH((CH=a((kH=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"mouseScroll",CH,s(e)),l(e,"mouseScrollSpeed",EH,s(e)),l(e,"mouseScrollDuration",AH,s(e)),e}return e(r,[{key:"_onMouseWheel",value:function(e,t){if(this.mouseScroll){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(e,t)){var n=new be,i=e.getScrollY()<0?1:-1;this.vertical?n.set(0,i*this.mouseScrollSpeed,0):this.horizontal&&n.set(i*this.mouseScrollSpeed,0,0),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._startAutoScroll(n,this.mouseScrollDuration,!0),this._stopPropagationIfTargetIsMe(e)}}else d(h(r.prototype),"_onMouseWheel",this).call(this,e,t)}}]),r}(ft)).prototype,"mouseScroll",[mH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EH=a(kH.prototype,"mouseScrollSpeed",[bH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),AH=a(kH.prototype,"mouseScrollDuration",[wH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),SH=kH))||SH);X._RF.pop(),X._RF.push({},"904917NfYBJy781QxKjEPIO","ViewNode",void 0);var MH,FH,BH,xH,zH,UH,GH,HH,qH,VH,$H,WH,KH,jH,YH,XH,JH,ZH,QH,eq,tq,nq,iq,aq,oq,rq,lq,sq,uq,cq=Z.ccclass,dq=Z.requireComponent,hq=cq("ViewNode")(RH=dq(de)(RH=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).order=0,e}return e(r,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"setVisible",value:function(e){this.uiOpacity.opacity=e?255:0}},{key:"isVisible",value:function(){return this.uiOpacity.opacity>0}}]),r}(te))||RH)||RH;X._RF.pop(),X._RF.push({},"0b250nSw/RHRq8vKigzgfhs","ScrollViewLayout",void 0);var pq,yq=Z.ccclass,vq=Z.property,fq=Z.requireComponent,gq=Ludex.Utils,mq=gq.Array,bq=gq.Signal,wq=(MH=yq("ScrollViewLayout"),FH=fq(NH),BH=Yn.required(),xH=vq(ne),zH=vq(ae),UH=vq($e),GH=vq(ie),HH=Yn.required(),qH=vq(ie),VH=Yn.required(),$H=Yn.required(),WH=Yn.required(),KH=Yn.onlyRunInLifeCycleAsync,jH=Yn.onlyRunInLifeCycleAsync,YH=Yn.onlyRunInLifeCycleAsync,XH=Yn.onlyRunInLifeCycle,JH=Yn.onlyRunInLifeCycle,ZH=Yn.onlyRunInLifeCycle,QH=Yn.onlyRunInLifeCycle,MH(eq=FH((nq=a((tq=function(a){n(f,a);var r,u,d,h,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"viewport",nq,s(e)),l(e,"spacing",iq,s(e)),l(e,"nodePrefab",aq,s(e)),l(e,"maxNodeCount",oq,s(e)),l(e,"extendCount",rq,s(e)),l(e,"scrollView",lq,s(e)),l(e,"uiTransform",sq,s(e)),l(e,"contentUiTransform",uq,s(e)),e.nodePool=[],e.nodeHeight=0,e.scrollSignalController=new bq.SignalController,e.onNodeVisible=function(){},e.onNodeInvisible=function(){},e}return e(f,[{key:"__preload",value:function(){var e;this.scrollView=this.getComponent(NH),this.uiTransform=this.getComponent(ne),this.contentUiTransform=null===(e=this.scrollView.content)||void 0===e?void 0:e.getComponent(ne)}},{key:"onDestroy",value:function(){se.off(y.VIEW_RESIZED,this.handleViewResized,this)}},{key:"start",value:function(){var e=qe(this.nodePrefab);this.nodeHeight=e.getComponent(ne).height,e.destroy(),Yn.validateRequiredProperties(this,f)}},{key:"init",value:function(e,t){this.createNodePool(),this.onNodeVisible=null!=e?e:this.onNodeVisible,this.onNodeInvisible=null!=t?t:this.onNodeInvisible;for(var n=0;n<this.nodePool.length;n++){var i;null===(i=this.nodePool[n])||void 0===i||i.setVisible(!1)}this.updateVisibility()}},{key:"updateNodeVisibility",value:function(){for(var e=0;e<this.nodePool.length;e++){var t=this.nodePool[e];t&&(t.isVisible()?this.onNodeVisible(t):this.onNodeInvisible(t))}}},{key:"listenEvents",value:function(){this.scrollView.node.on(ft.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.on(pt.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.on(pt.MOUSE_WHEEL,this.abortScrollSignal,this),se.on(y.VIEW_RESIZED,this.handleViewResized,this)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(ft.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.off(pt.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.off(pt.MOUSE_WHEEL,this.abortScrollSignal,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this)}},{key:"scrollToOrder",value:(h=o((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=this.getNodeScrollOffset(e),a=this.scrollView.getScrollOffset().y,o=(i=Math.max(i,0))-(a=Math.max(a,0));Math.abs(o)<5||(yield this.scrollToOffset(new De(0,i),n,t))})),function(e,t){return h.apply(this,arguments)})},{key:"scrollToTop",value:(d=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;yield this.scrollToOffset(new De(0,0),t,e)})),function(e){return d.apply(this,arguments)})},{key:"scrollToOffset",value:(u=o((function*(e,t,n){var i=this,a=this.scrollSignalController.renew();this.scrollView.scrollToOffset(e,t);var o=function(){return i.handleScrollSignalAborted()},r=function(){a.aborted||i.handleExternalSignalAborted(e)};a.once(o),n.addAbortListener(r),yield p.waitTweenAsync(t,n),a.off(o),n.removeAbortListener(r)})),function(e,t,n){return u.apply(this,arguments)})},{key:"updateVisibility",value:function(){for(var e=this.viewport.getBoundingBoxToWorld(),t=e.yMax,n=e.yMin,i=0;i<this.maxNodeCount;i++){var a=this.getNodeBoundingBoxWorld(i),o=a.top,r=a.bot;if(o<n||r>t){var l=this.getNodeByOrder(i);l&&(this.onNodeInvisible(l),l.setVisible(!1))}else{var s=this.getNodeByOrder(i);if(s)s.isVisible()||(s.order=i,this.onNodeVisible(s),s.setVisible(!0));else{var u=this.getInvisibleNode();u&&(u.node.setPosition(this.getNodePosition(i)),u.order=i,this.onNodeVisible(u),u.setVisible(!0))}}}}},{key:"updateLayout",value:function(){var e,t=this.getVisibleNodes(),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.node.setPosition(this.getNodePosition(i.order))}}catch(e){n.e(e)}finally{n.f()}}},{key:"setMaxNodeCount",value:function(e){this.maxNodeCount=e,this.contentUiTransform.height=(this.nodeHeight+this.spacing)*this.maxNodeCount}},{key:"getAllNodes",value:function(){return this.nodePool}},{key:"getVisibleNodes",value:function(){return this.nodePool.filter((function(e){return e.isVisible()}))}},{key:"getNodePosition",value:function(e){return new be(0,-(this.nodeHeight+this.spacing)*e-this.nodeHeight/2,0)}},{key:"getNodeScrollOffset",value:function(e){return-this.getNodePosition(e).y-this.uiTransform.node.worldPosition.y-this.uiTransform.height/2+this.viewport.node.worldPosition.y}},{key:"getNodeByOrder",value:function(e){return mq.search(this.nodePool,(function(t){return t.order===e}))}},{key:"getInvisibleNode",value:function(){return mq.search(this.nodePool,(function(e){return!e.isVisible()}))}},{key:"createNodePool",value:function(){var e=Math.ceil(this.viewport.height/this.nodeHeight)+1+this.extendCount;if(!(this.nodePool.length>=e)){var t=e-this.nodePool.length;this.setMaxNodeCount(this.maxNodeCount);for(var n=0;n<t;n++){var i,a=qe(this.nodePrefab);null===(i=this.scrollView.content)||void 0===i||i.addChild(a),a.setPosition(this.getNodePosition(this.nodePool.length));var o=a.addComponent(hq);o.order=this.nodePool.length,o.setVisible(!1),this.nodePool.push(o)}}}},{key:"getNodeBoundingBoxWorld",value:function(e){var t,n,i=this.getNodePosition(e).y+(null!==(t=null===(n=this.scrollView.content)||void 0===n?void 0:n.worldPosition.y)&&void 0!==t?t:0);return{top:i+this.nodeHeight/2,bot:i-this.nodeHeight/2}}},{key:"abortScrollSignal",value:function(){this.scrollSignalController.abort()}},{key:"handleScrollSignalAborted",value:function(){this.scrollView.stopAutoScroll(),this.updateVisibility()}},{key:"handleExternalSignalAborted",value:function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToOffset(e,0),this.updateVisibility()}},{key:"handleViewResized",value:(r=o((function*(){yield p.waitTweenAsync(0),this.createNodePool(),this.updateVisibility()})),function(){return r.apply(this,arguments)})}]),f}(te)).prototype,"viewport",[BH,xH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iq=a(tq.prototype,"spacing",[zH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),aq=a(tq.prototype,"nodePrefab",[UH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oq=a(tq.prototype,"maxNodeCount",[GH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),rq=a(tq.prototype,"extendCount",[HH,qH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lq=a(tq.prototype,"scrollView",[VH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sq=a(tq.prototype,"uiTransform",[$H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uq=a(tq.prototype,"contentUiTransform",[WH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(tq.prototype,"scrollToOrder",[KH],Object.getOwnPropertyDescriptor(tq.prototype,"scrollToOrder"),tq.prototype),a(tq.prototype,"scrollToTop",[jH],Object.getOwnPropertyDescriptor(tq.prototype,"scrollToTop"),tq.prototype),a(tq.prototype,"scrollToOffset",[YH],Object.getOwnPropertyDescriptor(tq.prototype,"scrollToOffset"),tq.prototype),a(tq.prototype,"updateVisibility",[XH],Object.getOwnPropertyDescriptor(tq.prototype,"updateVisibility"),tq.prototype),a(tq.prototype,"createNodePool",[JH],Object.getOwnPropertyDescriptor(tq.prototype,"createNodePool"),tq.prototype),a(tq.prototype,"handleScrollSignalAborted",[ZH],Object.getOwnPropertyDescriptor(tq.prototype,"handleScrollSignalAborted"),tq.prototype),a(tq.prototype,"handleExternalSignalAborted",[QH],Object.getOwnPropertyDescriptor(tq.prototype,"handleExternalSignalAborted"),tq.prototype),eq=tq))||eq)||eq);X._RF.pop(),X._RF.push({},"a3bd3opU7JJh4TqZ3uorJHi","DailyRewardsUtils",void 0);var Sq=codex,kq=Sq.player,Cq=Sq.storage,Eq=Sq.dailyRewards,Aq=Ludex,Tq=Aq.Utils.Array,Pq=Aq.Configs.DailyRewards,Lq=Pq.MockTime,Oq=Pq.MaxDays,Iq=Pq.CheckInterrupt,Rq=Lq>0?Lq:864e5,_q=function(){function n(){t(this,n)}var i,a,r,l;return e(n,null,[{key:"logLoginReward",value:function(){Eq.logLoginReward(),this.setDirty$(),this.tryUpdateData()}},{key:"tryUpdateData",value:(l=o((function*(){if(this.shouldUpdateData$()){this.lastUpdate=Date.now(),yield Eq.requestDailyRewardsAsync();var e=this.getCurrentRemainingTime$();this.updateInterval=e/2}})),function(){return l.apply(this,arguments)})},{key:"hasClaimableRewards",value:(r=o((function*(){yield this.tryUpdateData();var e=Eq.getDailyRewards();return null!==e&&void 0!==Tq.search(Object.values(e),(function(e){return"ready"===e.status}))})),function(){return r.apply(this,arguments)})},{key:"getRewardsData",value:(a=o((function*(){yield this.tryUpdateData();var e=Eq.getDailyRewards();if(null===e)return null;for(var t=[],n=0;n<Oq;n++){var i=Jy[n];if(i){var a=e[n+1];t.push(u(u({id:i.id,type:i.type,status:i.status},a),{},{value:i.value,items:i.items?u({},i.items):void 0}))}}return t})),function(){return a.apply(this,arguments)})},{key:"getRemainingTime",value:(i=o((function*(){return yield this.tryUpdateData(),this.getCurrentRemainingTime$()})),function(){return i.apply(this,arguments)})}]),n}();pq=_q,_q.lastUpdate=0,_q.updateInterval=0,_q.setDirty$=function(){pq.lastUpdate=0},_q.getCurrentRemainingTime$=function(){var e;if(null===Eq.getDailyRewards())return 0;var t=null!==(e=kq.getPlayerData().dailyRewardedData)&&void 0!==e?e:{},n=t.firstReward,i=void 0===n?0:n,a=t.lastReward,o=void 0===a?0:a;if(Iq){var r=pq.findLastRewardedIndex$();if(-1===r)return 0;var l=i+(r+1)*Rq;return Math.max(l-Date.now(),0)}var s=o+Rq;return Math.max(s-Date.now(),0)},_q.findLastRewardedIndex$=function(){for(var e,t=(null!==(e=kq.getPlayerData().dailyRewardedData)&&void 0!==e?e:{}).logDays,n=void 0===t?[]:t,i=n.length-1;i>=0;i--)if(n[i])return i;return-1},_q.shouldUpdateData$=function(){return Date.now()-pq.lastUpdate>pq.updateInterval};var Dq,Nq,Mq,Fq,Bq,xq,zq,Uq,Gq,Hq,qq,Vq,$q,Wq,Kq,jq,Yq,Xq=function(a){n(u,a);var r,l,s=i(u);function u(){return t(this,u),s.apply(this,arguments)}return e(u,null,[{key:"hasShownPopup",value:function(){return Cq.getStorage("dashboardDailyRewards").hasShownPopup}},{key:"setHasShownPopup",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Cq.setStorageData("dashboardDailyRewards","hasShownPopup",e)}},{key:"openPopupScreen",value:(l=o((function*(){yield x.openScreen(z.DAILY_REWARDS_SCREEN)})),function(){return l.apply(this,arguments)})},{key:"openPopupScreenAndWaitForClose",value:(r=o((function*(){yield x.openScreenAndWaitForClose(z.DAILY_REWARDS_SCREEN)})),function(){return r.apply(this,arguments)})}]),u}(_q);X._RF.pop(),X._RF.push({},"e62f9TdkTxOyJy6vcnplnCB","LockAnimator",void 0);var Jq,Zq,Qq,eV,tV,nV,iV,aV,oV,rV,lV,sV=Z.ccclass,uV=Z.disallowMultiple,cV=Z.property,dV=[50,160],hV=(Dq=sV("LockAnimator"),Nq=cV(Oe),Mq=cV(ze),Fq=cV(Ue),Bq=cV(Ue),xq=cV(Ue),zq=cV(ny),Uq=cV({type:ie,min:0}),Dq(Gq=uV((qq=a((Hq=function(a){n(v,a);var r,u,c,d,h,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"floatingParticles",qq,s(e)),l(e,"iconAnimation",Vq,s(e)),l(e,"lockClip",$q,s(e)),l(e,"unlockClip",Wq,s(e)),l(e,"tryToUnlockClip",Kq,s(e)),l(e,"trailTemplate",jq,s(e)),l(e,"trailCount",Yq,s(e)),e.trails=[],e}return e(v,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.prepareTrails(),this.floatingParticles.node.active=!1}},{key:"unlock",value:(h=o((function*(e){var t=this;this.floatingParticles.node.active=!0,this.floatingParticles.resetSystem(),this.scheduleOnce((function(){t.explodeTrails(e)}),1.1),yield this.playAnimation(this.unlockClip.name,e),this.floatingParticles.stopSystem()})),function(e){return h.apply(this,arguments)})},{key:"lock",value:function(){this.playAnimation(this.lockClip.name),this.floatingParticles.node.active&&this.floatingParticles.stopSystem()}},{key:"explodeTrails",value:(d=o((function*(e){var t=this;yield Promise.all(this.trails.map((function(n){return t.getExplodeTrail(n,0,e)})))})),function(e){return d.apply(this,arguments)})},{key:"getExplodeTrail",value:(c=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=Ge(0,2*Math.PI),a=Ge(dV[0],dV[1])*Math.cos(i),o=Ge(dV[0],dV[1])*Math.sin(i),r=new be(a,o,e.node.position.z),l=e.node.scale.clone(),s=re(e.node).delay(t).call((function(){e.node.setPosition(0,0),e.reset(),e.node.active=!0})).to(.5,{position:r.clone()},{easing:"expoOut"}).to(.5,{scale:new be(0,0,1)},{easing:"expoIn"});yield p.runTweenAsync(s,n),e.node.setPosition(0,0),e.node.scale=l,e.reset(),e.node.active=!1})),function(e){return c.apply(this,arguments)})},{key:"prepareTrails",value:function(){this.trailTemplate.node.active=!1;for(var e=0;e<this.trailCount;e++){var t=qe(this.trailTemplate.node);t.setParent(this.node),t.active=!1,this.trails.push(t.getComponent(ny))}}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"playAnimation",value:(u=o((function*(e,t){var n=this;return null!=t&&t.aborted?Promise.resolve():new Promise((function(i){n.iconAnimation.once(ze.EventType.FINISHED,(function(){i()})),null==t||t.addAbortListener((function(){n.iconAnimation.off(ze.EventType.FINISHED),n.iconAnimation.stop(),i()})),n.iconAnimation.play(e)}))})),function(e,t){return u.apply(this,arguments)})},{key:"playTryToUnlockAnimation",value:(r=o((function*(){return this.playAnimation(this.tryToUnlockClip.name)})),function(){return r.apply(this,arguments)})}]),v}(te)).prototype,"floatingParticles",[Nq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vq=a(Hq.prototype,"iconAnimation",[Mq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$q=a(Hq.prototype,"lockClip",[Fq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wq=a(Hq.prototype,"unlockClip",[Bq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kq=a(Hq.prototype,"tryToUnlockClip",[xq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jq=a(Hq.prototype,"trailTemplate",[zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yq=a(Hq.prototype,"trailCount",[Uq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Gq=Hq))||Gq)||Gq);X._RF.pop(),X._RF.push({},"18bbbp5z2VHVKp4jjjmsAhu","ThemeProgressBar",void 0);var pV,yV,vV,fV,gV,mV,bV,wV,SV,kV,CV,EV,AV,TV,PV,LV,OV,IV,RV,_V,DV,NV,MV,FV,BV,xV,zV,UV,GV,HV,qV,VV,$V,WV,KV,jV,YV,XV,JV=Z.ccclass,ZV=Z.property,QV=(Jq=JV("ThemeProgressBar"),Zq=ZV(me),Qq=ZV(me),eV=ZV(me),tV=ZV(me),Jq((aV=a((iV=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"progressBar",aV,s(e)),l(e,"progressText",oV,s(e)),l(e,"leftCap",rV,s(e)),l(e,"rightCap",lV,s(e)),e}return e(r,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("ThemeProgressBar: progressBar not found");if(!this.progressText)throw new Error("ThemeProgressBar: progressText not found");if(!this.leftCap)throw new Error("ThemeProgressBar: leftCap not found");if(!this.rightCap)throw new Error("ThemeProgressBar: rightCap not found")}},{key:"setProgress",value:function(e,t){e<=0?(this.leftCap.active=!1,this.rightCap.active=!1):(this.leftCap.active=!0,this.rightCap.active=!0);var n=this.progressBar.getComponent(_e);if(!n)throw new Error("ThemeProgressBar: progressBarComponent not found");n.progress=e/t;var i=this.progressText.getComponent(ke);if(!i)throw new Error("ThemeProgressBar: progressTextComponent not found");i.string="".concat(e,"/").concat(t)}}]),r}(te)).prototype,"progressBar",[Zq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oV=a(iV.prototype,"progressText",[Qq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rV=a(iV.prototype,"leftCap",[eV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lV=a(iV.prototype,"rightCap",[tV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nV=iV))||nV);X._RF.pop(),X._RF.push({},"aef0d6qo8hNUJ7qNl2wuT29","ThemeBlock",void 0);var e$,t$,n$,i$,a$,o$,r$,l$,s$,u$,c$,d$,h$,p$=Z.ccclass,y$=Z.property,v$={progress:0,max:10,isLocked:!0,theme:$.SUMMER,skins:[Yv.FRUIT]},f$=Ludex.Utils.Array,g$=(pV=p$("ThemeBlock"),yV=Yn.required(),vV=y$(me),fV=Yn.required(),gV=y$(me),mV=Yn.required(),bV=y$(hV),wV=Yn.required(),SV=y$({type:me,group:"Container"}),kV=Yn.required(),CV=y$({type:de,group:"Container"}),EV=Yn.required(),AV=y$({type:me,group:"Theme"}),TV=Yn.required(),PV=y$({type:he,group:"Theme"}),LV=Yn.required(),OV=y$({type:Lh,group:"Title"}),IV=Yn.required(),RV=y$({type:de,group:"Title"}),_V=Yn.required(),DV=y$({type:he,group:"Tile"}),NV=Yn.required(),MV=y$({type:de,group:"Tile"}),FV=y$(Se),BV=Yn.onlyRunInLifeCycleAsync,pV((UV=a((zV=function(a){n(f,a);var c,d,h,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"mask",UV,s(e)),l(e,"progressBar",GV,s(e)),l(e,"lockAnimator",HV,s(e)),l(e,"container",qV,s(e)),l(e,"containerOpacity",VV,s(e)),l(e,"themeLoadingRing",$V,s(e)),l(e,"themeSprite",WV,s(e)),l(e,"titleLocalizer",KV,s(e)),l(e,"titleOpacity",jV,s(e)),l(e,"tileBlockIconSprite",YV,s(e)),l(e,"newTilesOpacity",XV,s(e)),e.signal=new Mi,e.payload=v$,e}return e(f,[{key:"isLocked",get:function(){return this.payload.isLocked},set:function(e){this.payload.isLocked=e,this.updateInfo()}},{key:"__preload",value:function(){this.maskUIOpacity=this.mask.getComponent(de),Yn.validateRequiredProperties(this,f)}},{key:"updateInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v$;this.payload=e;var t=e.progress,n=e.max,i=e.isLocked,a=e.theme,o=e.skins;this.signal.abort();var r=new Mi;this.signal=r,this.updateTitle(a),this.updateSkinAsync(o,r),this.updateThemeAsync(a,r);var l=this.progressBar.getComponent(QV);if(!l)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=i,this.progressBar.active=!i,this.lockAnimator.node.active=i,i&&this.lockAnimator.lock(),this.maskUIOpacity.opacity=i?128:0,i||l.setProgress(t,n)}},{key:"playUnlockAnim",value:(y=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v$;this.payload=u(u({},t),{},{isLocked:!1});var n=t.progress,i=t.max,a=this.progressBar.getComponent(QV);if(!a)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=!0,this.progressBar.active=!1,this.lockAnimator.node.active=!0,a.setProgress(n,i),yield this.animateUnlockedState(e)})),function(e){return y.apply(this,arguments)})},{key:"updateTitle",value:function(e){var t=hG[e];this.titleLocalizer.key=t}},{key:"updateSkinAsync",value:(h=o((function*(e,t){var n=this.tileBlockIconSprite.length,i=e.length,a=e.map(function(){var e=o((function*(e){return yield r.loadSkinPreviewAsync(e)}));return function(t){return e.apply(this,arguments)}}()),l=yield Promise.all(a);if(!t.aborted&&this.tileBlockIconSprite)if(i<=n){for(var s=Math.floor(n/i),u=n%i,c=A(f$.fillWith(i,(function(){return s}))),d=0;d<u;d++){var h=c[d];c[d]=h+1}for(var p=0,y=0;y<i;y++)for(var v=c[y],f=0;f<v&&p<n;f++,p++){var g=l[y][f];this.tileBlockIconSprite[p].spriteFrame=g}}else for(var m=0,b=this.tileBlockIconSprite.length;m<b;m++){var w=this.tileBlockIconSprite[m],S=l[m%i][0];w.spriteFrame=S}})),function(e,t){return h.apply(this,arguments)})},{key:"updateThemeAsync",value:(d=o((function*(e,t){this.themeSprite.spriteFrame=null;var n=r.getAsset("".concat(j[e],"/spriteFrame"),xe);if(!n){if(this.themeLoadingRing.active=!0,yield p.waitTweenAsync(.1,t),t.aborted)return;n=yield r.loadThemePreviewAsync(e)}n||(n=yield r.loadThemePreviewAsync($.SUMMER)),this.themeSprite&&n&&!t.aborted&&(this.themeSprite.spriteFrame=n,this.themeLoadingRing.active=!1)})),function(e,t){return d.apply(this,arguments)})},{key:"animateUnlockedState",value:(c=o((function*(e){var t,n=this.progressBar.getComponent(de);if(!n)throw new Error("ThemeBlock: progressBarUIOpacity not found");this.mask.active=!0,this.maskUIOpacity.opacity=null!==(t=this.maskUIOpacity.opacity)&&void 0!==t?t:255,this.progressBar.active=!0,n.opacity=0,yield this.lockAnimator.unlock(e),this.lockAnimator.node.active=!1,yield Promise.all([p.runTweenAsync(re(this.maskUIOpacity).to(.25,{opacity:0}),e),p.runTweenAsync(re(n).to(.25,{opacity:255}),e)]),this.mask.active=!1,this.maskUIOpacity.opacity=0,n.opacity=255})),function(e){return c.apply(this,arguments)})},{key:"setVisible",value:function(e){this.containerOpacity.opacity=e?255:0,this.titleOpacity.opacity=e?255:0,this.newTilesOpacity.opacity=e?255:0}}]),f}(te)).prototype,"mask",[yV,vV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GV=a(zV.prototype,"progressBar",[fV,gV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HV=a(zV.prototype,"lockAnimator",[mV,bV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qV=a(zV.prototype,"container",[wV,SV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VV=a(zV.prototype,"containerOpacity",[kV,CV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$V=a(zV.prototype,"themeLoadingRing",[EV,AV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WV=a(zV.prototype,"themeSprite",[TV,PV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KV=a(zV.prototype,"titleLocalizer",[LV,OV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jV=a(zV.prototype,"titleOpacity",[IV,RV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YV=a(zV.prototype,"tileBlockIconSprite",[_V,DV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),XV=a(zV.prototype,"newTilesOpacity",[NV,MV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(zV.prototype,"isLocked",[FV],Object.getOwnPropertyDescriptor(zV.prototype,"isLocked"),zV.prototype),a(zV.prototype,"updateSkinAsync",[BV],Object.getOwnPropertyDescriptor(zV.prototype,"updateSkinAsync"),zV.prototype),xV=zV))||xV);X._RF.pop(),X._RF.push({},"b3a4dy5XgpIT6stybzgYjnu","CollectionsContent",void 0);var m$,b$,w$,S$,k$,C$,E$,A$,T$,P$,L$,O$,I$,R$,_$=Z.ccclass,D$=Z.property,N$=codex.storage,M$=(e$=_$("CollectionsContent"),t$=D$(ku),n$=D$(wq),i$=D$(qr),a$=D$({type:ae,displayName:"Offset from top of scroll view",tooltip:"The offset between the first theme tab and the top of the scroll view"}),o$=Yn.onlyRunInLifeCycleAsync,r$=Yn.onlyRunInLifeCycleAsync,e$((u$=a((s$=function(a){n(h,a);var r,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=d.call.apply(d,[this].concat(i))).animateThemeBlockUnlockIndex=null,l(e,"panelAnimator",u$,s(e)),l(e,"themeScrollView",c$,s(e)),l(e,"contentOpacity",d$,s(e)),e.themeScrollViewInited=!1,e.payloads=[],e.preservedScrollPosition=new De,l(e,"offsetFromTopOfScrollView",h$,s(e)),e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"listenEvents",value:function(){this.node.scene.on(Js.HIDE_UI,this.hideContent),this.node.scene.on(Js.SHOW_UI,this.showContent),this.themeScrollView.listenEvents()}},{key:"unlistenEvents",value:function(){this.unlistenUIEvents(),this.themeScrollView.unlistenEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Js.HIDE_UI,this.hideContent),this.node.scene.off(Js.SHOW_UI,this.showContent)}},{key:"init",value:function(e){var t=this;this.payloads=e,this.themeScrollViewInited||(this.themeScrollViewInited=!0,this.themeScrollView.init((function(e){var n,i=t.animateThemeBlockUnlockIndex===e.order,a=t.payloads[e.order],o=e.getComponent(g$);a&&(o.updateInfo(u(u({},a),{},{skins:null!==(n=a.skins)&&void 0!==n?n:[],isLocked:!!i||a.isLocked})),o.setVisible(!0),o.container.scale=new be(.4,.4,.4),re(o.container).to(.3,{scale:be.ONE},{easing:"quadOut"}).start())})))}},{key:"preserveScrollPosition",value:function(){this.themeScrollView.scrollView.stopAutoScroll(),this.preservedScrollPosition.set(this.themeScrollView.scrollView.getScrollOffset())}},{key:"restoreScrollPosition",value:function(){this.themeScrollView.scrollView.scrollToOffset(this.preservedScrollPosition,0)}},{key:"updateUnlockedProgress",value:function(e){var t=this,n=N$.getStorageData("collection","animateMapPackUnlock"),i=N$.getStorageData("collection","lastMapPack");e.forEach((function(e,a){var o=e.progress,r=e.max,l=e.isLocked;if(o<r&&!l&&n&&i!==a+1)return t.animateThemeBlockUnlockIndex=a,N$.setStorageData("collection","animateMapPackUnlock",!1),void N$.setStorageData("collection","lastMapPack",a+1)}))}},{key:"shouldAnimateThemeBlockUnlock",value:function(){return null!==this.animateThemeBlockUnlockIndex}},{key:"playThemeTabUnlockAnim",value:(c=o((function*(e){var t;if(this.animateThemeBlockUnlockIndex){var n=this.themeScrollView.getNodeByOrder(this.animateThemeBlockUnlockIndex);if(n&&n.isVisible()){var i=n.getComponent(g$);if(i){var a=gv.getCollectionUnlockProgress()[this.animateThemeBlockUnlockIndex];a&&(yield i.playUnlockAnim(e,u(u({},a),{},{skins:null!==(t=a.skins)&&void 0!==t?t:[],isLocked:!0})),this.animateThemeBlockUnlockIndex=null)}}}})),function(e){return c.apply(this,arguments)})},{key:"scrollToCurrentUnlockingTheme",value:(r=o((function*(e,t){yield this.themeScrollView.scrollToOrder(e,t)})),function(e,t){return r.apply(this,arguments)})},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),h}(te)).prototype,"panelAnimator",[t$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c$=a(s$.prototype,"themeScrollView",[n$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d$=a(s$.prototype,"contentOpacity",[i$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h$=a(s$.prototype,"offsetFromTopOfScrollView",[a$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 407.5}}),a(s$.prototype,"playThemeTabUnlockAnim",[o$],Object.getOwnPropertyDescriptor(s$.prototype,"playThemeTabUnlockAnim"),s$.prototype),a(s$.prototype,"scrollToCurrentUnlockingTheme",[r$],Object.getOwnPropertyDescriptor(s$.prototype,"scrollToCurrentUnlockingTheme"),s$.prototype),l$=s$))||l$);X._RF.pop(),X._RF.push({},"500274Qu9dAjJwYv27wMaMU","StarProgressBar",void 0);var F$,B$,x$,z$,U$,G$,H$,q$,V$,$$,W$,K$,j$,Y$,X$,J$,Z$,Q$,eW,tW,nW,iW=Z.ccclass,aW=Z.property,oW=(m$=iW("StarProgressBar"),b$=aW(id),w$=aW(ke),S$=aW(ie),k$=aW(ie),C$=aW(Q),E$=Yn.onlyRunInLifeCycle,m$((P$=a((T$=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"progressBar",P$,s(e)),l(e,"progressLabel",L$,s(e)),l(e,"current",O$,s(e)),l(e,"total",I$,s(e)),l(e,"separator",R$,s(e)),e}return e(c,[{key:"setRange",value:function(e,t){this.total=t,this.current=e,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"updateProgress",value:function(){this.progressBar.progress=Math.min(this.current,this.total)/this.total,this.updateProgressLabel()}},{key:"updateProgressLabel",value:function(){this.progressLabel.string="".concat(this.current).concat(this.separator).concat(this.total)}},{key:"animateTo",value:(r=o((function*(e,t,n){var i=this,a=Math.min(e,this.total)/this.total,o=this.current,r=1,l=re(this.progressBar).to(3,{progress:a},{easing:"quadOut",onUpdate:function(t,a){a&&(i.current=o+Math.floor((e-o)*a),null==n||n(i.current),i.current===o-r&&(r++,re(i.progressLabel.node).to(.05,{scale:new be(1.2,1.2,1.2)}).to(.05,{scale:be.ONE}).start()),i.updateProgressLabel())}}),s=function(){i.current=e,i.updateProgress()};null==t||t.addAbortListener(s),yield p.runTweenAsync(l,t),null==t||t.removeAbortListener(s)})),function(e,t,n){return r.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),c}(te)).prototype,"progressBar",[b$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L$=a(T$.prototype,"progressLabel",[w$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O$=a(T$.prototype,"current",[S$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I$=a(T$.prototype,"total",[k$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R$=a(T$.prototype,"separator",[C$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(T$.prototype,"updateProgress",[E$],Object.getOwnPropertyDescriptor(T$.prototype,"updateProgress"),T$.prototype),A$=T$))||A$);X._RF.pop(),X._RF.push({},"62d0dndWgNMpLpyrC7yEEUL","DailyRewardsWidget",void 0);var rW,lW,sW,uW,cW,dW,hW=Z.ccclass,pW=Z.property,yW=Ludex,vW=yW.Utils,fW=vW.Signal,gW=vW.String,mW=yW.Configs.DailyRewards.MockTime,bW=yW.Events,wW=codex.event,SW=mW>0?mW:864e5,kW=(F$=hW("DailyRewardsWidget"),B$=Yn.required(),x$=pW(we.AnimationController),z$=Yn.required(),U$=pW(zT),G$=Yn.required(),H$=pW(ke),q$=Yn.required(),V$=pW(id),$$=Yn.required(),W$=pW(me),K$=Yn.onlyRunInLifeCycle,j$=Yn.onlyRunInLifeCycle,Y$=Yn.onlyRunInLifeCycle,F$((Z$=a((J$=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"animationController",Z$,s(e)),l(e,"particles",Q$,s(e)),l(e,"timeLabel",eW,s(e)),l(e,"progressBar",tW,s(e)),l(e,"progressBarAndLabel",nW,s(e)),e.signalController=new fW.SignalController,e.handleScreenClosed=function(t){t.screenName===V[z.DAILY_REWARDS_SCREEN]&&e.refresh()},e}return e(d,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this)}},{key:"onEnable",value:function(){wW.on(bW.CLOSED_SCREEN,this.handleScreenClosed)}},{key:"onDisable",value:function(){wW.off(bW.CLOSED_SCREEN,this.handleScreenClosed),this.signalController.abort()}},{key:"onDestroy",value:function(){this.signalController.abort()}},{key:"setParticles",value:function(e){e?(this.particles.node.active=!0,this.particles.play()):(this.particles.stop(),this.particles.node.active=!1)}},{key:"setProgressBarAndLabelVisibility",value:function(e,t){p.runTweenAsync(re(this.progressBarAndLabel).to(e?.5:.2,{scale:e?be.ONE:be.ZERO},{easing:e?"backOut":"sineIn"}),t)}},{key:"startUpdateRemainingTimeSchedule",value:function(e){var t=this,n=new fW.SignalController,i=function(){var a=o((function*(){var a=n.renew();a.chain(e);var o=yield Xq.getRemainingTime();a.aborted||(t.updateRemainingTime(o),0===o&&t.unschedule(i))}));return function(){return a.apply(this,arguments)}}();i(),this.schedule(i,1),e.once((function(){return t.unschedule(i)}))}},{key:"startSelfRefreshSchedule",value:(u=o((function*(e){var t=this,n=yield Xq.getRemainingTime();if(!e.aborted&&0!==n){var i=function n(){e.aborted||t.refresh(),t.unschedule(n)};this.schedule(i,n/1e3),e.once((function(){return t.unschedule(i)}))}})),function(e){return u.apply(this,arguments)})},{key:"updateRemainingTime",value:function(e){if(0===e)this.updateTimeLabel("00:00:00");else{var t=gW.padStart(Math.floor(e/36e5).toString(),2,"0"),n=gW.padStart(Math.floor(e%36e5/6e4).toString(),2,"0"),i=gW.padStart(Math.floor(e%6e4/1e3).toString(),2,"0"),a="".concat(t,":").concat(n,":").concat(i);this.updateTimeLabel(a)}var o=1-e/SW;this.updateProgressBar(o)}},{key:"updateTimeLabel",value:function(e){this.timeLabel.string=e}},{key:"updateProgressBar",value:function(e){this.progressBar.progress=e}},{key:"refresh",value:(r=o((function*(){var e=this.signalController.renew(),t=yield Xq.hasClaimableRewards();e.aborted||(this.animationController.setValue("claimable",t),this.setParticles(t),this.setProgressBarAndLabelVisibility(!t,e),this.startUpdateRemainingTimeSchedule(e),this.startSelfRefreshSchedule(e))})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"animationController",[B$,x$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q$=a(J$.prototype,"particles",[z$,U$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eW=a(J$.prototype,"timeLabel",[G$,H$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tW=a(J$.prototype,"progressBar",[q$,V$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nW=a(J$.prototype,"progressBarAndLabel",[$$,W$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(J$.prototype,"updateRemainingTime",[K$],Object.getOwnPropertyDescriptor(J$.prototype,"updateRemainingTime"),J$.prototype),a(J$.prototype,"updateTimeLabel",[j$],Object.getOwnPropertyDescriptor(J$.prototype,"updateTimeLabel"),J$.prototype),a(J$.prototype,"updateProgressBar",[Y$],Object.getOwnPropertyDescriptor(J$.prototype,"updateProgressBar"),J$.prototype),X$=J$))||X$);X._RF.pop(),X._RF.push({},"83036ocqiZHXrI3Aq0dBJRD","EventButton",void 0);var CW,EW,AW,TW,PW,LW,OW,IW,RW,_W,DW,NW,MW,FW,BW,xW=Z.ccclass,zW=Z.property,UW=(rW=xW("EventButton"),lW=zW({type:pe(tG)}),sW=zW(Se),rW((dW=a((cW=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"eventType",dW,s(e)),e._isAvailable=!1,e}return e(r,[{key:"isAvailable",get:function(){return this._isAvailable},set:function(e){this._isAvailable=e,this.fakeClick()}},{key:"handleClick",value:function(){this.node.scene.emit(Pn,{type:this.eventType})}},{key:"setAnimationState",value:function(e){this.animationController.setValue("RESET-SPECIAL",this._isAvailable),d(h(r.prototype),"setAnimationState",this).call(this,e)}}]),r}(Cr)).prototype,"eventType",[lW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return tG.STAR_CHEST}}),a(cW.prototype,"isAvailable",[sW],Object.getOwnPropertyDescriptor(cW.prototype,"isAvailable"),cW.prototype),uW=cW))||uW);X._RF.pop(),X._RF.push({},"87a11fQFYVFcphsqf5ivVof","DashboardHeader",void 0);var GW,HW,qW,VW,$W,WW,KW,jW,YW,XW,JW,ZW,QW,eK,tK,nK,iK,aK,oK=Z.ccclass,rK=Z.property,lK=codex.player,sK=(CW=oK("DashboardHeader"),EW=rK({type:oW,displayName:"Progress bar",group:"Star Chest"}),AW=rK({type:UW,displayName:"Button Component",group:"Star Chest"}),TW=rK(kW),PW=rK(ne),LW=rK(oe),OW=rK(ne),CW((_W=a((RW=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"starProgressBar",_W,s(e)),l(e,"chestButton",DW,s(e)),l(e,"dailyRewardsWidget",NW,s(e)),l(e,"uiTransform",MW,s(e)),l(e,"containerWidget",FW,s(e)),l(e,"containerUITransform",BW,s(e)),e}return e(r,[{key:"__preload",value:function(){se.on(kn,this.handleStarsUpdateEvent,this),se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),se.on(y.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"start",value:function(){this.handleOrientationChanged()}},{key:"onDestroy",value:function(){se.off(kn,this.handleStarsUpdateEvent,this),se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),se.off(y.VIEW_RESIZED,this.handleOrientationChanged,this)}},{key:"updateDailyRewardsButton",value:function(){this.dailyRewardsWidget.refresh()}},{key:"updateStarProgress",value:function(e){this.handleStarsUpdateEvent(e)}},{key:"updateStarChestButtonAnimation",value:function(e){this.chestButton.isAvailable=e>=20}},{key:"handleStarsUpdateEvent",value:function(e){var t,n=null!=e?e:null===(t=lK.getGameData())||void 0===t?void 0:t.stars;void 0!==n&&(this.starProgressBar.setRange(n,20),this.updateStarChestButtonAnimation(n))}},{key:"handleOrientationChanged",value:function(){P.isPortrait()?this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!0:P.isLandscape()&&(this.containerWidget.isAlignLeft=this.containerWidget.isAlignRight=!1,this.containerUITransform.width=Math.min(this.uiTransform.width,1366)),this.containerWidget.getComponentsInChildren(oe).forEach((function(e,t){e.updateAlignment()}))}},{key:"handleClickedSettingsButton",value:function(){x.openScreen(z.SETTINGS_SCREEN)}}]),r}(te)).prototype,"starProgressBar",[EW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DW=a(RW.prototype,"chestButton",[AW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NW=a(RW.prototype,"dailyRewardsWidget",[TW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MW=a(RW.prototype,"uiTransform",[PW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FW=a(RW.prototype,"containerWidget",[LW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BW=a(RW.prototype,"containerUITransform",[OW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IW=RW))||IW);X._RF.pop(),X._RF.push({},"3b954Re2cRHvYJeBVAukYp9","JourneyLevelAvatar",void 0);var uK,cK,dK,hK,pK,yK,vK,fK,gK,mK,bK,wK,SK,kK=Z.ccclass,CK=Z.property,EK=Z.executeInEditMode,AK=(GW=kK("JourneyLevelAvatar"),HW=CK({type:he,displayName:"Avatar node"}),qW=CK(me),VW=CK(ze),$W=CK(de),WW=CK({type:Ue,group:"Animation"}),KW=CK({type:Ue,group:"Animation"}),jW=CK({type:Ue,group:"Animation"}),YW=CK({type:xe,displayName:"Avatar sprite"}),GW(XW=EK((ZW=a((JW=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"sprite",ZW,s(e)),l(e,"lockIcon",QW,s(e)),l(e,"animation",eK,s(e)),l(e,"opacity",tK,s(e)),l(e,"flashAnimation",nK,s(e)),l(e,"unlockAnimation",iK,s(e)),l(e,"spawnAnimation",aK,s(e)),e}return e(h,[{key:"avatarSprite",get:function(){var e,t;return null!==(e=null===(t=this.sprite)||void 0===t?void 0:t.spriteFrame)&&void 0!==e?e:null},set:function(e){this.sprite&&(this.sprite.spriteFrame=e)}},{key:"playUnlockAnimation",value:(c=o((function*(){var e=this.playAnimation(this.unlockAnimation),t=this.lockIcon.position.x,n=this.lockIcon.position.y,i=[45,135],a=(Math.random()*(i[1]-i[0])+i[0])*(Math.PI/180),o=this.lockIcon.position.x+150*Math.cos(a),r=this.lockIcon.position.y+150*Math.sin(a),l=n-400,s=p.runTweenAsync(re(this.lockIcon).delay(.3).to(.2,{position:new be(o,r,this.lockIcon.position.z)},{easing:"sineOut"}).to(.4,{position:new be(o,l,this.lockIcon.position.z)},{easing:"cubicIn"})),u=[0,360],c=p.runTweenAsync(re(this.lockIcon).delay(.3).to(.6,{eulerAngles:new be(0,0,Math.random()*(u[1]-u[0])*(o>t?-1:1))},{easing:"sineOut"}));yield Promise.all([e,s,c]),this.lockIcon.position=new be(t,n,this.lockIcon.position.z),this.lockIcon.eulerAngles=new be(0,0,0)})),function(){return c.apply(this,arguments)})},{key:"playFlashAnimation",value:(u=o((function*(e){var t=this.node.position.y,n=this.playAnimation(this.flashAnimation),i=p.runTweenAsync(re(this.node).to(.1,{position:new be(this.node.position.x,this.node.position.y+10,this.node.position.z)},{easing:"sineOut"}).to(.1,{position:new be(this.node.position.x,t,this.node.position.z)},{easing:"sineIn"}),e);yield Promise.all([n,i])})),function(e){return u.apply(this,arguments)})},{key:"playSpawnAnimation",value:function(){this.opacity.opacity=255,this.playAnimation(this.spawnAnimation)}},{key:"hideImmediately",value:function(){this.opacity.opacity=0,this.node.setScale(be.ZERO)}},{key:"playAnimation",value:(r=o((function*(e){yield p.runAnimationAsync(this.animation,e.name)})),function(e){return r.apply(this,arguments)})},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){var e=this;if(!this.sprite)throw new Error("JourneyLevelAvatar: Avatar node is required");if(!this.lockIcon)throw new Error("JourneyLevelAvatar: Lock icon is required");if(!this.flashAnimation)throw new Error("JourneyLevelAvatar: Flash animation is required");if(!this.unlockAnimation)throw new Error("JourneyLevelAvatar: Unlock animation is required");if(!this.animation)throw new Error("JourneyLevelAvatar: Animation component is required");if(!this.animation.clips.some((function(t){return null!==t&&(t.name===e.flashAnimation.name||t.name===e.unlockAnimation.name||t.name===e.spawnAnimation.name)})))throw new Error("JourneyLevelAvatar: Animation component does not contain required animations")}}]),h}(te)).prototype,"sprite",[HW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),QW=a(JW.prototype,"lockIcon",[qW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eK=a(JW.prototype,"animation",[VW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tK=a(JW.prototype,"opacity",[$W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nK=a(JW.prototype,"flashAnimation",[WW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iK=a(JW.prototype,"unlockAnimation",[KW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aK=a(JW.prototype,"spawnAnimation",[jW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(JW.prototype,"avatarSprite",[YW],Object.getOwnPropertyDescriptor(JW.prototype,"avatarSprite"),JW.prototype),XW=JW))||XW)||XW);X._RF.pop(),X._RF.push({},"a392bibG75JPKzG0y2ZS2YY","JourneyProgressBar",void 0);var TK,PK,LK,OK,IK,RK,_K,DK,NK,MK,FK,BK,xK,zK,UK,GK,HK,qK,VK,$K,WK,KK,jK,YK,XK,JK,ZK=Z.ccclass,QK=Z.property,ej=Z.executeInEditMode,tj=(uK=ZK("JourneyProgressBar"),cK=QK(id),dK=QK(ke),hK=QK(de),pK=QK(ie),yK=QK(ie),vK=QK(Q),fK=Yn.onlyRunInLifeCycle,uK(gK=ej((bK=a((mK=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"progressBar",bK,s(e)),l(e,"progressLabel",wK,s(e)),l(e,"labelUIOpacity",SK,s(e)),e.currentProgress=10,e.totalProgress=10,e.labelSeparator="/",e}return e(c,[{key:"total",get:function(){return this.totalProgress}},{key:"current",get:function(){return this.currentProgress}},{key:"separator",get:function(){return this.labelSeparator},set:function(e){this.labelSeparator=e,this.updateProgress()}},{key:"setRange",value:function(e,t){this.totalProgress=t;var n=e;n>t&&(n=t),this.currentProgress=n,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"animateTo",value:(r=o((function*(e){var t=this,n=e.nextCurr,i=e.nextTotal,a=e.numberOfProgressBar,o=void 0===a?0:a,r=e.onProgressBarPassed,l=e.signal,s=n/i,u=re(this.labelUIOpacity).to(.2,{opacity:0}),c=re(this.labelUIOpacity).to(.2,{opacity:255}),d=o<1?1:Math.sqrt(o)+1,h=0===o?s:o+s,y=1,v=this.progressBar.progress,f=h,g=p.runOnUpdateAsync(this.node,d,(function(e){var n=ye.sineInOut(e),i=Xe(v,f,n);t.progressBar.progress=i%1,i>y&&(y=0===i?1:Math.ceil(i),null==r||r())}),l);return yield Promise.all([p.runTweenAsync(u,l),g]),this.currentProgress=n,this.totalProgress=i,this.updateProgress(),yield p.runTweenAsync(c,l),this.labelUIOpacity.opacity=255,s})),function(e){return r.apply(this,arguments)})},{key:"updateProgress",value:function(){this.progressBar.progress=this.currentProgress/this.totalProgress,this.progressLabel.string="".concat(this.currentProgress).concat(this.separator).concat(this.totalProgress)}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),c}(te)).prototype,"progressBar",[cK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wK=a(mK.prototype,"progressLabel",[dK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SK=a(mK.prototype,"labelUIOpacity",[hK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(mK.prototype,"total",[pK],Object.getOwnPropertyDescriptor(mK.prototype,"total"),mK.prototype),a(mK.prototype,"current",[yK],Object.getOwnPropertyDescriptor(mK.prototype,"current"),mK.prototype),a(mK.prototype,"separator",[vK],Object.getOwnPropertyDescriptor(mK.prototype,"separator"),mK.prototype),a(mK.prototype,"updateProgress",[fK],Object.getOwnPropertyDescriptor(mK.prototype,"updateProgress"),mK.prototype),gK=mK))||gK)||gK);X._RF.pop(),X._RF.push({},"8a41bfxLylDhLk57kewW14A","JourneyProgressAnimator",void 0);var nj,ij,aj,oj,rj,lj,sj,uj,cj,dj,hj,pj=Z.ccclass,yj=Z.property,vj=(TK=pj("ProgressConfiguration"),PK=yj(xe),LK=yj(Q),TK((RK=a((IK=e((function e(){t(this,e),l(this,"avatar",RK,this),l(this,"themeId",_K,this)}))).prototype,"avatar",[PK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_K=a(IK.prototype,"themeId",[LK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OK=IK)),DK=pj("JourneyProgressAnimator"),NK=Yn.required(),MK=yj(tj),FK=Yn.required(),BK=yj(me),xK=Yn.required(),zK=yj(he),UK=Yn.required(),GK=yj(AK),HK=yj({type:ae,displayName:"Next Level Y Offset on Animation",group:"Unlocked Animation"}),qK=Yn.onlyRunInLifeCycleAsync,VK=Yn.onlyRunInLifeCycle,DK((KK=a((WK=function(a){n(g,a);var u,c,d,h,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"progressBar",KK,s(e)),l(e,"currentLevelAvatarNode",jK,s(e)),l(e,"currentLevelAvatar",YK,s(e)),l(e,"nextLevelAvatar",XK,s(e)),l(e,"nextLevelYOffset",JK,s(e)),e.isAnimating=!1,e}return e(g,[{key:"setRange",value:function(e,t){this.progressBar.setRange(e,t)}},{key:"animateTo",value:(v=o((function*(e,t){if(this.isAnimating)return console.warn("JourneyProgressAnimator: animation already in progress"),Promise.resolve();this.isAnimating=!0,e!==this.progressBar.current&&(yield this.progressBar.animateTo({nextCurr:e,nextTotal:this.progressBar.total,signal:t})),this.isAnimating=!1})),function(e,t){return v.apply(this,arguments)})},{key:"animateToNextLevel",value:(y=o((function*(e){var t=this,n=e.nextCurr,i=e.nextTotal,a=e.mapsPassed,o=e.signal;if(this.isAnimating)console.warn("JourneyProgressAnimator: animation already in progress");else{this.isAnimating=!0;var r=a.length-2;if(0===r)return yield this.progressBar.animateTo({nextCurr:n,nextTotal:i,signal:o}),void(this.isAnimating=!1);yield this.animateTargetAvaToCenter(o);var l=1;yield this.progressBar.animateTo({signal:o,nextCurr:n,nextTotal:i,numberOfProgressBar:r,onProgressBarPassed:function(){if(1===l)return t.nextLevelAvatar.playUnlockAnimation(),void(l+=1);if(l>=a.length)throw new Error("JourneyProgressAnimator: currThemeIndex out of bounds");t.nextLevelAvatar.playFlashAnimation(o),t.setNextLevelAvatar(a[l].theme),l+=1}}),yield this.animateTargetAvaToPrev(o);var s=a[a.length-1].theme,u=a[a.length-2].theme;this.setCurrentLevelAvatar(u),this.nextLevelAvatar.hideImmediately(),this.moveTargetAvaToOriginal(),this.nextLevelAvatar.avatarSprite=yield this.getSpriteFrameByThemeId(s),this.nextLevelAvatar.playSpawnAnimation(),this.isAnimating=!1}})),function(e){return y.apply(this,arguments)})},{key:"animateTargetAvaToCenter",value:(h=o((function*(e){var t=new be(0,this.nextLevelYOffset+this.nextLevelAvatar.node.position.y,this.nextLevelAvatar.node.position.z);yield p.runTweenAsync(re(this.nextLevelAvatar.node).to(1,{position:t},{easing:"cubicInOut"}),e),this.nextLevelAvatar.node.position=t})),function(e){return h.apply(this,arguments)})},{key:"moveTargetAvaToOriginal",value:function(){this.nextLevelAvatar.node.position=this.originalNextLevelAvatarPosition.clone()}},{key:"animateTargetAvaToPrev",value:(d=o((function*(e){var t=this.currentLevelAvatarNode.position.clone();yield p.runTweenAsync(re(this.nextLevelAvatar.node).to(1,{position:t},{easing:"cubicInOut"}),e),this.nextLevelAvatar.node.position=t})),function(e){return d.apply(this,arguments)})},{key:"getSpriteFrameByThemeId",value:(c=o((function*(e){return r.loadThemeThumbnailAsync(e)})),function(e){return c.apply(this,arguments)})},{key:"loadAndSetAvatar",value:(u=o((function*(e,t){var n=yield this.getSpriteFrameByThemeId(e);n?this.setAvatar(n,t):console.warn("JourneyProgressAnimator: ".concat(e," is null"))})),function(e,t){return u.apply(this,arguments)})},{key:"setAvatar",value:function(e,t){t instanceof AK?t.avatarSprite=e:t.spriteFrame=e}},{key:"setCurrentLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.currentLevelAvatar)}},{key:"setNextLevelAvatar",value:function(e){this.loadAndSetAvatar(e,this.nextLevelAvatar)}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,g),this.originalNextLevelAvatarPosition=this.nextLevelAvatar.node.position.clone()}}]),g}(te)).prototype,"progressBar",[NK,MK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jK=a(WK.prototype,"currentLevelAvatarNode",[FK,BK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YK=a(WK.prototype,"currentLevelAvatar",[xK,zK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XK=a(WK.prototype,"nextLevelAvatar",[UK,GK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JK=a(WK.prototype,"nextLevelYOffset",[HK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a(WK.prototype,"loadAndSetAvatar",[qK],Object.getOwnPropertyDescriptor(WK.prototype,"loadAndSetAvatar"),WK.prototype),a(WK.prototype,"setAvatar",[VK],Object.getOwnPropertyDescriptor(WK.prototype,"setAvatar"),WK.prototype),$K=WK))||$K);X._RF.pop(),X._RF.push({},"4b935BmCjhBf73yEp1PitwH","LandscapeMask",void 0);var fj,gj,mj,bj,wj,Sj,kj,Cj,Ej,Aj,Tj,Pj,Lj,Oj=Z.ccclass,Ij=Z.property,Rj=(nj=Oj("LandscapeMask"),ij=Ij(qr),aj=Ij(ne),oj=Ij(ne),rj=Ij(ne),nj((uj=a((sj=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"opacityToggler",uj,s(e)),l(e,"uiTransform",cj,s(e)),l(e,"leftMask",dj,s(e)),l(e,"rightMask",hj,s(e)),e}return e(r,[{key:"__preload",value:function(){se.on(y.VIEW_RESIZED,this.onViewResized,this)}},{key:"onDestroy",value:function(){se.off(y.VIEW_RESIZED,this.onViewResized,this)}},{key:"onViewResized",value:function(){this.updateMaskPosition()}},{key:"updateMaskPosition",value:function(){var e=this.uiTransform.contentSize,t=e.width,n=e.height;this.leftMask.width=this.rightMask.width=2*n;var i=this.leftMask.height>.3*t?this.leftMask.height-.3*t:0;this.leftMask.node.setWorldPosition(-i,this.leftMask.node.worldPosition.y,0),this.rightMask.node.setWorldPosition(t+i,this.rightMask.node.worldPosition.y,0)}},{key:"show",value:function(){this.opacityToggler.changeStateFade(!0,.2)}},{key:"hide",value:function(){this.opacityToggler.changeStateFade(!1,.1)}}]),r}(te)).prototype,"opacityToggler",[ij],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cj=a(sj.prototype,"uiTransform",[aj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dj=a(sj.prototype,"leftMask",[oj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hj=a(sj.prototype,"rightMask",[rj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lj=sj))||lj);X._RF.pop(),X._RF.push({},"ee748sgCHxCTaIJcL1SUIFl","CustomButton",void 0);var _j,Dj,Nj,Mj,Fj,Bj,xj,zj,Uj,Gj,Hj,qj,Vj,$j,Wj=Z.ccclass,Kj=Z.property,jj=(fj=Wj("CustomButton"),gj=Kj(he),mj=Kj(xe),bj=Kj(xe),wj=Kj(fe),Sj=Kj(me),fj((Ej=a((Cj=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"sprite",Ej,s(e)),l(e,"lockedSprite",Aj,s(e)),l(e,"unlockedSprite",Tj,s(e)),l(e,"button",Pj,s(e)),l(e,"unlockContainer",Lj,s(e)),e}return e(c,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e>=13;this.button.interactable=t,this.unlockContainer.active=!t,this.sprite.spriteFrame=t?this.unlockedSprite:this.lockedSprite}},{key:"handleOnClicked",value:(r=o((function*(){var e;(null!==(e=(yield x.openScreenAndWaitForClose(z.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==e?e:{}).customMode&&this.node.scene.emit(En)})),function(){return r.apply(this,arguments)})}]),c}(te)).prototype,"sprite",[gj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aj=a(Cj.prototype,"lockedSprite",[mj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tj=a(Cj.prototype,"unlockedSprite",[bj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pj=a(Cj.prototype,"button",[wj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lj=a(Cj.prototype,"unlockContainer",[Sj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kj=Cj))||kj);X._RF.pop(),X._RF.push({},"a479fLcnJ9AtqhT/3Hs2xco","CustomGuideUI",void 0);var Yj,Xj,Jj,Zj,Qj,eY,tY,nY,iY,aY,oY,rY,lY,sY,uY,cY=Z.ccclass,dY=Z.property,hY=(_j=cY("CustomGuideUI"),Dj=Yn.required(),Nj=dY(jj),Mj=Yn.required(),Fj=dY(h_),Bj=Yn.required(),xj=dY(ke),zj=Yn.onlyRunInLifeCycleAsync,Uj=Yn.onlyRunInLifeCycleAsync,_j((qj=a((Hj=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"customButton",qj,s(e)),l(e,"guideMasks",Vj,s(e)),l(e,"guideInfoText",$j,s(e)),e.guideShown=!1,e}return e(c,[{key:"update",value:function(){if(this.guideShown){var e=this.customButton.node.worldPosition;this.guideInfoText.node.worldPosition=new be(e.x-100,e.y,0),this.guideMasks.setOtherMaskTransform(e.x,e.y,150,150)}}},{key:"startGuide",value:(r=o((function*(){var e;this.guideShown=!0,this.guideInfoText.node.active=!0,yield this.guideMasks.show(),yield Promise.race([this.waitForClick(),p.waitTweenAsync(3)]),yield null===(e=this.guideMasks)||void 0===e?void 0:e.hide(),this.guideInfoText.node.active=!1,this.guideShown=!1})),function(){return r.apply(this,arguments)})},{key:"waitForClick",value:function(){var e=this;return new Promise((function(t){e.node.scene.once(Js.GUIDE_MASK_CLICKED,(function(){t()}))}))}}]),c}(te)).prototype,"customButton",[Dj,Nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vj=a(Hj.prototype,"guideMasks",[Mj,Fj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$j=a(Hj.prototype,"guideInfoText",[Bj,xj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Hj.prototype,"startGuide",[zj],Object.getOwnPropertyDescriptor(Hj.prototype,"startGuide"),Hj.prototype),a(Hj.prototype,"waitForClick",[Uj],Object.getOwnPropertyDescriptor(Hj.prototype,"waitForClick"),Hj.prototype),Gj=Hj))||Gj);X._RF.pop(),X._RF.push({},"21121NZ8PtCJJpkj1j2/qOg","PlayButton",void 0);var pY,yY,vY,fY,gY,mY,bY,wY,SY,kY,CY,EY,AY,TY,PY,LY,OY,IY,RY,_Y,DY,NY,MY,FY,BY,xY,zY,UY,GY,HY,qY,VY,$Y,WY,KY,jY,YY,XY,JY,ZY,QY,eX=Z.ccclass,tX=Z.property,nX=(Yj=eX("PlayButton"),Xj=Yn.required(),Jj=tX(Lh),Zj=Yn.required(),Qj=tX(me),eY=Yn.required(),tY=tX(me),nY=Yn.required(),iY=tX(fe),Yj((rY=a((oY=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"localizer",rY,s(e)),l(e,"defaultBackground",lY,s(e)),l(e,"hardLevelBackground",sY,s(e)),l(e,"button",uY,s(e)),e}return e(r,[{key:"interactable",set:function(e){this.button.interactable=e}},{key:"updateStatus",value:function(e){var t=e%5==0;this.localizer.setParams([e.toString()]),this.defaultBackground.active=!t,this.hardLevelBackground.active=t}},{key:"handleOnClicked",value:function(){this.node.scene.emit(Cn)}}]),r}(te)).prototype,"localizer",[Xj,Jj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lY=a(oY.prototype,"defaultBackground",[Zj,Qj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sY=a(oY.prototype,"hardLevelBackground",[eY,tY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uY=a(oY.prototype,"button",[nY,iY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aY=oY))||aY);X._RF.pop(),X._RF.push({},"c2ddaEnKBVFvrM5x5nbfT7h","HomeContent",void 0);var iX,aX,oX,rX,lX,sX,uX,cX,dX,hX,pX,yX,vX,fX,gX,mX,bX,wX,SX,kX,CX,EX,AX,TX,PX,LX,OX,IX,RX,_X,DX,NX,MX=Z.ccclass,FX=Z.property,BX=codex,xX=BX.storage,zX=BX.monitorError,UX=BX.player,GX=Ludex.Utils,HX=GX.Array,qX=GX.Json,VX=(pY=MX("HomeContent"),yY=Yn.required(),vY=FX({type:nX,group:"Play Button"}),fY=Yn.required(),gY=FX({type:jj,group:"Play Button"}),mY=Yn.required(),bY=FX(qr),wY=Yn.required(),SY=FX(vj),kY=Yn.required(),CY=FX(sK),EY=Yn.required(),AY=FX(de),TY=Yn.required(),PY=FX(Qx),LY=Yn.required(),OY=FX(me),IY=Yn.required(),RY=FX(Rj),_Y=Yn.required(),DY=FX(hY),NY=Yn.onlyRunInLifeCycleAsync,MY=Yn.onlyRunInLifeCycleAsync,FY=Yn.onlyRunInLifeCycleAsync,BY=Yn.onlyRunInLifeCycleAsync,xY=Yn.onlyRunInLifeCycleAsync,zY=Yn.onlyRunInLifeCycle,UY=Yn.onlyRunInLifeCycle,GY=Yn.onlyRunInLifeCycleAsync,pY((VY=a((qY=function(a){n(g,a);var r,c,d,h,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"playButton",VY,s(e)),l(e,"customButton",$Y,s(e)),l(e,"contentOpacity",WY,s(e)),l(e,"journeyProgressAnimator",KY,s(e)),l(e,"dashboardHeader",jY,s(e)),l(e,"overlayDuringAnim",YY,s(e)),l(e,"coinContainer",XY,s(e)),l(e,"leavesContainer",JY,s(e)),l(e,"landscapeMask",ZY,s(e)),l(e,"customGuideUI",QY,s(e)),e}return e(g,[{key:"onLoad",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(),Yn.validateRequiredProperties(this)}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"listenEvents",value:function(){this.node.scene.on(Js.HIDE_UI,this.hideContent,this),this.node.scene.on(Js.SHOW_UI,this.showContent,this)}},{key:"unlistenEvents",value:function(){this.node.scene.off(Js.HIDE_UI,this.hideContent,this),this.node.scene.off(Js.SHOW_UI,this.showContent,this)}},{key:"getCoinContainer",value:function(){return this.coinContainer}},{key:"updateStatus",value:function(){var e,t=null!==(e=UX.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?1:n,a=t.stars,o=void 0===a?0:a;this.playButton.updateStatus(i),this.customButton.updateStatus(i),this.dashboardHeader.updateStarProgress(o),this.dashboardHeader.updateDailyRewardsButton()}},{key:"updateDailyRewardsButton",value:function(){this.dashboardHeader.updateDailyRewardsButton()}},{key:"setUnlockProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setProgress(e),this.updateCurrentMapInStorage(e,t)}},{key:"shouldPlayUnlockAnimation",value:function(){var e,t,n=xX.getStorage("dashboard");if(null==n)return null==zX||zX.sendException(new Error("DashboardScene: dashboardStorage not found")),!1;if(!(null!==(e=n.animateToCurrentLevel)&&void 0!==e&&e))return!1;var i=xX.getStorage("tournament");if(null==i)return null==zX||zX.sendException(new Error("DashboardScene: tournamentStorage not found")),!1;if(null!==(t=i.animateTournamentLeader)&&void 0!==t&&t)return!1;var a=n.lastMapPayload,o=gv.getCurrentMapProgress();return qX.encode(a)!==qX.encode(o)&&!(HX.searchIndex(dv.mapOrder,(function(e){return e.id===a.id}))>HX.searchIndex(dv.mapOrder,(function(e){return e.id===o.id})))}},{key:"playUnlockProgressAnimation",value:function(e){var t=xX.getStorage("dashboard");if(null==t)throw new Error("DashboardScene: dashboardStorage not found");var n=t.lastMapPayload,i=gv.getCurrentMapProgress(),a=HX.searchIndex(dv.mapOrder,(function(e){return e.id===n.id})),o=HX.searchIndex(dv.mapOrder,(function(e){return e.id===i.id})),r=dv.mapOrder.slice(a,o+2);return n.id===i.id?this.playUnlockProgressAnimationOnly(i,n,e):this.playUnlockProgressAndPackAnimation(n,i,r,e)}},{key:"playUnlockProgressAndPackAnimation",value:(v=o((function*(e,t,n,i){this.setProgress(u({},e)),this.updateCurrentMapInStorage(u({},t),!0),this.playButton.interactable=!1,yield this.showOwnOverlay(i),yield this.journeyProgressAnimator.animateToNextLevel({nextCurr:t.progress,nextTotal:t.max,mapsPassed:n,signal:i}),yield this.hideOwnOverlay(i),this.playButton.interactable=!0})),function(e,t,n,i){return v.apply(this,arguments)})},{key:"playUnlockProgressAnimationOnly",value:(h=o((function*(e,t,n){this.setProgress(u(u({},e),{},{progress:t.progress})),this.updateCurrentMapInStorage(u({},e),!0);var i=e.progress;yield this.showOwnOverlay(n),yield this.journeyProgressAnimator.animateTo(i,n),yield this.hideOwnOverlay(n)})),function(e,t,n){return h.apply(this,arguments)})},{key:"hideOwnOverlay",value:(d=o((function*(e){yield p.runTweenAsync(re(this.overlayDuringAnim).to(.3,{opacity:0}),e),this.node.activeInHierarchy&&(this.overlayDuringAnim.opacity=0)})),function(e){return d.apply(this,arguments)})},{key:"showOwnOverlay",value:(c=o((function*(e){yield p.runTweenAsync(re(this.overlayDuringAnim).to(.3,{opacity:150}),e)})),function(e){return c.apply(this,arguments)})},{key:"setProgress",value:function(e){var t=e.currentTheme,n=e.nextTheme,i=e.progress,a=e.max;this.journeyProgressAnimator.setCurrentLevelAvatar(t),this.journeyProgressAnimator.setNextLevelAvatar(null!=n?n:t),this.journeyProgressAnimator.setRange(i,a)}},{key:"updateCurrentMapInStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=xX.getStorage("dashboard");if(null!=n){var i=n.animateToCurrentLevel;xX.setStorageData("dashboard","animateToCurrentLevel",!t&&i),xX.setStorageData("dashboard","lastMapPayload",e)}else null==zX||zX.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"handleOrientationChanged",value:function(){this.leavesContainer.active=P.isLandscape(),this.landscapeMask.node.active=P.isLandscape()}},{key:"transitionIn",value:function(){this.listenEvents(),this.landscapeMask.node.active&&(this.landscapeMask.updateMaskPosition(),this.landscapeMask.show())}},{key:"transitionOut",value:function(){this.unlistenEvents(),this.landscapeMask.node.active&&this.landscapeMask.hide()}},{key:"hideContent",value:function(){this.contentOpacity.changeStateFade(!1,.5)}},{key:"showContent",value:function(){this.contentOpacity.changeStateFade(!0,.1)}},{key:"showCustomGuide",value:(r=o((function*(){yield this.customGuideUI.startGuide()})),function(){return r.apply(this,arguments)})}]),g}(te)).prototype,"playButton",[yY,vY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$Y=a(qY.prototype,"customButton",[fY,gY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WY=a(qY.prototype,"contentOpacity",[mY,bY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KY=a(qY.prototype,"journeyProgressAnimator",[wY,SY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jY=a(qY.prototype,"dashboardHeader",[kY,CY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YY=a(qY.prototype,"overlayDuringAnim",[EY,AY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XY=a(qY.prototype,"coinContainer",[TY,PY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JY=a(qY.prototype,"leavesContainer",[LY,OY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZY=a(qY.prototype,"landscapeMask",[IY,RY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QY=a(qY.prototype,"customGuideUI",[_Y,DY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(qY.prototype,"playUnlockProgressAnimation",[NY],Object.getOwnPropertyDescriptor(qY.prototype,"playUnlockProgressAnimation"),qY.prototype),a(qY.prototype,"playUnlockProgressAndPackAnimation",[MY],Object.getOwnPropertyDescriptor(qY.prototype,"playUnlockProgressAndPackAnimation"),qY.prototype),a(qY.prototype,"playUnlockProgressAnimationOnly",[FY],Object.getOwnPropertyDescriptor(qY.prototype,"playUnlockProgressAnimationOnly"),qY.prototype),a(qY.prototype,"hideOwnOverlay",[BY],Object.getOwnPropertyDescriptor(qY.prototype,"hideOwnOverlay"),qY.prototype),a(qY.prototype,"showOwnOverlay",[xY],Object.getOwnPropertyDescriptor(qY.prototype,"showOwnOverlay"),qY.prototype),a(qY.prototype,"hideContent",[zY],Object.getOwnPropertyDescriptor(qY.prototype,"hideContent"),qY.prototype),a(qY.prototype,"showContent",[UY],Object.getOwnPropertyDescriptor(qY.prototype,"showContent"),qY.prototype),a(qY.prototype,"showCustomGuide",[GY],Object.getOwnPropertyDescriptor(qY.prototype,"showCustomGuide"),qY.prototype),HY=qY))||HY);X._RF.pop(),X._RF.push({},"ba822axo49BibgkqkEhhqVp","DashboardPage",void 0);var $X,WX,KX,jX,YX,XX,JX,ZX,QX,eJ=Z.ccclass,tJ=Z.property,nJ=Z.disallowMultiple,iJ=Z.requireComponent,aJ=(iX=eJ("DashboardPage"),aX=iJ(oe),oX=iJ(de),rX=Yn.required(),lX=tJ({type:me,displayName:"Page's container"}),sX=Yn.required(),uX=Yn.required(),cX=tJ({type:me,displayName:"Placeholder"}),dX=Yn.required(),hX=tJ({displayName:"Don't create prefab",tooltip:"Tell the component to not create the prefab even if it hasn't create yet"}),pX=tJ({displayName:"Darken background"}),yX=tJ({type:ie,min:0,max:255,displayName:"Background opacity",visible:function(){return this.darkenBackground}}),vX=tJ({displayName:"Use navbar shadow"}),fX=tJ({type:ie,min:0,max:255,displayName:"Navbar shadow opacity",visible:function(){return this.useNavbarShadow}}),gX=Yn.required(),mX=Yn.required(),bX=Yn.onlyRunInLifeCycleAsync,wX=Yn.onlyRunInLifeCycle,SX=Yn.onlyRunInLifeCycleAsync,iX(kX=nJ(kX=aX(kX=oX((EX=a((CX=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"container",EX,s(e)),l(e,"containerUIOpacity",AX,s(e)),l(e,"placeholder",TX,s(e)),l(e,"placeholderUIOpacity",PX,s(e)),l(e,"hasCreated",LX,s(e)),e.pagePrefab=null,l(e,"darkenBackground",OX,s(e)),l(e,"backgroundOpacity",IX,s(e)),l(e,"useNavbarShadow",RX,s(e)),l(e,"navbarShadowOpacity",_X,s(e)),l(e,"uiOpacity",DX,s(e)),l(e,"widgetComponent",NX,s(e)),e}return e(d,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(de),this.widgetComponent=this.getComponent(oe),this.containerUIOpacity=this.container.getComponent(de),this.placeholderUIOpacity=this.placeholder.getComponent(de),Yn.validateRequiredProperties(this)}},{key:"start",value:function(){this.container.active=!0,this.placeholder.active=!0}},{key:"getWidget",value:function(){return this.widgetComponent}},{key:"show",value:function(){this.uiOpacity.opacity=255}},{key:"hide",value:function(){this.uiOpacity.opacity=0}},{key:"mount",value:(u=o((function*(){this.hasCreated||(yield this.create()),this.mountInLifeCycle()})),function(){return u.apply(this,arguments)})},{key:"mountInLifeCycle",value:function(){this.placeholderUIOpacity.opacity=0,this.containerUIOpacity.opacity=255,S.trackCurrentPage(this.node.name,!0)}},{key:"unmount",value:function(){255===this.placeholderUIOpacity.opacity&&0===this.containerUIOpacity.opacity||(this.placeholderUIOpacity.opacity=255,this.containerUIOpacity.opacity=0)}},{key:"transitionIn",value:function(){return Promise.resolve()}},{key:"transitionOut",value:function(){return Promise.resolve()}},{key:"hasLoadedPage",value:function(){return!0}},{key:"getContainer",value:function(){return this.container}},{key:"getDarkenBackground",value:function(){return this.darkenBackground?this.backgroundOpacity:0}},{key:"getNavbarShadow",value:function(){return this.useNavbarShadow?this.navbarShadowOpacity:0}},{key:"create",value:(r=o((function*(){if(this.pagePrefab&&!this.hasCreated){var e=qe(this.pagePrefab);this.container.addChild(e),yield p.waitTweenAsync(0),this.hasCreated=!0}})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"container",[rX,lX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AX=a(CX.prototype,"containerUIOpacity",[sX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TX=a(CX.prototype,"placeholder",[uX,cX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PX=a(CX.prototype,"placeholderUIOpacity",[dX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LX=a(CX.prototype,"hasCreated",[hX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),OX=a(CX.prototype,"darkenBackground",[pX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),IX=a(CX.prototype,"backgroundOpacity",[yX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),RX=a(CX.prototype,"useNavbarShadow",[vX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_X=a(CX.prototype,"navbarShadowOpacity",[fX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),DX=a(CX.prototype,"uiOpacity",[gX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NX=a(CX.prototype,"widgetComponent",[mX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(CX.prototype,"mount",[bX],Object.getOwnPropertyDescriptor(CX.prototype,"mount"),CX.prototype),a(CX.prototype,"mountInLifeCycle",[wX],Object.getOwnPropertyDescriptor(CX.prototype,"mountInLifeCycle"),CX.prototype),a(CX.prototype,"create",[SX],Object.getOwnPropertyDescriptor(CX.prototype,"create"),CX.prototype),kX=CX))||kX)||kX)||kX)||kX);X._RF.pop(),X._RF.push({},"dab8cbliOBAeZ7iVs959mBm","CollectionsPage",void 0);var oJ,rJ,lJ,sJ,uJ,cJ,dJ,hJ,pJ,yJ,vJ,fJ,gJ,mJ,bJ,wJ,SJ,kJ,CJ,EJ,AJ,TJ,PJ,LJ,OJ,IJ,RJ,_J,DJ,NJ,MJ,FJ,BJ,xJ,zJ,UJ,GJ,HJ,qJ,VJ=($X=(0,Z.ccclass)("CollectionsPage"),WX=Yn.required(),KX=Yn.onlyRunInLifeCycleAsync,jX=Yn.onlyRunInLifeCycle,YX=Yn.onlyRunInLifeCycleAsync,XX=Yn.onlyRunInLifeCycleAsync,$X((QX=a((ZX=function(a){n(f,a);var r,u,c,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=v.call.apply(v,[this].concat(i))).payload=null,l(e,"panelAnimationController",QX,s(e)),e}return e(f,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(fu),d(h(f.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=o((function*(){d(h(f.prototype),"start",this).call(this)})),function(){return y.apply(this,arguments)})},{key:"setPayload",value:function(e){this.payload=e}},{key:"mount",value:(c=o((function*(){yield d(h(f.prototype),"mount",this).call(this),this.onMount()})),function(){return c.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,!this.themeContent&&(this.themeContent=this.container.getComponentInChildren(M$),!this.themeContent))throw new Error("No theme content found");var e=gv.getCollectionUnlockProgress();this.themeContent.updateUnlockedProgress(e),this.payload&&this.themeContent.init(this.payload)}},{key:"transitionIn",value:(u=o((function*(){yield d(h(f.prototype),"transitionIn",this).call(this),this.themeContent.restoreScrollPosition(),this.themeContent.listenEvents();var e=p.runTweenAsync(re(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();yield Promise.all([e,t])})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(r=o((function*(){yield d(h(f.prototype),"transitionOut",this).call(this),this.themeContent.preserveScrollPosition(),this.themeContent.unlistenUIEvents(),yield this.panelAnimationController.hideUI(),this.themeContent.unlistenEvents()})),function(){return r.apply(this,arguments)})}]),f}(aJ)).prototype,"panelAnimationController",[WX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(ZX.prototype,"mount",[KX],Object.getOwnPropertyDescriptor(ZX.prototype,"mount"),ZX.prototype),a(ZX.prototype,"onMount",[jX],Object.getOwnPropertyDescriptor(ZX.prototype,"onMount"),ZX.prototype),a(ZX.prototype,"transitionIn",[YX],Object.getOwnPropertyDescriptor(ZX.prototype,"transitionIn"),ZX.prototype),a(ZX.prototype,"transitionOut",[XX],Object.getOwnPropertyDescriptor(ZX.prototype,"transitionOut"),ZX.prototype),JX=ZX))||JX);X._RF.pop(),X._RF.push({},"2381b1mKt1PUq5W+fsaaOYP","PageManager",void 0);var $J,WJ,KJ,jJ,YJ,XJ,JJ,ZJ,QJ,eZ,tZ,nZ,iZ,aZ,oZ,rZ,lZ,sZ=Z.ccclass,uZ=Z.property,cZ=Z.disallowMultiple,dZ=Z.requireComponent,hZ=Ludex.Utils.Array,pZ=(oJ=sZ("PageManagerItem"),rJ=uZ(aJ),lJ=uZ({type:pe(Ln)}),oJ((cJ=a((uJ=e((function e(){t(this,e),l(this,"page",cJ,this),l(this,"pageType",dJ,this)}))).prototype,"page",[rJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dJ=a(uJ.prototype,"pageType",[lJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sJ=uJ))||sJ),yZ=(hJ=sZ("PageManager"),pJ=dZ(ne),yJ=Yn.required(),vJ=uZ({type:de,displayName:"Background Mask",group:"Background Mask"}),fJ=uZ({type:ae,displayName:"Transition duration",group:"Background Mask"}),gJ=uZ({type:ae,displayName:"Transition delay",group:"Background Mask"}),mJ=Yn.required(),bJ=uZ({type:de,displayName:"Nav Bar Shadow",group:"Nav Bar Shadow"}),wJ=uZ({type:ae,displayName:"Transition duration",group:"Nav Bar Shadow"}),SJ=uZ({type:ae,displayName:"Transition delay",group:"Nav Bar Shadow"}),kJ=uZ({type:[pZ]}),CJ=uZ({type:pe(Ln)}),EJ=Yn.required(),AJ=Yn.onlyRunInLifeCycleAsync,TJ=Yn.onlyRunInLifeCycleAsync,PJ=Yn.onlyRunInLifeCycle,LJ=Yn.onlyRunInLifeCycle,OJ=Yn.onlyRunInLifeCycle,IJ=Yn.onlyRunInLifeCycleAsync,RJ=Yn.onlyRunInLifeCycleAsync,_J=Yn.onlyRunInLifeCycleAsync,hJ(DJ=cZ(DJ=pJ((MJ=a((NJ=function(a){n(S,a);var r,u,d,h,v,f,g,m,b,w=i(S);function S(){var e;t(this,S);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=w.call.apply(w,[this].concat(i)),l(e,"backgroundMask",MJ,s(e)),l(e,"backgroundMaskTransitionDuration",FJ,s(e)),l(e,"backgroundMaskTransitionDelay",BJ,s(e)),l(e,"navBarShadow",xJ,s(e)),l(e,"navBarShadowTransitionDuration",zJ,s(e)),l(e,"navBarShadowTransitionDelay",UJ,s(e)),l(e,"pageItems",GJ,s(e)),l(e,"currentScreen",HJ,s(e)),l(e,"uiTransform",qJ,s(e)),e}return e(S,[{key:"unmountAndHideAll",value:function(){var e=this;this.pageItems.forEach((function(t){var n=t.page;t.pageType!==e.currentScreen&&(n.unmount(),n.hide())}))}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(ne),Yn.validateRequiredProperties(this),se.on(y.VIEW_RESIZED,this.init,this)}},{key:"onDestroy",value:function(){se.off(y.VIEW_RESIZED,this.init,this)}},{key:"init",value:function(){var e=this;this.pageItems.forEach((function(t,n){var i=t.page.getWidget(),a=e.getPageIndex(e.currentScreen);i.right=-(n-a)*e.uiTransform.width,i.left=(n-a)*e.uiTransform.width,i.updateAlignment()}))}},{key:"updateCollectionsContentPayload",value:function(e){var t=this.getPage(Ln.collections);t&&t instanceof VJ&&t.setPayload(e)}},{key:"navigate",value:(b=o((function*(e,t,n,i){var a=e.from,o=e.to;null!==a?yield this.navigateFromPage(a,o,t,n,i):yield this.navigateFromNull(o,n,i)})),function(e,t,n,i){return b.apply(this,arguments)})},{key:"navigateFromPage",value:(m=o((function*(e,t,n,i,a){var o=this,r=this.validateNavigationRequest(e,t),l=r.toPage,s=r.fromPage;this.currentScreen=t;var u=this.uiTransform.width,c=this.getPageIndex(e),d=this.getPageIndex(t),h=Math.min(c,d),p=Math.max(c,d),y=(p-h)*u,v=c<d?1:-1,f=this.pageItems.slice(h,p+1);f.forEach((function(e,t){var n=e.page;n.show(),n.getWidget().enabled=!1,n.node.position=new be((t+h-c)*u,n.node.position.y,n.node.position.z)}));var g=!l.hasLoadedPage();g&&this.showLoadingScreen();var m=this.pageItems.filter((function(e){return e.pageType!==t})),b=function(){return o.cleanupPages(l,m)};n.addAbortListener(b),yield this.mountPage(l,i),yield n.callAsync((function(){return o.performFullTransition({from:e,to:t,fromPage:s,toPage:l,distance:y,direction:v,items:f})})),n.removeAbortListener(b),n.call(b),yield n.callAsync((function(){return o.transitionInPage(l,a)})),g&&this.hideLoadingScreen()})),function(e,t,n,i,a){return m.apply(this,arguments)})},{key:"hideLoadingScreen",value:function(){x.closeLoadingScreen()}},{key:"showLoadingScreen",value:function(){x.showLoadingScreen()}},{key:"cleanupPages",value:function(e,t){var n=e.getWidget();n.enabled=!0,n.left=0,n.right=0,Re.instance.emit("canvas-resize");var i,a=c(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.page.unmount(),o.page.hide()}}catch(e){a.e(e)}finally{a.f()}}},{key:"performFullTransition",value:(g=o((function*(e){var t=e.from,n=e.to,i=e.fromPage,a=e.distance,o=e.direction,r=e.items,l=e.toPage;this.node.scene.emit(Tn,{from:t,to:n}),yield Promise.all([i.transitionOut(),this.transition(a,o,r),this.handleBackgroundMask(this.backgroundMaskTransitionDuration,l.getDarkenBackground()),this.handleNavBarShadow(this.navBarShadowTransitionDuration,l.getNavbarShadow())])})),function(e){return g.apply(this,arguments)})},{key:"mountPage",value:(f=o((function*(e,t){yield e.mount(),yield null==t?void 0:t(e)})),function(e,t){return f.apply(this,arguments)})},{key:"validateNavigationRequest",value:function(e,t){if(e!==this.currentScreen)throw new Error("PageManager: Cannot navigate from a different screen. Perhaps you forgot to update the currentScreen property.");var n=this.getPage(this.currentScreen),i=this.getPage(t);if(!i||!n)throw new Error("PageManager: Cannot navigate to/from a null page. Perhaps you forgot to add the page to the pageItems array in the editor.");return{toPage:i,fromPage:n}}},{key:"navigateFromNull",value:(v=o((function*(e,t,n){var i,a=this.getPage(this.currentScreen);a.show(),this.currentScreen=e,yield this.mountPage(a,t),null!==(i=this.node)&&void 0!==i&&i.scene&&(this.node.scene.emit(Tn,{from:null,to:e}),yield this.transitionInPage(a,n))})),function(e,t,n){return v.apply(this,arguments)})},{key:"transitionInPage",value:(h=o((function*(e,t){yield e.transitionIn(),yield null==t?void 0:t(e)})),function(e,t){return h.apply(this,arguments)})},{key:"getPage",value:function(e){var t,n,i=this.getPageIndex(e);return-1!==i&&null!==(t=null===(n=this.pageItems[i])||void 0===n?void 0:n.page)&&void 0!==t?t:null}},{key:"handleBackgroundMask",value:(d=o((function*(e,t){yield p.runTweenAsync(re(this.backgroundMask).delay(this.backgroundMaskTransitionDelay).to(e,{opacity:t}).start())})),function(e,t){return d.apply(this,arguments)})},{key:"handleNavBarShadow",value:(u=o((function*(e,t){yield p.runTweenAsync(re(this.navBarShadow).delay(this.navBarShadowTransitionDelay).to(e,{opacity:t}).start())})),function(e,t){return u.apply(this,arguments)})},{key:"getPageIndex",value:function(e){return hZ.searchIndex(this.pageItems,(function(t){return t.pageType===e}))}},{key:"transition",value:(r=o((function*(e,t,n){yield Promise.all(n.map((function(n){var i=n.page;return p.runTweenAsync(re(i.node).to(.5,{position:new be(i.node.position.x-e*t,i.node.position.y,i.node.position.z)},{easing:ye.quintInOut}))})))})),function(e,t,n){return r.apply(this,arguments)})}]),S}(te)).prototype,"backgroundMask",[yJ,vJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FJ=a(NJ.prototype,"backgroundMaskTransitionDuration",[fJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),BJ=a(NJ.prototype,"backgroundMaskTransitionDelay",[gJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),xJ=a(NJ.prototype,"navBarShadow",[mJ,bJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zJ=a(NJ.prototype,"navBarShadowTransitionDuration",[wJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),UJ=a(NJ.prototype,"navBarShadowTransitionDelay",[SJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),GJ=a(NJ.prototype,"pageItems",[kJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),HJ=a(NJ.prototype,"currentScreen",[CJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ln.home}}),qJ=a(NJ.prototype,"uiTransform",[EJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(NJ.prototype,"navigate",[AJ],Object.getOwnPropertyDescriptor(NJ.prototype,"navigate"),NJ.prototype),a(NJ.prototype,"navigateFromPage",[TJ],Object.getOwnPropertyDescriptor(NJ.prototype,"navigateFromPage"),NJ.prototype),a(NJ.prototype,"hideLoadingScreen",[PJ],Object.getOwnPropertyDescriptor(NJ.prototype,"hideLoadingScreen"),NJ.prototype),a(NJ.prototype,"showLoadingScreen",[LJ],Object.getOwnPropertyDescriptor(NJ.prototype,"showLoadingScreen"),NJ.prototype),a(NJ.prototype,"cleanupPages",[OJ],Object.getOwnPropertyDescriptor(NJ.prototype,"cleanupPages"),NJ.prototype),a(NJ.prototype,"performFullTransition",[IJ],Object.getOwnPropertyDescriptor(NJ.prototype,"performFullTransition"),NJ.prototype),a(NJ.prototype,"mountPage",[RJ],Object.getOwnPropertyDescriptor(NJ.prototype,"mountPage"),NJ.prototype),a(NJ.prototype,"navigateFromNull",[_J],Object.getOwnPropertyDescriptor(NJ.prototype,"navigateFromNull"),NJ.prototype),DJ=NJ))||DJ)||DJ)||DJ);X._RF.pop(),X._RF.push({},"f555belwQ1NHJr4np65OtcU","NavManager",void 0);var vZ,fZ,gZ,mZ,bZ,wZ,SZ,kZ,CZ,EZ,AZ,TZ,PZ,LZ,OZ,IZ,RZ,_Z,DZ,NZ,MZ,FZ,BZ,xZ,zZ,UZ,GZ,HZ,qZ,VZ,$Z,WZ,KZ,jZ,YZ,XZ,JZ,ZZ,QZ,eQ,tQ,nQ,iQ=Z.ccclass,aQ=Z.property,oQ=Ludex.Utils,rQ=oQ.Array,lQ=oQ.Signal,sQ=m.Layout,uQ=($J=iQ("NavManager"),WJ=aQ(me),KJ=aQ(me),jJ=aQ(Sn),YJ=aQ({type:oe,group:"Widgets"}),XJ=aQ({type:oe,group:"Widgets"}),JJ=aQ({type:oe,group:"Widgets"}),ZJ=aQ(ne),$J((tZ=a((eZ=function(a){n(g,a);var r,u,d,h,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"selectorNode",tZ,s(e)),l(e,"selectedButtonNode",nZ,s(e)),l(e,"autoLayout",iZ,s(e)),l(e,"navWidget",aZ,s(e)),l(e,"backgroundWidget",oZ,s(e)),l(e,"layoutWidget",rZ,s(e)),l(e,"uiTransform",lZ,s(e)),e.navButtons=[],e.selectorAnimationSignal=new lQ.SignalController,e.isNavigating=!1,e}return e(g,[{key:"currentButton",get:function(){return this.selectedButton}},{key:"onLoad",value:function(){var e;this.navButtons=this.node.getComponentsInChildren("NavButton"),this.selectedButton=null===(e=this.selectedButtonNode)||void 0===e?void 0:e.getComponentInChildren("NavButton"),se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),se.on(y.VIEW_RESIZED,this.handleViewResized,this),this.handleOrientationChanged(P.getCurrentLayout())}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),se.off(y.VIEW_RESIZED,this.handleViewResized,this)}},{key:"select",value:(v=o((function*(e){var t=this;if(!this.isNavigating){if(!rQ.has(this.navButtons,e))throw new Error("NavManager: Button not found");if(e!==this.selectedButton){if(!e.isWIP)return this.isNavigating=!0,this.node.scene.emit(An,{from:this.selectedButton.buttonType,to:e.buttonType}),new Promise((function(n){t.node.scene.once(Tn,(function(){var i=t.selectedButton.deselect();t.autoLayout.selectedIndex=t.navButtons.indexOf(e),t.selectedButton=e;var a=t.autoLayout.getSelectedWorldX()-e.getSelectedWorldDistanceX(),o=t.playSelectorAnimation(a),r=e.select();Promise.all([i,r,o]).then((function(){t.isNavigating=!1,n()}))}))}));this.handleWIPButton()}}})),function(e){return v.apply(this,arguments)})},{key:"selectUsingSceneTransition",value:(h=o((function*(e){this.isNavigating||(rQ.has([Ln.store],e.buttonType)?this.handleWIPButton():yield this.select(e))})),function(e){return h.apply(this,arguments)})},{key:"selectByType",value:(d=o((function*(e){var t=rQ.search(this.navButtons,(function(t){return t.buttonType===e}));if(!t)throw new Error("NavManager: Button not found");yield this.selectUsingSceneTransition(t)})),function(e){return d.apply(this,arguments)})},{key:"handleWIPButton",value:function(){x.openScreen(z.STAR_CHEST_SCREEN)}},{key:"selectDefaultNavBtn",value:(u=o((function*(){var e=this;if(!this.currentButton||!rQ.has(this.navButtons,this.currentButton))throw new Error("NavManager: Button not found");var t=this.currentButton.buttonType;return this.node.scene.emit(An,{from:null,to:t}),new Promise((function(t){e.node.scene.once(Tn,(function(){e.autoLayout.selectedIndex=e.navButtons.indexOf(e.currentButton);var n=e.navButtons.map((function(t){return t===e.currentButton?t.select(!1):t.deselect(!1,!0)})),i=e.autoLayout.getSelectedWorldX()-e.currentButton.getSelectedWorldDistanceX();e.selectorNode.worldPosition=new be(i,e.selectorNode.worldPosition.y,0),Promise.all(n).then((function(){t()}))}))}))})),function(){return u.apply(this,arguments)})},{key:"playSelectorAnimation",value:(r=o((function*(e){var t=this,n=this.selectorAnimationSignal.renew(),i=new be(1,1,1),a=this.selectorNode.worldPosition.clone(),o=new be(1.2*i.x,.8*i.y,1),r=re(this.selectorNode).to(.3,{worldPosition:new be(e,a.y,0)},{easing:"quintInOut",onUpdate:function(e,n){if(void 0!==n){var a=t.calculateCurrentSquashScale(i,o,n);t.selectorNode.scale=a}}});yield p.runTweenAsync(r,n),this.selectorNode.scale=i})),function(e){return r.apply(this,arguments)})},{key:"setIgnoreInput",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=c(this.navButtons);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.getComponentInChildren(fe);a&&(a.interactable=!t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"calculateCurrentSquashScale",value:function(e,t,n){var i=this.splitIntoSquashRatio(n);return e.clone().lerp(t,i)}},{key:"splitIntoSquashRatio",value:function(e){return e<.5?2*e:1-2*(e-.5)}},{key:"handleOrientationChanged",value:function(e){e===sQ.Portrait?(this.navWidget.isAlignLeft=!0,this.navWidget.isAlignRight=!0,this.backgroundWidget.left=-50,this.backgroundWidget.right=-50,this.layoutWidget.left=0,this.layoutWidget.right=0):e===sQ.Landscape&&(this.navWidget.isAlignLeft=!1,this.navWidget.isAlignRight=!1,this.backgroundWidget.left=0,this.backgroundWidget.right=0,this.layoutWidget.left=25,this.layoutWidget.right=25,this.uiTransform.width=1e3)}},{key:"handleViewResized",value:function(){this.selectedButton&&(this.selectorAnimationSignal.abort(),this.selectorNode.worldPositionX=this.selectedButton.node.worldPosition.x,this.selectorNode.y=-164.5)}}]),g}(te)).prototype,"selectorNode",[WJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nZ=a(eZ.prototype,"selectedButtonNode",[KJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iZ=a(eZ.prototype,"autoLayout",[jJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aZ=a(eZ.prototype,"navWidget",[YJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oZ=a(eZ.prototype,"backgroundWidget",[XJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rZ=a(eZ.prototype,"layoutWidget",[JJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lZ=a(eZ.prototype,"uiTransform",[ZJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QJ=eZ))||QJ);X._RF.pop(),X._RF.push({},"d48a1TnKg1F4YRzzKmQOD5k","DashboardScene",void 0);var cQ,dQ=Z.ccclass,hQ=Z.disallowMultiple,pQ=Z.property,yQ=codex,vQ=yQ.storage,fQ=yQ.player,gQ=yQ.monitorError,mQ=Ludex,bQ=mQ.Match.Modes,wQ=mQ.Utils.Array;vZ=dQ("DashboardScene"),fZ=Yn.required(),gZ=pQ(ek),mZ=Yn.required(),bZ=pQ(uQ),wZ=Yn.required(),SZ=pQ(Gi),kZ=Yn.required(),CZ=pQ(yZ),EZ=Yn.required(),AZ=pQ(IH),TZ=Yn.required(),PZ=pQ(qr),LZ=Yn.onlyRunInLifeCycle,OZ=Yn.onlyRunInLifeCycle,IZ=Yn.onlyRunInLifeCycle,RZ=Yn.onlyRunInLifeCycle,_Z=Yn.onlyRunInLifeCycle,DZ=Yn.onlyRunInLifeCycle,NZ=Yn.onlyRunInLifeCycle,MZ=Yn.onlyRunInLifeCycleAsync,FZ=Yn.onlyRunInLifeCycleAsync,BZ=Yn.onlyRunInLifeCycleAsync,xZ=Yn.onlyRunInLifeCycleAsync,zZ=Yn.onlyRunInLifeCycle,UZ=Yn.onlyRunInLifeCycleAsync,GZ=Yn.onlyRunInLifeCycleAsync,HZ=Yn.onlyRunInLifeCycleAsync,qZ=Yn.onlyRunInLifeCycleAsync,VZ=Yn.onlyRunInLifeCycleAsync,$Z=Yn.onlyRunInLifeCycleAsync,WZ=Yn.onlyRunInLifeCycle,KZ=Yn.onlyRunInLifeCycleAsync,jZ=Yn.onlyRunInLifeCycle,vZ(YZ=hQ((JZ=a((XZ=function(a){n(L,a);var d,h,y,v,f,g,m,b,S,k,C,E,A,T,P=i(L);function L(){var e;t(this,L);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=P.call.apply(P,[this].concat(i)),l(e,"coinManager",JZ,s(e)),l(e,"navManager",ZZ,s(e)),l(e,"bgComp",QZ,s(e)),l(e,"pageManager",eQ,s(e)),l(e,"pageAnimSkipOverlay",tQ,s(e)),l(e,"transitionOpacityToggler",nQ,s(e)),e.firstNavigation=!0,e.isFirstNavToCollections=!0,e.isFirstNavToTournament=!0,e.navigationSignal=null,e}return e(L,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.listenNavigationEvents(),this.listenDashboardEvents(),JF.createLayer(this.node,"Particles",6),this.coinManager.init(),gv.init(),this.setPlayerLevel(),this.updateBackgroundImageToCurrentTheme(),this.pageManager.updateCollectionsContentPayload(gv.getCollectionUnlockProgress())}},{key:"listenNavigationEvents",value:function(){this.node.scene.on(An,this.onNavigate,this)}},{key:"listenDashboardEvents",value:function(){this.node.scene.on(Cn,this.handleDashboardPlayButtonPress,this),this.node.scene.on(En,this.handleCustomPlayButtonPress,this),this.node.scene.on(Pn,this.handleEventButtonPress,this)}},{key:"setPlayerLevel",value:function(){var e,t=(null!==(e=fQ.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;n=0===n?1:n,fQ.setGameData({level:n})}},{key:"start",value:function(){fQ.getPlayerSetting("music")&&this.updateMusic(),this.pageManager.init(),this.navManager.selectDefaultNavBtn(),this.scheduleOnce(this.preloadScene,5),this.scheduleOnce(this.preloadSkins,3),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScene",value:function(){G.isSceneLoaded(W.GAME_SCENE)||G.preloadGameScene()}},{key:"preloadScreens",value:function(){var e;x.preloadScreen(z.LOADING_SCREEN),x.preloadScreen(z.NOTIFICATION_SCREEN),x.preloadScreen(z.SETTINGS_SCREEN),x.preloadScreen(z.GET_COIN_SCREEN),x.preloadScreen(z.STAR_CHEST_SCREEN),x.preloadScreen(z.DAILY_REWARDS_SCREEN);var t=fQ.getGameData();(null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1)>=13&&x.preloadScreen(z.CUSTOM_GAME_SCREEN)}},{key:"preloadSkins",value:function(){var e,t=gv.getUnlockedSkins(),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a="".concat(D.TILE_SKIN_FOLDER,"/").concat(i);r.loadSpriteFramesDirAsync(a)}}catch(e){n.e(e)}finally{n.f()}}},{key:"attemptCallSubscribeBot",value:function(){GameSDK.isGameSDK("FacebookInstant")&&GameSDK.extra.checkAndSubscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))}},{key:"updateBackgroundImageToCurrentTheme",value:function(){var e,t=vQ.getStorage("dashboard");if(null!=t){var n=null!==(e=t.animateToCurrentLevel)&&void 0!==e&&e,i=u({},t.lastMapPayload),a=gv.getCurrentMapProgress(),o=i.currentTheme===a.currentTheme&&i.nextTheme===a.nextTheme,r=a.currentTheme;!n||o||this.isDevToolTimeTravel(i.id,a.id)?this.bgComp.setCurrentTheme(r):this.bgComp.setCurrentTheme(i.currentTheme)}else null==gQ||gQ.sendException(new Error("DashboardScene: dashboardStorage not found"))}},{key:"isDevToolTimeTravel",value:function(e,t){return wQ.searchIndex(dv.mapOrder,(function(t){return t.id===e}))>wQ.searchIndex(dv.mapOrder,(function(e){return e.id===t}))}},{key:"handleDashboardPlayButtonPress",value:function(){this.handlePlayButtonPress(bQ.SINGLE)}},{key:"handleCustomPlayButtonPress",value:function(){this.handlePlayButtonPress(Nv)}},{key:"handlePlayButtonPress",value:(T=o((function*(e){try{var t;F.setBlockInput(!0);var n=gv.getCurrentMapProgress(),i=(null!==(t=fQ.getGameData())&&void 0!==t?t:{}).level,a=void 0===i?1:i;yield Iv.setMatchCustomDataAsync({level:a}),yield Iv.startMatchAsync(e),this.updateCurrentMapInStorage(n),vQ.setStorageData("collection","lastMapPack",n.id),vQ.setStorageData("collection","animateMapPackUnlock",!1),yield this.switchToGameScene(a)}catch(e){F.setBlockInput(!1),console.error(e)}})),function(e){return T.apply(this,arguments)})},{key:"switchToGameScene",value:(A=o((function*(e){G.isSceneLoaded(W.GAME_SCENE)&&(yield this.transitionOpacityToggler.changeStateFade(!0,.25)),G.switchToGameScene({level:e})})),function(e){return A.apply(this,arguments)})},{key:"updateCurrentMapInStorage",value:function(e){vQ.setStorageData("dashboard","animateToCurrentLevel",!1),vQ.setStorageData("dashboard","lastMapPayload",e)}},{key:"updateMusic",value:(E=o((function*(){w.getCurrentMusic()!==Qi.BG_MUSIC&&(yield w.setVolumeMusic(0,!0),yield p.waitTweenAsync(1)),w.playMusic(Qi.BG_MUSIC),w.turnUpMusic()})),function(){return E.apply(this,arguments)})},{key:"onNavigate",value:(C=o((function*(e){switch(this.firstNavigation&&(this.firstNavigation=!1,this.pageManager.unmountAndHideAll()),e.to){case Ln.store:break;case Ln.collections:yield this.triggerPageNavigation(e),yield this.handleLogicAfterNavigateToCollections(),this.cleanupAfterPageNavigation();break;case Ln.tournaments:x.preloadScreen(z.TOURNAMENT_DETAIL_SCREEN),yield this.triggerPageNavigation(e),this.cleanupAfterPageNavigation();break;case Ln.leaderboard:yield this.triggerPageNavigation(e),this.cleanupAfterPageNavigation();break;case Ln.home:yield this.handleNavigateToHome(e);break;default:throw new Error("DashboardScene: Unhandled page name")}})),function(e){return C.apply(this,arguments)})},{key:"handleLogicAfterNavigateToCollections",value:(k=o((function*(){var e,t=null===(e=this.pageManager.getPage(Ln.collections))||void 0===e?void 0:e.getContainer().getComponentInChildren(M$);if(null==t)throw new Error("CollectionsContent not found");var n=new Mi,i=t.shouldAnimateThemeBlockUnlock();i&&(yield this.openSkipOverlay(n)),yield this.tryPlayScrollToCollectionAnim(t,n),yield t.playThemeTabUnlockAnim(n),i&&(yield this.closeSkipOverlay()),n.abort()})),function(){return k.apply(this,arguments)})},{key:"closeSkipOverlay",value:(S=o((function*(){yield this.pageAnimSkipOverlay.close()})),function(){return S.apply(this,arguments)})},{key:"openSkipOverlay",value:(b=o((function*(e){yield this.pageAnimSkipOverlay.open({onSkip:function(){return e.abort()},opacity:200})})),function(e){return b.apply(this,arguments)})},{key:"tryPlayScrollToCollectionAnim",value:(m=o((function*(e,t){var n=gv.getCurrentUnlockingThemeIndex();this.isFirstNavToCollections&&null!==n&&(yield e.scrollToCurrentUnlockingTheme(n,t),this.isFirstNavToCollections=!1)})),function(e,t){return m.apply(this,arguments)})},{key:"cleanupAfterPageNavigation",value:function(){this.navManager.setIgnoreInput(!1)}},{key:"triggerPageNavigation",value:(g=o((function*(e){var t;null===(t=this.navigationSignal)||void 0===t||t.abort(),this.navigationSignal=new Mi,yield this.pageManager.navigate(e,this.navigationSignal)})),function(e){return g.apply(this,arguments)})},{key:"handleNavigateToHome",value:(f=o((function*(e){var t,n=this;null===(t=this.navigationSignal)||void 0===t||t.abort(),this.navigationSignal=new Mi,yield this.pageManager.navigate(e,this.navigationSignal,o((function*(){n.initializeHomepageCoinManager()}))),yield this.handleLogicAfterNavigateToHome()})),function(e){return f.apply(this,arguments)})},{key:"handleLogicAfterNavigateToHome",value:(v=o((function*(){Xq.hasShownPopup()||this.shouldPlayLevelUpAnimation()||(yield Xq.hasClaimableRewards())&&(yield Xq.openPopupScreenAndWaitForClose()),this.attemptCallSubscribeBot(),yield this.waitUntilCoinManagerFinishesAnyAnimation(),yield this.waitUntilPageAnimSkipOverlayCloses(),yield this.tryNavigateToTournament(),yield this.tryPlayLevelUpAnimation(),yield this.tryShowCustomModeGuide()})),function(){return v.apply(this,arguments)})},{key:"waitUntilCoinManagerFinishesAnyAnimation",value:function(){return this.coinManager.untilFinishesCollectAnim()}},{key:"waitUntilPageAnimSkipOverlayCloses",value:function(){return this.pageAnimSkipOverlay.untilClosed()}},{key:"tryNavigateToTournament",value:(y=o((function*(){if(vQ.getStorage("tournament").animateTournamentLeader)return yield this.navManager.selectByType(Ln.tournaments);if(this.isFirstNavToTournament){this.isFirstNavToTournament=!1;try{if(!("getTournamentAsync"in GameSDK))throw new Error("Unavailable feature: tournament");if((yield GameSDK.getTournamentAsync()).getEndTime()<Date.now()/1e3)return yield this.navManager.selectByType(Ln.tournaments)}catch(e){}}})),function(){return y.apply(this,arguments)})},{key:"shouldPlayLevelUpAnimation",value:function(){var e;if(!this.enabledInHierarchy)return!1;var t=null===(e=this.pageManager.getPage(Ln.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(VX);if(null==t)return!1;var n=t.shouldPlayUnlockAnimation(),i=this.shouldPlayPackUnlockAnimation();return n||i}},{key:"tryPlayLevelUpAnimation",value:(h=o((function*(){var e,t=this,n=null===(e=this.pageManager.getPage(Ln.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(VX);if(null==n)throw new Error("DashboardScene: Homepage not found");var i=new Mi;this.navigationSignal&&i.chain(this.navigationSignal);var a=n.shouldPlayUnlockAnimation(),o=this.shouldPlayPackUnlockAnimation();a&&(o&&(yield this.pageAnimSkipOverlay.open({onSkip:function(){return i.abort()},opacity:150})),yield n.playUnlockProgressAnimation(i),this.updateBackgroundImageToCurrentTheme(),o&&(yield this.pageAnimSkipOverlay.close(),yield i.callAsync((function(){return t.navManager.selectByType(Ln.collections)}))))})),function(){return h.apply(this,arguments)})},{key:"shouldPlayPackUnlockAnimation",value:function(){var e=vQ.getStorage("dashboard");if(null==e)throw new Error("DashboardScene: dashboardStorage not found");var t=e.lastMapPayload,n=gv.getCurrentMapProgress();return!(wQ.searchIndex(dv.mapOrder,(function(e){return e.id===t.id}))===wQ.searchIndex(dv.mapOrder,(function(e){return e.id===n.id})))}},{key:"initializeHomepageCoinManager",value:function(){var e,t=null===(e=this.pageManager.getPage(Ln.home))||void 0===e?void 0:e.getContainer().getComponentInChildren(VX);if(null==t)throw new Error("DashboardScene: Homepage not found");this.coinManager.setTargetContainer(t.getCoinContainer()),this.coinManager.emitCoinAmount()}},{key:"tryShowCustomModeGuide",value:(d=o((function*(){var e,t,n=null!==(e=fQ.getGameData())&&void 0!==e?e:{},i=n.level,a=void 0===i?1:i,o=n.guideItemShowed,r=void 0===o?[]:o;if(13===a&&!wQ.has(r,qI)){r.push(qI),fQ.setGameData({guideItemShowed:r});var l=null===(t=this.pageManager.getPage(Ln.home))||void 0===t?void 0:t.getContainer().getComponentInChildren(VX);if(null==l)throw new Error("DashboardScene: Homepage not found");yield l.showCustomGuide()}})),function(){return d.apply(this,arguments)})},{key:"handleEventButtonPress",value:function(e){switch(e.type){case tG.STAR_CHEST:x.openScreen(z.STAR_CHEST_SCREEN);break;case tG.DAILY_REWARDS:Xq.openPopupScreen();break;case tG.BALLOON:x.showNotificationScreenWithLocalizedKey("error.soon");break;default:throw new Error("DashboardScene: Unhandled event button type")}}},{key:"handleTestLayoutButtonClicked",value:function(){}}]),L}(te)).prototype,"coinManager",[fZ,gZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZZ=a(XZ.prototype,"navManager",[mZ,bZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QZ=a(XZ.prototype,"bgComp",[wZ,SZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eQ=a(XZ.prototype,"pageManager",[kZ,CZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tQ=a(XZ.prototype,"pageAnimSkipOverlay",[EZ,AZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nQ=a(XZ.prototype,"transitionOpacityToggler",[TZ,PZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(XZ.prototype,"preloadScene",[LZ],Object.getOwnPropertyDescriptor(XZ.prototype,"preloadScene"),XZ.prototype),a(XZ.prototype,"preloadScreens",[OZ],Object.getOwnPropertyDescriptor(XZ.prototype,"preloadScreens"),XZ.prototype),a(XZ.prototype,"preloadSkins",[IZ],Object.getOwnPropertyDescriptor(XZ.prototype,"preloadSkins"),XZ.prototype),a(XZ.prototype,"attemptCallSubscribeBot",[RZ],Object.getOwnPropertyDescriptor(XZ.prototype,"attemptCallSubscribeBot"),XZ.prototype),a(XZ.prototype,"updateBackgroundImageToCurrentTheme",[_Z],Object.getOwnPropertyDescriptor(XZ.prototype,"updateBackgroundImageToCurrentTheme"),XZ.prototype),a(XZ.prototype,"handleDashboardPlayButtonPress",[DZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handleDashboardPlayButtonPress"),XZ.prototype),a(XZ.prototype,"handleCustomPlayButtonPress",[NZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handleCustomPlayButtonPress"),XZ.prototype),a(XZ.prototype,"handlePlayButtonPress",[MZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handlePlayButtonPress"),XZ.prototype),a(XZ.prototype,"onNavigate",[FZ],Object.getOwnPropertyDescriptor(XZ.prototype,"onNavigate"),XZ.prototype),a(XZ.prototype,"handleLogicAfterNavigateToCollections",[BZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handleLogicAfterNavigateToCollections"),XZ.prototype),a(XZ.prototype,"tryPlayScrollToCollectionAnim",[xZ],Object.getOwnPropertyDescriptor(XZ.prototype,"tryPlayScrollToCollectionAnim"),XZ.prototype),a(XZ.prototype,"cleanupAfterPageNavigation",[zZ],Object.getOwnPropertyDescriptor(XZ.prototype,"cleanupAfterPageNavigation"),XZ.prototype),a(XZ.prototype,"triggerPageNavigation",[UZ],Object.getOwnPropertyDescriptor(XZ.prototype,"triggerPageNavigation"),XZ.prototype),a(XZ.prototype,"handleNavigateToHome",[GZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handleNavigateToHome"),XZ.prototype),a(XZ.prototype,"waitUntilCoinManagerFinishesAnyAnimation",[HZ],Object.getOwnPropertyDescriptor(XZ.prototype,"waitUntilCoinManagerFinishesAnyAnimation"),XZ.prototype),a(XZ.prototype,"waitUntilPageAnimSkipOverlayCloses",[qZ],Object.getOwnPropertyDescriptor(XZ.prototype,"waitUntilPageAnimSkipOverlayCloses"),XZ.prototype),a(XZ.prototype,"tryNavigateToTournament",[VZ],Object.getOwnPropertyDescriptor(XZ.prototype,"tryNavigateToTournament"),XZ.prototype),a(XZ.prototype,"tryPlayLevelUpAnimation",[$Z],Object.getOwnPropertyDescriptor(XZ.prototype,"tryPlayLevelUpAnimation"),XZ.prototype),a(XZ.prototype,"initializeHomepageCoinManager",[WZ],Object.getOwnPropertyDescriptor(XZ.prototype,"initializeHomepageCoinManager"),XZ.prototype),a(XZ.prototype,"tryShowCustomModeGuide",[KZ],Object.getOwnPropertyDescriptor(XZ.prototype,"tryShowCustomModeGuide"),XZ.prototype),a(XZ.prototype,"handleEventButtonPress",[jZ],Object.getOwnPropertyDescriptor(XZ.prototype,"handleEventButtonPress"),XZ.prototype),YZ=XZ))||YZ);X._RF.pop(),X._RF.push({},"1be4fAboTNK3IFk6IiygYLZ","PageContent",void 0);var SQ,kQ,CQ,EQ,AQ,TQ,PQ,LQ=Z.ccclass,OQ=m.Layout;LQ("PageContent")(cQ=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"__preload",value:function(){this.widget=this.getComponent(oe),this.uiTransform=this.getComponent(ne)}},{key:"onLoad",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(P.getCurrentLayout())}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(e){e===OQ.Portrait?(this.widget.isAlignLeft=!0,this.widget.isAlignRight=!0):e===OQ.Landscape&&(this.widget.isAlignLeft=!1,this.widget.isAlignRight=!1,this.uiTransform.width=1e3)}}]),r}(te));X._RF.pop(),X._RF.push({},"c68178FyxlCOqbCt/+wktvw","PageHeader",void 0);var IQ,RQ,_Q,DQ,NQ,MQ,FQ,BQ,xQ,zQ,UQ,GQ,HQ=Z.ccclass,qQ=Z.property,VQ=m.Layout;SQ=HQ("PageHeader"),kQ=Yn.required(),CQ=qQ(oe),EQ=Yn.onlyRunInLifeCycleAsync,SQ((PQ=a((TQ=function(a){n(h,a);var u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"widget",PQ,s(e)),e}return e(h,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,h),P.isLandscape()&&this.loadLeaves()}},{key:"onLoad",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(P.getCurrentLayout())}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:(c=o((function*(e){e===VQ.Portrait?(this.leaves&&(this.leaves.active=!1),this.widget.left=-80,this.widget.right=-80):e===VQ.Landscape&&(this.widget.left=0,this.widget.right=0,yield this.loadLeaves(),this.leaves&&(this.leaves.active=!0))})),function(e){return c.apply(this,arguments)})},{key:"loadLeaves",value:(u=o((function*(){if(!this.leaves){var e=yield r.loadPrefabAsync(D.PAGE_LEAVES_PREFAB);!this.leaves&&e&&this.enabledInHierarchy&&(this.leaves=qe(e),this.node.addChild(this.leaves))}})),function(){return u.apply(this,arguments)})}]),h}(te)).prototype,"widget",[kQ,CQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(TQ.prototype,"loadLeaves",[EQ],Object.getOwnPropertyDescriptor(TQ.prototype,"loadLeaves"),TQ.prototype),AQ=TQ));X._RF.pop(),X._RF.push({},"53f87ljsxFJUKsBbXk8WVkJ","HomePage",void 0);var $Q,WQ,KQ,jQ,YQ,XQ,JQ,ZQ,QQ,e0,t0,n0,i0=Z.ccclass,a0=Z.property,o0=codex,r0=o0.player,l0=o0.storage,s0=o0.monitorError,u0=Ludex.Utils.Number;IQ=i0("HomePage"),RQ=Yn.required(),_Q=a0({type:ke,group:"Placeholders"}),DQ=Yn.required(),NQ=Yn.onlyRunInLifeCycleAsync,MQ=Yn.onlyRunInLifeCycle,FQ=Yn.onlyRunInLifeCycleAsync,BQ=Yn.onlyRunInLifeCycleAsync,IQ((UQ=a((zQ=function(a){n(f,a);var r,c,p,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"coinLabel",UQ,s(e)),l(e,"panelAnimationController",GQ,s(e)),e}return e(f,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(fu),d(h(f.prototype),"onLoad",this).call(this)}},{key:"onEnable",value:function(){this.node.scene.on(Js.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"onDisable",value:function(){this.node.scene.off(Js.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"updatePlaceholderCoins",value:(y=o((function*(e){this.coinLabel.string=u0.getShortNumber(e.coins,3)})),function(e){return y.apply(this,arguments)})},{key:"mount",value:(p=o((function*(){yield d(h(f.prototype),"mount",this).call(this),this.onMount()})),function(){return p.apply(this,arguments)})},{key:"onMount",value:function(){var e;if(!this.homeContent&&(this.homeContent=this.container.getComponentInChildren(VX),!this.homeContent))throw new Error("HomePage: homeContent not found");var t=(null!==(e=r0.getGameData())&&void 0!==e?e:{}).coins,n=void 0===t?0:t;this.updatePlaceholderCoins({coins:n}),this.homeContent.updateStatus(),this.initUnlockProgressData()}},{key:"initUnlockProgressData",value:function(){var e=this.homeContent.shouldPlayUnlockAnimation(),t=u({},gv.getCurrentMapProgress()),n=l0.getStorage("dashboard");if(null==n)return null==s0||s0.sendException(new Error("DashboardScene: dashboardStorage not found")),void(e||this.homeContent.setUnlockProgress(t));var i=u({},n.lastMapPayload);e?this.homeContent.setUnlockProgress(i):this.homeContent.setUnlockProgress(t)}},{key:"transitionIn",value:(c=o((function*(){this.homeContent.transitionIn(),yield d(h(f.prototype),"transitionIn",this).call(this),yield this.panelAnimationController.showUI()})),function(){return c.apply(this,arguments)})},{key:"transitionOut",value:(r=o((function*(){this.homeContent.transitionOut(),yield d(h(f.prototype),"transitionOut",this).call(this),yield this.panelAnimationController.hideUI()})),function(){return r.apply(this,arguments)})},{key:"hasLoadedPage",value:function(){return!0}}]),f}(aJ)).prototype,"coinLabel",[RQ,_Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GQ=a(zQ.prototype,"panelAnimationController",[DQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(zQ.prototype,"mount",[NQ],Object.getOwnPropertyDescriptor(zQ.prototype,"mount"),zQ.prototype),a(zQ.prototype,"onMount",[MQ],Object.getOwnPropertyDescriptor(zQ.prototype,"onMount"),zQ.prototype),a(zQ.prototype,"transitionIn",[FQ],Object.getOwnPropertyDescriptor(zQ.prototype,"transitionIn"),zQ.prototype),a(zQ.prototype,"transitionOut",[BQ],Object.getOwnPropertyDescriptor(zQ.prototype,"transitionOut"),zQ.prototype),xQ=zQ));X._RF.pop(),X._RF.push({},"73dd1GUhlNKPJc27Ls4gr6D","JoinLeaderboardContainer",void 0);var c0,d0,h0,p0,y0,v0,f0,g0,m0,b0,w0,S0,k0,C0,E0,A0,T0,P0,L0,O0,I0=Z.ccclass,R0=Z.property,_0=($Q=I0("JoinLeaderboardContainer"),WQ=Yn.required(),KQ=R0(oe),jQ=Yn.required(),YQ=R0(ne),XQ=Yn.required(),JQ=R0(me),$Q((e0=a((QQ=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"widget",e0,s(e)),l(e,"uiTransform",t0,s(e)),l(e,"joinButton",n0,s(e)),e}return e(c,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,c)}},{key:"updatePosition",value:function(e){void 0!==e?(this.widget.enabled=!1,this.node.setWorldPosition(this.node.worldPosition.x,e,this.node.worldPosition.z)):(this.widget.enabled=!0,this.widget.updateAlignment())}},{key:"show",value:(r=o((function*(e){if(null==e||!e.aborted){this.joinButton.active=!0;var t=re(this.joinButton).set({scale:be.ZERO}).to(.5,{scale:be.ONE},{easing:"backOut"});yield p.runTweenAsync(t,e)}})),function(e){return r.apply(this,arguments)})},{key:"hide",value:function(){this.joinButton.active=!1}}]),c}(te)).prototype,"widget",[WQ,KQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t0=a(QQ.prototype,"uiTransform",[jQ,YQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n0=a(QQ.prototype,"joinButton",[XQ,JQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZQ=QQ))||ZQ);X._RF.pop(),X._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var D0,N0,M0,F0,B0,x0,z0,U0=Z.ccclass,G0=Z.property,H0=Z.requireComponent,q0=codex.analytics,V0=Ludex,$0=V0.Utils,W0=$0.Array,K0=$0.Valid,j0=V0.Plugins.Analytics,Y0=(void 0===j0?{}:j0).Events,X0=(c0=U0("SwitchButton"),d0=H0([fe,ze]),h0=G0(Se),p0=G0(me),y0=G0(me),v0=G0(Se),f0=G0({visible:function(){return this.useSound},type:ta}),g0=G0(Se),m0=G0({visible:function(){return this.useDesktopHover},type:Ue}),b0=G0({visible:function(){return this.useDesktopHover},type:Ue}),c0(w0=d0((k0=a((S0=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"enable",k0,s(e)),l(e,"nodeOn",C0,s(e)),l(e,"nodeOff",E0,s(e)),l(e,"useSound",A0,s(e)),l(e,"soundKey",T0,s(e)),l(e,"useDesktopHover",P0,s(e)),l(e,"mouseEnterClip",L0,s(e)),l(e,"mouseLeaveClip",O0,s(e)),e.isMouseLeaved=!1,e.onMouseEnter=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved=!1,e.animationComponent.play(e.mouseEnterClip.name))},e.onMouseLeave=function(t){e.useDesktopHover&&e.buttonComponent.interactable&&(e.isMouseLeaved||(e.isMouseLeaved=!0,e.animationComponent.play(e.mouseLeaveClip.name)))},e}return e(r,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(fe),this.animationComponent=this.getComponent(ze),this.validateRequiredComponents()}},{key:"onLoad",value:function(){var e=this.animationComponent.clips.map((function(e){return null==e?void 0:e.name})).filter((function(e){return null!=e&&"string"==typeof e}));this.useDesktopHover&&(W0.has(e,this.mouseEnterClip.name)||this.animationComponent.addClip(this.mouseEnterClip),W0.has(e,this.mouseLeaveClip.name)||this.animationComponent.addClip(this.mouseLeaveClip))}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.node.on(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"switch",value:function(){return!!this.node.active&&(Y0&&q0.event(Y0.BUTTON_CLICK,{button_name:this.node.name,enable:!this.enable}),this.useSound&&K0.isString(this.soundKey)&&w.playSound(Ra[this.soundKey]),this.updateStatus(!this.enable))}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable===e||(this.onMouseLeave(null),this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e),this.enable}}]),r}(te)).prototype,"enable",[h0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C0=a(S0.prototype,"nodeOn",[p0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E0=a(S0.prototype,"nodeOff",[y0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A0=a(S0.prototype,"useSound",[v0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),T0=a(S0.prototype,"soundKey",[f0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ta[Qi.BUTTON_CLICK]}}),P0=a(S0.prototype,"useDesktopHover",[g0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),L0=a(S0.prototype,"mouseEnterClip",[m0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O0=a(S0.prototype,"mouseLeaveClip",[b0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w0=S0))||w0)||w0);X._RF.pop(),X._RF.push({},"2871awUXL9J0I+rBEFNHN7o","Tabs",void 0);var J0,Z0,Q0,e1,t1,n1,i1,a1,o1,r1=Z.ccclass,l1=Z.property,s1=codex.analytics,u1=Ludex.Plugins.Analytics,c1=(void 0===u1?{}:u1).Events,d1=(D0=r1("Tabs"),N0=l1(X0),M0=l1(X0),D0((x0=a((B0=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"tabDaily",x0,s(e)),l(e,"tabWeekly",z0,s(e)),e}return e(r,[{key:"setInteractableButtons",value:function(e){this.tabDaily.getComponent(fe).interactable=e,this.tabWeekly.getComponent(fe).interactable=e}},{key:"updateStatus",value:function(e){this.tabDaily.setEnabled(e===rv),this.tabWeekly.setEnabled(e===lv)}},{key:"handleTabDailySelect",value:function(){this.tabDaily.setEnabled(!0),this.tabWeekly.setEnabled(!1),w.playSound(Qi.BUTTON_CLICK),c1&&s1.event(c1.BUTTON_CLICK,{button_name:this.node.name,screen_name:S.getCurrentPage()}),this.node.scene.emit(iG.WORLD_TAB_SELECTED)}},{key:"handleTabWeeklySelect",value:function(){this.tabDaily.setEnabled(!1),this.tabWeekly.setEnabled(!0),w.playSound(Qi.BUTTON_CLICK),c1&&s1.event(c1.BUTTON_CLICK,{button_name:this.node.name,screen_name:S.getCurrentPage()}),this.node.scene.emit(iG.WEEKLY_TAB_SELECTED)}}]),r}(te)).prototype,"tabDaily",[N0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z0=a(B0.prototype,"tabWeekly",[M0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0=B0))||F0);X._RF.pop(),X._RF.push({},"91613SO4bxPDq9dH9zxyIef","LeaderboardTimer",void 0);var h1,p1,y1,v1,f1,g1=Z.ccclass,m1=Z.property,b1=Ludex.Utils.Time,w1=codex.language,S1=(J0=g1("LeaderboardTimer"),Z0=m1(ne),Q0=m1(me),e1=m1(Lh),J0((i1=a((n1=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"background",i1,s(e)),l(e,"calendar",a1,s(e)),l(e,"timerLocalizer",o1,s(e)),e.alreadyShown=!1,e}return e(c,[{key:"onLoad",value:function(){this.timerOpacity=this.timerLocalizer.node.getComponent(de),this.validateRequiredComponents(),this.backgroundDefaultWidth=this.background.width,this.calendarDefaultPosition=this.calendar.position.clone()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(r=o((function*(e){if(!this.alreadyShown&&!e.aborted){this.alreadyShown=!0;var t=re(this.calendar).to(.3,{scale:be.ONE},{easing:"backOut"}).to(.3,{position:this.calendarDefaultPosition.clone()},{easing:"quadOut"}),n=re(this.background).delay(.3).to(.3,{width:this.backgroundDefaultWidth},{easing:"quadOut"}),i=re(this.timerOpacity).to(.3,{opacity:255});yield Promise.all([p.runTweenAsync(t,e),p.runTweenAsync(n,e)]),this.calendar.scale=be.ONE,this.calendar.position=this.calendarDefaultPosition.clone(),this.background.width=this.backgroundDefaultWidth,yield p.runTweenAsync(i,e),this.timerOpacity.opacity=255}})),function(e){return r.apply(this,arguments)})},{key:"reset",value:function(){this.alreadyShown||(this.calendar.position=this.background.node.position.clone(),this.calendar.scale=be.ZERO,this.background.width=0,this.timerOpacity.opacity=0)}},{key:"setTimeLabel",value:function(e){if(e){var t=new Date,n=0;if("manually"===e)n=0;else if("daily"===e)n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);else if("weekly"===e){var i=t.getUTCDay(),a=0===i?1:8-i;n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+a)}else n="monthly"===e?Date.UTC(t.getUTCFullYear(),t.getUTCMonth()+1):Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1);try{var o=b1.getRelativeTime(n/1e3,w1.getCurrentLocale());this.timerLocalizer.key="game.endsIn",this.timerLocalizer.setParams([o])}catch(e){this.timerLocalizer.key="game.endsSoon"}}else this.timerLocalizer.key="status.loading"}}]),c}(te)).prototype,"background",[Z0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a1=a(n1.prototype,"calendar",[Q0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o1=a(n1.prototype,"timerLocalizer",[e1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t1=n1))||t1);X._RF.pop(),X._RF.push({},"69c90PvoTtGfZyDw8FbbOvV","LeaderSkeleton",void 0);var k1,C1,E1,A1,T1,P1,L1,O1,I1,R1,_1,D1,N1,M1,F1,B1,x1,z1,U1,G1,H1,q1,V1,$1,W1,K1,j1,Y1,X1,J1,Z1,Q1,e2,t2,n2,i2,a2,o2,r2,l2,s2,u2,c2,d2,h2=Z.ccclass,p2=Z.disallowMultiple,y2=Z.property,v2=(h1=h2("LeaderSkeleton"),p1=y2(me),h1(y1=p2((f1=a((v1=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"container",f1,s(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"hide",value:(u=o((function*(e){var t=this;yield p.runTweenAsync(re(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(r=o((function*(e,t){var n=this;this.node.active=!0,this.uiOpacity.opacity=0;var i=this.container.position.clone();this.container.position=new be(i.x,i.y-100,i.z);var a=re(this.container).delay(e);a.to(.2,{position:i},{easing:"cubicOut"});var o=re(this.uiOpacity).delay(e);o.to(.2,{opacity:255},{easing:"cubicOut"});var r=function(){n.container.position=i,n.uiOpacity.opacity=255};t.addAbortListener(r),yield Promise.all([p.runTweenAsync(a,t),p.runTweenAsync(o,t)]),t.removeAbortListener(r)})),function(e,t){return r.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),d}(te)).prototype,"container",[p1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y1=v1))||y1)||y1);X._RF.pop(),X._RF.push({},"53da1+ne4RJ4p0kTjp52K/1","Leader",void 0);var f2,g2,m2,b2,w2,S2,k2,C2,E2,A2,T2,P2,L2,O2=Z.ccclass,I2=Z.property,R2=Ludex.Utils,_2=R2.Number,D2=R2.Signal,N2=(k1=O2("Leader"),C1=I2(ke),E1=I2(de),A1=I2({type:me,group:"Container"}),T1=I2({type:he,group:"Background"}),P1=I2({type:xe,group:"Background"}),L1=I2({type:he,group:"Rank"}),O1=I2({type:ke,group:"Rank"}),I1=I2({type:xe,group:"Rank"}),R1=I2({type:xe,group:"Rank"}),_1=I2({type:xe,group:"Rank"}),D1=I2({type:xe,group:"Rank"}),N1=I2({type:he,group:"Avatar"}),M1=I2({type:de,group:"Avatar"}),F1=I2({type:he,group:"Score"}),B1=I2({type:ke,group:"Score"}),x1=I2({type:xe,group:"Score"}),z1=I2({type:de,group:"Score"}),U1=I2({type:de}),G1=I2({type:ne}),H1=Yn.onlyRunInLifeCycle,q1=Yn.onlyRunInLifeCycleAsync,V1=Yn.onlyRunInLifeCycle,k1((K1=a((W1=function(a){n(v,a);var r,u,c,d,h,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"nameLabel",K1,s(e)),l(e,"nameOpacity",j1,s(e)),l(e,"container",Y1,s(e)),l(e,"background",X1,s(e)),l(e,"highlightBackground",J1,s(e)),l(e,"rankSprite",Z1,s(e)),l(e,"rankLabel",Q1,s(e)),l(e,"goldRank",e2,s(e)),l(e,"silverRank",t2,s(e)),l(e,"bronzeRank",n2,s(e)),l(e,"highlightRank",i2,s(e)),l(e,"avatar",a2,s(e)),l(e,"avatarOpacity",o2,s(e)),l(e,"scoreBackground",r2,s(e)),l(e,"scoreLabel",l2,s(e)),l(e,"highlightScoreBackground",s2,s(e)),l(e,"scoreOpacity",u2,s(e)),l(e,"uiOpacity",c2,s(e)),l(e,"uiTransform",d2,s(e)),e.signalController=new D2.SignalController,e}return e(v,[{key:"onLoad",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultRank=this.rankSprite.spriteFrame,this.defaultScoreBackground=this.scoreBackground.spriteFrame,this.defaultAvatar=this.avatar.spriteFrame,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e,t){this.updateBackground(e),this.updateRank(e,t),this.updatePhoto(e),this.updateUsername(e),this.updateScore(e)}},{key:"updateBackground",value:function(e){this.background.spriteFrame=e.isHighlight?this.highlightBackground:this.defaultBackground}},{key:"updateRank",value:function(e,t){var n=e.rank;this.rankLabel.string=t&&n>t?"".concat(t,"+"):n.toString(),this.rankSprite.spriteFrame=this.defaultRank;var i=new Ae(sG);switch(e.isHighlight&&(this.rankSprite.spriteFrame=this.highlightRank,i=new Ae(cG)),n){case 1:this.rankSprite.spriteFrame=this.goldRank,i=new Ae(aG);break;case 2:this.rankSprite.spriteFrame=this.silverRank,i=new Ae(oG);break;case 3:this.rankSprite.spriteFrame=this.bronzeRank,i=new Ae(rG)}this.rankLabel.shadowColor=i,this.rankLabel.outlineColor=i}},{key:"updatePhoto",value:(h=o((function*(e){var t=this.signalController.renew();if(this.avatar){var n=e.playerId,i=e.photo;if(UM.isAvatarCached(e.playerId,70)){var a=yield UM.getPlayerAvatar(i,n,70,t);if(!a||t.aborted)return;this.setPhoto(a)}else if(this.avatar.spriteFrame=this.defaultAvatar,yield p.waitTweenAsync(.1,t),!t.aborted){var o=yield UM.getPlayerAvatar(i,n,70,t);o&&!t.aborted&&this.setPhoto(o)}}})),function(e){return h.apply(this,arguments)})},{key:"setPhoto",value:function(e){this.node.active&&(e.packable=!0,this.avatar.spriteFrame=e)}},{key:"updateUsername",value:function(e){this.nameLabel.string=e.name,this.nameLabel.color=new Ae(e.isHighlight?uG:lG)}},{key:"updateScore",value:function(e){var t=Math.floor(e.score);this.scoreLabel.string=_2.getShortNumber(t,7);var n=this.scoreLabel.getComponent(ke);n.outlineColor=new Ae(e.isHighlight?cG:sG),n.shadowColor=new Ae(e.isHighlight?cG:sG),this.scoreBackground.spriteFrame=e.isHighlight?this.highlightScoreBackground:this.defaultScoreBackground}},{key:"runShowUpAnimation",value:(d=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3;this.setVisible(!1);var a=this.container.position.clone();this.container.position=new be(a.x,a.y-100,a.z);var o=re(this.container).delay(t);o.to(i,{position:a},{easing:"backOut"});var r=re(this.uiOpacity).delay(t);r.to(i,{opacity:255},{easing:"cubicOut",onUpdate:function(){n.nameOpacity.opacity=n.uiOpacity.opacity,n.scoreOpacity.opacity=n.uiOpacity.opacity,n.avatarOpacity.opacity=n.uiOpacity.opacity}});var l=function(){n.enabledInHierarchy&&(n.container.position=a,n.uiOpacity.opacity=255,n.avatar.node.active=!0)};e.addAbortListener(l),yield Promise.all([p.runTweenAsync(o,e),p.runTweenAsync(r,e)]),e.removeAbortListener(l)})),function(e,t){return d.apply(this,arguments)})},{key:"runWorldPositionAnimation",value:(c=o((function*(e,t,n){var i=re(this.node).to(t,{worldPosition:e},{easing:"quadOut"});yield p.runTweenAsync(i,n)})),function(e,t,n){return c.apply(this,arguments)})},{key:"runScaleAnimation",value:(u=o((function*(e,t,n){var i=re(this.node).to(t,{scale:new be(e,e,e)},{easing:"backOut"});yield p.runTweenAsync(i,n)})),function(e,t,n){return u.apply(this,arguments)})},{key:"runUpdateDataAnimation",value:(r=o((function*(e,t,n,i,a,o){var r=this;yield p.runOnUpdateAsync(this.node,a,(function(a){var o=Math.floor(e+(t-e)*a),l=Math.floor(n+(i-n)*a);r.updateRank({rank:o,isHighlight:!0}),r.updateScore({score:l,isHighlight:!0})}),o)})),function(e,t,n,i,a,o){return r.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.nameOpacity.opacity=t,this.scoreOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),v}(te)).prototype,"nameLabel",[C1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j1=a(W1.prototype,"nameOpacity",[E1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y1=a(W1.prototype,"container",[A1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X1=a(W1.prototype,"background",[T1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J1=a(W1.prototype,"highlightBackground",[P1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z1=a(W1.prototype,"rankSprite",[L1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q1=a(W1.prototype,"rankLabel",[O1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e2=a(W1.prototype,"goldRank",[I1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t2=a(W1.prototype,"silverRank",[R1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n2=a(W1.prototype,"bronzeRank",[_1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i2=a(W1.prototype,"highlightRank",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a2=a(W1.prototype,"avatar",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o2=a(W1.prototype,"avatarOpacity",[M1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r2=a(W1.prototype,"scoreBackground",[F1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l2=a(W1.prototype,"scoreLabel",[B1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s2=a(W1.prototype,"highlightScoreBackground",[x1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u2=a(W1.prototype,"scoreOpacity",[z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c2=a(W1.prototype,"uiOpacity",[U1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d2=a(W1.prototype,"uiTransform",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(W1.prototype,"updateInfo",[H1],Object.getOwnPropertyDescriptor(W1.prototype,"updateInfo"),W1.prototype),a(W1.prototype,"updatePhoto",[q1],Object.getOwnPropertyDescriptor(W1.prototype,"updatePhoto"),W1.prototype),a(W1.prototype,"setPhoto",[V1],Object.getOwnPropertyDescriptor(W1.prototype,"setPhoto"),W1.prototype),$1=W1))||$1);X._RF.pop(),X._RF.push({},"173acdyc/VOnLkPsoSfdfnr","Leaders",void 0);var M2=Z.ccclass,F2=Z.property,B2=codex.player,x2=Ludex.Utils.Array,z2=(f2=M2("Leaders"),g2=F2(wq),m2=F2(N2),b2=F2(ie),w2=Yn.onlyRunInLifeCycleAsync,S2=Yn.onlyRunInLifeCycleAsync,k2=Yn.onlyRunInLifeCycleAsync,C2=Yn.onlyRunInLifeCycleAsync,f2((T2=a((A2=function(a){n(g,a);var r,d,h,p,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"scrollView",T2,s(e)),l(e,"tempLeader",P2,s(e)),l(e,"maxLeader",L2,s(e)),e.leaderData=[],e.displayLeaderData=[],e.displayPlayerLeader=null,e.isHidden=!0,e}return e(g,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(ne),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"__preload",value:function(){this.currentPlayerId=B2.getPlayerId()}},{key:"updateData",value:(v=o((function*(e){this.isHidden=!1,this.leaderData=e,this.leaderData.forEach((function(e,t){e.rank=t+1})),this.setupDisplayLeadersData()})),function(e){return v.apply(this,arguments)})},{key:"initScrollViews",value:function(){var e=this;this.scrollView.setMaxNodeCount(this.leaderData.length),this.scrollView.init((function(t){var n=t.getComponent(N2),i=e.displayLeaderData[t.order];if(i){var a=i.playerId,o=i.photo,r=i.name,l=i.score;n.setVisible(!0),n.updateInfo({playerId:a,isHighlight:e.currentPlayerId===a,name:r,photo:o,rank:t.order+1,score:l},e.maxLeader)}}))}},{key:"playRankChangeAnimation",value:(y=o((function*(e,t,n,i){if(!(t>=n)){var a=this.displayLeaderData,o=x2.search(a,(function(e){return e.playerId===B2.getPlayerId()}));if(o){var r=o.rank;if(a[i-1]){var l=this.scrollView.getNodeByOrder(o.rank-1);if(l){var s=null==l?void 0:l.getComponent(N2);if(s){s.setVisible(!1),this.tempLeader.setVisible(!0),this.tempLeader.updatePhoto({playerId:B2.getPlayerId(),photo:o.photo}),this.tempLeader.node.worldPosition=l.node.worldPosition.clone(),yield this.tempLeader.runScaleAnimation(1.1,.5,e);var u=Math.min(.5*(r-i),2),c=[this.tempLeader.runUpdateDataAnimation(r,i,t,n,u,e),this.scrollToLeaderRank(i,u,e)],d=this.scrollView.scrollView.getMaxScrollOffset().y,h=this.scrollView.getNodeScrollOffset(i-1),p=be.ZERO;if(h<0)p=new be(this.tempLeader.node.worldPosition.x,this.node.worldPosition.y+this.scrollView.getNodePosition(i-1).y+this.uiTransform.height/2,this.tempLeader.node.worldPosition.z);else if(this.scrollView.scrollView.getScrollOffset().y>=d-5)if(h<d)p=new be(this.tempLeader.node.worldPosition.x,this.scrollView.viewport.node.worldPosition.y,this.tempLeader.node.worldPosition.z);else{var y,v=this.scrollView.getNodeByOrder(i-1);p=null!==(y=null==v?void 0:v.node.worldPosition.clone())&&void 0!==y?y:be.ZERO}p.equals(be.ZERO)||c.push(this.tempLeader.runWorldPositionAnimation(p,u,e)),yield Promise.all(c),yield Promise.all([this.tempLeader.runScaleAnimation(1,.25,e),this.playPostRankChangeAnimation(i,r,e)]),this.tempLeader.setVisible(!1),l.node.worldPosition=this.tempLeader.node.worldPosition.clone(),this.setupDisplayLeadersData(),this.scrollView.updateNodeVisibility(),this.scrollView.updateLayout()}}}}}})),function(e,t,n,i){return y.apply(this,arguments)})},{key:"playShowLeadersAnimation",value:(p=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(!this.isHidden){var i=[],a=this.scrollView.getAllNodes();if(a.sort((function(e,t){return e.order-t.order})).forEach((function(e,n){var a=e.getComponent(N2);a.setVisible(n<t.leaderData.length),e.isVisible()&&i.push(a)})),!(i.length<1)){i=i.slice(0,a.length-1);var r=.3;yield Promise.all(i.map(function(){var i=o((function*(i,a){t.isHidden||(yield i.runShowUpAnimation(e,a*n,r))}));return function(e,t){return i.apply(this,arguments)}}()))}}})),function(e){return p.apply(this,arguments)})},{key:"scrollToPlayerLeader",value:(h=o((function*(e,t){this.displayPlayerLeader&&(yield this.scrollToLeaderRank(this.displayPlayerLeader.rank,e,t))})),function(e,t){return h.apply(this,arguments)})},{key:"updateDisplayPlayerLeaderForRankChanging",value:function(e,t,n){if(!this.displayPlayerLeader)return!1;this.displayPlayerLeader.score=e,this.displayLeaderData.sort((function(e,t){return t.score-e.score}));var i=this.displayLeaderData.indexOf(this.displayPlayerLeader)+1;return n===i?(this.displayPlayerLeader.score=t,this.displayPlayerLeader.rank=n,!1):(this.displayPlayerLeader.rank=i,this.tempLeader.updateInfo({playerId:B2.getPlayerId(),isHighlight:!0,name:this.displayPlayerLeader.name,photo:this.displayPlayerLeader.photo,rank:this.displayPlayerLeader.rank,score:e}),!0)}},{key:"hideLeaders",value:function(){this.isHidden=!0;var e,t=this.scrollView.getAllNodes().map((function(e){return e.getComponent(N2)})),n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;null==i||i.setVisible(!1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"getLeaderData",value:function(){return this.leaderData}},{key:"setupDisplayLeadersData",value:function(){var e=this,t=x2.search(this.leaderData,(function(t){return t.playerId===e.currentPlayerId}));t?(this.displayLeaderData=this.leaderData.filter((function(t){return t.playerId!==e.currentPlayerId})),this.displayPlayerLeader=u({},t),this.displayLeaderData.splice(t.rank-1,0,this.displayPlayerLeader)):(this.displayPlayerLeader=null,this.displayLeaderData=this.leaderData)}},{key:"playPostRankChangeAnimation",value:(d=o((function*(e,t,n){var i=null!=e?e:0,a=this.scrollView.getVisibleNodes().filter((function(e){return e.order>=i-1&&e.order<t})),o=a.map((function(e){return e.getComponent(N2)})),r=this.scrollView.nodeHeight+this.scrollView.spacing,l=[];o.forEach((function(e,t){var i=a[t];if(i){e.updateRank({rank:i.order+2,isHighlight:!1});var o=e.node.worldPosition.clone();l.push(e.runWorldPositionAnimation(o.add3f(0,-r,0),.25,n))}})),yield Promise.all(l)})),function(e,t,n){return d.apply(this,arguments)})},{key:"scrollToLeaderRank",value:(r=o((function*(e,t,n){yield this.scrollView.scrollToOrder(e-1,n,t)})),function(e,t,n){return r.apply(this,arguments)})}]),g}(te)).prototype,"scrollView",[g2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P2=a(A2.prototype,"tempLeader",[m2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L2=a(A2.prototype,"maxLeader",[b2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(A2.prototype,"updateData",[w2],Object.getOwnPropertyDescriptor(A2.prototype,"updateData"),A2.prototype),a(A2.prototype,"playRankChangeAnimation",[S2],Object.getOwnPropertyDescriptor(A2.prototype,"playRankChangeAnimation"),A2.prototype),a(A2.prototype,"scrollToPlayerLeader",[k2],Object.getOwnPropertyDescriptor(A2.prototype,"scrollToPlayerLeader"),A2.prototype),a(A2.prototype,"scrollToLeaderRank",[C2],Object.getOwnPropertyDescriptor(A2.prototype,"scrollToLeaderRank"),A2.prototype),E2=A2))||E2);X._RF.pop(),X._RF.push({},"9f98ebQ6z1GMZv6FqGBHkpb","LeaderboardContentOverlay",void 0);var U2,G2=Ludex.Utils,H2=G2.Time,q2=G2.Object,V2=function(){function n(e){var i=this;t(this,n),this.isPageMounted=!1,this.createMainDiv$=function(){i.mainDiv$=document.createElement("div");var e=SM.getGameScaleFactor();q2.assign(i.mainDiv$.style,{position:"absolute",transform:"translateX(-50%)",left:"50%",top:"".concat(295*e,"px"),scrollbarWidth:"none",alignItems:"start",overflow:"auto",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.1s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.mainDiv$)},this.isPayloadChanged$=function(e){if(!i.currentPayload$)return!0;if(i.currentPayload$.leaderboardPlayers.length!==e.leaderboardPlayers.length)return!0;for(var t=0;t<e.leaderboardPlayers.length;t++){var n=i.currentPayload$.leaderboardPlayers[t],a=e.leaderboardPlayers[t];if(!n||!a)return!0;if(n.playerId!==a.playerId||n.rank!==a.rank||n.score!==a.score)return!0}return!1},this.showOverlay$=o((function*(){i.overlayElement$&&(yield i.overlayElement$.showAsync(),i.revealMainDiv$())})),this.revealMainDiv$=function(){i.overlayElement$&&i.isPageMounted&&(i.scene.emit(iG.OVERLAY_SHOW_COMPLETED),i.mainDiv$.style.display="block",i.mainDiv$.scrollTop=0,requestAnimationFrame((function(){i.isPageMounted?q2.assign(i.mainDiv$.style,{opacity:"1",pointerEvents:"auto"}):i.mainDiv$.style.display="none"})))},this.validateOverlayPayload$=function(e){var t,n=u(u({},e),{},{leaderboardPlayers:[]}),i=/^\d+$/,a=c(e.leaderboardPlayers);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.test(o.playerId)&&n.leaderboardPlayers.push(o)}}catch(e){a.e(e)}finally{a.f()}return n},this.getIframeCss$=function(e){var t="100cqw",n=e.leaderboardPosition,a=e.leaderboardPlayers.length;n&&(t="".concat(i.getElementDivWidth$(n),"px"));var o="height: calc((".concat(t," * (121 / 1000) + 4px) * ").concat(a,");");return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat(o,"   ")},this.updateMainDivPosition$=function(e){if(i.mainDiv$){var t="".concat(i.getElementDivWidth$(e),"px"),n="".concat(i.getElementDivHeight$(),"px"),a="".concat(i.getElementDivTopOffset$(),"px");q2.assign(i.mainDiv$.style,{width:t,height:"calc(100vh - ".concat(n,")"),top:a})}},this.getElementDivWidth$=function(e){return e.width*SM.getGameScaleFactor()},this.getElementDivHeight$=function(){return SM.getGameScaleFactor()*(450+C.getBannerAdHeight())},this.getElementDivTopOffset$=function(){return 295*SM.getGameScaleFactor()},this.scene=e,this.createMainDiv$()}var i,a,r,l;return e(n,[{key:"updateOverlay",value:(l=o((function*(e){try{if(!this.isPageMounted)return!1;this.scene.emit(iG.OVERLAY_SHOW_STARTED);var t=this.validateOverlayPayload$(e);if(t.leaderboardPosition&&this.moveMainDiv(t.leaderboardPosition),!this.isPayloadChanged$(t))return this.revealMainDiv$(),!0;this.overlayElement$?yield this.overlayElement$.updateAsync(t):this.overlayElement$=yield SM.createOverlayViewAsync("overlays/leaderboard/leaderboard-overlay.xml",this.mainDiv$,this.getIframeCss$(e),"overlays/leaderboard/leaderboard-overlay-styles.css",t),this.currentPayload$=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return l.apply(this,arguments)})},{key:"hideOverlay",value:(r=o((function*(){if(this.overlayElement$){q2.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none"});try{yield H2.sleepAsync(100),this.mainDiv$.style.display="none"}catch(e){console.error("Hide overlay failed:",e)}}})),function(){return r.apply(this,arguments)})},{key:"handleHideUICall",value:(a=o((function*(){q2.assign(this.mainDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"})})),function(){return a.apply(this,arguments)})},{key:"handleShowUICall",value:(i=o((function*(){q2.assign(this.mainDiv$.style,{opacity:"1",pointerEvents:"auto",display:"block"})})),function(){return i.apply(this,arguments)})},{key:"setIsPageMounted",value:function(e){this.isPageMounted=e}},{key:"moveMainDiv",value:function(e){this.updateMainDivPosition$(e)}}]),n}();X._RF.pop(),X._RF.push({},"332aaP3dkhKxZNHiMFB1bKn","LeaderboardIsEmpty",void 0);var $2,W2,K2,j2,Y2,X2,J2,Z2,Q2,e5,t5,n5,i5,a5,o5,r5,l5,s5,u5,c5,d5,h5,p5,y5,v5,f5,g5,m5,b5,w5,S5,k5,C5,E5=(0,Z.ccclass)("LeaderboardIsEmpty")(U2=function(a){n(s,a);var r,l=i(s);function s(){return t(this,s),l.apply(this,arguments)}return e(s,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"show",value:(r=o((function*(){this.uiOpacity.opacity=255;var e=this.node.position.clone(),t=re(this.node);t.to(.05,{position:e.clone().add3f(5,0,0)}),t.to(.05,{position:e.clone().add3f(-5,0,0)});var n=re(this.node).repeat(2,t);n.to(.05,{position:e}),yield p.runTweenAsync(n)})),function(){return r.apply(this,arguments)})},{key:"hide",value:function(){this.uiOpacity.opacity=0}}]),s}(te))||U2;X._RF.pop(),X._RF.push({},"2aa67vEWR9HaJkCtpsuUyRX","LeaderboardContent",void 0);var A5,T5,P5,L5,O5,I5,R5,_5,D5=Z.ccclass,N5=Z.property,M5=codex,F5=M5.storage,B5=M5.leaderboard,x5=M5.player,z5=M5.monitorError,U5=Ludex,G5=U5.Utils.Object,H5=U5.Configs.Leaderboards,q5=function(a){n(r,a);var o=i(r);function r(e){var n;return t(this,r),(n=o.call(this,e)).name="EmptyLeaderboardError",n}return e(r)}(g(Error)),V5=($2=D5("LeaderboardContent"),W2=Yn.required(),K2=N5(d1),j2=Yn.required(),Y2=N5(S1),X2=Yn.required(),J2=N5({type:z2,group:"Leaderboard"}),Z2=N5({type:[v2],group:"Leaderboard"}),Q2=Yn.required(),e5=N5({type:E5,group:"Leaderboard"}),t5=Yn.required(),n5=N5(qr),i5=Yn.required(),a5=N5(_0),o5=Yn.required(),r5=N5(me),l5=Yn.onlyRunInLifeCycleAsync,s5=Yn.onlyRunInLifeCycleAsync,u5=Yn.onlyRunInLifeCycleAsync,c5=Yn.onlyRunInLifeCycleAsync,d5=Yn.onlyRunInLifeCycleAsync,h5=Yn.onlyRunInLifeCycleAsync,p5=Yn.onlyRunInLifeCycle,$2((f5=a((v5=function(a){n(g,a);var r,u,c,d,h,p,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"tabs",f5,s(e)),l(e,"timer",g5,s(e)),l(e,"leaders",m5,s(e)),l(e,"leaderSkeletons",b5,s(e)),l(e,"leaderboardIsEmpty",w5,s(e)),l(e,"contentOpacity",S5,s(e)),l(e,"joinLeaderboardContainer",k5,s(e)),l(e,"loadingNode",C5,s(e)),e.isHidden=!0,e.isOverlayMode=!1,e.currentLb=null,e.currentTab=rv,e.animAbortSignal=new Mi,e.hasPlayedAppearAnim={friends:!1,global:!1,global_weekly:!1},e.dailyFBOverlay=null,e.weeklyFBOverlay=null,e.unlistenEvents$=function(){se.off(y.VIEW_RESIZED,e.handleViewResized$),e.node.scene.off(iG.WEEKLY_TAB_SELECTED,e.handleWeeklyTabSelected$),e.node.scene.off(iG.WORLD_TAB_SELECTED,e.handleDailyTabSelected$),e.node.scene.off(iG.OVERLAY_SHOW_STARTED,e.enableOverlayLoadingNode$),e.node.scene.off(iG.OVERLAY_SHOW_COMPLETED,e.disableOverlayLoadingNode$),e.unlistenUIEvents()},e.getLeaderboardName$=function(e){var t=e===lv?ov.WEEKLY:ov.DAILY;return B5.getLeaderboardName(t)},e.cleanupSideEffects$=function(){e.animAbortSignal.abort(),e.animAbortSignal=new Mi,e.leaders.hideLeaders(),e.leaderboardIsEmpty.hide(),e.joinLeaderboardContainer.hide()},e.initializeStatusUpdate$=function(t){e.tabs.updateStatus(t),e.timer.setTimeLabel()},e.loadLeaderboardData$=function(){var t=o((function*(t,n){yield e.showLoading(t,n),yield e.loadLeaderboard(t,n),e.hideLoading(t,n)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleSuccessfulLoad$=function(){var t=o((function*(t,n){e.isOverlayMode?yield e.handleOverlayMode$(t,n):yield e.handleRegularMode$(t,n),yield e.handleGuestUserFlow$(t)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleOverlayMode$=function(){var t=o((function*(t,n){t.call((function(){var i;null===(i=e.timer)||void 0===i||i.show(t),e.handleUpdateOverlayAfterSignal$(t,n)}))}));return function(e,n){return t.apply(this,arguments)}}(),e.handleUpdateOverlayAfterSignal$=function(){var t=o((function*(t,n){if(!(yield e.updateOverlay$(n)))return e.isOverlayMode=!1,e.disableOverlayLoadingNode$(),void e.handleRegularMode$(t,n);e.setupTimerWithLeaderboard$(t)}));return function(e,n){return t.apply(this,arguments)}}(),e.handleRegularMode$=function(){var t=o((function*(t,n){t.call((function(){e.setupTimerWithLeaderboard$(t)})),yield t.callAsync((function(t){return e.playLeadersShowupAnimation(n,t)}))}));return function(e,n){return t.apply(this,arguments)}}(),e.setupTimerWithLeaderboard$=function(t){var n,i,a;null===(n=e.timer)||void 0===n||n.setTimeLabel(null===(i=e.currentLb)||void 0===i?void 0:i.resettable),null===(a=e.timer)||void 0===a||a.show(t)},e.handleGuestUserFlow$=function(){var t=o((function*(t){var n;GameSDK.extra.isGuest&&(e.updateJoinLeaderboardButton(),yield null===(n=e.joinLeaderboardContainer)||void 0===n?void 0:n.show(t))}));return function(e){return t.apply(this,arguments)}}(),e.handleLoadError$=function(t,n,i){if(!(i instanceof q5))throw i;t.call((function(){e.handleEmptyLeaderboard$(t,n)}))},e.handleEmptyLeaderboard$=function(t,n){e.leaderboardIsEmpty.show(),e.leaders.scrollView.setMaxNodeCount(0),e.hideLoading(t,n),e.setupTimerWithLeaderboard$(t)},e.updateOverlay$=function(){var t=o((function*(t){if(!e.currentLb)return!1;var n=G5.vals(e.currentLb.leaders);n.sort((function(e,t){return t.score-e.score}));var i=n.map((function(e){var t=e.rank>50?"50+":"".concat(e.rank);return{playerId:e.playerId,rank:t,score:e.score}})),a=e.getCorrectOverlay$(t);if(!a)return!1;var o=yield null==a?void 0:a.updateOverlay({leaderboardPlayers:i,leaderboardPosition:e.getLeaderboardSize$(),currentPlayerId:x5.getPlayerId()});return null!=o&&o}));return function(e){return t.apply(this,arguments)}}(),e.handleViewResized$=function(){e.updateJoinLeaderboardButton()},e.handleWeeklyTabSelected$=o((function*(){F5.setStorageData("leaderboard_content","lastTabOpened",lv),e.cleanupSideEffects$(),e.currentTab=lv;var t=e.animAbortSignal;try{yield e.updateStatus(t,lv)}catch(e){t.call((function(){var t=e instanceof Error?e:new Error("Unknown error during loading global weekly leaderboard.");console.error("LeaderboardContent",t),null==z5||z5.sendException(t),x.showNotificationScreenWithLocalizedKey("error.noFriendsLb",2)}))}})),e.handleDailyTabSelected$=o((function*(){F5.setStorageData("leaderboard_content","lastTabOpened",rv),e.cleanupSideEffects$(),e.currentTab=rv;var t=e.animAbortSignal;try{yield e.updateStatus(t,rv)}catch(e){t.call((function(){var t=e instanceof Error?e:new Error("Unknown error during loading global leaderboard.");console.error("LeaderboardContent",t),null==z5||z5.sendException(t),x.showNotificationScreenWithLocalizedKey("error.noWorldLb",2)}))}})),e.hideContent$=function(){var t,n;e.contentOpacity.changeStateFade(!1,.1),e.updateOverlayMountStatus(!1),null===(t=e.dailyFBOverlay)||void 0===t||t.handleHideUICall(),null===(n=e.weeklyFBOverlay)||void 0===n||n.handleHideUICall()},e.showContent$=function(){e.contentOpacity.changeStateFade(!0,.1),e.updateOverlayMountStatus(!0),e.handleOverlayShowUICall$()},e.handleOverlayShowUICall$=function(){var t,n;e.isOverlayMode&&(e.currentTab===lv?null===(t=e.weeklyFBOverlay)||void 0===t||t.handleShowUICall():null===(n=e.dailyFBOverlay)||void 0===n||n.handleShowUICall())},e.createFBOverlay$=function(){try{SM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode=!0,e.dailyFBOverlay=new V2(e.node.scene),e.weeklyFBOverlay=new V2(e.node.scene)}catch(e){return}},e.getLeaderboardSize$=function(){var t=e.leaders.getComponent(ne);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.leaders.node;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.getCorrectOverlay$=function(t){return t===rv?e.dailyFBOverlay:e.weeklyFBOverlay},e.enableOverlayLoadingNode$=function(){e.loadingNode.active=!0},e.disableOverlayLoadingNode$=function(){e.loadingNode.active=!1},e}return e(g,[{key:"__preload",value:function(){var e,t;this.leaders.maxLeader=null!==(e=null===(t=H5.LeaderboardList[0])||void 0===t?void 0:t.Limit)&&void 0!==e?e:0}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this),this.createFBOverlay$()}},{key:"listenEvents",value:function(){se.on(y.VIEW_RESIZED,this.handleViewResized$),this.node.scene.on(iG.WEEKLY_TAB_SELECTED,this.handleWeeklyTabSelected$),this.node.scene.on(iG.WORLD_TAB_SELECTED,this.handleDailyTabSelected$),this.node.scene.on(iG.OVERLAY_SHOW_STARTED,this.enableOverlayLoadingNode$),this.node.scene.on(iG.OVERLAY_SHOW_COMPLETED,this.disableOverlayLoadingNode$),this.node.scene.on(Js.HIDE_UI,this.hideContent$),this.node.scene.on(Js.SHOW_UI,this.showContent$)}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Js.HIDE_UI,this.hideContent$),this.node.scene.off(Js.SHOW_UI,this.showContent$)}},{key:"loadLeaderboard",value:(v=o((function*(e,t){var n=this,i=this.getLeaderboardName$(t);null!==i&&(yield e.callAsync((function(){return B5.requestLeaderboardAsync(i,n.leaders.maxLeader)})),e.call((function(){var e=B5.getLeaderboard(i);n.currentLb=null!=e?e:n.currentLb})),yield e.callAsync(o((function*(){return n.loadPlayerLeaderData(t)}))))})),function(e,t){return v.apply(this,arguments)})},{key:"showLoading",value:(p=o((function*(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.isOverlayMode)return this.enableOverlayLoadingNode$(),void this.cleanupOverlay();yield Promise.all([this.leaders.scrollView.unlistenEvents(),this.leaders.scrollView.scrollToTop(e).then((function(){n.leaders&&(n.leaders.scrollView.scrollView.enabled=!1,n.leaders.scrollView.listenEvents())})),this.leaderSkeletons.map((function(t,n){return t.show(n*i,e)}))])})),function(e,t){return p.apply(this,arguments)})},{key:"hideLoading",value:(h=o((function*(e,t){this.isOverlayMode||(yield Promise.all(this.leaderSkeletons.map((function(t){return t.hide(e)}))))})),function(e,t){return h.apply(this,arguments)})},{key:"entering",value:function(){this.timer.reset(),this.isHidden=!1;var e=F5.getStorageData("leaderboard_content","lastTabOpened");e===lv?this.handleWeeklyTabSelected$():e===rv&&this.handleDailyTabSelected$()}},{key:"hide",value:function(){this.isHidden=!0}},{key:"cleanup",value:function(){this.leaders.scrollView.unlistenEvents(),this.unlistenEvents$(),this.cleanupSideEffects$(),this.cleanupOverlay()}},{key:"cleanupOverlay",value:function(){var e,t;null===(e=this.dailyFBOverlay)||void 0===e||e.hideOverlay(),null===(t=this.weeklyFBOverlay)||void 0===t||t.hideOverlay()}},{key:"updateOverlayMountStatus",value:function(e){var t,n;null===(t=this.dailyFBOverlay)||void 0===t||t.setIsPageMounted(e),null===(n=this.weeklyFBOverlay)||void 0===n||n.setIsPageMounted(e)}},{key:"updateStatus",value:(d=o((function*(e,t){if(void 0!==e&&!this.isHidden){this.initializeStatusUpdate$(t);try{yield this.loadLeaderboardData$(e,t),yield this.handleSuccessfulLoad$(e,t)}catch(n){this.handleLoadError$(e,t,n)}}})),function(e,t){return d.apply(this,arguments)})},{key:"playLeadersShowupAnimation",value:(c=o((function*(e,t){var n=this;if(this.currentLb){var i=x5.getPlayerId(),a=this.currentLb.leaders[i],o=F5.getStorage("leaderboard_content").previousScore,r=G5.vals(this.currentLb.leaders);r.sort((function(e,t){return t.score-e.score})),GameSDK.extra.isGuest&&(r=r.slice(0,5));var l=a&&-1!==o&&o<a.score&&a.rank<=this.leaders.maxLeader;this.leaders.updateData(r);var s=!1;l&&(s=this.leaders.updateDisplayPlayerLeaderForRankChanging(o,a.score,a.rank)),this.leaders.initScrollViews(),this.leaders.scrollView.scrollView.enabled=!0;var u=this.hasPlayedAppearAnim[e]?0:.1;yield t.callAsync((function(){return n.leaders.playShowLeadersAnimation(t,u)})),this.hasPlayedAppearAnim[e]=!0,a&&(yield t.callAsync((function(){return n.leaders.scrollToPlayerLeader(1,t)})),s&&-1!==o&&(yield t.callAsync((function(e){return n.leaders.playRankChangeAnimation(e,o,a.score,a.rank)})),F5.setStorageData("leaderboard_content","previousScore",a.score)))}})),function(e,t){return c.apply(this,arguments)})},{key:"loadPlayerLeaderData",value:(u=o((function*(e){var t=x5.getPlayerId();if(null===this.currentLb)throw new Error("LeaderboardContent: Leaderboard is not found.");var n=this.currentLb.leaders;if(0===Object.keys(n).length)throw new q5("LeaderboardContent: Leaderboard is empty.");if(!n[t]){var i=this.getLeaderboardName$(e);if(null===i)throw new Error("LeaderboardContent: Leaderboard name is not found.");var a=yield B5.getLeadersByPlayerIdsAsync(i,[t]);if(0!==a.length){var o=a[0];o&&(n[t]=o)}}})),function(e){return u.apply(this,arguments)})},{key:"updateJoinLeaderboardButton",value:function(){if(GameSDK.extra.isGuest&&!this.isOverlayMode){var e=void 0,t=this.leaders.scrollView.getVisibleNodes();if(0===t.length)e=this.leaders.scrollView.viewport.getBoundingBoxToWorld().center.y;else{var n=t[t.length-1],i=this.joinLeaderboardContainer.uiTransform.height,a=n.node.worldPosition.y-i-20;a-i/2>=this.leaders.scrollView.viewport.getBoundingBoxToWorld().yMin&&(e=a)}this.joinLeaderboardContainer.updatePosition(e)}}},{key:"handleJoinLeaderboard",value:(r=o((function*(){try{if(!("initPlayerAsync"in GameSDK.player))return;if(x.showLoadingScreen(),yield GameSDK.player.initPlayerAsync(),x.closeLoadingScreen(),GameSDK.extra.isGuest)return void x.showNotificationScreenWithLocalizedKey("error.joinLb",1)}catch(e){console.warn("Join leaderboard failed",e),x.closeLoadingScreen(),x.showNotificationScreenWithLocalizedKey("error.joinLb",1)}})),function(){return r.apply(this,arguments)})}]),g}(te)).prototype,"tabs",[W2,K2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g5=a(v5.prototype,"timer",[j2,Y2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m5=a(v5.prototype,"leaders",[X2,J2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b5=a(v5.prototype,"leaderSkeletons",[Z2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w5=a(v5.prototype,"leaderboardIsEmpty",[Q2,e5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S5=a(v5.prototype,"contentOpacity",[t5,n5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k5=a(v5.prototype,"joinLeaderboardContainer",[i5,a5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C5=a(v5.prototype,"loadingNode",[o5,r5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(v5.prototype,"loadLeaderboard",[l5],Object.getOwnPropertyDescriptor(v5.prototype,"loadLeaderboard"),v5.prototype),a(v5.prototype,"showLoading",[s5],Object.getOwnPropertyDescriptor(v5.prototype,"showLoading"),v5.prototype),a(v5.prototype,"hideLoading",[u5],Object.getOwnPropertyDescriptor(v5.prototype,"hideLoading"),v5.prototype),a(v5.prototype,"updateStatus",[c5],Object.getOwnPropertyDescriptor(v5.prototype,"updateStatus"),v5.prototype),a(v5.prototype,"playLeadersShowupAnimation",[d5],Object.getOwnPropertyDescriptor(v5.prototype,"playLeadersShowupAnimation"),v5.prototype),a(v5.prototype,"loadPlayerLeaderData",[h5],Object.getOwnPropertyDescriptor(v5.prototype,"loadPlayerLeaderData"),v5.prototype),a(v5.prototype,"updateJoinLeaderboardButton",[p5],Object.getOwnPropertyDescriptor(v5.prototype,"updateJoinLeaderboardButton"),v5.prototype),y5=v5))||y5);X._RF.pop(),X._RF.push({},"ae514KD4phHMYC0AD3CIw68","LeaderboardPage",void 0);var $5,W5,K5,j5,Y5,X5,J5,Z5,Q5,e3,t3,n3,i3,a3,o3,r3,l3,s3,u3,c3;A5=(0,Z.ccclass)("LeaderboardPage"),T5=Yn.required(),P5=Yn.onlyRunInLifeCycleAsync,L5=Yn.onlyRunInLifeCycleAsync,O5=Yn.onlyRunInLifeCycleAsync,A5((_5=a((R5=function(a){n(f,a);var r,u,c,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"panelAnimationController",_5,s(e)),e}return e(f,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(fu),d(h(f.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=o((function*(){d(h(f.prototype),"start",this).call(this)})),function(){return y.apply(this,arguments)})},{key:"mount",value:(c=o((function*(){if(yield d(h(f.prototype),"mount",this).call(this),this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(V5),this.content.updateOverlayMountStatus(!0),!this.content)throw new Error("LeaderboardPage: Leaders not found")})),function(){return c.apply(this,arguments)})},{key:"transitionIn",value:(u=o((function*(){this.content.entering(),yield d(h(f.prototype),"transitionIn",this).call(this);var e=p.runTweenAsync(re(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();this.content.listenEvents(),yield Promise.all([e,t])})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(r=o((function*(){yield d(h(f.prototype),"transitionOut",this).call(this),this.content.cleanupOverlay(),this.content.unlistenUIEvents(),yield this.panelAnimationController.hideUI()})),function(){return r.apply(this,arguments)})},{key:"unmount",value:function(){var e,t,n;null===(e=this.content)||void 0===e||e.hide(),null===(t=this.content)||void 0===t||t.cleanup(),null===(n=this.content)||void 0===n||n.updateOverlayMountStatus(!1),d(h(f.prototype),"unmount",this).call(this)}}]),f}(aJ)).prototype,"panelAnimationController",[T5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(R5.prototype,"mount",[P5],Object.getOwnPropertyDescriptor(R5.prototype,"mount"),R5.prototype),a(R5.prototype,"transitionIn",[L5],Object.getOwnPropertyDescriptor(R5.prototype,"transitionIn"),R5.prototype),a(R5.prototype,"transitionOut",[O5],Object.getOwnPropertyDescriptor(R5.prototype,"transitionOut"),R5.prototype),I5=R5));X._RF.pop(),X._RF.push({},"0d1c02Npp9IXrjlFdl8co2L","TopLeader",void 0);var d3,h3,p3,y3,v3,f3,g3,m3,b3,w3,S3,k3,C3,E3,A3,T3,P3,L3,O3,I3,R3,_3,D3,N3,M3,F3,B3,x3,z3,U3,G3,H3,q3,V3,$3,W3,K3,j3,Y3,X3,J3,Z3=Z.ccclass,Q3=Z.property,e6=Ludex.Utils.Number,t6=($5=Z3("TopLeader"),W5=Q3(ke),K5=Q3(me),j5=Q3({type:he}),Y5=Q3({type:gt}),X5=Q3({type:de}),J5=Q3({type:ke}),Z5=Q3({type:de}),Q5=Yn.onlyRunInLifeCycle,e3=Yn.onlyRunInLifeCycleAsync,t3=Yn.onlyRunInLifeCycleAsync,$5((a3=a((i3=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"nameLabel",a3,s(e)),l(e,"defaultAvatar",o3,s(e)),l(e,"avatar",r3,s(e)),l(e,"mask",l3,s(e)),l(e,"avatarOpacity",s3,s(e)),l(e,"scoreLabel",u3,s(e)),l(e,"uiOpacity",c3,s(e)),e.signal=new Mi,e}return e(h,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateInfo",value:function(e){this.updateUsername(e),this.updatePhoto(e),this.updateScore(e)}},{key:"updateUsername",value:function(e){this.nameLabel&&(this.nameLabel.string=e.name)}},{key:"updatePhoto",value:(c=o((function*(e){this.signal.abort();var t=new Mi;this.signal=t,this.mask.enabled=!1,this.defaultAvatar.active=!UM.isAvatarCached(e.playerId,128),this.avatar.spriteFrame=null;var n=e.playerId,i=e.photo,a=yield UM.getPlayerAvatar(i,n,128,t);a&&!t.aborted&&this.setPhoto(a)})),function(e){return c.apply(this,arguments)})},{key:"setPhoto",value:(u=o((function*(e){if(this.node.active){e.packable=!0,this.avatar.spriteFrame=e;var t=re(this.avatarOpacity).to(.2,{opacity:255});yield p.runTweenAsync(t,this.signal),this.enabledInHierarchy&&(this.mask.enabled=!0,this.defaultAvatar.active=!1)}})),function(e){return u.apply(this,arguments)})},{key:"updateScore",value:function(e){if(this.scoreLabel){var t=Math.floor(e.score);this.scoreLabel.string=e6.getShortNumber(t,7)}}},{key:"runShowUpAnimation",value:(r=o((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,n=arguments.length>2?arguments[2]:void 0;this.node.scale=be.ZERO;var i=re(this.node).delay(e).to(t,{scale:new be(1,1,1)},{easing:"backOut"}),a=re(this.uiOpacity).delay(e).to(t,{opacity:255});yield Promise.all([p.runTweenAsync(i,n),p.runTweenAsync(a,n)])})),function(e){return r.apply(this,arguments)})},{key:"setVisible",value:function(e){var t=e?255:0;this.uiOpacity.opacity=t,this.avatarOpacity.opacity=t}}]),h}(te)).prototype,"nameLabel",[W5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o3=a(i3.prototype,"defaultAvatar",[K5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r3=a(i3.prototype,"avatar",[j5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l3=a(i3.prototype,"mask",[Y5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s3=a(i3.prototype,"avatarOpacity",[X5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u3=a(i3.prototype,"scoreLabel",[J5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c3=a(i3.prototype,"uiOpacity",[Z5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(i3.prototype,"updateInfo",[Q5],Object.getOwnPropertyDescriptor(i3.prototype,"updateInfo"),i3.prototype),a(i3.prototype,"updatePhoto",[e3],Object.getOwnPropertyDescriptor(i3.prototype,"updatePhoto"),i3.prototype),a(i3.prototype,"setPhoto",[t3],Object.getOwnPropertyDescriptor(i3.prototype,"setPhoto"),i3.prototype),n3=i3))||n3);X._RF.pop(),X._RF.push({},"8cd04RxbahLDaxq9FJf6hBh","TournamentBlock",void 0);var n6,i6,a6,o6,r6,l6=Z.ccclass,s6=Z.property,u6=codex,c6=u6.leaderboard,d6=u6.player,h6=u6.language,p6=Ludex.Utils,y6=p6.Time,v6=p6.Object,f6=p6.Array,g6=p6.Number,m6=(d3=l6("TournamentBlock"),h3=Yn.required(),p3=s6(me),y3=Yn.required(),v3=s6(ke),f3=Yn.required(),g3=s6({type:Lh,group:"Localize"}),m3=Yn.required(),b3=s6({type:Lh,group:"Localize"}),w3=Yn.required(),S3=s6({type:Lh,group:"Localize"}),k3=Yn.required(),C3=s6({type:Lh,group:"Localize"}),E3=Yn.required(),A3=s6(ne),T3=Yn.required(),P3=s6(de),L3=Yn.required(),O3=s6({type:he,group:"Banner"}),I3=Yn.required(),R3=s6({type:me,group:"Banner"}),_3=Yn.required(),D3=s6({type:me,group:"Banner"}),N3=Yn.required(),M3=s6(t6),F3=Yn.onlyRunInLifeCycleAsync,B3=Yn.onlyRunInLifeCycle,d3((U3=a((z3=function(a){n(g,a);var u,c,d,h,y,v,f=i(g);function g(){var e;t(this,g);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=f.call.apply(f,[this].concat(i)),l(e,"container",U3,s(e)),l(e,"title",G3,s(e)),l(e,"titleLocalizer",H3,s(e)),l(e,"timeLocalizer",q3,s(e)),l(e,"playerCountLocalizer",V3,s(e)),l(e,"playButtonLocalize",$3,s(e)),l(e,"uiTransform",W3,s(e)),l(e,"uiOpacity",K3,s(e)),l(e,"banner",j3,s(e)),l(e,"bannerMask",Y3,s(e)),l(e,"bannerLoadingRing",X3,s(e)),l(e,"topLeader",J3,s(e)),e.hasPlayedAnimation=!1,e}return e(g,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,g)}},{key:"updateInfo",value:(v=o((function*(e){this.payload=e;var t=e.endTime,n=e.title,i=e.payload.playerName,a=e.tournamentType,o=e.payload,r=o.leaderboardId,l=o.themeId,s=void 0===l?$.AUTUMN:l;r&&(this.topLeader.setVisible(!1),this.topLeader.node.active=!1,this.setPlayerCountWaiting(),"PAGE_HOSTED"===a?this.updateTitleTournamentTitle(n):this.updateTitleWithPlayerName(null!=i?i:n),this.updateEndTime(t),this.updateTournamentBanner(s),yield this.fetchAndUpdateLeadersPayload(r,{leaders:[],amountPlayer:0},n))})),function(e){return v.apply(this,arguments)})},{key:"fetchAndUpdateLeadersPayload",value:(y=o((function*(e,t,n){var i=t;try{var a=yield this.getLeadersPayload(e);a&&(i=a)}catch(e){console.error("Fetch lb for tournament ".concat(n),e)}this.updateLeadersPayload(i)})),function(e,t,n){return y.apply(this,arguments)})},{key:"updateLeadersPayload",value:function(e){this.leadersPayload=e;var t=this.leadersPayload,n=t.player,i=t.amountPlayer,a=t.leaders;this.updatePlayerCount(i),this.updatePlayButtonLabel(void 0!==n),this.updateTopLeader(null!=a?a:[])}},{key:"updateTitleWithPlayerName",value:function(e){void 0!==e&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([e]))}},{key:"updateTitleTournamentTitle",value:function(e){this.titleLocalizer.enabled=!1,this.title.string=e}},{key:"updateEndTime",value:function(e){try{var t=y6.getRelativeTime(e,h6.getCurrentLocale());this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([t])}catch(e){this.timeLocalizer.key="game.endsSoon"}}},{key:"updatePlayerCount",value:function(e){var t=g6.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"updateTopLeader",value:(h=o((function*(e){if(0!==e.length){var t,n=e[0];if(n)Ludex.Configs.Mockup.Leaderboards.Enabled&&(n=null!==(t=f6.search(e,(function(e){return 1===e.rank})))&&void 0!==t?t:n),this.topLeader.node.active=!0,this.topLeader.updateInfo(n),this.topLeader.runShowUpAnimation(0,.2)}})),function(e){return h.apply(this,arguments)})},{key:"updateTournamentBanner",value:(d=o((function*(e){var t=r.getAsset("".concat(j[e],"/spriteFrame"),xe);t||(this.bannerMask.active=!0,this.bannerLoadingRing.active=!0,t=yield r.loadThemePreviewAsync(e)),t||(t=yield r.loadThemePreviewAsync($.SUMMER)),this.banner&&t&&(this.banner.spriteFrame=t,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1)})),function(e){return d.apply(this,arguments)})},{key:"updatePlayButtonLabel",value:function(e){this.playButtonLocalize.key=e?"game.continue":"game.join"}},{key:"getLeadersPayload",value:(c=o((function*(e){var t,n=c6.getLeaderboardName(e);if(!n)return null;var i=yield tN.getAllLeaderboardAsync(e);if(!i)return null;var a=v6.vals(i.leaders);a.sort((function(e,t){return e.rank-t.rank}));var o=d6.getPlayerId(),r=yield c6.getLeadersByPlayerIdsAsync(n,[o]),l={leaders:a,amountPlayer:null!==(t=i.amountPlayer)&&void 0!==t?t:0};return r.length>0&&(l.player=r[0]),l})),function(e){return c.apply(this,arguments)})},{key:"runShowPopUpAnimation",value:(u=o((function*(e,t,n){var i=this;this.node.scale=new be(.8,.8,.8),this.uiOpacity.opacity=0;var a=this.container.position.clone();this.container.position=new be(a.x,a.y-100,a.z);var o=re(this.node).delay(e);o.to(t,{scale:be.ONE},{easing:"elasticOut"});var r=re(this.container).delay(e);r.to(t,{position:a},{easing:"backOut"});var l=re(this.uiOpacity).delay(e);l.to(t,{opacity:255},{easing:"cubicOut"});var s=function(){i.node.setScale(be.ONE),i.container.setPosition(a),i.uiOpacity.opacity=255};n.addAbortListener(s),yield Promise.all([p.runTweenAsync(o,n),p.runTweenAsync(r,n),p.runTweenAsync(l,n)]),n.removeAbortListener(s)})),function(e,t,n){return u.apply(this,arguments)})},{key:"handleOnTournamentClicked",value:function(){var e=this.payload.id||"";if(U.validateTournamentExpired(e))return this.node.scene.emit(sv.RELOAD_TOURNAMENT),void x.showNotificationScreenWithLocalizedKey("error.tourEnded",2);try{var t=JSON.stringify(this.payload),n=this.leadersPayload.player?"tournament_end":"tournament_start";x.showTournamentDetailScreen(t,n,this.hasPlayedAnimation),this.hasPlayedAnimation=!0}catch(e){console.warn("handleOnTournamentClicked",e)}}}]),g}(te)).prototype,"container",[h3,p3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G3=a(z3.prototype,"title",[y3,v3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H3=a(z3.prototype,"titleLocalizer",[f3,g3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q3=a(z3.prototype,"timeLocalizer",[m3,b3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V3=a(z3.prototype,"playerCountLocalizer",[w3,S3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$3=a(z3.prototype,"playButtonLocalize",[k3,C3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W3=a(z3.prototype,"uiTransform",[E3,A3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K3=a(z3.prototype,"uiOpacity",[T3,P3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j3=a(z3.prototype,"banner",[L3,O3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y3=a(z3.prototype,"bannerMask",[I3,R3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X3=a(z3.prototype,"bannerLoadingRing",[_3,D3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J3=a(z3.prototype,"topLeader",[N3,M3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(z3.prototype,"fetchAndUpdateLeadersPayload",[F3],Object.getOwnPropertyDescriptor(z3.prototype,"fetchAndUpdateLeadersPayload"),z3.prototype),a(z3.prototype,"updateLeadersPayload",[B3],Object.getOwnPropertyDescriptor(z3.prototype,"updateLeadersPayload"),z3.prototype),x3=z3))||x3);X._RF.pop(),X._RF.push({},"a409buwLfZLQq7cmBGiqhF5","TournamentBlockSkeleton",void 0);var b6,w6,S6,k6,C6,E6,A6,T6,P6,L6,O6,I6=Z.ccclass,R6=Z.property,_6=(n6=I6("TournamentBlockSkeleton"),i6=R6(me),n6((r6=a((o6=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"container",r6,s(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"hide",value:(u=o((function*(e){var t=this;yield p.runTweenAsync(re(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(r=o((function*(e,t){var n=this;this.node.active=!0,this.node.scale=new be(.8,.8,.8),this.uiOpacity.opacity=0;var i=this.container.position.clone();this.container.position=new be(i.x,i.y-100,i.z);var a=re(this.node).delay(e);a.to(.2,{scale:be.ONE},{easing:"elasticOut"});var o=re(this.container).delay(e);o.to(.2,{position:i},{easing:"backOut"});var r=re(this.uiOpacity).delay(e);r.to(.2,{opacity:255},{easing:"cubicOut"});var l=function(){n.node.setScale(be.ONE),n.container.setPosition(i),n.uiOpacity.opacity=255};t.addAbortListener(l),yield Promise.all([p.runTweenAsync(a,t),p.runTweenAsync(o,t),p.runTweenAsync(r,t)]),t.removeAbortListener(l)})),function(e,t){return r.apply(this,arguments)})}]),d}(te)).prototype,"container",[i6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a6=o6))||a6);X._RF.pop(),X._RF.push({},"5f82fye3oxHQrxKbP9TC2di","TournamentsBoard",void 0);var D6,N6=Z.ccclass,M6=Z.property,F6=codex.player,B6=(b6=N6("TournamentsBoard"),w6=M6($e),S6=M6(le),k6=M6(me),C6=M6(ne),b6((T6=a((A6=function(a){n(d,a);var r,u=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"tournamentBlockPrefab",T6,s(e)),e.tournamentBlockArray=[],l(e,"layout",P6,s(e)),l(e,"createTournamentButton",L6,s(e)),l(e,"viewport",O6,s(e)),e}return e(d,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"start",value:function(){for(var e=0;e<6;e++)this.addTournamentBlock();var t=this.tournamentBlockArray[0];t&&(this.tournamentBlockContentHeight=t.uiTransform.contentSize.height+this.layout.spacingY)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"updateData",value:function(e){var t=this,n=!1;e.forEach((function(e,i){var a=t.tournamentBlockArray[i];e.payload.playerId===F6.getPlayerId()&&(n=!0),a||(a=t.addTournamentBlock()),a.node.active=!0,a.updateInfo(e)})),n||this.setCreateTournamentButtonActive(!0)}},{key:"addTournamentBlock",value:function(){var e=qe(this.tournamentBlockPrefab);this.layout.node.addChild(e),e.active=!1;var t=e.getComponent(m6);return this.tournamentBlockArray.push(t),t}},{key:"removeTournamentBlocks",value:function(){var e,t=this.getActiveTournamentBlocks(),n=c(t);try{for(n.s();!(e=n.n()).done;){e.value.node.active=!1}}catch(e){n.e(e)}finally{n.f()}this.setCreateTournamentButtonActive(!1)}},{key:"getActiveTournamentBlocks",value:function(){var e=this;return this.tournamentBlockArray.filter((function(t){return t.node.parent===e.layout.node}))}},{key:"setCreateTournamentButtonActive",value:function(e){GameSDK.isGameSDK("FacebookInstant")&&(e?this.layout.node.addChild(this.createTournamentButton):this.layout.node.removeChild(this.createTournamentButton),this.createTournamentButton.active=e)}},{key:"showTournamentBlocks",value:(r=o((function*(e,t){var n=this.getActiveTournamentBlocks();if(!(n.length<1)){var i=Math.ceil(e/this.tournamentBlockContentHeight),a=Math.min(n.length,i);yield Promise.all(n.map(function(){var e=o((function*(e,n){n<a?yield e.runShowPopUpAnimation(.1*n,.3,t):e.uiOpacity.opacity=255}));return function(t,n){return e.apply(this,arguments)}}()))}})),function(e,t){return r.apply(this,arguments)})},{key:"updateVisibility",value:function(){var e,t=this.viewport.getBoundingBoxToWorld(),n=t.yMax,i=t.yMin,a=this.getActiveTournamentBlocks(),o=c(a);try{for(o.s();!(e=o.n()).done;){var r=e.value,l=r.uiTransform;if(void 0!==l){var s=l.getBoundingBoxToWorld(),u=s.yMax,d=s.yMin,h=u<i||d>n;r.uiOpacity.opacity=h?0:255}}}catch(e){o.e(e)}finally{o.f()}}}]),d}(te)).prototype,"tournamentBlockPrefab",[w6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P6=a(A6.prototype,"layout",[S6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L6=a(A6.prototype,"createTournamentButton",[k6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O6=a(A6.prototype,"viewport",[C6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E6=A6))||E6);X._RF.pop(),X._RF.push({},"f8a7b0St3FAkb1PvvvJTLCh","TournamentsNotAvailable",void 0);var x6,z6,U6,G6,H6,q6,V6,$6,W6,K6,j6,Y6,X6,J6,Z6,Q6=(0,Z.ccclass)("TournamentsNotAvailable")(D6=function(a){n(s,a);var r,l=i(s);function s(){return t(this,s),l.apply(this,arguments)}return e(s,[{key:"onLoad",value:function(){this.hide()}},{key:"show",value:(r=o((function*(){this.node.active=!0;var e=this.node.position.clone(),t=re(this.node);t.to(.05,{position:e.clone().add3f(5,0,0)}),t.to(.05,{position:e.clone().add3f(-5,0,0)});var n=re(this.node).repeat(2,t);n.to(.05,{position:e}),yield p.runTweenAsync(n)})),function(){return r.apply(this,arguments)})},{key:"hide",value:function(){this.node.active=!1}}]),s}(te))||D6;X._RF.pop(),X._RF.push({},"199fcQ5IEZFbJCfSrGNrGDQ","TournamentContent",void 0);var e4,t4,n4,i4,a4,o4,r4,l4,s4,u4=Z.ccclass,c4=Z.property,d4=codex,h4=d4.storage,p4=d4.match,y4=Ludex.Utils,v4=y4.Object,f4=y4.Array,g4=(x6=u4("TournamentContent"),z6=c4({type:ku}),U6=c4(B6),G6=c4(Q6),H6=c4(ft),q6=c4({type:[_6]}),V6=c4(qr),x6((K6=a((W6=function(a){n(p,a);var r,u,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),l(e,"panelAnimator",K6,s(e)),l(e,"tournamentsBoard",j6,s(e)),l(e,"tournamentsNotAvailable",Y6,s(e)),l(e,"scrollView",X6,s(e)),l(e,"skeletons",J6,s(e)),l(e,"contentOpacity",Z6,s(e)),e.animAbortSignal=null,e.softAbortSignal=null,e.hideContent=function(){e.contentOpacity.changeStateFade(!1,.1)},e.showContent=function(){e.contentOpacity.changeStateFade(!0,.1)},e}return e(p,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(ne),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.scrollView.node.on(ft.EventType.SCROLLING,this.onScrolling,this),this.node.scene.on(sv.RELOAD_TOURNAMENT,this.reload,this),this.node.scene.on(Js.HIDE_UI,this.hideContent),this.node.scene.on(Js.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(ft.EventType.SCROLLING,this.onScrolling,this),this.node.scene.off(sv.RELOAD_TOURNAMENT,this.reload,this),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(Js.HIDE_UI,this.hideContent),this.node.scene.off(Js.SHOW_UI,this.showContent)}},{key:"onScrolling",value:function(){this.tournamentsBoard.updateVisibility()}},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"enter",value:(d=o((function*(){var e;if(null===this.animAbortSignal&&null===this.softAbortSignal&&(this.animAbortSignal=new Mi,this.softAbortSignal=new Mi,yield this.showLoading(this.animAbortSignal),!this.isAborted())){var t=yield U.requestTournamentDataAsync();this.isAborted()||(yield this.hideLoading(this.animAbortSignal),this.isAborted()||(0!==t.length||null!==(e=this.softAbortSignal)&&void 0!==e&&e.aborted?(this.tournamentsNotAvailable.hide(),this.tryShowTournamentResult(),this.scrollView.enabled=!0,this.tournamentsBoard.updateData(t),yield this.tournamentsBoard.showTournamentBlocks(this.uiTransform.contentSize.height-this.tournamentsBoard.layout.paddingTop,this.animAbortSignal),this.tournamentsBoard.updateVisibility()):this.tournamentsNotAvailable.show()))}})),function(){return d.apply(this,arguments)})},{key:"showLoading",value:(c=o((function*(e){this.scrollView.scrollToTop(0),this.scrollView.enabled=!1,yield Promise.all([this.skeletons.map((function(t){return t.show(0,e)}))])})),function(e){return c.apply(this,arguments)})},{key:"hideLoading",value:(u=o((function*(e){yield Promise.all([this.skeletons.map((function(t){return t.hide(e)}))])})),function(e){return u.apply(this,arguments)})},{key:"tryShowTournamentResult",value:function(){try{if(!h4.getStorage("tournament").animateTournamentLeader)return;var e=U.getAllTournamentData(),t=p4.getMatchState().customData.tournamentId;if(!t)throw new Error("Tournament ID not found");var n=f4.search(e,(function(e){return e.id===t}));if(!n)throw new Error("Tournament not found");var i=JSON.stringify(n);x.showTournamentDetailScreen(i,"tournament_end")}catch(e){h4.setStorageData("tournament","animateTournamentLeader",!1),console.warn("showTournamentResult",e)}}},{key:"processCreateTournament",value:(r=o((function*(){try{yield Iv.processCreateTournamentAsync()}catch(e){if(!v4.hasOwn(e,"code"))return void x.showNotificationScreenWithLocalizedKey("error.createTourFail",2);if("USER_INPUT"===e.code)return;if("PLAYER_HAS_TOURNAMENT"===e.code)return void x.showNotificationScreenWithLocalizedKey("error.tourExists",2);"INVALID_OPERATION"===e.code&&v4.hasOwn(e,"message")&&"string"==typeof e.message&&x.showNotificationScreen(e.message,2),x.showNotificationScreenWithLocalizedKey("error.createTourFail",2)}this.reload()})),function(){return r.apply(this,arguments)})},{key:"isAborted",value:function(){var e,t;return null===(e=null===(t=this.animAbortSignal)||void 0===t?void 0:t.aborted)||void 0===e||e}},{key:"cleanup",value:function(){var e;this.unlistenEvents(),null===(e=this.animAbortSignal)||void 0===e||e.abort(),this.animAbortSignal=null,this.tournamentsBoard.removeTournamentBlocks(),this.tournamentsNotAvailable.hide()}},{key:"softAbort",value:function(){var e;null===(e=this.softAbortSignal)||void 0===e||e.abort(),this.softAbortSignal=null}},{key:"reload",value:function(){this.softAbort(),this.cleanup(),this.listenEvents(),this.enter()}}]),p}(te)).prototype,"panelAnimator",[z6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j6=a(W6.prototype,"tournamentsBoard",[U6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y6=a(W6.prototype,"tournamentsNotAvailable",[G6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X6=a(W6.prototype,"scrollView",[H6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J6=a(W6.prototype,"skeletons",[q6],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z6=a(W6.prototype,"contentOpacity",[V6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$6=W6))||$6);X._RF.pop(),X._RF.push({},"bce5eh0LHVP2bCJ6u+kFjuA","TournamentPage",void 0);var m4,b4,w4,S4,k4,C4;e4=(0,Z.ccclass)("TournamentPage"),t4=Yn.required(),n4=Yn.onlyRunInLifeCycleAsync,i4=Yn.onlyRunInLifeCycle,a4=Yn.onlyRunInLifeCycleAsync,o4=Yn.onlyRunInLifeCycleAsync,e4((s4=a((l4=function(a){n(f,a);var r,u,c,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"panelAnimationController",s4,s(e)),e}return e(f,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(fu),d(h(f.prototype),"onLoad",this).call(this)}},{key:"start",value:(y=o((function*(){d(h(f.prototype),"start",this).call(this)})),function(){return y.apply(this,arguments)})},{key:"mount",value:(c=o((function*(){yield d(h(f.prototype),"mount",this).call(this),this.onMount()})),function(){return c.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(g4),!this.content)throw new Error("LeaderboardPage: Leaders not found")}},{key:"transitionIn",value:(u=o((function*(){yield d(h(f.prototype),"transitionIn",this).call(this);var e=p.runTweenAsync(re(this.containerUIOpacity).to(.2,{opacity:255})),t=this.panelAnimationController.showUI();this.content.listenEvents(),yield Promise.all([e,t]),this.content.enter()})),function(){return u.apply(this,arguments)})},{key:"transitionOut",value:(r=o((function*(){var e;null===(e=this.content)||void 0===e||e.softAbort(),this.content.unlistenUIEvents(),yield d(h(f.prototype),"transitionOut",this).call(this),yield this.panelAnimationController.hideUI()})),function(){return r.apply(this,arguments)})},{key:"unmount",value:function(){var e;null===(e=this.content)||void 0===e||e.cleanup(),d(h(f.prototype),"unmount",this).call(this)}}]),f}(aJ)).prototype,"panelAnimationController",[t4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(l4.prototype,"mount",[n4],Object.getOwnPropertyDescriptor(l4.prototype,"mount"),l4.prototype),a(l4.prototype,"onMount",[i4],Object.getOwnPropertyDescriptor(l4.prototype,"onMount"),l4.prototype),a(l4.prototype,"transitionIn",[a4],Object.getOwnPropertyDescriptor(l4.prototype,"transitionIn"),l4.prototype),a(l4.prototype,"transitionOut",[o4],Object.getOwnPropertyDescriptor(l4.prototype,"transitionOut"),l4.prototype),r4=l4));X._RF.pop(),X._RF.push({},"b8271vI+3pO9q8SKMYpqLKv","EventBadge",void 0);var E4,A4,T4,P4,L4,O4,I4,R4,_4,D4=Z.ccclass,N4=Z.property;m4=D4("EventBadge"),b4=N4(ke),w4=N4(Q),m4((C4=a((k4=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"label",C4,s(e)),e}return e(r,[{key:"text",get:function(){return this.label.string},set:function(e){this.label.string=e}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.label)throw new Error("EventBadge: Missing required component Label")}}]),r}(te)).prototype,"label",[b4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(k4.prototype,"text",[w4],Object.getOwnPropertyDescriptor(k4.prototype,"text"),k4.prototype),S4=k4));X._RF.pop(),X._RF.push({},"7712cs4XLJAgpKqlO3gPqkF","EventProgressBar",void 0);var M4,F4,B4,x4,z4,U4,G4,H4,q4,V4,$4,W4,K4,j4,Y4,X4,J4,Z4,Q4,e9,t9,n9,i9,a9,o9,r9,l9,s9,u9,c9,d9,h9,p9,y9,v9,f9,g9,m9,b9,w9,S9,k9,C9,E9,A9,T9,P9,L9,O9=Z.ccclass,I9=Z.property;E4=O9("EventProgressBar"),A4=I9(id),T4=I9(ke),P4=I9(Q),L4=I9({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress"}),E4((R4=a((I4=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"progressBar",R4,s(e)),l(e,"progressLabel",_4,s(e)),e}return e(r,[{key:"text",get:function(){return this.progressLabel.string},set:function(e){this.progressLabel.string=e}},{key:"progress",get:function(){return this.progressBar.progress},set:function(e){this.progressBar.progress=e}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("EventProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("EventProgressBar: Missing required component Label")}}]),r}(te)).prototype,"progressBar",[A4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_4=a(I4.prototype,"progressLabel",[T4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(I4.prototype,"text",[P4],Object.getOwnPropertyDescriptor(I4.prototype,"text"),I4.prototype),a(I4.prototype,"progress",[L4],Object.getOwnPropertyDescriptor(I4.prototype,"progress"),I4.prototype),O4=I4));X._RF.pop(),X._RF.push({},"7741dWPNcdHRqGVvif/L/MP","NavButton",void 0);var R9,_9,D9,N9,M9,F9,B9,x9=Z.ccclass,z9=Z.property,U9=Z.executeInEditMode,G9=codex.analytics,H9=(null!==(M4=Ludex.Plugins.Analytics)&&void 0!==M4?M4:{}).Events;F4=x9("NavButton"),B4=z9(Se),x4=z9({group:{name:"Animation"},displayName:"Is Selected",tooltip:"This is for the editor only and will be ignored at runtime",editorOnly:!0}),z4=z9({type:ae,group:{name:"Animation"}}),U4=z9({type:ae,group:{name:"Animation"}}),G4=z9({type:ae,group:{name:"Animation"}}),H4=z9({type:ae,group:{name:"Animation"}}),q4=z9({type:ae,group:{name:"Animation"}}),V4=z9({group:{name:"Animation"}}),$4=z9({type:ae,group:{name:"Animation"}}),W4=z9({type:ae,group:{name:"Animation"}}),K4=z9({group:{name:"Animation"}}),j4=z9({type:ae,group:{name:"Animation"}}),Y4=z9({type:ae,group:{name:"Animation"}}),X4=z9({type:ae,group:{name:"Animation"}}),J4=z9({type:ae,group:{name:"Animation"}}),Z4=z9({type:ae,group:{name:"Animation"}}),Q4=z9({type:ne}),e9=z9(me),t9=z9(de),n9=z9({type:ne}),i9=z9({type:pe(Ln)}),a9=z9(uQ),F4(o9=U9((l9=a((r9=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"wip",l9,s(e)),l(e,"isSelectedInEditor",s9,s(e)),l(e,"animationDuration",u9,s(e)),l(e,"selectedSpacing",c9,s(e)),l(e,"deselectedSpacing",d9,s(e)),l(e,"selectedIconY",h9,s(e)),l(e,"selectedIconX",p9,s(e)),l(e,"selectedIconScale",y9,s(e)),l(e,"deselectedIconY",v9,s(e)),l(e,"deselectedIconX",f9,s(e)),l(e,"deselectedIconScale",g9,s(e)),l(e,"initTextY",m9,s(e)),l(e,"selectedTextY",b9,s(e)),l(e,"selectedTextX",w9,s(e)),l(e,"deselectedTextY",S9,s(e)),l(e,"deselectedTextX",k9,s(e)),l(e,"spacer",C9,s(e)),l(e,"icon",E9,s(e)),l(e,"text",A9,s(e)),l(e,"uiTransform",T9,s(e)),l(e,"screenType",P9,s(e)),l(e,"navManager",L9,s(e)),e.isSelected=!1,e.onMouseEnter=function(t){e.isSelected||e.playHoverOnAnimation()},e.onMouseLeave=function(t){e.isSelected||e.playHoverOffAnimation()},e}return e(d,[{key:"isWIP",get:function(){return this.wip}},{key:"buttonType",get:function(){return this.screenType}},{key:"update",value:function(){}},{key:"onEnable",value:function(){this.node.on(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(me.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(me.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onEditorUpdate",value:function(){null!==this.icon&&void 0!==this.icon&&null!==this.text&&void 0!==this.icon&&null!==this.spacer&&void 0!==this.spacer&&(this.isSelectedInEditor?(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.initTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0))}},{key:"setSelected",value:function(){var e,t;this.isSelected||(w.playSound(Qi.PATCH_SHIFT),this.navManager.selectUsingSceneTransition(this),H9&&G9.event(H9.BUTTON_CLICK,{button_name:null!==(e=null===(t=this.node.parent)||void 0===t?void 0:t.name)&&void 0!==e?e:this.node.name,screen_name:S.getCurrentPage()}))}},{key:"select",value:(u=o((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.isSelected)throw new Error("NavButton: Already selected");this.isSelected=!0,e?yield p.runTweenAsync(this.playSelectAnimation()):(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255)})),function(){return u.apply(this,arguments)})},{key:"deselect",value:(r=o((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isSelected&&!t)throw new Error("NavButton: Already deselected");this.isSelected=!1,e?yield p.runTweenAsync(this.deselectAnimation()):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.deselectedTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0)})),function(){return r.apply(this,arguments)})},{key:"getSelectedWorldDistanceX",value:function(){var e=new be(this.selectedIconX,this.selectedIconY,0),t=new be(this.deselectedIconX,this.deselectedIconY,0),n=this.node.scale.clone();this.node.scale=this.selectedIconScale;var i=this.uiTransform.convertToWorldSpaceAR(e),a=this.uiTransform.convertToWorldSpaceAR(t);return this.node.scale=n,a.x-i.x}},{key:"playHoverOnAnimation",value:function(){var e=re(this.icon);return e.to(.1,{scale:this.deselectedIconScale.clone().add3f(.1,.1,0)},{easing:"cubicIn"}),p.runTweenAsync(e)}},{key:"playHoverOffAnimation",value:function(){var e=re(this.icon);return e.to(.1,{scale:this.deselectedIconScale},{easing:"cubicOut"}),p.runTweenAsync(e)}},{key:"playSelectAnimation",value:function(){var e=this;return re(this.spacer).to(this.animationDuration,{width:this.selectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=ye.quintInOut(n),a=ye.backOut(n),o=ye.linear(n),r=n<.5?2*n:1,l=e.deselectedIconY+(e.selectedIconY-e.deselectedIconY)*a,s=e.deselectedIconX+(e.selectedIconX-e.deselectedIconX)*o;e.icon.setPosition(s,l,0);var u=e.deselectedIconScale.clone().lerp(e.selectedIconScale,i);e.icon.setScale(u.x,u.y,e.icon.scale.z);var c=255*r,d=e.deselectedTextY+(e.selectedTextY-e.deselectedTextY)*o,h=e.deselectedTextX+(e.selectedTextX-e.deselectedTextX)*o;e.text.opacity=c,e.text.node.setPosition(h,d,0)}}})}},{key:"deselectAnimation",value:function(){var e=this;return re(this.spacer).to(this.animationDuration,{width:this.deselectedSpacing},{easing:"linear",onUpdate:function(t,n){if(void 0!==n){var i=Xe(e.selectedIconY,e.deselectedIconY,n),a=Xe(e.selectedIconX,e.deselectedIconX,n);e.icon.setPosition(a,i,0);var o=Xe(255,0,n<.5?2*n:1);e.text.opacity=o;var r=Xe(e.selectedTextY,e.deselectedTextY,n),l=Xe(e.selectedTextX,e.deselectedTextX,n);e.text.node.setPosition(l,r,0);var s=e.selectedIconScale.clone().lerp(e.deselectedIconScale,ye.quintInOut(n));e.icon.setScale(s.x,s.y,e.icon.scale.z)}}})}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(ne),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}}]),d}(te)).prototype,"wip",[B4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s9=a(r9.prototype,"isSelectedInEditor",[x4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u9=a(r9.prototype,"animationDuration",[z4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),c9=a(r9.prototype,"selectedSpacing",[U4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),d9=a(r9.prototype,"deselectedSpacing",[G4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 88}}),h9=a(r9.prototype,"selectedIconY",[H4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),p9=a(r9.prototype,"selectedIconX",[q4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y9=a(r9.prototype,"selectedIconScale",[V4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(1,1,1)}}),v9=a(r9.prototype,"deselectedIconY",[$4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),f9=a(r9.prototype,"deselectedIconX",[W4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g9=a(r9.prototype,"deselectedIconScale",[K4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new be(.8,.8,1)}}),m9=a(r9.prototype,"initTextY",[j4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-100}}),b9=a(r9.prototype,"selectedTextY",[Y4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-10}}),w9=a(r9.prototype,"selectedTextX",[X4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),S9=a(r9.prototype,"deselectedTextY",[J4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k9=a(r9.prototype,"deselectedTextX",[Z4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C9=a(r9.prototype,"spacer",[Q4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E9=a(r9.prototype,"icon",[e9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A9=a(r9.prototype,"text",[t9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T9=a(r9.prototype,"uiTransform",[n9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P9=a(r9.prototype,"screenType",[i9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L9=a(r9.prototype,"navManager",[a9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o9=r9))||o9);X._RF.pop(),X._RF.push({},"091aai5+ANDeZfFN8JFkbyi","TournamentButton",void 0);var q9,V9,$9,W9,K9,j9,Y9,X9,J9=Ludex.Utils.Signal,Z9=Z.ccclass,Q9=Z.property,e8=new be(1.1,1.1);R9=Z9("TournamentButton"),_9=Yn.required(),D9=Q9(me),N9=Yn.onlyRunInLifeCycle,R9((B9=a((F9=function(a){n(v,a);var r,u,d,h,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"hotIcon",B9,s(e)),e.requestController=new J9.SignalController,e}return e(v,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this,v)}},{key:"onLoad",value:(h=o((function*(){yield this.handleHotIconAppearance()})),function(){return h.apply(this,arguments)})},{key:"onDestroy",value:function(){this.requestController.abort()}},{key:"handleHotIconAppearance",value:(d=o((function*(){GameSDK.isGameSDK("MsGames")?this.handleMsGamesHotIconCheck():this.handleNormalHotIconCheck()})),function(){return d.apply(this,arguments)})},{key:"handleMsGamesHotIconCheck",value:(u=o((function*(){try{var e=this.requestController.renew(),t=yield U.requestTournamentDataAsync();if(e.aborted)return;t.filter((function(e){return!U.validateTournamentExpired(e.id)})).length>=2&&this.showHotIcon(e)}catch(e){console.info("Error in TournamentButton",e)}})),function(){return u.apply(this,arguments)})},{key:"handleNormalHotIconCheck",value:(r=o((function*(){try{var e=this.requestController.renew(),t=yield U.requestTournamentDataAsync();if(e.aborted)return;var n,i=c(t);try{for(i.s();!(n=i.n()).done;){var a=n.value.payload,o=a.leaderboardId,r=a.playerId;if(o&&"global"===r){var l=yield tN.getAllLeaderboardAsync(o);if(l&&l.amountPlayer>=30){this.showHotIcon(e);break}}}}catch(e){i.e(e)}finally{i.f()}}catch(e){console.info("Error in TournamentButton",e)}})),function(){return r.apply(this,arguments)})},{key:"showHotIcon",value:function(e){this.hotIcon.active=!0,this.hotIcon.setScale(be.ZERO);var t=re(this.hotIcon).delay(1).to(.3,{scale:e8},{easing:"backIn"}).to(.3,{scale:be.ONE},{easing:"backOut"});p.runTweenAsync(re(this.hotIcon).to(.5,{scale:be.ONE},{easing:"backOut"}).repeatForever(t),e)}}]),v}(te)).prototype,"hotIcon",[_9,D9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(F9.prototype,"showHotIcon",[N9],Object.getOwnPropertyDescriptor(F9.prototype,"showHotIcon"),F9.prototype),M9=F9));X._RF.pop(),X._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var t8,n8,i8,a8,o8,r8,l8,s8=Z.ccclass,u8=Z.property,c8=Z.disallowMultiple,d8=codex,h8=d8.player,p8=d8.event,y8=m.Layout,v8=Ludex,f8=v8.Match.Modes,g8=v8.Events;q9=s8("GameScene"),V9=Yn.required(),$9=u8(ek),W9=Yn.onlyRunInLifeCycle,K9=Yn.onlyRunInLifeCycle,q9(j9=c8((X9=a((Y9=function(a){n(u,a);var r=i(u);function u(){var e;t(this,u);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=r.call.apply(r,[this].concat(i)),l(e,"coinManager",X9,s(e)),e.handleGameExit=function(){G.switchToDashboardScene()},e.handleShowResults=function(){G.switchScene(W.CHALLENGE_RESULT_SCENE)},e.handleGameMaskWhenLayoutChanged=function(e){var t=Me("Canvas/Game/GameObjects");if(t){var n=t.getComponent(gt);n&&(n.enabled=e===y8.Landscape)}},e.updateMusic=o((function*(){var e=Iv.getMatchMode()===f8.TOURNAMENT,t=e?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC;w.getCurrentMusic()!==t&&(yield w.setVolumeMusic(0,!0),yield p.waitTweenAsync(1)),w.playMusic(t,e),w.setVolumeMusic(e?.4:.3,!0)})),e}return e(u,[{key:"__preload",value:function(){Yn.validateRequiredProperties(this),JF.createLayer(this.node,"Particles",6),JF.createLayer(this.node,"GameUnpackLabel",5),this.listenGameEvents()}},{key:"onLoad",value:function(){this.coinManager.init()}},{key:"listenGameEvents",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(Js.GAME_EXIT,this.handleGameExit),this.node.scene.on(Js.SHOW_CHALLENGE_RESULTS,this.handleShowResults),this.node.scene.on(Js.UPDATE_MUSIC,this.updateMusic)}},{key:"start",value:function(){h8.getPlayerSetting("music")&&this.updateMusic(),this.scheduleOnce(this.preloadScenes,20),this.scheduleOnce(this.preloadScreens,10)}},{key:"preloadScenes",value:function(){G.preloadDashboardScene()}},{key:"preloadScreens",value:function(){var e,t=h8.getGameData(),n=null!==(e=null==t?void 0:t.level)&&void 0!==e?e:1;n%5==0&&x.preloadScreen(z.HARD_LEVEL_SCREEN),n>=N&&(x.preloadScreen(z.CONGRATULATION_SCREEN),x.preloadScreen(z.START_OVER_SCREEN)),x.preloadScreen(z.PAUSE_SCREEN),x.preloadScreen(z.LOADING_SCREEN),x.preloadScreen(z.GET_ITEM_SCREEN),x.preloadScreen(z.NOTIFICATION_SCREEN),this.node.scene.once(Js.GAME_FINISH,(function(){x.preloadScreen(z.LEVEL_COMPLETE_SCREEN),x.preloadScreen(z.GET_REWARDS_SCREEN)})),p8.once(g8.OPENED_SCREEN,(function(e){e.screenName===V[z.PAUSE_SCREEN]&&(x.preloadScreen(z.QUIT_LEVEL_SCREEN),x.preloadScreen(z.START_OVER_SCREEN),x.preloadScreen(z.CUSTOM_GAME_SCREEN))}))}}]),u}(te)).prototype,"coinManager",[V9,$9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Y9.prototype,"preloadScenes",[W9],Object.getOwnPropertyDescriptor(Y9.prototype,"preloadScenes"),Y9.prototype),a(Y9.prototype,"preloadScreens",[K9],Object.getOwnPropertyDescriptor(Y9.prototype,"preloadScreens"),Y9.prototype),j9=Y9))||j9);X._RF.pop(),X._RF.push({},"0c0b4cnFOFJ6pJmGNHnMo7m","ComboEffect",void 0);var m8,b8,w8,S8,k8,C8,E8,A8=Z.ccclass,T8=Z.property;t8=A8("ComboEffect"),n8=T8(de),i8=T8(Oe),t8((r8=a((o8=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"circleOpacity",r8,s(e)),l(e,"particle",l8,s(e)),e}return e(r,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Js.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){e>1&&(this.circleOpacity.node.scale=be.ZERO,this.circleOpacity.opacity=60,this.particle.node.active=!0,this.particle.resetSystem(),re(this.circleOpacity.node).to(.2,{scale:new be(1.3,1.3,1.3)},{easing:"quadOut"}).start(),re(this.circleOpacity).delay(.3).to(.2,{opacity:0},{easing:"expoIn"}).start()),0===e&&(this.particle.node.active=!1)}}]),r}(te)).prototype,"circleOpacity",[n8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l8=a(o8.prototype,"particle",[i8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a8=o8));X._RF.pop(),X._RF.push({},"0506aJZ1EdPqJejQ2PpB980","ComboLabel",void 0);var P8,L8,O8,I8,R8,_8,D8,N8,M8,F8,B8,x8,z8=Z.ccclass,U8=Z.property;m8=z8("ComboLabel"),b8=U8(ke),w8=U8(me),m8((C8=a((k8=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"comboNumber",C8,s(e)),l(e,"comboContainer",E8,s(e)),e}return e(r,[{key:"onLoad",value:function(){this.opacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(Js.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(e){e>1?(this.opacity.opacity=255,this.comboNumber.string="".concat(e),JF.setNodeToLayer(this.comboNumber.node,"GameUnpackLabel"),re(this.comboContainer).to(.1,{scale:new be(1.3,1.3,1.3)},{easing:"sineIn"}).to(.1,{scale:be.ONE},{easing:"sineOut"}).start()):(JF.removeNodeFromLayer(this.comboNumber.node),this.opacity.opacity=0)}}]),r}(te)).prototype,"comboNumber",[b8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E8=a(k8.prototype,"comboContainer",[w8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S8=k8));X._RF.pop(),X._RF.push({},"51871oF8CFOkp81rgCf90UQ","ComboPopup",void 0);var G8,H8,q8,V8,$8,W8,K8,j8,Y8,X8,J8,Z8,Q8,e7,t7,n7,i7,a7,o7=Ludex.Utils.Signal,r7=Z.ccclass,l7=Z.property,s7=m.Layout,u7=["good","great","excellent"];P8=r7("ComboPopup"),L8=Yn.required(),O8=l7(Lh),I8=Yn.required(),R8=l7(ze),_8=Yn.required(),D8=l7(de),P8((F8=a((M8=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"spriteLocalizer",F8,s(e)),l(e,"animation",B8,s(e)),l(e,"textUiOpacity",x8,s(e)),e.comboController=new o7.SignalController,e}return e(c,[{key:"__preload",value:function(){this.widget=this.getComponent(oe),Yn.validateRequiredProperties(this)}},{key:"onLoad",value:function(){se.on(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(P.getCurrentLayout())}},{key:"onDestroy",value:function(){se.off(y.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.comboController.abort()}},{key:"start",value:function(){this.node.scene.on(Js.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:(r=o((function*(e){if(!(e<2))for(var t=u7.length-1;t>=0;t--){var n=u7[t];if(e>=t+2){var i=this.comboController.renew();if(this.spriteLocalizer.key=n,this.textUiOpacity.opacity=0,yield this.spriteLocalizer.waitUntilLocalized(),i.aborted)return;return p.runTweenAsync(re(this.textUiOpacity).to(.25,{opacity:255}),i),void this.animation.play()}}})),function(e){return r.apply(this,arguments)})},{key:"handleOrientationChanged",value:function(e){e===s7.Portrait?(this.widget.left=20,this.widget.right=20):e===s7.Landscape&&(this.widget.left=700,this.widget.right=120)}}]),c}(te)).prototype,"spriteLocalizer",[L8,O8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B8=a(M8.prototype,"animation",[I8,R8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x8=a(M8.prototype,"textUiOpacity",[_8,D8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N8=M8));X._RF.pop(),X._RF.push({},"11abe47Ss1CtabSFT1/cPKt","PlayableScene",void 0);var c7,d7,h7,p7,y7,v7,f7,g7,m7,b7,w7,S7,k7,C7,E7,A7,T7=Z.ccclass,P7=Z.property,L7=Z.disallowMultiple,O7=codex.analytics;G8=T7("PlayableScene"),H8=Yn.required(),q8=P7({type:ke}),V8=Yn.required(),$8=P7({type:zT}),W8=Yn.required(),K8=P7({type:zT}),j8=Yn.required(),Y8=P7({type:ze}),X8=Yn.onlyRunInLifeCycleAsync,J8=Yn.onlyRunInLifeCycle,Z8=Yn.onlyRunInLifeCycle,G8(Q8=L7((t7=a((e7=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;return t(this,h),e=d.call(this),l(e,"label",t7,s(e)),l(e,"particleLeft",n7,s(e)),l(e,"particleRight",i7,s(e)),l(e,"backgroundAnimation",a7,s(e)),G.markIsTestScene(W.PLAYABLE_SCENE),e}return e(h,[{key:"__preload",value:function(){this.listenEvents()}},{key:"onLoad",value:function(){Yn.validateRequiredProperties(this)}},{key:"listenEvents",value:function(){}},{key:"start",value:(c=o((function*(){O7.event("ready_playable"),yield this.waitViewable(),this.playTweens(),this.playParticles(),this.playAnimations(),O7.event("showing_playable"),setTimeout((function(){"openAppStore"in GameSDK.extra&&GameSDK.extra.openAppStore()}),1e4)})),function(){return c.apply(this,arguments)})},{key:"waitViewable",value:(u=o((function*(){"isViewable"in GameSDK.extra&&(GameSDK.extra.isViewable()||"waitViewableChange"in GameSDK.extra&&(se.pause(),(yield GameSDK.extra.waitViewableChange())?se.resume():yield this.waitViewable()))})),function(){return u.apply(this,arguments)})},{key:"playTweens",value:(r=o((function*(){var e=re(this.label.node).to(10,{position:new be(0,200,0)},{easing:"cubicInOut"}).to(6,{position:new be(0,-100,0)},{easing:"cubicInOut"});p.runTweenAsync(re(this.label.node).repeat(999,e))})),function(){return r.apply(this,arguments)})},{key:"playParticles",value:function(){console.log("playParticles",this.particleLeft,this.particleRight),this.particleLeft.play(),this.particleRight.play()}},{key:"playAnimations",value:function(){this.backgroundAnimation.play()}}]),h}(te)).prototype,"label",[H8,q8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n7=a(e7.prototype,"particleLeft",[V8,$8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i7=a(e7.prototype,"particleRight",[W8,K8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a7=a(e7.prototype,"backgroundAnimation",[j8,Y8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(e7.prototype,"playTweens",[X8],Object.getOwnPropertyDescriptor(e7.prototype,"playTweens"),e7.prototype),a(e7.prototype,"playParticles",[J8],Object.getOwnPropertyDescriptor(e7.prototype,"playParticles"),e7.prototype),a(e7.prototype,"playAnimations",[Z8],Object.getOwnPropertyDescriptor(e7.prototype,"playAnimations"),e7.prototype),Q8=e7))||Q8);X._RF.pop(),X._RF.push({},"a0819yK3HpO2505QqLUOChz","PlayerScore",void 0);var I7,R7,_7,D7,N7,M7,F7,B7,x7,z7,U7,G7,H7,q7,V7,$7,W7,K7,j7,Y7,X7,J7,Z7,Q7,eee,tee,nee,iee,aee=Z.ccclass,oee=Z.property,ree=(c7=aee("PlayerScore"),d7=oee(me),h7=oee(ke),p7=oee(de),y7=oee(de),v7=oee(he),f7=oee(me),g7=Yn.onlyRunInLifeCycleAsync,c7((w7=a((b7=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"crown",w7,s(e)),l(e,"playerScore",S7,s(e)),l(e,"playerScoreUiOpacity",k7,s(e)),l(e,"waitingUiOpacity",C7,s(e)),l(e,"avatar",E7,s(e)),l(e,"defaultAvatarNode",A7,s(e)),e.avatarOverlay=null,e.isOverlayMode=!1,e}return e(d,[{key:"onLoad",value:function(){this.createAvatarOverlay()}},{key:"createAvatarOverlay",value:function(){try{SM.isOverlayViewAPIAvailable(GameSDK),this.isOverlayMode=!0,this.avatarOverlay=new AM(this.node.scene)}catch(e){return}}},{key:"showCrown",value:function(e){this.crown.active=e}},{key:"setPlayerScore",value:function(e){this.playerScore.string=e.toString()}},{key:"playWaitingAnimation",value:function(){this.waitingUiOpacity.node.active=!0,this.playerScoreUiOpacity.node.active=!1,this.waitingUiOpacity.opacity=130,this.playerScoreUiOpacity.opacity=0;var e=re(this.waitingUiOpacity).to(1,{opacity:130},{easing:"sineInOut"}).to(1,{opacity:255},{easing:"sineInOut"}).delay(.25);this.waitingAnimation=re(this.waitingUiOpacity).repeatForever(e).start()}},{key:"stopWaitingAnimation",value:function(){this.waitingAnimation&&this.waitingAnimation.stop(),this.waitingUiOpacity.opacity=0,this.playerScoreUiOpacity.opacity=255,this.waitingUiOpacity.node.active=!1,this.playerScoreUiOpacity.node.active=!0}},{key:"loadPhoto",value:(u=o((function*(e,t){try{var n="10"===t;if(this.isOverlayMode&&!n){if(yield this.showAvatarOverlay(t))return;this.isOverlayMode=!1}var i=yield UM.getPlayerAvatar(e,t,128);if(!i)throw new Error("Failed to create sprite frame");if(!this.node.activeInHierarchy)return;i.packable=!0,this.avatar.spriteFrame=i}catch(e){return void console.error(e)}})),function(e,t){return u.apply(this,arguments)})},{key:"showAvatarOverlay",value:(r=o((function*(e){if(!this.avatarOverlay)return!1;var t=this.getDefaultAvatarPosition(),n=t.worldX,i=t.worldY,a=yield this.avatarOverlay.updateOverlay({playerId:e,worldX:n,worldY:i,avatarWidth:this.getDefaultAvatarWidth()});return null!=a&&a})),function(e){return r.apply(this,arguments)})},{key:"cleanupOverlay",value:function(){var e;null===(e=this.avatarOverlay)||void 0===e||e.hideOverlay()}},{key:"getDefaultAvatarPosition",value:function(){var e=this.defaultAvatarNode;return{worldX:e.worldPositionX,worldY:e.worldPositionY}}},{key:"getDefaultAvatarWidth",value:function(){return this.defaultAvatarNode.getComponent(ne).width}}]),d}(te)).prototype,"crown",[d7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S7=a(b7.prototype,"playerScore",[h7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k7=a(b7.prototype,"playerScoreUiOpacity",[p7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C7=a(b7.prototype,"waitingUiOpacity",[y7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E7=a(b7.prototype,"avatar",[v7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A7=a(b7.prototype,"defaultAvatarNode",[f7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(b7.prototype,"loadPhoto",[g7],Object.getOwnPropertyDescriptor(b7.prototype,"loadPhoto"),b7.prototype),m7=b7))||m7);X._RF.pop(),X._RF.push({},"4b062RYQK5PQbgs7yH66gDw","ChallengeResultScene",void 0);var lee,see,uee,cee,dee,hee,pee,yee,vee,fee=Z.ccclass,gee=Z.disallowMultiple,mee=Z.property,bee=codex,wee=bee.match,See=bee.player,kee=bee.monitorError,Cee=Ludex.Utils.Object;I7=fee("ChallengeResultScene"),R7=mee(Lh),_7=mee(Lh),D7=mee(Lh),N7=mee(Lh),M7=mee({type:ree,group:"Score"}),F7=mee({type:ree,group:"Score"}),B7=mee({group:"Confetti Effect",type:zT}),x7=mee({group:"Confetti Effect",type:zT}),z7=mee(wf),U7=mee(ze),G7=Yn.onlyRunInLifeCycle,H7=Yn.onlyRunInLifeCycle,q7=Yn.onlyRunInLifeCycle,V7=Yn.onlyRunInLifeCycle,$7=Yn.onlyRunInLifeCycle,I7(W7=gee((j7=a((K7=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"drawLocalizer",j7,s(e)),l(e,"winLocalizer",Y7,s(e)),l(e,"loseLocalizer",X7,s(e)),l(e,"waitingLocalizer",J7,s(e)),l(e,"playerScore",Z7,s(e)),l(e,"opponentScore",Q7,s(e)),l(e,"leftConfetti",eee,s(e)),l(e,"rightConfetti",tee,s(e)),l(e,"levelManager",nee,s(e)),l(e,"headerAnimation",iee,s(e)),e.goToDashboardScene=function(){e.playerScore.cleanupOverlay(),e.opponentScore.cleanupOverlay(),G.switchToDashboardScene()},e.goToGameScene=function(){e.playerScore.cleanupOverlay(),e.opponentScore.cleanupOverlay(),G.switchToGameScene()},e}return e(c,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.node.scene.on(y.RESULT_SCENE_HOME,this.goToDashboardScene),this.node.scene.on(y.RESULT_SCENE_REPLAY,this.handleTryAgainClicked,this)}},{key:"start",value:function(){this.scheduleOnce(this.preloadScenes,3);try{var e,t,n=wee.getMatchState(),i=n.customData,a=i.playerId,o=i.opponentId;if(!a||!o)throw new Error("ResultScene: playerId is ".concat(a," and opponentId is ").concat(o,". Expected to not be null."));var r=See.getPlayer().photo,l=null!==(e=n.profiles[a])&&void 0!==e?e:{},s=l.score,u=void 0===s?0:s,c=l.finished,d=void 0!==c&&c,h=null!==(t=n.profiles[o])&&void 0!==t?t:{},p=h.photo,y=void 0===p?"":p,v=h.score,f=void 0===v?0:v,g=h.finished,m=void 0!==g&&g,b=d&&m,w=b&&u>f,S=b&&f>u;this.playerScore.loadPhoto(r,a),this.opponentScore.loadPhoto(y,o),this.playerScore.setPlayerScore(u),this.opponentScore.setPlayerScore(f),this.playerScore.showCrown(w),this.opponentScore.showCrown(S),d&&m?u===f?this.playStatusAnimation("Draw"):w?this.playStatusAnimation("Win"):S&&this.playStatusAnimation("Lose"):(d||this.playerScore.playWaitingAnimation(),m||this.opponentScore.playWaitingAnimation(),this.playStatusAnimation("Waiting"))}catch(e){console.warn("ResultScene: Error on load",e),this.goToDashboardScene()}}},{key:"preloadScenes",value:function(){G.preloadDashboardScene()}},{key:"handleTryAgainClicked",value:(r=o((function*(){var e,t=(null!==(e=See.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;n=Math.max(1,n);var i=yield this.levelManager.loadLevelData(n);try{if(!i)throw new Error("Level data is not found");var a=wee.getMatchState().customData.opponentId;if(!a)throw new Error("Opponent id is not found");x.showLoadingScreen();var o=wb.generateFen(i),r=i.mode,l=void 0===r?"":r,s=i.rules,u=void 0===s?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:s,c=i.time,d=void 0===c?0:c,h=i.level;yield wee.challenge.friend.processAsync({playerId:See.getPlayerId(),opponentId:a,extraData:{challengeData:{level:h,fen:o,gravity:l,rules:u,time:d}}}),x.closeLoadingScreen(),this.goToGameScene()}catch(e){if(Cee.hasOwn(e,"code")&&"USER_INPUT"===e.code)return void x.closeLoadingScreen();console.warn("ReplayChallengeFriend",e),x.closeLoadingScreen(),x.showNotificationScreenWithLocalizedKey("error.challengeFail",2),null==kee||kee.sendException(e instanceof Error?e:new Error("ReplayChallengeFriend"+JSON.stringify(e))),this.scheduleOnce(this.goToDashboardScene,2)}})),function(){return r.apply(this,arguments)})},{key:"handleHomeClicked",value:function(){this.goToDashboardScene()}},{key:"playStatusAnimation",value:function(e){var t=this;"Win"!==e&&"Waiting"!==e||this.triggerConfettiAnimation();var n=this.getSpriteLocalizer(e);n.node.active=!0,n.waitUntilLocalized().then((function(){switch(e){case"Draw":t.playDrawAnimation();break;case"Win":t.playWinAnimation();break;case"Lose":t.playLoseAnimation();break;case"Waiting":t.playWaitingAnimation()}}))}},{key:"getSpriteLocalizer",value:function(e){switch(e){case"Draw":return this.drawLocalizer;case"Win":return this.winLocalizer;case"Lose":return this.loseLocalizer;case"Waiting":return this.waitingLocalizer}}},{key:"playDrawAnimation",value:function(){this.headerAnimation.play("RibbonDraw"),w.playSound(Qi.LEVEL_FAIL)}},{key:"playWinAnimation",value:function(){this.headerAnimation.play("RibbonWin"),w.playSound(Qi.LEVEL_COMPLETE)}},{key:"playLoseAnimation",value:function(){this.headerAnimation.play("RibbonLose"),w.playSound(Qi.LEVEL_FAIL)}},{key:"playWaitingAnimation",value:function(){this.headerAnimation.play("RibbonWaiting"),w.playSound(Qi.LEVEL_COMPLETE)}},{key:"triggerConfettiAnimation",value:function(){var e=this,t=P.isLandscape(),n=t?50:30,i=t?5e3:2e3,a=t?15e3:1e4,o=t?40:60,r=t?110:100,l=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=a,this.leftConfetti.shapeModule.angle=o,this.rightConfetti.shapeModule.angle=r,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=l,this.scheduleOnce((function(){e.leftConfetti.play(),e.rightConfetti.play()}),.2)}}]),c}(te)).prototype,"drawLocalizer",[R7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y7=a(K7.prototype,"winLocalizer",[_7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X7=a(K7.prototype,"loseLocalizer",[D7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J7=a(K7.prototype,"waitingLocalizer",[N7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z7=a(K7.prototype,"playerScore",[M7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q7=a(K7.prototype,"opponentScore",[F7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eee=a(K7.prototype,"leftConfetti",[B7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tee=a(K7.prototype,"rightConfetti",[x7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nee=a(K7.prototype,"levelManager",[z7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iee=a(K7.prototype,"headerAnimation",[U7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(K7.prototype,"playDrawAnimation",[G7],Object.getOwnPropertyDescriptor(K7.prototype,"playDrawAnimation"),K7.prototype),a(K7.prototype,"playWinAnimation",[H7],Object.getOwnPropertyDescriptor(K7.prototype,"playWinAnimation"),K7.prototype),a(K7.prototype,"playLoseAnimation",[q7],Object.getOwnPropertyDescriptor(K7.prototype,"playLoseAnimation"),K7.prototype),a(K7.prototype,"playWaitingAnimation",[V7],Object.getOwnPropertyDescriptor(K7.prototype,"playWaitingAnimation"),K7.prototype),a(K7.prototype,"triggerConfettiAnimation",[$7],Object.getOwnPropertyDescriptor(K7.prototype,"triggerConfettiAnimation"),K7.prototype),W7=K7))||W7);X._RF.pop(),X._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var Eee,Aee=Z.ccclass,Tee=Z.property,Pee=Z.disallowMultiple,Lee=Ludex.Events,Oee=codex.event,Iee=(lee=Aee("BaseScreen"),see=Tee(me),uee=Tee(me),cee=Tee(de),lee(dee=Pee((pee=a((hee=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"container",pee,s(e)),l(e,"backgroundMask",yee,s(e)),l(e,"screenOpacity",vee,s(e)),e.data={},e}return e(r,[{key:"__preload",value:function(){this.animation=this.getComponent(ze),this.backgroundMaskButton=this.backgroundMask.getComponent(fe),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"setScreenOpacity",value:function(e){this.screenOpacity.opacity=e}},{key:"open",value:function(e){var t,n,i=this;e&&(this.data=e),this.animation.once(ze.EventType.PLAY,(function(){i.show()})),Oee.emit(Lee.OPENED_SCREEN,{screenName:this.node.name,screenData:this.data}),this.runAnimation(null!==(t=null===(n=this.data.overrideAnimation)||void 0===n?void 0:n.openScreen)&&void 0!==t?t:"OpenScreen")}},{key:"close",value:function(){var e,t,n=this;this.node.active&&(this.animation.once(ze.EventType.FINISHED,(function(){Oee.emit(Lee.CLOSED_SCREEN,{screenName:n.node.name}),n.hide()})),this.runAnimation(null!==(e=null===(t=this.data.overrideAnimation)||void 0===t?void 0:t.closeScreen)&&void 0!==e?e:"CloseScreen"))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(de);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(de);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){this.node.active=!0;var e=this.node.getComponent(oe);if(e){e.enabled=!0,e.updateAlignment();var t,n=this.node.getComponentsInChildren(oe),i=c(n);try{for(i.s();!(t=i.n()).done;){t.value.updateAlignment()}}catch(e){i.e(e)}finally{i.f()}}}},{key:"hide",value:function(){this.node.active=!1}}]),r}(te)).prototype,"container",[see],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yee=a(hee.prototype,"backgroundMask",[uee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vee=a(hee.prototype,"screenOpacity",[cee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dee=hee))||dee)||dee);X._RF.pop(),X._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var Ree,_ee,Dee,Nee,Mee,Fee,Bee,xee,zee,Uee,Gee,Hee,qee,Vee,$ee=Z.ccclass,Wee=Z.requireComponent;$ee("BackgroundMask")(Eee=Wee([de])(Eee=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"onLoad",value:function(){var e=this.getComponent(de);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),r}(te))||Eee);X._RF.pop(),X._RF.push({},"d25c5ZVzYVC/YcfG5prmRdB","Screens",void 0);var Kee,jee,Yee,Xee,Jee,Zee,Qee,ete,tte,nte,ite,ate,ote,rte,lte=Z.ccclass,ste=Z.property,ute=Z.executeInEditMode,cte=(Ree=lte("ScreenConfig"),_ee=ste({type:pe(z)}),Dee=ste({type:ie}),Ree((Fee=a((Mee=e((function e(){t(this,e),l(this,"key",Fee,this),l(this,"depth",Bee,this)}))).prototype,"key",[_ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z.LOADING_SCREEN}}),Bee=a(Mee.prototype,"depth",[Dee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Nee=Mee))||Nee);xee=lte("Screens"),zee=ste({type:[cte]}),Uee=ste({tooltip:"Preload all the screens automatically in ScreenDepth when the scene starts."}),xee(Gee=ute((qee=a((Hee=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"screens",qee,s(e)),l(e,"autoPreload",Vee,s(e)),e}return e(r,[{key:"onEnable",value:function(){}},{key:"onDisable",value:function(){}},{key:"onChildrenChanged",value:function(){}}]),r}(te)).prototype,"screens",[zee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vee=a(Hee.prototype,"autoPreload",[Uee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Gee=Hee))||Gee);X._RF.pop(),X._RF.push({},"cecf2nUBzhIWZw7uJgVliXz","CongratulationScreen",void 0);var dte,hte,pte,yte,vte,fte,gte,mte,bte,wte,Ste,kte,Cte,Ete,Ate,Tte=Z.ccclass,Pte=Z.property,Lte=Z.disallowMultiple,Ote=Z.requireComponent,Ite=Ludex.Events,Rte=codex.event;Kee=Tte("CongratulationScreen"),jee=Ote(Iee),Yee=Pte(me),Xee=Pte(me),Jee=Pte(fe),Zee=Pte(fe),Qee=Pte(fe),Kee(ete=Lte(ete=jee((nte=a((tte=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"congratulation",nte,s(e)),l(e,"confirmation",ite,s(e)),l(e,"closeButtonComponent",ate,s(e)),l(e,"yesButtonComponent",ote,s(e)),l(e,"noButtonComponent",rte,s(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("CongratulationScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.yesButtonComponent.interactable=!0,e.noButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(r,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.confirmationUIOpacity=this.confirmation.getComponent(de),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Rte.on(Ite.OPENING_SCREEN,this.handleOpeningScreen),Rte.on(Ite.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Rte.off(Ite.OPENING_SCREEN,this.handleOpeningScreen),Rte.off(Ite.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.confirmation.active=!1,this.congratulation.active=!0}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.yesButtonComponent.interactable=!1,this.noButtonComponent.interactable=!1,x.closeScreen(z.CONGRATULATION_SCREEN)}},{key:"handleStartOver",value:function(){this.confirmation.active=!0,this.congratulation.active=!1,re(this.confirmationUIOpacity).set({opacity:0}).to(.2,{opacity:255}).start(),re(this.confirmation).set({scale:new be(.8,.8,.8)}).to(.2,{scale:new be(1,1,1)},{easing:"backOut"}).start()}},{key:"handleYesStartOver",value:function(){this.close(),this.node.scene.emit(Js.START_OVER,1)}},{key:"handleNoStartOver",value:function(){this.requestGameReplay()}},{key:"handleClickedClose",value:function(){this.requestGameReplay()}},{key:"requestGameReplay",value:function(){this.close(),this.node.scene.emit(Js.GAME_REPLAY)}}]),r}(te)).prototype,"congratulation",[Yee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ite=a(tte.prototype,"confirmation",[Xee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ate=a(tte.prototype,"closeButtonComponent",[Jee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ote=a(tte.prototype,"yesButtonComponent",[Zee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rte=a(tte.prototype,"noButtonComponent",[Qee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ete=tte))||ete)||ete);X._RF.pop(),X._RF.push({},"dc7da51sglB44qYIJOboZkL","HorizontalSelector",void 0);var _te,Dte,Nte,Mte,Fte,Bte,xte,zte,Ute,Gte,Hte,qte,Vte,$te,Wte,Kte,jte=Z.ccclass,Yte=Z.property,Xte=(dte=jte("HorizontalSelector"),hte=Yte({type:Se,tooltip:"Component initializes on its own in its preload method. Turn off if you want to initialize it manually."}),pte=Yte({type:Q,visible:function(){return!this.selfInitialize}}),yte=Yte({type:ie,visible:function(){return!this.selfInitialize}}),vte=Yte(Se),fte=Yte(ke),gte=Yte(ve),dte((wte=a((bte=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"selfInitialize",wte,s(e)),l(e,"items",Ste,s(e)),l(e,"currentIndex",kte,s(e)),l(e,"loop",Cte,s(e)),l(e,"selectedItemLabel",Ete,s(e)),l(e,"onSelectEvents",Ate,s(e)),e.selectedItem="",e}return e(r,[{key:"__preload",value:function(){this.selfInitialize||this.init(this.items,this.currentIndex)}},{key:"init",value:function(e,t,n){this.items=e,this.currentIndex=t,void 0!==n&&(this.loop=n),this.selectedItem=this.items[this.currentIndex],this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem)}},{key:"selectNext",value:function(){(this.loop||this.currentIndex!==this.items.length-1)&&(this.currentIndex=(this.currentIndex+1)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"selectPrevious",value:function(){(this.loop||0!==this.currentIndex)&&(this.currentIndex=(this.currentIndex-1+this.items.length)%this.items.length,this.selectedItem=this.items[this.currentIndex],this.emitOnSelectedEvents())}},{key:"getSelectedItem",value:function(){return this.selectedItem}},{key:"getSelectedIndex",value:function(){return this.currentIndex}},{key:"getItems",value:function(){return this.items}},{key:"setSelectedItem",value:function(e){this.selectedItem=this.items[e],this.currentIndex=e,this.emitOnSelectedEvents()}},{key:"emitOnSelectedEvents",value:function(){this.selectedItemLabel&&(this.selectedItemLabel.string=this.selectedItem);var e,t=c(this.onSelectEvents);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.emit([this.selectedItem,n.customEventData])}}catch(e){t.e(e)}finally{t.f()}}}]),r}(te)).prototype,"selfInitialize",[hte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ste=a(bte.prototype,"items",[pte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kte=a(bte.prototype,"currentIndex",[yte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Cte=a(bte.prototype,"loop",[vte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ete=a(bte.prototype,"selectedItemLabel",[fte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ate=a(bte.prototype,"onSelectEvents",[gte],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mte=bte))||mte);X._RF.pop(),X._RF.push({},"50306JI4lZMEqIc8ZHjuEgn","CustomGameScreen",void 0);var Jte,Zte,Qte,ene,tne,nne,ine,ane,one,rne,lne,sne,une,cne,dne,hne,pne,yne,vne,fne,gne,mne,bne,wne,Sne,kne,Cne,Ene,Ane,Tne,Pne,Lne,One,Ine,Rne,_ne,Dne=Z.ccclass,Nne=Z.property,Mne=Z.requireComponent,Fne=Ludex.Events,Bne=codex,xne=Bne.event,zne=Bne.player;_te=Dne("CustomGameScreen"),Dte=Mne(Iee),Nte=Nne(fe),Mte=Nne({type:Xte,group:"Selectors"}),Fte=Nne({type:Xte,group:"Selectors"}),Bte=Nne({type:Xte,group:"Selectors"}),xte=Nne({type:X0,group:"Selectors"}),zte=Nne(ke),_te(Ute=Dte((Hte=a((Gte=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"playButton",Hte,s(e)),l(e,"timeSelector",qte,s(e)),l(e,"difficultySelector",Vte,s(e)),l(e,"bombsSelector",$te,s(e)),l(e,"extraAdsSwitch",Wte,s(e)),l(e,"bonusLabel",Kte,s(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StartLevelScreen: screen not found");e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){xne.on(Fne.OPENING_SCREEN,this.handleOpeningScreen),xne.on(Fne.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){xne.off(Fne.OPENING_SCREEN,this.handleOpeningScreen),xne.off(Fne.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(e){this.setInteractableButtons(!1),this.node.scene.emit(Js.SHOW_UI),xne.emit(Fne.CLOSE_SCREEN,{screenName:this.node.name,screenData:{customMode:e}})}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"updateStatus",value:function(){var e=jv.time,t=jv.difficulty,n=jv.bombs,i=Kv.getCustomData();this.timeSelector.init(e.map((function(e){return e<0?"".concat(e,"%"):"+".concat(e,"%")})),i.time),this.difficultySelector.init(A(t),i.difficulty),this.bombsSelector.init(n.map((function(e){return"".concat(e)})),i.bombs),this.extraAdsSwitch.setEnabled(i.ads),this.calculateBonus()}},{key:"handleClickedPlay",value:(r=o((function*(){this.close(!0)})),function(){return r.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleSelectedTime",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedDifficulty",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSelectedBombs",value:function(e){this.updateCustomGameData(),this.calculateBonus()}},{key:"handleSwitchedExtraAds",value:function(){this.extraAdsSwitch.switch(),this.updateCustomGameData(),this.calculateBonus()}},{key:"updateCustomGameData",value:function(){var e=this.timeSelector.getSelectedIndex(),t=this.difficultySelector.getSelectedIndex(),n=this.bombsSelector.getSelectedIndex();zne.setGameData({custom:{time:e,difficulty:t,bombs:n,ads:this.extraAdsSwitch.enable}})}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.screen.backgroundMask.getComponent(fe).interactable=e}},{key:"calculateBonus",value:function(){var e=Kv.getCustomBonus();this.bonusLabel.string=e>=0?"+".concat(e,"%"):"".concat(e,"%")}}]),c}(te)).prototype,"playButton",[Nte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qte=a(Gte.prototype,"timeSelector",[Mte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vte=a(Gte.prototype,"difficultySelector",[Fte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$te=a(Gte.prototype,"bombsSelector",[Bte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wte=a(Gte.prototype,"extraAdsSwitch",[xte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kte=a(Gte.prototype,"bonusLabel",[zte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ute=Gte))||Ute);X._RF.pop(),X._RF.push({},"01c067hcjNDc7prJzSE6UEq","DayBlock",void 0);var Une,Gne,Hne,qne,Vne,$ne,Wne,Kne,jne,Yne,Xne,Jne,Zne,Qne,eie,tie,nie,iie,aie,oie,rie,lie,sie,uie,cie,die,hie,pie,yie,vie,fie,gie,mie,bie,wie,Sie,kie,Cie,Eie,Aie,Tie,Pie=Z.ccclass,Lie=Z.property,Oie=(Jte=Pie("DayBlock"),Zte=Yn.required(),Qte=Lie({type:he,group:"Background"}),ene=Yn.required(),tne=Lie({type:he,group:"Background"}),nne=Yn.required(),ine=Lie({type:xe,group:"Background"}),ane=Yn.required(),one=Lie({type:xe,group:"Background"}),rne=Yn.required(),lne=Lie(ke),sne=Yn.required(),une=Lie(Lh),cne=Yn.required(),dne=Lie(ke),hne=Yn.required(),pne=Lie(me),yne=Yn.required(),vne=Lie(me),fne=Yn.required(),gne=Lie(me),mne=Yn.required(),bne=Lie({type:de}),Jte((kne=a((Sne=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"background",kne,s(e)),l(e,"topBackground",Cne,s(e)),l(e,"blueBackground",Ene,s(e)),l(e,"blueTopBackground",Ane,s(e)),l(e,"dayLabel",Tne,s(e)),l(e,"dayLocalizer",Pne,s(e)),l(e,"coinLabel",Lne,s(e)),l(e,"rewardItemsNode",One,s(e)),l(e,"checkNode",Ine,s(e)),l(e,"glowNodes",Rne,s(e)),l(e,"uiOpacity",_ne,s(e)),e}return e(r,[{key:"onLoad",value:function(){Yn.validateRequiredProperties(this,r),this.initDefaultProperties()}},{key:"initDefaultProperties",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultTopBackground=this.topBackground.spriteFrame,this.defaultDayLabelOutlineColor=new Ae(this.dayLabel.outlineColor),this.blueDayLabelOutlineColor=new Ae("#3469bf")}},{key:"updateInfo",value:function(e){this.updateBackground(e),this.updateDayLabel(e),this.coinLabel.string=e.value.toString(),this.updateRewardItems(e)}},{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"rewarded":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"rewarded"!==e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.outlineColor=t,this.dayLabel.shadowColor=t}},{key:"updateRewardItems",value:function(e){switch(e.status){case"ready":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!0);break;case"waiting":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!1);break;case"rewarded":this.rewardItemsNode.active=!1,this.checkNode.active=!0,this.setGlowNodesActive(!1)}}},{key:"setGlowNodesActive",value:function(e){this.glowNodes&&this.glowNodes.forEach((function(t){t.active=e}))}}]),r}(te)).prototype,"background",[Zte,Qte],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cne=a(Sne.prototype,"topBackground",[ene,tne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ene=a(Sne.prototype,"blueBackground",[nne,ine],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ane=a(Sne.prototype,"blueTopBackground",[ane,one],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tne=a(Sne.prototype,"dayLabel",[rne,lne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pne=a(Sne.prototype,"dayLocalizer",[sne,une],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lne=a(Sne.prototype,"coinLabel",[cne,dne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),One=a(Sne.prototype,"rewardItemsNode",[hne,pne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ine=a(Sne.prototype,"checkNode",[yne,vne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rne=a(Sne.prototype,"glowNodes",[fne,gne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_ne=a(Sne.prototype,"uiOpacity",[mne,bne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wne=Sne))||wne);X._RF.pop(),X._RF.push({},"cc662r8eR5Al6FdOBdcAkHG","DailyRewardsScreen",void 0);var Iie,Rie=Z.ccclass,_ie=Z.property,Die=Z.requireComponent,Nie=Ludex,Mie=Nie.Events,Fie=Nie.Utils,Bie=Fie.Array,xie=Fie.Signal,zie=Nie.Plugins.Ads,Uie=(void 0===zie?{}:zie).Types,Gie=codex,Hie=Gie.event,qie=Gie.player;Une=Rie("DailyRewardsScreen"),Gne=Die(Iee),Hne=Yn.required(),qne=_ie(me),Vne=Yn.required(),$ne=_ie(fe),Wne=Yn.required(),Kne=_ie(fe),jne=Yn.required(),Yne=_ie(fe),Xne=Yn.required(),Jne=_ie(fe),Zne=Yn.required(),Qne=_ie(fe),eie=Yn.required(),tie=_ie(me),nie=Yn.required(),iie=_ie(me),aie=Yn.required(),oie=_ie(me),rie=_ie([Oie]),lie=Yn.onlyRunInLifeCycle,sie=Yn.onlyRunInLifeCycleAsync,uie=Yn.onlyRunInLifeCycle,cie=Yn.onlyRunInLifeCycleAsync,die=Yn.onlyRunInLifeCycleAsync,hie=Yn.onlyRunInLifeCycle,pie=Yn.onlyRunInLifeCycle,yie=Yn.onlyRunInLifeCycle,Une(vie=Gne((gie=a((fie=function(a){n(f,a);var r,u,d,h,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=v.call.apply(v,[this].concat(i))).rewardsData=[],l(e,"loadingRing",gie,s(e)),l(e,"claimButton",mie,s(e)),l(e,"claimX2Button",bie,s(e)),l(e,"closeButton",wie,s(e)),l(e,"backgroundButton",Sie,s(e)),l(e,"continueButton",kie,s(e)),l(e,"claimButtonScallableNode",Cie,s(e)),l(e,"claimX2ButtonScallableNode",Eie,s(e)),l(e,"continueButtonScallableNode",Aie,s(e)),l(e,"dailyBlocks",Tie,s(e)),e.dailyLoadingController=new xie.SignalController,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.setLoading())},e.handleOpenedScreen=function(){var t=o((function*(t){e.validateEventPayload(t)&&e.open()}));return function(e){return t.apply(this,arguments)}}(),e}return e(f,[{key:"__preload",value:function(){this.enabled=!1,Yn.validateRequiredProperties(this,f),this.listenScreenEvents(),Uie&&C.preloadAdsByType(Uie.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){Hie.on(Mie.OPENING_SCREEN,this.handleOpeningScreen),Hie.on(Mie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Hie.off(Mie.OPENING_SCREEN,this.handleOpeningScreen),Hie.off(Mie.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"setLoading",value:function(){this.loadingRing.active=!0;var e,t=c(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){e.value.uiOpacity.opacity=0}}catch(e){t.e(e)}finally{t.f()}this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.setInteractableButtons(!0),this.node.scene.emit(Js.HIDE_UI),this.openAsync()}},{key:"openAsync",value:(y=o((function*(){var e=this.dailyLoadingController.renew(),t=!Xq.hasShownPopup(),n=yield Xq.getRewardsData();if(null!==n){var i=Bie.search(n,(function(e){return"ready"===e.status}));this.updateScreenData(n,i),t?yield this.runPopUpAnim(e):this.showElements()}else this.close()})),function(){return y.apply(this,arguments)})},{key:"updateScreenData",value:function(e,t){this.rewardsData=e,this.currentRewardsData=t;for(var n=0,i=this.dailyBlocks.length;n<i;n++){var a=this.rewardsData[n],o=this.dailyBlocks[n],r=a.id,l=a.type,s=a.value,u=a.status;o.updateInfo({day:r,type:l,value:s,status:u})}}},{key:"close",value:function(){Xq.setHasShownPopup(),this.setInteractableButtons(!1),this.dailyLoadingController.abort(),Hie.emit(Mie.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Js.SHOW_UI)}},{key:"runPopUpAnim",value:(h=o((function*(e){var t=this;this.loadingRing.active=!1,yield Promise.all(this.dailyBlocks.map((function(n,i){return t.runBlockPopUpAnim(n,.15*i,e)}))),yield this.runButtonPopUpAnim(e)})),function(e){return h.apply(this,arguments)})},{key:"showElements",value:function(){this.loadingRing.active=!1;var e,t=c(this.dailyBlocks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.uiOpacity.opacity=255,n.node.setScale(1,1,1)}}catch(e){t.e(e)}finally{t.f()}void 0===this.currentRewardsData?(this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(1,1,1)):(this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(1,1,1),this.claimX2ButtonScallableNode.setScale(1,1,1))}},{key:"runButtonPopUpAnim",value:(d=o((function*(e){if(void 0===this.currentRewardsData)return this.continueButtonScallableNode.active=!0,this.claimButtonScallableNode.active=!1,this.claimX2ButtonScallableNode.active=!1,this.continueButtonScallableNode.setScale(0,0,0),void(yield p.runTweenAsync(re(this.continueButtonScallableNode).to(.3,{scale:be.ONE},{easing:"backOut"}),e));this.continueButtonScallableNode.active=!1,this.claimButtonScallableNode.active=!0,this.claimX2ButtonScallableNode.active=!0,this.claimButtonScallableNode.setScale(0,0,0),this.claimX2ButtonScallableNode.setScale(0,0,0),yield Promise.all([p.runTweenAsync(re(this.claimButtonScallableNode).to(.3,{scale:be.ONE},{easing:"backOut"}),e),p.runTweenAsync(re(this.claimX2ButtonScallableNode).delay(.1).to(.3,{scale:be.ONE},{easing:"backOut"}),e)])})),function(e){return d.apply(this,arguments)})},{key:"runBlockPopUpAnim",value:(u=o((function*(e,t,n){e.node.setScale(1.2,1.2,1.2),e.uiOpacity.opacity=0;var i=p.runTweenAsync(re(e.uiOpacity).delay(t).to(.3,{opacity:255},{easing:"quadOut"}),n),a=p.runTweenAsync(re(e.node).delay(t).to(.3,{scale:be.ONE},{easing:"backOut"}),n);yield Promise.all([i,a])})),function(e,t,n){return u.apply(this,arguments)})},{key:"handleOnClaim",value:function(){void 0!==this.currentRewardsData?(this.setInteractableButtons(!1),this.claimReward(this.currentRewardsData)):x.showNotificationScreenWithLocalizedKey("error.rewardFail",2)}},{key:"handleOnClaimX2",value:(r=o((function*(){void 0!==this.currentRewardsData?(this.setInteractableButtons(!1),(yield C.showRewardVideoAdAsync())?this.claimReward(this.currentRewardsData,!0):this.setInteractableButtons(!0)):x.showNotificationScreenWithLocalizedKey("error.rewardFail",2)})),function(){return r.apply(this,arguments)})},{key:"claimReward",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Xq.logLoginReward();var n=e.value*(t?2:1);this.node.scene.emit(Js.ADD_COINS,{coins:n,collectionAnimation:{animateTextOnly:!1}});var i=qie.getGameData();if(e.items&&i){var a=e.items.hint*(t?2:1),o=e.items.thunder*(t?2:1),r=e.items.storm*(t?2:1);qie.setGameData({items:{hint:i.items.hint+a,thunder:i.items.thunder+o,storm:i.items.storm+r,pliers:i.items.pliers}})}this.close()}},{key:"setInteractableButtons",value:function(e){this.claimButton.interactable=e,this.claimX2Button.interactable=e,this.closeButton.interactable=e,this.backgroundButton.interactable=e,this.continueButton.interactable=e}}]),f}(te)).prototype,"loadingRing",[Hne,qne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mie=a(fie.prototype,"claimButton",[Vne,$ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bie=a(fie.prototype,"claimX2Button",[Wne,Kne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wie=a(fie.prototype,"closeButton",[jne,Yne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sie=a(fie.prototype,"backgroundButton",[Xne,Jne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kie=a(fie.prototype,"continueButton",[Zne,Qne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cie=a(fie.prototype,"claimButtonScallableNode",[eie,tie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eie=a(fie.prototype,"claimX2ButtonScallableNode",[nie,iie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aie=a(fie.prototype,"continueButtonScallableNode",[aie,oie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tie=a(fie.prototype,"dailyBlocks",[rie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(fie.prototype,"updateScreenData",[lie],Object.getOwnPropertyDescriptor(fie.prototype,"updateScreenData"),fie.prototype),a(fie.prototype,"runPopUpAnim",[sie],Object.getOwnPropertyDescriptor(fie.prototype,"runPopUpAnim"),fie.prototype),a(fie.prototype,"showElements",[uie],Object.getOwnPropertyDescriptor(fie.prototype,"showElements"),fie.prototype),a(fie.prototype,"runButtonPopUpAnim",[cie],Object.getOwnPropertyDescriptor(fie.prototype,"runButtonPopUpAnim"),fie.prototype),a(fie.prototype,"runBlockPopUpAnim",[die],Object.getOwnPropertyDescriptor(fie.prototype,"runBlockPopUpAnim"),fie.prototype),a(fie.prototype,"handleOnClaim",[hie],Object.getOwnPropertyDescriptor(fie.prototype,"handleOnClaim"),fie.prototype),a(fie.prototype,"claimReward",[pie],Object.getOwnPropertyDescriptor(fie.prototype,"claimReward"),fie.prototype),a(fie.prototype,"setInteractableButtons",[yie],Object.getOwnPropertyDescriptor(fie.prototype,"setInteractableButtons"),fie.prototype),vie=fie))||vie);X._RF.pop(),X._RF.push({},"5a6aeaMAdtMGYA8B1wIuhDa","DayBlockRed",void 0);var Vie,$ie,Wie,Kie,jie,Yie,Xie,Jie,Zie,Qie,eae,tae,nae,iae,aae,oae;(0,Z.ccclass)("DayBlockRed")(Iie=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r,[{key:"updateBackground",value:function(e){if(this.blueTopBackground&&this.blueBackground)switch(e.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(e){this.dayLocalizer.setParams([e.day.toString()]);var t=this.defaultDayLabelOutlineColor;"ready"===e.status&&(t=this.blueDayLabelOutlineColor),this.dayLabel.shadowColor=t,this.dayLabel.outlineColor=t}}]),r}(Oie));X._RF.pop(),X._RF.push({},"6fed95tFh5MRKzFqaFB2Ts8","GetCoinScreen",void 0);var rae,lae,sae,uae,cae,dae,hae,pae,yae,vae,fae,gae,mae,bae,wae,Sae,kae,Cae,Eae,Aae,Tae,Pae,Lae,Oae,Iae,Rae,_ae,Dae,Nae,Mae,Fae,Bae=Z.ccclass,xae=Z.property,zae=Z.requireComponent,Uae=codex.event,Gae=Ludex,Hae=Gae.Events,qae=Gae.Plugins.Ads,Vae=(void 0===qae?{}:qae).Types;Vie=Bae("GetCoinScreen"),$ie=zae(Iee),Wie=Yn.required(),Kie=xae(ke),jie=Yn.required(),Yie=xae(fe),Xie=Yn.required(),Jie=xae(fe),Zie=Yn.required(),Qie=xae(me),Vie(eae=$ie((nae=a((tae=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"quantityLabel",nae,s(e)),l(e,"closeButtonComponent",iae,s(e)),l(e,"getNowButtonComponent",aae,s(e)),l(e,"particle",oae,s(e)),e.handleOpeningScreen=function(t){console.log("GetCoinScreen.OPENING_SCREEN",t),e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.listenScreenEvents()}},{key:"onLoad",value:function(){JF.setNodeToLayer(this.particle,"Particles"),Vae&&C.preloadAdsByType(Vae.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){Uae.on(Hae.OPENING_SCREEN,this.handleOpeningScreen),Uae.on(Hae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Uae.off(Hae.OPENING_SCREEN,this.handleOpeningScreen),Uae.off(Hae.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return"screenName"in e&&(e.screenName===this.node.name&&(this.payload=e,!0))}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),Uae.emit(Hae.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Js.SHOW_UI)}},{key:"updateStatus",value:function(){this.updateCoinQuantity()}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("GetCoinScreen: screen not found")}},{key:"updateCoinQuantity",value:function(){var e=this.getQuantity();e&&this.updateQuantityLabel(e)}},{key:"updateQuantityLabel",value:function(e){this.quantityLabel.string="x".concat(e.toString())}},{key:"getQuantity",value:function(){var e=this.payload.screenData;return e&&"quantity"in e&&e.quantity&&"number"==typeof e.quantity?e.quantity:0}},{key:"handleAddCoin",value:function(){var e=this.getQuantity();this.node.scene.emit(Js.ADD_COINS,{coins:e,collectionAnimation:{animateTextOnly:!1},skipAnimation:!0}),this.close()}},{key:"handleGetNowButtonClicked",value:(r=o((function*(){w.stopAllSounds(),(yield C.showRewardVideoAdAsync())&&this.handleAddCoin()})),function(){return r.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),c}(te)).prototype,"quantityLabel",[Wie,Kie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iae=a(tae.prototype,"closeButtonComponent",[jie,Yie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aae=a(tae.prototype,"getNowButtonComponent",[Xie,Jie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oae=a(tae.prototype,"particle",[Zie,Qie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eae=tae))||eae);X._RF.pop(),X._RF.push({},"f016fTAlsNKRYkdu72AyCLI","GetItemScreen",void 0);var $ae,Wae,Kae,jae,Yae,Xae,Jae,Zae,Qae,eoe,toe=Z.ccclass,noe=Z.property,ioe=codex,aoe=ioe.event,ooe=ioe.player,roe=ioe.analytics,loe=ioe.language,soe=Ludex,uoe=soe.Events,coe=soe.Utils.Array,doe=soe.Plugins,hoe=doe.Ads,poe=(void 0===hoe?{}:hoe).Types,yoe=doe.Analytics,voe=(void 0===yoe?{}:yoe).Events,foe=Object.values(_);rae=toe("GetItemScreen"),lae=noe({type:$e,group:"Item"}),sae=noe({type:he,group:"Item"}),uae=noe({type:xe,group:"Item"}),cae=noe({type:xe,group:"Item"}),dae=noe({type:xe,group:"Item"}),hae=noe({type:xe,group:"Item"}),pae=noe({type:ke,group:"Title"}),yae=noe({type:Lh,group:"Title"}),vae=noe({type:ke,group:"Description"}),fae=noe({type:Lh,group:"Description"}),gae=noe(ke),mae=noe({type:fe,group:"Buttons"}),bae=noe({type:fe,group:"Buttons"}),wae=noe({type:fe,group:"Buttons"}),rae((Cae=a((kae=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"itemFxPrefab",Cae,s(e)),l(e,"itemSprite",Eae,s(e)),l(e,"hintSpriteFrame",Aae,s(e)),l(e,"stormSpriteFrame",Tae,s(e)),l(e,"thunderSpriteFrame",Pae,s(e)),l(e,"pliersSpriteFrame",Lae,s(e)),l(e,"titleLabel",Oae,s(e)),l(e,"titleLocalizer",Iae,s(e)),l(e,"descriptionLabel",Rae,s(e)),l(e,"descriptionLocalizer",_ae,s(e)),l(e,"coinLabel",Dae,s(e)),l(e,"closeButtonComponent",Nae,s(e)),l(e,"buyItemButtonComponent",Mae,s(e)),l(e,"getNowButtonComponent",Fae,s(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("GetItemScreen: screen not found");e.validateEventPayload(t)&&e.validateEventPayloadData(t.screenData)&&(e.setInteractableButtons(!0),e.data=t.screenData,e.updateStatus(t.screenData))},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents(),poe&&C.preloadAdsByType(poe.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){aoe.on(uoe.OPENING_SCREEN,this.handleOpeningScreen),aoe.on(uoe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){aoe.off(uoe.OPENING_SCREEN,this.handleOpeningScreen),aoe.off(uoe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"validateEventPayloadData",value:function(e){return!!e&&(!(!("item"in e)||!coe.has(foe,e.item))&&("quantity"in e&&"number"==typeof e.quantity&&!("localizedMessageKey"in e&&void 0!==e.localizedMessageKey&&!loe.hasTextKey(e.localizedMessageKey))))}},{key:"open",value:function(){this.node.scene.emit(Js.GAME_PAUSE)}},{key:"close",value:function(){this.setInteractableButtons(!1),aoe.emit(uoe.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Js.GAME_RESUME)}},{key:"updateStatus",value:function(e){this.updateItemIcon(e.item),this.updateTitle(e.item),e.localizedMessageKey&&this.updateDescription(e.localizedMessageKey),this.updateButtons(e.item)}},{key:"updateItemIcon",value:function(e){switch(e){case _.HINT:this.itemSprite.spriteFrame=this.hintSpriteFrame;break;case _.STORM:this.itemSprite.spriteFrame=this.stormSpriteFrame;break;case _.THUNDER:this.itemSprite.spriteFrame=this.thunderSpriteFrame;break;case _.PLIERS:this.itemSprite.spriteFrame=this.pliersSpriteFrame}}},{key:"getItemLocalizedTitleKey",value:function(e){switch(e){case _.HINT:return"item.hint";case _.STORM:return"item.storm";case _.THUNDER:return"item.thunder";case _.PLIERS:return"item.pliers"}}},{key:"updateTitle",value:function(e){this.titleLocalizer.key=this.getItemLocalizedTitleKey(e)}},{key:"updateDescription",value:function(e){this.descriptionLocalizer.key=e}},{key:"updateButtons",value:function(e){var t=this.canBuyItem(e);this.buyItemButtonComponent.node.active=t,this.getNowButtonComponent.node.active=!t,t&&(this.coinLabel.string="".concat(3*jy[e]))}},{key:"canBuyItem",value:function(e){var t=ooe.getGameData();return!!t&&t.coins>=3*jy[e]}},{key:"handleAddItem",value:(c=o((function*(){this.data.item&&(voe&&roe.event(voe.EARN_ITEM,{item_name:this.data.item,value:3}),this.node.scene.emit(Js.ADD_ITEM,{animate:{startWorldPosition:this.itemSprite.node.worldPosition.clone()},item:this.data.item,quantity:3}))})),function(){return c.apply(this,arguments)})},{key:"handleGetNowButtonClicked",value:(u=o((function*(){this.stopAllSounds(),(yield C.showRewardVideoAdAsync())&&(this.handleAddItem(),this.close())})),function(){return u.apply(this,arguments)})},{key:"handleBuyItemButtonClicked",value:(r=o((function*(){this.node.scene.emit(Js.REMOVE_COINS,{coins:3*jy[this.data.item],collectionAnimation:{animateTextOnly:!0}}),this.handleAddItem(),this.close()})),function(){return r.apply(this,arguments)})},{key:"stopAllSounds",value:function(){var e;null===(e=Me("Sound"))||void 0===e||null===(e=e.getComponent(fn))||void 0===e||e.stopAll()}},{key:"setInteractableButtons",value:function(e){this.closeButtonComponent.interactable=e,this.buyItemButtonComponent.interactable=e,this.getNowButtonComponent.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),h}(te)).prototype,"itemFxPrefab",[lae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eae=a(kae.prototype,"itemSprite",[sae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aae=a(kae.prototype,"hintSpriteFrame",[uae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tae=a(kae.prototype,"stormSpriteFrame",[cae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pae=a(kae.prototype,"thunderSpriteFrame",[dae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lae=a(kae.prototype,"pliersSpriteFrame",[hae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oae=a(kae.prototype,"titleLabel",[pae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iae=a(kae.prototype,"titleLocalizer",[yae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rae=a(kae.prototype,"descriptionLabel",[vae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_ae=a(kae.prototype,"descriptionLocalizer",[fae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dae=a(kae.prototype,"coinLabel",[gae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nae=a(kae.prototype,"closeButtonComponent",[mae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mae=a(kae.prototype,"buyItemButtonComponent",[bae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fae=a(kae.prototype,"getNowButtonComponent",[wae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sae=kae));X._RF.pop(),X._RF.push({},"4d6710xA7hAk65cGA4Dgdrc","GetRewardsScreen",void 0);var goe,moe=Z.ccclass,boe=Z.requireComponent,woe=Z.property,Soe=Ludex,koe=Soe.Events,Coe=Soe.Plugins.Ads,Eoe=(void 0===Coe?{}:Coe).Types,Aoe=codex.event;$ae=moe("GetRewardsScreen"),Wae=boe(Iee),Kae=woe(Lh),jae=woe(fe),Yae=woe(fe),$ae(Xae=Wae((Zae=a((Jae=function(a){n(h,a);var r,u,c,d=i(h);function h(){var e;t(this,h);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=d.call.apply(d,[this].concat(i)),l(e,"countDownLocalizer",Zae,s(e)),l(e,"skipButton",Qae,s(e)),l(e,"claimButton",eoe,s(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents(),Eoe&&C.preloadAdsByType(Eoe.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Aoe.on(koe.OPENING_SCREEN,this.handleOpeningScreen),Aoe.on(koe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Aoe.off(koe.OPENING_SCREEN,this.handleOpeningScreen),Aoe.off(koe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.runCountdownAnimation()}},{key:"close",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setInteractableButtons(!1),Aoe.emit(koe.CLOSE_SCREEN,{screenName:this.node.name,screenData:{getRewardsSuccess:e,rewardsAdShown:t}})}},{key:"runCountdownAnimation",value:function(){var e=this,t=5;this.countDownLocalizer.setParams([t.toString()]);this.schedule((function(){t<=0?e.stopCountdownAnimation():(3===--t&&e.runButtonAnimation(),e.countDownLocalizer.setParams([t.toString()]))}),1,6)}},{key:"stopCountdownAnimation",value:(c=o((function*(){if(this.unscheduleAllCallbacks(),GameSDK.isGameSDK("Yandex"))this.close(!1);else{var e=yield C.showRewardedInterstitialAdAsync();this.close(e,!0)}})),function(){return c.apply(this,arguments)})},{key:"handleClickedSkip",value:function(){this.unscheduleAllCallbacks(),this.close(!1)}},{key:"handleClickedClaim",value:(u=o((function*(){this.unscheduleAllCallbacks();var e=yield C.showRewardedInterstitialAdAsync();this.close(e,!0)})),function(){return u.apply(this,arguments)})},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"runButtonAnimation",value:(r=o((function*(){var e=(GameSDK.isGameSDK("Yandex")?this.claimButton:this.skipButton).node.getComponent(de);if(e){var t=re(e).to(.3,{opacity:255});yield p.runTweenAsync(t),this.setInteractableButtons(!0)}})),function(){return r.apply(this,arguments)})},{key:"updateStatus",value:function(){var e=GameSDK.isGameSDK("Yandex");this.skipButton.node.active=!e,this.claimButton.node.active=e,this.countDownLocalizer.key=e?"ads.levelAfterT":"ads.adAfterT",this.skipButton.getComponent(de).opacity=0,this.claimButton.getComponent(de).opacity=0}},{key:"setInteractableButtons",value:function(e){this.skipButton.interactable=e,this.claimButton.interactable=e}}]),h}(te)).prototype,"countDownLocalizer",[Kae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qae=a(Jae.prototype,"skipButton",[jae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eoe=a(Jae.prototype,"claimButton",[Yae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xae=Jae))||Xae);X._RF.pop(),X._RF.push({},"bfe1eXch0ZMKIz1ofLKc2Iv","HardLevelScreen",void 0);var Toe,Poe,Loe,Ooe,Ioe,Roe,_oe,Doe,Noe,Moe,Foe,Boe,xoe,zoe=Z.ccclass,Uoe=Z.requireComponent,Goe=Ludex,Hoe=Goe.Events,qoe=Goe.Plugins.Ads,Voe=(void 0===qoe?{}:qoe).Types,$oe=codex.event;zoe("HardLevelScreen")(goe=Uoe(Iee)(goe=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).handleOpeningScreen=function(t){e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(r,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents(),Voe&&C.preloadAdsByType(Voe.REWARDED_INTERSTITIAL)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){$oe.on(Hoe.OPENING_SCREEN,this.handleOpeningScreen),$oe.on(Hoe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){$oe.off(Hoe.OPENING_SCREEN,this.handleOpeningScreen),$oe.off(Hoe.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation()}},{key:"close",value:function(){x.closeScreen(z.HARD_LEVEL_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}}]),r}(te))||goe);X._RF.pop(),X._RF.push({},"2db0dg4dI9GCKCdFOMrBFsQ","GetRewardsEffect",void 0);var Woe,Koe,joe,Yoe,Xoe,Joe,Zoe,Qoe,ere,tre,nre,ire,are,ore,rre,lre,sre,ure,cre,dre,hre,pre,yre,vre,fre,gre,mre,bre,wre,Sre,kre,Cre,Ere,Are,Tre,Pre,Lre,Ore,Ire,Rre,_re,Dre,Nre,Mre,Fre=Z.ccclass,Bre=Z.property,xre=(Toe=Fre("GetRewardsEffect"),Poe=Bre(xe),Loe=Bre(xe),Ooe=Bre(xe),Ioe=Bre(xe),Roe=Bre(zT),Toe((Noe=a((Doe=function(a){n(d,a);var r,u=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"hint",Noe,s(e)),l(e,"thunder",Moe,s(e)),l(e,"storm",Foe,s(e)),l(e,"pliers",Boe,s(e)),l(e,"particles",xoe,s(e)),e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"playAnimation",value:(r=o((function*(e,t){var n=this,i=-30*(e.length-1)/2+90;yield Promise.all(e.map((function(e,a){var o=n.createSprite(e),r=i+30*a,l=.15*a;o.node.position=new be(300*Math.cos(r*(Math.PI/180)),300*Math.sin(r*(Math.PI/180)),0);var s=re(o.node);return s.delay(l),s.to(.6,{position:be.ZERO,scale:new be(.7,.7,.7)},{easing:"backIn"}),p.runTweenAsync(s).then((function(){t(),w.playSound(Qi.COLLECT_STARS),n.playExplodeEffect(),o.node.destroy()}))})))})),function(e,t){return r.apply(this,arguments)})},{key:"playExplodeEffect",value:function(){var e,t=c(this.particles);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.play()}}catch(e){t.e(e)}finally{t.f()}}},{key:"createSprite",value:function(e){var t=this.getSpriteFrame(e),n=(new me).addComponent(he);return n.spriteFrame=t,n.node.parent=this.node,n.node.scale=new be(1.5,1.5,1.5),n}},{key:"getSpriteFrame",value:function(e){switch(e){case"hint":return this.hint;case"thunder":return this.thunder;case"storm":return this.storm;case"pliers":return this.pliers;default:return null}}}]),d}(te)).prototype,"hint",[Poe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Moe=a(Doe.prototype,"thunder",[Loe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Foe=a(Doe.prototype,"storm",[Ooe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Boe=a(Doe.prototype,"pliers",[Ioe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xoe=a(Doe.prototype,"particles",[Roe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_oe=Doe))||_oe);X._RF.pop(),X._RF.push({},"31829DUddVEq6NgIYHvnI68","LevelCompleteScreen",void 0);var zre,Ure,Gre,Hre,qre,Vre,$re,Wre,Kre,jre,Yre,Xre=Z.ccclass,Jre=Z.property,Zre=Z.requireComponent,Qre=Ludex,ele=Qre.Events,tle=Qre.Utils,nle=tle.Valid,ile=tle.Signal,ale=Qre.Plugins.Ads,ole=(void 0===ale?{}:ale).Types,rle=codex,lle=rle.event,sle=rle.player;Woe=Xre("LevelCompleteScreen"),Koe=Zre(Iee),joe=Jre(ke),Yoe=Jre(ke),Xoe=Jre(de),Joe=Jre(xre),Zoe=Jre({type:fe,group:"Play Button"}),Qoe=Jre({type:me,group:"Play Button"}),ere=Jre({type:de,group:"Play Button"}),tre=Jre({type:me,group:"Play Button"}),nre=Jre({type:me,group:"Play Button"}),ire=Jre({type:fe,group:"Home Button"}),are=Jre({type:ze,group:"Coin Container"}),ore=Jre({type:Qx,group:"Coin Container"}),rre=Jre({type:ze,group:"Coin Container"}),lre=Jre({type:Ue,group:"Coin Container"}),sre=Jre({type:Ue,group:"Coin Container"}),ure=Jre({type:zT,group:"Particles"}),cre=Jre({type:zT,group:"Particles"}),dre=Jre({type:zT,group:"Particles"}),hre=Jre(de),pre=Jre(Lh),Woe(yre=Koe((fre=a((vre=function(a){n(b,a);var r,u,c,d,h,y,v,f,g,m=i(b);function b(){var e;t(this,b);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=m.call.apply(m,[this].concat(i))).level=1,e.coins=40,e.currentCoins=0,e.score=0,e.playAnimation=!1,e.getRewardsSuccess=!1,e.lookingForRewards=!1,e.playAnimationSignal=new Mi,l(e,"coinText",fre,s(e)),l(e,"scoreText",gre,s(e)),l(e,"lookingForRewardsText",mre,s(e)),l(e,"getRewardsEffect",bre,s(e)),l(e,"playButton",wre,s(e)),l(e,"playBackground",Sre,s(e)),l(e,"shineBackground",kre,s(e)),l(e,"hardLevelBackground",Cre,s(e)),l(e,"buttonsContainer",Ere,s(e)),l(e,"homeButton",Are,s(e)),l(e,"coinAnimation",Tre,s(e)),l(e,"coinContainer",Pre,s(e)),l(e,"coinContainerAnimation",Lre,s(e)),l(e,"coinContainerEnterClip",Ore,s(e)),l(e,"coinContainerExitClip",Ire,s(e)),l(e,"leftConfetti",Rre,s(e)),l(e,"rightConfetti",_re,s(e)),l(e,"bokehParticles",Dre,s(e)),l(e,"welldoneUiOpacity",Nre,s(e)),l(e,"welldoneLocalize",Mre,s(e)),e.localizeVisibilityController=new ile.SignalController,e.coinContainerShown=!1,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)&&(e.setInteractableButtons(!0),e.hideTextUntilLocalized())},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleParticleEnd=o((function*(){e.level&&(yield p.waitTweenAsync(.15)),yield Promise.all([e.animateCoin(),e.animateScore()]),e.lookingForRewards?yield e.handleLookingForRewards():yield e.animateVisibleButtonContainer(!0)})),e}return e(b,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.localizeVisibilityController.abort()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){lle.on(ele.OPENING_SCREEN,this.handleOpeningScreen),lle.on(ele.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){lle.off(ele.OPENING_SCREEN,this.handleOpeningScreen),lle.off(ele.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"hideTextUntilLocalized",value:(g=o((function*(){var e=this.localizeVisibilityController.renew();this.welldoneUiOpacity.opacity=0,yield this.welldoneLocalize.waitUntilLocalized(),e.aborted||(yield p.runTweenAsync(re(this.welldoneUiOpacity).to(.5,{opacity:255}),e))})),function(){return g.apply(this,arguments)})},{key:"validateEventPayload",value:function(e){var t=null!=e?e:{},n=t.screenName,i=t.screenData;return n===this.node.name&&(!!nle.isObject(i)&&(nle.isNumber(i.level)&&(this.level=i.level,this.coins=this.level<5?$y:Wy),nle.isNumber(i.coins)&&(this.currentCoins=i.coins),nle.isNumber(i.score)&&(this.score=i.score),this.playAnimation=!1,nle.isObject(i.overrideAnimation)&&(this.playAnimation="LevelCompleteOpenScreen"===i.overrideAnimation.openScreen),this.lookingForRewards=!1,nle.isBoolean(i.lookingForRewards)&&(this.lookingForRewards=i.lookingForRewards),this.getRewardsSuccess=!1,nle.isBoolean(i.getRewardsSuccess)&&(this.getRewardsSuccess=i.getRewardsSuccess),!0))}},{key:"open",value:function(){this.updateStatus(),this.node.scene.emit(Js.HIDE_UI),this.tryPlayAnimation()}},{key:"close",value:(f=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.localizeVisibilityController.abort(),this.stopParticles(),this.coinContainerShown&&(this.coinContainerShown=!1,yield p.runAnimationAsync(this.coinContainerAnimation,this.coinContainerExitClip.name)),lle.emit(ele.CLOSE_SCREEN,{screenName:this.node.name,screenData:{canShowRewardsAd:e}}),this.node.scene.emit(Js.ABORT_COIN_ANIMATION)})),function(){return f.apply(this,arguments)})},{key:"updateStatus",value:function(){this.updateCoinContainer(),this.updateButtonsContainer(),this.lookingForRewardsText.opacity=0}},{key:"updateCoinContainer",value:function(){this.coinContainer.updateCoins({coins:this.currentCoins})}},{key:"updateButtonsContainer",value:function(){var e=sle.getGameData();if(e){var t=this.level+1>e.totalLevel?this.level:this.level+1,n=t%5==0,i=13===t;this.playButton.node.active=!1,this.homeButton.node.active=!1,i?this.homeButton.node.active=!0:(this.playButton.node.active=!0,this.playBackground.active=!n,this.hardLevelBackground.active=n)}}},{key:"tryPlayAnimation",value:function(){if(this.playAnimation){this.screen.setScreenOpacity(255),this.coinText.string="x0",this.scoreText.string="0",this.animateVisibleButtonContainer(!1,!1),this.playParticles();var e=this.screen.getComponent(ze);e?e.once(ze.EventType.FINISHED,this.handleParticleEnd):this.handleParticleEnd()}else{if(this.animateVisibleButtonContainer(!0,!1),!this.getRewardsSuccess)return;this.getRewardsEffect.playAnimation(["storm","thunder"],this.triggerCollectItemPlayButtonAnimation.bind(this))}}},{key:"handleLookingForRewards",value:(v=o((function*(){yield this.animateLookingForRewards(),ole&&C.isReadyAdShowable(ole.REWARDED_INTERSTITIAL)?this.close(!0):this.animateVisibleButtonContainer(!0)})),function(){return v.apply(this,arguments)})},{key:"animateCoin",value:(y=o((function*(){var e=this;this.screen.container?(this.coinAnimation.play(),yield p.runOnUpdateAsync(this.node,.8,(function(t){var n=Xe(0,e.coins,t),i=Math.floor(n);e.coinText.string="x".concat(i)})),yield this.animateCoinCollection(),this.coinText.string="x".concat(this.coins)):console.warn("LevelCompleteScreen: screen not found")})),function(){return y.apply(this,arguments)})},{key:"animateScore",value:(h=o((function*(){var e=this;p.runOnUpdateAsync(this.scoreText.node,.8,(function(t){var n=Xe(0,e.score,t);e.scoreText.string="".concat(Math.floor(n))})),this.scoreText.node.setScale(1,1,1),this.scoreText.string="".concat(this.score)})),function(){return h.apply(this,arguments)})},{key:"animateCoinCollection",value:(d=o((function*(){this.coinContainerShown=!0,yield p.runAnimationAsync(this.coinContainerAnimation,this.coinContainerEnterClip.name),this.node.scene.emit(Js.ADD_COINS,{coins:this.coins,collectionAnimation:{floatDuration:.5,flyDuration:.5,animateTextOnly:!1,target:this.coinContainer}})})),function(){return d.apply(this,arguments)})},{key:"animateLookingForRewards",value:(c=o((function*(){var e=re(this.lookingForRewardsText);e.to(.25,{opacity:255},{easing:"linear"}).delay(.25),e.to(.25,{opacity:100},{easing:"linear"}).delay(.125),yield p.runTweenAsync(re(this.lookingForRewardsText).repeat(2,e).to(.25,{opacity:0},{easing:"linear"})),this.lookingForRewardsText.opacity=0})),function(){return c.apply(this,arguments)})},{key:"animateVisibleButtonContainer",value:(u=o((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e?1:0;if(t){this.playAnimationSignal.abort();var i=new Mi;this.playAnimationSignal=i;var a=e?0:1;this.buttonsContainer.setScale(a,a,this.buttonsContainer.scale.z);var o=re(this.buttonsContainer).to(.5,{scale:new be(n,n,1)},{easing:"backOut"});e||this.setInteractableButtons(!1),yield p.runTweenAsync(o,i),e&&this.setInteractableButtons(!0)}else this.setInteractableButtons(e),this.buttonsContainer.setScale(n,n,this.buttonsContainer.scale.z)})),function(e){return u.apply(this,arguments)})},{key:"triggerCollectItemPlayButtonAnimation",value:(r=o((function*(){this.playAnimationSignal.abort();var e=new Mi;this.playAnimationSignal=e;var t=re(this.buttonsContainer).to(.08,{scale:new be(.95,1.05,1)}).to(.08,{scale:new be(1.05,.95,1)}).to(.08,{scale:new be(1,1,1)}),n=re(this.shineBackground).to(.08,{opacity:50},{easing:"quadOut"}).to(.08,{opacity:0},{easing:"quadIn"});yield Promise.all([p.runTweenAsync(t,e),p.runTweenAsync(n,e)])})),function(){return r.apply(this,arguments)})},{key:"playParticles",value:function(){var e=P.isLandscape(),t=e?50:30,n=e?5e3:2e3,i=e?15e3:1e4,a=e?40:60,o=e?110:100,r=e?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=t,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=n,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=i,this.leftConfetti.shapeModule.angle=a,this.rightConfetti.shapeModule.angle=o,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=r,this.leftConfetti.play(),this.rightConfetti.play(),this.bokehParticles.play()}},{key:"stopParticles",value:function(){this.leftConfetti.stop(),this.rightConfetti.stop(),this.bokehParticles.stop()}},{key:"setInteractableButtons",value:function(e){this.playButton.interactable=e,this.homeButton.interactable=e}},{key:"handleClickedPlay",value:function(){this.setInteractableButtons(!1),this.close()}},{key:"handleClickedHome",value:function(){this.setInteractableButtons(!1),this.close()}}]),b}(te)).prototype,"coinText",[joe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gre=a(vre.prototype,"scoreText",[Yoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mre=a(vre.prototype,"lookingForRewardsText",[Xoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bre=a(vre.prototype,"getRewardsEffect",[Joe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wre=a(vre.prototype,"playButton",[Zoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sre=a(vre.prototype,"playBackground",[Qoe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kre=a(vre.prototype,"shineBackground",[ere],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cre=a(vre.prototype,"hardLevelBackground",[tre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ere=a(vre.prototype,"buttonsContainer",[nre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Are=a(vre.prototype,"homeButton",[ire],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tre=a(vre.prototype,"coinAnimation",[are],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pre=a(vre.prototype,"coinContainer",[ore],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lre=a(vre.prototype,"coinContainerAnimation",[rre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ore=a(vre.prototype,"coinContainerEnterClip",[lre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ire=a(vre.prototype,"coinContainerExitClip",[sre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rre=a(vre.prototype,"leftConfetti",[ure],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_re=a(vre.prototype,"rightConfetti",[cre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dre=a(vre.prototype,"bokehParticles",[dre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nre=a(vre.prototype,"welldoneUiOpacity",[hre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mre=a(vre.prototype,"welldoneLocalize",[pre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yre=vre))||yre);X._RF.pop(),X._RF.push({},"46b8aK6CThLtpMhZPEfDrNs","LoadingFullScreen",void 0);var ule,cle,dle,hle,ple,yle=Z.ccclass,vle=Z.property,fle=["interMsg.reviveAd","interMsg.doubleAd","interMsg.ranked","interMsg.friendChallenge","interMsg.bragChallenge","interMsg.clearTiles","interMsg.beatClock","interMsg.clearBombs","interMsg.seasonPack","interMsg.collectStars","interMsg.competeInLb","interMsg.competeWithFriends","interMsg.thunder","interMsg.hint","interMsg.pliers","interMsg.tornado","interMsg.coins","interMsg.seasonTiles","interMsg.dailyLogin","interMsg.levelUp","interMsg.seasonRewards"],gle=(zre=yle("LoadingFullScreen"),Ure=Yn.required(),Gre=vle(_e),Hre=Yn.required(),qre=Yn.required(),Vre=vle(Lh),zre((Kre=a((Wre=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"progressBar",Kre,s(e)),l(e,"uiOpacity",jre,s(e)),l(e,"loadingLabelLocalizer",Yre,s(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),Yn.validateRequiredProperties(this)}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0,this.progressBar.progress=0}},{key:"show",value:(u=o((function*(e){this.uiOpacity.opacity=0,this.progressBar.progress=0;var t=re(this.uiOpacity).to(.5,{opacity:255},{easing:"cubicOut"}),n=re(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"});this.runLoadingTextAnimation(),p.runTweenAsync(t),yield p.runTweenAsync(n)})),function(e){return u.apply(this,arguments)})},{key:"hide",value:(r=o((function*(e){if(this.uiOpacity&&this.progressBar){this.uiOpacity.opacity=255,this.progressBar.progress=.9;var t=re(this.uiOpacity).to(.5,{opacity:0},{easing:"cubicIn"}),n=re(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"});this.runLoadingTextAnimation(),yield p.runTweenAsync(n),this.stopLoadingTextAnimation(),yield p.runTweenAsync(t),this.node.active=!1}})),function(e){return r.apply(this,arguments)})},{key:"runLoadingTextAnimation",value:function(){var e=this;this.updateHintText(),this.schedule((function(){return e.updateHintText()}),5)}},{key:"updateHintText",value:function(){if(this.loadingLabelLocalizer){var e=this.getHintText();e&&(this.loadingLabelLocalizer.key=e)}}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"getHintText",value:function(){return fle[Math.floor(Math.random()*fle.length)]}}]),d}(te)).prototype,"progressBar",[Ure,Gre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jre=a(Wre.prototype,"uiOpacity",[Hre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yre=a(Wre.prototype,"loadingLabelLocalizer",[qre,Vre],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$re=Wre))||$re);X._RF.pop(),X._RF.push({},"74caciRBKZLu7ymXYJK2GYy","Loading",void 0);var mle,ble=Z.ccclass,wle=Z.property;ule=ble("Loading"),cle=wle($e),ule((ple=a((hle=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"loadingPrefab",ple,s(e)),e.loadingNode=null,e}return e(d,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){ee.isPersistRootNode(this.node)||ee.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=Me("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=qe(this.loadingPrefab));var n=qe._clone(this.loadingNode);this.loadingFullScreen=n.getComponent(gle),null===(e=Me("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(u=o((function*(e){this.createLoadingFullScreen(),yield this.loadingFullScreen.show(e)})),function(e){return u.apply(this,arguments)})},{key:"hide",value:(r=o((function*(e){this.loadingFullScreen&&(yield this.loadingFullScreen.hide(e))})),function(e){return r.apply(this,arguments)})}]),d}(te)).prototype,"loadingPrefab",[cle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dle=hle));X._RF.pop(),X._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var Sle,kle,Cle,Ele,Ale,Tle,Ple,Lle,Ole,Ile,Rle=Z.ccclass,_le=Z.disallowMultiple,Dle=Z.requireComponent,Nle=Ludex.Events,Mle=codex.event;Rle("LoadingScreen")(mle=_le(mle=Dle(Iee)(mle=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=o.call.apply(o,[this].concat(i))).isClosing=!1,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0,e.isClosing=!1)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&(e.isClosing=!0,e.unscheduleAllCallbacks())},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1,e.isClosing=!1)},e.handleOnCloseScreen=function(){x.closeScreen(z.LOADING_SCREEN)},e}return e(r,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.validateRequiredProperties(this,r)}},{key:"listenScreenEvents",value:function(){Mle.on(Nle.OPENING_SCREEN,this.handleOpeningScreen),Mle.on(Nle.OPENED_SCREEN,this.handleOpenedScreen),Mle.on(Nle.CLOSING_SCREEN,this.handleClosingScreen),Mle.on(Nle.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){Mle.off(Nle.OPENING_SCREEN,this.handleOpeningScreen),Mle.off(Nle.OPENED_SCREEN,this.handleOpenedScreen),Mle.off(Nle.CLOSING_SCREEN,this.handleClosingScreen),Mle.off(Nle.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled&&!this.isClosing){var e=this.screen.data.duration;e&&e>0&&this.scheduleOnce(this.handleOnCloseScreen,e)}}}]),r}(te))||mle)||mle);X._RF.pop(),X._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var Fle,Ble,xle,zle,Ule,Gle,Hle,qle,Vle,$le,Wle,Kle,jle,Yle,Xle,Jle,Zle=Z.ccclass,Qle=Z.disallowMultiple,ese=Z.requireComponent,tse=Z.property,nse=Ludex,ise=nse.Events,ase=nse.Utils.Valid,ose=codex.event;Sle=Zle("NotificationScreen"),kle=ese(Iee),Cle=tse(ke),Ele=tse(Lh),Ale=tse(fe),Sle(Tle=Qle(Tle=kle((Lle=a((Ple=function(a){n(r,a);var o=i(r);function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o.call.apply(o,[this].concat(i)),l(e,"message",Lle,s(e)),l(e,"messageLocalizer",Ole,s(e)),l(e,"touchZone",Ile,s(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.updateScreenData(t),e.screen.backgroundMaskButton.interactable=e.enableCloseOnTouch)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return e(r,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.screen=this.getComponent(Iee),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){ose.on(ise.OPENING_SCREEN,this.handleOpeningScreen),ose.on(ise.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){ose.off(ise.OPENING_SCREEN,this.handleOpeningScreen),ose.off(ise.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;ase.isObject(t)?(void 0!==t.message?this.setMessageManually(t.message):void 0!==t.localizedMessageKey&&this.setMessageUsingLocalizeKey(t.localizedMessageKey),t.duration&&t.duration>0&&this.scheduleOnce((function(){x.closeScreen(z.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"setMessageManually",value:function(e){this.messageLocalizer.enabled=!1,this.message.string=e}},{key:"setMessageUsingLocalizeKey",value:function(e){this.messageLocalizer.enabled=!0,this.messageLocalizer.key=e}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),this.screen.backgroundMaskButton.interactable=!1,x.closeScreen(z.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),r}(te)).prototype,"message",[Cle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ole=a(Ple.prototype,"messageLocalizer",[Ele],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ile=a(Ple.prototype,"touchZone",[Ale],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tle=Ple))||Tle)||Tle);X._RF.pop(),X._RF.push({},"7129ca71jRMGaTHxWhEL4F4","QuitLevelScreen",void 0);var rse,lse,sse,use,cse,dse,hse,pse,yse,vse,fse,gse,mse,bse,wse,Sse,kse,Cse,Ese,Ase,Tse,Pse,Lse=Z.ccclass,Ose=Z.property,Ise=Z.requireComponent,Rse=Ludex,_se=Rse.Events,Dse=Rse.Match.Modes,Nse=codex,Mse=Nse.event,Fse=Nse.storage;Fle=Lse("QuitLevelScreen"),Ble=Ise(Iee),xle=Ose(ke),zle=Ose(ke),Ule=Ose(fe),Gle=Ose(ke),Hle=Ose(ke),qle=Ose(fe),Fle(Vle=Ble((Wle=a(($le=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"singleDescription",Wle,s(e)),l(e,"tournamentDescription",Kle,s(e)),l(e,"quitButton",jle,s(e)),l(e,"quitLabel",Yle,s(e)),l(e,"endLabel",Xle,s(e)),l(e,"continueButton",Jle,s(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(d,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Mse.on(_se.OPENING_SCREEN,this.handleOpeningScreen),Mse.on(_se.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Mse.off(_se.OPENING_SCREEN,this.handleOpeningScreen),Mse.off(_se.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),x.closeScreen(z.QUIT_LEVEL_SCREEN),this.node.scene.emit(Js.SHOW_UI),this.node.scene.emit(Js.GAME_RESUME)}},{key:"updateStatus",value:function(){var e=Iv.getMatchMode()===Dse.TOURNAMENT;this.singleDescription.node.active=!e,this.tournamentDescription.node.active=e,this.quitLabel.node.active=!e,this.endLabel.node.active=e}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.quitButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedContinue",value:function(){this.close()}},{key:"handleClickedQuit",value:(u=o((function*(){this.setInteractableButtons(!1),Iv.getMatchMode()===Dse.TOURNAMENT&&(yield this.handleTournamentQuit()),this.node.scene.emit(Js.GAME_EXIT)})),function(){return u.apply(this,arguments)})},{key:"handleTournamentQuit",value:(r=o((function*(){var e,t,n=null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{},i=n.score,a=void 0===i?0:i,o=n.level,r=void 0===o?1:o,l=n.tournamentId,s=a>(null!==(t=Fse.getStorageData("tournament","previousScore"))&&void 0!==t?t:0);s&&l&&U.saveTournamentProgress(r,a,l),Fse.setStorageData("tournament","animateTournamentLeader",s),yield Iv.finishMatchAsync()})),function(){return r.apply(this,arguments)})}]),d}(te)).prototype,"singleDescription",[xle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kle=a($le.prototype,"tournamentDescription",[zle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jle=a($le.prototype,"quitButton",[Ule],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yle=a($le.prototype,"quitLabel",[Gle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xle=a($le.prototype,"endLabel",[Hle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jle=a($le.prototype,"continueButton",[qle],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vle=$le))||Vle);X._RF.pop(),X._RF.push({},"85907Tnp/NBq7myeciP/4h3","RescuesScreen",void 0);var Bse,xse,zse,Use,Gse,Hse,qse,Vse,$se,Wse,Kse,jse,Yse,Xse,Jse,Zse,Qse,eue,tue,nue,iue,aue,oue,rue,lue,sue,uue,cue,due,hue,pue=Z.ccclass,yue=Z.property,vue=Z.disallowMultiple,fue=Z.requireComponent,gue=Ludex,mue=gue.Events,bue=gue.Plugins.Ads,wue=(void 0===bue?{}:bue).Types,Sue=codex,kue=Sue.event,Cue=Sue.player;rse=pue("RescuesScreen"),lse=fue(Iee),sse=yue(de),use=yue([me]),cse=yue(Lh),dse=yue(Lh),hse=yue(me),pse=yue(me),yse=yue(ze),vse=yue(me),fse=yue(me),rse(gse=vue(gse=lse((bse=a((mse=function(a){n(f,a);var r,u,c,d,h,y,v=i(f);function f(){var e;t(this,f);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=v.call.apply(v,[this].concat(i)),l(e,"adOpacity",bse,s(e)),l(e,"animNodes",wse,s(e)),l(e,"titleLocalizer",Sse,s(e)),l(e,"descriptionLocalizer",kse,s(e)),l(e,"timer",Cse,s(e)),l(e,"bomb",Ese,s(e)),l(e,"bombAnim",Ase,s(e)),l(e,"replayButton",Tse,s(e)),l(e,"buyTimeButton",Pse,s(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("RescuesScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(f,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents(),wue&&C.preloadAdsByType(wue.REWARDED_VIDEO)}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){kue.on(mue.OPENING_SCREEN,this.handleOpeningScreen),kue.on(mue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){kue.off(mue.OPENING_SCREEN,this.handleOpeningScreen),kue.off(mue.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name&&(this.payload=e,!0)}},{key:"open",value:(y=o((function*(){w.turnOffMusic(),this.resetState(),this.runOpenAnimation(),this.node.scene.emit(Js.HIDE_UI)})),function(){return y.apply(this,arguments)})},{key:"close",value:function(e){w.turnUpMusic(),kue.emit(mue.CLOSE_SCREEN,{screenName:this.node.name,screenData:e})}},{key:"resetState",value:function(){var e,t=(null===(e=this.payload.screenData)||void 0===e?void 0:e.failKey)===_v;this.titleLocalizer.key=t?"game.boom":"game.timesUp",this.descriptionLocalizer.key=t?"game.bombDesc":"game.timesUpDesc",this.timer.active=!t,this.bomb.active=t,t&&this.bombAnim.play();var n=Cue.getGameData();if(n){var i=n.coins>=Yy;this.replayButton.active=!i,this.buyTimeButton.active=i,this.adOpacity.opacity=0}}},{key:"runOpenAnimation",value:(h=o((function*(){var e=this;this.screen.container?(yield Promise.all(this.animNodes.map((function(t,n){return e.runAppearTween(t,.1*n)}))),yield this.runShowAdContainer()):console.warn("TimeUpScreen: screen not found")})),function(){return h.apply(this,arguments)})},{key:"runAppearTween",value:(d=o((function*(e,t){yield p.runTweenAsync(re(e).set({scale:new be(0,0,0)}).delay(t).to(1,{scale:new be(1,1,1)},{easing:function(e){return p.elasticOut(e,.1,.45)}}))})),function(e,t){return d.apply(this,arguments)})},{key:"runShowAdContainer",value:(c=o((function*(){var e=re(this.adOpacity);e.delay(1),e.to(.5,{opacity:255}),yield p.runTweenAsync(e)})),function(){return c.apply(this,arguments)})},{key:"handleClickReplay",value:(u=o((function*(){var e=this.screen.data.level;GameSDK.isGameSDK("Yandex")&&(yield C.showInterstitialAdAsync({forLevel:e})),this.close()})),function(){return u.apply(this,arguments)})},{key:"handleClickBuyTime",value:function(){this.node.scene.emit(Js.REMOVE_COINS,{coins:Yy,collectionAnimation:{animateTextOnly:!0}}),this.close({rescue:!0})}},{key:"handleClickAd",value:(r=o((function*(){(yield C.showRewardVideoAdAsync())&&this.close({rescue:!0})})),function(){return r.apply(this,arguments)})},{key:"handleClickClose",value:function(){var e,t,n=(null!==(e=null===(t=Cue.getGameData())||void 0===t?void 0:t.level)&&void 0!==e?e:1)>=13;this.close({customMode:n})}}]),f}(te)).prototype,"adOpacity",[sse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wse=a(mse.prototype,"animNodes",[use],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Sse=a(mse.prototype,"titleLocalizer",[cse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kse=a(mse.prototype,"descriptionLocalizer",[dse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cse=a(mse.prototype,"timer",[hse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ese=a(mse.prototype,"bomb",[pse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ase=a(mse.prototype,"bombAnim",[yse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tse=a(mse.prototype,"replayButton",[vse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pse=a(mse.prototype,"buyTimeButton",[fse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gse=mse))||gse)||gse);X._RF.pop(),X._RF.push({},"726c9oCUUBDpboDnHRz7SGZ","PauseScreen",void 0);var Eue,Aue,Tue,Pue,Lue,Oue,Iue,Rue,_ue,Due,Nue,Mue,Fue,Bue,xue,zue,Uue,Gue,Hue,que,Vue,$ue,Wue,Kue,jue,Yue,Xue,Jue,Zue=Z.ccclass,Que=Z.property,ece=Z.requireComponent,tce=Ludex,nce=tce.Events,ice=tce.Utils.Device,ace=tce.Match.Modes,oce=codex,rce=oce.player,lce=oce.event;Bse=Zue("PauseScreen"),xse=ece(Iee),zse=Que(me),Use=Que(me),Gse=Que(me),Hse=Que(X0),qse=Que(X0),Vse=Que(X0),$se=Que(fe),Wse=Que({type:fe,group:"Button Container"}),Kse=Que({type:fe,group:"Button Container"}),jse=Que({type:fe,group:"Button Container"}),Yse=Que({type:fe,group:"Button Container"}),Xse=Que({type:fe,group:"Button Container"}),Jse=Que(de),Bse(Zse=xse((eue=a((Qse=function(a){n(p,a);var r,u,c,d,h=i(p);function p(){var e;t(this,p);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),l(e,"musicSetting",eue,s(e)),l(e,"soundSetting",tue,s(e)),l(e,"vibrateSetting",nue,s(e)),l(e,"musicSwitch",iue,s(e)),l(e,"soundSwitch",aue,s(e)),l(e,"vibrateSwitch",oue,s(e)),l(e,"closeButtonComponent",rue,s(e)),l(e,"resumeButton",lue,s(e)),l(e,"restartButton",sue,s(e)),l(e,"challengeFriendsButton",uue,s(e)),l(e,"createShortcutButton",cue,s(e)),l(e,"customModeButton",due,s(e)),l(e,"containerUIOpacity",hue,s(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus(),e.updateButtonsStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){if("code"in t){var n=t.code,i=iv.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(iv.Events.UNLOCK_DEV_TOOLS),e.node.off(iv.Events.TRIGGER_UNLOCK_KEY)))}},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(fe),n=e.vibrateSetting.getComponentInChildren(X0),i=e.vibrateSetting.getComponentInChildren(qr);if(t&&n&&i)if(ice.isMobile()){var a,o=null!==(a=rce.getPlayerSetting("vibrate"))&&void 0!==a&&a;n.setEnabled(o)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(p,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){lce.on(nce.OPENING_SCREEN,this.handleOpeningScreen),lce.on(nce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){lce.off(nce.OPENING_SCREEN,this.handleOpeningScreen),lce.off(nce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(iv.Events.TRIGGER_UNLOCK_KEY),this.node.on(iv.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(iv.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(iv.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(iv.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.node.emit(iv.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(iv.Events.TRIGGER_RESET_SEQUENCE),x.closeScreen(z.PAUSE_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=rce.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=rce.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=rce.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.resumeButton.interactable=e,this.closeButtonComponent.interactable=e,this.restartButton.interactable=e,this.challengeFriendsButton.interactable=e,this.screen.backgroundMaskButton.interactable=e,this.customModeButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e,t=GameSDK.isGameSDK("Yandex"),n=Iv.getMatchMode()===ace.SINGLE||Iv.getMatchMode()===Nv,i=(null!==(e=rce.getGameData())&&void 0!==e?e:{}).level,a=void 0===i?1:i;this.setActiveButton(this.challengeFriendsButton,!t),this.setActiveButton(this.createShortcutButton,t&&ice.isDesktop()),this.setActiveButton(this.customModeButton,n&&a>=13),this.setActiveButton(this.resumeButton,!n)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(rce.setSetting("music",e),this.node.emit(iv.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e){var t=Iv.getMatchMode();w.playMusic(t===ace.TOURNAMENT?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC)}else w.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();rce.setSetting("sound",e),this.node.emit(iv.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();rce.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedResume",value:function(){this.resumeGame()}},{key:"handleClickedCustomMode",value:(d=o((function*(){var e;this.setVisible(!1);var t=(null!==(e=(yield x.openScreenAndWaitForClose(z.CUSTOM_GAME_SCREEN)).screenData)&&void 0!==e?e:{}).customMode;if(!t)return this.node.scene.emit(Js.HIDE_UI),void this.setVisible(!0);this.close(),this.node.scene.emit(Js.GAME_RESUME),this.node.scene.emit(Js.GAME_REPLAY,t?Nv:void 0)})),function(){return d.apply(this,arguments)})},{key:"handleClickedClose",value:function(){this.resumeGame()}},{key:"handleClickedRestart",value:(c=o((function*(){var e;this.close();var t=(null!==(e=rce.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;Iv.getMatchMode()===Nv?yield C.showRewardedInterstitialAdAsync({showError:!1}):yield C.showInterstitialAdAsync({forLevel:n}),Iv.getMatchMode()!==ace.TOURNAMENT?(this.node.scene.emit(Js.GAME_RESUME),this.node.scene.emit(Js.GAME_REPLAY)):x.openScreen(z.START_OVER_SCREEN)})),function(){return c.apply(this,arguments)})},{key:"handleClickedChallengeFriends",value:(u=o((function*(){if(GameSDK.isGameSDK("MsGames"))return x.showLoadingScreen(),yield GameSDK.extra.shareAsync(),void x.closeLoadingScreen();this.close(),this.node.scene.emit(Js.CHALLENGE_FRIENDS)})),function(){return u.apply(this,arguments)})},{key:"handleClickedCreateShortcut",value:(r=o((function*(){try{yield GameSDK.extra.checkAndCreateShortcutAsync()}catch(e){x.showNotificationScreenWithLocalizedKey("error.shortcutFail")}})),function(){return r.apply(this,arguments)})},{key:"resumeGame",value:function(){this.close(),this.node.scene.emit(Js.GAME_RESUME),this.node.scene.emit(Js.SHOW_UI)}},{key:"setVisible",value:function(e){this.containerUIOpacity.opacity=e?255:0}}]),p}(te)).prototype,"musicSetting",[zse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tue=a(Qse.prototype,"soundSetting",[Use],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nue=a(Qse.prototype,"vibrateSetting",[Gse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iue=a(Qse.prototype,"musicSwitch",[Hse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aue=a(Qse.prototype,"soundSwitch",[qse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oue=a(Qse.prototype,"vibrateSwitch",[Vse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rue=a(Qse.prototype,"closeButtonComponent",[$se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lue=a(Qse.prototype,"resumeButton",[Wse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sue=a(Qse.prototype,"restartButton",[Kse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uue=a(Qse.prototype,"challengeFriendsButton",[jse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cue=a(Qse.prototype,"createShortcutButton",[Yse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),due=a(Qse.prototype,"customModeButton",[Xse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hue=a(Qse.prototype,"containerUIOpacity",[Jse],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zse=Qse))||Zse);X._RF.pop(),X._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var sce,uce,cce,dce,hce,pce,yce,vce,fce,gce,mce,bce,wce,Sce,kce,Cce,Ece,Ace,Tce,Pce,Lce,Oce,Ice,Rce=Z.ccclass,_ce=Z.property,Dce=Z.requireComponent,Nce=Ludex,Mce=Nce.Events,Fce=Nce.Utils.Device,Bce=Nce.Match.Modes,xce=Nce.Configs.Debugger.MonitorError,zce=Nce.Plugins.Analytics,Uce=(void 0===zce?{}:zce).Events,Gce=codex,Hce=Gce.player,qce=Gce.event,Vce=Gce.monitorError,$ce=Gce.frameCapture,Wce=Gce.analytics;Eue=Rce("SettingsScreen"),Aue=Dce(Iee),Tue=_ce({type:me,group:"SettingContainer"}),Pue=_ce({type:me,group:"SettingContainer"}),Lue=_ce({type:me,group:"SettingContainer"}),Oue=_ce({type:X0,group:"Switch Container"}),Iue=_ce({type:X0,group:"Switch Container"}),Rue=_ce({type:X0,group:"Switch Container"}),_ue=_ce(fe),Due=_ce({type:fe,group:"Button Container"}),Nue=_ce({type:fe,group:"Button Container"}),Mue=_ce({type:fe,group:"Button Container"}),Fue=_ce({type:fe,group:"Button Container"}),Bue=_ce({type:fe,group:"Button Container"}),Eue(xue=Aue((Uue=a((zue=function(a){n(y,a);var r,u,c,d,h,p=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=p.call.apply(p,[this].concat(i)),l(e,"musicSetting",Uue,s(e)),l(e,"soundSetting",Gue,s(e)),l(e,"vibrateSetting",Hue,s(e)),l(e,"musicSwitch",que,s(e)),l(e,"soundSwitch",Vue,s(e)),l(e,"vibrateSwitch",$ue,s(e)),l(e,"closeButton",Wue,s(e)),l(e,"reportButton",Kue,s(e)),l(e,"shareButton",jue,s(e)),l(e,"inviteFriendsButton",Yue,s(e)),l(e,"feedbackButton",Xue,s(e)),l(e,"createShortcutButton",Jue,s(e)),e.handleOpeningScreen=function(t){e.validateSwitchScreenPayload(t)&&(e.setInteractableButtons(!0),e.updateStatus())},e.handleOpenedScreen=function(t){e.validateSwitchScreenPayload(t)&&e.open()},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(fe),n=e.vibrateSetting.getComponentInChildren(X0),i=e.vibrateSetting.getComponentInChildren(qr);if(t&&n&&i)if(Fce.isMobile()){var a,o=null!==(a=Hce.getPlayerSetting("vibrate"))&&void 0!==a&&a;n.setEnabled(o)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return e(y,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.listenScreenEvents(),this.updateButtonsStatus()}},{key:"onDestroy",value:function(){this.unlistenScreenEvents()}},{key:"listenScreenEvents",value:function(){qce.on(Mce.OPENING_SCREEN,this.handleOpeningScreen),qce.on(Mce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unlistenScreenEvents",value:function(){qce.off(Mce.OPENING_SCREEN,this.handleOpeningScreen),qce.off(Mce.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.node.emit(iv.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(iv.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(Js.SHOW_UI),x.closeScreen(z.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=Hce.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=Hce.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=Hce.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),GameSDK.isGameSDK("GameDistribution")||this.updateVibrateButton()):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"setInteractableButtons",value:function(e){this.closeButton.interactable=e,this.reportButton.interactable=e,this.shareButton.interactable=e,this.inviteFriendsButton.interactable=e,this.feedbackButton.interactable=e,this.createShortcutButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"updateButtonsStatus",value:function(){var e=GameSDK.isGameSDK("Yandex"),t=GameSDK.isGameSDK("MsGames");this.setActiveButton(this.reportButton,xce.Feedback),this.setActiveButton(this.shareButton,!e&&!t),this.setActiveButton(this.inviteFriendsButton,!e),this.setActiveButton(this.feedbackButton,e),this.setActiveButton(this.createShortcutButton,e&&Fce.isDesktop()||t)}},{key:"setActiveButton",value:function(e,t){e&&e.node.parent&&(e.node.parent.active=t)}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();if(Hce.setSetting("music",e),e){var t=Iv.getMatchMode();w.playMusic(t===Bce.TOURNAMENT?Qi.TOURNAMENT_MUSIC:Qi.BG_MUSIC)}else w.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();Hce.setSetting("sound",e)}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();Hce.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedReport",value:function(){null==Vce||Vce.feedbackAsync()}},{key:"handleClickedShare",value:(h=o((function*(){if(GameSDK.isGameSDK("FacebookInstant"))return x.showLoadingScreen(),GameSDK.extra.isNEZP()?yield SM.shareBestScoreWithOverlay():yield GameSDK.extra.shareBestScoreAsync(),void x.closeLoadingScreen();this.close()})),function(){return h.apply(this,arguments)})},{key:"handleClickedInviteFriends",value:(d=o((function*(){x.showLoadingScreen(),GameSDK.isGameSDK("MsGames")&&(yield GameSDK.extra.shareAsync()),GameSDK.isGameSDK("FacebookInstant")&&(yield this.inviteWithBestScoreFbInstant()),x.closeLoadingScreen()})),function(){return d.apply(this,arguments)})},{key:"handleClickedFeedback",value:function(){var e="error.ratingFail";"ratingAsync"in GameSDK.extra?GameSDK.extra.ratingAsync().catch((function(t){if("code"in t){switch(t.code){case"NO_AUTH":e="error.ratingNoAuth";break;case"GAME_RATED":e="error.ratingGameRated"}x.showNotificationScreenWithLocalizedKey(e)}else x.showNotificationScreenWithLocalizedKey(e)})):x.showNotificationScreenWithLocalizedKey(e)}},{key:"handleClickedCreateShortcut",value:(c=o((function*(){try{yield GameSDK.extra.checkAndCreateShortcutAsync()}catch(e){x.showNotificationScreenWithLocalizedKey("error.shortcutFail")}})),function(){return c.apply(this,arguments)})},{key:"inviteWithBestScoreFbInstant",value:(u=o((function*(){GameSDK.isGameSDK("FacebookInstant")&&(GameSDK.extra.isNEZP()?yield SM.inviteFriendsWithOverlay():yield this.inviteWithBestScoreAsync())})),function(){return u.apply(this,arguments)})},{key:"inviteWithBestScoreAsync",value:(r=o((function*(){if(GameSDK.isGameSDK("FacebookInstant"))try{if(!$ce)throw new Error("FrameCapture not found");var e=Hce.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=(e.data||{}).score,o=yield $ce.renderAsync("share-score-with-invite",{playerId:t,playerPhoto:i,playerScore:a});if(null===o)throw new Error("Failed to render share score wideframe");yield GameSDK.extra.inviteAsync({text:{default:"Great! I got a new best score!",localizations:{vi_VN:"Tht tuyt! Mnh va ph k lc ny!"}},image:o,data:{playerId:t,playerName:n,playerPhoto:i,type:"share_invite"}}),Uce&&Wce.event(Uce.INVITE,{invite_content_type:"BestScore",success:!0})}catch(e){Uce&&Wce.event(Uce.INVITE,{invite_content_type:"BestScore",success:!1}),console.warn(e)}})),function(){return r.apply(this,arguments)})}]),y}(te)).prototype,"musicSetting",[Tue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gue=a(zue.prototype,"soundSetting",[Pue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hue=a(zue.prototype,"vibrateSetting",[Lue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),que=a(zue.prototype,"musicSwitch",[Oue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vue=a(zue.prototype,"soundSwitch",[Iue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$ue=a(zue.prototype,"vibrateSwitch",[Rue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wue=a(zue.prototype,"closeButton",[_ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kue=a(zue.prototype,"reportButton",[Due],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jue=a(zue.prototype,"shareButton",[Nue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yue=a(zue.prototype,"inviteFriendsButton",[Mue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xue=a(zue.prototype,"feedbackButton",[Fue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jue=a(zue.prototype,"createShortcutButton",[Bue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xue=zue))||xue);X._RF.pop(),X._RF.push({},"891d37NJ6lLdp3CNLPHxZ6d","StarChest",void 0);var Kce,jce,Yce,Xce,Jce,Zce,Qce,ede,tde,nde,ide,ade,ode,rde,lde,sde,ude,cde,dde,hde,pde=Z.ccclass,yde=Z.property,vde=(sce=pde("StarChest"),uce=yde(he),cce=yde(de),dce=yde(Oe),hce=yde(de),pce=yde(de),yce=yde({type:ae,readonly:!0,displayName:"Starting Offset X",group:"Reward Animations"}),vce=yde({type:ae,readonly:!0,displayName:"Starting Offset Y",group:"Reward Animations"}),fce=yde({type:ae,displayName:"Centered Offset X",group:"Reward Animations"}),gce=yde({type:ae,displayName:"Centered Offset Y",group:"Reward Animations"}),mce=yde({type:ae,min:0,displayName:"Starting Scale",group:"Reward Animations"}),bce=yde({type:ae,min:0,displayName:"Ending Scale",group:"Reward Animations"}),sce((kce=a((Sce=function(a){n(v,a);var r,u,c,d,h,y=i(v);function v(){var e;t(this,v);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=y.call.apply(y,[this].concat(i)),l(e,"sprite",kce,s(e)),l(e,"glowOpacity",Cce,s(e)),l(e,"explosionParticles",Ece,s(e)),l(e,"circle",Ace,s(e)),l(e,"uiOpacity",Tce,s(e)),e.ogCenterX=0,e.ogCenterY=0,l(e,"endingOffsetX",Pce,s(e)),l(e,"endingOffsetY",Lce,s(e)),l(e,"startingScale",Oce,s(e)),l(e,"endingScale",Ice,s(e)),e}return e(v,[{key:"startingOffsetX",get:function(){return this.node.position.x}},{key:"startingOffsetY",get:function(){return this.node.position.y}},{key:"__preload",value:function(){this.validateRequiredComponents(),this.ogCenterX=this.startingOffsetX,this.ogCenterY=this.startingOffsetY}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"moveToCenter",value:(h=o((function*(e){var t=new be(this.endingOffsetX,this.endingOffsetY,this.node.position.z);yield p.runTweenAsync(re(this.node).to(.7,{position:t},{easing:"quintInOut"}),e),this.node.position=t})),function(e){return h.apply(this,arguments)})},{key:"respawnAtStartingState",value:function(){this.node.position=new be(this.ogCenterX,this.ogCenterY,this.node.position.z),this.glowOpacity.opacity=0,this.sprite.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.glowOpacity.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.uiOpacity.opacity=255}},{key:"scale",value:(d=o((function*(e,t){var n=this.startingScale+(this.endingScale-this.startingScale)*e,i=new be(n,n,n);yield Promise.all([p.runTweenAsync(re(this.sprite.node).to(.2,{scale:i},{easing:"backOut"}),t),p.runTweenAsync(re(this.glowOpacity.node).to(.2,{scale:i},{easing:"backOut"}),t)]),this.sprite.node.setScale(i),this.glowOpacity.node.setScale(i)})),function(e,t){return d.apply(this,arguments)})},{key:"startShaking",value:function(){var e=this,t=this.node.position.clone();this.shakingTween={ogPos:t,tw:re(this.node).to(.1,{},{onUpdate:function(n,i){if(i){var a=t.x+10*(i-.5);e.node.position=new be(a,t.y,t.z)}}}).repeatForever().start()}}},{key:"stopShaking",value:function(){this.shakingTween&&(this.shakingTween.tw.stop(),this.node.position=this.shakingTween.ogPos,this.shakingTween=void 0)}},{key:"glow",value:(c=o((function*(e){var t=this.sprite.node.scale.clone().multiplyScalar(1.1);yield Promise.all([p.runTweenAsync(re(this.sprite.node).to(.2,{scale:t},{easing:"cubicInOut"}),e),p.runTweenAsync(re(this.glowOpacity.node).to(.2,{scale:t}),e),p.runTweenAsync(re(this.glowOpacity).to(.5,{opacity:255}),e)])})),function(e){return c.apply(this,arguments)})},{key:"explode",value:(u=o((function*(e){var t=this,n=new be(8,8,8),i=function(){var i=o((function*(){t.circle.opacity=255,t.circle.node.setScale(be.ZERO),yield Promise.all([p.runTweenAsync(re(t.circle).to(.3,{opacity:0}),e),p.runTweenAsync(re(t.circle.node).to(.3,{scale:n},{easing:"cubicOut"}),e)]),t.circle.opacity=0,t.circle.node.scale=n}));return function(){return i.apply(this,arguments)}}(),a=function(){var n=o((function*(){yield Promise.all([p.runTweenAsync(re(t.glowOpacity.node).to(.3,{scale:be.ZERO},{easing:"cubicOut"}),e),p.runTweenAsync(re(t.sprite.node).to(.3,{scale:be.ZERO},{easing:"cubicOut"}),e)]),t.sprite.node.setScale(be.ZERO),t.glowOpacity.node.setScale(be.ZERO)}));return function(){return n.apply(this,arguments)}}();yield Promise.all([this.explodeParticles(e),i(),a()])})),function(e){return u.apply(this,arguments)})},{key:"explodeParticles",value:(r=o((function*(e){e.aborted||(this.explosionParticles.node.active=!0,this.explosionParticles.resetSystem(),yield p.waitTweenAsync(1),this.explosionParticles.node.active=!1)})),function(e){return r.apply(this,arguments)})}]),v}(te)).prototype,"sprite",[uce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cce=a(Sce.prototype,"glowOpacity",[cce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ece=a(Sce.prototype,"explosionParticles",[dce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ace=a(Sce.prototype,"circle",[hce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tce=a(Sce.prototype,"uiOpacity",[pce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Sce.prototype,"startingOffsetX",[yce],Object.getOwnPropertyDescriptor(Sce.prototype,"startingOffsetX"),Sce.prototype),a(Sce.prototype,"startingOffsetY",[vce],Object.getOwnPropertyDescriptor(Sce.prototype,"startingOffsetY"),Sce.prototype),Pce=a(Sce.prototype,"endingOffsetX",[fce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Lce=a(Sce.prototype,"endingOffsetY",[gce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Oce=a(Sce.prototype,"startingScale",[mce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ice=a(Sce.prototype,"endingScale",[bce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),wce=Sce))||wce);X._RF.pop(),X._RF.push({},"e414bczbutHJKcOfhl1sc4p","StarChestScreen",void 0);var fde,gde,mde,bde,wde,Sde,kde,Cde,Ede=Z.ccclass,Ade=Z.property,Tde=Z.requireComponent,Pde=Ludex.Events,Lde=codex,Ode=Lde.event,Ide=Lde.player;Kce=Ede("StarChestScreen"),jce=Tde(Iee),Yce=Ade(oW),Xce=Ade(fe),Jce=Ade(fe),Zce=Ade(ze),Qce=Ade(vde),ede=Ade(de),tde=Ade(IH),nde=Ade(Lh),Kce(ide=jce((ode=a((ade=function(a){n(y,a);var r,u,c,d,h=i(y);function y(){var e;t(this,y);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=h.call.apply(h,[this].concat(i)),l(e,"starProgressBar",ode,s(e)),l(e,"openButton",rde,s(e)),l(e,"continueButton",lde,s(e)),l(e,"chestAnimation",sde,s(e)),l(e,"starChest",ude,s(e)),l(e,"chestUnlockFXMask",cde,s(e)),l(e,"skipOverlay",dde,s(e)),l(e,"messageLabelLocalizer",hde,s(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("StarChestScreen: screen not found");e.validateEventPayload(t)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(y,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Ode.on(Pde.OPENING_SCREEN,this.handleOpeningScreen),Ode.on(Pde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Ode.off(Pde.OPENING_SCREEN,this.handleOpeningScreen),Ode.off(Pde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Js.HIDE_UI);var e=Ide.getGameData();if(e){var t=e.stars;this.numChestAvailable=Math.floor(t/20),this.starProgressBar.setRange(t,20);var n=this.numChestAvailable>0;this.setInteractableButtons(!0),this.openButton.node.active=n,this.openButton.interactable=n,this.continueButton.node.active=!n,this.continueButton.interactable=!n,this.messageLabelLocalizer.key=this.numChestAvailable?"reward.starChestAvailable":"reward.starChestUnavailable",this.numChestAvailable?this.chestAnimation.play():this.chestAnimation.stop(),this.chestUnlockFXMask.node.active=!1,this.chestUnlockFXMask.opacity=0,this.starChest.respawnAtStartingState()}}},{key:"close",value:function(){this.setInteractableButtons(!1),Ode.emit(Pde.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(Js.SHOW_UI)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StarChestScreen: screen not found")}},{key:"handleClickButton",value:(d=o((function*(){if(0!==this.numChestAvailable){w.turnDownMusic();var e=Ide.getGameData();if(e){this.setInteractableButtons(!1);var t=e.stars;Ide.setGameData({stars:e.stars-20*this.numChestAvailable});var n=new Mi;yield this.skipOverlay.open({opacity:200,onSkip:function(){return n.abort()}}),yield this.handleUnlockAnimation(t,e.stars,n),yield this.skipOverlay.close(),w.turnUpMusic(),se.emit(kn),this.close()}}else this.close()})),function(){return d.apply(this,arguments)})},{key:"handleUnlockAnimation",value:(c=o((function*(e,t,n){var i=this;yield Promise.all([this.starChest.moveToCenter(n),this.fadeInChestUnlockFX(n)]),this.chestAnimation.stop(),this.starChest.startShaking(),yield w.playSound(Qi.STAR_CHEST_DRUM_ROLL,{loop:!0}),yield p.waitTweenAsync(0);var a=e,o=this.numChestAvailable;yield Promise.all([this.starProgressBar.animateTo(t,n,(function(e){var t;a-e>=20&&(a=e,o--,i.starChest.scale((t=o,i.numChestAvailable>2?1-t/i.numChestAvailable:.35*(1-t/i.numChestAvailable)),n),w.playSound(Qi.STAR_CHEST_OPEN))}))]),yield p.waitTweenAsync(1,n),this.starChest.stopShaking(),yield this.starChest.glow(n),w.stopSound(Qi.STAR_CHEST_DRUM_ROLL);var r=Ky*this.numChestAvailable;this.node.scene.emit(Js.ADD_COINS,{coins:r,collectionAnimation:{animateTextOnly:!1,floatDuration:3,signal:n},skipAnimation:!0}),yield this.starChest.explode(n),yield p.waitTweenAsync(1,n),yield Promise.all([this.fadeOutChestUnlockFX(n)])})),function(e,t,n){return c.apply(this,arguments)})},{key:"fadeInChestUnlockFX",value:(u=o((function*(e){this.chestUnlockFXMask.node.active=!0,yield p.runTweenAsync(re(this.chestUnlockFXMask).to(.5,{opacity:150}),e)})),function(e){return u.apply(this,arguments)})},{key:"fadeOutChestUnlockFX",value:(r=o((function*(e){yield p.runTweenAsync(re(this.chestUnlockFXMask).to(.3,{opacity:0}),e),this.chestUnlockFXMask.opacity=0,this.chestUnlockFXMask.node.active=!1})),function(e){return r.apply(this,arguments)})},{key:"setInteractableButtons",value:function(e){this.openButton.interactable=e,this.continueButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}}]),y}(te)).prototype,"starProgressBar",[Yce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rde=a(ade.prototype,"openButton",[Xce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lde=a(ade.prototype,"continueButton",[Jce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sde=a(ade.prototype,"chestAnimation",[Zce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ude=a(ade.prototype,"starChest",[Qce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cde=a(ade.prototype,"chestUnlockFXMask",[ede],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dde=a(ade.prototype,"skipOverlay",[tde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hde=a(ade.prototype,"messageLabelLocalizer",[nde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ide=ade))||ide);X._RF.pop(),X._RF.push({},"2f7694kcVZNWq3iTCp1piqI","StartOverScreen",void 0);var Rde,_de,Dde,Nde,Mde,Fde=Z.ccclass,Bde=Z.property,xde=Z.requireComponent,zde=Ludex.Events,Ude=codex,Gde=Ude.event;Ude.player,fde=Fde("StartOverScreen"),gde=xde(Iee),mde=Bde(fe),bde=Bde(fe),fde(wde=gde((kde=a((Sde=function(a){n(c,a);var r,u=i(c);function c(){var e;t(this,c);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"restartButton",kde,s(e)),l(e,"cancelButton",Cde,s(e)),e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.setInteractableButtons(!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return e(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Yn.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Gde.on(zde.OPENING_SCREEN,this.handleOpeningScreen),Gde.on(zde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Gde.off(zde.OPENING_SCREEN,this.handleOpeningScreen),Gde.off(zde.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return(null!=e?e:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),x.closeScreen(z.START_OVER_SCREEN)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(e){this.restartButton.interactable=e,this.cancelButton.interactable=e,this.screen.backgroundMaskButton.interactable=e}},{key:"handleClickedCancel",value:function(){this.close(),this.node.scene.emit(Js.GAME_RESUME),this.node.scene.emit(Js.SHOW_UI)}},{key:"handleClickedRestart",value:(r=o((function*(){this.close(),this.node.scene.emit(Js.GAME_RESUME),this.node.scene.emit(Js.GAME_REPLAY)})),function(){return r.apply(this,arguments)})}]),c}(te)).prototype,"restartButton",[mde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cde=a(Sde.prototype,"cancelButton",[bde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wde=Sde))||wde);X._RF.pop(),X._RF.push({},"d6d78U+W5xDwqln9pXXQOaF","TopLeaders",void 0);var Hde=Z.ccclass,qde=Z.property,Vde=(Rde=Hde("TopLeaders"),_de=qde(t6),Rde((Mde=a((Nde=function(a){n(d,a);var r,u=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=u.call.apply(u,[this].concat(i)),l(e,"topLeaders",Mde,s(e)),e.leaderData=[],e}return e(d,[{key:"updateData",value:function(e){var t=this;this.leaderData=e.slice(0,3),this.leaderData.slice(0,3).forEach((function(e,n){t.topLeaders[n].updateInfo({playerId:e.playerId,name:e.name,photo:e.photo,score:e.score})}))}},{key:"playShowLeadersAnimation",value:(r=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,i=.3;yield Promise.all(this.leaderData.map(function(){var a=o((function*(a,o){var r=t.topLeaders[o];yield r.runShowUpAnimation(o*n,i,e)}));return function(e,t){return a.apply(this,arguments)}}()))})),function(e){return r.apply(this,arguments)})},{key:"hideLeaders",value:function(){var e,t=c(this.topLeaders);try{for(t.s();!(e=t.n()).done;){e.value.setVisible(!1)}}catch(e){t.e(e)}finally{t.f()}}}]),d}(te)).prototype,"topLeaders",[_de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Dde=Nde))||Dde);X._RF.pop(),X._RF.push({},"c4670J4h0NFE5fCQacNQNsB","TournamentDetailOverlay",void 0);var $de,Wde,Kde,jde,Yde,Xde=Ludex.Utils,Jde=(Xde.Time,Xde.Object),Zde=function(){function n(e){var i=this;t(this,n),this.isScreenActive=!1,this.createLeaderboardDiv$=function(){i.leaderboardDiv$=document.createElement("div"),Jde.assign(i.leaderboardDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",left:"50%",scrollbarWidth:"none",alignItems:"start",overflow:"auto",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.leaderboardDiv$)},this.createTopPlayerDiv$=function(){i.topPlayerDiv$=document.createElement("div"),Jde.assign(i.topPlayerDiv$.style,{position:"absolute",transform:"translate(-50%, -50%)",left:"50%",scrollbarWidth:"none",alignItems:"start",overflow:"hidden",backgroundColor:"transparent",opacity:"0",transition:"opacity 0.3s ease-in-out",pointerEvents:"none",display:"none",userSelect:"none"}),document.body.appendChild(i.topPlayerDiv$)},this.updateTopPlayerElement$=function(){var e=o((function*(e){var t=e.tournamentPlayers.slice().sort((function(e,t){return e.rank-t.rank})).slice(0,3),n=u(u({},e),{},{tournamentPlayers:t,leaderboardPosition:e.leaderboardPosition,topPlayerPosition:e.topPlayerPosition});return i.topPlayerElement$?(yield i.topPlayerElement$.updateAsync(n),i.topPlayerElement$):yield SM.createOverlayViewAsync("overlays/tournament/top-player-overlay.xml",i.topPlayerDiv$,i.getTopPlayerIframeCss$(),"overlays/tournament/top-player-overlay-styles.css",n)}));return function(t){return e.apply(this,arguments)}}(),this.updateLeaderboardElement$=function(){var e=o((function*(e){if(i.leaderboardElement$){yield i.leaderboardElement$.updateAsync(e);var t=i.leaderboardElement$.getIFrameElement(),n=i.getLeaderboardIframeCss$(e);return t.style.cssText=n,i.leaderboardElement$}return yield SM.createOverlayViewAsync("overlays/tournament/leaderboard-overlay.xml",i.leaderboardDiv$,i.getLeaderboardIframeCss$(e),"overlays/tournament/leaderboard-overlay-styles.css",e)}));return function(t){return e.apply(this,arguments)}}(),this.isPayloadChanged$=function(e){if(!i.currentPayload$)return!0;if(i.currentPayload$.tournamentPlayers.length!==e.tournamentPlayers.length)return!0;for(var t=0;t<e.tournamentPlayers.length;t++){var n=i.currentPayload$.tournamentPlayers[t],a=e.tournamentPlayers[t];if(!n||!a)return!0;if(n.playerId!==a.playerId||n.rank!==a.rank||n.score!==a.score)return!0}return!1},this.showOverlay$=o((function*(){if(i.leaderboardElement$&&i.topPlayerElement$){var e=i.leaderboardElement$.showAsync(),t=i.topPlayerElement$.showAsync();yield Promise.all([e,t]),i.revealMainDivs$()}})),this.revealMainDivs$=function(){i.isScreenActive&&i.leaderboardElement$&&i.topPlayerElement$&&(Jde.assign(i.leaderboardDiv$.style,{display:"block"}),i.leaderboardDiv$.scrollTop=0,Jde.assign(i.topPlayerDiv$.style,{display:"block"}),requestAnimationFrame((function(){if(!i.isScreenActive)return i.leaderboardDiv$.style.display="none",void(i.topPlayerDiv$.style.display="none");Jde.assign(i.leaderboardDiv$.style,{opacity:"1",pointerEvents:"auto"}),Jde.assign(i.topPlayerDiv$.style,{opacity:"1",pointerEvents:"auto"})})))},this.validateOverlayPayload$=function(e){var t,n=u(u({},e),{},{tournamentPlayers:[]}),i=/^\d+$/,a=c(e.tournamentPlayers);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.test(o.playerId)&&n.tournamentPlayers.push(o)}}catch(e){a.e(e)}finally{a.f()}return n},this.getLeaderboardIframeCss$=function(e){var t=e.tournamentPlayers,n=e.leaderboardPosition,a=i.getElementDivWidth$(n),o=t.length,r="height: calc((".concat(a,"px * (107 / 593) - 2px) * ").concat(o," + 15px);");return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat(r,"   ")},this.getTopPlayerIframeCss$=function(){return"".concat("width: 100%;"," ").concat("border-width: 0px;"," ").concat("overflow: hidden;"," ").concat("display: block;"," ").concat("height: 130%;"," ").concat("top: -23%;"," ").concat("position: absolute;")},this.getElementDivWidth$=function(e){return e.width*SM.getGameScaleFactor()},this.getElementDivHeight$=function(e){return e.height*SM.getGameScaleFactor()},this.getElementDivTopOffset$=function(e){return e.worldY*SM.getGameScaleFactor()},this.getElementDivLeftOffset$=function(e){return e.worldX*SM.getGameScaleFactor()},this.moveAndResizeOverlays$=function(e){var t=e.leaderboardPosition,n=e.topPlayerPosition;i.updateDivPosition$(i.leaderboardDiv$,t),i.updateDivPosition$(i.topPlayerDiv$,n)},this.updateDivPosition$=function(e,t){if(e){var n="".concat(i.getElementDivWidth$(t),"px"),a="".concat(i.getElementDivHeight$(t),"px"),o="".concat(i.getElementDivLeftOffset$(t),"px"),r="".concat(i.getElementDivTopOffset$(t),"px");Jde.assign(e.style,{width:n,height:a,left:o,top:"calc(100vh - ".concat(r,")")})}},this.scene=e,this.createLeaderboardDiv$(),this.createTopPlayerDiv$()}var i,a;return e(n,[{key:"updateOverlay",value:(a=o((function*(e){try{if(!this.isScreenActive)return!1;var t=this.validateOverlayPayload$(e);if(this.moveAndResizeOverlays$(t),!this.isPayloadChanged$(t))return yield this.revealMainDivs$(),!0;this.topPlayerElement$=yield this.updateTopPlayerElement$(t),this.leaderboardElement$=yield this.updateLeaderboardElement$(t),this.currentPayload$=t,yield this.showOverlay$()}catch(e){return console.error("Error creating overlay view:",e),!1}return!0})),function(e){return a.apply(this,arguments)})},{key:"hideOverlay",value:(i=o((function*(){this.leaderboardElement$&&this.topPlayerElement$&&(Jde.assign(this.leaderboardDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"}),Jde.assign(this.topPlayerDiv$.style,{opacity:"0",pointerEvents:"none",display:"none"}))})),function(){return i.apply(this,arguments)})},{key:"setIsScreenActive",value:function(e){this.isScreenActive=e}}]),n}();X._RF.pop(),X._RF.push({},"fe274iMNmBCzZ13Ie1nGU1R","TournamentLeaderSkeleton",void 0);var Qde,ehe,the,nhe,ihe,ahe,ohe,rhe,lhe,she,uhe,che,dhe,hhe,phe,yhe,vhe,fhe,ghe,mhe,bhe,whe,She,khe,Che,Ehe,Ahe,The,Phe,Lhe,Ohe,Ihe,Rhe,_he,Dhe,Nhe,Mhe,Fhe,Bhe,xhe,zhe,Uhe,Ghe,Hhe,qhe,Vhe,$he,Whe,Khe,jhe,Yhe,Xhe,Jhe,Zhe,Qhe,epe,tpe,npe,ipe,ape,ope,rpe,lpe,spe,upe,cpe,dpe,hpe,ppe,ype,vpe=Z.ccclass,fpe=Z.property,gpe=($de=vpe("TournamentLeaderSkeleton"),Wde=fpe(me),$de((Yde=a((jde=function(a){n(d,a);var r,u,c=i(d);function d(){var e;t(this,d);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=c.call.apply(c,[this].concat(i)),l(e,"container",Yde,s(e)),e}return e(d,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(de),this.validateRequiredComponents()}},{key:"hide",value:(u=o((function*(e){var t=this;yield p.runTweenAsync(re(this.uiOpacity).to(.2,{opacity:0}).call((function(){t.node.active=!1})),e)})),function(e){return u.apply(this,arguments)})},{key:"show",value:(r=o((function*(e,t){this.node.active=!0,this.node.scale=new be(.8,.8,.8),this.uiOpacity.opacity=0;var n=this.container.position.clone();this.container.position=new be(n.x,n.y-100,n.z);var i=re(this.node).delay(e);i.to(.2,{scale:be.ONE},{easing:"elasticOut"});var a=re(this.container).delay(e);a.to(.2,{position:n},{easing:"backOut"});var o=re(this.uiOpacity).delay(e);o.to(.2,{opacity:255},{easing:"cubicOut"}),yield Promise.all([p.runTweenAsync(i,t),p.runTweenAsync(a,t),p.runTweenAsync(o,t)]),this.node.scale=be.ONE,this.container.position=n,this.uiOpacity.opacity=255})),function(e,t){return r.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),d}(te)).prototype,"container",[Wde],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kde=jde))||Kde);X._RF.pop(),X._RF.push({},"cdaa9B4pK9PFrDmP6/GQcMn","TournamentDetailScreen",void 0);var mpe,bpe=Z.ccclass,wpe=Z.property,Spe=Z.requireComponent,kpe=Ludex,Cpe=kpe.Events,Epe=kpe.Utils,Ape=Epe.Object,Tpe=Epe.Time,Ppe=Epe.Number,Lpe=codex,Ope=Lpe.event,Ipe=Lpe.storage,Rpe=Lpe.player,_pe=Lpe.leaderboard,Dpe=Lpe.language,Npe=1166;Qde=bpe("TournamentDetailScreen"),ehe=Spe(Iee),the=Yn.required(),nhe=Yn.required(),ihe=wpe(ke),ahe=Yn.required(),ohe=wpe(Lh),rhe=Yn.required(),lhe=wpe(Lh),she=Yn.required(),uhe=wpe(Lh),che=Yn.required(),dhe=wpe(z2),hhe=Yn.required(),phe=wpe(Vde),yhe=Yn.required(),vhe=wpe({type:me,group:"Buttons"}),fhe=Yn.required(),ghe=wpe({type:me,group:"Buttons"}),mhe=Yn.required(),bhe=wpe({type:me,group:"Buttons"}),whe=Yn.required(),She=wpe({type:me,group:"Buttons"}),khe=Yn.required(),Che=wpe({type:le,group:"Buttons"}),Ehe=Yn.required(),Ahe=wpe({type:he}),The=Yn.required(),Phe=wpe({type:me}),Lhe=Yn.required(),Ohe=wpe({type:me}),Ihe=wpe({type:[gpe]}),Rhe=wpe({type:zT,group:"Confetti"}),_he=wpe({type:zT,group:"Confetti"}),Dhe=Yn.required(),Nhe=wpe({type:ne,group:"Container"}),Mhe=Yn.required(),Fhe=wpe({type:ne,group:"Container"}),Bhe=Yn.required(),xhe=wpe({type:me,group:"Container"}),zhe=Yn.onlyRunInLifeCycleAsync,Uhe=Yn.onlyRunInLifeCycleAsync,Ghe=Yn.onlyRunInLifeCycleAsync,Hhe=Yn.onlyRunInLifeCycleAsync,qhe=Yn.onlyRunInLifeCycleAsync,Vhe=Yn.onlyRunInLifeCycle,$he=Yn.onlyRunInLifeCycle,Qde(Whe=ehe((jhe=a((Khe=function(a){n(k,a);var d,h,p,y,v,f,g,m,b,S=i(k);function k(){var e;t(this,k);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=S.call.apply(S,[this].concat(i)),l(e,"screen",jhe,s(e)),l(e,"title",Yhe,s(e)),l(e,"titleLocalizer",Xhe,s(e)),l(e,"timeLocalizer",Jhe,s(e)),l(e,"playerCountLocalizer",Zhe,s(e)),l(e,"tournamentLeaders",Qhe,s(e)),l(e,"topLeaders",epe,s(e)),l(e,"playButton",tpe,s(e)),l(e,"continueButton",npe,s(e)),l(e,"replayButton",ipe,s(e)),l(e,"logInButton",ape,s(e)),l(e,"buttonsLayout",ope,s(e)),l(e,"banner",rpe,s(e)),l(e,"bannerLoadingRing",lpe,s(e)),l(e,"bannerMask",spe,s(e)),l(e,"leaderSkeletons",upe,s(e)),l(e,"leftConfetti",cpe,s(e)),l(e,"rightConfetti",dpe,s(e)),l(e,"container",hpe,s(e)),l(e,"tempContainer",ppe,s(e)),l(e,"topPlayerOverlayRef",ype,s(e)),e.signal$=new Mi,e.isOverlayMode$=!1,e.leadersPayload$=null,e.tournamentDetailOverlay$=null,e.listenScreenEvents$=function(){Ope.on(Cpe.OPENING_SCREEN,e.handleOpeningScreen$),Ope.on(Cpe.OPENED_SCREEN,e.handleOpenedScreen$)},e.unListenScreenEvents$=function(){Ope.off(Cpe.OPENING_SCREEN,e.handleOpeningScreen$),Ope.off(Cpe.OPENED_SCREEN,e.handleOpenedScreen$)},e.handleOpeningScreen$=function(t){if(!e.screen)throw new Error("TournamentDetailScreen: screen not found");e.validateEventPayload$(t)&&(e.enabled=!0)},e.handleOpenedScreen$=function(t){e.validateEventPayload$(t)&&e.open()},e.validateEventPayload$=function(t){return(null!=t?t:{}).screenName===e.node.name&&(e.payload$=t,!0)},e.cleanup$=function(){var t;null===(t=e.signal$)||void 0===t||t.abort(),e.signal$=new Mi,e.tournamentLeaders.hideLeaders(),e.topLeaders.hideLeaders(),e.cleanupOverlay$()},e.cleanupOverlay$=function(){var t;null===(t=e.tournamentDetailOverlay$)||void 0===t||t.hideOverlay()},e.handleOverlayMode$=function(){var t=o((function*(t){return!!e.leadersPayload$&&new Promise((function(n){t.call((function(){e.updateOverlay$().then((function(t){e.isOverlayMode$=t,n(t)}))}))}))}));return function(e){return t.apply(this,arguments)}}(),e.updateOverlay$=o((function*(){var t;if(!e.leadersPayload$||!e.tournamentDetailOverlay$)return!1;var n=null!==(t=e.leadersPayload$.leaders)&&void 0!==t?t:[];n.sort((function(e,t){return e.rank-t.rank}));var i=n.map((function(e){return{playerId:e.playerId,rank:e.rank,score:e.score}})),a=yield e.tournamentDetailOverlay$.updateOverlay({tournamentPlayers:i,leaderboardPosition:e.getLeaderboardPosition$(),topPlayerPosition:e.getTopPlayerPosition$(),currentPlayerId:Rpe.getPlayerId()});return null!=a&&a})),e.updateContainer$=o((function*(){var t=e.tempContainer.height;e.container.node.position=e.tempContainer.node.position.clone(),t<Npe&&e.container.height!==t?(e.container.height=t,Re.instance.emit("canvas-resize")):t>Npe&&e.container.height<Npe&&(e.container.height=Npe,Re.instance.emit("canvas-resize"))})),e.updateTitleWithPlayerName$=function(t){void 0!==t&&(e.titleLocalizer.enabled=!0,e.titleLocalizer.setParams([t]))},e.updateTitleTournamentTitle$=function(t){e.titleLocalizer.enabled=!1,e.title.string=t},e.updateEndTime$=function(t){try{var n=Tpe.getRelativeTime(t,Dpe.getCurrentLocale(),{style:"short"});e.timeLocalizer.key="game.endsIn",e.timeLocalizer.setParams([n])}catch(t){e.timeLocalizer.key="game.endsSoon"}},e.updateTournamentBanner$=function(){var t=o((function*(t,n){e.banner.spriteFrame=null;var i=r.getAsset("".concat(Y[t],"/spriteFrame"),xe);i||(e.bannerMask.active=!0,e.bannerLoadingRing.active=!0,i=yield r.loadThemeTournamentAsync(t)),i||(i=yield r.loadThemeTournamentAsync($.SUMMER)),e.banner&&i&&!n.aborted&&(e.banner.spriteFrame=i,e.bannerMask.active=!1,e.bannerLoadingRing.active=!1)}));return function(e,n){return t.apply(this,arguments)}}(),e.setPlayerCountWaiting$=function(){e.playerCountLocalizer.key="status.loading"},e.updateButtonVisibility$=function(){var t,n;if(e.playButton.active=!1,e.continueButton.active=!1,e.replayButton.active=!1,e.logInButton.active=!1,GameSDK.extra.isGuest)e.logInButton.active=!0;else{var i=(null!==(t=null===(n=e.payload$)||void 0===n?void 0:n.screenData)&&void 0!==t?t:{}).tournamentContextType;switch(void 0===i?"tournament_start":i){case"tournament_end":var a,o,r=(null!==(a=null===(o=Rpe.getGameData())||void 0===o?void 0:o.tournamentProgress[e.tournamentPayload$.id])&&void 0!==a?a:{}).replayCount,l=void 0===r?0:r;e.continueButton.active=l>1,e.replayButton.active=!0,e.buttonsLayout.updateLayout(!0);break;case"tournament_start":e.playButton.active=!0}}},e.getLeadersPayload$=function(){var e=o((function*(e){var t=_pe.getLeaderboardName(e);if(!t)return null;var n=yield tN.getAllLeaderboardAsync(e);if(!n)return null;var i,a=Ape.vals(n.leaders),o=Rpe.getPlayerId(),r={leaders:[],amountPlayer:n.amountPlayer},l=c(a);try{for(l.s();!(i=l.n()).done;){var s=i.value;s.playerId===o?(r.player=s,r.leaders.push(s)):r.leaders.push(s)}}catch(e){l.e(e)}finally{l.f()}if(!r.player){var u=(yield _pe.getLeadersByPlayerIdsAsync(t,[o]))[0];u&&(r.player=u,r.leaders.push(u))}return r}));return function(t){return e.apply(this,arguments)}}(),e.processPlayTournament$=function(){var t=o((function*(t){var n=e.tournamentPayload$.id||"",i=U.validateTournamentExpired(n);if(U.syncTournamentProgress(),i)return e.close(),e.node.scene.emit(sv.RELOAD_TOURNAMENT),void x.showNotificationScreenWithLocalizedKey("error.tourEnded",2);var a=t.level,o=t.score,r=t.replay;try{x.showLoadingScreen(),yield Iv.setMatchCustomDataAsync({level:a,score:o}),yield e.processJoinTournament$(a),r&&e.increaseTournamentReplayCount$()}catch(t){if(Ape.hasOwn(t,"code")&&"USER_INPUT"===t.code)return;try{yield e.processContinueTournament$(a),r&&e.increaseTournamentReplayCount$()}catch(e){if(Ape.hasOwn(e,"code")&&"USER_INPUT"===e.code)return;console.error("processPlayButtonPressed",e),x.showNotificationScreenWithLocalizedKey("error.tourJoinFail",2)}}finally{x.closeLoadingScreen()}}));return function(e){return t.apply(this,arguments)}}(),e.processJoinTournament$=o((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{var n=e.tournamentPayload$.id||"";yield Iv.joinTournamentAsync(n),G.switchToGameScene({level:t})}catch(e){throw console.warn("processJoinTournament",e),e}})),e.processContinueTournament$=o((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{var t,n=null!==(t=GameSDK.context.getID())&&void 0!==t?t:"";yield Iv.continueTournamentAsync(n),G.switchToGameScene({level:e})}catch(e){throw console.warn("processContinueTournament",e),e}})),e.increaseTournamentReplayCount$=function(){var e,t,n=(null!==(e=Iv.getMatchCustomData())&&void 0!==e?e:{}).tournamentId;if(n){var i=Rpe.getGameData();if(i){var a=i.tournamentProgress,o=(null!==(t=a[n])&&void 0!==t?t:{}).replayCount,r=void 0===o?0:o;Rpe.setGameData({tournamentProgress:E({},n,u(u({level:1,score:0},a[n]),{},{replayCount:r+1}))})}}},e.setInteractableButtons$=function(t){e.screen.backgroundMaskButton.interactable=t},e.createTournamentOverlay$=function(){try{SM.isOverlayViewAPIAvailable(GameSDK),e.isOverlayMode$=!0,e.tournamentDetailOverlay$=new Zde(e.node.scene)}catch(e){return}},e.getLeaderboardPosition$=function(){var t=e.tournamentLeaders.getComponent(ne);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.tournamentLeaders.node;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.getTopPlayerPosition$=function(){var t=e.topPlayerOverlayRef.getComponent(ne);if(!t)return{worldX:0,worldY:0,width:0,height:0};var n=t.width,i=t.height,a=e.topPlayerOverlayRef;return{worldX:a.worldPositionX,worldY:a.worldPositionY,width:n,height:i}},e.updateOverlayScreenStatus$=function(t){var n;null===(n=e.tournamentDetailOverlay$)||void 0===n||n.setIsScreenActive(t)},e}return e(k,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(Iee),Yn.validateRequiredProperties(this,k),this.listenScreenEvents$(),this.createTournamentOverlay$()}},{key:"onDestroy",value:function(){this.signal$.abort(),this.unListenScreenEvents$(),this.cleanupOverlay$()}},{key:"open",value:function(){this.updateContainer$(),this.updateInfo(),this.updateOverlayScreenStatus$(!0),this.setInteractableButtons$(!0),this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders(),this.updateButtonVisibility$(),this.setPlayerCountWaiting$(),this.node.scene.emit(Js.HIDE_UI)}},{key:"close",value:function(){x.closeTournamentDetailScreen(),this.setInteractableButtons$(!1),this.tournamentLeaders.scrollView.unlistenEvents(),this.updateOverlayScreenStatus$(!1),this.node.scene.emit(Js.SHOW_UI),this.cleanup$()}},{key:"updateInfo",value:(b=o((function*(){var e,t,n,i,a,o,r=this,l=this.signal$,s=null===(e=this.payload$)||void 0===e||null===(e=e.screenData)||void 0===e?void 0:e.tournament;if(s){var u=null===(t=null===(n=this.payload$.screenData)||void 0===n?void 0:n.playAnimation)||void 0===t||t,c=JSON.parse(s);c.id=c.id.toString(),this.tournamentPayload$=c;var d=this.tournamentPayload$,h=d.endTime,p=d.payload,y=d.title,v=d.tournamentType,f=p.leaderboardId,g=void 0===f?"":f,m=p.themeId,b=void 0===m?$.AUTUMN:m,w=p.playerName;"PAGE_HOSTED"===v?this.updateTitleTournamentTitle$(y):this.updateTitleWithPlayerName$(null!=w?w:y),this.updateEndTime$(h),this.updateTournamentBanner$(b,l);var S=Ipe.getStorage("tournament"),k=S.previousScore,C=S.animateTournamentLeader;if(Ipe.setStorageData("tournament","animateTournamentLeader",!1),yield this.showLoading(l),yield this.loadLeaders(g),!this.leadersPayload$||0===this.leadersPayload$.leaders.length||l.aborted)return this.updatePlayerCount(0),void(yield this.hideLoading(l));var E=this.leadersPayload$,A=E.player,T=E.amountPlayer,P=null!==(i=this.leadersPayload$.leaders)&&void 0!==i?i:[];if(P.sort((function(e,t){return e.rank-t.rank})),yield this.hideLoading(l),this.isOverlayMode$&&(yield this.handleOverlayMode$(l)))return;if(this.topLeaders&&this.tournamentLeaders&&!l.aborted){this.updatePlayerCount(T),this.topLeaders.updateData(P),this.topLeaders.playShowLeadersAnimation(l);var L=null!==(a=null==A?void 0:A.score)&&void 0!==a?a:0,O=null!==(o=null==A?void 0:A.rank)&&void 0!==o?o:0,I=C&&-1!==k&&k<L;this.tournamentLeaders.updateData(P);var R=!1;A&&I&&(R=this.tournamentLeaders.updateDisplayPlayerLeaderForRankChanging(k,L,O)),this.tournamentLeaders.initScrollViews(),this.tournamentLeaders.scrollView.scrollView.enabled=!0,yield l.callAsync((function(e){return r.runShowUpAnimation(e,u)})),C&&R&&-1!==k&&this.tournamentLeaders&&(yield l.callAsync((function(e){return r.tournamentLeaders.playRankChangeAnimation(e,k,L,O)})),this.tryPlayConfettiEffect(O))}}})),function(){return b.apply(this,arguments)})},{key:"loadLeaders",value:(m=o((function*(e){this.leadersPayload$=yield this.getLeadersPayload$(e)})),function(e){return m.apply(this,arguments)})},{key:"showLoading",value:(g=o((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isOverlayMode$?this.cleanupOverlay$():yield Promise.all([this.tournamentLeaders.scrollView.unlistenEvents(),this.tournamentLeaders.scrollView.scrollToTop(e,.1).then((function(){t.tournamentLeaders.scrollView.scrollView.enabled=!1,t.tournamentLeaders.scrollView.listenEvents()})),this.leaderSkeletons.map((function(t,i){return t.show(i*n,e)}))])})),function(e){return g.apply(this,arguments)})},{key:"hideLoading",value:(f=o((function*(e){this.isOverlayMode$||(yield Promise.all(this.leaderSkeletons.map((function(t){return t.hide(e)}))))})),function(e){return f.apply(this,arguments)})},{key:"runShowUpAnimation",value:(v=o((function*(e){var t,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=i?0:.1;yield null===(t=this.tournamentLeaders)||void 0===t?void 0:t.playShowLeadersAnimation(e,a),yield null===(n=this.tournamentLeaders)||void 0===n?void 0:n.scrollToPlayerLeader(1.5,e)})),function(e){return v.apply(this,arguments)})},{key:"tryPlayConfettiEffect",value:function(e){if(!(e>10)){var t=P.isLandscape(),n=t?50:30,i=t?5e3:2e3,a=t?15e3:1e4,o=t?40:60,r=t?110:100,l=t?30:20;this.leftConfetti.bursts[0].count=this.rightConfetti.bursts[0].count=n,this.leftConfetti.startSpeed.constantMin=this.rightConfetti.startSpeed.constantMin=i,this.leftConfetti.startSpeed.constantMax=this.rightConfetti.startSpeed.constantMax=a,this.leftConfetti.shapeModule.angle=o,this.rightConfetti.shapeModule.angle=r,this.leftConfetti.shapeModule.arc=this.rightConfetti.shapeModule.arc=l,this.leftConfetti.play(),this.rightConfetti.play(),w.playSound(Qi.LEADERBOARD_TRIUMPH)}}},{key:"updatePlayerCount",value:function(e){var t=Ppe.getShortNumber(e,3);1===e?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([t]))}},{key:"handleOnLogIn",value:(y=o((function*(){try{if(!("initPlayerAsync"in GameSDK.player))return;if(x.showLoadingScreen(),yield GameSDK.player.initPlayerAsync(),x.closeLoadingScreen(),GameSDK.extra.isGuest)return void x.showNotificationScreenWithLocalizedKey("error.login",1)}catch(e){x.closeLoadingScreen(),x.showNotificationScreenWithLocalizedKey("error.login",1)}})),function(){return y.apply(this,arguments)})},{key:"handleOnPlay",value:(p=o((function*(){GameSDK.isGameSDK("Yandex")&&(yield C.showInterstitialAdAsync()),yield this.processPlayTournament$({level:1,score:0,replay:!1})})),function(){return p.apply(this,arguments)})},{key:"handleOnReplay",value:(h=o((function*(){GameSDK.isGameSDK("Yandex")&&(yield C.showInterstitialAdAsync()),yield this.processPlayTournament$({level:1,score:0,replay:!0})})),function(){return h.apply(this,arguments)})},{key:"handleOnContinue",value:(d=o((function*(){var e,t;if(yield C.showRewardVideoAdAsync()){var n=null!==(e=null===(t=Rpe.getGameData())||void 0===t?void 0:t.tournamentProgress[this.tournamentPayload$.id])&&void 0!==e?e:{},i=n.level,a=void 0===i?1:i,o=n.score,r=void 0===o?0:o,l=a>1?Math.floor(a/2):1,s=Math.floor(r/2);yield this.processPlayTournament$({level:l,score:s,replay:!1})}})),function(){return d.apply(this,arguments)})}]),k}(te)).prototype,"screen",[the],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yhe=a(Khe.prototype,"title",[nhe,ihe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xhe=a(Khe.prototype,"titleLocalizer",[ahe,ohe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jhe=a(Khe.prototype,"timeLocalizer",[rhe,lhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zhe=a(Khe.prototype,"playerCountLocalizer",[she,uhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qhe=a(Khe.prototype,"tournamentLeaders",[che,dhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),epe=a(Khe.prototype,"topLeaders",[hhe,phe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tpe=a(Khe.prototype,"playButton",[yhe,vhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),npe=a(Khe.prototype,"continueButton",[fhe,ghe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ipe=a(Khe.prototype,"replayButton",[mhe,bhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ape=a(Khe.prototype,"logInButton",[whe,She],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ope=a(Khe.prototype,"buttonsLayout",[khe,Che],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rpe=a(Khe.prototype,"banner",[Ehe,Ahe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lpe=a(Khe.prototype,"bannerLoadingRing",[The,Phe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),spe=a(Khe.prototype,"bannerMask",[Lhe,Ohe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),upe=a(Khe.prototype,"leaderSkeletons",[Ihe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),cpe=a(Khe.prototype,"leftConfetti",[Rhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dpe=a(Khe.prototype,"rightConfetti",[_he],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hpe=a(Khe.prototype,"container",[Dhe,Nhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ppe=a(Khe.prototype,"tempContainer",[Mhe,Fhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ype=a(Khe.prototype,"topPlayerOverlayRef",[Bhe,xhe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a(Khe.prototype,"updateInfo",[zhe],Object.getOwnPropertyDescriptor(Khe.prototype,"updateInfo"),Khe.prototype),a(Khe.prototype,"loadLeaders",[Uhe],Object.getOwnPropertyDescriptor(Khe.prototype,"loadLeaders"),Khe.prototype),a(Khe.prototype,"showLoading",[Ghe],Object.getOwnPropertyDescriptor(Khe.prototype,"showLoading"),Khe.prototype),a(Khe.prototype,"hideLoading",[Hhe],Object.getOwnPropertyDescriptor(Khe.prototype,"hideLoading"),Khe.prototype),a(Khe.prototype,"runShowUpAnimation",[qhe],Object.getOwnPropertyDescriptor(Khe.prototype,"runShowUpAnimation"),Khe.prototype),a(Khe.prototype,"tryPlayConfettiEffect",[Vhe],Object.getOwnPropertyDescriptor(Khe.prototype,"tryPlayConfettiEffect"),Khe.prototype),a(Khe.prototype,"updatePlayerCount",[$he],Object.getOwnPropertyDescriptor(Khe.prototype,"updatePlayerCount"),Khe.prototype),Whe=Khe))||Whe);X._RF.pop(),X._RF.push({},"36d58kn8v5POaqgX4C8S3ct","TournamentLeader",void 0);(0,Z.ccclass)("TournamentLeader")(mpe=function(a){n(r,a);var o=i(r);function r(){return t(this,r),o.apply(this,arguments)}return e(r)}(N2));X._RF.pop(),X._RF.push({},"88f2b4WH6NBlaGD7WvCOA2j","VibrateUtils",void 0);Ludex.Utils.Browser,codex.player;X._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map