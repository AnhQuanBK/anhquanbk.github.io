(function(){var e=[,,,function(e,t,n){"use strict";var i=n(5),r=n(4),a=n.n(r),s=n(12),o=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,s.TS)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},t.waitForCompletion=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==(t=this.tween)?void 0:t.waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}();t.Z=o},,,function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_CONTINUE:"level_continue",LEVEL_END:"level_end",LEVEL_GIVE_UP:"level_give_up",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",MISSING_AD_SHOW:"missing_ad_show",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",THEME_CHANGED:"theme_changed",LUCKY_REWARD:"luck_reward",FOLLOW_PAGE:"follow_page",FOLLOW_PAGE_FAILED:"follow_page_failed",GROUP_JOIN:"group_join",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",TOURNAMENT_START:"tournament_start",TOURNAMENT_END:"tournament_end",TOURNAMENT_REFUSE:"tournament_refuse",TOURNAMENT_REJOIN:"tournament_rejoin",TOURNAMENT_JOIN:"tournament_join",DUEL_START:"duel_start",DUEL_END:"duel_end",DUEL_GET_REWARD:"duel_get_reward",RACE_START:"race_start",RACE_END:"race_end",LOAD_ASSET_START:"load_assets_start",LOAD_ASSET_COMPLETED:"load_assets_completed",DECORATION_UPGRADED:"decoration_upgraded",PAGE_VIEW:"page_view",ECONOMY_TRANSACTION:"economy_transaction",ECONOMY_TRACKING:"economy_tracking",VIEW_ITEM_LIST:"view_item_list",SELECT_ITEM:"select_item",VIEW_ITEM:"view_item",BEGIN_CHECKOUT:"begin_checkout",PURCHASE:"purchase",PURCHASE_CANCEL:"purchase_cancel"}},function(e,t,n){"use strict";var i=n(8),r=GameCore.ImageScale,a={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+r+"x/tutorial-resources.png",JSON:"./assets/textures/"+r+"x/tutorial-resources.json",FRAME:{TIP:"tip",HAND:"hand",BLANK:"blank",AVATAR_CAT:"avatar-cat",POPUP_TALK:"talk-popup",FIRST_MOVE:"first-move",CURRENT_SCORE:"current-score",TARGET_SCORE:"target-score",HAMMER_ITEM:"hammer-item",PAINT_ITEM:"paint-item",SHUFFLE_ITEM:"shuffle-item",COLORFUL_GEM_1:"colorful-gem-1",COLORFUL_GEM_2:"colorful-gem-2"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+r+"x/default-resources.png",TEXTURE_32BIT:"./assets/textures/"+r+"x/default-resources-32bit.png",JSON:"./assets/textures/"+r+"x/default-resources.json",FRAME:{BLANK:"blank",BUTTON:{GREEN_40:"",GREEN_50:"",GREEN_60:"",BLUE_40:"",BLUE_50:"",RED_40:""},COMMON:{BTN_CLOSE:"common/new_btn_close",POPUP_BASE:"common/pop-up-base",NEW_POPUP_BASE:"common/new-pop-up-base",POPUP_CONTENT_FULL:"common/pop-up-content-full",TITLE_DECOR:"common/title-decor",IC_BIG_COIN:"",LUCKY_BAR:"",LUCKY_ARROW:""},DAILY_REWARDS:{COIN_1:"daily-rewards/coin-1",COIN_2:"daily-rewards/coin-2",COIN_3:"daily-rewards/coin-3"},EFFECTS:{BONUS_LIGHT:"effects/bonus-light",BONUS_STAR:"effects/bonus-star",GLOW_2:"effects/glow-2",LIGHT_X:"effects/light-x",STAR_1:"effects/star-1",STAR_2:"effects/star-2",SPARK:"effects/spark",LEVEL_COMPLETE:{RAY:"effects/level-complete/ray",GLOW_1:"effects/level-complete/glow-1",GLOW_2:"effects/level-complete/glow-2",STAR:"effects/level-complete/star"}},EXIT_GAME_SCREEN:{POP_UP_BASE:"exit-game-screen/pop-up-base",BUTTON_CLOSE:"exit-game-screen/\u0445",ICON_GLOVE:"exit-game-screen/icon-glove",ICON_CUP:"exit-game-screen/icon-cup",ICON_BOAT:"exit-game-screen/icon-boat"},NEXT_JOURNEY_SCREEN:{GLOW:"next-journey-screen/glow",PHOTOS:"next-journey-screen/photo",SPARKLE:"next-journey-screen/sparkle",TEXT:"next-journey-screen/text"},GET_MORE_COIN_SCREEN:{ICON_GIFT_AD:"get_more_coin_screen/gift-ad",ILLUSTRATION:"get_more_coin_screen/illustration",NEW_ICON_AD:"get_more_coin_screen/new_ic_ad"},ICONS:{BONUS:"icons/button-bonus",COIN:"icons/coin",STAR:"icons/star"},PLAY_SCREEN:{BOOSTER:{COIN:"play-screen/booster/coin",GOLD_WILD:"play-screen/booster/gold_wild",THREE_SLICE:"play-screen/booster/three-slice",WIND:"play-screen/booster/wind",ICON_PLATE_IN:"play-screen/booster/icon_plate_in"},POPUP_BASE:"play-screen/pop-up-base",NORMAL:{POPUP_BASE:"play-screen/normal/pop-up-base",TITLE_DECOR:"play-screen/normal/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/normal/icon_plate_out",ICON_PLATE_LOCK:"play-screen/normal/icon_plate_lock",LEVEL_PANEL:"play-screen/normal/level-panel"},CLOSE:"play-screen/normal/x",REWARD_CHEST_BG:"play-screen/normal/reward_chest_bg"},HARD:{POPUP_BASE:"play-screen/hard/pop-up-base",TITLE_DECOR:"play-screen/hard/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/hard/icon_plate_out",ICON_PLATE_LOCK:"play-screen/hard/icon_plate_lock",LEVEL_PANEL:"play-screen/hard/level-panel"},CLOSE:"play-screen/hard/x",REWARD_CHEST_BG:"play-screen/hard/reward_chest_bg"},SUPER_HARD:{POPUP_BASE:"play-screen/super-hard/pop-up-base",TITLE_DECOR:"play-screen/super-hard/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/super-hard/icon_plate_out",ICON_PLATE_LOCK:"play-screen/super-hard/icon_plate_lock",LEVEL_PANEL:"play-screen/super-hard/level-panel"},CLOSE:"play-screen/super-hard/x",REWARD_CHEST_BG:"play-screen/super-hard/reward_chest_bg"},ICON_ADD:"play-screen/add",ICON_CHECK_MARK:"play-screen/check-mark",ICON_RED:"play-screen/red",ICON_ORANGE:"play-screen/orange",EFFECTS:{STAR:"play-screen/star",GLOW:"play-screen/glow_2",NEW_REWARD_CHEST:"play-screen/new_reward_chest",NEW_REWARD_CHEST_ADD_1:"play-screen/new_reward_chest_add",NEW_REWARD_CHEST_ADD_2:"play-screen/new_reward_chest_add_2",NEW_TOP_CASE_ADD_1:"play-screen/new_top_case_add_1",NEW_TOP_CASE_ADD_2:"play-screen/new_top_case_add_2",NEW_TOP_CASE_ADD_3:"play-screen/new_top_case_add_3",NEW_TOP_CASE_ADD_4:"play-screen/new_top_case_add_4"}},POPUP_CONTENT:"popup/popup_content",PRELOADER:{LOADING:"preloader/loading",DUAL_RING:"preloader/dual-ring"},REWARDS:{COIN:"rewards/coin",UNDO:"rewards/undo",WILD_CARD:"rewards/wild-card",STORM:"rewards/storm",SLICE:"rewards/slice",PLUS_5_CARDS:"rewards/plus-5-cards",HALF_LEFT:"rewards/half-left",HALF_TOP:"rewards/half-top",HALF_BOTTOM:"rewards/half-bottom"},SETTINGS:{BUTTON:{CHECK:"settings-screen/check-frame"},ICON:{CHECK:"settings-screen/check",FANPAGE:"settings-screen/icon-fanpage",INVITE:"settings-screen/icon-invite",JOIN_GROUP:"settings-screen/icon-joingroup"},MUSIC_ON:"settings-screen/music-on",MUSIC_OFF:"settings-screen/music-off",SOUND_ON:"settings-screen/sound-on",SOUND_OFF:"settings-screen/sound-off",VIBRATE_ON:"settings-screen/vibrate-on",VIBRATE_OFF:"settings-screen/vibrate-off",POPUP_BASE_DESKTOP:"settings-screen/pop-up-base-desktop",POPUP_BASE_MOBILE:"settings-screen/pop-up-base-mobile",GAMEPLAY:{BACKGROUND:"settings-screen/gameplay-settings/background",MUSIC_ON:"settings-screen/gameplay-settings/music-on",MUSIC_OFF:"settings-screen/gameplay-settings/music-off",SOUND_ON:"settings-screen/gameplay-settings/sound-on",SOUND_OFF:"settings-screen/gameplay-settings/sound-off",VIBRATE_ON:"settings-screen/gameplay-settings/vibrate-on",VIBRATE_OFF:"settings-screen/gameplay-settings/vibrate-off",QUIT:"settings-screen/gameplay-settings/quit",SETTINGS_BUTTON:"settings-screen/gameplay-settings/settings",SETTINGS_ICON:"settings-screen/gameplay-settings/settings-icon",BLUE:"settings-screen/gameplay-settings/blue"}},GET_MORE_STARS:{ARROW_ICON:"get-more-stars-screen/arrow-icon",LEVEL_ICON:"get-more-stars-screen/level-icon",STARS_ICON:"get-more-stars-screen/stars-icon"},MISSION:{CLAIM_BUTTON:"",PROGRESS_BAR_BG:"",PROGRESS:"",TASK_PANEL:"",BG_ITEM:"",IC_INVITE_FRIEND:"",IC_PASS_LEVEL:"",IC_CLEAR_CARD:"",IC_USE_WILD_CARD:""},POPUP_TOP_LEFT:"",POPUP_TOP_MID:"",POPUP_TOP_RIGHT:"",POPUP_MID_LEFT:"",POPUP_MID_MID:"",POPUP_MID_RIGHT:"",POPUP_BOTTOM_LEFT:"",POPUP_BOTTOM_MID:"",POPUP_BOTTOM_RIGHT:"",SAD_CAT:"",THE_CAT:"",ICON_DIAMOND:"",BUTTON_BLUE:"",ICON_DAILY:"",ICON_DOT:"",ICON_GIFT:"",ICON_RANK:"",ICON_SETTING:"",BOTTOM_BG:"",BOTTOM_LINE:"",TOP_BG_LONG:"",ICON_PLUS:"",LOGO:"",GEMS:"",BUTTON_BLUE_SHORT:"",BUTTON_GREEN_LONG:"",NINE_SLICE:{POPUP_SHADOW:"",POPUP_BG:"",POPUP_CONTENT:""},ICON_CHECK:"",ICON_REWARD_1:"",ICON_REWARD_2:"",ICON_REWARD_3:"",ICON_REWARD_4:"",ICON_REWARD_5:"",ICON_REWARD_6:"",ICON_REWARD_7:"",DAILY_DAY_BG:"",DAILY_DAY_TITLE_GREY:"",DAILY_BLOCK_BG:"",DAILY_PURPLE_HEADER:"",DAILY_GREEN_HEADER:"",DAILY_ORANGE_HEADER:"",DAILY_RED_HEADER:"",PURPLE_LOCK:"",LOCK:"",AVATAR_FRAME_BLUE:"",AVATAR_BG_BLUE:"",AVATAR_BG_YELLOW:"",AVATAR_FRAME_YELLOW:"",BLOCK_LEADER_YELLOW:"",BLOCK_LEADER_BLUE:"",ICON_FLAG:"",ICON_CUP_GOLD:"",ICON_CUP_SILVER:"",ICON_CUP_BRONZE:"",BUTTON_YELLOW_CIRCLE:"",ICON_FLAT_HOME:"",BUTTON_GREEN_SHORT:"",ICON_FLAT_RANK:"",RIBBON_LONG:"",RIBBON_SMALL:"",BUTTON_CLOSE:"",AVATAR_FRAME_YELLOW_BIG:"",AVATAR_BG_YELLOW_BIG:"",ICON_FLAT_SHARE:"",THREE_SLICE:{HEADER:""},SWITCH_ON:"",SWITCH_OFF:"",TOGGLE_ON_BAR:"",TOGGLE_OFF_BAR:"",LEADERBOARD_BG_DARK:"",LEADERBOARD_BG_LIGHT:"",AVATAR_FRAME_YELLOW_SMALL:"",AVATAR_BG_YELLOW_SMALL:"",ICON_CUP_MINI:"",BUTTON_GREEN_MINOR_MINI:"",BUTTON_GREEN:"",RIBBON_SHORT:"",LEADERBOARD_TAB_ON:"",LEADERBOARD_TAB_OFF:"",AVATAR_FRAME_BLUE_BIG:"",AVATAR_BG_BLUE_BIG:"",ICON_CROWN:"",RIBBON_FULL:"",ICON_RESUME:"",ICON_ADS:"",LOGO_GIFT_ADS:"",BUTTON_BLUE_LONG:"",NO_THANK_TEXT:"",LOGO_GIFT_WHITE:"",LOGO_GIFT:"",ARC_LUCKY_BAR:"",ARC_ARROW:"",HORIZONTAL_LUCKY_BAR:"",HORIZONTAL_ARROW:"",ICON_CUP_COPPER:""}},GAMEPLAY_DEFAULT:{KEY:"gameplay-default",TEXTURE:"./assets/textures/"+r+"x/gameplay-default.png",TEXTURE_32BIT:"./assets/textures/"+r+"x/gameplay-default-32bit.png",JSON:"./assets/textures/"+r+"x/gameplay-default.json",FRAME:{BLANK:"blank",STATS_CROWN:"crown",STATS_STAR:"star",STATS_CUP:"stats_cup",STATS_MEDAL_START:"stats_medal_star",STATS_TIMER:"stats_timer",ARROW:"guide/arrow",ARROW_GREEN:"guide/green_arrow",PARTICLE_LIGHT:"effects/light",PARTICLE_STAR:"effects/star",IC_VIDEO:"icons/video",IC_COIN:"icons/coin-small",IC_PLUS:"icons/ic-plus",IC_INFO:"icons/icon-info",IC_HEART:"icons/ico-heart",IC_CUP:"icons/cup",AVATAR_BORDER:"icons/avatar_border",TUTORIAL:{ARROW_UP:"tutorial/arrow-up",ARROW_DOWN:"tutorial/arrow-down",ARROW_SIDE:"tutorial/arrow-side",TRIPLE_ARROW:"tutorial/triple-arrow",HAND:"tutorial/hand",HIGHLIGHT_CIRCLE:"tutorial/highlight_circle",TEXT_BOX:"tutorial/text_box_guide",BLACK_BG:"tutorial/black_bg"},THREE_SLICES:{COIN_PANEL_BLUE:"three-slices/coin_bar_panel",BAR_LEVEL:"three-slices/bar-level",COIN_PANEL_GRAY:"three-slices/coin-bar"},MENU_STATISTIC:"menu_statistics",CUP:"cup",IC_PLAY:"ic_play",IC_HINT:"ic_hint",IC_UNDO:"ic_undo",IC_SHARE:"ic_share",IC_THEME:"ic_theme",IC_INVITE:"ic_invite",IC_SOUND:"ic_sound",IC_CLOSE:"ic_close_gray",IC_MOVE:"ic_move",IC_STATISTICS:"ic_statistics",IC_NEXT:"ic_next",IC_BOOK:"ic_book",IC_RESTART:"ic_restart",IC_REPLAY:"ic_replay",ADD_SQUARE:"add-square",TIMER:"timer",GOLD:"gold",SILVER:"silver",BRONZE:"bronze",CUSTOM_MEDAL:"custom_medal",TOURNAMENT_TIMER:"tournament_timer",MEDAL_STAR:"medal-star",NO_TOURNAMENT:"no-tournament",IC_BG_OFF:"ic_bg_off",ARROW_SWAP_HORIZONTAL:"arrow-swap-horizontal",AVATAR_CROWN:"avatar_crown",WIN_BANNER:"win_banner",LOSE_BANNER:"lose_banner",BEAM:{AXIS:"beam_axis",LOSE_AXIS:"lose_beam_axis"},FLAG:{LEFT:"flags/left/",RIGHT:"flags/right/"},STRING:{LEFT:"string/left",RIGHT:"string/right"},LIGHTNING:{LEFT:"lightning/left_lightning",MIDDLE:"lightning/middle_lightning",RIGHT:"lightning/right_lightning"},STAR_BAR:{BAR_FILL:"bar-star/bar_fill_0",BAR_FRAME:"bar-star/bar_frame_0",STAR:"bar-star/star_bar_icon",STAR_EMPTY:"bar-star/star_bar_icon_empty"},ARROW_UP:"arrow"}},GAMEPLAY_OBJECTS:{KEY:"gameplay-objects",TEXTURE:"./assets/textures/"+r+"x/gameplay-objects.png",TEXTURE_32BIT:"./assets/textures/"+r+"x/gameplay-objects-32bit.png",JSON:"./assets/textures/"+r+"x/gameplay-objects.json",FRAME:{BLANK:"blank",STATS_CROWN:"crown",STATS_STAR:"star",STATS_CUP:"stats_cup",STATS_MEDAL_START:"stats_medal_star",STATS_TIMER:"stats_timer",BOMB:"bomb/bomb",LINE:"bomb/line",SKULL:"bomb/skull",GLOW_BLACK:"bomb/glow-black",GLOW_RED:"bomb/glow-red",GLOW_RED_FRONT:"bomb/glow-red-front",SPARK_VFX:"bomb/spark_vfx",BTN_PLUS_FIVE_CARDS:"buttons/plus-five-cards",BTN_PLUS_THREE_CARDS:"buttons/plus-three-cards",BTN_SETTINGS:"buttons/btn_settings",BTN_PLUS_COIN:"buttons/button_plus_coin",BTN_END_GAME:"buttons/btn_end_game",BTN_IC_UNDO:"buttons/btn_undo",CARD_BACK:"card/back_backside",GOLD_CARD_BACK:"card/card_back_gold",CARD_BACK_2:"card/back_card_mode_2",CARD_BACK_3:"card/back_card_mode_3",CARD_BACK_4:"card/back_card_mode_4",CHEESE_CARD:"card/cheese-card",MOUSE_CARD:"card/mouse",PLUS_CARD:"card/plus",SQUIRREL_CARD:"card/squirrel",WILD_CARD:"card/wild",MYSTERIOUS_CARD:"card/mysterious",SQUIRREL_BASKET:"card/squirrel-basket",STORM_CARD:"card/card-storm",SLICE_CARD:"card/card-slice",STORM_CARD_BACK:"card/card-storm-back",WILD_CARD_BACK:"card/wild-card-back",BLANK_CARD:"card/card_blank",INCREASE_CARD:"card/arrow-up",BASKET:"squirrel/basket-empty",BASKET_TOP:"squirrel/basket-front",BASKET_ONE_ACORN:"squirrel/basket-1-acorn",BASKET_TWO_ACORN:"squirrel/basket-2-acorns",BASKET_THREE_ACORN:"squirrel/basket-3-acorns",BASKET_FOUR_ACORN:"squirrel/basket-4-acorns",CHESTNUT:"squirrel/acorn",STREAK:{POINT_BLACK:"streak/black",COIN:"streak/coin",POINT_NONE:"streak/color_background",ITEM_BG:"streak/item_background",CARD:"streak/plus_one",POINT_RED:"streak/red",STREAK_FRAME:"streak/streak_frame_",TREASURE:"streak/treasure",WILDCARD:"streak/wild",BAR:"streak/bar"},ROPE:"rope",KNOB:"node",RED_KNOB:"node-red",MAP_PIECE:"map/map-piece",MAP_FILLED_PIECES:"map/map-filled-pieces",MAP_PIECE_NUMBER:"map/tiles/piece",CLOUD_:"cloud-balloon/cloud-",BALLOON:"cloud-balloon/balloon",BALLOON_CLUB:"cloud-balloon/club",BALLOON_DIAMOND:"cloud-balloon/diamond",BALLOON_HEART:"cloud-balloon/heart",BALLOON_SPADE:"cloud-balloon/spade",BALLOON_BLACK:"cloud-balloon/black",BALLOON_BLACK_:"cloud-balloon/black-",BALLOON_RED:"cloud-balloon/red",BALLOON_RED_:"cloud-balloon/red-",BALLOON_NUMBER_:"cloud-balloon/",BLUE_GLOVE:"event-items/blue-glove",CUP:"event-items/cup"}},CARD_BACK:{KEY:"card-back",TEXTURE:"./assets/textures/"+r+"x/card-back.png",JSON:"./assets/textures/"+r+"x/card-back.json"},HOW_TO_PLAY:{KEY:"how-to-play",TEXTURE:"./assets/textures/"+r+"x/how-to-play.jpg",JSON:"./assets/textures/"+r+"x/how-to-play.json"},THEME_PREVIEW:{KEY:"theme-preview",TEXTURE:"./assets/textures/"+r+"x/theme-preview.png",JSON:"./assets/textures/"+r+"x/theme-preview.json"},LOCATION_PREVIEWS:{KEY:"location-previews",TEXTURE:"./assets/textures/"+r+"x/location-previews.png",JSON:"./assets/textures/"+r+"x/location-previews.json"},JOURNEY:{KEY:"journey-resources",TEXTURE:"./assets/textures/"+r+"x/journey-resources.png",TEXTURE_32BIT:"./assets/textures/"+r+"x/journey-resources-32bit.png",JSON:"./assets/textures/"+r+"x/journey-resources.json",FRAME:{BLANK:"blank",BACKGROUND:"bg",TEXT_JOURNEY:"title-journey",CLOSE_BUTTON:"x",MAP_BLOCK:{BACKGROUND:"card",BACKGROUND_SHADOW:"shadow",THUMBNAIL_BACKGROUND:"illustrtation",THUMBNAIL:"frame",PLACE_HOLDER:"place_holder",THUMBNAIL_FOREGROUND:"lock_overlay",LOCKED_THUMBNAIL:"locked",LOCK_CARD:"lock_card",JOURNEY_FRAME:"journey_frame",LOCKED_FRAME:"lock_frame",PROGRESS_BAR:{BORDER:"bar",GREEN_PROGRESS:"full"},ICON_LOCK:{BODY:"lock_body",TOP:"lock_top"},NEW_ICON_LOCK:"lock",ICON_CHECK:"check",CARD_SHINES:["card_add_1","card_add_2","card_add_3","card_add_4","card_add_5","card_add_6"],RIBBON:{BLUE:"ribbon_blue",PINK:"ribbon_pink",RED:"ribbon_red"},LABEL_SHINE:"gradient",LOCK_SHINE:"lock_shine",DECORATION:"decor",LOCK_DECORATION:"lock_decor"},PAGINATION:{CURRENT_PAGE_POSITION_CIRCLE:"on",PAGE_CIRCLE:"off"}}},BOXING_DUEL:{KEY:"boxing-duel-resources",TEXTURE:"./assets/textures/"+r+"x/boxing-duel-resources.png",JSON:"./assets/textures/"+r+"x/boxing-duel-resources.json",FRAME:{BLANK:"blank",BUTTON:{BASE:"button/boxing-duel-base",PLAY:"button/green"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"},EFFECTS:{VFX_HEADER:"effects/vfx-header",VFX_VS:"effects/vfx-vs",VS_LIGHT:"effects/versus-light-blue"},MAIN:{ARROW:"main/arrow",BUTTON:{PLAY:"main/green-button",INFORMATION:"main/information",CLOSE:"main/close"},CUP:"main/cup",GLOVE:{BLUE:"main/blue-glove",RED:"main/red-glove"},HEADER:{MAIN:"main/header",VICTORY:"main/victory-header",DEFEAT:"main/defeat-header"},LOADING:{BASE:"main/loading-base",BLUE:"main/loading-blue",RED:"main/loading-red",CIRCLE:"main/loading-circle"},POPUP:"main/pop-up",BOXING_DUEL_TEXT:"main/text",TIME_PANEL:"main/time-panel",VS:"main/vs",TEXT_REWARD_COIN:"main/text-reward-coin"},REWARD:{FLAGS:"reward/flags",ILLUSTRATOR:{LEFT:"reward/rewards-illustrator-left",RIGHT:"reward/rewards-illustrator-right"}},VERSUS:{FRAME:{BLUE:"versus/blue-frame",RED:"versus/red-frame"}},PLAYER:{EFFECT_LIGHT:"effects/light-blue",VFX_AVATAR:"effects/vfx-avatar-blue",AVATAR:{BACKGROUND:"main/avatar-blue-base",BORDER:"main/avatar-blue",RANDOM:"main/avatar-blue-random",LIGHT_BORDER:"main/avatar-blue-light"},CROWN:"main/crown-left",CROWN_LIGHT:"main/crown-left-light",SCORE_PANEL:"reward/blue-score-panel",SCORE_PANEL_WIN:"reward/blue-score-panel-win"},OPPONENT:{EFFECT_LIGHT:"effects/light-red",VFX_AVATAR:"effects/vfx-avatar-red",AVATAR:{BACKGROUND:"main/avatar-red-base",BORDER:"main/avatar-red",RANDOM:"main/avatar-red-random",LIGHT_BORDER:"main/avatar-red-light"},CROWN:"main/crown-right",CROWN_LIGHT:"main/crown-right-light",SCORE_PANEL:"reward/red-score-panel",SCORE_PANEL_WIN:"reward/red-score-panel-win"}}},WEEKLY_TOURNAMENT:{KEY:"weekly-tournament",TEXTURE:"./assets/textures/"+r+"x/weekly-tournament.png",JSON:"./assets/textures/"+r+"x/weekly-tournament.json",FRAME:{BLANK:"blank",COMMON:{CLOCK:"common/clock",CLOCK_HAND:"common/clock-hand",RED_DOT:"common/red-dot"},FAILED:{POPUP:"failed/popup",HEADER:"failed/header",BUTTON:{BASE:"failed/base-button",GREEN:"failed/green-button"}},INTRODUCTION:{HEADER_BG:"introduction/header",POPUP:"introduction/popup",THUMBNAIL:"introduction/illustration",TIME_PANEL:"introduction/time-panel",CLOSE:"introduction/close",BUTTON:{BASE:"introduction/base-button",GREEN:"introduction/green-button"}},LEADERBOARD:{POPUP:"leaderboard/popup",HEADER:"leaderboard/header",ILLUSTRATION:"leaderboard/illustration",LEADERBOARD_BG:"leaderboard/leader-block-background",CUP_HEADER:"leaderboard/cup-header",CUP_ICON:"leaderboard/cup-icon",COIN_ICON:"leaderboard/coin-icon",PLAYER:{LEADER_BLOCK_BG:"leaderboard/player/player-leader-block",AVATAR:{BACKGROUND:"leaderboard/player/player-avatar-background",OVERLAY:"leaderboard/player/player-avatar-overlay",NO_AVATAR:"leaderboard/player/player-no-avatar"},SCORE_PANEL:"leaderboard/player/player-score-bar"},OPPONENT:{LEADER_BLOCK_BG:"leaderboard/opponent/opponent-leader-block",AVATAR:{BACKGROUND:"leaderboard/opponent/opponent-avatar-background",OVERLAY:"leaderboard/opponent/opponent-avatar-overlay",NO_AVATAR:"leaderboard/opponent/opponent-no-avatar"},SCORE_PANEL:"leaderboard/opponent/opponent-score-bar"},CHEST:{GOLD:"leaderboard/chest_1",SILVER:"leaderboard/chest_2",PURPLE:"leaderboard/chest_3",BRONZE:"leaderboard/chest_4"},BUTTON:{CLAIM:"leaderboard/claim-button",CLOSE:"leaderboard/close",INFORMATION:"leaderboard/information"},STAR_1:"leaderboard/star1",STAR_2:"leaderboard/star2",STAR_3:"leaderboard/star3",TIME_PANEL:"leaderboard/time-panel",TWINKLE:"leaderboard/twinkle"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"}}},RACE:{KEY:"race",TEXTURE:"./assets/textures/"+r+"x/race.png",JSON:"./assets/textures/"+r+"x/race.json",FRAME:{BLANK:"blank",BUTTON:{BASE:"button/race-base",PLAY:"button/green"},INVITATION:{POPUP:"invitation/pop-up",BUTTON:{INFORMATION:"invitation/information",CLOSE:"invitation/close"}},MAIN:{POPUP:"main/pop-up",HEADER_BACKGROUND:"main/header",HEADER_TEXT:"main/text",TIME_PANEL:"main/time-panel",BUTTON:{INFORMATION:"main/information",CLOSE:"main/close"},PLAYER:{AVATAR_BACKGROUND:"main/player-avatar",AVATAR_BORDER:"main/player-avatar-border",BOAT:"main/player-boat"},OPPONENT:{AVATAR_BACKGROUND:"main/opponent-avatar",AVATAR_BORDER:"main/opponent-avatar-border",BOAT:"main/opponent-boat"},CHEST_ON_ISLAND:{GOLD:"main/chest-1",SILVER:"main/chest-2",BRONZE:"main/chest-3"},CHEST_ON_BUTTON:{GOLD:"main/gold-chest",SILVER:"main/silver-chest",BRONZE:"main/bronze-chest"},MEDAL:{GOLD:"main/medal-gold",SILVER:"main/medal-silver",BRONZE:"main/medal-bronze"},ISLAND:"main/island",SPEECH_BUBBLE:"main/speech-bubble",TWINKLE:"main/twinkle"},REWARD:{ILLUSTRATOR_LEFT:"reward/rewards-illustrator-left",ILLUSTRATOR_RIGHT:"reward/rewards-illustrator-right",CHEST_1:"reward/chest-1",CHEST_2:"reward/chest-2",CHEST_3:"reward/chest-3",CHEST_1_OPEN:"reward/chest-1-open",CHEST_2_OPEN:"reward/chest-2-open",CHEST_3_OPEN:"reward/chest-3-open",SPARKLE_CHEST_1:"reward/chest-1-sparkle",SPARKLE_CHEST_2:"reward/chest-2-sparkle",SPARKLE_CHEST_3:"reward/chest-3-sparkle",GLOW_CHEST_1:"reward/chest-1-glow",GLOW_CHEST_2:"reward/chest-2-glow",GLOW_CHEST_3:"reward/chest-3-glow"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"}}},OFFSHORE_RACE_CHESTS:{KEY:"offshore-race-chests",TEXTURE:"./assets/textures/"+r+"x/offshore-race-chests.png",JSON:"./assets/textures/"+r+"x/offshore-race-chests.json",FRAME:{BLANK:"blank",OFFSHORE_RACE:{ILLUSTRATOR:{LEFT:"offshore-race/rewards-illustrator-left",RIGHT:"offshore-race/rewards-illustrator-right"},GOLD:{CLOSED:"offshore-race/gold-close",OPEN:"offshore-race/gold-open"},SILVER:{CLOSED:"offshore-race/silver-close",OPEN:"offshore-race/silver-open"},BRONZE:{CLOSED:"offshore-race/bronze-close",OPEN:"offshore-race/bronze-open"}},EFFECTS:{GOLD:{GLOW:"effects/gold-glow",SPARKLE:"effects/gold-sparkle"},SILVER:{GLOW:"effects/silver-glow",SPARKLE:"effects/silver-sparkle"},BRONZE:{GLOW:"effects/bronze-glow",SPARKLE:"effects/bronze-sparkle"}}}},WEEKLY_TOURNAMENT_CHESTS:{KEY:"weekly-tournament-chests",TEXTURE:"./assets/textures/"+r+"x/weekly-tournament-chests.png",JSON:"./assets/textures/"+r+"x/weekly-tournament-chests.json",FRAME:{BLANK:"blank",WEEKLY_TOURNAMENT:{ILLUSTRATOR:{LEFT:"weekly-tournament/rewards-illustrator-left",RIGHT:"weekly-tournament/rewards-illustrator-right"},GOLD:{CLOSED:"weekly-tournament/gold-close",OPEN:"weekly-tournament/gold-open"},SILVER:{CLOSED:"weekly-tournament/silver-close",OPEN:"weekly-tournament/silver-open"},PURPLE:{CLOSED:"weekly-tournament/purple-close",OPEN:"weekly-tournament/purple-open"},BRONZE:{CLOSED:"weekly-tournament/bronze-close",OPEN:"weekly-tournament/bronze-open"}},EFFECTS:{GOLD:{GLOW:"effects/gold-glow",SPARKLE:"effects/gold-sparkle"},SILVER:{GLOW:"effects/silver-glow",SPARKLE:"effects/silver-sparkle"},PURPLE:{GLOW:"effects/purple-glow",SPARKLE:"effects/purple-sparkle"},BRONZE:{GLOW:"effects/bronze-glow",SPARKLE:"effects/bronze-sparkle"}}}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+r+"x/gameplay-resources.png",JSON:"./assets/textures/"+r+"x/gameplay-resources.json",FRAME:{BLANK:"blank",CARD_BACK:"cards/card-back-0",BIG_TOP:"bg-top",BIG_PLAYER:"bg-player",BIG_CIRCLE:"big-circle",BUTTON_PLUS:"buttons/plus",BUTTON_SETTING:"buttons/setting",AVATAR_BLUE_BG:"avatars/bg-blue-mini",AVATAR_BLUE_FRAME:"avatars/frame-blue-mini",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",ITEM_GIFT:"items/gift",ITEM_PAINT:"items/paint",ITEM_HAMMER:"items/hammer",ITEM_SHUFFLE:"items/shuffle",ITEM_BG_COIN:"items/bg-coin",ITEM_BG_ITEM:"items/bg-item",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",ICON_CLOCK:"icons/clock",ICON_DIAMOND:"icons/diamond",ICON_DIAMOND_SMALL:"icons/diamond-small",ICON_CUP_SUPERMINI:"icons/cup-supermini",TILE_RED:"gems/red",TILE_BLUE:"gems/blue",TILE_PINK:"gems/pink",TILE_GREEN:"gems/green",TILE_YELLOW:"gems/yellow",TILE_FREEZE:"gems/freeze",TILE_COLORFUL:"gems/colorful",TILE_COLOR_CHANGE:"gems/change"}},DASHBOARD:{KEY:"dashboard-resources",TEXTURE:"./assets/textures/"+r+"x/dashboard-resources.png",JSON:"./assets/textures/"+r+"x/dashboard-resources.json",FRAME:{BLANK:"blank",UPGRADE_ON:"upgrade-on",UPGRADE_OFF:"upgrade-off",BUTTON:{SETTING:"setting-button",JOURNEY:"journey-button",BACK:"back-button",BUTTON:{GREEN_2:"buttons/button/green-2",RED:"buttons/button/red",NEW_GREEN:"buttons/button/new-green",NEW_BLUE:"buttons/button/new-blue",NEW_GREEN_SHADOW:"buttons/button/new-green-shadow",GREEN_3:"buttons/button/green-3"},GREEN_40:"",GREEN_50:"",GREEN_60:"",BLUE_40:"",BLUE_50:"",RED_40:""},LEVEL_BUTTON:{NORMAL:"green-level-button",HARD:"red-level-button",SUPER_HARD:"violet-level-button"},EFFECTS:{GLOW:"effects/glow",WAVE:"effects/wave",SPARKS:"effects/spark"},ICON:{ADD:"add-icon",GREEN_CIRCLE:"green-circle-icon",CHALLENGE:"challenge-icon",COIN:"coin-icon",COINS:"coins-icon",NEW_COINS:"new-coins-icon",DAILY_MISSION:"daily-mission-icon",STAR:"star-icon",SMALL_STAR:"small-star-icon"},BAR_VALUE:{COIN:"coin-bar-value",STAR:"star-bar-value",UPGRADE:"upgrade-bar-value"},PROGRESS:{TRACK:"progress-track",FILL:"progress-fill"},JOURNEY:{PROGRESS_BAR:"journey/progress-bar-border",PROGRESS_FILL:"journey/progress-bar-fill",THUMBNAIL_BACKGROUND:"journey/background",THUMBNAIL_BORDER:"journey/border",THUMBNAIL_OVERLAY:"journey/overlay",THUMBNAIL_LOCK:"journey/lock"},WELCOME_BACK:{NO_THANKS:"welcome-back/no-thanks"},BADGE:{WARNING:"",RANK:"",WINNING_RANK:""},EVENTS_COMMON:{RANK_BLOCK_BLUE:"events/common/rank-block-blue",RANK_BLOCK_GREEN:"events/common/rank-block-green",RED_BADGE:"events/common/red-badge",YELLOW_BADGE:"events/common/yellow-badge"},WEEKLY_TOURNAMENT:{SMALL_ICON:"events/weekly-tournament/small-cup",BUTTON:{PLAYING:"events/weekly-tournament/button-playing",WON:"events/weekly-tournament/button-won",LOST:"events/weekly-tournament/button-lost"}},BOXING_DUEL:{SMALL_ICON:"events/boxing-duel/blue-glove",BUTTON:{PLAYING:"events/boxing-duel/button-playing",WON:"events/boxing-duel/button-won",LOST:"events/boxing-duel/button-lost"}},RACE:{SMALL_ICON:"events/race/small-boat",BUTTON:{PLAYING:"events/race/button-playing",WON:"events/race/button-won",LOST:"events/race/button-lost"}},SHOP:"shop-button",DECOR:{ALERT:"decor/alert",RED_CIRCLE:"decor/red-circle",TITLE_BORDER:"decor/title-border",PROGRESS_BORDER:"decor/progress-border",PROGRESS:{BAR:"decor/progress-bar",FILL:"decor/progress-fill"},LOCATION_BUTTON:"decor/location-button",LOCATION_PROGRESS:{BAR:"decor/location-progress-bar",FILL:"decor/location-progress-fill"}}}},EVENT_BOARD:{KEY:"event-board",TEXTURE:"./assets/textures/"+r+"x/event-board.png",JSON:"./assets/textures/"+r+"x/event-board.json",FRAME:{BLANK:"blank",BOXING_DUEL:{START_CIRCLE:"boxing-duel/boxing-circle",ICON_CUP:"boxing-duel/cup-icon",TEXT_REWARD_COIN:"boxing-duel/text-reward-coin",GLOVE:{BLUE:"boxing-duel/glove-blue",RED:"boxing-duel/glove-red"},LOADING_BAR:{BLUE:"boxing-duel/loading-bar-blue",RED:"boxing-duel/loading-bar-red"},ICON_VS:"boxing-duel/vs-icon",TIMER_BORDER:"boxing-duel/timer-border",GREEN_BUTTON:"boxing-duel/green-button",PLAYER:{AVATAR:{BACKGROUND:"boxing-duel/player/avatar-blue-base",BORDER:"boxing-duel/player/avatar-blue",RANDOM:"boxing-duel/player/avatar-blue-random"},CROWN:"boxing-duel/player/crown-left"},OPPONENT:{AVATAR:{BACKGROUND:"boxing-duel/opponent/avatar-red-base",BORDER:"boxing-duel/opponent/avatar-red",RANDOM:"boxing-duel/opponent/avatar-red-random"},CROWN:"boxing-duel/opponent/crown-right"}},OFFSHORE_RACE:{GREEN_BUTTON:"race/green-button",LEVEL_PANEL:"race/level-panel",TRIANGLE:"race/triangle",TIME_PANEL:"race/timer-panel",CHEST:{GOLD:"race/chest-gold",SILVER:"race/chest-silver",BRONZE:"race/chest-bronze"},MEDAL:{GOLD:"race/medal-gold",SILVER:"race/medal-silver",BRONZE:"race/medal-bronze"},TAG:{LEADERBOARD:"race/tag-leaderboard",PROMOTION:"race/tag-promo",WIN_EMPTY:"race/tag-win-empty"},PLAYER:{AVATAR:"race/player-avatar",SCOREBOARD:"race/player-scoreboard"},OPPONENT:{AVATAR:"race/opponent-avatar",SCOREBOARD:"race/opponent-scoreboard"}},WEEKLY_TOURNAMENT:{CUP_ICON:"weekly-tournament/cup-icon",PLAYING_BOARD:"weekly-tournament/playing-board",WON_BOARD:"weekly-tournament/won-board",LOST_BOARD:"weekly-tournament/lost-board"},PLUS_SCORE_EVENT:{BOXING_DUEL:"plus-event-score/blue-glove",RACE:"plus-event-score/boat",WEEKLY_TOURNAMENT:"plus-event-score/cup"},EFFECTS:{GLOW:"effects/glow",WAVE:"effects/wave",SPARKS:"effects/spark"},ANCHOR_KNOT:"anchor-knot",BLUE_CIRCLE:"blue-circle",GREEN_CIRCLE:"green-circle",HEADER_BOARD:"header-board",ROPE:"rope"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+r+"x/",JSON:"./assets/textures/"+r+"x/effects-resources.json",FRAME:{BLANK:"blank",FX_WHITE_BLUR:"circle-blur",FX_COMET:"comet",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_GOLD:"glow-gold",FX_GLOW_LIGHT:"glow-light",FX_LIGHT:"light",FX_SPARK:"spark",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",TEXT_COOL:"texts/cool",TEXT_GOOD:"texts/good",TEXT_GREAT:"texts/great",TEXT_EXCELLENT:"texts/excellent",TEXT_CONGRATULATION:"texts/congratulation",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",FX_HIGHLIGHT:"fx-items/highlight",FX_PAINT_EXPLOSIVE:"fx-items/paint-explosive-",FX_RED_EXPLOSIVE:"fx-gems/red-explosive-",FX_BLUE_EXPLOSIVE:"fx-gems/blue-explosive-",FX_PINK_EXPLOSIVE:"fx-gems/pink-explosive-",FX_GREEN_EXPLOSIVE:"fx-gems/green-explosive-",FX_YELLOW_EXPLOSIVE:"fx-gems/yellow-explosive-",FX_COLORFUL:"fx-gems/colorful-",FX_COLOR_CHANGE:"fx-gems/color-change-",FX_FREEZE_EXPLOSIVE:"fx-gems/freeze-explosive-",FX_COLORFUL_EXPLOSIVE:"fx-gems/colorful-explosive-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},ANIMATION_SCENE:{KEY:"animation-scene-resources-0",PATH:"./assets/textures/"+r+"x/animation-scene-resources-0.png",JSON:"./assets/textures/"+r+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",CIRCLE:"circle",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-"}},DEMO_SPINE:{DATA_KEY:"demo-spine-data",ATLAS_KEY:"demo-spine-atlas",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"},CARD_LOCK_SPINE:{DATA_KEY:"card-lock-spine-data",ATLAS_KEY:"card-lock-spine-atlas",skelPATH:"./assets/spines/Card_Lock/Card_Lock.skel",atlasPATH:"./assets/spines/Card_Lock/Card_Lock.atlas"},CODE_BREAK_SPINE:{DATA_KEY:"code-break-spine-data",ATLAS_KEY:"code-break-spine-atlas",atlasPATH:"./assets/spines/Code_Break/Code_Break.atlas",skelPATH:"./assets/spines/Code_Break/Code_Break.skel"},SQUIRREL_SPINE:{DATA_KEY:"squirrel-spine-data",ATLAS_KEY:"squirrel-spine-atlas",jsonPATH:"./assets/spines/Squirrel/Squirrel.json",atlasPATH:"./assets/spines/Squirrel/Squirrel.atlas"},MAP_SPINE:{DATA_KEY:"map-card-data",ATLAS_KEY:"map-card-atlas",skelPATH:"./assets/spines/Map_Card/Map_Card.skel",atlasPATH:"./assets/spines/Map_Card/Map_Card.atlas"},WINDMILL_SPINE:{DATA_KEY:"tornado-card-data",ATLAS_KEY:"tornado-card-atlas",skelPATH:"./assets/spines/Tornado_Card/tornado_card.skel",atlasPATH:"./assets/spines/Tornado_Card/tornado_card.atlas"},CARD_SLICE_SPINE:{DATA_KEY:"booster-slice-spine-data",ATLAS_KEY:"booster-slice-spine-atlas",skelPATH:"./assets/spines/Slice_Card/slice_card.skel",atlasPATH:"./assets/spines/Slice_Card/slice_card.atlas"},CARD_SLICE_FX_SPINE:{DATA_KEY:"booster-slice-fx-spine-data",ATLAS_KEY:"booster-slice-fx-spine-atlas",skelPATH:"./assets/spines/Slice_Card/cut_vfx.skel",atlasPATH:"./assets/spines/Slice_Card/cut_vfx.atlas"},CHANGE_VFX_SPINE:{DATA_KEY:"change-vfx-data",ATLAS_KEY:"change-vfx-atlas",skelPATH:"./assets/spines/Change_VFX/change_vfx_top.skel",atlasPATH:"./assets/spines/Change_VFX/change_vfx_top.atlas"},CIRCLE_VFX_SPINE:{DATA_KEY:"circle-vfx-data",ATLAS_KEY:"circle-vfx-atlas",skelPATH:"./assets/spines/Circle/circle.skel",atlasPATH:"./assets/spines/Circle/circle.atlas"}};GameCore.Utils.Valid.isDebugger()&&(a.EFFECTS.FRAME=(0,i.Z)({},a.ANIMATION_SCENE.FRAME,a.EFFECTS.FRAME)),t.Z=a},,function(e,t,n){"use strict";n.d(t,{R0:function(){return s},Tv:function(){return a},j6:function(){return i},sw:function(){return r},tO:function(){return o}});n(34);var i=function(){var e=setInterval((function(){window.Sentry&&clearInterval(e)}),100)},r=function(e,t){window.Sentry&&window.Sentry.addBreadcrumb({category:e,message:t})},a=function(e){window.Sentry&&window.Sentry.setUser(e)},s=function(e,t){},o=function(e){}},function(e,t){"use strict";t.Z={BACKGROUND:1,FOOTER_LOGO:2,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,GAMEPLAY:21,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,HEADER:33,GUIDE:35,POPUP:40,PRIORITY:80,DEBUG:90,ON_TOP:1e4}},,,,function(e,t,n){"use strict";n.d(t,{BN:function(){return o},QT:function(){return s},cX:function(){return r}});var i={PRIMARY:{KEY:"black-stroke",TEXTURE:"black-stroke.png",DATA:"black-stroke.xml"},NORMAL_1:{KEY:"normal-1",TEXTURE:"normal-1.png",DATA:"normal-1.xml"},NORMAL:{KEY:"normal",TEXTURE:"normal.png",DATA:"normal.xml"},SHADOW:{KEY:"shadow",TEXTURE:"shadow.png",DATA:"shadow.xml"},STROKE:{KEY:"stroke",TEXTURE:"stroke.png",DATA:"stroke.xml"},WHITE_SHADOW:{KEY:"white_shadow",TEXTURE:"white_shadow.png",DATA:"white_shadow.xml"},STYLE:{KEY:"style",TEXTURE:"style.png",DATA:"style.xml"},HEADER:{KEY:"header",TEXTURE:"header.png",DATA:"header.xml"},FONT_ATLAS:{KEY:"font-atlas",TEXTURE:"bitmap-fonts-atlas.png",DATA:"bitmap-fonts-atlas.json",FRAME:{PRIMARY:"black-stroke",NORMAL:"normal",NORMAL_1:"normal-1",SHADOW:"shadow",STROKE:"stroke",WHITE_SHADOW:"white_shadow",STYLE:"style",HEADER:"header"}}},r=(i.PRIMARY.KEY,i.PRIMARY.DATA,i.NORMAL.KEY,i.NORMAL.DATA,i.SHADOW.KEY,i.SHADOW.DATA,i.STROKE.KEY,i.STROKE.DATA,i.WHITE_SHADOW.KEY,i.WHITE_SHADOW.DATA,i.NORMAL_1.KEY,i.NORMAL_1.DATA,i.STYLE.KEY,i.STYLE.DATA,i.HEADER.KEY,i.HEADER.DATA,[{fontName:i.PRIMARY.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.PRIMARY,xmlKey:i.PRIMARY.KEY},{fontName:i.NORMAL.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.NORMAL,xmlKey:i.NORMAL.KEY},{fontName:i.NORMAL_1.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.NORMAL_1,xmlKey:i.NORMAL_1.KEY},{fontName:i.SHADOW.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.SHADOW,xmlKey:i.SHADOW.KEY},{fontName:i.STROKE.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.STROKE,xmlKey:i.STROKE.KEY},{fontName:i.WHITE_SHADOW.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.WHITE_SHADOW,xmlKey:i.WHITE_SHADOW.KEY},{fontName:i.STYLE.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.STYLE,xmlKey:i.STYLE.KEY},{fontName:i.HEADER.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.HEADER,xmlKey:i.HEADER.KEY}]);t.ZP=i;var a='mikado-bold ,nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',s=function(e){a="ru"===e?"DejaVuSans-Bold":'mikado-bold ,nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif'},o=function(){return a}},function(e,t,n){"use strict";n.d(t,{Z:function(){return B}});var i=n(2),r=n(0),a=n(51),s=n(52),o=n(7),c=n(46),h=n(45),u=n(47),l=(0,n(43).P1)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),d=n(49),p=n(9),f=n(53),m=n(1),g=n(14),v=n(10),y=o.Z.DEFAULT,E=y.KEY,C=y.FRAME,w=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(v.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,r.Z)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:E,frame:C.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:g.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),A=w,b=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,r=Math.round(t/1048576);n.setMemory(r),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(v.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,m.Z)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,r.Z)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:g.ZP.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),S=b,T=n(50),x=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).loadingIcon=void 0,a.messageText=void 0,a.closeTimerEvent=void 0,a.openCloseTween=void 0,a.animationFadeOut=void 0,a.addLoadingIcon(),a.addMessageText(),a.setDepth(h.Ks.PRIORITY),d.Z.registerObject(a.background,h.MR.MULTIPLY_ALPHA),a.setAlpha(0),a}(0,r.Z)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t);var r=this.getData(["message","duration","loading","animationFadeOut"]),a=r[0],s=void 0===a?"":a,o=r[1],c=void 0===o?0:o,h=r[2],u=void 0!==h&&h,l=r[3],d=void 0!==l&&l;this.animationFadeOut=d,this.setMessage(s),this.showLoading(u),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new T.Z(this.scene),this.add(this.loadingIcon),this.loadingIcon.setVisible(!1),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone),this.loadingIcon.setWorldSize(56.5,56.5)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(15),font:g.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.changeMessage=function(e){var t=this;this.scene.tweens.add({targets:this.messageText,duration:150,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0,alpha:0,onYoyo:function(){t.messageText.setText(e)}})},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.loadingIcon.setVisible(e);var t=!1===e?10:40;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,t)},n.runOpenAnimation=function(){var e;null==(e=this.openCloseTween)||e.remove(),this.openCloseTween=this.scene.tweens.add({duration:200,targets:this,alpha:{from:0,to:1}})},n.close=function(){var t,n=this;null==(t=this.closeTimerEvent)||t.remove(),this.animationFadeOut?this.openCloseTween=this.scene.tweens.add({duration:200,targets:this,alpha:0,onComplete:function(){e.prototype.close.call(n)}}):e.prototype.close.call(this),this.setData({animationFadeOut:!1,duration:0,loading:!1,message:""})},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen),k=x,P=o.Z.DEFAULT,I=P.KEY,O=P.FRAME,R=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).mask=void 0,t.fadeInAnim=void 0,t.fadeOutAnim=void 0,t.fpsMeter=void 0,t.memoryMeter=void 0,t.switchScene=function(e){t.currentScene.switch(e)},t.emitGameEventStartScene=function(e){var n=e.scene.key;t.updateSceneState(),t.runMaskFadeOutAnimation(),t.updateActiveSceneKey(n),t.game.events.emit(Phaser.Scenes.Events.START,n),(0,p.sw)("scene","Start scene: "+n)},t.emitGameEventSleepScene=function(e){var n=e.scene.scene.key;n!==c.C.LOAD_SCENE&&(t.runMaskFadeInAnimation(),t.game.events.emit(Phaser.Scenes.Events.SLEEP,n))},t.emitGameEventWakeScene=function(e){var n=e.scene.scene.key;n!==c.C.LOAD_SCENE&&(t.updateSceneState(),t.runMaskFadeOutAnimation(),t.updateActiveSceneKey(n),t.game.events.emit(Phaser.Scenes.Events.WAKE,n))},t.emitGameEventPauseScene=function(e){var n=e.scene.scene.key;t.game.events.emit(Phaser.Scenes.Events.PAUSE,n)},t.emitGameEventResumeScene=function(e){var n=e.scene.key;t.game.events.emit(Phaser.Scenes.Events.RESUME,n)},t.emitGameEventShutdownScene=function(e){var n=e.scene.scene.key;t.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,n)},t}(0,r.Z)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var e=this.screen.add(h.o4.NOTIFY_SCREEN,k);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:I,frame:O.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(859421),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new A(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new S(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new a.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new s.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(c.K.SWITCH,this.switchScene),this.events.on(Phaser.Scenes.Events.RENDER,d.Z.updateBgMask)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.updateActiveSceneKey=function(e){e!==c.C.GLOBAL_SCENE&&this.storage.dispatch((0,u.I)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.Z)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=l(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(f.Z),B=R},function(e,t,n){"use strict";var i=n(11),r=n.n(i)()(.48,1.57,.6,.83);t.Z=r},function(e,t,n){"use strict";var i=n(2),r=n(1),a=n(0),s=n(6),o=n(55),c=n(10),h=n(54),u=n(9),l=n(48),d=function(e){function t(t,n,i,a,s,u){var d;return void 0===u&&(u=!1),(d=e.call(this,t)||this).useSound=!0,d.isClicked=!1,d.scaleUp=-1,d.scaleDown=-1,d.button=void 0,d.upAnimation=void 0,d.downAnimation=void 0,d.isUsePixelPerfect=!1,d.hitArea=void 0,d.hitZone=void 0,d.scaleDownPress=void 0,d.parentName=void 0,d.handelObjectDestroy=function(){d.scene&&d.scene.events.off(Phaser.Scenes.Events.SLEEP,d.handleSceneSleep)},d.handleSceneSleep=function(){d.scene&&d.scene.tweens.killTweensOf((0,r.Z)(d))},d.handlePointerDown=function(){var e;d.isClicked||null!=(e=d.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(d.isClicked=!0,d.runDownAnimation())},d.handleOnClick=function(e){return function(){var t,n;d.isClicked&&(null!=(t=d.upAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(d.isClicked=!1,d.runUpAnimation(),d.processCallback(e),null==(n=d.upAnimation)||null==(n=n.tween)||n.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){d.logButtonEvent(),d.addDebugData()}))))}},d.handlePointerOut=function(){var e;d.isClicked&&(null!=(e=d.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(d.isClicked=!1,d.runUpAnimation()))},d.runDownAnimation=function(){var e;-1===d.scaleDown&&(d.scaleUp=d.scale,d.scaleDown=d.scaleDownPress),d.useSound&&d.scene.audio.playAudioSprite(l.Z.UI.KEY,h.Z.BUTTON_CLICK),null==(e=d.downAnimation)||e.remove(),d.downAnimation=new o.Z({targets:[(0,r.Z)(d)],duration:120,props:{scale:d.scaleDown},onUpdate:function(){d.hitZone.scale=1/d.scale}}),d.downAnimation.play()},d.runUpAnimation=function(){var e;-1!==d.scaleUp&&(null==(e=d.upAnimation)||e.remove(),d.upAnimation=new o.Z({targets:[(0,r.Z)(d)],duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],props:{scale:d.scaleUp},onUpdate:function(){d.hitZone.scale=1/d.scale}}),d.upAnimation.play())},d.isUsePixelPerfect=u,d.setDepth(c.Z.BUTTON),d.createButton(n,i,a,s),d.updateSize(),d.listenEvents(),d.scene.add.existing((0,r.Z)(d)),d}(0,a.Z)(t,e);var n=t.prototype;return n.setScaleAnimation=function(e){return this.scaleUp=e,this.scaleDown=e-.075,this.scaleDownPress=e-.075,this},n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(e){e()},n.onCompletedUpAnimation=function(){var e,t;null==(e=this.upAnimation)||e.stop(),null==(t=this.downAnimation)||t.stop(),-1!==this.scaleUp&&this.setScale(this.scaleUp)},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.075;var r=this.button,a=r.displayWidth,s=r.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:a,displayHeight:s}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,r=n/100*10,a=i<10?i:10,s=r<10?r:10;this.setSize(t+a,n+s),this.hitZone.setSize(t+a,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,u.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container);t.Z=d},,,,,,,,,function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var i=["Aaliyah","Aaradhya","Abigail","Ada","Addison","Adelaide","Adeline","Adriana","Aisha","Alana","Alexandra","Alice","Alicia","Alina","Allison","Alyssa","Amaia","Amelia","Am\xe9lie","Amina","Amy","Ana","Anastasia","Andrea","Angelina","Anika","Anna","Annabelle","Anne","Antonia","Anya","Aria","Ariana","Ariel","Arisha","Ashley","Astrid","Athena","Audrey","Aurora","Ava","Avery","Ayla","Beatrice","Bella","Bianca","Blair","Briana","Brianna","Bridget","Brooklyn","Caitlyn","Camila","Camille","Caroline","Cassandra","Catherine","Cecilia","Celeste","Charlotte","Chloe","Christina","Claire","Clara","Claudia","Clementine","Colleen","Cora","Daisy","Daniella","Daphne","Darcy","Delilah","Diana","Dolores","Dorothy","Eden","Eleanor","Eliana","Elisa","Elizabeth","Ella","Ellie","Eloise","Elsa","Emilia","Emily","Emma","Erin","Esmeralda","Esther","Eva","Evangeline","Evelyn","Everly","Fatima","Felicity","Fiona","Florence","Francesca","Freya","Gabriella","Gaia","Genevieve","Georgia","Gia","Gianna","Gillian","Grace","Greta","Gwen","Hadley","Hailey","Hana","Hannah","Harper","Hazel","Heather","Helen","Helena","Holly","Hope","Imani","India","In\xe8s","Iris","Isabelle","Isla","Ivy","Jacqueline","Jade","Jasmine","Jenna","Jennifer","Jessica","Jillian","Josie","Julia","Juliana","Juliet","June","Juniper","Kaia","Kaira","Kaitlyn","Kamila","Karen","Karina","Kate","Katherine","Kayla","Kennedy","Khloe","Kiara","Kiera","Kimberly","Kylie","Lacey","Laila","Lana","Lara","Lauren","Layla","Leah","Leia","Lena","Lia","Liana","Liliana","Lillian","Lily","Lina","Linda","Lindsay","Liv","Lola","Lucia","Lucy","Luna","Lydia","Mackenzie","Madeline","Madison","Maeve","Maggie","Maia","Maisie","Malia","Mallory","Margaret","Maria","Mariana","Marilyn","Marisa","Maya","Megan","Melanie","Mia","Michaela","Michelle","Mila","Miranda","Molly","Morgan","Nadia","Naomi","Natalia","Natalie","Natasha","Nevaeh","Nicole","Nina","Nora","Olivia","Ophelia","Paige","Paisley","Pamela","Paris","Patricia","Penelope","Peyton","Phoebe","Piper","Quinn","Rachel","Reagan","Rebecca","Riley","Rose","Rowan","Ruby","Sadie","Sage","Samantha","Samara","Sarah","Savannah","Scarlett","Selena","Serenity","Seraphina","Shayla","Sienna","Skylar","Sofia","Sophia","Sophie","Stella","Summer","Sydney","Talia","Taylor","Thea","Theresa","Valentina","Valerie","Vanessa","Veronica","Victoria","Violet","Vivian","Willow","Willa","Winter","Ximena","Yael","Yara","Yasmine","Zoe","Zoey","Zara","Zelda","Zendaya","Zuri","Amina","Amara","Ananya","Arya","Astrid","Cadence","Calliope","Cassandra","Celeste","Cordelia","Elodie","Esme","Genevieve","Hazel","Imogen","Ingrid","Juniper","Lilac","Lyra","Maeve","Magnolia","Margot","Noelle","Octavia","Pearl","Persephone","Quinn","Rowan","Sage","Seraphina","Sylvie","Tessa","Thora","Valentina","Willow","Wren","Xenia","Yara","Zelda","Zoe"],r=function(e){var t=Phaser.Utils.Array.NumberArray(1,315);return Phaser.Utils.Array.Shuffle(i).slice(0,e).map((function(e){var n=Phaser.Utils.Array.RemoveRandomElement(t).toString().padStart(4,"0");return{id:n,name:e,photo:"./assets/images/avatars/avatar_"+n+".jpg"}}))};t.Z=function(){return i[Math.floor(Math.random()*i.length)]}},function(e,t){"use strict";t.Z=function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",r=e;void 0!=t&&(r-=t.length,i+=t);for(var a=0;a<r;a++){var s=Math.floor(67*Math.random());i+=n.charAt(s)}return i}},function(e,t){"use strict";t.Z=function(e,t){if(0==t.length)return e;for(var n=e,i=0;i<t.length;i++)n=n.replace(/{}/,""+t[i]);return n}},function(e,t){"use strict";t.Z=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var i=document.createElement("canvas"),r=i.getContext("2d");if(null===r)return Promise.resolve(null);var a=new Image;r.clearRect(0,0,t,n),r.canvas.width=t,r.canvas.height=n;var s=3/GameCore.ImageScale;return r.scale(s,s),r.drawImage(e.source.image,e.cutX,e.cutY,e.cutWidth,e.cutHeight,Math.abs(t/s-e.cutWidth)/2,Math.abs(n/s-e.cutHeight)/2,e.cutWidth,e.cutHeight),new Promise((function(e){var t=function(t){i.remove(),e(t)};a.src=i.toDataURL(),a.onload=function(){return t(a)},a.onerror=function(){return t(null)}}))}},function(e,t){"use strict";var n=function(e){if(e.indexOf(".")<0)return e;for(var t=e.length-1;t>=0;t--){if("."==e[t])return e.substring(0,t);if("0"!=e[t])return e.substring(0,t+1)}return e};t.Z=function(e,t){var i=t||{},r=i.fractionalDigits,a=void 0===r?0:r,s=i.startAbbreviate,o=void 0===s?1e3:s,c=i.abbreviateStep,h=void 0===c?3:c,u=i.maxLength,l=void 0===u?-1:u,d=i.removeLastZero,p=void 0===d||d,f=i.suffixes,m=void 0===f?["","k","m","b","t","q"]:f,g=-1===l?99999999:l;if(e>=o){var v=Math.floor(e/Math.pow(10,h)),y=Math.floor((v.toString().length-1)/h)+1,E=(e/Math.pow(Math.pow(10,h),y)).toFixed(a),C=g-m[y].length,w=E.substring(0,C);return(p?n(w):w)+m[y]}var A=e.toFixed(a),b=g-m[0].length,S=A.substring(0,b);return p?n(S):S+m[0]}},function(e,t){"use strict";t.Z=function(e,t,n,i,r){return(e-t)*(r-i)/(n-t)+i}},,,,function(e,t,n){"use strict";n.d(t,{F0:function(){return a},Gm:function(){return r},qZ:function(){return i},s:function(){return s}});var i=function(e){return new Promise((function(t){return setTimeout(t,e)}))},r=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},a=function(e,t){void 0===t&&(t=!0);var n=new Date(e).toISOString();return t?n.slice(11,-5):n.slice(14,-5)},s=function(e){var t=Date.now(),n=Math.max(1e3*e-t,0);return{remainingTimeInDays:Math.round(n/864e5),remainingTimeInMs:n}}},,function(e,t,n){"use strict";var i=n(38),r=function(){function e(e,t,n,r){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.Z.AVATAR.FILE,this.locale=r||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},e}();t.Z=r},function(e,t){"use strict";var n={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+GameCore.ImageScale+"x/CornField_final.jpg",CONFIG:{}},OVERLAY:{KEY:"overlay",FILE:"./assets/images/others/overlay.png",CONFIG:{}},JOURNEY_BACKGROUND:{KEY:"journey-background",FILE:"./assets/images/2x/journey-background.jpg",CONFIG:{}}};t.Z=n},function(e,t){"use strict";t.Z={GENERIC_NOTIFICATION:0,NEW_USER_NOTIFICATION:1,MONDAY_NOTIFICATION:2,TUESDAY_NOTIFICATION:3,WEDNESDAY_NOTIFICATION:4,THURSDAY_NOTIFICATION:5,FRIDAY_NOTIFICATION:6,SATURDAY_NOTIFICATION:7,SUNDAY_NOTIFICATION:8}},,,function(e,t,n){"use strict";n.d(t,{DW:function(){return c},EH:function(){return a},fJ:function(){return r},kL:function(){return i},qj:function(){return s},rh:function(){return o}});var i="CONTEXT_RECEIVED",r="CONTEXT_PROCESSED",a="CONTEXT_GAME_MODE_DETECTED",s="MESSAGES_SENT_UPDATE",o="MESSAGES_SENT_REMOVE",c="SCENE_KEY_UPDATE"},,function(e,t){"use strict";t.Z={RESIZE:"resize",CHANGE_LAYOUT:"change-layout"}},function(e,t,n){"use strict";n.d(t,{Ks:function(){return r},MR:function(){return a},o4:function(){return i}});var i={PAUSE_SCREEN:"PAUSE_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",REWARD_SCREEN:"REWARD_SCREEN",RESCUE_SCREEN:"RESCUE_SCREEN",DASHBOARD_SCREEN:"DASHBOARD_SCREEN",DASHBOARD_SETTINGS_SCREEN:"DASHBOARD_SETTINGS_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",BEST_SCORE_SCREEN:"BEST_SCORE_SCREEN",DAILY_REWARDS_SCREEN:"DAILY_REWARDS_SCREEN",DAILY_MISSIONS_SCREEN:"DAILY_MISSIONS_SCREEN",LUCKY_REWARD_SCREEN:"LUCKY_REWARD_SCREEN",NO_MORE_MOVES_SCREEN:"NO_MORE_MOVES_SCREEN",PLAY_SCREEN:"PLAY_SCREEN",GAME_STATS_SCREEN:"GAME_STATS_SCREEN",THEME_SCREEN:"THEME_SCREEN",HOW_TO_PLAY_SCREEN:"HOW_TO_PLAY_SCREEN",AWESOME_SCREEN:"AWESOME_SCREEN",NOTIFICATION_SCREEN:"NOTIFICATION_SCREEN",TOURNAMENTS_SCREEN:"TOURNAMENTS_SCREEN",PLAY_WITH_FRIEND_GAME_OVER_SCREEN:"PLAY_WITH_FRIEND_GAME_OVER_SCREEN",TOURNAMENTS_RESULT_SCREEN:"TOURNAMENT_RESULT_SCREEN",BUYING_BOOSTER_SCREEN:"BUYING_BOOSTER_SCREEN",GET_COINS_SCREEN:"GET_COINS_SCREEN",GET_MORE_STARS_SCREEN:"GET_MORE_STARS_SCREEN",OUT_OF_HEARTS_SCREEN:"OUT_OF_HEARTS_SCREEN",GUIDE_SCREEN:"GUIDE_SCREEN",NOTIFY_BOMB_SCREEN:"NOTIFY_BOMB_SCREEN",EXIT_GAME_SCREEN:"EXIT_GAME_SCREEN",LEVEL_COMPLETE_SCREEN:"LEVEL_COMPLETE_SCREEN",NEXT_JOURNEY_SCREEN:"NEXT_JOURNEY_SCREEN",JOURNEY_SCREEN:"JOURNEY_SCREEN",JOURNEY_COIN_SCREEN:"JOURNEY_COIN_SCREEN",CHALLENGE_WELCOME_SCREEN:"CHALLENGE_WELCOME_SCREEN",CHALLENGE_RESULT_SCREEN:"CHALLENGE_RESULT_SCREEN",CHALLENGE_REMINDER_SCREEN:"CHALLENGE_REMINDER_SCREEN",LAB_SCREEN:"LAB_SCREEN",WELCOME_BACK_SCREEN:"WELCOME_BACK_SCREEN",OFFSHORE_RACE:{INTRO_SCREEN:"OFFSHORE_RACE_INTRO_SCREEN",INVITATION_SCREEN:"OFFSHORE_RACE_INVITATION_SCREEN",MAIN_SCREEN:"OFFSHORE_RACE_MAIN_SCREEN",REWARD_SCREEN:"OFFSHORE_RACE_REWARD_SCREEN"},WEEKLY_TOURNAMENT:{INTRO_SCREEN:"WEEKLY_TOURNAMENT_INTRO_SCREEN",INVITATION_SCREEN:"WEEKLY_TOURNAMENT_INVITATION_SCREEN",MAIN_SCREEN:"WEEKLY_TOURNAMENT_MAIN_SCREEN",REWARD_SCREEN:"WEEKLY_TOURNAMENT_REWARD_SCREEN",FAILED_SCREEN:"WEEKLY_TOURNAMENT_FAILED_SCREEN"},BOXING_DUEL:{INTRO_SCREEN:"BOXING_DUEL_INTRO_SCREEN",MAIN_SCREEN:"BOXING_DUEL_MAIN_SCREEN",REWARD_SCREEN:"BOXING_DUEL_REWARD_SCREEN",VERSUS_SCREEN:"BOXING_DUEL_VERSUS_SCREEN"}},r={SCREEN:200,POPUP:300,PRIORITY:999},a={COLOR:0,ALPHA:{COMMON:.6,GUIDE:.05},MULTIPLY_ALPHA:.67}},function(e,t,n){"use strict";n.d(t,{C:function(){return i},K:function(){return r}});var i={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",RESULT_MATCH_SCENE:"RESULT_MATCH_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},r={SWITCH:Symbol("SWITCH")}},function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var i=n(42),r=function(e){return{type:i.DW,payload:{sceneKey:e}}}},function(e,t){"use strict";t.Z={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},GAMEPLAY_BACKGROUND:{KEY:"gameplay-background",FILE:"./assets/music/gameplay_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json",PATH:"./assets/sounds/"},UI:{KEY:"ui",FILE:["./assets/sounds/ui.ogg","./assets/sounds/ui.mp3"],JSON:"./assets/sounds/ui.json"},BOOSTERS:{KEY:"boosters",FILE:["./assets/sounds/boosters.ogg","./assets/sounds/boosters.mp3"],JSON:"./assets/sounds/boosters.json"},CARD:{KEY:"card",FILE:["./assets/sounds/card.ogg","./assets/sounds/card.mp3"],JSON:"./assets/sounds/card.json"},CARD_COMBO:{KEY:"card-combo",FILE:["./assets/sounds/card-combo.ogg","./assets/sounds/card-combo.mp3"],JSON:"./assets/sounds/card-combo.json"},CARD_ROTATE:{KEY:"card-rotate",FILE:["./assets/sounds/card-rotate.ogg","./assets/sounds/card-rotate.mp3"],JSON:"./assets/sounds/card-rotate.json"},GAMEPLAY:{KEY:"gameplay",FILE:["./assets/sounds/gameplay.ogg","./assets/sounds/gameplay.mp3"],JSON:"./assets/sounds/gameplay.json"},CONGRATS_SOUND:{KEY:"congrats-sound",FILE:["./assets/sounds/congrats-sound.ogg","./assets/sounds/congrats-sound.mp3"],JSON:"./assets/sounds/congrats-sound.json"}}},function(e,t){"use strict";var n;function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var a=function(){function e(){}return e.registerObject=function(t,n){e.objects.some((function(e){return e.object==t}))||e.objects.push({object:t,alpha:n||1})},e.setColor=function(t){e.color=t},e}();n=a,a.objects=[],a.currentAlpha=-1,a.color="0 0 0",a.changeMaskAlpha=function(e){var t=document.getElementById("bottom-overlay");t&&(t.style.background="rgb("+n.color+" / "+e+")")},a.updateBgMask=function(){for(var e,t=1,r=i(n.objects);!(e=r()).done;){var a=e.value,s=a.object.scene;if(!s)return;if(s.scene.isActive(s.scene.key)){for(var o=a.object,c=a.object.alpha,h=a.object.visible;o.parentContainer;)c*=(o=o.parentContainer).alpha,h=h&&o.visible;h&&(t*=1-c*a.alpha)}}var u=1-t;n.currentAlpha!=u&&(n.currentAlpha=u,n.changeMaskAlpha(u))},t.Z=a},function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(1),r=n(0),a=n(7),s=n(3),o={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},c=function(e){function t(t){return e.call(this,o,t)||this}return(0,r.Z)(t,e),t}(s.Z),h=a.Z.DEFAULT,u=h.KEY,l=h.FRAME,d=function(e){function t(t){var n;return(n=e.call(this,t,0,0,u,l.PRELOADER.LOADING)||this).anim=void 0,n.runAnimation(),n.setWorldSize(56.5,56.5),n.scene.add.existing((0,i.Z)(n)),n}(0,r.Z)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new c({targets:[this],repeat:-1,duration:1e3,props:{angle:{from:0,to:360,ease:function(e){return Phaser.Math.Easing.Stepped(e,12)}}}}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image)},function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(0),r=n(6),a=function(e){function t(t,n,i){var r;return(r=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),r}return(0,i.Z)(t,e),t}(Phaser.GameObjects.Zone),s=n(44),o=function(e){function t(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.currBgCfg=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.handleResize=function(){if(t.background&&t.gameZone){var e=t.world.getResizeEventData(),n=e.width,i=e.height;t.gameZone.setSize(n,i),t.background.setPosition(n/2,i/2),t.background.setDisplaySize(n,i)}},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}(0,i.Z)(t,e);var n=t.prototype;return n.create=function(){this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.world.events.on(s.Z.RESIZE,this.handleResize),this.scaleGame(),this.createGameZone()},n.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,r=n.height;e.setZoom(t),e.centerOn(i/2,r/2)},n.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new a(this,t,n)},n.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},n.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},n.fontSize=function(e){var t=this.getModSizeByLang();return Math.round(e/t)},n.getModSizeByLang=function(){switch(this.lang.getCurrentLanguage()){case"en":return 1.01;case"ru":return 1.25;default:return 1.1}},n.createBackground=function(e,t,n,i){var r,a,s,o;if(!((null==(r=this.currBgCfg)?void 0:r.key)===e&&(null==(a=this.currBgCfg)?void 0:a.frame)===t&&(null==(s=this.currBgCfg)?void 0:s.alpha)===n&&(null==(o=this.currBgCfg)?void 0:o.tint)===i)){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e),this.updateBackgroundSize(),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone);var c={key:e,frame:t,alpha:n,tint:i,width:this.background.width,height:this.background.height,scale:this.background.scale};this.currBgCfg&&this.handleBackgroundChange(this.currBgCfg),this.currBgCfg=c}},n.updateBackgroundSize=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var r=this.background,a=r.scaleX,s=r.scaleY;if("height"===i)this.background.setScale(s);else this.background.setScale(a)},n.handleBackgroundChange=function(e){},n.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,r=t.storage.watch(n,i);t.unsubscribeList.push(r)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(r._.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},t}(Phaser.Scene)},function(e,t){"use strict";t.Z={BUTTON_CLICK:"button_click",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",OPEN_WIN_SCREEN:"level_complete_perfect",LEVEL_COMPLETED:"level_win_jingle_part2",SELECT_BOOSTER:"pre_bstr_shuffling_prebooster_in_hud_off",UN_SELECT_BOOSTER:"pre_bstr_shuffling_prebooster_in_hud_cancel",FILL_PROGRESS:"ui_meta_progress_bar_filling",FULL_PROGRESS:"ui_meta_progress_bar_full",REWARD_GIFT:"reward_collect",OPEN_GIFT:"reward_chest_open",UPDATE_NEW_LOCATION:"metamap_location_unlock",GOAL_PROGRESS:"goal_progress",UPGRADE_DECORATION:"upgrade_decoration",CHEST_FLYING:"chest_flying",CHEST_JUMP:"chest_jump",CHEST_OPEN:"chest_open",CARDS_APPEAR:"level_start",DEAL_CARDS:"deal-cards",CARD_MOVE:"card_move",SHUFFLE:"shuffle",GET_HEAP_COINS:"ui_coins_heap_get",COINS_APPEAR:"winscreen2_coins_flying_to_counter",COUNT_COINS:"ui_coins_counter",DRAW_WILD:"booster_wild_field_take",WILD_CARD_HINT:"booster_wild_hint",SKIP_MOVE:"ui_skip_move",REWARD_STREAK:"gp_streak",REWARD_CARD:"gp_streak_x1",SHOW_COMPLIMENT:"streak_cheering",ADD_FIVE_CARDS:"add-5-cards",TAP_UNDO_STOCK:"ui_undo_card",TAP_UNDO_PILE:"ui_move_redo_tap",TAP_STOCK:"gp_redo_button_touch",RELEASE_UNDO:"gp_redo_button_release",SWOOSH_LONG:"long_whoosh",POP:"pumpkin",OPEN_CARD:"card_open_1",CLOSE_CARD:"gp_card_redo_field",DRAW_CARD:"gp_card_take",MISS_TAP_CARD:"gp_card_misstap",STOCK_CARD_REWARD:"gp_last_card_to_stock",START_MOVE_TO_WASTE:"gp_card_collect_x2",FINISH_MOVE_TO_WASTE:"card_played_off_x2",KEY_ACTIVATE:"mod_key",TWIST_LOCK:"mod_lock_opens",EXPLODE:"bomb_gang",BOMB_TICK:"bomb_counter",FLY_TO_STOCK:"card_plus_flight_to_stock",CARD_PLUS_ACTIVATE:"card_plus_activation",SPAWN_CARD:"card_plus_spawn_card_1",TICK:"count_down_tick",PAPER_FALLS:"paper_falls",HAMMER:"hammer",UNLOCK_LOCK:"unlock_lock",SLICE_CARD:"booster_blade_sweep_3",CUT_CARD:"booster_card_cut_2",WILD_CARD_APPEAR:"booster_wild_level_start_appear",STORM_BOOSTER_APPEAR:"booster_start_fan_appears",END_GAME:"you_lose",DIAMONDS_EAT:"",FIREWORKS_SOAR:"",FIREWORKS_BIG:"",FIREWORKS_SMALL:"",DAILY_REWARD:"",GAME_OVER_SCENE:"",SCORE_COUNTER:"",CONGRATULATION:"",YOU_WIN:"",YOU_LOSE:"",GIFT_CHARGE:"",GIFT_REVEAL:"",GIFT_EXPLODE:""}},function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],duration:400,ease:n(16).Z,props:{scale:"-=0.1"}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e,t,n){"use strict";var i=n(0),r=function(e){function t(t){var n;return(n=e.call(this,t)||this).scale=void 0,n}(0,i.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.updateScale(),this.updateVelocity(),r},n.setScale=function(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max)},n.easeInCubic=function(e){return e*e*e},n.updateScale=function(){var e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)},n.updateVelocity=function(){this.velocityX+=Phaser.Math.Between(-1,1)},t}(Phaser.GameObjects.Particles.Particle);t.Z=r},function(e,t,n){"use strict";var i=n(11),r=n.n(i)()(.55,.47,.43,.91);t.Z=r},function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n(57).Z,easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=59,e.exports=t},function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),r=i.length,a=r>>2,s=new Uint8Array(r),o=new Uint32Array(s.buffer,0,a),c=0,h=0;c<a;c++)o[c]=i.charCodeAt(h++)|i.charCodeAt(h++)<<8|i.charCodeAt(h++)<<16|i.charCodeAt(h++)<<24;for(var u=3&r;u--;)s[h]=i.charCodeAt(h++);e(new Blob([s],{type:t||"image/png"}))}})},function(e,t,n){"use strict";var i=function(e,t){return void 0===t&&(t=1),Array.from({length:Math.ceil(e.length/t)},(function(n,i){return e.slice(i*t,i*t+t)}))},r=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},a=function(e,t,n){return n.indexOf(e)===t&&null!==e&&void 0!==e},s=function(e){return e.filter(a)},o={chunk:i,difference:function(e,t){return e.filter((function(e){return!t.includes(e)}))},shuffle:r,unique:s},c=n(23),h=n.n(c),u=h()((function(e,t){if("string"===typeof e){var n=t[e.toLowerCase()];if("string"===typeof n)return n}return"?"})),l=h()((function(e){for(var t=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(t=i.exec(e));)n.push(t[1]);return n})),d=h()((function(e){for(var t=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(t=i.exec(e));){var r=t[0];if(r.length>=2){var a=r.length,s=r.slice(0,a-1),o=r[a-1],c=new Array(+s).fill(o);n.push.apply(n,c)}else n.push(r)}return n})),p=function(e,t){var n=e,i=GameCore.Utils.Object.invert(t),r={},a=0,s=0;return l(n).forEach((function(e){a=0,s++,r[s]||(r[s]={}),d(e).forEach((function(e){a++,r[s][a]=u(e,i)}))})),r},f=h()((function(e,t){var n=t[e];return"string"===typeof n?""+n.toUpperCase():"?"})),m=function e(t,n,i){void 0===i&&(i=!1);var r="";if(!GameCore.Utils.Valid.isObject(t))return r;var a="",s=1;for(var o in t)if(GameCore.Utils.Object.hasOwn(t,o)){var c=t[o];if(GameCore.Utils.Valid.isObject(c))r+=":"+e(c,n,!0);else if(GameCore.Utils.Valid.isString(c)){var h=f(c,n);h===a?(s++,r=r.slice(0,-2)):s=1,r+=""+s+h,a=h}}return r=r.replace(/1([A-Z])/g,"$1")},g=function(e){try{return atob(e)}catch(t){return""}},v={decodeMap:p,encodeMap:m,hashToString:g,stringToHash:function(e){try{return btoa(e)}catch(t){return""}}},y=function(e){try{return JSON.parse(e)}catch(t){return null}},E=function(e){try{return JSON.stringify(e,null,0)}catch(t){return""}},C=function(e){return y(E(e))},w={clone:C,decode:y,encode:E},A=function(e){var t="object"===typeof e||"function"===typeof e,n=Array.isArray(e);return null!==e&&t&&!n},b=function(e){return void 0===e||null===e},S=function e(t){if(!A(t))return t;for(var n in t){b(t[n])&&delete t[n];var i=t[n];A(i)&&(t[n]=e(i))}return t},T=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},x=function(e){var t={};return Object.keys(e).forEach((function(n){if(T(e,n)){var i=e[n];"string"===typeof i&&(t[i]=n)}})),t},k=function(e,t){if(!Array.isArray(e))return{};var n={};return e.forEach((function(e){if(T(e,t)){var i=e[t];"string"===typeof i&&(n[i]=e)}})),n},P=Object,I=function(e,t){if("assign"in P)return P.assign(e,t);var n=e;for(var i in t)n[i]=t[i];return n},O=function e(t,n){for(var i in n){var r;if(A(t[i])&&A(n[i]))e(t[i],n[i]);else I(t,((r={})[i]=n[i],r))}return t},R={clear:S,hasOwn:T,invert:x,keyBy:k,merge:O,assign:I},B=function(e){return e?e[0].toUpperCase()+e.slice(1):e},D=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t},L=function(e){return Object.keys(e).reduce((function(t,n){var i=e[n];return void 0!==i&&t.push(n+"="+i),t}),[]).join("&")},M=function(e){void 0===e&&(e="0x");for(var t=e,n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},_=n(27),N=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(e){return"\u0111"===e?"d":"D"}))},G=function(e,t){var n=e.split(" "),i=(n.length<=1?[].concat(n):[n[0],n.pop()]).join(" "),r=i.lastIndexOf(" ")||0,a=r>=0?r:t;return(i.length>t?i.substring(0,a):i).substring(0,t)},F=function(e){void 0===e&&(e=16);var t=function(t){return Math.floor(t).toString(e)};return t(Date.now()/1e3)+" ".repeat(e).replace(/./g,(function(){return t(Math.random()*e)}))},Z=n(28),U=function(e,t){var n=GameCore.Utils.String.removeDiacritics(e);return GameCore.Utils.String.getShortName(n,t)},W=n(26);var Y=function(e){for(var t=0,n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t=Math.abs(t)},H=["James","Mary","John","Patricia","Robert","Jennifer","Michael","Linda","William","Elizabeth","David","Susan","Richard","Jessica","Joseph","Sarah","Thomas","Karen","Charles","Nancy","Christopher","Lisa","Daniel","Margaret","Matthew","Betty","Anthony","Sandra","Mark","Ashley","Donald","Dorothy","Steven","Kimberly","Paul","Emily","Andrew","Donna","Joshua","Michelle","Kenneth","Carol","Kevin","Amanda","Brian","Melissa","George","Deborah"],z=["Smith","Johnson","Williams","Jones","Brown","Davis","Miller","Wilson","Moore","Taylor","Anderson","Thomas","Jackson","White","Harris","Martin","Thompson","Garcia","Martinez","Robinson","Clark","Rodriguez","Lewis","Lee","Walker","Hall","Allen","Young","Hernandez","King","Wright","Lopez","Hill","Scott","Green","Adams","Baker","Gonzalez","Nelson","Carter","Mitchell","Perez","Roberts","Turner","Phillips","Campbell","Parker","Evans"],K=function(e){var t=Y(e),n=t%H.length,i=(t>>8)%z.length,r=(t>>16)%1e4;return""+H[n]+z[i]+r},V={capitalize:B,hashCode:D,params:L,toCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toLowerCase()+t.substr(1)},toUpperCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},randomColor:M,randomName:W.Z,random:_.Z,removeDiacritics:N,getShortName:G,getShortNameWithNonDiacritic:U,generateObjectId:F,replaceVariables:Z.Z,generateNameUsingString:K},X={isBoolean:function(e){return"boolean"===typeof e},isDebugger:function(){return!1},isFunction:function(e){return"function"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:A,isPropertyKey:function(e){return["string","number","symbol"].indexOf(typeof e)>-1},isString:function(e){return"string"===typeof e},isValueChangeAsync:function(e,t,n){var i=n||{},r=i.timeout,a=void 0===r?1e3:r,s=i.checkInterval,o=void 0===s?100:s;return new Promise((function(n){var i=setInterval((function(){("function"===typeof e?e():e)===("function"===typeof t?t():t)&&(clearInterval(i),n(!0))}),o);a>0&&setTimeout((function(){clearInterval(i),n(!1)}),a)}))}},j=function(e){var t=e.scene,n=e.key,i=e.newKey,r=t.textures.get(n).getSourceImage();if(!r)return!1;var a=Math.min(r.width,r.height);i||t.textures.removeKey(n);var s=t.textures.createCanvas(i||n,a,a);s.setFilter(Phaser.Textures.FilterMode.LINEAR);var o=s.context;return o.beginPath(),o.arc(a/2,a/2,a/2,0,2*Math.PI,!1),o.clip(),s.draw((r.width-a)/2,(r.height-a)/2,r),!0},q=function(e){var t=e.scene,n=e.key,i=e.newKey,r=e.radius,a=e.width,s=e.height,o=t.textures.get(n).getSourceImage();if(!o)return!1;a||(a=o.width),s||(s=o.height),i||t.textures.removeKey(n);var c=t.textures.createCanvas(i||n,a,s);c.setFilter(Phaser.Textures.FilterMode.LINEAR);var h=c.context,u=Math.min(a,s)/100*r/2;return h.beginPath(),h.moveTo(0+u,0),h.lineTo(0+a-u,0),h.quadraticCurveTo(0+a,0,0+a,0+u),h.lineTo(0+a,0+s-u),h.quadraticCurveTo(0+a,0+s,0+a-u,0+s),h.lineTo(0+u,0+s),h.quadraticCurveTo(0,0+s,0,0+s-u),h.lineTo(0,0+u),h.quadraticCurveTo(0,0,0+u,0),h.closePath(),h.clip(),c.draw(0,0,o),!0};var J=function(){var e=GameCore.Utils.Device.pixelRatio(),t=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,r=n.clientHeight;return Math.max(r,i)||0}()*e;return GameCore.Utils.Device.isDesktop()&&(t*=1.25),t<840?2:t<1e3?2.67:3},Q=function(e,t){var n=e.split(","),i=n[0].match(/:(.*?);/);if(!i)return null;for(var r=i[1],a=atob(n[n.length-1]),s=a.length,o=new Uint8Array(s);s--;)o[s]=a.charCodeAt(s);return new File([o],t,{type:r})},$=new Image,ee=function(e,t){return void 0===t&&(t=!0),new Promise((function(n){t&&($=new Image),$.onload=function(){n($)},$.onerror=function(){n(null)},$.src=URL.createObjectURL(e)}))},te=n(5),ne=n(4),ie=n.n(ne),re=function(){var e=(0,te.Z)(ie().mark((function e(t,n){var i;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.blob()})).catch((function(){return null}));case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",new File([i],n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ae={drawCircle:j,drawBorder:q,getImageScale:J,base64ToFile:Q,blobToHtmlImage:ee,blobUrlToFile:re,frameToHtmlImage:n(29).Z},se=n(30),oe=function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),r=i.length,a=0;a<t-r;a++)i=n+i;return i},ce=function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),r=i.length,a=0;a<t-r;a++)i+=n;return i},he=function(e,t){var n=(t||{}).betweenCharacter,i=void 0===n?",":n,r=e.toString().split(".");return r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,i),r.join(".")},ue=function(e,t){void 0===t&&(t=1e5);var n=t;if((e=Math.floor(e))<n)return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");var i=e.toString();if(1e5<=e&&e<1e6)i=Math.floor(e/Math.pow(10,3)).toString()+"K";else if(1e6<=e&&e<1e8){var r=Math.floor(e/Math.pow(10,5)).toString(),a=r.length-1;i=r.slice(0,a)+"."+r.slice(a)+"M"}else if(1e8<=e&&e<1e9){i=Math.floor(e/Math.pow(10,6)).toString()+"M"}else if(1e9<=e){i=Math.floor(e/Math.pow(10,9)).toString()+"B"}return i.replace(/\B(?=(\d{3})+(?!\d))/g,".")},le=function(e,t){var n=t?Math.random()>.5?1:-1:1;return Math.floor(Math.random()*e)*n},de=n(31),pe={Array:o,Hash:v,Json:w,Object:R,String:V,Valid:X,Image:ae,Number:{toAbbreviatedString:se.Z,padStart:oe,padEnd:ce,numberWithCommas:he,formatNumber:ue,random:le,normalizeNumber:de.Z},Device:{isDesktop:function(){return!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)},isMobile:function(){return/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)},isAndroid:function(){return window.__fbPlatform?"ANDROID"===window.__fbPlatform:/Android/i.test(navigator.userAgent)},isIOS:function(){return window.__fbPlatform?"IOS"===window.__fbPlatform:/iPhone|iPad|iPod/i.test(navigator.userAgent)},isMobileWeb:function(){return window.__fbPlatform?"MOBILE_WEB"===window.__fbPlatform:/mobile/i.test(navigator.userAgent)},pixelRatio:function(){return window.devicePixelRatio||1}},Time:{isToday:function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},sleepAsync:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},Align:{topLeft:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(-i.width/2+e.width/2-t),e.setY(-i.height/2+e.height/2-n)}},bottomLeft:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(-i.width/2+e.width/2-t),e.setY(i.height/2-e.height/2+n)}},topRight:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(i.width/2-e.width/2+t),e.setY(-i.height/2+e.height/2-n)}},bottomRight:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(i.width/2-e.width/2+t),e.setY(i.height/2-e.height/2+n)}},leftCenter:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(-i.width/2+e.width/2-t),e.setY(n)}},rightCenter:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(i.width/2-e.width/2+t),e.setY(n)}},topCenter:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(t),e.setY(-i.height/2+e.height/2-n)}},bottomCenter:function(e,t,n){if(e.parentContainer){var i=e.parentContainer;e.setX(t),e.setY(i.height/2-e.height/2+n)}}}},fe=n(8),me=n(12),ge={ENV:"production",AppId:"solitaire-tripeaks-journey",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",Notification:{Enable:!0},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},Rollbar:{Enable:!1},WeeklyTournament:{Enable:!1,LevelStart:11,LeaderboardLimit:10,UseLeaderboardMock:!1,LeaderboardMockId:void 0},BoxingDuel:{Enable:!1,LevelStart:12,Duration:6e5,MaxScore:2e3,JustBot:!1,RewardCoin:500,MockOpponent:!0},OffshoreRace:{Enable:!0,LevelStart:13,RaceOpponentCount:4,RequiredLevels:8},Ads:{Enabled:!0,Mockup:{Enable:!1},AdServiceConfigs:{Google:{DataAdClient:"ca-pub-2993382360222769",DataAdFrequencyHint:30,DataAdBreakTest:!1,DataAdChannel:"8470678732"}},InterstitialAdOptions:{secondsFirstTime:30,secondsBetweenAds:30,showWhenStartGame:!1},LevelRequired:{Interstitial:4,Rewarded:5}},GameDecoration:{Enable:!0,Load32Bit:!1,MaxLocations:2},Analytics:{GoogleAnalytics:null,FacebookAnalytics:null}},ve={ENV:"production",AppId:"solitaire-tripeaks-journey",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",Notification:{Enable:!0},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},Rollbar:{Enable:!1},WeeklyTournament:{Enable:!1,LevelStart:11,LeaderboardLimit:10,UseLeaderboardMock:!1,LeaderboardMockId:void 0},BoxingDuel:{Enable:!1,LevelStart:12,Duration:6e5,MaxScore:2e3,JustBot:!1,RewardCoin:500,MockOpponent:!0},OffshoreRace:{Enable:!0,LevelStart:13,RaceOpponentCount:4,RequiredLevels:8},Ads:{Enabled:!0,Mockup:{Enable:!1},AdServiceConfigs:{Google:{DataAdClient:"ca-pub-2993382360222769",DataAdFrequencyHint:30,DataAdBreakTest:!1,DataAdChannel:"8470678732"}},InterstitialAdOptions:{secondsFirstTime:30,secondsBetweenAds:30,showWhenStartGame:!1},LevelRequired:{Interstitial:4,Rewarded:5}},GameDecoration:{Enable:!0,Load32Bit:!1,MaxLocations:2},Analytics:{GoogleAnalytics:null,FacebookAnalytics:null}},ye={ENV:"development",AppId:"solitaire-tripeaks-journey",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",SyncProfileFromAPI:!1,Notification:{Enable:!0,DisableSendNotification:!1,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Solitaire TriPeaks Journey",GameImage:"https://sunstudio.io/images/logo.png",DailyNotificationMessages:{MONDAY:"The journey awaits! Return to Solitaire TriPeaks and conquer the next peak! \ud83c\udfd4\ufe0f",TUESDAY:"Ready for some fun? Your next adventure is waiting for you. Jump back in now! \ud83d\ude80",WEDNESDAY:"Season of Adventure starts today! Collect rewards with each peak you clear during the season. \ud83c\udf81",THURSDAY:"Today\u2019s your lucky day! Find the Lucky Card to win a bonus reward on your journey! \ud83c\udf40",FRIDAY:"You've reached a major milestone on your journey! Log in to celebrate with a special reward! \ud83c\udfa1",SATURDAY:"You\u2019re on a roll! Keep your streak alive and earn extra rewards as you progress. \u2728",SUNDAY:"Only the best can conquer this peak! Up for the challenge? Show off your TriPeaks mastery! \ud83c\udf08"}},AddShortcut:{UseMock:!1},SubscribeBot:{UseMock:!1},PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,DefaultDiamondsForNewUser:300,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:2900,EnableVibrate:!0,ChallengeReward:{winCoinCount:500,loseCoinCount:0,drawCoinCount:250}},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{AutoResize:!0,PortraitRatio:360/590,PortraitWidth:360,PortraitHeight:590,LandscapeRatio:760/540,LandscapeWidth:760,LandscapeHeight:360,ForcePixelRatio:0,DisableLandscape:!1,FullSizeOnLandscape:!1},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8,ListPlayerDevIds:[]},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},ProfilerPlugin:{Enable:!1},CanvasRecorder:{Enable:!1,Options:{Type:"png",Quality:.85,RecordFps:60,SyncFps:!0}},Match:{MaxRescueCount:1,RescueGamePopupTimeout:15,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}}},DailyRewards:{MaxDays:7,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[],YourMockTournamentCount:1},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"5fbb6bee3f2485dac9b1dfa3",Limit:50,MockOptions:{PlayerEntryIndex:-1}},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,AdService:"msgames",FallbackService:"google",AdServiceConfigs:{Google:{DataAdClient:"",DataAdFrequencyHint:30,DataAdBreakTest:!1,MaxScriptLoadRetryCount:3}},CalculateSafeAreaBottom:!0,EnableRewardVideoResetInterstitial:!1,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{pID:"",showWhenStartGame:!1,secondsFirstTime:30,secondsBetweenAds:30},LevelRequired:{Interstitial:10,Rewarded:5},RewardAdOptions:{pID:"",secondsFirstTime:0,secondsBetweenAds:0},BannerAdOptions:[{placementId:"123",position:"bottom",bannerWidth:320,bannerHeight:50,platform:"MOBILE",secondsReload:60},{placementId:"456",position:"right",bannerWidth:160,bannerHeight:600,platform:"DESKTOP",secondsReload:60}]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GameAnalytics:{key:"",secret:"",consoleLog:!1,CustomDesignEvents:[{name:"level_start",dimensions:["level","boosters"],metrics:[]},{name:"level_end",dimensions:["level","boosters","success"],metrics:["add_cards_count_by_ad","add_cards_count_by_coin","coins","moves","remaining_pile_count","remaining_stock_count","streak_count","time_played","undo_count","wild_card_used_count"]},{name:"luck_reward",dimensions:[""],metrics:["value"]}]},GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed","Script error."]}},Rollbar:{Enable:!1,UseMockup:!1,FilterError:{Codes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{accepted:[],ignored:["Load image failed","Request failed to be processed","Script error."]}}},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0},Level:{url:"./assets/levels/",urlPortrait:"./assets/levels-portrait/",alwaysLoadNew:!1},GameplayDebugger:!1,RemoteConfigs:{MaxAddCardsByCoin:2,LuckyBar:5,Interstitial:3},WeeklyTournament:{Enable:!0,LevelStart:11,LeaderboardLimit:10,UseLeaderboardMock:!1,LeaderboardMockId:void 0,Rewards:{Top1:1,Top2:1,Top3:1,Top4:7,Top5:20}},BoxingDuel:{Enable:!0,LevelStart:12,Duration:6e5,MaxScore:2e3,JustBot:!1,RewardCoin:500,MockOpponent:!1},OffshoreRace:{Enable:!0,LevelStart:13,RaceOpponentCount:4,RequiredLevels:15,Duration:18e5},RequestFullScreenBeforeStart:!1,GameDecoration:{Enable:!0,Load32Bit:!1,MaxLocations:30}};ye=(0,me.TS)((0,fe.Z)({},ye),ve);var Ee=ye=(0,me.TS)((0,fe.Z)({},ye),ge),Ce=function(e){return function(t){try{var n=window.game,i=t.module;if(n.scene.getScenes(!0)[0].scene.key!==e)return;var r=i.default;n.scene.remove(e),n.scene.add(e,r,!0),n.scene.bringToTop(n.globalScene)}catch(s){var a;null==(a=void 0)||a.invalidate()}}},we=n(13),Ae=!1,be=function e(t,n,i){n.forEach((function(n){if(n.name){var r=null;if(r=i?i.getByName(n.name):t.children.getByName(n.name)){if("Container"===n.type){var a=r,s=n.getAll();if(e(t,s,a),!a.hotContainer)return}var o=Reflect.ownKeys(n),c=["_events","_sysEvents","input","localTransform","list","displayList"],h=o.filter((function(e){if("string"!==typeof e)return!1;if(c.indexOf(e)>=0)return!1;if(!r)return!1;var t=Reflect.get(n,e);return!(t instanceof Function)&&(!(t instanceof Phaser.Scene)&&(!(t instanceof Phaser.GameObjects.Group)&&(!(t instanceof Phaser.GameObjects.GameObject)&&t===Reflect.get(r,e))))}));h.length<1||h.forEach((function(e){if(r){var t=Reflect.get(n,e);Reflect.get(r,e),Reflect.set(r,e,t)}}))}}}))},Se={ImageScale:1,Configs:Ee,Utils:pe,LiveUpdate:{Scene:Ce,SceneObjects:function(e,t){return void 0===t&&(t=Ae),function(n){try{var i=window.game,r=n.module,a=i.scene.getScenes(!0)[0];if(a.scene.key!==e)return;Ae=t;var s=r.default,o=e+"-draft";i.scene.remove(o);var c=i.scene.add(o,s);a=i.scene.getScene(e),c.events.once(Phaser.Scenes.Events.RENDER,(0,we.D)((function(){var e=c.children.getAll();be(a,e),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(a),i.scene.bringToTop(i.globalScene)}catch(h){}}}}};window.GameCore=Se,Se.ImageScale=pe.Image.getImageScale();if(!pe.Valid.isDebugger()){var Te=function(){};console.log=Te,console.warn=Te,console.info=Te,console.error=Te,console.debug=Te,console.trace=Te,console.table=Te}},,function(e,t,n){"use strict";var i=n(2),r=n(1),a=n(0);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}window.SpinePlugin=function(){var e=Object.create,t=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,l=(n(59),function(e,n,i,r){if(n&&"object"===typeof n||"function"===typeof n)for(var a,h=function(){var s=a.value;u.call(e,s)||s===i||t(e,s,{get:function(){return n[s]},enumerable:!(r=o(n,s))||r.enumerable})},l=s(c(n));!(a=l()).done;)h();return e}),d=function(e,n,i){return function(e,n,i){n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i}(e,"symbol"!==typeof n?n+"":n,i),i},p={};if(function(e,n){for(var i in n)t(e,i,{get:n[i],enumerable:!0})}(p,{Alpha:function(){return $i},AlphaMixin:function(){return cr},AlphaTimeline:function(){return ue},Animation:function(){return Y},AnimationState:function(){return Be},AnimationStateAdapter:function(){return Fe},AnimationStateData:function(){return Ve},AssetManager:function(){return Hn},AssetManagerBase:function(){return yt},AtlasAttachmentLoader:function(){return pt},Attachment:function(){return M},AttachmentTimeline:function(){return pe},BinaryInput:function(){return Vt},BlendMode:function(){return Ht},Bone:function(){return gt},BoneData:function(){return ft},BoundingBoxAttachment:function(){return Xe},CURRENT:function(){return Ke},CameraController:function(){return pi},ClippingAttachment:function(){return je},Color:function(){return b},Color2Attribute:function(){return Ai},ColorAttribute:function(){return wi},ComputedSize:function(){return Ki},ComputedSizeMixin:function(){return tr},ConstraintData:function(){return vt},CurveTimeline:function(){return X},CurveTimeline1:function(){return j},CurveTimeline2:function(){return q},DebugUtils:function(){return O},DeformTimeline:function(){return fe},Depth:function(){return Vi},DepthMixin:function(){return nr},Downloader:function(){return Et},DrawOrderTimeline:function(){return ge},Event:function(){return Ct},EventData:function(){return wt},EventQueue:function(){return Ne},EventTimeline:function(){return me},EventType:function(){return Ge},FIRST:function(){return Ue},FakeTexture:function(){return et},Flip:function(){return Xi},FlipMixin:function(){return ir},GLTexture:function(){return Yn},HOLD_FIRST:function(){return Ye},HOLD_MIX:function(){return He},HOLD_SUBSEQUENT:function(){return We},IkConstraint:function(){return At},IkConstraintData:function(){return bt},IkConstraintTimeline:function(){return ve},Inherit:function(){return mt},InheritTimeline:function(){return oe},Input:function(){return li},IntSet:function(){return C},Interpolation:function(){return x},LoadingScreen:function(){return Ui},M00:function(){return Kn},M01:function(){return Vn},M02:function(){return Xn},M03:function(){return jn},M10:function(){return qn},M11:function(){return Jn},M12:function(){return Qn},M13:function(){return $n},M20:function(){return ei},M21:function(){return ti},M22:function(){return ni},M23:function(){return ii},M30:function(){return ri},M31:function(){return ai},M32:function(){return si},M33:function(){return oi},ManagedWebGLRenderingContext:function(){return Wn},MathUtils:function(){return T},Matrix4:function(){return hi},Mesh:function(){return gi},MeshAttachment:function(){return at},MixBlend:function(){return H},MixDirection:function(){return z},Origin:function(){return Qi},OriginMixin:function(){return or},OrthoCamera:function(){return ui},PathAttachment:function(){return st},PathConstraint:function(){return It},PathConstraintData:function(){return St},PathConstraintMixTimeline:function(){return we},PathConstraintPositionTimeline:function(){return Ee},PathConstraintSpacingTimeline:function(){return Ce},Physics:function(){return Gt},PhysicsConstraintDampingTimeline:function(){return Te},PhysicsConstraintGravityTimeline:function(){return Pe},PhysicsConstraintInertiaTimeline:function(){return be},PhysicsConstraintMassTimeline:function(){return xe},PhysicsConstraintMixTimeline:function(){return Ie},PhysicsConstraintResetTimeline:function(){return Oe},PhysicsConstraintStrengthTimeline:function(){return Se},PhysicsConstraintTimeline:function(){return Ae},PhysicsConstraintWindTimeline:function(){return ke},PointAttachment:function(){return ot},PolygonBatcher:function(){return Si},Pool:function(){return R},Position2Attribute:function(){return yi},Position3Attribute:function(){return Ei},PositionMode:function(){return Tt},Pow:function(){return k},PowOut:function(){return P},RGB2Timeline:function(){return de},RGBA2Timeline:function(){return le},RGBATimeline:function(){return ce},RGBTimeline:function(){return he},RegionAttachment:function(){return ct},ResizeMode:function(){return Gi},RotateMode:function(){return kt},RotateTimeline:function(){return J},SETUP:function(){return ze},SUBSEQUENT:function(){return Ze},ScaleTimeline:function(){return te},ScaleXTimeline:function(){return ne},ScaleYTimeline:function(){return ie},SceneRenderer:function(){return Ni},ScrollFactor:function(){return ji},ScrollFactorMixin:function(){return rr},SequenceTimeline:function(){return Re},SetupPoseBoundsProvider:function(){return ur},Shader:function(){return fi},ShapeRenderer:function(){return xi},ShapeType:function(){return ki},ShearTimeline:function(){return re},ShearXTimeline:function(){return ae},ShearYTimeline:function(){return se},Skeleton:function(){return Lt},SkeletonBinary:function(){return Kt},SkeletonBounds:function(){return Dn},SkeletonClipping:function(){return Mn},SkeletonData:function(){return Zt},SkeletonDebugRenderer:function(){return Pi},SkeletonJson:function(){return _n},SkeletonRenderer:function(){return Oi},Skin:function(){return Wt},SkinEntry:function(){return Ut},SkinsAndAnimationBoundsProvider:function(){return lr},Slot:function(){return Rt},SlotData:function(){return Yt},SpacingMode:function(){return xt},SpineCanvas:function(){return Hi},SpineGameObject:function(){return dr},SpinePlugin:function(){return gr},StringSet:function(){return w},TexCoordAttribute:function(){return Ci},Texture:function(){return qe},TextureAtlas:function(){return tt},TextureAtlasPage:function(){return it},TextureAtlasRegion:function(){return rt},TextureFilter:function(){return Je},TextureRegion:function(){return $e},TextureWrap:function(){return Qe},TimeKeeper:function(){return D},Timeline:function(){return V},Touch:function(){return di},TrackEntry:function(){return _e},Transform:function(){return qi},TransformConstraint:function(){return Bt},TransformConstraintData:function(){return zt},TransformConstraintTimeline:function(){return ye},TransformMixin:function(){return ar},TranslateTimeline:function(){return Q},TranslateXTimeline:function(){return $},TranslateYTimeline:function(){return ee},Triangulator:function(){return Ln},Utils:function(){return I},Vector2:function(){return B},Vector3:function(){return zn},VertexAttachment:function(){return _},VertexAttribute:function(){return vi},VertexAttributeType:function(){return bi},Visible:function(){return Ji},VisibleMixin:function(){return sr},WindowedMean:function(){return L},createMixin:function(){return er}}),"undefined"!==typeof window&&window.Phaser){var f=window.require;window.require=function(e){return f?f(e):"Phaser"===e?window.Phaser:void 0}}var m,g,v,y=(m=window.Phaser,g=1,v=null!=m?e(h(m)):{},l(!g&&m&&m.__esModule?v:t(v,"default",{value:m,enumerable:!0}),m)),E="spine",C=function(){function e(){this.array=new Array}var t=e.prototype;return t.add=function(e){var t=this.contains(e);return this.array[0|e]=0|e,!t},t.contains=function(e){return void 0!=this.array[0|e]},t.remove=function(e){this.array[0|e]=void 0},t.clear=function(){this.array.length=0},e}(),w=function(){function e(){this.entries={},this.size=0}var t=e.prototype;return t.add=function(e){var t=this.entries[e];return this.entries[e]=!0,!t&&(this.size++,!0)},t.addAll=function(e){for(var t=this.size,n=0,i=e.length;n<i;n++)this.add(e[n]);return t!=this.size},t.contains=function(e){return this.entries[e]},t.clear=function(){this.entries={},this.size=0},e}(),A=function(){function e(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.r=e,this.g=t,this.b=n,this.a=i}var t=e.prototype;return t.set=function(e,t,n,i){return this.r=e,this.g=t,this.b=n,this.a=i,this.clamp()},t.setFromColor=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},t.setFromString=function(e){return e="#"==e.charAt(0)?e.substr(1):e,this.r=parseInt(e.substr(0,2),16)/255,this.g=parseInt(e.substr(2,2),16)/255,this.b=parseInt(e.substr(4,2),16)/255,this.a=8!=e.length?1:parseInt(e.substr(6,2),16)/255,this},t.add=function(e,t,n,i){return this.r+=e,this.g+=t,this.b+=n,this.a+=i,this.clamp()},t.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},e.rgba8888ToColor=function(e,t){e.r=((4278190080&t)>>>24)/255,e.g=((16711680&t)>>>16)/255,e.b=((65280&t)>>>8)/255,e.a=(255&t)/255},e.rgb888ToColor=function(e,t){e.r=((16711680&t)>>>16)/255,e.g=((65280&t)>>>8)/255,e.b=(255&t)/255},t.toRgb888=function(){var e=function(e){return("0"+(255*e).toString(16)).slice(-2)};return Number("0x"+e(this.r)+e(this.g)+e(this.b))},e.fromString=function(t){return(new e).setFromString(t)},e}(),b=A;d(b,"WHITE",new A(1,1,1,1)),d(b,"RED",new A(1,0,0,1)),d(b,"GREEN",new A(0,1,0,1)),d(b,"BLUE",new A(0,0,1,1)),d(b,"MAGENTA",new A(1,0,1,1));var S=function(){function e(){}return e.clamp=function(e,t,n){return e<t?t:e>n?n:e},e.cosDeg=function(t){return Math.cos(t*e.degRad)},e.sinDeg=function(t){return Math.sin(t*e.degRad)},e.atan2Deg=function(t,n){return Math.atan2(t,n)*e.degRad},e.signum=function(e){return e>0?1:e<0?-1:0},e.toInt=function(e){return e>0?Math.floor(e):Math.ceil(e)},e.cbrt=function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},e.randomTriangular=function(t,n){return e.randomTriangularWith(t,n,.5*(t+n))},e.randomTriangularWith=function(e,t,n){var i=Math.random(),r=t-e;return i<=(n-e)/r?e+Math.sqrt(i*r*(n-e)):t-Math.sqrt((1-i)*r*(t-n))},e.isPowerOfTwo=function(e){return e&&0===(e&e-1)},e}(),T=S;d(T,"PI",3.1415927),d(T,"PI2",2*S.PI),d(T,"invPI2",1/S.PI2),d(T,"radiansToDegrees",180/S.PI),d(T,"radDeg",S.radiansToDegrees),d(T,"degreesToRadians",S.PI/180),d(T,"degRad",S.degreesToRadians);var x=function(){function e(){}return e.prototype.apply=function(e,t,n){return e+(t-e)*this.applyInternal(n)},e}(),k=function(e){function t(t){var n;return(n=e.call(this)||this).power=2,n.power=t,n}return(0,a.Z)(t,e),t.prototype.applyInternal=function(e){return e<=.5?Math.pow(2*e,this.power)/2:Math.pow(2*(e-1),this.power)/(this.power%2==0?-2:2)+1},t}(x),P=function(e){function t(t){return e.call(this,t)||this}return(0,a.Z)(t,e),t.prototype.applyInternal=function(e){return Math.pow(e-1,this.power)*(this.power%2==0?-1:1)+1},t}(k),I=function(){function e(){}return e.arrayCopy=function(e,t,n,i,r){for(var a=t,s=i;a<t+r;a++,s++)n[s]=e[a]},e.arrayFill=function(e,t,n,i){for(var r=t;r<n;r++)e[r]=i},e.setArraySize=function(e,t,n){void 0===n&&(n=0);var i=e.length;if(i==t)return e;if(e.length=t,i<t)for(var r=i;r<t;r++)e[r]=n;return e},e.ensureArrayCapacity=function(t,n,i){return void 0===i&&(i=0),t.length>=n?t:e.setArraySize(t,n,i)},e.newArray=function(e,t){for(var n=new Array(e),i=0;i<e;i++)n[i]=t;return n},e.newFloatArray=function(t){if(e.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var n=new Array(t),i=0;i<n.length;i++)n[i]=0;return n},e.newShortArray=function(t){if(e.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var n=new Array(t),i=0;i<n.length;i++)n[i]=0;return n},e.toFloatArray=function(t){return e.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},e.toSinglePrecision=function(t){return e.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t},e.webkit602BugfixHelper=function(e,t){},e.contains=function(e,t,n){void 0===n&&(n=!0);for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},e.enumValue=function(e,t){return e[t[0].toUpperCase()+t.slice(1)]},e}();d(I,"SUPPORTS_TYPED_ARRAYS","undefined"!==typeof Float32Array);var O=function(){function e(){}return e.logBones=function(e){for(var t=0;t<e.bones.length;t++)e.bones[t]},e}(),R=function(){function e(e){this.items=new Array,this.instantiator=void 0,this.instantiator=e}var t=e.prototype;return t.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},t.free=function(e){e.reset&&e.reset(),this.items.push(e)},t.freeAll=function(e){for(var t=0;t<e.length;t++)this.free(e[t])},t.clear=function(){this.items.length=0},e}(),B=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}var t=e.prototype;return t.set=function(e,t){return this.x=e,this.y=t,this},t.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},t.normalize=function(){var e=this.length();return 0!=e&&(this.x/=e,this.y/=e),this},e}(),D=function(){function e(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return e.prototype.update=function(){var e=Date.now()/1e3;this.delta=e-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=e,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},e}(),L=function(){function e(e){void 0===e&&(e=32),this.values=void 0,this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(e)}var t=e.prototype;return t.hasEnoughData=function(){return this.addedValues>=this.values.length},t.addValue=function(e){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=e,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},t.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var e=0,t=0;t<this.values.length;t++)e+=this.values[t];this.mean=e/this.values.length,this.dirty=!1}return this.mean}return 0},e}(),M=function(e){if(this.name=void 0,!e)throw new Error("name cannot be null.");this.name=e},_=function(e){function t(n){var i;return(i=e.call(this,n)||this).id=t.nextID++,i.bones=null,i.vertices=[],i.worldVerticesLength=0,i.timelineAttachment=(0,r.Z)(i),i}(0,a.Z)(t,e);var n=t.prototype;return n.computeWorldVertices=function(e,t,n,i,r,a){n=r+(n>>1)*a;var s=e.bone.skeleton,o=e.deform,c=this.vertices,h=this.bones;if(h){for(var u=0,l=0,d=0;d<t;d+=2){var p=h[u];u+=p+1,l+=p}var f=s.bones;if(0==o.length)for(var m=r,g=3*l;m<n;m+=a){var v=0,y=0,E=h[u++];for(E+=u;u<E;u++,g+=3){var C=f[h[u]],w=c[g],A=c[g+1],b=c[g+2];v+=(w*C.a+A*C.b+C.worldX)*b,y+=(w*C.c+A*C.d+C.worldY)*b}i[m]=v,i[m+1]=y}else for(var S=o,T=r,x=3*l,k=l<<1;T<n;T+=a){var P=0,I=0,O=h[u++];for(O+=u;u<O;u++,x+=3,k+=2){var R=f[h[u]],B=c[x]+S[k],D=c[x+1]+S[k+1],L=c[x+2];P+=(B*R.a+D*R.b+R.worldX)*L,I+=(B*R.c+D*R.d+R.worldY)*L}i[T]=P,i[T+1]=I}}else{o.length>0&&(c=o);for(var M=e.bone,_=M.worldX,N=M.worldY,G=M.a,F=M.b,Z=M.c,U=M.d,W=t,Y=r;Y<n;W+=2,Y+=a){var H=c[W],z=c[W+1];i[Y]=H*G+z*F+_,i[Y+1]=H*Z+z*U+N}}},n.copyTo=function(e){this.bones?(e.bones=new Array(this.bones.length),I.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=I.newFloatArray(this.vertices.length),I.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment},t}(M);d(_,"nextID",0);var N=function(){function e(t){this.id=e.nextID(),this.regions=void 0,this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}var t=e.prototype;return t.copy=function(){var t=new e(this.regions.length);return I.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t},t.apply=function(e,t){var n=e.sequenceIndex;-1==n&&(n=this.setupIndex),n>=this.regions.length&&(n=this.regions.length-1);var i=this.regions[n];t.region!=i&&(t.region=i,t.updateRegion())},t.getPath=function(e,t){for(var n=e,i=(this.start+t).toString(),r=this.digits-i.length;r>0;r--)n+="0";return n+=i},e.nextID=function(){return e._nextID++},e}();d(N,"_nextID",0);var G,F,Z,U=((G=U||{})[G.hold=0]="hold",G[G.once=1]="once",G[G.loop=2]="loop",G[G.pingpong=3]="pingpong",G[G.onceReverse=4]="onceReverse",G[G.loopReverse=5]="loopReverse",G[G.pingpongReverse=6]="pingpongReverse",G),W=[0,1,2,3,4,5,6],Y=function(){function e(e,t,n){if(this.name=void 0,this.timelines=[],this.timelineIds=new w,this.duration=void 0,!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=n}var t=e.prototype;return t.setTimelines=function(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(var t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())},t.hasTimeline=function(e){for(var t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1},t.apply=function(e,t,n,i,r,a,s,o){if(!e)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(n%=this.duration,t>0&&(t%=this.duration));for(var c=this.timelines,h=0,u=c.length;h<u;h++)c[h].apply(e,t,n,r,a,s,o)},e}(),H=((F=H||{})[F.setup=0]="setup",F[F.first=1]="first",F[F.replace=2]="replace",F[F.add=3]="add",F),z=((Z=z||{})[Z.mixIn=0]="mixIn",Z[Z.mixOut=1]="mixOut",Z),K={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28},V=function(){function e(e,t){this.propertyIds=void 0,this.frames=void 0,this.propertyIds=t,this.frames=I.newFloatArray(e*this.getFrameEntries())}var t=e.prototype;return t.getPropertyIds=function(){return this.propertyIds},t.getFrameEntries=function(){return 1},t.getFrameCount=function(){return this.frames.length/this.getFrameEntries()},t.getDuration=function(){return this.frames[this.frames.length-this.getFrameEntries()]},e.search1=function(e,t){for(var n=e.length,i=1;i<n;i++)if(e[i]>t)return i-1;return n-1},e.search=function(e,t,n){for(var i=e.length,r=n;r<i;r+=n)if(e[r]>t)return r-n;return i-n},e}(),X=function(e){function t(t,n,i){var r;return(r=e.call(this,t,i)||this).curves=void 0,r.curves=I.newFloatArray(t+18*n),r.curves[t-1]=1,r}(0,a.Z)(t,e);var n=t.prototype;return n.setLinear=function(e){this.curves[e]=0},n.setStepped=function(e){this.curves[e]=1},n.shrink=function(e){var t=this.getFrameCount()+18*e;if(this.curves.length>t){var n=I.newFloatArray(t);I.arrayCopy(this.curves,0,n,0,t),this.curves=n}},n.setBezier=function(e,t,n,i,r,a,s,o,c,h,u){var l=this.curves,d=this.getFrameCount()+18*e;0==n&&(l[t]=2+d);for(var p=.03*(i-2*a+o),f=.03*(r-2*s+c),m=.006*(3*(a-o)-i+h),g=.006*(3*(s-c)-r+u),v=2*p+m,y=2*f+g,E=.3*(a-i)+p+.16666667*m,C=.3*(s-r)+f+.16666667*g,w=i+E,A=r+C,b=d+18;d<b;d+=2)l[d]=w,l[d+1]=A,E+=v,C+=y,v+=m,y+=g,w+=E,A+=C},n.getBezierValue=function(e,t,n,i){var r=this.curves;if(r[i]>e){var a=this.frames[t],s=this.frames[t+n];return s+(e-a)/(r[i]-a)*(r[i+1]-s)}var o=i+18;for(i+=2;i<o;i+=2)if(r[i]>=e){var c=r[i-2],h=r[i-1];return h+(e-c)/(r[i]-c)*(r[i+1]-h)}t+=this.getFrameEntries();var u=r[o-2],l=r[o-1];return l+(e-u)/(this.frames[t]-u)*(this.frames[t+n]-l)},t}(V),j=function(e){function t(t,n,i){return e.call(this,t,n,[i])||this}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 2},n.setFrame=function(e,t,n){e<<=1,this.frames[e]=t,this.frames[e+1]=n},n.getCurveValue=function(e){for(var t=this.frames,n=t.length-2,i=2;i<=n;i+=2)if(t[i]>e){n=i-2;break}var r=this.curves[n>>1];switch(r){case 0:var a=t[n],s=t[n+1];return s+(e-a)/(t[n+2]-a)*(t[n+2+1]-s);case 1:return t[n+1]}return this.getBezierValue(e,n,1,r-2)},n.getRelativeValue=function(e,t,n,i,r){if(e<this.frames[0]){switch(n){case 0:return r;case 1:return i+(r-i)*t}return i}var a=this.getCurveValue(e);switch(n){case 0:return r+a*t;case 1:case 2:a+=r-i}return i+a*t},n.getAbsoluteValue=function(e,t,n,i,r){if(e<this.frames[0]){switch(n){case 0:return r;case 1:return i+(r-i)*t}return i}var a=this.getCurveValue(e);return 0==n?r+(a-r)*t:i+(a-i)*t},n.getAbsoluteValue2=function(e,t,n,i,r,a){if(e<this.frames[0]){switch(n){case 0:return r;case 1:return i+(r-i)*t}return i}return 0==n?r+(a-r)*t:i+(a-i)*t},n.getScaleValue=function(e,t,n,i,r,a){if(e<this.frames[0]){switch(n){case 0:return a;case 1:return r+(a-r)*t}return r}var s=this.getCurveValue(e)*a;if(1==t)return 3==n?r+s-a:s;if(1==i)switch(n){case 0:return a+(Math.abs(s)*T.signum(a)-a)*t;case 1:case 2:return r+(Math.abs(s)*T.signum(r)-r)*t}else{var o=0;switch(n){case 0:return(o=Math.abs(a)*T.signum(s))+(s-o)*t;case 1:case 2:return(o=Math.abs(r)*T.signum(s))+(s-o)*t}}return r+(s-a)*t},t}(X),q=function(e){function t(t,n,i,r){return e.call(this,t,n,[i,r])||this}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 3},n.setFrame=function(e,t,n,i){e*=3,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i},t}(X),J=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.rotate+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.rotation=this.getRelativeValue(n,r,a,o.rotation,o.data.rotation))},t}(j),Q=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.x+"|"+i,K.y+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];if(o.active){var c=this.frames;if(n<c[0])switch(a){case 0:return o.x=o.data.x,void(o.y=o.data.y);case 1:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}else{var h=0,u=0,l=V.search(c,n,3),d=this.curves[l/3];switch(d){case 0:var p=c[l];h=c[l+1],u=c[l+2];var f=(n-p)/(c[l+3]-p);h+=(c[l+3+1]-h)*f,u+=(c[l+3+2]-u)*f;break;case 1:h=c[l+1],u=c[l+2];break;default:h=this.getBezierValue(n,l,1,d-2),u=this.getBezierValue(n,l,2,d+18-2)}switch(a){case 0:o.x=o.data.x+h*r,o.y=o.data.y+u*r;break;case 1:case 2:o.x+=(o.data.x+h-o.x)*r,o.y+=(o.data.y+u-o.y)*r;break;case 3:o.x+=h*r,o.y+=u*r}}}},t}(q),$=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.x+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.x=this.getRelativeValue(n,r,a,o.x,o.data.x))},t}(j),ee=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.y+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.y=this.getRelativeValue(n,r,a,o.y,o.data.y))},t}(j),te=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.scaleX+"|"+i,K.scaleY+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];if(o.active){var c=this.frames;if(n<c[0])switch(a){case 0:return o.scaleX=o.data.scaleX,void(o.scaleY=o.data.scaleY);case 1:o.scaleX+=(o.data.scaleX-o.scaleX)*r,o.scaleY+=(o.data.scaleY-o.scaleY)*r}else{var h,u,l=V.search(c,n,3),d=this.curves[l/3];switch(d){case 0:var p=c[l];h=c[l+1],u=c[l+2];var f=(n-p)/(c[l+3]-p);h+=(c[l+3+1]-h)*f,u+=(c[l+3+2]-u)*f;break;case 1:h=c[l+1],u=c[l+2];break;default:h=this.getBezierValue(n,l,1,d-2),u=this.getBezierValue(n,l,2,d+18-2)}if(h*=o.data.scaleX,u*=o.data.scaleY,1==r)3==a?(o.scaleX+=h-o.data.scaleX,o.scaleY+=u-o.data.scaleY):(o.scaleX=h,o.scaleY=u);else{var m=0,g=0;if(1==s)switch(a){case 0:m=o.data.scaleX,g=o.data.scaleY,o.scaleX=m+(Math.abs(h)*T.signum(m)-m)*r,o.scaleY=g+(Math.abs(u)*T.signum(g)-g)*r;break;case 1:case 2:m=o.scaleX,g=o.scaleY,o.scaleX=m+(Math.abs(h)*T.signum(m)-m)*r,o.scaleY=g+(Math.abs(u)*T.signum(g)-g)*r;break;case 3:o.scaleX+=(h-o.data.scaleX)*r,o.scaleY+=(u-o.data.scaleY)*r}else switch(a){case 0:m=Math.abs(o.data.scaleX)*T.signum(h),g=Math.abs(o.data.scaleY)*T.signum(u),o.scaleX=m+(h-m)*r,o.scaleY=g+(u-g)*r;break;case 1:case 2:m=Math.abs(o.scaleX)*T.signum(h),g=Math.abs(o.scaleY)*T.signum(u),o.scaleX=m+(h-m)*r,o.scaleY=g+(u-g)*r;break;case 3:o.scaleX+=(h-o.data.scaleX)*r,o.scaleY+=(u-o.data.scaleY)*r}}}}},t}(q),ne=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.scaleX+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.scaleX=this.getScaleValue(n,r,a,s,o.scaleX,o.data.scaleX))},t}(j),ie=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.scaleY+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.scaleY=this.getScaleValue(n,r,a,s,o.scaleY,o.data.scaleY))},t}(j),re=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.shearX+"|"+i,K.shearY+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];if(o.active){var c=this.frames;if(n<c[0])switch(a){case 0:return o.shearX=o.data.shearX,void(o.shearY=o.data.shearY);case 1:o.shearX+=(o.data.shearX-o.shearX)*r,o.shearY+=(o.data.shearY-o.shearY)*r}else{var h=0,u=0,l=V.search(c,n,3),d=this.curves[l/3];switch(d){case 0:var p=c[l];h=c[l+1],u=c[l+2];var f=(n-p)/(c[l+3]-p);h+=(c[l+3+1]-h)*f,u+=(c[l+3+2]-u)*f;break;case 1:h=c[l+1],u=c[l+2];break;default:h=this.getBezierValue(n,l,1,d-2),u=this.getBezierValue(n,l,2,d+18-2)}switch(a){case 0:o.shearX=o.data.shearX+h*r,o.shearY=o.data.shearY+u*r;break;case 1:case 2:o.shearX+=(o.data.shearX+h-o.shearX)*r,o.shearY+=(o.data.shearY+u-o.shearY)*r;break;case 3:o.shearX+=h*r,o.shearY+=u*r}}}},t}(q),ae=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.shearX+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.shearX=this.getRelativeValue(n,r,a,o.shearX,o.data.shearX))},t}(j),se=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.shearY+"|"+i)||this).boneIndex=0,r.boneIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];o.active&&(o.shearY=this.getRelativeValue(n,r,a,o.shearY,o.data.shearY))},t}(j),oe=function(e){function t(t,n){var i;return(i=e.call(this,t,[K.inherit+"|"+n])||this).boneIndex=0,i.boneIndex=n,i}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 2},n.setFrame=function(e,t,n){e*=2,this.frames[e]=t,this.frames[e+1]=n},n.apply=function(e,t,n,i,r,a,s){var o=e.bones[this.boneIndex];if(o.active){var c=this.frames;n<c[0]?0!=a&&1!=a||(o.inherit=o.data.inherit):o.inherit=this.frames[V.search(c,n,2)+1]}},t}(V),ce=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.rgb+"|"+i,K.alpha+"|"+i])||this).slotIndex=0,r.slotIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 5},n.setFrame=function(e,t,n,i,r,a){e*=5,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i,this.frames[e+3]=r,this.frames[e+4]=a},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=this.frames,h=o.color;if(n<c[0]){var u=o.data.color;switch(a){case 0:return void h.setFromColor(u);case 1:h.add((u.r-h.r)*r,(u.g-h.g)*r,(u.b-h.b)*r,(u.a-h.a)*r)}}else{var l=0,d=0,p=0,f=0,m=V.search(c,n,5),g=this.curves[m/5];switch(g){case 0:var v=c[m];l=c[m+1],d=c[m+2],p=c[m+3],f=c[m+4];var y=(n-v)/(c[m+5]-v);l+=(c[m+5+1]-l)*y,d+=(c[m+5+2]-d)*y,p+=(c[m+5+3]-p)*y,f+=(c[m+5+4]-f)*y;break;case 1:l=c[m+1],d=c[m+2],p=c[m+3],f=c[m+4];break;default:l=this.getBezierValue(n,m,1,g-2),d=this.getBezierValue(n,m,2,g+18-2),p=this.getBezierValue(n,m,3,g+36-2),f=this.getBezierValue(n,m,4,g+54-2)}1==r?h.set(l,d,p,f):(0==a&&h.setFromColor(o.data.color),h.add((l-h.r)*r,(d-h.g)*r,(p-h.b)*r,(f-h.a)*r))}}},t}(X),he=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.rgb+"|"+i])||this).slotIndex=0,r.slotIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 4},n.setFrame=function(e,t,n,i,r){e<<=2,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i,this.frames[e+3]=r},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=this.frames,h=o.color;if(n<c[0]){var u=o.data.color;switch(a){case 0:return h.r=u.r,h.g=u.g,void(h.b=u.b);case 1:h.r+=(u.r-h.r)*r,h.g+=(u.g-h.g)*r,h.b+=(u.b-h.b)*r}}else{var l=0,d=0,p=0,f=V.search(c,n,4),m=this.curves[f>>2];switch(m){case 0:var g=c[f];l=c[f+1],d=c[f+2],p=c[f+3];var v=(n-g)/(c[f+4]-g);l+=(c[f+4+1]-l)*v,d+=(c[f+4+2]-d)*v,p+=(c[f+4+3]-p)*v;break;case 1:l=c[f+1],d=c[f+2],p=c[f+3];break;default:l=this.getBezierValue(n,f,1,m-2),d=this.getBezierValue(n,f,2,m+18-2),p=this.getBezierValue(n,f,3,m+36-2)}if(1==r)h.r=l,h.g=d,h.b=p;else{if(0==a){var y=o.data.color;h.r=y.r,h.g=y.g,h.b=y.b}h.r+=(l-h.r)*r,h.g+=(d-h.g)*r,h.b+=(p-h.b)*r}}}},t}(X),ue=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.alpha+"|"+i)||this).slotIndex=0,r.slotIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=o.color;if(n<this.frames[0]){var h=o.data.color;switch(a){case 0:return void(c.a=h.a);case 1:c.a+=(h.a-c.a)*r}}else{var u=this.getCurveValue(n);1==r?c.a=u:(0==a&&(c.a=o.data.color.a),c.a+=(u-c.a)*r)}}},t}(j),le=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.rgb+"|"+i,K.alpha+"|"+i,K.rgb2+"|"+i])||this).slotIndex=0,r.slotIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 8},n.setFrame=function(e,t,n,i,r,a,s,o,c){e<<=3,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i,this.frames[e+3]=r,this.frames[e+4]=a,this.frames[e+5]=s,this.frames[e+6]=o,this.frames[e+7]=c},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=this.frames,h=o.color,u=o.darkColor;if(n<c[0]){var l=o.data.color,d=o.data.darkColor;switch(a){case 0:return h.setFromColor(l),u.r=d.r,u.g=d.g,void(u.b=d.b);case 1:h.add((l.r-h.r)*r,(l.g-h.g)*r,(l.b-h.b)*r,(l.a-h.a)*r),u.r+=(d.r-u.r)*r,u.g+=(d.g-u.g)*r,u.b+=(d.b-u.b)*r}}else{var p=0,f=0,m=0,g=0,v=0,y=0,E=0,C=V.search(c,n,8),w=this.curves[C>>3];switch(w){case 0:var A=c[C];p=c[C+1],f=c[C+2],m=c[C+3],g=c[C+4],v=c[C+5],y=c[C+6],E=c[C+7];var b=(n-A)/(c[C+8]-A);p+=(c[C+8+1]-p)*b,f+=(c[C+8+2]-f)*b,m+=(c[C+8+3]-m)*b,g+=(c[C+8+4]-g)*b,v+=(c[C+8+5]-v)*b,y+=(c[C+8+6]-y)*b,E+=(c[C+8+7]-E)*b;break;case 1:p=c[C+1],f=c[C+2],m=c[C+3],g=c[C+4],v=c[C+5],y=c[C+6],E=c[C+7];break;default:p=this.getBezierValue(n,C,1,w-2),f=this.getBezierValue(n,C,2,w+18-2),m=this.getBezierValue(n,C,3,w+36-2),g=this.getBezierValue(n,C,4,w+54-2),v=this.getBezierValue(n,C,5,w+72-2),y=this.getBezierValue(n,C,6,w+90-2),E=this.getBezierValue(n,C,7,w+108-2)}if(1==r)h.set(p,f,m,g),u.r=v,u.g=y,u.b=E;else{if(0==a){h.setFromColor(o.data.color);var S=o.data.darkColor;u.r=S.r,u.g=S.g,u.b=S.b}h.add((p-h.r)*r,(f-h.g)*r,(m-h.b)*r,(g-h.a)*r),u.r+=(v-u.r)*r,u.g+=(y-u.g)*r,u.b+=(E-u.b)*r}}}},t}(X),de=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.rgb+"|"+i,K.rgb2+"|"+i])||this).slotIndex=0,r.slotIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 7},n.setFrame=function(e,t,n,i,r,a,s,o){e*=7,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i,this.frames[e+3]=r,this.frames[e+4]=a,this.frames[e+5]=s,this.frames[e+6]=o},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=this.frames,h=o.color,u=o.darkColor;if(n<c[0]){var l=o.data.color,d=o.data.darkColor;switch(a){case 0:return h.r=l.r,h.g=l.g,h.b=l.b,u.r=d.r,u.g=d.g,void(u.b=d.b);case 1:h.r+=(l.r-h.r)*r,h.g+=(l.g-h.g)*r,h.b+=(l.b-h.b)*r,u.r+=(d.r-u.r)*r,u.g+=(d.g-u.g)*r,u.b+=(d.b-u.b)*r}}else{var p=0,f=0,m=0,g=0,v=0,y=0,E=V.search(c,n,7),C=this.curves[E/7];switch(C){case 0:var w=c[E];p=c[E+1],f=c[E+2],m=c[E+3],g=c[E+4],v=c[E+5],y=c[E+6];var A=(n-w)/(c[E+7]-w);p+=(c[E+7+1]-p)*A,f+=(c[E+7+2]-f)*A,m+=(c[E+7+3]-m)*A,g+=(c[E+7+4]-g)*A,v+=(c[E+7+5]-v)*A,y+=(c[E+7+6]-y)*A;break;case 1:p=c[E+1],f=c[E+2],m=c[E+3],g=c[E+4],v=c[E+5],y=c[E+6];break;default:p=this.getBezierValue(n,E,1,C-2),f=this.getBezierValue(n,E,2,C+18-2),m=this.getBezierValue(n,E,3,C+36-2),g=this.getBezierValue(n,E,4,C+54-2),v=this.getBezierValue(n,E,5,C+72-2),y=this.getBezierValue(n,E,6,C+90-2)}if(1==r)h.r=p,h.g=f,h.b=m,u.r=g,u.g=v,u.b=y;else{if(0==a){var b=o.data.color,S=o.data.darkColor;h.r=b.r,h.g=b.g,h.b=b.b,u.r=S.r,u.g=S.g,u.b=S.b}h.r+=(p-h.r)*r,h.g+=(f-h.g)*r,h.b+=(m-h.b)*r,u.r+=(g-u.r)*r,u.g+=(v-u.g)*r,u.b+=(y-u.b)*r}}}},t}(X),pe=function(e){function t(t,n){var i;return(i=e.call(this,t,[K.attachment+"|"+n])||this).slotIndex=0,i.attachmentNames=void 0,i.slotIndex=n,i.attachmentNames=new Array(t),i}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameCount=function(){return this.frames.length},n.setFrame=function(e,t,n){this.frames[e]=t,this.attachmentNames[e]=n},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];o.bone.active&&(1!=s?n<this.frames[0]?0!=a&&1!=a||this.setAttachment(e,o,o.data.attachmentName):this.setAttachment(e,o,this.attachmentNames[V.search1(this.frames,n)]):0==a&&this.setAttachment(e,o,o.data.attachmentName))},n.setAttachment=function(e,t,n){t.setAttachment(n?e.getAttachment(this.slotIndex,n):null)},t}(V),fe=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,[K.deform+"|"+i+"|"+r.id])||this).slotIndex=0,a.attachment=void 0,a.vertices=void 0,a.slotIndex=i,a.attachment=r,a.vertices=new Array(t),a}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameCount=function(){return this.frames.length},n.setFrame=function(e,t,n){this.frames[e]=t,this.vertices[e]=n},n.setBezier=function(e,t,n,i,r,a,s,o,c,h,u){var l=this.curves,d=this.getFrameCount()+18*e;0==n&&(l[t]=2+d);for(var p=.03*(i-2*a+o),f=.03*c-.06*s,m=.006*(3*(a-o)-i+h),g=.018*(s-c+.33333333),v=2*p+m,y=2*f+g,E=.3*(a-i)+p+.16666667*m,C=.3*s+f+.16666667*g,w=i+E,A=C,b=d+18;d<b;d+=2)l[d]=w,l[d+1]=A,E+=v,C+=y,v+=m,y+=g,w+=E,A+=C},n.getCurvePercent=function(e,t){var n=this.curves,i=n[t];switch(i){case 0:var r=this.frames[t];return(e-r)/(this.frames[t+this.getFrameEntries()]-r);case 1:return 0}if(n[i-=2]>e){var a=this.frames[t];return n[i+1]*(e-a)/(n[i]-a)}var s=i+18;for(i+=2;i<s;i+=2)if(n[i]>=e){var o=n[i-2],c=n[i-1];return c+(e-o)/(n[i]-o)*(n[i+1]-c)}var h=n[s-2],u=n[s-1];return u+(1-u)*(e-h)/(this.frames[t+this.getFrameEntries()]-h)},n.apply=function(e,t,n,i,r,a,s){var o=e.slots[this.slotIndex];if(o.bone.active){var c=o.getAttachment();if(c&&c instanceof _&&c.timelineAttachment==this.attachment){var h=o.deform;0==h.length&&(a=0);var u=this.vertices,l=u[0].length,d=this.frames;if(n<d[0])switch(a){case 0:return void(h.length=0);case 1:if(1==r)return void(h.length=0);h.length=l;var p=c;if(p.bones){r=1-r;for(m=0;m<l;m++)h[m]*=r}else for(var f=p.vertices,m=0;m<l;m++)h[m]+=(f[m]-h[m])*r}else if(h.length=l,n>=d[d.length-1]){var g=u[d.length-1];if(1==r)if(3==a){var v=c;if(v.bones)for(var y=0;y<l;y++)h[y]+=g[y];else for(var E=v.vertices,C=0;C<l;C++)h[C]+=g[C]-E[C]}else I.arrayCopy(g,0,h,0,l);else switch(a){case 0:var w=c;if(w.bones)for(var A=0;A<l;A++)h[A]=g[A]*r;else for(var b=w.vertices,S=0;S<l;S++){var T=b[S];h[S]=T+(g[S]-T)*r}break;case 1:case 2:for(var x=0;x<l;x++)h[x]+=(g[x]-h[x])*r;break;case 3:var k=c;if(k.bones)for(var P=0;P<l;P++)h[P]+=g[P]*r;else for(var O=k.vertices,R=0;R<l;R++)h[R]+=(g[R]-O[R])*r}}else{var B=V.search1(d,n),D=this.getCurvePercent(n,B),L=u[B],M=u[B+1];if(1==r)if(3==a){var N=c;if(N.bones)for(var G=0;G<l;G++){var F=L[G];h[G]+=F+(M[G]-F)*D}else for(var Z=N.vertices,U=0;U<l;U++){var W=L[U];h[U]+=W+(M[U]-W)*D-Z[U]}}else for(var Y=0;Y<l;Y++){var H=L[Y];h[Y]=H+(M[Y]-H)*D}else switch(a){case 0:var z=c;if(z.bones)for(var K=0;K<l;K++){var X=L[K];h[K]=(X+(M[K]-X)*D)*r}else for(var j=z.vertices,q=0;q<l;q++){var J=L[q],Q=j[q];h[q]=Q+(J+(M[q]-J)*D-Q)*r}break;case 1:case 2:for(var $=0;$<l;$++){var ee=L[$];h[$]+=(ee+(M[$]-ee)*D-h[$])*r}break;case 3:var te=c;if(te.bones)for(var ne=0;ne<l;ne++){var ie=L[ne];h[ne]+=(ie+(M[ne]-ie)*D)*r}else for(var re=te.vertices,ae=0;ae<l;ae++){var se=L[ae];h[ae]+=(se+(M[ae]-se)*D-re[ae])*r}}}}}},t}(X),me=function(e){function t(n){var i;return(i=e.call(this,n,t.propertyIds)||this).events=void 0,i.events=new Array(n),i}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameCount=function(){return this.frames.length},n.setFrame=function(e,t){this.frames[e]=t.time,this.events[e]=t},n.apply=function(e,t,n,i,r,a,s){if(i){var o=this.frames,c=this.frames.length;if(t>n)this.apply(e,t,Number.MAX_VALUE,i,r,a,s),t=-1;else if(t>=o[c-1])return;if(!(n<o[0])){var h=0;if(t<o[0])h=0;else for(var u=o[h=V.search1(o,t)+1];h>0&&o[h-1]==u;)h--;for(;h<c&&n>=o[h];h++)i.push(this.events[h])}}},t}(V);d(me,"propertyIds",[""+K.event]);var ge=function(e){function t(n){var i;return(i=e.call(this,n,t.propertyIds)||this).drawOrders=void 0,i.drawOrders=new Array(n),i}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameCount=function(){return this.frames.length},n.setFrame=function(e,t,n){this.frames[e]=t,this.drawOrders[e]=n},n.apply=function(e,t,n,i,r,a,s){if(1!=s)if(n<this.frames[0])0!=a&&1!=a||I.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{var o=V.search1(this.frames,n),c=this.drawOrders[o];if(c)for(var h=e.drawOrder,u=e.slots,l=0,d=c.length;l<d;l++)h[l]=u[c[l]];else I.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)}else 0==a&&I.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)},t}(V);d(ge,"propertyIds",[""+K.drawOrder]);var ve=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.ikConstraint+"|"+i])||this).constraintIndex=0,r.constraintIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 6},n.setFrame=function(e,t,n,i,r,a,s){e*=6,this.frames[e]=t,this.frames[e+1]=n,this.frames[e+2]=i,this.frames[e+3]=r,this.frames[e+4]=a?1:0,this.frames[e+5]=s?1:0},n.apply=function(e,t,n,i,r,a,s){var o=e.ikConstraints[this.constraintIndex];if(o.active){var c=this.frames;if(n<c[0])switch(a){case 0:return o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,void(o.stretch=o.data.stretch);case 1:o.mix+=(o.data.mix-o.mix)*r,o.softness+=(o.data.softness-o.softness)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}else{var h=0,u=0,l=V.search(c,n,6),d=this.curves[l/6];switch(d){case 0:var p=c[l];h=c[l+1],u=c[l+2];var f=(n-p)/(c[l+6]-p);h+=(c[l+6+1]-h)*f,u+=(c[l+6+2]-u)*f;break;case 1:h=c[l+1],u=c[l+2];break;default:h=this.getBezierValue(n,l,1,d-2),u=this.getBezierValue(n,l,2,d+18-2)}0==a?(o.mix=o.data.mix+(h-o.data.mix)*r,o.softness=o.data.softness+(u-o.data.softness)*r,1==s?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=c[l+3],o.compress=0!=c[l+4],o.stretch=0!=c[l+5])):(o.mix+=(h-o.mix)*r,o.softness+=(u-o.softness)*r,0==s&&(o.bendDirection=c[l+3],o.compress=0!=c[l+4],o.stretch=0!=c[l+5]))}}},t}(X),ye=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.transformConstraint+"|"+i])||this).constraintIndex=0,r.constraintIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 7},n.setFrame=function(e,t,n,i,r,a,s,o){var c=this.frames;c[e*=7]=t,c[e+1]=n,c[e+2]=i,c[e+3]=r,c[e+4]=a,c[e+5]=s,c[e+6]=o},n.apply=function(e,t,n,i,r,a,s){var o=e.transformConstraints[this.constraintIndex];if(o.active){var c=this.frames;if(n<c[0]){var h=o.data;switch(a){case 0:return o.mixRotate=h.mixRotate,o.mixX=h.mixX,o.mixY=h.mixY,o.mixScaleX=h.mixScaleX,o.mixScaleY=h.mixScaleY,void(o.mixShearY=h.mixShearY);case 1:o.mixRotate+=(h.mixRotate-o.mixRotate)*r,o.mixX+=(h.mixX-o.mixX)*r,o.mixY+=(h.mixY-o.mixY)*r,o.mixScaleX+=(h.mixScaleX-o.mixScaleX)*r,o.mixScaleY+=(h.mixScaleY-o.mixScaleY)*r,o.mixShearY+=(h.mixShearY-o.mixShearY)*r}}else{var u,l,d,p,f,m,g=V.search(c,n,7),v=this.curves[g/7];switch(v){case 0:var y=c[g];u=c[g+1],l=c[g+2],d=c[g+3],p=c[g+4],f=c[g+5],m=c[g+6];var E=(n-y)/(c[g+7]-y);u+=(c[g+7+1]-u)*E,l+=(c[g+7+2]-l)*E,d+=(c[g+7+3]-d)*E,p+=(c[g+7+4]-p)*E,f+=(c[g+7+5]-f)*E,m+=(c[g+7+6]-m)*E;break;case 1:u=c[g+1],l=c[g+2],d=c[g+3],p=c[g+4],f=c[g+5],m=c[g+6];break;default:u=this.getBezierValue(n,g,1,v-2),l=this.getBezierValue(n,g,2,v+18-2),d=this.getBezierValue(n,g,3,v+36-2),p=this.getBezierValue(n,g,4,v+54-2),f=this.getBezierValue(n,g,5,v+72-2),m=this.getBezierValue(n,g,6,v+90-2)}if(0==a){var C=o.data;o.mixRotate=C.mixRotate+(u-C.mixRotate)*r,o.mixX=C.mixX+(l-C.mixX)*r,o.mixY=C.mixY+(d-C.mixY)*r,o.mixScaleX=C.mixScaleX+(p-C.mixScaleX)*r,o.mixScaleY=C.mixScaleY+(f-C.mixScaleY)*r,o.mixShearY=C.mixShearY+(m-C.mixShearY)*r}else o.mixRotate+=(u-o.mixRotate)*r,o.mixX+=(l-o.mixX)*r,o.mixY+=(d-o.mixY)*r,o.mixScaleX+=(p-o.mixScaleX)*r,o.mixScaleY+=(f-o.mixScaleY)*r,o.mixShearY+=(m-o.mixShearY)*r}}},t}(X),Ee=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.pathConstraintPosition+"|"+i)||this).constraintIndex=0,r.constraintIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.pathConstraints[this.constraintIndex];o.active&&(o.position=this.getAbsoluteValue(n,r,a,o.position,o.data.position))},t}(j),Ce=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,K.pathConstraintSpacing+"|"+i)||this).constraintIndex=0,r.constraintIndex=i,r}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,s){var o=e.pathConstraints[this.constraintIndex];o.active&&(o.spacing=this.getAbsoluteValue(n,r,a,o.spacing,o.data.spacing))},t}(j),we=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,[K.pathConstraintMix+"|"+i])||this).constraintIndex=0,r.constraintIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return 4},n.setFrame=function(e,t,n,i,r){var a=this.frames;a[e<<=2]=t,a[e+1]=n,a[e+2]=i,a[e+3]=r},n.apply=function(e,t,n,i,r,a,s){var o=e.pathConstraints[this.constraintIndex];if(o.active){var c=this.frames;if(n<c[0])switch(a){case 0:return o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,void(o.mixY=o.data.mixY);case 1:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*r,o.mixX+=(o.data.mixX-o.mixX)*r,o.mixY+=(o.data.mixY-o.mixY)*r}else{var h,u,l,d=V.search(c,n,4),p=this.curves[d>>2];switch(p){case 0:var f=c[d];h=c[d+1],u=c[d+2],l=c[d+3];var m=(n-f)/(c[d+4]-f);h+=(c[d+4+1]-h)*m,u+=(c[d+4+2]-u)*m,l+=(c[d+4+3]-l)*m;break;case 1:h=c[d+1],u=c[d+2],l=c[d+3];break;default:h=this.getBezierValue(n,d,1,p-2),u=this.getBezierValue(n,d,2,p+18-2),l=this.getBezierValue(n,d,3,p+36-2)}if(0==a){var g=o.data;o.mixRotate=g.mixRotate+(h-g.mixRotate)*r,o.mixX=g.mixX+(u-g.mixX)*r,o.mixY=g.mixY+(l-g.mixY)*r}else o.mixRotate+=(h-o.mixRotate)*r,o.mixX+=(u-o.mixX)*r,o.mixY+=(l-o.mixY)*r}}},t}(X),Ae=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,r+"|"+i)||this).constraintIndex=0,a.constraintIndex=i,a}return(0,a.Z)(t,e),t.prototype.apply=function(e,t,n,i,r,a,o){var c;if(-1==this.constraintIndex)for(var h,u=n>=this.frames[0]?this.getCurveValue(n):0,l=s(e.physicsConstraints);!(h=l()).done;){var d=h.value;d.active&&this.global(d.data)&&this.set(d,this.getAbsoluteValue2(n,r,a,this.get(d),this.setup(d),u))}else(c=e.physicsConstraints[this.constraintIndex]).active&&this.set(c,this.getAbsoluteValue(n,r,a,this.get(c),this.setup(c)))},t}(j),be=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintInertia)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.inertia},n.get=function(e){return e.inertia},n.set=function(e,t){e.inertia=t},n.global=function(e){return e.inertiaGlobal},t}(Ae),Se=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintStrength)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.strength},n.get=function(e){return e.strength},n.set=function(e,t){e.strength=t},n.global=function(e){return e.strengthGlobal},t}(Ae),Te=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintDamping)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.damping},n.get=function(e){return e.damping},n.set=function(e,t){e.damping=t},n.global=function(e){return e.dampingGlobal},t}(Ae),xe=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintMass)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return 1/e.data.massInverse},n.get=function(e){return 1/e.massInverse},n.set=function(e,t){e.massInverse=1/t},n.global=function(e){return e.massGlobal},t}(Ae),ke=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintWind)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.wind},n.get=function(e){return e.wind},n.set=function(e,t){e.wind=t},n.global=function(e){return e.windGlobal},t}(Ae),Pe=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintGravity)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.gravity},n.get=function(e){return e.gravity},n.set=function(e,t){e.gravity=t},n.global=function(e){return e.gravityGlobal},t}(Ae),Ie=function(e){function t(t,n,i){return e.call(this,t,n,i,K.physicsConstraintMix)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setup=function(e){return e.data.mix},n.get=function(e){return e.mix},n.set=function(e,t){e.mix=t},n.global=function(e){return e.mixGlobal},t}(Ae),Oe=function(e){function t(n,i){var r;return(r=e.call(this,n,t.propertyIds)||this).constraintIndex=void 0,r.constraintIndex=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameCount=function(){return this.frames.length},n.setFrame=function(e,t){this.frames[e]=t},n.apply=function(e,t,n,i,r,a,o){var c;if(-1==this.constraintIndex||(c=e.physicsConstraints[this.constraintIndex]).active){var h=this.frames;if(t>n)this.apply(e,t,Number.MAX_VALUE,[],r,a,o),t=-1;else if(t>=h[h.length-1])return;if(!(n<h[0])&&(t<h[0]||n>=h[V.search1(h,t)+1]))if(null!=c)c.reset();else for(var u,l=s(e.physicsConstraints);!(u=l()).done;){var d=u.value;d.active&&d.reset()}}},t}(V);d(Oe,"propertyIds",[K.physicsConstraintReset.toString()]);var Re=function(e){function t(t,n,i){var r;return(r=e.call(this,t,[K.sequence+"|"+n+"|"+i.sequence.id])||this).slotIndex=void 0,r.attachment=void 0,r.slotIndex=n,r.attachment=i,r}(0,a.Z)(t,e);var n=t.prototype;return n.getFrameEntries=function(){return t.ENTRIES},n.getSlotIndex=function(){return this.slotIndex},n.getAttachment=function(){return this.attachment},n.setFrame=function(e,n,i,r,a){var s=this.frames;s[e*=t.ENTRIES]=n,s[e+t.MODE]=i|r<<4,s[e+t.DELAY]=a},n.apply=function(e,n,i,r,a,s,o){var c=e.slots[this.slotIndex];if(c.bone.active){var h=c.attachment,u=this.attachment;if(h==u||h instanceof _&&h.timelineAttachment==u){var l=this.frames;if(i<l[0])0!=s&&1!=s||(c.sequenceIndex=-1);else{var d=V.search(l,i,t.ENTRIES),p=l[d],f=l[d+t.MODE],m=l[d+t.DELAY];if(this.attachment.sequence){var g=f>>4,v=this.attachment.sequence.regions.length,y=W[15&f];if(0!=y)switch(g+=(i-p)/m+1e-5|0,y){case 1:g=Math.min(v-1,g);break;case 2:g%=v;break;case 3:var E=(v<<1)-2;(g=0==E?0:g%E)>=v&&(g=E-g);break;case 4:g=Math.max(v-1-g,0);break;case 5:g=v-1-g%v;break;case 6:var C=(v<<1)-2;(g=0==C?0:(g+v-1)%C)>=v&&(g=C-g)}c.sequenceIndex=g}}}}},t}(V);d(Re,"ENTRIES",3),d(Re,"MODE",1),d(Re,"DELAY",2);var Be=function(){function e(e){this.data=void 0,this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Ne(this),this.propertyIDs=new w,this.animationsChanged=!1,this.trackEntryPool=new R((function(){return new _e})),this.data=e}e.emptyAnimation=function(){return e._emptyAnimation};var t=e.prototype;return t.update=function(e){e*=this.timeScale;for(var t=this.tracks,n=0,i=t.length;n<i;n++){var r=t[n];if(r){r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;var a=e*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}var s=r.next;if(s){var o=r.trackLast-s.delay;if(o>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(o/r.timeScale+e)*s.timeScale,r.trackTime+=a,this.setCurrent(n,s,!0);s.mixingFrom;)s.mixTime+=e,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){t[n]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,e)){var c=r.mixingFrom;for(r.mixingFrom=null,c&&(c.mixingTo=null);c;)this.queue.end(c),c=c.mixingFrom}r.trackTime+=a}}this.queue.drain()},t.updateMixingFrom=function(e,t){var n=e.mixingFrom;if(!n)return!0;var i=this.updateMixingFrom(n,t);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,e.mixTime>0&&e.mixTime>=e.mixDuration?(0!=n.totalAlpha&&0!=e.mixDuration||(e.mixingFrom=n.mixingFrom,n.mixingFrom&&(n.mixingFrom.mixingTo=e),e.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=t*n.timeScale,e.mixTime+=t,!1)},t.apply=function(e){if(!e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var t=this.events,n=this.tracks,i=!1,r=0,a=n.length;r<a;r++){var s=n[r];if(s&&!(s.delay>0)){i=!0;var o=0==r?1:s.mixBlend,c=s.alpha;s.mixingFrom?c*=this.applyMixingFrom(s,e,o):s.trackTime>=s.trackEnd&&!s.next&&(c=0);var h=c>=s.alphaAttachmentThreshold,u=s.animationLast,l=s.getAnimationTime(),d=l,p=t;s.reverse&&(d=s.animation.duration-d,p=null);var f=s.animation.timelines,m=f.length;if(0==r&&1==c||3==o){0==r&&(h=!0);for(var g=0;g<m;g++){I.webkit602BugfixHelper(c,o);var v=f[g];v instanceof pe?this.applyAttachmentTimeline(v,e,d,o,h):v.apply(e,u,d,p,c,o,0)}}else{var y=s.timelineMode,E=s.shortestRotation,C=!E&&s.timelinesRotation.length!=m<<1;C&&(s.timelinesRotation.length=m<<1);for(var w=0;w<m;w++){var A=f[w],b=y[w]==Ze?o:0;!E&&A instanceof J?this.applyRotateTimeline(A,e,d,c,b,s.timelinesRotation,w<<1,C):A instanceof pe?this.applyAttachmentTimeline(A,e,d,o,h):(I.webkit602BugfixHelper(c,o),A.apply(e,u,d,p,c,b,0))}}this.queueEvents(s,l),t.length=0,s.nextAnimationLast=l,s.nextTrackLast=s.trackTime}}for(var S=this.unkeyedState+ze,T=e.slots,x=0,k=e.slots.length;x<k;x++){var P=T[x];if(P.attachmentState==S){var O=P.data.attachmentName;P.setAttachment(O?e.getAttachment(P.data.index,O):null)}}return this.unkeyedState+=2,this.queue.drain(),i},t.applyMixingFrom=function(e,t,n){var i=e.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,t,n);var r=0;0==e.mixDuration?(r=1,1==n&&(n=0)):((r=e.mixTime/e.mixDuration)>1&&(r=1),1!=n&&(n=i.mixBlend));var a=r<i.mixAttachmentThreshold,s=r<i.mixDrawOrderThreshold,o=i.animation.timelines,c=o.length,h=i.alpha*e.interruptAlpha,u=h*(1-r),l=i.animationLast,d=i.getAnimationTime(),p=d,f=null;if(i.reverse?p=i.animation.duration-p:r<i.eventThreshold&&(f=this.events),3==n)for(var m=0;m<c;m++)o[m].apply(t,l,p,f,u,n,1);else{var g=i.timelineMode,v=i.timelineHoldMix,y=i.shortestRotation,E=!y&&i.timelinesRotation.length!=c<<1;E&&(i.timelinesRotation.length=c<<1),i.totalAlpha=0;for(var C=0;C<c;C++){var w=o[C],A=1,b=void 0,S=0;switch(g[C]){case Ze:if(!s&&w instanceof ge)continue;b=n,S=u;break;case Ue:b=0,S=u;break;case We:b=n,S=h;break;case Ye:b=0,S=h;break;default:b=0;var T=v[C];S=h*Math.max(0,1-T.mixTime/T.mixDuration)}i.totalAlpha+=S,!y&&w instanceof J?this.applyRotateTimeline(w,t,p,S,b,i.timelinesRotation,C<<1,E):w instanceof pe?this.applyAttachmentTimeline(w,t,p,b,a&&S>=i.alphaAttachmentThreshold):(I.webkit602BugfixHelper(S,n),s&&w instanceof ge&&0==b&&(A=0),w.apply(t,l,p,f,S,b,A))}}return e.mixDuration>0&&this.queueEvents(i,d),this.events.length=0,i.nextAnimationLast=d,i.nextTrackLast=i.trackTime,r},t.applyAttachmentTimeline=function(e,t,n,i,r){var a=t.slots[e.slotIndex];a.bone.active&&(n<e.frames[0]?0!=i&&1!=i||this.setAttachment(t,a,a.data.attachmentName,r):this.setAttachment(t,a,e.attachmentNames[V.search1(e.frames,n)],r),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+ze))},t.setAttachment=function(e,t,n,i){t.setAttachment(n?e.getAttachment(t.data.index,n):null),i&&(t.attachmentState=this.unkeyedState+Ke)},t.applyRotateTimeline=function(e,t,n,i,r,a,s,o){if(o&&(a[s]=0),1!=i){var c=t.bones[e.boneIndex];if(c.active){var h=0,u=0;if(n<e.frames[0])switch(r){case 0:c.rotation=c.data.rotation;default:return;case 1:h=c.rotation,u=c.data.rotation}else h=0==r?c.data.rotation:c.rotation,u=c.data.rotation+e.getCurveValue(n);var l=0,d=u-h;if(0==(d-=360*Math.ceil(d/360-.5)))l=a[s];else{var p=0,f=0;o?(p=0,f=d):(p=a[s],f=a[s+1]);var m=p-p%360;l=d+m;var g=d>=0,v=p>=0;Math.abs(f)<=90&&T.signum(f)!=T.signum(d)&&(Math.abs(p-m)>180?(l+=360*T.signum(p),v=g):0!=m?l-=360*T.signum(p):v=g),v!=g&&(l+=360*T.signum(p)),a[s]=l}a[s+1]=d,c.rotation=h+l*i}}else e.apply(t,0,n,null,1,r,0)},t.queueEvents=function(e,t){for(var n=e.animationStart,i=e.animationEnd,r=i-n,a=e.trackLast%r,s=this.events,o=0,c=s.length;o<c;o++){var h=s[o];if(h.time<a)break;h.time>i||this.queue.event(e,h)}var u=!1;if(e.loop)if(0==r)u=!0;else{var l=Math.floor(e.trackTime/r);u=l>0&&l>Math.floor(e.trackLast/r)}else u=t>=i&&e.animationLast<i;for(u&&this.queue.complete(e);o<c;o++){var d=s[o];d.time<n||this.queue.event(e,d)}},t.clearTracks=function(){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var t=0,n=this.tracks.length;t<n;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=e,this.queue.drain()},t.clearTrack=function(e){if(!(e>=this.tracks.length)){var t=this.tracks[e];if(t){this.queue.end(t),this.clearNext(t);for(var n=t;;){var i=n.mixingFrom;if(!i)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[t.trackIndex]=null,this.queue.drain()}}},t.setCurrent=function(e,t,n){var i=this.expandToIndex(e);this.tracks[e]=t,t.previous=null,i&&(n&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)},t.setAnimation=function(e,t,n){void 0===n&&(n=!1);var i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);return this.setAnimationWith(e,i,n)},t.setAnimationWith=function(e,t,n){if(void 0===n&&(n=!1),!t)throw new Error("animation cannot be null.");var i=!0,r=this.expandToIndex(e);r&&(-1==r.nextTrackLast?(this.tracks[e]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,i=!1):this.clearNext(r));var a=this.trackEntry(e,t,n,r);return this.setCurrent(e,a,i),this.queue.drain(),a},t.addAnimation=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=0);var r=this.data.skeletonData.findAnimation(t);if(!r)throw new Error("Animation not found: "+t);return this.addAnimationWith(e,r,n,i)},t.addAnimationWith=function(e,t,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=0),!t)throw new Error("animation cannot be null.");var r=this.expandToIndex(e);if(r)for(;r.next;)r=r.next;var a=this.trackEntry(e,t,n,r);return r?(r.next=a,a.previous=r,i<=0&&(i+=r.getTrackComplete()-a.mixDuration)):(this.setCurrent(e,a,!0),this.queue.drain()),a.delay=i,a},t.setEmptyAnimation=function(t,n){void 0===n&&(n=0);var i=this.setAnimationWith(t,e.emptyAnimation(),!1);return i.mixDuration=n,i.trackEnd=n,i},t.addEmptyAnimation=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=this.addAnimationWith(t,e.emptyAnimation(),!1,i);return i<=0&&(r.delay+=r.mixDuration-n),r.mixDuration=n,r.trackEnd=n,r},t.setEmptyAnimations=function(e){void 0===e&&(e=0);var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var n=0,i=this.tracks.length;n<i;n++){var r=this.tracks[n];r&&this.setEmptyAnimation(r.trackIndex,e)}this.queue.drainDisabled=t,this.queue.drain()},t.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(I.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)},t.trackEntry=function(e,t,n,i){var r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=e,r.animation=t,r.loop=n,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.alphaAttachmentThreshold=0,r.mixAttachmentThreshold=0,r.mixDrawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=i?this.data.getMix(i.animation,t):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=2,r},t.clearNext=function(e){for(var t=e.next;t;)this.queue.dispose(t),t=t.next;e.next=null},t._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=this.tracks,t=0,n=e.length;t<n;t++){var i=e[t];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do{i.mixingTo&&3==i.mixBlend||this.computeHold(i),i=i.mixingTo}while(i)}}},t.computeHold=function(e){var t=e.mixingTo,n=e.animation.timelines,i=e.animation.timelines.length,r=e.timelineMode;r.length=i;var a=e.timelineHoldMix;a.length=0;var s=this.propertyIDs;if(t&&t.holdPrevious)for(var o=0;o<i;o++)r[o]=s.addAll(n[o].getPropertyIds())?Ye:We;else e:for(var c=0;c<i;c++){var h=n[c],u=h.getPropertyIds();if(s.addAll(u))if(!t||h instanceof pe||h instanceof ge||h instanceof me||!t.animation.hasTimeline(u))r[c]=Ue;else{for(var l=t.mixingTo;l;l=l.mixingTo)if(!l.animation.hasTimeline(u)){if(e.mixDuration>0){r[c]=He,a[c]=l;continue e}break}r[c]=Ye}else r[c]=Ze}},t.getCurrent=function(e){return e>=this.tracks.length?null:this.tracks[e]},t.addListener=function(e){if(!e)throw new Error("listener cannot be null.");this.listeners.push(e)},t.removeListener=function(e){var t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)},t.clearListeners=function(){this.listeners.length=0},t.clearListenerNotifications=function(){this.queue.clear()},e}();d(Be,"_emptyAnimation",new Y("<empty>",[],0));var De,Le,Me,_e=function(){function e(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.mixAttachmentThreshold=0,this.alphaAttachmentThreshold=0,this.mixDrawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this._mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=2,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}var t=e.prototype;return t.setMixDurationWithDelay=function(e,t){this._mixDuration=e,null!=this.previous&&t<=0&&(t+=this.previous.getTrackComplete()-e),this.delay=t},t.reset=function(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},t.getAnimationTime=function(){if(this.loop){var e=this.animationEnd-this.animationStart;return 0==e?this.animationStart:this.trackTime%e+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},t.setAnimationLast=function(e){this.animationLast=e,this.nextAnimationLast=e},t.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},t.resetRotationDirections=function(){this.timelinesRotation.length=0},t.getTrackComplete=function(){var e=this.animationEnd-this.animationStart;if(0!=e){if(this.loop)return e*(1+(this.trackTime/e|0));if(this.trackTime<e)return e}return this.trackTime},t.wasApplied=function(){return-1!=this.nextTrackLast},t.isNextReady=function(){return null!=this.next&&this.nextTrackLast-this.next.delay>=0},(0,i.Z)(e,[{key:"mixDuration",get:function(){return this._mixDuration},set:function(e){this._mixDuration=e}}]),e}(),Ne=function(){function e(e){this.objects=[],this.drainDisabled=!1,this.animState=void 0,this.animState=e}var t=e.prototype;return t.start=function(e){this.objects.push(Ge.start),this.objects.push(e),this.animState.animationsChanged=!0},t.interrupt=function(e){this.objects.push(Ge.interrupt),this.objects.push(e)},t.end=function(e){this.objects.push(Ge.end),this.objects.push(e),this.animState.animationsChanged=!0},t.dispose=function(e){this.objects.push(Ge.dispose),this.objects.push(e)},t.complete=function(e){this.objects.push(Ge.complete),this.objects.push(e)},t.event=function(e,t){this.objects.push(Ge.event),this.objects.push(e),this.objects.push(t)},t.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var e=this.objects,t=this.animState.listeners,n=0;n<e.length;n+=2){var i=e[n],r=e[n+1];switch(i){case Ge.start:r.listener&&r.listener.start&&r.listener.start(r);for(var a=0;a<t.length;a++){var s=t[a];s.start&&s.start(r)}break;case Ge.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(var o=0;o<t.length;o++){var c=t[o];c.interrupt&&c.interrupt(r)}break;case Ge.end:r.listener&&r.listener.end&&r.listener.end(r);for(var h=0;h<t.length;h++){var u=t[h];u.end&&u.end(r)}case Ge.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(var l=0;l<t.length;l++){var d=t[l];d.dispose&&d.dispose(r)}this.animState.trackEntryPool.free(r);break;case Ge.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(var p=0;p<t.length;p++){var f=t[p];f.complete&&f.complete(r)}break;case Ge.event:var m=e[2+n++];r.listener&&r.listener.event&&r.listener.event(r,m);for(var g=0;g<t.length;g++){var v=t[g];v.event&&v.event(r,m)}}}this.clear(),this.drainDisabled=!1}},t.clear=function(){this.objects.length=0},e}(),Ge=((De=Ge||{})[De.start=0]="start",De[De.interrupt=1]="interrupt",De[De.end=2]="end",De[De.dispose=3]="dispose",De[De.complete=4]="complete",De[De.event=5]="event",De),Fe=function(){function e(){}var t=e.prototype;return t.start=function(e){},t.interrupt=function(e){},t.end=function(e){},t.dispose=function(e){},t.complete=function(e){},t.event=function(e,t){},e}(),Ze=0,Ue=1,We=2,Ye=3,He=4,ze=1,Ke=2,Ve=function(){function e(e){if(this.skeletonData=void 0,this.animationToMixTime={},this.defaultMix=0,!e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}var t=e.prototype;return t.setMix=function(e,t,n){var i=this.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);var r=this.skeletonData.findAnimation(t);if(!r)throw new Error("Animation not found: "+t);this.setMixWith(i,r,n)},t.setMixWith=function(e,t,n){if(!e)throw new Error("from cannot be null.");if(!t)throw new Error("to cannot be null.");var i=e.name+"."+t.name;this.animationToMixTime[i]=n},t.getMix=function(e,t){var n=e.name+"."+t.name,i=this.animationToMixTime[n];return void 0===i?this.defaultMix:i},e}(),Xe=function(e){function t(t){var n;return(n=e.call(this,t)||this).color=new b(1,1,1,1),n}return(0,a.Z)(t,e),t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e},t}(_),je=function(e){function t(t){var n;return(n=e.call(this,t)||this).endSlot=null,n.color=new b(.2275,.2275,.8078,1),n}return(0,a.Z)(t,e),t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e},t}(_),qe=function(){function e(e){this._image=void 0,this._image=e}return e.prototype.getImage=function(){return this._image},e}(),Je=((Le=Je||{})[Le.Nearest=9728]="Nearest",Le[Le.Linear=9729]="Linear",Le[Le.MipMap=9987]="MipMap",Le[Le.MipMapNearestNearest=9984]="MipMapNearestNearest",Le[Le.MipMapLinearNearest=9985]="MipMapLinearNearest",Le[Le.MipMapNearestLinear=9986]="MipMapNearestLinear",Le[Le.MipMapLinearLinear=9987]="MipMapLinearLinear",Le),Qe=((Me=Qe||{})[Me.MirroredRepeat=33648]="MirroredRepeat",Me[Me.ClampToEdge=33071]="ClampToEdge",Me[Me.Repeat=10497]="Repeat",Me),$e=function(){this.texture=void 0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0},et=function(e){function t(){return e.apply(this,arguments)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setFilters=function(e,t){},n.setWraps=function(e,t){},n.dispose=function(){},t}(qe),tt=function(){function e(e){this.pages=new Array,this.regions=new Array;for(var t=new nt(e),n=new Array(4),i={size:function(e){e.width=parseInt(n[1]),e.height=parseInt(n[2])},format:function(){},filter:function(e){e.minFilter=I.enumValue(Je,n[1]),e.magFilter=I.enumValue(Je,n[2])},repeat:function(e){-1!=n[1].indexOf("x")&&(e.uWrap=10497),-1!=n[1].indexOf("y")&&(e.vWrap=10497)},pma:function(e){e.pma="true"==n[1]}},r={xy:function(e){e.x=parseInt(n[1]),e.y=parseInt(n[2])},size:function(e){e.width=parseInt(n[1]),e.height=parseInt(n[2])},bounds:function(e){e.x=parseInt(n[1]),e.y=parseInt(n[2]),e.width=parseInt(n[3]),e.height=parseInt(n[4])},offset:function(e){e.offsetX=parseInt(n[1]),e.offsetY=parseInt(n[2])},orig:function(e){e.originalWidth=parseInt(n[1]),e.originalHeight=parseInt(n[2])},offsets:function(e){e.offsetX=parseInt(n[1]),e.offsetY=parseInt(n[2]),e.originalWidth=parseInt(n[3]),e.originalHeight=parseInt(n[4])},rotate:function(e){var t=n[1];"true"==t?e.degrees=90:"false"!=t&&(e.degrees=parseInt(t))},index:function(e){e.index=parseInt(n[1])}},a=t.readLine();a&&0==a.trim().length;)a=t.readLine();for(;a&&0!=a.trim().length&&0!=t.readEntry(n,a);)a=t.readLine();for(var s=null,o=null,c=null;null!==a;)if(0==a.trim().length)s=null,a=t.readLine();else if(s){for(var h=new rt(s,a);;){var u=t.readEntry(n,a=t.readLine());if(0==u)break;var l=r[n[0]];if(l)l(h);else{o||(o=[]),c||(c=[]),o.push(n[0]);for(var d=[],p=0;p<u;p++)d.push(parseInt(n[p+1]));c.push(d)}}0==h.originalWidth&&0==h.originalHeight&&(h.originalWidth=h.width,h.originalHeight=h.height),o&&o.length>0&&c&&c.length>0&&(h.names=o,h.values=c,o=null,c=null),h.u=h.x/s.width,h.v=h.y/s.height,90==h.degrees?(h.u2=(h.x+h.height)/s.width,h.v2=(h.y+h.width)/s.height):(h.u2=(h.x+h.width)/s.width,h.v2=(h.y+h.height)/s.height),this.regions.push(h)}else{for(s=new it(a.trim());0!=t.readEntry(n,a=t.readLine());){var f=i[n[0]];f&&f(s)}this.pages.push(s)}}var t=e.prototype;return t.findRegion=function(e){for(var t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null},t.setTextures=function(e,t){void 0===t&&(t="");for(var n,i=s(this.pages);!(n=i()).done;){var r=n.value;r.setTexture(e.get(t+r.name))}},t.dispose=function(){for(var e=0;e<this.pages.length;e++){var t;null==(t=this.pages[e].texture)||t.dispose()}},e}(),nt=function(){function e(e){this.lines=void 0,this.index=0,this.lines=e.split(/\r\n|\r|\n/)}var t=e.prototype;return t.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},t.readEntry=function(e,t){if(!t)return 0;if(0==(t=t.trim()).length)return 0;var n=t.indexOf(":");if(-1==n)return 0;e[0]=t.substr(0,n).trim();for(var i=1,r=n+1;;i++){var a=t.indexOf(",",r);if(-1==a)return e[i]=t.substr(r).trim(),i;if(e[i]=t.substr(r,a-r).trim(),r=a+1,4==i)return 4}},e}(),it=function(){function e(e){this.name=void 0,this.minFilter=9728,this.magFilter=9728,this.uWrap=33071,this.vWrap=33071,this.texture=null,this.width=0,this.height=0,this.pma=!1,this.regions=new Array,this.name=e}return e.prototype.setTexture=function(e){this.texture=e,e.setFilters(this.minFilter,this.magFilter),e.setWraps(this.uWrap,this.vWrap);for(var t,n=s(this.regions);!(t=n()).done;){t.value.texture=e}},e}(),rt=function(e){function t(t,n){var i;return(i=e.call(this)||this).page=void 0,i.name=void 0,i.x=0,i.y=0,i.offsetX=0,i.offsetY=0,i.originalWidth=0,i.originalHeight=0,i.index=0,i.degrees=0,i.names=null,i.values=null,i.page=t,i.name=n,t.regions.push((0,r.Z)(i)),i}return(0,a.Z)(t,e),t}($e),at=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).region=null,i.path=void 0,i.regionUVs=[],i.uvs=[],i.triangles=[],i.color=new b(1,1,1,1),i.width=0,i.height=0,i.hullLength=0,i.edges=[],i.parentMesh=null,i.sequence=null,i.tempColor=new b(0,0,0,0),i.path=n,i}(0,a.Z)(t,e);var n=t.prototype;return n.updateRegion=function(){if(!this.region)throw new Error("Region not set.");var e=this.regionUVs;this.uvs&&this.uvs.length==e.length||(this.uvs=I.newFloatArray(e.length));var t=this.uvs,n=this.uvs.length,i=this.region.u,r=this.region.v,a=0,s=0;if(this.region instanceof rt){var o=this.region,c=o.page,h=c.width,u=c.height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/h,r-=(o.originalWidth-o.offsetX-o.width)/u,a=o.originalHeight/h,s=o.originalWidth/u;for(var l=0;l<n;l+=2)t[l]=i+e[l+1]*a,t[l+1]=r+(1-e[l])*s;return;case 180:i-=(o.originalWidth-o.offsetX-o.width)/h,r-=o.offsetY/u,a=o.originalWidth/h,s=o.originalHeight/u;for(var d=0;d<n;d+=2)t[d]=i+(1-e[d])*a,t[d+1]=r+(1-e[d+1])*s;return;case 270:i-=o.offsetY/h,r-=o.offsetX/u,a=o.originalHeight/h,s=o.originalWidth/u;for(var p=0;p<n;p+=2)t[p]=i+(1-e[p+1])*a,t[p+1]=r+e[p]*s;return}i-=o.offsetX/h,r-=(o.originalHeight-o.offsetY-o.height)/u,a=o.originalWidth/h,s=o.originalHeight/u}else this.region?(a=this.region.u2-i,s=this.region.v2-r):(i=r=0,a=s=1);for(var f=0;f<n;f+=2)t[f]=i+e[f]*a,t[f+1]=r+e[f+1]*s},n.getParentMesh=function(){return this.parentMesh},n.setParentMesh=function(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)},n.copy=function(){if(this.parentMesh)return this.newLinkedMesh();var e=new t(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),I.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),I.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),I.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),I.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e},n.computeWorldVertices=function(t,n,i,r,a,s){null!=this.sequence&&this.sequence.apply(t,this),e.prototype.computeWorldVertices.call(this,t,n,i,r,a,s)},n.newLinkedMesh=function(){var e=new t(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),null!=e.region&&e.updateRegion(),e},t}(_),st=function(e){function t(t){var n;return(n=e.call(this,t)||this).lengths=[],n.closed=!1,n.constantSpeed=!1,n.color=new b(1,1,1,1),n}return(0,a.Z)(t,e),t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),I.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e},t}(_),ot=function(e){function t(t){var n;return(n=e.call(this,t)||this).x=0,n.y=0,n.rotation=0,n.color=new b(.38,.94,0,1),n}(0,a.Z)(t,e);var n=t.prototype;return n.computeWorldPosition=function(e,t){return t.x=this.x*e.a+this.y*e.b+e.worldX,t.y=this.x*e.c+this.y*e.d+e.worldY,t},n.computeWorldRotation=function(e){var t=this.rotation*T.degRad,n=Math.cos(t),i=Math.sin(t),r=n*e.a+i*e.b,a=n*e.c+i*e.d;return T.atan2Deg(a,r)},n.copy=function(){var e=new t(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e},t}(_),ct=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).x=0,i.y=0,i.scaleX=1,i.scaleY=1,i.rotation=0,i.width=0,i.height=0,i.color=new b(1,1,1,1),i.path=void 0,i.region=null,i.sequence=null,i.offset=I.newFloatArray(8),i.uvs=I.newFloatArray(8),i.tempColor=new b(1,1,1,1),i.path=n,i}(0,a.Z)(t,e);var n=t.prototype;return n.updateRegion=function(){if(!this.region)throw new Error("Region not set.");var e=this.region,t=this.uvs;if(null==e)return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=1,t[5]=1,t[6]=1,void(t[7]=0);var n=this.width/this.region.originalWidth*this.scaleX,i=this.height/this.region.originalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.region.offsetX*n,a=-this.height/2*this.scaleY+this.region.offsetY*i,s=r+this.region.width*n,o=a+this.region.height*i,c=this.rotation*T.degRad,h=Math.cos(c),u=Math.sin(c),l=this.x,d=this.y,p=r*h+l,f=r*u,m=a*h+d,g=a*u,v=s*h+l,y=s*u,E=o*h+d,C=o*u,w=this.offset;w[0]=p-g,w[1]=m+f,w[2]=p-C,w[3]=E+f,w[4]=v-C,w[5]=E+y,w[6]=v-g,w[7]=m+y,90==e.degrees?(t[0]=e.u2,t[1]=e.v2,t[2]=e.u,t[3]=e.v2,t[4]=e.u,t[5]=e.v,t[6]=e.u2,t[7]=e.v):(t[0]=e.u,t[1]=e.v2,t[2]=e.u,t[3]=e.v,t[4]=e.u2,t[5]=e.v,t[6]=e.u2,t[7]=e.v2)},n.computeWorldVertices=function(e,t,n,i){null!=this.sequence&&this.sequence.apply(e,this);var r=e.bone,a=this.offset,s=r.worldX,o=r.worldY,c=r.a,h=r.b,u=r.c,l=r.d,d=0,p=0;d=a[0],p=a[1],t[n]=d*c+p*h+s,t[n+1]=d*u+p*l+o,n+=i,d=a[2],p=a[3],t[n]=d*c+p*h+s,t[n+1]=d*u+p*l+o,n+=i,d=a[4],p=a[5],t[n]=d*c+p*h+s,t[n+1]=d*u+p*l+o,n+=i,d=a[6],p=a[7],t[n]=d*c+p*h+s,t[n+1]=d*u+p*l+o},n.copy=function(){var e=new t(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,I.arrayCopy(this.uvs,0,e.uvs,0,8),I.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=null!=this.sequence?this.sequence.copy():null,e},t}(M);d(ct,"X1",0),d(ct,"Y1",1),d(ct,"C1R",2),d(ct,"C1G",3),d(ct,"C1B",4),d(ct,"C1A",5),d(ct,"U1",6),d(ct,"V1",7),d(ct,"X2",8),d(ct,"Y2",9),d(ct,"C2R",10),d(ct,"C2G",11),d(ct,"C2B",12),d(ct,"C2A",13),d(ct,"U2",14),d(ct,"V2",15),d(ct,"X3",16),d(ct,"Y3",17),d(ct,"C3R",18),d(ct,"C3G",19),d(ct,"C3B",20),d(ct,"C3A",21),d(ct,"U3",22),d(ct,"V3",23),d(ct,"X4",24),d(ct,"Y4",25),d(ct,"C4R",26),d(ct,"C4G",27),d(ct,"C4B",28),d(ct,"C4A",29),d(ct,"U4",30),d(ct,"V4",31);var ht,ut,lt,dt,pt=function(){function e(e){this.atlas=void 0,this.atlas=e}var t=e.prototype;return t.loadSequence=function(e,t,n){for(var i=n.regions,r=0,a=i.length;r<a;r++){var s=n.getPath(t,r),o=this.atlas.findRegion(s);if(null==o)throw new Error("Region not found in atlas: "+s+" (sequence: "+e+")");i[r]=o}},t.newRegionAttachment=function(e,t,n,i){var r=new ct(t,n);if(null!=i)this.loadSequence(t,n,i);else{var a=this.atlas.findRegion(n);if(!a)throw new Error("Region not found in atlas: "+n+" (region attachment: "+t+")");r.region=a}return r},t.newMeshAttachment=function(e,t,n,i){var r=new at(t,n);if(null!=i)this.loadSequence(t,n,i);else{var a=this.atlas.findRegion(n);if(!a)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+t+")");r.region=a}return r},t.newBoundingBoxAttachment=function(e,t){return new Xe(t)},t.newPathAttachment=function(e,t){return new st(t)},t.newPointAttachment=function(e,t){return new ot(t)},t.newClippingAttachment=function(e,t){return new je(t)},e}(),ft=function(e,t,n){if(this.index=0,this.name=void 0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.inherit=mt.Normal,this.skinRequired=!1,this.color=new b,this.icon=void 0,this.visible=!1,e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=n},mt=((ht=mt||{})[ht.Normal=0]="Normal",ht[ht.OnlyTranslation=1]="OnlyTranslation",ht[ht.NoRotationOrReflection=2]="NoRotationOrReflection",ht[ht.NoScale=3]="NoScale",ht[ht.NoScaleOrReflection=4]="NoScaleOrReflection",ht),gt=function(){function e(e,t,n){if(this.data=void 0,this.skeleton=void 0,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.inherit=0,this.sorted=!1,this.active=!1,!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=t,this.parent=n,this.setToSetupPose()}var t=e.prototype;return t.isActive=function(){return this.active},t.update=function(e){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)},t.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},t.updateWorldTransformWith=function(e,t,n,i,r,a,s){this.ax=e,this.ay=t,this.arotation=n,this.ascaleX=i,this.ascaleY=r,this.ashearX=a,this.ashearY=s;var o=this.parent;if(!o){var c=this.skeleton,h=c.scaleX,u=c.scaleY,l=(n+a)*T.degRad,d=(n+90+s)*T.degRad;return this.a=Math.cos(l)*i*h,this.b=Math.cos(d)*r*h,this.c=Math.sin(l)*i*u,this.d=Math.sin(d)*r*u,this.worldX=e*h+c.x,void(this.worldY=t*u+c.y)}var p=o.a,f=o.b,m=o.c,g=o.d;switch(this.worldX=p*e+f*t+o.worldX,this.worldY=m*e+g*t+o.worldY,this.inherit){case 0:var v=(n+a)*T.degRad,y=(n+90+s)*T.degRad,E=Math.cos(v)*i,C=Math.cos(y)*r,w=Math.sin(v)*i,A=Math.sin(y)*r;return this.a=p*E+f*w,this.b=p*C+f*A,this.c=m*E+g*w,void(this.d=m*C+g*A);case 1:var b=(n+a)*T.degRad,S=(n+90+s)*T.degRad;this.a=Math.cos(b)*i,this.b=Math.cos(S)*r,this.c=Math.sin(b)*i,this.d=Math.sin(S)*r;break;case 2:var x=p*p+m*m,k=0;x>1e-4?(x=Math.abs(p*g-f*m)/x,p/=this.skeleton.scaleX,f=(m/=this.skeleton.scaleY)*x,g=p*x,k=Math.atan2(m,p)*T.radDeg):(p=0,m=0,k=90-Math.atan2(g,f)*T.radDeg);var P=(n+a-k)*T.degRad,I=(n+s-k+90)*T.degRad,O=Math.cos(P)*i,R=Math.cos(I)*r,B=Math.sin(P)*i,D=Math.sin(I)*r;this.a=p*O-f*B,this.b=p*R-f*D,this.c=m*O+g*B,this.d=m*R+g*D;break;case 3:case 4:n*=T.degRad;var L=Math.cos(n),M=Math.sin(n),_=(p*L+f*M)/this.skeleton.scaleX,N=(m*L+g*M)/this.skeleton.scaleY,G=Math.sqrt(_*_+N*N);G>1e-5&&(G=1/G),_*=G,N*=G,G=Math.sqrt(_*_+N*N),3==this.inherit&&p*g-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(G=-G),n=Math.PI/2+Math.atan2(N,_);var F=Math.cos(n)*G,Z=Math.sin(n)*G;a*=T.degRad,s=(90+s)*T.degRad;var U=Math.cos(a)*i,W=Math.cos(s)*r,Y=Math.sin(a)*i,H=Math.sin(s)*r;this.a=_*U+F*Y,this.b=_*W+F*H,this.c=N*U+Z*Y,this.d=N*W+Z*H}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},t.setToSetupPose=function(){var e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.shearX=e.shearX,this.shearY=e.shearY,this.inherit=e.inherit},t.updateAppliedTransform=function(){var e=this.parent;if(!e)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*T.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*T.radDeg);var t,n,i,r,a=e.a,s=e.b,o=e.c,c=e.d,h=1/(a*c-s*o),u=c*h,l=s*h,d=o*h,p=a*h,f=this.worldX-e.worldX,m=this.worldY-e.worldY;if(this.ax=f*u-m*l,this.ay=m*p-f*d,1==this.inherit)t=this.a,n=this.b,i=this.c,r=this.d;else{switch(this.inherit){case 2:var g=Math.abs(a*c-s*o)/(a*a+o*o),v=a/this.skeleton.scaleX;s=-(o/this.skeleton.scaleY)*g*this.skeleton.scaleX,u=(c=v*g*this.skeleton.scaleY)*(h=1/(a*c-s*o)),l=s*h;break;case 3:case 4:var y=T.cosDeg(this.rotation),E=T.sinDeg(this.rotation);a=(a*y+s*E)/this.skeleton.scaleX,o=(o*y+c*E)/this.skeleton.scaleY;var C=Math.sqrt(a*a+o*o);C>1e-5&&(C=1/C),a*=C,o*=C,C=Math.sqrt(a*a+o*o),3==this.inherit&&h<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(C=-C);var w=T.PI/2+Math.atan2(o,a);s=Math.cos(w)*C,u=(c=Math.sin(w)*C)*(h=1/(a*c-s*o)),l=s*h,d=o*h,p=a*h}t=u*this.a-l*this.c,n=u*this.b-l*this.d,i=p*this.c-d*this.a,r=p*this.d-d*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(t*t+i*i),this.ascaleX>1e-4){var A=t*r-n*i;this.ascaleY=A/this.ascaleX,this.ashearY=-Math.atan2(t*n+i*r,A)*T.radDeg,this.arotation=Math.atan2(i,t)*T.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(n*n+r*r),this.ashearY=0,this.arotation=90-Math.atan2(r,n)*T.radDeg},t.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*T.radDeg},t.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*T.radDeg},t.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},t.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},t.worldToLocal=function(e){var t=1/(this.a*this.d-this.b*this.c),n=e.x-this.worldX,i=e.y-this.worldY;return e.x=n*this.d*t-i*this.b*t,e.y=i*this.a*t-n*this.c*t,e},t.localToWorld=function(e){var t=e.x,n=e.y;return e.x=t*this.a+n*this.b+this.worldX,e.y=t*this.c+n*this.d+this.worldY,e},t.worldToParent=function(e){if(null==e)throw new Error("world cannot be null.");return null==this.parent?e:this.parent.worldToLocal(e)},t.parentToWorld=function(e){if(null==e)throw new Error("world cannot be null.");return null==this.parent?e:this.parent.localToWorld(e)},t.worldToLocalRotation=function(e){var t=T.sinDeg(e),n=T.cosDeg(e);return Math.atan2(this.a*t-this.c*n,this.d*n-this.b*t)*T.radDeg+this.rotation-this.shearX},t.localToWorldRotation=function(e){e-=this.rotation-this.shearX;var t=T.sinDeg(e),n=T.cosDeg(e);return Math.atan2(n*this.c+t*this.d,n*this.a+t*this.b)*T.radDeg},t.rotateWorld=function(e){e*=T.degRad;var t=Math.sin(e),n=Math.cos(e),i=this.a,r=this.b;this.a=n*i-t*this.c,this.b=n*r-t*this.d,this.c=t*i+n*this.c,this.d=t*r+n*this.d},e}(),vt=function(e,t,n){this.name=e,this.order=t,this.skinRequired=n},yt=function(){function e(e,t,n){void 0===t&&(t=""),void 0===n&&(n=new Et),this.pathPrefix="",this.textureLoader=void 0,this.downloader=void 0,this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=e,this.pathPrefix=t,this.downloader=n}var t=e.prototype;return t.start=function(e){return this.toLoad++,this.pathPrefix+e},t.success=function(e,t,n){this.toLoad--,this.loaded++,this.assets[t]=n,e&&e(t,n)},t.error=function(e,t,n){this.toLoad--,this.loaded++,this.errors[t]=n,e&&e(t,n)},t.loadAll=function(){var e=this;return new Promise((function(t,n){requestAnimationFrame((function i(){e.isLoadingComplete()?e.hasErrors()?n(e.errors):t(e):requestAnimationFrame(i)}))}))},t.setRawDataURI=function(e,t){this.downloader.rawDataUris[this.pathPrefix+e]=t},t.loadBinary=function(e,t,n){var i=this;void 0===t&&(t=function(){}),void 0===n&&(n=function(){}),e=this.start(e),this.downloader.downloadBinary(e,(function(n){i.success(t,e,n)}),(function(t,r){i.error(n,e,"Couldn't load binary "+e+": status "+t+", "+r)}))},t.loadText=function(e,t,n){var i=this;void 0===t&&(t=function(){}),void 0===n&&(n=function(){}),e=this.start(e),this.downloader.downloadText(e,(function(n){i.success(t,e,n)}),(function(t,r){i.error(n,e,"Couldn't load text "+e+": status "+t+", "+r)}))},t.loadJson=function(e,t,n){var i=this;void 0===t&&(t=function(){}),void 0===n&&(n=function(){}),e=this.start(e),this.downloader.downloadJson(e,(function(n){i.success(t,e,n)}),(function(t,r){i.error(n,e,"Couldn't load JSON "+e+": status "+t+", "+r)}))},t.loadTexture=function(e,t,n){var i=this;if(void 0===t&&(t=function(){}),void 0===n&&(n=function(){}),e=this.start(e),!!("undefined"===typeof window||"undefined"===typeof navigator||!window.document))fetch(e,{mode:"cors"}).then((function(t){return t.ok?t.blob():(i.error(n,e,"Couldn't load image: "+e),null)})).then((function(e){return e?createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null})).then((function(n){n&&i.success(t,e,i.textureLoader(n))}));else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){i.success(t,e,i.textureLoader(r))},r.onerror=function(){i.error(n,e,"Couldn't load image: "+e)},this.downloader.rawDataUris[e]&&(e=this.downloader.rawDataUris[e]),r.src=e}},t.loadTextureAtlas=function(e,t,n,i){var r=this;void 0===t&&(t=function(){}),void 0===n&&(n=function(){});var a=e.lastIndexOf("/"),o=a>=0?e.substring(0,a+1):"";e=this.start(e),this.downloader.downloadText(e,(function(a){try{for(var c,h=new tt(a),u=h.pages.length,l=!1,d=function(){var a=c.value;r.loadTexture(i?i[a.name]:o+a.name,(function(n,i){l||(a.setTexture(i),0==--u&&r.success(t,e,h))}),(function(t,i){l||r.error(n,e,"Couldn't load texture atlas "+e+" page image: "+t),l=!0}))},p=s(h.pages);!(c=p()).done;)d()}catch(f){r.error(n,e,"Couldn't parse texture atlas "+e+": "+f.message)}}),(function(t,i){r.error(n,e,"Couldn't load texture atlas "+e+": status "+t+", "+i)}))},t.get=function(e){return this.assets[this.pathPrefix+e]},t.require=function(e){e=this.pathPrefix+e;var t=this.assets[e];if(t)return t;var n=this.errors[e];throw Error("Asset not found: "+e+(n?"\n"+n:""))},t.remove=function(e){e=this.pathPrefix+e;var t=this.assets[e];return t.dispose&&t.dispose(),delete this.assets[e],t},t.removeAll=function(){for(var e in this.assets){var t=this.assets[e];t.dispose&&t.dispose()}this.assets={}},t.isLoadingComplete=function(){return 0==this.toLoad},t.getToLoad=function(){return this.toLoad},t.getLoaded=function(){return this.loaded},t.dispose=function(){this.removeAll()},t.hasErrors=function(){return Object.keys(this.errors).length>0},t.getErrors=function(){return this.errors},e}(),Et=function(){function e(){this.callbacks={},this.rawDataUris={}}var t=e.prototype;return t.dataUriToString=function(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");var t=e.indexOf("base64,");return-1!=t?(t+=7,atob(e.substr(t))):e.substr(e.indexOf(",")+1)},t.base64ToUint8Array=function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i},t.dataUriToUint8Array=function(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");var t=e.indexOf("base64,");if(-1==t)throw new Error("Not a binary data URI.");return t+=7,this.base64ToUint8Array(e.substr(t))},t.downloadText=function(e,t,n){var i=this;if(!this.start(e,t,n))if(this.rawDataUris[e])try{var r=this.rawDataUris[e];this.finish(e,200,this.dataUriToString(r))}catch(o){this.finish(e,400,JSON.stringify(o))}else{var a=new XMLHttpRequest;a.overrideMimeType("text/html"),a.open("GET",e,!0);var s=function(){i.finish(e,a.status,a.responseText)};a.onload=s,a.onerror=s,a.send()}},t.downloadJson=function(e,t,n){this.downloadText(e,(function(e){t(JSON.parse(e))}),n)},t.downloadBinary=function(e,t,n){var i=this;if(!this.start(e,t,n))if(this.rawDataUris[e])try{var r=this.rawDataUris[e];this.finish(e,200,this.dataUriToUint8Array(r))}catch(o){this.finish(e,400,JSON.stringify(o))}else{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer";var s=function(){i.finish(e,a.status,a.response)};a.onload=function(){200==a.status||0==a.status?i.finish(e,200,new Uint8Array(a.response)):s()},a.onerror=s,a.send()}},t.start=function(e,t,n){var i=this.callbacks[e];try{if(i)return!0;this.callbacks[e]=i=[]}finally{i.push(t,n)}},t.finish=function(e,t,n){var i=this.callbacks[e];delete this.callbacks[e];for(var r=200==t||0==t?[n]:[t,n],a=r.length-1,s=i.length;a<s;a+=2)i[a].apply(null,r)},e}(),Ct=function(e,t){if(this.data=void 0,this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!t)throw new Error("data cannot be null.");this.time=e,this.data=t},wt=function(e){this.name=void 0,this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=e},At=function(){function e(e,t){if(this.data=void 0,this.bones=void 0,this.target=void 0,this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(var n=0;n<e.bones.length;n++){var i=t.findBone(e.bones[n].name);if(!i)throw new Error("Couldn't find bone "+e.bones[n].name);this.bones.push(i)}var r=t.findBone(e.target.name);if(!r)throw new Error("Couldn't find bone "+e.target.name);this.target=r,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}var t=e.prototype;return t.isActive=function(){return this.active},t.setToSetupPose=function(){var e=this.data;this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch},t.update=function(e){if(0!=this.mix){var t=this.target,n=this.bones;switch(n.length){case 1:this.apply1(n[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(n[0],n[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}},t.apply1=function(e,t,n,i,r,a,s){var o=e.parent;if(!o)throw new Error("IK bone must have parent.");var c=o.a,h=o.b,u=o.c,l=o.d,d=-e.ashearX-e.arotation,p=0,f=0;switch(e.inherit){case 1:p=(t-e.worldX)*T.signum(e.skeleton.scaleX),f=(n-e.worldY)*T.signum(e.skeleton.scaleY);break;case 2:var m=Math.abs(c*l-h*u)/Math.max(1e-4,c*c+u*u),g=c/e.skeleton.scaleX,v=u/e.skeleton.scaleY;h=-v*m*e.skeleton.scaleX,l=g*m*e.skeleton.scaleY,d+=Math.atan2(v,g)*T.radDeg;default:var y=t-o.worldX,E=n-o.worldY,C=c*l-h*u;Math.abs(C)<=1e-4?(p=0,f=0):(p=(y*l-E*h)/C-e.ax,f=(E*c-y*u)/C-e.ay)}d+=Math.atan2(f,p)*T.radDeg,e.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var w=e.ascaleX,A=e.ascaleY;if(i||r){switch(e.inherit){case 3:case 4:p=t-e.worldX,f=n-e.worldY}var b=e.data.length*w;if(b>1e-4){var S=p*p+f*f;if(i&&S<b*b||r&&S>b*b){var x=(Math.sqrt(S)/b-1)*s+1;w*=x,a&&(A*=x)}}}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+d*s,w,A,e.ashearX,e.ashearY)},t.apply2=function(e,t,n,i,r,a,s,o,c){if(0==e.inherit&&0==t.inherit){var h=e.ax,u=e.ay,l=e.ascaleX,d=e.ascaleY,p=l,f=d,m=t.ascaleX,g=0,v=0,y=0;l<0?(l=-l,g=180,y=-1):(g=0,y=1),d<0&&(d=-d,y=-y),m<0?(m=-m,v=180):v=0;var E=t.ax,C=0,w=0,A=0,b=e.a,S=e.b,x=e.c,k=e.d,P=Math.abs(l-d)<=1e-4;!P||a?(C=0,w=b*E+e.worldX,A=x*E+e.worldY):(w=b*E+S*(C=t.ay)+e.worldX,A=x*E+k*C+e.worldY);var I=e.parent;if(!I)throw new Error("IK parent must itself have a parent.");b=I.a,S=I.b,x=I.c;var O,R,B=b*(k=I.d)-S*x,D=w-I.worldX,L=A-I.worldY,M=(D*k-L*S)*(B=Math.abs(B)<=1e-4?0:1/B)-h,_=(L*b-D*x)*B-u,N=Math.sqrt(M*M+_*_),G=t.data.length*m;if(N<1e-4)return this.apply1(e,n,i,!1,a,!1,c),void t.updateWorldTransformWith(E,C,0,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY);var F=((D=n-I.worldX)*k-(L=i-I.worldY)*S)*B-h,Z=(L*b-D*x)*B-u,U=F*F+Z*Z;if(0!=o){o*=l*(m+1)*.5;var W=Math.sqrt(U),Y=W-N-G*l+o;if(Y>0){var H=Math.min(1,Y/(2*o))-1;U=(F-=(H=(Y-o*(1-H*H))/W)*F)*F+(Z-=H*Z)*Z}}e:if(P){var z=(U-N*N-(G*=l)*G)/(2*N*G);z<-1?(z=-1,R=Math.PI*r):z>1?(z=1,R=0,a&&(p*=b=(Math.sqrt(U)/(N+G)-1)*c+1,s&&(f*=b))):R=Math.acos(z)*r,b=N+G*z,S=G*Math.sin(R),O=Math.atan2(Z*b-F*S,F*b+Z*S)}else{var K=(b=l*G)*b,V=(S=d*G)*S,X=Math.atan2(Z,F),j=-2*V*N,q=V-K;if((k=j*j-4*q*(x=V*N*N+K*U-K*V))>=0){var J=Math.sqrt(k);j<0&&(J=-J);var Q=(J=.5*-(j+J))/q,$=x/J,ee=Math.abs(Q)<Math.abs($)?Q:$;if(ee*ee<=U){L=Math.sqrt(U-ee*ee)*r,O=X-Math.atan2(L,ee),R=Math.atan2(L/d,(ee-N)/l);break e}}var te=T.PI,ne=N-b,ie=ne*ne,re=0,ae=0,se=N+b,oe=se*se,ce=0;(x=-b*N/(K-V))>=-1&&x<=1&&(x=Math.acos(x),(k=(D=b*Math.cos(x)+N)*D+(L=S*Math.sin(x))*L)<ie&&(te=x,ie=k,ne=D,re=L),k>oe&&(ae=x,oe=k,se=D,ce=L)),U<=.5*(ie+oe)?(O=X-Math.atan2(re*r,ne),R=te*r):(O=X-Math.atan2(ce*r,se),R=ae*r)}var he=Math.atan2(C,E)*y,ue=e.arotation;(O=(O-he)*T.radDeg+g-ue)>180?O-=360:O<-180&&(O+=360),e.updateWorldTransformWith(h,u,ue+O*c,p,f,0,0),ue=t.arotation,(R=((R+he)*T.radDeg-t.ashearX)*y+v-ue)>180?R-=360:R<-180&&(R+=360),t.updateWorldTransformWith(E,C,ue+R*c,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)}},e}(),bt=function(e){function t(t){var n;return(n=e.call(this,t,0,!1)||this).bones=new Array,n._target=null,n.bendDirection=0,n.compress=!1,n.stretch=!1,n.uniform=!1,n.mix=0,n.softness=0,n}return(0,a.Z)(t,e),(0,i.Z)(t,[{key:"target",get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(e){this._target=e}}]),t}(vt),St=function(e){function t(t){var n;return(n=e.call(this,t,0,!1)||this).bones=new Array,n._target=null,n.positionMode=Tt.Fixed,n.spacingMode=xt.Fixed,n.rotateMode=kt.Chain,n.offsetRotation=0,n.position=0,n.spacing=0,n.mixRotate=0,n.mixX=0,n.mixY=0,n}return(0,a.Z)(t,e),(0,i.Z)(t,[{key:"target",get:function(){if(this._target)return this._target;throw new Error("SlotData not set.")},set:function(e){this._target=e}}]),t}(vt),Tt=((ut=Tt||{})[ut.Fixed=0]="Fixed",ut[ut.Percent=1]="Percent",ut),xt=((lt=xt||{})[lt.Length=0]="Length",lt[lt.Fixed=1]="Fixed",lt[lt.Percent=2]="Percent",lt[lt.Proportional=3]="Proportional",lt),kt=((dt=kt||{})[dt.Tangent=0]="Tangent",dt[dt.Chain=1]="Chain",dt[dt.ChainScale=2]="ChainScale",dt),Pt=function(){function e(e,t){if(this.data=void 0,this.bones=void 0,this.target=void 0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(var n=0,i=e.bones.length;n<i;n++){var r=t.findBone(e.bones[n].name);if(!r)throw new Error("Couldn't find bone "+e.bones[n].name+".");this.bones.push(r)}var a=t.findSlot(e.target.name);if(!a)throw new Error("Couldn't find target bone "+e.target.name);this.target=a,this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}var t=e.prototype;return t.isActive=function(){return this.active},t.setToSetupPose=function(){var e=this.data;this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY},t.update=function(t){var n=this.target.getAttachment();if(n instanceof st){var i=this.mixRotate,r=this.mixX,a=this.mixY;if(0!=i||0!=r||0!=a){var s=this.data,o=0==s.rotateMode,c=2==s.rotateMode,h=this.bones,u=h.length,l=o?u:u+1,d=I.setArraySize(this.spaces,l),p=c?this.lengths=I.setArraySize(this.lengths,u):[],f=this.spacing;switch(s.spacingMode){case 2:if(c)for(var m=0,g=l-1;m<g;m++){var v=h[m],y=v.data.length,E=y*v.a,C=y*v.c;p[m]=Math.sqrt(E*E+C*C)}I.arrayFill(d,1,l,f);break;case 3:for(var w=0,A=0,b=l-1;A<b;){var S=h[A],x=S.data.length;if(x<e.epsilon)c&&(p[A]=0),d[++A]=f;else{var k=x*S.a,P=x*S.c,O=Math.sqrt(k*k+P*P);c&&(p[A]=O),d[++A]=O,w+=O}}if(w>0){w=l/w*f;for(var R=1;R<l;R++)d[R]*=w}break;default:for(var B=0==s.spacingMode,D=0,L=l-1;D<L;){var M=h[D],_=M.data.length;if(_<e.epsilon)c&&(p[D]=0),d[++D]=f;else{var N=_*M.a,G=_*M.c,F=Math.sqrt(N*N+G*G);c&&(p[D]=F),d[++D]=(B?_+f:f)*F/_}}}var Z=this.computeWorldPositions(n,l,o),U=Z[0],W=Z[1],Y=s.offsetRotation,H=!1;if(0==Y)H=1==s.rotateMode;else{H=!1;var z=this.target.bone;Y*=z.a*z.d-z.b*z.c>0?T.degRad:-T.degRad}for(var K=0,V=3;K<u;K++,V+=3){var X=h[K];X.worldX+=(U-X.worldX)*r,X.worldY+=(W-X.worldY)*a;var j=Z[V],q=Z[V+1],J=j-U,Q=q-W;if(c){var $=p[K];if(0!=$){var ee=(Math.sqrt(J*J+Q*Q)/$-1)*i+1;X.a*=ee,X.c*=ee}}if(U=j,W=q,i>0){var te=X.a,ne=X.b,ie=X.c,re=X.d,ae=0,se=0,oe=0;if(ae=o?Z[V-1]:0==d[K+1]?Z[V+2]:Math.atan2(Q,J),ae-=Math.atan2(ie,te),H){se=Math.cos(ae),oe=Math.sin(ae);var ce=X.data.length;U+=(ce*(se*te-oe*ie)-J)*i,W+=(ce*(oe*te+se*ie)-Q)*i}else ae+=Y;ae>T.PI?ae-=T.PI2:ae<-T.PI&&(ae+=T.PI2),ae*=i,se=Math.cos(ae),oe=Math.sin(ae),X.a=se*te-oe*ie,X.b=se*ne-oe*re,X.c=oe*te+se*ie,X.d=oe*ne+se*re}X.updateAppliedTransform()}}}},t.computeWorldPositions=function(t,n,i){var r=this.target,a=this.position,s=this.spaces,o=I.setArraySize(this.positions,3*n+2),c=this.world,h=t.closed,u=t.worldVerticesLength,l=u/6,d=e.NONE;if(!t.constantSpeed){var p,f=t.lengths,m=f[l-=h?1:2];switch(1==this.data.positionMode&&(a*=m),this.data.spacingMode){case 2:p=m;break;case 3:p=m/n;break;default:p=1}c=I.setArraySize(this.world,8);for(var g=0,v=0,y=0;g<n;g++,v+=3){var E=s[g]*p,C=a+=E;if(h)(C%=m)<0&&(C+=m),y=0;else{if(C<0){d!=e.BEFORE&&(d=e.BEFORE,t.computeWorldVertices(r,2,4,c,0,2)),this.addBeforePosition(C,c,0,o,v);continue}if(C>m){d!=e.AFTER&&(d=e.AFTER,t.computeWorldVertices(r,u-6,4,c,0,2)),this.addAfterPosition(C-m,c,0,o,v);continue}}for(;;y++){var w=f[y];if(!(C>w)){if(0==y)C/=w;else{var A=f[y-1];C=(C-A)/(w-A)}break}}y!=d&&(d=y,h&&y==l?(t.computeWorldVertices(r,u-4,4,c,0,2),t.computeWorldVertices(r,0,4,c,4,2)):t.computeWorldVertices(r,6*y+2,8,c,0,2)),this.addCurvePosition(C,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],o,v,i||g>0&&0==E)}return o}h?(u+=2,c=I.setArraySize(this.world,u),t.computeWorldVertices(r,2,u-4,c,0,2),t.computeWorldVertices(r,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(l--,u-=4,c=I.setArraySize(this.world,u),t.computeWorldVertices(r,2,u,c,0,2));for(var b,S=I.setArraySize(this.curves,l),T=0,x=c[0],k=c[1],P=0,O=0,R=0,B=0,D=0,L=0,M=0,_=0,N=0,G=0,F=0,Z=0,U=0,W=0,Y=0,H=2;Y<l;Y++,H+=6)P=c[H],O=c[H+1],R=c[H+2],B=c[H+3],F=2*(M=.1875*(x-2*P+R))+(N=.09375*(3*(P-R)-x+(D=c[H+4]))),Z=2*(_=.1875*(k-2*O+B))+(G=.09375*(3*(O-B)-k+(L=c[H+5]))),U=.75*(P-x)+M+.16666667*N,W=.75*(O-k)+_+.16666667*G,T+=Math.sqrt(U*U+W*W),U+=F,W+=Z,F+=N,Z+=G,T+=Math.sqrt(U*U+W*W),U+=F,W+=Z,T+=Math.sqrt(U*U+W*W),U+=F+N,W+=Z+G,T+=Math.sqrt(U*U+W*W),S[Y]=T,x=D,k=L;switch(1==this.data.positionMode&&(a*=T),this.data.spacingMode){case 2:b=T;break;case 3:b=T/n;break;default:b=1}for(var z=this.segments,K=0,V=0,X=0,j=0,q=0;V<n;V++,X+=3){var J=s[V]*b,Q=a+=J;if(h)(Q%=T)<0&&(Q+=T),j=0;else{if(Q<0){this.addBeforePosition(Q,c,0,o,X);continue}if(Q>T){this.addAfterPosition(Q-T,c,u-4,o,X);continue}}for(;;j++){var $=S[j];if(!(Q>$)){if(0==j)Q/=$;else{var ee=S[j-1];Q=(Q-ee)/($-ee)}break}}if(j!=d){d=j;var te=6*j;for(x=c[te],k=c[te+1],P=c[te+2],O=c[te+3],R=c[te+4],B=c[te+5],F=2*(M=.03*(x-2*P+R))+(N=.006*(3*(P-R)-x+(D=c[te+6]))),Z=2*(_=.03*(k-2*O+B))+(G=.006*(3*(O-B)-k+(L=c[te+7]))),U=.3*(P-x)+M+.16666667*N,W=.3*(O-k)+_+.16666667*G,K=Math.sqrt(U*U+W*W),z[0]=K,te=1;te<8;te++)U+=F,W+=Z,F+=N,Z+=G,K+=Math.sqrt(U*U+W*W),z[te]=K;U+=F,W+=Z,K+=Math.sqrt(U*U+W*W),z[8]=K,U+=F+N,W+=Z+G,K+=Math.sqrt(U*U+W*W),z[9]=K,q=0}for(Q*=K;;q++){var ne=z[q];if(!(Q>ne)){if(0==q)Q/=ne;else{var ie=z[q-1];Q=q+(Q-ie)/(ne-ie)}break}}this.addCurvePosition(.1*Q,x,k,P,O,R,B,D,L,o,X,i||V>0&&0==J)}return o},t.addBeforePosition=function(e,t,n,i,r){var a=t[n],s=t[n+1],o=t[n+2]-a,c=t[n+3]-s,h=Math.atan2(c,o);i[r]=a+e*Math.cos(h),i[r+1]=s+e*Math.sin(h),i[r+2]=h},t.addAfterPosition=function(e,t,n,i,r){var a=t[n+2],s=t[n+3],o=a-t[n],c=s-t[n+1],h=Math.atan2(c,o);i[r]=a+e*Math.cos(h),i[r+1]=s+e*Math.sin(h),i[r+2]=h},t.addCurvePosition=function(e,t,n,i,r,a,s,o,c,h,u,l){if(0==e||isNaN(e))return h[u]=t,h[u+1]=n,void(h[u+2]=Math.atan2(r-n,i-t));var d=e*e,p=d*e,f=1-e,m=f*f,g=m*f,v=f*e,y=3*v,E=f*y,C=y*e,w=t*g+i*E+a*C+o*p,A=n*g+r*E+s*C+c*p;h[u]=w,h[u+1]=A,l&&(h[u+2]=e<.001?Math.atan2(r-n,i-t):Math.atan2(A-(n*m+r*v*2+s*d),w-(t*m+i*v*2+a*d)))},e}(),It=Pt;d(It,"NONE",-1),d(It,"BEFORE",-2),d(It,"AFTER",-3),d(It,"epsilon",1e-5);var Ot=function(){function e(e,t){this.data=void 0,this._bone=null,this.inertia=0,this.strength=0,this.damping=0,this.massInverse=0,this.wind=0,this.gravity=0,this.mix=0,this._reset=!0,this.ux=0,this.uy=0,this.cx=0,this.cy=0,this.tx=0,this.ty=0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0,this.active=!1,this.skeleton=void 0,this.remaining=0,this.lastTime=0,this.data=e,this.skeleton=t,this.bone=t.bones[e.bone.index],this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}var t=e.prototype;return t.reset=function(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0},t.setToSetupPose=function(){var e=this.data;this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix},t.isActive=function(){return this.active},t.update=function(e){var t=this.mix;if(0!=t){var n=this.data.x>0,i=this.data.y>0,r=this.data.rotate>0||this.data.shearX>0,a=this.data.scaleX>0,s=this.bone,o=s.data.length;switch(e){case 0:return;case 1:this.reset();case 2:var c=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=c,this.lastTime=this.skeleton.time;var h=s.worldX,u=s.worldY;if(this._reset)this._reset=!1,this.ux=h,this.uy=u;else{var l=this.remaining,d=this.inertia,p=this.data.limit*c,f=this.data.step,m=this.skeleton.data.referenceScale,g=-1;if(n||i){if(n){var v=(this.ux-h)*d;this.xOffset+=v>p?p:v<-p?-p:v,this.ux=h}if(i){var y=(this.uy-u)*d;this.yOffset+=y>p?p:y<-p?-p:y,this.uy=u}if(l>=f){g=Math.pow(this.damping,60*f);var E=this.massInverse*f,C=this.strength,w=this.wind*m,A=(Lt.yDown?-this.gravity:this.gravity)*m;do{n&&(this.xVelocity+=(w-this.xOffset*C)*E,this.xOffset+=this.xVelocity*f,this.xVelocity*=g),i&&(this.yVelocity-=(A+this.yOffset*C)*E,this.yOffset+=this.yVelocity*f,this.yVelocity*=g),l-=f}while(l>=f)}n&&(s.worldX+=this.xOffset*t*this.data.x),i&&(s.worldY+=this.yOffset*t*this.data.y)}if(r||a){var b=Math.atan2(s.c,s.a),S=0,x=0,k=0,P=this.cx-s.worldX,I=this.cy-s.worldY;if(P>p?P=p:P<-p&&(P=-p),I>p?I=p:I<-p&&(I=-p),r){k=(this.data.rotate+this.data.shearX)*t;var O=Math.atan2(I+this.ty,P+this.tx)-b-this.rotateOffset*k;this.rotateOffset+=(O-Math.ceil(O*T.invPI2-.5)*T.PI2)*d,O=this.rotateOffset*k+b,S=Math.cos(O),x=Math.sin(O),a&&(O=o*s.getWorldScaleX())>0&&(this.scaleOffset+=(P*S+I*x)*d/O)}else{S=Math.cos(b),x=Math.sin(b);var R=o*s.getWorldScaleX();R>0&&(this.scaleOffset+=(P*S+I*x)*d/R)}if((l=this.remaining)>=f){-1==g&&(g=Math.pow(this.damping,60*f));for(var B=this.massInverse*f,D=this.strength,L=this.wind,M=Lt.yDown?-this.gravity:this.gravity,_=o/m;;)if(l-=f,a&&(this.scaleVelocity+=(L*S-M*x-this.scaleOffset*D)*B,this.scaleOffset+=this.scaleVelocity*f,this.scaleVelocity*=g),r){if(this.rotateVelocity-=((L*x+M*S)*_+this.rotateOffset*D)*B,this.rotateOffset+=this.rotateVelocity*f,this.rotateVelocity*=g,l<f)break;var N=this.rotateOffset*k+b;S=Math.cos(N),x=Math.sin(N)}else if(l<f)break}}this.remaining=l}this.cx=s.worldX,this.cy=s.worldY;break;case 3:n&&(s.worldX+=this.xOffset*t*this.data.x),i&&(s.worldY+=this.yOffset*t*this.data.y)}if(r){var G=this.rotateOffset*t,F=0,Z=0,U=0;if(this.data.shearX>0){var W=0;this.data.rotate>0&&(W=G*this.data.rotate,F=Math.sin(W),Z=Math.cos(W),U=s.b,s.b=Z*U-F*s.d,s.d=F*U+Z*s.d),W+=G*this.data.shearX,F=Math.sin(W),Z=Math.cos(W),U=s.a,s.a=Z*U-F*s.c,s.c=F*U+Z*s.c}else G*=this.data.rotate,F=Math.sin(G),Z=Math.cos(G),U=s.a,s.a=Z*U-F*s.c,s.c=F*U+Z*s.c,U=s.b,s.b=Z*U-F*s.d,s.d=F*U+Z*s.d}if(a){var Y=1+this.scaleOffset*t*this.data.scaleX;s.a*=Y,s.c*=Y}3!=e&&(this.tx=o*s.a,this.ty=o*s.c),s.updateAppliedTransform()}},t.translate=function(e,t){this.ux-=e,this.uy-=t,this.cx-=e,this.cy-=t},t.rotate=function(e,t,n){var i=n*T.degRad,r=Math.cos(i),a=Math.sin(i),s=this.cx-e,o=this.cy-t;this.translate(s*r-o*a-s,s*a+o*r-o)},(0,i.Z)(e,[{key:"bone",get:function(){if(this._bone)return this._bone;throw new Error("Bone not set.")},set:function(e){this._bone=e}}]),e}(),Rt=function(){function e(e,t){if(this.data=void 0,this.bone=void 0,this.color=void 0,this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!e)throw new Error("data cannot be null.");if(!t)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new b,this.darkColor=e.darkColor?new b:null,this.setToSetupPose()}var t=e.prototype;return t.getSkeleton=function(){return this.bone.skeleton},t.getAttachment=function(){return this.attachment},t.setAttachment=function(e){this.attachment!=e&&(e instanceof _&&this.attachment instanceof _&&e.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=e,this.sequenceIndex=-1)},t.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null},e}(),Bt=function(){function e(e,t){if(this.data=void 0,this.bones=void 0,this.target=void 0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new B,this.active=!1,!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(var n=0;n<e.bones.length;n++){var i=t.findBone(e.bones[n].name);if(!i)throw new Error("Couldn't find bone "+e.bones[n].name+".");this.bones.push(i)}var r=t.findBone(e.target.name);if(!r)throw new Error("Couldn't find target bone "+e.target.name+".");this.target=r,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}var t=e.prototype;return t.isActive=function(){return this.active},t.setToSetupPose=function(){var e=this.data;this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY},t.update=function(e){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleY&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())},t.applyAbsoluteWorld=function(){for(var e=this.mixRotate,t=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,s=0!=t||0!=n,o=this.target,c=o.a,h=o.b,u=o.c,l=o.d,d=c*l-h*u>0?T.degRad:-T.degRad,p=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones,g=0,v=m.length;g<v;g++){var y=m[g];if(0!=e){var E=y.a,C=y.b,w=y.c,A=y.d,b=Math.atan2(u,c)-Math.atan2(w,E)+p;b>T.PI?b-=T.PI2:b<-T.PI&&(b+=T.PI2),b*=e;var S=Math.cos(b),x=Math.sin(b);y.a=S*E-x*w,y.b=S*C-x*A,y.c=x*E+S*w,y.d=x*C+S*A}if(s){var k=this.temp;o.localToWorld(k.set(this.data.offsetX,this.data.offsetY)),y.worldX+=(k.x-y.worldX)*t,y.worldY+=(k.y-y.worldY)*n}if(0!=i){var P=Math.sqrt(y.a*y.a+y.c*y.c);0!=P&&(P=(P+(Math.sqrt(c*c+u*u)-P+this.data.offsetScaleX)*i)/P),y.a*=P,y.c*=P}if(0!=r){var I=Math.sqrt(y.b*y.b+y.d*y.d);0!=I&&(I=(I+(Math.sqrt(h*h+l*l)-I+this.data.offsetScaleY)*r)/I),y.b*=I,y.d*=I}if(a>0){var O=y.b,R=y.d,B=Math.atan2(R,O),D=Math.atan2(l,h)-Math.atan2(u,c)-(B-Math.atan2(y.c,y.a));D>T.PI?D-=T.PI2:D<-T.PI&&(D+=T.PI2),D=B+(D+f)*a;var L=Math.sqrt(O*O+R*R);y.b=Math.cos(D)*L,y.d=Math.sin(D)*L}y.updateAppliedTransform()}},t.applyRelativeWorld=function(){for(var e=this.mixRotate,t=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,s=0!=t||0!=n,o=this.target,c=o.a,h=o.b,u=o.c,l=o.d,d=c*l-h*u>0?T.degRad:-T.degRad,p=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones,g=0,v=m.length;g<v;g++){var y=m[g];if(0!=e){var E=y.a,C=y.b,w=y.c,A=y.d,b=Math.atan2(u,c)+p;b>T.PI?b-=T.PI2:b<-T.PI&&(b+=T.PI2),b*=e;var S=Math.cos(b),x=Math.sin(b);y.a=S*E-x*w,y.b=S*C-x*A,y.c=x*E+S*w,y.d=x*C+S*A}if(s){var k=this.temp;o.localToWorld(k.set(this.data.offsetX,this.data.offsetY)),y.worldX+=k.x*t,y.worldY+=k.y*n}if(0!=i){var P=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*i+1;y.a*=P,y.c*=P}if(0!=r){var I=(Math.sqrt(h*h+l*l)-1+this.data.offsetScaleY)*r+1;y.b*=I,y.d*=I}if(a>0){var O=Math.atan2(l,h)-Math.atan2(u,c);O>T.PI?O-=T.PI2:O<-T.PI&&(O+=T.PI2);var R=y.b,B=y.d;O=Math.atan2(B,R)+(O-T.PI/2+f)*a;var D=Math.sqrt(R*R+B*B);y.b=Math.cos(O)*D,y.d=Math.sin(O)*D}y.updateAppliedTransform()}},t.applyAbsoluteLocal=function(){for(var e=this.mixRotate,t=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,s=this.target,o=this.bones,c=0,h=o.length;c<h;c++){var u=o[c],l=u.arotation;0!=e&&(l+=(s.arotation-l+this.data.offsetRotation)*e);var d=u.ax,p=u.ay;d+=(s.ax-d+this.data.offsetX)*t,p+=(s.ay-p+this.data.offsetY)*n;var f=u.ascaleX,m=u.ascaleY;0!=i&&0!=f&&(f=(f+(s.ascaleX-f+this.data.offsetScaleX)*i)/f),0!=r&&0!=m&&(m=(m+(s.ascaleY-m+this.data.offsetScaleY)*r)/m);var g=u.ashearY;0!=a&&(g+=(s.ashearY-g+this.data.offsetShearY)*a),u.updateWorldTransformWith(d,p,l,f,m,u.ashearX,g)}},t.applyRelativeLocal=function(){for(var e=this.mixRotate,t=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,s=this.target,o=this.bones,c=0,h=o.length;c<h;c++){var u=o[c],l=u.arotation+(s.arotation+this.data.offsetRotation)*e,d=u.ax+(s.ax+this.data.offsetX)*t,p=u.ay+(s.ay+this.data.offsetY)*n,f=u.ascaleX*((s.ascaleX-1+this.data.offsetScaleX)*i+1),m=u.ascaleY*((s.ascaleY-1+this.data.offsetScaleY)*r+1),g=u.ashearY+(s.ashearY+this.data.offsetShearY)*a;u.updateWorldTransformWith(d,p,l,f,m,u.ashearX,g)}},e}(),Dt=function(){function e(e){if(this.data=void 0,this.bones=void 0,this.slots=void 0,this.drawOrder=void 0,this.ikConstraints=void 0,this.transformConstraints=void 0,this.pathConstraints=void 0,this.physicsConstraints=void 0,this._updateCache=new Array,this.skin=null,this.color=void 0,this.scaleX=1,this._scaleY=1,this.x=0,this.y=0,this.time=0,!e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var t=0;t<e.bones.length;t++){var n=e.bones[t],i=void 0;if(n.parent){var r=this.bones[n.parent.index];i=new gt(n,this,r),r.children.push(i)}else i=new gt(n,this,null);this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var a=0;a<e.slots.length;a++){var s=e.slots[a],o=this.bones[s.boneData.index],c=new Rt(s,o);this.slots.push(c),this.drawOrder.push(c)}this.ikConstraints=new Array;for(var h=0;h<e.ikConstraints.length;h++){var u=e.ikConstraints[h];this.ikConstraints.push(new At(u,this))}this.transformConstraints=new Array;for(var l=0;l<e.transformConstraints.length;l++){var d=e.transformConstraints[l];this.transformConstraints.push(new Bt(d,this))}this.pathConstraints=new Array;for(var p=0;p<e.pathConstraints.length;p++){var f=e.pathConstraints[p];this.pathConstraints.push(new It(f,this))}this.physicsConstraints=new Array;for(var m=0;m<e.physicsConstraints.length;m++){var g=e.physicsConstraints[m];this.physicsConstraints.push(new Ot(g,this))}this.color=new b(1,1,1,1),this.updateCache()}var t=e.prototype;return t.updateCache=function(){var e=this._updateCache;e.length=0;for(var t=this.bones,n=0,i=t.length;n<i;n++){var r=t[n];r.sorted=r.data.skinRequired,r.active=!r.sorted}if(this.skin)for(var a=this.skin.bones,s=0,o=this.skin.bones.length;s<o;s++){var c=this.bones[a[s].index];do{c.sorted=!1,c.active=!0,c=c.parent}while(c)}var h=this.ikConstraints,u=this.transformConstraints,l=this.pathConstraints,d=this.physicsConstraints,p=h.length,f=u.length,m=l.length,g=this.physicsConstraints.length,v=p+f+m+g;e:for(var y=0;y<v;y++){for(var E=0;E<p;E++){var C=h[E];if(C.data.order==y){this.sortIkConstraint(C);continue e}}for(var w=0;w<f;w++){var A=u[w];if(A.data.order==y){this.sortTransformConstraint(A);continue e}}for(var b=0;b<m;b++){var S=l[b];if(S.data.order==y){this.sortPathConstraint(S);continue e}}for(var T=0;T<g;T++){var x=d[T];if(x.data.order==y){this.sortPhysicsConstraint(x);continue e}}}for(var k=0,P=t.length;k<P;k++)this.sortBone(t[k])},t.sortIkConstraint=function(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&I.contains(this.skin.constraints,e.data,!0)),e.active){var t=e.target;this.sortBone(t);var n=e.bones,i=n[0];if(this.sortBone(i),1==n.length)this._updateCache.push(e),this.sortReset(i.children);else{var r=n[n.length-1];this.sortBone(r),this._updateCache.push(e),this.sortReset(i.children),r.sorted=!0}}},t.sortPathConstraint=function(e){if(e.active=e.target.bone.isActive()&&(!e.data.skinRequired||this.skin&&I.contains(this.skin.constraints,e.data,!0)),e.active){var t=e.target,n=t.data.index,i=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,n,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(var r=0,a=this.data.skins.length;r<a;r++)this.sortPathConstraintAttachment(this.data.skins[r],n,i);var s=t.getAttachment();s instanceof st&&this.sortPathConstraintAttachmentWith(s,i);for(var o=e.bones,c=o.length,h=0;h<c;h++)this.sortBone(o[h]);this._updateCache.push(e);for(var u=0;u<c;u++)this.sortReset(o[u].children);for(var l=0;l<c;l++)o[l].sorted=!0}},t.sortTransformConstraint=function(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&I.contains(this.skin.constraints,e.data,!0)),e.active){this.sortBone(e.target);var t=e.bones,n=t.length;if(e.data.local)for(var i=0;i<n;i++){var r=t[i];this.sortBone(r.parent),this.sortBone(r)}else for(var a=0;a<n;a++)this.sortBone(t[a]);this._updateCache.push(e);for(var s=0;s<n;s++)this.sortReset(t[s].children);for(var o=0;o<n;o++)t[o].sorted=!0}},t.sortPathConstraintAttachment=function(e,t,n){var i=e.attachments[t];if(i)for(var r in i)this.sortPathConstraintAttachmentWith(i[r],n)},t.sortPathConstraintAttachmentWith=function(e,t){if(e instanceof st){var n=e.bones;if(n)for(var i=this.bones,r=0,a=n.length;r<a;){var s=n[r++];for(s+=r;r<s;)this.sortBone(i[n[r++]])}else this.sortBone(t)}},t.sortPhysicsConstraint=function(e){var t=e.bone;e.active=t.active&&(!e.data.skinRequired||null!=this.skin&&I.contains(this.skin.constraints,e.data,!0)),e.active&&(this.sortBone(t),this._updateCache.push(e),this.sortReset(t.children),t.sorted=!0)},t.sortBone=function(e){if(e&&!e.sorted){var t=e.parent;t&&this.sortBone(t),e.sorted=!0,this._updateCache.push(e)}},t.sortReset=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},t.updateWorldTransform=function(e){if(void 0===e||null===e)throw new Error("physics is undefined");for(var t=this.bones,n=0,i=t.length;n<i;n++){var r=t[n];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY}for(var a=this._updateCache,s=0,o=a.length;s<o;s++)a[s].update(e)},t.updateWorldTransformWith=function(e,t){var n=this.getRootBone();if(!n)throw new Error("Root bone must not be null.");var i=t.a,r=t.b,a=t.c,s=t.d;n.worldX=i*this.x+r*this.y+t.worldX,n.worldY=a*this.x+s*this.y+t.worldY;var o=(n.rotation+n.shearX)*T.degRad,c=(n.rotation+90+n.shearY)*T.degRad,h=Math.cos(o)*n.scaleX,u=Math.cos(c)*n.scaleY,l=Math.sin(o)*n.scaleX,d=Math.sin(c)*n.scaleY;n.a=(i*h+r*l)*this.scaleX,n.b=(i*u+r*d)*this.scaleX,n.c=(a*h+s*l)*this.scaleY,n.d=(a*u+s*d)*this.scaleY;for(var p=this._updateCache,f=0,m=p.length;f<m;f++){var g=p[f];g!=n&&g.update(e)}},t.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},t.setBonesToSetupPose=function(){for(var e,t=s(this.bones);!(e=t()).done;){e.value.setToSetupPose()}for(var n,i=s(this.ikConstraints);!(n=i()).done;){n.value.setToSetupPose()}for(var r,a=s(this.transformConstraints);!(r=a()).done;){r.value.setToSetupPose()}for(var o,c=s(this.pathConstraints);!(o=c()).done;){o.value.setToSetupPose()}for(var h,u=s(this.physicsConstraints);!(h=u()).done;){h.value.setToSetupPose()}},t.setSlotsToSetupPose=function(){var e=this.slots;I.arrayCopy(e,0,this.drawOrder,0,e.length);for(var t=0,n=e.length;t<n;t++)e[t].setToSetupPose()},t.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},t.findBone=function(e){if(!e)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,i=t.length;n<i;n++){var r=t[n];if(r.data.name==e)return r}return null},t.findSlot=function(e){if(!e)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,i=t.length;n<i;n++){var r=t[n];if(r.data.name==e)return r}return null},t.setSkinByName=function(e){var t=this.data.findSkin(e);if(!t)throw new Error("Skin not found: "+e);this.setSkin(t)},t.setSkin=function(e){if(e!=this.skin){if(e)if(this.skin)e.attachAll(this,this.skin);else for(var t=this.slots,n=0,i=t.length;n<i;n++){var r=t[n],a=r.data.attachmentName;if(a){var s=e.getAttachment(n,a);s&&r.setAttachment(s)}}this.skin=e,this.updateCache()}},t.getAttachmentByName=function(e,t){var n=this.data.findSlot(e);if(!n)throw new Error("Can't find slot with name "+e);return this.getAttachment(n.index,t)},t.getAttachment=function(e,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){var n=this.skin.getAttachment(e,t);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null},t.setAttachment=function(e,t){if(!e)throw new Error("slotName cannot be null.");for(var n=this.slots,i=0,r=n.length;i<r;i++){var a=n[i];if(a.data.name==e){var s=null;if(t&&!(s=this.getAttachment(i,t)))throw new Error("Attachment not found: "+t+", for slot: "+e);return void a.setAttachment(s)}}throw new Error("Slot not found: "+e)},t.findIkConstraint=function(e){var t;if(!e)throw new Error("constraintName cannot be null.");return null!=(t=this.ikConstraints.find((function(t){return t.data.name==e})))?t:null},t.findTransformConstraint=function(e){var t;if(!e)throw new Error("constraintName cannot be null.");return null!=(t=this.transformConstraints.find((function(t){return t.data.name==e})))?t:null},t.findPathConstraint=function(e){var t;if(!e)throw new Error("constraintName cannot be null.");return null!=(t=this.pathConstraints.find((function(t){return t.data.name==e})))?t:null},t.findPhysicsConstraint=function(e){var t;if(null==e)throw new Error("constraintName cannot be null.");return null!=(t=this.physicsConstraints.find((function(t){return t.data.name==e})))?t:null},t.getBoundsRect=function(){var e=new B,t=new B;return this.getBounds(e,t),{x:e.x,y:e.y,width:t.x,height:t.y}},t.getBounds=function(t,n,i,r){if(void 0===i&&(i=new Array(2)),void 0===r&&(r=null),!t)throw new Error("offset cannot be null.");if(!n)throw new Error("size cannot be null.");for(var a=this.drawOrder,s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,u=0,l=a.length;u<l;u++){var d=a[u];if(d.bone.active){var p=0,f=null,m=null,g=d.getAttachment();if(g instanceof ct)p=8,f=I.setArraySize(i,p,0),g.computeWorldVertices(d,f,0,2),m=e.quadTriangles;else if(g instanceof at){var v=g;p=v.worldVerticesLength,f=I.setArraySize(i,p,0),v.computeWorldVertices(d,0,p,f,0,2),m=v.triangles}else if(g instanceof je&&null!=r){r.clipStart(d,g);continue}if(f&&m){null!=r&&r.isClipping()&&(r.clipTriangles(f,m,m.length),f=r.clippedVertices,p=r.clippedVertices.length);for(var y=0,E=f.length;y<E;y+=2){var C=f[y],w=f[y+1];s=Math.min(s,C),o=Math.min(o,w),c=Math.max(c,C),h=Math.max(h,w)}}null!=r&&r.clipEndWithSlot(d)}}null!=r&&r.clipEnd(),t.set(s,o),n.set(c-s,h-o)},t.update=function(e){this.time+=e},t.physicsTranslate=function(e,t){for(var n=this.physicsConstraints,i=0,r=n.length;i<r;i++)n[i].translate(e,t)},t.physicsRotate=function(e,t,n){for(var i=this.physicsConstraints,r=0,a=i.length;r<a;r++)i[r].rotate(e,t,n)},(0,i.Z)(e,[{key:"scaleY",get:function(){return e.yDown?-this._scaleY:this._scaleY},set:function(e){this._scaleY=e}}]),e}(),Lt=Dt;d(Lt,"quadTriangles",[0,1,2,2,3,0]),d(Lt,"yDown",!1);var Mt,_t,Nt,Gt=((Mt=Gt||{})[Mt.none=0]="none",Mt[Mt.reset=1]="reset",Mt[Mt.update=2]="update",Mt[Mt.pose=3]="pose",Mt),Ft=function(e){function t(t){var n;return(n=e.call(this,t,0,!1)||this)._bone=null,n.x=0,n.y=0,n.rotate=0,n.scaleX=0,n.shearX=0,n.limit=0,n.step=0,n.inertia=0,n.strength=0,n.damping=0,n.massInverse=0,n.wind=0,n.gravity=0,n.mix=0,n.inertiaGlobal=!1,n.strengthGlobal=!1,n.dampingGlobal=!1,n.massGlobal=!1,n.windGlobal=!1,n.gravityGlobal=!1,n.mixGlobal=!1,n}return(0,a.Z)(t,e),(0,i.Z)(t,[{key:"bone",get:function(){if(this._bone)return this._bone;throw new Error("BoneData not set.")},set:function(e){this._bone=e}}]),t}(vt),Zt=function(){function e(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.physicsConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.referenceScale=100,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}var t=e.prototype;return t.findBone=function(e){if(!e)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findSlot=function(e){if(!e)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findSkin=function(e){if(!e)throw new Error("skinName cannot be null.");for(var t=this.skins,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findEvent=function(e){if(!e)throw new Error("eventDataName cannot be null.");for(var t=this.events,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findAnimation=function(e){if(!e)throw new Error("animationName cannot be null.");for(var t=this.animations,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findIkConstraint=function(e){if(!e)throw new Error("constraintName cannot be null.");for(var t=this.ikConstraints,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findTransformConstraint=function(e){if(!e)throw new Error("constraintName cannot be null.");for(var t=this.transformConstraints,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findPathConstraint=function(e){if(!e)throw new Error("constraintName cannot be null.");for(var t=this.pathConstraints,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},t.findPhysicsConstraint=function(e){if(!e)throw new Error("constraintName cannot be null.");for(var t=this.physicsConstraints,n=0,i=t.length;n<i;n++){var r=t[n];if(r.name==e)return r}return null},e}(),Ut=function(e,t,n){void 0===e&&(e=0),this.slotIndex=e,this.name=t,this.attachment=n},Wt=function(){function e(e){if(this.name=void 0,this.attachments=new Array,this.bones=Array(),this.constraints=new Array,this.color=new b(.99607843,.61960787,.30980393,1),!e)throw new Error("name cannot be null.");this.name=e}var t=e.prototype;return t.setAttachment=function(e,t,n){if(!n)throw new Error("attachment cannot be null.");var i=this.attachments;e>=i.length&&(i.length=e+1),i[e]||(i[e]={}),i[e][t]=n},t.addSkin=function(e){for(var t=0;t<e.bones.length;t++){for(var n=e.bones[t],i=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==n){i=!0;break}i||this.bones.push(n)}for(var a=0;a<e.constraints.length;a++){for(var s=e.constraints[a],o=!1,c=0;c<this.constraints.length;c++)if(this.constraints[c]==s){o=!0;break}o||this.constraints.push(s)}for(var h=e.getAttachments(),u=0;u<h.length;u++){var l=h[u];this.setAttachment(l.slotIndex,l.name,l.attachment)}},t.copySkin=function(e){for(var t=0;t<e.bones.length;t++){for(var n=e.bones[t],i=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==n){i=!0;break}i||this.bones.push(n)}for(var a=0;a<e.constraints.length;a++){for(var s=e.constraints[a],o=!1,c=0;c<this.constraints.length;c++)if(this.constraints[c]==s){o=!0;break}o||this.constraints.push(s)}for(var h=e.getAttachments(),u=0;u<h.length;u++){var l=h[u];l.attachment&&(l.attachment instanceof at?(l.attachment=l.attachment.newLinkedMesh(),this.setAttachment(l.slotIndex,l.name,l.attachment)):(l.attachment=l.attachment.copy(),this.setAttachment(l.slotIndex,l.name,l.attachment)))}},t.getAttachment=function(e,t){var n=this.attachments[e];return n?n[t]:null},t.removeAttachment=function(e,t){var n=this.attachments[e];n&&delete n[t]},t.getAttachments=function(){for(var e=new Array,t=0;t<this.attachments.length;t++){var n=this.attachments[t];if(n)for(var i in n){var r=n[i];r&&e.push(new Ut(t,i,r))}}return e},t.getAttachmentsForSlot=function(e,t){var n=this.attachments[e];if(n)for(var i in n){var r=n[i];r&&t.push(new Ut(e,i,r))}},t.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},t.attachAll=function(e,t){for(var n=0,i=0;i<e.slots.length;i++){var r=e.slots[i],a=r.getAttachment();if(a&&n<t.attachments.length){var s=t.attachments[n];for(var o in s){if(a==s[o]){var c=this.getAttachment(n,o);c&&r.setAttachment(c);break}}}n++}},e}(),Yt=function(e,t,n){if(this.index=0,this.name=void 0,this.boneData=void 0,this.color=new b(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=Ht.Normal,this.visible=!0,e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");if(!n)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=n},Ht=((_t=Ht||{})[_t.Normal=0]="Normal",_t[_t.Additive=1]="Additive",_t[_t.Multiply=2]="Multiply",_t[_t.Screen=3]="Screen",_t),zt=function(e){function t(t){var n;return(n=e.call(this,t,0,!1)||this).bones=new Array,n._target=null,n.mixRotate=0,n.mixX=0,n.mixY=0,n.mixScaleX=0,n.mixScaleY=0,n.mixShearY=0,n.offsetRotation=0,n.offsetX=0,n.offsetY=0,n.offsetScaleX=0,n.offsetScaleY=0,n.offsetShearY=0,n.relative=!1,n.local=!1,n}return(0,a.Z)(t,e),(0,i.Z)(t,[{key:"target",get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(e){this._target=e}}]),t}(vt),Kt=function(){function e(e){this.scale=1,this.attachmentLoader=void 0,this.linkedMeshes=new Array,this.attachmentLoader=e}var t=e.prototype;return t.readSkeletonData=function(e){var t=this.scale,n=new Zt;n.name="";var i=new Vt(e),r=i.readInt32(),a=i.readInt32();n.hash=0==a&&0==r?null:a.toString(16)+r.toString(16),n.version=i.readString(),n.x=i.readFloat(),n.y=i.readFloat(),n.width=i.readFloat(),n.height=i.readFloat(),n.referenceScale=i.readFloat()*t;var s=i.readBoolean();s&&(n.fps=i.readFloat(),n.imagesPath=i.readString(),n.audioPath=i.readString());var o=0;o=i.readInt(!0);for(var c=0;c<o;c++){var h=i.readString();if(!h)throw new Error("String in string table must not be null.");i.strings.push(h)}o=i.readInt(!0);for(var u=0;u<o;u++){var l=i.readString();if(!l)throw new Error("Bone name must not be null.");var d,p=0==u?null:n.bones[i.readInt(!0)],f=new ft(u,l,p);if(f.rotation=i.readFloat(),f.x=i.readFloat()*t,f.y=i.readFloat()*t,f.scaleX=i.readFloat(),f.scaleY=i.readFloat(),f.shearX=i.readFloat(),f.shearY=i.readFloat(),f.length=i.readFloat()*t,f.inherit=i.readByte(),f.skinRequired=i.readBoolean(),s)b.rgba8888ToColor(f.color,i.readInt32()),f.icon=null!=(d=i.readString())?d:void 0,f.visible=i.readBoolean();n.bones.push(f)}o=i.readInt(!0);for(var m=0;m<o;m++){var g=i.readString();if(!g)throw new Error("Slot name must not be null.");var v=n.bones[i.readInt(!0)],y=new Yt(m,g,v);b.rgba8888ToColor(y.color,i.readInt32());var E=i.readInt32();-1!=E&&b.rgb888ToColor(y.darkColor=new b,E),y.attachmentName=i.readStringRef(),y.blendMode=i.readInt(!0),s&&(y.visible=i.readBoolean()),n.slots.push(y)}o=i.readInt(!0);for(var C,w=0;w<o;w++){var A=i.readString();if(!A)throw new Error("IK constraint data name must not be null.");var S=new bt(A);S.order=i.readInt(!0),C=i.readInt(!0);for(var T=0;T<C;T++)S.bones.push(n.bones[i.readInt(!0)]);S.target=n.bones[i.readInt(!0)];var x=i.readByte();S.skinRequired=0!=(1&x),S.bendDirection=0!=(2&x)?1:-1,S.compress=0!=(4&x),S.stretch=0!=(8&x),S.uniform=0!=(16&x),0!=(32&x)&&(S.mix=0!=(64&x)?i.readFloat():1),0!=(128&x)&&(S.softness=i.readFloat()*t),n.ikConstraints.push(S)}o=i.readInt(!0);for(var k,P=0;P<o;P++){var O=i.readString();if(!O)throw new Error("Transform constraint data name must not be null.");var R=new zt(O);R.order=i.readInt(!0),k=i.readInt(!0);for(var B=0;B<k;B++)R.bones.push(n.bones[i.readInt(!0)]);R.target=n.bones[i.readInt(!0)];var D=i.readByte();R.skinRequired=0!=(1&D),R.local=0!=(2&D),R.relative=0!=(4&D),0!=(8&D)&&(R.offsetRotation=i.readFloat()),0!=(16&D)&&(R.offsetX=i.readFloat()*t),0!=(32&D)&&(R.offsetY=i.readFloat()*t),0!=(64&D)&&(R.offsetScaleX=i.readFloat()),0!=(128&D)&&(R.offsetScaleY=i.readFloat()),0!=(1&(D=i.readByte()))&&(R.offsetShearY=i.readFloat()),0!=(2&D)&&(R.mixRotate=i.readFloat()),0!=(4&D)&&(R.mixX=i.readFloat()),0!=(8&D)&&(R.mixY=i.readFloat()),0!=(16&D)&&(R.mixScaleX=i.readFloat()),0!=(32&D)&&(R.mixScaleY=i.readFloat()),0!=(64&D)&&(R.mixShearY=i.readFloat()),n.transformConstraints.push(R)}o=i.readInt(!0);for(var L,M=0;M<o;M++){var _=i.readString();if(!_)throw new Error("Path constraint data name must not be null.");var N=new St(_);N.order=i.readInt(!0),N.skinRequired=i.readBoolean(),L=i.readInt(!0);for(var G=0;G<L;G++)N.bones.push(n.bones[i.readInt(!0)]);N.target=n.slots[i.readInt(!0)];var F=i.readByte();N.positionMode=1&F,N.spacingMode=F>>1&3,N.rotateMode=F>>3&3,0!=(128&F)&&(N.offsetRotation=i.readFloat()),N.position=i.readFloat(),0==N.positionMode&&(N.position*=t),N.spacing=i.readFloat(),0!=N.spacingMode&&1!=N.spacingMode||(N.spacing*=t),N.mixRotate=i.readFloat(),N.mixX=i.readFloat(),N.mixY=i.readFloat(),n.pathConstraints.push(N)}o=i.readInt(!0);for(var Z=0;Z<o;Z++){var U=i.readString();if(!U)throw new Error("Physics constraint data name must not be null.");var W=new Ft(U);W.order=i.readInt(!0),W.bone=n.bones[i.readInt(!0)];var Y=i.readByte();W.skinRequired=0!=(1&Y),0!=(2&Y)&&(W.x=i.readFloat()),0!=(4&Y)&&(W.y=i.readFloat()),0!=(8&Y)&&(W.rotate=i.readFloat()),0!=(16&Y)&&(W.scaleX=i.readFloat()),0!=(32&Y)&&(W.shearX=i.readFloat()),W.limit=(0!=(64&Y)?i.readFloat():5e3)*t,W.step=1/i.readUnsignedByte(),W.inertia=i.readFloat(),W.strength=i.readFloat(),W.damping=i.readFloat(),W.massInverse=0!=(128&Y)?i.readFloat():1,W.wind=i.readFloat(),W.gravity=i.readFloat(),0!=(1&(Y=i.readByte()))&&(W.inertiaGlobal=!0),0!=(2&Y)&&(W.strengthGlobal=!0),0!=(4&Y)&&(W.dampingGlobal=!0),0!=(8&Y)&&(W.massGlobal=!0),0!=(16&Y)&&(W.windGlobal=!0),0!=(32&Y)&&(W.gravityGlobal=!0),0!=(64&Y)&&(W.mixGlobal=!0),W.mix=0!=(128&Y)?i.readFloat():1,n.physicsConstraints.push(W)}var H=this.readSkin(i,n,!0,s);H&&(n.defaultSkin=H,n.skins.push(H));var z=n.skins.length;for(I.setArraySize(n.skins,o=z+i.readInt(!0));z<o;z++){var K=this.readSkin(i,n,!1,s);if(!K)throw new Error("readSkin() should not have returned null.");n.skins[z]=K}o=this.linkedMeshes.length;for(var V=0;V<o;V++){var X=this.linkedMeshes[V],j=n.skins[X.skinIndex];if(!X.parent)throw new Error("Linked mesh parent must not be null");var q=j.getAttachment(X.slotIndex,X.parent);if(!q)throw new Error("Parent mesh not found: "+X.parent);X.mesh.timelineAttachment=X.inheritTimeline?q:X.mesh,X.mesh.setParentMesh(q),null!=X.mesh.region&&X.mesh.updateRegion()}this.linkedMeshes.length=0,o=i.readInt(!0);for(var J=0;J<o;J++){var Q=i.readString();if(!Q)throw new Error("Event data name must not be null");var $=new wt(Q);$.intValue=i.readInt(!1),$.floatValue=i.readFloat(),$.stringValue=i.readString(),$.audioPath=i.readString(),$.audioPath&&($.volume=i.readFloat(),$.balance=i.readFloat()),n.events.push($)}o=i.readInt(!0);for(var ee=0;ee<o;ee++){var te=i.readString();if(!te)throw new Error("Animatio name must not be null.");n.animations.push(this.readAnimation(i,te,n))}return n},t.readSkin=function(e,t,n,i){var r=null,a=0;if(n){if(0==(a=e.readInt(!0)))return null;r=new Wt("default")}else{var s=e.readString();if(!s)throw new Error("Skin name must not be null.");r=new Wt(s),i&&b.rgba8888ToColor(r.color,e.readInt32()),r.bones.length=e.readInt(!0);for(var o=0,c=r.bones.length;o<c;o++)r.bones[o]=t.bones[e.readInt(!0)];for(var h=0,u=e.readInt(!0);h<u;h++)r.constraints.push(t.ikConstraints[e.readInt(!0)]);for(var l=0,d=e.readInt(!0);l<d;l++)r.constraints.push(t.transformConstraints[e.readInt(!0)]);for(var p=0,f=e.readInt(!0);p<f;p++)r.constraints.push(t.pathConstraints[e.readInt(!0)]);for(var m=0,g=e.readInt(!0);m<g;m++)r.constraints.push(t.physicsConstraints[e.readInt(!0)]);a=e.readInt(!0)}for(var v=0;v<a;v++)for(var y=e.readInt(!0),E=0,C=e.readInt(!0);E<C;E++){var w=e.readStringRef();if(!w)throw new Error("Attachment name must not be null");var A=this.readAttachment(e,t,r,y,w,i);A&&r.setAttachment(y,w,A)}return r},t.readAttachment=function(e,t,n,i,r,a){var s=this.scale,o=e.readByte(),c=0!=(8&o)?e.readStringRef():r;if(!c)throw new Error("Attachment name must not be null");switch(7&o){case qt.Region:var h=0!=(16&o)?e.readStringRef():null,u=0!=(32&o)?e.readInt32():4294967295,l=0!=(64&o)?this.readSequence(e):null,d=0!=(128&o)?e.readFloat():0,p=e.readFloat(),f=e.readFloat(),m=e.readFloat(),g=e.readFloat(),v=e.readFloat(),y=e.readFloat();h||(h=c);var E=this.attachmentLoader.newRegionAttachment(n,c,h,l);return E?(E.path=h,E.x=p*s,E.y=f*s,E.scaleX=m,E.scaleY=g,E.rotation=d,E.width=v*s,E.height=y*s,b.rgba8888ToColor(E.color,u),E.sequence=l,null==l&&E.updateRegion(),E):null;case qt.BoundingBox:var C=this.readVertices(e,0!=(16&o)),w=a?e.readInt32():0,A=this.attachmentLoader.newBoundingBoxAttachment(n,c);return A?(A.worldVerticesLength=C.length,A.vertices=C.vertices,A.bones=C.bones,a&&b.rgba8888ToColor(A.color,w),A):null;case qt.Mesh:var S=0!=(16&o)?e.readStringRef():c,T=0!=(32&o)?e.readInt32():4294967295,x=0!=(64&o)?this.readSequence(e):null,k=e.readInt(!0),P=this.readVertices(e,0!=(128&o)),O=this.readFloatArray(e,P.length,1),R=this.readShortArray(e,3*(P.length-k-2)),B=[],D=0,L=0;a&&(B=this.readShortArray(e,e.readInt(!0)),D=e.readFloat(),L=e.readFloat()),S||(S=c);var M=this.attachmentLoader.newMeshAttachment(n,c,S,x);return M?(M.path=S,b.rgba8888ToColor(M.color,T),M.bones=P.bones,M.vertices=P.vertices,M.worldVerticesLength=P.length,M.triangles=R,M.regionUVs=O,null==x&&M.updateRegion(),M.hullLength=k<<1,M.sequence=x,a&&(M.edges=B,M.width=D*s,M.height=L*s),M):null;case qt.LinkedMesh:var _=0!=(16&o)?e.readStringRef():c;if(null==_)throw new Error("Path of linked mesh must not be null");var N=0!=(32&o)?e.readInt32():4294967295,G=0!=(64&o)?this.readSequence(e):null,F=0!=(128&o),Z=e.readInt(!0),U=e.readStringRef(),W=0,Y=0;a&&(W=e.readFloat(),Y=e.readFloat());var H=this.attachmentLoader.newMeshAttachment(n,c,_,G);return H?(H.path=_,b.rgba8888ToColor(H.color,N),H.sequence=G,a&&(H.width=W*s,H.height=Y*s),this.linkedMeshes.push(new Xt(H,Z,i,U,F)),H):null;case qt.Path:for(var z=0!=(16&o),K=0!=(32&o),V=this.readVertices(e,0!=(64&o)),X=I.newArray(V.length/6,0),j=0,q=X.length;j<q;j++)X[j]=e.readFloat()*s;var J=a?e.readInt32():0,Q=this.attachmentLoader.newPathAttachment(n,c);return Q?(Q.closed=z,Q.constantSpeed=K,Q.worldVerticesLength=V.length,Q.vertices=V.vertices,Q.bones=V.bones,Q.lengths=X,a&&b.rgba8888ToColor(Q.color,J),Q):null;case qt.Point:var $=e.readFloat(),ee=e.readFloat(),te=e.readFloat(),ne=a?e.readInt32():0,ie=this.attachmentLoader.newPointAttachment(n,c);return ie?(ie.x=ee*s,ie.y=te*s,ie.rotation=$,a&&b.rgba8888ToColor(ie.color,ne),ie):null;case qt.Clipping:var re=e.readInt(!0),ae=this.readVertices(e,0!=(16&o)),se=a?e.readInt32():0,oe=this.attachmentLoader.newClippingAttachment(n,c);return oe?(oe.endSlot=t.slots[re],oe.worldVerticesLength=ae.length,oe.vertices=ae.vertices,oe.bones=ae.bones,a&&b.rgba8888ToColor(oe.color,se),oe):null}return null},t.readSequence=function(e){var t=new N(e.readInt(!0));return t.start=e.readInt(!0),t.digits=e.readInt(!0),t.setupIndex=e.readInt(!0),t},t.readVertices=function(e,t){var n=this.scale,i=e.readInt(!0),r=new jt;if(r.length=i<<1,!t)return r.vertices=this.readFloatArray(e,r.length,n),r;for(var a=new Array,s=new Array,o=0;o<i;o++){var c=e.readInt(!0);s.push(c);for(var h=0;h<c;h++)s.push(e.readInt(!0)),a.push(e.readFloat()*n),a.push(e.readFloat()*n),a.push(e.readFloat())}return r.vertices=I.toFloatArray(a),r.bones=s,r},t.readFloatArray=function(e,t,n){var i=new Array(t);if(1==n)for(var r=0;r<t;r++)i[r]=e.readFloat();else for(var a=0;a<t;a++)i[a]=e.readFloat()*n;return i},t.readShortArray=function(e,t){for(var n=new Array(t),i=0;i<t;i++)n[i]=e.readInt(!0);return n},t.readAnimation=function(e,t,n){e.readInt(!0);for(var i=new Array,r=this.scale,a=0,s=e.readInt(!0);a<s;a++)for(var o=e.readInt(!0),c=0,h=e.readInt(!0);c<h;c++){var u=e.readByte(),l=e.readInt(!0),d=l-1;switch(u){case dn:for(var p=new pe(l,o),f=0;f<l;f++)p.setFrame(f,e.readFloat(),e.readStringRef());i.push(p);break;case pn:for(var m=e.readInt(!0),g=new ce(l,m,o),v=e.readFloat(),y=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,w=e.readUnsignedByte()/255,A=0,b=0;g.setFrame(A,v,y,E,C,w),A!=d;A++){var S=e.readFloat(),T=e.readUnsignedByte()/255,x=e.readUnsignedByte()/255,k=e.readUnsignedByte()/255,P=e.readUnsignedByte()/255;switch(e.readByte()){case Rn:g.setStepped(A);break;case Bn:$t(e,g,b++,A,0,v,S,y,T,1),$t(e,g,b++,A,1,v,S,E,x,1),$t(e,g,b++,A,2,v,S,C,k,1),$t(e,g,b++,A,3,v,S,w,P,1)}v=S,y=T,E=x,C=k,w=P}i.push(g);break;case fn:for(var O=e.readInt(!0),R=new he(l,O,o),B=e.readFloat(),D=e.readUnsignedByte()/255,L=e.readUnsignedByte()/255,M=e.readUnsignedByte()/255,_=0,N=0;R.setFrame(_,B,D,L,M),_!=d;_++){var G=e.readFloat(),F=e.readUnsignedByte()/255,Z=e.readUnsignedByte()/255,U=e.readUnsignedByte()/255;switch(e.readByte()){case Rn:R.setStepped(_);break;case Bn:$t(e,R,N++,_,0,B,G,D,F,1),$t(e,R,N++,_,1,B,G,L,Z,1),$t(e,R,N++,_,2,B,G,M,U,1)}B=G,D=F,L=Z,M=U}i.push(R);break;case mn:for(var H=e.readInt(!0),z=new le(l,H,o),K=e.readFloat(),V=e.readUnsignedByte()/255,X=e.readUnsignedByte()/255,j=e.readUnsignedByte()/255,q=e.readUnsignedByte()/255,Ae=e.readUnsignedByte()/255,Be=e.readUnsignedByte()/255,De=e.readUnsignedByte()/255,Le=0,Me=0;z.setFrame(Le,K,V,X,j,q,Ae,Be,De),Le!=d;Le++){var _e=e.readFloat(),Ne=e.readUnsignedByte()/255,Ge=e.readUnsignedByte()/255,Fe=e.readUnsignedByte()/255,Ze=e.readUnsignedByte()/255,Ue=e.readUnsignedByte()/255,We=e.readUnsignedByte()/255,Ye=e.readUnsignedByte()/255;switch(e.readByte()){case Rn:z.setStepped(Le);break;case Bn:$t(e,z,Me++,Le,0,K,_e,V,Ne,1),$t(e,z,Me++,Le,1,K,_e,X,Ge,1),$t(e,z,Me++,Le,2,K,_e,j,Fe,1),$t(e,z,Me++,Le,3,K,_e,q,Ze,1),$t(e,z,Me++,Le,4,K,_e,Ae,Ue,1),$t(e,z,Me++,Le,5,K,_e,Be,We,1),$t(e,z,Me++,Le,6,K,_e,De,Ye,1)}K=_e,V=Ne,X=Ge,j=Fe,q=Ze,Ae=Ue,Be=We,De=Ye}i.push(z);break;case gn:for(var He=e.readInt(!0),ze=new de(l,He,o),Ke=e.readFloat(),Ve=e.readUnsignedByte()/255,Xe=e.readUnsignedByte()/255,je=e.readUnsignedByte()/255,qe=e.readUnsignedByte()/255,Je=e.readUnsignedByte()/255,Qe=e.readUnsignedByte()/255,$e=0,et=0;ze.setFrame($e,Ke,Ve,Xe,je,qe,Je,Qe),$e!=d;$e++){var tt=e.readFloat(),nt=e.readUnsignedByte()/255,it=e.readUnsignedByte()/255,rt=e.readUnsignedByte()/255,at=e.readUnsignedByte()/255,st=e.readUnsignedByte()/255,ot=e.readUnsignedByte()/255;switch(e.readByte()){case Rn:ze.setStepped($e);break;case Bn:$t(e,ze,et++,$e,0,Ke,tt,Ve,nt,1),$t(e,ze,et++,$e,1,Ke,tt,Xe,it,1),$t(e,ze,et++,$e,2,Ke,tt,je,rt,1),$t(e,ze,et++,$e,3,Ke,tt,qe,at,1),$t(e,ze,et++,$e,4,Ke,tt,Je,st,1),$t(e,ze,et++,$e,5,Ke,tt,Qe,ot,1)}Ke=tt,Ve=nt,Xe=it,je=rt,qe=at,Je=st,Qe=ot}i.push(ze);break;case vn:for(var ct=new ue(l,e.readInt(!0),o),ht=e.readFloat(),ut=e.readUnsignedByte()/255,lt=0,dt=0;ct.setFrame(lt,ht,ut),lt!=d;lt++){var pt=e.readFloat(),ft=e.readUnsignedByte()/255;switch(e.readByte()){case Rn:ct.setStepped(lt);break;case Bn:$t(e,ct,dt++,lt,0,ht,pt,ut,ft,1)}ht=pt,ut=ft}i.push(ct)}}for(var mt=0,gt=e.readInt(!0);mt<gt;mt++)for(var vt=e.readInt(!0),yt=0,Et=e.readInt(!0);yt<Et;yt++){var wt=e.readByte(),At=e.readInt(!0);if(wt!=ln){var bt=e.readInt(!0);switch(wt){case en:i.push(Jt(e,new J(At,bt,vt),1));break;case tn:i.push(Qt(e,new Q(At,bt,vt),r));break;case nn:i.push(Jt(e,new $(At,bt,vt),r));break;case rn:i.push(Jt(e,new ee(At,bt,vt),r));break;case an:i.push(Qt(e,new te(At,bt,vt),1));break;case sn:i.push(Jt(e,new ne(At,bt,vt),1));break;case on:i.push(Jt(e,new ie(At,bt,vt),1));break;case cn:i.push(Qt(e,new re(At,bt,vt),1));break;case hn:i.push(Jt(e,new ae(At,bt,vt),1));break;case un:i.push(Jt(e,new se(At,bt,vt),1))}}else{for(var St=new oe(At,vt),Tt=0;Tt<At;Tt++)St.setFrame(Tt,e.readFloat(),e.readByte());i.push(St)}}for(var xt=0,kt=e.readInt(!0);xt<kt;xt++){for(var Pt=e.readInt(!0),It=e.readInt(!0),Ot=It-1,Rt=new ve(It,e.readInt(!0),Pt),Bt=e.readByte(),Dt=e.readFloat(),Lt=0!=(1&Bt)?0!=(2&Bt)?e.readFloat():1:0,Mt=0!=(4&Bt)?e.readFloat()*r:0,_t=0,Nt=0;Rt.setFrame(_t,Dt,Lt,Mt,0!=(8&Bt)?1:-1,0!=(16&Bt),0!=(32&Bt)),_t!=Ot;_t++){Bt=e.readByte();var Gt=e.readFloat(),Ft=0!=(1&Bt)?0!=(2&Bt)?e.readFloat():1:0,Zt=0!=(4&Bt)?e.readFloat()*r:0;0!=(64&Bt)?Rt.setStepped(_t):0!=(128&Bt)&&($t(e,Rt,Nt++,_t,0,Dt,Gt,Lt,Ft,1),$t(e,Rt,Nt++,_t,1,Dt,Gt,Mt,Zt,r)),Dt=Gt,Lt=Ft,Mt=Zt}i.push(Rt)}for(var Ut=0,Wt=e.readInt(!0);Ut<Wt;Ut++){for(var Yt=e.readInt(!0),Ht=e.readInt(!0),zt=Ht-1,Kt=new ye(Ht,e.readInt(!0),Yt),Vt=e.readFloat(),Xt=e.readFloat(),jt=e.readFloat(),qt=e.readFloat(),Dn=e.readFloat(),Ln=e.readFloat(),Mn=e.readFloat(),_n=0,Nn=0;Kt.setFrame(_n,Vt,Xt,jt,qt,Dn,Ln,Mn),_n!=zt;_n++){var Gn=e.readFloat(),Fn=e.readFloat(),Zn=e.readFloat(),Un=e.readFloat(),Wn=e.readFloat(),Yn=e.readFloat(),Hn=e.readFloat();switch(e.readByte()){case Rn:Kt.setStepped(_n);break;case Bn:$t(e,Kt,Nn++,_n,0,Vt,Gn,Xt,Fn,1),$t(e,Kt,Nn++,_n,1,Vt,Gn,jt,Zn,1),$t(e,Kt,Nn++,_n,2,Vt,Gn,qt,Un,1),$t(e,Kt,Nn++,_n,3,Vt,Gn,Dn,Wn,1),$t(e,Kt,Nn++,_n,4,Vt,Gn,Ln,Yn,1),$t(e,Kt,Nn++,_n,5,Vt,Gn,Mn,Hn,1)}Vt=Gn,Xt=Fn,jt=Zn,qt=Un,Dn=Wn,Ln=Yn,Mn=Hn}i.push(Kt)}for(var zn=0,Kn=e.readInt(!0);zn<Kn;zn++)for(var Vn=e.readInt(!0),Xn=n.pathConstraints[Vn],jn=0,qn=e.readInt(!0);jn<qn;jn++){var Jn=e.readByte(),Qn=e.readInt(!0),$n=e.readInt(!0);switch(Jn){case Cn:i.push(Jt(e,new Ee(Qn,$n,Vn),0==Xn.positionMode?r:1));break;case wn:i.push(Jt(e,new Ce(Qn,$n,Vn),0==Xn.spacingMode||1==Xn.spacingMode?r:1));break;case An:for(var ei=new we(Qn,$n,Vn),ti=e.readFloat(),ni=e.readFloat(),ii=e.readFloat(),ri=e.readFloat(),ai=0,si=0,oi=ei.getFrameCount()-1;ei.setFrame(ai,ti,ni,ii,ri),ai!=oi;ai++){var ci=e.readFloat(),hi=e.readFloat(),ui=e.readFloat(),li=e.readFloat();switch(e.readByte()){case Rn:ei.setStepped(ai);break;case Bn:$t(e,ei,si++,ai,0,ti,ci,ni,hi,1),$t(e,ei,si++,ai,1,ti,ci,ii,ui,1),$t(e,ei,si++,ai,2,ti,ci,ri,li,1)}ti=ci,ni=hi,ii=ui,ri=li}i.push(ei)}}for(var di=0,pi=e.readInt(!0);di<pi;di++)for(var fi=e.readInt(!0)-1,mi=0,gi=e.readInt(!0);mi<gi;mi++){var vi=e.readByte(),yi=e.readInt(!0);if(vi!=On){var Ei=e.readInt(!0);switch(vi){case bn:i.push(Jt(e,new be(yi,Ei,fi),1));break;case Sn:i.push(Jt(e,new Se(yi,Ei,fi),1));break;case Tn:i.push(Jt(e,new Te(yi,Ei,fi),1));break;case xn:i.push(Jt(e,new xe(yi,Ei,fi),1));break;case kn:i.push(Jt(e,new ke(yi,Ei,fi),1));break;case Pn:i.push(Jt(e,new Pe(yi,Ei,fi),1));break;case In:i.push(Jt(e,new Ie(yi,Ei,fi),1))}}else{for(var Ci=new Oe(yi,fi),wi=0;wi<yi;wi++)Ci.setFrame(wi,e.readFloat());i.push(Ci)}}for(var Ai=0,bi=e.readInt(!0);Ai<bi;Ai++)for(var Si=n.skins[e.readInt(!0)],Ti=0,xi=e.readInt(!0);Ti<xi;Ti++)for(var ki=e.readInt(!0),Pi=0,Ii=e.readInt(!0);Pi<Ii;Pi++){var Oi=e.readStringRef();if(!Oi)throw new Error("attachmentName must not be null.");var Ri=Si.getAttachment(ki,Oi),Bi=e.readByte(),Di=e.readInt(!0),Li=Di-1;switch(Bi){case yn:for(var Mi=Ri,_i=Mi.bones,Ni=Mi.vertices,Gi=_i?Ni.length/3*2:Ni.length,Fi=e.readInt(!0),Zi=new fe(Di,Fi,ki,Mi),Ui=e.readFloat(),Wi=0,Yi=0;;Wi++){var Hi=void 0,zi=e.readInt(!0);if(0==zi)Hi=_i?I.newFloatArray(Gi):Ni;else{Hi=I.newFloatArray(Gi);var Ki=e.readInt(!0);if(zi+=Ki,1==r)for(var Vi=Ki;Vi<zi;Vi++)Hi[Vi]=e.readFloat();else for(var Xi=Ki;Xi<zi;Xi++)Hi[Xi]=e.readFloat()*r;if(!_i)for(var ji=0,qi=Hi.length;ji<qi;ji++)Hi[ji]+=Ni[ji]}if(Zi.setFrame(Wi,Ui,Hi),Wi==Li)break;var Ji=e.readFloat();switch(e.readByte()){case Rn:Zi.setStepped(Wi);break;case Bn:$t(e,Zi,Yi++,Wi,0,Ui,Ji,0,1,1)}Ui=Ji}i.push(Zi);break;case En:for(var Qi=new Re(Di,ki,Ri),$i=0;$i<Di;$i++){var er=e.readFloat(),tr=e.readInt32();Qi.setFrame($i,er,W[15&tr],tr>>4,e.readFloat())}i.push(Qi)}}var nr=e.readInt(!0);if(nr>0){for(var ir=new ge(nr),rr=n.slots.length,ar=0;ar<nr;ar++){for(var sr=e.readFloat(),or=e.readInt(!0),cr=I.newArray(rr,0),hr=rr-1;hr>=0;hr--)cr[hr]=-1;for(var ur=I.newArray(rr-or,0),lr=0,dr=0,pr=0;pr<or;pr++){for(var fr=e.readInt(!0);lr!=fr;)ur[dr++]=lr++;cr[lr+e.readInt(!0)]=lr++}for(;lr<rr;)ur[dr++]=lr++;for(var mr=rr-1;mr>=0;mr--)-1==cr[mr]&&(cr[mr]=ur[--dr]);ir.setFrame(ar,sr,cr)}i.push(ir)}var gr=e.readInt(!0);if(gr>0){for(var vr=new me(gr),yr=0;yr<gr;yr++){var Er=e.readFloat(),Cr=n.events[e.readInt(!0)],wr=new Ct(Er,Cr);wr.intValue=e.readInt(!1),wr.floatValue=e.readFloat(),wr.stringValue=e.readString(),null==wr.stringValue&&(wr.stringValue=Cr.stringValue),wr.data.audioPath&&(wr.volume=e.readFloat(),wr.balance=e.readFloat()),vr.setFrame(yr,wr)}i.push(vr)}for(var Ar=0,br=0,Sr=i.length;br<Sr;br++)Ar=Math.max(Ar,i[br].getDuration());return new Y(t,i,Ar)},e}(),Vt=function(){function e(e,t,n,i){void 0===t&&(t=new Array),void 0===n&&(n=0),void 0===i&&(i=new DataView(e instanceof ArrayBuffer?e:e.buffer)),this.strings=t,this.index=n,this.buffer=i}var t=e.prototype;return t.readByte=function(){return this.buffer.getInt8(this.index++)},t.readUnsignedByte=function(){return this.buffer.getUint8(this.index++)},t.readShort=function(){var e=this.buffer.getInt16(this.index);return this.index+=2,e},t.readInt32=function(){var e=this.buffer.getInt32(this.index);return this.index+=4,e},t.readInt=function(e){var t=this.readByte(),n=127&t;return 0!=(128&t)&&(n|=(127&(t=this.readByte()))<<7,0!=(128&t)&&(n|=(127&(t=this.readByte()))<<14,0!=(128&t)&&(n|=(127&(t=this.readByte()))<<21,0!=(128&t)&&(n|=(127&(t=this.readByte()))<<28)))),e?n:n>>>1^-(1&n)},t.readStringRef=function(){var e=this.readInt(!0);return 0==e?null:this.strings[e-1]},t.readString=function(){var e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;for(var t="",n=0;n<e;){var i=this.readUnsignedByte();switch(i>>4){case 12:case 13:t+=String.fromCharCode((31&i)<<6|63&this.readByte()),n+=2;break;case 14:t+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:t+=String.fromCharCode(i),n++}}return t},t.readFloat=function(){var e=this.buffer.getFloat32(this.index);return this.index+=4,e},t.readBoolean=function(){return 0!=this.readByte()},e}(),Xt=function(e,t,n,i,r){this.parent=void 0,this.skinIndex=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritTimeline=void 0,this.mesh=e,this.skinIndex=t,this.slotIndex=n,this.parent=i,this.inheritTimeline=r},jt=function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=0),this.bones=e,this.vertices=t,this.length=n},qt=((Nt=qt||{})[Nt.Region=0]="Region",Nt[Nt.BoundingBox=1]="BoundingBox",Nt[Nt.Mesh=2]="Mesh",Nt[Nt.LinkedMesh=3]="LinkedMesh",Nt[Nt.Path=4]="Path",Nt[Nt.Point=5]="Point",Nt[Nt.Clipping=6]="Clipping",Nt);function Jt(e,t,n){for(var i=e.readFloat(),r=e.readFloat()*n,a=0,s=0,o=t.getFrameCount()-1;t.setFrame(a,i,r),a!=o;a++){var c=e.readFloat(),h=e.readFloat()*n;switch(e.readByte()){case Rn:t.setStepped(a);break;case Bn:$t(e,t,s++,a,0,i,c,r,h,n)}i=c,r=h}return t}function Qt(e,t,n){for(var i=e.readFloat(),r=e.readFloat()*n,a=e.readFloat()*n,s=0,o=0,c=t.getFrameCount()-1;t.setFrame(s,i,r,a),s!=c;s++){var h=e.readFloat(),u=e.readFloat()*n,l=e.readFloat()*n;switch(e.readByte()){case Rn:t.setStepped(s);break;case Bn:$t(e,t,o++,s,0,i,h,r,u,n),$t(e,t,o++,s,1,i,h,a,l,n)}i=h,r=u,a=l}return t}function $t(e,t,n,i,r,a,s,o,c,h){t.setBezier(n,i,r,a,o,e.readFloat(),e.readFloat()*h,e.readFloat(),e.readFloat()*h,s,c)}var en=0,tn=1,nn=2,rn=3,an=4,sn=5,on=6,cn=7,hn=8,un=9,ln=10,dn=0,pn=1,fn=2,mn=3,gn=4,vn=5,yn=0,En=1,Cn=0,wn=1,An=2,bn=0,Sn=1,Tn=2,xn=4,kn=5,Pn=6,In=7,On=8,Rn=1,Bn=2,Dn=function(){function e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new R((function(){return I.newFloatArray(16)}))}var t=e.prototype;return t.update=function(e,t){if(!e)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,i=this.polygons,r=this.polygonPool,a=e.slots,s=a.length;n.length=0,r.freeAll(i),i.length=0;for(var o=0;o<s;o++){var c=a[o];if(c.bone.active){var h=c.getAttachment();if(h instanceof Xe){var u=h;n.push(u);var l=r.obtain();l.length!=u.worldVerticesLength&&(l=I.newFloatArray(u.worldVerticesLength)),i.push(l),u.computeWorldVertices(c,0,u.worldVerticesLength,l,0,2)}}}t?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},t.aabbCompute=function(){for(var e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=this.polygons,a=0,s=r.length;a<s;a++)for(var o=r[a],c=o,h=0,u=o.length;h<u;h+=2){var l=c[h],d=c[h+1];e=Math.min(e,l),t=Math.min(t,d),n=Math.max(n,l),i=Math.max(i,d)}this.minX=e,this.minY=t,this.maxX=n,this.maxY=i},t.aabbContainsPoint=function(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY},t.aabbIntersectsSegment=function(e,t,n,i){var r=this.minX,a=this.minY,s=this.maxX,o=this.maxY;if(e<=r&&n<=r||t<=a&&i<=a||e>=s&&n>=s||t>=o&&i>=o)return!1;var c=(i-t)/(n-e),h=c*(r-e)+t;if(h>a&&h<o)return!0;if((h=c*(s-e)+t)>a&&h<o)return!0;var u=(a-t)/c+e;return u>r&&u<s||(u=(o-t)/c+e)>r&&u<s},t.aabbIntersectsSkeleton=function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},t.containsPoint=function(e,t){for(var n=this.polygons,i=0,r=n.length;i<r;i++)if(this.containsPointPolygon(n[i],e,t))return this.boundingBoxes[i];return null},t.containsPointPolygon=function(e,t,n){for(var i=e,r=e.length,a=r-2,s=!1,o=0;o<r;o+=2){var c=i[o+1],h=i[a+1];if(c<n&&h>=n||h<n&&c>=n){var u=i[o];u+(n-c)/(h-c)*(i[a]-u)<t&&(s=!s)}a=o}return s},t.intersectsSegment=function(e,t,n,i){for(var r=this.polygons,a=0,s=r.length;a<s;a++)if(this.intersectsSegmentPolygon(r[a],e,t,n,i))return this.boundingBoxes[a];return null},t.intersectsSegmentPolygon=function(e,t,n,i,r){for(var a=e,s=e.length,o=t-i,c=n-r,h=t*r-n*i,u=a[s-2],l=a[s-1],d=0;d<s;d+=2){var p=a[d],f=a[d+1],m=u*f-l*p,g=u-p,v=l-f,y=o*v-c*g,E=(h*g-o*m)/y;if((E>=u&&E<=p||E>=p&&E<=u)&&(E>=t&&E<=i||E>=i&&E<=t)){var C=(h*v-c*m)/y;if((C>=l&&C<=f||C>=f&&C<=l)&&(C>=n&&C<=r||C>=r&&C<=n))return!0}u=p,l=f}return!1},t.getPolygon=function(e){if(!e)throw new Error("boundingBox cannot be null.");var t=this.boundingBoxes.indexOf(e);return-1==t?null:this.polygons[t]},t.getWidth=function(){return this.maxX-this.minX},t.getHeight=function(){return this.maxY-this.minY},e}(),Ln=function(){function e(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new R((function(){return new Array})),this.polygonIndicesPool=new R((function(){return new Array}))}var t=e.prototype;return t.triangulate=function(t){var n=t,i=t.length>>1,r=this.indicesArray;r.length=0;for(var a=0;a<i;a++)r[a]=a;var s=this.isConcaveArray;s.length=0;for(var o=0,c=i;o<c;++o)s[o]=e.isConcave(o,i,n,r);var h=this.triangles;for(h.length=0;i>3;){for(var u=i-1,l=0,d=1;;){e:if(!s[l]){for(var p=r[u]<<1,f=r[l]<<1,m=r[d]<<1,g=n[p],v=n[p+1],y=n[f],E=n[f+1],C=n[m],w=n[m+1],A=(d+1)%i;A!=u;A=(A+1)%i)if(s[A]){var b=r[A]<<1,S=n[b],T=n[b+1];if(e.positiveArea(C,w,g,v,S,T)&&e.positiveArea(g,v,y,E,S,T)&&e.positiveArea(y,E,C,w,S,T))break e}break}if(0==d){do{if(!s[l])break;l--}while(l>0);break}u=l,l=d,d=(d+1)%i}h.push(r[(i+l-1)%i]),h.push(r[l]),h.push(r[(l+1)%i]),r.splice(l,1),s.splice(l,1);var x=(--i+l-1)%i,k=l==i?0:l;s[x]=e.isConcave(x,i,n,r),s[k]=e.isConcave(k,i,n,r)}return 3==i&&(h.push(r[2]),h.push(r[0]),h.push(r[1])),h},t.decompose=function(t,n){var i=t,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;var o=this.polygonPool.obtain();o.length=0;for(var c=-1,h=0,u=0,l=n.length;u<l;u+=3){var d=n[u]<<1,p=n[u+1]<<1,f=n[u+2]<<1,m=i[d],g=i[d+1],v=i[p],y=i[p+1],E=i[f],C=i[f+1],w=!1;if(c==d){var A=o.length-4,b=e.winding(o[A],o[A+1],o[A+2],o[A+3],E,C),S=e.winding(E,C,o[0],o[1],o[2],o[3]);b==h&&S==h&&(o.push(E),o.push(C),s.push(f),w=!0)}w||(o.length>0?(r.push(o),a.push(s)):(this.polygonPool.free(o),this.polygonIndicesPool.free(s)),(o=this.polygonPool.obtain()).length=0,o.push(m),o.push(g),o.push(v),o.push(y),o.push(E),o.push(C),(s=this.polygonIndicesPool.obtain()).length=0,s.push(d),s.push(p),s.push(f),h=e.winding(m,g,v,y,E,C),c=d)}o.length>0&&(r.push(o),a.push(s));for(var T=0,x=r.length;T<x;T++)if(0!=(s=a[T]).length)for(var k=s[0],P=s[s.length-1],I=(o=r[T]).length-4,O=o[I],R=o[I+1],B=o[I+2],D=o[I+3],L=o[0],M=o[1],_=o[2],N=o[3],G=e.winding(O,R,B,D,L,M),F=0;F<x;F++)if(F!=T){var Z=a[F];if(3==Z.length){var U=Z[0],W=Z[1],Y=Z[2],H=r[F],z=H[H.length-2],K=H[H.length-1];if(U==k&&W==P){var V=e.winding(O,R,B,D,z,K),X=e.winding(z,K,L,M,_,N);V==G&&X==G&&(H.length=0,Z.length=0,o.push(z),o.push(K),s.push(Y),O=B,R=D,B=z,D=K,F=0)}}}for(var j=r.length-1;j>=0;j--)0==(o=r[j]).length&&(r.splice(j,1),this.polygonPool.free(o),s=a[j],a.splice(j,1),this.polygonIndicesPool.free(s));return r},e.isConcave=function(e,t,n,i){var r=i[(t+e-1)%t]<<1,a=i[e]<<1,s=i[(e+1)%t]<<1;return!this.positiveArea(n[r],n[r+1],n[a],n[a+1],n[s],n[s+1])},e.positiveArea=function(e,t,n,i,r,a){return e*(a-i)+n*(t-a)+r*(i-t)>=0},e.winding=function(e,t,n,i,r,a){var s=n-e,o=i-t;return r*o-a*s+s*t-e*o>=0?1:-1},e}(),Mn=function(){function e(){this.triangulator=new Ln,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedUVs=new Array,this.clippedTriangles=new Array,this.scratch=new Array,this.clipAttachment=null,this.clippingPolygons=null}var t=e.prototype;return t.clipStart=function(t,n){if(this.clipAttachment)return 0;this.clipAttachment=n;var i=n.worldVerticesLength,r=I.setArraySize(this.clippingPolygon,i);n.computeWorldVertices(t,0,i,r,0,2);var a=this.clippingPolygon;e.makeClockwise(a);for(var s=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),o=0,c=s.length;o<c;o++){var h=s[o];e.makeClockwise(h),h.push(h[0]),h.push(h[1])}return s.length},t.clipEndWithSlot=function(e){this.clipAttachment&&this.clipAttachment.endSlot==e.data&&this.clipEnd()},t.clipEnd=function(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},t.isClipping=function(){return null!=this.clipAttachment},t.clipTriangles=function(e,t,n,i,r,a,s){i&&r&&a&&"boolean"===typeof s?this.clipTrianglesRender(e,t,n,i,r,a,s):this.clipTrianglesNoRender(e,t,n)},t.clipTrianglesNoRender=function(e,t,n){var i=this.clipOutput,r=this.clippedVertices,a=this.clippedTriangles,s=this.clippingPolygons,o=s.length,c=0;r.length=0,a.length=0;for(var h=0;h<n;h+=3)for(var u=t[h]<<1,l=e[u],d=e[u+1],p=e[u=t[h+1]<<1],f=e[u+1],m=e[u=t[h+2]<<1],g=e[u+1],v=0;v<o;v++){var y=r.length;if(!this.clip(l,d,p,f,m,g,s[v],i)){var E=I.setArraySize(r,y+6);E[y]=l,E[y+1]=d,E[y+2]=p,E[y+3]=f,E[y+4]=m,E[y+5]=g,y=a.length;var C=I.setArraySize(a,y+3);C[y]=c,C[y+1]=c+1,C[y+2]=c+2,c+=3;break}var w=i.length;if(0!=w){for(var A=w>>1,b=this.clipOutput,S=I.setArraySize(r,y+2*A),T=0;T<w;T+=2,y+=2){var x=b[T],k=b[T+1];S[y]=x,S[y+1]=k}y=a.length;var P=I.setArraySize(a,y+3*(A-2));A--;for(var O=1;O<A;O++,y+=3)P[y]=c,P[y+1]=c+O,P[y+2]=c+O+1;c+=A+1}}},t.clipTrianglesRender=function(e,t,n,i,r,a,s){var o=this.clipOutput,c=this.clippedVertices,h=this.clippedTriangles,u=this.clippingPolygons,l=u.length,d=s?12:8,p=0;c.length=0,h.length=0;for(var f=0;f<n;f+=3)for(var m=t[f]<<1,g=e[m],v=e[m+1],y=i[m],E=i[m+1],C=e[m=t[f+1]<<1],w=e[m+1],A=i[m],b=i[m+1],S=e[m=t[f+2]<<1],T=e[m+1],x=i[m],k=i[m+1],P=0;P<l;P++){var O=c.length;if(!this.clip(g,v,C,w,S,T,u[P],o)){var R=I.setArraySize(c,O+3*d);R[O]=g,R[O+1]=v,R[O+2]=r.r,R[O+3]=r.g,R[O+4]=r.b,R[O+5]=r.a,s?(R[O+6]=y,R[O+7]=E,R[O+8]=a.r,R[O+9]=a.g,R[O+10]=a.b,R[O+11]=a.a,R[O+12]=C,R[O+13]=w,R[O+14]=r.r,R[O+15]=r.g,R[O+16]=r.b,R[O+17]=r.a,R[O+18]=A,R[O+19]=b,R[O+20]=a.r,R[O+21]=a.g,R[O+22]=a.b,R[O+23]=a.a,R[O+24]=S,R[O+25]=T,R[O+26]=r.r,R[O+27]=r.g,R[O+28]=r.b,R[O+29]=r.a,R[O+30]=x,R[O+31]=k,R[O+32]=a.r,R[O+33]=a.g,R[O+34]=a.b,R[O+35]=a.a):(R[O+6]=y,R[O+7]=E,R[O+8]=C,R[O+9]=w,R[O+10]=r.r,R[O+11]=r.g,R[O+12]=r.b,R[O+13]=r.a,R[O+14]=A,R[O+15]=b,R[O+16]=S,R[O+17]=T,R[O+18]=r.r,R[O+19]=r.g,R[O+20]=r.b,R[O+21]=r.a,R[O+22]=x,R[O+23]=k),O=h.length;var B=I.setArraySize(h,O+3);B[O]=p,B[O+1]=p+1,B[O+2]=p+2,p+=3;break}var D=o.length;if(0!=D){for(var L=w-T,M=S-C,_=g-S,N=T-v,G=1/(L*_+M*(v-T)),F=D>>1,Z=this.clipOutput,U=I.setArraySize(c,O+F*d),W=0;W<D;W+=2,O+=d){var Y=Z[W],H=Z[W+1];U[O]=Y,U[O+1]=H,U[O+2]=r.r,U[O+3]=r.g,U[O+4]=r.b,U[O+5]=r.a;var z=Y-S,K=H-T,V=(L*z+M*K)*G,X=(N*z+_*K)*G,j=1-V-X;U[O+6]=y*V+A*X+x*j,U[O+7]=E*V+b*X+k*j,s&&(U[O+8]=a.r,U[O+9]=a.g,U[O+10]=a.b,U[O+11]=a.a)}O=h.length;var q=I.setArraySize(h,O+3*(F-2));F--;for(var J=1;J<F;J++,O+=3)q[O]=p,q[O+1]=p+J,q[O+2]=p+J+1;p+=F+1}}},t.clipTrianglesUnpacked=function(e,t,n,i){var r=this.clipOutput,a=this.clippedVertices,s=this.clippedUVs,o=this.clippedTriangles,c=this.clippingPolygons,h=c.length,u=0;a.length=0,s.length=0,o.length=0;for(var l=0;l<n;l+=3)for(var d=t[l]<<1,p=e[d],f=e[d+1],m=i[d],g=i[d+1],v=e[d=t[l+1]<<1],y=e[d+1],E=i[d],C=i[d+1],w=e[d=t[l+2]<<1],A=e[d+1],b=i[d],S=i[d+1],T=0;T<h;T++){var x=a.length;if(!this.clip(p,f,v,y,w,A,c[T],r)){var k=I.setArraySize(a,x+6);k[x]=p,k[x+1]=f,k[x+2]=v,k[x+3]=y,k[x+4]=w,k[x+5]=A;var P=I.setArraySize(s,x+6);P[x]=m,P[x+1]=g,P[x+2]=E,P[x+3]=C,P[x+4]=b,P[x+5]=S,x=o.length;var O=I.setArraySize(o,x+3);O[x]=u,O[x+1]=u+1,O[x+2]=u+2,u+=3;break}var R=r.length;if(0!=R){for(var B=y-A,D=w-v,L=p-w,M=A-f,_=1/(B*L+D*(f-A)),N=R>>1,G=this.clipOutput,F=I.setArraySize(a,x+2*N),Z=I.setArraySize(s,x+2*N),U=0;U<R;U+=2,x+=2){var W=G[U],Y=G[U+1];F[x]=W,F[x+1]=Y;var H=W-w,z=Y-A,K=(B*H+D*z)*_,V=(M*H+L*z)*_,X=1-K-V;Z[x]=m*K+E*V+b*X,Z[x+1]=g*K+C*V+S*X}x=o.length;var j=I.setArraySize(o,x+3*(N-2));N--;for(var q=1;q<N;q++,x+=3)j[x]=u,j[x+1]=u+q,j[x+2]=u+q+1;u+=N+1}}},t.clip=function(e,t,n,i,r,a,s,o){var c,h=o,u=!1;s.length%4>=2?(c=o,o=this.scratch):c=this.scratch,c.length=0,c.push(e),c.push(t),c.push(n),c.push(i),c.push(r),c.push(a),c.push(e),c.push(t),o.length=0;for(var l=s.length-4,d=s,p=0;;p+=2){for(var f=d[p],m=d[p+1],g=f-d[p+2],v=m-d[p+3],y=o.length,E=c,C=0,w=c.length-2;C<w;){var A=E[C],b=E[C+1],S=E[C+=2],T=E[C+1],x=v*(f-S)>g*(m-T),k=v*(f-A)-g*(m-b);if(k>0){if(x){o.push(S),o.push(T);continue}var P=S-A,I=T-b,O=k/(P*v-I*g);if(!(O>=0&&O<=1)){o.push(S),o.push(T);continue}o.push(A+P*O),o.push(b+I*O)}else if(x){var R=S-A,B=T-b,D=k/(R*v-B*g);if(!(D>=0&&D<=1)){o.push(S),o.push(T);continue}o.push(A+R*D),o.push(b+B*D),o.push(S),o.push(T)}u=!0}if(y==o.length)return h.length=0,!0;if(o.push(o[0]),o.push(o[1]),p==l)break;var L=o;(o=c).length=0,c=L}if(h!=o){h.length=0;for(var M=0,_=o.length-2;M<_;M++)h[M]=o[M]}else h.length=h.length-2;return u},e.makeClockwise=function(e){for(var t=e,n=e.length,i=t[n-2]*t[1]-t[0]*t[n-1],r=0,a=0,s=0,o=0,c=n-3;o<c;o+=2)r=t[o],a=t[o+1],s=t[o+2],i+=r*t[o+3]-s*a;if(!(i<0))for(var h=0,u=n-2,l=n>>1;h<l;h+=2){var d=t[h],p=t[h+1],f=u-h;t[h]=t[f],t[h+1]=t[f+1],t[f]=d,t[f+1]=p}},e}(),_n=function(){function e(e){this.attachmentLoader=void 0,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}var t=e.prototype;return t.readSkeletonData=function(e){var t,n,i=this.scale,r=new Zt,a="string"===typeof e?JSON.parse(e):e,s=a.skeleton;s&&(r.hash=s.hash,r.version=s.spine,r.x=s.x,r.y=s.y,r.width=s.width,r.height=s.height,r.referenceScale=Un(s,"referenceScale",100)*i,r.fps=s.fps,r.imagesPath=null!=(t=s.images)?t:null,r.audioPath=null!=(n=s.audio)?n:null);if(a.bones)for(var o=0;o<a.bones.length;o++){var c=a.bones[o],h=null,u=Un(c,"parent",null);u&&(h=r.findBone(u));var l=new ft(r.bones.length,c.name,h);l.length=Un(c,"length",0)*i,l.x=Un(c,"x",0)*i,l.y=Un(c,"y",0)*i,l.rotation=Un(c,"rotation",0),l.scaleX=Un(c,"scaleX",1),l.scaleY=Un(c,"scaleY",1),l.shearX=Un(c,"shearX",0),l.shearY=Un(c,"shearY",0),l.inherit=I.enumValue(mt,Un(c,"inherit","Normal")),l.skinRequired=Un(c,"skin",!1);var d=Un(c,"color",null);d&&l.color.setFromString(d),r.bones.push(l)}if(a.slots)for(var p=0;p<a.slots.length;p++){var f=a.slots[p],m=f.name,g=r.findBone(f.bone);if(!g)throw new Error("Couldn't find bone "+f.bone+" for slot "+m);var v=new Yt(r.slots.length,m,g),y=Un(f,"color",null);y&&v.color.setFromString(y);var E=Un(f,"dark",null);E&&(v.darkColor=b.fromString(E)),v.attachmentName=Un(f,"attachment",null),v.blendMode=I.enumValue(Ht,Un(f,"blend","normal")),v.visible=Un(f,"visible",!0),r.slots.push(v)}if(a.ik)for(var C=0;C<a.ik.length;C++){var w=a.ik[C],A=new bt(w.name);A.order=Un(w,"order",0),A.skinRequired=Un(w,"skin",!1);for(var S=0;S<w.bones.length;S++){var T=r.findBone(w.bones[S]);if(!T)throw new Error("Couldn't find bone "+w.bones[S]+" for IK constraint "+w.name+".");A.bones.push(T)}var x=r.findBone(w.target);if(!x)throw new Error("Couldn't find target bone "+w.target+" for IK constraint "+w.name+".");A.target=x,A.mix=Un(w,"mix",1),A.softness=Un(w,"softness",0)*i,A.bendDirection=Un(w,"bendPositive",!0)?1:-1,A.compress=Un(w,"compress",!1),A.stretch=Un(w,"stretch",!1),A.uniform=Un(w,"uniform",!1),r.ikConstraints.push(A)}if(a.transform)for(var k=0;k<a.transform.length;k++){var P=a.transform[k],O=new zt(P.name);O.order=Un(P,"order",0),O.skinRequired=Un(P,"skin",!1);for(var R=0;R<P.bones.length;R++){var B=P.bones[R],D=r.findBone(B);if(!D)throw new Error("Couldn't find bone "+B+" for transform constraint "+P.name+".");O.bones.push(D)}var L=P.target,M=r.findBone(L);if(!M)throw new Error("Couldn't find target bone "+L+" for transform constraint "+P.name+".");O.target=M,O.local=Un(P,"local",!1),O.relative=Un(P,"relative",!1),O.offsetRotation=Un(P,"rotation",0),O.offsetX=Un(P,"x",0)*i,O.offsetY=Un(P,"y",0)*i,O.offsetScaleX=Un(P,"scaleX",0),O.offsetScaleY=Un(P,"scaleY",0),O.offsetShearY=Un(P,"shearY",0),O.mixRotate=Un(P,"mixRotate",1),O.mixX=Un(P,"mixX",1),O.mixY=Un(P,"mixY",O.mixX),O.mixScaleX=Un(P,"mixScaleX",1),O.mixScaleY=Un(P,"mixScaleY",O.mixScaleX),O.mixShearY=Un(P,"mixShearY",1),r.transformConstraints.push(O)}if(a.path)for(var _=0;_<a.path.length;_++){var N=a.path[_],G=new St(N.name);G.order=Un(N,"order",0),G.skinRequired=Un(N,"skin",!1);for(var F=0;F<N.bones.length;F++){var Z=N.bones[F],U=r.findBone(Z);if(!U)throw new Error("Couldn't find bone "+Z+" for path constraint "+N.name+".");G.bones.push(U)}var W=N.target,Y=r.findSlot(W);if(!Y)throw new Error("Couldn't find target slot "+W+" for path constraint "+N.name+".");G.target=Y,G.positionMode=I.enumValue(Tt,Un(N,"positionMode","Percent")),G.spacingMode=I.enumValue(xt,Un(N,"spacingMode","Length")),G.rotateMode=I.enumValue(kt,Un(N,"rotateMode","Tangent")),G.offsetRotation=Un(N,"rotation",0),G.position=Un(N,"position",0),0==G.positionMode&&(G.position*=i),G.spacing=Un(N,"spacing",0),0!=G.spacingMode&&1!=G.spacingMode||(G.spacing*=i),G.mixRotate=Un(N,"mixRotate",1),G.mixX=Un(N,"mixX",1),G.mixY=Un(N,"mixY",G.mixX),r.pathConstraints.push(G)}if(a.physics)for(var H=0;H<a.physics.length;H++){var z=a.physics[H],K=new Ft(z.name);K.order=Un(z,"order",0),K.skinRequired=Un(z,"skin",!1);var V=z.bone,X=r.findBone(V);if(null==X)throw new Error("Physics bone not found: "+V);K.bone=X,K.x=Un(z,"x",0),K.y=Un(z,"y",0),K.rotate=Un(z,"rotate",0),K.scaleX=Un(z,"scaleX",0),K.shearX=Un(z,"shearX",0),K.limit=Un(z,"limit",5e3)*i,K.step=1/Un(z,"fps",60),K.inertia=Un(z,"inertia",1),K.strength=Un(z,"strength",100),K.damping=Un(z,"damping",1),K.massInverse=1/Un(z,"mass",1),K.wind=Un(z,"wind",0),K.gravity=Un(z,"gravity",0),K.mix=Un(z,"mix",1),K.inertiaGlobal=Un(z,"inertiaGlobal",!1),K.strengthGlobal=Un(z,"strengthGlobal",!1),K.dampingGlobal=Un(z,"dampingGlobal",!1),K.massGlobal=Un(z,"massGlobal",!1),K.windGlobal=Un(z,"windGlobal",!1),K.gravityGlobal=Un(z,"gravityGlobal",!1),K.mixGlobal=Un(z,"mixGlobal",!1),r.physicsConstraints.push(K)}if(a.skins)for(var j=0;j<a.skins.length;j++){var q=a.skins[j],J=new Wt(q.name);if(q.bones)for(var Q=0;Q<q.bones.length;Q++){var $=q.bones[Q],ee=r.findBone($);if(!ee)throw new Error("Couldn't find bone "+$+" for skin "+q.name+".");J.bones.push(ee)}if(q.ik)for(var te=0;te<q.ik.length;te++){var ne=q.ik[te],ie=r.findIkConstraint(ne);if(!ie)throw new Error("Couldn't find IK constraint "+ne+" for skin "+q.name+".");J.constraints.push(ie)}if(q.transform)for(var re=0;re<q.transform.length;re++){var ae=q.transform[re],se=r.findTransformConstraint(ae);if(!se)throw new Error("Couldn't find transform constraint "+ae+" for skin "+q.name+".");J.constraints.push(se)}if(q.path)for(var oe=0;oe<q.path.length;oe++){var ce=q.path[oe],he=r.findPathConstraint(ce);if(!he)throw new Error("Couldn't find path constraint "+ce+" for skin "+q.name+".");J.constraints.push(he)}if(q.physics)for(var ue=0;ue<q.physics.length;ue++){var le=q.physics[ue],de=r.findPhysicsConstraint(le);if(!de)throw new Error("Couldn't find physics constraint "+le+" for skin "+q.name+".");J.constraints.push(de)}for(var pe in q.attachments){var fe=r.findSlot(pe);if(!fe)throw new Error("Couldn't find slot "+pe+" for skin "+q.name+".");var me=q.attachments[pe];for(var ge in me){var ve=this.readAttachment(me[ge],J,fe.index,ge,r);ve&&J.setAttachment(fe.index,ge,ve)}}r.skins.push(J),"default"==J.name&&(r.defaultSkin=J)}for(var ye=0,Ee=this.linkedMeshes.length;ye<Ee;ye++){var Ce=this.linkedMeshes[ye],we=Ce.skin?r.findSkin(Ce.skin):r.defaultSkin;if(!we)throw new Error("Skin not found: "+Ce.skin);var Ae=we.getAttachment(Ce.slotIndex,Ce.parent);if(!Ae)throw new Error("Parent mesh not found: "+Ce.parent);Ce.mesh.timelineAttachment=Ce.inheritTimeline?Ae:Ce.mesh,Ce.mesh.setParentMesh(Ae),null!=Ce.mesh.region&&Ce.mesh.updateRegion()}if(this.linkedMeshes.length=0,a.events)for(var be in a.events){var Se=a.events[be],Te=new wt(be);Te.intValue=Un(Se,"int",0),Te.floatValue=Un(Se,"float",0),Te.stringValue=Un(Se,"string",""),Te.audioPath=Un(Se,"audio",null),Te.audioPath&&(Te.volume=Un(Se,"volume",1),Te.balance=Un(Se,"balance",0)),r.events.push(Te)}if(a.animations)for(var xe in a.animations){var ke=a.animations[xe];this.readAnimation(ke,xe,r)}return r},t.readAttachment=function(e,t,n,i,r){var a=this.scale;switch(i=Un(e,"name",i),Un(e,"type","region")){case"region":var s=Un(e,"path",i),o=this.readSequence(Un(e,"sequence",null)),c=this.attachmentLoader.newRegionAttachment(t,i,s,o);if(!c)return null;c.path=s,c.x=Un(e,"x",0)*a,c.y=Un(e,"y",0)*a,c.scaleX=Un(e,"scaleX",1),c.scaleY=Un(e,"scaleY",1),c.rotation=Un(e,"rotation",0),c.width=e.width*a,c.height=e.height*a,c.sequence=o;var h=Un(e,"color",null);return h&&c.color.setFromString(h),null!=c.region&&c.updateRegion(),c;case"boundingbox":var u=this.attachmentLoader.newBoundingBoxAttachment(t,i);if(!u)return null;this.readVertices(e,u,e.vertexCount<<1);var l=Un(e,"color",null);return l&&u.color.setFromString(l),u;case"mesh":case"linkedmesh":var d=Un(e,"path",i),p=this.readSequence(Un(e,"sequence",null)),f=this.attachmentLoader.newMeshAttachment(t,i,d,p);if(!f)return null;f.path=d;var m=Un(e,"color",null);m&&f.color.setFromString(m),f.width=Un(e,"width",0)*a,f.height=Un(e,"height",0)*a,f.sequence=p;var g=Un(e,"parent",null);if(g)return this.linkedMeshes.push(new Nn(f,Un(e,"skin",null),n,g,Un(e,"timelines",!0))),f;var v=e.uvs;return this.readVertices(e,f,v.length),f.triangles=e.triangles,f.regionUVs=v,null!=f.region&&f.updateRegion(),f.edges=Un(e,"edges",null),f.hullLength=2*Un(e,"hull",0),f;case"path":var y=this.attachmentLoader.newPathAttachment(t,i);if(!y)return null;y.closed=Un(e,"closed",!1),y.constantSpeed=Un(e,"constantSpeed",!0);var E=e.vertexCount;this.readVertices(e,y,E<<1);for(var C=I.newArray(E/3,0),w=0;w<e.lengths.length;w++)C[w]=e.lengths[w]*a;y.lengths=C;var A=Un(e,"color",null);return A&&y.color.setFromString(A),y;case"point":var b=this.attachmentLoader.newPointAttachment(t,i);if(!b)return null;b.x=Un(e,"x",0)*a,b.y=Un(e,"y",0)*a,b.rotation=Un(e,"rotation",0);var S=Un(e,"color",null);return S&&b.color.setFromString(S),b;case"clipping":var T=this.attachmentLoader.newClippingAttachment(t,i);if(!T)return null;var x=Un(e,"end",null);x&&(T.endSlot=r.findSlot(x));var k=e.vertexCount;this.readVertices(e,T,k<<1);var P=Un(e,"color",null);return P&&T.color.setFromString(P),T}return null},t.readSequence=function(e){if(null==e)return null;var t=new N(Un(e,"count",0));return t.start=Un(e,"start",1),t.digits=Un(e,"digits",0),t.setupIndex=Un(e,"setup",0),t},t.readVertices=function(e,t,n){var i=this.scale;t.worldVerticesLength=n;var r=e.vertices;if(n!=r.length){for(var a=new Array,s=new Array,o=0,c=r.length;o<c;){var h=r[o++];s.push(h);for(var u=o+4*h;o<u;o+=4)s.push(r[o]),a.push(r[o+1]*i),a.push(r[o+2]*i),a.push(r[o+3])}t.bones=s,t.vertices=I.toFloatArray(a)}else{var l=I.toFloatArray(r);if(1!=i)for(var d=0,p=r.length;d<p;d++)l[d]*=i;t.vertices=l}},t.readAnimation=function(e,t,n){var i=this.scale,r=new Array;if(e.slots)for(var a in e.slots){var s=e.slots[a],o=n.findSlot(a);if(!o)throw new Error("Slot not found: "+a);var c=o.index;for(var h in s){var u=s[h];if(u){var l=u.length;if("attachment"==h){for(var d=new pe(l,c),p=0;p<l;p++){var f=u[p];d.setFrame(p,Un(f,"time",0),Un(f,"name",null))}r.push(d)}else if("rgba"==h){for(var m=new ce(l,l<<2,c),g=u[0],v=Un(g,"time",0),y=b.fromString(g.color),E=0,C=0;;E++){m.setFrame(E,v,y.r,y.g,y.b,y.a);var w=u[E+1];if(!w){m.shrink(C);break}var A=Un(w,"time",0),S=b.fromString(w.color),T=g.curve;T&&(C=Zn(T,m,C,E,0,v,A,y.r,S.r,1),C=Zn(T,m,C,E,1,v,A,y.g,S.g,1),C=Zn(T,m,C,E,2,v,A,y.b,S.b,1),C=Zn(T,m,C,E,3,v,A,y.a,S.a,1)),v=A,y=S,g=w}r.push(m)}else if("rgb"==h){for(var x=new he(l,3*l,c),k=u[0],P=Un(k,"time",0),O=b.fromString(k.color),R=0,B=0;;R++){x.setFrame(R,P,O.r,O.g,O.b);var D=u[R+1];if(!D){x.shrink(B);break}var L=Un(D,"time",0),M=b.fromString(D.color),_=k.curve;_&&(B=Zn(_,x,B,R,0,P,L,O.r,M.r,1),B=Zn(_,x,B,R,1,P,L,O.g,M.g,1),B=Zn(_,x,B,R,2,P,L,O.b,M.b,1)),P=L,O=M,k=D}r.push(x)}else if("alpha"==h)r.push(Gn(u,new ue(l,l,c),0,1));else if("rgba2"==h){for(var N=new le(l,7*l,c),G=u[0],F=Un(G,"time",0),Z=b.fromString(G.light),W=b.fromString(G.dark),H=0,z=0;;H++){N.setFrame(H,F,Z.r,Z.g,Z.b,Z.a,W.r,W.g,W.b);var K=u[H+1];if(!K){N.shrink(z);break}var V=Un(K,"time",0),X=b.fromString(K.light),j=b.fromString(K.dark),q=G.curve;q&&(z=Zn(q,N,z,H,0,F,V,Z.r,X.r,1),z=Zn(q,N,z,H,1,F,V,Z.g,X.g,1),z=Zn(q,N,z,H,2,F,V,Z.b,X.b,1),z=Zn(q,N,z,H,3,F,V,Z.a,X.a,1),z=Zn(q,N,z,H,4,F,V,W.r,j.r,1),z=Zn(q,N,z,H,5,F,V,W.g,j.g,1),z=Zn(q,N,z,H,6,F,V,W.b,j.b,1)),F=V,Z=X,W=j,G=K}r.push(N)}else if("rgb2"==h){for(var Ae=new de(l,6*l,c),Be=u[0],De=Un(Be,"time",0),Le=b.fromString(Be.light),Me=b.fromString(Be.dark),_e=0,Ne=0;;_e++){Ae.setFrame(_e,De,Le.r,Le.g,Le.b,Me.r,Me.g,Me.b);var Ge=u[_e+1];if(!Ge){Ae.shrink(Ne);break}var Fe=Un(Ge,"time",0),Ze=b.fromString(Ge.light),Ue=b.fromString(Ge.dark),We=Be.curve;We&&(Ne=Zn(We,Ae,Ne,_e,0,De,Fe,Le.r,Ze.r,1),Ne=Zn(We,Ae,Ne,_e,1,De,Fe,Le.g,Ze.g,1),Ne=Zn(We,Ae,Ne,_e,2,De,Fe,Le.b,Ze.b,1),Ne=Zn(We,Ae,Ne,_e,3,De,Fe,Me.r,Ue.r,1),Ne=Zn(We,Ae,Ne,_e,4,De,Fe,Me.g,Ue.g,1),Ne=Zn(We,Ae,Ne,_e,5,De,Fe,Me.b,Ue.b,1)),De=Fe,Le=Ze,Me=Ue,Be=Ge}r.push(Ae)}}}}if(e.bones)for(var Ye in e.bones){var He=e.bones[Ye],ze=n.findBone(Ye);if(!ze)throw new Error("Bone not found: "+Ye);var Ke=ze.index;for(var Ve in He){var Xe=He[Ve],je=Xe.length;if(0!=je)if("rotate"===Ve)r.push(Gn(Xe,new J(je,je,Ke),0,1));else if("translate"===Ve){var qe=new Q(je,je<<1,Ke);r.push(Fn(Xe,qe,"x","y",0,i))}else if("translatex"===Ve){var Je=new $(je,je,Ke);r.push(Gn(Xe,Je,0,i))}else if("translatey"===Ve){var Qe=new ee(je,je,Ke);r.push(Gn(Xe,Qe,0,i))}else if("scale"===Ve){var $e=new te(je,je<<1,Ke);r.push(Fn(Xe,$e,"x","y",1,1))}else if("scalex"===Ve){var et=new ne(je,je,Ke);r.push(Gn(Xe,et,1,1))}else if("scaley"===Ve){var tt=new ie(je,je,Ke);r.push(Gn(Xe,tt,1,1))}else if("shear"===Ve){var nt=new re(je,je<<1,Ke);r.push(Fn(Xe,nt,"x","y",0,1))}else if("shearx"===Ve){var it=new ae(je,je,Ke);r.push(Gn(Xe,it,0,1))}else if("sheary"===Ve){var rt=new se(je,je,Ke);r.push(Gn(Xe,rt,0,1))}else if("inherit"===Ve){for(var at=new oe(je,ze.index),st=0;st<Xe.length;st++){var ot=Xe[st];at.setFrame(st,Un(ot,"time",0),I.enumValue(mt,Un(ot,"inherit","Normal")))}r.push(at)}}}if(e.ik)for(var ct in e.ik){var ht=e.ik[ct],ut=ht[0];if(ut){var lt=n.findIkConstraint(ct);if(!lt)throw new Error("IK Constraint not found: "+ct);for(var dt=n.ikConstraints.indexOf(lt),pt=new ve(ht.length,ht.length<<1,dt),ft=Un(ut,"time",0),gt=Un(ut,"mix",1),vt=Un(ut,"softness",0)*i,yt=0,Et=0;;yt++){pt.setFrame(yt,ft,gt,vt,Un(ut,"bendPositive",!0)?1:-1,Un(ut,"compress",!1),Un(ut,"stretch",!1));var wt=ht[yt+1];if(!wt){pt.shrink(Et);break}var At=Un(wt,"time",0),bt=Un(wt,"mix",1),St=Un(wt,"softness",0)*i,Tt=ut.curve;Tt&&(Et=Zn(Tt,pt,Et,yt,0,ft,At,gt,bt,1),Et=Zn(Tt,pt,Et,yt,1,ft,At,vt,St,i)),ft=At,gt=bt,vt=St,ut=wt}r.push(pt)}}if(e.transform)for(var xt in e.transform){var kt=e.transform[xt],Pt=kt[0];if(Pt){var It=n.findTransformConstraint(xt);if(!It)throw new Error("Transform constraint not found: "+xt);for(var Ot=n.transformConstraints.indexOf(It),Rt=new ye(kt.length,6*kt.length,Ot),Bt=Un(Pt,"time",0),Dt=Un(Pt,"mixRotate",1),Lt=Un(Pt,"mixX",1),Mt=Un(Pt,"mixY",Lt),_t=Un(Pt,"mixScaleX",1),Nt=Un(Pt,"mixScaleY",_t),Gt=Un(Pt,"mixShearY",1),Ft=0,Zt=0;;Ft++){Rt.setFrame(Ft,Bt,Dt,Lt,Mt,_t,Nt,Gt);var Ut=kt[Ft+1];if(!Ut){Rt.shrink(Zt);break}var Wt=Un(Ut,"time",0),Yt=Un(Ut,"mixRotate",1),Ht=Un(Ut,"mixX",1),zt=Un(Ut,"mixY",Ht),Kt=Un(Ut,"mixScaleX",1),Vt=Un(Ut,"mixScaleY",Kt),Xt=Un(Ut,"mixShearY",1),jt=Pt.curve;jt&&(Zt=Zn(jt,Rt,Zt,Ft,0,Bt,Wt,Dt,Yt,1),Zt=Zn(jt,Rt,Zt,Ft,1,Bt,Wt,Lt,Ht,1),Zt=Zn(jt,Rt,Zt,Ft,2,Bt,Wt,Mt,zt,1),Zt=Zn(jt,Rt,Zt,Ft,3,Bt,Wt,_t,Kt,1),Zt=Zn(jt,Rt,Zt,Ft,4,Bt,Wt,Nt,Vt,1),Zt=Zn(jt,Rt,Zt,Ft,5,Bt,Wt,Gt,Xt,1)),Bt=Wt,Dt=Yt,Lt=Ht,Mt=zt,_t=Kt,Nt=Vt,_t=Kt,Pt=Ut}r.push(Rt)}}if(e.path)for(var qt in e.path){var Jt=e.path[qt],Qt=n.findPathConstraint(qt);if(!Qt)throw new Error("Path constraint not found: "+qt);var $t=n.pathConstraints.indexOf(Qt);for(var en in Jt){var tn=Jt[en],nn=tn[0];if(nn){var rn=tn.length;if("position"===en){var an=new Ee(rn,rn,$t);r.push(Gn(tn,an,0,0==Qt.positionMode?i:1))}else if("spacing"===en){var sn=new Ce(rn,rn,$t);r.push(Gn(tn,sn,0,0==Qt.spacingMode||1==Qt.spacingMode?i:1))}else if("mix"===en){for(var on=new we(rn,3*rn,$t),cn=Un(nn,"time",0),hn=Un(nn,"mixRotate",1),un=Un(nn,"mixX",1),ln=Un(nn,"mixY",un),dn=0,pn=0;;dn++){on.setFrame(dn,cn,hn,un,ln);var fn=tn[dn+1];if(!fn){on.shrink(pn);break}var mn=Un(fn,"time",0),gn=Un(fn,"mixRotate",1),vn=Un(fn,"mixX",1),yn=Un(fn,"mixY",vn),En=nn.curve;En&&(pn=Zn(En,on,pn,dn,0,cn,mn,hn,gn,1),pn=Zn(En,on,pn,dn,1,cn,mn,un,vn,1),pn=Zn(En,on,pn,dn,2,cn,mn,ln,yn,1)),cn=mn,hn=gn,un=vn,ln=yn,nn=fn}r.push(on)}}}}if(e.physics)for(var Cn in e.physics){var wn=e.physics[Cn],An=-1;if(Cn.length>0){var bn=n.findPhysicsConstraint(Cn);if(!bn)throw new Error("Physics constraint not found: "+Cn);An=n.physicsConstraints.indexOf(bn)}for(var Sn in wn){var Tn=wn[Sn],xn=Tn[0];if(xn){var kn=Tn.length;if("reset"!=Sn){var Pn=void 0;if("inertia"==Sn)Pn=new be(kn,kn,An);else if("strength"==Sn)Pn=new Se(kn,kn,An);else if("damping"==Sn)Pn=new Te(kn,kn,An);else if("mass"==Sn)Pn=new xe(kn,kn,An);else if("wind"==Sn)Pn=new ke(kn,kn,An);else if("gravity"==Sn)Pn=new Pe(kn,kn,An);else{if("mix"!=Sn)continue;Pn=new Ie(kn,kn,An)}r.push(Gn(Tn,Pn,0,1))}else{for(var In=new Oe(kn,An),On=0;null!=xn;xn=Tn[On+1],On++)In.setFrame(On,Un(xn,"time",0));r.push(In)}}}}if(e.attachments)for(var Rn in e.attachments){var Bn=e.attachments[Rn],Dn=n.findSkin(Rn);if(!Dn)throw new Error("Skin not found: "+Rn);for(var Ln in Bn){var Mn=Bn[Ln],_n=n.findSlot(Ln);if(!_n)throw new Error("Slot not found: "+Ln);var Nn=_n.index;for(var Wn in Mn){var Yn=Mn[Wn],Hn=Dn.getAttachment(Nn,Wn);for(var zn in Yn){var Kn=Yn[zn],Vn=Kn[0];if(Vn)if("deform"==zn){for(var Xn=Hn.bones,jn=Hn.vertices,qn=Xn?jn.length/3*2:jn.length,Jn=new fe(Kn.length,Kn.length,Nn,Hn),Qn=Un(Vn,"time",0),$n=0,ei=0;;$n++){var ti=void 0,ni=Un(Vn,"vertices",null);if(ni){ti=I.newFloatArray(qn);var ii=Un(Vn,"offset",0);if(I.arrayCopy(ni,0,ti,ii,ni.length),1!=i)for(var ri=ii,ai=ri+ni.length;ri<ai;ri++)ti[ri]*=i;if(!Xn)for(var si=0;si<qn;si++)ti[si]+=jn[si]}else ti=Xn?I.newFloatArray(qn):jn;Jn.setFrame($n,Qn,ti);var oi=Kn[$n+1];if(!oi){Jn.shrink(ei);break}var ci=Un(oi,"time",0),hi=Vn.curve;hi&&(ei=Zn(hi,Jn,ei,$n,0,Qn,ci,0,1,1)),Qn=ci,Vn=oi}r.push(Jn)}else if("sequence"==zn){for(var ui=new Re(Kn.length,Nn,Hn),li=0,di=0;di<Kn.length;di++){var pi=Un(Vn,"delay",li),fi=Un(Vn,"time",0),mi=U[Un(Vn,"mode","hold")],gi=Un(Vn,"index",0);ui.setFrame(di,fi,mi,gi,pi),li=pi,Vn=Kn[di+1]}r.push(ui)}}}}}if(e.drawOrder){for(var vi=new ge(e.drawOrder.length),yi=n.slots.length,Ei=0,Ci=0;Ci<e.drawOrder.length;Ci++,Ei++){var wi=e.drawOrder[Ci],Ai=null,bi=Un(wi,"offsets",null);if(bi){Ai=I.newArray(yi,-1);for(var Si=I.newArray(yi-bi.length,0),Ti=0,xi=0,ki=0;ki<bi.length;ki++){var Pi=bi[ki],Ii=n.findSlot(Pi.slot);if(!Ii)throw new Error("Slot not found: "+Ii);for(var Oi=Ii.index;Ti!=Oi;)Si[xi++]=Ti++;Ai[Ti+Pi.offset]=Ti++}for(;Ti<yi;)Si[xi++]=Ti++;for(var Ri=yi-1;Ri>=0;Ri--)-1==Ai[Ri]&&(Ai[Ri]=Si[--xi])}vi.setFrame(Ei,Un(wi,"time",0),Ai)}r.push(vi)}if(e.events){for(var Bi=new me(e.events.length),Di=0,Li=0;Li<e.events.length;Li++,Di++){var Mi=e.events[Li],_i=n.findEvent(Mi.name);if(!_i)throw new Error("Event not found: "+Mi.name);var Ni=new Ct(I.toSinglePrecision(Un(Mi,"time",0)),_i);Ni.intValue=Un(Mi,"int",_i.intValue),Ni.floatValue=Un(Mi,"float",_i.floatValue),Ni.stringValue=Un(Mi,"string",_i.stringValue),Ni.data.audioPath&&(Ni.volume=Un(Mi,"volume",1),Ni.balance=Un(Mi,"balance",0)),Bi.setFrame(Di,Ni)}r.push(Bi)}for(var Gi=0,Fi=0,Zi=r.length;Fi<Zi;Fi++)Gi=Math.max(Gi,r[Fi].getDuration());n.animations.push(new Y(t,r,Gi))},e}(),Nn=function(e,t,n,i,r){this.parent=void 0,this.skin=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritTimeline=void 0,this.mesh=e,this.skin=t,this.slotIndex=n,this.parent=i,this.inheritTimeline=r};function Gn(e,t,n,i){for(var r=e[0],a=Un(r,"time",0),s=Un(r,"value",n)*i,o=0,c=0;;c++){t.setFrame(c,a,s);var h=e[c+1];if(!h)return t.shrink(o),t;var u=Un(h,"time",0),l=Un(h,"value",n)*i;r.curve&&(o=Zn(r.curve,t,o,c,0,a,u,s,l,i)),a=u,s=l,r=h}}function Fn(e,t,n,i,r,a){for(var s=e[0],o=Un(s,"time",0),c=Un(s,n,r)*a,h=Un(s,i,r)*a,u=0,l=0;;l++){t.setFrame(l,o,c,h);var d=e[l+1];if(!d)return t.shrink(u),t;var p=Un(d,"time",0),f=Un(d,n,r)*a,m=Un(d,i,r)*a,g=s.curve;g&&(u=Zn(g,t,u,l,0,o,p,c,f,a),u=Zn(g,t,u,l,1,o,p,h,m,a)),o=p,c=f,h=m,s=d}}function Zn(e,t,n,i,r,a,s,o,c,h){if("stepped"==e)return t.setStepped(i),n;var u=r<<2,l=e[u],d=e[u+1]*h,p=e[u+2],f=e[u+3]*h;return t.setBezier(n,i,r,a,o,l,d,p,f,s,c),n+1}function Un(e,t,n){return void 0!==e[t]?e[t]:n}!function(){var e;"undefined"===typeof Math.fround&&(Math.fround=(e=new Float32Array(1),function(t){return e[0]=t,e[0]}))}();var Wn=function(){function e(e,t){var n=this;if(void 0===t&&(t={alpha:"true"}),this.canvas=void 0,this.gl=void 0,this.restorables=new Array,e instanceof WebGLRenderingContext||"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)this.gl=e,this.canvas=this.gl.canvas;else{var i=e;this.gl=i.getContext("webgl2",t)||i.getContext("webgl",t),this.canvas=i,i.addEventListener("webglcontextlost",(function(e){e&&e.preventDefault()})),i.addEventListener("webglcontextrestored",(function(e){for(var t=0,i=n.restorables.length;t<i;t++)n.restorables[t].restore()}))}}var t=e.prototype;return t.addRestorable=function(e){this.restorables.push(e)},t.removeRestorable=function(e){var t=this.restorables.indexOf(e);t>-1&&this.restorables.splice(t,1)},e}(),Yn=function(e){function t(t,n,i){var a;return void 0===i&&(i=!1),(a=e.call(this,n)||this).context=void 0,a.texture=null,a.boundUnit=0,a.useMipMaps=!1,a.context=t instanceof Wn?t:new Wn(t),a.useMipMaps=i,a.restore(),a.context.addRestorable((0,r.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.setFilters=function(e,n){var i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.validateMagFilter(n)),this.useMipMaps=t.usesMipMaps(e),this.useMipMaps&&i.generateMipmap(i.TEXTURE_2D)},t.validateMagFilter=function(e){switch(e){case 9987:case 9985:case 9986:case 9984:return 9729;default:return e}},t.usesMipMaps=function(e){switch(e){case 9987:case 9985:case 9986:case 9984:return!0;default:return!1}},n.setWraps=function(e,t){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t)},n.update=function(e){var n=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),t.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e?n.LINEAR_MIPMAP_LINEAR:n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e&&n.generateMipmap(n.TEXTURE_2D)},n.restore=function(){this.texture=null,this.update(this.useMipMaps)},n.bind=function(e){void 0===e&&(e=0);var t=this.context.gl;this.boundUnit=e,t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)},n.unbind=function(){var e=this.context.gl;e.activeTexture(e.TEXTURE0+this.boundUnit),e.bindTexture(e.TEXTURE_2D,null)},n.dispose=function(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)},t}(qe);d(Yn,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);var Hn=function(e){function t(t,n,i){return void 0===n&&(n=""),void 0===i&&(i=new Et),e.call(this,(function(e){return new Yn(t,e)}),n,i)||this}return(0,a.Z)(t,e),t}(yt),zn=function(){function e(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=0,this.y=0,this.z=0,this.x=e,this.y=t,this.z=n}var t=e.prototype;return t.setFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},t.set=function(e,t,n){return this.x=e,this.y=t,this.z=n,this},t.add=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},t.sub=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},t.scale=function(e){return this.x*=e,this.y*=e,this.z*=e,this},t.normalize=function(){var e=this.length();return 0==e||(e=1/e,this.x*=e,this.y*=e,this.z*=e),this},t.cross=function(e){return this.set(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.multiply=function(e){var t=e.values;return this.set(this.x*t[Kn]+this.y*t[Vn]+this.z*t[Xn]+t[jn],this.x*t[qn]+this.y*t[Jn]+this.z*t[Qn]+t[$n],this.x*t[ei]+this.y*t[ti]+this.z*t[ni]+t[ii])},t.project=function(e){var t=e.values,n=1/(this.x*t[ri]+this.y*t[ai]+this.z*t[si]+t[oi]);return this.set((this.x*t[Kn]+this.y*t[Vn]+this.z*t[Xn]+t[jn])*n,(this.x*t[qn]+this.y*t[Jn]+this.z*t[Qn]+t[$n])*n,(this.x*t[ei]+this.y*t[ti]+this.z*t[ni]+t[ii])*n)},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.distance=function(e){var t=e.x-this.x,n=e.y-this.y,i=e.z-this.z;return Math.sqrt(t*t+n*n+i*i)},e}(),Kn=0,Vn=4,Xn=8,jn=12,qn=1,Jn=5,Qn=9,$n=13,ei=2,ti=6,ni=10,ii=14,ri=3,ai=7,si=11,oi=15,ci=function(){function e(){this.temp=new Float32Array(16),this.values=new Float32Array(16);var e=this.values;e[Kn]=1,e[Jn]=1,e[ni]=1,e[oi]=1}var t=e.prototype;return t.set=function(e){return this.values.set(e),this},t.transpose=function(){var e=this.temp,t=this.values;return e[Kn]=t[Kn],e[Vn]=t[qn],e[Xn]=t[ei],e[jn]=t[ri],e[qn]=t[Vn],e[Jn]=t[Jn],e[Qn]=t[ti],e[$n]=t[ai],e[ei]=t[Xn],e[ti]=t[Qn],e[ni]=t[ni],e[ii]=t[si],e[ri]=t[jn],e[ai]=t[$n],e[si]=t[ii],e[oi]=t[oi],this.set(e)},t.identity=function(){var e=this.values;return e[Kn]=1,e[Vn]=0,e[Xn]=0,e[jn]=0,e[qn]=0,e[Jn]=1,e[Qn]=0,e[$n]=0,e[ei]=0,e[ti]=0,e[ni]=1,e[ii]=0,e[ri]=0,e[ai]=0,e[si]=0,e[oi]=1,this},t.invert=function(){var e=this.values,t=this.temp,n=e[ri]*e[ti]*e[Qn]*e[jn]-e[ei]*e[ai]*e[Qn]*e[jn]-e[ri]*e[Jn]*e[ni]*e[jn]+e[qn]*e[ai]*e[ni]*e[jn]+e[ei]*e[Jn]*e[si]*e[jn]-e[qn]*e[ti]*e[si]*e[jn]-e[ri]*e[ti]*e[Xn]*e[$n]+e[ei]*e[ai]*e[Xn]*e[$n]+e[ri]*e[Vn]*e[ni]*e[$n]-e[Kn]*e[ai]*e[ni]*e[$n]-e[ei]*e[Vn]*e[si]*e[$n]+e[Kn]*e[ti]*e[si]*e[$n]+e[ri]*e[Jn]*e[Xn]*e[ii]-e[qn]*e[ai]*e[Xn]*e[ii]-e[ri]*e[Vn]*e[Qn]*e[ii]+e[Kn]*e[ai]*e[Qn]*e[ii]+e[qn]*e[Vn]*e[si]*e[ii]-e[Kn]*e[Jn]*e[si]*e[ii]-e[ei]*e[Jn]*e[Xn]*e[oi]+e[qn]*e[ti]*e[Xn]*e[oi]+e[ei]*e[Vn]*e[Qn]*e[oi]-e[Kn]*e[ti]*e[Qn]*e[oi]-e[qn]*e[Vn]*e[ni]*e[oi]+e[Kn]*e[Jn]*e[ni]*e[oi];if(0==n)throw new Error("non-invertible matrix");var i=1/n;return t[Kn]=e[Qn]*e[ii]*e[ai]-e[$n]*e[ni]*e[ai]+e[$n]*e[ti]*e[si]-e[Jn]*e[ii]*e[si]-e[Qn]*e[ti]*e[oi]+e[Jn]*e[ni]*e[oi],t[Vn]=e[jn]*e[ni]*e[ai]-e[Xn]*e[ii]*e[ai]-e[jn]*e[ti]*e[si]+e[Vn]*e[ii]*e[si]+e[Xn]*e[ti]*e[oi]-e[Vn]*e[ni]*e[oi],t[Xn]=e[Xn]*e[$n]*e[ai]-e[jn]*e[Qn]*e[ai]+e[jn]*e[Jn]*e[si]-e[Vn]*e[$n]*e[si]-e[Xn]*e[Jn]*e[oi]+e[Vn]*e[Qn]*e[oi],t[jn]=e[jn]*e[Qn]*e[ti]-e[Xn]*e[$n]*e[ti]-e[jn]*e[Jn]*e[ni]+e[Vn]*e[$n]*e[ni]+e[Xn]*e[Jn]*e[ii]-e[Vn]*e[Qn]*e[ii],t[qn]=e[$n]*e[ni]*e[ri]-e[Qn]*e[ii]*e[ri]-e[$n]*e[ei]*e[si]+e[qn]*e[ii]*e[si]+e[Qn]*e[ei]*e[oi]-e[qn]*e[ni]*e[oi],t[Jn]=e[Xn]*e[ii]*e[ri]-e[jn]*e[ni]*e[ri]+e[jn]*e[ei]*e[si]-e[Kn]*e[ii]*e[si]-e[Xn]*e[ei]*e[oi]+e[Kn]*e[ni]*e[oi],t[Qn]=e[jn]*e[Qn]*e[ri]-e[Xn]*e[$n]*e[ri]-e[jn]*e[qn]*e[si]+e[Kn]*e[$n]*e[si]+e[Xn]*e[qn]*e[oi]-e[Kn]*e[Qn]*e[oi],t[$n]=e[Xn]*e[$n]*e[ei]-e[jn]*e[Qn]*e[ei]+e[jn]*e[qn]*e[ni]-e[Kn]*e[$n]*e[ni]-e[Xn]*e[qn]*e[ii]+e[Kn]*e[Qn]*e[ii],t[ei]=e[Jn]*e[ii]*e[ri]-e[$n]*e[ti]*e[ri]+e[$n]*e[ei]*e[ai]-e[qn]*e[ii]*e[ai]-e[Jn]*e[ei]*e[oi]+e[qn]*e[ti]*e[oi],t[ti]=e[jn]*e[ti]*e[ri]-e[Vn]*e[ii]*e[ri]-e[jn]*e[ei]*e[ai]+e[Kn]*e[ii]*e[ai]+e[Vn]*e[ei]*e[oi]-e[Kn]*e[ti]*e[oi],t[ni]=e[Vn]*e[$n]*e[ri]-e[jn]*e[Jn]*e[ri]+e[jn]*e[qn]*e[ai]-e[Kn]*e[$n]*e[ai]-e[Vn]*e[qn]*e[oi]+e[Kn]*e[Jn]*e[oi],t[ii]=e[jn]*e[Jn]*e[ei]-e[Vn]*e[$n]*e[ei]-e[jn]*e[qn]*e[ti]+e[Kn]*e[$n]*e[ti]+e[Vn]*e[qn]*e[ii]-e[Kn]*e[Jn]*e[ii],t[ri]=e[Qn]*e[ti]*e[ri]-e[Jn]*e[ni]*e[ri]-e[Qn]*e[ei]*e[ai]+e[qn]*e[ni]*e[ai]+e[Jn]*e[ei]*e[si]-e[qn]*e[ti]*e[si],t[ai]=e[Vn]*e[ni]*e[ri]-e[Xn]*e[ti]*e[ri]+e[Xn]*e[ei]*e[ai]-e[Kn]*e[ni]*e[ai]-e[Vn]*e[ei]*e[si]+e[Kn]*e[ti]*e[si],t[si]=e[Xn]*e[Jn]*e[ri]-e[Vn]*e[Qn]*e[ri]-e[Xn]*e[qn]*e[ai]+e[Kn]*e[Qn]*e[ai]+e[Vn]*e[qn]*e[si]-e[Kn]*e[Jn]*e[si],t[oi]=e[Vn]*e[Qn]*e[ei]-e[Xn]*e[Jn]*e[ei]+e[Xn]*e[qn]*e[ti]-e[Kn]*e[Qn]*e[ti]-e[Vn]*e[qn]*e[ni]+e[Kn]*e[Jn]*e[ni],e[Kn]=t[Kn]*i,e[Vn]=t[Vn]*i,e[Xn]=t[Xn]*i,e[jn]=t[jn]*i,e[qn]=t[qn]*i,e[Jn]=t[Jn]*i,e[Qn]=t[Qn]*i,e[$n]=t[$n]*i,e[ei]=t[ei]*i,e[ti]=t[ti]*i,e[ni]=t[ni]*i,e[ii]=t[ii]*i,e[ri]=t[ri]*i,e[ai]=t[ai]*i,e[si]=t[si]*i,e[oi]=t[oi]*i,this},t.determinant=function(){var e=this.values;return e[ri]*e[ti]*e[Qn]*e[jn]-e[ei]*e[ai]*e[Qn]*e[jn]-e[ri]*e[Jn]*e[ni]*e[jn]+e[qn]*e[ai]*e[ni]*e[jn]+e[ei]*e[Jn]*e[si]*e[jn]-e[qn]*e[ti]*e[si]*e[jn]-e[ri]*e[ti]*e[Xn]*e[$n]+e[ei]*e[ai]*e[Xn]*e[$n]+e[ri]*e[Vn]*e[ni]*e[$n]-e[Kn]*e[ai]*e[ni]*e[$n]-e[ei]*e[Vn]*e[si]*e[$n]+e[Kn]*e[ti]*e[si]*e[$n]+e[ri]*e[Jn]*e[Xn]*e[ii]-e[qn]*e[ai]*e[Xn]*e[ii]-e[ri]*e[Vn]*e[Qn]*e[ii]+e[Kn]*e[ai]*e[Qn]*e[ii]+e[qn]*e[Vn]*e[si]*e[ii]-e[Kn]*e[Jn]*e[si]*e[ii]-e[ei]*e[Jn]*e[Xn]*e[oi]+e[qn]*e[ti]*e[Xn]*e[oi]+e[ei]*e[Vn]*e[Qn]*e[oi]-e[Kn]*e[ti]*e[Qn]*e[oi]-e[qn]*e[Vn]*e[ni]*e[oi]+e[Kn]*e[Jn]*e[ni]*e[oi]},t.translate=function(e,t,n){var i=this.values;return i[jn]+=e,i[$n]+=t,i[ii]+=n,this},t.copy=function(){return(new e).set(this.values)},t.projection=function(e,t,n,i){this.identity();var r=1/Math.tan(n*(Math.PI/180)/2),a=(t+e)/(e-t),s=2*t*e/(e-t),o=this.values;return o[Kn]=r/i,o[qn]=0,o[ei]=0,o[ri]=0,o[Vn]=0,o[Jn]=r,o[ti]=0,o[ai]=0,o[Xn]=0,o[Qn]=0,o[ni]=a,o[si]=-1,o[jn]=0,o[$n]=0,o[ii]=s,o[oi]=0,this},t.ortho2d=function(e,t,n,i){return this.ortho(e,e+n,t,t+i,0,1)},t.ortho=function(e,t,n,i,r,a){this.identity();var s=2/(t-e),o=2/(i-n),c=-2/(a-r),h=-(t+e)/(t-e),u=-(i+n)/(i-n),l=-(a+r)/(a-r),d=this.values;return d[Kn]=s,d[qn]=0,d[ei]=0,d[ri]=0,d[Vn]=0,d[Jn]=o,d[ti]=0,d[ai]=0,d[Xn]=0,d[Qn]=0,d[ni]=c,d[si]=0,d[jn]=h,d[$n]=u,d[ii]=l,d[oi]=1,this},t.multiply=function(e){var t=this.temp,n=this.values,i=e.values;return t[Kn]=n[Kn]*i[Kn]+n[Vn]*i[qn]+n[Xn]*i[ei]+n[jn]*i[ri],t[Vn]=n[Kn]*i[Vn]+n[Vn]*i[Jn]+n[Xn]*i[ti]+n[jn]*i[ai],t[Xn]=n[Kn]*i[Xn]+n[Vn]*i[Qn]+n[Xn]*i[ni]+n[jn]*i[si],t[jn]=n[Kn]*i[jn]+n[Vn]*i[$n]+n[Xn]*i[ii]+n[jn]*i[oi],t[qn]=n[qn]*i[Kn]+n[Jn]*i[qn]+n[Qn]*i[ei]+n[$n]*i[ri],t[Jn]=n[qn]*i[Vn]+n[Jn]*i[Jn]+n[Qn]*i[ti]+n[$n]*i[ai],t[Qn]=n[qn]*i[Xn]+n[Jn]*i[Qn]+n[Qn]*i[ni]+n[$n]*i[si],t[$n]=n[qn]*i[jn]+n[Jn]*i[$n]+n[Qn]*i[ii]+n[$n]*i[oi],t[ei]=n[ei]*i[Kn]+n[ti]*i[qn]+n[ni]*i[ei]+n[ii]*i[ri],t[ti]=n[ei]*i[Vn]+n[ti]*i[Jn]+n[ni]*i[ti]+n[ii]*i[ai],t[ni]=n[ei]*i[Xn]+n[ti]*i[Qn]+n[ni]*i[ni]+n[ii]*i[si],t[ii]=n[ei]*i[jn]+n[ti]*i[$n]+n[ni]*i[ii]+n[ii]*i[oi],t[ri]=n[ri]*i[Kn]+n[ai]*i[qn]+n[si]*i[ei]+n[oi]*i[ri],t[ai]=n[ri]*i[Vn]+n[ai]*i[Jn]+n[si]*i[ti]+n[oi]*i[ai],t[si]=n[ri]*i[Xn]+n[ai]*i[Qn]+n[si]*i[ni]+n[oi]*i[si],t[oi]=n[ri]*i[jn]+n[ai]*i[$n]+n[si]*i[ii]+n[oi]*i[oi],this.set(this.temp)},t.multiplyLeft=function(e){var t=this.temp,n=this.values,i=e.values;return t[Kn]=i[Kn]*n[Kn]+i[Vn]*n[qn]+i[Xn]*n[ei]+i[jn]*n[ri],t[Vn]=i[Kn]*n[Vn]+i[Vn]*n[Jn]+i[Xn]*n[ti]+i[jn]*n[ai],t[Xn]=i[Kn]*n[Xn]+i[Vn]*n[Qn]+i[Xn]*n[ni]+i[jn]*n[si],t[jn]=i[Kn]*n[jn]+i[Vn]*n[$n]+i[Xn]*n[ii]+i[jn]*n[oi],t[qn]=i[qn]*n[Kn]+i[Jn]*n[qn]+i[Qn]*n[ei]+i[$n]*n[ri],t[Jn]=i[qn]*n[Vn]+i[Jn]*n[Jn]+i[Qn]*n[ti]+i[$n]*n[ai],t[Qn]=i[qn]*n[Xn]+i[Jn]*n[Qn]+i[Qn]*n[ni]+i[$n]*n[si],t[$n]=i[qn]*n[jn]+i[Jn]*n[$n]+i[Qn]*n[ii]+i[$n]*n[oi],t[ei]=i[ei]*n[Kn]+i[ti]*n[qn]+i[ni]*n[ei]+i[ii]*n[ri],t[ti]=i[ei]*n[Vn]+i[ti]*n[Jn]+i[ni]*n[ti]+i[ii]*n[ai],t[ni]=i[ei]*n[Xn]+i[ti]*n[Qn]+i[ni]*n[ni]+i[ii]*n[si],t[ii]=i[ei]*n[jn]+i[ti]*n[$n]+i[ni]*n[ii]+i[ii]*n[oi],t[ri]=i[ri]*n[Kn]+i[ai]*n[qn]+i[si]*n[ei]+i[oi]*n[ri],t[ai]=i[ri]*n[Vn]+i[ai]*n[Jn]+i[si]*n[ti]+i[oi]*n[ai],t[si]=i[ri]*n[Xn]+i[ai]*n[Qn]+i[si]*n[ni]+i[oi]*n[si],t[oi]=i[ri]*n[jn]+i[ai]*n[$n]+i[si]*n[ii]+i[oi]*n[oi],this.set(this.temp)},t.lookAt=function(t,n,i){var r=e.xAxis,a=e.yAxis,s=e.zAxis;s.setFrom(n).normalize(),r.setFrom(n).normalize(),r.cross(i).normalize(),a.setFrom(r).cross(s).normalize(),this.identity();var o=this.values;return o[Kn]=r.x,o[Vn]=r.y,o[Xn]=r.z,o[qn]=a.x,o[Jn]=a.y,o[Qn]=a.z,o[ei]=-s.x,o[ti]=-s.y,o[ni]=-s.z,e.tmpMatrix.identity(),e.tmpMatrix.values[jn]=-t.x,e.tmpMatrix.values[$n]=-t.y,e.tmpMatrix.values[ii]=-t.z,this.multiply(e.tmpMatrix),this},e}(),hi=ci;d(hi,"xAxis",new zn),d(hi,"yAxis",new zn),d(hi,"zAxis",new zn),d(hi,"tmpMatrix",new ci);var ui=function(){function e(e,t){this.position=new zn(0,0,0),this.direction=new zn(0,0,-1),this.up=new zn(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new hi,this.inverseProjectionView=new hi,this.projection=new hi,this.view=new hi,this.viewportWidth=e,this.viewportHeight=t,this.update()}var t=e.prototype;return t.update=function(){var e=this.projection,t=this.view,n=this.projectionView,i=this.inverseProjectionView,r=this.zoom,a=this.viewportWidth,s=this.viewportHeight;e.ortho(r*(-a/2),r*(a/2),r*(-s/2),r*(s/2),this.near,this.far),t.lookAt(this.position,this.direction,this.up),n.set(e.values),n.multiply(t),i.set(n.values).invert()},t.screenToWorld=function(e,t,n){var i=e.x,r=n-e.y-1;return e.x=2*i/t-1,e.y=2*r/n-1,e.z=2*e.z-1,e.project(this.inverseProjectionView),e},t.worldToScreen=function(e,t,n){return e.project(this.projectionView),e.x=t*(e.x+1)/2,e.y=n*(e.y+1)/2,e.z=(e.z+1)/2,e},t.setViewport=function(e,t){this.viewportWidth=e,this.viewportHeight=t},e}(),li=function(){function e(e){this.element=void 0,this.mouseX=0,this.mouseY=0,this.buttonDown=!1,this.touch0=null,this.touch1=null,this.initialPinchDistance=0,this.listeners=new Array,this.eventListeners=[],this.element=e,this.setupCallbacks(e)}var t=e.prototype;return t.setupCallbacks=function(e){var t=this,n=function(n){if(n instanceof MouseEvent){var i=e.getBoundingClientRect();t.mouseX=n.clientX-i.left,t.mouseY=n.clientY-i.top,t.listeners.map((function(e){t.buttonDown?e.dragged&&e.dragged(t.mouseX,t.mouseY):e.moved&&e.moved(t.mouseX,t.mouseY)}))}},i=function i(r){if(r instanceof MouseEvent){var a=e.getBoundingClientRect();t.mouseX=r.clientX-a.left,t.mouseY=r.clientY-a.top,t.buttonDown=!1,t.listeners.map((function(e){e.up&&e.up(t.mouseX,t.mouseY)})),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",i)}};e.addEventListener("mousedown",(function(r){if(r instanceof MouseEvent){var a=e.getBoundingClientRect();t.mouseX=r.clientX-a.left,t.mouseY=r.clientY-a.top,t.buttonDown=!0,t.listeners.map((function(e){e.down&&e.down(t.mouseX,t.mouseY)})),document.addEventListener("mousemove",n),document.addEventListener("mouseup",i)}}),!0),e.addEventListener("mousemove",n,!0),e.addEventListener("mouseup",i,!0),e.addEventListener("wheel",(function(e){e.preventDefault();e.deltaY;e.deltaMode,WheelEvent.DOM_DELTA_LINE,e.deltaMode,WheelEvent.DOM_DELTA_PAGE,t.listeners.map((function(t){t.wheel&&t.wheel(e.deltaY)}))}),!0),e.addEventListener("touchstart",(function(n){if(!t.touch0||!t.touch1){var i=n.changedTouches.item(0);if(!i)return;var r=e.getBoundingClientRect(),a=i.clientX-r.left,s=i.clientY-r.top,o=new di(i.identifier,a,s);if(t.mouseX=a,t.mouseY=s,t.buttonDown=!0,t.touch0){if(!t.touch1){t.touch1=o;var c=t.touch1.x-t.touch0.x,h=t.touch1.x-t.touch0.x;t.initialPinchDistance=Math.sqrt(c*c+h*h),t.listeners.map((function(e){e.zoom&&e.zoom(t.initialPinchDistance,t.initialPinchDistance)}))}}else t.touch0=o,t.listeners.map((function(e){e.down&&e.down(o.x,o.y)}))}n.preventDefault()}),!1),e.addEventListener("touchmove",(function(n){if(t.touch0){for(var i,r=n.changedTouches,a=e.getBoundingClientRect(),s=function(){var e=(i=r[o]).clientX-a.left,n=i.clientY-a.top;t.touch0.identifier===i.identifier&&(t.touch0.x=t.mouseX=e,t.touch0.y=t.mouseY=n,t.listeners.map((function(t){t.dragged&&t.dragged(e,n)}))),t.touch1&&t.touch1.identifier===i.identifier&&(t.touch1.x=t.mouseX=e,t.touch1.y=t.mouseY=n)},o=0;o<r.length;o++)s();if(t.touch0&&t.touch1){var c=t.touch1.x-t.touch0.x,h=t.touch1.x-t.touch0.x,u=Math.sqrt(c*c+h*h);t.listeners.map((function(e){e.zoom&&e.zoom(t.initialPinchDistance,u)}))}}n.preventDefault()}),!1);var r=function(n){if(t.touch0)for(var i,r=n.changedTouches,a=e.getBoundingClientRect(),s=function(){var e=(i=r[o]).clientX-a.left,n=i.clientY-a.top;if(t.touch0.identifier===i.identifier){if(t.touch0=null,t.mouseX=e,t.mouseY=n,t.listeners.map((function(t){t.up&&t.up(e,n)})),!t.touch1)return t.buttonDown=!1,1;t.touch0=t.touch1,t.touch1=null,t.mouseX=t.touch0.x,t.mouseX=t.touch0.x,t.buttonDown=!0,t.listeners.map((function(e){e.down&&e.down(t.touch0.x,t.touch0.y)}))}t.touch1&&t.touch1.identifier&&(t.touch1=null)},o=0;o<r.length&&!s();o++);n.preventDefault()};e.addEventListener("touchend",r,!1),e.addEventListener("touchcancel",r)},t.addListener=function(e){this.listeners.push(e)},t.removeListener=function(e){var t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)},e}(),di=function(e,t,n){this.identifier=e,this.x=t,this.y=n},pi=function(e,t){this.canvas=e,this.camera=t;var n=0,i=0,r=0,a=0,s=0,o=0,c=0;new li(e).addListener({down:function(e,h){n=t.position.x,i=t.position.y,r=s=e,a=o=h,c=t.zoom},dragged:function(c,h){var u=c-r,l=h-a,d=t.screenToWorld(new zn(0,0),e.clientWidth,e.clientHeight),p=t.screenToWorld(new zn(u,l),e.clientWidth,e.clientHeight).sub(d);t.position.set(n-p.x,i-p.y,0),t.update(),s=c,o=h},wheel:function(n){var i=n/200*t.zoom,r=t.zoom+i;if(r>0){var a=0,c=0;if(n<0)a=s,c=o;else{var h=new zn(e.clientWidth/2+15,e.clientHeight/2),u=s-h.x,l=e.clientHeight-1-o-h.y;a=h.x-u,c=e.clientHeight-1-h.y+l}var d=t.screenToWorld(new zn(a,c),e.clientWidth,e.clientHeight);t.zoom=r,t.update();var p=t.screenToWorld(new zn(a,c),e.clientWidth,e.clientHeight);t.position.add(d.sub(p)),t.update()}},zoom:function(e,n){var i=e/n;t.zoom=c*i},up:function(e,t){s=e,o=t},moved:function(e,t){s=e,o=t}})},fi=function(){function e(e,t,n){this.context=void 0,this.vs=null,this.vsSource=void 0,this.fs=null,this.fsSource=void 0,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vertexShader=t,this.fragmentShader=n,this.vsSource=t,this.fsSource=n,this.context=e instanceof Wn?e:new Wn(e),this.context.addRestorable(this),this.compile()}var t=e.prototype;return t.getProgram=function(){return this.program},t.getVertexShader=function(){return this.vertexShader},t.getFragmentShader=function(){return this.fragmentShader},t.getVertexShaderSource=function(){return this.vsSource},t.getFragmentSource=function(){return this.fsSource},t.compile=function(){var e=this.context.gl;try{if(this.vs=this.compileShader(e.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(e.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}},t.compileShader=function(e,t){var n=this.context.gl,i=n.createShader(e);if(!i)throw new Error("Couldn't create shader.");if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var r="Couldn't compile shader: "+n.getShaderInfoLog(i);if(n.deleteShader(i),!n.isContextLost())throw new Error(r)}return i},t.compileProgram=function(e,t){var n=this.context.gl,i=n.createProgram();if(!i)throw new Error("Couldn't compile program.");if(n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){var r="Couldn't compile shader program: "+n.getProgramInfoLog(i);if(n.deleteProgram(i),!n.isContextLost())throw new Error(r)}return i},t.restore=function(){this.compile()},t.bind=function(){this.context.gl.useProgram(this.program)},t.unbind=function(){this.context.gl.useProgram(null)},t.setUniformi=function(e,t){this.context.gl.uniform1i(this.getUniformLocation(e),t)},t.setUniformf=function(e,t){this.context.gl.uniform1f(this.getUniformLocation(e),t)},t.setUniform2f=function(e,t,n){this.context.gl.uniform2f(this.getUniformLocation(e),t,n)},t.setUniform3f=function(e,t,n,i){this.context.gl.uniform3f(this.getUniformLocation(e),t,n,i)},t.setUniform4f=function(e,t,n,i,r){this.context.gl.uniform4f(this.getUniformLocation(e),t,n,i,r)},t.setUniform2x2f=function(e,t){var n=this.context.gl;this.tmp2x2.set(t),n.uniformMatrix2fv(this.getUniformLocation(e),!1,this.tmp2x2)},t.setUniform3x3f=function(e,t){var n=this.context.gl;this.tmp3x3.set(t),n.uniformMatrix3fv(this.getUniformLocation(e),!1,this.tmp3x3)},t.setUniform4x4f=function(e,t){var n=this.context.gl;this.tmp4x4.set(t),n.uniformMatrix4fv(this.getUniformLocation(e),!1,this.tmp4x4)},t.getUniformLocation=function(e){var t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");var n=t.getUniformLocation(this.program,e);if(!n&&!t.isContextLost())throw new Error("Couldn't find location for uniform "+e);return n},t.getAttributeLocation=function(e){var t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");var n=t.getAttribLocation(this.program,e);if(-1==n&&!t.isContextLost())throw new Error("Couldn't find location for attribute "+e);return n},t.dispose=function(){this.context.removeRestorable(this);var e=this.context.gl;this.vs&&(e.deleteShader(this.vs),this.vs=null),this.fs&&(e.deleteShader(this.fs),this.fs=null),this.program&&(e.deleteProgram(this.program),this.program=null)},e.newColoredTextured=function(t){return new e(t,"\nattribute vec4 "+e.POSITION+";\nattribute vec4 "+e.COLOR+";\nattribute vec2 "+e.TEXCOORDS+";\nuniform mat4 "+e.MVP_MATRIX+";\nvarying vec4 v_color;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_color = "+e.COLOR+";\n\tv_texCoords = "+e.TEXCOORDS+";\n\tgl_Position = "+e.MVP_MATRIX+" * "+e.POSITION+";\n}\n","\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n}\n")},e.newTwoColoredTextured=function(t){return new e(t,"\nattribute vec4 "+e.POSITION+";\nattribute vec4 "+e.COLOR+";\nattribute vec4 "+e.COLOR2+";\nattribute vec2 "+e.TEXCOORDS+";\nuniform mat4 "+e.MVP_MATRIX+";\nvarying vec4 v_light;\nvarying vec4 v_dark;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_light = "+e.COLOR+";\n\tv_dark = "+e.COLOR2+";\n\tv_texCoords = "+e.TEXCOORDS+";\n\tgl_Position = "+e.MVP_MATRIX+" * "+e.POSITION+";\n}\n","\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_light;\nvarying LOWP vec4 v_dark;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\tgl_FragColor.a = texColor.a * v_light.a;\n\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n}\n")},e.newColored=function(t){return new e(t,"\nattribute vec4 "+e.POSITION+";\nattribute vec4 "+e.COLOR+";\nuniform mat4 "+e.MVP_MATRIX+";\nvarying vec4 v_color;\n\nvoid main () {\n\tv_color = "+e.COLOR+";\n\tgl_Position = "+e.MVP_MATRIX+" * "+e.POSITION+";\n}\n","\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\n\nvoid main () {\n\tgl_FragColor = v_color;\n}\n")},e}();d(fi,"MVP_MATRIX","u_projTrans"),d(fi,"POSITION","a_position"),d(fi,"COLOR","a_color"),d(fi,"COLOR2","a_color2"),d(fi,"TEXCOORDS","a_texCoords"),d(fi,"SAMPLER","u_texture");var mi,gi=function(){function e(e,t,n,i){this.context=void 0,this.vertices=void 0,this.verticesBuffer=null,this.verticesLength=0,this.dirtyVertices=!1,this.indices=void 0,this.indicesBuffer=null,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.attributes=t,this.context=e instanceof Wn?e:new Wn(e),this.elementsPerVertex=0;for(var r=0;r<t.length;r++)this.elementsPerVertex+=t[r].numElements;this.vertices=new Float32Array(n*this.elementsPerVertex),this.indices=new Uint16Array(i),this.context.addRestorable(this)}var t=e.prototype;return t.getAttributes=function(){return this.attributes},t.maxVertices=function(){return this.vertices.length/this.elementsPerVertex},t.numVertices=function(){return this.verticesLength/this.elementsPerVertex},t.setVerticesLength=function(e){this.dirtyVertices=!0,this.verticesLength=e},t.getVertices=function(){return this.vertices},t.maxIndices=function(){return this.indices.length},t.numIndices=function(){return this.indicesLength},t.setIndicesLength=function(e){this.dirtyIndices=!0,this.indicesLength=e},t.getIndices=function(){return this.indices},t.getVertexSizeInFloats=function(){for(var e=0,t=0;t<this.attributes.length;t++){e+=this.attributes[t].numElements}return e},t.setVertices=function(e){if(this.dirtyVertices=!0,e.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(e,0),this.verticesLength=e.length},t.setIndices=function(e){if(this.dirtyIndices=!0,e.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(e,0),this.indicesLength=e.length},t.draw=function(e,t){this.drawWithOffset(e,t,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)},t.drawWithOffset=function(e,t,n,i){var r=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(e),this.indicesLength>0?r.drawElements(t,i,r.UNSIGNED_SHORT,2*n):r.drawArrays(t,n,i),this.unbind(e)},t.bind=function(e){var t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer);for(var n=0,i=0;i<this.attributes.length;i++){var r=this.attributes[i],a=e.getAttributeLocation(r.name);t.enableVertexAttribArray(a),t.vertexAttribPointer(a,r.numElements,t.FLOAT,!1,4*this.elementsPerVertex,4*n),n+=r.numElements}this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},t.unbind=function(e){for(var t=this.context.gl,n=0;n<this.attributes.length;n++){var i=this.attributes[n],r=e.getAttributeLocation(i.name);t.disableVertexAttribArray(r)}t.bindBuffer(t.ARRAY_BUFFER,null),this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)},t.update=function(){var e=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),e.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),e.DYNAMIC_DRAW),this.dirtyIndices=!1)},t.restore=function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()},t.dispose=function(){this.context.removeRestorable(this);var e=this.context.gl;e.deleteBuffer(this.verticesBuffer),e.deleteBuffer(this.indicesBuffer)},e}(),vi=function(e,t,n){this.name=e,this.type=t,this.numElements=n},yi=function(e){function t(){return e.call(this,fi.POSITION,bi.Float,2)||this}return(0,a.Z)(t,e),t}(vi),Ei=function(e){function t(){return e.call(this,fi.POSITION,bi.Float,3)||this}return(0,a.Z)(t,e),t}(vi),Ci=function(e){function t(t){return void 0===t&&(t=0),e.call(this,fi.TEXCOORDS+(0==t?"":t),bi.Float,2)||this}return(0,a.Z)(t,e),t}(vi),wi=function(e){function t(){return e.call(this,fi.COLOR,bi.Float,4)||this}return(0,a.Z)(t,e),t}(vi),Ai=function(e){function t(){return e.call(this,fi.COLOR2,bi.Float,4)||this}return(0,a.Z)(t,e),t}(vi),bi=((mi=bi||{})[mi.Float=0]="Float",mi),Si=function(){function e(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=10920),this.context=void 0,this.drawCalls=0,this.isDrawing=!1,this.mesh=void 0,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.srcColorBlend=void 0,this.srcAlphaBlend=void 0,this.dstBlend=void 0,this.cullWasEnabled=!1,n>10920)throw new Error("Can't have more than 10920 triangles per batch: "+n);this.context=e instanceof Wn?e:new Wn(e);var i=t?[new yi,new wi,new Ci,new Ai]:[new yi,new wi,new Ci];this.mesh=new gi(e,i,n,3*n);var r=this.context.gl;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA}var t=e.prototype;return t.begin=function(t){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0;var n=this.context.gl;n.enable(n.BLEND),n.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend),e.disableCulling&&(this.cullWasEnabled=n.isEnabled(n.CULL_FACE),this.cullWasEnabled&&n.disable(n.CULL_FACE))},t.setBlendMode=function(t,n){var i=e.blendModesGL[t],r=n?i.srcRgbPma:i.srcRgb,a=i.srcAlpha,s=i.dstRgb;this.srcColorBlend==r&&this.srcAlphaBlend==a&&this.dstBlend==s||(this.srcColorBlend=r,this.srcAlphaBlend=a,this.dstBlend=s,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(r,s,a,s))},t.draw=function(e,t,n){e!=this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+t.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var i=this.mesh.numVertices();this.mesh.getVertices().set(t,this.verticesLength),this.verticesLength+=t.length,this.mesh.setVerticesLength(this.verticesLength);for(var r=this.mesh.getIndices(),a=this.indicesLength,s=0;s<n.length;a++,s++)r[a]=n[s]+i;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)},t.flush=function(){if(0!=this.verticesLength){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,e.globalDrawCalls++}},t.end=function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;var t=this.context.gl;t.disable(t.BLEND),e.disableCulling&&this.cullWasEnabled&&t.enable(t.CULL_FACE)},t.getDrawCalls=function(){return this.drawCalls},e.getAndResetGlobalDrawCalls=function(){var t=e.globalDrawCalls;return e.globalDrawCalls=0,t},t.dispose=function(){this.mesh.dispose()},e}();d(Si,"disableCulling",!1),d(Si,"globalDrawCalls",0),d(Si,"blendModesGL",[{srcRgb:770,srcRgbPma:1,dstRgb:771,srcAlpha:1},{srcRgb:770,srcRgbPma:1,dstRgb:1,srcAlpha:1},{srcRgb:774,srcRgbPma:774,dstRgb:771,srcAlpha:1},{srcRgb:1,srcRgbPma:1,dstRgb:769,srcAlpha:1}]);var Ti,xi=function(){function e(e,t){if(void 0===t&&(t=10920),this.context=void 0,this.isDrawing=!1,this.mesh=void 0,this.shapeType=ki.Filled,this.color=new b(1,1,1,1),this.shader=null,this.vertexIndex=0,this.tmp=new B,this.srcColorBlend=void 0,this.srcAlphaBlend=void 0,this.dstBlend=void 0,t>10920)throw new Error("Can't have more than 10920 triangles per batch: "+t);this.context=e instanceof Wn?e:new Wn(e),this.mesh=new gi(e,[new yi,new wi],t,0);var n=this.context.gl;this.srcColorBlend=n.SRC_ALPHA,this.srcAlphaBlend=n.ONE,this.dstBlend=n.ONE_MINUS_SRC_ALPHA}var t=e.prototype;return t.begin=function(e){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=e,this.vertexIndex=0,this.isDrawing=!0;var t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)},t.setBlendMode=function(e,t,n){(this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=n,this.isDrawing)&&(this.flush(),this.context.gl.blendFuncSeparate(e,n,t,n))},t.setColor=function(e){this.color.setFromColor(e)},t.setColorWith=function(e,t,n,i){this.color.set(e,t,n,i)},t.point=function(e,t,n){this.check(ki.Point,1),n||(n=this.color),this.vertex(e,t,n)},t.line=function(e,t,n,i,r){this.check(ki.Line,2);this.mesh.getVertices(),this.vertexIndex;r||(r=this.color),this.vertex(e,t,r),this.vertex(n,i,r)},t.triangle=function(e,t,n,i,r,a,s,o,c,h){this.check(e?ki.Filled:ki.Line,3);this.mesh.getVertices(),this.vertexIndex;o||(o=this.color),c||(c=this.color),h||(h=this.color),e?(this.vertex(t,n,o),this.vertex(i,r,c),this.vertex(a,s,h)):(this.vertex(t,n,o),this.vertex(i,r,c),this.vertex(i,r,o),this.vertex(a,s,c),this.vertex(a,s,o),this.vertex(t,n,c))},t.quad=function(e,t,n,i,r,a,s,o,c,h,u,l,d){this.check(e?ki.Filled:ki.Line,3);this.mesh.getVertices(),this.vertexIndex;h||(h=this.color),u||(u=this.color),l||(l=this.color),d||(d=this.color),e?(this.vertex(t,n,h),this.vertex(i,r,u),this.vertex(a,s,l),this.vertex(a,s,l),this.vertex(o,c,d),this.vertex(t,n,h)):(this.vertex(t,n,h),this.vertex(i,r,u),this.vertex(i,r,u),this.vertex(a,s,l),this.vertex(a,s,l),this.vertex(o,c,d),this.vertex(o,c,d),this.vertex(t,n,h))},t.rect=function(e,t,n,i,r,a){this.quad(e,t,n,t+i,n,t+i,n+r,t,n+r,a,a,a,a)},t.rectLine=function(e,t,n,i,r,a,s){this.check(e?ki.Filled:ki.Line,8),s||(s=this.color);var o=this.tmp.set(r-n,t-i);o.normalize(),a*=.5;var c=o.x*a,h=o.y*a;e?(this.vertex(t+c,n+h,s),this.vertex(t-c,n-h,s),this.vertex(i+c,r+h,s),this.vertex(i-c,r-h,s),this.vertex(i+c,r+h,s),this.vertex(t-c,n-h,s)):(this.vertex(t+c,n+h,s),this.vertex(t-c,n-h,s),this.vertex(i+c,r+h,s),this.vertex(i-c,r-h,s),this.vertex(i+c,r+h,s),this.vertex(t+c,n+h,s),this.vertex(i-c,r-h,s),this.vertex(t-c,n-h,s))},t.x=function(e,t,n){this.line(e-n,t-n,e+n,t+n),this.line(e-n,t+n,e+n,t-n)},t.polygon=function(e,t,n,i){if(n<3)throw new Error("Polygon must contain at least 3 vertices");this.check(ki.Line,2*n),i||(i=this.color);this.mesh.getVertices(),this.vertexIndex;n<<=1;for(var r=e[t<<=1],a=e[t+1],s=t+n,o=t,c=t+n-2;o<c;o+=2){var h=e[o],u=e[o+1],l=0,d=0;o+2>=s?(l=r,d=a):(l=e[o+2],d=e[o+3]),this.vertex(h,u,i),this.vertex(l,d,i)}},t.circle=function(e,t,n,i,r,a){if(void 0===a&&(a=0),0==a&&(a=Math.max(1,6*T.cbrt(i)|0)),a<=0)throw new Error("segments must be > 0.");r||(r=this.color);var s=2*T.PI/a,o=Math.cos(s),c=Math.sin(s),h=i,u=0;if(e){this.check(ki.Filled,3*a+3),a--;for(var l=0;l<a;l++){this.vertex(t,n,r),this.vertex(t+h,n+u,r);var d=h;h=o*h-c*u,u=c*d+o*u,this.vertex(t+h,n+u,r)}this.vertex(t,n,r),this.vertex(t+h,n+u,r)}else{this.check(ki.Line,2*a+2);for(var p=0;p<a;p++){this.vertex(t+h,n+u,r);var f=h;h=o*h-c*u,u=c*f+o*u,this.vertex(t+h,n+u,r)}this.vertex(t+h,n+u,r)}h=i,u=0,this.vertex(t+h,n+u,r)},t.curve=function(e,t,n,i,r,a,s,o,c,h){this.check(ki.Line,2*c+2),h||(h=this.color);for(var u=1/c,l=u*u,d=u*u*u,p=3*u,f=3*l,m=6*l,g=6*d,v=e-2*n+r,y=t-2*i+a,E=3*(n-r)-e+s,C=3*(i-a)-t+o,w=e,A=t,b=(n-e)*p+v*f+E*d,S=(i-t)*p+y*f+C*d,T=v*m+E*g,x=y*m+C*g,k=E*g,P=C*g;c-- >0;)this.vertex(w,A,h),w+=b,A+=S,b+=T,S+=x,T+=k,x+=P,this.vertex(w,A,h);this.vertex(w,A,h),this.vertex(s,o,h)},t.vertex=function(e,t,n){var i=this.vertexIndex,r=this.mesh.getVertices();r[i++]=e,r[i++]=t,r[i++]=n.r,r[i++]=n.g,r[i++]=n.b,r[i++]=n.a,this.vertexIndex=i},t.end=function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var e=this.context.gl;e.disable(e.BLEND),this.isDrawing=!1},t.flush=function(){if(0!=this.vertexIndex){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}},t.check=function(e,t){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==e){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<t))return;this.flush()}else this.flush(),this.shapeType=e},t.dispose=function(){this.mesh.dispose()},e}(),ki=((Ti=ki||{})[Ti.Point=0]="Point",Ti[Ti.Line=1]="Line",Ti[Ti.Filled=4]="Filled",Ti),Pi=function(){function e(e){this.boneLineColor=new b(1,0,0,1),this.boneOriginColor=new b(0,1,0,1),this.attachmentLineColor=new b(0,0,1,.5),this.triangleLineColor=new b(1,.64,0,.5),this.pathColor=(new b).setFromString("FF7F00"),this.clipColor=new b(.8,0,0,2),this.aabbColor=new b(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.context=void 0,this.bounds=new Dn,this.temp=new Array,this.vertices=I.newFloatArray(2048),this.context=e instanceof Wn?e:new Wn(e)}var t=e.prototype;return t.draw=function(t,n,i){var r=n.x,a=n.y,s=this.context.gl,o=this.premultipliedAlpha?s.ONE:s.SRC_ALPHA;t.setBlendMode(o,s.ONE,s.ONE_MINUS_SRC_ALPHA);var c=n.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(var h=0,u=c.length;h<u;h++){var l=c[h];if(!(i&&i.indexOf(l.data.name)>-1)&&l.parent){var d=l.data.length*l.a+l.worldX,p=l.data.length*l.c+l.worldY;t.rectLine(!0,l.worldX,l.worldY,d,p,this.boneWidth*this.scale)}}this.drawSkeletonXY&&t.x(r,a,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);for(var f=n.slots,m=0,g=f.length;m<g;m++){var v=f[m],y=v.getAttachment();if(y instanceof ct){var E=y,C=this.vertices;E.computeWorldVertices(v,C,0,2),t.line(C[0],C[1],C[2],C[3]),t.line(C[2],C[3],C[4],C[5]),t.line(C[4],C[5],C[6],C[7]),t.line(C[6],C[7],C[0],C[1])}}}if(this.drawMeshHull||this.drawMeshTriangles)for(var w=n.slots,A=0,b=w.length;A<b;A++){var S=w[A];if(S.bone.active){var T=S.getAttachment();if(T instanceof at){var x=T,k=this.vertices;x.computeWorldVertices(S,0,x.worldVerticesLength,k,0,2);var P=x.triangles,O=x.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(var R=0,B=P.length;R<B;R+=3){var D=2*P[R],L=2*P[R+1],M=2*P[R+2];t.triangle(!1,k[D],k[D+1],k[L],k[L+1],k[M],k[M+1])}}if(this.drawMeshHull&&O>0){t.setColor(this.attachmentLineColor);for(var _=k[(O=2*(O>>1))-2],N=k[O-1],G=0,F=O;G<F;G+=2){var Z=k[G],U=k[G+1];t.line(Z,U,_,N),_=Z,N=U}}}}}if(this.drawBoundingBoxes){var W=this.bounds;W.update(n,!0),t.setColor(this.aabbColor),t.rect(!1,W.minX,W.minY,W.getWidth(),W.getHeight());for(var Y=W.polygons,H=W.boundingBoxes,z=0,K=Y.length;z<K;z++){var V=Y[z];t.setColor(H[z].color),t.polygon(V,0,V.length)}}if(this.drawPaths)for(var X=n.slots,j=0,q=X.length;j<q;j++){var J=X[j];if(J.bone.active){var Q=J.getAttachment();if(Q instanceof st){var $=Q,ee=$.worldVerticesLength,te=this.temp=I.setArraySize(this.temp,ee,0);$.computeWorldVertices(J,0,ee,te,0,2);var ne=this.pathColor,ie=te[2],re=te[3],ae=0,se=0;if($.closed){t.setColor(ne);var oe=te[0],ce=te[1],he=te[ee-2],ue=te[ee-1];ae=te[ee-4],se=te[ee-3],t.curve(ie,re,oe,ce,he,ue,ae,se,32),t.setColor(e.LIGHT_GRAY),t.line(ie,re,oe,ce),t.line(ae,se,he,ue)}ee-=4;for(var le=4;le<ee;le+=6){var de=te[le],pe=te[le+1],fe=te[le+2],me=te[le+3];ae=te[le+4],se=te[le+5],t.setColor(ne),t.curve(ie,re,de,pe,fe,me,ae,se,32),t.setColor(e.LIGHT_GRAY),t.line(ie,re,de,pe),t.line(ae,se,fe,me),ie=ae,re=se}}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(var ge=0,ve=c.length;ge<ve;ge++){var ye=c[ge];i&&i.indexOf(ye.data.name)>-1||t.circle(!0,ye.worldX,ye.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){var Ee=n.slots;t.setColor(this.clipColor);for(var Ce=0,we=Ee.length;Ce<we;Ce++){var Ae=Ee[Ce];if(Ae.bone.active){var be=Ae.getAttachment();if(be instanceof je){var Se=be,Te=Se.worldVerticesLength,xe=this.temp=I.setArraySize(this.temp,Te,0);Se.computeWorldVertices(Ae,0,Te,xe,0,2);for(var ke=0,Pe=xe.length;ke<Pe;ke+=2){var Ie=xe[ke],Oe=xe[ke+1],Re=xe[(ke+2)%xe.length],Be=xe[(ke+3)%xe.length];t.line(Ie,Oe,Re,Be)}}}}}},t.dispose=function(){},e}();d(Pi,"LIGHT_GRAY",new b(192/255,192/255,192/255,1)),d(Pi,"GREEN",new b(0,1,0,1));var Ii=function(e,t,n){this.vertices=e,this.numVertices=t,this.numFloats=n},Oi=function(){function e(e,t){void 0===t&&(t=!0),this.premultipliedAlpha=!1,this.tempColor=new b,this.tempColor2=new b,this.vertices=void 0,this.vertexSize=8,this.twoColorTint=!1,this.renderable=new Ii([],0,0),this.clipper=new Mn,this.temp=new B,this.temp2=new B,this.temp3=new b,this.temp4=new b,this.twoColorTint=t,t&&(this.vertexSize+=4),this.vertices=I.newFloatArray(1024*this.vertexSize)}var t=e.prototype;return t.draw=function(t,n,i,r,a){void 0===i&&(i=-1),void 0===r&&(r=-1),void 0===a&&(a=null);var s,o,c,h=this.clipper,u=this.premultipliedAlpha,l=this.twoColorTint,d=null,p=this.renderable,f=n.drawOrder,m=n.color,g=l?12:8,v=!1;-1==i&&(v=!0);for(var y=0,E=f.length;y<E;y++){var C=h.isClipping()?2:g,w=f[y];if(w.bone.active)if(i>=0&&i==w.data.index&&(v=!0),v){r>=0&&r==w.data.index&&(v=!1);var A=w.getAttachment(),b=void 0;if(A instanceof ct){var S=A;p.vertices=this.vertices,p.numVertices=4,p.numFloats=C<<2,S.computeWorldVertices(w,p.vertices,0,C),o=e.QUAD_TRIANGLES,s=S.uvs,b=S.region.texture,c=S.color}else{if(!(A instanceof at)){if(A instanceof je){var T=A;h.clipStart(w,T);continue}h.clipEndWithSlot(w);continue}var x=A;p.vertices=this.vertices,p.numVertices=x.worldVerticesLength>>1,p.numFloats=p.numVertices*C,p.numFloats>p.vertices.length&&(p.vertices=this.vertices=I.newFloatArray(p.numFloats)),x.computeWorldVertices(w,0,x.worldVerticesLength,p.vertices,0,C),o=x.triangles,b=x.region.texture,s=x.uvs,c=x.color}if(b){var k=w.color,P=this.tempColor;P.r=m.r*k.r*c.r,P.g=m.g*k.g*c.g,P.b=m.b*k.b*c.b,P.a=m.a*k.a*c.a,u&&(P.r*=P.a,P.g*=P.a,P.b*=P.a);var O=this.tempColor2;w.darkColor?(u?(O.r=w.darkColor.r*P.a,O.g=w.darkColor.g*P.a,O.b=w.darkColor.b*P.a):O.setFromColor(w.darkColor),O.a=u?1:0):O.set(0,0,0,1);var R=w.data.blendMode;if(R!=d&&(d=R,t.setBlendMode(d,u)),h.isClipping()){h.clipTriangles(p.vertices,o,o.length,s,P,O,l);var B=new Float32Array(h.clippedVertices),D=h.clippedTriangles;a&&a(B,B.length,g),t.draw(b,B,D)}else{var L=p.vertices;if(l)for(var M=2,_=0,N=p.numFloats;M<N;M+=g,_+=2)L[M]=P.r,L[M+1]=P.g,L[M+2]=P.b,L[M+3]=P.a,L[M+4]=s[_],L[M+5]=s[_+1],L[M+6]=O.r,L[M+7]=O.g,L[M+8]=O.b,L[M+9]=O.a;else for(var G=2,F=0,Z=p.numFloats;G<Z;G+=g,F+=2)L[G]=P.r,L[G+1]=P.g,L[G+2]=P.b,L[G+3]=P.a,L[G+4]=s[F],L[G+5]=s[F+1];var U=p.vertices.subarray(0,p.numFloats);a&&a(p.vertices,p.numFloats,g),t.draw(b,U,o)}}h.clipEndWithSlot(w)}else h.clipEndWithSlot(w);else h.clipEndWithSlot(w)}h.clipEnd()},t.getSkeletonClipping=function(){return this.clipper},e}();d(Oi,"QUAD_TRIANGLES",[0,1,2,2,3,0]);var Ri,Bi,Di,Li=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],Mi=[0,1,2,2,3,0],_i=new b(1,1,1,1),Ni=function(){function e(e,t,n){void 0===n&&(n=!0),this.context=void 0,this.canvas=void 0,this.camera=void 0,this.batcher=void 0,this.twoColorTint=!1,this.batcherShader=void 0,this.shapes=void 0,this.shapesShader=void 0,this.activeRenderer=null,this.skeletonRenderer=void 0,this.skeletonDebugRenderer=void 0,this.canvas=e,this.context=t instanceof Wn?t:new Wn(t),this.twoColorTint=n,this.camera=new ui(e.width,e.height),this.batcherShader=n?fi.newTwoColoredTextured(this.context):fi.newColoredTextured(this.context),this.batcher=new Si(this.context,n),this.shapesShader=fi.newColored(this.context),this.shapes=new xi(this.context),this.skeletonRenderer=new Oi(this.context,n),this.skeletonDebugRenderer=new Pi(this.context)}var t=e.prototype;return t.dispose=function(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()},t.begin=function(){this.camera.update(),this.enableRenderer(this.batcher)},t.drawSkeleton=function(e,t,n,i,r){void 0===t&&(t=!1),void 0===n&&(n=-1),void 0===i&&(i=-1),void 0===r&&(r=null),this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=t,this.skeletonRenderer.draw(this.batcher,e,n,i,r)},t.drawSkeletonDebug=function(e,t,n){void 0===t&&(t=!1),this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=t,this.skeletonDebugRenderer.draw(this.shapes,e,n)},t.drawTexture=function(e,t,n,i,r,a){this.enableRenderer(this.batcher),a||(a=_i);var s=0;Li[s++]=t,Li[s++]=n,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=0,Li[s++]=1,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t+i,Li[s++]=n,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=1,Li[s++]=1,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t+i,Li[s++]=n+r,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=1,Li[s++]=0,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t,Li[s++]=n+r,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=0,Li[s++]=0,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s]=0),this.batcher.draw(e,Li,Mi)},t.drawTextureUV=function(e,t,n,i,r,a,s,o,c,h){this.enableRenderer(this.batcher),h||(h=_i);var u=0;Li[u++]=t,Li[u++]=n,Li[u++]=h.r,Li[u++]=h.g,Li[u++]=h.b,Li[u++]=h.a,Li[u++]=a,Li[u++]=s,this.twoColorTint&&(Li[u++]=0,Li[u++]=0,Li[u++]=0,Li[u++]=0),Li[u++]=t+i,Li[u++]=n,Li[u++]=h.r,Li[u++]=h.g,Li[u++]=h.b,Li[u++]=h.a,Li[u++]=o,Li[u++]=s,this.twoColorTint&&(Li[u++]=0,Li[u++]=0,Li[u++]=0,Li[u++]=0),Li[u++]=t+i,Li[u++]=n+r,Li[u++]=h.r,Li[u++]=h.g,Li[u++]=h.b,Li[u++]=h.a,Li[u++]=o,Li[u++]=c,this.twoColorTint&&(Li[u++]=0,Li[u++]=0,Li[u++]=0,Li[u++]=0),Li[u++]=t,Li[u++]=n+r,Li[u++]=h.r,Li[u++]=h.g,Li[u++]=h.b,Li[u++]=h.a,Li[u++]=a,Li[u++]=c,this.twoColorTint&&(Li[u++]=0,Li[u++]=0,Li[u++]=0,Li[u]=0),this.batcher.draw(e,Li,Mi)},t.drawTextureRotated=function(e,t,n,i,r,a,s,o,c){this.enableRenderer(this.batcher),c||(c=_i);var h=t+a,u=n+s,l=-a,d=-s,p=i-a,f=r-s,m=l,g=d,v=l,y=f,E=p,C=f,w=p,A=d,b=0,S=0,x=0,k=0,P=0,I=0,O=0,R=0;if(0!=o){var B=T.cosDeg(o),D=T.sinDeg(o);x=(P=B*E-D*C)+((b=B*m-D*g)-(O=B*v-D*y)),k=(I=D*E+B*C)+((S=D*m+B*g)-(R=D*v+B*y))}else b=m,S=g,O=v,R=y,P=E,I=C,x=w,k=A;b+=h,S+=u,x+=h,k+=u,P+=h,I+=u,O+=h,R+=u;var L=0;Li[L++]=b,Li[L++]=S,Li[L++]=c.r,Li[L++]=c.g,Li[L++]=c.b,Li[L++]=c.a,Li[L++]=0,Li[L++]=1,this.twoColorTint&&(Li[L++]=0,Li[L++]=0,Li[L++]=0,Li[L++]=0),Li[L++]=x,Li[L++]=k,Li[L++]=c.r,Li[L++]=c.g,Li[L++]=c.b,Li[L++]=c.a,Li[L++]=1,Li[L++]=1,this.twoColorTint&&(Li[L++]=0,Li[L++]=0,Li[L++]=0,Li[L++]=0),Li[L++]=P,Li[L++]=I,Li[L++]=c.r,Li[L++]=c.g,Li[L++]=c.b,Li[L++]=c.a,Li[L++]=1,Li[L++]=0,this.twoColorTint&&(Li[L++]=0,Li[L++]=0,Li[L++]=0,Li[L++]=0),Li[L++]=O,Li[L++]=R,Li[L++]=c.r,Li[L++]=c.g,Li[L++]=c.b,Li[L++]=c.a,Li[L++]=0,Li[L++]=0,this.twoColorTint&&(Li[L++]=0,Li[L++]=0,Li[L++]=0,Li[L]=0),this.batcher.draw(e,Li,Mi)},t.drawRegion=function(e,t,n,i,r,a){this.enableRenderer(this.batcher),a||(a=_i);var s=0;Li[s++]=t,Li[s++]=n,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=e.u,Li[s++]=e.v2,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t+i,Li[s++]=n,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=e.u2,Li[s++]=e.v2,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t+i,Li[s++]=n+r,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=e.u2,Li[s++]=e.v,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s++]=0),Li[s++]=t,Li[s++]=n+r,Li[s++]=a.r,Li[s++]=a.g,Li[s++]=a.b,Li[s++]=a.a,Li[s++]=e.u,Li[s++]=e.v,this.twoColorTint&&(Li[s++]=0,Li[s++]=0,Li[s++]=0,Li[s]=0),this.batcher.draw(e.page.texture,Li,Mi)},t.line=function(e,t,n,i,r,a){this.enableRenderer(this.shapes),this.shapes.line(e,t,n,i,r)},t.triangle=function(e,t,n,i,r,a,s,o,c,h){this.enableRenderer(this.shapes),this.shapes.triangle(e,t,n,i,r,a,s,o,c,h)},t.quad=function(e,t,n,i,r,a,s,o,c,h,u,l,d){this.enableRenderer(this.shapes),this.shapes.quad(e,t,n,i,r,a,s,o,c,h,u,l,d)},t.rect=function(e,t,n,i,r,a){this.enableRenderer(this.shapes),this.shapes.rect(e,t,n,i,r,a)},t.rectLine=function(e,t,n,i,r,a,s){this.enableRenderer(this.shapes),this.shapes.rectLine(e,t,n,i,r,a,s)},t.polygon=function(e,t,n,i){this.enableRenderer(this.shapes),this.shapes.polygon(e,t,n,i)},t.circle=function(e,t,n,i,r,a){void 0===a&&(a=0),this.enableRenderer(this.shapes),this.shapes.circle(e,t,n,i,r,a)},t.curve=function(e,t,n,i,r,a,s,o,c,h){this.enableRenderer(this.shapes),this.shapes.curve(e,t,n,i,r,a,s,o,c,h)},t.end=function(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null},t.resize=function(e){var t=this.canvas,n=window.devicePixelRatio||1,i=Math.round(t.clientWidth*n),r=Math.round(t.clientHeight*n);if(t.width==i&&t.height==r||(t.width=i,t.height=r),this.context.gl.viewport(0,0,t.width,t.height),e===Gi.Expand)this.camera.setViewport(i,r);else if(e===Gi.Fit){var a=t.width,s=t.height,o=this.camera.viewportWidth,c=this.camera.viewportHeight,h=c/o<s/a?o/a:c/s;this.camera.setViewport(a*h,s*h)}this.camera.update()},t.enableRenderer=function(e){this.activeRenderer!==e&&(this.end(),e instanceof Si?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(fi.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):e instanceof xi?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(fi.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)},e}(),Gi=((Ri=Gi||{})[Ri.Stretch=0]="Stretch",Ri[Ri.Expand=1]="Expand",Ri[Ri.Fit=2]="Fit",Ri),Fi=0,Zi=163,Ui=function(){function e(e){if(this.renderer=void 0,this.logo=null,this.spinner=null,this.angle=0,this.fadeOut=0,this.fadeIn=0,this.timeKeeper=new D,this.backgroundColor=new b(.135,.135,.135,1),this.tempColor=new b,this.renderer=e,this.timeKeeper.maxDelta=9,!Di){var t=navigator.userAgent.indexOf("Safari")>-1,n=function(){return Fi++};(Di=new Image).src=Yi,t||(Di.crossOrigin="anonymous"),Di.onload=n,(Bi=new Image).src=Wi,t||(Bi.crossOrigin="anonymous"),Bi.onload=n}}var t=e.prototype;return t.dispose=function(){var e,t;null==(e=this.logo)||e.dispose(),null==(t=this.spinner)||t.dispose()},t.draw=function(e){if(void 0===e&&(e=!1),!(Fi<2||e&&this.fadeOut>1)){this.timeKeeper.update();var t=Math.abs(Math.sin(this.timeKeeper.totalTime+.25));this.angle-=200*this.timeKeeper.delta*(1+1.5*Math.pow(t,5));var n=this.tempColor,i=this.renderer,r=i.canvas,a=i.context.gl;if(i.resize(1),i.camera.position.set(r.width/2,r.height/2,0),i.batcher.setBlendMode(0,!0),e){if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>1)return;n.setFromColor(this.backgroundColor),t=1-((t=1-this.fadeOut/1)-1)*(t-1),n.a*=t,n.a>0&&(i.camera.zoom=1,i.begin(),i.quad(!0,0,0,r.width,0,r.width,r.height,0,r.height,n,n,n,n),i.end())}else this.fadeIn+=this.timeKeeper.delta,this.backgroundColor.a>0&&(a.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),a.clear(a.COLOR_BUFFER_BIT)),t=1;t*=Math.min(this.fadeIn/1,1),n.set(t,t,t,t),this.logo||(this.logo=new Yn(i.context,Di),this.spinner=new Yn(i.context,Bi)),i.camera.zoom=Math.max(1,Zi/r.height),i.begin(),i.drawTexture(this.logo,(r.width-165)/2,(r.height-108)/2,165,108,n),this.spinner&&i.drawTextureRotated(this.spinner,(r.width-Zi)/2,(r.height-Zi)/2,Zi,Zi,81.5,81.5,this.angle,n),i.end()}},e}(),Wi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACjCAYAAADmbK6AAAALKElEQVR42u2de2iW5R/GPzuqcwfnnKfNmafl5tTNHWzqNi3DEMQykcAoJSsySkspjSIk0iD/07Kf4R+FnVBDUTshZGpWUEJaaiWFgZlUFmXmIe3HNXthyebeZ77P9H13ffBG8Y8H7ut7vff93N/7fu4vGGPiFZiez/Qtw9lytJajfzfw9z/j+efPOv7cV8W+lUNY2a8T/ayTCRsWFLJA5rtUO1LLkV5p9LJeJizQiHeqnlOtmVFtdTGrrZkJCxYXsTgaI6r9MY4/UpNItW4mFDaXsTlaM6qVZlBq3UwofFrJp0HMWJ9DvXUzobCznJ1BzFjWlTLrZkJh/TDWBzFjTgo51s2EgnKI0Rrx+FiOWzNzVaym91Syx5qZsGBWb2ZFa0ZN6dbMhAWTcpkUrRmXD2K5NTNhgVbH0Zpxbl/mWjMTFvRIo0e0ZpzcncnWzISKtvmiMWNRJ4qslwmVXRXsas2Ix8ZwzFqZsGFREYtaM+Oaa1ljrUzYkJ9G/ok6TlzKjJWZVFor0y7c1Zu7WjLiqiGsskamXdHopyT4vALmzS9k/t19uHtKHlOSIMn6xAtARjIZ1sFcUSZ0Y4La+G6M18hS2IlCn4a+WoC0JNL0d/dUupdnUj40g6EJ2VEdMnhrOG/p5f/jUXz8SgmvaGU6KpNRNsLVQV0OdXf24s63h/P2gWoOrBjMCr2GJFQnnxnIM3q5P1PPmaYv+4ev4/C6UtbpV2gzXCkgL5W8Bwt48OIc6ul6Tp+s4+SyASxLiI4+PYCn1bHzDZxvaQW6vZzto7MYnQIpNkf7kp5EuozYUroqEjcNKHHd0Tl9mBPN1pk+hFeieGBnBtog7UXjsj9pWg+m6duecw2cay1OC/uxMC47KmP9OIYfoz1YoC20J/rzRG4quTZK2EAyJGs20qwUbYw0aNRmUxtvfUW/uEtNzc1NB1/X8LVyd15hh82F43AvD+VlXcsSJEZa1CQ3ejleAO7oxR3RDP0XN91X4+NXYb8nkv7UNTwV7e0YTdu7I3g33t7tuaEbNwSZpps2fSyvs4M2Tjhot+jb0Xzbltj8r5j/xVt/6Z1Ob93U1ZYO691EhhzchcHeXosVjcNZysyezLw4xRZt05R+fTeuj8vOj+zKyG0j2aZcVVs6v+QalnjrMFZASQYl2nBoSyz06e3j/Xk8rgWYmMvEICu2pm1HOTuc7okV8FgRj0XukwzanhvCc/F+72TjoQjdObN1OFuDLmh0xP+WHtxiI10ukJlCprb4guiv1fP+avZrS1C7NAkliHZjDtZwMMgqbukAltpMlwuMy2FcEBPqvfLLar5Uqi0hBdEwryy+Mv5n6zkbjTBa+dlMlwvUZFETZKGiFM7tvbhdJ3gSVRO0wzIjnxmvl/J6a6JsGMYGrahtpssFeqbR841S3mhN80OjOaSDEdqd6SjaMKgzgzRK7q1ib3PT9sYyNo7JZoyNFNvRcVMZmy7WOvIuryv/Zvdmdt90+nY0bRp3AvROohFwdwW7dTG7RFlbwlqdrbOBYg005NAQmZU0HWt1rXMBH1Xw0dQ8pmqzoaPmdhun7bHZjNVe9qP9eFQfO1VkUmHjhAVUZ1GtnKFSbjrkrPfy4i4UW5t/6ZxM54J0CqxFe81KpGsQyE4h23oYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjLna+bdOy+IiFquIpGq16Pb79cNYv3IIK/X/ugx+Ui6TVKvYVU9Nc8gX8od8Ir/IN/KPfCQ/yVfyl/6/pfJvLChkQdD6wyqntquCXYuKWJSfRr6D0dEAxV3xlw/khyD+kd/ku/88cHo+09tS3LBpO1HHCVUqcIA6CqB4K+6X6x35L/JM2loXurlWmUmlA5XogOIcK8/If5HncrSWo7F6cKIWPjT/RXGOlWfkv8hzaWsN4uaaysE6WIkOKM6x8oz8F3kusXqo2vxC5jtYiQ4ozrH0TeS5qIZcrB7qkrwdA8U5Vp6R/yLPZV8V+2L14Cl5THGwEh1QnGPlGfkv8lyUlIzFQ1cNYVVHrcjZ0VCcFe9Y+Eb+izy3ceclUl43aFN52DXXssYpnY6a4qFS8ZcP2uIf+e7inRh6pdFrdTGrm8uiHx/L8T2V7NGWzvJBLJ/bl7mTuzO5qBNFDoiJID/IF/KHfCK/yDfyT3O7d/KbfNfS80hNIrU0g9L6HOq1x5iTQo6FNpeLfCQ/yVfyl3xmXYwxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHNk9z4JwJ0SqKTdQkbyEwhU393T6V7zzR6pieR3tE1ITeVXImhe6BXDGZFdRbVeank2TBhcaEMr0rwbixj49IBLL2/L/ffmMuNHfqO9tFZjJYBd1ewO3Lx+IcVfKhqna5nHZYR6XFPH+5R3eeI5t9fx/fvjeC9Jdew5OKZKqFR/RDVKL6vL/f9PJafmyvHsL+a/ff24V6NmjZQbGchVbY6UM2BluqHv1rCqzVZ1KQlkZboepCdQvacPsz5bjTfXao+yMEaDt7Wk9tSIMVGig3TejCtJSM2bSpkPjWPqd1S6Zao+lORSYWmgkOjORRNwZqd5ezMSiHLRooNr5XwWjS6/1XHX9vL2T67N7M1iyXa9JCrYjVrS1gbpJyw6hBfsmiNCYT0P9/A+Wj1/6qGr5YNYFlJBiWJogEzezLz/ZG8/9s4fgtSyuvNYbyp1IONFBtu7sHNv4/j9yAxUHWrdaWsG9+N8XHd+YxkMpSy+aySz841cC5oXbmHCnnI74yxAgZ3YbDeB4PEQCOpBpFNZWwa2ZWRcdnxLsl00crtRB0n2lLg8JNRfDKoM4NsolgBSmw/UMADba1+qpmqfyf6x1u/0a/og3I+aEunP6/i86osqmygcGarF4p54dex/Bo0LqfqOfVwIQ/HW5/RSkwV1oN2WLlHTc82TljAwM4M1O5LWwYKZTjibYXNS0N5KcjKTe10PadfLObFuJwK4ozp+UzXDBTUjL+M5ZcBnRkQV53dMIwNQTu6bSTbVEzbi5awuVByd2E/FgaN0Tc1fKOzBHHV2aAdVSdv6s5NNkp7cSH/++xAng2yyHx+CM/H21YhfdPp+0U1X0TbSZnXx8faG9Aop0MS0cToh1p+iLcpOkLj9t/JOk5eqoPHxnDsyf486an5yqCDK7XZ1O4oZ4dWyy3FSXHUAYq47uyYbMZoGmhpG3DlEFb6uNiVBhpyaHhnBO8oJmfqOROJjzIiP43hJ8UxITqqX56S2Hur2KsOnq3nrE6PPNKPRwrSKbAZrjTQNZmuE7oxYXMZmxWbw9dxWFu4W4ezVedOE6qzI7oyYkY+M7TPeWsPbk2UX1qioSN+E3OZqOR2cReKE+qQRFN0Pi7y73g/UawU1KzezJpXwLz5hczX1ueUPKYkNb6GJQZ+j7/aAfRZREsv+quGsMoamXZBW2Gt5eU0alorEzYsKmJRa/m4NdeyxlqZsCGa84DKnVorEzboC7podis69DfIJmwufHMc7famvvmxZiYsKOtKWbRm1OcW1syEBboSJFozLh/EcmtmwgIluaM14/phrLdmJixYXMTiaM24p5I91syEBTphFOR7Y2tmwgJNvUFOr+tov3UzoaAv44KYUatv62ZCoemdhtG0+hzqrZsJBR08DWLG0gxKrZu50qvpxos3U5NItW4mFPp1ot+lPlpq2lYXs9qamVBZUMiC1ox4pJYjvlfStAu6GmTLcLboMtPIV4/6im5fFfuUi9QIap2MiWP+D96R1vPmsD/fAAAAAElFTkSuQmCC",Yi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKUAAABsCAYAAAALzHKmAAAQ7klEQVR42u3da4xdVRUA4D0zd2Y6nZY59DVtZ1puS9+lzC0YAi2UQ8AAQczFpPgA9VIeIQbirRqJ0cBUBVGjDr/QCKSNRSMmpuODxAdxqhgwxkhFjf6Sxh/+UUNVNGJCzR7uTvas7LXX2q9zzp3em6y0gTN3Zu75utZe5+yztxC9V+/Ve5X9En1Vjd7J6SFbLNF7naPw+l2jh7YHMBWssqMHtlsRdim4qsLtIawaPiHEQOLoNrA9iIkQDnRrVA1qD2LZ8ISoxYqKo13sQAtBWBayQWZUAXGRQM9JjCngDVY0UqJNDbQrMcaGmArdUKpIjbYiQLsCZCyIMQBy8QwnilR4Q5AuCpxFYvRFmBLbEiwKwpsSaWycVQGZBKMrwBjA9BhxDe57u2L2hOoKNCbOrgAZitEVYUxoKSMErQvSxYIzCkguRg5EF4AUhqUlhy/YUKSxcRaKsioYOQhD4I0yYxkR3PcJBcuFysmgsXAWBTMJyBCMIQh9kGGxXIXvexCQXbHGAMrBWTbM2CCpMSMLIxehC77lSJwXGth7M0FzoVJIXXDWQnGmhOkL0ic7YhhtWdGGkAuPAjUWGoF4faCmwBkbZmyUqUCyMqMLRA4+E6IsdTjidUHKBYrh9CnpRcH0ypKxsyOGEYNIIeTCOz91OIJ1QYoB5eAMyZo+MFNnyVTZ0YiRC9EGEMOyAgshxErHsL2XK1gOUgwohtM1a5YNM7Rsu4K0ZkcbRm4mpPBRwFZ5hg9eCqkrUB+csWGGogzNkqEgrdnRhpGLkINudaLgwvVB6oqzCjCTZElb2Y4B0gUjBtEG0ARnDRLjjoG9DwcshtQGlIPTljVjwUySLWNkyRCQVHa0ZUUTRAwgF91a33BEy0VKAcVwwqwZC2bqbOlUurllOxQkJzNyINoAYqjWhYYjWg5SCiiG05Q1U8FMjTIoS8YE6YORi1BHtJ4KIcQEEtTXUWAxpK44YVlPBdO1jCdFWTZIE8bVGEYMIRPcZGBw4HKQcoBiOE1ZMzbMgVQwU6JMAdKEEcuIJogUvg1YCCE2gsCO42DlIIVAKZwpYJaSLVNnSU6XjYHUmxhTmXaFaMO3EYkLqMC+FsLlIoVAKZzMrEnBhJeLfLNlKMrYWRIDCbOkFSSVHbHM6AKRC6/ODUewNqQ+OLlZkxpjUmV8MBbMUJSxyzY3Q1IgTRgxiBRCHdem0KDAUkBh9sRwwjEnAXMMgTnKhFlUtiwkS5rGka4g9SaGgxFmRC7AzTCEEBcyA36dDSsXqAtOLkysjGMwY5XxVChjZ0kuSCo7YlkRQsQQYtDEFsegsLoCxUp7Kpgps2UslFGzJGccSYHUmxhOZqwzEZqAbfUMCisHKIZzgsCpl3MTzMwTpi1bYp2477gyFKUxS7qWbdjY2EBS2dGE0QQRA7gNCyHEdhjE8RhUDlBT9tzgmjWZMFNlSy+Urk1OzCyJlW0XkK4YOQh1cDtcgwBrQmoDWkdgboBZE8mYsJSHlnFbJ+5bwmOPJ7lZkirbC8aRsMvmgtTHjBhGE0QbwJ2egUE1ITVlUC5OmDVdYNrKuN70xM6WoShjlW4464dbtiFIWK6x7GjESEHUUe0iYncnbMdQSE0Z1ITTNOb0hRmjjLtmS9dmJ2rp1jtuKktyyrb6YLEMCUHq2dGG0QQRQ7f72kzc+cJecerne8Wvv7JNPHPvenEkz8Sh3UtFc92QyGt9Yko/HgOLAIUZlItTz5ouMF3KuE+2jFLCQ1D6lm6fLMkBacuOJowYRBUXyfjuHjF3NhdnsfjvAfH6E9vFt9XxKgikEKgJZyyYalzOLeMu2bLbULI6bh+QGwmQ+rgRlumdGEQAao+K56bEL2woVUwOiev0r8OAUjiJrMmFCbvykGxZRAmPitK1dHM7bohyMsuyi/I8f0+e57fJYIKEZXpXo9E4mOf5XTKyLLvCBLETF8uY2SKepkC+dpX4T02Ivepr4HvZcOZ5fmee54fyPL+DmTUhzAs6n4n8bN5dr9f3YdkSg8nsxG0lPBVKVpNjG0/aGhzfLDmRZdnumZmZp8+c+cdZPV555fSr7Xb7s0jJ3i5Pcue4MxKkPPkvvXTqz/B92u32l0wYOzG1fkhcd/py8Rcbyq/vFM/KY1WA95h/3zzP71bfU6JsNpsfgj+P/FlbrdaDGExYyuXvLz8H+DudODH700ajcSM3W6Yu4alQ1spCOTd38jcKocTZbh9+9NixY99XJ8AEUkcpo9W64yH197m5k7+bnZ19QT+J09NHntQhwji/Jg58qi6++ofLxJ8gSFneVw2Ka4QQDfh1Ok4dZavVmtZ/nrm5k7/Vf55O1tRhboUw5+ZOvqyOl5+R/FyOHj32PYVU/tloNG5IXcKrhJIzngwp3fNjomazea/64BuNxts646f50lWv169utw9/DmtqdJQyZFaSJVuV6nq9fqMEof5/vV6/CYBqgJDlee+yAbF/+4i4ZWqZeNfaIfHWzn+Hx0KcEuU9+s8jv3ej0bhVlXOZydX/k0iRMeb8P0D5e6tj8zy/Xb9UJIc56h/yqVOnXul8lmuZ2bJslKmbHG7XrbpCmCXFRLvdfqQD6jTS3Jiy5I4OykM6ADV+1Eu1DmV6evopBORexzDi1L+X/HnGxsb2w3Hm9PSRJ9QxWPOTZdmlKht2hi+w6dkox5bqffI8fye3hDteGqKaHVsHXihKl0tB+h0cY+lute54AGRKDCW89LNTRynHb7ChUWVVjetOnJh9EYBUyPZeNCoOtsbFQwdXi4/esELcd+tq8cCHJ8UXp+viy9efLz7AgamjlKXc1AA1m83DoIRDlFubzeb96hhZLVTlgJ24gttutx+ONa50bHZKRenaeTs1OfpAfnr6yOOdE7EZdNwmlKocntXLNkA5JTGq47Ds+Lf94lWsyfnXleLfnIwJUN4DOnNYwuUxh2A3Ln9XULrfK8t3J27Tu3BVwiOjXJqoAy8UZej1yclGo3GTLN+gu3w+z/P3YaWbQqk3Ne12e4ZC+c8rxWsYytcPiP9RpZxCqWDKnxOiBNlyAUpOnGsoh4tA2Rm8X9xqtT6md5wyZmYe+0YRKL+1S/wYQ3n8zctBl5SBUv5djivfjMOPduIzcizeiYfr9foVvUwZG+XCuzibZKnSceZ5/v4QlKp8y7ElhnJlTeTP7BI/kllRYfzrfvHqFy4UX1vaL/aVlSmROzwbwdS29T2UcEwZF+V8ozM2lu1VY812u/15akypGh3TmFJesJbHHD167IdUxz3YJy5bNySuX1mbvy55CbMLtzU6tjGlsdFptVqfUMc0Go23F4wy1l2dSnbfvpMwVPe9WWVLDsrOJaF9MFu2Wq1PqmNkGce67xiXhTjdNwdlvV6/BgxfbPfBfVCetxi6b9/rlCup65QzM48dl2OjLMv26CibzeZ96sTIzEFdpwQXz9U1yrtVlpR/Zll2Fec65Y6l4pbbx8XHH9kknvzJlPjlHy8Tp29eKT5ou0aJoIT3w3dBlLDzVpfAJEZ1XOdaJZxnOSlvPMjPzxFljIvng914RwebsjYO7uhMyHu46sOfnf3Oz2TXDW6vvYxdFoIXz3Wc8J5zs9n8iOn2IrxTc2BM3Glqdp7dI553uaOjxrhwcob+MyuUpjs6WZZdon8OcigjPx8V+u+GTWFTSWEx3WYcdJ225jNDSE4q0GHCzlueHOyujn6bUWYgeb9ZZUaQPe+GzQ+Gc8+oOGhC+c1d4gfI16n3XDAhQ7+9qE9l01E2Go132GYKyXE1NiFDTcpoNpv3LOYJGWXNErJNW9sEp63p2RKiVPMn1bS1DgxsyhoGdGpmizj+xtXiDYnx7/vFmce3iWdW1cTVGEY4hQ2ZW0nNq8Qm/M6XbXm3S100lwGedFybuvNOibLI+ZS2ceU4eAxiEuvCkfmU8ycToDxETe6FgCBQHeqyAbFvfEhcO7BwDuXFCEbTZF840XeHK0jYcbs2OIGle0mVJ/mmnClEPQqxyTY5I8/zFhif7fSZee4bnrPOU4AssnRXHaVTCTd14dRDY3UbTIiSeFhsN/aMjgnqthFx880rxX3yATL5p3y4LPXzOaBkUyBjZMlYpbtQlIOBD475ZEusjMNSvkXe6VEoJVDkeZ2dzIfIFsRzU+JF2OyM9M9fTC/6SUYOyFQPjQ2nWiUjxnPfw5EeHqMWIqAeIFsAU847lJM2JM6xsewt1OIDLs99P7ZFHNdB/upS8XtPiD7PfLuCXJNolYyyFiNI/Zit65ItrOVafFbHcFohY7hPTN21Tjz4uc3iqfsnxKdX1MTl1OoYRFaMsToGB6Trw2JFP/OdZC2hJZ7ZkrMoAbbSGmelDJ91hFKuJeS7jlBMkJnrAqqJlgMUZS/dArPlGHNdSg5M3xXXtvquuEatvIYtDRhpxbUJuIgqsU5lGWtUploK0KuEU9mSW8YpmFQ556xNuYW7NiW13B+FkMiKHIy+C6eGgBxJvMR0oSv5hi6+z4HJyZoU0M2RVvDlrOQbcxVfX5AhZbuqy0v7ZstYMLHlAVlLTF9ALLbvu9Y5Zylpn/XOsd0ibIvxr2KCLHpp6SCUIdnSZSF+WzfOhem6GD+1KwR3Z4jNjrtDpNoZwmWd8yrupZN6Hx3fbMmFSe0Swdq2ZIPjxk1112Duo8OBGLrBkw/IoncdK2XHsdC9dHz204m50xh3tzFq1zFqtzHXrfCw7OgDsqyNnZLszVijsmXgrmNcmGtS78lIoMX2aJz03fKO2sDJddPQSCDPiQ1DfWBycY6XtXstc2PQKuxgG2McmXTPb9/9vmuJYXKyJrWjbeg+3xPM4O73nWqvbyw7xgZZSJbEUBa157cNJjdr2vb+5iA1YV3HxYscj30PDCEHIgcjtfm8K8hSsmRotkwFk5s1TTghUAopB6xrjHMBBkI0YYTZ0dZlxwLpkiWDULpmy5gwqayZgZNkA7oKQQCxctByYg0XIIEQQuRitGVHblMTA2ShKGPDpC6wu+DEgJqg2rDGDBtAF4Q6RAojp1xXGmSMbImVcR+YWNY04eQCtUG1ofUJ2/uvcETIgUhhdAE5GAlkKShjwHTNmhhODKgJqQ2sC14uOgyfD0IbRF+MlQaZAiZWyn2yJsTJATqGnHQO2Jhh+xlsACFCG0QbRtdyzQFZCZSxYPpmTS7Q5cjJHYNBYIkZpu99HoUQ/o4QIYSIZUZfjJ4ZMjZI32wZBDMU5yhy8pZTULl4XYP5fagMyEVoy4oupTpGduwnkloSlKEwY+AcQU4MhRTD6ovXBRwFzwWgCSEF0QVjJUGmgEllTS5OLlCIlIN1mS9mx/cZ5eLDALpCTI2RAhkTZQqYoTgpoCPECbaBHQ2ETL3PUl98ECAXYijG0OyYAmQoTG7W5ODkAF1CnVgm2JQx4okPA+gCMTbGskBGgRmaOblAh5GTORIrfKFx4VH4EIAxIXIxlg2SBbMvECY3e7oApbDaIgQu5/2HmeEKEINYiwSRi7EQkLFgumZOCuggctKGI4ULZN/vMeSLj0AYMytWEqMLzFg4fYDaoKaC6wvOFR4FkIPQFaILxrJAOsHsc/zlfYDWXE8qF22s8Pz5KHxcgEVALBtjJXBSSEOwFhk1Zgy4hitCT4hVw+gFs8/zwxqIBbUgyK7fcyA0PD9XX4iVxhiC0xdof6STWCsoBmKF7+cVCWFXQYyBMxRpf+STX1b0x45AhN0OMSrOGEirhrY/dfQAdjvS7oy+WCF6r1RIFxXWvlTRg1YVqFWBmxZbD99ig9pt0YPQw9rD1nstVri9V+/Ve3XrS/wfim4P5fIFxLoAAAAASUVORK5CYII=",Hi=function(){function e(e,t){var n=this;this.context=void 0,this.time=new D,this.htmlCanvas=void 0,this.gl=void 0,this.renderer=void 0,this.assetManager=void 0,this.input=void 0,this.disposed=!1,this.config=t,t.pathPrefix||(t.pathPrefix=""),t.app||(t.app={loadAssets:function(){},initialize:function(){},update:function(){},render:function(){},error:function(){},dispose:function(){}}),t.webglConfig||(t.webglConfig={alpha:!0}),this.htmlCanvas=e,this.context=new Wn(e,t.webglConfig),this.renderer=new Ni(e,this.context),this.gl=this.context.gl,this.assetManager=new Hn(this.context,t.pathPrefix),this.input=new li(e),t.app.loadAssets&&t.app.loadAssets(this);var i=function e(){n.disposed||(requestAnimationFrame(e),n.time.update(),t.app.update&&t.app.update(n,n.time.delta),t.app.render&&t.app.render(n))};requestAnimationFrame((function e(){n.disposed||(n.assetManager.isLoadingComplete()?n.assetManager.hasErrors()?t.app.error&&t.app.error(n,n.assetManager.getErrors()):(t.app.initialize&&t.app.initialize(n),i()):requestAnimationFrame(e))}))}var t=e.prototype;return t.clear=function(e,t,n,i){this.gl.clearColor(e,t,n,i),this.gl.clear(this.gl.COLOR_BUFFER_BIT)},t.dispose=function(){this.config.app.dispose&&this.config.app.dispose(this),this.disposed=!0},e}(),zi=Phaser.GameObjects.Components,Ki=zi.ComputedSize,Vi=zi.Depth,Xi=zi.Flip,ji=zi.ScrollFactor,qi=zi.Transform,Ji=zi.Visible,Qi=zi.Origin,$i=zi.Alpha;function er(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Phaser.Class.mixin(e,t),e}}var tr=er(Ki),nr=er(Vi),ir=er(Xi),rr=er(ji),ar=er(qi),sr=er(Ji),or=er(Qi),cr=er($i),hr=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,a.Z)(t,e),t}(Phaser.GameObjects.GameObject),ur=function(){function e(){}return e.prototype.calculateBounds=function(e){if(!e.skeleton)return{x:0,y:0,width:0,height:0};var t=new Lt(e.skeleton.data);t.setToSetupPose(),t.updateWorldTransform(2);var n=t.getBoundsRect();return n.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:n},e}(),lr=function(){function e(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=.05),this.animation=e,this.skins=t,this.timeStep=n}return e.prototype.calculateBounds=function(e){if(!e.skeleton||!e.animationState)return{x:0,y:0,width:0,height:0};var t=new Be(e.animationState.data),n=new Lt(e.skeleton.data),i=n.data;if(this.skins.length>0){for(var r,a=new Wt("custom-skin"),o=s(this.skins);!(r=o()).done;){var c=r.value,h=i.findSkin(c);null!=h&&a.addSkin(h)}n.setSkin(a)}n.setToSetupPose();var u=null!=this.animation?i.findAnimation(this.animation):null;if(null==u){n.updateWorldTransform(2);var l=n.getBoundsRect();return l.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:l}var d=Number.POSITIVE_INFINITY,p=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY;t.clearTracks(),t.setAnimationWith(0,u,!1);for(var g=Math.max(u.duration/this.timeStep,1),v=0;v<g;v++){var y=v>0?this.timeStep:0;t.update(y),t.apply(n),n.update(y),n.updateWorldTransform(2);var E=n.getBoundsRect();d=Math.min(d,E.x),p=Math.min(p,E.y),f=Math.max(f,d+E.width),m=Math.max(m,p+E.height)}var C={x:d,y:p,width:f-d,height:m-p};return C.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:C},e}(),dr=function(e){function t(t,n,i,r,a,s,o){var c;return void 0===o&&(o=new ur),(c=e.call(this,t,window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:E)||this).blendMode=-1,c.skeleton=void 0,c.animationStateData=void 0,c.animationState=void 0,c.beforeUpdateWorldTransforms=function(){},c.afterUpdateWorldTransforms=function(){},c.premultipliedAlpha=!1,c.plugin=n,c.boundsProvider=o,c.setPosition(i,r),c.premultipliedAlpha=c.plugin.isAtlasPremultiplied(s),c.skeleton=c.plugin.createSkeleton(a,s),c.animationStateData=new Ve(c.skeleton.data),c.animationState=new Be(c.animationStateData),c.skeleton.updateWorldTransform(2),c.updateSize(),c}(0,a.Z)(t,e);var n=t.prototype;return n.updateSize=function(){if(this.skeleton){var e=this.boundsProvider.calculateBounds(this);this.width=e.width,this.height=e.height,this.displayOriginX=-e.x,this.displayOriginY=-e.y}},n.skeletonToPhaserWorldCoordinates=function(e){var t=this.getWorldTransformMatrix(),n=t.a,i=t.b,r=t.c,a=t.d,s=t.tx,o=t.ty,c=e.x,h=e.y;e.x=c*n+h*r+s,e.y=c*i+h*a+o},n.phaserWorldCoordinatesToSkeleton=function(e){var t=this.getWorldTransformMatrix(),n=(t=t.invert()).a,i=t.b,r=t.c,a=t.d,s=t.tx,o=t.ty,c=e.x,h=e.y;e.x=c*n+h*r+s,e.y=c*i+h*a+o},n.phaserWorldCoordinatesToBone=function(e,t){this.phaserWorldCoordinatesToSkeleton(e),t.parent?t.parent.worldToLocal(e):t.worldToLocal(e)},n.updatePose=function(e){this.animationState.update(e/1e3),this.animationState.apply(this.skeleton),this.beforeUpdateWorldTransforms(this),this.skeleton.update(e/1e3),this.skeleton.updateWorldTransform(2),this.afterUpdateWorldTransforms(this)},n.preUpdate=function(e,t){this.skeleton&&this.animationState&&this.updatePose(t)},n.preDestroy=function(){},n.willRender=function(e){var t=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&e.id);if(this.visible||(t=!1),!t&&this.parentContainer&&this.plugin.webGLRenderer){var n=this.plugin.webGLRenderer;this.plugin.gl&&this.plugin.phaserRenderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&n.batcher.isDrawing&&(n.end(),this.plugin.phaserRenderer.pipelines.rebind())}return t},n.renderWebGL=function(e,t,n,i){if(this.skeleton&&this.animationState&&this.plugin.webGLRenderer){var r=this.plugin.webGLRenderer;e.newType&&(e.pipelines.clear(),r.begin()),n.addToRenderList(t);var a=Phaser.GameObjects.GetCalcMatrix(t,n,i).calc,s=a.a,o=a.b,c=a.c,h=a.d,u=a.tx,l=a.ty;r.drawSkeleton(this.skeleton,this.premultipliedAlpha,-1,-1,(function(e,t,n){for(var i=0;i<t;i+=n){var r=e[i],a=e[i+1];e[i]=r*s+a*c+u,e[i+1]=r*o+a*h+l}})),e.nextTypeMatch||(r.end(),e.pipelines.rebind())}},n.renderCanvas=function(e,t,n,i){if(this.skeleton&&this.animationState&&this.plugin.canvasRenderer){var r=e.currentContext,a=this.plugin.canvasRenderer;a.ctx=r,n.addToRenderList(t);var s=Phaser.GameObjects.GetCalcMatrix(t,n,i).calc,o=this.skeleton;o.x=s.tx,o.y=s.ty,o.scaleX=s.scaleX,o.scaleY=s.scaleY,o.getRootBone().rotation=-T.radiansToDegrees*s.rotationNormalized,this.skeleton.updateWorldTransform(2),r.save(),a.draw(o),r.restore()}},t}(nr(or(tr(ir(rr(ar(sr(cr(hr))))))))),pr=function(e){function t(t){return e.call(this,t)||this}(0,a.Z)(t,e);var n=t.prototype;return n.setFilters=function(e,t){},n.setWraps=function(e,t){},n.dispose=function(){},t}(qe),fr=I.newFloatArray(8),mr=function(){function e(e){this.ctx=void 0,this.triangleRendering=!1,this.debugRendering=!1,this.vertices=I.newFloatArray(8192),this.tempColor=new b,this.ctx=e}var t=e.prototype;return t.draw=function(e){this.triangleRendering?this.drawTriangles(e):this.drawImages(e)},t.drawImages=function(e){var t=this.ctx,n=this.tempColor,i=e.color,r=e.drawOrder;this.debugRendering&&(t.strokeStyle="green");for(var a=0,s=r.length;a<s;a++){var o=r[a],c=o.bone;if(c.active){var h=o.getAttachment();if(h instanceof ct){h.computeWorldVertices(o,fr,0,2);var u=h.region,l=u.texture.getImage(),d=o.color,p=h.color;n.set(i.r*d.r*p.r,i.g*d.g*p.g,i.b*d.b*p.b,i.a*d.a*p.a),t.save(),t.transform(c.a,c.c,c.b,c.d,c.worldX,c.worldY),t.translate(h.offset[0],h.offset[1]),t.rotate(h.rotation*Math.PI/180);var f=h.width/u.originalWidth;t.scale(f*h.scaleX,f*h.scaleY);var m=u.width,g=u.height;if(t.translate(m/2,g/2),90==h.region.degrees){var v=m;m=g,g=v,t.rotate(-Math.PI/2)}t.scale(1,-1),t.translate(-m/2,-g/2),t.globalAlpha=n.a,t.drawImage(l,l.width*u.u,l.height*u.v,m,g,0,0,m,g),this.debugRendering&&t.strokeRect(0,0,m,g),t.restore()}}}},t.drawTriangles=function(t){for(var n=this.ctx,i=this.tempColor,r=t.color,a=t.drawOrder,s=null,o=this.vertices,c=null,h=0,u=a.length;h<u;h++){var l=a[h],d=l.getAttachment(),p=void 0;if(d instanceof ct){var f=d;o=this.computeRegionVertices(l,f,!1),c=e.QUAD_TRIANGLES,p=f.region.texture.getImage()}else{if(!(d instanceof at))continue;var m=d;o=this.computeMeshVertices(l,m,!1),c=m.triangles,p=m.region.texture.getImage()}if(p){l.data.blendMode!=s&&(s=l.data.blendMode);var g=l.color,v=d.color;i.set(r.r*g.r*v.r,r.g*g.g*v.g,r.b*g.b*v.b,r.a*g.a*v.a),n.globalAlpha=i.a;for(var y=0;y<c.length;y+=3){var E=8*c[y],C=8*c[y+1],w=8*c[y+2],A=o[E],b=o[E+1],S=o[E+6],T=o[E+7],x=o[C],k=o[C+1],P=o[C+6],I=o[C+7],O=o[w],R=o[w+1],B=o[w+6],D=o[w+7];this.drawTriangle(p,A,b,S,T,x,k,P,I,O,R,B,D),this.debugRendering&&(n.strokeStyle="green",n.beginPath(),n.moveTo(A,b),n.lineTo(x,k),n.lineTo(O,R),n.lineTo(A,b),n.stroke())}}}this.ctx.globalAlpha=1},t.drawTriangle=function(e,t,n,i,r,a,s,o,c,h,u,l,d){var p=this.ctx,f=e.width-1,m=e.height-1;i*=f,r*=m,o*=f,c*=m,l*=f,d*=m,p.beginPath(),p.moveTo(t,n),p.lineTo(a,s),p.lineTo(h,u),p.closePath(),a-=t,s-=n,h-=t,u-=n;var g=(o-=i)*(d-=r)-(l-=i)*(c-=r);if(0!=g){var v=(d*a-c*h)*(g=1/g),y=(d*s-c*u)*g,E=(o*h-l*a)*g,C=(o*u-l*s)*g,w=t-v*i-E*r,A=n-y*i-C*r;p.save(),p.transform(v,y,E,C,w,A),p.clip(),p.drawImage(e,0,0),p.restore()}},t.computeRegionVertices=function(t,n,i){var r=t.bone.skeleton.color,a=t.color,s=n.color,o=r.a*a.a*s.a,c=i?o:1,h=this.tempColor;h.set(r.r*a.r*s.r*c,r.g*a.g*s.g*c,r.b*a.b*s.b*c,o),n.computeWorldVertices(t,this.vertices,0,e.VERTEX_SIZE);var u=this.vertices,l=n.uvs;return u[ct.C1R]=h.r,u[ct.C1G]=h.g,u[ct.C1B]=h.b,u[ct.C1A]=h.a,u[ct.U1]=l[0],u[ct.V1]=l[1],u[ct.C2R]=h.r,u[ct.C2G]=h.g,u[ct.C2B]=h.b,u[ct.C2A]=h.a,u[ct.U2]=l[2],u[ct.V2]=l[3],u[ct.C3R]=h.r,u[ct.C3G]=h.g,u[ct.C3B]=h.b,u[ct.C3A]=h.a,u[ct.U3]=l[4],u[ct.V3]=l[5],u[ct.C4R]=h.r,u[ct.C4G]=h.g,u[ct.C4B]=h.b,u[ct.C4A]=h.a,u[ct.U4]=l[6],u[ct.V4]=l[7],u},t.computeMeshVertices=function(t,n,i){var r=t.bone.skeleton.color,a=t.color,s=n.color,o=r.a*a.a*s.a,c=i?o:1,h=this.tempColor;h.set(r.r*a.r*s.r*c,r.g*a.g*s.g*c,r.b*a.b*s.b*c,o);var u=n.worldVerticesLength/2,l=this.vertices;l.length<n.worldVerticesLength&&(this.vertices=l=I.newFloatArray(n.worldVerticesLength)),n.computeWorldVertices(t,0,n.worldVerticesLength,l,0,e.VERTEX_SIZE);for(var d=n.uvs,p=0,f=0,m=2;p<u;p++)l[m++]=h.r,l[m++]=h.g,l[m++]=h.b,l[m++]=h.a,l[m++]=d[f++],l[m++]=d[f++],m+=2;return l},e}();d(mr,"QUAD_TRIANGLES",[0,1,2,2,3,0]),d(mr,"VERTEX_SIZE",8);var gr=function(e){function t(t,n,i){var a;(a=e.call(this,t,n,i)||this).game=void 0,a.isWebGL=void 0,a.gl=void 0,a.canvasRenderer=void 0,a.phaserRenderer=void 0,a.skeletonDataCache=void 0,a.atlasCache=void 0,a.game=n.game,a.isWebGL=2===a.game.config.renderType,a.gl=a.isWebGL?a.game.renderer.gl:null,a.phaserRenderer=a.game.renderer,a.canvasRenderer=null,a.skeletonDataCache=a.game.cache.addCustom("esotericsoftware.spine.skeletonFile.cache"),a.atlasCache=a.game.cache.addCustom("esotericsoftware.spine.atlas.cache");n.registerFileType("spineJson",(function(e,t,n){var i=new Er(this,e,t,yr.json,n);return this.addFile(i.files),this}),t);n.registerFileType("spineBinary",(function(e,t,n){var i=new Er(this,e,t,yr.binary,n);return this.addFile(i.files),this}),t);n.registerFileType("spineAtlas",(function(e,t,n,i){var r=new Cr(this,e,t,n,i);return this.addFile(r.files),this}),t);var s=(0,r.Z)(a);return n.registerGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:E,(function(e,t,n,i,r){var a=new dr(this.scene,s,e,t,n,i,r);return this.displayList.add(a),this.updateList.add(a),a}),(function(e,t){void 0===t&&(t=!1);var n=e.x?e.x:0,i=e.y?e.y:0,r=e.boundsProvider?e.boundsProvider:void 0,a=new dr(this.scene,s,n,i,e.dataKey,e.atlasKey,r);return void 0!==t&&(e.add=t),y.default.GameObjects.BuildGameObject(this.scene,a,e)})),a}(0,a.Z)(t,e);var n=t.prototype;return n.boot=function(){Lt.yDown=!0,this.isWebGL?(t.gameWebGLRenderer||(t.gameWebGLRenderer=new Ni(this.game.renderer.canvas,this.gl,!0)),this.onResize(),this.game.scale.on(y.default.Scale.Events.RESIZE,this.onResize,this)):this.canvasRenderer||(this.canvasRenderer=new mr(this.scene.sys.context));var e=this.systems.events;e.once("shutdown",this.shutdown,this),e.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)},n.onResize=function(){var e=this.game.renderer,t=this.webGLRenderer;if(e&&t){var n=e.width,i=e.height;t.camera.position.x=n/2,t.camera.position.y=i/2,t.camera.up.y=-1,t.camera.direction.z=1,t.camera.setViewport(n,i)}},n.shutdown=function(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(y.default.Scale.Events.RESIZE,this.onResize,this)},n.destroy=function(){this.shutdown()},n.gameDestroy=function(){this.pluginManager.removeGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:E,!0,!0),this.webGLRenderer&&this.webGLRenderer.dispose(),t.gameWebGLRenderer=null},n.getAtlas=function(e){var t;if(this.atlasCache.exists(e))t=this.atlasCache.get(e);else{var n=this.game.cache.text.get(e);if(t=new tt(n.data),this.isWebGL){var i=this.gl;Yn.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);for(var r,a=s(t.pages);!(r=a()).done;){var o=r.value;o.setTexture(new Yn(i,this.game.textures.get(e+"!"+o.name).getSourceImage(),!1))}}else for(var c,h=s(t.pages);!(c=h()).done;){var u=c.value;u.setTexture(new pr(this.game.textures.get(e+"!"+u.name).getSourceImage()))}this.atlasCache.add(e,t)}return t},n.isAtlasPremultiplied=function(e){var t=this.game.cache.text.get(e);return!!t&&t.premultipliedAlpha},n.getSkeletonData=function(e,t){var n,i=this.getAtlas(t),r=e+t;if(this.skeletonDataCache.exists(r))n=this.skeletonDataCache.get(r);else{if(this.game.cache.json.exists(e)){var a=this.game.cache.json.get(e);n=new _n(new pt(i)).readSkeletonData(a)}else{var s=this.game.cache.binary.get(e);n=new Kt(new pt(i)).readSkeletonData(new Uint8Array(s))}this.skeletonDataCache.add(r,n)}return n},n.createSkeleton=function(e,t){return new Lt(this.getSkeletonData(e,t))},(0,i.Z)(t,[{key:"webGLRenderer",get:function(){return t.gameWebGLRenderer}}]),t}(y.default.Plugins.ScenePlugin);d(gr,"gameWebGLRenderer",null),d(gr,"rendererId",0);var vr,yr=((vr=yr||{})[vr.json=0]="json",vr[vr.binary=1]="binary",vr),Er=function(e){function t(t,n,i,r,a){var s;if("string"!==typeof n){var o=n;n=o.key,i=o.url,r="spineJson"===o.type?0:1,a=o.xhrSettings}var c=null;return c=0==r?new y.default.Loader.FileTypes.JSONFile(t,{key:n,url:i,extension:"json",xhrSettings:a}):new y.default.Loader.FileTypes.BinaryFile(t,{key:n,url:i,extension:"skel",xhrSettings:a}),(s=e.call(this,t,"spineSkeletonData",n,[c])||this).fileType=r,s}(0,a.Z)(t,e);var n=t.prototype;return n.onFileComplete=function(e){this.pending--},n.addToCache=function(){this.isReadyToProcess()&&this.files[0].addToCache()},t}(y.default.Loader.MultiFile),Cr=function(e){function t(t,n,i,r,a){var s;if(void 0===r&&(r=!0),"string"!==typeof n){var o,c=n;n=c.key,i=c.url,r=null==(o=c.premultipliedAlpha)||o,a=c.xhrSettings}return(s=e.call(this,t,"spineAtlasData",n,[new y.default.Loader.FileTypes.TextFile(t,{key:n,url:i,xhrSettings:a,extension:"atlas"})])||this).premultipliedAlpha=r,s}(0,a.Z)(t,e);var n=t.prototype;return n.onFileComplete=function(e){if(-1!=this.files.indexOf(e)&&(this.pending--,"text"==e.type)){var t,n=e.data.split(/\r\n|\r|\n/),i=[];i.push(n[0]);for(var r=1;r<n.length;r++){var a=n[r];""===a.trim()&&r<n.length-1&&(a=n[r+1],i.push(a))}for(var s=null!=(t=e.src.match(/^.*\//))?t:"",o=0;o<i.length;o++){var c=s+i[o],h=e.key+"!"+i[o],u=new y.default.Loader.FileTypes.ImageFile(this.loader,h,c);this.loader.keyExists(u)||(this.addToMultiFile(u),this.loader.addFile(u))}}},n.addToCache=function(){if(this.isReadyToProcess())for(var e,t=this.loader.textureManager,n=s(this.files);!(e=n()).done;){var i=e.value;"image"==i.type?t.exists(i.key)||t.addImage(i.key,i.data):(i.data={data:i.data,premultipliedAlpha:this.premultipliedAlpha||i.data.indexOf("pma: true")>=0||i.data.indexOf("pma:true")>=0},i.addToCache())}},t}(y.default.Loader.MultiFile);return window.spine={SpinePlugin:gr},window["spine.SpinePlugin"]=gr,function(e){return l(t({},"__esModule",{value:!0}),e)}(p)}()},function(e,t,n){"use strict";var i=n(5),r=n(4),a=n.n(r),s=function(){function e(){this.isLandscape=void 0}var t=e.prototype;return t.init=function(){this.isLandscape=!1;var e=GameCore.Configs.Game,t=(e.PortraitRatio,e.DisableLandscape);this.isScreenSmallerRatio(1)?this.isLandscape=!1:t||(this.isLandscape=!0),this.isLandscape=!0},t.getScreenHeight=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,r=n.clientHeight;return Math.max(r,i)||0},t.getScreenWidth=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,r=n.clientWidth;return Math.max(r,i)||0},t.isScreenSmallerRatio=function(e){return this.getScreenWidth()/this.getScreenHeight()<e},e}(),o=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,r=n.clientHeight;return Math.max(r,i)||0},c=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,r=n.clientWidth;return Math.max(r,i)||0},h=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){!function t(){var n=c(),i=o();n>0&&i>0?e():requestAnimationFrame(t)}()}));case 2:window.GameCore.layoutInitializer=new s,window.GameCore.layoutInitializer.init();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=h,l=n(9),d=n(34),p=n(8),f=n(0),m=n(70),g=0,v=0,y=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;v=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(v)),v+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!v||v<30)&&(v=60),g=v;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(v)),v+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-v,n=Math.round(e*t+v);n>g&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),E=n(29);function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var A=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager,Phaser.GameObjects.NineSlice,SpinePlugin.SpineGameObject].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,SpinePlugin.SpineGameObject].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.customBitmapText=function(){Phaser.GameObjects.BitmapText.prototype.setLineHeight=function(e){this.lineHeight=e,this.updateDisplayOrigin()}},t.addSetDefaultWorldSize=function(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setDefaultWorldSize=function(){this.texture;var e=this.frame,t=e.width,n=e.height,i=1/GameCore.ImageScale,r=t*i,a=n*i;this.setWorldSize(r,a)}}))},t.addSetScaleByWorld=function(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setScaleByWorld=function(e,t){var n=1/GameCore.ImageScale;this.setScale(e*n,(t||e)*n),this.setWorldSize(this.displayWidth,this.displayHeight)}}))},t.customGameObject=function(){Phaser.GameObjects.GameObject.prototype.tweenLite=function(e){return this.scene.add.tween((0,p.Z)({targets:this},e))},Phaser.GameObjects.GameObject.prototype.tweenLiteAsync=function(e){var t=this;return new Promise((function(n){t.scene.add.tween((0,p.Z)({targets:t},e,{onComplete:function(){e.onComplete&&e.onComplete.apply(e,arguments),n(t)}}))}))}},t.addCustomNineSlice=function(){Phaser.GameObjects.NineSlice.prototype.setSlicesByWorld=this.setSlicesByWorld,Phaser.GameObjects.NineSlice.prototype.setSizeByWorld=this.setSizeByWorld},t.customTween=function(){Phaser.Tweens.Tween.prototype.waitForCompletion=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return n()})),t.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return n()}))}))},Phaser.Tweens.Tween.prototype.waitForLoops=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_LOOP,(function(){0==--e&&i()}))}))},Phaser.Tweens.Tween.prototype.waitForProgress=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_UPDATE,(function(){n.progress>=e&&i()}))}))},Phaser.Tweens.Tween.prototype.waitForTimeElapsed=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_UPDATE,(function(){n.totalElapsed>=e&&i()}))}))}},t.customTimeline=function(){Phaser.Tweens.Timeline.prototype.waitForCompletion=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(e){t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return e()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForCompletion=function(e){return void 0===e&&(e=!0),this.play(),this.waitForCompletion(e)},Phaser.Tweens.Timeline.prototype.waitForLoops=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),e<=0&&i(),n.on(Phaser.Tweens.Events.TIMELINE_LOOP,(function(){--e<=0&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForLoops=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForLoops(e,t)},Phaser.Tweens.Timeline.prototype.waitForPause=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return n()})),t.on(Phaser.Tweens.Events.TIMELINE_PAUSE,(function(){return n}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForPause=function(e){return void 0===e&&(e=!0),this.play(),this.waitForPause(e)},Phaser.Tweens.Timeline.prototype.waitForResume=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return n()})),t.on(Phaser.Tweens.Events.TIMELINE_RESUME,(function(){return n}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForResume=function(e){return void 0===e&&(e=!0),this.play(),this.waitForResume(e)},Phaser.Tweens.Timeline.prototype.waitForProgress=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TIMELINE_UPDATE,(function(){n.progress>=e&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForProgress=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForProgress(e,t)},Phaser.Tweens.Timeline.prototype.waitForTimeElapsed=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TIMELINE_UPDATE,(function(){n.totalElapsed>=e&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForTimeElapsed=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForTimeElapsed(e,t)}},t.customSpineGameObject=function(){SpinePlugin.SpineGameObject.prototype.setSkinCustom=this.setSkinCustom,SpinePlugin.SpineGameObject.prototype.setAttachmentCustom=this.setAttachmentCustom},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.setSlicesByWorld=function(e,t,n,i,r,a){var s=1/GameCore.ImageScale;return this.setScale(s),this.setSlices(e?e/s:void 0,t?t/s:void 0,n?n/s:void 0,i?i/s:void 0,r?r/s:void 0,a?a/s:void 0),this},t.setSizeByWorld=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=1/GameCore.ImageScale;return this.setSize(e/n,t/n),this},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,r=this.width,a=this.height,s=this.depth,o=this.originX,c=this.originY,h=this.scene.add.rectangle(n,i,r,a,e,t);h.setName("Debug Box"),h.setDepth(s);var u=GameCore.Utils.Valid.isNumber;return u(o)&&u(c)&&h.setOrigin(o,c),h},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},t.setSkinCustom=function(){var t=(0,i.Z)(a().mark((function t(n,i,r,s,o,c,h){var u,l,d,p,f,m,g,v,y,C,w,A;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===o&&(o=!1),void 0===c&&(c=0),void 0===h&&(h=0),u=n+"-"+i+"-"+r+"-"+s+"-"+c+"-"+h,void 0===(l=e.CUSTOM_SPINE_SKIN_CACHE[u])||o){t.next=9;break}return this.skeleton.setSkin(l),this.skeleton.setToSetupPose(),t.abrupt("return",l);case 9:if((d=this.scene.game.context)instanceof WebGLRenderingContext){t.next=12;break}return t.abrupt("return",null);case 12:if(null!==(p=this.skeleton.findSlot(r))){t.next=15;break}return t.abrupt("return",null);case 15:if(null!==(f=this.animationStateData.skeletonData.defaultSkin)){t.next=18;break}return t.abrupt("return",null);case 18:if(void 0!==(m=f.getAttachment(p.data.index,s))&&(m instanceof SpinePlugin.MeshAttachment||m instanceof SpinePlugin.RegionAttachment)){t.next=21;break}return t.abrupt("return",null);case 21:if(g=m.copy(),void 0!==(v=this.scene.textures.getFrame(n,i))){t.next=25;break}return t.abrupt("return",null);case 25:return c=Math.max(v.width,c),h=Math.max(v.height,h),t.next=29,(0,E.Z)(v,c,h);case 29:if(null!==(y=t.sent)){t.next=32;break}return t.abrupt("return",null);case 32:return C=new SpinePlugin.GLTexture(d,y),(w=new SpinePlugin.TextureRegion).degrees=0,w.width=c,w.height=h,w.offsetX=0,w.offsetY=0,w.originalWidth=c,w.originalHeight=h,w.u=0,w.u2=1,w.v=0,w.v2=1,w.texture=C,g.region=w,g.width=c,g.height=h,g.updateRegion(),(A=new SpinePlugin.Skin(i)).setAttachment(p.data.index,s,g),this.skeleton.setSkin(A),this.skeleton.setToSetupPose(),e.CUSTOM_SPINE_SKIN_CACHE[u]=A,t.abrupt("return",A);case 56:case"end":return t.stop()}}),t,this)})));return function(e,n,i,r,a,s,o){return t.apply(this,arguments)}}(),t.setAttachmentCustom=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],(i=this.scene.game.context)instanceof WebGLRenderingContext){e.next=4;break}return e.abrupt("return",null);case 4:r=a().mark((function e(){var t,r,s,o,u,l,d,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.value,r=t.textureKey+"-"+t.frameKey+"-"+t.slotName+"-"+t.attachmentName+"-"+t.targetWidth+"-"+t.targetHeight,n.push(r),s=h.skeleton.findSlot(t.slotName)){e.next=6;break}return e.abrupt("return",{v:null});case 6:if((o=s.getAttachment())&&(o instanceof SpinePlugin.MeshAttachment||o instanceof SpinePlugin.RegionAttachment)){e.next=9;break}return e.abrupt("return",{v:null});case 9:if(u=o.copy(),l=h.scene.textures.getFrame(t.textureKey,t.frameKey)){e.next=13;break}return e.abrupt("return",{v:null});case 13:return e.next=15,(0,E.Z)(l,t.targetWidth,t.targetHeight);case 15:if(d=e.sent){e.next=18;break}return e.abrupt("return",{v:null});case 18:p=new SpinePlugin.GLTexture(i,d),f=Object.assign(new SpinePlugin.TextureRegion,{degrees:0,width:t.targetWidth,height:t.targetHeight,originalWidth:t.targetWidth,originalHeight:t.targetHeight,offsetX:t.offsetX,offsetY:t.offsetY,u:0,u2:1,v:0,v2:1,texture:p}),u.name=t.attachmentName,u.path=t.attachmentName,u.region=f,u.width=t.targetWidth,u.height=t.targetHeight,u.updateRegion(),m=s.data.index,h.skeleton.slots.map((function(e){e.data.name===t.slotName&&e.data.index===m&&e.setAttachment(u)}));case 28:case"end":return e.stop()}}),e)})),o=C(t);case 6:if((c=o()).done){e.next=13;break}return e.delegateYield(r(),"t0",8);case 8:if(!(s=e.t0)){e.next=11;break}return e.abrupt("return",s.v);case 11:e.next=6;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();A.CUSTOM_SPINE_SKIN_CACHE={};var b=A,S=[{url:"./assets/images/others/mock1.jpg",title:"Buy lottery tickets on behalf",description:"\ud83d\udca5\ud83d\udca5\ud83d\udca5 Place an order for lottery tickets from 3 regions!!! \u2705 Fast - Convenient - Safe \u2705 Diverse products \u2705 Payment...",buttonName:"Discover more"},{url:"./assets/images/others/mock2.jpg",title:"SYSTEM-WIDE SALE UP TO 50%",description:'\ud83d\udd25 \ud835\uddec\ud835\uddd8\ud835\uddd4\ud835\udde5 \ud835\uddd8\ud835\udde1\ud835\uddd7 \ud835\udde6\ud835\uddd4\ud835\udddf\ud835\uddd8 | \ud835\udde8\ud835\udde3 \ud835\udde7\ud835\udde2 \ud835\udff1\ud835\udfec% "BIG PARTY" AUTHENTIC SPORTSWEAR SHOCKINGLY REDUCED PRICES! \ud83c\udf81 From...',buttonName:"Discover more"},{url:"./assets/images/others/mock3.jpg",title:"Register now",description:"Play safe, play fun, play 9club!",buttonName:"Register"}],T=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentIdx=(this.currentIdx+1)%S.length,this.hideBannerAdAsync(),e.next=4,new Promise((function(e){setTimeout((function(){e()}),2e3)}));case 4:if(!document.getElementById("mock-banner-ads")){e.next=16;break}return t=S[this.currentIdx],n=t.url,i=t.buttonName,r=t.title,s=t.description,(o=document.getElementById("banner-content-text1"))&&(o.innerHTML=r),(c=document.getElementById("banner-content-text2"))&&(c.innerHTML=s),(h=document.getElementById("mock-banner-ads-avatar"))&&(h.style.background="url("+n+") center center/contain no-repeat"),(u=document.getElementById("banner-content-button"))&&(u.innerHTML=i),e.abrupt("return");case 16:l=GameCore.Utils.Device.isDesktop(),50,l?this.createDesktopBannerAd(50):this.createMobileBannerAd(50);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.createDesktopBannerAd=function(e){var t=this,n=S[this.currentIdx],i=n.url,r=n.buttonName,a=n.title,s=n.description,o=document.createElement("div");o.id="mock-banner-ads",o.style.width="100%",o.style.height=e+"px",o.style.bottom="var(--sab)",o.style.display="flex",o.style.position="absolute",o.style.opacity=this.currentOpacity;var c=document.createElement("div");c.id="mock-banner-ads-display-area",c.style.width="100%",c.style.height="100%",c.style.background="#323436 center center/auto no-repeat",c.style.borderRadius="10px",c.style.marginLeft="4px",c.style.marginRight="4px",c.style.display="block",c.style.alignContent="center";var h=document.createElement("div");h.id="mock-banner-ads-content",h.style.boxSizing="border-box",h.style.flexDirection="row",h.style.display="flex",h.style.position="relative",h.style.alignItems="stretch",h.style.paddingLeft="4px",h.style.paddingRight="4px",h.style.justifyContent="space-between";var u=document.createElement("div");u.id="mock-banner-ads-avatar",u.style.marginLeft="10px",u.style.width=e+"px",u.style.minWidth=e+"px",u.style.height=e+"px",u.style.display="flex",u.style.flexDirection="column",u.style.position="relative",u.style.background="url("+i+") center center/contain no-repeat",u.style.borderRadius="50%";var l=document.createElement("div");l.id="mock-banner-ads-right-content",l.style.width="100%",l.style.paddingLeft="10px",l.style.display="flex",l.style.flexDirection="row",l.style.position="relative",l.style.color="#E4E6EB",l.style.wordWrap="break-word",l.style.textAlign="left",l.style.alignContent="center",l.style.alignItems="center",l.style.fontSize="12px",l.style.fontFamily="Helvetica, Arial, sans-serif, Roboto, Helvetica, Arial, sans-serif",u.style.boxSizing="border-box";var d=document.createElement("div");d.style.flexDirection="column",d.style.display="flex",d.style.justifyContent="center",d.style.flexShrink="1",d.style.flexGrow="1",d.style.flexBasis="0",d.style.boxSizing="border-box",d.style.minWidth="0",d.innerHTML="\n            <div id='banner-content-text1' style=\"font-weight:600;line-height: 1.3333;font-size: .9375rem;text-overflow: ellipsis;-webkit-line-clamp: 1;white-space: nowrap;overflow: hidden;\">"+a+"</div>\n            <div id='banner-content-text2' style=\"font-weight:400;line-height: 1.2308;font-size: .8125rem;text-overflow: ellipsis;-webkit-line-clamp: 2;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+s+"</div>";var p=document.createElement("button");p.id="banner-content-button",p.type="button",p.style.width="120px",p.style.height=e-20+"px",p.style.fontWeight="600",p.style.backgroundColor="#3963fc",p.style.border="none",p.style.color="white",p.style.borderRadius="5px",p.style.textAlign="center",p.style.display="inline-block",p.style.cursor="pointer",p.style.marginRight="10px",p.style.marginLeft="10px",p.style.flexShrink="1",p.style.boxSizing="border-box",p.style.paddingRight="2px",p.style.paddingLeft="2px",p.innerHTML=r,p.onclick=function(){"0.2"===t.currentOpacity?o.style.opacity="1":o.style.opacity="0.2",t.currentOpacity=o.style.opacity};var f=document.createElement("button");f.type="button",f.style.width=e-20+"px",f.style.height=e-20+"px",f.style.fontWeight="1000",f.style.backgroundColor="#5a5c5c",f.style.border="none",f.style.color="white",f.style.borderRadius="50%",f.style.textAlign="center",f.style.display="inline-block",f.style.cursor="pointer",f.style.marginRight="10px",f.style.marginLeft="10px",f.style.flexShrink="0",f.style.boxSizing="border-box",f.style.paddingRight="2px",f.style.paddingLeft="2px",f.innerHTML="...",document.body.appendChild(o),o.appendChild(c),c.appendChild(h),h.appendChild(u),h.appendChild(l),l.appendChild(d),l.appendChild(p),l.appendChild(f)},e.createMobileBannerAd=function(e){var t=this,n=S[this.currentIdx],i=n.url,r=n.buttonName,a=n.title,s=n.description,o=document.createElement("div");o.id="mock-banner-ads",o.style.width="100%",o.style.height=e+"px",o.style.bottom="var(--sab)",o.style.display="block",o.style.position="absolute",o.style.opacity=this.currentOpacity;var c=document.createElement("div");c.id="mock-banner-ads-display-area",c.style.background="#ffffff center center/auto no-repeat",c.style.display="block",c.style.alignContent="center";var h=document.createElement("div");h.id="mock-banner-ads-content",h.style.boxSizing="border-box",h.style.flexDirection="row",h.style.display="flex",h.style.position="relative",h.style.alignItems="stretch",h.style.justifyContent="space-between";var u=document.createElement("div");u.id="mock-banner-ads-avatar",u.style.width=e+"px",u.style.minWidth=e+"px",u.style.height=e+"px",u.style.display="flex",u.style.flexDirection="column",u.style.position="relative",u.style.background="url("+i+") center center/contain no-repeat";var l=document.createElement("div");l.id="mock-banner-ads-right-content",l.style.width="100%",l.style.paddingLeft="10px",l.style.display="flex",l.style.flexDirection="row",l.style.position="relative",l.style.color="#000",l.style.wordWrap="break-word",l.style.textAlign="left",l.style.alignContent="center",l.style.alignItems="center",l.style.fontSize="12px",l.style.fontFamily="Helvetica, Arial, sans-serif, Roboto, Helvetica, Arial, sans-serif",u.style.boxSizing="border-box";var d=document.createElement("div");d.style.flexDirection="column",d.style.display="flex",d.style.justifyContent="center",d.style.flexShrink="1",d.style.flexGrow="1",d.style.flexBasis="0",d.style.boxSizing="border-box",d.style.minWidth="0",d.innerHTML="\n            <div id='banner-content-text1' style=\"font-weight:600;line-height: 1.3333;font-size: .9375rem;text-overflow: ellipsis;-webkit-line-clamp: 1;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+a+"</div>\n            <div id='banner-content-text2' style=\"font-weight:400;line-height: 1.2308;font-size: .8125rem;text-overflow: ellipsis;-webkit-line-clamp: 1;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+s+"</div>";var p=document.createElement("button");p.id="banner-content-button",p.type="button",p.style.height="100%",p.style.fontWeight="600",p.style.backgroundColor="#3963fc",p.style.border="none",p.style.color="white",p.style.textAlign="center",p.style.display="inline-block",p.style.cursor="pointer",p.style.marginLeft="10px",p.style.flexShrink="1",p.style.boxSizing="border-box",p.style.paddingRight="2px",p.style.paddingLeft="2px",p.innerHTML=r,p.onclick=function(){"0.2"===t.currentOpacity?o.style.opacity="1":o.style.opacity="0.2",t.currentOpacity=o.style.opacity},document.body.appendChild(o),o.appendChild(c),c.appendChild(h),h.appendChild(u),h.appendChild(l),l.appendChild(d),l.appendChild(p)},e.hideBannerAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("mock-banner-ads")){e.next=3;break}return e.abrupt("return");case 3:t.remove();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}();T.currentIdx=-1,T.currentOpacity="1";var x={LOADED:"loaded",DISPLAYED:"displayed"},k=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(k||{}),P=k,I=function(e){return e.REWARDED="rewarded",e.PRE_ROLL="pre-roll",e.INTERSTITIAL="interstitial",e.BANNER="banner",e}(I||{}),O=I,R=n(36),B=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),D=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=P.IDLE};function L(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}GameCore.Ads={Types:O,Status:P,Events:x,AdError:B,AdInstance:D};var _=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.enabled=void 0,t.config=void 0,t.lastInterAdShownTime=void 0,t.lastInterAdLoadedTime=void 0,t.lastRewardAdShownTime=void 0,t.interstitial=void 0,t.rewardedVideo=void 0,t.preRoll=void 0,t.fallbackInterstitial=void 0,t.fallbackRewardedVideo=void 0,t.fallbackPreRoll=void 0,t.safeAreaBottom=void 0,t.showingBannerAd=void 0,t.reloadBannerAdIntervals=void 0,t.bannerAdConfigs=void 0,t.isHaveBannerAdOptions=void 0,t.isFallbackReady=void 0,t.isFallbackInitialized=void 0,t.isBannerAdsShown=void 0,t.bannerPosition=void 0,t.bannerAdLoaded=void 0,t.isInterstitialRemoved=!1,t.daysRemoveAdsLeft=0,t.adInProcessFlag=!1,t}(0,f.Z)(t,e);var r=t.prototype;return r.init=function(){this.events=new Phaser.Events.EventEmitter,GameCore.Utils.Device.isMobile(),this.bannerPosition="bottom",this.safeAreaBottom=0,this.lastInterAdShownTime=0,this.lastInterAdLoadedTime=0,this.lastRewardAdShownTime=0,this.showingBannerAd={},this.reloadBannerAdIntervals={},this.bannerAdConfigs=[],this.isHaveBannerAdOptions=!0,this.isFallbackReady=!1,this.isFallbackInitialized=!1,this.isBannerAdsShown=!1},r.getBannerPosition=function(){return this.bannerPosition},r.calculateSafeAreaBottom=function(){try{if(!this.config.calculateSafeAreaBottom)return;this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},r.configure=function(e,t){this.enabled=t.enabled,this.config=t,this.setAdInstance(e),this.setBannerAdConfigStatus(),this.calculateSafeAreaBottom()},r.setBannerAdConfigStatus=function(){for(var e,t=this.config.bannerAdOptions,n=GameCore.Utils.Device.isDesktop(),i=L(t);!(e=i()).done;){var r=e.value,a=r.platform,s="ALL"==a||"DESKTOP"==a&&n||"MOBILE"==a&&!n;this.bannerAdConfigs.push({config:r,canShow:s}),s&&(this.isHaveBannerAdOptions=!0)}},r.setAdInstance=function(e){var t=this.config,n=t.rewardAdOptions,i=t.interstitialAdOptions;this.interstitial=new e(O.INTERSTITIAL,i.pID),this.rewardedVideo=new e(O.REWARDED,n.pID),this.preRoll=new e(O.PRE_ROLL,i.pID)},r.setFallbackAdInstance=function(e){var t=this.config,n=t.rewardAdOptions,i=t.interstitialAdOptions;this.fallbackInterstitial=new e(O.INTERSTITIAL,i.pID),this.fallbackRewardedVideo=new e(O.REWARDED,n.pID),this.fallbackPreRoll=new e(O.PRE_ROLL,i.pID)},r.preloadInterstitialAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(O.INTERSTITIAL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.showInterstitialAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAdByTime()){e.next=2;break}throw new B("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(O.INTERSTITIAL);case 4:this.lastInterAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.preloadPreRollAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(O.PRE_ROLL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.showPreRollAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showAdAsync(O.PRE_ROLL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.preloadRewardedVideoAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(O.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.showRewardedVideoAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowRewardAd()){e.next=2;break}throw new B("REWARDED_VIDEO_CAN_NOT_SHOW","Can't show rewarded video");case 2:return e.next=4,this.showAdAsync(O.REWARDED);case 4:this.lastRewardAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getRemainingRewardTime=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions.secondsBetweenAds,n=e-this.lastRewardAdShownTime;return n<t?t-n:0},r.preloadAdAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new B("ADS_NOT_ENABLED","Ads is't enabled");case 2:return e.next=4,this.preloadMainAdService(t);case 4:if(!0!==(n=e.sent)){e.next=7;break}return e.abrupt("return");case 7:if(this.isFallbackReady){e.next=9;break}throw n;case 9:return e.next=11,this.preloadFallbackAdService(t);case 11:if(!0!==(i=e.sent)){e.next=14;break}return e.abrupt("return");case 14:throw i;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.preloadMainAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.preloadAdInstanceAsync(e,!1).then((function(){i=!0})).catch((function(e){t.isFallbackReady||t.initFallbackAdsService().catch((function(){t.isFallbackReady=!1})),i=e})).finally((function(){n(i)}))}))},r.preloadFallbackAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.isFallbackReady||n(new B("FALLBACK_NOT_READY","Fallback ads not ready")),t.preloadAdInstanceAsync(e,!0).then((function(){i=!0})).catch((function(e){i=e})).finally((function(){n(i)}))}))},r.preloadAdInstanceAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),null!==(i=this.getAdInstanceByType(t,n))){e.next=4;break}throw new B("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 4:if(i.getStatus()!==P.LOADING){e.next=8;break}return e.next=7,new Promise((function(e){r.events.once(x.LOADED,e)}));case 7:return e.abrupt("return");case 8:return t!==O.INTERSTITIAL&&t!==O.PRE_ROLL||(this.lastInterAdLoadedTime=window.performance.now()/1e3),e.next=11,i.loadAsync();case 11:this.events.emit(x.LOADED,t);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.showAdAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new B("ADS_NOT_ENABLED","Ads is't enabled");case 2:return e.next=4,this.showMainAdService(t);case 4:if(!0!==(n=e.sent)){e.next=7;break}return e.abrupt("return");case 7:if(!this.isUserCancelledAdError(n)&&this.isAdFallbackReadyToShow(t)){e.next=9;break}throw n;case 9:return e.next=11,this.showFallbackAdService(t);case 11:if(!0!==(i=e.sent)){e.next=14;break}return e.abrupt("return");case 14:throw i;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.showMainAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.showAdInstanceAsync(e,!1).then((function(){i=!0})).catch((function(e){i=e,t.isUserCancelledAdError(e)||t.isFallbackReady||t.initFallbackAdsService().catch((function(){t.isFallbackReady=!1}))})).finally((function(){n(i)}))}))},r.showFallbackAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.isFallbackReady||n(new B("FALLBACK_NOT_READY","Fallback ads not ready")),t.showAdInstanceAsync(e,!0).then((function(){i=!0})).catch((function(e){i=e})).finally((function(){n(i)}))}))},r.showAdInstanceAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),null!==(i=this.getAdInstanceByType(t,n))){e.next=4;break}throw new B("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 4:return t!==O.INTERSTITIAL&&t!==O.PRE_ROLL||(this.lastInterAdShownTime=window.performance.now()/1e3),t===O.REWARDED&&(this.lastRewardAdShownTime=window.performance.now()/1e3,this.config.enableRewardVideoResetInterstitial&&(this.lastInterAdShownTime=this.lastRewardAdShownTime)),e.next=8,i.showAsync();case 8:this.events.emit(x.DISPLAYED,t);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},r.getAdInstanceByType=function(e,t){if(void 0===t&&(t=!1),t)switch(e){case O.INTERSTITIAL:return this.fallbackInterstitial;case O.REWARDED:return this.fallbackRewardedVideo;case O.PRE_ROLL:return this.fallbackPreRoll;default:return null}switch(e){case O.INTERSTITIAL:return this.interstitial;case O.REWARDED:return this.rewardedVideo;case O.PRE_ROLL:return this.preRoll;default:return null}},r.canbeShowInterstitialAd=function(){var e=this.game.level.getLevel(),t=this.canbeShowInterstitialAdByTime();return!(e<GameCore.Configs.Ads.LevelRequired.Interstitial)&&t},r.canbeLoadInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,r=Math.floor(e-this.lastInterAdLoadedTime);return this.lastInterAdLoadedTime>0?r>=i:r>=n},r.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,r=Math.floor(e-this.lastInterAdShownTime);return this.lastInterAdShownTime>0?r>=i:r>=n},r.canbeShowRewardAd=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,r=Math.floor(e-this.lastRewardAdShownTime);return this.lastRewardAdShownTime>0?r>=i:r>=n},r.getEnabledBannerAds=function(){if(!this.isHaveBannerAdOptions)return[];for(var e,t=[],n=L(this.bannerAdConfigs);!(e=n()).done;){var i=e.value,r=i.config;i.canShow&&t.push(r)}return t},r.disableBannerAds=function(){this.config.bannerAdOptions=[]},r.showBannerAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(!this.isBannerAdsShown){e.next=5;break}return e.next=5,this.hideBannerAdAsync();case 5:if(0!==(t=this.getEnabledBannerAds()).length){e.next=8;break}return e.abrupt("return");case 8:return this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},this.loadBannerAdAsync("",t),e.abrupt("return");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.loadBannerAdAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(i=this.getSceneName(),r=GameCore.Configs.Ads,e.prev=4,"msgames"===r.AdService){e.next=7;break}throw new B("BANNER_ADS_NOT_SUPPORTED","Banner ads not supported");case 7:if(!r.Mockup.Enable){e.next=13;break}return e.next=10,T.loadBannerAdAsync();case 10:this.game.world.setBannerDisplaying(!0),e.next=16;break;case 13:return e.next=15,GameSDK.loadBannerAdAsync(t,n);case 15:this.game.world.setBannerDisplaying(!0);case 16:this.isBannerAdsShown=!0,n.forEach((function(e){var t=e.placementId,n=e.position,a=e.bannerWidth,o=e.bannerHeight;if(t&&""!==t){var c=n+":"+a+"x"+o;s.showingBannerAd[t]=!0,window.game.analytics.showBannerAd(c,i,r.AdService)}})),e.next=27;break;case 20:e.prev=20,e.t0=e.catch(4),this.isBannerAdsShown=!1,n.forEach((function(e){var t=e.position+":"+e.bannerWidth+"x"+e.bannerHeight,n={type:O.BANNER,placement:i,bannerPosition:t,adService:r.AdService};window.game.analytics.showAdFail(n)})),this.game.world.setBannerDisplaying(!1),this.bannerAdLoaded=!1;case 27:this.bannerAdLoaded||(this.game.world.setBannerDisplaying(!0),this.bannerAdLoaded=!0);case 28:case"end":return e.stop()}}),e,this,[[4,20]])})));return function(t,n){return e.apply(this,arguments)}}(),r.hideBannerAdAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(this.isHaveBannerAdOptions){e.next=4;break}return e.abrupt("return");case 4:if(this.isBannerAdsShown=!1,e.prev=5,"msgames"===(t=GameCore.Configs.Ads).AdService){e.next=9;break}throw new B("BANNER_ADS_NOT_SUPPORTED","Banner ads not supported");case 9:if(!t.Mockup.Enable){e.next=15;break}return e.next=12,T.hideBannerAdAsync();case 12:this.game.world.setBannerDisplaying(!1),e.next=18;break;case 15:return e.next=17,GameSDK.hideBannerAdAsync();case 17:this.game.world.setBannerDisplaying(!1);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5);case 23:case"end":return e.stop()}}),e,this,[[5,20]])})));return function(){return e.apply(this,arguments)}}(),r.getBannerHeight=function(){if(!this.enabled||this.isInterstitialRemoved)return 0;if(!this.isBannerAdsShown)return 0;var e=this.getBottomBannerConfig();if(!e)return 0;var t=e.bannerHeight,n=(void 0===t?0:t)+this.safeAreaBottom+20;if(this.game.world){var i=this.game.world,r=i.getPixelRatio(),a=i.getZoomRatio();return this.game.world.getPhysicPixels(n,r/a)}return n},r.getBottomBannerConfig=function(){var e=this.getEnabledBannerAds();return 0===e.length?null:e.find((function(e){return"bottom"===e.position}))||null},r.getSceneName=function(){try{var e=self.game.globalScene;return this.globalSceneTypeCheck(e)?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},r.globalSceneTypeCheck=function(e){return"getCurrentScene"in e&&"function"===typeof e.getCurrentScene},r.initFallbackAdsService=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,!this.isFallbackInitialized){e.next=3;break}return e.abrupt("return");case 3:return this.isFallbackInitialized=!0,e.next=6,this.getFallbackAdServiceInstance();case 6:n=e.sent,"none"!==t.FallbackService&&null!==n&&(this.isFallbackReady=!0,this.setFallbackAdInstance(n));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getFallbackAdServiceInstance=function(){var e=(0,i.Z)(a().mark((function e(){var t,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=GameCore.Configs.Ads.FallbackService,e.next=3,Promise.resolve().then(n.bind(n,67));case 3:if(i=e.sent.default,"google"!==t){e.next=16;break}return e.prev=5,e.next=8,this.initGoogleAdInstanceAsync();case 8:if(null===(r=e.sent)){e.next=11;break}return e.abrupt("return",r);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5);case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}(),r.initGoogleAdInstanceAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t,i,r,s,o,c,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads.AdServiceConfigs.Google){e.next=3;break}return e.abrupt("return",null);case 3:return i=t.DataAdChannel,r=t.DataAdClient,s=t.DataAdHost,o=t.DataAdBreakTest,c=t.DataAdFrequencyHint,h=t.MaxScriptLoadRetryCount,e.next=6,Promise.resolve().then(n.bind(n,68));case 6:if("loaded"!==(u=e.sent.default).initStatus){e.next=9;break}return e.abrupt("return",u);case 9:return l={dataAdClient:r,dataAdChannel:i,dataAdHost:s,dataAdBreakTest:o,dataAdFrequencyHint:c,maxScriptLoadRetryCount:h},e.prev=10,u.setGame(this.game),e.next=14,u.initGoogleAdsAsync(l);case 14:return e.abrupt("return",u);case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,this,[[10,17]])})));return function(){return e.apply(this,arguments)}}(),r.isUserCancelledAdError=function(e){if(e instanceof B&&"USER_INPUT"===e.code)return!0;try{var t=JSON.parse(JSON.stringify(e));return"code"in t&&"USER_INPUT"===t.code}catch(e){return!1}},r.isAdFallbackReadyToShow=function(e){if(!this.isFallbackReady)return!1;var t=this.getAdInstanceByType(e,!0);return!!t&&t.getStatus()===P.FILLED},r.setDisabledInterstitialAds=function(e){this.isInterstitialRemoved=!0,this.daysRemoveAdsLeft=e,this.hideBannerAdAsync()},r.isDisabledInterstitialAds=function(){return this.isInterstitialRemoved},r.getDaysRemoveAdsLeft=function(){return this.daysRemoveAdsLeft},r.setAdInProcess=function(e){this.adInProcessFlag=e},r.isAdInProcess=function(){return this.adInProcessFlag},t}(Phaser.Plugins.BasePlugin),N=_,G=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog},t.levelStart=function(e,t,n){this.processLevelStart(e,t,n),this.selfLog},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog},t.levelRescue=function(e,t,n){this.processLevelRescue(e,t,n),this.selfLog},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog},t.loadPreRollAd=function(e,t){this.processLoadPreRollAd(e,t),this.selfLog},t.showPreRollAd=function(e,t){this.processShowPreRollAd(e,t),this.selfLog},t.loadInterstitialAd=function(e,t){this.processLoadInterstitialAd(e,t),this.selfLog},t.showInterstitialAd=function(e,t){this.processShowInterstitialAd(e,t),this.selfLog},t.loadRewardedVideoAd=function(e,t){this.processLoadRewardedVideoAd(e,t),this.selfLog},t.showRewardedVideoAd=function(e,t){this.processShowRewardedVideoAd(e,t),this.selfLog},t.showBannerAd=function(e,t,n){this.processShowBannerAd(e,t,n),this.selfLog},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog},t.loadAdFail=function(e){this.processLoadAdFail(e),this.selfLog},t.showAdFail=function(e){this.processShowAdFail(e),this.selfLog},t.viewItemList=function(e,t,n){this.processViewItemList(e,t,n),this.selfLog},t.selectItem=function(e,t,n){this.processSelectItem(e,t,n),this.selfLog},t.viewItem=function(e,t,n){this.processViewItem(e,t,n),this.selfLog},t.beginCheckout=function(e,t,n){this.processBeginCheckout(e,t,n),this.selfLog},t.purchase=function(e,t,n,i){this.processPurchase(e,t,n,i),this.selfLog},t.purchaseCancel=function(e,t){this.processPurchaseCancel(e,t),this.selfLog},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},t.processLevelStart=function(e,t,n){},t.processLevelFail=function(e,t,n){},t.processLevelRescue=function(e,t,n){},t.processLevelComplete=function(e,t,n){},t.processLoadInterstitialAd=function(e,t){},t.processShowInterstitialAd=function(e,t){},t.processLoadPreRollAd=function(e,t){},t.processShowPreRollAd=function(e,t){},t.processLoadRewardedVideoAd=function(e,t){},t.processShowRewardedVideoAd=function(e,t){},t.processShowBannerAd=function(e,t,n){},t.processReceiveReward=function(e){},t.processLoadAdFail=function(e){},t.processShowAdFail=function(e){},e}(),F=G;GameCore.Analytics={BaseAnalytics:F};var Z=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).analytics=void 0,t.pageview=function(e){t.isActive()&&t.analytics.forEach((function(t){t.pageview(e)}))},t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(e,t,n)}))},n.levelRescue=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(e,t,n)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.loadPreRollAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadPreRollAd(e,t)}))},n.showPreRollAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showPreRollAd(e,t)}))},n.loadInterstitialAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadInterstitialAd(e,t)}))},n.showInterstitialAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showInterstitialAd(e,t)}))},n.loadRewardedVideoAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadRewardedVideoAd(e,t)}))},n.showRewardedVideoAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showRewardedVideoAd(e,t)}))},n.showBannerAd=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showBannerAd(e,t,n)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.loadAdFail=function(e){this.isActive()&&this.analytics.forEach((function(t){t.loadAdFail(e)}))},n.showAdFail=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showAdFail(e)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),U=Z,W=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.lastConfig=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isPlaying=function(e){var n=t.audios.get(e);return!!n&&n.isPlaying},this.game=e,this.audios=new Map,this.lastConfig={key:"",volume:0}}var t=e.prototype;return t.play=function(e,t){""===e&&(e=this.lastConfig.key),this.lastConfig=(0,p.Z)({key:e,volume:this.volume},t||{}),this.lastConfig.volume!==this.volume&&(this.lastConfig.volume*=this.volume);var n=this.audios.get(e);if(!n&&this.game.cache.audio.exists(e)){var i=this.game.sound.add(e);this.audios.set(e,i),n=i}n&&n.play(void 0,this.lastConfig)},t.setMusicKey=function(e){this.lastConfig.key=e},t.getMusicKey=function(){return this.lastConfig.key},t.pauseAll=function(){this.audios.forEach((function(e){e.pause()}))},t.resumeAll=function(){this.isMusicEnabled()&&this.audios.forEach((function(e){e.resume()}))},t.stopAll=function(){this.audios.forEach((function(e){e.stop()}))},t.pause=function(e){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&t.pause()},t.resume=function(e){if(this.isMusicEnabled()){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&t.resume()}},t.stop=function(e){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&(t.stop(),this.lastConfig={key:"",volume:this.volume})},t.setVolume=function(e){this.volume=e;var t=this.audios.get(this.lastConfig.key);t&&t.setVolume(e)},e}(),Y=W,H=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.soundKeys=void 0,this.audioSpriteKeys=void 0,this.markers=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!t.game.player.getPlayerSetting("sound")},this.game=e,this.markers={},this.audios=new Map,this.audioSpriteKeys=[],this.soundKeys=new Map}var t=e.prototype;return t.addSoundKeys=function(e){var t=this;Object.keys(e).forEach((function(n){var i=e[n];"string"===typeof i&&t.soundKeys.set(n,i)}))},t.createMaker=function(e,t){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(t),this.audioSpriteKeys.push(e)}catch(n){}},t.clearSoundKeys=function(){this.soundKeys.clear()},t.play=function(e,t){var n=this,i=(0,p.Z)({volume:this.volume},t||{});i.volume!==this.volume&&(i.volume*=this.volume);var r=this.audios.get(e);if(!r&&this.game.cache.audio.exists(e)){var a=this.game.sound.add(e);this.audios.set(e,a),r=a}if(r)r.play(void 0,i);else{var s=this.soundKeys.get(e);if(s)try{this.game.globalScene.load.audio(e,s),this.game.globalScene.load.on(Phaser.Loader.Events.FILE_KEY_COMPLETE+"audio-"+e,(function(){var t=n.game.sound.add(e);n.audios.set(e,t),t.play(void 0,i)})),this.game.globalScene.load.start()}catch(o){}}},t.playAudioSprite=function(e,t,n,i){var r,a,s=(0,p.Z)({volume:this.volume},n||{});(s.volume!==this.volume&&(s.volume*=this.volume),i)?(this.createMaker(t,e),null==(r=this.markers[t])||r.play(t,n)):(this.createMaker(e,e),null==(a=this.markers[e])||a.play(t,n))},t.pauseAll=function(){var e=this;this.audios.forEach((function(e){e.pause()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.pause()}))},t.resumeAll=function(){var e=this;this.game.player.getPlayerSetting("sound")&&(this.audios.forEach((function(e){e.resume()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.resume()})))},t.stopAll=function(){var e=this;this.audios.forEach((function(e){e.stop()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.stop()}))},t.pause=function(e){var t=this.audios.get(e);t&&t.pause()},t.stop=function(e){var t=this.audios.get(e);t&&t.stop()},t.setVolume=function(e){this.volume=e},e}(),z=H,K=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).soundManager=void 0,t.isMuteAll=void 0,t.musicVolume=void 0,t.musicManager=void 0,t.initMusic=function(){t.musicManager=new Y(t.game),t.setMusicVolume(t.musicVolume)},t.initSound=function(){t.soundManager=new z(t.game),t.setSoundVolume(1)},t.isMusicEnabled=function(){return t.musicManager.isMusicEnabled()},t.isSoundEnabled=function(){return t.soundManager.isSoundEnabled()},t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),this.musicVolume=1,this.initSound(),this.initMusic()},n.importSoundEffectKeys=function(e){this.soundManager.addSoundKeys(e)},n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.playAudioSprite=function(e,t,n,i){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.playAudioSprite(e,t,n,i)}catch(r){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e,t){void 0===e&&(e=""),void 0===t&&(t={});try{if(!this.musicManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play(e,(0,p.Z)({loop:!0,volume:this.musicManager.volume},t))}catch(n){}},n.isMusicPlaying=function(e){try{return!!this.musicManager&&this.musicManager.isPlaying(e)}catch(t){return!1}},n.setMusicKey=function(e){try{if(!this.musicManager)return;this.musicManager.setMusicKey(e)}catch(t){}},n.getMusicKey=function(){try{return this.musicManager?this.musicManager.getMusicKey():""}catch(e){return""}},n.pauseAllMusics=function(){try{if(!this.musicManager)return;this.musicManager.pauseAll()}catch(e){}},n.pauseMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.pause(e)}catch(t){}},n.resumeMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.resume(e)}catch(t){}},n.stopMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.stop(e)}catch(t){}},n.pauseAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.pauseAll()}catch(e){}},n.resumeAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.resumeAll()}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){}},n.setMusicVolume=function(e){try{this.musicManager?this.musicManager.setVolume(e):this.musicVolume=e}catch(t){}},n.getMusicVolume=function(){return this.musicManager?this.musicManager.volume:this.musicVolume},n.getSoundVolume=function(){return this.soundManager.volume},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),V=K,X=n(2),j="AUTH_TOKEN_REQUEST",q="AUTH_TOKEN_RECEIVED",J=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Q=n(43),$="auth",ee=(0,Q.P1)([function(e){return e[$].token}],(function(e){return e})),te=(0,Q.P1)([function(e){return e[$].isRequesting}],(function(e){return e})),ne=function(e){return{type:q,payload:{token:e}}},ie=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,r=n(),s=ee(r),!te(r)&&""===s){e.next=7;break}return e.abrupt("return");case 7:return t({type:j,payload:{}}),e.next=10,i.getPlayerToken();case 10:o=e.sent,t(ne(o)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(ne("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,l.tO)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,l.tO)(new J);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return ee(this.state)},(0,X.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),re=ie,ae=n(6),se=n(37),oe=n(38),ce=new se.Z("10","Your Friend",oe.Z.AVATAR.FILE).toObject(),he=["1","2","3","4","5","6","7","8","9","10","11","12"],ue=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),le=n(46),de=n(45),pe=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),fe=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),me=n(35),ge=GameCore.Configs,ve=ge.AppId,ye=ge.Network,Ee=function(e){if(!e.ok)throw new pe(null,{response:e})},Ce=function(){var e=window.game.auth.getToken();return{token:e,timeout:ye.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},we=function(e,t,n,r){return(0,i.Z)(a().mark((function i(){var s,o,c,h,u;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,s=e+"/apps/"+ve+"/"+t,o=new AbortController,n.signal=o.signal,c=setTimeout((function(){o.abort()}),n.timeout),GameCore.Utils.Valid.isObject(r)&&(n.body=JSON.stringify(r)),i.next=8,fetch(s,n);case 8:return h=i.sent,clearTimeout(c),Ee(h),i.next=13,h.json();case 13:if(i.t0=i.sent,i.t0){i.next=16;break}i.t0={};case 16:return u=i.t0,i.abrupt("return",u);case 20:if(i.prev=20,i.t1=i.catch(0),!(i.t1 instanceof pe)){i.next=24;break}return i.abrupt("return",null);case 24:if(!(i.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(i.t1,"name"))){i.next=27;break}if("AbortError"!==i.t1.name){i.next=27;break}throw new fe(null);case 27:throw i.t1;case 28:case"end":return i.stop()}}),i,null,[[0,20]])})))},Ae=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof fe&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,me.qZ)(600);case 10:return e.next=12,Ae(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof fe)){e.next=20;break}return e.abrupt("return",{});case 20:return e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),be=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===r&&(r=ye.Retries),e.prev=2,s=(0,p.Z)({},Ce(),n,{method:"GET"}),o=we(i,t,s),e.next=7,Ae(o,r);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,r){return e.apply(this,arguments)}}(),Se=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s){var o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i={}),void 0===s&&(s=ye.Retries),e.prev=2,o=(0,p.Z)({},Ce(),i,{method:"POST"}),c=we(r,t,o,n),e.next=7,Ae(c,s);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,r,a){return e.apply(this,arguments)}}(),Te="global",xe="friend",ke=GameCore.Configs,Pe=ke.ApiHost,Ie=ke.OtherHost,Oe=ke.LeadersBoard,Re=Oe.Prefix,Be=Oe.LeaderboardId,De=Oe.Name,Le=Re+"/"+Be+"/leaders",Me=Re+"/"+Be+"/players",_e=function(e){var t="";return Be?(e===Te?t=Le:e===xe&&(t=Me),t):t},Ne=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.playerId})),i=GameCore.Utils.Object.keyBy(t,"playerId"),r=GameCore.Utils.String.params({playerIds:n}),e.next=5,be("players?"+r,{},Pe);case 5:return s=e.sent,o=s.data.map((function(e){var t=i[e.playerId];return(0,p.Z)({},e,{score:t.score,rank:t.rank,getScore:function(){return t.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return t.rank},getExtraData:function(){return t.extraData},getPlayer:function(){return{getName:function(){return e.name},getPhoto:function(){return e.photo},getID:function(){return e.playerId}}}})})),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return i="leaderboards/"+t+"/ranks/"+n,e.next=5,be(""+i,{},Ie);case 5:if((r=e.sent)&&(null==r||!r.error)){e.next=8;break}return e.abrupt("return",null);case 8:if(r.data&&null!=r.data.score&&null!=r.data.rank){e.next=10;break}return e.abrupt("return",{rank:-1,score:-1});case 10:return e.abrupt("return",{rank:(null==r?void 0:r.data.rank)+1,score:null==r?void 0:r.data.score});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==Be){e.next=3;break}return e.abrupt("return",Ze(t));case 3:return e.abrupt("return",Ue(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=_e(Te)){e.next=5;break}return e.abrupt("return",n);case 5:return r=GameCore.Utils.String.params(t),e.next=8,be(i+"?"+r,{},Ie);case 8:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=o,e.abrupt("return",Ne(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,r=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(De);case 4:return s=e.sent,e.next=7,s.getEntriesAsync(i,r);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==Be){e.next=3;break}return e.abrupt("return",Ye(t));case 3:return e.abrupt("return",He(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=_e(xe)){e.next=5;break}return e.abrupt("return",n);case 5:return r=GameCore.Utils.String.params(t),e.next=8,be(i+"?"+r,{},Ie);case 8:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=o,e.abrupt("return",Ne(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),He=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,r=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(De);case 4:return s=e.sent,e.next=7,s.getConnectedPlayerEntriesAsync(i,r);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==Be){e.next=2;break}return e.abrupt("return",ze(t));case 2:return e.abrupt("return",Ke());case 3:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=_e(xe)){e.next=6;break}return e.abrupt("return",n);case 6:return r=GameCore.Utils.String.params({playerIds:t}),e.next=9,be(i+"?"+r,{},Ie);case 9:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return e.next=15,Ne(o);case 15:return n=e.sent[0],e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ke=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(De);case 2:return t=e.sent,e.next=5,t.getPlayerEntryAsync();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.GameSDK.submitGameResultsAsync(n).catch((function(e){})),null==Be){e.next=5;break}if(""!==window.game.auth.getToken()){e.next=4;break}return e.abrupt("return",Promise.reject("Not logged in"));case 4:return e.abrupt("return",Xe(t,n));case 5:return e.abrupt("return",je(n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xe=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se("leaderboards/"+Be+"/players/"+t,{score:n},{},Ie);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),je=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(De);case 2:return n=e.sent,e.next=5,n.setScoreAsync(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Je="share_invite",Qe="challenge_friend_match",$e="match",et=function(e){return e[$e]},tt=(0,Q.P1)([function(e){return et(e).gameplay.mode}],(function(e){return e})),nt=((0,Q.P1)([function(e){return et(e).gameplay.status}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).gameplay.rescued}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).gameplay.startAt}],(function(e){return e}))),it=(0,Q.P1)([function(e){return et(e).gameplay.finishAt}],(function(e){return e})),rt=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LeaderboardNotFound",i.message=t||"Leaderboard not found",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),at=GameCore.Configs,st=at.AppId,ot=at.OtherHost,ct=at.ApiHost,ht=at.LeadersBoard,ut=(at.Tournament,at.WeeklyTournament),lt=(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={appId:st,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!ht.UseMock){e.next=5;break}return e.next=4,(0,me.qZ)(1e3);case 4:return e.abrupt("return",(0,p.Z)({},n,t,{_id:ht.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",e.next=8,Se("leaderboards",(0,p.Z)({},n,t),{},ot);case 8:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!ut.UseLeaderboardMock||ut.LeaderboardMockId){e.next=4;break}for(i=0;i<t.length;i++)r={gold:Math.floor(2*Math.random()),silver:Math.floor(2*Math.random()),bronze:Math.floor(2*Math.random())},n.push({playerId:t[i],achievement:r});return e.abrupt("return",n);case 4:return"players",s=GameCore.Utils.String.params({playerIds:t}),e.next=8,be("players?"+s,{},ct);case 8:if((o=e.sent)&&(null==o||!o.error)){e.next=12;break}return e.abrupt("return",n);case 12:if(!((c=(null==o?void 0:o.data)||[]).length<1)){e.next=15;break}return e.abrupt("return",n);case 15:for(h=0;h<c.length;h++)l=c[h],d=(null==(u=l.customFields)||null==(u=u.weeklyTournament)?void 0:u.achievement)||void 0,p=l.playerId,n.push({playerId:p,achievement:d});return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),dt=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],s=GameCore.Utils.String.params({start:n,stop:i}),o="leaderboards/"+t+"/ranges?"+s,e.next=5,be(""+o,{},ot);case 5:if((c=e.sent)&&(null==c||!c.error)){e.next=9;break}return e.abrupt("return",[]);case 9:if(!((h=(null==c?void 0:c.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",r);case 12:return r=h,e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),pt=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l,d,p,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),void 0===i&&(i=!1),t){e.next=4;break}return e.abrupt("return",[]);case 4:if(r=[],!i){e.next=10;break}return e.next=8,(0,me.qZ)(1e3);case 8:return o=(s=n).limit,c=void 0===o?10:o,h=s.offset,u=void 0===h?0:h,e.abrupt("return",new Array(c).fill(null).map((function(e,t){var n=(t+1)*(u+1),i=ht.MockOptions.PlayerEntryIndex===t,r={playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())};if(i){var a=window.game.player.getPlayer(),s=a.playerId,o=a.name,c=a.photo;r.playerId=s,r.name=o,r.photo=c}return r})));case 10:return l=GameCore.Utils.String.params(n),d="leaderboards/"+t+"/leaders",e.next=14,be(d+"?"+l,{},ot);case 14:if((p=e.sent)&&(null==p||!p.error)){e.next=18;break}return e.abrupt("return",[]);case 18:if(!((f=(null==p?void 0:p.data)||[]).length<1)){e.next=21;break}return e.abrupt("return",r);case 21:return r=f,e.abrupt("return",r);case 23:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),ft=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se("leaderboards/"+t+"/players/"+n,{score:i},{},ot);case 2:return r=e.sent,e.abrupt("return",(null==r?void 0:r.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),mt=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ut.UseLeaderboardMock){e.next=7;break}return e.next=3,(0,me.qZ)(1e3);case 3:return 4,0,t=Math.round((6048e5+(new Date).getTime())/1e3),e.abrupt("return",new Array(4).fill(null).map((function(e,n){var i=1*(n+1);return{id:""+i,title:""+("Who's the winner?\nCome and play now! "+i),endTime:t,contextID:"context: "+i,payload:{playerId:"",playerName:"",leaderboardId:"1234"+i}}})));case 7:return n=GameCore.Utils.String.params({limit:100,type:"world_tournament_leaderboard"}),"leaderboards",e.next=11,be("leaderboards?"+n,{},ot);case 11:if((i=e.sent)&&(null==i||!i.error)){e.next=14;break}throw new rt;case 14:r=(null==i?void 0:i.data)||[],s=[],o=0;case 17:if(!(o<r.length)){e.next=28;break}if(""!=r[o].description){e.next=20;break}return e.abrupt("continue",25);case 20:c=JSON.parse(r[o].description),h=new Date(r[o].createdAt).getTime(),u=Math.round(604800+h/1e3),l={id:c.tournamentID,title:r[o].name,endTime:u,contextID:c.contextID,payload:{playerId:"",playerName:"",leaderboardId:r[o]._id}},s.push(l);case 25:o++,e.next=17;break;case 28:return e.abrupt("return",s);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gt="TOURNAMENT_ACTIVE",vt="TOURNAMENT_REQUEST",yt="TOURNAMENT_RECEIVED";function Et(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}GameCore.Configs.Tournament.UseLeaderboard;var wt=function(e,t){return void 0===t&&(t=""),{type:gt,payload:{tournamentId:e,leaderboardId:t}}},At=function(e){return(0,i.Z)(a().mark((function t(){var n,i,r,s,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.facebook,i=e.playerId,r=e.playerName,s=e.score,o={score:s,data:{type:"tournament",playerId:i,playerName:r}},t.next=5,n.tournament.shareAsync(o);case 5:case"end":return t.stop()}}),t)})))},bt=(function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:if(n=e.sent,null!=(i=JSON.parse(n.getPayload()||"{}")).leaderboardId){e.next=21;break}return e.next=9,mt();case 9:r=e.sent,s=n.getContextID(),o={payload:{}},c=Et(r);case 13:if((h=c()).done){e.next=20;break}if((u=h.value).contextID!==s){e.next=18;break}return o=u,e.abrupt("return",o.payload.leaderboardId);case 18:e.next=13;break;case 20:return e.abrupt("return",o.payload.leaderboardId||"");case 21:return e.abrupt("return",i.leaderboardId);case 24:return e.prev=24,e.t0=e.catch(0),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})))}(),function(e,t){return void 0===t&&(t=!0),function(){var n=(0,i.Z)(a().mark((function n(i,r){var s,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game.globalScene,o=r(),tt(o),i({type:vt,payload:{}}),t&&s.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),n.next=7,Pt(e,o);case 7:t&&s.screen.close(de.o4.NOTIFY_SCREEN),i(Rt(e));case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}),St=0,Tt=!1,xt=0,kt=!1,Pt=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game,r=i.player,s=i.facebook,o=r.getPlayer(),c=o.playerId,h=o.name,e.prev=2,u=window.game.scene.getScene(le.C.GAME_SCENE),l=u.weeklyTournament.getPlayerWeeklyTournamentData().leaderboardId,!Ot()){e.next=16;break}return e.next=8,s.getTournamentAsync();case 8:return St+=1,d={playerId:c,playerName:h,score:t,leaderboardId:l},e.next=12,window.game.storage.dispatch(At(d)).then((function(){Tt=!0}));case 12:window.game.weeklyTournament.logTournamentShare(),Tt=!0,e.next=17;break;case 16:s.getTournamentAsync().then((function(){s.tournament.postScoreAsync(t)}));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2);case 22:return e.prev=22,e.finish(22);case 24:case"end":return e.stop()}}),e,null,[[2,19,22,24]])})));return function(t,n){return e.apply(this,arguments)}}(),It=function(e,t){return!window.game.player.getPlayerIsNew()&&e>t||!(kt||xt>1)&&Math.random()<.5},Ot=function(){return!(Tt||St>3)&&Math.random()<1/(St||1)},Rt=(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,r=n.facebook,s=i.getBestScore(),e.prev=2,e.next=5,r.getTournamentAsync();case 5:if(!Ot()){e.next=12;break}return St+=1,e.next=9,r.tournament.shareAsync({score:t});case 9:Tt=!0,e.next=14;break;case 12:return e.next=14,r.tournament.postScoreAsync(t);case 14:e.next=24;break;case 16:if(e.prev=16,e.t0=e.catch(2),"TOURNAMENT_NOT_FOUND"!==e.t0.code){e.next=24;break}if(It(t,s)){e.next=21;break}return e.abrupt("return");case 21:return xt+=1,e.next=24,r.createTournamentAsync(t).then((function(){kt=!0})).catch((function(e){}));case 24:case"end":return e.stop()}}),e,null,[[2,16]])})))}(),function(e){return{type:yt,payload:{score:e}}}),Bt=n(42),Dt="single",Lt="challenge-friends",Mt="matching-group",_t="tournaments",Nt=(0,Q.P1)([function(e){return e.context}],(function(e){return e})),Gt=(0,Q.P1)([function(e){return e.context.currentGameMode}],(function(e){return e})),Ft=function(e,t){return{type:Bt.fJ,payload:{contextId:e,contextType:t}}},Zt=function(e){return function(t){t({type:Bt.EH,payload:{gameMode:e}}),(0,l.sw)("game-mode",e)}},Ut="MATCH_GAMEPLAY_INITIALIZE",Wt="MATCH_GAMEPLAY_START",Yt="MATCH_GAMEPLAY_FINISH",Ht="MATCH_GAMEPLAY_UPDATE",zt="MATCH_STATS_DATA_CLEAR",Kt="MATCH_STATS_DATA_UPDATE",Vt="MATCH_STATS_CURRENT_UPDATE",Xt="MATCH_SINGLE_CREATE_REQUEST",jt="MATCH_SINGLE_DETAIL_REQUEST",qt="MATCH_SINGLE_DATA_RECEIVED",Jt="MATCH_SINGLE_DATA_CLEAR",Qt="MATCH_CHALLENGE_JOIN_REQUEST",$t="MATCH_CHALLENGE_CREATE_REQUEST",en="MATCH_CHALLENGE_FINISH_REQUEST",tn="MATCH_CHALLENGE_CONTINUE_REQUEST",nn="MATCH_CHALLENGE_DATA_RECEIVED",rn="MATCH_CHALLENGE_DATA_CLEAR",an="MATCH_GROUP_CREATE_REQUEST",sn="MATCH_GROUP_FINISH_REQUEST",on="MATCH_ONLINE_CREATE_REQUEST",cn="MATCH_ONLINE_DATA_RECEIVED",hn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchId",i.message=t||"Invalid match id",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),un=function(e,t){return t.playerId},ln=function(e){return et(e).match.challenge},dn=((0,Q.P1)([function(e){return et(e).match.isRequesting}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.single}],(function(e){return e}))),pn=(0,Q.P1)([function(e){return et(e).match.single._id}],(function(e){return e})),fn=(0,Q.P1)([function(e){return et(e).match.single.score}],(function(e){return e||0})),mn=((0,Q.P1)([function(e){return et(e).match.single.level}],(function(e){return e||0})),(0,Q.P1)([function(e){var t;return null==(t=et(e).match.single.data)?void 0:t.diamond}],(function(e){return e||0})),(0,Q.P1)([function(e){var t;return null==(t=et(e).match.single.data)?void 0:t.fen}],(function(e){return e||null})),(0,Q.P1)([function(e){return et(e).match.single.status}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.single.playerId}],(function(e){return e})),(0,Q.P1)([ln],(function(e){return e}))),gn=(0,Q.P1)([function(e){return et(e).match.challenge._id}],(function(e){return e})),vn=(0,Q.P1)([function(e){return et(e).match.challenge.status}],(function(e){return e})),yn=(0,Q.P1)([function(e){return et(e).match.challenge.opponentInfo}],(function(e){return e})),En=((0,Q.P1)([function(e){return et(e).match.challenge.whitePlayerId}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.challenge.blackPlayerId}],(function(e){return e})),(0,Q.P1)([mn,un],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n!==t&&i===t?n:i!==t&&n===t?i:""})),(0,Q.P1)([mn,un],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n===t?n:i===t?i:ce.playerId}))),Cn=(0,Q.P1)([mn,un],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,r=e.whitePlayerFinish,a=e.blackPlayerFinish;return t&&n===t?r:!(!t||i!==t)&&a})),wn=(0,Q.P1)([mn,function(e,t){return t.opponentId}],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,r=e.whitePlayerFinish,a=e.blackPlayerFinish;return t&&n===t?r:!(!t||i!==t)&&a})),An=((0,Q.P1)([ln],(function(e){return e.extraData})),(0,Q.P1)([function(e){return et(e).match.group.opponentInfo}],(function(e){return e}))),bn=((0,Q.P1)([function(e){return et(e).match.online.players}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.journey}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.journey._id}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.journey.level}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).match.challenge.matchResultFromMessage}],(function(e){return e})),(0,Q.P1)([function(e){return et(e).stats.data}],(function(e){return e}))),Sn=(0,Q.P1)([function(e){return et(e).stats.current}],(function(e){return e})),Tn=((0,Q.P1)([function(e){return et(e).stats.isRequesting}],(function(e){return e})),n(12)),xn=function(e){try{var t=localStorage.getItem(e);return null===t?null:GameCore.Utils.Json.decode(t)}catch(n){return null}},kn=function(e,t){try{var n=xn(e),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var r=GameCore.Utils.Json.clone(t);if(!GameCore.Utils.Valid.isObject(r))return!1;var a=GameCore.Utils.Object.clear(r),s=(0,Tn.TS)(i,a),o=GameCore.Utils.Json.encode(s);return localStorage.setItem(e,o),!0}catch(c){return!1}},Pn=GameCore.Configs.ApiHost,In=(function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches",e.next=3,Se("single-matches",t,{},Pn);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches/active",e.next=3,be("single-matches/active",{},Pn);case 3:return t=e.sent,e.abrupt("return",(null==t?void 0:t.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="single-matches/"+t+"/move",e.next=3,Se(i,n,{},Pn);case 3:return r=e.sent,e.abrupt("return",(null==r?void 0:r.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="single-matches/"+t+"/finish",e.next=3,Se(n,{},{},Pn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"matches",e.next=3,Se("matches",{opponentPlayerId:t,extraData:n},{},Pn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),On=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t+"/join",e.next=3,Se(n,{},{},Pn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Rn=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t,e.next=3,be(n,{},Pn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bn=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="matches/"+t+"/finish",e.next=3,Se(s,{matchId:t,score:n,level:i,extraData:r},{},Pn);case 3:return o=e.sent,e.abrupt("return",(null==o?void 0:o.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),Dn="open",Ln="active",Mn="finished",_n=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchStatus",i.message=t||"The match status is not valid",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Nn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"Invalid opponent id",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Gn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Fn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidBlackPlayerId",i.message=t||"Invalid black player id",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Zn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidRequestedMatchId",i.message=t||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Un=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidWhitePlayerId",i.message=t||"Invalid white player id",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Wn=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new hn(null,{matchId:t});if(""===n||"string"!==typeof n)throw new hn(null,{currentMatchId:n});if(t!==n)throw new Zn(null,{matchId:t,currentMatchId:n})},Yn=function(e){var t=e.playerId,n=e.match,i=n._id,r=n.playerId,a=n.status;if(""===i||"string"!==typeof i)throw new hn(null,{matchId:i});if("finished"===a||"string"!==typeof a)throw new _n("This match is finished",{status:a});if(r!==t)throw new Gn(null,{playerId:r,currentPlayerId:t})},Hn=function(e){var t=e.opponentId;if(""===t||"string"!==typeof t)throw new Nn(null,{opponentId:t})},zn=function(e){var t=e.matchId;if(""===t||"string"!==typeof t)throw new hn(null,{matchId:t})},Kn=function(e){var t=e.match,n=t._id,i=t.whitePlayerId,r=t.blackPlayerId;if(""===n||"string"!==typeof n)throw new hn(null,{matchId:n});if(""===i||"string"!==typeof i)throw new Un(null,{whitePlayerId:i});if(""===r||"string"!==typeof r)throw new Fn(null,{blackPlayerId:r})},Vn=GameCore.Configs.Match,Xn=function(e){try{return GameCore.Utils.Hash.stringToHash(JSON.stringify(e))}catch(t){return""}},jn=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},qn=function(){return function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=window.game,i=n.player,n.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:"112Loading...",loading:!0}),t({type:Xt,payload:{}}),r=i.getPlayerId(),s=(0,p.Z)({},Vn.LocalSingleMatchDefault,{status:"active",playerId:r,startedAt:Date.now()}),Yn({playerId:r,match:s}),t(Qn(s)),kn(Vn.SingleMatchStore,s),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(0),t(Qn(null)),!(e.t0 instanceof hn)){e.next=16;break}return e.abrupt("return");case 16:if(!(e.t0 instanceof _n)){e.next=18;break}return e.abrupt("return");case 18:(0,l.tO)(e.t0);case 19:return e.prev=19,window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[0,11,19,22]])})));return function(t){return e.apply(this,arguments)}}()},Jn=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n,i){var r,s,o,c,h,u,d,f;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=window.game.player,zn({matchId:e}),s=i(),o=pn(s),c=r.getPlayerId(),Wn({matchId:e,currentMatchId:o}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:e}}),h=dn(s),Yn({playerId:c,match:h}),u=(0,p.Z)({},Vn.LocalSingleMatchDefault,h,{_id:e,status:"finished",playerId:c,finishAt:Date.now()}),n(Qn(u)),d=u.data,(f=(0,p.Z)({},u)).data=Xn(d),kn(Vn.SingleMatchStore,f),t.next=26;break;case 18:if(t.prev=18,t.t0=t.catch(0),n(Qn(null)),!(t.t0 instanceof hn)){t.next=23;break}return t.abrupt("return");case 23:if(!(t.t0 instanceof _n)){t.next=25;break}return t.abrupt("return");case 25:(0,l.tO)(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,n){return t.apply(this,arguments)}}()},Qn=function(e){return{type:qt,payload:{match:e}}},$n=function(){return{type:Jt,payload:{}}},ei=function(e,t,n){return function(){var r=(0,i.Z)(a().mark((function i(r){var s,o,c,h,u;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,s=window.game,o=s.profile,c=s.globalScene,n&&c.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),h=e.playerId,Hn({opponentId:h}),r({type:$t,payload:{opponentInfo:e,extraData:t}}),i.next=8,In(h,t);case 8:return u=i.sent,Kn({match:u}),i.next=12,o.requestProfiles([h]);case 12:r(ri(u)),i.next=23;break;case 15:if(i.prev=15,i.t0=i.catch(0),r(ri(null)),!(i.t0 instanceof hn)){i.next=20;break}return i.abrupt("return");case 20:if(!(i.t0 instanceof Nn)){i.next=22;break}return i.abrupt("return");case 22:(0,l.tO)(i.t0);case 23:return i.prev=23,n&&window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN),i.finish(23);case 26:case"end":return i.stop()}}),i,null,[[0,15,23,26]])})));return function(e){return r.apply(this,arguments)}}()},ti=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s,o,c,h,u,d,p;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,r=i.player,s=i.profile,i.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),zn({matchId:e}),n({type:Qt,payload:{matchId:e}}),t.next=7,On(e);case 7:if(o=t.sent,Kn({match:o}),c=o.status,h=o.whitePlayerId,u=o.blackPlayerId,c!==Ln){t.next=16;break}return d=r.getPlayerId(),p=d===h?u:h,t.next=16,s.requestProfiles([p]);case 16:n(ri(o)),t.next=25;break;case 19:if(t.prev=19,t.t0=t.catch(0),n(ri(null)),!(t.t0 instanceof hn)){t.next=24;break}return t.abrupt("return");case 24:(0,l.tO)(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}()},ni=function(e,t){return function(){var n=(0,i.Z)(a().mark((function n(i){var r,s,o,c,h,u,d,p,f;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=window.game,s=r.player,r.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),zn({matchId:e}),i({type:tn,payload:{matchId:e,opponentInfo:t}}),n.next=7,Rn(e);case 7:o=n.sent,Kn({match:o}),c=o.whitePlayerId,h=o.whitePlayerScore,u=o.blackPlayerScore,d=s.getPlayerId(),p=s.getPlayerData(),f=p.score,i(ri(o,{score:d===c?h:u,bestScore:f})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(ri(null)),!(n.t0 instanceof hn)){n.next=22;break}return n.abrupt("return");case 22:(0,l.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(e){return n.apply(this,arguments)}}()},ii=function(e,t,n){return function(){var r=(0,i.Z)(a().mark((function i(r){var s,o;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,zn({matchId:e}),r({type:en,payload:{matchId:e,score:t,extraData:n}}),s=n.level,i.next=6,Bn(e,t,s,n);case 6:return o=i.sent,Kn({match:o}),i.next=10,r(ri(o));case 10:i.next=18;break;case 12:if(i.prev=12,i.t0=i.catch(0),r(ri(null)),!(i.t0 instanceof hn)){i.next=17;break}return i.abrupt("return");case 17:(0,l.tO)(i.t0);case 18:case"end":return i.stop()}}),i,null,[[0,12]])})));return function(e){return r.apply(this,arguments)}}()},ri=function(e,t,n){return void 0===n&&(n=null),{type:nn,payload:{match:e,opponentInfo:t,current:n}}},ai=function(e){return{type:an,payload:{opponentInfo:e}}},si=function(e,t){return{type:cn,payload:{matchId:e,players:t}}},oi=function(e){return{type:zt,payload:{playerId:e}}},ci=function(e,t){return{type:Kt,payload:{playerId:e,stats:t}}},hi=function(e){return{type:Vt,payload:{stats:e}}},ui=function(e){return e.SINGLE="single",e.CHALLENGE_FRIENDS="challenge-friends",e.TOURNAMENT="tournaments",e}(ui||{}),li=ui,di=function(e){return e.GAME_MODE_CHANGED="game-mode-changed",e.BACKGROUND_CHANGED="background-changed",e.GAME_START="game-start",e.COIN_CHANGED="coin-changed",e.HEART_CHANGED="heart-changed",e.WILDCARD_CHANGED="wildcard-changed",e.UNDO_CHANGED="undo-changed",e.PLUS_FIVE_CHANGED="plus-five-changed",e.STAR_CHANGED="star-changed",e.WC_JOIN_BTN_CLICKED="wc-join-btn-clicked",e.WC_JOINED="wc-joined",e.HIDE_GUIDE="hide-guide",e.OPEN_PLAY_SCREEN_FROM_DASHBOARD="open-play-screen-from-dashboard",e.LOCATION_DECORATION_OPEN="opening-location-decoration",e.OPENED_LOCATION_DECORATION="opened-location-decoration",e.PLAYER_FINISH_CHALLENGE="player-finish-challenge",e.CHALLENGE_SCORE_CHANGED="player-challenge-score-changed",e.CHALLENGE_REWARD_DONE="challenge-reward-done",e.MAP_PLAYERS_CHANGED="map-players-challenged",e.CHALLENGE_WITH_PLAYER_ID_STARTED="challenge-with-player-id-started",e.LEADERBOARD_UPDATED="leaderboard-updated",e.AUTO_SHOWING_JOURNEY="auto-showing-journey",e.MISSION_REWARDED="MISSION_REWARDED",e.BACK_TO_DASHBOARD="back-to-dashboard",e.PREVENT_SHOW_EVENTS="prevent-show-events",e.DECORATION_UPGRADE="decoration-upgrade",e.DECORATION_UPGRADED="decoration-upgraded",e.CANNOT_UPGRADE_DECORATION="cannot-upgrade-decoration",e}(di||{}),pi=di,fi=function(e){function t(){var t;return(t=e.call(this)||this).gameMode=void 0,t.autoPlaySingleMode=void 0,t.friendsChallenged=void 0,t.isGameLoadedInTournament=!1,t.autoPlaySingleMode=!0,t.friendsChallenged=[],t}(0,f.Z)(t,e);var n=t.prototype;return n.setGameMode=function(e){this.gameMode=e,this.emit(pi.GAME_MODE_CHANGED)},n.getGameMode=function(){return this.gameMode},n.isSingleMode=function(){return this.getGameMode()==li.SINGLE},n.isChallengeMode=function(){return this.getGameMode()==li.CHALLENGE_FRIENDS},n.isTournamentMode=function(){return this.getGameMode()===li.TOURNAMENT},n.switchContext=function(){},(0,X.Z)(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t)}}]),t}(Phaser.Events.EventEmitter);fi._instance=void 0;var mi=fi,gi=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new ue(null,{contextId:t})},vi=null,yi=function(e){clearTimeout(vi),vi=setTimeout((function(){window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN)}),e)},Ei=function(e){return function(t){try{if(t($n()),e){var n=e.getPayload(),i=e.getID();if(n){var r=JSON.parse(n).leaderboardId;t(wt(i.toString(),r)),window.game.weeklyTournament.joinFromPost(i.toString())}}t(xi(_t))}catch(a){(0,l.tO)(a)}}},Ci=function(){return function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t($n()),t(xi(Dt))}catch(n){(0,l.tO)(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},wi=function(e,t){return void 0===e&&(e="10"),void 0===t&&(t=!1),function(){var n=(0,i.Z)(a().mark((function n(i){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i(Ai("reset",e,t));case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),(0,l.tO)(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})));return function(e){return n.apply(this,arguments)}}()},Ai=function(e,t,n){return void 0===n&&(n=!0),function(){var r=(0,i.Z)(a().mark((function i(r,s){var o,c,h,u,d,p,f,m,g,v,y,E,C,w,A,b,S,T;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,o=void 0===e,c=window.game,h=c.player,u=c.facebook,d=c.globalScene,n&&d.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),p=t,f=e,m=u.contextType,p||(g=GameCore.Configs.PlayerIdMock,v=GameCore.Configs.PlayerIdMock2,p=h.getPlayerId()===g?v:g),e){i.next=17;break}return i.next=11,u.chooseAsync();case 11:if(!1!==(f=i.sent)){i.next=15;break}return d.boxingDuel.events.emit("start-find-bot"),i.abrupt("return",!1);case 15:i.next=18;break;case 17:p&&!he.includes(p)&&(f=e);case 18:return gi({contextId:f}),y=h.getPlayerId(),i.next=22,u.getContextPlayers(y);case 22:if(E=i.sent,C=ce,""===p?1===E.length&&(C=E[0]||ce):C=1===E.length?E[0]||ce:h.getConnectedPlayers()[p]||ce,A=(w=C).name,b=w.photo,S=w.playerId,T={playerId:S,name:A,photo:b},!o){i.next=31;break}return i.next=30,d.boxingDuel.startNewMatch(T,f);case 30:return i.abrupt("return");case 31:return gi({contextId:f}),r(oi()),i.next=35,r(xi(Lt,T,n));case 35:return r(Ft(f,m)),i.abrupt("return",!0);case 39:if(i.prev=39,i.t0=i.catch(0),!(i.t0 instanceof ue)){i.next=43;break}return i.abrupt("return");case 43:if("USER_INPUT"!==(null==i.t0?void 0:i.t0.code)){i.next=45;break}return i.abrupt("return");case 45:if("INVALID_OPERATION"!==(null==i.t0?void 0:i.t0.code)){i.next=47;break}return i.abrupt("return");case 47:(0,l.tO)(i.t0);case 48:return i.prev=48,n&&yi(10),i.finish(48);case 51:case"end":return i.stop()}}),i,null,[[0,39,48,51]])})));return function(e,t){return r.apply(this,arguments)}}()},bi=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s,o,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,r=i.facebook,s=i.globalScene,o=i.analytics,s.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),c=r.getContextID(),gi({contextId:c}),o.event(ae._.JOIN_GROUP,{group_id:c}),t.next=8,n(xi(Mt,e));case 8:t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof ue)){t.next=14;break}return t.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==t.t0?void 0:t.t0.code)){t.next=16;break}return t.abrupt("return");case 16:(0,l.tO)(t.t0);case 17:return t.prev=17,yi(100),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,10,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Si=function(e,t){return function(){var n=(0,i.Z)(a().mark((function n(i,r){var s,o,c,h,u,d,p,f,m,g,v,y,E,C,w,A;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,o=s.player,c=s.profile,h=s.facebook,(u=s.globalScene).screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),d=r(),p=o.getPlayerId(d),!((f=o.getConnectedPlayers(d)).length>0)||f[t]){n.next=10;break}return i(Ii({mode:Dt})),u.events.emit(le.K.SWITCH,le.C.GAME_SCENE),n.abrupt("return");case 10:return m=ce,n.next=13,h.getContextPlayers(p);case 13:if(g=n.sent,t===p||he.includes(t)||!f[t]){n.next=18;break}m=f[t],n.next=26;break;case 18:if(1!==g.length){n.next=22;break}m=g[0],n.next=26;break;case 22:return n.next=24,c.requestProfiles([t]);case 24:(v=c.getProfiles())[t]&&(m=v[t]);case 26:return y=u.boxingDuel,n.next=29,y.startMatchFromOpponentData(e,t);case 29:if(n.sent){n.next=35;break}return i(Ii({mode:Dt})),u.events.emit(le.K.SWITCH,le.C.GAME_SCENE),n.abrupt("return");case 35:return n.next=37,i(ni(e,m));case 37:if(d=r(),En(d,{playerId:p})!==ce.playerId){n.next=42;break}return n.next=42,i(ti(e));case 42:if(d=r(),En(d,{playerId:p})===p||!f[t]){n.next=47;break}return i(wi(t,!0)),n.abrupt("return");case 47:if(gn(d)===e){n.next=51;break}return i(Ci()),n.abrupt("return");case 51:E=vn(d),C=Cn(d,{playerId:p}),w=h.getContextID(),A=h.contextType,i(Ft(w,A)),i(Ii(C?{mode:Dt}:{mode:Lt,status:E})),u.events.emit(le.K.SWITCH,le.C.GAME_SCENE),n.next=63;break;case 60:n.prev=60,n.t0=n.catch(0),(0,l.tO)(n.t0);case 63:return n.prev=63,yi(500),n.finish(63);case 66:case"end":return n.stop()}}),n,null,[[0,60,63,66]])})));return function(e,t){return n.apply(this,arguments)}}()},Ti=function(e){return function(t){try{var n=window.game.player,i=n.getPlayerId();Ve(i,e).catch((function(e){(0,l.tO)(new Error(e))}));var r=n.getPlayerData(),a=r.score,s=void 0===a?0:a,o=r.level;s<e&&n.setBestScore(e);var c={score:e,level:o};t(ci(i,c)),t(hi(c))}catch(h){if(h instanceof qe)return;(0,l.tO)(h)}}},xi=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=!0),function(){var r=(0,i.Z)(a().mark((function r(s,o){var c,h,u,d,p,f,m,g,v,y,E,C;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,c=window.game,h=c.player,c.analytics,u=c.facebook,d=c.globalScene,p=c.level,p.getLevelData()){r.next=11;break}return r.prev=4,r.next=7,p.preloadLevelDataAsync();case 7:r.next=11;break;case 9:r.prev=9,r.t0=r.catch(4);case 11:if(p.getLevelData()){r.next=15;break}return d.events.emit(le.K.SWITCH,le.C.ERROR_SCENE),r.abrupt("return");case 15:if(f=u.getContextID(),m=0,g=o(),s({type:Ut,payload:{}}),!([Dt,_t].indexOf(e)>=0)){r.next=28;break}return r.next=22,s((function(e){try{var t=window.game.player;e({type:jt,payload:{}});var n=t.getPlayerId(),i=xn(Vn.SingleMatchStore)||{},r=i.data;i.data=jn(r),Yn({playerId:n,match:i}),e(Qn(i))}catch(a){if(e(Qn(null)),a instanceof hn)return;if(a instanceof Gn)return;if(a instanceof _n)return;(0,l.tO)(a)}}));case 22:if(g=o(),pn(g)){r.next=27;break}return r.next=27,s(qn());case 27:m=fn(g);case 28:if(e===Mt&&s(ai(t)),e!==Lt){r.next=36;break}return v=window.game.level.getLevel(),y={level:v},r.next=34,s(ei(t,y,n));case 34:g=o(),f||(f=window.FBInstant.context.getID());case 36:"online"===e&&s(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=window.game.player,i=n.getPlayer(),r=i.playerId,s=i.name,o=i.photo,t({type:on,payload:{playerId:r}}),c={},new Array(20).fill(null).map((function(e,t){var n="0"+(t+1);c[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),c[r]={playerId:r,name:s,photo:o},t(si("mock",c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E=h.getPlayerData(g),C=E.score,s(hi({score:m,bestScore:void 0===C?0:C})),s({type:Wt,payload:{mode:e,contextId:f}}),mi.instance.setGameMode(e),s(Zt(e)),d.events.emit(le.K.SWITCH,le.C.GAME_SCENE),r.next=52;break;case 45:if(r.prev=45,r.t1=r.catch(0),!(r.t1 instanceof hn)){r.next=51;break}return window.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),r.abrupt("return");case 51:(0,l.tO)(r.t1);case 52:return r.prev=52,r.finish(52);case 54:case"end":return r.stop()}}),r,null,[[0,45,52,54],[4,9]])})));return function(e,t){return r.apply(this,arguments)}}()},ki=function(e,t){return function(){var n=(0,i.Z)(a().mark((function n(i,r){var s,o,c,h,u,l,d,p,f,m,g;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=window.game.player,o=t.score,c=void 0===o?0:o,h=t.level,u=void 0===h?0:h,l=t.time,void 0===l?0:l,d=t.moves,void 0===d?0:d,p=r(),!([Dt,_t].indexOf(e)>=0)){n.next=7;break}return f=pn(p),n.next=7,i(Jn(f));case 7:if(e===Mt&&(i({type:sn,payload:{}}),m=s.getPlayerId(),i(ci(m,t))),e!==Lt){n.next=12;break}return g=gn(p),n.next=12,i(ii(g,c,{level:u}));case 12:i({type:Yt,payload:{mode:e}});case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},Pi=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){try{if("SOLO"==window.FBInstant.context.getType())return e();window.FBInstant.context.switchAsync("SOLO",!0);var t=setInterval((function(){"SOLO"==window.FBInstant.context.getType()&&(clearInterval(t),window.game.storage.dispatch(Ii({mode:Dt})),e())}),200)}catch(n){e()}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ii=function(e){return function(t){var n=e.mode,i=e.status;t({type:Ht,payload:{mode:n,status:i}}),(0,l.sw)("game-mode",n)}},Oi=GameCore.Configs.ApiHost,Ri=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,be("players?"+n,{},Oi);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bi=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se("players?platform=ms-games",t,{},Oi,10);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Di=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se("players/"+t+"/user-guide-displays/inc",{},{},Oi);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Li(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _i=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),Ni=(function(e){e[e.WON=0]="WON",e[e.LOST=1]="LOST",e[e.DRAW=2]="DRAW"}({}),"show-notification"),Gi="finished",Fi="find-opponent-completed",Zi="boxing-duel-requested",Ui=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=void 0,t.playerBoxingDuelData=void 0,t.status=void 0,t.isPlayWithFriend=void 0,t.botPlayed=[],t.isRewardScreenShown=void 0,t.notifyEvent=void 0,t.boxingDuelDuration=void 0,t.matchIdFromEntryPointData=void 0,t.checkAndShowBoxingDuelScreen=function(){return!t.isFinished()&&(!!t.isValid()&&(!!t.playerBoxingDuelData.boxingDuelShown&&(t.updateBoxingDuel({boxingDuelShown:!1}),!0)))},t.checkAndShowRewardScreen=function(){return!!t.isFinished()&&(!!t.isRewardScreenShown&&(t.isRewardScreenShown=!1,!0))},t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.BoxingDuel,this.boxingDuelDuration=this.config.Duration},n.initData=function(){this.playerBoxingDuelData=this.game.player.getBoxingDuel(),this.updateDuelWithFriend(),this.updateData(),this.notifyEvent=!0},n.update=function(){this.checkTimeOut(),this.notifyEvent&&this.events.emit(Ni)},n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.isCurrentMatchEmpty())?this.setStatus(_i.WAITING):this.setStatus(_i.HAPPENING),e.next=4,this.updateOpponentScore(!0);case 4:n=this.playerBoxingDuelData.currentMatch,!t&&n.endTime<(new Date).getTime()&&(this.setStatus(_i.FINISHED),this.isRewardScreenShown=!0);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateDuelWithFriend=function(){var e=this.playerBoxingDuelData.currentMatch;this.isPlayWithFriend=""!==e.contextId},n.updatePlayerScore=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(n=this.playerBoxingDuelData.currentMatch,i=n.player,0!==(r=n.endTime)){e.next=6;break}return e.abrupt("return",Promise.resolve());case 6:if(!(r<(new Date).getTime())){e.next=8;break}return e.abrupt("return",Promise.resolve());case 8:return s=this.game.player.getPlayer(),o=s.playerId,c=s.name,h=s.photo,u={playerId:o,name:c,photo:h,score:t,lastUpdated:(new Date).getTime(),logStart:i.logStart},l=(0,p.Z)({},n),e.next=13,this.updateBoxingDuel({currentMatch:(0,p.Z)({},l,{player:u})});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateOpponentBotScore=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPlayWithFriend){e.next=2;break}return e.abrupt("return");case 2:if(!(this.playerBoxingDuelData.currentMatch.endTime>(new Date).getTime())){e.next=15;break}for(t=this.getEndTime()-this.boxingDuelDuration,n=(new Date).getTime(),i=n-t,r=this.playerBoxingDuelData.currentMatch.botPlayed,s=0,o=Li(r);!(c=o()).done;)(h=c.value).timePlayed<=i&&(s=h.score);return u=this.playerBoxingDuelData.currentMatch,l=(0,p.Z)({},u),(d=l.opponent)&&((f=(0,p.Z)({},d)).score=s,f.lastUpdated=(new Date).getTime(),l.opponent=f),e.next=15,this.updateBoxingDuel({currentMatch:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateOpponentScore=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),t||this.isHappening()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if(this.isPlayWithFriend&&!this.config.MockOpponent){e.next=6;break}return this.updateOpponentBotScore(),e.abrupt("return",Promise.resolve());case 6:return n=this.playerBoxingDuelData.currentMatch,i=n.matchId,r=n.opponent,e.next=10,this.tryToUpdateOpponentData(r);case 10:return s=e.sent,e.next=13,this.loadOpponentData(s.playerId);case 13:if(o=e.sent){e.next=16;break}return e.abrupt("return",void 0);case 16:if(c=[o.currentMatch].concat(o.historyMatches),""!==i){e.next=19;break}return e.abrupt("return",Promise.resolve());case 19:if(h=c.find((function(e){return e.matchId===i})),h){e.next=23;break}return e.abrupt("return",void 0);case 23:return u=this.playerBoxingDuelData.currentMatch,l=h.player,d={playerId:s.playerId,name:s.name,photo:s.photo,score:Math.max(s.score,l.score),lastUpdated:l.lastUpdated,logStart:l.logStart},f=(0,p.Z)({},u),e.next=29,this.updateBoxingDuel({currentMatch:(0,p.Z)({},f,{opponent:d})});case 29:return e.abrupt("return",Promise.resolve());case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.tryToUpdateOpponentData=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.player.getPlayerId(),e.next=3,this.game.facebook.getContextPlayers(n);case 3:if(!((i=e.sent).length<=0)){e.next=6;break}return e.abrupt("return",t);case 6:return r={playerId:i[0].playerId,name:i[0].name,photo:i[0].photo,score:t.score,lastUpdated:t.lastUpdated,logStart:t.logStart},e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateMatchId=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.playerBoxingDuelData.currentMatch,""===n.matchId){e.next=4;break}return e.abrupt("return");case 4:return(i=(0,p.Z)({},n)).matchId=t,e.next=8,this.updateBoxingDuel({currentMatch:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBoxingDuel=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.playerBoxingDuelData,i=(0,p.Z)({},n,t),this.playerBoxingDuelData=i,e.next=5,this.game.player.updateBoxingDuel(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startNewMatch=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(new Date).getTime()+this.boxingDuelDuration,this.isPlayWithFriend=""!==n,this.isPlayWithFriend&&!this.config.MockOpponent||this.generateBotPlayed(),r=this.game.player.getPlayer(),s=r.playerId,o=r.name,c=r.photo,h={matchId:"",contextId:n,endTime:i,player:{playerId:s,name:o,photo:c,score:0,lastUpdated:0,logStart:!1},opponent:{playerId:t.playerId,name:t.name,photo:t.photo,score:0,lastUpdated:0,logStart:!1},botPlayed:this.botPlayed,matchFinished:!1},this.setStatus(_i.HAPPENING),e.next=8,this.updateBoxingDuel({currentMatch:h});case 8:this.events.emit(Fi),this.logBoxingDuelStart();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.startMatchFromOpponentData=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPlayWithFriend=!1,this.matchIdFromEntryPointData=t,e.next=4,this.loadOpponentData(n);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:if(r=this.findMatchById(i,this.matchIdFromEntryPointData)){e.next=13;break}return e.next=11,Pi();case 11:case 21:return e.abrupt("return",void 0);case 13:if(s=r.contextId,o=r.endTime,c=r.player,h=r.opponent,u=this.game.player.getPlayer(),l=u.playerId,d=u.name,p=u.photo,f={playerId:l,name:d,photo:p,score:h.score,lastUpdated:h.lastUpdated,logStart:h.logStart},!(m=this.findMatchById(this.playerBoxingDuelData,this.matchIdFromEntryPointData))){e.next=27;break}if(!m.matchFinished){e.next=23;break}return e.next=21,Pi();case 23:return e.next=25,this.updateCurrentMatch(s,o,f,c);case 25:e.next=29;break;case 27:return e.next=29,this.updateCurrentMatch(s,o,f,c);case 29:return this.isPlayWithFriend=!0,this.setStatus(_i.HAPPENING),this.logBoxingDuelStart(),e.abrupt("return",Promise.resolve());case 33:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.findMatchById=function(e,t){return[e.currentMatch].concat(e.historyMatches).find((function(e){return e.matchId===t}))},n.updateCurrentMatch=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.isCurrentMatchEmpty(),o={matchId:this.matchIdFromEntryPointData,contextId:t,endTime:n,player:i,opponent:r,botPlayed:[],matchFinished:!1},s){e.next=9;break}return(c=[].concat(this.playerBoxingDuelData.historyMatches)).push(this.playerBoxingDuelData.currentMatch),e.next=7,this.updateBoxingDuel({currentMatch:o,historyMatches:c});case 7:e.next=11;break;case 9:return e.next=11,this.updateBoxingDuel({currentMatch:o});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.endCurrentMatch=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logBoxingDuelEnd(),t=this.playerBoxingDuelData.currentMatch,n=(0,p.Z)({},t,{matchFinished:!0}),(i=[].concat(this.playerBoxingDuelData.historyMatches)).push(n),e.next=7,this.updateBoxingDuel({currentMatch:this.getEmptyCurrentMatch(),historyMatches:i});case 7:return this.setStatus(_i.WAITING),this.notifyEvent=!0,e.next=11,Pi();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.loadOpponentData=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ri({playerIds:[t]});case 2:if(0!==(i=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return r=null==(n=i[0].customFields)?void 0:n.boxingDuel,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.isValid=function(){var e=this.game.player.getLevel()>=this.config.LevelStart;return this.config.Enable&&e},n.setStatus=function(e){e!=this.status&&(this.status=e)},n.isCurrentMatchEmpty=function(){return 0===this.playerBoxingDuelData.currentMatch.endTime},n.isWaiting=function(){return this.isValid()&&this.status===_i.WAITING},n.isHappening=function(){return this.isValid()&&this.status===_i.HAPPENING},n.isFinished=function(){return this.isValid()&&this.status===_i.FINISHED},n.isDuelWithFriend=function(){return this.isPlayWithFriend},n.checkNotifyEvent=function(){return this.notifyEvent},n.getPlayer=function(){var e=this.playerBoxingDuelData.currentMatch.player,t=(0,p.Z)({},e);if(""===t.playerId){var n=this.game.player.getPlayer(),i=n.playerId,r=n.name,a=n.photo;t.playerId=i,t.name=r,t.photo=a,this.updateBoxingDuel({currentMatch:(0,p.Z)({},this.playerBoxingDuelData.currentMatch,{player:t})})}return t},n.getPlayerScore=function(){return this.getPlayer().score},n.getOpponent=function(){var e=this.playerBoxingDuelData.currentMatch.opponent,t=(0,p.Z)({},e);if(""!==t.playerId)return t},n.getOpponentScore=function(){var e;return(null==(e=this.getOpponent())?void 0:e.score)||0},n.getEndTime=function(){return this.playerBoxingDuelData.currentMatch.endTime},n.getFirstTimePlay=function(){return this.playerBoxingDuelData.firstTimePlay},n.getContextID=function(){return this.playerBoxingDuelData.currentMatch.contextId},n.getMatchId=function(){return this.playerBoxingDuelData.currentMatch.matchId},n.getPlayerRank=function(){var e=this.playerBoxingDuelData.currentMatch,t=e.player,n=e.opponent;return t.score>n.score?0:t.score<n.score?1:0===t.lastUpdated&&0===n.lastUpdated?0:0===t.lastUpdated?1:0===n.lastUpdated||t.lastUpdated<n.lastUpdated?0:1},n.getRemainingTime=function(){return this.playerBoxingDuelData.currentMatch.endTime-(new Date).getTime()},n.setFirstTimePlay=function(e){this.updateBoxingDuel({firstTimePlay:e})},n.setNofityEvent=function(e){this.notifyEvent=e},n.isTimeout=function(){return this.playerBoxingDuelData.currentMatch.endTime<=(new Date).getTime()},n.checkTimeOut=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return");case 2:if(!(this.playerBoxingDuelData.currentMatch.endTime<=(new Date).getTime())){e.next=9;break}return this.setStatus(_i.FINISHED),this.isRewardScreenShown=!0,e.next=8,this.updateOpponentScore(!0);case 8:this.notifyEvent=!0;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.generateBotPlayed=function(){for(var e=this.boxingDuelDuration,t=[],n=0,i=0;n<e;){n+=Phaser.Math.Between(45e3,21e4),i+=Phaser.Math.Between(20,50),t.push({score:i,timePlayed:n})}this.botPlayed=t},n.getEmptyCurrentMatch=function(){var e=this.game.player.getPlayer();return{matchId:"",contextId:"",endTime:0,player:{playerId:e.playerId,name:e.name,photo:e.photo,score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1}},n.logBoxingDuelStart=function(){this.playerBoxingDuelData.currentMatch.player.logStart||(this.updateBoxingDuel({currentMatch:(0,p.Z)({},this.playerBoxingDuelData.currentMatch,{player:(0,p.Z)({},this.playerBoxingDuelData.currentMatch.player,{logStart:!0})})}),this.game.analytics.event(ae._.DUEL_START,{level:this.game.player.getLevel()}))},n.logBoxingDuelEnd=function(){var e;this.game.analytics.event(ae._.DUEL_END,{level:this.game.player.getLevel(),playerScore:this.getPlayer().score,opponentScore:(null==(e=this.getOpponent())?void 0:e.score)||0,playerWin:0===this.getPlayerRank(),bot:!this.isPlayWithFriend})},t}(Phaser.Plugins.BasePlugin),Wi=Ui,Yi=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var e,n;e=this.width*t,n=this.height*t,Math.floor(n/2),Math.floor(e/2)},n.src=e},Hi=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).width=void 0,t.height=void 0,t.renderOptions=void 0,t.canvas=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(e){var t=this,n=Object.keys(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,r=t.renderOptions,this.width=n,this.height=i,this.renderOptions=r,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=[];for(var t in this.renderOptions){var n=this.renderOptions[t],i=n.name,r=n.image,a=n.fallbackWithImage;if(r)if(this.scene.textures.get(i).key!==i&&""!==i){var s=this.loadImage(i,r,a);e.push(s)}}return this.scene.load.start(),Promise.all(e)},n.loadImage=function(e,t,n){var i=this;return this.scene.load.image(e,t),new Promise((function(t,r){var a=Phaser.Loader.Events.FILE_KEY_COMPLETE+"image-"+e,s=Phaser.Loader.Events.FILE_LOAD_ERROR,o=function e(n){i.scene.load.off(a,e),i.scene.load.off(s,c),t()},c=function c(h){if(h.key===e)if(i.scene.load.off(a,o),i.scene.load.off(s,c),n)t();else{var u=new Error("Load image failed");r(u)}};i.scene.load.on(a,o),i.scene.load.on(s,c)}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,r=e.font,a=e.text,s=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=r+' "Be Vietnam Pro",nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=s||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(a,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,r=e.name,a=e.frame,s=e.width,o=e.height,c=e.fallbackWithImage,h=this.scene.textures.get(r),u=h.getSourceImage(a);"__MISSING"===h.key&&c&&(u=(h=this.scene.textures.get(c)).getSourceImage()),t.drawImage(u,n,i,s,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Yi(e),e},t}(Phaser.Plugins.ScenePlugin),zi=Hi,Ki=n(7),Vi={CUMULATIVE_PRICE:{UNDO:25,WILD_CARD:50,PLUS_FIVE_CARDS:50},PLUS_A_HEART:300,UNDO:50,WILD_CARD:300,PLUS_FIVE_CARDS:150,SLICE_BOOSTER:350,STORM_BOOSTER:375,WILD_CARD_BOOSTER:325},Xi=function(e){return e.NONE="none",e.PLUS_FIVE_CARDS="plus-five-cards",e.SLICE="slice",e.STORM="storm",e.WILD_CARD="wild-card",e}({}),ji=function(e){return e.NONE="none",e.SLICE="slice",e.STORM="storm",e.WILD_CARD="wild-card",e.PLUS_CARD="plus-card",e}({}),qi=function(e){return e.IDLE="idle",e.RUNNING="running",e}({}),Ji=function(e){return e.START="start",e.COMPLETED="completed",e}({}),Qi=Ki.Z.DEFAULT.FRAME,$i={SLICE:{title:"slice",description:"removeThreeCards",cost:Vi.SLICE_BOOSTER,boosterFrame:Qi.REWARDS.SLICE,key:ji.SLICE},STORM:{title:"storm",description:"removeAllCards",cost:Vi.STORM_BOOSTER,boosterFrame:Qi.REWARDS.STORM,key:ji.STORM},WILD_CARD:{title:"wildDrop",description:"addThreeWildCards",cost:Vi.WILD_CARD_BOOSTER,boosterFrame:Qi.REWARDS.WILD_CARD,key:ji.WILD_CARD}},er=function(e){return e.COIN="coin",e.UNDO="undo",e.PLUS_5_CARDS="plus-5-cards",e}({}),tr=function(e){this.items=e},nr=[new tr([{type:er.PLUS_5_CARDS,amount:1},{type:ji.STORM,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new tr([{type:ji.STORM,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new tr([{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}])],ir=n(26),rr={WINNING:[[[10,85,5],[15,80,5],[20,80,0],[30,70,0]],[[40,60,0],[30,70,0],[40,60,0],[40,60,0]],[[50,50,0],[50,50,0],[50,50,0],[50,50,0]],[[60,40,0],[60,40,0],[70,30,0],[60,40,0]],[[70,30,0],[70,30,0],[80,20,0],[80,20,0]]],LOSING:[[[25,75,0],[30,70,0],[30,70,0],[40,60,0]],[[50,50,0],[40,60,0],[50,50,0],[50,50,0]],[[60,40,0],[60,40,0],[60,40,0],[60,40,0]],[[70,30,0],[70,30,0],[80,20,0],[70,30,0]],[[80,20,0],[80,20,0],[90,10,0],[90,10,0]]],TIME:[[[45,55,0],[50,50,0],[50,50,0],[60,40,0]],[[70,30,0],[60,40,0],[70,30,0],[70,30,0]],[[80,20,0],[80,20,0],[80,20,0],[80,20,0]],[[90,10,0],[90,10,0],[100,0,0],[90,0,0]],[[100,0,0],[100,0,0],[100,0,0],[100,0,0]]]},ar=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),sr="show-notification",or="finish-race",cr="race-requested",hr="end-race",ur=[0,1,2],lr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=GameCore.Configs.OffshoreRace,t.status=ar.WAITING,t.playerData=void 0,t.lastBotUpdate=0,t.shouldCheckTime=!1,t.notifyEvent=!1,t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.OffshoreRace,this.events.on(hr,this.endRace,this)},n.initData=function(){var e=this.game.player.getOffshoreRace();this.playerData=JSON.parse(JSON.stringify(e)),this.evaluateStatus(),this.notifyEvent=!0},n.update=function(){this.handleTimeout(),this.notifyEvent&&this.events.emit(sr)},n.startRace=function(){if(!this.isHappening()){var e=Date.now()+this.config.Duration,t=this.game.player.getPlayer(),n=this.game.player.getLevel(),i=this.createOpponents(),r=[{racerIndex:0,racerId:t.playerId,name:t.name,photo:t.photo,score:0,rank:0,lastUpdated:Date.now(),rewardClaimed:!1}].concat(i);this.playerData=(0,p.Z)({},this.playerData,{hasEventJoined:!0,endTime:e,levelStart:n,racers:r}),this.setStatus(ar.HAPPENING),this.syncPlayerData(),this.logRaceStart(),this.lastBotUpdate=Date.now()}},n.endRace=function(){this.logRaceEnd(),this.setStatus(ar.WAITING),this.playerData.hasEventJoined=!1,this.playerData.endTime=0,this.playerData.racers=[],this.syncPlayerData(),this.notifyEvent=!0},n.updateRacersScore=function(e){this.updatePlayerScore(e),this.updateOpponentScore(e)},n.updatePlayerScore=function(e){var t=this;if(this.isHappening()&&e){var n=this.getRacers().map((function(e,n){return 0===n?(0,p.Z)({},e,{score:Phaser.Math.Clamp(e.score+1,0,t.config.RequiredLevels),lastUpdated:Date.now()}):e}));this.commitRaceUpdate(n)}},n.updateOpponentScore=function(e){var t=this;if(this.shouldUpdateBotScore(e)){var n=this.getRacers(),i=n[0],r=n.slice(1),a=r.sort((function(e,t){return e.rank-t.rank})),s=this.generateBotMoves(i.rank,e),o=r.map((function(e){var n,i=a.findIndex((function(t){return t.racerIndex===e.racerIndex})),r=null!=(n=s[i])?n:0;return(0,p.Z)({},e,{score:Phaser.Math.Clamp(e.score+r,0,t.config.RequiredLevels),lastUpdated:Date.now()})}));this.commitRaceUpdate([i].concat(o))}},n.isValid=function(){return this.config.Enable&&this.game.player.getLevel()>=this.config.LevelStart},n.isHappening=function(){return this.isValid()&&this.status===ar.HAPPENING},n.isWaiting=function(){return this.isValid()&&this.status===ar.WAITING},n.isFinished=function(){return this.isValid()&&this.status===ar.FINISHED},n.hasReward=function(){var e=this.getRacers()[0];return this.isFinished()&&e&&ur.includes(e.rank)&&e.score>=this.config.RequiredLevels},n.getRacers=function(){return this.playerData.racers},n.getTop3Racers=function(){return this.getRacers().map((function(e){return(0,p.Z)({},e)})).sort((function(e,t){return e.rank-t.rank})).slice(0,3)},n.getRemainingTime=function(){return Math.max(0,this.playerData.endTime-Date.now())},n.getRequiredLevels=function(){return this.config.RequiredLevels},n.getPlayerRank=function(){var e=this.getRacers();return e.length>0?e[0].rank:-1},n.getIsFirstTimeEvent=function(){return!0===this.playerData.isFirstTimeEvent},n.getRewardClaimed=function(){return this.getRacers().map((function(e){return{racerIndex:e.racerIndex,rewardClaimed:e.rewardClaimed}}))},n.getRewardData=function(){return this.hasReward()?nr[this.getRacers()[0].rank].items:[]},n.isTimeout=function(){return this.playerData.endTime<=Date.now()},n.checkNotifyEvent=function(){return this.notifyEvent},n.setNotifyEvent=function(e){this.notifyEvent=e},n.setIsFirstTimeEvent=function(e){this.playerData.isFirstTimeEvent=e,this.syncPlayerData()},n.setRacerClaimReward=function(e){var t=this.getRacers().map((function(t){return t.racerIndex===e?(0,p.Z)({},t,{rewardClaimed:!0}):t}));this.playerData.racers=t,this.syncPlayerData()},n.setShouldCheckTime=function(e){this.shouldCheckTime!==e&&(this.shouldCheckTime=e,e&&(this.lastBotUpdate=Date.now()))},n.resetRacersScore=function(){var e=this.getRacers().map((function(e){return(0,p.Z)({},e,{score:0,lastUpdated:Date.now(),rewardClaimed:!1})}));this.setStatus(ar.HAPPENING),this.commitRaceUpdate(e)},n.updateRacerScore=function(e,t){var n=this,i=this.getRacers().map((function(i,r){return r===e?(0,p.Z)({},i,{score:Phaser.Math.Clamp(i.score+t,0,n.config.RequiredLevels),lastUpdated:Date.now()}):i}));this.commitRaceUpdate(i)},n.evaluateStatus=function(){var e=this.playerData.endTime;if(0===e)return this.setStatus(ar.WAITING);var t=e<Date.now()?ar.FINISHED:ar.HAPPENING;this.setStatus(t),this.checkRaceCompletion()},n.handleTimeout=function(){this.isHappening()&&(this.playerData.endTime<=Date.now()?(this.setStatus(ar.FINISHED),this.notifyEvent=!0,this.events.emit(sr)):this.shouldCheckTime&&this.updateRacersScore())},n.setStatus=function(e){e!==this.status&&(this.status=e)},n.commitRaceUpdate=function(e){var t=this.updateRanks(e);this.playerData.racers=t,this.syncPlayerData(),this.checkRaceCompletion()},n.updateRanks=function(e){var t=e.map((function(e){return(0,p.Z)({},e)}));return t.sort((function(e,t){return t.score-e.score||e.lastUpdated-t.lastUpdated})),t.forEach((function(e,t){return e.rank=t})),t.sort((function(e,t){return e.racerIndex-t.racerIndex})),t},n.shouldUpdateBotScore=function(e){if(void 0!==e)return this.lastBotUpdate=Date.now(),!0;var t=this.playerData.hasEventJoined,n=this.playerData.endTime<=Date.now(),i=this.isFinished(),r=Date.now()>=this.lastBotUpdate+12e4;return!(!t||n||i||!r)&&(this.lastBotUpdate=Date.now(),!0)},n.generateBotMoves=function(e,t){return rr[void 0===t?"TIME":t?"WINNING":"LOSING"][e].map((function(e){var t=e[0],n=e[1],i=100*Math.random();return i<t?0:i<t+n?1:2}))},n.createOpponents=function(){return(0,ir.h)(this.config.RaceOpponentCount).map((function(e,t){return{racerIndex:t+1,racerId:e.id,name:e.name,photo:e.photo,score:0,rank:t+1,lastUpdated:Date.now(),rewardClaimed:!1}}))},n.checkRaceCompletion=function(){var e=this;if(!this.isFinished()){var t=this.getRacers(),n=t[0],i=t.slice(1),r=n.score>=this.config.RequiredLevels,a=i.filter((function(t){return t.score>=e.config.RequiredLevels})).length>=3;(r||a)&&(this.setStatus(ar.FINISHED),this.notifyEvent=!0)}},n.syncPlayerData=function(){this.game.player.setCustomData("offshoreRace",(0,p.Z)({},this.playerData))},n.logRaceStart=function(){this.game.analytics.event(ae._.RACE_START,{level:this.game.player.getLevel()})},n.logRaceEnd=function(){if(0!==this.getRacers().length){var e=this.game.player.getLevel()-this.playerData.levelStart;this.game.analytics.event(ae._.RACE_END,{rank:this.getRacers()[0].rank,level:this.game.player.getLevel(),milestone:e,score:this.getRacers()[0].score,hasReward:this.hasReward()})}},t}(Phaser.Plugins.BasePlugin),dr=lr,pr=function(e){function t(t,n,i){var r;return(r=e.call(this)||this).game=void 0,r.options=void 0,r.performance=void 0,r.isRunning=!1,r.checkTimer=void 0,r.fpsHistory=void 0,r.start=function(){if(!r.isRunning){r.isRunning=!0;var e=r.options.checkInterval;r.checkTimer=e,r.fpsHistory=[],r.game.events.on(Phaser.Core.Events.POST_STEP,r.onPostStep)}},r.stop=function(){r.isRunning&&(r.isRunning=!1,r.game.events.off(Phaser.Core.Events.POST_STEP,r.onPostStep),r.options.onlyUpdateWhenSwitchScene&&r.checkFps())},r.onPostStep=function(e,t){if(r.checkTimer-=t,!(r.checkTimer>0)){var n=r.options,i=n.checkInterval,a=n.onlyUpdateWhenSwitchScene;r.checkTimer+=i,r.fpsHistory.push(r.game.loop.actualFps),!1===a&&r.fpsHistory.length>=5&&r.checkFps()}},r.game=t,r.options=i,r.performance=n,r}(0,f.Z)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),fr=pr,mr=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],gr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).fpsTracker=void 0,t.pixelRatio=void 0,t.minQuality=void 0,t.maxQuality=void 0,t.qualityAdjustStep=void 0,t.trackingSceneKeys=[],t.trackingScene=function(e){if(t.trackingSceneKeys.includes(e)){var n=t.game.scene.getScene(e);n.events.once(Phaser.Scenes.Events.UPDATE,t.fpsTracker.start),n.events.once(Phaser.Scenes.Events.SLEEP,t.fpsTracker.stop)}},t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,i=e.maxQuality,r=e.qualityAdjustStep,a=e.trackingSceneKeys,s=(0,d.Z)(e,mr);this.pixelRatio=t,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=r,this.trackingSceneKeys=a,this.fpsTracker=new fr(this.game,this,s)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},t}(Phaser.Plugins.BasePlugin),vr=gr,yr={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme,tapToMove:!0,autoHints:!0,autoComplete:!0,drawMode3:!1,backgroundIdx:0,cardFaceIdx:0,cardBackIdx:0,backgroundDesktopIdx:0,cardFaceDesktopIdx:0,cardBackDesktopIdx:0},Er={coins:0,diamond:0,lastReceiveGift:0,level:1,wildCard:0,undo:0,plusFive:0,star:0,journeyProgress:{currentLocationIndex:-1,finishedLocationIds:[],inProgressLocation:void 0},life:{hearts:1,lastTimeReceive:0},boosters:{slice:0,storm:0,wildCard:0},levelStars:{},dailyRewarded:{lastRewarded:0,logDays:[]},dailyTasks:{startedTime:0,logTasks:{}},game_stats:{},tournaments:[],worldCupEvent:{firstTimeShown:0,joinedWorldCups:[]},lastAwesomeWCShownDate:0,pendingMatchIds:[],lastWelcomeBackRewardTime:0,weeklyTournament:{hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1},boxingDuel:{firstTimePlay:!0,boxingDuelShown:!1,currentMatch:{matchId:"",contextId:"",endTime:0,player:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1},historyMatches:[]},offshoreRace:{isFirstTimeEvent:!0,loginTime:0,hasShownEvent:!1,hasEventJoined:!1,endTime:0,levelStart:13,racers:[]}},Cr=yr.sound,wr=yr.music,Ar=yr.vibrate,br=yr.language,Sr=yr.theme,Tr=yr.tapToMove,xr=yr.autoHints,kr=yr.autoComplete,Pr=yr.drawMode3,Ir=yr.backgroundIdx,Or=yr.cardFaceIdx,Rr=yr.cardBackIdx,Br=yr.backgroundDesktopIdx,Dr=yr.cardFaceDesktopIdx,Lr=yr.cardBackDesktopIdx,Mr=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0,this.tapToMove=void 0,this.autoHints=void 0,this.autoComplete=void 0,this.drawMode3=void 0,this.backgroundIdx=void 0,this.cardFaceIdx=void 0,this.cardBackIdx=void 0,this.backgroundDesktopIdx=void 0,this.cardFaceDesktopIdx=void 0,this.cardBackDesktopIdx=void 0;var t=e||{},n=t.sound,i=t.music,r=t.vibrate,a=t.language,s=t.theme,o=t.tapToMove,c=t.autoHints,h=t.autoComplete,u=t.drawMode3,l=t.backgroundIdx,d=t.cardFaceIdx,p=t.cardBackIdx,f=t.backgroundDesktopIdx,m=t.cardFaceDesktopIdx,g=t.cardBackDesktopIdx;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:Cr,this.music=GameCore.Utils.Valid.isBoolean(i)?i:wr,this.vibrate=GameCore.Utils.Valid.isBoolean(r)?r:Ar,this.language=GameCore.Utils.Valid.isString(a)?a:br,this.theme=GameCore.Utils.Valid.isString(s)?s:Sr,this.tapToMove=GameCore.Utils.Valid.isBoolean(o)?o:Tr,this.autoHints=GameCore.Utils.Valid.isBoolean(c)?c:xr,this.autoComplete=GameCore.Utils.Valid.isBoolean(h)?h:kr,this.drawMode3=GameCore.Utils.Valid.isBoolean(u)?u:Pr,this.backgroundIdx=GameCore.Utils.Valid.isNumber(l)?l:Ir,this.cardFaceIdx=GameCore.Utils.Valid.isNumber(d)?d:Or,this.cardBackIdx=GameCore.Utils.Valid.isNumber(p)?p:Rr,this.backgroundDesktopIdx=GameCore.Utils.Valid.isNumber(f)?f:Br,this.cardFaceDesktopIdx=GameCore.Utils.Valid.isNumber(m)?m:Dr,this.cardBackDesktopIdx=GameCore.Utils.Valid.isNumber(g)?g:Lr}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme,tapToMove:this.tapToMove,autoHints:this.autoHints,autoComplete:this.autoComplete,drawMode3:this.drawMode3,backgroundIdx:this.backgroundIdx,cardFaceIdx:this.cardFaceIdx,cardBackIdx:this.cardBackIdx,backgroundDesktopIdx:this.backgroundDesktopIdx,cardFaceDesktopIdx:this.cardFaceDesktopIdx,cardBackDesktopIdx:this.cardBackDesktopIdx}},e}(),_r=Mr,Nr=GameCore.Utils,Gr=Nr.Valid,Fr=(Nr.Object,function(){function e(e){this.score=void 0,this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.setupDefaultData(),this.updateScore(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e)}var t=e.prototype;return t.setupDefaultData=function(){this.score=0,this.settings=(0,p.Z)({},yr),this.gameData=Phaser.Utils.Objects.DeepCopy(Er),this.userGuideDisplays=0},t.updateScore=function(e){var t=e.score;!1!==Gr.isNumber(t)&&(this.score=t)},t.updateSettings=function(e){var t=e.settings;if(!1!==Gr.isObject(t)){var n=new _r(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;this.gameData=(0,p.Z)({},this.gameData,t)},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==Gr.isNumber(t)&&(this.userGuideDisplays=t)},t.toObject=function(){return{score:this.score,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays}},t.convertToPlayerData=function(){return{score:this.score,settings:this.settings,customFields:(0,p.Z)({},this.gameData),userGuideDisplays:this.userGuideDisplays}},t.convertToFacebookData=function(e){var t=e.score,n=e.settings,i=e.customFields,r=e.userGuideDisplays;return this.updateScore({score:t}),this.updateSettings({settings:n}),this.updateGameData({gameData:i}),this.updateUserGuideDisplays({userGuideDisplays:r}),this.toObject()},e}()),Zr=Fr,Ur="PLAYER_RECEIVED",Wr="PLAYER_DATA_UPDATE",Yr="PLAYER_SCORE_UPDATE",Hr="PLAYER_PROFILE_UPDATE",zr="PLAYER_SETTING_UPDATE",Kr="PLAYER_CONNECTED_PLAYERS_UPDATE",Vr=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),Xr="player",jr=(0,Q.P1)([function(e){return e[Xr]}],(function(e){return e})),qr=(0,Q.P1)([jr],(function(e){return e.playerId})),Jr=(0,Q.P1)([jr],(function(e){return e.ASID})),Qr=(0,Q.P1)([function(e){return e[Xr].data}],(function(e){return e})),$r=((0,Q.P1)([Qr],(function(e){return e.settings})),(0,Q.P1)([function(e){return e[Xr].connectedPlayers}],(function(e){return e}))),ea=(0,Q.P1)([$r,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){return"number"!==typeof t||"number"!==typeof n?[]:Object.keys(e).slice(n,t+n)||[]})),ta=(0,Q.P1)([Qr],(function(e){return e.score})),na=(0,Q.P1)([Qr],(function(e){return e.customFields})),ia=(0,Q.P1)([na],(function(e){return void 0===(null==e?void 0:e.tournaments)?[]:e.tournaments})),ra=(0,Q.P1)([na],(function(e){return(null==e?void 0:e.weeklyTournament)||{hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1}})),aa=(0,Q.P1)([na],(function(e){return(null==e?void 0:e.offshoreRace)||{isFirstTimeEvent:!0,loginTime:0,hasShownEvent:!1,hasEventJoined:!1,endTime:0,levelStart:13,racers:[]}})),sa=(0,Q.P1)([na],(function(e){return(null==e?void 0:e.boxingDuel)||{firstTimePlay:!0,boxingDuelShown:!1,currentMatch:{matchId:"",contextId:"",endTime:0,player:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1},historyMatches:[]}})),oa=(0,Q.P1)([na],(function(e){return(null==e?void 0:e.journeyProgress)||{currentLocationIndex:-1,finishedLocationIds:[],inProgressLocation:void 0}})),ca=GameCore.Configs,ha=ca.AppId,ua=ca.Tutorial,la=function(e,t){return function(n){var i=e.playerId,r=e.name,a=e.photo,s=e.locale;n({type:Ur,payload:{playerId:i,name:r,photo:a,locale:s,data:t||{}}})}},da=function(e){return{type:Kr,payload:{connectedPlayers:e}}},pa=function(e,t){return function(){var n=(0,i.Z)(a().mark((function n(i,r){var s,o,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i({type:zr,payload:{name:e,value:t}});case 3:s=r(),o=Qr(s),c=new Zr({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,l.tO)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},fa=function(e,t){return function(){var n=(0,i.Z)(a().mark((function n(i,r){var s,o,c,h,u;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={customFields:(s={},s[e]=t,s)},n.next=4,i(ga(o));case 4:c=r(),h=Qr(c),Bi(h),u=new Zr({}).convertToFacebookData(h),FBInstant.player.setDataAsync(u),n.next=16;break;case 11:if(n.prev=11,n.t0=n.catch(0),!(n.t0 instanceof Vr)){n.next=15;break}return n.abrupt("return");case 15:(0,l.tO)(n.t0);case 16:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e,t){return n.apply(this,arguments)}}()},ma=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n,i){var r,s,o,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={customFields:e},t.next=4,n(ga(r));case 4:s=i(),o=Qr(s),c=new Zr({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof Vr)){t.next=15;break}return t.abrupt("return");case 15:(0,l.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},ga=function(e){return{type:Wr,payload:{data:e}}},va=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n,i){var r,s,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:Yr,payload:{score:e}});case 3:Bi({score:e}),r=i(),s=Qr(r),o=new Zr({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,l.tO)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},ya=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).isUserNew=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!ua.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(ga({userGuideDisplays:1}));case 5:i=n(),r=qr(i),s=Qr(i),o=new Zr({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),Di(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,l.tO)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(la(t,n));case 3:this.isUserNew=this.getPlayer().isUserNew;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=n(),r=jr(i),s=r.playerId,o=r.name,c=r.photo,h=r.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return u=e.sent,d={appId:ha,playerId:s,name:o,photo:c,locale:h,ASID:u},e.next=10,t({type:Hr,payload:{profile:d}});case 10:return e.next=12,Bi(d);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,l.tO)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(va(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(pa(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(fa(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(ma(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateWeeklyTournament=function(e){this.setCustomData("weeklyTournament",e)},n.updateOffshoreRace=function(e){this.setCustomData("offshoreRace",e)},n.updateBoxingDuel=function(e){this.setCustomData("boxingDuel",e)},n.updateJourneyProgress=function(e){this.setCustomData("journeyProgress",e)},n.requestConnectedPlayers=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.player.getConnectedPlayersAsync();case 3:if(n=e.sent,i=function(e){return!!e},r=n.map((function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new se.Z(t,n,i).toObject():null})).filter(i),!(r.length<1)){e.next=8;break}return e.abrupt("return");case 8:t(da(r)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,l.tO)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(da(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.joinTournament=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getTournaments()).find((function(e){return e.leaderboardId===t.leaderboardId}))){e.next=3;break}return e.abrupt("return");case 3:return i=[].concat(n,[t]),e.next=6,this.setMultiCustomData({tournaments:i});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLevelProgress=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.game.storage,!(void 0!=(r=this.getLevelStars(t))&&r>=n)){e.next=4;break}return e.abrupt("return");case 4:return(s={})[t]=n,e.next=8,i.dispatch(fa("levelStars",s));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setLevel=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.game.storage).dispatch(Ti(t)),e.next=4,n.dispatch(fa("level",t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLifeData=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,(i={hearts:1,lastTimeReceive:0}).hearts=t.hearts,i.lastTimeReceive=t.lastTimeReceive,e.next=6,n.dispatch(fa("life",i));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setWildCard=function(e){this.setCustomData("wildCard",Math.max(0,e)),this.game.events.emit(pi.WILDCARD_CHANGED)},n.setUndo=function(e){this.setCustomData("undo",Math.max(0,e)),this.game.events.emit(pi.UNDO_CHANGED)},n.setPlusFive=function(e){this.setCustomData("plusFive",Math.max(0,e)),this.game.events.emit(pi.PLUS_FIVE_CHANGED)},n.setStar=function(e){this.setCustomData("star",Math.max(0,e)),this.game.events.emit(pi.STAR_CHANGED,e)},n.setBoosterAmount=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,(r={})[t]=n,e.next=5,i.dispatch(fa("boosters",r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setLastWelcomeBackRewardTime=function(e){this.setCustomData("lastWelcomeBackRewardTime",e)},n.getPlayer=function(){return jr(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return Jr(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(yr,e)?yr[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.isUserNew},n.getCoins=function(){var e=this.getCustomData("coins");return GameCore.Utils.Valid.isNumber(e)?e:0},n.setCoins=function(e){this.setCustomData("coins",e),this.game.events.emit(pi.COIN_CHANGED,e)},n.getWildCard=function(){var e=this.getCustomData("wildCard");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getUndo=function(){var e=this.getCustomData("undo");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getPlusFive=function(){var e=this.getCustomData("plusFive");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getStar=function(){var e=this.getCustomData("star");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBoosterAmount=function(e){if("string"!==typeof e)return 0;var t=this.getCustomData("boosters");if(!GameCore.Utils.Valid.isObject(t))return 0;var n=t[e];return GameCore.Utils.Valid.isNumber(n)?n:0},n.getLifeData=function(){var e=this.getCustomData("life"),t={hearts:1,lastTimeReceive:0};return GameCore.Utils.Valid.isObject(e)&&GameCore.Utils.Object.hasOwn(e,"hearts")&&GameCore.Utils.Object.hasOwn(e,"lastTimeReceive")?(GameCore.Utils.Valid.isNumber(e.hearts)&&GameCore.Utils.Valid.isNumber(e.lastTimeReceive)&&(t.hearts=e.hearts,t.lastTimeReceive=e.lastTimeReceive),t):t},n.getDiamond=function(){var e=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBestScore=function(){return ta(this.state)},n.getLevelStars=function(e){var t=this.getCustomData("levelStars");if(void 0!=t){var n=t[e];if(void 0!=n)return n}},n.getLevel=function(){var e=this.getCustomData("level");return GameCore.Utils.Valid.isNumber(e)?e:1},n.getCustomData=function(e){var t=na(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return $r(this.state)},n.getConnectedPlayerIds=function(e,t){return ea(this.state,{limit:e,offset:t})},n.getTournaments=function(){return ia(this.state)},n.getPendingMatchIds=function(){var e=this.getCustomData("pendingMatchIds");return Array.isArray(e)&&e.every((function(e){return GameCore.Utils.Valid.isString(e)}))?e:[]},n.setPendingMatchIds=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setCustomData("pendingMatchIds",t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.addPendingMatchId=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isString(t)){e.next=2;break}return e.abrupt("return");case 2:if(!(n=this.getPendingMatchIds()).includes(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.setPendingMatchIds([].concat(n,[t]));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.removePendingMatchId=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isString(t)){e.next=2;break}return e.abrupt("return");case 2:if((n=this.getPendingMatchIds()).includes(t)){e.next=5;break}return e.abrupt("return");case 5:return i=n.filter((function(e){return e!==t})),e.next=8,this.setPendingMatchIds(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getWeeklyTournament=function(){return ra(this.state)},n.getOffshoreRace=function(){return aa(this.state)},n.getBoxingDuel=function(){return sa(this.state)},n.getJourneyProgress=function(){return oa(this.state)},n.getLastWelcomeBackRewardTime=function(){var e=this.getCustomData("lastWelcomeBackRewardTime");return GameCore.Utils.Valid.isNumber(e)?e:0},(0,X.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Ea=ya,Ca=GameCore.Configs.ApiHost,wa=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,be("players?"+n,{},Ca);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Aa="PROFILES_DATA_UPDATE",ba="profile",Sa=(0,Q.P1)([function(e){return e[ba].data}],(function(e){return e})),Ta=(0,Q.P1)([function(e){return e[ba].profileIds}],(function(e){return e})),xa=GameCore.Configs,ka=xa.Tournament,Pa=xa.LeadersBoard,Ia=function(e){return function(){var t=(0,i.Z)(a().mark((function t(n,i){var r,s,o,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=i(),s=Ta(r),!((o=GameCore.Utils.Array.difference(e,s)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,wa({playerIds:o});case 8:c=t.sent,ka.UseMock&&Pa.UseMock&&(c=new Array(o.length).fill(null).map((function(e,t){var n=t+1;return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(17*Math.random()*1e3/n)}}))),n({type:Aa,payload:{data:c}}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,l.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()},Oa=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Ia(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Sa(this.state)},n.getProfile=function(e){return this.getProfiles()[e]},(0,X.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Ra=Oa,Ba=n(22),Da=n.n(Ba),La=["player","match"],Ma="null",_a=GameCore.Utils,Na=_a.Valid,Ga=_a.Object,Fa=GameCore.Configs.Rollbar,Za=Fa.UseMockup,Ua=Fa.FilterError,Wa=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).enable=void 0,t.rollbar=void 0,t.events=[],t.beforeSend=function(e,n,i){Za&&t.showPopupError(i)},t.checkIgnore=function(e,n,i){try{return!!t.isErrorIgnore(n)}catch(r){return!1}},t.showPopupError=function(e){var n,i,r,a=null==e||null==(n=e.body)||null==(n=n.trace)?void 0:n.exception;a&&t.events.push(a);var s=(null==e||null==(i=e.body)||null==(i=i.trace)?void 0:i.frames)||[];(r=t.events).push.apply(r,s);var o=document.getElementById("popup-error");o||((o=document.createElement("div")).id="popup-error",document.body.appendChild(o)),o.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+JSON.stringify(t.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',o.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var c=document.getElementById("close");c&&(c.onclick=t.closePopup)},t.closePopup=function(){t.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},t.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},t.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var n=!1,i=e[0];return i instanceof Object&&(n=t.isIgnoreByCode(i)||t.isIgnoreByMessage(i)),n},t.isIgnoreByCode=function(e){if(Ga.hasOwn(e,"code")){var t=e.code,n=Ua.Codes,i=n.accepted,r=n.ignored;if("string"===typeof t){if(i.indexOf(t)>=0)return!1;if(r.indexOf(t)>=0)return!0}}if(Ga.hasOwn(e,"name")){var a=e.name,s=Ua.Codes,o=s.accepted,c=s.ignored;if("string"===typeof a){if(o.indexOf(a)>=0)return!1;if(c.indexOf(a)>=0)return!0}}return!1},t.isIgnoreByMessage=function(e){if(Ga.hasOwn(e,"message")){var t=e.message,n=Ua.Messages,i=n.accepted,r=n.ignored;if("string"===typeof t){if(i.indexOf(t)>=0)return!1;if(r.indexOf(t)>=0)return!0}}return!1},t.addExtraState=function(){try{if(!Ga.hasOwn(window,"game"))return;if(!Ga.hasOwn(window.game,"storage"))return;if(!Ga.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},n=e.player,i=e.match,r=(0,d.Z)(e,La);t.rollbar.configure({payload:{player:n,match:i,other:r}})}catch(a){}},t}(0,f.Z)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(Da())({accessToken:Ma,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"1"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){if(!Na.isDebugger()){var e=FBInstant.player.getID();e&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})}},n.sendException=function(e,t){e&&this.enable&&this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t))},t}(Phaser.Plugins.BasePlugin),Ya=Wa,Ha=n(10),za=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),Ka=za,Va=n(44),Xa=function(e){function t(t,n,i,r){var a;(a=e.call(this,t)||this).zone=void 0,a.background=void 0,a.setName(n),a.setVisible(!1);var s=a.scene.world.getWorldSize(),o=s.width,c=s.height;return a.setSize(i||o,r||c),a.addZone(),a.addBackground(),a.registerEvents(),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logEventOpen(),this.handleResize())},n.close=function(){this.visible&&this.setVisible(!1)},n.incY=function(e){this.y+=e,this.background.y-=e},n.incX=function(e){this.x+=e,this.background.x-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){this.background=this.scene.add.image(0,0,oe.Z.OVERLAY.KEY),this.background.setInteractive({useHandCursor:!0}),this.background.setWorldSize(this.width,this.height),this.background.disableInteractive(),this.add(this.background)},n.registerEvents=function(){this.scene.world.events.on(Va.Z.RESIZE,this.handleResize,this)},n.handleResize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setSize(t,n),this.zone.setSize(this.width,this.height),this.background.setWorldSize(this.width,this.height),Phaser.Display.Align.In.Center(this,this.scene.gameZone)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(ae._.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),ja=Xa,qa={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ja,GameCore.Screens={Events:qa};var Ja=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).screenMap=void 0,t.screensLayer=void 0,t.events=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.boot=function(){this.events=new Ka,this.screenMap=new Map,this.registryScreenFactory()},n.get=function(e){var t=this.screensLayer.getByName(e);return null===t?null:t},n.preAdd=function(e,t){this.screenMap.set(e,t)},n.add=function(e,t,n,i){this.screensLayer||(this.screensLayer=this.scene.add.layer(),this.screensLayer.setDepth(Ha.Z.POPUP));var r=this.get(e);return r||(r=this.scene.add.screen(e,t,n,i),this.screensLayer.add(r),this.events.emit(GameCore.Screens.Events.CREATED,r),r)},n.openAsync=function(e,t){var n=this;return this.open(e,t),new Promise((function(t){var i=n.get(e);i?i.on(GameCore.Screens.Events.CLOSE,t):t()}))},n.open=function(e,t){var n=this.get(e);if(!n){var i=this.screenMap.get(e);if(!i)return!1;this.add(e,i,this.scene.gameZone.width,this.scene.gameZone.height),n=this.get(e)}return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),!0)},n.bringToTop=function(e){var t=this.screensLayer.getByName(e);t&&this.screensLayer.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var r=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(r,this.scene.gameZone),this.existing(r),r},t}(Phaser.Plugins.ScenePlugin),Qa=Ja,$a=n(24),es=n.n($a),ts=n(40),ns=n(41),is={currentSceneKey:"",prevSceneKey:""};(0,ns.pV)();var rs,as,ss,os,cs,hs,us,ls,ds,ps={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},fs=ps,ms={data:{}},gs={token:"",isRequesting:!1},vs=((rs={})[$]=function(e,t){return void 0===e&&(e=gs),(0,ns.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case j:e.isRequesting=!0;break;case q:e.token=i,e.isRequesting=!1}}}))},rs),ys={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:yr,userGuideDisplays:0,customFields:Phaser.Utils.Objects.DeepCopy(Er)},isUserNew:!0},Es=((as={})[Xr]=function(e,t){return void 0===e&&(e=ys),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.name,a=i.value,s=i.data,o=void 0===s?{}:s,c=i.score,h=i.connectedPlayers,u=void 0===h?[]:h,l=i.profile;switch(t.type){case Ur:var d=i.playerId,p=i.name,f=i.photo,m=i.locale,g=i.data;if(n.playerId=d,n.name=p,n.photo=f,n.locale=m,GameCore.Utils.Valid.isObject(g)){var v=g;n.data=(0,Tn.TS)(e.data,v)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case Hr:var y=l.playerId,E=l.name,C=l.photo,w=l.locale,A=l.ASID;n.ASID=A,n.playerId=y,n.name=E,n.photo=C,n.locale=w;break;case Yr:n.data.score=c;break;case zr:n.data.settings[r]=a;break;case Wr:n.data=(0,Tn.TS)(e.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case Kr:if(u.length<=0)break;var b=GameCore.Utils.Object.keyBy(u,"playerId");n.connectedPlayers=(0,Tn.TS)(e.connectedPlayers,b)}}}))},as),Cs={data:{},profileIds:[]},ws=((ss={})[ba]=function(e,t){return void 0===e&&(e=Cs),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.data,a=void 0===r?[]:r;if(t.type===Aa){var s=GameCore.Utils.Object.keyBy(a,"playerId"),o=Object.keys(s);n.data=(0,p.Z)({},e.data);for(var c=0,h=Object.keys(s);c<h.length;c++){var u=h[c];n.data[u]=s[u]}n.profileIds=[].concat(new Set([].concat(e.profileIds,o)))}}}))},ss),As={mode:"",status:Dn,rescued:0,startAt:0,finishAt:0},bs={single:{_id:"",data:{fen:""},playerId:"",status:Dn},group:{status:Dn,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:Dn,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:Dn,players:{}},updateAt:0,isRequesting:!1},Ss={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Ts=((os={})[$e]=(0,ts.UY)({gameplay:function(e,t){return void 0===e&&(e=As),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.mode,a=i.status;switch(t.type){case Ut:n.status=Dn,n.mode=As.mode,n.rescued=As.rescued,n.startAt=As.startAt,n.finishAt=As.finishAt,n.opponentInfo=As.opponentInfo;break;case Wt:n.mode=r,n.status=Ln,n.rescued=As.rescued,n.startAt=Date.now();break;case Ht:n.mode="string"===typeof r?r:e.mode,n.status=a||e.status;break;case Yt:n.status=Mn,n.finishAt=Date.now();break;case"MATCH_GAMEPLAY_RESCUE":n.rescued+=1}}}))},match:function(e,t){return void 0===e&&(e=bs),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.match,a=i.opponentInfo,s=i.players;switch(t.type){case Xt:case jt:case Qt:case en:case on:n.isRequesting=!0;break;case"MATCH_SINGLE_MOVE_UPDATED":n.single=(0,p.Z)({},e.single,r),n.updateAt=Date.now();break;case qt:n.isRequesting=!1,n.single=r||bs.single;break;case Jt:n.isRequesting=!1,n.single=bs.single;break;case $t:case tn:n.isRequesting=!0,n.challenge.opponentInfo=a;break;case nn:n.isRequesting=!1,n.challenge=(0,p.Z)({},r||bs.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case rn:n.isRequesting=!1,n.challenge=bs.challenge;break;case an:n.group.status=Ln,a&&(n.group.opponentInfo=a);break;case sn:n.group.status=Mn;break;case"MATCH_ONLINE_DATA_CLEAR":n.online.status=bs.online.status,n.online.players=bs.online.players;break;case cn:n.online.status=Ln,n.online.players=s;break;case"MATCH_ONLINE_FINISH_REQUEST":n.online.status=Mn}}}))},stats:function(e,t){return void 0===e&&(e=Ss),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.playerId,a=i.stats,s=i.match,o=i.current,c=i.players,h=i.leaders;switch(t.type){case zt:delete n.data[r],n.current=Ss.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=Ss.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=a,n.isRequesting=!1;break;case Kt:n.data[r]=a;break;case Vt:n.current=(0,Tn.TS)((0,p.Z)({},e.current),a);break;case cn:Object.keys(c).forEach((function(e){n.data[e]={score:0}}));break;case"MATCH_ONLINE_STATS_UPDATE":h.forEach((function(e){var t=e.playerId,i=e.score,r=e.rank;n.data[t]={score:i,rank:r}}));break;case nn:var u=s||{},l=u.blackPlayerId,d=u.blackPlayerScore,f=u.whitePlayerId,m=u.whitePlayerScore,g=u.whitePlayerLevel,v=u.blackPlayerLevel;if(!l||!f)break;o&&(n.current=o),n.data[l]={score:d,level:v},n.data[f]={score:m,level:g}}}}))}}),os),xs={active:!1,tournamentId:null,leaderboardId:null,bestSessionScore:0,isRequesting:!1},ks=((cs={}).tournament=function(e,t){return void 0===e&&(e=xs),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.score,a=void 0===r?0:r,s=i.tournamentId,o=i.leaderboardId;switch(t.type){case gt:n.active=!0,n.tournamentId=s,n.leaderboardId=o;break;case vt:n.isRequesting=!0;break;case yt:n.isRequesting=!1,a>e.bestSessionScore&&(n.bestSessionScore=a)}}}))},cs),Ps="leaderboards",Is="LEADERBOARD_DATA_REQUEST",Os="LEADERBOARD_DATA_UPDATE",Rs="LEADERBOARD_DATA_CLEAR",Bs={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},Ds=((hs={})[Ps]=function(e,t){return void 0===e&&(e=Bs),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.leaderboardId,a=i.type,s=i.limit,o=i.offset,c=i.leaders;switch(t.type){case Is:e.type!==a&&0===o&&(n.leaders=Bs.leaders),n.isRequesting=!0,n.leaderboardId=r,n.type=a,n.limit=s,n.offset=o;break;case Os:if(n.isRequesting=!1,e.type!==a)break;var h=GameCore.Utils.Json.clone((0,p.Z)({},e.leaders,c)),u=Object.values(h).filter((function(e){return!!e.name&&!!e.photo}));u.sort((function(e,t){return+t.score-+e.score})),u.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case Rs:n.isRequesting=!1,n.type=Bs.type,n.limit=Bs.limit,n.offset=Bs.offset,n.leaders=Bs.leaders,n.leaderboardId=Bs.leaderboardId}}}))},hs),Ls="missions",Ms="MISSIONS_DATA_REQUEST",_s="MISSIONS_DATA_RECEIVE",Ns="MISSION_UPDATE",Gs="MISSION_COMPLETED",Fs={mission:null,missions:null,isRequesting:!1},Zs=((us={})[Ls]=function(e,t){return void 0===e&&(e=Fs),(0,ns.ZP)(e,(function(n){var i,r,a=t.payload;if(a){var s=a.name,o=a.type,c=a.value,h=a.missions;switch(t.type){case Ms:n.isRequesting=!0;break;case _s:if(n.isRequesting=!1,h.length<1)return;n.missions={},h.forEach((function(e){n.missions[e.name]=e}));break;case"MISSION_START":if(null===e.missions)break;var u=e.missions[s];n.mission={name:s,process:{},require:u.require,reward:u.reward},Object.keys(u.require).forEach((function(e){n.mission.process[e]=0}));break;case Ns:if((null==(i=e.mission)?void 0:i.name)!==s)break;n.mission.process[o]+=c;break;case Gs:if((null==(r=e.mission)?void 0:r.name)!==s)break;n.mission=null}}}))},us),Us="dailyTasks",Ws="DAILY_TASKS_DATA_REQUEST",Ys="DAILY_TASKS_DATA_RECEIVE",Hs="DAILY_TASK_VALUE_ADD",zs="DAILY_TASK_FINISHED",Ks={tasks:[],process:[],isRequesting:!1,isNotice:!1},Vs=((ls={})[Us]=function(e,t){return void 0===e&&(e=Ks),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.id,a=i.type,s=i.value,o=i.tasks,c=i.process;switch(t.type){case Ws:n.isRequesting=!0;break;case Ys:n.isRequesting=!1,n.tasks=o;break;case"DAILY_TASKS_PROCESS_UPDATE":n.process=c;break;case Hs:if(!e.process[r])break;n.process[r][a]+=s;break;case"DAILY_TASK_REWARDED":if(!e.process[r])break;n.process[r].rewarded=!0;break;case"DAILY_TASKS_SEEN":n.isNotice=!1;break;case zs:n.isNotice=!0}}}))},ls),Xs="dailyRewards",js="DAILY_REWARDS_REQUEST",qs="DAILY_REWARDS_RECEIVE",Js={rewards:[],isRequesting:!1},Qs=((ds={})[Xs]=function(e,t){return void 0===e&&(e=Js),(0,ns.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.rewards;switch(t.type){case js:e.isRequesting=!0;break;case qs:e.isRequesting=!1,e.rewards=i}}}))},ds),$s=(0,ts.UY)((0,p.Z)({scene:function(e,t){return void 0===e&&(e=is),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.sceneKey;if(t.type===Bt.DW)n.currentSceneKey=r,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=ps),(0,ns.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,r=n.contextId,a=n.contextType,s=n.entryPointData;switch(t.type){case Bt.kL:e.contextId=r,e.contextType=a,e.entryPointData=s;break;case Bt.fJ:e.contextId=r,e.contextType=a,e.processed=!0;break;case Bt.EH:e.currentGameMode=i}}}))},messages:function(e,t){return void 0===e&&(e=ms),(0,ns.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.opponentId;if("string"===typeof r)switch(t.type){case Bt.qj:e.data[r]?n.data[r].sent=!0:n.data[r]={sent:!0};break;case Bt.rh:e.data[r]?n.data[r].sent=!1:n.data[r]={sent:!1}}}}))}},vs,Es,ws,Ts,ks,Ds,Zs,Vs,Qs)),eo=n(71),to=function(e){return(0,eo.xC)({reducer:$s,preloadedState:e,devTools:!0})},no=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).store=void 0,t.initiator=void 0,t.dispatch=function(e){return t.store.dispatch(e)},t.getState=function(){return t.store.getState()},t.subscribe=function(e){return t.store.subscribe(e)},t.watch=function(e,n){var i=es()((function(){var n=t.getState();return e(n)}));return t.subscribe(i((function(e){n(e)})))},t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.store=to({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initPlayerManually=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initiator.initPlayer();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),io=no,ro=n(66),ao=n.n(ro),so=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,f.Z)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}ao().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,r=e.fontWeight;return{google:{families:[i+":"+(void 0===r?400:r)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,r=document.createElement("style");document.head.appendChild(r);var a=r.sheet;if(a){var s="";switch(i){case"opentype":s=".otf";break;case"truetype":s=".ttf";break;case"woff":s=".woff"}var o='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+s+'") format("'+i+'"); }';a.insertRule(o,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),oo=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.addFont=function(e){var t=new so(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),co=oo,ho=n(28),uo={Mobile:{Background:["bg-0","bg-1","bg-2","bg-3","bg-4"],CardFace:["card-style-0","card-style-1","card-style-2"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4"]},Desktop:{Background:["bg-desktop-1","bg-desktop-1","bg-desktop-2","bg-desktop-3","bg-desktop-4"],CardFace:["card-style-0","card-style-desktop-0","card-style-2"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4"]}},lo=GameCore.ImageScale,po={Background:{File:"./assets/images/"+lo+"x/{}.jpg"},CardFaceAtlas:{Texture:"./assets/textures/"+lo+"x/{}.png",JSON:"./assets/textures/"+lo+"x/{}.json"}},fo=po.Background,mo=po.CardFaceAtlas,go=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.backgroundIdx=void 0,t.cardFaceIdx=void 0,t.cardBackIdx=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),this.events=new Phaser.Events.EventEmitter},n.getCurrentThemeResources=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx;return this.getThemeResources(t,n)},n.getThemeResources=function(e,t){var n=this.game.world.isLandscape()?uo.Desktop:uo.Mobile,i=n.Background[e]||n.Background[0],r=(0,ho.Z)(fo.File,[i]),a=n.CardFace[t]||n.CardFace[0];return{backgroundKey:i,backgroundFile:r,cardFaceKey:a,cardFaceTexture:(0,ho.Z)(mo.Texture,[a]),cardFaceJSON:(0,ho.Z)(mo.JSON,[a])}},n.getBackgroundConfigs=function(){return(this.game.world.isLandscape()?uo.Desktop:uo.Mobile).Background.map((function(e){return{key:e,url:(0,ho.Z)(fo.File,[e])}}))},n.getCardStyleAtlasConfigs=function(){return(this.game.world.isLandscape()?uo.Desktop:uo.Mobile).CardFace.map((function(e){return{key:e,textureURL:(0,ho.Z)(mo.Texture,[e]),atlasURL:(0,ho.Z)(mo.JSON,[e])}}))},n.getCurrentThemeConfig=function(){var e=this.backgroundIdx,t=this.cardFaceIdx,n=this.cardBackIdx;return this.game.world.isLandscape()?{backgroundKey:uo.Desktop.Background[e],cardFaceKey:uo.Desktop.CardFace[t],cardBackFrame:uo.Desktop.CardBack[n]}:{backgroundKey:uo.Mobile.Background[e],cardFaceKey:uo.Mobile.CardFace[t],cardBackFrame:uo.Mobile.CardBack[n]}},n.getCurrentIdxConfig=function(){var e=this.game.player.getPlayerSettings(),t=e.backgroundDesktopIdx,n=e.cardFaceDesktopIdx,i=e.cardBackDesktopIdx,r=e.backgroundIdx,a=e.cardFaceIdx,s=e.cardBackIdx;return this.game.world.isLandscape()?{backgroundIdx:t,cardFaceIdx:n,cardBackIdx:i}:{backgroundIdx:r,cardFaceIdx:a,cardBackIdx:s}},n.getThemePreview=function(){return this.game.world.isLandscape()?uo.Desktop:uo.Mobile},n.changeBackground=function(e){this.game.world.isLandscape()?this.game.player.setSetting("backgroundDesktopIdx",e):this.game.player.setSetting("backgroundIdx",e),this.backgroundIdx=e},n.changeCardFace=function(e){this.game.world.isLandscape()?this.game.player.setSetting("cardFaceDesktopIdx",e):this.game.player.setSetting("cardFaceIdx",e),this.cardFaceIdx=e},n.changeCardBack=function(e){this.game.world.isLandscape()?this.game.player.setSetting("cardBackDesktopIdx",e):this.game.player.setSetting("cardBackIdx",e),this.cardBackIdx=e},n.updateCurrentCardStyle=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx,i=e.cardBackIdx;this.setCurrentStyle(t,n,i)},n.setCurrentStyle=function(e,t,n){this.backgroundIdx=e,this.cardFaceIdx=t,this.cardBackIdx=n},t}(Phaser.Plugins.BasePlugin),vo=go,yo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).imageLoaded=new Map,t.currentBackgroundKey=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.setBackground=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBackgroundKey!=t){e.next=2;break}return e.abrupt("return");case 2:return this.currentBackgroundKey=t,e.next=5,this.preloadBackgroundAsync(t,n);case 5:r=null==(i=this.imageLoaded.get(t))?void 0:i.image,(s=document.getElementById("background"))&&(s.style.backgroundImage="url("+r.src+")");case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setBackgroundWithAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBackgroundKey!=t){e.next=2;break}return e.abrupt("return");case 2:return this.currentBackgroundKey=t,e.next=5,this.preloadBackgroundAsync(t,n);case 5:if(r=null==(i=this.imageLoaded.get(t))?void 0:i.image,s=document.getElementById("background"),o=document.createElement("div"),!s){e.next=15;break}return o.id="background",o.style.backgroundImage="url("+r.src+")",s.before(o),e.next=14,this.fadeOut(s,500);case 14:s.remove();case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.preloadBackgroundAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.imageLoaded.get(t)||null==(i=this.imageLoaded.get(t))||!i.loaded){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.abrupt("return",new Promise((function(e){var i=new Image;i.src=n;var a={url:n,image:i,loaded:!1};r.imageLoaded.set(t,a),i.onload=function(){a.loaded=!0,e()}})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.fadeOut=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i=0,r=setInterval((function(){i+=16;var a=Math.min(i/n,1);1===a&&(clearInterval(r),e()),t.style.opacity=""+(1-a)}),16)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),Eo=yo,Co=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).isVisible=!0,t.browserPrefixes=["moz","ms","o","","webkit"],t.visibleCallbacks=[],t.hiddenCallbacks=[],t.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?t.onVisibleEvent():t.onHiddenEvent();var n=t.getBrowserPrefix(),i=t.getHiddenPropertyName(n);return document[i]?t.onHiddenEvent():t.onVisibleEvent()},t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(){var e=this,t=this.getBrowserPrefix(),n=this.getVisibilityEvent(t);document.addEventListener(n,this.handleVisibilityChange,!1),document.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),document.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1),window.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),window.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),wo=Co,Ao=function(e){this.items=e},bo=[new Ao([{type:er.COIN,amount:2e3},{type:er.UNDO,amount:5},{type:er.PLUS_5_CARDS,amount:2},{type:ji.STORM,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new Ao([{type:er.COIN,amount:1500},{type:er.UNDO,amount:3},{type:er.PLUS_5_CARDS,amount:1},{type:ji.STORM,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new Ao([{type:er.COIN,amount:1e3},{type:er.UNDO,amount:2},{type:ji.STORM,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new Ao([{type:er.COIN,amount:500},{type:er.UNDO,amount:1},{type:ji.SLICE,amount:1},{type:ji.WILD_CARD,amount:1}]),new Ao([{type:er.COIN,amount:500}])];function So(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return To(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return To(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function To(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var xo=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),ko="tournament-time-out",Po="show-notification",Io="finish-tournament",Oo="tournament-requested",Ro={rank:-1,score:0},Bo=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).events=void 0,t.config=GameCore.Configs.WeeklyTournament,t.currentLeaderboardData=[],t.worldTournaments=[],t.currentTournament=void 0,t.status=xo.WAITING,t.playerProgress=(0,p.Z)({},Ro),t.playerTournamentData=void 0,t.leaderAchievementMap=new Map,t.isRefuseJoinTournament=!1,t.loadWorldTournamentsPromise=void 0,t.pushScorePromise=void 0,t.requestLeaderboardPromise=void 0,t.requestRequestLeaderboardRangesPromise=void 0,t.requestPlayerProgressPromise=void 0,t.requestLeaderAchievementPromise=void 0,t.requestDataAfterFinishGamePromise=void 0,t.requestDataStartGamePromise=void 0,t.tournamentIdFromPost=void 0,t.haveProgressUpdate=!1,t.needUpdatePlayerProgress=!0,t.oldProgress=(0,p.Z)({},Ro),t.isFirstTimePlayerGotoTop=!1,t.leaderboardRanges=[],t.isNeedLoadTopLeaders=!0,t.isHaveValidTournament=!1,t.notifyEvent=void 0,t.tournamentMode=void 0,t.totalLeaders=void 0,t.rewardRank=void 0,t.lastCallJoinTournament=void 0,t.callJoinTournamentCount=void 0,t.handleJoinTournament=function(){var e=(0,i.Z)(a().mark((function e(n){var i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.currentTournament){e.next=3;break}return e.abrupt("return","error");case 3:if(s=r.id.toString(),o=r.endTime,c=(null==(i=r.payload)?void 0:i.leaderboardId)||"",!t.isTournamentFinished()){e.next=12;break}return t.setStatus(xo.FINISHED),e.next=10,t.checkRewardPreviousTournament();case 10:if(!t.isPlayerProgressInValid()&&t.hasReward()){e.next=12;break}return e.abrupt("return","error");case 12:if(t.needUpdatePlayerProgress=!0,e.prev=13,t.isTournamentMode()){e.next=17;break}return e.next=17,t.game.facebook.tournament.joinAsync(s);case 17:if(t.game.storage.dispatch(wt(s,c)),n?t.game.storage.dispatch(Ei()):t.tournamentMode=!0,t.setStatus(xo.HAPPENING),t.hasPlayerJoined()&&!t.config.LeaderboardMockId){e.next=29;break}return t.pushScoreToLeaderboard(0),e.next=25,t.waitForSetScoreCompleted();case 25:return h=0===t.playerTournamentData.playerStartLevel?t.game.player.getLevel():t.playerTournamentData.playerStartLevel,t.updateWeeklyTournament({hasJoined:!0,tournamentId:s,leaderboardId:c,endTime:o,playerStartLevel:h,firstTimeShown:(new Date).getTime(),leaderboardShown:!0}),e.next=29,t.fetchPlayerData();case 29:return e.abrupt("return","success");case 32:if(e.prev=32,e.t0=e.catch(13),"USER_INPUT"!==(null==e.t0?void 0:e.t0.code)){e.next=37;break}return e.abrupt("return","close");case 37:throw e.t0;case 38:case"end":return e.stop()}}),e,null,[[13,32]])})));return function(t){return e.apply(this,arguments)}}(),t.isJoinFromPost=!1,t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.WeeklyTournament;var e=this.config.LeaderboardLimit;this.setTotalLeaders(e),this.rewardRank=this.createRewardArray(this.config.Rewards)},n.createRewardArray=function(e){var t=[];return Object.entries(e).forEach((function(e){var n=e[0],i=e[1],r=parseInt(n.replace("Top",""),10);if(!isNaN(r)&&i>0)for(var a=0;a<i;a++)t.push(r)})),t},n.initData=function(){var e=this;this.events=new Phaser.Events.EventEmitter,this.playerTournamentData=this.game.player.getWeeklyTournament(),this.updateData().then((function(){e.notifyEvent=!0,e.callJoinTournamentCount=0,e.events.emit(Oo)}))},n.popupJoinTournament=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.callJoinTournamentCount>=3)){e.next=2;break}return e.abrupt("return");case 2:if(!this.lastCallJoinTournament){e.next=7;break}if(t=(new Date).getTime(),!(t-this.lastCallJoinTournament<12e4)){e.next=7;break}return e.abrupt("return");case 7:if(this.hasPlayerJoined()){e.next=9;break}return e.abrupt("return");case 9:if(!this.isTournamentMode()){e.next=11;break}return e.abrupt("return");case 11:if(!(n=this.currentTournament)){e.next=26;break}return e.prev=13,r=n.id.toString(),s=(null==(i=n.payload)?void 0:i.leaderboardId)||"",e.next=18,this.game.facebook.tournament.joinAsync(r);case 18:return this.game.storage.dispatch(wt(r,s)),this.updateWeeklyTournament({hasJoined:!0}),e.next=22,this.setTournamentMode();case 22:e.next=26;break;case 24:e.prev=24,e.t0=e.catch(13);case 26:this.lastCallJoinTournament=(new Date).getTime(),this.callJoinTournamentCount+=1;case 28:case"end":return e.stop()}}),e,this,[[13,24]])})));return function(){return e.apply(this,arguments)}}(),n.update=function(){this.checkTimeOut(),this.notifyEvent&&this.events.emit(Po)},n.checkTimeOut=function(){this.isTournamentTimeOut()&&this.onTimeOut()},n.onTimeOut=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.updateData();case 4:this.notifyEvent=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPlayerHaveLeaderboardId()){e.next=26;break}if(!this.hasPlayerJoined()){e.next=16;break}if(this.isHaveValidTournament=!0,!this.isTournamentFinished()){e.next=12;break}return this.setStatus(xo.FINISHED),e.next=7,this.checkRewardPreviousTournament();case 7:if(!this.isPlayerProgressInValid()){e.next=10;break}return e.next=10,this.chooseNewTournament();case 10:e.next=14;break;case 12:this.setStatus(xo.HAPPENING),this.requestDataStartGame();case 14:e.next=24;break;case 16:if(!this.isTournamentFinished()){e.next=21;break}return e.next=19,this.chooseNewTournament();case 19:e.next=24;break;case 21:return this.setStatus(xo.WAITING),e.next=24,this.fetchCurrentHappeningTournament();case 24:e.next=28;break;case 26:return e.next=28,this.chooseNewTournament();case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.requestDataStartGame=function(){var e=this;return this.requestDataStartGamePromise=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchCurrentHappeningTournament();case 2:return t.next=4,e.requestPlayerProgress();case 4:e.needUpdatePlayerProgress=!1,e.isPlayerProgressInValid()&&e.chooseNewTournament();case 6:case"end":return t.stop()}}),t)})))().finally((function(){e.requestDataStartGamePromise=void 0})),this.requestDataStartGamePromise},n.isTournamentFinished=function(){var e=(new Date).getTime()/1e3,t=this.playerTournamentData.endTime<e;return t},n.isPlayerHaveLeaderboardId=function(){return""!=this.playerTournamentData.leaderboardId},n.hasPlayerJoined=function(){return""!=this.playerTournamentData.leaderboardId&&this.playerTournamentData.hasJoined},n.checkRewardPreviousTournament=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestPlayerProgress();case 2:if(-1!=this.playerProgress.rank){e.next=4;break}return e.abrupt("return");case 4:if(!(this.playerProgress.rank>this.rewardRank.length)){e.next=6;break}return e.abrupt("return");case 6:this.updateWeeklyTournament({hasReward:!0});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.fetchCurrentHappeningTournament=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentTournament){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadWorldTournaments();case 4:if(!(this.worldTournaments.length>0)){e.next=12;break}if(this.currentTournament=this.worldTournaments.filter((function(e){return e.id.toString()==t.playerTournamentData.tournamentId}))[0],this.isHaveValidTournament=!0,this.currentTournament){e.next=10;break}return e.next=10,this.chooseNewTournament();case 10:e.next=14;break;case 12:return e.next=14,this.chooseNewTournament();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.chooseNewTournament=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setStatus(xo.WAITING),e.next=3,this.loadWorldTournaments();case 3:(t=this.getValidTournaments()).length>0?(this.currentTournament=this.getAvailableTournament(t),this.updateWeeklyTournament({hasJoined:!1,leaderboardId:null==(n=this.currentTournament.payload)?void 0:n.leaderboardId,tournamentId:this.currentTournament.id.toString(),endTime:this.currentTournament.endTime}),this.setStatus(xo.WAITING),this.notifyEvent=!0,this.isHaveValidTournament=!0):(this.setStatus(xo.FINISHED),this.isHaveValidTournament=!1,this.events.emit(Oo));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getValidTournaments=function(){var e=this.worldTournaments.filter((function(e){return(0,me.s)(e.endTime).remainingTimeInMs>1e3}));return e},n.getAvailableTournament=function(e){var t=this;if(this.tournamentIdFromPost){var n=e.find((function(e){return e.id.toString()===t.tournamentIdFromPost}));if(n)return n}return e[Math.floor(Math.random()*e.length)]},n.loadWorldTournaments=function(){var e=this;return this.loadWorldTournamentsPromise=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.currentTournament||e.isPlayerProgressInValid()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,mt();case 5:e.worldTournaments=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),e.worldTournaments=[];case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))().finally((function(){e.loadWorldTournamentsPromise=void 0})),this.loadWorldTournamentsPromise},n.waitForLoadWorldTournamentsCompleted=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadWorldTournamentsPromise||Promise.resolve());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getMockAvatarInfo=function(e){return this.config.LeaderboardMockId?{name:"Leader "+e,photo:"https://reqres.in/img/faces/"+(Number.parseInt(e)+1)+"-image.jpg"}:{name:"Player",photo:"./assets/images/others/avatar.png"}},n.getLeadersWithProfiles=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.playerId})),e.next=3,this.game.profile.requestProfiles(n);case 3:return i=this.game.profile.getProfiles(),r=t.map((function(e){var t=e.playerId,n=e.score,r=e.rank,a=i[t],o=Number.parseInt(n.toString()),c=Number.parseInt(r.toString()),h=s.getMockAvatarInfo(t),u=(null==a?void 0:a.name)||h.name;return{playerId:t,photo:(null==a?void 0:a.photo)||h.photo,score:o,rank:c,name:u}})).filter((function(e){return null!==e})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestPlayerProgress=function(){var e=this;return this.requestPlayerProgressPromise=(0,i.Z)(a().mark((function t(){var n,i,r,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.playerTournamentData.leaderboardId){t.next=3;break}return t.abrupt("return");case 3:if(e.config.LeaderboardMockId&&(n=e.config.LeaderboardMockId),e.needUpdatePlayerProgress){t.next=6;break}return t.abrupt("return");case 6:if(!e.config.UseLeaderboardMock||e.config.LeaderboardMockId){t.next=13;break}return t.next=9,(0,me.qZ)(500);case 9:e.playerProgress.rank=3,e.playerProgress.score=100,t.next=32;break;case 13:return t.next=15,e.waitForSetScoreCompleted();case 15:return t.prev=15,t.next=18,Ge(n,e.game.player.getPlayerId());case 18:if(i=t.sent){t.next=23;break}return e.playerProgress.rank=-1,e.playerProgress.score=-1,t.abrupt("return");case 23:r=Number.parseInt((null==i?void 0:i.rank)||"-1"),s=Number.parseInt((null==i?void 0:i.score)||"-1"),-1!=r||-1!=s?(e.playerProgress.rank=r,e.playerProgress.score=s):r==Ro.rank&&s==Ro.score&&(e.playerProgress.rank=-1,e.playerProgress.score=-1),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(15),e.playerProgress.rank=-1,e.playerProgress.score=-1;case 32:e.needUpdatePlayerProgress=!1;case 33:case"end":return t.stop()}}),t,null,[[15,28]])})))().finally((function(){e.requestPlayerProgressPromise=void 0})),this.requestPlayerProgressPromise},n.checkRequestPlayerProgress=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=null==(t=this.currentLeaderboardData)?void 0:t.find((function(e){return e.playerId===i.game.player.getPlayerId()})))){e.next=6;break}this.playerProgress.rank=n.rank,this.playerProgress.score=n.score,e.next=8;break;case 6:return e.next=8,this.requestPlayerProgress();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.waitForSetScoreCompleted=function(){return this.pushScorePromise||Promise.resolve()},n.waitForRequestLeaderboardCompleted=function(){return this.requestLeaderboardPromise||Promise.resolve()},n.waitForRequestLeaderboardRangesCompleted=function(){return this.requestRequestLeaderboardRangesPromise||Promise.resolve()},n.waitForRequestPlayerProgressCompleted=function(){return this.requestPlayerProgressPromise||Promise.resolve()},n.waitForRequestDataFinishGameCompleted=function(){return this.requestDataAfterFinishGamePromise||Promise.resolve()},n.waitForRequestDataStartGameCompleted=function(){return this.requestDataStartGamePromise||Promise.resolve()},n.waitForRequestTopLeadersCompleted=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.pushScorePromise,this.requestLeaderboardPromise],n=t.filter((function(e){return void 0!=e})),e.abrupt("return",Promise.all(n).then((function(){})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getCurrentLeaderboardId=function(){var e,t=this.playerTournamentData.leaderboardId;t||(t=null==(e=this.currentTournament)||null==(e=e.payload)?void 0:e.leaderboardId);return t},n.requestLeaderboardRanges=function(e){var t=this;return this.requestRequestLeaderboardRangesPromise=(0,i.Z)(a().mark((function n(){var i,r,s,o,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=t.getCurrentLeaderboardId())&&-1!=e){n.next=3;break}return n.abrupt("return");case 3:if(t.config.LeaderboardMockId&&(i=t.config.LeaderboardMockId),!t.config.UseLeaderboardMock||t.config.LeaderboardMockId){n.next=10;break}return n.next=7,(0,me.qZ)(500);case 7:t.leaderboardRanges=t.getMockLeaderRanges(),n.next=26;break;case 10:return n.prev=10,r=t.totalLeaders,s=Math.max(e-1-Math.floor(r/2),0),n.next=15,dt(i,s,r);case 15:return o=n.sent,n.next=18,t.getLeadersWithProfiles(o);case 18:c=n.sent,t.leaderboardRanges=c,n.next=26;break;case 22:n.prev=22,n.t0=n.catch(10),t.leaderboardRanges=[];case 26:case"end":return n.stop()}}),n,null,[[10,22]])})))().finally((function(){t.requestRequestLeaderboardRangesPromise=void 0})),this.requestRequestLeaderboardRangesPromise},n.requestLeaderboardData=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.requestLeaderboardPromise=(0,i.Z)(a().mark((function e(){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isNeedLoadTopLeaders){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.waitForSetScoreCompleted();case 4:if(n=t.getCurrentLeaderboardId()){e.next=9;break}return t.isNeedLoadTopLeaders=!1,t.currentLeaderboardData=[],e.abrupt("return");case 9:if(t.config.LeaderboardMockId&&(n=t.config.LeaderboardMockId),!t.config.UseLeaderboardMock||t.config.LeaderboardMockId){e.next=16;break}return e.next=13,(0,me.qZ)(500);case 13:t.currentLeaderboardData=t.getMockLeaders(),e.next=30;break;case 16:return e.prev=16,e.next=19,t.getLeaderboardDataAsync(n);case 19:return i=e.sent,e.next=22,t.getLeadersWithProfiles(i);case 22:r=e.sent,t.currentLeaderboardData=r,e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),t.currentLeaderboardData=[];case 30:t.isNeedLoadTopLeaders=!1;case 31:case"end":return e.stop()}}),e,null,[[16,26]])})))().finally((function(){t.requestLeaderboardPromise=void 0})),e.abrupt("return",this.requestLeaderboardPromise);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getLeaderboardDataAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=this.totalLeaders),e.next=3,pt(t,{limit:n});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getLeaderboardData=function(){return this.currentLeaderboardData},n.getLeaderboardRanges=function(){return this.leaderboardRanges},n.isValid=function(){var e=this.game.player.getLevel()>=this.config.LevelStart,t=this.hasPlayerJoined(),n=e||t||this.isJoinFromPost;return this.config.Enable&&n&&this.isHaveValidTournament},n.canStartTournamentGame=function(){return this.isHappening()&&this.isTournamentMode()},n.join=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.hasPlayerJoined(),e.prev=1,e.next=4,this.handleJoinTournament(t);case 4:r=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),r="error";case 11:return"success"==r?i?this.logTournamentRejoin():this.logTournamentStart(n):"close"==r&&this.logTournamentRefuse(n,i),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),n.fetchPlayerData=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForSetScoreCompleted();case 2:return e.next=4,this.requestPlayerProgress();case 4:return t=this.config.LeaderboardMockId||this.playerTournamentData.leaderboardId,e.next=7,Ge(t,this.game.player.getPlayerId());case 7:e.sent&&(this.oldProgress={rank:10001,score:0}),this.requestLeaderboardRanges(this.playerProgress.rank);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setStatus=function(e){e!=this.status&&(this.status=e)},n.isHappening=function(){return this.isValid()&&this.status==xo.HAPPENING},n.isWaiting=function(){return this.isValid()&&this.status==xo.WAITING},n.isFinished=function(){return this.isValid()&&this.status==xo.FINISHED},n.hasReward=function(){return this.isValid()&&this.playerTournamentData.hasReward},n.restartTournament=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logTournamentEnd(),this.clearCurrentTournament(),e.next=4,Pi();case 4:return mi.instance.setGameMode(li.SINGLE),e.next=7,this.chooseNewTournament();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.onRefuse=function(){this.isRefuseJoinTournament=!0,this.setStatus(xo.WAITING)},n.isPlayerProgressInValid=function(){return!this.playerProgress||-1==this.playerProgress.rank||-1==this.playerProgress.score},n.canShowResultPreviousTournamentScreen=function(){var e=this.game.player.getLevel();return!(!this.config.Enable||!(e>=this.config.LevelStart||this.hasPlayerJoined()))&&(!this.isPlayerProgressInValid()&&!!this.hasPlayerJoinedFinishedTournament())},n.hasPlayerJoinedFinishedTournament=function(){return this.hasPlayerJoined()&&this.isTournamentFinished()},n.isTournamentTimeOut=function(){return this.isHappening()&&this.hasPlayerJoinedFinishedTournament()},n.canShowTournamentButton=function(){return this.isValid()},n.getMockLeaders=function(){var e=new Array(this.totalLeaders).fill(null).map((function(e,t){var n=t+1;return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:0,score:Math.floor(17*Math.random()*100/n)}}));e.sort((function(e,t){return t.score-e.score})),e.forEach((function(e,t){return e.rank=t+1}));var t=this.totalLeaders;if(3>this.totalLeaders&&this.totalLeaders<t)throw new Error("invalid mock player rank: 3");if(e.length>0&&3<=this.totalLeaders){e[2].name="You",e[2].playerId=this.game.player.getPlayerId(),e[2].photo="./assets/images/others/avatar.png"}return e},n.getMockLeaderRanges=function(){return this.getMockLeaders()},n.requestLeaderAchievements=function(){var e=this;return this.requestLeaderAchievementPromise=(0,i.Z)(a().mark((function t(){var n,i,r,s,o,c,h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLeaderboardData().map((function(e){return e.playerId})),i=e.game.player.getPlayerId(),(r=n.filter((function(t){return!e.leaderAchievementMap.has(t)}))).includes(i)||r.push(i),t.next=6,lt(r);case 6:for(s=t.sent,o=So(s);!(c=o()).done;)h=c.value,e.leaderAchievementMap.set(h.playerId,h.achievement);case 8:case"end":return t.stop()}}),t)})))().finally((function(){e.requestLeaderAchievementPromise=void 0})),this.requestLeaderAchievementPromise},n.getLeaderAchievement=function(e){if(this.leaderAchievementMap.has(e))return this.leaderAchievementMap.get(e)},n.updateWeeklyTournament=function(e){var t=this.playerTournamentData,n=(0,p.Z)({},t,e);this.playerTournamentData=n,this.game.player.updateWeeklyTournament(n)},n.getPlayerWeeklyTournamentData=function(){return this.playerTournamentData},n.setScore=function(e){this.oldProgress.score=this.playerProgress.score,this.playerProgress.score=e},n.setTournamentMode=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.tournamentMode=!1,t=window.game.facebook,e.next=5,t.getTournamentAsync().then((function(){n.tournamentMode=!0})).catch((function(){n.tournamentMode=!1}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.tournamentMode=!1;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n.getRank=function(){return this.playerProgress.rank},n.getScore=function(){return this.playerProgress.score},n.isPlayingTournament=function(){return this.isHappening()&&this.hasPlayerJoined()&&!this.isTournamentTimeOut()},n.isWeeklyTournamentTextureUrgent=function(){return this.canShowResultPreviousTournamentScreen()},n.handleNextLevel=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setScore(t),this.pushScoreToLeaderboard(this.playerProgress.score),e.next=4,this.waitForSetScoreCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestDataAfterFinishGame=function(){var e=this;return this.requestDataAfterFinishGamePromise=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isNeedLoadTopLeaders=!0,e.needUpdatePlayerProgress=!0,t.next=4,e.requestPlayerProgress();case 4:return e.isNewRankValidToHaveRankUpAnimation()&&e.requestLeaderboardData(),e.checkHaveProgressUpdate(),t.next=8,e.waitForRequestLeaderboardRangesCompleted();case 8:case"end":return t.stop()}}),t)})))().finally((function(){e.requestDataAfterFinishGamePromise=void 0})),this.requestDataAfterFinishGamePromise},n.getIsNeedLoadTopLeaders=function(){return this.isNeedLoadTopLeaders},n.pushScoreToLeaderboard=function(e){var t=this;void 0===e&&(e=0);var n=this.game.player.getPlayerId(),r=this.playerTournamentData.leaderboardId;return this.pushScorePromise=(0,i.Z)(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.config.LeaderboardMockId&&(r=t.config.LeaderboardMockId),i.next=3,ft(r,n,e).catch((function(e){(0,l.tO)(new Error(e))}));case 3:0!=e&&t.logTournamentPostScore();case 4:case"end":return i.stop()}}),i)})))().finally((function(){t.pushScorePromise=void 0})),this.pushScorePromise},n.joinFromPost=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tournamentIdFromPost=t,this.isJoinFromPost=!0,this.tournamentMode=!0,!this.playerTournamentData||!this.isValid()){e.next=8;break}return this.currentTournament=void 0,e.next=7,this.chooseNewTournament();case 7:this.join(!1,"SHARE_POST");case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.canUpdateOldProgress=function(){return this.haveProgressUpdate},n.isNewRankValidToHaveRankUpAnimation=function(){var e=this.oldProgress.rank,t=this.playerProgress.rank,n=this.totalLeaders;return t<e&&t<n},n.checkHaveProgressUpdate=function(){var e=this.oldProgress.rank,t=this.playerProgress.rank,n=this.totalLeaders;if(this.haveProgressUpdate&&t>=n)return this.haveProgressUpdate=!1,void(this.isFirstTimePlayerGotoTop=!1);this.haveProgressUpdate||-1==this.playerProgress.rank||(this.isFirstTimePlayerGotoTop=!1,this.isNewRankValidToHaveRankUpAnimation()&&t!=this.currentLeaderboardData.length&&(e>n&&(this.isFirstTimePlayerGotoTop=!0),this.haveProgressUpdate=!0))},n.canShowRankUpAnimation=function(){return this.haveProgressUpdate&&this.isHappening()},n.logTournamentStart=function(e){this.game.analytics.event(ae._.TOURNAMENT_START,{screen_name:e,level:this.game.player.getLevel(),tournament_id:this.playerTournamentData.tournamentId})},n.logTournamentEnd=function(){var e=this.game.player.getLevel()-this.playerTournamentData.playerStartLevel;this.game.analytics.event(ae._.TOURNAMENT_END,{rank:this.playerProgress.rank,level:this.game.player.getLevel(),milestone:e,score:this.playerProgress.score,tournament_id:this.playerTournamentData.tournamentId})},n.logTournamentShare=function(){this.game.analytics.event(ae._.TOURNAMENT_SHARE)},n.logTournamentPostScore=function(){this.game.analytics.event(ae._.TOURNAMENT_POST_SCORE)},n.logTournamentRefuse=function(e,t){this.game.analytics.event(ae._.TOURNAMENT_REFUSE,{screen_name:e,value:t})},n.logTournamentRejoin=function(){this.game.analytics.event(ae._.TOURNAMENT_REJOIN)},n.getRemainingTime=function(){var e=this.getPlayerWeeklyTournamentData().endTime;return(0,me.s)(e).remainingTimeInMs},n.getRemainingTimeString=function(){if(this.isFinished())return"Finished";var e=this.getPlayerWeeklyTournamentData().endTime,t=(0,me.s)(e),n=t.remainingTimeInDays,i=t.remainingTimeInMs;return n>=1?n+" "+(n>=2?"days":"day"):0==i?"Finished":""+(0,me.F0)(i,!0)},n.isTournamentMode=function(){return this.tournamentMode},n.getCurrentTournament=function(){return this.currentTournament},n.isLoadingTournaments=function(){return void 0!=this.loadWorldTournamentsPromise},n.debugRankUp=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestLeaderboardData();case 2:this.playerProgress.rank=this.playerProgress.rank-2,this.playerProgress.score=this.playerProgress.score+1e3,this.checkHaveProgressUpdate();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkNotifyEvent=function(){return this.notifyEvent},n.setNofityEvent=function(e){this.notifyEvent=e},n.setTotalLeaders=function(e){this.totalLeaders=e},n.getRewardData=function(e){var t=this.rewardRank[e-1];return bo[t-1].items},n.getTopByRank=function(e){return e>this.rewardRank.length?-1:this.rewardRank[e-1]},n.getLeaderboardId=function(){return this.hasPlayerJoined()?this.playerTournamentData.leaderboardId:""},n.getTotalLeaders=function(){return this.totalLeaders},n.clearCurrentTournament=function(){this.status,xo.WAITING,this.updateWeeklyTournament({hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1})},n.pushScoreToLeaderboardWithPlayerId=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return i=this.playerTournamentData.leaderboardId,this.config.LeaderboardMockId&&(i=this.config.LeaderboardMockId),e.next=6,ft(i,t,n).catch((function(e){(0,l.tO)(new Error(e))}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),Do=Bo,Lo=n(13),Mo=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.emit=function(t){return e.prototype.emit.call(this,t)},t}(Phaser.Events.EventEmitter),_o=Mo,No=20/9,Go=5/3,Fo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.previousLayout=void 0,t.resizeEventData=void 0,t.portraitRatio=void 0,t.portraitWidth=void 0,t.portraitHeight=void 0,t.landscapeRatio=void 0,t.landscapeWidth=void 0,t.landscapeHeight=void 0,t.worldWidth=void 0,t.worldHeight=void 0,t.worldRatio=void 0,t.autoResize=void 0,t.disableLandscape=void 0,t.fullSizeOnLandscape=void 0,t.currentLayout=void 0,t.forcePixelRatio=void 0,t.safeAreaBottom=void 0,t.bannerDisplaying=!1,t.handleResize=(0,Lo.D)((function(){t.calculateSafeAreaBottom(),t.resize(),t.events.emit("resize")}),100),t}(0,f.Z)(t,e);var n=t.prototype;return n.setBannerDisplaying=function(e){this.bannerDisplaying=e,this.updateAppSize(),this.resize()},n.configure=function(e){this.calculateSafeAreaBottom(),this.events=new _o;var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,r=e.portraitHeight,a=e.landscapeWidth,s=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,h=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=h,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=r,this.landscapeRatio=o,this.landscapeWidth=a;var u=Math.round(this.safeAreaBottom/this.getScreenHeight()*s);this.landscapeHeight=s+u,this.initWorldSize(),this.addEventResize()},n.calculateSafeAreaBottom=function(){try{this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.getSAB=function(){if("bottom"==this.game.ads.getBannerPosition())return 0;var e=this.game.world,t=e.getZoomRatio(),n=e.getPixelRatio();return Math.max((this.safeAreaBottom-8)*n/t,0)},n.getBannerHeight=function(){var e,t=GameCore.Configs.Ads.BannerAdOptions,n=50;GameCore.Utils.Device.isDesktop()?n=0:n=(null==(e=t.find((function(e){return"bottom"===e.position})))?void 0:e.bannerHeight)||50;return n},n.resize=function(e){var t=this;this.checkOrientation(),e&&e>0&&(this.forcePixelRatio=e),this.updateGameWrapper();var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,r=n.height;this.resizeCanvas(i,r),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),r=t.getWorldSize(),a=r.width,s=r.height;n.setZoom(i),n.centerOn(a/2,s/2)}}))},n.checkOrientation=function(){GameCore.Utils.Device.isDesktop()||(window.innerHeight/window.innerWidth<1.2?this.hideDiv("wrongRotation"):this.showDiv("wrongRotation"))},n.getCanvasSab=function(){var e=this.bannerDisplaying?this.getBannerHeight():0;return 0==e?0:"bottom"==this.game.ads.getBannerPosition()?this.safeAreaBottom+e:e},n.updateAppSize=function(){var e=window.document.getElementById("app"),t=this.getCanvasSab();e&&(e.style.height="calc(100% - "+t+"px)",e.style.width="100%")},n.updateGameWrapper=function(){var e=this.getValidScreenRatio(),t=this.getScreenWidth(),n=this.getScreenHeight(),i=t/n,r=window.document.getElementById("game-wrapper");if(i<e){var a=t,s=Math.round(a/e);r.style.height=s+"px",r.style.width=a+"px"}else{var o=n,c=Math.round(o*e);r.style.height=o+"px",r.style.width=c+"px"}this.events.emit(Va.Z.RESIZE)},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.getValidScreenRatio=function(){if(void 0!=this.worldRatio)return this.worldRatio;var e=this.getScreenRatio();return e>No?No:e<Go?Go:e},n.initWorldSize=function(){if(this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight,GameCore.layoutInitializer.isLandscape){if(!this.disableLandscape&&(this.landscapeRatio=Math.min(this.getScreenRatio(),No),this.landscapeRatio=Math.max(this.landscapeRatio,Go),this.worldHeight=this.landscapeHeight,this.worldWidth=this.worldHeight*this.landscapeRatio,this.currentLayout="landscape",this.fullSizeOnLandscape)){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=this.getScreenRatio();var e=this.getCanvasSizeFixedRatio(this.landscapeRatio),t=e.width,n=e.height,i=this.getZoomRatio();this.worldWidth=t/i,this.worldHeight=n/i}}else this.worldHeight=this.worldWidth/this.getScreenRatio();this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(GameCore.Utils.Device.isDesktop())return 2;var e=Math.round(GameCore.Utils.Device.pixelRatio());return e>2&&(e=2),e},n.getPixelRatioForCanvas=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;var e=GameCore.Utils.Device.pixelRatio();return e=GameCore.Utils.Device.isDesktop()?Phaser.Math.Clamp(e,1.5,2):Phaser.Math.Clamp(e,1,2.5)},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatioForCanvas(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){return window.document.getElementById("app").clientHeight||0},n.getScreenWidth=function(){return window.document.getElementById("app").clientWidth||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return!this.disableLandscape&&this.worldRatio>this.portraitRatio},n.getResizeEventData=function(){return this.resizeEventData},n.showDiv=function(e){var t=document.getElementById(e);t&&(t.style.display="block")},n.hideDiv=function(e){var t=document.getElementById(e);t&&(t.style.display="none")},t}(Phaser.Plugins.BasePlugin),Zo=Fo,Uo=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||fs.contextId,this.contextType=t||fs.contextType,this.entryPointData=n||fs.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),Wo={score:"score",settings:"settings",gameData:"gameData",userGuideDisplays:"userGuideDisplays"},Yo=GameCore.Configs.SyncProfileFromAPI,Ho=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),r=new Uo(e,n,i).toObject(),a=r.contextId,s=r.contextType,o=r.entryPointData;t.game.storage.dispatch(function(e,t,n){return{type:Bt.kL,payload:{contextId:e,contextType:t,entryPointData:n}}}(a,s,o))},this.initPlayer=(0,i.Z)(a().mark((function e(){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game.player,i=t.getPlayerInfo(),r=Object.values(Wo),e.next=5,FBInstant.player.getDataAsync(r);case 5:return s=e.sent,o=new Zr(s),e.next=11,t.maintainDataStructure(o);case 11:return o=e.sent,!0===o.toObject().settings.music&&window.game.audio.playMusic(),e.next=16,n.receiveData(i,o.convertToPlayerData());case 16:case"end":return e.stop()}}),e)}))),this.maintainDataStructure=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Yo){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced","customFields"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,!0!==(n.isSynced||!1)){e.next=12;break}return e.abrupt("return",t);case 12:if(i=n.customFields||!1){e.next=15;break}return e.abrupt("return",t);case 15:return(r=t.convertToPlayerData()).customFields=i,s=new Zr({}).convertToFacebookData(r),e.next=20,FBInstant.player.setDataAsync((0,p.Z)({},s,{isSynced:!0}));case 20:return e.abrupt("return",new Zr(s));case 23:return e.prev=23,e.t1=e.catch(0),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.GameSDK.player.getID(),t=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new Gn(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new se.Z(e,t,n,i).toObject()}catch(r){return new se.Z("123","You").toObject()}},this.game=e},zo=n(65),Ko=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).Text=void 0,t.Texture=void 0,t.FontSize=void 0,t.currentLocale=void 0,t.supportedLanguages=void 0,t.data=void 0,t.options=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.configure=function(e){this.applyOptions(e)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(e){void 0===e&&(e="en");var t=this.getCorrectLocale(e);this.currentLocale=t,this.Text=this.data[t].Text,this.Texture=this.data[t].Texture,this.FontSize=this.data[t].FontSize},n.getText=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,r=e.locale,a=void 0===r?this.currentLocale:r,s=this.getCorrectLocale(a),o=this.data[s].Text[t];return this.replaceVariables(o,i)}return this.Text[e]},n.getTexture=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,r=e.locale,a=void 0===r?this.currentLocale:r,s=this.getCorrectLocale(a),o=this.data[s].Texture[t];return this.replaceVariables(o,i)}return this.Texture[e]},n.getFontSize=function(e){try{var t=this.FontSize[e];if(t)return parseInt(t)}catch(n){}return 16},n.isSupportLanguage=function(e){return this.supportedLanguages.indexOf(e)>=0},n.applyOptions=function(e){this.options=(0,p.Z)({},e);var t=e.data,n=e.locale,i=void 0===n?"en":n,r=e.upperCaseText,a=void 0!==r&&r;this.data=t,this.supportedLanguages=Object.keys(t);var s=this.getCorrectLocale(i);if(this.currentLocale=s,this.Text=t[s].Text,this.Texture=t[s].Texture,this.FontSize=t[s].FontSize,a)for(var o in this.Text)this.Text[o]=this.Text[o].toUpperCase()},n.makeText=function(e,t){var n=t.maxWidth,i=void 0===n?Phaser.Math.MAX_SAFE_INTEGER:n,r=t.maxHeight,a=void 0===r?Phaser.Math.MAX_SAFE_INTEGER:r,s=t.align,o=void 0===s?"center":s,c=t.drawMaxBoxDebug,h=void 0!==c&&c,u=e.make.bitmapText(t);for("center"===o?u.setCenterAlign():"left"===o?u.setLeftAlign():"right"===o&&u.setRightAlign(),(t.text||"").indexOf(" ")>=0&&u.setMaxWidth(i);u.width>i||u.height>=a;)u.setFontSize(.95*u.fontSize);if(h&&GameCore.Utils.Valid.isDebugger()){var l=e.game.globalScene.add.graphics({lineStyle:{width:2,color:16711680}});l.setDepth(Phaser.Math.MAX_SAFE_INTEGER),e.game.globalScene.events.on(Phaser.Scenes.Events.UPDATE,(function(){if(l.clear(),u&&u.visible&&u.active){var e=u.getWorldPosition(),t=e.x,n=e.y;l.strokeRect(t-.5*i+(.5-u.originX)*u.width,n-.5*a+(.5-u.originY)*u.height,i,a)}}))}return u},n.setFontSize=function(e,t,n){var i=t||Phaser.Math.MAX_SAFE_INTEGER,r=n||Phaser.Math.MAX_SAFE_INTEGER;for((e.text||"").indexOf(" ")>=0&&e.setMaxWidth(i);e.width>i||e.height>=r;)e.setFontSize(.95*e.fontSize)},n.replaceVariables=function(e,t){var n=t.length;if(0==n)return e;var i=0;return e.replace(/{.*}/,(function(){return String(t[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(e){var t=e;return this.isSupportLanguage(e)||(t="en"),t},t}(Phaser.Plugins.BasePlugin),Vo={en:JSON.parse('{"Text":{"PLAY":"PLAY","play":"Play","missions":"Missions","getMoreCoins":"Get More Coins","watchGetCoinVideo":"Watch a video to get\\n300 coins","earnStar":"Beat levels to earn stars!","earnExtraCoins":"Earn Extra Coins","getMoreStars":"Get more stars","getNow":"Get Now","noThanks":"No, thanks","settings":"Settings","sound":"Sound","music":"Music","vibration":"Vibration","on":"ON","off":"OFF","endGame":"End Game","endGame2":"End game","quitLevel":"Are you sure you\\nwant to quit the level?","giveUp":"Are you sure you\\nwant to give up?","exit":"Exit","exitGame":"Exit Game?","playOn":"Play On","journey":"Journey","selectBoosters":"Select Boosters:","level":"Level","complete":"Complete!","removeThreeCards":"Removes three face up cards\\nat the start of the level.","removeAllCards":"Remove all face up cards\\non the playfield.","addThreeWildCards":"Add three Wild cards on the\\nplayfield at the start of the level.","slice":"Slice","storm":"Storm","wildDrop":"Wild Drop","replay":"REPLAY","bombDetonated":"Bomb detonated!","tipPlayBomb":"Tip: Play bomb cards faster\\nby using a wild card!","tapToSkip":"Tap to skip","tapToCollect":"Tap to collect","creditsCollected":"Credits collected","levelCleared":"Level cleared","youWon":"You Won","unlockAtLevel":"Unlock at level","claim":"Claim","dailyMissions":"Daily Missions","passLevels":"Pass 5 levels","clearCards":"Clear 60 cards","useWildCards":"Use 5 wild cards","tipPlayWildCard":"The Wild Card lets you play\\nany card on the board","free":"Free","loadingAds":"Loading ads...","loading":"Loading...","noAds":"No ads to display!","noRewards":"Sorry, No Rewards!\\nYou have cancelled the ad!","guideOne":"Tap a card one higher or\\none lower than the card at\\nthe bottom of the screen!","guideUndo":"You missed a playable card!\\nTap here to undo!","guideUndoPortrait":"You missed a playable card!\\nTap here to undo!","guideDrawStock":"No playable cards.\\nTap to deal a new card.","guideDrawStockPortrait":"No playable cards.\\nTap to deal a new card.","guideStreak":"Play multiple cards in a row\\nto fill up your streak meter\\nand win bonuses!","guideWildCard":"Let\'s you play any card\\non the board. Perfect for\\nextending a long streak!","guideWildCard2":"Tap an open card\\nto remove it!","guideLock":"Uncover the key\\nto unlock the pad lock","guideSliceBooster":"New!\\nRemove three face up cards\\nat the start of the level.\\nTry now!","guideStormBooster":"New!\\nRemove all face up cards\\non the playfield.\\nTry now!","guideWildCardBooster":"New!\\nAdd three Wild cards to the playfield\\nat the start of the level.\\nTry now!","guideSquirrel":"Feed the Squirrel\\nwith 3 Acorn cards!","guideChangerCard":"Very helpful:\\nThis card increases\\nits value by 1 each turn.","guideChainCard":"Play one of these cards\\nand the other one is played automatically","guideMysteryCard":"Uncover the surprise card\\nto find out what it holds","wellDone":"WELL DONE!","wellDone2":"Well Done!","super":"SUPER!","goodJob":"GOOD JOB!","fantastic":"FANTASTIC!","dailyBonus":"Daily Bonus","levelComplete":"Level Complete!","get":"Get","day":"Day","janeFarm":"Jane\'s Farm","cornField":"Corn Field","france":"France","greece":"Greece","england":"England","switzerland":"Switzerland","germany":"Germany","holland":"Holland","indonesia":"Indonesia","maldives":"Maldives","nepal":"Nepal","nevada":"Nevada","northAmerica":"North America","peru":"Peru","romania":"Romania","southAmerica":"South America","spain":"Spain","yemen":"Yemen"},"Texture":{"null":"null"},"FontSize":{"playButton":"30","day":"16","get":"16","free":"10","levelRibbon":"11","guide":"16","on":"12","off":"12","dailyMissions":"25","exitGameButton":"15","endGameButton":"11"}}'),ru:JSON.parse('{"Text":{"PLAY":"\u0418\u0413\u0420\u0410\u0422\u042c","play":"\u0418\u0433\u0440\u0430\u0442\u044c","missions":"\u041c\u0438\u0441\u0441\u0438\u044f","getMoreCoins":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435\\\\n\u043c\u043e\u043d\u0435\u0442","watchGetCoinVideo":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0432\u0438\u0434\u0435\u043e \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435\\n300 \u043c\u043e\u043d\u0435\u0442","earnStar":"\u041f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u0435 \u0443\u0440\u043e\u0432\u043d\u0438, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0437\u0432\u0451\u0437\u0434\u044b!","earnExtraCoins":"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u0439\u0442\u0435\\n\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u043e\u043d\u0435\u0442\u044b","getMoreStars":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0437\u0432\u0451\u0437\u0434","getNow":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\\n\u0441\u0435\u0439\u0447\u0430\u0441","noThanks":"\u041d\u0435\u0442, \u0441\u043f\u0430\u0441\u0438\u0431\u043e","settings":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","sound":"\u0417\u0432\u0443\u043a","music":"\u041c\u0443\u0437\u044b\u043a\u0430","vibration":"\u0412\u0438\u0431\u0440\u0430\u0446\u0438\u044f","on":"\u0412\u041a\u041b","off":"\u0412\u042b\u041a\u041b","endGame":"\u0412\u044b\u0439\u0442\u0438","endGame2":"\u0412\u044b\u0439\u0442\u0438","quitLevel":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435\\n\u043f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c?","giveUp":"\u0422\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\\\\n\u0445\u043e\u0447\u0435\u0448\u044c \u0441\u0434\u0430\u0442\u044c\u0441\u044f?","exit":"\u0412\u044b\u0439\u0442\u0438","exitGame":"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0438\u0433\u0440\u044b?","playOn":"\u0418\u0433\u0440\u0430\u0442\u044c\\n\u0434\u0430\u043b\u044c\u0448\u0435","journey":"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u0435","selectBoosters":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043a\u043e\u0440\u0438\u0442\u0435\u043b\u0438:","level":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c","complete":"\u041f\u0440\u043e\u0439\u0434\u0435\u043d!","removeThreeCards":"\u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u0442\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.","removeAllCards":"\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u043f\u043e\u043b\u0435.","addThreeWildCards":"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0438 \u043a\u0430\u0440\u0442\u044b \u0414\u0436\u043e\u043a\u0435\u0440\u0430\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.","slice":"\u0421\u0440\u0435\u0437\u0430\u0442\u044c","storm":"\u0428\u0442\u043e\u0440\u043c","wildDrop":"\u0414\u0436\u043e\u043a\u0435\u0440","replay":"\u041f\u041e\u0412\u0422\u041e\u0420","bombDetonated":"\u0411\u043e\u043c\u0431\u0430 \u0432\u0437\u043e\u0440\u0432\u0430\u043b\u0430\u0441\u044c!","tipPlayBomb":"\u0421\u043e\u0432\u0435\u0442: \u0420\u0430\u0437\u044b\u0433\u0440\u044b\u0432\u0430\u0439\u0442\u0435\\n\u043a\u0430\u0440\u0442\u044b-\u0431\u043e\u043c\u0431\u044b \u0431\u044b\u0441\u0442\u0440\u0435\u0435\\n\u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u0438\u043a\u0438\u0445 \u043a\u0430\u0440\u0442!","tapToSkip":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c","tapToCollect":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0431\u0440\u0430\u0442\u044c","creditsCollected":"\u041a\u0440\u0435\u0434\u0438\u0442\u043e\u0432 \u0441\u043e\u0431\u0440\u0430\u043d\u043e","levelCleared":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043f\u0440\u043e\u0439\u0434\u0435\u043d","youWon":"\u0412\u044b \u043f\u043e\u0431\u0435\u0434\u0438\u043b\u0438","unlockAtLevel":"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435","claim":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","dailyMissions":"\u0415\u0416\u0415\u0414\u041d\u0415\u0412\u041d\u042b\u0415 \u041c\u0418\u0421\u0421\u0418\u0418","passLevels":"\u041f\u0440\u043e\u0439\u0434\u0438\u0442\u0435 5 \u0443\u0440\u043e\u0432\u043d\u0435\u0439","clearCards":"\u0423\u0431\u0435\u0440\u0438\u0442\u0435 60 \u043a\u0430\u0440\u0442","useWildCards":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 5 \u0434\u0438\u043a\u0438\u0445 \u043a\u0430\u0440\u0442","tipPlayWildCard":"\u0414\u0438\u043a\u0430\u044f \u043a\u0430\u0440\u0442\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043b\u043e\u0436\u0438\u0442\u044c\\n\u043b\u044e\u0431\u0443\u044e \u043a\u0430\u0440\u0442\u0443 \u043d\u0430 \u0441\u0442\u043e\u043b","free":"\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e","loadingAds":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0435\u043a\u043b\u0430\u043c\u044b\u2026","loading":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...","noAds":"\u041d\u0435\u0442 \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430!","noRewards":"\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u043d\u0430\u0433\u0440\u0430\u0434 \u043d\u0435\u0442!\\n\u0412\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u043b\u0438 \u0440\u0435\u043a\u043b\u0430\u043c\u0443!","guideOne":"\u0412\u043d\u0438\u0437\u0443 \u044d\u043a\u0440\u0430\u043d\u0430 \u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0430 \u043a\u0430\u0440\u0442\u0430,\\n\u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0443\u044e \u0438\u043b\u0438\\n\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e \u0437\u0430 \u043d\u0435\u0439 \u043f\u043e \u0440\u0430\u043d\u0433\u0443!","guideUndo":"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u043a\u0430\u0440\u0442\u0443!\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u044e\u0434\u0430, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0445\u043e\u0434!","guideUndoPortrait":"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438\\n\u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u043a\u0430\u0440\u0442\u0443!\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u044e\u0434\u0430,\\n\u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0445\u043e\u0434!","guideDrawStock":"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043a\u0430\u0440\u0442.\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e.","guideDrawStockPortrait":"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445\\n\u043a\u0430\u0440\u0442. \u041d\u0430\u0436\u043c\u0438\u0442\u0435,\\n\u0447\u0442\u043e\u0431\u044b \u0441\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e.","guideStreak":"\u0420\u0430\u0437\u044b\u0433\u0440\u044b\u0432\u0430\u0439\u0442\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043a\u0430\u0440\u0442\\n\u043f\u043e\u0434\u0440\u044f\u0434 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0438\u0438\\n\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0431\u043e\u043d\u0443\u0441\u043e\u0432!","guideWildCard":"\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u044b\u0433\u0440\u0430\u0442\u044c\\n\u043b\u044e\u0431\u0443\u044e \u043a\u0430\u0440\u0442\u0443 \u0441\u0442\u043e\u043b\u0435.\\n\u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442\\n\u0434\u043b\u044f \u043f\u0440\u043e\u0434\u043b\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0438\u0438!","guideWildCard2":"\u041a\u043e\u0441\u043d\u0438\u0442\u0435\u0441\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u043a\u0430\u0440\u0442,\\n\u0447\u0442\u043e\u0431\u044b \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0445!","guideLock":"\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u043a\u043b\u044e\u0447, \u0447\u0442\u043e\u0431\u044b\\n\u043e\u0442\u043f\u0435\u0440\u0435\u0442\u044c \u0437\u0430\u043c\u043e\u043a","guideSliceBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0442\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideStormBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u043f\u043e\u043b\u0435.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideWildCardBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0438 \u043a\u0430\u0440\u0442\u044b \u0414\u0436\u043e\u043a\u0435\u0440\u0430 \u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u0435\\n\u043f\u043e\u043b\u0435 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideSquirrel":"\u041d\u0430\u043a\u043e\u0440\u043c\u0438\u0442\u0435 \u0431\u0435\u043b\u043a\u0443\\n3 \u043a\u0430\u0440\u0442\u0430\u043c\u0438 \u0441 \u0436\u0435\u043b\u0443\u0434\u044f\u043c\u0438!","guideChangerCard":"\u041f\u043e\u043b\u0435\u0437\u043d\u044b\u0439 \u0441\u043e\u0432\u0435\u0442:\\n\u0441 \u043a\u0430\u0436\u0434\u044b\u043c \u0445\u043e\u0434\u043e\u043c \u044d\u0442\u0430 \u043a\u0430\u0440\u0442\u0430\\n\u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0432\u043e\u0439 \u0440\u0430\u043d\u0433 \u043d\u0430 1.","guideChainCard":"\u0420\u0430\u0437\u044b\u0433\u0440\u0430\u0439\u0442\u0435 \u043e\u0434\u043d\u0443 \u0438\u0437 \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u0440\u0442,\\n\u0438 \u0434\u0440\u0443\u0433\u0430\u044f \u0440\u0430\u0437\u044b\u0433\u0440\u0430\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438","guideMysteryCard":"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043a\u0430\u0440\u0442\u0443-\u0441\u044e\u0440\u043f\u0440\u0438\u0437, \u0447\u0442\u043e\u0431\u044b\\n\u0443\u0437\u043d\u0430\u0442\u044c, \u0447\u0442\u043e \u043e\u043d\u0430 \u0441\u043e\u0431\u043e\u0439 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442","wellDone":"\u041c\u041e\u041b\u041e\u0414\u0415\u0426!","wellDone2":"\u041c\u043e\u043b\u043e\u0434\u0435\u0446!","super":"\u0421\u0423\u041f\u0415\u0420!","goodJob":"\u041e\u0422\u041b\u0418\u0427\u041d\u0410\u042f \u0420\u0410\u0411\u041e\u0422\u0410!","fantastic":"\u041f\u041e\u0422\u0420\u042f\u0421\u0410\u042e\u0429\u0415!","dailyBonus":"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439 \u0431\u043e\u043d\u0443\u0441","levelComplete":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u041f\u0440\u043e\u0439\u0434\u0435\u043d!","get":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","day":"\u0414\u0435\u043d\u044c","janeFarm":"\u0424\u0435\u0440\u043c\u0430 \u0414\u0436\u0435\u0439\u043d","cornField":"\u041a\u0443\u043a\u0443\u0440\u0443\u0437\u043d\u043e\u0435 \u041f\u043e\u043b\u0435","france":"\u0424\u0440\u0430\u043d\u0446\u0438\u044f","greece":"\u0413\u0440\u0435\u0446\u0438\u044f","england":"\u0410\u043d\u0433\u043b\u0438\u044f","switzerland":"\u0428\u0432\u0435\u0439\u0446\u0430\u0440\u0438\u044f","germany":"\u0413\u0435\u0440\u043c\u0430\u043d\u0438\u044f","holland":"\u0413\u043e\u043b\u043b\u0430\u043d\u0434\u0438\u044f","indonesia":"\u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u044f","maldives":"\u041c\u0430\u043b\u044c\u0434\u0438\u0432\u044b","nepal":"\u041d\u0435\u043f\u0430\u043b","nevada":"\u041d\u0435\u0432\u0430\u0434\u0430","northAmerica":"\u0421\u0435\u0432\u0435\u0440\u043d\u0430\u044f \u0410\u043c\u0435\u0440\u0438\u043a\u0430","peru":"\u041f\u0435\u0440\u0443","romania":"\u0420\u0443\u043c\u044b\u043d\u0438\u044f","southAmerica":"\u042e\u0436\u043d\u0430\u044f \u0410\u043c\u0435\u0440\u0438\u043a\u0430","spain":"\u0418\u0441\u043f\u0430\u043d\u0438\u044f","yemen":"\u0419\u0435\u043c\u0435\u043d"},"Texture":{"null":"null"},"FontSize":{"playButton":"28","day":"14","get":"11","free":"8","levelRibbon":"10","guide":"14","on":"9","off":"9","dailyMissions":"22","exitGameButton":"16","endGameButton":"12"}}')},Xo=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,(0,p.Z)({data:Vo,locale:"en",upperCaseText:!1},t))},t}(Ko),jo=Xo,qo=GameCore.Ads.Types,Jo=[ae._.SCREEN_OPEN,ae._.ECONOMY_TRACKING,ae._.ECONOMY_TRANSACTION],Qo=(function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,p.Z)({},n),"#E35335")||this).game=void 0,i.currentPath="/",i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i}(0,f.Z)(t,e);var n=t.prototype;n.processEvent=function(e,t,n){if(!(Jo.indexOf(e)>=0)){var i=this.formatEventName(e),r=t?(0,p.Z)({},t):{};r=n?(0,p.Z)({},r,{value:n}):r,r=(0,p.Z)({},r,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,r)}},n.processLevelStart=function(e,t,n){this.processEvent(ae._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(ae._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(ae._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(ae._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processLoadPreRollAd=function(e,t){var n=this.getEdaType(qo.PRE_ROLL);this.processEvent(ae._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowPreRollAd=function(e,t){var n=this.getEdaType(qo.PRE_ROLL);this.processEvent(ae._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(ae._.AD_IMPRESSION,{ad_format:n})},n.processLoadInterstitialAd=function(e,t){var n=this.getEdaType(qo.INTERSTITIAL);this.processEvent(ae._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowInterstitialAd=function(e,t){var n=this.getEdaType(qo.INTERSTITIAL);this.processEvent(ae._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(ae._.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processLoadRewardedVideoAd=function(e,t){var n=this.getEdaType(qo.REWARDED);this.processEvent(ae._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowRewardedVideoAd=function(e,t){var n=this.getEdaType(qo.REWARDED);this.processEvent(ae._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(ae._.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowBannerAd=function(e,t,n){var i=this.getEdaType(qo.BANNER);this.processEvent(ae._.AD_SHOW,{ad_type:i,banner_position:""+e,screen_name:""+t,ad_service:""+n})},n.processLoadAdFail=function(e){var t=e.type,n=e.placement,i=e.adService,r=this.getEdaType(t);this.processEvent(ae._.AD_LOAD_FAILED,{ad_type:r,screen_name:""+n,ad_service:""+i})},n.processShowAdFail=function(e){var t=e.type,n=e.placement,i=e.adService,r=e.bannerPosition,a={ad_type:this.getEdaType(t),screen_name:""+n,ad_service:""+i};t===qo.BANNER&&(a.banner_position=""+r),this.processEvent(ae._.AD_SHOW_FAILED,a)},n.processPageView=function(e){var t="/"+this.getGameplayMode()+"/"+e;this.currentPath=t,this.processEvent(ae._.PAGE_VIEW)},n.getGameplayMode=function(){var e=this.game.storage.getState();return Gt(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},n.getEdaType=function(e){switch(e){case qo.INTERSTITIAL:return"interstitial";case qo.PRE_ROLL:return"pre_roll";case qo.REWARDED:return"rewarded_video";case qo.BANNER:return"banner";default:return"unknown"}}}(GameCore.Analytics.BaseAnalytics),function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).startGame=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.auth.requestToken();case 3:return e.next=5,t.storage.syncStore();case 5:return t.configureSentry(),t.configureRollbar(),e.next=9,t.detectGameMode();case 9:t.handleYTAudioSync(),t.initGoogleAnalytics(),t.analytics.event(ae._.LOAD_START),t.scene.launch(le.C.GLOBAL_SCENE),t.scene.start(le.C.LOAD_SCENE),t.analytics.pageview(le.C.LOAD_SCENE),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,l.tO)(e.t0);case 20:return e.prev=20,t.facebook.progressLoading.finishLoadingProgressFbBootScene(),t.scene.sleep(le.C.BOOT_SCENE),e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[0,17,20,24]])}))),t}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var e=this.player.getPlayer();(0,l.Tv)({id:e.playerId,username:e.name})},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n(),r=Nt(i),s=window.game.player,o=s.getPlayerId(),c=r.contextId,h=r.entryPointData,l=(u=h||{}).type,d=u.matchId,p=u.playerId,f=u.opponentId,m=void 0===f?ce.playerId:f,g=o===p,v=m===ce.playerId,y=v||[m,p].includes(o),E=Dt,e.prev=10,e.next=13,window.game.facebook.getTournamentAsync();case 13:E=_t,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:c&&l===Je&&!g&&(E=Lt),d&&c&&y&&l===Qe&&(E=Lt),c&&"matching_group_match"===l&&(E=Mt),t(Zt(E));case 22:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initGoogleAnalytics=function(){},n.handleYTAudioSync=function(){var e=window.game.audio;window.GameSDK.isAudioEnabled()||(e.muteAll(),e.pauseAllSounds(),e.pauseMusic())},t}(Phaser.Scene)),$o=Qo,ec=n(53),tc=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).run=function(){t.scene.switch(le.C.GAME_SCENE)},t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("resume",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this)},t}(ec.Z);var nc=tc,ic=n(50),rc=n(54),ac=n(77);function sc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return oc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var cc=GameCore.Configs.LeadersBoard,hc=cc.UseMock,uc=cc.Limit,lc=cc.MockOptions,dc=function(e,t,n,r){return void 0===n&&(n=uc),void 0===r&&(r=0),function(){var s=(0,i.Z)(a().mark((function i(s){var o,c,h,u,d,p,f,m,g,v,y,E,C,w,A,b;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,o=window.game.player,c=o.getPlayerId(),s(fc()),s({type:Is,payload:{leaderboardId:e,type:t,limit:n,offset:r}}),!hc){i.next=11;break}return i.next=8,(0,me.qZ)(1e3);case 8:return h=new Array(n).fill(null).map((function(e,t){var n=(t+1)*(r+1),i=lc.PlayerEntryIndex===t,a={playerId:"0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)};if(i){var s=window.game.player.getPlayer(),o=s.playerId,c=s.name,h=s.photo;a.playerId=o,a.name=c,a.photo=h}return a})),s(pc(h,t)),i.abrupt("return");case 11:if(u=[],t!==Te){i.next=18;break}return i.next=15,Fe({limit:n,offset:r});case 15:u=i.sent,i.next=26;break;case 18:if(t!==xe){i.next=26;break}return(d=o.getConnectedPlayerIds(n,r)).push(c),p=GameCore.Utils.Array.unique(d),i.next=24,We({playerIds:p,limit:p.length});case 24:u=i.sent,p.forEach((function(e){var t=u.filter((function(t){return t.playerId===e}));t&&0!==t.length||u.push({playerId:e,score:0})}));case 26:for(f={},m=sc(u);!(g=m()).done;)v=g.value,y=v.playerId,E=v.score,C=v.rank,w=v.getPlayer(),A=w.getPhoto(),b=w.getName(),f[y]={playerId:y,name:b,photo:A,score:E,rank:C};s(pc(f,t)),i.next=36;break;case 32:i.prev=32,i.t0=i.catch(0),s(pc([],t)),(0,l.tO)(i.t0);case 36:case"end":return i.stop()}}),i,null,[[0,32]])})));return function(e){return s.apply(this,arguments)}}()},pc=function(e,t){return{type:Os,payload:{leaders:e,type:t}}},fc=function(){return{type:Rs,payload:{}}},mc=function(e){return e[Ps]},gc=((0,Q.P1)([function(e){return mc(e).leaderboardId}],(function(e){return e})),(0,Q.P1)([function(e){return mc(e).leaders}],(function(e){return e}))),vc=(0,Q.P1)([function(e){return mc(e).isRequesting}],(function(e){return e})),yc=n(1),Ec=n(84),Cc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),wc=function(e){if("string"!==typeof e||!e)throw new Cc(null,{imageShare:e})},Ac=(function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,r=n.getPlayer(),s=r.playerId,o=r.photo,c=Ac({playerId:s,playerPhoto:o})){e.next=6;break}return e.abrupt("return");case 6:return h={name:"share-best-score",width:750,height:1e3,renderOptions:c},e.next=9,i.frameCapture.capture(h);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,r=void 0===i?"":i;return"string"!==typeof n||"string"!==typeof r?null:{avatar:{name:""+n,type:"image",x:248,y:136,image:r,width:250,height:250,fallbackWithImage:oe.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:750,height:1e3}}}),bc=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,r=n.getPlayer(),s=r.playerId,o=r.photo,r.data,c=Sc({playerId:s,playerPhoto:o,playerScore:n.getLevel()})){e.next=6;break}return e.abrupt("return");case 6:return h={name:"share-best-score",width:952,height:492,renderOptions:c},e.next=9,i.frameCapture.capture(h);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Sc=(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,r=n.globalScene,s=bn(t),o=i.getPlayer(),c=o.playerId,h=o.photo,u=s[c]||{},l=u.score,d=Sc({playerId:c,playerPhoto:h,playerScore:l})){e.next=8;break}return e.abrupt("return");case 8:return p={name:"share-current-score",width:952,height:492,renderOptions:d},e.next=11,r.frameCapture.capture(p);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,r=void 0===i?"":i,a=e.playerScore,s=void 0===a?0:a;if("string"!==typeof n)return null;if("string"!==typeof r)return null;if("number"!==typeof s)return null;var o={position:{x:160,y:320},font:"680 40px",textAlign:"center",text:"Level "+s};return{playerScoreShadow:{type:"text",x:o.position.x+2,y:o.position.y+2,font:o.font,fillStyle:"rgba(0,0,0,0)",text:o.text,textAlign:o.textAlign},playerScore:{type:"text",x:o.position.x,y:o.position.y,font:o.font,fillStyle:"#a57a62",text:o.text,textAlign:o.textAlign},avatar:{name:""+n,type:"image",x:132,y:94,image:r,width:200,height:200,fallbackWithImage:oe.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492}}}),Tc=function(){return(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,r=t.facebook,s=t.globalScene,e.prev=1,s.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),e.next=5,xc();case 5:return o=e.sent,wc(o),c=n.getPlayer(),h=c.playerId,u=c.name,d=c.photo,e.next=10,r.shareAsync({text:"A ha, I'm the best!",intent:"CHALLENGE",image:o||"",data:{playerId:h,playerName:u,playerPhoto:d,type:Je}});case 10:i.event(ae._.SHARE,{share_content_type:"Leaderboard",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(ae._.SHARE,{share_content_type:"Leaderboard",success:!1}),(0,l.tO)(e.t0);case 17:return e.prev=17,s.screen.close(de.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))},xc=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C,w;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.profile,r=t.globalScene,s=n.getPlayer(),o=s.playerId,c=s.name,h=s.photo,(u=n.getConnectedPlayerIds(99,0)).push(o),l=[],e.next=7,We({playerIds:GameCore.Utils.Array.unique(u),limit:u.length});case 7:d=e.sent,p=GameCore.Utils.Object.keyBy(d,"playerId"),f={playerId:o,name:c,photo:h,score:0},GameCore.Utils.Object.hasOwn(p,o)&&(f=p[o]),l.push(f),e.t0=a().keys(p);case 14:if((e.t1=e.t0()).done){e.next=27;break}if(m=e.t1.value,!GameCore.Utils.Object.hasOwn(p,m)){e.next=25;break}if(g=p[m],3!==l.length){e.next=20;break}return e.abrupt("break",27);case 20:if(g.playerId!==o){e.next=22;break}return e.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(f.score))){e.next=24;break}return e.abrupt("continue",14);case 24:l.push(g);case 25:e.next=14;break;case 27:return v=GameCore.Utils.Array.unique(u),e.next=30,i.requestProfiles(v);case 30:if(y=i.getProfiles(),l.forEach((function(e,t){var n=e.playerId;if(GameCore.Utils.Object.hasOwn(y,n)){var i=y[n],r=i.name,a=i.photo;l[t].name=r,l[t].photo=a}})),l.length<3)for(E=0;E<=3-l.length;)l.push({playerId:"bot"+E,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),E++;if(C=kc({playerId:o,playerName:c,playerPhoto:h,listLeaders:l})){e.next=37;break}return e.abrupt("return");case 37:return w={name:"share-leaderboard",width:1500,height:2e3,renderOptions:C},e.next=40,r.frameCapture.capture(w);case 40:return e.abrupt("return",e.sent);case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),kc=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,r=void 0===i?"":i,a=e.listLeaders,s=void 0===a?[]:a;if(!Array.isArray(s))return null;if("string"!==typeof n)return null;if("string"!==typeof r)return null;var o={avatar:{name:""+n,type:"image",x:510,y:278,image:r,width:510,height:510,fallbackWithImage:oe.Z.AVATAR.KEY}};return s.forEach((function(e,t){var n=e.playerId,i=e.photo;o["photo_"+n]={name:""+n,type:"image",x:436,y:1294+180*t,image:i,width:96,height:96,fallbackWithImage:oe.Z.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},s.forEach((function(e,t){var n=e.playerId,i=e.name,r=e.score;o["name_"+n]={type:"text",x:600,y:1360+180*t,font:"600 48px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1e3,y:1360+180*t,font:"600 48px",text:r,fillStyle:"#b18151"}})),o},Pc=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,r=n.globalScene,s=bn(t),o=i.getPlayer(),c=o.photo,h=o.playerId,u=yn(t),l=u.playerId,d=u.photo,p=Cn(t,{playerId:h}),f=wn(t,{opponentId:l}),m=s[h]||{},g=m.score,v=s[l]||{},y=v.score,E=Ic({playerId:h,playerPhoto:c,playerScore:g,opponentId:l,opponentPhoto:d,opponentScore:y,isPlayerFinished:p,isOpponentFinished:f})){e.next=12;break}return e.abrupt("return");case 12:return C={name:"share-game-result",width:952,height:492,renderOptions:E},e.next=15,r.frameCapture.capture(C);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ic=(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,r=n.globalScene,s=bn(t),o=i.getPlayer(),c=o.photo,h=o.playerId,u=An(t),l=u.playerId,d=u.photo,p=u.score,f=s[h]||{},m=f.score,g=Ic({playerId:h,playerPhoto:c,playerScore:m,opponentId:l,opponentPhoto:d,opponentScore:p})){e.next=9;break}return e.abrupt("return");case 9:return v={name:"share-group-match-result",width:952,height:492,renderOptions:g},e.next=12,r.frameCapture.capture(v);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,r=void 0===i?"":i,a=e.playerScore,s=void 0===a?0:a,o=e.opponentId,c=void 0===o?"20":o,h=e.opponentPhoto,u=void 0===h?"":h,l=e.opponentScore,d=void 0===l?0:l,p=e.isPlayerFinished,f=e.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof r)return null;if("number"!==typeof s)return null;if("string"!==typeof c)return null;if("string"!==typeof u)return null;if("number"!==typeof d)return null;if("boolean"!==typeof p)return null;if("boolean"!==typeof f)return null;var m=s===d,g=s>d,v=p||f,y=p&&f,E={leftPhoto:{name:""+n,type:"image",x:60,y:31,image:r,width:165,height:165,fallbackWithImage:oe.Z.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:725,y:31,image:u,width:165,height:165,fallbackWithImage:oe.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(E.leftScoreShadow={type:"text",x:282,y:403,font:"600 50px",fillStyle:"#ffffff",text:p?""+s:"???",textAlign:"left"},E.leftScore={type:"text",x:665,y:403,font:"600 50px",fillStyle:"#ffffff",text:p?""+d:"???",textAlign:"right"}),!m&&y&&(g?E.leftCrown={name:"crown-icon",type:"image",x:93,y:164,image:"./assets/images/others/crown-icon.png",width:116,height:83}:E.rightCrown={name:"crown-icon",type:"image",x:682,y:163,image:"./assets/images/others/crown-icon.png",width:116,height:83}),E}),Oc=function(e){var t=e?e.split("_"):[],n=t.length>0?t[0]:"en_US";switch(n){case"id":case"in":n="id"}return n},Rc=n(14),Bc=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=i.scene.textures.get(e);n&&n.key===e?i.handleLoadComplete(e):(i.scene.load.once("filecomplete-image-"+e,i.handleLoadComplete),i.scene.load.image(e,t),i.scene.load.start())}},i.handleLoadComplete=function(e){if(i.scene){var t=i.payload,n=t.id,r=t.radius,a=void 0===r?0:r;if(n&&n===e){var s=n+"_bordered_"+a,o=a>0?s:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=a&&a<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:s,radius:a}))return void i.showLoading(!1);i.setPhoto(s)}else if(100==a){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:s}))return void i.showLoading(!1);i.setPhoto(s)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(e){e.key===i.payload.id&&i.setDefaultAvatar(e.key)},i.scene.add.existing((0,yc.Z)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var r=i.payload,a=r.id,s=r.url,o=r.radius;return a&&s&&i.loadPhoto(a,s,o),i.addDefaultListeners(),i}(0,f.Z)(t,e);var n=t.prototype;return n.setFrame=function(e){this.avtFrame.setFrame(e),this.avtFrame.setVisible(!0)},n.setBackground=function(e){this.background.setFrame(e)},n.loadPhoto=function(e,t,n){var i;if(void 0===n&&(n=0),this.payload.id=e,this.payload.url=t,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),e&&t){var r=this.scene.textures.get(e);if(r&&r.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var a=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(a,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(oe.Z.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,oe.Z.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var e=this.payload,t=e.key,n=e.background;this.background=this.scene.make.image({key:t,frame:n}),this.background.setDefaultWorldSize(),this.add(this.background)},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setWorldSize(.5*this.width,.5*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var e=this.payload,t=e.key,n=e.frame;e.width,e.height;n?(this.avtFrame=this.scene.make.image({key:t,frame:n}),this.avtFrame.setDefaultWorldSize()):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload,n=t.width,i=t.height,r=Math.min(n,i)-10;this.photo.setWorldSize(r,r),Phaser.Display.Align.In.Center(this.photo,this.background)},n.addBackground=function(){var e="avatar-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var r=this.scene.add.image(0,0,e);this.add(r)},t}(Phaser.GameObjects.Container),Dc=Bc,Lc=Ki.Z.DEFAULT,Mc=Lc.KEY,_c=Lc.FRAME,Nc=function(e){function t(t){var n;return(n=e.call(this,t,{key:Mc,frame:_c.AVATAR_FRAME_BLUE,background:_c.AVATAR_BG_BLUE,width:60,height:60})||this).scene=void 0,n.scene=t,n}return(0,f.Z)(t,e),t.prototype.setHighlight=function(e){e?(this.background.setFrame(_c.AVATAR_BG_YELLOW),this.avtFrame.setFrame(_c.AVATAR_FRAME_YELLOW)):(this.background.setFrame(_c.AVATAR_BG_BLUE),this.avtFrame.setFrame(_c.AVATAR_FRAME_BLUE))},t}(Dc),Gc=Nc,Fc=Ki.Z.DEFAULT,Zc=Fc.KEY,Uc=Fc.FRAME,Wc=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.avatar=void 0,i.block=void 0,i.rankIcon=void 0,i.rankText=void 0,i.playerScore=void 0,i.label=void 0,i.scene=t,i.createBlock(),i.createAvatar(),i.createRankIcon(),i.createRankText(),i.createLabel(),i.createPlayerScore(),n&&i.updateInfo(n),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=e,this.updateAvatar(),this.updateRankIcon(),this.updateRankText(),this.updatePlayerScore()},n.setLabel=function(e){this.label.setText(e)},n.setRank=function(e){this.rankText.setText(e)},n.setScore=function(e){this.playerScore.setText(e)},n.setHighlight=function(e){e?(this.y-=6,this.scale+=.1,this.label.scale+=.15,this.block.setFrame(Uc.BLOCK_LEADER_YELLOW)):(this.y+=6,this.scale-=.1,this.label.scale-=.15,this.block.setFrame(Uc.BLOCK_LEADER_BLUE)),this.avatar.setHighlight(e)},n.createBlock=function(){this.block=this.scene.make.image({key:Zc,frame:Uc.BLOCK_LEADER_BLUE}),this.block.setWorldSize(79,99),this.add(this.block)},n.createAvatar=function(){this.avatar=new Gc(this.scene),Phaser.Display.Align.In.TopCenter(this.avatar,this.block,0,this.avatar.displayHeight/2-4),this.add(this.avatar)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n,50)},n.getRankFrame=function(){var e=Uc.ICON_FLAG;switch(this.payload.rank){case 1:e=Uc.ICON_CUP_GOLD;break;case 2:e=Uc.ICON_CUP_SILVER;break;case 3:e=Uc.ICON_CUP_COPPER}return e},n.createRankIcon=function(){var e=Uc.ICON_FLAG;this.rankIcon=this.scene.make.image({key:Zc,frame:e}),e!=Uc.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),Phaser.Display.Align.In.Center(this.rankIcon,this.block,0,-15),this.add(this.rankIcon)},n.updateRankIcon=function(){var e=this.getRankFrame();this.rankIcon.setFrame(e),e!=Uc.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),Phaser.Display.Align.In.Center(this.rankIcon,this.block,0,-15)},n.createRankText=function(){this.rankText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"1"}),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,-2),this.add(this.rankText)},n.updateRankText=function(){this.rankText.setText(this.payload.rank.toString())},n.createLabel=function(){this.label=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(14),origin:{x:.5,y:0},text:"Play"}),Phaser.Display.Align.In.BottomCenter(this.label,this.block,0,-10),this.add(this.label)},n.createPlayerScore=function(){this.playerScore=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"132500"}),this.playerScore.setTint(5582186),Phaser.Display.Align.In.Center(this.playerScore,this.block,0,5),this.add(this.playerScore)},n.updatePlayerScore=function(){this.playerScore.setText(Math.floor(this.payload.score).toString())},(0,X.Z)(t,[{key:"onClick",set:function(e){var t=this.block,n=t.width,i=t.height;this.setSize(n,i+this.avatar.height),this.setInteractive({useHandCursor:!0}),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),Yc=Wc,Hc=n(48),zc=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).scene=void 0,r.payload=void 0,r.leaderBlocks=void 0,r.entrancesAnimation=void 0,r.listLeaderBlocks=void 0,r.handleChallengeFriend=function(e){return function(){r.scene.storage.dispatch(wi(e))}},r.handleShareLeaderboard=function(){r.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.BUTTON_CLICK),r.scene.storage.dispatch(Tc())},r.handleMatchingGroup=(0,i.Z)(a().mark((function e(){var t,n,i,s,o,c,h,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.scene,n=t.player,i=t.storage,s=t.game,o=t.facebook,e.prev=1,s.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:r.scene.lang.Text.loading,loading:!0}),c=n.getPlayer(),h="global","en"===(u=Oc(c.locale))&&(h="en"),"in"===u&&(h="in"),e.next=10,o.matchPlayerAsync(h,!0,!0);case 10:if(d=e.sent,s.globalScene.screen.close(de.o4.NOTIFY_SCREEN),d){e.next=14;break}return e.abrupt("return");case 14:i.dispatch(bi()),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(1),s.globalScene.screen.close(de.o4.NOTIFY_SCREEN),e.t0 instanceof Error&&(0,l.tO)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,17]])}))),r.scene=t,r.setName("LeadersBar"),r.listLeaderBlocks=[],r.createLeaderBlocks(),r.createEntrancesAnimation(),n&&r.updateInfo(n),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){var t=this;this.payload=e;var n=!1,i=this.payload,r=i.playerId;i.leaders.forEach((function(e){var i=t.leaderBlocks.getFirstDead(!0);i.updateInfo(e),-1===e.score?(i.setRank(""),i.setLabel("Join"),i.setScore("Global"),i.onClick=t.handleMatchingGroup):e.playerId===r?(i.setLabel("Share"),i.setHighlight(!0),i.onClick=t.handleShareLeaderboard):i.onClick=t.handleChallengeFriend(e.playerId),t.add(i),i.setVisible(!0),i.setActive(!0),t.listLeaderBlocks.indexOf(i)<0&&(n=!0)})),this.alignBlocks(),n&&(this.listLeaderBlocks=this.leaderBlocks.getChildren().filter((function(e){return e.active})),this.createEntrancesAnimation()),this.runAnimation()},n.killAndHideAll=function(){var e=this;this.removeAll(!1),this.leaderBlocks.getChildren().forEach((function(t){return e.leaderBlocks.killAndHide(t)}))},n.runAnimation=function(){this.leaderBlocks.setAlpha(0),this.entrancesAnimation.play()},n.createEntrancesAnimation=function(){this.entrancesAnimation=new Ec.Z({targets:this.listLeaderBlocks,delay:this.scene.tweens.stagger(50,{start:400}),props:{y:{from:100,to:0},alpha:{from:0,to:1}}})},n.alignBlocks=function(){var e=-(this.leaderBlocks.getLength()-1)/2*95;this.leaderBlocks.setX(e,95)},n.createLeaderBlocks=function(){this.leaderBlocks=this.scene.add.group({classType:Yc})},t}(Phaser.GameObjects.Container),Kc=zc,Vc=n(17),Xc=Ki.Z.DEFAULT,jc=Xc.KEY,qc=Xc.FRAME,Jc=function(e){function t(t){var n;return(n=e.call(this,t,jc,qc.BUTTON_YELLOW_CIRCLE,100.05,78.2)||this).scene=void 0,n.setName("Home"),n.scene=t,n.createIcon(),n}return(0,f.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:jc,frame:qc.ICON_FLAT_HOME});e.setSize(43,43).setDisplaySize(43,43),Phaser.Display.Align.In.Center(e,this.button),this.add(e)},t}(Vc.Z),Qc=Jc,$c=Ki.Z.DEFAULT,eh=$c.KEY,th=$c.FRAME,nh=function(e){function t(t){var n;return(n=e.call(this,t,eh,th.BUTTON_GREEN_SHORT,176,77.05)||this).scene=void 0,n.setName("PlayWithFriends"),n.scene=t,n.createLabel(),n}return(0,f.Z)(t,e),t.prototype.createLabel=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),text:"PLAY"});Phaser.Display.Align.In.Center(e,this.button,0,-12);var t=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"WITH FRIENDS"});Phaser.Display.Align.In.Center(t,this.button,0,11),this.add([e,t])},t}(Vc.Z),ih=nh,rh=Ki.Z.DEFAULT,ah=rh.KEY,sh=rh.FRAME,oh=function(e){function t(t){var n;return(n=e.call(this,t,ah,sh.BUTTON_YELLOW_CIRCLE,100.05,78.2)||this).scene=void 0,n.setName("Rank"),n.scene=t,n.createIcon(),n}return(0,f.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:ah,frame:sh.ICON_FLAT_RANK});e.setSize(43,43).setDisplaySize(43,43),Phaser.Display.Align.In.Center(e,this.button),this.add(e)},t}(Vc.Z),ch=oh,hh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.homeButton=void 0,n.rankButton=void 0,n.pwfButton=void 0,n.entrancesAnimation=void 0,n.runAnimation=function(){n.entrancesAnimation.play()},n.scene=t,n.setName("FooterBar"),n.createHomeButton(),n.createRankButton(),n.createPlayWithFriendsButton(),n.createEntrancesAnimation(),n.alignIcons(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createEntrancesAnimation=function(){this.entrancesAnimation=new Ec.Z({targets:[this],delay:800,props:{y:"-=5",alpha:{start:0,from:0,to:1}}})},n.alignIcons=function(){Phaser.Display.Align.In.Center(this.homeButton,this,-130,-6),Phaser.Display.Align.In.Center(this.pwfButton,this,0,-6),Phaser.Display.Align.In.Center(this.rankButton,this,130,-6)},n.createHomeButton=function(){this.homeButton=new Qc(this.scene),this.add(this.homeButton)},n.createRankButton=function(){this.rankButton=new ch(this.scene),this.add(this.rankButton)},n.createPlayWithFriendsButton=function(){this.pwfButton=new ih(this.scene),this.add(this.pwfButton)},t}(Phaser.GameObjects.Container),uh=hh,lh=n(58),dh=n(3),ph={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},fh=function(e){function t(t){return e.call(this,ph,t)||this}return(0,f.Z)(t,e),t}(dh.Z),mh=Ki.Z.DEFAULT,gh=mh.KEY,vh=mh.FRAME,yh=function(e){function t(t,n,i,r,a){var s;return(s=e.call(this,t,n,i)||this).barTopLeft=void 0,s.barTopMid=void 0,s.barTopRight=void 0,s.barMidLeft=void 0,s.barMidBg=void 0,s.barMidRight=void 0,s.barBottomLeft=void 0,s.barBottomMid=void 0,s.barBottomRight=void 0,s.setSize(r,a),s.setDepth(Ha.Z.POPUP),s.createPopup(),s.scene.add.existing((0,yc.Z)(s)),s}(0,f.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.barTopLeft=this.scene.add.image(0,0,gh,vh.POPUP_TOP_LEFT),this.barTopMid=this.scene.add.image(0,0,gh,vh.POPUP_TOP_MID),this.barTopRight=this.scene.add.image(0,0,gh,vh.POPUP_TOP_RIGHT),this.barMidLeft=this.scene.add.image(0,0,gh,vh.POPUP_MID_LEFT),this.barMidBg=this.scene.add.image(0,0,gh,vh.POPUP_MID_MID),this.barMidRight=this.scene.add.image(0,0,gh,vh.POPUP_MID_RIGHT),this.barBottomLeft=this.scene.add.image(0,0,gh,vh.POPUP_BOTTOM_LEFT),this.barBottomMid=this.scene.add.image(0,0,gh,vh.POPUP_BOTTOM_MID),this.barBottomRight=this.scene.add.image(0,0,gh,vh.POPUP_BOTTOM_RIGHT),this.barTopLeft.setWorldSize(65,48),this.barTopMid.setWorldSize(65,48),this.barTopRight.setWorldSize(65,48),this.barMidLeft.setWorldSize(65,48),this.barMidBg.setWorldSize(65,48),this.barMidRight.setWorldSize(65,48),this.barBottomLeft.setWorldSize(65,48),this.barBottomMid.setWorldSize(65,48),this.barBottomRight.setWorldSize(65,48),this.add([this.barTopRight,this.barTopMid,this.barBottomLeft,this.barBottomRight,this.barMidLeft,this.barMidRight,this.barTopLeft,this.barBottomMid,this.barMidBg])},n.updatePopupSize=function(){this.barTopMid.setWorldSize(this.width-129,this.barTopMid.height),this.barMidLeft.setWorldSize(this.barMidLeft.width,this.height-95),this.barMidBg.setWorldSize(this.width-129,this.height-95),this.barMidRight.setWorldSize(this.barMidRight.width,this.height-95),this.barBottomMid.setWorldSize(this.width-129,this.barBottomMid.height)},n.alignPopupImages=function(){Phaser.Display.Align.In.TopLeft(this.barTopLeft,this),Phaser.Display.Align.In.TopCenter(this.barTopMid,this),Phaser.Display.Align.In.TopRight(this.barTopRight,this),Phaser.Display.Align.In.LeftCenter(this.barMidLeft,this),Phaser.Display.Align.In.Center(this.barMidBg,this),Phaser.Display.Align.In.RightCenter(this.barMidRight,this),Phaser.Display.Align.In.BottomLeft(this.barBottomLeft,this),Phaser.Display.Align.In.BottomCenter(this.barBottomMid,this),Phaser.Display.Align.In.BottomRight(this.barBottomRight,this)},(0,X.Z)(t,[{key:"onClose",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),Eh=yh,Ch=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.mainText=void 0,i.shadowText=void 0,i.payload=n,i.createMainText(),i.createShadowText(),i.updateSize(),i.moveDown(i.shadowText),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.mainText.setText(e),this.shadowText.setText(e),this.updateSize()},n.setTintText=function(e,t,n,i){this.mainText.setTint(e,t,n,i)},n.setDropShadow=function(e,t,n,i){void 0===i&&(i=1),this.shadowText.setVisible(!0),this.shadowText.setTint(n),this.shadowText.setAlpha(i),Phaser.Display.Align.In.Center(this.shadowText,this.mainText,e,t)},n.updateSize=function(){var e=this.mainText,t=e.width,n=e.height;this.setSize(t,n)},n.createMainText=function(){this.mainText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:{x:.5,y:.5}}),this.add(this.mainText)},n.createShadowText=function(){this.shadowText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:{x:.5,y:.5},visible:!1}),this.add(this.shadowText)},t}(Phaser.GameObjects.Container),wh=Ch,Ah=n(83),bh=Ki.Z.DEFAULT,Sh=bh.KEY,Th=bh.FRAME,xh=function(e){function t(t){var n;return(n=e.call(this,t)||this).cat=void 0,n.effect=void 0,n.runStarTwinkle=function(){var e=n.cat,t=e.x,i=e.y,r=e.displayWidth,a=e.displayHeight,s=i-20;n.effect.run(1,t,s,r,a)},n.createEffect(),n.createCat(),n.runCatAnimation(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createCat=function(){this.cat=this.scene.make.image({key:Sh,frame:Th.THE_CAT,origin:{x:.5,y:1}}),this.cat.setWorldSize(204.5,112.5),this.cat.setY(this.cat.height/2),this.add(this.cat)},n.createEffect=function(){this.effect=new Ah.Z(this.scene),this.add(this.effect)},n.runCatAnimation=function(){new lh.Z({targets:[this.cat],duration:1e3,props:{scale:"+=0.02"}}).play()},t}(Phaser.GameObjects.Container),kh=xh,Ph=Ki.Z.DEFAULT,Ih=Ph.KEY,Oh=Ph.FRAME,Rh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScore=void 0,n.payload=void 0,n.theCat=void 0,n.popup=void 0,n.ribbon=void 0,n.yourScoreText=void 0,n.bestScoreText=void 0,n.currentScoreText=void 0,n.entrancesAnimation=void 0,n.scoreAnimation=void 0,n.counterAnimation=void 0,n.scene=t,n.bestScore=0,n.createPopup(),n.createTheCat(),n.createRibbon(),n.createYourScoreText(),n.createCurrentScore(),n.createBestScore(),n.createScoreAnimation(),n.createEntrancesAnimation(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){this.payload=e;var t=e.bestScore,n=e.currentScore;if(n<=t)return this.setBestScore(t),this.setCurrentScore(n),void this.runScoreAnimation();this.runAnimation()},n.runAnimation=function(){var e=this;this.runScoreCounter(),this.scene.time.delayedCall(1300,(function(){e.entrancesAnimation.play(),e.scene.audio.playSound(rc.Z.SCORE_COUNTER)}))},n.runScoreCounter=function(){var e,t=this,n=this.payload,i=n.bestScore,r=n.currentScore;null==(e=this.counterAnimation)||e.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:r,delay:500,duration:2e3,completeDelay:300,onUpdate:function(e){var n=Math.floor(e.getValue());t.runScoreAnimation(),t.setCurrentScore(n)},onComplete:function(){t.bestScore=i,t.setBestScore(i),t.setCurrentScore(r),t.counterAnimation.remove()}})},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.setBestScore=function(e){this.bestScoreText.setText("Best score: "+e)},n.setCurrentScore=function(e){this.currentScoreText.setText(""+e)},n.createPopup=function(){this.popup=new Eh(this.scene,0,0,284,240),this.add(this.popup)},n.createTheCat=function(){this.theCat=new kh(this.scene),Phaser.Display.Align.In.TopCenter(this.theCat,this.popup),this.add(this.theCat)},n.createRibbon=function(){this.ribbon=this.scene.make.image({key:Ih,frame:Oh.RIBBON_LONG}),this.ribbon.setSize(341,80).setDisplaySize(341,80),Phaser.Display.Align.In.Center(this.ribbon,this.theCat,0,93),this.add(this.ribbon)},n.createYourScoreText=function(){this.yourScoreText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5},text:"Your score"}),Phaser.Display.Align.In.Center(this.yourScoreText,this.ribbon,0,-10),this.add(this.yourScoreText)},n.createCurrentScore=function(){this.currentScoreText=new wh(this.scene,{font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(60)}),this.currentScoreText.setTintText(15779090,15779090,15704623,15704623),this.currentScoreText.setDropShadow(0,2,8804140),Phaser.Display.Align.In.Center(this.currentScoreText,this.popup,0,30),this.add(this.currentScoreText)},n.createBestScore=function(){this.bestScoreText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"Best score: "+this.bestScore}),this.bestScoreText.setTint(10494183),Phaser.Display.Align.In.BottomCenter(this.bestScoreText,this.popup,0,-25),this.add(this.bestScoreText)},n.createEntrancesAnimation=function(){this.entrancesAnimation=new lh.Z({targets:[this],repeat:0,duration:200,props:{scale:"+=0.03"}})},n.createScoreAnimation=function(){this.scoreAnimation=new fh({targets:[this.currentScoreText],props:{scale:{from:1,to:1.3}}})},t}(Phaser.GameObjects.Container),Bh=Rh,Dh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScoreBlock=void 0,n.scene=t,n.createBestScoreBlock(),n.scene.add.existing((0,yc.Z)(n)),n}return(0,f.Z)(t,e),t.prototype.createBestScoreBlock=function(){this.bestScoreBlock=new Bh(this.scene),this.add(this.bestScoreBlock)},t}(Phaser.GameObjects.Container),Lh=Dh,Mh=n(72),_h=n(51),Nh={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},Gh=function(e){function t(t){return e.call(this,Nh,t)||this}return(0,f.Z)(t,e),t}(dh.Z),Fh=n(85),Zh=n(86),Uh=Ki.Z.DEFAULT,Wh=Uh.KEY,Yh=Uh.FRAME,Hh=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).avatar=void 0,o.scoreText=void 0,o.shareButton=void 0,o.bigStarExplosive=void 0,o.open=function(t){e.prototype.open.call((0,yc.Z)(o),t);var n=o.getData("bestScore");o.setBestScore(n);var i=o.scene.player.getPlayer();o.avatar.loadPhoto(i.playerId,i.photo),o.runOpenAnimation(),o.scene.audio.playSound(rc.Z.CONGRATULATION)},o.handleClose=function(){o.scene.screen.close(o.name)},o.handleShareBestScore=function(){o.scene.storage.dispatch((0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,r=t.facebook,s=t.globalScene,e.prev=1,s.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),e.next=5,bc();case 5:return o=e.sent,wc(o),c=n.getPlayer(),h=c.playerId,u=c.name,d=c.photo,e.next=10,r.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:o||"",data:{playerId:h,playerName:u,playerPhoto:d,type:Je}});case 10:i.event(ae._.SHARE,{share_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(ae._.SHARE,{share_content_type:"BestScore",success:!1}),(0,l.tO)(e.t0);case 17:return e.prev=17,s.screen.close(de.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])}))))},o.runBigStarExplosive=function(){Phaser.Display.Align.In.Center(o.bigStarExplosive,o.scoreText),o.bigStarExplosive.run()},o.setDepth(de.Ks.POPUP),o.background.setAlpha(.8),o.createObjects(),o}(0,f.Z)(t,e);var n=t.prototype;return n.createObjects=function(){this.createTitle(),this.createClose(),this.createBestScoreTitle(),this.createPlayerAvatar(),this.createGlowEffect(),this.createBestScoreNumber(),this.createShareButton(),this.createStarTwinkleEffect(),this.createBigStarExplosive()},n.setBestScore=function(e){this.scoreText.setText(""+e)},n.createTitle=function(){var e=this.scene.make.image({key:Wh,frame:Yh.RIBBON_SMALL});e.setSize(162,36).setDisplaySize(162,36);var t=-90;Phaser.Display.Align.In.TopCenter(e,this.zone,0,t);var n=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:10,text:"Today Record"});t=-5,Phaser.Display.Align.In.Center(n,e,0,t),this.add([e,n])},n.createClose=function(){var e=new Vc.Z(this.scene,Wh,Yh.BUTTON_CLOSE,38,38);e.setName("Close"),this.add(e),Phaser.Display.Align.In.TopRight(e,this.zone,-60,-50),e.onClick=this.handleClose},n.createBestScoreTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:22,text:"Best Score"});this.add(e),e.setTint(13256697),Phaser.Display.Align.In.TopCenter(e,this.zone,0,-130)},n.createBestScoreNumber=function(){this.scoreText=new wh(this.scene,{font:Rc.ZP.PRIMARY.KEY,size:40}),this.add(this.scoreText),this.scoreText.setTintText(15911443,15911443,15902254,15902254),this.scoreText.setDropShadow(0,2,12871743),Phaser.Display.Align.In.TopCenter(this.scoreText,this.zone,0,-230)},n.createPlayerAvatar=function(){this.avatar=new Dc(this.scene,{key:Wh,frame:Yh.AVATAR_FRAME_YELLOW_BIG,background:Yh.AVATAR_BG_YELLOW_BIG,width:89,height:89}),this.avatar.background.setSize(89,95).setDisplaySize(89,95),this.avatar.photo.setSize(89,95).setDisplaySize(89,95),this.avatar.avtFrame.setSize(89,95).setDisplaySize(89,95),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this.zone,0,20)},n.createGlowEffect=function(){var e=Ki.Z.EFFECTS,t=e.KEY,n=e.FRAME,i=this.scene.make.image({key:t,frame:n.FX_GLOW_LIGHT});i.setWorldSize(246,246),this.add(i),this.moveDown(i),Phaser.Display.Align.In.Center(i,this.avatar),this.scene.tweens.add({targets:[i],duration:6e3,repeat:-1,props:{angle:360,scale:{value:"+=0.01",yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}})},n.createShareButton=function(){this.shareButton=new Fh.Z(this.scene,{key:Wh,button:Yh.BUTTON_BLUE,icon:Yh.ICON_FLAT_SHARE,text:"Share"},168,82.8),this.shareButton.setName("Share"),this.add(this.shareButton),Phaser.Display.Align.In.BottomCenter(this.shareButton,this.zone,0,-80),this.shareButton.onClick=this.handleShareBestScore},n.createStarTwinkleEffect=function(){var e=new Ah.Z(this.scene),t=this.scoreText,n=t.x,i=t.y;e.run(2,n,i,300,120)},n.createBigStarExplosive=function(){this.bigStarExplosive=new Zh.Z(this.scene)},n.runOpenAnimation=function(){this.runBigStarExplosive(),this.runScoreEntrancesAnimation(),this.runAvatarEntrancesAnimation(),this.runShareEntrancesAnimation()},n.runScoreEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.scoreText),new Gh({targets:[this.scoreText],duration:300,props:{y:{from:0,to:this.scoreText.y}}}).play()},n.runAvatarEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.avatar);var e=this.avatar.scale;new Mh.Z({targets:[this.avatar],duration:400,props:{scale:{from:0,to:e}}}).play()},n.runShareEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.shareButton),this.shareButton.setAlpha(0),new _h.Z({targets:[this.shareButton],delay:300}).play()},t}(GameCore.Screen),zh=Hh,Kh=GameCore.Configs.LeadersBoard,Vh=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).bestScore=void 0,t.currentScore=void 0,t.loading=void 0,t.leadersBar=void 0,t.footerBar=void 0,t.main=void 0,t.confettiLeftEffect=void 0,t.confettiRightEffect=void 0,t.run=function(){t.updateLeaders(),t.updateScore(),t.explodeConfettiEffect(),t.main.bestScoreBlock.counterAnimation&&t.main.bestScoreBlock.counterAnimation.state!==Phaser.Tweens.REMOVED?t.main.bestScoreBlock.counterAnimation.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.handleShowBestScorePopup(),t.handleShowResultChallengePopup()})):t.time.delayedCall(800,(function(){t.handleShowBestScorePopup(),t.handleShowResultChallengePopup()})),t.footerBar.setAlpha(0),t.footerBar.runAnimation(),t.audio.pauseAllMusics(),t.audio.playSound(rc.Z.GAME_OVER_SCENE)},t.runConfettiEffect=function(){var e=t.gameZone.displayWidth;t.confettiLeftEffect.stop(),t.confettiRightEffect.stop(),t.children.bringToTop(t.confettiLeftEffect),t.children.bringToTop(t.confettiRightEffect),t.confettiLeftEffect.run(1,0,-100),t.confettiRightEffect.run(1,0+e,-100),t.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var n,i,r=e.getValue()/100;null==(n=t.confettiLeftEffect.emitter)||n.setAlpha(r),null==(i=t.confettiRightEffect.emitter)||i.setAlpha(r)},onComplete:function(){var e,n;null==(e=t.confettiLeftEffect.emitter)||e.setAlpha(1),null==(n=t.confettiRightEffect.emitter)||n.setAlpha(1),t.confettiLeftEffect.stop(),t.confettiRightEffect.stop()}})},t.explodeConfettiEffect=function(){var e=t.gameZone.displayWidth,n=-100,i=e;t.tweens.addCounter({repeat:3,duration:500,onStart:function(){t.confettiLeftEffect.explode(6,0,n),t.confettiRightEffect.explode(6,0+i,n)},onRepeat:function(){t.confettiLeftEffect.explode(6,0,n),t.confettiRightEffect.explode(6,0+i,n)},completeDelay:7e3,onComplete:function(){t.tweens.addCounter({from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var n,i,r=e.getValue()/100;null==(n=t.confettiLeftEffect.emitter)||n.setAlpha(r),null==(i=t.confettiRightEffect.emitter)||i.setAlpha(r)},onComplete:function(){var e,n;null==(e=t.confettiLeftEffect.emitter)||e.setAlpha(1),null==(n=t.confettiRightEffect.emitter)||n.setAlpha(1),t.confettiLeftEffect.stop(),t.confettiRightEffect.stop()}})}})},t.handlePlayWithFriend=function(){t.storage.dispatch(Ai())},t.handleHomeClick=function(){t.scene.switch(le.C.DASHBOARD_SCENE)},t.handleLeaderboardClick=function(){t.scene.switch(le.C.LEADERBOARD_SCENE)},t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.events.on("resume",(function(){e.updateScore()})),this.events.on("sleep",(function(){e.storage.dispatch($n())})),this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.createBackground(oe.Z.BACKGROUND.KEY);this.bestScore=0,this.currentScore=0,this.createLoading(),this.createMain(),this.createLeadersBar(),this.createFooterBar(),this.createBestScoreScreen(),this.createConfettiSmallAnimation()},n.updateLeaders=function(){var e=this;this.leadersBar.killAndHideAll();var t=[{selector:vc,callback:function(t){if(!1===t){var n=window.game.player.getPlayerId(),i=e.getLeadersExcludeIds([n]);e.updateLeaderBar(i)}e.loading.setVisible(t)}}];this.handleStateChange(t),this.storage.dispatch(dc(Kh.LeaderboardId,xe,20))},n.getLeadersExcludeIds=function(e){var t=this.storage.getState(),n=gc(t),i={};if(!e||0===e.length)return n;for(var r in n)if(e.indexOf(r)<0){var a=n[r],s=a.playerId,o=a.photo,c=a.score,h=a.rank;i[r]={playerId:s,photo:o,score:c,rank:h}}return i},n.updateScore=function(){var e=this.storage.getState(),t=Sn(e),n=t.score,i=void 0===n?0:n,r=t.bestScore,a=void 0===r?0:r;this.bestScore=a<this.bestScore?this.bestScore:a,this.currentScore=i,this.main.bestScoreBlock.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.createLoading=function(){this.loading=new ic.Z(this),Phaser.Display.Align.In.Center(this.loading,this.gameZone,0,120)},n.createMain=function(){this.bestScore=0,this.main=new Lh(this),Phaser.Display.Align.In.TopCenter(this.main,this.gameZone,0,-230),this.main.bestScoreBlock.theCat.runStarTwinkle()},n.createLeadersBar=function(){this.leadersBar=new Kc(this),Phaser.Display.Align.In.Center(this.leadersBar,this.gameZone,0,120)},n.updateLeaderBar=function(e){var t={playerId:this.player.getPlayerId(),leaders:[]};for(var n in e){if(t.leaders.length>=3)break;var i=e[n],r=i.playerId,a=i.photo,s=i.score,o=i.rank;t.leaders.push({playerId:r,photo:a,score:s,rank:o})}t.leaders.push({playerId:oe.Z.ICON_EARTH.KEY,photo:oe.Z.ICON_EARTH.FILE,rank:4,score:-1}),this.leadersBar.updateInfo(t)},n.createFooterBar=function(){this.footerBar=new uh(this),Phaser.Display.Align.In.BottomCenter(this.footerBar,this.gameZone,0,-70),this.footerBar.homeButton.onClick=this.handleHomeClick,this.footerBar.pwfButton.onClick=this.handlePlayWithFriend,this.footerBar.rankButton.onClick=this.handleLeaderboardClick},n.createBestScoreScreen=function(){this.screen.add(de.o4.BEST_SCORE_SCREEN,zh)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new ac.Z(this,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new ac.Z(this,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Ha.Z.EFFECT),this.confettiRightEffect.setDepth(Ha.Z.EFFECT)},n.handleShowBestScorePopup=function(){this.currentScore>this.bestScore&&this.storage.dispatch(hi({bestScore:this.currentScore}));var e=this.storage.getState(),t=tt(e),n=[Dt,_t].indexOf(t)>=0;this.currentScore>this.bestScore&&n&&(this.screen.open(de.o4.BEST_SCORE_SCREEN,{bestScore:this.currentScore}),this.runConfettiEffect())},n.handleShowResultChallengePopup=function(){var e=this.storage.getState(),t=tt(e);if(-1!==[Lt,Mt].indexOf(t)&&gn(e)){var n=yn(e).playerId;t===Mt&&n===ce.playerId||(this.scene.pause(le.C.GAME_OVER_SCENE),this.scene.launch(le.C.RESULT_MATCH_SCENE))}},t}(ec.Z);var Xh=Vh,jh={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},USE_WILDCARDS:{ID:"use-wild-cards",EVENTS:{USE_WILDCARD:"USE_WILDCARD"}},CLEAR_CARDS:{ID:"clear-cards",EVENTS:{RESET:"RESET",CLEAR_CARDS:"CLEAR_CARDS"}},CHALLENGE_FRIENDS:{ID:"challenge-friends",EVENTS:{CHALLENGE_FRIENDS:"CHALLENGE_FRIENDS"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},qh=function(e){return e.VALUE="value",e.CHEESE="cheese",e.MOUSE="mouse",e.WILD="wild",e.PLUS="plus",e.SQUIRREL="squirrel",e.MYSTERIOUS="mysterious",e.UNKNOWN="value",e.CHAIN="chain",e.TREASURE="treasure",e}({}),Jh=function(e){return e.NORMAL="normal",e.HARD="hard",e.SUPER_HARD="superHard",e}({}),Qh=n(25),$h=new(n.n(Qh)()),eu=function(e){return e.NONE="none",e.INITIALIZED="initialized",e.DEALING="dealing",e.APPLYING_BOOSTERS="applying-boosters",e.IDLE="idle",e.DRAWING_STOCK="drawing-stock",e.DRAWING_PILE="drawing-pile",e.DRAWING_WILD_CARD="drawing-wild-card",e.DRAWING_FIRST_CARD="drawing-first-card",e.CHECKING_END_GAME="checking-end-game",e.NO_STOCK_CARDS="no-stock-cards",e.EXPLODING="exploding",e.GAME_WON="game-won",e.GAME_LOST="game-lost",e.UNDOING="undoing",e.PAUSING="pausing",e.PROCESSING_PURCHASE="processing-purchase",e}({}),tu=function(e){return e.START="start",e.DEAL="deal",e.APPLY_BOOSTERS="apply-boosters",e.DRAW_FIRST_CARD="draw-first-card",e.DRAW_STOCK="draw-stock",e.DRAW_PILE="draw-pile",e.DRAW_WILD_CARD="draw-wild-card",e.SHOW_HINT="show-hint",e.PILE_EMPTY="pile-empty",e.CHECK_END_GAME="check-end-game",e.BOMB_COUNTER_REACHED_ZERO="bomb-counter-reached-zero",e.NO_STOCK_CARDS="no-stock-cards",e.NO_VALID_MOVES="out-of-moves",e.REFILL_STOCK="refill-stock",e.LOSE="lose",e.UNDO="undo",e.OPEN_SETTINGS="open-settings",e.CLOSE_SETTINGS="close-settings",e.PURCHASE_UNDO="purchase-undo",e.PURCHASE_REFILL_STOCK="purchase-refill-stock",e.PURCHASE_REFILL_STOCK_WITH_ADS="purchase-refill-stock-with-ads",e.PURCHASE_WILD_CARD="purchase-wild-card",e.RESET="reset",e.EXIT="exit",e}({}),nu=function(e){return e.UNKNOWN="value",e.VALUE="value",e.KEY="key",e.LOCK="lock",e.ZAP="zap",e.BOOM="boom",e.JOKER="joker",e.CHESTNUT="chestnut",e.SQUIRREL="squirrel",e.PLUS_FIVE="wildcard-plus-5",e.PLUS_FOUR="wildcard-plus-4",e.PLUS_THREE="wildcard-plus-3",e.PLUS_TWO="wildcard-plus-2",e.PLUS_ONE="wildcard-plus-1",e.CHANGER="changer",e.CHAIN="chain",e.WINDMILL="windmill",e.MYSTERIOUS="mysterious",e.TREASURE="treasure",e.MAP_PIECE="map-piece",e}({}),iu=function(e){return e.BOMB="bomb",e.CHESTNUT="chestnut",e.INCREASE="increase",e.DECREASE="decrease",e.NONE="",e.CHAIN="chain",e.MAP_PIECE="map-piece",e}({}),ru=function(e){return e.None="None",e.Stock="stock",e.Waste="waste",e.Pile="pile",e.Combo="combo",e.Joker="joker",e.Foundation="foundation",e}(ru||{}),au=ru,su={DEPTH:{REMAINING_STOCK:12,HINT:11,CARD:1,WASTE_CARD:60,CARD_SLOT:9,MOVING_CARD:500},CARD_VIEW:{WIDTH:54,HEIGHT:77},CARD_BOUNDS:{WIDTH:50,HEIGHT:74},CARD_VIEW_OFFSET:{x:0,y:1},FOUNDATION_Y:70,VERTICAL_PILE_SPACE:24,MAX_HORIZONTAL_PILE_SPACE:62,SPACE_BETWEEN_PILE_AND_FOUNDATION:90,ROPE_SEGMENT_WIDTH:16,ROPE_SEGMENT_HEIGHT:6,NUMBER_OF_TARGET:4,NUMBER_OF_PILE:7,AUTO_MOVE_TIME:400},ou=function(e){su.FOUNDATION_Y=e},cu=function(e){return e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.JUSTIFY="justify",e}(cu||{}),hu=su,uu=Ki.Z.GAMEPLAY_DEFAULT.KEY,lu=function(e){function t(t,n){var i;(i=e.call(this,t,0,0,uu)||this).placement=void 0;var r=hu.CARD_VIEW,a=hu.DEPTH;return i.placement=n,i.setInteractive({useHandCursor:!0}),i.disableInteractive(),i.setAlpha(.6).setWorldSize(r.WIDTH,r.HEIGHT),i.setInteractive(),i.setDepth(a.CARD_SLOT),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.onClick=function(e){var t=!1;this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t=!0})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(function(){t&&e(),t=!1})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){t=!1}))},n.offClick=function(){this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT)},t}(Phaser.GameObjects.Image),du=lu,pu=function(e){function t(t){var n;return(n=e.call(this)||this).boardGame=void 0,n.scene=void 0,n.cards=[],n.x=void 0,n.y=void 0,n.name=void 0,n.boardGame=t,n.scene=t.scene,n.cards=[],n}(0,f.Z)(t,e);var n=t.prototype;return n.setName=function(e){this.name=e},n.getname=function(){return this.name},n.setPosition=function(e,t){this.x=e,this.y=t},n.addCard=function(e){0==this.cards.includes(e)&&this.cards.push(e)},n.addCardAt=function(e,t){void 0===t&&(t=0),0==this.cards.includes(e)&&this.cards.splice(t,0,e)},n.removeCard=function(e){var t=this.cards.indexOf(e);return t>=0&&(this.cards.splice(t,1),!0)},n.update=function(){},n.getPlacingPosition=function(){return{x:this.x,y:this.y}},n.clear=function(){this.cards=[]},n.isEmpty=function(){return 0===this.cards.length},n.getCardsLength=function(){return this.cards.length},t}(Phaser.Events.EventEmitter),fu=15,mu=Ki.Z.GAMEPLAY_DEFAULT,gu=mu.KEY,vu=mu.FRAME,yu=function(e){function t(t){var n;return(n=e.call(this,t)||this).maxCardsShow=void 0,n.alignTween=void 0,n.locked=void 0,n.lockedManual=void 0,n.slot=void 0,n.draw=function(){var e=(0,i.Z)(a().mark((function e(t){var i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),!n.locked&&!n.lockedManual){e.next=3;break}return e.abrupt("return");case 3:if((i=n.cards[n.cards.length-1])&&!i.isMoving){e.next=6;break}return e.abrupt("return");case 6:if(n.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.TAP_STOCK),(null==(r=n.boardGame.waste.getOnTopCard())?void 0:r.behavior.type)!==nu.JOKER){e.next=12;break}return s={x:0,y:60,background:{scaleX:1.05,scaleY:.8},textBox:{x:0,y:30,text:n.scene.lang.Text.tipPlayWildCard,textAlignType:cu.CENTER},icon:{x:0,y:-25,key:gu,frame:vu.TUTORIAL.TRIPLE_ARROW,visible:!0},backgroundInteractive:!0},n.scene.screen.open(de.o4.GUIDE_SCREEN,s),e.abrupt("return");case 12:return n.boardGame.hint.resetAutoHintTime(),n.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.DRAW_CARD),n.boardGame.hint.showMissPlay(),o=n.boardGame.gameplay.comboManager,400,c=n.boardGame.mover.moveToWaste({src:(0,yc.Z)(n),card:i,duration:400}),n.boardGame.mover.increaseMoves(),n.boardGame.mover.addUndoCard(i,au.Stock,au.Waste),0==i.isType(nu.WINDMILL)&&t&&o.reset(),h=n.animateAlignCards(),e.next=24,Promise.all([n.boardGame.onPlayerMove(),c,h]);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.maxCardsShow=16,n.setName(au.Stock),n.locked=!1,n.lockedManual=!1,n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){var e=this,t=new du(this.scene,this);t.setPosition(this.x,this.y),t.onClick((function(){e.boardGame.gameplay.enableCardInput&&e.boardGame.stateMachine.emit(tu.DRAW_STOCK)})),t.input.alwaysEnabled=!0,t.setVisible(!1),this.slot=t},n.lockDrawByTime=function(e){var t=this;this.setLocked(!1),this.scene.time.delayedCall(e,(function(){t.setLocked(!0)}))},n.setPosition=function(t,n){var i;e.prototype.setPosition.call(this,t,n),null==(i=this.slot)||i.setPosition(this.x,this.y)},n.setLocked=function(e){this.locked=e},n.setLockedManual=function(e){this.lockedManual=e},n.isLocked=function(){return this.isLocked()},n.addCardAt=function(e,t){if(void 0===t&&(t=0),0!=this.cards.includes(e))throw"Invalid operation";this.cards.splice(t,0,e),this.bringToTop()},n.bringToTop=function(){this.cards.forEach((function(e){e.behavior.bringToTop()}))},n.addCard=function(e){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.push(e)},n.align=function(){for(var e=this.cards.length,t=6*(e-1),n=0;n<e;n++){var i=this.cards[n];i.setVisible(n>=e-fu);var r=this.x+6*Math.max(n,e-fu)-t;i.setPosition(r,this.y),this.scene.gameplayLayer.bringToTop(i)}},n.animateAlignCards=function(){return this.moveToStep(0)},n.moveToStep=function(e){var t=this;this.setLocked(!0);var n=this.cards.length,i=this.scene.tweens.createTimeline({onComplete:function(){t.setLocked(!1),t.cards.forEach((function(t,i){t.setVisible(i+e>=n-fu)}))}}),r=this.x-6*(n-1);return this.cards.forEach((function(a,s){s+e>=n-fu&&a.setVisible(!0);var o=r+6*Math.max(s+e,n-fu);i.add({targets:a,x:o,y:t.y,duration:200,offset:0,ease:Phaser.Math.Easing.Sine.Out})})),i.play(),this.alignTween=i,i.waitForCompletion()},n.moveLeftCardStep=function(e,t){var n=this;this.setLocked(!0);var i=this.cards.length,r=this.scene.tweens.createTimeline({onComplete:function(){n.setLocked(!1),n.cards.forEach((function(e,n){e.setVisible(n+t>=i-fu)}))}}),a=this.x-6*(i-1);this.cards.forEach((function(e,s){s+t>=i-fu&&e.setVisible(!0);var o=a+6*Math.max(s+t,i-fu);r.add({targets:e,x:o,y:n.y,duration:200,offset:0,ease:Phaser.Math.Easing.Sine.Out})})),r.play()},n.getPosition=function(e){var t=this.cards.indexOf(e),n=this.cards.length;return{x:this.x-6*(n-1)+6*Math.max(t,n-fu),y:this.y}},n.clear=function(){e.prototype.clear.call(this)},t}(pu),Eu=function(e,t){var n=t.targets,i=t.duration,r=void 0===i?1e3:i,a=t.currentAngle,s=t.shakingAngle,o=void 0===s?15:s,c=t.onComplete,h=e.tweens.createTimeline(),u=r/4;return h.add({targets:n,duration:u,props:{angle:{from:a,to:a-o}},ease:Phaser.Math.Easing.Sine.InOut}),h.add({targets:n,duration:u/2,props:{angle:{from:a-o,to:a+o}},loop:1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),h.add({targets:n,duration:u,props:{angle:{from:a-o,to:a}},onComplete:c,ease:Phaser.Math.Easing.Sine.InOut}),h.play(),h},Cu=function(e){return e[e.ACE=1]="ACE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.NINE=9]="NINE",e[e.TEN=10]="TEN",e[e.JACK=11]="JACK",e[e.QUEEN=12]="QUEEN",e[e.KING=13]="KING",e}(Cu||{}),wu=function(e){return e[e.SPADES=1]="SPADES",e[e.CLUBS=2]="CLUBS",e[e.DIAMOND=3]="DIAMOND",e[e.HEART=4]="HEART",e}(wu||{}),Au=function(e){return e[e.BLACK=1]="BLACK",e[e.RED=2]="RED",e}(Au||{}),bu=Ki.Z.GAMEPLAY_OBJECTS,Su=bu.KEY,Tu=(bu.FRAME,function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.card=void 0,this.facingUp=void 0,this.type=void 0,this.value=void 0,this.suit=void 0,this.random=!0,this.effectedCard=void 0,this.keyUp=void 0,this.frameUp=void 0,this.keyDown=void 0,this.frameDown=void 0,this.flipMove=void 0,this.faceChangeCallbacks=void 0,this.facingTween=void 0,this.setFacing=function(e){t.facingUp=e,e?t.setFrameCardUp():t.setFrameCardDown()},this.scene=e.scene,this.boardGame=e.scene.gameplay.boardGame,this.card=e,this.type=nu.UNKNOWN,this.value=-1,this.suit=-1,this.flipMove=-1,this.faceChangeCallbacks=[]}var t=e.prototype;return t.setValue=function(e,t){this.value=e,this.suit=t,this.keyUp=Su,this.frameUp=this.getCardFrame(this.value,this.suit),this.type=nu.VALUE,this.random=!1},t.setFacingWithFlippingAnim=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=0),void 0===i&&(i=300),this.facingUp!==t){e.next=4;break}return e.abrupt("return");case 4:return t&&this.random&&this.checkCardHasValue()&&(o=this.boardGame.deck.getRandomValue(),(this.card.beginPlacement==au.Stock||this.card.beginPlacement==au.Pile)&&(o=this.boardGame.deck.getRandomValueByMatchRatio()),this.value=o.value,this.suit=o.suit,this.keyUp=Su,this.frameUp=this.getCardFrame(this.value,this.suit),this.random=!1),this.flipMove=this.boardGame.mover.getMoves(),this.facingUp=t,this.card.jump(10,i,0,n),c=i/2,null==(s=this.facingTween)||s.remove(),this.facingTween=this.card.scene.tweens.add({targets:this.card,scaleX:0,duration:c,delay:n}),e.next=13,this.facingTween.waitForCompletion();case 13:return t?this.setFrameCardUp():(this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.CLOSE_CARD),this.setFrameCardDown()),this.facingTween=this.card.scene.tweens.add({targets:this.card,scaleX:1,duration:c}),e.next=17,this.facingTween.waitForCompletion();case 17:r&&r(),this.faceChangeCallbacks.forEach((function(e){return e(t)}));case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),t.waitUntilFacingUp=function(){var e=this;return this.facingUp&&!this.facingTween.isPlaying()?Promise.resolve():new Promise((function(t){e.addFaceChangeListener((function n(i){i&&(t(),e.removeFaceChangeListener(n))}))}))},t.addFaceChangeListener=function(e){this.faceChangeCallbacks.push(e)},t.removeFaceChangeListener=function(e){this.faceChangeCallbacks=this.faceChangeCallbacks.filter((function(t){return t!==e}))},t.getCardFrame=function(e,t){return t==wu.HEART?"card/"+(e+400):t==wu.DIAMOND?"card/"+(e+300):t==wu.CLUBS?"card/"+(e+200):t==wu.SPADES?"card/"+(e+100):""},t.isRed=function(){return this.suit==wu.DIAMOND||this.suit==wu.HEART},t.init=function(){this.keyDown=Ki.Z.GAMEPLAY_OBJECTS.KEY,this.frameDown=Ki.Z.GAMEPLAY_OBJECTS.FRAME.CARD_BACK,this.setFrameCardDown();var e=hu.CARD_VIEW,t=e.WIDTH,n=e.HEIGHT;this.card.setSize(t,n),this.card.cardImage.setWorldSize(t,n),this.card.setInteractive({useHandCursor:!0}),this.card.disableInteractive(),this.flipMove=this.boardGame.mover.getMoves()},t.activate=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=!1),0==this.facingUp&&(this.setFacingWithFlippingAnim(!0),this.scene.tweens.addCounter({onUpdate:function(e){0==n.card.isOnAnimation()&&e.complete()}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.undo=function(){},t.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getPoints=function(e){void 0===e&&(e=!0);var t=hu.CARD_BOUNDS,n=t.WIDTH,i=t.HEIGHT,r=[],a=this.card.payload,s=a.x,o=a.y,c=new Phaser.Geom.Point(s,o);e||(c=new Phaser.Geom.Point(this.card.x,this.card.y));var h=new Phaser.Geom.Point(c.x-n/2,c.y-i/2),u=new Phaser.Geom.Point(c.x+n/2,c.y-i/2),l=new Phaser.Geom.Point(c.x-n/2,c.y+i/2),d=new Phaser.Geom.Point(c.x+n/2,c.y+i/2);r.push.apply(r,[h,u,d,l]);for(var p=0;p<4;p++){var f=Phaser.Math.DegToRad(this.card.payload.angle);Phaser.Math.RotateAround(r[p],c.x,c.y,f)}return r},t.onClick=function(){this.card.isMoving||this.facingUp||this.card.shake(8,800)},t.isPlusCard=function(){return this.type==nu.PLUS_ONE||this.type==nu.PLUS_TWO||this.type==nu.PLUS_THREE||this.type==nu.PLUS_FOUR||this.type==nu.PLUS_FIVE},t.checkCardHasValue=function(){return this.type==nu.VALUE||this.type==nu.CHESTNUT||this.type==nu.MAP_PIECE||this.type==nu.BOOM||this.type==nu.CHANGER||this.type==nu.CHAIN},t.updateSize=function(){this.card.setScale(1,1)},t.setFrameCardUp=function(){this.card.setCardFrame(this.keyUp,this.frameUp),this.facingUp=!0},t.setFrameCardDown=function(e,t){e&&(this.keyDown=e),t&&(this.frameDown=t),this.card.cardImage.setTexture(this.keyDown,this.frameDown),this.facingUp=!1},t.bringToTop=function(){this.scene.gameplayLayer.bringToTop(this.card.shadow),this.scene.gameplayLayer.bringToTop(this.card)},t.removeFromPile=function(e,t){void 0===e&&(e=au.Pile);var n=this.boardGame,i=n.pile,r=n.mover;i.removeCard(this.card),r.addUndoCard(this.card,au.Pile,e,t),this.type!==nu.WINDMILL&&$h.emit(jh.CLEAR_CARDS.EVENTS.CLEAR_CARDS,{type:"cards",value:1,card:this.card})},t.destroyItems=function(){},t.killItems=function(){},t.reviveItems=function(){},t.revive=function(){this.updateSize()},t.kill=function(){},t.hide=function(){this.card.setVisible(!1)},t.show=function(){this.card.setVisible(!0)},t.update=function(e){},t.postUpdate=function(){},e}()),xu=Tu,ku=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0,Ki.Z.GAMEPLAY_OBJECTS.KEY,"card-bg")||this).parent=void 0,i.scaleAnimation=void 0,i.moveAnimation=void 0,i.shadowDistance=1.2,i.updateFromParent=function(){i.setAngle(i.parent.angle),i.setAlpha(i.parent.alpha)},i.parent=n,i.setOrigin(.5,.5),i.updateFromParent(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.setScaleFromParent=function(e,t){this.setScale(e,t)},n.stopAnimation=function(){var e,t;null==(e=this.scaleAnimation)||e.stop(),null==(t=this.moveAnimation)||t.stop(),this.updateFromParent(),this.setPosition(this.parent.x,this.parent.y)},n.runAnimationFollow=function(e,t,n){var i=this;this.stopAnimation(),this.revive(),this.scaleAnimation=this.scene.tweens.addCounter({from:0,to:1,yoyo:!0,duration:e/2,delay:n,repeat:t,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(){i.updateFromParent()}}),this.moveAnimation=this.scene.tweens.add({yoyo:!0,duration:e/2,delay:n,repeat:t,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var t=e.getValue(),n=i.parent.x+t*i.shadowDistance,r=i.parent.y+t;i.parent.z=t,i.setPosition(n,r)},onComplete:function(){i.kill()}})},t}(Phaser.GameObjects.Image),Pu=ku,Iu=n(73),Ou=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).data=void 0,t}return(0,f.Z)(t,e),t.prototype.setData=function(e){this.data=e,this.value=e.value,this.suit=e.suit,this.keyUp=Ki.Z.GAMEPLAY_OBJECTS.KEY,this.frameUp=this.getCardFrame(this.value,this.suit),this.random=e.random},t}(xu),Ru=Ou,Bu=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.activate=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),n=this.boardGame.pile.handleWithLock(this.card),i=this.boardGame.mover.moveToWaste({src:this.boardGame.pile,card:this.card,duration:650,lockSegment:n}),this.card.emit(Iu.Z.MOVE_TO_WASTE),!t){e.next=7;break}return e.next=7,i;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Ru),Du=Bu,Lu=Ki.Z.GAMEPLAY_OBJECTS,Mu=Lu.KEY,_u=Lu.FRAME,Nu=function(e){return e[e.NORMAL=0]="NORMAL",e[e.WARNING=1]="WARNING",e[e.IN_DANGER=2]="IN_DANGER",e}(Nu||{}),Gu=function(e){function t(t){var n;return(n=e.call(this,t)||this).state=void 0,n.explodeCounter=void 0,n.bomb=void 0,n.firstDigit=void 0,n.secondDigit=void 0,n.digitContainer=void 0,n.line=void 0,n.bombContainer=void 0,n.glowRed=void 0,n.glowRedFront=void 0,n.glowBlack=void 0,n.glowAnimation=void 0,n.shakeBombAnimation=void 0,n.textAnimation=void 0,n.shakeBombTime=void 0,n.shakeBombCounter=void 0,n.fireParticles=void 0,n.initExplodeCounter=void 0,-1==t.payload.NumberOfMoves&&(t.payload.NumberOfMoves=Phaser.Math.Between(10,20)),n.explodeCounter=n.initExplodeCounter=t.payload.NumberOfMoves,n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.shakeBombTime=0,this.shakeBombCounter=0,this.createBomb(),this.createExplodeTime(),this.createBombContainer(),this.createGlowAnimation(600),this.createFireParticle(),this.glowAnimation.play(),this.state=Nu.NORMAL,this.type=nu.BOOM,this.updateDigits(this.explodeCounter),this.boardGame.stateMachine.on(tu.CHECK_END_GAME,this.evaluateExplode,this),e.prototype.init.call(this)},n.createBomb=function(){this.bomb=this.scene.add.image(0,0,Mu,_u.BOMB),this.bomb.setDefaultWorldSize(),this.line=this.scene.add.image(0,0,Mu,_u.LINE),this.line.setDefaultWorldSize(),this.glowRed=this.scene.add.image(0,0,Mu,_u.GLOW_RED),this.glowRed.setDefaultWorldSize(),this.glowRedFront=this.scene.add.image(0,0,Mu,_u.GLOW_RED_FRONT),this.glowRedFront.setDefaultWorldSize(),this.glowBlack=this.scene.add.image(0,0,Mu,_u.GLOW_BLACK),this.glowBlack.setDefaultWorldSize()},n.createExplodeTime=function(){this.secondDigit=this.scene.add.image(0,0,Mu,"bomb/0"),this.secondDigit.setScaleByWorld(.7),this.firstDigit=this.scene.add.image(0,0,Mu,"bomb/0"),this.firstDigit.setScaleByWorld(.7)},n.createBombContainer=function(){var e=hu.CARD_VIEW,t=e.WIDTH,n=e.HEIGHT;this.bombContainer=this.scene.add.container(0,0),this.digitContainer=this.scene.add.container(),this.digitContainer.add([this.firstDigit,this.secondDigit]),this.bombContainer.add([this.glowBlack,this.glowRed,this.bomb,this.glowRedFront,this.line,this.digitContainer]),Phaser.Display.Align.In.Center(this.glowRedFront,this.bombContainer,.5,0),Phaser.Display.Align.In.Center(this.glowBlack,this.bombContainer,0,1),Phaser.Display.Align.In.Center(this.glowRed,this.bombContainer,-1,3),Phaser.Display.Align.In.Center(this.bomb,this.bombContainer,0,-2),Phaser.Display.Align.To.TopCenter(this.line,this.bomb,5,-3),Phaser.Display.Align.In.Center(this.digitContainer,this.bombContainer,0,.5),Phaser.Display.Align.In.Center(this.firstDigit,this.digitContainer,-3.5,0),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,3.5,0),this.bombContainer.setPosition(t/2-this.bomb.width/2+5,n/2-this.bomb.height/2+5),this.card.add(this.bombContainer),this.bombContainer.kill(),this.glowRedFront.kill()},n.updateDigits=function(e){if(e>9){var t=e%10,n=Math.floor(e/10);this.secondDigit.setFrame("bomb/"+t),this.firstDigit.setFrame("bomb/"+n),this.firstDigit.revive(),Phaser.Display.Align.In.Center(this.firstDigit,this.digitContainer,-3.5,0),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,3.5,0)}else this.firstDigit.kill(),0==e?this.secondDigit.setFrame(_u.SKULL):this.secondDigit.setFrame("bomb/"+e),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,.5,0);var i,r,a;e>4&&this.state!=Nu.NORMAL&&(this.createGlowAnimation(600),null==(i=this.glowAnimation)||i.play(),this.state=Nu.NORMAL);4==e&&this.state!=Nu.WARNING&&(this.createGlowAnimation(600),null==(r=this.glowAnimation)||r.play(),this.shakeBombTime=3e3,this.shakeBombCounter=0,this.state=Nu.WARNING);e<=3&&this.state!=Nu.IN_DANGER&&(this.createGlowAnimation(300),null==(a=this.glowAnimation)||a.play(),this.shakeBombTime=1e3,this.shakeBombCounter=0,this.state=Nu.IN_DANGER);this.state===Nu.IN_DANGER?this.glowRedFront.revive():this.glowRedFront.kill()},n.setFrameCardUp=function(){var t;e.prototype.setFrameCardUp.call(this),this.bombContainer.revive(),null==(t=this.glowAnimation)||t.restart()},n.setFrameCardDown=function(t,n){var i,r;e.prototype.setFrameCardDown.call(this,t,n),null==(i=this.bombContainer)||i.kill(),null==(r=this.glowAnimation)||r.stop()},n.activate=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.killItems(),t.next=3,e.prototype.activate.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.evaluateExplode=function(){this.explodeCounter<=0&&(this.boardGame.stateMachine.emit(tu.BOMB_COUNTER_REACHED_ZERO),this.explode())},n.explode=function(){this.scene.vibration.performVibrating(150)},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.mover.getMoves(),!(this.explodeCounter<=0||t<=this.flipMove)){e.next=3;break}return e.abrupt("return");case 3:this.explodeCounter-=1,this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.BOMB_TICK,{rate:1.5},!0),this.runCounterAnimation(),this.explodeCounter<=0&&(this.runScaleUpBombAnim(),this.boardGame.pile.removeCard(this.card));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.undo=function(){var e;this.explodeCounter>=this.initExplodeCounter||(this.explodeCounter+=1,this.updateDigits(this.explodeCounter),this.shakeBomb(),this.bombContainer.revive(),null==(e=this.glowAnimation)||e.restart())},n.killItems=function(){var e,t=this;null==(e=this.glowAnimation)||e.stop(),this.scene.tweens.add({targets:[this.bombContainer],duration:300,ease:Phaser.Math.Easing.Sine.In,scale:0,onComplete:function(){t.bombContainer.kill(),t.bombContainer.setScale(1)}})},n.reviveItems=function(){var e;this.bombContainer.revive(),null==(e=this.glowAnimation)||e.restart(),this.scene.tweens.killTweensOf(this.bombContainer),this.bombContainer.setScale(0),this.scene.tweens.add({targets:[this.bombContainer],duration:300,ease:Phaser.Math.Easing.Sine.Out,scale:1})},n.update=function(e){this.explodeCounter<=4&&0!=this.shakeBombTime&&(this.shakeBombCounter+=e,this.shakeBombCounter>=this.shakeBombTime&&(this.shakeBomb(),this.shakeBombCounter=0))},n.hideUI=function(){var e=this.scene.gameUI;e.hideUI(),e.showCoin(),e.gameUILayout.hidePlusCardsButtons()},n.createGlowAnimation=function(e){var t,n;null==(t=this.glowAnimation)||t.stop(),null==(n=this.glowAnimation)||n.remove();var i=this.scene.tweens.create({targets:[this.glowRed,this.glowRedFront],alpha:{from:1,to:.5},duration:e,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut});this.glowAnimation=i},n.shakeBomb=function(){var e,t;if(null==(e=this.shakeBombAnimation)||!e.isPlaying()){null==(t=this.shakeBombAnimation)||t.stop();var n=this.scene.tweens.createTimeline();this.shakeBombAnimation=n;var i=this.bombContainer.angle;n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i,to:i-10}},ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i-10,to:i+10}},loop:1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i-10,to:i}},ease:Phaser.Math.Easing.Sine.InOut}),n.play()}},n.runCounterAnimation=function(){var e,t=this;if(null==(e=this.textAnimation)||!e.isPlaying()){var n=this.scene.tweens.createTimeline();this.textAnimation=n;n.add({targets:this.digitContainer,x:14,duration:350,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.digitContainer,x:{from:-14,to:0},duration:350,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){t.updateDigits(t.explodeCounter)},onUpdate:function(){t.updateDigits(t.explodeCounter)}}),n.add({targets:this.digitContainer,scaleX:0,duration:350,offset:0,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),n.play()}},n.createFireParticle=function(){var e=1/GameCore.ImageScale,t=new Phaser.Geom.Circle(0,0,0),n=this.scene.add.particles(Ki.Z.GAMEPLAY_OBJECTS.KEY);n.createEmitter({frame:Ki.Z.GAMEPLAY_OBJECTS.FRAME.SPARK_VFX,scale:{start:.7*e,end:0,ease:Phaser.Math.Easing.Expo.In},alpha:{start:1,end:0},rotate:{min:-50,max:50},speed:{min:5,max:15},frequency:30,lifespan:{min:300,max:400},emitZone:{type:"random",source:t}}),this.bombContainer.add(n),n.setPosition(4.5,-21.5),this.fireParticles=n},n.runScaleUpBombAnim=function(){var e=this;this.scene.gameplayLayer.bringToTop(this.card);var t=0;this.scene.tweens.addCounter({from:1,to:7,duration:1e3,ease:Phaser.Math.Easing.Linear,onUpdate:function(n){n.getValue()>=t+1&&(t+=1,e.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.BOMB_TICK,{},!0))}});var n=this.scene.tweens.createTimeline();n.add({targets:this.bombContainer,scale:3,duration:1200,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,alpha:0,duration:400,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){e.card.kill(),e.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.EXPLODE),e.hideUI(),e.boardGame.blowCardsBehavior.blow(e.card.x,e.card.y).then((function(){e.scene.screen.open(de.o4.NOTIFY_BOMB_SCREEN)}))}}),this.shakeBomb(),n.play()},n.explodeCards=function(){var e=this,t=this.boardGame,n=t.pile,i=t.waste,r=t.stock,a=[].concat(n.cards),s=this.scene.world.getWorldSize(),o=s.width,c=s.height;a.forEach((function(t){t.behavior.killItems();var n=new Phaser.Math.Vector2(t.x-e.card.x,t.y-e.card.y);n.normalize();var i=t.x,r=t.y;n.x>0&&(i=o-t.x),n.y>0&&(r=c-t.y);var a=Math.sqrt(Math.pow(i,2)+Math.pow(r,2))+100;n.multiply({x:a,y:a}),t.move({x:t.x+n.x,y:t.y+n.y,duration:Phaser.Math.Between(1500,2e3)})}));var h=[].concat(i.cards,r.cards);h.forEach((function(e){e.move({x:e.x,y:c+100,duration:Phaser.Math.Between(1500,2e3)})})),this.scene.tweens.add({targets:h,alpha:0,duration:500}),a.push.apply(a,h);var u=this.scene.tweens.timeline(),l=1e3;u.add({targets:a,angle:function(){return Phaser.Math.Between(-180,-90)},duration:l,onYoyo:function(){a.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.add({targets:a,scaleX:0,yoyo:!0,offset:0,duration:250,onYoyo:function(){a.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.add({targets:a,scaleX:0,yoyo:!0,duration:500,offset:500,onYoyo:function(){a.forEach((function(e){if(e.behavior.checkCardHasValue()&&e.behavior.random){var t=Phaser.Math.Between(1,13),n=Phaser.Math.Between(1,4);e.behavior.setValue(t,n)}e.behavior.setFrameCardUp()}))}}),u.add({targets:a,angle:0,duration:l,offset:l,onYoyo:function(){a.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.play()},t}(Du),Fu=Gu,Zu=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t)||this).images=[],a.containerRectGeom=void 0,a.bufferRectGeom=void 0,a.updateImages=function(){a.images.forEach((function(e){return a.updateImgCrop(e)}))},a.images=r,a.add(a.images),a.setSize(n,i),a.createContainerRectGeom(),a.createBufferRectGeom(),t.events.on(Phaser.Scenes.Events.UPDATE,a.updateImages),a.on(Phaser.GameObjects.Events.DESTROY,(function(){t.events.on(Phaser.Scenes.Events.UPDATE,a.updateImages)})),a}(0,f.Z)(t,e);var n=t.prototype;return n.setImages=function(e){this.remove(this.images,!1),this.images=e,this.add(e)},n.createContainerRectGeom=function(){this.containerRectGeom=new Phaser.Geom.Rectangle(-this.width/2,-this.height/2,this.width,this.height)},n.createBufferRectGeom=function(){this.bufferRectGeom=new Phaser.Geom.Rectangle},n.updateImgCrop=function(e){var t=e.x,n=e.y,i=e.width,r=e.height,a=e.scaleX,s=e.scaleY,o={x:t-i/2,y:n-r/2};this.bufferRectGeom.setTo(o.x,o.y,i,r);var c=Phaser.Geom.Rectangle.Intersection(this.containerRectGeom,this.bufferRectGeom),h=c.x-o.x,u=c.y-o.y;e.setCrop(h/a,u/s,c.width/a,c.height/s)},t}(Phaser.GameObjects.Container),Uu=Ki.Z.GAMEPLAY_DEFAULT,Wu=Uu.KEY,Yu=Uu.FRAME,Hu=function(e){function t(t,n,i){var r;return void 0===n&&(n=42),void 0===i&&(i=68),(r=e.call(this,t)||this).arrows=[],r.peekabooContainer=void 0,r.speedUp=1,r.arrowSpacing=25,r.onUpdateMoveArrow=function(e,t,n,i){var a=r.height/2+10,s=r.height/7e3*i*r.scene.time.timeScale*r.speedUp,o=e.y-s;o<-a&&(o=r.arrows[0===t?r.arrows.length-1:t-1].y+r.arrowSpacing);e.setY(o)},r.setSize(n,i),r.createAnimatedArrows(),r.createCropContainer(),r}(0,f.Z)(t,e);var n=t.prototype;return n.runChangerAnimation=function(){this.scene.tweens.add({targets:this,speedUp:{from:1,to:10},yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,duration:250})},n.setTint=function(e){this.arrows.forEach((function(t){return t.setTintFill(e)}))},n.clearTint=function(){this.arrows.forEach((function(e){return e.clearTint()}))},n.createAnimatedArrows=function(){this.arrows=this.createArrows(4),this.playArrowsAnimation(this.arrows)},n.createArrows=function(e){var t=this;return Array(e).fill(null).map((function(e){var n=t.scene.add.image(0,0,Wu,Yu.ARROW_UP).setPosition(0,0);return n.setDefaultWorldSize(),n}))},n.playArrowsAnimation=function(e){var t=this;e.forEach((function(e,n){e.setY(n*t.arrowSpacing);var i=t.onUpdateMoveArrow.bind(void 0,e,n);t.scene.events.on(Phaser.Scenes.Events.UPDATE,i),e.on(Phaser.GameObjects.Events.DESTROY,(function(){t.scene.events.off(Phaser.Scenes.Events.UPDATE,i)}))}))},n.createCropContainer=function(){this.peekabooContainer=new Zu(this.scene,this.width,this.height,this.arrows),this.add(this.peekabooContainer)},t}(Phaser.GameObjects.Container),zu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).increasing=void 0,t.arrowUpContainer=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.increasing=1==this.data.CardChangerType,this.createArrowUpContainer(),this.type=nu.CHANGER,e.prototype.init.call(this)},n.isIncreasing=function(){return this.increasing},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.showArrowUpContainer()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.hideArrowUpContainer()},n.activate=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.hideArrowUpContainer(),t.next=3,e.prototype.activate.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.boardGame.mover.getMoves()<=this.flipMove)){e.next=3;break}return e.abrupt("return");case 3:t=this.value,this.increasing?(t+=1)>Cu.KING&&(t=Cu.ACE):(t-=1)<Cu.ACE&&(t=Cu.KING),this.setValue(t,this.suit),this.type=nu.CHANGER,this.card.cardImage.setTexture(this.keyUp,this.frameUp),this.arrowUpContainer.runChangerAnimation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNextValue=function(){var e=this.value;return this.increasing?(e+=1)>Cu.KING&&(e=Cu.ACE):(e-=1)<Cu.ACE&&(e=Cu.KING),e},n.undo=function(){var e=this.value;this.increasing?(e-=1)<Cu.ACE&&(e=Cu.KING):(e+=1)>Cu.KING&&(e=Cu.ACE),this.setValue(e,this.suit),this.type=nu.CHANGER,this.setFacing(!0)},n.revive=function(){e.prototype.revive.call(this),this.showArrowUpContainer()},n.hideArrowUpContainer=function(){this.arrowUpContainer.kill()},n.showArrowUpContainer=function(){this.arrowUpContainer.revive(),this.runArrowUpContainerAnimation()},n.runArrowUpContainerAnimation=function(){this.isRed()&&this.arrowUpContainer.setTint(16711680),this.arrowUpContainer.setAngle(this.increasing?0:180)},n.createArrowUpContainer=function(){this.arrowUpContainer=new Hu(this.scene),this.card.addAt(this.arrowUpContainer,1)},t}(Du),Ku=zu,Vu=n(55),Xu={KEY_CARD:{POP_AND_DROP:"key_card"},KEY:{POP_AND_FLY:"key_start"},LOCK:{UNLOCK:"lock_start"},BALLOON:{SHOW:"balloon_show",EXPLODE:"ballon_explosion"},CLOUDS:{IDLE:"cloud_idle",SHOW:"balloon_show_clouds",EXPLODE:"ballon_explosion_clouds"},CODE_BREAK:{IDLE:"cloud_idle",SHOW:"balloon_show",UNLOCK:"ballon_explosion"},LEVEL_COMPLETE:{ENTRANCE:"animation"},SQUIRREL:{APPEAR:"Appear",CATCH:"Catch",DISAPPEAR:"Disappear",FIND:"Find",IDLE:"Idle",LOOK:"Look",WIPE:"Wipe"},MAP:{MAP_APPEAR:"big_map_appear",MAP_FRAGMENT_APPEAR:"card_map_appear",MAP_FRAGMENT_COLLECT:"get_little_piece",MAP_COLLECT:"card_map_plus_piece",MAP_COLLECT_LAST:"card_map_full_done"},CARD:{APPEAR:"slice_card_appear",FX:{LEFT_CUT:"cut_left_side",RIGHT_CUT:"cut_right_side"},SLICE:"booster_slice",DECREASE:"decrease",INCREASE:"increase",SKIN:{DEFAULT:"default",BLACK:"black",RED:"red"}},WINDMILL:{APPEAR:"animation"},EVENT_BUTTONS:{DOWN:"down",UP:"up",SHOW:"show",HIDE:"hide",IDLE:"idle",DOWN_ALL:"down_all"},CHANGE_VFX:{CHANGE_BOTTOM:"change_bottom",CHANGE_TOP:"change_top"},CIRCLE_VFX:{SHOW:"show"}},ju=Ki.Z.GAMEPLAY_OBJECTS,qu=ju.KEY,Ju=ju.FRAME,Qu=90/275,$u=135/395,el=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).cardSpine=void 0,t.keySpine=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=qu,this.frameUp=Ju.CHEESE_CARD,this.type=nu.KEY,e.prototype.init.call(this),this.createSpines()},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.KEY_ACTIVATE),this.removeFromPile(),t.refresh(),0!=(n=this.boardGame.pile.getLockCards()).length){e.next=8;break}return this.runTweenDisappearAnimation(),e.abrupt("return",Promise.resolve());case 8:return i=Phaser.Math.Between(0,n.length-1),(r=n[i]).behavior.activate(),this.effectedCard=r,s=r.behavior,o=s.runExitAnimation(),c=this.runSpineDisappearAnimation(r),e.next=17,Promise.all([o,c]);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.undo=function(){this.frameUp=Ju.CHEESE_CARD,this.setFrameCardUp(),this.keySpine.setScale(Qu,$u),this.keySpine.setAlpha(1),this.keySpine.setAngle(0),this.keySpine.setPosition(0,0),this.cardSpine.setScale(Qu,$u),this.cardSpine.setAngle(0),this.cardSpine.setPosition(0,0),this.card.add(this.keySpine),this.card.add(this.cardSpine)},n.revive=function(){var e=this.card.payload,t=e.x,n=e.y;this.card.setPosition(t,n),this.undo(),this.runReviveAnimation()},n.kill=function(){var e=this.boardGame.gameplay.spineManager;e.stopAnimation(this.keySpine),e.stopAnimation(this.cardSpine)},n.runTweenDisappearAnimation=function(){var e=this;this.updateSize(),new Vu.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.In,props:{scale:0},onComplete:function(){e.kill()}}).play(),this.card.jump(10,500)},n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.card.setScale(.2),new Mh.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},onComplete:function(){e.updateSize()}}).play(),this.card.jump(10,600)},n.runSpineDisappearAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.bringToTop(),this.frameUp=Ju.BLANK_CARD,this.setFrameCardUp(),this.card.kill(),n=this.runCardUnlockAnimation(),i=this.runKeyUnlockAnimation(),r=this.card,s=r.x,o=r.y,c=this.keySpine,h=c.x,u=c.y,this.keySpine.setPosition(s+h,o+u),l=this.scene.tweens.add({targets:this.keySpine,duration:716.6666666666666,x:t.x+170,y:t.y,angle:0,ease:Phaser.Math.Easing.Cubic.InOut,onComplete:function(){d.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.TWIST_LOCK),d.keySpine.setAlpha(0)}}).waitForCompletion(),e.next=12,Promise.all([i,n,l]);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runKeyUnlockAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,this.card.remove(this.keySpine),this.keySpine.setAngle(this.card.angle),this.scene.gameplayLayer.add(this.keySpine),e.next=6,t.playAnimation(this.keySpine,Xu.KEY.POP_AND_FLY);case 6:this.keySpine.kill();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCardUnlockAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,n=this.cardSpine,i=n.x,r=n.y,this.card.remove(this.cardSpine),this.cardSpine.setAngle(this.card.angle),this.cardSpine.setPosition(this.card.x+i,this.card.y+r),this.scene.gameplayLayer.add(this.cardSpine),e.next=8,t.playAnimation(this.cardSpine,Xu.KEY_CARD.POP_AND_DROP);case 8:this.cardSpine.kill();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createSpines=function(){var e=this.boardGame.gameplay.spineManager,t=e.createSpine(0,0,Ki.Z.CARD_LOCK_SPINE.DATA_KEY,Ki.Z.CARD_LOCK_SPINE.ATLAS_KEY,new SpinePlugin.SkinsAndAnimationBoundsProvider(Xu.KEY_CARD.POP_AND_DROP)),n=e.createSpine(0,0,Ki.Z.CARD_LOCK_SPINE.DATA_KEY,Ki.Z.CARD_LOCK_SPINE.ATLAS_KEY,new SpinePlugin.SkinsAndAnimationBoundsProvider(Xu.KEY.POP_AND_FLY));t.setScale(Qu,$u),n.setScale(Qu,$u),t.animationStateData.defaultMix=0,n.animationStateData.defaultMix=0,t.kill(),n.kill(),this.card.add(t),this.card.add(n),this.cardSpine=t,this.keySpine=n},t}(Ru),tl=el,nl=Ki.Z.GAMEPLAY_OBJECTS,il=nl.KEY,rl=nl.FRAME,al=90/275,sl=135/395,ol=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=il,this.frameUp=rl.MOUSE_CARD,this.type=nu.LOCK,e.prototype.init.call(this),this.createSpine()},n.activate=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.removeFromPile();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateSize(),this.frameUp=rl.BLANK_CARD,this.setFrameCardUp(),this.card.kill(),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),e.next=7,this.runUnlockAnimation();case 7:this.boardGame.pile.refresh(),this.kill(),this.card.cardImage.revive();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runUnlockAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,this.card.remove(this.spine),this.spine.setAngle(this.card.angle),this.spine.setPosition(this.card.x,this.card.y),this.scene.gameplayLayer.add(this.spine),e.next=7,t.playAnimation(this.spine,Xu.LOCK.UNLOCK);case 7:this.spine.kill();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.card.setScale(.2),this.card.jump(10,600),new Mh.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},onComplete:function(){e.updateSize()}}).play()},n.revive=function(){e.prototype.revive.call(this),this.frameUp=rl.MOUSE_CARD,this.setFrameCardUp(),this.spine.setScale(al,sl),this.spine.setAngle(0),this.spine.setPosition(0,0),this.card.add(this.spine),this.runReviveAnimation()},n.kill=function(){var t=this;e.prototype.kill.call(this);var n=this.boardGame.pile;n.cards.forEach((function(e){e!=t.card&&e.payload.faceUp&&n.isOverLap(t.card,e)&&e.setBlur(!1)})),this.boardGame.gameplay.spineManager.stopAnimation(this.spine)},n.setFrameCardUp=function(){var t=this;e.prototype.setFrameCardUp.call(this);var n=this.boardGame.pile;n.cards.forEach((function(e){e!=t.card&&e.payload.faceUp&&n.isOverLap(t.card,e)&&e.setBlur(!0)}))},n.createSpine=function(){var e=this.boardGame.gameplay.spineManager,t=e.createSpine(0,0,Ki.Z.CARD_LOCK_SPINE.DATA_KEY,Ki.Z.CARD_LOCK_SPINE.ATLAS_KEY);t.setScale(al,sl),t.animationStateData.defaultMix=0,e.killSpine(t),this.card.add(t),this.spine=t},t}(Ru),cl=ol,hl=Ki.Z.GAMEPLAY_OBJECTS,ul=hl.KEY,ll=hl.FRAME,dl=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).plus=void 0,i.cards=void 0,i.entranceAnimation=void 0,i.exitAnimation=void 0,i.addedCardsText=void 0,i.plus=n,i.createAddedCardText(),i}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=ul,this.frameUp=ll.PLUS_CARD,this.cards=[],e.prototype.init.call(this),this.setPlus(this.plus)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.addedCardsText.revive()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.addedCardsText.kill()},n.setPlus=function(e){this.plus=e,this.addedCardsText.text="+"+e,1==this.plus?this.type=nu.PLUS_ONE:2==this.plus?this.type=nu.PLUS_TWO:3==this.plus?this.type=nu.PLUS_THREE:4==this.plus?this.type=nu.PLUS_FOUR:5==this.plus&&(this.type=nu.PLUS_FIVE);for(var t=0;t<this.plus;t++){var n=this.boardGame.deck.getNewStockCard();n.kill(),this.cards.push(n)}},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.pile,this.removeFromPile(),t.refresh(),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.CARD_PLUS_ACTIVATE,{},!0),e.abrupt("return",this.runEntranceAnimation());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.world.getWorldSize().width/2,i=this.scene.world.getWorldSize().height/2,this.card.move({x:n,y:i,duration:600}),this.card.behavior.bringToTop(),null==(t=this.entranceAnimation)||t.stop(),r=n<this.card.x?this.card.angle-15:this.card.angle+15,(s=this.scene.tweens.createTimeline()).add({targets:[this.card],scale:{from:1,start:1,to:1.2},angle:0,duration:600,ease:Phaser.Math.Easing.Sine.InOut}),s.add({targets:[this.card],angle:r,offset:0,duration:250,ease:Phaser.Math.Easing.Sine.InOut}),s.add({targets:[this.card],angle:0,offset:250,duration:250,ease:Phaser.Math.Easing.Sine.InOut}),this.entranceAnimation=s,e.next=13,this.entranceAnimation.playAndWaitForCompletion();case 13:return e.abrupt("return",this.addCardToStock(this.plus,n,i));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.addCardToStock=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,s=250,o=[],c=[],h=this.scene.tweens.createTimeline(),u=a().mark((function e(t){var h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(h=d.boardGame.deck.getNewStockCard()).setAlpha(0),h.setPosition(n,i),u=h.moveWithRotate({x:d.boardGame.stock.x,y:d.boardGame.stock.y,duration:800,delay:r,onStart:function(){d.addedCardsText.setText("+"+(d.plus-t-1))},onComplete:function(){d.boardGame.stock.moveToStep(-1),d.boardGame.stock.addCard(h)}}),o.push(h),c.push(u),r+=s;case 7:case"end":return e.stop()}}),e)})),l=0;case 7:if(!(l<t)){e.next=12;break}return e.delegateYield(u(l),"t0",9);case 9:l++,e.next=7;break;case 12:return h.add({targets:this.card,duration:s/2,scale:1.3,yoyo:!0,loop:t-1,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){d.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FLY_TO_STOCK),d.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.SPAWN_CARD)},onLoop:function(){d.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FLY_TO_STOCK),d.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.SPAWN_CARD)},onComplete:function(){d.runExitAnimation()}}),h.add({targets:o,duration:200,offset:0,delay:this.scene.tweens.stagger(s,{}),ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}}),c.push(h.playAndWaitForCompletion()),e.next=17,Promise.all(c);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.exitAnimation)||t.stop(),(n=this.scene.tweens.createTimeline({onComplete:function(){i.card.kill()}})).add({targets:[this.card],duration:200,ease:Phaser.Math.Easing.Quadratic.Out,alpha:{start:1,from:1,to:0}}),this.exitAnimation=n,this.exitAnimation.play(),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.addedCardsText.setText("+"+this.plus);var t=this.card.payload,n=t.x,i=t.y;this.card.setPosition(n,-50);var r=this.scene.tweens.createTimeline();r.once(Phaser.Tweens.Events.TIMELINE_START,(function(){var t,n;null==(t=e.card.movingTween)||t.stop(),null==(n=e.facingTween)||n.stop(),e.updateSize(),e.setFrameCardUp()})),r.once(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){e.card.payload.faceUp||e.boardGame.pile.checkOverlap(e.card)&&e.setFacingWithFlippingAnim(!1)})),r.add({targets:this.card,x:n,y:i,duration:300,ease:Phaser.Math.Easing.Sine.Out}),r.play()},n.revive=function(){var t,n,i=this;e.prototype.revive.call(this),null==(t=this.entranceAnimation)||t.stop(),null==(n=this.exitAnimation)||n.stop(),this.runReviveAnimation();for(var r,a=this.boardGame.stock,s=function(){var e=a.cards.pop();if(!e)return{v:void 0};i.cards.push(e);var t=i.card.payload,n=t.x,r=t.y,s=t.angle;e.setAngle(s),e.move({x:n,y:r,duration:250,onComplete:function(){e.kill()}})},o=0;o<this.plus;o++)if(r=s())return r.v;a.animateAlignCards()},n.createAddedCardText=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(22),origin:{x:.5,y:.5},text:"+99",y:1});e.setTint(10175696),this.card.add(e),this.addedCardsText=e},t}(Ru),pl=dl,fl=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp="atlas_level_wildcards",this.frameUp="wildcard_zap",this.type=nu.ZAP,e.prototype.init.call(this)},n.getElectrocutionCards=function(){var e=this,t=this.boardGame.pile.getFrontCards().filter((function(e){var t;return(null==(t=e.behavior)?void 0:t.type)==nu.VALUE})),n=this.scene.world.getWorldSize().width,i=[];return t.forEach((function(t){var r=new Phaser.Geom.Line(0,e.card.y+10,n,e.card.y+10),a=new Phaser.Geom.Line(0,e.card.y-10,n,e.card.y-10),s=t.getRotatedRectangle();(Phaser.Geom.Intersects.LineToRectangle(r,s)||Phaser.Geom.Intersects.LineToRectangle(a,s))&&i.push(t)})),i},n.activate=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.card.kill(),(t=this.boardGame.pile).removeCard(this.card),this.boardGame.gameplay.setEnableCardInput(!1),n=this.getElectrocutionCards(),this.boardGame.gameplay.scoreManager.increaseScoreByBoom(1+n.length),n.forEach((function(e){e.kill(),t.removeCard(e)})),this.scene.time.delayedCall(500,(function(){t.refresh(),i.boardGame.gameplay.setEnableCardInput(!0)}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Ru),ml=fl,gl=n(74),vl=function(e){return e.COIN="Coin",e.STAR="Star",e.BOOSTER_SLICE="BoosterSlice",e.BOOSTER_STORM="BoosterStorm",e.BOOSTER_WILD_DROP="BoosterWildDrop",e.BOOSTER_PLUS_FIVE="BoosterPlusFive",e.PLUS_FIVE="PlusFive",e.UNDO="Undo",e.WILD_CARD="WildCard",e.UNKNOWN="Unknown",e}(vl||{}),yl=vl,El=function(e){return e.USE_STORAGE_ITEM="UseStorageItem",e.BUY_BOOSTER_SLICE="BuyBoosterSlice",e.BUY_BOOSTER_STORM="BuyBoosterStorm",e.BUY_BOOSTER_WILD_DROP="BuyBoosterWildDrop",e.BUY_USE_UNDO="BuyUseUndo",e.BUY_USE_WILD_CARD="BuyUseWildCard",e.BUY_USE_PLUS_FIVE="BuyUsePlusFive",e.WEEKLY_TOURNAMENT="WeeklyTournament",e.OFFSHORE_RACE="OffshoreRace",e.BOXING_DUEL="BoxingDuel",e.PLAY_CARD="PlayCard",e.UNDO_WILDCARD="UndoWildcard",e.UNDO_PLAY_CARD="UndoPlayCard",e.LEVEL_COMPLETE="LevelComplete",e.STREAK_REWARDS="StreakRewards",e.WELCOME_BACK="WelcomeBack",e.REWARD_NEW_USER="RewardNewUser",e.GET_MORE_COIN_AD="GetMoreCoinAd",e.WELCOME_BACK_AD="WelcomeBackAd",e.LEVEL_COMPLETE_AD="LevelCompleteAd",e.PLUS_FIVE_AD="PlusFiveAd",e}(El||{}),Cl=El,wl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).isBought=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.keyUp=Ki.Z.GAMEPLAY_OBJECTS.KEY,this.frameUp=Ki.Z.GAMEPLAY_OBJECTS.FRAME.WILD_CARD,this.keyDown=Ki.Z.GAMEPLAY_OBJECTS.KEY,this.frameDown=Ki.Z.GAMEPLAY_OBJECTS.FRAME.WILD_CARD_BACK,this.type=nu.JOKER,this.isBought=!1},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.boardGame,i=n.mover,r=n.waste,s=n.pile,o=this.boardGame.gameplay.coinUsingManager,0==this.facingUp&&this.setFacingWithFlippingAnim(!0),this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.START_MOVE_TO_WASTE),!((null==(c=r.getOnTopCard())?void 0:c.behavior)instanceof t)){e.next=12;break}return o.addWildCard(this.card,!1),this.scene.logEconomy.logGetItem(yl.WILD_CARD,1,Cl.PLAY_CARD),this.removeFromPile(au.Joker),this.card.disableInteractive(),s.refresh(),e.abrupt("return",this.runMoveAnimation(au.Joker));case 12:return i.fromPileToWaste(this.card),i.addUndoCard(this.card,au.Pile,au.Waste),s.refresh(),this.scene.logEconomy.logCollectUseWildcard(),e.abrupt("return",this.runMoveAnimation(au.Waste));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.activate=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.revive(),this.card.revive(),0==this.facingUp&&this.setFacingWithFlippingAnim(!0),t=this.boardGame.waste,n=this.scene.gameplay.coinUsingManager,t.addCard(this.card),i=n.wildCardWrapper.getWorldPosition(),r=i.x,s=i.y,o=n.wildCardBtn.getOffsetMainY(),this.card.setPosition(r,s+o),this.boardGame.mover.addUndoCard(this.card,au.Joker,au.Waste),this.runMoveAnimation(au.Waste);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runMoveAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.boardGame.waste,i=this.scene.gameplay.coinUsingManager,this.updateSize(),this.bringToTop(),t!=au.Waste){e.next=9;break}return this.card.moveWithRotate({x:n.x,y:n.y,duration:800,onComplete:function(){h.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FINISH_MOVE_TO_WASTE)}}),e.next=8,(0,gl.Z)(this.scene,300);case 8:return e.abrupt("return");case 9:if(t!=au.Joker){e.next=20;break}return this.scene.gameplayLayer.bringToTop(i.wildCardBtn),r=i.wildCardWrapper.getWorldPosition(),s=r.x,o=r.y,c=i.wildCardBtn.getOffsetMainY(),e.next=15,this.card.moveWithRotate({x:n.x,y:n.y-80,duration:600});case 15:return this.card.flipRotate(600,-90),e.next=18,this.card.moveWithRotate({x:s,y:o+c,duration:800});case 18:i.onWildCardChanged(),this.card.kill();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(xu),Al=wl,bl=function(e){return e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e}({}),Sl=hu.CARD_VIEW,Tl=Sl.WIDTH,xl=Sl.HEIGHT,kl=Ki.Z.GAMEPLAY_OBJECTS,Pl=kl.KEY,Il=kl.FRAME,Ol=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t.animations=void 0,t.blowAnimation=void 0,t.blowCardsAnimation=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.createSpine(),this.keyUp=Pl,this.frameUp=Il.STORM_CARD,this.keyDown=Pl,this.frameDown=Il.STORM_CARD_BACK,this.animations=[],this.type=nu.WINDMILL,this.card.cardImage.setWorldSize(Tl,xl)},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),this.scene.gameUI.footer.setCanHandleSettings(!1),t=this.boardGame,n=t.pile,i=t.mover,this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),(r=n.getFrontCards()).forEach((function(e){e.moveToTopLayer()})),(s=this.boardGame.locks.filter((function(e){return e.active}))).forEach((function(e){o.scene.gameplayLayer.bringToTop(e),i.addUndoLock(e)})),this.runBlowLocksAnimation(s),this.runBlowCardsAnimation(r),this.boardGame.waste.removeCard(this.card),e.next=13,this.runAnimation();case 13:s.forEach((function(e){e.handleCards(!1)})),this.boardGame.pile.refresh(),this.scene.gameUI.footer.setCanHandleSettings(!0),this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.world.getWorldSize().width,i=this.scene.world.getWorldSize().height,r=n/2,s=i/2-this.card.height/2,null==(t=this.blowAnimation)||t.stop(),this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.SWOOSH_LONG,{},!0),this.card.behavior.bringToTop(),400,100,e.next=11,(0,gl.Z)(this.scene,500);case 11:return o=this.runWindmillActivationAnimation(),c=this.scene.add.tween({targets:this.card,x:r,y:s,duration:400,ease:Phaser.Math.Easing.Linear}).waitForCompletion(),h=this.playCardRotateSound(),e.next=16,Promise.all([o,c,h]);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playCardRotateSound=function(){var e=this;return new Promise((function(t,n){var i=0;e.scene.time.addEvent({repeat:14,delay:120,callback:function(){try{e.scene.audio.playAudioSprite(Hc.Z.CARD_ROTATE.KEY,"card_rotate_"+i),(i+=1)>=14&&t()}catch(r){n(r instanceof Error?r:new Error("Error while playing card rotate sound"))}}})}))},n.runBlowLocksAnimation=function(e){var t=this,n=this.scene.world.getWorldSize().width;e.forEach((function(e){if(e.direction==bl.LEFT){var i=e.move(-100,e.y-15,1e3,2e3);null==i||i.once(Phaser.Tweens.Events.TWEEN_START,(function(){t.scene.gameplayLayer.bringToTop(e),t.card.behavior.bringToTop()})),null==i||i.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){e.killedByWindmill()}))}if(e.direction==bl.RIGHT){var r=e.move(n+100,e.y-15,1e3,2500);null==r||r.once(Phaser.Tweens.Events.TWEEN_START,(function(){t.scene.gameplayLayer.bringToTop(e),t.card.behavior.bringToTop()})),null==r||r.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){e.killedByWindmill()}))}}))},n.runBlowCardsAnimation=function(e){var t,n=this,i=this.scene.world.getWorldSize().width;null==(t=this.blowCardsAnimation)||t.stop();var r=this.scene.tweens.createTimeline();r.add({targets:e,y:"-=10",duration:800,delay:1200,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){var t=n.boardGame.gameplay.comboManager;n.scene.rewardManager;e.forEach((function(e){(e.behavior.removeFromPile(),e.behavior.bringToTop(),e.isType(nu.CHAIN,nu.CHANGER)||e.behavior.killItems(),e.isType(nu.CHANGER))&&e.behavior.hideArrowUpContainer();t.increaseCombo(e),n.scene.events.emit(Iu.Z.COLLECT_CARD,e)})),n.card.behavior.bringToTop()}}),r.add({targets:e,angle:function(e){return e.angle+Phaser.Math.Between(-35,35)},duration:function(){return Phaser.Math.Between(1e3,1300)}});var a=i/2;e.forEach((function(e){var t=e.y+Phaser.Math.Between(-30,30),s=Phaser.Math.Between(1500,1800),o=e.x<a,c=o?-100:i+100,h=o?2e3:2500;e.move({x:c,y:t,duration:s,delay:h}),(0,gl.Z)(n.scene,h).then((function(){e.isType(nu.CHAIN)&&e.behavior.hideChain(!0,1200);e.isType(nu.CHESTNUT)&&e.behavior.throwNutToBasket();e.isType(nu.MAP_PIECE)&&e.behavior.collectMapPiece()})),r.add({targets:e,scaleX:-1,yoyo:!0,duration:600,onUpdate:function(t){var n=t.getValue();e.behavior.facingUp&&n<=0?e.behavior.setFacing(!1):!e.behavior.facingUp&&n>=0&&e.behavior.setFacing(!0)},offset:h})})),this.blowCardsAnimation=r,r.play(),e.forEach((function(e){e.jump(15,2e3,0,1200)}))},n.revive=function(){var t;e.prototype.revive.call(this),null==(t=this.blowCardsAnimation)||t.stop(),this.card.setAngle(0),this.card.cardImage.setAlpha(1),this.card.shadow.setAlpha(1)},n.createSpine=function(){var e=this.scene.gameplay.spineManager.createSpine(0,5,Ki.Z.WINDMILL_SPINE.DATA_KEY,Ki.Z.WINDMILL_SPINE.ATLAS_KEY);e.setScale(.34,.34),e.animationStateData.defaultMix=0,e.kill(),this.card.add(e),this.spine=e},n.runWindmillActivationAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.card.cardImage.setAlpha(0),this.card.shadow.setAlpha(0),t=this.scene.gameplay.spineManager,n=t.playAnimation(this.spine,Xu.WINDMILL.APPEAR),i=this.scene.tweens.add({targets:this.spine,y:{from:5,to:140},duration:400,ease:Phaser.Math.Easing.Linear}).waitForCompletion(),e.next=7,Promise.all([n,i]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Ru),Rl=Ol,Bl=Ki.Z.GAMEPLAY_OBJECTS,Dl=Bl.KEY,Ll=Bl.FRAME,Ml=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=nu.MYSTERIOUS,this.keyDown=Dl,this.frameDown=Ll.MYSTERIOUS_CARD,this.card.isMysterious=!0,this.setRandomBehavior()},n.setRandomBehavior=function(){var e=[nu.BOOM,nu.CHANGER,nu.JOKER,nu.PLUS_FIVE,nu.PLUS_FOUR,nu.PLUS_THREE,nu.PLUS_TWO,nu.PLUS_ONE],t=e[Phaser.Math.Between(0,e.length-1)];this.card.setBehavior(t),this.type=t,this.card.behavior.setFrameCardDown(Dl,Ll.MYSTERIOUS_CARD)},t}(Ru),_l=Ml,Nl=function(){function e(e,t){var n=this;this.scene=void 0,this.graphics=void 0,this.bodies=void 0,this.leftConstraint=void 0,this.rightConstraint=void 0,this.toLeft=new Phaser.Math.Vector2(0,0),this.toRight=new Phaser.Math.Vector2(0,0),this.leftKnob=void 0,this.rightKnob=void 0,this.chain=void 0,this.drawRopePoints=function(){n.graphics.clear(),n.graphics.lineGradientStyle(hu.ROPE_SEGMENT_HEIGHT,15909239,15909239,11686171,11686171,1);var e=n.leftConstraint.pointA,t=n.rightConstraint.pointA;n.graphics.beginPath(),n.graphics.moveTo(e.x,e.y);for(var i=1;i<n.bodies.length-1;i++){var r=n.bodies[i].position;n.graphics.lineTo(r.x,r.y)}n.graphics.lineTo(t.x,t.y),n.graphics.stroke()},this.scene=e,this.create(t)}var t=e.prototype;return t.setKnobs=function(e,t){this.leftKnob=e,this.rightKnob=t},t.setLeftPos=function(e,t){var n=this.toLeft,i=n.x,r=n.y;Math.round(e)==Math.round(i)&&Math.round(r)==Math.round(t)||this.toLeft.set(e,t)},t.setRightPos=function(e,t){var n=this.toRight,i=n.x,r=n.y;Math.round(e)==Math.round(i)&&Math.round(r)==Math.round(t)||this.toRight.set(e,t)},t.getSegments=function(){return this.bodies},t.create=function(e){var t=this;this.bodies=[];var n=this.scene.matter;this.graphics=this.scene.add.graphics(),this.scene.gameplayLayer.add(this.graphics);var i=Math.ceil(e/hu.ROPE_SEGMENT_WIDTH)+3,r=n.add.stack(0,0,i,1,0,0,(function(e,n){var i=Phaser.Physics.Matter.Matter.Bodies.rectangle(e,n,hu.ROPE_SEGMENT_WIDTH,hu.ROPE_SEGMENT_HEIGHT,{collisionFilter:{group:-1,category:1,mask:-1},frictionAir:.09});return t.bodies.push(i),i}));this.bodies.forEach((function(e,t){e.position.x=20+8*t,e.position.y=50})),this.chain=n.add.chain(r,.375,0,-.375,0,{stiffness:.8,length:0}),this.leftConstraint=this.scene.matter.add.worldConstraint(r.bodies[0],0,.4,{pointA:{x:r.bodies[0].position.x,y:r.bodies[0].position.y},pointB:{x:-2,y:0}}),this.rightConstraint=this.scene.matter.add.worldConstraint(r.bodies[i-1],0,.4,{pointA:{x:r.bodies[i-1].position.x,y:r.bodies[i-1].position.y},pointB:{x:2,y:0}})},t.setAlpha=function(e){this.graphics.setAlpha(e)},t.destroy=function(){this.scene.matter.world.removeConstraint([].concat(this.chain.constraints,[this.leftConstraint,this.rightConstraint]),!0),this.graphics.destroy(),this.scene.matter.world.remove(this.bodies,!0)},t.revive=function(){this.graphics.revive(),this.bodies.forEach((function(e){Phaser.Physics.Matter.Matter.Sleeping.set(e,!1)}))},t.kill=function(){this.graphics.kill(),this.bodies.forEach((function(e){Phaser.Physics.Matter.Matter.Sleeping.set(e,!0)}))},t.update=function(){if(this.setLeftPos(this.leftKnob.x,this.leftKnob.y),this.setRightPos(this.rightKnob.x,this.rightKnob.y),0!=this.toLeft.x&&0!=this.toRight.x){var e=this.toLeft.clone().subtract(this.leftConstraint.pointA),t=e.length();if(t>.01){var n=Math.min(t,20),i=Math.max(t,20),r=Phaser.Math.Clamp(t/10,n,i),a=e.normalize().scale(r),s=a.x,o=a.y;this.leftConstraint.pointA.x+=s,this.leftConstraint.pointA.y+=o}var c=this.toRight.clone().subtract(this.rightConstraint.pointA),h=c.length();if(h>.01){var u=Math.min(h,20),l=Math.max(h,20),d=Phaser.Math.Clamp(h/10,u,l),p=c.normalize().scale(d),f=p.x,m=p.y;this.rightConstraint.pointA.x+=f,this.rightConstraint.pointA.y+=m}this.drawRopePoints()}},e}(),Gl=Nl,Fl=Ki.Z.GAMEPLAY_OBJECTS,Zl=Fl.KEY,Ul=Fl.FRAME,Wl=function(e){function t(t){var n;return(n=e.call(this,t)||this).connectedCard=void 0,n.knob=void 0,n.rope=void 0,n.showOrHideChainTween=void 0,n.setData(t.payload),n.type=nu.CHAIN,n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.knob=this.scene.add.image(0,0,Zl,Ul.RED_KNOB),this.knob.setDefaultWorldSize(),this.scene.gameplayLayer.add(this.knob),this.type=nu.CHAIN},n.moveToTopLayer=function(){this.scene.gameplayLayer.bringToTop(this.knob),this.updateRopeDepth()},n.setConnectedCard=function(e){e&&(this.connectedCard=e)},n.initRope=function(){var e=this.connectedCard.behavior;if(!e.rope){this.updateKnob(),e.updateKnob();var t=Phaser.Math.Distance.Between(this.knob.x,this.knob.y,e.knob.x,e.knob.y),n=this.knob,i=e.knob;this.rope=new Gl(this.scene,t),n.x>i.x&&(n=i,i=this.knob),this.rope.setKnobs(n,i),this.updateRopeDepth()}},n.bringToTop=function(){e.prototype.bringToTop.call(this),this.scene.gameplayLayer.moveAbove(this.knob,this.card),this.updateRopeDepth()},n.revive=function(){e.prototype.revive.call(this),this.showChain(!0)},n.updateRopeDepth=function(){if(this.connectedCard){var e=this.connectedCard.behavior;if(this.rope){var t=this.rope.graphics,n=this.scene.gameplayLayer.getIndex(this.card),i=this.scene.gameplayLayer.getIndex(this.connectedCard);this.scene.gameplayLayer.bringToTop(t),n>i?(this.scene.gameplayLayer.moveBelow(t,this.knob),this.scene.gameplayLayer.moveAbove(e.knob,t)):(this.scene.gameplayLayer.moveBelow(t,e.knob),this.scene.gameplayLayer.moveAbove(this.knob,t))}else e.updateRopeDepth()}},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.activate=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this,!0);case 2:this.bringToTop(),this.pullConnectedCard();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.refresh=function(){this.knob&&(this.card.behavior.facingUp?!this.connectedCard.behavior.facingUp||this.card.isLock||this.connectedCard.isLock?(this.card.setBlur(!0),this.knob.setFrame(Ul.RED_KNOB)):(this.card.setBlur(!1),this.knob.setFrame(Ul.KNOB)):(this.card.setBlur(!1),this.knob.setFrame(Ul.RED_KNOB)),this.knob.setDefaultWorldSize())},n.showChain=function(e,t){var n,i=[this.knob];if(this.rope&&i.push(this.rope.graphics),this.reviveItems(),!e)return this.knob.setAlpha(1),void this.rope.setAlpha(1);null==(n=this.showOrHideChainTween)||n.stop(),this.showOrHideChainTween=this.scene.tweens.add({targets:i,alpha:1,delay:t,duration:400,ease:Phaser.Math.Easing.Sine.InOut})},n.hideChain=function(e,t){var n,i=this,r=[this.knob];this.rope&&r.push(this.rope.graphics),e?(null==(n=this.showOrHideChainTween)||n.stop(),this.showOrHideChainTween=this.scene.tweens.add({targets:r,alpha:0,duration:400,delay:t,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){i.killItems()}})):this.killItems()},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.refresh()},n.setFrameCardDown=function(){e.prototype.setFrameCardDown.call(this),this.refresh()},n.destroyItems=function(){this.knob.destroy(),this.rope&&this.rope.destroy()},n.killItems=function(){var e;this.knob.kill(),null==(e=this.rope)||e.kill()},n.reviveItems=function(){var e;this.knob.revive(),null==(e=this.rope)||e.revive()},n.update=function(){this.updateKnob()},n.postUpdate=function(){var e;null==(e=this.rope)||e.update()},n.pullConnectedCard=function(){var e=(0,i.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.connectedCard.behavior)instanceof t&&n.pullToWaste();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.pullToWaste=function(){var e=(0,i.Z)(a().mark((function e(){var n,i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.boardGame,i=n.mover,r=n.waste,s=n.pile,this.scene.events.emit(Iu.Z.COLLECT_CARD,this.card),s.handleMatch(this.card),i.fromPileToWaste(this.card),s.refresh(),this.bringToTop(),o=r.x>this.card.x,e.next=9,this.card.moveByPulled(o,{x:r.x,y:r.y,duration:600,onComplete:function(){c.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FINISH_MOVE_TO_WASTE)}});case 9:this.hideChain(!0),this.connectedCard.behavior instanceof t&&this.connectedCard.behavior.hideChain(!0);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateKnob=function(){var e=this.card,t=e.angle,n=e.rotation;this.knob.setAngle(t),this.knob.setPosition(this.card.x-this.card.displayHeight/2*Math.sin(n),this.card.y+this.card.displayHeight/2*Math.cos(n)-3)},t}(Du),Yl=function(e){this.card=void 0,this.card=e},Hl=Phaser.Math.Easing.Sine,zl=function(e){function t(t){var n;return(n=e.call(this,t)||this).timeLine=void 0,n}(0,f.Z)(t,e);var n=t.prototype;return n.makeTimeLine=function(){var e;return null==(e=this.timeLine)||e.stop(),this.timeLine=this.card.scene.tweens.createTimeline({targets:this.card}),this},n.onComplete=function(e){this.timeLine.once(Phaser.Tweens.Events.TIMELINE_COMPLETE,e)},n.makeMove=function(e,t,n,i){return void 0===i&&(i=0),this.timeLine.add({x:e,y:t,duration:n,offset:i,ease:Hl.Out}),this},n.makeRotate=function(e,t,n){return void 0===n&&(n=0),this.timeLine.add({angle:e,duration:t,offset:n,ease:Hl.Out}),this},n.makeJump=function(e,t,n){return void 0===n&&(n=0),this.timeLine.add({z:e,duration:t/2,offset:n,ease:Hl.In}),this.timeLine.add({z:e,duration:t/2,ease:Hl.In}),this},n.play=function(){this.timeLine.play()},t}(Yl),Kl=Ki.Z.GAMEPLAY_OBJECTS,Vl=Kl.KEY,Xl=Kl.FRAME,jl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).missingMapPieces=8,t.missingMapPiecesAnimation=8,t.movesOnFlag=void 0,t.spine=void 0,t.sleepTime=void 0,t.showTreasureMap=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=Vl,this.frameUp=Xl.BLANK_CARD,this.type=nu.TREASURE,this.createTreasureMap(),this.sleepTime=0,this.showTreasureMap=!0,e.prototype.init.call(this)},n.activate=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.getMissingMapPieceIndex=function(){if(this.missingMapPieces-=1,this.missingMapPieces<=0){var e=this.scene.gameplay.boardGame.mover.moves;this.movesOnFlag=e}return this.missingMapPieces},n.isMapCollectedAllPieces=function(){return this.missingMapPieces<=0},n.getSleepTime=function(){var e=this.sleepTime;return this.sleepTime+=300,e},n.runAssembleMapPieceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.scene.gameplay.spineManager,this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.TICK),this.missingMapPiecesAnimation-=1,t.setData("isMapPieceCollected",!0),!(this.missingMapPiecesAnimation>0)){e.next=9;break}return this.updateTreasureMapSpine(this.missingMapPiecesAnimation),e.next=8,n.playAnimation(this.spine,Xu.MAP.MAP_COLLECT);case 8:return e.abrupt("return");case 9:return this.scene.gameplay.setEnableCardInput(!1),this.removeFromPile(au.Pile,this.movesOnFlag),(0,gl.Z)(this.scene,600).then((function(){return i.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF)})),e.next=14,n.playAndWaitAnimation(this.spine,Xu.MAP.MAP_COLLECT_LAST);case 14:return this.card.kill(),this.kill(),this.sleepTime=0,this.boardGame.pile.refresh(),e.next=20,this.boardGame.activateDrawableCards();case 20:this.showTreasureMap=!0;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateTreasureMapSpine=function(e){var t=8-e;if(!(e>8)){var n="";e<=0?n="map_full_big_map":e>=0&&e<8?n="map_"+Math.max(Math.min(t,7),1):8===e&&(n=""),this.spine.skeleton.setAttachment("map_1",n)}},n.createTreasureMap=function(){this.spine=this.scene.add.spine(0,0,Ki.Z.MAP_SPINE.DATA_KEY,Ki.Z.MAP_SPINE.ATLAS_KEY),this.spine.setScale(.135,.135),this.card.add(this.spine)},n.setFacingWithFlippingAnim=function(e){return this.facingUp===e||(e||this.killItems(),this.setFrameCardUp()),Promise.resolve()},n.setMissingMapPieces=function(e,t){void 0===t&&(t=!0),this.missingMapPieces=e,t&&(this.missingMapPiecesAnimation=e)},n.getMissingMapPieces=function(){return this.missingMapPieces},n.getMissingMapPiecesAnimation=function(){return this.missingMapPiecesAnimation},n.getMapPiecePosition=function(e){var t=this.card.getWorldPosition(),n=0;return 1===e||2===e?n=-17:3===e||4===e?n=-6:5===e||6===e?n=7.3:7!==e&&8!==e||(n=19.5),{x:t.x+(e%2===0?10.5:-11),y:t.y+n}},n.runMapAppearAnimation=function(){var e=this.scene.gameplay.spineManager;if(this.updateTreasureMapSpine(this.missingMapPiecesAnimation),this.showTreasureMap)return this.showTreasureMap=!1,this.spine.animationState.clearTracks(),e.playAnimation(this.spine,Xu.MAP.MAP_APPEAR)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.card.cardImage.kill(),this.card.shadow.kill(),this.runMapAppearAnimation()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.card.cardImage.kill(),this.card.shadow.kill()},n.revive=function(){this.scene.gameplay.spineManager.reviveSpine(this.spine),this.spine.animationState.clearTracks(),this.spine.skeleton.setBonesToSetupPose(),this.card.revive(),this.updateSize(),e.prototype.revive.call(this)},n.kill=function(){this.scene.gameplay.spineManager.killSpine(this.spine),e.prototype.kill.call(this)},t}(Ru),ql=jl;function Jl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ql(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ql(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ql(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var $l=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t.resetCurrentAnimation=void 0,t.cancelCollectMapPiece=!1,t.isMapPieceCollected=!1,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.createMapPiece(),this.type=nu.MAP_PIECE,this.cancelCollectMapPiece=!1,e.prototype.init.call(this)},n.onPlayerMove=function(){return this.collectMapPiece()},n.undo=function(){this.isMapPieceCollected=!1,this.card.add(this.spine)},n.getMapPieceWorldPosition=function(){return this.spine.getWorldPosition()},n.showFragment=function(){return this.scene.gameplay.spineManager.playAnimation(this.spine,Xu.MAP.MAP_FRAGMENT_APPEAR)},n.collectMapPiece=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMapPieceCollected){e.next=2;break}return e.abrupt("return");case 2:if(0!==(t=this.getAllTreasureMapCards()).length){e.next=7;break}return e.next=6,this.runDisappearMapPieceAnimation();case 6:return e.abrupt("return");case 7:return e.next=9,this.getNearestTreasureMapCard(t);case 9:if(n=e.sent,i=n.treasureCard,r=n.remainingMissingMapPieces,i&&-1!==r){e.next=16;break}return e.next=15,this.runDisappearMapPieceAnimation();case 15:return e.abrupt("return");case 16:this.effectedCard=i.card,this.runCollectMapPieceAnimation(i,r),this.isMapPieceCollected=!0;case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAllTreasureMapCards=function(){return this.boardGame.pile.cards.filter((function(e){return e.isType(nu.TREASURE)})).map((function(e){return e.behavior}))},n.getNearestTreasureMapCard=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null,i=1/0,r=-1,s=Jl(t);case 4:if((o=s()).done){e.next=12;break}if(!(c=o.value).isMapCollectedAllPieces()){e.next=8;break}return e.abrupt("continue",10);case 8:(h=Phaser.Math.Distance.BetweenPoints(c.card,this.card))<i&&(i=h,n=c);case 10:e.next=4;break;case 12:if(!n){e.next=15;break}return r=n.getMissingMapPieceIndex(),e.abrupt("return",{treasureCard:n,remainingMissingMapPieces:r});case 15:return e.abrupt("return",{treasureCard:null,remainingMissingMapPieces:r});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runDisappearMapPieceAnimation=function(){var e,t=this;null==(e=this.resetCurrentAnimation)||e.call(this);var n=this.scene.add.tween({targets:this.spine,scale:0,duration:200,ease:Phaser.Math.Easing.Back.In,easeParams:[4],onComplete:function(){t.spine.kill()}});return this.resetCurrentAnimation=function(){n.stop()},n.waitForCompletion()},n.runCollectMapPieceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C,w,A,b=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(i=this.resetCurrentAnimation)||i.call(this),this.cancelCollectMapPiece=!1,this.card.setData("isMapPieceCollected",!1),r=8-n,s=t.getMapPiecePosition(r),o=s.x,c=s.y,h=this.spine.getWorldPosition(),u=h.x,l=h.y,this.card.remove(this.spine),this.scene.gameplayLayer.add(this.spine),this.spine.setPosition(u,l),this.spine.setAngle(this.card.angle),d=Math.abs(u-o),p=1+d/800,f=this.scene.gameplay.spineManager,this.spine.animationState.setEmptyAnimations(0),m=0===n,g="part_"+Math.max(Math.min(r,8),1),this.spine.skeleton.setAttachment("part_1",g),this.spine.skeleton.setAttachment("part_1_add2",g),null==(v=this.spine.skeleton.getAttachmentByName("part_1_add2",g))||v.color.set(0,0,0,0),m&&(this.scene.gameplay.setEnableCardInput(!1),this.boardGame.stock.setLockedManual(!0)),y=f.playAnimation(this.spine,Xu.MAP.MAP_FRAGMENT_COLLECT),E=[],C=this.scene.add.tween({targets:this.spine,angle:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),w=this.scene.add.tween({targets:this.spine,x:o,y:c,scale:.07,delay:300,duration:500*p,ease:Phaser.Math.Easing.Quartic.In}),E.push(C,w),this.resetCurrentAnimation=function(){E.forEach((function(e){return e.stop()})),b.spine.animationState.setEmptyAnimations(.1)},(A=[]).push(y),A.push(C.waitForCompletion()),A.push(w.waitForCompletion()),e.next=33,Promise.all(A);case 33:if(!this.cancelCollectMapPiece){e.next=35;break}return e.abrupt("return",Promise.resolve());case 35:return this.scene.gameplayLayer.add(this.spine),this.spine.kill(),this.scene.gameplayLayer.remove(this.spine),e.next=40,t.runAssembleMapPieceAnimation(this.card);case 40:m&&(this.scene.gameplay.setEnableCardInput(!0),this.boardGame.stock.setLockedManual(!1));case 41:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.revive=function(){if(e.prototype.revive.call(this),this.effectedCard){var t=this.effectedCard.behavior,n=t.getMissingMapPieces(),i=this.card.getData("isMapPieceCollected");t.setMissingMapPieces(n+1,i),t.runMapAppearAnimation()}},n.kill=function(){e.prototype.kill.call(this)},n.reviveItems=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cancelCollectMapPiece=!0,t=hu.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT,this.scene.tweens.killTweensOf(this.spine),this.spine.revive(),this.spine.setPosition(n/2-15+5,i/2-12.5+5),this.spine.setScale(.15,.15),e.next=8,this.showFragment();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.destroyItems=function(){var e;this.scene.gameplay.spineManager.killSpine(this.spine),null==(e=this.spine.parentContainer)||e.remove(this.spine),this.spine.destroy()},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.spine&&this.card.exists(this.spine)&&(this.spine.revive(),this.showFragment())},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.spine&&this.card.exists(this.spine)&&this.spine.kill()},n.createMapPiece=function(){var e=this.scene.add.spine(0,0,Ki.Z.MAP_SPINE.DATA_KEY,Ki.Z.MAP_SPINE.ATLAS_KEY),t=hu.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.setPosition(n/2-15+5,i/2-12.5+5),e.setScale(.15,.15),this.card.add(e),this.spine=e},t}(Du),ed=$l,td=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).nut=void 0,t.nutAnimation=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.createNut(),this.type=nu.CHESTNUT,e.prototype.init.call(this)},n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.throwNutToBasket());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.throwNutToBasket=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=(t=this.boardGame.pile.cards.filter((function(e){return e.isType(nu.SQUIRREL)}))).length){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if(this.effectedCard=this.getNearestSquirrelCard(t),(n=this.effectedCard.behavior).activate(),i=n.getRequiredUnlockNuts(),r=this.runThrowNutAnimation(n).then((function(){return n.runCollectNutAnimation(i)})),!(i<=0)){e.next=11;break}return e.next=11,r;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNearestSquirrelCard=function(e){var t=this,n=Phaser.Math.Distance.BetweenPoints(e[0],this.card),i=0;return e.forEach((function(e,r){var a=Phaser.Math.Distance.BetweenPoints(e,t.card);a<n&&(i=r,n=a)})),e[i]},n.undo=function(){var e;null==(e=this.nutAnimation)||e.stop(),this.nut.setPosition(18,25),this.nut.setAngle(0),this.nut.setAlpha(1),this.card.add(this.nut)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.nut&&this.card.exists(this.nut)&&this.nut.revive()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.nut&&this.card.exists(this.nut)&&this.nut.kill()},n.createNut=function(){var e=Ki.Z.GAMEPLAY_OBJECTS,t=e.KEY,n=e.FRAME;this.nut=this.scene.add.image(0,0,t,n.CHESTNUT),this.nut.setScaleByWorld(1),this.nut.setPosition(18,25),this.card.add(this.nut)},n.runThrowNutAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.card,s=r.x,o=r.y,c=this.nut.getWorldPosition(),h=c.x,u=c.y,this.card.remove(this.nut),this.scene.gameplayLayer.add(this.nut),this.scene.gameplayLayer.bringToTop(t.basketContainer),this.scene.gameplayLayer.moveBelow(t.basketContainer,this.card),this.nut.setPosition(h,u),this.nut.setAngle(this.card.angle),l=Math.abs(h-s),d=h>=s?-360:360,p=Phaser.Math.Between(20+.2*l,30+.2*l),f=1+l/800,null==(n=this.nutAnimation)||n.stop(),(m=this.scene.tweens.createTimeline({onComplete:function(){g.nut.kill()}})).add({targets:this.nut,props:{angle:d,x:s+15},duration:600*f,ease:Phaser.Math.Easing.Sine.Out}),m.add({targets:this.nut,y:o-p,duration:300*f,offset:0,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.animateSquirrelBehavior.catch()}}),m.add({targets:this.nut,y:o+22,duration:300*f,ease:Phaser.Math.Easing.Sine.In,onUpdate:function(e){e.getValue()>=o+10&&g.scene.gameplayLayer.moveBelow(g.nut,t.basketContainer)}}),this.nutAnimation=m,e.next=20,null==(i=this.nutAnimation)?void 0:i.playAndWaitForCompletion();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.revive=function(){if(e.prototype.revive.call(this),this.effectedCard){var t=this.effectedCard.behavior,n=t.getRequiredUnlockNuts();t.setRequiredUnlockNuts(n+1)}},n.destroyItems=function(){this.nut.destroy()},n.reviveItems=function(){this.nut.revive(),this.nut.setDefaultWorldSize()},n.kill=function(){e.prototype.kill.call(this)},t}(Du),nd=td,id=[Xu.SQUIRREL.FIND,Xu.SQUIRREL.IDLE,Xu.SQUIRREL.LOOK,Xu.SQUIRREL.IDLE],rd=function(){function e(e,t){this.scene=void 0,this.spine=void 0,this.spineManager=void 0,this.scene=e,this.spine=t,this.spineManager=this.scene.gameplay.spineManager}var t=e.prototype;return t.appear=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Xu.SQUIRREL.APPEAR).then((function(){return t.idle()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.disappear=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Xu.SQUIRREL.DISAPPEAR));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.catch=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Xu.SQUIRREL.CATCH,!1,!0).then((function(){return t.idle()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.idle=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null==(t=this.spine.animationState.getCurrent(0))||null==(t=t.animation)?void 0:t.name,i=id.filter((function(e){return e!==n})),r=Phaser.Utils.Array.GetRandom(i),e.abrupt("return",this.spineManager.playAnimation(this.spine,r).then((function(){return s.idle()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),ad=rd,sd=Ki.Z.GAMEPLAY_OBJECTS,od=sd.KEY,cd=sd.FRAME,hd=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).basketContainer=void 0,t.animateSquirrelBehavior=void 0,t.requiredUnlockNuts=void 0,t.defaultNuts=void 0,t.nutsThrowingAnimation=void 0,t.nutParticles=void 0,t.basket=void 0,t.spine=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=od,this.frameUp=cd.SQUIRREL_CARD,this.type=nu.SQUIRREL,this.createBasketContainer(),this.createSpine(),this.createBasket(),this.createNutParticles(),this.animateSquirrelBehavior=new ad(this.scene,this.spine),e.prototype.init.call(this)},n.activate=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requiredUnlockNuts-=1,!(this.requiredUnlockNuts>0)){e.next=3;break}return e.abrupt("return");case 3:this.removeFromPile();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.bringToTop=function(){e.prototype.bringToTop.call(this),this.scene.gameplayLayer.bringToTop(this.basketContainer)},n.runCollectNutAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.TICK),this.updateAcornsInBasket(this.defaultNuts-t),!(t<=0)){e.next=6;break}return e.next=5,(0,gl.Z)(this.scene,500);case 5:return e.abrupt("return",this.runExitAnimation());case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateAcornsInBasket=function(e){if(e>4)this.basket.setFrame(cd.BASKET_FOUR_ACORN);else switch(e){case 0:default:this.basket.setFrame(cd.BASKET);break;case 1:this.basket.setFrame(cd.BASKET_ONE_ACORN);break;case 2:this.basket.setFrame(cd.BASKET_TWO_ACORN);break;case 3:this.basket.setFrame(cd.BASKET_THREE_ACORN);break;case 4:this.basket.setFrame(cd.BASKET_FOUR_ACORN)}},n.createBasketContainer=function(){this.basketContainer=this.scene.add.container(0,0),this.scene.gameplayLayer.add(this.basketContainer)},n.createBasket=function(){var e=this.scene.add.image(15,22,od,cd.BASKET_TOP);this.basket=this.scene.add.image(0,0,od,cd.BASKET),e.setDefaultWorldSize(),this.basket.setDefaultWorldSize(),this.basket.setPosition(15,22),this.card.add(this.basket),this.basketContainer.add(e)},n.createNutParticles=function(){var e=1/GameCore.ImageScale,t=this.scene.add.particles(od,cd.CHESTNUT);this.nutsThrowingAnimation=t.createEmitter({on:!1,lifespan:{min:750,max:850},gravityY:1e3,scale:{min:.8*e,max:1*e},speedX:{min:-50,max:50},speedY:{min:-300,max:-200},rotate:{start:-360,end:360,random:!0},alpha:{start:1,end:.8,ease:Phaser.Math.Easing.Quadratic.In}}),this.scene.gameplayLayer.add(t),this.nutParticles=t},n.setFacingWithFlippingAnim=function(t,n,i){var r=this;return t||this.killItems(),e.prototype.setFacingWithFlippingAnim.call(this,t,n,i,(function(){r.reviveItems(),r.animateSquirrelBehavior.appear()}))},n.setDefaultRequiredNuts=function(e){this.defaultNuts=e,this.setRequiredUnlockNuts(e)},n.setRequiredUnlockNuts=function(e){this.requiredUnlockNuts=e,this.updateAcornsInBasket(this.defaultNuts-e)},n.getRequiredUnlockNuts=function(){return this.requiredUnlockNuts},n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.animateSquirrelBehavior.disappear(),(t=this.scene.tweens.createTimeline({onComplete:function(){n.kill(),n.boardGame.pile.refresh()}})).add({targets:[this.card,this.spine,this.basketContainer],duration:300,props:{alpha:0},delay:500,onStart:function(){n.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),n.runThrowNutsAnimation()}}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runThrowNutsAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.basket.getWorldPosition(),n=t.x,i=t.y,this.scene.gameplayLayer.bringToTop(this.nutParticles),this.nutsThrowingAnimation.explode(5,n,i);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.spine.setAlpha(1),this.basketContainer.setAlpha(1),this.card.setScale(.2);var n=this.scene.tweens.createTimeline();n.add({targets:[this.card,this.basketContainer],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},offset:0,onComplete:function(){e.updateSize()},onStart:function(){e.card.jump(10,500)}}),n.play(),this.card.jump(10,500)},n.setFrameCardUp=function(){var t,n;e.prototype.setFrameCardUp.call(this),null==(t=this.basketContainer)||t.revive(),null==(n=this.basket)||n.revive()},n.setFrameCardDown=function(t,n){var i,r;e.prototype.setFrameCardDown.call(this,t,n),null==(i=this.basketContainer)||i.kill(),null==(r=this.basket)||r.kill()},n.revive=function(){e.prototype.revive.call(this),this.scene.gameplayLayer.moveAbove(this.basketContainer,this.card),this.spine.revive(),this.animateSquirrelBehavior.idle(),this.runReviveAnimation()},n.reviveItems=function(){this.basketContainer.revive()},n.killItems=function(){this.basketContainer.kill()},n.kill=function(){e.prototype.kill.call(this)},n.destroyItems=function(){this.basketContainer.destroy(),this.nutParticles.destroy()},n.update=function(){var e=this.card,t=e.x,n=e.y,i=e.rotation,r=e.scaleX,a=e.scaleY;this.basketContainer.setPosition(t,n),this.basketContainer.setScale(r,a),this.basketContainer.setRotation(i),Phaser.Math.RotateAround(this.basketContainer,t,n,i)},n.createSpine=function(){var e=this.scene.gameplay.spineManager;this.spine=e.createSpine(0,0,Ki.Z.SQUIRREL_SPINE.DATA_KEY,Ki.Z.SQUIRREL_SPINE.ATLAS_KEY),e.killSpine(this.spine),this.spine.setPosition(5,27),this.card.add(this.spine)},t}(Ru),ud=hd,ld=(Ki.Z.CARD_BACK,Ki.Z.GAMEPLAY),dd=ld.KEY,pd=(ld.FRAME,{id:1,x:100,y:100,angle:0,depth:hu.DEPTH.CARD,type:nu.VALUE,random:!0,faceUp:!1,modifiers:[],sequence:0,suit:1,value:0,isPosUpdated:!1,NumberOfMoves:0,CardChangerType:0,connectedCardID:-1}),fd=function(e){function t(t,n,i){var r;(r=e.call(this,t,0,0)||this).id=void 0,r.scene=void 0,r.payload=void 0,r.facingTween=void 0,r.movingTween=void 0,r.rotateTween=void 0,r.shakeTween=void 0,r.isMoving=void 0,r.behavior=void 0,r.beginPlacement=void 0,r.cardBackground=void 0,r.cardImage=void 0,r.shadow=void 0,r.isLock=void 0,r.isBlur=void 0,r.isMysterious=void 0,r.jumpTween=void 0,r.movingBehavior=void 0,r.blurAnimation=void 0,r.flipRotateTween=void 0,r.scene=t,r.movingBehavior=new zl((0,yc.Z)(r));var a=hu.CARD_VIEW_OFFSET,s=a.x,o=a.y;return r.cardBackground=t.make.image({x:s,y:o,key:Ki.Z.GAMEPLAY_OBJECTS.KEY,frame:Ki.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD}),r.cardBackground.setDefaultWorldSize(),r.cardBackground.setName("Card Background"),r.cardBackground.kill(),r.cardImage=t.make.image({x:s,y:o,key:dd,frame:""}),r.add([r.cardBackground,r.cardImage]),r.isMoving=!1,r.isMysterious=!1,r.isLock=!1,r.isBlur=!1,r.beginPlacement=n,r.z=0,r.payload=(0,p.Z)({},pd,i),1==r.payload.random&&(r.payload.value=Phaser.Math.Between(1,13)),r.shadow=new Pu(r.scene,(0,yc.Z)(r)),r.scene.gameplayLayer.add(r.shadow),r.shadow.kill(),r.scene.add.existing((0,yc.Z)(r)),r.id=GameCore.Utils.String.generateObjectId(),r}(0,f.Z)(t,e);var n=t.prototype;return n.setBehavior=function(e){this.behavior;var t=void 0;e==nu.LOCK&&(t=new cl(this)).setData(this.payload),e==nu.KEY&&(t=new tl(this)).setData(this.payload),e==nu.VALUE&&(t=new Du(this)).setData(this.payload),e==nu.ZAP&&(t=new ml(this)).setData(this.payload),e==nu.BOOM&&(t=new Fu(this)).setData(this.payload),e==nu.SQUIRREL&&(t=new ud(this)).setData(this.payload),e==nu.CHESTNUT&&(t=new nd(this)).setData(this.payload),e==nu.TREASURE&&(t=new ql(this)).setData(this.payload),e==nu.MAP_PIECE&&(t=new ed(this)).setData(this.payload),e==nu.PLUS_ONE&&(t=new pl(this,1)).setData(this.payload),e==nu.PLUS_TWO&&(t=new pl(this,2)).setData(this.payload),e==nu.PLUS_THREE&&(t=new pl(this,3)).setData(this.payload),e==nu.PLUS_FOUR&&(t=new pl(this,4)).setData(this.payload),e==nu.PLUS_FIVE&&(t=new pl(this,5)).setData(this.payload),e==nu.CHANGER&&(t=new Ku(this)).setData(this.payload),e==nu.JOKER&&(t=new Al(this)),e==nu.WINDMILL&&(t=new Rl(this)),e==nu.MYSTERIOUS&&(t=new _l(this)),e==nu.CHAIN&&(t=new Wl(this)),t||(t=new xu(this)),this.behavior=t,t.init()},n.moveWithRotate=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.x,o=t.y,c=t.showShadow,h=void 0===c||c,u=t.duration,l=void 0===u?0:u,d=t.delay,p=void 0===d?0:d,f=t.onStart,m=t.onComplete,s!=this.x||o!=this.y){e.next=3;break}return e.abrupt("return");case 3:if(!this.isMoving){e.next=5;break}return e.abrupt("return");case 5:return null!=(n=this.shakeTween)&&n.isPlaying()&&this.shakeTween.pause(),null==(i=this.movingTween)||i.stop(),null==(r=this.rotateTween)||r.stop(),this.movingTween=this.scene.tweens.createTimeline(),g=Phaser.Math.Between(50,70)+.2*this.y,v=this.scene.gameZone.width/2,y=this.x>=v?-360:360,this.movingTween.add({targets:[this],props:{angle:{from:this.angle,to:y},x:{from:this.x,to:s}},duration:l,offset:p,onStart:f,ease:Phaser.Math.Easing.Sine.Out}),this.movingTween.add({targets:this,y:this.y-g,duration:.4*l,offset:p,ease:Phaser.Math.Easing.Sine.Out}),this.movingTween.add({targets:this,y:o,duration:.6*l,offset:p+.4*l,ease:Phaser.Math.Easing.Sine.In}),h&&this.jump(50,l,0,p),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,l+p),this.isMoving=!0,e.next=21,this.movingTween.playAndWaitForCompletion();case 21:this.isMoving=!1,m&&m();case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.rotate=function(e,t){this.scene.tweens.add({targets:[this],duration:t,props:{angle:{from:this.angle,to:e}}})},n.jump=function(e,t,n,i){var r,a=this;return null==(r=this.jumpTween)||r.remove(),this.jumpTween=this.scene.tweens.add({targets:this,z:{from:0,to:e},yoyo:!0,duration:t/2,delay:i,repeat:n,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){a.setZ(0)}}),this.jumpTween},n.move=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.x,s=t.y,o=t.showShadow,c=void 0===o||o,h=t.duration,u=void 0===h?0:h,l=t.delay,d=void 0===l?0:l,p=t.onStart,f=t.onComplete,r!=this.x||s!=this.y){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return null==(n=this.movingTween)||n.stop(),null==(i=this.rotateTween)||i.stop(),(m=this.scene.tweens.createTimeline({onStart:function(){p&&p()},onComplete:function(){g.isMoving=!1,f&&f()}})).add({targets:this,x:r,y:s,duration:u,delay:d,ease:Phaser.Math.Easing.Sine.Out}),m.play(),this.movingTween=m,c&&this.jump(10,u,0,d),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,u+d),this.isMoving=!0,e.abrupt("return",m.waitForCompletion());case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.fly=function(e,t){var n,i=this;return null==(n=this.jumpTween)||n.remove(),this.jumpTween=this.scene.tweens.add({targets:this,z:{from:0,to:e},yoyo:!0,duration:t/2,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){i.setZ(0)}}),this.jumpTween},n.moveByPulled=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m,g,v,y=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.x,c=n.y,h=n.showShadow,u=void 0===h||h,l=n.duration,d=void 0===l?0:l,p=n.delay,f=void 0===p?0:p,m=n.onStart,g=n.onComplete,o!=this.x||c!=this.y){e.next=3;break}return e.abrupt("return");case 3:return null==(i=this.movingTween)||i.stop(),null==(r=this.rotateTween)||r.stop(),null!=(s=this.shakeTween)&&s.isPlaying()&&this.shakeTween.pause(),this.movingTween=this.scene.tweens.createTimeline(),this.movingTween.add({targets:this,x:o,y:c,duration:d,offset:f,ease:Phaser.Math.Easing.Sine.Out,onStart:m,onComplete:function(){y.isMoving=!1,g&&g()}}),v=this.angle+30,t&&(v=this.angle-30),this.movingTween.add({targets:this,angle:v,duration:d/2,offset:f,ease:Phaser.Math.Easing.Sine.InOut}),this.movingTween.add({targets:this,angle:0,duration:d/2,offset:f+d/2,ease:Phaser.Math.Easing.Sine.InOut}),u&&this.jump(10,d,0,f),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,d+f),this.isMoving=!0,e.abrupt("return",this.movingTween.playAndWaitForCompletion());case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.flipRotate=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(i=this.flipRotateTween)||!i.isPlaying()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=this.scene.tweens.createTimeline(),s=t/2,r.add({targets:this,angle:{from:0,to:n},duration:s,onYoyo:function(){o.behavior.setFrameCardDown()}}),r.add({targets:this,scaleX:{from:1,to:0},yoyo:!0,offset:0,duration:s/4,onYoyo:function(){o.behavior.setFrameCardDown()}}),r.add({targets:this,scaleX:{from:1,to:0},yoyo:!0,duration:s/2,offset:s/2,onYoyo:function(){o.behavior.setFrameCardUp()}}),r.add({targets:this,angle:{from:n,to:0},duration:s,offset:s,onYoyo:function(){o.behavior.setFrameCardDown()}}),this.flipRotateTween=r,e.abrupt("return",r.playAndWaitForCompletion());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.isOnAnimation=function(){return 0!=this.scene.tweens.getTweensOf(this).length},n.moveToTopLayer=function(){if(!this.isLock){var e=this.behavior;if(e instanceof Wl){if(e.connectedCard.isLock)return;this.scene.gameplayLayer.bringToTop(this.shadow),this.scene.gameplayLayer.bringToTop(this),e.moveToTopLayer()}else this.scene.gameplayLayer.bringToTop(this.shadow),this.scene.gameplayLayer.bringToTop(this)}},n.setLock=function(e){this.isLock=e,e?(this.setBlur(!0),this.disableInteractive()):(this.setBlur(!1),this.setInteractive({useHandCursor:!0}))},n.setBlur=function(e){var t;this.isBlur!=e&&(this.isBlur=e,null==(t=this.blurAnimation)||t.remove(),this.blurAnimation=e?this.scene.tweens.add({targets:this,alpha:.7,duration:300}):this.scene.tweens.add({targets:this,alpha:1,duration:300}))},n.setCardFrame=function(e,t){!isNaN(Number(t.split("/")[1]))?this.cardBackground.revive():this.cardBackground.kill(),this.cardImage.setTexture(e,t)},n.revive=function(){e.prototype.revive.call(this),this.setAlpha(1)},n.setPosition=function(t,n,i,r){return e.prototype.setPosition.call(this,t,n,this.z,r)},n.getRotatedRectangle=function(){var e=this.cardImage.getTopLeft(),t=this.cardImage.getTopRight(),n=this.cardImage.getBottomLeft(),i=[e,t,this.cardImage.getBottomRight(),n];return Phaser.Geom.Rectangle.FromPoints(i)},n.shake=function(e,t,n){var i,r;void 0===n&&(n=!0),this.isMoving||null!=(i=this.shakeTween)&&i.isPlaying()||(null!=(r=this.shakeTween)&&r.paused?this.shakeTween.play():(this.shakeTween=Eu(this.scene,{targets:[this],currentAngle:this.angle,duration:t,shakingAngle:e}),n&&this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.MISS_TAP_CARD)))},n.isType=function(){if(0==this.active)return!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.behavior.type)},n.kill=function(){e.prototype.kill.call(this),this.behavior.kill(),this.shadow.kill()},n.setInteractive=function(t,n,i){return e.prototype.setInteractive.call(this,(0,p.Z)({},t,{useHandCursor:!0}),n,i)},n.update=function(e){this.behavior.update(e)},n.postUpdate=function(){if(this.shadow.setVisible(this.z>0&&this.visible),this.shadow.visible){this.shadow.updateFromParent();var e=1/GameCore.ImageScale;this.shadow.setScaleFromParent(this.scaleX*e,this.scaleY*e);var t=this.x+.33*this.z,n=this.y+this.z;this.shadow.setPosition(t,n)}this.behavior.postUpdate()},t}(Phaser.GameObjects.Container),md=function(){function e(){this.currentRatio=void 0,this.matchRatio=void 0,this.commonDifference=void 0,this.hardRatio=void 0,this.currentRatio=0,this.matchRatio=0,this.commonDifference=0,this.hardRatio=1}var t=e.prototype;return t.setHardRatioByCoins=function(e){var t=1;t=e<=500?1.5:e>=1e4?1:1.5-(e-500)/9500*.5,this.hardRatio=t},t.setConfig=function(e,t){this.matchRatio=e,this.commonDifference=t},t.reset=function(){this.currentRatio=this.matchRatio*this.hardRatio},t.onRandomCanNotMatch=function(){var e=this.commonDifference;this.currentRatio=Math.min(this.currentRatio+e*this.hardRatio,100)},t.getMatchRatio=function(){return this.currentRatio/100},t.setCurrentRatio=function(e){this.currentRatio=e},e}(),gd=function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.cards=void 0,this.lastMovingCard=void 0,this.matchRatioCalculator=void 0,this.postUpdate=function(){t.cards.forEach((function(e){return e.active&&e.postUpdate()}))},this.boardGame=e,this.scene=e.scene,this.cards=[],this.matchRatioCalculator=new md,this.scene.events.on("postupdate",this.postUpdate,this),this.matchRatioCalculator.reset()}var t=e.prototype;return t.setLastMovingCard=function(e,t){if(this.lastMovingCard){var n=this.lastMovingCard,i=n.card,r=n.duration;(1-i.movingTween.progress)*r<t&&(this.lastMovingCard={card:e,duration:t})}else this.lastMovingCard={card:e,duration:t}},t.getCard=function(e){return this.cards.find((function(t){return t.id==e}))},t.getNewCard=function(e,t){var n=new fd(this.scene,e,t);return this.scene.gameplayLayer.add(n),this.cards.push(n),n},t.getJokerCard=function(){var e=this.getNewCard(au.None);return e.setBehavior(nu.JOKER),e.behavior.setFrameCardUp(),e},t.getWindmillCard=function(){var e=this.getNewCard(au.Stock);return e.setBehavior(nu.WINDMILL),e.behavior.setFrameCardUp(),e},t.getNewStockCard=function(){var e=this.getNewCard(au.Stock);return e.setBehavior(),e},t.getMatchesForPile=function(e,t){var n=function(n){if(!n.behavior.random){var i=n.behavior.value;n.behavior instanceof Ku&&(i=n.behavior.getNextValue()),e.forEach((function(n,r){if(!(n.value<0||n.suit<0)){var a=Math.abs(i-n.value);1!=a&&12!=a||(t.push(n),e[r]={suit:-1,value:-1})}}))}};this.boardGame.pile.getFrontCards().forEach(n);var i=this.boardGame.waste.getOnTopCard();i&&n(i)},t.getRandomValue=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e[Phaser.Math.Between(0,51)]},t.getRandomPileCard=function(){var e=this.getAllCardData(),t=this.boardGame.pile.getFrontCards(),n=e.filter((function(e){var n=e.value,i=e.suit;return!t.some((function(e){return e.behavior.value==n&&e.behavior.suit==i}))}));return n[Phaser.Math.RND.between(0,n.length-1)]},t.getAllCardData=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e},t.getRandomValueByMatchRatio=function(){for(var e=this.matchRatioCalculator.getMatchRatio(),t=[],n=[],i=[],r=1;r<=4;r++)for(var a=1;a<=13;a++)t.push({suit:r,value:a});if(this.getMatchesForPile(t,n),0==n.length)return this.getRandomValue();t.forEach((function(e){e.value>0&&e.suit>0&&i.push(e)}));for(var s=i.length-Math.min(Math.round(i.length*(1-e)),2*n.length),o=0;o<s;o++){var c=Phaser.Math.Between(0,i.length-1);if(i.splice(c,1),i.length<1)break}var h=[].concat(n,i),u=[].concat(this.boardGame.pile.getFrontCards()),l=this.boardGame.waste.getOnTopCard();l&&u.push(l);for(var d=h.filter((function(e){var t=e.value,n=e.suit;return!u.some((function(e){return e.behavior.value==t&&e.behavior.suit==n}))})),p=Phaser.Math.Between(0,d.length-1),f=0;f<2;f++){if(!u.some((function(e){return e.behavior.value==d[p].value})))break;p=Phaser.Math.Between(0,d.length-1)}var m=d[p];return n.includes(m)?this.matchRatioCalculator.reset():this.matchRatioCalculator.onRandomCanNotMatch(),m},t.clear=function(){this.cards.forEach((function(e){var t;null==(t=e.behavior)||t.destroyItems(),e.shadow.destroy(),e.destroy()})),this.cards=[],this.matchRatioCalculator.reset()},e}(),vd=function(e){function t(t){var n;return(n=e.call(this,t)||this).collectedCardCount=0,n.draw=function(){var e=(0,i.Z)(a().mark((function e(t,i){var r,s,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=800),t&&!t.isMoving){e.next=3;break}return e.abrupt("return");case 3:if(n.boardGame.hint.resetAutoHintTime(),!n.checkOverlap(t)){e.next=8;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 8:if(0!=t.behavior.facingUp&&(null==(r=t.behavior)?void 0:r.type)!==nu.LOCK&&(null==(s=t.behavior)?void 0:s.type)!==nu.SQUIRREL&&(null==(o=t.behavior)?void 0:o.type)!==nu.TREASURE){e.next=12;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 12:if(c=n.boardGame.waste,h=c.getOnTopCard()){e.next=18;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 18:if(n.isMatch(t,h)){e.next=23;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 23:return n.boardGame.mover.increaseMoves(),n.collectedCardCount+=1,n.scene.events.emit(Iu.Z.COLLECT_CARD,t),n.emitUseWildCardTaskEvent(h),n.handleMatch(t),u=n.canUnlockBreakers(t),e.next=32,t.behavior.activate(u);case 32:return n.refresh(),e.next=35,n.boardGame.onPlayerMove();case 35:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.setName(au.Pile),n}(0,f.Z)(t,e);var n=t.prototype;return n.getCollectedCardCount=function(){return this.collectedCardCount},n.setNutsInSquirrel=function(){var e=this.cards.filter((function(e){return e.isType(nu.CHESTNUT)})),t=this.cards.filter((function(e){return e.isType(nu.SQUIRREL)}));if(0!=e.length&&0!=t.length){var n=Math.floor(e.length/t.length),i=e.length;t.forEach((function(e,r){r===t.length-1&&(n=i),i-=n,e.behavior.setDefaultRequiredNuts(n)}))}},n.setTreasureMapCards=function(){var e=this.cards.filter((function(e){return e.isType(nu.MAP_PIECE)})),t=this.cards.filter((function(e){return e.isType(nu.TREASURE)}));if(0!=e.length&&0!=t.length){var n=t.length,i=e.length,r=8*n-i,a=Array.from({length:n},(function(e,t){var i=Math.floor(r/n);return t<r%n?i+1:i}));t.forEach((function(e){var t=8-(a.shift()||0);e.behavior.setMissingMapPieces(t)}))}},n.connectChainCard=function(){var e=this.cards.filter((function(e){return e.isType(nu.CHAIN)}));e.forEach((function(t){var n=e.find((function(e){return e.payload.id!==t.payload.id&&e.payload.connectedCardID==t.payload.connectedCardID})),i=t.behavior;i.setConnectedCard(n),i.initRope()}))},n.clear=function(){e.prototype.clear.call(this)},n.clearHistoryCollectedCards=function(){this.collectedCardCount=0},n.addCard=function(t){var n=this;e.prototype.addCard.call(this,t),t.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),t.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){n.boardGame.gameplay.enableCardInput&&n.boardGame.stateMachine.emit(tu.DRAW_PILE,t)})),t.setInteractive({useHandCursor:!0})},n.handleMatch=function(e){var t=this.boardGame.mover,n=this.boardGame.gameplay.comboManager;this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.DRAW_CARD),this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.START_MOVE_TO_WASTE),t.addUndoCard(e,au.Pile,au.Waste),n.increaseComboWithSound(e)},n.getLockCards=function(){return this.cards.filter((function(e){return e.behavior instanceof cl}))},n.canUnlockBreakers=function(e){return this.boardGame.locks.some((function(t){return t.isMatch(e)}))},n.handleWithLock=function(e){for(var t=this.boardGame.locks,n=0;n<t.length;n++){var i=t[n];if(0==i.isUnlock){var r=i.unlockSegment(e);if(r)return r}}},n.isMatch=function(e,t){var n,i;if(e.isBlur||t.isBlur)return!1;if((null==(n=e.behavior)?void 0:n.type)==nu.JOKER||(null==(i=t.behavior)?void 0:i.type)==nu.JOKER)return!0;if(0==e.behavior.checkCardHasValue())return!1;var r=Math.abs(t.behavior.value-e.behavior.value);return 1==r||12==r},n.getFrontCards=function(){var e=this;return this.cards.filter((function(t){if(!t.isBlur&&t.behavior.checkCardHasValue()&&!e.checkOverlap(t))return t}))},n.getDownCards=function(){var e=this;return this.cards.filter((function(t){if(!t.isBlur&&t.behavior.checkCardHasValue()&&e.checkOverlap(t))return t}))},n.isOverLap=function(e,t){for(var n=e.behavior.getPoints(),i=t.behavior.getPoints(),r=0;r<4;r++)for(var a=3==r?0:r+1,s=new Phaser.Geom.Line(n[r].x,n[r].y,n[a].x,n[a].y),o=0;o<4;o++){var c=3==o?0:o+1,h=new Phaser.Geom.Line(i[o].x,i[o].y,i[c].x,i[c].y);if(Phaser.Geom.Intersects.LineToLine(s,h))return!0}return!1},n.checkOverlap=function(e){for(var t=this.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),n=0;n<t.length;n++){if(this.isOverLap(t[n],e))return t[n]}},n.refresh=function(){this.flipCards(),this.boardGame.lockCards(),this.updateChainCards()},n.flipCards=function(){var e=this;this.cards.forEach((function(t){e.checkOverlap(t)?0==t.payload.faceUp&&t.behavior.setFacingWithFlippingAnim(!1):t.behavior.setFacingWithFlippingAnim(!0)}))},n.flipCardsStagger=function(){var e=this;return new Promise((function(t){var n=e.cards.filter((function(t){if(t.behavior instanceof Ru){var n=e.checkOverlap(t);return t.payload.faceUp||!n}})),i=e.scene.time.addEvent({delay:60,repeat:n.length-1,callback:function(){var r=n.shift();r&&(r.behavior.setFacingWithFlippingAnim(!0),e.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.OPEN_CARD),0==i.repeatCount&&t())}})}))},n.updateChainCards=function(){this.cards.filter((function(e){return e.isType(nu.CHAIN)})).forEach((function(e){return e.behavior.refresh()}))},n.animateChainCards=function(){var e=this;this.cards.forEach((function(e){e.behavior instanceof Wl&&e.behavior.hideChain(!1)})),this.scene.time.delayedCall(500,(function(){e.cards.forEach((function(e){e.behavior instanceof Wl&&e.behavior.showChain(!0)}))}))},n.getCardsWithType=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.cards.filter((function(t){return t.isType.apply(t,n)&&!t.isBlur&&!e.checkOverlap(t)}))},n.emitUseWildCardTaskEvent=function(e){e.behavior.type===nu.JOKER&&$h.emit(jh.USE_WILDCARDS.EVENTS.USE_WILDCARD,{type:"wildCards",value:1})},t}(pu),yd=function(e){function t(t){var n;return(n=e.call(this,t)||this).setName(au.Waste),n}(0,f.Z)(t,e);var n=t.prototype;return n.refresh=function(){this.getOnTopCard()},n.addCard=function(t){e.prototype.addCard.call(this,t),t.disableInteractive()},n.setY=function(e){this.cards.forEach((function(t){return t.setY(e)})),this.y=e},n.removeCard=function(t){var n=e.prototype.removeCard.call(this,t),i=this.getOnTopCard();return i&&i.behavior.show(),n},n.getOnTopCard=function(){if(0!=this.cards.length){var e=this.cards.length;return this.cards[e-1]}},n.clear=function(){e.prototype.clear.call(this)},n.addCounterKillItem=function(){var e=this,t=this.getOnTopCard(),n=this.cards[this.cards.length-2];t&&n&&this.scene.tweens.addCounter({onUpdate:function(e){0==t.isMoving&&e.complete()},completeDelay:150,onComplete:function(){e.cards[e.cards.length-2]===n&&e.cards.some((function(e){return n===e}))&&n.behavior.hide()}})},t}(pu),Ed=function(){function e(e,t){this.scene=void 0,this.operationData=void 0,this.scene=e,this.operationData=t}var t=e.prototype;return t.undo=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.operationData,n=t.cardState,i=t.originalPlacement,t.toPlacement,this.scene.gameplay.boardGame.deck.getCard(n.id)){e.next=4;break}return e.abrupt("return");case 4:i==au.Pile&&this.returnPile(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.returnPile=function(e){var t=e.x,n=e.y,i=e.id,r=e.angle,a=this.scene.gameplay.boardGame,s=a.deck,o=a.waste,c=a.pile,h=s.getCard(i);h&&(h.rotate(r,300),h.move({x:t,y:n,duration:300}),this.operationData.toPlacement==au.Waste&&(o.removeCard(h),c.addCard(h)))},e}(),Cd=Ed,wd=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).vertexes=void 0,n.flag=void 0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,yc.Z)(n)),n.setVertexes([{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}]),n.scene.events.on(Phaser.Scenes.Events.PRE_RENDER,n.update,(0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.resetTransforms=function(){this.setVertexes([{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}])},n.triggerFlag=function(){this.flag=!0},n.update=function(){if(this.flag){this.faces=[];var e=this.vertexes,t=this.findIntersectionPointOfTwoLines(e[0].x,e[0].y,e[2].x,e[2].y,e[1].x,e[1].y,e[3].x,e[3].y);if(!t)throw new Error("Invalid vertexes");for(var n=this.getVertex(t,{x:0,y:0}),i=[{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}],r=this.getVertex(e[e.length-1],i[e.length-1]),a=0;a<4;a++){var s=this.getVertex(e[a],i[a]);this.addFace(n,r,s),r=s}this.flag=!1}},n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.flag=!0,this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.flag=!0},n.findIntersectionPointOfTwoLines=function(e,t,n,i,r,a,s,o){var c=(e-n)*(a-o)-(t-i)*(r-s);return 0===c?null:{x:((e*i-t*n)*(r-s)-(e-n)*(r*o-a*s))/c,y:((e*i-t*n)*(a-o)-(t-i)*(r*o-a*s))/c}},n.setVertexes=function(e){if(4!=e.length)throw new Error("Vertexes must have 4 points");this.vertexes=e,this.flag=!0},n.getVertex=function(e,t){var n=e.x,i=e.y,r=this.frame,a=r.u0,s=r.v0,o=r.u1,c=r.v1-s,h=a+(o-a)*(.5+t.x),u=s+c*(.5+t.y);return new Phaser.Geom.Mesh.Vertex(n,-i,0,h,u)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.cancelAnimations=function(){this.scene.tweens.killTweensOf(this.vertexes[0]),this.scene.tweens.killTweensOf(this.vertexes[1]),this.scene.tweens.killTweensOf(this.vertexes[2]),this.scene.tweens.killTweensOf(this.vertexes[3])},n.transformTo=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(4==t.length){e.next=2;break}throw new Error("Vertexes must have 4 points");case 2:return i=this.scene.tweens.add((0,p.Z)({targets:this.vertexes[0],props:{x:t[0].x,y:t[0].y},onUpdate:function(){c.triggerFlag()}},n)).waitForCompletion(),r=this.scene.tweens.add((0,p.Z)({targets:this.vertexes[1],props:{x:t[1].x,y:t[1].y},onUpdate:function(){c.triggerFlag()}},n)).waitForCompletion(),s=this.scene.tweens.add((0,p.Z)({targets:this.vertexes[2],props:{x:t[2].x,y:t[2].y},onUpdate:function(){c.triggerFlag()}},n)).waitForCompletion(),o=this.scene.tweens.add((0,p.Z)({targets:this.vertexes[3],props:{x:t[3].x,y:t[3].y},onUpdate:function(){c.triggerFlag()}},n)).waitForCompletion(),e.next=8,Promise.all([i,r,s,o]);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getAlignedPosition=function(e){var t=this.calcAlignedScalar(e),n=t.x,i=t.y,r=n*Math.cos(-this.rotation)-i*Math.sin(-this.rotation),a=n*Math.sin(-this.rotation)+i*Math.cos(-this.rotation),s=this.width*r,o=this.height*a;return{x:this.x+s,y:this.y+o}},n.calcAlignedScalar=function(e){switch(e){case"center":return{x:this.vertexes[0].x+this.vertexes[1].x+this.vertexes[2].x+this.vertexes[3].x,y:this.vertexes[0].y+this.vertexes[1].y+this.vertexes[2].y+this.vertexes[3].y};case"bottom":return{x:t.getMiddleOf(this.vertexes[2].x,this.vertexes[3].x),y:t.getMiddleOf(this.vertexes[2].y,this.vertexes[3].y)};case"top":return{x:t.getMiddleOf(this.vertexes[0].x,this.vertexes[1].x),y:t.getMiddleOf(this.vertexes[0].y,this.vertexes[1].y)};case"left":return{x:t.getMiddleOf(this.vertexes[0].x,this.vertexes[3].x),y:t.getMiddleOf(this.vertexes[0].y,this.vertexes[3].y)};case"right":return{x:t.getMiddleOf(this.vertexes[1].x,this.vertexes[2].x),y:t.getMiddleOf(this.vertexes[1].y,this.vertexes[2].y)}}},n.calcVerticesFromShear=function(e,n){return t.calcVerticesFromShear(e,n)},t.calcVerticesFromShear=function(e,t){var n=.5,i=Phaser.Math.DegToRad(e),r=Phaser.Math.DegToRad(-t),a=[Math.cos(i)*n,Math.sin(i)*n],s=[Math.sin(r)*n,Math.cos(r)*n];return[{x:-a[0]+s[0],y:a[1]-s[1]},{x:a[0]+s[0],y:-a[1]-s[1]},{x:a[0]-s[0],y:-a[1]+s[1]},{x:-a[0]-s[0],y:a[1]+s[1]}]},t.getMiddleOf=function(e,t){var n=Math.min(e,t);return n+(Math.max(e,t)-n)/2},t}(Phaser.GameObjects.Mesh),Ad=wd,bd=Ad.calcVerticesFromShear(.28279,65.16991),Sd=Ad.calcVerticesFromShear(-.28279,-65.16991),Td=Ad.calcVerticesFromShear(10.03711,59.04073),xd=Ad.calcVerticesFromShear(-10.03711,-59.04073),kd=Ad.calcVerticesFromShear(-6.37585,-26.18271),Pd=Ad.calcVerticesFromShear(6.37585,26.18271),Id=function(e){function t(t,n,i){var r;return void 0===n&&(n=Ki.Z.GAMEPLAY_OBJECTS.KEY),void 0===i&&(i=Ki.Z.GAMEPLAY_OBJECTS.FRAME.SLICE_CARD),(r=e.call(this,t)||this).cancelCurrentAnimation=void 0,r.setTexture(n,i),r.setWorldSize(54,78),r.setDepth(99999),r}(0,f.Z)(t,e);var n=t.prototype;return n.cancelAnimations=function(){var e;this.scene.tweens.killTweensOf(this),null==(e=this.cancelCurrentAnimation)||e.call(this)},n.runAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.targets,i=t.isShadow,r=t.interlaceRightLeftRight,s=void 0===r||r,o=t.startingPosition,c=t.startingScale,h=void 0===c?1.4:c,u=t.lastCardBehaviour,l=void 0===u?"hide":u,d=t.onHit,p=t.onWindup,f=t.onPositionChanged,0!==n.length){e.next=3;break}return e.abrupt("return");case 3:return m=this.interlaceTargets(n,s),g=s,v=!1,this.cancelCurrentAnimation=function(){v=!0},e.next=9,this.playWindUpAnimation(m[0],g,o,h,i,f);case 9:if(!v){e.next=11;break}return e.abrupt("return");case 11:y=0;case 12:if(!(y<m.length)){e.next=24;break}if(!v){e.next=15;break}return e.abrupt("return");case 15:return E=m[y],null==p||p(E),C=y===m.length-1?l:"anticipate",e.next=20,this.playSliceAnimation(E,g,C,i,d,f);case 20:g=!g;case 21:y++,e.next=12;break;case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.interlaceTargets=function(e,t){void 0===t&&(t=!0);var n=[].concat(e);n.sort((function(e,t){return e.x-t.x}));for(var i=[],r=t;n.length>0;){if(r){var a=n.pop();if(!a)break;i.push(a)}else{var s=n.shift();if(!s)break;i.push(s)}r=!r}return i},n.calcWindupX=function(e,t){return void 0===t?e?50:this.scene.gameZone.width-50:e?Math.max(50,t.x-50):Math.min(this.scene.gameZone.width-50,t.x+50)},n.playWindUpAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s,o){var c,h,u,l,d,p,f,m,g,v,y,E,C=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=1.4),void 0===s&&(s=!1),this.resetTransforms(),c=467,h=t.getWorldPosition(),u=this.calcWindupX(n,i),l=n?5:-5,d=i?i.x:this.scene.gameZone.width/2,p=i?i.y:this.scene.gameZone.height/2,f=s?20:0,m=h.y+f,this.setPosition(d,p),this.setAngle(0),this.setScale(r),g=this.scene.tweens.add({targets:this,y:m,angle:l,scaleX:1.2,scaleY:.8,ease:Phaser.Math.Easing.Cubic.InOut,delay:93.4,duration:373.6}).waitForCompletion(),v=this.scene.tweens.add({targets:this,x:u,ease:Phaser.Math.Easing.Back.In,duration:c,onUpdate:function(){null==o||o(C)}}).waitForCompletion(),y=n?this.calcVerticesFromShear(-7.55949,40.75979):this.calcVerticesFromShear(7.55949,-40.75979),E=this.transformTo(y,{duration:c,ease:Phaser.Math.Easing.Back.In,easeParams:[5]}),e.next=20,Promise.all([v,g,E]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a,s){return e.apply(this,arguments)}}(),n.playSliceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s,o){var c,h,u,l,d,p,f,m,g,v,y,E,C,w,A,b,S,T=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i="anticipate"),void 0===r&&(r=!1),c=400,h=t.getWorldPosition(),u=n?-5:5,0,l=this.calcEndX(t,n,i),d=r?5:0,p=h.y+d,f=h.y+t.height/2,m=this.calcEndScale(i),g=m.x,v=m.y,y=this.scene.tweens.add({targets:this,x:l,duration:c,ease:Phaser.Math.Easing.Expo.InOut,onUpdate:function(){null==o||o(T)}}).waitForCompletion(),E=[this.scene.tweens.add({targets:this,y:p,duration:160,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:this,y:f,scaleX:g,scaleY:v,delay:160,duration:240,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()],C=[this.scene.tweens.add({targets:this,angle:u,duration:200,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){null==s||s(t,n)}}).waitForCompletion(),this.scene.tweens.add({targets:this,angle:0,delay:200,duration:200,ease:Phaser.Math.Easing.Sine.Out}).waitForCompletion()],w=n?bd:Sd,A=n?Td:xd,b=this.calcSliceFinishedPerspective(n,i),S=[this.transformTo(w,{duration:120,ease:Phaser.Math.Easing.Sine.In}),this.transformTo(A,{delay:120,duration:120,ease:Phaser.Math.Easing.Sine.InOut}),this.transformTo(b,{delay:240,duration:160,ease:Phaser.Math.Easing.Sine.Out})],e.next=20,Promise.all([y].concat(E,S,C));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a,s){return e.apply(this,arguments)}}(),n.calcSliceFinishedPerspective=function(e,t){return"anticipate"===t?e?kd:Pd:[{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}]},n.calcEndScale=function(e){return"stay-and-reset"===e?{x:1,y:1}:{x:1.2,y:.8}},n.calcEndX=function(e,t,n){switch(void 0===n&&(n="anticipate"),n){case"anticipate":return t?this.scene.gameZone.width-.5*e.width:.5*e.width;case"hide":return t?this.scene.gameZone.width+e.width:-e.width;case"stay-and-reset":return t?e.getWorldPosition().x+1.5*e.width:e.getWorldPosition().x-1.5*e.width}},n.revive=function(){e.prototype.revive.call(this),this.setAngle(0),this.resetTransforms()},t}(Ad),Od=Id;function Rd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Dd=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.undoCards=void 0,this.canAddUndo=void 0,this.moves=void 0,this.undoLocks=void 0,this.undoUsageChanges=void 0,this.operations=void 0,this.sliceAnimations=void 0,this.sliceAnimationCancelHandlers=void 0,this.scene=e,this.boardGame=t,this.canAddUndo=!0,this.undoCards=[],this.undoLocks=[],this.undoUsageChanges=[],this.moves=0,this.operations=[],this.sliceAnimations=[],this.sliceAnimationCancelHandlers=[],t.stateMachine.on(tu.UNDO,this.undo,this)}var t=e.prototype;return t.fromPileToWaste=function(e){var t=this.boardGame.pile,n=this.boardGame.waste;t.removeCard(e)&&(n.addCard(e),$h.emit(jh.CLEAR_CARDS.EVENTS.CLEAR_CARDS,{type:"cards",value:1,card:e}))},t.fromStockToWaste=function(e){var t=this.boardGame.stock,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.setCanAddUndo=function(e){this.canAddUndo=e},t.moveToLockAndWaste=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C,w=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,s=void 0,o=function(){var e,n;(r=!0,t.setAlpha(1),w.scene.tweens.killTweensOf(t),s)&&(s.cardImage.cancelAnimations(),s.cardBackground.cancelAnimations(),null==(e=s.cardShadow)||e.cancelAnimations(),s.cardImage.kill(),s.cardBackground.kill(),null==(n=s.cardShadow)||n.kill());w.removeSliceAnimationCancelHandler(t)},this.addSliceAnimationCancelHandler(t,o),c=this.boardGame.waste,n.setVisible(!0),h=t.x<this.scene.gameZone.width/2,e.next=9,t.behavior.waitUntilFacingUp();case 9:if(s=this.getSliceAnimations(),l=(u=s).cardImage,d=u.cardBackground,p=u.cardShadow,this.copyCardToSliceAnimations(t,l,d,p),p&&this.scene.gameplayLayer.bringToTop(p),this.scene.gameplayLayer.bringToTop(d),this.scene.gameplayLayer.bringToTop(l),null==p||p.setAlpha(0),l.setAlpha(1),d.setAlpha(1),t.setAlpha(0),f=t.getWorldPosition(),null==p||p.setPosition(f.x,f.y),l.setPosition(f.x,f.y),d.setPosition(f.x,f.y),null==p||p.setAngle(t.angle),l.setAngle(t.angle),d.setAngle(t.angle),!r){e.next=28;break}return e.abrupt("return");case 28:return m=n.getWorldPosition(),g=f.x<m.x,v=function(){n.parent.killLockSegment(n),n.parent.isUnlock&&n.parent.preKill(),w.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.UNLOCK_LOCK,{volume:.5})},y=function(e){if(t.behavior instanceof Wl){var n=e.getAlignedPosition("bottom"),i=n.x,r=n.y;t.setPosition(i,r-t.displayHeight/2)}},E=t.getWorldPosition(),e.next=35,Promise.all([this.scene.tweens.add({targets:p,alpha:1,duration:.4*i}).waitForCompletion(),null==p?void 0:p.runAsync({isShadow:!0,targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset"}),l.runAsync({targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset"}),d.runAsync({targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset",onHit:v,onPositionChanged:y})]);case 35:if(!r){e.next=37;break}return e.abrupt("return");case 37:return null==p||p.kill(),l.kill(),d.kill(),C=d.getWorldPosition(),t.setPosition(C.x,C.y),t.setAlpha(1),t.setAngle(0),e.next=46,Promise.all([this.scene.tweens.add({targets:t,angle:h?-360:360,x:c.x,duration:i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:t,y:t.y-50,duration:i/2,ease:Phaser.Math.Easing.Quadratic.Out}).waitForCompletion(),this.scene.tweens.add({targets:t,y:c.y,delay:i/2,duration:i/2,ease:Phaser.Math.Easing.Quadratic.InOut,onComplete:function(){w.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FINISH_MOVE_TO_WASTE)}}).waitForCompletion()]);case 46:if(!r){e.next=48;break}return e.abrupt("return");case 48:this.removeSliceAnimationCancelHandler(t);case 49:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t.moveToWaste=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.boardGame.waste,i=t.src,r=t.card,s=t.duration,o=t.lockSegment,r.behavior.bringToTop(),e.t0=i.name,e.next=e.t0===au.Stock?6:e.t0===au.Pile?13:22;break;case 6:return this.fromStockToWaste(r),c=r.behavior.setFacingWithFlippingAnim(!0),h=this.boardGame.scene.tweens.add({targets:r,angle:{from:0,to:15},duration:s/2,yoyo:!0,onComplete:function(){l.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FINISH_MOVE_TO_WASTE)}}).waitForCompletion(),u=r.move({x:n.x,y:n.y,duration:s}),e.next=12,Promise.all([c,h,u]);case 12:case 21:return e.abrupt("return");case 13:if(this.fromPileToWaste(r),!o){e.next=19;break}return e.next=17,this.moveToLockAndWaste(r,o,s);case 17:e.next=21;break;case 19:return e.next=21,r.moveWithRotate({x:n.x,y:n.y,duration:s,onComplete:function(){l.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FINISH_MOVE_TO_WASTE)}});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.removeLockSegments=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],400,i=a().mark((function e(){var i,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t[r],void 0!==(o=s.boardGame.pile.handleWithLock(i))){e.next=4;break}return e.abrupt("return",1);case 4:o.setVisible(!0),c=400+100*r,h=(0,gl.Z)(s.scene,c),u=h.then((function(){o.parent.killLockSegment(o),s.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.UNLOCK_LOCK,{volume:.5}),o.parent.isUnlock&&o.parent.preKill()})),n.push(u);case 9:case"end":return e.stop()}}),e)})),r=0;case 4:if(!(r<t.length)){e.next=11;break}return e.delegateYield(i(),"t0",6);case 6:if(!e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:r++,e.next=4;break;case 11:return e.next=13,Promise.all(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.moveFromWaste=function(e,t,n){if(this.boardGame.waste.removeCard(t),e.name==au.Pile){var i=t.payload,r=i.x,a=i.y,s=i.angle;n&&t.rotate(t.payload.angle,300),this.boardGame.pile.addCard(t),t.revive(),t.setAngle(s),t.move({x:r,y:a,duration:300})}if(e.name==au.Stock){var o=this.boardGame.stock,c=o.x,h=o.y;this.boardGame.stock.addCard(t),this.boardGame.stock.animateAlignCards(),0==t.isType(nu.JOKER)&&t.behavior.setFacingWithFlippingAnim(!1),t.move({x:c,y:h,duration:300})}},t.getUndoCards=function(e){for(var t=[],n=this.undoCards.length-1;n>=0;n--){var i=this.undoCards[n];i.moves==e&&t.push(i)}var r=this.undoCards.filter((function(t){return t.moves!=e}));return this.undoCards=r,t},t.getUndoLocks=function(e){for(var t=[],n=this.undoLocks.length-1;n>=0;n--){var i=this.undoLocks[n];i.moves==e&&t.push(i)}var r=this.undoLocks.filter((function(t){return t.moves!=e}));return this.undoLocks=r,t},t.getUndoUsageChanges=function(e){for(var t=[],n=this.undoUsageChanges.length-1;n>=0;n--){var i=this.undoUsageChanges[n];i.moves==e&&t.push(i)}var r=this.undoUsageChanges.filter((function(t){return t.moves!=e}));return this.undoUsageChanges=r,t},t.canUndo=function(){return this.undoCards.length>0},t.undo=function(){var e=this;if(this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.RELEASE_UNDO),!1!==this.boardGame.gameplay.enableCardInput&&this.canUndo()){var t=this.getUndoCards(this.moves),n=this.getUndoLocks(this.moves),i=this.getUndoUsageChanges(this.moves),r=!1;if(0!=t.length){this.scene.events.emit(Iu.Z.UNDO),i.forEach((function(t){var n=t.coin,i=void 0===n?0:n,r=t.rewardedValue,a=void 0===r?0:r,s=t.wildCardPrice,o=void 0===s?300:s;0!==i&&e.scene.logEconomy.logGetItem(yl.COIN,-i,Cl.UNDO_WILDCARD);var c=e.scene.player.getCoins();e.scene.player.setCoins(c-i),e.scene.rewardManager.undo(a),e.boardGame.gameplay.coinUsingManager.setWildCardPrice(o)}));for(var a,s=this.sliceAnimationCancelHandlers.filter((function(e){return t.some((function(t){return t.card===e.card}))})),o=Rd(s);!(a=o()).done;){a.value.cancel()}t.forEach((function(t){var n=t.card,i=t.originalPlacement,a=t.toPlacement,s=t.totalScore,o=t.combo,c=o.comboValues,h=o.comboHeight,u=o.rewardIndex,l=o.streak,d=e.boardGame.gameplay.scoreManager,p=e.boardGame.gameplay.comboManager;if(d.setTotalScore(s),p.clearPlayerRewards(),p.setCombo(c,h),p.setStreakIndex(u,l.type,l.threshold),n.behavior.reviveItems(),n.behavior.revive(),n.behavior.bringToTop(),i==au.Pile){var f=e.boardGame.pile;a==au.Waste&&(e.moveFromWaste(f,n,!0),e.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.TAP_UNDO_PILE),r=!0),a!=au.Pile&&a!=au.Joker||(e.moveFromWaste(f,n),a==au.Joker&&e.boardGame.gameplay.coinUsingManager.removeWildCard(n))}if(i==au.Stock){var m=e.boardGame.stock;a==au.Waste&&(e.moveFromWaste(m,n),e.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.TAP_UNDO_STOCK),r=!0)}if(i==au.Joker&&a==au.Waste){var g=e.boardGame.gameplay.coinUsingManager;e.boardGame.waste.removeCard(n),e.scene.gameUI.coinBarButton.coinBar.runBounceCoinTextAnimation(),e.scene.gameplayLayer.bringToTop(g.wildCardBtn),g.addWildCard(n);var v=n;e.boardGame.scene.tweens.add({targets:n,angle:{from:v,to:0},duration:300});var y=e.scene.backupGameObjectSystem.getObjectSaved(g.wildCardWrapper),E=y.x,C=y.y,w=77===g.wildCardBtn.height?11.5:-11.5;n.move({x:E,y:C+w,duration:300,onComplete:function(){n.kill(),e.boardGame.gameplay.coinUsingManager.onWildCardChanged()}})}if(i==au.Combo&&a==au.Stock){var A=e.boardGame.stock,b=e.boardGame.gameplay.comboManager;A.bringToTop(),A.removeCard(n)&&A.animateAlignCards(),n.setVisible(!0),A.setLockedManual(!1);var S=b.streakBar.getItemPos(),T=S.x,x=S.y;n.move({x:T+100,y:x-100,duration:800,onComplete:function(){n.kill()}})}n.behavior instanceof nd&&n.behavior.undo(),n.behavior instanceof ed&&n.behavior.undo()})),n.forEach((function(t){var n=t.lockSegment,i=t.lock,r=i.payload.position,a=r.x,s=r.y;i.revive(),i.setAngle(0),e.scene.gameplayLayer.bringToTop(i),n&&(i.reviveLockSegment(n),i.bringToTop(n)),i.move(a,s,300,0)})),r&&this.undoOnPileCards(t),this.setMoves(this.moves-1),this.boardGame.pile.refresh()}}},t.undoOnPileCards=function(e){var t=this.boardGame.pile,n=e.map((function(e){return e.card}));t.getCardsWithType(nu.BOOM,nu.CHANGER).forEach((function(e){n.includes(e)||e.behavior.undo()}))},t.addUndoCard=function(e,t,n,i){if(this.canAddUndo){var r=this.boardGame.gameplay.comboManager,a=r.streaks,s=this.boardGame.gameplay.scoreManager.getTotalScore(),o=r.getCombo(),c=r.getComboHeight(),h=r.getStreakIndex(),u={type:a[h].type,threshold:a[h].threshold},l=i||this.moves,d={card:e,originalPlacement:t,moves:l,toPlacement:n,totalScore:s,combo:{comboValues:o,comboHeight:c,rewardIndex:h,streak:u}},p={cardState:{id:e.id,x:e.x,y:e.y,angle:e.angle,type:e.behavior.type},originalPlacement:t,moves:l,toPlacement:n,increaseCombo:!0},f=new Cd(this.boardGame.scene,p);this.operations.push(f),this.undoCards.push(d)}},t.addUndoLock=function(e,t){if(this.canAddUndo){var n={lock:e,moves:this.moves,lockSegment:t};this.undoLocks.push(n)}},t.addUndoUsageChange=function(e){if(this.canAddUndo){var t=e.coin,n=void 0===t?0:t,i=e.rewardedValue,r=void 0===i?0:i,a=this.boardGame.gameplay.coinUsingManager,s={coin:n,rewardedValue:r,moves:this.moves,wildCardPrice:a.getWildCardPrice()};this.undoUsageChanges.push(s)}},t.getMoves=function(){return this.moves},t.increaseMoves=function(){this.moves+=1},t.setMoves=function(e){this.moves=e},t.clear=function(){this.undoCards=[],this.undoLocks=[],this.moves=0},t.getInactiveSliceAnimations=function(e){void 0===e&&(e=1);for(var t,n=[],i=Rd(this.sliceAnimations);!(t=i()).done;){var r=t.value;if(!r.active&&!r.visible&&(n.push(r),n.length>=e))break}return n},t.getSliceAnimations=function(){for(var e=this.getInactiveSliceAnimations(3);e.length<3;){var t=new Od(this.scene,Ki.Z.GAMEPLAY_OBJECTS.KEY,Ki.Z.GAMEPLAY_OBJECTS.FRAME.CARD_BACK);t.kill(),this.scene.gameplayLayer.add(t),this.sliceAnimations.push(t),e.push(t)}for(var n,i=Rd(e);!(n=i()).done;){n.value.revive()}return{cardImage:e[0],cardBackground:e[1],cardShadow:e[2]}},t.copyCardToSliceAnimations=function(e,t,n,i){t.setTexture(Ki.Z.GAMEPLAY_OBJECTS.KEY,e.cardImage.frame.name),n.setTexture(Ki.Z.GAMEPLAY_OBJECTS.KEY,Ki.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD),null==i||i.setTexture(Ki.Z.GAMEPLAY_OBJECTS.KEY,"card-bg"),t.setWorldSize(54,78),n.setWorldSize(54,78),null==i||i.setWorldSize(54,78)},t.addSliceAnimationCancelHandler=function(e,t){this.sliceAnimationCancelHandlers.push({card:e,cancel:t})},t.removeSliceAnimationCancelHandler=function(e){this.sliceAnimationCancelHandlers=this.sliceAnimationCancelHandlers.filter((function(t){return t.card!==e}))},e}(),Ld=Dd,Md=function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.canShowWildCardHint=void 0,this.timeAutoHint=void 0,this.wildCardHintTime=void 0,this.wildCardHintAnim=void 0,this.hintTween=void 0,this.jumpTween=void 0,this.checkCanShowWildCardHint=function(){var e=t.boardGame.gameplay.comboManager,n=t.boardGame.waste.getOnTopCard(),i=t.scene.gameSettings.requiredLevels,r=t.scene.level.getLevelByMode();t.resetWildCardHint(),r<i.wildCard||!e.isLastComboForStreak()||!n||n.behavior instanceof Al?t.canShowWildCardHint=!1:t.canShowWildCardHint=!0},this.removeHintTween=function(){var e,n,i,r=null==(e=t.hintTween)?void 0:e.targets;r&&r.forEach((function(e){e instanceof fd&&(e.behavior.updateSize(),e.jumpTween===t.jumpTween&&e.setZ(0))})),null==(n=t.jumpTween)||n.remove(),null==(i=t.hintTween)||i.remove()},this.removeWildCardHintTween=function(){var e;null==(e=t.wildCardHintAnim)||e.stop(),t.boardGame.gameplay.coinUsingManager.setWildCardDefault()},this.showWildCardHint=function(){var e,n=Ki.Z.GAMEPLAY_OBJECTS,i=n.KEY,r=n.FRAME,a=t.boardGame.gameplay;if((null==(e=t.wildCardHintAnim)||!e.isPlaying())&&!(t.wildCardHintAnim&&t.wildCardHintAnim.countdown>0)){var s=a.coinUsingManager.wildCardBtn,o=s.mainIcon,c=!0;t.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.WILD_CARD_HINT);var h=t.scene.tweens.createTimeline({});h.add({targets:s,y:"-=10",duration:400,ease:Phaser.Math.Easing.Quadratic.Out}),h.add({targets:s,y:"+=10",duration:400,ease:Phaser.Math.Easing.Bounce.Out}),h.add({targets:s,scaleX:-1,duration:250,offset:0,yoyo:!0,onUpdate:function(e){var t=e.getValue();c&&t<=0?(c=!1,s.setFacingUp(c),o.setTexture(i,r.WILD_CARD_BACK)):!c&&t>=0&&(c=!0,s.setFacingUp(c),o.setTexture(i,r.WILD_CARD))}}),h.play(),t.wildCardHintAnim=h}},this.boardGame=e,this.scene=e.scene,this.timeAutoHint=0,this.wildCardHintTime=0,this.canShowWildCardHint=!1}var t=e.prototype;return t.init=function(){var e=this,t=function(){e.removeHintTween(),e.resetWildCardHint(),e.resetAutoHintTime()},n=function(){e.removeHintTween(),e.checkCanShowWildCardHint()};this.boardGame.stateMachine.on(tu.DRAW_STOCK,n),this.boardGame.stateMachine.on(tu.DRAW_PILE,n),this.boardGame.stateMachine.on(tu.DRAW_FIRST_CARD,n),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,(function(){e.resetWildCardHint(),e.removeHintTween(),e.removeWildCardHintTween()}),this),this.boardGame.stateMachine.on(tu.UNDO,(function(){e.removeHintTween(),e.resetWildCardHint()}),this),this.boardGame.stateMachine.on(tu.PILE_EMPTY,t,this),this.boardGame.stateMachine.on(tu.LOSE,t,this),this.boardGame.stateMachine.on(tu.EXIT,t,this)},t.getCardWithLongestChain=function(e){if(0!=e.length){for(var t=this.boardGame.pile.getFrontCards(),n=[],i=-1,r=0;r<e.length;r++){var a=e[r],s=this.getLongestChainLength(a,[],t,0,0);i<s&&(i=s),n.push({startCard:a,length:s})}var o=n.filter((function(e){return e.length==i}));return o[Phaser.Math.Between(0,o.length-1)].startCard}},t.getPileMatchableCards=function(){var e=this.boardGame.pile,t=this.boardGame.waste.getOnTopCard();return t?e.getFrontCards().filter((function(n){return e.isMatch(n,t)})):[]},t.showMissPlay=function(){var e=this,t=this.getPileMatchableCards();t.length>0&&this.boardGame.increaseMissedPlayableCount(),t.forEach((function(t){e.runMissPlayAnimation(t)}))},t.showHint=function(){var e=this.boardGame.stock,t=this.getPileMatchableCards(),n=Phaser.Utils.Array.GetRandom(t);if(n)this.runHintAnimation(n);else{var i=e.cards[e.cards.length-1];if(!i)return;this.runHintAnimation(i)}},t.resetAutoHintTime=function(){this.timeAutoHint=0},t.update=function(e){var t=this.scene.level.getLevel();if(this.canShowHint(t)){var n=this.boardGame.gameplay.coinUsingManager.wildCardBtn;this.boardGame.stateMachine.isEventAllowed(tu.SHOW_HINT)&&(this.timeAutoHint+=e,this.canShowWildCardHint&&(1===n.alpha?this.wildCardHintTime+=e:this.wildCardHintTime=0)),this.timeAutoHint>15e3&&(this.showHint(),this.resetAutoHintTime()),this.wildCardHintTime>2e3&&(this.showWildCardHint(),this.canShowWildCardHint=!1,this.wildCardHintTime=0)}},t.resetWildCardHint=function(){this.canShowWildCardHint=!1,this.wildCardHintTime=0},t.runMissPlayAnimation=function(e){var t,n;if(!(e.isMoving||null!=(t=e.behavior.facingTween)&&t.isPlaying()||null!=(n=e.shakeTween)&&n.isPlaying())){var i=e.payload.angle;e.setAngle(i),e.behavior.updateSize(),e.behavior.bringToTop(),e.shake(10,1100,!1),this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.SKIP_MOVE),this.scene.add.tween({targets:[e],scale:{from:e.scale,to:e.scale+.1},duration:550,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0})}},t.runHintAnimation=function(e){var t,n,i;null!=(t=this.hintTween)&&t.isPlaying()||this.hintTween&&this.hintTween.countdown>0||e.isMoving||null!=(n=e.behavior.facingTween)&&n.isPlaying()||null!=(i=e.shakeTween)&&i.isPlaying()||(e.behavior.bringToTop(),this.hintTween=this.scene.add.tween({targets:[e],scale:{from:1,to:1.1},duration:250,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0,repeat:2}),this.jumpTween=e.jump(10,500,2))},t.getNonVisitedCards=function(e,t){return e.filter((function(e){if(0==t.includes(e))return!0}))},t.getLongestChainLength=function(e,t,n,i,r){var a=this;return r>i&&(i=r),t.includes(e)||(t.push(e),this.getNonVisitedCards(n,t).forEach((function(s){a.boardGame.pile.isMatch(e,s)&&(i=a.getLongestChainLength(s,t,n,i,r+1))})),t.pop()),i},t.canShowHint=function(e){return 1!=e&&(2!=e&&6!=e)},e}(),_d=Md,Nd=function(e){function t(t,n,i,r,a){var s;return(s=e.call(this,t,n,i)||this).scene=void 0,s.boardGame=void 0,s.parent=void 0,s.value=void 0,s.movingTween=void 0,s.isLock=void 0,s.spine=void 0,s.spineScale=void 0,s.scene=t,s.parent=r,s.value=a,s.boardGame=s.scene.gameplay.boardGame,s.spineScale=1/GameCore.ImageScale,s.createSpine(),s.setSize(43,53),s.scene.add.existing((0,yc.Z)(s)),s}(0,f.Z)(t,e);var n=t.prototype;return n.runUnlockAnimation=function(){return this.boardGame.gameplay.spineManager.playAndWaitAnimation(this.spine,Xu.BALLOON.EXPLODE,!1,!0)},n.createSpine=function(){var e=this.boardGame.gameplay.spineManager;this.spine=e.createSpine(0,0,Ki.Z.CODE_BREAK_SPINE.DATA_KEY,Ki.Z.CODE_BREAK_SPINE.ATLAS_KEY),this.spine.setScale(.34375,.3333333333333333),this.spine.animationStateData.defaultMix=0,this.spine.kill(),this.spine.setDepth(Ha.Z.EFFECT),this.add(this.spine)},n.showSegment=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.gameplay.spineManager,e.next=3,(0,me.qZ)(t);case 3:return e.next=5,n.playAnimation(this.spine,Xu.BALLOON.SHOW,!1,!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLockType=function(e,t){return this.spine.setSkinCustom(e,t,"balloon_symbol","balloon_symbol",!1,76.5,79.5)},n.move=function(e,t){var n;null==(n=this.movingTween)||n.remove(),this.movingTween=this.scene.add.tween({targets:this,x:e,y:t,duration:300,ease:Phaser.Math.Easing.Sine.In})},n.canUnlock=function(e,t){var n=this.value;if(n.cardFace>0){if(e==n.cardFace)return!0}else if(n.cardSuit>0){if(t==n.cardSuit)return!0}else if(n.cardColor>0){var i=t==wu.HEART||t==wu.DIAMOND;if(n.cardColor==Au.RED&&i)return!0;if(n.cardColor==Au.BLACK&&0==i)return!0}return!1},n.unlock=function(){this.runUnlockAnimation(),this.setActive(!1)},n.exit=function(){this.runUnlockAnimation()},n.revive=function(){return e.prototype.revive.call(this),this.boardGame.gameplay.spineManager.playAnimation(this.spine,Xu.BALLOON.SHOW,!1,!0)},t}(Phaser.GameObjects.Container),Gd=Nd,Fd=Ki.Z.GAMEPLAY_OBJECTS,Zd=Fd.KEY,Ud=Fd.FRAME,Wd=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i)||this).scene=void 0,a.boardGame=void 0,a.isUnlock=void 0,a.payload=void 0,a.direction=void 0,a.lockSegments=void 0,a.moveTween=void 0,a.lockTopMoveAnimation=void 0,a.lockBottomMoveAnimation=void 0,a.blurAnimation=void 0,a.fadeOutAnimation=void 0,a.isCloudCovered=void 0,a.clouds=void 0,a.midpointOfLockCards=void 0,a.lockId=void 0,a.scene=t,a.boardGame=a.scene.gameplay.boardGame,a.payload=r,a.isUnlock=!1,a.direction=r.direction,a.lockSegments=[],a.isCloudCovered=!1,a.clouds=[],a.createLockSegments(r.balloons),t.add.existing((0,yc.Z)(a)),a}(0,f.Z)(t,e);var n=t.prototype;return n.setLockId=function(e){this.lockId=e},n.handleCards=function(e){var t=this.getObjects().cards;if(e){if(!this.isCloudCovered){var n=this.coverCardByClouds(t);this.clouds=n,this.isCloudCovered=!0}t.forEach((function(e){e.setLock(!0)}))}else t.forEach((function(e){e.setLock(!1)})),this.isUnlock=!0},n.calculateBoundingBox=function(e){var t=1/0,n=-1/0,i=1/0,r=-1/0;return e.forEach((function(e){t=Math.min(t,e.x),n=Math.max(n,e.x+e.width),i=Math.min(i,e.y),r=Math.max(r,e.y+e.height)})),{left:t,right:n,top:i,bottom:r,width:n-t,height:r-i}},n.coverCardByClouds=function(e){var t=this,n=this.generateClouds(3*e.length),i=Math.floor(n.length/e.length),r=[];r.push.apply(r,n),e.forEach((function(e){var r=n.splice(0,i),a=t.getLocalPoint(e.getWorldPosition().x,e.getWorldPosition().y),s=a.x,o=a.y;r.forEach((function(e){e.setX(s+Phaser.Math.Between(-10,10))})),r[0].setY(o+Phaser.Math.Between(-29,-9)),r[1].setY(o+Phaser.Math.Between(-9,9)),r[2].setY(o+Phaser.Math.Between(9,29))}));var a=this.lockSegments.filter((function(e){return e.active}));return a.length>0&&a.forEach((function(e){var n;null==(n=e.movingTween)||n.remove(),t.bringToTop(e)})),r},n.generateClouds=function(e){for(var t=[],n=0;n<e;n++){var i=Phaser.Math.Between(1,3),r=this.scene.add.image(0,0,Zd,""+Ud.CLOUD_+i);r.setDefaultWorldSize(),r.setAlpha(0),this.add(r),t.push(r)}return t},n.getObjects=function(){var e=this,t=this.scene.gameplay.boardGame.pile.cards,n=this.scene.gameplay.boardGame.balloonData;if(!n[this.lockId])return{cards:[]};var i=[];if(this.direction===bl.LEFT){var r=n[this.lockId+1];if(r&&r.direction===bl.LEFT){var a=r.position;i=t.filter((function(t){return t.payload.x<e.payload.position.x&&t.payload.x>a.x}))}else i=t.filter((function(t){return t.payload.x<e.payload.position.x}))}else if(this.direction===bl.RIGHT){var s=n[this.lockId+1];if(s&&s.direction===bl.RIGHT){var o=s.position;i=t.filter((function(t){return t.payload.x>e.payload.position.x&&t.payload.x<o.x}))}else i=t.filter((function(t){return t.payload.x>e.payload.position.x}))}return{cards:i}},n.move=function(e,t,n,i){var r;if(this.x!=e||this.y!=t)return null==(r=this.moveTween)||r.remove(),this.moveTween=this.scene.tweens.add({targets:this,x:e,y:t,duration:n,delay:i}),this.moveTween},n.getSegmentPosition=function(e){return e.getWorldPosition()},n.showLock=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 50,e.next=3,Promise.all(this.lockSegments.map((function(e,n){return Promise.all([e.showSegment(50*n),t.scene.add.tween({targets:t.clouds,alpha:1,duration:300}).waitForCompletion()])})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.unlockSegment=function(e){if(this.active){var t=this.lockSegments.filter((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}));if(t.length>0){var n=t[Phaser.Math.Between(0,t.length-1)];return n.kill(),this.boardGame.mover.addUndoLock(this,n),0==this.lockSegments.filter((function(e){return e.active&&e.visible})).length&&this.handleCards(!1),n}}},n.isMatch=function(e){return this.lockSegments.some((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}))},n.killLockSegment=function(e){e.unlock()},n.revive=function(){var t;e.prototype.revive.call(this),null==(t=this.fadeOutAnimation)||t.remove(),this.setAlpha(1),this.isUnlock=!1},n.reviveLockSegment=function(e){e.revive()},n.setBlur=function(e){var t;null==(t=this.blurAnimation)||t.remove(),this.blurAnimation=e?this.scene.tweens.add({targets:this,alpha:.6,duration:300}):this.scene.tweens.add({targets:this,alpha:1,duration:300})},n.preKill=function(){this.exit(600,!1)},n.killedByWindmill=function(){this.kill(),this.lockSegments.forEach((function(e){e.setActive(!1)}))},n.exit=function(e,t){var n,i=this;void 0===e&&(e=0),void 0===t&&(t=!0),null==(n=this.fadeOutAnimation)||n.remove(),this.fadeOutAnimation=this.scene.tweens.add({targets:[this],duration:300,alpha:0,delay:e,onComplete:function(){i.kill()}}),t&&this.lockSegments.forEach((function(e){e.exit()}))},n.createLockSegments=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){var t=e.cardValues,i=e.position,r=Ud.BLANK,a=n.createSegment(t),s=n.getLocalPoint(i.x,i.y);return a.setPosition(s.x,s.y),t.cardSuit>0?r=n.getSuitFrame(t.cardSuit):t.cardColor>0?r=t.cardFace>0?n.getValueFrame(t.cardFace):n.getColorFrame(t.cardColor):t.cardFace>0&&(r=n.getValueFrame(t.cardFace)),a.setLockType(Zd,r)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.createSegment=function(e){var t=new Gd(this.scene,0,0,this,e);return this.add(t),this.lockSegments.push(t),t},n.runAlignLockSegmentAnimation=function(){var e=this.lockSegments.filter((function(e){return e.active}));if(e.length>0){this.setSize(e[0].width,e[0].height*e.length);var t=-this.height/2+e[0].height/2;e.forEach((function(e){e.move(e.x,t),t+=e.height}))}},n.getSuitFrame=function(e){return e==wu.HEART?Ud.BALLOON_HEART:e==wu.DIAMOND?Ud.BALLOON_DIAMOND:e==wu.CLUBS?Ud.BALLOON_CLUB:e==wu.SPADES?Ud.BALLOON_SPADE:""},n.getValueFrame=function(e){var t=Ud.BALLOON_NUMBER_;return 1==e?t+"A":11==e?t+"J":12==e?t+"Q":13==e?t+"K":""+t+e},n.getColorFrame=function(e){return e==Au.BLACK?Ud.BALLOON_BLACK:e==Au.RED?Ud.BALLOON_RED:""},t}(Phaser.GameObjects.Container),Yd=Wd,Hd=function(e){return e.COIN="coin",e.CHEST="chest",e.CARD="card",e.WILD="wild",e}({}),zd={coinsRewarded:55,cost:{addCards:250,addCardsDifference:50,boosterSlice:350,boosterStorm:375,boosterWildCard:400,undo:100,undoDifference:25,wildCard:300,wildCardDifference:50},comboRewards:[Hd.COIN,Hd.CARD,Hd.WILD,Hd.CHEST],matchRatio:{matchRatio:28,commonDifference:16},difficulty:Jh.NORMAL,streak:{random:"card",fixed:["card|5","coin|4","wild|6"]}},Kd=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.scene=e,this.boardGame=t}var t=e.prototype;return t.blow=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.boardGame,r=i.pile,s=i.waste,o=i.stock,c=[].concat(r.cards),h=this.scene.world.getWorldSize(),u=h.width,l=h.height,0!=c.length){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:return e.abrupt("return",new Promise((function(e){d.boardGame.stock.setLockedManual(!0),d.boardGame.gameplay.setEnableCardInput(!1);var i=[];c.push.apply(c,o.cards),c.forEach((function(e){if(e.behavior instanceof Wl&&e.behavior.killItems(),e.behavior.checkCardHasValue()&&e.behavior.random){var r=Phaser.Math.Between(1,13),a=Phaser.Math.Between(1,4);e.behavior.setValue(r,a)}var s=new Phaser.Math.Vector2(e.x-t,e.y-n);s.normalize(),0==s.x&&0==s.y&&s.add({x:0,y:-1});var o=e.x,c=e.y;s.x>0&&(o=u-e.x),s.y>0&&(c=l-e.y);var h=Math.sqrt(Math.pow(o,2)+Math.pow(c,2))+45;s.multiply({x:h,y:h});var p=Phaser.Math.Between(1e3,1200);i.push(e.move({x:e.x+s.x,y:e.y+s.y,duration:p}),d.flipRotate(e,p,Phaser.Math.Between(-270,-90)))}));var r=s.cards.pop();s.cards.forEach((function(e){e.kill()})),d.scene.tweens.add({targets:[r],alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),Promise.all(i).then((function(){return e()}))})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.flipRotate=function(e,t,n){var i=this.scene.tweens.createTimeline(),r=t/2;return i.add({targets:e,angle:{from:0,to:n},duration:2*r}),e.isType(nu.SQUIRREL)||e.isType(nu.TREASURE)||(i.add({targets:e,scaleX:{from:1,to:0},yoyo:!0,offset:0,duration:r/4,onYoyo:function(){e.behavior.setFrameCardDown()}}),i.add({targets:e,scaleX:{from:1,to:0},yoyo:!0,duration:r/2,offset:r/2,onYoyo:function(){e.behavior.setFrameCardUp()}})),i.playAndWaitForCompletion()},e}(),Vd=Kd;function Xd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return jd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var qd=function(){function e(){this.callbacks=new Map}var t=e.prototype;return t.on=function(e,t,n){var i;this.callbacks.has(e)||this.callbacks.set(e,[]),null==(i=this.callbacks.get(e))||i.push(new Jd(t,n))},t.once=function(e,t,n){var i;this.callbacks.has(e)||this.callbacks.set(e,[]),null==(i=this.callbacks.get(e))||i.push(new Jd(t,n,!0))},t.off=function(e,t,n,i){if(this.callbacks.has(e)){var r=this.callbacks.get(e);if(r){var a=r.findIndex((function(e){return e.fn===t&&e.context===n&&e.once===i}));-1!==a&&r.splice(a,1)}}},t.removeListener=function(e,t,n,i){this.callbacks.has(e)&&this.callbacks.set(e,[])},t.removeAllListeners=function(e){this.callbacks.has(e)&&this.callbacks.set(e,[])},t.emit=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l=this,d=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.callbacks.has(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=this.callbacks.get(t)){e.next=5;break}return e.abrupt("return");case 5:for(i=d.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=d[s];o=Xd(n);case 7:if((c=o()).done){e.next=13;break}return h=c.value,e.next=11,h.fn.apply(h.context,r);case 11:e.next=7;break;case 13:u=n.filter((function(e){return!0===e.once})),u.forEach((function(e){return l.off(t,e.fn,e.context,e.once)}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),Jd=function(e,t,n){this.fn=void 0,this.context=void 0,this.once=void 0,this.fn=e,this.context=t,this.once=n},Qd=function(){function e(e,t){this.handler=void 0,this.state=void 0,this.state=e,this.handler=t}var t=e.prototype;return t.getTargetState=function(){return"number"===typeof this.state?this.handler.stateHistory[this.handler.stateHistory.length-1+this.state]:this.state},t.setTargetState=function(e){this.state?this.state!==e&&this.handler.logPrefix:this.state=e},e}(),$d=function(e){function t(t,n,i){var r;return void 0===n&&(n=void 0),(r=e.call(this,n,i)||this).event=void 0,r.emitter=new qd,r.event=t,r}(0,f.Z)(t,e);var n=t.prototype;return n.emit=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,i=new Array(n),r=0;r<n;r++)i[r]=s[r];return e.next=3,(t=this.emitter).emit.apply(t,["event:"+this.event].concat(i));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.on=function(e,t){this.emitter.on("event:"+this.event,e,t)},n.once=function(e,t){this.emitter.once("event:"+this.event,e,t)},n.off=function(e,t,n){this.emitter.off("event:"+this.event,e,t,n)},n.removeListener=function(e,t,n){this.emitter.removeListener("event:"+this.event,e,t,n)},n.removeAllListeners=function(){this.emitter.removeAllListeners("event:"+this.event)},t}(Qd),ep=function(e){function t(t,n,i){var r;return(r=e.call(this,n,i)||this).condition=void 0,r.condition=t,r}return(0,f.Z)(t,e),t.prototype.evaluate=function(){return this.condition&&this.condition()},t}(Qd);function tp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return np(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return np(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ip=function(){function e(e,t){this.state=void 0,this.handler=void 0,this.emitter=new qd,this.conditionEdges=[],this.eventEdges=[],this.autoTransitionEvent=void 0,this.handler=e,this.state=t}var t=e.prototype;return t.addConditionEdge=function(e,t){void 0===t&&(t=void 0);var n=new ep(e,t,this.handler);this.conditionEdges.push(n)},t.addEventEdge=function(e,t){void 0===t&&(t=void 0);var n=this.handler.getEventEdge(e);t&&n.setTargetState(t),this.eventEdges.push(n)},t.evaluateConditionEdges=function(){for(var e,t=tp(this.conditionEdges);!(e=t()).done;){var n=e.value;if(n.evaluate())return n.getTargetState()}},t.addAutoTransitionEdge=function(e){this.autoTransitionEvent=e},t.configureAutoTransitionEdge=function(e){var t;null==(t=this.autoTransitionEvent)||t.setTargetState(e)},t.canTransition=function(e){var t;return this.eventEdges.some((function(t){return t.event===e}))||(null==(t=this.autoTransitionEvent)?void 0:t.event)===e},t.emitEnter=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i];return e.next=3,this.emitter.emit("state-enter:"+this.state,n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onEnter=function(e,t){this.emitter.on("state-enter:"+this.state,e,t)},t.onceEnter=function(e,t){this.emitter.once("state-enter:"+this.state,e,t)},t.offEnter=function(e,t,n){this.emitter.off("state-enter:"+this.state,e,t,n)},t.emitExit=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i];return e.next=3,this.emitter.emit("state-exit:"+this.state,n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onExit=function(e,t){this.emitter.on("state-exit:"+this.state,e,t)},t.onceExit=function(e,t){this.emitter.once("state-exit:"+this.state,e,t)},t.offExit=function(e,t,n){this.emitter.off("state-exit:"+this.state,e,t,n)},t.emitDone=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.emitter.emit("state-done:"+this.state);case 2:if(!this.autoTransitionEvent){e.next=5;break}return e.next=5,this.handler.emit(this.autoTransitionEvent.event);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onDone=function(e,t){this.emitter.on("state-done:"+this.state,e,t)},e}();function rp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ap(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ap(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ap(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var sp=function(){function e(e,t,n,i){this.handler=void 0,this.rule=void 0,this.startingNodes=[],this.event=void 0,this.handler=t,this.rule=n,this.startingNodes=i,this.event=e}var t=e.prototype;return t.visitAbsoluteEdge=function(e,t){e instanceof Function?this.startingNodes.forEach((function(n){n.addConditionEdge(e,t)})):this.startingNodes.forEach((function(n){n.addEventEdge(e,t)}))},t.visitRelativeEdge=function(e,t){e instanceof Function?this.startingNodes.forEach((function(n){n.addConditionEdge(e,t)})):this.startingNodes.forEach((function(n){n.addEventEdge(e,t)}))},e}(),op=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.goTo=function(e){return this.visitAbsoluteEdge(this.event,e),new dp(this.handler,this.rule,this.startingNodes)},n.goToPreviousState=function(){return this.visitRelativeEdge(this.event,-1),new dp(this.handler,this.rule,this.startingNodes)},t}(sp),cp=function(e){function t(t,n,i){return e.call(this,(function(){return!0}),t,n,i)||this}(0,f.Z)(t,e);var n=t.prototype;return n.goTo=function(e){this.visitAbsoluteEdge((function(){return!0}),e)},n.goToPreviousState=function(){this.visitRelativeEdge(this.event,-1)},n.emit=function(e){for(var t,n=rp(this.startingNodes);!(t=n()).done;){t.value.addAutoTransitionEdge(this.handler.getEventEdge(e))}return new hp(this.event,this.handler,this.rule,this.startingNodes)},t}(sp),hp=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.thenGoTo=function(e){this.startingNodes.forEach((function(t){t.configureAutoTransitionEdge(e)}))},t}(sp),up=function(e,t,n){this.handler=void 0,this.rule=void 0,this.startingNodes=[],this.handler=e,this.rule=t,this.startingNodes=n},lp=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.if=function(e){return new op(e,this.handler,this.rule,this.startingNodes)},t}(up),dp=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.elseIf=function(e){return new op(e,this.handler,this.rule,this.startingNodes)},n.else=function(){return new cp(this.handler,this.rule,this.startingNodes)},t}(up);function pp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var mp=function(){function e(e,t,n){if(this.handler=void 0,this.stateNodes=[],this.handler=e,n){var i=e.allStates,r=t,a=i.filter((function(e){return!r.includes(e)}));this.stateNodes=a.map((function(t){return e.getStateNode(t)}))}else this.stateNodes=t.map((function(t){return e.getStateNode(t)}))}var t=e.prototype;return t.if=function(e){return new lp(this.handler,this,this.stateNodes).if(e)},t.ifDone=function(){return new cp(this.handler,this,this.stateNodes)},t.allowEvent=function(e){for(var t,n=pp(this.stateNodes);!(t=n()).done;){t.value.addEventEdge(e)}},e}();function gp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return vp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var yp=function(){function e(e,t,n,i){void 0===i&&(i=!1),this.currentState=void 0,this.allStates=[],this.allEvents=[],this.stateNodes=new Map,this.eventEdges=new Map,this.stateHistory=[],this.logPrefix=void 0,this.currentState=e,this.stateHistory.push(e),this.logPrefix=i,this.allStates=t;for(var r,a=gp(t);!(r=a()).done;){var s=r.value;this.stateNodes.set(s,new ip(this,s))}this.allEvents=n;for(var o,c=gp(n);!(o=c()).done;){var h=o.value;this.eventEdges.set(h,new $d(h,void 0,this))}}var t=e.prototype;return t.whenIn=function(e){return new mp(this,e,!1)},t.whenNotIn=function(e){return new mp(this,e,!0)},t.whenInAny=function(){return new mp(this,this.allStates,!0)},t.getStateNode=function(e){return this.stateNodes.get(e)},t.getEventEdge=function(e){return this.eventEdges.get(e)},t.emit=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=o.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=o[r];if(this.getStateNode(this.currentState).canTransition(t)){e.next=4;break}return this.logPrefix,e.abrupt("return");case 4:if(!0===this.logPrefix||this.logPrefix,!(s=this.getEventEdge(t)).getTargetState()){e.next=11;break}return e.next=9,this.changeState(s.getTargetState(),(function(){return s.emit.apply(s,i)}));case 9:e.next=13;break;case 11:return e.next=13,s.emit.apply(s,i);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.changeState=function(){var e=(0,i.Z)(a().mark((function e(t,n){var r,s,o,c,h,u,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitExit();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitEnter();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitDone();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){l.currentState=t,l.stateHistory.push(t),!0===l.logPrefix||l.logPrefix},h=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=4;break}return e.next=4,n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=l.getStateNode(l.currentState).evaluateConditionEdges())){e.next=4;break}return e.next=4,l.changeState(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=8,r();case 8:return c(),e.next=11,s();case 11:return e.next=13,h();case 13:return e.next=15,o();case 15:return e.next=17,u();case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.on=function(e,t,n){this.getEventEdge(e).on(t,n)},t.once=function(e,t,n){this.getEventEdge(e).once(t,n)},t.off=function(e,t,n,i){this.getEventEdge(e).off(t,n,i)},t.removeListener=function(e,t,n,i){this.getEventEdge(e).removeListener(t,n,i)},t.removeAllListeners=function(e){this.getEventEdge(e).removeAllListeners()},t.waitForEvent=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.once(t,e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.waitForStateEnter=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.getStateNode(t).onceEnter(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.waitForStateExit=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.getStateNode(t).onceExit(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isEventAllowed=function(e){return this.getStateNode(this.currentState).canTransition(e)},e}(),Ep=function(){function e(e,t,n,i){void 0===i&&(i=!1),this.handler=void 0,this.handler=new yp(e,t,n,i)}var t=e.prototype;return t.whenIn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handler.whenIn(t)},t.whenNotIn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handler.whenNotIn(t)},t.whenInAny=function(){return this.handler.whenInAny()},t.emit=function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=this.handler).emit.apply(t,[e].concat(i))},t.emitAndWait=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=o.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=o[s];return e.next=3,(n=this.handler).emit.apply(n,[t].concat(r));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.waitForEvent=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForEvent(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.on=function(e,t,n){this.handler.on(e,t,n)},t.once=function(e,t,n){this.handler.once(e,t,n)},t.off=function(e,t,n,i){this.handler.off(e,t,n,i)},t.removeListener=function(e,t,n,i){this.handler.removeListener(e,t,n,i)},t.removeAllListeners=function(e){this.handler.removeAllListeners(e)},t.onEnter=function(e,t,n){this.handler.getStateNode(e).onEnter(t,n)},t.onceEnter=function(e,t,n){this.handler.getStateNode(e).onceEnter(t,n)},t.offEnter=function(e,t,n,i){this.handler.getStateNode(e).offEnter(t,n,i)},t.waitForStateEnter=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForStateEnter(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.onExit=function(e,t,n){this.handler.getStateNode(e).onExit(t,n)},t.onceExit=function(e,t,n){this.handler.getStateNode(e).onceExit(t,n)},t.offExit=function(e,t,n,i){this.handler.getStateNode(e).offExit(t,n,i)},t.waitForStateExit=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForStateExit(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.isEventAllowed=function(e){return this.handler.isEventAllowed(e)},e}(),Cp=function(e){function t(){var t;return(t=e.call(this,eu.NONE,Object.values(eu),Object.values(tu))||this).whenNotIn(eu.NONE).if(tu.RESET).goTo(eu.NONE),t.whenIn(eu.NONE).if(tu.START).goTo(eu.INITIALIZED),t.whenIn(eu.INITIALIZED).ifDone().emit(tu.DEAL).thenGoTo(eu.DEALING),t.whenIn(eu.DEALING).ifDone().emit(tu.APPLY_BOOSTERS).thenGoTo(eu.APPLYING_BOOSTERS),t.whenIn(eu.APPLYING_BOOSTERS).ifDone().emit(tu.DRAW_FIRST_CARD).thenGoTo(eu.DRAWING_FIRST_CARD),t.whenIn(eu.DRAWING_FIRST_CARD).ifDone().goTo(eu.IDLE),t.whenIn(eu.IDLE).if(tu.DRAW_STOCK).goTo(eu.DRAWING_STOCK).elseIf(tu.DRAW_PILE).goTo(eu.DRAWING_PILE).elseIf(tu.DRAW_WILD_CARD).goTo(eu.DRAWING_WILD_CARD),t.whenIn(eu.DRAWING_STOCK,eu.DRAWING_PILE,eu.DRAWING_WILD_CARD).ifDone().emit(tu.CHECK_END_GAME).thenGoTo(eu.CHECKING_END_GAME),t.whenIn(eu.CHECKING_END_GAME).if(tu.PILE_EMPTY).goTo(eu.GAME_WON).elseIf(tu.BOMB_COUNTER_REACHED_ZERO).goTo(eu.EXPLODING).elseIf(tu.NO_STOCK_CARDS).goTo(eu.NO_STOCK_CARDS).elseIf(tu.UNDO).goTo(eu.UNDOING).elseIf(tu.DRAW_WILD_CARD).goTo(eu.DRAWING_WILD_CARD).else().goTo(eu.IDLE),t.whenIn(eu.NO_STOCK_CARDS).if(tu.REFILL_STOCK).goTo(eu.IDLE).elseIf(tu.LOSE).goTo(eu.GAME_LOST).elseIf(tu.DRAW_WILD_CARD).goTo(eu.DRAWING_WILD_CARD).elseIf(tu.DRAW_PILE).goTo(eu.DRAWING_PILE),t.whenIn(eu.EXPLODING).if(tu.LOSE).goTo(eu.GAME_LOST),t.whenIn(eu.IDLE,eu.NO_STOCK_CARDS).if(tu.UNDO).goTo(eu.UNDOING),t.whenIn(eu.UNDOING).ifDone().emit(tu.CHECK_END_GAME),t.whenNotIn(eu.DRAWING_STOCK,eu.DRAWING_PILE,eu.DRAWING_WILD_CARD).allowEvent(tu.SHOW_HINT),t.whenIn(eu.IDLE,eu.NO_STOCK_CARDS).if(tu.PURCHASE_UNDO).goTo(eu.PROCESSING_PURCHASE).elseIf(tu.PURCHASE_WILD_CARD).goTo(eu.PROCESSING_PURCHASE),t.whenIn(eu.NO_STOCK_CARDS,eu.IDLE).if(tu.PURCHASE_REFILL_STOCK).goTo(eu.PROCESSING_PURCHASE).elseIf(tu.PURCHASE_REFILL_STOCK_WITH_ADS).goTo(eu.PROCESSING_PURCHASE),t.whenIn(eu.PROCESSING_PURCHASE).if(tu.UNDO).goTo(eu.UNDOING).elseIf(tu.REFILL_STOCK).goTo(eu.IDLE).elseIf(tu.DRAW_WILD_CARD).goTo(eu.DRAWING_WILD_CARD).else().goToPreviousState(),t.whenIn(eu.IDLE,eu.NO_STOCK_CARDS).if(tu.EXIT).goTo(eu.NONE),t}return(0,f.Z)(t,e),t}(Ep),wp=function(e){return e.FREE="free",e.NOT_FREE="not-free",e}({}),Ap=n(49),bp=function(e){function t(t){var n;(n=e.call(this)||this).gameplay=void 0,n.scene=void 0,n.stateMachine=new Cp,n.stock=void 0,n.deck=void 0,n.pile=void 0,n.waste=void 0,n.hint=void 0,n.mover=void 0,n.locks=void 0,n.blowCardsBehavior=void 0,n.canShowUndo=void 0,n.isUndoShowing=void 0,n.canRefillStock=void 0,n.mapSettings=void 0,n.metricsLog=void 0,n.blackBackground=void 0,n.balloonData=void 0,n.showingUndoTween=void 0,n.hidingUndoTween=void 0,n.lose=function(){n.gameOver(),n.gameplay.handleGameOver(!1)},n.win=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gameOver(),n.gameplay.handleGameOver(!0),n.scene.gameUI.coinBarButton.setDisabled(!0),(t=n.deck.lastMovingCard.card)&&t.active&&0!=t.isMoving){e.next=8;break}n.runCompleteLevelAnimation(),e.next=14;break;case 8:return e.next=10,t.movingTween.waitForCompletion();case 10:if(!n.stock.alignTween){e.next=13;break}return e.next=13,n.stock.alignTween.waitForCompletion();case 13:n.runCompleteLevelAnimation();case 14:case"end":return e.stop()}}),e)}))),n.hasValidMoves=function(){if(n.stock.cards.length>0)return!0;var e=n.waste.getOnTopCard();if(!e)return!0;var t=n.pile.getFrontCards();return 0==t.length||t.some((function(t){return n.pile.isMatch(t,e)}))},n.isOutOfStockCards=function(){return!(1===n.scene.level.getLevelByMode()||n.stock.cards.length>0)},n.runCompleteLevelAnimation=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.STOCK_CARD_REWARD),n.scene.gameUI.gameUILayout.hidePlusCardsButtons(),e.next=4,n.scene.rewardManager.runStockRewardAnim();case 4:n.gameplay.handleOpenGameOverScreen(!0);case 5:case"end":return e.stop()}}),e)}))),n.gameplay=t,n.scene=t.scene,n.metricsLog={wildCardUsedCount:0,undoCount:0,addCardsCountByCoin:0,addCardsCountByAd:0,missedPlayableCount:0,streakCount:0,clickOnUnmatchedCardCount:0},n.canShowUndo=!1,n.canRefillStock=!0,n.locks=[],n.mapSettings=zd,n.createBlackBackground(),n.deck=new gd((0,yc.Z)(n)),n.stock=new yu((0,yc.Z)(n)),n.pile=new vd((0,yc.Z)(n)),n.waste=new yd((0,yc.Z)(n)),n.hint=new _d((0,yc.Z)(n)),n.mover=new Ld(n.scene,(0,yc.Z)(n)),n.blowCardsBehavior=new Vd(n.scene,(0,yc.Z)(n));var r=hu.CARD_VIEW.HEIGHT,s=n.scene.gameZone.width/2,o=n.scene.gameZone.height-n.scene.world.getSAB();return n.stock.setPosition(s-65,o-r/2-10),n.waste.setPosition(s,o-r/2-10),n.stock.init(),n.initTransitionEvents(),n.hint.init(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,oe.Z.OVERLAY.KEY),this.blackBackground.setName("Black Background"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),Phaser.Display.Align.In.Center(this.blackBackground,this.scene.gameZone),this.scene.gameplayLayer.add(this.blackBackground),Ap.Z.registerObject(this.blackBackground,de.MR.MULTIPLY_ALPHA)},n.runFadeBackground=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:r,onStart:function(){s.blackBackground.revive(),s.blackBackground.alpha=t}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.initTransitionEvents=function(){var e=this;this.stateMachine.on(tu.START,this.start,this),this.stateMachine.on(tu.DEAL,this.deal,this),this.stateMachine.on(tu.APPLY_BOOSTERS,(function(){return e.gameplay.boosterManager.start()})),this.stateMachine.on(tu.DRAW_FIRST_CARD,this.drawFirstCard,this),this.stateMachine.on(tu.RESET,this.clear,this),this.stateMachine.on(tu.DRAW_STOCK,this.stock.draw,this),this.stateMachine.on(tu.DRAW_PILE,this.pile.draw,this),this.stateMachine.on(tu.PILE_EMPTY,this.win,this),this.stateMachine.on(tu.CHECK_END_GAME,this.checkEndGame,this),this.stateMachine.on(tu.LOSE,this.lose,this),this.stateMachine.on(tu.REFILL_STOCK,this.refillStock,this),this.stateMachine.on(tu.NO_STOCK_CARDS,this.showPlusCards,this),this.stateMachine.on(tu.EXIT,this.handleExit,this)},n.start=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.scene.level.getLevelData())&&(this.mapSettings=t.settings.mapProperties,n=this.mapSettings.matchRatio,i=n.matchRatio,r=void 0===i?0:i,s=n.commonDifference,o=void 0===s?0:s,c=this.scene.player.getCoins(),this.deck.matchRatioCalculator.setHardRatioByCoins(c),this.deck.matchRatioCalculator.setConfig(r,o)),this.initPile(),this.createLocks(),this.hint.resetAutoHintTime(),this.hint.resetWildCardHint(),this.mover.setCanAddUndo(!1),this.scene.gameUI.footer.setCanHandleSettings(!1),$h.emit(jh.CLEAR_CARDS.EVENTS.RESET);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.drawFirstCard=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stock.draw(!1);case 2:this.pile.refresh(),this.mover.setCanAddUndo(!0),t=this.scene.level.getLevelByMode(),this.gameplay.guideManager.playGuide(t,this.scene.gameSettings),this.scene.gameUI.footer.setCanHandleSettings(!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.onPlayerMove=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.pile,this.gameplay.setEnableCardInput(!1),!(n=this.waste.getOnTopCard())||!n.isType(nu.WINDMILL,nu.CHESTNUT,nu.MAP_PIECE)){e.next=6;break}return e.next=6,n.behavior.onPlayerMove();case 6:if(!(this.waste.getCardsLength()>1)){e.next=18;break}i=t.getCardsWithType(nu.BOOM,nu.CHANGER),r=0;case 9:if(!(r<i.length)){e.next=18;break}if(s=i[r],(o=s.behavior).onPlayerMove(),!(o instanceof Fu&&o.explodeCounter<=0)){e.next=15;break}return e.abrupt("return");case 15:r++,e.next=9;break;case 18:return e.next=20,this.activateDrawableCards();case 20:this.gameplay.setEnableCardInput(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.activateDrawableCards=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.pile,n=t.cards.filter((function(e){return e.behavior.isPlusCard()||e.isType(nu.JOKER)||e.isType(nu.KEY)})),n.sort((function(e){return e.isType(nu.CHAIN)?-1:1})),i=0;case 4:if(!(i<n.length)){e.next=16;break}if(r=n[i],this.pile.checkOverlap(r)||r.isBlur){e.next=13;break}return e.next=9,(0,me.qZ)(200);case 9:return e.next=11,r.behavior.onPlayerMove();case 11:n.splice(i,1),i=-1;case 13:i++,e.next=4;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.gameOver=function(){this.gameplay.setEnableCardInput(!1),this.gameplay.boosterManager.stop(),this.gameplay.eventManager.stop()},n.clear=function(){this.pile.clear(),this.stock.clear(),this.waste.clear(),this.deck.clear(),this.mover.clear(),this.locks.forEach((function(e){return e.destroy()})),this.locks=[],this.isUndoShowing=!1,this.stateMachine.removeAllListeners(tu.CHECK_END_GAME),this.stateMachine.on(tu.CHECK_END_GAME,this.checkEndGame,this)},n.setCanRefillStock=function(e){this.canRefillStock=e},n.setCanShowUndo=function(e){this.canShowUndo=e},n.initStock=function(){var e=this.scene.level.getLevelData();if(e){for(var t=e.settings.cardsInStack,n=0;n<t.length;n++){var i=this.deck.getNewCard(au.Stock);i.setBehavior();var r=t[n],a=r.value,s=r.suit;a&&(-1==a||-1==s?i.behavior.random=!0:i.behavior.setValue(a,s)),this.stock.addCard(i)}this.stock.align()}},n.initPile=function(){var e=this,t=this.scene.level.getLevelData();t&&(this.pile.clearHistoryCollectedCards(),t.cards.forEach((function(t){var n=e.deck.getNewCard(e.pile.name,t),i=t.x,r=t.y;n.setPosition(i,r),n.setAngle(t.angle),n.setBehavior(t.type),e.pile.addCard(n)})),this.pile.setNutsInSquirrel(),this.pile.setTreasureMapCards(),this.pile.connectChainCard())},n.listenEventsToShowUndo=function(){var e=this,t=this.gameplay.coinUsingManager.undoBtn;this.isUndoShowing=!1;var n=function(){return e.isUndoShowing},i=function(){n()||e.canShowUndo&&e.mover.canUndo()&&function(){var n;null==(n=e.hidingUndoTween)||n.stop(),t.active||t.visible||t.setAlpha(0),t.revive(),e.showingUndoTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:1},duration:300,onStart:function(){e.isUndoShowing=!0},onComplete:function(){t.setAlpha(1)}})}()};this.stateMachine.on(tu.DRAW_STOCK,i,this),this.stateMachine.on(tu.DRAW_PILE,i,this),this.stateMachine.on(tu.DRAW_WILD_CARD,i,this),this.stateMachine.on(tu.UNDO,(function(){n()&&(e.canShowUndo&&e.mover.canUndo()||function(){var n;null==(n=e.showingUndoTween)||n.stop(),e.hidingUndoTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:0},duration:300,onStart:function(){e.isUndoShowing=!1},onComplete:function(){t.kill(),t.setAlpha(0)}})}())}),this)},n.createLocks=function(){var e=this,t=this.scene.level.getLevelData();if(t){var n=t.balloonData;if(0!=n.length){var i=(n=n.sort((function(e,t){return e.direction-t.direction}))).filter((function(e){return e.direction==bl.LEFT})).sort((function(e,t){return t.position.x-e.position.x})),r=n.filter((function(e){return e.direction==bl.RIGHT})).sort((function(e,t){return e.position.x-t.position.x})),a=[].concat(i,r);a.forEach((function(t,n){var i=new Yd(e.scene,t.position.x,t.position.y,t);e.scene.gameplayLayer.add(i),e.locks.push(i),i.setLockId(n)})),this.balloonData=a,this.lockCards()}}},n.addCardToStock=function(e,t,n){for(var i=this,r=0,a=function(){var e=i.deck.getNewStockCard();e.setAlpha(0),i.scene.time.delayedCall(r,(function(){e.setPosition(t,n),new _h.Z({targets:[e],duration:200}).play(),e.moveWithRotate({x:i.stock.x,y:i.stock.y,duration:1e3}),i.scene.time.delayedCall(800,(function(){i.stock.moveToStep(-1),i.stock.addCard(e)}))})),r+=300},s=0;s<e;s++)a()},n.checkEndGame=function(){0==this.pile.cards.length||1==this.pile.cards.length&&this.pile.cards[0].behavior instanceof Wl?(this.scene.gameUI.footer.closeSettings(),this.scene.gameUI.footer.setCanHandleSettings(!1),this.stateMachine.emit(tu.PILE_EMPTY)):this.isOutOfStockCards()?this.stateMachine.emit(tu.NO_STOCK_CARDS):this.scene.gameUI.gameUILayout.hidePlusCardsButtons()},n.showPlusCards=function(){this.canRefillStock?this.gameplay.coinUsingManager.showPlusCards(wp.FREE):this.gameplay.coinUsingManager.showPlusCards(wp.NOT_FREE)},n.handleExit=function(){var e=this,t=this.scene.world.getWorldSize(),n=t.width,i=t.height;this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.END_GAME),this.locks.forEach((function(e){e.exit()})),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),this.gameOver(),this.blowCardsBehavior.blow(n/2,i/2).then((function(){e.clear(),e.gameplay.eventManager.resetEventItemAmount(),e.scene.screen.open(de.o4.DASHBOARD_SCREEN)}))},n.lockCards=function(){this.locks.forEach((function(e){0==e.isUnlock&&e.handleCards(!0)}))},n.deal=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stock.setLockedManual(!0),this.pile.animateChainCards(),this.hideAllCardsBeforeDeal(),1!=this.scene.level.getLevel()){e.next=7;break}return e.next=7,this.scene.gameplay.boardGame.runFadeBackground(1,0,550,0);case 7:return this.scene.gameplayLayer.bringToTop(this.gameplay.coinUsingManager.wildCardWrapper),e.next=10,this.dealPile();case 10:return this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.DEAL_CARDS),e.next=13,this.pile.flipCardsStagger();case 13:return this.showLocks(),this.initStock(),this.deck.matchRatioCalculator.setCurrentRatio(100),e.next=18,this.dealStock();case 18:this.stock.setLockedManual(!1);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLocks=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.locks.map((function(e){return e.showLock()})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hideAllCardsBeforeDeal=function(){this.pile.cards.forEach((function(e){e.kill()}))},n.dealStock=function(){var e=this;return new Promise((function(t){var n=[].concat(e.stock.cards);n.forEach((function(e){return e.setY(e.y+100)}));var i=e.scene.time.addEvent({delay:20,repeat:n.length-1,callback:function(){var r=n.shift();r&&(r.move({x:r.x,y:e.stock.y,duration:200}),0==i.repeatCount&&e.scene.time.delayedCall(400,t))}})}))},n.dealPile=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.pile.cards,n=this.scene.gameZone.width/2,i=this.scene.tweens.createTimeline({onStart:function(){r.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.SHUFFLE,{})},onComplete:function(){r.scene.audio.stopSound(rc.Z.SHUFFLE)}}),t.forEach((function(e,t){e.revive();var r=e.x,a=e.y;e.setPosition(n,-160);var s=(n-r)/150*90;i.add({targets:e,props:{x:r,y:a,angle:{from:s,to:e.payload.angle,ease:Phaser.Math.Easing.Linear},scale:{from:.5*e.scale,to:e.scale}},duration:600,delay:0==t?200:0,offset:"-=570",ease:Phaser.Math.Easing.Sine.Out})})),e.next=6,i.playAndWaitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.update=function(e){this.deck.cards.forEach((function(t){t.active&&t.visible&&t.update(e)})),this.hint.update(e)},n.refillStock=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===t&&(t=5),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),n=0;n<t;n++)(i=this.deck.getNewCard(au.Stock)).setBehavior(),this.stock.addCard(i);return this.stock.align(),this.stock.setLockedManual(!0),this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.ADD_FIVE_CARDS),e.next=8,this.dealStock();case 8:this.stock.setLockedManual(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.increaseWildCardUsedCount=function(){this.metricsLog.wildCardUsedCount+=1},n.increaseUndoCount=function(){this.metricsLog.undoCount+=1},n.increaseAddCardsCountByCoin=function(){this.metricsLog.addCardsCountByCoin+=1},n.increaseAddCardsCountAd=function(){this.metricsLog.addCardsCountByAd+=1},n.increaseMissedPlayableCount=function(){this.metricsLog.missedPlayableCount+=1},n.increaseStreakCount=function(){this.metricsLog.streakCount+=1},n.increaseClickOnUnmatchedCardCount=function(){this.metricsLog.clickOnUnmatchedCardCount+=1},n.resetLog=function(){this.metricsLog.undoCount=0,this.metricsLog.addCardsCountByCoin=0,this.metricsLog.addCardsCountByAd=0,this.metricsLog.wildCardUsedCount=0,this.metricsLog.missedPlayableCount=0,this.metricsLog.streakCount=0,this.metricsLog.clickOnUnmatchedCardCount=0},n.getMetricsLog=function(){return this.metricsLog},t}(Phaser.Events.EventEmitter),Sp=bp,Tp={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},xp=Tp.STATUS,kp=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(xp.READY)},t.start=function(){this.isRunning()||this.setState(xp.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(xp.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===xp.READY},t.isRunning=function(){return this.state===xp.RUNNING},t.isStopped=function(){return this.state===xp.STOPPED},e}(),Pp=kp,Ip=function(e){function t(){var t;return(t=e.call(this,qi.IDLE,Object.values(qi),Object.values(Ji))||this).whenIn(qi.IDLE).if(Ji.START).goTo(qi.RUNNING),t.whenIn(qi.RUNNING).if(Ji.COMPLETED).goTo(qi.IDLE),t}return(0,f.Z)(t,e),t}(Ep),Op=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.type=void 0,this.stateMachine=new Ip,this.scene=e,this.boardGame=t,this.type=Xi.NONE}var t=e.prototype;return t.activate=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.gameplay.setEnableCardInput(!1),e.next=3,this.stateMachine.emitAndWait(Ji.START);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.complete=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.gameplay.setEnableCardInput(!0),e.next=3,this.stateMachine.emitAndWait(Ji.COMPLETED);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.waitForComplete=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.stateMachine.waitForEvent(Ji.COMPLETED));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Rp=Op,Bp=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).totalAddCards=void 0,i.type=Xi.PLUS_FIVE_CARDS,i.totalAddCards=5,i}(0,f.Z)(t,e);var n=t.prototype;return n.makeCards=function(){for(var e=[],t=0;t<this.totalAddCards;t++){var n=this.boardGame.deck.getNewStockCard();e.push(n)}return e},n.activate=function(){var t=(0,i.Z)(a().mark((function t(){var n,i,r,s,o,c,h,u=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:n=this.boardGame.stock,i=this.makeCards(),r=this.scene.world.getWorldSize().width/2,s=this.scene.world.getWorldSize().height/2,o=0,c=a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=i[h]).setAlpha(0),u.scene.time.delayedCall(o,(function(){t.setPosition(r,s),new _h.Z({targets:[t],duration:600}).play(),t.moveWithRotate({x:n.x,y:n.y,duration:1200}),u.scene.time.delayedCall(1e3,(function(){n.moveToStep(-1),n.addCard(t)}))})),o+=300;case 4:case"end":return e.stop()}}),e)})),h=0;case 9:if(!(h<i.length)){t.next=14;break}return t.delegateYield(c(),"t0",11);case 11:h++,t.next=9;break;case 14:this.scene.time.delayedCall(o+1200,(function(){u.complete()}));case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(Rp),Dp=Bp,Lp=function(e){function t(t,n){var i;(i=e.call(this,t,0,0)||this).background=void 0,i.image=void 0,i.isTop=void 0,i.isTop=n;var r=hu.CARD_VIEW_OFFSET,a=r.x,s=r.y;i.background=i.scene.make.image({x:a,y:s,key:Ki.Z.GAMEPLAY_OBJECTS.KEY,frame:Ki.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD}),i.background.setName("Card Background");var o=n?0:i.background.height/2;return i.background.setCrop(0,o,i.background.width,i.background.height/2),i.background.setDefaultWorldSize(),i.background.kill(),i.image=i.scene.make.image({x:a,y:s,key:Ki.Z.GAMEPLAY.KEY,frame:""}),i.image.kill(),i.setSize(i.background.width,i.background.height),i.add([i.background,i.image]),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.copy=function(e){this.image.setCrop(),this.image.setTexture(Ki.Z.GAMEPLAY_OBJECTS.KEY,e.cardImage.frame.name);var t=this.isTop?0:this.image.height/2;this.image.setCrop(0,t,this.image.width,this.image.height/2),this.image.setDefaultWorldSize()},n.kill=function(){e.prototype.kill.call(this),this.image.kill(),this.background.kill()},n.revive=function(){e.prototype.revive.call(this),this.image.revive(),this.background.revive()},t}(Phaser.GameObjects.Container),Mp=function(e){function t(t,n){var i;(i=e.call(this,t,0,0)||this).top=void 0,i.bottom=void 0,i.cancelAnyAnimation=void 0;var r=hu.CARD_VIEW,a=r.WIDTH,s=r.HEIGHT;return i.setSize(a,s),i.top=new Lp(t,!0),i.bottom=new Lp(t,!1),i.add([i.top,i.bottom]),i.scene.add.existing((0,yc.Z)(i)),n&&i.copy(n),i}(0,f.Z)(t,e);var n=t.prototype;return n.copy=function(e){this.top.copy(e),this.bottom.copy(e),this.top.setAngle(e.angle),this.bottom.setAngle(e.angle)},n.revive=function(){e.prototype.revive.call(this),this.top.revive(),this.bottom.revive(),this.top.setAlpha(1),this.bottom.setAlpha(1)},n.kill=function(){e.prototype.kill.call(this),this.top.kill(),this.bottom.kill()},n.slice=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.cancelAnyAnimation)||n.call(this),this.setAlpha(1),this.top.setAlpha(1),this.bottom.setAlpha(1),this.top.setScale(1),this.bottom.setScale(1),this.top.setPosition(0,0),this.bottom.setPosition(0,0),0,i=t?1.5*this.top.width:1.5*-this.top.width,r=3*this.bottom.height,s=-this.top.height,o=s+2*this.top.height,c=t?[20,270]:[-270,-20],h=t?[-270,-20]:[20,270],u=Phaser.Math.Between(c[0],c[1]),l=Phaser.Math.Between(h[0],h[1]),d=600,p=this.scene.tweens.add({targets:this.bottom,x:{value:i,ease:Phaser.Math.Easing.Sine.Out},y:{value:r,ease:Phaser.Math.Easing.Quadratic.In},scaleX:{value:.8,ease:Phaser.Math.Easing.Sine.Out},angle:{value:l,ease:Phaser.Math.Easing.Quartic.Out},alpha:{value:0,ease:Phaser.Math.Easing.Expo.In},duration:d}),f=p.waitForCompletion(),m=this.scene.tweens.add({targets:this.top,y:s,ease:Phaser.Math.Easing.Quadratic.Out,duration:120}),g=this.scene.tweens.add({targets:this.top,y:o,ease:Phaser.Math.Easing.Quadratic.In,delay:120,duration:480}),v=this.scene.tweens.add({targets:this.top,x:{value:i,ease:Phaser.Math.Easing.Sine.Out},scaleX:{value:.4,ease:Phaser.Math.Easing.Sine.Out},angle:{value:u,ease:Phaser.Math.Easing.Quartic.Out},alpha:{value:0,ease:Phaser.Math.Easing.Expo.In},duration:d}),y=Promise.all([m.waitForCompletion().then((function(){return g.waitForCompletion()})),v.waitForCompletion()]),E=function(){p.stop(),m.stop(),g.stop(),v.stop()},this.cancelAnyAnimation=E,e.next=28,Promise.all([y,f]);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container);function _p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Np(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Np(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Gp=1.3,Fp=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).appearSpine=void 0,i.spines=[],i.slicedCards=[],i.animation=void 0,i.type=Xi.SLICE,i.animation=new Od(t),i.animation.kill(),i.scene.gameplayLayer.add(i.animation),i}(0,f.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,i.Z)(a().mark((function t(){var n,i,r,s,o,c,h,u,l,d,p,f=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:this.appearSpine||(this.appearSpine=this.scene.add.spine(0,0,Ki.Z.CARD_SLICE_SPINE.DATA_KEY,Ki.Z.CARD_SLICE_SPINE.ATLAS_KEY),this.appearSpine.setScale(.333,.333),this.appearSpine.setPosition(this.scene.gameZone.width/2-2,this.scene.gameZone.height/2+25),this.appearSpine.kill(),this.scene.gameplayLayer.add(this.appearSpine)),n=this.boardGame.pile,i=this.boardGame.gameplay.comboManager,r=[],s=n.getFrontCards().filter((function(e){return e.visible&&e.behavior.type!=nu.CHAIN&&!e.isMysterious})),o=0;case 8:if(!(o<3)){t.next=17;break}if(!(s.length<1)){t.next=11;break}return t.abrupt("break",17);case 11:c=Phaser.Utils.Array.RemoveRandomElement(s),n.removeCard(c),r.push(c);case 14:o++,t.next=8;break;case 17:if(0!==r.length){t.next=19;break}return t.abrupt("return");case 19:return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),r.forEach((function(e){e.moveToTopLayer()})),this.scene.gameplayLayer.bringToTop(this.animation),(h=this.scene.gameplay.spineManager).reviveSpine(this.appearSpine),this.scene.gameplayLayer.bringToTop(this.appearSpine),t.next=27,h.playAnimation(this.appearSpine,Xu.CARD.APPEAR);case 27:return h.killSpine(this.appearSpine),u=[],l=Math.random()>.5,d=r[0].scaleX,p=r[0].scaleY,this.animation.revive(),t.next=35,this.animation.runAsync({targets:r,interlaceRightLeftRight:l,onHit:function(e,t){if(i.increaseCombo(e),f.scene.events.emit(Iu.Z.COLLECT_CARD,e),e.setScale(d,p),e.kill(),e.behavior instanceof nd)return e.behavior.throwNutToBasket();e.behavior instanceof nd&&u.push(e.behavior.throwNutToBasket()),e.behavior instanceof ed&&u.push(e.behavior.collectMapPiece()),u.push(f.runSliceFxAnimation(e,t))},onWindup:function(e){f.scene.tweens.killTweensOf(e),f.scene.tweens.add({targets:e,scaleX:Gp,scaleY:Gp,duration:200,ease:Phaser.Math.Easing.Cubic.InOut})}});case 35:return t.next=37,Promise.all(u);case 37:return t.next=39,this.complete();case 39:this.boardGame.mover.removeLockSegments(r);case 40:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.complete=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.boardGame.pile.refresh(),t.next=3,e.prototype.complete.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.runSliceFxAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getFirstSpine()){e.next=3;break}return e.abrupt("return");case 3:if(r=this.getFirstSlicedCard()){e.next=6;break}return e.abrupt("return");case 6:return r.revive(),r.setPosition(t.x,t.y),r.setScale(Gp,Gp),r.setAlpha(1),r.copy(t),this.scene.gameplayLayer.bringToTop(r),this.scene.gameplayLayer.bringToTop(i),(s=this.scene.gameplay.spineManager).reviveSpine(i),i.setPosition(t.x,t.y),this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.SLICE_CARD),this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.CUT_CARD),e.next=20,Promise.all([s.playAnimation(i,n?Xu.CARD.FX.RIGHT_CUT:Xu.CARD.FX.LEFT_CUT),r.slice(n)]);case 20:s.killSpine(i),r.kill();case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.createSpine=function(){var e=window.game.renderer;e.resize(e.width,e.height);var t=this.scene.add.spine(0,0,Ki.Z.CARD_SLICE_FX_SPINE.DATA_KEY,Ki.Z.CARD_SLICE_FX_SPINE.ATLAS_KEY);t.setScale(.333,.333);var n=this.boardGame.gameplay.spineManager,i=this.scene.world.getWorldSize().width/2,r=this.scene.world.getWorldSize().height/2;return n.killSpine(t),this.scene.gameplayLayer.add(t),t.setPosition(i,r),t},n.getFirstSpine=function(){for(var e,t=_p(this.spines);!(e=t()).done;){var n=e.value;if(!n.active&&!n.visible)return n}var i=this.createSpine();return this.spines.push(i),i},n.getFirstSlicedCard=function(){for(var e,t=_p(this.slicedCards);!(e=t()).done;){var n=e.value;if(!n.active&&!n.visible)return n}var i=this.createSlicedCard();return this.slicedCards.push(i),i},n.createSlicedCard=function(){var e=new Mp(this.scene),t=this.scene.world.getWorldSize().width/2,n=this.scene.world.getWorldSize().height/2;return this.scene.gameplayLayer.add(e),e.setPosition(t,n),e.kill(),e},t}(Rp),Zp=Fp,Up=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).shouldChoosePosForGuide=void 0,i.type=Xi.STORM,i.setShouldChoosePosForGuide(!1),i}(0,f.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,i.Z)(a().mark((function t(){var n,i,r,s,o,c,h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=window.game.renderer).resize(n.width,n.height),t.next=4,e.prototype.activate.call(this);case 4:return i=this.boardGame.stock,r=this.boardGame.deck.getWindmillCard(),s=i.cards.length,o=Math.min(s,3),c=Math.min(s,7),h=s-Phaser.Math.Between(o,c),this.shouldChoosePosForGuide&&(h=s-1,this.setShouldChoosePosForGuide(!1)),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),i.addCardAt(r,h),t.next=15,this.runAnimation(r,2e3);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setShouldChoosePosForGuide=function(e){this.shouldChoosePosForGuide=e},n.runAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.scaleX,r=t.scaleY,s=1.5*i,o=1.5*r,c=this.scene.world.getWorldSize().width/2,t.setScale(s,o),t.setPosition(c,-50),this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.STORM_BOOSTER_APPEAR),e.next=10,this.runCardAppearAnimation(t,n/2-100);case 10:return e.next=12,(0,gl.Z)(this.scene,100);case 12:return e.next=14,this.runCardReturnToPlaceAnimation(t,{x:i,y:r},n/2);case 14:this.complete();case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runCardAppearAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.world.getWorldSize().width/2,r=this.scene.world.getWorldSize().height/2,s=function(){t.behavior.facingUp?t.behavior.setFrameCardDown():t.behavior.setFrameCardUp()},o=0,c=function(){d.scene.audio.playAudioSprite(Hc.Z.CARD_ROTATE.KEY,"card_rotate_"+o),o+=1},h=function(){s(),c()},u=this.scene.add.tween({targets:t,scaleX:0,yoyo:!0,duration:n/4,repeat:1,ease:Phaser.Math.Easing.Sine.InOut,onYoyo:h}).waitForCompletion(),l=this.scene.add.tween({targets:t,x:i,y:r,duration:n,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),e.next=10,Promise.all([u,l]);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runCardReturnToPlaceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.runCardFlipAndReturnToSizeAnimation(t,n,.75*i),s=this.boardGame.stock,o=s.getPosition(t),c=this.scene.add.tween({targets:t,x:o.x,y:o.y,duration:i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.next=6,Promise.all([r,c]);case 6:return e.next=8,s.animateAlignCards();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runCardFlipAndReturnToSizeAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.x,s=n.y,e.next=4,this.scene.add.tween({targets:t,scaleX:0,angle:25,duration:.3*i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion();case 4:return t.behavior.setFrameCardDown(),e.next=7,this.scene.add.tween({targets:t,scaleX:r,scaleY:s,ease:Phaser.Math.Easing.Sine.InOut,duration:.4*i}).waitForCompletion();case 7:return e.next=9,this.scene.add.tween({targets:t,angle:0,ease:Phaser.Math.Easing.Sine.InOut,duration:.3*i}).waitForCompletion();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t}(Rp),Wp=Up,Yp=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).totalWildCards=void 0,i.totalWildCards=3,i.type=Xi.WILD_CARD,i}(0,f.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,i.Z)(a().mark((function t(){var n,i,r,s,o,c,h,u,l,d,p;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.WILD_CARD_APPEAR,{},!0),n=[],i=[],r=this.boardGame.pile,s=0;case 7:if(!(s<this.totalWildCards)){t.next=31;break}if(o=(o=r.getDownCards().filter((function(e){var t=e.behavior;return!(t instanceof Fu||t instanceof nd||t instanceof ed||t instanceof Wl||t instanceof Ku)}))).filter((function(e){return!i.find((function(t){return r.isOverLap(t,e)}))})),c=Phaser.Utils.Array.GetRandom(o)){t.next=13;break}return t.abrupt("break",31);case 13:if(r.removeCard(c),h=c.payload,u=h.x,l=h.y,d=h.angle,(p=this.boardGame.deck.getJokerCard()).payload=c.payload,p.payload.faceUp=!0,p.setPosition(u,l),p.setAngle(d),this.scene.gameplayLayer.moveBelow(p,c),this.scene.gameplayLayer.moveBelow(p.shadow,p),r.addCard(p),i.push(p),n.push(this.runAnimation(c,p)),!(s<this.totalWildCards-1)){t.next=28;break}return t.next=28,(0,gl.Z)(this.scene,100);case 28:s++,t.next=7;break;case 31:return t.next=33,Promise.all(n);case 33:this.complete();case 34:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.runAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.kill(),n.behavior.setFacing(!1),e.abrupt("return",n.behavior.setFacingWithFlippingAnim(!0));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.complete=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.complete.call(this);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(Rp),Hp=Yp;function zp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Kp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Kp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Vp=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.sliceBooster=void 0,i.stormBooster=void 0,i.plusFiveCardsBooster=void 0,i.wildCardBooster=void 0,i.boosters=void 0,i.scene=t,i.boardGame=n,i.boosters=[],i.sliceBooster=new Zp(i.scene,i.boardGame),i.stormBooster=new Wp(i.scene,i.boardGame),i.plusFiveCardsBooster=new Dp(i.scene,i.boardGame),i.wildCardBooster=new Hp(i.scene,i.boardGame),i}(0,f.Z)(t,e);var n=t.prototype;return n.enableBoosters=function(e){var t=e.slice,n=void 0!==t&&t,i=e.storm,r=void 0!==i&&i,a=e.plusCards,s=void 0!==a&&a,o=e.wildCard,c=void 0!==o&&o;r&&(this.boosters.push(this.stormBooster),this.reduceBoosterAmount(ji.STORM,1),this.scene.logEconomy.logUseItem(yl.BOOSTER_STORM,1,Cl.USE_STORAGE_ITEM)),s&&(this.boosters.push(this.plusFiveCardsBooster),this.reduceBoosterAmount(ji.PLUS_CARD,1),this.scene.logEconomy.logUseItem(yl.BOOSTER_PLUS_FIVE,1,Cl.USE_STORAGE_ITEM)),n&&(this.boosters.push(this.sliceBooster),this.reduceBoosterAmount(ji.SLICE,1),this.scene.logEconomy.logUseItem(yl.BOOSTER_SLICE,1,Cl.USE_STORAGE_ITEM)),c&&(this.boosters.push(this.wildCardBooster),this.reduceBoosterAmount(ji.WILD_CARD,1),this.scene.logEconomy.logUseItem(yl.BOOSTER_WILD_DROP,1,Cl.USE_STORAGE_ITEM))},n.increaseBoosterAmount=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.player,(r=i.getBoosterAmount(t)+n)<0&&(r=0),e.next=5,i.setBoosterAmount(t,r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.reduceBoosterAmount=function(e,t){var n=this.scene.player,i=n.getBoosterAmount(e)-t;i<0&&(i=0),n.setBoosterAmount(e,i)},n.getAmountBoosters=function(){var e=this.scene.player;return{slice:e.getBoosterAmount(ji.SLICE),storm:e.getBoosterAmount(ji.STORM),wildCard:e.getBoosterAmount(ji.WILD_CARD)}},n.stop=function(){this.boosters=[]},n.start=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=zp(this.boosters);case 1:if((n=t()).done){e.next=16;break}if(!((i=n.value)instanceof Wp)){e.next=6;break}return e.next=6,this.runStormBooster(i);case 6:if(!(i instanceof Zp)){e.next=9;break}return e.next=9,this.runSliceBooster(i);case 9:if(!(i instanceof Hp)){e.next=12;break}return e.next=12,this.runWildCardBooster(i);case 12:return e.next=14,(0,me.qZ)(100);case 14:e.next=1;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStormBooster=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.stock.slot),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),t.activate(),e.next=7,t.waitForComplete();case 7:return e.next=9,this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runSliceBooster=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),t.activate(),e.next=6,t.waitForComplete();case 6:return e.next=8,this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runWildCardBooster=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return t.activate(),e.next=4,t.waitForComplete();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getLogBooster=function(){return this.boosters.map((function(e){return e instanceof Wp?ji.STORM:e instanceof Zp?ji.SLICE:e instanceof Hp?ji.WILD_CARD:e instanceof Dp?ji.PLUS_CARD:ji.NONE})).join("|")||ji.NONE},t}(Pp),Xp=Vp,jp=n(75),qp=function(e,t,n){var i=e.canvas,r=e.context,a=e.style,s=[],o=0,c=n.length;a.maxLines>0&&a.maxLines<n.length&&(c=a.maxLines),a.syncFont(i,r);for(var h=0;h<c;h++){for(var u=a.strokeThickness,l=0;l<n[h].length;l++)u+=r.measureText(n[h][l]).width;a.wordWrap&&(u-=r.measureText(" ").width),s[h]=Math.ceil(u),o=Math.max(o,s[h])}var d=t.fontSize+a.strokeThickness,p=d*c,f=e.lineSpacing;return c>1&&(p+=f*(c-1)),{width:o,height:p,lines:c,lineWidths:s,lineSpacing:f,lineHeight:d}},Jp=function(e){function t(t,n){var i,r,a,s,o=Phaser.Display.Color.IntegerToColor(n.strokeColor||0),c=Phaser.Display.Color.IntegerToColor(null!=(i=n.fillColor)?i:16777215),h=void 0!==n.strokeThickness?n.strokeThickness+(n.extraStroke||0):0;return(s=e.call(this,t,0,0,n.text,{fontFamily:(0,Rc.BN)(),fontSize:n.fontSize+"px",stroke:"rgba("+o.red+", "+o.green+", "+o.blue+", "+(n.strokeAlpha||1)+")",strokeThickness:h,color:"rgb("+c.red+", "+c.green+", "+c.blue+")",fontStyle:n.fontStyle})||this).extraStroke=0,s.strokeOffset={x:0,y:0},s.letterSpacingExtra=0,s.strokeBlur=0,s.strokeBlurColor=0,s.strokeBlurAlpha=1,s.payload=void 0,s.charactersTint=[],s.charactersStrokeTint=[],s.payload=n,s.extraStroke=n.extraStroke||0,s.strokeOffset=n.strokeOffset?(0,p.Z)({},s.strokeOffset,n.strokeOffset):{x:0,y:0},s.letterSpacingExtra=n.letterSpacingExtra||0,s.strokeBlur=n.strokeBlur||0,s.strokeBlurColor=null!=(r=n.strokeBlurColor)?r:0,s.strokeBlurAlpha=null!=(a=n.strokeBlurAlpha)?a:1,s.setPadding(s.strokeBlur,s.strokeBlur,s.strokeBlur,s.strokeBlur),s.setHighQuality(),s.setOrigin(.5,.5),n.lineSpacing&&s.setLineSpacing(n.lineSpacing),s.scene.add.existing((0,yc.Z)(s)),s}(0,f.Z)(t,e);var n=t.prototype;return n.setCharacterTint=function(e,t,n,i,r){for(var a=0;a<e+t;a++)a>=this.charactersTint.length&&(this.charactersTint.push(void 0),this.charactersStrokeTint.push(void 0)),a>=e&&(this.charactersTint[a]=i,this.charactersStrokeTint[a]=r);return this.updateText(),this},n.setStrokeAlpha=function(e){var t=this.payload;if(t.strokeAlpha===e)return this;t.strokeAlpha=e;var n=Phaser.Display.Color.IntegerToColor(t.strokeColor||0);return this.style.stroke="rgba("+n.red+", "+n.green+", "+n.blue+", "+(t.strokeAlpha||1)+")",this.payload=t,this.updateText(),this},n.setStrokeColor=function(e){var t=this.payload;if(t.strokeColor===e)return this;t.strokeColor=e;var n=Phaser.Display.Color.IntegerToColor(t.strokeColor||0);return this.style.stroke="rgba("+n.red+", "+n.green+", "+n.blue+", "+(t.strokeAlpha||1)+")",this.payload=t,this.updateText(),this},n.setStrokeBlurColor=function(e){var t=this.payload;return t.strokeBlurColor===e||(t.strokeBlurColor=e,this.strokeBlurColor=e,this.payload=t,this.updateText()),this},n.setTintSeparate=function(e,t){var n=this.payload;if(n.fillColor===e&&n.strokeColor===t)return this;n.strokeColor=t;var i=Phaser.Display.Color.IntegerToColor(n.strokeColor||0);this.style.stroke="rgba("+i.red+", "+i.green+", "+i.blue+", "+(n.strokeAlpha||1)+")",n.fillColor=e;var r=Phaser.Display.Color.IntegerToColor(n.fillColor||16777215);return this.style.color="rgb("+r.red+", "+r.green+", "+r.blue+")",this.payload=n,this.updateText(),this},n.disableStroke=function(e){return void 0===e&&(e=!0),this.style.strokeThickness=e?0:this.payload.strokeThickness||0,this.updateText(),this},n.setLeftAlign=function(){return this.setAlign("left"),this.setOrigin(0,.5),this},n.setRightAlign=function(){return this.setAlign("right"),this.setOrigin(1,.5),this},n.setCenterAlign=function(){return this.setAlign("center"),this.setOrigin(.5,.5),this},n.getWidth=function(){return this.width},n.getHeight=function(){return this.height},n.updateText=function(){var e;if(""===this.text)return this;var t=this.canvas,n=this.context,i=this.style,r=i.getTextMetrics();i.syncFont(t,n);var a=this.text;(i.wordWrapWidth||i.wordWrapCallback)&&(a=this.runWordWrap(this.text));var s,o=a.split(this.splitRegExp),c=qp(this,r,o),h=this.padding,u=h.left||0,l=h.right||0,d=h.top||0,p=h.bottom||0,f=this.strokeOffset||{x:0,y:0},m=this.extraStroke+(this.letterSpacingExtra||0),g=Math.max.apply(Math,o.map((function(e){return e.length}))),v=this.extraStroke+Math.abs(f.x)+m*(g-1),y=this.extraStroke+2*Math.abs(f.y),E=(null==(e=this.payload)||null==(e=e.extraSpacings)?void 0:e.reduce((function(e,t){return e+t}),0))||0;0===i.fixedWidth?(this.width=c.width+u+l+v+this.letterSpacingExtra+E,s=c.width+v):(this.width=i.fixedWidth+v,(s=this.width-u-l+v)<c.width+v&&(s=c.width+v)),this.lines=o,this.textSize=c,this.textWidth=s,0===i.fixedHeight?this.height=c.height+d+p+y:this.height=i.fixedHeight+y,this.updateDisplayOrigin(),this.dirty=!0;var C=this.input;C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height);var w=Phaser.Display.Canvas.CanvasTexturePooler.getContainer(this.key);return w&&(w.dirty=!0),this},n.drawTextCanvas=function(){var e=Phaser.Display.Canvas.CanvasTexturePooler.use(this);if(e.dirty&&this.dirty&&this.lines){var t=this.canvas,n=this.context,i=this.style,r=i.resolution,a=i.metrics,s=this.textSize,o=this.textWidth,c=this.strokeOffset||{x:0,y:0},h=this.extraStroke+(this.letterSpacingExtra||0),u=this.padding,l=u.left||0,d=u.top||0,p=this.lines,f=Math.max.apply(Math,p.map((function(e){return e.length}))),m=this.width,g=this.height;m*=r,g*=r,m=Math.max(m,1),g=Math.max(g,1);var v,y,E=this.extraStroke+Math.abs(c.x)+h*(f-1),C=this.extraStroke+2*Math.abs(c.y);m=Math.max(m,1),g=Math.max(g,1),t.width=m,t.height=g,this.frame.setSize(m,g),i.syncFont(t,n),n.save(),n.scale(r,r),i.backgroundColor&&(n.fillStyle=i.backgroundColor,n.fillRect(0,0,m,g)),i.syncStyle(t,n),n.textBaseline="alphabetic";for(var w=0,A=this.charactersTint||[],b=this.charactersStrokeTint||[],S=0;S<s.lines;S++){if(v=i.strokeThickness/2+E/2-h,y=i.strokeThickness/2+S*s.lineHeight+a.ascent+C/2+d,S>0&&(y+=s.lineSpacing*S),i.rtl)v=m-v;else if("right"===i.align)v+=o-s.lineWidths[S];else if("center"===i.align)v+=(o-s.lineWidths[S])/2;else if("justify"===i.align){if(s.lineWidths[S]/s.width>=.85){var T=s.width-s.lineWidths[S],x=n.measureText(" ").width,k=p[S].trim(),P=k.split(" ");T+=(p[S].length-k.length)*x;for(var I=Math.floor(T/x),O=0;I>0;)P[O]+=" ",O=(O+1)%(P.length-1||1),--I;p[S]=P.join(" ")}}if(this.autoRound&&(v=Math.round(v),y=Math.round(y)),i.strokeThickness){this.style.syncShadow(n,i.shadowStroke);for(var R=v+c.x,B=0;B<p[S].length;B++){var D,L=p[S][B],M=w+B,_=b.length>M?b[M]:void 0;if(void 0!==_){var N=Phaser.Display.Color.IntegerToColor(_);n.strokeStyle="rgba("+N.red+", "+N.green+", "+N.blue+", "+(this.payload.strokeAlpha||1)+")"}else n.strokeStyle=this.style.stroke;n.strokeText(L,R,y+c.y);var G=(null==(D=this.payload.extraSpacings)?void 0:D[B])||0;R+=n.measureText(L).width+h+G}}if(this.strokeBlur)for(var F=this.strokeBlurAlpha/4,Z=this.strokeBlur/4,U=1;U<=4;U++){this.style.syncShadow(n,i.shadowStroke);for(var W=v+c.x+l,Y=0;Y<p[S].length;Y++){var H,z=p[S][Y],K=Phaser.Display.Color.IntegerToColor(this.strokeBlurColor);n.strokeStyle="rgba("+K.red+", "+K.green+", "+K.blue+", "+F+")",n.lineWidth=Z*U,n.strokeText(z,W,y+c.y);var V=(null==(H=this.payload.extraSpacings)?void 0:H[Y])||0;W+=n.measureText(z).width+h+V}}if(i.color){this.style.syncShadow(n,i.shadowFill);for(var X=v+l,j=0;j<p[S].length;j++){var q,J=p[S][j],Q=w+j,$=A.length>Q?A[Q]:void 0;if(void 0!==$){var ee=Phaser.Display.Color.IntegerToColor($);n.strokeStyle="rgba("+ee.red+", "+ee.green+", "+ee.blue+", 1)",n.fillStyle="rgba("+ee.red+", "+ee.green+", "+ee.blue+", 1)"}else n.strokeStyle=this.style.color,n.fillStyle=this.style.color;0!==this.extraStroke&&(n.lineWidth=this.extraStroke,n.strokeText(J,X,y)),n.fillText(J,X,y);var te=(null==(q=this.payload.extraSpacings)?void 0:q[j])||0;X+=n.measureText(J).width+h+te}}w+=p[S].length}n.restore(),this.renderer&&this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1,e.dirty=!1}},t}(Phaser.GameObjects.Text),Qp=Jp,$p=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).countText=void 0,r.background=void 0,r.amount=0,r.create(),r}(0,f.Z)(t,e);var n=t.prototype;return n.setCount=function(e){this.amount=e,this.countText.setText(""+e)},n.getAmount=function(){return this.amount},n.create=function(){var e=Ki.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.IC_INFO);i.setDefaultWorldSize(),this.setSize(i.width,i.height);var r=new Qp(this.scene,{text:"99",fontSize:this.scene.fontSize(14),strokeBlur:2,strokeBlurAlpha:.3,strokeBlurColor:0,fillColor:16776958});r.setPadding(2,0,2,0),r.setY(0),this.add([i,r]),this.countText=r,this.background=i,r.setPosition(.5,-.5)},t}(Phaser.GameObjects.Container),ef=$p,tf=Ki.Z.GAMEPLAY_DEFAULT,nf=tf.KEY,rf=tf.FRAME,af={WIDTH:62,HEIGHT:58/3},sf=function(e){function t(t,n,i,r,a){var s;return(s=e.call(this,t,n,i)||this).bg=void 0,s.coinImage=void 0,s.costText=void 0,s.freeText=void 0,s.setSize(r||af.WIDTH,a||af.HEIGHT),s.create(),s}(0,f.Z)(t,e);var n=t.prototype;return n.setBlueColor=function(){this.bg.setFrame(rf.THREE_SLICES.COIN_PANEL_BLUE),this.bg.setWorldSize(this.width,this.height)},n.updateSize=function(e,t){this.setSize(e,t),this.bg.setWorldSize(e,t),this.align()},n.setCost=function(e){this.showCost(),this.costText.setText(e.toString())},n.align=function(){Phaser.Display.Align.In.Center(this.costText,this.bg,9,0),Phaser.Display.Align.To.LeftCenter(this.coinImage,this.costText,5,0),Phaser.Display.Align.In.Center(this.freeText,this.bg)},n.showFree=function(){this.killAllContents(),this.freeText.revive()},n.showCost=function(){this.killAllContents(),this.costText.revive(),this.coinImage.revive()},n.killAllContents=function(){this.freeText.kill(),this.costText.kill(),this.coinImage.kill()},n.create=function(){var e=this.scene.add.image(0,0,nf,rf.THREE_SLICES.COIN_PANEL_GRAY);e.setWorldSize(this.width,this.height);var t=this.scene.add.image(0,0,nf,rf.IC_COIN);t.setDefaultWorldSize();var n=new Qp(this.scene,{text:"999",fontSize:this.scene.fontSize(12),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setTint(16777215);var i=new Qp(this.scene,{text:this.scene.lang.Text.free,fontSize:this.scene.fontSize(14),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add([e,t,n,i]),this.bg=e,this.coinImage=t,this.costText=n,this.freeText=i,this.align()},t}(Phaser.GameObjects.Container),of=sf,cf=Ki.Z.GAMEPLAY_DEFAULT,hf=cf.KEY,uf=cf.FRAME,lf=function(e){function t(t,n,i){var r;return(r=e.call(this,t,40,40)||this).main=void 0,r.counterBlock=void 0,r.costBlock=void 0,r.adsIcon=void 0,r.mainIcon=void 0,r.createMain(n,i),r.createCounterBlock(),r.createCostBlock(),r.createAdsIcon(),r.updateSize(r.costBlock.width,r.costBlock.height),t.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateMainSize=function(e,t){this.main.setSize(e,t),this.align()},n.alignMain=function(e,t){Phaser.Display.Align.In.TopCenter(this.main,this,e,t)},n.getOffsetMainY=function(){return this.counterBlock.getAmount()>0?11.5:-11.5},n.align=function(){this.main.setY(-this.height/2+this.main.height/2),this.counterBlock.setX(this.main.x+this.main.width/2-this.counterBlock.width/2+8),this.counterBlock.setY(this.main.y-this.main.height/2+this.counterBlock.height/2-6),this.costBlock.setY(this.height/2-this.costBlock.height/2-3.4),this.adsIcon.setX(-this.width/2+this.adsIcon.width/2-11.5),this.adsIcon.setY(-this.height/2+this.adsIcon.height/2-3)},n.updateSize=function(e,t){this.setSize(e,t),this.align()},n.setFacingUp=function(e){e?this.sendToBack(this.main):this.bringToTop(this.main)},n.setCost=function(e){e<=0?this.costBlock.showFree():this.costBlock.setCost(e)},n.setCounter=function(e,t){void 0===t&&(t=!1),this.counterBlock.setCount(e),e<=0&&!t?(this.runShowBlock(this.costBlock),this.runHideBlock(this.counterBlock)):(this.runShowBlock(this.counterBlock),this.runHideBlock(this.costBlock))},n.getAmount=function(){return this.counterBlock.getAmount()},n.showAds=function(){this.hideAllBlocks(),this.adsIcon.revive()},n.hideAllBlocks=function(){this.costBlock.kill(),this.counterBlock.kill(),this.adsIcon.kill()},n.runShowBlock=function(e){e.active&&1===e.alpha||this.scene.tweens.add({targets:e,duration:200,alpha:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.revive(),e.setAlpha(0)}})},n.runHideBlock=function(e){this.scene.tweens.add({targets:e,duration:200,alpha:{from:1,start:1,to:0},ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.setAlpha(1)},onComplete:function(){e.kill()}})},n.createMain=function(e,t){var n=this.scene.add.container(0,0);this.add(n);var i=this.scene.add.image(0,0,e,t);i.setDefaultWorldSize(),n.add(i),n.setSize(i.width,i.height),this.main=n,this.mainIcon=i},n.createCounterBlock=function(){var e=new ef(this.scene);this.add(e),this.counterBlock=e},n.createCostBlock=function(){var e=new of(this.scene);e.kill(),this.add(e),this.costBlock=e,this.setSize(this.costBlock.width,this.height)},n.createAdsIcon=function(){var e=this.scene.add.image(0,0,hf,uf.IC_VIDEO);e.setDefaultWorldSize(),e.kill(),this.add(e),this.adsIcon=e},t}(jp.Z),df=lf,pf={maxAddCardsByCoin:2},ff={addCards:7,boosterSlice:5,boosterStorm:10,boosterWildCard:15,combo:3,heart:10,undo:2,wildCard:6},mf={coinsPerStockCard:5,rewardedAdOffer:300,welcomeBackOffer:1e3,streak:{coin:50,chest:200}},gf=function(){function e(){this.gameplay=void 0,this.requiredLevels=void 0,this.reward=void 0,this.init(),e._instance=this,this.gameplay.maxAddCardsByCoin=GameCore.Configs.RemoteConfigs.MaxAddCardsByCoin}return e.prototype.init=function(){var e=this;GameCore.Configs.GameSettingsURL?window.game.cache.json.get("game-settings").properties.forEach((function(t){if("gameSettings"==t.name){var n=t.value;e.gameplay=(0,p.Z)({},pf,n.gameplay),e.requiredLevels=(0,p.Z)({},ff,n.requiredLevels),e.reward=(0,p.Z)({},mf,n.reward)}})):(this.gameplay=(0,p.Z)({},pf),this.requiredLevels=(0,p.Z)({},ff),this.reward=(0,p.Z)({},mf))},(0,X.Z)(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e)}}]),e}();gf._instance=void 0;var vf=gf,yf=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.clear()},n.get=function(){return this.updateAmount(-1),this.getLast()},n.add=function(t){return e.prototype.add.call(this,t),this.updateAmount(1),this},n.updateAmount=function(e){var t=this.scene.player.getWildCard();this.scene.player.setWildCard(t+e)},t}(Phaser.GameObjects.Group),Ef=yf,Cf=Ki.Z.GAMEPLAY_OBJECTS,wf=Cf.KEY,Af=Cf.FRAME,bf=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).scene=void 0,r.boardGame=void 0,r.wildCardWrapper=void 0,r.undoBtn=void 0,r.wildCardBtn=void 0,r.addCardsBtn=void 0,r.addCardsByAdsBtn=void 0,r.addCardsFreeBtn=void 0,r.wildCardStorage=void 0,r.undoPrice=void 0,r.wildCardPrice=void 0,r.addCardsPrice=void 0,r.undoPriceDiff=void 0,r.wildCardPriceDiff=void 0,r.addCardsPriceDiff=void 0,r.autoUpdateWildCardAmount=void 0,r.buyCardsCount=void 0,r.isAddCardsByAdsCancel=void 0,r.onWildCardChanged=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.scene&&r.autoUpdateWildCardAmount){e.next=2;break}return e.abrupt("return");case 2:r.scene.gameplayLayer.bringToTop(r.wildCardWrapper),t=r.wildCardBtn.getAmount(),n=r.scene.player.getWildCard(),r.wildCardBtn.setCounter(n),0==n&&r.wildCardBtn.setCost(r.wildCardPrice),0==t&&n>0&&r.scene.tweens.add({targets:r.wildCardBtn,duration:200,y:{from:0,start:0,to:23},ease:Phaser.Math.Easing.Sine.Out}),t>0&&0==n&&r.scene.tweens.add({targets:r.wildCardBtn,duration:200,y:{from:23,start:23,to:0},ease:Phaser.Math.Easing.Sine.Out});case 9:case"end":return e.stop()}}),e)}))),r.onUndoChanged=function(){if(r.scene){var e=r.scene.player.getUndo();r.undoBtn.setCounter(e),e<=0&&r.undoBtn.setCost(r.undoPrice)}},r.onPlusFiveChanged=function(){if(r.scene){var e=r.scene.player.getPlusFive();r.addCardsBtn.setCounter(e),e<=0&&r.addCardsBtn.setCost(r.addCardsPrice)}},r.onUseWildCard=(0,i.Z)(a().mark((function e(){var t,n,i,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.scene.gameplay.enableCardInput){e.next=2;break}return e.abrupt("return");case 2:if(t=r.scene.gameplay.boardGame,n=t.waste,i=t.mover,!(n.getCardsLength()<=0)){e.next=6;break}return e.abrupt("return");case 6:if(!((null==(s=n.getOnTopCard())?void 0:s.behavior)instanceof Al)){e.next=9;break}return e.abrupt("return");case 9:if(o=r.scene.player.getWildCard(),c=r.scene.player.getCoins(),!(o<=0&&c<r.wildCardPrice)){e.next=13;break}return e.abrupt("return",r.handleNotEnoughCoins());case 13:t.hint.resetAutoHintTime(),r.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.DRAW_WILD),i.increaseMoves(),o>0?(h=r.useRemainWildCard(),r.scene.logEconomy.logUseItem(yl.WILD_CARD,1,Cl.USE_STORAGE_ITEM)):(h=r.buyAndUseNewWildCard()).behavior instanceof Al&&(h.behavior.isBought=!0),r.onWildCardChanged(),t.increaseWildCardUsedCount(),h.behavior.activate(),t.stateMachine.emit(tu.DRAW_WILD_CARD);case 22:case"end":return e.stop()}}),e)}))),r.onUseUndo=function(){if(r.scene.gameplay.enableCardInput){var e=r.scene.gameplay.boardGame;if(e.mover.canUndo()){var t=r.scene.player.getUndo(),n=r.scene.player.getCoins();if(t<=0&&n<r.undoPrice)return r.handleNotEnoughCoins();if(e.hint.resetAutoHintTime(),e.increaseUndoCount(),t>0)r.scene.player.setUndo(t-1),r.scene.logEconomy.logUseItem(yl.UNDO,1,Cl.USE_STORAGE_ITEM);else{r.scene.player.setCoins(n-r.undoPrice),r.scene.logEconomy.logBuyAndUseInstantItem(yl.UNDO,r.undoPrice,Cl.BUY_USE_UNDO);var i=r.undoPrice+r.undoPriceDiff;r.setUndoPrice(i)}r.onUndoChanged(),e.stateMachine.emit(tu.UNDO)}}},r.onUseAddCards=function(){if(r.addCardsBtn.active&&(r.addCardsBtn.active=!1,r.scene.gameplay.enableCardInput)){var e=r.scene.gameplay.boardGame,t=r.scene.player.getPlusFive(),n=r.scene.player.getCoins();if(t<=0&&n<r.addCardsPrice)return r.handleNotEnoughCoins();if(t>0)r.scene.player.setPlusFive(t-1),r.scene.logEconomy.logUseItem(yl.PLUS_FIVE,1,Cl.USE_STORAGE_ITEM);else{r.buyCardsCount+=1,r.scene.player.setCoins(n-r.addCardsPrice),r.scene.logEconomy.logBuyAndUseInstantItem(yl.PLUS_FIVE,r.addCardsPrice,Cl.BUY_USE_PLUS_FIVE);var i=r.addCardsPrice+r.addCardsPriceDiff;r.setAddCardsPrice(i),r.boardGame.increaseAddCardsCountByCoin()}r.onPlusFiveChanged(),e.stateMachine.emit(tu.REFILL_STOCK)}},r.onUseAddCardsByAds=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.addCardsByAdsBtn.active){e.next=2;break}return e.abrupt("return");case 2:if(r.scene.gameplay.enableCardInput){e.next=4;break}return e.abrupt("return");case 4:return t=r.scene.gameplay.boardGame,e.next=7,r.scene.showRewardedVideoAsync();case 7:if(!e.sent){e.next=14;break}t.stateMachine.emit(tu.REFILL_STOCK),r.boardGame.increaseAddCardsCountAd(),r.scene.logEconomy.logWatchAdAndUseInstantItem(yl.PLUS_FIVE,Cl.PLUS_FIVE_AD),e.next=19;break;case 14:if(!(r.buyCardsCount>=vf.instance.gameplay.maxAddCardsByCoin)){e.next=19;break}return r.isAddCardsByAdsCancel=!0,e.next=18,r.scene.gameUI.gameUILayout.hidePlusCardsButtons(250);case 18:r.scene.gameUI.gameUILayout.showPlusCardsButtons([r.addCardsBtn]);case 19:case"end":return e.stop()}}),e)}))),r.scene=t,r.boardGame=n,r.autoUpdateWildCardAmount=!0,r.buyCardsCount=0,r.isAddCardsByAdsCancel=!1,r.intiPrices(),r.createButtons(),r.wildCardStorage=new Ef(r.scene),r.listenEvents(),r.checkValidItems(),r}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.wildCardStorage.init(),this.buyCardsCount=0,this.isAddCardsByAdsCancel=!1;var t=this.scene.level.getLevelData();if(t){var n=t.settings.mapProperties.cost;this.setWildCardPrice(n.wildCard),this.wildCardPriceDiff=n.wildCardDifference,this.setUndoPrice(n.undo),this.undoPriceDiff=n.undoDifference,this.setAddCardsPrice(n.addCards),this.addCardsPriceDiff=n.addCardsDifference}this.onWildCardChanged(),this.onUndoChanged(),this.onPlusFiveChanged()},n.checkValidItems=function(){var e=this.scene.player.getWildCard(),t=this.scene.player.getUndo(),n=this.scene.player.getPlusFive();this.scene.player.setWildCard(e),this.scene.player.setUndo(t),this.scene.player.setPlusFive(n)},n.setWildCardDefault=function(){},n.setAutoUpdateWildCardAmount=function(e){this.autoUpdateWildCardAmount=e},n.setWildCardPrice=function(e){this.wildCardPrice=e},n.setWildCardPriceDiff=function(e){this.wildCardPriceDiff=e},n.setUndoPrice=function(e){this.undoPrice=e},n.setUndoPriceDiff=function(e){this.undoPriceDiff=e},n.setAddCardsPrice=function(e){this.addCardsPrice=e},n.setAddCardsPriceDiff=function(e){this.addCardsPriceDiff=e},n.getWildCardPrice=function(){return this.wildCardPrice},n.listenEvents=function(){this.onWildCardChanged(),this.onUndoChanged(),this.onPlusFiveChanged(),this.scene.game.events.on(pi.WILDCARD_CHANGED,this.onWildCardChanged),this.scene.game.events.on(pi.UNDO_CHANGED,this.onUndoChanged),this.scene.game.events.on(pi.PLUS_FIVE_CHANGED,this.onPlusFiveChanged),this.boardGame.stateMachine.on(tu.PURCHASE_WILD_CARD,this.onUseWildCard,this),this.boardGame.stateMachine.on(tu.PURCHASE_UNDO,this.onUseUndo,this),this.boardGame.stateMachine.on(tu.PURCHASE_REFILL_STOCK,this.onUseAddCards,this),this.boardGame.stateMachine.on(tu.PURCHASE_REFILL_STOCK_WITH_ADS,this.onUseAddCardsByAds,this)},n.useRemainWildCard=function(){var e=this.scene.gameplay.boardGame.deck,t=this.wildCardStorage.get();return t||e.getJokerCard()},n.buyAndUseNewWildCard=function(){var e=this.scene.gameplay.boardGame,t=e.mover,n=e.deck,i=this.scene.player.getCoins();this.scene.player.setCoins(i-this.wildCardPrice),t.addUndoUsageChange({coin:-this.wildCardPrice}),this.scene.logEconomy.logBuyAndUseInstantItem(yl.WILD_CARD,this.wildCardPrice,Cl.BUY_USE_WILD_CARD);var r=this.wildCardPrice+this.wildCardPriceDiff;return this.setWildCardPrice(r),n.getJokerCard()},n.addWildCard=function(e,t){void 0===t&&(t=!0);var n=e.behavior;n instanceof Al&&n.isBought||(!t&&this.setAutoUpdateWildCardAmount(!1),this.wildCardStorage.add(e),this.scene.logEconomy.logGetItem(yl.WILD_CARD,1,Cl.UNDO_WILDCARD),this.setAutoUpdateWildCardAmount(!0))},n.removeWildCard=function(e){this.wildCardStorage.remove(e);var t=this.scene.player.getWildCard();this.scene.player.setWildCard(t-1),this.scene.logEconomy.logUseItem(yl.WILD_CARD,1,Cl.UNDO_PLAY_CARD)},n.runWildCardButtonAnim=function(e,t){this.wildCardBtn.setY(e);var n=Phaser.Math.Difference(e,t)/.2;this.scene.tweens.add({targets:this.wildCardBtn,delay:1e3,y:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut})},n.handleNotEnoughCoins=function(){this.scene.screen.open(de.o4.GET_COINS_SCREEN,{claimedCoin:vf.instance.reward.rewardedAdOffer})},n.intiPrices=function(){this.undoPrice=0,this.undoPriceDiff=0,this.wildCardPrice=0,this.wildCardPriceDiff=0,this.addCardsPrice=0,this.addCardsPriceDiff=0},n.createButtons=function(){var e=this;this.createWildcardButton(),this.createUndoBtn(),this.createAddCardsBtn(),this.createAddCardsFreeBtn(),this.createAddCardsByAdsBtn(),this.wildCardBtn.onClick=function(){return e.boardGame.stateMachine.emit(tu.PURCHASE_WILD_CARD)},this.undoBtn.onClick=function(){return e.boardGame.stateMachine.emit(tu.PURCHASE_UNDO)},this.addCardsBtn.onClick=function(){return e.boardGame.stateMachine.emit(tu.PURCHASE_REFILL_STOCK)},this.addCardsFreeBtn.onClick=function(){return e.boardGame.stateMachine.emit(tu.REFILL_STOCK)},this.addCardsByAdsBtn.onClick=function(){return e.boardGame.stateMachine.emit(tu.PURCHASE_REFILL_STOCK_WITH_ADS)}},n.createWildcardButton=function(){var e=this.scene.add.container(0,0);this.scene.gameplayLayer.add(e),this.scene.gameplayLayer.bringToTop(e);var t=new df(this.scene,wf,Af.WILD_CARD);t.setName("WildCard"),t.updateSize(t.width,100),e.add(t),this.wildCardBtn=t,this.wildCardWrapper=e,e.setSize(t.width,100)},n.createUndoBtn=function(){var e=new df(this.scene,wf,Af.BTN_IC_UNDO);e.setName("Undo"),e.updateSize(e.width,65),this.undoBtn=e},n.createAddCardsBtn=function(){var e=new df(this.scene,wf,Af.BTN_PLUS_FIVE_CARDS);e.setName("PlusFive");var t=hu.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsBtn=e},n.createAddCardsFreeBtn=function(){var e=new df(this.scene,wf,Af.BTN_PLUS_FIVE_CARDS);e.setName("PlusFiveFree"),e.setCost(0);var t=hu.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsFreeBtn=e},n.createAddCardsByAdsBtn=function(){var e=new df(this.scene,wf,Af.BTN_PLUS_FIVE_CARDS);e.setName("PlusFiveByAds"),e.showAds();var t=hu.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsByAdsBtn=e},n.showPlusCards=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=vf.instance.gameplay.maxAddCardsByCoin,e.t0=t,e.next=e.t0===wp.FREE?5:e.t0===wp.NOT_FREE?7:9;break;case 5:return n.push(this.addCardsFreeBtn),e.abrupt("break",9);case 7:return this.buyCardsCount>=i?this.isAddCardsByAdsCancel?n.push(this.addCardsBtn):n.push(this.addCardsByAdsBtn):n.push(this.addCardsBtn,this.addCardsByAdsBtn),e.abrupt("break",9);case 9:this.scene.gameUI.gameUILayout.showPlusCardsButtons(n),this.scene.gameUI.showEndGame();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pp),Sf=bf,Tf=Ki.Z.GAMEPLAY_OBJECTS,xf=Tf.KEY,kf=Tf.FRAME.STREAK,Pf=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).point=void 0,r.pointHolder=void 0,r.createPoint(),r.createPointHolder(),r.add([r.pointHolder,r.point]),r.setSize(r.point.width,r.point.height),r}(0,f.Z)(t,e);var n=t.prototype;return n.createPoint=function(){var e=this.scene.add.image(0,1,xf,kf.POINT_NONE);e.kill(),e.setDefaultWorldSize(),this.point=e},n.createPointHolder=function(){var e=this.scene.add.image(0,0,xf,kf.POINT_NONE);e.setDefaultWorldSize(),this.pointHolder=e},n.setFrame=function(e){e==kf.POINT_NONE?this.point.kill():this.point.revive(),this.point.setFrame(e)},n.getFrame=function(){return this.point.frame.name},n.runPopUpAnimation=function(e){var t=this;return this.point.setScale(.5*e),new Promise((function(n){t.scene.tweens.add({targets:t.point,scale:e,duration:350,ease:Phaser.Math.Easing.Back.Out,onComplete:n})}))},t}(Phaser.GameObjects.Container),If=function(e){function t(t,n,i){var r;return(r=e.call(this,t.scene,0,0)||this).comboManager=void 0,r.background=void 0,r.points=void 0,r.x2Block=void 0,r.currentItem=void 0,r.nextItem=void 0,r.pointContainer=void 0,r.itemPos=void 0,r.nextItemPos=void 0,r.exchangeItemAnimation=void 0,r.scaleBgWithAnim=void 0,r.x2BlockTween=void 0,r.setSize(n,i),r.comboManager=t,r.createBackground(),r.createPoints(),r.createItems(),r.createX2Block(),r.updateComboLength(4),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.getItemPos=function(){return new Phaser.Geom.Point(this.x+this.itemPos.x,this.y+this.itemPos.y)},n.getNextItemPos=function(){return new Phaser.Geom.Point(this.x+this.nextItemPos.x,this.y+this.nextItemPos.y)},n.getItemFrame=function(e){switch(e){case Hd.COIN:return kf.COIN;case Hd.CHEST:return kf.TREASURE;case Hd.CARD:return kf.CARD;case Hd.WILD:return kf.WILDCARD}return""},n.updateCombo=function(e){this.comboManager.isSameColor(e)&&e.length>1?this.showX2Block(!0):this.showX2Block(!1),this.points.forEach((function(t,n){if(n<e.length){var i=e[n];t.setFrame(i?kf.POINT_RED:kf.POINT_BLACK)}else t.setFrame(kf.POINT_NONE)}))},n.showPoints=function(e){this.points.forEach((function(e){return e.kill()}));for(var t=0;t<e;t++){var n;null==(n=this.points[t])||n.revive()}},n.showX2Block=function(e){var t,n=e?1:0,i=e?1:0;null==(t=this.x2BlockTween)||t.stop(),this.x2BlockTween=this.scene.tweens.add({targets:this.x2Block,alpha:i,scale:n,duration:200,ease:Phaser.Math.Easing.Sine.InOut})},n.createBackground=function(){var e=this.scene.make.nineslice({key:xf,frame:kf.BAR,width:this.width,height:this.height,leftWidth:32/3,rightWidth:116/3});e.setOrigin(1,.5),this.add(e),Phaser.Display.Align.In.RightCenter(e,this),this.background=e},n.createPoints=function(){var e=this.scene.make.container({});this.pointContainer=e,this.points=[];for(var t=0;t<6;t++){var n=new Pf(this.scene,0,0);e.add(n),this.points.push(n)}this.add(e),Phaser.Display.Align.In.LeftCenter(e,this.background)},n.createItems=function(){this.itemPos=new Phaser.Geom.Point(28,2),this.nextItemPos=new Phaser.Geom.Point(75,0),this.currentItem=this.scene.add.image(0,0,xf,kf.WILDCARD),this.currentItem.setDefaultWorldSize(),this.nextItem=this.scene.add.image(0,0,xf,kf.COIN),this.nextItem.setDefaultWorldSize(),this.add([this.currentItem,this.nextItem]),this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItemPos.x,this.nextItemPos.y)},n.createX2Block=function(){var e=Ki.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.container(),r=this.scene.add.image(0,0,t,n.IC_INFO);r.setDefaultWorldSize(),i.setSize(r.width,r.height);var a=new Qp(this.scene,{text:"x2",fontSize:this.scene.fontSize(15),strokeBlur:2,strokeBlurAlpha:.3,strokeBlurColor:0,fillColor:16776958});a.setPosition(.5,-.5),i.add([r,a]),this.add(i),i.setPosition(this.currentItem.x+this.currentItem.width/2-2,this.currentItem.y+this.currentItem.height/2-2),this.x2Block=i},n.updateRewardItems=function(e){var t,n=this.comboManager,i=n.streaks,r=n.threshold,a=e+1>=i.length?0:e+1,s=this.getItemFrame(i[e].type),o=this.getItemFrame(i[a].type);null==(t=this.exchangeItemAnimation)||t.stop(),this.currentItem.setTexture(xf,s),this.nextItem.setTexture(xf,o),this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItemPos.x,this.nextItemPos.y),this.currentItem.setDefaultWorldSize(),this.nextItem.setDefaultWorldSize(),this.nextItem.setScaleByWorld(.9),this.updateComboLength(r)},n.runLastPointPopUpAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=1/GameCore.ImageScale,n=this.points.filter((function(e){return e.getFrame()==kf.POINT_RED||e.getFrame()==kf.POINT_BLACK})).pop()){e.next=4;break}return e.abrupt("return");case 4:return e.abrupt("return",n.runPopUpAnimation(t));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExchangeItemAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i;null==(i=n.exchangeItemAnimation)||i.stop();var r=n.scene.tweens.timeline({onStart:function(){n.showX2Block(!1)},onComplete:function(){e()}});r.add({targets:n.nextItem,scale:.4,duration:100,ease:Phaser.Math.Easing.Sine.In}),r.add({targets:n.nextItem,scale:.6,alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){n.nextItem.setTexture(xf,t),n.nextItem.setPosition(n.nextItemPos.x,n.nextItemPos.y)}}),r.add({targets:n.nextItem,alpha:1,scale:.9/GameCore.ImageScale,duration:400,ease:Phaser.Math.Easing.Back.Out,onStart:function(){n.nextItem.setScale(0)}}),r.add({targets:n.currentItem,x:n.itemPos.x,y:n.itemPos.y,alpha:1,scale:1/GameCore.ImageScale,duration:400,offset:300,ease:Phaser.Math.Easing.Sine.In}),n.exchangeItemAnimation=r,r.play()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.reset=function(){this.updateRewardItems(0),this.showX2Block(!1),this.points.forEach((function(e){e.setFrame(kf.POINT_NONE)}))},n.updateComboLength=function(e,t){var n,i=this;null==(n=this.scaleBgWithAnim)||n.remove();var r=505/3;switch(e){case 4:r-=56/3;break;case 5:r+=0;break;case 6:r+=56/3}if(t){var a=this.points.filter((function(e){return e.visible})).length;this.scaleBgWithAnim=this.scene.tweens.addCounter({from:this.background.displayWidth,to:r,duration:200,onStart:function(){a>e&&i.showPoints(e)},onUpdate:function(e){i.background.setSizeByWorld(e.getValue(),i.height),i.setSize(i.background.displayWidth,i.height),i.pointContainer.x=100-e.getValue()},onComplete:function(){a<e&&i.showPoints(e)}})}else this.background.setSizeByWorld(r,this.height),this.setSize(r,this.height),this.showPoints(e),this.align(e)},n.align=function(e){this.points.forEach((function(e,t){e.setPosition(18*t,0)})),this.pointContainer.setX(17*-(e-1))},n.changeRewardItemsWithAnim=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.comboManager.streaks,null!=(n=this.exchangeItemAnimation)&&n.isPlaying()&&(this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItem.x,this.nextItem.y),this.exchangeItemAnimation.stop()),r=this.currentItem,this.currentItem=this.nextItem,this.nextItem=r,s=t+1>=i.length?0:t+1,o=this.getItemFrame(i[s].type),e.abrupt("return",this.runExchangeItemAnimation(o));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getWorldPositionOfCurrentItem=function(){return this.currentItem.getWorldPosition()},t}(Phaser.GameObjects.Container),Of=function(e){function t(t){var n;return(n=e.call(this,t)||this).radius=void 0,n.letterSpacing=void 0,n.font=void 0,n.fontSize=void 0,n.charOriginX=void 0,n.charOriginY=void 0,n.characters=void 0,n.characterPool=void 0,n.radius=0,n.letterSpacing=0,n.font=Rc.ZP.STYLE.KEY,n.fontSize=30,n.charOriginX=.5,n.charOriginY=.5,n.characters=[],n.characterPool=[],n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.getCharacters=function(){return this.characters},n.setText=function(e){this.createCharacters(e),this.updateCurve()},n.setRadius=function(e){this.radius=e,this.updateCurve()},n.setLetterSpacing=function(e){this.letterSpacing=e,this.updateCurve()},n.setFonts=function(e){this.font=e,this.characters.forEach((function(t){return t.setFont(e)})),this.updateCurve()},n.setFontSize=function(e){var t=this;this.fontSize=e,this.characters.forEach((function(n){return n.setFontSize(t.scene.fontSize(e))})),this.updateCurve()},n.setOrigin=function(e,t){this.charOriginX=e,this.charOriginY=t,this.characters.forEach((function(n){return n.setOrigin(e,t)})),this.updateCurve()},n.updateCurve=function(){if(0!==this.characters.length){var e=this.radius,t=this.letterSpacing,n=-t;this.characters.forEach((function(e){return n+=e.width+t}));for(var i=-n/2,r=0;r<this.characters.length;r++){var a=this.characters[r],s=i+a.width/2;if(0!==e){var o=Math.PI/2-s/e,c=e*Math.cos(o),h=e*Math.sin(o)-e;a.setPosition(c,h),a.setRotation(o-Math.PI/2)}else a.setPosition(s,0);i+=a.width+t}var u=this.characters[0].height;this.setSize(n,u)}else this.setSize(0,0)},n.createCharacters=function(e){var t=this;this.characters.forEach((function(e){return e.kill()})),this.characters=[],this.characters=e.split("").map((function(e){var n=t.spawnChar();return n.revive(),n.setText(e),n.setOrigin(t.charOriginX,t.charOriginY),n.setFontSize(t.scene.fontSize(t.fontSize)),n.setFont(t.font),n.setScale(1),n}))},n.spawnChar=function(){return this.characterPool.find((function(e){return!e.active}))||this.createCharacter()},n.createCharacter=function(){var e=this.scene.make.bitmapText({font:this.font,origin:{x:.5,y:.5}});return this.characterPool.push(e),this.add(e),e},t}(Phaser.GameObjects.Container),Rf=Of,Bf=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0;var i=1/GameCore.ImageScale;return n.scaleStart=Phaser.Math.FloatBetween(.5*i,i),n}(0,f.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.scaleX=this.lifeT*this.scaleStart,this.scaleY=this.lifeT*this.scaleStart,this.updateVelocity(),r},n.updateVelocity=function(){this.velocityX*=.985,this.velocityY*=.985},t}(Phaser.GameObjects.Particles.Particle),Df=Bf,Lf=Ki.Z.DEFAULT,Mf=Lf.KEY,_f=Lf.FRAME,Nf=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).curveText=void 0,i.starParticleManager=void 0,i.starEmitter=void 0,i.entranceAnim=void 0,i.exitAnim=void 0,i.createStarParticle(),i.createCurveText(n),i}(0,f.Z)(t,e);var n=t.prototype;return n.startComboAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),this.createTextEntranceAnimation(),this.createTextExitAnimation(),e.next=5,this.entranceAnim.playAndWaitForCompletion();case 5:return e.next=7,this.exitAnim.playAndWaitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),this.stop(),this.setAlpha(1),this.createTextEntranceAnimation(t),e.next=6,this.entranceAnim.playAndWaitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),this.createTextExitAnimation(),e.next=4,this.exitAnim.playAndWaitForCompletion();case 4:this.setAlpha(0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.stop=function(){var e,t;this.starEmitter.stop(),null==(e=this.entranceAnim)||e.stop(),null==(t=this.exitAnim)||t.stop()},n.setText=function(e){this.curveText.setText(e)},n.createTextExitAnimation=function(){for(var e=0,t=this.curveText.getCharacters(),n=this.scene.tweens.createTimeline(),i=0;i<t.length;i++){var r=t[i];n.add({targets:r,scale:{value:.9},duration:200,ease:Phaser.Math.Easing.Sine.InOut,offset:e}),n.add({targets:r,scale:{value:1.15},duration:400,ease:Phaser.Math.Easing.Sine.InOut,offset:e+200}),n.add({targets:r,alpha:0,duration:250,offset:e+350}),e+=30}this.exitAnim=n},n.createTextEntranceAnimation=function(e){void 0===e&&(e=!0);var t=this.curveText.getCharacters();t.forEach((function(e){e.setScale(.5),e.setAlpha(0)}));for(var n=this.scene.tweens.createTimeline({}),i=function(e){var i=t[e],r=60*e;n.add({targets:i,props:{scale:{value:1,ease:Phaser.Math.Easing.Sine.Out},alpha:1},duration:100,offset:r,onStart:function(){t.length}}),n.add({targets:i,scale:{value:1.15},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:r+100}),n.add({targets:i,scale:{value:.95},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:r+250}),n.add({targets:i,scale:{value:1.025},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:r+400})},r=0;r<t.length;r++)i(r);this.entranceAnim=n},n.emitStars=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.starEmitter.start(),e.next=3,(0,gl.Z)(this.scene,450);case 3:this.starEmitter.stop();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createStarParticle=function(){this.starParticleManager=this.scene.add.particles(Mf,_f.EFFECTS.STAR_1),this.starEmitter=this.starParticleManager.createEmitter({on:!1,lifespan:{min:1200,max:2e3},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},frequency:20,scale:0,rotate:{start:0,end:180,random:!1},tint:16579179,speedX:{min:-120,max:120},speedY:{min:-80,max:80},particleClass:Df}),this.add(this.starParticleManager)},n.createCurveText=function(e){this.curveText=new Rf(this.scene),this.curveText.setText(e),this.add(this.curveText)},t}(Phaser.GameObjects.Container),Gf=Nf,Ff=Ki.Z.DEFAULT,Zf=Ff.KEY,Uf=Ff.FRAME,Wf=["wellDone","super","goodJob","fantastic"],Yf=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.index=void 0,n.complimentTextsData=void 0,n.curveTextAnimation=void 0,n.glow=void 0,n.glow2=void 0,n.glowTween=void 0,n.glowTween2=void 0,n.scene=t;var i=n.scene.lang.Text;return n.complimentTextsData=[i.wellDone,i.super,i.goodJob,i.fantastic],n.create(),n.init(),n.scene.add.existing((0,yc.Z)(n)),n.kill(),n}(0,f.Z)(t,e);var n=t.prototype;return n.show=function(){var e,t;this.revive(),this.glow.setAlpha(0),this.glow2.setAlpha(0),this.glow.angle=0,this.glow2.angle=0,this.scene.tweens.add({targets:[this.glow,this.glow2],alpha:1,duration:500}),null==(e=this.glowTween)||e.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e3,repeat:-1,ease:Phaser.Math.Easing.Sine.Out,props:{angle:360}}),null==(t=this.glowTween2)||t.remove(),this.glowTween2=this.scene.tweens.add({targets:[this.glow2],duration:1e4,repeat:-1,ease:Phaser.Math.Easing.Sine.Out,props:{angle:360}}),this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.SHOW_COMPLIMENT),this.runTextPopUpAnimation()},n.init=function(){this.index=0},n.runTextPopUpAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.index+=1,this.index>=this.complimentTextsData.length&&(this.index=0),this.changeText(this.scene.lang.getText(Wf[this.index])),this.scene.tweens.add({targets:[this.glow,this.glow2],alpha:0,duration:500,delay:1200}),e.next=6,this.curveTextAnimation.startComboAnimation();case 6:this.kill(),null==(t=this.glowTween)||t.remove(),null==(n=this.glowTween2)||n.remove();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.changeText=function(e){this.curveTextAnimation.curveText.setText(e)},n.create=function(){this.index=0,this.setSize(200,50),this.setDepth(Ha.Z.EFFECT),this.createGlowEffect(),this.createGlow2Effect(),this.createCurveTextAnimation(),Phaser.Display.Align.In.Center(this,this.scene.gameZone)},n.createGlowEffect=function(){var e=this.scene.make.image({key:Zf,frame:Uf.EFFECTS.LEVEL_COMPLETE.GLOW_1,y:0});e.setWorldSize(141.9,141.6),this.add(e),this.glow=e},n.createGlow2Effect=function(){var e=this.scene.make.image({key:Zf,frame:Uf.EFFECTS.LEVEL_COMPLETE.GLOW_2,y:0});e.setWorldSize(115.5,114),this.add(e),this.glow2=e},n.createCurveTextAnimation=function(){var e=new Gf(this.scene,""),t=e.curveText;t.setFontSize(30),t.setOrigin(.5,.8),t.setPosition(0,8),t.setRadius(-600),t.setLetterSpacing(-1),this.add(e),this.curveTextAnimation=e},t}(Phaser.GameObjects.Container),Hf=Yf,zf=function(){function e(e,t){var n=this;this.scene=void 0,this.parent=void 0,this.comboTextAnimation=void 0,this.handleResize=function(){Phaser.Display.Align.In.Center(n.comboTextAnimation,n.scene.gameZone)},this.scene=e,this.parent=t,this.comboTextAnimation=new Hf(this.scene),this.scene.world.events.on(Va.Z.RESIZE,this.handleResize)}var t=e.prototype;return t.init=function(){this.comboTextAnimation.init()},t.reward=function(e,t){var n=this.parent.getRewardCoins()*t,i=this.parent.getRewardChestCoins()*t;switch(this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.REWARD_STREAK),this.comboTextAnimation.show(),e){case Hd.COIN:this.addCoins(n);break;case Hd.CHEST:this.addCoins(i);break;case Hd.CARD:var r=this.getCards(t);this.addCard(r);break;case Hd.WILD:var a=this.getWildCards(t);this.scene.logEconomy.logGetItem(yl.WILD_CARD,a.length,Cl.STREAK_REWARDS),this.scene.logEconomy.logUseItem(yl.WILD_CARD,a.length,Cl.STREAK_REWARDS),this.addCard(a)}},t.getCards=function(e){for(var t=this.scene.gameplay.boardGame,n=[],i=0;i<e;i++){var r=t.deck.getNewStockCard();r.behavior.setFrameCardDown(),n.push(r)}return n},t.getWildCards=function(e){for(var t=this.scene.gameplay.boardGame,n=[],i=0;i<e;i++){var r=t.deck.getJokerCard();n.push(r)}return n},t.addCoins=function(e){var t=this.scene.rewardManager,n=t.coinTextAnimationPool,i=t.coinAnimationPool,r=this.parent.streakBar.getItemPos(),a=r.x,s=r.y,o=this.scene.player.getCoins();t.setCoins(o+e,!1),n.runAnimation({coin:e,x:a,y:s+5,duration:1e3,delay:300,offsetY:-20}),i.runAnimationRewardCoinFromStreak(18),this.scene.logEconomy.logGetItem(yl.COIN,e,Cl.STREAK_REWARDS)},t.addCard=function(e){var t=this,n=this.scene.gameplay.boardGame,i=n.stock,r=0;this.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.REWARD_CARD),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),e.forEach((function(t,r){var a=i.getCardsLength(),s=e[r-1],o=Math.min(a,2),c=Math.min(a,6);if(s){var h=a-i.cards.indexOf(s);h-o>=2?c=Math.min(a,h-2):o=Math.min(a,h+2)}var u=a-Phaser.Math.Between(o,c);i.addCardAt(t,u),n.mover.addUndoCard(t,au.Combo,au.Stock)})),i.bringToTop(),e.sort((function(e,t){return i.cards.indexOf(e)>i.cards.indexOf(t)?-1:1})),e.forEach((function(e){var n=t.parent.streakBar.getItemPos(),i=n.x,a=n.y;e.setPosition(i+r,a);var s=Phaser.Math.Between(1e3,1200);t.runAddCardAnim(e,s),r+=5}))},t.runAddCardAnim=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.gameplay.boardGame,r=i.stock,s=i.stock.getPosition(t),t.setScale(.5),r.setLockedManual(!0),this.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.FLY_TO_STOCK),o=this.scene.tweens.createTimeline(),c=t.move({x:s.x,y:s.y,duration:n,delay:250,onComplete:function(){r.setLockedManual(!1),r.animateAlignCards()}}),o.add({targets:t,scale:.8,duration:250}),o.add({targets:t,scale:1.2,angle:-20,duration:n/2}),o.add({targets:t,scale:1,angle:0,duration:n/2}),h=o.playAndWaitForCompletion(),e.next=14,Promise.all([h,c]);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}(),Kf=zf,Vf=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.streakBar=void 0,n.streaks=void 0,n.randomTypes=void 0,n.index=void 0,n.enable=void 0,n.behavior=void 0,n.combo=void 0,n.soundPitch=void 0,n.rewardCoins=void 0,n.rewardChestCoins=void 0,n.playerRewards=void 0,n.rewarding=void 0,n.missComboCount=void 0,n.averageComboCount=void 0,n.updateStreakBar=function(){var e=n.getPlayerReward();if(!e)return n.rewarding=!1,n.streakBar.updateCombo(n.combo),void n.streakBar.updateComboLength(n.threshold,!0);n.rewarding=!0;var t=e.combo,i=e.rewardIndex,r=i+1>=n.streaks.length?0:i+1;n.streakBar.updateCombo(t),n.streakBar.updateComboLength(t.length,!0),n.streakBar.changeRewardItemsWithAnim(r).then(n.updateStreakBar),n.scene.vibration.performVibrating(50)},n.scene=t,n.missComboCount=0,n.averageComboCount=0,n.behavior=new Kf(n.scene,(0,yc.Z)(n)),n.streakBar=new If((0,yc.Z)(n),505/3,68/3),t.gameplayLayer.add(n.streakBar),n.init(),n.streakBar.updateCombo([]),n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.behavior.init(),this.enable=!0,this.index=0,this.soundPitch=0,this.combo=[],this.streaks=[],this.randomTypes=[],this.clearPlayerRewards();var t=vf.instance.reward.streak,n=t.coin,i=t.chest;this.setRewardCoin(n),this.setRewardChestCoin(i)},n.setStreak=function(e){var t=this,n=e.fixed;if(e.random.split("|").forEach((function(e){t.randomTypes.push(e)})),0===n.length){var i=this.getRandomStreak();this.streaks.push(i)}else n.forEach((function(e){var n=e.split("|"),i=n[0],r=parseInt(n[1]);t.streaks.push({type:i,threshold:r})}));var r=this.getRandomStreak();this.streaks.push(r),this.streakBar.reset()},n.setStreakIndex=function(e,t,n){this.index=e,this.streaks[e]={type:t,threshold:n},this.streakBar.updateRewardItems(e)},n.getStreakIndex=function(){return this.index},n.getCombo=function(){return[].concat(this.combo)},n.getComboHeight=function(){return this.soundPitch.valueOf()},n.reset=function(){this.combo.length>0&&(this.averageComboCount=(this.averageComboCount*this.missComboCount+this.combo.length)/(this.missComboCount+1),this.missComboCount+=1),this.soundPitch=0,this.combo=[],this.streakBar.updateCombo([])},n.setEnable=function(e){this.enable=e},n.setCombo=function(e,t){this.combo=e,this.soundPitch=t,0==this.isRewarding()&&this.streakBar.updateCombo(e)},n.setRewardCoin=function(e){this.rewardCoins=e},n.setRewardChestCoin=function(e){this.rewardChestCoins=e},n.getRewardCoins=function(){return this.rewardCoins},n.getRewardChestCoins=function(){return this.rewardChestCoins},n.isPlayerRewarded=function(){return this.combo.length>=this.threshold},n.isLastComboForStreak=function(){return this.combo.length+1===this.threshold},n.increaseComboWithSound=function(e){this.soundPitch=Math.min(this.soundPitch+1,12),this.increaseCombo(e),this.playIncreaseComboSound()},n.increaseCombo=function(e){if(this.enable){var t=e.behavior.isRed();this.setCombo([].concat(this.combo,[t]),this.soundPitch),this.streakBar.runLastPointPopUpAnimation(),this.isPlayerRewarded()&&this.handlePlayerReward()}},n.playIncreaseComboSound=function(){this.scene.audio.playAudioSprite(Hc.Z.CARD_COMBO.KEY,"n_card_"+this.soundPitch)},n.isSameColor=function(e){var t=e[0];return void 0!=t&&!e.some((function(e){return e!==t}))},n.isRewarding=function(){return this.rewarding},n.clearPlayerRewards=function(){this.playerRewards=[],this.rewarding=!1},n.addPlayerReward=function(e,t){this.playerRewards.push({combo:e,rewardIndex:t})},n.getPlayerReward=function(){return this.playerRewards.shift()},n.handlePlayerReward=function(){var e=this.streaks[this.index].type,t=[].concat(this.combo);this.combo=[],this.isSameColor(t)?this.behavior.reward(e,2):this.behavior.reward(e,1),this.scene.gameplay.boardGame.increaseStreakCount(),this.addPlayerReward(t,this.index);var n=this.getRandomStreak();this.streaks[this.index]=n,this.index=this.index+1>=this.streaks.length?0:this.index+1,0==this.isRewarding()&&this.updateStreakBar()},n.resetLog=function(){this.averageComboCount=0,this.missComboCount=0},n.getAverageComboCount=function(){return this.averageComboCount},n.getRandomStreak=function(){var e=Phaser.Utils.Array.GetRandom(this.randomTypes),t=Phaser.Math.Between(4,6);switch(e){case Hd.CARD:t=5;break;case Hd.WILD:t=6}return{type:e,threshold:t}},(0,X.Z)(t,[{key:"threshold",get:function(){return this.streaks[this.index].threshold}}]),t}(Pp),Xf=Vf,jf=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.multiplier=void 0,this.isEventHappening=void 0,this.totalScoreOnEvent=void 0,this.collectedScores=void 0,this.collectedCards=void 0,this.scorePerCard=void 0,this.scene=e,this.eventManager=t,this.multiplier=1.5,this.isEventHappening=!1}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.boxingDuel.isHappening()&&(this.isEventHappening=!0),this.totalScoreOnEvent=Math.floor(this.eventManager.totalCards*this.multiplier)},t.handleCollectCard=function(){return this.scorePerCard=0,this.isEventHappening&&(this.scorePerCard=this.generateRandomPointsForCards(),this.collectedScores+=this.scorePerCard),{active:this.isEventHappening,scorePerCard:this.scorePerCard}},t.handleUndo=function(e){this.collectedScores-=e,this.collectedCards--},t.generateRandomPointsForCards=function(){this.totalScoreOnEvent=Math.round(this.eventManager.totalCards*this.multiplier);var e=this.totalScoreOnEvent-this.collectedScores,t=this.eventManager.totalCards-this.collectedCards;if(t<=0)throw new Error("No remaining cards to distribute points to.");var n=e/t,i=Math.ceil(n);return this.collectedCards++,Math.round(Phaser.Math.Between(1,i))},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0,this.collectedCards=0},e}(),qf=jf,Jf=function(e){return e[e.BOXING_DUEL=0]="BOXING_DUEL",e[e.WEEKLY_TOURNAMENT=1]="WEEKLY_TOURNAMENT",e[e.RACE=2]="RACE",e}(Jf||{}),Qf={WEEKLY_TOURNAMENT:"weekly_tournament",BOXING_DUEL:"boxing_duel",OFFSHORE_RACE:"offshore-race"},$f=Ki.Z.GAMEPLAY_OBJECTS,em=$f.KEY,tm=$f.FRAME,nm=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).value=void 0,i.scene=t,i.createIcon(n),i.createValue(),i.alignItems(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.setScorePerCard=function(e){this.value.setText("+"+e)},n.alignItems=function(){Phaser.Display.Align.In.BottomRight(this.value,this,3,2)},n.createIcon=function(e){var t=e===Jf.BOXING_DUEL?tm.BLUE_GLOVE:tm.CUP,n=this.scene.add.image(0,0,em,t);n.setDefaultWorldSize(),n.setDepth(Ha.Z.PRIORITY),this.add(n),this.setSize(n.width,n.height)},n.createValue=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(14),text:"+1",origin:{x:.5,y:.5}});this.add(e),this.value=e},t}(Phaser.GameObjects.Container),im=nm,rm=function(){function e(e){this.scene=void 0,this.totalEvents=[],this.glovePool=[],this.cupPool=[],this.scene=e}var t=e.prototype;return t.runAnimation=function(e,t){var n=this;t.forEach((function(t){return n.runEventAnimation(t.eventType,t.scorePerCard,e)}))},t.runEventAnimation=function(e,t,n){var i,r,a=n.x,s=n.y;switch(e){case Jf.BOXING_DUEL:i=this.getGlove(),r=s-(this.totalEvents.length-1)/2*35;break;case Jf.WEEKLY_TOURNAMENT:i=this.getCup(),r=s+(this.totalEvents.length-1)/2*35;break;default:return}i.setPosition(a+20,r),i.setScorePerCard(t),this.runEventAnimationWithItem(i)},t.runEventAnimationWithItem=function(e){var t=this;e.setDepth(Ha.Z.PRIORITY),e.revive(),e.setAlpha(1),e.setScale(0),this.scene.add.tween({targets:e,scale:{from:0,to:1},duration:300,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.scene.add.tween({targets:e,scale:{from:1,to:.8},delay:200,duration:1500,ease:Phaser.Math.Easing.Sine.In})}}),this.scene.add.tween({targets:e,y:{from:e.y,to:e.y-50},alpha:{from:1,to:0,delay:300},delay:250,duration:1e3,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){e.kill(),t.scene.tweens.killTweensOf(e)}})},t.getGlove=function(){return this.getEventItem(this.glovePool,Jf.BOXING_DUEL)},t.getCup=function(){return this.getEventItem(this.cupPool,Jf.WEEKLY_TOURNAMENT)},t.getEventItem=function(e,t){var n=e.find((function(e){return!e.active}));return n||((n=new im(this.scene,t)).kill(),e.push(n)),n},e}(),am=rm,sm=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.collectedScores=void 0,this.isEventHappening=void 0,this.scene=e,this.eventManager=t}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.offshoreRace.isHappening()&&(this.isEventHappening=!0),this.collectedScores=1},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0},e}(),om=sm,cm=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.multiplier=void 0,this.isEventHappening=void 0,this.totalScoreOnEvent=void 0,this.collectedScores=void 0,this.collectedCards=void 0,this.scorePerCard=void 0,this.scene=e,this.eventManager=t,this.multiplier=1,this.isEventHappening=!1}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.weeklyTournament.isPlayingTournament()&&(this.isEventHappening=!0),this.totalScoreOnEvent=Math.floor(this.eventManager.totalCards*this.multiplier)},t.handleCollectCard=function(){return this.scorePerCard=0,this.isEventHappening&&(this.scorePerCard=this.generateRandomPointsForCards(),this.collectedScores+=this.scorePerCard),{active:this.isEventHappening,scorePerCard:this.scorePerCard}},t.handleUndo=function(e){this.collectedScores-=e,this.collectedCards--},t.generateRandomPointsForCards=function(){this.totalScoreOnEvent=Math.round(this.eventManager.totalCards*this.multiplier);var e=this.totalScoreOnEvent-this.collectedScores,t=this.eventManager.totalCards-this.collectedCards;if(t<=0)throw new Error("No remaining cards to distribute points to.");var n=e/t,i=Math.ceil(n);return this.collectedCards++,Math.round(Phaser.Math.Between(1,i))},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0,this.collectedCards=0},e}(),hm=cm;function um(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return lm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lm(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var dm=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.eventAnimator=void 0,n.boxingDuelEvent=void 0,n.weeklyTournamentEvent=void 0,n.offshoreRaceEvent=void 0,n.totalCards=void 0,n.eventStepsData=[],n.handleCollectCard=function(e){var t=[];n.isCardTypeValidToAddScore(e.behavior.type)||e.behavior.type!==nu.BOOM&&e.behavior.type!==nu.CHANGER||n.totalCards++;var i=n.boxingDuelEvent.handleCollectCard(),r=n.weeklyTournamentEvent.handleCollectCard();i.active&&t.push({eventType:Jf.BOXING_DUEL,scorePerCard:i.scorePerCard}),r.active&&t.push({eventType:Jf.WEEKLY_TOURNAMENT,scorePerCard:r.scorePerCard}),n.eventAnimator.runAnimation(e,t);var a={step:n.scene.gameplay.boardGame.mover.moves,items:{boxingDuel:i.scorePerCard,weeklyTournament:r.scorePerCard}};n.eventStepsData.push(a)},n.handleUndo=function(){var e=n.scene.gameplay.boardGame.mover.moves,t=n.eventStepsData.filter((function(t){return t.step===e}));if(n.eventStepsData=n.eventStepsData.filter((function(t){return t.step!==e})),0!==t.length)for(var i,r=um(t);!(i=r()).done;){var a=i.value;n.boxingDuelEvent.handleUndo(a.items.boxingDuel),n.weeklyTournamentEvent.handleUndo(a.items.weeklyTournament)}},n.scene=t,n.createEventAnimator(),n.createEvents(),n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.stop(),this.scene.events.on(Iu.Z.COLLECT_CARD,this.handleCollectCard,this),this.scene.events.on(Iu.Z.UNDO,this.handleUndo,this)},n.setup=function(e){var t=this;this.totalCards=e.filter((function(e){return t.isCardTypeValidToAddScore(e.type)})).length},n.isCardTypeValidToAddScore=function(e){return![nu.KEY,nu.LOCK,nu.JOKER,nu.BOOM,nu.CHANGER,nu.PLUS_FIVE,nu.PLUS_FOUR,nu.PLUS_THREE,nu.PLUS_TWO,nu.PLUS_ONE,nu.WINDMILL,nu.MYSTERIOUS,nu.TREASURE,nu.SQUIRREL].includes(e)},n.stop=function(){this.scene.events.off(Iu.Z.COLLECT_CARD,this.handleCollectCard,this),this.scene.events.off(Iu.Z.UNDO,this.handleUndo,this)},n.start=function(){this.boxingDuelEvent.initEvent(),this.weeklyTournamentEvent.initEvent(),this.offshoreRaceEvent.initEvent()},n.createEventAnimator=function(){this.eventAnimator=new am(this.scene)},n.createEvents=function(){var e=this;Object.values(Qf).forEach((function(t){switch(t){case Qf.WEEKLY_TOURNAMENT:e.weeklyTournamentEvent=new hm(e.scene,e);break;case Qf.BOXING_DUEL:e.boxingDuelEvent=new qf(e.scene,e);break;case Qf.OFFSHORE_RACE:e.offshoreRaceEvent=new om(e.scene,e)}}))},n.getBoxingDuelItemAmount=function(){return this.boxingDuelEvent.getEventItemAmount()},n.getWeeklyTournamentItemAmount=function(){return this.weeklyTournamentEvent.getEventItemAmount()},n.getRaceItemAmount=function(){return this.offshoreRaceEvent.getEventItemAmount()},n.hasAtLeastOneEventRunning=function(){return this.boxingDuelEvent.getEventItemAmount()>0||this.weeklyTournamentEvent.getEventItemAmount()>0||this.offshoreRaceEvent.getEventItemAmount()>0},n.getCurrentEventItems=function(){return{boxingDuel:this.getBoxingDuelItemAmount(),weeklyTournament:this.getWeeklyTournamentItemAmount(),offshoreRace:this.getRaceItemAmount()}},n.resetEventItemAmount=function(){this.boxingDuelEvent.resetEventItemAmount(),this.weeklyTournamentEvent.resetEventItemAmount(),this.offshoreRaceEvent.resetEventItemAmount()},t}(Pp),pm=dm,fm=Ki.Z.GAMEPLAY_DEFAULT,mm=fm.KEY,gm=fm.FRAME,vm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).text=void 0,r.icon=void 0,r.bg=void 0,r.shadow=void 0,r.create(),r}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e,t){switch(this.text.setText(e),t){case cu.CENTER:this.text.setOrigin(.5,.5),this.text.setCenterAlign();break;case cu.LEFT:this.text.setOrigin(0,.5),this.text.setLeftAlign();break;case cu.RIGHT:this.text.setOrigin(1,.5),this.text.setRightAlign()}},n.updateIcon=function(e,t,n){this.icon.setTexture(e,t),this.icon.setDefaultWorldSize(),this.icon.setVisible(n)},n.create=function(){var e=this.scene.add.image(0,0,mm,gm.TUTORIAL.TEXT_BOX);e.setDefaultWorldSize();var t=this.scene.make.nineslice({key:Ki.Z.DEFAULT.KEY,frame:Ki.Z.DEFAULT.FRAME.POPUP_CONTENT,leftWidth:15,rightWidth:15,topHeight:15,bottomHeight:15,width:235,height:70});this.setSize(t.width,t.height);var n=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:this.scene.lang.Text.tipPlayWildCard});n.setCenterAlign();var i=this.scene.add.image(0,0,mm,gm.TUTORIAL.ARROW_DOWN);i.setDefaultWorldSize(),this.add([e,t,n,i]),Phaser.Display.Align.In.Center(i,this,0,-80),this.shadow=e,this.bg=t,this.text=n,this.icon=i},t}(Phaser.GameObjects.Container),ym=vm,Em=Ki.Z.GAMEPLAY_DEFAULT,Cm=Em.KEY,wm=Em.FRAME,Am=function(e){function t(t){var n;return(n=e.call(this,t,0,0,Cm,wm.TUTORIAL.HIGHLIGHT_CIRCLE)||this).topBg=void 0,n.bottomBg=void 0,n.leftBg=void 0,n.rightBg=void 0,n.setCircleInteractive(),n.createBackground(),n.setPosition(0,0),n.scene.events.on("postupdate",n.postUpdate,(0,yc.Z)(n)),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.postUpdate=function(){this.updateBg()},n.setDepth=function(t){var n,i,r,a;return e.prototype.setDepth.call(this,t),null==(n=this.topBg)||n.setDepth(t),null==(i=this.bottomBg)||i.setDepth(t),null==(r=this.leftBg)||r.setDepth(t),null==(a=this.rightBg)||a.setDepth(t),this},n.setAlpha=function(t,n,i,r){return e.prototype.setAlpha.call(this,t,n,i,r),this.topBg.setAlpha(t,n,i,r),this.bottomBg.setAlpha(t,n,i,r),this.leftBg.setAlpha(t,n,i,r),this.rightBg.setAlpha(t,n,i,r),this},n.setTint=function(t,n,i,r){return e.prototype.setTint.call(this,t,n,i,r),this.topBg.setTint(t,n,i,r),this.bottomBg.setTint(t,n,i,r),this.leftBg.setTint(t,n,i,r),this.rightBg.setTint(t,n,i,r),this},n.kill=function(){var t,n,i,r;e.prototype.kill.call(this),null==(t=this.topBg)||t.kill(),null==(n=this.bottomBg)||n.kill(),null==(i=this.leftBg)||i.kill(),null==(r=this.rightBg)||r.kill()},n.revive=function(){var t,n,i,r;e.prototype.revive.call(this),null==(t=this.topBg)||t.revive(),null==(n=this.bottomBg)||n.revive(),null==(i=this.leftBg)||i.revive(),null==(r=this.rightBg)||r.revive()},n.updateBg=function(){if(this.topBg&&this.active){var e=this.x,t=this.y,n=this.alpha,i=this.displayHeight,r=this.displayWidth,a=this.scene.world.getWorldSize(),s=a.width,o=a.height;this.topBg.setAlpha(n),this.bottomBg.setAlpha(n),this.leftBg.setAlpha(n),this.rightBg.setAlpha(n);var c=t-i/2,h=e-r/2,u=o-t-i/2,l=s-e-r/2;this.topBg.setWorldSize(s,c),this.bottomBg.setWorldSize(s,u),this.leftBg.setWorldSize(h,i),this.rightBg.setWorldSize(l,i),c<=0?this.topBg.kill():this.topBg.revive(),u<=0?this.bottomBg.kill():this.bottomBg.revive(),h<=0?this.leftBg.kill():this.leftBg.revive(),l<=0?this.rightBg.kill():this.rightBg.revive(),this.topBg.setX(s/2),this.topBg.setY(t-i/2-c/2),this.bottomBg.setX(s/2),this.bottomBg.setY(t+i/2+u/2),this.leftBg.setY(t),this.leftBg.setX(e-r/2-h/2),this.rightBg.setY(t),this.rightBg.setX(e+r/2+l/2)}},n.createBackground=function(){this.topBg=this.scene.add.image(0,0,Cm,wm.TUTORIAL.BLACK_BG),this.bottomBg=this.scene.add.image(0,0,Cm,wm.TUTORIAL.BLACK_BG),this.leftBg=this.scene.add.image(0,0,Cm,wm.TUTORIAL.BLACK_BG),this.rightBg=this.scene.add.image(0,0,Cm,wm.TUTORIAL.BLACK_BG),this.topBg.setInteractive(),this.bottomBg.setInteractive(),this.leftBg.setInteractive(),this.rightBg.setInteractive()},n.setCircleInteractive=function(){this.setInteractive({pixelPerfect:!0})},t}(Phaser.GameObjects.Image),bm=Am,Sm=Ki.Z.GAMEPLAY_DEFAULT,Tm=Sm.KEY,xm=Sm.FRAME,km=function(e){function t(t){var n;return(n=e.call(this,t)||this).hand=void 0,n.handScaleDefault=1,n.toggleAnimation=void 0,n.tapAnimation=void 0,n.isTapping=void 0,n.timeToTap=void 0,n.remainTimeToTap=void 0,n.test=void 0,n.name="TutorialHand",n.addHand(),n.isTapping=!1,n.timeToTap=1e3,n.remainTimeToTap=0,n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.update=function(e){this.isTapping&&this.timeToTap>=0&&(this.remainTimeToTap+=e,this.remainTimeToTap>=this.timeToTap&&(this.timeToTap=-1,this.doubleTap()))},n.setTappingTime=function(e){this.timeToTap=e,this.remainTimeToTap=0},n.runTap=function(){this.isTapping=!0,this.setTappingTime(0)},n.stopTap=function(){var e;null==(e=this.tapAnimation)||e.remove(),this.hand.setDefaultWorldSize(),this.hand.setAngle(0),this.hide(),this.timeToTap=-1,this.isTapping=!1},n.addHand=function(){this.hand=this.scene.make.image({key:Tm,frame:xm.TUTORIAL.HAND,origin:{x:.5,y:.5}}),this.hand.setDefaultWorldSize(),this.handScaleDefault=this.hand.scale,this.resetHandPosition(),this.setSize(this.hand.width,this.hand.height),this.add(this.hand)},n.doubleTap=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1/GameCore.ImageScale,null==(n=this.tapAnimation)||n.remove(),this.show(),this.hand.setAngle(0),this.tapAnimation=this.scene.tweens.add({targets:[this.hand],ease:Phaser.Math.Easing.Cubic.InOut,props:{scale:{from:i,to:.85*i,duration:300,ease:Phaser.Math.Easing.Cubic.InOut},angle:{start:0,from:0,value:-12,duration:300,ease:Phaser.Math.Easing.Cubic.InOut}},repeatDelay:500,repeat:1,yoyo:!0,onYoyo:function(){r.scene.audio.playAudioSprite(Hc.Z.GAMEPLAY.KEY,rc.Z.POP,{},!0)},onComplete:function(){t&&t(),r.hide(),r.setTappingTime(2e3)}}),e.next=7,this.tapAnimation.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.tapAndHold=function(e,t){this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:this.handScaleDefault,to:.8*this.handScaleDefault},angle:{from:0,value:-10,duration:200}},onComplete:t})},n.unHold=function(e,t,n){var i=this;this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:.8*this.handScaleDefault,to:this.handScaleDefault},angle:{from:-10,value:0,duration:200}},onComplete:function(){t&&i.hide(),n&&n()}})},n.show=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.toggleAnimation)||t.remove(),this.toggleAnimation=this.scene.tweens.add({targets:this,alpha:1,duration:350,ease:Phaser.Math.Easing.Cubic.InOut}),e.next=4,this.toggleAnimation.waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hide=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.toggleAnimation)||t.remove(),this.toggleAnimation=this.scene.tweens.add({targets:this,alpha:0,duration:350,ease:Phaser.Math.Easing.Cubic.InOut}),e.next=4,this.toggleAnimation.waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preDestroy=function(){this.scene.tweens.killTweensOf(this.hand)},n.kill=function(){e.prototype.kill.call(this),this.resetHandPosition()},n.setHandPositionOnDoubleClick=function(){this.hand.setPosition(26,14)},n.resetHandPosition=function(){this.hand.setPosition(26,22)},t}(Phaser.GameObjects.Container),Pm=km,Im=function(e){this.guideManager=void 0,this.boardGame=void 0,this.guideManager=e,this.boardGame=e.boardGame},Om=function(){function e(e,t,n){this.scene=void 0,this.boardGame=void 0,this.guideManager=void 0,this.isPlaying=void 0,this.time=void 0,this.remain=void 0,this.hintRunning=void 0,this.onDraw=function(){},this.onDrawStock=function(){},this.onUndo=function(){},this.scene=e,this.boardGame=n,this.guideManager=t,this.isPlaying=!1,this.time=0,this.remain=0,this.hintRunning=!1}var t=e.prototype;return t.resetHintArrow=function(){this.remain=0},t.setHintTime=function(e){this.time=e},t.runHint=function(){this.hintRunning=!0,this.remain=0},t.stopHint=function(){this.hintRunning=!1,this.remain=0},t.play=function(){this.isPlaying=!0,this.listenEvents()},t.stop=function(){this.isPlaying&&(this.isPlaying=!1,this.stopHint(),this.stopListenEvents())},t.listenEvents=function(){},t.stopListenEvents=function(){},t.update=function(e){var t=this.guideManager;if(this.hintRunning&&!t.arrow.visible&&!t.tutorialHand.visible&&(this.remain+=e,this.remain>=this.time)){var n=this.boardGame.hint,i=n.getPileMatchableCards(),r=n.getCardWithLongestChain(i);r&&0==r.isMoving&&this.guideManager.showHandAnimation(r.x,r.y),this.resetHintArrow()}},t.showUndoGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.undoBtn.getWorldPosition(),i=n.x,r=n.y;this.guideManager.showHandAnimation(i,r-10);var a=GameCore.layoutInitializer.isLandscape?this.scene.lang.Text.guideUndo:this.scene.lang.Text.guideUndoPortrait;this.guideManager.showGuide({x:i,y:r,showHighlight:!0,textBox:{textX:i-50,textY:r-100,text:a,textAlignType:cu.RIGHT},icon:{iconX:i-17,iconY:r-70,iconDirection:_g.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(tu.UNDO,(function(){t.guideManager.hideGuide(),e&&e()}))},e}(),Rm=Om,Bm={SLICE:"guideSliceBooster",STORM:"guideStormBooster",WILD_CARD:"guideWildCardBooster"},Dm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this);var t=this.scene.gameplay.boosterManager,n=this.scene.level.getLevel(),i=this.scene.gameSettings.requiredLevels,r=i.boosterSlice,a=i.boosterStorm,s=i.boosterWildCard,o=this.guideManager,c=o.guideContainer,h=o.tutorialHand,u=o.highLightCircle,l=o.zone;this.showGuideCounting=0,u.setDepth(Ha.Z.PRIORITY),h.setDepth(Ha.Z.PRIORITY),c.setDepth(Ha.Z.PRIORITY),l.setDepth(Ha.Z.PRIORITY);var d=t.getAmountBoosters();switch(n){case r:return void(d.slice<=0&&t.increaseBoosterAmount(ji.SLICE,1));case a:return t.stormBooster.setShouldChoosePosForGuide(!0),void(d.storm<=0&&t.increaseBoosterAmount(ji.STORM,1));case s:return void(d.wildCard<=0&&t.increaseBoosterAmount(ji.WILD_CARD,1))}},n.stop=function(){if(this.isPlaying){this.guideManager.hideGuide();var t=this.guideManager,n=t.guideContainer,i=t.tutorialHand,r=t.highLightCircle,a=t.zone;r.setDepth(Ha.Z.GUIDE),i.setDepth(Ha.Z.GUIDE),n.setDepth(Ha.Z.GUIDE),a.setDepth(Ha.Z.GUIDE)}e.prototype.stop.call(this)},n.showBoosterGuide=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l,d,p,f=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.showGuideCounting>0)){e.next=2;break}return e.abrupt("return");case 2:return r=t.getWorldPosition(),s=r.x,o=r.y,c=n.getWorldPosition(),h=c.x,u=c.y,this.showGuideCounting+=1,l=this.guideManager.zone,d=this.scene.world.getWorldSize(),d.width,d.height,l.setVisible(!0),e.next=10,(0,gl.Z)(this.scene,300);case 10:this.guideManager.showHandAnimation(s,o),p=this.scene.lang.getText(Bm[i]),this.guideManager.showGuide({x:s,y:o+10,showHighlight:!0,textBox:{text:p,textX:s,textY:o-80,useBackground:!0,fontSize:15,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}}),this.scene.events.once(Iu.Z.BOOSTER_SELECTED,(function(){f.isPlaying&&(t.setDisabled(!0),t.setAlpha(1),f.guideManager.hideGuide().then((function(){return f.showHitPlayGuide(h,u)})))}));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.showHitPlayGuide=function(e,t){this.guideManager.showHandAnimation(e,t),this.guideManager.showGuide({x:e,y:t,showHighlight:!0,circleScaleX:1.6,circleScaleY:1,textBox:{textVisible:!1},icon:{iconVisible:!1}})},t}(Rm),Lm=Dm;function Mm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Nm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCount=void 0,r.onDraw=function(){var e=r.getCardToShow();e&&r.show(e)},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCount=0;var t=this.getCardToShow();t&&this.show(t)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.onDraw,this)},n.getCardToShow=function(){if(!(this.showGuideCount>0)){var e=this.boardGame,t=e.pile,n=e.waste.getOnTopCard();if(n)for(var i,r,a=function(){for(var e=r.value,i=t.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),a=0;a<i.length;a++){var s=t.checkOverlap(i[a]),o=t.isOverLap(i[a],e),c=t.isMatch(i[a],n);if(!s&&o&&c)return{v:i[a]}}},s=Mm(t.cards.filter((function(e){return e.isType(nu.KEY)})));!(r=s()).done;)if(i=a())return i.v}},n.show=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCount+=1,n=t.payload,i=n.x,r=n.y,this.guideManager.showHandAnimation(i,r),e.next=5,this.guideManager.showGuide({x:i,y:r,showHighlight:!0,textBox:{textX:i-10,textY:r+70,text:this.scene.lang.Text.guideLock,textAlignType:cu.CENTER},icon:{iconVisible:!1}});case 5:t.once(Iu.Z.MOVE_TO_WASTE,(function(){s.guideManager.hideGuide()}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Rm),Gm=Nm,Fm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).onDraw=function(){r.guideManager.hideHandAnimation(),r.setHintTime(2e3),r.resetHintArrow()},r.hideBackground=function(){r.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0).then((function(){r.guideManager.guideContainer.setDepth(Ha.Z.GAMEPLAY-1),r.scene.gameUI.coinBarButton.setDepth(Ha.Z.GAMEPLAY),r.scene.gameUI.levelTitle.setDepth(Ha.Z.GAMEPLAY)}))},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.scene.gameplay.setEnableCardInput(!1),this.runHint(),this.setHintTime(50),this.showHowToPlayGuide(),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground);var t=this.boardGame.waste.getOnTopCard();t&&t.moveToTopLayer(),this.scene.gameplay.setEnableCardInput(!0),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var n=this.boardGame.hint,i=n.getPileMatchableCards(),r=n.getCardWithLongestChain(i);r&&r.moveToTopLayer(),null==r||r.once(Iu.Z.MOVE_TO_WASTE,this.hideBackground)},n.stop=function(){this.isPlaying&&this.guideManager.guideContainer.setDepth(Ha.Z.GUIDE+1);e.prototype.stop.call(this)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this)},n.showHowToPlayGuide=function(){var e=this.scene.world.getWorldSize(),t=(e.width,e.height),n=this.guideManager,i=n.guideContainer,r=n.zone;i.setDepth(Ha.Z.GUIDE),this.guideManager.showGuide({x:0,y:0,circleScaleX:1,circleScaleY:1,showHighlight:!1,icon:{iconVisible:!1},textBox:{text:this.scene.lang.Text.guideOne,textX:200,textY:t/2+57,useBackground:!0,fontSize:15,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70}}),r.setVisible(!1)},n.update=function(t){e.prototype.update.call(this,t)},t}(Rm),Zm=Fm,Um=function(e){function t(t,n,r){var s;return(s=e.call(this,t,n,r)||this).onDraw=function(){s.canShowWildCardGuideNormal()&&s.showWildCardGuideNormal()},s.onDrawStock=function(){s.getHintCard()?s.guideManager.hideArrowAnimation():s.guideManager.arrow.visible||s.showWildCardGuideNormal()},s.onUndo=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.guideManager.arrow.visible&&s.guideManager.hideArrowAnimation(),s.canShowWildCardGuideNormal()&&s.showWildCardGuideNormal();case 2:case"end":return e.stop()}}),e)}))),s}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showWildCardGuide(this.scene.lang.Text.guideWildCard)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(tu.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(tu.UNDO,this.onUndo,this)},n.canShowWildCardGuideNormal=function(){return!this.guideManager.arrow.visible&&(!this.getHintCard()&&!(this.boardGame.pile.cards.length<=0))},n.getHintCard=function(){var e=this.boardGame.hint,t=e.getPileMatchableCards();return e.getCardWithLongestChain(t)},n.showWildCardGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),i=n.x,r=n.y;this.scene.gameplayLayer.setDepth(Ha.Z.GUIDE),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.boardGame.gameplay.coinUsingManager.wildCardWrapper),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var a=this.getHintCard();a&&this.scene.gameplayLayer.bringToTop(a);var s=this.boardGame.waste.getOnTopCard();s&&this.scene.gameplayLayer.bringToTop(s),this.guideManager.showHandAnimation(i,r),this.guideManager.showGuide({x:i,y:r,showHighlight:!1,textBox:{textX:i-150,textY:r-110,text:e,textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconX:i-17,iconY:r-85,iconDirection:_g.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(tu.DRAW_WILD_CARD,(function(){t.guideManager.hideGuide(),t.scene.gameplay.setEnableCardInput(!1),(0,gl.Z)(t.scene,900).then((function(){t.scene.gameplay.setEnableCardInput(!0),t.showValueCardGuide()}))}))},n.showWildCardGuideNormal=function(){var e=this,t=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),n=t.x,i=t.y;this.guideManager.showArrowAnimation(n,i-80),this.boardGame.stateMachine.once(tu.DRAW_WILD_CARD,(function(){e.guideManager.hideArrowAnimation()}))},n.showValueCardGuide=function(){var e=this,t=this.getHintCard();if(t){this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),t.moveToTopLayer();var n=this.boardGame.waste.getOnTopCard();n&&this.scene.gameplayLayer.bringToTop(n);var i=hu.CARD_VIEW,r=i.WIDTH,a=i.HEIGHT;this.guideManager.showHandAnimation(t.x+r/2-10,t.y+a/2-10),this.guideManager.showGuide({x:t.x,y:t.y,showHighlight:!1,textBox:{textX:t.x-135,textY:t.y+100,text:this.scene.lang.Text.guideWildCard2,textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70,boxWidth:165},icon:{iconX:t.x-65,iconY:t.y+35,iconDirection:_g.RIGHT}}),this.boardGame.stateMachine.once(tu.DRAW_PILE,(function(){e.guideManager.hideGuide(),e.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0),e.scene.gameplayLayer.setDepth(Ha.Z.GAMEPLAY)}))}},t}(Rm),Wm=Um,Ym=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).onDrawStock=function(){var e=r.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&r.showUndoGuide())},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showStreakGuide()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this)},n.showStreakGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.comboManager.streakBar.getWorldPosition(),n=t.x,i=t.y,e.next=3,this.guideManager.showGuide({x:0,y:0,circleScaleX:1.05,circleScaleY:1,showHighlight:!1,textBox:{textX:n-80,textY:i+70,text:this.scene.lang.Text.guideStreak,textAlignType:cu.CENTER},icon:{iconX:n-65,iconY:i+15,iconDirection:_g.RIGHT}});case 3:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.guideManager.hideGuide()}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Rm),Hm=Ym,zm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showStockGuideCounting=void 0,r.onDraw=function(){(r.resetHintArrow(),r.guideManager.hideHandAnimation(),r.showStockGuideCounting>0)||r.boardGame.hint.getPileMatchableCards().length<=0&&(r.showStockGuideCounting+=1,r.stopHint(),r.showStockGuide())},r.onUndo=function(){r.resetHintArrow(),r.guideManager.hideArrowAnimation()},r.onDrawStock=function(){r.resetHintArrow();var e=r.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&(r.stopHint(),r.showUndoGuide((function(){r.runHint()}))))},r.showStockGuideCounting=0,r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.runHint(),this.setHintTime(3e3),this.showStockGuideCounting=0},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.UNDO,this.onUndo,this)},n.update=function(t){e.prototype.update.call(this,t)},n.showStockGuide=function(){var e=this,t=this.boardGame.stock,n=t.x,i=t.y;this.guideManager.showHandAnimation(n,i),this.guideManager.showGuide({x:n,y:i,textBox:{textX:n+55,textY:i-105,text:this.scene.lang.Text.guideDrawStock,textAlignType:cu.LEFT},icon:{iconX:n+17,iconY:i-75,iconDirection:_g.DOWN},showHighlight:!0}),this.boardGame.stateMachine.once(tu.DRAW_STOCK,(function(){e.guideManager.hideGuide(),e.runHint()}))},t}(Rm),Km=zm,Vm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.onDraw=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame.waste.getOnTopCard();if(e){var t=r.boardGame.pile;t.cards.filter((function(e){return e.isMysterious})).some((function(n){for(var i=[],a=t.cards.filter((function(e){return e!==n&&e.active&&e.payload.depth>n.payload.depth})),s=0;s<a.length;s++)t.isOverLap(a[s],n)&&i.push(a[s]);if(1==i.length&&!t.checkOverlap(i[0])&&t.isMatch(i[0],e))return r.show(i[0]),!0}))}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.onDraw()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.onDraw,this)},n.show=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCounting+=1,n=t.payload,i=n.x,r=n.y,s=hu.CARD_VIEW,o=s.WIDTH,c=s.HEIGHT,this.guideManager.showHandAnimation(i+o/2-10,r+c/2-10),e.next=6,this.guideManager.showGuide({x:i,y:r+30,circleScaleX:1.5,circleScaleY:2.2,showHighlight:!0,textBox:{textX:i,textY:r+90,text:this.scene.lang.Text.guideMysteryCard,textAlignType:cu.CENTER},icon:{iconVisible:!1}});case 6:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){h.guideManager.hideGuide()}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Rm),Xm=Vm,jm=Ki.Z.GAMEPLAY_DEFAULT,qm=jm.KEY,Jm=jm.FRAME,Qm=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).leftArrow=void 0,r.rightArrow=void 0,r.createArrows(),r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(nu.CHAIN),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:if(r=i.behavior,s=r.connectedCard){e.next=9;break}return e.abrupt("return");case 9:return o=i,c=s,i.payload.x>s.payload.x&&(o=s,c=i),h=o.payload,u=h.x,l=h.y,d=c.payload,p=d.x,f=d.y,this.leftArrow.revive(),this.leftArrow.setAlpha(1),this.leftArrow.setPosition(u-47,l),this.rightArrow.revive(),this.rightArrow.setPosition(p+47,f),(m=this.scene.tweens.createTimeline()).add({targets:this.rightArrow,x:"-=12",duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.add({targets:this.leftArrow,x:"+=12",offset:0,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.play(),g=this.scene.world.getWorldSize(),v=g.width,y=g.height,e.next=26,this.guideManager.showGuide({x:v/2,y:y/2-20,circleScaleX:3.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:v/2,textY:y/2+50,text:this.scene.lang.Text.guideChainCard},icon:{iconVisible:!1}});case 26:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){E.guideManager.hideGuide(),E.leftArrow.kill(),E.rightArrow.kill(),m.stop()}));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createArrows=function(){var e=1/GameCore.ImageScale,t=this.scene.add.image(0,0,qm,Jm.ARROW);t.setScale(e,e),t.kill(),t.setDepth(Ha.Z.GUIDE),this.leftArrow=t;var n=this.scene.add.image(0,0,qm,Jm.ARROW);n.setScale(-e,e),n.kill(),n.setDepth(Ha.Z.GUIDE),this.rightArrow=n},t}(Rm),$m=Qm,eg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.show=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(nu.SQUIRREL)&&!t.checkOverlap(e)})),a=n.getOnTopCard();if(i&&a){var s=0;i.behavior instanceof ud&&(s=i.behavior.getRequiredUnlockNuts());var o=t.getCardsWithType(nu.CHESTNUT).filter((function(e){return t.isMatch(e,a)})),c=o[0];if(c&&c.behavior instanceof nd){r.showGuideCounting+=1;var h=c.behavior.nut.getWorldPosition(),u=h.x,l=h.y;r.guideManager.showGuide({x:u,y:l-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:u+110,textY:l+75,text:"Feed the Squirrel\nwith "+s+" Acorn cards!",textAlignType:cu.LEFT},icon:{iconX:u,iconY:l+50,iconDirection:_g.UP,flipX:!0}}),c.once(Iu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}))}}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.show,this)},t}(Rm),tg=eg,ng=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.show=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(nu.TREASURE)&&!t.checkOverlap(e)})),a=n.getOnTopCard();if(i&&a){i.behavior instanceof ql&&i.behavior.getMissingMapPieces();var s=t.getCardsWithType(nu.MAP_PIECE).filter((function(e){return t.isMatch(e,a)})),o=s[0];if(o&&o.behavior instanceof ed){r.showGuideCounting+=1;var c=o.behavior.getMapPieceWorldPosition(),h=c.x,u=c.y;r.guideManager.showGuide({x:h+15,y:u-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:h+125,textY:u+65,text:"To assemble the map,\nfind all the missing map pieces!",textAlignType:cu.LEFT},icon:{iconX:h,iconY:u+50,iconDirection:_g.UP,flipX:!0}}),o.once(Iu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}))}}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.show,this)},t}(Rm),ig=ng,rg=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(nu.CHANGER),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:return r=i.payload,s=r.x,o=r.y,e.next=8,this.guideManager.showGuide({x:0,y:0,showHighlight:!1,textBox:{text:this.scene.lang.Text.guideChangerCard,textX:s+50,textY:o-100,textAlignType:cu.LEFT},icon:{iconX:s+17,iconY:o-75,iconDirection:_g.DOWN}});case 8:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){c.guideManager.hideGuide()}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Rm),ag=rg,sg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.levelOneGuide=void 0,n.levelTwoGuide=void 0,n.levelThreeGuide=void 0,n.levelSixGuide=void 0,n.cheeseGuide=void 0,n.squirrelGuide=void 0,n.treasureMapGuide=void 0,n.valueChangerGuide=void 0,n.ropeGuide=void 0,n.mysteriousCardGuide=void 0,n.boosterGuide=void 0,n.playLevelOneGuide=function(){n.levelOneGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelOneGuide)},n.playLevelTwoGuide=function(){n.levelTwoGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelTwoGuide)},n.playLevelThreeGuide=function(){n.levelThreeGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelThreeGuide)},n.playLevelSixGuide=function(){n.levelSixGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelSixGuide)},n.playCheeseGuide=function(){n.cheeseGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopCheeseGuide)},n.playSquirrelGuide=function(){n.squirrelGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopSquirrelGuide)},n.playTreasureMapGuide=function(){n.treasureMapGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopTreasureMapGuide)},n.playValueChangerGuide=function(){n.valueChangerGuide.play(),n.boardGame.stateMachine.once(tu.DRAW_PILE,n.stopValueChangerGuide)},n.playRopeGuide=function(){n.ropeGuide.play(),n.boardGame.stateMachine.once(tu.DRAW_PILE,n.stopRopeGuide)},n.playMysteriousCardGuide=function(){n.mysteriousCardGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopMysteriousCardGuide)},n.playBoosterGuide=function(){n.boosterGuide.play(),n.boardGame.stateMachine.once(tu.START,n.stopBoosterGuide)},n.stopLevelOneGuide=function(){n.guideManager.stop(),n.levelOneGuide.stop()},n.stopLevelTwoGuide=function(){n.guideManager.stop(),n.levelTwoGuide.stop()},n.stopLevelThreeGuide=function(){n.guideManager.stop(),n.levelThreeGuide.stop()},n.stopLevelSixGuide=function(){n.guideManager.stop(),n.levelSixGuide.stop()},n.stopCheeseGuide=function(){n.guideManager.stop(),n.cheeseGuide.stop()},n.stopSquirrelGuide=function(){n.guideManager.stop(),n.squirrelGuide.stop()},n.stopTreasureMapGuide=function(){n.guideManager.stop(),n.treasureMapGuide.stop()},n.stopValueChangerGuide=function(){n.guideManager.stop(),n.valueChangerGuide.stop()},n.stopRopeGuide=function(){n.guideManager.stop(),n.ropeGuide.stop()},n.stopMysteriousCardGuide=function(){n.guideManager.stop(),n.mysteriousCardGuide.stop()},n.stopBoosterGuide=function(){n.guideManager.stop(),n.boosterGuide.stop()},n.scene=t.scene,n}(0,f.Z)(t,e);var n=t.prototype;return n.createGuides=function(){this.levelOneGuide=new Zm(this.scene,this.guideManager,this.boardGame),this.levelTwoGuide=new Km(this.scene,this.guideManager,this.boardGame),this.levelThreeGuide=new Hm(this.scene,this.guideManager,this.boardGame),this.levelSixGuide=new Wm(this.scene,this.guideManager,this.boardGame),this.cheeseGuide=new Gm(this.scene,this.guideManager,this.boardGame),this.squirrelGuide=new tg(this.scene,this.guideManager,this.boardGame),this.treasureMapGuide=new ig(this.scene,this.guideManager,this.boardGame),this.valueChangerGuide=new ag(this.scene,this.guideManager,this.boardGame),this.ropeGuide=new $m(this.scene,this.guideManager,this.boardGame),this.mysteriousCardGuide=new Xm(this.scene,this.guideManager,this.boardGame),this.boosterGuide=new Lm(this.scene,this.guideManager,this.boardGame)},n.stop=function(){this.levelOneGuide.stop(),this.levelTwoGuide.stop(),this.levelThreeGuide.stop(),this.levelSixGuide.stop(),this.cheeseGuide.stop(),this.squirrelGuide.stop(),this.treasureMapGuide.stop(),this.valueChangerGuide.stop(),this.ropeGuide.stop(),this.mysteriousCardGuide.stop(),this.boosterGuide.stop()},n.isLevelOneGuidePlaying=function(){return this.levelOneGuide.isPlaying},n.isLevelTwoGuidePlaying=function(){return this.levelTwoGuide.isPlaying},n.updateLevelOneGuide=function(e){this.levelOneGuide.update(e)},n.updateLevelTwoGuide=function(e){this.levelTwoGuide.update(e)},n.isBoosterGuidePlaying=function(){return this.boosterGuide.isPlaying},n.showBoosterGuide=function(e,t,n){return this.boosterGuide.showBoosterGuide(e,t,n)},t}(Im),og={SLICE:"guideSliceBooster",STORM:"guideStormBooster",WILD_CARD:"guideWildCardBooster"},cg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this);var t=this.scene.gameplay.boosterManager,n=this.scene.level.getLevel(),i=this.scene.gameSettings.requiredLevels,r=i.boosterSlice,a=i.boosterStorm,s=i.boosterWildCard,o=this.guideManager,c=o.guideContainer,h=o.tutorialHand,u=o.highLightCircle,l=o.zone;this.showGuideCounting=0,u.setDepth(Ha.Z.PRIORITY),h.setDepth(Ha.Z.PRIORITY),c.setDepth(Ha.Z.PRIORITY),l.setDepth(Ha.Z.PRIORITY);var d=t.getAmountBoosters();switch(n){case r:return void(d.slice<=0&&t.increaseBoosterAmount(ji.SLICE,1));case a:return t.stormBooster.setShouldChoosePosForGuide(!0),void(d.storm<=0&&t.increaseBoosterAmount(ji.STORM,1));case s:return void(d.wildCard<=0&&t.increaseBoosterAmount(ji.WILD_CARD,1))}},n.stop=function(){if(this.isPlaying){this.guideManager.hideGuide();var t=this.guideManager,n=t.guideContainer,i=t.tutorialHand,r=t.highLightCircle,a=t.zone;r.setDepth(Ha.Z.GUIDE),i.setDepth(Ha.Z.GUIDE),n.setDepth(Ha.Z.GUIDE),a.setDepth(Ha.Z.GUIDE)}e.prototype.stop.call(this)},n.showBoosterGuide=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l,d,p,f=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.showGuideCounting>0)){e.next=2;break}return e.abrupt("return");case 2:return r=t.getWorldPosition(),s=r.x,o=r.y,c=n.getWorldPosition(),h=c.x,u=c.y,this.showGuideCounting+=1,l=this.guideManager.zone,d=this.scene.world.getWorldSize(),d.width,d.height,l.setVisible(!0),e.next=10,(0,gl.Z)(this.scene,300);case 10:this.guideManager.showHandAnimation(s,o),p=this.scene.lang.getText(og[i]),this.guideManager.showGuide({x:s,y:o,showHighlight:!0,textBox:{text:p,textX:s,textY:o-90,useBackground:!0,fontSize:15,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}}),this.scene.events.once(Iu.Z.BOOSTER_SELECTED,(function(){f.isPlaying&&(t.setDisabled(!0),t.setAlpha(1),f.guideManager.hideGuide().then((function(){return f.showHitPlayGuide(h,u)})))}));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.showHitPlayGuide=function(e,t){this.guideManager.showHandAnimation(e,t),this.guideManager.showGuide({x:e,y:t,showHighlight:!0,circleScaleX:1.6,circleScaleY:1,textBox:{textVisible:!1},icon:{iconVisible:!1}})},t}(Rm),hg=cg;function ug(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return lg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lg(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var dg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCount=void 0,r.onDraw=function(){var e=r.getCardToShow();e&&r.show(e)},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCount=0;var t=this.getCardToShow();t&&this.show(t)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.onDraw,this)},n.getCardToShow=function(){if(!(this.showGuideCount>0)){var e=this.boardGame,t=e.pile,n=e.waste.getOnTopCard();if(n)for(var i,r,a=function(){for(var e=r.value,i=t.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),a=0;a<i.length;a++){var s=t.checkOverlap(i[a]),o=t.isOverLap(i[a],e),c=t.isMatch(i[a],n);if(!s&&o&&c)return{v:i[a]}}},s=ug(t.cards.filter((function(e){return e.isType(nu.KEY)})));!(r=s()).done;)if(i=a())return i.v}},n.show=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCount+=1,n=t.payload,i=n.x,r=n.y,this.guideManager.showHandAnimation(i,r),e.next=5,this.guideManager.showGuide({x:i,y:r,showHighlight:!0,textBox:{textX:i-10,textY:r+70,text:this.scene.lang.Text.guideLock,textAlignType:cu.CENTER},icon:{iconVisible:!1}});case 5:t.once(Iu.Z.MOVE_TO_WASTE,(function(){s.guideManager.hideGuide()}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Rm),pg=dg,fg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).onDraw=function(){r.guideManager.hideHandAnimation(),r.setHintTime(2e3),r.resetHintArrow()},r.hideBackground=function(){r.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0).then((function(){r.guideManager.guideContainer.setDepth(Ha.Z.GAMEPLAY-1),r.scene.gameUI.coinBarButton.setDepth(Ha.Z.GAMEPLAY),r.scene.gameUI.levelTitle.setDepth(Ha.Z.GAMEPLAY)}))},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.scene.gameplay.setEnableCardInput(!1),this.runHint(),this.setHintTime(50),this.showHowToPlayGuide(),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground);var t=this.boardGame.waste.getOnTopCard();t&&t.moveToTopLayer(),this.scene.gameplay.setEnableCardInput(!0),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var n=this.boardGame.hint,i=n.getPileMatchableCards(),r=n.getCardWithLongestChain(i);r&&r.moveToTopLayer(),null==r||r.once(Iu.Z.MOVE_TO_WASTE,this.hideBackground)},n.stop=function(){this.isPlaying&&this.guideManager.guideContainer.setDepth(Ha.Z.GUIDE+1);e.prototype.stop.call(this)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this)},n.showHowToPlayGuide=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.guideManager,r=i.guideContainer,a=i.zone;r.setDepth(Ha.Z.GUIDE),this.guideManager.showGuide({x:0,y:0,circleScaleX:1,circleScaleY:1,showHighlight:!1,icon:{iconVisible:!1},textBox:{text:this.scene.lang.Text.guideOne,textX:t/2,textY:n/2-200,useBackground:!0,fontSize:15,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70}}),a.setVisible(!1)},n.update=function(t){e.prototype.update.call(this,t)},t}(Rm),mg=fg,gg=function(e){function t(t,n,r){var s;return(s=e.call(this,t,n,r)||this).onDraw=function(){s.canShowWildCardGuideNormal()&&s.showWildCardGuideNormal()},s.onDrawStock=function(){s.getHintCard()?s.guideManager.hideArrowAnimation():s.guideManager.arrow.visible||s.showWildCardGuideNormal()},s.onUndo=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.guideManager.arrow.visible&&s.guideManager.hideArrowAnimation(),s.canShowWildCardGuideNormal()&&s.showWildCardGuideNormal();case 2:case"end":return e.stop()}}),e)}))),s}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showWildCardGuide(this.scene.lang.Text.guideWildCard)},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(tu.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(tu.UNDO,this.onUndo,this)},n.canShowWildCardGuideNormal=function(){return!this.guideManager.arrow.visible&&(!this.getHintCard()&&!(this.boardGame.pile.cards.length<=0))},n.getHintCard=function(){var e=this.boardGame.hint,t=e.getPileMatchableCards();return e.getCardWithLongestChain(t)},n.showWildCardGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),i=n.x,r=n.y;this.scene.gameplayLayer.setDepth(Ha.Z.GUIDE),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.boardGame.gameplay.coinUsingManager.wildCardWrapper),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var a=this.getHintCard();a&&this.scene.gameplayLayer.bringToTop(a);var s=this.boardGame.waste.getOnTopCard();s&&this.scene.gameplayLayer.bringToTop(s),this.guideManager.showHandAnimation(i,r),this.guideManager.showGuide({x:i,y:r,showHighlight:!1,textBox:{textX:i-150,textY:r-110,text:e,textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconX:i-17,iconY:r-85,iconDirection:_g.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(tu.DRAW_WILD_CARD,(function(){t.guideManager.hideGuide(),t.scene.gameplay.setEnableCardInput(!1),(0,gl.Z)(t.scene,900).then((function(){t.scene.gameplay.setEnableCardInput(!0),t.showValueCardGuide()}))}))},n.showWildCardGuideNormal=function(){var e=this,t=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),n=t.x,i=t.y;this.guideManager.showArrowAnimation(n,i-80),this.boardGame.stateMachine.once(tu.DRAW_WILD_CARD,(function(){e.guideManager.hideArrowAnimation()}))},n.showValueCardGuide=function(){var e=this,t=this.getHintCard();if(t){this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),t.moveToTopLayer();var n=this.boardGame.waste.getOnTopCard();n&&this.scene.gameplayLayer.bringToTop(n);var i=hu.CARD_VIEW,r=i.WIDTH,a=i.HEIGHT;this.guideManager.showHandAnimation(t.x+r/2-10,t.y+a/2-10),this.guideManager.showGuide({x:t.x,y:t.y,showHighlight:!1,textBox:{textX:t.x-65,textY:t.y+100,text:this.scene.lang.Text.guideWildCard2,textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70,boxWidth:165},icon:{iconX:t.x-65,iconY:t.y+35,iconDirection:_g.RIGHT}}),this.boardGame.stateMachine.once(tu.DRAW_PILE,(function(){e.guideManager.hideGuide(),e.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0),e.scene.gameplayLayer.setDepth(Ha.Z.GAMEPLAY)}))}},t}(Rm),vg=gg,yg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).onDrawStock=function(){var e=r.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&r.showUndoGuide())},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showStreakGuide()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this)},n.showStreakGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.comboManager.streakBar.getWorldPosition(),n=t.x,i=t.y,e.next=3,this.guideManager.showGuide({x:0,y:0,circleScaleX:1.05,circleScaleY:1,showHighlight:!1,textBox:{textX:n-80,textY:i+70,text:this.scene.lang.Text.guideStreak,textAlignType:cu.CENTER},icon:{iconX:n-65,iconY:i+15,iconDirection:_g.RIGHT}});case 3:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.guideManager.hideGuide()}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Rm),Eg=yg,Cg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showStockGuideCounting=void 0,r.onDraw=function(){(r.resetHintArrow(),r.guideManager.hideHandAnimation(),r.showStockGuideCounting>0)||r.boardGame.hint.getPileMatchableCards().length<=0&&(r.showStockGuideCounting+=1,r.stopHint(),r.showStockGuide())},r.onUndo=function(){r.resetHintArrow(),r.guideManager.hideArrowAnimation()},r.onDrawStock=function(){r.resetHintArrow();var e=r.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&(r.stopHint(),r.showUndoGuide((function(){r.runHint()}))))},r.showStockGuideCounting=0,r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.runHint(),this.setHintTime(3e3),this.showStockGuideCounting=0},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.UNDO,this.onUndo,this)},n.update=function(t){e.prototype.update.call(this,t)},n.showStockGuide=function(){var e=this,t=this.boardGame.stock,n=t.x,i=t.y;this.guideManager.showHandAnimation(n,i),this.guideManager.showGuide({x:n,y:i,textBox:{textX:n+55,textY:i-105,text:this.scene.lang.Text.guideDrawStockPortrait,textAlignType:cu.LEFT},icon:{iconX:n+17,iconY:i-75,iconDirection:_g.DOWN},showHighlight:!0}),this.boardGame.stateMachine.once(tu.DRAW_STOCK,(function(){e.guideManager.hideGuide(),e.runHint()}))},t}(Rm),wg=Cg,Ag=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.onDraw=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame.waste.getOnTopCard();if(e){var t=r.boardGame.pile;t.cards.filter((function(e){return e.isMysterious})).some((function(n){for(var i=[],a=t.cards.filter((function(e){return e!==n&&e.active&&e.payload.depth>n.payload.depth})),s=0;s<a.length;s++)t.isOverLap(a[s],n)&&i.push(a[s]);if(1==i.length&&!t.checkOverlap(i[0])&&t.isMatch(i[0],e))return r.show(i[0]),!0}))}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.onDraw()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.onDraw,this)},n.show=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCounting+=1,n=t.payload,i=n.x,r=n.y,s=hu.CARD_VIEW,o=s.WIDTH,c=s.HEIGHT,this.guideManager.showHandAnimation(i+o/2-10,r+c/2-10),e.next=6,this.guideManager.showGuide({x:i,y:r+30,circleScaleX:1.5,circleScaleY:2.2,showHighlight:!0,textBox:{textX:i,textY:r+90,text:this.scene.lang.Text.guideMysteryCard,textAlignType:cu.CENTER},icon:{iconVisible:!1}});case 6:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){h.guideManager.hideGuide()}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Rm),bg=Ag,Sg=Ki.Z.GAMEPLAY_DEFAULT,Tg=Sg.KEY,xg=Sg.FRAME,kg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).leftArrow=void 0,r.rightArrow=void 0,r.createArrows(),r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(nu.CHAIN),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:if(r=i.behavior,s=r.connectedCard){e.next=9;break}return e.abrupt("return");case 9:return o=i,c=s,i.payload.x>s.payload.x&&(o=s,c=i),h=o.payload,u=h.x,l=h.y,d=c.payload,p=d.x,f=d.y,this.leftArrow.revive(),this.leftArrow.setAlpha(1),this.leftArrow.setPosition(u-47,l),this.rightArrow.revive(),this.rightArrow.setPosition(p+47,f),(m=this.scene.tweens.createTimeline()).add({targets:this.rightArrow,x:"-=12",duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.add({targets:this.leftArrow,x:"+=12",offset:0,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.play(),g=this.scene.world.getWorldSize(),v=g.width,y=g.height,e.next=26,this.guideManager.showGuide({x:v/2,y:y/2,circleScaleX:3.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:v/2,textY:y/2+80,text:this.scene.lang.Text.guideChainCard,textAlignType:cu.CENTER},icon:{iconVisible:!1}});case 26:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){E.guideManager.hideGuide(),E.leftArrow.kill(),E.rightArrow.kill(),m.stop()}));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createArrows=function(){var e=1/GameCore.ImageScale,t=this.scene.add.image(0,0,Tg,xg.ARROW);t.setScale(e,e),t.kill(),t.setDepth(Ha.Z.GUIDE),this.leftArrow=t;var n=this.scene.add.image(0,0,Tg,xg.ARROW);n.setScale(-e,e),n.kill(),n.setDepth(Ha.Z.GUIDE),this.rightArrow=n},t}(Rm),Pg=kg,Ig=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.show=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(nu.SQUIRREL)&&!t.checkOverlap(e)})),a=n.getOnTopCard();if(i&&a){var s=0;i.behavior instanceof ud&&(s=i.behavior.getRequiredUnlockNuts());var o=t.getCardsWithType(nu.CHESTNUT).filter((function(e){return t.isMatch(e,a)})),c=o[0];if(c&&c.behavior instanceof nd){r.showGuideCounting+=1;var h=c.behavior.nut.getWorldPosition(),u=h.x,l=h.y;r.guideManager.showGuide({x:u,y:l-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:u+110,textY:l+75,text:"Feed the Squirrel\nwith "+s+" Acorn cards!",textAlignType:cu.LEFT},icon:{iconX:u,iconY:l+50,iconDirection:_g.UP,flipX:!0}}),c.once(Iu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}))}}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.show,this)},t}(Rm),Og=Ig,Rg=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).showGuideCounting=void 0,r.show=function(){if(!(r.showGuideCounting>0)){var e=r.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(nu.TREASURE)&&!t.checkOverlap(e)})),a=n.getOnTopCard();if(i&&a){i.behavior instanceof ql&&i.behavior.getMissingMapPieces();var s=t.getCardsWithType(nu.MAP_PIECE).filter((function(e){return t.isMatch(e,a)})),o=s[0];if(o&&o.behavior instanceof ed){r.showGuideCounting+=1;var c=o.behavior.getMapPieceWorldPosition(),h=c.x,u=c.y;r.guideManager.showGuide({x:h+15,y:u-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:h+125,textY:u+65,text:"To assemble the map,\nfind all the missing map pieces!",textAlignType:cu.LEFT},icon:{iconX:h,iconY:u+50,iconDirection:_g.UP,flipX:!0}}),o.once(Iu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}))}}}},r}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(tu.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(tu.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(tu.DRAW_WILD_CARD,this.show,this)},t}(Rm),Bg=Rg,Dg=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(nu.CHANGER),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:return r=i.payload,s=r.x,o=r.y,e.next=8,this.guideManager.showGuide({x:0,y:0,showHighlight:!1,textBox:{text:this.scene.lang.Text.guideChangerCard,textX:s-40,textY:o+100,textAlignType:cu.CENTER},icon:{iconX:s-55,iconY:o+45,iconDirection:_g.RIGHT}});case 8:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){c.guideManager.hideGuide()}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Rm),Lg=Dg,Mg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.levelOneGuide=void 0,n.levelTwoGuide=void 0,n.levelThreeGuide=void 0,n.levelSixGuide=void 0,n.cheeseGuide=void 0,n.squirrelGuide=void 0,n.treasureMapGuide=void 0,n.valueChangerGuide=void 0,n.ropeGuide=void 0,n.mysteriousCardGuide=void 0,n.boosterGuide=void 0,n.playLevelOneGuide=function(){n.levelOneGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelOneGuide)},n.playLevelTwoGuide=function(){n.levelTwoGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelTwoGuide)},n.playLevelThreeGuide=function(){n.levelThreeGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelThreeGuide)},n.playLevelSixGuide=function(){n.levelSixGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelSixGuide)},n.playCheeseGuide=function(){n.cheeseGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopCheeseGuide)},n.playSquirrelGuide=function(){n.squirrelGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopSquirrelGuide)},n.playTreasureMapGuide=function(){n.treasureMapGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopTreasureMapGuide)},n.playValueChangerGuide=function(){n.valueChangerGuide.play(),n.boardGame.stateMachine.once(tu.DRAW_PILE,n.stopValueChangerGuide)},n.playRopeGuide=function(){n.ropeGuide.play(),n.boardGame.stateMachine.once(tu.DRAW_PILE,n.stopRopeGuide)},n.playMysteriousCardGuide=function(){n.mysteriousCardGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopMysteriousCardGuide)},n.playBoosterGuide=function(){n.boosterGuide.play(),n.boardGame.stateMachine.once(tu.START,n.stopBoosterGuide)},n.stopLevelOneGuide=function(){n.guideManager.stop(),n.levelOneGuide.stop()},n.stopLevelTwoGuide=function(){n.guideManager.stop(),n.levelTwoGuide.stop()},n.stopLevelThreeGuide=function(){n.guideManager.stop(),n.levelThreeGuide.stop()},n.stopLevelSixGuide=function(){n.guideManager.stop(),n.levelSixGuide.stop()},n.stopCheeseGuide=function(){n.guideManager.stop(),n.cheeseGuide.stop()},n.stopSquirrelGuide=function(){n.guideManager.stop(),n.squirrelGuide.stop()},n.stopTreasureMapGuide=function(){n.guideManager.stop(),n.treasureMapGuide.stop()},n.stopValueChangerGuide=function(){n.guideManager.stop(),n.valueChangerGuide.stop()},n.stopRopeGuide=function(){n.guideManager.stop(),n.ropeGuide.stop()},n.stopMysteriousCardGuide=function(){n.guideManager.stop(),n.mysteriousCardGuide.stop()},n.stopBoosterGuide=function(){n.guideManager.stop(),n.boosterGuide.stop()},n.scene=t.scene,n.guideManager=t,n.boardGame=t.boardGame,n}(0,f.Z)(t,e);var n=t.prototype;return n.createGuides=function(){this.levelOneGuide=new mg(this.scene,this.guideManager,this.boardGame),this.levelTwoGuide=new wg(this.scene,this.guideManager,this.boardGame),this.levelThreeGuide=new Eg(this.scene,this.guideManager,this.boardGame),this.levelSixGuide=new vg(this.scene,this.guideManager,this.boardGame),this.cheeseGuide=new pg(this.scene,this.guideManager,this.boardGame),this.squirrelGuide=new Og(this.scene,this.guideManager,this.boardGame),this.treasureMapGuide=new Bg(this.scene,this.guideManager,this.boardGame),this.valueChangerGuide=new Lg(this.scene,this.guideManager,this.boardGame),this.ropeGuide=new Pg(this.scene,this.guideManager,this.boardGame),this.mysteriousCardGuide=new bg(this.scene,this.guideManager,this.boardGame),this.boosterGuide=new hg(this.scene,this.guideManager,this.boardGame)},n.stop=function(){this.levelOneGuide.stop(),this.levelTwoGuide.stop(),this.levelThreeGuide.stop(),this.levelSixGuide.stop(),this.cheeseGuide.stop(),this.squirrelGuide.stop(),this.treasureMapGuide.stop(),this.valueChangerGuide.stop(),this.ropeGuide.stop(),this.mysteriousCardGuide.stop(),this.boosterGuide.stop()},n.isLevelOneGuidePlaying=function(){return this.levelOneGuide.isPlaying},n.isLevelTwoGuidePlaying=function(){return this.levelTwoGuide.isPlaying},n.updateLevelOneGuide=function(e){this.levelOneGuide.update(e)},n.updateLevelTwoGuide=function(e){this.levelTwoGuide.update(e)},n.isBoosterGuidePlaying=function(){return this.boosterGuide.isPlaying},n.showBoosterGuide=function(e,t,n){return this.boosterGuide.showBoosterGuide(e,t,n)},t}(Im),_g=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e}({}),Ng=Ki.Z.GAMEPLAY_DEFAULT,Gg=Ng.KEY,Fg=Ng.FRAME,Zg=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.arrow=void 0,i.highLightCircle=void 0,i.tutorialHand=void 0,i.guideContainer=void 0,i.zone=void 0,i.arrowAnimation=void 0,i.guideAnimation=void 0,i.showHighLightTween=void 0,i.guideLayout=void 0,i.stop=function(){var t,n;e.prototype.stop.call((0,yc.Z)(i)),i.arrow.kill(),null==(t=i.arrowAnimation)||t.stop(),i.hideHandAnimation(),i.guideContainer.kill(),null==(n=i.showHighLightTween)||n.remove(),i.highLightCircle.kill(),i.highLightCircle.setAlpha(0)},i.scene=t,i.boardGame=n,i.createArrow(),i.createHighLightCircle(),i.createGuideContainer(),i.createTutorialHand(),i.createGuideZone(),i.guideLayout=GameCore.layoutInitializer.isLandscape?new sg((0,yc.Z)(i)):new Mg((0,yc.Z)(i)),i.guideLayout.createGuides(),i}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.stop(),this.guideLayout.stop()},n.playGuide=function(e,t){switch(e){case 1:this.guideLayout.playLevelOneGuide();break;case t.requiredLevels.undo:this.guideLayout.playLevelTwoGuide();break;case t.requiredLevels.combo:this.guideLayout.playLevelThreeGuide();break;case t.requiredLevels.wildCard:this.guideLayout.playLevelSixGuide();break;case 8:this.guideLayout.playCheeseGuide();break;case 46:this.guideLayout.playSquirrelGuide();break;case 53:this.guideLayout.playValueChangerGuide();break;case 148:this.guideLayout.playRopeGuide();break;case 190:this.guideLayout.playMysteriousCardGuide()}},n.showArrowAnimation=function(e,t){var n,i=this;e&&t&&this.arrow.setPosition(e,t),this.arrow.revive(),null==(n=this.arrowAnimation)||n.stop();var r=this.scene.tweens.createTimeline();this.arrow.scaleX=0,this.arrow.scaleY=0,r.add({targets:this.arrow,alpha:1,duration:200}),r.add({targets:this.arrow,onStart:function(){i.arrow.scaleX=1/GameCore.ImageScale,i.arrow.scaleY=1/GameCore.ImageScale},y:"+=15",scaleX:"+=0.1",scaleY:"-=0.05",duration:400,offset:0,yoyo:!0,repeat:-1}),r.play(),this.arrowAnimation=r},n.showHandAnimation=function(e,t){this.tutorialHand.revive(),this.tutorialHand.setPosition(e,t),this.tutorialHand.runTap()},n.hideArrowAnimation=function(){var e,t=this;null==(e=this.arrowAnimation)||e.stop();var n=this.scene.tweens.createTimeline();n.add({targets:this.arrow,alpha:0,duration:200,onComplete:function(){t.arrow.kill()}}),n.play(),this.arrowAnimation=n},n.hideHandAnimation=function(){this.tutorialHand.stopTap(),this.tutorialHand.kill()},n.update=function(e){this.guideLayout.isLevelOneGuidePlaying()&&this.guideLayout.updateLevelOneGuide(e),this.guideLayout.isLevelTwoGuidePlaying()&&this.guideLayout.updateLevelTwoGuide(e),this.tutorialHand.update(e)},n.hideGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideHandAnimation(),this.hideHighLightCircle(),null==(t=this.guideAnimation)||t.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:0,duration:300,onComplete:function(){n.guideContainer.kill()}}),e.next=6,this.guideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.stopWhenExitOrEndGame=function(e){var t=this.scene.gameplay.boardGame;t.stateMachine.once(tu.LOSE,e),t.stateMachine.once(tu.PILE_EMPTY,e),t.stateMachine.once(tu.EXIT,e)},n.showHighLightCircle=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=1/GameCore.ImageScale,this.highLightCircle.revive(),this.highLightCircle.setPosition(t,n),null==(s=this.showHighLightTween)||s.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,scaleX:{start:(i+1)*o,from:(i+1)*o,to:o*i,duration:400},scaleY:{start:(r+1)*o,from:(r+1)*o,to:o*r,duration:400},alpha:{start:0,from:0,to:.5},duration:300,ease:Phaser.Math.Easing.Sine.Out}),e.next=7,this.showHighLightTween.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.hideHighLightCircle=function(){var e,t=this;this.highLightCircle.visible&&(null==(e=this.showHighLightTween)||e.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){t.highLightCircle.kill()}}))},n.showGuide=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C,w,A,b,S,T,x,k,P,I,O,R,B,D,L,M,_,N,G,F,Z,U,W,Y,H,z,K,V,X,j,q,J,Q,$,ee,te,ne,ie;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(i=t||{}).x,s=void 0===r?0:r,o=i.y,c=void 0===o?0:o,h=i.circleScaleX,u=void 0===h?1:h,l=i.circleScaleY,d=void 0===l?1:l,p=i.textBox,f=p.textX,m=void 0===f?0:f,g=p.textY,v=void 0===g?0:g,y=p.text,E=void 0===y?"":y,C=p.textVisible,w=void 0===C||C,A=p.textAlignType,b=void 0===A?cu.CENTER:A,S=p.useBackground,T=void 0!==S&&S,x=p.font,k=void 0===x?Rc.ZP.PRIMARY.KEY:x,P=p.fontSize,I=void 0===P?16:P,O=p.tint,R=p.lineHeight,B=void 0===R?56:R,D=i.icon,L=D.iconX,M=void 0===L?0:L,_=D.iconY,N=void 0===_?0:_,G=D.iconDirection,F=void 0===G?_g.DOWN:G,Z=D.flipX,U=void 0!==Z&&Z,W=D.iconVisible,Y=void 0===W||W,H=i.showHighlight,z=void 0===H||H,this.guideContainer.revive(),K=this.guideContainer,V=K.bg,X=K.icon,j=K.text,q=K.shadow,J=1/GameCore.ImageScale,this.guideContainer.setText(E,b),q.setVisible(!T&&!z),j.setVisible(w),j.setFont(k),j.setFontSize(this.scene.fontSize(I)),j.setLineHeight(B),V.setVisible(T),V.setSizeByWorld(this.guideContainer.text.width+20,this.guideContainer.text.height+20),this.guideContainer.setPosition(Phaser.Math.Clamp(m,0+V.displayWidth/2+5,this.scene.gameZone.width-V.displayWidth/2-5),v),Q=this.guideContainer.getLocalPoint(M,N),$=Q.x,ee=Q.y,O?j.setTint(O):j.clearTint(),X.setPosition($,ee),X.setVisible(Y),te=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_SIDE,ne=U,F===_g.UP?te=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_UP:F===_g.DOWN?te=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_DOWN:ne=F!==_g.LEFT,X.setTexture(Ki.Z.GAMEPLAY_DEFAULT.KEY,te),X.setDefaultWorldSize(),ne&&X.setScale(-1*J,J),ie=[],null==(n=this.guideAnimation)||n.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:1,duration:300}),ie.push(this.guideAnimation.waitForCompletion()),z&&ie.push(this.showHighLightCircle(s,c,u,d)),this.zone.setVisible(!0),e.next=31,Promise.all(ie);case 31:this.zone.setVisible(!1);case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createArrow=function(){var e=this.scene.add.image(0,0,Gg,Fg.ARROW_GREEN);e.setDefaultWorldSize(),e.kill(),e.setDepth(Ha.Z.GUIDE),e.setAlpha(0),this.arrow=e},n.createTutorialHand=function(){var e=new Pm(this.scene);e.kill(),e.setDepth(Ha.Z.GUIDE),this.tutorialHand=e},n.createHighLightCircle=function(){var e=new bm(this.scene);e.kill(),e.setDepth(Ha.Z.GUIDE),e.setAlpha(0),e.setTint(0),this.highLightCircle=e,Ap.Z.registerObject(this.highLightCircle)},n.createGuideContainer=function(){var e=new ym(this.scene);this.scene.add.existing(e),e.kill(),e.setDepth(Ha.Z.GUIDE),e.setAlpha(0),this.guideContainer=e},n.createGuideZone=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.scene.add.zone(0,0,t,n);i.setVisible(!1),i.setInteractive(),i.setDepth(Ha.Z.GUIDE),Phaser.Display.Align.In.Center(i,this.scene.gameZone),this.zone=i},t}(Pp),Ug=Zg,Wg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.totalScore=void 0,n.scoreEachMatch=15,n.scoreEachStockRemain=5,n.updateProgress=function(){},n.scene=t,n.init(),n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.totalScore=0,this.initRequireScoreForStars()},n.increaseScoreByMatch=function(e){this.totalScore+=this.scoreEachMatch*e,this.updateProgress()},n.increaseScoreByStock=function(e){if(!(e<1)){var t=this.scoreEachStockRemain*e,n=this.scoreEachStockRemain,i=this.scoreEachStockRemain*((t+n)/2);this.totalScore+=i,this.updateProgress()}},n.increaseScoreByBoom=function(e){this.totalScore+=100*e,this.updateProgress()},n.increaseScoreByLock=function(e){this.totalScore+=50*e,this.updateProgress()},n.setTotalScore=function(e){this.totalScore=e,this.updateProgress()},n.getTotalScore=function(){return this.totalScore},n.getStars=function(){return 0},n.initRequireScoreForStars=function(){var e=this.scene.level.getLevelData();if(e){var t=e.settings;t.star_1,t.star_2,t.star_3}},t}(Pp),Yg=Wg,Hg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.animationPromises=[],n.scene=t,n}(0,f.Z)(t,e);var n=t.prototype;return n.createSpine=function(e,t,n,i,r){var a=this.scene.add.spine(e,t,n,i,r);return a.scale=1,a.animationStateData.defaultMix=.4,a},n.killSpine=function(e){e.animationState.clearTracks(),e.setVisible(!1),e.setActive(!1)},n.reviveSpine=function(e){e.setVisible(!0),e.setActive(!0)},n.stopAnimation=function(e,t,n){void 0===t&&(t="clear"),"clear"!==t?"mix-to-empty"===t&&e.animationState.setEmptyAnimations(n):e.animationState.clearTracks()},n.waitForTrack=function(e,t,n){var i=Array.isArray(n)?n:[n];return new Promise((function(n){var r=function(i){return function(n,i,r){i===t&&(n(),e.animationState.removeListener(r))}(n,i,a)},a=i.reduce((function(e,t){return e[t]=r,e}),{});e.animationState.addListener(a)}))},n.playAnimation=function(e,t,n,i,r){var a;if(void 0===r&&(r=["end","dispose","complete"]),i&&(null==(a=e.animationState.getCurrent(0))||null==(a=a.animation)?void 0:a.name)===t)return Promise.resolve();this.reviveSpine(e);var s=e.animationState.setAnimation(0,t,n);return this.waitForTrack(e,s,r)},n.playAndWaitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s){var o,c,h,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===s&&(s=["end","dispose","complete"]),!r||(null==(o=t.animationState.getCurrent(0))||null==(o=o.animation)?void 0:o.name)!==n){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.reviveSpine(t),c=t.animationState.setAnimation(0,n,i),this.scene.gameplay.setEnableCardInput(!1),h=this.waitForTrack(t,c,s),this.animationPromises.push(h),h.finally((function(){u.animationPromises=u.animationPromises.filter((function(e){return e!==h})),0===u.animationPromises.length&&u.scene.gameplay.setEnableCardInput(!0)})),e.abrupt("return",h);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a){return e.apply(this,arguments)}}(),t}(Pp),zg=Hg,Kg=function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.boardGame=void 0,n.scoreManager=void 0,n.comboManager=void 0,n.boosterManager=void 0,n.guideManager=void 0,n.coinUsingManager=void 0,n.confettiSmallFallDown=void 0,n.spineManager=void 0,n.eventManager=void 0,n.eventAnimator=void 0,n.enableCardInput=void 0,n.timePlayed=void 0,n.startGameCount=0,n.coinAtStartGame=void 0,n.handleShowInterstitialAd=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.scene).ads.canbeShowInterstitialAd()){e.next=16;break}return t.ads.setAdInProcess(!0),t.audio.muteAll(),t.audio.pauseAllSounds(),t.audio.pauseAllMusics(),e.prev=6,e.next=9,t.ads.showInterstitialAdAsync();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:t.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(t.audio.unmuteAll(),t.audio.resumeAllSounds(),n.scene.resumeMusic()),t.ads.preloadInterstitialAdAsync().catch((function(e){}));case 16:case"end":return e.stop()}}),e,null,[[6,11]])}))),n.scene=t,n.timePlayed=0,n.boardGame=new Sp((0,yc.Z)(n)),n.spineManager=new zg(n.scene),n.boosterManager=new Xp(n.scene,n.boardGame),n.scoreManager=new Yg(n.scene),n.comboManager=new Xf(n.scene),n.coinUsingManager=new Sf(n.scene,n.boardGame),n.guideManager=new Ug(n.scene,n.boardGame),n.eventManager=new pm(n.scene),n.boardGame.listenEventsToShowUndo(),n}(0,f.Z)(t,e);var n=t.prototype;return n.processStartLevel=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.scene.level.getLevel())<=3)){e.next=7;break}return e.next=4,this.scene.gameUI.hideStar();case 4:this.start(),e.next=8;break;case 7:this.openStartLevelScreen(t);case 8:this.scene.events.emit("prevent-show-events");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.startChallengeLevel=function(){},n.replayGame=function(){this.handleShowInterstitialAd(),this.start()},n.handleGameOver=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.turnOffMusic(Hc.Z.GAMEPLAY_BACKGROUND.KEY),this.eventManager.stop(),1==this.scene.level.getLevel()&&this.scene.player.incUserGuideDisplays(),t?$h.emit(jh.PASS_LEVELS.EVENTS.PASS_LEVEL,{type:"level",value:1}):this.handleOpenGameOverScreen(t),this.logLevelEnd(t),this.setEnableCardInput(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.handleOpenGameOverScreen=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s,o,c,h,u,d,p,f,m,g,v,y,E,C=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boardGame.clear(),this.scene.storage.dispatch(hi({score:this.scene.rewardManager.getTotalRewardCoin(),level:this.scene.level.getLevelByMode(),success:t})),this.scene.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,d,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.analytics,r=n(),s=tt(r),o=Sn(r),c=o.score,h=void 0===c?0:c,u=o.level,d=void 0===u?0:u,e.next=7,t(ki(s,{score:h,level:d}));case 7:r=n(),p=nt(r),f=it(r),m=Math.floor((f-p)/1e3),i.event(ae._.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(s),level:d,level_name:"level_"+d,time_played:m}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,l.tO)(e.t0);case 17:return e.prev=17,yi(200),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()),n=0,r=Jh.NORMAL,s=this.scene.level.getLevelData(),o=this.boosterManager.getAmountBoosters(),s&&(c=s.settings.mapProperties,n=c.coinsRewarded,r=c.difficulty),h=this.scene.level.getLevel(),u={level:this.scene.level.getLevel(),levelClearedCoin:n,levelCollectedCoin:this.scene.rewardManager.getTotalRewardCoin(),slice:{selected:!1,amount:o.slice},storm:{selected:!1,amount:o.storm},wildCard:{selected:!1,amount:o.wildCard},onClaim:function(){return C.handleOnClaim()},difficulty:r},d=this.scene.game,p=d.boxingDuel,f=d.weeklyTournament,m=d.offshoreRace,t||this.eventManager.resetEventItemAmount(),m.isHappening()&&m.updateRacersScore(t),p.isHappening()&&(g=p.getPlayerScore(),v=this.eventManager.getBoxingDuelItemAmount(),p.updatePlayerScore(g+v),p.updateOpponentScore()),f.isPlayingTournament()&&(y=f.getScore(),E=this.eventManager.getWeeklyTournamentItemAmount(),f.handleNextLevel(y+E),f.requestDataAfterFinishGame()),t?(this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.LEVEL_COMPLETED),this.scene.screen.open(de.o4.LEVEL_COMPLETE_SCREEN,u),this.scene.level.processLevelCompleted(h,3),this.scene.rewardManager.rewardStar(1),this.scene.logEconomy.logGetItem(yl.STAR,1,Cl.LEVEL_COMPLETE)):this.scene.screen.open(de.o4.NO_MORE_MOVES_SCREEN,u);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.start=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resetLog(),this.scene.turnOnGameplayMusic(),e.next=4,this.getLevel();case 4:return t=e.sent,e.next=7,this.requireSpineAssets();case 7:this.startGameCount+=1,this.tryToSubscribeBot(),this.timePlayed=0,this.logLevelStart(),this.startGameWith(t),this.coinAtStartGame=this.scene.player.getCoins(),this.scene.gameModeManager.start(),this.showBoxingDuelVersusScreen(),this.scene.setBackgroundWithFadeAnimation({useGameplayBackground:!0}),this.preloadAssetsInNextLevel();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.requireSpineAssets=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:this.scene.lang.Text.loading,loading:!0,animationFadeOut:!0}),e.next=3,this.scene.requireSpineAsync("CARD_SLICE_FX_SPINE");case 3:return e.next=5,this.scene.requireSpineAsync("CARD_SLICE_SPINE");case 5:return e.next=7,this.scene.requireSpineAsync("WINDMILL_SPINE");case 7:if(!(t=this.scene.level.getLevelData())){e.next=15;break}if(!t.balloonData.length){e.next=12;break}return e.next=12,this.scene.requireSpineAsync("CODE_BREAK_SPINE");case 12:return n=t.cards.map((function(e){return e.type===nu.LOCK?i.scene.requireSpineAsync("CARD_LOCK_SPINE"):e.type===nu.TREASURE?i.scene.requireSpineAsync("MAP_SPINE"):void 0})),e.next=15,Promise.all(n);case 15:window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadAssetsInNextLevel=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.level.getLevel(),e.next=3,this.scene.level.preloadLevelDataAsync(n+1);case 3:if(i=this.scene.level.getLevelData(n+1)){e.next=6;break}return e.abrupt("return");case 6:if(null==(t=i.balloonData)||!t.length){e.next=9;break}return e.next=9,this.scene.requireSpineAsync("CODE_BREAK_SPINE");case 9:return r=i.cards.map((function(e){return e.type===nu.LOCK?s.scene.requireSpineAsync("CARD_LOCK_SPINE"):e.type===nu.TREASURE?s.scene.requireSpineAsync("MAP_SPINE"):void 0})),e.next=12,Promise.all(r);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showBoxingDuelVersusScreen=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.boxingDuel.isHappening()){e.next=5;break}return e.next=4,this.scene.requireTextureAsync("BOXING_DUEL");case 4:this.scene.screen.open(de.o4.BOXING_DUEL.VERSUS_SCREEN);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryToCreateShortcut=function(){this.startGameCount>1&&this.scene.facebook.attemptToAddShortcut()},n.tryToSubscribeBot=function(){this.startGameCount>1&&this.scene.facebook.attemptToSubscribeBot()},n.startGameWith=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.weeklyTournament.popupJoinTournament(),e.next=3,this.scene.level.preloadLevelDataAsync(t);case 3:return n=this.scene.gameUI,this.initManagers(),this.eventManager.start(),n.updateLevelTitle(t),this.handleSettingsToLevel(t),n.showUI(),n.hideLife(),this.setEnableCardInput(!1),e.next=13,this.boardGame.stateMachine.emitAndWait(tu.RESET);case 13:return e.next=15,this.boardGame.stateMachine.emitAndWait(tu.START);case 15:this.scene.events.emit(Iu.Z.START_LEVEL);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setEnableCardInput=function(e){this.spineManager.animationPromises.length>0||(this.enableCardInput=e)},n.update=function(e){this.timePlayed+=e,this.boardGame.update(e),this.guideManager.update(e)},n.openPopupStartLevel=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.stateMachine.emit(tu.RESET),this.guideManager.init(),this.scene.level.setLevel(t),e.next=5,this.scene.level.preloadLevelDataAsync(t);case 5:this.openStartLevelScreen(t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.openStartLevelScreen=function(e){var t,n=this.scene.gameSettings.requiredLevels,i=n.boosterSlice,r=n.boosterStorm,a=n.boosterWildCard;e!=i&&e!=r&&e!=a||this.guideManager.guideLayout.playBoosterGuide();var s=this.boosterManager.getAmountBoosters(),o=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty;this.scene.setBackgroundWithFadeAnimation(),this.scene.gameUI.hideStar(),this.scene.screen.open(de.o4.PLAY_SCREEN,{level:e,slice:{selected:!1,amount:s.slice},storm:{selected:!1,amount:s.storm},wildCard:{selected:!1,amount:s.wildCard},difficulty:o})},n.handleSettingsToLevel=function(e){var t=this.scene.gameSettings.requiredLevels;this.scene.gameUI.footer.settingsMenu.revive(),this.comboManager.setEnable(!1),this.comboManager.streakBar.kill(),this.boardGame.setCanShowUndo(!1),this.boardGame.setCanRefillStock(!0),this.coinUsingManager.wildCardBtn.kill(),this.coinUsingManager.undoBtn.kill(),1==e&&this.scene.gameUI.footer.settingsMenu.kill(),e>=t.addCards&&this.boardGame.setCanRefillStock(!1),e>=t.undo&&(e==t.undo&&(this.coinUsingManager.setUndoPrice(0),this.coinUsingManager.setUndoPriceDiff(0)),this.boardGame.setCanShowUndo(!0)),e>=t.combo&&(this.comboManager.setEnable(!0),this.comboManager.streakBar.revive()),e>=t.wildCard&&(e==t.wildCard&&(this.coinUsingManager.setWildCardPrice(0),this.coinUsingManager.setWildCardPriceDiff(0),this.coinUsingManager.onWildCardChanged()),this.coinUsingManager.wildCardBtn.revive())},n.initManagers=function(){this.scoreManager.init(),this.comboManager.init(),this.coinUsingManager.init(),this.guideManager.init(),this.boosterManager.init(),this.scene.rewardManager.init(),this.eventManager.init();var e=this.scene.level.getLevelData();if(e){var t=e.settings.mapProperties;this.comboManager.setStreak(t.streak),this.eventManager.setup(e.cards)}},n.handleOnClaim=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.stopMusic(),this.scene.screen.close(de.o4.LEVEL_COMPLETE_SCREEN),e.next=4,this.scene.weeklyTournament.waitForRequestDataFinishGameCompleted();case 4:(t=this.eventManager.hasAtLeastOneEventRunning())?this.scene.screen.open(de.o4.DASHBOARD_SCREEN,{shouldPlusEventScore:t,openLevelNextStep:!0}):4===this.scene.level.getLevel()?this.scene.screen.open(de.o4.DASHBOARD_SCREEN):this.processStartLevel();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getLevel=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.level.getLevel());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resetLog=function(){this.timePlayed=0,this.boardGame.resetLog(),this.comboManager.resetLog(),this.scene.logGameplay.resetLog()},n.getAndSetChallengeLevel=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.FBInstant.getEntryPointData(),n=(null==t?void 0:t.level)||this.scene.level.getRandomChallengeLevel(),e.next=4,this.scene.level.setChallengeLevel(n);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.logLevelStart=function(){var e=this.scene.level.getLevel(),t=this.scene.player.getCoins(),n=this.boosterManager.getLogBooster();this.scene.analytics.event(ae._.LEVEL_START,{level:e,coins:t,boosters:n})},n.logLevelEnd=function(e){var t=this.scene.level.getLevel(),n=this.scene.player.getCoins(),i=this.boosterManager.getLogBooster(),r=Math.round(this.timePlayed/1e3),a=this.boardGame.getMetricsLog(),s=a.wildCardUsedCount,o=a.addCardsCountByCoin,c=a.addCardsCountByAd,h=a.undoCount,u=a.missedPlayableCount,l=a.streakCount,d=a.clickOnUnmatchedCardCount,p=this.boardGame.stock.getCardsLength(),f=this.boardGame.pile.getCardsLength(),m=this.comboManager.getAverageComboCount(),g=this.boardGame.mover.getMoves();this.scene.analytics.event(ae._.LEVEL_END,{level:t,coins:n,coin_used:this.coinAtStartGame-n,boosters:i,wild_card_used_count:s,add_cards_count_by_coin:o,add_cards_count_by_ad:c,moves:g,undo_count:h,missed_playable_count:u,streak_count:l,remaining_stock_count:p,remaining_pile_count:f,success:e,time_played:Math.round(r),average_combo_count:m,click_on_unmatched_card_count:d})},t}(Phaser.Events.EventEmitter),Vg=Kg,Xg=Ki.Z.DEFAULT.KEY,jg=function(e){function t(t,n){var i;return(i=e.call(this,t,Xg,n.backgroundOn)||this).options=void 0,i.icon=void 0,i.getFrameByStatus=function(){var e=i.options,t=e.enable,n=e.frameOn,r=e.frameOff;return t?n:r},i.getBackgroundByStatus=function(){var e=i.options,t=e.enable,n=e.backgroundOn,r=e.backgroundOff;return t?n:r},i.createButton=function(e){var t=i.getBackgroundByStatus();i.button=i.scene.add.image(0,0,e,t),i.add(i.button)},i.options=n,i.createIcon(),i}(0,f.Z)(t,e);var n=t.prototype;return n.processCallback=function(e){var t=this.options.enable;this.updateStatus(!t),e(!t)},n.updateStatus=function(e){this.options.enable=e;var t=this.getFrameByStatus();this.icon.setFrame(t);var n=this.getBackgroundByStatus();this.button.setFrame(n)},n.createIcon=function(){var e=this.getFrameByStatus();this.icon=this.scene.make.image({key:Xg,frame:e}),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.button)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name,n=!this.options.enable;this.scene.analytics.event(ae._.BUTTON_CLICK,{button_name:t,screen_name:e,enable:n})},t}(Vc.Z),qg=jg,Jg=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).statusText=void 0,i.slideAnimation=void 0,i.setSize(64,24.5),i.icon.setWorldSize(29,29),i.createText(),i.bringToTop(i.icon),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateStatus=function(t){e.prototype.updateStatus.call(this,t),this.alignSwitch()},n.setStatus=function(e){var t;this.updateStatus(e),null==(t=this.slideAnimation)||t.remove(),this.updateStatusText(),e?this.icon.setX(21):this.icon.setX(-21)},n.updateSize=function(){this.button.setWorldSize(64,24.5),e.prototype.updateSize.call(this)},n.createText=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(12),origin:{x:.5,y:.5},text:"OFF"});this.add(e),this.statusText=e},n.alignSwitch=function(){this.options.enable?this.runSlideAnimation(20):this.runSlideAnimation(-20)},n.updateStatusText=function(){var e=this.options.enable;this.statusText.setText(e?"ON":"OFF"),e?this.statusText.setX(-13):this.statusText.setX(13)},n.runSlideAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.slideAnimation)||n.remove(),150,this.slideAnimation=this.scene.tweens.add({targets:this.icon,x:t,duration:150,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(e){e.elapsed>=75&&i.updateStatusText()}}),this.scene.time.delayedCall(75,this.updateStatusText.bind(this)),e.next=6,this.slideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(qg),Qg=Jg,$g=function(e){function t(t,n,i){var r;return(r=e.call(this,t,0,0)||this).label=void 0,r.button=void 0,r.setSize(n,i),r.create(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=Ki.Z.DEFAULT.FRAME,t=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(20),text:"Label",origin:{x:0,y:.5}});t.setTint(7031916);var n=new Qg(this.scene,{enable:!0,frameOn:e.SWITCH_ON,frameOff:e.SWITCH_OFF,backgroundOn:e.TOGGLE_ON_BAR,backgroundOff:e.TOGGLE_OFF_BAR});this.add([t,n]),Phaser.Display.Align.In.LeftCenter(t,this),Phaser.Display.Align.In.RightCenter(n,this),this.button=n,this.label=t},n.updateStatus=function(e){this.button.updateStatus(e)},n.setDisabled=function(e){this.button.setDisabled(e)},t}(Phaser.GameObjects.Container),ev=$g,tv=n(57),nv=Ki.Z.DEFAULT,iv=nv.KEY,rv=nv.FRAME,av=function(e){function t(t,n,r,s,o,c){var h;return(h=e.call(this,t,iv,rv.BLANK,s,o,c)||this).animation=void 0,h.frame=void 0,h.bg=void 0,h.resumeAnimationTimer=void 0,h.pauseAnimation=function(){var e;null==(e=h.resumeAnimationTimer)||e.remove(),h.animation.pause()},h.resumeAnimation=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.animation.isPaused()&&(h.resumeAnimationTimer=h.scene.time.addEvent({delay:200,callback:function(){h.animation.resume(),h.animation.restart()}}));case 1:case"end":return e.stop()}}),e)}))),h.button.kill(),h.frame=r,h.createBg(n,r,s,o),h}(0,f.Z)(t,e);var n=t.prototype;return n.createBg=function(e,t,n,i){var r=12,a=12,s=12,o=13;switch(this.frame){case rv.BUTTON.GREEN_40:r=12,a=12,s=12,o=13;break;case rv.BUTTON.GREEN_50:r=14,a=14,s=15,o=15;break;case rv.BUTTON.GREEN_60:r=18,a=18,s=18,o=19;break;case rv.BUTTON.BLUE_40:r=11,a=11,s=12,o=13;break;case rv.BUTTON.BLUE_50:r=15,a=15,s=14,o=15;break;case rv.MISSION.CLAIM_BUTTON:r=9.5,a=15,s=9.5,o=10}var c=this.scene.make.nineslice({key:e,frame:t,width:n,height:i,leftWidth:r,rightWidth:a,topHeight:s,bottomHeight:o});this.add(c),this.bg=c},n.getDefaultAnimationConfig=function(){return{targets:[this],duration:400,props:{scale:{from:1,to:.975}},yoyo:!0,repeat:-1,repeatDelay:50,ease:tv.Z,easeParams:[0,.9]}},n.runAnimation=function(){var e;null==(e=this.animation)||e.remove();var t=this.getDefaultAnimationConfig();this.animation=this.scene.add.tween(t),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation)},n.stopAnimation=function(){var e;null==(e=this.animation)||e.remove(),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation)},t}(Vc.Z),sv=av,ov=n(76),cv=function(){var e=GameCore.Utils.Device,t=window.navigator.vibrate;return e.isAndroid()&&"function"===typeof t||e.isMobileWeb()&&"function"===typeof t},hv=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.ceil(t/80),r=0,s=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.performHapticFeedbackAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();case 3:if(!(r<n)){e.next=11;break}return o=s(),c=(0,me.qZ)(80),r+=1,e.next=9,Promise.all([o,c]);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),uv=function(e){window.navigator.vibrate(0),window.navigator.vibrate(e)},lv=function(e){try{if(!cv())return!1;var t=GameCore.Utils.Device;t.isAndroid()||t.isMobileWeb()?uv(e):t.isIOS()&&hv(e).catch((function(e){}))}catch(n){}},dv=function(e){function t(t){var n;return(n=e.call(this,t)||this).shadow=void 0,n.stroke=void 0,n.text=void 0,n.shadow=t.make.bitmapText({font:Rc.ZP.SHADOW.KEY}),n.stroke=t.make.bitmapText({font:Rc.ZP.STROKE.KEY}),n.text=t.make.bitmapText({font:Rc.ZP.NORMAL.KEY}),n.setFontSize(20),n.setOrigin(.5,.5),n.add([n.shadow,n.stroke,n.text]),n}(0,f.Z)(t,e);var n=t.prototype;return n.setFontSize=function(e){this.shadow.setFontSize(this.scene.fontSize(e)),this.stroke.setFontSize(this.scene.fontSize(e)),this.text.setFontSize(this.scene.fontSize(e)),this.setSize(this.shadow.width,this.shadow.height)},n.setText=function(e){this.shadow.setText(e),this.stroke.setText(e),this.text.setText(e)},n.setStroke=function(e){this.stroke.setTint(e)},n.setColor=function(e){this.text.setTint(e)},n.setOrigin=function(e,t){this.shadow.setOrigin(e,t),this.stroke.setOrigin(e,t),this.text.setOrigin(e,t)},n.setLetterSpacing=function(e){this.shadow.setLetterSpacing(e),this.stroke.setLetterSpacing(e),this.text.setLetterSpacing(e)},n.setCenterAlign=function(){this.shadow.setCenterAlign(),this.stroke.setCenterAlign(),this.text.setCenterAlign()},n.setLineHeight=function(e){this.shadow.setLineHeight(e),this.stroke.setLineHeight(e),this.text.setLineHeight(e)},t}(Phaser.GameObjects.Container),pv=dv,fv=Ki.Z.DEFAULT,mv=fv.KEY,gv=fv.FRAME,vv=254,yv=52,Ev={width:254,height:196},Cv={width:254,height:yv+Ev.height},wv={width:Cv.width+21,height:Cv.height+20},Av=function(e){function t(t){var n;return(n=e.call(this,t)||this).soundSwitchUI=void 0,n.musicSwitchUI=void 0,n.vibrationSwitchUI=void 0,n.endGameButton=void 0,n.closeButton=void 0,n.content=void 0,n.initSize(),n.setSize(Cv.width,Cv.height),n.create(),n.createEndGameButton(),n.createCloseButton(),t.add.existing((0,yc.Z)(n)),n.listenAudioEnabledChange(),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenAudioEnabledChange=function(){var e=this;GameSDK.onAudioEnabledChange((function(t){e.soundSwitchUI.updateStatus(t),e.musicSwitchUI.updateStatus(t),e.soundSwitchUI.setDisabled(!t),e.musicSwitchUI.setDisabled(!t)}))},n.initSize=function(){Ev=cv()?{width:254,height:196}:{width:254,height:166},Cv={width:254,height:yv+Ev.height},wv={width:Cv.width+21,height:Cv.height+20}},n.create=function(){this.createShadow(),this.createHeader(),this.createContent()},n.createShadow=function(){var e=this.scene.make.nineslice({key:mv,frame:gv.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:wv.width,height:wv.height});e.setY(10),this.add(e)},n.createHeader=function(){var e=this.scene.add.container();e.setSize(vv,yv);var t=this.scene.make.nineslice({key:mv,frame:gv.THREE_SLICE.HEADER,leftWidth:23,rightWidth:23,topHeight:22,bottomHeight:0,width:vv,height:yv}),n=new pv(this.scene);n.setText("Settings"),n.setColor(7162732),n.setFontSize(28),n.setY(-2),e.add([t,n]),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,0)},n.createContent=function(){this.content=this.scene.add.container(),this.content.setSize(Ev.width,Ev.height),this.createBackground(),this.createSwitchButtons(),this.add(this.content),Phaser.Display.Align.In.BottomCenter(this.content,this)},n.createBackground=function(){var e=this.scene.add.container();e.setSize(Ev.width,Ev.height);var t=this.scene.make.nineslice({key:mv,frame:gv.NINE_SLICE.POPUP_BG,leftWidth:23,rightWidth:23,topHeight:0,bottomHeight:22,width:Ev.width,height:Ev.height}),n=this.scene.make.nineslice({key:mv,frame:gv.NINE_SLICE.POPUP_CONTENT,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,width:Ev.width-20,height:Ev.height-72});e.add([t,n]),n.setY(-26),this.content.add(e)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=new ev(this.scene,208,24);o.button.setName("SoundSwitch"),o.label.setText("Sound"),o.button.updateStatus(n),this.soundSwitchUI=o;var c=new ev(this.scene,208,24);if(c.button.setName("MusicSwitch"),c.label.setText("Music"),c.button.updateStatus(r),this.musicSwitchUI=c,cv()){var h=new ev(this.scene,208,24);h.label.setText("Vibration"),h.button.updateStatus(s),this.vibrationSwitchUI=h,this.content.add([o,c,h]),Phaser.Display.Align.In.TopCenter(o,this.content,0,-25),Phaser.Display.Align.In.TopCenter(c,this.content,0,-60),Phaser.Display.Align.In.TopCenter(h,this.content,0,-95)}else this.content.add([o,c]),Phaser.Display.Align.In.TopCenter(o,this.content,0,-24),Phaser.Display.Align.In.TopCenter(c,this.content,0,-62)},n.createCloseButton=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new ov.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:15,height:14.5,paddingZone:30});i.setName("Close"),this.add(i),Phaser.Display.Align.In.TopRight(i,this,-15,-15),this.closeButton=i},n.createEndGameButton=function(){var e=new sv(this.scene,mv,gv.BUTTON.RED_40,97.5,42.5);e.setName("EndGame");var t=this.scene.make.bitmapText({font:Rc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(15),origin:{x:.5,y:.5},text:"Exit Game"});e.add(t),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-8),this.endGameButton=e},t}(Phaser.GameObjects.Container),bv=Av,Sv={tweenConfigs:{screen:{configOpen:{props:{alpha:{from:0,to:1},ease:Phaser.Math.Easing.Sine.In},duration:150,offset:0},configClose:{props:{alpha:{value:0}},duration:150,offset:0}},popup:{configOpen:{props:{scale:{from:.5,to:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}},duration:500,offset:0},configClose:{props:{scale:{value:.75,ease:Phaser.Math.Easing.Back.In}},duration:150,offset:0}}}},Tv=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).settingsContainer=void 0,a.handleCloseScreen=function(){a.scene.screen.close(a.name),a.scene.gameUI.showUI()},a.handleSoundChange=function(e){a.scene.player.setSetting("sound",e)},a.handleMusicChanged=function(e){a.scene.player.setSetting("music",e),e?a.scene.resumeMusic():a.scene.audio.pauseAllMusics()},a.handleVibrationChanged=function(e){a.scene.player.setSetting("vibrate",e),e&&a.scene.vibration.performVibrating(50)},a.handleEndGame=function(){a.scene.screen.open(de.o4.EXIT_GAME_SCREEN,{exitCallback:function(){a.scene.screen.close(de.o4.EXIT_GAME_SCREEN),a.scene.gameplay.boardGame.stateMachine.emit(tu.EXIT)},playOnCallback:function(){a.scene.screen.close(de.o4.EXIT_GAME_SCREEN)}}),a.scene.screen.close(a.name)},a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.scene.screen.close(a.name),a.scene.gameUI.showUI()}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.setDepth(de.Ks.POPUP),a.create(),a.background.setInteractive({useHandCursor:!0}),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.settingsContainer=new bv(this.scene),this.settingsContainer.setInteractive(),this.add(this.settingsContainer);var e=this.settingsContainer,t=e.soundSwitchUI,n=e.musicSwitchUI,i=e.vibrationSwitchUI,r=e.endGameButton,a=e.closeButton;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),a.onClick=this.handleCloseScreen,r.onClick=this.handleEndGame},n.open=function(){e.prototype.open.call(this),this.updateData(),this.scene.gameUI.hideUI(),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation(),this.background.off(Phaser.Input.Events.POINTER_DOWN),this.scene.gameplay.boardGame.stateMachine.emit(tu.CLOSE_SETTINGS)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.settingsContainer,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.setStatus(n),h.button.setStatus(r),u&&u.button.setStatus(s)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.settingsContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.settingsContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),xv=Tv,kv=n(39),Pv="How about diving into the game for a relaxing experience?",Iv=GameCore.Configs.Notification.DailyNotificationMessages,Ov=void 0===Iv?{}:Iv,Rv=function(){function e(){}e.sendNewUserNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getInstance(),e.abrupt("return",t.sendNewUserNotificationInstance());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendDailyNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getInstance(),e.abrupt("return",t.sendDailyNotificationInstance());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendTestDailyNotification=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getInstance();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance};var t=e.prototype;return t.sendNewUserNotificationInstance=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.facebook,r=t.rollbar,e.prev=1,n.getPlayerIsNew()){e.next=5;break}return e.abrupt("return");case 5:if(n.getPlayerASID()){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,FBInstant.player.getDataAsync(["isNotificationFirstSent"]);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0={};case 13:if(s=e.t0,!0!==s.isNotificationFirstSent){e.next=17;break}return e.abrupt("return");case 17:return o={message:Pv,delayTime:14400,type:kv.Z.NEW_USER_NOTIFICATION},e.next=20,i.sendNotificationAsync(o);case 20:FBInstant.player.setDataAsync({isNotificationFirstSent:!0}),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(1),r.sendException(e.t1);case 26:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(){return e.apply(this,arguments)}}(),t.sendDailyNotificationInstance=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.game.rollbar,e.prev=1,n=new Date,i=n.getDay(),e.t0=i,e.next=0===e.t0?7:1===e.t0?10:2===e.t0?13:3===e.t0?16:4===e.t0?19:22;break;case 7:return e.next=9,this.sendMondayNotification();case 9:return e.abrupt("break",22);case 10:return e.next=12,this.sendTuesdayNotification();case 12:return e.abrupt("break",22);case 13:return e.next=15,this.sendWednesdayNotification();case 15:return e.abrupt("break",22);case 16:return e.next=18,this.sendThursdayNotification();case 18:return e.abrupt("break",22);case 19:return e.next=21,this.sendFridayNotification();case 21:return e.abrupt("break",22);case 22:return e.next=24,this.sendSaturdayNotification();case 24:return e.next=26,this.sendSundayNotification();case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),t.sendException(e.t1);case 31:case"end":return e.stop()}}),e,this,[[1,28]])})));return function(){return e.apply(this,arguments)}}(),t.sendMondayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s={message:null!=(r=Ov.MONDAY)?r:Pv,delayTime:86400,type:kv.Z.MONDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendTuesdayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s={message:null!=(r=Ov.TUESDAY)?r:Pv,delayTime:86400,type:kv.Z.TUESDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendWednesdayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s={message:null!=(r=Ov.WEDNESDAY)?r:Pv,delayTime:86400,type:kv.Z.WEDNESDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendThursdayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s={message:null!=(r=Ov.THURSDAY)?r:Pv,delayTime:86400,type:kv.Z.THURSDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendFridayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s={message:null!=(r=Ov.FRIDAY)?r:Pv,delayTime:86400,type:kv.Z.FRIDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendSaturdayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s=this.findDelayTimeForNextDay(6,10),o={message:null!=(r=Ov.SATURDAY)?r:Pv,delayTime:s,type:kv.Z.SATURDAY_NOTIFICATION},e.next=6,n.sendNotificationAsync(o);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.sendException(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),t.sendSundayNotification=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,s=this.findDelayTimeForNextDay(0,10),o={message:null!=(r=Ov.SUNDAY)?r:Pv,delayTime:s,type:kv.Z.SUNDAY_NOTIFICATION},e.next=6,n.sendNotificationAsync(o);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.sendException(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),t.findDelayTimeForNextDay=function(e,t){if(e<0||e>6)throw new Error("Invalid day for notification");if(t<0||t>23)throw new Error("Invalid hour for notification");var n=Date.now(),i=new Date(n).getDay(),r=new Date(n).getHours(),a=e,s=t;if(i===a&&r>=s){var o=3600*(168-r+s);if(o>604800)throw new Error("Notification delay time is more than 7 days");return o}var c=a<i?7-i+a:a-i;s<r&&c--;var h=3600*(24*c+(s<r?24-r+s:s-r));if(h>604800)throw new Error("Notification delay time is more than 7 days");return h},t.sendTestDailyNotificationInstance=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={0:"SUNDAY",1:"MONDAY",2:"TUESDAY",3:"WEDNESDAY",4:"THURSDAY",5:"FRIDAY",6:"SATURDAY"},e.prev=1,r=Pv,!(t<0||t>6)){e.next=5;break}throw new Error("Invalid day for notification. Day must be between 0 (Sunday) and 6 (Saturday)");case 5:return r=null!=(i=Ov[n[t]])?i:Pv,s={message:r,delayTime:300,type:kv.Z.GENERIC_NOTIFICATION},e.next=9,window.game.facebook.sendNotificationAsync(s);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),e}();Rv._instance=void 0;var Bv=Rv,Dv=n(52),Lv=n(79),Mv=n(20),_v=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.message=void 0,n.createBackground(),n.createMessage(),n.createOKButton(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setMessage=function(e){this.message.setText(e)},n.createBackground=function(){var e=new Mv.Z(this.scene,0,0,340,160,20,16579837);e.setAlpha(.95),this.add(e),this.bg=e,this.setSize(e.width,e.height)},n.createMessage=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Hello, world!",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setTint(1907997),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-24),this.message=e,this.add([e])},n.createOKButton=function(){var e=this,t=new Lv.Z(this.scene,300,40,12,3774208);t.setName("OK"),t.onClick=function(){e.scene.screen.close(de.o4.NOTIFICATION_SCREEN)};var n=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(16),text:"OK",origin:{x:.5,y:.5}});n.setTint(16579837),Phaser.Display.Align.In.Center(n,t,0),t.add([n]),Phaser.Display.Align.In.BottomCenter(t,this.bg,0,-16),this.add([t])},t}(Phaser.GameObjects.Container),Nv=_v,Gv=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).slideInAnimation=void 0,a.fadeInAnimation=void 0,a.fadeOutAnimation=void 0,a.notificationContainer=void 0,a.setDepth(de.Ks.POPUP),a.notificationContainer=new Nv(t),a.add(a.notificationContainer),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t);var n=this.data.list.message,i=void 0===n?"":n;this.notificationContainer.setMessage(i),this.notificationContainer.setAlpha(1),this.background.setAlpha(.8),this.notificationContainer.setInteractive(),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e;null!=(e=this.fadeInAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.fadeInAnimation||(this.fadeInAnimation=new _h.Z({targets:[this],duration:300})),this.fadeInAnimation.play())},n.runCloseAnimation=function(){var t,n=this;null!=(t=this.fadeOutAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new Dv.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(n)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),Fv=Gv,Zv=function(e){function t(t,n,i,r,a){var s;return(s=e.call(this,t,r,a)||this).levelText=void 0,s.ribbon=void 0,s.create(n,i),s}(0,f.Z)(t,e);var n=t.prototype;return n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.setFrame=function(e){this.ribbon.setFrame(e)},n.setColor=function(e){var t=Phaser.Display.Color.IntegerToColor(e),n="rgba("+t.red+", "+t.green+", "+t.blue+", 1)";this.levelText.setColor(n)},n.create=function(e,t){this.ribbon=this.scene.add.image(0,0,e,t),this.ribbon.setDefaultWorldSize(),this.setSize(this.ribbon.width,this.ribbon.height);var n=new Qp(this.scene,{text:"Level 99",fontSize:this.scene.fontSize(14),fillColor:9461418});this.add([this.ribbon,n]),n.setPosition(0,1),this.levelText=n},t}(Phaser.GameObjects.Container),Uv=Zv,Wv=Ki.Z.DEFAULT,Yv=Wv.KEY,Hv=Wv.FRAME,zv=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).countText=void 0,r.icon=void 0,r.create(),r}(0,f.Z)(t,e);var n=t.prototype;return n.showCount=function(){this.countText.revive(),this.icon.setFrame(Hv.PLAY_SCREEN.ICON_ORANGE)},n.updateCount=function(e){var t=e<100?""+e:"99+";this.countText.setText(t)},n.showIconPlus=function(){this.icon.revive(),this.icon.setFrame(Hv.PLAY_SCREEN.ICON_ADD),this.countText.kill()},n.showIconCheckMark=function(){this.icon.setFrame(Hv.PLAY_SCREEN.ICON_CHECK_MARK),this.countText.kill()},n.create=function(){var e=this.scene.add.image(0,0,Yv,Hv.PLAY_SCREEN.ICON_ORANGE);e.setDefaultWorldSize(),this.setSize(e.displayWidth,e.displayHeight);var t=new Qp(this.scene,{text:"99",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,origin:{x:.5,y:.5}});t.setPadding(2,0,2,0),this.add([e,t]),this.countText=t,this.icon=e,t.setPosition(1/3,-1/3)},t}(Phaser.GameObjects.Container),Kv=zv,Vv=Ki.Z.DEFAULT,Xv=Vv.KEY,jv=Vv.FRAME,qv=function(e){function t(t){var n;return(n=e.call(this,t)||this).boosterFrame=void 0,n.boosterIcon=void 0,n.boosterIconGlow=void 0,n.create(),n}return(0,f.Z)(t,e),t.prototype.create=function(){var e=this.scene.add.image(0,1,Xv,jv.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN);e.setDefaultWorldSize(),this.add(e),this.boosterFrame=e;var t=this.scene.add.image(0,-3,Xv,jv.PLAY_SCREEN.BOOSTER.GOLD_WILD);t.setDefaultWorldSize(),this.add(t),this.boosterIcon=t;var n=this.scene.add.image(0,-3,Xv,jv.PLAY_SCREEN.EFFECTS.GLOW);n.setDefaultWorldSize(),n.setScale(.5,.8),n.setAlpha(0),n.setBlendMode(Phaser.BlendModes.ADD),this.add(n),this.boosterIconGlow=n},t}(Phaser.GameObjects.Container),Jv=qv,Qv=12881247,$v=12865613,ey=9790129,ty=Ki.Z.DEFAULT,ny=ty.KEY,iy=ty.FRAME,ry=function(e){function t(t,n,i){var r;return(r=e.call(this,t,79,227/3)||this).scene=void 0,r.selected=void 0,r.amount=void 0,r.isLock=void 0,r.frame=void 0,r.boosterBlock=void 0,r.countBlock=void 0,r.requiredLevelRibbon=void 0,r.background=void 0,r.tapAnim=void 0,r.downTweens=void 0,r.upTweens=void 0,r.scene=t,r.selected=!1,r.amount=0,r.isLock=!1,r.frame=iy.PLAY_SCREEN.NORMAL,r.createBackground(),r.createBoosterBlock(n,i),r.createRequiredLevelRibbon(),r.createUnlockContainer(),r}(0,f.Z)(t,e);var n=t.prototype;return n.setRequiredLevel=function(e){this.requiredLevelRibbon.setLevel(e)},n.lock=function(){this.isLock=!0,this.boosterBlock.boosterFrame.setFrame(this.frame.BOOSTER.ICON_PLATE_LOCK),this.boosterBlock.boosterIcon.kill(),this.requiredLevelRibbon.revive(),this.countBlock.kill(),this.setDisabled(!0)},n.unlock=function(){this.isLock=!1,this.selected,this.boosterBlock.boosterFrame.setFrame(iy.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.boosterBlock.boosterIcon.revive(),this.requiredLevelRibbon.kill(),this.countBlock.revive(),this.setDisabled(!1)},n.setSelected=function(e){this.selected=e,e?(this.countBlock.showIconCheckMark(),this.boosterBlock.boosterFrame.setFrame(iy.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN)):(this.boosterBlock.boosterFrame.setFrame(iy.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.setAvailableAmount(this.amount))},n.setDifficulty=function(e){var t=Qv;switch(e){case Jh.NORMAL:this.frame=iy.PLAY_SCREEN.NORMAL;break;case Jh.HARD:this.frame=iy.PLAY_SCREEN.HARD,t=$v;break;case Jh.SUPER_HARD:this.frame=iy.PLAY_SCREEN.SUPER_HARD,t=ey}this.boosterBlock.boosterFrame.setFrame(this.isLock?this.frame.BOOSTER.ICON_PLATE_LOCK:iy.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.background.setFrame(this.frame.BOOSTER.ICON_PLATE_OUT),this.requiredLevelRibbon.setFrame(this.frame.BOOSTER.LEVEL_PANEL),this.requiredLevelRibbon.setColor(t)},n.setAvailableAmount=function(e){this.amount=e,0===e?(this.countBlock.updateCount(0),this.countBlock.showIconPlus()):(this.countBlock.updateCount(e),this.countBlock.showCount())},n.updateData=function(e){e&&(this.isLock||(this.setAvailableAmount(e.amount),this.setSelected(e.selected)))},n.createBackground=function(){var e=this.scene.add.image(0,0,ny,this.frame.BOOSTER.ICON_PLATE_OUT);e.setDefaultWorldSize(),this.add(e),this.background=e},n.createBoosterBlock=function(e,t){var n=new Jv(this.scene);n.boosterIcon.setTexture(e,t),n.boosterIcon.setDefaultWorldSize(),this.add(n),this.boosterBlock=n},n.createRequiredLevelRibbon=function(){var e=new Uv(this.scene,ny,this.frame.BOOSTER.LEVEL_PANEL);e.setPosition(0,26.75),this.add(e),this.requiredLevelRibbon=e},n.createUnlockContainer=function(){var e=new Kv(this.scene);e.setPosition(29.5,76/3),this.add(e),this.countBlock=e},n.onPointerDown=function(){var e;null==(e=this.upTweens)||e.forEach((function(e){return e.remove()}));var t=1/GameCore.ImageScale;this.downTweens=[this.scene.add.tween({targets:[this.boosterBlock,this.countBlock],scale:.925,duration:100,ease:Phaser.Math.Easing.Back.Out,easeParams:[0]}),this.scene.add.tween({targets:[this.boosterBlock.boosterIcon],scale:t,duration:100,ease:Phaser.Math.Easing.Sine.Out})]},n.onPointerUp=function(){this.animationPointerUp()},n.onCancel=function(){this.animationPointerUp()},n.animationPointerUp=function(){var e;null==(e=this.downTweens)||e.forEach((function(e){return e.remove()}));var t=1/GameCore.ImageScale;this.upTweens=[this.scene.add.tween({targets:[this.boosterBlock,this.countBlock],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]}),this.scene.add.tween({targets:[this.boosterBlock.boosterIcon],scale:t,duration:300,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})],this.isLock||(this.boosterBlock.boosterIconGlow.alpha=0,this.upTweens.push(this.scene.add.tween({targets:[this.boosterBlock.boosterIconGlow],alpha:.2,duration:150,yoyo:!0})))},t}(jp.Z),ay=ry,sy=function(e){function t(t,n){var i;(i=e.call(this,t)||this).buttonWidth=void 0,i.buttonHeight=void 0,i.buttonInnerWidth=void 0,i.button=void 0,i.background=void 0;var r=n.key,a=n.buttonFrame,s=n.buttonWidth,o=n.buttonHeight,c=n.buttonInnerWidth;return i.buttonWidth=s,i.buttonHeight=o,i.buttonInnerWidth=c||0,i.setSize(i.buttonWidth,i.buttonHeight),i.createButton(r,a),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignBackground=function(e,t){this.background.setPosition(e,t)},n.createButton=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:0==this.buttonInnerWidth?this.width-19/3:this.buttonInnerWidth,height:this.height-23/3});this.button=new jp.Z(this.scene,n.displayWidth,n.displayHeight,.95),this.add(this.button),this.button.add(n)},n.setDisabled=function(e){this.button.setDisabled(e)},n.addIntoButton=function(e){this.button.add(e)},(0,X.Z)(t,[{key:"onClick",set:function(e){this.button.onClick=e}}]),t}(Phaser.GameObjects.Container),oy=sy,cy=Ki.Z.DASHBOARD,hy=cy.KEY,uy=cy.FRAME,ly=function(e){function t(t){var n;return(n=e.call(this,t,{key:hy,buttonFrame:uy.BUTTON.BUTTON.NEW_GREEN,buttonWidth:436/3,buttonHeight:42,buttonInnerWidth:436/3})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.setSize(n.width,n.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new Qp(this.scene,{text:this.scene.lang.Text.play,fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.buttonText=e,this.addIntoButton(this.buttonText),this.buttonText.setPosition(0,-2)},t}(oy),dy=ly,py=function(e){function t(t,n){var i;i=e.call(this,t)||this;var r=n.key,a=n.frame,s=n.width,o=n.height,c=n.topHeight,h=n.bottomHeight;i.setSize(s,o);var u=i.scene.make.nineslice({key:r,frame:a,height:o,topHeight:c,bottomHeight:h,width:s/2});u.setOrigin(1,.5);var l=i.scene.make.nineslice({key:r,frame:a,height:o,topHeight:c,bottomHeight:h,width:s/2});return l.setOrigin(1,.5),l.scaleX=-l.scaleX,i.add(u),i.add(l),i.scene.add.existing((0,yc.Z)(i)),i}return(0,f.Z)(t,e),t.prototype.setFrame=function(e){this.list.forEach((function(t){t instanceof Phaser.GameObjects.NineSlice&&t.setFrame(e)}))},t}(Phaser.GameObjects.Container),fy=py,my=function(e){function t(t,n,i){var r,a=(r=e.call(this,t)||this).scene.add.image(0,0,n,i);a.setOrigin(1,.5),a.setDefaultWorldSize();var s=r.scene.add.image(0,0,n,i);return s.setOrigin(1,.5),s.setDefaultWorldSize(),s.scaleX=-s.scaleX,r.setSize(2*a.displayWidth,2*a.displayHeight),r.add(a),r.add(s),r.scene.add.existing((0,yc.Z)(r)),r}return(0,f.Z)(t,e),t.prototype.setFrame=function(e){this.list.forEach((function(t){t instanceof Phaser.GameObjects.Image&&t.setFrame(e)}))},t}(Phaser.GameObjects.Container),gy=my,vy=Ki.Z.DEFAULT,yy=vy.KEY,Ey=vy.FRAME,Cy=11167815,wy=13718342,Ay=10768064,by="Normal Level",Sy="Hard Level",Ty="Super Hard Level",xy={width:326,height:949/3},ky=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,i,r)||this).scene=void 0,a.levelText=void 0,a.screenKey=void 0,a.frame=void 0,a.sliceButton=void 0,a.stormButton=void 0,a.wildCardButton=void 0,a.closeButton=void 0,a.playButton=void 0,a.bgReward=void 0,a.case=void 0,a.star=void 0,a.star2=void 0,a.star3=void 0,a.xContainer=void 0,a.rewardChestAdd=void 0,a.rewardChestAdd2=void 0,a.topCaseAdd1=void 0,a.topCaseAdd2=void 0,a.topCaseAdd3=void 0,a.topCaseAdd4=void 0,a.boneStar=void 0,a.boneStar2=void 0,a.boneStar3=void 0,a.ribbon=void 0,a.rewardText=void 0,a.background=void 0,a.boosterText=void 0,a.titleDecoration=void 0,a.rewardBackground=void 0,a.scene=t,a.screenKey=n,a.setSize(xy.width,xy.height),a.frame=Ey.PLAY_SCREEN.NORMAL,a.create(),a.scene.add.existing((0,yc.Z)(a)),a}(0,f.Z)(t,e);var n=t.prototype;return n.updateBoostersWithSettings=function(){var e=this.scene.gameSettings.requiredLevels,t=this.scene.level.getLevel();this.sliceButton.setRequiredLevel(e.boosterSlice),this.stormButton.setRequiredLevel(e.boosterStorm),this.wildCardButton.setRequiredLevel(e.boosterWildCard),t>=e.boosterSlice?this.sliceButton.unlock():this.sliceButton.lock(),t>=e.boosterStorm?this.stormButton.unlock():this.stormButton.lock(),t>=e.boosterWildCard?this.wildCardButton.unlock():this.wildCardButton.lock()},n.setDifficulty=function(e){var t=Cy,n=by;switch(e){case Jh.NORMAL:this.frame=Ey.PLAY_SCREEN.NORMAL,t=Cy,n=by;break;case Jh.HARD:this.frame=Ey.PLAY_SCREEN.HARD,t=wy,n=Sy;break;case Jh.SUPER_HARD:this.frame=Ey.PLAY_SCREEN.SUPER_HARD,t=Ay,n=Ty}var i=Phaser.Display.Color.IntegerToColor(t),r="rgba("+i.red+", "+i.green+", "+i.blue+", 1)";this.levelText.setColor(r),this.titleDecoration.setFrame(e===Jh.NORMAL?Ey.COMMON.TITLE_DECOR:this.frame.TITLE_DECOR),this.background.setFrame(this.frame.POPUP_BASE),this.boosterText.setText(n),this.boosterText.setColor(r),this.rewardBackground.setFrame(this.frame.REWARD_CHEST_BG),this.closeButton.button.setFrame(e===Jh.NORMAL?Ey.COMMON.BTN_CLOSE:this.frame.CLOSE),this.sliceButton.setDifficulty(e),this.stormButton.setDifficulty(e),this.wildCardButton.setDifficulty(e)},n.setButtonsDisable=function(e){this.sliceButton.setDisabled(e),this.stormButton.setDisabled(e),this.wildCardButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setDisabled(e),this.sliceButton.setAlpha(1),this.stormButton.setAlpha(1),this.wildCardButton.setAlpha(1),this.closeButton.setAlpha(1),this.playButton.setAlpha(1)},n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.runEntranceAnimation=function(e){var t=[this.sliceButton,this.stormButton,this.wildCardButton],n=this.scene.tweens.createTimeline({onComplete:e});return t.forEach((function(e,t){e.setScale(0),n.add({targets:[e],scale:{from:.75,to:1},ease:Phaser.Math.Easing.Back.Out,duration:150,delay:0==t?100:0,offset:0==t?0:"-=100"})})),n.playAndWaitForCompletion()},n.setBgRewardBlendModes=function(e){this.rewardChestAdd.setBlendMode(e),this.rewardChestAdd2.setBlendMode(e),this.topCaseAdd1.setBlendMode(e),this.topCaseAdd2.setBlendMode(e),this.topCaseAdd3.setBlendMode(e),this.topCaseAdd4.setBlendMode(e),this.star.setBlendMode(e),this.star2.setBlendMode(e),this.star3.setBlendMode(e)},n.create=function(){this.setSize(xy.width,xy.height),this.createBackground(),this.createBgReward(),this.createCloseButton(),this.createLevelText(),this.createBoostersText(),this.createBoosterButtons(),this.createPlayButton()},n.createBackground=function(){var e=new fy(this.scene,{key:yy,frame:this.frame.POPUP_BASE,topHeight:200/3,bottomHeight:200/3,width:xy.width,height:xy.height});this.add(e),this.background=e},n.createBgReward=function(){this.bgReward=this.scene.add.container(0,-197.5/3),this.add(this.bgReward);var e=new gy(this.scene,yy,this.frame.REWARD_CHEST_BG);e.setY(18.5/3),this.bgReward.add(e),this.rewardBackground=e,this.case=this.scene.add.container(-9.5/3,5/3),this.bgReward.add(this.case);var t=this.scene.add.image(10.625/3,-6.177/3,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST);t.setDefaultWorldSize(),this.case.add(t),t.setAlpha(1);var n=this.scene.add.image(46.09/3,-4.087,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST_ADD_1);n.setDefaultWorldSize(),n.setAlpha(0),n.setBlendMode(Phaser.BlendModes.ADD),this.case.add(n),this.rewardChestAdd=n;var i=this.scene.add.image(-9.3386/3,-19.057/3,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST_ADD_2);i.setDefaultWorldSize(),i.setAlpha(0),i.setBlendMode(Phaser.BlendModes.ADD),this.case.add(i),this.rewardChestAdd2=i;var r=this.scene.add.image(-43.292/3,-70.958/3,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_1);r.setDefaultWorldSize(),r.setAlpha(0),r.setBlendMode(Phaser.BlendModes.ADD),this.case.add(r),this.topCaseAdd1=r;var a=this.scene.add.image(16.736/3,-78.322/3,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_2);a.setDefaultWorldSize(),a.setAlpha(0),a.setBlendMode(Phaser.BlendModes.ADD),this.case.add(a),this.topCaseAdd2=a;var s=this.scene.add.image(23.957/3,-25.727,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_3);s.setDefaultWorldSize(),s.setAlpha(0),s.setBlendMode(Phaser.BlendModes.ADD),this.case.add(s),this.topCaseAdd3=s;var o=this.scene.add.image(20.755/3,-83.327/3,yy,Ey.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_4);o.setDefaultWorldSize(),o.setAlpha(0),o.setBlendMode(Phaser.BlendModes.ADD),this.case.add(o),this.topCaseAdd4=o;var c=this.scene.add.container(23,-32.301/3);this.bgReward.add(c),this.boneStar=c,this.star=this.scene.add.image(.8/3,-.3651/3,yy,Ey.PLAY_SCREEN.EFFECTS.STAR),this.star.setDefaultWorldSize(),this.star.setBlendMode(Phaser.BlendModes.ADD),c.add(this.star);var h=this.scene.add.container(-135.288/3,55.483/3);this.bgReward.add(h),this.boneStar2=h,this.star2=this.scene.add.image(.8/3,-.3651/3,yy,Ey.PLAY_SCREEN.EFFECTS.STAR),this.star2.setDefaultWorldSize(),this.star2.setBlendMode(Phaser.BlendModes.ADD),h.add(this.star2);var u=this.scene.add.container(59,7);this.bgReward.add(u),this.boneStar3=u,this.star3=this.scene.add.image(.8/3,-.3651/3,yy,Ey.PLAY_SCREEN.EFFECTS.STAR),this.star3.setDefaultWorldSize(),this.star3.setBlendMode(Phaser.BlendModes.ADD),u.add(this.star3);var l=this.scene.add.container(0,110.5/3);this.bgReward.add(l)},n.createCloseButton=function(){this.xContainer=this.scene.add.container(137,-100),this.add(this.xContainer);var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new ov.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:38/3,height:13,paddingZone:30});i.setName("Close"),this.xContainer.add(i),this.closeButton=i},n.createLevelText=function(){this.levelText=new Qp(this.scene,{text:"Level 9999",fontSize:this.scene.fontSize(19),fillColor:Cy}),this.add(this.levelText),this.titleDecoration=this.scene.add.image(0,1,yy,Ey.COMMON.TITLE_DECOR),this.titleDecoration.setDefaultWorldSize(),this.add(this.titleDecoration),this.levelText.setPosition(0,-405.5/3),this.titleDecoration.setPosition(0,-119.5)},n.createBoostersText=function(){var e=new Qp(this.scene,{text:this.scene.lang.Text.selectBoosters,fontSize:this.scene.fontSize(15),fillColor:Cy});this.add(e),e.setPosition(0,-2),this.boosterText=e},n.createBoosterButtons=function(){var e=new ay(this.scene,yy,Ey.PLAY_SCREEN.BOOSTER.THREE_SLICE);e.setName("SliceBooster");var t=new ay(this.scene,yy,Ey.PLAY_SCREEN.BOOSTER.WIND);t.setName("StormBooster");var n=new ay(this.scene,yy,Ey.PLAY_SCREEN.BOOSTER.GOLD_WILD);n.setName("WildCardBooster"),this.add([e,t,n]),e.setPosition(-261.5/3,160/3),t.setPosition(0,160/3),n.setPosition(261.5/3,160/3),this.sliceButton=e,this.stormButton=t,this.wildCardButton=n},n.createPlayButton=function(){var e=new dy(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e,this.playButton.setPosition(-.5,126)},n.handleBoosterOnClick=function(e,t){var n=t.selected,i=t.amount;if(!t.isLock){if(i<=0)return this.getBuyingBoosterData(e);n?this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.UN_SELECT_BOOSTER):this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.SELECT_BOOSTER),t.setSelected(!n),this.scene.events.emit(Iu.Z.BOOSTER_SELECTED)}},n.getBuyingBoosterData=function(e){var t={title:"",boosterFrame:"",description:"",cost:300,key:ji.NONE},n={cost:{boosterSlice:zd.cost.boosterSlice,boosterStorm:zd.cost.boosterStorm,boosterWildCard:zd.cost.boosterWildCard}},i=this.scene.level.getLevelData();switch(i&&(n=i.settings.mapProperties),e){case ji.SLICE:(t=$i.SLICE).cost=n.cost.boosterSlice;break;case ji.STORM:(t=$i.STORM).cost=n.cost.boosterStorm;break;case ji.WILD_CARD:(t=$i.WILD_CARD).cost=n.cost.boosterWildCard}return(0,p.Z)({previousScreenKey:this.screenKey},t)},(0,X.Z)(t,[{key:"onBoosterClick",set:function(e){var t=this;this.sliceButton.onClick=function(){var n=t.handleBoosterOnClick(ji.SLICE,t.sliceButton);e(n)},this.stormButton.onClick=function(){var n=t.handleBoosterOnClick(ji.STORM,t.stormButton);e(n)},this.wildCardButton.onClick=function(){var n=t.handleBoosterOnClick(ji.WILD_CARD,t.wildCardButton);e(n)}}}]),t}(Phaser.GameObjects.Container),Py=ky,Iy=Ki.Z.DEFAULT,Oy=(Iy.KEY,Iy.FRAME,function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.boostersContainer=void 0,o.handleCancel=function(){o.scene.screen.close(o.name);var e=o.scene.level.getLevel();o.scene.screen.open(de.o4.DASHBOARD_SCREEN,{level:e})},o.replayGame=function(){var e=o.scene.gameplay,t=o.boostersContainer,n=t.sliceButton,i=t.stormButton,r=t.wildCardButton,a={slice:n.selected,storm:i.selected,wildCard:r.selected};o.setButtonsDisable(!0),e.boosterManager.enableBoosters(a),e.start(),o.scene.screen.close(o.name)},o.onEntranceCompleted=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.scene.handleShowInterstitialAd();case 2:o.runAnimationShowButtons(),o.setButtonsDisable(!1),o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}));case 5:case"end":return e.stop()}}),e)}))),o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o))},o.scene=t,o.create(),o.setButtonsDisable(!0),o.background.setAlpha(de.MR.ALPHA.COMMON),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.setButtonsDisable(!1),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.scene.gameUI.coinBarButton.setDisabled(!0),this.updateData(t),this.runEntranceAnimation()},n.updateData=function(e){var t,n=this.boostersContainer,i=n.sliceButton,r=n.stormButton,a=n.wildCardButton,s=null==(t=this.data)?void 0:t.list,o=s.level,c=void 0===o?1:o,h=s.difficulty,u=void 0===h?Jh.NORMAL:h,l=e,d=l.slice,p=l.storm,f=l.wildCard;this.boostersContainer.setLevel(c),this.boostersContainer.setDifficulty(u),this.boostersContainer.updateBoostersWithSettings(),i.updateData(d),r.updateData(p),a.updateData(f)},n.create=function(){var e=this,t=new Py(this.scene,de.o4.NO_MORE_MOVES_SCREEN);this.add(t),this.boostersContainer=t;var n=t.closeButton,i=t.playButton;n.onClick=this.handleCancel,i.setText(this.scene.lang.Text.replay),i.setName("Replay"),i.onClick=this.replayGame,t.onBoosterClick=function(t){t&&(e.scene.screen.open(de.o4.BUYING_BOOSTER_SCREEN,t),e.scene.screen.close(e.name))}},n.setButtonsDisable=function(e){this.boostersContainer.setButtonsDisable(e)},n.close=function(){this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!1),this.runExitAnimation()},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.hideButtons(),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.runEntrancePopup(),this.boostersContainer.runEntranceAnimation(this.onEntranceCompleted);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntrancePopup=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.boostersContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hideButtons=function(){this.boostersContainer.playButton.setAlpha(0)},n.runAnimationShowButtons=function(){var e=this.boostersContainer.playButton;return this.scene.tweens.add({targets:[e],alpha:{from:0,to:1},duration:300}).waitForCompletion()},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.boostersContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen)),Ry=Oy,By=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.backgroundChangingAnimation=void 0,n.oldBackgroundMockup=void 0,n.scene=t,n}(0,f.Z)(t,e);var n=t.prototype;return n.skipAnimation=function(){var e,t;null==(e=this.backgroundChangingAnimation)||e.stop(),null==(t=this.oldBackgroundMockup)||t.kill()},n.playAnimation=function(e,t){var n,i=this;void 0===t&&(t=1e3),null!=(n=this.backgroundChangingAnimation)&&n.isPlaying()||(this.updateOldBackgroundMockup(e),this.backgroundChangingAnimation=this.scene.tweens.addCounter({from:255,to:0,duration:t,onUpdate:function(e){var t=e.getValue();i.oldBackgroundMockup.setAlpha(t/255)},onComplete:function(){i.oldBackgroundMockup.kill()}}))},n.updateOldBackgroundMockup=function(e){var t=e.key,n=e.frame,i=e.alpha,r=e.tint,a=e.width,s=e.height,o=e.scale,c=this.scene.background,h=c.x,u=c.y;this.oldBackgroundMockup?this.oldBackgroundMockup.setTexture(t,n):this.oldBackgroundMockup=this.scene.add.image(0,0,t,n),this.oldBackgroundMockup.setAlpha(i),this.oldBackgroundMockup.setTint(r),this.oldBackgroundMockup.setWorldSize(a,s),this.oldBackgroundMockup.setScale(o),this.oldBackgroundMockup.setDepth(this.scene.background.depth+.1),this.oldBackgroundMockup.setPosition(h,u),this.oldBackgroundMockup.revive()},t}(Pp),Dy=Ki.Z.DEFAULT,Ly=Dy.KEY,My=Dy.FRAME,_y=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.alignY=-126,i.debugButtons=[],i.isShowDebugButtons=!1,i.scene=t,i.boardGame=n,i.init(),i}(0,f.Z)(t,e);var r=t.prototype;return r.start=function(){e.prototype.start.call(this),this.createNextLevelBtn(),this.createAddCoinsBtn(),this.createWinBtn(),this.createAutoPlayStepBtn(),this.createStormBtn(),this.createSliceBtn(),this.createPlusCardsBtn(),this.createWildCardBtn(),this.createFullScreenBtn(),this.createDevToolsPanel(),this.addKeyboardShortcutForScreenshot(),this.showDebugButtons(this.isShowDebugButtons)},r.showDebugButtons=function(e){this.debugButtons.forEach((function(t){e?t.revive():t.kill()})),this.isShowDebugButtons=e},r.createDevToolsPanel=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(498),n.e(377)]).then(n.bind(n,97));case 2:new(0,e.sent.default)(this.scene);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.draw=function(){var e=this.boardGame.hint,t=this.boardGame.stock,n=this.boardGame.pile,i=(this.scene.gameplay.coinUsingManager,n.getCardsWithType(nu.KEY)),r=e.getPileMatchableCards();if(i.length>0){var a=i[Phaser.Math.Between(0,i.length-1)];this.boardGame.stateMachine.emit(tu.DRAW_PILE,a)}else if(r.length>0){var s=e.getCardWithLongestChain(r);s&&this.boardGame.stateMachine.emit(tu.DRAW_PILE,s)}else n.cards.length>0&&t.cards.length>0?this.boardGame.stateMachine.emit(tu.DRAW_STOCK):this.boardGame.stateMachine.emit(tu.REFILL_STOCK)},r.createNextLevelBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Next\nLevel",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("NextLevel"),t.onClick=function(){e.scene.screen.close("DASHBOARD_SCREEN"),e.scene.player.setLevel(e.scene.level.getLevel()+1),e.scene.level.setLevel(e.scene.level.getLevel()+1),e.scene.tweens.killAll(),e.scene.gameplay.start()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createAddCoinsBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Add\nCoins",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("AddCoins"),t.onClick=function(){var t=e.scene.player.getCoins();e.scene.player.setCoins(t+5e4)},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createWinBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Win\nGame",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Win"),t.onClick=function(){e.scene.gameplay.boardGame.win()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createAutoPlayStepBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Auto\nPlay",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("AutoPlay"),t.onClick=function(){e.draw()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createStormBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Storm\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Storm"),t.onClick=function(){e.scene.gameplay.boosterManager.stormBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createSliceBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Slice\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Slice"),t.onClick=function(){e.scene.gameplay.boosterManager.sliceBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,-0,this.alignY),this.alignY+=25},r.createPlusCardsBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Plus\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("PlusCards"),t.onClick=function(){e.scene.gameplay.boosterManager.plusFiveCardsBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createWildCardBtn=function(){var e=this,t=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Wild\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("WildCard"),t.onClick=function(){e.scene.gameplay.boosterManager.wildCardBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.createFullScreenBtn=function(){var e=new Vc.Z(this.scene,Ly,My.BLANK,24,24);this.debugButtons.push(e);var t=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Full\nScreen",origin:{x:.5,y:.5},y:0});t.setCenterAlign(),e.add(t),e.setName("FullScreen"),e.onClick=function(){var e=document.getElementById("app");null==e||e.requestFullscreen()},Phaser.Display.Align.In.LeftCenter(e,this.scene.gameZone,0,this.alignY),this.alignY+=25},r.addKeyboardShortcutForScreenshot=function(){window.addEventListener("keydown",(function(e){"s"==e.key&&requestAnimationFrame((function(){var e=document.getElementsByTagName("canvas")[0].toDataURL("png"),t=document.createElement("a");t.download=document.title.toLocaleLowerCase().replaceAll(" ","_")+"_"+Date.now(),t.href=e,t.dataset.downloadurl=["image/png",t.download,t.href].join(":"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))}))},t}(Pp),Ny=_y,Gy=function(){function e(e){var t=this;this.scene=void 0,this.fps=void 0,this.avgFps=void 0,this.avgFpsInTime=void 0,this.countTimeToUpdateFps=void 0,this.countTimeToUpdateAvgFPS=void 0,this.countTimeToTrackFPS=void 0,this.reduceCanvasCanvasCount=void 0,this.update=function(e,n){t.countTimeToUpdateFps+=n,t.countTimeToUpdateAvgFPS+=n,t.countTimeToTrackFPS+=n,t.countTimeToUpdateFps<500||(t.countTimeToUpdateFps-=500,t.updateFps(),t.updateAvgFps(),t.updateAvgFpsInTime())},this.tryReduceCanvas=function(){if(!(t.reduceCanvasCanvasCount>=3)){var e=2;e=t.getAvgFpsInTime()>50||t.getAvgFpsInTime()>30?2:1.5;var n=Phaser.Math.Clamp(GameCore.Utils.Device.pixelRatio(),1,e);t.scene.world.resize(n),t.reduceCanvasCanvasCount+=1}},this.scene=e,this.countTimeToUpdateFps=0,this.countTimeToUpdateAvgFPS=this.reduceCanvasCanvasCount=0}var t=e.prototype;return t.getFps=function(){return this.fps},t.getAvgFps=function(){return Math.round(this.avgFps.average)},t.getAvgFpsInTime=function(){return this.avgFpsInTime.average},t.updateFps=function(){this.fps=this.scene.game.loop.actualFps},t.updateAvgFps=function(){this.avgFps.sum+=this.fps,this.avgFps.total+=1,this.avgFps.average=this.avgFps.sum/this.avgFps.total,this.avgFps.min>this.avgFps.average&&(this.avgFps.min=this.avgFps.average),this.avgFps.max<this.avgFps.average&&(this.avgFps.max=this.avgFps.average)},t.updateAvgFpsInTime=function(){this.avgFpsInTime.sum+=this.fps,this.avgFpsInTime.total+=1,this.countTimeToUpdateAvgFPS>4e3&&(this.avgFpsInTime.average=this.avgFpsInTime.sum/(this.avgFpsInTime.total||1),this.avgFpsInTime.sum=0,this.avgFpsInTime.total=0,this.countTimeToUpdateAvgFPS-=4e3,this.avgFpsInTime.min>this.avgFpsInTime.average&&(this.avgFpsInTime.min=this.avgFpsInTime.average),this.avgFpsInTime.max<this.avgFpsInTime.average&&(this.avgFpsInTime.max=this.avgFpsInTime.average))},t.reset=function(){this.fps=0,this.avgFps={sum:0,total:0,average:0,min:120,max:0},this.avgFpsInTime={sum:0,total:0,average:0,min:120,max:0}},t.start=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update),this.reset()},t.stop=function(){this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update)},e}(),Fy=Gy,Zy=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Phaser.Math.Vector2,e.abrupt("return",t.tweens.addCounter((0,p.Z)({},n,{onUpdate:function(e,t,r){n.curve.getPoint(t.value,i),n.target.x=i.x,n.target.y=i.y,n.angularVector&&(n.target.angle+=n.angularVector),n.onUpdate&&n.onUpdate(e,t,r)}})).waitForCompletion());case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Uy=Zy,Wy=function(){function e(e){this.boardGame=void 0,this.cards=[],this.x=void 0,this.y=void 0,this.name=void 0,this.boardGame=e,this.cards=[]}var t=e.prototype;return t.setName=function(e){this.name=e},t.getname=function(){return this.name},t.setPosition=function(e,t){this.x=e,this.y=t},t.addCard=function(e){0==this.cards.includes(e)&&this.cards.push(e)},t.addCardAt=function(e,t){void 0===t&&(t=0),0==this.cards.includes(e)&&this.cards.splice(t,0,e)},t.removeCard=function(e){var t=this.cards.indexOf(e);return t>=0&&(this.cards.splice(t,1),!0)},t.update=function(){},t.getPlacingPosition=function(){return{x:this.x,y:this.y}},t.clear=function(){this.cards=[]},t.isEmpty=function(){return 0===this.cards.length},t.getCardsLength=function(){return this.cards.length},e}(),Yy=function(e){function t(t){var n;return(n=e.call(this,t)||this).maxCardsShow=void 0,n.locked=void 0,n.lockedManual=void 0,n.totalUsedCards=void 0,n.draw=function(){if(!n.locked&&!n.lockedManual){var e=n.cards[n.cards.length-1];if(e){var t=n.boardGame.waste.getOnTopCard();(null==t?void 0:t.behavior.type)!==nu.JOKER&&(n.totalUsedCards+=1,n.boardGame.mover.moveToWaste({src:(0,yc.Z)(n),card:e,duration:300}),n.boardGame.waste.getCardsLength()>1&&(n.boardGame.mover.increaseMoves(),n.boardGame.onPlayerMove()),e.behavior.type!=nu.WINDMILL?n.boardGame.checkLose():e.behavior.activate())}}},n.maxCardsShow=16,n.totalUsedCards=0,n.setName(au.Stock),n.locked=!1,n.lockedManual=!1,n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.totalUsedCards=0},n.lockDrawByTime=function(e){this.setLocked(!0)},n.setLocked=function(e){this.locked=e},n.setLockedManual=function(e){this.lockedManual=e},n.isLocked=function(){return this.isLocked()},n.addCardAt=function(e,t){if(t){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.splice(t,0,e)}else this.addCard(e)},n.addCard=function(e){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.push(e)},n.align=function(){for(var e=this.cards.length,t=6*(e-1),n=0;n<e;n++){var i=this.cards[n];i.setVisible(n>=e-15);var r=this.x+6*Math.max(n,e-15)-t;i.setPosition(r,this.y)}},n.getPosition=function(e){var t=6*(this.cards.length-1),n=new Phaser.Geom.Point(0,0),i=this.cards.indexOf(e);return i>=0?(n.x=this.x+6*i-t,n.y=this.y):(n.x=this.x,n.y=this.y),n},n.getTotalCardsRemain=function(){return this.cards.length},t}(Wy),Hy=Ki.Z.EFFECTS,zy=Hy.KEY,Ky=Hy.FRAME,Vy=function(e){function t(t){var n;return(n=e.call(this,t,zy,Ky.FX_COMET)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setDepth(Ha.Z.PRIORITY+1),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:Ky.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.2*e,end:.4*e},lifespan:{min:200,max:300}})},n.explode=function(e,t,n){this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),Xy=Vy,jy=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.starsParticle=void 0,n.curveFromStreak=function(){var e=n.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),t=n.scene.gameplay.comboManager.streakBar.getWorldPositionOfCurrentItem();return{start:t,mid:{x:n.scene.world.getWorldSize().width/2+Phaser.Math.RND.between(-50,50),y:t.y-Phaser.Math.RND.between(-35,-5)},end:e,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.curveFromPoint=function(e,t){var i={x:e+Phaser.Math.RND.between(-5,5),y:t+ +Phaser.Math.RND.between(-5,5)},r=n.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),a=new Phaser.Math.Vector2(i.x-r.x,i.y-r.y),s=Phaser.Math.Clamp(a.length()/5,20,30),o=a.clone().scale(.1).negate().add(new Phaser.Math.Vector2(i.x,i.y)),c=Phaser.Math.Vector2.DOWN.clone().scale(Phaser.Math.Between(0,s)).rotate(Phaser.Math.FloatBetween(0,2*Math.PI));return c.add(o),{start:i,mid:c,end:r,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.scene=t,n.createStarsEmitter(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.getChildren().forEach((function(e){e.setVisible(!1),e.setActive(!1)}))},n.runAnimationRewardCoinFromStreak=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.COINS_APPEAR),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON),this.scene.gameUI.coinBarButton.setDisabled(!0),n=[],i=0;i<t;i++)n.push(this.curveFromStreak());return e.next=7,this.runAnimationCoinsFlyingIntoBarAsync(n);case 7:this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runAnimationRewardCoinAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.COINS_APPEAR),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),this.scene.gameUI.coinBarButton.setDisabled(!0),r=[],s=0;s<t;s++)r.push(this.curveFromPoint(n,i));return e.next=7,this.runAnimationCoinsFlyingIntoBarAsync(r);case 7:this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.makeCoinFlyAsync=function(e){var t=e.start,n=e.mid,i=e.end,r=e.duration,a=e.delay,s=void 0===a?0:a,o=this.spawn();o.setScaleByWorld(1.25),o.setPosition(t.x,t.y),o.setAlpha(0);var c=new Phaser.Curves.Spline([t.x,t.y,n.x,n.y,i.x,i.y]),h=(i.y-t.y)*(t.x-n.x)+(t.x-i.x)*(t.y-n.y);return Uy(this.scene,{onStart:function(){o.setAlpha(1)},target:o,delay:s,curve:c,duration:r,rotateToCurve:!0,rotateOffset:0,angularVector:h>0?-15:15,onComplete:function(){o.kill()}})},n.runAnimationCoinsFlyingIntoBarAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),i=[],r=0;r<t.length;r++)t[r].delay=30*(t.length-r),s=this.makeCoinFlyAsync(t[r]),i.push(s);return this.setDepth(this.scene.gameUI.coinBarButton.depth+2),this.starsParticle.setDepth(this.scene.gameUI.coinBarButton.depth+1),Promise.any(i).then((function(){o.scene.gameUI.onCoinChanged()})),i.forEach((function(e){e.then((function(){o.scene.gameUI.coinBarButton.runBounceCoinButtonAnimation(),o.starsParticle.explode(14,n.x,n.y),o.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.COUNT_COINS,{},!0)}))})),e.abrupt("return",Promise.all(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.spawn=function(){var e=this.getFirstDead();return e||(e=this.addCoin()),e.revive(),e},n.addCoin=function(){var e=Ki.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.IC_COIN);return i.setDefaultWorldSize(),this.add(i),i},n.createStarsEmitter=function(){this.starsParticle=new Xy(this.scene)},t}(Phaser.GameObjects.Group),qy=jy,Jy=Ki.Z.GAMEPLAY_DEFAULT,Qy=Jy.KEY,$y=Jy.FRAME,eE=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).scene=void 0,r.text=void 0,r.icon=void 0,r.scene=t,r.create(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this.scene.add.image(0,0,Qy,$y.IC_COIN);e.setDefaultWorldSize();var t=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),text:"999",origin:{x:1,y:.55}});this.add([e,t]),this.icon=e,this.text=t},n.setCoin=function(e){this.text.setText(e.toString());var t=this.icon.width+this.text.width;this.text.setX(t/2),this.icon.setX(-t/2+8)},t}(Phaser.GameObjects.Container),tE=eE,nE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.spawn=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=this.getFirstDead();return n||(n=this.addCoin()),n.revive(),n.setPosition(e,t),n.setAlpha(1),this.scene.gameplayLayer.bringToTop(n),n},n.reset=function(){this.getChildren().forEach((function(e){e.kill()}))},n.getChildren=function(){return e.prototype.getChildren.call(this)},n.addCoin=function(){var e=new tE(this.scene,0,0);return this.add(e),this.scene.gameplayLayer.add(e),e},n.runAnimation=function(e){var t=e.coin,n=e.x,i=e.y,r=e.duration,a=void 0===r?800:r,s=e.offsetY,o=void 0===s?-40:s,c=e.delay,h=void 0===c?0:c,u=e.depth,l=void 0===u?Ha.Z.EFFECT:u,d=this.spawn(n,i);d.setCoin(t),d.setDepth(l);var p=this.scene.tweens.createTimeline();return d.setPosition(n,i),d.setAlpha(0),p.add({targets:d,x:n,y:i+o/2,duration:a/2,delay:h,onStart:function(){d.setAlpha(1)}}),p.add({targets:d,alpha:0,y:i+o,duration:a/2,onComplete:function(){d.kill()}}),p.play(),p},t}(Phaser.GameObjects.Group),iE=nE,rE=function(e){return e[e.MATCH=0]="MATCH",e[e.COMPLETED_LEVEL=1]="COMPLETED_LEVEL",e}({}),aE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.spawn=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var i=this.getFirstDead();return i||(i=this.addText()),i.setText(e),i.revive(),i.setPosition(t,n),i.setAlpha(1),this.scene.gameplayLayer.bringToTop(i),i},n.reset=function(){this.getChildren().forEach((function(e){e.kill()}))},n.getChildren=function(){return e.prototype.getChildren.call(this)},n.addText=function(){var e=this.scene.add.bitmapText(0,0,Rc.ZP.PRIMARY.KEY,"",this.scene.fontSize(20));return e.setOrigin(.5,.5),e.setDepth(Ha.Z.EFFECT),this.add(e),this.scene.gameplayLayer.add(e),e},n.runFlyUpAndFadeOutAnimation=function(e){var t=e.text,n=e.x,i=e.y,r=e.duration,a=void 0===r?800:r,s=e.offsetY,o=void 0===s?-40:s,c=e.delay,h=void 0===c?0:c,u=e.depth,l=void 0===u?Ha.Z.EFFECT:u,d=this.spawn(t,n,i);d.setDepth(l);var p=this.scene.tweens.createTimeline();return d.setPosition(n,i),d.setAlpha(0),p.add({targets:d,x:n,y:i+o/2,duration:a/2,delay:h,onStart:function(){d.setAlpha(1)}}),p.add({targets:d,alpha:0,y:i+o,duration:a/2,onComplete:function(){d.kill()}}),p.play(),p},t}(Phaser.GameObjects.Group),sE=aE,oE={DIFF_MATCH_COIN:1},cE=(function(e){e.PILE="pile",e.STOCK="stock"}({}),function(){function e(e){this.scene=void 0,this.rewardManager=void 0,this.matchCoins=void 0,this.totalStockCoins=void 0,this.scene=e,this.rewardManager=e.rewardManager,this.init()}var t=e.prototype;return t.init=function(){this.totalStockCoins=0,this.matchCoins=0},t.resetMatchReward=function(){},t.getTotalRewardedValue=function(){return this.matchCoins+this.totalStockCoins},t.matchReward=function(e,t){return 0},t.stockReward=function(e){var t=this.scene.gameSettings.reward.coinsPerStockCard;return this.rewardManager.isSpecialStockCard(e)&&(t*=2),this.totalStockCoins+=t,t},t.undo=function(e){0!=this.matchCoins&&(this.matchCoins-=oE.DIFF_MATCH_COIN)},t.runShowRewardedValueAnimForStock=function(e,t,n){this.scene.rewardManager.coinTextAnimationPool.runAnimation({coin:n,x:e,y:t,duration:370,offsetY:-15})},e}()),hE=cE,uE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.starsParticle=void 0,n.curveFromStreak=function(){var e=n.getTestingDestination(),t=n.scene.gameplay.comboManager.streakBar.getWorldPositionOfCurrentItem();return{start:t,mid:{x:n.scene.world.getWorldSize().width/2+Phaser.Math.RND.between(-50,50),y:t.y-Phaser.Math.RND.between(-35,-5)},end:e,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.curveFromPoint=function(e,t){var i={x:e,y:t},r=n.scene.gameUI.starBarButton.starBar.getWorldPositionOfStar(),a=new Phaser.Math.Vector2(i.x-r.x,i.y-r.y),s=Phaser.Math.Between(60,100),o=a.clone().scale(.1).negate().add(new Phaser.Math.Vector2(i.x,i.y)),c=Phaser.Math.Vector2.DOWN.clone().scale(Phaser.Math.Between(0,s)).rotate(7*Math.PI/4);return c.add(o),{start:i,mid:c,end:r,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(600,650)}},n.scene=t,n.createStarsEmitter(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.getChildren().forEach((function(e){e.setVisible(!1),e.setActive(!1)}))},n.runAnimationRewardStarAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Hc.Z.BOOSTERS.KEY,rc.Z.COINS_APPEAR),this.scene.gameUI.starBarButton.setDepth(Ha.Z.PRIORITY),this.scene.gameUI.starBarButton.setDisabled(!0),r=[],s=0;s<t;s++)r.push(this.curveFromPoint(n,i));return e.next=7,this.runAnimationStarsFlyingIntoBarAsync(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.makeStarFlyAsync=function(e){var t=e.start,n=e.mid,i=e.end,r=e.duration,a=e.delay,s=void 0===a?0:a,o=this.spawn();o.setScaleByWorld(1.25),o.setPosition(t.x,t.y),o.setAlpha(0);var c=new Phaser.Curves.Spline([t.x,t.y,n.x,n.y,i.x,i.y]),h=(i.y-t.y)*(t.x-n.x)+(t.x-i.x)*(t.y-n.y);return Uy(this.scene,{from:0,to:1,onStart:function(){o.setAlpha(1),o.setScale(1/GameCore.ImageScale),o.setAngle(0)},onUpdate:function(e,t,n){var i=e.getValue(),r=180*(h>0?i:-i),a=1+-.6666666666666667*i;o.setScale(a*(1/GameCore.ImageScale)),o.setAngle(r)},target:o,delay:s,curve:c,duration:r,rotateToCurve:!0,rotateOffset:0,onComplete:function(){o.kill()}})},n.getTestingDestination=function(){return{x:this.scene.gameZone.width-20,y:20}},n.runAnimationStarsFlyingIntoBarAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.scene.gameUI.starBarButton.starBar.getWorldPositionOfStar(),i=[],r=0;r<t.length;r++)t[r].delay=30*(t.length-r),s=this.makeStarFlyAsync(t[r]),i.push(s);return this.setDepth(this.scene.gameUI.starBarButton.depth+2),this.starsParticle.setDepth(this.scene.gameUI.starBarButton.depth+1),Promise.any(i).then((function(){o.scene.gameUI.onStarChanged()})),i.forEach((function(e){e.then((function(){o.scene.gameUI.starBarButton.runBounceStarButtonAnimation(),o.starsParticle.explode(20,n.x,n.y),o.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS,{},!0)}))})),e.abrupt("return",Promise.all(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.spawn=function(){var e=this.getFirstDead();return e||(e=this.addStar()),e.revive(),e},n.addStar=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.STAR);return i.setDefaultWorldSize(),this.add(i),i},n.createStarsEmitter=function(){this.starsParticle=new Xy(this.scene)},t}(Phaser.GameObjects.Group),lE=uE,dE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isDailyRewarding=void 0,n.rewardBehavior=void 0,n.coinTextAnimationPool=void 0,n.coinAnimationPool=void 0,n.textAnimationPool=void 0,n.starAnimationPool=void 0,n.rewardHeart=function(e,t){if(0!=e){var i=Ki.Z.GAMEPLAY_DEFAULT,r=i.KEY,a=i.FRAME,s=n.scene,o=n.scene.gameUI.lifeBarButton;o.setAutoUpdateHearts(!1),s.life.increaseHeart(e,!1),o.setAutoUpdateHearts(!0);var c=s.add.image(0,0,r,a.IC_HEART);c.setScaleByWorld(2),c.setDepth(Ha.Z.PRIORITY);var h={x:s.world.getWorldSize().width/2,y:s.world.getWorldSize().height/2-20},u={x:h.x-20,y:h.y+20},l=o.lifeBar.getIconHeartPos(),d=new Phaser.Curves.Spline([h.x,h.y,u.x,u.y,l.x,l.y]);c.setPosition(h.x,h.y),Uy(s,{target:c,curve:d,rotateToCurve:!1,rotateOffset:0,duration:1e3,delay:200,onComplete:function(){var e=n.scene.life.getHearts();o.lifeBar.updateHearts(e),t&&t()}}),c.setScale(0),c.setY(h.y+25);var p=s.tweens.createTimeline();p.add({targets:c,scale:1,y:h.y,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),p.add({targets:c,scale:.6,duration:1e3}),p.add({targets:c,alpha:0,scale:.8,duration:200}),p.play()}},n.scene=t,n.createCoinTextPool(),n.createCoinPool(),n.createTextPool(),n.createStarAnimationPool(),n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){var t;e.prototype.init.call(this),this.rewardBehavior=new hE(this.scene),null==(t=this.rewardBehavior)||t.init()},n.rewardCoin=function(e){var t=this.scene.player.getCoins();this.setCoins(t+e,!1)},n.rewardStar=function(e){var t=this.scene.player.getStar();this.setStars(t+e,!1)},n.getTotalRewardCoin=function(){return this.rewardBehavior.getTotalRewardedValue()},n.setCoins=function(e,t){var n=this.scene.gameUI.coinBarButton;0==t&&n.setAutoUpdateCoin(!1),this.scene.player.setCoins(e),n.setAutoUpdateCoin(!0)},n.setStars=function(e,t){var n=this.scene.gameUI.starBarButton;0==t&&n.setAutoUpdateStar(!1),this.scene.player.setStar(e),n.setAutoUpdateStar(!0)},n.undo=function(e){this.rewardBehavior.undo(e)},n.resetMatchReward=function(){this.rewardBehavior.resetMatchReward()},n.reward=function(e,t){var n=t||{},i=n.x,r=void 0===i?0:i,a=n.y,s=void 0===a?0:a,o=0,c=this.scene.player.getCoins();if(e===rE.MATCH)o=this.rewardBehavior.matchReward(r,s);this.scene.player.setCoins(c+o)},n.matchReward=function(e,t){this.rewardBehavior.matchReward(e,t)},n.runStockRewardAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.gameplay.boardGame.stock,n=[].concat(t.cards),i=[],r=1,s=n.length-1;case 5:if(!(s>=0)){e.next=16;break}return o=n[s],this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.COUNT_COINS),this.scene.audio.playAudioSprite(Hc.Z.CARD_COMBO.KEY,"n_card_"+r),r=Math.min(r+1,12),i.push(this.runCardRewardAnim(o)),e.next=13,(0,gl.Z)(this.scene,185);case 13:s--,e.next=5;break;case 16:return e.next=18,Promise.all(i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setRewardBehavior=function(e){this.rewardBehavior=e},n.isSpecialStockCard=function(e){return e.behavior.type==nu.JOKER||e.behavior.type==nu.WINDMILL},n.runCardRewardAnim=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.gameplay.boardGame.stock,i=this.scene.tweens.createTimeline(),r=this.rewardBehavior.stockReward(t),s=function(){n.cards.pop(),n.cards.length>=15&&n.animateAlignCards()},i.add({targets:t,y:n.y-50,duration:370,onStart:s,onComplete:function(){var e=t.x,n=t.y;o.rewardBehavior.runShowRewardedValueAnimForStock(e,n-40,r)}}),i.add({targets:t,alpha:0,duration:370}),e.next=8,i.playAndWaitForCompletion();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCoinTextPool=function(){var e=new iE(this.scene);this.coinTextAnimationPool=e},n.createCoinPool=function(){var e=new qy(this.scene);this.coinAnimationPool=e},n.createTextPool=function(){this.textAnimationPool=new sE(this.scene)},n.createStarAnimationPool=function(){this.starAnimationPool=new lE(this.scene)},t}(Pp),pE=dE,fE=function(e,t){this.x=void 0,this.y=void 0,this.x=e,this.y=t},mE=function(){function e(e,t){var n=this;this.boardGame=void 0,this.card=void 0,this.facingUp=void 0,this.type=void 0,this.value=void 0,this.suit=void 0,this.random=!0,this.effectedCard=void 0,this.setFacing=function(e){n.facingUp=e},this.boardGame=e,this.card=t,this.type=nu.UNKNOWN,this.value=-1,this.suit=-1}var t=e.prototype;return t.setValue=function(e,t){this.value=e,this.suit=t,this.type=nu.VALUE,this.random=!1},t.setFacingWithFlippingAnim=function(e,t){if(this.facingUp!==e){if(e&&this.random&&this.checkCardHasValue()){var n={value:Math.floor(13*Math.random()+1),suit:Math.floor(4*Math.random()+1)};(this.card.beginPlacement==au.Stock||this.card.beginPlacement==au.Pile)&&(n=this.boardGame.deck.getRandomValue()),this.value=n.value,this.suit=n.suit,this.random=!1}this.facingUp=e,t&&t()}},t.init=function(){},t.activate=function(e){0==this.facingUp&&this.setFacingWithFlippingAnim(!0),e&&e()},t.undo=function(){},t.onPlayerMove=function(){},t.getPoints=function(e){void 0===e&&(e=!0);var t=[],n=this.card.payload,i=n.x,r=n.y,a=new fE(i,r);e||(a=new fE(this.card.x,this.card.y));var s=new fE(a.x-22.5,a.y-34),o=new fE(a.x+22.5,a.y-34),c=new fE(a.x-22.5,a.y+34),h=new fE(a.x+22.5,a.y+34);t.push.apply(t,[s,o,h,c]);for(var u=0;u<4;u++){var l=this.card.payload.angle*(Math.PI/180),d=Math.cos(l),p=Math.sin(l),f=t[u].x-i,m=t[u].y-r;t[u].x=f*d-m*p+i,t[u].y=f*p+m*d+r}return t},t.isPlusCard=function(){return this.type==nu.PLUS_ONE||this.type==nu.PLUS_TWO||this.type==nu.PLUS_THREE||this.type==nu.PLUS_FOUR||this.type==nu.PLUS_FIVE},t.checkCardHasValue=function(){return this.type==nu.VALUE||this.type==nu.CHESTNUT||this.type==nu.BOOM||this.type==nu.CHANGER||this.type==nu.CHAIN},t.killItems=function(){},t.reviveItems=function(){},t.revive=function(){},t.kill=function(){},t.hide=function(){this.card.setVisible(!1)},t.show=function(){this.card.setVisible(!0)},t.update=function(e){},t.postUpdate=function(){},e}(),gE=mE,vE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).data=void 0,t}return(0,f.Z)(t,e),t.prototype.setData=function(e){this.data=e,this.value=e.value,this.suit=e.suit,this.random=e.random},t}(gE),yE=vE,EE=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.activate=function(){var e=this.boardGame.pile.handleWithLock(this.card);this.boardGame.mover.moveToWaste({src:this.boardGame.pile,card:this.card,duration:800,lockSegment:e})},t}(yE),CE=EE,wE=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEAR_DANGER=1]="NEAR_DANGER",e[e.DANGER=2]="DANGER",e}(wE||{}),AE=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).state=void 0,i.explodeTime=void 0,-1==n.payload.NumberOfMoves&&(n.payload.NumberOfMoves=Math.floor(11*Math.random()+10)),i.explodeTime=n.payload.NumberOfMoves,i}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.state=wE.NORMAL,this.type=nu.BOOM,this.setNumberOfMoves(this.explodeTime),e.prototype.init.call(this)},n.setNumberOfMoves=function(e){this.explodeTime=e,4==this.explodeTime&&this.state!=wE.NEAR_DANGER&&(this.state=wE.NEAR_DANGER),this.explodeTime<=3&&this.state!=wE.DANGER&&(this.state=wE.DANGER),this.explodeTime>4&&this.state!=wE.NORMAL&&(this.state=wE.NORMAL)},n.onPlayerMove=function(){this.explodeTime-=1,this.explodeTime<=0&&this.boardGame.lose()},t}(CE),bE=AE,SE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).isRising=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.isRising=1==this.data.CardChangerType,this.type=nu.CHANGER},n.onPlayerMove=function(){if(e.prototype.onPlayerMove.call(this),this.facingUp){var t=this.value;this.isRising?(t+=1)>Cu.KING&&(t=Cu.ACE):(t-=1)<Cu.ACE&&(t=Cu.KING),this.setValue(t,this.suit),this.type=nu.CHANGER}},t}(CE),TE=SE,xE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.CHESTNUT,e.prototype.init.call(this)},n.activate=function(){e.prototype.activate.call(this);var t=this.boardGame.pile.cards.filter((function(e){return e.isType(nu.SQUIRREL)}));if(0!=t.length){var n=this.getNearestSquirrelCard(t);this.effectedCard=n,n.behavior.activate()}},n.getNearestSquirrelCard=function(e){var t=this,n=this.getDistance(e[0],this.card),i=0;return e.forEach((function(e,r){var a=t.getDistance(e,t.card);a<n&&(i=r,n=a)})),e[i]},n.getDistance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},t}(CE),kE=xE,PE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.KEY,e.prototype.init.call(this)},n.activate=function(){this.boardGame.pile.removeCard(this.card),this.card.kill();var e=this.boardGame.pile.getLockCards();if(0!=e.length){var t=e[Math.floor(Math.random()*e.length)];t.behavior.activate(),this.effectedCard=t}},t}(yE),IE=PE,OE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.LOCK,e.prototype.init.call(this)},n.activate=function(){var e=this.boardGame.pile;this.kill(),e.removeCard(this.card),e.refresh()},t}(yE),RE=OE,BE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).requiredUnlockNuts=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.SQUIRREL,e.prototype.init.call(this)},n.activate=function(){this.requiredUnlockNuts-=1,this.requiredUnlockNuts<=0&&(this.boardGame.pile.removeCard(this.card),this.card.kill())},n.increaseNuts=function(){this.requiredUnlockNuts+=1},n.setRemainNuts=function(e){this.requiredUnlockNuts=e},t}(yE),DE=BE,LE=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n)||this).plus=void 0,r.cards=void 0,r.plus=i,r}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.cards=[],e.prototype.init.call(this),this.setPlus(this.plus)},n.onPlayerMove=function(){this.addCardToStock(this.plus),this.card.kill();var e=this.boardGame.pile;e.removeCard(this.card),e.refresh(!1)},n.setPlus=function(e){this.plus=e,1==this.plus?this.type=nu.PLUS_ONE:2==this.plus?this.type=nu.PLUS_TWO:3==this.plus?this.type=nu.PLUS_THREE:4==this.plus?this.type=nu.PLUS_FOUR:5==this.plus&&(this.type=nu.PLUS_FIVE);for(var t=0;t<this.plus;t++){var n=this.boardGame.deck.getNewStockCard();n.kill(),this.cards.push(n)}},n.addCardToStock=function(e){for(var t=0;t<e;t++){var n=this.boardGame.deck.getNewStockCard();this.boardGame.stock.addCard(n)}},t}(yE),ME=LE,_E=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).originalPlacement=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.originalPlacement=au.None,this.type=nu.JOKER},n.setOriginalPlacement=function(e){this.originalPlacement=e},n.onPlayerMove=function(){0==this.facingUp&&this.setFacingWithFlippingAnim(!0),this.boardGame.mover.fromPileToWaste(this.card),this.boardGame.pile.refresh(!1)},n.activate=function(){0==this.facingUp&&this.setFacingWithFlippingAnim(!0);var e=this.boardGame.waste;this.originalPlacement==au.Pile&&this.boardGame.mover.fromPileToWaste(this.card),this.originalPlacement==au.Joker&&e.addCard(this.card)},t}(gE),NE=_E,GE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=nu.WINDMILL},n.onPlayerMove=function(){var e=this.boardGame.pile;e.getFrontCards().forEach((function(t){e.removeCard(t)})),this.boardGame.waste.removeCard(this.card),e.refresh(!0),this.boardGame.checkWin()},t}(yE),FE=GE,ZE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=nu.MYSTERIOUS,this.setRandomBehavior()},n.setRandomBehavior=function(){var e=[nu.BOOM,nu.CHANGER,nu.JOKER,nu.PLUS_FIVE,nu.PLUS_FOUR,nu.PLUS_THREE,nu.PLUS_TWO,nu.PLUS_ONE],t=e[Math.floor(Math.random()*e.length)];this.card.setBehavior(t),this.type=t},t}(yE),UE=ZE,WE=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).isAffected=!1,i.connectedCard=void 0,i.setData(n.payload),i.type=nu.CHAIN,i}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=nu.CHAIN},n.setConnectedCard=function(e){e&&(this.connectedCard=e)},n.activate=function(){e.prototype.activate.call(this),this.checkProcessOnSingle()&&this.boardGame.pile.draw(this.connectedCard)},n.checkProcessOnSingle=function(){return this.isAffected?(this.isAffected=!1,!1):(this.connectedCard.behavior instanceof t&&(this.connectedCard.behavior.isAffected=!0),!0)},t}(CE),YE=function(){function e(e,t){this.x=void 0,this.y=void 0,this.angle=void 0,this.isInteractive=void 0,this.visible=void 0,this.active=void 0,this.isTint=void 0,e&&t?(this.x=e,this.y=t):(this.x=0,this.y=0),this.angle=0,this.isInteractive=!1,this.isTint=!1,this.visible=!0,this.active=!0}var t=e.prototype;return t.setPosition=function(e,t){this.x=e,this.y=t},t.setAngle=function(e){this.angle=e},t.setVisible=function(e){this.visible=e},t.kill=function(){this.visible=!1,this.active=!1},t.revive=function(){this.visible=!0,this.active=!0},t.setInteractive=function(){this.isInteractive=!0},t.disableInteractive=function(){this.isInteractive=!1},t.setActive=function(e){this.active=e},t.setY=function(e){this.y=e},t.setX=function(e){this.x=e},e}(),HE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).missingMapPieces=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.TREASURE,e.prototype.init.call(this)},n.activate=function(){this.missingMapPieces-=1,this.missingMapPieces<=0&&(this.boardGame.pile.removeCard(this.card),this.card.kill())},n.increaseMissingMapPieces=function(){this.missingMapPieces+=1},n.setMissingMapPieces=function(e){this.missingMapPieces=e},t}(yE),zE=HE,KE=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=nu.MAP_PIECE,e.prototype.init.call(this)},n.activate=function(){e.prototype.activate.call(this);var t=this.boardGame.pile.cards.filter((function(e){return e.isType(nu.TREASURE)}));if(0!=t.length){var n=this.getNearestTreasureMapCard(t);this.effectedCard=n,n.behavior.activate()}},n.getNearestTreasureMapCard=function(e){var t=this,n=this.getDistance(e[0],this.card),i=0;return e.forEach((function(e,r){var a=t.getDistance(e,t.card);a<n&&(i=r,n=a)})),e[i]},n.getDistance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},t}(CE),VE=KE,XE=(Ki.Z.CARD_BACK,Ki.Z.GAMEPLAY),jE=(XE.KEY,XE.FRAME,{id:1,x:100,y:100,angle:0,depth:hu.DEPTH.CARD,type:nu.VALUE,random:!0,faceUp:!1,modifiers:[],sequence:0,value:0,suit:0,isPosUpdated:!1,NumberOfMoves:0,CardChangerType:0,connectedCardID:-1}),qE=function(e){function t(t,n,i){var r;if((r=e.call(this)||this).id=void 0,r.boardGame=void 0,r.payload=void 0,r.isInteractive=void 0,r.isFlyingToStock=void 0,r.behavior=void 0,r.beginPlacement=void 0,r.boardGame=t,r.isInteractive=!1,r.isFlyingToStock=!1,r.beginPlacement=n,r.payload=(0,p.Z)({},jE,i),1==r.payload.random){var a=Math.floor(52*Math.random()),s=(a+1)%13==0?13:(a+1)%13,o=Math.floor(a/13)+1;r.payload.value=s,r.payload.suit=o}return r.id=GameCore.Utils.String.generateObjectId(),r}(0,f.Z)(t,e);var n=t.prototype;return n.setBehavior=function(e){this.behavior;var t=void 0;e==nu.LOCK&&(t=new RE(this.boardGame,this)).setData(this.payload),e==nu.KEY&&(t=new IE(this.boardGame,this)).setData(this.payload),e==nu.VALUE&&(t=new CE(this.boardGame,this)).setData(this.payload),e==nu.BOOM&&(t=new bE(this.boardGame,this)).setData(this.payload),e==nu.SQUIRREL&&(t=new DE(this.boardGame,this)).setData(this.payload),e==nu.CHESTNUT&&(t=new kE(this.boardGame,this)).setData(this.payload),e==nu.TREASURE&&(t=new zE(this.boardGame,this)).setData(this.payload),e==nu.MAP_PIECE&&(t=new VE(this.boardGame,this)).setData(this.payload),e==nu.PLUS_ONE&&(t=new ME(this.boardGame,this,1)).setData(this.payload),e==nu.PLUS_TWO&&(t=new ME(this.boardGame,this,2)).setData(this.payload),e==nu.PLUS_THREE&&(t=new ME(this.boardGame,this,3)).setData(this.payload),e==nu.PLUS_FOUR&&(t=new ME(this.boardGame,this,4)).setData(this.payload),e==nu.PLUS_FIVE&&(t=new ME(this.boardGame,this,5)).setData(this.payload),e==nu.CHANGER&&(t=new TE(this.boardGame,this)).setData(this.payload),e==nu.JOKER&&(t=new NE(this.boardGame,this)),e==nu.WINDMILL&&(t=new FE(this.boardGame,this)),e==nu.MYSTERIOUS&&(t=new UE(this.boardGame,this)),e==nu.CHAIN&&(t=new WE(this.boardGame,this)),t||(t=new gE(this.boardGame,this)),this.behavior=t,t.init()},n.revive=function(){e.prototype.revive.call(this)},n.isType=function(){if(0==this.active)return!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.behavior.type)},n.kill=function(){e.prototype.kill.call(this),this.behavior.kill()},n.update=function(e){this.behavior.update(e)},t}(YE),JE=function(){function e(e){this.boardGame=void 0,this.cards=void 0,this.matchRatioCalculator=void 0,this.boardGame=e,this.cards=[],this.matchRatioCalculator=e.solver.scene.gameplay.boardGame.deck.matchRatioCalculator,this.matchRatioCalculator.reset()}var t=e.prototype;return t.getCard=function(e){return this.cards.find((function(t){return t.id==e}))},t.getNewCard=function(e,t){var n=new qE(this.boardGame,e,t);return this.cards.push(n),n},t.getJokerCard=function(){var e=this.getNewCard(au.None);return e.setBehavior(nu.JOKER),e},t.getWindmillCard=function(){var e=this.getNewCard(au.Stock);return e.setBehavior(nu.WINDMILL),e},t.getNewStockCard=function(){var e=this.getNewCard(au.Stock);return e.setBehavior(),e},t.getMatchesForPile=function(e,t){var n=function(n){if(!n.behavior.random){var i=n.behavior.value;e.forEach((function(n,r){if(!(n.value<0||n.suit<0)){var a=Math.abs(i-n.value);1!=a&&12!=a||(t.push(n),e[r]={suit:-1,value:-1})}}))}};this.boardGame.pile.getFrontCards().forEach(n);var i=this.boardGame.waste.getOnTopCard();i&&n(i)},t.getRandomValue=function(){for(var e=this.matchRatioCalculator.getMatchRatio(),t=[],n=[],i=[],r=1;r<=4;r++)for(var a=1;a<=13;a++)t.push({suit:r,value:a});if(this.getMatchesForPile(t,n),0==n.length)return{value:Phaser.Math.Between(1,13),suit:Phaser.Math.Between(1,4)};t.forEach((function(e){e.value>0&&e.suit>0&&i.push(e)}));for(var s=i.length-Math.min(Math.round(i.length*(1-e)),2*n.length),o=0;o<s;o++){var c=Phaser.Math.Between(0,i.length-1);if(i.splice(c,1),i.length<1)break}var h=[].concat(n,i),u=[].concat(this.boardGame.pile.getFrontCards()),l=this.boardGame.waste.getOnTopCard();l&&u.push(l);for(var d=h.filter((function(e){var t=e.value,n=e.suit;return!u.some((function(e){return e.behavior.value==t&&e.behavior.suit==n}))})),p=Phaser.Math.Between(0,d.length-1),f=0;f<1;f++){if(!u.some((function(e){return e.behavior.value==d[p].value})))break;p=Phaser.Math.Between(0,d.length-1)}var m=d[p];return n.includes(m)?this.matchRatioCalculator.reset():this.matchRatioCalculator.onRandomCanNotMatch(),m},t.getRandomPileCard=function(){var e=this.getAllCardData(),t=this.boardGame.pile.getFrontCards(),n=e.filter((function(e){var n=e.value,i=e.suit;return!t.some((function(e){return e.behavior.value==n&&e.behavior.suit==i}))}));return n[Phaser.Math.RND.between(0,n.length-1)]},t.getAllCardData=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e},t.getMatchesForLock=function(e,t){var n=this.boardGame.pile.getFrontCards(),i=this.boardGame.locks.filter((function(e){return 0==e.isUnLock&&e.active}));if(0!=i.length){var r=i[Math.floor(Math.random()*i.length)],a=Math.floor(Math.random()*r.lockSegments.length),s=r.lockSegments[a];n.some((function(e){if(s.canUnlock(e.behavior.value,e.behavior.suit))return!0}))||e.forEach((function(n,i){if(!(n>=52)){var r=(n+1)%13==0?13:(n+1)%13,a=Math.floor(n/13)+1;s.canUnlock(r,a)&&(t.push(n),e[i]=100)}}))}},t.clear=function(){this.cards.forEach((function(e){e.kill()})),this.cards=[],this.matchRatioCalculator.reset()},e}(),QE=JE,$E=function(e,t){this.x=void 0,this.y=void 0,this.x=e,this.y=t},eC=function(e,t,n,i){this.x1=void 0,this.y1=void 0,this.x2=void 0,this.y2=void 0,this.x1=e,this.y1=t,this.x2=n,this.y2=i},tC=function(e){function t(t){var n;return(n=e.call(this,t)||this).draw=function(e,t,i){var r,a,s,o;if(void 0===t&&(t=1200),void 0===i&&(i=!1),e&&!n.checkOverlap(e)&&0!=e.behavior.facingUp&&(null==(r=e.behavior)?void 0:r.type)!==nu.LOCK&&(null==(a=e.behavior)?void 0:a.type)!==nu.SQUIRREL&&(null==(s=e.behavior)?void 0:s.type)!==nu.TREASURE){var c=n.boardGame.waste.getOnTopCard();if((null==(o=e.behavior)?void 0:o.type)===nu.KEY)return n.boardGame.mover.increaseMoves(),void e.behavior.activate();if(c)(n.isMatch(e,c)||i)&&(n.boardGame.mover.increaseMoves(),n.boardGame.solver.increaseCombo(),e.behavior.activate(),n.boardGame.onPlayerMove(),n.refresh())}},n.setName(au.Pile),n}(0,f.Z)(t,e);var n=t.prototype;return n.addCard=function(t){e.prototype.addCard.call(this,t),t.setInteractive()},n.align=function(){},n.getCardType=function(e){var t=e.behavior.value;return{type:Math.ceil(t/13),number:t%13==0?13:t%13}},n.getLockCards=function(){return this.cards.filter((function(e){return e.behavior instanceof RE}))},n.handleWithLock=function(e){for(var t=this.boardGame.locks,n=0;n<t.length;n++){var i=t[n];if(0==i.isUnLock&&i.active){var r=i.unlockSegment(e);if(r)return r}}},n.isMatch=function(e,t){var n,i;if((null==(n=e.behavior)?void 0:n.type)==nu.JOKER||(null==(i=t.behavior)?void 0:i.type)==nu.JOKER)return!0;if(0==e.behavior.checkCardHasValue())return!1;var r=Math.abs(t.behavior.value-e.behavior.value);return 1==r||12==r},n.getFrontCards=function(){var e=this;return this.cards.filter((function(t){if(t.isInteractive&&t.behavior.checkCardHasValue()&&!e.checkOverlap(t))return t}))},n.getDownCards=function(){var e=this;return this.cards.filter((function(t){if(t.isInteractive&&t.behavior.checkCardHasValue()&&e.checkOverlap(t))return t}))},n.isOverLap=function(e,t){for(var n=e.behavior.getPoints(),i=t.behavior.getPoints(),r=0;r<4;r++)for(var a=3==r?0:r+1,s=new eC(n[r].x,n[r].y,n[a].x,n[a].y),o=0;o<4;o++){var c=3==o?0:o+1,h=new eC(i[o].x,i[o].y,i[c].x,i[c].y);if(this.lineToLine(s,h))return!0}return!1},n.lineToLine=function(e,t){var n=new $E(0,0),i=e.x1,r=e.y1,a=e.x2,s=e.y2,o=t.x1,c=t.y1,h=t.x2,u=t.y2,l=(u-c)*(a-i)-(h-o)*(s-r);if(0===l)return!1;var d=((h-o)*(r-c)-(u-c)*(i-o))/l,p=((a-i)*(r-c)-(s-r)*(i-o))/l;return d>=0&&d<=1&&p>=0&&p<=1&&(n.x=i+d*(a-i),n.y=r+d*(s-r),!0)},n.checkOverlap=function(e){for(var t=this.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),n=0;n<t.length;n++){if(this.isOverLap(t[n],e))return t[n]}},n.refresh=function(e){var t=this;void 0===e&&(e=!0),this.getCardsWithType(nu.MYSTERIOUS).forEach((function(e){return e.behavior.activate()})),this.cards.forEach((function(e){t.checkOverlap(e)?0==e.payload.faceUp&&e.behavior.setFacingWithFlippingAnim(!1):e.behavior.setFacingWithFlippingAnim(!0)})),this.boardGame.lockCards(),e&&this.boardGame.checkLose()},n.getCurrentBoomCards=function(){var e=this,t=this.cards.filter((function(e){return e.active&&e.isInteractive&&e.behavior.type===nu.BOOM})),n=[];return t.forEach((function(t){!e.checkOverlap(t)&&t.behavior.facingUp&&n.push(t)})),n},n.getCardsWithType=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=this.cards.filter((function(e){return e.isType.apply(e,n)&&e.isInteractive})),a=[];return r.forEach((function(t){e.checkOverlap(t)||a.push(t)})),a},t}(Wy),nC=function(e){function t(t){var n;return(n=e.call(this,t)||this).setName(au.Waste),n}(0,f.Z)(t,e);var n=t.prototype;return n.refresh=function(){this.getOnTopCard()},n.addCard=function(t){e.prototype.addCard.call(this,t),t.disableInteractive()},n.removeCard=function(t){var n=e.prototype.removeCard.call(this,t),i=this.getOnTopCard();return i&&i.behavior.show(),n},n.getOnTopCard=function(){if(0!=this.cards.length){var e=this.cards.length;return this.cards[e-1]}},t}(Wy),iC=function(){function e(e){this.boardGame=void 0,this.moves=void 0,this.boardGame=e,this.moves=0}var t=e.prototype;return t.fromPileToWaste=function(e){var t=this.boardGame.pile,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.fromStockToWaste=function(e){var t=this.boardGame.stock,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.moveToWaste=function(e){var t=this.boardGame,n=(t.waste,t.pile),i=e.src,r=e.card;e.duration,e.lockSegment;switch(i.name){case au.Stock:this.fromStockToWaste(r),r.behavior.setFacingWithFlippingAnim(!0);break;case au.Pile:this.fromPileToWaste(r),0==n.cards.length&&this.boardGame.checkWin()}},t.getMoves=function(){return this.moves},t.increaseMoves=function(){this.moves+=1},t.setMoves=function(e){this.moves=e},t.clear=function(){this.moves=0},e}(),rC=iC,aC=function(e){function t(t,n,i,r,a){var s;return(s=e.call(this,n,i)||this).boardGame=void 0,s.parent=void 0,s.value=void 0,s.parent=r,s.value=a,s.boardGame=t,s}return(0,f.Z)(t,e),t.prototype.canUnlock=function(e,t){var n=this.value;if(n.cardFace>0){if(e==n.cardFace)return!0}else if(n.cardSuit>0){if(t==n.cardSuit)return!0}else if(n.cardColor>0){if(n.cardColor==Au.RED&&(t==wu.HEART||t==wu.DIAMOND))return!0;if(n.cardColor==Au.BLACK&&(t==wu.CLUBS||t==wu.SPADES))return!0}return!1},t}(YE),sC=aC,oC=function(e){function t(t,n,i,r){var a;return(a=e.call(this,n,i)||this).boardGame=void 0,a.isUnLock=void 0,a.payload=void 0,a.direction=void 0,a.lockSegments=void 0,a.boardGame=t,a.payload=r,a.isUnLock=!1,a.direction=2,a.lockSegments=[],a.createLockSegments(r.balloons),a.alignSegments(),a}(0,f.Z)(t,e);var n=t.prototype;return n.handleCards=function(e){this.direction=this.payload.direction;var t=this.getObjects(),n=t.cards,i=t.locks;e?(n.forEach((function(e){e.disableInteractive()})),i.forEach((function(e){e.setActive(!1)}))):(n.forEach((function(e){e.setInteractive()})),i.forEach((function(e){e.setActive(!0)})),this.isUnLock=!0)},n.getObjects=function(){var e=this,t=this.boardGame.pile.cards,n=this.boardGame.locks,i=[],r=[];return 1==this.direction?(i=t.filter((function(t){return t.payload.x<e.x})),r=n.filter((function(t){return t!=e&&t.x<e.x}))):2==this.direction&&(i=t.filter((function(t){return t.payload.x>=e.x})),r=n.filter((function(t){return t!=e&&t.x>=e.x}))),{cards:i,locks:r}},n.createLockSegments=function(e){var t=this;e.forEach((function(e){t.createSegment(e)}))},n.createSegment=function(e){var t=new sC(this.boardGame,0,0,this,e.cardValues);return t.setPosition(this.x,this.y),this.lockSegments.push(t),t},n.alignSegments=function(){var e=0,t=this.lockSegments.filter((function(e){return e.visible})),n=15*(t.length-1);t.forEach((function(t){t.setY(e-n),e+=35}))},n.unlockSegment=function(e){if(this.active){var t=this.lockSegments.filter((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}));if(t.length>0){var n=t[Math.floor(Math.random()*t.length)];return n.kill(),0==this.lockSegments.filter((function(e){return e.active&&e.visible})).length&&this.handleCards(!1),n}}},n.killLockSegment=function(e){e.kill()},n.revive=function(){e.prototype.revive.call(this),this.isUnLock=!1},n.reviveLockSegment=function(e){e.revive(),this.alignSegments()},t}(YE),cC=oC,hC=hu.CARD_VIEW.HEIGHT,uC=function(){function e(e){var t=this;this.solver=void 0,this.stock=void 0,this.deck=void 0,this.pile=void 0,this.waste=void 0,this.mover=void 0,this.locks=void 0,this.canRefillStock=void 0,this.analytics={stockLength:0,plusFiveCards:0},this.win=function(){t.gameOver(!0)},this.lose=function(){t.gameOver(!1)},this.isLose=function(){return 0==t.stock.getTotalCardsRemain()&&(t.analytics.plusFiveCards+=1,t.refillStock(5)),!1},this.solver=e,this.canRefillStock=!0,this.locks=[],this.deck=new QE(this),this.stock=new Yy(this),this.pile=new tC(this),this.waste=new nC(this),this.mover=new rC(this);this.stock.setPosition(-60,0-hC/2-5),this.waste.setPosition(0,0-hC/2-5),this.stock.init()}var t=e.prototype;return t.startGame=function(e){this.clear(),this.initPile(e),this.initStock(e),this.createLocks(e),this.pile.refresh(!0),this.stock.draw()},t.onPlayerMove=function(){var e=this.pile;e.getCardsWithType(nu.BOOM,nu.CHANGER).forEach((function(e){e.behavior.onPlayerMove()}));var t=this.waste.getOnTopCard();t&&t.isType(nu.WINDMILL)&&t.behavior.onPlayerMove();for(var n=e.cards.filter((function(e){return e.behavior.isPlusCard()||e.isType(nu.JOKER)})),i=0;i<n.length;i++){var r=n[i];this.pile.checkOverlap(r)||(r.behavior.onPlayerMove(),n.splice(i,1),i=-1)}},t.gameOver=function(e){this.locks.forEach((function(e){return e.kill()})),this.locks=[],e&&(this.solver.numberOfWining+=1);var t=this.mover.getMoves();this.solver.totalMoves+=t,this.solver.totalUsedStockCards+=this.stock.totalUsedCards,this.solver.minMoves>t&&(this.solver.minMoves=t),this.solver.timeRunning-=1,this.solver.timeRunning<=0?this.solver.isRunning=!1:(this.clear(),this.solver.solveLevel())},t.clear=function(){this.pile.clear(),this.stock.clear(),this.waste.clear(),this.deck.clear(),this.mover.clear()},t.setCanRefillStock=function(e){this.canRefillStock=e},t.initStock=function(e){var t=e.settings.cardsInStack;this.analytics.stockLength=t.length;for(var n=0;n<t.length;n++){var i=this.deck.getNewCard(au.Stock);i.setBehavior();var r=t[n],a=r.value,s=r.suit;a&&(-1==a?i.behavior.random=!0:i.behavior.setValue(a,s)),this.stock.addCard(i)}this.stock.init(),this.stock.align()},t.initPile=function(e){var t=this;e.cards.forEach((function(e){var n=t.deck.getNewCard(t.pile.name,e),i=e.x,r=e.y;n.setPosition(i,r),n.setAngle(e.angle),n.setBehavior(e.type),t.pile.addCard(n)})),this.setNutsInSquirrel(),this.connectChainCard()},t.createLocks=function(e){var t=this,n=e.balloonData;0!=n.length&&(n.forEach((function(e){var n=e.position,i=n.x,r=n.y,a=new cC(t,i,r,e);t.locks.push(a)})),this.lockCards())},t.setNutsInSquirrel=function(){var e=this.pile.cards.filter((function(e){return e.isType(nu.CHESTNUT)})),t=this.pile.cards.filter((function(e){return e.isType(nu.SQUIRREL)}));if(0!=e.length&&0!=t.length){var n=Math.floor(e.length/t.length),i=e.length;t.forEach((function(e){i-n<=0&&(n=i),i-=n,e.behavior.setRemainNuts(n)}))}},t.connectChainCard=function(){var e=this;this.pile.cards.filter((function(e){return e.isType(nu.CHAIN)})).forEach((function(t){var n=e.pile.cards.find((function(e){return e.payload.connectedCardID==t.payload.connectedCardID}));t.behavior.setConnectedCard(n)}))},t.checkLose=function(){this.isLose()&&this.canRefillStock&&this.refillStock(5)},t.checkWin=function(){this.isWin()&&this.win()},t.lockCards=function(){this.locks.forEach((function(e){0==e.isUnLock&&e.active&&e.handleCards(!0)}))},t.update=function(e){},t.refillStock=function(e){for(var t=0;t<e;t++){var n=this.deck.getNewCard(au.Stock);n.setBehavior(),this.stock.addCard(n)}this.stock.align(),this.checkLose()},t.isWin=function(){return 0==this.pile.cards.filter((function(e){return 1==e.visible})).length},e}(),lC=uC,dC=function(){function e(e){this.scene=void 0,this.boardGame=void 0,this.isRunning=void 0,this.numberOfTest=void 0,this.timeRunning=void 0,this.totalMoves=void 0,this.minMoves=void 0,this.totalUsedStockCards=void 0,this.numberOfWining=void 0,this.combo=void 0,this.maxCombo=void 0,this.indexComboType=void 0,this.scene=e,this.boardGame=new lC(this),this.init()}var t=e.prototype;return t.solveLevel=function(e){var t=this.scene.level.getLevelData();t&&(this.isRunning=!0,this.boardGame.startGame(t))},t.init=function(){this.isRunning=!1,this.totalMoves=0,this.minMoves=99999,this.totalUsedStockCards=0,this.numberOfWining=0,this.timeRunning=0,this.numberOfTest=0,this.combo=0,this.maxCombo=4,this.indexComboType=0,this.boardGame.analytics.plusFiveCards=0},t.setNumberOfTest=function(e){this.numberOfTest=e,this.timeRunning=e},t.showResults=function(){this.totalMoves,this.numberOfTest,this.totalUsedStockCards,this.numberOfTest},t.run=function(){for(this.init(),this.setNumberOfTest(100),this.solveLevel(this.scene.level.getLevel());!1!==this.isRunning;)this.draw();var e=this.totalMoves/this.numberOfTest,t=this.totalUsedStockCards/this.numberOfTest,n=this.boardGame.analytics.plusFiveCards/this.numberOfTest,i=this.boardGame.analytics.stockLength;return{numberOfTest:this.numberOfTest,stockLength:i,avgMoves:e,minMoves:this.minMoves,avgUsedStockCards:t,numberOfWining:this.numberOfWining,avgPlusFiveCards:n}},t.getNonVisitedCards=function(e,t){return e.filter((function(e){if(0==t.includes(e))return!0}))},t.getLongestChainLength=function(e,t,n,i,r){var a=this;return t.push(e),r>i&&(i=r),this.getNonVisitedCards(n,t).forEach((function(s){a.boardGame.pile.isMatch(e,s)&&(i=a.getLongestChainLength(s,t,n,i,r+1))})),t.pop(),i},t.getCardWithLongestChain=function(e){for(var t=this.boardGame.pile.getFrontCards(),n=[],i=-1,r=0;r<e.length;r++){var a=e[r],s=this.getLongestChainLength(a,[],t,0,0);i<s&&(i=s),n.push({startCard:a,length:s})}var o=n.filter((function(e){return e.length==i}));return o[Phaser.Math.Between(0,o.length-1)].startCard},t.getPileMatchableCards=function(){var e=this.boardGame.pile,t=this.boardGame.waste.getOnTopCard();return t?e.getFrontCards().filter((function(n){return e.isMatch(n,t)})):[]},t.draw=function(){var e=this.boardGame.stock,t=this.boardGame.pile,n=t.getCardsWithType(nu.KEY),i=this.getPileMatchableCards();if(0==t.getFrontCards().length&&(this.isRunning=!1),n.length>0){var r=n[Phaser.Math.Between(0,n.length-1)];t.draw(r)}else if(i.length>0){var a=this.getCardWithLongestChain(i);t.draw(a)}else t.cards.length>0&&e.cards.length>0&&e.draw()},t.printOutCardsStat=function(){var e=this,t=this.boardGame.pile.getFrontCards(),n=this.boardGame.stock.cards,i=[],r=[];t.forEach((function(t){var n=t.behavior.value,r=t.behavior.suit,a=e.getCardSuitType(r);i.push({type:a,value:n})}));var a=this.boardGame.waste.getOnTopCard();if(a){a.behavior.value;var s=a.behavior.suit;this.getCardSuitType(s)}n.forEach((function(t){var n=t.behavior.value,i=t.behavior.suit,a=e.getCardSuitType(i);r.push({suitType:a,value:n,type:t.behavior.type})}));var o=this.boardGame.locks;o.length>0&&o.forEach((function(e){0==e.isUnLock&&e.active}))},t.getCardSuitType=function(e){var t="SPADE";return e==wu.HEART&&(t="HEART"),e==wu.DIAMOND&&(t="DIAMOND"),e==wu.CLUBS&&(t="CLUBS"),e==wu.SPADES&&(t="SPADE"),t},t.increaseCombo=function(){},t.handleCombo=function(){switch(this.indexComboType){case 0:this.addWildCardFromCombo();break;case 3:this.addCardFromCombo()}},t.addWildCardFromCombo=function(){var e=this.boardGame.stock,t=this.boardGame.deck.getJokerCard();t.behavior.setOriginalPlacement(au.Combo);var n=Math.floor(Math.random()*e.cards.length);e.addCardAt(t,n)},t.addCardFromCombo=function(){var e=this.boardGame,t=e.stock,n=e.deck.getNewStockCard(),i=Phaser.Math.Between(0,t.cards.length-1);t.addCardAt(n,i)},e}(),pC=dC,fC=Tp.STATUS,mC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.gameMode=void 0,n.handleGameModeChanged=function(){n.stop(),n.start()},n.scene=t,n.init(),n}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.gameMode=li.SINGLE,mi.instance.on(pi.GAME_MODE_CHANGED,this.handleGameModeChanged)},n.setUpShowUI=function(){this.gameMode=mi.instance.getGameMode();var e={};switch(this.gameMode){case li.SINGLE:case li.CHALLENGE_FRIENDS:case li.TOURNAMENT:e={levelTitle:!0,challengeInfo:!1,challengeTitle:!1,weeklyTournamentInfo:!1}}this.scene.gameUI.setUpShowUIPayload(e)},n.start=function(){if(!this.isRunning()){switch(this.setUpShowUI(),this.gameMode=mi.instance.getGameMode(),this.gameMode){case li.SINGLE:this.startSingleMode();break;case li.TOURNAMENT:this.startTournamentMode();break;case li.CHALLENGE_FRIENDS:this.startChallengeMode();break;default:this.stopChallengeMode(),this.stopTournamentMode()}this.setState(fC.RUNNING)}},n.stop=function(){switch(this.gameMode){case li.SINGLE:this.stopSingleMode();break;case li.TOURNAMENT:this.stopTournamentMode();break;case li.CHALLENGE_FRIENDS:this.stopChallengeMode()}this.setState(fC.STOPPED)},n.startSingleMode=function(){this.scene.rewardManager.setRewardBehavior(new hE(this.scene))},n.stopSingleMode=function(){},n.startTournamentMode=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.rewardManager.setRewardBehavior(new hE(this.scene));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTournamentInfo=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.stopTournamentMode=function(){},n.startChallengeMode=function(){this.scene.rewardManager.setRewardBehavior(new hE(this.scene))},n.stopChallengeMode=function(){},t}(Pp),gC=mC,vC={targets:[],duration:300,ease:n(16).Z,props:{scale:{from:1.2,to:1}}},yC=function(e){function t(t){return e.call(this,vC,t)||this}return(0,f.Z)(t,e),t}(dh.Z),EC=[{id:1,value:{coin:50}},{id:2,value:{coin:75}},{id:3,value:{coin:100}},{id:4,value:{coin:125}},{id:5,value:{coin:150}},{id:6,value:{coin:200}},{id:7,value:{coin:300}}],CC=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EC);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),wC={REWARDED:"rewarded",SKIPPED:"skipped",READY:"ready",WAITING:"waiting"},AC=(0,Q.P1)([function(e){var t;return null==(t=e[Xs])?void 0:t.rewards}],(function(e){return e})),bC=(0,Q.P1)([function(e){var t;return null==(t=e[Xs])?void 0:t.isRequesting}],(function(e){return e})),SC=GameCore.Configs.DailyRewards,TC=function(e){return function(t){var n=window.game.player.getCustomData("dailyRewarded")||{},i=n.logDays,r=void 0===i?[]:i,a=n.lastRewarded,s=void 0===a?0:a,o=new Date,c=new Date(s),h=new Date(c.toDateString()),u=Math.abs(o.valueOf()-h.valueOf()),l=Math.floor(u/864e5)>1,d=SC.CheckInterrupt&&l||r.length>=SC.MaxDays,f=d?[!1]:[].concat(r,[!1]);d&&xC([]);var m=e.map((function(e,t){var n=t<f.length,i=f.length===t+1,r=!1===f[t],a=wC.WAITING;return i?a=wC.READY:d?a=wC.WAITING:n&&r?a=wC.SKIPPED:n&&(a=wC.REWARDED),(0,p.Z)({},e,{status:a})}));t({type:qs,payload:{rewards:m}})}},xC=function(e,t){void 0===t&&(t=!1),window.game.player.setCustomData("dailyRewarded",{logDays:e,lastRewarded:t?0:Date.now()})},kC=n(82),PC=Ki.Z.DEFAULT,IC=PC.KEY,OC=PC.FRAME,RC=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).isDayPassed=void 0,i.getButton=void 0,i.payload=void 0,i.background=void 0,i.blockBg=void 0,i.titleBg=void 0,i.titleText=void 0,i.iconStatus=void 0,i.currencyIcon=void 0,i.starTwinkleUp=void 0,i.pulsateBubbleAnimation=void 0,i.lock=void 0,i.bg=void 0,i.isDayPassed=!1,i.payload=n,i.setName("Day: "+n.day),i.draw(),i.setStatus(),i}(0,f.Z)(t,e);var n=t.prototype;return n.setStatus=function(){switch(this.payload.status){case wC.READY:this.setStatusReady(),this.runAnimations();break;case wC.SKIPPED:this.setStatusSkipped();break;case wC.REWARDED:this.setStatusRewarded();break;default:this.setStatusWaiting()}},n.setStatusReady=function(){this.getButton.setVisible(!0),this.titleText.setColor(3504414),this.updateStatusForDay7(),this.setCurrentIconByDay(this.payload.day)},n.setStatusRewarded=function(){this.iconStatus.setVisible(!0),this.getButton.setVisible(!1),this.titleText.setColor(10959151),this.updateStatusForDay7(),this.setIconStatus(!0),this.setCurrentIconByDay(this.payload.day),this.isDayPassed=!0},n.setStatusSkipped=function(){this.iconStatus.setVisible(!0),this.getButton.setVisible(!1),this.titleText.setColor(10959151),this.updateStatusForDay7(),this.setIconStatus(!1),this.setCurrentIconByDay(this.payload.day),this.isDayPassed=!0},n.setStatusWaiting=function(){this.titleText.setColor(177484871),this.updateStatusForDay7(),this.setCurrentIconByDay(this.payload.day),this.getButton.setVisible(!1)},n.updateStatusForDay7=function(){7===this.payload.day&&this.titleText.setColor(8071345)},n.setIconStatus=function(e){e?(this.iconStatus.setFrame(OC.ICON_CHECK),this.iconStatus.setWorldSize(28.5,22)):this.iconStatus.kill()},n.setCurrentIconByDay=function(e){var t=OC.ICON_REWARD_1;switch(e){case 1:t=OC.ICON_REWARD_1,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 2:t=OC.ICON_REWARD_2,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 3:t=OC.ICON_REWARD_3,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,5);break;case 4:t=OC.ICON_REWARD_4,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 5:t=OC.ICON_REWARD_5,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,15);break;case 6:t=OC.ICON_REWARD_6,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,4,15);break;case 7:t=OC.ICON_REWARD_7,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this)}this.currencyIcon.setDefaultWorldSize()},n.draw=function(){this.updateBlockSize(),this.createBlockBG(),this.createTitleText(),this.createCurrencyIcon(),this.createIconStatus(),this.createGetButton()},n.createBackground=function(){this.background=this.scene.make.image({key:IC,frame:OC.DAILY_DAY_BG}),this.background.setWorldSize(75,102),this.add(this.background)},n.updateBlockSize=function(){7==this.payload.day?this.setSize(96.5,243):this.setSize(96.5,112)},n.createBlockBG=function(){this.createShadow();var e={width:96.5,height:this.height-31.5},t=this.payload,n=t.status,i=t.day,r=wC.READY,a=wC.REWARDED,s=wC.SKIPPED,o=OC.DAILY_PURPLE_HEADER;if(i<7)switch(n){case r:o=OC.DAILY_GREEN_HEADER;break;case s:case a:o=OC.DAILY_ORANGE_HEADER;break;default:o=OC.DAILY_RED_HEADER}var c=this.scene.add.image(0,0,IC,o);c.setDefaultWorldSize();var h=this.scene.make.nineslice({key:IC,frame:OC.DAILY_BLOCK_BG,leftWidth:24,rightWidth:24,topHeight:24,bottomHeight:24,width:e.width,height:e.height});this.add([h,c]),this.bg=h,Phaser.Display.Align.In.TopCenter(c,this),h.setY((this.displayHeight-h.displayHeight)/2-.5)},n.createShadow=function(){var e=this.scene.make.nineslice({key:IC,frame:OC.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:this.width+21,height:this.height+20});e.setY(10),this.add(e)},n.createTitleBg=function(){this.titleBg=this.scene.make.image({key:IC,frame:OC.DAILY_DAY_TITLE_GREY}),this.titleBg.setWorldSize(68,25),this.add(this.titleBg),Phaser.Display.Align.In.TopCenter(this.titleBg,this,0,-1)},n.createTitleText=function(){var e=this.payload.day;this.titleText=new pv(this.scene),this.titleText.setText("Day "+e),this.titleText.setFontSize(16),this.titleText.setColor(10959151),this.add(this.titleText),Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-5)},n.createCurrencyIcon=function(){this.currencyIcon=this.scene.make.image({key:IC,frame:OC.ICON_REWARD_1}),this.currencyIcon.setDefaultWorldSize(),this.add(this.currencyIcon)},n.createIconStatus=function(){this.iconStatus=this.scene.make.image({key:IC,frame:OC.ICON_DOT}),this.iconStatus.setVisible(!1),this.iconStatus.setWorldSize(20,22),this.add(this.iconStatus)},n.createGetButton=function(){var e=new sv(this.scene,IC,OC.BUTTON.GREEN_40,61.5,35.5);e.setName("Get");var t=this.scene.make.bitmapText({font:Rc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5},text:"Get"});e.add(t),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,e.height/2-7),this.getButton=e},n.createLock=function(){var e=void 0;(e=7==this.payload.day?this.scene.make.image({key:IC,frame:OC.PURPLE_LOCK}):this.scene.make.image({key:IC,frame:OC.LOCK})).setVisible(!1),e.setWorldSize(24.5,33.5),this.add(e),Phaser.Display.Align.In.Center(e,this,0,6),this.lock=e},n.runAnimations=function(){this.runSparksIdle()},n.runSparksIdle=function(){this.starTwinkleUp||(this.starTwinkleUp=new kC.Z(this.scene),this.starTwinkleUp.emitter.setFrequency(100),this.add(this.starTwinkleUp));var e=this.currencyIcon,t=e.x,n=e.y,i=e.width,r=e.height;this.starTwinkleUp.run(1,t,n,i,r)},n.runPulsateBubbleAnimation=function(){this.pulsateBubbleAnimation||(this.pulsateBubbleAnimation=new lh.Z({targets:[this.currencyIcon],props:{scale:"+=0.04"}})),this.pulsateBubbleAnimation.play()},t}(Phaser.GameObjects.Container),BC=RC,DC=Ki.Z.DEFAULT,LC=(DC.KEY,DC.FRAME,GameCore.Configs),MC=(LC.Network,LC.DailyRewards),_C={id:0,value:{coin:0}},NC=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).onReward=void 0,o.onSkipAd=void 0,o.onNoAd=void 0,o.scene=void 0,o.isClaimed=void 0,o.logDays=void 0,o.rewardsData=void 0,o.popup=void 0,o.loading=void 0,o.dayBlocks=void 0,o.claimButton2X=void 0,o.claimButton=void 0,o.adsTimer=void 0,o.title=void 0,o.popupExitsAnimation=void 0,o.handleOnClaim=function(e){if(!o.isClaimed){o.isClaimed=!0;var t=o.getCurrentRewardValue(),n=o.dayBlocks.getChildren()[e],i=t.coin;o.claimReward();var r=n.getWorldPosition(),a=r.x,s=r.y;o.scene.rewardManager.rewardCoin(i),o.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,a,s),o.scene.screen.close(o.name),o.scene.screen.open(de.o4.DASHBOARD_SCREEN,{})}},o.updateRewardsData=(0,i.Z)(a().mark((function e(){var t,n,r,s,c,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.scene,n=t.storage,r=t.player,e.next=3,n.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!bC(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:js,payload:{}}),e.next=7,CC();case 7:r=e.sent,t(TC(r));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:if(s=n.getState(),!((null==(c=AC(s)||[])?void 0:c.length)<1)){e.next=7;break}return e.abrupt("return");case 7:o.rewardsData=c,h=r.getCustomData("dailyRewarded"),u=(h||{}).logDays,l=void 0===u?[]:u,o.logDays=[].concat(l);case 11:case"end":return e.stop()}}),e)}))),o.isCanOpen=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 6:if(!(MC.MockTime>0)){e.next=10;break}if(!(Date.now()-t>=1e3*MC.MockTime)){e.next=10;break}return e.abrupt("return",!0);case 10:if(!(0,me.Gm)(t)){e.next=12;break}return e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e)}))),o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o))},o.scene=t,o.rewardsData=[],o.isClaimed=!1,o.createPopupContents(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isCanOpen();case 2:if(t.sent){t.next=6;break}return this.scene.screen.open(de.o4.DASHBOARD_SCREEN),t.abrupt("return");case 6:return null==(n=this.dayBlocks)||n.destroy(!0,!0),e.prototype.open.call(this),t.next=10,this.updateRewardsData();case 10:this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.createDayBlocks(),this.runOpenAnimation();case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.close=function(){this.runCloseAnimation()},n.claimReward=function(){this.logDays.push(!0),xC(this.logDays),this.scene.audio.playSound(rc.Z.DAILY_REWARD),this.runContentExitsAnimation(0,400)},n.getCurrentRewardValue=function(){var e=this.rewardsData.find((function(e){return e.status===wC.READY}));return(null==e?void 0:e.value)||{coin:0}},n.getRewardByDay=function(e){return this.rewardsData.find((function(t){return t.id===e}))||_C},n.runOpenAnimation=function(){this.setVisible(!0),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(300,250)},n.runPopupEntrancesAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.popup]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runPopupContentEntrancesAnimation=function(e,t){var n=this.dayBlocks.getChildren();n.length<1||[[n[0]],[n[1],n[3]],[n[2],n[4]],[n[5],n[6]]].forEach((function(e,n){new yC({targets:e,duration:t,delay:60*n,props:{alpha:{start:0,from:.3,to:1},scale:{from:.8,to:1}},ease:Phaser.Math.Easing.Back.Out}).play()}))},n.runCloseAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.popup]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.runContentExitsAnimation=function(e,t){this.popupExitsAnimation||(this.popupExitsAnimation=new Dv.Z({targets:[].concat(this.dayBlocks.getChildren(),[this.title]),delay:this.scene.tweens.stagger(30,{start:e}),duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In})),this.popupExitsAnimation.play()},n.createPopupContents=function(){this.createTitle()},n.createTitle=function(){var e=new pv(this.scene);e.setText(this.scene.lang.Text.dailyBonus),e.setColor(7162732),e.setFontSize(30),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-16),this.title=e},n.createDayBlocks=function(){var e,t=this;null==(e=this.dayBlocks)||e.destroy(!0,!0);var n=MC.MaxDays;this.dayBlocks=this.scene.make.group({maxSize:n}),new Array(n).fill(null).forEach((function(e,n){var i=t.createDayBlock(n+1);t.dayBlocks.add(i),i.getButton.onClick=function(){t.handleOnClaim(n)}})),Phaser.Actions.GridAlign(this.dayBlocks.getChildren(),{width:3,height:2,cellWidth:115.5,cellHeight:131,x:-163.75,y:-35});var i=this.dayBlocks.getLast(!0),r=this.dayBlocks.getFirst(!0);i&&r&&i.setPosition(r.x+346.5,r.y+65.5),this.dayBlocks.getChildren().forEach((function(e){e instanceof BC&&e.isDayPassed&&t.moveBelow(e,t.background)}))},n.createDayBlock=function(e){var t=this.getRewardByDay(e),n=t.value,i=t.status,r=void 0===i?"":i,a=new BC(this.scene,{day:e,value:n,status:r});return a.setAlpha(0),this.add(a),a},t}(GameCore.Screen),GC=NC,FC=function(){function e(e){this.scene=void 0,this.list=void 0,this.scene=e,this.list=new Map}var t=e.prototype;return t.backupObject=function(e){var t=this.getProps(e);this.list.set(e,t)},t.backupObjectProp=function(e,t,n){var i={x:t,y:n};this.list.set(e,i)},t.getObjectSaved=function(e){var t=this.list.get(e);return t||this.getProps(e)},t.getProps=function(e){return{x:e.x,y:e.y}},e}(),ZC=FC,UC=n(78),WC=function(e){function t(t){return e.call(this,t)||this}return(0,f.Z)(t,e),t.prototype.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),r},t}(Phaser.GameObjects.Particles.Particle),YC=WC,HC=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,"effects/"+i+"-sparkle")||this).emitter=void 0,r.emitterFrame=void 0,r.scene=t,r.emitterFrame="effects/"+i+"-sparkle",r.setActive(!1),r.setVisible(!1),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:this.emitterFrame,quantity:1,speedX:{min:-5,max:5},speedY:{min:-5,max:-13},lifespan:{min:3e3,max:5e3},alpha:0,scale:{min:.1,max:1/3},angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:300,x:{min:-30,max:25},y:{min:-2,max:-20},blendMode:"Multiply",particleClass:YC})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},n.setEmitterFrame=function(e){this.emitterFrame=e,this.reset()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),zC=HC,KC=Ki.Z.WEEKLY_TOURNAMENT_CHESTS.KEY,VC=Ki.Z.OFFSHORE_RACE_CHESTS.KEY,XC={gold:{x:5,y:-39},silver:{x:5,y:-30},purple:{x:5,y:-30},bronze:{x:4,y:-26}},jC=function(e){return e.GOLD="gold",e.SILVER="silver",e.PURPLE="purple",e.BRONZE="bronze",e}({}),qC=function(e){return e.WEEKLY_TOURNAMENT="weekly-tournament",e.OFFSHORE_RACE="offshore-race",e}({}),JC=function(e){function t(t,n,i){var r;return(r=e.call(this,t,0,0)||this).chest=void 0,r.openChestTimeline=void 0,r.glow=void 0,r.chestSparklesFlyUp=void 0,r.chestType=void 0,r.eventType=void 0,r.scene=t,r.chestType=n,r.eventType=i,r.create(),r.scene.add.existing((0,yc.Z)(r)),r.glow.kill(),r.kill(),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateChestFrame=function(e,t){this.chestType=e,this.eventType=t,this.setChestClose(),this.setSize(this.chest.width,this.chest.height),this.glow.setFrame("effects/"+this.chestType+"-glow"),this.glow.setOrigin(.5,1),this.glow.setDefaultWorldSize(),this.chestSparklesFlyUp.setEmitterFrame("effects/"+this.chestType+"-sparkle")},n.setChestClose=function(){this.chest.setFrame(this.eventType+"/"+this.chestType+"-close"),this.chest.setOrigin(.5,1),this.chest.setDefaultWorldSize()},n.setChestOpen=function(){this.chest.setFrame(this.eventType+"/"+this.chestType+"-open"),this.chest.setOrigin(.5,1),this.chest.setDefaultWorldSize()},n.runChestEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),void 0===n&&(n=0),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.CHEST_FLYING,{},!0),i=new UC.Z({targets:[this],duration:500,curve:[[t-100,n+110],[t-66,n+60],[t-33,n+40],[t,n+60]],props:{scale:{from:1.2,start:1.2,to:1},scaleX:{from:.8,start:.8,to:1},scaleY:{from:1.2,start:1.2,to:1},alpha:{from:0,start:0,to:1,duration:200}},onStart:function(){r.revive()}}),(0,gl.Z)(this.scene,130).then((function(){i.play()})),e.next=7,i.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runChestOpenAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),void 0===n&&(n=60),null==(i=this.openChestTimeline)||!i.isPlaying()){e.next=4;break}return e.abrupt("return");case 4:return r=this.y,(s=this.scene.tweens.createTimeline()).add({targets:this,scaleX:"+=0.05",scaleY:"-=0.05",duration:150,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out}),s.add({targets:this,scaleX:"-=0.05",scaleY:"+=0.05",y:r-40,duration:150,ease:Phaser.Math.Easing.Sine.Out}),s.add({targets:this,scaleX:"+=0.05",scaleY:"-=0.05",x:t,y:n+60,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){o.setChestOpen(),o.runChestLightAnimation()}}),s.play(),(0,gl.Z)(this.scene,600).then((function(){o.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.CHEST_OPEN)})),this.openChestTimeline=s,e.next=14,s.waitForCompletion();case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runChestLightAnimation=function(){var e=this,t=XC[this.chestType],n=t.x,i=t.y;this.glow.setPosition(this.chest.x+n,this.chest.y+i),this.scene.tweens.add({targets:this.glow,scaleY:{from:0,start:0,to:1/3},alpha:{from:0,start:0,to:1,duration:150},duration:300,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.glow.revive()}}),this.chestSparklesFlyUp.setPosition(0,this.glow.y),this.chestSparklesFlyUp.start()},n.runChestExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chestSparklesFlyUp.stop(),t=this.scene.tweens.add({targets:[this],alpha:{from:1,start:1,to:0},duration:250,scale:{from:1,start:1,to:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.glow.kill(),n.kill(),n.setScale(1),n.setAlpha(1)}}).waitForCompletion(),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.createChest(),this.createGlow(),this.createChestStarsFlyUp()},n.createChest=function(){var e=this.eventType===qC.WEEKLY_TOURNAMENT?KC:VC,t=this.scene.add.image(0,0,e,this.eventType+"/"+this.chestType+"-close");t.setOrigin(.5,1),t.setDefaultWorldSize(),this.add(t),this.setSize(t.width,t.height),this.chest=t},n.createGlow=function(){var e=this.eventType===qC.WEEKLY_TOURNAMENT?KC:VC,t=this.scene.add.image(0,0,e,"effects/"+this.chestType+"-glow");t.setOrigin(.5,1),t.setDefaultWorldSize(),t.kill(),this.add(t),this.glow=t},n.createChestStarsFlyUp=function(){var e=this.eventType===qC.WEEKLY_TOURNAMENT?KC:VC;this.chestSparklesFlyUp=new zC(this.scene,e,this.chestType),this.add(this.chestSparklesFlyUp)},t}(Phaser.GameObjects.Container),QC=function(){function e(e){this.scene=void 0,this.scene=e}var t=e.prototype;return t.logGetItemByEvent=function(e,t,n){var i=this.getTypeWithItemType(t),r=null;switch(e){case qC.WEEKLY_TOURNAMENT:r=Cl.WEEKLY_TOURNAMENT;break;case qC.OFFSHORE_RACE:r=Cl.OFFSHORE_RACE;break;default:return}i&&this.logGetItem(i,n,r)},t.logBuyBooster=function(e,t,n){var i=this.getTypeWithItemType(e),r=null;switch(i){case yl.BOOSTER_SLICE:r=Cl.BUY_BOOSTER_SLICE;break;case yl.BOOSTER_STORM:r=Cl.BUY_BOOSTER_STORM;break;case yl.BOOSTER_WILD_DROP:r=Cl.BUY_BOOSTER_WILD_DROP;break;default:return}this.logBuyItemWithCoins(i,t,n,r)},t.logBuyItemWithCoins=function(e,t,n,i){var r=this.scene.player.getLevel(),a={level:r,max_player_level:r,resource_type_1:yl.COIN,resource_change_1:-t,resource_type_2:e.toString(),resource_change_2:n,transaction_type:i.toString(),transaction_count:1};this.logEconomyTransaction(a)},t.logUseItem=function(e,t,n){var i=this.scene.player.getLevel(),r={level:i,max_player_level:i,resource_type_1:e.toString(),resource_change_1:-t,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(r)},t.logGetItem=function(e,t,n){var i=this.scene.player.getLevel(),r={level:i,max_player_level:i,resource_type_1:e.toString(),resource_change_1:t,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(r)},t.logBuyAndUseInstantItem=function(e,t,n){var i=this.scene.player.getLevel(),r={level:i,max_player_level:i,resource_type_1:yl.COIN,resource_change_1:-t,resource_type_2:e.toString(),resource_change_2:1,resource_type_3:e.toString(),resource_change_3:-1,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(r)},t.logWatchAdAndUseInstantItem=function(e,t){var n=this.scene.player.getLevel(),i={level:n,max_player_level:n,resource_type_1:e.toString(),resource_change_1:1,transaction_type:t,transaction_count:1},r={level:n,max_player_level:n,resource_type_1:e.toString(),resource_change_1:-1,transaction_type:t,transaction_count:1};this.logEconomyTransaction(i),this.logEconomyTransaction(r)},t.logEconomyTracking=function(){var e=this.scene.player,t=e.getLevel(),n=e.getCoins(),i=e.getStar(),r=e.getBoosterAmount(ji.SLICE),a=e.getBoosterAmount(ji.STORM),s=e.getBoosterAmount(ji.WILD_CARD),o=e.getPlusFive(),c=e.getUndo(),h=e.getWildCard(),u={level:t,max_player_level:t,resource_type_1:yl.COIN,resource_current_1:n,resource_type_2:yl.STAR,resource_current_2:i,resource_type_3:yl.BOOSTER_SLICE,resource_current_3:r,resource_type_4:yl.BOOSTER_STORM,resource_current_4:a,resource_type_5:yl.BOOSTER_WILD_DROP,resource_current_5:s,resource_type_6:yl.PLUS_FIVE,resource_current_6:o,resource_type_7:yl.UNDO,resource_current_7:c,resource_type_8:yl.WILD_CARD,resource_current_8:h};this.scene.analytics.event(ae._.ECONOMY_TRACKING,(0,p.Z)({},u))},t.logCollectUseWildcard=function(){var e=this.scene.player.getLevel(),t={level:e,max_player_level:e,resource_type_1:yl.WILD_CARD,resource_change_1:1,resource_type_2:yl.WILD_CARD,resource_change_2:-1,transaction_type:Cl.PLAY_CARD,transaction_count:1};this.logEconomyTransaction(t)},t.getTypeWithItemType=function(e){switch(e){case ji.SLICE:return yl.BOOSTER_SLICE;case ji.STORM:return yl.BOOSTER_STORM;case ji.WILD_CARD:return yl.BOOSTER_WILD_DROP;case er.PLUS_5_CARDS:case ji.PLUS_CARD:return yl.PLUS_FIVE;case er.UNDO:return yl.UNDO;case er.COIN:return yl.COIN}return yl.UNKNOWN},t.logEconomyTransaction=function(e){this.scene.analytics.event(ae._.ECONOMY_TRANSACTION,e)},e}(),$C=QC,ew=function(){function e(e){this.scene=void 0,this.currentMove=0,this.currentMissMove=0,this.scene=e}var t=e.prototype;return t.resetLog=function(){this.currentMove=0,this.currentMissMove=0},t.logClickOnMatchedCard=function(){this.currentMove+=1,this.scene.level.getLevel()>10||this.scene.analytics.event("player_move",{move:this.currentMove,success:!0,level:String(this.scene.level.getLevel()).padStart(3,"0")})},t.logClickOnPileUnmatchedCard=function(){this.currentMissMove+=1,this.scene.level.getLevel()>10||this.scene.analytics.event("player_move",{move:this.currentMissMove,success:!1,level:String(this.scene.level.getLevel()).padStart(3,"0")})},e}(),tw=ew,nw=Ki.Z.DEFAULT,iw=nw.KEY,rw=nw.FRAME,aw=function(e){function t(t,n){var i,r=n.key,a=n.buttonFrame,s=n.width,o=n.height;return(i=e.call(this,t,s,o)||this).coin=void 0,i.cost=void 0,i.background=void 0,i.createBackground(r,a),i.createCoin(),i.createText(),i.alignItems(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.setCost=function(e){this.cost.setText(e)},n.alignItems=function(){this.coin.setPosition(-23.2,-.7),this.cost.setPosition(14.5,-1)},n.createBackground=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.background=n},n.createCoin=function(){var e=this.scene.add.image(0,0,iw,rw.PLAY_SCREEN.BOOSTER.COIN);e.setDefaultWorldSize(),this.add(e),this.coin=e},n.createText=function(){var e=new Qp(this.scene,{text:"500",fontSize:this.scene.fontSize(20.2),strokeBlur:2,strokeBlurAlpha:.2,strokeBlurColor:0,fillColor:16776958,letterSpacingExtra:.7});this.add(e),this.cost=e},t}(jp.Z),sw=aw,ow=Ki.Z.DEFAULT,cw=ow.KEY,hw=ow.FRAME,uw={width:848/3,height:256},lw=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.xContainer=void 0,r.closeButton=void 0,r.titleText=void 0,r.boosterImage=void 0,r.countText=void 0,r.description=void 0,r.booster=void 0,r.buyButton=void 0,r.scene=t,r.setPosition(n,i),r.setSize(uw.width,uw.height),r.create(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.booster,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,r=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:r},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=100"})})),t.play()},n.setTitle=function(e){this.titleText.setText(e)},n.setBooster=function(e){this.boosterImage.setTexture(cw,e)},n.setDescription=function(e){this.description.setText(e)},n.setCost=function(e){this.buyButton.setCost(400..toString())},n.create=function(){this.createBackground(),this.createCloseButton(),this.createTitle(),this.createBooster(),this.createBoosterDescription(),this.createBuyingBoosterButton()},n.createBackground=function(){var e=new fy(this.scene,{key:cw,frame:hw.PLAY_SCREEN.POPUP_BASE,width:uw.width,height:uw.height,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createCloseButton=function(){this.xContainer=this.scene.add.container(116,-68.5),this.add(this.xContainer);var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new ov.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.xContainer.add(i),this.closeButton=i},n.createTitle=function(){this.titleText=new Qp(this.scene,{fontSize:this.scene.fontSize(19),text:"Triple Cut",fillColor:10775368,letterSpacingExtra:.1});var e=this.scene.add.image(0,0,cw,hw.COMMON.TITLE_DECOR);e.setDefaultWorldSize(),this.add(this.titleText),this.add(e),this.titleText.setPosition(-1,-103),e.setPosition(-.5,-88.5)},n.createBooster=function(){var e=this.scene.add.image(0,0,cw,hw.REWARDS.SLICE);e.setWorldSize(66,256/3);var t=this.scene.add.image(0,0,cw,hw.PLAY_SCREEN.ICON_RED);t.setDefaultWorldSize();var n=new Qp(this.scene,{text:"x1",fontSize:this.scene.fontSize(13),strokeColor:16776958,letterSpacingExtra:.2,strokeBlur:2.5,strokeBlurAlpha:.2,strokeBlurColor:0}),i=this.scene.add.container(0,0);i.setSize(e.width,e.height);var r=this.scene.add.container(0,0);r.setSize(t.width,t.height),r.add([t,n]),i.add([e,r]),this.add(i),this.booster=i,this.boosterImage=e,this.countText=n,n.setPosition(-.5,-1.5),r.setPosition(i.width/2-8,i.height/2-12.5),e.setPosition(0,0),this.booster.setPosition(-4,-26.5)},n.createBoosterDescription=function(){var e=new Qp(this.scene,{text:"The Triple Cut booster\nremoves three open cards\nat the beginning of the level.",fontSize:this.scene.fontSize(15),fillColor:10775368,letterSpacingExtra:-.1});e.setPadding(2,2,2,2),e.setCenterAlign(),e.setPosition(1,44),this.add(e),this.description=e},n.createBuyingBoosterButton=function(){var e=Ki.Z.DASHBOARD,t=e.KEY,n=e.FRAME,i=new sw(this.scene,{key:t,buttonFrame:n.BUTTON.BUTTON.NEW_GREEN,width:436/3,height:42});i.setName("BuyBooster"),this.add(i),i.setPosition(0,96),this.buyButton=i},t}(Phaser.GameObjects.Container),dw=lw,pw=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.previousScreenKey=void 0,o.cost=void 0,o.boosterKey=void 0,o.buyingBoosterContainer=void 0,o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o))},o.buy=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.scene.gameplay.boosterManager,!((n=o.scene.player.getCoins())<o.cost)){e.next=5;break}return o.scene.screen.open(de.o4.GET_COINS_SCREEN,{claimedCoin:vf.instance.reward.rewardedAdOffer}),e.abrupt("return");case 5:return o.setButtonsDisable(!0),o.scene.player.setCoins(n-o.cost),e.next=9,t.increaseBoosterAmount(o.boosterKey,1);case 9:i=o.scene.player.getBoosterAmount(o.boosterKey),r=o.getBoosterButtonData(i),o.scene.screen.open(o.previousScreenKey,r),o.scene.screen.close(o.name),o.scene.logEconomy.logBuyBooster(o.boosterKey,o.cost,1);case 14:case"end":return e.stop()}}),e)}))),o.scene=t,o.previousScreenKey="",o.create(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this,t=new dw(this.scene,0,-17);this.add(t),t.buyButton.onClick=this.buy,t.closeButton.onClick=function(){e.scene.screen.open(e.previousScreenKey,{}),e.scene.screen.close(e.name)},this.buyingBoosterContainer=t},n.open=function(t){e.prototype.open.call(this,t),this.setButtonsDisable(!1),this.updateData(),this.runEntranceAnimation(),this.buyingBoosterContainer.runEntranceAnimation(),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY)},n.setButtonsDisable=function(e){var t=this.buyingBoosterContainer,n=t.buyButton,i=t.closeButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.updateData=function(){var e,t=this.buyingBoosterContainer,n=null==(e=this.data)?void 0:e.list,i=n.title,r=void 0===i?"":i,a=n.boosterFrame,s=void 0===a?"":a,o=n.description,c=void 0===o?"":o,h=n.cost,u=void 0===h?0:h,l=n.key,d=void 0===l?ji.NONE:l,p=n.previousScreenKey;this.previousScreenKey=p,this.cost=u,this.boosterKey=d;var f=this.scene.lang.getText(r),m=this.scene.lang.getText(c);t.setTitle(f),t.setBooster(s),t.setDescription(m),t.setCost(u)},n.close=function(){this.setButtonsDisable(!0),this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.buyingBoosterContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.buyingBoosterContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.getBoosterButtonData=function(e){var t={};switch(this.boosterKey){case ji.SLICE:return t={slice:{selected:!0,amount:e}};case ji.STORM:return t={storm:{selected:!0,amount:e}};case ji.WILD_CARD:return t={wildCard:{selected:!0,amount:e}}}return t},t}(GameCore.Screen),fw=pw,mw=109/3,gw=110/3,vw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).setSize(mw,gw),i.button.kill(),i.icon.setWorldSize(mw,gw),i.scene.add.existing((0,yc.Z)(i)),i}return(0,f.Z)(t,e),t.prototype.updateSize=function(){this.button.setWorldSize(mw,gw),e.prototype.updateSize.call(this)},t}(qg),yw=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).button=void 0,i.label=void 0,i.setSize(mw,gw),i.create(n),i.scene.add.existing((0,yc.Z)(i)),i}return(0,f.Z)(t,e),t.prototype.create=function(e){var t=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(11),text:"",origin:{x:.5,y:.5}});t.setTint(12870461);var n=new vw(this.scene,{enable:e.enable,frameOn:e.frameOn,frameOff:e.frameOff,backgroundOn:e.backgroundOn,backgroundOff:e.backgroundOff});this.add([n,t]),t.setY(28),this.button=n,this.label=t},t}(Phaser.GameObjects.Container),Ew=yw,Cw=Ki.Z.DEFAULT,ww=Cw.KEY,Aw=Cw.FRAME,bw=770/3,Sw=550/3,Tw=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).soundSwitchUI=void 0,r.musicSwitchUI=void 0,r.vibrationSwitchUI=void 0,r.endGameButton=void 0,r.closeButton=void 0,r.fanpageBtn=void 0,r.inviteFriendsBtn=void 0,r.title=void 0,r.setPosition(n,i),r.setSize(bw,Sw),r.createContent(),r.createCloseButton(),t.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle(),this.createToggleButtons()},n.createTitle=function(){var e=new Qp(this.scene,{text:this.scene.lang.Text.settings,fontSize:this.scene.fontSize(18),letterSpacingExtra:.6,fillColor:10775368});e.setPadding(2,2,2,2);var t=this.scene.add.image(0,0,ww,Aw.COMMON.TITLE_DECOR);t.setDefaultWorldSize(),this.add([e,t]),Phaser.Display.Align.In.TopCenter(e,this,-1,-12),Phaser.Display.Align.In.TopCenter(t,this,-.5,-34)},n.createToggleButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.createSoundButton(n),c=this.createMusicButton(r),h=this.createVibrationButton(s);this.add([o,c,h]),Phaser.Display.Align.In.Center(c,this,-51,10),Phaser.Display.Align.In.Center(o,this,0,10),Phaser.Display.Align.In.Center(h,this,53,10),cv()||(h.kill(),Phaser.Display.Align.In.Center(c,this,-24.2,10),Phaser.Display.Align.In.Center(o,this,24.2,10))},n.createSoundButton=function(e){var t=new Ew(this.scene,{enable:e,frameOn:Aw.SETTINGS.SOUND_ON,frameOff:Aw.SETTINGS.SOUND_OFF,backgroundOn:Aw.SETTINGS.SOUND_ON,backgroundOff:Aw.SETTINGS.SOUND_OFF});return t.button.setName("SoundSwitch"),t.button.updateStatus(e),this.soundSwitchUI=t,t},n.createMusicButton=function(e){var t=new Ew(this.scene,{enable:e,frameOn:Aw.SETTINGS.MUSIC_ON,frameOff:Aw.SETTINGS.MUSIC_OFF,backgroundOn:Aw.SETTINGS.MUSIC_ON,backgroundOff:Aw.SETTINGS.MUSIC_OFF});return t.button.setName("MusicSwitch"),t.button.updateStatus(e),this.musicSwitchUI=t,t},n.createVibrationButton=function(e){var t=new Ew(this.scene,{enable:e,frameOn:Aw.SETTINGS.VIBRATE_ON,frameOff:Aw.SETTINGS.VIBRATE_OFF,backgroundOn:Aw.SETTINGS.VIBRATE_ON,backgroundOff:Aw.SETTINGS.VIBRATE_OFF});return t.button.setName("VibrationSwitch"),t.button.updateStatus(e),this.vibrationSwitchUI=t,t},n.createCloseButton=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new ov.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.add(i),Phaser.Display.Align.In.TopRight(i,this,-19.5,-50.5),this.closeButton=i},t}(Phaser.GameObjects.Container),xw=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.settingsContainer=void 0,a.handleCloseScreen=function(){a.scene.screen.close(a.name)},a.handleSoundChange=function(e){a.scene.player.setSetting("sound",e)},a.handleMusicChanged=function(e){a.scene.player.setSetting("music",e),e?a.scene.resumeMusic():a.scene.audio.pauseAllMusics()},a.handleVibrationChanged=function(e){a.scene.player.setSetting("vibrate",e),e&&a.scene.vibration.performVibrating(50)},a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.scene.screen.close(a.name)}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.setDepth(de.Ks.POPUP),a.create(),a.background.setInteractive({useHandCursor:!0}),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.settingsContainer=new Tw(this.scene,0,1),this.settingsContainer.setInteractive(),this.add(this.settingsContainer);var e=this.settingsContainer,t=e.soundSwitchUI,n=e.musicSwitchUI,i=e.vibrationSwitchUI,r=e.closeButton;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),r.onClick=this.handleCloseScreen},n.open=function(){e.prototype.open.call(this),this.updateData(),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation(),this.background.off(Phaser.Input.Events.POINTER_DOWN)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.settingsContainer,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.updateStatus(n),h.button.updateStatus(r),u&&u.button.updateStatus(s)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.settingsContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.settingsContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen);var kw=function(e){function t(t,n){var i,r=n.text,a=n.width,s=n.height,o=n.key,c=n.frame;return(i=e.call(this,t,a,s)||this).text=void 0,i.background=void 0,i.createBackground(o,c),i.createText(r),i.add([i.background,i.text]),Phaser.Display.Align.In.Center(i.text,(0,yc.Z)(i),0,-1),i}(0,f.Z)(t,e);var n=t.prototype;return n.createBackground=function(e,t){this.background=this.scene.make.nineslice({key:e,frame:t,width:this.width,height:this.height,leftWidth:101/3,rightWidth:101/3})},n.createText=function(e){this.text=new Qp(this.scene,{text:e,fontSize:this.scene.fontSize(16.3),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,fillColor:16776958,letterSpacingExtra:.3})},t}(jp.Z),Pw=kw,Iw=Ki.Z.DEFAULT,Ow=Iw.KEY,Rw=Iw.FRAME,Bw=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.xIcon=void 0,r.valueText=void 0,r.scene=t,r.createIcon(n,i),r.createXIcon(),r.createValueText(),r.alignItems(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.setValue=function(e){isNaN(e)||e<0||(this.valueText.setText(e.toString()),this.setVisible(e>0))},n.showXIconAnimation=function(e){void 0===e&&(e=250),this.xIcon.setAlpha(0),this.xIcon.setAngle(-90),this.xIcon.setScale(0),this.scene.tweens.add({targets:this.xIcon,alpha:1,angle:{from:-90,to:0},duration:300,delay:e,ease:Phaser.Math.Easing.Cubic.Out}),this.scene.tweens.add({targets:this.xIcon,scale:{from:0,to:1/3},duration:300,delay:e,ease:Phaser.Math.Easing.Back.Out,easeParams:[3]})},n.hide=function(){this.setVisible(!1)},n.show=function(){this.setVisible(!0)},n.setLossIconVisible=function(e){this.setVisible(e),e?this.showXIconAnimation():this.hide()},n.alignItems=function(){Phaser.Display.Align.In.BottomRight(this.xIcon,this),Phaser.Display.Align.In.BottomCenter(this.valueText,this,0,19)},n.createIcon=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.setSize(n.width,45)},n.createXIcon=function(){var e=this.scene.add.image(0,0,Ow,Rw.EXIT_GAME_SCREEN.BUTTON_CLOSE);e.setDefaultWorldSize(),this.add(e),this.xIcon=e},n.createValueText=function(){var e=new Qp(this.scene,{fontSize:this.scene.fontSize(15),text:"21",fillColor:10775368});e.setCenterAlign(),this.add(e),this.valueText=e},t}(Phaser.GameObjects.Container),Dw=Bw,Lw=Ki.Z.DEFAULT,Mw=Lw.KEY,_w=Lw.FRAME,Nw={width:949/3,height:230},Gw={width:Nw.width-50,height:74},Fw={WIDTH:107,HEIGHT:42},Zw=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.titleText=void 0,r.content=void 0,r.message=void 0,r.playOnButton=void 0,r.endGameButton=void 0,r.gloveIcon=void 0,r.cupIcon=void 0,r.boatIcon=void 0,r.titleDecor=void 0,r.scene=t,r.setSize(Nw.width,Nw.height),r.create(),r.setPosition(n,i),r.alignItems(),r.setInteractive(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.message,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,r=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:r},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.updateTitle=function(e){this.titleText.setText(e)},n.updateMessage=function(e){this.message.setText(e)},n.updateEventItems=function(e){var t=e.boxingDuel,n=e.weeklyTournament,i=e.offshoreRace;this.gloveIcon.setValue(t),this.cupIcon.setValue(n),this.boatIcon.setValue(i);var r=[t,n,i].some((function(e){return e>0}));this.gloveIcon.setLossIconVisible(t>0),this.cupIcon.setLossIconVisible(n>0),this.boatIcon.setLossIconVisible(i>0);var a=r?0:40;this.content.setSizeByWorld(Gw.width,Gw.height+a),this.alignItems()},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,-1.3,-32),Phaser.Display.Align.To.BottomCenter(this.titleDecor,this.titleText,1.3,0),this.content.setPosition(0,-this.height/2+this.content.displayHeight/2+52),Phaser.Display.Align.In.BottomCenter(this.endGameButton,this,-55,8),Phaser.Display.Align.In.BottomCenter(this.playOnButton,this,56,8);var e=[this.gloveIcon,this.cupIcon,this.boatIcon].filter((function(e){return e.visible}));if(e.length>0){Phaser.Display.Align.In.TopCenter(this.message,this,-1,-148);var t=80*(e.length-1);e.forEach((function(e,n){e.setPosition(-t/2+80*n,-35)}))}else this.message.setY(this.content.y)},n.create=function(){this.createBackground(),this.createContentBackground(),this.createTitleText(),this.createTitleDecor(),this.createMessage(),this.createIcons(),this.createPlayOnButton(),this.createEndGameButton()},n.createBackground=function(){var e=new fy(this.scene,{key:Mw,frame:_w.EXIT_GAME_SCREEN.POP_UP_BASE,width:Nw.width,height:Nw.height,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createContentBackground=function(){var e=this.scene.make.nineslice({key:Mw,frame:_w.COMMON.POPUP_CONTENT_FULL,leftWidth:30,rightWidth:30,topHeight:65/3,bottomHeight:65/3,width:Gw.width,height:Gw.height});this.add(e),this.content=e},n.createTitleText=function(){this.titleText=new Qp(this.scene,{fontSize:this.scene.fontSize(18.46),text:this.scene.lang.Text.exitGame,fillColor:10775368,letterSpacingExtra:.6}),this.add([this.titleText])},n.createTitleDecor=function(){var e=this.scene.add.image(0,0,Mw,_w.COMMON.TITLE_DECOR);e.setDefaultWorldSize(),this.add(e),this.titleDecor=e},n.createMessage=function(){var e=new Qp(this.scene,{text:this.scene.lang.Text.quitLevel,fontSize:this.scene.fontSize(14.9),fillColor:10775368,letterSpacingExtra:.04});e.setPadding(2,2,2,2),e.setCenterAlign(),this.add(e),this.message=e},n.createIcons=function(){this.gloveIcon=new Dw(this.scene,Mw,_w.EXIT_GAME_SCREEN.ICON_GLOVE),this.cupIcon=new Dw(this.scene,Mw,_w.EXIT_GAME_SCREEN.ICON_CUP),this.boatIcon=new Dw(this.scene,Mw,_w.EXIT_GAME_SCREEN.ICON_BOAT),this.add(this.gloveIcon),this.add(this.cupIcon),this.add(this.boatIcon)},n.createPlayOnButton=function(){var e=new Pw(this.scene,{text:"Play On",key:Ki.Z.DASHBOARD.KEY,frame:Ki.Z.DASHBOARD.FRAME.BUTTON.BUTTON.GREEN_3,width:Fw.WIDTH,height:Fw.HEIGHT});this.add(e),e.setPosition(100,93),this.playOnButton=e},n.createEndGameButton=function(){var e=new Pw(this.scene,{text:"End Game",key:Ki.Z.DASHBOARD.KEY,frame:Ki.Z.DASHBOARD.FRAME.BUTTON.BUTTON.RED,width:Fw.WIDTH,height:Fw.HEIGHT});this.add(e),e.setPosition(100,93),this.endGameButton=e},t}(Phaser.GameObjects.Container),Uw=Zw,Ww=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.exitGameContainer=void 0,a.scene=t,a.create(),a.background.setInteractive({useHandCursor:!0}),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.listenEvents(),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this,t=this.exitGameContainer,n=t.endGameButton,i=t.playOnButton;n.onClick=function(){var t,n=null==(t=e.data)?void 0:t.list;n&&(e.scene.gameUI.hideUI(),n.exitCallback())},i.onClick=function(){var t,n=null==(t=e.data)?void 0:t.list;n&&n.playOnCallback()}},n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.scene.gameUI,r=t.eventItems,a=void 0===r?{boxingDuel:0,weeklyTournament:0,offshoreRace:0}:r;this.scene.children.sendToBack(i.coinBarButton),this.exitGameContainer.updateEventItems(a),function(e){var t=e.screen,n=e.mainContainer,i=e.onComplete,r=t.scene;r.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),r.tweens.timeline({tweens:[(0,p.Z)({targets:[n]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[t]},Sv.tweenConfigs.screen.configOpen)],onComplete:i})}({screen:this,mainContainer:this.exitGameContainer,onComplete:function(){n.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){var e,t=null==(e=n.data)?void 0:e.list;t&&t.playOnCallback()}))}}),this.exitGameContainer.runEntranceAnimation()},n.close=function(){var t=this;!function(e){var t=e.screen,n=e.mainContainer,i=e.onComplete,r=t.scene;r.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),r.tweens.timeline({tweens:[(0,p.Z)({targets:[n]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[t]},Sv.tweenConfigs.screen.configClose)],onComplete:i})}({screen:this,mainContainer:this.exitGameContainer,onComplete:function(){e.prototype.close.call(t)}}),this.background.off(Phaser.Input.Events.POINTER_DOWN)},n.create=function(){this.exitGameContainer=new Uw(this.scene,0,-18),this.add(this.exitGameContainer)},t}(GameCore.Screen),Yw=Ki.Z.DEFAULT,Hw=Yw.KEY,zw=Yw.FRAME,Kw={width:326,height:823/3},Vw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.levelDecoration=void 0,n.xContainer=void 0,n.description=void 0,n.closeButton=void 0,n.getNowButton=void 0,n.illustration=void 0,n.background=void 0,n.scene=t,n.setSize(Kw.width,Kw.height),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateClaimedCoinText=function(e){this.description.setText("Watch a video to get "+e+" coins")},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-14),Phaser.Display.Align.In.TopCenter(this.levelDecoration,this,0,-35),Phaser.Display.Align.In.TopRight(this.xContainer,this,-19.5,-52.5),Phaser.Display.Align.In.TopCenter(this.illustration,this,0,-45.5),Phaser.Display.Align.In.Center(this.description,this,0,68),Phaser.Display.Align.In.BottomCenter(this.getNowButton,this,0,-11.5)},n.create=function(){this.createBackground(),this.createIllustration(),this.createCloseButton(),this.createTitleText(),this.createDescription(),this.createGetNowButton()},n.createBackground=function(){var e=new fy(this.scene,{key:Hw,frame:zw.COMMON.NEW_POPUP_BASE,width:Kw.width,height:Kw.height,topHeight:200/3,bottomHeight:200/3});this.add(e),this.background=e},n.createIllustration=function(){var e=this.scene.add.image(0,0,Hw,zw.GET_MORE_COIN_SCREEN.ILLUSTRATION);e.setDefaultWorldSize(),this.add(e),this.illustration=e},n.createCloseButton=function(){this.xContainer=this.scene.add.container(0,0),this.add(this.xContainer);var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new ov.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.xContainer.setSize(40/3,14),this.xContainer.add(i),this.closeButton=i},n.createTitleText=function(){this.titleText=new Qp(this.scene,{text:this.scene.lang.Text.earnExtraCoins,fontSize:this.scene.fontSize(18),fillColor:11167815}),this.titleText.setCenterAlign(),this.add(this.titleText),this.levelDecoration=this.scene.add.image(0,1,Hw,zw.COMMON.TITLE_DECOR),this.levelDecoration.setDefaultWorldSize(),this.add(this.levelDecoration)},n.createDescription=function(){var e=new Qp(this.scene,{text:"Watch a video to get 300 coins",fontSize:this.scene.fontSize(15),fillColor:11167815});e.setCenterAlign(),this.add(e),this.description=e},n.createGetNowButton=function(){var e=new oy(this.scene,{key:Ki.Z.DASHBOARD.KEY,buttonFrame:Ki.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_GREEN,buttonWidth:436/3,buttonHeight:42,buttonInnerWidth:436/3});this.add(e),e.setPosition(100,93),this.getNowButton=e,this.getNowButton.button.setName("GetNow");var t=this.scene.add.image(0,0,Hw,zw.GET_MORE_COIN_SCREEN.NEW_ICON_AD);t.setDefaultWorldSize(),t.setPosition(-38,-1),this.getNowButton.addIntoButton(t);var n=new Qp(this.scene,{text:this.scene.lang.Text.getNow,fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(17,-1),this.getNowButton.addIntoButton(n)},t}(Phaser.GameObjects.Container),Xw=Vw,jw=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.getCoinsContainer=void 0,o.previousScreen=void 0,o.claimedCoin=void 0,o.isOpening=void 0,o.handleClose=function(){o.scene.screen.close(o.name)},o.handleGetNow=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.scene.showRewardedVideoAsync();case 2:if(!e.sent){e.next=14;break}if(o.scene.tweens.add({targets:o.getCoinsContainer,alpha:0,scale:.5,duration:300,ease:Phaser.Math.Easing.Back.Out}),t=o.scene.gameUI.isCoinShowing()){e.next=10;break}return o.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),e.next=10,o.scene.gameUI.showCoin();case 10:n=o.getCoinsContainer.illustration.getWorldPosition(),i=n.x,r=n.y,o.scene.rewardManager.rewardCoin(o.claimedCoin),o.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,i,r).then((function(){o.scene.screen.close(o.name),t||(0,gl.Z)(o.scene,1e3).then((function(){o.scene.gameUI.hideCoin()}))})),o.scene.logEconomy.logGetItem(yl.COIN,o.claimedCoin,Cl.GET_MORE_COIN_AD);case 14:case"end":return e.stop()}}),e)}))),o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.isOpening=!1,o.getCoinsContainer.setAlpha(1),o.getCoinsContainer.setScale(1),o.previousScreen&&o.scene.screen.open(o.previousScreen)},o.scene=t,o.create(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),o.listenEvents(),o.isOpening=!1,Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.getCoinsContainer,t=e.closeButton,n=e.getNowButton;t.onClick=this.handleClose,n.onClick=this.handleGetNow},n.create=function(){var e=new Xw(this.scene);this.add(e),this.getCoinsContainer=e},n.open=function(t){this.isOpening||(this.scene.events.emit(pi.HIDE_GUIDE),this.isOpening=!0,e.prototype.open.call(this,t),this.previousScreen=null==t?void 0:t.previousScreen,this.updateData(),this.setButtonsDisable(!1),this.runEntranceAnimation())},n.updateData=function(){var e,t=(null!=(e=this.data.list)?e:{}).claimedCoin,n=void 0===t?300:t;this.claimedCoin=n,this.getCoinsContainer.updateClaimedCoinText(n)},n.setButtonsDisable=function(e){var t=this.getCoinsContainer,n=t.closeButton,i=t.getNowButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.close=function(){this.background.off(Phaser.Input.Events.POINTER_DOWN),this.setButtonsDisable(!0),this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.getCoinsContainer]},Sv.tweenConfigs.popup.configOpen,{duration:600}),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.getCoinsContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),qw=jw,Jw=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.guideContainer=void 0,a.testImage=void 0,a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.scene.screen.close(a.name)}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.setDepth(de.Ks.POPUP),a.create(),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new ym(this.scene,0,0);this.add(e),Phaser.Display.Align.In.Center(e,this,0,40),this.guideContainer=e},n.open=function(t){e.prototype.open.call(this,t),this.updateData(t),this.runEntranceAnimation()},n.updateData=function(e){var t=Ki.Z.GAMEPLAY_DEFAULT,n=t.KEY,i=t.FRAME,r=e,a=r.x,s=void 0===a?0:a,o=r.y,c=void 0===o?0:o,h=r.background,u=h.scaleX,l=void 0===u?1:u,d=h.scaleY,p=void 0===d?1:d,f=r.textBox,m=f.x,g=void 0===m?0:m,v=f.y,y=void 0===v?0:v,E=f.text,C=void 0===E?"":E,w=f.textAlignType,A=void 0===w?cu.CENTER:w,b=r.icon,S=b.x,T=void 0===S?0:S,x=b.y,k=void 0===x?0:x,P=b.key,I=void 0===P?n:P,O=b.frame,R=void 0===O?i.TUTORIAL.ARROW_DOWN:O,B=b.visible,D=void 0===B||B,L=r.backgroundInteractive;void 0===L||L?this.background.setInteractive({useHandCursor:!0}):this.background.disableInteractive();var M=this.guideContainer,_=M.shadow,N=M.bg,G=M.text,F=M.icon;_.setVisible(!0),N.setVisible(!1),this.guideContainer.setText(C,A),this.guideContainer.setPosition(s,c),this.guideContainer.updateIcon(I,R,D),_.setScaleByWorld(l,p),_.setPosition(g,y+5),G.setPosition(g,y),N.setPosition(g,y),F.setPosition(T,k)},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),Qw=Jw,$w=Ki.Z.DASHBOARD,eA=$w.KEY,tA=$w.FRAME,nA=290,iA=190,rA={width:nA-38,height:80},aA=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.content=void 0,n.message=void 0,n.playOnButton=void 0,n.endGameButton=void 0,n.titleDecor=void 0,n.scene=t,n.setSize(nA,iA),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.message,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,r=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:r},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-14),Phaser.Display.Align.In.TopCenter(this.titleDecor,this.titleText,0,-22),this.content.setPosition(0,-this.height/2+this.content.displayHeight/2+50),this.message.setY(this.content.y),Phaser.Display.Align.In.BottomCenter(this.endGameButton,this,0,-7)},n.create=function(){this.createBackground(),this.createContentBackground(),this.createTitleText(),this.createMessage(),this.createEndGameButton()},n.createBackground=function(){var e=new fy(this.scene,{key:Ki.Z.DEFAULT.KEY,frame:Ki.Z.DEFAULT.FRAME.COMMON.NEW_POPUP_BASE,width:nA,height:iA,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createContentBackground=function(){var e=this.scene.make.nineslice({key:Ki.Z.DEFAULT.KEY,frame:Ki.Z.DEFAULT.FRAME.COMMON.POPUP_CONTENT_FULL,leftWidth:65/3,rightWidth:30,topHeight:85/3,bottomHeight:65/3,width:rA.width,height:rA.height});this.add(e),this.content=e},n.createTitleText=function(){this.titleText=new Qp(this.scene,{text:this.scene.lang.Text.bombDetonated,fontSize:this.scene.fontSize(16),fillColor:10775368}),this.titleText.setCenterAlign(),this.titleText.setPadding(2,2,2,2),this.titleDecor=this.scene.add.image(0,0,Ki.Z.DEFAULT.KEY,Ki.Z.DEFAULT.FRAME.COMMON.TITLE_DECOR),this.titleDecor.setDefaultWorldSize(),this.add(this.titleText),this.add(this.titleDecor)},n.createMessage=function(){var e=new Qp(this.scene,{text:this.scene.lang.Text.tipPlayBomb,fontSize:this.scene.fontSize(17),fillColor:10775368});e.setCenterAlign(),this.add(e),this.message=e},n.createEndGameButton=function(){var e=this,t=new Pw(this.scene,{text:this.scene.lang.Text.endGame,key:eA,frame:tA.BUTTON.BUTTON.RED,width:388/3,height:145/3});this.add(t),t.setPosition(100,93),this.endGameButton=t,t.onClick=function(){e.scene.gameplay.boardGame.stateMachine.emit(tu.LOSE),e.scene.screen.close(de.o4.NOTIFY_BOMB_SCREEN)}},t}(Phaser.GameObjects.Container),sA=aA,oA=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.notifyBombContainer=void 0,a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return a.scene.screen.close(a.name)}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.notifyBombContainer=new sA(this.scene),this.add(this.notifyBombContainer)},n.open=function(t){e.prototype.open.call(this,t),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.END_GAME),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.notifyBombContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.notifyBombContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),cA=oA,hA=Ki.Z.DEFAULT,uA=hA.KEY,lA=hA.FRAME,dA=270,pA=266,fA={width:dA+21,height:pA+20},mA=270,gA=46,vA=270,yA=220,EA=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.heartContainer=void 0,n.buyHeartButton=void 0,n.closeButton=void 0,n.content=void 0,n.addHeart=function(){var e=n.scene.player.getCoins(),t=Vi.PLUS_A_HEART;n.scene.player.setCoins(e-t),n.scene.tweens.add({targets:(0,yc.Z)(n),alpha:0,scale:0,duration:400,ease:Phaser.Math.Easing.Sine.In}),n.scene.screen.close(de.o4.OUT_OF_HEARTS_SCREEN),n.scene.rewardManager.rewardHeart(1)},n.scene=t,n.setSize(dA,pA),n.create(),n.createBuyHeartButton(),n.createCloseButton(),n}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createShadow(),this.createHeader(),this.createContent()},n.createShadow=function(){var e=this.scene.make.nineslice({key:uA,frame:lA.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:fA.width,height:fA.height});e.setY(10),this.add(e)},n.createHeader=function(){var e=this.scene.add.container();e.setSize(mA,gA);var t=this.scene.make.nineslice({key:uA,frame:lA.THREE_SLICE.HEADER,leftWidth:23,rightWidth:23,topHeight:22,bottomHeight:0,width:mA,height:gA}),n=new pv(this.scene);n.setText("Get More Lives!"),n.setColor(7162732),n.setFontSize(20),e.add([t,n]),this.add(e),Phaser.Display.Align.In.TopCenter(e,this)},n.createContent=function(){this.content=this.scene.add.container(),this.content.setSize(vA,yA),this.createBackground(),this.createIcons(),this.add(this.content),Phaser.Display.Align.In.BottomCenter(this.content,this)},n.createBackground=function(){var e=this.scene.add.container();e.setSize(vA,yA);var t=this.scene.make.nineslice({key:uA,frame:lA.NINE_SLICE.POPUP_BG,leftWidth:23,rightWidth:23,topHeight:0,bottomHeight:22,width:vA,height:yA}),n=this.scene.make.nineslice({key:uA,frame:lA.NINE_SLICE.POPUP_CONTENT,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,width:vA-20,height:140});e.add([t,n]),n.setY(-29),this.content.add(e)},n.runEntranceAnimation=function(){var e=[this.buyHeartButton,this.heartContainer],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){e.setScale(0),t.add({targets:[e],scale:{from:0,to:1},duration:300,ease:Phaser.Math.Easing.Back.Out,delay:0==n?250:0,offset:0==n?0:"-=200"})})),t.play()},n.createIcons=function(){var e=Ki.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.container(0,0),r=this.scene.add.image(0,0,t,n.IC_HEART);r.setScaleByWorld(2),i.setSize(r.width,r.height);var a=this.scene.make.bitmapText({font:Rc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(20),origin:{x:.5,y:.5},text:"+1"});i.add([r,a]),this.content.add(i),Phaser.Display.Align.In.Center(a,i,-2,-1),Phaser.Display.Align.In.Center(i,this.content,0,-32),this.heartContainer=i},n.createCloseButton=function(){var e=this,t=Ki.Z.DEFAULT,n=t.KEY,i=t.FRAME,r=new ov.Z(this.scene,{key:n,frame:i.COMMON.BTN_CLOSE,width:15,height:14.5,paddingZone:30});r.setName("Close"),r.onClick=function(){e.setButtonsDisable(!0),e.scene.screen.close(de.o4.OUT_OF_HEARTS_SCREEN)},this.add(r),this.closeButton=r,Phaser.Display.Align.In.TopRight(r,this,-12,-12)},n.createBuyHeartButton=function(){var e=this,t=new sv(this.scene,uA,lA.BUTTON.GREEN_60,122.5,47.5);t.setName("BuyHeart");var n=this.scene.make.bitmapText({font:Rc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(25),text:Vi.PLUS_A_HEART.toString(),origin:{x:.5,y:.5}}),i=this.scene.add.image(0,0,Ki.Z.DEFAULT.KEY,Ki.Z.DEFAULT.FRAME.COMMON.IC_BIG_COIN);i.setDefaultWorldSize(),t.add([n,i]),t.onClick=function(){e.scene.player.getCoins()>=Vi.PLUS_A_HEART?(e.setButtonsDisable(!0),e.addHeart()):e.scene.screen.open(de.o4.GET_COINS_SCREEN,{claimedCoin:vf.instance.reward.rewardedAdOffer})},this.add(t),Phaser.Display.Align.In.Center(i,t,-25),Phaser.Display.Align.In.Center(n,t,15,-1),Phaser.Display.Align.In.BottomCenter(t,this,0,-8),this.buyHeartButton=t},n.setButtonsDisable=function(e){this.buyHeartButton.setDisabled(e),this.closeButton.setDisabled(e),this.buyHeartButton.setAlpha(1),this.closeButton.setAlpha(1)},t}(Phaser.GameObjects.Container),CA=EA,wA=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.outOfHeartsContainer=void 0,a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return a.scene.screen.close(a.name)}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a)),a.scene.life.getHearts()<a.scene.life.getMaxHearts()&&a.scene.gameUI.lifeBarButton.setDisabled(!1)},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.outOfHeartsContainer=new CA(this.scene),this.add(this.outOfHeartsContainer)},n.open=function(t){e.prototype.open.call(this,t),this.scene.gameUI.lifeBarButton.setDisabled(!0),this.outOfHeartsContainer.setButtonsDisable(!1),this.outOfHeartsContainer.setAlpha(1),this.runEntranceAnimation(),this.outOfHeartsContainer.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.outOfHeartsContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.outOfHeartsContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),AA=wA;function bA(e){for(var t=e.length-1;t>0;t--){var n=e[t],i=e[t-1];if(n.v!=i.v||"stepped"!==i.curve&&"linear"!==i.curve)break;e.pop()}return e}function SA(e,t,n,i,r,a){return{curve:i==n?0:(e[4*t+0]-n)/(i-n)||0,c2:a==r?0:(e[4*t+1]-r)/(a-r)||0,c3:i==n?0:(e[4*t+2]-n)/(i-n)||1,c4:a==r?0:(e[4*t+3]-r)/(a-r)||1}}var TA=function(e){var t=e.target;return(0,p.Z)({},function(e,t){void 0===t&&(t=[]);function n(e){e=e.replace(/^#/,"");var t=parseInt(e,16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:255&t}}for(var i=e.tint||16777215,r=Phaser.Display.Color.ColorToRGBA(i),a=r.r,s=r.g,o=r.b,c=(r.a,e.alpha),h=[],u=[],l=[],d=[],f=0;f<t.length;f++){var m=t[f],g=c,v=a,y=s,E=o;if(m.color){var C=n(m.color);g=C.a/255,v=C.r,y=C.g,E=C.b}var w={curve:"linear",c2:0,c3:1,c4:1},A={curve:"linear",c2:0,c3:1,c4:1},b={curve:"linear",c2:0,c3:1,c4:1},S={curve:"linear",c2:0,c3:1,c4:1};if(m.curve instanceof Array){t.length;var T=t[f+1],x=c,k=a,P=s,I=o;if(T.color){var O=n(T.color);x=O.a/255,k=O.r,P=O.g,I=O.b}var R=m.time||0,B=T.time||1,D=v,L=k,M=y,_=P,N=E,G=I,F=g,Z=x;w=SA(m.curve,0,R,B,D,L),A=SA(m.curve,1,R,B,M,_),b=SA(m.curve,2,R,B,N,G),S=SA(m.curve,3,R,B,F,Z)}else A=w=(0,p.Z)({},w,m,{curve:void 0===m.curve?w.curve:m.curve}),b=w,S=w;d.push((0,p.Z)({time:0,v:g},m,S)),h.push((0,p.Z)({time:0,v:v},m,w)),u.push((0,p.Z)({time:0,v:y},m,A)),l.push((0,p.Z)({time:0,v:E},m,b))}bA(d);var U=e.setTint;return U&&"function"===typeof U?{tintR:h,tintG:u,tintB:l,alpha:d}:{tintR:[],tintB:[],tintG:[],alpha:d}}(t,e.color||e.rgba),function(e,t){void 0===t&&(t=[]);for(var n=e.scaleX,i=e.scaleY,r=[],a=[],s=0;s<t.length;s++){var o=t[s],c={curve:"linear",c2:0,c3:1,c4:1},h={curve:"linear",c2:0,c3:1,c4:1};if(o.curve instanceof Array){t.length;var u=t[s+1],l=o.time||0,d=u.time||1,f=o.x||0,m=u.x||0,g=o.y||0,v=u.y||0;c=SA(o.curve,0,l,d,f,m),h=SA(o.curve,1,l,d,g,v)}else h=c=(0,p.Z)({},c,o,{curve:void 0===o.curve?c.curve:o.curve});r.push((0,p.Z)({time:0,v:void 0==o.x?n:o.x*n},o,c)),a.push((0,p.Z)({time:0,v:void 0==o.y?i:o.y*i},o,h))}return bA(r),bA(a),{scaleX:r,scaleY:a}}(t,e.scale),function(e,t,n){void 0===t&&(t=[]);for(var i=e.x,r=e.y,a=[],s=[],o=(null==n?void 0:n.translate)||"default",c=VA.WORLD_SCALE,h=0;h<t.length;h++){var u=t[h],l={curve:"linear",c2:0,c3:1,c4:1},d={curve:"linear",c2:0,c3:1,c4:1};if(u.curve instanceof Array){t.length;var f=t[h+1],m=u.time||0,g=f.time||1,v=u.x||0,y=f.x||0,E=u.y||0,C=f.y||0;l=SA(u.curve,0,m,g,v,y),d=SA(u.curve,1,m,g,E,C)}else d=l=(0,p.Z)({},l,u,{curve:void 0===u.curve?l.curve:u.curve});switch(o){case"default":a.push((0,p.Z)({time:0,v:void 0==u.x?i:u.x*c+i},u,l)),s.push((0,p.Z)({time:0,v:void 0==u.y?r:-u.y*c+r},u,d));break;case"correctPosition":a.push((0,p.Z)({time:0,v:void 0==u.x?i:u.x},u,l)),s.push((0,p.Z)({time:0,v:void 0==u.y?r:u.y},u,d))}}return bA(a),bA(s),{x:a,y:s}}(t,e.translate,e.mode),function(e,t){void 0===t&&(t=[]);for(var n=e.angle,i=[],r=0;r<t.length;r++){var a=t[r],s={curve:"linear",c2:0,c3:1,c4:1};if(a.curve instanceof Array){t.length;var o=t[r+1],c=a.time||0,h=o.time||1,u=a.angle||a.value||0,l=o.angle||o.value||0;s=SA(a.curve,0,c,h,u,l)}else s=(0,p.Z)({},s,a,{curve:void 0===a.curve?s.curve:a.curve});i.push((0,p.Z)({time:0,v:void 0==a.angle?void 0==a.value?n:-a.value:-a.angle},a,s))}return bA(i),{angle:i}}(t,e.rotate),function(e,t){void 0===t&&(t=[]);e.angle;var n=[],i=e.spineConfig;if(void 0===i)return{deform:[]};for(var r=i.vertices,a=function(){var e=t[s],i=e.vertices,a=e.offset||0,o={curve:"linear",c2:0,c3:1,c4:1};if(e.curve instanceof Array){t.length;var c=t[s+1],h=e.time||0,u=c.time||1,l=0,d=1;o=SA(e.curve,0,h,u,l,d)}else o=(0,p.Z)({},o,e,{curve:void 0===e.curve?o.curve:e.curve});n.push((0,p.Z)({time:0,v:void 0==i?r:r.map((function(e,t){return t<a?e:e+(i[t-a]||0)}))},e,o))},s=0;s<t.length;s++)a();return function(e){for(var t=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},n=e.length-1;n>0;n--){var i=e[n],r=e[n-1];if(!t(i.v,r.v)||"stepped"!==r.curve&&"linear"!==r.curve)break;e.pop()}1===e.length&&e.pop()}(n),{deform:n}}(t,e.deform),function(e,t){void 0===t&&(t=[]);for(var n=e.shearX,i=e.shearY,r=[],a=[],s=0;s<t.length;s++){var o=t[s],c={curve:"linear",c2:0,c3:1,c4:1},h={curve:"linear",c2:0,c3:1,c4:1};if(o.curve instanceof Array){t.length;var u=t[s+1],l=o.time||0,d=u.time||1,f=o.x||0,m=u.x||0,g=o.y||0,v=u.y||0;c=SA(o.curve,0,l,d,f,m),h=SA(o.curve,1,l,d,g,v)}else h=c=(0,p.Z)({},c,o,{curve:void 0===o.curve?c.curve:o.curve});r.push((0,p.Z)({time:0,v:void 0==o.x?n:o.x},o,c)),a.push((0,p.Z)({time:0,v:void 0==o.y?i:o.y},o,h))}return bA(r),bA(a),{shearX:r,shearY:a}}(t,e.shear),function(e,t){void 0===t&&(t=[]);for(var n=0,i=[],r=0;r<t.length;r++){var a=t[r],s={curve:"linear",c2:0,c3:1,c4:1};if(a.curve instanceof Array){t.length;var o=t[r+1],c=a.time||0,h=o.time||1,u=0,l=1;s=SA(a.curve,0,c,h,u,l)}else s=(0,p.Z)({},s,a,{curve:void 0===a.curve?s.curve:a.curve});i.push((0,p.Z)({time:0,v:void 0==a.position?n:a.position},a,s))}return bA(i),{position:i}}(0,e.position),function(e,t){void 0===t&&(t=[]);if(e instanceof Phaser.GameObjects.Image){for(var n=e.frame.name,i=Number(n.match(/\d+/))||1,r=[],a=0;a<t.length;a++){var s,o=t[a],c=Number(null==(s=o.name)?void 0:s.match(/\d+/))||i;r.push((0,p.Z)({time:0,v:c},o,{curve:"stepped",c2:0,c3:1,c4:1}))}return bA(r),{attachment:r}}return{attachment:[]}}(t,e.attachment))},xA=n(11),kA=n.n(xA);function PA(e,t){return void 0===t&&(t=!1),function(t){var n,i,r=t/1e3;if(r<e[0].time)return e[0].v;for(var a=0;a<e.length-1;a++)if(r>=e[a].time&&r<=e[a+1].time){n=e[a],i=e[a+1];break}if(n&&i){if("stepped"===n.curve)return n.v;var s=(r-n.time)/(i.time-n.time),o="linear"===n.curve?s:kA()(Phaser.Math.Clamp(n.curve,0,1),n.c2,Phaser.Math.Clamp(n.c3,0,1),n.c4)(s);return n.v+(i.v-n.v)*o}return e[e.length-1].v}}var IA={tintR:[],tintG:[],tintB:[],alpha:[],scaleX:[],scaleY:[],x:[],y:[],angle:[],deform:[],shearX:[],shearY:[],position:[],attachment:[]},OA=function(){function e(e,t){this.gameObject=void 0,this.tweenAnimationGraph=void 0,this.minTime=void 0,this.maxTime=void 0,this.gameObject=e,this.tweenAnimationGraph=t||IA}var t=e.prototype;return t.start=function(){},t.update=function(e){},t.complete=function(){},t.applyMinMaxTime=function(e){if(1===e.length)return this.minTime=0,void(this.maxTime=0);for(var t=0;t<e.length;t++){var n=e[t];(void 0===this.minTime||this.minTime>n.time)&&(this.minTime=n.time),(void 0===this.maxTime||this.maxTime<n.time)&&(this.maxTime=n.time)}},e}(),RA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.alpha),i.applyMinMaxTime(n.alpha),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.alpha=t},t}(OA);function BA(e,t){return void 0===t&&(t=!1),function(t){var n,i,r=t/1e3;if(r<e[0].time)return e[0].v;for(var a=0;a<e.length-1;a++)if(r>=e[a].time&&r<=e[a+1].time){n=e[a],i=e[a+1];break}if(n&&i){if("stepped"===n.curve)return n.v;var s=(r-n.time)/(i.time-n.time),o="linear"===n.curve?s:kA()(Phaser.Math.Clamp(n.curve,0,1),n.c2,Phaser.Math.Clamp(n.c3,0,1),n.c4)(s),c=i.v,h=n.v,u=c-h;return u<-180?u+=360:u>180&&(u-=360),h+u*o}return e[e.length-1].v}}var DA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=BA(n.angle),i.applyMinMaxTime(n.angle),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.angle=t},t}(OA),LA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.attachment),i.applyMinMaxTime(n.attachment),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=Math.ceil(this.curve(e));if(this.gameObject instanceof Phaser.GameObjects.Image){var n=this.gameObject.frame.name.split("-")[0];this.gameObject.setFrame(n+"-"+t,!1,!1)}},t}(OA);var MA=function(e){function t(t,n){var i,r,a;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=(r=n.deform,void 0===a&&(a=!1),function(e){var t,n,i=e/1e3;if(i<r[0].time)return r[0].v;for(var a=0;a<r.length-1;a++)if(i>=r[a].time&&i<=r[a+1].time){t=r[a],n=r[a+1];break}if(t&&n){if("stepped"===t.curve)return t.v;for(var s=(i-t.time)/(n.time-t.time),o="linear"===t.curve?s:kA()(Phaser.Math.Clamp(t.curve,0,1),t.c2,Phaser.Math.Clamp(t.c3,0,1),t.c4)(s),c=[],h=0;h<t.v.length;h++){var u=t.v[h]+(n.v[h]-t.v[h])*o;c.push(u)}return c}return r[r.length-1].v}),i.applyMinMaxTime(n.deform),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.gameObject.setVertices;if(t&&"function"===typeof t){var n=this.curve(e);t.bind(this.gameObject)(n)}},t}(OA),_A=function(e){function t(t,n){var i;return(i=e.call(this,t.gameObject)||this).lastT=void 0,i.eventKeyFrames=void 0,i.currentIndex=0,i.animation=void 0,i.eventKeyFrames=n,i.animation=t,i.applyMinMaxTimeEvent(n),i}(0,f.Z)(t,e);var n=t.prototype;return n.start=function(){this.lastT=void 0,this.currentIndex=0},n.update=function(e){void 0===this.lastT&&(this.lastT=e,e+=1e-8);for(var t=this.currentIndex;t<this.eventKeyFrames.length;t++){var n=this.eventKeyFrames[t],i=1e3*n.time;this.lastT<=i&&e>i&&(this.animation.events.emit(n.eventName),this.animation.parent&&this.animation.parent.emitEvent(n.eventName),this.currentIndex=t+1)}this.lastT=e},n.complete=function(){if(this.currentIndex<this.eventKeyFrames.length)for(var e=this.currentIndex;e<this.eventKeyFrames.length;e++){var t=this.eventKeyFrames[e];this.animation.events.emit(t.eventName),this.animation.parent&&this.animation.parent.emitEvent(t.eventName),this.currentIndex=e+1}},n.applyMinMaxTimeEvent=function(e){for(var t=0;t<e.length;t++){var n=e[t];(void 0===this.minTime||this.minTime>n.time)&&(this.minTime=n.time),(void 0===this.maxTime||this.maxTime<n.time)&&(this.maxTime=n.time)}},t}(OA),NA=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n)||this).curve=void 0,r.path=void 0,r.path=i,r.curve=PA(n.position),r.applyMinMaxTime(n.position),r}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=Phaser.Math.Clamp(this.curve(e),0,1),n=this.path.getPoint(t);this.gameObject.x=n.x,this.gameObject.y=n.y},t}(OA),GA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.scaleX),i.applyMinMaxTime(n.scaleX),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.scaleX=t},t}(OA),FA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.scaleY),i.applyMinMaxTime(n.scaleY),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.scaleY=t},t}(OA),ZA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=BA(n.shearX),i.applyMinMaxTime(n.shearX),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.shearX=t},t}(OA),UA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=BA(n.shearY),i.applyMinMaxTime(n.shearY),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.shearY=t},t}(OA),WA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curveR=void 0,i.curveG=void 0,i.curveB=void 0,i.curveR=PA(n.tintR),i.curveG=PA(n.tintG),i.curveB=PA(n.tintB),i.applyMinMaxTime(n.tintR),i.applyMinMaxTime(n.tintG),i.applyMinMaxTime(n.tintB),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.gameObject.setTint;if(t&&"function"===typeof t){var n=this.curveR(e),i=this.curveG(e),r=this.curveB(e);t.bind(this.gameObject)(Phaser.Display.Color.GetColor(n,i,r))}},t}(OA),YA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.x),i.applyMinMaxTime(n.x),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.x=t},t}(OA),HA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=PA(n.y),i.applyMinMaxTime(n.y),i}return(0,f.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.y=t},t}(OA),zA=function(){function e(e){this.scene=void 0,this.events=void 0,this.parent=void 0,this.gameObject=void 0,this.spineGraph=void 0,this.tweenGraph=void 0,this.updateBehaviours=[],this.tween=void 0,this.duration=0,this.timeScale=1,this.delay=0;var t=e.target;this.events=new Phaser.Events.EventEmitter,this.scene=t.scene,this.gameObject=t,this.spineGraph=e,this.tweenGraph=TA(e),this.addBehaviours(),this.setDelay(this.spineGraph.delay)}var t=e.prototype;return t.addBehaviours=function(){var e=this.gameObject,t=this.tweenGraph;this.tweenGraph.alpha.length>=1&&this.updateBehaviours.push(new RA(e,t)),this.tweenGraph.angle.length>=1&&this.updateBehaviours.push(new DA(e,t)),this.tweenGraph.scaleX.length>=1&&this.updateBehaviours.push(new GA(e,t)),this.tweenGraph.scaleY.length>=1&&this.updateBehaviours.push(new FA(e,t)),(this.tweenGraph.tintR.length>=1||this.tweenGraph.tintG.length>=1||this.tweenGraph.tintB.length>=1)&&this.updateBehaviours.push(new WA(e,t)),this.tweenGraph.x.length>=1&&this.updateBehaviours.push(new YA(e,t)),this.tweenGraph.y.length>=1&&this.updateBehaviours.push(new HA(e,t)),this.tweenGraph.deform.length>=1&&this.updateBehaviours.push(new MA(e,t)),this.spineGraph.event&&this.spineGraph.event.length>=1&&this.updateBehaviours.push(new _A(this,this.spineGraph.event)),this.tweenGraph.shearX.length>=1&&this.updateBehaviours.push(new ZA(e,t)),this.tweenGraph.shearX.length>=1&&this.updateBehaviours.push(new UA(e,t)),this.tweenGraph.position.length>=1&&this.spineGraph.path&&this.updateBehaviours.push(new NA(e,t,this.spineGraph.path)),this.tweenGraph.attachment.length>=1&&this.updateBehaviours.push(new LA(e,t)),this.duration=1e3*Math.max.apply(Math,this.updateBehaviours.map((function(e){return e.maxTime})))},t.start=function(){var e=this;return new Promise((function(t){e.stop();var n=e.delay||0;e.events.emit("start");for(var i=0;i<e.updateBehaviours.length;i++)e.updateBehaviours[i].start(),e.updateBehaviours[i].update(-n);var r=!1,a=e.scene.tweens.addCounter({from:-n,to:e.duration,duration:e.duration+n,onUpdate:function(t){var n=t.getValue();!r&&n>=0&&(e.events.emit("startDelay"),e.parent&&e.parent.emitEvent("startDelay"),r=!0);for(var i=0;i<e.updateBehaviours.length;i++)e.updateBehaviours[i].update(n);e.spineGraph.onUpdate&&e.spineGraph.onUpdate(n)},loop:e.spineGraph.loop,onComplete:function(){e.events.emit("complete"),e.tween=void 0;for(var n=0;n<e.updateBehaviours.length;n++)e.updateBehaviours[n].complete();t()}});a.setTimeScale(e.timeScale),e.tween=a}))},t.stop=function(){this.tween&&(this.events.emit("stop"),this.tween.complete())},t.seek=function(e){for(var t=this.updateBehaviours.filter((function(e){return!(e instanceof _A)})),n=0;n<t.length;n++)this.updateBehaviours[n].update(e)},t.setTimeScale=function(e){void 0===e&&(e=1),this.timeScale=e},t.setDelay=function(e){this.delay=e||0},(0,X.Z)(e,[{key:"isPlaying",get:function(){return!!this.tween}}]),e}(),KA=function(){function e(e){this.events=void 0,this.parent=void 0,this.children=[],this.timeScale=1,this.loop=0,this.tweenLoopAnimation=void 0,this.events=new Phaser.Events.EventEmitter,this.createAnimation(e)}var t=e.prototype;return t.createAnimation=function(e){for(var t=0;t<e.length;t++){var n=e[t].target;Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var r=e[t].delay||0;"function"===typeof r&&(r=r(n[i],"",0,i,n.length)),this.addAnimation(new zA((0,p.Z)({},e[t],{target:n[i],delay:r})))}}},t.addAnimationGraph=function(e){this.createAnimation(e)},t.addAnimation=function(e){var t=this;this.children.push(e),this.children=this.children.filter((function(e,n){return t.children.indexOf(e)===n})),e.parent=this},t.removeAnimation=function(e){this.children=this.children.filter((function(t,n){return t!==e})),e.parent=void 0},t.start=function(){var e,t=this;return null==(e=this.tweenLoopAnimation)||e.complete(),0===this.loop?this.startAnimation():new Promise((function(e){var n=t.children[0].scene;t.tweenLoopAnimation=n.tweens.addCounter({from:0,to:1,duration:t.duration,loop:t.loop,onStart:function(){t.startAnimation()},onLoop:function(){t.startAnimation()},onComplete:function(){e()}})}))},t.startAnimation=function(){var e=this;return 0===this.children.length?Promise.resolve():new Promise((function(t){e.events.emit("start");var n=e.children.map((function(t){return t.setTimeScale(e.timeScale),t.start()}));Promise.all(n).then((function(){e.events.emit("complete"),t()}))}))},t.stop=function(){this.events.emit("stop"),this.children.forEach((function(e){e.stop()}))},t.emitEvent=function(e){for(var t,n,i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];((t=this.events).emit.apply(t,[e].concat(r)),this.parent)&&(n=this.parent).emitEvent.apply(n,[e].concat(r))},t.seek=function(e){this.children.forEach((function(t){t.seek(e)}))},t.seekPercent=function(e){var t=this.duration*e;this.seek(t)},t.setTimeScale=function(e){void 0===e&&(e=1),this.timeScale=e},t.setDelay=function(e){this.children.forEach((function(t){t.setDelay(e)}))},t.setLoop=function(e){this.loop=e},(0,X.Z)(e,[{key:"scene",get:function(){return this.children[0].scene}},{key:"duration",get:function(){return Math.max.apply(Math,this.children.map((function(e){return e.duration})))}},{key:"isPlaying",get:function(){return this.children.some((function(e){return e.isPlaying}))}}]),e}();KA.WORLD_SCALE=1/2.88;var VA=KA,XA=function(e){return e.SLICE="SLICE",e.STORM="STORM",e.WILD_CARD="WILD_CARD",e}({}),jA=Ki.Z.EVENT_BOARD,qA=jA.KEY,JA=jA.FRAME,QA=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boxerFrame=void 0,i.crown=void 0,i.avatar=void 0,i.showCrownAnimation=void 0,i.borderCover=void 0,i.randomFrame=void 0,i.scene=t,i.isPlayer=n,i.boxerFrame=i.isPlayer?JA.BOXING_DUEL.PLAYER:JA.BOXING_DUEL.OPPONENT,i.create(),i.setSize(i.avatar.width,i.avatar.height),i.alignItems(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){if(e){this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.photo;this.updateBoxerPhoto(t,n)}else this.setRandomPlayer()},n.updateBoxerPhoto=function(e,t){this.randomFrame.kill(),this.avatar.loadPhoto(e,t,50)},n.setRandomPlayer=function(){this.randomFrame.revive()},n.showCrown=function(e){var t;null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.alignItems=function(){var e=this.isPlayer?-20:20;this.crown.setPosition(e,-30)},n.create=function(){this.createAvatar(),this.createRandomFrame(),this.createAvatarBorderCover(),this.createCrown()},n.createRandomFrame=function(){var e=this.scene.add.image(0,0,qA,this.boxerFrame.AVATAR.RANDOM);e.setDefaultWorldSize(),this.add(e),this.randomFrame=e},n.createAvatar=function(){var e=new Dc(this.scene,{key:qA,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.BACKGROUND,width:67,height:208/3});this.add(e),this.avatar=e},n.createAvatarBorderCover=function(){var e=this.scene.add.image(0,0,qA,this.boxerFrame.AVATAR.BORDER);e.setDefaultWorldSize(),this.add(e),this.borderCover=e,this.borderCover.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,qA,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e},t}(Phaser.GameObjects.Container),$A=Ki.Z.EVENT_BOARD,eb=$A.KEY,tb=$A.FRAME,nb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.rope=void 0,n.anchorKnot=void 0,n.ropeAnimation=void 0,n.onClicked=!1,n.board=void 0,n.ropeContainer=void 0,n.ropeImage=void 0,n.handleMouseDown=function(){if(!n.onClicked){n.onClicked=!0;var e=n.ropeAnimation;n.scene.tweens.addCounter({from:0,to:.2,duration:.2*e.duration,onStart:function(){e.stop(),e.seekPercent(0)},onUpdate:function(t){e.seekPercent(t.getValue())},onComplete:function(){e.stop(),e.seekPercent(.2)}})}},n.handleMouseUp=function(){if(n.onClicked){n.onClicked=!1;var e=n.ropeAnimation;n.scene.tweens.addCounter({from:.2,to:1,duration:.8*e.duration,onStart:function(){e.stop(),e.seekPercent(.2)},onUpdate:function(t){e.seekPercent(t.getValue())},onComplete:function(){e.stop(),e.seekPercent(1)}})}},n.scene=t,n.setSize(26/3,101/3),n.create(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createRope(),this.createAnchorKnot(),this.createRopeAnimation()},n.createRope=function(){this.ropeContainer=this.scene.add.container(0,0),this.add(this.ropeContainer),this.ropeContainer.setSize(26/3,101/3),this.rope=this.scene.add.container(0,0),this.ropeContainer.add(this.rope),this.rope.setSize(26/3,101/3);var e=this.scene.add.image(0,0,eb,tb.ROPE);e.setDefaultWorldSize(),this.rope.add(e),this.ropeImage=e},n.createAnchorKnot=function(){this.anchorKnot=this.scene.add.container(0,0),this.add(this.anchorKnot);var e=this.scene.add.image(0,0,eb,tb.ANCHOR_KNOT);e.setDefaultWorldSize(),this.anchorKnot.add(e),this.anchorKnot.setSize(e.width,e.height),this.anchorKnot.setX(-.4),this.anchorKnot.setY(this.height/2+this.anchorKnot.height/8)},n.createRopeAnimation=function(){var e=new VA([{target:this,translate:[{curve:[.017,0,.033,0,0,-4.33,.033,-6.66]},{time:.05,y:-6.66,curve:[.1,0,.15,0,.1,-6.66,.15,6.66]},{time:.2,y:6.66,curve:[.233,0,.267,0,.233,6.66,.267,2.22]},{time:.3}]},{target:this.rope,translate:[{curve:[.017,0,.033,0,.008,-2.59,.033,-4.77]},{time:.05,y:-4.77,curve:[.089,0,.128,0,.089,-4.77,.128,5.96]},{time:.1667,y:5.96,curve:[.211,0,.256,0,.211,5.96,.256,1.99]},{time:.3}],scale:[{curve:[.008,.925,.033,.861,.008,1.071,.033,1.131]},{time:.05,x:.861,y:1.131,curve:[.089,.861,.128,1.095,.089,1.131,.128,.976]},{time:.1667,x:1.095,y:.976,curve:[.211,1.095,.256,1.032,.211,.976,.256,.992]},{time:.3}]}]);this.ropeAnimation=e},t}(Phaser.GameObjects.Container),ib=nb,rb=1e3,ab=6e4,sb=36e5,ob=864e5;function cb(e){var t=Math.floor(e/ob);e%=ob;var n=Math.floor(e/sb);e%=sb;var i=Math.floor(e/ab);return e%=ab,{days:t,hours:n,minutes:i,seconds:Math.floor(e/rb),milliseconds:e%=rb}}var hb=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=new Qp(this.scene,{text:"Completed",fontSize:this.scene.fontSize(12),fillColor:11102533}),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new ub(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),ub=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.rtMs=void 0,this.startTime=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.destroy(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",10),t.countdownTimer.remove();else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),lb=Ki.Z.EVENT_BOARD,db=lb.KEY,pb=lb.FRAME,fb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.timerText=void 0,n.blueGlove=void 0,n.redGlove=void 0,n.blueText=void 0,n.redText=void 0,n.avatarContainer=void 0,n.leftAvatar=void 0,n.rightAvatar=void 0,n.header=void 0,n.winningSide="draw",n.upTweens=void 0,n.downTweens=void 0,n.timerContainer=void 0,n.scene=t,n.createBoard(),n.createHeader(),n.createAvatars(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){this.leftAvatar.crown.setAlpha(0),this.rightAvatar.crown.setAlpha(0);var e=this.scene.boxingDuel,t=e.getPlayer(),n=e.getOpponent(),i=t.score,r=(null==n?void 0:n.score)||0;this.leftAvatar.updateData(t),this.rightAvatar.updateData(n),this.blueText.setText(i.toString()),this.redText.setText(r.toString()),i>r?this.setLeftWin():i<r?this.setRightWin():this.setDraw();var a=(new Date).getTime(),s=this.scene.boxingDuel.getEndTime()-a;this.timerText.timerLogic.setRemainingTime(s)},n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTweens)||e.forEach((function(e){return e.stop()})),this.downTweens=[this.scene.add.tween({targets:[this.leftAvatar,this.rightAvatar],scale:.75,y:15,duration:100,ease:Phaser.Math.Easing.Sine.Out}),this.scene.add.tween({targets:[this.leftAvatar],x:-16,angle:-8,duration:100,ease:Phaser.Math.Easing.Sine.Out}),this.scene.add.tween({targets:[this.rightAvatar],x:14,angle:8,duration:100,ease:Phaser.Math.Easing.Sine.Out})]},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTweens)||e.forEach((function(e){return e.stop()}));var t="left"===this.winningSide?0:50,n="right"===this.winningSide?0:50;this.upTweens=[this.scene.add.tween({targets:[this.leftAvatar],scale:.8,x:-18,y:12,angle:-10,delay:t,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]}),this.scene.add.tween({targets:[this.rightAvatar],scale:.8,x:16,y:12,angle:10,delay:n,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})]},n.setLeftWin=function(){this.leftAvatar.showCrown(!0),this.rightAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.leftAvatar,this.rightAvatar),this.blueGlove.setVisible(!0),this.redGlove.setVisible(!1),this.winningSide="left"},n.setRightWin=function(){this.rightAvatar.showCrown(!0),this.leftAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.rightAvatar,this.leftAvatar),this.blueGlove.setVisible(!1),this.redGlove.setVisible(!0),this.winningSide="right"},n.setDraw=function(){this.leftAvatar.showCrown(!1),this.rightAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.leftAvatar,this.rightAvatar),this.blueGlove.setVisible(!0),this.redGlove.setVisible(!1),this.winningSide="draw"},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+7),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.timerContainer.setPosition(0,this.height/2-this.timerContainer.height/2)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){var e=this.scene.add.container(0,0);this.addAt(e,1);var t=this.scene.add.image(0,0,db,pb.HEADER_BOARD);t.setDefaultWorldSize(),e.add(t),this.board=e,this.board.setSize(t.width,t.height),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createHeader=function(){this.createWidgetTopBar(),this.createGloves(),this.createScoreText()},n.createWidgetTopBar=function(){this.header=this.scene.add.container(0,0),this.header.setSize(69,16),this.header.setY(-this.height/2+this.header.height/2+18.25),this.add(this.header);var e=this.scene.make.nineslice({key:db,frame:pb.BOXING_DUEL.LOADING_BAR.BLUE,width:this.header.width/2,height:this.header.height,leftWidth:22/3,rightWidth:22/3});e.setPosition(-this.header.width/4,0),this.header.add(e);var t=this.scene.make.nineslice({key:db,frame:pb.BOXING_DUEL.LOADING_BAR.RED,width:this.header.width/2,height:this.header.height,leftWidth:22/3,rightWidth:22/3});t.setPosition(this.header.width/4-1,0),this.header.add(t)},n.createGloves=function(){var e=this.scene.add.image(0,0,db,pb.BOXING_DUEL.GLOVE.BLUE);e.setDefaultWorldSize(),this.header.add(e);var t=this.scene.add.image(0,0,db,pb.BOXING_DUEL.GLOVE.RED);t.setDefaultWorldSize(),this.header.add(t),this.blueGlove=e,this.redGlove=t},n.createScoreText=function(){this.redText=new Qp(this.scene,{text:"195",fontSize:this.scene.fontSize(11),strokeColor:6358552,strokeThickness:2,strokeOffset:{y:.3},strokeAlpha:.8}),this.header.add(this.redText),this.redText.setPosition(this.board.width/4+this.blueGlove.width/4-7,.5),this.blueText=new Qp(this.scene,{text:"169",fontSize:this.scene.fontSize(11),strokeColor:208736,strokeThickness:2,strokeOffset:{y:.3},strokeAlpha:.8}),this.header.add(this.blueText),this.blueText.setPosition(-this.board.width/4-this.blueGlove.width/4+7,.5)},n.createAvatars=function(){var e=this.scene.add.container(0,0);this.add(e);var t=new QA(this.scene,!0);t.setScale(.8,.8),t.setAngle(-10),t.setPosition(-18,12),e.add(t);var n=new QA(this.scene,!1);n.setScale(.8,.8),n.setAngle(10),n.setPosition(16,12),e.add(n),this.avatarContainer=e,this.leftAvatar=t,this.rightAvatar=n},n.createTimer=function(){var e=this.scene.add.container(0,0);e.setSize(208/3,76/3),this.add(e),this.timerContainer=e;var t=this.scene.add.image(0,0,db,pb.BOXING_DUEL.TIMER_BORDER);t.setDefaultWorldSize(),e.add(t),this.timerText=new hb(this.scene),e.add(this.timerText)},t}(ib),mb=fb,gb=Ki.Z.EVENT_BOARD,vb=gb.KEY,yb=gb.FRAME,Eb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.gloves=void 0,n.button=void 0,n.scene=t,n.createBoard(),n.createVSIcon(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.gloves],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.gloves],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2-2),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.gloves.setPosition(0,5),this.button.setPosition(0,37)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){var e=this.scene.add.container(0,0);this.addAt(e,1);var t=this.scene.add.image(0,0,vb,yb.BOXING_DUEL.START_CIRCLE);t.setDefaultWorldSize(),e.add(t),this.board=e,this.board.setSize(t.width,t.height),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createVSIcon=function(){this.gloves=this.scene.add.container(0,0),this.add(this.gloves);var e=this.scene.add.image(0,0,vb,yb.BOXING_DUEL.ICON_VS);e.setDefaultWorldSize(),this.gloves.add(e)},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,vb,yb.BOXING_DUEL.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new Qp(this.scene,{text:"Start",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}(ib),Cb=Eb,wb=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),Ab=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.duelStatus=void 0,n.startBoxingDuelBoard=void 0,n.inBoxingDuelBoard=void 0,n.contents=[],n.startBoardWrapper=void 0,n.inBoardWrapper=void 0,n.wrappers=[],n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.contents.forEach((function(e){e.active&&e.handleMouseDownAnim()})))},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.visible&&e.handleMouseUpAnim()})),n.handleButtonClick())},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.handleMouseUpAnim()})))},n.handleButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.screen.close(de.o4.PLAY_SCREEN),e.next=3,n.scene.requireTextureAsync("BOXING_DUEL");case 3:t=n.scene.boxingDuel,t.isFinished()?n.scene.screen.open(de.o4.BOXING_DUEL.REWARD_SCREEN):n.scene.screen.open(de.o4.BOXING_DUEL.MAIN_SCREEN,{previousScreen:de.o4.PLAY_SCREEN});case 6:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.boxingDuel.isValid()?(this.revive(),this.updateBoxingDuelContent()):this.kill();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxingDuelContent=function(){var e=this.scene.boxingDuel;if(e.isWaiting())this.setDuelState(wb.READY);else{if(e.isFinished())0===e.getPlayerRank()?this.setDuelState(wb.WON):this.setDuelState(wb.LOST);else this.setDuelState(wb.PLAYING);this.inBoxingDuelBoard.updateData()}},n.setDuelState=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.duelStatus=t,this.contents.forEach((function(e){e.kill()})),e.t0=t,e.next=e.t0===wb.READY?5:e.t0===wb.PLAYING||e.t0===wb.WON||e.t0===wb.LOST?8:11;break;case 5:return this.startBoxingDuelBoard.revive(),this.originBoardY=this.startBoardWrapper.y,e.abrupt("break",11);case 8:return this.inBoxingDuelBoard.revive(),this.originBoardY=this.inBoardWrapper.y,e.abrupt("break",11);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.duelStatus===wb.READY?this.startBoxingDuelBoard.rope:this.inBoxingDuelBoard.rope,n=this.duelStatus===wb.READY?this.startBoardWrapper:this.inBoardWrapper;t.setScale(1,1);var i={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},r={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},a=this.scene.tweens.add((0,p.Z)({targets:n},i)),s=this.scene.tweens.add((0,p.Z)({targets:t},r));return this.openTweens.push(a,s),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inBoxingDuelBoard.timerText.timerLogic.stopTimer(),e.next=3,this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createStartBoxingDuelBoard(),this.createInBoxingDuelBoard()},n.createStartBoxingDuelBoard=function(){var e=this.scene.add.container(0,0);this.add(e),this.startBoxingDuelBoard=new Cb(this.scene),e.add(this.startBoxingDuelBoard),e.setSize(this.startBoxingDuelBoard.width,this.startBoxingDuelBoard.height),this.startBoardWrapper=e,this.contents.push(this.startBoxingDuelBoard),this.wrappers.push(this.startBoardWrapper)},n.createInBoxingDuelBoard=function(){var e=this.scene.add.container(0,0);this.add(e),this.inBoxingDuelBoard=new mb(this.scene),e.add(this.inBoxingDuelBoard),e.setSize(this.inBoxingDuelBoard.width,this.inBoxingDuelBoard.height),this.inBoardWrapper=e,this.contents.push(this.inBoxingDuelBoard),this.wrappers.push(this.inBoardWrapper)},n.alignContent=function(){var e=this,t=Math.max(this.startBoardWrapper.width,this.inBoardWrapper.width),n=Math.max(this.startBoardWrapper.height,this.inBoardWrapper.height);this.setSize(t,n),this.wrappers.forEach((function(t,i){e.setBoardY(t,e.contents[i].extraHeight,n)}))},n.setBoardY=function(e,t,n){var i=t-Math.abs(n-e.height)/2;e.setY(i)},t}(Phaser.GameObjects.Container),bb=Ab,Sb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(265/3,416/3),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.close();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new bb(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),Tb=Sb,xb=Ki.Z.EVENT_BOARD,kb=xb.KEY,Pb=xb.FRAME,Ib=function(e){function t(t){var n;return(n=e.call(this,t,40,40)||this).scene=void 0,n.background=void 0,n.icon=void 0,n.requiredLevelsText=void 0,n.scene=t,n.create(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setPlaying=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.requiredLevelsText.setX(7),this.requiredLevelsText.setFontSize(this.scene.fontSize(13)),this.requiredLevelsText.setText(""+e),this.icon.revive(),this.background.setSizeByWorld(48,this.background.displayHeight),this.setSize(this.background.displayWidth,this.background.displayHeight)},n.setFinished=function(){this.requiredLevelsText.setX(0),this.requiredLevelsText.setFontSize(this.scene.fontSize(12)),this.requiredLevelsText.setText("Completed"),this.icon.kill(),this.background.setSizeByWorld(75,this.background.displayHeight),this.setSize(this.background.displayWidth,this.background.displayHeight)},n.create=function(){this.createBackground(),this.createIcon(),this.createText()},n.createBackground=function(){var e=this.scene.make.nineslice({key:kb,frame:Pb.OFFSHORE_RACE.LEVEL_PANEL,width:48,height:24,leftWidth:10,rightWidth:10});this.add(e),e.setSizeByWorld(48,e.displayHeight),this.background=e,this.setSize(this.background.displayWidth,this.background.displayHeight)},n.createIcon=function(){var e=this.scene.add.image(0,0,kb,Pb.OFFSHORE_RACE.TRIANGLE);e.setDefaultWorldSize(),this.add(e),e.setPosition(-7,0),this.icon=e},n.createText=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"15",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setTint(33447),this.add(e),e.setPosition(7,-1),this.requiredLevelsText=e},t}(Phaser.GameObjects.Container),Ob=Ib,Rb=Ki.Z.EVENT_BOARD,Bb=Rb.KEY,Db=Rb.FRAME,Lb=function(e){function t(t,n){var i;return(i=e.call(this,t,{key:Bb,background:n?Db.OFFSHORE_RACE.PLAYER.AVATAR:Db.OFFSHORE_RACE.OPPONENT.AVATAR,frame:Db.BLANK,width:23,height:23.333333333333332,loadDelay:1e3})||this).avtFrame.kill(),i}(0,f.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){void 0===i&&(i=70),n&&(t===this.payload.id&&n===this.payload.url||e.prototype.loadPhoto.call(this,t,n,i))},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,r=n.height,a=Math.min(i,r);this.photo.setWorldSize(a,a)},n.showDefaultPhoto=function(){this.loadPhoto(oe.Z.AVATAR.KEY,oe.Z.AVATAR.FILE)},t}(Dc),Mb=Lb,_b=Ki.Z.EVENT_BOARD,Nb=_b.KEY,Gb=_b.FRAME,Fb=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.medal=void 0,i.rankText=void 0,i.isPlayer=void 0,i.scene=t,i.isPlayer=n,i.setSize(32,36),i.createMedal(),i.createRankText(),i}(0,f.Z)(t,e);var n=t.prototype;return n.createMedal=function(){this.medal=this.scene.add.image(0,0,Nb,Gb.OFFSHORE_RACE.MEDAL.GOLD),this.medal.setDefaultWorldSize(),this.add(this.medal)},n.setRank=function(e){var t=-1===e?"-":e>=100?"99+":(e+1).toString();switch(this.rankText.setText(t),this.rankText.kill(),this.medal.revive(),e){case 0:this.medal.setFrame(Gb.OFFSHORE_RACE.MEDAL.GOLD);break;case 1:this.medal.setFrame(Gb.OFFSHORE_RACE.MEDAL.SILVER);break;case 2:this.medal.setFrame(Gb.OFFSHORE_RACE.MEDAL.BRONZE);break;default:this.rankText.revive(),this.medal.kill()}},n.createRankText=function(){var e=new Qp(this.scene,{text:"4",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.rankText=e,this.add(this.rankText)},t}(Phaser.GameObjects.Container),Zb=Ki.Z.EVENT_BOARD,Ub=Zb.KEY,Wb=Zb.FRAME,Yb=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.blockIndex=void 0,r.frames=void 0,r.rank=void 0,r.isPlayer=void 0,r.racerScore=void 0,r.avatar=void 0,r.scene=t,r.blockIndex=i,r.isPlayer=n,r.frames=n?Wb.OFFSHORE_RACE.PLAYER:Wb.OFFSHORE_RACE.OPPONENT,r.create(),t.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.racerId,n=e.score,i=e.photo,r=e.rank;i&&this.avatar.loadPhoto(t,i),this.racerScore.setText(n.toString()),this.rank.setRank(r)},n.create=function(){this.createAvatar(),this.createScoreboard(),this.createRank(),this.createScore()},n.createScoreboard=function(){var e=this.scene.add.image(0,0,Ub,this.frames.SCOREBOARD);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createAvatar=function(){var e=new Mb(this.scene,this.isPlayer);e.showDefaultPhoto(),this.add(e),this.avatar=e,this.avatar.setPosition(-8.2,-.8)},n.createRank=function(){this.rank=new Fb(this.scene,this.isPlayer),this.add(this.rank),this.rank.setRank(this.blockIndex+1),this.rank.setPosition(-this.width/2+14,0)},n.createScore=function(){var e=new Qp(this.scene,{text:"12",fontSize:this.scene.fontSize(12),strokeColor:12927496,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),t=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"10",origin:{x:.5,y:.5}});t.setTint(33447),this.isPlayer?(e.setVisible(!0),t.setVisible(!1)):(e.setVisible(!1),t.setVisible(!0)),this.racerScore=this.isPlayer?e:t,this.add(this.racerScore),this.racerScore.setPosition(this.width/2-22,-1)},t}(Phaser.GameObjects.Container),Hb=Yb,zb=Ki.Z.EVENT_BOARD,Kb=zb.KEY,Vb=zb.FRAME,Xb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.leaderboardBoard=void 0,n.title=void 0,n.racers=void 0,n.leaderboardButton=void 0,n.timerText=void 0,n.timerContainer=void 0,n.handleButtonClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(de.o4.PLAY_SCREEN),n.scene.openOffshoreRaceMainScreen({previousScreen:de.o4.PLAY_SCREEN});case 2:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createLeaderboardButton(),n.createRacers(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=this.scene.offshoreRace.getRacers();this.racers.forEach((function(t,n){t.updateData(e[n])})),this.leaderboardButton.setPlaying();var t=this.scene.offshoreRace.getRemainingTime();this.timerText.timerLogic.setRemainingTime(t)},n.handleMouseDownAnim=function(){this.handleMouseDown()},n.handleMouseUpAnim=function(){this.handleMouseUp()},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.timerContainer,this.board,0,-5)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createLeaderboardBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createLeaderboardBoard=function(){var e=this.scene.add.image(0,0,Kb,Vb.OFFSHORE_RACE.TAG.LEADERBOARD);e.setDefaultWorldSize(),this.board.add(e),this.leaderboardBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createLeaderboardButton=function(){this.leaderboardButton=new Ob(this.scene),this.add(this.leaderboardButton),this.leaderboardButton.setPosition(0,-42.5)},n.createRacers=function(){var e=this;this.racers=new Array(5).fill(null).map((function(t,n){return new Hb(e.scene,0===n,n)})),this.add(this.racers),this.racers.forEach((function(e,t){e.setPosition(0,31*t-15)}))},n.createTimer=function(){this.timerContainer=this.scene.add.container(0,0),this.add(this.timerContainer);var e=this.scene.add.image(0,0,Kb,Vb.OFFSHORE_RACE.TIME_PANEL);e.setDefaultWorldSize(),this.timerContainer.add(e),this.timerText=new hb(this.scene),this.timerText.txt.setTintSeparate(33447,33447),this.timerContainer.add(this.timerText)},t}(ib),jb=Xb,qb=Ki.Z.EVENT_BOARD,Jb=qb.KEY,Qb=qb.FRAME,$b=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.promotionBoard=void 0,n.title=void 0,n.description=void 0,n.button=void 0,n.handleButtonClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(de.o4.PLAY_SCREEN),n.scene.offshoreRace.startRace(),n.scene.openOffshoreRaceMainScreen({shouldPlayEntranceAnimation:!0,previousScreen:de.o4.PLAY_SCREEN});case 3:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createDescription(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.button],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.button],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.button,this.board,0,-16)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createPromotionBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createPromotionBoard=function(){var e=this.scene.add.image(0,0,Jb,Qb.OFFSHORE_RACE.TAG.PROMOTION);e.setDefaultWorldSize(),this.board.add(e),this.promotionBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"Join race\nand win prizes",origin:{x:.5,y:0}});e.setCenterAlign(),e.setTint(33447),e.setLineHeight(80),this.add(e),e.setPosition(0,-82),this.description=e},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,Jb,Qb.OFFSHORE_RACE.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new Qp(this.scene,{text:"Start",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}(ib),eS=$b,tS=Ki.Z.EVENT_BOARD,nS=tS.KEY,iS=tS.FRAME,rS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.wonBoard=void 0,n.title=void 0,n.description=void 0,n.chest=void 0,n.button=void 0,n.handleButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(de.o4.PLAY_SCREEN),t=n.scene.offshoreRace.getRewardData(),n.scene.openOffshoreRaceRewardScreen({rewards:t});case 3:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createDescription(),n.createChest(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.offshoreRace.getPlayerRank(),e.t0=t,e.next=0===e.t0?4:1===e.t0?7:2===e.t0?10:13;break;case 4:return this.description.setText("Well done!\nYou finished\nfirst!"),this.chest.setTexture(nS,iS.OFFSHORE_RACE.CHEST.GOLD),e.abrupt("break",13);case 7:return this.description.setText("Well done!\nYou finished\nsecond!"),this.chest.setTexture(nS,iS.OFFSHORE_RACE.CHEST.SILVER),e.abrupt("break",13);case 10:return this.description.setText("Well done!\nYou finished\nthird!"),this.chest.setTexture(nS,iS.OFFSHORE_RACE.CHEST.BRONZE),e.abrupt("break",13);case 13:this.chest.setDefaultWorldSize(),this.chest.setPosition(0,55);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.button],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.button],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.button,this.board,0,-16)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createWonBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createWonBoard=function(){var e=this.scene.add.image(0,0,nS,iS.OFFSHORE_RACE.TAG.WIN_EMPTY);e.setDefaultWorldSize(),this.board.add(e),this.wonBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"Well done!\nYou finished\nfirst!",origin:{x:.5,y:0}});e.setCenterAlign(),e.setTint(33447),e.setLineHeight(80),this.add(e),e.setPosition(0,-82),this.description=e},n.createChest=function(){var e=this.scene.add.image(0,0,nS,iS.OFFSHORE_RACE.CHEST.GOLD);e.setOrigin(.5,1),e.setDefaultWorldSize(),this.add(e),e.setPosition(0,55),this.chest=e},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,nS,iS.OFFSHORE_RACE.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new Qp(this.scene,{text:"Open",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}(ib),aS=rS,sS=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),oS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.raceStatus=void 0,n.racePromotionContent=void 0,n.raceLeaderboardContent=void 0,n.raceWonContent=void 0,n.contents=[],n.racePromotionContentWrapper=void 0,n.raceLeaderboardContentWrapper=void 0,n.raceWonContentWrapper=void 0,n.wrappers=[],n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.contents.forEach((function(e){e.active&&e.handleMouseDownAnim()})))},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.visible&&(e.handleMouseUpAnim(),e.handleButtonClick())})))},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.handleMouseUpAnim()})))},n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.offshoreRace.isValid()?(this.revive(),this.updateOffshoreRaceContent()):this.kill();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateOffshoreRaceContent=function(){var e=this.scene.offshoreRace;if(e.isWaiting())this.setRaceState(sS.READY);else{var t=this.scene.offshoreRace.hasReward();e.isFinished()?t?this.setRaceState(sS.WON):this.setRaceState(sS.LOST):this.setRaceState(sS.PLAYING)}},n.setRaceState=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.raceStatus=t,this.contents.forEach((function(e){e.kill()})),e.t0=t,e.next=e.t0===sS.READY?5:e.t0===sS.PLAYING||e.t0===sS.LOST?8:e.t0===sS.WON?12:16;break;case 5:return this.racePromotionContent.revive(),this.originBoardY=this.racePromotionContentWrapper.y,e.abrupt("break",16);case 8:return this.raceLeaderboardContent.revive(),this.raceLeaderboardContent.updateData(),this.originBoardY=this.raceLeaderboardContentWrapper.y,e.abrupt("break",16);case 12:return this.raceWonContent.revive(),this.raceWonContent.updateData(),this.originBoardY=this.raceWonContentWrapper.y,e.abrupt("break",16);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.racePromotionContent.rope;t.setScale(1,1);var n={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},i={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},r=this.scene.tweens.add((0,p.Z)({targets:this.wrappers},n)),a=this.scene.tweens.add((0,p.Z)({targets:t},i));return this.openTweens.push(r,a),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createRacePromotionContent(),this.createRaceLeaderboardContent(),this.createRaceWonContent()},n.createRacePromotionContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.racePromotionContent=new eS(this.scene),e.add(this.racePromotionContent),e.setSize(this.racePromotionContent.width,this.racePromotionContent.height),this.racePromotionContentWrapper=e,this.contents.push(this.racePromotionContent),this.wrappers.push(this.racePromotionContentWrapper)},n.createRaceLeaderboardContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.raceLeaderboardContent=new jb(this.scene),e.add(this.raceLeaderboardContent),e.setSize(this.raceLeaderboardContent.width,this.raceLeaderboardContent.height),this.raceLeaderboardContentWrapper=e,this.contents.push(this.raceLeaderboardContent),this.wrappers.push(this.raceLeaderboardContentWrapper)},n.createRaceWonContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.raceWonContent=new aS(this.scene),e.add(this.raceWonContent),e.setSize(this.raceWonContent.width,this.raceWonContent.height),this.raceWonContentWrapper=e,this.contents.push(this.raceWonContent),this.wrappers.push(this.raceWonContentWrapper)},n.alignContent=function(){var e=this;this.setSize(this.racePromotionContentWrapper.width,this.racePromotionContentWrapper.height+10),this.wrappers.forEach((function(t){e.setBoardY(t,e.racePromotionContent.extraHeight,e.height-10)}))},n.setBoardY=function(e,t,n){e.setY(t-Math.abs(n-e.height)/2)},t}(Phaser.GameObjects.Container),cS=oS,hS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(117,950/3),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new cS(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),uS=hS,lS=Ki.Z.EVENT_BOARD,dS=lS.KEY,pS=lS.FRAME,fS=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).background=void 0,r.rankText=void 0,r.create(),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateBackgroundToWin=function(e){this.background.setFrame(e?pS.GREEN_CIRCLE:pS.BLUE_CIRCLE),this.background.setDefaultWorldSize()},n.setRank=function(e){this.setVisible(e>0);var t=e<100?""+e:"99+",n=e<100?14:12;this.rankText.setFontSize(this.scene.fontSize(n)),this.rankText.setText(t)},n.create=function(){var e=this.scene.add.image(0,0,dS,pS.BLUE_CIRCLE);e.setDefaultWorldSize(),e.setY(.5),this.setSize(e.width,e.height);var t=new Qp(this.scene,{text:"1",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setPosition(0,-1),this.add([e,t]),this.rankText=t,this.background=e},t}(Phaser.GameObjects.Container),mS=fS,gS=Ki.Z.EVENT_BOARD,vS=gS.KEY,yS=gS.FRAME,ES=function(e){return e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}(ES||{}),CS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.timerText=void 0,n.cup=void 0,n.playingBoard=void 0,n.wonBoard=void 0,n.lostBoard=void 0,n.rankBlock=void 0,n.downTween=void 0,n.upTween=void 0,n.scene=t,n.createBoard(),n.createCup(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setContentVisible(ES.LOADING),t=this.scene.weeklyTournament,e.next=4,t.requestPlayerProgress();case 4:n=this.getBoardStatus(),i=t.getRemainingTime(),r=t.getRank(),this.rankBlock.setRank(r),this.timerText.timerLogic.setRemainingTime(i),this.setContentVisible(n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.cup],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.cup],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.setContentVisible=function(e){switch(this.rankBlock.setVisible(!1),this.timerText.setVisible(!1),this.playingBoard.setVisible(!1),this.wonBoard.setVisible(!1),this.lostBoard.setVisible(!1),e){case ES.LOADING:this.timerText.setVisible(!0),this.timerText.setText("Loading...",11),this.playingBoard.setVisible(!0);break;case ES.READY:this.timerText.setVisible(!0),this.playingBoard.setVisible(!0);break;case ES.PLAYING:this.rankBlock.setVisible(!0),this.timerText.setVisible(!0),this.playingBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!1);break;case ES.WON:this.rankBlock.setVisible(!0),this.wonBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!0);break;case ES.LOST:this.rankBlock.setVisible(!0),this.lostBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!1)}},n.getBoardStatus=function(){var e=this.scene.weeklyTournament;return e.isWaiting()?ES.READY:e.isHappening()?ES.PLAYING:e.isFinished()?e.hasReward()?ES.WON:ES.LOST:ES.READY},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.cup.setY(25.8),this.timerText.setPosition(0,this.height/2-this.timerText.height/2-3.5)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,r=Math.abs(n)+Math.abs(i),a=this.height;this.setSize(this.width,r),this.extraHeight=(this.height-a)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(257/3,98),this.createPlayingBoard(),this.createWonBoard(),this.createLostBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createPlayingBoard=function(){var e=this.scene.add.image(0,0,vS,yS.WEEKLY_TOURNAMENT.PLAYING_BOARD);e.setDefaultWorldSize(),this.board.add(e),this.playingBoard=e},n.createWonBoard=function(){var e=this.scene.add.image(0,0,vS,yS.WEEKLY_TOURNAMENT.WON_BOARD);e.setDefaultWorldSize(),this.board.add(e),this.wonBoard=e},n.createLostBoard=function(){var e=this.scene.add.image(0,0,vS,yS.WEEKLY_TOURNAMENT.LOST_BOARD);e.setDefaultWorldSize(),e.setY(-.5),this.board.add(e),this.lostBoard=e},n.createCup=function(){this.cup=this.scene.add.container(0,0),this.add(this.cup),this.createCupIcon(),this.createRankBlock()},n.createCupIcon=function(){var e=this.scene.add.image(0,0,vS,yS.WEEKLY_TOURNAMENT.CUP_ICON);e.setOrigin(.5,1),e.setDefaultWorldSize(),this.cup.add(e),this.cup.setSize(e.width,e.height)},n.createRankBlock=function(){this.rankBlock=new mS(this.scene),this.cup.add(this.rankBlock),this.rankBlock.setPosition(.5,-28)},n.createTimer=function(){this.timerText=new hb(this.scene),this.add(this.timerText)},t}(ib),wS=CS,AS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.weeklyTournamentContent=void 0,n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.content=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.weeklyTournamentContent.handleMouseDownAnim())},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.weeklyTournamentContent.handleMouseUpAnim(),n.handleButtonClick())},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.weeklyTournamentContent.handleMouseUpAnim())},n.handleButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.screen.close(de.o4.PLAY_SCREEN),t=n.scene.weeklyTournament,e.next=4,n.scene.requireTextureAsync("WEEKLY_TOURNAMENT");case 4:t.isWaiting()?n.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN,{previousScreen:de.o4.PLAY_SCREEN}):t.isHappening()?n.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:de.o4.PLAY_SCREEN}):t.isFinished()&&n.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN);case 5:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.weeklyTournament.isValid()){e.next=6;break}return this.revive(),e.next=4,this.weeklyTournamentContent.updateData();case 4:e.next=7;break;case 6:this.kill();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.weeklyTournamentContent.rope;t.setScale(1,1);var n={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},i={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},r=this.scene.tweens.add((0,p.Z)({targets:this.content},n)),a=this.scene.tweens.add((0,p.Z)({targets:t},i));return this.openTweens.push(r,a),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.weeklyTournamentContent.timerText.timerLogic.stopTimer(),e.next=3,this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createWeeklyTournamentContent()},n.createWeeklyTournamentContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.weeklyTournamentContent=new wS(this.scene),e.add(this.weeklyTournamentContent),e.setSize(this.weeklyTournamentContent.width,this.weeklyTournamentContent.height),this.content=e},n.alignContent=function(){this.setSize(this.content.width,this.content.height),this.setBoardY(this.content,this.weeklyTournamentContent.extraHeight,this.content.height),this.originBoardY=this.content.y},n.setBoardY=function(e,t,n){e.setY(t-Math.abs(n-e.height)/2)},t}(Phaser.GameObjects.Container),bS=AS,SS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(265/3,395/3),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.close();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new bS(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),TS=SS;function xS(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return kS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kS(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var PS=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.weeklyTournamentWindow=void 0,n.boxingDuelWindow=void 0,n.offshoreRaceWindow=void 0,n.leftWindow=[],n.rightWindow=[],n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.weeklyTournamentWindow=new TS(n.scene),n.offshoreRaceWindow=new uS(n.scene),n.boxingDuelWindow=new Tb(n.scene),n.add([n.weeklyTournamentWindow,n.boxingDuelWindow,n.offshoreRaceWindow]),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateWindows();case 2:for(t=xS(this.leftWindow);!(n=t()).done;)n.value.open();for(i=xS(this.rightWindow);!(r=i()).done;)r.value.open();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.leftWindow.map(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n=this.rightWindow.map(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all([].concat(t,n));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateWindows=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.leftWindow=[],this.rightWindow=[],!this.scene.offshoreRace.isValid()){e.next=6;break}return e.next=5,this.offshoreRaceWindow.prepareData();case 5:this.leftWindow.push(this.offshoreRaceWindow);case 6:if(!this.scene.weeklyTournament.isValid()){e.next=10;break}return e.next=9,this.weeklyTournamentWindow.prepareData();case 9:this.rightWindow.push(this.weeklyTournamentWindow);case 10:if(!this.scene.boxingDuel.isValid()){e.next=14;break}return e.next=13,this.boxingDuelWindow.prepareData();case 13:this.rightWindow.push(this.boxingDuelWindow);case 14:this.alignLeftWindows(),this.alignRightWindows(),this.leftWindow.forEach(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateData();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.rightWindow.forEach(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateData();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignLeftWindows=function(){var e=-this.height/2-8;this.leftWindow.forEach((function(t){t.setPosition(-225.5,e+t.height/2),e=t.y+t.height-8}))},n.alignRightWindows=function(){var e=this,t=-this.height/2-8;this.rightWindow.forEach((function(e){e.setPosition(225.5,t+e.height/2),t=e.y+e.height/2-8}));var n=this.rightWindow[0];this.rightWindow.forEach((function(t){t!==n&&(e.moveBelow(t,n),n=t)}))},t}(Phaser.GameObjects.Container),IS=PS,OS=function(e){function t(t){var n;return(n=e.call(this,t)||this).boostersContainer=void 0,n.create(),n}(0,f.Z)(t,e);var n=t.prototype;return n.setButtonsDisable=function(e){this.boostersContainer.setButtonsDisable(e)},n.create=function(){this.createBoosterContainer()},n.createBoosterContainer=function(){var e=this,t=new Py(this.scene,de.o4.PLAY_SCREEN);this.add(t),this.boostersContainer=t,t.onBoosterClick=function(t){t&&(e.scene.screen.close(de.o4.PLAY_SCREEN),e.scene.screen.open(de.o4.BUYING_BOOSTER_SCREEN,t))}},t}(Phaser.GameObjects.Container),RS=OS,BS=Ki.Z.DEFAULT,DS=BS.KEY,LS=BS.FRAME,MS=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.playContainer=void 0,o.readyToStartWC=!1,o.eventsWindow=void 0,o.glow2=void 0,o.glow3=void 0,o.boneGlow2=void 0,o.boneGlow3=void 0,o.entranceAnims=void 0,o.exitAnims=void 0,o.idleAnim=void 0,o.previousData=void 0,o.isScreenOpening=void 0,o.handleCancel=function(){o.scene.screen.close(o.name);var e=o.scene.level.getLevel();o.scene.screen.open(de.o4.DASHBOARD_SCREEN,{level:e}),o.scene.skipBackgroundChangingAnimation(),o.readyToStartWC=!1},o.startGame=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.scene.gameplay,n=o.playContainer.boostersContainer,i=n.sliceButton,r=n.stormButton,s=n.wildCardButton,c={slice:i.selected,storm:r.selected,wildCard:s.selected},o.setButtonsDisable(!0),o.scene.logEconomy.logEconomyTracking(),o.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON),o.scene.offshoreRace.setShouldCheckTime(!1),o.scene.events.emit("refresh-event-toggle",!1),t.boosterManager.enableBoosters(c),o.scene.screen.close(o.name),e.next=12,t.start();case 12:case"end":return e.stop()}}),e)}))),o.onEntranceCompleted=function(){var e,t=(null==(e=o.data)?void 0:e.list).level,n=void 0===t?1:t;o.showGuideAnimation(n),o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.isScreenOpening=!1},o.scene=t,o.create(),o.setDepth(de.Ks.POPUP),o.background.setAlpha(.88),t.events.on(pi.WC_JOIN_BTN_CLICKED,(function(){o.readyToStartWC=!0})),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpening){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:e.prototype.open.call(this,n),this.isScreenOpening=!0,this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),n=n||this.previousData,this.previousData=n,this.updateData(n),this.runEntranceAnimation(),GameCore.layoutInitializer.isLandscape&&this.eventsWindow.open(),this.setButtonsDisable(!1),this.scene.preloadBackgroundAsync({useGameplayBackground:!0});case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateData=function(e){var t,n=this.playContainer.boostersContainer,i=n.sliceButton,r=n.stormButton,a=n.wildCardButton,s=null==(t=this.data)?void 0:t.list,o=s.level,c=void 0===o?1:o,h=s.difficulty,u=void 0===h?Jh.NORMAL:h,l=e,d=l.slice,p=l.storm,f=l.wildCard;this.checkShowGuides(),n.setLevel(c),n.setDifficulty(u),n.updateBoostersWithSettings(),i.updateData(d),r.updateData(p),a.updateData(f)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setButtonsDisable(!0),this.eventsWindow.close(),null==(t=this.idleAnim)||t.stop(),this.runExitAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkShowGuides=function(){var e=this.scene.gameplay.guideManager;e.guideLayout.isBoosterGuidePlaying()&&e.zone.setVisible(!0)},n.showGuideAnimation=function(e){var t=this.playContainer.boostersContainer,n=this.scene.gameplay.guideManager,i=this.playContainer.boostersContainer.playButton,r=t.sliceButton,a=t.stormButton,s=t.wildCardButton,o=this.scene.gameSettings.requiredLevels,c=o.boosterSlice,h=o.boosterStorm,u=o.boosterWildCard;switch(e){case c:return void n.guideLayout.showBoosterGuide(r,i,XA.SLICE);case h:return void n.guideLayout.showBoosterGuide(a,i,XA.STORM);case u:return void n.guideLayout.showBoosterGuide(s,i,XA.WILD_CARD);default:return}},n.create=function(){this.createPlayContainer(),this.createEventsWindow(),this.createGlow2(),this.createGlow3(),this.playContainer.boostersContainer.closeButton.onClick=this.handleCancel,this.playContainer.boostersContainer.playButton.onClick=this.startGame,this.createIdleAnimation()},n.createPlayContainer=function(){this.playContainer=new RS(this.scene),this.add(this.playContainer)},n.createEventsWindow=function(){this.eventsWindow=new IS(this.scene),this.add(this.eventsWindow)},n.createGlow2=function(){var e=this.scene.add.container(26.6359/3,114.394-166.5);this.add(e),this.boneGlow2=e;var t=this.scene.add.image(-1.7267/3,-.1038,DS,LS.PLAY_SCREEN.EFFECTS.GLOW);t.setDefaultWorldSize(),t.setAlpha(0),t.setBlendMode(Phaser.BlendModes.ADD),e.add(t),this.glow2=t},n.createGlow3=function(){var e=this.scene.add.container(14.272,390.412/3-166.5);this.add(e),this.boneGlow3=e;var t=this.scene.add.image(-1.7267/3,-.1038,DS,LS.PLAY_SCREEN.EFFECTS.GLOW);t.setDefaultWorldSize(),t.setAlpha(0),t.setBlendMode(Phaser.BlendModes.ADD),e.add(t),this.glow3=t},n.setButtonsDisable=function(e){this.playContainer.setButtonsDisable(e)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),null==(t=this.idleAnim)||t.start(),e.next=4,this.playEntranceAnimation();case 4:this.onEntranceCompleted();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),e.next=3,this.playExitAnimation();case 3:this.onExitCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.exitAnims)||t.forEach((function(e){return e.stop()})),this.entranceAnims=[this.scene.add.tween({targets:[this.playContainer],duration:500,scale:{from:.5,to:1},alpha:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}),this.scene.add.tween({targets:[this],duration:150,alpha:{from:0,to:1}}),this.scene.add.tween({targets:[this.playContainer.boostersContainer.bgReward],duration:300,scale:{from:.9,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(){n.playContainer.boostersContainer.setBgRewardBlendModes(Phaser.BlendModes.NORMAL)},onComplete:function(){n.playContainer.boostersContainer.setBgRewardBlendModes(Phaser.BlendModes.ADD)}}),this.scene.add.tween({targets:[this.playContainer.boostersContainer.case],duration:300,scale:{from:.9,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})],e.next=4,Promise.all(this.entranceAnims.map((function(e){return e.waitForCompletion()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.entranceAnims)||t.forEach((function(e){return e.stop()})),this.exitAnims=[this.scene.add.tween({targets:[this.playContainer],scale:.75,ease:Phaser.Math.Easing.Back.In,duration:150}),this.scene.add.tween({targets:[this],alpha:0,duration:150,onStart:function(){n.scene.gameUI.coinBarButton.setDisabled(!1),n.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON)}})],e.next=4,Promise.all(this.exitAnims.map((function(e){return e.waitForCompletion()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createIdleAnimation=function(){this.idleAnim=new VA([{target:this.glow2,rgba:[{color:"ffffff00"},{time:.65,color:"60fff8f3",curve:"stepped"},{time:2.4,color:"60fff8f3"},{time:3.05,color:"ffffff00"}]},{target:this.glow3,rgba:[{time:.6667,color:"ffffff00"},{time:1.1167,color:"60fff8f3",curve:"stepped"},{time:2.3667,color:"60fff8f3"},{time:2.8333,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.rewardChestAdd,rgba:[{color:"ffffff00",curve:[.278,1,.556,1,.278,1,.556,1,.278,1,.556,1,.262,0,.595,.09]},{time:.8333,color:"ffffff18",curve:[1.111,1,1.389,1,1.111,1,1.389,1,1.111,1,1.389,1,1.111,.1,1.389,0]},{time:1.6667,color:"ffffff00",curve:[1.944,1,2.222,1,1.944,1,2.222,1,1.944,1,2.222,1,1.928,0,2.262,.09]},{time:2.5,color:"ffffff18",curve:[2.778,1,3.056,1,2.778,1,3.056,1,2.778,1,3.056,1,2.778,.1,3.056,0]},{time:3.3333,color:"ffffff00",curve:[3.611,1,3.889,1,3.611,1,3.889,1,3.611,1,3.889,1,3.595,0,3.929,.09]},{time:4.1667,color:"ffffff18",curve:[4.444,1,4.722,1,4.444,1,4.722,1,4.444,1,4.722,1,4.444,.1,4.722,0]},{time:5,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.rewardChestAdd2,rgba:[{color:"ffffff10",curve:[.113,1,.223,1,.113,1,.223,1,.113,1,.223,1,.114,.08,.225,.09]},{time:.3333,color:"ffffff18",curve:[.611,1,.889,1,.611,1,.889,1,.611,1,.889,1,.611,.1,.885,0]},{time:1.1667,color:"ffffff00",curve:[1.334,1,1.5,1,1.334,1,1.5,1,1.334,1,1.5,1,1.329,0,1.5,.04]},{time:1.6667,color:"ffffff10",curve:[1.78,1,1.89,1,1.78,1,1.89,1,1.78,1,1.89,1,1.78,.08,1.892,.09]},{time:2,color:"ffffff18",curve:[2.278,1,2.556,1,2.278,1,2.556,1,2.278,1,2.556,1,2.278,.1,2.552,0]},{time:2.8333,color:"ffffff00",curve:[3.001,1,3.167,1,3.001,1,3.167,1,3.001,1,3.167,1,2.995,0,3.167,.04]},{time:3.3333,color:"ffffff10",curve:[3.446,1,3.556,1,3.446,1,3.556,1,3.446,1,3.556,1,3.447,.08,3.559,.09]},{time:3.6667,color:"ffffff18",curve:[3.944,1,4.222,1,3.944,1,4.222,1,3.944,1,4.222,1,3.944,.1,4.218,0]},{time:4.5,color:"ffffff00",curve:[4.668,1,4.835,1,4.668,1,4.835,1,4.668,1,4.835,1,4.662,0,4.832,.03]},{time:5,color:"ffffff10"}]},{target:this.playContainer.boostersContainer.star,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.star2,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.star3,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.topCaseAdd1,rgba:[{time:1.05,color:"ffffff00",curve:[1.384,1,1.716,1,1.384,1,1.716,1,1.384,1,1.716,1,1.187,.05,1.716,.21]},{time:2.05,color:"ffffff37",curve:[2.384,1,2.716,1,2.384,1,2.716,1,2.384,1,2.716,1,2.384,.21,2.716,.05]},{time:3.05,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd2,rgba:[{time:1.6,color:"ffffff00",curve:[1.934,1,2.266,1,1.934,1,2.266,1,1.934,1,2.266,1,1.737,.05,2.266,.21]},{time:2.6,color:"ffffff37",curve:[2.934,1,3.266,1,2.934,1,3.266,1,2.934,1,3.266,1,2.934,.21,3.266,.05]},{time:3.6,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd3,rgba:[{time:2.2,color:"ffffff00",curve:[2.534,1,2.866,1,2.534,1,2.866,1,2.534,1,2.866,1,2.337,.05,2.866,.21]},{time:3.2,color:"ffffff37",curve:[3.556,1,3.911,1,3.556,1,3.911,1,3.556,1,3.911,1,3.556,.21,3.911,.05]},{time:4.2667,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd4,rgba:[{time:2.8833,color:"ffffff00",curve:[3.217,1,3.549,1,3.217,1,3.549,1,3.217,1,3.549,1,3.021,.05,3.549,.21]},{time:3.8833,color:"ffffff37",curve:[4.256,1,4.627,1,4.256,1,4.627,1,4.256,1,4.627,1,4.256,.21,4.627,.05]},{time:5,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.boneStar,rotate:[{value:-24.94},{time:1,value:-62.8},{time:1.6667,value:-24.94},{time:2.6667,value:-62.8},{time:3.3333,value:-24.94},{time:4.3333,value:-62.8}],scale:[{x:0,y:0,curve:[.032,.593,.335,1,.032,.593,.335,1]},{time:.5,curve:[.701,1,.835,.333,.701,1,.835,.333]},{time:1,x:0,y:0,curve:"stepped"},{time:1.6667,x:0,y:0,curve:[1.699,.593,2.001,1,1.699,.593,2.001,1]},{time:2.1667,curve:[2.368,1,2.501,.333,2.368,1,2.501,.333]},{time:2.6667,x:0,y:0,curve:"stepped"},{time:3.3333,x:0,y:0,curve:[3.366,.593,3.668,1,3.366,.593,3.668,1]},{time:3.8333,curve:[4.034,1,4.168,.333,4.034,1,4.168,.333]},{time:4.3333,x:0,y:0}]},{target:this.playContainer.boostersContainer.boneStar2,rotate:[{value:-24.94,curve:"stepped"},{time:4,value:-24.94},{time:5,value:-62.8}],scale:[{x:0,y:0,curve:"stepped"},{time:.6667,x:0,y:0,curve:[.699,.593,1.001,1,.699,.593,1.001,1]},{time:1.1667,curve:[1.368,1,1.5,0,1.368,1,1.5,0]},{time:1.6667,x:0,y:0,curve:"stepped"},{time:2.3333,x:0,y:0,curve:[2.366,.593,2.668,1,2.366,.593,2.668,1]},{time:2.8333,curve:[3.034,1,3.167,0,3.034,1,3.167,0]},{time:3.3333,x:0,y:0,curve:"stepped"},{time:4,x:0,y:0,curve:[4.032,.593,4.335,1,4.032,.593,4.335,1]},{time:4.5,curve:[4.701,1,4.835,.333,4.701,1,4.835,.333]},{time:5,x:0,y:0}]},{target:this.playContainer.boostersContainer.boneStar3,rotate:[{value:-43.87},{time:.5,value:-62.8},{time:1.1667,value:-24.94},{time:1.6667,value:-43.87},{time:2.1667,value:-62.8},{time:2.8333,value:-24.94},{time:3.3333,value:-43.87},{time:3.8333,value:-62.8},{time:4.5,value:-24.94},{time:5,value:-43.87}],scale:[{curve:[.201,1,.335,.333,.201,1,.335,.333]},{time:.5,x:0,y:0,curve:"stepped"},{time:1.1667,x:0,y:0,curve:[1.199,.593,1.5,1,1.199,.593,1.5,1]},{time:1.6667,curve:[1.868,1,2.001,.333,1.868,1,2.001,.333]},{time:2.1667,x:0,y:0,curve:"stepped"},{time:2.8333,x:0,y:0,curve:[2.866,.593,3.167,1,2.866,.593,3.167,1]},{time:3.3333,curve:[3.534,1,3.668,.333,3.534,1,3.668,.333]},{time:3.8333,x:0,y:0,curve:"stepped"},{time:4.5,x:0,y:0,curve:[4.532,.593,4.835,1,4.532,.593,4.835,1]},{time:5}]},{target:this.boneGlow2,rotate:[{value:10.5}],translate:[{x:-34.46,y:-6.11,curve:[1.015,-34.46,2.035,116.17,1.015,-6.11,2.035,21.12]},{time:3.05,x:116.17,y:21.12}],scale:[{x:.219,y:.024,curve:[.211,.123,.662,.654,.207,.019,.662,.043]},{time:1,x:.654,y:.043,curve:"stepped"},{time:2.05,x:.654,y:.043,curve:[2.388,.654,2.718,.369,2.388,.043,2.718,.03]},{time:3.05,x:.219,y:.024}]},{target:this.boneGlow3,rotate:[{value:10.5}],translate:[{x:-34.46,y:-6.11,curve:"stepped"},{time:.6667,x:-34.46,y:-6.11,curve:[.705,-34.46,2.112,20.77,.705,-6.11,2.112,3.87]},{time:2.8333,x:20.77,y:3.87}],scale:[{x:.219,y:.024,curve:"stepped"},{time:.6667,x:.219,y:.024,curve:[1.265,.23,1.263,.379,1.265,.024,1.263,.043]},{time:1.5667,x:.379,y:.043,curve:"stepped"},{time:2.1167,x:.379,y:.043},{time:2.8333,x:.219,y:.024}]}]),this.idleAnim.setLoop(-1)},t}(GameCore.Screen),_S=MS,NS=n(56),GS=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(i=n||{}).startNumber,s=void 0===r?0:r,o=i.endNumber,c=void 0===o?100:o,h=i.duration,u=void 0===h?1e3:h,l=i.completeDelay,d=void 0===l?0:l,p=i.onUpdate,f=i.onStart,m=i.ease,g=void 0===m?Phaser.Math.Easing.Sine.InOut:m,e.abrupt("return",new Promise((function(e){t.tweens.addCounter({from:s,to:c,duration:u,completeDelay:d,ease:g,onStart:f,onUpdate:p,onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),FS=GS,ZS=Ki.Z.DEFAULT,US=ZS.KEY,WS=ZS.FRAME,YS=Ki.Z.DASHBOARD,HS=YS.KEY,zS=YS.FRAME,KS=310,VS=305,XS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.mainIcon=void 0,n.coinValue=void 0,n.noThanksButton=void 0,n.claimButton=void 0,n.claimX3Button=void 0,n.coinText=void 0,n.coinIcon=void 0,n.starEmitter=void 0,n.starEmitZone=void 0,n.scene=t,n.setSize(KS,VS),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.mainIcon,scale:this.mainIcon.scale},{obj:this.coinValue,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,r=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:r},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.runClaimedCoinX3IncreaseAnimation=function(e){var t=this,n=3*e;return FS(this.scene,{startNumber:e,endNumber:n,duration:700,onUpdate:function(e){var n=Math.floor(e.getValue());t.updateClaimedCoinText(n)}})},n.runCoinValueBounceAnimation=function(){var e=this.scene.tweens.add({targets:this.coinValue,scale:{from:1,start:1,to:1.2},duration:300,ease:Phaser.Math.Easing.Sine.In}).waitForCompletion(),t=this.scene.tweens.add({targets:this.coinValue,scale:{from:1.2,start:1.2,to:1},duration:200,ease:Phaser.Math.Easing.Back.Out,delay:300}).waitForCompletion();return Promise.all([e,t])},n.runHideButtonAnimation=function(){return this.scene.tweens.add({targets:[this.claimButton,this.claimX3Button],alpha:0,duration:400,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion()},n.updateClaimedCoinText=function(e){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.coinText.setText(""+t),this.coinValue.setSize(this.coinText.width+this.coinIcon.width+6,this.coinIcon.height),Phaser.Display.Align.In.LeftCenter(this.coinIcon,this.coinValue),Phaser.Display.Align.In.RightCenter(this.coinText,this.coinValue,-1.4,.5)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,0),Phaser.Display.Align.In.Center(this.mainIcon,this,.5,-45.7),Phaser.Display.Align.In.Center(this.coinValue,this,0,11.2),Phaser.Display.Align.In.BottomCenter(this.claimButton,this,0,-14),Phaser.Display.Align.In.BottomCenter(this.claimX3Button,this,0,-66.5);var e=this.mainIcon.getWorldPosition(),t=e.x,n=e.y;this.updateEmittersPosition(t,n)},n.create=function(){this.createTitleText(),this.createMainIcon(),this.createCoinValue(),this.createClaimX3Button(),this.createClaimButton(),this.createStarParticle()},n.createTitleText=function(){this.titleText=new Rf(this.scene),this.titleText.setText("Welcome Back!"),this.titleText.setFontSize(40),this.titleText.setRadius(-1138),this.titleText.setLetterSpacing(.05),this.titleText.setOrigin(.5,.5),this.add(this.titleText)},n.createMainIcon=function(){var e=this.scene.add.image(0,0,HS,zS.ICON.NEW_COINS);e.setDefaultWorldSize(),this.add(e),this.mainIcon=e},n.createCoinValue=function(){this.coinValue=this.scene.add.container(),this.add(this.coinValue);var e=new Qp(this.scene,{text:"1000",fontSize:this.scene.fontSize(15),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:.15});this.coinValue.add(e);var t=this.scene.add.image(0,0,HS,zS.ICON.COIN);t.setWorldSize(25,25),this.coinValue.add(t),this.coinValue.setSize(107,t.height),Phaser.Display.Align.In.LeftCenter(t,this.coinValue),Phaser.Display.Align.In.RightCenter(e,this.coinValue),this.coinText=e,this.coinIcon=t},n.createNoThanksButton=function(){var e=new jp.Z(this.scene,117,124/3);this.add(e),this.noThanksButton=e,this.noThanksButton.setName("Claim");var t=this.scene.add.image(0,0,HS,zS.WELCOME_BACK.NO_THANKS);t.setDefaultWorldSize(),t.setPosition(0,-1.2),this.noThanksButton.add(t)},n.createClaimButton=function(){var e=new oy(this.scene,{key:Ki.Z.DASHBOARD.KEY,buttonFrame:Ki.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_GREEN_SHADOW,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117.5});this.add(e),this.claimButton=e,this.claimButton.button.setName("Claim");var t=new Qp(this.scene,{text:"Claim",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2.3,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:-.2});t.setPosition(0,-1.2),this.claimButton.addIntoButton(t),this.claimButton.setScale(.8)},n.createClaimX3Button=function(){var e=new oy(this.scene,{key:Ki.Z.DASHBOARD.KEY,buttonFrame:Ki.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_BLUE,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117.5});this.add(e),this.claimX3Button=e,this.claimX3Button.button.setName("ClaimX3");var t=this.scene.add.image(0,0,US,WS.GET_MORE_COIN_SCREEN.NEW_ICON_AD);t.setDefaultWorldSize(),t.setPosition(-32.9,-.25),this.claimX3Button.addIntoButton(t);var n=new Qp(this.scene,{text:"+200%",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2.3,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:-.2});n.setPosition(16,-1.2),this.claimX3Button.addIntoButton(n)},n.updateEmittersPosition=function(e,t){this.starEmitZone.setTo(e-96,t+38,e+96,t+38,e,t-50)},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,US,WS.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e),this.starEmitZone=new Phaser.Geom.Triangle;var t=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:WS.EFFECTS.STAR_2,emitZone:{source:this.starEmitZone,type:"random"},frequency:100,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.InOut},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:t/2,max:1.5*t})},particleClass:NS.Z,quantity:1})},n.runParticle=function(){this.starEmitter.start()},n.stopParticle=function(){this.starEmitter.stop()},t}(Phaser.GameObjects.Container),jS=XS,qS=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.welcomeBackContainer=void 0,o.claimedCoinX1=void 0,o.claimedCoinX3=void 0,o.isOpening=void 0,o.handleClaim=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.handleClaimSuccess(o.claimedCoinX1);case 1:case"end":return e.stop()}}),e)}))),o.handleClaimX3=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.scene.showRewardedVideoAsync();case 2:e.sent?o.handleClaimSuccess(o.claimedCoinX3):o.handleClaimSuccess(o.claimedCoinX1);case 4:case"end":return e.stop()}}),e)}))),o.handleClaimSuccess=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(new Date).getTime(),o.scene.player.setLastWelcomeBackRewardTime(n),i=o.welcomeBackContainer.coinValue.getWorldPosition(),r=i.x,s=i.y,c=t/o.claimedCoinX1,h=1===c?14:21,3!==c){e.next=12;break}return o.setButtonsDisable(!0),o.welcomeBackContainer.runHideButtonAnimation(),e.next=10,o.welcomeBackContainer.runClaimedCoinX3IncreaseAnimation(o.claimedCoinX1);case 10:return e.next=12,o.welcomeBackContainer.runCoinValueBounceAnimation();case 12:if(o.scene.tweens.add({targets:o.welcomeBackContainer,alpha:0,duration:500,ease:Phaser.Math.Easing.Back.Out}),o.scene.gameUI.isCoinShowing()){e.next=18;break}return o.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),e.next=18,o.scene.gameUI.showCoin();case 18:o.scene.rewardManager.rewardCoin(t),o.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(h,r,s).then((function(){o.scene.screen.close(o.name)})),u=3===c?Cl.WELCOME_BACK_AD:Cl.WELCOME_BACK,o.scene.logEconomy.logGetItem(yl.COIN,t,u);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.isOpening=!1,o.welcomeBackContainer.setAlpha(1),o.welcomeBackContainer.setScale(1)},o.scene=t,o.create(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),o.listenEvents(),o.isOpening=!1,Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.welcomeBackContainer,t=e.claimButton,n=e.claimX3Button;t.onClick=this.handleClaim,n.onClick=this.handleClaimX3},n.create=function(){var e=new jS(this.scene);this.add(e),this.welcomeBackContainer=e},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOpening){t.next=2;break}return t.abrupt("return");case 2:e.prototype.open.call(this,n),this.isOpening=!0,this.updateData(),this.setButtonsDisable(!1),this.runEntranceAnimation(),this.welcomeBackContainer.runEntranceAnimation(),this.welcomeBackContainer.runParticle();case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateData=function(){var e=vf.instance.reward.welcomeBackOffer;this.claimedCoinX1=e,this.claimedCoinX3=3*e,this.welcomeBackContainer.updateClaimedCoinText(e)},n.setButtonsDisable=function(e){var t=this.welcomeBackContainer,n=t.claimButton,i=t.claimX3Button;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.close=function(){this.background.off(Phaser.Input.Events.POINTER_DOWN),this.setButtonsDisable(!0),this.runExitAnimation(),this.welcomeBackContainer.stopParticle()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.welcomeBackContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),JS=qS,QS=Ki.Z.WEEKLY_TOURNAMENT,$S=QS.KEY,eT=QS.FRAME,tT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.clock=void 0,n.minuteHand=void 0,n.clockHandAnimation=void 0,n.scene=t,n.create(),n.setSize(n.clock.width,n.clock.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.animate=function(){this.createClockHandAnimation()},n.stopAnimation=function(){var e;null==(e=this.clockHandAnimation)||e.stop(),this.minuteHand.setAngle(0)},n.create=function(){this.createClock(),this.createHourHand(),this.createMinuteHand(),this.createRedDot()},n.createClock=function(){var e=this.scene.add.image(0,0,$S,eT.COMMON.CLOCK);e.setDefaultWorldSize(),this.add(e),this.clock=e},n.createHourHand=function(){var e=this.scene.add.image(0,0,$S,eT.COMMON.CLOCK_HAND);e.setOrigin(.5,.1),e.setDefaultWorldSize(),e.setY(-.5),e.setAngle(180),this.add(e)},n.createMinuteHand=function(){var e=this.scene.add.image(0,0,$S,eT.COMMON.CLOCK_HAND);e.setOrigin(.5,.1),e.setDefaultWorldSize(),e.setY(-.5),this.add(e),this.minuteHand=e},n.createRedDot=function(){var e=this.scene.add.image(0,0,$S,eT.COMMON.RED_DOT);e.setDefaultWorldSize(),e.setScale(1.05*e.scale),e.setY(-.5),this.add(e)},n.createClockHandAnimation=function(){var e;null==(e=this.clockHandAnimation)||e.stop(),this.clockHandAnimation=this.scene.tweens.createTimeline({targets:this.minuteHand,loop:-1}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.play()},t}(Phaser.GameObjects.Container),nT=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(229/3,59/3)},n.createText=function(){this.txt=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"23:59:59",origin:{x:.5,y:.5}}),this.txt.setPosition(9,-.5),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new iT(this)},n.setText=function(e){this.txt.setText(e)},t}(Phaser.GameObjects.Container),iT=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.status="Finished",t.countdownTimer.remove(),t.timerPanel.emit("finished");else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")}t.timerPanel.txt.setText(t.status)}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.setTimerStatus=function(e){var t;null==(t=this.countdownTimer)||t.remove(),this.status=e,this.timerPanel.txt.setText(e)},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),rT=function(e){function t(t,n){var i;(i=e.call(this,t)||this).buttonWidth=void 0,i.buttonHeight=void 0,i.buttonInnerWidth=void 0,i.buttonInnerHeight=void 0,i.button=void 0,i.background=void 0;var r=n.key,a=n.backgroundFrame,s=n.buttonFrame,o=n.buttonWidth,c=n.buttonHeight,h=n.buttonInnerWidth,u=n.buttonInnerHeight;return i.buttonWidth=o,i.buttonHeight=c,i.buttonInnerWidth=h||0,i.buttonInnerHeight=u||0,i.setSize(i.buttonWidth,i.buttonHeight),i.createBackground(r,a),i.createButton(r,s),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignBackground=function(e,t){this.background.setPosition(e,t)},n.createBackground=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:this.width,height:this.height});this.add(n),this.background=n},n.createButton=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:0==this.buttonInnerWidth?this.width-19/3:this.buttonInnerWidth,height:0==this.buttonInnerHeight?this.height-23/3:this.buttonInnerHeight});this.button=new jp.Z(this.scene,n.displayWidth,n.displayHeight,.95),this.add(this.button),this.button.add(n)},n.setDisabled=function(e){this.button.setDisabled(e)},n.addIntoButton=function(e){this.button.add(e)},(0,X.Z)(t,[{key:"onClick",set:function(e){this.button.onClick=e}}]),t}(Phaser.GameObjects.Container),aT=rT,sT=Ki.Z.WEEKLY_TOURNAMENT,oT=sT.KEY,cT=sT.FRAME,hT=function(e){function t(t){var n;return(n=e.call(this,t,{key:oT,backgroundFrame:cT.INTRODUCTION.BUTTON.BASE,buttonFrame:cT.INTRODUCTION.BUTTON.GREEN,buttonWidth:170,buttonHeight:137/3,buttonInnerWidth:436/3,buttonInnerHeight:41})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.alignBackground(0,-.5),n.setSize(n.width,n.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new Qp(this.scene,{text:"Play",fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},t}(aT),uT=hT,lT=Ki.Z.WEEKLY_TOURNAMENT,dT=lT.KEY,pT=lT.FRAME,fT=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).scene=void 0,r.screen=void 0,r.header=void 0,r.playButton=void 0,r.timerPanel=void 0,r.closeButton=void 0,r.animateClock=void 0,r.handlePlayButton=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.scene.weeklyTournament,n=r.screen.previousScreen,r.screen.previousScreen=void 0,r.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN),!t.isWaiting()){e.next=11;break}return e.next=7,r.scene.joinTournament(!1,de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 7:"success"==e.sent?r.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:n}):(r.scene.weeklyTournament.setStatus(xo.WAITING),r.scene.screen.open(n||de.o4.DASHBOARD_SCREEN)),e.next=12;break;case 11:r.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:n});case 12:case"end":return e.stop()}}),e)}))),r.handleCloseButton=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 1:case"end":return e.stop()}}),e)}))),r.scene=t,r.screen=n,r.setSize(374,277),r.create(),r.alignItems(),r.listenEvents(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setAlpha(1),this.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.playButton.onClick=this.handlePlayButton,this.closeButton.onClick=this.handleCloseButton},n.create=function(){this.createBackground(),this.createCloseButton(),this.createHeader(),this.createPlayButton(),this.createDescription(),this.createTimer()},n.createBackground=function(){var e=new fy(this.scene,{key:dT,frame:pT.INTRODUCTION.POPUP,width:1247/3,height:871/3,topHeight:140/3,bottomHeight:160/3});this.add(e),this.setSize(e.displayWidth,e.displayHeight);var t=this.scene.add.image(0,0,dT,pT.INTRODUCTION.THUMBNAIL);t.setDefaultWorldSize(),this.add(t),t.setY(1.5)},n.createCloseButton=function(){var e=new ov.Z(this.scene,{key:dT,frame:pT.INTRODUCTION.CLOSE,width:40/3,height:14,paddingZone:30});e.setName("Close"),this.add(e),Phaser.Display.Align.In.TopRight(e,this,-18,-26.5),this.closeButton=e},n.createHeader=function(){var e=this.scene.add.container(0,0);e.setSize(896/3,69),this.add(e);var t=this.scene.add.image(0,0,dT,pT.INTRODUCTION.HEADER_BG);t.setWorldSize(989/3,58),e.add(t);var n=new Rf(this.scene);n.setText("Weekly Tournament"),n.setFontSize(22),n.setRadius(-1500),n.setLetterSpacing(-.2),n.setPosition(0,-1.5),e.add(n),this.header=e},n.createPlayButton=function(){var e=new uT(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.createDescription=function(){var e=new Qp(this.scene,{text:"Participate in the tournament to win\ngreat rewards!",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setLineSpacing(1.4),e.setCenterAlign(),e.setY(-this.height/2+51),this.add(e)},n.createTimer=function(){this.timerPanel=new nT(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,dT,pT.INTRODUCTION.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0),this.animateClock=new tT(this.scene),this.animateClock.setPosition(-29,0),this.timerPanel.addAt(this.animateClock,1),this.timerPanel.setY(this.height/2-47),this.timerPanel.setX(2)},n.alignItems=function(){this.header.setY(-this.height/2-5),this.playButton.setPosition(1,this.height/2-5)},t}(Phaser.GameObjects.Container),mT=fT,gT=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.welcomeWeeklyTournamentContainer=void 0,a.previousScreen=void 0,a.close=function(){a.background.off(Phaser.Input.Events.POINTER_DOWN),a.runExitAnimation()},a.onEntranceCompleted=function(){a.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.scene.screen.close(a.name)}))},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a)),a.scene.gameUI.coinBarButton.setDisabled(!1),a.welcomeWeeklyTournamentContainer.animateClock.stopAnimation(),a.previousScreen&&a.scene.screen.open(a.previousScreen)},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWelcomeWeeklyTournamentContainer()},n.createWelcomeWeeklyTournamentContainer=function(){this.welcomeWeeklyTournamentContainer=new mT(this.scene,this),this.welcomeWeeklyTournamentContainer.setInteractive(),this.add(this.welcomeWeeklyTournamentContainer),Phaser.Display.Align.In.Center(this.welcomeWeeklyTournamentContainer,this,0,7)},n.open=function(t){e.prototype.open.call(this,t);var n=(null!=t?t:{previousScreen:de.o4.DASHBOARD_SCREEN}).previousScreen;this.previousScreen=n,this.welcomeWeeklyTournamentContainer.open(),this.runEntranceAnimation(),this.updateTimer()},n.updateTimer=function(){var e=this.scene.weeklyTournament.getRemainingTime();this.welcomeWeeklyTournamentContainer.timerPanel.timerLogic.setRemainingTime(e),this.welcomeWeeklyTournamentContainer.animateClock.animate()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.welcomeWeeklyTournamentContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.welcomeWeeklyTournamentContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),vT=gT,yT=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t)||this).scene=void 0,a.tutorialImage=void 0,a.tutorialText=void 0,a.scene=t,a.setSize(40,40),a.createTutorialImage(n,i),a.createTutorialText(r),a.alignItems(),t.add.existing((0,yc.Z)(a)),a}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1/GameCore.ImageScale,r=this.scene.tweens.add({targets:this.tutorialImage,delay:t,duration:n,scale:{from:0,start:0,to:i},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){c.revive(),c.tutorialImage.setScale(0),c.tutorialImage.setAlpha(1)}}).waitForCompletion(),s=this.tutorialText.y,o=this.scene.tweens.add({targets:this.tutorialText,delay:t+100,duration:n-100,scale:{from:0,start:0,to:1},y:{from:s-20,start:s-20,to:s+0},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){c.tutorialText.setScale(0),c.tutorialText.setAlpha(1)}}).waitForCompletion(),e.abrupt("return",Promise.all([r,o]));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.tutorialImage.width,t=this.tutorialText.height;this.setSize(e,t),Phaser.Display.Align.In.TopCenter(this.tutorialText,this),this.tutorialImage.setY(this.tutorialText.y-this.tutorialText.height/2-Math.max(this.tutorialImage.height/2,50))},n.createTutorialImage=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.tutorialImage=n},n.createTutorialText=function(e){var t=new Qp(this.scene,{text:e,fontSize:this.scene.fontSize(15),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setOrigin(.5,0),t.setCenterAlign(),this.add(t),this.tutorialText=t},t}(Phaser.GameObjects.Container),ET=yT,CT=function(e){function t(t,n){var i;return void 0===n&&(n=.925),(i=e.call(this,t,t.gameZone.width,t.gameZone.height,n)||this).children=[],i.text=void 0,i.createText(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=new Qp(this.scene,{text:"Tap to claim",fontSize:this.scene.fontSize(24),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setAlpha(.5),this.add(e),this.text=e},n.add=function(t){var n;e.prototype.add.call(this,t);var i=Array.isArray(t)?t:[t];return(n=this.children).push.apply(n,i),this},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this.children,scale:this.scaleDown,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this.children,scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(t){e.disable&&(t.remove(),e.setScale(1))},onUpdate:function(t){e.disable&&(t.remove(),e.setScale(1))}})},t}(jp.Z),wT=CT,AT=Ki.Z.BOXING_DUEL,bT=AT.KEY,ST=AT.FRAME,TT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.Center(this.step1,this,-170,60),Phaser.Display.Align.In.Center(this.step2,this,0,60),Phaser.Display.Align.In.Center(this.step3,this,190,60),Phaser.Display.Align.In.Center(this.arrow1,this,-90,10),Phaser.Display.Align.In.Center(this.arrow2,this,95,10)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[ST.INTRO.ITEM_1,ST.INTRO.ITEM_2,ST.INTRO.ITEM_3],n=["Collect gloves!","Beat your opponent!","Win the match!"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,bT,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,bT,ST.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),xT=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new TT(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),kT=Ki.Z.BOXING_DUEL,PT=kT.KEY,IT=kT.FRAME,OT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-70,-50),Phaser.Display.Align.In.Center(this.step2,this,90,60),Phaser.Display.Align.In.Center(this.step3,this,-80,190),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,110),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height+20;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[IT.INTRO.ITEM_1,IT.INTRO.ITEM_2,IT.INTRO.ITEM_3],n=["Collect gloves!","Beat your opponent!","Win the match!"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,PT,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[IT.INTRO.ARROW_RIGHT,IT.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var r=e.scene.add.image(0,0,PT,t[i]);return r.setDefaultWorldSize(),r}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),RT=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new OT(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),BT=GameCore.layoutInitializer.isLandscape?xT:RT,DT=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=new Qp(this.scene,{text:"23:59:59",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeAlpha:.9,fillColor:16777215}),this.txt.setPosition(0,9),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new LT(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),LT=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",11),t.countdownTimer.remove();else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},t.formatUnitTime=function(e){return e<10?"0"+e:e.toString()},e}(),MT=680/3,_T=85/3,NT=Ki.Z.BOXING_DUEL,GT=NT.KEY,FT=NT.FRAME,ZT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.minProgressWidth=void 0,n.maxProgressWidth=void 0,n.progressHeight=void 0,n.redProgress=void 0,n.blueProgress=void 0,n.gloves=void 0,n.blueText=void 0,n.redText=void 0,n.redGlove=void 0,n.blueGlove=void 0,n.blueScore=0,n.redScore=0,n.progressAnimation=void 0,n.progressDuration=500,n.gloveDuration=200,n.scoreCounterAnimation=void 0,n.progressBarAnimation=void 0,n.scene=t,n.setSize(MT,_T),n.minProgressWidth=170/3,n.maxProgressWidth=MT-n.minProgressWidth,n.progressHeight=41/3,n.createBackground(),n.createBlueProgress(),n.createRedProgress(),n.createGloves(),n.bringToTop(n.blueText),n.bringToTop(n.redText),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateProgressBar=function(e,t,n){var i,r;null==(i=this.progressAnimation)||i.stop(),null==(r=this.scoreCounterAnimation)||r.stop(),this.progressDuration=n?250:1e3,this.runScoreAnimation(e,t),this.runProgressBarAnimation(e,t)},n.runScoreAnimation=function(e,t){var n=this,i=this.blueScore.valueOf(),r=this.redScore.valueOf();this.scoreCounterAnimation=this.scene.tweens.addCounter({from:0,to:1,ease:Phaser.Math.Easing.Sine.InOut,duration:this.progressDuration,onUpdate:function(a){var s=i+(e-i)*a.getValue(),o=r+(t-r)*a.getValue();n.updateScores(s,o)},onStop:function(){n.updateScores(e,t)}})},n.runProgressBarAnimation=function(e,t){var n=this,i=this.blueProgress.displayWidth,r=this.redProgress.displayWidth,a=this.calculateProgressLengths(e,t),s=a.lengthBlue,o=a.lengthRed;this.progressBarAnimation=this.scene.tweens.addCounter({from:0,to:1,ease:Phaser.Math.Easing.Sine.InOut,duration:this.progressDuration,onStart:function(){i==r&&e!=t&&n.runMergeGlovesAnim(),e>t?(n.updateAlphaGlove([n.blueGlove],1),n.updateAlphaGlove([n.redGlove],0)):e<t?(n.updateAlphaGlove([n.redGlove],1),n.updateAlphaGlove([n.blueGlove],0)):n.updateAlphaGlove([n.blueGlove,n.redGlove],1)},onUpdate:function(e){var t=i+(s-i)*e.getValue(),a=r+(o-r)*e.getValue();n.blueProgress.setSizeByWorld(t,n.progressHeight),n.redProgress.setSizeByWorld(a,n.progressHeight),n.gloves.setX(n.blueProgress.x+n.blueProgress.displayWidth)},onComplete:function(){e==t&&n.runSplitGlovesAnim()},onStop:function(){n.blueProgress.setSizeByWorld(s,n.progressHeight),n.redProgress.setSizeByWorld(o,n.progressHeight),n.blueGlove.setX(n.blueProgress.x+n.blueProgress.displayWidth),n.redGlove.setX(n.redProgress.x-n.redProgress.displayWidth),e==t?(n.blueGlove.setX(-13),n.redGlove.setX(13),n.blueGlove.setAlpha(1),n.redGlove.setAlpha(1)):(n.blueGlove.setAlpha(e>t?1:0),n.redGlove.setAlpha(e<t?1:0))}})},n.updateScores=function(e,t){this.blueScore=e,this.redScore=t,this.blueText.setText(""+Math.round(this.blueScore)),this.redText.setText(""+Math.round(this.redScore));var n=(-87.33333333333333+(-109.33333333333333+this.blueProgress.displayWidth-5))/2;this.blueText.setX(n);var i=(87.33333333333333+(109.33333333333333-this.redProgress.displayWidth+5))/2;this.redText.setX(i)},n.calculateProgressLengths=function(e,t){var n=656/3,i=e+t;if(0==i)return{lengthBlue:n/2,lengthRed:n/2};var r=e/i*n,a=t/i*n;return r<70?a=n-(r=70):a<70&&(r=n-(a=70)),{lengthBlue:r,lengthRed:a}},n.updateAlphaGlove=function(e,t){this.scene.tweens.add({targets:[].concat(e),alpha:t,duration:this.gloveDuration})},n.runMergeGlovesAnim=function(){this.scene.tweens.add({targets:[this.blueGlove,this.redGlove],x:0,duration:this.gloveDuration})},n.runSplitGlovesAnim=function(){this.scene.tweens.add({targets:[this.blueGlove],alpha:1,x:-13,duration:this.gloveDuration}),this.scene.tweens.add({targets:[this.redGlove],alpha:1,x:13,duration:this.gloveDuration})},n.updateProgress=function(){var e=this.blueScore,t=this.redScore,n=(e+20)/(e+t+40)*100;n>100&&(n=100);var i=this.maxProgressWidth-this.minProgressWidth,r=Math.floor(n/100*i),a=Phaser.Math.Clamp(this.minProgressWidth+r,this.minProgressWidth,this.maxProgressWidth),s=Phaser.Math.Clamp(this.minProgressWidth+i-r,this.minProgressWidth,this.maxProgressWidth);this.blueProgress.setSizeByWorld(a,this.progressHeight),this.redProgress.setSizeByWorld(s,this.progressHeight),this.gloves.setX(this.blueProgress.x+a),this.blueText.setX(this.blueProgress.x+14+(a-this.gloves.width/2)/2),this.redText.setX(this.redProgress.x-13-(s-this.gloves.width/2)/2),this.redText.setText(""+Math.round(t)),this.blueText.setText(""+Math.round(e))},n.reset=function(){this.blueScore=0,this.redScore=0,this.updateProgress()},n.createBackground=function(){var e=this.scene.make.nineslice({key:GT,frame:FT.MAIN.LOADING.BASE,width:334/3,height:21,leftWidth:12,rightWidth:12});e.setOrigin(.5,.5),e.setSizeByWorld(MT,_T),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},n.createBlueProgress=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.make.nineslice({key:GT,frame:FT.MAIN.LOADING.BLUE,width:328/3,height:41/3,leftWidth:7,rightWidth:7});t.setOrigin(0,.5);var n=new Qp(this.scene,{text:"123",fontSize:this.scene.fontSize(14),strokeColor:3032985,strokeThickness:2,strokeAlpha:.7});n.setY(-2.5),this.add([t,n]),this.blueProgress=t,this.blueText=n,t.setPosition(-t.displayWidth,-2.5)},n.createRedProgress=function(){var e=this.scene.make.nineslice({key:GT,frame:FT.MAIN.LOADING.RED,width:328/3,height:41/3,leftWidth:7,rightWidth:7});e.setOrigin(1,.5);var t=new Qp(this.scene,{text:"123",fontSize:this.scene.fontSize(14),strokeColor:9710414,strokeThickness:2,strokeAlpha:.7});t.setY(-2.5),this.add([e,t]),this.redProgress=e,this.redText=t,e.setPosition(e.displayWidth,-2.5)},n.createGloves=function(){var e=this.scene.add.container();e.setSize(28,33),this.add(e);var t=this.scene.add.image(1.5,-2,GT,FT.MAIN.GLOVE.BLUE);t.setDefaultWorldSize(),e.add(t),this.blueGlove=t;var n=this.scene.add.image(-1.5,-2,GT,FT.MAIN.GLOVE.RED);n.setDefaultWorldSize(),e.add(n),this.redGlove=n,this.gloves=e},t}(Phaser.GameObjects.Container),UT=ZT,WT=function(e){return e[e.WAITING=0]="WAITING",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),YT=function(e){function t(t){var n;(n=e.call(this,t)||this).originalScale=void 0;var i=1/GameCore.ImageScale;return n.originalScale=Phaser.Math.FloatBetween(.5*i,i),n}return(0,f.Z)(t,e),t.prototype.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.lifeT<=.2?this.alpha=this.lifeT/.2:this.lifeT<=.6?this.alpha=1:this.alpha=1-(this.lifeT-.6)/.2,this.lifeT<=.2?(this.scaleX=this.originalScale,this.scaleY=this.originalScale):(this.scaleX=this.originalScale-(this.originalScale-.1)*(this.lifeT-.2)/.8,this.scaleY=this.originalScale-(this.originalScale-.1)*(this.lifeT-.2)/.8),r},t}(Phaser.GameObjects.Particles.Particle),HT=YT,zT=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).emitter=void 0,r.emitterKey=void 0,r.emitterFrame=void 0,r.scene=t,r.emitterKey=n,r.emitterFrame=i,r.setActive(!1),r.setVisible(!1),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,key:this.emitterKey,frame:this.emitterFrame,speedX:{min:0,max:0},speedY:{min:-8,max:-4},lifespan:{min:5e3,max:8e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:300,blendMode:"Multiply",particleClass:HT})},n.run=function(e,t,n,i,r,a){this.reset(),this.revive();var s=n-r/2,o=n+r/2,c=i-a/2,h=i+a/2;this.emitter.setPosition({min:s,max:o},{min:c,max:h}),this.emitter.setQuantity(e),this.emitter.setFrequency(t),this.emitter.start()},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},n.setEmitterTexture=function(e,t){this.emitterKey=e,this.emitterFrame=t,this.reset()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),KT=zT;function VT(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return XT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XT(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function XT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var jT=Ki.Z.BOXING_DUEL,qT=jT.KEY,JT=jT.FRAME,QT=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).scene=void 0,r.isPlayer=void 0,r.boxerFrame=void 0,r.lightBorder=void 0,r.crown=void 0,r.playerName=void 0,r.avatar=void 0,r.lightCrown=void 0,r.showCrownAnimation=void 0,r.showLightCrownAnimation=void 0,r.vfx=void 0,r.sparklesFlyUp=void 0,r.animatedPhotos=[],r.animatedPhotoHeight=57,r.peekabooContainer=void 0,r.borderCover=void 0,r.peekabooMask=void 0,r.randomOpponents=[],r.animatedPhotoPool=[],r.findingOpponentTween=void 0,r.randomFrame=void 0,r.handleFindOpponentCompleted=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.animatedPhotos.find((function(e){return 0===e.y}))||r.animatedPhotos[0],n=t.getData("info"),r.scene.boxingDuel.startNewMatch(n,""),r.updateBoxerName(n.name),r.updateBoxerPhoto(n.playerId,n.photo),r.reset();case 6:case"end":return e.stop()}}),e)}))),r.scene=t,r.isPlayer=n,r.boxerFrame=r.isPlayer?JT.PLAYER:JT.OPPONENT,r.create(),r.setSize(r.avatar.width,r.avatar.height),r.alignItems(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.sparklesFlyUp.stop(),this.borderCover.kill(),this.peekabooContainer.kill(),this.peekabooContainer.setImages([]),this.peekabooContainer.clearMask(!0),this.animatedPhotos=[],this.animatedPhotoPool.forEach((function(e){e.kill()}))},n.updateData=function(e){if(e){this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.name,i=e.photo;this.updateBoxerName(n),this.updateBoxerPhoto(t,i)}else this.setRandomPlayer()},n.updateBoxerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15),this.playerName.setText(t);var n=this.playerName.width>94?.95*this.scene.fontSize(14):this.scene.fontSize(14);this.playerName.setFontSize(n)},n.updateBoxerPhoto=function(e,t){this.randomFrame.kill(),this.avatar.loadPhoto(e,t,50)},n.setWon=function(){this.showLightCrown(!0),this.sparklesFlyUp.run(1,1e3,0,10,60,60),this.vfx.revive()},n.setLost=function(){this.showLightCrown(!1),this.sparklesFlyUp.stop(),this.vfx.kill()},n.setRandomPlayer=function(){this.randomFrame.revive(),this.playerName.setText("...")},n.showCrown=function(e){var t;this.lightCrown.setAlpha(0),null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.showLightCrown=function(e){var t;this.crown.setAlpha(0),null==(t=this.showLightCrownAnimation)||t.remove(),this.showLightCrownAnimation=this.scene.tweens.add({targets:this.lightCrown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.setLightBorder=function(e){e?this.lightBorder.revive():this.lightBorder.kill()},n.alignItems=function(){var e=this.isPlayer?-20:20;this.crown.setPosition(e,-30),this.lightCrown.setPosition(e,-30),this.lightBorder.setPosition(0,-1),this.playerName.setPosition(0,this.avatar.height/2-5)},n.stopFindingOpponentAnimation=function(){var e;this.findingOpponentTween.stop(),null==(e=this.findingOpponentTween)||e.remove(),this.reset()},n.runFindingOpponentAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=5-this.randomOpponents.length,e.next=3,this.loadOpponentData(t);case 3:return this.createPeekabooAvatars(),e.next=6,this.runOpponentAvatarsFinding();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createPeekabooAvatars=function(){var e=this,t=this.randomOpponents.slice(0,2);this.animatedPhotos=t.map((function(t,n){var i=e.getAnimatedPhoto();return i.setTexture(t.playerId),i.setWorldSize(57,57),i.setY(-e.animatedPhotoHeight*n),i.setData("info",t),i})),this.peekabooContainer.revive(),this.peekabooContainer.setImages(this.animatedPhotos),this.createPeekabooMask(),this.borderCover.revive()},n.runOpponentAvatarsFinding=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,3705,this.findingOpponentTween=this.scene.tweens.addCounter({from:0,to:5700,duration:3e3,onUpdate:function(e){n.animatedPhotos.forEach((function(t){if(t.y>=t.height){t.setY(t.y-2*t.height);var i=Phaser.Math.RND.pick(n.randomOpponents);t.setData("info",i),t.setTexture(i.playerId),t.setWorldSize(57,57)}t.y+=e.getValue()-(e.data[0].previous||0),n.setPeekabooMask()})),e.getValue()>=3705&&!t&&(t=!0,n.emit("opponent-found"))},onComplete:this.handleFindOpponentCompleted}),e.next=5,this.findingOpponentTween.waitForCompletion();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAnimatedPhoto=function(){var e=this.animatedPhotoPool.find((function(e){return!e.active}));if(!e){var t=this.scene.make.image({x:0,y:0});return this.add(t),this.animatedPhotoPool.push(t),t}return e.revive(),e},n.loadOpponentData=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<=0)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:n=(0,ir.h)(t),i=VT(n);case 4:if((r=i()).done){e.next=12;break}return s=r.value,e.next=8,this.loadPhoto(s.id,s.photo);case 8:o=e.sent,this.randomOpponents.push({playerId:o.id,name:s.name,photo:o.url,score:0,lastUpdated:0,logStart:!1});case 10:e.next=4;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.loadPhoto=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.scene.load.once("filecomplete-image-"+t,(function(){return e({id:t,url:n})})),i.scene.load.image(t,n),i.scene.load.start()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createVfx(),this.createAvatar(),this.createRandomFrame(),this.createPeekabooContainer(),this.createAvatarBorderCover(),this.createLightBorder(),this.createCrown(),this.createName(),this.createParticle()},n.createVfx=function(){var e=this.scene.add.image(0,0,qT,this.boxerFrame.VFX_AVATAR);e.setWorldSize(667/3,623/3),this.add(e),this.vfx=e,this.vfx.kill()},n.createRandomFrame=function(){var e=this.scene.add.image(0,0,qT,this.boxerFrame.AVATAR.RANDOM);e.setDefaultWorldSize(),this.add(e),this.randomFrame=e},n.createParticle=function(){var e=new KT(this.scene,qT,this.boxerFrame.EFFECT_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createAvatar=function(){var e=new Dc(this.scene,{key:qT,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.BACKGROUND,width:67,height:208/3});this.add(e),this.avatar=e},n.createPeekabooContainer=function(){var e=new Zu(this.scene,57,57,[]);this.peekabooContainer=e,this.peekabooContainer.setY(-1),this.add(e)},n.createPeekabooMask=function(){var e=this.scene.add.graphics();e.setAlpha(0),e.fillRoundedRect(0,0,this.animatedPhotoHeight,this.animatedPhotoHeight,{tl:12,tr:12,bl:12,br:12}),this.addAt(e,2),this.peekabooMask=e,this.setPeekabooMask()},n.setPeekabooMask=function(){this.peekabooContainer.setMask(this.peekabooMask.createGeometryMask());var e=this.peekabooContainer.getWorldPosition();this.peekabooMask.setPosition(e.x-this.peekabooContainer.width/2*this.scaleX,e.y-this.peekabooContainer.height/2*this.scaleY)},n.createAvatarBorderCover=function(){var e=this.scene.add.image(0,0,qT,this.boxerFrame.AVATAR.BORDER);e.setDefaultWorldSize(),this.add(e),this.borderCover=e,this.borderCover.kill()},n.createLightBorder=function(){var e=this.scene.add.image(0,0,qT,this.boxerFrame.AVATAR.LIGHT_BORDER);e.setDefaultWorldSize(),this.add(e),this.lightBorder=e,this.lightBorder.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,qT,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e;var t=this.scene.add.image(0,0,qT,this.boxerFrame.CROWN_LIGHT);t.setDefaultWorldSize(),this.add(t),this.lightCrown=t,this.lightCrown.setAlpha(0)},n.createName=function(){var e=new Qp(this.scene,{text:"Player",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?2631810:9504822,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});Phaser.Display.Align.In.BottomCenter(e,this,0,5),this.playerName=e,this.add(e),this.playerName.kill()},t}(Phaser.GameObjects.Container),$T=Ki.Z.BOXING_DUEL,ex=$T.KEY,tx=$T.FRAME,nx=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.container=void 0,n.playerAvatar=void 0,n.opponentAvatar=void 0,n.glow=void 0,n.progressBar=void 0,n.glowTween=void 0,n.sparklesFlyUp=void 0,n.vText=void 0,n.sText=void 0,n.overlayBackground=void 0,n.handleOpponentFound=function(){n.scene.tweens.add({targets:[n.playerAvatar,n.opponentAvatar,n.opponentAvatar.peekabooMask],scale:{from:1,start:1,to:1.2},duration:1e3,ease:Phaser.Math.Easing.Sine.In}),n.scene.tweens.add({targets:[n.playerAvatar,n.opponentAvatar,n.opponentAvatar.peekabooMask],scale:{from:1.2,start:1.2,to:1},delay:1e3,duration:200,ease:Phaser.Math.Easing.Back.Out})},n.scene=t,n.create(),n.setSize(300,n.playerAvatar.height),n.alignItems(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.progressBar.reset()},n.close=function(){var e;this.sparklesFlyUp.stop(),null==(e=this.glowTween)||e.remove(),this.playerAvatar.reset(),this.opponentAvatar.emit("find-opponent-stop")},n.updateInfo=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),n=this.scene.boxingDuel.getPlayer(),i=this.scene.boxingDuel.getOpponent(),this.playerAvatar.updateData(n),this.opponentAvatar.updateData(i),e.next=7,this.scene.boxingDuel.updateOpponentScore();case 7:if(r=this.scene.boxingDuel.getPlayerScore(),s=this.scene.boxingDuel.getOpponentScore(),this.progressBar.updateProgressBar(r,s,t),0!==r||0!==s){e.next=14;break}return this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!1),e.abrupt("return");case 14:0===this.scene.boxingDuel.getPlayerRank()?(this.playerAvatar.showCrown(!0),this.opponentAvatar.showCrown(!1)):(this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!0));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateData=function(e){switch(e){case WT.READY:this.playerAvatar.setLightBorder(!1),this.playerAvatar.playerName.kill(),this.opponentAvatar.playerName.kill(),this.setBoxersReadyPosition(),this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!1);break;case WT.PLAYING:this.runBoxersGotoPlayingPositionAnimation(),this.playerAvatar.playerName.revive(),this.opponentAvatar.playerName.revive(),this.playerAvatar.setLightBorder(!1);break;case WT.WON:this.setBoxersPlayingPosition(),this.playerAvatar.setLightBorder(!0),this.playerAvatar.setWon(),this.opponentAvatar.setLost();break;case WT.LOST:this.setBoxersPlayingPosition(),this.playerAvatar.setLightBorder(!0),this.opponentAvatar.setWon(),this.playerAvatar.setLost()}},n.setBoxersReadyPosition=function(){this.playerAvatar.setPosition(-74,-34),this.opponentAvatar.setPosition(74,-34),this.progressBar.setAlpha(0)},n.runBoxersGotoPlayingPositionAnimation=function(){this.scene.tweens.add({targets:this.playerAvatar,x:-120,y:-63,duration:300,ease:Phaser.Math.Easing.Quadratic.Out}),this.scene.tweens.add({targets:this.opponentAvatar,x:120,y:-63,duration:300,ease:Phaser.Math.Easing.Quadratic.Out}),this.progressBar.setPosition(0,-46),this.scene.tweens.add({targets:this.progressBar,alpha:1,delay:100,duration:300,ease:Phaser.Math.Easing.Sine.Out})},n.setBoxersPlayingPosition=function(){this.playerAvatar.setPosition(-120,-63),this.opponentAvatar.setPosition(120,-63),this.progressBar.setPosition(0,-46),this.progressBar.setAlpha(1)},n.findOpponent=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),!t){e.next=6;break}return e.next=4,this.runFindingOpponentAnimation();case 4:e.next=14;break;case 6:return e.next=8,this.scene.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,d,p,f,m,g,v,y,E;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=window.game,i=n.player,r=n.facebook,(s=n.globalScene).screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),o=i.getConnectedPlayerIds(100,0),c="",h="",u=r.contextType,o.length>=1&&(d=Phaser.Math.RND.between(0,o.length-1),c=o[d]),!c||"string"!==typeof c){e.next=12;break}return e.next=11,r.createAsync(c);case 11:h=e.sent;case 12:if(!1!==h&&""!==h){e.next=16;break}return e.next=15,t(Ai(void 0,void 0,!1));case 15:return e.abrupt("return");case 16:return p=i.getPlayerId(),e.next=19,r.getContextPlayers(p);case 19:return f=e.sent,m=ce,""===c?1===f.length&&(m=f[0]||ce):m=1===f.length?f[0]||ce:i.getConnectedPlayers()[c]||ce,t(oi()),v=(g=m).name,y=g.photo,E={playerId:c,name:v,photo:y},e.next=27,s.boxingDuel.startNewMatch(E,h);case 27:return gi({contextId:h}),t(Ft(h,u)),e.abrupt("return",!0);case 32:if(e.prev=32,e.t0=e.catch(0),!(e.t0 instanceof ue)){e.next=37;break}return t(Ci()),e.abrupt("return");case 37:(0,l.tO)(e.t0);case 38:return e.prev=38,yi(1e3),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,32,38,41]])})));return function(t){return e.apply(this,arguments)}}());case 8:n=this.scene.boxingDuel.getOpponent(),r=this.scene.boxingDuel.isHappening(),s=this.scene.boxingDuel.isDuelWithFriend(),o=this.scene.boxingDuel.getContextID(),c=GameCore.Configs.BoxingDuel.JustBot,n&&r&&s&&o&&!c&&this.scene.storage.dispatch(Ai(o,n.playerId,!1));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runFindingOpponentAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.opponentAvatar.on("opponent-found",this.handleOpponentFound,this),e.next=3,this.opponentAvatar.runFindingOpponentAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showVS=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVSAnimation(0);case 2:return e.next=4,this.hideVSAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleFindOpponentStarted=function(){this.runScaleBoxersAnimation(2e3)},n.handleFindOpponentStop=function(){this.opponentAvatar.stopFindingOpponentAnimation(),this.scene.tweens.killTweensOf([this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask]),this.playerAvatar.setScale(1),this.opponentAvatar.setScale(1)},n.runScaleBoxersAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),(n=this.scene.tweens.createTimeline()).add({targets:[this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask],scale:{from:1,to:1.2},delay:t,duration:1e3,ease:Phaser.Math.Easing.Sine.In}),n.add({targets:[this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask],scale:{from:1.2,to:1},duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[7]}),n.play();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideVSAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:[this.vText,this.sText,this.glow],alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.sparklesFlyUp.stop(),t.vText.kill(),t.sText.kill(),t.glow.kill()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showVSAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r=this.runGlowAnimation(),s=this.runVTextTimeline(),o=this.runSTextTimeline(),n.push(r,s,o),e.next=7,(0,gl.Z)(this.scene,t).then((0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.playAndWaitForCompletion()})));case 2:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runGlowAnimation=function(){var e=this,t=1/GameCore.ImageScale,n=this.scene.tweens.createTimeline();return n.add({targets:[this.glow],alpha:{from:0,start:0,to:1,duration:100},onStart:function(){e.glow.revive(),e.sparklesFlyUp.run(1,1e3,0,-15,40,40),e.glow.setScale(3*t),e.runFadeOverlayBackgroundAnimation(0,.4,200)}}),n.add({targets:[this.glow],scale:{from:3*t,start:3*t,to:2*t},delay:750,duration:400,ease:Phaser.Math.Easing.Back.In,easeParams:[4],onStart:function(){(0,gl.Z)(e.scene,550).then((function(){e.runFadeOverlayBackgroundAnimation(.4,0,200)}))}}),n},n.runFadeOverlayBackgroundAnimation=function(e,t,n){this.scene.tweens.add({targets:[this.overlayBackground],alpha:{from:e,to:t},duration:n,ease:Phaser.Math.Easing.Sine.Out})},n.runVTextTimeline=function(){var e=this,t=this.scene.tweens.createTimeline();return t.add({targets:[this.vText],alpha:{from:0,start:0,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},scale:{from:1.5,start:1.5,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},x:{from:-30,start:-30,to:-9,duration:100,ease:Phaser.Math.Easing.Back.Out},delay:100,onStart:function(){e.vText.revive(),e.vText.setAlpha(0)}}),t.add({targets:[this.vText],scale:{from:1,start:1,to:1.2,delay:50,duration:100,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0}}),t},n.runSTextTimeline=function(){var e=this,t=this.scene.tweens.createTimeline();return t.add({targets:[this.sText],alpha:{from:0,start:0,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},scale:{from:1.5,start:1.5,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},x:{from:30,start:30,to:9,duration:100,ease:Phaser.Math.Easing.Back.Out},delay:100,onStart:function(){e.sText.revive(),e.sText.setAlpha(0)}}),t.add({targets:[this.sText],scale:{from:1,start:1,to:1.2,delay:50,duration:100,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0}}),t},n.alignItems=function(){Phaser.Display.Align.In.Center(this.glow,this,0,-30)},n.create=function(){this.createOverlayBackground(),this.createGlow(),this.createVS(),this.createParticle(),this.createProgressBar(),this.createBoxers()},n.createOverlayBackground=function(){var e=this.scene.add.image(0,0,ex,tx.BLANK),t=this.scene.gameZone,n=t.width,i=t.height;e.setWorldSize(n,i),this.add(e),e.setTint(0),e.setAlpha(0),this.overlayBackground=e},n.createGlow=function(){var e=this.scene.add.image(0,0,ex,tx.EFFECTS.VFX_VS);e.setDefaultWorldSize(),e.setScale(2*e.scale),e.kill(),this.add(e),this.glow=e},n.createParticle=function(){var e=new KT(this.scene,ex,tx.EFFECTS.VS_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createVS=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"V",origin:{x:.5,y:.5}});e.kill();var t=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"S",origin:{x:.5,y:.5}});t.kill(),this.add(e),this.add(t),this.vText=e,this.sText=t,this.vText.setPosition(-9,-34),this.sText.setPosition(9,-34)},n.createBoxers=function(){this.createLeftBoxer(),this.createRightBoxer()},n.createLeftBoxer=function(){var e=new QT(this.scene,!0);this.add(e),this.playerAvatar=e},n.createRightBoxer=function(){var e=new QT(this.scene,!1);this.add(e),this.opponentAvatar=e},n.createProgressBar=function(){var e=new UT(this.scene);this.add(e),e.setAlpha(0),this.progressBar=e},t}(Phaser.GameObjects.Container),ix=nx,rx=Ki.Z.BOXING_DUEL,ax=rx.KEY,sx=rx.FRAME,ox=function(e){function t(t){var n;return(n=e.call(this,t,{key:ax,backgroundFrame:sx.BUTTON.BASE,buttonFrame:sx.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.buttonType=void 0,n.loading=void 0,n.scene=t,n.createText(),n.createLoading(),n.setSize(n.width,n.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runLoadingAnimation=function(){this.setButtonType(px.LOADING)},n.stopLoadingAnimation=function(){this.loading.setVisible(!1)},n.setButtonType=function(e){switch(this.buttonType=e,e){case px.PLAY:this.setText("PLAY"),this.loading.setVisible(!1),this.showText();break;case px.START:this.setText("START"),this.loading.setVisible(!1),this.showText();break;case px.LOADING:this.buttonText.kill(),this.loading.setVisible(!0)}},n.showText=function(){var e=this;this.scene.tweens.add({targets:this.buttonText,alpha:1,duration:200,onStart:function(){e.buttonText.revive(),e.buttonText.setAlpha(0)}})},n.getButtonType=function(){return this.buttonType},n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new Qp(this.scene,{text:"PLAY",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setWorldSize(27,27),this.loading.setY(-1),this.loading.setVisible(!1),this.addIntoButton(this.loading)},t}(aT),cx=ox,hx=function(e){function t(t,n){var i;return(i=e.call(this,t,Ki.Z.DEFAULT.KEY,Ki.Z.DEFAULT.FRAME.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN,n.width||30,n.height||30)||this).payload=void 0,i.text=void 0,i.button.setTintFill(13421772),i.setAlpha(.5),i.createUI(n.text||""),i.onClick=function(){n.callback&&n.callback()},i}return(0,f.Z)(t,e),t.prototype.createUI=function(e){this.text=new Qp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),this.text.setCenterAlign(),this.add(this.text)},t}(Vc.Z),ux=Ki.Z.BOXING_DUEL,lx=ux.KEY,dx=ux.FRAME,px=function(e){return e.PLAY="play",e.START="start",e.LOADING="loading",e}({}),fx=function(e){function t(t,n){var i;return(i=e.call(this,n.scene)||this).scene=void 0,i.screen=void 0,i.boxersStatus=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.playButton=void 0,i.cup=void 0,i.boxers=void 0,i.closeButton=void 0,i.debugButtons=[],i.scene=t,i.screen=n,i.create(),i.alignItems(),i.boxersStatus=WT.READY,i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.closeContainer=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){1!==this.alpha&&this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.debugButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.setAlpha(1),this.setButtonsDisabled(!0),this.updateBoxerStatus(),this.updateBoxers(),this.updateTime(),this.setButtonsDisabled(!1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.boxers.close()},n.updateBoxerStatus=function(){this.scene.boxingDuel.isHappening()?(this.boxersStatus=WT.PLAYING,this.setPlaying()):(this.boxersStatus=WT.READY,this.setReady())},n.setPlaying=function(){var e=this;this.playButton.setButtonType(px.PLAY),this.scene.add.tween({targets:this.timerPanel,alpha:1,delay:100,duration:500,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){e.timerPanel.revive(),e.updateTime()}})},n.setReady=function(){this.playButton.setButtonType(px.START),this.timerPanel.kill(),this.timerPanel.setAlpha(0)},n.updateTime=function(){var e=this.scene.boxingDuel.getRemainingTime();this.timerPanel.timerLogic.setRemainingTime(e)},n.updateBoxers=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boxers.updateData(this.boxersStatus),this.boxers.updateInfo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.findOpponent=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=!1),this.playButton.runLoadingAnimation(),this.boxers.findOpponent(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.handleFindOpponentCompleted=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxers.updateInfo(),e.next=3,this.boxers.showVS();case 3:this.playButton.stopLoadingAnimation(),this.playButton.setButtonType(px.PLAY),this.boxersStatus=WT.PLAYING,this.boxers.updateData(this.boxersStatus),this.setPlaying(),this.setButtonsDisabled(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,-2,24),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopCenter(this.boxers,this,0,-110),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,-1,-100),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-26,-20),Phaser.Display.Align.In.TopRight(this.closeButton,this,-21,-22),Phaser.Display.Align.In.BottomCenter(this.cup,this,.5,-23),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,20)},n.create=function(){this.createBackground(),this.createCup(),this.createHeader(),this.createDescription(),this.createTimePanel(),this.createBoxers(),this.createButtons(),this.createDebug()},n.createBackground=function(){var e=this.scene.add.image(0,0,lx,dx.MAIN.POPUP);e.setWorldSize(1123/3,857/3),this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.createCup=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,lx,dx.MAIN.CUP);t.setDefaultWorldSize(),e.add(t),e.setSize(t.width,t.height);var n=this.scene.add.image(0,0,lx,dx.MAIN.TEXT_REWARD_COIN);n.setDefaultWorldSize(),n.setPosition(0,0),e.add(n),this.cup=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,lx,dx.MAIN.HEADER.MAIN);e.setDefaultWorldSize(),this.header.add(e);var t=new Rf(this.scene);t.setText("Boxing Duel"),t.setFontSize(24.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-8),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=new Qp(this.scene,{text:"Collect more gloves than your\nopponent to win the prize!",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeOffset:{y:0},strokeAlpha:.5});e.setCenterAlign(),this.add(e),this.description=e},n.createBoxers=function(){var e=new ix(this.scene);this.add(e),this.boxers=e},n.createTimePanel=function(){this.timerPanel=new DT(this.scene),this.add(this.timerPanel),this.timerPanel.kill();var e=this.scene.add.image(0,0,lx,dx.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createPlayButton()},n.createInformationButton=function(){var e=new ov.Z(this.scene,{key:lx,frame:dx.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new ov.Z(this.scene,{key:lx,frame:dx.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createPlayButton=function(){var e=new cx(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.createDebug=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=this.scene.add.container(),n=new hx(this.scene,{text:"end\nall\nduel",callback:function(){e.scene.boxingDuel.endCurrentMatch(),e.playButton.setButtonType(px.START)}});Phaser.Display.Align.In.TopCenter(n,this,0,0);var i=new hx(this.scene,{text:"up\nplayer\n30-50",callback:function(){var t=e.scene.boxingDuel.getPlayer().score,n=Math.floor(Phaser.Math.Between(30,50));e.scene.boxingDuel.updatePlayerScore(t+n)}});Phaser.Display.Align.In.TopLeft(i,this,0,0),t.add([n,i]),t.setDepth(Ha.Z.POPUP+1),this.add(t),Phaser.Display.Align.In.Center(t,this),this.debugButtons.push(n,i)}},t}(Phaser.GameObjects.Container),mx=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.boxingDuelMainContainer=void 0,o.previousScreen=void 0,o.isScreenOpening=!1,o.handleFindOpponentCompleted=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(400);case 2:o.boxingDuelMainContainer.handleFindOpponentCompleted();case 3:case"end":return e.stop()}}),e)}))),o.handleInformationButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=o.previousScreen===de.o4.DASHBOARD_SCREEN)&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),e.next=4,o.boxingDuelMainContainer.closeContainer();case 4:return e.next=6,o.scene.screen.openAsync(de.o4.BOXING_DUEL.INTRO_SCREEN);case 6:t&&o.scene.screen.open(de.o4.DASHBOARD_SCREEN),o.scene.screen.bringToTop(de.o4.BOXING_DUEL.MAIN_SCREEN),o.boxingDuelMainContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),o.handleCloseButtonClick=function(){o.scene.screen.close(o.name)},o.handlePlayButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.boxingDuelMainContainer.playButton.getButtonType(),e.t0=t,e.next=e.t0===px.START?4:e.t0===px.PLAY?7:10;break;case 4:return e.next=6,o.handleStartButton();case 6:case 9:case 10:return e.abrupt("break",11);case 7:return e.next=9,o.handlePlayButton();case 11:case"end":return e.stop()}}),e)}))),o.handleStartFindBot=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.boxingDuelMainContainer.findOpponent(!0);case 2:case"end":return e.stop()}}),e)}))),o.close=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.isScreenOpening=!1,o.background.off(Phaser.Input.Events.POINTER_DOWN),o.boxingDuelMainContainer.close(),o.runExitAnimation();case 4:case"end":return e.stop()}}),e)}))),o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.scene.gameUI.coinBarButton.setDisabled(!1),o.previousScreen&&o.scene.screen.open(o.previousScreen)},o.scene=t,o.create(),o.listenEvents(),o.setDepth(de.Ks.POPUP),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.boxingDuelMainContainer.setAlpha(0),o}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createBoxingDuelMainContainer()},n.listenEvents=function(){this.scene.boxingDuel.events.on(Fi,this.handleFindOpponentCompleted),this.scene.boxingDuel.events.on("start-find-bot",this.handleStartFindBot,this);var e=this.boxingDuelMainContainer,t=e.informationButton,n=e.closeButton,i=e.playButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick},n.handleStartButton=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxingDuelMainContainer.setButtonsDisabled(!0),e.next=3,this.boxingDuelMainContainer.findOpponent(GameCore.Configs.BoxingDuel.JustBot);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handlePlayButton=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.boxingDuel.getOpponent()){e.next=7;break}return this.previousScreen="",this.scene.screen.close(de.o4.BOXING_DUEL.MAIN_SCREEN),this.scene.screen.close(de.o4.DASHBOARD_SCREEN),this.scene.gameplay.processStartLevel(),e.abrupt("return");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createBoxingDuelMainContainer=function(){this.boxingDuelMainContainer=new fx(this.scene,this),this.boxingDuelMainContainer.setInteractive(),this.add(this.boxingDuelMainContainer),Phaser.Display.Align.In.Center(this.boxingDuelMainContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.isScreenOpening=!0,i=null!=n?n:{previousScreen:de.o4.DASHBOARD_SCREEN},r=i.previousScreen,this.previousScreen=r,this.runEntranceAnimation(),t.next=7,this.handleFirstTimePlay();case 7:return t.next=9,this.boxingDuelMainContainer.open();case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.boxingDuel.getFirstTimePlay()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.boxingDuel.setFirstTimePlay(!1),e.next=6,(0,me.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.boxingDuelMainContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.previousScreen===de.o4.DASHBOARD_SCREEN&&this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.boxingDuelMainContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),gx=Ki.Z.BOXING_DUEL,vx=gx.KEY,yx=gx.FRAME,Ex=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boxerFrame=void 0,i.crown=void 0,i.playerName=void 0,i.avatar=void 0,i.showCrownAnimation=void 0,i.vfx=void 0,i.scorePanel=void 0,i.scorePanelWin=void 0,i.scoreWinText=void 0,i.scoreLoseText=void 0,i.sparklesFlyUp=void 0,i.scene=t,i.isPlayer=n,i.boxerFrame=i.isPlayer?yx.PLAYER:yx.OPPONENT,i.create(),i.setSize(i.avatar.width,i.avatar.height),i.alignItems(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){if(e){this.avatar.background.kill(),this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.name,i=e.photo;this.updateBoxerName(n),this.updateBoxerPhoto(t,i)}else this.setRandomPlayer()},n.updateBoxerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15),this.playerName.setText(t)},n.updateBoxerPhoto=function(e,t){this.avatar.loadPhoto(e,t,50)},n.setWon=function(){this.setAvatarScale(1.2),this.vfx.revive(),this.scorePanelWin.revive(),this.scoreWinText.revive(),this.scorePanel.kill(),this.scoreLoseText.kill(),this.setPlayerNameFontSize(!0),this.playerName.setY(32),this.showCrown(!0),this.sparklesFlyUp.run(2,500,0,35,90,100)},n.setLost=function(){this.setAvatarScale(1.1),this.vfx.kill(),this.scorePanelWin.kill(),this.scoreWinText.kill(),this.scorePanel.revive(),this.scoreLoseText.revive(),this.setPlayerNameFontSize(!1),this.playerName.setY(30),this.showCrown(!1),this.sparklesFlyUp.stop()},n.updateScore=function(e,t){t?this.scoreWinText.setText(e.toString()):this.scoreLoseText.setText(e.toString())},n.setRandomPlayer=function(){this.avatar.photo.kill(),this.avatar.avtFrame.kill(),this.playerName.setText("...")},n.showCrown=function(e){var t;null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.setPlayerNameFontSize=function(e){var t=this.playerName.text;t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15);var n=e?14:13,i=this.playerName.width>94?.95*this.scene.fontSize(n):this.scene.fontSize(n);this.playerName.setFontSize(i)},n.alignItems=function(){var e=this.isPlayer?-26:26;this.crown.setPosition(e,-36.5),this.scorePanelWin.setY(53),this.scoreWinText.setY(58),this.scorePanel.setY(48),this.scoreLoseText.setY(49)},n.setAvatarScale=function(e){this.avatar.setScale(e)},n.create=function(){this.createVfx(),this.createScorePanel(),this.createAvatar(),this.createCrown(),this.createScorePanelWin(),this.createName(),this.createScore(),this.createParticle()},n.createVfx=function(){var e=this.scene.add.image(0,0,vx,this.boxerFrame.VFX_AVATAR);e.setWorldSize(667/3,623/3),this.add(e),this.vfx=e,this.vfx.kill()},n.createParticle=function(){var e=new KT(this.scene,vx,this.boxerFrame.EFFECT_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createScorePanel=function(){var e=this.scene.add.image(0,0,vx,this.boxerFrame.SCORE_PANEL);e.setDefaultWorldSize(),this.add(e),this.scorePanel=e,this.scorePanel.kill()},n.createAvatar=function(){var e=new Dc(this.scene,{key:vx,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.RANDOM,width:67,height:208/3});this.add(e),this.avatar=e},n.createScorePanelWin=function(){var e=this.scene.add.image(0,0,vx,this.boxerFrame.SCORE_PANEL_WIN);e.setDefaultWorldSize(),this.add(e),this.scorePanelWin=e,this.scorePanelWin.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,vx,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e},n.createName=function(){var e=new Qp(this.scene,{text:"Player",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?2631810:9504822,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});Phaser.Display.Align.In.BottomCenter(e,this,0,5),this.playerName=e,this.add(e)},n.createScore=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(20),text:"999",origin:{x:.5,y:.5}});this.add(e),this.scoreWinText=e;var t=new Qp(this.scene,{text:"249",fontSize:this.scene.fontSize(16),strokeColor:this.isPlayer?3807903:10489385,strokeThickness:2,strokeOffset:{y:.6},strokeAlpha:.9});this.add(t),this.scoreLoseText=t;var n=t.context.createLinearGradient(0,0,0,t.height);this.isPlayer?(n.addColorStop(0,"#ffffff"),n.addColorStop(1,"#af97ff")):(n.addColorStop(0,"#ffffff"),n.addColorStop(1,"#ff7690")),t.setFill(n)},t}(Phaser.GameObjects.Container),Cx=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.playerAvatar=void 0,n.opponentAvatar=void 0,n.scene=t,n.create(),n.setSize(300,n.playerAvatar.height),n.alignAvatars(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.close=function(){this.playerAvatar.sparklesFlyUp.stop(),this.opponentAvatar.sparklesFlyUp.stop()},n.updateData=function(){this.updatePlayer(),this.updateOpponent(),this.updateScores()},n.updatePlayer=function(){var e=this.scene.boxingDuel.getPlayer();this.playerAvatar.updateData(e)},n.updateOpponent=function(){var e=this.scene.boxingDuel.getOpponent();this.opponentAvatar.updateData(e)},n.updateScores=function(){var e,t=this.scene.boxingDuel.getPlayer().score,n=(null==(e=this.scene.boxingDuel.getOpponent())?void 0:e.score)||0;0===this.scene.boxingDuel.getPlayerRank()?(this.playerAvatar.setWon(),this.opponentAvatar.setLost(),this.playerAvatar.updateScore(t,!0),this.opponentAvatar.updateScore(n,!1)):(this.opponentAvatar.setWon(),this.playerAvatar.setLost(),this.playerAvatar.updateScore(t,!1),this.opponentAvatar.updateScore(n,!0))},n.alignAvatars=function(){this.playerAvatar.setX(-60),this.opponentAvatar.setX(60)},n.create=function(){this.createBoxers()},n.createBoxers=function(){this.createLeftBoxer(),this.createRightBoxer()},n.createLeftBoxer=function(){var e=new Ex(this.scene,!0);this.add(e),this.playerAvatar=e},n.createRightBoxer=function(){var e=new Ex(this.scene,!1);this.add(e),this.opponentAvatar=e},t}(Phaser.GameObjects.Container),wx=Cx,Ax=Ki.Z.BOXING_DUEL,bx=Ax.KEY,Sx=Ax.FRAME,Tx=function(e){function t(t,n){var r;(r=e.call(this,t)||this).scene=void 0,r.screen=void 0,r.title=void 0,r.flags=void 0,r.illustrators=void 0,r.tapToClaim=void 0,r.illustratorLeft=void 0,r.illustratorRight=void 0,r.flagLeft=void 0,r.flagRight=void 0,r.boxers=void 0,r.close=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.off(Phaser.Input.Events.POINTER_DOWN),r.screen.handleCloseBoxingDuelOver();case 2:case"end":return e.stop()}}),e)}))),r.scene=t,r.screen=n;var s=r.scene.gameZone,o=s.width,c=s.height;return r.setSize(o,c),r.create(),r.alignItems(),t.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateBoxers(),e.next=3,this.runEntranceAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setAlpha(1),this.revive(),this.runTitleAndClaimTextEntranceAnimation(),this.runIllustratorsEntranceAnimation(),e.next=6,this.runBoxersEntranceAnimation();case 6:this.on(Phaser.Input.Events.POINTER_DOWN,this.close);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,alpha:0,duration:300,onStart:function(){t.boxers.close()},onComplete:function(){t.kill()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleAndClaimTextEntranceAnimation=function(){this.scene.tweens.add({targets:[this.title,this.tapToClaim],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runBoxersEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.boxers,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},scaleX:{from:.7,start:.7,to:1,ease:Phaser.Math.Easing.Back.Out}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxers=function(){this.boxers.updateData()},n.alignItems=function(){this.flagLeft.setPosition(-this.width/2+this.flagLeft.width/2,0),this.flagRight.setPosition(this.width/2-this.flagRight.width/2,0),this.flags.setPosition(0,-this.height/2+this.flags.height/2),this.illustratorLeft.setPosition(-this.width/2+this.illustratorLeft.width/2,0),this.illustratorRight.setPosition(this.width/2-this.illustratorRight.width/2,0),this.illustrators.setPosition(0,this.height/2-this.illustrators.height/2),Phaser.Display.Align.In.TopCenter(this.title,this,0,-70),Phaser.Display.Align.In.BottomCenter(this.tapToClaim,this,0,-10)},n.create=function(){this.createTitle(),this.createFlags(),this.createIllustrators(),this.createTapToClaim(),this.createBoxers()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(33),text:"The Duel is over!",origin:{x:.5,y:.5}});e.setLetterSpacing(-2),this.add(e),this.title=e},n.createFlags=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,bx,Sx.REWARD.FLAGS);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,bx,Sx.REWARD.FLAGS);n.setDefaultWorldSize(),n.setScale(-n.scaleX,n.scaleY),e.add(n),e.setSize(this.width,t.displayHeight),this.flags=e,this.flagLeft=t,this.flagRight=n},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,bx,Sx.REWARD.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,bx,Sx.REWARD.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),this.illustrators=e,this.illustratorLeft=t,this.illustratorRight=n},n.createTapToClaim=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(16),text:"Tap to claim",origin:{x:.5,y:.5}});e.setAlpha(.7),this.add(e),this.tapToClaim=e},n.createBoxers=function(){var e=new wx(this.scene);this.add(e),this.boxers=e},t}(Phaser.GameObjects.Container),xx=Tx,kx=Ki.Z.BOXING_DUEL,Px=kx.KEY,Ix=kx.FRAME,Ox=function(e){function t(t,n){var i;return(i=e.call(this,n.scene)||this).scene=void 0,i.screen=void 0,i.boxersStatus=void 0,i.header=void 0,i.vfxHeader=void 0,i.victoryHeader=void 0,i.defeatHeader=void 0,i.title=void 0,i.description=void 0,i.cup=void 0,i.prizeText=void 0,i.boxers=void 0,i.arrow=void 0,i.arrowAnimation=void 0,i.informationButton=void 0,i.closeButton=void 0,i.claimButton=void 0,i.retryButton=void 0,i.scene=t,i.screen=n,i.create(),i.alignItems(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.boxers.reset()},n.closeContainer=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxers.close(),null==(t=this.arrowAnimation)||t.stop(),e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.revive(),this.openContainer(),this.setButtonsDisabled(!0),this.updateBoxersStatus(),this.updateBoxers(),this.setButtonsDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxersStatus=function(){0===this.scene.boxingDuel.getPlayerRank()?(this.boxersStatus=WT.WON,this.setWin()):(this.boxersStatus=WT.LOST,this.setLose())},n.setWin=function(){this.victoryHeader.revive(),this.defeatHeader.kill(),this.claimButton.revive(),this.retryButton.kill(),this.title.setText("Victory!"),this.description.setText("Claim your prize!"),this.cup.revive(),this.arrow.kill(),this.vfxHeader.revive()},n.setLose=function(){this.victoryHeader.kill(),this.defeatHeader.revive(),this.claimButton.kill(),this.retryButton.revive(),this.title.setText("Defeat"),this.description.setText("Try again to win the prize!"),this.cup.kill(),this.arrow.revive(),this.vfxHeader.kill(),this.runArrowAnimation()},n.updateBoxers=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boxers.updateInfo(!0),this.boxers.updateData(this.boxersStatus);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runArrowAnimation=function(){var e;null==(e=this.arrowAnimation)||e.remove(),this.arrowAnimation=this.scene.tweens.add({targets:this.arrow,y:this.arrow.y+10,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut})},n.setButtonsDisabled=function(e){this.claimButton.setDisabled(e),this.retryButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.claimButton.setAlpha(1),this.retryButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,-2,18),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopCenter(this.boxers,this,0,-110),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-26,-20),Phaser.Display.Align.In.TopRight(this.closeButton,this,-21,-22),Phaser.Display.Align.In.BottomCenter(this.cup,this,.5,-23),Phaser.Display.Align.In.BottomCenter(this.claimButton,this,0,16),Phaser.Display.Align.In.BottomCenter(this.retryButton,this,0,16),Phaser.Display.Align.In.BottomCenter(this.arrow,this,0,-40)},n.create=function(){this.createBackground(),this.createCup(),this.createHeader(),this.createDescription(),this.createBoxers(),this.createButtons(),this.createArrow()},n.createBackground=function(){var e=this.scene.add.image(0,0,Px,Ix.MAIN.POPUP);e.setWorldSize(1123/3,857/3),this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.createCup=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,Px,Ix.MAIN.CUP);t.setDefaultWorldSize(),e.add(t),e.setSize(t.width,t.height);var n=this.scene.add.image(0,0,Px,Ix.MAIN.TEXT_REWARD_COIN);n.setDefaultWorldSize(),n.setPosition(0,0),e.add(n),this.cup=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,Px,Ix.EFFECTS.VFX_HEADER);e.setDefaultWorldSize(),this.header.add(e),e.setPosition(0,-2);var t=this.scene.add.image(0,0,Px,Ix.MAIN.HEADER.VICTORY);t.setDefaultWorldSize(),this.header.add(t);var n=this.scene.add.image(0,0,Px,Ix.MAIN.HEADER.DEFEAT);n.setDefaultWorldSize(),this.header.add(n),n.kill(),this.vfxHeader=e,this.victoryHeader=t,this.defeatHeader=n;var i=new Rf(this.scene);i.setText("Victory!"),i.setFontSize(25),i.setRadius(-800),i.setLetterSpacing(0),i.setPosition(0,-9),this.header.add(i),this.title=i,this.header.setSize(t.width,t.height)},n.createDescription=function(){var e=new Qp(this.scene,{text:"Collect more gloves than your\nopponent to win the prize!",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeOffset:{y:0},strokeAlpha:.5});e.setCenterAlign(),this.add(e),this.description=e},n.createBoxers=function(){var e=new ix(this.scene);this.add(e),this.boxers=e},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createClaimButton(),this.createRetryButton()},n.createInformationButton=function(){var e=new ov.Z(this.scene,{key:Px,frame:Ix.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new ov.Z(this.scene,{key:Px,frame:Ix.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createClaimButton=function(){var e=new cx(this.scene);e.setText("CLAIM"),e.button.setName("Claim"),this.add(e),this.claimButton=e},n.createRetryButton=function(){var e=new cx(this.scene);e.setText("RETRY"),e.button.setName("Retry"),this.add(e),this.retryButton=e},n.createArrow=function(){var e=this.scene.add.image(0,0,Px,Ix.MAIN.ARROW);e.setDefaultWorldSize(),this.add(e),this.arrow=e},t}(Phaser.GameObjects.Container),Rx=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.boxingDuelOverContainer=void 0,o.boxingDuelRewardContainer=void 0,o.amount=void 0,o.previousScreen=void 0,o.handleInformationButtonClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.boxingDuelRewardContainer.closeContainer();case 2:return e.next=4,o.scene.screen.openAsync(de.o4.BOXING_DUEL.INTRO_SCREEN);case 4:o.scene.screen.bringToTop(de.o4.BOXING_DUEL.MAIN_SCREEN),o.boxingDuelRewardContainer.openContainer();case 6:case"end":return e.stop()}}),e)}))),o.handleCloseButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.boxingDuelRewardContainer.boxersStatus,e.t0=t,e.next=e.t0===WT.WON?4:e.t0===WT.LOST?7:10;break;case 4:return e.next=6,o.handlePlayButtonWonClick();case 6:case 9:case 10:return e.abrupt("break",11);case 7:return e.next=9,o.handlePlayButtonLostClick();case 11:case"end":return e.stop()}}),e)}))),o.handlePlayButtonWonClick=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.getWorldPosition(),n=t.x,i=t.y,(r=o.scene.rewardManager).rewardCoin(o.amount),o.scene.logEconomy.logGetItem(yl.COIN,o.amount,Cl.BOXING_DUEL),o.boxingDuelRewardContainer.closeContainer(),o.scene.screen.bringToTop(de.o4.BOXING_DUEL.REWARD_SCREEN),e.next=8,(0,me.qZ)(100);case 8:return e.next=10,r.coinAnimationPool.runAnimationRewardCoinAsync(15,n,i);case 10:return e.next=12,o.scene.boxingDuel.endCurrentMatch();case 12:o.scene.screen.close(de.o4.BOXING_DUEL.REWARD_SCREEN),(0,gl.Z)(o.scene,100).then((function(){o.boxingDuelRewardContainer.reset()}));case 14:case"end":return e.stop()}}),e)}))),o.handlePlayButtonLostClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.scene.boxingDuel.endCurrentMatch();case 2:o.scene.screen.close(de.o4.BOXING_DUEL.REWARD_SCREEN),(0,gl.Z)(o.scene,100).then((function(){o.boxingDuelRewardContainer.reset()}));case 4:case"end":return e.stop()}}),e)}))),o.close=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.background.off(Phaser.Input.Events.POINTER_DOWN),e.next=3,o.boxingDuelRewardContainer.closeContainer();case 3:o.runExitAnimation();case 4:case"end":return e.stop()}}),e)}))),o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.scene.gameUI.coinBarButton.setDisabled(!1),o.previousScreen&&o.scene.screen.open(o.previousScreen)},o.scene=t,o.amount=GameCore.Configs.BoxingDuel.RewardCoin,o.create(),o.listenEvents(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.boxingDuelRewardContainer.kill(),o.boxingDuelOverContainer.kill(),o}(0,f.Z)(t,e);var n=t.prototype;return n.handleCloseBoxingDuelOver=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.boxingDuelOverContainer.runExitAnimation();case 2:this.boxingDuelRewardContainer.open();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){var e=this.boxingDuelRewardContainer,t=e.informationButton,n=e.closeButton,i=e.claimButton,r=e.retryButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonWonClick,r.onClick=this.handlePlayButtonLostClick},n.create=function(){this.createDuelOverContainer(),this.createBoxingDuelRewardContainer()},n.createDuelOverContainer=function(){this.boxingDuelOverContainer=new xx(this.scene,this),this.boxingDuelOverContainer.setInteractive(),this.add(this.boxingDuelOverContainer)},n.createBoxingDuelRewardContainer=function(){this.boxingDuelRewardContainer=new Ox(this.scene,this),this.boxingDuelRewardContainer.setInteractive(),this.add(this.boxingDuelRewardContainer)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.prototype.open.call(this,n),i=null!=n?n:{previousScreen:de.o4.DASHBOARD_SCREEN},r=i.previousScreen,this.previousScreen=r,this.runEntranceAnimation(),!this.scene.boxingDuel.isFinished()){t.next=7;break}return t.next=7,this.boxingDuelOverContainer.open();case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),Bx=Ki.Z.BOXING_DUEL,Dx=Bx.KEY,Lx=Bx.FRAME,Mx=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).scene=void 0,i.isPlayer=void 0,i.avatar=void 0,i.scoreText=void 0,i.playerName=void 0,i.crown=void 0,i.scene=t,i.isPlayer=n,i.create(),i.alignItems(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){this.avatar.updateData(e),this.playerName.setText(this.avatar.playerName.text)},n.updateScore=function(e){this.scoreText.setText(e.toString())},n.showCrown=function(e){this.crown.setVisible(e)},n.alignItems=function(){var e=this.isPlayer?-92:92;this.avatar.setPosition(e,0);var t=this.isPlayer?25.5:-9;this.scoreText.setPosition(t,7.5);var n=this.isPlayer?25.5:-9;this.playerName.setPosition(n,-11);var i=this.isPlayer?-120:120;this.crown.setPosition(i,-38)},n.create=function(){this.createFrame(),this.createAvatar(),this.createCrown(),this.createPlayerName(),this.createScoreText()},n.createFrame=function(){var e=this.scene.add.image(0,0,Dx,this.isPlayer?Lx.VERSUS.FRAME.BLUE:Lx.VERSUS.FRAME.RED);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createAvatar=function(){var e=new QT(this.scene,this.isPlayer);this.add(e),e.playerName.kill(),e.avatar.setScale(249/201),e.showCrown(!1),this.avatar=e},n.createCrown=function(){var e=this.isPlayer?Lx.PLAYER.CROWN:Lx.OPPONENT.CROWN,t=this.scene.add.image(0,0,Dx,e);t.setDefaultWorldSize(),this.add(t),this.crown=t},n.createPlayerName=function(){var e=new Qp(this.scene,{text:"Lilly",fontSize:this.scene.fontSize(14.3),fillColor:this.isPlayer?812793:16195908,strokeColor:16777215,strokeThickness:.1,strokeOffset:{y:.3},strokeAlpha:.5,letterSpacingExtra:.05});e.setCenterAlign(),this.add(e),this.playerName=e},n.createScoreText=function(){var e=new Qp(this.scene,{text:"12",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?5069721:9583440,strokeThickness:1.5,strokeOffset:{y:0},strokeAlpha:.9});e.setCenterAlign(),this.add(e),this.scoreText=e},t}(Phaser.GameObjects.Container),_x=Ki.Z.BOXING_DUEL,Nx=_x.KEY,Gx=_x.FRAME,Fx=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.player=void 0,n.opponent=void 0,n.playerEntranceX=void 0,n.opponentEntranceX=void 0,n.glow=void 0,n.vs=void 0,n.sparklesFlyUp=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.create(),n.reset(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateData();case 2:return e.next=4,(0,me.qZ)(100);case 4:return e.next=6,this.runEntranceAnimation();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.boxingDuel,n=t.getPlayer(),i=t.getOpponent(),this.player.updateData(n),this.opponent.updateData(i),r=n.score,s=(null==i?void 0:i.score)||0,this.player.updateScore(r),this.opponent.updateScore(s),this.player.showCrown(!1),this.opponent.showCrown(!1),r>s?this.player.showCrown(!0):r<s&&this.opponent.showCrown(!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sparklesFlyUp.run(2,500,0,0,40,40),this.playerEntranceX=-30,this.opponentEntranceX=30,t=this.runPlayerAnimation(),n=this.runOpponentAnimation(),i=this.runVersusAnimation(),e.next=8,Promise.all([t,n,i]);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runPlayerAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.scene.tweens.createTimeline()).add({targets:this.player,x:{from:-this.scene.gameZone.width-this.player.width/2,to:this.playerEntranceX},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.player,x:{from:this.playerEntranceX,to:this.scene.gameZone.width+this.player.width/2},duration:500,delay:500,ease:Phaser.Math.Easing.Back.In,easeParams:[.5]}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runOpponentAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.scene.tweens.createTimeline()).add({targets:this.opponent,x:{from:this.scene.gameZone.width+this.opponent.width/2,to:this.opponentEntranceX},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.opponent,x:{from:this.opponentEntranceX,to:-this.scene.gameZone.width-this.opponent.width/2},duration:500,delay:500,ease:Phaser.Math.Easing.Back.In,easeParams:[.5]}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runVersusAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runGlowAnimation(),this.runVsTextAnimation(),this.runSparklesAnimation(),e.abrupt("return",this.scene.tweens.add({targets:[this.glow,this.vs,this.sparklesFlyUp],alpha:{from:0,start:0,to:1,hold:500},yoyo:!0,duration:500,ease:Phaser.Math.Easing.Circular.Out,onComplete:function(){t.sparklesFlyUp.stop()}}).waitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowAnimation=function(){var e=this,t=1/GameCore.ImageScale;this.scene.tweens.add({targets:[this.glow],scale:{from:0,start:0,to:2.5*t,hold:500},angle:{from:0,start:0,to:20,hold:500,yoyo:!0},yoyo:!0,duration:500,ease:Phaser.Math.Easing.Back.Out,onStart:function(){e.glow.revive()},onComplete:function(){e.glow.kill()}})},n.runVsTextAnimation=function(){var e=1/GameCore.ImageScale,t=this.scene.tweens.createTimeline();t.add({targets:this.vs,scale:{from:0,start:0,to:e},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.vs,scale:{from:e,start:e,to:2*e},duration:500,delay:500,ease:Phaser.Math.Easing.Circular.In,easeParams:[.5]}),t.play()},n.runSparklesAnimation=function(){var e=this.scene.tweens.createTimeline();e.add({targets:this.sparklesFlyUp,scale:{from:.7,start:.7,to:1},duration:1e3,delay:500,ease:Phaser.Math.Easing.Circular.In,easeParams:[.5]}),e.play()},n.reset=function(){this.player.setX(-this.scene.gameZone.width-this.player.width/2),this.opponent.setX(this.scene.gameZone.width+this.opponent.width/2),this.glow.setAlpha(0),this.vs.setAlpha(0)},n.create=function(){this.createVersusGlow(),this.createVersus(),this.createPlayerVersus(),this.createOpponentVersus(),this.createSparklesFlyUp()},n.createSparklesFlyUp=function(){this.sparklesFlyUp=new KT(this.scene,Nx,Gx.EFFECTS.VS_LIGHT),this.add(this.sparklesFlyUp)},n.createVersusGlow=function(){var e=this.scene.add.image(0,0,Nx,Gx.EFFECTS.VFX_VS);e.setDefaultWorldSize(),e.setScale(2*e.scale),e.kill(),this.add(e),this.glow=e},n.createVersus=function(){var e=this.scene.add.image(0,0,Nx,Gx.MAIN.VS);e.setDefaultWorldSize(),this.add(e),this.vs=e},n.createPlayerVersus=function(){var e=new Mx(this.scene,!0);this.add(e),this.player=e,e.setPosition(-40,-62)},n.createOpponentVersus=function(){var e=new Mx(this.scene,!1);this.add(e),this.opponent=e,e.setPosition(51,62)},t}(Phaser.GameObjects.Container),Zx=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).scene=void 0,a.mainContainer=void 0,a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.mainContainer=new Fx(a.scene),a.add(a.mainContainer),a.setDepth(de.Ks.POPUP),a.setAlpha(0),Ap.Z.registerObject(a.background,de.MR.MULTIPLY_ALPHA),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.mainContainer.open();case 4:this.close();case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),Ux=function(){function e(e){this.scene=void 0,this.journeyScreenData=void 0,this.groupedJourneyScreenData=void 0,this.maxSizePerGroup=void 0,this.scene=e,this.maxSizePerGroup=GameCore.layoutInitializer.isLandscape?3:4,this.updateData()}var t=e.prototype;return t.updateData=function(){this.journeyScreenData=this.getNewJourneyScreenData(),this.groupedJourneyScreenData=this.transformJourneyScreenData(this.journeyScreenData)},t.getNewJourneyScreenData=function(){var e=this,t=this.scene.journey.getAllStages(),n=this.scene.journey.getCurrentStage(),i=t.findIndex((function(e){return e.worldNumber===n.worldNumber})),r=this.scene.player.getJourneyProgress(),a=r.finishedLocationIds,s=r.inProgressLocation;return{blockPayloads:t.map((function(t,i){if(a.length>0&&a.includes(t.worldNumber.toString()))return e.getCompletedMapBlockPayload(t);if(n.worldNumber===t.worldNumber){if(s){var r=s.progress;return e.getPlayingMapBlockPayload(t,r)}return e.getPlayingMapBlockPayload(t,0)}return e.getLockedMapBlockPayload(t)})),currentStageIndex:i}},t.getLockedMapBlockPayload=function(e){var t=this.getBaseMapBlockPayload(e);return(0,p.Z)({},t)},t.getCompletedMapBlockPayload=function(e){var t=this.getBaseMapBlockPayload(e);return(0,p.Z)({},t,{progressBar:{lock:!1,currentProgress:15,maxProgress:15}})},t.getPlayingMapBlockPayload=function(e,t){var n=this.getBaseMapBlockPayload(e);return(0,p.Z)({},n,{progressBar:{lock:!1,currentProgress:t,maxProgress:15}})},t.getBaseMapBlockPayload=function(e){var t=e.worldNumber,n=e.name,i=e.backgroundKey,r=e.backgroundFile;return{worldNumber:t,name:n,thumbnail:{key:this.getThumbnailKey(i),url:this.getThumbnailFile(r)},progressBar:{lock:!0,currentProgress:0,maxProgress:15}}},t.getThumbnailKey=function(e){return"thumbnail"+e},t.getThumbnailFile=function(e){return e.replace("/2x/","/2x/previews/").replace(".jpg",".png")},t.transformJourneyScreenData=function(e){var t=this.chunkArray(e.blockPayloads,this.maxSizePerGroup),n=e.currentStageIndex,i=this.getGroupedElementByFlatIndex(t,n)||0;return(0,p.Z)({},e,{blockPayloads:t,currentGroupIndex:i.groupIndex,currentStageIndex:i.elementIndex})},t.chunkArray=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},t.getGroupedElementByFlatIndex=function(e,t){var n=Math.floor(t/this.maxSizePerGroup),i=t%this.maxSizePerGroup;if(n<0||n>=e.length)return{groupIndex:0,elementIndex:0};var r=e[n];return i<0||i>=r.length?{groupIndex:0,elementIndex:0}:{groupIndex:n,elementIndex:i}},t.getTotalMaps=function(){return this.journeyScreenData.blockPayloads.length},t.getTotalPages=function(){return this.groupedJourneyScreenData.blockPayloads.length},t.getGroupedJourneyScreenData=function(){return this.groupedJourneyScreenData},t.getMaxSizePerGroup=function(){return this.maxSizePerGroup},e}(),Wx=Ki.Z.DASHBOARD,Yx=Wx.KEY,Hx=Wx.FRAME,zx=function(e){function t(t){var n;return(n=e.call(this,t)||this).minProgressWidth=void 0,n.maxProgressWidth=void 0,n.progressHeight=void 0,n.progress=void 0,n.progressText=void 0,n.timerText=void 0,n.kill(),n.setSize(144,37),n.minProgressWidth=20,n.maxProgressWidth=332/3,n.progressHeight=20,n.createBackground(),n.createProgress(),n.createCoinIcons(),n.createText(),n.createTimer(),n.updateProgress(40),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateProgress=function(e){e>100&&(e=100);var t=Math.floor(e/100*this.maxProgressWidth),n=Phaser.Math.Clamp(t,this.minProgressWidth,this.maxProgressWidth);this.progress.setSizeByWorld(n,this.progressHeight)},n.createBackground=function(){var e=this.scene.add.image(0,0,Yx,Hx.PROGRESS.TRACK);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},n.createProgress=function(){var e=this.scene.make.nineslice({key:Yx,frame:Hx.PROGRESS.FILL,width:418/3,height:62/3,leftWidth:10,rightWidth:10});e.setOrigin(0,.5),this.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-2,-6),this.progress=e},n.createCoinIcons=function(){var e=this.scene.add.image(0,0,Yx,Hx.ICON.COIN);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,Yx,Hx.ICON.COIN);t.setDefaultWorldSize(),this.add([e,t]),Phaser.Display.Align.In.LeftCenter(e,this,14,-6),Phaser.Display.Align.In.RightCenter(t,this,14,-6)},n.createText=function(){var e=new pv(this.scene);e.setText("20 / 50"),e.setFontSize(15),e.setColor(16777215),e.stroke.kill(),e.shadow.kill(),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-6),this.progressText=e},n.createTimer=function(){var e=new pv(this.scene);e.setText("22h 12m"),e.setFontSize(10),e.setColor(16777215),e.stroke.setTint(0),e.stroke.setY(.5),e.shadow.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,0),this.timerText=e},t}(Phaser.GameObjects.Container),Kx=zx,Vx=function(e,t){this.scene=void 0,this.manager=void 0,this.scene=e},Xx=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).canShowLocationUpgradeGuide=void 0,i.canShowLocationUpgradeGuide=!0,i}(0,f.Z)(t,e);var n=t.prototype;return n.play=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canShowLocationUpgradeGuide){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.showLocationButtonGuide();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.canPlay=function(){var e=this.scene.locationManager.getUnlockableSlots();return this.scene.level.getLevel()>=4&&e.length>0&&!this.scene.locationManager.hasBuiltDecoration()},n.stop=function(){this.scene.screen.get(de.o4.DASHBOARD_SCREEN).guideContainer.hideGuide()},n.showLocationButtonGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.screen.get(de.o4.DASHBOARD_SCREEN),n=t.locationButton,r=t.blackBackground,s=t.guideContainer,t.bringToTop(r),t.bringToTop(n),t.bringToTop(s),t.runFadeBackground(0,1,250,0),o=n.x,c=n.y,s.showArrowAnimation(o,c-65),e.next=10,s.showGuide({x:o,y:c,showHighlight:!1,textBox:{textX:o,textY:c-120,text:"Tap here to start \n building your Journey!",textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}});case 10:this.scene.events.once(pi.LOCATION_DECORATION_OPEN,(function(){s.hideGuide(),s.hideArrowAnimation(),t.runFadeBackground(1,0,250,0),h.scene.gameUI.setDisableButtons(!0)})),this.scene.events.once(pi.OPENED_LOCATION_DECORATION,(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.scene.locationManager.setButtonDisabled(!0),h.showLocationUpgradeGuide();case 2:case"end":return e.stop()}}),e)}))));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLocationUpgradeGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(de.o4.DASHBOARD_SCREEN),n=t.guideContainer,i=this.scene,r=i.locationManager,s=i.gameUI,o=r.getGuidedSlot()){e.next=6;break}return e.abrupt("return");case 6:if(r.isGuided=!0,r.highlightDecorationSlots(),c=!r.hasBuiltDecoration(),t.bringToTop(n),!c){e.next=15;break}return r.runFadeBackground(0,1,250,0),s.runFadeCoinBar(.6,250),e.next=15,n.showGuide({x:0,y:0,showHighlight:!1,textBox:{textX:0,textY:-110,text:"Use the stars you collect \n to build your Journey!",textAlignType:cu.CENTER,useBackground:!0,font:Rc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}});case 15:r.setButtonDisabled(!1),h=o.x,u=o.y,n.showHandAnimation(h+15,u+10),this.scene.journey.events.once(pi.DECORATION_UPGRADE,(function(){n.hideGuide(),c&&(r.runFadeBackground(1,0,250,0),s.setDisableButtons(!1),s.runFadeCoinBar(1,250))})),this.scene.journey.events.once(pi.DECORATION_UPGRADED,(function(){l.canShowLocationUpgradeGuide&&l.showLocationUpgradeGuide()})),this.scene.events.once(pi.CANNOT_UPGRADE_DECORATION,(function(){var e=l.scene.screen.get(de.o4.DASHBOARD_SCREEN),t=r.blackBackground;r.bringToTop(t),l.canShowLocationUpgradeGuide=!1,e.guideContainer.hideGuide(),r.runFadeBackground(void 0,0,250,0),l.scene.gameUI.setDisableButtons(!1)}));case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Vx),jx=Xx,qx=function(){function e(e){this.scene=void 0,this.locationDecorationGuide=void 0,this.scene=e,this.locationDecorationGuide=new jx(this.scene,this)}var t=e.prototype;return t.canPlayLocationDecorationGuide=function(){return this.locationDecorationGuide.canPlay()},t.playLocationDecorationGuide=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationDecorationGuide.play();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Jx=qx,Qx=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e}({}),$x=function(e){return e[e.LOCATION_BUTTON=0]="LOCATION_BUTTON",e}({}),ek=Ki.Z.GAMEPLAY_DEFAULT,tk=ek.KEY,nk=ek.FRAME,ik=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.arrow=void 0,n.highLightCircle=void 0,n.tutorialHand=void 0,n.guideContainer=void 0,n.zone=void 0,n.arrowAnimation=void 0,n.guideAnimation=void 0,n.showHighLightTween=void 0,n.guideManager=void 0,n.updateComponent=function(e,t){n.tutorialHand.update(t)},n.stop=function(){var e,t;n.arrow.kill(),null==(e=n.arrowAnimation)||e.stop(),n.hideHandAnimation(),n.guideContainer.kill(),null==(t=n.showHighLightTween)||t.remove(),n.highLightCircle.kill(),n.highLightCircle.setAlpha(0)},n.scene=t,n.createArrow(),n.createHighLightCircle(),n.createTextBoxContainer(),n.createTutorialHand(),n.createGuideZone(),n.listenEvents(),n.guideManager=new Jx(t),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateComponent),this.scene.events.on(pi.HIDE_GUIDE,this.hideGuide,this)},n.playGuide=function(e){if(e===$x.LOCATION_BUTTON)this.guideManager.playLocationDecorationGuide()},n.showArrowAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&n&&this.arrow.setPosition(t,n),this.arrow.revive(),null==(i=this.arrowAnimation)||i.stop(),r=this.scene.tweens.createTimeline(),this.arrow.scaleX=1/GameCore.ImageScale+.02,this.arrow.scaleY=1/GameCore.ImageScale-.01,s=350,7,this.arrow.y+=7,r.add({targets:this.arrow,alpha:1,duration:200}),r.add({targets:this.arrow,scaleX:"-=0.02",scaleY:"+=0.01",duration:s/6,offset:0,yoyo:!0,repeat:-1,hold:3500/6,ease:Phaser.Math.Easing.Quadratic.In}),r.add({targets:this.arrow,delay:s/6,y:"-=7",duration:1750/6,offset:0,ease:Phaser.Math.Easing.Quadratic.Out}),r.add({targets:this.arrow,y:"+=7",duration:1750/6,yoyo:!0,repeat:-1,hold:700/6,ease:Phaser.Math.Easing.Quadratic.In}),r.play(),this.arrowAnimation=r;case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.showHandAnimation=function(e,t){this.tutorialHand.revive(),this.tutorialHand.setPosition(e,t),this.tutorialHand.runTap()},n.hideArrowAnimation=function(){var e,t=this;null==(e=this.arrowAnimation)||e.stop();var n=this.scene.tweens.createTimeline();n.add({targets:this.arrow,alpha:0,duration:200,onComplete:function(){t.arrow.kill()}}),n.play(),this.arrowAnimation=n},n.hideHandAnimation=function(){this.tutorialHand.stopTap(),this.tutorialHand.kill()},n.hideGuide=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideHandAnimation(),this.hideHighLightCircle(),null==(t=this.guideAnimation)||t.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:0,duration:300,onComplete:function(){n.guideContainer.kill()}}),e.next=6,this.guideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showHighLightCircle=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){var s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=1/GameCore.ImageScale,this.highLightCircle.revive(),this.highLightCircle.setPosition(t,n),null==(s=this.showHighLightTween)||s.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,scaleX:{start:(i+1)*o,from:(i+1)*o,to:o*i,duration:400},scaleY:{start:(r+1)*o,from:(r+1)*o,to:o*r,duration:400},alpha:{start:0,from:0,to:.5},duration:300,ease:Phaser.Math.Easing.Sine.Out}),e.next=7,this.showHighLightTween.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.hideHighLightCircle=function(){var e,t=this;this.highLightCircle.visible&&(null==(e=this.showHighLightTween)||e.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){t.highLightCircle.kill()}}))},n.showGuide=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u,l,d,p,f,m,g,v,y,E,C,w,A,b,S,T,x,k,P,I,O,R,B,D,L,M,_,N,G,F,Z,U,W,Y,H,z,K,V,X,j,q,J,Q,$,ee,te,ne,ie,re,ae,se;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(i=t||{}).x,s=void 0===r?0:r,o=i.y,c=void 0===o?0:o,h=i.circleScaleX,u=void 0===h?1:h,l=i.circleScaleY,d=void 0===l?1:l,p=i.textBox,f=p.textX,m=void 0===f?0:f,g=p.textY,v=void 0===g?0:g,y=p.text,E=void 0===y?"":y,C=p.textVisible,w=void 0===C||C,A=p.textAlignType,b=void 0===A?cu.CENTER:A,S=p.useBackground,T=void 0!==S&&S,x=p.font,k=void 0===x?Rc.ZP.PRIMARY.KEY:x,P=p.fontSize,I=void 0===P?16:P,O=p.tint,R=p.lineHeight,B=void 0===R?56:R,D=p.boxWidth,void 0===D?235:D,L=p.boxHeight,void 0===L?70:L,M=i.icon,_=M.iconX,N=void 0===_?0:_,G=M.iconY,F=void 0===G?0:G,Z=M.iconDirection,U=void 0===Z?Qx.DOWN:Z,W=M.flipX,Y=void 0!==W&&W,H=M.iconVisible,z=void 0===H||H,K=i.showHighlight,V=void 0===K||K,this.guideContainer.revive(),X=this.guideContainer,j=X.bg,q=X.icon,J=X.text,Q=X.shadow,$=1/GameCore.ImageScale,this.guideContainer.setText(E,b),Q.setVisible(!T&&!V),J.setVisible(w),J.setFont(k),J.setFontSize(this.scene.fontSize(I)),J.setLineHeight(B),j.setVisible(T),j.setSizeByWorld(this.guideContainer.text.width+20,this.guideContainer.text.height+20),ee=this.scene.gameZone.width,this.guideContainer.setPosition(Phaser.Math.Clamp(m,-ee/2+j.displayWidth/2+5,ee/2-j.displayWidth/2-5),v),te=this.guideContainer.getLocalPoint(N,F),ne=te.x,ie=te.y,O?J.setTint(O):J.clearTint(),q.setPosition(ne,ie),q.setVisible(z),re=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_SIDE,ae=Y,U===Qx.UP?re=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_UP:U===Qx.DOWN?re=Ki.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_DOWN:ae=U!==Qx.LEFT,q.setTexture(Ki.Z.GAMEPLAY_DEFAULT.KEY,re),q.setDefaultWorldSize(),ae&&q.setScale(-1*$,$),se=[],null==(n=this.guideAnimation)||n.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:1,duration:300}),se.push(this.guideAnimation.waitForCompletion()),V&&se.push(this.showHighLightCircle(s,c,u,d)),this.zone.setVisible(!0),e.next=32,Promise.all(se);case 32:this.zone.setVisible(!1);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createArrow=function(){var e=this.scene.add.image(0,0,tk,nk.ARROW_GREEN);e.setDefaultWorldSize(),e.kill(),e.setDepth(Ha.Z.GUIDE),e.setAlpha(0),this.add(e),this.arrow=e},n.createTutorialHand=function(){var e=new Pm(this.scene);e.kill(),this.add(e),this.tutorialHand=e},n.createHighLightCircle=function(){var e=new bm(this.scene);e.kill(),e.setAlpha(0),e.setTint(0),this.add(e),this.highLightCircle=e,Ap.Z.registerObject(this.highLightCircle)},n.createTextBoxContainer=function(){var e=new ym(this.scene);this.scene.add.existing(e),e.kill(),e.setDepth(Ha.Z.GUIDE),e.setAlpha(0),this.add(e),this.guideContainer=e},n.createGuideZone=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.scene.add.zone(0,0,t,n);i.setVisible(!1),i.setInteractive(),i.setDepth(Ha.Z.GUIDE),Phaser.Display.Align.In.Center(i,this.scene.gameZone),this.zone=i},t}(Phaser.GameObjects.Container),rk=ik,ak=50,sk=32,ok=77/3,ck=77/3,hk=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).setSize(ak,sk),i.button.kill(),i.icon.setWorldSize(ok,ck),i.scene.add.existing((0,yc.Z)(i)),i}return(0,f.Z)(t,e),t.prototype.updateSize=function(){this.button.setWorldSize(ak,sk),e.prototype.updateSize.call(this)},t}(qg),uk=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).button=void 0,i.setSize(ak,sk),i.create(n),i.scene.add.existing((0,yc.Z)(i)),i}return(0,f.Z)(t,e),t.prototype.create=function(e){var t=new hk(this.scene,{enable:e.enable,frameOn:e.frameOn,frameOff:e.frameOff,backgroundOn:e.backgroundOn,backgroundOff:e.backgroundOff});this.add([t]),this.button=t},t}(Phaser.GameObjects.Container),lk=uk,dk=Ki.Z.DEFAULT.FRAME,pk=function(e){function t(t,n){var i;(i=e.call(this,t,n)||this).icon=void 0;var r=n.key;return i.icon=i.scene.add.image(0,0,r,dk.SETTINGS.GAMEPLAY.SETTINGS_ICON),i.icon.setDefaultWorldSize(),i.add(i.icon),i}(0,f.Z)(t,e);var n=t.prototype;return n.playRotateClockwiseAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1e3),e.next=3,this.scene.tweens.add({targets:this.icon,angle:179.99,duration:t,ease:Phaser.Math.Easing.Quadratic.Out}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playRotateCounterClockwiseAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1e3),e.next=3,this.scene.tweens.add({targets:this.icon,angle:0,duration:t,ease:Phaser.Math.Easing.Quadratic.In}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(ov.Z),fk=pk,mk=Ki.Z.DEFAULT,gk=mk.KEY,vk=mk.FRAME,yk={WIDTH:92/3,HEIGHT:452/3},Ek=function(e){function t(t,n,r){var s;return void 0===n&&(n=!1),void 0===r&&(r=!0),(s=e.call(this,t,40,40)||this).scene=void 0,s.buttons=[],s.toggleButtons=[],s.background=void 0,s.exitGameBtn=void 0,s.vibrationSwitchUI=void 0,s.soundSwitchUI=void 0,s.musicSwitchUI=void 0,s.settingButton=void 0,s.buttonsWrapper=void 0,s.backgroundHeight=void 0,s.toggleButtonsPosY=[],s.settingButtonPosY=void 0,s.settingsOpening=void 0,s.settingsPlaying=void 0,s.canHandleSettings=void 0,s.isPopupDirectionDown=void 0,s.useExitGameBtn=void 0,s.handleSettingsOnClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.settingsOpening?s.closeSettings():s.openSettings();case 1:case"end":return e.stop()}}),e)}))),s.openSettings=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=250),s.canHandleSettings){e.next=3;break}return e.abrupt("return");case 3:if(!s.settingsPlaying){e.next=5;break}return e.abrupt("return");case 5:return s.updateData(),s.settingsPlaying=!0,e.next=9,s.open(t);case 9:s.settingsPlaying=!1,s.settingsOpening=!0;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.closeSettings=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=250),s.canHandleSettings){e.next=3;break}return e.abrupt("return");case 3:if(!s.settingsPlaying){e.next=5;break}return e.abrupt("return");case 5:return s.settingsPlaying=!0,e.next=8,s.close(t);case 8:s.settingsPlaying=!1,s.settingsOpening=!1;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleSoundChange=function(e){s.scene.player.setSetting("sound",e)},s.handleMusicChanged=function(e){s.scene.player.setSetting("music",e),e?s.scene.resumeMusic():s.scene.audio.pauseAllMusics()},s.handleVibrationChanged=function(e){s.scene.player.setSetting("vibrate",e),e&&s.scene.vibration.performVibrating(50)},s.handleOpenExitGameScreen=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.canHandleSettings){e.next=2;break}return e.abrupt("return");case 2:s.scene.screen.open(de.o4.EXIT_GAME_SCREEN,{exitCallback:function(){s.scene.turnOffMusic(Hc.Z.GAMEPLAY_BACKGROUND.KEY),s.scene.screen.close(de.o4.EXIT_GAME_SCREEN),s.scene.gameplay.boardGame.stateMachine.emit(tu.EXIT);var e=s.scene.gameplay.boardGame.blackBackground.alpha;s.scene.gameplay.boardGame.runFadeBackground(e,0,250,0)},playOnCallback:function(){s.scene.screen.close(de.o4.EXIT_GAME_SCREEN)},eventItems:s.scene.gameplay.eventManager.getCurrentEventItems()}),s.handleSettingsOnClick();case 4:case"end":return e.stop()}}),e)}))),s.handleExitGame=function(){s.scene.gameplay.enableCardInput&&s.scene.screen.open(de.o4.EXIT_GAME_SCREEN,{exitCallback:function(){var e=s.scene.gameplay.boardGame,t=s.scene.world.getWorldSize(),n=t.width,i=t.height;s.scene.screen.close(de.o4.EXIT_GAME_SCREEN),e.locks.forEach((function(e){e.exit()})),e.blowCardsBehavior.blow(n/2,i/2).then((function(){e.stateMachine.emit(tu.LOSE)})),s.scene.gameUI.gameUILayout.hidePlusCardsButtons(),s.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.END_GAME),s.scene.analytics.event(ae._.LEVEL_GIVE_UP,{level:s.scene.level.getLevel()})},playOnCallback:function(){s.scene.screen.close(de.o4.EXIT_GAME_SCREEN)}})},s.scene=t,s.isPopupDirectionDown=n,s.useExitGameBtn=r,s.settingsOpening=!1,s.settingsPlaying=!1,s.canHandleSettings=!0,s.create(),s.alignToggleButtons(),s.updateBackgroundSize(),s.bindSettingsEvents(),t.add.existing((0,yc.Z)(s)),s}(0,f.Z)(t,e);var n=t.prototype;return n.setCanHandleSettings=function(e){this.canHandleSettings=e},n.bindSettingsEvents=function(){var e=this.settingButton,t=this.soundSwitchUI,n=this.musicSwitchUI,i=this.vibrationSwitchUI,r=this.exitGameBtn;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),r&&(r.button.onClick=this.handleOpenExitGameScreen),e.onClick=this.handleSettingsOnClick},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.soundSwitchUI,c=this.musicSwitchUI,h=this.vibrationSwitchUI;o.button.updateStatus(n),c.button.updateStatus(r),h&&h.button.updateStatus(s)},n.getBounds=function(){var e=this.background.getBounds();return new Phaser.Geom.Rectangle(e.x,e.y,43,e.height)},n.open=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),n=this.settingButton.y,20,i=n+20*this.buttons.length+2,r=this.scene.tweens.addCounter({from:i,to:this.backgroundHeight,duration:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){return u.background.revive()},onUpdate:function(e){var t=(e.getValue()-i)/(u.backgroundHeight-i);u.background.setSizeByWorld(u.background.displayWidth,e.getValue()),u.background.alpha=t}}).waitForCompletion(),s=this.toggleButtons.map((function(e,n){return e.y=.5*u.toggleButtonsPosY[n],e.alpha=0,u.scene.tweens.add({targets:e,duration:t,y:u.toggleButtonsPosY[n],ease:Phaser.Math.Easing.Back.Out,alpha:1,onStart:function(){return e.revive()}}).waitForCompletion()})),o=this.toggleButtons.map((function(e,n){var i=u.scene.tweens.createTimeline();return e.scaleX=1.05,i.add({delay:.35*t,targets:e,duration:.15*t,ease:Phaser.Math.Easing.Sine.InOut,scaleY:.9}),i.add({targets:e,duration:.45*t,ease:Phaser.Math.Easing.Sine.InOut,scaleX:.98,scaleY:1.1}),i.add({targets:e,duration:.25*t,ease:Phaser.Math.Easing.Quadratic.InOut,scaleX:1,scaleY:1}),i.play(),i.waitForCompletion()})),c=this.settingButton.playRotateClockwiseAnimation(t),(h=[]).push(r),h.push.apply(h,s),h.push.apply(h,o),h.push(c),e.next=15,Promise.all(h);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),n=.8,i=this.background.displayWidth,r=this.scene.tweens.addCounter({from:this.backgroundHeight,to:n*this.backgroundHeight,duration:t,ease:Phaser.Math.Easing.Back.In,onUpdate:function(e){var t=e.getValue()/h.backgroundHeight;h.background.setSizeByWorld(i*t,e.getValue()),h.background.alpha=(t-n)/(1-n)},onComplete:function(){h.background.setSizeByWorld(i,h.backgroundHeight),h.background.kill()}}).waitForCompletion(),s=this.toggleButtons.map((function(e,i){return h.scene.tweens.add({targets:e,duration:t,y:h.toggleButtonsPosY[i]*n,scale:n,alpha:0,ease:Phaser.Math.Easing.Back.In,onComplete:function(){e.scale=1,e.kill()}}).waitForCompletion()})),o=this.settingButton.playRotateCounterClockwiseAnimation(t),(c=[]).push(r),c.push.apply(c,s),c.push(o),e.abrupt("return",Promise.all(c));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBackgroundSize=function(){var e=this.settingButton.displayHeight,t=this.buttons[0],n=this.buttons[this.buttons.length-1];this.backgroundHeight=Math.abs(n.y-t.y)+e+3,this.background.setSizeByWorld(this.background.displayWidth,this.backgroundHeight);var i=this.isPopupDirectionDown?(e+2)/2:-(e+2)/2;this.background.setY(this.settingButton.y-i)},n.alignToggleButtons=function(){var e=this,t=GameCore.layoutInitializer.isLandscape?30:-30;this.buttons.forEach((function(n,i){var r=e.isPopupDirectionDown?i*t:-i*t;n.setY(r)})),this.toggleButtons=this.buttons.filter((function(e){return e.active&&e instanceof lk})),this.toggleButtonsPosY=this.toggleButtons.map((function(e){return e.y})),this.settingButtonPosY=this.settingButton.y},n.create=function(){this.createButtonsWrapper(),this.createBackground(),this.createSettingButton(),this.createToggleButtons(),this.createExitGameButton()},n.createButtonsWrapper=function(){var e=this.scene.add.container(0,0);this.add(e),this.buttonsWrapper=e},n.createBackground=function(){var e=this.scene.make.nineslice({key:gk,frame:vk.SETTINGS.GAMEPLAY.BACKGROUND,topHeight:25,bottomHeight:25,leftWidth:10,rightWidth:10,width:yk.WIDTH,height:yk.HEIGHT});e.setOrigin(.5,this.isPopupDirectionDown?0:1),this.buttonsWrapper.add(e),this.background=e},n.createExitGameButton=function(){if(this.useExitGameBtn){var e=new lk(this.scene,{enable:!0,frameOn:vk.SETTINGS.GAMEPLAY.QUIT,frameOff:vk.SETTINGS.GAMEPLAY.QUIT,backgroundOn:vk.SETTINGS.GAMEPLAY.QUIT,backgroundOff:vk.SETTINGS.GAMEPLAY.QUIT});e.button.setName("ExitGameSettings"),this.buttonsWrapper.add(e),this.exitGameBtn=e,this.buttons.push(e)}},n.createToggleButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.createVibrationButton(s),c=this.createSoundButton(n),h=this.createMusicButton(r);this.buttonsWrapper.add([o,c,h]),this.buttons.push(h,c),cv()?this.buttons.push(o):o.kill()},n.createVibrationButton=function(e){var t=new lk(this.scene,{enable:e,frameOn:vk.SETTINGS.GAMEPLAY.VIBRATE_ON,frameOff:vk.SETTINGS.GAMEPLAY.VIBRATE_OFF,backgroundOn:vk.SETTINGS.GAMEPLAY.VIBRATE_ON,backgroundOff:vk.SETTINGS.GAMEPLAY.VIBRATE_OFF});return t.button.setName("VibrationSwitch"),t.button.updateStatus(e),this.vibrationSwitchUI=t,t},n.createSoundButton=function(e){var t=new lk(this.scene,{enable:e,frameOn:vk.SETTINGS.GAMEPLAY.SOUND_ON,frameOff:vk.SETTINGS.GAMEPLAY.SOUND_OFF,backgroundOn:vk.SETTINGS.GAMEPLAY.SOUND_ON,backgroundOff:vk.SETTINGS.GAMEPLAY.SOUND_OFF});return t.button.setName("SoundSwitch"),t.button.updateStatus(e),this.soundSwitchUI=t,t},n.createMusicButton=function(e){var t=new lk(this.scene,{enable:e,frameOn:vk.SETTINGS.GAMEPLAY.MUSIC_ON,frameOff:vk.SETTINGS.GAMEPLAY.MUSIC_OFF,backgroundOn:vk.SETTINGS.GAMEPLAY.MUSIC_ON,backgroundOff:vk.SETTINGS.GAMEPLAY.MUSIC_OFF});return t.button.setName("MusicSwitch"),t.button.updateStatus(e),this.musicSwitchUI=t,t},n.createSettingButton=function(){var e=new fk(this.scene,{key:gk,frame:vk.SETTINGS.GAMEPLAY.BLUE,width:77/3,height:77/3,paddingZone:18});e.setName("Settings"),this.add(e),this.settingButton=e,this.buttons.push(e)},t}(jp.Z),Ck=Ek,wk=function(e){function t(t){var n;return(n=e.call(this)||this).matrix=void 0,n.config=void 0,n.matrix=new Phaser.GameObjects.Components.TransformMatrix,n.resetFromJSON(t),n}(0,f.Z)(t,e);var n=t.prototype;return n.setStartEndPoint=function(e,t){this.config.startPoint=e,this.config.endPoint=t,this.resetFromJSON(this.config)},n.resetFromJSON=function(e){this.config=(0,p.Z)({},e);var t=e.vertices||[],n=e.isClose||!1,i=e.flipX,r=void 0!==i&&i,a=e.flipY,s=void 0===a||a;if(!(t.length<6)){var o=t.map((function(e,t){return t%2==0?r?-e:e:s?-e:e})),c=o.length,h=[o[2],o[3]],u=[o[c-2-2],o[c-1-2]],l=e.startPoint||h,d=e.endPoint||u,f=Math.sqrt(Math.pow(d[0]-l[0],2)+Math.pow(d[1]-l[1],2)),m=Math.sqrt(Math.pow(u[0]-h[0],2)+Math.pow(u[1]-h[1],2)),g=(l[0],l[1],Phaser.Math.Angle.Between(l[0],l[1],d[0],d[1])-Phaser.Math.Angle.Between(h[0],h[1],u[0],u[1])),v=f/m;this.matrix.applyITRS(l[0],l[1],g,v,v);for(var y=[],E=0;E<c;E+=2){var C=o[E]-h[0],w=o[E+1]-h[1],A=this.matrix.getX(C,w),b=this.matrix.getY(C,w);y.push(A,b)}this.moveTo(l[0],l[1]);for(var S=4;S<c-6;S+=6)this.cubicBezierTo(y[S+4],y[S+5],y[S],y[S+1],y[S+2],y[S+3]);return n&&this.cubicBezierTo(l[0],l[1],y[c-2],y[c-1],y[0],y[1]),this}},n.deform=function(e){var t=this.config.vertices.map((function(t,n){return t+(e[n]||0)}));this.curves=[],this.cacheLengths=[],this.resetFromJSON((0,p.Z)({},this.config,{vertices:t}))},n.setDebug=function(e,t){var n=this;void 0===t&&(t=16711680);var i=e.add.graphics();e.events.on("update",(function(){i.clear(),i.lineStyle(1,t,1);for(var e=0;e<n.curves.length;e++){var r=n.curves[e];r.draw&&r.draw(i)}}))},t}(Phaser.Curves.Path),Ak=wk,bk=Ki.Z.DASHBOARD,Sk=bk.KEY,Tk=bk.FRAME,xk=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).background=void 0,r.rankText=void 0,r.create(),r.setRank(23),r}(0,f.Z)(t,e);var n=t.prototype;return n.updateBackgroundToWin=function(e){this.background.setFrame(e?Tk.EVENTS_COMMON.RANK_BLOCK_GREEN:Tk.EVENTS_COMMON.RANK_BLOCK_BLUE),this.background.setDefaultWorldSize()},n.setRank=function(e,t){void 0===t&&(t=!1),this.setVisible(e>0);var n=e<100?""+e:"99+",i=e<100?11:9,r=e<100?.25:.5;this.rankText.setFontSize(this.scene.fontSize(i)),this.rankText.setPosition(0,r),this.rankText.setText(n),this.updateBackgroundToWin(t)},n.create=function(){var e=this.scene.add.image(0,0,Sk,Tk.EVENTS_COMMON.RANK_BLOCK_BLUE);e.setDefaultWorldSize(),e.setY(.5),this.setSize(e.width,e.height);var t=new Qp(this.scene,{text:"1",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setPosition(0,.5),this.add([e,t]),this.rankText=t,this.background=e},t}(Phaser.GameObjects.Container),kk=xk,Pk=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.countdownTimer=void 0,r.timeText="7d 10h 5m",r.startTime=void 0,r.rtMs=void 0,r.txt=void 0,r.scene=t,r.rtMs=0,r.setSize(n,i),r.createTimeText(),t.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.createTimeText=function(){this.txt=new Qp(this.scene,{text:"11",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.add(this.txt)},n.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.countdownTimer.remove();else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.timeText=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.txt.setFontSize(t.scene.fontSize(10)),t.txt.setText(t.timeText)}}})},n.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},n.setText=function(e,t){var n;void 0===t&&(t=10),null==(n=this.countdownTimer)||n.remove(),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),Ik=Pk,Ok=Ki.Z.DASHBOARD,Rk=Ok.KEY,Bk=Ok.FRAME,Dk=function(e){function t(t){var n;return(n=e.call(this,t)||this).sparksCount=6,n.sparks=[],n.wave=void 0,n.glow=void 0,n.animation=void 0,n.container=void 0,n.container=n.scene.add.container(),n.add(n.container),n.createSparks(),n.createWave(),n.createGlow(),n.createAnimation(),n.setDepth(Ha.Z.ON_TOP),n.kill(),n.container.setPosition(0,0),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.explode=function(){var e,t;null==(e=this.animation)||e.setTimeScale(1),null==(t=this.animation)||t.start()},n.createSparks=function(){for(var e=0;e<this.sparksCount;e++){var t=this.scene.add.image(0,0,Rk,Bk.EFFECTS.SPARKS).setAlpha(0);t.setDefaultWorldSize(),t.scale*=.53448,this.sparks.push(t)}this.container.add(this.sparks)},n.createWave=function(){this.wave=this.scene.add.image(0,5,Rk,Bk.EFFECTS.WAVE).setAlpha(0),this.wave.setWorldSize(14,14),this.container.add(this.wave)},n.createGlow=function(){this.glow=this.scene.add.image(0,0,Rk,Bk.EFFECTS.GLOW).setAlpha(0),this.glow.setDefaultWorldSize(),this.container.add(this.glow)},n.createAnimation=function(){var e=this;this.animation=new VA([{target:this.glow,color:[{color:"ffffff43",curve:.056,c2:.52,c3:.75},{time:.1,color:"ffffff7f",curve:.25,c3:.988,c4:.59},{time:.2667,color:"ffffff00"}]},{target:this.sparks[0],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[1],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[2],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[3],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[4],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[5],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.wave,color:[{time:.0333,color:"ffffff32"},{time:.1333,color:"ffffff94"},{time:.3,color:"ffffff00"}]},{target:this.glow,translate:[{x:-3.42,y:-2.28},{time:.2667,x:-3.42,y:3.73}],scale:[{x:0,y:0,curve:.128,c2:.73,c3:.75},{time:.2667,x:3.567,y:3.567}]},{target:this.sparks[0],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:42.58,y:42.58}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[1],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:-27.42,y:53.63}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[2],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:-59.65,y:-17.29}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[3],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5333,x:14.95,y:62.84}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.5333,x:0,y:0}],rotate:[{time:.0333},{time:.5333,angle:-102.81}]},{target:this.sparks[4],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:52.71,y:-12.68}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[5],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5,x:4.82,y:-41.23}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.5,x:0,y:0}],rotate:[{time:.0333},{time:.5,angle:-102.81}]},{target:this.wave,translate:[{time:.0333},{time:.3,x:.98,y:25.4}],scale:[{y:0},{time:.0333,curve:.25,c3:.75},{time:.3,x:5.198,y:5.198}]}]),this.animation.events.on("start",(function(){e.revive()})),this.animation.events.on("complete",(function(){e.kill()}))},t}(Phaser.GameObjects.Container),Lk=Dk,Mk={position:[{time:.5,curve:.25,c3:.75},{time:.6667,position:.4663,curve:.131,c2:.11,c3:.982,c4:.73},{time:.7833,position:1}],color:[{color:"ffffff00",curve:.156,c2:.76,c3:.75},{time:.2333,color:"ffffffff",curve:"stepped"},{time:.7667,color:"ffffffff"}],rotate:[{angle:26.11,curve:0,c2:.6,c3:.682,c4:.83},{time:.4,angle:-8.57,curve:.25,c3:.75},{time:.6667}],scale:[{x:0,y:0,curve:.049,c2:.82,c3:.75},{time:.2333,x:1.497,y:1.497,curve:.241,c2:.02,c4:.86},{time:.5,x:.861,y:.861,curve:.25,c3:.75},{time:.65,x:1.261,y:1.261},{time:.7667,x:.552,y:.552}]},_k=Ki.Z.DASHBOARD,Nk=_k.KEY,Gk=_k.FRAME,Fk=function(e){return e[e.READY=0]="READY",e[e.PLAYING=1]="PLAYING",e[e.WON=2]="WON",e[e.LOST=3]="LOST",e}({}),Zk=function(e){function t(t,n,i){var r;return(r=e.call(this,t,52,160/3)||this).scene=void 0,r.smallIcon=void 0,r.plusScoreText=void 0,r.widgetSparks=void 0,r.buttonType=void 0,r.buttonSide=$k.LEFT,r.plusScoreAnimationPromise=void 0,r.buttonStatus=void 0,r.timer=void 0,r.rankText=void 0,r.playingStateFrame=void 0,r.wonStateFrame=void 0,r.lostStateFrame=void 0,r.buttonFrame=void 0,r.rankBlock=void 0,r.redBadge=void 0,r.yellowBadge=void 0,r.scene=t,r.buttonType=i,r.createButtonFrame(Nk),r.createRankBlock(),r.createAttentionBadge(),r.createTimer(),r.createSmallIcon(n),r.createStarParticle(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.setType=function(e){this.buttonType=e},n.setSide=function(e){this.buttonSide=e},n.setReadyState=function(e){this.buttonStatus=Fk.READY,this.buttonFrame.setFrame(this.playingStateFrame),this.timer.setText(e,9),this.rankBlock.setVisible(!1)},n.setPlayingState=function(e,t){this.buttonStatus=Fk.PLAYING,this.buttonFrame.setFrame(this.playingStateFrame),this.rankBlock.setRank(e+1),this.timer.setRemainingTime(t)},n.setFinishedState=function(e,t){this.buttonStatus=t?Fk.WON:Fk.LOST,this.buttonFrame.setFrame(t?this.wonStateFrame:this.lostStateFrame),this.rankBlock.setRank(e+1,t);var n=t?"Open":"Completed";this.timer.setText(n,8)},n.showAttentionBadge=function(){var e=this.getPluginManager();e&&e.checkNotifyEvent()&&(e.isHappening()?(this.yellowBadge.setVisible(!0),this.redBadge.setVisible(!1)):(this.yellowBadge.setVisible(!1),this.redBadge.setVisible(!0)))},n.hideAttentionBadge=function(){this.redBadge.setVisible(!1),this.yellowBadge.setVisible(!1)},n.updateRankBlockPosition=function(e,t){this.rankBlock.setPosition(e,t)},n.runPlusScoreAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=300),this.plusScoreText.setText("+"+t),r=this.smallIcon.x+(this.buttonSide===$k.LEFT?60:-60),s=this.buttonSide===$k.LEFT,o=new Ak({vertices:[-211.5,40.29,-186.35,97.94,-156.05,167.39,-78.09,171.9,-28.95,87.7,2.75,33.38],startPoint:[r,this.smallIcon.y],endPoint:[0,0],flipX:s}),this.smallIcon.setScale(1),c=new VA([(0,p.Z)({},Mk,{target:this.smallIcon,delay:n,path:o})]),(0,gl.Z)(this.scene,Math.max(n-100,0)).then((function(){h.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.FULL_PROGRESS)})),c.events.on("complete",(function(){h.runStarExplodeParticle(),h.smallIcon.kill(),h.plusScoreAnimationPromise=void 0,h.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS)})),c.events.on("startDelay",(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.smallIcon.revive();case 1:case"end":return e.stop()}}),e)})))),this.plusScoreAnimationPromise=c.start();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runStarExplodeParticle=function(){this.widgetSparks.setPosition(0,0),this.widgetSparks.explode()},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.add.tween({targets:this,duration:300,props:{scale:{from:.75,start:.75,to:1},alpha:{from:0,start:0,to:1}},ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.add.tween({targets:this,duration:300,props:{scale:{from:this.scale,start:this.scale,to:.75},alpha:{from:this.alpha,start:this.alpha,to:0}},ease:Phaser.Math.Easing.Back.In}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.waitForAnimationCompleted=function(){return this.plusScoreAnimationPromise||Promise.resolve()},n.createButtonFrame=function(e){this.setButtonFrames();var t=this.scene.add.image(0,0,e,this.playingStateFrame);t.setDefaultWorldSize(),this.add(t),this.buttonFrame=t,this.buttonFrame.setY(this.height/2-this.buttonFrame.height/2)},n.createRankBlock=function(){var e=new kk(this.scene);this.add(e),this.rankBlock=e,this.rankBlock.setPosition(0,1)},n.createAttentionBadge=function(){var e=this.scene.add.image(0,0,Nk,Gk.EVENTS_COMMON.RED_BADGE);e.setDefaultWorldSize(),e.setVisible(!1),this.add(e);var t=this.scene.add.image(0,0,Nk,Gk.EVENTS_COMMON.YELLOW_BADGE);t.setDefaultWorldSize(),t.setVisible(!1),this.add(t),this.redBadge=e,this.yellowBadge=t,Phaser.Display.Align.In.TopRight(this.redBadge,this,1.5,1.5),Phaser.Display.Align.In.TopRight(this.yellowBadge,this,1.5,1.5)},n.createTimer=function(){this.timer=new Ik(this.scene,145/3,47/3),this.add(this.timer),this.timer.setY(this.height/2-this.timer.height/2)},n.createSmallIcon=function(e){var t=this.scene.add.container(0,0);this.add(t);var n=this.scene.add.image(0,0,Nk,e);n.setDefaultWorldSize(),t.add(n);var i=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(15),text:"x1",origin:{x:0,y:.5}});t.add(i),t.setSize(n.width,n.height),this.smallIcon=t,this.plusScoreText=i,this.smallIcon.kill()},n.createStarParticle=function(){this.widgetSparks=new Lk(this.scene),this.add(this.widgetSparks)},n.setButtonFrames=function(){var e=[Gk.WEEKLY_TOURNAMENT,Gk.BOXING_DUEL,Gk.RACE];switch(this.buttonType){case nP.WEEKLY_TOURNAMENT:this.playingStateFrame=e[0].BUTTON.PLAYING,this.wonStateFrame=e[0].BUTTON.WON,this.lostStateFrame=e[0].BUTTON.LOST;break;case nP.BOXING_DUEL:this.playingStateFrame=e[1].BUTTON.PLAYING,this.wonStateFrame=e[1].BUTTON.WON,this.lostStateFrame=e[1].BUTTON.LOST;break;case nP.OFFSHORE_RACE:this.playingStateFrame=e[2].BUTTON.PLAYING,this.wonStateFrame=e[2].BUTTON.WON,this.lostStateFrame=e[2].BUTTON.LOST}},n.getPluginManager=function(){switch(this.buttonType){case nP.WEEKLY_TOURNAMENT:return this.scene.weeklyTournament;case nP.BOXING_DUEL:return this.scene.boxingDuel;case nP.OFFSHORE_RACE:return this.scene.offshoreRace}},t}(jp.Z),Uk=Zk,Wk=Ki.Z.DASHBOARD.FRAME,Yk=function(e){function t(t,n){var r;return(r=e.call(this,t,Wk.BOXING_DUEL.SMALL_ICON,n)||this).handleOnButtonClicked=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.scene.boxingDuel,r.hideAttentionBadge(),t.setNofityEvent(!1),e.next=5,r.scene.requireTextureAsync("BOXING_DUEL");case 5:t.isFinished()?(r.scene.screen.close(de.o4.DASHBOARD_SCREEN),r.scene.screen.open(de.o4.BOXING_DUEL.REWARD_SCREEN)):r.scene.screen.open(de.o4.BOXING_DUEL.MAIN_SCREEN);case 6:case"end":return e.stop()}}),e)}))),r.scene=t,r.plusScoreText.setPosition(15,5),r.updateData(),r}return(0,f.Z)(t,e),t.prototype.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(t=this.scene.boxingDuel,n=t.isWaiting(),i=t.isHappening(),r=t.isFinished(),!n){e.next=9;break}return this.setReadyState("New Duel"),e.abrupt("return");case 9:if(!i){e.next=14;break}return s=t.getPlayerRank(),o=t.getRemainingTime(),this.setPlayingState(s,o),e.abrupt("return");case 14:if(!r){e.next=18;break}return c=t.getPlayerRank(),this.setFinishedState(c,0===c),e.abrupt("return");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Uk),Hk=Yk,zk=Ki.Z.DASHBOARD.FRAME,Kk=function(e){function t(t,n){var r;return(r=e.call(this,t,zk.RACE.SMALL_ICON,n)||this).handleOnButtonClicked=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.scene.offshoreRace,r.hideAttentionBadge(),t.setNotifyEvent(!1),t.isWaiting()?r.scene.openOffshoreRaceInvitationScreen():r.scene.openOffshoreRaceMainScreen();case 4:case"end":return e.stop()}}),e)}))),r.scene=t,r.plusScoreText.setPosition(15,5),r}return(0,f.Z)(t,e),t.prototype.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(t=this.scene.offshoreRace,n=t.isWaiting(),i=t.isHappening(),r=t.isFinished(),!n){e.next=9;break}return this.setReadyState("New Race"),e.abrupt("return");case 9:if(!i){e.next=14;break}return s=t.getPlayerRank(),o=t.getRemainingTime(),this.setPlayingState(s,o),e.abrupt("return");case 14:if(!r){e.next=19;break}return c=t.getPlayerRank(),h=t.hasReward(),this.setFinishedState(c,h),e.abrupt("return");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Uk),Vk=Kk,Xk=Ki.Z.DASHBOARD,jk=(Xk.KEY,Xk.FRAME),qk=function(e){function t(t,n){var r;return(r=e.call(this,t,jk.WEEKLY_TOURNAMENT.SMALL_ICON,n)||this).handleOnButtonClicked=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=r.scene.weeklyTournament).isLoadingTournaments()){e.next=3;break}return e.abrupt("return");case 3:return r.hideAttentionBadge(),t.setNofityEvent(!1),r.scene.weeklyTournament.popupJoinTournament(),e.next=8,r.scene.requireTextureAsync("WEEKLY_TOURNAMENT");case 8:t.isHappening()||t.isFinished()?r.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN):r.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 9:case"end":return e.stop()}}),e)}))),r.scene=t,r.plusScoreText.setPosition(15,5),r.updateRankBlockPosition(0,-9),r}return(0,f.Z)(t,e),t.prototype.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(!(t=this.scene.weeklyTournament).isLoadingTournaments()){e.next=7;break}this.setReadyState("Loading..."),e.next=15;break;case 7:return e.next=9,t.waitForRequestDataStartGameCompleted();case 9:return e.next=11,t.waitForLoadWorldTournamentsCompleted();case 11:n=t.isWaiting(),i=t.isHappening(),r=t.isFinished(),n?this.setReadyState("Join"):i?(s=t.getRank(),o=t.getRemainingTime(),this.setPlayingState(s-1,o)):r&&(c=t.getRank()-1,h=t.hasReward(),this.setFinishedState(c,h));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Uk),Jk=qk,Qk=Ki.Z.DASHBOARD,$k=(Qk.KEY,Qk.FRAME,function(e){return e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTH=2]="BOTH",e}({})),eP=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.buttons=[],n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.createButtons(),n}(0,f.Z)(t,e);var n=t.prototype;return n.showWarningBadgeOnEventButtons=function(){this.buttons.filter((function(e){return e.active&&e.visible})).forEach((function(e){e.showAttentionBadge()}))},n.bringButtonToTop=function(e){var t=this.buttons.find((function(t){return t.buttonType===e}));t&&this.bringToTop(t)},n.alignItems=function(){var e=[],t=[];this.buttons.filter((function(e){return e.active&&e.visible})).forEach((function(n){switch(n.buttonSide){case $k.LEFT:e.push(n);break;case $k.RIGHT:t.push(n)}})),this.alignLeftButtons(e),this.alignRightButtons(t)},n.alignLeftButtons=function(e){var t=this,n=GameCore.layoutInitializer.isLandscape?-5:-8,i=GameCore.layoutInitializer.isLandscape?50:60,r=GameCore.layoutInitializer.isLandscape?60:80;e.forEach((function(e,a){Phaser.Display.Align.In.TopLeft(e,t,n,-i-a*r)}))},n.alignRightButtons=function(e){var t=this,n=GameCore.layoutInitializer.isLandscape?-10:-8,i=GameCore.layoutInitializer.isLandscape?50:60,r=GameCore.layoutInitializer.isLandscape?60:80;e.forEach((function(e,a){Phaser.Display.Align.In.TopRight(e,t,n,-i-a*r)}))},n.createButtons=function(){this.createWeeklyTournamentButton(),this.createBoxingDuelButton(),this.createRaceButton()},n.createWeeklyTournamentButton=function(){var e=new Jk(this.scene,nP.WEEKLY_TOURNAMENT);e.setSide($k.LEFT),e.setName("WeeklyTournamentButton"),this.add(e),this.buttons.push(e)},n.createBoxingDuelButton=function(){var e=new Hk(this.scene,nP.BOXING_DUEL);e.setSide($k.LEFT),e.setName("BoxingDuelButton"),this.add(e),this.buttons.push(e)},n.createRaceButton=function(){var e=new Vk(this.scene,nP.OFFSHORE_RACE);e.setSide($k.LEFT),e.setName("OffshoreRaceButton"),this.add(e),this.buttons.push(e)},t}(Phaser.GameObjects.Container),tP=eP,nP=function(e){return e[e.WEEKLY_TOURNAMENT=0]="WEEKLY_TOURNAMENT",e[e.BOXING_DUEL=1]="BOXING_DUEL",e[e.OFFSHORE_RACE=2]="OFFSHORE_RACE",e}({}),iP=function(){function e(e){var t=this;this.scene=void 0,this.dashboardScreen=void 0,this.box=void 0,this.alignButtonsBoxes=function(){t.box.alignItems()},this.dashboardScreen=e,this.scene=e.scene,this.createButtonBox()}var t=e.prototype;return t.createButtonBox=function(){this.box=new tP(this.scene),this.dashboardScreen.add(this.box)},t.getButtonByType=function(e){var t=this.box.buttons.find((function(t){return t.buttonType===e}));if(!t)throw new Error("Button with type "+e+" not found");return t},t.showWarningBadgeOnEventButtons=function(){this.box.showWarningBadgeOnEventButtons()},e}(),rP=n(31),aP=Ki.Z.DASHBOARD,sP=aP.KEY,oP=aP.FRAME,cP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.progressText=void 0,n.progressBar=void 0,n.progressFill=void 0,n.currentProgress=0,n.maxProgress=0,n.barSize=void 0,n.fillSize=void 0,n.scene=t,n.setSize(176/3,47/3),n.barSize={width:176/3,height:47/3},n.fillSize={width:n.barSize.width-7/3,height:13},n.createProgressBar(),n.createProgressFill(),n.createTitleText(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentProgress,this.maxProgress=n,0===t?(this.progressFill.kill(),this.progressFill.setAlpha(0)):this.progressFill.revive(),!i){e.next=9;break}return this.progressFill.setAlpha(0===t?0:1),this.currentProgress=t,this.progressFill.setSizeByWorld((0,rP.Z)(t,0,n,7,this.fillSize.width),this.progressFill.displayHeight),this.progressText.setText(Math.floor(t)+"/"+n),e.abrupt("return",Promise.resolve());case 9:return s=this.scene.tweens.add({targets:this.progressFill,alpha:1,duration:300}).waitForCompletion(),o=this.scene.tweens.addCounter({from:r,to:t,duration:300,onUpdate:function(e){var t=e.getValue(),i=c.progressFill.displayHeight,r=(0,rP.Z)(t,0,n,7,c.fillSize.width);c.progressFill.setSizeByWorld(r,i),c.progressText.setText(Math.floor(t)+"/"+n),c.currentProgress=t}}).waitForCompletion(),e.next=13,Promise.all([s,o]);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.setSizeByWorld=function(e){this.barSize.width=e,this.fillSize.width=e-7/3,this.progressBar.setSizeByWorld(this.barSize.width,this.barSize.height),this.progressFill.setSizeByWorld(this.fillSize.width,this.fillSize.height),this.setSize(this.progressBar.displayWidth,this.progressBar.displayHeight),this.alignProgressFill()},n.isProgressComplete=function(){return this.currentProgress>=this.maxProgress},n.createProgressBar=function(){var e=this.scene.make.nineslice({key:sP,frame:oP.DECOR.LOCATION_PROGRESS.BAR,leftWidth:20,rightWidth:20,width:this.barSize.width,height:this.barSize.height});this.add(e),this.progressBar=e,this.setSize(e.displayWidth,e.displayHeight)},n.createProgressFill=function(){var e=this.scene.make.nineslice({key:sP,frame:oP.DECOR.PROGRESS.FILL,leftWidth:7,rightWidth:7,width:this.fillSize.width,height:this.fillSize.height});e.setOrigin(0,.5),this.add(e),this.progressFill=e,this.alignProgressFill()},n.alignProgressFill=function(){var e=(this.progressBar.displayWidth-this.progressFill.displayWidth)/2;this.progressFill.setX(-this.progressBar.displayWidth/2+e)},n.createTitleText=function(){var e=new Qp(this.scene,{text:"3/15",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.add(e),this.progressText=e},t}(Phaser.GameObjects.Container),hP=cP;function uP(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return lP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lP(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var dP=Ki.Z.DASHBOARD,pP=dP.KEY,fP=dP.FRAME,mP=function(e){function t(t){var n;return(n=e.call(this,t,pP,fP.BLANK,118,170/3)||this).scene=void 0,n.progressBar=void 0,n.locationName=void 0,n.buttonImage=void 0,n.counterBadge=void 0,n.counterText=void 0,n.button.kill(),n.scene=t,n.setName("Location"),n.create(),n.alignItems(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateCounterBadge(),e.next=3,this.updateLocationProgress();case 3:this.alignItems();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateCounterBadge=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.player.getStar(),e.next=3,this.scene.journey.getInProgressLocation();case 3:if(n=e.sent,i=n.decorations.map((function(e){return e.level})),!((r=this.countMultiBuildableBuildings(i,t))<=0)){e.next=9;break}return this.counterBadge.kill(),e.abrupt("return");case 9:this.counterBadge.revive(),this.counterText.setText(r.toString());case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.countMultiBuildableBuildings=function(e,t){for(var n,i=[3,4,5],r=[],a=uP(e);!(n=a()).done;){var s=n.value;r.push.apply(r,i.slice(s))}r.sort((function(e,t){return e-t}));for(var o=0,c=0,h=0,u=r;h<u.length;h++){var l=u[h];if(c+l>t)break;c+=l,o++}return o},n.updateLocationProgress=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.journey.getInProgressLocation();case 2:t=e.sent,n=t.id,i=t.name,r=t.progress,s=parseInt(n)+1,this.locationName.setText(s+". "+i),o=Math.max(this.locationName.width,176/3),this.buttonImage.setSizeByWorld(o+59.3333,this.height),this.progressBar.setSizeByWorld(o),this.progressBar.updateProgress(r,3*t.decorations.length,!0),this.setSize(this.buttonImage.displayWidth,this.buttonImage.displayHeight),this.hitZone.setSize(this.width,this.height,!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.progressBar.setPosition(this.width/2-this.progressBar.width/2-11.3333,8),this.locationName.setPosition(this.progressBar.x,-10),this.counterBadge.setPosition(this.width/2-this.counterBadge.width/2+1,-this.height/2+this.counterBadge.height/2-2)},n.create=function(){this.createButtonImage(),this.createLocationName(),this.createLocationButtonProgressBar(),this.createCounterBadge()},n.createButtonImage=function(){var e=this.scene.make.nineslice({key:pP,frame:fP.DECOR.LOCATION_BUTTON,leftWidth:45,rightWidth:20,width:this.width,height:this.height});this.add(e),this.buttonImage=e},n.createLocationName=function(){var e=new Qp(this.scene,{text:"1. United States",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setCenterAlign(),e.setPosition(0,0),this.add(e),this.locationName=e},n.createLocationButtonProgressBar=function(){var e=new hP(this.scene);this.add(e),this.progressBar=e},n.createCounterBadge=function(){this.counterBadge=this.scene.add.container(),this.add(this.counterBadge);var e=this.scene.add.image(0,0,Ki.Z.DASHBOARD.KEY,Ki.Z.DASHBOARD.FRAME.DECOR.RED_CIRCLE);e.setDefaultWorldSize(),this.counterBadge.add(e),this.counterText=new Qp(this.scene,{text:"1",fontSize:this.scene.fontSize(11),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.counterBadge.add(this.counterText),this.counterBadge.setSize(e.width,e.height)},t}(Vc.Z),gP=mP,vP=function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.dashboardScreen=void 0,n.screenQueue=[],n.currentScreenOpenPromise=void 0,n.managerPromise=void 0,n.canRefresh=!1,n.clearQueue=function(){n.screenQueue=[]},n.displayAllEventScreens=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(750);case 2:return n.handleWeeklyTournamentScreen(),n.handleBoxingDuelScreen(),n.handleOffshoreRaceScreen(),e.next=7,n.waitForAllScreensToDisplay();case 7:case"end":return e.stop()}}),e)}))),n.handleWeeklyTournamentScreen=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getWeeklyTournamentScreenKey(),n.pushScreenKeyToQueue(t,0),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.handleBoxingDuelScreen=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getBoxingDuelScreenKey(),n.pushScreenKeyToQueue(t,1),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.handleOffshoreRaceScreen=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getRaceScreenKey(),n.pushScreenKeyToQueue(t,2),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.refreshEventData=function(){n.canRefresh&&(n.updateWeeklyTournamentData(),n.updateBoxingDuelData(),n.updateOffshoreRaceData())},n.updateWeeklyTournamentData=function(){var e=n.scene.weeklyTournament;e.isValid()&&(e.update(),n.dashboardScreen.weeklyTournamentButton.updateData())},n.updateBoxingDuelData=function(){var e=n.scene.boxingDuel;e.isValid()&&(e.update(),n.dashboardScreen.boxingDuelButton.updateData())},n.updateOffshoreRaceData=function(){var e=n.scene.offshoreRace;e.isValid()&&(e.update(),n.dashboardScreen.raceButton.updateData())},n.handleShowWeeklyTournamentNotification=function(){n.dashboardScreen.weeklyTournamentButton.showAttentionBadge()},n.handleShowBoxingDuelNotification=function(){n.dashboardScreen.boxingDuelButton.showAttentionBadge()},n.handleShowOffshoreRaceNotification=function(){n.dashboardScreen.raceButton.showAttentionBadge()},n.scene=t.scene,n.dashboardScreen=t,n.registerEventListeners(),n}(0,f.Z)(t,e);var n=t.prototype;return n.registerEventListeners=function(){var e=this;this.scene.events.on("refresh-event-toggle",(function(t){e.canRefresh=t})),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.refreshEventData,this),this.scene.weeklyTournament.events.on(Io,this.handleWeeklyTournamentScreen,this),this.scene.boxingDuel.events.on(Gi,this.handleBoxingDuelScreen,this),this.scene.offshoreRace.events.on(or,this.handleOffshoreRaceScreen,this),this.scene.weeklyTournament.events.on(Po,this.handleShowWeeklyTournamentNotification,this),this.scene.boxingDuel.events.on(Ni,this.handleShowBoxingDuelNotification,this),this.scene.offshoreRace.events.on(sr,this.handleShowOffshoreRaceNotification,this)},n.waitForAllScreensToDisplay=function(){return this.managerPromise},n.processShowScreens=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.screenQueue.length){e.next=3;break}return this.emit("all-screens-displayed"),e.abrupt("return",Promise.resolve());case 3:if(!this.currentScreenOpenPromise){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this.dashboardScreen.isScreenOpen){e.next=7;break}return e.abrupt("return",Promise.resolve());case 7:if(this.managerPromise=new Promise((function(e){r.on("all-screens-displayed",(function(){e()}))})),t=this.screenQueue.sort((function(e,t){return e.priority-t.priority})),!(n=t.shift())){e.next=19;break}return i=n.screenKey,this.currentScreenOpenPromise=this.scene.screen.openAsync(i),e.next=15,this.currentScreenOpenPromise;case 15:return e.next=17,(0,me.qZ)(500);case 17:this.currentScreenOpenPromise=void 0,this.processShowScreens();case 19:return e.abrupt("return",Promise.resolve());case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.pushScreenKeyToQueue=function(e,t){if(e){if(this.screenQueue.find((function(t){return t.screenKey===e})))return;this.screenQueue.push({screenKey:e,priority:t})}},n.getWeeklyTournamentScreenKey=function(){return this.scene.weeklyTournament.isValid(),""},n.getBoxingDuelScreenKey=function(){return this.scene.boxingDuel.isValid(),""},n.getRaceScreenKey=function(){return this.scene.offshoreRace.isValid(),""},t}(Phaser.Events.EventEmitter),yP=vP,EP=Ki.Z.DASHBOARD,CP=EP.KEY,wP=EP.FRAME,AP=1750280,bP=10620447,SP=7999138,TP=function(e){function t(t,n){var i;return void 0===n&&(n=.925),(i=e.call(this,t,66,206/3,n)||this).scene=void 0,i.levelText=void 0,i.button=void 0,i.scene=t,i.setName("Level"),i.create(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.runClaimItemsAnimation=function(){var e=this;this.scene.add.tween({targets:this,duration:75,scale:.925,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS)},onComplete:function(){e.scene.add.tween({targets:e,duration:75,scale:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})}})},n.setLevel=function(e){this.levelText.setText(e.toString())},n.setDifficulty=function(e){var t=wP.LEVEL_BUTTON.NORMAL,n=AP;switch(e){case Jh.NORMAL:t=wP.LEVEL_BUTTON.NORMAL;break;case Jh.HARD:t=wP.LEVEL_BUTTON.HARD,n=bP;break;case Jh.SUPER_HARD:t=wP.LEVEL_BUTTON.SUPER_HARD,n=SP}this.button.setFrame(t),this.levelText.setStrokeBlurColor(n)},n.create=function(){this.createButton(),this.createText()},n.createButton=function(){var e=this.scene.add.image(0,0,CP,wP.LEVEL_BUTTON.NORMAL);e.setDefaultWorldSize(),this.add(e),this.button=e},n.createText=function(){var e=new Qp(this.scene,{text:"11",fontSize:this.scene.fontSize(20),fillColor:16776957,strokeBlur:2,strokeBlurColor:1750280,strokeBlurAlpha:.7});e.setPosition(-3,.5),this.add(e),this.levelText=e},t}(jp.Z),xP=TP,kP=Ki.Z.DASHBOARD,PP=kP.KEY,IP=kP.FRAME,OP=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).scene=void 0,r.levelButton=void 0,r.journeyButton=void 0,r.challengeButton=void 0,r.weeklyTournamentButton=void 0,r.boxingDuelButton=void 0,r.raceButton=void 0,r.locationButton=void 0,r.eventButtonsManager=void 0,r.eventsManager=void 0,r.title=void 0,r.blackBackground=void 0,r.guideContainer=void 0,r.canOpenResScrnFirstTime=void 0,r.exitAnimation=void 0,r.contentExitAnimation=void 0,r.isScreenOpen=void 0,r.dataBeforeClaimJourney=void 0,r.handleOpenLevelNextStep=void 0,r.isScreenContentOpen=void 0,r.settingsMenu=void 0,r.backToDashboard=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.eventsManager.displayAllEventScreens();case 2:case"end":return e.stop()}}),e)}))),r.updateWeeklyTournamentButtonVisibility=function(){r.scene.weeklyTournament.isValid()?r.weeklyTournamentButton.revive():r.weeklyTournamentButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.updateOffshoreRaceButtonVisibility=function(){r.scene.offshoreRace.isValid()?r.raceButton.revive():r.raceButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.updateBoxingDuelButtonVisibility=function(){r.scene.boxingDuel.isValid()?r.boxingDuelButton.revive():r.boxingDuelButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.handleSettingsMenuAutoClose=function(e){r.settingsMenu.getBounds().contains(e.worldX,e.worldY)||r.settingsMenu.closeSettings()},r.handleOpenLevel=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.scene.locationManager.isOpening){e.next=4;break}return e.next=3,r.scene.locationManager.runExitLocationContentsAnimation();case 3:r.scene.locationManager.isOpening=!1;case 4:r.scene.screen.close(r.name),r.scene.gameplay.processStartLevel();case 6:case"end":return e.stop()}}),e)}))),r.handleOpenShop=function(){},r.handleOpenJourneyScreen=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),r.scene.gameUI.starBarButton.setDepth(Ha.Z.BUTTON),t&&r.scene.screen.close(r.name),r.scene.journeyDataService.updateData(),e.next=6,r.scene.requireTextureAsync("JOURNEY");case 6:r.scene.screen.open(de.o4.JOURNEY_SCREEN,{shouldCloseAfterComplete:t});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleOpenDecorationScreen=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setDisableButtons(!0),r.scene.events.emit(pi.LOCATION_DECORATION_OPEN),r.runContentExitAnimation(),e.next=5,r.runEventButtonsExitAnimation();case 5:return r.isScreenContentOpen=!1,r.scene.events.emit("refresh-event-toggle",!1),e.next=9,r.scene.locationManager.open();case 9:case"end":return e.stop()}}),e)}))),r.handleCloseDecorationScreenCompleted=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return r.handleOpenLevel(),r.scene.locationManager.isGuided=!1,r.guideContainer.hideGuide(),e.abrupt("return");case 5:r.updateLocationButton(),r.runContentEntranceAnimation(),r.runEventButtonsEntranceAnimation(),r.isScreenContentOpen=!0,r.scene.events.emit("refresh-event-toggle",!0),r.setDisableButtons(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleOpenChallengeScreen=function(){r.scene.screen.open(de.o4.CHALLENGE_WELCOME_SCREEN,{header:"1vs1 Challenge",description:"Play with friends to\nearn more coins"})},r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(r)),r.isScreenOpen=!1},r.scene=t,r.background.kill(),r.dataBeforeClaimJourney=void 0,r.create(),r.scene.events.emit("refresh-event-toggle",!0),r.scene.events.on(pi.OPEN_PLAY_SCREEN_FROM_DASHBOARD,r.handleOpenLevel,(0,yc.Z)(r)),r.zone.disableInteractive(),r.listenEvents(),r.challengeButton.kill(),r}(0,f.Z)(t,e);var n=t.prototype;return n.getCanOpenPrevClgRes=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canOpenResScrnFirstTime){e.next=2;break}return e.abrupt("return",!0);case 2:return t=new Promise((function(e){return setTimeout((function(){return e(!1)}),2e3)})),n=new Promise((function(e){i.scene.events.once(pi.PLAYER_FINISH_CHALLENGE,(function(){return e(!0)}))})),e.abrupt("return",Promise.race([t,n]));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleOpenChallengeResult=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(de.o4.CHALLENGE_RESULT_SCREEN)){e.next=3;break}return e.abrupt("return");case 3:return this.scene.screen.open(de.o4.CHALLENGE_RESULT_SCREEN),e.abrupt("return",new Promise((function(e){t.on(GameCore.Screens.Events.CLOSE,(function(){e()}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.eventButtonsManager=new iP(this),this.eventsManager=new yP(this),this.createTitle(),this.createCoinProgress(),this.createTournamentButton(),this.createOffshoreRaceButton(),this.createBoxingDuelButton(),this.createShopButton(),this.createChallengeButton(),this.createLevelButton(),this.createSettingsMenu(),this.createJourneyButton(),this.createLocationMapButton(),this.createBlackBackground(),this.createGuideContainer(),this.alignLocationMapButton(),this.levelButton.onClick=this.handleOpenLevel,this.weeklyTournamentButton.onClick=this.weeklyTournamentButton.handleOnButtonClicked,this.boxingDuelButton.onClick=this.boxingDuelButton.handleOnButtonClicked,this.raceButton.onClick=this.raceButton.handleOnButtonClicked,this.journeyButton.onClick=this.handleOpenJourneyScreen,this.locationButton.onClick=this.handleOpenDecorationScreen,this.challengeButton.onClick=this.handleOpenChallengeScreen},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s,o,c,h,u,l,d,p,f;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpen){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:return e.prototype.open.call(this,n),this.isScreenOpen=!0,this.scene.offshoreRace.setShouldCheckTime(!0),this.scene.gameUI.starBarButton.setDepth(Ha.Z.BUTTON),this.setDisableButtons(!0),this.scene.setBackgroundWithFadeAnimation(),this.dataBeforeClaimJourney&&(n=this.dataBeforeClaimJourney,this.dataBeforeClaimJourney=void 0),r=null!=(i=n)?i:{},s=r.shouldPlusEventScore,o=void 0!==s&&s,c=r.canShowWelcomeBackScreen,h=void 0!==c&&c,u=r.openLevelNextStep,l=void 0!==u&&u,d=r.reopenLocation,p=void 0!==d&&d,this.handleOpenLevelNextStep=l,this.updateData(),this.updateEventButtonsVisibility(),t.next=15,this.updateLocationButton();case 15:return t.next=17,this.scene.locationManager.updateData();case 17:if(this.handleOpenLevelNextStep||(this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON),this.scene.gameUI.starBarButton.setDisabled(!1)),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.scene.gameUI.showStar(),this.runEntrancesAnimation(),!p){t.next=27;break}return t.next=26,this.handleOpenDecorationScreen();case 26:return t.abrupt("return");case 27:if(this.runContentEntranceAnimation(),this.runEventButtonsEntranceAnimation(),!o){t.next=33;break}return this.scene.showTournamentShareDialog(!1),t.next=33,this.runPlusScoreEvents();case 33:if(this.scene.events.emit("refresh-event-toggle",!0),!h){t.next=39;break}return t.next=37,(0,gl.Z)(this.scene,750);case 37:return t.next=39,this.scene.screen.openAsync(de.o4.WELCOME_BACK_SCREEN);case 39:if(!(f=this.guideContainer.guideManager).canPlayLocationDecorationGuide()){t.next=46;break}return this.scene.gameUI.setDisableButtons(!0),t.next=44,(0,gl.Z)(this.scene,750);case 44:return t.next=46,f.playLocationDecorationGuide();case 46:if(!this.handleOpenLevelNextStep){t.next=51;break}return t.next=49,(0,gl.Z)(this.scene,750);case 49:this.handleOpenLevel(),this.handleOpenLevelNextStep=!1;case 51:this.scene.turnOnBackgroundMusic(),this.setDisableButtons(!1);case 53:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateEventButtonsVisibility=function(){[this.scene.weeklyTournament.isValid(),this.scene.offshoreRace.isValid(),this.scene.boxingDuel.isValid()].some((function(e){return e}))&&this.scene.requireTextureAsync("EVENT_BOARD",!1),this.updateWeeklyTournamentButtonVisibility(),this.updateOffshoreRaceButtonVisibility(),this.updateBoxingDuelButtonVisibility()},n.runPlusScoreEvents=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.weeklyTournament,i=t.boxingDuel,r=t.offshoreRace,s=[{timeout:function(){return n.isTournamentTimeOut()},update:function(){return h.eventsManager.updateWeeklyTournamentData()},score:function(){return h.scene.gameplay.eventManager.getWeeklyTournamentItemAmount()},button:this.weeklyTournamentButton},{timeout:function(){return i.isTimeout()},update:function(){return h.eventsManager.updateBoxingDuelData()},score:function(){return h.scene.gameplay.eventManager.getBoxingDuelItemAmount()},button:this.boxingDuelButton},{timeout:function(){return r.isTimeout()},update:function(){return h.eventsManager.updateOffshoreRaceData()},score:function(){return h.scene.gameplay.eventManager.getRaceItemAmount()},button:this.raceButton}],o=s.map((function(e){var t=e.timeout,n=e.update,i=e.score,r=e.button;return t()?(n(),null):{score:i(),button:r}})).filter((function(e){return null!==e})),!o.some((function(e){return e&&e.score>0}))){e.next=10;break}return c=500,e.next=8,(0,me.qZ)(300);case 8:this.bringToTop(this.eventButtonsManager.box),o.forEach((function(e){e&&e.score>0&&(h.eventButtonsManager.box.bringButtonToTop(e.button.buttonType),e.button.runPlusScoreAnimation(e.score,c),c+=150)}));case 10:return e.next=12,Promise.all(s.map((function(e){return e.button.plusScoreAnimationPromise})));case 12:s.forEach((function(e){var t=e.score,n=e.button;t()>0&&n.showAttentionBadge()}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.setDisableButtons(!0),this.runCloseAnimation(),this.scene.gameUI.hideLife()},n.updateData=function(){var e,t,n=this.scene.level.getLevel(),i=null!=(e=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty)?e:Jh.NORMAL,r=this.scene.player.getJourneyProgress().inProgressLocation;r&&(r.progress>=2*r.decorations.length&&this.scene.locationManager.preloadNextBackgroundAsync());this.levelButton.setLevel(n),this.levelButton.setDifficulty(i)},n.listenEvents=function(){this.scene.events.on(pi.BACK_TO_DASHBOARD,this.backToDashboard,this),this.scene.weeklyTournament.events.on(Oo,this.updateWeeklyTournamentButtonVisibility,this),this.scene.offshoreRace.events.on(cr,this.updateOffshoreRaceButtonVisibility,this),this.scene.boxingDuel.events.on(Zi,this.updateBoxingDuelButtonVisibility,this),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.handleSettingsMenuAutoClose,this)},n.runFadeBackground=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.blackBackground.revive(),this.blackBackground.alpha=t,e.next=4,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:r}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.setDisableButtons=function(e){var t=[this.levelButton,this.settingsMenu,this.challengeButton,this.locationButton,this.journeyButton,this.weeklyTournamentButton,this.raceButton,this.boxingDuelButton],n=t.map((function(e){return e.alpha}));this.levelButton.setDisabled(e),this.settingsMenu.setDisabled(e),this.challengeButton.setDisabled(e),this.locationButton.setDisabled(e),this.journeyButton.setDisabled(e),this.weeklyTournamentButton.setDisabled(e),this.raceButton.setDisabled(e),this.boxingDuelButton.setDisabled(e),t.forEach((function(e,t){e.active&&e.setAlpha(n[t])}))},n.updateLocationButton=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationButton.updateData();case 2:this.alignLocationMapButton();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntrancesAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.exitAnimation)||t.stop(),null==(n=this.contentExitAnimation)||n.stop(),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen),(0,p.Z)({targets:[this.scene.locationManager]},Sv.tweenConfigs.screen.configOpen)]}),this.onEntranceCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runContentEntranceAnimation=function(){var e=this,t=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsMenu,scale:1},{obj:this.challengeButton,scale:1},{obj:this.locationButton,scale:1}],n=this.scene.tweens.createTimeline({});t.forEach((function(e,t){var i=e.obj,r=e.scale;i.active&&(i.setVisible(!0),i.setScale(.75),n.add({targets:[i],props:{scale:r,alpha:1},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:0==t?0:"-=460"}))})),n.playAndWaitForCompletion().then((function(){e.isScreenContentOpen=!0}))},n.runContentExitAnimation=function(){this.settingsMenu.closeSettings();var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.locationButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsMenu,scale:1},{obj:this.challengeButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj;t.add({targets:[i],props:{scale:.75,alpha:0},duration:500,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460",onComplete:function(){i.setVisible(!1)}})})),t.play(),this.contentExitAnimation=t},n.runEventButtonsEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runEntranceAnimation(),n=this.boxingDuelButton.runEntranceAnimation(),i=this.raceButton.runEntranceAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEventButtonsExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runExitAnimation(),n=this.boxingDuelButton.runExitAnimation(),i=this.raceButton.runExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.exitAnimation=this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose),(0,p.Z)({targets:[this.scene.locationManager]},Sv.tweenConfigs.screen.configClose)]}),this.scene.locationManager.isOpening&&(this.scene.locationManager.runExitLocationContentsAnimation(),this.scene.locationManager.isOpening=!1),!this.isScreenContentOpen){e.next=7;break}return this.runContentExitAnimation(),e.next=6,this.runEventButtonsExitAnimation();case 6:this.isScreenContentOpen=!1;case 7:this.onExitCompleted();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=new pv(this.scene);e.setText("Location Name"),e.setFontSize(32),e.setColor(7162732),e.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-244),this.title=e},n.createCoinProgress=function(){var e=new Kx(this.scene);e.setName("CoinProgress"),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-5)},n.createTournamentButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.WEEKLY_TOURNAMENT);e.kill(),e.setAlpha(0),e.setScale(.75),this.weeklyTournamentButton=e},n.createBoxingDuelButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.BOXING_DUEL);e.kill(),e.setAlpha(0),e.setScale(.75),this.boxingDuelButton=e},n.createOffshoreRaceButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.OFFSHORE_RACE);e.kill(),e.setAlpha(0),e.setScale(.75),this.raceButton=e},n.createShopButton=function(){},n.createChallengeButton=function(){var e=new Vc.Z(this.scene,PP,IP.ICON.CHALLENGE,70,70);e.setName("Challenge"),this.add(e),Phaser.Display.Align.In.TopLeft(e,this,-8,-180),this.challengeButton=e;var t=new pv(this.scene);t.setText("Challenge"),t.setFontSize(10),t.setCenterAlign(),t.setColor(7162732),t.setY(30),e.add(t)},n.createLevelButton=function(){var e=new xP(this.scene);this.add(e),Phaser.Display.Align.In.BottomRight(e,this,-7,-8),this.levelButton=e,this.levelButton.setVisible(!1)},n.createSettingsMenu=function(){this.settingsMenu=new Ck(this.scene,!0,!1),this.settingsMenu.setName("SettingsMenu"),Phaser.Display.Align.In.TopRight(this.settingsMenu,this,-5,0),this.add(this.settingsMenu),this.settingsMenu.close(0)},n.createLocationMapButton=function(){var e=new gP(this.scene);this.add(e),this.locationButton=e,this.locationButton.setVisible(!1)},n.createJourneyButton=function(){var e=new Vc.Z(this.scene,PP,IP.BUTTON.JOURNEY,200/3,67);e.setName("Journey"),this.add(e),Phaser.Display.Align.In.BottomLeft(e,this,-5,-5),this.journeyButton=e,this.journeyButton.kill()},n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,oe.Z.OVERLAY.KEY),this.blackBackground.setName("Black Background"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),this.add(this.blackBackground),Phaser.Display.Align.In.Center(this.blackBackground,this),Ap.Z.registerObject(this.blackBackground,de.MR.MULTIPLY_ALPHA)},n.createGuideContainer=function(){this.guideContainer=new rk(this.scene),this.guideContainer.setName("GuideContainer"),this.add(this.guideContainer)},n.alignLocationMapButton=function(){var e=-this.width/2+this.locationButton.width/2+6,t=this.journeyButton.y+this.journeyButton.height/2-this.locationButton.height/2-3.2;this.locationButton.setPosition(e,t)},t}(GameCore.Screen),RP=OP,BP=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).maxValue=void 0,r.key=void 0,r.frames=void 0,r.bar=void 0,r.icon=void 0,r.button=void 0,r.value=void 0,r.key=n,r.frames=i,r.maxValue=1e6,r.setSize(100,28),r.createBar(),r.createValue(),r.createIcon(),r.createButton(),r.scene.add.existing((0,yc.Z)(r)),r.setValue(0),r}(0,f.Z)(t,e);var n=t.prototype;return n.setValue=function(e){var t=GameCore.Utils.Number.formatNumber(e);this.value.setText(t)},n.getValueLength=function(){return this.value.text.length},n.alignObject=function(){this.icon.setX(-this.width/2+10),this.value.setX(-this.width/2+this.bar.displayWidth/2+13),this.button&&Phaser.Display.Align.In.RightCenter(this.button,this.bar),Phaser.Display.Align.In.LeftCenter(this.bar,this)},n.createBar=function(){var e=this.scene.make.nineslice({key:this.key,frame:this.frames.background,width:91,height:25.5,leftWidth:10,rightWidth:10});e.setOrigin(0,.5),this.add(e),this.bar=e},n.createValue=function(){this.value=new Qp(this.scene,{text:"",fontSize:this.scene.fontSize(16),strokeColor:0,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.add(this.value)},n.createIcon=function(){this.icon=this.scene.add.image(0,0,this.key,this.frames.icon),this.add(this.icon)},n.createButton=function(){this.frames.button&&this.scene.ads.enabled&&(this.button=this.scene.add.image(0,0,this.key,this.frames.button),this.add(this.button))},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(ae._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen)return e.getScreenName();e=e.parentContainer}return this.scene.getSceneName()},(0,X.Z)(t,[{key:"onClick",set:function(e){var t=this;this.scene.ads.enabled&&(this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t.logButtonEvent(),e(),t.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.BUTTON_CLICK)})))}}]),t}(Phaser.GameObjects.Container),DP=BP,LP=n(30),MP=Ki.Z.DASHBOARD,_P=MP.KEY,NP=MP.FRAME,GP=function(e){function t(t){var n;return(n=e.call(this,t,_P,{background:NP.BAR_VALUE.STAR,icon:NP.ICON.STAR})||this).scene=void 0,n.bounceTween=void 0,n.informationContainer=void 0,n.addIcon=void 0,n.bar.setSizeByWorld(290/3,23),n.scene=t,n.icon.setDefaultWorldSize(),n.value.setTint(16777215),n.value.setFontSize(14),n.setName("ScoreBar"),n.maxValue=1e6,n.align(),n.createInformationContainer(),n}(0,f.Z)(t,e);var n=t.prototype;return n.animateAddIcon=function(e,t){this.scene.add.tween({targets:this.informationContainer,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.setValue=function(e){var t="";t=e>=1e5?(0,LP.Z)(e):e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),this.value.setText(t)},n.updateBarSize=function(e,t){this.bar.setSizeByWorld(e,t)},n.align=function(){this.alignObject(),this.value.setY(.5),Phaser.Display.Align.In.LeftCenter(this.icon,this.bar,3,0)},n.getIconCoinPosition=function(){var e=this.icon.getWorldPosition();return{x:e.x-2,y:e.y-2.2}},n.getBarSize=function(){var e=this.bar;return{width:e.displayWidth,height:e.displayHeight}},n.getWorldPositionOfStar=function(){return this.icon.getWorldPosition()},n.getStarLabelPosition=function(){return this.value.getWorldPosition()},n.runBounceCoinTextAnimation=function(){var e,t;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this.value,scale:"+=0.2",yoyo:!0,repeat:2,ease:Phaser.Math.Easing.Sine.InOut,duration:180}))},n.createInformationContainer=function(){var e=this.scene.add.container(0,0);this.add(e),this.informationContainer=e,this.createAddIcon(),this.createInformationText(),Phaser.Display.Align.In.BottomRight(this.informationContainer,this.icon,4,1)},n.createAddIcon=function(){var e=this.scene.add.image(0,0,_P,NP.ICON.GREEN_CIRCLE);e.setDefaultWorldSize(),this.informationContainer.add(e),this.informationContainer.setSize(e.width,e.height),this.addIcon=e,Phaser.Display.Align.In.Center(e,this.informationContainer)},n.createInformationText=function(){var e=new Qp(this.scene,{text:"i",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.informationContainer.add(e),Phaser.Display.Align.In.Center(e,this.informationContainer)},t}(DP),FP=GP,ZP=Ki.Z.DASHBOARD,UP=ZP.KEY,WP=ZP.FRAME,YP=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.progressBar=void 0,r.progressBarBackground=void 0,r.progressBarFill=void 0,r.progressBarText=void 0,r.scene=t,r.setSize(n,109/3),r.create(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setProgressBarFill(0,10)},n.setProgressBarFill=function(e,t){var n=this.progressBarFill.displayHeight,i=this.width-11,r=Math.max(0,Math.min(e,t)),a=0===r?21:r===t?i:(0,rP.Z)(r,0,t,24,205);this.progressBarFill.setSizeByWorld(a,n),this.progressBarText.setText(Math.floor(r)+"/"+t)},n.create=function(){var e=this.scene.add.container(0,0);this.progressBarBackground=this.createProgressBarBackground(),this.progressBarFill=this.createProgressBarFill(),this.progressBarText=this.createProgressText(),this.progressBarText.setY(-1),e.add([this.progressBarBackground,this.progressBarFill,this.progressBarText]),this.add(e),this.progressBar=e},n.createProgressBarBackground=function(){return this.scene.make.nineslice({key:UP,frame:WP.JOURNEY.PROGRESS_BAR,width:this.width,height:119/3,leftWidth:10,rightWidth:10})},n.createProgressBarFill=function(){var e=this.scene.make.nineslice({key:UP,frame:WP.JOURNEY.PROGRESS_FILL,width:this.width-11,height:82/3,leftWidth:10,rightWidth:10});e.setOrigin(0,.5);var t=(this.progressBarBackground.displayWidth-e.displayWidth)/2;return e.setX(-this.progressBarBackground.displayWidth/2+t),e.setY(-1.4),e},n.createProgressText=function(){return new Qp(this.scene,{text:"1/10",fontSize:this.scene.fontSize(21),strokeColor:0,strokeThickness:1.5,strokeOffset:{y:.5},strokeAlpha:.5})},t}(Phaser.GameObjects.Container),HP=YP,zP=Ki.Z.DASHBOARD,KP=zP.KEY,VP=zP.FRAME,XP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.thumbnail=void 0,n.lock=void 0,n.overlay=void 0,n.thumbnailKey=void 0,n.previousEventName=void 0,n.loading=void 0,n.border=void 0,n.scene=t,n.create(),n.setSize(n.border.width,n.border.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateThumbnail=function(e,t){var n=this;if(null!==e){this.revive();var r=e.thumbnail,s=r.key,o=r.url,c=r.frame;""!==this.thumbnailKey&&this.thumbnailKey===s||(this.thumbnail.kill(),this.showLoading(!0)),this.thumbnailKey=s,this.scene.load.off(this.previousEventName);var h=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.thumbnail.kill(),n.showLoading(!0),t="filecomplete-image-"+s,!n.scene.textures.exists(s)){e.next=9;break}return n.thumbnail.setTexture(s,c),n.thumbnail.setWorldSize(n.background.width,n.background.height),n.showLoading(!1),n.thumbnail.revive(),e.abrupt("return");case 9:n.scene.load.image(s,o),n.scene.load.start(),n.scene.load.once(t,h),n.previousEventName=t;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();h(),t?(this.lock.revive(),this.overlay.revive()):(this.lock.kill(),this.overlay.kill())}else this.kill()},n.showLoading=function(e){this.loading.setVisible(e)},n.create=function(){this.createBackground(),this.createThumbnail(),this.createOverlay(),this.createLoading(),this.createBorder(),this.createLock()},n.createBackground=function(){var e=this.scene.add.image(0,0,KP,VP.JOURNEY.THUMBNAIL_BACKGROUND);e.setDefaultWorldSize(),this.add(e),this.background=e},n.createThumbnail=function(){var e=this.scene.add.image(0,0,KP,VP.JOURNEY.THUMBNAIL_BACKGROUND);e.setDefaultWorldSize(),this.add(e),this.thumbnail=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,KP,VP.JOURNEY.THUMBNAIL_OVERLAY);e.setDefaultWorldSize(),this.add(e),this.overlay=e},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(40,40),this.loading.setY(0),this.add(this.loading),this.showLoading(!1)},n.createBorder=function(){var e=this.scene.add.image(0,0,KP,VP.JOURNEY.THUMBNAIL_BORDER);e.setDefaultWorldSize(),this.add(e),this.border=e},n.createLock=function(){var e=this.scene.add.image(0,0,KP,VP.JOURNEY.THUMBNAIL_LOCK);e.setDefaultWorldSize(),this.add(e),this.lock=e},t}(Phaser.GameObjects.Container),jP=XP,qP=function(e){function t(t){var n;return(n=e.call(this,t,300,40)||this).scene=void 0,n.progressBar=void 0,n.currentThumbnail=void 0,n.nextThumbnail=void 0,n.scene=t,n.create(),n.alignItems(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.current,n=e.next;this.updateProgressBar(t),this.currentThumbnail.updateThumbnail(t,!1),this.nextThumbnail.updateThumbnail(n,!0),t.progressBar.currentProgress!==t.progressBar.maxProgress||n?this.revive():this.kill()},n.updateProgressBar=function(e){var t=e.progressBar;this.progressBar.setProgressBarFill(t.currentProgress,t.maxProgress)},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.currentThumbnail,this,0,-2),Phaser.Display.Align.In.RightCenter(this.nextThumbnail,this,0,-2)},n.create=function(){this.createCurrentMapThumbnail(),this.createNextMapThumbnail(),this.createProgressBar(),this.add([this.progressBar,this.currentThumbnail,this.nextThumbnail])},n.createProgressBar=function(){this.progressBar=new HP(this.scene,this.width-this.currentThumbnail.width,this.height)},n.createCurrentMapThumbnail=function(){this.currentThumbnail=new jP(this.scene)},n.createNextMapThumbnail=function(){this.nextThumbnail=new jP(this.scene)},t}(jp.Z),JP=qP,QP=Ki.Z.DASHBOARD,$P=QP.KEY,eI=QP.FRAME,tI=function(e){function t(t){var n;return(n=e.call(this,t,{key:$P,backgroundFrame:eI.LEVEL_BUTTON.NORMAL,buttonFrame:eI.LEVEL_BUTTON.NORMAL,buttonWidth:200,buttonHeight:71})||this).scene=void 0,n.levelText=void 0,n.widgetSparksPool=[],n.scene=t,n.button.setName("Level"),n.createText(),n.setSize(n.width,n.height),n.alignBackground(0,-1.5),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runClaimItemsAnimation=function(){var e=this;this.scene.add.tween({targets:this,duration:75,scale:.925,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS)},onComplete:function(){e.scene.add.tween({targets:e,duration:75,scale:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})}})},n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.createText=function(){var e=new Qp(this.scene,{text:"Level 1",fontSize:this.scene.fontSize(this.scene.lang.getFontSize("playButton")),strokeColor:1075202,strokeThickness:3.5,strokeOffset:{y:.8},strokeAlpha:.9});e.setY(-3),this.levelText=e,this.addIntoButton(e)},n.getWidgetSparks=function(){var e=this.widgetSparksPool.find((function(e){return!e.active}));return e||(e=this.createWidgetSparks(),this.widgetSparksPool.push(e)),e},n.createWidgetSparks=function(){var e=new Lk(this.scene);return this.add(e),e},t}(aT),nI=tI,iI=Ki.Z.DASHBOARD,rI=iI.KEY,aI=iI.FRAME,sI=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).scene=void 0,r.levelButton=void 0,r.shopButton=void 0,r.settingsButton=void 0,r.journeyButton=void 0,r.challengeButton=void 0,r.weeklyTournamentButton=void 0,r.boxingDuelButton=void 0,r.raceButton=void 0,r.eventButtonsManager=void 0,r.eventsManager=void 0,r.title=void 0,r.canOpenResScrnFirstTime=void 0,r.exitAnimation=void 0,r.contentExitAnimation=void 0,r.screensWillBeShown=void 0,r.isScreenOpen=void 0,r.dataBeforeClaimJourney=void 0,r.handleOpenLevelNextStep=void 0,r.backToDashboard=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.eventsManager.displayAllEventScreens();case 2:case"end":return e.stop()}}),e)}))),r.updateWeeklyTournamentButtonVisibility=function(){r.scene.weeklyTournament.isValid()?r.weeklyTournamentButton.revive():r.weeklyTournamentButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.updateOffshoreRaceButtonVisibility=function(){r.scene.offshoreRace.isValid()?r.raceButton.revive():r.raceButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.updateBoxingDuelButtonVisibility=function(){r.scene.boxingDuel.isValid()?r.boxingDuelButton.revive():r.boxingDuelButton.kill(),r.eventButtonsManager.alignButtonsBoxes()},r.handleOpenLevel=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.scene.gameplay.processStartLevel(),r.scene.screen.close(r.name);case 2:case"end":return e.stop()}}),e)}))),r.handleOpenShop=function(){},r.handleOpenJourneyScreen=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),t&&r.scene.screen.close(r.name),r.scene.journeyDataService.updateData(),e.next=5,r.scene.requireTextureAsync("JOURNEY");case 5:r.scene.screen.open(de.o4.JOURNEY_SCREEN,{shouldCloseAfterComplete:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleOpenChallengeScreen=function(){r.scene.screen.open(de.o4.CHALLENGE_WELCOME_SCREEN,{header:"1vs1 Challenge",description:"Play with friends to\nearn more coins"})},r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(r)),r.isScreenOpen=!1},r.scene=t,r.background.kill(),r.dataBeforeClaimJourney=void 0,r.create(),r.scene.events.emit("refresh-event-toggle",!0),r.zone.disableInteractive(),r.listenEvents(),r.challengeButton.kill(),r}(0,f.Z)(t,e);var n=t.prototype;return n.getCanOpenPrevClgRes=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canOpenResScrnFirstTime){e.next=2;break}return e.abrupt("return",!0);case 2:return t=new Promise((function(e){return setTimeout((function(){return e(!1)}),2e3)})),n=new Promise((function(e){i.scene.events.once(pi.PLAYER_FINISH_CHALLENGE,(function(){return e(!0)}))})),e.abrupt("return",Promise.race([t,n]));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleOpenChallengeResult=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(de.o4.CHALLENGE_RESULT_SCREEN)){e.next=3;break}return e.abrupt("return");case 3:return this.scene.screen.open(de.o4.CHALLENGE_RESULT_SCREEN),e.abrupt("return",new Promise((function(e){t.on(GameCore.Screens.Events.CLOSE,(function(){e()}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.eventButtonsManager=new iP(this),this.createTitle(),this.createCoinProgress(),this.createTournamentButton(),this.createOffshoreRaceButton(),this.createBoxingDuelButton(),this.createShopButton(),this.createChallengeButton(),this.createLevelButton(),this.createSettingsButton(),this.createJourneyButton(),this.createStarBar(),this.levelButton.onClick=this.handleOpenLevel,this.shopButton.onClick=this.handleOpenShop,this.weeklyTournamentButton.onClick=this.weeklyTournamentButton.handleOnButtonClicked,this.boxingDuelButton.onClick=this.boxingDuelButton.handleOnButtonClicked,this.raceButton.onClick=this.raceButton.handleOnButtonClicked,this.challengeButton.onClick=this.handleOpenChallengeScreen,this.journeyButton.onClick=this.handleOpenJourneyScreen},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s,o,c,h,u,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpen){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:if(e.prototype.open.call(this,n),this.isScreenOpen=!0,this.scene.offshoreRace.setShouldCheckTime(!0),this.setDisableButtons(!0),this.scene.setBackgroundWithFadeAnimation(),this.dataBeforeClaimJourney&&(n=this.dataBeforeClaimJourney,this.dataBeforeClaimJourney=void 0),r=null!=(i=n)?i:{},s=r.shouldPlusEventScore,o=void 0!==s&&s,c=r.canShowWelcomeBackScreen,h=void 0!==c&&c,u=r.openLevelNextStep,l=void 0!==u&&u,this.handleOpenLevelNextStep=l,this.updateData(),this.updateEventButtonsVisibility(),this.handleOpenLevelNextStep||(this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.BUTTON)),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.runEntrancesAnimation(),this.runContentEntranceAnimation(),!o){t.next=22;break}return this.scene.showTournamentShareDialog(!1),t.next=22,this.runPlusScoreEvents();case 22:if(this.scene.events.emit("refresh-event-toggle",!0),this.eventButtonsManager.showWarningBadgeOnEventButtons(),!h){t.next=29;break}return t.next=27,(0,gl.Z)(this.scene,750);case 27:return t.next=29,this.scene.screen.openAsync(de.o4.WELCOME_BACK_SCREEN);case 29:if(!this.handleOpenLevelNextStep){t.next=34;break}return t.next=32,(0,gl.Z)(this.scene,750);case 32:this.handleOpenLevel(),this.handleOpenLevelNextStep=!1;case 34:this.scene.turnOnBackgroundMusic(),this.setDisableButtons(!1);case 36:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateEventButtonsVisibility=function(){this.updateWeeklyTournamentButtonVisibility(),this.updateOffshoreRaceButtonVisibility(),this.updateBoxingDuelButtonVisibility()},n.runPlusScoreEvents=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.weeklyTournament,i=t.boxingDuel,r=t.offshoreRace,s=[{timeout:function(){return n.isTournamentTimeOut()},update:function(){return h.eventsManager.updateWeeklyTournamentData()},score:function(){return h.scene.gameplay.eventManager.getWeeklyTournamentItemAmount()},button:this.weeklyTournamentButton},{timeout:function(){return i.isTimeout()},update:function(){return h.eventsManager.updateBoxingDuelData()},score:function(){return h.scene.gameplay.eventManager.getBoxingDuelItemAmount()},button:this.boxingDuelButton},{timeout:function(){return r.isTimeout()},update:function(){return h.eventsManager.updateOffshoreRaceData()},score:function(){return h.scene.gameplay.eventManager.getRaceItemAmount()},button:this.raceButton}],o=s.map((function(e){var t=e.timeout,n=e.update,i=e.score,r=e.button;return t()?(n(),null):{score:i(),button:r}})).filter((function(e){return null!==e})),!o.some((function(e){return e&&e.score>0}))){e.next=10;break}return c=500,e.next=8,(0,me.qZ)(300);case 8:this.bringToTop(this.eventButtonsManager.box),o.forEach((function(e){e&&e.score>0&&(h.eventButtonsManager.box.bringButtonToTop(e.button.buttonType),e.button.runPlusScoreAnimation(e.score,c),c+=150)}));case 10:return e.next=12,Promise.all(s.map((function(e){return e.button.plusScoreAnimationPromise})));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.setDisableButtons(!0),this.runCloseAnimation(),this.scene.gameUI.hideLife()},n.updateData=function(){var e,t,n=this.scene.level.getLevel(),i=(null!=(e=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty)||Difficulty.NORMAL,this.scene.player.getJourneyProgress().inProgressLocation);i&&(i.progress>=2*i.decorations.length&&this.scene.locationManager.preloadNextBackgroundAsync());this.levelButton.setLevel(n)},n.listenEvents=function(){this.scene.events.on(pi.BACK_TO_DASHBOARD,this.backToDashboard,this),this.scene.weeklyTournament.events.on(Oo,this.updateWeeklyTournamentButtonVisibility,this),this.scene.offshoreRace.events.on(cr,this.updateOffshoreRaceButtonVisibility,this),this.scene.boxingDuel.events.on(Zi,this.updateBoxingDuelButtonVisibility,this)},n.setDisableButtons=function(e){this.levelButton.setDisabled(e),this.settingsButton.setDisabled(e),this.challengeButton.setDisabled(e),this.journeyButton.setDisabled(e),this.weeklyTournamentButton.setDisabled(e),this.raceButton.setDisabled(e),this.boxingDuelButton.setDisabled(e),this.levelButton.setAlpha(1),this.settingsButton.setAlpha(1),this.challengeButton.setAlpha(1),this.journeyButton.setAlpha(1),this.weeklyTournamentButton.setAlpha(1),this.raceButton.setAlpha(1),this.boxingDuelButton.setAlpha(1)},n.runEntrancesAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.exitAnimation)||t.stop(),null==(n=this.contentExitAnimation)||n.stop(),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]}),e.next=5,this.runEventButtonsEntranceAnimation();case 5:this.onEntranceCompleted();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runContentEntranceAnimation=function(){var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsButton,scale:1},{obj:this.shopButton,scale:1},{obj:this.challengeButton,scale:1},{obj:this.weeklyTournamentButton,scale:1},{obj:this.raceButton,scale:1},{obj:this.boxingDuelButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,r=e.scale;i.setScale(.75),t.add({targets:[i],props:{scale:r,alpha:1},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460"})})),t.playAndWaitForCompletion().then((function(){}))},n.runContentExitAnimation=function(){var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsButton,scale:1},{obj:this.shopButton,scale:1},{obj:this.challengeButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj;t.add({targets:[i],props:{scale:.75,alpha:0},duration:500,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460"})})),t.play(),this.contentExitAnimation=t},n.runEventButtonsEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runEntranceAnimation(),n=this.boxingDuelButton.runEntranceAnimation(),i=this.raceButton.runEntranceAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEventButtonsExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runExitAnimation(),n=this.boxingDuelButton.runExitAnimation(),i=this.raceButton.runExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.exitAnimation=this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)]}),this.runContentExitAnimation(),e.next=4,this.runEventButtonsExitAnimation();case 4:this.onExitCompleted();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=new pv(this.scene);e.setText("Location Name"),e.setFontSize(32),e.setColor(7162732),e.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-244),this.title=e},n.createCoinProgress=function(){var e=new Kx(this.scene);e.setName("CoinProgress"),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-5)},n.createTournamentButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.WEEKLY_TOURNAMENT);e.kill(),this.weeklyTournamentButton=e},n.createBoxingDuelButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.BOXING_DUEL);e.kill(),this.boxingDuelButton=e},n.createOffshoreRaceButton=function(){var e=this.eventButtonsManager.getButtonByType(nP.OFFSHORE_RACE);e.kill(),this.raceButton=e},n.createShopButton=function(){},n.createChallengeButton=function(){var e=new Vc.Z(this.scene,rI,aI.ICON.CHALLENGE,70,70);e.setName("Challenge"),this.add(e),Phaser.Display.Align.In.TopLeft(e,this,-8,-180),this.challengeButton=e;var t=new pv(this.scene);t.setText("Challenge"),t.setFontSize(10),t.setCenterAlign(),t.setColor(7162732),t.setY(30),e.add(t)},n.createLevelButton=function(){var e=new nI(this.scene);this.add(e),Phaser.Display.Align.In.Center(e,this,0,150),this.levelButton=e},n.createSettingsButton=function(){var e=this;this.settingsButton=new ov.Z(this.scene,{key:rI,frame:aI.BUTTON.SETTING,width:100/3,height:104/3,paddingZone:30}),this.settingsButton.setName("DashboardSettings"),this.add(this.settingsButton),Phaser.Display.Align.In.TopRight(this.settingsButton,this,-8,-9),this.settingsButton.onClick=function(){e.scene.screen.open(de.o4.DASHBOARD_SETTINGS_SCREEN)}},n.createStarBar=function(){var e=new FP(this.scene);this.add(e),Phaser.Display.Align.To.LeftCenter(e,this.settingsButton,-10,0)},n.createJourneyButton=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new JP(this.scene)).setName("Journey"),this.add(t),Phaser.Display.Align.In.Center(t,this,0,60),this.journeyButton=t;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(GameCore.Screen),oI=sI,cI=GameCore.layoutInitializer.isLandscape?RP:oI,hI=Ki.Z.DASHBOARD,uI=hI.KEY,lI=hI.FRAME,dI={width:90,height:94/3},pI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.titleBorder=void 0,n.scene=t,n.setSize(90,94/3),n.createTitleBorder(),n.createTitleText(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateTitle=function(e,t){this.titleText.setText(e+". "+t),this.titleBorder.setSizeByWorld(this.titleText.width+30,dI.height)},n.createTitleBorder=function(){var e=this.scene.make.nineslice({key:uI,frame:lI.DECOR.TITLE_BORDER,leftWidth:20,rightWidth:20,width:dI.width,height:dI.height});this.add(e),this.titleBorder=e,this.setSize(e.displayWidth,e.displayHeight)},n.createTitleText=function(){var e=new Qp(this.scene,{text:"Paris",fontSize:this.scene.fontSize(18),fillColor:11102533});e.setY(-1),this.add(e),this.titleText=e},t}(Phaser.GameObjects.Container),fI=pI,mI=Ki.Z.DASHBOARD,gI=mI.KEY,vI=mI.FRAME,yI=function(e){function t(t){var n;return(n=e.call(this,t,118,170/3,.925)||this).scene=void 0,n.text=void 0,n.alert=void 0,n.scene=t,n.setName("NextJourney"),n.create(),n.alignItems(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.text,this,15),Phaser.Display.Align.In.TopRight(this.alert,this,1,1)},n.create=function(){this.createButton(),this.createText(),this.createAlert()},n.createButton=function(){var e=this.scene.make.nineslice({key:gI,frame:vI.DECOR.LOCATION_BUTTON,leftWidth:45,rightWidth:20,width:this.width,height:this.height});this.add(e)},n.createText=function(){var e=new Qp(this.scene,{text:"Next\nJourney",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setCenterAlign(),e.setPosition(0,0),this.add(e),this.text=e},n.createAlert=function(){var e=this.scene.add.image(0,0,Ki.Z.DASHBOARD.KEY,Ki.Z.DASHBOARD.FRAME.DECOR.ALERT);e.setDefaultWorldSize(),this.add(e),this.alert=e},t}(jp.Z),EI=yI,CI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.image=void 0,n.imageOriginX=void 0,n.imageOriginY=void 0,n.scene=t,n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.getImageOrigin=function(){return{x:this.imageOriginX,y:this.imageOriginY}},n.getImageWidth=function(){return this.image.width},n.getImageHeight=function(){return this.image.height},n.isImageShow=function(){return this.image.visible&&this.image.active},n.hideImage=function(){this.image.kill(),this.image.setAlpha(0)},n.showImage=function(){this.image.revive(),this.image.setAlpha(1)},n.runHideImage=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.image,scale:0,duration:300,ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.hideImage()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runShowImage=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=1/GameCore.ImageScale,e.next=4,this.scene.tweens.add({targets:this.image,scale:{from:0,start:0,to:n},duration:300,delay:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){i.showImage()}}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createFrame=function(e,t,n,i){this.image=this.scene.add.image(0,0,e,t);var r=this.scene.textures.getFrame(e,t);this.imageOriginX=n,this.imageOriginY=1-i/(r.height/2),this.image.setOrigin(this.imageOriginX,this.imageOriginY),this.image.setDefaultWorldSize(),this.add(this.image);var a=(0,rP.Z)(this.imageOriginX,0,1,-this.image.width/2,this.image.width/2),s=(0,rP.Z)(this.imageOriginY,0,1,-this.image.height/2,this.image.height/2);this.image.setPosition(a,s),this.hideImage(),this.setSize(this.image.width,this.image.height)},t}(Phaser.GameObjects.Container),wI=CI,AI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.spineTop=void 0,n.key=void 0,n.decorationName=void 0,n.frames=void 0,n.decorationFrames=[],n.loading=void 0,n.scene=t,n.setSize(100,100),n.key="",n.decorationName="",n.create(),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.resetDecorationFrames=function(){this.decorationFrames.forEach((function(e){e.hideImage()})),this.key="",this.decorationName=""},n.hide=function(){this.decorationFrames.forEach((function(e){e.kill()}))},n.showDecorationBuilt=function(e){if(0!==e){var t=e-1;this.reviveWithTween(this.decorationFrames[t])}},n.reviveWithTween=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isImageShow()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.waitForLoadingToFinish();case 4:this.scene.tweens.add({targets:t,alpha:{from:0,start:0,to:1},duration:400,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){t.showImage()}});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateDecoration=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.file,s=n.decorations,o=t.toLowerCase(),i>0&&!this.scene.textures.exists(o)&&(this.setLoadingPosition(n,i),this.animateLoading(!0)),e.next=5,this.scene.requireDecorationTextureAsync(t);case 5:return e.next=7,this.updateDecorationFrames(t,r,s);case 7:this.animateLoading(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.setLoadingPosition=function(e,t){var n=e.decorations[t-1],i=n.x,r=n.y,a=n.width,s=n.height,o=n.offsetX,c=this.calculateLocalPosition(i,r),h=a/GameCore.ImageScale,u=s/GameCore.ImageScale,l=(0,rP.Z)(o,0,1,-h/2,h/2);this.loading.setPosition(c.x+h/2+l,c.y+u/2)},n.updateDecorationFrames=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.key!==t||this.decorationName!==n){e.next=2;break}return e.abrupt("return");case 2:this.key=t,this.decorationName=n,r=n+"-1",s=n+"-2",o=n+"-3",this.frames=[r,s,o],this.decorationFrames.forEach((function(e,t){e.revive();var n=h.frames[t];e.createFrame(h.key,n,i[t].offsetX,i[t].offsetY);var r=h.calculateLocalPosition(i[t].x,i[t].y),a=e.displayWidth/2,s=e.displayHeight/2;e.setPosition(r.x+a,r.y+s)})),c=this.decorationFrames.reduce((function(e,t){return t.displayWidth>e.displayWidth?t:e}),this.decorationFrames[0]),this.setSize(c.displayWidth,c.displayHeight);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.calculateLocalPosition=function(e,t){var n=e/3-(800-this.scene.gameZone.width)/2,i=t/3;return this.parentContainer.getLocalPoint(n,i)},n.updateDepth=function(){var e=this;this.spineTop&&this.spineTop.setDepth(1),this.decorationFrames.forEach((function(t){e.sendToBack(t)}))},n.playUpgradeAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.spineTop){e.next=4;break}return e.next=3,this.scene.requireSpineAsync("CHANGE_VFX_SPINE");case 3:this.createSpineTop();case 4:if(this.scene.vibration.performVibrating(50),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.UPGRADE_DECORATION,{},!0),1!==t){e.next=11;break}return e.next=9,this.playDecorationFrameUpgradeAnimation(void 0,this.decorationFrames[0]);case 9:e.next=19;break;case 11:if(2!==t){e.next=16;break}return e.next=14,this.playDecorationFrameUpgradeAnimation(this.decorationFrames[0],this.decorationFrames[1]);case 14:e.next=19;break;case 16:if(3!==t){e.next=19;break}return e.next=19,this.playDecorationFrameUpgradeAnimation(this.decorationFrames[1],this.decorationFrames[2]);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playDecorationFrameUpgradeAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.gameplay.spineManager,r=(0,rP.Z)(n.getImageOrigin().x,0,1,-n.getImageWidth()/2,n.getImageWidth()/2),this.spineTop.setPosition(n.x-7+r,n.y+n.displayHeight/3),i.playAnimation(this.spineTop,Xu.CHANGE_VFX.CHANGE_TOP),n.hideImage(),s=Promise.resolve(),Promise.resolve(),t&&(s=t.runHideImage()),o=n.runShowImage(t?400:300),e.next=11,Promise.all([s,o]);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.waitForLoadingToFinish=function(){var e=this;return new Promise((function(t){!function n(){e.loading.visible?e.scene.time.delayedCall(50,n,[],e):t()}()}))},n.create=function(){this.createLoading(),this.createDecorationFrame()},n.createSpineTop=function(){var e=this.scene.add.spine(0,0,Ki.Z.CHANGE_VFX_SPINE.DATA_KEY,Ki.Z.CHANGE_VFX_SPINE.ATLAS_KEY),t=1/GameCore.ImageScale;e.setScale(t),this.spineTop=e,this.spineTop.setPosition(-7,50),this.add(e)},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setWorldSize(20,20),this.loading.setVisible(!1),this.add(this.loading)},n.animateLoading=function(e){this.loading.setVisible(e)},n.createDecorationFrame=function(){var e=this;this.decorationFrames=new Array(3).fill(null).map((function(){var t=new wI(e.scene);return e.add(t),t}))},t}(Phaser.GameObjects.Container),bI=AI,SI=Ki.Z.DASHBOARD,TI=SI.KEY,xI=SI.FRAME,kI=function(e){function t(t){var n;return(n=e.call(this,t,0,0,.925)||this).scene=void 0,n.upgradeOffDots=void 0,n.upgradeOnDots=void 0,n.costText=void 0,n.scene=t,n.setName("DecorationUpgrade"),n.createButton(),n.createUpgradeOffDots(),n.createUpgradeOnDots(),n.createStarIcon(),n.createCostText(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateLevel=function(e){this.upgradeOnDots.forEach((function(t,n){var i=n<e;t.setVisible(i)}))},n.setCost=function(e){0!==e&&this.costText.setText(e.toString())},n.createButton=function(){var e=this.scene.add.image(0,0,TI,xI.BAR_VALUE.UPGRADE);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createUpgradeOffDots=function(){var e=this,t=new Array(3).fill(0).map((function(t,n){var i=e.scene.add.image(0,0,TI,xI.UPGRADE_OFF);return i.setOrigin(.5,.5),i.setDefaultWorldSize(),e.add(i),i}));t.forEach((function(t,n){var i=8*(n-1);t.setPosition(i,-e.height/2+t.height/2+3.5)})),this.upgradeOffDots=t},n.createUpgradeOnDots=function(){var e=this,t=new Array(3).fill(0).map((function(t,n){var i=e.scene.add.image(0,0,TI,xI.UPGRADE_ON);return i.setOrigin(.5,.5),i.setDefaultWorldSize(),i.setVisible(!1),e.add(i),i}));t.forEach((function(t,n){t.setPosition(e.upgradeOffDots[n].x,e.upgradeOffDots[n].y)})),this.upgradeOnDots=t},n.createStarIcon=function(){var e=this.scene.add.image(0,0,TI,xI.ICON.SMALL_STAR);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.Center(e,this,-6,2.5)},n.createCostText=function(){var e=new Qp(this.scene,{text:"2",fontSize:this.scene.fontSize(15),fillColor:11102533});this.add(e),Phaser.Display.Align.In.Center(e,this,10,3),this.costText=e},t}(jp.Z),PI=kI,II=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.upgradeButton=void 0,n.spineClicked=!1,n.buildingData=void 0,n.decorationId=void 0,n.isDraggable=!1,n.decoration=void 0,n.isDecorationDraggable=!1,n.canUpgrade=void 0,n.handleDecorationUpgradeButtonOnClick=(0,i.Z)(a().mark((function e(){var t,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.spineClicked&&n.canUpgrade){e.next=2;break}return e.abrupt("return");case 2:if(n.spineClicked=!0,t=n.buildingData.level,i=n.scene.player.getStar(),r=n.getNextLevelCost(t),!(i<r)){e.next=11;break}return n.spineClicked=!1,n.scene.events.emit(pi.CANNOT_UPGRADE_DECORATION),n.scene.screen.open(de.o4.GET_MORE_STARS_SCREEN),e.abrupt("return");case 11:return n.scene.player.setStar(i-r),n.buildingData.level+=1,n.scene.journey.updateDecorationData(n.decorationId,n.buildingData.level),n.scene.journey.events.emit(pi.DECORATION_UPGRADE),n.scene.logEconomy.logUseItem(yl.STAR,r,Cl.USE_STORAGE_ITEM),n.updateUpgradeButton(n.buildingData.level),2===t&&n.runDecorationUpgradeButtonExitAnimation(),e.next=20,n.decoration.playUpgradeAnimation(n.buildingData.level);case 20:n.updateUpgradeButtonVisibility(n.buildingData.level),n.scene.journey.events.emit(pi.DECORATION_UPGRADED),n.spineClicked=!1;case 23:case"end":return e.stop()}}),e)}))),n.onDragStart=function(){n.isDraggable=!0},n.onDrag=function(e){if(n.isDraggable){var t=n.scene.locationManager.getLocalPoint(n.scene.input.activePointer.worldX,n.scene.input.activePointer.worldY),i=t.x,r=t.y;n.upgradeButton.setPosition(Math.round(i)-n.x,Math.round(r)-n.y)}},n.onDragEnd=function(){n.isDraggable=!1},n.onDecorationDragStart=function(){n.isDecorationDraggable=!0},n.onDecorationDrag=function(e){if(n.isDecorationDraggable){var t=n.scene.locationManager.getLocalPoint(n.scene.input.activePointer.worldX,n.scene.input.activePointer.worldY),i=t.x,r=t.y;n.decoration.setPosition(Math.round(i)-n.x,Math.round(r)-n.y)}},n.onDecorationDragEnd=function(){n.isDecorationDraggable=!1},n.scene=t,n.setSize(100,100),n.canUpgrade=!1,n.buildingData={name:"",level1Cost:3,level2Cost:4,level3Cost:5,level:0},n.createDecoration(),n.createUpgradeButton(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateUpgradeButton(this.buildingData.level),this.updateUpgradeButtonVisibility(this.buildingData.level),e.next=4,this.runDecorationUpgradeButtonEntranceAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runDecorationUpgradeButtonExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,s=n.buttonX,o=n.buttonY,this.decorationId=r,this.buildingData.level=i,this.buildingData.name=n.file,this.setPosition(s,o),e.next=7,this.decoration.updateDecoration(t,n,i);case 7:this.canUpgrade=!0,this.decoration.showDecorationBuilt(i),this.updateDepth();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.hideDecoration=function(){this.decoration.hide()},n.resetDecoration=function(){this.buildingData.level=0,this.decoration.resetDecorationFrames()},n.createDecoration=function(){this.decoration=new bI(this.scene),this.add(this.decoration)},n.createUpgradeButton=function(){this.upgradeButton=new PI(this.scene),this.add(this.upgradeButton),this.updateUpgradeButton(this.buildingData.level),this.setSize(this.upgradeButton.width,this.upgradeButton.height);var e=this.getNextLevelCost(this.buildingData.level);this.upgradeButton.updateLevel(this.buildingData.level),this.upgradeButton.setCost(e)},n.listenEvents=function(){},n.getCurrentCost=function(){var e=this.buildingData,t=e.level,n=e.level1Cost,i=e.level2Cost,r=e.level3Cost;switch(t){case 2:return r;case 1:return i;default:return n}},n.getNextLevelCost=function(e){switch(e){case 0:return this.buildingData.level1Cost;case 1:return this.buildingData.level2Cost;case 2:return this.buildingData.level3Cost;default:return 0}},n.updateUpgradeButton=function(e){this.upgradeButton.setCost(this.getNextLevelCost(e)),this.upgradeButton.updateLevel(e)},n.updateUpgradeButtonVisibility=function(e){this.upgradeButton.setVisible(e<3)},n.updateDepth=function(){this.upgradeButton.setDepth(0),this.decoration.updateDepth()},n.setButtonDisabled=function(e){this.upgradeButton.setDisabled(e),this.upgradeButton.setAlpha(1)},n.runDecorationUpgradeButtonEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buildingData.level>=3)){e.next=2;break}return e.abrupt("return");case 2:return this.setButtonDisabled(!0),e.next=5,this.runEntranceAnimation({targets:this.upgradeButton,onStart:function(){t.upgradeButton.revive()}});case 5:this.setButtonDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runDecorationUpgradeButtonExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.upgradeButton,onComplete:function(){t.upgradeButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,p.Z)({alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:1,ease:Phaser.Math.Easing.Back.Out},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,p.Z)({alpha:{from:1,start:1,to:0},scale:{from:1,start:1,to:.5,ease:Phaser.Math.Easing.Back.In},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),OI=II,RI="opening",BI="opened",DI="closing",LI="closed",MI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.curveTextAnimation=void 0,n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.createCurveText(),n.scene.add.existing((0,yc.Z)(n)),n.curveTextAnimation.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){},n.processStep=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=DI){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.openContainer(),e.abrupt("return",new Promise((function(e){t.on("closed",e)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=RI,this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),e.next=7,this.processStep((function(){return t.runTextEntranceAnim()}));case 7:return this.state=BI,e.next=10,this.processStep((function(){return(0,gl.Z)(t.scene,1e3)}));case 10:return e.next=12,this.processStep((function(){return t.runTextExitAnim()}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnim=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.curveTextAnimation.playEntranceAnimation(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=DI,t=this.curveTextAnimation.playExitAnimation(),n=this.scene.tweens.add({targets:[this],alpha:0,duration:500,delay:800}).waitForCompletion(),e.next=5,Promise.all([t,n]);case 5:this.state=LI,this.emit("closed");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurveText=function(){var e=new Gf(this.scene,this.scene.lang.Text.levelComplete),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-2e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(46)),t.setPosition(0,-30.5),this.add(e),this.curveTextAnimation=e},t}(Phaser.GameObjects.Container),_I=Ki.Z.DEFAULT,NI=_I.KEY,GI=_I.FRAME,FI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.glow=void 0,n.light1=void 0,n.light2=void 0,n.curveTextAnimation=void 0,n.coin=void 0,n.star=void 0,n.coinText=void 0,n.adsIcon=void 0,n.tapToCollectText=void 0,n.tapToCollectButton=void 0,n.popupContents=[],n.starEmitter=void 0,n.sparkEmitter=void 0,n.glowTween=void 0,n.light1Anim=void 0,n.light2Anim=void 0,n.lightEffect=void 0,n.adsButtonEffect=void 0,n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.create(),n.alignItems(),t.add.existing((0,yc.Z)(n)),n.hideItems(),n}(0,f.Z)(t,e);var n=t.prototype;return n.setTotalCoins=function(e){this.coinText.setText(e.toString())},n.getCoinImage=function(){return this.coin},n.getStarImage=function(){return this.star},n.hideItems=function(){this.curveTextAnimation.setAlpha(0),this.popupContents.forEach((function(e){e.setAlpha(0)})),this.glow.setAlpha(0),this.light1.setAlpha(0),this.light2.setAlpha(0),this.stopAnimation()},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),e.next=5,this.runPopupContentsEntranceAnimation();case 5:this.runGlowRotationAnim(),this.runEffects(),this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.OPEN_WIN_SCREEN);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.hideItems(),this.stopAnimation()},n.runPopupContentsEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.curveTextAnimation.playEntranceAnimation(),this.adsIcon.setVisible(this.scene.level.getLevel()>5),t.push(this.runStarPopupAnimation()),this.popupContents.forEach((function(e,i){var r=e===n.tapToCollectText?.5:1,a=e.scale,s=n.scene.tweens.add({targets:e,alpha:{from:0,start:0,to:r},scale:{from:0,start:0,to:a},delay:50*i,duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();t.push(s)})),e.next=7,Promise.all(t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStarPopupAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[this.star,this.glow],n=[],i=0,r=t;i<r.length;i++)o=(s=r[i]).scale,c=s.angle,s===this.star&&(h=this.scene.tweens.add({targets:s,angle:{from:c-90,start:c-90,to:c},duration:500,ease:Phaser.Math.Easing.Cubic.Out}).waitForCompletion(),n.push(h)),u=this.scene.tweens.add({targets:s,alpha:{value:1,ease:Phaser.Math.Easing.Cubic.Out},scale:{from:0,start:0,to:o},duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),n.push(u);return e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEffects=function(){var e,t,n;null==(e=this.starEmitter)||e.start(),null==(t=this.sparkEmitter)||t.start(),null==(n=this.lightEffect)||n.start()},n.stopAnimation=function(){var e,t,n,i,r,a,s,o,c,h,u,l;null==(e=this.starEmitter)||e.stop(),null==(t=this.starEmitter)||t.killAll(),null==(n=this.sparkEmitter)||n.stop(),null==(i=this.sparkEmitter)||i.killAll(),null==(r=this.glowTween)||r.stop(),null==(a=this.glowTween)||a.remove(),null==(s=this.light1Anim)||s.stop(),null==(o=this.light1Anim)||o.remove(),this.light1.setAngle(0),this.light1.setScale(1/GameCore.ImageScale),null==(c=this.light2Anim)||c.stop(),null==(h=this.light2Anim)||h.remove(),this.light2.setAngle(0),this.light2.setScale(1/GameCore.ImageScale),null==(u=this.lightEffect)||u.stop(),null==(l=this.adsButtonEffect)||l.stop()},n.runGlowRotationAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e4,repeat:-1,props:{alpha:{from:1,to:.5,duration:2e3,yoyo:!0},angle:{value:360,ease:Phaser.Math.Easing.Sine.InOut}}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLightRotationAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.light1Anim)||t.remove(),null==(n=this.light2Anim)||n.remove(),i=1/GameCore.ImageScale,this.light1.kill(),this.light2.kill(),this.light1Anim=this.scene.tweens.add({targets:[this.light1],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:360},alpha:{from:.5,to:1,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}}),this.light2Anim=this.scene.tweens.add({targets:[this.light2],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:-360},scale:{from:i,to:1.075*i,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.light1.setPosition(0,65),this.light2.setPosition(0,65),this.coin.setPosition(0,65),this.glow.setPosition(0,-40),this.star.setPosition(0,-40),this.curveTextAnimation.curveText.setPosition(0,-122),this.coinText.setPosition(0,98),Phaser.Display.Align.In.BottomCenter(this.adsIcon,this,190,-20),Phaser.Display.Align.In.BottomCenter(this.tapToCollectText,this,0,-25)},n.create=function(){this.createGlowEffect(),this.createCurveTextAnimation(),this.createStar(),this.createCoin(),this.createStarParticle(),this.createSparkParticle(),this.createCoinText(),this.createTapToCollectButton(),this.createAdsIcon(),this.popupContents.push(this.coin,this.coinText,this.tapToCollectButton,this.adsIcon)},n.createGlowEffect=function(){var e=this.scene.make.image({key:NI,frame:GI.EFFECTS.GLOW_2});e.setDefaultWorldSize(),this.add(e);var t=this.scene.add.image(0,0,NI,GI.EFFECTS.LIGHT_X);t.setDefaultWorldSize(),this.add(t);var n=this.scene.add.image(0,0,NI,GI.EFFECTS.LIGHT_X);n.setDefaultWorldSize(),n.setAngle(90),this.add(n),this.glow=e,this.light1=t,this.light2=n},n.createSparkParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,NI,GI.EFFECTS.SPARK);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(100,220/3),t.setPosition(0-t.width/2,-40-t.height/2);var n=1/GameCore.ImageScale;this.sparkEmitter=e.createEmitter({frame:GI.EFFECTS.SPARK,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:NS.Z,quantity:1})},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,NI,GI.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(200/3,40),t.setPosition(0-t.width/2,65-t.height/2);var n=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:GI.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:NS.Z,quantity:1})},n.createCurveTextAnimation=function(){var e=new Gf(this.scene,this.scene.lang.Text.wellDone2),t=e.curveText;t.setFonts(Rc.ZP.STYLE.KEY),t.setOrigin(.5,.8),t.setRadius(-1e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(40)),this.add(e),this.curveTextAnimation=e},n.createStar=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.STAR);i.setDefaultWorldSize(),this.add(i),this.star=i},n.createCoin=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.COIN);i.setDefaultWorldSize(),this.add(i),this.coin=i},n.createCoinText=function(){var e=new Qp(this.scene,{text:"500",fontSize:this.scene.fontSize(15),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:.3});this.add(e),this.coinText=e},n.createAdsIcon=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new jp.Z(this.scene,238/3,217/3);this.add(i);var r=this.scene.add.image(0,0,t,n.ICONS.BONUS);r.setDefaultWorldSize(),i.add(r),this.adsIcon=i},n.createTapToCollectButton=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(18)),e.text.setText("Tap to collect"),e.setName("TapToCollect"),this.add(e),this.tapToCollectButton=e,this.tapToCollectText=this.tapToCollectButton.text},t}(Phaser.GameObjects.Container);function ZI(){for(var e=[],t=[10,18,27,14],n=0;n<4;n++)for(var i=0;i<t[n];i++)e.push("confetti/level-complete-screen/"+(n+1)+"_"+i);return e}var UI=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).levelCompleteContainer=void 0,o.wellDoneContainer=void 0,o.confettiEmitter=void 0,o.onClaim=void 0,o.totalClaimedCoins=void 0,o.coinsClaimed=void 0,o.isWatchAdsSuccess=void 0,o.onEntranceCompleted=function(){},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.wellDoneContainer.kill(),o.wellDoneContainer.setAlpha(0),o.wellDoneContainer.setScale(0),o.wellDoneContainer.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.handleClaim();case 2:case"end":return e.stop()}}),e)}))))},o.runAnimationCounter=function(){var e=o.countTotalCoin({startNumber:0,endNumber:o.totalClaimedCoins});return Promise.all([e])},o.handleWatchAdsClaim=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.scene.gameUI.coinBarButton.setDisabled(!0),o.scene.gameUI.starBarButton.setDisabled(!0),o.setButtonsDisable(!0),t=o.totalClaimedCoins,n=1,i=0,e.next=8,o.scene.showRewardedVideoAsync();case 8:return(r=e.sent)&&(i=t*n,o.scene.analytics.event(ae._.LUCKY_REWARD,{value:n}),o.isWatchAdsSuccess=!0),o.totalClaimedCoins=t+i,e.next=13,o.handleClaim(r?0:400);case 13:case"end":return e.stop()}}),e)}))),o.handleClaim=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),!o.coinsClaimed){e.next=3;break}return e.abrupt("return");case 3:if(o.coinsClaimed=!0,o.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.BUTTON_CLICK),!(t>0)){e.next=8;break}return e.next=8,(0,me.qZ)(t);case 8:return n=o.scene.gameUI.showCoin(),i=o.scene.gameUI.showStar(),e.next=12,Promise.all([n,i]);case 12:return o.setButtonsDisable(!0),o.scene.gameUI.coinBarButton.setDisabled(!0),o.scene.gameUI.starBarButton.setDisabled(!0),e.next=17,o.claim(o.totalClaimedCoins);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.claim=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.wellDoneContainer.curveTextAnimation.playExitAnimation(),o.scene.tweens.add({targets:[o.wellDoneContainer],alpha:{value:0,duration:300},duration:400,ease:Phaser.Math.Easing.Sine.In}),o.scene.rewardManager.rewardCoin(t),n=o.isWatchAdsSuccess?Cl.LEVEL_COMPLETE_AD:Cl.LEVEL_COMPLETE,o.scene.logEconomy.logGetItem(yl.COIN,t,n),i=o.wellDoneContainer.getCoinImage().getWorldPosition(),r=i.x,s=i.y,c=o.wellDoneContainer.getStarImage().getWorldPosition(),h=c.x,u=c.y,e.next=9,Promise.all([o.scene.rewardManager.starAnimationPool.runAnimationRewardStarAsync(1,h,u),o.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,r,s)]);case 9:o.scene.gameUI.coinBarButton.setDisabled(!0),o.scene.gameUI.starBarButton.setDisabled(!0),o.wellDoneContainer.runExitAnimation(),o.onClaim();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.totalClaimedCoins=0,o.isWatchAdsSuccess=!1,o.setDepth(de.Ks.POPUP),o.create(),o.background.setInteractive({useHandCursor:!0}),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.listenEvents(),o.wellDoneContainer.kill(),o.wellDoneContainer.setAlpha(0),o.wellDoneContainer.setScale(0),o}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.wellDoneContainer,t=e.adsIcon,n=e.tapToCollectButton;t.onClick=this.handleWatchAdsClaim,n.onClick=this.handleClaim},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),this.scene.gameUI.starBarButton.setDisabled(!0),this.scene.gameUI.starBarButton.setDepth(Ha.Z.PRIORITY),this.updateVictoryStats(),this.scene.gameUI.hideUI(),this.scene.gameUI.hideLife(),t.next=11,this.runEntranceAnimation();case 11:return this.confettiEmitter.run(20,0,0),t.next=14,this.levelCompleteContainer.runEntranceAnimation();case 14:return this.confettiEmitter.stop(),this.levelCompleteContainer.kill(),t.next=18,this.scene.handleShowInterstitialAd();case 18:return t.next=20,this.wellDoneContainer.runEntranceAnimation();case 20:(0,gl.Z)(this.scene,150).then((function(){i.setButtonsDisable(!1),i.runAnimationCounter()}));case 21:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.gameUI.hideStar();case 2:this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list,n=t.levelCollectedCoin,i=void 0===n?0:n,r=t.levelClearedCoin,a=void 0===r?0:r,s=t.onClaim,o=void 0===s?function(){}:s;this.coinsClaimed=!1,this.totalClaimedCoins=i+a,this.onClaim=o,this.wellDoneContainer.setTotalCoins(0)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.countTotalCoin=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onUpdate=function(e){var t=Math.floor(e.getValue());n.wellDoneContainer.setTotalCoins(t)},e.abrupt("return",this.runCountingAnimation(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCountingAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onStart=function(){n.scene.time.addEvent({repeat:4,delay:200,callback:function(){n.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.COUNT_COINS)}})},e.abrupt("return",FS(this.scene,t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setButtonsDisable=function(e){var t=this.wellDoneContainer,n=t.adsIcon,i=t.tapToCollectButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.create=function(){this.createConfettiEmitter(),this.createLevelCompleteContainer(),this.createWellDoneContainer()},n.createConfettiEmitter=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=new Phaser.Geom.Rectangle(-t/2-187.5,-n/2-100,t+360,50),r=ZI(),a=1/GameCore.ImageScale;this.confettiEmitter=new ac.Z(this.scene,{rotate:{start:-720,end:0},lifespan:{min:2500,max:3e3},speedY:{min:150,max:250},emitZone:{source:i,type:"random"},scale:{min:.8*a,max:1*a},particleBringToTop:!0,tint:void 0,frame:r}),this.add(this.confettiEmitter)},n.createLevelCompleteContainer=function(){this.levelCompleteContainer=new MI(this.scene),this.add(this.levelCompleteContainer)},n.createWellDoneContainer=function(){this.wellDoneContainer=new FI(this.scene),this.add(this.wellDoneContainer)},t}(GameCore.Screen),WI="opening",YI="opened",HI="closing",zI="closed",KI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.curveTextAnimation=void 0,n.background=void 0,n.confettiEmitter=void 0,n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.createBackground(),n.createConfettiEmitter(),n.createCurveText(),n.scene.add.existing((0,yc.Z)(n)),n.curveTextAnimation.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,f.Z)(t,e);var n=t.prototype;return n.processStep=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=HI){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.background.revive(),this.background.setInteractive(),this.setInteractive(),this.runEntranceAnimation(),this.openContainer(),this.confettiEmitter.run(20,0,0),e.abrupt("return",new Promise((function(e){t.on(zI,e)})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=WI,this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),e.next=7,this.processStep((function(){return t.runTextEntranceAnim()}));case 7:return this.state=YI,e.next=10,this.processStep((function(){return(0,gl.Z)(t.scene,1e3)}));case 10:return this.scene.resumeMusicWithTransition(1200),e.next=13,this.processStep((function(){return t.runTextExitAnim()}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createBackground=function(){this.background=this.scene.add.image(0,0,oe.Z.OVERLAY.KEY),this.background.setName("Black Background"),this.background.setInteractive(),this.background.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.background.kill(),this.add(this.background),Ap.Z.registerObject(this.background,de.MR.MULTIPLY_ALPHA)},n.runTextEntranceAnim=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.curveTextAnimation.playEntranceAnimation(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=HI,t=this.curveTextAnimation.playExitAnimation(),n=this.runExitAnimation(1e3),e.next=5,Promise.all([t,n]);case 5:this.background.disableInteractive(),this.disableInteractive(),this.confettiEmitter.stop(),this.state=zI,this.emit(zI);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurveText=function(){var e=new Gf(this.scene,"Journey Complete!"),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-2e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(46)),t.setPosition(0,-30.5),this.add(e),this.curveTextAnimation=e},n.createConfettiEmitter=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=new Phaser.Geom.Rectangle(-t/2-187.5,-n/2-100,t+360,50),r=ZI(),a=1/GameCore.ImageScale;this.confettiEmitter=new ac.Z(this.scene,{rotate:{start:-720,end:0},lifespan:{min:2500,max:3e3},speedY:{min:150,max:250},emitZone:{source:i,type:"random"},scale:{min:.8*a,max:1*a},particleBringToTop:!0,tint:void 0,frame:r}),this.add(this.confettiEmitter)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.background]},Sv.tweenConfigs.screen.configOpen)]}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.background],delay:t},Sv.tweenConfigs.screen.configClose)]}).waitForCompletion());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),VI=Ki.Z.DASHBOARD,XI=VI.KEY,jI=VI.FRAME,qI={width:99,height:47/3},JI={width:290/3,height:13},QI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.progressText=void 0,n.progressBar=void 0,n.progressFill=void 0,n.currentProgress=0,n.maxProgress=0,n.scene=t,n.setSize(99,47/3),n.createProgressBar(),n.createProgressFill(),n.createTitleText(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.currentProgress,this.maxProgress=n,0===t?(this.progressFill.kill(),this.progressFill.setAlpha(0)):this.progressFill.revive(),!i){e.next=9;break}return this.progressFill.setAlpha(0===t?0:1),this.currentProgress=t,this.progressFill.setSizeByWorld((0,rP.Z)(t,0,n,7,JI.width),this.progressFill.displayHeight),this.progressText.setText(Math.floor(t)+"/"+n),e.abrupt("return",Promise.resolve());case 9:return s=this.scene.tweens.add({targets:this.progressFill,alpha:1,duration:100}).waitForCompletion(),o=this.scene.tweens.addCounter({from:r,to:t,duration:300,onUpdate:function(e){var t=e.getValue(),i=c.progressFill.displayHeight,r=(0,rP.Z)(t,0,n,7,JI.width);c.progressFill.setSizeByWorld(r,i),c.progressText.setText(Math.floor(t)+"/"+n),c.currentProgress=t}}).waitForCompletion(),e.next=13,Promise.all([s,o]);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.isProgressComplete=function(){return this.currentProgress>=this.maxProgress},n.createProgressBar=function(){var e=this.scene.make.nineslice({key:XI,frame:jI.DECOR.PROGRESS.BAR,leftWidth:20,rightWidth:20,width:qI.width,height:qI.height});this.add(e),this.progressBar=e,this.setSize(e.displayWidth,e.displayHeight)},n.createProgressFill=function(){var e=this.scene.make.nineslice({key:XI,frame:jI.DECOR.PROGRESS.FILL,leftWidth:7,rightWidth:7,width:JI.width,height:JI.height});e.setOrigin(0,.5),this.add(e);var t=(this.progressBar.displayWidth-e.displayWidth)/2;e.setX(-this.progressBar.displayWidth/2+t),this.progressFill=e},n.createTitleText=function(){var e=new Qp(this.scene,{text:"3/15",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.add(e),this.progressText=e},t}(Phaser.GameObjects.Container),$I=QI,eO=Ki.Z.DASHBOARD,tO=eO.KEY,nO=eO.FRAME,iO={width:373/3,height:137/3},rO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.text=void 0,n.locationProgressBar=void 0,n.scene=t,n.setSize(373/3,137/3),n.createLocationProgressBorder(),n.createText(),n.createLocationProgressBar(),n.alignItems(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.journey.getInProgressLocation();case 2:return n=e.sent,i=n.progress,r=void 0===i?0:i,s=n.decorations,e.next=6,this.locationProgressBar.updateProgress(r,3*s.length,t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.text,this,0,-7),Phaser.Display.Align.In.BottomCenter(this.locationProgressBar,this,0,-10)},n.createLocationProgressBorder=function(){var e=this.scene.make.nineslice({key:tO,frame:nO.DECOR.PROGRESS_BORDER,leftWidth:20,rightWidth:20,width:iO.width,height:iO.height});this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.isProgressCompleted=function(){return this.locationProgressBar.isProgressComplete()},n.createText=function(){var e=new Qp(this.scene,{text:"Location Progress",fontSize:this.scene.fontSize(11),fillColor:11102533});this.add(e),this.text=e},n.createLocationProgressBar=function(){var e=new $I(this.scene);this.add(e),this.locationProgressBar=e},t}(Phaser.GameObjects.Container),aO=rO,sO=Ki.Z.EFFECTS,oO=sO.KEY,cO=sO.FRAME,hO=function(e){function t(t){var n;return(n=e.call(this,t,oO,cO.FX_COMET)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:cO.FX_COMET,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},speed:{min:100,max:200},scale:{start:.7*e,end:.4*e},lifespan:{min:300,max:1e3}})},n.explode=function(e,t,n){this.revive(),this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),uO=hO;function lO(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return dO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dO(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var pO=Ki.Z.DASHBOARD,fO=pO.KEY,mO=pO.FRAME,gO=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.isGuided=void 0,n.isOpening=void 0,n.decorationSlots=void 0,n.closeButton=void 0,n.titleLocation=void 0,n.nextButton=void 0,n.locationProgressTracker=void 0,n.starsExplosive=void 0,n.blackBackground=void 0,n.circleVfx=void 0,n.currentBg=void 0,n.nextBg=void 0,n.circleShape=void 0,n.journeyCompleteContainer=void 0,n.gameObjectsSorted=[],n.isJourneyCompletePlaying=void 0,n.clearDecorBtn=void 0,n.resetDefaultBtn=void 0,n.handleCloseButtonOnClick=(0,i.Z)(a().mark((function e(){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.runExitLocationContentsAnimation();case 2:n.isOpening=!1,t=n.scene.screen.get(de.o4.DASHBOARD_SCREEN),i=n.isGuided,t.handleCloseDecorationScreenCompleted(i);case 6:case"end":return e.stop()}}),e)}))),n.handleNextButtonOnClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.scene.journey.getNextStage()){e.next=3;break}return n.scene.screen.open(de.o4.NEXT_JOURNEY_SCREEN),e.abrupt("return");case 3:return n.sortLocationGameObjects(),n.runNextButtonExitAnimation(),e.next=7,n.runExitLocationContentsAnimation();case 7:return n.runBackgroundChangeAnimation(),n.scene.journey.updateToNextLocation(),n.scene.setBackgroundWithFadeAnimation(),n.runStarExplosiveEffect(),e.next=13,(0,me.qZ)(2e3).then((0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.updateData();case 2:return n.decorationSlots.forEach((function(e){n.moveBelow(n.nextBg,e)})),n.currentBg.kill(),n.nextBg.kill(),e.next=7,n.runEntranceLocationContentsAnimation();case 7:case"end":return e.stop()}}),e)}))));case 13:case"end":return e.stop()}}),e)}))),n.handleDecorationUpgradeButtonOnClick=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.BUTTON_CLICK),!t.spineClicked){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.updateData();case 5:t.handleDecorationUpgradeButtonOnClick();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDecorationUpgraded=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),e.next=3,n.updateProgress(t);case 3:n.isLocationProgressCompleted()&&n.handleLocationProgressComplete();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDecorationUpgrade=function(){n.scene.journey.isCurrentLocationCompleted()&&(n.setButtonDisabled(!0),n.scene.gameUI.setDisableButtons(!0))},n.handleClearDecorationsButtonOnClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(300);case 2:n.scene.journey.clearDecorationData(),n.runNextButtonExitAnimation(),n.decorationSlots.map((function(e){e.resetDecoration()})),n.handleCloseButtonOnClick();case 6:case"end":return e.stop()}}),e)}))),n.handleResetJourneyProgressToDefault=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(300);case 2:n.scene.journey.resetJourneyProgressToDefault(),n.runNextButtonExitAnimation(),n.decorationSlots.map((function(e){e.resetDecoration()})),n.handleCloseButtonOnClick();case 6:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.preloadCurrentBackgroundAsync(),n.create(),n.hideAllContents(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n.updateCurrentBg(),n.createDebugButtons(),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.closeButton.onClick=this.handleCloseButtonOnClick,this.nextButton.onClick=this.handleNextButtonOnClick,this.decorationSlots.map((function(t){t.upgradeButton.onClick=e.handleDecorationUpgradeButtonOnClick.bind(e,t)})),this.scene.journey.events.on(pi.DECORATION_UPGRADE,this.handleDecorationUpgrade,this),this.scene.journey.events.on(pi.DECORATION_UPGRADED,this.handleDecorationUpgraded,this)},n.runFadeBackground=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.blackBackground.revive(),void 0!==t&&this.blackBackground.setAlpha(t),e.next=4,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:r}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.highlightDecorationSlots=function(){var e=this;this.bringToTop(this.blackBackground),this.decorationSlots.map((function(t){0===t.buildingData.level&&e.bringToTop(t)}))},n.hasBuiltDecoration=function(){return this.scene.player.getJourneyProgress().finishedLocationIds.length>0||this.decorationSlots.some((function(e){return e.buildingData.level>0}))},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sortLocationGameObjects(),e.next=3,this.updateData();case 3:if(!this.isOpening){e.next=5;break}return e.abrupt("return");case 5:return this.isOpening=!0,this.isJourneyCompletePlaying=!1,this.setAlpha(1),t=[],this.isLocationProgressCompleted()&&t.push(this.runNextButtonEntranceAnimation()),t.push(this.runEntranceLocationContentsAnimation()),e.next=13,Promise.all(t);case 13:this.scene.events.emit(pi.OPENED_LOCATION_DECORATION);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateCurrentBg(),t=this.scene.journey.getInProgressLocation(),n=t.id,i=t.name,r=parseInt(n)+1,this.titleLocation.updateTitle(r,i),s=this.scene.journey.getCurrentDecorationLocationConfigs(),o=t.decorations,c=s.decorationKey,h=s.decorationConfigs,this.decorationSlots.map((function(e,t){var n=o.find((function(e){return e.id===t.toString()})),i=h.find((function(e){return e.id===t.toString()}));i&&n&&e.updateData(c,i,n.level)})),this.updateProgress(!0);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getGuidedSlot=function(){for(var e,t=[],n=[],i=this.scene.gameZone.height,r=lO(this.decorationSlots);!(e=r()).done;){var a=e.value;0===a.buildingData.level&&n.push(a)}for(var s=0,o=n;s<o.length;s++){var c=o[s];c.y<i/2-70&&t.push(c)}return 0===t.length?null:t.reduce((function(e,t){return e.buildingData.level<t.buildingData.level?e:t}))},n.getUnlockableSlots=function(){for(var e,t=[],n=lO(this.decorationSlots);!(e=n()).done;){var i=e.value;i.getCurrentCost()<=this.scene.player.getStar()&&t.push(i)}return t},n.runBackgroundChangeAnimation=function(){var e=this;this.currentBg.revive(),this.decorationSlots.forEach((function(t){e.moveAbove(e.nextBg,t)})),this.updateNextBg(),this.runCircleVFXShowAnimation(),this.nextBg.setAlpha(1),this.scene.tweens.add({targets:this.circleShape,scale:{from:0,start:0,to:1},duration:500,onUpdate:function(t){var n=t.getValue(),i=(0,rP.Z)(n,0,1,0,e.scene.gameZone.width/2),r=(0,rP.Z)(n,0,1,0,e.nextBg.height/2);e.circleShape.setX(e.scene.gameZone.width/2-i),e.circleShape.setY(e.nextBg.height/2-r)}}).waitForCompletion().then((function(){e.decorationSlots.map((function(e){e.resetDecoration()}))}))},n.runCircleVFXShowAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=this.scene.gameplay.spineManager,this.circleVfx.animationState.timeScale=.833,e.next=5,(0,me.qZ)(t);case 5:return e.next=7,n.playAnimation(this.circleVfx,Xu.CIRCLE_VFX.SHOW);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runJourneyCompleteAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isJourneyCompletePlaying){e.next=2;break}return e.abrupt("return");case 2:return this.isJourneyCompletePlaying=!0,this.sortLocationGameObjects(),this.journeyCompleteContainer.revive(),e.next=7,(0,gl.Z)(this.scene,100);case 7:return this.scene.gameUI.hideUI(),e.next=10,this.runExitUIAnimation();case 10:return this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.LEVEL_COMPLETED),e.next=13,this.journeyCompleteContainer.open();case 13:return this.scene.gameUI.setDisableButtons(!1),this.scene.gameUI.showCoin(),this.scene.gameUI.showStar(),e.next=18,this.runEntranceUIAnimation();case 18:this.isJourneyCompletePlaying=!1;case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitUIAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationExitAnimation(),n=this.runCloseButtonExitAnimation(),i=this.runLocationProgressTrackerExitAnimation(),r=this.runNextButtonExitAnimation(),e.next=7,Promise.all([t,n,i,r]);case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceUIAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationEntranceAnimation(),n=this.runCloseButtonEntranceAnimation(),i=this.runLocationProgressTrackerEntranceAnimation(),r=this.runNextButtonEntranceAnimation(),e.next=7,Promise.all([t,n,i,r]);case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleLocationProgressComplete=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOpening){e.next=2;break}return e.abrupt("return");case 2:return this.setButtonDisabled(!0),this.scene.pauseMusicWithTransition(300),this.scene.requireSpineAsync("CIRCLE_VFX_SPINE"),e.next=7,this.runJourneyCompleteAnimation();case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateProgress=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationProgressTracker.updateProgress(t);case 2:n=this.scene.player.getJourneyProgress(),(i=n.inProgressLocation)&&i.progress>=2*i.decorations.length&&this.preloadNextBackgroundAsync();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.isLocationProgressCompleted=function(){return this.locationProgressTracker.isProgressCompleted()&&this.scene.journey.isCurrentLocationCompleted()},n.setButtonDisabled=function(e){this.closeButton.setDisabled(e),this.nextButton.setDisabled(e),this.decorationSlots.map((function(t){t.upgradeButton.setDisabled(e)})),this.closeButton.setAlpha(1),this.nextButton.setAlpha(1),this.decorationSlots.map((function(e){e.upgradeButton.setAlpha(1)}))},n.runEntranceLocationContentsAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationEntranceAnimation(),n=this.runCloseButtonEntranceAnimation(),i=this.runLocationProgressTrackerEntranceAnimation(),r=this.decorationSlots.map((function(e){return e.open()})),e.next=7,Promise.all([t,n,i].concat(r));case 7:this.setButtonDisabled(!1),this.scene.devToolManager.isShowDebugButtons?this.showDebugButtons():this.hideDebugButtons();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitLocationContentsAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationExitAnimation(),n=this.runCloseButtonExitAnimation(),i=this.runLocationProgressTrackerExitAnimation(),r=this.decorationSlots.map((function(e){return e.close()})),s=this.runNextButtonExitAnimation(),e.next=8,Promise.all([t,n,i].concat(r,[s]));case 8:this.setButtonDisabled(!1),this.hideDebugButtons();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStarExplosiveEffect=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.starsExplosive.explode(100,0,0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleLocationEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimation({targets:this.titleLocation});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleLocationExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.titleLocation});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseButtonEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.closeButton.revive(),e.next=3,this.runEntranceAnimation({targets:this.closeButton});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseButtonExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.closeButton,onComplete:function(){t.closeButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runNextButtonEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextButton.revive(),e.next=3,this.runEntranceAnimation({targets:this.nextButton});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runNextButtonExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.nextButton,onComplete:function(){t.nextButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLocationProgressTrackerEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimation({targets:this.locationProgressTracker});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLocationProgressTrackerExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.locationProgressTracker});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,p.Z)({alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:1,ease:Phaser.Math.Easing.Back.Out},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,p.Z)({alpha:{from:1,start:1,to:0},scale:{from:1,start:1,to:0,ease:Phaser.Math.Easing.Back.In},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.titleLocation.setAlpha(0),this.locationProgressTracker.setAlpha(0),this.closeButton.kill(),this.nextButton.kill(),this.decorationSlots.map((function(e){e.upgradeButton.kill(),e.hideDecoration()})),this.hideDebugButtons()},n.updateCurrentBg=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.journey.getCurrentStage(),n=t.backgroundKey,this.scene.textures.exists(n)){e.next=7;break}return this.currentBg.kill(),e.next=5,this.preloadCurrentBackgroundAsync();case 5:return this.updateCurrentBg(),e.abrupt("return");case 7:this.currentBg.setTexture(n),i=this.scene.gameZone.height,r=i*(this.currentBg.frame.width/this.currentBg.frame.height),this.currentBg.setWorldSize(r,i);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateNextBg=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.journey.getNextStage()){e.next=3;break}return e.abrupt("return");case 3:if(n=t.backgroundKey,this.scene.textures.exists(n)){e.next=10;break}return this.nextBg.kill(),e.next=8,this.preloadNextBackgroundAsync();case 8:return this.updateNextBg(),e.abrupt("return");case 10:this.nextBg.setTexture(n),i=this.scene.gameZone.height,r=i*(this.nextBg.frame.width/this.nextBg.frame.height),this.nextBg.setWorldSize(r,i),this.nextBg.revive(),this.nextBg.setAlpha(0),this.createNextBgCircleMask(),this.circleShape.setScale(0);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadCurrentBackgroundAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=t.scene.journey.getCurrentStage();t.scene.load.image(n.backgroundKey,n.backgroundFile),t.scene.load.start(),t.scene.load.once("filecomplete-image-"+n.backgroundKey,(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.preloadNextBackgroundAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.preloadNextBackgroundAsync();var n=t.scene.journey.getNextStage();if(!n)return e();t.scene.load.image(n.backgroundKey,n.backgroundFile),t.scene.load.start(),t.scene.load.once("filecomplete-image-"+n.backgroundKey,(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.sortLocationGameObjects=function(){var e=this;this.gameObjectsSorted.forEach((function(t){e.bringToTop(t)})),this.resetDefaultBtn&&this.bringToTop(this.resetDefaultBtn),this.clearDecorBtn&&this.bringToTop(this.clearDecorBtn)},n.create=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.createCurrentBackground(),this.createCircleShape(),this.createDecorationSlotManager(),this.createNextBackground(),this.createButtons(),this.createTitleLocation(),this.createLocationProgressTracker(),this.createStarsExplosive(),this.createBlackBackground(),this.createJourneyCompleteContainer(),this.createChangeVFXSpine();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurrentBackground=function(){this.currentBg=this.scene.add.image(0,0,fO,mO.BLANK),this.currentBg.setName("CurrentBackground"),this.currentBg.setOrigin(.5,.5),this.currentBg.setWorldSize(0,0),this.add(this.currentBg),this.currentBg.kill()},n.createCircleShape=function(){this.circleShape=this.scene.make.graphics({fillStyle:{color:16777215,alpha:1},visible:!0})},n.createDecorationSlotManager=function(){var e=this;this.decorationSlots=new Array(5).fill(null).map((function(t,n){var i=new OI(e.scene);return i.setName("DecorationSlot-"+n),e.add(i),i}))},n.createNextBackground=function(){this.nextBg=this.scene.add.image(0,0,fO,mO.BLANK),this.nextBg.setName("NextBackground"),this.nextBg.setOrigin(.5,.5),this.nextBg.setWorldSize(0,0),this.add(this.nextBg),this.nextBg.kill()},n.createButtons=function(){this.createCloseButton(),this.createNextLocationButton()},n.createCloseButton=function(){this.closeButton=new Vc.Z(this.scene,fO,mO.BUTTON.BACK,43,131/3),this.closeButton.setName("CloseJourney"),this.add(this.closeButton),Phaser.Display.Align.In.BottomLeft(this.closeButton,this,-5,-5)},n.createNextLocationButton=function(){this.nextButton=new EI(this.scene),this.add(this.nextButton),this.nextButton.kill(),Phaser.Display.Align.In.BottomRight(this.nextButton,this,-5,-7)},n.createTitleLocation=function(){this.titleLocation=new fI(this.scene),this.titleLocation.setName("TitleLocation"),this.add(this.titleLocation),Phaser.Display.Align.In.TopCenter(this.titleLocation,this,0,-10)},n.createLocationProgressTracker=function(){this.locationProgressTracker=new aO(this.scene),this.locationProgressTracker.setName("LocationProgressTracker"),this.add(this.locationProgressTracker),Phaser.Display.Align.In.BottomCenter(this.locationProgressTracker,this,0,-7)},n.createStarsExplosive=function(){this.starsExplosive=new uO(this.scene),this.starsExplosive.setName("StarsExplosive"),this.add(this.starsExplosive)},n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,oe.Z.OVERLAY.KEY),this.blackBackground.setName("BlackBackground"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),this.add(this.blackBackground),Phaser.Display.Align.In.Center(this.blackBackground,this),Ap.Z.registerObject(this.blackBackground,de.MR.MULTIPLY_ALPHA)},n.createChangeVFXSpine=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.requireSpineAsync("CIRCLE_VFX_SPINE");case 2:(t=this.scene.add.spine(0,0,Ki.Z.CIRCLE_VFX_SPINE.DATA_KEY,Ki.Z.CIRCLE_VFX_SPINE.ATLAS_KEY)).setName("CircleVFX"),n=1/GameCore.ImageScale,t.setScale(n),this.add(t),t.setPosition(-50.75073/GameCore.ImageScale,-33.92575/GameCore.ImageScale),this.circleVfx=t,this.gameObjectsSorted=[this.currentBg].concat(this.decorationSlots,[this.nextBg,this.closeButton,this.nextButton,this.titleLocation,this.locationProgressTracker,this.starsExplosive,this.blackBackground,this.journeyCompleteContainer,this.circleVfx]);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createJourneyCompleteContainer=function(){var e=new KI(this.scene);e.setName("JourneyCompleteContainer"),this.add(e),this.journeyCompleteContainer=e,this.journeyCompleteContainer.kill()},n.createNextBgCircleMask=function(){this.circleShape.fillCircle(this.scene.gameZone.width/2,this.nextBg.height/2,this.nextBg.width/1.5);var e=this.circleShape.createGeometryMask();this.nextBg.setMask(e)},n.createDebugButtons=function(){this.createClearDecorationsButton(),this.createResetJourneyProgressToDefaultButton(),this.clearDecorBtn.onClick=this.handleClearDecorationsButtonOnClick,this.resetDefaultBtn.onClick=this.handleResetJourneyProgressToDefault,this.hideDebugButtons()},n.createResetJourneyProgressToDefaultButton=function(){this.resetDefaultBtn=new jp.Z(this.scene,30,30);var e=this.scene.add.image(0,0,fO,mO.BLANK);e.setWorldSize(30,30);var t=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"reset\ndefault",origin:{x:.5,y:.5}});this.resetDefaultBtn.add([e,t]),this.resetDefaultBtn.setName("ResetJourneyProgressToDefault"),this.add(this.resetDefaultBtn),Phaser.Display.Align.In.BottomLeft(this.resetDefaultBtn,this,-75,-7)},n.createClearDecorationsButton=function(){this.clearDecorBtn=new jp.Z(this.scene,30,30);var e=this.scene.add.image(0,0,fO,mO.BLANK);e.setWorldSize(30,30);var t=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"clear\ndata",origin:{x:.5,y:.5}});this.clearDecorBtn.add([e,t]),this.clearDecorBtn.setName("ClearDecorations"),this.add(this.clearDecorBtn),Phaser.Display.Align.In.BottomLeft(this.clearDecorBtn,this,-115,-7)},n.showDebugButtons=function(){this.clearDecorBtn.revive(),this.resetDefaultBtn.revive()},n.hideDebugButtons=function(){this.clearDecorBtn&&this.clearDecorBtn.kill(),this.resetDefaultBtn&&this.resetDefaultBtn.kill()},t}(Phaser.GameObjects.Container),vO=gO,yO=Ki.Z.DEFAULT,EO=yO.KEY,CO=yO.FRAME,wO=Ki.Z.DASHBOARD,AO=wO.KEY,bO=wO.FRAME,SO=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.titleText=void 0,i.descriptionText=void 0,i.parentScreen=void 0,i.arrow=void 0,i.step1=void 0,i.step2=void 0,i.tapToContinueButton=void 0,i.playButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i.listenEvents(),i}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.tapToContinueButton.onClick=function(){e.parentScreen.handleGetMoreStarsContainerClose()},this.playButton.onClick=function(){e.setButtonsDisabled(!0),e.scene.screen.close(de.o4.GET_MORE_STARS_SCREEN),e.scene.events.emit(pi.OPEN_PLAY_SCREEN_FROM_DASHBOARD)}},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-24),Phaser.Display.Align.In.TopCenter(this.descriptionText,this,0,-74),Phaser.Display.Align.In.Center(this.step1,this,-98,58),Phaser.Display.Align.In.Center(this.step2,this,104.5,50),Phaser.Display.Align.In.Center(this.arrow,this,1,-8),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,-60)},n.create=function(){this.createTitle(),this.createDescription(),this.createTutorialSteps(),this.createArrows(),this.createContinueButton(),this.createPlayButton()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),this.setButtonsDisabled(!0),e.next=5,this.runEntranceAnimation(100);case 5:this.setButtonsDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.tapToContinueButton.setDisabled(e)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.runDescriptionEntranceAnimation(200,500),r=this.step1.runEntranceAnimation(200,500),s=this.runArrowEntranceAnimation(this.arrow,400,500),o=this.step2.runEntranceAnimation(600,500),c=this.runPlayButtonEntranceAnimation(800,500),e.next=10,Promise.all([n,i,r,s,o,c]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.titleText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.titleText.setScale(0),i.titleText.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runDescriptionEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.descriptionText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.descriptionText.setScale(0),i.descriptionText.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runPlayButtonEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.playButton,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.playButton.setScale(0),i.playButton.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.titleText.setAlpha(0),this.descriptionText.setAlpha(0),this.step1.kill(),this.step2.kill(),this.arrow.setAlpha(0),this.playButton.setAlpha(0)},n.close=function(){this.setButtonsDisabled(!0)},n.createTitle=function(){this.titleText=new Rf(this.scene),this.titleText.setText(this.scene.lang.Text.getMoreStars),this.titleText.setFontSize(40),this.titleText.setRadius(-1138),this.titleText.setLetterSpacing(.05),this.titleText.setOrigin(.5,.5),this.add(this.titleText)},n.createDescription=function(){var e=new Rf(this.scene);e.setText(this.scene.lang.Text.earnStar),e.setFontSize(15),e.setRadius(-1468),e.setLetterSpacing(0),e.setFonts(Rc.ZP.WHITE_SHADOW.KEY),this.add(e),this.descriptionText=e},n.createTutorialSteps=function(){var e=this,t=[CO.GET_MORE_STARS.LEVEL_ICON,CO.GET_MORE_STARS.STARS_ICON],n=Array.from({length:2},(function(n,i){return new ET(e.scene,EO,t[i],"")}));this.add([].concat(n)),this.step1=n[0],this.step2=n[1]},n.createArrows=function(){var e=this.scene.add.image(0,0,EO,CO.GET_MORE_STARS.ARROW_ICON);e.setDefaultWorldSize(),this.add(e),this.arrow=e},n.createPlayButton=function(){var e=new oy(this.scene,{key:AO,buttonFrame:bO.BUTTON.BUTTON.NEW_GREEN_SHADOW,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117}),t=new Qp(this.scene,{text:"Play",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setText("Play"),t.setY(-1),e.addIntoButton(t),this.add(e),this.playButton=e,this.playButton.button.setName("PlayButton")},n.createContinueButton=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText(""),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e},t}(Phaser.GameObjects.Container),TO=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).getMoreStarsContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(1),a.getMoreStarsContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createGetMoreStarsContainer()},n.handleGetMoreStarsContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getMoreStarsContainer.close(),this.scene.screen.close(this.name);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createGetMoreStarsContainer=function(){this.getMoreStarsContainer=new SO(this.scene,this),this.getMoreStarsContainer.setInteractive({useHandCursor:!0}),this.add(this.getMoreStarsContainer),Phaser.Display.Align.In.Center(this.getMoreStarsContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.scene.events.emit(pi.HIDE_GUIDE),this.runEntranceAnimation(),t.next=5,this.getMoreStarsContainer.open();case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),xO=Ki.Z.JOURNEY,kO=xO.KEY,PO=xO.FRAME,IO=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.progressBar=void 0,r.progressBarBackground=void 0,r.progressBarFill=void 0,r.progressBarText=void 0,r.scene=t,r.create(),r.setSize(n,r.progressBar.height),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setProgressBarFill(0,15)},n.setProgressBarFill=function(e,t){if(this.progressBarText.setText(Math.floor(e)+"/"+t),0!==e){this.progressBarFill.revive();var n=this.progressBarFill.displayHeight,i=(0,rP.Z)(e,0,t,20,407/3);this.progressBarFill.setSizeByWorld(i,n)}else this.progressBarFill.kill()},n.create=function(){var e=this.scene.add.container(0,0);this.progressBarBackground=this.createProgressBarBackground(),this.progressBarFill=this.createProgressBarFill(),this.progressBarText=this.createProgressText(),e.add([this.progressBarBackground,this.progressBarFill,this.progressBarText]),this.add(e),this.progressBar=e},n.createProgressBarBackground=function(){return this.scene.make.nineslice({key:kO,frame:PO.MAP_BLOCK.PROGRESS_BAR.BORDER,width:409/3,height:18,leftWidth:10,rightWidth:10})},n.createProgressBarFill=function(){var e=this.scene.make.nineslice({key:kO,frame:PO.MAP_BLOCK.PROGRESS_BAR.GREEN_PROGRESS,width:407/3,height:25,leftWidth:10,rightWidth:10});e.setOrigin(0,.5);var t=(this.progressBarBackground.displayWidth-e.displayWidth)/2;return e.setX(-this.progressBarBackground.displayWidth/2+t),e},n.createProgressText=function(){return new Qp(this.scene,{text:"1/10",fontSize:this.scene.fontSize(13),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2})},t}(Phaser.GameObjects.Container),OO=IO,RO=Ki.Z.JOURNEY,BO=RO.KEY,DO=RO.FRAME,LO=5.5,MO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.lockTop=void 0,n.lockBody=void 0,n.scene=t,n.create(),n.setSize(n.lockBody.width,n.lockTop.height+n.lockBody.height-LO),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this.scene.add.image(0,0,BO,DO.MAP_BLOCK.ICON_LOCK.TOP);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,BO,DO.MAP_BLOCK.ICON_LOCK.BODY);t.setDefaultWorldSize(),this.add(e),this.add(t),e.setPosition(0,-5.5),t.setPosition(0,LO),this.lockTop=e,this.lockBody=t},n.reset=function(){this.lockTop.setVisible(!0),this.lockBody.setVisible(!0),this.lockTop.setPosition(0,-5.5),this.lockBody.setPosition(0,LO),this.lockTop.setAlpha(1),this.lockBody.setAlpha(1),this.lockTop.setRotation(0),this.lockBody.setRotation(0),this.lockTop.setDefaultWorldSize(),this.lockBody.setDefaultWorldSize()},t}(Phaser.GameObjects.Container);function _O(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return NO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NO(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function NO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var GO=Ki.Z.JOURNEY,FO=GO.KEY,ZO=GO.FRAME,UO=376/3,WO=335/3,YO=1.13,HO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.shadow=void 0,n.background=void 0,n.overlay=void 0,n.thumbnail=void 0,n.mapName=void 0,n.progressBar=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.status=void 0,n.thumbnailKey=void 0,n.cardShines=void 0,n.multiplyLabelShine=void 0,n.additiveLabelShine=void 0,n.lock=void 0,n.lockGlow=void 0,n.lockAdd=void 0,n.checkMark=void 0,n.unlockMapAnimation=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.setMapActive(e===bR.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.setMapActive(t===bR.InProgress);var n=e.progressBar,i=n.currentProgress,r=n.maxProgress;this.progressBar.setProgressBarFill(i,r)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===bR.Lock&&t===bR.InProgress,i=e===bR.InProgress&&t===bR.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(r=t===bR.Lock&&n===bR.InProgress,s=t===bR.InProgress&&n===bR.Finished,!r){e.next=11;break}return this.updateVisibility(bR.Lock),this.setMapActive(!1),e.next=10,this.playUnlockMapAnimation(i);case 10:return e.abrupt("return");case 11:if(!s){e.next=16;break}return this.updateVisibility(bR.InProgress),this.setMapActive(!0),e.next=16,this.playFinishedMapAnimation(i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===bR.Lock),this.checkMark.setVisible(e===bR.Finished),this.progressBar.setVisible(e===bR.InProgress),this.overlay.setAlpha(e===bR.Lock?.5:0)},n.setMapActive=function(e){void 0===e&&(e=!0)},n.updateMapName=function(e){this.mapName.setText(e)},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function r(){i.showLoading(!0);var a="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(UO,WO),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(a,r),i.previousEventName=a}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.shadow.setY(2),this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+6),this.loading.setY(this.thumbnail.y),this.mapName.setY(this.thumbnail.y+this.thumbnail.height/2+14),this.progressBar.setY(68),this.lockGlow.setPosition(this.progressBar.x,this.progressBar.y+5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=a().mark((function e(){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=s.cardShines[r]).revive(),i.setAlpha(0),o=s.scene.tweens.add({targets:i,alpha:.08,delay:t+150*r,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(o);case 5:case"end":return e.stop()}}),e)})),r=0;case 5:if(!(r<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:r++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playLabelShineAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.multiplyLabelShine.revive(),this.additiveLabelShine.revive(),this.multiplyLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),this.additiveLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),n=800,this.multiplyLabelShine.setAlpha(0),this.additiveLabelShine.setAlpha(0),this.multiplyLabelShine.setScale(1.5,.4),this.additiveLabelShine.setScale(1.5,.4),e.next=12,Promise.all([this.scene.tweens.add({targets:this.additiveLabelShine,alpha:.5,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.multiplyLabelShine,alpha:1,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],x:this.mapName.x+this.mapName.width/2,delay:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],scaleX:2,yoyo:!0,delay:t,duration:400,ease:Phaser.Math.Easing.Cubic.InOut}).waitForCompletion()]);case 12:this.multiplyLabelShine.kill(),this.additiveLabelShine.kill();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(bR.InProgress),this.offsetOriginWrapper.setScale(YO),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,gl.Z)(this.scene,t+850).then((function(){i.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS)})),e.next=11,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.playCardShineAnimation(t+400)]);case 11:this.alignItems(),this.setMapActive(!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.lockAdd.revive(),this.lockGlow.revive(),this.progressBar.revive(),this.unlockMapAnimation.setDelay(t),this.overlay.setAlpha(.5),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),this.unlockMapAnimation.events.on("startDelay",(function(){(0,gl.Z)(n.scene,550).then((function(){n.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.TWIST_LOCK)}))})),e.next=12,Promise.all([this.unlockMapAnimation.start(),this.playCardShineAnimation(t+1700),this.playLabelShineAnimation(t+1200),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:(1-YO)*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.overlay,alpha:0,delay:t+1100,duration:180}).waitForCompletion()]);case 12:this.lock.kill(),this.lockAdd.kill(),this.lockGlow.kill(),this.lock.reset(),this.lockAdd.reset(),this.lock.setScale(1),this.lockAdd.setScale(1),this.alignItems(),this.setMapActive(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createShadow(),this.createBackground(),this.createThumbnail(),this.createMapName(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createOverlay(),this.createCardShines(),this.createLabelShine(),this.createLockShines(),this.createUnlockMapAnimation()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createShadow=function(){var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.BACKGROUND_SHADOW);e.setDefaultWorldSize(),this.wrapper.add(e),this.shadow=e},n.createBackground=function(){var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),e.setTint(5450259),e.setAlpha(0),this.wrapper.add(e),this.overlay=e},n.createCardShines=function(){for(var e,t=[],n=_O(ZO.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,r=this.scene.add.image(0,0,FO,i);r.setDefaultWorldSize(),r.setBlendMode(Phaser.BlendModes.ADD),r.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),r.kill(),this.wrapper.add(r),t.push(r)}var a=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.CARD_SHINES[0]);a.setDefaultWorldSize(),a.setScale(t[0].scaleX,t[0].scaleY),a.setBlendMode(Phaser.BlendModes.ADD),a.setPosition(-t[0].displayWidth/2+a.displayWidth/2,t[0].displayHeight/2-a.displayHeight/2),this.wrapper.add(a);var s=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.CARD_SHINES[ZO.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[a].concat(t,[s]),a.kill(),s.kill()},n.createLabelShine=function(){var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.LABEL_SHINE);e.setDefaultWorldSize(),e.setScale(0,.4),e.setBlendMode(Phaser.BlendModes.MULTIPLY),e.setTint(13332544),e.setAlpha(1),e.kill(),this.wrapper.add(e),this.multiplyLabelShine=e;var t=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.LABEL_SHINE);t.setDefaultWorldSize(),t.setScale(0,.4),t.setBlendMode(Phaser.BlendModes.ADD),t.setAlpha(.3),t.kill(),this.wrapper.add(t),this.additiveLabelShine=t},n.createLockShines=function(){var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.LOCK_SHINE);e.setDefaultWorldSize(),e.setBlendMode(Phaser.BlendModes.ADD),e.setAlpha(1),e.setScale(3/9),e.kill(),this.wrapper.add(e),this.lockGlow=e;var t=new MO(this.scene);this.wrapper.add(t),t.setPosition(0,68),t.kill(),this.lockAdd=t},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(UO,WO);var e=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.THUMBNAIL_BACKGROUND);e.setWorldSize(UO,WO),this.thumbnail.add(e);var t=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.THUMBNAIL);t.setDefaultWorldSize(),this.thumbnail.add(t);var n=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.THUMBNAIL_FOREGROUND);n.setDefaultWorldSize(),this.thumbnail.add(n),this.thumbnailFrame=t},n.createMapName=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.HEADER.KEY,size:this.scene.fontSize(16),text:"Triple Cut",origin:{x:.5,y:.5}});this.wrapper.add(e),this.mapName=e},n.createProgressBar=function(){this.progressBar=new OO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createLock=function(){this.lock=new MO(this.scene),this.wrapper.add(this.lock),this.lock.setPosition(0,68),this.lock.kill()},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,FO,ZO.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(68),this.checkMark.kill()},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},n.createUnlockMapAnimation=function(){this.unlockMapAnimation=new VA([{target:this.offsetOriginWrapper,rotate:[{time:.55,curve:[.583,0,.617,2.62]},{time:.65,value:2.62,curve:[.667,2.62,.683,-2.63]},{time:.7,value:-2.63,curve:[.728,-2.63,.756,4.48]},{time:.7833,value:4.48,curve:[.806,4.48,.828,-3.45]},{time:.85,value:-3.45,curve:[.878,-3.45,.906,3.84]},{time:.9333,value:3.84,curve:[.961,3.84,.989,1.28]},{time:1.0167}],scale:[{time:.1833,curve:[.191,.993,.228,.95,.191,.993,.228,.95]},{time:.25,x:.95,y:.95,curve:[.337,.95,.46,1.157,.337,.95,.46,1.157]},{time:.55,x:1.16,y:1.16,curve:[.728,1.166,.685,.969,.728,1.166,.685,.969]},{time:.7833,x:.942,y:.942,curve:[1.064,.866,.994,1.185,1.064,.866,.994,1.185]},{time:1.1833,x:1.18,y:1.18,curve:[1.279,1.178,1.359,1.114,1.279,1.178,1.359,1.114]},{time:1.45,x:1.11,y:1.11,curve:[1.523,1.107,1.645,1.125,1.523,1.107,1.645,1.125]},{time:1.6667,x:YO,y:YO}]},{target:[this.lock,this.lockAdd],scale:[{time:.1667,curve:[.194,1,.222,1.1,.194,1,.222,1.1]},{time:.25,x:1.1,y:1.1,curve:[.311,1.1,.372,.85,.311,1.1,.372,.85]},{time:.4333,x:.85,y:.85},{time:.6667,x:1.429,y:1.429},{time:.8333,x:1.129,y:1.129},{time:1,x:1.25,y:1.25},{time:1.4167,x:1.683,y:1.683}]},{target:[this.lock.lockTop,this.lockAdd.lockTop],rotate:[{time:1,curve:[1.167,0,1.333,-121.38]},{time:1.5,value:-121.38}],translate:[{time:1,curve:[1.071,4.02,1.138,25.65,1.001,12.95,1.03,100.38]},{time:1.1667,x:41.82,y:101.94,curve:[1.192,55.82,1.331,86.21,1.372,104.27,1.418,-140.5]},{time:1.5,x:88.65,y:-299.65}]},{target:[this.lock.lockBody,this.lockAdd.lockBody],rotate:[{time:1,curve:[1.144,0,1.289,-41.15]},{time:1.4333,value:-41.15}],translate:[{time:1,curve:[1.033,8.2,1.072,18.35,1,11.4,1.015,28.43]},{time:1.1333,x:24.72,y:26.74,curve:[1.157,27.2,1.325,30.81,1.254,25.02,1.43,-185.2]},{time:1.4333,x:31.32,y:-250.19}]},{target:this.lockAdd,rgba:[{time:.4333,color:"ffffff00"},{time:.6667,color:"ffffffff",curve:"stepped"},{time:1.4167,color:"ffffffff"},{time:1.4333,color:"ffffff00"}]},{target:this.lockGlow,scale:[{time:.9333,curve:[YO,1.429,1.037,2.964,YO,1.429,1.037,2.964]},{time:1.4167,x:5.058,y:5.058}],rgba:[{time:.9333,color:"ffffff00",curve:[.956,1,.978,1,.956,1,.978,1,.956,1,.978,1,.933,.2,.978,.48]},{time:1,color:"ffffff7a"},{time:1.4167,color:"ffffff00"}]}])},t}(Phaser.GameObjects.Container),zO=HO,KO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.groupSize=void 0,n.scene=t,n.groupSize=n.scene.journeyDataService.getMaxSizePerGroup(),n.create(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.alignMaps(n.length),s=[],o=a().mark((function e(){var o,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=r[c],h=n[c],u=i[c],o.updateMapData(t[c],i[c]),o.shouldPlayUpdateMapDataAnimation(h,u)&&(l=1e3*s.length,s.push((function(){return o.playUpdateMapDataAnimation(h,u,l)})));case 5:case"end":return e.stop()}}),e)})),c=0;case 4:if(!(c<r.length)){e.next=9;break}return e.delegateYield(o(),"t0",6);case 6:c++,e.next=4;break;case 9:if(!(s.length>0)){e.next=15;break}return h=s.map((function(e){return e()})),e.next=13,Promise.all(h);case 13:e.next=17;break;case 15:return e.next=17,(0,me.qZ)(300);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<this.groupSize;e++){var t=new zO(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(this.groupSize)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var r=10*(i-(e-1)/2),a=188*(i-(e-1)/2),s=16*Math.abs(i-n)-15;t.setAngle(r),t.setX(a),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),VO=KO,XO=Ki.Z.JOURNEY,jO=XO.KEY,qO=XO.FRAME,JO=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.circles=void 0,i.currentPageCircle=void 0,i.circleData=void 0,i.curPageIdx=void 0,i.totalPages=void 0,i.selectPageCallback=void 0,i.isAnimating=void 0,i.activeCircleIndex=void 0,i.slidePageQueue=[],i.startIndex=void 0,i.endIndex=void 0,i.slideDuration=void 0,i.selectPageNormal=function(e){i.currentPageCircle.setX(i.circles[e].x),i.curPageIdx=e},i.selectPageSpecial=function(e){if(e!==i.curPageIdx){var t=e>i.curPageIdx?-1:1;i.curPageIdx=e;var n=i.activeCircleIndex-t;i.circleData[n].isActive?(i.activeCircleIndex=n,i.runCurrentCircleAnimation(i.circles[i.activeCircleIndex].x)):i.runSlidePage(t)}},i.scene=t,i.totalPages=n,i.curPageIdx=0,i.createCircles(),i.createCurrentCircle(),i.alignCircles(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.selectPage=function(e,t){var n=Math.abs(e-this.curPageIdx);this.slideDuration=Phaser.Math.Clamp(t-100,0,200);for(var i=e>this.curPageIdx?1:-1,r=this.curPageIdx,a=0;a<n;)r+=i,this.selectPageCallback(r),a++},n.createCircles=function(){this.totalPages<=3?(this.circles=this.createNormalCircles(this.totalPages),this.selectPageCallback=this.selectPageNormal):(this.circles=this.createSpecialCircles(),this.selectPageCallback=this.selectPageSpecial)},n.runCurrentCircleAnimation=function(e){0!=this.slideDuration?this.scene.tweens.add({targets:this.currentPageCircle,x:e,duration:100,ease:Phaser.Math.Easing.Sine.Out}):this.currentPageCircle.setX(e)},n.runSlidePage=function(e){var t=this;this.isAnimating?this.slidePageQueue.push((function(){return t.runSlidePage(e)})):(this.isAnimating=!0,this.startIndex=this.startIndex+e,this.endIndex=this.endIndex+e,this.runSlideCircles(e).then((function(){return t.onSlideComplete(e)})))},n.onSlideComplete=function(e){if(this.reorderCircles(e),this.updateVisibility(),this.isAnimating=!1,this.slidePageQueue.length>0){var t=this.slidePageQueue.shift();t&&t()}},n.reorderCircles=function(e){if(-1===e){var t=this.circles.shift();t&&this.circles.push(t)}else{var n=this.circles.pop();n&&this.circles.unshift(n)}},n.runSlideCircles=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.circles.map((function(e,n){var r=(n+t+i.circles.length)%i.circles.length;return i.runCircleSlideAnimation(e,r)})),e.next=3,Promise.race(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCircleSlideAnimation=function(e,t){var n=this;return new Promise((function(i){n.scene.tweens.add({targets:e,x:n.circleData[t].x,scale:n.circleData[t].scale,alpha:n.circleData[t].alpha,duration:n.slideDuration,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){i()}})}))},n.updateVisibility=function(){var e=this;this.circles.forEach((function(t,n){n>=e.startIndex&&n<=e.endIndex?t.setVisible(!0):t.setVisible(!1)}))},n.alignCircles=function(){var e=this;this.circleData=[],this.circles.forEach((function(t,n){0===n?t.setX(0):t.setX(e.circles[n-1].x+e.circles[n-1].displayWidth/2+e.circles[n].displayWidth/2+4)})),1===this.circles.length?this.setSize(this.circles[0].displayWidth,this.circles[0].displayHeight):this.setSize(this.circles[this.circles.length-1].x-this.circles[0].x+this.circles[0].displayWidth,this.circles[0].displayHeight),this.circles.forEach((function(t){t.x-=e.width/2})),this.circles.forEach((function(t,n){e.circleData.push({x:t.x,scale:t.scale,alpha:t.alpha,isActive:n>2&&n<6})})),this.activeCircleIndex=this.circleData.findIndex((function(e){return e.isActive})),-1!==this.activeCircleIndex&&this.currentPageCircle.setX(this.circles[this.activeCircleIndex].x),this.updateVisibility()},n.createCurrentCircle=function(){var e=this.scene.add.image(0,0,jO,qO.PAGINATION.CURRENT_PAGE_POSITION_CIRCLE);e.setDefaultWorldSize(),e.setY(.8),this.add(e),this.currentPageCircle=e},n.createNormalCircles=function(e){for(var t=[],n=0;n<e;n++){var i=this.scene.add.image(0,0,jO,qO.PAGINATION.PAGE_CIRCLE);i.setDefaultWorldSize(),this.add(i),t.push(i)}return t},n.createSpecialCircles=function(){for(var e=[],t=0;t<9;t++){var n=this.scene.add.image(0,0,jO,qO.PAGINATION.PAGE_CIRCLE);n.setDefaultWorldSize(),0===t||8===t?n.setScale(0):1===t||7===t?n.setScale(1/8):2===t||6===t?n.setScale(.2):n.setScale(1/3),this.add(n),e.push(n)}var i=this.totalPages-1;return this.startIndex=3,this.endIndex=i+3,e},t}(Phaser.GameObjects.Container),QO=Ki.Z.JOURNEY,$O=QO.KEY,eR=QO.FRAME,tR=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.completedRibbon=void 0,r.inProgressRibbon=void 0,r.lockRibbon=void 0,r.nameText=void 0,r.scene=t,r.create(),r.setSize(n,i),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.setMapName=function(e){this.nameText.setText(e);var t=Math.max(10,16-Math.floor(e.length/12*3));this.nameText.setFontSize(this.scene.fontSize(t))},n.create=function(){this.createCompletedRibbon(),this.createInProgressRibbon(),this.createLockRibbon(),this.createText()},n.createCompletedRibbon=function(){this.completedRibbon=this.scene.add.image(0,0,$O,eR.MAP_BLOCK.RIBBON.PINK),this.completedRibbon.setDefaultWorldSize(),this.add(this.completedRibbon),this.completedRibbon.setVisible(!1)},n.createInProgressRibbon=function(){this.inProgressRibbon=this.scene.add.image(0,0,$O,eR.MAP_BLOCK.RIBBON.BLUE),this.inProgressRibbon.setDefaultWorldSize(),this.add(this.inProgressRibbon),this.inProgressRibbon.setVisible(!1)},n.createLockRibbon=function(){this.lockRibbon=this.scene.add.image(0,0,$O,eR.MAP_BLOCK.RIBBON.RED),this.lockRibbon.setDefaultWorldSize(),this.add(this.lockRibbon),this.lockRibbon.setVisible(!1)},n.setLockRibbon=function(e){this.lockRibbon.setVisible(e)},n.setRibbon=function(e){this.completedRibbon.setVisible(e===bR.Finished),this.inProgressRibbon.setVisible(e===bR.InProgress),this.lockRibbon.setVisible(e===bR.Lock)},n.createText=function(){var e=new Qp(this.scene,{text:"Map Name",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setText("Map Name"),this.nameText=e,this.add(this.nameText),this.nameText.setPosition(0,-4)},t}(Phaser.GameObjects.Container),nR=tR,iR=Ki.Z.JOURNEY,rR=iR.KEY,aR=iR.FRAME,sR=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.leftDecoration=void 0,r.leftLockDecoration=void 0,r.rightDecoration=void 0,r.rightLockDecoration=void 0,r.scene=t,r.create(),r.setSize(n,i),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){},n.create=function(){this.createDecorations()},n.setTint=function(e){this.leftDecoration.setTintFill(e),this.rightDecoration.setTintFill(e)},n.setLockDecoration=function(e){this.leftLockDecoration.setVisible(e),this.rightLockDecoration.setVisible(e)},n.setWidth=function(e){this.setSize(e,this.height),this.leftDecoration.setX(-e/2),this.rightDecoration.setX(e/2),this.leftLockDecoration.setX(this.leftDecoration.x),this.rightLockDecoration.setX(this.rightDecoration.x)},n.createDecorations=function(){this.leftDecoration=this.scene.add.image(-this.width/2,0,rR,aR.MAP_BLOCK.DECORATION),this.leftDecoration.setDefaultWorldSize(),this.add(this.leftDecoration),this.leftLockDecoration=this.scene.add.image(this.leftDecoration.x,0,rR,aR.MAP_BLOCK.LOCK_DECORATION),this.leftLockDecoration.setDefaultWorldSize(),this.add(this.leftLockDecoration);var e=this.width/2-this.leftDecoration.displayHeight/2-2;this.rightDecoration=this.scene.add.image(this.height/2,0,rR,aR.MAP_BLOCK.DECORATION),this.rightDecoration.setDefaultWorldSize(),this.rightDecoration.setFlipX(!0),this.add(this.rightDecoration),this.rightLockDecoration=this.scene.add.image(this.rightDecoration.x,0,rR,aR.MAP_BLOCK.LOCK_DECORATION),this.rightLockDecoration.setDefaultWorldSize(),this.rightLockDecoration.setFlipX(!0),this.add(this.rightLockDecoration),this.leftDecoration.setY(e),this.leftLockDecoration.setY(e),this.rightDecoration.setY(e),this.rightLockDecoration.setY(e)},t}(Phaser.GameObjects.Container),oR=sR;function cR(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return hR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hR(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var uR=Ki.Z.JOURNEY,lR=uR.KEY,dR=uR.FRAME,pR=501.5/3,fR=376/3,mR=1.004,gR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.background=void 0,n.lockBackground=void 0,n.thumbnail=void 0,n.progressBar=void 0,n.mapNameRibbon=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.decoration=void 0,n.status=void 0,n.thumbnailKey=void 0,n.thumbnailBorder=void 0,n.cardShines=void 0,n.lock=void 0,n.checkMark=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,yc.Z)(n)),n.setScale(.95),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.updateAlignment(e),this.setMapActive(e===bR.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.updateAlignment(t),this.setMapActive(t===bR.InProgress);var n=e.progressBar,i=n.currentProgress,r=n.maxProgress;this.progressBar.setProgressBarFill(i,r)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===bR.Lock&&t===bR.InProgress,i=e===bR.InProgress&&t===bR.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(r=t===bR.Lock&&n===bR.InProgress,s=t===bR.InProgress&&n===bR.Finished,!r){e.next=12;break}return this.updateVisibility(bR.Lock),this.updateAlignment(bR.Lock),this.setMapActive(!1),e.next=11,this.playUnlockMapAnimation(i);case 11:return e.abrupt("return");case 12:if(!s){e.next=18;break}return this.updateVisibility(bR.InProgress),this.updateAlignment(bR.InProgress),this.setMapActive(!0),e.next=18,this.playFinishedMapAnimation(i);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===bR.Lock),this.checkMark.setVisible(e===bR.Finished),this.progressBar.setVisible(e===bR.InProgress),this.mapNameRibbon.setLockRibbon(e===bR.Lock),this.lockBackground.setVisible(e===bR.Lock),this.decoration.setLockDecoration(e===bR.Lock),this.mapNameRibbon.setRibbon(e),e===bR.Lock?(this.thumbnailFrame.setPipeline("LockEffect"),this.thumbnailBorder.setFrame(dR.MAP_BLOCK.LOCKED_FRAME)):(this.thumbnailFrame.resetPipeline(!0,!0),this.thumbnailBorder.setFrame(dR.MAP_BLOCK.JOURNEY_FRAME))},n.updateAlignment=function(e){this.decoration.setWidth(e===bR.InProgress?this.progressBar.displayWidth-6:27)},n.setMapActive=function(e){void 0===e&&(e=!0);var t=e?mR:1;this.offsetOriginWrapper.setScale(t),this.offsetOriginWrapper.setY((1-t)*this.height/4+40)},n.updateMapName=function(e){this.mapNameRibbon.setMapName(e)},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function r(){i.showLoading(!0);var a="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(pR,fR),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(a,r),i.previousEventName=a}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+18),this.loading.setY(this.thumbnail.y),this.progressBar.setPosition(0,64),this.mapNameRibbon.setPosition(-this.background.width/2+this.mapNameRibbon.displayWidth/2+8.75,-this.background.height/2+18),this.decoration.setY(this.background.height/2-20),this.decoration.setWidth(this.progressBar.displayWidth-5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=a().mark((function e(){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=s.cardShines[r]).revive(),i.setAlpha(0),o=s.scene.tweens.add({targets:i,alpha:.08,delay:t+150*r,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(o);case 5:case"end":return e.stop()}}),e)})),r=0;case 5:if(!(r<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:r++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(bR.InProgress),this.updateAlignment(bR.InProgress),this.offsetOriginWrapper.setScale(mR),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,gl.Z)(this.scene,t+500).then((function(){i.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.REWARD_GIFT)})),e.next=12,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.scene.tweens.add({targets:this.decoration,width:27,ease:Phaser.Math.Easing.Elastic.InOut,easeParams:[.1,.6],delay:t+400,duration:n,onUpdate:function(){i.decoration.setWidth(i.decoration.width)}}).waitForCompletion()]);case 12:this.alignItems(),this.updateAlignment(bR.Finished),this.setMapActive(!1);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.progressBar.revive(),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),e.next=7,Promise.all([this.scene.tweens.add({targets:this.lock,scale:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.4],delay:t,duration:1e3}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:-.0040000000000000036*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.decoration,width:135,ease:Phaser.Math.Easing.Sine.InOut,delay:t+1e3,duration:300,onUpdate:function(){n.decoration.setWidth(n.decoration.width)}}).waitForCompletion(),this.scene.tweens.add({targets:this.lockBackground,alpha:0,delay:t+1100,duration:180,onComplete:function(){n.lockBackground.setVisible(!1),n.lockBackground.setAlpha(1)}}).waitForCompletion()]);case 7:this.lock.kill(),this.lock.setScale(1),this.alignItems(),this.setMapActive(!0);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createBackground(),this.createLockBackground(),this.createThumbnail(),this.createDecorations(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createMapNameRibbon(),this.createCardShines()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createBackground=function(){var e=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createLockBackground=function(){var e=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.LOCK_CARD);e.setDefaultWorldSize(),this.wrapper.add(e),this.lockBackground=e},n.createCardShines=function(){for(var e,t=[],n=cR(dR.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,r=this.scene.add.image(0,0,lR,i);r.setDefaultWorldSize(),r.setBlendMode(Phaser.BlendModes.ADD),r.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),r.kill(),this.wrapper.add(r),t.push(r)}var a=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.CARD_SHINES[0]);a.setDefaultWorldSize(),a.setScale(t[0].scaleX,t[0].scaleY),a.setBlendMode(Phaser.BlendModes.ADD),a.setPosition(-t[0].displayWidth/2+a.displayWidth/2,t[0].displayHeight/2-a.displayHeight/2),this.wrapper.add(a);var s=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.CARD_SHINES[dR.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[a].concat(t,[s]),a.kill(),s.kill()},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(pR,fR);var e=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.PLACE_HOLDER);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.PLACE_HOLDER);t.setDefaultWorldSize();var n=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.JOURNEY_FRAME);n.setDefaultWorldSize(),this.thumbnail.add([e,t,n]),this.thumbnailFrame=t,this.thumbnailBorder=n},n.createProgressBar=function(){this.progressBar=new OO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createMapNameRibbon=function(){var e=new nR(this.scene,this.width,this.height);this.wrapper.add(e),this.mapNameRibbon=e},n.createLock=function(){this.lock=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.NEW_ICON_LOCK),this.lock.setDefaultWorldSize(),this.lock.setY(53.325),this.wrapper.add(this.lock),this.lock.kill()},n.createDecorations=function(){this.decoration=new oR(this.scene,this.width,this.height),this.wrapper.add(this.decoration)},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,lR,dR.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(53.325),this.checkMark.kill()},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(44,44),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},t}(Phaser.GameObjects.Container),vR=gR,yR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.scene=t,n.create(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.alignMaps(n.length),s=[],o=0;o<r.length;o++)r[o].updateMapData(t[o],i[o]);if(!(s.length>0)){e.next=9;break}return c=s.map((function(e){return e()})),e.next=7,Promise.all(c);case 7:e.next=11;break;case 9:return e.next=11,(0,me.qZ)(300);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<3;e++){var t=new vR(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(3)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var r=5.3*(i-(e-1)/2),a=199*(i-(e-1)/2)*t.scale,s=8*Math.abs(i-n)-15;t.setAngle(0===r?-.2:r),t.setX(a),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),ER=yR,CR=Ki.Z.JOURNEY,wR=CR.KEY,AR=CR.FRAME,bR=function(e){return e.Lock="lock",e.InProgress="in_progress",e.Finished="finished",e}({}),SR=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).closeButton=void 0,a.mapGroup=void 0,a.mapGroupPool=void 0,a.scrollEventContainer=void 0,a.lastDragX=void 0,a.firstX=void 0,a.isDraggable=void 0,a.curScrollIdx=void 0,a.mapPayloads=void 0,a.pagination=void 0,a.onDragStart=function(){a.mapGroup.forEach((function(e){a.scene.tweens.killTweensOf(e)})),a.isDraggable||(a.isDraggable=!0,a.lastDragX=a.scene.input.activePointer.worldX,a.firstX=a.lastDragX)},a.onDrag=function(e,t){if(a.isDraggable){var n=a.scene.input.activePointer.worldX;if(!(a.curScrollIdx<=0&&t>0&&a.mapGroup[a.curScrollIdx].x>=0||a.curScrollIdx>=a.mapGroup.length-1&&t<0&&a.mapGroup[a.curScrollIdx].x<=0)){n-a.firstX<=0?(a.hidePage(a.curScrollIdx-1),a.updatePageByScroll(a.curScrollIdx+1)):(a.hidePage(a.curScrollIdx+1),a.updatePageByScroll(a.curScrollIdx-1));var i=n-a.lastDragX;a.mapGroup.forEach((function(e){return e.x+=i})),a.lastDragX=n}}},a.onDragEnd=function(){if(a.isDraggable){a.isDraggable=!1;var e=a.scene.input.activePointer.worldX,t=a.scene.input.activePointer.velocity.x,n=a.mapGroup[a.curScrollIdx],i=e-a.firstX,r=a.curScrollIdx;(i<=-n.width/2||t<-25&&i<-40)&&(r=Phaser.Math.Clamp(r+1,0,a.mapGroup.length-1)),(i>=n.width/2||t>25&&i>40)&&(r=Phaser.Math.Clamp(r-1,0,a.mapGroup.length-1)),a.selectPage(r)}},a.setBackground=function(e){a.background.setTexture(e),a.updateBackgroundSize()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a)),a.mapGroup.forEach((function(e){return e.setVisible(!1)}));var t=a.scene.level.getLevel();a.scene.events.emit(pi.AUTO_SHOWING_JOURNEY,!1),a.scene.gameUI.coinBarButton.setDisabled(!1),a.scene.screen.open(de.o4.DASHBOARD_SCREEN,{level:t})},a.create(),a.mapGroupPool=[],a.zone.disableInteractive(),Ap.Z.registerObject(a.background),a.listenEvents(),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),Ap.Z.setColor("121 54 27"),i=n.shouldCloseAfterComplete,r=void 0!==i&&i,this.scrollEventContainer.disableInteractive(),this.isDraggable=!1,this.closeButton.setDisabled(!0),this.closeButton.setAlpha(1),this.runEntranceAnimation(),t.next=10,this.updateData();case 10:r?(0,gl.Z)(this.scene,400).then((function(){s.scene.screen.close(de.o4.JOURNEY_SCREEN)})):this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.closeButton.setDisabled(!1);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){Ap.Z.setColor("0 0 0"),this.runExitAnimation()},n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,this.mapPayloads=n,r=this.getGroupsToUpdate(i),s=0;case 4:if(!(s<r.length)){e.next=17;break}if(o=r[s],!(c=this.prepareMapGroupContainer(o))){e.next=14;break}return this.selectPage(o,0===s?0:300),h=this.mapGroup[o].getData("mapStatus"),u=this.getNewMapStatuses(this.mapPayloads[o]),e.next=13,c.updateMapData(this.mapPayloads[o],h,u);case 13:this.mapGroup[o].setData("mapStatus",u);case 14:s++,e.next=4;break;case 17:return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNewMapStatuses=function(e){return e.map((function(e){var t=e.progressBar;if(!t)return bR.Lock;var n=t.lock,i=void 0===n||n,r=t.currentProgress,a=void 0===r?0:r,s=t.maxProgress,o=void 0===s?15:s;return i?bR.Lock:a===o?bR.Finished:bR.InProgress}))},n.getGroupsToUpdate=function(e){var t=this.mapGroup.map((function(e,t){return{index:t,data:e.getData("mapStatus")}})).filter((function(e){return e.data.some((function(e){return e===bR.InProgress}))})).map((function(e){return e.index}));return t.includes(e)||t.push(e),t},n.updatePageByScroll=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.prepareMapGroupContainer(t))){e.next=6;break}return i=this.mapGroup[t].getData("mapStatus"),r=this.getNewMapStatuses(this.mapPayloads[t]),e.next=6,n.updateMapData(this.mapPayloads[t],i,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.prepareMapGroupContainer=function(e){var t=this.mapGroup[e];return!t||t.visible?null:(t.revive(),this.getMapGroupContainer(t))},n.getMapGroupContainer=function(e){var t=e.getAll().find((function(e){return e instanceof ER}));return t||(t=this.getMapGroupContainerFromPool(e),e.add(t)),t},n.getMapGroupContainerFromPool=function(e){var t=this.mapGroupPool.find((function(e){return!e.active}));t||(t=new ER(this.scene),this.mapGroupPool.push(t));var n=e.getData("mapStatus");return t.reset(n),t.revive(),t},n.hidePage=function(e){var t=this.mapGroup[e];t&&t.visible&&(t.x<-this.scene.gameZone.width||t.x>this.scene.gameZone.width)&&(t.kill(),this.removeMapGroupContainer(t))},n.removeMapGroupContainer=function(e){e.getAll().forEach((function(t){t instanceof VO&&(e.getData("mapStatus").some((function(e){return e===bR.InProgress}))||(t.kill(),e.remove(t)))}))},n.listenEvents=function(){this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd)},n.selectPage=function(e,t){void 0===t&&(t=300),this.createTweenMovePage(e,t)},n.setVisibleListContainer=function(e,t,n){for(var i=t;i<=n;i++){var r=this.mapGroup[i];r&&i!=this.curScrollIdx&&r.setVisible(e)}},n.createTweenMovePage=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===n&&(n=300),this.mapGroup[t].setVisible(!0),i=Math.min(t,this.curScrollIdx),r=Math.max(t,this.curScrollIdx),s=i;s<=r;s++)s!=this.curScrollIdx&&this.mapGroup[s].setVisible(!0);this.curScrollIdx=t,this.mapGroup.forEach((function(e,i){o.scene.tweens.killTweensOf(e),o.scene.tweens.add({targets:e,x:e.x-o.mapGroup[t].x,duration:n,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){o.setVisibleListContainer(!1,0,o.mapGroup.length-1),t!=i&&e instanceof Phaser.GameObjects.Container&&(e.kill(),o.removeMapGroupContainer(e))}})})),this.pagination.selectPage(t,n);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createBackground(),this.createTitle(),this.createMapGroupContainers(),this.createScrollEventContainer(),this.createPagination(),this.createCloseButton()},n.createBackground=function(){this.background=this.scene.add.image(0,0,oe.Z.JOURNEY_BACKGROUND.KEY),this.background.setDefaultWorldSize(),this.add(this.background),this.updateBackgroundSize()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:this.scene.lang.Text.journey,origin:{x:.5,y:.5}});this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-.5)},n.createCloseButton=function(){var e=this;this.closeButton=new ov.Z(this.scene,{key:wR,frame:AR.CLOSE_BUTTON,width:77/3,height:77/3,paddingZone:30}),this.closeButton.setName("Close"),this.add(this.closeButton),Phaser.Display.Align.In.TopRight(this.closeButton,this,-5,-7),this.closeButton.onClick=function(){e.scene.screen.close(e.name),e.closeButton.setDisabled(!0)}},n.createMapGroupContainers=function(){this.curScrollIdx=0,this.mapGroup=[];for(var e=this.scene.journeyDataService.getTotalPages(),t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,r=n.slice(0,i+1),a=0;a<e;a++){var s=this.scene.add.container(0,0);s.setSize(this.width,this.height),s.kill();var o=new Array(3).fill(bR.Lock);a<=r.length-1&&(o=r[a].map((function(e){var t=e.progressBar;return t?t.lock?bR.Lock:t.currentProgress==t.maxProgress?bR.Finished:bR.InProgress:bR.Lock}))),s.setData("mapStatus",o),this.add(s),this.mapGroup.push(s)}this.alignMapGroup()},n.createScrollEventContainer=function(){var e=this.scene.add.container(0,0);this.add(e),e.setSize(this.width,this.height),Phaser.Display.Align.In.Center(this,e),this.scrollEventContainer=e},n.createPagination=function(){var e=this.scene.journeyDataService.getTotalPages(),t=new JO(this.scene,e);this.add(t),Phaser.Display.Align.In.BottomCenter(t,this,0,-13),this.pagination=t},n.alignMapGroup=function(){var e=this;this.mapGroup.forEach((function(t,n){t.setX(n*e.scene.gameZone.width)}))},n.updateBackgroundSize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.scene.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var r=this.background,a=r.scaleX,s=r.scaleY;"height"===i?this.background.setScale(s):this.background.setScale(a)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen);function TR(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return xR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xR(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var kR,PR=Ki.Z.JOURNEY,IR=PR.KEY,OR=PR.FRAME,RR=376/3,BR=335/3,DR=1.13,LR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.shadow=void 0,n.background=void 0,n.overlay=void 0,n.thumbnail=void 0,n.mapName=void 0,n.progressBar=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.status=void 0,n.thumbnailKey=void 0,n.cardShines=void 0,n.multiplyLabelShine=void 0,n.additiveLabelShine=void 0,n.lock=void 0,n.lockGlow=void 0,n.lockAdd=void 0,n.checkMark=void 0,n.unlockMapAnimation=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.setMapActive(e===UR.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.setMapActive(t===UR.InProgress);var n=e.progressBar,i=n.currentProgress,r=n.maxProgress;this.progressBar.setProgressBarFill(i,r)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===UR.Lock&&t===UR.InProgress,i=e===UR.InProgress&&t===UR.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(r=t===UR.Lock&&n===UR.InProgress,s=t===UR.InProgress&&n===UR.Finished,!r){e.next=11;break}return this.updateVisibility(UR.Lock),this.setMapActive(!1),e.next=10,this.playUnlockMapAnimation(i);case 10:return e.abrupt("return");case 11:if(!s){e.next=16;break}return this.updateVisibility(UR.InProgress),this.setMapActive(!0),e.next=16,this.playFinishedMapAnimation(i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===UR.Lock),this.checkMark.setVisible(e===UR.Finished),this.progressBar.setVisible(e===UR.InProgress),this.overlay.setAlpha(e===UR.Lock?.5:0)},n.setMapActive=function(e){void 0===e&&(e=!0);var t=e?DR:1;this.offsetOriginWrapper.setScale(t),this.offsetOriginWrapper.setY((1-t)*this.height/4+40)},n.updateMapName=function(e){var t=this.scene.lang.getText(e);this.mapName.setText(t),this.mapName.width>this.background.width-5?this.mapName.setFontSize(this.scene.fontSize(15)):this.mapName.setFontSize(this.scene.fontSize(16))},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function r(){i.showLoading(!0);var a="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(RR,BR),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(a,r),i.previousEventName=a}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.shadow.setY(2),this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+6),this.loading.setY(this.thumbnail.y),this.mapName.setY(this.thumbnail.y+this.thumbnail.height/2+14),this.progressBar.setY(68),this.lockGlow.setPosition(this.progressBar.x,this.progressBar.y+5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=a().mark((function e(){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=s.cardShines[r]).revive(),i.setAlpha(0),o=s.scene.tweens.add({targets:i,alpha:.08,delay:t+150*r,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(o);case 5:case"end":return e.stop()}}),e)})),r=0;case 5:if(!(r<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:r++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playLabelShineAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.multiplyLabelShine.revive(),this.additiveLabelShine.revive(),this.multiplyLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),this.additiveLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),n=800,this.multiplyLabelShine.setAlpha(0),this.additiveLabelShine.setAlpha(0),this.multiplyLabelShine.setScale(1.5,.4),this.additiveLabelShine.setScale(1.5,.4),e.next=12,Promise.all([this.scene.tweens.add({targets:this.additiveLabelShine,alpha:.5,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.multiplyLabelShine,alpha:1,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],x:this.mapName.x+this.mapName.width/2,delay:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],scaleX:2,yoyo:!0,delay:t,duration:400,ease:Phaser.Math.Easing.Cubic.InOut}).waitForCompletion()]);case 12:this.multiplyLabelShine.kill(),this.additiveLabelShine.kill();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(UR.InProgress),this.offsetOriginWrapper.setScale(DR),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,gl.Z)(this.scene,t+500).then((function(){i.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.REWARD_GIFT)})),e.next=11,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.playCardShineAnimation(t+400)]);case 11:this.alignItems(),this.setMapActive(!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.lockAdd.revive(),this.lockGlow.revive(),this.progressBar.revive(),this.unlockMapAnimation.setDelay(t),this.overlay.setAlpha(.5),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),this.unlockMapAnimation.events.on("startDelay",(function(){(0,gl.Z)(n.scene,550).then((function(){n.scene.audio.playAudioSprite(Hc.Z.CARD.KEY,rc.Z.TWIST_LOCK)}))})),e.next=12,Promise.all([this.unlockMapAnimation.start(),this.playCardShineAnimation(t+1700),this.playLabelShineAnimation(t+1200),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:-.1299999999999999*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.overlay,alpha:0,delay:t+1100,duration:180}).waitForCompletion()]);case 12:this.lock.kill(),this.lockAdd.kill(),this.lockGlow.kill(),this.lock.reset(),this.lockAdd.reset(),this.lock.setScale(1),this.lockAdd.setScale(1),this.alignItems(),this.setMapActive(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createShadow(),this.createBackground(),this.createThumbnail(),this.createMapName(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createOverlay(),this.createCardShines(),this.createLabelShine(),this.createLockShines(),this.createUnlockMapAnimation()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createShadow=function(){var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.BACKGROUND_SHADOW);e.setDefaultWorldSize(),this.wrapper.add(e),this.shadow=e},n.createBackground=function(){var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),e.setTint(5450259),e.setAlpha(0),this.wrapper.add(e),this.overlay=e},n.createCardShines=function(){for(var e,t=[],n=TR(OR.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,r=this.scene.add.image(0,0,IR,i);r.setDefaultWorldSize(),r.setBlendMode(Phaser.BlendModes.ADD),r.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),r.kill(),this.wrapper.add(r),t.push(r)}var a=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.CARD_SHINES[0]);a.setDefaultWorldSize(),a.setScale(t[0].scaleX,t[0].scaleY),a.setBlendMode(Phaser.BlendModes.ADD),a.setPosition(-t[0].displayWidth/2+a.displayWidth/2,t[0].displayHeight/2-a.displayHeight/2),this.wrapper.add(a);var s=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.CARD_SHINES[OR.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[a].concat(t,[s]),a.kill(),s.kill()},n.createLabelShine=function(){var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.LABEL_SHINE);e.setDefaultWorldSize(),e.setScale(0,.4),e.setBlendMode(Phaser.BlendModes.MULTIPLY),e.setTint(13332544),e.setAlpha(1),e.kill(),this.wrapper.add(e),this.multiplyLabelShine=e;var t=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.LABEL_SHINE);t.setDefaultWorldSize(),t.setScale(0,.4),t.setBlendMode(Phaser.BlendModes.ADD),t.setAlpha(.3),t.kill(),this.wrapper.add(t),this.additiveLabelShine=t},n.createLockShines=function(){var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.LOCK_SHINE);e.setDefaultWorldSize(),e.setBlendMode(Phaser.BlendModes.ADD),e.setAlpha(1),e.setScale(3/9),e.kill(),this.wrapper.add(e),this.lockGlow=e;var t=new MO(this.scene);this.wrapper.add(t),t.setPosition(0,68),t.kill(),this.lockAdd=t},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(RR,BR);var e=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.THUMBNAIL_BACKGROUND);e.setWorldSize(RR,BR),this.thumbnail.add(e);var t=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.THUMBNAIL);t.setDefaultWorldSize(),this.thumbnail.add(t);var n=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.THUMBNAIL_FOREGROUND);n.setDefaultWorldSize(),this.thumbnail.add(n),this.thumbnailFrame=t},n.createMapName=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.HEADER.KEY,size:this.scene.fontSize(16),text:"Triple Cut",origin:{x:.5,y:.5}});this.wrapper.add(e),this.mapName=e},n.createProgressBar=function(){this.progressBar=new OO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createLock=function(){this.lock=new MO(this.scene),this.wrapper.add(this.lock),this.lock.setPosition(0,68),this.lock.kill()},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,IR,OR.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(68),this.checkMark.kill()},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},n.createUnlockMapAnimation=function(){this.unlockMapAnimation=new VA([{target:this.offsetOriginWrapper,rotate:[{time:.55,curve:[.583,0,.617,2.62]},{time:.65,value:2.62,curve:[.667,2.62,.683,-2.63]},{time:.7,value:-2.63,curve:[.728,-2.63,.756,4.48]},{time:.7833,value:4.48,curve:[.806,4.48,.828,-3.45]},{time:.85,value:-3.45,curve:[.878,-3.45,.906,3.84]},{time:.9333,value:3.84,curve:[.961,3.84,.989,1.28]},{time:1.0167}],scale:[{time:.1833,curve:[.191,.993,.228,.95,.191,.993,.228,.95]},{time:.25,x:.95,y:.95,curve:[.337,.95,.46,1.157,.337,.95,.46,1.157]},{time:.55,x:1.16,y:1.16,curve:[.728,1.166,.685,.969,.728,1.166,.685,.969]},{time:.7833,x:.942,y:.942,curve:[1.064,.866,.994,1.185,1.064,.866,.994,1.185]},{time:1.1833,x:1.18,y:1.18,curve:[1.279,1.178,1.359,1.114,1.279,1.178,1.359,1.114]},{time:1.45,x:1.11,y:1.11,curve:[1.523,1.107,1.645,1.125,1.523,1.107,1.645,1.125]},{time:1.6667,x:DR,y:DR}]},{target:[this.lock,this.lockAdd],scale:[{time:.1667,curve:[.194,1,.222,1.1,.194,1,.222,1.1]},{time:.25,x:1.1,y:1.1,curve:[.311,1.1,.372,.85,.311,1.1,.372,.85]},{time:.4333,x:.85,y:.85},{time:.6667,x:1.429,y:1.429},{time:.8333,x:1.129,y:1.129},{time:1,x:1.25,y:1.25},{time:1.4167,x:1.683,y:1.683}]},{target:[this.lock.lockTop,this.lockAdd.lockTop],rotate:[{time:1,curve:[1.167,0,1.333,-121.38]},{time:1.5,value:-121.38}],translate:[{time:1,curve:[1.071,4.02,1.138,25.65,1.001,12.95,1.03,100.38]},{time:1.1667,x:41.82,y:101.94,curve:[1.192,55.82,1.331,86.21,1.372,104.27,1.418,-140.5]},{time:1.5,x:88.65,y:-299.65}]},{target:[this.lock.lockBody,this.lockAdd.lockBody],rotate:[{time:1,curve:[1.144,0,1.289,-41.15]},{time:1.4333,value:-41.15}],translate:[{time:1,curve:[1.033,8.2,1.072,18.35,1,11.4,1.015,28.43]},{time:1.1333,x:24.72,y:26.74,curve:[1.157,27.2,1.325,30.81,1.254,25.02,1.43,-185.2]},{time:1.4333,x:31.32,y:-250.19}]},{target:this.lockAdd,rgba:[{time:.4333,color:"ffffff00"},{time:.6667,color:"ffffffff",curve:"stepped"},{time:1.4167,color:"ffffffff"},{time:1.4333,color:"ffffff00"}]},{target:this.lockGlow,scale:[{time:.9333,curve:[DR,1.429,1.037,2.964,DR,1.429,1.037,2.964]},{time:1.4167,x:5.058,y:5.058}],rgba:[{time:.9333,color:"ffffff00",curve:[.956,1,.978,1,.956,1,.978,1,.956,1,.978,1,.933,.2,.978,.48]},{time:1,color:"ffffff7a"},{time:1.4167,color:"ffffff00"}]}])},t}(Phaser.GameObjects.Container),MR=LR,_R=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.scene=t,n.create(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.alignMaps(n.length),s=[],o=a().mark((function e(){var o,h,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=r[c],h=n[c],u=i[c],o.updateMapData(t[c],i[c]),o.shouldPlayUpdateMapDataAnimation(h,u)&&(l=1e3*s.length,s.push((function(){return o.playUpdateMapDataAnimation(h,u,l)})));case 5:case"end":return e.stop()}}),e)})),c=0;case 4:if(!(c<r.length)){e.next=9;break}return e.delegateYield(o(),"t0",6);case 6:c++,e.next=4;break;case 9:if(!(s.length>0)){e.next=15;break}return h=s.map((function(e){return e()})),e.next=13,Promise.all(h);case 13:e.next=17;break;case 15:return e.next=17,(0,me.qZ)(300);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<3;e++){var t=new MR(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(3)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var r=10*(i-(e-1)/2),a=188*(i-(e-1)/2),s=16*Math.abs(i-n)-15;t.setAngle(r),t.setX(a),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),NR=_R,GR=Ki.Z.JOURNEY,FR=GR.KEY,ZR=GR.FRAME,UR=function(e){return e.Lock="lock",e.InProgress="in_progress",e.Finished="finished",e}({}),WR=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).closeButton=void 0,a.mapGroup=void 0,a.mapGroupPool=void 0,a.scrollEventContainer=void 0,a.lastDragX=void 0,a.firstX=void 0,a.isDraggable=void 0,a.curScrollIdx=void 0,a.mapPayloads=void 0,a.pagination=void 0,a.onDragStart=function(){a.mapGroup.forEach((function(e){a.scene.tweens.killTweensOf(e)})),a.isDraggable||(a.isDraggable=!0,a.lastDragX=a.scene.input.activePointer.worldX,a.firstX=a.lastDragX)},a.onDrag=function(e,t){if(a.isDraggable){var n=a.scene.input.activePointer.worldX;if(!(a.curScrollIdx<=0&&t>0&&a.mapGroup[a.curScrollIdx].x>=0||a.curScrollIdx>=a.mapGroup.length-1&&t<0&&a.mapGroup[a.curScrollIdx].x<=0)){n-a.firstX<=0?(a.hidePage(a.curScrollIdx-1),a.updatePageByScroll(a.curScrollIdx+1)):(a.hidePage(a.curScrollIdx+1),a.updatePageByScroll(a.curScrollIdx-1));var i=n-a.lastDragX;a.mapGroup.forEach((function(e){return e.x+=i})),a.lastDragX=n}}},a.onDragEnd=function(){if(a.isDraggable){a.isDraggable=!1;var e=a.scene.input.activePointer.worldX,t=a.scene.input.activePointer.velocity.x,n=a.mapGroup[a.curScrollIdx],i=e-a.firstX,r=a.curScrollIdx;(i<=-n.width/2||t<-25&&i<-40)&&(r=Phaser.Math.Clamp(r+1,0,a.mapGroup.length-1)),(i>=n.width/2||t>25&&i>40)&&(r=Phaser.Math.Clamp(r-1,0,a.mapGroup.length-1)),a.selectPage(r)}},a.setBackground=function(e){a.background.setTexture(e),a.updateBackgroundSize()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a)),a.mapGroup.forEach((function(e){return e.setVisible(!1)}));var t=a.scene.level.getLevel();a.scene.events.emit(pi.AUTO_SHOWING_JOURNEY,!1),a.scene.gameUI.coinBarButton.setDisabled(!1),a.scene.screen.open(de.o4.DASHBOARD_SCREEN,{level:t})},a.create(),a.mapGroupPool=[],a.zone.disableInteractive(),Ap.Z.registerObject(a.background),a.listenEvents(),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),Ap.Z.setColor("121 54 27"),i=n.shouldCloseAfterComplete,r=void 0!==i&&i,this.scrollEventContainer.disableInteractive(),this.isDraggable=!1,this.closeButton.setDisabled(!0),this.closeButton.setAlpha(1),this.runEntranceAnimation(),t.next=10,this.updateData();case 10:r?(0,gl.Z)(this.scene,400).then((function(){s.scene.screen.close(de.o4.JOURNEY_SCREEN)})):this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.closeButton.setDisabled(!1);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){Ap.Z.setColor("0 0 0"),this.runExitAnimation()},n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,this.mapPayloads=n,r=this.getGroupsToUpdate(i),s=0;case 4:if(!(s<r.length)){e.next=17;break}if(o=r[s],!(c=this.prepareMapGroupContainer(o))){e.next=14;break}return this.selectPage(o,0===s?0:300),h=this.mapGroup[o].getData("mapStatus"),u=this.getNewMapStatuses(this.mapPayloads[o]),e.next=13,c.updateMapData(this.mapPayloads[o],h,u);case 13:this.mapGroup[o].setData("mapStatus",u);case 14:s++,e.next=4;break;case 17:return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNewMapStatuses=function(e){return e.map((function(e){var t=e.progressBar;if(!t)return UR.Lock;var n=t.lock,i=void 0===n||n,r=t.currentProgress,a=void 0===r?0:r,s=t.maxProgress,o=void 0===s?15:s;return i?UR.Lock:a===o?UR.Finished:UR.InProgress}))},n.getGroupsToUpdate=function(e){var t=this.mapGroup.map((function(e,t){return{index:t,data:e.getData("mapStatus")}})).filter((function(e){return e.data.some((function(e){return e===UR.InProgress}))})).map((function(e){return e.index}));return t.includes(e)||t.push(e),t},n.updatePageByScroll=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.prepareMapGroupContainer(t))){e.next=6;break}return i=this.mapGroup[t].getData("mapStatus"),r=this.getNewMapStatuses(this.mapPayloads[t]),e.next=6,n.updateMapData(this.mapPayloads[t],i,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.prepareMapGroupContainer=function(e){var t=this.mapGroup[e];return!t||t.visible?null:(t.revive(),this.getMapGroupContainer(t))},n.getMapGroupContainer=function(e){var t=e.getAll().find((function(e){return e instanceof NR}));return t||(t=this.getMapGroupContainerFromPool(e),e.add(t)),t},n.getMapGroupContainerFromPool=function(e){var t=this.mapGroupPool.find((function(e){return!e.active}));t||(t=new NR(this.scene),this.mapGroupPool.push(t));var n=e.getData("mapStatus");return t.reset(n),t.revive(),t},n.hidePage=function(e){var t=this.mapGroup[e];t&&t.visible&&(t.x<-this.scene.gameZone.width||t.x>this.scene.gameZone.width)&&(t.kill(),this.removeMapGroupContainer(t))},n.removeMapGroupContainer=function(e){e.getAll().forEach((function(t){t instanceof VO&&(e.getData("mapStatus").some((function(e){return e===UR.InProgress}))||(t.kill(),e.remove(t)))}))},n.listenEvents=function(){this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd)},n.selectPage=function(e,t){void 0===t&&(t=300),this.createTweenMovePage(e,t)},n.setVisibleListContainer=function(e,t,n){for(var i=t;i<=n;i++){var r=this.mapGroup[i];r&&i!=this.curScrollIdx&&r.setVisible(e)}},n.createTweenMovePage=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===n&&(n=300),this.mapGroup[t].setVisible(!0),i=Math.min(t,this.curScrollIdx),r=Math.max(t,this.curScrollIdx),s=i;s<=r;s++)s!=this.curScrollIdx&&this.mapGroup[s].setVisible(!0);this.curScrollIdx=t,this.mapGroup.forEach((function(e,i){o.scene.tweens.killTweensOf(e),o.scene.tweens.add({targets:e,x:e.x-o.mapGroup[t].x,duration:n,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){o.setVisibleListContainer(!1,0,o.mapGroup.length-1),t!=i&&e instanceof Phaser.GameObjects.Container&&(e.kill(),o.removeMapGroupContainer(e))}})})),this.pagination.selectPage(t,n);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createBackground(),this.createTitle(),this.createMapGroupContainers(),this.createScrollEventContainer(),this.createPagination(),this.createCloseButton()},n.createBackground=function(){this.background=this.scene.add.image(0,0,oe.Z.JOURNEY_BACKGROUND.KEY),this.background.setDefaultWorldSize(),this.add(this.background),this.updateBackgroundSize()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(38),text:this.scene.lang.Text.journey,origin:{x:.5,y:.5}});this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-2)},n.createCloseButton=function(){var e=this;this.closeButton=new Vc.Z(this.scene,FR,ZR.CLOSE_BUTTON,100/3,104/3),this.closeButton.setName("Close"),this.add(this.closeButton),Phaser.Display.Align.In.TopRight(this.closeButton,this,-5,-5),this.closeButton.onClick=function(){e.scene.screen.close(e.name),e.closeButton.setDisabled(!0)}},n.createMapGroupContainers=function(){this.curScrollIdx=0,this.mapGroup=[];for(var e=this.scene.journeyDataService.getTotalPages(),t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,r=n.slice(0,i+1),a=0;a<e;a++){var s=this.scene.add.container(0,0);s.setSize(this.width,this.height),s.kill();var o=new Array(3).fill(UR.Lock);a<=r.length-1&&(o=r[a].map((function(e){var t=e.progressBar;return t?t.lock?UR.Lock:t.currentProgress==t.maxProgress?UR.Finished:UR.InProgress:UR.Lock}))),s.setData("mapStatus",o),this.add(s),this.mapGroup.push(s)}this.alignMapGroup()},n.createScrollEventContainer=function(){var e=this.scene.add.container(0,0);this.add(e),e.setSize(this.width,this.height),Phaser.Display.Align.In.Center(this,e),this.scrollEventContainer=e},n.createPagination=function(){var e=this.scene.journeyDataService.getTotalPages(),t=new JO(this.scene,e);this.add(t),Phaser.Display.Align.In.BottomCenter(t,this,0,-15),this.pagination=t},n.alignMapGroup=function(){var e=this;this.mapGroup.forEach((function(t,n){t.setX(n*e.scene.gameZone.width)}))},n.updateBackgroundSize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.scene.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var r=this.background,a=r.scaleX,s=r.scaleY;"height"===i?this.background.setScale(s):this.background.setScale(a)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),YR=GameCore.layoutInitializer.isLandscape?SR:WR,HR=n(80),zR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scale=void 0,n.prevRotation=0,n.rotateSpeed=.01,n.angle=0,n.rotateSpeed=.01*Math.random(),n}(0,f.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.updateScale(),this.updateVelocity(),this.prevRotation+=this.rotateSpeed,this.rotation=this.prevRotation,r},n.setScale=function(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max);var t=Math.random()>.5?1:-1;this.rotateSpeed=.05*this.scale*(Math.random()/2+.5)*t},n.easeInCubic=function(e){return e*e*e},n.updateScale=function(){var e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)},n.updateVelocity=function(){this.velocityX+=Phaser.Math.Between(-1,1)},t}(Phaser.GameObjects.Particles.Particle),KR=zR,VR=Ki.Z.DEFAULT,XR=VR.KEY,jR=VR.FRAME,qR="opening",JR="opened",QR="closing",$R="closed",eB=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.ray=void 0,n.glow=void 0,n.glow2=void 0,n.glowTween=void 0,n.glowTween2=void 0,n.levelCurveTextAnimation=void 0,n.completeCurveTextAnimation=void 0,n.fallingStarSparkle=void 0,n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.createRayEffect(),n.createGlowEffect(),n.createGlow2Effect(),n.createLevelCurveText(),n.createCompleteCurveText(),n.createParticles(),n.scene.add.existing((0,yc.Z)(n)),n.levelCurveTextAnimation.setAlpha(0),n.completeCurveTextAnimation.setAlpha(0),n.glow.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e,t;this.glow.setAlpha(0),this.glow2.setAlpha(0),this.ray.setAlpha(0),null==(e=this.glowTween)||e.remove(),null==(t=this.glowTween2)||t.remove()},n.processStep=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=QR){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.openContainer(),e.abrupt("return",new Promise((function(e){t.on("closed",e)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=qR,this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.runGlowRotationAnim(),this.fallingStarSparkle.run(2,0,-50,340,120),e.next=9,this.processStep((function(){return t.runTextEntranceAnim()}));case 9:return this.state=JR,e.next=12,this.processStep((function(){return(0,gl.Z)(t.scene,1e3)}));case 12:return e.next=14,this.processStep((function(){return t.runTextExitAnim()}));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnim=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.levelCurveTextAnimation.playEntranceAnimation(!0),e.next=3,(0,gl.Z)(this.scene,250);case 3:return e.next=5,this.completeCurveTextAnimation.playEntranceAnimation(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=QR,t=this.levelCurveTextAnimation.playExitAnimation(),n=this.completeCurveTextAnimation.playExitAnimation(),i=this.scene.tweens.add({targets:[this],alpha:0,duration:500,delay:800,onStart:function(){r.fallingStarSparkle.stop()}}).waitForCompletion(),e.next=6,Promise.all([t,n,i]);case 6:this.state=$R,this.emit("closed");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowRotationAnim=function(){this.scene.tweens.add({targets:[this.glow,this.glow2,this.fallingStarSparkle],duration:1500,alpha:.9}),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:24e3,repeat:-1,props:{angle:360}}),this.glowTween2=this.scene.tweens.add({targets:[this.glow2],duration:8e4,repeat:-1,props:{angle:360}})},n.createRayEffect=function(){var e=this.scene.make.image({key:XR,frame:jR.EFFECTS.LEVEL_COMPLETE.RAY,y:-10});e.setWorldSize(388,356.5),this.add(e),this.ray=e},n.createGlowEffect=function(){var e=this.scene.make.image({key:XR,frame:jR.EFFECTS.LEVEL_COMPLETE.GLOW_1,y:-10});e.setWorldSize(236.5,236),this.add(e),this.glow=e},n.createGlow2Effect=function(){var e=this.scene.make.image({key:XR,frame:jR.EFFECTS.LEVEL_COMPLETE.GLOW_2,y:-10});e.setWorldSize(192.5,190),this.add(e),this.glow2=e},n.createLevelCurveText=function(){var e=new Gf(this.scene,this.scene.lang.Text.level),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-1500),t.setLetterSpacing(-1),t.setFontSize(this.scene.fontSize(60)),this.add(e),this.levelCurveTextAnimation=e,this.levelCurveTextAnimation.curveText.setPosition(0,-30)},n.createCompleteCurveText=function(){var e=new Gf(this.scene,this.scene.lang.Text.complete),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-1500),t.setLetterSpacing(-1),t.setFontSize(this.scene.fontSize(60)),this.add(e),this.completeCurveTextAnimation=e,this.completeCurveTextAnimation.curveText.setPosition(0,30)},n.createParticles=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new HR.Z(this.scene,t,n.EFFECTS.LEVEL_COMPLETE.STAR,{frame:n.EFFECTS.LEVEL_COMPLETE.STAR,particleClass:KR,lifespan:{min:1200,max:1800},scale:{min:.01,max:.015}});this.add(i),this.fallingStarSparkle=i},t}(Phaser.GameObjects.Container),tB=Ki.Z.DEFAULT,nB=tB.KEY,iB=tB.FRAME,rB=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.glow=void 0,n.light1=void 0,n.light2=void 0,n.curveTextAnimation=void 0,n.levelText=void 0,n.coin=void 0,n.coinText=void 0,n.adsIcon=void 0,n.starContainer=void 0,n.buttonFxImage=void 0,n.tapToCollectText=void 0,n.tapToCollectButton=void 0,n.popupContents=[],n.emitter=void 0,n.glowTween=void 0,n.light1Anim=void 0,n.light2Anim=void 0,n.lightEffect=void 0,n.adsButtonEffect=void 0,n.scene=t;var i=n.scene.gameZone,r=i.width,a=i.height;return n.setSize(r,a),n.create(),n.alignItems(),t.add.existing((0,yc.Z)(n)),n.hideItems(),n}(0,f.Z)(t,e);var n=t.prototype;return n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.setTotalCoins=function(e){this.coinText.setText(e.toString())},n.hideItems=function(){this.curveTextAnimation.setAlpha(0),this.popupContents.forEach((function(e){e.setAlpha(0)})),this.starContainer.setAlpha(0),this.buttonFxImage.setAlpha(0),this.glow.setAlpha(0),this.light1.setAlpha(0),this.light2.setAlpha(0),this.stopAnimation()},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.revive(),this.setAlpha(1),this.setScale(1),this.runGlowRotationAnim(),this.runLightRotationAnim(),e.next=8,this.runPopupContentsEntranceAnimation();case 8:this.runEffects(),this.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.OPEN_WIN_SCREEN);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.hideItems(),this.stopAnimation()},n.runPopupContentsEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.curveTextAnimation.playEntranceAnimation(),this.adsIcon.setVisible(this.scene.level.getLevel()>5),this.popupContents.forEach((function(e,i){if(e!=n.glow){var r=e.scale,a=n.scene.tweens.add({targets:e,alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:r},delay:50*i,duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();t.push(a)}})),e.next=6,Promise.all(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEffects=function(){var e,t,n;null==(e=this.emitter)||e.start(),this.starContainer.setAlpha(1),null==(t=this.lightEffect)||t.start(),null==(n=this.adsButtonEffect)||n.remove(),this.adsButtonEffect=this.scene.tweens.add({targets:this.buttonFxImage,alpha:{from:0,to:1},duration:1500,repeat:-1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut})},n.stopAnimation=function(){var e,t,n,i,r,a,s,o,c,h;null==(e=this.emitter)||e.stop(),null==(t=this.emitter)||t.killAll(),null==(n=this.glowTween)||n.stop(),null==(i=this.glowTween)||i.remove(),null==(r=this.light1Anim)||r.stop(),null==(a=this.light1Anim)||a.remove(),this.light1.setAngle(0),this.light1.setScale(1/GameCore.ImageScale),null==(s=this.light2Anim)||s.stop(),null==(o=this.light2Anim)||o.remove(),this.light2.setAngle(0),this.light2.setScale(1/GameCore.ImageScale),null==(c=this.lightEffect)||c.stop(),null==(h=this.adsButtonEffect)||h.stop()},n.runGlowRotationAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glow.setAlpha(.5),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:2e3,repeat:-1,props:{alpha:{from:.5,to:.8,yoyo:!0}}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLightRotationAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.light1Anim)||t.remove(),null==(n=this.light2Anim)||n.remove(),i=1/GameCore.ImageScale,this.light1.kill(),this.light2.kill(),this.light1Anim=this.scene.tweens.add({targets:[this.light1],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:360},alpha:{from:.5,to:1,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}}),this.light2Anim=this.scene.tweens.add({targets:[this.light2],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:-360},scale:{from:i,to:1.075*i,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.glow.setPosition(0,-29),this.light1.setPosition(0,-29),this.light2.setPosition(0,-29),this.coin.setPosition(0,-29),this.curveTextAnimation.curveText.setPosition(0,-160),this.levelText.setPosition(0,-120),this.coinText.setPosition(0,18),this.adsIcon.setPosition(0,100),Phaser.Display.Align.In.BottomCenter(this.tapToCollectText,this,0,-40)},n.create=function(){this.createGlowEffect(),this.createCurveTextAnimation(),this.createLevelText(),this.createCoin(),this.createStarParticle(),this.createCoinText(),this.createTapToCollectButton(),this.createAdsIcon()},n.createGlowEffect=function(){var e=this.scene.make.image({key:nB,frame:iB.EFFECTS.GLOW_2});e.setDefaultWorldSize(),this.add(e);var t=this.scene.add.image(0,0,nB,iB.EFFECTS.LIGHT_X);t.setDefaultWorldSize(),this.add(t);var n=this.scene.add.image(0,0,nB,iB.EFFECTS.LIGHT_X);n.setDefaultWorldSize(),n.setAngle(90),this.add(n),this.glow=e,this.light1=t,this.light2=n},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,nB,iB.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(100,220/3),t.setPosition(0-t.width/2,-29-t.height/2);var n=1/GameCore.ImageScale;this.emitter=e.createEmitter({frame:iB.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:NS.Z,quantity:1})},n.createCurveTextAnimation=function(){var e=new Gf(this.scene,this.scene.lang.Text.wellDone2),t=e.curveText;t.setFonts(Rc.ZP.STYLE.KEY),t.setOrigin(.5,.8),t.setRadius(-1e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(50)),this.add(e),this.curveTextAnimation=e},n.createLevelText=function(){var e=new Qp(this.scene,{text:"Level 2048",fontSize:this.scene.fontSize(30),strokeColor:0,strokeThickness:2.7,strokeOffset:{y:.5},letterSpacingExtra:.3,strokeAlpha:.4});this.add(e),this.levelText=e,this.popupContents.push(e)},n.createCoin=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.COIN);i.setDefaultWorldSize(),this.add(i),this.coin=i,this.popupContents.push(i,this.glow,this.light1,this.light2)},n.createCoinText=function(){var e=new Qp(this.scene,{text:"500",fontSize:this.scene.fontSize(34),strokeColor:0,strokeThickness:2.7,strokeOffset:{y:.5},letterSpacingExtra:.3,strokeAlpha:.4});this.add(e),this.coinText=e,this.popupContents.push(e)},n.createAdsIcon=function(){var e=Ki.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new jp.Z(this.scene,238/3,217/3);this.add(i);var r=this.scene.add.image(0,0,t,n.ICONS.BONUS);r.setDefaultWorldSize(),i.add(r),this.adsIcon=i,this.createLightEffect(),this.createButtonEffect(),this.popupContents.push(r)},n.createTapToCollectButton=function(){var e=new wT(this.scene);e.text.setText("Tap to collect"),e.setName("TapToCollect"),this.add(e),this.tapToCollectButton=e,this.tapToCollectText=this.tapToCollectButton.text,this.popupContents.push(this.tapToCollectText)},n.createLightEffect=function(){var e=this.scene.add.container(0,-22);this.adsIcon.add(e),this.starContainer=e;var t=this.scene.add.image(0,0,nB,iB.EFFECTS.BONUS_STAR);t.setDefaultWorldSize(),t.setAlpha(0),e.add(t),this.lightEffect=new VA([{target:e,rotate:[{value:-24.94},{time:1,value:-62.8},{time:1.6667,value:-24.94},{time:2.6667,value:-62.8},{time:3.3333,value:-24.94},{time:4.3333,value:-62.8}],scale:[{x:0,y:0,curve:[.032,.593,.335,1,.032,.593,.335,1]},{time:.5,curve:[.701,1,.835,.333,.701,1,.835,.333]},{time:1,x:0,y:0,curve:"stepped"},{time:1.6667,x:0,y:0,curve:[1.699,.593,2.001,1,1.699,.593,2.001,1]},{time:2.1667,curve:[2.368,1,2.501,.333,2.368,1,2.501,.333]},{time:2.6667,x:0,y:0,curve:"stepped"},{time:3.3333,x:0,y:0,curve:[3.366,.593,3.668,1,3.366,.593,3.668,1]},{time:3.8333,curve:[4.034,1,4.168,.333,4.034,1,4.168,.333]},{time:4.3333,x:0,y:0}]},{target:t,rgba:[{color:"ffffffff"}]}]),this.lightEffect.setLoop(-1)},n.createButtonEffect=function(){var e=this.scene.add.image(-9,-10,nB,iB.EFFECTS.BONUS_LIGHT);e.setDefaultWorldSize(),e.setAlpha(0),this.adsIcon.add(e),this.buttonFxImage=e},t}(Phaser.GameObjects.Container),aB=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).levelCompleteContainer=void 0,o.wellDoneContainer=void 0,o.onClaim=void 0,o.totalClaimedCoins=void 0,o.coinsClaimed=void 0,o.onEntranceCompleted=function(){},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.wellDoneContainer.kill(),o.wellDoneContainer.setAlpha(0),o.wellDoneContainer.setScale(0),o.wellDoneContainer.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.handleClaim();case 2:case"end":return e.stop()}}),e)}))))},o.runAnimationCounter=function(){var e=o.countTotalCoin({startNumber:0,endNumber:o.totalClaimedCoins});return Promise.all([e])},o.handleWatchAdsClaim=(0,i.Z)(a().mark((function e(){var t,n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.scene.gameUI.coinBarButton.setDisabled(!0),o.setButtonsDisable(!0),t=o.totalClaimedCoins,n=1,i=0,e.next=7,o.scene.showRewardedVideoAsync();case 7:return(r=e.sent)&&(i=t*n,o.scene.analytics.event(ae._.LUCKY_REWARD,{value:n})),o.totalClaimedCoins=t+i,e.next=12,o.handleClaim(r?0:400);case 12:case"end":return e.stop()}}),e)}))),o.handleClaim=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),!o.coinsClaimed){e.next=3;break}return e.abrupt("return");case 3:if(o.coinsClaimed=!0,o.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.BUTTON_CLICK),!(t>0)){e.next=8;break}return e.next=8,(0,me.qZ)(t);case 8:return e.next=10,o.scene.gameUI.showCoin();case 10:return o.setButtonsDisable(!0),o.scene.gameUI.coinBarButton.setDisabled(!0),e.next=14,o.claim(o.totalClaimedCoins);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.claim=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.wellDoneContainer.curveTextAnimation.playExitAnimation(),o.scene.tweens.add({targets:[o.wellDoneContainer],alpha:{value:0,duration:300},duration:400,ease:Phaser.Math.Easing.Sine.In}),o.scene.rewardManager.rewardCoin(t),n=o.scene.gameZone,r=n.width,s=n.height,o.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,r/2,s/2).then((0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.scene.gameUI.coinBarButton.setDisabled(!0),o.wellDoneContainer.runExitAnimation(),o.onClaim();case 3:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.totalClaimedCoins=0,o.setDepth(de.Ks.POPUP),o.create(),o.background.setInteractive({useHandCursor:!0}),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.listenEvents(),o.wellDoneContainer.kill(),o.wellDoneContainer.setAlpha(0),o.wellDoneContainer.setScale(0),o}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.wellDoneContainer,t=e.adsIcon,n=e.tapToCollectButton;t.onClick=this.handleWatchAdsClaim,n.onClick=this.handleClaim},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Ha.Z.PRIORITY),this.updateVictoryStats(),this.levelCompleteContainer.open(),this.scene.gameUI.hideUI(),this.scene.gameUI.hideLife(),t.next=10,this.runEntranceAnimation();case 10:return t.next=12,this.levelCompleteContainer.runEntranceAnimation();case 12:return this.levelCompleteContainer.kill(),t.next=15,this.scene.handleShowInterstitialAd();case 15:return t.next=17,this.wellDoneContainer.runEntranceAnimation();case 17:(0,gl.Z)(this.scene,150).then((function(){i.setButtonsDisable(!1),i.runAnimationCounter()}));case 18:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.runExitAnimation();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list,n=t.level,i=void 0===n?0:n,r=t.levelCollectedCoin,a=void 0===r?0:r,s=t.levelClearedCoin,o=void 0===s?0:s,c=t.onClaim,h=void 0===c?function(){}:c;this.coinsClaimed=!1,this.totalClaimedCoins=a+o,this.onClaim=h,this.wellDoneContainer.setLevel(i),this.wellDoneContainer.setTotalCoins(0)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.countTotalCoin=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onUpdate=function(e){var t=Math.floor(e.getValue());n.wellDoneContainer.setTotalCoins(t)},e.abrupt("return",this.runCountingAnimation(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCountingAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onStart=function(){n.scene.time.addEvent({repeat:4,delay:200,callback:function(){n.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.COUNT_COINS)}})},e.abrupt("return",FS(this.scene,t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setButtonsDisable=function(e){var t=this.wellDoneContainer,n=t.adsIcon,i=t.tapToCollectButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.create=function(){this.createLevelCompleteContainer(),this.createWellDoneContainer()},n.createLevelCompleteContainer=function(){this.levelCompleteContainer=new eB(this.scene),this.add(this.levelCompleteContainer)},n.createWellDoneContainer=function(){this.wellDoneContainer=new rB(this.scene),this.add(this.wellDoneContainer)},t}(GameCore.Screen),sB=GameCore.layoutInitializer.isLandscape?UI:aB,oB=Ki.Z.DEFAULT,cB=oB.KEY,hB=oB.FRAME,uB=function(e){function t(t,n,i){var r,a;(a=e.call(this,t,n,i)||this).folderImage=void 0,a.comingSoonText=void 0,a.glow=void 0,a.starEmitter=void 0,a.glowTween=void 0,a.folder=void 0,a.nextJourneyText=void 0;var s=a.scene.gameZone,o=s.width,c=s.height;return a.setSize(o,c),a.create(),null==(r=a.glowTween)||r.remove(),a.align(),a.setHiddenState(),a.setInteractive({useHandCursor:!0}),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runGlowRotationAnim(),null==(t=this.starEmitter)||t.start(),e.next=4,this.runEntranceAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation();case 2:this.setHiddenState();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setHiddenState=function(){var e,t,n;null==(e=this.glowTween)||e.remove(),this.glow.setAlpha(0),this.glow.setScale(0),this.folder.setAlpha(0),this.folder.setScale(0),this.comingSoonText.setAlpha(0),this.comingSoonText.setY(102),this.comingSoonText.setScale(0),null==(t=this.starEmitter)||t.stop(),null==(n=this.starEmitter)||n.killAll()},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setAlpha(1),t=this.runGlowEntranceAnimation(),n=this.runFolderEntranceAnimation(),i=this.runTextEntranceAnimation(),e.next=6,Promise.all([t,n,i]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,n=this.scene.tweens.add({targets:[this.glow],alpha:{from:0,start:0,to:.8,ease:Phaser.Math.Easing.Sine.In,duration:150},scale:{from:t,start:t,to:2*t,duration:500,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}}).waitForCompletion(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFolderEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.tweens.add({targets:[this.folder],alpha:{from:1,start:1,to:1,ease:Phaser.Math.Easing.Sine.In,duration:150},scale:{from:0,start:0,to:1,duration:500,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnimation=function(){var e=1/GameCore.ImageScale;return this.scene.tweens.add({targets:[this.comingSoonText],y:{from:72,start:72,to:102,ease:Phaser.Math.Easing.Expo.Out},alpha:{from:0,start:0,to:1},scale:{from:.8*e,start:.8*e,to:1*e,ease:Phaser.Math.Easing.Expo.Out},duration:200,delay:100}).waitForCompletion()},n.runGlowRotationAnim=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e4,repeat:-1,props:{angle:{value:360,ease:Phaser.Math.Easing.Linear}},onStart:function(){n.glow.setAngle(0)}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.runGlowExitAnimation(),n=this.runFolderExitAnimation(),i=this.runTextExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,n=this.scene.tweens.add({targets:[this.glow],alpha:{from:.8,start:.8,to:0,duration:150},scale:{from:2*t,start:2*t,to:t,ease:Phaser.Math.Easing.Back.In},duration:300}).waitForCompletion(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFolderExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.tweens.add({targets:[this.folder],alpha:{from:1,start:1,to:0,delay:150},scale:{from:1,start:1,to:0,ease:Phaser.Math.Easing.Back.In,easeParams:[1.5]},duration:300}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,102,n=this.scene.tweens.add({targets:[this.comingSoonText],y:{from:102,start:102,to:72,ease:Phaser.Math.Easing.Expo.In},alpha:{from:1,start:1,to:0},scale:{from:t,start:t,to:.8*t,ease:Phaser.Math.Easing.Expo.In},duration:200}).waitForCompletion(),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.align=function(){Phaser.Display.Align.In.Center(this.glow,this,0,0),Phaser.Display.Align.In.Center(this.folder,this,0,-10),Phaser.Display.Align.In.Center(this.comingSoonText,this,-12,102)},n.create=function(){this.createGlow(),this.createFolderImage(),this.createText(),this.createSparkleParticle()},n.createGlow=function(){this.glow=this.scene.add.image(0,0,cB,hB.NEXT_JOURNEY_SCREEN.GLOW),this.glow.setDefaultWorldSize(),this.add(this.glow)},n.createFolderImage=function(){this.folder=this.scene.add.container(),this.add(this.folder),this.folderImage=this.scene.add.image(0,0,cB,hB.NEXT_JOURNEY_SCREEN.PHOTOS),this.folderImage.setDefaultWorldSize(),this.folder.add(this.folderImage),this.nextJourneyText=new Qp(this.scene,{text:"Next Journey",fontSize:this.scene.fontSize(17),fillColor:11102533}),this.nextJourneyText.setPosition(3,-57),this.nextJourneyText.setAngle(4),this.folder.add(this.nextJourneyText)},n.createText=function(){this.comingSoonText=this.scene.add.image(0,0,cB,hB.NEXT_JOURNEY_SCREEN.TEXT),this.comingSoonText.setDefaultWorldSize(),this.add(this.comingSoonText)},n.createSparkleParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,cB,hB.NEXT_JOURNEY_SCREEN.SPARKLE);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(300,250),t.setPosition(0-t.width/2,-t.height/2);var n=new Phaser.Geom.Rectangle;n.setSize(230,150),n.setPosition(0-n.width/2,-n.height/2);var i=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:hB.NEXT_JOURNEY_SCREEN.SPARKLE,emitZone:{source:t,type:"random"},deathZone:{source:n,type:"onEnter"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-12,max:-15},lifespan:{min:1e3,max:1500},scale:{min:.03,max:.07},emitCallback:function(e){e.setScale({min:i/2,max:1*i})},particleClass:NS.Z,quantity:5})},t}(Phaser.GameObjects.Container),lB=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).nextJourneyContainer=void 0,o.close=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.nextJourneyContainer.close(),(0,gl.Z)(o.scene,250).then((function(){o.runExitAnimation()}));case 2:case"end":return e.stop()}}),e)}))),o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.nextJourneyContainer.setHiddenState()},o.setDepth(de.Ks.POPUP),o.createNextJourneyContainer(),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.nextJourneyContainer.open();case 4:this.nextJourneyContainer.once(Phaser.Input.Events.POINTER_DOWN,(function(){return i.close()}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]}).waitForCompletion());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.createNextJourneyContainer=function(){this.nextJourneyContainer=new uB(this.scene,0,0),this.add(this.nextJourneyContainer)},t}(GameCore.Screen),dB=Ki.Z.RACE,pB=dB.KEY,fB=dB.FRAME,mB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.Center(this.step1,this,-190,60),Phaser.Display.Align.In.Center(this.step2,this,0,60),Phaser.Display.Align.In.Center(this.step3,this,210,60),Phaser.Display.Align.In.Center(this.arrow1,this,-105,10),Phaser.Display.Align.In.Center(this.arrow2,this,105,10)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[fB.INTRO.ITEM_1,fB.INTRO.ITEM_2,fB.INTRO.ITEM_3],n=["Beat levels!","Move your boat forward!","Get prizes!"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,pB,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,pB,fB.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),gB=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new mB(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),vB=Ki.Z.RACE,yB=vB.KEY,EB=vB.FRAME,CB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-90,-50),Phaser.Display.Align.In.Center(this.step2,this,70,40),Phaser.Display.Align.In.Center(this.step3,this,-80,190),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,110),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[EB.INTRO.ITEM_1,EB.INTRO.ITEM_2,EB.INTRO.ITEM_3],n=["Beat levels!","Move your boat forward!","Get prizes!"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,yB,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[EB.INTRO.ARROW_RIGHT,EB.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var r=e.scene.add.image(0,0,yB,t[i]);return r.setDefaultWorldSize(),r}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),wB=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new CB(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),AB=GameCore.layoutInitializer.isLandscape?gB:wB,bB=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"23:59:59",origin:{x:.5,y:.5}}),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new SB(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),SB=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",11),t.countdownTimer.remove();else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),TB=Ki.Z.RACE,xB=TB.KEY,kB=TB.FRAME,PB=function(e){function t(t){var n;return(n=e.call(this,t,{key:xB,backgroundFrame:kB.BUTTON.BASE,buttonFrame:kB.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.setSize(n.width,n.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new Qp(this.scene,{text:"START",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},t}(aT),IB=PB,OB=Ki.Z.RACE,RB=OB.KEY,BB=OB.FRAME,DB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.closeButton=void 0,i.startButton=void 0,i.scene=t,i.screen=n,i.create(),i.alignItems(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.closeContainer=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setAlpha(1),this.updateDescription(),this.updateData();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.updateDescription=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.description.setText("Be the first to beat "+e+" levels!")},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,0,22),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-25,-21),Phaser.Display.Align.In.TopRight(this.closeButton,this,-20,-23),Phaser.Display.Align.In.BottomCenter(this.startButton,this,0,22)},n.create=function(){this.createBackground(),this.createHeader(),this.createDescription(),this.createButtons()},n.createBackground=function(){var e=this.scene.world.getWorldSize().width,t=e>=446?426:e-20,n=this.scene.add.image(0,0,RB,BB.INVITATION.POPUP);n.setDefaultWorldSize(),this.add(n),n.setScale(n.scale*t/426),this.setSize(n.displayWidth,n.displayHeight)},n.createTimePanel=function(){this.timerPanel=new bB(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,RB,BB.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,RB,BB.MAIN.HEADER_BACKGROUND);e.setDefaultWorldSize(),this.header.add(e);var t=new Rf(this.scene);t.setText("Offshore Racers"),t.setFontSize(25.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-2.5),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(15),text:"Be the first to beat 15 levels!",origin:{x:.5,y:.5}});e.setTint(33447),this.add(e),this.description=e},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createStartButton()},n.createInformationButton=function(){var e=new ov.Z(this.scene,{key:RB,frame:BB.INVITATION.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new ov.Z(this.scene,{key:RB,frame:BB.INVITATION.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createStartButton=function(){var e=new IB(this.scene);e.button.setName("Start"),this.add(e),this.startButton=e},t}(Phaser.GameObjects.Container),LB=DB,MB=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.offshoreRaceInvitationContainer=void 0,o.previousScreen=void 0,o.screenOpened=void 0,o.isStartingRace=void 0,o.handleInformationButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=o.previousScreen===de.o4.DASHBOARD_SCREEN)&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),e.next=4,o.offshoreRaceInvitationContainer.closeContainer();case 4:return e.next=6,o.scene.screen.openAsync(de.o4.OFFSHORE_RACE.INTRO_SCREEN);case 6:t&&o.scene.screen.open(de.o4.DASHBOARD_SCREEN),o.scene.screen.bringToTop(de.o4.OFFSHORE_RACE.INVITATION_SCREEN),o.offshoreRaceInvitationContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),o.handleCloseButtonClick=function(){o.scene.screen.close(o.name)},o.handlePlayButtonClick=function(){o.isStartingRace||(o.isStartingRace=!0,o.previousScreen=void 0,o.scene.screen.close(o.name),o.scene.offshoreRace.startRace(),(0,gl.Z)(o.scene,300).then((function(){o.scene.openOffshoreRaceMainScreen({shouldPlayEntranceAnimation:!0,previousScreen:de.o4.DASHBOARD_SCREEN}),o.isStartingRace=!1})))},o.close=function(){o.background.off(Phaser.Input.Events.POINTER_DOWN),o.runExitAnimation()},o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.screenOpened=!1,o.scene.gameUI.coinBarButton.setDisabled(!1),o.previousScreen&&o.scene.screen.open(o.previousScreen)},o.scene=t,o.create(),o.listenEvents(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createRaceInvitationContainer()},n.listenEvents=function(){var e=this.offshoreRaceInvitationContainer,t=e.informationButton,n=e.closeButton,i=e.startButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick},n.createRaceInvitationContainer=function(){this.offshoreRaceInvitationContainer=new LB(this.scene,this),this.offshoreRaceInvitationContainer.setInteractive(),this.add(this.offshoreRaceInvitationContainer),Phaser.Display.Align.In.Center(this.offshoreRaceInvitationContainer,this,0,0)},n.open=function(t){if(!this.screenOpened){this.screenOpened=!0,e.prototype.open.call(this,t);var n=(null!=t?t:{previousScreen:de.o4.DASHBOARD_SCREEN}).previousScreen;this.previousScreen=n,this.offshoreRaceInvitationContainer.open(),this.runEntranceAnimation()}},n.updateTimer=function(){var e=this.scene.offshoreRace,t=e.isFinished();this.offshoreRaceInvitationContainer.timerPanel.timerLogic.setRemainingTime(t?0:e.getRemainingTime())},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.offshoreRaceInvitationContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.offshoreRaceInvitationContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),_B=MB,NB=Ki.Z.RACE,GB=NB.KEY,FB=NB.FRAME,ZB=function(e){function t(t,n){var i;return(i=e.call(this,t,{key:GB,background:n?FB.MAIN.PLAYER.AVATAR_BACKGROUND:FB.MAIN.OPPONENT.AVATAR_BACKGROUND,frame:FB.BLANK,width:29.333333333333332,height:29.333333333333332,loadDelay:1e3})||this).avtFrame.kill(),i}(0,f.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){void 0===i&&(i=70),n&&(t===this.payload.id&&n===this.payload.url||e.prototype.loadPhoto.call(this,t,n,i))},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,r=n.height,a=Math.min(i,r);this.photo.setWorldSize(a,a)},n.showDefaultPhoto=function(){this.loadPhoto(oe.Z.AVATAR.KEY,oe.Z.AVATAR.FILE)},t}(Dc),UB=ZB,WB=Ki.Z.RACE,YB=WB.KEY,HB=WB.FRAME,zB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.avatar=void 0,i.avatarBorder=void 0,i.racerName=void 0,i.scene=t,i.isPlayer=n,i.createAvatar(),i.createAvatarBorder(),i.createName(),i.alignItems(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateRacerInfo=function(e,t,n,i){this.setRacerName(n),i&&this.avatar.loadPhoto(t,i)},n.setRacerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);this.racerName.setText(t);if(this.racerName.width>38)for(var n=1;n<t.length;n++)if(this.racerName.setText(t.substring(0,n)+".."),this.racerName.width>38){this.racerName.setText(t.substring(0,n-1)+"..");break}this.racerName.setX(4+(this.avatarBorder.width/2-this.avatar.displayWidth/2)/2),this.racerName.setY(-.5)},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.avatar,this,-2,-.5)},n.createAvatar=function(){var e=new UB(this.scene,this.isPlayer);e.setSize(88/3,91/3),e.showDefaultPhoto(),this.add(e),this.avatar=e},n.createAvatarBorder=function(){var e=this.isPlayer?HB.MAIN.PLAYER:HB.MAIN.OPPONENT,t=this.scene.add.image(0,0,YB,e.AVATAR_BORDER);t.setDefaultWorldSize(),this.add(t),this.avatarBorder=t,this.setSize(t.width,t.height)},n.createName=function(){var e=new Qp(this.scene,{text:"Player",fontSize:this.scene.fontSize(10),strokeColor:12927496,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),t=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(10),text:"Opponent",origin:{x:.5,y:.5}});t.setTint(33447),this.isPlayer?(e.setVisible(!0),t.setVisible(!1)):(e.setVisible(!1),t.setVisible(!0)),this.racerName=this.isPlayer?e:t,this.add(this.racerName);var n=this.isPlayer?"Lilly":"Richard";this.setRacerName(n)},t}(Phaser.GameObjects.Container),KB=zB,VB=Ki.Z.RACE,XB=VB.KEY,jB=VB.FRAME,qB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boat=void 0,i.text=void 0,i.speechBubble=void 0,i.idleAnimation=void 0,i.scene=t,i.isPlayer=n,i.createBoat(),i.createSpeechBubble(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boat.setAlpha(0),this.speechBubble.setAlpha(0),this.speechBubble.setScale(1),n=this.runBoatEntranceAnimation(t),i=this.runSpeechBubbleEntranceAnimation(t),e.next=7,Promise.all([n,i]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBoatEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.createTimeline(),i=this.boat.scaleY,n.add({targets:this.boat,scaleY:{from:i,start:i,to:.9*i},y:{from:this.boat.y,start:this.boat.y,to:this.boat.y+2},duration:200,delay:200*t,ease:Phaser.Math.Easing.Sine.In,onStart:function(){r.boat.setAlpha(1)}}),n.add({targets:this.boat,scaleY:{from:.9*i,start:.9*i,to:i},y:{from:this.boat.y+2,start:this.boat.y+2,to:this.boat.y},duration:500,ease:Phaser.Math.Easing.Sine.Out}),e.abrupt("return",n.playAndWaitForCompletion());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runSpeechBubbleEntranceAnimation=function(e){var t=this;return this.scene.tweens.add({targets:this.speechBubble,scaleX:{from:.6,start:.6,to:1},alpha:{from:0,start:0,to:1,duration:100},angle:{from:10,start:10,to:0},duration:200,delay:700+200*e,ease:Phaser.Math.Easing.Quadratic.Out,onStart:function(){t.speechBubble.setAlpha(0),t.speechBubble.scaleX=.6,t.speechBubble.setAngle(10)}})},n.runSpeechBubbleExitAnimation=function(e){return void 0===e&&(e=0),this.scene.tweens.add({targets:this.speechBubble,scale:0,delay:e,duration:200,ease:Phaser.Math.Easing.Quadratic.InOut}).waitForCompletion()},n.runRunAnimation=function(){return this.scene.tweens.add({targets:this.boat,y:this.boat.y-1,angle:{from:0,start:0,to:-3},duration:500,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()},n.runClaimAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=0),i=this.boat.x,8,r=this.scene.gameZone.width/2+t.displayWidth/2-8,s=this.scene.tweens.add({targets:this.boat,x:this.boat.x+240,delay:n,duration:600,ease:Phaser.Math.Easing.Quadratic.In,onUpdate:function(){var e=c.boat.getWorldPosition().x-c.boat.displayWidth/2,t=Phaser.Math.Clamp((r-e)/c.boat.scaleX,0,c.boat.frame.width);c.boat.setCrop(0,0,t,c.boat.frame.height)}}).waitForCompletion(),o=this.runSpeechBubbleExitAnimation(n),e.next=8,Promise.all([o,s]);case 8:this.boat.setAlpha(0),this.boat.setPosition(i,this.boat.y),this.boat.setCrop();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.stopIdleAnimation=function(){var e;return null==(e=this.idleAnimation)||e.stop(),0===this.boat.angle?Promise.resolve():this.scene.tweens.add({targets:this.boat,angle:{from:this.boat.angle,start:this.boat.angle,to:0},duration:200,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()},n.runIdleAnimation=function(){var e;null==(e=this.idleAnimation)||e.remove();var t=Phaser.Math.Between(1500,3e3),n=Phaser.Math.Between(0,1e3);this.idleAnimation=this.scene.tweens.add({targets:this.boat,angle:{from:0,start:0,to:3},duration:t,delay:n,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut})},n.updateProgress=function(e){this.text.setText(""+e)},n.createBoat=function(){var e=this.isPlayer?jB.MAIN.PLAYER.BOAT:jB.MAIN.OPPONENT.BOAT;this.boat=this.scene.add.image(0,0,XB,e),this.boat.setDefaultWorldSize(),this.add(this.boat)},n.createSpeechBubble=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,XB,jB.MAIN.SPEECH_BUBBLE);t.setDefaultWorldSize(),t.setPosition(-28,-9),e.add(t);var n=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"12",origin:{x:.5,y:.5}});n.setTint(33447),n.setPosition(t.x-.5,t.y-1),e.add(n),this.text=n,this.speechBubble=e},t}(Phaser.GameObjects.Container),JB=qB,QB=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.scene=t;var i=Phaser.Math.Clamp(n.scene.world.getWorldSize().width-20,340,426),r=GameCore.Utils.Number.normalizeNumber(i,340,426,160,235);return n.setSize(r,35),t.add.existing((0,yc.Z)(n)),n}return(0,f.Z)(t,e),t.prototype.getBoatPosition=function(e){var t=this.scene.offshoreRace.getRequiredLevels();return e===t?this.width/2-3:GameCore.Utils.Number.normalizeNumber(e,0,t,-this.width/2+28,this.width/2-28)},t}(Phaser.GameObjects.Container),$B=QB,eD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boat=void 0,i.racetrack=void 0,i.score=void 0,i.isDirty=void 0,i.scene=t,i.isPlayer=n,i.isDirty=!1,i.createRacetrack(),i.createBoat(),t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.runClaimAnimation=function(e,t){return void 0===t&&(t=0),this.boat.runClaimAnimation(e,t)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.boat.runEntranceAnimation(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBoatBlock=function(e,t,n){if(this.score=t,n)return this.isDirty=!1,void this.boat.kill();this.boat.revive(),this.isDirty=t>e,this.boat.updateProgress(e);var i=this.racetrack.getBoatPosition(e);this.boat.setX(i)},n.animateUpdateBoatBlock=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty){e.next=2;break}return e.abrupt("return");case 2:if(this.isDirty=!1,t=this.racetrack.getBoatPosition(this.score),0!==this.score){e.next=10;break}return this.boat.setX(t),e.next=8,this.boat.stopIdleAnimation();case 8:return this.boat.runIdleAnimation(),e.abrupt("return");case 10:return e.next=12,this.boat.stopIdleAnimation();case 12:return this.boat.updateProgress(this.score),e.next=15,this.runBoatRunAnimation(t);case 15:this.boat.runIdleAnimation();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runBoatRunAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.boat.runRunAnimation(),i=this.scene.tweens.add({targets:this.boat,x:t,duration:1e3,ease:Phaser.Math.Easing.Sine.Out}).waitForCompletion(),e.next=4,Promise.all([n,i]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createRacetrack=function(){this.racetrack=new $B(this.scene),this.add(this.racetrack),this.setSize(this.racetrack.width,this.racetrack.height)},n.createBoat=function(){this.boat=new JB(this.scene,this.isPlayer),this.add(this.boat),this.boat.setY(2);var e=this.racetrack.getBoatPosition(0);this.boat.setX(e)},t}(Phaser.GameObjects.Container),tD=eD,nD=function(e){return e[e.Playing=0]="Playing",e[e.Won=1]="Won",e[e.Finished=2]="Finished",e}(nD||{}),iD=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).scene=void 0,r.container=void 0,r.racerIndex=void 0,r.racerData=void 0,r.isPlayer=void 0,r.info=void 0,r.boatBlock=void 0,r.scene=t,r.container=n,r.racerIndex=i,r.isPlayer=0===i,r.create(),r.setDefaultRaceBlockData(i),r.setSize(355,r.info.height),r.alignItems(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setDefaultRaceBlockData(this.racerData.racerIndex)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.info.setAlpha(0),n=this.runInfoEntranceAnimation(t),i=this.boatBlock.runEntranceAnimation(t),e.next=5,Promise.all([n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runInfoEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.scene.tweens.createTimeline()).add({targets:this.info,scale:{from:.6,start:.6,to:1.05},y:{from:this.info.y,start:this.info.y,to:this.info.y-2},duration:200,ease:Phaser.Math.Easing.Sine.Out,delay:200*t,onStart:function(){i.info.setAlpha(1),i.info.setScale(.6),i.setAlpha(1)}}),n.add({targets:this.info,scale:{from:1.05,start:1.05,to:1},y:{from:this.info.y-2,start:this.info.y-2,to:this.info.y},duration:350,delay:50,ease:Phaser.Math.Easing.Sine.Out}),e.abrupt("return",n.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateData=function(e){var t=0===this.racerData.racerIndex,n=this.racerData.score;this.racerData=(0,p.Z)({},e,{racerIndex:this.racerIndex,isPlayer:t}),this.info.updateRacerInfo(this.racerData.racerIndex,this.racerData.racerId,this.racerData.name,this.racerData.photo),this.boatBlock.updateBoatBlock(n,this.racerData.score||0,this.racerData.rewardClaimed)},n.playClaimAnimation=function(e){return void 0===e&&(e=0),this.racerData.rewardClaimed?Promise.resolve():(this.scene.offshoreRace.setRacerClaimReward(this.racerData.racerIndex),this.boatBlock.runClaimAnimation(this.container,e))},n.animateUpdateRacerBlock=function(){return this.boatBlock.animateUpdateBoatBlock()},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.info,this,-12,0),Phaser.Display.Align.In.LeftCenter(this.boatBlock,this,-105,0)},n.setDefaultRaceBlockData=function(e){this.racerData={racerIndex:e,racerId:"",name:"",photo:"",score:0,rank:e,rewardClaimed:!1,isPlayer:!1},this.boatBlock.updateBoatBlock(0,this.racerData.score||0,this.racerData.rewardClaimed)},n.create=function(){this.createInfoBlock(),this.createBoatBlock()},n.createInfoBlock=function(){this.info=new KB(this.scene,this.isPlayer),this.add(this.info)},n.createBoatBlock=function(){this.boatBlock=new tD(this.scene,this.isPlayer),this.add(this.boatBlock)},t}(Phaser.GameObjects.Container),rD=iD,aD=Ki.Z.RACE,sD=(aD.KEY,aD.FRAME,Ki.Z.DEFAULT),oD=sD.KEY,cD=sD.FRAME,hD=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.itemType=void 0,n.item=void 0,n.itemAmount=void 0,n.amount=void 0,n.scene=t,n.createItem(),n.createItemAmount(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setItemType=function(e){switch(this.itemType=e,e){case er.COIN:this.setItemFrame(cD.REWARDS.COIN);break;case er.UNDO:this.setItemFrame(cD.REWARDS.UNDO);break;case er.PLUS_5_CARDS:this.setItemFrame(cD.REWARDS.PLUS_5_CARDS);break;case ji.STORM:this.setItemFrame(cD.REWARDS.STORM);break;case ji.SLICE:this.setItemFrame(cD.REWARDS.SLICE);break;case ji.WILD_CARD:this.setItemFrame(cD.REWARDS.WILD_CARD)}},n.setItemAmount=function(e){if(this.amount=e,this.itemType===er.COIN){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.itemAmount.setText(""+t),this.itemAmount.x=0}else this.itemAmount.setText("x"+e),this.itemAmount.x=this.width/2-this.itemAmount.width/2;this.itemAmount.y=this.height/2-5},n.setItemFrame=function(e){this.item.setFrame(e),this.item.setDefaultWorldSize(),this.setSize(this.item.width,this.item.height)},n.createItem=function(){var e=this.scene.add.image(0,0,oD,cD.REWARDS.COIN);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height),this.item=e},n.createItemAmount=function(){var e=new Qp(this.scene,{text:"Start",fontSize:this.scene.fontSize(30),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.8});this.add(e),this.itemAmount=e},t}(Phaser.GameObjects.Container),uD=Ki.Z.DEFAULT,lD=uD.KEY,dD=uD.FRAME,pD=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.top=void 0,n.bottom=void 0,n.popupItems=[],n.itemPool=[],n.plusPool=[],n.plusTexts=[],n.isOpening=void 0,n.popupWrapper=void 0,n.scene=t,n.isOpening=!1,n.create(),n.setScale(0),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runPopupOpen=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isOpening=!0,this.setPosition(n,i),this.popupItems=this.spawnItems(t),this.alignItems(),r?this.popupWrapper.setX(-this.popupWrapper.displayWidth/2):this.popupWrapper.setX(this.popupWrapper.displayWidth/2),this.popupWrapper.setInteractive({hitArea:this.popupWrapper.getBounds()}),e.next=8,this.runEntranceAnimation();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isOpening=!1,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.setVisible(!0),this.setScale(0),e.next=5,this.scene.tweens.add({targets:this,scale:1,duration:t,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 5:return e.next=7,(0,me.qZ)(1e3);case 7:if(this.isOpening){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return e.next=11,this.runExitAnimation();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),e.next=3,this.scene.tweens.add({targets:this,scale:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.setVisible(!1),n.popupItems.forEach((function(e){e.kill()})),n.plusTexts.forEach((function(e){e.kill()})),n.popupItems=[],n.plusTexts=[],n.isOpening=!1}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.popupItems;if(0!==this.popupItems.length){var t=Math.ceil(e.length/4),n=[],i=[],r=[],a=[];if(1===t)n=e,r=this.spawnPlusTexts(n.length-1),this.placeItemsAndPlusTexts(n,r,35,0,-7);else if(t>=1){var s=Math.ceil(e.length/2);n=e.slice(0,s),i=e.slice(s),r=this.spawnPlusTexts(n.length-1),a=this.spawnPlusTexts(i.length-1),this.placeItemsAndPlusTexts(n,r,35,-17.5,-24.5),this.placeItemsAndPlusTexts(i,a,35,12.5,5.5)}var o=e.reduce((function(e,t){return e.x<t.x?e:t})),c=e.reduce((function(e,t){return e.x>t.x?e:t})),h=e.reduce((function(e,t){return e.y<t.y?e:t})),u=e.reduce((function(e,t){return e.y>t.y?e:t})),l=c.x+c.displayWidth/2-(o.x-o.displayWidth/2)+39.519999999999996,d=u.y+u.displayHeight/2-(h.y-h.displayHeight/2)+27.52;this.updatePopupSize(l,d),this.plusTexts=[].concat(r,a),this.popupWrapper.setSize(this.width,this.height)}},n.placeItemsAndPlusTexts=function(e,t,n,i,r){e.forEach((function(t,r){var a=(r-(e.length-1)/2)*n;t.setPosition(a-5,i)})),t.forEach((function(e,i){var a=(i-(t.length-1)/2)*n;e.setPosition(a-8,r)}))},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItems();return n.setItemType(e.type),n.setItemAmount(e.amount),n.revive(),n.setScale(.36),t.bringToTop(n),n}))},n.getItems=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new hD(this.scene),this.itemPool.push(e),this.popupWrapper.add(e)),e},n.spawnPlusTexts=function(e){var t=this;return Array.from({length:e},(function(){var e=t.getPlusText();return e.revive(),e}))},n.getPlusText=function(){var e=this.plusPool.find((function(e){return!e.active}));return e||((e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"+"})).setTint(13790009),this.plusPool.push(e),this.popupWrapper.add(e)),e},n.create=function(){this.popupWrapper=this.scene.add.container(0,0),this.add(this.popupWrapper);var e=this.scene.make.nineslice({key:lD,frame:dD.REWARDS.HALF_TOP,width:196/3,height:59,leftWidth:15,rightWidth:24,topHeight:15,bottomHeight:11}),t=this.scene.make.nineslice({key:lD,frame:dD.REWARDS.HALF_BOTTOM,width:196/3,height:59,leftWidth:15,rightWidth:24,topHeight:11,bottomHeight:15});this.popupWrapper.add([e,t]),this.top=e,this.bottom=t,this.updatePopupSize(100,100)},n.updatePopupSize=function(e,t){var n=t/2;this.top.setSizeByWorld(e,n),this.bottom.setSizeByWorld(e,n),this.setSize(e,this.top.displayHeight+this.bottom.displayHeight),this.top.setY(-this.top.displayHeight/2),this.bottom.setY(this.bottom.displayHeight/2)},t}(Phaser.GameObjects.Container),fD=pD,mD=Ki.Z.DEFAULT,gD=mD.KEY,vD=mD.FRAME,yD=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.left=void 0,n.right=void 0,n.popupItems=[],n.itemPool=[],n.plusPool=[],n.plusTexts=[],n.isOpening=void 0,n.popupWrapper=void 0,n.scene=t,n.isOpening=!1,n.create(),n.setScale(0),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runPopupOpen=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isOpening=!0,this.setPosition(n,i),this.popupItems=this.spawnItems(t),this.alignItems(),r?this.popupWrapper.setY(-this.popupWrapper.displayHeight/2):this.popupWrapper.setY(this.popupWrapper.displayHeight/2),this.popupWrapper.setInteractive({hitArea:this.popupWrapper.getBounds()}),e.next=8,this.runEntranceAnimation();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isOpening=!1,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.setVisible(!0),this.setScale(0),e.next=5,this.scene.tweens.add({targets:this,scale:1,duration:t,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 5:return e.next=7,(0,me.qZ)(500);case 7:if(this.isOpening){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return e.next=11,this.runExitAnimation();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),e.next=3,this.scene.tweens.add({targets:this,scale:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.setVisible(!1),n.popupItems.forEach((function(e){e.kill()})),n.plusTexts.forEach((function(e){e.kill()})),n.popupItems=[],n.plusTexts=[],n.isOpening=!1}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.popupItems;if(0!==this.popupItems.length){this.plusTexts=this.spawnPlusTexts(e.length-1),this.placeItemsAndPlusTexts(e,this.plusTexts,35,-7,-12);var t=e.reduce((function(e,t){return e.x<t.x?e:t})),n=e.reduce((function(e,t){return e.x>t.x?e:t})),i=n.x+n.displayWidth/2-(t.x-t.displayWidth/2)+30,r=e.reduce((function(e,t){return e.displayHeight>t.displayHeight?e:t})).displayHeight+30;this.updatePopupSize(i,r),this.popupWrapper.setSize(this.width,this.height)}},n.placeItemsAndPlusTexts=function(e,t,n,i,r){e.forEach((function(t,r){var a=(r-(e.length-1)/2)*n;t.setPosition(a,i)})),t.forEach((function(e,i){var a=(i-(t.length-1)/2)*n;e.setPosition(a-3,r)}))},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItems();return n.setItemType(e.type),n.setItemAmount(e.amount),n.revive(),n.setScale(.36),t.bringToTop(n),n}))},n.getItems=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new hD(this.scene),this.itemPool.push(e),this.popupWrapper.add(e)),e},n.spawnPlusTexts=function(e){var t=this;return Array.from({length:e},(function(){var e=t.getPlusText();return e.revive(),e}))},n.getPlusText=function(){var e=this.plusPool.find((function(e){return!e.active}));return e||((e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"+"})).setTint(13790009),this.plusPool.push(e),this.popupWrapper.add(e)),e},n.create=function(){this.popupWrapper=this.scene.add.container(0,0),this.add(this.popupWrapper);var e=this.scene.make.nineslice({key:gD,frame:vD.REWARDS.HALF_LEFT,width:196/3,height:59,leftWidth:17,rightWidth:12,topHeight:15,bottomHeight:25}),t=this.scene.make.nineslice({key:gD,frame:vD.REWARDS.HALF_LEFT,width:196/3,height:59,leftWidth:17,rightWidth:12,topHeight:15,bottomHeight:25}),n=t.scale;t.setScale(-1*n,n),this.popupWrapper.add([e,t]),this.left=e,this.right=t,this.updatePopupSize(100,100)},n.updatePopupSize=function(e,t){var n=e/2;this.left.setSizeByWorld(n,t),this.right.setSizeByWorld(n,t),this.setSize(this.left.displayWidth+Math.abs(this.right.displayWidth),t),this.left.setX(-this.width/2+this.left.displayWidth/2),this.right.setX(this.width/2+this.right.displayWidth/2)},t}(Phaser.GameObjects.Container),ED=yD,CD=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0,n.maxScale=void 0;var i=1/GameCore.ImageScale;return n.maxScale=Phaser.Math.FloatBetween(.35*i,.7*i),n}return(0,f.Z)(t,e),t.prototype.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.scaleX=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.scaleY=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),r},t}(Phaser.GameObjects.Particles.Particle),wD=CD,AD=Ki.Z.RACE,bD=AD.KEY,SD=AD.FRAME,TD=function(e){function t(t){var n;return(n=e.call(this,t,bD,SD.MAIN.TWINKLE)||this).emitter=void 0,n.scene=t,n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:SD.MAIN.TWINKLE,quantity:2,lifespan:{min:2e3,max:4e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:1500,x:{min:-13,max:13},y:{min:-30,max:-5},blendMode:"Multiply",particleClass:wD})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),xD=TD,kD=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).isClicked=!1,r.parentName=void 0,r.disable=void 0,r.image=void 0,r.imageScaleX=void 0,r.imageScaleY=void 0,r.handlePointerDown=function(){r.isClicked||(r.isClicked=!0,r.onPointerDown())},r.handleOnClick=function(e){return function(){r.isClicked&&(r.isClicked=!1,r.onPointerUp(),r.logButtonEvent(),r.addDebugData(),e())}},r.handlePointerOut=function(){r.isClicked&&(r.isClicked=!1,r.onCancel())},r.createImage(n,i),r.listenEvents(),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.createImage=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setOrigin(.5,1),n.setDefaultWorldSize(),this.add(n),n.setY(n.height/2),this.setSize(n.width,n.height),this.image=n,this.imageScaleX=n.scaleX,this.imageScaleY=n.scaleY},n.listenEvents=function(){this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)},n.onPointerDown=function(){this.animButtonDown()},n.onPointerUp=function(){this.animButtonUp()},n.onCancel=function(){this.animButtonUp()},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this.image,scaleX:this.imageScaleX+.02,scaleY:this.imageScaleY-.02,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this.image,scaleX:this.imageScaleX,scaleY:this.imageScaleY,duration:100,ease:Phaser.Math.Easing.Sine.In,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.setDisabled=function(e){this.disable!=e&&(this.disable=e,e?this.disableInteractive():this.setInteractive({useHandCursor:!0}))},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,l.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(ae._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,X.Z)(t,[{key:"onClick",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e))}}]),t}(Phaser.GameObjects.Container),PD=kD,ID=Ki.Z.RACE,OD=ID.KEY,RD=ID.FRAME,BD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.island=void 0,i.gold=void 0,i.silver=void 0,i.bronze=void 0,i.goldMedal=void 0,i.silverMedal=void 0,i.bronzeMedal=void 0,i.chestTwinkle=void 0,i.rank=void 0,i.chestStatus=void 0,i.imageScale=void 0,i.chestPopup=void 0,i.isChestClaimed=void 0,i.container=void 0,i.isOpening=void 0,i.handleGoldChestClicked=function(){var e=nr[0].items;i.isOpening||(i.isOpening=!0,i.container.emit("chest-popup",e,(0,yc.Z)(i)))},i.scene=t,i.container=n,i.imageScale=1/GameCore.ImageScale,i.create(),i.setSize(i.island.width,i.island.height),i.alignItems(),i.chestStatus=_D.IDLE,i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.isChestClaimed=!1,this.chestStatus=_D.IDLE},n.runIdleChestAnimation=function(){this.setChestStatus(this.rank,this.isChestClaimed)},n.runChangeChestAnimation=function(e){var t=this;void 0===e&&(e=300);var n=this.scene.tweens.createTimeline();return n.add({targets:[this.gold,this.silver,this.bronze],scale:0,duration:e,ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.setChestsScale(0),t.island.setVisible(!0)}}),n.add({targets:[this.gold,this.silver,this.bronze],scale:1,duration:e,ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.updateChestsVisibility(),t.setChestsScale(0),t.island.setVisible(!0)},onComplete:function(){t.chestTwinkle.start()}}),n.playAndWaitForCompletion()},n.runHideChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.chestTwinkle.stop(),n=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],scale:0,delay:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){r.setChestsVisibility(!1),r.setChestsScale(0)}}).waitForCompletion(),i=this.scene.tweens.add({targets:this.island,scale:0,delay:0===t?0:200,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){r.island.setVisible(!1),r.island.setScale(0)}}).waitForCompletion(),e.next=6,Promise.all([n,i]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runShowChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=this.scene.tweens.add({targets:this.island,scale:this.imageScale,delay:t,duration:300,ease:Phaser.Math.Easing.Back.Out,onStart:function(){r.island.setVisible(!0),r.island.setScale(0)}}).waitForCompletion(),i=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],scale:1,delay:200+t,duration:300,ease:Phaser.Math.Easing.Back.Out,onStart:function(){r.updateChestsVisibility(),r.setChestsScale(0)},onComplete:function(){r.chestTwinkle.start()}}).waitForCompletion(),e.next=5,Promise.all([n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimPlayerChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=0),this.chestTwinkle.stop(),i=this.gold.x,r=this.gold.y,s=this.getLocalPoint(t.x+37,t.y),700,o=[this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],y:"-=40",scaleX:1.8,scaleY:1.8,delay:n,duration:350,ease:Phaser.Math.Easing.Cubic.Out}).waitForCompletion(),this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],y:s.y,scaleX:1,scaleY:1,delay:350+n,duration:350,ease:Phaser.Math.Easing.Quartic.In}).waitForCompletion()],c=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],x:s.x,delay:n+140,duration:560,ease:Phaser.Math.Easing.Sine.In}).waitForCompletion(),h=this.scene.tweens.add({targets:this.island,scale:0,delay:n,duration:350,ease:Phaser.Math.Easing.Back.In}).waitForCompletion(),u=this.scene.tweens.add({targets:[this.goldMedal,this.silverMedal,this.bronzeMedal],scale:3/9,delay:560,duration:140,ease:Phaser.Math.Easing.Back.Out,onStart:function(){l.updateMedalsVisibility(),l.setMedalsScale(0)}}).waitForCompletion(),e.next=12,Promise.all([c].concat(o,[h,u]));case 12:this.setChestsVisibility(!1),this.setChestsScale(1),this.gold.setPosition(i,r),this.silver.setPosition(i,r),this.bronze.setPosition(i,r),this.island.setVisible(!1),this.island.setScale(this.imageScale),this.isChestClaimed=!0;case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runClaimOtherChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=300),!this.isChestClaimed){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.next=5,this.runHideChestAnimation(t);case 5:return e.next=7,this.scene.tweens.add({targets:[this.goldMedal,this.silverMedal,this.bronzeMedal],scale:3/9,delay:0===t?0:200,duration:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){n.updateMedalsVisibility(),n.setMedalsScale(0)}}).waitForCompletion();case 7:this.isChestClaimed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setChestStatus=function(e,t){this.chestStatus=_D.IDLE,this.rank=e,this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.island.setVisible(!1),this.isChestClaimed=t,t?this.updateMedalsVisibility():(this.updateChestsVisibility(),this.updateIslandVisibility())},n.setChestsVisibility=function(e){this.gold.setVisible(e),this.silver.setVisible(e),this.bronze.setVisible(e)},n.setMedalsVisibility=function(e){this.goldMedal.setVisible(e),this.silverMedal.setVisible(e),this.bronzeMedal.setVisible(e)},n.updateChestsVisibility=function(){this.gold.setVisible(0===this.rank),this.silver.setVisible(1===this.rank),this.bronze.setVisible(2===this.rank)},n.updateMedalsVisibility=function(){this.goldMedal.setVisible(0===this.rank),this.silverMedal.setVisible(1===this.rank),this.bronzeMedal.setVisible(2===this.rank)},n.updateIslandVisibility=function(){this.island.setVisible(this.rank<=2)},n.setChestsScale=function(e){this.gold.setScale(e),this.silver.setScale(e),this.bronze.setScale(e)},n.setMedalsScale=function(e){this.goldMedal.setScale(e),this.silverMedal.setScale(e),this.bronzeMedal.setScale(e)},n.updateChestStatusWithRank=function(e){this.isChestClaimed?this.updateChestStatus(_D.CLAIMED,e):this.rank!==e?this.rank<=2?this.updateChestStatus(e<=2?_D.CHANGE:_D.HIDE,e):this.updateChestStatus(e<=2?_D.SHOW:_D.IDLE,e):this.updateChestStatus(_D.IDLE,e)},n.updateChestStatus=function(e,t){this.chestStatus=e,this.rank=t},n.setDefault=function(e){this.updateChestStatus(_D.IDLE,e),this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.updateChestsVisibility(),this.updateIslandVisibility()},n.hide=function(){this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.island.setVisible(!1),this.chestTwinkle.stop()},n.alignItems=function(){Phaser.Display.Align.In.BottomCenter(this.island,this),Phaser.Display.Align.In.BottomCenter(this.gold,this,0,-14),Phaser.Display.Align.In.BottomCenter(this.silver,this,0,-14),Phaser.Display.Align.In.BottomCenter(this.bronze,this,0,-14)},n.runShowChestPopup=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.chestPopup.isOpening){e.next=2;break}return e.abrupt("return");case 2:this.chestPopup.runPopupOpen(t,this.x,this.y,!0);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runHideChestPopup=function(){this.chestPopup.isOpening&&this.chestPopup.close()},n.create=function(){this.createIsland(),this.createChests(),this.createMedals(),this.createChestTwinkle(),this.createChestPopup()},n.createIsland=function(){this.island=this.scene.add.image(0,0,OD,RD.MAIN.ISLAND),this.island.setDefaultWorldSize(),this.island.setVisible(!1),this.add(this.island)},n.createChests=function(){this.createGoldChest(),this.createSilverChest(),this.createBronzeChest()},n.createMedals=function(){var e=this.scene.add.image(0,-6,OD,RD.MAIN.MEDAL.GOLD);e.setDefaultWorldSize();var t=this.scene.add.image(0,-6,OD,RD.MAIN.MEDAL.SILVER);t.setDefaultWorldSize();var n=this.scene.add.image(0,-6,OD,RD.MAIN.MEDAL.BRONZE);n.setDefaultWorldSize(),this.goldMedal=e,this.silverMedal=t,this.bronzeMedal=n,this.goldMedal.kill(),this.silverMedal.kill(),this.bronzeMedal.kill(),this.add(this.goldMedal),this.add(this.silverMedal),this.add(this.bronzeMedal)},n.createGoldChest=function(){var e=this,t=new PD(this.scene,OD,RD.MAIN.CHEST_ON_ISLAND.GOLD);this.add(t),this.gold=t,t.onClick=function(){var t=nr[0].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createSilverChest=function(){var e=this,t=new PD(this.scene,OD,RD.MAIN.CHEST_ON_ISLAND.SILVER);this.add(t),this.silver=t,t.onClick=function(){var t=nr[1].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createBronzeChest=function(){var e=this,t=new PD(this.scene,OD,RD.MAIN.CHEST_ON_ISLAND.BRONZE);this.add(t),this.bronze=t,t.onClick=function(){var t=nr[2].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createChestTwinkle=function(){this.chestTwinkle=new xD(this.scene),this.chestTwinkle.stop(),this.add(this.chestTwinkle)},n.createChestPopup=function(){var e=new ED(this.scene);e.setPosition(0,-50),this.add(e),this.chestPopup=e},t}(Phaser.GameObjects.Container),DD=BD;function LD(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return MD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MD(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function MD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _D=function(e){return e[e.CHANGE=0]="CHANGE",e[e.HIDE=1]="HIDE",e[e.SHOW=2]="SHOW",e[e.IDLE=3]="IDLE",e[e.CLAIMED=4]="CLAIMED",e}({}),ND=(kR={},kR[_D.CLAIMED]=0,kR[_D.CHANGE]=1,kR[_D.HIDE]=2,kR[_D.SHOW]=3,kR[_D.IDLE]=4,kR),GD=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).scene=void 0,r.racerPositions=void 0,r.islandChests=void 0,r.currentChestShowingPopup=void 0,r.chestPopupPool=[],r.handleCloseOpeningPopup=function(e){r.currentChestShowingPopup&&r.currentChestShowingPopup!==e&&r.currentChestShowingPopup.runHideChestPopup(),r.currentChestShowingPopup=e},r.runShowChestPopup=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.getChestPopup()){e.next=3;break}return e.abrupt("return");case 3:return s=n.getWorldPosition(),o=r.getLocalPoint(s.x,s.y),c=GameCore.layoutInitializer.isLandscape?0:-5,h=GameCore.layoutInitializer.isLandscape?-20:-15,r.bringToTop(i),e.next=10,i.runPopupOpen(t,o.x+c,o.y+h,!0);case 10:i.kill(),n.isOpening=!1;case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.runHideChestPopup=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.chestPopupPool.find((function(e){return e.active&&e.isOpening}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.runExitAnimation(150);case 5:t.kill();case 6:case"end":return e.stop()}}),e)}))),r.scene=t,r.racerPositions=n,r.create(),r.setSize(r.width,200),r.on("chest-popup",r.runShowChestPopup,(0,yc.Z)(r)),r.scene.add.existing((0,yc.Z)(r)),r}(0,f.Z)(t,e);var n=t.prototype;return n.getChestPopup=function(){var e,t=this.chestPopupPool.find((function(e){return!e.active}));return t?(t.revive(),t):((e=GameCore.layoutInitializer.isLandscape?new ED(this.scene):new fD(this.scene)).revive(),this.chestPopupPool.push(e),this.add(e),e)},n.isPlayerChestClaimed=function(){return this.islandChests[0].isChestClaimed},n.setupIslandChests=function(e){var t=this;e.forEach((function(e){var n=t.islandChests[e.racerIndex];n.rank=e.rank,n.setChestStatus(e.rank,e.rewardClaimed)}))},n.reset=function(){this.islandChests.forEach((function(e,t){e.reset(),e.setDefault(t)}))},n.getGoldChest=function(){return this.islandChests.find((function(e){return 0===e.rank}))},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.offshoreRace.getRacers().forEach((function(e){n.islandChests[e.racerIndex].rank=e.rank})),t=[].concat(this.islandChests).sort((function(e,t){return e.rank-t.rank})).slice(0,3),e.next=5,Promise.all(t.map((function(e,t){return e.runShowChestAnimation(200*t)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showChestsImmediately=function(){var e=this;this.scene.offshoreRace.getRacers().forEach((function(t){e.islandChests[t.racerIndex].setChestStatus(t.rank,t.rewardClaimed)}))},n.runPlacingTop3=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.offshoreRace.getRacers().forEach((function(e){c.islandChests[e.racerIndex].updateChestStatusWithRank(e.rank)})),t=[].concat(this.islandChests).sort((function(e,t){return ND[e.chestStatus]-ND[t.chestStatus]})),n=[],i=LD(t);case 5:if((r=i()).done){e.next=26;break}s=r.value,o=void 0,e.t0=s.chestStatus,e.next=e.t0===_D.CLAIMED?11:e.t0===_D.CHANGE?13:e.t0===_D.HIDE?16:e.t0===_D.SHOW?19:e.t0===_D.IDLE?22:24;break;case 11:return s.setChestStatus(s.rank,!0),e.abrupt("break",24);case 13:return o=s.runChangeChestAnimation(),n.push(o),e.abrupt("break",24);case 16:return e.next=18,s.runHideChestAnimation();case 18:return e.abrupt("break",24);case 19:return e.next=21,s.runShowChestAnimation();case 21:return e.abrupt("break",24);case 22:return s.runIdleChestAnimation(),e.abrupt("break",24);case 24:e.next=5;break;case 26:return e.next=28,Promise.all(n);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryPlayerClaimChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.islandChests[t.racerIndex],e.next=3,r.runClaimPlayerChestAnimation(n);case 3:i(t.rank);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.tryOpponentClaimChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.islandChests[t.racerIndex],e.next=3,n.runClaimOtherChestAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setDefault=function(){var e=this;this.islandChests.forEach((function(t,n){t.setPosition(0,e.racerPositions[n]+8),t.setDefault(n)}))},n.hideAllChests=function(){this.islandChests.forEach((function(e){e.hide()}))},n.create=function(){var e=this;this.islandChests=new Array(5).fill(null).map((function(){return new DD(e.scene,e)})),this.add(this.islandChests),this.setSize(this.islandChests[0].width,this.islandChests[0].height),this.setDefault()},t}(Phaser.GameObjects.Container),FD=GD,ZD=Ki.Z.RACE,UD=ZD.KEY,WD=ZD.FRAME,YD=function(e){function t(t){var n;return(n=e.call(this,t,{key:UD,backgroundFrame:WD.BUTTON.BASE,buttonFrame:WD.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.buttonStatus=qD.PLAY,n.goldChest=void 0,n.silverChest=void 0,n.bronzeChest=void 0,n.chestTwinkle=void 0,n.scene=t,n.createText(),n.createChest(),n.createChestTwinkle(),n.setSize(n.width,n.height),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createChest=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.goldChest=this.scene.add.image(36,-5,Ki.Z.RACE.KEY,Ki.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.GOLD),this.silverChest=this.scene.add.image(36,-3,Ki.Z.RACE.KEY,Ki.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.SILVER),this.bronzeChest=this.scene.add.image(36,-1,Ki.Z.RACE.KEY,Ki.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.BRONZE),this.goldChest.setDefaultWorldSize(),this.silverChest.setDefaultWorldSize(),this.bronzeChest.setDefaultWorldSize(),this.goldChest.kill(),this.silverChest.kill(),this.bronzeChest.kill(),this.addIntoButton(this.goldChest),this.addIntoButton(this.silverChest),this.addIntoButton(this.bronzeChest);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createChestTwinkle=function(){this.chestTwinkle=new xD(this.scene),this.chestTwinkle.setPosition(38,0),this.add(this.chestTwinkle)},n.createText=function(){var e=new Qp(this.scene,{text:"PLAY",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},n.setStatus=function(e){switch(this.buttonStatus=e,e){case qD.PLAY:this.setText("PLAY"),this.buttonText.setCenterAlign(),this.buttonText.setPosition(0,this.buttonText.y),this.hideChests(),this.chestTwinkle.stop();break;case qD.CLAIM:this.setText("CLAIM");break;case qD.CONTINUE:this.setText("OK"),this.buttonText.setCenterAlign(),this.buttonText.setPosition(0,this.buttonText.y),this.hideChests(),this.chestTwinkle.stop()}},n.getChest=function(e){switch(e){case 0:return this.goldChest;case 1:return this.silverChest;case 2:return this.bronzeChest}},n.hideChests=function(){this.goldChest.kill(),this.silverChest.kill(),this.bronzeChest.kill()},n.runClaimAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hideChests(),void 0!==(n=this.getChest(t))){e.next=4;break}return e.abrupt("return");case 4:return n.revive(),e.next=7,this.scene.tweens.add({targets:this,scaleX:1.1,scaleY:.9,y:"+=5",duration:200,yoyo:!0,ease:Phaser.Math.Easing.Quartic.Out,onStart:function(){i.setStatus(qD.CLAIM),i.buttonText.setLeftAlign(),i.buttonText.setPosition(-54,i.buttonText.y)}}).waitForCompletion();case 7:this.chestTwinkle.start();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setChestOnButton=function(e){this.hideChests();var t=this.getChest(e);void 0!==t&&(t.revive(),this.buttonText.setLeftAlign(),this.buttonText.setPosition(-54,this.buttonText.y),this.chestTwinkle.start())},t}(aT),HD=YD,zD=Ki.Z.RACE,KD=zD.KEY,VD=zD.FRAME,XD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.closeButton=void 0,i.playButton=void 0,i.racers=void 0,i.islandChestContainer=void 0,i.updateLevelButtons=[],i.devRaceButtons=[],i.shouldRunEntranceAnimation=void 0,i.firstOpenWhenRacing=void 0,i.chestPopupPool=[],i.scene=t,i.screen=n,i.shouldRunEntranceAnimation=!1,i.firstOpenWhenRacing=!0,i.create(),i.alignItems(),i.updateRacers(),i.setupIslandChests(),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.resetRacers=function(){this.racers.forEach((function(e){e.reset()})),this.islandChestContainer.reset()},n.closeContainer=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){1!==this.alpha&&this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.devRaceButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.updateLevelButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.setButtonsDisabled(!0),this.updateDescription(),this.updatePlayButton(),this.updateRacers(),!this.shouldRunEntranceAnimation){e.next=16;break}return this.shouldRunEntranceAnimation=!1,this.firstOpenWhenRacing=!1,this.islandChestContainer.hideAllChests(),this.runIslandChestsEntranceAnimation(),e.next=13,this.runRacersEntranceAnimation();case 13:(0,gl.Z)(this.scene,500).then((function(){var e=t.islandChestContainer.getGoldChest();e&&e.handleGoldChestClicked()})),e.next=21;break;case 16:return this.islandChestContainer.runPlacingTop3(),e.next=19,this.animateUpdateRacers();case 19:return e.next=21,this.tryRacersClaimChestAnimation();case 21:this.setButtonsDisabled(!1);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateDescription=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.description.setText("Be the first to beat "+e+" levels!")},n.updatePlayButton=function(){var e=this.scene.offshoreRace,t=e.getPlayerRank(),n=e.isFinished(),i=e.hasReward();n?i?(this.playButton.setStatus(qD.CLAIM),this.islandChestContainer.isPlayerChestClaimed()&&this.playButton.setChestOnButton(t)):this.playButton.setStatus(qD.CONTINUE):this.playButton.setStatus(qD.PLAY)},n.updateRacers=function(){for(var e=this.scene.offshoreRace.getRacers(),t=0;t<this.racers.length;t++){var n=e[t];if(n)this.racers[t].updateData(n)}},n.setupIslandChests=function(){var e=this.scene.offshoreRace.getRacers();this.islandChestContainer.setupIslandChests(e)},n.runRacersEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.racers.forEach((function(e){e.setAlpha(0)})),e.next=3,(0,me.qZ)(250);case 3:return t=this.racers.map((function(e,t){return e.runEntranceAnimation(t)})),e.next=6,Promise.all(t);case 6:this.shouldRunEntranceAnimation=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIslandChestsEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(250);case 2:this.islandChestContainer.runEntranceAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.animateUpdateRacers=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.racers.map((function(e){return e.animateUpdateRacerBlock()})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryRacersClaimChestAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.offshoreRace.getRacers(),n=function(e){h.playButton.runClaimAnimation(e)},i=0;case 3:if(!(i<t.length)){e.next=24;break}if(r=t[i],s=this.racers[i],!(o=0===i)||!r.rewardClaimed){e.next=9;break}return e.abrupt("break",24);case 9:if(c=this.scene.offshoreRace.getRequiredLevels(),!(r.score<c)&&ur.includes(r.rank)){e.next=12;break}return e.abrupt("continue",21);case 12:if(this.scene.requireTextureAsync("OFFSHORE_RACE_CHESTS",!1),s.playClaimAnimation(400),!o){e.next=19;break}return e.next=17,this.islandChestContainer.tryPlayerClaimChestAnimation(r,this.playButton.getWorldPosition(),n);case 17:e.next=21;break;case 19:return e.next=21,this.islandChestContainer.tryOpponentClaimChestAnimation(r);case 21:i++,e.next=3;break;case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this,t=GameCore.Utils.Number.normalizeNumber(Phaser.Math.Clamp(this.scene.world.getWorldSize().width,360,426),360,426,-2,-8);Phaser.Display.Align.In.TopCenter(this.header,this,0,22),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,0,-32),Phaser.Display.Align.In.TopCenter(this.description,this,0,-50),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-25,-21),Phaser.Display.Align.In.TopRight(this.closeButton,this,-20,-23),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,25),Phaser.Display.Align.In.RightCenter(this.islandChestContainer,this,t,25),GameCore.Utils.Valid.isDebugger()&&(this.updateLevelButtons.forEach((function(t,n){var i=e.racers[n];Phaser.Display.Align.To.LeftCenter(t,i,-10,0)})),Phaser.Display.Align.In.TopLeft(this.devRaceButtons[0],this,-25,-42),Phaser.Display.Align.In.TopLeft(this.devRaceButtons[1],this,-55,-42))},n.alignRacers=function(){var e=this;this.racers.forEach((function(t,n){t.setPosition(-e.width/2+t.width/2+8,40*n-55)}))},n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1),this.disableDevButtons(e)},n.create=function(){this.createBackground(),this.createTimePanel(),this.createHeader(),this.createDescription(),this.createRacers(),this.createButtons(),this.createIslandChestsContainer(),this.createDevButtons()},n.createBackground=function(){var e=this.scene.world.getWorldSize().width,t=e>=446?426:e-20,n=this.scene.add.image(0,0,KD,VD.MAIN.POPUP);n.setDefaultWorldSize(),this.add(n);var i=n.scale*t/426,r=1/GameCore.ImageScale;n.setScale(i,r),this.setSize(n.displayWidth,n.displayHeight)},n.createTimePanel=function(){this.timerPanel=new bB(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,KD,VD.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,KD,VD.MAIN.HEADER_BACKGROUND);e.setDefaultWorldSize(),this.header.add(e);var t=new Rf(this.scene);t.setText("Offshore Racers"),t.setFontSize(25.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-2.5),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(15),text:"Be the first to beat 15 levels!",origin:{x:.5,y:.5}});e.setTint(33447),this.add(e),this.description=e},n.createRacers=function(){for(var e=[],t=0;t<5;t++)e.push(new rD(this.scene,this,t));this.racers=e,this.add(this.racers),this.alignRacers()},n.createIslandChestsContainer=function(){var e=this.racers.map((function(e){return e.y-25}));this.islandChestContainer=new FD(this.scene,e),this.add(this.islandChestContainer)},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createPlayButton()},n.createInformationButton=function(){var e=new ov.Z(this.scene,{key:KD,frame:VD.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new ov.Z(this.scene,{key:KD,frame:VD.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createPlayButton=function(){var e=new HD(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.updateWithDebugger=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonsDisabled(!0),this.updatePlayButton(),this.updateRacers(),this.islandChestContainer.runPlacingTop3(),e.next=6,this.animateUpdateRacers();case 6:return e.next=8,this.tryRacersClaimChestAnimation();case 8:this.setButtonsDisabled(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createDevButtons=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=this.createDevButton("Reset\nScore");t.onClick=function(){e.scene.screen.close(de.o4.OFFSHORE_RACE.MAIN_SCREEN),e.shouldRunEntranceAnimation=!0,e.scene.offshoreRace.resetRacersScore(),(0,gl.Z)(e.scene,200).then((function(){return e.scene.openOffshoreRaceMainScreen()}))};var n=this.createDevButton("Erase\nRace");n.onClick=function(){e.scene.offshoreRace.events.emit(hr),e.scene.screen.close(de.o4.OFFSHORE_RACE.MAIN_SCREEN),e.shouldRunEntranceAnimation=!0,e.updateRacers(),e.setupIslandChests()},this.devRaceButtons.push(t,n);var i=this.createDevButton("Up\nPlayer");i.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(0,t),e.updateWithDebugger()};var r=this.createDevButton("Up\nOp1");r.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(1,t),e.updateWithDebugger()};var a=this.createDevButton("Up\nOp2");a.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(2,t),e.updateWithDebugger()};var s=this.createDevButton("Up\nOp3");s.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(3,t),e.updateWithDebugger()};var o=this.createDevButton("Up\nOp4");o.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(4,t),e.updateWithDebugger()},this.updateLevelButtons.push(i,r,a,s,o)}},n.disableDevButtons=function(e){this.updateLevelButtons.forEach((function(t){t.setDisabled(e),t.setAlpha(e?.3:.5)})),this.devRaceButtons.forEach((function(t){t.setDisabled(e),t.setAlpha(e?.3:.5)}))},n.createDevButton=function(e){var t=new jp.Z(this.scene,30,30),n=this.scene.add.image(0,0,Ki.Z.RACE.KEY,Ki.Z.RACE.FRAME.MAIN.OPPONENT.AVATAR_BACKGROUND);n.setDefaultWorldSize(),t.add(n);var i=new Qp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});return i.setAlign("center"),t.add(i),this.add(t),t},t}(Phaser.GameObjects.Container),jD=XD,qD=function(e){return e[e.PLAY=0]="PLAY",e[e.CLAIM=1]="CLAIM",e[e.CONTINUE=2]="CONTINUE",e}({}),JD=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.offshoreRaceMainContainer=void 0,o.previousScreen=void 0,o.handleInformationButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=void 0===o.previousScreen)&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),e.next=4,o.offshoreRaceMainContainer.closeContainer();case 4:return e.next=6,o.scene.screen.openAsync(de.o4.OFFSHORE_RACE.INTRO_SCREEN);case 6:t&&o.scene.screen.open(de.o4.DASHBOARD_SCREEN),o.scene.screen.bringToTop(de.o4.OFFSHORE_RACE.MAIN_SCREEN),o.offshoreRaceMainContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),o.handleCloseButtonClick=function(){var e=o.offshoreRaceMainContainer.playButton.buttonStatus;if(e===qD.CLAIM&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),o.scene.screen.close(o.name),e!==qD.CLAIM)e!==qD.CONTINUE||o.scene.offshoreRace.events.emit(hr);else{var t=o.scene.offshoreRace.getRewardData();o.scene.openOffshoreRaceRewardScreen({rewards:t})}},o.handlePlayButtonClick=function(){var e=o.offshoreRaceMainContainer.playButton.buttonStatus;if(e!==qD.CONTINUE&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),o.scene.screen.close(o.name),e!==qD.PLAY){if(e!==qD.CLAIM)return e===qD.CONTINUE?(o.scene.offshoreRace.events.emit(hr),void(o.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0)):void 0;var t=o.scene.offshoreRace.getRewardData();o.scene.openOffshoreRaceRewardScreen({rewards:t})}else o.scene.gameplay.processStartLevel()},o.close=function(){o.background.off(Phaser.Input.Events.POINTER_DOWN),o.offshoreRaceMainContainer.islandChestContainer.runHideChestPopup(),o.runExitAnimation()},o.onEntranceCompleted=function(){o.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.scene.screen.close(o.name)}))},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.scene.gameUI.coinBarButton.setDisabled(!1),o.previousScreen&&o.scene.screen.open(o.previousScreen)},o.scene=t,o.create(),o.listenEvents(),o.setDepth(de.Ks.POPUP),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.offshoreRaceMainContainer.setAlpha(0),o}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.createRaceMainContainer();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){var e=this.offshoreRaceMainContainer,t=e.informationButton,n=e.closeButton,i=e.playButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick,this.scene.offshoreRace.events.on(hr,this.endRace,this)},n.endRace=function(){var e=this;(0,gl.Z)(this.scene,100).then((function(){e.offshoreRaceMainContainer.resetRacers()})),this.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0},n.createRaceMainContainer=function(){this.offshoreRaceMainContainer=new jD(this.scene,this),this.offshoreRaceMainContainer.setInteractive(),this.add(this.offshoreRaceMainContainer),Phaser.Display.Align.In.Center(this.offshoreRaceMainContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),t.prev=1,i=null!=n?n:{previousScreen:de.o4.DASHBOARD_SCREEN},r=i.previousScreen,s=i.shouldPlayEntranceAnimation,r===de.o4.DASHBOARD_SCREEN?this.previousScreen=void 0:this.previousScreen=r,this.updateTime(),this.runEntranceAnimation(),t.next=8,this.handleFirstTimePlay();case 8:return this.offshoreRaceMainContainer.openContainer(),!0===s&&(this.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0),t.next=12,this.offshoreRaceMainContainer.open();case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),this.close();case 17:case"end":return t.stop()}}),t,this,[[1,14]])})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.offshoreRace.getIsFirstTimeEvent()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.offshoreRace.setIsFirstTimeEvent(!1),e.next=6,(0,me.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTime=function(){var e=this.scene.offshoreRace,t=e.isFinished();this.offshoreRaceMainContainer.timerPanel.timerLogic.setRemainingTime(t?0:e.getRemainingTime())},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.offshoreRaceMainContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){void 0===this.previousScreen&&this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.offshoreRaceMainContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),QD=JD,$D=Ki.Z.DASHBOARD,eL=$D.KEY,tL=$D.FRAME,nL=function(e){function t(t){var n;return(n=e.call(this,t)||this).sparksCount=6,n.sparks=[],n.wave=void 0,n.glow=void 0,n.animation=void 0,n.container=void 0,n.container=n.scene.add.container(),n.add(n.container),n.createSparks(),n.createWave(),n.createGlow(),n.createAnimation(),n.setDepth(Ha.Z.ON_TOP),n.setVisible(!1),n.container.setPosition(0,0),t.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.explode=function(){var e,t;null==(e=this.animation)||e.setTimeScale(1),null==(t=this.animation)||t.start()},n.createSparks=function(){for(var e=0;e<this.sparksCount;e++){var t=this.scene.add.image(0,0,eL,tL.EFFECTS.SPARKS).setAlpha(0);t.setDefaultWorldSize(),t.scale*=.53448,this.sparks.push(t)}this.container.add(this.sparks)},n.createWave=function(){this.wave=this.scene.add.image(0,5,eL,tL.EFFECTS.WAVE).setAlpha(0),this.wave.setWorldSize(14,14),this.container.add(this.wave)},n.createGlow=function(){this.glow=this.scene.add.image(0,0,eL,tL.EFFECTS.GLOW).setAlpha(0),this.glow.setDefaultWorldSize(),this.container.add(this.glow)},n.createAnimation=function(){var e=this;this.animation=new VA([{target:this.glow,color:[{color:"ffffff43",curve:.056,c2:.52,c3:.75},{time:.1,color:"ffffff7f",curve:.25,c3:.988,c4:.59},{time:.2667,color:"ffffff00"}]},{target:this.sparks[0],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[1],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[2],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[3],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[4],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[5],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.wave,color:[{time:.0333,color:"ffffff32"},{time:.1333,color:"ffffff94"},{time:.3,color:"ffffff00"}]},{target:this.glow,translate:[{x:-3.42,y:-2.28},{time:.2667,x:-3.42,y:3.73}],scale:[{x:0,y:0,curve:.128,c2:.73,c3:.75},{time:.2667,x:2.567,y:2.567}]},{target:this.sparks[0],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:42.58,y:42.58}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[1],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:-27.42,y:53.63}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[2],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:-59.65,y:-17.29}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[3],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5333,x:14.95,y:62.84}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.5333,x:0,y:0}],rotate:[{time:.0333},{time:.5333,angle:-102.81}]},{target:this.sparks[4],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:52.71,y:-12.68}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[5],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5,x:4.82,y:-41.23}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.5,x:0,y:0}],rotate:[{time:.0333},{time:.5,angle:-102.81}]},{target:this.wave,translate:[{time:.0333},{time:.3,x:.98,y:25.4}],scale:[{y:0},{time:.0333,curve:.25,c3:.75},{time:.3,x:4.198,y:4.198}]}]),this.animation.events.on("start",(function(){e.setVisible(!0)})),this.animation.events.on("complete",(function(){e.setVisible(!1)}))},t}(Phaser.GameObjects.Container),iL=nL,rL=Ki.Z.DEFAULT,aL=rL.KEY,sL=rL.FRAME,oL=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.itemType=void 0,n.item=void 0,n.itemAmount=void 0,n.amount=void 0,n.eventType=void 0,n.starEmitter=void 0,n.widgetSparksPool=[],n.scene=t,n.createItem(),n.createItemAmount(),n.createStarParticle(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.runStarExplodeParticle=function(){var e=this.getWidgetSparks();e.setPosition(0,0),e.explode(),this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.GOAL_PROGRESS)},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s,o){var c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.scene.tweens.add({targets:this,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1,duration:200},x:{from:t,start:t,to:i},y:{from:n,start:n,to:r},duration:s,ease:Phaser.Math.Easing.Back.Out,delay:o,onStart:function(){h.item.setVisible(!0)},onComplete:function(){h.runEffects()}}).waitForCompletion(),e.abrupt("return",c);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a,s){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,duration:250,scale:{from:this.scale,start:this.scale,to:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.kill(),t.scale=1,t.stopAnimation()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s){var o,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.scene.tweens.add({targets:this,duration:i,x:t,y:n,ease:Phaser.Math.Easing.Back.In,delay:r,scale:{from:this.scale,start:this.scale,to:.6*this.scale},onComplete:function(){c.item.setVisible(!1),c.scale=1,s(),c.stopAnimation(),c.runStarExplodeParticle()}}).waitForCompletion(),this.claim(),e.abrupt("return",o);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a){return e.apply(this,arguments)}}(),n.runHideItemAmountAnimation=function(e,t){var n=this;return this.scene.tweens.add({targets:this.itemAmount,duration:e,delay:t,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:1,start:1,to:0},onComplete:function(){n.itemAmount.setVisible(!1)}}).waitForCompletion()},n.claim=function(){var e=0,t=ji.NONE;switch(this.itemType){case er.UNDO:e=this.scene.player.getUndo(),this.scene.player.setUndo(e+this.amount);break;case er.PLUS_5_CARDS:e=this.scene.player.getPlusFive(),this.scene.player.setPlusFive(e+this.amount);break;case ji.STORM:case ji.SLICE:case ji.WILD_CARD:t=this.itemType,this.scene.gameplay.boosterManager.increaseBoosterAmount(t,this.amount)}this.scene.logEconomy.logGetItemByEvent(this.eventType,this.itemType,this.amount)},n.setEventType=function(e){this.eventType=e},n.setType=function(e){switch(this.itemType=e,e){case er.COIN:this.setFrame(sL.REWARDS.COIN);break;case er.UNDO:this.setFrame(sL.REWARDS.UNDO);break;case er.PLUS_5_CARDS:this.setFrame(sL.REWARDS.PLUS_5_CARDS);break;case ji.STORM:this.setFrame(sL.REWARDS.STORM);break;case ji.SLICE:this.setFrame(sL.REWARDS.SLICE);break;case ji.WILD_CARD:this.setFrame(sL.REWARDS.WILD_CARD)}},n.setAmount=function(e){if(this.amount=e,this.itemType===er.COIN){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.itemAmount.setText(""+t)}else this.itemAmount.setText("x"+e);this.itemAmount.x=0,this.itemAmount.y=this.height/2+10,this.itemAmount.setVisible(!0),this.itemAmount.setAlpha(1),this.itemAmount.setScale(1)},n.getAmount=function(){return this.amount},n.setFrame=function(e){this.item.setFrame(e),this.item.setDefaultWorldSize(),this.setSize(this.item.width,this.item.height)},n.runEffects=function(){var e;null==(e=this.starEmitter)||e.start()},n.stopAnimation=function(){var e,t;null==(e=this.starEmitter)||e.stop(),null==(t=this.starEmitter)||t.killAll()},n.createItem=function(){var e=this.scene.add.image(0,0,aL,sL.REWARDS.COIN);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height),this.item=e},n.createItemAmount=function(){var e=new Qp(this.scene,{text:"",fontSize:this.scene.fontSize(18),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add(e),this.itemAmount=e},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,aL,sL.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(200/3,40),t.setPosition(0-t.width/2,-t.height/2);var n=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:sL.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1*n})},particleClass:NS.Z,quantity:1})},n.getWidgetSparks=function(){var e=this.widgetSparksPool.find((function(e){return!e.active}));return e||(e=this.createWidgetSparks(),this.widgetSparksPool.push(e)),e},n.createWidgetSparks=function(){var e=new iL(this.scene);return this.add(e),e},t}(Phaser.GameObjects.Container),cL=Ki.Z.OFFSHORE_RACE_CHESTS,hL=cL.KEY,uL=cL.FRAME,lL=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.chestContainer=void 0,n.title=void 0,n.illustrators=void 0,n.itemPool=[],n.chestItems=[],n.isChestOpened=!1,n.canClaimChestItems=!1,n.tapToOpenButton=void 0,n.tapToClaimButton=void 0,n.openChestPosition=void 0,n.rewardScreen=void 0,n.handleTapToOpen=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isChestOpened){e.next=11;break}return n.isChestOpened=!0,n.tapToOpenButton.setDisabled(!0),n.hideTapToOpenOrClaimButton(n.tapToOpenButton,250),e.next=6,n.chestContainer.runChestOpenAnimation(n.openChestPosition.x,n.openChestPosition.y);case 6:return n.runChangeText(n.title,"Your Rewards",250),e.next=9,n.runPopupItemsFromChest();case 9:n.showTapToOpenOrClaimButton(n.tapToClaimButton,250,250),n.canClaimChestItems=!0;case 11:case"end":return e.stop()}}),e)}))),n.handleTapToClaim=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isChestOpened||!n.canClaimChestItems){e.next=13;break}return n.canClaimChestItems=!1,n.tapToClaimButton.setDisabled(!0),e.next=5,n.runObjectsExitAnimation();case 5:return e.next=7,(0,me.qZ)(100);case 7:return n.scene.screen.open(de.o4.DASHBOARD_SCREEN),n.scene.screen.bringToTop(de.o4.OFFSHORE_RACE.REWARD_SCREEN),n.scene.offshoreRace.events.emit(hr),e.next=12,n.claimAllItems();case 12:n.scene.screen.close(de.o4.OFFSHORE_RACE.REWARD_SCREEN);case 13:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.openChestPosition={x:0,y:60},n.create(),n.listenEvents(),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.tapToOpenButton.onClick=this.handleTapToOpen,this.tapToClaimButton.onClick=this.handleTapToClaim},n.setRewardScreen=function(e){this.rewardScreen=e},n.updateChestData=function(e){var t=e.rewards,n=this.getChestType();this.chestContainer=this.createChestContainer(n,qC.OFFSHORE_RACE),this.chestItems=this.spawnItems(t)},n.getChestType=function(){var e=this.scene.offshoreRace.getPlayerRank();return[jC.GOLD,jC.SILVER,jC.BRONZE][e]},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItemContainer();return n.setEventType(qC.OFFSHORE_RACE),n.setType(e.type),n.setAmount(e.amount),n.revive(),n.setScale(0),t.bringToTop(n),n}))},n.getItemContainer=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new oL(this.scene),this.itemPool.push(e),this.add(e)),e},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runTitleEntranceAnimation(),this.runIllustratorsEntranceAnimation(),e.next=4,this.chestContainer.runChestEntranceAnimation(0,0);case 4:this.showTapToOpenOrClaimButton(this.tapToOpenButton,250,100);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.isChestOpened=!1,this.canClaimChestItems=!1,this.title.setText("Congratulations!"),this.tapToOpenButton.setDisabled(!1),this.tapToClaimButton.setDisabled(!1)},n.runTitleEntranceAnimation=function(){this.scene.tweens.add({targets:[this.title],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runObjectsExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rewardScreen.runFadeBackground(0);case 2:return t=this.chestContainer.runChestExitAnimation(),n=this.runIllustratorsExitAnimation(),i=this.hideTapToOpenOrClaimButton(this.tapToClaimButton,250),r=this.scene.tweens.add({targets:[this.title],ease:Phaser.Math.Easing.Back.In,duration:250,scale:{from:1,start:1,to:0},alpha:{from:1,start:1,to:0}}).waitForCompletion(),s=[t,i,r,n],e.next=9,Promise.all(s);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIllustratorsExitAnimation=function(){var e=this;return this.scene.tweens.add({targets:this.illustrators,duration:150,ease:Phaser.Math.Easing.Sine.In,alpha:{from:1,start:1,to:0},y:{from:this.illustrators.y,start:this.illustrators.y,to:this.illustrators.y+20},onComplete:function(){e.illustrators.setPosition(0,e.height/2-e.illustrators.height/2)}}).waitForCompletion()},n.claimAllItems=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.find((function(e){return e.itemType===er.COIN})),n=this.chestItems.filter((function(e){return e.itemType!==er.COIN})),this.runClaimCoin(t),e.next=5,this.runClaimItems(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimCoin=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.runExitAnimation();case 4:return n=t.getWorldPosition(),i=n.x,r=n.y,(s=this.scene.rewardManager).rewardCoin(t.getAmount()),this.scene.logEconomy.logGetItem(yl.COIN,t.getAmount(),Cl.OFFSHORE_RACE),e.abrupt("return",s.coinAnimationPool.runAnimationRewardCoinAsync(15,i,r));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimItems=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLevelButton(),i=this.getLocalPoint(n.getWorldPosition().x,n.getWorldPosition().y),r=i.x,s=i.y,o=0,c=function(){n.runClaimItemsAnimation()},h=t.map((function(e){o+=150;var t=e.runClaimAnimation(r,s,600,o,c);return e.runHideItemAmountAnimation(150,0),t})),e.next=7,Promise.all(h);case 7:return e.next=9,(0,me.qZ)(550);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getLevelButton=function(){return this.scene.screen.get(de.o4.DASHBOARD_SCREEN).levelButton},n.showTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:0,start:0,to:1},onStart:function(){e.revive(),e.text.setScale(0)}}).waitForCompletion()},n.hideTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:1,start:1,to:0},onComplete:function(){e.kill(),e.text.setScale(0)}}).waitForCompletion()},n.runChangeText=function(e,t,n){this.scene.tweens.add({targets:e,duration:n,ease:Phaser.Math.Easing.Sine.In,yoyo:!0,scale:0,alpha:0,onYoyo:function(){e.setText(t)}})},n.create=function(){this.createTitle(),this.createIllustrators(),this.createTapToOpenButton(),this.createTapToClaimButton()},n.createTitle=function(){var e=GameCore.layoutInitializer.isLandscape?30:26,t=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(e),text:"Congratulations!",origin:{x:.5,y:.5}});this.add(t),this.title=t},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,hL,uL.OFFSHORE_RACE.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,hL,uL.OFFSHORE_RACE.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),t.setPosition(-this.width/2+t.width/2,0),n.setPosition(this.width/2-n.width/2,0),e.setPosition(0,this.height/2-e.height/2),this.illustrators=e},n.createChestContainer=function(e,t){if(this.chestContainer)this.chestContainer.updateChestFrame(e,t);else{var n=new JC(this.scene,e,t);this.add(n),this.chestContainer=n}return this.chestContainer},n.createTapToOpenButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new wT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to open!"),t.setName("TapToOpen"),this.add(t),this.tapToOpenButton=t,t.kill()},n.createTapToClaimButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new wT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to claim!"),t.setName("TapToClaim"),this.add(t),this.tapToClaimButton=t,t.kill()},t}(Phaser.GameObjects.Container),dL=function(e){function t(t){var n;return(n=e.call(this,t)||this).alignUI(),n.openChestPosition={x:0,y:60},n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-20),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-10),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-10)},n.runPopupItemsFromChest=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.calculateRowPositions(this.chestItems),n=this.chestItems.map((function(e,n){var r=i.chestContainer.x,a=i.chestContainer.y-30,s=t[n],o=s.x,c=s.y,h=100*n;return e.runEntranceAnimation(r,a,o,c,400,h)})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.calculateRowPositions=function(e){var t=(e.length-1)/2;return e.map((function(e,n){return{x:70*(n-t),y:16*Math.abs(n-t)-70}}))},t}(lL),pL=function(e){function t(t){var n;return(n=e.call(this,t)||this).alignUI(),n.openChestPosition={x:0,y:110},n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.Center(this.title,this,0,-220),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-30),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-30)},n.runPopupItemsFromChest=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.length>4?3:4,n=Math.ceil(this.chestItems.length/t),i=this.splitItemsIntoRows(this.chestItems,t),r=i.flatMap((function(e,t){var i=100*t;return o.calculateRowPositions(e,n,i)})),s=this.chestItems.map((function(e,t){var n=o.chestContainer.x,i=o.chestContainer.y-30,a=r[t],s=a.x,c=a.y,h=100*t;e.runEntranceAnimation(n,i,s,c,400,h)})),e.next=7,Promise.all(s);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.splitItemsIntoRows=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},n.calculateRowPositions=function(e,t,n){var i=t>1?-140:-90,r=(e.length-1)/2;return e.map((function(e,t){return{x:70*(t-r),y:16*Math.abs(t-r)+i+n}}))},t}(lL),fL=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.rewardContainer=void 0,o.onExitCompleted=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.close.call((0,yc.Z)(o)),o.background.setAlpha(1);case 2:case"end":return t.stop()}}),t)}))),o.scene=t,o.rewardContainer=GameCore.layoutInitializer.isLandscape?new dL(o.scene):new pL(o.scene),o.rewardContainer.setRewardScreen((0,yc.Z)(o)),o.add(o.rewardContainer),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this),this.runEntranceAnimation(),this.rewardContainer.updateChestData(t),this.rewardContainer.runEntranceAnimation()},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rewardContainer.close(),this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFadeBackground=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.add({targets:this.background,alpha:{from:this.background.alpha,start:this.background.alpha,to:t},duration:150,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),mL=fL,gL=886/3,vL=502/3,yL=Ki.Z.WEEKLY_TOURNAMENT,EL=yL.KEY,CL=yL.FRAME,wL=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).handleButtonClick=function(){n.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN)},n.setSize(gL,vL),n.create(),n}return(0,f.Z)(t,e),t.prototype.create=function(){var e=new fy(this.scene,{key:EL,frame:CL.FAILED.POPUP,width:886/3,height:502/3,topHeight:140/3,bottomHeight:60});this.add(e);var t=this.scene.add.image(0,0,EL,CL.FAILED.HEADER);t.setDefaultWorldSize(),this.add(t);var n=new Rf(this.scene);n.setText("Weekly Tournament"),n.setFontSize(22),n.setRadius(-800),n.setLetterSpacing(-.2),this.add(n);var i=new Qp(this.scene,{text:"You can't join this time,\nplease try again later",fontSize:this.scene.fontSize(15),fillColor:11102533});i.setCenterAlign(),i.setY(-7),this.add(i);var r=new aT(this.scene,{key:EL,backgroundFrame:CL.FAILED.BUTTON.BASE,buttonFrame:CL.FAILED.BUTTON.GREEN,buttonWidth:403/3,buttonHeight:137/3,buttonInnerWidth:338/3,buttonInnerHeight:41});r.alignBackground(0,-.5),r.button.setName("Ok");var a=new Qp(this.scene,{text:"Ok",fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});r.addIntoButton(a),r.onClick=this.handleButtonClick,this.add(r),Phaser.Display.Align.In.TopCenter(t,e,0,30.5),Phaser.Display.Align.In.Center(n,t,0,-1.5),Phaser.Display.Align.In.BottomCenter(r,e,.125,16.5)},t}(Phaser.GameObjects.Container),AL=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).tournamentsFailedContainer=void 0,a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.setDepth(de.Ks.POPUP),a.tournamentsFailedContainer=new wL(t),a.add(a.tournamentsFailedContainer),a.background.setAlpha(de.MR.ALPHA.COMMON),a}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.tournamentsFailedContainer.setAlpha(1),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.tournamentsFailedContainer]},Sv.tweenConfigs.popup.configOpen),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.tournamentsFailedContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),bL=AL,SL=Ki.Z.WEEKLY_TOURNAMENT,TL=SL.KEY,xL=SL.FRAME,kL=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){var e=-this.scene.gameZone.height/2-50;Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.TopCenter(this.step1,this,-180,e),Phaser.Display.Align.In.TopCenter(this.step2,this,0,e),Phaser.Display.Align.In.TopCenter(this.step3,this,190,e),Phaser.Display.Align.In.Center(this.arrow1,this,-90,8),Phaser.Display.Align.In.Center(this.arrow2,this,95,8)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[xL.INTRO.ITEM_1,xL.INTRO.ITEM_2,xL.INTRO.ITEM_3],n=["Beat levels","Get cups for\nwinnings","Get prizes"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,TL,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,TL,xL.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),PL=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new kL(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),IL=Ki.Z.WEEKLY_TOURNAMENT,OL=IL.KEY,RL=IL.FRAME,BL=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(de.Ks.POPUP),i.create(),i.alignItems(),i}(0,f.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-90,-50),Phaser.Display.Align.In.Center(this.step2,this,90,50),Phaser.Display.Align.In.Center(this.step3,this,-90,180),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,100),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow1,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runArrowEntranceAnimation(this.arrow2,800,500),c=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,r,s,o,c,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:r},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[RL.INTRO.ITEM_1,RL.INTRO.ITEM_2,RL.INTRO.ITEM_3],n=["Beat levels!","Collect cups!","Get prizes!"],i=Array.from({length:3},(function(i,r){return new ET(e.scene,OL,t[r],n[r])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[RL.INTRO.ARROW_RIGHT,RL.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var r=e.scene.add.image(0,0,OL,t[i]);return r.setDefaultWorldSize(),r}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new wT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),DL=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).weeklyTournamentIntroContainer=void 0,a.close=function(){a.runExitAnimation()},a.onEntranceCompleted=function(){},a.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(a))},a.scene=t,a.create(),a.setDepth(de.Ks.POPUP),a.setAlpha(0),a.background.setAlpha(0),a.weeklyTournamentIntroContainer.close(),a}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new BL(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),LL=GameCore.layoutInitializer.isLandscape?PL:DL,ML=n(81),_L=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0,n.maxScale=void 0;var i=1/GameCore.ImageScale;return n.maxScale=Phaser.Math.FloatBetween(.35*i,.7*i),n}return(0,f.Z)(t,e),t.prototype.update=function(t,n,i){var r=e.prototype.update.call(this,t,n,i);return this.scaleX=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.scaleY=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),r},t}(Phaser.GameObjects.Particles.Particle),NL=_L,GL=Ki.Z.WEEKLY_TOURNAMENT,FL=GL.KEY,ZL=GL.FRAME,UL=function(e){function t(t){var n;return(n=e.call(this,t,FL,ZL.LEADERBOARD.TWINKLE)||this).emitter=void 0,n.scene=t,n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:ZL.LEADERBOARD.TWINKLE,quantity:1,lifespan:{min:2e3,max:4e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:1500,x:{min:-13,max:13},y:{min:-10,max:10},blendMode:"Multiply",particleClass:NL})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),WL=UL,YL=Ki.Z.WEEKLY_TOURNAMENT,HL=YL.KEY,zL=YL.FRAME,KL=function(e){function t(t){var n;return(n=e.call(this,t,98/3,82/3)||this).chest=void 0,n.chestTwinkle=void 0,n.rewardIndex=void 0,n.isOpening=void 0,n.rank=void 0,n.scene=t,n.updateSize(),n.createChest(),n.createChestTwinkle(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(42,34)},n.createChest=function(){this.chest=this.scene.add.image(0,0,HL,zL.LEADERBOARD.CHEST.GOLD),this.chest.setDefaultWorldSize(),this.add(this.chest)},n.createChestTwinkle=function(){this.chestTwinkle=new WL(this.scene),this.add(this.chestTwinkle)},n.setRank=function(e){var t=this;if(e<=0)this.setVisible(!1);else{this.setVisible(!0),this.chest.setY(0);var n=this.scene.weeklyTournament.getTopByRank(e);-1===n?(this.rewardIndex=-1,this.setVisible(!1)):n>=1&&n<=4?(this.rewardIndex=e-1,this.chest.setFrame("leaderboard/chest_"+n)):5===n&&(this.rewardIndex=e-1,this.chest.setFrame(zL.LEADERBOARD.COIN_ICON),this.chest.setY(1)),this.chestTwinkle.start(),this.setNameByRank(e),this.onClick=function(){if(-1!==t.rewardIndex&&!t.isOpening){var n=t.scene.weeklyTournament.getRewardData(e);t.isOpening=!0,t.scene.events.emit("chest-popup",n,t)}}}},n.setNameByRank=function(e){0===this.rewardIndex?this.setName("GoldChest"):1===this.rewardIndex?this.setName("SilverChest"):2===this.rewardIndex?this.setName("PurpleChest"):3===this.rewardIndex?this.setName("BronzeChest"):e>=11&&e<=30&&this.setName("Coin")},t}(jp.Z),VL=Ki.Z.WEEKLY_TOURNAMENT,XL=VL.KEY,jL=VL.FRAME,qL=11102533,JL=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.icon=void 0,n.countText=void 0,n.updateSize(),n.createBackground(),n.createIcon(),n.createCountText(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateScore=function(e,t){t?(this.background.setFrame(jL.LEADERBOARD.PLAYER.SCORE_PANEL),this.countText.setText(e.toString()),this.countText.setTintSeparate(4554921,0)):(this.background.setFrame(jL.LEADERBOARD.OPPONENT.SCORE_PANEL),this.countText.setText(e>=0?e.toString():"---"),this.countText.setTintSeparate(qL,0))},n.updateSize=function(){this.setSize(200/3,19)},n.createBackground=function(){this.background=this.scene.make.nineslice({key:XL,frame:jL.LEADERBOARD.PLAYER.SCORE_PANEL,width:this.width,height:this.height,leftWidth:10,rightWidth:10}),this.add(this.background)},n.createIcon=function(){this.icon=this.scene.add.image(0,0,XL,jL.LEADERBOARD.CUP_ICON),this.icon.setDefaultWorldSize(),this.add(this.icon),this.icon.setX(-26)},n.createCountText=function(){var e=new Qp(this.scene,{text:"99999",fontSize:this.scene.fontSize(11),fillColor:qL});e.setCenterAlign(),this.add(e),this.countText=e,Phaser.Display.Align.In.RightCenter(this.countText,this,-6,.5)},t}(Phaser.GameObjects.Container),QL=Ki.Z.WEEKLY_TOURNAMENT,$L=QL.KEY,eM=QL.FRAME,tM={width:95/3,height:91/3,loadDelay:100,photoSizeOffset:-2,radius:80,position:{x:0,y:0}},nM=function(e){function t(t,n){var i;return void 0===n&&(n=tM),(i=e.call(this,t,{key:$L,background:eM.LEADERBOARD.PLAYER.AVATAR.BACKGROUND,frame:eM.LEADERBOARD.PLAYER.AVATAR.NO_AVATAR,width:n.width,height:n.height,loadDelay:n.loadDelay})||this).cfg=void 0,i.cfg=n,t.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){if(void 0===i&&(i=this.cfg.radius),this.updatePlayerTheme(t),t===this.payload.id&&n===this.payload.url&&this.payload.url)return this.avtFrame.kill(),void this.photo.revive();this.isNoAvatar(t,n)||e.prototype.loadPhoto.call(this,t,n,i)},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,r=n.height,a=this.cfg.position,s=a.x,o=a.y;this.avtFrame.kill(),this.photo.revive(),this.photo.setWorldSize(i,r),this.photo.setPosition(s,o)},n.isNoAvatar=function(e,t){return!t&&(this.photo.kill(),this.avtFrame.revive(),!0)},n.updatePlayerTheme=function(e){var t=e===this.scene.game.player.getPlayerId(),n=t?eM.LEADERBOARD.PLAYER.AVATAR.BACKGROUND:eM.LEADERBOARD.OPPONENT.AVATAR.BACKGROUND,i=t?eM.LEADERBOARD.PLAYER.AVATAR.NO_AVATAR:eM.LEADERBOARD.OPPONENT.AVATAR.NO_AVATAR;this.background.setFrame(n),this.avtFrame.setFrame(i)},t}(Dc),iM=Ki.Z.WEEKLY_TOURNAMENT,rM=iM.KEY,aM=iM.FRAME,sM=11102533,oM=function(e){function t(t){var n;return(n=e.call(this,t)||this).medal=void 0,n.rankText=void 0,n.updateSize(),n.createMedal(),n.createRankText(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createMedal=function(){this.medal=this.scene.add.image(0,0,rM,aM.LEADERBOARD.STAR_1),this.medal.setDefaultWorldSize(),this.add(this.medal),this.medal.setY(-1)},n.setRank=function(e,t){var n=e>=1&&e<=3,i="";this.rankText.setX(0),0===e?i="-":e>=1e3?(i="999+",this.rankText.setX(2)):i=e.toString(),this.rankText.setText(i),n?(this.rankText.kill(),this.medal.revive(),this.medal.setFrame("leaderboard/star"+e)):(this.rankText.revive(),this.medal.kill()),this.rankText.setTintSeparate(t?4554921:sM,0)},n.updateSize=function(){this.setSize(21.5,19)},n.createRankText=function(){this.rankText=new Qp(this.scene,{text:"1",fontSize:this.scene.fontSize(14),fillColor:sM}),this.rankText.setCenterAlign(),this.add(this.rankText)},t}(Phaser.GameObjects.Container),cM=Ki.Z.WEEKLY_TOURNAMENT,hM=cM.KEY,uM=cM.FRAME,lM=11102533,dM=function(e){function t(t){var n;return(n=e.call(this,t)||this).payload=void 0,n.background=void 0,n.medal=void 0,n.avatar=void 0,n.cupPanel=void 0,n.coinPanel=void 0,n.claimButton=void 0,n.rank=void 0,n.needUpdateRank=void 0,n.isPlayer=void 0,n.leaderName=void 0,n.isVisibleInLeaderboard=!0,n.updateSize(),n.createAvatar(),n.createBackground(),n.createMedal(),n.createLeaderName(),n.createCoinPanel(),n.createCupPanel(),n.createClaimButton(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.claimButton.onClick=function(){e.scene.events.emit(EM.CLAIM_REWARD,e.rank)}},n.toggleClaimButtonVisibility=function(e){e?(this.claimButton.revive(),this.coinPanel.setY(-6)):(this.claimButton.kill(),this.coinPanel.setY(-1.5))},n.updateInfo=function(e){this.payload=e;var t=e.playerId,n=e.name,i=e.photo,r=e.score,a=e.rank;this.setAlpha(1),this.isVisibleInLeaderboard=!0,this.isPlayer=this.scene.player.getPlayerId()===t,this.rank=a,this.avatar.loadPhoto(t,i),this.medal.setRank(a,this.isPlayer),this.setUsername(n,this.isPlayer),this.cupPanel.updateScore(r,this.isPlayer),this.coinPanel.setRank(a),this.updatePanelBackground(this.isPlayer)},n.updateRank=function(e){this.medal.setRank(e,this.isPlayer),this.coinPanel.setRank(e),this.rank=e},n.updatePanelBackground=function(e){e?this.background.setFrame(uM.LEADERBOARD.PLAYER.LEADER_BLOCK_BG):this.background.setFrame(uM.LEADERBOARD.OPPONENT.LEADER_BLOCK_BG),this.background.setDefaultWorldSize(),this.setSize(this.background.width,this.background.height)},n.setUsername=function(e,t){var n=GameCore.Utils.String.getShortName(e,12),i=GameCore.Utils.String.removeDiacritics(n);this.leaderName.setText(i),this.leaderName.setTintSeparate(t?4554921:lM,0)},n.runShowUpAnimation=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=200),this.isVisibleInLeaderboard){var n=50*e;this.runShowPopUpAnimation(n,t)}},n.runShowPopUpAnimation=function(e,t){var n=this;this.scene.tweens.killTweensOf(this),this.scene.tweens.add({targets:this,alpha:{start:0,from:0,to:1},scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out},duration:t,delay:e,onStart:function(){n.setScale(.75),n.setAlpha(0),n.revive()}})},n.updateSize=function(){this.setSize(1126/3,125/3)},n.createAvatar=function(){this.avatar=new nM(this.scene),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-40,-.25)},n.createBackground=function(){this.background=this.scene.add.image(0,0,hM,uM.LEADERBOARD.PLAYER.LEADER_BLOCK_BG),this.background.setDefaultWorldSize(),this.add(this.background)},n.createMedal=function(){this.medal=new oM(this.scene),this.add(this.medal),Phaser.Display.Align.In.LeftCenter(this.medal,this,-10,1)},n.createLeaderName=function(){var e=new Qp(this.scene,{text:"Amely",fontSize:this.scene.fontSize(14),fillColor:lM});e.setLeftAlign(),this.add(e),this.leaderName=e,Phaser.Display.Align.In.LeftCenter(this.leaderName,this,-84,-1.5)},n.createCoinPanel=function(){this.coinPanel=new KL(this.scene),this.add(this.coinPanel),Phaser.Display.Align.In.RightCenter(this.coinPanel,this,-90,0)},n.createCupPanel=function(){this.cupPanel=new JL(this.scene),this.add(this.cupPanel);this.cupPanel.setX(this.width/2-this.cupPanel.width/2-7)},n.createClaimButton=function(){this.claimButton=new ov.Z(this.scene,{key:hM,frame:uM.LEADERBOARD.BUTTON.CLAIM,width:121/3,height:50/3}),this.claimButton.setName("Claim");var e=new Qp(this.scene,{text:"Claim",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.claimButton.add(e),this.add(this.claimButton),this.claimButton.kill(),Phaser.Display.Align.In.RightCenter(this.claimButton,this.coinPanel,1,10.5)},t}(Phaser.GameObjects.Container),pM=function(e){function t(t){var n;return(n=e.call(this,t)||this).panel=void 0,n.txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,f.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(220/3,19)},n.createText=function(){this.txt=new Qp(this.scene,{text:"Completed",fontSize:this.scene.fontSize(12),fillColor:11102533}),this.txt.setTint(10844770),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new fM(this.scene,this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),fM=function(){function e(e,t){this.scene=void 0,this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.scene=e,this.timerPanel=t,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",10),t.scene.weeklyTournament.events.emit(ko),t.countdownTimer.remove();else{var n=cb(1e3*Math.ceil(e/1e3)),i=n.days,r=n.hours,a=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+r+"h":r.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),mM=Ki.Z.WEEKLY_TOURNAMENT,gM=mM.KEY,vM=mM.FRAME,yM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leaderBlocks=[],n.animateClock=void 0,n.timerPanel=void 0,n.closeButton=void 0,n.informationButton=void 0,n.bg=void 0,n.loading=void 0,n.chestPopupPool=[],n.debugButtons=[],n.totalLeaders=void 0,n.leaderboardBackground=void 0,n.illustration=void 0,n.header=void 0,n.cupHeader=void 0,n.scroller=void 0,n.playerBlock=void 0,n.leaderBlockYs=[],n.playerIndex=void 0,n.runShowChestPopup=function(){var e=(0,i.Z)(a().mark((function e(t,i){var r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getChestPopup()){e.next=3;break}return e.abrupt("return");case 3:return n.scroller.setEnable(!1),s=i.getWorldPosition(),o=n.getLocalPoint(s.x,s.y),c=GameCore.layoutInitializer.isLandscape?0:-10,h=GameCore.layoutInitializer.isLandscape?-10:0,n.bringToTop(r),e.next=11,r.runPopupOpen(t,o.x+c,o.y+h,!0);case 11:r.kill(),i.isOpening=!1,n.scroller.setEnable(!0);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.runHideChestPopup=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.chestPopupPool.find((function(e){return e.active&&e.isOpening}))){e.next=3;break}return e.abrupt("return");case 3:t.kill();case 4:case"end":return e.stop()}}),e)}))),n.scene=t,n.totalLeaders=n.scene.weeklyTournament.getTotalLeaders(),n.create(),n.alignItems(),n.listenEvents(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on("chest-popup",this.runShowChestPopup,this)},n.closeContainer=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,i.Z)(a().mark((function e(){var t,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.debugButtons.forEach((function(e){n.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),1!==this.alpha){e.next=3;break}return e.abrupt("return");case 3:return this.setButtonsDisabled(!0),t=this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In}),e.next=7,t.waitForCompletion();case 7:this.setButtonsDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideLeaders(),this.showLoading(),e.next=4,this.getLeaderboardData();case 4:return t=e.sent,e.next=7,this.updateLeaders(t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateLeaders=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.scene.player.getPlayerId(),i=[].concat(t).slice(0,Math.min(t.length,10)),this.updatePlayerIndexAndTotalLeaders(n,t,i),this.playerBlock=this.leaderBlocks[this.playerIndex],this.scroller.gotoTop(),this.scroller.removeChildren(),this.leaderBlocks=this.leaderBlocks.slice(0,this.totalLeaders),this.createLeaderBlocks(),r=this.createPlayerData(n),i[this.playerIndex]=r,s=0;case 11:if(!(s<this.totalLeaders)){e.next=20;break}if(o=i[s]){e.next=15;break}return e.abrupt("continue",17);case 15:this.leaderBlocks[s].updateInfo(o);case 17:s++,e.next=11;break;case 20:this.leaderBlocks=this.scroller.getChildren(),this.scroller.setEnable(this.leaderBlocks.length>4),this.scroller.gotoTop(),this.hideLoading(),this.showLeaders();case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updatePlayerIndexAndTotalLeaders=function(e,t,n){this.playerIndex=999;var i=n.findIndex((function(t){return t.playerId===e}));if(-1!==i)this.totalLeaders=n.length,this.playerIndex=i;else if(0===t.length)this.playerIndex=0,this.totalLeaders=1;else{var r=n.length>=10;this.totalLeaders=r?11:n.length,this.playerIndex=this.totalLeaders-1}},n.createPlayerData=function(e){var t=this.scene.profile.getProfile(e)||{},n=this.scene.weeklyTournament.getRank(),i=this.scene.weeklyTournament.getScore();return this.scene.weeklyTournament.oldProgress={rank:n,score:i},{playerId:e,name:"You",photo:t.photo||this.scene.player.getPlayer().photo,score:i,rank:n}},n.getLeaderboardData=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.weeklyTournament,n=[],e.next=4,t.requestLeaderboardData();case 4:return n=t.getLeaderboardData(),e.next=7,t.checkRequestPlayerProgress();case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLoading=function(){var e=this;this.scene.tweens.add({targets:this.loading,alpha:1,duration:300,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.loading.setVisible(!0)}})},n.hideLoading=function(){var e=this;this.scene.tweens.add({targets:this.loading,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){e.loading.setVisible(!1)}})},n.hideLeaders=function(){this.leaderBlocks.forEach((function(e){e.setVisible(!1),e.setScale(.75),e.setAlpha(0)}))},n.showLeaders=function(){for(var e=0;e<this.leaderBlocks.length;e++){var t=this.leaderBlocks[e];t&&t.runShowUpAnimation(e,300)}},n.getChestPopup=function(){var e,t=this.chestPopupPool.find((function(e){return!e.active}));return t?(t.revive(),t):((e=GameCore.layoutInitializer.isLandscape?new ED(this.scene):new fD(this.scene)).revive(),this.chestPopupPool.push(e),this.add(e),e)},n.getPlayerBlock=function(){return this.playerBlock},n.setButtonsDisabled=function(e){this.closeButton.setDisabled(e),this.informationButton.setDisabled(e)},n.alignItems=function(){Phaser.Display.Align.In.BottomCenter(this.leaderboardBackground,this,0,-19),Phaser.Display.Align.In.BottomCenter(this.scroller,this,0,-16),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-21,-26),Phaser.Display.Align.In.TopRight(this.closeButton,this,-17,-27),Phaser.Display.Align.In.TopCenter(this.header,this,1,34),Phaser.Display.Align.In.TopCenter(this.illustration,this,0,-10),Phaser.Display.Align.In.TopCenter(this.cupHeader,this,0,-1),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,1,-84)},n.create=function(){this.createLeaderBlocksBackground(),this.createLeaderBlockScroller(),this.createLeaderBlocks(),this.createBackground(),this.createIllustration(),this.createInformationButton(),this.createCloseButton(),this.createHeader(),this.createCupHeader(),this.createTimerPanel(),this.createLoading(),this.createBlockInput(),this.createDevButtons()},n.createLeaderBlocksBackground=function(){var e=this.scene.add.image(0,0,gM,vM.LEADERBOARD.LEADERBOARD_BG);e.setDefaultWorldSize(),this.add(e),e.setScale(1.02*e.scale),this.leaderboardBackground=e},n.createLeaderBlockScroller=function(){var e=125/3;this.scroller=new ML.Z(this.scene,{width:1126/3,height:190,marginTop:0,marginBottom:-3}),this.scroller.createMask(),this.add(this.scroller);var t=-this.scroller.height/2+e/2+6;this.leaderBlockYs=Array.from({length:11},(function(n,i){return t+i*(e+0)}))},n.createLeaderBlocks=function(){for(var e=this,t=0;t<this.totalLeaders;t++){var n=this.leaderBlocks[t];n||(n=new dM(this.scene),this.leaderBlocks.push(n))}this.leaderBlocks.forEach((function(t,n){t.setPosition(0,e.leaderBlockYs[n]),e.scroller.addItem(t)})),this.hideLeaders()},n.createBackground=function(){var e=new fy(this.scene,{key:gM,frame:vM.LEADERBOARD.POPUP,width:1246/3,height:928/3,topHeight:380/3,bottomHeight:170/3});this.add(e),this.setSize(e.displayWidth,e.displayHeight),this.bg=e},n.createInformationButton=function(){var e=Ki.Z.WEEKLY_TOURNAMENT,t=e.KEY,n=e.FRAME;this.informationButton=new ov.Z(this.scene,{key:t,frame:n.LEADERBOARD.BUTTON.INFORMATION,width:19/3,height:14,paddingZone:20}),this.informationButton.setName("Information"),this.add(this.informationButton)},n.createCloseButton=function(){var e=Ki.Z.WEEKLY_TOURNAMENT,t=e.KEY,n=e.FRAME;this.closeButton=new ov.Z(this.scene,{key:t,frame:n.LEADERBOARD.BUTTON.CLOSE,width:40/3,height:14,paddingZone:20}),this.closeButton.setName("Close"),this.add(this.closeButton)},n.createIllustration=function(){var e=this.scene.add.image(0,0,gM,vM.LEADERBOARD.ILLUSTRATION);e.setDefaultWorldSize(),this.add(e),this.illustration=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,gM,vM.LEADERBOARD.HEADER);e.setDefaultWorldSize(),this.header.add(e),this.header.setSize(e.width,e.height);var t=new Rf(this.scene);t.setText("Weekly Tournament"),t.setFontSize(22),t.setRadius(-1500),t.setLetterSpacing(-.2),t.setPosition(0,-1.5),this.header.add(t)},n.createCupHeader=function(){var e=this.scene.add.image(0,0,gM,vM.LEADERBOARD.CUP_HEADER);e.setDefaultWorldSize(),this.add(e),this.cupHeader=e},n.createTimerPanel=function(){this.timerPanel=new pM(this.scene),this.timerPanel.txt.setPosition(9,0),this.timerPanel.txt.clearTint(),this.timerPanel.txt.setFontSize(this.scene.fontSize(10));var e=this.scene.add.image(0,0,gM,vM.LEADERBOARD.TIME_PANEL);e.setDefaultWorldSize(),this.animateClock=new tT(this.scene),this.animateClock.setPosition(-28,0),this.timerPanel.addAt(e,0),this.timerPanel.addAt(this.animateClock,1),this.add(this.timerPanel)},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(35),this.add(this.loading)},n.createBlockInput=function(){var e=this.scene.add.container(0,0);e.setSize(43,60),this.add(e),e.setPosition(77,-65),e.setInteractive()},n.createDevButtons=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=[this.createRewardButton("Claim\nGold",1),this.createRewardButton("Claim\nSilver",2),this.createRewardButton("Claim\nPurple",3),this.createRewardButton("Claim\nBronze",4),this.createRewardButton("Claim\nCoin",11)];t.forEach((function(t,n){t.setPosition(30*n-170,-70),e.debugButtons.push(t)}));var n=this.createEndTimeButton();n.setPosition(60,-70),this.debugButtons.push(n)}},n.createRewardButton=function(e,t){var n=this,i=this.createDevButton(e);return i.onClick=function(){n.scene.events.emit(EM.CLAIM_REWARD,t)},i},n.createEndTimeButton=function(){var e=this,t=this.createDevButton("End\nTime\nIn 5s");return t.onClick=function(){e.scene.weeklyTournament.updateWeeklyTournament({endTime:(Date.now()+5e3)/1e3}),e.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN)},t},n.createDevButton=function(e){var t=new jp.Z(this.scene,30,30),n=this.scene.add.image(0,0,Ki.Z.WEEKLY_TOURNAMENT.KEY,Ki.Z.WEEKLY_TOURNAMENT.FRAME.LEADERBOARD.PLAYER.AVATAR.OVERLAY);n.setDefaultWorldSize(),t.add(n);var i=new Qp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});return i.setAlign("center"),t.add(i),this.add(t),t},t}(Phaser.GameObjects.Container),EM={CLAIM_REWARD:"claimReward"},CM=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).leaders=[],o.needRestartTournament=!1,o.previousScreen=void 0,o.weeklyTournamentMainContainer=void 0,o.handleInformationButtonClick=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=o.previousScreen===de.o4.DASHBOARD_SCREEN)&&o.scene.screen.close(de.o4.DASHBOARD_SCREEN),e.next=4,o.weeklyTournamentMainContainer.closeContainer();case 4:return e.next=6,o.scene.screen.openAsync(de.o4.WEEKLY_TOURNAMENT.INTRO_SCREEN);case 6:return t&&o.scene.screen.open(de.o4.DASHBOARD_SCREEN),o.scene.screen.bringToTop(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN),e.next=10,o.weeklyTournamentMainContainer.openContainer();case 10:case"end":return e.stop()}}),e)}))),o.handleCloseButtonClick=function(){o.scene.screen.close(o.name)},o.handleClaimReward=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.previousScreen=void 0,(n=o.weeklyTournamentMainContainer.getPlayerBlock())&&n.toggleClaimButtonVisibility(!1),o.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN),o.scene.screen.close(de.o4.DASHBOARD_SCREEN),0!==(i=o.scene.weeklyTournament.getRewardData(t)).length){e.next=8;break}return e.abrupt("return",o.scene.screen.open(de.o4.DASHBOARD_SCREEN));case 8:o.scene.requireTextureAsync("WEEKLY_TOURNAMENT_CHESTS").then((function(){o.scene.screen.open(de.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN,{rewards:i,rank:t})}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.close=function(){o.runExitAnimation(),o.weeklyTournamentMainContainer.runHideChestPopup()},o.onEntranceCompleted=function(){},o.onExitCompleted=function(){e.prototype.close.call((0,yc.Z)(o)),o.weeklyTournamentMainContainer.hideLeaders(),o.weeklyTournamentMainContainer.animateClock.stopAnimation(),o.weeklyTournamentMainContainer.setAlpha(0),o.previousScreen&&o.scene.screen.open(o.previousScreen),o.needRestartTournament&&o.scene.weeklyTournament.restartTournament()},o.scene=t,o.create(),o.listenEvents(),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o.weeklyTournamentMainContainer.setAlpha(0),o}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentMainContainer()},n.listenEvents=function(){var e=this.weeklyTournamentMainContainer,t=e.informationButton,n=e.closeButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,this.scene.events.on(EM.CLAIM_REWARD,this.handleClaimReward,this),this.scene.weeklyTournament.events.on(ko,this.updateTime,this)},n.createWeeklyTournamentMainContainer=function(){this.weeklyTournamentMainContainer=new yM(this.scene),this.weeklyTournamentMainContainer.setInteractive(),this.add(this.weeklyTournamentMainContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentMainContainer,this,0,15)},n.open=function(){var t=(0,i.Z)(a().mark((function t(n){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),i=null!=n?n:{previousScreen:de.o4.DASHBOARD_SCREEN},r=i.previousScreen,this.previousScreen=r,this.runEntranceAnimation(),t.next=6,this.handleFirstTimePlay();case 6:return this.updateTime(),this.weeklyTournamentMainContainer.openContainer(),t.next=10,this.weeklyTournamentMainContainer.updateData();case 10:this.updateShowClaimButton();case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.weeklyTournament.getPlayerWeeklyTournamentData(),t.firstTimePlay){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.weeklyTournament.updateWeeklyTournament({firstTimePlay:!1}),e.next=6,(0,me.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTime=function(){var e=this.scene.weeklyTournament;e.isFinished()?(this.weeklyTournamentMainContainer.timerPanel.timerLogic.setRemainingTime(0),this.updateShowClaimButton()):(this.weeklyTournamentMainContainer.timerPanel.timerLogic.setRemainingTime(e.getRemainingTime()),this.weeklyTournamentMainContainer.animateClock.animate())},n.updateShowClaimButton=function(){this.needRestartTournament=!1;var e=this.weeklyTournamentMainContainer.getPlayerBlock(),t=this.scene.weeklyTournament,n=t.isFinished(),i=t.hasReward();e&&(n?(i&&(e.toggleClaimButtonVisibility(i),this.scene.requireTextureAsync("WEEKLY_TOURNAMENT_CHESTS",!1)),this.needRestartTournament=!i):e.toggleClaimButtonVisibility(!1))},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.weeklyTournamentMainContainer.closeContainer(),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this.weeklyTournamentMainContainer]},Sv.tweenConfigs.popup.configClose),(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),wM=Ki.Z.WEEKLY_TOURNAMENT_CHESTS,AM=wM.KEY,bM=wM.FRAME,SM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.chestContainer=void 0,n.title=void 0,n.illustrators=void 0,n.itemPool=[],n.chestItems=[],n.isChestOpened=!1,n.canClaimChestItems=!1,n.tapToOpenButton=void 0,n.tapToClaimButton=void 0,n.openChestPosition=void 0,n.rewardScreen=void 0,n.isRewardOnlyCoin=void 0,n.handleTapToOpen=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isChestOpened){e.next=15;break}if(n.isChestOpened=!0,n.tapToOpenButton.setDisabled(!0),n.hideTapToOpenOrClaimButton(n.tapToOpenButton,250),!n.isRewardOnlyCoin){e.next=8;break}n.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.CHEST_OPEN),e.next=11;break;case 8:return e.next=10,n.chestContainer.runChestOpenAnimation(n.openChestPosition.x,n.openChestPosition.y);case 10:n.runChangeText(n.title,"Your Rewards",250);case 11:return e.next=13,n.runPopupItemsFromChest();case 13:n.showTapToOpenOrClaimButton(n.tapToClaimButton,250,250),n.canClaimChestItems=!0;case 15:case"end":return e.stop()}}),e)}))),n.handleTapToClaim=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isChestOpened||!n.canClaimChestItems){e.next=13;break}return n.canClaimChestItems=!1,n.tapToClaimButton.setDisabled(!0),e.next=5,n.runObjectsExitAnimation();case 5:return e.next=7,(0,me.qZ)(100);case 7:return n.scene.screen.open(de.o4.DASHBOARD_SCREEN),n.scene.screen.bringToTop(de.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN),n.scene.weeklyTournament.restartTournament(),e.next=12,n.claimAllItems();case 12:n.scene.screen.close(de.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN);case 13:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.openChestPosition={x:0,y:60},n.create(),n.listenEvents(),n}(0,f.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.tapToOpenButton.onClick=this.handleTapToOpen,this.tapToClaimButton.onClick=this.handleTapToClaim},n.setRewardScreen=function(e){this.rewardScreen=e},n.updateChestData=function(e){var t=e.rewards,n=e.rank;this.isRewardOnlyCoin=1===t.length&&t[0].type===er.COIN;var i=this.getChestType(n);this.chestContainer=this.createChestContainer(i,qC.WEEKLY_TOURNAMENT),this.chestItems=this.spawnItems(t)},n.getChestType=function(e){return[jC.GOLD,jC.SILVER,jC.PURPLE,jC.BRONZE][e>=1&&e<=3?e-1:3]},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItemContainer();return n.setEventType(qC.WEEKLY_TOURNAMENT),n.setType(e.type),n.setAmount(e.amount),n.revive(),n.setScale(0),t.bringToTop(n),n}))},n.getItemContainer=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new oL(this.scene),this.itemPool.push(e),this.add(e)),e},n.runEntranceAnimation=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.runIllustratorsEntranceAnimation(),!this.isRewardOnlyCoin){e.next=7;break}this.runTitleEntranceAnimation("Your Rewards"),this.setOffsetYForItemPopup(0),this.handleTapToOpen(),e.next=12;break;case 7:return this.runTitleEntranceAnimation("Congratulations!"),this.setOffsetYForItemPopup(-75),e.next=11,this.chestContainer.runChestEntranceAnimation(0,0);case 11:this.showTapToOpenOrClaimButton(this.tapToOpenButton,250,100);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.isChestOpened=!1,this.canClaimChestItems=!1,this.title.setText("Congratulations!"),this.tapToOpenButton.setDisabled(!1),this.tapToClaimButton.setDisabled(!1)},n.runTitleEntranceAnimation=function(e){void 0===e&&(e="Congratulations!"),this.title.setText(e),this.scene.tweens.add({targets:[this.title],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runObjectsExitAnimation=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rewardScreen.runFadeBackground(0);case 2:return t=this.chestContainer.runChestExitAnimation(),n=this.runIllustratorsExitAnimation(),i=this.hideTapToOpenOrClaimButton(this.tapToClaimButton,250),r=this.scene.tweens.add({targets:[this.title],ease:Phaser.Math.Easing.Back.In,duration:250,scale:{from:1,start:1,to:0},alpha:{from:1,start:1,to:0}}).waitForCompletion(),s=[t,i,r,n],e.next=9,Promise.all(s);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIllustratorsExitAnimation=function(){var e=this;return this.scene.tweens.add({targets:this.illustrators,duration:150,ease:Phaser.Math.Easing.Sine.In,alpha:{from:1,start:1,to:0},y:{from:this.illustrators.y,start:this.illustrators.y,to:this.illustrators.y+20},onComplete:function(){e.illustrators.setPosition(0,e.height/2-e.illustrators.height/2)}}).waitForCompletion()},n.claimAllItems=function(){var e=(0,i.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.find((function(e){return e.itemType===er.COIN})),n=this.chestItems.filter((function(e){return e.itemType!==er.COIN})),this.runClaimCoin(t),e.next=5,this.runClaimItems(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimCoin=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.runExitAnimation();case 4:return n=t.getWorldPosition(),i=n.x,r=n.y,(s=this.scene.rewardManager).rewardCoin(t.getAmount()),this.scene.logEconomy.logGetItem(yl.COIN,t.getAmount(),Cl.WEEKLY_TOURNAMENT),e.abrupt("return",s.coinAnimationPool.runAnimationRewardCoinAsync(15,i,r));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimItems=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLevelButton(),i=this.getLocalPoint(n.getWorldPosition().x,n.getWorldPosition().y),r=i.x,s=i.y,o=0,c=function(){n.runClaimItemsAnimation()},h=t.map((function(e){o+=150;var t=e.runClaimAnimation(r,s,600,o,c);return e.runHideItemAmountAnimation(150,0),t})),e.next=7,Promise.all(h);case 7:return e.next=9,(0,me.qZ)(550);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getLevelButton=function(){return this.scene.screen.get(de.o4.DASHBOARD_SCREEN).levelButton},n.showTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:0,start:0,to:1},onStart:function(){e.revive(),e.text.setScale(0)}}).waitForCompletion()},n.hideTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:1,start:1,to:0},onComplete:function(){e.kill(),e.text.setScale(0)}}).waitForCompletion()},n.runChangeText=function(e,t,n){this.scene.tweens.add({targets:e,duration:n,ease:Phaser.Math.Easing.Sine.In,yoyo:!0,scale:0,alpha:0,onYoyo:function(){e.setText(t)}})},n.create=function(){this.createTitle(),this.createIllustrators(),this.createTapToOpenButton(),this.createTapToClaimButton()},n.createTitle=function(){var e=GameCore.layoutInitializer.isLandscape?30:26,t=this.scene.make.bitmapText({font:Rc.ZP.STYLE.KEY,size:this.scene.fontSize(e),text:"Congratulations!",origin:{x:.5,y:.5}});this.add(t),this.title=t},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,AM,bM.WEEKLY_TOURNAMENT.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,AM,bM.WEEKLY_TOURNAMENT.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),t.setPosition(-this.width/2+t.width/2,0),n.setPosition(this.width/2-n.width/2,0),e.setPosition(0,this.height/2-e.height/2),this.illustrators=e},n.createChestContainer=function(e,t){if(this.chestContainer)this.chestContainer.updateChestFrame(e,t);else{var n=new JC(this.scene,e,t);this.add(n),this.chestContainer=n}return this.chestContainer},n.createTapToOpenButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new wT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to open!"),t.setName("TapToOpen"),this.add(t),this.tapToOpenButton=t,t.kill()},n.createTapToClaimButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new wT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to claim!"),t.setName("TapToClaim"),this.add(t),this.tapToClaimButton=t,t.kill()},t}(Phaser.GameObjects.Container),TM=function(e){function t(t){var n;return(n=e.call(this,t)||this).offsetY=void 0,n.alignUI(),n.setOffsetYForItemPopup(-70),n.openChestPosition={x:0,y:60},n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-20),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-10),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-10)},n.setOffsetYForItemPopup=function(e){this.offsetY=e},n.runPopupItemsFromChest=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.calculateRowPositions(this.chestItems),n=this.chestItems.map((function(e,n){var r=i.chestContainer.x,a=i.chestContainer.y-30,s=t[n],o=s.x,c=s.y,h=100*n;return e.runEntranceAnimation(r,a,o,c,400,h)})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.calculateRowPositions=function(e){var t=this,n=(e.length-1)/2;return e.map((function(e,i){return{x:70*(i-n),y:16*Math.abs(i-n)+t.offsetY}}))},t}(SM),xM=function(e){function t(t){var n;return(n=e.call(this,t)||this).offsetY=void 0,n.alignUI(),n.openChestPosition={x:0,y:110},n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.Center(this.title,this,0,-220),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-30),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-30)},n.setOffsetYForItemPopup=function(e){this.offsetY=e},n.runPopupItemsFromChest=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.length>4?3:4,n=Math.ceil(this.chestItems.length/t),i=this.splitItemsIntoRows(this.chestItems,t),r=i.flatMap((function(e,t){var i=100*t;return o.calculateRowPositions(e,n,i)})),s=this.chestItems.map((function(e,t){var n=o.chestContainer.x,i=o.chestContainer.y-30,a=r[t],s=a.x,c=a.y,h=100*t;e.runEntranceAnimation(n,i,s,c,400,h)})),e.next=7,Promise.all(s);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.splitItemsIntoRows=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},n.calculateRowPositions=function(e,t,n){var i=t>1?-140:-90,r=(e.length-1)/2;return e.map((function(e,t){return{x:70*(t-r),y:16*Math.abs(t-r)+i+n}}))},t}(SM),kM=function(e){function t(t,n,r,s){var o;return(o=e.call(this,t,n,r,s)||this).scene=void 0,o.rewardContainer=void 0,o.onExitCompleted=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.close.call((0,yc.Z)(o)),o.background.setAlpha(1);case 2:case"end":return t.stop()}}),t)}))),o.scene=t,o.rewardContainer=GameCore.layoutInitializer.isLandscape?new TM(o.scene):new xM(o.scene),o.rewardContainer.setRewardScreen((0,yc.Z)(o)),o.add(o.rewardContainer),o.setDepth(de.Ks.POPUP),o.setAlpha(0),Ap.Z.registerObject(o.background,de.MR.MULTIPLY_ALPHA),o}(0,f.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this),this.runEntranceAnimation(),this.rewardContainer.updateChestData(t),this.rewardContainer.runEntranceAnimation()},n.close=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rewardContainer.close(),this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFadeBackground=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.add({targets:this.background,alpha:{from:this.background.alpha,start:this.background.alpha,to:t},duration:150,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Hc.Z.UI.KEY,rc.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,p.Z)({targets:[this]},Sv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),PM=kM,IM=Ki.Z.GAMEPLAY_OBJECTS,OM=IM.KEY,RM=IM.FRAME,BM=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.settingsMenu=void 0,n.settingsOpening=void 0,n.settingsPlaying=void 0,n.canHandleSettings=void 0,n.endGameBtn=void 0,n.openSettings=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=250),n.settingsMenu.openSettings(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.closeSettings=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=250),n.settingsMenu.closeSettings(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSettingsMenuAutoClose=function(e){n.settingsMenu.getBounds().contains(e.worldX,e.worldY)||n.closeSettings()},n.handleSettingsOnClick=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.settingsOpening?n.closeSettings():n.openSettings();case 1:case"end":return e.stop()}}),e)}))),n.handleSoundChange=function(e){n.scene.player.setSetting("sound",e)},n.handleMusicChanged=function(e){n.scene.player.setSetting("music",e),e?n.scene.resumeMusic():n.scene.audio.pauseAllMusics()},n.handleVibrationChanged=function(e){n.scene.player.setSetting("vibrate",e),e&&n.scene.vibration.performVibrating(50)},n.handleOpenExitGameScreen=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.canHandleSettings){e.next=2;break}return e.abrupt("return");case 2:n.scene.screen.open(de.o4.EXIT_GAME_SCREEN,{exitCallback:function(){n.scene.turnOffMusic(Hc.Z.GAMEPLAY_BACKGROUND.KEY),n.scene.screen.close(de.o4.EXIT_GAME_SCREEN),n.scene.gameplay.boardGame.stateMachine.emit(tu.EXIT);var e=n.scene.gameplay.boardGame.blackBackground.alpha;n.scene.gameplay.boardGame.runFadeBackground(e,0,250,0)},playOnCallback:function(){n.scene.screen.close(de.o4.EXIT_GAME_SCREEN)},eventItems:n.scene.gameplay.eventManager.getCurrentEventItems()}),n.handleSettingsOnClick();case 4:case"end":return e.stop()}}),e)}))),n.handleExitGame=function(){n.endGameBtn.active&&n.scene.gameplay.enableCardInput&&n.scene.screen.open(de.o4.EXIT_GAME_SCREEN,{exitCallback:function(){var e=n.scene.gameplay.boardGame,t=n.scene.world.getWorldSize(),i=t.width,r=t.height;n.scene.screen.close(de.o4.EXIT_GAME_SCREEN),e.locks.forEach((function(e){e.exit()})),e.blowCardsBehavior.blow(i/2,r/2).then((function(){e.stateMachine.emit(tu.LOSE)})),n.scene.gameUI.gameUILayout.hidePlusCardsButtons(),n.scene.audio.playAudioSprite(Hc.Z.CONGRATS_SOUND.KEY,rc.Z.END_GAME),n.scene.analytics.event(ae._.LEVEL_GIVE_UP,{level:n.scene.level.getLevel()})},playOnCallback:function(){n.scene.screen.close(de.o4.EXIT_GAME_SCREEN)}})},n.scene=t;var r=n.scene.gameZone.width;return n.setSize(r,40),n.createButtons(),t.add.existing((0,yc.Z)(n)),n.scene.input.on(Phaser.Input.Events.POINTER_UP,n.handleSettingsMenuAutoClose,(0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createButtons=function(){this.createEndGameBtn(),this.createSettingsBtn()},n.createEndGameBtn=function(){var e=this.scene.add.image(0,0,OM,RM.BTN_END_GAME);e.setDefaultWorldSize();var t=new jp.Z(this.scene,e.width,e.height);t.add(e),t.setName("EndGame");var n=new Qp(this.scene,{text:this.scene.lang.Text.endGame2,fontSize:this.scene.fontSize(13),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});n.setY(-1),t.add(n),this.endGameBtn=t,this.add(this.endGameBtn),this.endGameBtn.onClick=this.handleExitGame},n.createSettingsBtn=function(){this.settingsMenu=new Ck(this.scene),this.settingsMenu.setName("SettingsMenu"),Phaser.Display.Align.In.LeftCenter(this.settingsMenu,this,-2,-4),this.add(this.settingsMenu),this.settingsMenu.close(0)},n.setCanHandleSettings=function(e){this.settingsMenu.setCanHandleSettings(e)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,r=void 0===i||i,a=e.vibrate,s=void 0===a||a,o=this.settingsMenu,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.updateStatus(n),h.button.updateStatus(r),u&&u.button.updateStatus(s)},t}(Phaser.GameObjects.Container),DM=BM,LM=Ki.Z.GAMEPLAY_DEFAULT,MM=LM.KEY,_M=LM.FRAME,NM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.avatar=void 0,n.scoreText=void 0,n.cupIcon=void 0,n.score=void 0,n.avatarContainer=void 0,n.scene=t,n.setSize(81,25.5),n.createBackground(),n.createAvatar(),n.createText(),n.reset(),n}(0,f.Z)(t,e);var n=t.prototype;return n.reset=function(){this.scoreText.setText("0"),this.score=0},n.alignLeft=function(){this.scoreText.setLeftAlign(),this.scoreText.setOrigin(0,.5),Phaser.Display.Align.In.LeftCenter(this.avatarContainer,this,-6),Phaser.Display.Align.In.LeftCenter(this.scoreText,this,-35)},n.alignRight=function(){this.scoreText.setRightAlign(),this.scoreText.setOrigin(1,.5),Phaser.Display.Align.In.RightCenter(this.avatarContainer,this,-6),Phaser.Display.Align.In.RightCenter(this.scoreText,this,-35)},n.createBackground=function(){var e=this.scene.make.nineslice({key:MM,frame:_M.THREE_SLICES.COIN_PANEL_GRAY,leftWidth:10,rightWidth:10});e.setSizeByWorld(this.width,this.height),this.add(e)},n.createAvatar=function(){var e=this.scene.add.container(0,0),t=this.scene.add.image(0,0,MM,_M.AVATAR_BORDER);t.setScaleByWorld(.4),e.setSize(t.width,t.height),this.avatar=new Dc(this.scene,{width:29,height:29,key:MM,background:"blank"}),this.avatar.background.kill(),this.avatar.loadPhoto(oe.Z.AVATAR.KEY,oe.Z.AVATAR.FILE),e.add([t,this.avatar]),this.add(e),this.avatarContainer=e},n.createIcon=function(){var e=this.scene.add.image(-6,0,MM,_M.IC_CUP);e.setDefaultWorldSize(),this.add([e]),this.cupIcon=e},n.createText=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.NORMAL.KEY,size:this.scene.fontSize(14),text:"0",origin:{x:.5,y:.5}});this.add(e),this.scoreText=e,this.scoreText.setTint(7031916)},n.updateData=function(e){this.scoreText.setText(""+(null!=e?e:"..."))},t}(Phaser.GameObjects.Container),GM=NM,FM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leftBlock=void 0,n.rightBlock=void 0,n.scene=t,n.setSize(375,62),n.createBlocks(),n.createVSText(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createBg=function(){var e=this.width,t=this.height,n=new Mv.Z(this.scene,0,0,e,t,0,16579837);this.add(n)},n.createBlocks=function(){this.leftBlock=new GM(this.scene),this.leftBlock.alignRight(),this.rightBlock=new GM(this.scene),this.rightBlock.alignLeft(),this.leftBlock.setX(-60),this.leftBlock.setY(-3),this.rightBlock.setX(60),this.rightBlock.setY(-3),this.add([this.leftBlock,this.rightBlock])},n.createVSText=function(){var e=new pv(this.scene);e.setColor(11106656),e.setFontSize(24),e.setText("VS"),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-3)},n.alignChildren=function(){this.leftBlock.setX(-60),this.rightBlock.setX(60)},t}(Phaser.GameObjects.Container),ZM=FM,UM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.setSize(375,62),n}return(0,f.Z)(t,e),t.prototype.alignChildren=function(){},t}(Phaser.GameObjects.Container),WM=UM,YM=function(e){function t(t){var n;return(n=e.call(this,t)||this).label=void 0,n.text=void 0,n.createLabel(),n.createText(),n.alignComponents(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createLabel=function(){this.label=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(20),text:"Label",origin:{x:.5,y:.5}}),this.add(this.label)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(20),text:"999",origin:{x:0,y:.5}}),this.add(this.text)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.label,this),Phaser.Display.Align.To.RightCenter(this.text,this.label,7)},t}(Phaser.GameObjects.Container),HM=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Stars"),n.text.setOrigin(1,.5),Phaser.Display.Align.In.RightCenter(n.text,(0,yc.Z)(n),0),Phaser.Display.Align.To.LeftCenter(n.label,n.text,7),n.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){mi.instance.isSingleMode()&&n.label.setX(-35-9*n.text.text.length)})),n}return(0,f.Z)(t,e),t}(YM),zM=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Score"),n}return(0,f.Z)(t,e),t}(YM),KM=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.kill(),n.text.setOrigin(.5,.5),Phaser.Display.Align.In.Center(n.text,(0,yc.Z)(n)),n}return(0,f.Z)(t,e),t.prototype.alignComponents=function(){Phaser.Display.Align.In.Center(this.text,this)},t}(YM),VM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.movesBlock=void 0,n.timeBlock=void 0,n.scoreBlock=void 0,n.scene=t,n.setSize(375,54),n.createContent(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createScore(),this.createTime(),this.createMoves()},n.createMoves=function(){this.movesBlock=new HM(this.scene),this.add(this.movesBlock)},n.createTime=function(){this.timeBlock=new KM(this.scene),this.add(this.timeBlock)},n.createScore=function(){this.scoreBlock=new zM(this.scene),this.add(this.scoreBlock)},n.alignChildren=function(){},t}(Phaser.GameObjects.Container),XM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n._tournamentTitle=void 0,n.scene=t,n.setSize(375,62),n.createContent(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle()},n.createTitle=function(){this._tournamentTitle=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"Tournament",origin:{x:.5,y:.5},y:-15}),this.add(this._tournamentTitle),Phaser.Display.Align.In.BottomCenter(this._tournamentTitle,this)},(0,X.Z)(t,[{key:"tournamentTitle",get:function(){return this._tournamentTitle}}]),t}(Phaser.GameObjects.Container),jM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n._statBlock=void 0,n._titleBlock=void 0,n.scene=t,n.createContent(),n.setSize(375,n._titleBlock.height+n._statBlock.height),n.alignChildren(),n}(0,f.Z)(t,e);var n=t.prototype;return n.createBg=function(){var e=this.width,t=this.height,n=new Mv.Z(this.scene,0,0,e,t,0,16579837);this.add(n)},n.createContent=function(){this.createTitle(),this.createStat()},n.createTitle=function(){this._titleBlock=new XM(this.scene),this.add(this._titleBlock)},n.createStat=function(){this._statBlock=new VM(this.scene),this.add(this._statBlock)},n.alignChildren=function(){Phaser.Display.Align.In.TopCenter(this._titleBlock,this),Phaser.Display.Align.In.BottomCenter(this._statBlock,this,0,-5)},(0,X.Z)(t,[{key:"statBlock",get:function(){return this._statBlock}},{key:"titleBlock",get:function(){return this._titleBlock}}]),t}(Phaser.GameObjects.Container),qM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.singleInfo=void 0,n.challengeInfo=void 0,n.tournamentInfo=void 0,n.scene=t,n.setSize(t.gameZone.width,50),t.add.existing((0,yc.Z)(n)),n.createChallengeInfo(),n.createSingleInfo(),n.createTournamentInfo(),n}(0,f.Z)(t,e);var n=t.prototype;return n.getInfoContainersWithout=function(e){return[this.singleInfo,this.challengeInfo,this.tournamentInfo].filter((function(t){return t!==e}))},n.useChallengeInfo=function(){if(!this.challengeInfo.active){var e=this.getInfoContainersWithout(this.challengeInfo);this.challengeInfo.revive(),this.scene.tweens.add({targets:this.challengeInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){ou(90)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.useSingleInfo=function(){if(!this.singleInfo.active){var e=this.getInfoContainersWithout(this.singleInfo);e.map((function(e){return e.kill()})),this.singleInfo.revive(),this.scene.tweens.add({targets:this.singleInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){ou(70)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.useTournamentInfo=function(){if(!this.tournamentInfo.active){var e=this.getInfoContainersWithout(this.tournamentInfo);this.tournamentInfo.revive(),this.scene.tweens.add({targets:this.tournamentInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){ou(95)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.createChallengeInfo=function(){var e=new ZM(this.scene);this.challengeInfo=e,this.add(e),this.challengeInfo.kill()},n.createSingleInfo=function(){var e=new WM(this.scene);this.singleInfo=e,this.add(e)},n.createTournamentInfo=function(){var e=new jM(this.scene);this.tournamentInfo=e,this.add(e),this.tournamentInfo.kill()},n.update=function(){var e=this.scene.gameplay,t=e.scoreManager,n=e.comboManager,i=t.getTotalScore(),r=t.getStars();n.getCombo().length;switch(mi.instance.getGameMode()){case li.SINGLE:break;case li.CHALLENGE_FRIENDS:this.challengeInfo.leftBlock.scoreText.setText(""+i);break;case li.TOURNAMENT:var a=this.tournamentInfo.statBlock,s=a.movesBlock;a.timeBlock;a.scoreBlock.text.setText(""+i),s.text.setText(""+r)}},n.alignChildren=function(){this.singleInfo.alignChildren(),this.challengeInfo.alignChildren(),this.tournamentInfo.statBlock.alignChildren()},t}(Phaser.GameObjects.Container),JM=qM,QM=68/3,$M=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).scene=void 0,r.levelText=void 0,r.bg=void 0,r.scene=t,r.create(),r.setSize(134/3,QM),r}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=Ki.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.make.nineslice({key:t,frame:n.THREE_SLICES.BAR_LEVEL,leftWidth:32/3,rightWidth:32/3,width:134/3,height:QM}),r=new Qp(this.scene,{text:this.scene.lang.Text.level,fontSize:this.scene.fontSize(8),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),a=this.scene.level.getLevel(),s=new Qp(this.scene,{text:""+a,fontSize:this.scene.fontSize(12),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add([i,r,s]),Phaser.Display.Align.In.Center(r,this,0,-6),Phaser.Display.Align.In.Center(s,this,0,4),this.bg=i,this.levelText=s},n.update=function(e){this.levelText.setText(e.toString());var t=19+7.7*Math.max(e.toString().length,3);this.bg.setSizeByWorld(t,QM),this.setSize(t,QM)},t}(Phaser.GameObjects.Container),e_=$M,t_=Ki.Z.GAMEPLAY_DEFAULT,n_=t_.KEY,i_=t_.FRAME,r_=function(e){function t(t){var n,i;return(i=e.call(this,t,n_,{background:i_.THREE_SLICES.COIN_PANEL_GRAY,icon:i_.IC_HEART,button:i_.IC_PLUS})||this).timeUpdatable=void 0,i.amountHeartsText=void 0,i.value.setTint(7031916),null==(n=i.button)||n.setScaleByWorld(.7),i.icon.setScaleByWorld(1.2),i.setName("LifeBar"),i.setTimeUpdatable(!1),i.createAmountHeartsText(),i.alignObject(),i}(0,f.Z)(t,e);var n=t.prototype;return n.setTimeUpdatable=function(e){this.timeUpdatable=e},n.getIconHeartPos=function(){return this.icon.getWorldPosition()},n.update=function(){if(this.timeUpdatable){var e=this.scene.life.getTimeLeftToReceiveHeart(),t=Math.floor(e/60),n=e%60;this.value.setText(t.toString().padStart(2,"0")+"m:"+n.toString().padStart(2,"0")+"s"),this.alignObject()}},n.updateHearts=function(e){this.amountHeartsText.setText(e.toString()),Phaser.Display.Align.In.Center(this.amountHeartsText,this.icon,-2,1)},n.updateCounter=function(e,t){var n,i;e>=t?(this.setTimeUpdatable(!1),null==(n=this.button)||n.kill(),this.value.setText("Max"),this.bar.setSize(80,25.5)):(this.setTimeUpdatable(!0),null==(i=this.button)||i.revive(),this.bar.setSize(120,25.5));this.alignObject()},n.alignObject=function(){e.prototype.alignObject.call(this),this.value.setY(-1),this.timeUpdatable?(this.value.setX(-this.width/2+this.bar.width/2+2),this.button&&Phaser.Display.Align.In.RightCenter(this.button,this.bar,-3)):this.value.setX(-this.width/2+this.bar.width/2+10)},n.createAmountHeartsText=function(){this.amountHeartsText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),origin:{x:.5,y:.5},text:"0"}),this.add(this.amountHeartsText)},t}(DP),a_=r_,s_=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateHearts=void 0,n.lifeBar=void 0,n.openBuyHeartScreen=function(){n.scene.life.getHearts()>=n.scene.life.getMaxHearts()||n.scene.rewardManager.isDailyRewarding||n.scene.screen.open(de.o4.OUT_OF_HEARTS_SCREEN)},n.setName("LifeBar"),n.scene=t,n.create(),n.setAutoUpdateHearts(!0),n.onClick=n.openBuyHeartScreen,n.button.kill(),n.hitZone.setSize(120,28),n}(0,f.Z)(t,e);var n=t.prototype;return n.setAutoUpdateHearts=function(e){this.autoUpdateHearts=e},n.create=function(){var e=new a_(this.scene);this.add(e),this.lifeBar=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1)},n.update=function(){this.lifeBar.update()},t}(Vc.Z),o_=s_,c_=Ki.Z.DASHBOARD,h_=c_.KEY,u_=c_.FRAME,l_=function(e){function t(t){var n;return(n=e.call(this,t,h_,{background:u_.BAR_VALUE.COIN,icon:u_.ICON.COIN})||this).scene=void 0,n.bounceTween=void 0,n.addIcon=void 0,n.bar.setSizeByWorld(290/3,23),n.scene=t,n.icon.setDefaultWorldSize(),n.value.setTint(16777215),n.value.setFontSize(14),n.setName("ScoreBar"),n.maxValue=1e6,n.align(),n.createAddIcon(),n}(0,f.Z)(t,e);var n=t.prototype;return n.animateAddIcon=function(e,t){this.scene.add.tween({targets:this.addIcon,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.setValue=function(e){var t="";t=e>=1e5?(0,LP.Z)(e):e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),this.value.setText(t)},n.updateBarSize=function(e,t){this.bar.setSizeByWorld(e,t)},n.align=function(){this.alignObject(),this.value.setY(.5),Phaser.Display.Align.In.LeftCenter(this.icon,this.bar,1,0)},n.getIconCoinPosition=function(){var e=this.icon.getWorldPosition();return{x:e.x-2,y:e.y-2.2}},n.getBarSize=function(){var e=this.bar;return{width:e.displayWidth,height:e.displayHeight}},n.getWorldPositionOfCoin=function(){return this.icon.getWorldPosition()},n.getCoinLabelPosition=function(){return this.value.getWorldPosition()},n.runBounceCoinTextAnimation=function(){var e,t;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this.value,scale:"+=0.2",yoyo:!0,repeat:2,ease:Phaser.Math.Easing.Sine.InOut,duration:180}))},n.createAddIcon=function(){var e=this.scene.add.image(0,0,h_,u_.ICON.ADD);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.BottomRight(e,this.icon,2.5,3),this.addIcon=e},t}(DP),d_=l_,p_=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateCoin=void 0,n.coinBar=void 0,n.bounceTween=void 0,n.coinsNumber=void 0,n.barLength=void 0,n.onBuyCoin=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.open(de.o4.GET_COINS_SCREEN,{claimedCoin:vf.instance.reward.rewardedAdOffer});case 1:case"end":return e.stop()}}),e)}))),n.setName("CoinBar"),n.button.kill(),n.scene=t,n.coinsNumber=-1,n.barLength=0,n.autoUpdateCoin=!0,n.create(),n.setValue(0),n.setDisabled(!1),n.onClick=n.onBuyCoin,n}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new d_(this.scene);this.add(e),this.coinBar=e},n.setAutoUpdateCoin=function(e){this.autoUpdateCoin=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1);var n=t?0:1;this.coinBar.animateAddIcon(n,200)},n.updateCoins=function(e){this.runCounter(e)},n.updateHitZoneSize=function(e,t,n){this.hitZone.setSize(e,t);var i=Math.max(0,n-3);this.hitZone.setX(5*i-8)},n.setValue=function(e){var t;if(this.coinsNumber!=e){e<0&&(e=0),this.coinBar.setValue(e),this.coinsNumber=e;var n,i,r=Math.max(this.coinBar.getValueLength(),3),a=37.5+9*r;if(this.barLength!=a&&(this.barLength=a,this.coinBar.updateBarSize(a,25.5)),this.coinBar.align(),this.updateHitZoneSize(a,25.5,r),null!=(t=this.scene.gameUI)&&t.isCoinShowing())null==(n=this.scene.gameUI)||n.alignLevelTitle(),null==(i=this.scene.gameUI)||i.alignStarBarButton()}},n.runCounter=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.coinsNumber,e.abrupt("return",FS(this.scene,{startNumber:n,endNumber:t,onUpdate:function(e){var t=Math.floor(e.getValue());i.setValue(t)}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBounceCoinButtonAnimation=function(){var e,t,n=this;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this,scale:.92,yoyo:!0,duration:50,onComplete:function(){n.scene.tweens.add({targets:n,scale:1,duration:50})}}))},t}(Vc.Z),f_=p_,m_=function(e){this.gameUI=void 0,this.showPlusCardsButtonsPromise=null,this.hidePlusCardsButtonsPromise=null,this.isPlusCardsButtonsShown=!0,this.gameUI=e},g_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t.scene,n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){this.alignCoinBar(),this.alignStarBar(),this.alignLevelTitle(),this.alignStreakBar(),this.alignGameUIFooter(),this.alignWildCard(),this.alignStockAndWaste(),this.alignUndoButton(),this.alignPlusCardsButtons(),this.checkOverlap()},n.alignCoinBar=function(){var e=this.gameUI.coinBarButton;Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-39,-2),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStarBar=function(e){void 0===e&&(e=!0);var t=this.gameUI,n=t.coinBarButton,i=t.starBarButton;this.scene.backupGameObjectSystem.list.delete(i),e&&i.setY(n.y),i.setX(n.x+n.coinBar.getBarSize().width+15),this.scene.backupGameObjectSystem.backupObjectProp(i,i.x,n.y)},n.alignLevelTitle=function(){var e=this.gameUI,t=e.levelTitle,n=e.coinBarButton;this.scene.backupGameObjectSystem.list.delete(t),Phaser.Display.Align.In.Center(t,n,n.coinBar.getBarSize().width-20,0),this.scene.backupGameObjectSystem.backupObject(t)},n.alignStreakBar=function(){var e=this.scene.gameplay.comboManager.streakBar;Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-19,-9),this.scene.backupGameObjectSystem.backupObject(e)},n.alignGameUIFooter=function(){var e=this.gameUI.footer,t=e.settingsMenu,n=e.endGameBtn;Phaser.Display.Align.In.LeftCenter(n,e,-44,1),Phaser.Display.Align.In.BottomCenter(e,this.scene.gameZone,0,-5),this.scene.backupGameObjectSystem.backupObject(t),this.scene.backupGameObjectSystem.backupObject(n)},n.alignWildCard=function(){var e=this.scene.gameplay.coinUsingManager,t=e.wildCardBtn,n=e.wildCardWrapper,i=this.scene.gameZone.width-t.width/2-8,r=this.scene.gameZone.height-n.height/2-6;n.setPosition(i,r),this.scene.backupGameObjectSystem.backupObject(n)},n.alignStockAndWaste=function(){var e=this.scene.gameplay.boardGame,t=e.waste,n=e.stock;t.setPosition(t.x+4,t.y),n.setPosition(n.x+4,n.y)},n.alignUndoButton=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager.undoBtn;t.setPosition(e.x+61,this.scene.gameZone.height-t.height/2-7-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(t)},n.alignPlusCardsButtons=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager,n=t.addCardsBtn,i=t.addCardsByAdsBtn,r=t.addCardsFreeBtn;n.setPosition(e.x-64,this.scene.gameZone.height-n.height/2-6-this.scene.world.getSAB()),r.setPosition(e.x-64,this.scene.gameZone.height-r.height/2-5-this.scene.world.getSAB()),i.setPosition(e.x-158,this.scene.gameZone.height-i.height/2-6-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(r)},n.checkOverlap=function(){var e=this.gameUI.footer.endGameBtn,t=this.scene.gameplay.coinUsingManager,n=t.undoBtn,i=t.addCardsBtn,r=t.addCardsByAdsBtn,a=t.addCardsFreeBtn;this.scene.backupGameObjectSystem.backupObject(e),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(r),this.scene.backupGameObjectSystem.backupObject(a)},n.showEndGame=function(){var e=this.gameUI.footer.endGameBtn;this.gameUI.showElement(e,0)},n.hideEndGame=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.endGameBtn;this.gameUI.hideElement(t,0,200,0,e)},n.showSettingsButton=function(){var e=this.gameUI.footer.settingsMenu;this.gameUI.showElement(e,0)},n.hideSettingsButton=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.settingsMenu;this.gameUI.hideElement(t,-200,100,0,e)},n.showPlusCardsButtons=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.scene.gameplay.coinUsingManager.addCardsBtn,r=[n.x,n.x-78],!this.showPlusCardsButtonsPromise){e.next=4;break}return e.abrupt("return");case 4:if(!this.isPlusCardsButtonsShown){e.next=6;break}return e.abrupt("return");case 6:this.showPlusCardsButtonsPromise=(0,i.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e,t){var n=r[t],i=s.scene.gameZone.height-e.height/2-6-s.scene.world.getSAB();return e.setPosition(n,i),s.scene.backupGameObjectSystem.backupObject(e),s.gameUI.hideElement(e,0,200,0,0),e.revive(),s.gameUI.showElement(e,0)})),s.isPlusCardsButtonsShown=!0,e.next=4,Promise.all(n);case 4:s.showPlusCardsButtonsPromise=null;case 5:case"end":return e.stop()}}),e)})))();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hidePlusCardsButtons=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=200),!this.hidePlusCardsButtonsPromise){e.next=3;break}return e.abrupt("return");case 3:if(this.isPlusCardsButtonsShown){e.next=5;break}return e.abrupt("return");case 5:return n=this.scene.gameplay.coinUsingManager,i=n.addCardsBtn,r=n.addCardsByAdsBtn,s=n.addCardsFreeBtn,this.hidePlusCardsButtonsPromise=Promise.all([this.gameUI.hideElement(i,0,200,0,t),this.gameUI.hideElement(r,0,200,0,t),this.gameUI.hideElement(s,0,200,0,t)]),this.hideEndGame(),this.isPlusCardsButtonsShown=!1,e.next=11,this.hidePlusCardsButtonsPromise;case 11:i.kill(),r.kill(),s.kill(),this.hidePlusCardsButtonsPromise=null;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(m_),v_=g_,y_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t.scene,n}(0,f.Z)(t,e);var n=t.prototype;return n.alignUI=function(){this.alignCoinBar(),this.alignLevelTitle(),this.alignStreakBar(),this.alignGameUIFooter(),this.alignWildCard(),this.alignStockAndWaste(),this.alignUndoButton(),this.alignPlusCardsButtons()},n.alignCoinBar=function(){var e=this.gameUI.coinBarButton;Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-44,-10),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStarBar=function(){var e=this.gameUI.starBarButton;this.scene.backupGameObjectSystem.list.delete(e),Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-35,-2.5),this.scene.backupGameObjectSystem.backupObject(e)},n.alignLevelTitle=function(){var e=this.gameUI.levelTitle,t=this.gameUI.coinBarButton.coinBar.getBarSize().width;this.scene.backupGameObjectSystem.list.delete(e),Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-t-18,-16.5),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStreakBar=function(){var e=this.scene.gameplay.comboManager.streakBar;Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-28,-16),this.scene.backupGameObjectSystem.backupObject(e)},n.alignGameUIFooter=function(){var e=this.gameUI.footer,t=e.settingsMenu,n=e.endGameBtn;Phaser.Display.Align.In.RightCenter(n,e,-10,0),Phaser.Display.Align.In.TopCenter(e,this.scene.gameZone,0,-48),this.scene.backupGameObjectSystem.backupObject(t),this.scene.backupGameObjectSystem.backupObject(n)},n.alignWildCard=function(){var e=this.scene.gameplay.coinUsingManager,t=e.wildCardBtn,n=e.wildCardWrapper,i=this.scene.gameZone.width-t.width/2-8,r=this.scene.gameZone.height-n.height/2-15-this.scene.world.getSAB();n.setPosition(i,r),this.scene.backupGameObjectSystem.backupObject(n)},n.alignStockAndWaste=function(){var e=this.scene.gameplay.boardGame,t=e.waste,n=e.stock;t.setPosition(this.scene.gameZone.width/2-3,t.y-10),n.setPosition(t.x-63,n.y-10)},n.alignUndoButton=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager.undoBtn;t.setPosition(e.x+68,this.scene.gameZone.height-t.height/2-15-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(t)},n.alignPlusCardsButtons=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager,n=t.addCardsBtn,i=t.addCardsByAdsBtn,r=t.addCardsFreeBtn;n.setPosition(e.x-67,this.scene.gameZone.height-n.height/2-15-this.scene.world.getSAB()),r.setPosition(e.x-67,this.scene.gameZone.height-r.height/2-15-this.scene.world.getSAB()),i.setPosition(n.x-80,this.scene.gameZone.height-i.height/2-15-this.scene.world.getSAB());var a=Phaser.Math.Clamp(i.x,45,this.scene.gameZone.width/2);i.setX(a),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(r)},n.showEndGame=function(){var e=this.gameUI.footer.endGameBtn;this.gameUI.showElement(e,0)},n.hideEndGame=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.endGameBtn;this.gameUI.hideElement(t,200,0,0,e)},n.showSettingsButton=function(){var e=this.gameUI.footer.settingsMenu;this.gameUI.showElement(e,0)},n.hideSettingsButton=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.settingsMenu;this.gameUI.hideElement(t,-200,0,0,e)},n.showPlusCardsButtons=function(e){var t=this,n=this.scene.gameplay.coinUsingManager,r=n.addCardsBtn,s=n.addCardsByAdsBtn,o=[r.x,s.x];this.showPlusCardsButtonsPromise||this.isPlusCardsButtonsShown||(this.showPlusCardsButtonsPromise=(0,i.Z)(a().mark((function n(){var i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.map((function(e,n){var i=o[n],r=t.scene.gameZone.height-e.height/2-15-t.scene.world.getSAB();return e.setPosition(i,r),t.scene.backupGameObjectSystem.backupObject(e),t.gameUI.hideElement(e,0,200,0,0),e.revive(),t.gameUI.showElement(e,0)})),t.isPlusCardsButtonsShown=!0,n.next=4,Promise.all(i);case 4:t.showPlusCardsButtonsPromise=null;case 5:case"end":return n.stop()}}),n)})))())},n.hidePlusCardsButtons=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=200),!this.hidePlusCardsButtonsPromise){e.next=3;break}return e.abrupt("return");case 3:if(this.isPlusCardsButtonsShown){e.next=5;break}return e.abrupt("return");case 5:return n=this.scene.gameplay.coinUsingManager,i=n.addCardsBtn,r=n.addCardsByAdsBtn,s=n.addCardsFreeBtn,this.hidePlusCardsButtonsPromise=Promise.all([this.gameUI.hideElement(i,0,200,0,t),this.gameUI.hideElement(r,0,200,0,t),this.gameUI.hideElement(s,0,200,0,t)]),this.hideEndGame(),this.isPlusCardsButtonsShown=!1,e.next=11,this.hidePlusCardsButtonsPromise;case 11:i.kill(),r.kill(),s.kill(),this.hidePlusCardsButtonsPromise=null;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(m_),E_=y_,C_=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateStar=void 0,n.starBar=void 0,n.bounceTween=void 0,n.starsNumber=void 0,n.barLength=void 0,n.onShowStarInformation=function(){n.setDepth(Ha.Z.BUTTON),n.scene.screen.open(de.o4.GET_MORE_STARS_SCREEN)},n.setName("StarBar"),n.button.kill(),n.scene=t,n.starsNumber=-1,n.barLength=0,n.autoUpdateStar=!0,n.create(),n.setDisabled(!1),n.onClick=n.onShowStarInformation,n}(0,f.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new FP(this.scene);this.add(e),this.starBar=e},n.setAutoUpdateStar=function(e){this.autoUpdateStar=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1);var n=t?0:1;this.starBar.animateAddIcon(n,200)},n.updateStars=function(e){this.runCounter(e)},n.updateHitZoneSize=function(e,t,n){this.hitZone.setSize(e,t);var i=Math.max(0,n-3);this.hitZone.setX(5*i-8)},n.setValue=function(e){if(this.starsNumber!=e){this.starBar.setValue(e),this.starsNumber=e;var t=Math.max(this.starBar.getValueLength(),3),n=37.5+9*t;this.barLength!=n&&(this.barLength=n,this.starBar.updateBarSize(n,25.5)),this.starBar.align(),this.updateHitZoneSize(n,25.5,t)}},n.runCounter=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.starsNumber,e.abrupt("return",FS(this.scene,{startNumber:n,endNumber:t,onUpdate:function(e){var t=Math.floor(e.getValue());i.setValue(t)}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBounceStarButtonAnimation=function(){var e,t,n=this;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this,scale:.92,yoyo:!0,duration:50,onComplete:function(){n.scene.tweens.add({targets:n,scale:1,duration:50})}}))},t}(Vc.Z),w_=C_,A_={coinBarBtn:!0,starBarBtn:!0,levelTitle:!0,settingsBtn:!0,undoBtn:!0,wildCardBtn:!0,streakBar:!0,endGameBtn:!0},b_=function(e){function t(t){var n;return(n=e.call(this,t)||this).levelTitle=void 0,n.lifeBarButton=void 0,n.coinBarButton=void 0,n.starBarButton=void 0,n.header=void 0,n.footer=void 0,n.isGameUIHiddenFirstTime=void 0,n.showUIPayload=void 0,n.coinShowing=void 0,n.starShowing=void 0,n.gameUILayout=void 0,n.onCoinChanged=function(){if(n.scene&&n.coinBarButton.autoUpdateCoin){var e=n.scene.player.getCoins();n.coinBarButton.runCounter(e)}},n.onStarChanged=function(){if(n.scene&&n.starBarButton.autoUpdateStar){var e=n.scene.player.getStar();n.starBarButton.setValue(e)}},n.onHeartChanged=function(){if(n.scene){var e=n.scene.life.getHearts(),t=n.scene.life.getMaxHearts();e>=t?n.lifeBarButton.setDisabled(!0):n.lifeBarButton.setDisabled(!1),n.lifeBarButton.autoUpdateHearts&&n.lifeBarButton.lifeBar.updateHearts(e),n.lifeBarButton.lifeBar.updateCounter(e,t)}},n.scene=t,n.isGameUIHiddenFirstTime=!1,n.starShowing=!0,n.showUIPayload=A_,n.create(),n.scene.add.existing((0,yc.Z)(n)),n.listenEvents(),n.gameUILayout=GameCore.layoutInitializer.isLandscape?new v_((0,yc.Z)(n)):new E_((0,yc.Z)(n)),n.alignGameUI(),n}(0,f.Z)(t,e);var n=t.prototype;return n.alignGameUI=function(){this.gameUILayout.alignUI(),this.gameUILayout.hideEndGame(0),this.gameUILayout.hideSettingsButton(0),this.gameUILayout.hidePlusCardsButtons(0)},n.listenEvents=function(){this.updateCoinsToBar(),this.updateStarsToBar(),this.scene.game.events.on(pi.COIN_CHANGED,this.onCoinChanged),this.scene.game.events.on(pi.STAR_CHANGED,this.onStarChanged)},n.runFadeCoinBar=function(e,t){this.scene.add.tween({targets:this.coinBarButton,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.updateCoinsToBar=function(){var e=this.scene.player.getCoins();this.coinBarButton.setValue(e)},n.updateStarsToBar=function(){var e=this.scene.player.getStar();this.starBarButton.setValue(e)},n.setUpShowUIPayload=function(e){this.showUIPayload=(0,p.Z)({},A_,e)},n.setDisableButtons=function(e){this.coinBarButton.setDisabled(e),this.starBarButton.setDisabled(e),this.lifeBarButton.setDisabled(e)},n.updateLevelTitle=function(e){this.levelTitle.update(e)},n.getHideElementAnimationDuration=function(){if(!this.isGameUIHiddenFirstTime)return 0},n.hideUI=function(e){var t=this,n=this.getHideElementAnimationDuration(),i=(0,p.Z)({},A_,e);i.coinBarBtn&&this.hideElement(this.coinBarButton,-50,-20,0,n).then((function(){t.coinShowing=!1})),i.starBarBtn&&this.starShowing&&this.hideElement(this.starBarButton,0,-50,0,n).then((function(){t.starShowing=!1})),i.levelTitle&&this.hideElement(this.levelTitle,0,-40,0,n),i.settingsBtn&&(this.footer.closeSettings(0),this.gameUILayout.hideSettingsButton(n)),i.undoBtn&&this.hideElement(this.scene.gameplay.coinUsingManager.undoBtn,0,40,0,n),i.wildCardBtn&&this.hideElement(this.scene.gameplay.coinUsingManager.wildCardWrapper,0,40,0,n),i.endGameBtn&&this.gameUILayout.hideEndGame(n),i.streakBar&&this.hideElement(this.scene.gameplay.comboManager.streakBar,60,-20,0,n),this.isGameUIHiddenFirstTime||(this.isGameUIHiddenFirstTime=!0)},n.showUI=function(e){var t=this,n=(0,p.Z)({},A_,this.showUIPayload);n.coinBarBtn&&this.showElement(this.coinBarButton,0).then((function(){t.coinShowing=!0,t.alignLevelTitle(),t.alignStarBarButton()})),n.levelTitle&&this.showElement(this.levelTitle,0),n.streakBar&&this.showElement(this.scene.gameplay.comboManager.streakBar,0),n.settingsBtn&&(this.footer.closeSettings(0),this.showElement(this.footer.settingsMenu,200)),n.undoBtn&&this.showElement(this.scene.gameplay.coinUsingManager.undoBtn,200),n.wildCardBtn&&this.showElement(this.scene.gameplay.coinUsingManager.wildCardWrapper,200)},n.showCoin=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showElement(this.coinBarButton,0).then((function(){t.coinShowing=!0}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.isCoinShowing=function(){return this.coinShowing},n.hideCoin=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hideElement(this.coinBarButton,-50,-20,0).then((function(){t.coinShowing=!1}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showStar=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showElement(this.starBarButton,0).then((function(){t.starShowing=!0}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.isStarShowing=function(){return this.starShowing},n.hideStar=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.starBarButton.starBar.getBarSize(),n=t.width,i=this.starBarButton.starBar.width,r=(n-i)/2+8,e.next=5,this.hideElement(this.starBarButton,r,-50,0).then((function(){s.starShowing=!1}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLife=function(){this.showElement(this.lifeBarButton,0)},n.hideLife=function(){this.hideElement(this.lifeBarButton,-50,-20,0)},n.showSettings=function(){this.showElement(this.footer.settingsMenu,0)},n.showSingleModeComponents=function(){this.showElement(this.levelTitle,0)},n.hideSingleModeComponents=function(){this.hideElement(this.levelTitle,0,-40,0)},n.showEndGame=function(){this.gameUILayout.showEndGame()},n.hideEndGame=function(e){void 0===e&&(e=200),this.gameUILayout.hideEndGame(e)},n.hideElement=function(){var e=(0,i.Z)(a().mark((function e(t,n,i,r,s){var o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===s&&(s=250),o=this.scene.backupGameObjectSystem.getObjectSaved(t)||t,c=o.x,h=o.y,0!=s){e.next=6;break}return t.setPosition(c+n,h+i),t.setAlpha(0),e.abrupt("return");case 6:return this.scene.tweens.killTweensOf(t),e.next=9,this.scene.add.tween({targets:t,x:c+n,y:h+i,alpha:0,scale:.5,duration:s,delay:r,ease:Phaser.Math.Easing.Back.In}).waitForCompletion();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i,r,a){return e.apply(this,arguments)}}(),n.showElement=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.backupGameObjectSystem.getObjectSaved(t)||t,r=i.x,s=i.y,this.scene.tweens.killTweensOf(t),e.next=4,this.scene.add.tween({targets:t,x:r,y:s,alpha:1,scale:1,duration:250,delay:n,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createHeader(),this.createFooter(),this.createCoinBar(),this.createStarBar(),this.createLevelTitle(),this.createLifeBar()},n.createHeader=function(){this.header=new JM(this.scene),Phaser.Display.Align.In.TopCenter(this.header,this.scene.gameZone,0),this.header.alignChildren()},n.createFooter=function(){this.footer=new DM(this.scene),this.footer.setDepth(Ha.Z.POPUP)},n.createCoinBar=function(){var e=new f_(this.scene);this.scene.add.existing(e),this.coinBarButton=e},n.createStarBar=function(){var e,t=new w_(this.scene);this.scene.add.existing(t),this.starBarButton=t,null==(e=this.scene.gameUI)||e.alignStarBarButton()},n.createLifeBar=function(){this.lifeBarButton=new o_(this.scene),this.lifeBarButton.kill(),this.scene.add.existing(this.lifeBarButton),Phaser.Display.Align.In.TopLeft(this.lifeBarButton,this.scene.gameZone,-71,-38),this.scene.backupGameObjectSystem.backupObject(this.lifeBarButton)},n.createLevelTitle=function(){this.levelTitle=new e_(this.scene),this.levelTitle.setDepth(Ha.Z.BUTTON),this.scene.add.existing(this.levelTitle)},n.alignLevelTitle=function(){var e;null==(e=this.gameUILayout)||e.alignLevelTitle()},n.alignStarBarButton=function(){var e;null==(e=this.gameUILayout)||e.alignStarBar(this.isStarShowing())},n.update=function(){this.lifeBarButton.update()},t}(Phaser.GameObjects.Layer),S_=b_,T_=["paris","new-york","venice"],x_={WINDMILL_SPINE:"WINDMILL_SPINE",CARD_SLICE_SPINE:"CARD_SLICE_SPINE",MAP_SPINE:"MAP_SPINE",CODE_BREAK_SPINE:"CODE_BREAK_SPINE",CARD_LOCK_SPINE:"CARD_LOCK_SPINE",CARD_SLICE_FX_SPINE:"CARD_SLICE_FX_SPINE",CIRCLE_VFX_SPINE:"CIRCLE_VFX_SPINE",CHANGE_VFX_SPINE:"CHANGE_VFX_SPINE"},k_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).gameplay=void 0,t.devToolManager=void 0,t.rewardManager=void 0,t.bgAnimManager=void 0,t.solver=void 0,t.gameUI=void 0,t.locationManager=void 0,t.gameStats=void 0,t.gameModeManager=void 0,t.backupGameObjectSystem=void 0,t.gameplayLayer=void 0,t.gameSettings=void 0,t.journeyDataService=void 0,t.logGameplay=void 0,t.logEconomy=void 0,t.fpsManager=void 0,t.create=(0,i.Z)(a().mark((function n(){var i,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.prototype.create.call((0,yc.Z)(t)),i=t.player.getLevel(),r=i<=3,t.setBackground({useGameplayBackground:r}),t.fpsManager=new Fy((0,yc.Z)(t)),t.fpsManager.start(),t.lazyLoadResource(),t.journeyDataService=new Ux((0,yc.Z)(t)),t.gameSettings=vf.instance,t.gameplayLayer=t.add.layer(),t.gameplayLayer.setDepth(Ha.Z.GAMEPLAY),t.gameModeManager=new gC((0,yc.Z)(t)),t.gameplay=new Vg((0,yc.Z)(t)),t.solver=new pC((0,yc.Z)(t)),t.gameUI=new S_((0,yc.Z)(t)),t.locationManager=new vO((0,yc.Z)(t)),Phaser.Display.Align.In.Center(t.locationManager,t.gameZone,0,0),t.rewardManager=new pE((0,yc.Z)(t)),t.bgAnimManager=new By((0,yc.Z)(t)),t.devToolManager=new Ny((0,yc.Z)(t),t.gameplay.boardGame),t.logGameplay=new tw((0,yc.Z)(t)),t.logEconomy=new $C((0,yc.Z)(t)),GameCore.Utils.Valid.isDebugger()&&t.devToolManager.start(),t.createScreens(),t.ads.preloadInterstitialAdAsync().catch((function(e){})),t.ads.preloadRewardedVideoAsync().catch((function(e){})),t.gameUI.hideUI(),t.checkNewUser(),t.world.getBannerHeight()>0&&t.ads.showBannerAdAsync().catch((function(e){}));case 30:case"end":return n.stop()}}),n)}))),t.run=function(){t.processStartGame();var e=[{selector:$r,callback:function(){t.events.emit(pi.MAP_PLAYERS_CHANGED)}}];t.handleStateChange(e)},t.handleShowInterstitialAd=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ads.canbeShowInterstitialAd()){e.next=15;break}return t.ads.setAdInProcess(!0),t.audio.muteAll(),t.audio.pauseAllSounds(),t.audio.pauseAllMusics(),e.prev=5,e.next=8,t.ads.showInterstitialAdAsync();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:t.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(t.audio.unmuteAll(),t.audio.resumeAllSounds(),t.resumeMusic()),t.ads.preloadInterstitialAdAsync().catch((function(e){}));case 15:case"end":return e.stop()}}),e,null,[[5,10]])}))),t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){this.backupGameObjectSystem=new ZC(this),this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.lazyLoadResource=function(){var e=this;this.loadSounds(),(0,me.qZ)(500).then((function(){e.loadTexture32Bit(Ki.Z.DEFAULT.KEY,Ki.Z.DEFAULT.TEXTURE_32BIT),e.loadTexture32Bit(Ki.Z.GAMEPLAY_DEFAULT.KEY,Ki.Z.GAMEPLAY_DEFAULT.TEXTURE_32BIT),e.loadTexture32Bit(Ki.Z.GAMEPLAY_OBJECTS.KEY,Ki.Z.GAMEPLAY_OBJECTS.TEXTURE_32BIT),e.requireSpineAsync("CHANGE_VFX_SPINE")})),this.requireSpineAsync("CARD_SLICE_FX_SPINE"),this.requireSpineAsync("CARD_SLICE_SPINE"),this.requireSpineAsync("WINDMILL_SPINE"),this.load.start()},n.loadTexture32Bit=function(e,t){var n=this,i=GameCore.Utils.String.generateObjectId();this.load.image(i,t),this.load.start(),this.load.on("filecomplete-image-"+i,(function(t){var i=n.textures.get(t),r=n.textures.get(e);r.source[0].glTexture=i.source[0].glTexture,r.source[0].glIndex=i.source[0].glIndex,r.source[0].glIndexCounter=i.source[0].glIndexCounter}))},n.loadSounds=function(){this.loadSoundEffects(),this.loadBackgroundMusic(),this.loadGameplayMusic()},n.loadSoundEffects=function(){this.load.audioSprite(Hc.Z.UI.KEY,Hc.Z.UI.JSON,Hc.Z.UI.FILE),this.load.audioSprite(Hc.Z.BOOSTERS.KEY,Hc.Z.BOOSTERS.JSON,Hc.Z.BOOSTERS.FILE),this.load.audioSprite(Hc.Z.CARD.KEY,Hc.Z.CARD.JSON,Hc.Z.CARD.FILE),this.load.audioSprite(Hc.Z.CARD_COMBO.KEY,Hc.Z.CARD_COMBO.JSON,Hc.Z.CARD_COMBO.FILE),this.load.audioSprite(Hc.Z.CARD_ROTATE.KEY,Hc.Z.CARD_ROTATE.JSON,Hc.Z.CARD_ROTATE.FILE),this.load.audioSprite(Hc.Z.GAMEPLAY.KEY,Hc.Z.GAMEPLAY.JSON,Hc.Z.GAMEPLAY.FILE),this.load.audioSprite(Hc.Z.CONGRATS_SOUND.KEY,Hc.Z.CONGRATS_SOUND.JSON,Hc.Z.CONGRATS_SOUND.FILE)},n.loadBackgroundMusic=function(){var e=this,t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Hc.Z.BACKGROUND.KEY,(function(){e.audio.getMusicKey()===Hc.Z.BACKGROUND.KEY&&e.turnOnBackgroundMusic()})),this.load.audio(Hc.Z.BACKGROUND.KEY,Hc.Z.BACKGROUND.FILE)},n.loadGameplayMusic=function(){var e=this,t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Hc.Z.GAMEPLAY_BACKGROUND.KEY,(function(){e.audio.getMusicKey()===Hc.Z.GAMEPLAY_BACKGROUND.KEY&&e.turnOnGameplayMusic()})),this.load.audio(Hc.Z.GAMEPLAY_BACKGROUND.KEY,Hc.Z.GAMEPLAY_BACKGROUND.FILE)},n.setBackground=function(e){var t=(void 0===e?{}:e).useGameplayBackground;if(void 0!==t&&t){var n=this.journey.getCurrentStage(),i=n.gameplayBackgroundKey,r=n.gameplayBackgroundFile;this.themeHandler.setBackground(i,r)}else{var a=this.journey.getCurrentStage(),s=a.backgroundKey,o=a.backgroundFile;this.themeHandler.setBackground(s,o)}},n.setBackgroundWithFadeAnimation=function(e){var t=(void 0===e?{}:e).useGameplayBackground;if(void 0!==t&&t){var n=this.journey.getCurrentStage(),i=n.gameplayBackgroundKey,r=n.gameplayBackgroundFile;return this.themeHandler.setBackgroundWithAnimation(i,r)}var a=this.journey.getCurrentStage(),s=a.backgroundKey,o=a.backgroundFile;return this.themeHandler.setBackgroundWithAnimation(s,o)},n.preloadBackgroundAsync=function(e){var t=(void 0===e?{}:e).useGameplayBackground,n=void 0!==t&&t,i=this.journey.getCurrentStage();return n?this.themeHandler.preloadBackgroundAsync(i.gameplayBackgroundKey,i.gameplayBackgroundFile):this.themeHandler.preloadBackgroundAsync(i.backgroundKey,i.backgroundFile)},n.preloadNextBackgroundAsync=function(e){var t=(void 0===e?{}:e).useGameplayBackground,n=void 0!==t&&t,i=this.journey.getNextStage();return i?n?this.themeHandler.preloadBackgroundAsync(i.gameplayBackgroundKey,i.gameplayBackgroundFile):this.themeHandler.preloadBackgroundAsync(i.backgroundKey,i.backgroundFile):Promise.resolve()},n.createScreens=function(){var e=window.game.renderer;e.resize(e.width,e.height),this.screen.add(de.o4.NO_MORE_MOVES_SCREEN,Ry),this.screen.add(de.o4.SETTINGS_SCREEN,xv),this.screen.add(de.o4.DASHBOARD_SETTINGS_SCREEN,xw),this.screen.add(de.o4.NOTIFICATION_SCREEN,Fv),this.screen.add(de.o4.PLAY_SCREEN,_S),this.screen.add(de.o4.BUYING_BOOSTER_SCREEN,fw),this.screen.add(de.o4.GET_COINS_SCREEN,qw),this.screen.add(de.o4.GET_MORE_STARS_SCREEN,TO),this.screen.add(de.o4.OUT_OF_HEARTS_SCREEN,AA),this.screen.add(de.o4.GUIDE_SCREEN,Qw),this.screen.add(de.o4.NOTIFY_BOMB_SCREEN,cA),this.screen.add(de.o4.DASHBOARD_SCREEN,cI),this.screen.add(de.o4.EXIT_GAME_SCREEN,Ww),this.screen.add(de.o4.LEVEL_COMPLETE_SCREEN,sB),this.screen.add(de.o4.NEXT_JOURNEY_SCREEN,lB),this.screen.preAdd(de.o4.JOURNEY_SCREEN,YR),this.screen.preAdd(de.o4.WELCOME_BACK_SCREEN,JS),this.screen.preAdd(de.o4.WEEKLY_TOURNAMENT.INTRO_SCREEN,LL),this.screen.preAdd(de.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN,vT),this.screen.preAdd(de.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,CM),this.screen.preAdd(de.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN,bL),this.screen.preAdd(de.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN,PM),this.screen.preAdd(de.o4.BOXING_DUEL.INTRO_SCREEN,BT),this.screen.preAdd(de.o4.BOXING_DUEL.MAIN_SCREEN,mx),this.screen.preAdd(de.o4.BOXING_DUEL.VERSUS_SCREEN,Zx),this.screen.preAdd(de.o4.BOXING_DUEL.REWARD_SCREEN,Rx),this.screen.preAdd(de.o4.OFFSHORE_RACE.INTRO_SCREEN,AB),this.screen.preAdd(de.o4.OFFSHORE_RACE.INVITATION_SCREEN,_B),this.screen.preAdd(de.o4.OFFSHORE_RACE.MAIN_SCREEN,QD),this.screen.preAdd(de.o4.OFFSHORE_RACE.REWARD_SCREEN,mL),this.createDailyRewardsScreen(),this.leaderboard.refreshFriendsLeaderboard()},n.openOffshoreRaceMainScreen=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTextureAsync("RACE");case 2:this.screen.open(de.o4.OFFSHORE_RACE.MAIN_SCREEN,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.openOffshoreRaceInvitationScreen=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTextureAsync("RACE");case 2:this.screen.open(de.o4.OFFSHORE_RACE.INVITATION_SCREEN);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openOffshoreRaceRewardScreen=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTexturesAsync(["RACE","OFFSHORE_RACE_CHESTS"]);case 2:this.screen.open(de.o4.OFFSHORE_RACE.REWARD_SCREEN,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requireTextureAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n,i){var r,s,o,c,h,u,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),void 0===i&&(i="Loading..."),Ki.Z[t]){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(r=Ki.Z[t],s=r.KEY,o=r.TEXTURE,c=r.JSON,!this.textures.exists(s)){e.next=7;break}return e.abrupt("return",Promise.resolve());case 7:return this.load.atlas({key:s,textureURL:o,atlasURL:c}),h=(0,me.qZ)(1e3),n&&window.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:i,loading:!0,animationFadeOut:!0}),u=new Promise((function(e){var t=Date.now();l.game.analytics.event(ae._.LOAD_ASSET_START,{key:s}),l.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+s,(function(){var n=Date.now()-t;l.game.analytics.event(ae._.LOAD_ASSET_COMPLETED,{key:s,duration:n}),e(0)})),l.load.start()})),e.next=13,Promise.all([h,u]);case 13:return n&&window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN),e.abrupt("return",Promise.resolve());case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.requireTexturesAsync=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),0!==(i=t.filter((function(e){return Ki.Z[e]&&!o.textures.exists(Ki.Z[e].KEY)}))).length){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return r=i.map((function(e){var t=Ki.Z[e],n=t.KEY,i=t.TEXTURE,r=t.JSON;return o.load.atlas({key:n,textureURL:i,atlasURL:r}),new Promise((function(e){var t=Date.now();o.game.analytics.event(ae._.LOAD_ASSET_START,{key:n}),o.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+n,(function(){var i=Date.now()-t;o.game.analytics.event(ae._.LOAD_ASSET_COMPLETED,{key:n,duration:i}),e(0)})),o.load.start()}))})),s=(0,me.qZ)(1e3),n&&window.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:this.lang.Text.loading,loading:!0,animationFadeOut:!0}),e.next=9,Promise.all([s].concat(r));case 9:return n&&window.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN),e.abrupt("return",Promise.resolve());case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.requireSpineAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x_[t]){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=Ki.Z[t],i=n.DATA_KEY,r=n.ATLAS_KEY,s=n.atlasPATH,o=n.skelPATH,c=new Promise((function(e){if(u.cache.binary.exists(i))return e(0);u.load.spineBinary(i,o);u.load.on(Phaser.Loader.Events.FILE_COMPLETE,(function t(n){n.includes(i)&&(e(0),u.load.off(Phaser.Loader.Events.FILE_COMPLETE,t))}))})),h=new Promise((function(e){if(Object.keys(u.textures.list).some((function(e){return e.includes(r)})))return e(0);u.load.spineAtlas(r,s);u.load.on(Phaser.Loader.Events.FILE_COMPLETE,(function t(n){n.includes(r)&&(e(0),u.load.off(Phaser.Loader.Events.FILE_COMPLETE,t))}))})),this.load.start(),e.abrupt("return",Promise.all([c,h]).then((function(){return Promise.resolve()})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requireDecorationTextureAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T_.includes(t)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(n=this.getCurrentLocationSpriteKey(),i=GameCore.ImageScale,r=n.toLowerCase(),s="./assets/textures/"+i+"x/"+n.toLowerCase()+".png",o="./assets/textures/"+i+"x/"+n.toLowerCase()+".json",!this.textures.exists(r)){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return this.load.atlas({key:r,textureURL:s,atlasURL:o}),c=new Promise((function(e){var t=Date.now();h.game.analytics.event(ae._.LOAD_ASSET_START,{key:r}),h.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+r,(function(){var n=Date.now()-t;h.game.analytics.event(ae._.LOAD_ASSET_COMPLETED,{key:r,duration:n}),e(0)})),h.load.start()})),e.abrupt("return",Promise.all([c]).then((function(){return Promise.resolve()})));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getCurrentLocationSpriteKey=function(){var e=this.player.getJourneyProgress().currentLocationIndex;return T_[e]},n.processStartGame=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.level.getLevel()<=3)){e.next=3;break}return this.gameplay.start(),e.abrupt("return");case 3:t=this.canShowWelcomeBackScreen(),this.screen.open(de.o4.DASHBOARD_SCREEN,{canShowWelcomeBackScreen:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkNewUser=function(){if(this.player.getPlayerIsNew()||GameCore.Configs.Tutorial.ForceUseTutorial){if(this.player.getCoins()>=1e3)return;this.player.setCoins(this.player.getCoins()+1e3),this.logEconomy.logGetItem(yl.COIN,1e3,Cl.REWARD_NEW_USER)}},n.canShowWelcomeBackScreen=function(){var e=this.player.getLastWelcomeBackRewardTime();return!(0,me.Gm)(e)},n.joinTournament=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:"Joining tournament...",loading:!0,animationFadeOut:!0}),e.next=3,this.weeklyTournament.join(t,n);case 3:if(i=e.sent,this.game.globalScene.screen.close(de.o4.NOTIFY_SCREEN),"error"!=i){e.next=8;break}return e.next=8,this.screen.openAsync(de.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.showTournamentShareDialog=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),this.weeklyTournament.isPlayingTournament()){e.next=3;break}return e.abrupt("return");case 3:return n=this.weeklyTournament.getScore(),e.next=6,this.storage.dispatch(bt(n,t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,p=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Configs.Network,i=this.game.globalScene,r=i.screen,s=i.audio,o=i.time,c=i.ads,h=!1,c.setAdInProcess(!0),s.pauseAllSounds(),s.pauseAllMusics(),s.muteAll(),r.open(de.o4.NOTIFY_SCREEN,{message:this.lang.Text.loadingAds,duration:0,loading:!0}),e.prev=9,e.next=12,new Promise((function(e,t){u=o.delayedCall(n.Timeout,t),p.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?p.events.once(GameCore.Ads.Events.LOADED,e):p.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 12:return l=setTimeout((function(){r.open(de.o4.NOTIFY_SCREEN,{message:p.lang.Text.loading,duration:0,loading:!0})}),3e3),e.next=15,this.ads.showRewardedVideoAsync();case 15:r.close(de.o4.NOTIFY_SCREEN),h=!0,e.next=25;break;case 19:e.prev=19,e.t0=e.catch(9),r.close(de.o4.NOTIFY_SCREEN),d=this.lang.Text.noAds,e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"USER_INPUT"===e.t0.code&&(d=this.lang.Text.noRewards),r.open(de.o4.NOTIFY_SCREEN,{message:d,duration:1500,loading:!1,animationFadeOut:!0});case 25:return null==(t=u)||t.remove(),l&&clearTimeout(l),c.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(s.unmuteAll(),s.resumeAllSounds(),s.resumeMusic()),s.resumeMusic(),this.ads.preloadRewardedVideoAsync().catch((function(e){})),e.abrupt("return",h);case 32:case"end":return e.stop()}}),e,this,[[9,19]])})));return function(){return e.apply(this,arguments)}}(),n.emitChallengeFriendsTaskEvent=function(){$h.emit(jh.CHALLENGE_FRIENDS.EVENTS.CHALLENGE_FRIENDS,{type:"times",value:1})},n.createDailyRewardsScreen=function(){var e=this,t=this.screen.add(de.o4.DAILY_REWARDS_SCREEN,GC);t.onNoAd=function(){e.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:e.lang.Text.noAds,duration:1200,loading:!1,animationFadeOut:!0})},t.onSkipAd=function(){e.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:e.lang.Text.noRewards,duration:1500,loading:!1,animationFadeOut:!0})}},n.skipBackgroundChangingAnimation=function(){this.bgAnimManager.skipAnimation()},n.handleBackgroundChange=function(e){this.bgAnimManager.playAnimation(e)},n.turnOnBackgroundMusic=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.turnOffMusic(Hc.Z.GAMEPLAY_BACKGROUND.KEY);case 2:if(!this.audio.isMusicPlaying(Hc.Z.BACKGROUND.KEY)){e.next=4;break}return e.abrupt("return");case 4:if(this.audio.stopMusic(),this.audio.setMusicVolume(0),this.audio.setMusicKey(Hc.Z.BACKGROUND.KEY),this.audio.playMusic(Hc.Z.BACKGROUND.KEY),this.audio.isMusicPlaying(Hc.Z.BACKGROUND.KEY)){e.next=10;break}return e.abrupt("return");case 10:this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.6,duration:1500,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.turnOffMusic=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.audio.isMusicPlaying(t)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=this.tweens.addCounter({from:this.audio.getMusicVolume(),to:0,duration:1200,onUpdate:function(e){i.audio.setMusicVolume(e.getValue())},onComplete:function(){i.audio.stopMusic()}}).waitForCompletion(),e.next=5,n;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.turnOnGameplayMusic=function(){var e=(0,i.Z)(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.turnOffMusic(Hc.Z.BACKGROUND.KEY);case 2:if(!this.audio.isMusicPlaying(Hc.Z.GAMEPLAY_BACKGROUND.KEY)){e.next=4;break}return e.abrupt("return");case 4:if(this.audio.stopMusic(),this.audio.setMusicVolume(0),this.audio.setMusicKey(Hc.Z.GAMEPLAY_BACKGROUND.KEY),this.audio.playMusic(Hc.Z.GAMEPLAY_BACKGROUND.KEY),this.audio.isMusicPlaying(Hc.Z.GAMEPLAY_BACKGROUND.KEY)){e.next=10;break}return e.abrupt("return");case 10:this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.2,duration:2e3,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resumeMusicWithTransition=function(e){var t=this;this.resumeMusic(),this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.6,duration:e,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}})},n.pauseMusicWithTransition=function(e){var t=this;this.tweens.addCounter({from:this.audio.getMusicVolume(),to:0,duration:e,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())},onComplete:function(){t.audio.pauseMusic()}})},n.resumeMusic=function(){if(this.audio.isMusicEnabled()){this.audio.resumeMusic();var e=this.audio.getMusicKey();this.audio.isMusicPlaying(e)||(e===Hc.Z.BACKGROUND.KEY?this.turnOnBackgroundMusic():e===Hc.Z.GAMEPLAY_BACKGROUND.KEY?this.turnOnGameplayMusic():this.audio.playMusic(e))}},n.update=function(e,t){this.gameplay.update(t),this.gameUI.update()},n.sendTestDailyNotification=function(e){Bv.sendTestDailyNotification(e)},t}(ec.Z),P_=k_,I_=n(15),O_=Ki.Z.DEFAULT,R_=O_.KEY,B_=O_.FRAME,D_=function(e){function t(t){var n;return(n=e.call(this,t,R_,B_.BUTTON_YELLOW_CIRCLE)||this).scene=void 0,n.scene=t,n.button.setSize(87,68).setDisplaySize(87,68),n.setName("Home"),n.createIcon(),n}return(0,f.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.add.image(0,0,R_,B_.ICON_FLAT_HOME);e.setSize(43,43).setDisplaySize(43,43),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(Vc.Z),L_=D_,M_=Ki.Z.DEFAULT,__=M_.KEY,N_=M_.FRAME,G_=function(e){function t(t){var n;return(n=e.call(this,t,__,N_.BUTTON_GREEN)||this).scene=void 0,n.scene=t,n.button.setWorldSize(170,72),n.setName("PlayWithFriends"),n.createLabel(),n}return(0,f.Z)(t,e),t.prototype.createLabel=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:13,text:"PLAY"}),t=10;Phaser.Display.Align.In.Center(e,this,0,-t);var n=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:9,text:"WITH FRIENDS"});t=12,Phaser.Display.Align.In.Center(n,this,0,t),this.add([e,n])},t}(Vc.Z),F_=G_,Z_=Ki.Z.DEFAULT,U_=Z_.KEY,W_=Z_.FRAME,Y_=function(e){function t(t){var n;return(n=e.call(this,t,U_,W_.BUTTON_YELLOW_CIRCLE)||this).scene=void 0,n.scene=t,n.button.setSize(87,68).setDisplaySize(87,68),n.setName("Share"),n.createIcon(),n}return(0,f.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.add.image(0,0,U_,W_.ICON_FLAT_SHARE);e.setSize(43,43).setDisplaySize(43,43),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(Vc.Z),H_=Y_,z_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.homeButton=void 0,n.playButton=void 0,n.shareButton=void 0,n.scene=t,n.setName("FooterBar"),n.createButtons(),n.alignButtons(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.alignButtons=function(){Phaser.Display.Align.In.Center(this.homeButton,this,-140),Phaser.Display.Align.In.Center(this.playButton,this,0),Phaser.Display.Align.In.Center(this.shareButton,this,140)},n.createButtons=function(){this.createHomeButton(),this.createPlayButton(),this.createShareButton()},n.createHomeButton=function(){this.homeButton=new L_(this.scene),this.add(this.homeButton)},n.createPlayButton=function(){this.playButton=new F_(this.scene),this.add(this.playButton)},n.createShareButton=function(){this.shareButton=new H_(this.scene),this.add(this.shareButton)},t}(Phaser.GameObjects.Container),K_=z_,V_=n(87),X_=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,f.Z)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,f.Z)(t,e);var n=t.prototype;return n.setMaxValue=function(e){this.maxValue=e},n.setMinValue=function(e){this.minValue=e},n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.setSize=function(t,n){var i,r=n-this.height;return e.prototype.setSize.call(this,t,n),null==(i=this.input)||i.hitArea.setSize(t,n),this.listConfigs&&this.listObjects&&(this.updateMaxHeight(),this.getChildren().forEach((function(e){return e.y-=r/2})),this.value+=r/2,this.onTouchEnd()),this},n.getChildren=function(){return this.listObjects.filter((function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){this.reset(),this.listConfigs=e,this.listObjects=new Array(e.length).fill(void 0),this.addObjectIndex(0,0);var t=this.getEndObjectIndex();this.addObjectIndex(1,t),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var e=this;this.listObjects instanceof Array&&this.listObjects.map((function(t){void 0!==t&&e.objects.killAndHide(t)}))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(e){this.objects.incY(e);var t=this.getStartObjectIndex(),n=this.getEndObjectIndex();t!=this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,r=this.listConfigs;if(n>=r.length)return;if(!this.listObjects[n]){var a=this.objects.getFirstDead(!0),s=a.height,o=s/2+(s+i)*n+this.value-this.height/2;a.setPosition(0,o),this.isObjectOutOfScroller(a)?(a.setVisible(!1),a.setActive(!1)):(a.updateInfo(r[n]),a.setActive(!0),a.setVisible(!0),this.addAt(a),this.listObjects[n]=a)}}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},n.addBackground=function(){var e="scroller-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var r=this.scene.add.image(0,0,e);this.add(r)},(0,X.Z)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxHeight=0:e[0].height}}]),t}(ML.Z)),j_={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},q_=function(e){function t(t){return e.call(this,j_,t)||this}return(0,f.Z)(t,e),t}(dh.Z),J_={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},Q_=function(e){function t(t){return e.call(this,J_,t)||this}return(0,f.Z)(t,e),t}(dh.Z),$_=Ki.Z.DEFAULT,eN=$_.KEY,tN=$_.FRAME,nN=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).button=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var e=i.payload.playerId;i.scene.storage.dispatch(wi(e))},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createUsername(),i.createScore(),i.createButton(),n&&i.updateInfo(n),i.scene.add.existing((0,yc.Z)(i)),i}(0,f.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,p.Z)({scoreRight:!0,isHighlight:!1,useChallenge:!1},e),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore(),this.updatePosition()},n.updatePosition=function(){var e=this.payload.scoreRight,t=this.payload.useChallenge;this.button.setVisible(!!t),e?Phaser.Display.Align.To.RightCenter(this.score,this.avatar,120):Phaser.Display.Align.To.RightCenter(this.score,this.avatar,80)},n.createBackground=function(){this.background=this.scene.make.image({key:eN,frame:tN.LEADERBOARD_BG_LIGHT}),this.background.setWorldSize(264,56),this.add(this.background)},n.updateBackground=function(){var e="";e=this.payload.isHighlight?tN.LEADERBOARD_BG_LIGHT:tN.LEADERBOARD_BG_DARK,this.background.setFrame(e),this.background.setWorldSize(264,56)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.createAvatar=function(){this.avatar=new Dc(this.scene,{key:eN,frame:tN.AVATAR_FRAME_YELLOW_SMALL,background:tN.AVATAR_BG_YELLOW_SMALL,width:47.5,height:49.5,radius:40}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-10)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var e=this.payload.rank;this.updateRankIcon(e),this.updateRankText(e)},n.getRankIconFrame=function(e){var t=tN.ICON_FLAG;switch(e){case 1:t=tN.ICON_CUP_GOLD;break;case 2:t=tN.ICON_CUP_SILVER;break;case 3:t=tN.ICON_CUP_COPPER}return t},n.createRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon=this.scene.make.image({key:eN,frame:t}),t!=tN.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),this.add(this.rankIcon);var n=e<=3?13:16;Phaser.Display.Align.In.Center(this.rankIcon,this.avatar,0,n)},n.updateRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon.setFrame(t),t!=tN.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27)},n.createRankText=function(e){this.rankText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),text:""+e,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,-2)},n.updateRankText=function(e){this.rankText.setText(""+e)},n.getShortName=function(e){var t=e.substring(0,7);return t.split(" ")[0]||t},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("FRIEND NAME"),style:{fontFamily:(0,Rc.BN)(),fontSize:"15px",fontStyle:"bold"}}),this.username.setTint(10317116),this.username.setHighQuality(),Phaser.Display.Align.In.LeftCenter(this.username,this.avatar,-53),this.add(this.username)},n.updateUsername=function(){var e=this.payload.name;this.username.setText(this.getShortName(e))},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"132500",origin:{x:.5,y:.5}}),this.scoreText.setTint(6565e3);var e=this.scene.make.image({key:eN,frame:tN.ICON_CUP_MINI});e.setWorldSize(17,18),this.score.add([this.scoreText,e]);var t=-20;Phaser.Display.Align.In.LeftCenter(this.scoreText,e,t),this.add(this.score),t=10,Phaser.Display.Align.In.Center(this.score,this,t)},n.updateScore=function(){var e=this.payload.score;this.scoreText.setText(e)},n.createButton=function(){this.button=new Vc.Z(this.scene,eN,tN.BUTTON_GREEN_MINOR_MINI,54,34.5),this.button.setName("ChallengeFriend");var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"PLAY"});Phaser.Display.Align.In.Center(e,this.button,0,-2),this.button.add(e),Phaser.Display.Align.In.RightCenter(this.button,this,-2),this.add(this.button),this.button.onClick=this.handleChallengeFriend},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),this.showPopUp=new Q_({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(e,t){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new q_({targets:n,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e){return.8*e.scale},getEnd:function(e){return e.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},t}(Phaser.GameObjects.Container),iN=nN;function rN(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return aN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aN(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function aN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var sN=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.currentPlayerId=void 0,n.scroller=void 0,n.scene=t;var i=n.scene.player;return n.currentPlayerId=i.getPlayerId(),n.createReuseScroller(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createReuseScroller=function(){this.scroller=new X_(this.scene,{classType:iN,listConfigs:[],width:280,height:310,padding:10,marginTop:10,marginBottom:10}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(Ki.Z.DEFAULT.KEY,Ki.Z.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,25),this.add(this.scroller)},n.updateData=function(e){var t=Object.values(e)||[];if(t.length<1)return this.scene.isSwitchable=!0,void this.scene.board.showMessage(!0,"Leaderboard is empty!");for(var n,i=[],r=rN(t.sort((function(e,t){return+t.score-+e.score})));!(n=r()).done;){var a=n.value,s=a.playerId,o=a.photo,c=a.score,h=a.name,u=a.rank;if(s){var l=this.currentPlayerId===s,d={playerId:s,photo:o,name:h,rank:u,score:c,scoreRight:this.scene.tabId===Te,useChallenge:!l&&this.scene.tabId===xe,isHighlight:l};i.push(d)}}this.scroller.updateConfig(i),this.showLeaders()},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this,t=this.getLeaders();if(t.length<1)return this.scene.isSwitchable=!0,void this.scene.board.showMessage(!0,"Leaderboard is empty!");for(var n=Math.min(t.length,6),i=0;i<n;i++){var r=t[i];r&&(r.setVisible(!0),r.runShowUpAnimation(i,300))}var a=300+100*n+250;this.scene.time.delayedCall(a,(function(){e.scene.isSwitchable=!0,e.scroller.setEnable(!0)}))},t}(Phaser.GameObjects.Container),oN=sN,cN=Ki.Z.DEFAULT,hN=cN.KEY,uN=cN.FRAME,lN=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tabWorld=void 0,n.tabFriends=void 0,n.scene=t,n.createTabFriends(),n.createTabWorld(),n}(0,f.Z)(t,e);var n=t.prototype;return n.selectTabFriends=function(){this.tabFriends.button.setFrame(uN.LEADERBOARD_TAB_ON),this.tabWorld.button.setFrame(uN.LEADERBOARD_TAB_OFF)},n.selectTabWorld=function(){this.tabFriends.button.setFrame(uN.LEADERBOARD_TAB_OFF),this.tabWorld.button.setFrame(uN.LEADERBOARD_TAB_ON)},n.createTabFriends=function(){this.tabFriends=new Vc.Z(this.scene,hN,uN.LEADERBOARD_TAB_OFF),this.tabFriends.button.setSize(85,33).setDisplaySize(85,33),this.tabFriends.setName("FriendsTab");var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:9,text:"FRIENDS",origin:{x:.5,y:.55}});this.tabFriends.add(e),Phaser.Display.Align.In.Center(this.tabFriends,this,-55),this.add(this.tabFriends)},n.createTabWorld=function(){this.tabWorld=new Vc.Z(this.scene,hN,uN.LEADERBOARD_TAB_OFF),this.tabWorld.button.setSize(85,33).setDisplaySize(85,33),this.tabWorld.setName("WorldTab");var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:9,text:"WORLD",origin:{x:.5,y:.55}});this.tabWorld.add(e),Phaser.Display.Align.In.Center(this.tabWorld,this,55),this.add(this.tabWorld)},t}(Phaser.GameObjects.Container),dN=lN,pN=Ki.Z.DEFAULT,fN=pN.KEY,mN=pN.FRAME,gN=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.tabs=void 0,n.leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.scene=t,n.setSize(310,430),n.createBackground(),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.showLoading=function(e){this.loading.setVisible(e),this.showMessage(!1)},n.showMessage=function(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.messageAnimation.play())},n.createBackground=function(){this.background=new Eh(this.scene,0,0,310,430),this.add(this.background)},n.createLoading=function(){this.loading=new ic.Z(this.scene),this.loading.setTint(12237498),this.loading.setWorldSize(113,113),this.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this.background)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this.background)},n.createContents=function(){this.createLeaders(),this.createTitle(),this.createTabs()},n.createLeaders=function(){this.leaders=new oN(this.scene),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this.background,0,0)},n.createTitle=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:fN,frame:mN.RIBBON_SHORT});t.setWorldSize(271,81);var n=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Leaderboards"});Phaser.Display.Align.In.Center(n,t,0,-10),e.add([t,n]),Phaser.Display.Align.In.TopCenter(e,this.background,0,5),this.add(e)},n.createTabs=function(){this.tabs=new dN(this.scene),this.add(this.tabs),Phaser.Display.Align.In.TopCenter(this.tabs,this.background,0,-55)},n.createAnimation=function(){this.messageAnimation=new V_.Z({targets:[this.message],duration:60,repeat:2})},t}(Phaser.GameObjects.Container),vN=gN,yN=GameCore.Configs.LeadersBoard,EN=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).board=void 0,t.footerBar=void 0,t.tabId=void 0,t.offset=void 0,t.isRequesting=void 0,t.isSwitchable=void 0,t.run=function(){t.isRequesting=!1;var e=[{selector:vc,callback:function(e){if(t.isRequesting=e,t.board.showLoading(e),!1===e){var n=t.game.storage.getState(),i=gc(n);t.board.leaders.updateData(i)}}}];t.handleStateChange(e),t.selectFriendTab()},t.handleSelectFriendTab=function(){t.isRequesting||t.isSwitchable&&(t.isSwitchable=!1,t.selectFriendTab())},t.handleSelectWorldTab=function(){t.isRequesting||t.isSwitchable&&(t.isSwitchable=!1,t.selectWorldTab())},t.handlePlayWithFriend=function(){t.storage.dispatch(Ai())},t.handleHomeClick=function(){t.scene.switch(le.C.DASHBOARD_SCENE)},t.handleShareLeaderboard=function(){t.storage.dispatch(Tc())},t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.gameZone.setPosition(0,0),this.createBackground(oe.Z.BACKGROUND.KEY,"0"),this.scene.bringToTop(),this.createBoard(),this.createFooterBar()},n.selectFriendTab=function(){this.tabId=xe,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabFriends(),this.storage.dispatch(dc(yN.LeaderboardId,xe,yN.Limit,this.offset))},n.selectWorldTab=function(){this.tabId=Te,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabWorld(),this.storage.dispatch(dc(yN.LeaderboardId,Te,yN.Limit,this.offset))},n.loadMoreTabFriend=function(){this.isRequesting||(this.offset+=yN.Limit,this.storage.dispatch(dc(yN.LeaderboardId,xe,yN.Limit,this.offset)))},n.loadMoreTabWorld=function(){this.isRequesting||(this.offset+=yN.Limit,this.storage.dispatch(dc(yN.LeaderboardId,Te,yN.Limit,this.offset)))},n.createBoard=function(){this.board=new vN(this),Phaser.Display.Align.In.Center(this.board,this.gameZone,0,-20),this.board.tabs.tabWorld.onClick=this.handleSelectWorldTab,this.board.tabs.tabFriends.onClick=this.handleSelectFriendTab},n.createFooterBar=function(){this.footerBar=new K_(this),Phaser.Display.Align.In.BottomCenter(this.footerBar,this.gameZone,0,-50),this.footerBar.homeButton.onClick=this.handleHomeClick,this.footerBar.playButton.onClick=this.handlePlayWithFriend,this.footerBar.shareButton.onClick=this.handleShareLeaderboard},t}(ec.Z);var CN,wN,AN=EN,bN=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,f.Z)(t,e),t}((0,R.Z)(Error)),SN=Ki.Z.DEFAULT,TN=SN.KEY,xN=SN.FRAME,kN=[{id:"pass-levels",title:"passLevels",require:{level:5},reward:{coins:300},key:TN,frame:xN.MISSION.IC_PASS_LEVEL},{id:"clear-cards",title:"clearCards",require:{cards:60},reward:{coins:200},key:TN,frame:xN.MISSION.IC_CLEAR_CARD},{id:"use-wild-cards",title:"useWildCards",require:{wildCards:5},reward:{coins:300},key:TN,frame:xN.MISSION.IC_USE_WILD_CARD}],PN=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",kN);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),IN=(0,Q.P1)([function(e){var t;return null==(t=e[Us])?void 0:t.tasks}],(function(e){return e})),ON=(0,Q.P1)([function(e){var t;return null==(t=e[Us])?void 0:t.process}],(function(e){return e})),RN=(0,Q.P1)([function(e){var t;return null==(t=e[Us])?void 0:t.isRequesting}],(function(e){return e})),BN=((0,Q.P1)([function(e){var t;return null==(t=e[Us])?void 0:t.isNotice}],(function(e){return e})),GameCore.Configs.DailyTasks,function(e){return function(t){t({type:Ys,payload:{tasks:e}})}}),DN=function(){window.game.player},LN=function(){function e(e,t){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(e){var t=e.type,i=e.value;if(!(i<1)&&(-1!==n.requireTypes.indexOf(t)&&!n.isPassRequiredTarget(t)&&n.processMore(e))){t=e.type,i=e.value;var r=n.getCorrectValue(t,i);n.game.storage.dispatch(function(e,t,n){return function(i){var r=DN();if(GameCore.Utils.Valid.isObject(r)){var a=r;GameCore.Utils.Object.hasOwn(a,e)&&(a[e].rewarded||(a[e][t]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:a}),i({type:Hs,payload:{id:e,type:t,value:n}})))}}}(n.id,t,r)),n.isTaskFinished(t)&&n.game.storage.dispatch(function(e){return function(t){t({type:zs,payload:{id:e}}),$h.emit(jh.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=e,this.id=t,this.init()}var t=e.prototype;return t.init=function(){var e=this,t=this.game.storage.getState(),n=IN(t)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:n.find((function(t){return t.id===e.id}));i&&(this.taskData=i,this.requireTypes=Object.keys(this.taskData.require),this.initEvents())}},t.getDataByType=function(e){var t=this.game.storage.getState(),n=ON(t),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var r=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(r)&&GameCore.Utils.Object.hasOwn(r,e)){var a=r[e];"number"===typeof a&&(i.value=a)}return i.target=this.taskData.require[e]||0,i},t.getCorrectValue=function(e,t){var n=this.getDataByType(e),i=n.value,r=n.target,a=t;return i+t>r&&(a=r-i),Math.round(a)},t.isPassRequiredTarget=function(e){var t=this.getDataByType(e);return t.value>=t.target},t.isTaskFinished=function(e){var t=this.getDataByType(e);return t.value>=t.target},e}(),MN=jh.CHALLENGE_FRIENDS,_N=MN.ID,NN=MN.EVENTS,GN=function(e){function t(t){return e.call(this,t,_N)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(NN.CHALLENGE_FRIENDS,this.process),$h.on(NN.CHALLENGE_FRIENDS,this.process)},n.processMore=function(){return!0},t}(LN),FN=jh.CLEAR_CARDS,ZN=FN.ID,UN=FN.EVENTS,WN=function(e){function t(t){var n;return(n=e.call(this,t,ZN)||this).cards=void 0,n.reset=function(){n.cards=[]},n.reset(),n}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){var e=this;$h.off(UN.CLEAR_CARDS,this.process),$h.on(UN.CLEAR_CARDS,this.process),$h.on(UN.RESET,(function(){return e.reset()}))},n.processMore=function(e){var t=e.card;return!(!t||this.cards.includes(t))&&(this.cards.push(t),!0)},t}(LN),YN=jh.INVITE_FRIENDS,HN=YN.ID,zN=YN.EVENTS,KN=function(e){function t(t){return e.call(this,t,HN)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(zN.INVITED_FRIEND,this.process),$h.on(zN.INVITED_FRIEND,this.process)},n.processMore=function(){return!0},t}(LN),VN=jh.PASS_LEVELS,XN=VN.ID,jN=VN.EVENTS,qN=function(e){function t(t){return e.call(this,t,XN)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(jN.PASS_LEVEL,this.process),$h.on(jN.PASS_LEVEL,this.process)},n.processMore=function(){return!!mi.instance.isSingleMode()},t}(LN),JN=jh.USE_WILDCARDS,QN=JN.ID,$N=JN.EVENTS,eG=function(e){function t(t){return e.call(this,t,QN)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off($N.USE_WILDCARD,this.process),$h.on($N.USE_WILDCARD,this.process)},n.processMore=function(){return!0},t}(LN),tG=function(){function e(e){var t=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.eventsListener={},e.next=3,t.initData();case 3:t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!RN(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Ws,payload:{}}),e.next=7,PN();case 7:r=e.sent,t(BN(r));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.game=e,this.init()}var t=e.prototype;return t.getEventListener=function(e){return this.eventsListener[e]},t.initEvents=function(){this.eventsListener[jh.PASS_LEVELS.ID]=new qN(this.game),this.eventsListener[jh.INVITE_FRIENDS.ID]=new KN(this.game),this.eventsListener[jh.USE_WILDCARDS.ID]=new eG(this.game),this.eventsListener[jh.CHALLENGE_FRIENDS.ID]=new GN(this.game),this.eventsListener[jh.CLEAR_CARDS.ID]=new WN(this.game)},e}(),nG=tG,iG=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],rG=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",iG);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),aG=(0,Q.P1)([function(e){var t;return null==(t=e[Ls])?void 0:t.missions}],(function(e){return e})),sG=(0,Q.P1)([function(e){var t;return null==(t=e[Ls])?void 0:t.isRequesting}],(function(e){return e})),oG=((0,Q.P1)([aG,function(e,t){return t.name}],(function(e,t){return e?"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:null:null})),function(e){return{type:_s,payload:{missions:e}}}),cG=Ki.Z.GAMEPLAY.FRAME,hG=cG.TILE_RED,uG=cG.TILE_BLUE,lG=cG.TILE_PINK,dG=cG.TILE_GREEN,pG=cG.TILE_YELLOW,fG=cG.TILE_FREEZE,mG=cG.TILE_COLORFUL,gG=cG.TILE_COLOR_CHANGE,vG={RED:"red",BLUE:"blue",PINK:"pink",GREEN:"green",YELLOW:"yellow"},yG={FREEZE:"freeze",COLORFUL:"colorful",COLOR_CHANGE:"color_change"},EG=vG.RED,CG=vG.BLUE,wG=vG.PINK,AG=vG.GREEN,bG=vG.YELLOW,SG=yG.FREEZE,TG=yG.COLORFUL,xG=yG.COLOR_CHANGE,kG=((CN={})[EG]="r",CN[CG]="b",CN[wG]="p",CN[AG]="g",CN[bG]="y",CN[SG]="f",CN[TG]="c",CN[xG]="m",CN),PG={SIZE:37,STATUS:{READY:"ready",MOVING:"moving",CAPTURED:"captured"},FRAME:(wN={},wN[EG]=hG,wN[CG]=uG,wN[wG]=lG,wN[AG]=dG,wN[bG]=pG,wN[SG]=fG,wN[TG]=mG,wN[xG]=gG,wN),SETS:{SET_3:"set_3",SET_4:"set_4",SET_5:"set_5",SET_6:"set_6",SET_7:"set_7",SET_8:"set_8",SET_9:"set_9"},COLORS:vG,SPECIALS:yG,HASH:kG},IG={GIFT:{ID:"ItemGift"},PAINT:{ID:"ItemPaint"},HAMMER:{ID:"ItemHammer"},SHUFFLE:{ID:"ItemShuffle"},CHANGE_COLOR:{ID:"ItemChangeColor"}},OG={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"},OBJECTS:(0,p.Z)({},PG.COLORS,PG.SPECIALS,{PAINT:IG.PAINT.ID,HAMMER:IG.HAMMER.ID,SHUFFLE:IG.SHUFFLE.ID})},RG=(0,Q.P1)([function(e){var t;return null==(t=e[Ls])?void 0:t.mission}],(function(e){return e})),BG=((0,Q.P1)([RG],(function(e){return e?e.name:null})),function(){function e(e,t,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(e){var t=e.id,n=e.type,r=e.value;r<1||i.id===t&&i.isTypeRequired(n)&&i.processMore(e)&&(i.game.storage.dispatch(function(e,t,n){return{type:Ns,payload:{name:e,type:t,value:n}}}(i.name,n,r)),i.isMissionComplete()&&($h.emit(OG.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(e){return{type:Gs,payload:{name:e}}}(i.name))))},this.id=t,this.name=n,this.game=e}var t=e.prototype;return t.start=function(){var e=this.game.storage.getState(),t=RG(e);t&&t.name===this.name&&(this.reward=t.reward,this.initEvents())},t.getMissionData=function(){var e=this.game.storage.getState(),t=RG(e);return t?t.name!==this.name?null:t:null},t.getDataByType=function(e){var t=this.getMissionData();if(!t)return null;var n=t.require[e];return{value:t.process[e],target:n}},t.isTypeRequired=function(e){var t=this.getDataByType(e);return!!t&&t.target>0},t.isMissionComplete=function(){var e=this.getMissionData();if(!e)return!0;var t=e.require,n=e.process,i=!0;return Object.keys(t).forEach((function(e){if(i){var r=t[e];n[e]<r&&(i=!1)}})),i},e}()),DG=BG,LG=OG.EVENTS,MG=OG.TYPES,_G=function(e){function t(t,n){return e.call(this,t,MG.COLLECT_GEMS,n)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(LG.MISSION_UPDATE,this.process),$h.on(LG.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},t}(DG),NG=OG.EVENTS,GG=OG.TYPES,FG=function(e){function t(t,n){return e.call(this,t,GG.COMBO,n)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(NG.MISSION_UPDATE,this.process),$h.on(NG.MISSION_UPDATE,this.process)},n.processMore=function(e){var t=this.getMissionData();if(!t)return!1;var n=e.type;return e.value>=t.require[n]},t}(DG),ZG=OG.EVENTS,UG=OG.TYPES,WG=function(e){function t(t,n){return e.call(this,t,UG.USE_ITEM,n)||this}(0,f.Z)(t,e);var n=t.prototype;return n.initEvents=function(){$h.off(ZG.MISSION_UPDATE,this.process),$h.on(ZG.MISSION_UPDATE,this.process)},n.processMore=function(e){return!0},t}(DG),YG=function(){function e(e){var t=this;this.game=void 0,this.listener=void 0,this.init=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initData();case 2:t.initListeners(),t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!sG(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Ms,payload:{}}),e.next=7,rG();case 7:r=e.sent,t(oG(r));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.startListener=function(e){t.listener[e]&&t.listener[e].start()},this.game=e,this.init()}var t=e.prototype;return t.initListeners=function(){var e=this;this.listener={};var t=this.game.storage.getState(),n=aG(t);n&&Object.keys(n).forEach((function(t){switch(n[t].id){case OG.TYPES.COLLECT_GEMS:e.listener[t]=new _G(e.game,t);break;case OG.TYPES.COMBO:e.listener[t]=new FG(e.game,t);break;case OG.TYPES.USE_ITEM:e.listener[t]=new WG(e.game,t)}}))},t.initEvents=function(){$h.off(OG.EVENTS.MISSION_START,this.startListener),$h.on(OG.EVENTS.MISSION_START,this.startListener)},e}(),HG=YG,zG=function(){return function(e){try{window.game.facebook.getTournamentAsync().then((function(t){e(Ei(t))})).catch((function(e){}))}catch(t){}}},KG=function(){return function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,l,d,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=n(),r=Nt(i),s=window.game,o=s.player,c=s.level,h=o.getPlayer(),u=r.entryPointData,d=(l=u||{}).matchId,p=l.opponentId,f=l.playerId,m=h.playerId===f,c.getLevelData()){e.next=17;break}return e.prev=10,e.next=13,c.preloadLevelDataAsync();case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:t(Si(d,m?p:f)),e.next=23;break;case 20:throw e.prev=20,e.t1=e.catch(0),new Error("processChallengeFriendMode: "+e.t1);case 23:case"end":return e.stop()}}),e,null,[[0,20],[10,15]])})));return function(t,n){return e.apply(this,arguments)}}()},VG=n(47),XG=GameCore.Configs.Notification.ApiUrl,jG=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,Se("players/"+n,t,{},XG,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qG=GameCore.Configs,JG=qG.AppId,QG=qG.Notification,$G=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).isMusicLoaded=!1,t.handleFBInstantGameStarted=function(){window.__fbGameReady=!0,window.__fbPlatform=FBInstant.getPlatform(),t.player.requestConnectedPlayers(),t.facebook.attemptToAddShortcut()},t.processAfterUpdatePlayerProfile=function(){QG.Enable&&(t.updatePlayerProfileToNotificationService(),QG.DisableSendNotification||(Bv.sendNewUserNotification(),Bv.sendDailyNotification()))},t.startGame=function(){t.analytics.event(ae._.APP_READY),t.storage.dispatch((0,VG.I)(le.C.LOAD_SCENE)),t.storage.dispatch((function(e,t){var n=window.game,i=n.player,r=n.analytics,a=n.globalScene;try{var s=t(),o=Nt(s),c=Gt(s),h=i.getPlayer(),u=(o.entryPointData||{}).type;if(h.isUserNew&&r.event(ae._.NEW_USER),c===_t)return void e(zG());if(c===Lt&&u===Qe)return void e(KG());e(Ci())}catch(d){a.events.emit(le.K.SWITCH,le.C.GAME_SCENE),(0,l.tO)(d)}}))},t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(ae._.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){var t=new bN("Load resources at LoadScene failed.");(0,l.R0)(t,{file:null==e?void 0:e.url})})),this.addFontToTextStyler(),(0,Rc.QT)(this.lang.getCurrentLanguage());var t=this.addLocaleToFilename(Rc.ZP.FONT_ATLAS.TEXTURE),n=this.addLocaleToFilename(Rc.ZP.FONT_ATLAS.DATA);this.load.atlas(Rc.ZP.FONT_ATLAS.KEY,t,n),this.load.atlas({key:Ki.Z.DEFAULT.KEY,textureURL:Ki.Z.DEFAULT.TEXTURE,atlasURL:Ki.Z.DEFAULT.JSON}),this.load.atlas({key:Ki.Z.GAMEPLAY_DEFAULT.KEY,textureURL:Ki.Z.GAMEPLAY_DEFAULT.TEXTURE,atlasURL:Ki.Z.GAMEPLAY_DEFAULT.JSON}),this.load.atlas({key:Ki.Z.GAMEPLAY_OBJECTS.KEY,textureURL:Ki.Z.GAMEPLAY_OBJECTS.TEXTURE,atlasURL:Ki.Z.GAMEPLAY_OBJECTS.JSON}),this.load.atlas({key:Ki.Z.DASHBOARD.KEY,textureURL:Ki.Z.DASHBOARD.TEXTURE,atlasURL:Ki.Z.DASHBOARD.JSON}),this.load.multiatlas({key:Ki.Z.EFFECTS.KEY,path:Ki.Z.EFFECTS.PATH,atlasURL:Ki.Z.EFFECTS.JSON}),this.load.image(oe.Z.OVERLAY.KEY,oe.Z.OVERLAY.FILE);var i=this.addLocaleToFilename(Rc.ZP.PRIMARY.DATA),r=this.addLocaleToFilename(Rc.ZP.NORMAL.DATA),a=this.addLocaleToFilename(Rc.ZP.NORMAL_1.DATA),s=this.addLocaleToFilename(Rc.ZP.SHADOW.DATA),o=this.addLocaleToFilename(Rc.ZP.STROKE.DATA),c=this.addLocaleToFilename(Rc.ZP.WHITE_SHADOW.DATA),h=this.addLocaleToFilename(Rc.ZP.STYLE.DATA),u=this.addLocaleToFilename(Rc.ZP.HEADER.DATA);[{key:Rc.ZP.PRIMARY.KEY,data:i},{key:Rc.ZP.NORMAL.KEY,data:r},{key:Rc.ZP.NORMAL_1.KEY,data:a},{key:Rc.ZP.SHADOW.KEY,data:s},{key:Rc.ZP.STROKE.KEY,data:o},{key:Rc.ZP.WHITE_SHADOW.KEY,data:c},{key:Rc.ZP.STYLE.KEY,data:h},{key:Rc.ZP.HEADER.KEY,data:u}].forEach((function(t){var n=t.key,i=t.data;e.load.xml(n,i)})),this.player.updateData().then(this.processAfterUpdatePlayerProfile).catch(l.tO);var d=GameCore.Configs.GameSettingsURL;d&&this.load.json("game-settings",d),this.journey.initData();var p=this.journey.getCurrentStage(),f=p.backgroundKey,m=p.backgroundFile;this.themeHandler.preloadBackgroundAsync(f,m)},n.create=function(){this.audio.initSound(),this.audio.importSoundEffectKeys(Hc.Z.EFFECTS),this.analytics.event(ae._.LOAD_COMPLETE),this.parseBitmapFontFromAtlas();var e=this.player.getLevel();this.level.setLevel(e),this.level.setMaxLevel(1e3);var t=this.player.getLifeData();this.life.initData(t.hearts,t.lastTimeReceive),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.weeklyTournament.initData(),this.offshoreRace.initData(),this.boxingDuel.initData(),this.journey.initData(),this.handleShowAdWhenStartGame(),this.startGame()},n.parseBitmapFontFromAtlas=function(){var e=this;Rc.cX.forEach((function(t){var n=t.fontName,i=t.textureKey,r=t.frameKey,a=t.xmlKey;Phaser.GameObjects.BitmapText.ParseFromAtlas(e,n,i,r,a)}))},n.addFontToTextStyler=function(){"en"===this.lang.getCurrentLanguage()?this.textStyler.addFont({type:"local",fontType:"opentype",fontName:"mikado-bold"}):this.textStyler.addFont({type:"local",fontType:"woff",fontName:"DejaVuSans-Bold"})},n.updatePlayerProfileToNotificationService=function(){var e=this.player.getPlayer(),t=e.playerId,n=e.name,i=e.photo,r=e.locale,a=e.ASID;jG({appId:JG,playerId:t,name:n,photo:i,locale:r,ASID:a})},n.setupGlobalScene=function(){var e=this.scene.get(le.C.GLOBAL_SCENE);e instanceof I_.Z&&e.setup()},n.initModules=function(){new HG(this.game),new nG(this.game)},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},n.addLocaleToFilename=function(e){return"./assets/fonts/"+this.lang.getCurrentLanguage()+"/"+e},n.handleShowAdWhenStartGame=function(){var e=this;if(GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){var t={en:"Initializing...",ru:"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f...",pt:"Inicializando...",es:"Inicializando...",ar:"\u062a\u0647\u064a\u0626\u0629...",hi:"\u092a\u094d\u0930\u093e\u0930\u0902\u092d \u0915\u0930 \u0930\u0939\u093e \u0939\u0948...",zh:"\u521d\u59cb\u5316\u4e2d...",tr:"Ba\u015flat\u0131l\u0131yor...",ja:"\u521d\u671f\u5316\u4e2d...",fr:"Initialisation en cours...",id:"Menginisialisasi...",de:"Initialisierung...",it:"Inizializzazione..."}[this.lang.getCurrentLanguage()||""]||"",n=document.createElement("div");n.id="wait-ads-mask";var r=document.createElement("div");r.id="wait-ads-content",n.appendChild(r);var s=document.createElement("div");s.id="wait-ads-dual-ring",r.appendChild(s);var o=document.createElement("div");o.id="wait-ads-text",o.innerHTML=t,r.appendChild(o),document.body.appendChild(n),this.audio.muteAll(),setTimeout((0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.ads.setAdInProcess(!0),e.audio.stopMusic(),e.audio.pauseAllSounds(),e.audio.muteAll(),t.next=7,e.ads.preloadInterstitialAdAsync();case 7:return t.next=9,e.ads.showInterstitialAdAsync();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),(0,l.tO)(t.t0);case 14:return t.prev=14,n.remove(),e.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(e.audio.unmuteAll(),e.audio.playMusic(),e.audio.resumeAllSounds()),t.finish(14);case 19:case"end":return t.stop()}}),t,null,[[0,11,14,19]])}))),0)}},t}(Phaser.Scene),eF=$G,tF=Ki.Z.DEFAULT,nF=tF.KEY,iF=tF.FRAME,rF=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.avatar=void 0,n.crown=void 0,n.playerName=void 0,n.playerScore=void 0,n.scene=t,n.createAvatar(),n.updateSize(),n.createWinCrown(),n.createPlayerName(),n.createPlayerScore(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.showCrown=function(e){this.crown.setVisible(e),e?(this.avatar.setFrame(iF.AVATAR_FRAME_YELLOW_BIG),this.avatar.setBackground(iF.AVATAR_BG_YELLOW_BIG)):(this.avatar.setFrame(iF.AVATAR_FRAME_BLUE_BIG),this.avatar.setBackground(iF.AVATAR_BG_BLUE_BIG))},n.setPlayerName=function(e){this.playerName.setText(e)},n.setPlayerScore=function(e){this.playerScore.setText(""+e)},n.loadPhoto=function(e,t){this.avatar.loadPhoto(e,t,60)},n.updateSize=function(){var e=this.avatar,t=e.width,n=e.height;this.setSize(t,n)},n.createAvatar=function(){this.avatar=new Dc(this.scene,{key:nF,frame:iF.AVATAR_FRAME_BLUE_BIG,background:iF.AVATAR_BG_BLUE_BIG,width:89,height:89}),this.add(this.avatar)},n.createWinCrown=function(){this.crown=this.scene.make.image({key:nF,frame:iF.ICON_CROWN}),this.crown.setWorldSize(52,36),Phaser.Display.Align.In.TopCenter(this.crown,this.avatar,0,75),this.add(this.crown)},n.createPlayerName=function(){this.playerName=this.scene.make.text({style:{fontFamily:(0,Rc.BN)(),fontSize:this.scene.fontSize(42)+"px",fontStyle:"bold"},origin:{x:.5,y:.5}}),this.playerName.setTint(11632207),this.playerName.setHighQuality(),Phaser.Display.Align.In.BottomCenter(this.playerName,this.avatar,0,25),this.add(this.playerName)},n.createPlayerScore=function(){this.playerScore=this.scene.make.bitmapText({size:this.scene.fontSize(30),font:Rc.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.playerScore.setTint(6762627),Phaser.Display.Align.In.BottomCenter(this.playerScore,this.playerName,0,25),this.add(this.playerScore)},t}(Phaser.GameObjects.Container),aF=rF,sF=Ki.Z.DEFAULT,oF=sF.KEY,cF=sF.FRAME,hF=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.titleText=void 0,n.playerScore=void 0,n.opponentScore=void 0,n.buttonClose=void 0,n.buttonRestart=void 0,n.buttonShare=void 0,n.scene=t,n.createBoard(),n.createTitle(),n.createVSText(),n.createPlayers(),n.createRestartButton(),n.createShareButton(),n.scene.add.existing((0,yc.Z)(n)),n}(0,f.Z)(t,e);var n=t.prototype;return n.createBoard=function(){this.board=new Eh(this.scene,0,0,600,340),this.board.setDepth(Ha.Z.BACKGROUND),this.add(this.board),Phaser.Display.Align.In.Center(this.board,this)},n.createTitle=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:oF,frame:cF.RIBBON_FULL});t.setWorldSize(340,75),this.titleText=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(32),origin:{x:.5,y:.5}}),Phaser.Display.Align.In.Center(this.titleText,t,0,-10),this.buttonClose=new Vc.Z(this.scene,oF,cF.BUTTON_CLOSE,41.8,41.8),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,t,0,-3),e.setDepth(Ha.Z.TILE),e.add([t,this.titleText,this.buttonClose]),this.add(e),Phaser.Display.Align.In.Center(e,this.board,0,-170)},n.createVSText=function(){var e=this.scene.make.bitmapText({font:Rc.ZP.PRIMARY.KEY,size:this.scene.fontSize(70),text:"VS",origin:{x:.5,y:.5}});e.setTint(11632207),e.setDepth(Ha.Z.TEXT),this.add(e),Phaser.Display.Align.In.Center(e,this.board,0,-45)},n.createPlayers=function(){this.playerScore=new aF(this.scene),this.playerScore.setDepth(Ha.Z.ITEM),this.add(this.playerScore),Phaser.Display.Align.In.Center(this.playerScore,this.board,-100,-50),this.opponentScore=new aF(this.scene),this.opponentScore.setDepth(Ha.Z.ITEM),this.add(this.opponentScore),Phaser.Display.Align.In.Center(this.opponentScore,this.board,100,-50)},n.createRestartButton=function(){this.buttonRestart=new Fh.Z(this.scene,{key:oF,button:cF.BUTTON_GREEN,icon:cF.ICON_RESUME,text:"Restart"},170,72),this.buttonRestart.setName("Restart"),this.buttonRestart.setDepth(Ha.Z.BUTTON),this.add(this.buttonRestart),Phaser.Display.Align.In.Center(this.buttonRestart,this.opponentScore,0,155)},n.createShareButton=function(){this.buttonShare=new Fh.Z(this.scene,{key:oF,button:cF.BUTTON_BLUE,icon:cF.ICON_FLAT_SHARE,text:"Share"},153,72),this.buttonShare.setName("Restart"),this.buttonShare.setDepth(Ha.Z.BUTTON),this.add(this.buttonShare),Phaser.Display.Align.In.Center(this.buttonShare,this.playerScore,0,155)},t}(Phaser.GameObjects.Container),uF=hF,lF=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).main=void 0,t.run=function(){t.getResultInfo()},t.handleClose=function(){t.scene.sleep(le.C.RESULT_MATCH_SCENE),t.scene.run(le.C.GAME_OVER_SCENE)},t.handleShareScore=function(){t.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s,o,c,h,u,d,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,r=i.player,s=i.analytics,o=i.facebook,c=i.globalScene,e.prev=1,c.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),h=n(),e.next=6,Pc(h);case 6:return u=e.sent,wc(u),d=r.getPlayer(),p=d.playerId,f=d.name,m=d.photo,e.next=11,o.shareAsync({text:"Pheww, a great match!",intent:"SHARE",image:u||"",data:{playerId:p,playerName:f,playerPhoto:m,type:Je}});case 11:s.event(ae._.SHARE,{share_content_type:"MatchResult",success:!0}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),s.event(ae._.SHARE,{share_content_type:"MatchResult",success:!1}),(0,l.tO)(e.t0);case 18:return e.prev=18,c.screen.close(de.o4.NOTIFY_SCREEN),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})));return function(t,n){return e.apply(this,arguments)}}())},t.handleRestartMatch=function(){t.storage.dispatch(function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.game.globalScene.screen.open(de.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),i=n(),r=tt(i),[Dt,_t].indexOf(r)>=0&&(t($n()),t(qn())),s=null,r===Lt&&(s=yn(i),t({type:rn,payload:{}})),t(oi()),e.next=11,t(xi(r,s));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,l.tO)(e.t0);case 16:return e.prev=16,yi(300),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()),t.scene.sleep(le.C.RESULT_MATCH_SCENE),t.scene.sleep(le.C.GAME_OVER_SCENE)},t}(0,f.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.createMask(.8),this.createMain(),this.createInput()},n.getResultInfo=function(){var e=this.storage.getState(),t=bn(e),n=tt(e),i=this.player.getPlayer(),r=i.photo,a=i.name,s=i.playerId,o=yn(e),c=o.playerId,h=o.name,u=o.photo,l=(t[s]||{}).score,d=void 0===l?0:l,p=(t[c]||{}).score,f=void 0===p?0:p,m=Cn(e,{playerId:s}),g=wn(e,{opponentId:c});n===Mt&&(m=!0,g=!0);var v=m&&g;this.main.playerScore.loadPhoto(s,r),this.main.opponentScore.loadPhoto(c,u),this.main.playerScore.setPlayerName(a),this.main.opponentScore.setPlayerName(h),this.main.playerScore.setPlayerScore(d),this.main.opponentScore.setPlayerScore(f),this.main.playerScore.showCrown(v&&d>f),this.main.opponentScore.showCrown(v&&f>d),m&&g?d===f?this.main.titleText.setText("Draw"):d>f?this.main.titleText.setText("You Win"):d<f&&this.main.titleText.setText("You Lose"):this.main.titleText.setText("Waiting for Opponent"),m&&g&&(d===f||(d>f?this.audio.playSound(rc.Z.YOU_WIN):d<f&&this.audio.playSound(rc.Z.YOU_LOSE)))},n.createMain=function(){this.main=new uF(this),Phaser.Display.Align.In.Center(this.main,this.gameZone,0,13)},n.createInput=function(){this.main.buttonClose.onClick=this.handleClose,this.main.buttonRestart.onClick=this.handleRestartMatch,this.main.buttonShare.onClick=this.handleShareScore},t}(ec.Z);var dF=lF;function pF(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return fF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fF(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var mF=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).level=1,t.maxLevel=10,t.challengeLevel=200,t.shouldLoadChallengeLevel=!1,t.promisePreloadLevel={},t.loadedLevel={},t.convertedLevel={},t.width=void 0,t.height=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this)},n.getLevel=function(){return this.level},n.setLevel=function(e){this.level=e,this.maxLevel=Math.max(this.maxLevel,e)},n.setChallengeLevel=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.challengeLevel=t,e.next=3,this.preloadLevelDataAsync(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getMaxLevel=function(){return this.maxLevel},n.setMaxLevel=function(e){this.maxLevel=e},n.setLevelCustom=function(e){this.loadedLevel[this.getKeyLevel(this.level)]=e},n.getLevelByMode=function(){return this.level},n.getRandomChallengeLevel=function(){return Phaser.Math.Between(200,500)},n.processLevelCompleted=function(e,t){var n=window.game.player,i=n.getLevel();this.setLevel(e+1),i<=e&&n.setLevel(e+1),this.preloadLevelDataAsync(e+1)},n.nextLevel=function(){this.level+=1,this.maxLevel=Math.max(this.level,this.maxLevel),this.preloadLevelDataAsync(this.level),this.preloadLevelDataAsync(this.level+1)},n.backLevel=function(){this.level-=1,this.maxLevel=Math.max(this.level,this.maxLevel),this.preloadLevelDataAsync(this.level),this.preloadLevelDataAsync(this.level-1)},n.getKeyLevel=function(e){var t="0001";return GameCore.layoutInitializer.isLandscape?(e>1e3&&(e=501+(e-501)%500),t=GameCore.Utils.Number.padStart(e,4)):(e>1200&&(e=501+(e-501)%700),t=GameCore.Utils.Number.padStart(e,4)),"level_"+t},n.preloadLevelDataAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||this.level,n=this.getKeyLevel(t),(!Object.keys(this.promisePreloadLevel).includes(n)||GameCore.Configs.Level.alwaysLoadNew)&&(this.promisePreloadLevel[n]=this.preloadLevel(t)),e.next=6,this.promisePreloadLevel[n];case 6:if(i=e.sent){e.next=13;break}return delete this.promisePreloadLevel[n],this.promisePreloadLevel[n]=this.preloadLevel(t),e.abrupt("return",this.promisePreloadLevel[n]);case 13:return this.loadedLevel[n]=i,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.preloadLevel=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=GameCore.Configs.Level.url,r=GameCore.Configs.Level.urlPortrait,s=GameCore.layoutInitializer.isLandscape?i:r,o=this.getKeyLevel(t),e.next=7,fetch(""+s+o+".json",{method:"GET"});case 7:return c=e.sent,e.next=10,c.json();case 10:n=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",void 0);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),n.getLevelDataAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.preloadLevelDataAsync(t||this.level);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),n.getLevelData=function(e){e=e||this.level;var t=this.getKeyLevel(e);if(this.loadedLevel[t]){if(this.convertedLevel[t]&&!GameCore.Configs.Level.alwaysLoadNew)return this.convertedLevel[t];var n=this.getNewLevelData(this.loadedLevel[t]);return this.convertedLevel[t]=n,n}},n.getNewLevelData=function(e){var t=this.getLayer("game-board",e),n=this.getLayer("settings",e),i=this.getLayer("code-breakers",e);return{cards:this.getCards(t),settings:this.getSettings(n),balloonData:this.getBalloon(i)}},n.toWorldPosition=function(e,t){return GameCore.layoutInitializer.isLandscape?this.toWorldPositionLandscape(e,t):this.toWorldPositionPortrait(e,t)},n.toWorldPositionLandscape=function(e,t){var n=this.game.world.getWorldSize(),i=360/1080;return{x:e*i+(n.width-640)/2,y:t*i-(360-n.height)/2-this.game.world.getSAB()/2}},n.toWorldPositionPortrait=function(e,t){var n=this.game.world.getWorldSize(),i=640/1920;return{x:e*i+(n.width-360)/2,y:t*i-((667-n.height)/2+5)-this.game.world.getSAB()/2}},n.convertCardType=function(e){if(e.type==qh.MOUSE)return nu.LOCK;if(e.type==qh.CHEESE)return nu.KEY;if(e.type==qh.VALUE)return e.addon==iu.BOMB?nu.BOOM:e.addon==iu.CHESTNUT||e.addon==iu.MAP_PIECE?nu.MAP_PIECE:e.addon==iu.INCREASE||e.addon==iu.DECREASE?nu.CHANGER:e.addon==iu.CHAIN?nu.CHAIN:nu.VALUE;if(e.type==qh.SQUIRREL)return nu.TREASURE;if(e.type==qh.TREASURE)return nu.TREASURE;if(e.type==qh.PLUS){if(1==e.value)return nu.PLUS_ONE;if(2==e.value)return nu.PLUS_TWO;if(3==e.value)return nu.PLUS_THREE;if(4==e.value)return nu.PLUS_FOUR;if(5==e.value)return nu.PLUS_FIVE}return e.type==qh.MYSTERIOUS?nu.MYSTERIOUS:nu.VALUE},n.getSuit=function(e){return-1==e?-1:[wu.SPADES,wu.CLUBS,wu.DIAMOND,wu.HEART][e-1]},n.getCards=function(e){var t=this;return e.objects.map((function(e,n){var i=e.x,r=e.y,a=e.id,s=e.rotation,o=e.properties,c=void 0===o?[]:o,h=(0,p.Z)({},t.toWorldPosition(i,r),{id:a,depth:n,addon:iu.NONE,addonValue:-1,suit:-1,angle:s,type:qh.VALUE,faceUp:!1,random:!1,value:-1,connectedCardID:-1});return c.forEach((function(e){h[e.name]=e.value})),-1==h.value?-1==h.suit?h.random=!0:h.value=Phaser.Math.Between(1,13):-1==h.suit&&(h.suit=Phaser.Math.Between(1,4)),h.type!=qh.PLUS&&(h.value=h.random?-1:h.value,h.suit=t.getSuit(h.suit)),t.toCardData(h)}))},n.toCardData=function(e){var t=e.id,n=e.x,i=e.y,r=e.angle,a=e.depth,s=e.faceUp,o=e.value,c=e.suit;return{x:n,y:i,id:t,depth:a,angle:r<-180?360+r:r>180?r-360:r,type:this.convertCardType(e),faceUp:s,random:-1==e.value||-1==e.suit,suit:c,value:o,NumberOfMoves:e.addonValue,CardChangerType:e.addon==iu.INCREASE?1:e.addon==iu.DECREASE?2:-1,connectedCardID:e.addonValue}},n.getProps=function(e,t){for(var n,i=pF(e);!(n=i()).done;){var r=n.value;if(r.name==t)return r.value}},n.findObjectByName=function(e,t){for(var n,i=pF(e);!(n=i()).done;){var r=n.value;if(r.name==t)return r}},n.getCodeBreakers=function(e){var t=this,n=[];return e.objects.forEach((function(i){if("lock"==i.name){var r="left"==t.getProps(i.properties,"direction")?1:2,a=e.objects.map((function(e){if(t.getProps(e.properties,"lockID")===i.id){var n=t.getProps(e.properties,"cardSuit")||-1;return{cardColor:t.getProps(e.properties,"cardColor")||0,cardSuit:t.getSuit(n),cardFace:t.getProps(e.properties,"cardValue")||0}}})).filter((function(e){return e})),s=i.x,o=i.y;n.push({direction:r,cardValues:a,position:t.toWorldPosition(s,o)})}})),n},n.getBalloon=function(e){var t=this,n=[],i=e.objects.filter((function(e){return"lock"==e.name}));return i?(i.forEach((function(i){var r,a;r="left"==t.getProps(i.properties,"direction")?1:2,a=t.toWorldPosition(i.x,i.y);var s=e.objects.filter((function(e){return t.getProps(e.properties,"lockID")===i.id}));if(0==s.length)return[];var o=s.map((function(e){var n=t.getProps(e.properties,"cardSuit")||-1,i={cardColor:t.getProps(e.properties,"cardColor")||0,cardSuit:t.getSuit(n),cardFace:t.getProps(e.properties,"cardValue")||0};return{position:t.toWorldPosition(e.x,e.y),cardValues:i}}));n.push({direction:r,position:a,balloons:o})})),n):[]},n.getSettings=function(e){var t,n,i,r=this.getCards(e),a=this.getMapProperties(e);return{cardsInStack:r.map((function(e){return{value:e.value,suit:e.suit}})),star_1:(null==(t=e.properties.find((function(e,t){return"star_1"==e.name})))?void 0:t.value)||0,star_2:(null==(n=e.properties.find((function(e,t){return"star_2"==e.name})))?void 0:n.value)||0,star_3:(null==(i=e.properties.find((function(e,t){return"star_3"==e.name})))?void 0:i.value)||0,mapProperties:a}},n.getMapProperties=function(e){for(var t,n=pF(e.properties);!(t=n()).done;){var i=t.value;if("mapProperties"==i.name){var r=i.value;return this.convertStreakToComboRewards(r),(0,Tn.TS)(zd,r)}}return zd},n.convertStreakToComboRewards=function(e){return[]},n.getLayer=function(e,t){for(var n,i=pF(t.layers);!(n=i()).done;){var r=n.value;if(r.name==e)return r}return t.layers[0]},n.setGameplayZone=function(e,t){this.width=e,this.height=t},t}(Phaser.Plugins.BasePlugin),gF=mF,vF=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).hearts=1,t.lastTimeReceive=0,t.maxHearts=void 0,t.maxTimeReceive=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.initData=function(e,t){this.hearts=e,this.lastTimeReceive=t,this.setMaxHearts(5),this.setMaxTimeReceive(1800)},n.setMaxTimeReceive=function(e){this.maxTimeReceive=e},n.setMaxHearts=function(e){this.maxHearts=e},n.getHearts=function(){return this.hearts},n.getTimeReceive=function(){return this.lastTimeReceive},n.getMaxHearts=function(){return this.maxHearts},n.setHearts=function(e){this.hearts>=this.maxHearts&&e<this.maxHearts&&this.resetTime(),this.hearts=e,this.updateLifeData(),this.game.events.emit(pi.HEART_CHANGED)},n.resetTime=function(){this.lastTimeReceive=Date.now(),this.updateLifeData()},n.increaseHeart=function(e,t){var n=this.hearts+e;t&&n>this.maxHearts&&(n=this.maxHearts),this.setHearts(n)},n.decreaseHeart=function(e){var t=this.hearts-e;t<0&&(t=0),this.setHearts(t)},n.getTimeLeftToReceiveHeart=function(){if(0==this.lastTimeReceive)return 0;var e=Date.now()-this.lastTimeReceive;return this.maxTimeReceive-Math.floor(e/1e3)},n.updateTime=function(){if(!(this.hearts>=this.maxHearts)){var e=this.getTimeLeftToReceiveHeart();if(e<=0){var t=Math.abs(Math.ceil(e/this.maxTimeReceive));this.increaseHeart(t,!0),this.resetTime()}}},n.updateLifeData=function(){window.game.player},t}(Phaser.Plugins.BasePlugin),yF=vF,EF=function(e){function t(){return e.apply(this,arguments)||this}return(0,f.Z)(t,e),t.prototype.performVibrating=function(e){this.game.player.getPlayerSettings().vibrate&&lv(e)},t}(Phaser.Plugins.BasePlugin),CF=EF;function wF(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return AF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AF(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function AF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var bF=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).cache=[],t}(0,f.Z)(t,e);var n=t.prototype;return n.refreshFriendsLeaderboard=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h,u,l,d,p,f,m,g,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.player.getPlayerId(),n=this.game.player.getConnectedPlayerIds(20,0),i=this.game.player.getConnectedPlayers(),r=n.filter((function(e){return e!==t})),s=[],e.prev=5,e.next=8,We({playerIds:r,limit:r.length});case 8:o=e.sent,c=wF(o);case 10:if((h=c()).done){e.next=21;break}if(u=h.value,l=u.playerId,d=u.score,p=u.rank,i[l]){e.next=15;break}return e.abrupt("continue",19);case 15:if(f=i[l],m=f.name,g=f.photo,s.push({playerId:l,name:m,photo:g,score:d,rank:p}),!(s.length>=4)){e.next=19;break}return e.abrupt("break",21);case 19:e.next=10;break;case 21:e.next=25;break;case 23:e.prev=23,e.t0=e.catch(5);case 25:v=this.isLeaderboardDirty(s),this.game.events.emit(pi.LEADERBOARD_UPDATED,v,s),this.cache=s;case 28:case"end":return e.stop()}}),e,this,[[5,23]])})));return function(){return e.apply(this,arguments)}}(),n.isLeaderboardDirty=function(e){if(this.cache.length!==e.length)return!0;for(var t=0;t<e.length;t++)if(this.cache[t].playerId!==e[t].playerId||this.cache[t].photo!==e[t].photo||this.cache[t].score!==e[t].score||this.cache[t].rank!==e[t].rank||this.cache[t].name!==e[t].name)return!0;return!1},t}(Phaser.Plugins.BasePlugin),SF=bF,TF=n(67),xF=n(68),kF=function(e){function t(t){var n;return(n=e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n    \n    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);\n    gl_FragColor = texture *  texel;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}",uniforms:["uProjectionMatrix","uMainSampler","gray"]})||this).gray=void 0,n.gray=.8,n}return(0,f.Z)(t,e),t.prototype.onPreRender=function(){this.set1f("gray",this.gray)},t}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline),PF=JSON.parse('[{"id":"0","name":"Paris","decorationKey":"paris","decorationConfigs":[{"id":"0","file":"arc","buttonX":-4,"buttonY":98,"decorations":[{"level":1,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.45,"offsetY":0},{"level":2,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.435,"offsetY":0},{"level":3,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.435,"offsetY":0}]},{"id":"1","file":"artist","buttonX":176,"buttonY":-53,"decorations":[{"level":1,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0},{"level":2,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0},{"level":3,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0}]},{"id":"2","file":"cafe","buttonX":-160,"buttonY":149,"decorations":[{"level":1,"x":519,"y":609,"width":496,"height":335,"offsetX":0.33,"offsetY":0},{"level":2,"x":519,"y":609,"width":496,"height":335,"offsetX":0.417,"offsetY":0},{"level":3,"x":519,"y":609,"width":496,"height":335,"offsetX":0.417,"offsetY":0}]},{"id":"3","file":"eiffel","buttonX":-179,"buttonY":-19,"decorations":[{"level":1,"x":540,"y":8,"width":508,"height":446,"offsetX":0.368,"offsetY":0},{"level":2,"x":540,"y":8,"width":508,"height":446,"offsetX":0.364,"offsetY":0},{"level":3,"x":540,"y":8,"width":508,"height":446,"offsetX":0.364,"offsetY":0}]},{"id":"4","file":"girl","buttonX":184,"buttonY":139,"decorations":[{"level":1,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.396,"offsetY":0},{"level":2,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.39,"offsetY":0},{"level":3,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.398,"offsetY":0}]}]},{"id":"1","name":"New York","decorationKey":"new-york","decorationConfigs":[{"id":"0","file":"taxi","buttonX":-75,"buttonY":-40,"decorations":[{"level":1,"x":991,"y":149,"width":423,"height":309,"offsetX":0.4822695035,"offsetY":0},{"level":2,"x":991,"y":149,"width":423,"height":309,"offsetX":0.4468085106,"offsetY":0},{"level":3,"x":991,"y":149,"width":423,"height":309,"offsetX":0.451536643,"offsetY":0}]},{"id":"1","file":"building","buttonX":88,"buttonY":-105,"decorations":[{"level":1,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0},{"level":2,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0},{"level":3,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0}]},{"id":"2","file":"man","buttonX":-47,"buttonY":62,"decorations":[{"level":1,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.2115384615,"offsetY":0},{"level":2,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.3557692308,"offsetY":0},{"level":3,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.3461538462,"offsetY":0}]},{"id":"3","file":"hotdog","buttonX":-187,"buttonY":127,"decorations":[{"level":1,"x":370,"y":300,"width":554,"height":614,"offsetX":0.463898917,"offsetY":0},{"level":2,"x":370,"y":300,"width":554,"height":614,"offsetX":0.4314079422,"offsetY":0},{"level":3,"x":370,"y":300,"width":554,"height":614,"offsetX":0.5,"offsetY":0}]},{"id":"4","file":"girl","buttonX":186,"buttonY":143,"decorations":[{"level":1,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3639344262,"offsetY":0},{"level":2,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3836065574,"offsetY":0},{"level":3,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3737704918,"offsetY":0}]}]},{"id":"2","name":"Venice","decorationKey":"venice","decorationConfigs":[{"id":"0","file":"palace","buttonX":202,"buttonY":-61,"decorations":[{"level":1,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0},{"level":2,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0},{"level":3,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0}]},{"id":"1","file":"mask","buttonX":-217,"buttonY":1,"decorations":[{"level":1,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0},{"level":2,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0},{"level":3,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0}]},{"id":"2","file":"girl","buttonX":191,"buttonY":119,"decorations":[{"level":1,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0},{"level":2,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0},{"level":3,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0}]},{"id":"3","file":"bridge","buttonX":11,"buttonY":59,"decorations":[{"level":1,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0},{"level":2,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0},{"level":3,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0}]},{"id":"4","file":"man","buttonX":-105,"buttonY":149,"decorations":[{"level":1,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0},{"level":2,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0},{"level":3,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0}]}]}]'),IF=JSON.parse('[{"worldNumber":0,"name":"Paris","previewKey":"location-previews","previewFrame":"Paris","backgroundKey":"Paris","backgroundFile":"./assets/images/new-stage/Paris.jpg","decorationKey":"paris","decorationFiles":["arc","artist","cafe","eiffel","girl"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"},{"worldNumber":1,"name":"New York","previewKey":"location-previews","previewFrame":"New York","backgroundKey":"New York","backgroundFile":"./assets/images/new-stage/NewYork.jpg","decorationKey":"new-york","decorationFiles":["building","girl","hotdog","man","taxi"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"},{"worldNumber":2,"name":"Venice","previewKey":"location-previews","previewFrame":"Venice","backgroundKey":"Venice","backgroundFile":"./assets/images/new-stage/Venice.jpg","decorationKey":"venice","decorationFiles":["girl","man","mask","palace","bridge"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"}]'),OF=PF,RF=IF[0],BF=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=GameCore.Configs.GameDecoration,t.stages=void 0,t.currentStage=RF,t.currentJourneyProgress=void 0,t.defaultInCountryProgress=void 0,t.decorationLocationConfigs=void 0,t}(0,f.Z)(t,e);var n=t.prototype;return n.init=function(){var e=this.config,t=e.Enable,n=e.MaxLocations;t&&(this.stages=IF.slice(0,n),this.decorationLocationConfigs=OF,this.initDefaultInProgressLocation())},n.initDefaultInProgressLocation=function(){var e=RF.decorationFiles.map((function(e,t){return{id:t.toString(),locationId:RF.worldNumber.toString(),name:e,level:0}})),t={id:RF.worldNumber.toString(),name:RF.name,progress:0,decorations:e};this.defaultInCountryProgress=t},n.initData=function(){this.initJourneyProgress()},n.initJourneyProgress=function(){if(this.currentJourneyProgress=this.game.player.getJourneyProgress(),this.currentJourneyProgress||(this.currentJourneyProgress={currentLocationIndex:-1,inProgressLocation:void 0,finishedLocationIds:[]}),!this.currentJourneyProgress.inProgressLocation||this.currentJourneyProgress.currentLocationIndex<0){var e=this.stages[0].decorationFiles.map((function(e,t){return{id:t.toString(),locationId:(0).toString(),name:e,level:0}})),t={id:this.stages[0].worldNumber.toString(),name:this.stages[0].name,progress:0,decorations:e};this.updateJourneyProgress({currentLocationIndex:0,inProgressLocation:t})}this.checkActualProgress()},n.checkActualProgress=function(){if(!this.currentJourneyProgress.inProgressLocation)return 0;var e=this.currentJourneyProgress.inProgressLocation.decorations,t=0;e.forEach((function(e){t+=e.level}));var n=(0,p.Z)({},this.currentJourneyProgress,{inProgressLocation:(0,p.Z)({},this.currentJourneyProgress.inProgressLocation,{progress:t})});return this.updateJourneyProgress(n),t},n.getAllStages=function(){return this.stages},n.getCurrentStage=function(){if(this.currentJourneyProgress){var e=this.currentJourneyProgress,t=e.inProgressLocation,n=e.currentLocationIndex;if(t&&(this.currentStage=this.stages[n],this.currentStage))return this.currentStage}return RF},n.getNextStage=function(){if(this.currentJourneyProgress){var e=this.currentJourneyProgress.currentLocationIndex+1;if(e<this.stages.length)return this.stages[e]}},n.getInProgressLocation=function(){return this.currentJourneyProgress.inProgressLocation||this.initJourneyProgress(),this.currentJourneyProgress.inProgressLocation?this.currentJourneyProgress.inProgressLocation:this.defaultInCountryProgress},n.getCurrentDecorationLocationConfigs=function(){var e=this.getInProgressLocation(),t=this.decorationLocationConfigs.find((function(t){return t.name===e.name}));return t||this.decorationLocationConfigs[0]},n.updateDecorationData=function(e,t){var n=this.game.player.getJourneyProgress(),i=JSON.parse(JSON.stringify(n)),r=i.inProgressLocation,a=i.currentLocationIndex;if(r){var s=r.decorations.find((function(t){return t.id===e}));s&&(s.level=t),r.progress=r.decorations.reduce((function(e,t){return e+t.level}),0),this.updateJourneyProgress({inProgressLocation:r}),this.game.analytics.event(ae._.DECORATION_UPGRADED,{level:this.game.player.getLevel(),name:this.stages[a].name,progress:r.progress})}},n.updateToNextLocation=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)),n=t.inProgressLocation,i=t.currentLocationIndex,r=t.finishedLocationIds;if(n&&this.isCurrentLocationCompleted()){var a=[].concat(r,[n.id]),s=i+1;if(s<this.stages.length){var o=this.stages[s],c=o.decorationFiles.map((function(e,t){return{id:t.toString(),locationId:o.worldNumber.toString(),name:e,level:0}})),h={id:o.worldNumber.toString(),name:o.name,progress:0,decorations:c};this.updateJourneyProgress({currentLocationIndex:s,inProgressLocation:h,finishedLocationIds:a})}else this.updateJourneyProgress({inProgressLocation:void 0,currentLocationIndex:-1,finishedLocationIds:a})}},n.isCurrentLocationCompleted=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)).inProgressLocation;if(!t)return!1;var n=t.progress>=3*t.decorations.length;return n},n.clearDecorationData=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)).inProgressLocation;t&&(t.decorations=t.decorations.map((function(e){return(0,p.Z)({},e,{level:0})})),t.progress=0,this.updateJourneyProgress({inProgressLocation:t}))},n.resetJourneyProgressToDefault=function(){var e=this,t={currentLocationIndex:0,finishedLocationIds:[],inProgressLocation:{id:this.stages[0].worldNumber.toString(),name:this.stages[0].name,progress:0,decorations:this.stages[0].decorationFiles.map((function(t,n){return{id:n.toString(),locationId:e.stages[0].worldNumber.toString(),name:t,level:0}}))}};this.updateJourneyProgress(t)},n.updateJourneyProgress=function(e){var t=this.game.player.getJourneyProgress(),n=(0,p.Z)({},t,e);this.currentJourneyProgress=n,this.game.player.updateJourneyProgress(n)},t}(Phaser.Plugins.BasePlugin),DF=function(e){function t(t){var n;return(n=e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\nuniform vec3 blendColor;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main()\n{\n    vec4 texture;\n    vec3 blendRGB = blendColor;\n\n    %forloop%\n    \n    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);\n    gl_FragColor = texture;\n    vec3 baseRGB = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n\n    vec3 baseHSV = rgb2hsv(baseRGB);\n\n    vec3 resultHSV = vec3(blendColor.xy, baseHSV.z * 1.35);\n    vec3 resultRGB = hsv2rgb(resultHSV);\n\n    gl_FragColor = vec4(resultRGB, gl_FragColor.a);\n}",uniforms:["uProjectionMatrix","uMainSampler","gray","blendColor"]})||this).gray=void 0,n.gray=1,n}return(0,f.Z)(t,e),t.prototype.onPreRender=function(){this.set1f("gray",this.gray),this.set3f("blendColor",19/360,.45,.6471)},t}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline),LF=["Enable"],MF=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var r=t.prototype;return r.boot=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),t.next=3,this.requestFullscreenAsync();case 3:return this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=8,this.addDevPlugins();case 8:return t.next=10,this.initAdsAsync();case 10:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.initProfilerPlugin(),this.initAdaptivePerformance(),this.initWeeklyTournament(),this.initBoxingDuel(),this.initOffshoreRace();case 27:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.requestFullscreenAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.RequestFullScreenBeforeStart){e.next=7;break}if(!GameCore.Utils.Device.isDesktop()){e.next=3;break}return e.abrupt("return");case 3:return t=document.getElementById("app"),e.next=6,new Promise((function(e){document.addEventListener("click",(function t(){document.removeEventListener("click",t),e(void 0)}))}));case 6:t&&t.requestFullscreen();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.start=function(){e.prototype.start.call(this)},r.addExtraGameObjectMethods=function(){var e=new b(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetDefaultWorldSize(),e.addSetScaleByWorld(),e.customGameObject(),e.customSpineGameObject(),e.addCustomNineSlice(),e.customTween(),e.customTimeline(),e.customBitmapText()},r.addExtraFBInstantFunctions=function(){var e=new m.Z(this.facebook);this.facebook.getLocale=e.getLocale,this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,e.injectTournament(),this.facebook.progressLoading=new y(this)},r.addPlugins=function(){this.plugins.install("Storage",io,!0,"storage"),this.plugins.install("Rollbar",Ya,!0,"rollbar"),this.plugins.install("AdsManager",N,!0,"ads"),this.plugins.install("AuthManager",re,!0,"auth"),this.plugins.install("AudioManager",V,!0,"audio"),this.plugins.install("WorldManager",Zo,!0,"world"),this.plugins.install("PlayerManager",Ea,!0,"player"),this.plugins.install("ProfileManager",Ra,!0,"profile"),this.plugins.install("LanguageManager",jo,!0,"lang"),this.plugins.install("AnalyticsManager",U,!0,"analytics"),this.plugins.install("AdaptivePerformance",vr,!0,"performance"),this.plugins.install("LevelManager",gF,!0,"level"),this.plugins.install("ThemeManager",vo,!0,"theme"),this.plugins.install("VisibilityChangeHandler",wo,!0,"visibility"),this.plugins.install("LifeManager",yF,!0,"life"),this.plugins.install("JourneyManager",BF,!0,"journey"),this.plugins.install("VibrationManager",CF,!0,"vibration"),this.plugins.install("LeaderboardManager",SF,!0,"leaderboard"),this.plugins.install("ThemeHandler",Eo,!0,"themeHandler"),this.plugins.install("WeeklyTournamentManager",Do,!0,"weeklyTournament"),this.plugins.install("BoxingDuel",Wi,!0,"boxingDuel"),this.plugins.install("OffshoreRace",dr,!0,"offshoreRace"),this.plugins.installScenePlugin("textStyler",co,"textStyler"),this.plugins.installScenePlugin("ScreenManager",Qa,"screen"),this.plugins.installScenePlugin("FrameCapture",zi,"frameCapture"),window.spine&&this.plugins.installScenePlugin("spine.SpinePlugin",window.spine.SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.lang=this.plugins.get("LanguageManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.level=this.plugins.get("LevelManager"),this.vibration=this.plugins.get("VibrationManager"),this.leaderboard=this.plugins.get("LeaderboardManager"),this.weeklyTournament=this.plugins.get("WeeklyTournamentManager"),this.boxingDuel=this.plugins.get("BoxingDuel"),this.offshoreRace=this.plugins.get("OffshoreRace"),this.journey=this.plugins.get("JourneyManager"),this.plugins.install("KawaseBlurFilterPlugin",zo.Z),this.visibility=this.plugins.get("VisibilityChangeHandler")},r.addDevPlugins=function(){var e=(0,i.Z)(a().mark((function e(){var t,i,r,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(7),n.e(942)]).then(n.bind(n,88));case 4:return t=e.sent.default,e.next=7,Promise.all([n.e(498),n.e(739),n.e(530)]).then(n.bind(n,89));case 7:return i=e.sent.default,e.next=10,n.e(401).then(n.bind(n,90));case 10:return r=e.sent.default,e.next=13,Promise.all([n.e(498),n.e(123)]).then(n.bind(n,91));case 13:return s=e.sent.default,e.next=16,Promise.all([n.e(498),n.e(803)]).then(n.bind(n,92));case 16:o=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",r,!0,"statistics"),this.plugins.install("Profiler",s,!0,"profiler"),this.plugins.install("ParticleEditor",o,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.profiler=this.plugins.get("Profiler"),this.particleEditor=this.plugins.get("ParticleEditor");case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.addScenes=function(){this.scene.add(le.C.BOOT_SCENE,$o,!0),this.scene.add(le.C.LOAD_SCENE,eF,!1),this.scene.add(le.C.GAME_SCENE,P_,!1),this.scene.add(le.C.GAME_OVER_SCENE,Xh,!1),this.scene.add(le.C.DASHBOARD_SCENE,nc,!1),this.scene.add(le.C.LEADERBOARD_SCENE,AN,!1),this.scene.add(le.C.RESULT_MATCH_SCENE,dF,!1),this.scene.add(le.C.GLOBAL_SCENE,I_.Z,!1)},r.addDevScenes=function(){var e=(0,i.Z)(a().mark((function e(){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(457).then(n.bind(n,93));case 4:return t=e.sent.default,e.next=7,n.e(270).then(n.bind(n,94));case 7:i=e.sent.default,this.scene.add(le.C.TEST_SCENE,t,!1),this.scene.add(le.C.ANIMATIONS_SCENE,i,!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.initAdsAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=GameCore.Configs.Ads,e.next=3,this.getAdServiceInstance();case 3:(n=e.sent).setGame(this),i=(0,p.Z)({},t.InterstitialAdOptions),this.ads.configure(n,{enabled:t.Enabled,calculateSafeAreaBottom:t.CalculateSafeAreaBottom,enableRewardVideoResetInterstitial:t.EnableRewardVideoResetInterstitial,interstitialAdOptions:i,rewardAdOptions:t.RewardAdOptions,bannerAdOptions:t.BannerAdOptions});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getAdServiceInstance=function(){var e=(0,i.Z)(a().mark((function e(){var t,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,i=t.AdService,!t.Mockup.Enable){e.next=6;break}return e.next=4,n.e(131).then(n.bind(n,95));case 4:return r=e.sent.default,e.abrupt("return",r);case 6:if("google"!==i){e.next=19;break}return e.prev=7,e.next=10,this.initGoogleAdInstanceAsync();case 10:if(null===(s=e.sent)){e.next=13;break}return e.abrupt("return",s);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(7),e.abrupt("return",TF.default);case 19:return e.abrupt("return",TF.default);case 20:case"end":return e.stop()}}),e,this,[[7,15]])})));return function(){return e.apply(this,arguments)}}(),r.initGoogleAdInstanceAsync=function(){var e=(0,i.Z)(a().mark((function e(){var t,n,i,r,s,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loaded"!==xF.default.initStatus){e.next=2;break}return e.abrupt("return",xF.default);case 2:if(t=GameCore.Configs.Ads.AdServiceConfigs.Google){e.next=6;break}return e.abrupt("return",null);case 6:return n=t.DataAdClient,i=t.DataAdChannel,r=t.DataAdBreakTest,s=t.DataAdFrequencyHint,o=t.DataAdHost,c=t.MaxScriptLoadRetryCount,h={dataAdClient:n,dataAdChannel:i,dataAdBreakTest:r,dataAdFrequencyHint:s,dataAdHost:o,maxScriptLoadRetryCount:c},e.prev=8,xF.default.setGame(this),e.next=12,xF.default.initGoogleAdsAsync(h);case 12:return e.abrupt("return",xF.default);case 15:return e.prev=15,e.t0=e.catch(8),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(){return e.apply(this,arguments)}}(),r.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,r=e.PortraitHeight,a=e.LandscapeRatio,s=e.LandscapeWidth,o=e.LandscapeHeight,c=t,h=e.DisableLandscape,u=e.FullSizeOnLandscape,l=n,d=i,p=r,f=a,m=s,g=o;this.world.configure({autoResize:c,portraitRatio:l,portraitWidth:d,portraitHeight:p,landscapeRatio:f,landscapeWidth:m,landscapeHeight:g,disableLandscape:h,fullSizeOnLandscape:u}),this.world.resize(e.ForcePixelRatio)},r.initStorage=function(){var e=new Ho(this);this.storage.setInitiator(e)},r.initLanguage=function(){var e=this.facebook.getLocale();this.lang.configure({locale:e})},r.initVisibilityChangeHandler=function(){this.visibility.configure()},r.initUtils=function(){this.handlePauseAudio(),this.addPipelines(),this.removeUnusedPipelines()},r.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},r.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},r.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},r.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},r.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler.configure())},r.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,d.Z)(e,LF);if(t){var i=this.world.getPixelRatio();this.performance.configure((0,p.Z)({pixelRatio:i},n)),this.performance.active()}},r.initCanvasRecorderPlugin=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.CanvasRecorder;if(t.Enable){var n=t.Options,r=n.Type,s=n.Quality,o=n.RecordFps,c=n.SyncFps;this.canvasRecorder.configure({type:r,quality:s,syncFps:c,recordFps:o});var h=document.querySelector("canvas");if(h){this.canvasRecorder.setCanvas(h);var u=this.canvasRecorder.getOptions(),l=this.canvasRecorder.waitNextFrame;this.canvasRecorder.waitNextFrame=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.syncFps){t.next=5;break}return e.loop.sleep(),t.abrupt("return",new Promise((function(t){e.events.once(Phaser.Core.Events.POST_RENDER,t),e.loop.lastTime=1e3/u.recordFps,e.loop.step()})));case 5:return e.loop.wake(),t.abrupt("return",l.call(e.canvasRecorder));case 7:case"end":return t.stop()}}),t)})))}}}},r.initRollbar=function(){GameCore.Configs.Rollbar.Enable&&this.rollbar.setup()},r.initWeeklyTournament=function(){this.weeklyTournament.configure()},r.initOffshoreRace=function(){this.offshoreRace.configure()},r.initBoxingDuel=function(){this.boxingDuel.configure()},r.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.resumeMusic(),e.audio.resumeAllSounds();try{GameCore.Utils.Device.isIOS()&&e.globalScene.input.once(Phaser.Input.Events.POINTER_DOWN,(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.sound.context.suspend();case 3:return t.next=5,e.sound.context.resume();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))))}catch(t){}})),this.visibility.addEventHidden((function(){e.audio.pauseAllMusics(),e.audio.pauseAllSounds()}))},r.addPipelines=function(){var e=this.renderer;e instanceof Phaser.Renderer.WebGL.WebGLRenderer&&(e.pipelines.add("Grayscale",new kF(this)),e.pipelines.add("LockEffect",new DF(this)))},r.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},t}(Phaser.Game),_F=MF,NF=GameCore.Configs.Debugger.ShowInspector,GF={parent:"game-wrapper",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:NF,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,antialiasGL:!1,transparent:!0,desynchronized:!1,powerPreference:"high-performance",clearBeforeRender:!1,roundPixels:!1,mipmapFilter:"LINEAR_MIPMAP_LINEAR"},plugins:{global:[]},physics:{default:"matter",matter:{gravity:{y:.8},debug:!1}}};(0,l.j6)();var FF=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u();case 3:t=new _F(GF),window.game=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,l.tO)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ZF=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(ZF),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),FF())}),50)},,,function(e,t,n){"use strict";n.r(t);var i=n(5),r=n(0),a=n(4),s=n.n(a),o=n(6),c=n(15),h=GameCore.Utils.Object,u=GameCore.Ads,l=u.Types,d=u.Status,p="msgames",f=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.step=0,i.adNoFillInstances=void 0,i.isHasTwoManyInstances=void 0,i.instanceLoadFailedQueue=void 0,i.isHasTooManyInstancesError=void 0,i.instance=null,i.adNoFillInstances=[],i.isHasTwoManyInstances=!1,i.placementId=n,i.instanceLoadFailedQueue=[],i.isHasTooManyInstancesError=!1,i}(0,r.Z)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.Z)(s().mark((function e(){var t,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===d.IDLE){e.next=2;break}return e.abrupt("return");case 2:return this.step+=1,e.prev=3,this.status=d.LOADING,e.next=7,this.createInstanceByType(this.type);case 7:if(this.instance=e.sent,null!==this.instance){e.next=10;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 10:return e.next=12,this.instance.loadAsync();case 12:this.status=d.FILLED,t=this.getSceneName(),this.type===l.PRE_ROLL&&self.game.analytics.loadPreRollAd(t,p),this.type===l.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(t,p),this.type===l.REWARDED&&self.game.analytics.loadRewardedVideoAd(t,p),e.next=26;break;case 19:throw e.prev=19,e.t0=e.catch(3),this.status=d.IDLE,this.instance&&this.instanceLoadFailedQueue.push(this.instance),this.instance=null,this.isAdTypeValid(this.type)&&(n=this.getSceneName(),i={type:this.type,placement:n,adService:p},self.game.analytics.loadAdFail(i)),e.t0;case 26:case"end":return e.stop()}}),e,this,[[3,19]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.Z)(s().mark((function e(){var t,n,i,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,null,e.prev=2,this.status===d.FILLED){e.next=5;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 5:if(this.status=d.SHOWING,null!==this.instance){e.next=8;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 8:return this.isHasTooManyInstancesError&&self.game.analytics.event(o._.MISSING_AD_SHOW,{ad_type:this.type}),e.next=11,this.instance.showAsync();case 11:t=!0,this.status=d.IDLE,this.instance=null,e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(2),e.t0 instanceof Object&&h.hasOwn(e.t0,"code")?("ADS_NOT_LOADED"===e.t0.code?this.status=d.FILLED:(this.status=d.IDLE,this.instance=null),"USER_INPUT"===e.t0.code&&(this.status=d.IDLE,this.instance=null,t=!0)):(this.status=d.IDLE,this.instance=null),e.t0,e.t0;case 21:return e.prev=21,window.focus(),n=this.getSceneName(),t?(this.type===l.PRE_ROLL&&self.game.analytics.showPreRollAd(n,p),this.type===l.INTERSTITIAL&&self.game.analytics.showInterstitialAd(n,p),this.type===l.REWARDED&&self.game.analytics.showRewardedVideoAd(n,p)):this.isAdTypeValid(this.type)&&(i=this.getSceneName(),r={type:this.type,placement:i,adService:p},self.game.analytics.showAdFail(r)),e.finish(21);case 26:case"end":return e.stop()}}),e,this,[[2,16,21,26]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.prev=1,e.t0=t,e.next=e.t0===l.REWARDED?5:e.t0===l.INTERSTITIAL||e.t0===l.PRE_ROLL?8:11;break;case 5:return e.next=7,n.getRewardedVideoAsync(this.placementId);case 7:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,n.getInterstitialAdAsync(this.placementId);case 11:case 20:return e.abrupt("return",null);case 12:e.next=21;break;case 14:if(e.prev=14,e.t1=e.catch(1),!(e.t1 instanceof Object&&h.hasOwn(e.t1,"code"))){e.next=20;break}if("ADS_TOO_MANY_INSTANCES"!==e.t1.code){e.next=20;break}return this.isHasTooManyInstancesError=!0,e.abrupt("return",this.instanceLoadFailedQueue.shift()||null);case 21:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof c.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},n.isAdTypeValid=function(e){return Object.values(l).includes(e)},t}(GameCore.Ads.AdInstance);t.default=f},function(e,t,n){"use strict";n.r(t);var i,r=n(5),a=n(2),s=n(1),o=n(0),c=n(4),h=n.n(c),u=n(6),l=n(15),d=GameCore,p=d.Utils.Object,f=d.Ads,m=f.Types,g=f.Status,v="not-loaded",y="loading",E="loaded",C="google",w=function(e){function t(n,i){var r;return(r=e.call(this,n)||this).instance=void 0,r.instance=null,r.status=g.IDLE,window.setInterstitialPlacementType=t.setInterstitialPlacementType,window.setRewardedPlacementType=t.setRewardedPlacementType,window.setPreRollPlacementType=t.setPreRollPlacementType,t.childAdInstances.push((0,s.Z)(r)),t.isPreloadConfigReady&&(r.status=g.FILLED),r}(0,o.Z)(t,e),t.initGoogleAdsAsync=function(){var e=(0,r.Z)(h().mark((function e(n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loaded"!==t.initStatus){e.next=3;break}return e.abrupt("return");case 3:t._initStatus=y,t.adsByGoogleConfig=n,t.loadScriptElementAsync(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.configGoogleAdsOnInit=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.adsbygoogle=window.adsbygoogle||[],window.adBreak=function(e){adsbygoogle.push(e)},window.adConfig=function(e){adsbygoogle.push(e)},t._initStatus=E,t.runPreloadAdConfig();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.runPreloadAdConfig=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preloadPromise=new Promise((function(e,n){window.adConfig({preloadAdBreaks:"on",onReady:function(){t.isPreloadConfigReady=!0,t.handlePostPreloadAdComplete(),e()}}),setTimeout((function(){t.isPreloadConfigReady||n(new Error("Failed to preload ad config in time."))}),1e4)})),e.abrupt("return",t.preloadPromise);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.loadScriptElementAsync=function(e){return new Promise((function(n,i){!function r(a){var s=e.maxScriptLoadRetryCount,o=document.createElement("script");try{t.assignAdsByGoogleScriptProperties(o,e)}catch(h){t._initStatus=v,i(new Error("Invalid adConfig."))}if(o.onload=function(){t.configGoogleAdsOnInit(),n(!0)},o.onerror=function(){a<s?setTimeout((function(){r(a+1)}),12e4):(t._initStatus=v,i(new Error("Failed to load Google Ads script.")))},document.head.appendChild(o),!!!document.getElementById("adsByGoogleFunctionScript")){var c=document.createElement("script");c.text="window.adsbygoogle = window.adsbygoogle || []; var adBreak = adConfig = function(o) {adsbygoogle.push(o);}",c.id="adsByGoogleFunctionScript",document.head.appendChild(c)}}(0)}))},t.assignAdsByGoogleScriptProperties=function(e,t){var n=t.dataAdClient,i=t.dataAdHost,r=t.dataAdChannel,a=t.dataAdBreakTest,s=t.dataAdFrequencyHint;if(!n&&!i)throw new Error("dataAdClient or dataAdHost is required.");e.async=!0,e.setAttribute("data-ad-frequency-hint",s+"s"),n&&e.setAttribute("data-ad-client",n),r&&e.setAttribute("data-ad-channel",r),i&&e.setAttribute("data-ad-host",i),a&&e.setAttribute("data-adbreak-test","on");var o="";if(n||i){o="?";var c=[];n&&c.push("client="+n),i&&c.push("host="+i),o+=c.join("&")}e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"+o,e.crossOrigin="anonymous"};var n=t.prototype;return n.makeAdInstance=function(){var e=this;return{getPlacementID:function(){return""},loadAsync:function(){return e.preloadAdPlacement()},showAsync:function(){return e.createAdPlacement()}}},n.preloadAdPlacement=function(){return t._initStatus!==E?Promise.reject(new Error("Google Ads not initiated.")):t.isPreloadConfigReady?Promise.resolve():t.preloadPromise?t.preloadPromise:t.runPreloadAdConfig()},n.createAdPlacement=function(){switch(this.type){case m.PRE_ROLL:return this.createAdPlacementPreroll();case m.REWARDED:return this.createAdPlacementRewarded();case m.INTERSTITIAL:return this.createAdPlacementInterstitial();default:return Promise.reject(new GameCore.Ads.AdError("UNSUPPORTED_AD_TYPE","Unsupported."))}},n.createAdPlacementPreroll=function(){return new Promise((function(e,n){window.adBreak({type:t.preRollPlacementType,name:"prerollAd",adBreakDone:function(t){switch(t.breakStatus){case"dismissed":case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},n.createAdPlacementInterstitial=function(){return new Promise((function(e,n){window.adBreak({type:t.interstitialPlacementType,name:"interstitialAd",beforeAd:function(){self.game.ads.hideBannerAdAsync()},adBreakDone:function(t){switch(self.game.ads.showBannerAdAsync(),t.breakStatus){case"dismissed":case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},n.createAdPlacementRewarded=function(){return new Promise((function(e,n){window.adBreak({type:t.rewardedPlacementType,name:"rewardedAd",beforeReward:function(e){self.game.ads.hideBannerAdAsync(),e()},adViewed:function(){},adDismissed:function(){},adBreakDone:function(t){switch(self.game.ads.showBannerAdAsync(),t.breakStatus){case"dismissed":return void n(new GameCore.Ads.AdError("USER_INPUT","User dismissed."));case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},t.setGame=function(e){self.game=e},n.getStatus=function(){return this.status},n.loadAsync=function(){var e=(0,r.Z)(h().mark((function e(){var n,i,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.isPreloadConfigReady&&null==this.instance){e.next=3;break}return e.abrupt("return");case 3:if(this.instance=this.makeAdInstance(),null!==this.instance){e.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return e.next=8,this.instance.loadAsync();case 8:n=this.getSceneName(),this.type===m.PRE_ROLL&&self.game.analytics.loadPreRollAd(n,C),this.type===m.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(n,C),this.type===m.REWARDED&&self.game.analytics.loadRewardedVideoAd(n,C),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),this.isAdTypeValid(this.type)&&(i=this.getSceneName(),r={type:this.type,placement:i,adService:C},self.game.analytics.loadAdFail(r)),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,r.Z)(h().mark((function e(){var t,n,i,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,e.prev=1,this.status===g.FILLED){e.next=4;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 4:if(this.status=g.SHOWING,null!==this.instance){e.next=8;break}return e.next=8,this.loadAsync();case 8:if(null!==this.instance){e.next=10;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 10:return e.next=12,this.instance.showAsync();case 12:t=!0,this.handlePostShowAdStatus(),this.instance=null,e.next=27;break;case 17:if(e.prev=17,e.t0=e.catch(1),!(e.t0 instanceof Object&&p.hasOwn(e.t0,"code"))){e.next=24;break}if("noAdPreloaded"!==e.t0.code){e.next=22;break}return e.abrupt("return");case 22:"USER_INPUT"===e.t0.code&&(t=!0),"frequencyCapped"===e.t0.code&&self.game.analytics.event(u._.MISSING_AD_SHOW,{ad_type:this.type});case 24:throw this.handlePostShowAdStatus(),this.instance=null,e.t0;case 27:return e.prev=27,window.focus(),n=this.getSceneName(),t?(this.type===m.PRE_ROLL&&self.game.analytics.showPreRollAd(n,C),this.type===m.INTERSTITIAL&&self.game.analytics.showInterstitialAd(n,C),this.type===m.REWARDED&&self.game.analytics.showRewardedVideoAd(n,C)):this.isAdTypeValid(this.type)&&(i=this.getSceneName(),r={type:this.type,placement:i,adService:C},self.game.analytics.showAdFail(r)),e.finish(27);case 32:case"end":return e.stop()}}),e,this,[[1,17,27,32]])})));return function(){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof l.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},n.isAdTypeValid=function(e){return Object.values(m).includes(e)},n.handlePostShowAdStatus=function(){t.isPreloadConfigReady?this.status=g.FILLED:this.status=g.IDLE},t.handlePostPreloadAdComplete=function(){t.childAdInstances.forEach((function(e){e.status=g.FILLED}))},(0,a.Z)(t,null,[{key:"initStatus",get:function(){return t._initStatus}}]),t}(GameCore.Ads.AdInstance);i=w,w.childAdInstances=[],w._initStatus=v,w.isPreloadConfigReady=!1,w.adsByGoogleConfig=void 0,w.preloadPromise=void 0,w.preRollPlacementType="preroll",w.interstitialPlacementType="next",w.rewardedPlacementType="reward",w.setInterstitialPlacementType=function(e){i.interstitialPlacementType=e},w.setRewardedPlacementType=function(e){i.rewardedPlacementType=e},w.setPreRollPlacementType=function(e){i.preRollPlacementType=e},t.default=w},function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=JSON.parse('{"data":["Smith","Johnson","Williams","Brown","Jones","Miller","Davis","Garcia","Rodriguez","Wilson","Martinez","Anderson","Taylor","Thomas","Hernandez","Moore","Martin","Jackson","Thompson","White","Lopez","Lee","Gonzalez","Harris","Clark","Lewis","Robinson","Walker","Perez","Hall","Young","Allen","Sanchez","Wright","King","Scott","Green","Baker","Adams","Nelson","Hill","Ramirez","Campbell","Mitchell","Roberts","Carter","Phillips","Evans","Turner","Torres","Parker","Collins","Edwards","Stewart","Flores","Morris","Nguyen","Murphy","Rivera","Cook","Rogers","Morgan","Peterson","Cooper","Reed","Bailey","Bell","Gomez","Kelly","Howard","Ward","Cox","Diaz","Richardson","Wood","Watson","Brooks","Bennett","Gray","James","Reyes","Cruz","Hughes","Price","Myers","Long","Foster","Sanders","Ross","Morales","Powell","Sullivan","Russell","Ortiz","Jenkins","Gutierrez","Perry","Butler","Barnes","Fisher","Henderson","Coleman","Simmons","Patterson","Jordan","Reynolds","Hamilton","Graham","Kim","Gonzales","Alexander","Ramos","Wallace","Griffin","West","Cole","Hayes","Chavez","Gibson","Bryant","Ellis","Stevens","Murray","Ford","Marshall","Owens","Mcdonald","Harrison","Ruiz","Kennedy","Wells","Alvarez","Woods","Mendoza","Castillo","Olson","Webb","Washington","Tucker","Freeman","Burns","Henry","Vasquez","Snyder","Simpson","Crawford","Jimenez","Porter","Mason","Shaw","Gordon","Wagner","Hunter","Romero","Hicks","Dixon","Hunt","Palmer","Robertson","Black","Holmes","Stone","Meyer","Boyd","Mills","Warren","Fox","Rose","Rice","Moreno","Schmidt","Patel","Ferguson","Nichols","Herrera","Medina","Ryan","Fernandez","Weaver","Daniels","Stephens","Gardner","Payne","Kelley","Dunn","Pierce","Arnold","Tran","Spencer","Peters","Hawkins","Grant","Hansen","Castro","Hoffman","Hart","Elliott","Cunningham","Knight","Bradley","Carroll","Hudson","Duncan","Armstrong","Berry","Andrews","Johnston","Ray","Lane","Riley","Carpenter","Perkins","Aguilar","Silva","Richards","Willis","Matthews","Chapman","Lawrence","Garza","Vargas","Watkins","Wheeler","Larson","Carlson","Harper","George","Greene","Burke","Guzman","Morrison","Munoz","Jacobs","Obrien","Lawson","Franklin","Lynch","Bishop","Carr","Salazar","Austin","Mendez","Gilbert","Jensen","Williamson","Montgomery","Harvey","Oliver","Howell","Dean","Hanson","Weber","Garrett","Sims","Burton","Fuller","Soto","Mccoy","Welch","Chen","Schultz","Walters","Reid","Fields","Walsh","Little","Fowler","Bowman","Davidson","May","Day","Schneider","Newman","Brewer","Lucas","Holland","Wong","Banks","Santos","Curtis","Pearson","Delgado","Valdez","Pena","Rios","Douglas","Sandoval","Barrett","Hopkins","Keller","Guerrero","Stanley","Bates","Alvarado","Beck","Ortega","Wade","Estrada","Contreras","Barnett","Caldwell","Santiago","Lambert","Powers","Chambers","Nunez","Craig","Leonard","Lowe","Rhodes","Byrd","Gregory","Shelton","Frazier","Becker","Maldonado","Fleming","Vega","Sutton","Cohen","Jennings","Parks","Mcdaniel","Watts","Barker","Norris","Vaughn","Vazquez","Holt","Schwartz","Steele","Benson","Neal","Dominguez","Horton","Terry","Wolfe","Hale","Lyons","Graves","Haynes","Miles","Park","Warner","Padilla","Bush","Thornton","Mccarthy","Mann","Zimmerman","Erickson","Fletcher","Mckinney","Page","Dawson","Joseph","Marquez","Reeves","Klein","Espinoza","Baldwin","Moran","Love","Robbins","Higgins","Ball","Cortez","Le","Griffith","Bowen","Sharp","Cummings","Ramsey","Hardy","Swanson","Barber","Acosta","Luna","Chandler","Blair","Daniel","Cross","Simon","Dennis","Oconnor","Quinn","Gross","Navarro","Moss","Fitzgerald","Doyle","Mclaughlin","Rojas","Rodgers","Stevenson","Singh","Yang","Figueroa","Harmon","Newton","Paul","Manning","Garner","Mcgee","Reese","Francis","Burgess","Adkins","Goodman","Curry","Brady","Christensen","Potter","Walton","Goodwin","Mullins","Molina","Webster","Fischer","Campos","Avila","Sherman","Todd","Chang","Blake","Malone","Wolf","Hodges","Juarez","Gill","Farmer","Hines","Gallagher","Duran","Hubbard","Cannon","Miranda","Wang","Saunders","Tate","Mack","Hammond","Carrillo","Townsend","Wise","Ingram","Barton","Mejia","Ayala","Schroeder","Hampton","Rowe","Parsons","Frank","Waters","Strickland","Osborne","Maxwell","Chan","Deleon","Norman","Harrington","Casey","Patton","Logan","Bowers","Mueller","Glover","Floyd","Hartman","Buchanan","Cobb","French","Kramer","Mccormick","Clarke","Tyler","Gibbs","Moody","Conner","Sparks","Mcguire","Leon","Bauer","Norton","Pope","Flynn","Hogan","Robles","Salinas","Yates","Lindsey","Lloyd","Marsh","Mcbride","Owen","Solis","Pham","Lang","Pratt","Lara","Brock","Ballard","Trujillo","Shaffer","Drake","Roman","Aguirre","Morton","Stokes","Lamb","Pacheco","Patrick","Cochran","Shepherd","Cain","Burnett","Hess","Li","Cervantes","Olsen","Briggs","Ochoa","Cabrera","Velasquez","Montoya","Roth","Meyers","Cardenas","Fuentes","Weiss","Hoover","Wilkins","Nicholson","Underwood","Short","Carson","Morrow","Colon","Holloway","Summers","Bryan","Petersen","Mckenzie","Serrano","Wilcox","Carey","Clayton","Poole","Calderon","Gallegos","Greer","Rivas","Guerra","Decker","Collier","Wall","Whitaker","Bass","Flowers","Davenport","Conley","Houston","Huff","Copeland","Hood","Monroe","Massey","Roberson","Combs","Franco","Larsen","Pittman","Randall","Skinner","Wilkinson","Kirby","Cameron","Bridges","Anthony","Richard","Kirk","Bruce","Singleton","Mathis","Bradford","Boone","Abbott","Charles","Allison","Sweeney","Atkinson","Horn","Jefferson","Rosales","York","Christian","Phelps","Farrell","Castaneda","Nash","Dickerson","Bond","Wyatt","Foley","Chase","Gates","Vincent","Mathews","Hodge","Garrison","Trevino","Villarreal","Heath","Dalton","Valencia","Callahan","Hensley","Atkins","Huffman","Roy","Boyer","Shields","Lin","Hancock","Grimes","Glenn","Cline","Delacruz","Camacho","Dillon","Parrish","Oneill","Melton","Booth","Kane","Berg","Harrell","Pitts","Savage","Wiggins","Brennan","Salas","Marks","Russo","Sawyer","Baxter","Golden","Hutchinson","Liu","Walter","Mcdowell","Wiley","Rich","Humphrey","Johns","Koch","Suarez","Hobbs","Beard","Gilmore","Ibarra","Keith","Macias","Khan","Andrade","Ware","Stephenson","Henson","Wilkerson","Dyer","Mcclure","Blackwell","Mercado","Tanner","Eaton","Clay","Barron","Beasley","Oneal","Preston","Small","Wu","Zamora","Macdonald","Vance","Snow","Mcclain","Stafford","Orozco","Barry","English","Shannon","Kline","Jacobson","Woodard","Huang","Kemp","Mosley","Prince","Merritt","Hurst","Villanueva","Roach","Nolan","Lam","Yoder","Mccullough","Lester","Santana","Valenzuela","Winters","Barrera","Leach","Orr","Berger","Mckee","Strong","Conway","Stein","Whitehead","Bullock","Escobar","Knox","Meadows","Solomon","Velez","Odonnell","Kerr","Stout","Blankenship","Browning","Kent","Lozano","Bartlett","Pruitt","Buck","Barr","Gaines","Durham","Gentry","Mcintyre","Sloan","Melendez","Rocha","Herman","Sexton","Moon","Hendricks","Rangel","Stark","Lowery","Hardin","Hull","Sellers","Ellison","Calhoun","Gillespie","Mora","Knapp","Mccall","Morse","Dorsey","Weeks","Nielsen","Livingston","Leblanc","Mclean","Bradshaw","Glass","Middleton","Buckley","Schaefer","Frost","Howe","House","Mcintosh","Ho","Pennington","Reilly","Hebert","Mcfarland","Hickman","Noble","Spears","Conrad","Arias","Galvan","Velazquez","Huynh","Frederick","Randolph","Cantu","Fitzpatrick","Mahoney","Peck","Villa","Michael","Donovan","Mcconnell","Walls","Boyle","Mayer","Zuniga","Giles","Pineda","Pace","Hurley","Mays","Mcmillan","Crosby","Ayers","Case","Bentley","Shepard","Everett","Pugh","David","Mcmahon","Dunlap","Bender","Hahn","Harding","Acevedo","Raymond","Blackburn","Duffy","Landry","Dougherty","Bautista","Shah","Potts","Arroyo","Valentine","Meza","Gould","Vaughan","Fry","Rush","Avery","Herring","Dodson","Clements","Sampson","Tapia","Bean","Lynn","Crane","Farley","Cisneros","Benton","Ashley","Mckay","Finley","Best","Blevins","Friedman","Moses","Sosa","Blanchard","Huber","Frye","Krueger","Bernard","Rosario","Rubio","Mullen","Benjamin","Haley","Chung","Moyer","Choi","Horne","Yu","Woodward","Ali","Nixon","Hayden","Rivers","Estes","Mccarty","Richmond","Stuart","Maynard","Brandt","Oconnell","Hanna","Sanford","Sheppard","Church","Burch","Levy","Rasmussen","Coffey","Ponce","Faulkner","Donaldson","Schmitt","Novak","Costa","Montes","Booker","Cordova","Waller","Arellano","Maddox","Mata","Bonilla","Stanton","Compton","Kaufman","Dudley","Mcpherson","Beltran","Dickson","Mccann","Villegas","Proctor","Hester","Cantrell","Daugherty","Cherry","Bray","Davila","Rowland","Levine","Madden","Spence","Good","Irwin","Werner","Krause","Petty","Whitney","Baird","Hooper","Pollard","Zavala","Jarvis","Holden","Haas","Hendrix","Mcgrath","Bird","Lucero","Terrell","Riggs","Joyce","Mercer","Rollins","Galloway","Duke","Odom","Andersen","Downs","Hatfield","Benitez","Archer","Huerta","Travis","Mcneil","Hinton","Zhang","Hays","Mayo","Fritz","Branch","Mooney","Ewing","Ritter","Esparza","Frey","Braun","Gay","Riddle","Haney","Kaiser","Holder","Chaney","Mcknight","Gamble","Vang","Cooley","Carney","Cowan","Forbes","Ferrell","Davies","Barajas","Shea","Osborn","Bright","Cuevas","Bolton","Murillo","Lutz","Duarte","Kidd","Key","Cooke"]}'),r=function(e){return Math.floor(Math.random()*e)},a=function(){if(!i)return"Unknown";if(!i.data)return"Unknown";var e=i.data;if(!Array.isArray(e))return"Unknown";var t=e.length;return e[r(t)]+" "+e[r(t)]}},function(e,t,n){"use strict";n.d(t,{J:function(){return k},Z:function(){return I}});var i=n(5),r=n(4),a=n.n(r),s=n(6),o=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-add-shortcut");null==n||n.remove(),e()}},c=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},h=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=c('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Add shortcut for this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to add a shortcut.</p>\n        </div>'),r=c('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">No</button>'),s=c('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Yes</button>'),i&&r&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-add-shortcut",i.appendChild(r),i.appendChild(s),document.body.appendChild(i),r.addEventListener("click",o(n)),s.addEventListener("click",o(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canCreateShortcutAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.createShortcutAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){h(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),l=u,d=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-subscribe-bots");null==n||n.remove(),e()}},p=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},f=function(){var e=(0,i.Z)(a().mark((function e(t,n){var i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=p('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Turn on messages from this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to send messages, announcements and more.</p>\n        </div>'),r=p('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Not Now</button>'),s=p('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Turn On</button>'),i&&r&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-subscribe-bots",i.appendChild(r),i.appendChild(s),document.body.appendChild(i),r.addEventListener("click",d(n)),s.addEventListener("click",d(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canSubscribeBotAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.subscribeBotAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){f(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),g=m,v=n(37),y=n(35),E=n(0),C=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="TournamentNotFound",i.message=t||"A Tournament with current context was not found",i.payload=n,i.code="TOURNAMENT_NOT_FOUND",i}return(0,E.Z)(t,e),t}((0,n(36).Z)(Error)),w=n(39),A=GameCore.Configs,b=A.Notification,S=A.AddShortcut,T=A.SubscribeBot,x=b.GameTitle,k=(b.GameImage,function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}()),P=function(){function e(e){var t=this;this.facebook=void 0,this.supportedAPIs=[],this.mockSubscribeBot=void 0,this.mockAddShortcut=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.isCanPlayerMatch=null,this.isCanSubscribeBot=null,this.isCanCreateShortcut=null,this.attemptToAddShortcut=(0,i.Z)(a().mark((function e(){var n,i,r,o,c,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanCreateShortcut&&(S.UseMock?t.isCanCreateShortcut=!0:t.isCanCreateShortcut=t.isSupportedAPI("canCreateShortcutAsync")),t.isCanCreateShortcut){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:if(n=e.t0,!(i=n.lastCallCreateShortcut||0)||!(0,y.Gm)(+i)){e.next=15;break}return e.abrupt("return",!1);case 15:if(!S.UseMock){e.next=21;break}return e.next=18,t.mockAddShortcut.canCreateShortcutAsync();case 18:e.t1=e.sent,e.next=24;break;case 21:return e.next=23,GameSDK.canCreateShortcutAsync();case 23:e.t1=e.sent;case 24:if(r=e.t1,o=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:o}),!r){e.next=49;break}return c=s._.SHORTCUT_CREATE,h=s._.SHORTCUT_CREATE_POPUP,t.isCalledCreateShortcut=!0,window.game.analytics.event(h),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!S.UseMock){e.next=39;break}return e.next=37,t.mockAddShortcut.createShortcutAsync();case 37:e.next=41;break;case 39:return e.next=41,FBInstant.createShortcutAsync();case 41:return window.game.analytics.event(c,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(c,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:case"end":return e.stop()}}),e,null,[[2,52],[31,45]])}))),this.attemptToSubscribeBot=(0,i.Z)(a().mark((function e(){var n,i,r,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanSubscribeBot&&(T.UseMock?t.isCanSubscribeBot=!0:t.isCanSubscribeBot=t.isSupportedAPI("player.canSubscribeBotAsync")),t.isCanSubscribeBot){e.next=6;break}return e.abrupt("return",!1);case 6:if(!T.UseMock){e.next=12;break}return e.next=9,t.mockSubscribeBot.canSubscribeBotAsync();case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,GameSDK.player.canSubscribeBotAsync();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=49;break}return e.next=19,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 19:if(e.t1=e.sent,e.t1){e.next=22;break}e.t1={};case 22:if(n=e.t1,!(i=n.lastCallSubscribeBot)||!(0,y.Gm)(+i)){e.next=26;break}return e.abrupt("return",!1);case 26:return r=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:r}),o=s._.BOT_SUBSCRIBE,c=s._.BOT_SUBSCRIBE_POPUP,t.isCalledSubscribeBot=!0,window.game.analytics.event(c),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!T.UseMock){e.next=39;break}return e.next=37,t.mockSubscribeBot.subscribeBotAsync();case 37:e.next=41;break;case 39:return e.next=41,GameSDK.player.subscribeBotAsync();case 41:return window.game.analytics.event(o,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(o,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:case"end":return e.stop()}}),e,null,[[2,52],[31,45]])}))),this.matchPlayerAsync=function(){var e=(0,i.Z)(a().mark((function e(n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===t.isCanPlayerMatch&&(t.isCanPlayerMatch=t.isSupportedAPI("checkCanPlayerMatchAsync")),t.isCanPlayerMatch){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,GameSDK.matchPlayerAsync(n,i,r);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),this.getTournamentAsync=(0,i.Z)(a().mark((function e(){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.facebook.tournament.getTournamentsAsync();case 2:if(n=e.sent,i=GameSDK.context.getID(),!(r=n.find((function(e){return e.getContextID()===i})))){e.next=7;break}return e.abrupt("return",Promise.resolve(r));case 7:return e.abrupt("return",Promise.reject(new C(null)));case 8:case"end":return e.stop()}}),e)}))),this.requestTournamentAsync=function(){var e=(0,i.Z)(a().mark((function e(n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=GameSDK.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.isSupportedAPI=function(e){return 0===t.supportedAPIs.length&&(t.supportedAPIs=GameSDK.getSupportedAPIs()),t.supportedAPIs.includes(e)},this.facebook=e,this.mockSubscribeBot=new g,this.mockAddShortcut=new l}var t=e.prototype;return t.switchAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return e.next=4,GameSDK.context.switchAsync(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.chooseAsync=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var r=e.getName();if(r){var a=e.getPhoto();i.push(new v.Z(n,r,a).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,r=t.template,s=t.cta,o=t.text,c={data:n,image:i,action:"CUSTOM",template:r,cta:s,text:o,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,GameSDK.updateAsync(c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return GameSDK.context.getID()},t.setLoadingProgress=function(e){GameSDK.setLoadingProgress(e)},t.getLocale=function(){return GameSDK.getLocale()||"en"},t.injectTournament=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=8;break}return e.next=4,n.e(545).then(n.bind(n,96));case 4:t=e.sent.default,this.facebook.tournament=new t,e.next=9;break;case 8:this.facebook.tournament=new k;case 9:this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.message,i=t.delayTime,r=t.type,e.next=5,FBInstant.scheduleNotificationAsync({title:x,minDelayInSeconds:i,description:n,type:null!=r?r:w.Z.GENERIC_NOTIFICATION});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}(),I=P},,function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],duration:400,ease:n(16).Z,props:{scale:"+=0.1"}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e,t){"use strict";t.Z={RETURN_PILE:"return-pile",MOVE_TO_WASTE:"move-to-waste",MOVE_COMPLETED:"move-completed",START_LEVEL:"start-level",BOOSTER_SELECTED:"booster-selected",COLLECT_CARD:"collect-card",UNDO:"undo"}},function(e,t,n){"use strict";var i=n(5),r=n(4),a=n.n(r),s=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.time.delayedCall(n,e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.Z=s},function(e,t,n){"use strict";var i=n(2),r=n(1),a=n(0),s=n(6),o=n(9),c=function(e){function t(t,n,i,a){var s;return void 0===a&&(a=.925),(s=e.call(this,t)||this).isClicked=!1,s.parentName=void 0,s.disable=void 0,s.scaleDown=void 0,s.handlePointerDown=function(){s.isClicked||(s.isClicked=!0,s.onPointerDown())},s.handleOnClick=function(e){return function(){s.isClicked&&(s.isClicked=!1,s.onPointerUp(),s.logButtonEvent(),s.addDebugData(),e())}},s.handlePointerOut=function(){s.isClicked&&(s.isClicked=!1,s.onCancel())},s.scaleDown=a,s.setSize(n,i),s.listenEvents(),s.scene.add.existing((0,r.Z)(s)),s}(0,a.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)},n.onPointerDown=function(){this.animButtonDown()},n.onPointerUp=function(){this.animButtonUp()},n.onCancel=function(){this.animButtonUp()},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this,scale:this.scaleDown,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this,scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(t){e.disable&&(t.remove(),e.setScale(1))},onUpdate:function(t){e.disable&&(t.remove(),e.setScale(1))}})},n.setDisabled=function(e){this.disable!=e&&(this.disable=e,e?this.disableInteractive():this.setInteractive({useHandCursor:!0}))},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,o.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e))}}]),t}(Phaser.GameObjects.Container);t.Z=c},function(e,t,n){"use strict";var i=n(0),r=function(e){function t(t,n){var i,r=n.key,a=n.frame,s=n.width,o=n.height,c=n.usePixelPerfect;(i=e.call(this,t,r,a,s,o,c)||this).paddingZone=void 0,i.showDebugZone=void 0,i.debugZone=void 0;var h=n.paddingZone,u=void 0===h?0:h,l=n.showDebugZone,d=void 0!==l&&l;return i.paddingZone=u,i.showDebugZone=d,i}return(0,i.Z)(t,e),t.prototype.updateSize=function(){if(e.prototype.updateSize.call(this),this.paddingZone){var t,n=this.width,i=this.height,r=n+this.paddingZone,a=i+this.paddingZone;if(this.setSize(r,a),this.hitZone.setSize(r,a),this.showDebugZone)null==(t=this.debugZone)||t.destroy(),this.debugZone=this.hitZone.drawDebugBox(10699282,.5),this.add(this.debugZone)}},t}(n(17).Z);t.Z=r},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(7),s=n(12),o=a.Z.EFFECTS,c=o.KEY,h=o.FRAME,u=function(e){function t(t,n){var r;return(r=e.call(this,t,c,h.BLANK)||this).config=void 0,r.emitter=void 0,r.config=n||{},r.scene.add.existing((0,i.Z)(r)),r}(0,r.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=h.FX_CONFETTI_SMALL_1,t=h.FX_CONFETTI_SMALL_2,n=h.FX_CONFETTI_SMALL_3,i=h.FX_CONFETTI_SMALL_4,r=1/GameCore.ImageScale,a={on:!1,particleBringToTop:!0,frame:[e,t,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:400,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},rotate:{start:0,end:1080},scale:{min:.8*r,max:2*r},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,s.TS)(a,this.config);this.emitter=this.createEmitter(o)},n.run=function(e,t,n){this.stop(),this.emitter.setQuantity(e),this.emitter.setPosition(t,n),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.createEmitters(),this.emitter.explode(e,t,n)},n.stop=function(){var e;null==(e=this.emitter)||e.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=u},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(3),s={targets:[],duration:1e3,ease:Phaser.Math.Easing.Quadratic.InOut,props:{scale:.2}},o=function(e){function t(t){var n,r;(r=e.call(this,s,t)||this).spline=void 0,r.createCounter=function(e,t){var n=r.config.onCurveUpdate,i="function"===typeof n?n:null;t.forEach((function(t,n){if(r.scene){var a=e.data[n],s=a.duration,o=a.delay,c=new Phaser.Math.Vector2;r.scene.tweens.addCounter({delay:o,duration:s,ease:Phaser.Math.Easing.Quadratic.InOut,onUpdate:function(e){r.spline.getPoint(e.getValue(),c),t.x=c.x,t.y=c.y,i&&i(t)}})}}))};var a=r.config.curve;return a?(r.spline=new Phaser.Curves.Spline(a),null==(n=r.tween)||n.on(Phaser.Tweens.Events.TWEEN_START,r.createCounter),r):(0,i.Z)(r)}return(0,r.Z)(t,e),t}(a.Z);t.Z=o},function(e,t,n){"use strict";var i=n(2),r=n(1),a=n(0),s=n(6),o=n(10),c=n(9),h=n(20),u=n(58),l=function(e){function t(t,n,i,a,s){var c;return(c=e.call(this,t)||this).useSound=!0,c.isClicked=!1,c.scaleUp=-1,c.button=void 0,c.buttonDown=void 0,c.hitArea=void 0,c.scaleDownPress=void 0,c.parentName=void 0,c.handelObjectDestroy=function(){c.scene&&c.scene.events.off(Phaser.Scenes.Events.SLEEP,c.handleSceneSleep)},c.handleSceneSleep=function(){c.scene&&c.scene.tweens.killTweensOf((0,r.Z)(c))},c.handlePointerDown=function(){c.isClicked||(c.showButtonDown(),c.isClicked=!0)},c.handleOnClick=function(e){return function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown(),c.logButtonEvent(),c.addDebugData(),c.processCallback(e))}},c.handlePointerOut=function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown())},c.buttonsPulsateAnimation=void 0,c.setDepth(o.Z.BUTTON),c.createButton(n,i,a,s),c.updateSize(),c.listenEvents(),c.scene.add.existing((0,r.Z)(c)),c}(0,a.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.showButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:.4,duration:150,ease:Phaser.Math.Easing.Sine.Out})},n.hideButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:0,duration:150,ease:Phaser.Math.Easing.Sine.In})},n.processCallback=function(e){-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=new h.Z(this.scene,0,0,e,t,n,i),this.buttonDown=new h.Z(this.scene,0,0,e,t,n,13619151),this.buttonDown.setAlpha(0),this.scaleDownPress=this.scale-.1;var r=this.button,a=r.displayWidth,s=r.displayHeight;this.hitArea=this.scene.make.zone({displayWidth:a,displayHeight:s}),this.add([this.button,this.buttonDown,this.hitArea])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,r=n/100*10,a=i<10?i:10,s=r<10?r:10;this.setSize(t+a,n+s),this.hitArea.setSize(t+a,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,c.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},n.runPulsate=function(){var e,t;null==(e=this.buttonsPulsateAnimation)||e.remove(),this.buttonsPulsateAnimation=new u.Z({targets:[this],props:{scale:{from:1,to:1.05},duration:500}}),null==(t=this.buttonsPulsateAnimation)||t.play()},n.stopPulsate=function(){var e;null==(e=this.buttonsPulsateAnimation)||e.stop(),this.setScale(1)},(0,i.Z)(t,[{key:"onClick",set:function(e){this.hitArea.setInteractive({useHandCursor:!0}),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}}]),t}(Phaser.GameObjects.Container);t.Z=l},function(e,t,n){"use strict";var i=n(8),r=n(1),a=n(0),s=n(7),o=n(56),c=s.Z.EFFECTS,h=c.KEY,u=c.FRAME,l=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n||h,i||u.FX_SPARK_YELLOW)||this).emitZone=void 0,s.emitter=void 0,s.configOverwrite=void 0,s.configOverwrite=a||{},s.createEmitZone(),s.createEmitters(),s.scene.add.existing((0,r.Z)(s)),s}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.Utils.Image.getImageScale();this.emitter=this.createEmitter((0,i.Z)({on:!1,frame:u.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:7,max:11},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:function(t){t.setScale({min:e/4,max:e})},particleClass:o.Z},this.configOverwrite))},n.run=function(e,t,n,i,r){this.stop(),this.emitZone.setSize(i,r),this.emitZone.setPosition(t-i/2,n-r/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=l},function(e,t,n){"use strict";var i=n(8),r=n(2),a=n(1),s=n(0),o=n(10),c=n(13);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=function(e){function t(t,n){var r;(r=e.call(this,t)||this).config=void 0,r.isEnable=void 0,r.minValue=void 0,r.maxValue=void 0,r.maxHeight=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.update=function(e,t){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(t),r.isScrollingBack&&r.scrollingBack(t)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,c.D)((function(e,t,n){if(r.isEnable){if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=r.lastScrollY.map((function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(e){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var t=r.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,a=(n.y-i.y)/t,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var c=(s-(r.value-r.marginTop))/s;o=Math.min(o,c)}if(r.isReachBottom()&&a<=0){var h=(s-(-r.maxHeight-r.value))/s;o=Math.min(o,h)}var u=a*o,l=r.maxScrollOver*r.height;r.value+u>r.marginTop+l?r.value=r.marginTop+l:r.value+u<-r.maxHeight-l?r.value=-r.maxHeight-l:r.value+=u,r.callOnScrollEvents(r.value,u)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){if(r.isReachTop()&&(r.startScrollingBack(r.marginTop),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxHeight),r.stopScrollSmooth()),r.isScrolling){var e=r.lastScrollY.reduce((function(e,t){return e+t}))/r.lastScrollY.length;r.startScrollSmooth(e*r.scrollSmooth),r.lastScrollY=r.lastScrollY.map((function(){return 0}))}},r.config=(0,i.Z)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5},n);var s=n.width,o=n.height;return r.isEnable=!1,r.maxHeight=0,r.lastScrollY=new Array(3).fill(0),r.setSize(s,o),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,a.Z)(r)),r}(0,s.Z)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.gotoBottom=function(){this.value=-this.maxHeight},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){this.drawDebugBox(16711680,.8)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y+e.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,t,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=e.map((function(e){return e.y+e.height+t.marginBottom-t.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.removeChildren=function(){this.objects=this.scene.make.group({}),this.reset()},n.getChildren=function(){return this.objects.getChildren().filter((function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(i),this.boundBottom.setTint(i),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(o.Z.PRIORITY),this.boundBottom.setDepth(o.Z.PRIORITY);var r=this.width,a=n,s=this.getWorldPosition(),c=s.x,h=s.y;this.boundTop.setDisplaySize(r,a),this.boundBottom.setDisplaySize(r,a),this.boundTop.setY(-this.displayHeight/2+a/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-a/2+h-this.y+1),this.boundTop.setX(c-this.x),this.boundBottom.setX(c-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(e){var t;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var n=this.width,i=this.height;this.maskGraphics.fillRoundedRect(0-n/2,0-i/2,n,i,e),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var e=this.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];this.isObjectOutOfScroller(n)?n.setVisible(!1):n.setVisible(!0)}},n.isObjectOutOfScroller=function(e){return e.y+e.height<-this.height/2||e.y-e.height>this.height/2},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=h(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,r.Z)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container);t.Z=l},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(7).Z.EFFECTS,s=a.KEY,o=a.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,s,o.FX_COMET)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,i.Z)(n)),n}(0,r.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:o.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500}})},n.run=function(e,t,n,i,r){this.stop(),this.emitZone.setSize(i,r),this.emitZone.setPosition(t-i/2,n-r/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(7).Z.EFFECTS,s=a.KEY,o=a.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,s,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.Z)(n)),n}(0,r.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(e,t,n,i,r){this.stop(),this.reset(),this.emitZone.setSize(i,r),this.emitZone.setPosition(t-i/2,n-r/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},function(e,t,n){"use strict";var i=n(0),r=n(3),a={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:500,to:0}}},s=function(e){function t(t){return e.call(this,a,t)||this}return(0,i.Z)(t,e),t}(r.Z);t.Z=s},function(e,t,n){"use strict";var i=n(0),r=n(14),a=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n.key,n.button,i,r)||this).payload=void 0,a.payload=n,a.createIcon(),a.createText(),a}(0,i.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.add.image(0,0,this.payload.key,this.payload.icon);e.setWorldSize(43,43),this.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-25)},n.createText=function(){var e=this.payload.text,t=this.scene.make.bitmapText({font:r.ZP.PRIMARY.KEY,size:this.scene.fontSize(24),text:e,origin:{x:.2,y:.5}});this.add(t)},t}(n(17).Z);t.Z=a},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(7).Z.EFFECTS,s=a.KEY,o=a.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t)||this).halo=void 0,n.star=void 0,n.createStar(),n.createHalo(),n.scene.add.existing((0,i.Z)(n)),n}(0,r.Z)(t,e);var n=t.prototype;return n.run=function(){this.runStarAnimation(),this.runHaloAnimation()},n.createStar=function(){this.star=this.scene.make.image({key:s,frame:o.FX_STAR_YELLOW,visible:!1}),this.star.setWorldSize(35,35),this.add(this.star)},n.createHalo=function(){this.halo=this.scene.make.image({key:s,frame:o.FX_CIRCLE,visible:!1}),this.halo.setWorldSize(162,162),this.add(this.halo)},n.runStarAnimation=function(){var e=this;this.scene.tweens.killTweensOf(this.star),this.star.setVisible(!0);var t=1/GameCore.ImageScale;this.scene.tweens.add({targets:[this.star],duration:400,ease:Phaser.Math.Easing.Quintic.Out,props:{scaleX:{start:16*t,to:0},scaleY:{start:10*t,to:0}},onComplete:function(){e.star.setVisible(!1)}})},n.runHaloAnimation=function(){var e=this;this.scene.tweens.killTweensOf(this.halo),this.halo.setScale(0),this.halo.setVisible(!0),this.scene.tweens.add({targets:[this.halo],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{from:0,to:8},alpha:{from:1,to:0}},onComplete:function(){e.halo.setVisible(!1)}})},t}(Phaser.GameObjects.Container);t.Z=c},function(e,t,n){"use strict";var i=n(1),r=n(0),a=n(3),s={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(e){function t(t){var n,r,a;return(a=e.call(this,s,t)||this).posX=void 0,a.handleSwitchPosition=function(){var e;a.posX=-a.posX,null==(e=a.tween)||e.updateTo("x",-a.posX)},null!=(n=a.config)&&n.props?(a.posX=a.config.props.x,null==(r=a.tween)||r.on(Phaser.Tweens.Events.TWEEN_REPEAT,a.handleSwitchPosition),a):(0,i.Z)(a)}return(0,r.Z)(t,e),t}(a.Z);t.Z=o}],t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,i,r,a){if(!i){var s=1/0;for(u=0;u<e.length;u++){i=e[u][0],r=e[u][1],a=e[u][2];for(var o=!0,c=0;c<i.length;c++)(!1&a||s>=a)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,a<s&&(s=a));if(o){e.splice(u--,1);var h=r();void 0!==h&&(t=h)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[i,r,a]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))},n.u=function(e){return e+"."+{7:"49bf78a2076c09689e5a",109:"a183165859989f51203f",123:"24662cf802b592fbb188",131:"82e823ea93500ae6fdfb",270:"acd7a1669949b5e03fa1",377:"b78ea4462e79492266e9",401:"6987fdd85ab336c8dc31",457:"f3970648f87665c0aa24",498:"1a6b098f34d12f3a7c32",530:"fc33f1c59e103907fa0d",545:"0c8100a7459c945f7352",739:"32b9a4b3a62e43ee5714",803:"f4465b001bf909d7e7a9",942:"34a0268ffc31f43d3984",961:"d1ff8758b60b1a115a32"}[e]+".bundle.js"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="game-core:";n.l=function(i,r,a,s){if(e[i])e[i].push(r);else{var o,c;if(void 0!==a)for(var h=document.getElementsByTagName("script"),u=0;u<h.length;u++){var l=h[u];if(l.getAttribute("src")==i||l.getAttribute("data-webpack")==t+a){o=l;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=i),e[i]=[r];var d=function(t,n){o.onerror=o.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&!e;)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),function(){var e={757:0};n.f.j=function(t,i){var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise((function(n,i){r=e[t]=[n,i]}));i.push(r[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(function(i){if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,r[1](o)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var r,a,s=i[0],o=i[1],c=i[2],h=0;if(s.some((function(t){return 0!==e[t]}))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(c)var u=c(n)}for(t&&t(i);h<s.length;h++)a=s[h],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},i=self.webpackChunkgame_core=self.webpackChunkgame_core||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),n.O(void 0,[216,630,542],(function(){return n(98)})),n.O(void 0,[216,630,542],(function(){return n(99)})),n.O(void 0,[216,630,542],(function(){return n(60)})),n.O(void 0,[216,630,542],(function(){return n(61)})),n.O(void 0,[216,630,542],(function(){return n(100)})),n.O(void 0,[216,630,542],(function(){return n(62)})),n.O(void 0,[216,630,542],(function(){return n(63)}));var i=n.O(void 0,[216,630,542],(function(){return n(64)}));i=n.O(i)})();