"use strict";(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[766],Array(28).concat([function(e,t,n){n.r(t),n.d(t,{default:function(){return HZ}});var i=n(27),a=n(5),r=n(1),s=n(7),o=n(0),c=n.n(o),h=n(58),u=0,l=0,d=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;l=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(l)),l+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!l||l<30)&&(l=60),u=l;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(l)),l+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-l,n=Math.round(e*t+l);n>u&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),p=d,f=n(17);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var v=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager,Phaser.GameObjects.NineSlice,SpinePlugin.SpineGameObject].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,SpinePlugin.SpineGameObject].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.customBitmapText=function(){Phaser.GameObjects.BitmapText.prototype.setLineHeight=function(e){this.lineHeight=e,this.updateDisplayOrigin()}},t.addSetDefaultWorldSize=function(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setDefaultWorldSize=function(){this.texture;var e=this.frame,t=e.width,n=e.height,i=1/GameCore.ImageScale,a=t*i,r=n*i;this.setWorldSize(a,r)}}))},t.addSetScaleByWorld=function(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setScaleByWorld=function(e,t){var n=1/GameCore.ImageScale;this.setScale(e*n,(t||e)*n),this.setWorldSize(this.displayWidth,this.displayHeight)}}))},t.customGameObject=function(){Phaser.GameObjects.GameObject.prototype.tweenLite=function(e){return this.scene.add.tween((0,a.Z)({targets:this},e))},Phaser.GameObjects.GameObject.prototype.tweenLiteAsync=function(e){var t=this;return new Promise((function(n){t.scene.add.tween((0,a.Z)({targets:t},e,{onComplete:function(){e.onComplete&&e.onComplete.apply(e,arguments),n(t)}}))}))}},t.addCustomNineSlice=function(){Phaser.GameObjects.NineSlice.prototype.setSlicesByWorld=this.setSlicesByWorld,Phaser.GameObjects.NineSlice.prototype.setSizeByWorld=this.setSizeByWorld},t.customTween=function(){Phaser.Tweens.Tween.prototype.waitForCompletion=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return n()})),t.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return n()}))}))},Phaser.Tweens.Tween.prototype.waitForLoops=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_LOOP,(function(){0==--e&&i()}))}))},Phaser.Tweens.Tween.prototype.waitForProgress=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_UPDATE,(function(){n.progress>=e&&i()}))}))},Phaser.Tweens.Tween.prototype.waitForTimeElapsed=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&(n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TWEEN_STOP,(function(){return i()}))),n.on(Phaser.Tweens.Events.TWEEN_UPDATE,(function(){n.totalElapsed>=e&&i()}))}))}},t.customTimeline=function(){Phaser.Tweens.Timeline.prototype.waitForCompletion=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(e){t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return e()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForCompletion=function(e){return void 0===e&&(e=!0),this.play(),this.waitForCompletion(e)},Phaser.Tweens.Timeline.prototype.waitForLoops=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),e<=0&&i(),n.on(Phaser.Tweens.Events.TIMELINE_LOOP,(function(){--e<=0&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForLoops=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForLoops(e,t)},Phaser.Tweens.Timeline.prototype.waitForPause=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return n()})),t.on(Phaser.Tweens.Events.TIMELINE_PAUSE,(function(){return n}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForPause=function(e){return void 0===e&&(e=!0),this.play(),this.waitForPause(e)},Phaser.Tweens.Timeline.prototype.waitForResume=function(e){var t=this;return void 0===e&&(e=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(n){e&&t.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return n()})),t.on(Phaser.Tweens.Events.TIMELINE_RESUME,(function(){return n}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForResume=function(e){return void 0===e&&(e=!0),this.play(),this.waitForResume(e)},Phaser.Tweens.Timeline.prototype.waitForProgress=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TIMELINE_UPDATE,(function(){n.progress>=e&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForProgress=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForProgress(e,t)},Phaser.Tweens.Timeline.prototype.waitForTimeElapsed=function(e,t){var n=this;return void 0===t&&(t=!0),this.state===Phaser.Tweens.PENDING_REMOVE||this.state===Phaser.Tweens.REMOVED?Promise.resolve():new Promise((function(i){t&&n.on(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){return i()})),n.on(Phaser.Tweens.Events.TIMELINE_UPDATE,(function(){n.totalElapsed>=e&&i()}))}))},Phaser.Tweens.Timeline.prototype.playAndWaitForTimeElapsed=function(e,t){return void 0===t&&(t=!0),this.play(),this.waitForTimeElapsed(e,t)}},t.customSpineGameObject=function(){SpinePlugin.SpineGameObject.prototype.setSkinCustom=this.setSkinCustom,SpinePlugin.SpineGameObject.prototype.setAttachmentCustom=this.setAttachmentCustom},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.setSlicesByWorld=function(e,t,n,i,a,r){var s=1/GameCore.ImageScale;return this.setScale(s),this.setSlices(e?e/s:void 0,t?t/s:void 0,n?n/s:void 0,i?i/s:void 0,a?a/s:void 0,r?r/s:void 0),this},t.setSizeByWorld=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=1/GameCore.ImageScale;return this.setSize(e/n,t/n),this},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,a=this.width,r=this.height,s=this.depth,o=this.originX,c=this.originY,h=this.scene.add.rectangle(n,i,a,r,e,t);h.setName("Debug Box"),h.setDepth(s);var u=GameCore.Utils.Valid.isNumber;return u(o)&&u(c)&&h.setOrigin(o,c),h},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},t.setSkinCustom=function(){var t=(0,r.Z)(c().mark((function t(n,i,a,r,s,o,h){var u,l,d,p,m,g,v,y,E,C,A,w;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===s&&(s=!1),void 0===o&&(o=0),void 0===h&&(h=0),u=n+"-"+i+"-"+a+"-"+r+"-"+o+"-"+h,void 0===(l=e.CUSTOM_SPINE_SKIN_CACHE[u])||s){t.next=9;break}return this.skeleton.setSkin(l),this.skeleton.setToSetupPose(),t.abrupt("return",l);case 9:if((d=this.scene.game.context)instanceof WebGLRenderingContext){t.next=12;break}return t.abrupt("return",null);case 12:if(null!==(p=this.skeleton.findSlot(a))){t.next=15;break}return t.abrupt("return",null);case 15:if(null!==(m=this.animationStateData.skeletonData.defaultSkin)){t.next=18;break}return t.abrupt("return",null);case 18:if(void 0!==(g=m.getAttachment(p.data.index,r))&&(g instanceof SpinePlugin.MeshAttachment||g instanceof SpinePlugin.RegionAttachment)){t.next=21;break}return t.abrupt("return",null);case 21:if(v=g.copy(),void 0!==(y=this.scene.textures.getFrame(n,i))){t.next=25;break}return t.abrupt("return",null);case 25:return o=Math.max(y.width,o),h=Math.max(y.height,h),t.next=29,(0,f.Z)(y,o,h);case 29:if(null!==(E=t.sent)){t.next=32;break}return t.abrupt("return",null);case 32:return C=new SpinePlugin.GLTexture(d,E),(A=new SpinePlugin.TextureRegion).degrees=0,A.width=o,A.height=h,A.offsetX=0,A.offsetY=0,A.originalWidth=o,A.originalHeight=h,A.u=0,A.u2=1,A.v=0,A.v2=1,A.texture=C,v.region=A,v.width=o,v.height=h,v.updateRegion(),(w=new SpinePlugin.Skin(i)).setAttachment(p.data.index,r,v),this.skeleton.setSkin(w),this.skeleton.setToSetupPose(),e.CUSTOM_SPINE_SKIN_CACHE[u]=w,t.abrupt("return",w);case 56:case"end":return t.stop()}}),t,this)})));return function(e,n,i,a,r,s,o){return t.apply(this,arguments)}}(),t.setAttachmentCustom=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],(i=this.scene.game.context)instanceof WebGLRenderingContext){e.next=4;break}return e.abrupt("return",null);case 4:a=c().mark((function e(){var t,a,r,s,u,l,d,p,m,g;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.value,a=t.textureKey+"-"+t.frameKey+"-"+t.slotName+"-"+t.attachmentName+"-"+t.targetWidth+"-"+t.targetHeight,n.push(a),r=h.skeleton.findSlot(t.slotName)){e.next=6;break}return e.abrupt("return",{v:null});case 6:if((s=r.getAttachment())&&(s instanceof SpinePlugin.MeshAttachment||s instanceof SpinePlugin.RegionAttachment)){e.next=9;break}return e.abrupt("return",{v:null});case 9:if(u=s.copy(),l=h.scene.textures.getFrame(t.textureKey,t.frameKey)){e.next=13;break}return e.abrupt("return",{v:null});case 13:return e.next=15,(0,f.Z)(l,t.targetWidth,t.targetHeight);case 15:if(d=e.sent){e.next=18;break}return e.abrupt("return",{v:null});case 18:p=new SpinePlugin.GLTexture(i,d),m=Object.assign(new SpinePlugin.TextureRegion,{degrees:0,width:t.targetWidth,height:t.targetHeight,originalWidth:t.targetWidth,originalHeight:t.targetHeight,offsetX:t.offsetX,offsetY:t.offsetY,u:0,u2:1,v:0,v2:1,texture:p}),u.name=t.attachmentName,u.path=t.attachmentName,u.region=m,u.width=t.targetWidth,u.height=t.targetHeight,u.updateRegion(),g=r.data.index,h.skeleton.slots.map((function(e){e.data.name===t.slotName&&e.data.index===g&&e.setAttachment(u)}));case 28:case"end":return e.stop()}}),e)})),s=m(t);case 6:if((o=s()).done){e.next=13;break}return e.delegateYield(a(),"t0",8);case 8:if(!(r=e.t0)){e.next=11;break}return e.abrupt("return",r.v);case 11:e.next=6;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();v.CUSTOM_SPINE_SKIN_CACHE={};var y=v,E=[{url:"./assets/images/others/mock1.jpg",title:"Buy lottery tickets on behalf",description:"\ud83d\udca5\ud83d\udca5\ud83d\udca5 Place an order for lottery tickets from 3 regions!!! \u2705 Fast - Convenient - Safe \u2705 Diverse products \u2705 Payment...",buttonName:"Discover more"},{url:"./assets/images/others/mock2.jpg",title:"SYSTEM-WIDE SALE UP TO 50%",description:'\ud83d\udd25 \ud835\uddec\ud835\uddd8\ud835\uddd4\ud835\udde5 \ud835\uddd8\ud835\udde1\ud835\uddd7 \ud835\udde6\ud835\uddd4\ud835\udddf\ud835\uddd8 | \ud835\udde8\ud835\udde3 \ud835\udde7\ud835\udde2 \ud835\udff1\ud835\udfec% "BIG PARTY" AUTHENTIC SPORTSWEAR SHOCKINGLY REDUCED PRICES! \ud83c\udf81 From...',buttonName:"Discover more"},{url:"./assets/images/others/mock3.jpg",title:"Register now",description:"Play safe, play fun, play 9club!",buttonName:"Register"}],C=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentIdx=(this.currentIdx+1)%E.length,this.hideBannerAdAsync(),e.next=4,new Promise((function(e){setTimeout((function(){e()}),2e3)}));case 4:if(!document.getElementById("mock-banner-ads")){e.next=16;break}return t=E[this.currentIdx],n=t.url,i=t.buttonName,a=t.title,r=t.description,(s=document.getElementById("banner-content-text1"))&&(s.innerHTML=a),(o=document.getElementById("banner-content-text2"))&&(o.innerHTML=r),(h=document.getElementById("mock-banner-ads-avatar"))&&(h.style.background="url("+n+") center center/contain no-repeat"),(u=document.getElementById("banner-content-button"))&&(u.innerHTML=i),e.abrupt("return");case 16:l=GameCore.Utils.Device.isDesktop(),50,l?this.createDesktopBannerAd(50):this.createMobileBannerAd(50);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.createDesktopBannerAd=function(e){var t=this,n=E[this.currentIdx],i=n.url,a=n.buttonName,r=n.title,s=n.description,o=document.createElement("div");o.id="mock-banner-ads",o.style.width="100%",o.style.height=e+"px",o.style.bottom="var(--sab)",o.style.display="flex",o.style.position="absolute",o.style.opacity=this.currentOpacity;var c=document.createElement("div");c.id="mock-banner-ads-display-area",c.style.width="100%",c.style.height="100%",c.style.background="#323436 center center/auto no-repeat",c.style.borderRadius="10px",c.style.marginLeft="4px",c.style.marginRight="4px",c.style.display="block",c.style.alignContent="center";var h=document.createElement("div");h.id="mock-banner-ads-content",h.style.boxSizing="border-box",h.style.flexDirection="row",h.style.display="flex",h.style.position="relative",h.style.alignItems="stretch",h.style.paddingLeft="4px",h.style.paddingRight="4px",h.style.justifyContent="space-between";var u=document.createElement("div");u.id="mock-banner-ads-avatar",u.style.marginLeft="10px",u.style.width=e+"px",u.style.minWidth=e+"px",u.style.height=e+"px",u.style.display="flex",u.style.flexDirection="column",u.style.position="relative",u.style.background="url("+i+") center center/contain no-repeat",u.style.borderRadius="50%";var l=document.createElement("div");l.id="mock-banner-ads-right-content",l.style.width="100%",l.style.paddingLeft="10px",l.style.display="flex",l.style.flexDirection="row",l.style.position="relative",l.style.color="#E4E6EB",l.style.wordWrap="break-word",l.style.textAlign="left",l.style.alignContent="center",l.style.alignItems="center",l.style.fontSize="12px",l.style.fontFamily="Helvetica, Arial, sans-serif, Roboto, Helvetica, Arial, sans-serif",u.style.boxSizing="border-box";var d=document.createElement("div");d.style.flexDirection="column",d.style.display="flex",d.style.justifyContent="center",d.style.flexShrink="1",d.style.flexGrow="1",d.style.flexBasis="0",d.style.boxSizing="border-box",d.style.minWidth="0",d.innerHTML="\n            <div id='banner-content-text1' style=\"font-weight:600;line-height: 1.3333;font-size: .9375rem;text-overflow: ellipsis;-webkit-line-clamp: 1;white-space: nowrap;overflow: hidden;\">"+r+"</div>\n            <div id='banner-content-text2' style=\"font-weight:400;line-height: 1.2308;font-size: .8125rem;text-overflow: ellipsis;-webkit-line-clamp: 2;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+s+"</div>";var p=document.createElement("button");p.id="banner-content-button",p.type="button",p.style.width="120px",p.style.height=e-20+"px",p.style.fontWeight="600",p.style.backgroundColor="#3963fc",p.style.border="none",p.style.color="white",p.style.borderRadius="5px",p.style.textAlign="center",p.style.display="inline-block",p.style.cursor="pointer",p.style.marginRight="10px",p.style.marginLeft="10px",p.style.flexShrink="1",p.style.boxSizing="border-box",p.style.paddingRight="2px",p.style.paddingLeft="2px",p.innerHTML=a,p.onclick=function(){"0.2"===t.currentOpacity?o.style.opacity="1":o.style.opacity="0.2",t.currentOpacity=o.style.opacity};var f=document.createElement("button");f.type="button",f.style.width=e-20+"px",f.style.height=e-20+"px",f.style.fontWeight="1000",f.style.backgroundColor="#5a5c5c",f.style.border="none",f.style.color="white",f.style.borderRadius="50%",f.style.textAlign="center",f.style.display="inline-block",f.style.cursor="pointer",f.style.marginRight="10px",f.style.marginLeft="10px",f.style.flexShrink="0",f.style.boxSizing="border-box",f.style.paddingRight="2px",f.style.paddingLeft="2px",f.innerHTML="...",document.body.appendChild(o),o.appendChild(c),c.appendChild(h),h.appendChild(u),h.appendChild(l),l.appendChild(d),l.appendChild(p),l.appendChild(f)},e.createMobileBannerAd=function(e){var t=this,n=E[this.currentIdx],i=n.url,a=n.buttonName,r=n.title,s=n.description,o=document.createElement("div");o.id="mock-banner-ads",o.style.width="100%",o.style.height=e+"px",o.style.bottom="var(--sab)",o.style.display="block",o.style.position="absolute",o.style.opacity=this.currentOpacity;var c=document.createElement("div");c.id="mock-banner-ads-display-area",c.style.background="#ffffff center center/auto no-repeat",c.style.display="block",c.style.alignContent="center";var h=document.createElement("div");h.id="mock-banner-ads-content",h.style.boxSizing="border-box",h.style.flexDirection="row",h.style.display="flex",h.style.position="relative",h.style.alignItems="stretch",h.style.justifyContent="space-between";var u=document.createElement("div");u.id="mock-banner-ads-avatar",u.style.width=e+"px",u.style.minWidth=e+"px",u.style.height=e+"px",u.style.display="flex",u.style.flexDirection="column",u.style.position="relative",u.style.background="url("+i+") center center/contain no-repeat";var l=document.createElement("div");l.id="mock-banner-ads-right-content",l.style.width="100%",l.style.paddingLeft="10px",l.style.display="flex",l.style.flexDirection="row",l.style.position="relative",l.style.color="#000",l.style.wordWrap="break-word",l.style.textAlign="left",l.style.alignContent="center",l.style.alignItems="center",l.style.fontSize="12px",l.style.fontFamily="Helvetica, Arial, sans-serif, Roboto, Helvetica, Arial, sans-serif",u.style.boxSizing="border-box";var d=document.createElement("div");d.style.flexDirection="column",d.style.display="flex",d.style.justifyContent="center",d.style.flexShrink="1",d.style.flexGrow="1",d.style.flexBasis="0",d.style.boxSizing="border-box",d.style.minWidth="0",d.innerHTML="\n            <div id='banner-content-text1' style=\"font-weight:600;line-height: 1.3333;font-size: .9375rem;text-overflow: ellipsis;-webkit-line-clamp: 1;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+r+"</div>\n            <div id='banner-content-text2' style=\"font-weight:400;line-height: 1.2308;font-size: .8125rem;text-overflow: ellipsis;-webkit-line-clamp: 1;overflow: hidden;display: -webkit-box;-webkit-box-orient: vertical;\">"+s+"</div>";var p=document.createElement("button");p.id="banner-content-button",p.type="button",p.style.height="100%",p.style.fontWeight="600",p.style.backgroundColor="#3963fc",p.style.border="none",p.style.color="white",p.style.textAlign="center",p.style.display="inline-block",p.style.cursor="pointer",p.style.marginLeft="10px",p.style.flexShrink="1",p.style.boxSizing="border-box",p.style.paddingRight="2px",p.style.paddingLeft="2px",p.innerHTML=a,p.onclick=function(){"0.2"===t.currentOpacity?o.style.opacity="1":o.style.opacity="0.2",t.currentOpacity=o.style.opacity},document.body.appendChild(o),o.appendChild(c),c.appendChild(h),h.appendChild(u),h.appendChild(l),l.appendChild(d),l.appendChild(p)},e.hideBannerAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("mock-banner-ads")){e.next=3;break}return e.abrupt("return");case 3:t.remove();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}();C.currentIdx=-1,C.currentOpacity="1";var A={LOADED:"loaded",DISPLAYED:"displayed"},w=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(w||{}),S=w,b=function(e){return e.REWARDED="rewarded",e.PRE_ROLL="pre-roll",e.INTERSTITIAL="interstitial",e.BANNER="banner",e}(b||{}),T=b,x=n(61),P=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),k=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=S.IDLE};function I(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}GameCore.Ads={Types:T,Status:S,Events:A,AdError:P,AdInstance:k};var R=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.enabled=void 0,t.config=void 0,t.lastInterAdShownTime=void 0,t.lastInterAdLoadedTime=void 0,t.lastRewardAdShownTime=void 0,t.interstitial=void 0,t.rewardedVideo=void 0,t.preRoll=void 0,t.fallbackInterstitial=void 0,t.fallbackRewardedVideo=void 0,t.fallbackPreRoll=void 0,t.safeAreaBottom=void 0,t.showingBannerAd=void 0,t.reloadBannerAdIntervals=void 0,t.bannerAdConfigs=void 0,t.isHaveBannerAdOptions=void 0,t.isFallbackReady=void 0,t.isFallbackInitialized=void 0,t.isBannerAdsShown=void 0,t.bannerPosition=void 0,t.bannerAdLoaded=void 0,t.isInterstitialRemoved=!1,t.daysRemoveAdsLeft=0,t.adInProcessFlag=!1,t}(0,s.Z)(t,e);var i=t.prototype;return i.init=function(){this.events=new Phaser.Events.EventEmitter,GameCore.Utils.Device.isMobile(),this.bannerPosition="bottom",this.safeAreaBottom=0,this.lastInterAdShownTime=0,this.lastInterAdLoadedTime=0,this.lastRewardAdShownTime=0,this.showingBannerAd={},this.reloadBannerAdIntervals={},this.bannerAdConfigs=[],this.isHaveBannerAdOptions=!0,this.isFallbackReady=!1,this.isFallbackInitialized=!1,this.isBannerAdsShown=!1},i.getBannerPosition=function(){return this.bannerPosition},i.calculateSafeAreaBottom=function(){try{if(!this.config.calculateSafeAreaBottom)return;this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},i.configure=function(e,t){this.enabled=t.enabled,this.config=t,this.setAdInstance(e),this.setBannerAdConfigStatus(),this.calculateSafeAreaBottom()},i.setBannerAdConfigStatus=function(){for(var e,t=this.config.bannerAdOptions,n=GameCore.Utils.Device.isDesktop(),i=I(t);!(e=i()).done;){var a=e.value,r=a.platform,s="ALL"==r||"DESKTOP"==r&&n||"MOBILE"==r&&!n;this.bannerAdConfigs.push({config:a,canShow:s}),s&&(this.isHaveBannerAdOptions=!0)}},i.setAdInstance=function(e){var t=this.config,n=t.rewardAdOptions,i=t.interstitialAdOptions;this.interstitial=new e(T.INTERSTITIAL,i.pID),this.rewardedVideo=new e(T.REWARDED,n.pID),this.preRoll=new e(T.PRE_ROLL,i.pID)},i.setFallbackAdInstance=function(e){var t=this.config,n=t.rewardAdOptions,i=t.interstitialAdOptions;this.fallbackInterstitial=new e(T.INTERSTITIAL,i.pID),this.fallbackRewardedVideo=new e(T.REWARDED,n.pID),this.fallbackPreRoll=new e(T.PRE_ROLL,i.pID)},i.preloadInterstitialAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(T.INTERSTITIAL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.showInterstitialAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAdByTime()){e.next=2;break}throw new P("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(T.INTERSTITIAL);case 4:this.lastInterAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.preloadPreRollAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(T.PRE_ROLL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.showPreRollAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showAdAsync(T.PRE_ROLL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.preloadRewardedVideoAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(T.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.showRewardedVideoAsync=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowRewardAd()){e.next=2;break}throw new P("REWARDED_VIDEO_CAN_NOT_SHOW","Can't show rewarded video");case 2:return e.next=4,this.showAdAsync(T.REWARDED);case 4:this.lastRewardAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.getRemainingRewardTime=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions.secondsBetweenAds,n=e-this.lastRewardAdShownTime;return n<t?t-n:0},i.preloadAdAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new P("ADS_NOT_ENABLED","Ads is't enabled");case 2:return e.next=4,this.preloadMainAdService(t);case 4:if(!0!==(n=e.sent)){e.next=7;break}return e.abrupt("return");case 7:if(this.isFallbackReady){e.next=9;break}throw n;case 9:return e.next=11,this.preloadFallbackAdService(t);case 11:if(!0!==(i=e.sent)){e.next=14;break}return e.abrupt("return");case 14:throw i;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.preloadMainAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.preloadAdInstanceAsync(e,!1).then((function(){i=!0})).catch((function(e){t.isFallbackReady||t.initFallbackAdsService().catch((function(){t.isFallbackReady=!1})),i=e})).finally((function(){n(i)}))}))},i.preloadFallbackAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.isFallbackReady||n(new P("FALLBACK_NOT_READY","Fallback ads not ready")),t.preloadAdInstanceAsync(e,!0).then((function(){i=!0})).catch((function(e){i=e})).finally((function(){n(i)}))}))},i.preloadAdInstanceAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),null!==(i=this.getAdInstanceByType(t,n))){e.next=4;break}throw new P("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 4:if(i.getStatus()!==S.LOADING){e.next=8;break}return e.next=7,new Promise((function(e){a.events.once(A.LOADED,e)}));case 7:return e.abrupt("return");case 8:return t!==T.INTERSTITIAL&&t!==T.PRE_ROLL||(this.lastInterAdLoadedTime=window.performance.now()/1e3),e.next=11,i.loadAsync();case 11:this.events.emit(A.LOADED,t);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),i.showAdAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new P("ADS_NOT_ENABLED","Ads is't enabled");case 2:return e.next=4,this.showMainAdService(t);case 4:if(!0!==(n=e.sent)){e.next=7;break}return e.abrupt("return");case 7:if(!this.isUserCancelledAdError(n)&&this.isAdFallbackReadyToShow(t)){e.next=9;break}throw n;case 9:return e.next=11,this.showFallbackAdService(t);case 11:if(!0!==(i=e.sent)){e.next=14;break}return e.abrupt("return");case 14:throw i;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.showMainAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.showAdInstanceAsync(e,!1).then((function(){i=!0})).catch((function(e){i=e,t.isUserCancelledAdError(e)||t.isFallbackReady||t.initFallbackAdsService().catch((function(){t.isFallbackReady=!1}))})).finally((function(){n(i)}))}))},i.showFallbackAdService=function(e){var t=this;return new Promise((function(n){var i=!1;t.isFallbackReady||n(new P("FALLBACK_NOT_READY","Fallback ads not ready")),t.showAdInstanceAsync(e,!0).then((function(){i=!0})).catch((function(e){i=e})).finally((function(){n(i)}))}))},i.showAdInstanceAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),null!==(i=this.getAdInstanceByType(t,n))){e.next=4;break}throw new P("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 4:return t!==T.INTERSTITIAL&&t!==T.PRE_ROLL||(this.lastInterAdShownTime=window.performance.now()/1e3),t===T.REWARDED&&(this.lastRewardAdShownTime=window.performance.now()/1e3,this.config.enableRewardVideoResetInterstitial&&(this.lastInterAdShownTime=this.lastRewardAdShownTime)),e.next=8,i.showAsync();case 8:this.events.emit(A.DISPLAYED,t);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),i.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},i.getAdInstanceByType=function(e,t){if(void 0===t&&(t=!1),t)switch(e){case T.INTERSTITIAL:return this.fallbackInterstitial;case T.REWARDED:return this.fallbackRewardedVideo;case T.PRE_ROLL:return this.fallbackPreRoll;default:return null}switch(e){case T.INTERSTITIAL:return this.interstitial;case T.REWARDED:return this.rewardedVideo;case T.PRE_ROLL:return this.preRoll;default:return null}},i.canbeShowInterstitialAd=function(){var e=this.game.level.getLevel(),t=this.canbeShowInterstitialAdByTime();return!(e<GameCore.Configs.Ads.LevelRequired.Interstitial)&&t},i.canbeLoadInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastInterAdLoadedTime);return this.lastInterAdLoadedTime>0?a>=i:a>=n},i.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastInterAdShownTime);return this.lastInterAdShownTime>0?a>=i:a>=n},i.canbeShowRewardAd=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastRewardAdShownTime);return this.lastRewardAdShownTime>0?a>=i:a>=n},i.getEnabledBannerAds=function(){if(!this.isHaveBannerAdOptions)return[];for(var e,t=[],n=I(this.bannerAdConfigs);!(e=n()).done;){var i=e.value,a=i.config;i.canShow&&t.push(a)}return t},i.disableBannerAds=function(){this.config.bannerAdOptions=[]},i.showBannerAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(!this.isBannerAdsShown){e.next=5;break}return e.next=5,this.hideBannerAdAsync();case 5:if(0!==(t=this.getEnabledBannerAds()).length){e.next=8;break}return e.abrupt("return");case 8:return this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},this.loadBannerAdAsync("",t),e.abrupt("return");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.loadBannerAdAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(i=this.getSceneName(),a=GameCore.Configs.Ads,e.prev=4,"msgames"===a.AdService){e.next=7;break}throw new P("BANNER_ADS_NOT_SUPPORTED","Banner ads not supported");case 7:if(!a.Mockup.Enable){e.next=13;break}return e.next=10,C.loadBannerAdAsync();case 10:this.game.world.setBannerDisplaying(!0),e.next=16;break;case 13:return e.next=15,GameSDK.loadBannerAdAsync(t,n);case 15:this.game.world.setBannerDisplaying(!0);case 16:this.isBannerAdsShown=!0,n.forEach((function(e){var t=e.placementId,n=e.position,s=e.bannerWidth,o=e.bannerHeight;if(t&&""!==t){var c=n+":"+s+"x"+o;r.showingBannerAd[t]=!0,window.game.analytics.showBannerAd(c,i,a.AdService)}})),e.next=27;break;case 20:e.prev=20,e.t0=e.catch(4),this.isBannerAdsShown=!1,n.forEach((function(e){var t=e.position+":"+e.bannerWidth+"x"+e.bannerHeight,n={type:T.BANNER,placement:i,bannerPosition:t,adService:a.AdService};window.game.analytics.showAdFail(n)})),this.game.world.setBannerDisplaying(!1),this.bannerAdLoaded=!1;case 27:this.bannerAdLoaded||(this.game.world.setBannerDisplaying(!0),this.bannerAdLoaded=!0);case 28:case"end":return e.stop()}}),e,this,[[4,20]])})));return function(t,n){return e.apply(this,arguments)}}(),i.hideBannerAdAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(this.isHaveBannerAdOptions){e.next=4;break}return e.abrupt("return");case 4:if(this.isBannerAdsShown=!1,e.prev=5,"msgames"===(t=GameCore.Configs.Ads).AdService){e.next=9;break}throw new P("BANNER_ADS_NOT_SUPPORTED","Banner ads not supported");case 9:if(!t.Mockup.Enable){e.next=15;break}return e.next=12,C.hideBannerAdAsync();case 12:this.game.world.setBannerDisplaying(!1),e.next=18;break;case 15:return e.next=17,GameSDK.hideBannerAdAsync();case 17:this.game.world.setBannerDisplaying(!1);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5);case 23:case"end":return e.stop()}}),e,this,[[5,20]])})));return function(){return e.apply(this,arguments)}}(),i.getBannerHeight=function(){if(!this.enabled||this.isInterstitialRemoved)return 0;if(!this.isBannerAdsShown)return 0;var e=this.getBottomBannerConfig();if(!e)return 0;var t=e.bannerHeight,n=(void 0===t?0:t)+this.safeAreaBottom+20;if(this.game.world){var i=this.game.world,a=i.getPixelRatio(),r=i.getZoomRatio();return this.game.world.getPhysicPixels(n,a/r)}return n},i.getBottomBannerConfig=function(){var e=this.getEnabledBannerAds();return 0===e.length?null:e.find((function(e){return"bottom"===e.position}))||null},i.getSceneName=function(){try{var e=self.game.globalScene;return this.globalSceneTypeCheck(e)?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},i.globalSceneTypeCheck=function(e){return"getCurrentScene"in e&&"function"===typeof e.getCurrentScene},i.initFallbackAdsService=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,!this.isFallbackInitialized){e.next=3;break}return e.abrupt("return");case 3:return this.isFallbackInitialized=!0,e.next=6,this.getFallbackAdServiceInstance();case 6:n=e.sent,"none"!==t.FallbackService&&null!==n&&(this.isFallbackReady=!0,this.setFallbackAdInstance(n));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.getFallbackAdServiceInstance=function(){var e=(0,r.Z)(c().mark((function e(){var t,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=GameCore.Configs.Ads.FallbackService,e.next=3,Promise.resolve().then(n.bind(n,44));case 3:if(i=e.sent.default,"google"!==t){e.next=16;break}return e.prev=5,e.next=8,this.initGoogleAdInstanceAsync();case 8:if(null===(a=e.sent)){e.next=11;break}return e.abrupt("return",a);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5);case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}(),i.initGoogleAdInstanceAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t,i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads.AdServiceConfigs.Google){e.next=3;break}return e.abrupt("return",null);case 3:return i=t.DataAdChannel,a=t.DataAdClient,r=t.DataAdHost,s=t.DataAdBreakTest,o=t.DataAdFrequencyHint,h=t.MaxScriptLoadRetryCount,e.next=6,Promise.resolve().then(n.bind(n,45));case 6:if("loaded"!==(u=e.sent.default).initStatus){e.next=9;break}return e.abrupt("return",u);case 9:return l={dataAdClient:a,dataAdChannel:i,dataAdHost:r,dataAdBreakTest:s,dataAdFrequencyHint:o,maxScriptLoadRetryCount:h},e.prev=10,u.setGame(this.game),e.next=14,u.initGoogleAdsAsync(l);case 14:return e.abrupt("return",u);case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,this,[[10,17]])})));return function(){return e.apply(this,arguments)}}(),i.isUserCancelledAdError=function(e){if(e instanceof P&&"USER_INPUT"===e.code)return!0;try{var t=JSON.parse(JSON.stringify(e));return"code"in t&&"USER_INPUT"===t.code}catch(e){return!1}},i.isAdFallbackReadyToShow=function(e){if(!this.isFallbackReady)return!1;var t=this.getAdInstanceByType(e,!0);return!!t&&t.getStatus()===S.FILLED},i.setDisabledInterstitialAds=function(e){this.isInterstitialRemoved=!0,this.daysRemoveAdsLeft=e,this.hideBannerAdAsync()},i.isDisabledInterstitialAds=function(){return this.isInterstitialRemoved},i.getDaysRemoveAdsLeft=function(){return this.daysRemoveAdsLeft},i.setAdInProcess=function(e){this.adInProcessFlag=e},i.isAdInProcess=function(){return this.adInProcessFlag},t}(Phaser.Plugins.BasePlugin),B=R,D=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog},t.levelStart=function(e,t,n){this.processLevelStart(e,t,n),this.selfLog},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog},t.levelRescue=function(e,t,n){this.processLevelRescue(e,t,n),this.selfLog},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog},t.loadPreRollAd=function(e,t){this.processLoadPreRollAd(e,t),this.selfLog},t.showPreRollAd=function(e,t){this.processShowPreRollAd(e,t),this.selfLog},t.loadInterstitialAd=function(e,t){this.processLoadInterstitialAd(e,t),this.selfLog},t.showInterstitialAd=function(e,t){this.processShowInterstitialAd(e,t),this.selfLog},t.loadRewardedVideoAd=function(e,t){this.processLoadRewardedVideoAd(e,t),this.selfLog},t.showRewardedVideoAd=function(e,t){this.processShowRewardedVideoAd(e,t),this.selfLog},t.showBannerAd=function(e,t,n){this.processShowBannerAd(e,t,n),this.selfLog},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog},t.loadAdFail=function(e){this.processLoadAdFail(e),this.selfLog},t.showAdFail=function(e){this.processShowAdFail(e),this.selfLog},t.viewItemList=function(e,t,n){this.processViewItemList(e,t,n),this.selfLog},t.selectItem=function(e,t,n){this.processSelectItem(e,t,n),this.selfLog},t.viewItem=function(e,t,n){this.processViewItem(e,t,n),this.selfLog},t.beginCheckout=function(e,t,n){this.processBeginCheckout(e,t,n),this.selfLog},t.purchase=function(e,t,n,i){this.processPurchase(e,t,n,i),this.selfLog},t.purchaseCancel=function(e,t){this.processPurchaseCancel(e,t),this.selfLog},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},t.processLevelStart=function(e,t,n){},t.processLevelFail=function(e,t,n){},t.processLevelRescue=function(e,t,n){},t.processLevelComplete=function(e,t,n){},t.processLoadInterstitialAd=function(e,t){},t.processShowInterstitialAd=function(e,t){},t.processLoadPreRollAd=function(e,t){},t.processShowPreRollAd=function(e,t){},t.processLoadRewardedVideoAd=function(e,t){},t.processShowRewardedVideoAd=function(e,t){},t.processShowBannerAd=function(e,t,n){},t.processReceiveReward=function(e){},t.processLoadAdFail=function(e){},t.processShowAdFail=function(e){},e}(),L=D;GameCore.Analytics={BaseAnalytics:L};var _=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).analytics=void 0,t.pageview=function(e){t.isActive()&&t.analytics.forEach((function(t){t.pageview(e)}))},t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(e,t,n)}))},n.levelRescue=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(e,t,n)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.loadPreRollAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadPreRollAd(e,t)}))},n.showPreRollAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showPreRollAd(e,t)}))},n.loadInterstitialAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadInterstitialAd(e,t)}))},n.showInterstitialAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showInterstitialAd(e,t)}))},n.loadRewardedVideoAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.loadRewardedVideoAd(e,t)}))},n.showRewardedVideoAd=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.showRewardedVideoAd(e,t)}))},n.showBannerAd=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showBannerAd(e,t,n)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.loadAdFail=function(e){this.isActive()&&this.analytics.forEach((function(t){t.loadAdFail(e)}))},n.showAdFail=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showAdFail(e)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),M=_,N=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.lastConfig=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isPlaying=function(e){var n=t.audios.get(e);return!!n&&n.isPlaying},this.game=e,this.audios=new Map,this.lastConfig={key:"",volume:0}}var t=e.prototype;return t.play=function(e,t){""===e&&(e=this.lastConfig.key),this.lastConfig=(0,a.Z)({key:e,volume:this.volume},t||{}),this.lastConfig.volume!==this.volume&&(this.lastConfig.volume*=this.volume);var n=this.audios.get(e);if(!n&&this.game.cache.audio.exists(e)){var i=this.game.sound.add(e);this.audios.set(e,i),n=i}n&&n.play(void 0,this.lastConfig)},t.setMusicKey=function(e){this.lastConfig.key=e},t.getMusicKey=function(){return this.lastConfig.key},t.pauseAll=function(){this.audios.forEach((function(e){e.pause()}))},t.resumeAll=function(){this.isMusicEnabled()&&this.audios.forEach((function(e){e.resume()}))},t.stopAll=function(){this.audios.forEach((function(e){e.stop()}))},t.pause=function(e){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&t.pause()},t.resume=function(e){if(this.isMusicEnabled()){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&t.resume()}},t.stop=function(e){""===e&&(e=this.lastConfig.key);var t=this.audios.get(e);t&&(t.stop(),this.lastConfig={key:"",volume:this.volume})},t.setVolume=function(e){this.volume=e;var t=this.audios.get(this.lastConfig.key);t&&t.setVolume(e)},e}(),G=N,Z=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.soundKeys=void 0,this.audioSpriteKeys=void 0,this.markers=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!t.game.player.getPlayerSetting("sound")},this.game=e,this.markers={},this.audios=new Map,this.audioSpriteKeys=[],this.soundKeys=new Map}var t=e.prototype;return t.addSoundKeys=function(e){var t=this;Object.keys(e).forEach((function(n){var i=e[n];"string"===typeof i&&t.soundKeys.set(n,i)}))},t.createMaker=function(e,t){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(t),this.audioSpriteKeys.push(e)}catch(n){}},t.clearSoundKeys=function(){this.soundKeys.clear()},t.play=function(e,t){var n=this,i=(0,a.Z)({volume:this.volume},t||{});i.volume!==this.volume&&(i.volume*=this.volume);var r=this.audios.get(e);if(!r&&this.game.cache.audio.exists(e)){var s=this.game.sound.add(e);this.audios.set(e,s),r=s}if(r)r.play(void 0,i);else{var o=this.soundKeys.get(e);if(o)try{this.game.globalScene.load.audio(e,o),this.game.globalScene.load.on(Phaser.Loader.Events.FILE_KEY_COMPLETE+"audio-"+e,(function(){var t=n.game.sound.add(e);n.audios.set(e,t),t.play(void 0,i)})),this.game.globalScene.load.start()}catch(c){}}},t.playAudioSprite=function(e,t,n,i){var r,s,o=(0,a.Z)({volume:this.volume},n||{});(o.volume!==this.volume&&(o.volume*=this.volume),i)?(this.createMaker(t,e),null==(r=this.markers[t])||r.play(t,n)):(this.createMaker(e,e),null==(s=this.markers[e])||s.play(t,n))},t.pauseAll=function(){var e=this;this.audios.forEach((function(e){e.pause()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.pause()}))},t.resumeAll=function(){var e=this;this.game.player.getPlayerSetting("sound")&&(this.audios.forEach((function(e){e.resume()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.resume()})))},t.stopAll=function(){var e=this;this.audios.forEach((function(e){e.stop()})),this.audioSpriteKeys.forEach((function(t){var n;null==(n=e.markers[t])||n.stop()}))},t.pause=function(e){var t=this.audios.get(e);t&&t.pause()},t.stop=function(e){var t=this.audios.get(e);t&&t.stop()},t.setVolume=function(e){this.volume=e},e}(),F=Z,U=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).soundManager=void 0,t.isMuteAll=void 0,t.musicVolume=void 0,t.musicManager=void 0,t.initMusic=function(){t.musicManager=new G(t.game),t.setMusicVolume(t.musicVolume)},t.initSound=function(){t.soundManager=new F(t.game),t.setSoundVolume(1)},t.isMusicEnabled=function(){return t.musicManager.isMusicEnabled()},t.isSoundEnabled=function(){return t.soundManager.isSoundEnabled()},t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),this.musicVolume=1,this.initSound(),this.initMusic()},n.importSoundEffectKeys=function(e){this.soundManager.addSoundKeys(e)},n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll)return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.playAudioSprite=function(e,t,n,i){try{if(!this.soundManager||this.isMuteAll)return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.playAudioSprite(e,t,n,i)}catch(a){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e,t){void 0===e&&(e=""),void 0===t&&(t={});try{if(!this.musicManager||this.isMuteAll)return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play(e,(0,a.Z)({loop:!0,volume:this.musicManager.volume},t))}catch(n){}},n.isMusicPlaying=function(e){try{return!!this.musicManager&&this.musicManager.isPlaying(e)}catch(t){return!1}},n.setMusicKey=function(e){try{if(!this.musicManager)return;this.musicManager.setMusicKey(e)}catch(t){}},n.getMusicKey=function(){try{return this.musicManager?this.musicManager.getMusicKey():""}catch(e){return""}},n.pauseAllMusics=function(){try{if(!this.musicManager)return;this.musicManager.pauseAll()}catch(e){}},n.pauseMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.pause(e)}catch(t){}},n.resumeMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.resume(e)}catch(t){}},n.stopMusic=function(e){void 0===e&&(e="");try{if(!this.musicManager)return;this.musicManager.stop(e)}catch(t){}},n.pauseAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.pauseAll()}catch(e){}},n.resumeAllSounds=function(){try{if(!this.soundManager)return;this.soundManager.resumeAll()}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){}},n.setMusicVolume=function(e){try{this.musicManager?this.musicManager.setVolume(e):this.musicVolume=e}catch(t){}},n.getMusicVolume=function(){return this.musicManager?this.musicManager.volume:this.musicVolume},n.getSoundVolume=function(){return this.soundManager.volume},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),W=U,H=n(24),Y=n(26),K="AUTH_TOKEN_REQUEST",z="AUTH_TOKEN_RECEIVED",V=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),j=n(69),X="auth",q=(0,j.P1)([function(e){return e[X].token}],(function(e){return e})),J=(0,j.P1)([function(e){return e[X].isRequesting}],(function(e){return e})),Q=function(e){return{type:z,payload:{token:e}}},$=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,a=n(),r=q(a),!J(a)&&""===r){e.next=7;break}return e.abrupt("return");case 7:return t({type:K,payload:{}}),e.next=10,i.getPlayerToken();case 10:s=e.sent,t(Q(s)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(Q("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,Y.tO)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,Y.tO)(new V);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return q(this.state)},(0,H.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),ee=$,te=n(60),ne=n(62),ie=n(63),ae=new ne.Z("10","Your Friend",ie.Z.AVATAR.FILE).toObject(),re=["1","2","3","4","5","6","7","8","9","10","11","12"],se=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),oe=n(72),ce=n(71),he=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),ue=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),le=n(59),de=GameCore.Configs,pe=de.AppId,fe=de.Network,me=function(e){if(!e.ok)throw new he(null,{response:e})},ge=function(){var e=window.game.auth.getToken();return{token:e,timeout:fe.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},ve=function(e,t,n,i){return(0,r.Z)(c().mark((function a(){var r,s,o,h,u;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r=e+"/apps/"+pe+"/"+t,s=new AbortController,n.signal=s.signal,o=setTimeout((function(){s.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=JSON.stringify(i)),a.next=8,fetch(r,n);case 8:return h=a.sent,clearTimeout(o),me(h),a.next=13,h.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return u=a.t0,a.abrupt("return",u);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof he)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new ue(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},ye=function(){var e=(0,r.Z)(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof ue&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,le.qZ)(600);case 10:return e.next=12,ye(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof ue)){e.next=20;break}return e.abrupt("return",{});case 20:return e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),Ee=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,r){var s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===r&&(r=fe.Retries),e.prev=2,s=(0,a.Z)({},ge(),n,{method:"GET"}),o=ve(i,t,s),e.next=7,ye(o,r);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,r,s){var o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i={}),void 0===s&&(s=fe.Retries),e.prev=2,o=(0,a.Z)({},ge(),i,{method:"POST"}),h=ve(r,t,o,n),e.next=7,ye(h,s);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a,r){return e.apply(this,arguments)}}(),Ae="global",we="friend",Se=GameCore.Configs,be=Se.ApiHost,Te=Se.OtherHost,xe=Se.LeadersBoard,Pe=xe.Prefix,ke=xe.LeaderboardId,Ie=xe.Name,Oe=Pe+"/"+ke+"/leaders",Re=Pe+"/"+ke+"/players",Be=function(e){var t="";return ke?(e===Ae?t=Oe:e===we&&(t=Re),t):t},De=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.playerId})),i=GameCore.Utils.Object.keyBy(t,"playerId"),r=GameCore.Utils.String.params({playerIds:n}),e.next=5,Ee("players?"+r,{},be);case 5:return s=e.sent,o=s.data.map((function(e){var t=i[e.playerId];return(0,a.Z)({},e,{score:t.score,rank:t.rank,getScore:function(){return t.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return t.rank},getExtraData:function(){return t.extraData},getPlayer:function(){return{getName:function(){return e.name},getPhoto:function(){return e.photo},getID:function(){return e.playerId}}}})})),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return i="leaderboards/"+t+"/ranks/"+n,e.next=5,Ee(""+i,{},Te);case 5:if((a=e.sent)&&(null==a||!a.error)){e.next=8;break}return e.abrupt("return",null);case 8:if(a.data&&null!=a.data.score&&null!=a.data.rank){e.next=10;break}return e.abrupt("return",{rank:-1,score:-1});case 10:return e.abrupt("return",{rank:(null==a?void 0:a.data.rank)+1,score:null==a?void 0:a.data.score});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_e=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==ke){e.next=3;break}return e.abrupt("return",Me(t));case 3:return e.abrupt("return",Ne(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=Be(Ae)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,Ee(i+"?"+a,{},Te);case 8:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=s,e.abrupt("return",De(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(Ie);case 4:return r=e.sent,e.next=7,r.getEntriesAsync(i,a);case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==ke){e.next=3;break}return e.abrupt("return",Ze(t));case 3:return e.abrupt("return",Fe(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=Be(we)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,Ee(i+"?"+a,{},Te);case 8:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=s,e.abrupt("return",De(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(Ie);case 4:return r=e.sent,e.next=7,r.getConnectedPlayerEntriesAsync(i,a);case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=(function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==ke){e.next=2;break}return e.abrupt("return",Ue(t));case 2:return e.abrupt("return",We());case 3:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=Be(we)){e.next=6;break}return e.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:t}),e.next=9,Ee(i+"?"+a,{},Te);case 9:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return e.next=15,De(s);case 15:return n=e.sent[0],e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),We=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(Ie);case 2:return t=e.sent,e.next=5,t.getPlayerEntryAsync();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=(0,r.Z)(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.GameSDK.submitGameResultsAsync(n).catch((function(e){})),null==ke){e.next=5;break}if(""!==window.game.auth.getToken()){e.next=4;break}return e.abrupt("return",Promise.reject("Not logged in"));case 4:return e.abrupt("return",Ye(t,n));case 5:return e.abrupt("return",Ke(n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce("leaderboards/"+ke+"/players/"+t,{score:n},{},Te);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ke=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(Ie);case 2:return n=e.sent,e.next=5,n.setScoreAsync(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Ve="share_invite",je="challenge_friend_match",Xe="match",qe=function(e){return e[Xe]},Je=(0,j.P1)([function(e){return qe(e).gameplay.mode}],(function(e){return e})),Qe=((0,j.P1)([function(e){return qe(e).gameplay.status}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).gameplay.rescued}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).gameplay.startAt}],(function(e){return e}))),$e=(0,j.P1)([function(e){return qe(e).gameplay.finishAt}],(function(e){return e})),et=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LeaderboardNotFound",i.message=t||"Leaderboard not found",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),tt=GameCore.Configs,nt=tt.AppId,it=tt.OtherHost,at=tt.ApiHost,rt=tt.LeadersBoard,st=(tt.Tournament,tt.WeeklyTournament),ot=(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={appId:nt,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!rt.UseMock){e.next=5;break}return e.next=4,(0,le.qZ)(1e3);case 4:return e.abrupt("return",(0,a.Z)({},n,t,{_id:rt.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",e.next=8,Ce("leaderboards",(0,a.Z)({},n,t),{},it);case 8:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!st.UseLeaderboardMock||st.LeaderboardMockId){e.next=4;break}for(i=0;i<t.length;i++)a={gold:Math.floor(2*Math.random()),silver:Math.floor(2*Math.random()),bronze:Math.floor(2*Math.random())},n.push({playerId:t[i],achievement:a});return e.abrupt("return",n);case 4:return"players",r=GameCore.Utils.String.params({playerIds:t}),e.next=8,Ee("players?"+r,{},at);case 8:if((s=e.sent)&&(null==s||!s.error)){e.next=12;break}return e.abrupt("return",n);case 12:if(!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=15;break}return e.abrupt("return",n);case 15:for(h=0;h<o.length;h++)l=o[h],d=(null==(u=l.customFields)||null==(u=u.weeklyTournament)?void 0:u.achievement)||void 0,p=l.playerId,n.push({playerId:p,achievement:d});return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ct=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],r=GameCore.Utils.String.params({start:n,stop:i}),s="leaderboards/"+t+"/ranges?"+r,e.next=5,Ee(""+s,{},it);case 5:if((o=e.sent)&&(null==o||!o.error)){e.next=9;break}return e.abrupt("return",[]);case 9:if(!((h=(null==o?void 0:o.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",a);case 12:return a=h,e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),ht=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l,d,p,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),void 0===i&&(i=!1),t){e.next=4;break}return e.abrupt("return",[]);case 4:if(a=[],!i){e.next=10;break}return e.next=8,(0,le.qZ)(1e3);case 8:return s=(r=n).limit,o=void 0===s?10:s,h=r.offset,u=void 0===h?0:h,e.abrupt("return",new Array(o).fill(null).map((function(e,t){var n=(t+1)*(u+1),i=rt.MockOptions.PlayerEntryIndex===t,a={playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())};if(i){var r=window.game.player.getPlayer(),s=r.playerId,o=r.name,c=r.photo;a.playerId=s,a.name=o,a.photo=c}return a})));case 10:return l=GameCore.Utils.String.params(n),d="leaderboards/"+t+"/leaders",e.next=14,Ee(d+"?"+l,{},it);case 14:if((p=e.sent)&&(null==p||!p.error)){e.next=18;break}return e.abrupt("return",[]);case 18:if(!((f=(null==p?void 0:p.data)||[]).length<1)){e.next=21;break}return e.abrupt("return",a);case 21:return a=f,e.abrupt("return",a);case 23:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),ut=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce("leaderboards/"+t+"/players/"+n,{score:i},{},it);case 2:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),lt=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!st.UseLeaderboardMock){e.next=7;break}return e.next=3,(0,le.qZ)(1e3);case 3:return 4,0,t=Math.round((6048e5+(new Date).getTime())/1e3),e.abrupt("return",new Array(4).fill(null).map((function(e,n){var i=1*(n+1);return{id:""+i,title:""+("Who's the winner?\nCome and play now! "+i),endTime:t,contextID:"context: "+i,payload:{playerId:"",playerName:"",leaderboardId:"1234"+i}}})));case 7:return n=GameCore.Utils.String.params({limit:100,type:"world_tournament_leaderboard"}),"leaderboards",e.next=11,Ee("leaderboards?"+n,{},it);case 11:if((i=e.sent)&&(null==i||!i.error)){e.next=14;break}throw new et;case 14:a=(null==i?void 0:i.data)||[],r=[],s=0;case 17:if(!(s<a.length)){e.next=28;break}if(""!=a[s].description){e.next=20;break}return e.abrupt("continue",25);case 20:o=JSON.parse(a[s].description),h=new Date(a[s].createdAt).getTime(),u=Math.round(604800+h/1e3),l={id:o.tournamentID,title:a[s].name,endTime:u,contextID:o.contextID,payload:{playerId:"",playerName:"",leaderboardId:a[s]._id}},r.push(l);case 25:s++,e.next=17;break;case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),dt="TOURNAMENT_ACTIVE",pt="TOURNAMENT_REQUEST",ft="TOURNAMENT_RECEIVED";function mt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}GameCore.Configs.Tournament.UseLeaderboard;var vt=function(e,t){return void 0===t&&(t=""),{type:dt,payload:{tournamentId:e,leaderboardId:t}}},yt=function(e){return(0,r.Z)(c().mark((function t(){var n,i,a,r,s;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.facebook,i=e.playerId,a=e.playerName,r=e.score,s={score:r,data:{type:"tournament",playerId:i,playerName:a}},t.next=5,n.tournament.shareAsync(s);case 5:case"end":return t.stop()}}),t)})))},Et=(function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:if(n=e.sent,null!=(i=JSON.parse(n.getPayload()||"{}")).leaderboardId){e.next=21;break}return e.next=9,lt();case 9:a=e.sent,r=n.getContextID(),s={payload:{}},o=mt(a);case 13:if((h=o()).done){e.next=20;break}if((u=h.value).contextID!==r){e.next=18;break}return s=u,e.abrupt("return",s.payload.leaderboardId);case 18:e.next=13;break;case 20:return e.abrupt("return",s.payload.leaderboardId||"");case 21:return e.abrupt("return",i.leaderboardId);case 24:return e.prev=24,e.t0=e.catch(0),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})))}(),function(e,t){return void 0===t&&(t=!0),function(){var n=(0,r.Z)(c().mark((function n(i,a){var r,s;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game.globalScene,s=a(),Je(s),i({type:pt,payload:{}}),t&&r.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),n.next=7,bt(e,s);case 7:t&&r.screen.close(ce.o4.NOTIFY_SCREEN),i(Pt(e));case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}),Ct=0,At=!1,wt=0,St=!1,bt=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game,a=i.player,r=i.facebook,s=a.getPlayer(),o=s.playerId,h=s.name,e.prev=2,u=window.game.scene.getScene(oe.C.GAME_SCENE),l=u.weeklyTournament.getPlayerWeeklyTournamentData().leaderboardId,!xt()){e.next=16;break}return e.next=8,r.getTournamentAsync();case 8:return Ct+=1,d={playerId:o,playerName:h,score:t,leaderboardId:l},e.next=12,window.game.storage.dispatch(yt(d)).then((function(){At=!0}));case 12:window.game.weeklyTournament.logTournamentShare(),At=!0,e.next=17;break;case 16:r.getTournamentAsync().then((function(){r.tournament.postScoreAsync(t)}));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2);case 22:return e.prev=22,e.finish(22);case 24:case"end":return e.stop()}}),e,null,[[2,19,22,24]])})));return function(t,n){return e.apply(this,arguments)}}(),Tt=function(e,t){return!window.game.player.getPlayerIsNew()&&e>t||!(St||wt>1)&&Math.random()<.5},xt=function(){return!(At||Ct>3)&&Math.random()<1/(Ct||1)},Pt=(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.facebook,r=i.getBestScore(),e.prev=2,e.next=5,a.getTournamentAsync();case 5:if(!xt()){e.next=12;break}return Ct+=1,e.next=9,a.tournament.shareAsync({score:t});case 9:At=!0,e.next=14;break;case 12:return e.next=14,a.tournament.postScoreAsync(t);case 14:e.next=24;break;case 16:if(e.prev=16,e.t0=e.catch(2),"TOURNAMENT_NOT_FOUND"!==e.t0.code){e.next=24;break}if(Tt(t,r)){e.next=21;break}return e.abrupt("return");case 21:return wt+=1,e.next=24,a.createTournamentAsync(t).then((function(){St=!0})).catch((function(e){}));case 24:case"end":return e.stop()}}),e,null,[[2,16]])})))}(),function(e){return{type:ft,payload:{score:e}}}),kt=n(68),It="single",Ot="challenge-friends",Rt="matching-group",Bt="tournaments",Dt=(0,j.P1)([function(e){return e.context}],(function(e){return e})),Lt=(0,j.P1)([function(e){return e.context.currentGameMode}],(function(e){return e})),_t=function(e,t){return{type:kt.fJ,payload:{contextId:e,contextType:t}}},Mt=function(e){return function(t){t({type:kt.EH,payload:{gameMode:e}}),(0,Y.sw)("game-mode",e)}},Nt="MATCH_GAMEPLAY_INITIALIZE",Gt="MATCH_GAMEPLAY_START",Zt="MATCH_GAMEPLAY_FINISH",Ft="MATCH_GAMEPLAY_UPDATE",Ut="MATCH_STATS_DATA_CLEAR",Wt="MATCH_STATS_DATA_UPDATE",Ht="MATCH_STATS_CURRENT_UPDATE",Yt="MATCH_SINGLE_CREATE_REQUEST",Kt="MATCH_SINGLE_DETAIL_REQUEST",zt="MATCH_SINGLE_DATA_RECEIVED",Vt="MATCH_SINGLE_DATA_CLEAR",jt="MATCH_CHALLENGE_JOIN_REQUEST",Xt="MATCH_CHALLENGE_CREATE_REQUEST",qt="MATCH_CHALLENGE_FINISH_REQUEST",Jt="MATCH_CHALLENGE_CONTINUE_REQUEST",Qt="MATCH_CHALLENGE_DATA_RECEIVED",$t="MATCH_CHALLENGE_DATA_CLEAR",en="MATCH_GROUP_CREATE_REQUEST",tn="MATCH_GROUP_FINISH_REQUEST",nn="MATCH_ONLINE_CREATE_REQUEST",an="MATCH_ONLINE_DATA_RECEIVED",rn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchId",i.message=t||"Invalid match id",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),sn=function(e,t){return t.playerId},on=function(e){return qe(e).match.challenge},cn=((0,j.P1)([function(e){return qe(e).match.isRequesting}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.single}],(function(e){return e}))),hn=(0,j.P1)([function(e){return qe(e).match.single._id}],(function(e){return e})),un=(0,j.P1)([function(e){return qe(e).match.single.score}],(function(e){return e||0})),ln=((0,j.P1)([function(e){return qe(e).match.single.level}],(function(e){return e||0})),(0,j.P1)([function(e){var t;return null==(t=qe(e).match.single.data)?void 0:t.diamond}],(function(e){return e||0})),(0,j.P1)([function(e){var t;return null==(t=qe(e).match.single.data)?void 0:t.fen}],(function(e){return e||null})),(0,j.P1)([function(e){return qe(e).match.single.status}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.single.playerId}],(function(e){return e})),(0,j.P1)([on],(function(e){return e}))),dn=(0,j.P1)([function(e){return qe(e).match.challenge._id}],(function(e){return e})),pn=(0,j.P1)([function(e){return qe(e).match.challenge.status}],(function(e){return e})),fn=(0,j.P1)([function(e){return qe(e).match.challenge.opponentInfo}],(function(e){return e})),mn=((0,j.P1)([function(e){return qe(e).match.challenge.whitePlayerId}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.challenge.blackPlayerId}],(function(e){return e})),(0,j.P1)([ln,sn],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n!==t&&i===t?n:i!==t&&n===t?i:""})),(0,j.P1)([ln,sn],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n===t?n:i===t?i:ae.playerId}))),gn=(0,j.P1)([ln,sn],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,r=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&r})),vn=(0,j.P1)([ln,function(e,t){return t.opponentId}],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,r=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&r})),yn=((0,j.P1)([on],(function(e){return e.extraData})),(0,j.P1)([function(e){return qe(e).match.group.opponentInfo}],(function(e){return e}))),En=((0,j.P1)([function(e){return qe(e).match.online.players}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.journey}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.journey._id}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.journey.level}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).match.challenge.matchResultFromMessage}],(function(e){return e})),(0,j.P1)([function(e){return qe(e).stats.data}],(function(e){return e}))),Cn=(0,j.P1)([function(e){return qe(e).stats.current}],(function(e){return e})),An=((0,j.P1)([function(e){return qe(e).stats.isRequesting}],(function(e){return e})),n(14)),wn=function(e){try{var t=localStorage.getItem(e);return null===t?null:GameCore.Utils.Json.decode(t)}catch(n){return null}},Sn=function(e,t){try{var n=wn(e),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(t);if(!GameCore.Utils.Valid.isObject(a))return!1;var r=GameCore.Utils.Object.clear(a),s=(0,An.TS)(i,r),o=GameCore.Utils.Json.encode(s);return localStorage.setItem(e,o),!0}catch(c){return!1}},bn=GameCore.Configs.ApiHost,Tn=(function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches",e.next=3,Ce("single-matches",t,{},bn);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches/active",e.next=3,Ee("single-matches/active",{},bn);case 3:return t=e.sent,e.abrupt("return",(null==t?void 0:t.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="single-matches/"+t+"/move",e.next=3,Ce(i,n,{},bn);case 3:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="single-matches/"+t+"/finish",e.next=3,Ce(n,{},{},bn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"matches",e.next=3,Ce("matches",{opponentPlayerId:t,extraData:n},{},bn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),xn=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t+"/join",e.next=3,Ce(n,{},{},bn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pn=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t,e.next=3,Ee(n,{},bn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kn=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="matches/"+t+"/finish",e.next=3,Ce(r,{matchId:t,score:n,level:i,extraData:a},{},bn);case 3:return s=e.sent,e.abrupt("return",(null==s?void 0:s.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),In="open",On="active",Rn="finished",Bn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchStatus",i.message=t||"The match status is not valid",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Dn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"Invalid opponent id",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Ln=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),_n=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidBlackPlayerId",i.message=t||"Invalid black player id",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Mn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidRequestedMatchId",i.message=t||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Nn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidWhitePlayerId",i.message=t||"Invalid white player id",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Gn=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new rn(null,{matchId:t});if(""===n||"string"!==typeof n)throw new rn(null,{currentMatchId:n});if(t!==n)throw new Mn(null,{matchId:t,currentMatchId:n})},Zn=function(e){var t=e.playerId,n=e.match,i=n._id,a=n.playerId,r=n.status;if(""===i||"string"!==typeof i)throw new rn(null,{matchId:i});if("finished"===r||"string"!==typeof r)throw new Bn("This match is finished",{status:r});if(a!==t)throw new Ln(null,{playerId:a,currentPlayerId:t})},Fn=function(e){var t=e.opponentId;if(""===t||"string"!==typeof t)throw new Dn(null,{opponentId:t})},Un=function(e){var t=e.matchId;if(""===t||"string"!==typeof t)throw new rn(null,{matchId:t})},Wn=function(e){var t=e.match,n=t._id,i=t.whitePlayerId,a=t.blackPlayerId;if(""===n||"string"!==typeof n)throw new rn(null,{matchId:n});if(""===i||"string"!==typeof i)throw new Nn(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new _n(null,{blackPlayerId:a})},Hn=GameCore.Configs.Match,Yn=function(e){try{return GameCore.Utils.Hash.stringToHash(JSON.stringify(e))}catch(t){return""}},Kn=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},zn=function(){return function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=window.game,i=n.player,n.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:"112Loading...",loading:!0}),t({type:Yt,payload:{}}),r=i.getPlayerId(),s=(0,a.Z)({},Hn.LocalSingleMatchDefault,{status:"active",playerId:r,startedAt:Date.now()}),Zn({playerId:r,match:s}),t(jn(s)),Sn(Hn.SingleMatchStore,s),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(0),t(jn(null)),!(e.t0 instanceof rn)){e.next=16;break}return e.abrupt("return");case 16:if(!(e.t0 instanceof Bn)){e.next=18;break}return e.abrupt("return");case 18:(0,Y.tO)(e.t0);case 19:return e.prev=19,window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[0,11,19,22]])})));return function(t){return e.apply(this,arguments)}}()},Vn=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n,i){var r,s,o,h,u,l,d,p;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=window.game.player,Un({matchId:e}),s=i(),o=hn(s),h=r.getPlayerId(),Gn({matchId:e,currentMatchId:o}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:e}}),u=cn(s),Zn({playerId:h,match:u}),l=(0,a.Z)({},Hn.LocalSingleMatchDefault,u,{_id:e,status:"finished",playerId:h,finishAt:Date.now()}),n(jn(l)),d=l.data,(p=(0,a.Z)({},l)).data=Yn(d),Sn(Hn.SingleMatchStore,p),t.next=26;break;case 18:if(t.prev=18,t.t0=t.catch(0),n(jn(null)),!(t.t0 instanceof rn)){t.next=23;break}return t.abrupt("return");case 23:if(!(t.t0 instanceof Bn)){t.next=25;break}return t.abrupt("return");case 25:(0,Y.tO)(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,n){return t.apply(this,arguments)}}()},jn=function(e){return{type:zt,payload:{match:e}}},Xn=function(){return{type:Vt,payload:{}}},qn=function(e,t,n){return function(){var i=(0,r.Z)(c().mark((function i(a){var r,s,o,h,u;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,r=window.game,s=r.profile,o=r.globalScene,n&&o.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),h=e.playerId,Fn({opponentId:h}),a({type:Xt,payload:{opponentInfo:e,extraData:t}}),i.next=8,Tn(h,t);case 8:return u=i.sent,Wn({match:u}),i.next=12,s.requestProfiles([h]);case 12:a(ei(u)),i.next=23;break;case 15:if(i.prev=15,i.t0=i.catch(0),a(ei(null)),!(i.t0 instanceof rn)){i.next=20;break}return i.abrupt("return");case 20:if(!(i.t0 instanceof Dn)){i.next=22;break}return i.abrupt("return");case 22:(0,Y.tO)(i.t0);case 23:return i.prev=23,n&&window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),i.finish(23);case 26:case"end":return i.stop()}}),i,null,[[0,15,23,26]])})));return function(e){return i.apply(this,arguments)}}()},Jn=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r,s,o,h,u,l,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,r=i.profile,i.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),Un({matchId:e}),n({type:jt,payload:{matchId:e}}),t.next=7,xn(e);case 7:if(s=t.sent,Wn({match:s}),o=s.status,h=s.whitePlayerId,u=s.blackPlayerId,o!==On){t.next=16;break}return l=a.getPlayerId(),d=l===h?u:h,t.next=16,r.requestProfiles([d]);case 16:n(ei(s)),t.next=25;break;case 19:if(t.prev=19,t.t0=t.catch(0),n(ei(null)),!(t.t0 instanceof rn)){t.next=24;break}return t.abrupt("return");case 24:(0,Y.tO)(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}()},Qn=function(e,t){return function(){var n=(0,r.Z)(c().mark((function n(i){var a,r,s,o,h,u,l,d,p;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,r=a.player,a.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),Un({matchId:e}),i({type:Jt,payload:{matchId:e,opponentInfo:t}}),n.next=7,Pn(e);case 7:s=n.sent,Wn({match:s}),o=s.whitePlayerId,h=s.whitePlayerScore,u=s.blackPlayerScore,l=r.getPlayerId(),d=r.getPlayerData(),p=d.score,i(ei(s,{score:l===o?h:u,bestScore:p})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(ei(null)),!(n.t0 instanceof rn)){n.next=22;break}return n.abrupt("return");case 22:(0,Y.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(e){return n.apply(this,arguments)}}()},$n=function(e,t,n){return function(){var i=(0,r.Z)(c().mark((function i(a){var r,s;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,Un({matchId:e}),a({type:qt,payload:{matchId:e,score:t,extraData:n}}),r=n.level,i.next=6,kn(e,t,r,n);case 6:return s=i.sent,Wn({match:s}),i.next=10,a(ei(s));case 10:i.next=18;break;case 12:if(i.prev=12,i.t0=i.catch(0),a(ei(null)),!(i.t0 instanceof rn)){i.next=17;break}return i.abrupt("return");case 17:(0,Y.tO)(i.t0);case 18:case"end":return i.stop()}}),i,null,[[0,12]])})));return function(e){return i.apply(this,arguments)}}()},ei=function(e,t,n){return void 0===n&&(n=null),{type:Qt,payload:{match:e,opponentInfo:t,current:n}}},ti=function(e){return{type:en,payload:{opponentInfo:e}}},ni=function(e,t){return{type:an,payload:{matchId:e,players:t}}},ii=function(e){return{type:Ut,payload:{playerId:e}}},ai=function(e,t){return{type:Wt,payload:{playerId:e,stats:t}}},ri=function(e){return{type:Ht,payload:{stats:e}}},si=function(e){return e.SINGLE="single",e.CHALLENGE_FRIENDS="challenge-friends",e.TOURNAMENT="tournaments",e}(si||{}),oi=si,ci=function(e){return e.GAME_MODE_CHANGED="game-mode-changed",e.BACKGROUND_CHANGED="background-changed",e.GAME_START="game-start",e.COIN_CHANGED="coin-changed",e.HEART_CHANGED="heart-changed",e.WILDCARD_CHANGED="wildcard-changed",e.UNDO_CHANGED="undo-changed",e.PLUS_FIVE_CHANGED="plus-five-changed",e.STAR_CHANGED="star-changed",e.WC_JOIN_BTN_CLICKED="wc-join-btn-clicked",e.WC_JOINED="wc-joined",e.HIDE_GUIDE="hide-guide",e.OPEN_PLAY_SCREEN_FROM_DASHBOARD="open-play-screen-from-dashboard",e.LOCATION_DECORATION_OPEN="opening-location-decoration",e.OPENED_LOCATION_DECORATION="opened-location-decoration",e.PLAYER_FINISH_CHALLENGE="player-finish-challenge",e.CHALLENGE_SCORE_CHANGED="player-challenge-score-changed",e.CHALLENGE_REWARD_DONE="challenge-reward-done",e.MAP_PLAYERS_CHANGED="map-players-challenged",e.CHALLENGE_WITH_PLAYER_ID_STARTED="challenge-with-player-id-started",e.LEADERBOARD_UPDATED="leaderboard-updated",e.AUTO_SHOWING_JOURNEY="auto-showing-journey",e.MISSION_REWARDED="MISSION_REWARDED",e.BACK_TO_DASHBOARD="back-to-dashboard",e.PREVENT_SHOW_EVENTS="prevent-show-events",e.DECORATION_UPGRADE="decoration-upgrade",e.DECORATION_UPGRADED="decoration-upgraded",e.CANNOT_UPGRADE_DECORATION="cannot-upgrade-decoration",e}(ci||{}),hi=ci,ui=function(e){function t(){var t;return(t=e.call(this)||this).gameMode=void 0,t.autoPlaySingleMode=void 0,t.friendsChallenged=void 0,t.isGameLoadedInTournament=!1,t.autoPlaySingleMode=!0,t.friendsChallenged=[],t}(0,s.Z)(t,e);var n=t.prototype;return n.setGameMode=function(e){this.gameMode=e,this.emit(hi.GAME_MODE_CHANGED)},n.getGameMode=function(){return this.gameMode},n.isSingleMode=function(){return this.getGameMode()==oi.SINGLE},n.isChallengeMode=function(){return this.getGameMode()==oi.CHALLENGE_FRIENDS},n.isTournamentMode=function(){return this.getGameMode()===oi.TOURNAMENT},n.switchContext=function(){},(0,H.Z)(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t)}}]),t}(Phaser.Events.EventEmitter);ui._instance=void 0;var li=ui,di=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new se(null,{contextId:t})},pi=null,fi=function(e){clearTimeout(pi),pi=setTimeout((function(){window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN)}),e)},mi=function(e){return function(t){try{if(t(Xn()),e){var n=e.getPayload(),i=e.getID();if(n){var a=JSON.parse(n).leaderboardId;t(vt(i.toString(),a)),window.game.weeklyTournament.joinFromPost(i.toString())}}t(wi(Bt))}catch(r){(0,Y.tO)(r)}}},gi=function(){return function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t(Xn()),t(wi(It))}catch(n){(0,Y.tO)(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},vi=function(e,t){return void 0===e&&(e="10"),void 0===t&&(t=!1),function(){var n=(0,r.Z)(c().mark((function n(i){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i(yi("reset",e,t));case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),(0,Y.tO)(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})));return function(e){return n.apply(this,arguments)}}()},yi=function(e,t,n){return void 0===n&&(n=!0),function(){var i=(0,r.Z)(c().mark((function i(a,r){var s,o,h,u,l,d,p,f,m,g,v,y,E,C,A,w,S,b;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,s=void 0===e,o=window.game,h=o.player,u=o.facebook,l=o.globalScene,n&&l.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),d=t,p=e,f=u.contextType,d||(m=GameCore.Configs.PlayerIdMock,g=GameCore.Configs.PlayerIdMock2,d=h.getPlayerId()===m?g:m),e){i.next=17;break}return i.next=11,u.chooseAsync();case 11:if(!1!==(p=i.sent)){i.next=15;break}return l.boxingDuel.events.emit("start-find-bot"),i.abrupt("return",!1);case 15:i.next=18;break;case 17:d&&!re.includes(d)&&(p=e);case 18:return di({contextId:p}),v=h.getPlayerId(),i.next=22,u.getContextPlayers(v);case 22:if(y=i.sent,E=ae,""===d?1===y.length&&(E=y[0]||ae):E=1===y.length?y[0]||ae:h.getConnectedPlayers()[d]||ae,A=(C=E).name,w=C.photo,S=C.playerId,b={playerId:S,name:A,photo:w},!s){i.next=31;break}return i.next=30,l.boxingDuel.startNewMatch(b,p);case 30:return i.abrupt("return");case 31:return di({contextId:p}),a(ii()),i.next=35,a(wi(Ot,b,n));case 35:return a(_t(p,f)),i.abrupt("return",!0);case 39:if(i.prev=39,i.t0=i.catch(0),!(i.t0 instanceof se)){i.next=43;break}return i.abrupt("return");case 43:if("USER_INPUT"!==(null==i.t0?void 0:i.t0.code)){i.next=45;break}return i.abrupt("return");case 45:if("INVALID_OPERATION"!==(null==i.t0?void 0:i.t0.code)){i.next=47;break}return i.abrupt("return");case 47:(0,Y.tO)(i.t0);case 48:return i.prev=48,n&&fi(10),i.finish(48);case 51:case"end":return i.stop()}}),i,null,[[0,39,48,51]])})));return function(e,t){return i.apply(this,arguments)}}()},Ei=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r,s,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.facebook,r=i.globalScene,s=i.analytics,r.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),o=a.getContextID(),di({contextId:o}),s.event(te._.JOIN_GROUP,{group_id:o}),t.next=8,n(wi(Rt,e));case 8:t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof se)){t.next=14;break}return t.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==t.t0?void 0:t.t0.code)){t.next=16;break}return t.abrupt("return");case 16:(0,Y.tO)(t.t0);case 17:return t.prev=17,fi(100),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,10,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Ci=function(e,t){return function(){var n=(0,r.Z)(c().mark((function n(i,a){var r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,s=r.player,o=r.profile,h=r.facebook,(u=r.globalScene).screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),l=a(),d=s.getPlayerId(l),!((p=s.getConnectedPlayers(l)).length>0)||p[t]){n.next=10;break}return i(Ti({mode:It})),u.events.emit(oe.K.SWITCH,oe.C.GAME_SCENE),n.abrupt("return");case 10:return f=ae,n.next=13,h.getContextPlayers(d);case 13:if(m=n.sent,t===d||re.includes(t)||!p[t]){n.next=18;break}f=p[t],n.next=26;break;case 18:if(1!==m.length){n.next=22;break}f=m[0],n.next=26;break;case 22:return n.next=24,o.requestProfiles([t]);case 24:(g=o.getProfiles())[t]&&(f=g[t]);case 26:return v=u.boxingDuel,n.next=29,v.startMatchFromOpponentData(e,t);case 29:if(n.sent){n.next=35;break}return i(Ti({mode:It})),u.events.emit(oe.K.SWITCH,oe.C.GAME_SCENE),n.abrupt("return");case 35:return n.next=37,i(Qn(e,f));case 37:if(l=a(),mn(l,{playerId:d})!==ae.playerId){n.next=42;break}return n.next=42,i(Jn(e));case 42:if(l=a(),mn(l,{playerId:d})===d||!p[t]){n.next=47;break}return i(vi(t,!0)),n.abrupt("return");case 47:if(dn(l)===e){n.next=51;break}return i(gi()),n.abrupt("return");case 51:y=pn(l),E=gn(l,{playerId:d}),C=h.getContextID(),A=h.contextType,i(_t(C,A)),i(Ti(E?{mode:It}:{mode:Ot,status:y})),u.events.emit(oe.K.SWITCH,oe.C.GAME_SCENE),n.next=63;break;case 60:n.prev=60,n.t0=n.catch(0),(0,Y.tO)(n.t0);case 63:return n.prev=63,fi(500),n.finish(63);case 66:case"end":return n.stop()}}),n,null,[[0,60,63,66]])})));return function(e,t){return n.apply(this,arguments)}}()},Ai=function(e){return function(t){try{var n=window.game.player,i=n.getPlayerId();He(i,e).catch((function(e){(0,Y.tO)(new Error(e))}));var a=n.getPlayerData(),r=a.score,s=void 0===r?0:r,o=a.level;s<e&&n.setBestScore(e);var c={score:e,level:o};t(ai(i,c)),t(ri(c))}catch(h){if(h instanceof ze)return;(0,Y.tO)(h)}}},wi=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=!0),function(){var i=(0,r.Z)(c().mark((function i(a,s){var o,h,u,l,d,p,f,m,g,v,y,E;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,o=window.game,h=o.player,o.analytics,u=o.facebook,l=o.globalScene,d=o.level,d.getLevelData()){i.next=11;break}return i.prev=4,i.next=7,d.preloadLevelDataAsync();case 7:i.next=11;break;case 9:i.prev=9,i.t0=i.catch(4);case 11:if(d.getLevelData()){i.next=15;break}return l.events.emit(oe.K.SWITCH,oe.C.ERROR_SCENE),i.abrupt("return");case 15:if(p=u.getContextID(),f=0,m=s(),a({type:Nt,payload:{}}),!([It,Bt].indexOf(e)>=0)){i.next=28;break}return i.next=22,a((function(e){try{var t=window.game.player;e({type:Kt,payload:{}});var n=t.getPlayerId(),i=wn(Hn.SingleMatchStore)||{},a=i.data;i.data=Kn(a),Zn({playerId:n,match:i}),e(jn(i))}catch(r){if(e(jn(null)),r instanceof rn)return;if(r instanceof Ln)return;if(r instanceof Bn)return;(0,Y.tO)(r)}}));case 22:if(m=s(),hn(m)){i.next=27;break}return i.next=27,a(zn());case 27:f=un(m);case 28:if(e===Rt&&a(ti(t)),e!==Ot){i.next=36;break}return g=window.game.level.getLevel(),v={level:g},i.next=34,a(qn(t,v,n));case 34:m=s(),p||(p=window.FBInstant.context.getID());case 36:"online"===e&&a(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=window.game.player,i=n.getPlayer(),a=i.playerId,r=i.name,s=i.photo,t({type:nn,payload:{playerId:a}}),o={},new Array(20).fill(null).map((function(e,t){var n="0"+(t+1);o[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),o[a]={playerId:a,name:r,photo:s},t(ni("mock",o));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=h.getPlayerData(m),E=y.score,a(ri({score:f,bestScore:void 0===E?0:E})),a({type:Gt,payload:{mode:e,contextId:p}}),li.instance.setGameMode(e),a(Mt(e)),l.events.emit(oe.K.SWITCH,oe.C.GAME_SCENE),i.next=52;break;case 45:if(i.prev=45,i.t1=i.catch(0),!(i.t1 instanceof rn)){i.next=51;break}return window.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),i.abrupt("return");case 51:(0,Y.tO)(i.t1);case 52:return i.prev=52,i.finish(52);case 54:case"end":return i.stop()}}),i,null,[[0,45,52,54],[4,9]])})));return function(e,t){return i.apply(this,arguments)}}()},Si=function(e,t){return function(){var n=(0,r.Z)(c().mark((function n(i,a){var r,s,o,h,u,l,d,p,f,m,g;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=window.game.player,s=t.score,o=void 0===s?0:s,h=t.level,u=void 0===h?0:h,l=t.time,void 0===l?0:l,d=t.moves,void 0===d?0:d,p=a(),!([It,Bt].indexOf(e)>=0)){n.next=7;break}return f=hn(p),n.next=7,i(Vn(f));case 7:if(e===Rt&&(i({type:tn,payload:{}}),m=r.getPlayerId(),i(ai(m,t))),e!==Ot){n.next=12;break}return g=dn(p),n.next=12,i($n(g,o,{level:u}));case 12:i({type:Zt,payload:{mode:e}});case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},bi=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){try{if("SOLO"==window.FBInstant.context.getType())return e();window.FBInstant.context.switchAsync("SOLO",!0);var t=setInterval((function(){"SOLO"==window.FBInstant.context.getType()&&(clearInterval(t),window.game.storage.dispatch(Ti({mode:It})),e())}),200)}catch(n){e()}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ti=function(e){return function(t){var n=e.mode,i=e.status;t({type:Ft,payload:{mode:n,status:i}}),(0,Y.sw)("game-mode",n)}},xi=GameCore.Configs.ApiHost,Pi=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,Ee("players?"+n,{},xi);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ki=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce("players?platform=ms-games",t,{},xi,10);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ii=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce("players/"+t+"/user-guide-displays/inc",{},{},xi);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Oi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ri(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ri(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Bi=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),Di=(function(e){e[e.WON=0]="WON",e[e.LOST=1]="LOST",e[e.DRAW=2]="DRAW"}({}),"show-notification"),Li="finished",_i="find-opponent-completed",Mi="boxing-duel-requested",Ni=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=void 0,t.playerBoxingDuelData=void 0,t.status=void 0,t.isPlayWithFriend=void 0,t.botPlayed=[],t.isRewardScreenShown=void 0,t.notifyEvent=void 0,t.boxingDuelDuration=void 0,t.matchIdFromEntryPointData=void 0,t.checkAndShowBoxingDuelScreen=function(){return!t.isFinished()&&(!!t.isValid()&&(!!t.playerBoxingDuelData.boxingDuelShown&&(t.updateBoxingDuel({boxingDuelShown:!1}),!0)))},t.checkAndShowRewardScreen=function(){return!!t.isFinished()&&(!!t.isRewardScreenShown&&(t.isRewardScreenShown=!1,!0))},t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.BoxingDuel,this.boxingDuelDuration=this.config.Duration},n.initData=function(){this.playerBoxingDuelData=this.game.player.getBoxingDuel(),this.updateDuelWithFriend(),this.updateData(),this.notifyEvent=!0},n.update=function(){this.checkTimeOut(),this.notifyEvent&&this.events.emit(Di)},n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.isCurrentMatchEmpty())?this.setStatus(Bi.WAITING):this.setStatus(Bi.HAPPENING),e.next=4,this.updateOpponentScore(!0);case 4:n=this.playerBoxingDuelData.currentMatch,!t&&n.endTime<(new Date).getTime()&&(this.setStatus(Bi.FINISHED),this.isRewardScreenShown=!0);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateDuelWithFriend=function(){var e=this.playerBoxingDuelData.currentMatch;this.isPlayWithFriend=""!==e.contextId},n.updatePlayerScore=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,r,s,o,h,u,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(n=this.playerBoxingDuelData.currentMatch,i=n.player,0!==(r=n.endTime)){e.next=6;break}return e.abrupt("return",Promise.resolve());case 6:if(!(r<(new Date).getTime())){e.next=8;break}return e.abrupt("return",Promise.resolve());case 8:return s=this.game.player.getPlayer(),o=s.playerId,h=s.name,u=s.photo,l={playerId:o,name:h,photo:u,score:t,lastUpdated:(new Date).getTime(),logStart:i.logStart},d=(0,a.Z)({},n),e.next=13,this.updateBoxingDuel({currentMatch:(0,a.Z)({},d,{player:l})});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateOpponentBotScore=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,r,s,o,h,u,l,d,p,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPlayWithFriend){e.next=2;break}return e.abrupt("return");case 2:if(!(this.playerBoxingDuelData.currentMatch.endTime>(new Date).getTime())){e.next=15;break}for(t=this.getEndTime()-this.boxingDuelDuration,n=(new Date).getTime(),i=n-t,r=this.playerBoxingDuelData.currentMatch.botPlayed,s=0,o=Oi(r);!(h=o()).done;)(u=h.value).timePlayed<=i&&(s=u.score);return l=this.playerBoxingDuelData.currentMatch,d=(0,a.Z)({},l),(p=d.opponent)&&((f=(0,a.Z)({},p)).score=s,f.lastUpdated=(new Date).getTime(),d.opponent=f),e.next=15,this.updateBoxingDuel({currentMatch:d});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateOpponentScore=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,r,s,o,h,u,l,d,p,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),t||this.isHappening()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if(this.isPlayWithFriend&&!this.config.MockOpponent){e.next=6;break}return this.updateOpponentBotScore(),e.abrupt("return",Promise.resolve());case 6:return n=this.playerBoxingDuelData.currentMatch,i=n.matchId,r=n.opponent,e.next=10,this.tryToUpdateOpponentData(r);case 10:return s=e.sent,e.next=13,this.loadOpponentData(s.playerId);case 13:if(o=e.sent){e.next=16;break}return e.abrupt("return",void 0);case 16:if(h=[o.currentMatch].concat(o.historyMatches),""!==i){e.next=19;break}return e.abrupt("return",Promise.resolve());case 19:if(u=h.find((function(e){return e.matchId===i})),u){e.next=23;break}return e.abrupt("return",void 0);case 23:return l=this.playerBoxingDuelData.currentMatch,d=u.player,p={playerId:s.playerId,name:s.name,photo:s.photo,score:Math.max(s.score,d.score),lastUpdated:d.lastUpdated,logStart:d.logStart},f=(0,a.Z)({},l),e.next=29,this.updateBoxingDuel({currentMatch:(0,a.Z)({},f,{opponent:p})});case 29:return e.abrupt("return",Promise.resolve());case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.tryToUpdateOpponentData=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.player.getPlayerId(),e.next=3,this.game.facebook.getContextPlayers(n);case 3:if(!((i=e.sent).length<=0)){e.next=6;break}return e.abrupt("return",t);case 6:return a={playerId:i[0].playerId,name:i[0].name,photo:i[0].photo,score:t.score,lastUpdated:t.lastUpdated,logStart:t.logStart},e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateMatchId=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.playerBoxingDuelData.currentMatch,""===n.matchId){e.next=4;break}return e.abrupt("return");case 4:return(i=(0,a.Z)({},n)).matchId=t,e.next=8,this.updateBoxingDuel({currentMatch:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBoxingDuel=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.playerBoxingDuelData,i=(0,a.Z)({},n,t),this.playerBoxingDuelData=i,e.next=5,this.game.player.updateBoxingDuel(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startNewMatch=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(new Date).getTime()+this.boxingDuelDuration,this.isPlayWithFriend=""!==n,this.isPlayWithFriend&&!this.config.MockOpponent||this.generateBotPlayed(),a=this.game.player.getPlayer(),r=a.playerId,s=a.name,o=a.photo,h={matchId:"",contextId:n,endTime:i,player:{playerId:r,name:s,photo:o,score:0,lastUpdated:0,logStart:!1},opponent:{playerId:t.playerId,name:t.name,photo:t.photo,score:0,lastUpdated:0,logStart:!1},botPlayed:this.botPlayed,matchFinished:!1},this.setStatus(Bi.HAPPENING),e.next=8,this.updateBoxingDuel({currentMatch:h});case 8:this.events.emit(_i),this.logBoxingDuelStart();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.startMatchFromOpponentData=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPlayWithFriend=!1,this.matchIdFromEntryPointData=t,e.next=4,this.loadOpponentData(n);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:if(a=this.findMatchById(i,this.matchIdFromEntryPointData)){e.next=13;break}return e.next=11,bi();case 11:case 21:return e.abrupt("return",void 0);case 13:if(r=a.contextId,s=a.endTime,o=a.player,h=a.opponent,u=this.game.player.getPlayer(),l=u.playerId,d=u.name,p=u.photo,f={playerId:l,name:d,photo:p,score:h.score,lastUpdated:h.lastUpdated,logStart:h.logStart},!(m=this.findMatchById(this.playerBoxingDuelData,this.matchIdFromEntryPointData))){e.next=27;break}if(!m.matchFinished){e.next=23;break}return e.next=21,bi();case 23:return e.next=25,this.updateCurrentMatch(r,s,f,o);case 25:e.next=29;break;case 27:return e.next=29,this.updateCurrentMatch(r,s,f,o);case 29:return this.isPlayWithFriend=!0,this.setStatus(Bi.HAPPENING),this.logBoxingDuelStart(),e.abrupt("return",Promise.resolve());case 33:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.findMatchById=function(e,t){return[e.currentMatch].concat(e.historyMatches).find((function(e){return e.matchId===t}))},n.updateCurrentMatch=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.isCurrentMatchEmpty(),s={matchId:this.matchIdFromEntryPointData,contextId:t,endTime:n,player:i,opponent:a,botPlayed:[],matchFinished:!1},r){e.next=9;break}return(o=[].concat(this.playerBoxingDuelData.historyMatches)).push(this.playerBoxingDuelData.currentMatch),e.next=7,this.updateBoxingDuel({currentMatch:s,historyMatches:o});case 7:e.next=11;break;case 9:return e.next=11,this.updateBoxingDuel({currentMatch:s});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.endCurrentMatch=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logBoxingDuelEnd(),t=this.playerBoxingDuelData.currentMatch,n=(0,a.Z)({},t,{matchFinished:!0}),(i=[].concat(this.playerBoxingDuelData.historyMatches)).push(n),e.next=7,this.updateBoxingDuel({currentMatch:this.getEmptyCurrentMatch(),historyMatches:i});case 7:return this.setStatus(Bi.WAITING),this.notifyEvent=!0,e.next=11,bi();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.loadOpponentData=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pi({playerIds:[t]});case 2:if(0!==(i=e.sent).length){e.next=5;break}return e.abrupt("return",void 0);case 5:return a=null==(n=i[0].customFields)?void 0:n.boxingDuel,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.isValid=function(){var e=this.game.player.getLevel()>=this.config.LevelStart;return this.config.Enable&&e},n.setStatus=function(e){e!=this.status&&(this.status=e)},n.isCurrentMatchEmpty=function(){return 0===this.playerBoxingDuelData.currentMatch.endTime},n.isWaiting=function(){return this.isValid()&&this.status===Bi.WAITING},n.isHappening=function(){return this.isValid()&&this.status===Bi.HAPPENING},n.isFinished=function(){return this.isValid()&&this.status===Bi.FINISHED},n.isDuelWithFriend=function(){return this.isPlayWithFriend},n.checkNotifyEvent=function(){return this.notifyEvent},n.getPlayer=function(){var e=this.playerBoxingDuelData.currentMatch.player,t=(0,a.Z)({},e);if(""===t.playerId){var n=this.game.player.getPlayer(),i=n.playerId,r=n.name,s=n.photo;t.playerId=i,t.name=r,t.photo=s,this.updateBoxingDuel({currentMatch:(0,a.Z)({},this.playerBoxingDuelData.currentMatch,{player:t})})}return t},n.getPlayerScore=function(){return this.getPlayer().score},n.getOpponent=function(){var e=this.playerBoxingDuelData.currentMatch.opponent,t=(0,a.Z)({},e);if(""!==t.playerId)return t},n.getOpponentScore=function(){var e;return(null==(e=this.getOpponent())?void 0:e.score)||0},n.getEndTime=function(){return this.playerBoxingDuelData.currentMatch.endTime},n.getFirstTimePlay=function(){return this.playerBoxingDuelData.firstTimePlay},n.getContextID=function(){return this.playerBoxingDuelData.currentMatch.contextId},n.getMatchId=function(){return this.playerBoxingDuelData.currentMatch.matchId},n.getPlayerRank=function(){var e=this.playerBoxingDuelData.currentMatch,t=e.player,n=e.opponent;return t.score>n.score?0:t.score<n.score?1:0===t.lastUpdated&&0===n.lastUpdated?0:0===t.lastUpdated?1:0===n.lastUpdated||t.lastUpdated<n.lastUpdated?0:1},n.getRemainingTime=function(){return this.playerBoxingDuelData.currentMatch.endTime-(new Date).getTime()},n.setFirstTimePlay=function(e){this.updateBoxingDuel({firstTimePlay:e})},n.setNofityEvent=function(e){this.notifyEvent=e},n.isTimeout=function(){return this.playerBoxingDuelData.currentMatch.endTime<=(new Date).getTime()},n.checkTimeOut=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return");case 2:if(!(this.playerBoxingDuelData.currentMatch.endTime<=(new Date).getTime())){e.next=9;break}return this.setStatus(Bi.FINISHED),this.isRewardScreenShown=!0,e.next=8,this.updateOpponentScore(!0);case 8:this.notifyEvent=!0;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.generateBotPlayed=function(){for(var e=this.boxingDuelDuration,t=[],n=0,i=0;n<e;){n+=Phaser.Math.Between(45e3,21e4),i+=Phaser.Math.Between(20,50),t.push({score:i,timePlayed:n})}this.botPlayed=t},n.getEmptyCurrentMatch=function(){var e=this.game.player.getPlayer();return{matchId:"",contextId:"",endTime:0,player:{playerId:e.playerId,name:e.name,photo:e.photo,score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1}},n.logBoxingDuelStart=function(){this.playerBoxingDuelData.currentMatch.player.logStart||(this.updateBoxingDuel({currentMatch:(0,a.Z)({},this.playerBoxingDuelData.currentMatch,{player:(0,a.Z)({},this.playerBoxingDuelData.currentMatch.player,{logStart:!0})})}),this.game.analytics.event(te._.DUEL_START,{level:this.game.player.getLevel()}))},n.logBoxingDuelEnd=function(){var e;this.game.analytics.event(te._.DUEL_END,{level:this.game.player.getLevel(),playerScore:this.getPlayer().score,opponentScore:(null==(e=this.getOpponent())?void 0:e.score)||0,playerWin:0===this.getPlayerRank(),bot:!this.isPlayWithFriend})},t}(Phaser.Plugins.BasePlugin),Gi=Ni,Zi=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var e,n;e=this.width*t,n=this.height*t,Math.floor(n/2),Math.floor(e/2)},n.src=e},Fi=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).width=void 0,t.height=void 0,t.renderOptions=void 0,t.canvas=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(e){var t=this,n=Object.keys(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,a=t.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=[];for(var t in this.renderOptions){var n=this.renderOptions[t],i=n.name,a=n.image,r=n.fallbackWithImage;if(a)if(this.scene.textures.get(i).key!==i&&""!==i){var s=this.loadImage(i,a,r);e.push(s)}}return this.scene.load.start(),Promise.all(e)},n.loadImage=function(e,t,n){var i=this;return this.scene.load.image(e,t),new Promise((function(t,a){var r=Phaser.Loader.Events.FILE_KEY_COMPLETE+"image-"+e,s=Phaser.Loader.Events.FILE_LOAD_ERROR,o=function e(n){i.scene.load.off(r,e),i.scene.load.off(s,c),t()},c=function c(h){if(h.key===e)if(i.scene.load.off(r,o),i.scene.load.off(s,c),n)t();else{var u=new Error("Load image failed");a(u)}};i.scene.load.on(r,o),i.scene.load.on(s,c)}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.font,r=e.text,s=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=a+' "Be Vietnam Pro",nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=s||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(r,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.name,r=e.frame,s=e.width,o=e.height,c=e.fallbackWithImage,h=this.scene.textures.get(a),u=h.getSourceImage(r);"__MISSING"===h.key&&c&&(u=(h=this.scene.textures.get(c)).getSourceImage()),t.drawImage(u,n,i,s,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Zi(e),e},t}(Phaser.Plugins.ScenePlugin),Ui=Fi,Wi=n(73),Hi={CUMULATIVE_PRICE:{UNDO:25,WILD_CARD:50,PLUS_FIVE_CARDS:50},PLUS_A_HEART:300,UNDO:50,WILD_CARD:300,PLUS_FIVE_CARDS:150,SLICE_BOOSTER:350,STORM_BOOSTER:375,WILD_CARD_BOOSTER:325},Yi=function(e){return e.NONE="none",e.PLUS_FIVE_CARDS="plus-five-cards",e.SLICE="slice",e.STORM="storm",e.WILD_CARD="wild-card",e}({}),Ki=function(e){return e.NONE="none",e.SLICE="slice",e.STORM="storm",e.WILD_CARD="wild-card",e.PLUS_CARD="plus-card",e}({}),zi=function(e){return e.IDLE="idle",e.RUNNING="running",e}({}),Vi=function(e){return e.START="start",e.COMPLETED="completed",e}({}),ji=Wi.Z.DEFAULT.FRAME,Xi={SLICE:{title:"slice",description:"removeThreeCards",cost:Hi.SLICE_BOOSTER,boosterFrame:ji.REWARDS.SLICE,key:Ki.SLICE},STORM:{title:"storm",description:"removeAllCards",cost:Hi.STORM_BOOSTER,boosterFrame:ji.REWARDS.STORM,key:Ki.STORM},WILD_CARD:{title:"wildDrop",description:"addThreeWildCards",cost:Hi.WILD_CARD_BOOSTER,boosterFrame:ji.REWARDS.WILD_CARD,key:Ki.WILD_CARD}},qi=function(e){return e.COIN="coin",e.UNDO="undo",e.PLUS_5_CARDS="plus-5-cards",e}({}),Ji=function(e){this.items=e},Qi=[new Ji([{type:qi.PLUS_5_CARDS,amount:1},{type:Ki.STORM,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new Ji([{type:Ki.STORM,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new Ji([{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}])],$i=n(15),ea={WINNING:[[[10,85,5],[15,80,5],[20,80,0],[30,70,0]],[[40,60,0],[30,70,0],[40,60,0],[40,60,0]],[[50,50,0],[50,50,0],[50,50,0],[50,50,0]],[[60,40,0],[60,40,0],[70,30,0],[60,40,0]],[[70,30,0],[70,30,0],[80,20,0],[80,20,0]]],LOSING:[[[25,75,0],[30,70,0],[30,70,0],[40,60,0]],[[50,50,0],[40,60,0],[50,50,0],[50,50,0]],[[60,40,0],[60,40,0],[60,40,0],[60,40,0]],[[70,30,0],[70,30,0],[80,20,0],[70,30,0]],[[80,20,0],[80,20,0],[90,10,0],[90,10,0]]],TIME:[[[45,55,0],[50,50,0],[50,50,0],[60,40,0]],[[70,30,0],[60,40,0],[70,30,0],[70,30,0]],[[80,20,0],[80,20,0],[80,20,0],[80,20,0]],[[90,10,0],[90,10,0],[100,0,0],[90,0,0]],[[100,0,0],[100,0,0],[100,0,0],[100,0,0]]]},ta=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),na="show-notification",ia="finish-race",aa="race-requested",ra="end-race",sa=[0,1,2],oa=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=GameCore.Configs.OffshoreRace,t.status=ta.WAITING,t.playerData=void 0,t.lastBotUpdate=0,t.shouldCheckTime=!1,t.notifyEvent=!1,t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.OffshoreRace,this.events.on(ra,this.endRace,this)},n.initData=function(){var e=this.game.player.getOffshoreRace();this.playerData=JSON.parse(JSON.stringify(e)),this.evaluateStatus(),this.notifyEvent=!0},n.update=function(){this.handleTimeout(),this.notifyEvent&&this.events.emit(na)},n.startRace=function(){if(!this.isHappening()){var e=Date.now()+this.config.Duration,t=this.game.player.getPlayer(),n=this.game.player.getLevel(),i=this.createOpponents(),r=[{racerIndex:0,racerId:t.playerId,name:t.name,photo:t.photo,score:0,rank:0,lastUpdated:Date.now(),rewardClaimed:!1}].concat(i);this.playerData=(0,a.Z)({},this.playerData,{hasEventJoined:!0,endTime:e,levelStart:n,racers:r}),this.setStatus(ta.HAPPENING),this.syncPlayerData(),this.logRaceStart(),this.lastBotUpdate=Date.now()}},n.endRace=function(){this.logRaceEnd(),this.setStatus(ta.WAITING),this.playerData.hasEventJoined=!1,this.playerData.endTime=0,this.playerData.racers=[],this.syncPlayerData(),this.notifyEvent=!0},n.updateRacersScore=function(e){this.updatePlayerScore(e),this.updateOpponentScore(e)},n.updatePlayerScore=function(e){var t=this;if(this.isHappening()&&e){var n=this.getRacers().map((function(e,n){return 0===n?(0,a.Z)({},e,{score:Phaser.Math.Clamp(e.score+1,0,t.config.RequiredLevels),lastUpdated:Date.now()}):e}));this.commitRaceUpdate(n)}},n.updateOpponentScore=function(e){var t=this;if(this.shouldUpdateBotScore(e)){var n=this.getRacers(),i=n[0],r=n.slice(1),s=r.sort((function(e,t){return e.rank-t.rank})),o=this.generateBotMoves(i.rank,e),c=r.map((function(e){var n,i=s.findIndex((function(t){return t.racerIndex===e.racerIndex})),r=null!=(n=o[i])?n:0;return(0,a.Z)({},e,{score:Phaser.Math.Clamp(e.score+r,0,t.config.RequiredLevels),lastUpdated:Date.now()})}));this.commitRaceUpdate([i].concat(c))}},n.isValid=function(){return this.config.Enable&&this.game.player.getLevel()>=this.config.LevelStart},n.isHappening=function(){return this.isValid()&&this.status===ta.HAPPENING},n.isWaiting=function(){return this.isValid()&&this.status===ta.WAITING},n.isFinished=function(){return this.isValid()&&this.status===ta.FINISHED},n.hasReward=function(){var e=this.getRacers()[0];return this.isFinished()&&e&&sa.includes(e.rank)&&e.score>=this.config.RequiredLevels},n.getRacers=function(){return this.playerData.racers},n.getTop3Racers=function(){return this.getRacers().map((function(e){return(0,a.Z)({},e)})).sort((function(e,t){return e.rank-t.rank})).slice(0,3)},n.getRemainingTime=function(){return Math.max(0,this.playerData.endTime-Date.now())},n.getRequiredLevels=function(){return this.config.RequiredLevels},n.getPlayerRank=function(){var e=this.getRacers();return e.length>0?e[0].rank:-1},n.getIsFirstTimeEvent=function(){return!0===this.playerData.isFirstTimeEvent},n.getRewardClaimed=function(){return this.getRacers().map((function(e){return{racerIndex:e.racerIndex,rewardClaimed:e.rewardClaimed}}))},n.getRewardData=function(){return this.hasReward()?Qi[this.getRacers()[0].rank].items:[]},n.isTimeout=function(){return this.playerData.endTime<=Date.now()},n.checkNotifyEvent=function(){return this.notifyEvent},n.setNotifyEvent=function(e){this.notifyEvent=e},n.setIsFirstTimeEvent=function(e){this.playerData.isFirstTimeEvent=e,this.syncPlayerData()},n.setRacerClaimReward=function(e){var t=this.getRacers().map((function(t){return t.racerIndex===e?(0,a.Z)({},t,{rewardClaimed:!0}):t}));this.playerData.racers=t,this.syncPlayerData()},n.setShouldCheckTime=function(e){this.shouldCheckTime!==e&&(this.shouldCheckTime=e,e&&(this.lastBotUpdate=Date.now()))},n.resetRacersScore=function(){var e=this.getRacers().map((function(e){return(0,a.Z)({},e,{score:0,lastUpdated:Date.now(),rewardClaimed:!1})}));this.setStatus(ta.HAPPENING),this.commitRaceUpdate(e)},n.updateRacerScore=function(e,t){var n=this,i=this.getRacers().map((function(i,r){return r===e?(0,a.Z)({},i,{score:Phaser.Math.Clamp(i.score+t,0,n.config.RequiredLevels),lastUpdated:Date.now()}):i}));this.commitRaceUpdate(i)},n.evaluateStatus=function(){var e=this.playerData.endTime;if(0===e)return this.setStatus(ta.WAITING);var t=e<Date.now()?ta.FINISHED:ta.HAPPENING;this.setStatus(t),this.checkRaceCompletion()},n.handleTimeout=function(){this.isHappening()&&(this.playerData.endTime<=Date.now()?(this.setStatus(ta.FINISHED),this.notifyEvent=!0,this.events.emit(na)):this.shouldCheckTime&&this.updateRacersScore())},n.setStatus=function(e){e!==this.status&&(this.status=e)},n.commitRaceUpdate=function(e){var t=this.updateRanks(e);this.playerData.racers=t,this.syncPlayerData(),this.checkRaceCompletion()},n.updateRanks=function(e){var t=e.map((function(e){return(0,a.Z)({},e)}));return t.sort((function(e,t){return t.score-e.score||e.lastUpdated-t.lastUpdated})),t.forEach((function(e,t){return e.rank=t})),t.sort((function(e,t){return e.racerIndex-t.racerIndex})),t},n.shouldUpdateBotScore=function(e){if(void 0!==e)return this.lastBotUpdate=Date.now(),!0;var t=this.playerData.hasEventJoined,n=this.playerData.endTime<=Date.now(),i=this.isFinished(),a=Date.now()>=this.lastBotUpdate+12e4;return!(!t||n||i||!a)&&(this.lastBotUpdate=Date.now(),!0)},n.generateBotMoves=function(e,t){return ea[void 0===t?"TIME":t?"WINNING":"LOSING"][e].map((function(e){var t=e[0],n=e[1],i=100*Math.random();return i<t?0:i<t+n?1:2}))},n.createOpponents=function(){return(0,$i.h)(this.config.RaceOpponentCount).map((function(e,t){return{racerIndex:t+1,racerId:e.id,name:e.name,photo:e.photo,score:0,rank:t+1,lastUpdated:Date.now(),rewardClaimed:!1}}))},n.checkRaceCompletion=function(){var e=this;if(!this.isFinished()){var t=this.getRacers(),n=t[0],i=t.slice(1),a=n.score>=this.config.RequiredLevels,r=i.filter((function(t){return t.score>=e.config.RequiredLevels})).length>=3;(a||r)&&(this.setStatus(ta.FINISHED),this.notifyEvent=!0)}},n.syncPlayerData=function(){this.game.player.setCustomData("offshoreRace",(0,a.Z)({},this.playerData))},n.logRaceStart=function(){this.game.analytics.event(te._.RACE_START,{level:this.game.player.getLevel()})},n.logRaceEnd=function(){if(0!==this.getRacers().length){var e=this.game.player.getLevel()-this.playerData.levelStart;this.game.analytics.event(te._.RACE_END,{rank:this.getRacers()[0].rank,level:this.game.player.getLevel(),milestone:e,score:this.getRacers()[0].score,hasReward:this.hasReward()})}},t}(Phaser.Plugins.BasePlugin),ca=oa,ha=function(e){function t(t,n,i){var a;return(a=e.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var e=a.options.checkInterval;a.checkTimer=e,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(e,t){if(a.checkTimer-=t,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,r=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===r&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=t,a.options=i,a.performance=n,a}(0,s.Z)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),ua=ha,la=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],da=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).fpsTracker=void 0,t.pixelRatio=void 0,t.minQuality=void 0,t.maxQuality=void 0,t.qualityAdjustStep=void 0,t.trackingSceneKeys=[],t.trackingScene=function(e){if(t.trackingSceneKeys.includes(e)){var n=t.game.scene.getScene(e);n.events.once(Phaser.Scenes.Events.UPDATE,t.fpsTracker.start),n.events.once(Phaser.Scenes.Events.SLEEP,t.fpsTracker.stop)}},t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,a=e.maxQuality,r=e.qualityAdjustStep,s=e.trackingSceneKeys,o=(0,i.Z)(e,la);this.pixelRatio=t,this.minQuality=n,this.maxQuality=a,this.qualityAdjustStep=r,this.trackingSceneKeys=s,this.fpsTracker=new ua(this.game,this,o)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},t}(Phaser.Plugins.BasePlugin),pa=da,fa={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme,tapToMove:!0,autoHints:!0,autoComplete:!0,drawMode3:!1,backgroundIdx:0,cardFaceIdx:0,cardBackIdx:0,backgroundDesktopIdx:0,cardFaceDesktopIdx:0,cardBackDesktopIdx:0},ma={coins:0,diamond:0,lastReceiveGift:0,level:1,wildCard:0,undo:0,plusFive:0,star:0,journeyProgress:{currentLocationIndex:-1,finishedLocationIds:[],inProgressLocation:void 0},life:{hearts:1,lastTimeReceive:0},boosters:{slice:0,storm:0,wildCard:0},levelStars:{},dailyRewarded:{lastRewarded:0,logDays:[]},dailyTasks:{startedTime:0,logTasks:{}},game_stats:{},tournaments:[],worldCupEvent:{firstTimeShown:0,joinedWorldCups:[]},lastAwesomeWCShownDate:0,pendingMatchIds:[],lastWelcomeBackRewardTime:0,weeklyTournament:{hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1},boxingDuel:{firstTimePlay:!0,boxingDuelShown:!1,currentMatch:{matchId:"",contextId:"",endTime:0,player:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1},historyMatches:[]},offshoreRace:{isFirstTimeEvent:!0,loginTime:0,hasShownEvent:!1,hasEventJoined:!1,endTime:0,levelStart:13,racers:[]}},ga=fa.sound,va=fa.music,ya=fa.vibrate,Ea=fa.language,Ca=fa.theme,Aa=fa.tapToMove,wa=fa.autoHints,Sa=fa.autoComplete,ba=fa.drawMode3,Ta=fa.backgroundIdx,xa=fa.cardFaceIdx,Pa=fa.cardBackIdx,ka=fa.backgroundDesktopIdx,Ia=fa.cardFaceDesktopIdx,Oa=fa.cardBackDesktopIdx,Ra=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0,this.tapToMove=void 0,this.autoHints=void 0,this.autoComplete=void 0,this.drawMode3=void 0,this.backgroundIdx=void 0,this.cardFaceIdx=void 0,this.cardBackIdx=void 0,this.backgroundDesktopIdx=void 0,this.cardFaceDesktopIdx=void 0,this.cardBackDesktopIdx=void 0;var t=e||{},n=t.sound,i=t.music,a=t.vibrate,r=t.language,s=t.theme,o=t.tapToMove,c=t.autoHints,h=t.autoComplete,u=t.drawMode3,l=t.backgroundIdx,d=t.cardFaceIdx,p=t.cardBackIdx,f=t.backgroundDesktopIdx,m=t.cardFaceDesktopIdx,g=t.cardBackDesktopIdx;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:ga,this.music=GameCore.Utils.Valid.isBoolean(i)?i:va,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:ya,this.language=GameCore.Utils.Valid.isString(r)?r:Ea,this.theme=GameCore.Utils.Valid.isString(s)?s:Ca,this.tapToMove=GameCore.Utils.Valid.isBoolean(o)?o:Aa,this.autoHints=GameCore.Utils.Valid.isBoolean(c)?c:wa,this.autoComplete=GameCore.Utils.Valid.isBoolean(h)?h:Sa,this.drawMode3=GameCore.Utils.Valid.isBoolean(u)?u:ba,this.backgroundIdx=GameCore.Utils.Valid.isNumber(l)?l:Ta,this.cardFaceIdx=GameCore.Utils.Valid.isNumber(d)?d:xa,this.cardBackIdx=GameCore.Utils.Valid.isNumber(p)?p:Pa,this.backgroundDesktopIdx=GameCore.Utils.Valid.isNumber(f)?f:ka,this.cardFaceDesktopIdx=GameCore.Utils.Valid.isNumber(m)?m:Ia,this.cardBackDesktopIdx=GameCore.Utils.Valid.isNumber(g)?g:Oa}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme,tapToMove:this.tapToMove,autoHints:this.autoHints,autoComplete:this.autoComplete,drawMode3:this.drawMode3,backgroundIdx:this.backgroundIdx,cardFaceIdx:this.cardFaceIdx,cardBackIdx:this.cardBackIdx,backgroundDesktopIdx:this.backgroundDesktopIdx,cardFaceDesktopIdx:this.cardFaceDesktopIdx,cardBackDesktopIdx:this.cardBackDesktopIdx}},e}(),Ba=Ra,Da=GameCore.Utils,La=Da.Valid,_a=(Da.Object,function(){function e(e){this.score=void 0,this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.setupDefaultData(),this.updateScore(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e)}var t=e.prototype;return t.setupDefaultData=function(){this.score=0,this.settings=(0,a.Z)({},fa),this.gameData=Phaser.Utils.Objects.DeepCopy(ma),this.userGuideDisplays=0},t.updateScore=function(e){var t=e.score;!1!==La.isNumber(t)&&(this.score=t)},t.updateSettings=function(e){var t=e.settings;if(!1!==La.isObject(t)){var n=new Ba(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;this.gameData=(0,a.Z)({},this.gameData,t)},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==La.isNumber(t)&&(this.userGuideDisplays=t)},t.toObject=function(){return{score:this.score,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays}},t.convertToPlayerData=function(){return{score:this.score,settings:this.settings,customFields:(0,a.Z)({},this.gameData),userGuideDisplays:this.userGuideDisplays}},t.convertToFacebookData=function(e){var t=e.score,n=e.settings,i=e.customFields,a=e.userGuideDisplays;return this.updateScore({score:t}),this.updateSettings({settings:n}),this.updateGameData({gameData:i}),this.updateUserGuideDisplays({userGuideDisplays:a}),this.toObject()},e}()),Ma=_a,Na="PLAYER_RECEIVED",Ga="PLAYER_DATA_UPDATE",Za="PLAYER_SCORE_UPDATE",Fa="PLAYER_PROFILE_UPDATE",Ua="PLAYER_SETTING_UPDATE",Wa="PLAYER_CONNECTED_PLAYERS_UPDATE",Ha=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),Ya="player",Ka=(0,j.P1)([function(e){return e[Ya]}],(function(e){return e})),za=(0,j.P1)([Ka],(function(e){return e.playerId})),Va=(0,j.P1)([Ka],(function(e){return e.ASID})),ja=(0,j.P1)([function(e){return e[Ya].data}],(function(e){return e})),Xa=((0,j.P1)([ja],(function(e){return e.settings})),(0,j.P1)([function(e){return e[Ya].connectedPlayers}],(function(e){return e}))),qa=(0,j.P1)([Xa,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){return"number"!==typeof t||"number"!==typeof n?[]:Object.keys(e).slice(n,t+n)||[]})),Ja=(0,j.P1)([ja],(function(e){return e.score})),Qa=(0,j.P1)([ja],(function(e){return e.customFields})),$a=(0,j.P1)([Qa],(function(e){return void 0===(null==e?void 0:e.tournaments)?[]:e.tournaments})),er=(0,j.P1)([Qa],(function(e){return(null==e?void 0:e.weeklyTournament)||{hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1}})),tr=(0,j.P1)([Qa],(function(e){return(null==e?void 0:e.offshoreRace)||{isFirstTimeEvent:!0,loginTime:0,hasShownEvent:!1,hasEventJoined:!1,endTime:0,levelStart:13,racers:[]}})),nr=(0,j.P1)([Qa],(function(e){return(null==e?void 0:e.boxingDuel)||{firstTimePlay:!0,boxingDuelShown:!1,currentMatch:{matchId:"",contextId:"",endTime:0,player:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},opponent:{playerId:"",name:"",photo:"",score:0,lastUpdated:0,logStart:!1},botPlayed:[],matchFinished:!1},historyMatches:[]}})),ir=(0,j.P1)([Qa],(function(e){return(null==e?void 0:e.journeyProgress)||{currentLocationIndex:-1,finishedLocationIds:[],inProgressLocation:void 0}})),ar=GameCore.Configs,rr=ar.AppId,sr=ar.Tutorial,or=function(e,t){return function(n){var i=e.playerId,a=e.name,r=e.photo,s=e.locale;n({type:Na,payload:{playerId:i,name:a,photo:r,locale:s,data:t||{}}})}},cr=function(e){return{type:Wa,payload:{connectedPlayers:e}}},hr=function(e,t){return function(){var n=(0,r.Z)(c().mark((function n(i,a){var r,s,o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i({type:Ua,payload:{name:e,value:t}});case 3:r=a(),s=ja(r),o=new Ma({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,Y.tO)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},ur=function(e,t){return function(){var n=(0,r.Z)(c().mark((function n(i,a){var r,s,o,h,u;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s={customFields:(r={},r[e]=t,r)},n.next=4,i(dr(s));case 4:o=a(),h=ja(o),ki(h),u=new Ma({}).convertToFacebookData(h),FBInstant.player.setDataAsync(u),n.next=16;break;case 11:if(n.prev=11,n.t0=n.catch(0),!(n.t0 instanceof Ha)){n.next=15;break}return n.abrupt("return");case 15:(0,Y.tO)(n.t0);case 16:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e,t){return n.apply(this,arguments)}}()},lr=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n,i){var a,r,s,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={customFields:e},t.next=4,n(dr(a));case 4:r=i(),s=ja(r),o=new Ma({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof Ha)){t.next=15;break}return t.abrupt("return");case 15:(0,Y.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},dr=function(e){return{type:Ga,payload:{data:e}}},pr=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n,i){var a,r,s;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:Za,payload:{score:e}});case 3:ki({score:e}),a=i(),r=ja(a),s=new Ma({}).convertToFacebookData(r),FBInstant.player.setDataAsync(s),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Y.tO)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},fr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).isUserNew=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!sr.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(dr({userGuideDisplays:1}));case 5:i=n(),a=za(i),r=ja(i),s=new Ma({}).convertToFacebookData(r),FBInstant.player.setDataAsync(s),Ii(a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(or(t,n));case 3:this.isUserNew=this.getPlayer().isUserNew;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=n(),a=Ka(i),r=a.playerId,s=a.name,o=a.photo,h=a.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return u=e.sent,l={appId:rr,playerId:r,name:s,photo:o,locale:h,ASID:u},e.next=10,t({type:Fa,payload:{profile:l}});case 10:return e.next=12,ki(l);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(pr(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(hr(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(ur(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(lr(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateWeeklyTournament=function(e){this.setCustomData("weeklyTournament",e)},n.updateOffshoreRace=function(e){this.setCustomData("offshoreRace",e)},n.updateBoxingDuel=function(e){this.setCustomData("boxingDuel",e)},n.updateJourneyProgress=function(e){this.setCustomData("journeyProgress",e)},n.requestConnectedPlayers=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.player.getConnectedPlayersAsync();case 3:if(n=e.sent,i=function(e){return!!e},a=n.map((function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new ne.Z(t,n,i).toObject():null})).filter(i),!(a.length<1)){e.next=8;break}return e.abrupt("return");case 8:t(cr(a)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(cr(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.joinTournament=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getTournaments()).find((function(e){return e.leaderboardId===t.leaderboardId}))){e.next=3;break}return e.abrupt("return");case 3:return i=[].concat(n,[t]),e.next=6,this.setMultiCustomData({tournaments:i});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLevelProgress=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.game.storage,!(void 0!=(a=this.getLevelStars(t))&&a>=n)){e.next=4;break}return e.abrupt("return");case 4:return(r={})[t]=n,e.next=8,i.dispatch(ur("levelStars",r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setLevel=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.game.storage).dispatch(Ai(t)),e.next=4,n.dispatch(ur("level",t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLifeData=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,(i={hearts:1,lastTimeReceive:0}).hearts=t.hearts,i.lastTimeReceive=t.lastTimeReceive,e.next=6,n.dispatch(ur("life",i));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setWildCard=function(e){this.setCustomData("wildCard",Math.max(0,e)),this.game.events.emit(hi.WILDCARD_CHANGED)},n.setUndo=function(e){this.setCustomData("undo",Math.max(0,e)),this.game.events.emit(hi.UNDO_CHANGED)},n.setPlusFive=function(e){this.setCustomData("plusFive",Math.max(0,e)),this.game.events.emit(hi.PLUS_FIVE_CHANGED)},n.setStar=function(e){this.setCustomData("star",Math.max(0,e)),this.game.events.emit(hi.STAR_CHANGED,e)},n.setBoosterAmount=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,(a={})[t]=n,e.next=5,i.dispatch(ur("boosters",a));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setLastWelcomeBackRewardTime=function(e){this.setCustomData("lastWelcomeBackRewardTime",e)},n.getPlayer=function(){return Ka(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return Va(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(fa,e)?fa[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.isUserNew},n.getCoins=function(){var e=this.getCustomData("coins");return GameCore.Utils.Valid.isNumber(e)?e:0},n.setCoins=function(e){this.setCustomData("coins",e),this.game.events.emit(hi.COIN_CHANGED,e)},n.getWildCard=function(){var e=this.getCustomData("wildCard");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getUndo=function(){var e=this.getCustomData("undo");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getPlusFive=function(){var e=this.getCustomData("plusFive");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getStar=function(){var e=this.getCustomData("star");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBoosterAmount=function(e){if("string"!==typeof e)return 0;var t=this.getCustomData("boosters");if(!GameCore.Utils.Valid.isObject(t))return 0;var n=t[e];return GameCore.Utils.Valid.isNumber(n)?n:0},n.getLifeData=function(){var e=this.getCustomData("life"),t={hearts:1,lastTimeReceive:0};return GameCore.Utils.Valid.isObject(e)&&GameCore.Utils.Object.hasOwn(e,"hearts")&&GameCore.Utils.Object.hasOwn(e,"lastTimeReceive")?(GameCore.Utils.Valid.isNumber(e.hearts)&&GameCore.Utils.Valid.isNumber(e.lastTimeReceive)&&(t.hearts=e.hearts,t.lastTimeReceive=e.lastTimeReceive),t):t},n.getDiamond=function(){var e=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBestScore=function(){return Ja(this.state)},n.getLevelStars=function(e){var t=this.getCustomData("levelStars");if(void 0!=t){var n=t[e];if(void 0!=n)return n}},n.getLevel=function(){var e=this.getCustomData("level");return GameCore.Utils.Valid.isNumber(e)?e:1},n.getCustomData=function(e){var t=Qa(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return Xa(this.state)},n.getConnectedPlayerIds=function(e,t){return qa(this.state,{limit:e,offset:t})},n.getTournaments=function(){return $a(this.state)},n.getPendingMatchIds=function(){var e=this.getCustomData("pendingMatchIds");return Array.isArray(e)&&e.every((function(e){return GameCore.Utils.Valid.isString(e)}))?e:[]},n.setPendingMatchIds=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setCustomData("pendingMatchIds",t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.addPendingMatchId=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isString(t)){e.next=2;break}return e.abrupt("return");case 2:if(!(n=this.getPendingMatchIds()).includes(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.setPendingMatchIds([].concat(n,[t]));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.removePendingMatchId=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isString(t)){e.next=2;break}return e.abrupt("return");case 2:if((n=this.getPendingMatchIds()).includes(t)){e.next=5;break}return e.abrupt("return");case 5:return i=n.filter((function(e){return e!==t})),e.next=8,this.setPendingMatchIds(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getWeeklyTournament=function(){return er(this.state)},n.getOffshoreRace=function(){return tr(this.state)},n.getBoxingDuel=function(){return nr(this.state)},n.getJourneyProgress=function(){return ir(this.state)},n.getLastWelcomeBackRewardTime=function(){var e=this.getCustomData("lastWelcomeBackRewardTime");return GameCore.Utils.Valid.isNumber(e)?e:0},(0,H.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),mr=fr,gr=GameCore.Configs.ApiHost,vr=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,Ee("players?"+n,{},gr);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yr="PROFILES_DATA_UPDATE",Er="profile",Cr=(0,j.P1)([function(e){return e[Er].data}],(function(e){return e})),Ar=(0,j.P1)([function(e){return e[Er].profileIds}],(function(e){return e})),wr=GameCore.Configs,Sr=wr.Tournament,br=wr.LeadersBoard,Tr=function(e){return function(){var t=(0,r.Z)(c().mark((function t(n,i){var a,r,s,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=i(),r=Ar(a),!((s=GameCore.Utils.Array.difference(e,r)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,vr({playerIds:s});case 8:o=t.sent,Sr.UseMock&&br.UseMock&&(o=new Array(s.length).fill(null).map((function(e,t){var n=t+1;return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(17*Math.random()*1e3/n)}}))),n({type:yr,payload:{data:o}}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,Y.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()},xr=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Tr(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Cr(this.state)},n.getProfile=function(e){return this.getProfiles()[e]},(0,H.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Pr=xr,kr=n(36),Ir=n.n(kr),Or=["player","match"],Rr="null",Br=GameCore.Utils,Dr=Br.Valid,Lr=Br.Object,_r=GameCore.Configs.Rollbar,Mr=_r.UseMockup,Nr=_r.FilterError,Gr=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).enable=void 0,t.rollbar=void 0,t.events=[],t.beforeSend=function(e,n,i){Mr&&t.showPopupError(i)},t.checkIgnore=function(e,n,i){try{return!!t.isErrorIgnore(n)}catch(a){return!1}},t.showPopupError=function(e){var n,i,a,r=null==e||null==(n=e.body)||null==(n=n.trace)?void 0:n.exception;r&&t.events.push(r);var s=(null==e||null==(i=e.body)||null==(i=i.trace)?void 0:i.frames)||[];(a=t.events).push.apply(a,s);var o=document.getElementById("popup-error");o||((o=document.createElement("div")).id="popup-error",document.body.appendChild(o)),o.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+JSON.stringify(t.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',o.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var c=document.getElementById("close");c&&(c.onclick=t.closePopup)},t.closePopup=function(){t.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},t.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},t.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var n=!1,i=e[0];return i instanceof Object&&(n=t.isIgnoreByCode(i)||t.isIgnoreByMessage(i)),n},t.isIgnoreByCode=function(e){if(Lr.hasOwn(e,"code")){var t=e.code,n=Nr.Codes,i=n.accepted,a=n.ignored;if("string"===typeof t){if(i.indexOf(t)>=0)return!1;if(a.indexOf(t)>=0)return!0}}if(Lr.hasOwn(e,"name")){var r=e.name,s=Nr.Codes,o=s.accepted,c=s.ignored;if("string"===typeof r){if(o.indexOf(r)>=0)return!1;if(c.indexOf(r)>=0)return!0}}return!1},t.isIgnoreByMessage=function(e){if(Lr.hasOwn(e,"message")){var t=e.message,n=Nr.Messages,i=n.accepted,a=n.ignored;if("string"===typeof t){if(i.indexOf(t)>=0)return!1;if(a.indexOf(t)>=0)return!0}}return!1},t.addExtraState=function(){try{if(!Lr.hasOwn(window,"game"))return;if(!Lr.hasOwn(window.game,"storage"))return;if(!Lr.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},n=e.player,a=e.match,r=(0,i.Z)(e,Or);t.rollbar.configure({payload:{player:n,match:a,other:r}})}catch(s){}},t}(0,s.Z)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(Ir())({accessToken:Rr,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"1"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){if(!Dr.isDebugger()){var e=FBInstant.player.getID();e&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})}},n.sendException=function(e,t){e&&this.enable&&this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t))},t}(Phaser.Plugins.BasePlugin),Zr=Gr,Fr=n(74),Ur=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),Wr=Ur,Hr=n(70),Yr=function(e){function t(t,n,i,a){var r;(r=e.call(this,t)||this).zone=void 0,r.background=void 0,r.setName(n),r.setVisible(!1);var s=r.scene.world.getWorldSize(),o=s.width,c=s.height;return r.setSize(i||o,a||c),r.addZone(),r.addBackground(),r.registerEvents(),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logEventOpen(),this.handleResize())},n.close=function(){this.visible&&this.setVisible(!1)},n.incY=function(e){this.y+=e,this.background.y-=e},n.incX=function(e){this.x+=e,this.background.x-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){this.background=this.scene.add.image(0,0,ie.Z.OVERLAY.KEY),this.background.setInteractive({useHandCursor:!0}),this.background.setWorldSize(this.width,this.height),this.background.disableInteractive(),this.add(this.background)},n.registerEvents=function(){this.scene.world.events.on(Hr.Z.RESIZE,this.handleResize,this)},n.handleResize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height;this.setSize(t,n),this.zone.setSize(this.width,this.height),this.background.setWorldSize(this.width,this.height),Phaser.Display.Align.In.Center(this,this.scene.gameZone)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(te._.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),Kr=Yr,zr={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=Kr,GameCore.Screens={Events:zr};var Vr=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).screenMap=void 0,t.screensLayer=void 0,t.events=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.boot=function(){this.events=new Wr,this.screenMap=new Map,this.registryScreenFactory()},n.get=function(e){var t=this.screensLayer.getByName(e);return null===t?null:t},n.preAdd=function(e,t){this.screenMap.set(e,t)},n.add=function(e,t,n,i){this.screensLayer||(this.screensLayer=this.scene.add.layer(),this.screensLayer.setDepth(Fr.Z.POPUP));var a=this.get(e);return a||(a=this.scene.add.screen(e,t,n,i),this.screensLayer.add(a),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.openAsync=function(e,t){var n=this;return this.open(e,t),new Promise((function(t){var i=n.get(e);i?i.on(GameCore.Screens.Events.CLOSE,t):t()}))},n.open=function(e,t){var n=this.get(e);if(!n){var i=this.screenMap.get(e);if(!i)return!1;this.add(e,i,this.scene.gameZone.width,this.scene.gameZone.height),n=this.get(e)}return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),!0)},n.bringToTop=function(e){var t=this.screensLayer.getByName(e);t&&this.screensLayer.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var a=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},t}(Phaser.Plugins.ScenePlugin),jr=Vr,Xr=n(38),qr=n.n(Xr),Jr=n(66),Qr=n(67),$r={currentSceneKey:"",prevSceneKey:""};(0,Qr.pV)();var es,ts,ns,is,as,rs,ss,os,cs,hs={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},us=hs,ls={data:{}},ds={token:"",isRequesting:!1},ps=((es={})[X]=function(e,t){return void 0===e&&(e=ds),(0,Qr.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case K:e.isRequesting=!0;break;case z:e.token=i,e.isRequesting=!1}}}))},es),fs={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:fa,userGuideDisplays:0,customFields:Phaser.Utils.Objects.DeepCopy(ma)},isUserNew:!0},ms=((ts={})[Ya]=function(e,t){return void 0===e&&(e=fs),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.name,r=i.value,s=i.data,o=void 0===s?{}:s,c=i.score,h=i.connectedPlayers,u=void 0===h?[]:h,l=i.profile;switch(t.type){case Na:var d=i.playerId,p=i.name,f=i.photo,m=i.locale,g=i.data;if(n.playerId=d,n.name=p,n.photo=f,n.locale=m,GameCore.Utils.Valid.isObject(g)){var v=g;n.data=(0,An.TS)(e.data,v)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case Fa:var y=l.playerId,E=l.name,C=l.photo,A=l.locale,w=l.ASID;n.ASID=w,n.playerId=y,n.name=E,n.photo=C,n.locale=A;break;case Za:n.data.score=c;break;case Ua:n.data.settings[a]=r;break;case Ga:n.data=(0,An.TS)(e.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case Wa:if(u.length<=0)break;var S=GameCore.Utils.Object.keyBy(u,"playerId");n.connectedPlayers=(0,An.TS)(e.connectedPlayers,S)}}}))},ts),gs={data:{},profileIds:[]},vs=((ns={})[Er]=function(e,t){return void 0===e&&(e=gs),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.data,s=void 0===r?[]:r;if(t.type===yr){var o=GameCore.Utils.Object.keyBy(s,"playerId"),c=Object.keys(o);n.data=(0,a.Z)({},e.data);for(var h=0,u=Object.keys(o);h<u.length;h++){var l=u[h];n.data[l]=o[l]}n.profileIds=[].concat(new Set([].concat(e.profileIds,c)))}}}))},ns),ys={mode:"",status:In,rescued:0,startAt:0,finishAt:0},Es={single:{_id:"",data:{fen:""},playerId:"",status:In},group:{status:In,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:In,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:In,players:{}},updateAt:0,isRequesting:!1},Cs={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},As=((is={})[Xe]=(0,Jr.UY)({gameplay:function(e,t){return void 0===e&&(e=ys),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.mode,r=i.status;switch(t.type){case Nt:n.status=In,n.mode=ys.mode,n.rescued=ys.rescued,n.startAt=ys.startAt,n.finishAt=ys.finishAt,n.opponentInfo=ys.opponentInfo;break;case Gt:n.mode=a,n.status=On,n.rescued=ys.rescued,n.startAt=Date.now();break;case Ft:n.mode="string"===typeof a?a:e.mode,n.status=r||e.status;break;case Zt:n.status=Rn,n.finishAt=Date.now();break;case"MATCH_GAMEPLAY_RESCUE":n.rescued+=1}}}))},match:function(e,t){return void 0===e&&(e=Es),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.match,s=i.opponentInfo,o=i.players;switch(t.type){case Yt:case Kt:case jt:case qt:case nn:n.isRequesting=!0;break;case"MATCH_SINGLE_MOVE_UPDATED":n.single=(0,a.Z)({},e.single,r),n.updateAt=Date.now();break;case zt:n.isRequesting=!1,n.single=r||Es.single;break;case Vt:n.isRequesting=!1,n.single=Es.single;break;case Xt:case Jt:n.isRequesting=!0,n.challenge.opponentInfo=s;break;case Qt:n.isRequesting=!1,n.challenge=(0,a.Z)({},r||Es.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case $t:n.isRequesting=!1,n.challenge=Es.challenge;break;case en:n.group.status=On,s&&(n.group.opponentInfo=s);break;case tn:n.group.status=Rn;break;case"MATCH_ONLINE_DATA_CLEAR":n.online.status=Es.online.status,n.online.players=Es.online.players;break;case an:n.online.status=On,n.online.players=o;break;case"MATCH_ONLINE_FINISH_REQUEST":n.online.status=Rn}}}))},stats:function(e,t){return void 0===e&&(e=Cs),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.playerId,s=i.stats,o=i.match,c=i.current,h=i.players,u=i.leaders;switch(t.type){case Ut:delete n.data[r],n.current=Cs.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=Cs.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=s,n.isRequesting=!1;break;case Wt:n.data[r]=s;break;case Ht:n.current=(0,An.TS)((0,a.Z)({},e.current),s);break;case an:Object.keys(h).forEach((function(e){n.data[e]={score:0}}));break;case"MATCH_ONLINE_STATS_UPDATE":u.forEach((function(e){var t=e.playerId,i=e.score,a=e.rank;n.data[t]={score:i,rank:a}}));break;case Qt:var l=o||{},d=l.blackPlayerId,p=l.blackPlayerScore,f=l.whitePlayerId,m=l.whitePlayerScore,g=l.whitePlayerLevel,v=l.blackPlayerLevel;if(!d||!f)break;c&&(n.current=c),n.data[d]={score:p,level:v},n.data[f]={score:m,level:g}}}}))}}),is),ws={active:!1,tournamentId:null,leaderboardId:null,bestSessionScore:0,isRequesting:!1},Ss=((as={}).tournament=function(e,t){return void 0===e&&(e=ws),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.score,r=void 0===a?0:a,s=i.tournamentId,o=i.leaderboardId;switch(t.type){case dt:n.active=!0,n.tournamentId=s,n.leaderboardId=o;break;case pt:n.isRequesting=!0;break;case ft:n.isRequesting=!1,r>e.bestSessionScore&&(n.bestSessionScore=r)}}}))},as),bs="leaderboards",Ts="LEADERBOARD_DATA_REQUEST",xs="LEADERBOARD_DATA_UPDATE",Ps="LEADERBOARD_DATA_CLEAR",ks={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},Is=((rs={})[bs]=function(e,t){return void 0===e&&(e=ks),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var r=i.leaderboardId,s=i.type,o=i.limit,c=i.offset,h=i.leaders;switch(t.type){case Ts:e.type!==s&&0===c&&(n.leaders=ks.leaders),n.isRequesting=!0,n.leaderboardId=r,n.type=s,n.limit=o,n.offset=c;break;case xs:if(n.isRequesting=!1,e.type!==s)break;var u=GameCore.Utils.Json.clone((0,a.Z)({},e.leaders,h)),l=Object.values(u).filter((function(e){return!!e.name&&!!e.photo}));l.sort((function(e,t){return+t.score-+e.score})),l.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case Ps:n.isRequesting=!1,n.type=ks.type,n.limit=ks.limit,n.offset=ks.offset,n.leaders=ks.leaders,n.leaderboardId=ks.leaderboardId}}}))},rs),Os="missions",Rs="MISSIONS_DATA_REQUEST",Bs="MISSIONS_DATA_RECEIVE",Ds="MISSION_UPDATE",Ls="MISSION_COMPLETED",_s={mission:null,missions:null,isRequesting:!1},Ms=((ss={})[Os]=function(e,t){return void 0===e&&(e=_s),(0,Qr.ZP)(e,(function(n){var i,a,r=t.payload;if(r){var s=r.name,o=r.type,c=r.value,h=r.missions;switch(t.type){case Rs:n.isRequesting=!0;break;case Bs:if(n.isRequesting=!1,h.length<1)return;n.missions={},h.forEach((function(e){n.missions[e.name]=e}));break;case"MISSION_START":if(null===e.missions)break;var u=e.missions[s];n.mission={name:s,process:{},require:u.require,reward:u.reward},Object.keys(u.require).forEach((function(e){n.mission.process[e]=0}));break;case Ds:if((null==(i=e.mission)?void 0:i.name)!==s)break;n.mission.process[o]+=c;break;case Ls:if((null==(a=e.mission)?void 0:a.name)!==s)break;n.mission=null}}}))},ss),Ns="dailyTasks",Gs="DAILY_TASKS_DATA_REQUEST",Zs="DAILY_TASKS_DATA_RECEIVE",Fs="DAILY_TASK_VALUE_ADD",Us="DAILY_TASK_FINISHED",Ws={tasks:[],process:[],isRequesting:!1,isNotice:!1},Hs=((os={})[Ns]=function(e,t){return void 0===e&&(e=Ws),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.id,r=i.type,s=i.value,o=i.tasks,c=i.process;switch(t.type){case Gs:n.isRequesting=!0;break;case Zs:n.isRequesting=!1,n.tasks=o;break;case"DAILY_TASKS_PROCESS_UPDATE":n.process=c;break;case Fs:if(!e.process[a])break;n.process[a][r]+=s;break;case"DAILY_TASK_REWARDED":if(!e.process[a])break;n.process[a].rewarded=!0;break;case"DAILY_TASKS_SEEN":n.isNotice=!1;break;case Us:n.isNotice=!0}}}))},os),Ys="dailyRewards",Ks="DAILY_REWARDS_REQUEST",zs="DAILY_REWARDS_RECEIVE",Vs={rewards:[],isRequesting:!1},js=((cs={})[Ys]=function(e,t){return void 0===e&&(e=Vs),(0,Qr.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.rewards;switch(t.type){case Ks:e.isRequesting=!0;break;case zs:e.isRequesting=!1,e.rewards=i}}}))},cs),Xs=(0,Jr.UY)((0,a.Z)({scene:function(e,t){return void 0===e&&(e=$r),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.sceneKey;if(t.type===kt.DW)n.currentSceneKey=a,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=hs),(0,Qr.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,a=n.contextId,r=n.contextType,s=n.entryPointData;switch(t.type){case kt.kL:e.contextId=a,e.contextType=r,e.entryPointData=s;break;case kt.fJ:e.contextId=a,e.contextType=r,e.processed=!0;break;case kt.EH:e.currentGameMode=i}}}))},messages:function(e,t){return void 0===e&&(e=ls),(0,Qr.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(t.type){case kt.qj:e.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case kt.rh:e.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},ps,ms,vs,As,Ss,Is,Ms,Hs,js)),qs=n(65),Js=function(e){return(0,qs.xC)({reducer:Xs,preloadedState:e,devTools:!0})},Qs=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).store=void 0,t.initiator=void 0,t.dispatch=function(e){return t.store.dispatch(e)},t.getState=function(){return t.store.getState()},t.subscribe=function(e){return t.store.subscribe(e)},t.watch=function(e,n){var i=qr()((function(){var n=t.getState();return e(n)}));return t.subscribe(i((function(e){n(e)})))},t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.store=Js({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initPlayerManually=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initiator.initPlayer();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),$s=Qs,eo=n(43),to=n.n(eo),no=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,s.Z)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}to().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,a=e.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,a=document.createElement("style");document.head.appendChild(a);var r=a.sheet;if(r){var s="";switch(i){case"opentype":s=".otf";break;case"truetype":s=".ttf";break;case"woff":s=".woff"}var o='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+s+'") format("'+i+'"); }';r.insertRule(o,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),io=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.addFont=function(e){var t=new no(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),ao=io,ro=n(16),so={Mobile:{Background:["bg-0","bg-1","bg-2","bg-3","bg-4"],CardFace:["card-style-0","card-style-1","card-style-2"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4"]},Desktop:{Background:["bg-desktop-1","bg-desktop-1","bg-desktop-2","bg-desktop-3","bg-desktop-4"],CardFace:["card-style-0","card-style-desktop-0","card-style-2"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4"]}},oo=GameCore.ImageScale,co={Background:{File:"./assets/images/"+oo+"x/{}.jpg"},CardFaceAtlas:{Texture:"./assets/textures/"+oo+"x/{}.png",JSON:"./assets/textures/"+oo+"x/{}.json"}},ho=co.Background,uo=co.CardFaceAtlas,lo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.backgroundIdx=void 0,t.cardFaceIdx=void 0,t.cardBackIdx=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),this.events=new Phaser.Events.EventEmitter},n.getCurrentThemeResources=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx;return this.getThemeResources(t,n)},n.getThemeResources=function(e,t){var n=this.game.world.isLandscape()?so.Desktop:so.Mobile,i=n.Background[e]||n.Background[0],a=(0,ro.Z)(ho.File,[i]),r=n.CardFace[t]||n.CardFace[0];return{backgroundKey:i,backgroundFile:a,cardFaceKey:r,cardFaceTexture:(0,ro.Z)(uo.Texture,[r]),cardFaceJSON:(0,ro.Z)(uo.JSON,[r])}},n.getBackgroundConfigs=function(){return(this.game.world.isLandscape()?so.Desktop:so.Mobile).Background.map((function(e){return{key:e,url:(0,ro.Z)(ho.File,[e])}}))},n.getCardStyleAtlasConfigs=function(){return(this.game.world.isLandscape()?so.Desktop:so.Mobile).CardFace.map((function(e){return{key:e,textureURL:(0,ro.Z)(uo.Texture,[e]),atlasURL:(0,ro.Z)(uo.JSON,[e])}}))},n.getCurrentThemeConfig=function(){var e=this.backgroundIdx,t=this.cardFaceIdx,n=this.cardBackIdx;return this.game.world.isLandscape()?{backgroundKey:so.Desktop.Background[e],cardFaceKey:so.Desktop.CardFace[t],cardBackFrame:so.Desktop.CardBack[n]}:{backgroundKey:so.Mobile.Background[e],cardFaceKey:so.Mobile.CardFace[t],cardBackFrame:so.Mobile.CardBack[n]}},n.getCurrentIdxConfig=function(){var e=this.game.player.getPlayerSettings(),t=e.backgroundDesktopIdx,n=e.cardFaceDesktopIdx,i=e.cardBackDesktopIdx,a=e.backgroundIdx,r=e.cardFaceIdx,s=e.cardBackIdx;return this.game.world.isLandscape()?{backgroundIdx:t,cardFaceIdx:n,cardBackIdx:i}:{backgroundIdx:a,cardFaceIdx:r,cardBackIdx:s}},n.getThemePreview=function(){return this.game.world.isLandscape()?so.Desktop:so.Mobile},n.changeBackground=function(e){this.game.world.isLandscape()?this.game.player.setSetting("backgroundDesktopIdx",e):this.game.player.setSetting("backgroundIdx",e),this.backgroundIdx=e},n.changeCardFace=function(e){this.game.world.isLandscape()?this.game.player.setSetting("cardFaceDesktopIdx",e):this.game.player.setSetting("cardFaceIdx",e),this.cardFaceIdx=e},n.changeCardBack=function(e){this.game.world.isLandscape()?this.game.player.setSetting("cardBackDesktopIdx",e):this.game.player.setSetting("cardBackIdx",e),this.cardBackIdx=e},n.updateCurrentCardStyle=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx,i=e.cardBackIdx;this.setCurrentStyle(t,n,i)},n.setCurrentStyle=function(e,t,n){this.backgroundIdx=e,this.cardFaceIdx=t,this.cardBackIdx=n},t}(Phaser.Plugins.BasePlugin),po=lo,fo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).imageLoaded=new Map,t.currentBackgroundKey=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.setBackground=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBackgroundKey!=t){e.next=2;break}return e.abrupt("return");case 2:return this.currentBackgroundKey=t,e.next=5,this.preloadBackgroundAsync(t,n);case 5:a=null==(i=this.imageLoaded.get(t))?void 0:i.image,(r=document.getElementById("background"))&&(r.style.backgroundImage="url("+a.src+")");case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setBackgroundWithAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBackgroundKey!=t){e.next=2;break}return e.abrupt("return");case 2:return this.currentBackgroundKey=t,e.next=5,this.preloadBackgroundAsync(t,n);case 5:if(a=null==(i=this.imageLoaded.get(t))?void 0:i.image,r=document.getElementById("background"),s=document.createElement("div"),!r){e.next=15;break}return s.id="background",s.style.backgroundImage="url("+a.src+")",r.before(s),e.next=14,this.fadeOut(r,500);case 14:r.remove();case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.preloadBackgroundAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.imageLoaded.get(t)||null==(i=this.imageLoaded.get(t))||!i.loaded){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.abrupt("return",new Promise((function(e){var i=new Image;i.src=n;var r={url:n,image:i,loaded:!1};a.imageLoaded.set(t,r),i.onload=function(){r.loaded=!0,e()}})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.fadeOut=function(){var e=(0,r.Z)(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i=0,a=setInterval((function(){i+=16;var r=Math.min(i/n,1);1===r&&(clearInterval(a),e()),t.style.opacity=""+(1-r)}),16)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),mo=fo,go=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).isVisible=!0,t.browserPrefixes=["moz","ms","o","","webkit"],t.visibleCallbacks=[],t.hiddenCallbacks=[],t.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?t.onVisibleEvent():t.onHiddenEvent();var n=t.getBrowserPrefix(),i=t.getHiddenPropertyName(n);return document[i]?t.onHiddenEvent():t.onVisibleEvent()},t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(){var e=this.getBrowserPrefix();this.getVisibilityEvent(e)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),vo=go,yo=function(e){this.items=e},Eo=[new yo([{type:qi.COIN,amount:2e3},{type:qi.UNDO,amount:5},{type:qi.PLUS_5_CARDS,amount:2},{type:Ki.STORM,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new yo([{type:qi.COIN,amount:1500},{type:qi.UNDO,amount:3},{type:qi.PLUS_5_CARDS,amount:1},{type:Ki.STORM,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new yo([{type:qi.COIN,amount:1e3},{type:qi.UNDO,amount:2},{type:Ki.STORM,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new yo([{type:qi.COIN,amount:500},{type:qi.UNDO,amount:1},{type:Ki.SLICE,amount:1},{type:Ki.WILD_CARD,amount:1}]),new yo([{type:qi.COIN,amount:500}])];function Co(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ao(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ao(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var wo=function(e){return e[e.WAITING=0]="WAITING",e[e.HAPPENING=1]="HAPPENING",e[e.FINISHED=2]="FINISHED",e}({}),So="tournament-time-out",bo="show-notification",To="finish-tournament",xo="tournament-requested",Po={rank:-1,score:0},ko=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.config=GameCore.Configs.WeeklyTournament,t.currentLeaderboardData=[],t.worldTournaments=[],t.currentTournament=void 0,t.status=wo.WAITING,t.playerProgress=(0,a.Z)({},Po),t.playerTournamentData=void 0,t.leaderAchievementMap=new Map,t.isRefuseJoinTournament=!1,t.loadWorldTournamentsPromise=void 0,t.pushScorePromise=void 0,t.requestLeaderboardPromise=void 0,t.requestRequestLeaderboardRangesPromise=void 0,t.requestPlayerProgressPromise=void 0,t.requestLeaderAchievementPromise=void 0,t.requestDataAfterFinishGamePromise=void 0,t.requestDataStartGamePromise=void 0,t.tournamentIdFromPost=void 0,t.haveProgressUpdate=!1,t.needUpdatePlayerProgress=!0,t.oldProgress=(0,a.Z)({},Po),t.isFirstTimePlayerGotoTop=!1,t.leaderboardRanges=[],t.isNeedLoadTopLeaders=!0,t.isHaveValidTournament=!1,t.notifyEvent=void 0,t.tournamentMode=void 0,t.totalLeaders=void 0,t.rewardRank=void 0,t.lastCallJoinTournament=void 0,t.callJoinTournamentCount=void 0,t.handleJoinTournament=function(){var e=(0,r.Z)(c().mark((function e(n){var i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.currentTournament){e.next=3;break}return e.abrupt("return","error");case 3:if(r=a.id.toString(),s=a.endTime,o=(null==(i=a.payload)?void 0:i.leaderboardId)||"",!t.isTournamentFinished()){e.next=12;break}return t.setStatus(wo.FINISHED),e.next=10,t.checkRewardPreviousTournament();case 10:if(!t.isPlayerProgressInValid()&&t.hasReward()){e.next=12;break}return e.abrupt("return","error");case 12:if(t.needUpdatePlayerProgress=!0,e.prev=13,t.isTournamentMode()){e.next=17;break}return e.next=17,t.game.facebook.tournament.joinAsync(r);case 17:if(t.game.storage.dispatch(vt(r,o)),n?t.game.storage.dispatch(mi()):t.tournamentMode=!0,t.setStatus(wo.HAPPENING),t.hasPlayerJoined()&&!t.config.LeaderboardMockId){e.next=29;break}return t.pushScoreToLeaderboard(0),e.next=25,t.waitForSetScoreCompleted();case 25:return h=0===t.playerTournamentData.playerStartLevel?t.game.player.getLevel():t.playerTournamentData.playerStartLevel,t.updateWeeklyTournament({hasJoined:!0,tournamentId:r,leaderboardId:o,endTime:s,playerStartLevel:h,firstTimeShown:(new Date).getTime(),leaderboardShown:!0}),e.next=29,t.fetchPlayerData();case 29:return e.abrupt("return","success");case 32:if(e.prev=32,e.t0=e.catch(13),"USER_INPUT"!==(null==e.t0?void 0:e.t0.code)){e.next=37;break}return e.abrupt("return","close");case 37:throw e.t0;case 38:case"end":return e.stop()}}),e,null,[[13,32]])})));return function(t){return e.apply(this,arguments)}}(),t.isJoinFromPost=!1,t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(){this.config=GameCore.Configs.WeeklyTournament;var e=this.config.LeaderboardLimit;this.setTotalLeaders(e),this.rewardRank=this.createRewardArray(this.config.Rewards)},n.createRewardArray=function(e){var t=[];return Object.entries(e).forEach((function(e){var n=e[0],i=e[1],a=parseInt(n.replace("Top",""),10);if(!isNaN(a)&&i>0)for(var r=0;r<i;r++)t.push(a)})),t},n.initData=function(){var e=this;this.events=new Phaser.Events.EventEmitter,this.playerTournamentData=this.game.player.getWeeklyTournament(),this.updateData().then((function(){e.notifyEvent=!0,e.callJoinTournamentCount=0,e.events.emit(xo)}))},n.popupJoinTournament=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.callJoinTournamentCount>=3)){e.next=2;break}return e.abrupt("return");case 2:if(!this.lastCallJoinTournament){e.next=7;break}if(t=(new Date).getTime(),!(t-this.lastCallJoinTournament<12e4)){e.next=7;break}return e.abrupt("return");case 7:if(this.hasPlayerJoined()){e.next=9;break}return e.abrupt("return");case 9:if(!this.isTournamentMode()){e.next=11;break}return e.abrupt("return");case 11:if(!(n=this.currentTournament)){e.next=26;break}return e.prev=13,a=n.id.toString(),r=(null==(i=n.payload)?void 0:i.leaderboardId)||"",e.next=18,this.game.facebook.tournament.joinAsync(a);case 18:return this.game.storage.dispatch(vt(a,r)),this.updateWeeklyTournament({hasJoined:!0}),e.next=22,this.setTournamentMode();case 22:e.next=26;break;case 24:e.prev=24,e.t0=e.catch(13);case 26:this.lastCallJoinTournament=(new Date).getTime(),this.callJoinTournamentCount+=1;case 28:case"end":return e.stop()}}),e,this,[[13,24]])})));return function(){return e.apply(this,arguments)}}(),n.update=function(){this.checkTimeOut(),this.notifyEvent&&this.events.emit(bo)},n.checkTimeOut=function(){this.isTournamentTimeOut()&&this.onTimeOut()},n.onTimeOut=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHappening()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.updateData();case 4:this.notifyEvent=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPlayerHaveLeaderboardId()){e.next=26;break}if(!this.hasPlayerJoined()){e.next=16;break}if(this.isHaveValidTournament=!0,!this.isTournamentFinished()){e.next=12;break}return this.setStatus(wo.FINISHED),e.next=7,this.checkRewardPreviousTournament();case 7:if(!this.isPlayerProgressInValid()){e.next=10;break}return e.next=10,this.chooseNewTournament();case 10:e.next=14;break;case 12:this.setStatus(wo.HAPPENING),this.requestDataStartGame();case 14:e.next=24;break;case 16:if(!this.isTournamentFinished()){e.next=21;break}return e.next=19,this.chooseNewTournament();case 19:e.next=24;break;case 21:return this.setStatus(wo.WAITING),e.next=24,this.fetchCurrentHappeningTournament();case 24:e.next=28;break;case 26:return e.next=28,this.chooseNewTournament();case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.requestDataStartGame=function(){var e=this;return this.requestDataStartGamePromise=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchCurrentHappeningTournament();case 2:return t.next=4,e.requestPlayerProgress();case 4:e.needUpdatePlayerProgress=!1,e.isPlayerProgressInValid()&&e.chooseNewTournament();case 6:case"end":return t.stop()}}),t)})))().finally((function(){e.requestDataStartGamePromise=void 0})),this.requestDataStartGamePromise},n.isTournamentFinished=function(){var e=(new Date).getTime()/1e3,t=this.playerTournamentData.endTime<e;return t},n.isPlayerHaveLeaderboardId=function(){return""!=this.playerTournamentData.leaderboardId},n.hasPlayerJoined=function(){return""!=this.playerTournamentData.leaderboardId&&this.playerTournamentData.hasJoined},n.checkRewardPreviousTournament=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestPlayerProgress();case 2:if(-1!=this.playerProgress.rank){e.next=4;break}return e.abrupt("return");case 4:if(!(this.playerProgress.rank>this.rewardRank.length)){e.next=6;break}return e.abrupt("return");case 6:this.updateWeeklyTournament({hasReward:!0});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.fetchCurrentHappeningTournament=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentTournament){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadWorldTournaments();case 4:if(!(this.worldTournaments.length>0)){e.next=12;break}if(this.currentTournament=this.worldTournaments.filter((function(e){return e.id.toString()==t.playerTournamentData.tournamentId}))[0],this.isHaveValidTournament=!0,this.currentTournament){e.next=10;break}return e.next=10,this.chooseNewTournament();case 10:e.next=14;break;case 12:return e.next=14,this.chooseNewTournament();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.chooseNewTournament=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setStatus(wo.WAITING),e.next=3,this.loadWorldTournaments();case 3:(t=this.getValidTournaments()).length>0?(this.currentTournament=this.getAvailableTournament(t),this.updateWeeklyTournament({hasJoined:!1,leaderboardId:null==(n=this.currentTournament.payload)?void 0:n.leaderboardId,tournamentId:this.currentTournament.id.toString(),endTime:this.currentTournament.endTime}),this.setStatus(wo.WAITING),this.notifyEvent=!0,this.isHaveValidTournament=!0):(this.setStatus(wo.FINISHED),this.isHaveValidTournament=!1,this.events.emit(xo));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getValidTournaments=function(){var e=this.worldTournaments.filter((function(e){return(0,le.s)(e.endTime).remainingTimeInMs>1e3}));return e},n.getAvailableTournament=function(e){var t=this;if(this.tournamentIdFromPost){var n=e.find((function(e){return e.id.toString()===t.tournamentIdFromPost}));if(n)return n}return e[Math.floor(Math.random()*e.length)]},n.loadWorldTournaments=function(){var e=this;return this.loadWorldTournamentsPromise=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.currentTournament||e.isPlayerProgressInValid()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,lt();case 5:e.worldTournaments=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),e.worldTournaments=[];case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))().finally((function(){e.loadWorldTournamentsPromise=void 0})),this.loadWorldTournamentsPromise},n.waitForLoadWorldTournamentsCompleted=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadWorldTournamentsPromise||Promise.resolve());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getMockAvatarInfo=function(e){return this.config.LeaderboardMockId?{name:"Leader "+e,photo:"https://reqres.in/img/faces/"+(Number.parseInt(e)+1)+"-image.jpg"}:{name:"Player",photo:"./assets/images/others/avatar.png"}},n.getLeadersWithProfiles=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.playerId})),e.next=3,this.game.profile.requestProfiles(n);case 3:return i=this.game.profile.getProfiles(),a=t.map((function(e){var t=e.playerId,n=e.score,a=e.rank,s=i[t],o=Number.parseInt(n.toString()),c=Number.parseInt(a.toString()),h=r.getMockAvatarInfo(t),u=(null==s?void 0:s.name)||h.name;return{playerId:t,photo:(null==s?void 0:s.photo)||h.photo,score:o,rank:c,name:u}})).filter((function(e){return null!==e})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestPlayerProgress=function(){var e=this;return this.requestPlayerProgressPromise=(0,r.Z)(c().mark((function t(){var n,i,a,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.playerTournamentData.leaderboardId){t.next=3;break}return t.abrupt("return");case 3:if(e.config.LeaderboardMockId&&(n=e.config.LeaderboardMockId),e.needUpdatePlayerProgress){t.next=6;break}return t.abrupt("return");case 6:if(!e.config.UseLeaderboardMock||e.config.LeaderboardMockId){t.next=13;break}return t.next=9,(0,le.qZ)(500);case 9:e.playerProgress.rank=3,e.playerProgress.score=100,t.next=32;break;case 13:return t.next=15,e.waitForSetScoreCompleted();case 15:return t.prev=15,t.next=18,Le(n,e.game.player.getPlayerId());case 18:if(i=t.sent){t.next=23;break}return e.playerProgress.rank=-1,e.playerProgress.score=-1,t.abrupt("return");case 23:a=Number.parseInt((null==i?void 0:i.rank)||"-1"),r=Number.parseInt((null==i?void 0:i.score)||"-1"),-1!=a||-1!=r?(e.playerProgress.rank=a,e.playerProgress.score=r):a==Po.rank&&r==Po.score&&(e.playerProgress.rank=-1,e.playerProgress.score=-1),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(15),e.playerProgress.rank=-1,e.playerProgress.score=-1;case 32:e.needUpdatePlayerProgress=!1;case 33:case"end":return t.stop()}}),t,null,[[15,28]])})))().finally((function(){e.requestPlayerProgressPromise=void 0})),this.requestPlayerProgressPromise},n.checkRequestPlayerProgress=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=null==(t=this.currentLeaderboardData)?void 0:t.find((function(e){return e.playerId===i.game.player.getPlayerId()})))){e.next=6;break}this.playerProgress.rank=n.rank,this.playerProgress.score=n.score,e.next=8;break;case 6:return e.next=8,this.requestPlayerProgress();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.waitForSetScoreCompleted=function(){return this.pushScorePromise||Promise.resolve()},n.waitForRequestLeaderboardCompleted=function(){return this.requestLeaderboardPromise||Promise.resolve()},n.waitForRequestLeaderboardRangesCompleted=function(){return this.requestRequestLeaderboardRangesPromise||Promise.resolve()},n.waitForRequestPlayerProgressCompleted=function(){return this.requestPlayerProgressPromise||Promise.resolve()},n.waitForRequestDataFinishGameCompleted=function(){return this.requestDataAfterFinishGamePromise||Promise.resolve()},n.waitForRequestDataStartGameCompleted=function(){return this.requestDataStartGamePromise||Promise.resolve()},n.waitForRequestTopLeadersCompleted=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.pushScorePromise,this.requestLeaderboardPromise],n=t.filter((function(e){return void 0!=e})),e.abrupt("return",Promise.all(n).then((function(){})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getCurrentLeaderboardId=function(){var e,t=this.playerTournamentData.leaderboardId;t||(t=null==(e=this.currentTournament)||null==(e=e.payload)?void 0:e.leaderboardId);return t},n.requestLeaderboardRanges=function(e){var t=this;return this.requestRequestLeaderboardRangesPromise=(0,r.Z)(c().mark((function n(){var i,a,r,s,o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=t.getCurrentLeaderboardId())&&-1!=e){n.next=3;break}return n.abrupt("return");case 3:if(t.config.LeaderboardMockId&&(i=t.config.LeaderboardMockId),!t.config.UseLeaderboardMock||t.config.LeaderboardMockId){n.next=10;break}return n.next=7,(0,le.qZ)(500);case 7:t.leaderboardRanges=t.getMockLeaderRanges(),n.next=26;break;case 10:return n.prev=10,a=t.totalLeaders,r=Math.max(e-1-Math.floor(a/2),0),n.next=15,ct(i,r,a);case 15:return s=n.sent,n.next=18,t.getLeadersWithProfiles(s);case 18:o=n.sent,t.leaderboardRanges=o,n.next=26;break;case 22:n.prev=22,n.t0=n.catch(10),t.leaderboardRanges=[];case 26:case"end":return n.stop()}}),n,null,[[10,22]])})))().finally((function(){t.requestRequestLeaderboardRangesPromise=void 0})),this.requestRequestLeaderboardRangesPromise},n.requestLeaderboardData=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.requestLeaderboardPromise=(0,r.Z)(c().mark((function e(){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isNeedLoadTopLeaders){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.waitForSetScoreCompleted();case 4:if(n=t.getCurrentLeaderboardId()){e.next=9;break}return t.isNeedLoadTopLeaders=!1,t.currentLeaderboardData=[],e.abrupt("return");case 9:if(t.config.LeaderboardMockId&&(n=t.config.LeaderboardMockId),!t.config.UseLeaderboardMock||t.config.LeaderboardMockId){e.next=16;break}return e.next=13,(0,le.qZ)(500);case 13:t.currentLeaderboardData=t.getMockLeaders(),e.next=30;break;case 16:return e.prev=16,e.next=19,t.getLeaderboardDataAsync(n);case 19:return i=e.sent,e.next=22,t.getLeadersWithProfiles(i);case 22:a=e.sent,t.currentLeaderboardData=a,e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),t.currentLeaderboardData=[];case 30:t.isNeedLoadTopLeaders=!1;case 31:case"end":return e.stop()}}),e,null,[[16,26]])})))().finally((function(){t.requestLeaderboardPromise=void 0})),e.abrupt("return",this.requestLeaderboardPromise);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getLeaderboardDataAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=this.totalLeaders),e.next=3,ht(t,{limit:n});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getLeaderboardData=function(){return this.currentLeaderboardData},n.getLeaderboardRanges=function(){return this.leaderboardRanges},n.isValid=function(){var e=this.game.player.getLevel()>=this.config.LevelStart,t=this.hasPlayerJoined(),n=e||t||this.isJoinFromPost;return this.config.Enable&&n&&this.isHaveValidTournament},n.canStartTournamentGame=function(){return this.isHappening()&&this.isTournamentMode()},n.join=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.hasPlayerJoined(),e.prev=1,e.next=4,this.handleJoinTournament(t);case 4:a=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),a="error";case 11:return"success"==a?i?this.logTournamentRejoin():this.logTournamentStart(n):"close"==a&&this.logTournamentRefuse(n,i),e.abrupt("return",a);case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),n.fetchPlayerData=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForSetScoreCompleted();case 2:return e.next=4,this.requestPlayerProgress();case 4:return t=this.config.LeaderboardMockId||this.playerTournamentData.leaderboardId,e.next=7,Le(t,this.game.player.getPlayerId());case 7:e.sent&&(this.oldProgress={rank:10001,score:0}),this.requestLeaderboardRanges(this.playerProgress.rank);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setStatus=function(e){e!=this.status&&(this.status=e)},n.isHappening=function(){return this.isValid()&&this.status==wo.HAPPENING},n.isWaiting=function(){return this.isValid()&&this.status==wo.WAITING},n.isFinished=function(){return this.isValid()&&this.status==wo.FINISHED},n.hasReward=function(){return this.isValid()&&this.playerTournamentData.hasReward},n.restartTournament=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logTournamentEnd(),this.clearCurrentTournament(),e.next=4,bi();case 4:return li.instance.setGameMode(oi.SINGLE),e.next=7,this.chooseNewTournament();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.onRefuse=function(){this.isRefuseJoinTournament=!0,this.setStatus(wo.WAITING)},n.isPlayerProgressInValid=function(){return!this.playerProgress||-1==this.playerProgress.rank||-1==this.playerProgress.score},n.canShowResultPreviousTournamentScreen=function(){var e=this.game.player.getLevel();return!(!this.config.Enable||!(e>=this.config.LevelStart||this.hasPlayerJoined()))&&(!this.isPlayerProgressInValid()&&!!this.hasPlayerJoinedFinishedTournament())},n.hasPlayerJoinedFinishedTournament=function(){return this.hasPlayerJoined()&&this.isTournamentFinished()},n.isTournamentTimeOut=function(){return this.isHappening()&&this.hasPlayerJoinedFinishedTournament()},n.canShowTournamentButton=function(){return this.isValid()},n.getMockLeaders=function(){var e=new Array(this.totalLeaders).fill(null).map((function(e,t){var n=t+1;return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:0,score:Math.floor(17*Math.random()*100/n)}}));e.sort((function(e,t){return t.score-e.score})),e.forEach((function(e,t){return e.rank=t+1}));var t=this.totalLeaders;if(3>this.totalLeaders&&this.totalLeaders<t)throw new Error("invalid mock player rank: 3");if(e.length>0&&3<=this.totalLeaders){e[2].name="You",e[2].playerId=this.game.player.getPlayerId(),e[2].photo="./assets/images/others/avatar.png"}return e},n.getMockLeaderRanges=function(){return this.getMockLeaders()},n.requestLeaderAchievements=function(){var e=this;return this.requestLeaderAchievementPromise=(0,r.Z)(c().mark((function t(){var n,i,a,r,s,o,h;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLeaderboardData().map((function(e){return e.playerId})),i=e.game.player.getPlayerId(),(a=n.filter((function(t){return!e.leaderAchievementMap.has(t)}))).includes(i)||a.push(i),t.next=6,ot(a);case 6:for(r=t.sent,s=Co(r);!(o=s()).done;)h=o.value,e.leaderAchievementMap.set(h.playerId,h.achievement);case 8:case"end":return t.stop()}}),t)})))().finally((function(){e.requestLeaderAchievementPromise=void 0})),this.requestLeaderAchievementPromise},n.getLeaderAchievement=function(e){if(this.leaderAchievementMap.has(e))return this.leaderAchievementMap.get(e)},n.updateWeeklyTournament=function(e){var t=this.playerTournamentData,n=(0,a.Z)({},t,e);this.playerTournamentData=n,this.game.player.updateWeeklyTournament(n)},n.getPlayerWeeklyTournamentData=function(){return this.playerTournamentData},n.setScore=function(e){this.oldProgress.score=this.playerProgress.score,this.playerProgress.score=e},n.setTournamentMode=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.tournamentMode=!1,t=window.game.facebook,e.next=5,t.getTournamentAsync().then((function(){n.tournamentMode=!0})).catch((function(){n.tournamentMode=!1}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.tournamentMode=!1;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n.getRank=function(){return this.playerProgress.rank},n.getScore=function(){return this.playerProgress.score},n.isPlayingTournament=function(){return this.isHappening()&&this.hasPlayerJoined()&&!this.isTournamentTimeOut()},n.isWeeklyTournamentTextureUrgent=function(){return this.canShowResultPreviousTournamentScreen()},n.handleNextLevel=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setScore(t),this.pushScoreToLeaderboard(this.playerProgress.score),e.next=4,this.waitForSetScoreCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestDataAfterFinishGame=function(){var e=this;return this.requestDataAfterFinishGamePromise=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isNeedLoadTopLeaders=!0,e.needUpdatePlayerProgress=!0,t.next=4,e.requestPlayerProgress();case 4:return e.isNewRankValidToHaveRankUpAnimation()&&e.requestLeaderboardData(),e.checkHaveProgressUpdate(),t.next=8,e.waitForRequestLeaderboardRangesCompleted();case 8:case"end":return t.stop()}}),t)})))().finally((function(){e.requestDataAfterFinishGamePromise=void 0})),this.requestDataAfterFinishGamePromise},n.getIsNeedLoadTopLeaders=function(){return this.isNeedLoadTopLeaders},n.pushScoreToLeaderboard=function(e){var t=this;void 0===e&&(e=0);var n=this.game.player.getPlayerId(),i=this.playerTournamentData.leaderboardId;return this.pushScorePromise=(0,r.Z)(c().mark((function a(){return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.config.LeaderboardMockId&&(i=t.config.LeaderboardMockId),a.next=3,ut(i,n,e).catch((function(e){(0,Y.tO)(new Error(e))}));case 3:0!=e&&t.logTournamentPostScore();case 4:case"end":return a.stop()}}),a)})))().finally((function(){t.pushScorePromise=void 0})),this.pushScorePromise},n.joinFromPost=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tournamentIdFromPost=t,this.isJoinFromPost=!0,this.tournamentMode=!0,!this.playerTournamentData||!this.isValid()){e.next=8;break}return this.currentTournament=void 0,e.next=7,this.chooseNewTournament();case 7:this.join(!1,"SHARE_POST");case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.canUpdateOldProgress=function(){return this.haveProgressUpdate},n.isNewRankValidToHaveRankUpAnimation=function(){var e=this.oldProgress.rank,t=this.playerProgress.rank,n=this.totalLeaders;return t<e&&t<n},n.checkHaveProgressUpdate=function(){var e=this.oldProgress.rank,t=this.playerProgress.rank,n=this.totalLeaders;if(this.haveProgressUpdate&&t>=n)return this.haveProgressUpdate=!1,void(this.isFirstTimePlayerGotoTop=!1);this.haveProgressUpdate||-1==this.playerProgress.rank||(this.isFirstTimePlayerGotoTop=!1,this.isNewRankValidToHaveRankUpAnimation()&&t!=this.currentLeaderboardData.length&&(e>n&&(this.isFirstTimePlayerGotoTop=!0),this.haveProgressUpdate=!0))},n.canShowRankUpAnimation=function(){return this.haveProgressUpdate&&this.isHappening()},n.logTournamentStart=function(e){this.game.analytics.event(te._.TOURNAMENT_START,{screen_name:e,level:this.game.player.getLevel(),tournament_id:this.playerTournamentData.tournamentId})},n.logTournamentEnd=function(){var e=this.game.player.getLevel()-this.playerTournamentData.playerStartLevel;this.game.analytics.event(te._.TOURNAMENT_END,{rank:this.playerProgress.rank,level:this.game.player.getLevel(),milestone:e,score:this.playerProgress.score,tournament_id:this.playerTournamentData.tournamentId})},n.logTournamentShare=function(){this.game.analytics.event(te._.TOURNAMENT_SHARE)},n.logTournamentPostScore=function(){this.game.analytics.event(te._.TOURNAMENT_POST_SCORE)},n.logTournamentRefuse=function(e,t){this.game.analytics.event(te._.TOURNAMENT_REFUSE,{screen_name:e,value:t})},n.logTournamentRejoin=function(){this.game.analytics.event(te._.TOURNAMENT_REJOIN)},n.getRemainingTime=function(){var e=this.getPlayerWeeklyTournamentData().endTime;return(0,le.s)(e).remainingTimeInMs},n.getRemainingTimeString=function(){if(this.isFinished())return"Finished";var e=this.getPlayerWeeklyTournamentData().endTime,t=(0,le.s)(e),n=t.remainingTimeInDays,i=t.remainingTimeInMs;return n>=1?n+" "+(n>=2?"days":"day"):0==i?"Finished":""+(0,le.F0)(i,!0)},n.isTournamentMode=function(){return this.tournamentMode},n.getCurrentTournament=function(){return this.currentTournament},n.isLoadingTournaments=function(){return void 0!=this.loadWorldTournamentsPromise},n.debugRankUp=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestLeaderboardData();case 2:this.playerProgress.rank=this.playerProgress.rank-2,this.playerProgress.score=this.playerProgress.score+1e3,this.checkHaveProgressUpdate();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkNotifyEvent=function(){return this.notifyEvent},n.setNofityEvent=function(e){this.notifyEvent=e},n.setTotalLeaders=function(e){this.totalLeaders=e},n.getRewardData=function(e){var t=this.rewardRank[e-1];return Eo[t-1].items},n.getTopByRank=function(e){return e>this.rewardRank.length?-1:this.rewardRank[e-1]},n.getLeaderboardId=function(){return this.hasPlayerJoined()?this.playerTournamentData.leaderboardId:""},n.getTotalLeaders=function(){return this.totalLeaders},n.clearCurrentTournament=function(){this.status,wo.WAITING,this.updateWeeklyTournament({hasJoined:!1,tournamentId:"",leaderboardId:"",endTime:0,hasReward:!1,firstTimePlay:!0,playerStartLevel:0,firstTimeShown:0,leaderboardShown:!1})},n.pushScoreToLeaderboardWithPlayerId=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return i=this.playerTournamentData.leaderboardId,this.config.LeaderboardMockId&&(i=this.config.LeaderboardMockId),e.next=6,ut(i,t,n).catch((function(e){(0,Y.tO)(new Error(e))}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),Io=ko,Oo=n(20),Ro=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.emit=function(t){return e.prototype.emit.call(this,t)},t}(Phaser.Events.EventEmitter),Bo=Ro,Do=20/9,Lo=5/3,_o=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=void 0,t.previousLayout=void 0,t.resizeEventData=void 0,t.portraitRatio=void 0,t.portraitWidth=void 0,t.portraitHeight=void 0,t.landscapeRatio=void 0,t.landscapeWidth=void 0,t.landscapeHeight=void 0,t.worldWidth=void 0,t.worldHeight=void 0,t.worldRatio=void 0,t.autoResize=void 0,t.disableLandscape=void 0,t.fullSizeOnLandscape=void 0,t.currentLayout=void 0,t.forcePixelRatio=void 0,t.safeAreaBottom=void 0,t.bannerDisplaying=!1,t.handleResize=(0,Oo.D)((function(){t.calculateSafeAreaBottom(),t.resize(),t.events.emit("resize")}),100),t}(0,s.Z)(t,e);var n=t.prototype;return n.setBannerDisplaying=function(e){this.bannerDisplaying=e,this.updateAppSize(),this.resize()},n.configure=function(e){this.calculateSafeAreaBottom(),this.events=new Bo;var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,a=e.portraitHeight,r=e.landscapeWidth,s=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,h=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=h,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=a,this.landscapeRatio=o,this.landscapeWidth=r;var u=Math.round(this.safeAreaBottom/this.getScreenHeight()*s);this.landscapeHeight=s+u,this.initWorldSize(),this.addEventResize()},n.calculateSafeAreaBottom=function(){try{this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.getSAB=function(){if("bottom"==this.game.ads.getBannerPosition())return 0;var e=this.game.world,t=e.getZoomRatio(),n=e.getPixelRatio();return Math.max((this.safeAreaBottom-8)*n/t,0)},n.getBannerHeight=function(){var e,t=GameCore.Configs.Ads.BannerAdOptions,n=50;GameCore.Utils.Device.isDesktop()?n=0:n=(null==(e=t.find((function(e){return"bottom"===e.position})))?void 0:e.bannerHeight)||50;return n},n.resize=function(e){var t=this;e&&e>0&&(this.forcePixelRatio=e),this.updateGameWrapper();var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),a=t.getWorldSize(),r=a.width,s=a.height;n.setZoom(i),n.centerOn(r/2,s/2)}}))},n.checkOrientation=function(){GameCore.Utils.Device.isDesktop()||(window.innerHeight/window.innerWidth<1.2?this.hideDiv("wrongRotation"):this.showDiv("wrongRotation"))},n.getCanvasSab=function(){var e=this.bannerDisplaying?this.getBannerHeight():0;return 0==e?0:"bottom"==this.game.ads.getBannerPosition()?this.safeAreaBottom+e:e},n.updateAppSize=function(){var e=window.document.getElementById("app"),t=this.getCanvasSab();e&&(e.style.height="calc(100% - "+t+"px)",e.style.width="100%")},n.updateGameWrapper=function(){var e=this.getValidScreenRatio(),t=this.getScreenWidth(),n=this.getScreenHeight(),i=t/n,a=window.document.getElementById("game-wrapper");if(i<e){var r=t,s=Math.round(r/e);a.style.height=s+"px",a.style.width=r+"px"}else{var o=n,c=Math.round(o*e);a.style.height=o+"px",a.style.width=c+"px"}this.events.emit(Hr.Z.RESIZE)},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.getValidScreenRatio=function(){if(void 0!=this.worldRatio)return this.worldRatio;var e=this.getScreenRatio();return e>Do?Do:e<Lo?Lo:e},n.initWorldSize=function(){if(this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight,GameCore.layoutInitializer.isLandscape){if(!this.disableLandscape&&(this.landscapeRatio=Math.min(this.getScreenRatio(),Do),this.landscapeRatio=Math.max(this.landscapeRatio,Lo),this.worldHeight=this.landscapeHeight,this.worldWidth=this.worldHeight*this.landscapeRatio,this.currentLayout="landscape",this.fullSizeOnLandscape)){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=this.getScreenRatio();var e=this.getCanvasSizeFixedRatio(this.landscapeRatio),t=e.width,n=e.height,i=this.getZoomRatio();this.worldWidth=t/i,this.worldHeight=n/i}}else this.worldHeight=this.worldWidth/this.getScreenRatio();this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(GameCore.Utils.Device.isDesktop())return 2;var e=Math.round(GameCore.Utils.Device.pixelRatio());return e>2&&(e=2),e},n.getPixelRatioForCanvas=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;var e=GameCore.Utils.Device.pixelRatio();return e=GameCore.Utils.Device.isDesktop()?Phaser.Math.Clamp(e,1.5,2):Phaser.Math.Clamp(e,1,2.5)},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatioForCanvas(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){return window.document.getElementById("app").clientHeight||0},n.getScreenWidth=function(){return window.document.getElementById("app").clientWidth||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return!this.disableLandscape&&this.worldRatio>this.portraitRatio},n.getResizeEventData=function(){return this.resizeEventData},n.showDiv=function(e){var t=document.getElementById(e);t&&(t.style.display="block")},n.hideDiv=function(e){var t=document.getElementById(e);t&&(t.style.display="none")},t}(Phaser.Plugins.BasePlugin),Mo=_o,No=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||us.contextId,this.contextType=t||us.contextType,this.entryPointData=n||us.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),Go={score:"score",settings:"settings",gameData:"gameData",userGuideDisplays:"userGuideDisplays"},Zo=GameCore.Configs.SyncProfileFromAPI,Fo=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new No(e,n,i).toObject(),r=a.contextId,s=a.contextType,o=a.entryPointData;t.game.storage.dispatch(function(e,t,n){return{type:kt.kL,payload:{contextId:e,contextType:t,entryPointData:n}}}(r,s,o))},this.initPlayer=(0,r.Z)(c().mark((function e(){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game.player,i=t.getPlayerInfo(),a=Object.values(Go),e.next=5,FBInstant.player.getDataAsync(a);case 5:return r=e.sent,s=new Ma(r),e.next=11,t.maintainDataStructure(s);case 11:return s=e.sent,!0===s.toObject().settings.music&&window.game.audio.playMusic(),e.next=16,n.receiveData(i,s.convertToPlayerData());case 16:case"end":return e.stop()}}),e)}))),this.maintainDataStructure=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Zo){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced","customFields"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,!0!==(n.isSynced||!1)){e.next=12;break}return e.abrupt("return",t);case 12:if(i=n.customFields||!1){e.next=15;break}return e.abrupt("return",t);case 15:return(r=t.convertToPlayerData()).customFields=i,s=new Ma({}).convertToFacebookData(r),e.next=20,FBInstant.player.setDataAsync((0,a.Z)({},s,{isSynced:!0}));case 20:return e.abrupt("return",new Ma(s));case 23:return e.prev=23,e.t1=e.catch(0),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.GameSDK.player.getID(),t=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new Ln(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new ne.Z(e,t,n,i).toObject()}catch(a){return new ne.Z("123","You").toObject()}},this.game=e},Uo=n(42),Wo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).Text=void 0,t.Texture=void 0,t.FontSize=void 0,t.currentLocale=void 0,t.supportedLanguages=void 0,t.data=void 0,t.options=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.configure=function(e){this.applyOptions(e)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(e){void 0===e&&(e="en");var t=this.getCorrectLocale(e);this.currentLocale=t,this.Text=this.data[t].Text,this.Texture=this.data[t].Texture,this.FontSize=this.data[t].FontSize},n.getText=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,r=void 0===a?this.currentLocale:a,s=this.getCorrectLocale(r),o=this.data[s].Text[t];return this.replaceVariables(o,i)}return this.Text[e]},n.getTexture=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,r=void 0===a?this.currentLocale:a,s=this.getCorrectLocale(r),o=this.data[s].Texture[t];return this.replaceVariables(o,i)}return this.Texture[e]},n.getFontSize=function(e){try{var t=this.FontSize[e];if(t)return parseInt(t)}catch(n){}return 16},n.isSupportLanguage=function(e){return this.supportedLanguages.indexOf(e)>=0},n.applyOptions=function(e){this.options=(0,a.Z)({},e);var t=e.data,n=e.locale,i=void 0===n?"en":n,r=e.upperCaseText,s=void 0!==r&&r;this.data=t,this.supportedLanguages=Object.keys(t);var o=this.getCorrectLocale(i);if(this.currentLocale=o,this.Text=t[o].Text,this.Texture=t[o].Texture,this.FontSize=t[o].FontSize,s)for(var c in this.Text)this.Text[c]=this.Text[c].toUpperCase()},n.makeText=function(e,t){var n=t.maxWidth,i=void 0===n?Phaser.Math.MAX_SAFE_INTEGER:n,a=t.maxHeight,r=void 0===a?Phaser.Math.MAX_SAFE_INTEGER:a,s=t.align,o=void 0===s?"center":s,c=t.drawMaxBoxDebug,h=void 0!==c&&c,u=e.make.bitmapText(t);for("center"===o?u.setCenterAlign():"left"===o?u.setLeftAlign():"right"===o&&u.setRightAlign(),(t.text||"").indexOf(" ")>=0&&u.setMaxWidth(i);u.width>i||u.height>=r;)u.setFontSize(.95*u.fontSize);if(h&&GameCore.Utils.Valid.isDebugger()){var l=e.game.globalScene.add.graphics({lineStyle:{width:2,color:16711680}});l.setDepth(Phaser.Math.MAX_SAFE_INTEGER),e.game.globalScene.events.on(Phaser.Scenes.Events.UPDATE,(function(){if(l.clear(),u&&u.visible&&u.active){var e=u.getWorldPosition(),t=e.x,n=e.y;l.strokeRect(t-.5*i+(.5-u.originX)*u.width,n-.5*r+(.5-u.originY)*u.height,i,r)}}))}return u},n.setFontSize=function(e,t,n){var i=t||Phaser.Math.MAX_SAFE_INTEGER,a=n||Phaser.Math.MAX_SAFE_INTEGER;for((e.text||"").indexOf(" ")>=0&&e.setMaxWidth(i);e.width>i||e.height>=a;)e.setFontSize(.95*e.fontSize)},n.replaceVariables=function(e,t){var n=t.length;if(0==n)return e;var i=0;return e.replace(/{.*}/,(function(){return String(t[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(e){var t=e;return this.isSupportLanguage(e)||(t="en"),t},t}(Phaser.Plugins.BasePlugin),Ho={en:JSON.parse('{"Text":{"PLAY":"PLAY","play":"Play","missions":"Missions","getMoreCoins":"Get More Coins","watchGetCoinVideo":"Watch a video to get\\n300 coins","earnStar":"Beat levels to earn stars!","earnExtraCoins":"Earn Extra Coins","getMoreStars":"Get more stars","getNow":"Get Now","noThanks":"No, thanks","settings":"Settings","sound":"Sound","music":"Music","vibration":"Vibration","on":"ON","off":"OFF","endGame":"End Game","endGame2":"End game","quitLevel":"Are you sure you\\nwant to quit the level?","giveUp":"Are you sure you\\nwant to give up?","exit":"Exit","exitGame":"Exit Game?","playOn":"Play On","journey":"Journey","selectBoosters":"Select Boosters:","level":"Level","complete":"Complete!","removeThreeCards":"Removes three face up cards\\nat the start of the level.","removeAllCards":"Remove all face up cards\\non the playfield.","addThreeWildCards":"Add three Wild cards on the\\nplayfield at the start of the level.","slice":"Slice","storm":"Storm","wildDrop":"Wild Drop","replay":"REPLAY","bombDetonated":"Bomb detonated!","tipPlayBomb":"Tip: Play bomb cards faster\\nby using a wild card!","tapToSkip":"Tap to skip","tapToCollect":"Tap to collect","creditsCollected":"Credits collected","levelCleared":"Level cleared","youWon":"You Won","unlockAtLevel":"Unlock at level","claim":"Claim","dailyMissions":"Daily Missions","passLevels":"Pass 5 levels","clearCards":"Clear 60 cards","useWildCards":"Use 5 wild cards","tipPlayWildCard":"The Wild Card lets you play\\nany card on the board","free":"Free","loadingAds":"Loading ads...","loading":"Loading...","noAds":"No ads to display!","noRewards":"Sorry, No Rewards!\\nYou have cancelled the ad!","guideOne":"Tap a card one higher or\\none lower than the card at\\nthe bottom of the screen!","guideUndo":"You missed a playable card!\\nTap here to undo!","guideUndoPortrait":"You missed a playable card!\\nTap here to undo!","guideDrawStock":"No playable cards.\\nTap to deal a new card.","guideDrawStockPortrait":"No playable cards.\\nTap to deal a new card.","guideStreak":"Play multiple cards in a row\\nto fill up your streak meter\\nand win bonuses!","guideWildCard":"Let\'s you play any card\\non the board. Perfect for\\nextending a long streak!","guideWildCard2":"Tap an open card\\nto remove it!","guideLock":"Uncover the key\\nto unlock the pad lock","guideSliceBooster":"New!\\nRemove three face up cards\\nat the start of the level.\\nTry now!","guideStormBooster":"New!\\nRemove all face up cards\\non the playfield.\\nTry now!","guideWildCardBooster":"New!\\nAdd three Wild cards to the playfield\\nat the start of the level.\\nTry now!","guideSquirrel":"Feed the Squirrel\\nwith 3 Acorn cards!","guideChangerCard":"Very helpful:\\nThis card increases\\nits value by 1 each turn.","guideChainCard":"Play one of these cards\\nand the other one is played automatically","guideMysteryCard":"Uncover the surprise card\\nto find out what it holds","wellDone":"WELL DONE!","wellDone2":"Well Done!","super":"SUPER!","goodJob":"GOOD JOB!","fantastic":"FANTASTIC!","dailyBonus":"Daily Bonus","levelComplete":"Level Complete!","get":"Get","day":"Day","janeFarm":"Jane\'s Farm","cornField":"Corn Field","france":"France","greece":"Greece","england":"England","switzerland":"Switzerland","germany":"Germany","holland":"Holland","indonesia":"Indonesia","maldives":"Maldives","nepal":"Nepal","nevada":"Nevada","northAmerica":"North America","peru":"Peru","romania":"Romania","southAmerica":"South America","spain":"Spain","yemen":"Yemen"},"Texture":{"null":"null"},"FontSize":{"playButton":"30","day":"16","get":"16","free":"10","levelRibbon":"11","guide":"16","on":"12","off":"12","dailyMissions":"25","exitGameButton":"15","endGameButton":"11"}}'),ru:JSON.parse('{"Text":{"PLAY":"\u0418\u0413\u0420\u0410\u0422\u042c","play":"\u0418\u0433\u0440\u0430\u0442\u044c","missions":"\u041c\u0438\u0441\u0441\u0438\u044f","getMoreCoins":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435\\\\n\u043c\u043e\u043d\u0435\u0442","watchGetCoinVideo":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0432\u0438\u0434\u0435\u043e \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435\\n300 \u043c\u043e\u043d\u0435\u0442","earnStar":"\u041f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u0435 \u0443\u0440\u043e\u0432\u043d\u0438, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0437\u0432\u0451\u0437\u0434\u044b!","earnExtraCoins":"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u0439\u0442\u0435\\n\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u043e\u043d\u0435\u0442\u044b","getMoreStars":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0437\u0432\u0451\u0437\u0434","getNow":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\\n\u0441\u0435\u0439\u0447\u0430\u0441","noThanks":"\u041d\u0435\u0442, \u0441\u043f\u0430\u0441\u0438\u0431\u043e","settings":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","sound":"\u0417\u0432\u0443\u043a","music":"\u041c\u0443\u0437\u044b\u043a\u0430","vibration":"\u0412\u0438\u0431\u0440\u0430\u0446\u0438\u044f","on":"\u0412\u041a\u041b","off":"\u0412\u042b\u041a\u041b","endGame":"\u0412\u044b\u0439\u0442\u0438","endGame2":"\u0412\u044b\u0439\u0442\u0438","quitLevel":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435\\n\u043f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c?","giveUp":"\u0422\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\\\\n\u0445\u043e\u0447\u0435\u0448\u044c \u0441\u0434\u0430\u0442\u044c\u0441\u044f?","exit":"\u0412\u044b\u0439\u0442\u0438","exitGame":"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0438\u0433\u0440\u044b?","playOn":"\u0418\u0433\u0440\u0430\u0442\u044c\\n\u0434\u0430\u043b\u044c\u0448\u0435","journey":"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u0435","selectBoosters":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043a\u043e\u0440\u0438\u0442\u0435\u043b\u0438:","level":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c","complete":"\u041f\u0440\u043e\u0439\u0434\u0435\u043d!","removeThreeCards":"\u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u0442\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.","removeAllCards":"\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u043f\u043e\u043b\u0435.","addThreeWildCards":"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0438 \u043a\u0430\u0440\u0442\u044b \u0414\u0436\u043e\u043a\u0435\u0440\u0430\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.","slice":"\u0421\u0440\u0435\u0437\u0430\u0442\u044c","storm":"\u0428\u0442\u043e\u0440\u043c","wildDrop":"\u0414\u0436\u043e\u043a\u0435\u0440","replay":"\u041f\u041e\u0412\u0422\u041e\u0420","bombDetonated":"\u0411\u043e\u043c\u0431\u0430 \u0432\u0437\u043e\u0440\u0432\u0430\u043b\u0430\u0441\u044c!","tipPlayBomb":"\u0421\u043e\u0432\u0435\u0442: \u0420\u0430\u0437\u044b\u0433\u0440\u044b\u0432\u0430\u0439\u0442\u0435\\n\u043a\u0430\u0440\u0442\u044b-\u0431\u043e\u043c\u0431\u044b \u0431\u044b\u0441\u0442\u0440\u0435\u0435\\n\u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u0438\u043a\u0438\u0445 \u043a\u0430\u0440\u0442!","tapToSkip":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c","tapToCollect":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0431\u0440\u0430\u0442\u044c","creditsCollected":"\u041a\u0440\u0435\u0434\u0438\u0442\u043e\u0432 \u0441\u043e\u0431\u0440\u0430\u043d\u043e","levelCleared":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043f\u0440\u043e\u0439\u0434\u0435\u043d","youWon":"\u0412\u044b \u043f\u043e\u0431\u0435\u0434\u0438\u043b\u0438","unlockAtLevel":"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435","claim":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","dailyMissions":"\u0415\u0416\u0415\u0414\u041d\u0415\u0412\u041d\u042b\u0415 \u041c\u0418\u0421\u0421\u0418\u0418","passLevels":"\u041f\u0440\u043e\u0439\u0434\u0438\u0442\u0435 5 \u0443\u0440\u043e\u0432\u043d\u0435\u0439","clearCards":"\u0423\u0431\u0435\u0440\u0438\u0442\u0435 60 \u043a\u0430\u0440\u0442","useWildCards":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 5 \u0434\u0438\u043a\u0438\u0445 \u043a\u0430\u0440\u0442","tipPlayWildCard":"\u0414\u0438\u043a\u0430\u044f \u043a\u0430\u0440\u0442\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043b\u043e\u0436\u0438\u0442\u044c\\n\u043b\u044e\u0431\u0443\u044e \u043a\u0430\u0440\u0442\u0443 \u043d\u0430 \u0441\u0442\u043e\u043b","free":"\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e","loadingAds":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0435\u043a\u043b\u0430\u043c\u044b\u2026","loading":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...","noAds":"\u041d\u0435\u0442 \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430!","noRewards":"\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u043d\u0430\u0433\u0440\u0430\u0434 \u043d\u0435\u0442!\\n\u0412\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u043b\u0438 \u0440\u0435\u043a\u043b\u0430\u043c\u0443!","guideOne":"\u0412\u043d\u0438\u0437\u0443 \u044d\u043a\u0440\u0430\u043d\u0430 \u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0430 \u043a\u0430\u0440\u0442\u0430,\\n\u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0443\u044e \u0438\u043b\u0438\\n\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e \u0437\u0430 \u043d\u0435\u0439 \u043f\u043e \u0440\u0430\u043d\u0433\u0443!","guideUndo":"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u043a\u0430\u0440\u0442\u0443!\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u044e\u0434\u0430, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0445\u043e\u0434!","guideUndoPortrait":"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438\\n\u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u043a\u0430\u0440\u0442\u0443!\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u044e\u0434\u0430,\\n\u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0445\u043e\u0434!","guideDrawStock":"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043a\u0430\u0440\u0442.\\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e.","guideDrawStockPortrait":"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445\\n\u043a\u0430\u0440\u0442. \u041d\u0430\u0436\u043c\u0438\u0442\u0435,\\n\u0447\u0442\u043e\u0431\u044b \u0441\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e.","guideStreak":"\u0420\u0430\u0437\u044b\u0433\u0440\u044b\u0432\u0430\u0439\u0442\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043a\u0430\u0440\u0442\\n\u043f\u043e\u0434\u0440\u044f\u0434 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0438\u0438\\n\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0431\u043e\u043d\u0443\u0441\u043e\u0432!","guideWildCard":"\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u044b\u0433\u0440\u0430\u0442\u044c\\n\u043b\u044e\u0431\u0443\u044e \u043a\u0430\u0440\u0442\u0443 \u0441\u0442\u043e\u043b\u0435.\\n\u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442\\n\u0434\u043b\u044f \u043f\u0440\u043e\u0434\u043b\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0438\u0438!","guideWildCard2":"\u041a\u043e\u0441\u043d\u0438\u0442\u0435\u0441\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u043a\u0430\u0440\u0442,\\n\u0447\u0442\u043e\u0431\u044b \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0445!","guideLock":"\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u043a\u043b\u044e\u0447, \u0447\u0442\u043e\u0431\u044b\\n\u043e\u0442\u043f\u0435\u0440\u0435\u0442\u044c \u0437\u0430\u043c\u043e\u043a","guideSliceBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0442\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideStormBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u0440\u0442\u044b\\n\u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u043f\u043e\u043b\u0435.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideWildCardBooster":"\u041d\u043e\u0432\u0438\u043d\u043a\u0430!\\n\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0440\u0438 \u043a\u0430\u0440\u0442\u044b \u0414\u0436\u043e\u043a\u0435\u0440\u0430 \u043d\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u0435\\n\u043f\u043e\u043b\u0435 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0440\u043e\u0432\u043d\u044f.\\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u0435\u0439\u0447\u0430\u0441!","guideSquirrel":"\u041d\u0430\u043a\u043e\u0440\u043c\u0438\u0442\u0435 \u0431\u0435\u043b\u043a\u0443\\n3 \u043a\u0430\u0440\u0442\u0430\u043c\u0438 \u0441 \u0436\u0435\u043b\u0443\u0434\u044f\u043c\u0438!","guideChangerCard":"\u041f\u043e\u043b\u0435\u0437\u043d\u044b\u0439 \u0441\u043e\u0432\u0435\u0442:\\n\u0441 \u043a\u0430\u0436\u0434\u044b\u043c \u0445\u043e\u0434\u043e\u043c \u044d\u0442\u0430 \u043a\u0430\u0440\u0442\u0430\\n\u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0432\u043e\u0439 \u0440\u0430\u043d\u0433 \u043d\u0430 1.","guideChainCard":"\u0420\u0430\u0437\u044b\u0433\u0440\u0430\u0439\u0442\u0435 \u043e\u0434\u043d\u0443 \u0438\u0437 \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u0440\u0442,\\n\u0438 \u0434\u0440\u0443\u0433\u0430\u044f \u0440\u0430\u0437\u044b\u0433\u0440\u0430\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438","guideMysteryCard":"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043a\u0430\u0440\u0442\u0443-\u0441\u044e\u0440\u043f\u0440\u0438\u0437, \u0447\u0442\u043e\u0431\u044b\\n\u0443\u0437\u043d\u0430\u0442\u044c, \u0447\u0442\u043e \u043e\u043d\u0430 \u0441\u043e\u0431\u043e\u0439 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442","wellDone":"\u041c\u041e\u041b\u041e\u0414\u0415\u0426!","wellDone2":"\u041c\u043e\u043b\u043e\u0434\u0435\u0446!","super":"\u0421\u0423\u041f\u0415\u0420!","goodJob":"\u041e\u0422\u041b\u0418\u0427\u041d\u0410\u042f \u0420\u0410\u0411\u041e\u0422\u0410!","fantastic":"\u041f\u041e\u0422\u0420\u042f\u0421\u0410\u042e\u0429\u0415!","dailyBonus":"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439 \u0431\u043e\u043d\u0443\u0441","levelComplete":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u041f\u0440\u043e\u0439\u0434\u0435\u043d!","get":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","day":"\u0414\u0435\u043d\u044c","janeFarm":"\u0424\u0435\u0440\u043c\u0430 \u0414\u0436\u0435\u0439\u043d","cornField":"\u041a\u0443\u043a\u0443\u0440\u0443\u0437\u043d\u043e\u0435 \u041f\u043e\u043b\u0435","france":"\u0424\u0440\u0430\u043d\u0446\u0438\u044f","greece":"\u0413\u0440\u0435\u0446\u0438\u044f","england":"\u0410\u043d\u0433\u043b\u0438\u044f","switzerland":"\u0428\u0432\u0435\u0439\u0446\u0430\u0440\u0438\u044f","germany":"\u0413\u0435\u0440\u043c\u0430\u043d\u0438\u044f","holland":"\u0413\u043e\u043b\u043b\u0430\u043d\u0434\u0438\u044f","indonesia":"\u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u044f","maldives":"\u041c\u0430\u043b\u044c\u0434\u0438\u0432\u044b","nepal":"\u041d\u0435\u043f\u0430\u043b","nevada":"\u041d\u0435\u0432\u0430\u0434\u0430","northAmerica":"\u0421\u0435\u0432\u0435\u0440\u043d\u0430\u044f \u0410\u043c\u0435\u0440\u0438\u043a\u0430","peru":"\u041f\u0435\u0440\u0443","romania":"\u0420\u0443\u043c\u044b\u043d\u0438\u044f","southAmerica":"\u042e\u0436\u043d\u0430\u044f \u0410\u043c\u0435\u0440\u0438\u043a\u0430","spain":"\u0418\u0441\u043f\u0430\u043d\u0438\u044f","yemen":"\u0419\u0435\u043c\u0435\u043d"},"Texture":{"null":"null"},"FontSize":{"playButton":"28","day":"14","get":"11","free":"8","levelRibbon":"10","guide":"14","on":"9","off":"9","dailyMissions":"22","exitGameButton":"16","endGameButton":"12"}}')},Yo=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,(0,a.Z)({data:Ho,locale:"en",upperCaseText:!1},t))},t}(Wo),Ko=Yo,zo=GameCore.Ads.Types,Vo=[te._.SCREEN_OPEN,te._.ECONOMY_TRACKING,te._.ECONOMY_TRANSACTION],jo=(function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,a.Z)({},n),"#E35335")||this).game=void 0,i.currentPath="/",i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i}(0,s.Z)(t,e);var n=t.prototype;n.processEvent=function(e,t,n){if(!(Vo.indexOf(e)>=0)){var i=this.formatEventName(e),r=t?(0,a.Z)({},t):{};r=n?(0,a.Z)({},r,{value:n}):r,r=(0,a.Z)({},r,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,r)}},n.processLevelStart=function(e,t,n){this.processEvent(te._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(te._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(te._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(te._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processLoadPreRollAd=function(e,t){var n=this.getEdaType(zo.PRE_ROLL);this.processEvent(te._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowPreRollAd=function(e,t){var n=this.getEdaType(zo.PRE_ROLL);this.processEvent(te._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(te._.AD_IMPRESSION,{ad_format:n})},n.processLoadInterstitialAd=function(e,t){var n=this.getEdaType(zo.INTERSTITIAL);this.processEvent(te._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowInterstitialAd=function(e,t){var n=this.getEdaType(zo.INTERSTITIAL);this.processEvent(te._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(te._.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processLoadRewardedVideoAd=function(e,t){var n=this.getEdaType(zo.REWARDED);this.processEvent(te._.AD_LOAD,{ad_type:n,screen_name:""+e,ad_service:""+t})},n.processShowRewardedVideoAd=function(e,t){var n=this.getEdaType(zo.REWARDED);this.processEvent(te._.AD_SHOW,{ad_type:n,screen_name:""+e,ad_service:""+t}),this.processEvent(te._.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowBannerAd=function(e,t,n){var i=this.getEdaType(zo.BANNER);this.processEvent(te._.AD_SHOW,{ad_type:i,banner_position:""+e,screen_name:""+t,ad_service:""+n})},n.processLoadAdFail=function(e){var t=e.type,n=e.placement,i=e.adService,a=this.getEdaType(t);this.processEvent(te._.AD_LOAD_FAILED,{ad_type:a,screen_name:""+n,ad_service:""+i})},n.processShowAdFail=function(e){var t=e.type,n=e.placement,i=e.adService,a=e.bannerPosition,r={ad_type:this.getEdaType(t),screen_name:""+n,ad_service:""+i};t===zo.BANNER&&(r.banner_position=""+a),this.processEvent(te._.AD_SHOW_FAILED,r)},n.processPageView=function(e){var t="/"+this.getGameplayMode()+"/"+e;this.currentPath=t,this.processEvent(te._.PAGE_VIEW)},n.getGameplayMode=function(){var e=this.game.storage.getState();return Lt(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},n.getEdaType=function(e){switch(e){case zo.INTERSTITIAL:return"interstitial";case zo.PRE_ROLL:return"pre_roll";case zo.REWARDED:return"rewarded_video";case zo.BANNER:return"banner";default:return"unknown"}}}(GameCore.Analytics.BaseAnalytics),function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).startGame=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.auth.requestToken();case 3:return e.next=5,t.storage.syncStore();case 5:return t.configureSentry(),t.configureRollbar(),e.next=9,t.detectGameMode();case 9:t.handleYTAudioSync(),window.GameSDK.firstFrameReady(),t.initGoogleAnalytics(),t.analytics.event(te._.LOAD_START),t.scene.launch(oe.C.GLOBAL_SCENE),t.scene.start(oe.C.LOAD_SCENE),t.analytics.pageview(oe.C.LOAD_SCENE),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 21:return e.prev=21,t.facebook.progressLoading.finishLoadingProgressFbBootScene(),t.scene.sleep(oe.C.BOOT_SCENE),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[0,18,21,25]])}))),t}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var e=this.player.getPlayer();(0,Y.Tv)({id:e.playerId,username:e.name})},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n(),a=Dt(i),r=window.game.player,s=r.getPlayerId(),o=a.contextId,h=a.entryPointData,l=(u=h||{}).type,d=u.matchId,p=u.playerId,f=u.opponentId,m=void 0===f?ae.playerId:f,g=s===p,v=m===ae.playerId,y=v||[m,p].includes(s),E=It,e.prev=10,e.next=13,window.game.facebook.getTournamentAsync();case 13:E=Bt,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:o&&l===Ve&&!g&&(E=Ot),d&&o&&y&&l===je&&(E=Ot),o&&"matching_group_match"===l&&(E=Rt),t(Mt(E));case 22:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initGoogleAnalytics=function(){},n.handleYTAudioSync=function(){var e=window.game.audio;window.GameSDK.isAudioEnabled()||(e.muteAll(),e.pauseAllSounds(),e.pauseMusic())},t}(Phaser.Scene)),Xo=jo,qo=n(84),Jo=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).run=function(){t.scene.switch(oe.C.GAME_SCENE)},t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("resume",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this)},t}(qo.Z);var Qo=Jo,$o=n(80),ec=n(85),tc=n(94);function nc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ic(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ic(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ic(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ac=GameCore.Configs.LeadersBoard,rc=ac.UseMock,sc=ac.Limit,oc=ac.MockOptions,cc=function(e,t,n,i){return void 0===n&&(n=sc),void 0===i&&(i=0),function(){var a=(0,r.Z)(c().mark((function a(r){var s,o,h,u,l,d,p,f,m,g,v,y,E,C,A,w;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,s=window.game.player,o=s.getPlayerId(),r(uc()),r({type:Ts,payload:{leaderboardId:e,type:t,limit:n,offset:i}}),!rc){a.next=11;break}return a.next=8,(0,le.qZ)(1e3);case 8:return h=new Array(n).fill(null).map((function(e,t){var n=(t+1)*(i+1),a=oc.PlayerEntryIndex===t,r={playerId:"0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)};if(a){var s=window.game.player.getPlayer(),o=s.playerId,c=s.name,h=s.photo;r.playerId=o,r.name=c,r.photo=h}return r})),r(hc(h,t)),a.abrupt("return");case 11:if(u=[],t!==Ae){a.next=18;break}return a.next=15,_e({limit:n,offset:i});case 15:u=a.sent,a.next=26;break;case 18:if(t!==we){a.next=26;break}return(l=s.getConnectedPlayerIds(n,i)).push(o),d=GameCore.Utils.Array.unique(l),a.next=24,Ge({playerIds:d,limit:d.length});case 24:u=a.sent,d.forEach((function(e){var t=u.filter((function(t){return t.playerId===e}));t&&0!==t.length||u.push({playerId:e,score:0})}));case 26:for(p={},f=nc(u);!(m=f()).done;)g=m.value,v=g.playerId,y=g.score,E=g.rank,C=g.getPlayer(),A=C.getPhoto(),w=C.getName(),p[v]={playerId:v,name:w,photo:A,score:y,rank:E};r(hc(p,t)),a.next=36;break;case 32:a.prev=32,a.t0=a.catch(0),r(hc([],t)),(0,Y.tO)(a.t0);case 36:case"end":return a.stop()}}),a,null,[[0,32]])})));return function(e){return a.apply(this,arguments)}}()},hc=function(e,t){return{type:xs,payload:{leaders:e,type:t}}},uc=function(){return{type:Ps,payload:{}}},lc=function(e){return e[bs]},dc=((0,j.P1)([function(e){return lc(e).leaderboardId}],(function(e){return e})),(0,j.P1)([function(e){return lc(e).leaders}],(function(e){return e}))),pc=(0,j.P1)([function(e){return lc(e).isRequesting}],(function(e){return e})),fc=n(23),mc=n(104),gc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),vc=function(e){if("string"!==typeof e||!e)throw new gc(null,{imageShare:e})},yc=(function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,o=yc({playerId:r,playerPhoto:s})){e.next=6;break}return e.abrupt("return");case 6:return h={name:"share-best-score",width:750,height:1e3,renderOptions:o},e.next=9,i.frameCapture.capture(h);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i;return"string"!==typeof n||"string"!==typeof a?null:{avatar:{name:""+n,type:"image",x:248,y:136,image:a,width:250,height:250,fallbackWithImage:ie.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:750,height:1e3}}}),Ec=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,a.data,o=Cc({playerId:r,playerPhoto:s,playerScore:n.getLevel()})){e.next=6;break}return e.abrupt("return");case 6:return h={name:"share-best-score",width:952,height:492,renderOptions:o},e.next=9,i.frameCapture.capture(h);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Cc=(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=En(t),s=i.getPlayer(),o=s.playerId,h=s.photo,u=r[o]||{},l=u.score,d=Cc({playerId:o,playerPhoto:h,playerScore:l})){e.next=8;break}return e.abrupt("return");case 8:return p={name:"share-current-score",width:952,height:492,renderOptions:d},e.next=11,a.frameCapture.capture(p);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.playerScore,s=void 0===r?0:r;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof s)return null;var o={position:{x:160,y:320},font:"680 40px",textAlign:"center",text:"Level "+s};return{playerScoreShadow:{type:"text",x:o.position.x+2,y:o.position.y+2,font:o.font,fillStyle:"rgba(0,0,0,0)",text:o.text,textAlign:o.textAlign},playerScore:{type:"text",x:o.position.x,y:o.position.y,font:o.font,fillStyle:"#a57a62",text:o.text,textAlign:o.textAlign},avatar:{name:""+n,type:"image",x:132,y:94,image:a,width:200,height:200,fallbackWithImage:ie.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492}}}),Ac=function(){return(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,r=t.globalScene,e.prev=1,r.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),e.next=5,wc();case 5:return s=e.sent,vc(s),o=n.getPlayer(),h=o.playerId,u=o.name,l=o.photo,e.next=10,a.shareAsync({text:"A ha, I'm the best!",intent:"CHALLENGE",image:s||"",data:{playerId:h,playerName:u,playerPhoto:l,type:Ve}});case 10:i.event(te._.SHARE,{share_content_type:"Leaderboard",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(te._.SHARE,{share_content_type:"Leaderboard",success:!1}),(0,Y.tO)(e.t0);case 17:return e.prev=17,r.screen.close(ce.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))},wc=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.profile,a=t.globalScene,r=n.getPlayer(),s=r.playerId,o=r.name,h=r.photo,(u=n.getConnectedPlayerIds(99,0)).push(s),l=[],e.next=7,Ge({playerIds:GameCore.Utils.Array.unique(u),limit:u.length});case 7:d=e.sent,p=GameCore.Utils.Object.keyBy(d,"playerId"),f={playerId:s,name:o,photo:h,score:0},GameCore.Utils.Object.hasOwn(p,s)&&(f=p[s]),l.push(f),e.t0=c().keys(p);case 14:if((e.t1=e.t0()).done){e.next=27;break}if(m=e.t1.value,!GameCore.Utils.Object.hasOwn(p,m)){e.next=25;break}if(g=p[m],3!==l.length){e.next=20;break}return e.abrupt("break",27);case 20:if(g.playerId!==s){e.next=22;break}return e.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(f.score))){e.next=24;break}return e.abrupt("continue",14);case 24:l.push(g);case 25:e.next=14;break;case 27:return v=GameCore.Utils.Array.unique(u),e.next=30,i.requestProfiles(v);case 30:if(y=i.getProfiles(),l.forEach((function(e,t){var n=e.playerId;if(GameCore.Utils.Object.hasOwn(y,n)){var i=y[n],a=i.name,r=i.photo;l[t].name=a,l[t].photo=r}})),l.length<3)for(E=0;E<=3-l.length;)l.push({playerId:"bot"+E,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),E++;if(C=Sc({playerId:s,playerName:o,playerPhoto:h,listLeaders:l})){e.next=37;break}return e.abrupt("return");case 37:return A={name:"share-leaderboard",width:1500,height:2e3,renderOptions:C},e.next=40,a.frameCapture.capture(A);case 40:return e.abrupt("return",e.sent);case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Sc=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.listLeaders,s=void 0===r?[]:r;if(!Array.isArray(s))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:510,y:278,image:a,width:510,height:510,fallbackWithImage:ie.Z.AVATAR.KEY}};return s.forEach((function(e,t){var n=e.playerId,i=e.photo;o["photo_"+n]={name:""+n,type:"image",x:436,y:1294+180*t,image:i,width:96,height:96,fallbackWithImage:ie.Z.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},s.forEach((function(e,t){var n=e.playerId,i=e.name,a=e.score;o["name_"+n]={type:"text",x:600,y:1360+180*t,font:"600 48px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1e3,y:1360+180*t,font:"600 48px",text:a,fillStyle:"#b18151"}})),o},bc=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=En(t),s=i.getPlayer(),o=s.photo,h=s.playerId,u=fn(t),l=u.playerId,d=u.photo,p=gn(t,{playerId:h}),f=vn(t,{opponentId:l}),m=r[h]||{},g=m.score,v=r[l]||{},y=v.score,E=Tc({playerId:h,playerPhoto:o,playerScore:g,opponentId:l,opponentPhoto:d,opponentScore:y,isPlayerFinished:p,isOpponentFinished:f})){e.next=12;break}return e.abrupt("return");case 12:return C={name:"share-game-result",width:952,height:492,renderOptions:E},e.next=15,a.frameCapture.capture(C);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tc=(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=En(t),s=i.getPlayer(),o=s.photo,h=s.playerId,u=yn(t),l=u.playerId,d=u.photo,p=u.score,f=r[h]||{},m=f.score,g=Tc({playerId:h,playerPhoto:o,playerScore:m,opponentId:l,opponentPhoto:d,opponentScore:p})){e.next=9;break}return e.abrupt("return");case 9:return v={name:"share-group-match-result",width:952,height:492,renderOptions:g},e.next=12,a.frameCapture.capture(v);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.playerScore,s=void 0===r?0:r,o=e.opponentId,c=void 0===o?"20":o,h=e.opponentPhoto,u=void 0===h?"":h,l=e.opponentScore,d=void 0===l?0:l,p=e.isPlayerFinished,f=e.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof s)return null;if("string"!==typeof c)return null;if("string"!==typeof u)return null;if("number"!==typeof d)return null;if("boolean"!==typeof p)return null;if("boolean"!==typeof f)return null;var m=s===d,g=s>d,v=p||f,y=p&&f,E={leftPhoto:{name:""+n,type:"image",x:60,y:31,image:a,width:165,height:165,fallbackWithImage:ie.Z.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:725,y:31,image:u,width:165,height:165,fallbackWithImage:ie.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(E.leftScoreShadow={type:"text",x:282,y:403,font:"600 50px",fillStyle:"#ffffff",text:p?""+s:"???",textAlign:"left"},E.leftScore={type:"text",x:665,y:403,font:"600 50px",fillStyle:"#ffffff",text:p?""+d:"???",textAlign:"right"}),!m&&y&&(g?E.leftCrown={name:"crown-icon",type:"image",x:93,y:164,image:"./assets/images/others/crown-icon.png",width:116,height:83}:E.rightCrown={name:"crown-icon",type:"image",x:682,y:163,image:"./assets/images/others/crown-icon.png",width:116,height:83}),E}),xc=function(e){var t=e?e.split("_"):[],n=t.length>0?t[0]:"en_US";switch(n){case"id":case"in":n="id"}return n},Pc=n(76),kc=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=i.scene.textures.get(e);n&&n.key===e?i.handleLoadComplete(e):(i.scene.load.once("filecomplete-image-"+e,i.handleLoadComplete),i.scene.load.image(e,t),i.scene.load.start())}},i.handleLoadComplete=function(e){if(i.scene){var t=i.payload,n=t.id,a=t.radius,r=void 0===a?0:a;if(n&&n===e){var s=n+"_bordered_"+r,o=r>0?s:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=r&&r<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:s,radius:r}))return void i.showLoading(!1);i.setPhoto(s)}else if(100==r){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:s}))return void i.showLoading(!1);i.setPhoto(s)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(e){e.key===i.payload.id&&i.setDefaultAvatar(e.key)},i.scene.add.existing((0,fc.Z)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,r=a.id,s=a.url,o=a.radius;return r&&s&&i.loadPhoto(r,s,o),i.addDefaultListeners(),i}(0,s.Z)(t,e);var n=t.prototype;return n.setFrame=function(e){this.avtFrame.setFrame(e),this.avtFrame.setVisible(!0)},n.setBackground=function(e){this.background.setFrame(e)},n.loadPhoto=function(e,t,n){var i;if(void 0===n&&(n=0),this.payload.id=e,this.payload.url=t,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),e&&t){var a=this.scene.textures.get(e);if(a&&a.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var r=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(r,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(ie.Z.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,ie.Z.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var e=this.payload,t=e.key,n=e.background;this.background=this.scene.make.image({key:t,frame:n}),this.background.setDefaultWorldSize(),this.add(this.background)},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setWorldSize(.5*this.width,.5*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var e=this.payload,t=e.key,n=e.frame;e.width,e.height;n?(this.avtFrame=this.scene.make.image({key:t,frame:n}),this.avtFrame.setDefaultWorldSize()):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload,n=t.width,i=t.height,a=Math.min(n,i)-10;this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},n.addBackground=function(){var e="avatar-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},t}(Phaser.GameObjects.Container),Ic=kc,Oc=Wi.Z.DEFAULT,Rc=Oc.KEY,Bc=Oc.FRAME,Dc=function(e){function t(t){var n;return(n=e.call(this,t,{key:Rc,frame:Bc.AVATAR_FRAME_BLUE,background:Bc.AVATAR_BG_BLUE,width:60,height:60})||this).scene=void 0,n.scene=t,n}return(0,s.Z)(t,e),t.prototype.setHighlight=function(e){e?(this.background.setFrame(Bc.AVATAR_BG_YELLOW),this.avtFrame.setFrame(Bc.AVATAR_FRAME_YELLOW)):(this.background.setFrame(Bc.AVATAR_BG_BLUE),this.avtFrame.setFrame(Bc.AVATAR_FRAME_BLUE))},t}(Ic),Lc=Dc,_c=Wi.Z.DEFAULT,Mc=_c.KEY,Nc=_c.FRAME,Gc=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.avatar=void 0,i.block=void 0,i.rankIcon=void 0,i.rankText=void 0,i.playerScore=void 0,i.label=void 0,i.scene=t,i.createBlock(),i.createAvatar(),i.createRankIcon(),i.createRankText(),i.createLabel(),i.createPlayerScore(),n&&i.updateInfo(n),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=e,this.updateAvatar(),this.updateRankIcon(),this.updateRankText(),this.updatePlayerScore()},n.setLabel=function(e){this.label.setText(e)},n.setRank=function(e){this.rankText.setText(e)},n.setScore=function(e){this.playerScore.setText(e)},n.setHighlight=function(e){e?(this.y-=6,this.scale+=.1,this.label.scale+=.15,this.block.setFrame(Nc.BLOCK_LEADER_YELLOW)):(this.y+=6,this.scale-=.1,this.label.scale-=.15,this.block.setFrame(Nc.BLOCK_LEADER_BLUE)),this.avatar.setHighlight(e)},n.createBlock=function(){this.block=this.scene.make.image({key:Mc,frame:Nc.BLOCK_LEADER_BLUE}),this.block.setWorldSize(79,99),this.add(this.block)},n.createAvatar=function(){this.avatar=new Lc(this.scene),Phaser.Display.Align.In.TopCenter(this.avatar,this.block,0,this.avatar.displayHeight/2-4),this.add(this.avatar)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n,50)},n.getRankFrame=function(){var e=Nc.ICON_FLAG;switch(this.payload.rank){case 1:e=Nc.ICON_CUP_GOLD;break;case 2:e=Nc.ICON_CUP_SILVER;break;case 3:e=Nc.ICON_CUP_COPPER}return e},n.createRankIcon=function(){var e=Nc.ICON_FLAG;this.rankIcon=this.scene.make.image({key:Mc,frame:e}),e!=Nc.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),Phaser.Display.Align.In.Center(this.rankIcon,this.block,0,-15),this.add(this.rankIcon)},n.updateRankIcon=function(){var e=this.getRankFrame();this.rankIcon.setFrame(e),e!=Nc.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),Phaser.Display.Align.In.Center(this.rankIcon,this.block,0,-15)},n.createRankText=function(){this.rankText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"1"}),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,-2),this.add(this.rankText)},n.updateRankText=function(){this.rankText.setText(this.payload.rank.toString())},n.createLabel=function(){this.label=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(14),origin:{x:.5,y:0},text:"Play"}),Phaser.Display.Align.In.BottomCenter(this.label,this.block,0,-10),this.add(this.label)},n.createPlayerScore=function(){this.playerScore=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"132500"}),this.playerScore.setTint(5582186),Phaser.Display.Align.In.Center(this.playerScore,this.block,0,5),this.add(this.playerScore)},n.updatePlayerScore=function(){this.playerScore.setText(Math.floor(this.payload.score).toString())},(0,H.Z)(t,[{key:"onClick",set:function(e){var t=this.block,n=t.width,i=t.height;this.setSize(n,i+this.avatar.height),this.setInteractive({useHandCursor:!0}),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),Zc=Gc,Fc=n(77),Uc=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.payload=void 0,i.leaderBlocks=void 0,i.entrancesAnimation=void 0,i.listLeaderBlocks=void 0,i.handleChallengeFriend=function(e){return function(){i.scene.storage.dispatch(vi(e))}},i.handleShareLeaderboard=function(){i.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.BUTTON_CLICK),i.scene.storage.dispatch(Ac())},i.handleMatchingGroup=(0,r.Z)(c().mark((function e(){var t,n,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.scene,n=t.player,a=t.storage,r=t.game,s=t.facebook,e.prev=1,r.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:i.scene.lang.Text.loading,loading:!0}),o=n.getPlayer(),h="global","en"===(u=xc(o.locale))&&(h="en"),"in"===u&&(h="in"),e.next=10,s.matchPlayerAsync(h,!0,!0);case 10:if(l=e.sent,r.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),l){e.next=14;break}return e.abrupt("return");case 14:a.dispatch(Ei()),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(1),r.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),e.t0 instanceof Error&&(0,Y.tO)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,17]])}))),i.scene=t,i.setName("LeadersBar"),i.listLeaderBlocks=[],i.createLeaderBlocks(),i.createEntrancesAnimation(),n&&i.updateInfo(n),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){var t=this;this.payload=e;var n=!1,i=this.payload,a=i.playerId;i.leaders.forEach((function(e){var i=t.leaderBlocks.getFirstDead(!0);i.updateInfo(e),-1===e.score?(i.setRank(""),i.setLabel("Join"),i.setScore("Global"),i.onClick=t.handleMatchingGroup):e.playerId===a?(i.setLabel("Share"),i.setHighlight(!0),i.onClick=t.handleShareLeaderboard):i.onClick=t.handleChallengeFriend(e.playerId),t.add(i),i.setVisible(!0),i.setActive(!0),t.listLeaderBlocks.indexOf(i)<0&&(n=!0)})),this.alignBlocks(),n&&(this.listLeaderBlocks=this.leaderBlocks.getChildren().filter((function(e){return e.active})),this.createEntrancesAnimation()),this.runAnimation()},n.killAndHideAll=function(){var e=this;this.removeAll(!1),this.leaderBlocks.getChildren().forEach((function(t){return e.leaderBlocks.killAndHide(t)}))},n.runAnimation=function(){this.leaderBlocks.setAlpha(0),this.entrancesAnimation.play()},n.createEntrancesAnimation=function(){this.entrancesAnimation=new mc.Z({targets:this.listLeaderBlocks,delay:this.scene.tweens.stagger(50,{start:400}),props:{y:{from:100,to:0},alpha:{from:0,to:1}}})},n.alignBlocks=function(){var e=-(this.leaderBlocks.getLength()-1)/2*95;this.leaderBlocks.setX(e,95)},n.createLeaderBlocks=function(){this.leaderBlocks=this.scene.add.group({classType:Zc})},t}(Phaser.GameObjects.Container),Wc=Uc,Hc=n(92),Yc=Wi.Z.DEFAULT,Kc=Yc.KEY,zc=Yc.FRAME,Vc=function(e){function t(t){var n;return(n=e.call(this,t,Kc,zc.BUTTON_YELLOW_CIRCLE,100.05,78.2)||this).scene=void 0,n.setName("Home"),n.scene=t,n.createIcon(),n}return(0,s.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Kc,frame:zc.ICON_FLAT_HOME});e.setSize(43,43).setDisplaySize(43,43),Phaser.Display.Align.In.Center(e,this.button),this.add(e)},t}(Hc.Z),jc=Vc,Xc=Wi.Z.DEFAULT,qc=Xc.KEY,Jc=Xc.FRAME,Qc=function(e){function t(t){var n;return(n=e.call(this,t,qc,Jc.BUTTON_GREEN_SHORT,176,77.05)||this).scene=void 0,n.setName("PlayWithFriends"),n.scene=t,n.createLabel(),n}return(0,s.Z)(t,e),t.prototype.createLabel=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),text:"PLAY"});Phaser.Display.Align.In.Center(e,this.button,0,-12);var t=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"WITH FRIENDS"});Phaser.Display.Align.In.Center(t,this.button,0,11),this.add([e,t])},t}(Hc.Z),$c=Qc,eh=Wi.Z.DEFAULT,th=eh.KEY,nh=eh.FRAME,ih=function(e){function t(t){var n;return(n=e.call(this,t,th,nh.BUTTON_YELLOW_CIRCLE,100.05,78.2)||this).scene=void 0,n.setName("Rank"),n.scene=t,n.createIcon(),n}return(0,s.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:th,frame:nh.ICON_FLAT_RANK});e.setSize(43,43).setDisplaySize(43,43),Phaser.Display.Align.In.Center(e,this.button),this.add(e)},t}(Hc.Z),ah=ih,rh=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.homeButton=void 0,n.rankButton=void 0,n.pwfButton=void 0,n.entrancesAnimation=void 0,n.runAnimation=function(){n.entrancesAnimation.play()},n.scene=t,n.setName("FooterBar"),n.createHomeButton(),n.createRankButton(),n.createPlayWithFriendsButton(),n.createEntrancesAnimation(),n.alignIcons(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEntrancesAnimation=function(){this.entrancesAnimation=new mc.Z({targets:[this],delay:800,props:{y:"-=5",alpha:{start:0,from:0,to:1}}})},n.alignIcons=function(){Phaser.Display.Align.In.Center(this.homeButton,this,-130,-6),Phaser.Display.Align.In.Center(this.pwfButton,this,0,-6),Phaser.Display.Align.In.Center(this.rankButton,this,130,-6)},n.createHomeButton=function(){this.homeButton=new jc(this.scene),this.add(this.homeButton)},n.createRankButton=function(){this.rankButton=new ah(this.scene),this.add(this.rankButton)},n.createPlayWithFriendsButton=function(){this.pwfButton=new $c(this.scene),this.add(this.pwfButton)},t}(Phaser.GameObjects.Container),sh=rh,oh=n(99),ch=n(81),hh={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},uh=function(e){function t(t){return e.call(this,hh,t)||this}return(0,s.Z)(t,e),t}(ch.Z),lh=Wi.Z.DEFAULT,dh=lh.KEY,ph=lh.FRAME,fh=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,t,n,i)||this).barTopLeft=void 0,s.barTopMid=void 0,s.barTopRight=void 0,s.barMidLeft=void 0,s.barMidBg=void 0,s.barMidRight=void 0,s.barBottomLeft=void 0,s.barBottomMid=void 0,s.barBottomRight=void 0,s.setSize(a,r),s.setDepth(Fr.Z.POPUP),s.createPopup(),s.scene.add.existing((0,fc.Z)(s)),s}(0,s.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.barTopLeft=this.scene.add.image(0,0,dh,ph.POPUP_TOP_LEFT),this.barTopMid=this.scene.add.image(0,0,dh,ph.POPUP_TOP_MID),this.barTopRight=this.scene.add.image(0,0,dh,ph.POPUP_TOP_RIGHT),this.barMidLeft=this.scene.add.image(0,0,dh,ph.POPUP_MID_LEFT),this.barMidBg=this.scene.add.image(0,0,dh,ph.POPUP_MID_MID),this.barMidRight=this.scene.add.image(0,0,dh,ph.POPUP_MID_RIGHT),this.barBottomLeft=this.scene.add.image(0,0,dh,ph.POPUP_BOTTOM_LEFT),this.barBottomMid=this.scene.add.image(0,0,dh,ph.POPUP_BOTTOM_MID),this.barBottomRight=this.scene.add.image(0,0,dh,ph.POPUP_BOTTOM_RIGHT),this.barTopLeft.setWorldSize(65,48),this.barTopMid.setWorldSize(65,48),this.barTopRight.setWorldSize(65,48),this.barMidLeft.setWorldSize(65,48),this.barMidBg.setWorldSize(65,48),this.barMidRight.setWorldSize(65,48),this.barBottomLeft.setWorldSize(65,48),this.barBottomMid.setWorldSize(65,48),this.barBottomRight.setWorldSize(65,48),this.add([this.barTopRight,this.barTopMid,this.barBottomLeft,this.barBottomRight,this.barMidLeft,this.barMidRight,this.barTopLeft,this.barBottomMid,this.barMidBg])},n.updatePopupSize=function(){this.barTopMid.setWorldSize(this.width-129,this.barTopMid.height),this.barMidLeft.setWorldSize(this.barMidLeft.width,this.height-95),this.barMidBg.setWorldSize(this.width-129,this.height-95),this.barMidRight.setWorldSize(this.barMidRight.width,this.height-95),this.barBottomMid.setWorldSize(this.width-129,this.barBottomMid.height)},n.alignPopupImages=function(){Phaser.Display.Align.In.TopLeft(this.barTopLeft,this),Phaser.Display.Align.In.TopCenter(this.barTopMid,this),Phaser.Display.Align.In.TopRight(this.barTopRight,this),Phaser.Display.Align.In.LeftCenter(this.barMidLeft,this),Phaser.Display.Align.In.Center(this.barMidBg,this),Phaser.Display.Align.In.RightCenter(this.barMidRight,this),Phaser.Display.Align.In.BottomLeft(this.barBottomLeft,this),Phaser.Display.Align.In.BottomCenter(this.barBottomMid,this),Phaser.Display.Align.In.BottomRight(this.barBottomRight,this)},(0,H.Z)(t,[{key:"onClose",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container),mh=fh,gh=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.mainText=void 0,i.shadowText=void 0,i.payload=n,i.createMainText(),i.createShadowText(),i.updateSize(),i.moveDown(i.shadowText),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.mainText.setText(e),this.shadowText.setText(e),this.updateSize()},n.setTintText=function(e,t,n,i){this.mainText.setTint(e,t,n,i)},n.setDropShadow=function(e,t,n,i){void 0===i&&(i=1),this.shadowText.setVisible(!0),this.shadowText.setTint(n),this.shadowText.setAlpha(i),Phaser.Display.Align.In.Center(this.shadowText,this.mainText,e,t)},n.updateSize=function(){var e=this.mainText,t=e.width,n=e.height;this.setSize(t,n)},n.createMainText=function(){this.mainText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:{x:.5,y:.5}}),this.add(this.mainText)},n.createShadowText=function(){this.shadowText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:{x:.5,y:.5},visible:!1}),this.add(this.shadowText)},t}(Phaser.GameObjects.Container),vh=gh,yh=n(103),Eh=Wi.Z.DEFAULT,Ch=Eh.KEY,Ah=Eh.FRAME,wh=function(e){function t(t){var n;return(n=e.call(this,t)||this).cat=void 0,n.effect=void 0,n.runStarTwinkle=function(){var e=n.cat,t=e.x,i=e.y,a=e.displayWidth,r=e.displayHeight,s=i-20;n.effect.run(1,t,s,a,r)},n.createEffect(),n.createCat(),n.runCatAnimation(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createCat=function(){this.cat=this.scene.make.image({key:Ch,frame:Ah.THE_CAT,origin:{x:.5,y:1}}),this.cat.setWorldSize(204.5,112.5),this.cat.setY(this.cat.height/2),this.add(this.cat)},n.createEffect=function(){this.effect=new yh.Z(this.scene),this.add(this.effect)},n.runCatAnimation=function(){new oh.Z({targets:[this.cat],duration:1e3,props:{scale:"+=0.02"}}).play()},t}(Phaser.GameObjects.Container),Sh=wh,bh=Wi.Z.DEFAULT,Th=bh.KEY,xh=bh.FRAME,Ph=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScore=void 0,n.payload=void 0,n.theCat=void 0,n.popup=void 0,n.ribbon=void 0,n.yourScoreText=void 0,n.bestScoreText=void 0,n.currentScoreText=void 0,n.entrancesAnimation=void 0,n.scoreAnimation=void 0,n.counterAnimation=void 0,n.scene=t,n.bestScore=0,n.createPopup(),n.createTheCat(),n.createRibbon(),n.createYourScoreText(),n.createCurrentScore(),n.createBestScore(),n.createScoreAnimation(),n.createEntrancesAnimation(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){this.payload=e;var t=e.bestScore,n=e.currentScore;if(n<=t)return this.setBestScore(t),this.setCurrentScore(n),void this.runScoreAnimation();this.runAnimation()},n.runAnimation=function(){var e=this;this.runScoreCounter(),this.scene.time.delayedCall(1300,(function(){e.entrancesAnimation.play(),e.scene.audio.playSound(ec.Z.SCORE_COUNTER)}))},n.runScoreCounter=function(){var e,t=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(e=this.counterAnimation)||e.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:500,duration:2e3,completeDelay:300,onUpdate:function(e){var n=Math.floor(e.getValue());t.runScoreAnimation(),t.setCurrentScore(n)},onComplete:function(){t.bestScore=i,t.setBestScore(i),t.setCurrentScore(a),t.counterAnimation.remove()}})},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.setBestScore=function(e){this.bestScoreText.setText("Best score: "+e)},n.setCurrentScore=function(e){this.currentScoreText.setText(""+e)},n.createPopup=function(){this.popup=new mh(this.scene,0,0,284,240),this.add(this.popup)},n.createTheCat=function(){this.theCat=new Sh(this.scene),Phaser.Display.Align.In.TopCenter(this.theCat,this.popup),this.add(this.theCat)},n.createRibbon=function(){this.ribbon=this.scene.make.image({key:Th,frame:xh.RIBBON_LONG}),this.ribbon.setSize(341,80).setDisplaySize(341,80),Phaser.Display.Align.In.Center(this.ribbon,this.theCat,0,93),this.add(this.ribbon)},n.createYourScoreText=function(){this.yourScoreText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5},text:"Your score"}),Phaser.Display.Align.In.Center(this.yourScoreText,this.ribbon,0,-10),this.add(this.yourScoreText)},n.createCurrentScore=function(){this.currentScoreText=new vh(this.scene,{font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(60)}),this.currentScoreText.setTintText(15779090,15779090,15704623,15704623),this.currentScoreText.setDropShadow(0,2,8804140),Phaser.Display.Align.In.Center(this.currentScoreText,this.popup,0,30),this.add(this.currentScoreText)},n.createBestScore=function(){this.bestScoreText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"Best score: "+this.bestScore}),this.bestScoreText.setTint(10494183),Phaser.Display.Align.In.BottomCenter(this.bestScoreText,this.popup,0,-25),this.add(this.bestScoreText)},n.createEntrancesAnimation=function(){this.entrancesAnimation=new oh.Z({targets:[this],repeat:0,duration:200,props:{scale:"+=0.03"}})},n.createScoreAnimation=function(){this.scoreAnimation=new uh({targets:[this.currentScoreText],props:{scale:{from:1,to:1.3}}})},t}(Phaser.GameObjects.Container),kh=Ph,Ih=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScoreBlock=void 0,n.scene=t,n.createBestScoreBlock(),n.scene.add.existing((0,fc.Z)(n)),n}return(0,s.Z)(t,e),t.prototype.createBestScoreBlock=function(){this.bestScoreBlock=new kh(this.scene),this.add(this.bestScoreBlock)},t}(Phaser.GameObjects.Container),Oh=Ih,Rh=n(86),Bh=n(82),Dh={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},Lh=function(e){function t(t){return e.call(this,Dh,t)||this}return(0,s.Z)(t,e),t}(ch.Z),_h=n(105),Mh=n(106),Nh=Wi.Z.DEFAULT,Gh=Nh.KEY,Zh=Nh.FRAME,Fh=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).avatar=void 0,s.scoreText=void 0,s.shareButton=void 0,s.bigStarExplosive=void 0,s.open=function(t){e.prototype.open.call((0,fc.Z)(s),t);var n=s.getData("bestScore");s.setBestScore(n);var i=s.scene.player.getPlayer();s.avatar.loadPhoto(i.playerId,i.photo),s.runOpenAnimation(),s.scene.audio.playSound(ec.Z.CONGRATULATION)},s.handleClose=function(){s.scene.screen.close(s.name)},s.handleShareBestScore=function(){s.scene.storage.dispatch((0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,r=t.globalScene,e.prev=1,r.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),e.next=5,Ec();case 5:return s=e.sent,vc(s),o=n.getPlayer(),h=o.playerId,u=o.name,l=o.photo,e.next=10,a.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:s||"",data:{playerId:h,playerName:u,playerPhoto:l,type:Ve}});case 10:i.event(te._.SHARE,{share_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(te._.SHARE,{share_content_type:"BestScore",success:!1}),(0,Y.tO)(e.t0);case 17:return e.prev=17,r.screen.close(ce.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])}))))},s.runBigStarExplosive=function(){Phaser.Display.Align.In.Center(s.bigStarExplosive,s.scoreText),s.bigStarExplosive.run()},s.setDepth(ce.Ks.POPUP),s.background.setAlpha(.8),s.createObjects(),s}(0,s.Z)(t,e);var n=t.prototype;return n.createObjects=function(){this.createTitle(),this.createClose(),this.createBestScoreTitle(),this.createPlayerAvatar(),this.createGlowEffect(),this.createBestScoreNumber(),this.createShareButton(),this.createStarTwinkleEffect(),this.createBigStarExplosive()},n.setBestScore=function(e){this.scoreText.setText(""+e)},n.createTitle=function(){var e=this.scene.make.image({key:Gh,frame:Zh.RIBBON_SMALL});e.setSize(162,36).setDisplaySize(162,36);var t=-90;Phaser.Display.Align.In.TopCenter(e,this.zone,0,t);var n=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:10,text:"Today Record"});t=-5,Phaser.Display.Align.In.Center(n,e,0,t),this.add([e,n])},n.createClose=function(){var e=new Hc.Z(this.scene,Gh,Zh.BUTTON_CLOSE,38,38);e.setName("Close"),this.add(e),Phaser.Display.Align.In.TopRight(e,this.zone,-60,-50),e.onClick=this.handleClose},n.createBestScoreTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:22,text:"Best Score"});this.add(e),e.setTint(13256697),Phaser.Display.Align.In.TopCenter(e,this.zone,0,-130)},n.createBestScoreNumber=function(){this.scoreText=new vh(this.scene,{font:Pc.ZP.PRIMARY.KEY,size:40}),this.add(this.scoreText),this.scoreText.setTintText(15911443,15911443,15902254,15902254),this.scoreText.setDropShadow(0,2,12871743),Phaser.Display.Align.In.TopCenter(this.scoreText,this.zone,0,-230)},n.createPlayerAvatar=function(){this.avatar=new Ic(this.scene,{key:Gh,frame:Zh.AVATAR_FRAME_YELLOW_BIG,background:Zh.AVATAR_BG_YELLOW_BIG,width:89,height:89}),this.avatar.background.setSize(89,95).setDisplaySize(89,95),this.avatar.photo.setSize(89,95).setDisplaySize(89,95),this.avatar.avtFrame.setSize(89,95).setDisplaySize(89,95),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this.zone,0,20)},n.createGlowEffect=function(){var e=Wi.Z.EFFECTS,t=e.KEY,n=e.FRAME,i=this.scene.make.image({key:t,frame:n.FX_GLOW_LIGHT});i.setWorldSize(246,246),this.add(i),this.moveDown(i),Phaser.Display.Align.In.Center(i,this.avatar),this.scene.tweens.add({targets:[i],duration:6e3,repeat:-1,props:{angle:360,scale:{value:"+=0.01",yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}})},n.createShareButton=function(){this.shareButton=new _h.Z(this.scene,{key:Gh,button:Zh.BUTTON_BLUE,icon:Zh.ICON_FLAT_SHARE,text:"Share"},168,82.8),this.shareButton.setName("Share"),this.add(this.shareButton),Phaser.Display.Align.In.BottomCenter(this.shareButton,this.zone,0,-80),this.shareButton.onClick=this.handleShareBestScore},n.createStarTwinkleEffect=function(){var e=new yh.Z(this.scene),t=this.scoreText,n=t.x,i=t.y;e.run(2,n,i,300,120)},n.createBigStarExplosive=function(){this.bigStarExplosive=new Mh.Z(this.scene)},n.runOpenAnimation=function(){this.runBigStarExplosive(),this.runScoreEntrancesAnimation(),this.runAvatarEntrancesAnimation(),this.runShareEntrancesAnimation()},n.runScoreEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.scoreText),new Lh({targets:[this.scoreText],duration:300,props:{y:{from:0,to:this.scoreText.y}}}).play()},n.runAvatarEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.avatar);var e=this.avatar.scale;new Rh.Z({targets:[this.avatar],duration:400,props:{scale:{from:0,to:e}}}).play()},n.runShareEntrancesAnimation=function(){this.scene.tweens.killTweensOf(this.shareButton),this.shareButton.setAlpha(0),new Bh.Z({targets:[this.shareButton],delay:300}).play()},t}(GameCore.Screen),Uh=Fh,Wh=GameCore.Configs.LeadersBoard,Hh=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).bestScore=void 0,t.currentScore=void 0,t.loading=void 0,t.leadersBar=void 0,t.footerBar=void 0,t.main=void 0,t.confettiLeftEffect=void 0,t.confettiRightEffect=void 0,t.run=function(){t.updateLeaders(),t.updateScore(),t.explodeConfettiEffect(),t.main.bestScoreBlock.counterAnimation&&t.main.bestScoreBlock.counterAnimation.state!==Phaser.Tweens.REMOVED?t.main.bestScoreBlock.counterAnimation.on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.handleShowBestScorePopup(),t.handleShowResultChallengePopup()})):t.time.delayedCall(800,(function(){t.handleShowBestScorePopup(),t.handleShowResultChallengePopup()})),t.footerBar.setAlpha(0),t.footerBar.runAnimation(),t.audio.pauseAllMusics(),t.audio.playSound(ec.Z.GAME_OVER_SCENE)},t.runConfettiEffect=function(){var e=t.gameZone.displayWidth;t.confettiLeftEffect.stop(),t.confettiRightEffect.stop(),t.children.bringToTop(t.confettiLeftEffect),t.children.bringToTop(t.confettiRightEffect),t.confettiLeftEffect.run(1,0,-100),t.confettiRightEffect.run(1,0+e,-100),t.tweens.addCounter({delay:1e4,from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var n,i,a=e.getValue()/100;null==(n=t.confettiLeftEffect.emitter)||n.setAlpha(a),null==(i=t.confettiRightEffect.emitter)||i.setAlpha(a)},onComplete:function(){var e,n;null==(e=t.confettiLeftEffect.emitter)||e.setAlpha(1),null==(n=t.confettiRightEffect.emitter)||n.setAlpha(1),t.confettiLeftEffect.stop(),t.confettiRightEffect.stop()}})},t.explodeConfettiEffect=function(){var e=t.gameZone.displayWidth,n=-100,i=e;t.tweens.addCounter({repeat:3,duration:500,onStart:function(){t.confettiLeftEffect.explode(6,0,n),t.confettiRightEffect.explode(6,0+i,n)},onRepeat:function(){t.confettiLeftEffect.explode(6,0,n),t.confettiRightEffect.explode(6,0+i,n)},completeDelay:7e3,onComplete:function(){t.tweens.addCounter({from:100,to:0,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onUpdate:function(e){var n,i,a=e.getValue()/100;null==(n=t.confettiLeftEffect.emitter)||n.setAlpha(a),null==(i=t.confettiRightEffect.emitter)||i.setAlpha(a)},onComplete:function(){var e,n;null==(e=t.confettiLeftEffect.emitter)||e.setAlpha(1),null==(n=t.confettiRightEffect.emitter)||n.setAlpha(1),t.confettiLeftEffect.stop(),t.confettiRightEffect.stop()}})}})},t.handlePlayWithFriend=function(){t.storage.dispatch(yi())},t.handleHomeClick=function(){t.scene.switch(oe.C.DASHBOARD_SCENE)},t.handleLeaderboardClick=function(){t.scene.switch(oe.C.LEADERBOARD_SCENE)},t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.events.on("resume",(function(){e.updateScore()})),this.events.on("sleep",(function(){e.storage.dispatch(Xn())})),this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.createBackground(ie.Z.BACKGROUND.KEY);this.bestScore=0,this.currentScore=0,this.createLoading(),this.createMain(),this.createLeadersBar(),this.createFooterBar(),this.createBestScoreScreen(),this.createConfettiSmallAnimation()},n.updateLeaders=function(){var e=this;this.leadersBar.killAndHideAll();var t=[{selector:pc,callback:function(t){if(!1===t){var n=window.game.player.getPlayerId(),i=e.getLeadersExcludeIds([n]);e.updateLeaderBar(i)}e.loading.setVisible(t)}}];this.handleStateChange(t),this.storage.dispatch(cc(Wh.LeaderboardId,we,20))},n.getLeadersExcludeIds=function(e){var t=this.storage.getState(),n=dc(t),i={};if(!e||0===e.length)return n;for(var a in n)if(e.indexOf(a)<0){var r=n[a],s=r.playerId,o=r.photo,c=r.score,h=r.rank;i[a]={playerId:s,photo:o,score:c,rank:h}}return i},n.updateScore=function(){var e=this.storage.getState(),t=Cn(e),n=t.score,i=void 0===n?0:n,a=t.bestScore,r=void 0===a?0:a;this.bestScore=r<this.bestScore?this.bestScore:r,this.currentScore=i,this.main.bestScoreBlock.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.createLoading=function(){this.loading=new $o.Z(this),Phaser.Display.Align.In.Center(this.loading,this.gameZone,0,120)},n.createMain=function(){this.bestScore=0,this.main=new Oh(this),Phaser.Display.Align.In.TopCenter(this.main,this.gameZone,0,-230),this.main.bestScoreBlock.theCat.runStarTwinkle()},n.createLeadersBar=function(){this.leadersBar=new Wc(this),Phaser.Display.Align.In.Center(this.leadersBar,this.gameZone,0,120)},n.updateLeaderBar=function(e){var t={playerId:this.player.getPlayerId(),leaders:[]};for(var n in e){if(t.leaders.length>=3)break;var i=e[n],a=i.playerId,r=i.photo,s=i.score,o=i.rank;t.leaders.push({playerId:a,photo:r,score:s,rank:o})}t.leaders.push({playerId:ie.Z.ICON_EARTH.KEY,photo:ie.Z.ICON_EARTH.FILE,rank:4,score:-1}),this.leadersBar.updateInfo(t)},n.createFooterBar=function(){this.footerBar=new sh(this),Phaser.Display.Align.In.BottomCenter(this.footerBar,this.gameZone,0,-70),this.footerBar.homeButton.onClick=this.handleHomeClick,this.footerBar.pwfButton.onClick=this.handlePlayWithFriend,this.footerBar.rankButton.onClick=this.handleLeaderboardClick},n.createBestScoreScreen=function(){this.screen.add(ce.o4.BEST_SCORE_SCREEN,Uh)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new tc.Z(this,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new tc.Z(this,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Fr.Z.EFFECT),this.confettiRightEffect.setDepth(Fr.Z.EFFECT)},n.handleShowBestScorePopup=function(){this.currentScore>this.bestScore&&this.storage.dispatch(ri({bestScore:this.currentScore}));var e=this.storage.getState(),t=Je(e),n=[It,Bt].indexOf(t)>=0;this.currentScore>this.bestScore&&n&&(this.screen.open(ce.o4.BEST_SCORE_SCREEN,{bestScore:this.currentScore}),this.runConfettiEffect())},n.handleShowResultChallengePopup=function(){var e=this.storage.getState(),t=Je(e);if(-1!==[Ot,Rt].indexOf(t)&&dn(e)){var n=fn(e).playerId;t===Rt&&n===ae.playerId||(this.scene.pause(oe.C.GAME_OVER_SCENE),this.scene.launch(oe.C.RESULT_MATCH_SCENE))}},t}(qo.Z);var Yh=Hh,Kh={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},USE_WILDCARDS:{ID:"use-wild-cards",EVENTS:{USE_WILDCARD:"USE_WILDCARD"}},CLEAR_CARDS:{ID:"clear-cards",EVENTS:{RESET:"RESET",CLEAR_CARDS:"CLEAR_CARDS"}},CHALLENGE_FRIENDS:{ID:"challenge-friends",EVENTS:{CHALLENGE_FRIENDS:"CHALLENGE_FRIENDS"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},zh=function(e){return e.VALUE="value",e.CHEESE="cheese",e.MOUSE="mouse",e.WILD="wild",e.PLUS="plus",e.SQUIRREL="squirrel",e.MYSTERIOUS="mysterious",e.UNKNOWN="value",e.CHAIN="chain",e.TREASURE="treasure",e}({}),Vh=function(e){return e.NORMAL="normal",e.HARD="hard",e.SUPER_HARD="superHard",e}({}),jh=n(39),Xh=new(n.n(jh)()),qh=function(e){return e.NONE="none",e.INITIALIZED="initialized",e.DEALING="dealing",e.APPLYING_BOOSTERS="applying-boosters",e.IDLE="idle",e.DRAWING_STOCK="drawing-stock",e.DRAWING_PILE="drawing-pile",e.DRAWING_WILD_CARD="drawing-wild-card",e.DRAWING_FIRST_CARD="drawing-first-card",e.CHECKING_END_GAME="checking-end-game",e.NO_STOCK_CARDS="no-stock-cards",e.EXPLODING="exploding",e.GAME_WON="game-won",e.GAME_LOST="game-lost",e.UNDOING="undoing",e.PAUSING="pausing",e.PROCESSING_PURCHASE="processing-purchase",e}({}),Jh=function(e){return e.START="start",e.DEAL="deal",e.APPLY_BOOSTERS="apply-boosters",e.DRAW_FIRST_CARD="draw-first-card",e.DRAW_STOCK="draw-stock",e.DRAW_PILE="draw-pile",e.DRAW_WILD_CARD="draw-wild-card",e.SHOW_HINT="show-hint",e.PILE_EMPTY="pile-empty",e.CHECK_END_GAME="check-end-game",e.BOMB_COUNTER_REACHED_ZERO="bomb-counter-reached-zero",e.NO_STOCK_CARDS="no-stock-cards",e.NO_VALID_MOVES="out-of-moves",e.REFILL_STOCK="refill-stock",e.LOSE="lose",e.UNDO="undo",e.OPEN_SETTINGS="open-settings",e.CLOSE_SETTINGS="close-settings",e.PURCHASE_UNDO="purchase-undo",e.PURCHASE_REFILL_STOCK="purchase-refill-stock",e.PURCHASE_REFILL_STOCK_WITH_ADS="purchase-refill-stock-with-ads",e.PURCHASE_WILD_CARD="purchase-wild-card",e.RESET="reset",e.EXIT="exit",e}({}),Qh=function(e){return e.UNKNOWN="value",e.VALUE="value",e.KEY="key",e.LOCK="lock",e.ZAP="zap",e.BOOM="boom",e.JOKER="joker",e.CHESTNUT="chestnut",e.SQUIRREL="squirrel",e.PLUS_FIVE="wildcard-plus-5",e.PLUS_FOUR="wildcard-plus-4",e.PLUS_THREE="wildcard-plus-3",e.PLUS_TWO="wildcard-plus-2",e.PLUS_ONE="wildcard-plus-1",e.CHANGER="changer",e.CHAIN="chain",e.WINDMILL="windmill",e.MYSTERIOUS="mysterious",e.TREASURE="treasure",e.MAP_PIECE="map-piece",e}({}),$h=function(e){return e.BOMB="bomb",e.CHESTNUT="chestnut",e.INCREASE="increase",e.DECREASE="decrease",e.NONE="",e.CHAIN="chain",e.MAP_PIECE="map-piece",e}({}),eu=function(e){return e.None="None",e.Stock="stock",e.Waste="waste",e.Pile="pile",e.Combo="combo",e.Joker="joker",e.Foundation="foundation",e}(eu||{}),tu=eu,nu={DEPTH:{REMAINING_STOCK:12,HINT:11,CARD:1,WASTE_CARD:60,CARD_SLOT:9,MOVING_CARD:500},CARD_VIEW:{WIDTH:54,HEIGHT:77},CARD_BOUNDS:{WIDTH:50,HEIGHT:74},CARD_VIEW_OFFSET:{x:0,y:1},FOUNDATION_Y:70,VERTICAL_PILE_SPACE:24,MAX_HORIZONTAL_PILE_SPACE:62,SPACE_BETWEEN_PILE_AND_FOUNDATION:90,ROPE_SEGMENT_WIDTH:16,ROPE_SEGMENT_HEIGHT:6,NUMBER_OF_TARGET:4,NUMBER_OF_PILE:7,AUTO_MOVE_TIME:400},iu=function(e){nu.FOUNDATION_Y=e},au=function(e){return e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.JUSTIFY="justify",e}(au||{}),ru=nu,su=Wi.Z.GAMEPLAY_DEFAULT.KEY,ou=function(e){function t(t,n){var i;(i=e.call(this,t,0,0,su)||this).placement=void 0;var a=ru.CARD_VIEW,r=ru.DEPTH;return i.placement=n,i.setInteractive({useHandCursor:!0}),i.disableInteractive(),i.setAlpha(.6).setWorldSize(a.WIDTH,a.HEIGHT),i.setInteractive(),i.setDepth(r.CARD_SLOT),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.onClick=function(e){var t=!1;this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t=!0})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(function(){t&&e(),t=!1})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){t=!1}))},n.offClick=function(){this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT)},t}(Phaser.GameObjects.Image),cu=ou,hu=function(e){function t(t){var n;return(n=e.call(this)||this).boardGame=void 0,n.scene=void 0,n.cards=[],n.x=void 0,n.y=void 0,n.name=void 0,n.boardGame=t,n.scene=t.scene,n.cards=[],n}(0,s.Z)(t,e);var n=t.prototype;return n.setName=function(e){this.name=e},n.getname=function(){return this.name},n.setPosition=function(e,t){this.x=e,this.y=t},n.addCard=function(e){0==this.cards.includes(e)&&this.cards.push(e)},n.addCardAt=function(e,t){void 0===t&&(t=0),0==this.cards.includes(e)&&this.cards.splice(t,0,e)},n.removeCard=function(e){var t=this.cards.indexOf(e);return t>=0&&(this.cards.splice(t,1),!0)},n.update=function(){},n.getPlacingPosition=function(){return{x:this.x,y:this.y}},n.clear=function(){this.cards=[]},n.isEmpty=function(){return 0===this.cards.length},n.getCardsLength=function(){return this.cards.length},t}(Phaser.Events.EventEmitter),uu=15,lu=Wi.Z.GAMEPLAY_DEFAULT,du=lu.KEY,pu=lu.FRAME,fu=function(e){function t(t){var n;return(n=e.call(this,t)||this).maxCardsShow=void 0,n.alignTween=void 0,n.locked=void 0,n.lockedManual=void 0,n.slot=void 0,n.draw=function(){var e=(0,r.Z)(c().mark((function e(t){var i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),!n.locked&&!n.lockedManual){e.next=3;break}return e.abrupt("return");case 3:if((i=n.cards[n.cards.length-1])&&!i.isMoving){e.next=6;break}return e.abrupt("return");case 6:if(n.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.TAP_STOCK),(null==(a=n.boardGame.waste.getOnTopCard())?void 0:a.behavior.type)!==Qh.JOKER){e.next=12;break}return r={x:0,y:60,background:{scaleX:1.05,scaleY:.8},textBox:{x:0,y:30,text:n.scene.lang.Text.tipPlayWildCard,textAlignType:au.CENTER},icon:{x:0,y:-25,key:du,frame:pu.TUTORIAL.TRIPLE_ARROW,visible:!0},backgroundInteractive:!0},n.scene.screen.open(ce.o4.GUIDE_SCREEN,r),e.abrupt("return");case 12:return n.boardGame.hint.resetAutoHintTime(),n.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.DRAW_CARD),n.boardGame.hint.showMissPlay(),s=n.boardGame.gameplay.comboManager,400,o=n.boardGame.mover.moveToWaste({src:(0,fc.Z)(n),card:i,duration:400}),n.boardGame.mover.increaseMoves(),n.boardGame.mover.addUndoCard(i,tu.Stock,tu.Waste),0==i.isType(Qh.WINDMILL)&&t&&s.reset(),h=n.animateAlignCards(),e.next=24,Promise.all([n.boardGame.onPlayerMove(),o,h]);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.maxCardsShow=16,n.setName(tu.Stock),n.locked=!1,n.lockedManual=!1,n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){var e=this,t=new cu(this.scene,this);t.setPosition(this.x,this.y),t.onClick((function(){e.boardGame.gameplay.enableCardInput&&e.boardGame.stateMachine.emit(Jh.DRAW_STOCK)})),t.input.alwaysEnabled=!0,t.setVisible(!1),this.slot=t},n.lockDrawByTime=function(e){var t=this;this.setLocked(!1),this.scene.time.delayedCall(e,(function(){t.setLocked(!0)}))},n.setPosition=function(t,n){var i;e.prototype.setPosition.call(this,t,n),null==(i=this.slot)||i.setPosition(this.x,this.y)},n.setLocked=function(e){this.locked=e},n.setLockedManual=function(e){this.lockedManual=e},n.isLocked=function(){return this.isLocked()},n.addCardAt=function(e,t){if(void 0===t&&(t=0),0!=this.cards.includes(e))throw"Invalid operation";this.cards.splice(t,0,e),this.bringToTop()},n.bringToTop=function(){this.cards.forEach((function(e){e.behavior.bringToTop()}))},n.addCard=function(e){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.push(e)},n.align=function(){for(var e=this.cards.length,t=6*(e-1),n=0;n<e;n++){var i=this.cards[n];i.setVisible(n>=e-uu);var a=this.x+6*Math.max(n,e-uu)-t;i.setPosition(a,this.y),this.scene.gameplayLayer.bringToTop(i)}},n.animateAlignCards=function(){return this.moveToStep(0)},n.moveToStep=function(e){var t=this;this.setLocked(!0);var n=this.cards.length,i=this.scene.tweens.createTimeline({onComplete:function(){t.setLocked(!1),t.cards.forEach((function(t,i){t.setVisible(i+e>=n-uu)}))}}),a=this.x-6*(n-1);return this.cards.forEach((function(r,s){s+e>=n-uu&&r.setVisible(!0);var o=a+6*Math.max(s+e,n-uu);i.add({targets:r,x:o,y:t.y,duration:200,offset:0,ease:Phaser.Math.Easing.Sine.Out})})),i.play(),this.alignTween=i,i.waitForCompletion()},n.moveLeftCardStep=function(e,t){var n=this;this.setLocked(!0);var i=this.cards.length,a=this.scene.tweens.createTimeline({onComplete:function(){n.setLocked(!1),n.cards.forEach((function(e,n){e.setVisible(n+t>=i-uu)}))}}),r=this.x-6*(i-1);this.cards.forEach((function(e,s){s+t>=i-uu&&e.setVisible(!0);var o=r+6*Math.max(s+t,i-uu);a.add({targets:e,x:o,y:n.y,duration:200,offset:0,ease:Phaser.Math.Easing.Sine.Out})})),a.play()},n.getPosition=function(e){var t=this.cards.indexOf(e),n=this.cards.length;return{x:this.x-6*(n-1)+6*Math.max(t,n-uu),y:this.y}},n.clear=function(){e.prototype.clear.call(this)},t}(hu),mu=function(e,t){var n=t.targets,i=t.duration,a=void 0===i?1e3:i,r=t.currentAngle,s=t.shakingAngle,o=void 0===s?15:s,c=t.onComplete,h=e.tweens.createTimeline(),u=a/4;return h.add({targets:n,duration:u,props:{angle:{from:r,to:r-o}},ease:Phaser.Math.Easing.Sine.InOut}),h.add({targets:n,duration:u/2,props:{angle:{from:r-o,to:r+o}},loop:1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),h.add({targets:n,duration:u,props:{angle:{from:r-o,to:r}},onComplete:c,ease:Phaser.Math.Easing.Sine.InOut}),h.play(),h},gu=function(e){return e[e.ACE=1]="ACE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.NINE=9]="NINE",e[e.TEN=10]="TEN",e[e.JACK=11]="JACK",e[e.QUEEN=12]="QUEEN",e[e.KING=13]="KING",e}(gu||{}),vu=function(e){return e[e.SPADES=1]="SPADES",e[e.CLUBS=2]="CLUBS",e[e.DIAMOND=3]="DIAMOND",e[e.HEART=4]="HEART",e}(vu||{}),yu=function(e){return e[e.BLACK=1]="BLACK",e[e.RED=2]="RED",e}(yu||{}),Eu=Wi.Z.GAMEPLAY_OBJECTS,Cu=Eu.KEY,Au=(Eu.FRAME,function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.card=void 0,this.facingUp=void 0,this.type=void 0,this.value=void 0,this.suit=void 0,this.random=!0,this.effectedCard=void 0,this.keyUp=void 0,this.frameUp=void 0,this.keyDown=void 0,this.frameDown=void 0,this.flipMove=void 0,this.faceChangeCallbacks=void 0,this.facingTween=void 0,this.setFacing=function(e){t.facingUp=e,e?t.setFrameCardUp():t.setFrameCardDown()},this.scene=e.scene,this.boardGame=e.scene.gameplay.boardGame,this.card=e,this.type=Qh.UNKNOWN,this.value=-1,this.suit=-1,this.flipMove=-1,this.faceChangeCallbacks=[]}var t=e.prototype;return t.setValue=function(e,t){this.value=e,this.suit=t,this.keyUp=Cu,this.frameUp=this.getCardFrame(this.value,this.suit),this.type=Qh.VALUE,this.random=!1},t.setFacingWithFlippingAnim=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=0),void 0===i&&(i=300),this.facingUp!==t){e.next=4;break}return e.abrupt("return");case 4:return t&&this.random&&this.checkCardHasValue()&&(s=this.boardGame.deck.getRandomValue(),(this.card.beginPlacement==tu.Stock||this.card.beginPlacement==tu.Pile)&&(s=this.boardGame.deck.getRandomValueByMatchRatio()),this.value=s.value,this.suit=s.suit,this.keyUp=Cu,this.frameUp=this.getCardFrame(this.value,this.suit),this.random=!1),this.flipMove=this.boardGame.mover.getMoves(),this.facingUp=t,this.card.jump(10,i,0,n),o=i/2,null==(r=this.facingTween)||r.remove(),this.facingTween=this.card.scene.tweens.add({targets:this.card,scaleX:0,duration:o,delay:n}),e.next=13,this.facingTween.waitForCompletion();case 13:return t?this.setFrameCardUp():(this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.CLOSE_CARD),this.setFrameCardDown()),this.facingTween=this.card.scene.tweens.add({targets:this.card,scaleX:1,duration:o}),e.next=17,this.facingTween.waitForCompletion();case 17:a&&a(),this.faceChangeCallbacks.forEach((function(e){return e(t)}));case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),t.waitUntilFacingUp=function(){var e=this;return this.facingUp&&!this.facingTween.isPlaying()?Promise.resolve():new Promise((function(t){e.addFaceChangeListener((function n(i){i&&(t(),e.removeFaceChangeListener(n))}))}))},t.addFaceChangeListener=function(e){this.faceChangeCallbacks.push(e)},t.removeFaceChangeListener=function(e){this.faceChangeCallbacks=this.faceChangeCallbacks.filter((function(t){return t!==e}))},t.getCardFrame=function(e,t){return t==vu.HEART?"card/"+(e+400):t==vu.DIAMOND?"card/"+(e+300):t==vu.CLUBS?"card/"+(e+200):t==vu.SPADES?"card/"+(e+100):""},t.isRed=function(){return this.suit==vu.DIAMOND||this.suit==vu.HEART},t.init=function(){this.keyDown=Wi.Z.GAMEPLAY_OBJECTS.KEY,this.frameDown=Wi.Z.GAMEPLAY_OBJECTS.FRAME.CARD_BACK,this.setFrameCardDown();var e=ru.CARD_VIEW,t=e.WIDTH,n=e.HEIGHT;this.card.setSize(t,n),this.card.cardImage.setWorldSize(t,n),this.card.setInteractive({useHandCursor:!0}),this.card.disableInteractive(),this.flipMove=this.boardGame.mover.getMoves()},t.activate=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=!1),0==this.facingUp&&(this.setFacingWithFlippingAnim(!0),this.scene.tweens.addCounter({onUpdate:function(e){0==n.card.isOnAnimation()&&e.complete()}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.undo=function(){},t.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getPoints=function(e){void 0===e&&(e=!0);var t=ru.CARD_BOUNDS,n=t.WIDTH,i=t.HEIGHT,a=[],r=this.card.payload,s=r.x,o=r.y,c=new Phaser.Geom.Point(s,o);e||(c=new Phaser.Geom.Point(this.card.x,this.card.y));var h=new Phaser.Geom.Point(c.x-n/2,c.y-i/2),u=new Phaser.Geom.Point(c.x+n/2,c.y-i/2),l=new Phaser.Geom.Point(c.x-n/2,c.y+i/2),d=new Phaser.Geom.Point(c.x+n/2,c.y+i/2);a.push.apply(a,[h,u,d,l]);for(var p=0;p<4;p++){var f=Phaser.Math.DegToRad(this.card.payload.angle);Phaser.Math.RotateAround(a[p],c.x,c.y,f)}return a},t.onClick=function(){this.card.isMoving||this.facingUp||this.card.shake(8,800)},t.isPlusCard=function(){return this.type==Qh.PLUS_ONE||this.type==Qh.PLUS_TWO||this.type==Qh.PLUS_THREE||this.type==Qh.PLUS_FOUR||this.type==Qh.PLUS_FIVE},t.checkCardHasValue=function(){return this.type==Qh.VALUE||this.type==Qh.CHESTNUT||this.type==Qh.MAP_PIECE||this.type==Qh.BOOM||this.type==Qh.CHANGER||this.type==Qh.CHAIN},t.updateSize=function(){this.card.setScale(1,1)},t.setFrameCardUp=function(){this.card.setCardFrame(this.keyUp,this.frameUp),this.facingUp=!0},t.setFrameCardDown=function(e,t){e&&(this.keyDown=e),t&&(this.frameDown=t),this.card.cardImage.setTexture(this.keyDown,this.frameDown),this.facingUp=!1},t.bringToTop=function(){this.scene.gameplayLayer.bringToTop(this.card.shadow),this.scene.gameplayLayer.bringToTop(this.card)},t.removeFromPile=function(e,t){void 0===e&&(e=tu.Pile);var n=this.boardGame,i=n.pile,a=n.mover;i.removeCard(this.card),a.addUndoCard(this.card,tu.Pile,e,t),this.type!==Qh.WINDMILL&&Xh.emit(Kh.CLEAR_CARDS.EVENTS.CLEAR_CARDS,{type:"cards",value:1,card:this.card})},t.destroyItems=function(){},t.killItems=function(){},t.reviveItems=function(){},t.revive=function(){this.updateSize()},t.kill=function(){},t.hide=function(){this.card.setVisible(!1)},t.show=function(){this.card.setVisible(!0)},t.update=function(e){},t.postUpdate=function(){},e}()),wu=Au,Su=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0,Wi.Z.GAMEPLAY_OBJECTS.KEY,"card-bg")||this).parent=void 0,i.scaleAnimation=void 0,i.moveAnimation=void 0,i.shadowDistance=1.2,i.updateFromParent=function(){i.setAngle(i.parent.angle),i.setAlpha(i.parent.alpha)},i.parent=n,i.setOrigin(.5,.5),i.updateFromParent(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.setScaleFromParent=function(e,t){this.setScale(e,t)},n.stopAnimation=function(){var e,t;null==(e=this.scaleAnimation)||e.stop(),null==(t=this.moveAnimation)||t.stop(),this.updateFromParent(),this.setPosition(this.parent.x,this.parent.y)},n.runAnimationFollow=function(e,t,n){var i=this;this.stopAnimation(),this.revive(),this.scaleAnimation=this.scene.tweens.addCounter({from:0,to:1,yoyo:!0,duration:e/2,delay:n,repeat:t,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(){i.updateFromParent()}}),this.moveAnimation=this.scene.tweens.add({yoyo:!0,duration:e/2,delay:n,repeat:t,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var t=e.getValue(),n=i.parent.x+t*i.shadowDistance,a=i.parent.y+t;i.parent.z=t,i.setPosition(n,a)},onComplete:function(){i.kill()}})},t}(Phaser.GameObjects.Image),bu=Su,Tu=n(89),xu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).data=void 0,t}return(0,s.Z)(t,e),t.prototype.setData=function(e){this.data=e,this.value=e.value,this.suit=e.suit,this.keyUp=Wi.Z.GAMEPLAY_OBJECTS.KEY,this.frameUp=this.getCardFrame(this.value,this.suit),this.random=e.random},t}(wu),Pu=xu,ku=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.activate=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),n=this.boardGame.pile.handleWithLock(this.card),i=this.boardGame.mover.moveToWaste({src:this.boardGame.pile,card:this.card,duration:650,lockSegment:n}),this.card.emit(Tu.Z.MOVE_TO_WASTE),!t){e.next=7;break}return e.next=7,i;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pu),Iu=ku,Ou=Wi.Z.GAMEPLAY_OBJECTS,Ru=Ou.KEY,Bu=Ou.FRAME,Du=function(e){return e[e.NORMAL=0]="NORMAL",e[e.WARNING=1]="WARNING",e[e.IN_DANGER=2]="IN_DANGER",e}(Du||{}),Lu=function(e){function t(t){var n;return(n=e.call(this,t)||this).state=void 0,n.explodeCounter=void 0,n.bomb=void 0,n.firstDigit=void 0,n.secondDigit=void 0,n.digitContainer=void 0,n.line=void 0,n.bombContainer=void 0,n.glowRed=void 0,n.glowRedFront=void 0,n.glowBlack=void 0,n.glowAnimation=void 0,n.shakeBombAnimation=void 0,n.textAnimation=void 0,n.shakeBombTime=void 0,n.shakeBombCounter=void 0,n.fireParticles=void 0,n.initExplodeCounter=void 0,-1==t.payload.NumberOfMoves&&(t.payload.NumberOfMoves=Phaser.Math.Between(10,20)),n.explodeCounter=n.initExplodeCounter=t.payload.NumberOfMoves,n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.shakeBombTime=0,this.shakeBombCounter=0,this.createBomb(),this.createExplodeTime(),this.createBombContainer(),this.createGlowAnimation(600),this.createFireParticle(),this.glowAnimation.play(),this.state=Du.NORMAL,this.type=Qh.BOOM,this.updateDigits(this.explodeCounter),this.boardGame.stateMachine.on(Jh.CHECK_END_GAME,this.evaluateExplode,this),e.prototype.init.call(this)},n.createBomb=function(){this.bomb=this.scene.add.image(0,0,Ru,Bu.BOMB),this.bomb.setDefaultWorldSize(),this.line=this.scene.add.image(0,0,Ru,Bu.LINE),this.line.setDefaultWorldSize(),this.glowRed=this.scene.add.image(0,0,Ru,Bu.GLOW_RED),this.glowRed.setDefaultWorldSize(),this.glowRedFront=this.scene.add.image(0,0,Ru,Bu.GLOW_RED_FRONT),this.glowRedFront.setDefaultWorldSize(),this.glowBlack=this.scene.add.image(0,0,Ru,Bu.GLOW_BLACK),this.glowBlack.setDefaultWorldSize()},n.createExplodeTime=function(){this.secondDigit=this.scene.add.image(0,0,Ru,"bomb/0"),this.secondDigit.setScaleByWorld(.7),this.firstDigit=this.scene.add.image(0,0,Ru,"bomb/0"),this.firstDigit.setScaleByWorld(.7)},n.createBombContainer=function(){var e=ru.CARD_VIEW,t=e.WIDTH,n=e.HEIGHT;this.bombContainer=this.scene.add.container(0,0),this.digitContainer=this.scene.add.container(),this.digitContainer.add([this.firstDigit,this.secondDigit]),this.bombContainer.add([this.glowBlack,this.glowRed,this.bomb,this.glowRedFront,this.line,this.digitContainer]),Phaser.Display.Align.In.Center(this.glowRedFront,this.bombContainer,.5,0),Phaser.Display.Align.In.Center(this.glowBlack,this.bombContainer,0,1),Phaser.Display.Align.In.Center(this.glowRed,this.bombContainer,-1,3),Phaser.Display.Align.In.Center(this.bomb,this.bombContainer,0,-2),Phaser.Display.Align.To.TopCenter(this.line,this.bomb,5,-3),Phaser.Display.Align.In.Center(this.digitContainer,this.bombContainer,0,.5),Phaser.Display.Align.In.Center(this.firstDigit,this.digitContainer,-3.5,0),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,3.5,0),this.bombContainer.setPosition(t/2-this.bomb.width/2+5,n/2-this.bomb.height/2+5),this.card.add(this.bombContainer),this.bombContainer.kill(),this.glowRedFront.kill()},n.updateDigits=function(e){if(e>9){var t=e%10,n=Math.floor(e/10);this.secondDigit.setFrame("bomb/"+t),this.firstDigit.setFrame("bomb/"+n),this.firstDigit.revive(),Phaser.Display.Align.In.Center(this.firstDigit,this.digitContainer,-3.5,0),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,3.5,0)}else this.firstDigit.kill(),0==e?this.secondDigit.setFrame(Bu.SKULL):this.secondDigit.setFrame("bomb/"+e),Phaser.Display.Align.In.Center(this.secondDigit,this.digitContainer,.5,0);var i,a,r;e>4&&this.state!=Du.NORMAL&&(this.createGlowAnimation(600),null==(i=this.glowAnimation)||i.play(),this.state=Du.NORMAL);4==e&&this.state!=Du.WARNING&&(this.createGlowAnimation(600),null==(a=this.glowAnimation)||a.play(),this.shakeBombTime=3e3,this.shakeBombCounter=0,this.state=Du.WARNING);e<=3&&this.state!=Du.IN_DANGER&&(this.createGlowAnimation(300),null==(r=this.glowAnimation)||r.play(),this.shakeBombTime=1e3,this.shakeBombCounter=0,this.state=Du.IN_DANGER);this.state===Du.IN_DANGER?this.glowRedFront.revive():this.glowRedFront.kill()},n.setFrameCardUp=function(){var t;e.prototype.setFrameCardUp.call(this),this.bombContainer.revive(),null==(t=this.glowAnimation)||t.restart()},n.setFrameCardDown=function(t,n){var i,a;e.prototype.setFrameCardDown.call(this,t,n),null==(i=this.bombContainer)||i.kill(),null==(a=this.glowAnimation)||a.stop()},n.activate=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.killItems(),t.next=3,e.prototype.activate.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.evaluateExplode=function(){this.explodeCounter<=0&&(this.boardGame.stateMachine.emit(Jh.BOMB_COUNTER_REACHED_ZERO),this.explode())},n.explode=function(){this.scene.vibration.performVibrating(150)},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.mover.getMoves(),!(this.explodeCounter<=0||t<=this.flipMove)){e.next=3;break}return e.abrupt("return");case 3:this.explodeCounter-=1,this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.BOMB_TICK,{rate:1.5},!0),this.runCounterAnimation(),this.explodeCounter<=0&&(this.runScaleUpBombAnim(),this.boardGame.pile.removeCard(this.card));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.undo=function(){var e;this.explodeCounter>=this.initExplodeCounter||(this.explodeCounter+=1,this.updateDigits(this.explodeCounter),this.shakeBomb(),this.bombContainer.revive(),null==(e=this.glowAnimation)||e.restart())},n.killItems=function(){var e,t=this;null==(e=this.glowAnimation)||e.stop(),this.scene.tweens.add({targets:[this.bombContainer],duration:300,ease:Phaser.Math.Easing.Sine.In,scale:0,onComplete:function(){t.bombContainer.kill(),t.bombContainer.setScale(1)}})},n.reviveItems=function(){var e;this.bombContainer.revive(),null==(e=this.glowAnimation)||e.restart(),this.scene.tweens.killTweensOf(this.bombContainer),this.bombContainer.setScale(0),this.scene.tweens.add({targets:[this.bombContainer],duration:300,ease:Phaser.Math.Easing.Sine.Out,scale:1})},n.update=function(e){this.explodeCounter<=4&&0!=this.shakeBombTime&&(this.shakeBombCounter+=e,this.shakeBombCounter>=this.shakeBombTime&&(this.shakeBomb(),this.shakeBombCounter=0))},n.hideUI=function(){var e=this.scene.gameUI;e.hideUI(),e.showCoin(),e.gameUILayout.hidePlusCardsButtons()},n.createGlowAnimation=function(e){var t,n;null==(t=this.glowAnimation)||t.stop(),null==(n=this.glowAnimation)||n.remove();var i=this.scene.tweens.create({targets:[this.glowRed,this.glowRedFront],alpha:{from:1,to:.5},duration:e,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut});this.glowAnimation=i},n.shakeBomb=function(){var e,t;if(null==(e=this.shakeBombAnimation)||!e.isPlaying()){null==(t=this.shakeBombAnimation)||t.stop();var n=this.scene.tweens.createTimeline();this.shakeBombAnimation=n;var i=this.bombContainer.angle;n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i,to:i-10}},ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i-10,to:i+10}},loop:1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,duration:80,props:{angle:{from:i-10,to:i}},ease:Phaser.Math.Easing.Sine.InOut}),n.play()}},n.runCounterAnimation=function(){var e,t=this;if(null==(e=this.textAnimation)||!e.isPlaying()){var n=this.scene.tweens.createTimeline();this.textAnimation=n;n.add({targets:this.digitContainer,x:14,duration:350,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.digitContainer,x:{from:-14,to:0},duration:350,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){t.updateDigits(t.explodeCounter)},onUpdate:function(){t.updateDigits(t.explodeCounter)}}),n.add({targets:this.digitContainer,scaleX:0,duration:350,offset:0,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}),n.play()}},n.createFireParticle=function(){var e=1/GameCore.ImageScale,t=new Phaser.Geom.Circle(0,0,0),n=this.scene.add.particles(Wi.Z.GAMEPLAY_OBJECTS.KEY);n.createEmitter({frame:Wi.Z.GAMEPLAY_OBJECTS.FRAME.SPARK_VFX,scale:{start:.7*e,end:0,ease:Phaser.Math.Easing.Expo.In},alpha:{start:1,end:0},rotate:{min:-50,max:50},speed:{min:5,max:15},frequency:30,lifespan:{min:300,max:400},emitZone:{type:"random",source:t}}),this.bombContainer.add(n),n.setPosition(4.5,-21.5),this.fireParticles=n},n.runScaleUpBombAnim=function(){var e=this;this.scene.gameplayLayer.bringToTop(this.card);var t=0;this.scene.tweens.addCounter({from:1,to:7,duration:1e3,ease:Phaser.Math.Easing.Linear,onUpdate:function(n){n.getValue()>=t+1&&(t+=1,e.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.BOMB_TICK,{},!0))}});var n=this.scene.tweens.createTimeline();n.add({targets:this.bombContainer,scale:3,duration:1200,ease:Phaser.Math.Easing.Sine.InOut}),n.add({targets:this.bombContainer,alpha:0,duration:400,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){e.card.kill(),e.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.EXPLODE),e.hideUI(),e.boardGame.blowCardsBehavior.blow(e.card.x,e.card.y).then((function(){e.scene.screen.open(ce.o4.NOTIFY_BOMB_SCREEN)}))}}),this.shakeBomb(),n.play()},n.explodeCards=function(){var e=this,t=this.boardGame,n=t.pile,i=t.waste,a=t.stock,r=[].concat(n.cards),s=this.scene.world.getWorldSize(),o=s.width,c=s.height;r.forEach((function(t){t.behavior.killItems();var n=new Phaser.Math.Vector2(t.x-e.card.x,t.y-e.card.y);n.normalize();var i=t.x,a=t.y;n.x>0&&(i=o-t.x),n.y>0&&(a=c-t.y);var r=Math.sqrt(Math.pow(i,2)+Math.pow(a,2))+100;n.multiply({x:r,y:r}),t.move({x:t.x+n.x,y:t.y+n.y,duration:Phaser.Math.Between(1500,2e3)})}));var h=[].concat(i.cards,a.cards);h.forEach((function(e){e.move({x:e.x,y:c+100,duration:Phaser.Math.Between(1500,2e3)})})),this.scene.tweens.add({targets:h,alpha:0,duration:500}),r.push.apply(r,h);var u=this.scene.tweens.timeline(),l=1e3;u.add({targets:r,angle:function(){return Phaser.Math.Between(-180,-90)},duration:l,onYoyo:function(){r.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.add({targets:r,scaleX:0,yoyo:!0,offset:0,duration:250,onYoyo:function(){r.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.add({targets:r,scaleX:0,yoyo:!0,duration:500,offset:500,onYoyo:function(){r.forEach((function(e){if(e.behavior.checkCardHasValue()&&e.behavior.random){var t=Phaser.Math.Between(1,13),n=Phaser.Math.Between(1,4);e.behavior.setValue(t,n)}e.behavior.setFrameCardUp()}))}}),u.add({targets:r,angle:0,duration:l,offset:l,onYoyo:function(){r.forEach((function(e){e.behavior.setFrameCardDown()}))}}),u.play()},t}(Iu),_u=Lu,Mu=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t)||this).images=[],r.containerRectGeom=void 0,r.bufferRectGeom=void 0,r.updateImages=function(){r.images.forEach((function(e){return r.updateImgCrop(e)}))},r.images=a,r.add(r.images),r.setSize(n,i),r.createContainerRectGeom(),r.createBufferRectGeom(),t.events.on(Phaser.Scenes.Events.UPDATE,r.updateImages),r.on(Phaser.GameObjects.Events.DESTROY,(function(){t.events.on(Phaser.Scenes.Events.UPDATE,r.updateImages)})),r}(0,s.Z)(t,e);var n=t.prototype;return n.setImages=function(e){this.remove(this.images,!1),this.images=e,this.add(e)},n.createContainerRectGeom=function(){this.containerRectGeom=new Phaser.Geom.Rectangle(-this.width/2,-this.height/2,this.width,this.height)},n.createBufferRectGeom=function(){this.bufferRectGeom=new Phaser.Geom.Rectangle},n.updateImgCrop=function(e){var t=e.x,n=e.y,i=e.width,a=e.height,r=e.scaleX,s=e.scaleY,o={x:t-i/2,y:n-a/2};this.bufferRectGeom.setTo(o.x,o.y,i,a);var c=Phaser.Geom.Rectangle.Intersection(this.containerRectGeom,this.bufferRectGeom),h=c.x-o.x,u=c.y-o.y;e.setCrop(h/r,u/s,c.width/r,c.height/s)},t}(Phaser.GameObjects.Container),Nu=Wi.Z.GAMEPLAY_DEFAULT,Gu=Nu.KEY,Zu=Nu.FRAME,Fu=function(e){function t(t,n,i){var a;return void 0===n&&(n=42),void 0===i&&(i=68),(a=e.call(this,t)||this).arrows=[],a.peekabooContainer=void 0,a.speedUp=1,a.arrowSpacing=25,a.onUpdateMoveArrow=function(e,t,n,i){var r=a.height/2+10,s=a.height/7e3*i*a.scene.time.timeScale*a.speedUp,o=e.y-s;o<-r&&(o=a.arrows[0===t?a.arrows.length-1:t-1].y+a.arrowSpacing);e.setY(o)},a.setSize(n,i),a.createAnimatedArrows(),a.createCropContainer(),a}(0,s.Z)(t,e);var n=t.prototype;return n.runChangerAnimation=function(){this.scene.tweens.add({targets:this,speedUp:{from:1,to:10},yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,duration:250})},n.setTint=function(e){this.arrows.forEach((function(t){return t.setTintFill(e)}))},n.clearTint=function(){this.arrows.forEach((function(e){return e.clearTint()}))},n.createAnimatedArrows=function(){this.arrows=this.createArrows(4),this.playArrowsAnimation(this.arrows)},n.createArrows=function(e){var t=this;return Array(e).fill(null).map((function(e){var n=t.scene.add.image(0,0,Gu,Zu.ARROW_UP).setPosition(0,0);return n.setDefaultWorldSize(),n}))},n.playArrowsAnimation=function(e){var t=this;e.forEach((function(e,n){e.setY(n*t.arrowSpacing);var i=t.onUpdateMoveArrow.bind(void 0,e,n);t.scene.events.on(Phaser.Scenes.Events.UPDATE,i),e.on(Phaser.GameObjects.Events.DESTROY,(function(){t.scene.events.off(Phaser.Scenes.Events.UPDATE,i)}))}))},n.createCropContainer=function(){this.peekabooContainer=new Mu(this.scene,this.width,this.height,this.arrows),this.add(this.peekabooContainer)},t}(Phaser.GameObjects.Container),Uu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).increasing=void 0,t.arrowUpContainer=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.increasing=1==this.data.CardChangerType,this.createArrowUpContainer(),this.type=Qh.CHANGER,e.prototype.init.call(this)},n.isIncreasing=function(){return this.increasing},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.showArrowUpContainer()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.hideArrowUpContainer()},n.activate=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.hideArrowUpContainer(),t.next=3,e.prototype.activate.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.boardGame.mover.getMoves()<=this.flipMove)){e.next=3;break}return e.abrupt("return");case 3:t=this.value,this.increasing?(t+=1)>gu.KING&&(t=gu.ACE):(t-=1)<gu.ACE&&(t=gu.KING),this.setValue(t,this.suit),this.type=Qh.CHANGER,this.card.cardImage.setTexture(this.keyUp,this.frameUp),this.arrowUpContainer.runChangerAnimation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNextValue=function(){var e=this.value;return this.increasing?(e+=1)>gu.KING&&(e=gu.ACE):(e-=1)<gu.ACE&&(e=gu.KING),e},n.undo=function(){var e=this.value;this.increasing?(e-=1)<gu.ACE&&(e=gu.KING):(e+=1)>gu.KING&&(e=gu.ACE),this.setValue(e,this.suit),this.type=Qh.CHANGER,this.setFacing(!0)},n.revive=function(){e.prototype.revive.call(this),this.showArrowUpContainer()},n.hideArrowUpContainer=function(){this.arrowUpContainer.kill()},n.showArrowUpContainer=function(){this.arrowUpContainer.revive(),this.runArrowUpContainerAnimation()},n.runArrowUpContainerAnimation=function(){this.isRed()&&this.arrowUpContainer.setTint(16711680),this.arrowUpContainer.setAngle(this.increasing?0:180)},n.createArrowUpContainer=function(){this.arrowUpContainer=new Fu(this.scene),this.card.addAt(this.arrowUpContainer,1)},t}(Iu),Wu=Uu,Hu=n(88),Yu={KEY_CARD:{POP_AND_DROP:"key_card"},KEY:{POP_AND_FLY:"key_start"},LOCK:{UNLOCK:"lock_start"},BALLOON:{SHOW:"balloon_show",EXPLODE:"ballon_explosion"},CLOUDS:{IDLE:"cloud_idle",SHOW:"balloon_show_clouds",EXPLODE:"ballon_explosion_clouds"},CODE_BREAK:{IDLE:"cloud_idle",SHOW:"balloon_show",UNLOCK:"ballon_explosion"},LEVEL_COMPLETE:{ENTRANCE:"animation"},SQUIRREL:{APPEAR:"Appear",CATCH:"Catch",DISAPPEAR:"Disappear",FIND:"Find",IDLE:"Idle",LOOK:"Look",WIPE:"Wipe"},MAP:{MAP_APPEAR:"big_map_appear",MAP_FRAGMENT_APPEAR:"card_map_appear",MAP_FRAGMENT_COLLECT:"get_little_piece",MAP_COLLECT:"card_map_plus_piece",MAP_COLLECT_LAST:"card_map_full_done"},CARD:{APPEAR:"slice_card_appear",FX:{LEFT_CUT:"cut_left_side",RIGHT_CUT:"cut_right_side"},SLICE:"booster_slice",DECREASE:"decrease",INCREASE:"increase",SKIN:{DEFAULT:"default",BLACK:"black",RED:"red"}},WINDMILL:{APPEAR:"animation"},EVENT_BUTTONS:{DOWN:"down",UP:"up",SHOW:"show",HIDE:"hide",IDLE:"idle",DOWN_ALL:"down_all"},CHANGE_VFX:{CHANGE_BOTTOM:"change_bottom",CHANGE_TOP:"change_top"},CIRCLE_VFX:{SHOW:"show"}},Ku=Wi.Z.GAMEPLAY_OBJECTS,zu=Ku.KEY,Vu=Ku.FRAME,ju=90/275,Xu=135/395,qu=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).cardSpine=void 0,t.keySpine=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=zu,this.frameUp=Vu.CHEESE_CARD,this.type=Qh.KEY,e.prototype.init.call(this),this.createSpines()},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.KEY_ACTIVATE),this.removeFromPile(),t.refresh(),0!=(n=this.boardGame.pile.getLockCards()).length){e.next=8;break}return this.runTweenDisappearAnimation(),e.abrupt("return",Promise.resolve());case 8:return i=Phaser.Math.Between(0,n.length-1),(a=n[i]).behavior.activate(),this.effectedCard=a,r=a.behavior,s=r.runExitAnimation(),o=this.runSpineDisappearAnimation(a),e.next=17,Promise.all([s,o]);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.undo=function(){this.frameUp=Vu.CHEESE_CARD,this.setFrameCardUp(),this.keySpine.setScale(ju,Xu),this.keySpine.setAlpha(1),this.keySpine.setAngle(0),this.keySpine.setPosition(0,0),this.cardSpine.setScale(ju,Xu),this.cardSpine.setAngle(0),this.cardSpine.setPosition(0,0),this.card.add(this.keySpine),this.card.add(this.cardSpine)},n.revive=function(){var e=this.card.payload,t=e.x,n=e.y;this.card.setPosition(t,n),this.undo(),this.runReviveAnimation()},n.kill=function(){var e=this.boardGame.gameplay.spineManager;e.stopAnimation(this.keySpine),e.stopAnimation(this.cardSpine)},n.runTweenDisappearAnimation=function(){var e=this;this.updateSize(),new Hu.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.In,props:{scale:0},onComplete:function(){e.kill()}}).play(),this.card.jump(10,500)},n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.card.setScale(.2),new Rh.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},onComplete:function(){e.updateSize()}}).play(),this.card.jump(10,600)},n.runSpineDisappearAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.bringToTop(),this.frameUp=Vu.BLANK_CARD,this.setFrameCardUp(),this.card.kill(),n=this.runCardUnlockAnimation(),i=this.runKeyUnlockAnimation(),a=this.card,r=a.x,s=a.y,o=this.keySpine,h=o.x,u=o.y,this.keySpine.setPosition(r+h,s+u),l=this.scene.tweens.add({targets:this.keySpine,duration:716.6666666666666,x:t.x+170,y:t.y,angle:0,ease:Phaser.Math.Easing.Cubic.InOut,onComplete:function(){d.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.TWIST_LOCK),d.keySpine.setAlpha(0)}}).waitForCompletion(),e.next=12,Promise.all([i,n,l]);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runKeyUnlockAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,this.card.remove(this.keySpine),this.keySpine.setAngle(this.card.angle),this.scene.gameplayLayer.add(this.keySpine),e.next=6,t.playAnimation(this.keySpine,Yu.KEY.POP_AND_FLY);case 6:this.keySpine.kill();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCardUnlockAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,n=this.cardSpine,i=n.x,a=n.y,this.card.remove(this.cardSpine),this.cardSpine.setAngle(this.card.angle),this.cardSpine.setPosition(this.card.x+i,this.card.y+a),this.scene.gameplayLayer.add(this.cardSpine),e.next=8,t.playAnimation(this.cardSpine,Yu.KEY_CARD.POP_AND_DROP);case 8:this.cardSpine.kill();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createSpines=function(){var e=this.boardGame.gameplay.spineManager,t=e.createSpine(0,0,Wi.Z.CARD_LOCK_SPINE.DATA_KEY,Wi.Z.CARD_LOCK_SPINE.ATLAS_KEY,new SpinePlugin.SkinsAndAnimationBoundsProvider(Yu.KEY_CARD.POP_AND_DROP)),n=e.createSpine(0,0,Wi.Z.CARD_LOCK_SPINE.DATA_KEY,Wi.Z.CARD_LOCK_SPINE.ATLAS_KEY,new SpinePlugin.SkinsAndAnimationBoundsProvider(Yu.KEY.POP_AND_FLY));t.setScale(ju,Xu),n.setScale(ju,Xu),t.animationStateData.defaultMix=0,n.animationStateData.defaultMix=0,t.kill(),n.kill(),this.card.add(t),this.card.add(n),this.cardSpine=t,this.keySpine=n},t}(Pu),Ju=qu,Qu=Wi.Z.GAMEPLAY_OBJECTS,$u=Qu.KEY,el=Qu.FRAME,tl=90/275,nl=135/395,il=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=$u,this.frameUp=el.MOUSE_CARD,this.type=Qh.LOCK,e.prototype.init.call(this),this.createSpine()},n.activate=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.removeFromPile();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateSize(),this.frameUp=el.BLANK_CARD,this.setFrameCardUp(),this.card.kill(),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),e.next=7,this.runUnlockAnimation();case 7:this.boardGame.pile.refresh(),this.kill(),this.card.cardImage.revive();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runUnlockAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.spineManager,this.card.remove(this.spine),this.spine.setAngle(this.card.angle),this.spine.setPosition(this.card.x,this.card.y),this.scene.gameplayLayer.add(this.spine),e.next=7,t.playAnimation(this.spine,Yu.LOCK.UNLOCK);case 7:this.spine.kill();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.card.setScale(.2),this.card.jump(10,600),new Rh.Z({targets:[this.card],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},onComplete:function(){e.updateSize()}}).play()},n.revive=function(){e.prototype.revive.call(this),this.frameUp=el.MOUSE_CARD,this.setFrameCardUp(),this.spine.setScale(tl,nl),this.spine.setAngle(0),this.spine.setPosition(0,0),this.card.add(this.spine),this.runReviveAnimation()},n.kill=function(){var t=this;e.prototype.kill.call(this);var n=this.boardGame.pile;n.cards.forEach((function(e){e!=t.card&&e.payload.faceUp&&n.isOverLap(t.card,e)&&e.setBlur(!1)})),this.boardGame.gameplay.spineManager.stopAnimation(this.spine)},n.setFrameCardUp=function(){var t=this;e.prototype.setFrameCardUp.call(this);var n=this.boardGame.pile;n.cards.forEach((function(e){e!=t.card&&e.payload.faceUp&&n.isOverLap(t.card,e)&&e.setBlur(!0)}))},n.createSpine=function(){var e=this.boardGame.gameplay.spineManager,t=e.createSpine(0,0,Wi.Z.CARD_LOCK_SPINE.DATA_KEY,Wi.Z.CARD_LOCK_SPINE.ATLAS_KEY);t.setScale(tl,nl),t.animationStateData.defaultMix=0,e.killSpine(t),this.card.add(t),this.spine=t},t}(Pu),al=il,rl=Wi.Z.GAMEPLAY_OBJECTS,sl=rl.KEY,ol=rl.FRAME,cl=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).plus=void 0,i.cards=void 0,i.entranceAnimation=void 0,i.exitAnimation=void 0,i.addedCardsText=void 0,i.plus=n,i.createAddedCardText(),i}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=sl,this.frameUp=ol.PLUS_CARD,this.cards=[],e.prototype.init.call(this),this.setPlus(this.plus)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.addedCardsText.revive()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.addedCardsText.kill()},n.setPlus=function(e){this.plus=e,this.addedCardsText.text="+"+e,1==this.plus?this.type=Qh.PLUS_ONE:2==this.plus?this.type=Qh.PLUS_TWO:3==this.plus?this.type=Qh.PLUS_THREE:4==this.plus?this.type=Qh.PLUS_FOUR:5==this.plus&&(this.type=Qh.PLUS_FIVE);for(var t=0;t<this.plus;t++){var n=this.boardGame.deck.getNewStockCard();n.kill(),this.cards.push(n)}},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.pile,this.removeFromPile(),t.refresh(),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.CARD_PLUS_ACTIVATE,{},!0),e.abrupt("return",this.runEntranceAnimation());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.world.getWorldSize().width/2,i=this.scene.world.getWorldSize().height/2,this.card.move({x:n,y:i,duration:600}),this.card.behavior.bringToTop(),null==(t=this.entranceAnimation)||t.stop(),a=n<this.card.x?this.card.angle-15:this.card.angle+15,(r=this.scene.tweens.createTimeline()).add({targets:[this.card],scale:{from:1,start:1,to:1.2},angle:0,duration:600,ease:Phaser.Math.Easing.Sine.InOut}),r.add({targets:[this.card],angle:a,offset:0,duration:250,ease:Phaser.Math.Easing.Sine.InOut}),r.add({targets:[this.card],angle:0,offset:250,duration:250,ease:Phaser.Math.Easing.Sine.InOut}),this.entranceAnimation=r,e.next=13,this.entranceAnimation.playAndWaitForCompletion();case 13:return e.abrupt("return",this.addCardToStock(this.plus,n,i));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.addCardToStock=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l,d=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,r=250,s=[],o=[],h=this.scene.tweens.createTimeline(),u=c().mark((function e(t){var h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(h=d.boardGame.deck.getNewStockCard()).setAlpha(0),h.setPosition(n,i),u=h.moveWithRotate({x:d.boardGame.stock.x,y:d.boardGame.stock.y,duration:800,delay:a,onStart:function(){d.addedCardsText.setText("+"+(d.plus-t-1))},onComplete:function(){d.boardGame.stock.moveToStep(-1),d.boardGame.stock.addCard(h)}}),s.push(h),o.push(u),a+=r;case 7:case"end":return e.stop()}}),e)})),l=0;case 7:if(!(l<t)){e.next=12;break}return e.delegateYield(u(l),"t0",9);case 9:l++,e.next=7;break;case 12:return h.add({targets:this.card,duration:r/2,scale:1.3,yoyo:!0,loop:t-1,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){d.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FLY_TO_STOCK),d.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.SPAWN_CARD)},onLoop:function(){d.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FLY_TO_STOCK),d.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.SPAWN_CARD)},onComplete:function(){d.runExitAnimation()}}),h.add({targets:s,duration:200,offset:0,delay:this.scene.tweens.stagger(r,{}),ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}}),o.push(h.playAndWaitForCompletion()),e.next=17,Promise.all(o);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.exitAnimation)||t.stop(),(n=this.scene.tweens.createTimeline({onComplete:function(){i.card.kill()}})).add({targets:[this.card],duration:200,ease:Phaser.Math.Easing.Quadratic.Out,alpha:{start:1,from:1,to:0}}),this.exitAnimation=n,this.exitAnimation.play(),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.addedCardsText.setText("+"+this.plus);var t=this.card.payload,n=t.x,i=t.y;this.card.setPosition(n,-50);var a=this.scene.tweens.createTimeline();a.once(Phaser.Tweens.Events.TIMELINE_START,(function(){var t,n;null==(t=e.card.movingTween)||t.stop(),null==(n=e.facingTween)||n.stop(),e.updateSize(),e.setFrameCardUp()})),a.once(Phaser.Tweens.Events.TIMELINE_COMPLETE,(function(){e.card.payload.faceUp||e.boardGame.pile.checkOverlap(e.card)&&e.setFacingWithFlippingAnim(!1)})),a.add({targets:this.card,x:n,y:i,duration:300,ease:Phaser.Math.Easing.Sine.Out}),a.play()},n.revive=function(){var t,n,i=this;e.prototype.revive.call(this),null==(t=this.entranceAnimation)||t.stop(),null==(n=this.exitAnimation)||n.stop(),this.runReviveAnimation();for(var a,r=this.boardGame.stock,s=function(){var e=r.cards.pop();if(!e)return{v:void 0};i.cards.push(e);var t=i.card.payload,n=t.x,a=t.y,s=t.angle;e.setAngle(s),e.move({x:n,y:a,duration:250,onComplete:function(){e.kill()}})},o=0;o<this.plus;o++)if(a=s())return a.v;r.animateAlignCards()},n.createAddedCardText=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(22),origin:{x:.5,y:.5},text:"+99",y:1});e.setTint(10175696),this.card.add(e),this.addedCardsText=e},t}(Pu),hl=cl,ul=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp="atlas_level_wildcards",this.frameUp="wildcard_zap",this.type=Qh.ZAP,e.prototype.init.call(this)},n.getElectrocutionCards=function(){var e=this,t=this.boardGame.pile.getFrontCards().filter((function(e){var t;return(null==(t=e.behavior)?void 0:t.type)==Qh.VALUE})),n=this.scene.world.getWorldSize().width,i=[];return t.forEach((function(t){var a=new Phaser.Geom.Line(0,e.card.y+10,n,e.card.y+10),r=new Phaser.Geom.Line(0,e.card.y-10,n,e.card.y-10),s=t.getRotatedRectangle();(Phaser.Geom.Intersects.LineToRectangle(a,s)||Phaser.Geom.Intersects.LineToRectangle(r,s))&&i.push(t)})),i},n.activate=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.card.kill(),(t=this.boardGame.pile).removeCard(this.card),this.boardGame.gameplay.setEnableCardInput(!1),n=this.getElectrocutionCards(),this.boardGame.gameplay.scoreManager.increaseScoreByBoom(1+n.length),n.forEach((function(e){e.kill(),t.removeCard(e)})),this.scene.time.delayedCall(500,(function(){t.refresh(),i.boardGame.gameplay.setEnableCardInput(!0)}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pu),ll=ul,dl=n(90),pl=function(e){return e.COIN="Coin",e.STAR="Star",e.BOOSTER_SLICE="BoosterSlice",e.BOOSTER_STORM="BoosterStorm",e.BOOSTER_WILD_DROP="BoosterWildDrop",e.BOOSTER_PLUS_FIVE="BoosterPlusFive",e.PLUS_FIVE="PlusFive",e.UNDO="Undo",e.WILD_CARD="WildCard",e.UNKNOWN="Unknown",e}(pl||{}),fl=pl,ml=function(e){return e.USE_STORAGE_ITEM="UseStorageItem",e.BUY_BOOSTER_SLICE="BuyBoosterSlice",e.BUY_BOOSTER_STORM="BuyBoosterStorm",e.BUY_BOOSTER_WILD_DROP="BuyBoosterWildDrop",e.BUY_USE_UNDO="BuyUseUndo",e.BUY_USE_WILD_CARD="BuyUseWildCard",e.BUY_USE_PLUS_FIVE="BuyUsePlusFive",e.WEEKLY_TOURNAMENT="WeeklyTournament",e.OFFSHORE_RACE="OffshoreRace",e.BOXING_DUEL="BoxingDuel",e.PLAY_CARD="PlayCard",e.UNDO_WILDCARD="UndoWildcard",e.UNDO_PLAY_CARD="UndoPlayCard",e.LEVEL_COMPLETE="LevelComplete",e.STREAK_REWARDS="StreakRewards",e.WELCOME_BACK="WelcomeBack",e.REWARD_NEW_USER="RewardNewUser",e.GET_MORE_COIN_AD="GetMoreCoinAd",e.WELCOME_BACK_AD="WelcomeBackAd",e.LEVEL_COMPLETE_AD="LevelCompleteAd",e.PLUS_FIVE_AD="PlusFiveAd",e}(ml||{}),gl=ml,vl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).isBought=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.keyUp=Wi.Z.GAMEPLAY_OBJECTS.KEY,this.frameUp=Wi.Z.GAMEPLAY_OBJECTS.FRAME.WILD_CARD,this.keyDown=Wi.Z.GAMEPLAY_OBJECTS.KEY,this.frameDown=Wi.Z.GAMEPLAY_OBJECTS.FRAME.WILD_CARD_BACK,this.type=Qh.JOKER,this.isBought=!1},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.boardGame,i=n.mover,a=n.waste,r=n.pile,s=this.boardGame.gameplay.coinUsingManager,0==this.facingUp&&this.setFacingWithFlippingAnim(!0),this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.START_MOVE_TO_WASTE),!((null==(o=a.getOnTopCard())?void 0:o.behavior)instanceof t)){e.next=12;break}return s.addWildCard(this.card,!1),this.scene.logEconomy.logGetItem(fl.WILD_CARD,1,gl.PLAY_CARD),this.removeFromPile(tu.Joker),this.card.disableInteractive(),r.refresh(),e.abrupt("return",this.runMoveAnimation(tu.Joker));case 12:return i.fromPileToWaste(this.card),i.addUndoCard(this.card,tu.Pile,tu.Waste),r.refresh(),this.scene.logEconomy.logCollectUseWildcard(),e.abrupt("return",this.runMoveAnimation(tu.Waste));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.activate=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.revive(),this.card.revive(),0==this.facingUp&&this.setFacingWithFlippingAnim(!0),t=this.boardGame.waste,n=this.scene.gameplay.coinUsingManager,t.addCard(this.card),i=n.wildCardWrapper.getWorldPosition(),a=i.x,r=i.y,s=n.wildCardBtn.getOffsetMainY(),this.card.setPosition(a,r+s),this.boardGame.mover.addUndoCard(this.card,tu.Joker,tu.Waste),this.runMoveAnimation(tu.Waste);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runMoveAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.boardGame.waste,i=this.scene.gameplay.coinUsingManager,this.updateSize(),this.bringToTop(),t!=tu.Waste){e.next=9;break}return this.card.moveWithRotate({x:n.x,y:n.y,duration:800,onComplete:function(){h.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FINISH_MOVE_TO_WASTE)}}),e.next=8,(0,dl.Z)(this.scene,300);case 8:return e.abrupt("return");case 9:if(t!=tu.Joker){e.next=20;break}return this.scene.gameplayLayer.bringToTop(i.wildCardBtn),a=i.wildCardWrapper.getWorldPosition(),r=a.x,s=a.y,o=i.wildCardBtn.getOffsetMainY(),e.next=15,this.card.moveWithRotate({x:n.x,y:n.y-80,duration:600});case 15:return this.card.flipRotate(600,-90),e.next=18,this.card.moveWithRotate({x:r,y:s+o,duration:800});case 18:i.onWildCardChanged(),this.card.kill();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(wu),yl=vl,El=function(e){return e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e}({}),Cl=ru.CARD_VIEW,Al=Cl.WIDTH,wl=Cl.HEIGHT,Sl=Wi.Z.GAMEPLAY_OBJECTS,bl=Sl.KEY,Tl=Sl.FRAME,xl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t.animations=void 0,t.blowAnimation=void 0,t.blowCardsAnimation=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.createSpine(),this.keyUp=bl,this.frameUp=Tl.STORM_CARD,this.keyDown=bl,this.frameDown=Tl.STORM_CARD_BACK,this.animations=[],this.type=Qh.WINDMILL,this.card.cardImage.setWorldSize(Al,wl)},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),this.scene.gameUI.footer.setCanHandleSettings(!1),t=this.boardGame,n=t.pile,i=t.mover,this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),(a=n.getFrontCards()).forEach((function(e){e.moveToTopLayer()})),(r=this.boardGame.locks.filter((function(e){return e.active}))).forEach((function(e){s.scene.gameplayLayer.bringToTop(e),i.addUndoLock(e)})),this.runBlowLocksAnimation(r),this.runBlowCardsAnimation(a),this.boardGame.waste.removeCard(this.card),e.next=13,this.runAnimation();case 13:r.forEach((function(e){e.handleCards(!1)})),this.boardGame.pile.refresh(),this.scene.gameUI.footer.setCanHandleSettings(!0),this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.world.getWorldSize().width,i=this.scene.world.getWorldSize().height,a=n/2,r=i/2-this.card.height/2,null==(t=this.blowAnimation)||t.stop(),this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.SWOOSH_LONG,{},!0),this.card.behavior.bringToTop(),400,100,e.next=11,(0,dl.Z)(this.scene,500);case 11:return s=this.runWindmillActivationAnimation(),o=this.scene.add.tween({targets:this.card,x:a,y:r,duration:400,ease:Phaser.Math.Easing.Linear}).waitForCompletion(),h=this.playCardRotateSound(),e.next=16,Promise.all([s,o,h]);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playCardRotateSound=function(){var e=this;return new Promise((function(t,n){var i=0;e.scene.time.addEvent({repeat:14,delay:120,callback:function(){try{e.scene.audio.playAudioSprite(Fc.Z.CARD_ROTATE.KEY,"card_rotate_"+i),(i+=1)>=14&&t()}catch(a){n(a instanceof Error?a:new Error("Error while playing card rotate sound"))}}})}))},n.runBlowLocksAnimation=function(e){var t=this,n=this.scene.world.getWorldSize().width;e.forEach((function(e){if(e.direction==El.LEFT){var i=e.move(-100,e.y-15,1e3,2e3);null==i||i.once(Phaser.Tweens.Events.TWEEN_START,(function(){t.scene.gameplayLayer.bringToTop(e),t.card.behavior.bringToTop()})),null==i||i.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){e.killedByWindmill()}))}if(e.direction==El.RIGHT){var a=e.move(n+100,e.y-15,1e3,2500);null==a||a.once(Phaser.Tweens.Events.TWEEN_START,(function(){t.scene.gameplayLayer.bringToTop(e),t.card.behavior.bringToTop()})),null==a||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){e.killedByWindmill()}))}}))},n.runBlowCardsAnimation=function(e){var t,n=this,i=this.scene.world.getWorldSize().width;null==(t=this.blowCardsAnimation)||t.stop();var a=this.scene.tweens.createTimeline();a.add({targets:e,y:"-=10",duration:800,delay:1200,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){var t=n.boardGame.gameplay.comboManager;n.scene.rewardManager;e.forEach((function(e){(e.behavior.removeFromPile(),e.behavior.bringToTop(),e.isType(Qh.CHAIN,Qh.CHANGER)||e.behavior.killItems(),e.isType(Qh.CHANGER))&&e.behavior.hideArrowUpContainer();t.increaseCombo(e),n.scene.events.emit(Tu.Z.COLLECT_CARD,e)})),n.card.behavior.bringToTop()}}),a.add({targets:e,angle:function(e){return e.angle+Phaser.Math.Between(-35,35)},duration:function(){return Phaser.Math.Between(1e3,1300)}});var r=i/2;e.forEach((function(e){var t=e.y+Phaser.Math.Between(-30,30),s=Phaser.Math.Between(1500,1800),o=e.x<r,c=o?-100:i+100,h=o?2e3:2500;e.move({x:c,y:t,duration:s,delay:h}),(0,dl.Z)(n.scene,h).then((function(){e.isType(Qh.CHAIN)&&e.behavior.hideChain(!0,1200);e.isType(Qh.CHESTNUT)&&e.behavior.throwNutToBasket();e.isType(Qh.MAP_PIECE)&&e.behavior.collectMapPiece()})),a.add({targets:e,scaleX:-1,yoyo:!0,duration:600,onUpdate:function(t){var n=t.getValue();e.behavior.facingUp&&n<=0?e.behavior.setFacing(!1):!e.behavior.facingUp&&n>=0&&e.behavior.setFacing(!0)},offset:h})})),this.blowCardsAnimation=a,a.play(),e.forEach((function(e){e.jump(15,2e3,0,1200)}))},n.revive=function(){var t;e.prototype.revive.call(this),null==(t=this.blowCardsAnimation)||t.stop(),this.card.setAngle(0),this.card.cardImage.setAlpha(1),this.card.shadow.setAlpha(1)},n.createSpine=function(){var e=this.scene.gameplay.spineManager.createSpine(0,5,Wi.Z.WINDMILL_SPINE.DATA_KEY,Wi.Z.WINDMILL_SPINE.ATLAS_KEY);e.setScale(.34,.34),e.animationStateData.defaultMix=0,e.kill(),this.card.add(e),this.spine=e},n.runWindmillActivationAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.card.cardImage.setAlpha(0),this.card.shadow.setAlpha(0),t=this.scene.gameplay.spineManager,n=t.playAnimation(this.spine,Yu.WINDMILL.APPEAR),i=this.scene.tweens.add({targets:this.spine,y:{from:5,to:140},duration:400,ease:Phaser.Math.Easing.Linear}).waitForCompletion(),e.next=7,Promise.all([n,i]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pu),Pl=xl,kl=Wi.Z.GAMEPLAY_OBJECTS,Il=kl.KEY,Ol=kl.FRAME,Rl=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=Qh.MYSTERIOUS,this.keyDown=Il,this.frameDown=Ol.MYSTERIOUS_CARD,this.card.isMysterious=!0,this.setRandomBehavior()},n.setRandomBehavior=function(){var e=[Qh.BOOM,Qh.CHANGER,Qh.JOKER,Qh.PLUS_FIVE,Qh.PLUS_FOUR,Qh.PLUS_THREE,Qh.PLUS_TWO,Qh.PLUS_ONE],t=e[Phaser.Math.Between(0,e.length-1)];this.card.setBehavior(t),this.type=t,this.card.behavior.setFrameCardDown(Il,Ol.MYSTERIOUS_CARD)},t}(Pu),Bl=Rl,Dl=function(){function e(e,t){var n=this;this.scene=void 0,this.graphics=void 0,this.bodies=void 0,this.leftConstraint=void 0,this.rightConstraint=void 0,this.toLeft=new Phaser.Math.Vector2(0,0),this.toRight=new Phaser.Math.Vector2(0,0),this.leftKnob=void 0,this.rightKnob=void 0,this.chain=void 0,this.drawRopePoints=function(){n.graphics.clear(),n.graphics.lineGradientStyle(ru.ROPE_SEGMENT_HEIGHT,15909239,15909239,11686171,11686171,1);var e=n.leftConstraint.pointA,t=n.rightConstraint.pointA;n.graphics.beginPath(),n.graphics.moveTo(e.x,e.y);for(var i=1;i<n.bodies.length-1;i++){var a=n.bodies[i].position;n.graphics.lineTo(a.x,a.y)}n.graphics.lineTo(t.x,t.y),n.graphics.stroke()},this.scene=e,this.create(t)}var t=e.prototype;return t.setKnobs=function(e,t){this.leftKnob=e,this.rightKnob=t},t.setLeftPos=function(e,t){var n=this.toLeft,i=n.x,a=n.y;Math.round(e)==Math.round(i)&&Math.round(a)==Math.round(t)||this.toLeft.set(e,t)},t.setRightPos=function(e,t){var n=this.toRight,i=n.x,a=n.y;Math.round(e)==Math.round(i)&&Math.round(a)==Math.round(t)||this.toRight.set(e,t)},t.getSegments=function(){return this.bodies},t.create=function(e){var t=this;this.bodies=[];var n=this.scene.matter;this.graphics=this.scene.add.graphics(),this.scene.gameplayLayer.add(this.graphics);var i=Math.ceil(e/ru.ROPE_SEGMENT_WIDTH)+3,a=n.add.stack(0,0,i,1,0,0,(function(e,n){var i=Phaser.Physics.Matter.Matter.Bodies.rectangle(e,n,ru.ROPE_SEGMENT_WIDTH,ru.ROPE_SEGMENT_HEIGHT,{collisionFilter:{group:-1,category:1,mask:-1},frictionAir:.09});return t.bodies.push(i),i}));this.bodies.forEach((function(e,t){e.position.x=20+8*t,e.position.y=50})),this.chain=n.add.chain(a,.375,0,-.375,0,{stiffness:.8,length:0}),this.leftConstraint=this.scene.matter.add.worldConstraint(a.bodies[0],0,.4,{pointA:{x:a.bodies[0].position.x,y:a.bodies[0].position.y},pointB:{x:-2,y:0}}),this.rightConstraint=this.scene.matter.add.worldConstraint(a.bodies[i-1],0,.4,{pointA:{x:a.bodies[i-1].position.x,y:a.bodies[i-1].position.y},pointB:{x:2,y:0}})},t.setAlpha=function(e){this.graphics.setAlpha(e)},t.destroy=function(){this.scene.matter.world.removeConstraint([].concat(this.chain.constraints,[this.leftConstraint,this.rightConstraint]),!0),this.graphics.destroy(),this.scene.matter.world.remove(this.bodies,!0)},t.revive=function(){this.graphics.revive(),this.bodies.forEach((function(e){Phaser.Physics.Matter.Matter.Sleeping.set(e,!1)}))},t.kill=function(){this.graphics.kill(),this.bodies.forEach((function(e){Phaser.Physics.Matter.Matter.Sleeping.set(e,!0)}))},t.update=function(){if(this.setLeftPos(this.leftKnob.x,this.leftKnob.y),this.setRightPos(this.rightKnob.x,this.rightKnob.y),0!=this.toLeft.x&&0!=this.toRight.x){var e=this.toLeft.clone().subtract(this.leftConstraint.pointA),t=e.length();if(t>.01){var n=Math.min(t,20),i=Math.max(t,20),a=Phaser.Math.Clamp(t/10,n,i),r=e.normalize().scale(a),s=r.x,o=r.y;this.leftConstraint.pointA.x+=s,this.leftConstraint.pointA.y+=o}var c=this.toRight.clone().subtract(this.rightConstraint.pointA),h=c.length();if(h>.01){var u=Math.min(h,20),l=Math.max(h,20),d=Phaser.Math.Clamp(h/10,u,l),p=c.normalize().scale(d),f=p.x,m=p.y;this.rightConstraint.pointA.x+=f,this.rightConstraint.pointA.y+=m}this.drawRopePoints()}},e}(),Ll=Dl,_l=Wi.Z.GAMEPLAY_OBJECTS,Ml=_l.KEY,Nl=_l.FRAME,Gl=function(e){function t(t){var n;return(n=e.call(this,t)||this).connectedCard=void 0,n.knob=void 0,n.rope=void 0,n.showOrHideChainTween=void 0,n.setData(t.payload),n.type=Qh.CHAIN,n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.knob=this.scene.add.image(0,0,Ml,Nl.RED_KNOB),this.knob.setDefaultWorldSize(),this.scene.gameplayLayer.add(this.knob),this.type=Qh.CHAIN},n.moveToTopLayer=function(){this.scene.gameplayLayer.bringToTop(this.knob),this.updateRopeDepth()},n.setConnectedCard=function(e){e&&(this.connectedCard=e)},n.initRope=function(){var e=this.connectedCard.behavior;if(!e.rope){this.updateKnob(),e.updateKnob();var t=Phaser.Math.Distance.Between(this.knob.x,this.knob.y,e.knob.x,e.knob.y),n=this.knob,i=e.knob;this.rope=new Ll(this.scene,t),n.x>i.x&&(n=i,i=this.knob),this.rope.setKnobs(n,i),this.updateRopeDepth()}},n.bringToTop=function(){e.prototype.bringToTop.call(this),this.scene.gameplayLayer.moveAbove(this.knob,this.card),this.updateRopeDepth()},n.revive=function(){e.prototype.revive.call(this),this.showChain(!0)},n.updateRopeDepth=function(){if(this.connectedCard){var e=this.connectedCard.behavior;if(this.rope){var t=this.rope.graphics,n=this.scene.gameplayLayer.getIndex(this.card),i=this.scene.gameplayLayer.getIndex(this.connectedCard);this.scene.gameplayLayer.bringToTop(t),n>i?(this.scene.gameplayLayer.moveBelow(t,this.knob),this.scene.gameplayLayer.moveAbove(e.knob,t)):(this.scene.gameplayLayer.moveBelow(t,e.knob),this.scene.gameplayLayer.moveAbove(this.knob,t))}else e.updateRopeDepth()}},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.activate=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this,!0);case 2:this.bringToTop(),this.pullConnectedCard();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.refresh=function(){this.knob&&(this.card.behavior.facingUp?!this.connectedCard.behavior.facingUp||this.card.isLock||this.connectedCard.isLock?(this.card.setBlur(!0),this.knob.setFrame(Nl.RED_KNOB)):(this.card.setBlur(!1),this.knob.setFrame(Nl.KNOB)):(this.card.setBlur(!1),this.knob.setFrame(Nl.RED_KNOB)),this.knob.setDefaultWorldSize())},n.showChain=function(e,t){var n,i=[this.knob];if(this.rope&&i.push(this.rope.graphics),this.reviveItems(),!e)return this.knob.setAlpha(1),void this.rope.setAlpha(1);null==(n=this.showOrHideChainTween)||n.stop(),this.showOrHideChainTween=this.scene.tweens.add({targets:i,alpha:1,delay:t,duration:400,ease:Phaser.Math.Easing.Sine.InOut})},n.hideChain=function(e,t){var n,i=this,a=[this.knob];this.rope&&a.push(this.rope.graphics),e?(null==(n=this.showOrHideChainTween)||n.stop(),this.showOrHideChainTween=this.scene.tweens.add({targets:a,alpha:0,duration:400,delay:t,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){i.killItems()}})):this.killItems()},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.refresh()},n.setFrameCardDown=function(){e.prototype.setFrameCardDown.call(this),this.refresh()},n.destroyItems=function(){this.knob.destroy(),this.rope&&this.rope.destroy()},n.killItems=function(){var e;this.knob.kill(),null==(e=this.rope)||e.kill()},n.reviveItems=function(){var e;this.knob.revive(),null==(e=this.rope)||e.revive()},n.update=function(){this.updateKnob()},n.postUpdate=function(){var e;null==(e=this.rope)||e.update()},n.pullConnectedCard=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.connectedCard.behavior)instanceof t&&n.pullToWaste();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.pullToWaste=function(){var e=(0,r.Z)(c().mark((function e(){var n,i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.boardGame,i=n.mover,a=n.waste,r=n.pile,this.scene.events.emit(Tu.Z.COLLECT_CARD,this.card),r.handleMatch(this.card),i.fromPileToWaste(this.card),r.refresh(),this.bringToTop(),s=a.x>this.card.x,e.next=9,this.card.moveByPulled(s,{x:a.x,y:a.y,duration:600,onComplete:function(){o.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FINISH_MOVE_TO_WASTE)}});case 9:this.hideChain(!0),this.connectedCard.behavior instanceof t&&this.connectedCard.behavior.hideChain(!0);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateKnob=function(){var e=this.card,t=e.angle,n=e.rotation;this.knob.setAngle(t),this.knob.setPosition(this.card.x-this.card.displayHeight/2*Math.sin(n),this.card.y+this.card.displayHeight/2*Math.cos(n)-3)},t}(Iu),Zl=function(e){this.card=void 0,this.card=e},Fl=Phaser.Math.Easing.Sine,Ul=function(e){function t(t){var n;return(n=e.call(this,t)||this).timeLine=void 0,n}(0,s.Z)(t,e);var n=t.prototype;return n.makeTimeLine=function(){var e;return null==(e=this.timeLine)||e.stop(),this.timeLine=this.card.scene.tweens.createTimeline({targets:this.card}),this},n.onComplete=function(e){this.timeLine.once(Phaser.Tweens.Events.TIMELINE_COMPLETE,e)},n.makeMove=function(e,t,n,i){return void 0===i&&(i=0),this.timeLine.add({x:e,y:t,duration:n,offset:i,ease:Fl.Out}),this},n.makeRotate=function(e,t,n){return void 0===n&&(n=0),this.timeLine.add({angle:e,duration:t,offset:n,ease:Fl.Out}),this},n.makeJump=function(e,t,n){return void 0===n&&(n=0),this.timeLine.add({z:e,duration:t/2,offset:n,ease:Fl.In}),this.timeLine.add({z:e,duration:t/2,ease:Fl.In}),this},n.play=function(){this.timeLine.play()},t}(Zl),Wl=Wi.Z.GAMEPLAY_OBJECTS,Hl=Wl.KEY,Yl=Wl.FRAME,Kl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).missingMapPieces=8,t.missingMapPiecesAnimation=8,t.movesOnFlag=void 0,t.spine=void 0,t.sleepTime=void 0,t.showTreasureMap=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=Hl,this.frameUp=Yl.BLANK_CARD,this.type=Qh.TREASURE,this.createTreasureMap(),this.sleepTime=0,this.showTreasureMap=!0,e.prototype.init.call(this)},n.activate=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.getMissingMapPieceIndex=function(){if(this.missingMapPieces-=1,this.missingMapPieces<=0){var e=this.scene.gameplay.boardGame.mover.moves;this.movesOnFlag=e}return this.missingMapPieces},n.isMapCollectedAllPieces=function(){return this.missingMapPieces<=0},n.getSleepTime=function(){var e=this.sleepTime;return this.sleepTime+=300,e},n.runAssembleMapPieceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.scene.gameplay.spineManager,this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.TICK),this.missingMapPiecesAnimation-=1,t.setData("isMapPieceCollected",!0),!(this.missingMapPiecesAnimation>0)){e.next=9;break}return this.updateTreasureMapSpine(this.missingMapPiecesAnimation),e.next=8,n.playAnimation(this.spine,Yu.MAP.MAP_COLLECT);case 8:return e.abrupt("return");case 9:return this.scene.gameplay.setEnableCardInput(!1),this.removeFromPile(tu.Pile,this.movesOnFlag),(0,dl.Z)(this.scene,600).then((function(){return i.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF)})),e.next=14,n.playAndWaitAnimation(this.spine,Yu.MAP.MAP_COLLECT_LAST);case 14:return this.card.kill(),this.kill(),this.sleepTime=0,this.boardGame.pile.refresh(),e.next=20,this.boardGame.activateDrawableCards();case 20:this.showTreasureMap=!0;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateTreasureMapSpine=function(e){var t=8-e;if(!(e>8)){var n="";e<=0?n="map_full_big_map":e>=0&&e<8?n="map_"+Math.max(Math.min(t,7),1):8===e&&(n=""),this.spine.skeleton.setAttachment("map_1",n)}},n.createTreasureMap=function(){this.spine=this.scene.add.spine(0,0,Wi.Z.MAP_SPINE.DATA_KEY,Wi.Z.MAP_SPINE.ATLAS_KEY),this.spine.setScale(.135,.135),this.card.add(this.spine)},n.setFacingWithFlippingAnim=function(e){return this.facingUp===e||(e||this.killItems(),this.setFrameCardUp()),Promise.resolve()},n.setMissingMapPieces=function(e,t){void 0===t&&(t=!0),this.missingMapPieces=e,t&&(this.missingMapPiecesAnimation=e)},n.getMissingMapPieces=function(){return this.missingMapPieces},n.getMissingMapPiecesAnimation=function(){return this.missingMapPiecesAnimation},n.getMapPiecePosition=function(e){var t=this.card.getWorldPosition(),n=0;return 1===e||2===e?n=-17:3===e||4===e?n=-6:5===e||6===e?n=7.3:7!==e&&8!==e||(n=19.5),{x:t.x+(e%2===0?10.5:-11),y:t.y+n}},n.runMapAppearAnimation=function(){var e=this.scene.gameplay.spineManager;if(this.updateTreasureMapSpine(this.missingMapPiecesAnimation),this.showTreasureMap)return this.showTreasureMap=!1,this.spine.animationState.clearTracks(),e.playAnimation(this.spine,Yu.MAP.MAP_APPEAR)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.card.cardImage.kill(),this.card.shadow.kill(),this.runMapAppearAnimation()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.card.cardImage.kill(),this.card.shadow.kill()},n.revive=function(){this.scene.gameplay.spineManager.reviveSpine(this.spine),this.spine.animationState.clearTracks(),this.spine.skeleton.setBonesToSetupPose(),this.card.revive(),this.updateSize(),e.prototype.revive.call(this)},n.kill=function(){this.scene.gameplay.spineManager.killSpine(this.spine),e.prototype.kill.call(this)},t}(Pu),zl=Kl;function Vl(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return jl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jl(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Xl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).spine=void 0,t.resetCurrentAnimation=void 0,t.cancelCollectMapPiece=!1,t.isMapPieceCollected=!1,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.createMapPiece(),this.type=Qh.MAP_PIECE,this.cancelCollectMapPiece=!1,e.prototype.init.call(this)},n.onPlayerMove=function(){return this.collectMapPiece()},n.undo=function(){this.isMapPieceCollected=!1,this.card.add(this.spine)},n.getMapPieceWorldPosition=function(){return this.spine.getWorldPosition()},n.showFragment=function(){return this.scene.gameplay.spineManager.playAnimation(this.spine,Yu.MAP.MAP_FRAGMENT_APPEAR)},n.collectMapPiece=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMapPieceCollected){e.next=2;break}return e.abrupt("return");case 2:if(0!==(t=this.getAllTreasureMapCards()).length){e.next=7;break}return e.next=6,this.runDisappearMapPieceAnimation();case 6:return e.abrupt("return");case 7:return e.next=9,this.getNearestTreasureMapCard(t);case 9:if(n=e.sent,i=n.treasureCard,a=n.remainingMissingMapPieces,i&&-1!==a){e.next=16;break}return e.next=15,this.runDisappearMapPieceAnimation();case 15:return e.abrupt("return");case 16:this.effectedCard=i.card,this.runCollectMapPieceAnimation(i,a),this.isMapPieceCollected=!0;case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAllTreasureMapCards=function(){return this.boardGame.pile.cards.filter((function(e){return e.isType(Qh.TREASURE)})).map((function(e){return e.behavior}))},n.getNearestTreasureMapCard=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null,i=1/0,a=-1,r=Vl(t);case 4:if((s=r()).done){e.next=12;break}if(!(o=s.value).isMapCollectedAllPieces()){e.next=8;break}return e.abrupt("continue",10);case 8:(h=Phaser.Math.Distance.BetweenPoints(o.card,this.card))<i&&(i=h,n=o);case 10:e.next=4;break;case 12:if(!n){e.next=15;break}return a=n.getMissingMapPieceIndex(),e.abrupt("return",{treasureCard:n,remainingMissingMapPieces:a});case 15:return e.abrupt("return",{treasureCard:null,remainingMissingMapPieces:a});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runDisappearMapPieceAnimation=function(){var e,t=this;null==(e=this.resetCurrentAnimation)||e.call(this);var n=this.scene.add.tween({targets:this.spine,scale:0,duration:200,ease:Phaser.Math.Easing.Back.In,easeParams:[4],onComplete:function(){t.spine.kill()}});return this.resetCurrentAnimation=function(){n.stop()},n.waitForCompletion()},n.runCollectMapPieceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A,w,S=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(i=this.resetCurrentAnimation)||i.call(this),this.cancelCollectMapPiece=!1,this.card.setData("isMapPieceCollected",!1),a=8-n,r=t.getMapPiecePosition(a),s=r.x,o=r.y,h=this.spine.getWorldPosition(),u=h.x,l=h.y,this.card.remove(this.spine),this.scene.gameplayLayer.add(this.spine),this.spine.setPosition(u,l),this.spine.setAngle(this.card.angle),d=Math.abs(u-s),p=1+d/800,f=this.scene.gameplay.spineManager,this.spine.animationState.setEmptyAnimations(0),m=0===n,g="part_"+Math.max(Math.min(a,8),1),this.spine.skeleton.setAttachment("part_1",g),this.spine.skeleton.setAttachment("part_1_add2",g),null==(v=this.spine.skeleton.getAttachmentByName("part_1_add2",g))||v.color.set(0,0,0,0),m&&(this.scene.gameplay.setEnableCardInput(!1),this.boardGame.stock.setLockedManual(!0)),y=f.playAnimation(this.spine,Yu.MAP.MAP_FRAGMENT_COLLECT),E=[],C=this.scene.add.tween({targets:this.spine,angle:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),A=this.scene.add.tween({targets:this.spine,x:s,y:o,scale:.07,delay:300,duration:500*p,ease:Phaser.Math.Easing.Quartic.In}),E.push(C,A),this.resetCurrentAnimation=function(){E.forEach((function(e){return e.stop()})),S.spine.animationState.setEmptyAnimations(.1)},(w=[]).push(y),w.push(C.waitForCompletion()),w.push(A.waitForCompletion()),e.next=33,Promise.all(w);case 33:if(!this.cancelCollectMapPiece){e.next=35;break}return e.abrupt("return",Promise.resolve());case 35:return this.scene.gameplayLayer.add(this.spine),this.spine.kill(),this.scene.gameplayLayer.remove(this.spine),e.next=40,t.runAssembleMapPieceAnimation(this.card);case 40:m&&(this.scene.gameplay.setEnableCardInput(!0),this.boardGame.stock.setLockedManual(!1));case 41:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.revive=function(){if(e.prototype.revive.call(this),this.effectedCard){var t=this.effectedCard.behavior,n=t.getMissingMapPieces(),i=this.card.getData("isMapPieceCollected");t.setMissingMapPieces(n+1,i),t.runMapAppearAnimation()}},n.kill=function(){e.prototype.kill.call(this)},n.reviveItems=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cancelCollectMapPiece=!0,t=ru.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT,this.scene.tweens.killTweensOf(this.spine),this.spine.revive(),this.spine.setPosition(n/2-15+5,i/2-12.5+5),this.spine.setScale(.15,.15),e.next=8,this.showFragment();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.destroyItems=function(){var e;this.scene.gameplay.spineManager.killSpine(this.spine),null==(e=this.spine.parentContainer)||e.remove(this.spine),this.spine.destroy()},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.spine&&this.card.exists(this.spine)&&(this.spine.revive(),this.showFragment())},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.spine&&this.card.exists(this.spine)&&this.spine.kill()},n.createMapPiece=function(){var e=this.scene.add.spine(0,0,Wi.Z.MAP_SPINE.DATA_KEY,Wi.Z.MAP_SPINE.ATLAS_KEY),t=ru.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.setPosition(n/2-15+5,i/2-12.5+5),e.setScale(.15,.15),this.card.add(e),this.spine=e},t}(Iu),ql=Xl,Jl=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).nut=void 0,t.nutAnimation=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.createNut(),this.type=Qh.CHESTNUT,e.prototype.init.call(this)},n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.throwNutToBasket());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.throwNutToBasket=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=(t=this.boardGame.pile.cards.filter((function(e){return e.isType(Qh.SQUIRREL)}))).length){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if(this.effectedCard=this.getNearestSquirrelCard(t),(n=this.effectedCard.behavior).activate(),i=n.getRequiredUnlockNuts(),a=this.runThrowNutAnimation(n).then((function(){return n.runCollectNutAnimation(i)})),!(i<=0)){e.next=11;break}return e.next=11,a;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNearestSquirrelCard=function(e){var t=this,n=Phaser.Math.Distance.BetweenPoints(e[0],this.card),i=0;return e.forEach((function(e,a){var r=Phaser.Math.Distance.BetweenPoints(e,t.card);r<n&&(i=a,n=r)})),e[i]},n.undo=function(){var e;null==(e=this.nutAnimation)||e.stop(),this.nut.setPosition(18,25),this.nut.setAngle(0),this.nut.setAlpha(1),this.card.add(this.nut)},n.setFrameCardUp=function(){e.prototype.setFrameCardUp.call(this),this.nut&&this.card.exists(this.nut)&&this.nut.revive()},n.setFrameCardDown=function(t,n){e.prototype.setFrameCardDown.call(this,t,n),this.nut&&this.card.exists(this.nut)&&this.nut.kill()},n.createNut=function(){var e=Wi.Z.GAMEPLAY_OBJECTS,t=e.KEY,n=e.FRAME;this.nut=this.scene.add.image(0,0,t,n.CHESTNUT),this.nut.setScaleByWorld(1),this.nut.setPosition(18,25),this.card.add(this.nut)},n.runThrowNutAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.card,r=a.x,s=a.y,o=this.nut.getWorldPosition(),h=o.x,u=o.y,this.card.remove(this.nut),this.scene.gameplayLayer.add(this.nut),this.scene.gameplayLayer.bringToTop(t.basketContainer),this.scene.gameplayLayer.moveBelow(t.basketContainer,this.card),this.nut.setPosition(h,u),this.nut.setAngle(this.card.angle),l=Math.abs(h-r),d=h>=r?-360:360,p=Phaser.Math.Between(20+.2*l,30+.2*l),f=1+l/800,null==(n=this.nutAnimation)||n.stop(),(m=this.scene.tweens.createTimeline({onComplete:function(){g.nut.kill()}})).add({targets:this.nut,props:{angle:d,x:r+15},duration:600*f,ease:Phaser.Math.Easing.Sine.Out}),m.add({targets:this.nut,y:s-p,duration:300*f,offset:0,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.animateSquirrelBehavior.catch()}}),m.add({targets:this.nut,y:s+22,duration:300*f,ease:Phaser.Math.Easing.Sine.In,onUpdate:function(e){e.getValue()>=s+10&&g.scene.gameplayLayer.moveBelow(g.nut,t.basketContainer)}}),this.nutAnimation=m,e.next=20,null==(i=this.nutAnimation)?void 0:i.playAndWaitForCompletion();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.revive=function(){if(e.prototype.revive.call(this),this.effectedCard){var t=this.effectedCard.behavior,n=t.getRequiredUnlockNuts();t.setRequiredUnlockNuts(n+1)}},n.destroyItems=function(){this.nut.destroy()},n.reviveItems=function(){this.nut.revive(),this.nut.setDefaultWorldSize()},n.kill=function(){e.prototype.kill.call(this)},t}(Iu),Ql=Jl,$l=[Yu.SQUIRREL.FIND,Yu.SQUIRREL.IDLE,Yu.SQUIRREL.LOOK,Yu.SQUIRREL.IDLE],ed=function(){function e(e,t){this.scene=void 0,this.spine=void 0,this.spineManager=void 0,this.scene=e,this.spine=t,this.spineManager=this.scene.gameplay.spineManager}var t=e.prototype;return t.appear=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Yu.SQUIRREL.APPEAR).then((function(){return t.idle()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.disappear=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Yu.SQUIRREL.DISAPPEAR));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.catch=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.spineManager.playAnimation(this.spine,Yu.SQUIRREL.CATCH,!1,!0).then((function(){return t.idle()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.idle=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null==(t=this.spine.animationState.getCurrent(0))||null==(t=t.animation)?void 0:t.name,i=$l.filter((function(e){return e!==n})),a=Phaser.Utils.Array.GetRandom(i),e.abrupt("return",this.spineManager.playAnimation(this.spine,a).then((function(){return r.idle()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),td=ed,nd=Wi.Z.GAMEPLAY_OBJECTS,id=nd.KEY,ad=nd.FRAME,rd=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).basketContainer=void 0,t.animateSquirrelBehavior=void 0,t.requiredUnlockNuts=void 0,t.defaultNuts=void 0,t.nutsThrowingAnimation=void 0,t.nutParticles=void 0,t.basket=void 0,t.spine=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.keyUp=id,this.frameUp=ad.SQUIRREL_CARD,this.type=Qh.SQUIRREL,this.createBasketContainer(),this.createSpine(),this.createBasket(),this.createNutParticles(),this.animateSquirrelBehavior=new td(this.scene,this.spine),e.prototype.init.call(this)},n.activate=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requiredUnlockNuts-=1,!(this.requiredUnlockNuts>0)){e.next=3;break}return e.abrupt("return");case 3:this.removeFromPile();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.bringToTop=function(){e.prototype.bringToTop.call(this),this.scene.gameplayLayer.bringToTop(this.basketContainer)},n.runCollectNutAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.TICK),this.updateAcornsInBasket(this.defaultNuts-t),!(t<=0)){e.next=6;break}return e.next=5,(0,dl.Z)(this.scene,500);case 5:return e.abrupt("return",this.runExitAnimation());case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateAcornsInBasket=function(e){if(e>4)this.basket.setFrame(ad.BASKET_FOUR_ACORN);else switch(e){case 0:default:this.basket.setFrame(ad.BASKET);break;case 1:this.basket.setFrame(ad.BASKET_ONE_ACORN);break;case 2:this.basket.setFrame(ad.BASKET_TWO_ACORN);break;case 3:this.basket.setFrame(ad.BASKET_THREE_ACORN);break;case 4:this.basket.setFrame(ad.BASKET_FOUR_ACORN)}},n.createBasketContainer=function(){this.basketContainer=this.scene.add.container(0,0),this.scene.gameplayLayer.add(this.basketContainer)},n.createBasket=function(){var e=this.scene.add.image(15,22,id,ad.BASKET_TOP);this.basket=this.scene.add.image(0,0,id,ad.BASKET),e.setDefaultWorldSize(),this.basket.setDefaultWorldSize(),this.basket.setPosition(15,22),this.card.add(this.basket),this.basketContainer.add(e)},n.createNutParticles=function(){var e=1/GameCore.ImageScale,t=this.scene.add.particles(id,ad.CHESTNUT);this.nutsThrowingAnimation=t.createEmitter({on:!1,lifespan:{min:750,max:850},gravityY:1e3,scale:{min:.8*e,max:1*e},speedX:{min:-50,max:50},speedY:{min:-300,max:-200},rotate:{start:-360,end:360,random:!0},alpha:{start:1,end:.8,ease:Phaser.Math.Easing.Quadratic.In}}),this.scene.gameplayLayer.add(t),this.nutParticles=t},n.setFacingWithFlippingAnim=function(t,n,i){var a=this;return t||this.killItems(),e.prototype.setFacingWithFlippingAnim.call(this,t,n,i,(function(){a.reviveItems(),a.animateSquirrelBehavior.appear()}))},n.setDefaultRequiredNuts=function(e){this.defaultNuts=e,this.setRequiredUnlockNuts(e)},n.setRequiredUnlockNuts=function(e){this.requiredUnlockNuts=e,this.updateAcornsInBasket(this.defaultNuts-e)},n.getRequiredUnlockNuts=function(){return this.requiredUnlockNuts},n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.animateSquirrelBehavior.disappear(),(t=this.scene.tweens.createTimeline({onComplete:function(){n.kill(),n.boardGame.pile.refresh()}})).add({targets:[this.card,this.spine,this.basketContainer],duration:300,props:{alpha:0},delay:500,onStart:function(){n.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),n.runThrowNutsAnimation()}}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runThrowNutsAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.basket.getWorldPosition(),n=t.x,i=t.y,this.scene.gameplayLayer.bringToTop(this.nutParticles),this.nutsThrowingAnimation.explode(5,n,i);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runReviveAnimation=function(){var e=this;this.updateSize();var t=this.card.scale;this.spine.setAlpha(1),this.basketContainer.setAlpha(1),this.card.setScale(.2);var n=this.scene.tweens.createTimeline();n.add({targets:[this.card,this.basketContainer],duration:500,ease:Phaser.Math.Easing.Back.Out,props:{scale:{from:.2,to:t}},offset:0,onComplete:function(){e.updateSize()},onStart:function(){e.card.jump(10,500)}}),n.play(),this.card.jump(10,500)},n.setFrameCardUp=function(){var t,n;e.prototype.setFrameCardUp.call(this),null==(t=this.basketContainer)||t.revive(),null==(n=this.basket)||n.revive()},n.setFrameCardDown=function(t,n){var i,a;e.prototype.setFrameCardDown.call(this,t,n),null==(i=this.basketContainer)||i.kill(),null==(a=this.basket)||a.kill()},n.revive=function(){e.prototype.revive.call(this),this.scene.gameplayLayer.moveAbove(this.basketContainer,this.card),this.spine.revive(),this.animateSquirrelBehavior.idle(),this.runReviveAnimation()},n.reviveItems=function(){this.basketContainer.revive()},n.killItems=function(){this.basketContainer.kill()},n.kill=function(){e.prototype.kill.call(this)},n.destroyItems=function(){this.basketContainer.destroy(),this.nutParticles.destroy()},n.update=function(){var e=this.card,t=e.x,n=e.y,i=e.rotation,a=e.scaleX,r=e.scaleY;this.basketContainer.setPosition(t,n),this.basketContainer.setScale(a,r),this.basketContainer.setRotation(i),Phaser.Math.RotateAround(this.basketContainer,t,n,i)},n.createSpine=function(){var e=this.scene.gameplay.spineManager;this.spine=e.createSpine(0,0,Wi.Z.SQUIRREL_SPINE.DATA_KEY,Wi.Z.SQUIRREL_SPINE.ATLAS_KEY),e.killSpine(this.spine),this.spine.setPosition(5,27),this.card.add(this.spine)},t}(Pu),sd=rd,od=(Wi.Z.CARD_BACK,Wi.Z.GAMEPLAY),cd=od.KEY,hd=(od.FRAME,{id:1,x:100,y:100,angle:0,depth:ru.DEPTH.CARD,type:Qh.VALUE,random:!0,faceUp:!1,modifiers:[],sequence:0,suit:1,value:0,isPosUpdated:!1,NumberOfMoves:0,CardChangerType:0,connectedCardID:-1}),ud=function(e){function t(t,n,i){var r;(r=e.call(this,t,0,0)||this).id=void 0,r.scene=void 0,r.payload=void 0,r.facingTween=void 0,r.movingTween=void 0,r.rotateTween=void 0,r.shakeTween=void 0,r.isMoving=void 0,r.behavior=void 0,r.beginPlacement=void 0,r.cardBackground=void 0,r.cardImage=void 0,r.shadow=void 0,r.isLock=void 0,r.isBlur=void 0,r.isMysterious=void 0,r.jumpTween=void 0,r.movingBehavior=void 0,r.blurAnimation=void 0,r.flipRotateTween=void 0,r.scene=t,r.movingBehavior=new Ul((0,fc.Z)(r));var s=ru.CARD_VIEW_OFFSET,o=s.x,c=s.y;return r.cardBackground=t.make.image({x:o,y:c,key:Wi.Z.GAMEPLAY_OBJECTS.KEY,frame:Wi.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD}),r.cardBackground.setDefaultWorldSize(),r.cardBackground.setName("Card Background"),r.cardBackground.kill(),r.cardImage=t.make.image({x:o,y:c,key:cd,frame:""}),r.add([r.cardBackground,r.cardImage]),r.isMoving=!1,r.isMysterious=!1,r.isLock=!1,r.isBlur=!1,r.beginPlacement=n,r.z=0,r.payload=(0,a.Z)({},hd,i),1==r.payload.random&&(r.payload.value=Phaser.Math.Between(1,13)),r.shadow=new bu(r.scene,(0,fc.Z)(r)),r.scene.gameplayLayer.add(r.shadow),r.shadow.kill(),r.scene.add.existing((0,fc.Z)(r)),r.id=GameCore.Utils.String.generateObjectId(),r}(0,s.Z)(t,e);var n=t.prototype;return n.setBehavior=function(e){this.behavior;var t=void 0;e==Qh.LOCK&&(t=new al(this)).setData(this.payload),e==Qh.KEY&&(t=new Ju(this)).setData(this.payload),e==Qh.VALUE&&(t=new Iu(this)).setData(this.payload),e==Qh.ZAP&&(t=new ll(this)).setData(this.payload),e==Qh.BOOM&&(t=new _u(this)).setData(this.payload),e==Qh.SQUIRREL&&(t=new sd(this)).setData(this.payload),e==Qh.CHESTNUT&&(t=new Ql(this)).setData(this.payload),e==Qh.TREASURE&&(t=new zl(this)).setData(this.payload),e==Qh.MAP_PIECE&&(t=new ql(this)).setData(this.payload),e==Qh.PLUS_ONE&&(t=new hl(this,1)).setData(this.payload),e==Qh.PLUS_TWO&&(t=new hl(this,2)).setData(this.payload),e==Qh.PLUS_THREE&&(t=new hl(this,3)).setData(this.payload),e==Qh.PLUS_FOUR&&(t=new hl(this,4)).setData(this.payload),e==Qh.PLUS_FIVE&&(t=new hl(this,5)).setData(this.payload),e==Qh.CHANGER&&(t=new Wu(this)).setData(this.payload),e==Qh.JOKER&&(t=new yl(this)),e==Qh.WINDMILL&&(t=new Pl(this)),e==Qh.MYSTERIOUS&&(t=new Bl(this)),e==Qh.CHAIN&&(t=new Gl(this)),t||(t=new wu(this)),this.behavior=t,t.init()},n.moveWithRotate=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.x,s=t.y,o=t.showShadow,h=void 0===o||o,u=t.duration,l=void 0===u?0:u,d=t.delay,p=void 0===d?0:d,f=t.onStart,m=t.onComplete,r!=this.x||s!=this.y){e.next=3;break}return e.abrupt("return");case 3:if(!this.isMoving){e.next=5;break}return e.abrupt("return");case 5:return null!=(n=this.shakeTween)&&n.isPlaying()&&this.shakeTween.pause(),null==(i=this.movingTween)||i.stop(),null==(a=this.rotateTween)||a.stop(),this.movingTween=this.scene.tweens.createTimeline(),g=Phaser.Math.Between(50,70)+.2*this.y,v=this.scene.gameZone.width/2,y=this.x>=v?-360:360,this.movingTween.add({targets:[this],props:{angle:{from:this.angle,to:y},x:{from:this.x,to:r}},duration:l,offset:p,onStart:f,ease:Phaser.Math.Easing.Sine.Out}),this.movingTween.add({targets:this,y:this.y-g,duration:.4*l,offset:p,ease:Phaser.Math.Easing.Sine.Out}),this.movingTween.add({targets:this,y:s,duration:.6*l,offset:p+.4*l,ease:Phaser.Math.Easing.Sine.In}),h&&this.jump(50,l,0,p),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,l+p),this.isMoving=!0,e.next=21,this.movingTween.playAndWaitForCompletion();case 21:this.isMoving=!1,m&&m();case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.rotate=function(e,t){this.scene.tweens.add({targets:[this],duration:t,props:{angle:{from:this.angle,to:e}}})},n.jump=function(e,t,n,i){var a,r=this;return null==(a=this.jumpTween)||a.remove(),this.jumpTween=this.scene.tweens.add({targets:this,z:{from:0,to:e},yoyo:!0,duration:t/2,delay:i,repeat:n,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){r.setZ(0)}}),this.jumpTween},n.move=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.x,r=t.y,s=t.showShadow,o=void 0===s||s,h=t.duration,u=void 0===h?0:h,l=t.delay,d=void 0===l?0:l,p=t.onStart,f=t.onComplete,a!=this.x||r!=this.y){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return null==(n=this.movingTween)||n.stop(),null==(i=this.rotateTween)||i.stop(),(m=this.scene.tweens.createTimeline({onStart:function(){p&&p()},onComplete:function(){g.isMoving=!1,f&&f()}})).add({targets:this,x:a,y:r,duration:u,delay:d,ease:Phaser.Math.Easing.Sine.Out}),m.play(),this.movingTween=m,o&&this.jump(10,u,0,d),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,u+d),this.isMoving=!0,e.abrupt("return",m.waitForCompletion());case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.fly=function(e,t){var n,i=this;return null==(n=this.jumpTween)||n.remove(),this.jumpTween=this.scene.tweens.add({targets:this,z:{from:0,to:e},yoyo:!0,duration:t/2,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){i.setZ(0)}}),this.jumpTween},n.moveByPulled=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m,g,v,y=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.x,o=n.y,h=n.showShadow,u=void 0===h||h,l=n.duration,d=void 0===l?0:l,p=n.delay,f=void 0===p?0:p,m=n.onStart,g=n.onComplete,s!=this.x||o!=this.y){e.next=3;break}return e.abrupt("return");case 3:return null==(i=this.movingTween)||i.stop(),null==(a=this.rotateTween)||a.stop(),null!=(r=this.shakeTween)&&r.isPlaying()&&this.shakeTween.pause(),this.movingTween=this.scene.tweens.createTimeline(),this.movingTween.add({targets:this,x:s,y:o,duration:d,offset:f,ease:Phaser.Math.Easing.Sine.Out,onStart:m,onComplete:function(){y.isMoving=!1,g&&g()}}),v=this.angle+30,t&&(v=this.angle-30),this.movingTween.add({targets:this,angle:v,duration:d/2,offset:f,ease:Phaser.Math.Easing.Sine.InOut}),this.movingTween.add({targets:this,angle:0,duration:d/2,offset:f+d/2,ease:Phaser.Math.Easing.Sine.InOut}),u&&this.jump(10,d,0,f),this.scene.gameplay.boardGame.deck.setLastMovingCard(this,d+f),this.isMoving=!0,e.abrupt("return",this.movingTween.playAndWaitForCompletion());case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.flipRotate=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(i=this.flipRotateTween)||!i.isPlaying()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return a=this.scene.tweens.createTimeline(),r=t/2,a.add({targets:this,angle:{from:0,to:n},duration:r,onYoyo:function(){s.behavior.setFrameCardDown()}}),a.add({targets:this,scaleX:{from:1,to:0},yoyo:!0,offset:0,duration:r/4,onYoyo:function(){s.behavior.setFrameCardDown()}}),a.add({targets:this,scaleX:{from:1,to:0},yoyo:!0,duration:r/2,offset:r/2,onYoyo:function(){s.behavior.setFrameCardUp()}}),a.add({targets:this,angle:{from:n,to:0},duration:r,offset:r,onYoyo:function(){s.behavior.setFrameCardDown()}}),this.flipRotateTween=a,e.abrupt("return",a.playAndWaitForCompletion());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.isOnAnimation=function(){return 0!=this.scene.tweens.getTweensOf(this).length},n.moveToTopLayer=function(){if(!this.isLock){var e=this.behavior;if(e instanceof Gl){if(e.connectedCard.isLock)return;this.scene.gameplayLayer.bringToTop(this.shadow),this.scene.gameplayLayer.bringToTop(this),e.moveToTopLayer()}else this.scene.gameplayLayer.bringToTop(this.shadow),this.scene.gameplayLayer.bringToTop(this)}},n.setLock=function(e){this.isLock=e,e?(this.setBlur(!0),this.disableInteractive()):(this.setBlur(!1),this.setInteractive({useHandCursor:!0}))},n.setBlur=function(e){var t;this.isBlur!=e&&(this.isBlur=e,null==(t=this.blurAnimation)||t.remove(),this.blurAnimation=e?this.scene.tweens.add({targets:this,alpha:.7,duration:300}):this.scene.tweens.add({targets:this,alpha:1,duration:300}))},n.setCardFrame=function(e,t){!isNaN(Number(t.split("/")[1]))?this.cardBackground.revive():this.cardBackground.kill(),this.cardImage.setTexture(e,t)},n.revive=function(){e.prototype.revive.call(this),this.setAlpha(1)},n.setPosition=function(t,n,i,a){return e.prototype.setPosition.call(this,t,n,this.z,a)},n.getRotatedRectangle=function(){var e=this.cardImage.getTopLeft(),t=this.cardImage.getTopRight(),n=this.cardImage.getBottomLeft(),i=[e,t,this.cardImage.getBottomRight(),n];return Phaser.Geom.Rectangle.FromPoints(i)},n.shake=function(e,t,n){var i,a;void 0===n&&(n=!0),this.isMoving||null!=(i=this.shakeTween)&&i.isPlaying()||(null!=(a=this.shakeTween)&&a.paused?this.shakeTween.play():(this.shakeTween=mu(this.scene,{targets:[this],currentAngle:this.angle,duration:t,shakingAngle:e}),n&&this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.MISS_TAP_CARD)))},n.isType=function(){if(0==this.active)return!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.behavior.type)},n.kill=function(){e.prototype.kill.call(this),this.behavior.kill(),this.shadow.kill()},n.setInteractive=function(t,n,i){return e.prototype.setInteractive.call(this,(0,a.Z)({},t,{useHandCursor:!0}),n,i)},n.update=function(e){this.behavior.update(e)},n.postUpdate=function(){if(this.shadow.setVisible(this.z>0&&this.visible),this.shadow.visible){this.shadow.updateFromParent();var e=1/GameCore.ImageScale;this.shadow.setScaleFromParent(this.scaleX*e,this.scaleY*e);var t=this.x+.33*this.z,n=this.y+this.z;this.shadow.setPosition(t,n)}this.behavior.postUpdate()},t}(Phaser.GameObjects.Container),ld=function(){function e(){this.currentRatio=void 0,this.matchRatio=void 0,this.commonDifference=void 0,this.hardRatio=void 0,this.currentRatio=0,this.matchRatio=0,this.commonDifference=0,this.hardRatio=1}var t=e.prototype;return t.setHardRatioByCoins=function(e){var t=1;t=e<=500?1.5:e>=1e4?1:1.5-(e-500)/9500*.5,this.hardRatio=t},t.setConfig=function(e,t){this.matchRatio=e,this.commonDifference=t},t.reset=function(){this.currentRatio=this.matchRatio*this.hardRatio},t.onRandomCanNotMatch=function(){var e=this.commonDifference;this.currentRatio=Math.min(this.currentRatio+e*this.hardRatio,100)},t.getMatchRatio=function(){return this.currentRatio/100},t.setCurrentRatio=function(e){this.currentRatio=e},e}(),dd=function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.cards=void 0,this.lastMovingCard=void 0,this.matchRatioCalculator=void 0,this.postUpdate=function(){t.cards.forEach((function(e){return e.active&&e.postUpdate()}))},this.boardGame=e,this.scene=e.scene,this.cards=[],this.matchRatioCalculator=new ld,this.scene.events.on("postupdate",this.postUpdate,this),this.matchRatioCalculator.reset()}var t=e.prototype;return t.setLastMovingCard=function(e,t){if(this.lastMovingCard){var n=this.lastMovingCard,i=n.card,a=n.duration;(1-i.movingTween.progress)*a<t&&(this.lastMovingCard={card:e,duration:t})}else this.lastMovingCard={card:e,duration:t}},t.getCard=function(e){return this.cards.find((function(t){return t.id==e}))},t.getNewCard=function(e,t){var n=new ud(this.scene,e,t);return this.scene.gameplayLayer.add(n),this.cards.push(n),n},t.getJokerCard=function(){var e=this.getNewCard(tu.None);return e.setBehavior(Qh.JOKER),e.behavior.setFrameCardUp(),e},t.getWindmillCard=function(){var e=this.getNewCard(tu.Stock);return e.setBehavior(Qh.WINDMILL),e.behavior.setFrameCardUp(),e},t.getNewStockCard=function(){var e=this.getNewCard(tu.Stock);return e.setBehavior(),e},t.getMatchesForPile=function(e,t){var n=function(n){if(!n.behavior.random){var i=n.behavior.value;n.behavior instanceof Wu&&(i=n.behavior.getNextValue()),e.forEach((function(n,a){if(!(n.value<0||n.suit<0)){var r=Math.abs(i-n.value);1!=r&&12!=r||(t.push(n),e[a]={suit:-1,value:-1})}}))}};this.boardGame.pile.getFrontCards().forEach(n);var i=this.boardGame.waste.getOnTopCard();i&&n(i)},t.getRandomValue=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e[Phaser.Math.Between(0,51)]},t.getRandomPileCard=function(){var e=this.getAllCardData(),t=this.boardGame.pile.getFrontCards(),n=e.filter((function(e){var n=e.value,i=e.suit;return!t.some((function(e){return e.behavior.value==n&&e.behavior.suit==i}))}));return n[Phaser.Math.RND.between(0,n.length-1)]},t.getAllCardData=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e},t.getRandomValueByMatchRatio=function(){for(var e=this.matchRatioCalculator.getMatchRatio(),t=[],n=[],i=[],a=1;a<=4;a++)for(var r=1;r<=13;r++)t.push({suit:a,value:r});if(this.getMatchesForPile(t,n),0==n.length)return this.getRandomValue();t.forEach((function(e){e.value>0&&e.suit>0&&i.push(e)}));for(var s=i.length-Math.min(Math.round(i.length*(1-e)),2*n.length),o=0;o<s;o++){var c=Phaser.Math.Between(0,i.length-1);if(i.splice(c,1),i.length<1)break}var h=[].concat(n,i),u=[].concat(this.boardGame.pile.getFrontCards()),l=this.boardGame.waste.getOnTopCard();l&&u.push(l);for(var d=h.filter((function(e){var t=e.value,n=e.suit;return!u.some((function(e){return e.behavior.value==t&&e.behavior.suit==n}))})),p=Phaser.Math.Between(0,d.length-1),f=0;f<2;f++){if(!u.some((function(e){return e.behavior.value==d[p].value})))break;p=Phaser.Math.Between(0,d.length-1)}var m=d[p];return n.includes(m)?this.matchRatioCalculator.reset():this.matchRatioCalculator.onRandomCanNotMatch(),m},t.clear=function(){this.cards.forEach((function(e){var t;null==(t=e.behavior)||t.destroyItems(),e.shadow.destroy(),e.destroy()})),this.cards=[],this.matchRatioCalculator.reset()},e}(),pd=function(e){function t(t){var n;return(n=e.call(this,t)||this).collectedCardCount=0,n.draw=function(){var e=(0,r.Z)(c().mark((function e(t,i){var a,r,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=800),t&&!t.isMoving){e.next=3;break}return e.abrupt("return");case 3:if(n.boardGame.hint.resetAutoHintTime(),!n.checkOverlap(t)){e.next=8;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 8:if(0!=t.behavior.facingUp&&(null==(a=t.behavior)?void 0:a.type)!==Qh.LOCK&&(null==(r=t.behavior)?void 0:r.type)!==Qh.SQUIRREL&&(null==(s=t.behavior)?void 0:s.type)!==Qh.TREASURE){e.next=12;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 12:if(o=n.boardGame.waste,h=o.getOnTopCard()){e.next=18;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 18:if(n.isMatch(t,h)){e.next=23;break}return t.shake(8,800),n.boardGame.increaseClickOnUnmatchedCardCount(),e.abrupt("return");case 23:return n.boardGame.mover.increaseMoves(),n.collectedCardCount+=1,n.scene.events.emit(Tu.Z.COLLECT_CARD,t),n.emitUseWildCardTaskEvent(h),n.handleMatch(t),u=n.canUnlockBreakers(t),e.next=32,t.behavior.activate(u);case 32:return n.refresh(),e.next=35,n.boardGame.onPlayerMove();case 35:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.setName(tu.Pile),n}(0,s.Z)(t,e);var n=t.prototype;return n.getCollectedCardCount=function(){return this.collectedCardCount},n.setNutsInSquirrel=function(){var e=this.cards.filter((function(e){return e.isType(Qh.CHESTNUT)})),t=this.cards.filter((function(e){return e.isType(Qh.SQUIRREL)}));if(0!=e.length&&0!=t.length){var n=Math.floor(e.length/t.length),i=e.length;t.forEach((function(e,a){a===t.length-1&&(n=i),i-=n,e.behavior.setDefaultRequiredNuts(n)}))}},n.setTreasureMapCards=function(){var e=this.cards.filter((function(e){return e.isType(Qh.MAP_PIECE)})),t=this.cards.filter((function(e){return e.isType(Qh.TREASURE)}));if(0!=e.length&&0!=t.length){var n=t.length,i=e.length,a=8*n-i,r=Array.from({length:n},(function(e,t){var i=Math.floor(a/n);return t<a%n?i+1:i}));t.forEach((function(e){var t=8-(r.shift()||0);e.behavior.setMissingMapPieces(t)}))}},n.connectChainCard=function(){var e=this.cards.filter((function(e){return e.isType(Qh.CHAIN)}));e.forEach((function(t){var n=e.find((function(e){return e.payload.id!==t.payload.id&&e.payload.connectedCardID==t.payload.connectedCardID})),i=t.behavior;i.setConnectedCard(n),i.initRope()}))},n.clear=function(){e.prototype.clear.call(this)},n.clearHistoryCollectedCards=function(){this.collectedCardCount=0},n.addCard=function(t){var n=this;e.prototype.addCard.call(this,t),t.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),t.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){n.boardGame.gameplay.enableCardInput&&n.boardGame.stateMachine.emit(Jh.DRAW_PILE,t)})),t.setInteractive({useHandCursor:!0})},n.handleMatch=function(e){var t=this.boardGame.mover,n=this.boardGame.gameplay.comboManager;this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.DRAW_CARD),this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.START_MOVE_TO_WASTE),t.addUndoCard(e,tu.Pile,tu.Waste),n.increaseComboWithSound(e)},n.getLockCards=function(){return this.cards.filter((function(e){return e.behavior instanceof al}))},n.canUnlockBreakers=function(e){return this.boardGame.locks.some((function(t){return t.isMatch(e)}))},n.handleWithLock=function(e){for(var t=this.boardGame.locks,n=0;n<t.length;n++){var i=t[n];if(0==i.isUnlock){var a=i.unlockSegment(e);if(a)return a}}},n.isMatch=function(e,t){var n,i;if(e.isBlur||t.isBlur)return!1;if((null==(n=e.behavior)?void 0:n.type)==Qh.JOKER||(null==(i=t.behavior)?void 0:i.type)==Qh.JOKER)return!0;if(0==e.behavior.checkCardHasValue())return!1;var a=Math.abs(t.behavior.value-e.behavior.value);return 1==a||12==a},n.getFrontCards=function(){var e=this;return this.cards.filter((function(t){if(!t.isBlur&&t.behavior.checkCardHasValue()&&!e.checkOverlap(t))return t}))},n.getDownCards=function(){var e=this;return this.cards.filter((function(t){if(!t.isBlur&&t.behavior.checkCardHasValue()&&e.checkOverlap(t))return t}))},n.isOverLap=function(e,t){for(var n=e.behavior.getPoints(),i=t.behavior.getPoints(),a=0;a<4;a++)for(var r=3==a?0:a+1,s=new Phaser.Geom.Line(n[a].x,n[a].y,n[r].x,n[r].y),o=0;o<4;o++){var c=3==o?0:o+1,h=new Phaser.Geom.Line(i[o].x,i[o].y,i[c].x,i[c].y);if(Phaser.Geom.Intersects.LineToLine(s,h))return!0}return!1},n.checkOverlap=function(e){for(var t=this.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),n=0;n<t.length;n++){if(this.isOverLap(t[n],e))return t[n]}},n.refresh=function(){this.flipCards(),this.boardGame.lockCards(),this.updateChainCards()},n.flipCards=function(){var e=this;this.cards.forEach((function(t){e.checkOverlap(t)?0==t.payload.faceUp&&t.behavior.setFacingWithFlippingAnim(!1):t.behavior.setFacingWithFlippingAnim(!0)}))},n.flipCardsStagger=function(){var e=this;return new Promise((function(t){var n=e.cards.filter((function(t){if(t.behavior instanceof Pu){var n=e.checkOverlap(t);return t.payload.faceUp||!n}})),i=e.scene.time.addEvent({delay:60,repeat:n.length-1,callback:function(){var a=n.shift();a&&(a.behavior.setFacingWithFlippingAnim(!0),e.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.OPEN_CARD),0==i.repeatCount&&t())}})}))},n.updateChainCards=function(){this.cards.filter((function(e){return e.isType(Qh.CHAIN)})).forEach((function(e){return e.behavior.refresh()}))},n.animateChainCards=function(){var e=this;this.cards.forEach((function(e){e.behavior instanceof Gl&&e.behavior.hideChain(!1)})),this.scene.time.delayedCall(500,(function(){e.cards.forEach((function(e){e.behavior instanceof Gl&&e.behavior.showChain(!0)}))}))},n.getCardsWithType=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.cards.filter((function(t){return t.isType.apply(t,n)&&!t.isBlur&&!e.checkOverlap(t)}))},n.emitUseWildCardTaskEvent=function(e){e.behavior.type===Qh.JOKER&&Xh.emit(Kh.USE_WILDCARDS.EVENTS.USE_WILDCARD,{type:"wildCards",value:1})},t}(hu),fd=function(e){function t(t){var n;return(n=e.call(this,t)||this).setName(tu.Waste),n}(0,s.Z)(t,e);var n=t.prototype;return n.refresh=function(){this.getOnTopCard()},n.addCard=function(t){e.prototype.addCard.call(this,t),t.disableInteractive()},n.setY=function(e){this.cards.forEach((function(t){return t.setY(e)})),this.y=e},n.removeCard=function(t){var n=e.prototype.removeCard.call(this,t),i=this.getOnTopCard();return i&&i.behavior.show(),n},n.getOnTopCard=function(){if(0!=this.cards.length){var e=this.cards.length;return this.cards[e-1]}},n.clear=function(){e.prototype.clear.call(this)},n.addCounterKillItem=function(){var e=this,t=this.getOnTopCard(),n=this.cards[this.cards.length-2];t&&n&&this.scene.tweens.addCounter({onUpdate:function(e){0==t.isMoving&&e.complete()},completeDelay:150,onComplete:function(){e.cards[e.cards.length-2]===n&&e.cards.some((function(e){return n===e}))&&n.behavior.hide()}})},t}(hu),md=function(){function e(e,t){this.scene=void 0,this.operationData=void 0,this.scene=e,this.operationData=t}var t=e.prototype;return t.undo=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.operationData,n=t.cardState,i=t.originalPlacement,t.toPlacement,this.scene.gameplay.boardGame.deck.getCard(n.id)){e.next=4;break}return e.abrupt("return");case 4:i==tu.Pile&&this.returnPile(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.returnPile=function(e){var t=e.x,n=e.y,i=e.id,a=e.angle,r=this.scene.gameplay.boardGame,s=r.deck,o=r.waste,c=r.pile,h=s.getCard(i);h&&(h.rotate(a,300),h.move({x:t,y:n,duration:300}),this.operationData.toPlacement==tu.Waste&&(o.removeCard(h),c.addCard(h)))},e}(),gd=md,vd=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).vertexes=void 0,n.flag=void 0,n.setOrtho(1,1),n.hideCCW=!1,t.add.existing((0,fc.Z)(n)),n.setVertexes([{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}]),n.scene.events.on(Phaser.Scenes.Events.PRE_RENDER,n.update,(0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.resetTransforms=function(){this.setVertexes([{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}])},n.triggerFlag=function(){this.flag=!0},n.update=function(){if(this.flag){this.faces=[];var e=this.vertexes,t=this.findIntersectionPointOfTwoLines(e[0].x,e[0].y,e[2].x,e[2].y,e[1].x,e[1].y,e[3].x,e[3].y);if(!t)throw new Error("Invalid vertexes");for(var n=this.getVertex(t,{x:0,y:0}),i=[{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}],a=this.getVertex(e[e.length-1],i[e.length-1]),r=0;r<4;r++){var s=this.getVertex(e[r],i[r]);this.addFace(n,a,s),a=s}this.flag=!1}},n.setTexture=function(t,n){return e.prototype.setTexture.call(this,t,n),this.flag=!0,this},n.kill=function(){this.setVisible(!1),this.setActive(!1)},n.revive=function(){this.setVisible(!0),this.setActive(!0)},n.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},n.setWorldSize=function(e,t){this.setSize(e,t),this.flag=!0},n.findIntersectionPointOfTwoLines=function(e,t,n,i,a,r,s,o){var c=(e-n)*(r-o)-(t-i)*(a-s);return 0===c?null:{x:((e*i-t*n)*(a-s)-(e-n)*(a*o-r*s))/c,y:((e*i-t*n)*(r-o)-(t-i)*(a*o-r*s))/c}},n.setVertexes=function(e){if(4!=e.length)throw new Error("Vertexes must have 4 points");this.vertexes=e,this.flag=!0},n.getVertex=function(e,t){var n=e.x,i=e.y,a=this.frame,r=a.u0,s=a.v0,o=a.u1,c=a.v1-s,h=r+(o-r)*(.5+t.x),u=s+c*(.5+t.y);return new Phaser.Geom.Mesh.Vertex(n,-i,0,h,u)},n.addFace=function(e,t,n){var i=new Phaser.Geom.Mesh.Face(e,t,n);return i.transformCoordinatesLocal(this.transformMatrix,this.width,this.height,this.z),this.faces.push(i),this},n.cancelAnimations=function(){this.scene.tweens.killTweensOf(this.vertexes[0]),this.scene.tweens.killTweensOf(this.vertexes[1]),this.scene.tweens.killTweensOf(this.vertexes[2]),this.scene.tweens.killTweensOf(this.vertexes[3])},n.transformTo=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(4==t.length){e.next=2;break}throw new Error("Vertexes must have 4 points");case 2:return i=this.scene.tweens.add((0,a.Z)({targets:this.vertexes[0],props:{x:t[0].x,y:t[0].y},onUpdate:function(){h.triggerFlag()}},n)).waitForCompletion(),r=this.scene.tweens.add((0,a.Z)({targets:this.vertexes[1],props:{x:t[1].x,y:t[1].y},onUpdate:function(){h.triggerFlag()}},n)).waitForCompletion(),s=this.scene.tweens.add((0,a.Z)({targets:this.vertexes[2],props:{x:t[2].x,y:t[2].y},onUpdate:function(){h.triggerFlag()}},n)).waitForCompletion(),o=this.scene.tweens.add((0,a.Z)({targets:this.vertexes[3],props:{x:t[3].x,y:t[3].y},onUpdate:function(){h.triggerFlag()}},n)).waitForCompletion(),e.next=8,Promise.all([i,r,s,o]);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getAlignedPosition=function(e){var t=this.calcAlignedScalar(e),n=t.x,i=t.y,a=n*Math.cos(-this.rotation)-i*Math.sin(-this.rotation),r=n*Math.sin(-this.rotation)+i*Math.cos(-this.rotation),s=this.width*a,o=this.height*r;return{x:this.x+s,y:this.y+o}},n.calcAlignedScalar=function(e){switch(e){case"center":return{x:this.vertexes[0].x+this.vertexes[1].x+this.vertexes[2].x+this.vertexes[3].x,y:this.vertexes[0].y+this.vertexes[1].y+this.vertexes[2].y+this.vertexes[3].y};case"bottom":return{x:t.getMiddleOf(this.vertexes[2].x,this.vertexes[3].x),y:t.getMiddleOf(this.vertexes[2].y,this.vertexes[3].y)};case"top":return{x:t.getMiddleOf(this.vertexes[0].x,this.vertexes[1].x),y:t.getMiddleOf(this.vertexes[0].y,this.vertexes[1].y)};case"left":return{x:t.getMiddleOf(this.vertexes[0].x,this.vertexes[3].x),y:t.getMiddleOf(this.vertexes[0].y,this.vertexes[3].y)};case"right":return{x:t.getMiddleOf(this.vertexes[1].x,this.vertexes[2].x),y:t.getMiddleOf(this.vertexes[1].y,this.vertexes[2].y)}}},n.calcVerticesFromShear=function(e,n){return t.calcVerticesFromShear(e,n)},t.calcVerticesFromShear=function(e,t){var n=.5,i=Phaser.Math.DegToRad(e),a=Phaser.Math.DegToRad(-t),r=[Math.cos(i)*n,Math.sin(i)*n],s=[Math.sin(a)*n,Math.cos(a)*n];return[{x:-r[0]+s[0],y:r[1]-s[1]},{x:r[0]+s[0],y:-r[1]-s[1]},{x:r[0]-s[0],y:-r[1]+s[1]},{x:-r[0]-s[0],y:r[1]+s[1]}]},t.getMiddleOf=function(e,t){var n=Math.min(e,t);return n+(Math.max(e,t)-n)/2},t}(Phaser.GameObjects.Mesh),yd=vd,Ed=yd.calcVerticesFromShear(.28279,65.16991),Cd=yd.calcVerticesFromShear(-.28279,-65.16991),Ad=yd.calcVerticesFromShear(10.03711,59.04073),wd=yd.calcVerticesFromShear(-10.03711,-59.04073),Sd=yd.calcVerticesFromShear(-6.37585,-26.18271),bd=yd.calcVerticesFromShear(6.37585,26.18271),Td=function(e){function t(t,n,i){var a;return void 0===n&&(n=Wi.Z.GAMEPLAY_OBJECTS.KEY),void 0===i&&(i=Wi.Z.GAMEPLAY_OBJECTS.FRAME.SLICE_CARD),(a=e.call(this,t)||this).cancelCurrentAnimation=void 0,a.setTexture(n,i),a.setWorldSize(54,78),a.setDepth(99999),a}(0,s.Z)(t,e);var n=t.prototype;return n.cancelAnimations=function(){var e;this.scene.tweens.killTweensOf(this),null==(e=this.cancelCurrentAnimation)||e.call(this)},n.runAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.targets,i=t.isShadow,a=t.interlaceRightLeftRight,r=void 0===a||a,s=t.startingPosition,o=t.startingScale,h=void 0===o?1.4:o,u=t.lastCardBehaviour,l=void 0===u?"hide":u,d=t.onHit,p=t.onWindup,f=t.onPositionChanged,0!==n.length){e.next=3;break}return e.abrupt("return");case 3:return m=this.interlaceTargets(n,r),g=r,v=!1,this.cancelCurrentAnimation=function(){v=!0},e.next=9,this.playWindUpAnimation(m[0],g,s,h,i,f);case 9:if(!v){e.next=11;break}return e.abrupt("return");case 11:y=0;case 12:if(!(y<m.length)){e.next=24;break}if(!v){e.next=15;break}return e.abrupt("return");case 15:return E=m[y],null==p||p(E),C=y===m.length-1?l:"anticipate",e.next=20,this.playSliceAnimation(E,g,C,i,d,f);case 20:g=!g;case 21:y++,e.next=12;break;case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.interlaceTargets=function(e,t){void 0===t&&(t=!0);var n=[].concat(e);n.sort((function(e,t){return e.x-t.x}));for(var i=[],a=t;n.length>0;){if(a){var r=n.pop();if(!r)break;i.push(r)}else{var s=n.shift();if(!s)break;i.push(s)}a=!a}return i},n.calcWindupX=function(e,t){return void 0===t?e?50:this.scene.gameZone.width-50:e?Math.max(50,t.x-50):Math.min(this.scene.gameZone.width-50,t.x+50)},n.playWindUpAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r,s){var o,h,u,l,d,p,f,m,g,v,y,E,C=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===a&&(a=1.4),void 0===r&&(r=!1),this.resetTransforms(),o=467,h=t.getWorldPosition(),u=this.calcWindupX(n,i),l=n?5:-5,d=i?i.x:this.scene.gameZone.width/2,p=i?i.y:this.scene.gameZone.height/2,f=r?20:0,m=h.y+f,this.setPosition(d,p),this.setAngle(0),this.setScale(a),g=this.scene.tweens.add({targets:this,y:m,angle:l,scaleX:1.2,scaleY:.8,ease:Phaser.Math.Easing.Cubic.InOut,delay:93.4,duration:373.6}).waitForCompletion(),v=this.scene.tweens.add({targets:this,x:u,ease:Phaser.Math.Easing.Back.In,duration:o,onUpdate:function(){null==s||s(C)}}).waitForCompletion(),y=n?this.calcVerticesFromShear(-7.55949,40.75979):this.calcVerticesFromShear(7.55949,-40.75979),E=this.transformTo(y,{duration:o,ease:Phaser.Math.Easing.Back.In,easeParams:[5]}),e.next=20,Promise.all([v,g,E]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r,s){return e.apply(this,arguments)}}(),n.playSliceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r,s){var o,h,u,l,d,p,f,m,g,v,y,E,C,A,w,S,b,T=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i="anticipate"),void 0===a&&(a=!1),o=400,h=t.getWorldPosition(),u=n?-5:5,0,l=this.calcEndX(t,n,i),d=a?5:0,p=h.y+d,f=h.y+t.height/2,m=this.calcEndScale(i),g=m.x,v=m.y,y=this.scene.tweens.add({targets:this,x:l,duration:o,ease:Phaser.Math.Easing.Expo.InOut,onUpdate:function(){null==s||s(T)}}).waitForCompletion(),E=[this.scene.tweens.add({targets:this,y:p,duration:160,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:this,y:f,scaleX:g,scaleY:v,delay:160,duration:240,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()],C=[this.scene.tweens.add({targets:this,angle:u,duration:200,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){null==r||r(t,n)}}).waitForCompletion(),this.scene.tweens.add({targets:this,angle:0,delay:200,duration:200,ease:Phaser.Math.Easing.Sine.Out}).waitForCompletion()],A=n?Ed:Cd,w=n?Ad:wd,S=this.calcSliceFinishedPerspective(n,i),b=[this.transformTo(A,{duration:120,ease:Phaser.Math.Easing.Sine.In}),this.transformTo(w,{delay:120,duration:120,ease:Phaser.Math.Easing.Sine.InOut}),this.transformTo(S,{delay:240,duration:160,ease:Phaser.Math.Easing.Sine.Out})],e.next=20,Promise.all([y].concat(E,b,C));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r,s){return e.apply(this,arguments)}}(),n.calcSliceFinishedPerspective=function(e,t){return"anticipate"===t?e?Sd:bd:[{x:-.5,y:-.5},{x:.5,y:-.5},{x:.5,y:.5},{x:-.5,y:.5}]},n.calcEndScale=function(e){return"stay-and-reset"===e?{x:1,y:1}:{x:1.2,y:.8}},n.calcEndX=function(e,t,n){switch(void 0===n&&(n="anticipate"),n){case"anticipate":return t?this.scene.gameZone.width-.5*e.width:.5*e.width;case"hide":return t?this.scene.gameZone.width+e.width:-e.width;case"stay-and-reset":return t?e.getWorldPosition().x+1.5*e.width:e.getWorldPosition().x-1.5*e.width}},n.revive=function(){e.prototype.revive.call(this),this.setAngle(0),this.resetTransforms()},t}(yd),xd=Td;function Pd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return kd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Id=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.undoCards=void 0,this.canAddUndo=void 0,this.moves=void 0,this.undoLocks=void 0,this.undoUsageChanges=void 0,this.operations=void 0,this.sliceAnimations=void 0,this.sliceAnimationCancelHandlers=void 0,this.scene=e,this.boardGame=t,this.canAddUndo=!0,this.undoCards=[],this.undoLocks=[],this.undoUsageChanges=[],this.moves=0,this.operations=[],this.sliceAnimations=[],this.sliceAnimationCancelHandlers=[],t.stateMachine.on(Jh.UNDO,this.undo,this)}var t=e.prototype;return t.fromPileToWaste=function(e){var t=this.boardGame.pile,n=this.boardGame.waste;t.removeCard(e)&&(n.addCard(e),Xh.emit(Kh.CLEAR_CARDS.EVENTS.CLEAR_CARDS,{type:"cards",value:1,card:e}))},t.fromStockToWaste=function(e){var t=this.boardGame.stock,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.setCanAddUndo=function(e){this.canAddUndo=e},t.moveToLockAndWaste=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,r=void 0,s=function(){var e,n;(a=!0,t.setAlpha(1),A.scene.tweens.killTweensOf(t),r)&&(r.cardImage.cancelAnimations(),r.cardBackground.cancelAnimations(),null==(e=r.cardShadow)||e.cancelAnimations(),r.cardImage.kill(),r.cardBackground.kill(),null==(n=r.cardShadow)||n.kill());A.removeSliceAnimationCancelHandler(t)},this.addSliceAnimationCancelHandler(t,s),o=this.boardGame.waste,n.setVisible(!0),h=t.x<this.scene.gameZone.width/2,e.next=9,t.behavior.waitUntilFacingUp();case 9:if(r=this.getSliceAnimations(),l=(u=r).cardImage,d=u.cardBackground,p=u.cardShadow,this.copyCardToSliceAnimations(t,l,d,p),p&&this.scene.gameplayLayer.bringToTop(p),this.scene.gameplayLayer.bringToTop(d),this.scene.gameplayLayer.bringToTop(l),null==p||p.setAlpha(0),l.setAlpha(1),d.setAlpha(1),t.setAlpha(0),f=t.getWorldPosition(),null==p||p.setPosition(f.x,f.y),l.setPosition(f.x,f.y),d.setPosition(f.x,f.y),null==p||p.setAngle(t.angle),l.setAngle(t.angle),d.setAngle(t.angle),!a){e.next=28;break}return e.abrupt("return");case 28:return m=n.getWorldPosition(),g=f.x<m.x,v=function(){n.parent.killLockSegment(n),n.parent.isUnlock&&n.parent.preKill(),A.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.UNLOCK_LOCK,{volume:.5})},y=function(e){if(t.behavior instanceof Gl){var n=e.getAlignedPosition("bottom"),i=n.x,a=n.y;t.setPosition(i,a-t.displayHeight/2)}},E=t.getWorldPosition(),e.next=35,Promise.all([this.scene.tweens.add({targets:p,alpha:1,duration:.4*i}).waitForCompletion(),null==p?void 0:p.runAsync({isShadow:!0,targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset"}),l.runAsync({targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset"}),d.runAsync({targets:[n],interlaceRightLeftRight:g,startingPosition:E,startingScale:1,lastCardBehaviour:"stay-and-reset",onHit:v,onPositionChanged:y})]);case 35:if(!a){e.next=37;break}return e.abrupt("return");case 37:return null==p||p.kill(),l.kill(),d.kill(),C=d.getWorldPosition(),t.setPosition(C.x,C.y),t.setAlpha(1),t.setAngle(0),e.next=46,Promise.all([this.scene.tweens.add({targets:t,angle:h?-360:360,x:o.x,duration:i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:t,y:t.y-50,duration:i/2,ease:Phaser.Math.Easing.Quadratic.Out}).waitForCompletion(),this.scene.tweens.add({targets:t,y:o.y,delay:i/2,duration:i/2,ease:Phaser.Math.Easing.Quadratic.InOut,onComplete:function(){A.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FINISH_MOVE_TO_WASTE)}}).waitForCompletion()]);case 46:if(!a){e.next=48;break}return e.abrupt("return");case 48:this.removeSliceAnimationCancelHandler(t);case 49:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t.moveToWaste=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.boardGame.waste,i=t.src,a=t.card,r=t.duration,s=t.lockSegment,a.behavior.bringToTop(),e.t0=i.name,e.next=e.t0===tu.Stock?6:e.t0===tu.Pile?13:22;break;case 6:return this.fromStockToWaste(a),o=a.behavior.setFacingWithFlippingAnim(!0),h=this.boardGame.scene.tweens.add({targets:a,angle:{from:0,to:15},duration:r/2,yoyo:!0,onComplete:function(){l.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FINISH_MOVE_TO_WASTE)}}).waitForCompletion(),u=a.move({x:n.x,y:n.y,duration:r}),e.next=12,Promise.all([o,h,u]);case 12:case 21:return e.abrupt("return");case 13:if(this.fromPileToWaste(a),!s){e.next=19;break}return e.next=17,this.moveToLockAndWaste(a,s,r);case 17:e.next=21;break;case 19:return e.next=21,a.moveWithRotate({x:n.x,y:n.y,duration:r,onComplete:function(){l.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FINISH_MOVE_TO_WASTE)}});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.removeLockSegments=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],400,i=c().mark((function e(){var i,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t[a],void 0!==(s=r.boardGame.pile.handleWithLock(i))){e.next=4;break}return e.abrupt("return",1);case 4:s.setVisible(!0),o=400+100*a,h=(0,dl.Z)(r.scene,o),u=h.then((function(){s.parent.killLockSegment(s),r.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.UNLOCK_LOCK,{volume:.5}),s.parent.isUnlock&&s.parent.preKill()})),n.push(u);case 9:case"end":return e.stop()}}),e)})),a=0;case 4:if(!(a<t.length)){e.next=11;break}return e.delegateYield(i(),"t0",6);case 6:if(!e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:a++,e.next=4;break;case 11:return e.next=13,Promise.all(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.moveFromWaste=function(e,t,n){if(this.boardGame.waste.removeCard(t),e.name==tu.Pile){var i=t.payload,a=i.x,r=i.y,s=i.angle;n&&t.rotate(t.payload.angle,300),this.boardGame.pile.addCard(t),t.revive(),t.setAngle(s),t.move({x:a,y:r,duration:300})}if(e.name==tu.Stock){var o=this.boardGame.stock,c=o.x,h=o.y;this.boardGame.stock.addCard(t),this.boardGame.stock.animateAlignCards(),0==t.isType(Qh.JOKER)&&t.behavior.setFacingWithFlippingAnim(!1),t.move({x:c,y:h,duration:300})}},t.getUndoCards=function(e){for(var t=[],n=this.undoCards.length-1;n>=0;n--){var i=this.undoCards[n];i.moves==e&&t.push(i)}var a=this.undoCards.filter((function(t){return t.moves!=e}));return this.undoCards=a,t},t.getUndoLocks=function(e){for(var t=[],n=this.undoLocks.length-1;n>=0;n--){var i=this.undoLocks[n];i.moves==e&&t.push(i)}var a=this.undoLocks.filter((function(t){return t.moves!=e}));return this.undoLocks=a,t},t.getUndoUsageChanges=function(e){for(var t=[],n=this.undoUsageChanges.length-1;n>=0;n--){var i=this.undoUsageChanges[n];i.moves==e&&t.push(i)}var a=this.undoUsageChanges.filter((function(t){return t.moves!=e}));return this.undoUsageChanges=a,t},t.canUndo=function(){return this.undoCards.length>0},t.undo=function(){var e=this;if(this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.RELEASE_UNDO),!1!==this.boardGame.gameplay.enableCardInput&&this.canUndo()){var t=this.getUndoCards(this.moves),n=this.getUndoLocks(this.moves),i=this.getUndoUsageChanges(this.moves),a=!1;if(0!=t.length){this.scene.events.emit(Tu.Z.UNDO),i.forEach((function(t){var n=t.coin,i=void 0===n?0:n,a=t.rewardedValue,r=void 0===a?0:a,s=t.wildCardPrice,o=void 0===s?300:s;0!==i&&e.scene.logEconomy.logGetItem(fl.COIN,-i,gl.UNDO_WILDCARD);var c=e.scene.player.getCoins();e.scene.player.setCoins(c-i),e.scene.rewardManager.undo(r),e.boardGame.gameplay.coinUsingManager.setWildCardPrice(o)}));for(var r,s=this.sliceAnimationCancelHandlers.filter((function(e){return t.some((function(t){return t.card===e.card}))})),o=Pd(s);!(r=o()).done;){r.value.cancel()}t.forEach((function(t){var n=t.card,i=t.originalPlacement,r=t.toPlacement,s=t.totalScore,o=t.combo,c=o.comboValues,h=o.comboHeight,u=o.rewardIndex,l=o.streak,d=e.boardGame.gameplay.scoreManager,p=e.boardGame.gameplay.comboManager;if(d.setTotalScore(s),p.clearPlayerRewards(),p.setCombo(c,h),p.setStreakIndex(u,l.type,l.threshold),n.behavior.reviveItems(),n.behavior.revive(),n.behavior.bringToTop(),i==tu.Pile){var f=e.boardGame.pile;r==tu.Waste&&(e.moveFromWaste(f,n,!0),e.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.TAP_UNDO_PILE),a=!0),r!=tu.Pile&&r!=tu.Joker||(e.moveFromWaste(f,n),r==tu.Joker&&e.boardGame.gameplay.coinUsingManager.removeWildCard(n))}if(i==tu.Stock){var m=e.boardGame.stock;r==tu.Waste&&(e.moveFromWaste(m,n),e.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.TAP_UNDO_STOCK),a=!0)}if(i==tu.Joker&&r==tu.Waste){var g=e.boardGame.gameplay.coinUsingManager;e.boardGame.waste.removeCard(n),e.scene.gameUI.coinBarButton.coinBar.runBounceCoinTextAnimation(),e.scene.gameplayLayer.bringToTop(g.wildCardBtn),g.addWildCard(n);var v=n;e.boardGame.scene.tweens.add({targets:n,angle:{from:v,to:0},duration:300});var y=e.scene.backupGameObjectSystem.getObjectSaved(g.wildCardWrapper),E=y.x,C=y.y,A=77===g.wildCardBtn.height?11.5:-11.5;n.move({x:E,y:C+A,duration:300,onComplete:function(){n.kill(),e.boardGame.gameplay.coinUsingManager.onWildCardChanged()}})}if(i==tu.Combo&&r==tu.Stock){var w=e.boardGame.stock,S=e.boardGame.gameplay.comboManager;w.bringToTop(),w.removeCard(n)&&w.animateAlignCards(),n.setVisible(!0),w.setLockedManual(!1);var b=S.streakBar.getItemPos(),T=b.x,x=b.y;n.move({x:T+100,y:x-100,duration:800,onComplete:function(){n.kill()}})}n.behavior instanceof Ql&&n.behavior.undo(),n.behavior instanceof ql&&n.behavior.undo()})),n.forEach((function(t){var n=t.lockSegment,i=t.lock,a=i.payload.position,r=a.x,s=a.y;i.revive(),i.setAngle(0),e.scene.gameplayLayer.bringToTop(i),n&&(i.reviveLockSegment(n),i.bringToTop(n)),i.move(r,s,300,0)})),a&&this.undoOnPileCards(t),this.setMoves(this.moves-1),this.boardGame.pile.refresh()}}},t.undoOnPileCards=function(e){var t=this.boardGame.pile,n=e.map((function(e){return e.card}));t.getCardsWithType(Qh.BOOM,Qh.CHANGER).forEach((function(e){n.includes(e)||e.behavior.undo()}))},t.addUndoCard=function(e,t,n,i){if(this.canAddUndo){var a=this.boardGame.gameplay.comboManager,r=a.streaks,s=this.boardGame.gameplay.scoreManager.getTotalScore(),o=a.getCombo(),c=a.getComboHeight(),h=a.getStreakIndex(),u={type:r[h].type,threshold:r[h].threshold},l=i||this.moves,d={card:e,originalPlacement:t,moves:l,toPlacement:n,totalScore:s,combo:{comboValues:o,comboHeight:c,rewardIndex:h,streak:u}},p={cardState:{id:e.id,x:e.x,y:e.y,angle:e.angle,type:e.behavior.type},originalPlacement:t,moves:l,toPlacement:n,increaseCombo:!0},f=new gd(this.boardGame.scene,p);this.operations.push(f),this.undoCards.push(d)}},t.addUndoLock=function(e,t){if(this.canAddUndo){var n={lock:e,moves:this.moves,lockSegment:t};this.undoLocks.push(n)}},t.addUndoUsageChange=function(e){if(this.canAddUndo){var t=e.coin,n=void 0===t?0:t,i=e.rewardedValue,a=void 0===i?0:i,r=this.boardGame.gameplay.coinUsingManager,s={coin:n,rewardedValue:a,moves:this.moves,wildCardPrice:r.getWildCardPrice()};this.undoUsageChanges.push(s)}},t.getMoves=function(){return this.moves},t.increaseMoves=function(){this.moves+=1},t.setMoves=function(e){this.moves=e},t.clear=function(){this.undoCards=[],this.undoLocks=[],this.moves=0},t.getInactiveSliceAnimations=function(e){void 0===e&&(e=1);for(var t,n=[],i=Pd(this.sliceAnimations);!(t=i()).done;){var a=t.value;if(!a.active&&!a.visible&&(n.push(a),n.length>=e))break}return n},t.getSliceAnimations=function(){for(var e=this.getInactiveSliceAnimations(3);e.length<3;){var t=new xd(this.scene,Wi.Z.GAMEPLAY_OBJECTS.KEY,Wi.Z.GAMEPLAY_OBJECTS.FRAME.CARD_BACK);t.kill(),this.scene.gameplayLayer.add(t),this.sliceAnimations.push(t),e.push(t)}for(var n,i=Pd(e);!(n=i()).done;){n.value.revive()}return{cardImage:e[0],cardBackground:e[1],cardShadow:e[2]}},t.copyCardToSliceAnimations=function(e,t,n,i){t.setTexture(Wi.Z.GAMEPLAY_OBJECTS.KEY,e.cardImage.frame.name),n.setTexture(Wi.Z.GAMEPLAY_OBJECTS.KEY,Wi.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD),null==i||i.setTexture(Wi.Z.GAMEPLAY_OBJECTS.KEY,"card-bg"),t.setWorldSize(54,78),n.setWorldSize(54,78),null==i||i.setWorldSize(54,78)},t.addSliceAnimationCancelHandler=function(e,t){this.sliceAnimationCancelHandlers.push({card:e,cancel:t})},t.removeSliceAnimationCancelHandler=function(e){this.sliceAnimationCancelHandlers=this.sliceAnimationCancelHandlers.filter((function(t){return t.card!==e}))},e}(),Od=Id,Rd=function(){function e(e){var t=this;this.scene=void 0,this.boardGame=void 0,this.canShowWildCardHint=void 0,this.timeAutoHint=void 0,this.wildCardHintTime=void 0,this.wildCardHintAnim=void 0,this.hintTween=void 0,this.jumpTween=void 0,this.checkCanShowWildCardHint=function(){var e=t.boardGame.gameplay.comboManager,n=t.boardGame.waste.getOnTopCard(),i=t.scene.gameSettings.requiredLevels,a=t.scene.level.getLevelByMode();t.resetWildCardHint(),a<i.wildCard||!e.isLastComboForStreak()||!n||n.behavior instanceof yl?t.canShowWildCardHint=!1:t.canShowWildCardHint=!0},this.removeHintTween=function(){var e,n,i,a=null==(e=t.hintTween)?void 0:e.targets;a&&a.forEach((function(e){e instanceof ud&&(e.behavior.updateSize(),e.jumpTween===t.jumpTween&&e.setZ(0))})),null==(n=t.jumpTween)||n.remove(),null==(i=t.hintTween)||i.remove()},this.removeWildCardHintTween=function(){var e;null==(e=t.wildCardHintAnim)||e.stop(),t.boardGame.gameplay.coinUsingManager.setWildCardDefault()},this.showWildCardHint=function(){var e,n=Wi.Z.GAMEPLAY_OBJECTS,i=n.KEY,a=n.FRAME,r=t.boardGame.gameplay;if((null==(e=t.wildCardHintAnim)||!e.isPlaying())&&!(t.wildCardHintAnim&&t.wildCardHintAnim.countdown>0)){var s=r.coinUsingManager.wildCardBtn,o=s.mainIcon,c=!0;t.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.WILD_CARD_HINT);var h=t.scene.tweens.createTimeline({});h.add({targets:s,y:"-=10",duration:400,ease:Phaser.Math.Easing.Quadratic.Out}),h.add({targets:s,y:"+=10",duration:400,ease:Phaser.Math.Easing.Bounce.Out}),h.add({targets:s,scaleX:-1,duration:250,offset:0,yoyo:!0,onUpdate:function(e){var t=e.getValue();c&&t<=0?(c=!1,s.setFacingUp(c),o.setTexture(i,a.WILD_CARD_BACK)):!c&&t>=0&&(c=!0,s.setFacingUp(c),o.setTexture(i,a.WILD_CARD))}}),h.play(),t.wildCardHintAnim=h}},this.boardGame=e,this.scene=e.scene,this.timeAutoHint=0,this.wildCardHintTime=0,this.canShowWildCardHint=!1}var t=e.prototype;return t.init=function(){var e=this,t=function(){e.removeHintTween(),e.resetWildCardHint(),e.resetAutoHintTime()},n=function(){e.removeHintTween(),e.checkCanShowWildCardHint()};this.boardGame.stateMachine.on(Jh.DRAW_STOCK,n),this.boardGame.stateMachine.on(Jh.DRAW_PILE,n),this.boardGame.stateMachine.on(Jh.DRAW_FIRST_CARD,n),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,(function(){e.resetWildCardHint(),e.removeHintTween(),e.removeWildCardHintTween()}),this),this.boardGame.stateMachine.on(Jh.UNDO,(function(){e.removeHintTween(),e.resetWildCardHint()}),this),this.boardGame.stateMachine.on(Jh.PILE_EMPTY,t,this),this.boardGame.stateMachine.on(Jh.LOSE,t,this),this.boardGame.stateMachine.on(Jh.EXIT,t,this)},t.getCardWithLongestChain=function(e){if(0!=e.length){for(var t=this.boardGame.pile.getFrontCards(),n=[],i=-1,a=0;a<e.length;a++){var r=e[a],s=this.getLongestChainLength(r,[],t,0,0);i<s&&(i=s),n.push({startCard:r,length:s})}var o=n.filter((function(e){return e.length==i}));return o[Phaser.Math.Between(0,o.length-1)].startCard}},t.getPileMatchableCards=function(){var e=this.boardGame.pile,t=this.boardGame.waste.getOnTopCard();return t?e.getFrontCards().filter((function(n){return e.isMatch(n,t)})):[]},t.showMissPlay=function(){var e=this,t=this.getPileMatchableCards();t.length>0&&this.boardGame.increaseMissedPlayableCount(),t.forEach((function(t){e.runMissPlayAnimation(t)}))},t.showHint=function(){var e=this.boardGame.stock,t=this.getPileMatchableCards(),n=Phaser.Utils.Array.GetRandom(t);if(n)this.runHintAnimation(n);else{var i=e.cards[e.cards.length-1];if(!i)return;this.runHintAnimation(i)}},t.resetAutoHintTime=function(){this.timeAutoHint=0},t.update=function(e){var t=this.scene.level.getLevel();if(this.canShowHint(t)){var n=this.boardGame.gameplay.coinUsingManager.wildCardBtn;this.boardGame.stateMachine.isEventAllowed(Jh.SHOW_HINT)&&(this.timeAutoHint+=e,this.canShowWildCardHint&&(1===n.alpha?this.wildCardHintTime+=e:this.wildCardHintTime=0)),this.timeAutoHint>15e3&&(this.showHint(),this.resetAutoHintTime()),this.wildCardHintTime>2e3&&(this.showWildCardHint(),this.canShowWildCardHint=!1,this.wildCardHintTime=0)}},t.resetWildCardHint=function(){this.canShowWildCardHint=!1,this.wildCardHintTime=0},t.runMissPlayAnimation=function(e){var t,n;if(!(e.isMoving||null!=(t=e.behavior.facingTween)&&t.isPlaying()||null!=(n=e.shakeTween)&&n.isPlaying())){var i=e.payload.angle;e.setAngle(i),e.behavior.updateSize(),e.behavior.bringToTop(),e.shake(10,1100,!1),this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.SKIP_MOVE),this.scene.add.tween({targets:[e],scale:{from:e.scale,to:e.scale+.1},duration:550,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0})}},t.runHintAnimation=function(e){var t,n,i;null!=(t=this.hintTween)&&t.isPlaying()||this.hintTween&&this.hintTween.countdown>0||e.isMoving||null!=(n=e.behavior.facingTween)&&n.isPlaying()||null!=(i=e.shakeTween)&&i.isPlaying()||(e.behavior.bringToTop(),this.hintTween=this.scene.add.tween({targets:[e],scale:{from:1,to:1.1},duration:250,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0,repeat:2}),this.jumpTween=e.jump(10,500,2))},t.getNonVisitedCards=function(e,t){return e.filter((function(e){if(0==t.includes(e))return!0}))},t.getLongestChainLength=function(e,t,n,i,a){var r=this;return a>i&&(i=a),t.includes(e)||(t.push(e),this.getNonVisitedCards(n,t).forEach((function(s){r.boardGame.pile.isMatch(e,s)&&(i=r.getLongestChainLength(s,t,n,i,a+1))})),t.pop()),i},t.canShowHint=function(e){return 1!=e&&(2!=e&&6!=e)},e}(),Bd=Rd,Dd=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,t,n,i)||this).scene=void 0,s.boardGame=void 0,s.parent=void 0,s.value=void 0,s.movingTween=void 0,s.isLock=void 0,s.spine=void 0,s.spineScale=void 0,s.scene=t,s.parent=a,s.value=r,s.boardGame=s.scene.gameplay.boardGame,s.spineScale=1/GameCore.ImageScale,s.createSpine(),s.setSize(43,53),s.scene.add.existing((0,fc.Z)(s)),s}(0,s.Z)(t,e);var n=t.prototype;return n.runUnlockAnimation=function(){return this.boardGame.gameplay.spineManager.playAndWaitAnimation(this.spine,Yu.BALLOON.EXPLODE,!1,!0)},n.createSpine=function(){var e=this.boardGame.gameplay.spineManager;this.spine=e.createSpine(0,0,Wi.Z.CODE_BREAK_SPINE.DATA_KEY,Wi.Z.CODE_BREAK_SPINE.ATLAS_KEY),this.spine.setScale(.34375,.3333333333333333),this.spine.animationStateData.defaultMix=0,this.spine.kill(),this.spine.setDepth(Fr.Z.EFFECT),this.add(this.spine)},n.showSegment=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.gameplay.spineManager,e.next=3,(0,le.qZ)(t);case 3:return e.next=5,n.playAnimation(this.spine,Yu.BALLOON.SHOW,!1,!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setLockType=function(e,t){return this.spine.setSkinCustom(e,t,"balloon_symbol","balloon_symbol",!1,76.5,79.5)},n.move=function(e,t){var n;null==(n=this.movingTween)||n.remove(),this.movingTween=this.scene.add.tween({targets:this,x:e,y:t,duration:300,ease:Phaser.Math.Easing.Sine.In})},n.canUnlock=function(e,t){var n=this.value;if(n.cardFace>0){if(e==n.cardFace)return!0}else if(n.cardSuit>0){if(t==n.cardSuit)return!0}else if(n.cardColor>0){var i=t==vu.HEART||t==vu.DIAMOND;if(n.cardColor==yu.RED&&i)return!0;if(n.cardColor==yu.BLACK&&0==i)return!0}return!1},n.unlock=function(){this.runUnlockAnimation(),this.setActive(!1)},n.exit=function(){this.runUnlockAnimation()},n.revive=function(){return e.prototype.revive.call(this),this.boardGame.gameplay.spineManager.playAnimation(this.spine,Yu.BALLOON.SHOW,!1,!0)},t}(Phaser.GameObjects.Container),Ld=Dd,_d=Wi.Z.GAMEPLAY_OBJECTS,Md=_d.KEY,Nd=_d.FRAME,Gd=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i)||this).scene=void 0,r.boardGame=void 0,r.isUnlock=void 0,r.payload=void 0,r.direction=void 0,r.lockSegments=void 0,r.moveTween=void 0,r.lockTopMoveAnimation=void 0,r.lockBottomMoveAnimation=void 0,r.blurAnimation=void 0,r.fadeOutAnimation=void 0,r.isCloudCovered=void 0,r.clouds=void 0,r.midpointOfLockCards=void 0,r.lockId=void 0,r.scene=t,r.boardGame=r.scene.gameplay.boardGame,r.payload=a,r.isUnlock=!1,r.direction=a.direction,r.lockSegments=[],r.isCloudCovered=!1,r.clouds=[],r.createLockSegments(a.balloons),t.add.existing((0,fc.Z)(r)),r}(0,s.Z)(t,e);var n=t.prototype;return n.setLockId=function(e){this.lockId=e},n.handleCards=function(e){var t=this.getObjects().cards;if(e){if(!this.isCloudCovered){var n=this.coverCardByClouds(t);this.clouds=n,this.isCloudCovered=!0}t.forEach((function(e){e.setLock(!0)}))}else t.forEach((function(e){e.setLock(!1)})),this.isUnlock=!0},n.calculateBoundingBox=function(e){var t=1/0,n=-1/0,i=1/0,a=-1/0;return e.forEach((function(e){t=Math.min(t,e.x),n=Math.max(n,e.x+e.width),i=Math.min(i,e.y),a=Math.max(a,e.y+e.height)})),{left:t,right:n,top:i,bottom:a,width:n-t,height:a-i}},n.coverCardByClouds=function(e){var t=this,n=this.generateClouds(3*e.length),i=Math.floor(n.length/e.length),a=[];a.push.apply(a,n),e.forEach((function(e){var a=n.splice(0,i),r=t.getLocalPoint(e.getWorldPosition().x,e.getWorldPosition().y),s=r.x,o=r.y;a.forEach((function(e){e.setX(s+Phaser.Math.Between(-10,10))})),a[0].setY(o+Phaser.Math.Between(-29,-9)),a[1].setY(o+Phaser.Math.Between(-9,9)),a[2].setY(o+Phaser.Math.Between(9,29))}));var r=this.lockSegments.filter((function(e){return e.active}));return r.length>0&&r.forEach((function(e){var n;null==(n=e.movingTween)||n.remove(),t.bringToTop(e)})),a},n.generateClouds=function(e){for(var t=[],n=0;n<e;n++){var i=Phaser.Math.Between(1,3),a=this.scene.add.image(0,0,Md,""+Nd.CLOUD_+i);a.setDefaultWorldSize(),a.setAlpha(0),this.add(a),t.push(a)}return t},n.getObjects=function(){var e=this,t=this.scene.gameplay.boardGame.pile.cards,n=this.scene.gameplay.boardGame.balloonData;if(!n[this.lockId])return{cards:[]};var i=[];if(this.direction===El.LEFT){var a=n[this.lockId+1];if(a&&a.direction===El.LEFT){var r=a.position;i=t.filter((function(t){return t.payload.x<e.payload.position.x&&t.payload.x>r.x}))}else i=t.filter((function(t){return t.payload.x<e.payload.position.x}))}else if(this.direction===El.RIGHT){var s=n[this.lockId+1];if(s&&s.direction===El.RIGHT){var o=s.position;i=t.filter((function(t){return t.payload.x>e.payload.position.x&&t.payload.x<o.x}))}else i=t.filter((function(t){return t.payload.x>e.payload.position.x}))}return{cards:i}},n.move=function(e,t,n,i){var a;if(this.x!=e||this.y!=t)return null==(a=this.moveTween)||a.remove(),this.moveTween=this.scene.tweens.add({targets:this,x:e,y:t,duration:n,delay:i}),this.moveTween},n.getSegmentPosition=function(e){return e.getWorldPosition()},n.showLock=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 50,e.next=3,Promise.all(this.lockSegments.map((function(e,n){return Promise.all([e.showSegment(50*n),t.scene.add.tween({targets:t.clouds,alpha:1,duration:300}).waitForCompletion()])})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.unlockSegment=function(e){if(this.active){var t=this.lockSegments.filter((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}));if(t.length>0){var n=t[Phaser.Math.Between(0,t.length-1)];return n.kill(),this.boardGame.mover.addUndoLock(this,n),0==this.lockSegments.filter((function(e){return e.active&&e.visible})).length&&this.handleCards(!1),n}}},n.isMatch=function(e){return this.lockSegments.some((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}))},n.killLockSegment=function(e){e.unlock()},n.revive=function(){var t;e.prototype.revive.call(this),null==(t=this.fadeOutAnimation)||t.remove(),this.setAlpha(1),this.isUnlock=!1},n.reviveLockSegment=function(e){e.revive()},n.setBlur=function(e){var t;null==(t=this.blurAnimation)||t.remove(),this.blurAnimation=e?this.scene.tweens.add({targets:this,alpha:.6,duration:300}):this.scene.tweens.add({targets:this,alpha:1,duration:300})},n.preKill=function(){this.exit(600,!1)},n.killedByWindmill=function(){this.kill(),this.lockSegments.forEach((function(e){e.setActive(!1)}))},n.exit=function(e,t){var n,i=this;void 0===e&&(e=0),void 0===t&&(t=!0),null==(n=this.fadeOutAnimation)||n.remove(),this.fadeOutAnimation=this.scene.tweens.add({targets:[this],duration:300,alpha:0,delay:e,onComplete:function(){i.kill()}}),t&&this.lockSegments.forEach((function(e){e.exit()}))},n.createLockSegments=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){var t=e.cardValues,i=e.position,a=Nd.BLANK,r=n.createSegment(t),s=n.getLocalPoint(i.x,i.y);return r.setPosition(s.x,s.y),t.cardSuit>0?a=n.getSuitFrame(t.cardSuit):t.cardColor>0?a=t.cardFace>0?n.getValueFrame(t.cardFace):n.getColorFrame(t.cardColor):t.cardFace>0&&(a=n.getValueFrame(t.cardFace)),r.setLockType(Md,a)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.createSegment=function(e){var t=new Ld(this.scene,0,0,this,e);return this.add(t),this.lockSegments.push(t),t},n.runAlignLockSegmentAnimation=function(){var e=this.lockSegments.filter((function(e){return e.active}));if(e.length>0){this.setSize(e[0].width,e[0].height*e.length);var t=-this.height/2+e[0].height/2;e.forEach((function(e){e.move(e.x,t),t+=e.height}))}},n.getSuitFrame=function(e){return e==vu.HEART?Nd.BALLOON_HEART:e==vu.DIAMOND?Nd.BALLOON_DIAMOND:e==vu.CLUBS?Nd.BALLOON_CLUB:e==vu.SPADES?Nd.BALLOON_SPADE:""},n.getValueFrame=function(e){var t=Nd.BALLOON_NUMBER_;return 1==e?t+"A":11==e?t+"J":12==e?t+"Q":13==e?t+"K":""+t+e},n.getColorFrame=function(e){return e==yu.BLACK?Nd.BALLOON_BLACK:e==yu.RED?Nd.BALLOON_RED:""},t}(Phaser.GameObjects.Container),Zd=Gd,Fd=function(e){return e.COIN="coin",e.CHEST="chest",e.CARD="card",e.WILD="wild",e}({}),Ud={coinsRewarded:55,cost:{addCards:250,addCardsDifference:50,boosterSlice:350,boosterStorm:375,boosterWildCard:400,undo:100,undoDifference:25,wildCard:300,wildCardDifference:50},comboRewards:[Fd.COIN,Fd.CARD,Fd.WILD,Fd.CHEST],matchRatio:{matchRatio:28,commonDifference:16},difficulty:Vh.NORMAL,streak:{random:"card",fixed:["card|5","coin|4","wild|6"]}},Wd=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.scene=e,this.boardGame=t}var t=e.prototype;return t.blow=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.boardGame,a=i.pile,r=i.waste,s=i.stock,o=[].concat(a.cards),h=this.scene.world.getWorldSize(),u=h.width,l=h.height,0!=o.length){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:return e.abrupt("return",new Promise((function(e){d.boardGame.stock.setLockedManual(!0),d.boardGame.gameplay.setEnableCardInput(!1);var i=[];o.push.apply(o,s.cards),o.forEach((function(e){if(e.behavior instanceof Gl&&e.behavior.killItems(),e.behavior.checkCardHasValue()&&e.behavior.random){var a=Phaser.Math.Between(1,13),r=Phaser.Math.Between(1,4);e.behavior.setValue(a,r)}var s=new Phaser.Math.Vector2(e.x-t,e.y-n);s.normalize(),0==s.x&&0==s.y&&s.add({x:0,y:-1});var o=e.x,c=e.y;s.x>0&&(o=u-e.x),s.y>0&&(c=l-e.y);var h=Math.sqrt(Math.pow(o,2)+Math.pow(c,2))+45;s.multiply({x:h,y:h});var p=Phaser.Math.Between(1e3,1200);i.push(e.move({x:e.x+s.x,y:e.y+s.y,duration:p}),d.flipRotate(e,p,Phaser.Math.Between(-270,-90)))}));var a=r.cards.pop();r.cards.forEach((function(e){e.kill()})),d.scene.tweens.add({targets:[a],alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),Promise.all(i).then((function(){return e()}))})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.flipRotate=function(e,t,n){var i=this.scene.tweens.createTimeline(),a=t/2;return i.add({targets:e,angle:{from:0,to:n},duration:2*a}),e.isType(Qh.SQUIRREL)||e.isType(Qh.TREASURE)||(i.add({targets:e,scaleX:{from:1,to:0},yoyo:!0,offset:0,duration:a/4,onYoyo:function(){e.behavior.setFrameCardDown()}}),i.add({targets:e,scaleX:{from:1,to:0},yoyo:!0,duration:a/2,offset:a/2,onYoyo:function(){e.behavior.setFrameCardUp()}})),i.playAndWaitForCompletion()},e}(),Hd=Wd;function Yd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Kd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Kd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var zd=function(){function e(){this.callbacks=new Map}var t=e.prototype;return t.on=function(e,t,n){var i;this.callbacks.has(e)||this.callbacks.set(e,[]),null==(i=this.callbacks.get(e))||i.push(new Vd(t,n))},t.once=function(e,t,n){var i;this.callbacks.has(e)||this.callbacks.set(e,[]),null==(i=this.callbacks.get(e))||i.push(new Vd(t,n,!0))},t.off=function(e,t,n,i){if(this.callbacks.has(e)){var a=this.callbacks.get(e);if(a){var r=a.findIndex((function(e){return e.fn===t&&e.context===n&&e.once===i}));-1!==r&&a.splice(r,1)}}},t.removeListener=function(e,t,n,i){this.callbacks.has(e)&&this.callbacks.set(e,[])},t.removeAllListeners=function(e){this.callbacks.has(e)&&this.callbacks.set(e,[])},t.emit=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l=this,d=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.callbacks.has(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=this.callbacks.get(t)){e.next=5;break}return e.abrupt("return");case 5:for(i=d.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=d[r];s=Yd(n);case 7:if((o=s()).done){e.next=13;break}return h=o.value,e.next=11,h.fn.apply(h.context,a);case 11:e.next=7;break;case 13:u=n.filter((function(e){return!0===e.once})),u.forEach((function(e){return l.off(t,e.fn,e.context,e.once)}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),Vd=function(e,t,n){this.fn=void 0,this.context=void 0,this.once=void 0,this.fn=e,this.context=t,this.once=n},jd=function(){function e(e,t){this.handler=void 0,this.state=void 0,this.state=e,this.handler=t}var t=e.prototype;return t.getTargetState=function(){return"number"===typeof this.state?this.handler.stateHistory[this.handler.stateHistory.length-1+this.state]:this.state},t.setTargetState=function(e){this.state?this.state!==e&&this.handler.logPrefix:this.state=e},e}(),Xd=function(e){function t(t,n,i){var a;return void 0===n&&(n=void 0),(a=e.call(this,n,i)||this).event=void 0,a.emitter=new zd,a.event=t,a}(0,s.Z)(t,e);var n=t.prototype;return n.emit=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=r.length,i=new Array(n),a=0;a<n;a++)i[a]=r[a];return e.next=3,(t=this.emitter).emit.apply(t,["event:"+this.event].concat(i));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.on=function(e,t){this.emitter.on("event:"+this.event,e,t)},n.once=function(e,t){this.emitter.once("event:"+this.event,e,t)},n.off=function(e,t,n){this.emitter.off("event:"+this.event,e,t,n)},n.removeListener=function(e,t,n){this.emitter.removeListener("event:"+this.event,e,t,n)},n.removeAllListeners=function(){this.emitter.removeAllListeners("event:"+this.event)},t}(jd),qd=function(e){function t(t,n,i){var a;return(a=e.call(this,n,i)||this).condition=void 0,a.condition=t,a}return(0,s.Z)(t,e),t.prototype.evaluate=function(){return this.condition&&this.condition()},t}(jd);function Jd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Qd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var $d=function(){function e(e,t){this.state=void 0,this.handler=void 0,this.emitter=new zd,this.conditionEdges=[],this.eventEdges=[],this.autoTransitionEvent=void 0,this.handler=e,this.state=t}var t=e.prototype;return t.addConditionEdge=function(e,t){void 0===t&&(t=void 0);var n=new qd(e,t,this.handler);this.conditionEdges.push(n)},t.addEventEdge=function(e,t){void 0===t&&(t=void 0);var n=this.handler.getEventEdge(e);t&&n.setTargetState(t),this.eventEdges.push(n)},t.evaluateConditionEdges=function(){for(var e,t=Jd(this.conditionEdges);!(e=t()).done;){var n=e.value;if(n.evaluate())return n.getTargetState()}},t.addAutoTransitionEdge=function(e){this.autoTransitionEvent=e},t.configureAutoTransitionEdge=function(e){var t;null==(t=this.autoTransitionEvent)||t.setTargetState(e)},t.canTransition=function(e){var t;return this.eventEdges.some((function(t){return t.event===e}))||(null==(t=this.autoTransitionEvent)?void 0:t.event)===e},t.emitEnter=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];return e.next=3,this.emitter.emit("state-enter:"+this.state,n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onEnter=function(e,t){this.emitter.on("state-enter:"+this.state,e,t)},t.onceEnter=function(e,t){this.emitter.once("state-enter:"+this.state,e,t)},t.offEnter=function(e,t,n){this.emitter.off("state-enter:"+this.state,e,t,n)},t.emitExit=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];return e.next=3,this.emitter.emit("state-exit:"+this.state,n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onExit=function(e,t){this.emitter.on("state-exit:"+this.state,e,t)},t.onceExit=function(e,t){this.emitter.once("state-exit:"+this.state,e,t)},t.offExit=function(e,t,n){this.emitter.off("state-exit:"+this.state,e,t,n)},t.emitDone=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.emitter.emit("state-done:"+this.state);case 2:if(!this.autoTransitionEvent){e.next=5;break}return e.next=5,this.handler.emit(this.autoTransitionEvent.event);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.onDone=function(e,t){this.emitter.on("state-done:"+this.state,e,t)},e}();function ep(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var np=function(){function e(e,t,n,i){this.handler=void 0,this.rule=void 0,this.startingNodes=[],this.event=void 0,this.handler=t,this.rule=n,this.startingNodes=i,this.event=e}var t=e.prototype;return t.visitAbsoluteEdge=function(e,t){e instanceof Function?this.startingNodes.forEach((function(n){n.addConditionEdge(e,t)})):this.startingNodes.forEach((function(n){n.addEventEdge(e,t)}))},t.visitRelativeEdge=function(e,t){e instanceof Function?this.startingNodes.forEach((function(n){n.addConditionEdge(e,t)})):this.startingNodes.forEach((function(n){n.addEventEdge(e,t)}))},e}(),ip=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.goTo=function(e){return this.visitAbsoluteEdge(this.event,e),new cp(this.handler,this.rule,this.startingNodes)},n.goToPreviousState=function(){return this.visitRelativeEdge(this.event,-1),new cp(this.handler,this.rule,this.startingNodes)},t}(np),ap=function(e){function t(t,n,i){return e.call(this,(function(){return!0}),t,n,i)||this}(0,s.Z)(t,e);var n=t.prototype;return n.goTo=function(e){this.visitAbsoluteEdge((function(){return!0}),e)},n.goToPreviousState=function(){this.visitRelativeEdge(this.event,-1)},n.emit=function(e){for(var t,n=ep(this.startingNodes);!(t=n()).done;){t.value.addAutoTransitionEdge(this.handler.getEventEdge(e))}return new rp(this.event,this.handler,this.rule,this.startingNodes)},t}(np),rp=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.thenGoTo=function(e){this.startingNodes.forEach((function(t){t.configureAutoTransitionEdge(e)}))},t}(np),sp=function(e,t,n){this.handler=void 0,this.rule=void 0,this.startingNodes=[],this.handler=e,this.rule=t,this.startingNodes=n},op=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.if=function(e){return new ip(e,this.handler,this.rule,this.startingNodes)},t}(sp),cp=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.elseIf=function(e){return new ip(e,this.handler,this.rule,this.startingNodes)},n.else=function(){return new ap(this.handler,this.rule,this.startingNodes)},t}(sp);function hp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return up(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return up(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function up(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var lp=function(){function e(e,t,n){if(this.handler=void 0,this.stateNodes=[],this.handler=e,n){var i=e.allStates,a=t,r=i.filter((function(e){return!a.includes(e)}));this.stateNodes=r.map((function(t){return e.getStateNode(t)}))}else this.stateNodes=t.map((function(t){return e.getStateNode(t)}))}var t=e.prototype;return t.if=function(e){return new op(this.handler,this,this.stateNodes).if(e)},t.ifDone=function(){return new ap(this.handler,this,this.stateNodes)},t.allowEvent=function(e){for(var t,n=hp(this.stateNodes);!(t=n()).done;){t.value.addEventEdge(e)}},e}();function dp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return pp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var fp=function(){function e(e,t,n,i){void 0===i&&(i=!1),this.currentState=void 0,this.allStates=[],this.allEvents=[],this.stateNodes=new Map,this.eventEdges=new Map,this.stateHistory=[],this.logPrefix=void 0,this.currentState=e,this.stateHistory.push(e),this.logPrefix=i,this.allStates=t;for(var a,r=dp(t);!(a=r()).done;){var s=a.value;this.stateNodes.set(s,new $d(this,s))}this.allEvents=n;for(var o,c=dp(n);!(o=c()).done;){var h=o.value;this.eventEdges.set(h,new Xd(h,void 0,this))}}var t=e.prototype;return t.whenIn=function(e){return new lp(this,e,!1)},t.whenNotIn=function(e){return new lp(this,e,!0)},t.whenInAny=function(){return new lp(this,this.allStates,!0)},t.getStateNode=function(e){return this.stateNodes.get(e)},t.getEventEdge=function(e){return this.eventEdges.get(e)},t.emit=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=s[a];if(this.getStateNode(this.currentState).canTransition(t)){e.next=4;break}return this.logPrefix,e.abrupt("return");case 4:if(!0===this.logPrefix||this.logPrefix,!(r=this.getEventEdge(t)).getTargetState()){e.next=11;break}return e.next=9,this.changeState(r.getTargetState(),(function(){return r.emit.apply(r,i)}));case 9:e.next=13;break;case 11:return e.next=13,r.emit.apply(r,i);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.changeState=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,s,o,h,u,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitExit();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitEnter();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getStateNode(l.currentState).emitDone();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){l.currentState=t,l.stateHistory.push(t),!0===l.logPrefix||l.logPrefix},h=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=4;break}return e.next=4,n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=l.getStateNode(l.currentState).evaluateConditionEdges())){e.next=4;break}return e.next=4,l.changeState(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=8,i();case 8:return o(),e.next=11,a();case 11:return e.next=13,h();case 13:return e.next=15,s();case 15:return e.next=17,u();case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.on=function(e,t,n){this.getEventEdge(e).on(t,n)},t.once=function(e,t,n){this.getEventEdge(e).once(t,n)},t.off=function(e,t,n,i){this.getEventEdge(e).off(t,n,i)},t.removeListener=function(e,t,n,i){this.getEventEdge(e).removeListener(t,n,i)},t.removeAllListeners=function(e){this.getEventEdge(e).removeAllListeners()},t.waitForEvent=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.once(t,e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.waitForStateEnter=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.getStateNode(t).onceEnter(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.waitForStateExit=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.getStateNode(t).onceExit(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isEventAllowed=function(e){return this.getStateNode(this.currentState).canTransition(e)},e}(),mp=function(){function e(e,t,n,i){void 0===i&&(i=!1),this.handler=void 0,this.handler=new fp(e,t,n,i)}var t=e.prototype;return t.whenIn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handler.whenIn(t)},t.whenNotIn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handler.whenNotIn(t)},t.whenInAny=function(){return this.handler.whenInAny()},t.emit=function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(t=this.handler).emit.apply(t,[e].concat(i))},t.emitAndWait=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=s.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=s[r];return e.next=3,(n=this.handler).emit.apply(n,[t].concat(a));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.waitForEvent=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForEvent(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.on=function(e,t,n){this.handler.on(e,t,n)},t.once=function(e,t,n){this.handler.once(e,t,n)},t.off=function(e,t,n,i){this.handler.off(e,t,n,i)},t.removeListener=function(e,t,n,i){this.handler.removeListener(e,t,n,i)},t.removeAllListeners=function(e){this.handler.removeAllListeners(e)},t.onEnter=function(e,t,n){this.handler.getStateNode(e).onEnter(t,n)},t.onceEnter=function(e,t,n){this.handler.getStateNode(e).onceEnter(t,n)},t.offEnter=function(e,t,n,i){this.handler.getStateNode(e).offEnter(t,n,i)},t.waitForStateEnter=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForStateEnter(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.onExit=function(e,t,n){this.handler.getStateNode(e).onExit(t,n)},t.onceExit=function(e,t,n){this.handler.getStateNode(e).onceExit(t,n)},t.offExit=function(e,t,n,i){this.handler.getStateNode(e).offExit(t,n,i)},t.waitForStateExit=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.waitForStateExit(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.isEventAllowed=function(e){return this.handler.isEventAllowed(e)},e}(),gp=function(e){function t(){var t;return(t=e.call(this,qh.NONE,Object.values(qh),Object.values(Jh))||this).whenNotIn(qh.NONE).if(Jh.RESET).goTo(qh.NONE),t.whenIn(qh.NONE).if(Jh.START).goTo(qh.INITIALIZED),t.whenIn(qh.INITIALIZED).ifDone().emit(Jh.DEAL).thenGoTo(qh.DEALING),t.whenIn(qh.DEALING).ifDone().emit(Jh.APPLY_BOOSTERS).thenGoTo(qh.APPLYING_BOOSTERS),t.whenIn(qh.APPLYING_BOOSTERS).ifDone().emit(Jh.DRAW_FIRST_CARD).thenGoTo(qh.DRAWING_FIRST_CARD),t.whenIn(qh.DRAWING_FIRST_CARD).ifDone().goTo(qh.IDLE),t.whenIn(qh.IDLE).if(Jh.DRAW_STOCK).goTo(qh.DRAWING_STOCK).elseIf(Jh.DRAW_PILE).goTo(qh.DRAWING_PILE).elseIf(Jh.DRAW_WILD_CARD).goTo(qh.DRAWING_WILD_CARD),t.whenIn(qh.DRAWING_STOCK,qh.DRAWING_PILE,qh.DRAWING_WILD_CARD).ifDone().emit(Jh.CHECK_END_GAME).thenGoTo(qh.CHECKING_END_GAME),t.whenIn(qh.CHECKING_END_GAME).if(Jh.PILE_EMPTY).goTo(qh.GAME_WON).elseIf(Jh.BOMB_COUNTER_REACHED_ZERO).goTo(qh.EXPLODING).elseIf(Jh.NO_STOCK_CARDS).goTo(qh.NO_STOCK_CARDS).elseIf(Jh.UNDO).goTo(qh.UNDOING).elseIf(Jh.DRAW_WILD_CARD).goTo(qh.DRAWING_WILD_CARD).else().goTo(qh.IDLE),t.whenIn(qh.NO_STOCK_CARDS).if(Jh.REFILL_STOCK).goTo(qh.IDLE).elseIf(Jh.LOSE).goTo(qh.GAME_LOST).elseIf(Jh.DRAW_WILD_CARD).goTo(qh.DRAWING_WILD_CARD).elseIf(Jh.DRAW_PILE).goTo(qh.DRAWING_PILE),t.whenIn(qh.EXPLODING).if(Jh.LOSE).goTo(qh.GAME_LOST),t.whenIn(qh.IDLE,qh.NO_STOCK_CARDS).if(Jh.UNDO).goTo(qh.UNDOING),t.whenIn(qh.UNDOING).ifDone().emit(Jh.CHECK_END_GAME),t.whenNotIn(qh.DRAWING_STOCK,qh.DRAWING_PILE,qh.DRAWING_WILD_CARD).allowEvent(Jh.SHOW_HINT),t.whenIn(qh.IDLE,qh.NO_STOCK_CARDS).if(Jh.PURCHASE_UNDO).goTo(qh.PROCESSING_PURCHASE).elseIf(Jh.PURCHASE_WILD_CARD).goTo(qh.PROCESSING_PURCHASE),t.whenIn(qh.NO_STOCK_CARDS,qh.IDLE).if(Jh.PURCHASE_REFILL_STOCK).goTo(qh.PROCESSING_PURCHASE).elseIf(Jh.PURCHASE_REFILL_STOCK_WITH_ADS).goTo(qh.PROCESSING_PURCHASE),t.whenIn(qh.PROCESSING_PURCHASE).if(Jh.UNDO).goTo(qh.UNDOING).elseIf(Jh.REFILL_STOCK).goTo(qh.IDLE).elseIf(Jh.DRAW_WILD_CARD).goTo(qh.DRAWING_WILD_CARD).else().goToPreviousState(),t.whenIn(qh.IDLE,qh.NO_STOCK_CARDS).if(Jh.EXIT).goTo(qh.NONE),t}return(0,s.Z)(t,e),t}(mp),vp=function(e){return e.FREE="free",e.NOT_FREE="not-free",e}({}),yp=n(79),Ep=function(e){function t(t){var n;(n=e.call(this)||this).gameplay=void 0,n.scene=void 0,n.stateMachine=new gp,n.stock=void 0,n.deck=void 0,n.pile=void 0,n.waste=void 0,n.hint=void 0,n.mover=void 0,n.locks=void 0,n.blowCardsBehavior=void 0,n.canShowUndo=void 0,n.isUndoShowing=void 0,n.isWildCardShowing=void 0,n.canRefillStock=void 0,n.mapSettings=void 0,n.metricsLog=void 0,n.blackBackground=void 0,n.balloonData=void 0,n.showingUndoTween=void 0,n.hidingUndoTween=void 0,n.showingWildCardTween=void 0,n.hidingWildCardTween=void 0,n.lose=function(){n.gameOver(),n.gameplay.handleGameOver(!1)},n.win=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gameOver(),n.gameplay.handleGameOver(!0),n.scene.gameUI.coinBarButton.setDisabled(!0),(t=n.deck.lastMovingCard.card)&&t.active&&0!=t.isMoving){e.next=8;break}n.runCompleteLevelAnimation(),e.next=14;break;case 8:return e.next=10,t.movingTween.waitForCompletion();case 10:if(!n.stock.alignTween){e.next=13;break}return e.next=13,n.stock.alignTween.waitForCompletion();case 13:n.runCompleteLevelAnimation();case 14:case"end":return e.stop()}}),e)}))),n.hasValidMoves=function(){if(n.stock.cards.length>0)return!0;var e=n.waste.getOnTopCard();if(!e)return!0;var t=n.pile.getFrontCards();return 0==t.length||t.some((function(t){return n.pile.isMatch(t,e)}))},n.isOutOfStockCards=function(){return!(1===n.scene.level.getLevelByMode()||n.stock.cards.length>0)},n.runCompleteLevelAnimation=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.STOCK_CARD_REWARD),n.scene.gameUI.gameUILayout.hidePlusCardsButtons(),e.next=4,n.scene.rewardManager.runStockRewardAnim();case 4:n.gameplay.handleOpenGameOverScreen(!0);case 5:case"end":return e.stop()}}),e)}))),n.gameplay=t,n.scene=t.scene,n.metricsLog={wildCardUsedCount:0,undoCount:0,addCardsCountByCoin:0,addCardsCountByAd:0,missedPlayableCount:0,streakCount:0,clickOnUnmatchedCardCount:0},n.canShowUndo=!1,n.canRefillStock=!0,n.locks=[],n.mapSettings=Ud,n.createBlackBackground(),n.deck=new dd((0,fc.Z)(n)),n.stock=new fu((0,fc.Z)(n)),n.pile=new pd((0,fc.Z)(n)),n.waste=new fd((0,fc.Z)(n)),n.hint=new Bd((0,fc.Z)(n)),n.mover=new Od(n.scene,(0,fc.Z)(n)),n.blowCardsBehavior=new Hd(n.scene,(0,fc.Z)(n));var i=ru.CARD_VIEW.HEIGHT,a=n.scene.gameZone.width/2,s=n.scene.gameZone.height-n.scene.world.getSAB();return n.stock.setPosition(a-65,s-i/2-10),n.waste.setPosition(a,s-i/2-10),n.stock.init(),n.initTransitionEvents(),n.hint.init(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,ie.Z.OVERLAY.KEY),this.blackBackground.setName("Black Background"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),Phaser.Display.Align.In.Center(this.blackBackground,this.scene.gameZone),this.scene.gameplayLayer.add(this.blackBackground),yp.Z.registerObject(this.blackBackground,ce.MR.MULTIPLY_ALPHA)},n.runFadeBackground=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:a,onStart:function(){r.blackBackground.revive(),r.blackBackground.alpha=t}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.initTransitionEvents=function(){var e=this;this.stateMachine.on(Jh.START,this.start,this),this.stateMachine.on(Jh.DEAL,this.deal,this),this.stateMachine.on(Jh.APPLY_BOOSTERS,(function(){return e.gameplay.boosterManager.start()})),this.stateMachine.on(Jh.DRAW_FIRST_CARD,this.drawFirstCard,this),this.stateMachine.on(Jh.RESET,this.clear,this),this.stateMachine.on(Jh.DRAW_STOCK,this.stock.draw,this),this.stateMachine.on(Jh.DRAW_PILE,this.pile.draw,this),this.stateMachine.on(Jh.PILE_EMPTY,this.win,this),this.stateMachine.on(Jh.CHECK_END_GAME,this.checkEndGame,this),this.stateMachine.on(Jh.LOSE,this.lose,this),this.stateMachine.on(Jh.REFILL_STOCK,this.refillStock,this),this.stateMachine.on(Jh.NO_STOCK_CARDS,this.showPlusCards,this),this.stateMachine.on(Jh.EXIT,this.handleExit,this)},n.start=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.scene.level.getLevelData())&&(this.mapSettings=t.settings.mapProperties,n=this.mapSettings.matchRatio,i=n.matchRatio,a=void 0===i?0:i,r=n.commonDifference,s=void 0===r?0:r,o=this.scene.player.getCoins(),this.deck.matchRatioCalculator.setHardRatioByCoins(o),this.deck.matchRatioCalculator.setConfig(a,s)),this.initPile(),this.createLocks(),this.hint.resetAutoHintTime(),this.hint.resetWildCardHint(),this.mover.setCanAddUndo(!1),this.scene.gameUI.footer.setCanHandleSettings(!1),Xh.emit(Kh.CLEAR_CARDS.EVENTS.RESET);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.drawFirstCard=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stock.draw(!1);case 2:this.pile.refresh(),this.mover.setCanAddUndo(!0),t=this.scene.level.getLevelByMode(),this.gameplay.guideManager.playGuide(t,this.scene.gameSettings),this.scene.gameUI.footer.setCanHandleSettings(!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.onPlayerMove=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.pile,this.gameplay.setEnableCardInput(!1),!(n=this.waste.getOnTopCard())||!n.isType(Qh.WINDMILL,Qh.CHESTNUT,Qh.MAP_PIECE)){e.next=6;break}return e.next=6,n.behavior.onPlayerMove();case 6:if(!(this.waste.getCardsLength()>1)){e.next=18;break}i=t.getCardsWithType(Qh.BOOM,Qh.CHANGER),a=0;case 9:if(!(a<i.length)){e.next=18;break}if(r=i[a],(s=r.behavior).onPlayerMove(),!(s instanceof _u&&s.explodeCounter<=0)){e.next=15;break}return e.abrupt("return");case 15:a++,e.next=9;break;case 18:return e.next=20,this.activateDrawableCards();case 20:this.gameplay.setEnableCardInput(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.activateDrawableCards=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.pile,n=t.cards.filter((function(e){return e.behavior.isPlusCard()||e.isType(Qh.JOKER)||e.isType(Qh.KEY)})),n.sort((function(e){return e.isType(Qh.CHAIN)?-1:1})),i=0;case 4:if(!(i<n.length)){e.next=16;break}if(a=n[i],this.pile.checkOverlap(a)||a.isBlur){e.next=13;break}return e.next=9,(0,le.qZ)(200);case 9:return e.next=11,a.behavior.onPlayerMove();case 11:n.splice(i,1),i=-1;case 13:i++,e.next=4;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.gameOver=function(){this.gameplay.setEnableCardInput(!1),this.gameplay.boosterManager.stop(),this.gameplay.eventManager.stop()},n.clear=function(){this.pile.clear(),this.stock.clear(),this.waste.clear(),this.deck.clear(),this.mover.clear(),this.locks.forEach((function(e){return e.destroy()})),this.locks=[],this.isUndoShowing=!1,this.stateMachine.removeAllListeners(Jh.CHECK_END_GAME),this.stateMachine.on(Jh.CHECK_END_GAME,this.checkEndGame,this)},n.setCanRefillStock=function(e){this.canRefillStock=e},n.setCanShowUndo=function(e){this.canShowUndo=e},n.initStock=function(){var e=this.scene.level.getLevelData();if(e){for(var t=e.settings.cardsInStack,n=0;n<t.length;n++){var i=this.deck.getNewCard(tu.Stock);i.setBehavior();var a=t[n],r=a.value,s=a.suit;r&&(-1==r||-1==s?i.behavior.random=!0:i.behavior.setValue(r,s)),this.stock.addCard(i)}this.stock.align()}},n.initPile=function(){var e=this,t=this.scene.level.getLevelData();t&&(this.pile.clearHistoryCollectedCards(),t.cards.forEach((function(t){var n=e.deck.getNewCard(e.pile.name,t),i=t.x,a=t.y;n.setPosition(i,a),n.setAngle(t.angle),n.setBehavior(t.type),e.pile.addCard(n)})),this.pile.setNutsInSquirrel(),this.pile.setTreasureMapCards(),this.pile.connectChainCard())},n.listenEventsToShowWildCard=function(){var e=this,t=this.gameplay.coinUsingManager.wildCardBtn;this.isWildCardShowing=!1;var n=function(){e.isWildCardShowing=!0,t.revive(),e.showingWildCardTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:1},duration:300})};this.stateMachine.on(Jh.DRAW_STOCK,n,this),this.stateMachine.on(Jh.DRAW_PILE,n,this),this.stateMachine.on(Jh.DRAW_WILD_CARD,(function(){var n;e.isWildCardShowing=!1,null==(n=e.showingWildCardTween)||n.stop(),e.hidingWildCardTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:0},duration:300,onComplete:function(){t.kill(),t.setAlpha(0)}})}),this),this.stateMachine.on(Jh.UNDO,n,this)},n.listenEventsToShowUndo=function(){var e=this,t=this.gameplay.coinUsingManager.undoBtn;this.isUndoShowing=!1;var n=function(){return e.isUndoShowing},i=function(){n()||e.canShowUndo&&e.mover.canUndo()&&function(){var n;null==(n=e.hidingUndoTween)||n.stop(),t.active||t.visible||t.setAlpha(0),t.revive(),e.showingUndoTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:1},duration:300,onStart:function(){e.isUndoShowing=!0},onComplete:function(){t.setAlpha(1)}})}()};this.stateMachine.on(Jh.DRAW_STOCK,i,this),this.stateMachine.on(Jh.DRAW_PILE,i,this),this.stateMachine.on(Jh.DRAW_WILD_CARD,i,this),this.stateMachine.on(Jh.UNDO,(function(){n()&&(e.canShowUndo&&e.mover.canUndo()||function(){var n;null==(n=e.showingUndoTween)||n.stop(),e.hidingUndoTween=e.scene.tweens.add({targets:t,alpha:{from:t.alpha,start:t.alpha,to:0},duration:300,onStart:function(){e.isUndoShowing=!1},onComplete:function(){t.kill(),t.setAlpha(0)}})}())}),this)},n.createLocks=function(){var e=this,t=this.scene.level.getLevelData();if(t){var n=t.balloonData;if(0!=n.length){var i=(n=n.sort((function(e,t){return e.direction-t.direction}))).filter((function(e){return e.direction==El.LEFT})).sort((function(e,t){return t.position.x-e.position.x})),a=n.filter((function(e){return e.direction==El.RIGHT})).sort((function(e,t){return e.position.x-t.position.x})),r=[].concat(i,a);r.forEach((function(t,n){var i=new Zd(e.scene,t.position.x,t.position.y,t);e.scene.gameplayLayer.add(i),e.locks.push(i),i.setLockId(n)})),this.balloonData=r,this.lockCards()}}},n.addCardToStock=function(e,t,n){for(var i=this,a=0,r=function(){var e=i.deck.getNewStockCard();e.setAlpha(0),i.scene.time.delayedCall(a,(function(){e.setPosition(t,n),new Bh.Z({targets:[e],duration:200}).play(),e.moveWithRotate({x:i.stock.x,y:i.stock.y,duration:1e3}),i.scene.time.delayedCall(800,(function(){i.stock.moveToStep(-1),i.stock.addCard(e)}))})),a+=300},s=0;s<e;s++)r()},n.checkEndGame=function(){0==this.pile.cards.length||1==this.pile.cards.length&&this.pile.cards[0].behavior instanceof Gl?(this.scene.gameUI.footer.closeSettings(),this.scene.gameUI.footer.setCanHandleSettings(!1),this.stateMachine.emit(Jh.PILE_EMPTY)):this.isOutOfStockCards()?this.stateMachine.emit(Jh.NO_STOCK_CARDS):this.scene.gameUI.gameUILayout.hidePlusCardsButtons()},n.showPlusCards=function(){this.canRefillStock?this.gameplay.coinUsingManager.showPlusCards(vp.FREE):this.gameplay.coinUsingManager.showPlusCards(vp.NOT_FREE)},n.handleExit=function(){var e=this,t=this.scene.world.getWorldSize(),n=t.width,i=t.height;this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.END_GAME),this.locks.forEach((function(e){e.exit()})),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),this.gameOver(),this.blowCardsBehavior.blow(n/2,i/2).then((function(){e.clear(),e.gameplay.eventManager.resetEventItemAmount(),e.scene.screen.open(ce.o4.DASHBOARD_SCREEN)}))},n.lockCards=function(){this.locks.forEach((function(e){0==e.isUnlock&&e.handleCards(!0)}))},n.deal=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stock.setLockedManual(!0),this.pile.animateChainCards(),this.hideAllCardsBeforeDeal(),1!=this.scene.level.getLevel()){e.next=7;break}return e.next=7,this.scene.gameplay.boardGame.runFadeBackground(1,0,550,0);case 7:return this.scene.gameplayLayer.bringToTop(this.gameplay.coinUsingManager.wildCardWrapper),e.next=10,this.dealPile();case 10:return this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.DEAL_CARDS),e.next=13,this.pile.flipCardsStagger();case 13:return this.showLocks(),this.initStock(),this.deck.matchRatioCalculator.setCurrentRatio(100),e.next=18,this.dealStock();case 18:this.stock.setLockedManual(!1);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLocks=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.locks.map((function(e){return e.showLock()})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hideAllCardsBeforeDeal=function(){this.pile.cards.forEach((function(e){e.kill()}))},n.dealStock=function(){var e=this;return new Promise((function(t){var n=[].concat(e.stock.cards);n.forEach((function(e){return e.setY(e.y+100)}));var i=e.scene.time.addEvent({delay:20,repeat:n.length-1,callback:function(){var a=n.shift();a&&(a.move({x:a.x,y:e.stock.y,duration:200}),0==i.repeatCount&&e.scene.time.delayedCall(400,t))}})}))},n.dealPile=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.pile.cards,n=this.scene.gameZone.width/2,i=this.scene.tweens.createTimeline({onStart:function(){a.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.SHUFFLE,{})},onComplete:function(){a.scene.audio.stopSound(ec.Z.SHUFFLE)}}),t.forEach((function(e,t){e.revive();var a=e.x,r=e.y;e.setPosition(n,-160);var s=(n-a)/150*90;i.add({targets:e,props:{x:a,y:r,angle:{from:s,to:e.payload.angle,ease:Phaser.Math.Easing.Linear},scale:{from:.5*e.scale,to:e.scale}},duration:600,delay:0==t?200:0,offset:"-=570",ease:Phaser.Math.Easing.Sine.Out})})),e.next=6,i.playAndWaitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.update=function(e){this.deck.cards.forEach((function(t){t.active&&t.visible&&t.update(e)})),this.hint.update(e)},n.refillStock=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===t&&(t=5),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),n=0;n<t;n++)(i=this.deck.getNewCard(tu.Stock)).setBehavior(),this.stock.addCard(i);return this.stock.align(),this.stock.setLockedManual(!0),this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.ADD_FIVE_CARDS),e.next=8,this.dealStock();case 8:this.stock.setLockedManual(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.increaseWildCardUsedCount=function(){this.metricsLog.wildCardUsedCount+=1},n.increaseUndoCount=function(){this.metricsLog.undoCount+=1},n.increaseAddCardsCountByCoin=function(){this.metricsLog.addCardsCountByCoin+=1},n.increaseAddCardsCountAd=function(){this.metricsLog.addCardsCountByAd+=1},n.increaseMissedPlayableCount=function(){this.metricsLog.missedPlayableCount+=1},n.increaseStreakCount=function(){this.metricsLog.streakCount+=1},n.increaseClickOnUnmatchedCardCount=function(){this.metricsLog.clickOnUnmatchedCardCount+=1},n.resetLog=function(){this.metricsLog.undoCount=0,this.metricsLog.addCardsCountByCoin=0,this.metricsLog.addCardsCountByAd=0,this.metricsLog.wildCardUsedCount=0,this.metricsLog.missedPlayableCount=0,this.metricsLog.streakCount=0,this.metricsLog.clickOnUnmatchedCardCount=0},n.getMetricsLog=function(){return this.metricsLog},t}(Phaser.Events.EventEmitter),Cp=Ep,Ap={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},wp=Ap.STATUS,Sp=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(wp.READY)},t.start=function(){this.isRunning()||this.setState(wp.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(wp.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===wp.READY},t.isRunning=function(){return this.state===wp.RUNNING},t.isStopped=function(){return this.state===wp.STOPPED},e}(),bp=Sp,Tp=function(e){function t(){var t;return(t=e.call(this,zi.IDLE,Object.values(zi),Object.values(Vi))||this).whenIn(zi.IDLE).if(Vi.START).goTo(zi.RUNNING),t.whenIn(zi.RUNNING).if(Vi.COMPLETED).goTo(zi.IDLE),t}return(0,s.Z)(t,e),t}(mp),xp=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.type=void 0,this.stateMachine=new Tp,this.scene=e,this.boardGame=t,this.type=Yi.NONE}var t=e.prototype;return t.activate=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.gameplay.setEnableCardInput(!1),e.next=3,this.stateMachine.emitAndWait(Vi.START);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.complete=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.gameplay.setEnableCardInput(!0),e.next=3,this.stateMachine.emitAndWait(Vi.COMPLETED);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.waitForComplete=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.stateMachine.waitForEvent(Vi.COMPLETED));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Pp=xp,kp=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).totalAddCards=void 0,i.type=Yi.PLUS_FIVE_CARDS,i.totalAddCards=5,i}(0,s.Z)(t,e);var n=t.prototype;return n.makeCards=function(){for(var e=[],t=0;t<this.totalAddCards;t++){var n=this.boardGame.deck.getNewStockCard();e.push(n)}return e},n.activate=function(){var t=(0,r.Z)(c().mark((function t(){var n,i,a,r,s,o,h,u=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:n=this.boardGame.stock,i=this.makeCards(),a=this.scene.world.getWorldSize().width/2,r=this.scene.world.getWorldSize().height/2,s=0,o=c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=i[h]).setAlpha(0),u.scene.time.delayedCall(s,(function(){t.setPosition(a,r),new Bh.Z({targets:[t],duration:600}).play(),t.moveWithRotate({x:n.x,y:n.y,duration:1200}),u.scene.time.delayedCall(1e3,(function(){n.moveToStep(-1),n.addCard(t)}))})),s+=300;case 4:case"end":return e.stop()}}),e)})),h=0;case 9:if(!(h<i.length)){t.next=14;break}return t.delegateYield(o(),"t0",11);case 11:h++,t.next=9;break;case 14:this.scene.time.delayedCall(s+1200,(function(){u.complete()}));case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(Pp),Ip=kp,Op=function(e){function t(t,n){var i;(i=e.call(this,t,0,0)||this).background=void 0,i.image=void 0,i.isTop=void 0,i.isTop=n;var a=ru.CARD_VIEW_OFFSET,r=a.x,s=a.y;i.background=i.scene.make.image({x:r,y:s,key:Wi.Z.GAMEPLAY_OBJECTS.KEY,frame:Wi.Z.GAMEPLAY_OBJECTS.FRAME.BLANK_CARD}),i.background.setName("Card Background");var o=n?0:i.background.height/2;return i.background.setCrop(0,o,i.background.width,i.background.height/2),i.background.setDefaultWorldSize(),i.background.kill(),i.image=i.scene.make.image({x:r,y:s,key:Wi.Z.GAMEPLAY.KEY,frame:""}),i.image.kill(),i.setSize(i.background.width,i.background.height),i.add([i.background,i.image]),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.copy=function(e){this.image.setCrop(),this.image.setTexture(Wi.Z.GAMEPLAY_OBJECTS.KEY,e.cardImage.frame.name);var t=this.isTop?0:this.image.height/2;this.image.setCrop(0,t,this.image.width,this.image.height/2),this.image.setDefaultWorldSize()},n.kill=function(){e.prototype.kill.call(this),this.image.kill(),this.background.kill()},n.revive=function(){e.prototype.revive.call(this),this.image.revive(),this.background.revive()},t}(Phaser.GameObjects.Container),Rp=function(e){function t(t,n){var i;(i=e.call(this,t,0,0)||this).top=void 0,i.bottom=void 0,i.cancelAnyAnimation=void 0;var a=ru.CARD_VIEW,r=a.WIDTH,s=a.HEIGHT;return i.setSize(r,s),i.top=new Op(t,!0),i.bottom=new Op(t,!1),i.add([i.top,i.bottom]),i.scene.add.existing((0,fc.Z)(i)),n&&i.copy(n),i}(0,s.Z)(t,e);var n=t.prototype;return n.copy=function(e){this.top.copy(e),this.bottom.copy(e),this.top.setAngle(e.angle),this.bottom.setAngle(e.angle)},n.revive=function(){e.prototype.revive.call(this),this.top.revive(),this.bottom.revive(),this.top.setAlpha(1),this.bottom.setAlpha(1)},n.kill=function(){e.prototype.kill.call(this),this.top.kill(),this.bottom.kill()},n.slice=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.cancelAnyAnimation)||n.call(this),this.setAlpha(1),this.top.setAlpha(1),this.bottom.setAlpha(1),this.top.setScale(1),this.bottom.setScale(1),this.top.setPosition(0,0),this.bottom.setPosition(0,0),0,i=t?1.5*this.top.width:1.5*-this.top.width,a=3*this.bottom.height,r=-this.top.height,s=r+2*this.top.height,o=t?[20,270]:[-270,-20],h=t?[-270,-20]:[20,270],u=Phaser.Math.Between(o[0],o[1]),l=Phaser.Math.Between(h[0],h[1]),d=600,p=this.scene.tweens.add({targets:this.bottom,x:{value:i,ease:Phaser.Math.Easing.Sine.Out},y:{value:a,ease:Phaser.Math.Easing.Quadratic.In},scaleX:{value:.8,ease:Phaser.Math.Easing.Sine.Out},angle:{value:l,ease:Phaser.Math.Easing.Quartic.Out},alpha:{value:0,ease:Phaser.Math.Easing.Expo.In},duration:d}),f=p.waitForCompletion(),m=this.scene.tweens.add({targets:this.top,y:r,ease:Phaser.Math.Easing.Quadratic.Out,duration:120}),g=this.scene.tweens.add({targets:this.top,y:s,ease:Phaser.Math.Easing.Quadratic.In,delay:120,duration:480}),v=this.scene.tweens.add({targets:this.top,x:{value:i,ease:Phaser.Math.Easing.Sine.Out},scaleX:{value:.4,ease:Phaser.Math.Easing.Sine.Out},angle:{value:u,ease:Phaser.Math.Easing.Quartic.Out},alpha:{value:0,ease:Phaser.Math.Easing.Expo.In},duration:d}),y=Promise.all([m.waitForCompletion().then((function(){return g.waitForCompletion()})),v.waitForCompletion()]),E=function(){p.stop(),m.stop(),g.stop(),v.stop()},this.cancelAnyAnimation=E,e.next=28,Promise.all([y,f]);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container);function Bp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Dp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Dp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Lp=1.3,_p=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).appearSpine=void 0,i.spines=[],i.slicedCards=[],i.animation=void 0,i.type=Yi.SLICE,i.animation=new xd(t),i.animation.kill(),i.scene.gameplayLayer.add(i.animation),i}(0,s.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,r.Z)(c().mark((function t(){var n,i,a,r,s,o,h,u,l,d,p,f=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:this.appearSpine||(this.appearSpine=this.scene.add.spine(0,0,Wi.Z.CARD_SLICE_SPINE.DATA_KEY,Wi.Z.CARD_SLICE_SPINE.ATLAS_KEY),this.appearSpine.setScale(.333,.333),this.appearSpine.setPosition(this.scene.gameZone.width/2-2,this.scene.gameZone.height/2+25),this.appearSpine.kill(),this.scene.gameplayLayer.add(this.appearSpine)),n=this.boardGame.pile,i=this.boardGame.gameplay.comboManager,a=[],r=n.getFrontCards().filter((function(e){return e.visible&&e.behavior.type!=Qh.CHAIN&&!e.isMysterious})),s=0;case 8:if(!(s<3)){t.next=17;break}if(!(r.length<1)){t.next=11;break}return t.abrupt("break",17);case 11:o=Phaser.Utils.Array.RemoveRandomElement(r),n.removeCard(o),a.push(o);case 14:s++,t.next=8;break;case 17:if(0!==a.length){t.next=19;break}return t.abrupt("return");case 19:return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),a.forEach((function(e){e.moveToTopLayer()})),this.scene.gameplayLayer.bringToTop(this.animation),(h=this.scene.gameplay.spineManager).reviveSpine(this.appearSpine),this.scene.gameplayLayer.bringToTop(this.appearSpine),t.next=27,h.playAnimation(this.appearSpine,Yu.CARD.APPEAR);case 27:return h.killSpine(this.appearSpine),u=[],l=Math.random()>.5,d=a[0].scaleX,p=a[0].scaleY,this.animation.revive(),t.next=35,this.animation.runAsync({targets:a,interlaceRightLeftRight:l,onHit:function(e,t){if(i.increaseCombo(e),f.scene.events.emit(Tu.Z.COLLECT_CARD,e),e.setScale(d,p),e.kill(),e.behavior instanceof Ql)return e.behavior.throwNutToBasket();e.behavior instanceof Ql&&u.push(e.behavior.throwNutToBasket()),e.behavior instanceof ql&&u.push(e.behavior.collectMapPiece()),u.push(f.runSliceFxAnimation(e,t))},onWindup:function(e){f.scene.tweens.killTweensOf(e),f.scene.tweens.add({targets:e,scaleX:Lp,scaleY:Lp,duration:200,ease:Phaser.Math.Easing.Cubic.InOut})}});case 35:return t.next=37,Promise.all(u);case 37:return t.next=39,this.complete();case 39:this.boardGame.mover.removeLockSegments(a);case 40:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.complete=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.boardGame.pile.refresh(),t.next=3,e.prototype.complete.call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.runSliceFxAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getFirstSpine()){e.next=3;break}return e.abrupt("return");case 3:if(a=this.getFirstSlicedCard()){e.next=6;break}return e.abrupt("return");case 6:return a.revive(),a.setPosition(t.x,t.y),a.setScale(Lp,Lp),a.setAlpha(1),a.copy(t),this.scene.gameplayLayer.bringToTop(a),this.scene.gameplayLayer.bringToTop(i),(r=this.scene.gameplay.spineManager).reviveSpine(i),i.setPosition(t.x,t.y),this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.SLICE_CARD),this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.CUT_CARD),e.next=20,Promise.all([r.playAnimation(i,n?Yu.CARD.FX.RIGHT_CUT:Yu.CARD.FX.LEFT_CUT),a.slice(n)]);case 20:r.killSpine(i),a.kill();case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.createSpine=function(){var e=window.game.renderer;e.resize(e.width,e.height);var t=this.scene.add.spine(0,0,Wi.Z.CARD_SLICE_FX_SPINE.DATA_KEY,Wi.Z.CARD_SLICE_FX_SPINE.ATLAS_KEY);t.setScale(.333,.333);var n=this.boardGame.gameplay.spineManager,i=this.scene.world.getWorldSize().width/2,a=this.scene.world.getWorldSize().height/2;return n.killSpine(t),this.scene.gameplayLayer.add(t),t.setPosition(i,a),t},n.getFirstSpine=function(){for(var e,t=Bp(this.spines);!(e=t()).done;){var n=e.value;if(!n.active&&!n.visible)return n}var i=this.createSpine();return this.spines.push(i),i},n.getFirstSlicedCard=function(){for(var e,t=Bp(this.slicedCards);!(e=t()).done;){var n=e.value;if(!n.active&&!n.visible)return n}var i=this.createSlicedCard();return this.slicedCards.push(i),i},n.createSlicedCard=function(){var e=new Rp(this.scene),t=this.scene.world.getWorldSize().width/2,n=this.scene.world.getWorldSize().height/2;return this.scene.gameplayLayer.add(e),e.setPosition(t,n),e.kill(),e},t}(Pp),Mp=_p,Np=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).shouldChoosePosForGuide=void 0,i.type=Yi.STORM,i.setShouldChoosePosForGuide(!1),i}(0,s.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,r.Z)(c().mark((function t(){var n,i,a,r,s,o,h;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=window.game.renderer).resize(n.width,n.height),t.next=4,e.prototype.activate.call(this);case 4:return i=this.boardGame.stock,a=this.boardGame.deck.getWindmillCard(),r=i.cards.length,s=Math.min(r,3),o=Math.min(r,7),h=r-Phaser.Math.Between(s,o),this.shouldChoosePosForGuide&&(h=r-1,this.setShouldChoosePosForGuide(!1)),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),i.addCardAt(a,h),t.next=15,this.runAnimation(a,2e3);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setShouldChoosePosForGuide=function(e){this.shouldChoosePosForGuide=e},n.runAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.scaleX,a=t.scaleY,r=1.5*i,s=1.5*a,o=this.scene.world.getWorldSize().width/2,t.setScale(r,s),t.setPosition(o,-50),this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.STORM_BOOSTER_APPEAR),e.next=10,this.runCardAppearAnimation(t,n/2-100);case 10:return e.next=12,(0,dl.Z)(this.scene,100);case 12:return e.next=14,this.runCardReturnToPlaceAnimation(t,{x:i,y:a},n/2);case 14:this.complete();case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runCardAppearAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.world.getWorldSize().width/2,a=this.scene.world.getWorldSize().height/2,r=function(){t.behavior.facingUp?t.behavior.setFrameCardDown():t.behavior.setFrameCardUp()},s=0,o=function(){d.scene.audio.playAudioSprite(Fc.Z.CARD_ROTATE.KEY,"card_rotate_"+s),s+=1},h=function(){r(),o()},u=this.scene.add.tween({targets:t,scaleX:0,yoyo:!0,duration:n/4,repeat:1,ease:Phaser.Math.Easing.Sine.InOut,onYoyo:h}).waitForCompletion(),l=this.scene.add.tween({targets:t,x:i,y:a,duration:n,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),e.next=10,Promise.all([u,l]);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runCardReturnToPlaceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.runCardFlipAndReturnToSizeAnimation(t,n,.75*i),r=this.boardGame.stock,s=r.getPosition(t),o=this.scene.add.tween({targets:t,x:s.x,y:s.y,duration:i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.next=6,Promise.all([a,o]);case 6:return e.next=8,r.animateAlignCards();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runCardFlipAndReturnToSizeAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.x,r=n.y,e.next=4,this.scene.add.tween({targets:t,scaleX:0,angle:25,duration:.3*i,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion();case 4:return t.behavior.setFrameCardDown(),e.next=7,this.scene.add.tween({targets:t,scaleX:a,scaleY:r,ease:Phaser.Math.Easing.Sine.InOut,duration:.4*i}).waitForCompletion();case 7:return e.next=9,this.scene.add.tween({targets:t,angle:0,ease:Phaser.Math.Easing.Sine.InOut,duration:.3*i}).waitForCompletion();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t}(Pp),Gp=Np,Zp=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).totalWildCards=void 0,i.totalWildCards=3,i.type=Yi.WILD_CARD,i}(0,s.Z)(t,e);var n=t.prototype;return n.activate=function(){var t=(0,r.Z)(c().mark((function t(){var n,i,a,r,s,o,h,u,l,d,p;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.activate.call(this);case 2:this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.WILD_CARD_APPEAR,{},!0),n=[],i=[],a=this.boardGame.pile,r=0;case 7:if(!(r<this.totalWildCards)){t.next=31;break}if(s=(s=a.getDownCards().filter((function(e){var t=e.behavior;return!(t instanceof _u||t instanceof Ql||t instanceof ql||t instanceof Gl||t instanceof Wu)}))).filter((function(e){return!i.find((function(t){return a.isOverLap(t,e)}))})),o=Phaser.Utils.Array.GetRandom(s)){t.next=13;break}return t.abrupt("break",31);case 13:if(a.removeCard(o),h=o.payload,u=h.x,l=h.y,d=h.angle,(p=this.boardGame.deck.getJokerCard()).payload=o.payload,p.payload.faceUp=!0,p.setPosition(u,l),p.setAngle(d),this.scene.gameplayLayer.moveBelow(p,o),this.scene.gameplayLayer.moveBelow(p.shadow,p),a.addCard(p),i.push(p),n.push(this.runAnimation(o,p)),!(r<this.totalWildCards-1)){t.next=28;break}return t.next=28,(0,dl.Z)(this.scene,100);case 28:r++,t.next=7;break;case 31:return t.next=33,Promise.all(n);case 33:this.complete();case 34:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.runAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.kill(),n.behavior.setFacing(!1),e.abrupt("return",n.behavior.setFacingWithFlippingAnim(!0));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.complete=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.prototype.complete.call(this);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(Pp),Fp=Zp;function Up(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Wp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Hp=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.sliceBooster=void 0,i.stormBooster=void 0,i.plusFiveCardsBooster=void 0,i.wildCardBooster=void 0,i.boosters=void 0,i.scene=t,i.boardGame=n,i.boosters=[],i.sliceBooster=new Mp(i.scene,i.boardGame),i.stormBooster=new Gp(i.scene,i.boardGame),i.plusFiveCardsBooster=new Ip(i.scene,i.boardGame),i.wildCardBooster=new Fp(i.scene,i.boardGame),i}(0,s.Z)(t,e);var n=t.prototype;return n.enableBoosters=function(e){var t=e.slice,n=void 0!==t&&t,i=e.storm,a=void 0!==i&&i,r=e.plusCards,s=void 0!==r&&r,o=e.wildCard,c=void 0!==o&&o;a&&(this.boosters.push(this.stormBooster),this.reduceBoosterAmount(Ki.STORM,1),this.scene.logEconomy.logUseItem(fl.BOOSTER_STORM,1,gl.USE_STORAGE_ITEM)),s&&(this.boosters.push(this.plusFiveCardsBooster),this.reduceBoosterAmount(Ki.PLUS_CARD,1),this.scene.logEconomy.logUseItem(fl.BOOSTER_PLUS_FIVE,1,gl.USE_STORAGE_ITEM)),n&&(this.boosters.push(this.sliceBooster),this.reduceBoosterAmount(Ki.SLICE,1),this.scene.logEconomy.logUseItem(fl.BOOSTER_SLICE,1,gl.USE_STORAGE_ITEM)),c&&(this.boosters.push(this.wildCardBooster),this.reduceBoosterAmount(Ki.WILD_CARD,1),this.scene.logEconomy.logUseItem(fl.BOOSTER_WILD_DROP,1,gl.USE_STORAGE_ITEM))},n.increaseBoosterAmount=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.player,(a=i.getBoosterAmount(t)+n)<0&&(a=0),e.next=5,i.setBoosterAmount(t,a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.reduceBoosterAmount=function(e,t){var n=this.scene.player,i=n.getBoosterAmount(e)-t;i<0&&(i=0),n.setBoosterAmount(e,i)},n.getAmountBoosters=function(){var e=this.scene.player;return{slice:e.getBoosterAmount(Ki.SLICE),storm:e.getBoosterAmount(Ki.STORM),wildCard:e.getBoosterAmount(Ki.WILD_CARD)}},n.stop=function(){this.boosters=[]},n.start=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Up(this.boosters);case 1:if((n=t()).done){e.next=16;break}if(!((i=n.value)instanceof Gp)){e.next=6;break}return e.next=6,this.runStormBooster(i);case 6:if(!(i instanceof Mp)){e.next=9;break}return e.next=9,this.runSliceBooster(i);case 9:if(!(i instanceof Fp)){e.next=12;break}return e.next=12,this.runWildCardBooster(i);case 12:return e.next=14,(0,le.qZ)(100);case 14:e.next=1;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStormBooster=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.stock.slot),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),t.activate(),e.next=7,t.waitForComplete();case 7:return e.next=9,this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runSliceBooster=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0),t.activate(),e.next=6,t.waitForComplete();case 6:return e.next=8,this.scene.gameplay.boardGame.runFadeBackground(.7,0,250,100);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runWildCardBooster=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return t.activate(),e.next=4,t.waitForComplete();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getLogBooster=function(){return this.boosters.map((function(e){return e instanceof Gp?Ki.STORM:e instanceof Mp?Ki.SLICE:e instanceof Fp?Ki.WILD_CARD:e instanceof Ip?Ki.PLUS_CARD:Ki.NONE})).join("|")||Ki.NONE},t}(bp),Yp=Hp,Kp=n(91),zp=function(e,t,n){var i=e.canvas,a=e.context,r=e.style,s=[],o=0,c=n.length;r.maxLines>0&&r.maxLines<n.length&&(c=r.maxLines),r.syncFont(i,a);for(var h=0;h<c;h++){for(var u=r.strokeThickness,l=0;l<n[h].length;l++)u+=a.measureText(n[h][l]).width;r.wordWrap&&(u-=a.measureText(" ").width),s[h]=Math.ceil(u),o=Math.max(o,s[h])}var d=t.fontSize+r.strokeThickness,p=d*c,f=e.lineSpacing;return c>1&&(p+=f*(c-1)),{width:o,height:p,lines:c,lineWidths:s,lineSpacing:f,lineHeight:d}},Vp=function(e){function t(t,n){var i,r,s,o,c=Phaser.Display.Color.IntegerToColor(n.strokeColor||0),h=Phaser.Display.Color.IntegerToColor(null!=(i=n.fillColor)?i:16777215),u=void 0!==n.strokeThickness?n.strokeThickness+(n.extraStroke||0):0;return(o=e.call(this,t,0,0,n.text,{fontFamily:(0,Pc.BN)(),fontSize:n.fontSize+"px",stroke:"rgba("+c.red+", "+c.green+", "+c.blue+", "+(n.strokeAlpha||1)+")",strokeThickness:u,color:"rgb("+h.red+", "+h.green+", "+h.blue+")",fontStyle:n.fontStyle})||this).extraStroke=0,o.strokeOffset={x:0,y:0},o.letterSpacingExtra=0,o.strokeBlur=0,o.strokeBlurColor=0,o.strokeBlurAlpha=1,o.payload=void 0,o.charactersTint=[],o.charactersStrokeTint=[],o.payload=n,o.extraStroke=n.extraStroke||0,o.strokeOffset=n.strokeOffset?(0,a.Z)({},o.strokeOffset,n.strokeOffset):{x:0,y:0},o.letterSpacingExtra=n.letterSpacingExtra||0,o.strokeBlur=n.strokeBlur||0,o.strokeBlurColor=null!=(r=n.strokeBlurColor)?r:0,o.strokeBlurAlpha=null!=(s=n.strokeBlurAlpha)?s:1,o.setPadding(o.strokeBlur,o.strokeBlur,o.strokeBlur,o.strokeBlur),o.setHighQuality(),o.setOrigin(.5,.5),n.lineSpacing&&o.setLineSpacing(n.lineSpacing),o.scene.add.existing((0,fc.Z)(o)),o}(0,s.Z)(t,e);var n=t.prototype;return n.setCharacterTint=function(e,t,n,i,a){for(var r=0;r<e+t;r++)r>=this.charactersTint.length&&(this.charactersTint.push(void 0),this.charactersStrokeTint.push(void 0)),r>=e&&(this.charactersTint[r]=i,this.charactersStrokeTint[r]=a);return this.updateText(),this},n.setStrokeAlpha=function(e){var t=this.payload;if(t.strokeAlpha===e)return this;t.strokeAlpha=e;var n=Phaser.Display.Color.IntegerToColor(t.strokeColor||0);return this.style.stroke="rgba("+n.red+", "+n.green+", "+n.blue+", "+(t.strokeAlpha||1)+")",this.payload=t,this.updateText(),this},n.setStrokeColor=function(e){var t=this.payload;if(t.strokeColor===e)return this;t.strokeColor=e;var n=Phaser.Display.Color.IntegerToColor(t.strokeColor||0);return this.style.stroke="rgba("+n.red+", "+n.green+", "+n.blue+", "+(t.strokeAlpha||1)+")",this.payload=t,this.updateText(),this},n.setStrokeBlurColor=function(e){var t=this.payload;return t.strokeBlurColor===e||(t.strokeBlurColor=e,this.strokeBlurColor=e,this.payload=t,this.updateText()),this},n.setTintSeparate=function(e,t){var n=this.payload;if(n.fillColor===e&&n.strokeColor===t)return this;n.strokeColor=t;var i=Phaser.Display.Color.IntegerToColor(n.strokeColor||0);this.style.stroke="rgba("+i.red+", "+i.green+", "+i.blue+", "+(n.strokeAlpha||1)+")",n.fillColor=e;var a=Phaser.Display.Color.IntegerToColor(n.fillColor||16777215);return this.style.color="rgb("+a.red+", "+a.green+", "+a.blue+")",this.payload=n,this.updateText(),this},n.disableStroke=function(e){return void 0===e&&(e=!0),this.style.strokeThickness=e?0:this.payload.strokeThickness||0,this.updateText(),this},n.setLeftAlign=function(){return this.setAlign("left"),this.setOrigin(0,.5),this},n.setRightAlign=function(){return this.setAlign("right"),this.setOrigin(1,.5),this},n.setCenterAlign=function(){return this.setAlign("center"),this.setOrigin(.5,.5),this},n.getWidth=function(){return this.width},n.getHeight=function(){return this.height},n.updateText=function(){var e;if(""===this.text)return this;var t=this.canvas,n=this.context,i=this.style,a=i.getTextMetrics();i.syncFont(t,n);var r=this.text;(i.wordWrapWidth||i.wordWrapCallback)&&(r=this.runWordWrap(this.text));var s,o=r.split(this.splitRegExp),c=zp(this,a,o),h=this.padding,u=h.left||0,l=h.right||0,d=h.top||0,p=h.bottom||0,f=this.strokeOffset||{x:0,y:0},m=this.extraStroke+(this.letterSpacingExtra||0),g=Math.max.apply(Math,o.map((function(e){return e.length}))),v=this.extraStroke+Math.abs(f.x)+m*(g-1),y=this.extraStroke+2*Math.abs(f.y),E=(null==(e=this.payload)||null==(e=e.extraSpacings)?void 0:e.reduce((function(e,t){return e+t}),0))||0;0===i.fixedWidth?(this.width=c.width+u+l+v+this.letterSpacingExtra+E,s=c.width+v):(this.width=i.fixedWidth+v,(s=this.width-u-l+v)<c.width+v&&(s=c.width+v)),this.lines=o,this.textSize=c,this.textWidth=s,0===i.fixedHeight?this.height=c.height+d+p+y:this.height=i.fixedHeight+y,this.updateDisplayOrigin(),this.dirty=!0;var C=this.input;C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height);var A=Phaser.Display.Canvas.CanvasTexturePooler.getContainer(this.key);return A&&(A.dirty=!0),this},n.drawTextCanvas=function(){var e=Phaser.Display.Canvas.CanvasTexturePooler.use(this);if(e.dirty&&this.dirty&&this.lines){var t=this.canvas,n=this.context,i=this.style,a=i.resolution,r=i.metrics,s=this.textSize,o=this.textWidth,c=this.strokeOffset||{x:0,y:0},h=this.extraStroke+(this.letterSpacingExtra||0),u=this.padding,l=u.left||0,d=u.top||0,p=this.lines,f=Math.max.apply(Math,p.map((function(e){return e.length}))),m=this.width,g=this.height;m*=a,g*=a,m=Math.max(m,1),g=Math.max(g,1);var v,y,E=this.extraStroke+Math.abs(c.x)+h*(f-1),C=this.extraStroke+2*Math.abs(c.y);m=Math.max(m,1),g=Math.max(g,1),t.width=m,t.height=g,this.frame.setSize(m,g),i.syncFont(t,n),n.save(),n.scale(a,a),i.backgroundColor&&(n.fillStyle=i.backgroundColor,n.fillRect(0,0,m,g)),i.syncStyle(t,n),n.textBaseline="alphabetic";for(var A=0,w=this.charactersTint||[],S=this.charactersStrokeTint||[],b=0;b<s.lines;b++){if(v=i.strokeThickness/2+E/2-h,y=i.strokeThickness/2+b*s.lineHeight+r.ascent+C/2+d,b>0&&(y+=s.lineSpacing*b),i.rtl)v=m-v;else if("right"===i.align)v+=o-s.lineWidths[b];else if("center"===i.align)v+=(o-s.lineWidths[b])/2;else if("justify"===i.align){if(s.lineWidths[b]/s.width>=.85){var T=s.width-s.lineWidths[b],x=n.measureText(" ").width,P=p[b].trim(),k=P.split(" ");T+=(p[b].length-P.length)*x;for(var I=Math.floor(T/x),O=0;I>0;)k[O]+=" ",O=(O+1)%(k.length-1||1),--I;p[b]=k.join(" ")}}if(this.autoRound&&(v=Math.round(v),y=Math.round(y)),i.strokeThickness){this.style.syncShadow(n,i.shadowStroke);for(var R=v+c.x,B=0;B<p[b].length;B++){var D,L=p[b][B],_=A+B,M=S.length>_?S[_]:void 0;if(void 0!==M){var N=Phaser.Display.Color.IntegerToColor(M);n.strokeStyle="rgba("+N.red+", "+N.green+", "+N.blue+", "+(this.payload.strokeAlpha||1)+")"}else n.strokeStyle=this.style.stroke;n.strokeText(L,R,y+c.y);var G=(null==(D=this.payload.extraSpacings)?void 0:D[B])||0;R+=n.measureText(L).width+h+G}}if(this.strokeBlur)for(var Z=this.strokeBlurAlpha/4,F=this.strokeBlur/4,U=1;U<=4;U++){this.style.syncShadow(n,i.shadowStroke);for(var W=v+c.x+l,H=0;H<p[b].length;H++){var Y,K=p[b][H],z=Phaser.Display.Color.IntegerToColor(this.strokeBlurColor);n.strokeStyle="rgba("+z.red+", "+z.green+", "+z.blue+", "+Z+")",n.lineWidth=F*U,n.strokeText(K,W,y+c.y);var V=(null==(Y=this.payload.extraSpacings)?void 0:Y[H])||0;W+=n.measureText(K).width+h+V}}if(i.color){this.style.syncShadow(n,i.shadowFill);for(var j=v+l,X=0;X<p[b].length;X++){var q,J=p[b][X],Q=A+X,$=w.length>Q?w[Q]:void 0;if(void 0!==$){var ee=Phaser.Display.Color.IntegerToColor($);n.strokeStyle="rgba("+ee.red+", "+ee.green+", "+ee.blue+", 1)",n.fillStyle="rgba("+ee.red+", "+ee.green+", "+ee.blue+", 1)"}else n.strokeStyle=this.style.color,n.fillStyle=this.style.color;0!==this.extraStroke&&(n.lineWidth=this.extraStroke,n.strokeText(J,j,y)),n.fillText(J,j,y);var te=(null==(q=this.payload.extraSpacings)?void 0:q[X])||0;j+=n.measureText(J).width+h+te}}A+=p[b].length}n.restore(),this.renderer&&this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1,e.dirty=!1}},t}(Phaser.GameObjects.Text),jp=Vp,Xp=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).countText=void 0,a.background=void 0,a.amount=0,a.create(),a}(0,s.Z)(t,e);var n=t.prototype;return n.setCount=function(e){this.amount=e,this.countText.setText(""+e)},n.getAmount=function(){return this.amount},n.create=function(){var e=Wi.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.IC_INFO);i.setDefaultWorldSize(),this.setSize(i.width,i.height);var a=new jp(this.scene,{text:"99",fontSize:this.scene.fontSize(14),strokeBlur:2,strokeBlurAlpha:.3,strokeBlurColor:0,fillColor:16776958});a.setPadding(2,0,2,0),a.setY(0),this.add([i,a]),this.countText=a,this.background=i,a.setPosition(.5,-.5)},t}(Phaser.GameObjects.Container),qp=Xp,Jp=Wi.Z.GAMEPLAY_DEFAULT,Qp=Jp.KEY,$p=Jp.FRAME,ef={WIDTH:62,HEIGHT:58/3},tf=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,t,n,i)||this).bg=void 0,s.coinImage=void 0,s.costText=void 0,s.freeText=void 0,s.setSize(a||ef.WIDTH,r||ef.HEIGHT),s.create(),s}(0,s.Z)(t,e);var n=t.prototype;return n.setBlueColor=function(){this.bg.setFrame($p.THREE_SLICES.COIN_PANEL_BLUE),this.bg.setWorldSize(this.width,this.height)},n.updateSize=function(e,t){this.setSize(e,t),this.bg.setWorldSize(e,t),this.align()},n.setCost=function(e){this.showCost(),this.costText.setText(e.toString())},n.align=function(){Phaser.Display.Align.In.Center(this.costText,this.bg,9,0),Phaser.Display.Align.To.LeftCenter(this.coinImage,this.costText,5,0),Phaser.Display.Align.In.Center(this.freeText,this.bg)},n.showFree=function(){this.killAllContents(),this.freeText.revive()},n.showCost=function(){this.killAllContents(),this.costText.revive(),this.coinImage.revive()},n.killAllContents=function(){this.freeText.kill(),this.costText.kill(),this.coinImage.kill()},n.create=function(){var e=this.scene.add.image(0,0,Qp,$p.THREE_SLICES.COIN_PANEL_GRAY);e.setWorldSize(this.width,this.height);var t=this.scene.add.image(0,0,Qp,$p.IC_COIN);t.setDefaultWorldSize();var n=new jp(this.scene,{text:"999",fontSize:this.scene.fontSize(12),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setTint(16777215);var i=new jp(this.scene,{text:this.scene.lang.Text.free,fontSize:this.scene.fontSize(14),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add([e,t,n,i]),this.bg=e,this.coinImage=t,this.costText=n,this.freeText=i,this.align()},t}(Phaser.GameObjects.Container),nf=tf,af=Wi.Z.GAMEPLAY_DEFAULT,rf=af.KEY,sf=af.FRAME,of=function(e){function t(t,n,i){var a;return(a=e.call(this,t,40,40)||this).main=void 0,a.counterBlock=void 0,a.costBlock=void 0,a.adsIcon=void 0,a.mainIcon=void 0,a.createMain(n,i),a.createCounterBlock(),a.createCostBlock(),a.createAdsIcon(),a.updateSize(a.costBlock.width,a.costBlock.height),t.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.updateMainSize=function(e,t){this.main.setSize(e,t),this.align()},n.alignMain=function(e,t){Phaser.Display.Align.In.TopCenter(this.main,this,e,t)},n.getOffsetMainY=function(){return this.counterBlock.getAmount()>0?11.5:-11.5},n.align=function(){this.main.setY(-this.height/2+this.main.height/2),this.counterBlock.setX(this.main.x+this.main.width/2-this.counterBlock.width/2+8),this.counterBlock.setY(this.main.y-this.main.height/2+this.counterBlock.height/2-6),this.costBlock.setY(this.height/2-this.costBlock.height/2-3.4),this.adsIcon.setX(-this.width/2+this.adsIcon.width/2-11.5),this.adsIcon.setY(-this.height/2+this.adsIcon.height/2-3)},n.updateSize=function(e,t){this.setSize(e,t),this.align()},n.setFacingUp=function(e){e?this.sendToBack(this.main):this.bringToTop(this.main)},n.setCost=function(e){e<=0?this.costBlock.showFree():this.costBlock.setCost(e)},n.setCounter=function(e,t){void 0===t&&(t=!1),this.counterBlock.setCount(e),e<=0&&!t?(this.runShowBlock(this.costBlock),this.runHideBlock(this.counterBlock)):(this.runShowBlock(this.counterBlock),this.runHideBlock(this.costBlock))},n.getAmount=function(){return this.counterBlock.getAmount()},n.showAds=function(){this.hideAllBlocks(),this.adsIcon.revive()},n.hideAllBlocks=function(){this.costBlock.kill(),this.counterBlock.kill(),this.adsIcon.kill()},n.runShowBlock=function(e){e.active&&1===e.alpha||this.scene.tweens.add({targets:e,duration:200,alpha:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.revive(),e.setAlpha(0)}})},n.runHideBlock=function(e){this.scene.tweens.add({targets:e,duration:200,alpha:{from:1,start:1,to:0},ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.setAlpha(1)},onComplete:function(){e.kill()}})},n.createMain=function(e,t){var n=this.scene.add.container(0,0);this.add(n);var i=this.scene.add.image(0,0,e,t);i.setDefaultWorldSize(),n.add(i),n.setSize(i.width,i.height),this.main=n,this.mainIcon=i},n.createCounterBlock=function(){var e=new qp(this.scene);this.add(e),this.counterBlock=e},n.createCostBlock=function(){var e=new nf(this.scene);e.kill(),this.add(e),this.costBlock=e,this.setSize(this.costBlock.width,this.height)},n.createAdsIcon=function(){var e=this.scene.add.image(0,0,rf,sf.IC_VIDEO);e.setDefaultWorldSize(),e.kill(),this.add(e),this.adsIcon=e},t}(Kp.Z),cf=of,hf={maxAddCardsByCoin:2},uf={addCards:7,boosterSlice:5,boosterStorm:10,boosterWildCard:15,combo:3,heart:10,undo:2,wildCard:6},lf={coinsPerStockCard:5,rewardedAdOffer:300,welcomeBackOffer:1e3,streak:{coin:50,chest:200}},df=function(){function e(){this.gameplay=void 0,this.requiredLevels=void 0,this.reward=void 0,this.init(),e._instance=this,this.gameplay.maxAddCardsByCoin=GameCore.Configs.RemoteConfigs.MaxAddCardsByCoin}return e.prototype.init=function(){var e=this;GameCore.Configs.GameSettingsURL?window.game.cache.json.get("game-settings").properties.forEach((function(t){if("gameSettings"==t.name){var n=t.value;e.gameplay=(0,a.Z)({},hf,n.gameplay),e.requiredLevels=(0,a.Z)({},uf,n.requiredLevels),e.reward=(0,a.Z)({},lf,n.reward)}})):(this.gameplay=(0,a.Z)({},hf),this.requiredLevels=(0,a.Z)({},uf),this.reward=(0,a.Z)({},lf))},(0,H.Z)(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e)}}]),e}();df._instance=void 0;var pf=df,ff=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.clear()},n.get=function(){return this.updateAmount(-1),this.getLast()},n.add=function(t){return e.prototype.add.call(this,t),this.updateAmount(1),this},n.updateAmount=function(e){var t=this.scene.player.getWildCard();this.scene.player.setWildCard(t+e)},t}(Phaser.GameObjects.Group),mf=ff,gf=Wi.Z.GAMEPLAY_OBJECTS,vf=gf.KEY,yf=gf.FRAME,Ef=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.wildCardWrapper=void 0,i.undoBtn=void 0,i.wildCardBtn=void 0,i.addCardsBtn=void 0,i.addCardsByAdsBtn=void 0,i.addCardsFreeBtn=void 0,i.wildCardStorage=void 0,i.undoPrice=void 0,i.wildCardPrice=void 0,i.addCardsPrice=void 0,i.undoPriceDiff=void 0,i.wildCardPriceDiff=void 0,i.addCardsPriceDiff=void 0,i.autoUpdateWildCardAmount=void 0,i.buyCardsCount=void 0,i.isAddCardsByAdsCancel=void 0,i.onWildCardChanged=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.scene&&i.autoUpdateWildCardAmount){e.next=2;break}return e.abrupt("return");case 2:i.scene.gameplayLayer.bringToTop(i.wildCardWrapper),t=i.wildCardBtn.getAmount(),n=i.scene.player.getWildCard(),i.wildCardBtn.setCounter(n),0==n&&i.wildCardBtn.setCost(i.wildCardPrice),0==t&&n>0&&i.scene.tweens.add({targets:i.wildCardBtn,duration:200,y:{from:0,start:0,to:23},ease:Phaser.Math.Easing.Sine.Out}),t>0&&0==n&&i.scene.tweens.add({targets:i.wildCardBtn,duration:200,y:{from:23,start:23,to:0},ease:Phaser.Math.Easing.Sine.Out});case 9:case"end":return e.stop()}}),e)}))),i.onUndoChanged=function(){if(i.scene){var e=i.scene.player.getUndo();i.undoBtn.setCounter(e),e<=0&&i.undoBtn.setCost(i.undoPrice)}},i.onPlusFiveChanged=function(){if(i.scene){var e=i.scene.player.getPlusFive();i.addCardsBtn.setCounter(e),e<=0&&i.addCardsBtn.setCost(i.addCardsPrice)}},i.onUseWildCard=(0,r.Z)(c().mark((function e(){var t,n,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.scene.gameplay.enableCardInput){e.next=2;break}return e.abrupt("return");case 2:if(t=i.scene.gameplay.boardGame,n=t.waste,a=t.mover,!(n.getCardsLength()<=0)){e.next=6;break}return e.abrupt("return");case 6:if(!((null==(r=n.getOnTopCard())?void 0:r.behavior)instanceof yl)){e.next=9;break}return e.abrupt("return");case 9:if(s=i.scene.player.getWildCard(),o=i.scene.player.getCoins(),!(s<=0&&o<i.wildCardPrice)){e.next=13;break}return e.abrupt("return");case 13:t.hint.resetAutoHintTime(),i.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.DRAW_WILD),a.increaseMoves(),s>0?(h=i.useRemainWildCard(),i.scene.logEconomy.logUseItem(fl.WILD_CARD,1,gl.USE_STORAGE_ITEM)):(h=i.buyAndUseNewWildCard()).behavior instanceof yl&&(h.behavior.isBought=!0),i.onWildCardChanged(),t.increaseWildCardUsedCount(),h.behavior.activate(),t.stateMachine.emit(Jh.DRAW_WILD_CARD);case 22:case"end":return e.stop()}}),e)}))),i.onUseUndo=function(){if(i.scene.gameplay.enableCardInput){var e=i.scene.gameplay.boardGame;if(e.mover.canUndo()){var t=i.scene.player.getUndo(),n=i.scene.player.getCoins();if(!(t<=0&&n<i.undoPrice)){if(e.hint.resetAutoHintTime(),e.increaseUndoCount(),t>0)i.scene.player.setUndo(t-1),i.scene.logEconomy.logUseItem(fl.UNDO,1,gl.USE_STORAGE_ITEM);else{i.scene.player.setCoins(n-i.undoPrice),i.scene.logEconomy.logBuyAndUseInstantItem(fl.UNDO,i.undoPrice,gl.BUY_USE_UNDO);var a=i.undoPrice+i.undoPriceDiff;i.setUndoPrice(a)}i.onUndoChanged(),e.stateMachine.emit(Jh.UNDO)}}}},i.onUseAddCards=function(){if(i.addCardsBtn.active&&(i.addCardsBtn.active=!1,i.scene.gameplay.enableCardInput)){var e=i.scene.gameplay.boardGame,t=i.scene.player.getPlusFive(),n=i.scene.player.getCoins();if(!(t<=0&&n<i.addCardsPrice)){if(t>0)i.scene.player.setPlusFive(t-1),i.scene.logEconomy.logUseItem(fl.PLUS_FIVE,1,gl.USE_STORAGE_ITEM);else{i.buyCardsCount+=1,i.scene.player.setCoins(n-i.addCardsPrice),i.scene.logEconomy.logBuyAndUseInstantItem(fl.PLUS_FIVE,i.addCardsPrice,gl.BUY_USE_PLUS_FIVE);var a=i.addCardsPrice+i.addCardsPriceDiff;i.setAddCardsPrice(a),i.boardGame.increaseAddCardsCountByCoin()}i.onPlusFiveChanged(),e.stateMachine.emit(Jh.REFILL_STOCK)}}},i.onUseAddCardsByAds=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.addCardsByAdsBtn.active){e.next=2;break}return e.abrupt("return");case 2:if(i.scene.gameplay.enableCardInput){e.next=4;break}return e.abrupt("return");case 4:return t=i.scene.gameplay.boardGame,e.next=7,i.scene.showRewardedVideoAsync();case 7:if(!e.sent){e.next=14;break}t.stateMachine.emit(Jh.REFILL_STOCK),i.boardGame.increaseAddCardsCountAd(),i.scene.logEconomy.logWatchAdAndUseInstantItem(fl.PLUS_FIVE,gl.PLUS_FIVE_AD),e.next=19;break;case 14:if(!(i.buyCardsCount>=pf.instance.gameplay.maxAddCardsByCoin)){e.next=19;break}return i.isAddCardsByAdsCancel=!0,e.next=18,i.scene.gameUI.gameUILayout.hidePlusCardsButtons(250);case 18:i.scene.gameUI.gameUILayout.showPlusCardsButtons([i.addCardsBtn]);case 19:case"end":return e.stop()}}),e)}))),i.scene=t,i.boardGame=n,i.autoUpdateWildCardAmount=!0,i.buyCardsCount=0,i.isAddCardsByAdsCancel=!1,i.intiPrices(),i.createButtons(),i.wildCardStorage=new mf(i.scene),i.listenEvents(),i.checkValidItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.wildCardStorage.init(),this.buyCardsCount=0,this.isAddCardsByAdsCancel=!1;var t=this.scene.level.getLevelData();if(t){var n=t.settings.mapProperties.cost;this.setWildCardPrice(n.wildCard),this.wildCardPriceDiff=n.wildCardDifference,this.setUndoPrice(n.undo),this.undoPriceDiff=n.undoDifference,this.setAddCardsPrice(n.addCards),this.addCardsPriceDiff=n.addCardsDifference}this.onWildCardChanged(),this.onUndoChanged(),this.onPlusFiveChanged()},n.checkValidItems=function(){var e=this.scene.player.getWildCard(),t=this.scene.player.getUndo(),n=this.scene.player.getPlusFive();this.scene.player.setWildCard(e),this.scene.player.setUndo(t),this.scene.player.setPlusFive(n)},n.setWildCardDefault=function(){},n.setAutoUpdateWildCardAmount=function(e){this.autoUpdateWildCardAmount=e},n.setWildCardPrice=function(e){this.wildCardPrice=e},n.setWildCardPriceDiff=function(e){this.wildCardPriceDiff=e},n.setUndoPrice=function(e){this.undoPrice=e},n.setUndoPriceDiff=function(e){this.undoPriceDiff=e},n.setAddCardsPrice=function(e){this.addCardsPrice=e},n.setAddCardsPriceDiff=function(e){this.addCardsPriceDiff=e},n.getWildCardPrice=function(){return this.wildCardPrice},n.listenEvents=function(){this.onWildCardChanged(),this.onUndoChanged(),this.onPlusFiveChanged(),this.scene.game.events.on(hi.WILDCARD_CHANGED,this.onWildCardChanged),this.scene.game.events.on(hi.UNDO_CHANGED,this.onUndoChanged),this.scene.game.events.on(hi.PLUS_FIVE_CHANGED,this.onPlusFiveChanged),this.boardGame.stateMachine.on(Jh.PURCHASE_WILD_CARD,this.onUseWildCard,this),this.boardGame.stateMachine.on(Jh.PURCHASE_UNDO,this.onUseUndo,this),this.boardGame.stateMachine.on(Jh.PURCHASE_REFILL_STOCK,this.onUseAddCards,this),this.boardGame.stateMachine.on(Jh.PURCHASE_REFILL_STOCK_WITH_ADS,this.onUseAddCardsByAds,this)},n.useRemainWildCard=function(){var e=this.scene.gameplay.boardGame.deck,t=this.wildCardStorage.get();return t||e.getJokerCard()},n.buyAndUseNewWildCard=function(){var e=this.scene.gameplay.boardGame,t=e.mover,n=e.deck,i=this.scene.player.getCoins();this.scene.player.setCoins(i-this.wildCardPrice),t.addUndoUsageChange({coin:-this.wildCardPrice}),this.scene.logEconomy.logBuyAndUseInstantItem(fl.WILD_CARD,this.wildCardPrice,gl.BUY_USE_WILD_CARD);var a=this.wildCardPrice+this.wildCardPriceDiff;return this.setWildCardPrice(a),n.getJokerCard()},n.addWildCard=function(e,t){void 0===t&&(t=!0);var n=e.behavior;n instanceof yl&&n.isBought||(!t&&this.setAutoUpdateWildCardAmount(!1),this.wildCardStorage.add(e),this.scene.logEconomy.logGetItem(fl.WILD_CARD,1,gl.UNDO_WILDCARD),this.setAutoUpdateWildCardAmount(!0))},n.removeWildCard=function(e){this.wildCardStorage.remove(e);var t=this.scene.player.getWildCard();this.scene.player.setWildCard(t-1),this.scene.logEconomy.logUseItem(fl.WILD_CARD,1,gl.UNDO_PLAY_CARD)},n.runWildCardButtonAnim=function(e,t){this.wildCardBtn.setY(e);var n=Phaser.Math.Difference(e,t)/.2;this.scene.tweens.add({targets:this.wildCardBtn,delay:1e3,y:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut})},n.handleNotEnoughCoins=function(){this.scene.screen.open(ce.o4.GET_COINS_SCREEN,{claimedCoin:pf.instance.reward.rewardedAdOffer})},n.intiPrices=function(){this.undoPrice=0,this.undoPriceDiff=0,this.wildCardPrice=0,this.wildCardPriceDiff=0,this.addCardsPrice=0,this.addCardsPriceDiff=0},n.createButtons=function(){var e=this;this.createWildcardButton(),this.createUndoBtn(),this.createAddCardsBtn(),this.createAddCardsFreeBtn(),this.createAddCardsByAdsBtn(),this.wildCardBtn.onClick=function(){return e.boardGame.stateMachine.emit(Jh.PURCHASE_WILD_CARD)},this.undoBtn.onClick=function(){return e.boardGame.stateMachine.emit(Jh.PURCHASE_UNDO)},this.addCardsBtn.onClick=function(){return e.boardGame.stateMachine.emit(Jh.PURCHASE_REFILL_STOCK)},this.addCardsFreeBtn.onClick=function(){return e.boardGame.stateMachine.emit(Jh.REFILL_STOCK)},this.addCardsByAdsBtn.onClick=function(){return e.boardGame.stateMachine.emit(Jh.PURCHASE_REFILL_STOCK_WITH_ADS)}},n.createWildcardButton=function(){var e=this.scene.add.container(0,0);this.scene.gameplayLayer.add(e),this.scene.gameplayLayer.bringToTop(e);var t=new cf(this.scene,vf,yf.WILD_CARD);t.setName("WildCard"),t.updateSize(t.width,100),e.add(t),this.wildCardBtn=t,this.wildCardWrapper=e,e.setSize(t.width,100)},n.createUndoBtn=function(){var e=new cf(this.scene,vf,yf.BTN_IC_UNDO);e.setName("Undo"),e.updateSize(e.width,65),this.undoBtn=e},n.createAddCardsBtn=function(){var e=new cf(this.scene,vf,yf.BTN_PLUS_FIVE_CARDS);e.setName("PlusFive");var t=ru.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsBtn=e},n.createAddCardsFreeBtn=function(){var e=new cf(this.scene,vf,yf.BTN_PLUS_FIVE_CARDS);e.setName("PlusFiveFree"),e.setCost(0);var t=ru.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsFreeBtn=e},n.createAddCardsByAdsBtn=function(){var e=new cf(this.scene,vf,yf.BTN_PLUS_FIVE_CARDS);e.setName("PlusFiveByAds"),e.showAds();var t=ru.CARD_VIEW,n=t.WIDTH,i=t.HEIGHT;e.updateMainSize(n,i),e.updateSize(e.width,80),e.alignMain(-10,0),this.addCardsByAdsBtn=e},n.showPlusCards=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=t,e.next=e.t0===vp.FREE?4:e.t0===vp.NOT_FREE?6:9;break;case 4:return n.push(this.addCardsFreeBtn),e.abrupt("break",9);case 6:return this.scene.player.getCoins()>=this.addCardsPrice&&n.push(this.addCardsBtn),e.abrupt("break",9);case 9:this.scene.gameUI.gameUILayout.showPlusCardsButtons(n),this.scene.gameUI.showEndGame();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(bp),Cf=Ef,Af=Wi.Z.GAMEPLAY_OBJECTS,wf=Af.KEY,Sf=Af.FRAME.STREAK,bf=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).point=void 0,a.pointHolder=void 0,a.createPoint(),a.createPointHolder(),a.add([a.pointHolder,a.point]),a.setSize(a.point.width,a.point.height),a}(0,s.Z)(t,e);var n=t.prototype;return n.createPoint=function(){var e=this.scene.add.image(0,1,wf,Sf.POINT_NONE);e.kill(),e.setDefaultWorldSize(),this.point=e},n.createPointHolder=function(){var e=this.scene.add.image(0,0,wf,Sf.POINT_NONE);e.setDefaultWorldSize(),this.pointHolder=e},n.setFrame=function(e){e==Sf.POINT_NONE?this.point.kill():this.point.revive(),this.point.setFrame(e)},n.getFrame=function(){return this.point.frame.name},n.runPopUpAnimation=function(e){var t=this;return this.point.setScale(.5*e),new Promise((function(n){t.scene.tweens.add({targets:t.point,scale:e,duration:350,ease:Phaser.Math.Easing.Back.Out,onComplete:n})}))},t}(Phaser.GameObjects.Container),Tf=function(e){function t(t,n,i){var a;return(a=e.call(this,t.scene,0,0)||this).comboManager=void 0,a.background=void 0,a.points=void 0,a.x2Block=void 0,a.currentItem=void 0,a.nextItem=void 0,a.pointContainer=void 0,a.itemPos=void 0,a.nextItemPos=void 0,a.exchangeItemAnimation=void 0,a.scaleBgWithAnim=void 0,a.x2BlockTween=void 0,a.setSize(n,i),a.comboManager=t,a.createBackground(),a.createPoints(),a.createItems(),a.createX2Block(),a.updateComboLength(4),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.getItemPos=function(){return new Phaser.Geom.Point(this.x+this.itemPos.x,this.y+this.itemPos.y)},n.getNextItemPos=function(){return new Phaser.Geom.Point(this.x+this.nextItemPos.x,this.y+this.nextItemPos.y)},n.getItemFrame=function(e){switch(e){case Fd.COIN:return Sf.COIN;case Fd.CHEST:return Sf.TREASURE;case Fd.CARD:return Sf.CARD;case Fd.WILD:return Sf.WILDCARD}return""},n.updateCombo=function(e){this.comboManager.isSameColor(e)&&e.length>1?this.showX2Block(!0):this.showX2Block(!1),this.points.forEach((function(t,n){if(n<e.length){var i=e[n];t.setFrame(i?Sf.POINT_RED:Sf.POINT_BLACK)}else t.setFrame(Sf.POINT_NONE)}))},n.showPoints=function(e){this.points.forEach((function(e){return e.kill()}));for(var t=0;t<e;t++){var n;null==(n=this.points[t])||n.revive()}},n.showX2Block=function(e){var t,n=e?1:0,i=e?1:0;null==(t=this.x2BlockTween)||t.stop(),this.x2BlockTween=this.scene.tweens.add({targets:this.x2Block,alpha:i,scale:n,duration:200,ease:Phaser.Math.Easing.Sine.InOut})},n.createBackground=function(){var e=this.scene.make.nineslice({key:wf,frame:Sf.BAR,width:this.width,height:this.height,leftWidth:32/3,rightWidth:116/3});e.setOrigin(1,.5),this.add(e),Phaser.Display.Align.In.RightCenter(e,this),this.background=e},n.createPoints=function(){var e=this.scene.make.container({});this.pointContainer=e,this.points=[];for(var t=0;t<6;t++){var n=new bf(this.scene,0,0);e.add(n),this.points.push(n)}this.add(e),Phaser.Display.Align.In.LeftCenter(e,this.background)},n.createItems=function(){this.itemPos=new Phaser.Geom.Point(28,2),this.nextItemPos=new Phaser.Geom.Point(75,0),this.currentItem=this.scene.add.image(0,0,wf,Sf.WILDCARD),this.currentItem.setDefaultWorldSize(),this.nextItem=this.scene.add.image(0,0,wf,Sf.COIN),this.nextItem.setDefaultWorldSize(),this.add([this.currentItem,this.nextItem]),this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItemPos.x,this.nextItemPos.y)},n.createX2Block=function(){var e=Wi.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.container(),a=this.scene.add.image(0,0,t,n.IC_INFO);a.setDefaultWorldSize(),i.setSize(a.width,a.height);var r=new jp(this.scene,{text:"x2",fontSize:this.scene.fontSize(15),strokeBlur:2,strokeBlurAlpha:.3,strokeBlurColor:0,fillColor:16776958});r.setPosition(.5,-.5),i.add([a,r]),this.add(i),i.setPosition(this.currentItem.x+this.currentItem.width/2-2,this.currentItem.y+this.currentItem.height/2-2),this.x2Block=i},n.updateRewardItems=function(e){var t,n=this.comboManager,i=n.streaks,a=n.threshold,r=e+1>=i.length?0:e+1,s=this.getItemFrame(i[e].type),o=this.getItemFrame(i[r].type);null==(t=this.exchangeItemAnimation)||t.stop(),this.currentItem.setTexture(wf,s),this.nextItem.setTexture(wf,o),this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItemPos.x,this.nextItemPos.y),this.currentItem.setDefaultWorldSize(),this.nextItem.setDefaultWorldSize(),this.nextItem.setScaleByWorld(.9),this.updateComboLength(a)},n.runLastPointPopUpAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=1/GameCore.ImageScale,n=this.points.filter((function(e){return e.getFrame()==Sf.POINT_RED||e.getFrame()==Sf.POINT_BLACK})).pop()){e.next=4;break}return e.abrupt("return");case 4:return e.abrupt("return",n.runPopUpAnimation(t));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExchangeItemAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i;null==(i=n.exchangeItemAnimation)||i.stop();var a=n.scene.tweens.timeline({onStart:function(){n.showX2Block(!1)},onComplete:function(){e()}});a.add({targets:n.nextItem,scale:.4,duration:100,ease:Phaser.Math.Easing.Sine.In}),a.add({targets:n.nextItem,scale:.6,alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){n.nextItem.setTexture(wf,t),n.nextItem.setPosition(n.nextItemPos.x,n.nextItemPos.y)}}),a.add({targets:n.nextItem,alpha:1,scale:.9/GameCore.ImageScale,duration:400,ease:Phaser.Math.Easing.Back.Out,onStart:function(){n.nextItem.setScale(0)}}),a.add({targets:n.currentItem,x:n.itemPos.x,y:n.itemPos.y,alpha:1,scale:1/GameCore.ImageScale,duration:400,offset:300,ease:Phaser.Math.Easing.Sine.In}),n.exchangeItemAnimation=a,a.play()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.reset=function(){this.updateRewardItems(0),this.showX2Block(!1),this.points.forEach((function(e){e.setFrame(Sf.POINT_NONE)}))},n.updateComboLength=function(e,t){var n,i=this;null==(n=this.scaleBgWithAnim)||n.remove();var a=505/3;switch(e){case 4:a-=56/3;break;case 5:a+=0;break;case 6:a+=56/3}if(t){var r=this.points.filter((function(e){return e.visible})).length;this.scaleBgWithAnim=this.scene.tweens.addCounter({from:this.background.displayWidth,to:a,duration:200,onStart:function(){r>e&&i.showPoints(e)},onUpdate:function(e){i.background.setSizeByWorld(e.getValue(),i.height),i.setSize(i.background.displayWidth,i.height),i.pointContainer.x=100-e.getValue()},onComplete:function(){r<e&&i.showPoints(e)}})}else this.background.setSizeByWorld(a,this.height),this.setSize(a,this.height),this.showPoints(e),this.align(e)},n.align=function(e){this.points.forEach((function(e,t){e.setPosition(18*t,0)})),this.pointContainer.setX(17*-(e-1))},n.changeRewardItemsWithAnim=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.comboManager.streaks,null!=(n=this.exchangeItemAnimation)&&n.isPlaying()&&(this.currentItem.setPosition(this.itemPos.x,this.itemPos.y),this.nextItem.setPosition(this.nextItem.x,this.nextItem.y),this.exchangeItemAnimation.stop()),a=this.currentItem,this.currentItem=this.nextItem,this.nextItem=a,r=t+1>=i.length?0:t+1,s=this.getItemFrame(i[r].type),e.abrupt("return",this.runExchangeItemAnimation(s));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getWorldPositionOfCurrentItem=function(){return this.currentItem.getWorldPosition()},t}(Phaser.GameObjects.Container),xf=function(e){function t(t){var n;return(n=e.call(this,t)||this).radius=void 0,n.letterSpacing=void 0,n.font=void 0,n.fontSize=void 0,n.charOriginX=void 0,n.charOriginY=void 0,n.characters=void 0,n.characterPool=void 0,n.radius=0,n.letterSpacing=0,n.font=Pc.ZP.STYLE.KEY,n.fontSize=30,n.charOriginX=.5,n.charOriginY=.5,n.characters=[],n.characterPool=[],n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.getCharacters=function(){return this.characters},n.setText=function(e){this.createCharacters(e),this.updateCurve()},n.setRadius=function(e){this.radius=e,this.updateCurve()},n.setLetterSpacing=function(e){this.letterSpacing=e,this.updateCurve()},n.setFonts=function(e){this.font=e,this.characters.forEach((function(t){return t.setFont(e)})),this.updateCurve()},n.setFontSize=function(e){var t=this;this.fontSize=e,this.characters.forEach((function(n){return n.setFontSize(t.scene.fontSize(e))})),this.updateCurve()},n.setOrigin=function(e,t){this.charOriginX=e,this.charOriginY=t,this.characters.forEach((function(n){return n.setOrigin(e,t)})),this.updateCurve()},n.updateCurve=function(){if(0!==this.characters.length){var e=this.radius,t=this.letterSpacing,n=-t;this.characters.forEach((function(e){return n+=e.width+t}));for(var i=-n/2,a=0;a<this.characters.length;a++){var r=this.characters[a],s=i+r.width/2;if(0!==e){var o=Math.PI/2-s/e,c=e*Math.cos(o),h=e*Math.sin(o)-e;r.setPosition(c,h),r.setRotation(o-Math.PI/2)}else r.setPosition(s,0);i+=r.width+t}var u=this.characters[0].height;this.setSize(n,u)}else this.setSize(0,0)},n.createCharacters=function(e){var t=this;this.characters.forEach((function(e){return e.kill()})),this.characters=[],this.characters=e.split("").map((function(e){var n=t.spawnChar();return n.revive(),n.setText(e),n.setOrigin(t.charOriginX,t.charOriginY),n.setFontSize(t.scene.fontSize(t.fontSize)),n.setFont(t.font),n.setScale(1),n}))},n.spawnChar=function(){return this.characterPool.find((function(e){return!e.active}))||this.createCharacter()},n.createCharacter=function(){var e=this.scene.make.bitmapText({font:this.font,origin:{x:.5,y:.5}});return this.characterPool.push(e),this.add(e),e},t}(Phaser.GameObjects.Container),Pf=xf,kf=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0;var i=1/GameCore.ImageScale;return n.scaleStart=Phaser.Math.FloatBetween(.5*i,i),n}(0,s.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.scaleX=this.lifeT*this.scaleStart,this.scaleY=this.lifeT*this.scaleStart,this.updateVelocity(),a},n.updateVelocity=function(){this.velocityX*=.985,this.velocityY*=.985},t}(Phaser.GameObjects.Particles.Particle),If=kf,Of=Wi.Z.DEFAULT,Rf=Of.KEY,Bf=Of.FRAME,Df=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).curveText=void 0,i.starParticleManager=void 0,i.starEmitter=void 0,i.entranceAnim=void 0,i.exitAnim=void 0,i.createStarParticle(),i.createCurveText(n),i}(0,s.Z)(t,e);var n=t.prototype;return n.startComboAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),this.createTextEntranceAnimation(),this.createTextExitAnimation(),e.next=5,this.entranceAnim.playAndWaitForCompletion();case 5:return e.next=7,this.exitAnim.playAndWaitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),this.stop(),this.setAlpha(1),this.createTextEntranceAnimation(t),e.next=6,this.entranceAnim.playAndWaitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),this.createTextExitAnimation(),e.next=4,this.exitAnim.playAndWaitForCompletion();case 4:this.setAlpha(0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.stop=function(){var e,t;this.starEmitter.stop(),null==(e=this.entranceAnim)||e.stop(),null==(t=this.exitAnim)||t.stop()},n.setText=function(e){this.curveText.setText(e)},n.createTextExitAnimation=function(){for(var e=0,t=this.curveText.getCharacters(),n=this.scene.tweens.createTimeline(),i=0;i<t.length;i++){var a=t[i];n.add({targets:a,scale:{value:.9},duration:200,ease:Phaser.Math.Easing.Sine.InOut,offset:e}),n.add({targets:a,scale:{value:1.15},duration:400,ease:Phaser.Math.Easing.Sine.InOut,offset:e+200}),n.add({targets:a,alpha:0,duration:250,offset:e+350}),e+=30}this.exitAnim=n},n.createTextEntranceAnimation=function(e){void 0===e&&(e=!0);var t=this.curveText.getCharacters();t.forEach((function(e){e.setScale(.5),e.setAlpha(0)}));for(var n=this.scene.tweens.createTimeline({}),i=function(e){var i=t[e],a=60*e;n.add({targets:i,props:{scale:{value:1,ease:Phaser.Math.Easing.Sine.Out},alpha:1},duration:100,offset:a,onStart:function(){t.length}}),n.add({targets:i,scale:{value:1.15},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:a+100}),n.add({targets:i,scale:{value:.95},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:a+250}),n.add({targets:i,scale:{value:1.025},duration:75,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out,offset:a+400})},a=0;a<t.length;a++)i(a);this.entranceAnim=n},n.emitStars=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.starEmitter.start(),e.next=3,(0,dl.Z)(this.scene,450);case 3:this.starEmitter.stop();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createStarParticle=function(){this.starParticleManager=this.scene.add.particles(Rf,Bf.EFFECTS.STAR_1),this.starEmitter=this.starParticleManager.createEmitter({on:!1,lifespan:{min:1200,max:2e3},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},frequency:20,scale:0,rotate:{start:0,end:180,random:!1},tint:16579179,speedX:{min:-120,max:120},speedY:{min:-80,max:80},particleClass:If}),this.add(this.starParticleManager)},n.createCurveText=function(e){this.curveText=new Pf(this.scene),this.curveText.setText(e),this.add(this.curveText)},t}(Phaser.GameObjects.Container),Lf=Df,_f=Wi.Z.DEFAULT,Mf=_f.KEY,Nf=_f.FRAME,Gf=["wellDone","super","goodJob","fantastic"],Zf=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.index=void 0,n.complimentTextsData=void 0,n.curveTextAnimation=void 0,n.glow=void 0,n.glow2=void 0,n.glowTween=void 0,n.glowTween2=void 0,n.scene=t;var i=n.scene.lang.Text;return n.complimentTextsData=[i.wellDone,i.super,i.goodJob,i.fantastic],n.create(),n.init(),n.scene.add.existing((0,fc.Z)(n)),n.kill(),n}(0,s.Z)(t,e);var n=t.prototype;return n.show=function(){var e,t;this.revive(),this.glow.setAlpha(0),this.glow2.setAlpha(0),this.glow.angle=0,this.glow2.angle=0,this.scene.tweens.add({targets:[this.glow,this.glow2],alpha:1,duration:500}),null==(e=this.glowTween)||e.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e3,repeat:-1,ease:Phaser.Math.Easing.Sine.Out,props:{angle:360}}),null==(t=this.glowTween2)||t.remove(),this.glowTween2=this.scene.tweens.add({targets:[this.glow2],duration:1e4,repeat:-1,ease:Phaser.Math.Easing.Sine.Out,props:{angle:360}}),this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.SHOW_COMPLIMENT),this.runTextPopUpAnimation()},n.init=function(){this.index=0},n.runTextPopUpAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.index+=1,this.index>=this.complimentTextsData.length&&(this.index=0),this.changeText(this.scene.lang.getText(Gf[this.index])),this.scene.tweens.add({targets:[this.glow,this.glow2],alpha:0,duration:500,delay:1200}),e.next=6,this.curveTextAnimation.startComboAnimation();case 6:this.kill(),null==(t=this.glowTween)||t.remove(),null==(n=this.glowTween2)||n.remove();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.changeText=function(e){this.curveTextAnimation.curveText.setText(e)},n.create=function(){this.index=0,this.setSize(200,50),this.setDepth(Fr.Z.EFFECT),this.createGlowEffect(),this.createGlow2Effect(),this.createCurveTextAnimation(),Phaser.Display.Align.In.Center(this,this.scene.gameZone)},n.createGlowEffect=function(){var e=this.scene.make.image({key:Mf,frame:Nf.EFFECTS.LEVEL_COMPLETE.GLOW_1,y:0});e.setWorldSize(141.9,141.6),this.add(e),this.glow=e},n.createGlow2Effect=function(){var e=this.scene.make.image({key:Mf,frame:Nf.EFFECTS.LEVEL_COMPLETE.GLOW_2,y:0});e.setWorldSize(115.5,114),this.add(e),this.glow2=e},n.createCurveTextAnimation=function(){var e=new Lf(this.scene,""),t=e.curveText;t.setFontSize(30),t.setOrigin(.5,.8),t.setPosition(0,8),t.setRadius(-600),t.setLetterSpacing(-1),this.add(e),this.curveTextAnimation=e},t}(Phaser.GameObjects.Container),Ff=Zf,Uf=function(){function e(e,t){var n=this;this.scene=void 0,this.parent=void 0,this.comboTextAnimation=void 0,this.handleResize=function(){Phaser.Display.Align.In.Center(n.comboTextAnimation,n.scene.gameZone)},this.scene=e,this.parent=t,this.comboTextAnimation=new Ff(this.scene),this.scene.world.events.on(Hr.Z.RESIZE,this.handleResize)}var t=e.prototype;return t.init=function(){this.comboTextAnimation.init()},t.reward=function(e,t){var n=this.parent.getRewardCoins()*t,i=this.parent.getRewardChestCoins()*t;switch(this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.REWARD_STREAK),this.comboTextAnimation.show(),e){case Fd.COIN:this.addCoins(n);break;case Fd.CHEST:this.addCoins(i);break;case Fd.CARD:var a=this.getCards(t);this.addCard(a);break;case Fd.WILD:var r=this.getWildCards(t);this.scene.logEconomy.logGetItem(fl.WILD_CARD,r.length,gl.STREAK_REWARDS),this.scene.logEconomy.logUseItem(fl.WILD_CARD,r.length,gl.STREAK_REWARDS),this.addCard(r)}},t.getCards=function(e){for(var t=this.scene.gameplay.boardGame,n=[],i=0;i<e;i++){var a=t.deck.getNewStockCard();a.behavior.setFrameCardDown(),n.push(a)}return n},t.getWildCards=function(e){for(var t=this.scene.gameplay.boardGame,n=[],i=0;i<e;i++){var a=t.deck.getJokerCard();n.push(a)}return n},t.addCoins=function(e){var t=this.scene.rewardManager,n=t.coinTextAnimationPool,i=t.coinAnimationPool,a=this.parent.streakBar.getItemPos(),r=a.x,s=a.y,o=this.scene.player.getCoins();t.setCoins(o+e,!1),n.runAnimation({coin:e,x:r,y:s+5,duration:1e3,delay:300,offsetY:-20}),i.runAnimationRewardCoinFromStreak(18),this.scene.logEconomy.logGetItem(fl.COIN,e,gl.STREAK_REWARDS)},t.addCard=function(e){var t=this,n=this.scene.gameplay.boardGame,i=n.stock,a=0;this.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.REWARD_CARD),this.scene.gameUI.gameUILayout.hidePlusCardsButtons(),e.forEach((function(t,a){var r=i.getCardsLength(),s=e[a-1],o=Math.min(r,2),c=Math.min(r,6);if(s){var h=r-i.cards.indexOf(s);h-o>=2?c=Math.min(r,h-2):o=Math.min(r,h+2)}var u=r-Phaser.Math.Between(o,c);i.addCardAt(t,u),n.mover.addUndoCard(t,tu.Combo,tu.Stock)})),i.bringToTop(),e.sort((function(e,t){return i.cards.indexOf(e)>i.cards.indexOf(t)?-1:1})),e.forEach((function(e){var n=t.parent.streakBar.getItemPos(),i=n.x,r=n.y;e.setPosition(i+a,r);var s=Phaser.Math.Between(1e3,1200);t.runAddCardAnim(e,s),a+=5}))},t.runAddCardAnim=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.gameplay.boardGame,a=i.stock,r=i.stock.getPosition(t),t.setScale(.5),a.setLockedManual(!0),this.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.FLY_TO_STOCK),s=this.scene.tweens.createTimeline(),o=t.move({x:r.x,y:r.y,duration:n,delay:250,onComplete:function(){a.setLockedManual(!1),a.animateAlignCards()}}),s.add({targets:t,scale:.8,duration:250}),s.add({targets:t,scale:1.2,angle:-20,duration:n/2}),s.add({targets:t,scale:1,angle:0,duration:n/2}),h=s.playAndWaitForCompletion(),e.next=14,Promise.all([h,o]);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}(),Wf=Uf,Hf=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.streakBar=void 0,n.streaks=void 0,n.randomTypes=void 0,n.index=void 0,n.enable=void 0,n.behavior=void 0,n.combo=void 0,n.soundPitch=void 0,n.rewardCoins=void 0,n.rewardChestCoins=void 0,n.playerRewards=void 0,n.rewarding=void 0,n.missComboCount=void 0,n.averageComboCount=void 0,n.updateStreakBar=function(){var e=n.getPlayerReward();if(!e)return n.rewarding=!1,n.streakBar.updateCombo(n.combo),void n.streakBar.updateComboLength(n.threshold,!0);n.rewarding=!0;var t=e.combo,i=e.rewardIndex,a=i+1>=n.streaks.length?0:i+1;n.streakBar.updateCombo(t),n.streakBar.updateComboLength(t.length,!0),n.streakBar.changeRewardItemsWithAnim(a).then(n.updateStreakBar),n.scene.vibration.performVibrating(50)},n.scene=t,n.missComboCount=0,n.averageComboCount=0,n.behavior=new Wf(n.scene,(0,fc.Z)(n)),n.streakBar=new Tf((0,fc.Z)(n),505/3,68/3),t.gameplayLayer.add(n.streakBar),n.init(),n.streakBar.updateCombo([]),n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.behavior.init(),this.enable=!0,this.index=0,this.soundPitch=0,this.combo=[],this.streaks=[],this.randomTypes=[],this.clearPlayerRewards();var t=pf.instance.reward.streak,n=t.coin,i=t.chest;this.setRewardCoin(n),this.setRewardChestCoin(i)},n.setStreak=function(e){var t=this,n=e.fixed;if(e.random.split("|").forEach((function(e){t.randomTypes.push(e)})),0===n.length){var i=this.getRandomStreak();this.streaks.push(i)}else n.forEach((function(e){var n=e.split("|"),i=n[0],a=parseInt(n[1]);t.streaks.push({type:i,threshold:a})}));var a=this.getRandomStreak();this.streaks.push(a),this.streakBar.reset()},n.setStreakIndex=function(e,t,n){this.index=e,this.streaks[e]={type:t,threshold:n},this.streakBar.updateRewardItems(e)},n.getStreakIndex=function(){return this.index},n.getCombo=function(){return[].concat(this.combo)},n.getComboHeight=function(){return this.soundPitch.valueOf()},n.reset=function(){this.combo.length>0&&(this.averageComboCount=(this.averageComboCount*this.missComboCount+this.combo.length)/(this.missComboCount+1),this.missComboCount+=1),this.soundPitch=0,this.combo=[],this.streakBar.updateCombo([])},n.setEnable=function(e){this.enable=e},n.setCombo=function(e,t){this.combo=e,this.soundPitch=t,0==this.isRewarding()&&this.streakBar.updateCombo(e)},n.setRewardCoin=function(e){this.rewardCoins=e},n.setRewardChestCoin=function(e){this.rewardChestCoins=e},n.getRewardCoins=function(){return this.rewardCoins},n.getRewardChestCoins=function(){return this.rewardChestCoins},n.isPlayerRewarded=function(){return this.combo.length>=this.threshold},n.isLastComboForStreak=function(){return this.combo.length+1===this.threshold},n.increaseComboWithSound=function(e){this.soundPitch=Math.min(this.soundPitch+1,12),this.increaseCombo(e),this.playIncreaseComboSound()},n.increaseCombo=function(e){if(this.enable){var t=e.behavior.isRed();this.setCombo([].concat(this.combo,[t]),this.soundPitch),this.streakBar.runLastPointPopUpAnimation(),this.isPlayerRewarded()&&this.handlePlayerReward()}},n.playIncreaseComboSound=function(){this.scene.audio.playAudioSprite(Fc.Z.CARD_COMBO.KEY,"n_card_"+this.soundPitch)},n.isSameColor=function(e){var t=e[0];return void 0!=t&&!e.some((function(e){return e!==t}))},n.isRewarding=function(){return this.rewarding},n.clearPlayerRewards=function(){this.playerRewards=[],this.rewarding=!1},n.addPlayerReward=function(e,t){this.playerRewards.push({combo:e,rewardIndex:t})},n.getPlayerReward=function(){return this.playerRewards.shift()},n.handlePlayerReward=function(){var e=this.streaks[this.index].type,t=[].concat(this.combo);this.combo=[],this.isSameColor(t)?this.behavior.reward(e,2):this.behavior.reward(e,1),this.scene.gameplay.boardGame.increaseStreakCount(),this.addPlayerReward(t,this.index);var n=this.getRandomStreak();this.streaks[this.index]=n,this.index=this.index+1>=this.streaks.length?0:this.index+1,0==this.isRewarding()&&this.updateStreakBar()},n.resetLog=function(){this.averageComboCount=0,this.missComboCount=0},n.getAverageComboCount=function(){return this.averageComboCount},n.getRandomStreak=function(){var e=Phaser.Utils.Array.GetRandom(this.randomTypes),t=Phaser.Math.Between(4,6);switch(e){case Fd.CARD:t=5;break;case Fd.WILD:t=6}return{type:e,threshold:t}},(0,H.Z)(t,[{key:"threshold",get:function(){return this.streaks[this.index].threshold}}]),t}(bp),Yf=Hf,Kf=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.multiplier=void 0,this.isEventHappening=void 0,this.totalScoreOnEvent=void 0,this.collectedScores=void 0,this.collectedCards=void 0,this.scorePerCard=void 0,this.scene=e,this.eventManager=t,this.multiplier=1.5,this.isEventHappening=!1}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.boxingDuel.isHappening()&&(this.isEventHappening=!0),this.totalScoreOnEvent=Math.floor(this.eventManager.totalCards*this.multiplier)},t.handleCollectCard=function(){return this.scorePerCard=0,this.isEventHappening&&(this.scorePerCard=this.generateRandomPointsForCards(),this.collectedScores+=this.scorePerCard),{active:this.isEventHappening,scorePerCard:this.scorePerCard}},t.handleUndo=function(e){this.collectedScores-=e,this.collectedCards--},t.generateRandomPointsForCards=function(){this.totalScoreOnEvent=Math.round(this.eventManager.totalCards*this.multiplier);var e=this.totalScoreOnEvent-this.collectedScores,t=this.eventManager.totalCards-this.collectedCards;if(t<=0)throw new Error("No remaining cards to distribute points to.");var n=e/t,i=Math.ceil(n);return this.collectedCards++,Math.round(Phaser.Math.Between(1,i))},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0,this.collectedCards=0},e}(),zf=Kf,Vf=function(e){return e[e.BOXING_DUEL=0]="BOXING_DUEL",e[e.WEEKLY_TOURNAMENT=1]="WEEKLY_TOURNAMENT",e[e.RACE=2]="RACE",e}(Vf||{}),jf={WEEKLY_TOURNAMENT:"weekly_tournament",BOXING_DUEL:"boxing_duel",OFFSHORE_RACE:"offshore-race"},Xf=Wi.Z.GAMEPLAY_OBJECTS,qf=Xf.KEY,Jf=Xf.FRAME,Qf=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).value=void 0,i.scene=t,i.createIcon(n),i.createValue(),i.alignItems(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.setScorePerCard=function(e){this.value.setText("+"+e)},n.alignItems=function(){Phaser.Display.Align.In.BottomRight(this.value,this,3,2)},n.createIcon=function(e){var t=e===Vf.BOXING_DUEL?Jf.BLUE_GLOVE:Jf.CUP,n=this.scene.add.image(0,0,qf,t);n.setDefaultWorldSize(),n.setDepth(Fr.Z.PRIORITY),this.add(n),this.setSize(n.width,n.height)},n.createValue=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(14),text:"+1",origin:{x:.5,y:.5}});this.add(e),this.value=e},t}(Phaser.GameObjects.Container),$f=Qf,em=function(){function e(e){this.scene=void 0,this.totalEvents=[],this.glovePool=[],this.cupPool=[],this.scene=e}var t=e.prototype;return t.runAnimation=function(e,t){var n=this;t.forEach((function(t){return n.runEventAnimation(t.eventType,t.scorePerCard,e)}))},t.runEventAnimation=function(e,t,n){var i,a,r=n.x,s=n.y;switch(e){case Vf.BOXING_DUEL:i=this.getGlove(),a=s-(this.totalEvents.length-1)/2*35;break;case Vf.WEEKLY_TOURNAMENT:i=this.getCup(),a=s+(this.totalEvents.length-1)/2*35;break;default:return}i.setPosition(r+20,a),i.setScorePerCard(t),this.runEventAnimationWithItem(i)},t.runEventAnimationWithItem=function(e){var t=this;e.setDepth(Fr.Z.PRIORITY),e.revive(),e.setAlpha(1),e.setScale(0),this.scene.add.tween({targets:e,scale:{from:0,to:1},duration:300,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.scene.add.tween({targets:e,scale:{from:1,to:.8},delay:200,duration:1500,ease:Phaser.Math.Easing.Sine.In})}}),this.scene.add.tween({targets:e,y:{from:e.y,to:e.y-50},alpha:{from:1,to:0,delay:300},delay:250,duration:1e3,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){e.kill(),t.scene.tweens.killTweensOf(e)}})},t.getGlove=function(){return this.getEventItem(this.glovePool,Vf.BOXING_DUEL)},t.getCup=function(){return this.getEventItem(this.cupPool,Vf.WEEKLY_TOURNAMENT)},t.getEventItem=function(e,t){var n=e.find((function(e){return!e.active}));return n||((n=new $f(this.scene,t)).kill(),e.push(n)),n},e}(),tm=em,nm=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.collectedScores=void 0,this.isEventHappening=void 0,this.scene=e,this.eventManager=t}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.offshoreRace.isHappening()&&(this.isEventHappening=!0),this.collectedScores=1},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0},e}(),im=nm,am=function(){function e(e,t){this.scene=void 0,this.eventManager=void 0,this.multiplier=void 0,this.isEventHappening=void 0,this.totalScoreOnEvent=void 0,this.collectedScores=void 0,this.collectedCards=void 0,this.scorePerCard=void 0,this.scene=e,this.eventManager=t,this.multiplier=1,this.isEventHappening=!1}var t=e.prototype;return t.initEvent=function(){this.resetEventItemAmount(),this.scene.weeklyTournament.isPlayingTournament()&&(this.isEventHappening=!0),this.totalScoreOnEvent=Math.floor(this.eventManager.totalCards*this.multiplier)},t.handleCollectCard=function(){return this.scorePerCard=0,this.isEventHappening&&(this.scorePerCard=this.generateRandomPointsForCards(),this.collectedScores+=this.scorePerCard),{active:this.isEventHappening,scorePerCard:this.scorePerCard}},t.handleUndo=function(e){this.collectedScores-=e,this.collectedCards--},t.generateRandomPointsForCards=function(){this.totalScoreOnEvent=Math.round(this.eventManager.totalCards*this.multiplier);var e=this.totalScoreOnEvent-this.collectedScores,t=this.eventManager.totalCards-this.collectedCards;if(t<=0)throw new Error("No remaining cards to distribute points to.");var n=e/t,i=Math.ceil(n);return this.collectedCards++,Math.round(Phaser.Math.Between(1,i))},t.getEventItemAmount=function(){return this.isEventHappening?this.collectedScores:0},t.resetEventItemAmount=function(){this.isEventHappening=!1,this.collectedScores=0,this.collectedCards=0},e}(),rm=am;function sm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return om(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return om(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function om(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var cm=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.eventAnimator=void 0,n.boxingDuelEvent=void 0,n.weeklyTournamentEvent=void 0,n.offshoreRaceEvent=void 0,n.totalCards=void 0,n.eventStepsData=[],n.handleCollectCard=function(e){var t=[];n.isCardTypeValidToAddScore(e.behavior.type)||e.behavior.type!==Qh.BOOM&&e.behavior.type!==Qh.CHANGER||n.totalCards++;var i=n.boxingDuelEvent.handleCollectCard(),a=n.weeklyTournamentEvent.handleCollectCard();i.active&&t.push({eventType:Vf.BOXING_DUEL,scorePerCard:i.scorePerCard}),a.active&&t.push({eventType:Vf.WEEKLY_TOURNAMENT,scorePerCard:a.scorePerCard}),n.eventAnimator.runAnimation(e,t);var r={step:n.scene.gameplay.boardGame.mover.moves,items:{boxingDuel:i.scorePerCard,weeklyTournament:a.scorePerCard}};n.eventStepsData.push(r)},n.handleUndo=function(){var e=n.scene.gameplay.boardGame.mover.moves,t=n.eventStepsData.filter((function(t){return t.step===e}));if(n.eventStepsData=n.eventStepsData.filter((function(t){return t.step!==e})),0!==t.length)for(var i,a=sm(t);!(i=a()).done;){var r=i.value;n.boxingDuelEvent.handleUndo(r.items.boxingDuel),n.weeklyTournamentEvent.handleUndo(r.items.weeklyTournament)}},n.scene=t,n.createEventAnimator(),n.createEvents(),n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.stop(),this.scene.events.on(Tu.Z.COLLECT_CARD,this.handleCollectCard,this),this.scene.events.on(Tu.Z.UNDO,this.handleUndo,this)},n.setup=function(e){var t=this;this.totalCards=e.filter((function(e){return t.isCardTypeValidToAddScore(e.type)})).length},n.isCardTypeValidToAddScore=function(e){return![Qh.KEY,Qh.LOCK,Qh.JOKER,Qh.BOOM,Qh.CHANGER,Qh.PLUS_FIVE,Qh.PLUS_FOUR,Qh.PLUS_THREE,Qh.PLUS_TWO,Qh.PLUS_ONE,Qh.WINDMILL,Qh.MYSTERIOUS,Qh.TREASURE,Qh.SQUIRREL].includes(e)},n.stop=function(){this.scene.events.off(Tu.Z.COLLECT_CARD,this.handleCollectCard,this),this.scene.events.off(Tu.Z.UNDO,this.handleUndo,this)},n.start=function(){this.boxingDuelEvent.initEvent(),this.weeklyTournamentEvent.initEvent(),this.offshoreRaceEvent.initEvent()},n.createEventAnimator=function(){this.eventAnimator=new tm(this.scene)},n.createEvents=function(){var e=this;Object.values(jf).forEach((function(t){switch(t){case jf.WEEKLY_TOURNAMENT:e.weeklyTournamentEvent=new rm(e.scene,e);break;case jf.BOXING_DUEL:e.boxingDuelEvent=new zf(e.scene,e);break;case jf.OFFSHORE_RACE:e.offshoreRaceEvent=new im(e.scene,e)}}))},n.getBoxingDuelItemAmount=function(){return this.boxingDuelEvent.getEventItemAmount()},n.getWeeklyTournamentItemAmount=function(){return this.weeklyTournamentEvent.getEventItemAmount()},n.getRaceItemAmount=function(){return this.offshoreRaceEvent.getEventItemAmount()},n.hasAtLeastOneEventRunning=function(){return this.boxingDuelEvent.getEventItemAmount()>0||this.weeklyTournamentEvent.getEventItemAmount()>0||this.offshoreRaceEvent.getEventItemAmount()>0},n.getCurrentEventItems=function(){return{boxingDuel:this.getBoxingDuelItemAmount(),weeklyTournament:this.getWeeklyTournamentItemAmount(),offshoreRace:this.getRaceItemAmount()}},n.resetEventItemAmount=function(){this.boxingDuelEvent.resetEventItemAmount(),this.weeklyTournamentEvent.resetEventItemAmount(),this.offshoreRaceEvent.resetEventItemAmount()},t}(bp),hm=cm,um=Wi.Z.GAMEPLAY_DEFAULT,lm=um.KEY,dm=um.FRAME,pm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).text=void 0,a.icon=void 0,a.bg=void 0,a.shadow=void 0,a.create(),a}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e,t){switch(this.text.setText(e),t){case au.CENTER:this.text.setOrigin(.5,.5),this.text.setCenterAlign();break;case au.LEFT:this.text.setOrigin(0,.5),this.text.setLeftAlign();break;case au.RIGHT:this.text.setOrigin(1,.5),this.text.setRightAlign()}},n.updateIcon=function(e,t,n){this.icon.setTexture(e,t),this.icon.setDefaultWorldSize(),this.icon.setVisible(n)},n.create=function(){var e=this.scene.add.image(0,0,lm,dm.TUTORIAL.TEXT_BOX);e.setDefaultWorldSize();var t=this.scene.make.nineslice({key:Wi.Z.DEFAULT.KEY,frame:Wi.Z.DEFAULT.FRAME.POPUP_CONTENT,leftWidth:15,rightWidth:15,topHeight:15,bottomHeight:15,width:235,height:70});this.setSize(t.width,t.height);var n=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:this.scene.lang.Text.tipPlayWildCard});n.setCenterAlign();var i=this.scene.add.image(0,0,lm,dm.TUTORIAL.ARROW_DOWN);i.setDefaultWorldSize(),this.add([e,t,n,i]),Phaser.Display.Align.In.Center(i,this,0,-80),this.shadow=e,this.bg=t,this.text=n,this.icon=i},t}(Phaser.GameObjects.Container),fm=pm,mm=Wi.Z.GAMEPLAY_DEFAULT,gm=mm.KEY,vm=mm.FRAME,ym=function(e){function t(t){var n;return(n=e.call(this,t,0,0,gm,vm.TUTORIAL.HIGHLIGHT_CIRCLE)||this).topBg=void 0,n.bottomBg=void 0,n.leftBg=void 0,n.rightBg=void 0,n.setCircleInteractive(),n.createBackground(),n.setPosition(0,0),n.scene.events.on("postupdate",n.postUpdate,(0,fc.Z)(n)),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.postUpdate=function(){this.updateBg()},n.setDepth=function(t){var n,i,a,r;return e.prototype.setDepth.call(this,t),null==(n=this.topBg)||n.setDepth(t),null==(i=this.bottomBg)||i.setDepth(t),null==(a=this.leftBg)||a.setDepth(t),null==(r=this.rightBg)||r.setDepth(t),this},n.setAlpha=function(t,n,i,a){return e.prototype.setAlpha.call(this,t,n,i,a),this.topBg.setAlpha(t,n,i,a),this.bottomBg.setAlpha(t,n,i,a),this.leftBg.setAlpha(t,n,i,a),this.rightBg.setAlpha(t,n,i,a),this},n.setTint=function(t,n,i,a){return e.prototype.setTint.call(this,t,n,i,a),this.topBg.setTint(t,n,i,a),this.bottomBg.setTint(t,n,i,a),this.leftBg.setTint(t,n,i,a),this.rightBg.setTint(t,n,i,a),this},n.kill=function(){var t,n,i,a;e.prototype.kill.call(this),null==(t=this.topBg)||t.kill(),null==(n=this.bottomBg)||n.kill(),null==(i=this.leftBg)||i.kill(),null==(a=this.rightBg)||a.kill()},n.revive=function(){var t,n,i,a;e.prototype.revive.call(this),null==(t=this.topBg)||t.revive(),null==(n=this.bottomBg)||n.revive(),null==(i=this.leftBg)||i.revive(),null==(a=this.rightBg)||a.revive()},n.updateBg=function(){if(this.topBg&&this.active){var e=this.x,t=this.y,n=this.alpha,i=this.displayHeight,a=this.displayWidth,r=this.scene.world.getWorldSize(),s=r.width,o=r.height;this.topBg.setAlpha(n),this.bottomBg.setAlpha(n),this.leftBg.setAlpha(n),this.rightBg.setAlpha(n);var c=t-i/2,h=e-a/2,u=o-t-i/2,l=s-e-a/2;this.topBg.setWorldSize(s,c),this.bottomBg.setWorldSize(s,u),this.leftBg.setWorldSize(h,i),this.rightBg.setWorldSize(l,i),c<=0?this.topBg.kill():this.topBg.revive(),u<=0?this.bottomBg.kill():this.bottomBg.revive(),h<=0?this.leftBg.kill():this.leftBg.revive(),l<=0?this.rightBg.kill():this.rightBg.revive(),this.topBg.setX(s/2),this.topBg.setY(t-i/2-c/2),this.bottomBg.setX(s/2),this.bottomBg.setY(t+i/2+u/2),this.leftBg.setY(t),this.leftBg.setX(e-a/2-h/2),this.rightBg.setY(t),this.rightBg.setX(e+a/2+l/2)}},n.createBackground=function(){this.topBg=this.scene.add.image(0,0,gm,vm.TUTORIAL.BLACK_BG),this.bottomBg=this.scene.add.image(0,0,gm,vm.TUTORIAL.BLACK_BG),this.leftBg=this.scene.add.image(0,0,gm,vm.TUTORIAL.BLACK_BG),this.rightBg=this.scene.add.image(0,0,gm,vm.TUTORIAL.BLACK_BG),this.topBg.setInteractive(),this.bottomBg.setInteractive(),this.leftBg.setInteractive(),this.rightBg.setInteractive()},n.setCircleInteractive=function(){this.setInteractive({pixelPerfect:!0})},t}(Phaser.GameObjects.Image),Em=ym,Cm=Wi.Z.GAMEPLAY_DEFAULT,Am=Cm.KEY,wm=Cm.FRAME,Sm=function(e){function t(t){var n;return(n=e.call(this,t)||this).hand=void 0,n.handScaleDefault=1,n.toggleAnimation=void 0,n.tapAnimation=void 0,n.isTapping=void 0,n.timeToTap=void 0,n.remainTimeToTap=void 0,n.test=void 0,n.name="TutorialHand",n.addHand(),n.isTapping=!1,n.timeToTap=1e3,n.remainTimeToTap=0,n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.update=function(e){this.isTapping&&this.timeToTap>=0&&(this.remainTimeToTap+=e,this.remainTimeToTap>=this.timeToTap&&(this.timeToTap=-1,this.doubleTap()))},n.setTappingTime=function(e){this.timeToTap=e,this.remainTimeToTap=0},n.runTap=function(){this.isTapping=!0,this.setTappingTime(0)},n.stopTap=function(){var e;null==(e=this.tapAnimation)||e.remove(),this.hand.setDefaultWorldSize(),this.hand.setAngle(0),this.hide(),this.timeToTap=-1,this.isTapping=!1},n.addHand=function(){this.hand=this.scene.make.image({key:Am,frame:wm.TUTORIAL.HAND,origin:{x:.5,y:.5}}),this.hand.setDefaultWorldSize(),this.handScaleDefault=this.hand.scale,this.resetHandPosition(),this.setSize(this.hand.width,this.hand.height),this.add(this.hand)},n.doubleTap=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1/GameCore.ImageScale,null==(n=this.tapAnimation)||n.remove(),this.show(),this.hand.setAngle(0),this.tapAnimation=this.scene.tweens.add({targets:[this.hand],ease:Phaser.Math.Easing.Cubic.InOut,props:{scale:{from:i,to:.85*i,duration:300,ease:Phaser.Math.Easing.Cubic.InOut},angle:{start:0,from:0,value:-12,duration:300,ease:Phaser.Math.Easing.Cubic.InOut}},repeatDelay:500,repeat:1,yoyo:!0,onYoyo:function(){a.scene.audio.playAudioSprite(Fc.Z.GAMEPLAY.KEY,ec.Z.POP,{},!0)},onComplete:function(){t&&t(),a.hide(),a.setTappingTime(2e3)}}),e.next=7,this.tapAnimation.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.tapAndHold=function(e,t){this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:this.handScaleDefault,to:.8*this.handScaleDefault},angle:{from:0,value:-10,duration:200}},onComplete:t})},n.unHold=function(e,t,n){var i=this;this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:.8*this.handScaleDefault,to:this.handScaleDefault},angle:{from:-10,value:0,duration:200}},onComplete:function(){t&&i.hide(),n&&n()}})},n.show=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.toggleAnimation)||t.remove(),this.toggleAnimation=this.scene.tweens.add({targets:this,alpha:1,duration:350,ease:Phaser.Math.Easing.Cubic.InOut}),e.next=4,this.toggleAnimation.waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hide=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.toggleAnimation)||t.remove(),this.toggleAnimation=this.scene.tweens.add({targets:this,alpha:0,duration:350,ease:Phaser.Math.Easing.Cubic.InOut}),e.next=4,this.toggleAnimation.waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preDestroy=function(){this.scene.tweens.killTweensOf(this.hand)},n.kill=function(){e.prototype.kill.call(this),this.resetHandPosition()},n.setHandPositionOnDoubleClick=function(){this.hand.setPosition(26,14)},n.resetHandPosition=function(){this.hand.setPosition(26,22)},t}(Phaser.GameObjects.Container),bm=Sm,Tm=function(e){this.guideManager=void 0,this.boardGame=void 0,this.guideManager=e,this.boardGame=e.boardGame},xm=function(){function e(e,t,n){this.scene=void 0,this.boardGame=void 0,this.guideManager=void 0,this.isPlaying=void 0,this.time=void 0,this.remain=void 0,this.hintRunning=void 0,this.onDraw=function(){},this.onDrawStock=function(){},this.onUndo=function(){},this.scene=e,this.boardGame=n,this.guideManager=t,this.isPlaying=!1,this.time=0,this.remain=0,this.hintRunning=!1}var t=e.prototype;return t.resetHintArrow=function(){this.remain=0},t.setHintTime=function(e){this.time=e},t.runHint=function(){this.hintRunning=!0,this.remain=0},t.stopHint=function(){this.hintRunning=!1,this.remain=0},t.play=function(){this.isPlaying=!0,this.listenEvents()},t.stop=function(){this.isPlaying&&(this.isPlaying=!1,this.stopHint(),this.stopListenEvents())},t.listenEvents=function(){},t.stopListenEvents=function(){},t.update=function(e){var t=this.guideManager;if(this.hintRunning&&!t.arrow.visible&&!t.tutorialHand.visible&&(this.remain+=e,this.remain>=this.time)){var n=this.boardGame.hint,i=n.getPileMatchableCards(),a=n.getCardWithLongestChain(i);a&&0==a.isMoving&&this.guideManager.showHandAnimation(a.x,a.y),this.resetHintArrow()}},t.showUndoGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.undoBtn.getWorldPosition(),i=n.x,a=n.y;this.guideManager.showHandAnimation(i,a-10);var r=GameCore.layoutInitializer.isLandscape?this.scene.lang.Text.guideUndo:this.scene.lang.Text.guideUndoPortrait;this.guideManager.showGuide({x:i,y:a,showHighlight:!0,textBox:{textX:i-50,textY:a-100,text:r,textAlignType:au.RIGHT},icon:{iconX:i-17,iconY:a-70,iconDirection:Bg.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(Jh.UNDO,(function(){t.guideManager.hideGuide(),e&&e()}))},e}(),Pm=xm,km={SLICE:"guideSliceBooster",STORM:"guideStormBooster",WILD_CARD:"guideWildCardBooster"},Im=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this);var t=this.scene.gameplay.boosterManager,n=this.scene.level.getLevel(),i=this.scene.gameSettings.requiredLevels,a=i.boosterSlice,r=i.boosterStorm,s=i.boosterWildCard,o=this.guideManager,c=o.guideContainer,h=o.tutorialHand,u=o.highLightCircle,l=o.zone;this.showGuideCounting=0,u.setDepth(Fr.Z.PRIORITY),h.setDepth(Fr.Z.PRIORITY),c.setDepth(Fr.Z.PRIORITY),l.setDepth(Fr.Z.PRIORITY);var d=t.getAmountBoosters();switch(n){case a:return void(d.slice<=0&&t.increaseBoosterAmount(Ki.SLICE,1));case r:return t.stormBooster.setShouldChoosePosForGuide(!0),void(d.storm<=0&&t.increaseBoosterAmount(Ki.STORM,1));case s:return void(d.wildCard<=0&&t.increaseBoosterAmount(Ki.WILD_CARD,1))}},n.stop=function(){if(this.isPlaying){this.guideManager.hideGuide();var t=this.guideManager,n=t.guideContainer,i=t.tutorialHand,a=t.highLightCircle,r=t.zone;a.setDepth(Fr.Z.GUIDE),i.setDepth(Fr.Z.GUIDE),n.setDepth(Fr.Z.GUIDE),r.setDepth(Fr.Z.GUIDE)}e.prototype.stop.call(this)},n.showBoosterGuide=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l,d,p,f=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.showGuideCounting>0)){e.next=2;break}return e.abrupt("return");case 2:return a=t.getWorldPosition(),r=a.x,s=a.y,o=n.getWorldPosition(),h=o.x,u=o.y,this.showGuideCounting+=1,l=this.guideManager.zone,d=this.scene.world.getWorldSize(),d.width,d.height,l.setVisible(!0),e.next=10,(0,dl.Z)(this.scene,300);case 10:this.guideManager.showHandAnimation(r,s),p=this.scene.lang.getText(km[i]),this.guideManager.showGuide({x:r,y:s+10,showHighlight:!0,textBox:{text:p,textX:r,textY:s-80,useBackground:!0,fontSize:15,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}}),this.scene.events.once(Tu.Z.BOOSTER_SELECTED,(function(){f.isPlaying&&(t.setDisabled(!0),t.setAlpha(1),f.guideManager.hideGuide().then((function(){return f.showHitPlayGuide(h,u)})))}));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.showHitPlayGuide=function(e,t){this.guideManager.showHandAnimation(e,t),this.guideManager.showGuide({x:e,y:t,showHighlight:!0,circleScaleX:1.6,circleScaleY:1,textBox:{textVisible:!1},icon:{iconVisible:!1}})},t}(Pm),Om=Im;function Rm(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bm(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Dm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCount=void 0,a.onDraw=function(){var e=a.getCardToShow();e&&a.show(e)},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCount=0;var t=this.getCardToShow();t&&this.show(t)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.getCardToShow=function(){if(!(this.showGuideCount>0)){var e=this.boardGame,t=e.pile,n=e.waste.getOnTopCard();if(n)for(var i,a,r=function(){for(var e=a.value,i=t.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),r=0;r<i.length;r++){var s=t.checkOverlap(i[r]),o=t.isOverLap(i[r],e),c=t.isMatch(i[r],n);if(!s&&o&&c)return{v:i[r]}}},s=Rm(t.cards.filter((function(e){return e.isType(Qh.KEY)})));!(a=s()).done;)if(i=r())return i.v}},n.show=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCount+=1,n=t.payload,i=n.x,a=n.y,this.guideManager.showHandAnimation(i,a),e.next=5,this.guideManager.showGuide({x:i,y:a,showHighlight:!0,textBox:{textX:i-10,textY:a+70,text:this.scene.lang.Text.guideLock,textAlignType:au.CENTER},icon:{iconVisible:!1}});case 5:t.once(Tu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pm),Lm=Dm,_m=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDraw=function(){a.guideManager.hideHandAnimation(),a.setHintTime(2e3),a.resetHintArrow()},a.hideBackground=function(){a.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0).then((function(){a.guideManager.guideContainer.setDepth(Fr.Z.GAMEPLAY-1),a.scene.gameUI.coinBarButton.setDepth(Fr.Z.GAMEPLAY),a.scene.gameUI.levelTitle.setDepth(Fr.Z.GAMEPLAY)}))},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.scene.gameplay.setEnableCardInput(!1),this.runHint(),this.setHintTime(50),this.showHowToPlayGuide(),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground);var t=this.boardGame.waste.getOnTopCard();t&&t.moveToTopLayer(),this.scene.gameplay.setEnableCardInput(!0),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var n=this.boardGame.hint,i=n.getPileMatchableCards(),a=n.getCardWithLongestChain(i);a&&a.moveToTopLayer(),null==a||a.once(Tu.Z.MOVE_TO_WASTE,this.hideBackground)},n.stop=function(){this.isPlaying&&this.guideManager.guideContainer.setDepth(Fr.Z.GUIDE+1);e.prototype.stop.call(this)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this)},n.showHowToPlayGuide=function(){var e=this.scene.world.getWorldSize(),t=(e.width,e.height),n=this.guideManager,i=n.guideContainer,a=n.zone;i.setDepth(Fr.Z.GUIDE),this.guideManager.showGuide({x:0,y:0,circleScaleX:1,circleScaleY:1,showHighlight:!1,icon:{iconVisible:!1},textBox:{text:this.scene.lang.Text.guideOne,textX:200,textY:t/2+57,useBackground:!0,fontSize:15,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70}}),a.setVisible(!1)},n.update=function(t){e.prototype.update.call(this,t)},t}(Pm),Mm=_m,Nm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDraw=function(){a.canShowWildCardGuideNormal()&&a.showWildCardGuideNormal()},a.onDrawStock=function(){a.getHintCard()?a.guideManager.hideArrowAnimation():a.guideManager.arrow.visible||a.showWildCardGuideNormal()},a.onUndo=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.guideManager.arrow.visible&&a.guideManager.hideArrowAnimation(),a.canShowWildCardGuideNormal()&&a.showWildCardGuideNormal();case 2:case"end":return e.stop()}}),e)}))),a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showWildCardGuide(this.scene.lang.Text.guideWildCard)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(Jh.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(Jh.UNDO,this.onUndo,this)},n.canShowWildCardGuideNormal=function(){return!this.guideManager.arrow.visible&&(!this.getHintCard()&&!(this.boardGame.pile.cards.length<=0))},n.getHintCard=function(){var e=this.boardGame.hint,t=e.getPileMatchableCards();return e.getCardWithLongestChain(t)},n.showWildCardGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),i=n.x,a=n.y;this.scene.gameplayLayer.setDepth(Fr.Z.GUIDE),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.boardGame.gameplay.coinUsingManager.wildCardWrapper),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var r=this.getHintCard();r&&this.scene.gameplayLayer.bringToTop(r);var s=this.boardGame.waste.getOnTopCard();s&&this.scene.gameplayLayer.bringToTop(s),this.guideManager.showHandAnimation(i,a),this.guideManager.showGuide({x:i,y:a,showHighlight:!1,textBox:{textX:i-150,textY:a-110,text:e,textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconX:i-17,iconY:a-85,iconDirection:Bg.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(Jh.DRAW_WILD_CARD,(function(){t.guideManager.hideGuide(),t.scene.gameplay.setEnableCardInput(!1),(0,dl.Z)(t.scene,900).then((function(){t.scene.gameplay.setEnableCardInput(!0),t.showValueCardGuide()}))}))},n.showWildCardGuideNormal=function(){var e=this,t=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),n=t.x,i=t.y;this.guideManager.showArrowAnimation(n,i-80),this.boardGame.stateMachine.once(Jh.DRAW_WILD_CARD,(function(){e.guideManager.hideArrowAnimation()}))},n.showValueCardGuide=function(){var e=this,t=this.getHintCard();if(t){this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),t.moveToTopLayer();var n=this.boardGame.waste.getOnTopCard();n&&this.scene.gameplayLayer.bringToTop(n);var i=ru.CARD_VIEW,a=i.WIDTH,r=i.HEIGHT;this.guideManager.showHandAnimation(t.x+a/2-10,t.y+r/2-10),this.guideManager.showGuide({x:t.x,y:t.y,showHighlight:!1,textBox:{textX:t.x-135,textY:t.y+100,text:this.scene.lang.Text.guideWildCard2,textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70,boxWidth:165},icon:{iconX:t.x-65,iconY:t.y+35,iconDirection:Bg.RIGHT}}),this.boardGame.stateMachine.once(Jh.DRAW_PILE,(function(){e.guideManager.hideGuide(),e.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0),e.scene.gameplayLayer.setDepth(Fr.Z.GAMEPLAY)}))}},t}(Pm),Gm=Nm,Zm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDrawStock=function(){var e=a.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&a.showUndoGuide())},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showStreakGuide()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this)},n.showStreakGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.comboManager.streakBar.getWorldPosition(),n=t.x,i=t.y,e.next=3,this.guideManager.showGuide({x:0,y:0,circleScaleX:1.05,circleScaleY:1,showHighlight:!1,textBox:{textX:n-80,textY:i+70,text:this.scene.lang.Text.guideStreak,textAlignType:au.CENTER},icon:{iconX:n-65,iconY:i+15,iconDirection:Bg.RIGHT}});case 3:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.guideManager.hideGuide()}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pm),Fm=Zm,Um=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showStockGuideCounting=void 0,a.onDraw=function(){(a.resetHintArrow(),a.guideManager.hideHandAnimation(),a.showStockGuideCounting>0)||a.boardGame.hint.getPileMatchableCards().length<=0&&(a.showStockGuideCounting+=1,a.stopHint(),a.showStockGuide())},a.onUndo=function(){a.resetHintArrow(),a.guideManager.hideArrowAnimation()},a.onDrawStock=function(){a.resetHintArrow();var e=a.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&(a.stopHint(),a.showUndoGuide((function(){a.runHint()}))))},a.showStockGuideCounting=0,a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.runHint(),this.setHintTime(3e3),this.showStockGuideCounting=0},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.UNDO,this.onUndo,this)},n.update=function(t){e.prototype.update.call(this,t)},n.showStockGuide=function(){var e=this,t=this.boardGame.stock,n=t.x,i=t.y;this.guideManager.showHandAnimation(n,i),this.guideManager.showGuide({x:n,y:i,textBox:{textX:n+55,textY:i-105,text:this.scene.lang.Text.guideDrawStock,textAlignType:au.LEFT},icon:{iconX:n+17,iconY:i-75,iconDirection:Bg.DOWN},showHighlight:!0}),this.boardGame.stateMachine.once(Jh.DRAW_STOCK,(function(){e.guideManager.hideGuide(),e.runHint()}))},t}(Pm),Wm=Um,Hm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.onDraw=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame.waste.getOnTopCard();if(e){var t=a.boardGame.pile;t.cards.filter((function(e){return e.isMysterious})).some((function(n){for(var i=[],r=t.cards.filter((function(e){return e!==n&&e.active&&e.payload.depth>n.payload.depth})),s=0;s<r.length;s++)t.isOverLap(r[s],n)&&i.push(r[s]);if(1==i.length&&!t.checkOverlap(i[0])&&t.isMatch(i[0],e))return a.show(i[0]),!0}))}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.onDraw()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.show=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCounting+=1,n=t.payload,i=n.x,a=n.y,r=ru.CARD_VIEW,s=r.WIDTH,o=r.HEIGHT,this.guideManager.showHandAnimation(i+s/2-10,a+o/2-10),e.next=6,this.guideManager.showGuide({x:i,y:a+30,circleScaleX:1.5,circleScaleY:2.2,showHighlight:!0,textBox:{textX:i,textY:a+90,text:this.scene.lang.Text.guideMysteryCard,textAlignType:au.CENTER},icon:{iconVisible:!1}});case 6:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){h.guideManager.hideGuide()}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pm),Ym=Hm,Km=Wi.Z.GAMEPLAY_DEFAULT,zm=Km.KEY,Vm=Km.FRAME,jm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).leftArrow=void 0,a.rightArrow=void 0,a.createArrows(),a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(Qh.CHAIN),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:if(a=i.behavior,r=a.connectedCard){e.next=9;break}return e.abrupt("return");case 9:return s=i,o=r,i.payload.x>r.payload.x&&(s=r,o=i),h=s.payload,u=h.x,l=h.y,d=o.payload,p=d.x,f=d.y,this.leftArrow.revive(),this.leftArrow.setAlpha(1),this.leftArrow.setPosition(u-47,l),this.rightArrow.revive(),this.rightArrow.setPosition(p+47,f),(m=this.scene.tweens.createTimeline()).add({targets:this.rightArrow,x:"-=12",duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.add({targets:this.leftArrow,x:"+=12",offset:0,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.play(),g=this.scene.world.getWorldSize(),v=g.width,y=g.height,e.next=26,this.guideManager.showGuide({x:v/2,y:y/2-20,circleScaleX:3.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:v/2,textY:y/2+50,text:this.scene.lang.Text.guideChainCard},icon:{iconVisible:!1}});case 26:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){E.guideManager.hideGuide(),E.leftArrow.kill(),E.rightArrow.kill(),m.stop()}));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createArrows=function(){var e=1/GameCore.ImageScale,t=this.scene.add.image(0,0,zm,Vm.ARROW);t.setScale(e,e),t.kill(),t.setDepth(Fr.Z.GUIDE),this.leftArrow=t;var n=this.scene.add.image(0,0,zm,Vm.ARROW);n.setScale(-e,e),n.kill(),n.setDepth(Fr.Z.GUIDE),this.rightArrow=n},t}(Pm),Xm=jm,qm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.show=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(Qh.SQUIRREL)&&!t.checkOverlap(e)})),r=n.getOnTopCard();if(i&&r){var s=0;i.behavior instanceof sd&&(s=i.behavior.getRequiredUnlockNuts());var o=t.getCardsWithType(Qh.CHESTNUT).filter((function(e){return t.isMatch(e,r)})),c=o[0];if(c&&c.behavior instanceof Ql){a.showGuideCounting+=1;var h=c.behavior.nut.getWorldPosition(),u=h.x,l=h.y;a.guideManager.showGuide({x:u,y:l-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:u+110,textY:l+75,text:"Feed the Squirrel\nwith "+s+" Acorn cards!",textAlignType:au.LEFT},icon:{iconX:u,iconY:l+50,iconDirection:Bg.UP,flipX:!0}}),c.once(Tu.Z.MOVE_TO_WASTE,(function(){a.guideManager.hideGuide()}))}}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.show,this)},t}(Pm),Jm=qm,Qm=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.show=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(Qh.TREASURE)&&!t.checkOverlap(e)})),r=n.getOnTopCard();if(i&&r){i.behavior instanceof zl&&i.behavior.getMissingMapPieces();var s=t.getCardsWithType(Qh.MAP_PIECE).filter((function(e){return t.isMatch(e,r)})),o=s[0];if(o&&o.behavior instanceof ql){a.showGuideCounting+=1;var c=o.behavior.getMapPieceWorldPosition(),h=c.x,u=c.y;a.guideManager.showGuide({x:h+15,y:u-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:h+125,textY:u+65,text:"To assemble the map,\nfind all the missing map pieces!",textAlignType:au.LEFT},icon:{iconX:h,iconY:u+50,iconDirection:Bg.UP,flipX:!0}}),o.once(Tu.Z.MOVE_TO_WASTE,(function(){a.guideManager.hideGuide()}))}}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.show,this)},t}(Pm),$m=Qm,eg=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(Qh.CHANGER),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:return a=i.payload,r=a.x,s=a.y,e.next=8,this.guideManager.showGuide({x:0,y:0,showHighlight:!1,textBox:{text:this.scene.lang.Text.guideChangerCard,textX:r+50,textY:s-100,textAlignType:au.LEFT},icon:{iconX:r+17,iconY:s-75,iconDirection:Bg.DOWN}});case 8:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.guideManager.hideGuide()}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pm),tg=eg,ng=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.levelOneGuide=void 0,n.levelTwoGuide=void 0,n.levelThreeGuide=void 0,n.levelSixGuide=void 0,n.cheeseGuide=void 0,n.squirrelGuide=void 0,n.treasureMapGuide=void 0,n.valueChangerGuide=void 0,n.ropeGuide=void 0,n.mysteriousCardGuide=void 0,n.boosterGuide=void 0,n.playLevelOneGuide=function(){n.levelOneGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelOneGuide)},n.playLevelTwoGuide=function(){n.levelTwoGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelTwoGuide)},n.playLevelThreeGuide=function(){n.levelThreeGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelThreeGuide)},n.playLevelSixGuide=function(){n.levelSixGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelSixGuide)},n.playCheeseGuide=function(){n.cheeseGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopCheeseGuide)},n.playSquirrelGuide=function(){n.squirrelGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopSquirrelGuide)},n.playTreasureMapGuide=function(){n.treasureMapGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopTreasureMapGuide)},n.playValueChangerGuide=function(){n.valueChangerGuide.play(),n.boardGame.stateMachine.once(Jh.DRAW_PILE,n.stopValueChangerGuide)},n.playRopeGuide=function(){n.ropeGuide.play(),n.boardGame.stateMachine.once(Jh.DRAW_PILE,n.stopRopeGuide)},n.playMysteriousCardGuide=function(){n.mysteriousCardGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopMysteriousCardGuide)},n.playBoosterGuide=function(){n.boosterGuide.play(),n.boardGame.stateMachine.once(Jh.START,n.stopBoosterGuide)},n.stopLevelOneGuide=function(){n.guideManager.stop(),n.levelOneGuide.stop()},n.stopLevelTwoGuide=function(){n.guideManager.stop(),n.levelTwoGuide.stop()},n.stopLevelThreeGuide=function(){n.guideManager.stop(),n.levelThreeGuide.stop()},n.stopLevelSixGuide=function(){n.guideManager.stop(),n.levelSixGuide.stop()},n.stopCheeseGuide=function(){n.guideManager.stop(),n.cheeseGuide.stop()},n.stopSquirrelGuide=function(){n.guideManager.stop(),n.squirrelGuide.stop()},n.stopTreasureMapGuide=function(){n.guideManager.stop(),n.treasureMapGuide.stop()},n.stopValueChangerGuide=function(){n.guideManager.stop(),n.valueChangerGuide.stop()},n.stopRopeGuide=function(){n.guideManager.stop(),n.ropeGuide.stop()},n.stopMysteriousCardGuide=function(){n.guideManager.stop(),n.mysteriousCardGuide.stop()},n.stopBoosterGuide=function(){n.guideManager.stop(),n.boosterGuide.stop()},n.scene=t.scene,n}(0,s.Z)(t,e);var n=t.prototype;return n.createGuides=function(){this.levelOneGuide=new Mm(this.scene,this.guideManager,this.boardGame),this.levelTwoGuide=new Wm(this.scene,this.guideManager,this.boardGame),this.levelThreeGuide=new Fm(this.scene,this.guideManager,this.boardGame),this.levelSixGuide=new Gm(this.scene,this.guideManager,this.boardGame),this.cheeseGuide=new Lm(this.scene,this.guideManager,this.boardGame),this.squirrelGuide=new Jm(this.scene,this.guideManager,this.boardGame),this.treasureMapGuide=new $m(this.scene,this.guideManager,this.boardGame),this.valueChangerGuide=new tg(this.scene,this.guideManager,this.boardGame),this.ropeGuide=new Xm(this.scene,this.guideManager,this.boardGame),this.mysteriousCardGuide=new Ym(this.scene,this.guideManager,this.boardGame),this.boosterGuide=new Om(this.scene,this.guideManager,this.boardGame)},n.stop=function(){this.levelOneGuide.stop(),this.levelTwoGuide.stop(),this.levelThreeGuide.stop(),this.levelSixGuide.stop(),this.cheeseGuide.stop(),this.squirrelGuide.stop(),this.treasureMapGuide.stop(),this.valueChangerGuide.stop(),this.ropeGuide.stop(),this.mysteriousCardGuide.stop(),this.boosterGuide.stop()},n.isLevelOneGuidePlaying=function(){return this.levelOneGuide.isPlaying},n.isLevelTwoGuidePlaying=function(){return this.levelTwoGuide.isPlaying},n.updateLevelOneGuide=function(e){this.levelOneGuide.update(e)},n.updateLevelTwoGuide=function(e){this.levelTwoGuide.update(e)},n.isBoosterGuidePlaying=function(){return this.boosterGuide.isPlaying},n.showBoosterGuide=function(e,t,n){return this.boosterGuide.showBoosterGuide(e,t,n)},t}(Tm),ig={SLICE:"guideSliceBooster",STORM:"guideStormBooster",WILD_CARD:"guideWildCardBooster"},ag=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this);var t=this.scene.gameplay.boosterManager,n=this.scene.level.getLevel(),i=this.scene.gameSettings.requiredLevels,a=i.boosterSlice,r=i.boosterStorm,s=i.boosterWildCard,o=this.guideManager,c=o.guideContainer,h=o.tutorialHand,u=o.highLightCircle,l=o.zone;this.showGuideCounting=0,u.setDepth(Fr.Z.PRIORITY),h.setDepth(Fr.Z.PRIORITY),c.setDepth(Fr.Z.PRIORITY),l.setDepth(Fr.Z.PRIORITY);var d=t.getAmountBoosters();switch(n){case a:return void(d.slice<=0&&t.increaseBoosterAmount(Ki.SLICE,1));case r:return t.stormBooster.setShouldChoosePosForGuide(!0),void(d.storm<=0&&t.increaseBoosterAmount(Ki.STORM,1));case s:return void(d.wildCard<=0&&t.increaseBoosterAmount(Ki.WILD_CARD,1))}},n.stop=function(){if(this.isPlaying){this.guideManager.hideGuide();var t=this.guideManager,n=t.guideContainer,i=t.tutorialHand,a=t.highLightCircle,r=t.zone;a.setDepth(Fr.Z.GUIDE),i.setDepth(Fr.Z.GUIDE),n.setDepth(Fr.Z.GUIDE),r.setDepth(Fr.Z.GUIDE)}e.prototype.stop.call(this)},n.showBoosterGuide=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l,d,p,f=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.showGuideCounting>0)){e.next=2;break}return e.abrupt("return");case 2:return a=t.getWorldPosition(),r=a.x,s=a.y,o=n.getWorldPosition(),h=o.x,u=o.y,this.showGuideCounting+=1,l=this.guideManager.zone,d=this.scene.world.getWorldSize(),d.width,d.height,l.setVisible(!0),e.next=10,(0,dl.Z)(this.scene,300);case 10:this.guideManager.showHandAnimation(r,s),p=this.scene.lang.getText(ig[i]),this.guideManager.showGuide({x:r,y:s,showHighlight:!0,textBox:{text:p,textX:r,textY:s-90,useBackground:!0,fontSize:15,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}}),this.scene.events.once(Tu.Z.BOOSTER_SELECTED,(function(){f.isPlaying&&(t.setDisabled(!0),t.setAlpha(1),f.guideManager.hideGuide().then((function(){return f.showHitPlayGuide(h,u)})))}));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.showHitPlayGuide=function(e,t){this.guideManager.showHandAnimation(e,t),this.guideManager.showGuide({x:e,y:t,showHighlight:!0,circleScaleX:1.6,circleScaleY:1,textBox:{textVisible:!1},icon:{iconVisible:!1}})},t}(Pm),rg=ag;function sg(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return og(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return og(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function og(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var cg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCount=void 0,a.onDraw=function(){var e=a.getCardToShow();e&&a.show(e)},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCount=0;var t=this.getCardToShow();t&&this.show(t)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.getCardToShow=function(){if(!(this.showGuideCount>0)){var e=this.boardGame,t=e.pile,n=e.waste.getOnTopCard();if(n)for(var i,a,r=function(){for(var e=a.value,i=t.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),r=0;r<i.length;r++){var s=t.checkOverlap(i[r]),o=t.isOverLap(i[r],e),c=t.isMatch(i[r],n);if(!s&&o&&c)return{v:i[r]}}},s=sg(t.cards.filter((function(e){return e.isType(Qh.KEY)})));!(a=s()).done;)if(i=r())return i.v}},n.show=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCount+=1,n=t.payload,i=n.x,a=n.y,this.guideManager.showHandAnimation(i,a),e.next=5,this.guideManager.showGuide({x:i,y:a,showHighlight:!0,textBox:{textX:i-10,textY:a+70,text:this.scene.lang.Text.guideLock,textAlignType:au.CENTER},icon:{iconVisible:!1}});case 5:t.once(Tu.Z.MOVE_TO_WASTE,(function(){r.guideManager.hideGuide()}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pm),hg=cg,ug=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDraw=function(){a.guideManager.hideHandAnimation(),a.setHintTime(2e3),a.resetHintArrow()},a.hideBackground=function(){a.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0).then((function(){a.guideManager.guideContainer.setDepth(Fr.Z.GAMEPLAY-1),a.scene.gameUI.coinBarButton.setDepth(Fr.Z.GAMEPLAY),a.scene.gameUI.levelTitle.setDepth(Fr.Z.GAMEPLAY)}))},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.scene.gameplay.setEnableCardInput(!1),this.runHint(),this.setHintTime(50),this.showHowToPlayGuide(),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground);var t=this.boardGame.waste.getOnTopCard();t&&t.moveToTopLayer(),this.scene.gameplay.setEnableCardInput(!0),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var n=this.boardGame.hint,i=n.getPileMatchableCards(),a=n.getCardWithLongestChain(i);a&&a.moveToTopLayer(),null==a||a.once(Tu.Z.MOVE_TO_WASTE,this.hideBackground)},n.stop=function(){this.isPlaying&&this.guideManager.guideContainer.setDepth(Fr.Z.GUIDE+1);e.prototype.stop.call(this)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this)},n.showHowToPlayGuide=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.guideManager,a=i.guideContainer,r=i.zone;a.setDepth(Fr.Z.GUIDE),this.guideManager.showGuide({x:0,y:0,circleScaleX:1,circleScaleY:1,showHighlight:!1,icon:{iconVisible:!1},textBox:{text:this.scene.lang.Text.guideOne,textX:t/2,textY:n/2-200,useBackground:!0,fontSize:15,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70}}),r.setVisible(!1)},n.update=function(t){e.prototype.update.call(this,t)},t}(Pm),lg=ug,dg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDraw=function(){a.canShowWildCardGuideNormal()&&a.showWildCardGuideNormal()},a.onDrawStock=function(){a.getHintCard()?a.guideManager.hideArrowAnimation():a.guideManager.arrow.visible||a.showWildCardGuideNormal()},a.onUndo=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.guideManager.arrow.visible&&a.guideManager.hideArrowAnimation(),a.canShowWildCardGuideNormal()&&a.showWildCardGuideNormal();case 2:case"end":return e.stop()}}),e)}))),a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showWildCardGuide(this.scene.lang.Text.guideWildCard)},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(Jh.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(Jh.UNDO,this.onUndo,this)},n.canShowWildCardGuideNormal=function(){return!this.guideManager.arrow.visible&&(!this.getHintCard()&&!(this.boardGame.pile.cards.length<=0))},n.getHintCard=function(){var e=this.boardGame.hint,t=e.getPileMatchableCards();return e.getCardWithLongestChain(t)},n.showWildCardGuide=function(e){var t=this,n=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),i=n.x,a=n.y;this.scene.gameplayLayer.setDepth(Fr.Z.GUIDE),this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),this.scene.gameplayLayer.bringToTop(this.boardGame.gameplay.coinUsingManager.wildCardWrapper),this.scene.gameplay.boardGame.runFadeBackground(0,.7,250,0);var r=this.getHintCard();r&&this.scene.gameplayLayer.bringToTop(r);var s=this.boardGame.waste.getOnTopCard();s&&this.scene.gameplayLayer.bringToTop(s),this.guideManager.showHandAnimation(i,a),this.guideManager.showGuide({x:i,y:a,showHighlight:!1,textBox:{textX:i-150,textY:a-110,text:e,textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconX:i-17,iconY:a-85,iconDirection:Bg.DOWN,flipX:!0}}),this.boardGame.stateMachine.once(Jh.DRAW_WILD_CARD,(function(){t.guideManager.hideGuide(),t.scene.gameplay.setEnableCardInput(!1),(0,dl.Z)(t.scene,900).then((function(){t.scene.gameplay.setEnableCardInput(!0),t.showValueCardGuide()}))}))},n.showWildCardGuideNormal=function(){var e=this,t=this.boardGame.gameplay.coinUsingManager.wildCardBtn.getWorldPosition(),n=t.x,i=t.y;this.guideManager.showArrowAnimation(n,i-80),this.boardGame.stateMachine.once(Jh.DRAW_WILD_CARD,(function(){e.guideManager.hideArrowAnimation()}))},n.showValueCardGuide=function(){var e=this,t=this.getHintCard();if(t){this.scene.gameplayLayer.bringToTop(this.scene.gameplay.boardGame.blackBackground),t.moveToTopLayer();var n=this.boardGame.waste.getOnTopCard();n&&this.scene.gameplayLayer.bringToTop(n);var i=ru.CARD_VIEW,a=i.WIDTH,r=i.HEIGHT;this.guideManager.showHandAnimation(t.x+a/2-10,t.y+r/2-10),this.guideManager.showGuide({x:t.x,y:t.y,showHighlight:!1,textBox:{textX:t.x-65,textY:t.y+100,text:this.scene.lang.Text.guideWildCard2,textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70,boxWidth:165},icon:{iconX:t.x-65,iconY:t.y+35,iconDirection:Bg.RIGHT}}),this.boardGame.stateMachine.once(Jh.DRAW_PILE,(function(){e.guideManager.hideGuide(),e.scene.gameplay.boardGame.runFadeBackground(.7,0,250,0),e.scene.gameplayLayer.setDepth(Fr.Z.GAMEPLAY)}))}},t}(Pm),pg=dg,fg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).onDrawStock=function(){var e=a.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&a.showUndoGuide())},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showStreakGuide()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this)},n.showStreakGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.boardGame.gameplay.comboManager.streakBar.getWorldPosition(),n=t.x,i=t.y,e.next=3,this.guideManager.showGuide({x:0,y:0,circleScaleX:1.05,circleScaleY:1,showHighlight:!1,textBox:{textX:n-80,textY:i+70,text:this.scene.lang.Text.guideStreak,textAlignType:au.CENTER},icon:{iconX:n-65,iconY:i+15,iconDirection:Bg.RIGHT}});case 3:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){a.guideManager.hideGuide()}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pm),mg=fg,gg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showStockGuideCounting=void 0,a.onDraw=function(){(a.resetHintArrow(),a.guideManager.hideHandAnimation(),a.showStockGuideCounting>0)||a.boardGame.hint.getPileMatchableCards().length<=0&&(a.showStockGuideCounting+=1,a.stopHint(),a.showStockGuide())},a.onUndo=function(){a.resetHintArrow(),a.guideManager.hideArrowAnimation()},a.onDrawStock=function(){a.resetHintArrow();var e=a.boardGame,t=e.waste,n=e.pile,i=t.cards[t.cards.length-2];i&&(n.getFrontCards().filter((function(e){return n.isMatch(i,e)})).length>0&&(a.stopHint(),a.showUndoGuide((function(){a.runHint()}))))},a.showStockGuideCounting=0,a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.runHint(),this.setHintTime(3e3),this.showStockGuideCounting=0},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.UNDO,this.onUndo,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.onDrawStock,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.UNDO,this.onUndo,this)},n.update=function(t){e.prototype.update.call(this,t)},n.showStockGuide=function(){var e=this,t=this.boardGame.stock,n=t.x,i=t.y;this.guideManager.showHandAnimation(n,i),this.guideManager.showGuide({x:n,y:i,textBox:{textX:n+55,textY:i-105,text:this.scene.lang.Text.guideDrawStockPortrait,textAlignType:au.LEFT},icon:{iconX:n+17,iconY:i-75,iconDirection:Bg.DOWN},showHighlight:!0}),this.boardGame.stateMachine.once(Jh.DRAW_STOCK,(function(){e.guideManager.hideGuide(),e.runHint()}))},t}(Pm),vg=gg,yg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.onDraw=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame.waste.getOnTopCard();if(e){var t=a.boardGame.pile;t.cards.filter((function(e){return e.isMysterious})).some((function(n){for(var i=[],r=t.cards.filter((function(e){return e!==n&&e.active&&e.payload.depth>n.payload.depth})),s=0;s<r.length;s++)t.isOverLap(r[s],n)&&i.push(r[s]);if(1==i.length&&!t.checkOverlap(i[0])&&t.isMatch(i[0],e))return a.show(i[0]),!0}))}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.onDraw()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.onDraw,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.onDraw,this)},n.show=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showGuideCounting+=1,n=t.payload,i=n.x,a=n.y,r=ru.CARD_VIEW,s=r.WIDTH,o=r.HEIGHT,this.guideManager.showHandAnimation(i+s/2-10,a+o/2-10),e.next=6,this.guideManager.showGuide({x:i,y:a+30,circleScaleX:1.5,circleScaleY:2.2,showHighlight:!0,textBox:{textX:i,textY:a+90,text:this.scene.lang.Text.guideMysteryCard,textAlignType:au.CENTER},icon:{iconVisible:!1}});case 6:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){h.guideManager.hideGuide()}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Pm),Eg=yg,Cg=Wi.Z.GAMEPLAY_DEFAULT,Ag=Cg.KEY,wg=Cg.FRAME,Sg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).leftArrow=void 0,a.rightArrow=void 0,a.createArrows(),a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(Qh.CHAIN),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:if(a=i.behavior,r=a.connectedCard){e.next=9;break}return e.abrupt("return");case 9:return s=i,o=r,i.payload.x>r.payload.x&&(s=r,o=i),h=s.payload,u=h.x,l=h.y,d=o.payload,p=d.x,f=d.y,this.leftArrow.revive(),this.leftArrow.setAlpha(1),this.leftArrow.setPosition(u-47,l),this.rightArrow.revive(),this.rightArrow.setPosition(p+47,f),(m=this.scene.tweens.createTimeline()).add({targets:this.rightArrow,x:"-=12",duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.add({targets:this.leftArrow,x:"+=12",offset:0,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}),m.play(),g=this.scene.world.getWorldSize(),v=g.width,y=g.height,e.next=26,this.guideManager.showGuide({x:v/2,y:y/2,circleScaleX:3.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:v/2,textY:y/2+80,text:this.scene.lang.Text.guideChainCard,textAlignType:au.CENTER},icon:{iconVisible:!1}});case 26:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){E.guideManager.hideGuide(),E.leftArrow.kill(),E.rightArrow.kill(),m.stop()}));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createArrows=function(){var e=1/GameCore.ImageScale,t=this.scene.add.image(0,0,Ag,wg.ARROW);t.setScale(e,e),t.kill(),t.setDepth(Fr.Z.GUIDE),this.leftArrow=t;var n=this.scene.add.image(0,0,Ag,wg.ARROW);n.setScale(-e,e),n.kill(),n.setDepth(Fr.Z.GUIDE),this.rightArrow=n},t}(Pm),bg=Sg,Tg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.show=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(Qh.SQUIRREL)&&!t.checkOverlap(e)})),r=n.getOnTopCard();if(i&&r){var s=0;i.behavior instanceof sd&&(s=i.behavior.getRequiredUnlockNuts());var o=t.getCardsWithType(Qh.CHESTNUT).filter((function(e){return t.isMatch(e,r)})),c=o[0];if(c&&c.behavior instanceof Ql){a.showGuideCounting+=1;var h=c.behavior.nut.getWorldPosition(),u=h.x,l=h.y;a.guideManager.showGuide({x:u,y:l-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:u+110,textY:l+75,text:"Feed the Squirrel\nwith "+s+" Acorn cards!",textAlignType:au.LEFT},icon:{iconX:u,iconY:l+50,iconDirection:Bg.UP,flipX:!0}}),c.once(Tu.Z.MOVE_TO_WASTE,(function(){a.guideManager.hideGuide()}))}}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.show,this)},t}(Pm),xg=Tg,Pg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).showGuideCounting=void 0,a.show=function(){if(!(a.showGuideCounting>0)){var e=a.boardGame,t=e.pile,n=e.waste,i=t.cards.find((function(e){return e.isType(Qh.TREASURE)&&!t.checkOverlap(e)})),r=n.getOnTopCard();if(i&&r){i.behavior instanceof zl&&i.behavior.getMissingMapPieces();var s=t.getCardsWithType(Qh.MAP_PIECE).filter((function(e){return t.isMatch(e,r)})),o=s[0];if(o&&o.behavior instanceof ql){a.showGuideCounting+=1;var c=o.behavior.getMapPieceWorldPosition(),h=c.x,u=c.y;a.guideManager.showGuide({x:h+15,y:u-20,circleScaleX:1.5,circleScaleY:1.5,showHighlight:!0,textBox:{textX:h+125,textY:u+65,text:"To assemble the map,\nfind all the missing map pieces!",textAlignType:au.LEFT},icon:{iconX:h,iconY:u+50,iconDirection:Bg.UP,flipX:!0}}),o.once(Tu.Z.MOVE_TO_WASTE,(function(){a.guideManager.hideGuide()}))}}}},a}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.showGuideCounting=0,this.show()},n.listenEvents=function(){this.boardGame.stateMachine.on(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.on(Jh.DRAW_WILD_CARD,this.show,this)},n.stopListenEvents=function(){this.boardGame.stateMachine.off(Jh.DRAW_STOCK,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_PILE,this.show,this),this.boardGame.stateMachine.off(Jh.DRAW_WILD_CARD,this.show,this)},t}(Pm),kg=Pg,Ig=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){e.prototype.play.call(this),this.show()},n.show=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.boardGame.pile,n=t.getCardsWithType(Qh.CHANGER),i=n[0]){e.next=5;break}return e.abrupt("return");case 5:return a=i.payload,r=a.x,s=a.y,e.next=8,this.guideManager.showGuide({x:0,y:0,showHighlight:!1,textBox:{text:this.scene.lang.Text.guideChangerCard,textX:r-40,textY:s+100,textAlignType:au.CENTER},icon:{iconX:r-55,iconY:s+45,iconDirection:Bg.RIGHT}});case 8:this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){o.guideManager.hideGuide()}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Pm),Og=Ig,Rg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.levelOneGuide=void 0,n.levelTwoGuide=void 0,n.levelThreeGuide=void 0,n.levelSixGuide=void 0,n.cheeseGuide=void 0,n.squirrelGuide=void 0,n.treasureMapGuide=void 0,n.valueChangerGuide=void 0,n.ropeGuide=void 0,n.mysteriousCardGuide=void 0,n.boosterGuide=void 0,n.playLevelOneGuide=function(){n.levelOneGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelOneGuide)},n.playLevelTwoGuide=function(){n.levelTwoGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelTwoGuide)},n.playLevelThreeGuide=function(){n.levelThreeGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelThreeGuide)},n.playLevelSixGuide=function(){n.levelSixGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopLevelSixGuide)},n.playCheeseGuide=function(){n.cheeseGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopCheeseGuide)},n.playSquirrelGuide=function(){n.squirrelGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopSquirrelGuide)},n.playTreasureMapGuide=function(){n.treasureMapGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopTreasureMapGuide)},n.playValueChangerGuide=function(){n.valueChangerGuide.play(),n.boardGame.stateMachine.once(Jh.DRAW_PILE,n.stopValueChangerGuide)},n.playRopeGuide=function(){n.ropeGuide.play(),n.boardGame.stateMachine.once(Jh.DRAW_PILE,n.stopRopeGuide)},n.playMysteriousCardGuide=function(){n.mysteriousCardGuide.play(),n.guideManager.stopWhenExitOrEndGame(n.stopMysteriousCardGuide)},n.playBoosterGuide=function(){n.boosterGuide.play(),n.boardGame.stateMachine.once(Jh.START,n.stopBoosterGuide)},n.stopLevelOneGuide=function(){n.guideManager.stop(),n.levelOneGuide.stop()},n.stopLevelTwoGuide=function(){n.guideManager.stop(),n.levelTwoGuide.stop()},n.stopLevelThreeGuide=function(){n.guideManager.stop(),n.levelThreeGuide.stop()},n.stopLevelSixGuide=function(){n.guideManager.stop(),n.levelSixGuide.stop()},n.stopCheeseGuide=function(){n.guideManager.stop(),n.cheeseGuide.stop()},n.stopSquirrelGuide=function(){n.guideManager.stop(),n.squirrelGuide.stop()},n.stopTreasureMapGuide=function(){n.guideManager.stop(),n.treasureMapGuide.stop()},n.stopValueChangerGuide=function(){n.guideManager.stop(),n.valueChangerGuide.stop()},n.stopRopeGuide=function(){n.guideManager.stop(),n.ropeGuide.stop()},n.stopMysteriousCardGuide=function(){n.guideManager.stop(),n.mysteriousCardGuide.stop()},n.stopBoosterGuide=function(){n.guideManager.stop(),n.boosterGuide.stop()},n.scene=t.scene,n.guideManager=t,n.boardGame=t.boardGame,n}(0,s.Z)(t,e);var n=t.prototype;return n.createGuides=function(){this.levelOneGuide=new lg(this.scene,this.guideManager,this.boardGame),this.levelTwoGuide=new vg(this.scene,this.guideManager,this.boardGame),this.levelThreeGuide=new mg(this.scene,this.guideManager,this.boardGame),this.levelSixGuide=new pg(this.scene,this.guideManager,this.boardGame),this.cheeseGuide=new hg(this.scene,this.guideManager,this.boardGame),this.squirrelGuide=new xg(this.scene,this.guideManager,this.boardGame),this.treasureMapGuide=new kg(this.scene,this.guideManager,this.boardGame),this.valueChangerGuide=new Og(this.scene,this.guideManager,this.boardGame),this.ropeGuide=new bg(this.scene,this.guideManager,this.boardGame),this.mysteriousCardGuide=new Eg(this.scene,this.guideManager,this.boardGame),this.boosterGuide=new rg(this.scene,this.guideManager,this.boardGame)},n.stop=function(){this.levelOneGuide.stop(),this.levelTwoGuide.stop(),this.levelThreeGuide.stop(),this.levelSixGuide.stop(),this.cheeseGuide.stop(),this.squirrelGuide.stop(),this.treasureMapGuide.stop(),this.valueChangerGuide.stop(),this.ropeGuide.stop(),this.mysteriousCardGuide.stop(),this.boosterGuide.stop()},n.isLevelOneGuidePlaying=function(){return this.levelOneGuide.isPlaying},n.isLevelTwoGuidePlaying=function(){return this.levelTwoGuide.isPlaying},n.updateLevelOneGuide=function(e){this.levelOneGuide.update(e)},n.updateLevelTwoGuide=function(e){this.levelTwoGuide.update(e)},n.isBoosterGuidePlaying=function(){return this.boosterGuide.isPlaying},n.showBoosterGuide=function(e,t,n){return this.boosterGuide.showBoosterGuide(e,t,n)},t}(Tm),Bg=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e}({}),Dg=Wi.Z.GAMEPLAY_DEFAULT,Lg=Dg.KEY,_g=Dg.FRAME,Mg=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.arrow=void 0,i.highLightCircle=void 0,i.tutorialHand=void 0,i.guideContainer=void 0,i.zone=void 0,i.arrowAnimation=void 0,i.guideAnimation=void 0,i.showHighLightTween=void 0,i.guideLayout=void 0,i.stop=function(){var t,n;e.prototype.stop.call((0,fc.Z)(i)),i.arrow.kill(),null==(t=i.arrowAnimation)||t.stop(),i.hideHandAnimation(),i.guideContainer.kill(),null==(n=i.showHighLightTween)||n.remove(),i.highLightCircle.kill(),i.highLightCircle.setAlpha(0)},i.scene=t,i.boardGame=n,i.createArrow(),i.createHighLightCircle(),i.createGuideContainer(),i.createTutorialHand(),i.createGuideZone(),i.guideLayout=GameCore.layoutInitializer.isLandscape?new ng((0,fc.Z)(i)):new Rg((0,fc.Z)(i)),i.guideLayout.createGuides(),i}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.stop(),this.guideLayout.stop()},n.playGuide=function(e,t){switch(e){case 1:this.guideLayout.playLevelOneGuide();break;case t.requiredLevels.undo:this.guideLayout.playLevelTwoGuide();break;case t.requiredLevels.combo:this.guideLayout.playLevelThreeGuide();break;case t.requiredLevels.wildCard:this.guideLayout.playLevelSixGuide();break;case 8:this.guideLayout.playCheeseGuide();break;case 46:this.guideLayout.playSquirrelGuide();break;case 53:this.guideLayout.playValueChangerGuide();break;case 148:this.guideLayout.playRopeGuide();break;case 190:this.guideLayout.playMysteriousCardGuide()}},n.showArrowAnimation=function(e,t){var n,i=this;e&&t&&this.arrow.setPosition(e,t),this.arrow.revive(),null==(n=this.arrowAnimation)||n.stop();var a=this.scene.tweens.createTimeline();this.arrow.scaleX=0,this.arrow.scaleY=0,a.add({targets:this.arrow,alpha:1,duration:200}),a.add({targets:this.arrow,onStart:function(){i.arrow.scaleX=1/GameCore.ImageScale,i.arrow.scaleY=1/GameCore.ImageScale},y:"+=15",scaleX:"+=0.1",scaleY:"-=0.05",duration:400,offset:0,yoyo:!0,repeat:-1}),a.play(),this.arrowAnimation=a},n.showHandAnimation=function(e,t){this.tutorialHand.revive(),this.tutorialHand.setPosition(e,t),this.tutorialHand.runTap()},n.hideArrowAnimation=function(){var e,t=this;null==(e=this.arrowAnimation)||e.stop();var n=this.scene.tweens.createTimeline();n.add({targets:this.arrow,alpha:0,duration:200,onComplete:function(){t.arrow.kill()}}),n.play(),this.arrowAnimation=n},n.hideHandAnimation=function(){this.tutorialHand.stopTap(),this.tutorialHand.kill()},n.update=function(e){this.guideLayout.isLevelOneGuidePlaying()&&this.guideLayout.updateLevelOneGuide(e),this.guideLayout.isLevelTwoGuidePlaying()&&this.guideLayout.updateLevelTwoGuide(e),this.tutorialHand.update(e)},n.hideGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideHandAnimation(),this.hideHighLightCircle(),null==(t=this.guideAnimation)||t.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:0,duration:300,onComplete:function(){n.guideContainer.kill()}}),e.next=6,this.guideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.stopWhenExitOrEndGame=function(e){var t=this.scene.gameplay.boardGame;t.stateMachine.once(Jh.LOSE,e),t.stateMachine.once(Jh.PILE_EMPTY,e),t.stateMachine.once(Jh.EXIT,e)},n.showHighLightCircle=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=1/GameCore.ImageScale,this.highLightCircle.revive(),this.highLightCircle.setPosition(t,n),null==(r=this.showHighLightTween)||r.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,scaleX:{start:(i+1)*s,from:(i+1)*s,to:s*i,duration:400},scaleY:{start:(a+1)*s,from:(a+1)*s,to:s*a,duration:400},alpha:{start:0,from:0,to:.5},duration:300,ease:Phaser.Math.Easing.Sine.Out}),e.next=7,this.showHighLightTween.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.hideHighLightCircle=function(){var e,t=this;this.highLightCircle.visible&&(null==(e=this.showHighLightTween)||e.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){t.highLightCircle.kill()}}))},n.showGuide=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A,w,S,b,T,x,P,k,I,O,R,B,D,L,_,M,N,G,Z,F,U,W,H,Y,K,z,V,j,X,q,J,Q,$,ee,te,ne,ie;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=t||{}).x,r=void 0===a?0:a,s=i.y,o=void 0===s?0:s,h=i.circleScaleX,u=void 0===h?1:h,l=i.circleScaleY,d=void 0===l?1:l,p=i.textBox,f=p.textX,m=void 0===f?0:f,g=p.textY,v=void 0===g?0:g,y=p.text,E=void 0===y?"":y,C=p.textVisible,A=void 0===C||C,w=p.textAlignType,S=void 0===w?au.CENTER:w,b=p.useBackground,T=void 0!==b&&b,x=p.font,P=void 0===x?Pc.ZP.PRIMARY.KEY:x,k=p.fontSize,I=void 0===k?16:k,O=p.tint,R=p.lineHeight,B=void 0===R?56:R,D=i.icon,L=D.iconX,_=void 0===L?0:L,M=D.iconY,N=void 0===M?0:M,G=D.iconDirection,Z=void 0===G?Bg.DOWN:G,F=D.flipX,U=void 0!==F&&F,W=D.iconVisible,H=void 0===W||W,Y=i.showHighlight,K=void 0===Y||Y,this.guideContainer.revive(),z=this.guideContainer,V=z.bg,j=z.icon,X=z.text,q=z.shadow,J=1/GameCore.ImageScale,this.guideContainer.setText(E,S),q.setVisible(!T&&!K),X.setVisible(A),X.setFont(P),X.setFontSize(this.scene.fontSize(I)),X.setLineHeight(B),V.setVisible(T),V.setSizeByWorld(this.guideContainer.text.width+20,this.guideContainer.text.height+20),this.guideContainer.setPosition(Phaser.Math.Clamp(m,0+V.displayWidth/2+5,this.scene.gameZone.width-V.displayWidth/2-5),v),Q=this.guideContainer.getLocalPoint(_,N),$=Q.x,ee=Q.y,O?X.setTint(O):X.clearTint(),j.setPosition($,ee),j.setVisible(H),te=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_SIDE,ne=U,Z===Bg.UP?te=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_UP:Z===Bg.DOWN?te=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_DOWN:ne=Z!==Bg.LEFT,j.setTexture(Wi.Z.GAMEPLAY_DEFAULT.KEY,te),j.setDefaultWorldSize(),ne&&j.setScale(-1*J,J),ie=[],null==(n=this.guideAnimation)||n.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:1,duration:300}),ie.push(this.guideAnimation.waitForCompletion()),K&&ie.push(this.showHighLightCircle(r,o,u,d)),this.zone.setVisible(!0),e.next=31,Promise.all(ie);case 31:this.zone.setVisible(!1);case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createArrow=function(){var e=this.scene.add.image(0,0,Lg,_g.ARROW_GREEN);e.setDefaultWorldSize(),e.kill(),e.setDepth(Fr.Z.GUIDE),e.setAlpha(0),this.arrow=e},n.createTutorialHand=function(){var e=new bm(this.scene);e.kill(),e.setDepth(Fr.Z.GUIDE),this.tutorialHand=e},n.createHighLightCircle=function(){var e=new Em(this.scene);e.kill(),e.setDepth(Fr.Z.GUIDE),e.setAlpha(0),e.setTint(0),this.highLightCircle=e,yp.Z.registerObject(this.highLightCircle)},n.createGuideContainer=function(){var e=new fm(this.scene);this.scene.add.existing(e),e.kill(),e.setDepth(Fr.Z.GUIDE),e.setAlpha(0),this.guideContainer=e},n.createGuideZone=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.scene.add.zone(0,0,t,n);i.setVisible(!1),i.setInteractive(),i.setDepth(Fr.Z.GUIDE),Phaser.Display.Align.In.Center(i,this.scene.gameZone),this.zone=i},t}(bp),Ng=Mg,Gg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.totalScore=void 0,n.scoreEachMatch=15,n.scoreEachStockRemain=5,n.updateProgress=function(){},n.scene=t,n.init(),n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.totalScore=0,this.initRequireScoreForStars()},n.increaseScoreByMatch=function(e){this.totalScore+=this.scoreEachMatch*e,this.updateProgress()},n.increaseScoreByStock=function(e){if(!(e<1)){var t=this.scoreEachStockRemain*e,n=this.scoreEachStockRemain,i=this.scoreEachStockRemain*((t+n)/2);this.totalScore+=i,this.updateProgress()}},n.increaseScoreByBoom=function(e){this.totalScore+=100*e,this.updateProgress()},n.increaseScoreByLock=function(e){this.totalScore+=50*e,this.updateProgress()},n.setTotalScore=function(e){this.totalScore=e,this.updateProgress()},n.getTotalScore=function(){return this.totalScore},n.getStars=function(){return 0},n.initRequireScoreForStars=function(){var e=this.scene.level.getLevelData();if(e){var t=e.settings;t.star_1,t.star_2,t.star_3}},t}(bp),Zg=Gg,Fg=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.animationPromises=[],n.scene=t,n}(0,s.Z)(t,e);var n=t.prototype;return n.createSpine=function(e,t,n,i,a){var r=this.scene.add.spine(e,t,n,i,a);return r.scale=1,r.animationStateData.defaultMix=.4,r},n.killSpine=function(e){e.animationState.clearTracks(),e.setVisible(!1),e.setActive(!1)},n.reviveSpine=function(e){e.setVisible(!0),e.setActive(!0)},n.stopAnimation=function(e,t,n){void 0===t&&(t="clear"),"clear"!==t?"mix-to-empty"===t&&e.animationState.setEmptyAnimations(n):e.animationState.clearTracks()},n.waitForTrack=function(e,t,n){var i=Array.isArray(n)?n:[n];return new Promise((function(n){var a=function(i){return function(n,i,a){i===t&&(n(),e.animationState.removeListener(a))}(n,i,r)},r=i.reduce((function(e,t){return e[t]=a,e}),{});e.animationState.addListener(r)}))},n.playAnimation=function(e,t,n,i,a){var r;if(void 0===a&&(a=["end","dispose","complete"]),i&&(null==(r=e.animationState.getCurrent(0))||null==(r=r.animation)?void 0:r.name)===t)return Promise.resolve();this.reviveSpine(e);var s=e.animationState.setAnimation(0,t,n);return this.waitForTrack(e,s,a)},n.playAndWaitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r){var s,o,h,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=["end","dispose","complete"]),!a||(null==(s=t.animationState.getCurrent(0))||null==(s=s.animation)?void 0:s.name)!==n){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.reviveSpine(t),o=t.animationState.setAnimation(0,n,i),this.scene.gameplay.setEnableCardInput(!1),h=this.waitForTrack(t,o,r),this.animationPromises.push(h),h.finally((function(){u.animationPromises=u.animationPromises.filter((function(e){return e!==h})),0===u.animationPromises.length&&u.scene.gameplay.setEnableCardInput(!0)})),e.abrupt("return",h);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r){return e.apply(this,arguments)}}(),t}(bp),Ug=Fg,Wg=function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.boardGame=void 0,n.scoreManager=void 0,n.comboManager=void 0,n.boosterManager=void 0,n.guideManager=void 0,n.coinUsingManager=void 0,n.confettiSmallFallDown=void 0,n.spineManager=void 0,n.eventManager=void 0,n.eventAnimator=void 0,n.enableCardInput=void 0,n.timePlayed=void 0,n.startGameCount=0,n.coinAtStartGame=void 0,n.handleShowInterstitialAd=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.scene).ads.canbeShowInterstitialAd()){e.next=16;break}return t.ads.setAdInProcess(!0),t.audio.muteAll(),t.audio.pauseAllSounds(),t.audio.pauseAllMusics(),e.prev=6,e.next=9,t.ads.showInterstitialAdAsync();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:t.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(t.audio.unmuteAll(),t.audio.resumeAllSounds(),n.scene.resumeMusic()),t.ads.preloadInterstitialAdAsync().catch((function(e){}));case 16:case"end":return e.stop()}}),e,null,[[6,11]])}))),n.scene=t,n.timePlayed=0,n.boardGame=new Cp((0,fc.Z)(n)),n.spineManager=new Ug(n.scene),n.boosterManager=new Yp(n.scene,n.boardGame),n.scoreManager=new Zg(n.scene),n.comboManager=new Yf(n.scene),n.coinUsingManager=new Cf(n.scene,n.boardGame),n.guideManager=new Ng(n.scene,n.boardGame),n.eventManager=new hm(n.scene),n.boardGame.listenEventsToShowUndo(),n.boardGame.listenEventsToShowWildCard(),n}(0,s.Z)(t,e);var n=t.prototype;return n.processStartLevel=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.scene.level.getLevel())<=3)){e.next=7;break}return e.next=4,this.scene.gameUI.hideStar();case 4:this.start(),e.next=8;break;case 7:this.openStartLevelScreen(t);case 8:this.scene.events.emit("prevent-show-events");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.startChallengeLevel=function(){},n.replayGame=function(){this.handleShowInterstitialAd(),this.start()},n.handleGameOver=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.turnOffMusic(Fc.Z.GAMEPLAY_BACKGROUND.KEY),this.eventManager.stop(),1==this.scene.level.getLevel()&&this.scene.player.incUserGuideDisplays(),t?Xh.emit(Kh.PASS_LEVELS.EVENTS.PASS_LEVEL,{type:"level",value:1}):this.handleOpenGameOverScreen(t),this.logLevelEnd(t),this.setEnableCardInput(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.handleOpenGameOverScreen=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,s,o,h,u,l,d,p,f,m,g,v,y,E=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boardGame.clear(),this.scene.storage.dispatch(ri({score:this.scene.rewardManager.getTotalRewardCoin(),level:this.scene.level.getLevelByMode(),success:t})),this.scene.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.analytics,a=n(),r=Je(a),s=Cn(a),o=s.score,h=void 0===o?0:o,u=s.level,l=void 0===u?0:u,e.next=7,t(Si(r,{score:h,level:l}));case 7:a=n(),d=Qe(a),p=$e(a),f=Math.floor((p-d)/1e3),i.event(te._.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(r),level:l,level_name:"level_"+l,time_played:f}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 17:return e.prev=17,fi(200),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()),n=0,i=Vh.NORMAL,a=this.scene.level.getLevelData(),s=this.boosterManager.getAmountBoosters(),a&&(o=a.settings.mapProperties,n=o.coinsRewarded,i=o.difficulty),h=this.scene.level.getLevel(),u={level:this.scene.level.getLevel(),levelClearedCoin:n,levelCollectedCoin:this.scene.rewardManager.getTotalRewardCoin(),slice:{selected:!1,amount:s.slice},storm:{selected:!1,amount:s.storm},wildCard:{selected:!1,amount:s.wildCard},onClaim:function(){return E.handleOnClaim()},difficulty:i},l=this.scene.game,d=l.boxingDuel,p=l.weeklyTournament,f=l.offshoreRace,t||this.eventManager.resetEventItemAmount(),f.isHappening()&&f.updateRacersScore(t),d.isHappening()&&(m=d.getPlayerScore(),g=this.eventManager.getBoxingDuelItemAmount(),d.updatePlayerScore(m+g),d.updateOpponentScore()),p.isPlayingTournament()&&(v=p.getScore(),y=this.eventManager.getWeeklyTournamentItemAmount(),p.handleNextLevel(v+y),p.requestDataAfterFinishGame()),t?(this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.LEVEL_COMPLETED),this.scene.screen.open(ce.o4.LEVEL_COMPLETE_SCREEN,u),this.scene.level.processLevelCompleted(h,3),this.scene.rewardManager.rewardStar(1),this.scene.logEconomy.logGetItem(fl.STAR,1,gl.LEVEL_COMPLETE)):this.scene.screen.open(ce.o4.NO_MORE_MOVES_SCREEN,u);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.start=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resetLog(),this.scene.turnOnGameplayMusic(),e.next=4,this.getLevel();case 4:return t=e.sent,e.next=7,this.requireSpineAssets();case 7:this.startGameCount+=1,this.tryToSubscribeBot(),this.timePlayed=0,this.logLevelStart(),this.startGameWith(t),this.coinAtStartGame=this.scene.player.getCoins(),this.scene.gameModeManager.start(),this.showBoxingDuelVersusScreen(),this.scene.setBackgroundWithFadeAnimation({useGameplayBackground:!0}),this.preloadAssetsInNextLevel();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.requireSpineAssets=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:this.scene.lang.Text.loading,loading:!0,animationFadeOut:!0}),e.next=3,this.scene.requireSpineAsync("CARD_SLICE_FX_SPINE");case 3:return e.next=5,this.scene.requireSpineAsync("CARD_SLICE_SPINE");case 5:return e.next=7,this.scene.requireSpineAsync("WINDMILL_SPINE");case 7:if(!(t=this.scene.level.getLevelData())){e.next=15;break}if(!t.balloonData.length){e.next=12;break}return e.next=12,this.scene.requireSpineAsync("CODE_BREAK_SPINE");case 12:return n=t.cards.map((function(e){return e.type===Qh.LOCK?i.scene.requireSpineAsync("CARD_LOCK_SPINE"):e.type===Qh.TREASURE?i.scene.requireSpineAsync("MAP_SPINE"):void 0})),e.next=15,Promise.all(n);case 15:window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadAssetsInNextLevel=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.level.getLevel(),e.next=3,this.scene.level.preloadLevelDataAsync(n+1);case 3:if(i=this.scene.level.getLevelData(n+1)){e.next=6;break}return e.abrupt("return");case 6:if(null==(t=i.balloonData)||!t.length){e.next=9;break}return e.next=9,this.scene.requireSpineAsync("CODE_BREAK_SPINE");case 9:return a=i.cards.map((function(e){return e.type===Qh.LOCK?r.scene.requireSpineAsync("CARD_LOCK_SPINE"):e.type===Qh.TREASURE?r.scene.requireSpineAsync("MAP_SPINE"):void 0})),e.next=12,Promise.all(a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showBoxingDuelVersusScreen=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.boxingDuel.isHappening()){e.next=5;break}return e.next=4,this.scene.requireTextureAsync("BOXING_DUEL");case 4:this.scene.screen.open(ce.o4.BOXING_DUEL.VERSUS_SCREEN);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryToCreateShortcut=function(){this.startGameCount>1&&this.scene.facebook.attemptToAddShortcut()},n.tryToSubscribeBot=function(){this.startGameCount>1&&this.scene.facebook.attemptToSubscribeBot()},n.startGameWith=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.weeklyTournament.popupJoinTournament(),e.next=3,this.scene.level.preloadLevelDataAsync(t);case 3:return n=this.scene.gameUI,this.initManagers(),this.eventManager.start(),n.updateLevelTitle(t),this.handleSettingsToLevel(t),n.showUI(),n.hideLife(),this.setEnableCardInput(!1),e.next=13,this.boardGame.stateMachine.emitAndWait(Jh.RESET);case 13:return e.next=15,this.boardGame.stateMachine.emitAndWait(Jh.START);case 15:this.scene.events.emit(Tu.Z.START_LEVEL);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setEnableCardInput=function(e){this.spineManager.animationPromises.length>0||(this.enableCardInput=e)},n.update=function(e){this.timePlayed+=e,this.boardGame.update(e),this.guideManager.update(e)},n.openPopupStartLevel=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boardGame.stateMachine.emit(Jh.RESET),this.guideManager.init(),this.scene.level.setLevel(t),e.next=5,this.scene.level.preloadLevelDataAsync(t);case 5:this.openStartLevelScreen(t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.openStartLevelScreen=function(e){var t,n=this.scene.gameSettings.requiredLevels,i=n.boosterSlice,a=n.boosterStorm,r=n.boosterWildCard;e!=i&&e!=a&&e!=r||this.guideManager.guideLayout.playBoosterGuide();var s=this.boosterManager.getAmountBoosters(),o=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty;this.scene.setBackgroundWithFadeAnimation(),this.scene.gameUI.hideStar(),this.scene.screen.open(ce.o4.PLAY_SCREEN,{level:e,slice:{selected:!1,amount:s.slice},storm:{selected:!1,amount:s.storm},wildCard:{selected:!1,amount:s.wildCard},difficulty:o})},n.handleSettingsToLevel=function(e){var t=this.scene.gameSettings.requiredLevels;this.scene.gameUI.footer.settingsMenu.revive(),this.comboManager.setEnable(!1),this.comboManager.streakBar.kill(),this.boardGame.setCanShowUndo(!1),this.boardGame.setCanRefillStock(!0),this.coinUsingManager.wildCardBtn.kill(),this.coinUsingManager.undoBtn.kill(),1==e&&this.scene.gameUI.footer.settingsMenu.kill(),e>=t.addCards&&this.boardGame.setCanRefillStock(!1),e>=t.undo&&(e==t.undo&&(this.coinUsingManager.setUndoPrice(0),this.coinUsingManager.setUndoPriceDiff(0)),this.boardGame.setCanShowUndo(!0)),e>=t.combo&&(this.comboManager.setEnable(!0),this.comboManager.streakBar.revive()),e>=t.wildCard&&(e==t.wildCard&&(this.coinUsingManager.setWildCardPrice(0),this.coinUsingManager.setWildCardPriceDiff(0),this.coinUsingManager.onWildCardChanged()),this.coinUsingManager.wildCardBtn.revive())},n.initManagers=function(){this.scoreManager.init(),this.comboManager.init(),this.coinUsingManager.init(),this.guideManager.init(),this.boosterManager.init(),this.scene.rewardManager.init(),this.eventManager.init();var e=this.scene.level.getLevelData();if(e){var t=e.settings.mapProperties;this.comboManager.setStreak(t.streak),this.eventManager.setup(e.cards)}},n.handleOnClaim=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.stopMusic(),this.scene.screen.close(ce.o4.LEVEL_COMPLETE_SCREEN),e.next=4,this.scene.weeklyTournament.waitForRequestDataFinishGameCompleted();case 4:(t=this.eventManager.hasAtLeastOneEventRunning())?this.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{shouldPlusEventScore:t,openLevelNextStep:!0}):4===this.scene.level.getLevel()?this.scene.screen.open(ce.o4.DASHBOARD_SCREEN):this.processStartLevel();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getLevel=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.level.getLevel());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resetLog=function(){this.timePlayed=0,this.boardGame.resetLog(),this.comboManager.resetLog(),this.scene.logGameplay.resetLog()},n.getAndSetChallengeLevel=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.FBInstant.getEntryPointData(),n=(null==t?void 0:t.level)||this.scene.level.getRandomChallengeLevel(),e.next=4,this.scene.level.setChallengeLevel(n);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.logLevelStart=function(){var e=this.scene.level.getLevel(),t=this.scene.player.getCoins(),n=this.boosterManager.getLogBooster();this.scene.analytics.event(te._.LEVEL_START,{level:e,coins:t,boosters:n})},n.logLevelEnd=function(e){var t=this.scene.level.getLevel(),n=this.scene.player.getCoins(),i=this.boosterManager.getLogBooster(),a=Math.round(this.timePlayed/1e3),r=this.boardGame.getMetricsLog(),s=r.wildCardUsedCount,o=r.addCardsCountByCoin,c=r.addCardsCountByAd,h=r.undoCount,u=r.missedPlayableCount,l=r.streakCount,d=r.clickOnUnmatchedCardCount,p=this.boardGame.stock.getCardsLength(),f=this.boardGame.pile.getCardsLength(),m=this.comboManager.getAverageComboCount(),g=this.boardGame.mover.getMoves();this.scene.analytics.event(te._.LEVEL_END,{level:t,coins:n,coin_used:this.coinAtStartGame-n,boosters:i,wild_card_used_count:s,add_cards_count_by_coin:o,add_cards_count_by_ad:c,moves:g,undo_count:h,missed_playable_count:u,streak_count:l,remaining_stock_count:p,remaining_pile_count:f,success:e,time_played:Math.round(a),average_combo_count:m,click_on_unmatched_card_count:d})},t}(Phaser.Events.EventEmitter),Hg=Wg,Yg=Wi.Z.DEFAULT.KEY,Kg=function(e){function t(t,n){var i;return(i=e.call(this,t,Yg,n.backgroundOn)||this).options=void 0,i.icon=void 0,i.getFrameByStatus=function(){var e=i.options,t=e.enable,n=e.frameOn,a=e.frameOff;return t?n:a},i.getBackgroundByStatus=function(){var e=i.options,t=e.enable,n=e.backgroundOn,a=e.backgroundOff;return t?n:a},i.createButton=function(e){var t=i.getBackgroundByStatus();i.button=i.scene.add.image(0,0,e,t),i.add(i.button)},i.options=n,i.createIcon(),i}(0,s.Z)(t,e);var n=t.prototype;return n.processCallback=function(e){var t=this.options.enable;this.updateStatus(!t),e(!t)},n.updateStatus=function(e){this.options.enable=e;var t=this.getFrameByStatus();this.icon.setFrame(t);var n=this.getBackgroundByStatus();this.button.setFrame(n)},n.createIcon=function(){var e=this.getFrameByStatus();this.icon=this.scene.make.image({key:Yg,frame:e}),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.button)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name,n=!this.options.enable;this.scene.analytics.event(te._.BUTTON_CLICK,{button_name:t,screen_name:e,enable:n})},t}(Hc.Z),zg=Kg,Vg=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).statusText=void 0,i.slideAnimation=void 0,i.setSize(64,24.5),i.icon.setWorldSize(29,29),i.createText(),i.bringToTop(i.icon),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateStatus=function(t){e.prototype.updateStatus.call(this,t),this.alignSwitch()},n.setStatus=function(e){var t;this.updateStatus(e),null==(t=this.slideAnimation)||t.remove(),this.updateStatusText(),e?this.icon.setX(21):this.icon.setX(-21)},n.updateSize=function(){this.button.setWorldSize(64,24.5),e.prototype.updateSize.call(this)},n.createText=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(12),origin:{x:.5,y:.5},text:"OFF"});this.add(e),this.statusText=e},n.alignSwitch=function(){this.options.enable?this.runSlideAnimation(20):this.runSlideAnimation(-20)},n.updateStatusText=function(){var e=this.options.enable;this.statusText.setText(e?"ON":"OFF"),e?this.statusText.setX(-13):this.statusText.setX(13)},n.runSlideAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this.slideAnimation)||n.remove(),150,this.slideAnimation=this.scene.tweens.add({targets:this.icon,x:t,duration:150,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(e){e.elapsed>=75&&i.updateStatusText()}}),this.scene.time.delayedCall(75,this.updateStatusText.bind(this)),e.next=6,this.slideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(zg),jg=Vg,Xg=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0)||this).label=void 0,a.button=void 0,a.setSize(n,i),a.create(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=Wi.Z.DEFAULT.FRAME,t=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(20),text:"Label",origin:{x:0,y:.5}});t.setTint(7031916);var n=new jg(this.scene,{enable:!0,frameOn:e.SWITCH_ON,frameOff:e.SWITCH_OFF,backgroundOn:e.TOGGLE_ON_BAR,backgroundOff:e.TOGGLE_OFF_BAR});this.add([t,n]),Phaser.Display.Align.In.LeftCenter(t,this),Phaser.Display.Align.In.RightCenter(n,this),this.button=n,this.label=t},n.updateStatus=function(e){this.button.updateStatus(e)},n.setDisabled=function(e){this.button.setDisabled(e)},t}(Phaser.GameObjects.Container),qg=Xg,Jg=n(97),Qg=Wi.Z.DEFAULT,$g=Qg.KEY,ev=Qg.FRAME,tv=function(e){function t(t,n,i,a,s,o){var h;return(h=e.call(this,t,$g,ev.BLANK,a,s,o)||this).animation=void 0,h.frame=void 0,h.bg=void 0,h.resumeAnimationTimer=void 0,h.pauseAnimation=function(){var e;null==(e=h.resumeAnimationTimer)||e.remove(),h.animation.pause()},h.resumeAnimation=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.animation.isPaused()&&(h.resumeAnimationTimer=h.scene.time.addEvent({delay:200,callback:function(){h.animation.resume(),h.animation.restart()}}));case 1:case"end":return e.stop()}}),e)}))),h.button.kill(),h.frame=i,h.createBg(n,i,a,s),h}(0,s.Z)(t,e);var n=t.prototype;return n.createBg=function(e,t,n,i){var a=12,r=12,s=12,o=13;switch(this.frame){case ev.BUTTON.GREEN_40:a=12,r=12,s=12,o=13;break;case ev.BUTTON.GREEN_50:a=14,r=14,s=15,o=15;break;case ev.BUTTON.GREEN_60:a=18,r=18,s=18,o=19;break;case ev.BUTTON.BLUE_40:a=11,r=11,s=12,o=13;break;case ev.BUTTON.BLUE_50:a=15,r=15,s=14,o=15;break;case ev.MISSION.CLAIM_BUTTON:a=9.5,r=15,s=9.5,o=10}var c=this.scene.make.nineslice({key:e,frame:t,width:n,height:i,leftWidth:a,rightWidth:r,topHeight:s,bottomHeight:o});this.add(c),this.bg=c},n.getDefaultAnimationConfig=function(){return{targets:[this],duration:400,props:{scale:{from:1,to:.975}},yoyo:!0,repeat:-1,repeatDelay:50,ease:Jg.Z,easeParams:[0,.9]}},n.runAnimation=function(){var e;null==(e=this.animation)||e.remove();var t=this.getDefaultAnimationConfig();this.animation=this.scene.add.tween(t),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation)},n.stopAnimation=function(){var e;null==(e=this.animation)||e.remove(),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.pauseAnimation),this.hitZone.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.resumeAnimation)},t}(Hc.Z),nv=tv,iv=n(93),av=function(){var e=GameCore.Utils.Device,t=window.navigator.vibrate;return e.isAndroid()&&"function"===typeof t||e.isMobileWeb()&&"function"===typeof t},rv=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.ceil(t/80),i=0,a=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.performHapticFeedbackAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();case 3:if(!(i<n)){e.next=11;break}return s=a(),o=(0,le.qZ)(80),i+=1,e.next=9,Promise.all([s,o]);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sv=function(e){window.navigator.vibrate(0),window.navigator.vibrate(e)},ov=function(e){try{if(!av())return!1;var t=GameCore.Utils.Device;t.isAndroid()||t.isMobileWeb()?sv(e):t.isIOS()&&rv(e).catch((function(e){}))}catch(n){}},cv=function(e){function t(t){var n;return(n=e.call(this,t)||this).shadow=void 0,n.stroke=void 0,n.text=void 0,n.shadow=t.make.bitmapText({font:Pc.ZP.SHADOW.KEY}),n.stroke=t.make.bitmapText({font:Pc.ZP.STROKE.KEY}),n.text=t.make.bitmapText({font:Pc.ZP.NORMAL.KEY}),n.setFontSize(20),n.setOrigin(.5,.5),n.add([n.shadow,n.stroke,n.text]),n}(0,s.Z)(t,e);var n=t.prototype;return n.setFontSize=function(e){this.shadow.setFontSize(this.scene.fontSize(e)),this.stroke.setFontSize(this.scene.fontSize(e)),this.text.setFontSize(this.scene.fontSize(e)),this.setSize(this.shadow.width,this.shadow.height)},n.setText=function(e){this.shadow.setText(e),this.stroke.setText(e),this.text.setText(e)},n.setStroke=function(e){this.stroke.setTint(e)},n.setColor=function(e){this.text.setTint(e)},n.setOrigin=function(e,t){this.shadow.setOrigin(e,t),this.stroke.setOrigin(e,t),this.text.setOrigin(e,t)},n.setLetterSpacing=function(e){this.shadow.setLetterSpacing(e),this.stroke.setLetterSpacing(e),this.text.setLetterSpacing(e)},n.setCenterAlign=function(){this.shadow.setCenterAlign(),this.stroke.setCenterAlign(),this.text.setCenterAlign()},n.setLineHeight=function(e){this.shadow.setLineHeight(e),this.stroke.setLineHeight(e),this.text.setLineHeight(e)},t}(Phaser.GameObjects.Container),hv=cv,uv=Wi.Z.DEFAULT,lv=uv.KEY,dv=uv.FRAME,pv=254,fv=52,mv={width:254,height:196},gv={width:254,height:fv+mv.height},vv={width:gv.width+21,height:gv.height+20},yv=function(e){function t(t){var n;return(n=e.call(this,t)||this).soundSwitchUI=void 0,n.musicSwitchUI=void 0,n.vibrationSwitchUI=void 0,n.endGameButton=void 0,n.closeButton=void 0,n.content=void 0,n.initSize(),n.setSize(gv.width,gv.height),n.create(),n.createEndGameButton(),n.createCloseButton(),t.add.existing((0,fc.Z)(n)),n.listenAudioEnabledChange(),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenAudioEnabledChange=function(){var e=this;GameSDK.onAudioEnabledChange((function(t){e.soundSwitchUI.updateStatus(t),e.musicSwitchUI.updateStatus(t),e.soundSwitchUI.setDisabled(!t),e.musicSwitchUI.setDisabled(!t)}))},n.initSize=function(){mv=av()?{width:254,height:196}:{width:254,height:166},gv={width:254,height:fv+mv.height},vv={width:gv.width+21,height:gv.height+20}},n.create=function(){this.createShadow(),this.createHeader(),this.createContent()},n.createShadow=function(){var e=this.scene.make.nineslice({key:lv,frame:dv.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:vv.width,height:vv.height});e.setY(10),this.add(e)},n.createHeader=function(){var e=this.scene.add.container();e.setSize(pv,fv);var t=this.scene.make.nineslice({key:lv,frame:dv.THREE_SLICE.HEADER,leftWidth:23,rightWidth:23,topHeight:22,bottomHeight:0,width:pv,height:fv}),n=new hv(this.scene);n.setText("Settings"),n.setColor(7162732),n.setFontSize(28),n.setY(-2),e.add([t,n]),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,0)},n.createContent=function(){this.content=this.scene.add.container(),this.content.setSize(mv.width,mv.height),this.createBackground(),this.createSwitchButtons(),this.add(this.content),Phaser.Display.Align.In.BottomCenter(this.content,this)},n.createBackground=function(){var e=this.scene.add.container();e.setSize(mv.width,mv.height);var t=this.scene.make.nineslice({key:lv,frame:dv.NINE_SLICE.POPUP_BG,leftWidth:23,rightWidth:23,topHeight:0,bottomHeight:22,width:mv.width,height:mv.height}),n=this.scene.make.nineslice({key:lv,frame:dv.NINE_SLICE.POPUP_CONTENT,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,width:mv.width-20,height:mv.height-72});e.add([t,n]),n.setY(-26),this.content.add(e)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=new qg(this.scene,208,24);o.button.setName("SoundSwitch"),o.label.setText("Sound"),o.button.updateStatus(n),this.soundSwitchUI=o;var c=new qg(this.scene,208,24);if(c.button.setName("MusicSwitch"),c.label.setText("Music"),c.button.updateStatus(a),this.musicSwitchUI=c,av()){var h=new qg(this.scene,208,24);h.label.setText("Vibration"),h.button.updateStatus(s),this.vibrationSwitchUI=h,this.content.add([o,c,h]),Phaser.Display.Align.In.TopCenter(o,this.content,0,-25),Phaser.Display.Align.In.TopCenter(c,this.content,0,-60),Phaser.Display.Align.In.TopCenter(h,this.content,0,-95)}else this.content.add([o,c]),Phaser.Display.Align.In.TopCenter(o,this.content,0,-24),Phaser.Display.Align.In.TopCenter(c,this.content,0,-62)},n.createCloseButton=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new iv.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:15,height:14.5,paddingZone:30});i.setName("Close"),this.add(i),Phaser.Display.Align.In.TopRight(i,this,-15,-15),this.closeButton=i},n.createEndGameButton=function(){var e=new nv(this.scene,lv,dv.BUTTON.RED_40,97.5,42.5);e.setName("EndGame");var t=this.scene.make.bitmapText({font:Pc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(15),origin:{x:.5,y:.5},text:"Exit Game"});e.add(t),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-8),this.endGameButton=e},t}(Phaser.GameObjects.Container),Ev=yv,Cv={tweenConfigs:{screen:{configOpen:{props:{alpha:{from:0,to:1},ease:Phaser.Math.Easing.Sine.In},duration:150,offset:0},configClose:{props:{alpha:{value:0}},duration:150,offset:0}},popup:{configOpen:{props:{scale:{from:.5,to:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}},duration:500,offset:0},configClose:{props:{scale:{value:.75,ease:Phaser.Math.Easing.Back.In}},duration:150,offset:0}}}},Av=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).settingsContainer=void 0,r.handleCloseScreen=function(){r.scene.screen.close(r.name),r.scene.gameUI.showUI()},r.handleSoundChange=function(e){r.scene.player.setSetting("sound",e)},r.handleMusicChanged=function(e){r.scene.player.setSetting("music",e),e?r.scene.resumeMusic():r.scene.audio.pauseAllMusics()},r.handleVibrationChanged=function(e){r.scene.player.setSetting("vibrate",e),e&&r.scene.vibration.performVibrating(50)},r.handleEndGame=function(){r.scene.screen.open(ce.o4.EXIT_GAME_SCREEN,{exitCallback:function(){r.scene.screen.close(ce.o4.EXIT_GAME_SCREEN),r.scene.gameplay.boardGame.stateMachine.emit(Jh.EXIT)},playOnCallback:function(){r.scene.screen.close(ce.o4.EXIT_GAME_SCREEN)}}),r.scene.screen.close(r.name)},r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.scene.screen.close(r.name),r.scene.gameUI.showUI()}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.setDepth(ce.Ks.POPUP),r.create(),r.background.setInteractive({useHandCursor:!0}),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.settingsContainer=new Ev(this.scene),this.settingsContainer.setInteractive(),this.add(this.settingsContainer);var e=this.settingsContainer,t=e.soundSwitchUI,n=e.musicSwitchUI,i=e.vibrationSwitchUI,a=e.endGameButton,r=e.closeButton;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),r.onClick=this.handleCloseScreen,a.onClick=this.handleEndGame},n.open=function(){e.prototype.open.call(this),this.updateData(),this.scene.gameUI.hideUI(),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation(),this.background.off(Phaser.Input.Events.POINTER_DOWN),this.scene.gameplay.boardGame.stateMachine.emit(Jh.CLOSE_SETTINGS)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.settingsContainer,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.setStatus(n),h.button.setStatus(a),u&&u.button.setStatus(s)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.settingsContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.settingsContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),wv=Av,Sv=n(64),bv="How about diving into the game for a relaxing experience?",Tv=GameCore.Configs.Notification.DailyNotificationMessages,xv=void 0===Tv?{}:Tv,Pv=function(){function e(){}e.sendNewUserNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getInstance(),e.abrupt("return",t.sendNewUserNotificationInstance());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendDailyNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getInstance(),e.abrupt("return",t.sendDailyNotificationInstance());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.sendTestDailyNotification=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getInstance();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance};var t=e.prototype;return t.sendNewUserNotificationInstance=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.facebook,a=t.rollbar,e.prev=1,n.getPlayerIsNew()){e.next=5;break}return e.abrupt("return");case 5:if(n.getPlayerASID()){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,FBInstant.player.getDataAsync(["isNotificationFirstSent"]);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0={};case 13:if(r=e.t0,!0!==r.isNotificationFirstSent){e.next=17;break}return e.abrupt("return");case 17:return s={message:bv,delayTime:14400,type:Sv.Z.NEW_USER_NOTIFICATION},e.next=20,i.sendNotificationAsync(s);case 20:FBInstant.player.setDataAsync({isNotificationFirstSent:!0}),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(1),a.sendException(e.t1);case 26:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(){return e.apply(this,arguments)}}(),t.sendDailyNotificationInstance=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.game.rollbar,e.prev=1,n=new Date,i=n.getDay(),e.t0=i,e.next=0===e.t0?7:1===e.t0?10:2===e.t0?13:3===e.t0?16:4===e.t0?19:22;break;case 7:return e.next=9,this.sendMondayNotification();case 9:return e.abrupt("break",22);case 10:return e.next=12,this.sendTuesdayNotification();case 12:return e.abrupt("break",22);case 13:return e.next=15,this.sendWednesdayNotification();case 15:return e.abrupt("break",22);case 16:return e.next=18,this.sendThursdayNotification();case 18:return e.abrupt("break",22);case 19:return e.next=21,this.sendFridayNotification();case 21:return e.abrupt("break",22);case 22:return e.next=24,this.sendSaturdayNotification();case 24:return e.next=26,this.sendSundayNotification();case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),t.sendException(e.t1);case 31:case"end":return e.stop()}}),e,this,[[1,28]])})));return function(){return e.apply(this,arguments)}}(),t.sendMondayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r={message:null!=(a=xv.MONDAY)?a:bv,delayTime:86400,type:Sv.Z.MONDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendTuesdayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r={message:null!=(a=xv.TUESDAY)?a:bv,delayTime:86400,type:Sv.Z.TUESDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendWednesdayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r={message:null!=(a=xv.WEDNESDAY)?a:bv,delayTime:86400,type:Sv.Z.WEDNESDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendThursdayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r={message:null!=(a=xv.THURSDAY)?a:bv,delayTime:86400,type:Sv.Z.THURSDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendFridayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r={message:null!=(a=xv.FRIDAY)?a:bv,delayTime:86400,type:Sv.Z.FRIDAY_NOTIFICATION},e.next=5,n.sendNotificationAsync(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i.sendException(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),t.sendSaturdayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r=this.findDelayTimeForNextDay(6,10),s={message:null!=(a=xv.SATURDAY)?a:bv,delayTime:r,type:Sv.Z.SATURDAY_NOTIFICATION},e.next=6,n.sendNotificationAsync(s);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.sendException(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),t.sendSundayNotification=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.facebook,i=t.rollbar,e.prev=1,r=this.findDelayTimeForNextDay(0,10),s={message:null!=(a=xv.SUNDAY)?a:bv,delayTime:r,type:Sv.Z.SUNDAY_NOTIFICATION},e.next=6,n.sendNotificationAsync(s);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.sendException(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),t.findDelayTimeForNextDay=function(e,t){if(e<0||e>6)throw new Error("Invalid day for notification");if(t<0||t>23)throw new Error("Invalid hour for notification");var n=Date.now(),i=new Date(n).getDay(),a=new Date(n).getHours(),r=e,s=t;if(i===r&&a>=s){var o=3600*(168-a+s);if(o>604800)throw new Error("Notification delay time is more than 7 days");return o}var c=r<i?7-i+r:r-i;s<a&&c--;var h=3600*(24*c+(s<a?24-a+s:s-a));if(h>604800)throw new Error("Notification delay time is more than 7 days");return h},t.sendTestDailyNotificationInstance=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={0:"SUNDAY",1:"MONDAY",2:"TUESDAY",3:"WEDNESDAY",4:"THURSDAY",5:"FRIDAY",6:"SATURDAY"},e.prev=1,a=bv,!(t<0||t>6)){e.next=5;break}throw new Error("Invalid day for notification. Day must be between 0 (Sunday) and 6 (Saturday)");case 5:return a=null!=(i=xv[n[t]])?i:bv,r={message:a,delayTime:300,type:Sv.Z.GENERIC_NOTIFICATION},e.next=9,window.game.facebook.sendNotificationAsync(r);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),e}();Pv._instance=void 0;var kv=Pv,Iv=n(83),Ov=n(98),Rv=n(34),Bv=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.message=void 0,n.createBackground(),n.createMessage(),n.createOKButton(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setMessage=function(e){this.message.setText(e)},n.createBackground=function(){var e=new Rv.Z(this.scene,0,0,340,160,20,16579837);e.setAlpha(.95),this.add(e),this.bg=e,this.setSize(e.width,e.height)},n.createMessage=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Hello, world!",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setTint(1907997),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-24),this.message=e,this.add([e])},n.createOKButton=function(){var e=this,t=new Ov.Z(this.scene,300,40,12,3774208);t.setName("OK"),t.onClick=function(){e.scene.screen.close(ce.o4.NOTIFICATION_SCREEN)};var n=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(16),text:"OK",origin:{x:.5,y:.5}});n.setTint(16579837),Phaser.Display.Align.In.Center(n,t,0),t.add([n]),Phaser.Display.Align.In.BottomCenter(t,this.bg,0,-16),this.add([t])},t}(Phaser.GameObjects.Container),Dv=Bv,Lv=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.notificationContainer=void 0,r.setDepth(ce.Ks.POPUP),r.notificationContainer=new Dv(t),r.add(r.notificationContainer),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t);var n=this.data.list.message,i=void 0===n?"":n;this.notificationContainer.setMessage(i),this.notificationContainer.setAlpha(1),this.background.setAlpha(.8),this.notificationContainer.setInteractive(),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e;null!=(e=this.fadeInAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.fadeInAnimation||(this.fadeInAnimation=new Bh.Z({targets:[this],duration:300})),this.fadeInAnimation.play())},n.runCloseAnimation=function(){var t,n=this;null!=(t=this.fadeOutAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new Iv.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(n)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),_v=Lv,Mv=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,t,a,r)||this).levelText=void 0,s.ribbon=void 0,s.create(n,i),s}(0,s.Z)(t,e);var n=t.prototype;return n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.setFrame=function(e){this.ribbon.setFrame(e)},n.setColor=function(e){var t=Phaser.Display.Color.IntegerToColor(e),n="rgba("+t.red+", "+t.green+", "+t.blue+", 1)";this.levelText.setColor(n)},n.create=function(e,t){this.ribbon=this.scene.add.image(0,0,e,t),this.ribbon.setDefaultWorldSize(),this.setSize(this.ribbon.width,this.ribbon.height);var n=new jp(this.scene,{text:"Level 99",fontSize:this.scene.fontSize(14),fillColor:9461418});this.add([this.ribbon,n]),n.setPosition(0,1),this.levelText=n},t}(Phaser.GameObjects.Container),Nv=Mv,Gv=Wi.Z.DEFAULT,Zv=Gv.KEY,Fv=Gv.FRAME,Uv=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).countText=void 0,a.icon=void 0,a.create(),a}(0,s.Z)(t,e);var n=t.prototype;return n.showCount=function(){this.countText.revive(),this.icon.setFrame(Fv.PLAY_SCREEN.ICON_ORANGE)},n.updateCount=function(e){var t=e<100?""+e:"99+";this.countText.setText(t)},n.showIconPlus=function(){this.icon.revive(),this.icon.setFrame(Fv.PLAY_SCREEN.ICON_ADD),this.countText.kill()},n.showIconCheckMark=function(){this.icon.setFrame(Fv.PLAY_SCREEN.ICON_CHECK_MARK),this.countText.kill()},n.create=function(){var e=this.scene.add.image(0,0,Zv,Fv.PLAY_SCREEN.ICON_ORANGE);e.setDefaultWorldSize(),this.setSize(e.displayWidth,e.displayHeight);var t=new jp(this.scene,{text:"99",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,origin:{x:.5,y:.5}});t.setPadding(2,0,2,0),this.add([e,t]),this.countText=t,this.icon=e,t.setPosition(1/3,-1/3)},t}(Phaser.GameObjects.Container),Wv=Uv,Hv=Wi.Z.DEFAULT,Yv=Hv.KEY,Kv=Hv.FRAME,zv=function(e){function t(t){var n;return(n=e.call(this,t)||this).boosterFrame=void 0,n.boosterIcon=void 0,n.boosterIconGlow=void 0,n.create(),n}return(0,s.Z)(t,e),t.prototype.create=function(){var e=this.scene.add.image(0,1,Yv,Kv.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN);e.setDefaultWorldSize(),this.add(e),this.boosterFrame=e;var t=this.scene.add.image(0,-3,Yv,Kv.PLAY_SCREEN.BOOSTER.GOLD_WILD);t.setDefaultWorldSize(),this.add(t),this.boosterIcon=t;var n=this.scene.add.image(0,-3,Yv,Kv.PLAY_SCREEN.EFFECTS.GLOW);n.setDefaultWorldSize(),n.setScale(.5,.8),n.setAlpha(0),n.setBlendMode(Phaser.BlendModes.ADD),this.add(n),this.boosterIconGlow=n},t}(Phaser.GameObjects.Container),Vv=zv,jv=12881247,Xv=12865613,qv=9790129,Jv=Wi.Z.DEFAULT,Qv=Jv.KEY,$v=Jv.FRAME,ey=function(e){function t(t,n,i){var a;return(a=e.call(this,t,79,227/3)||this).scene=void 0,a.selected=void 0,a.amount=void 0,a.isLock=void 0,a.frame=void 0,a.boosterBlock=void 0,a.countBlock=void 0,a.requiredLevelRibbon=void 0,a.background=void 0,a.tapAnim=void 0,a.downTweens=void 0,a.upTweens=void 0,a.scene=t,a.selected=!1,a.amount=0,a.isLock=!1,a.frame=$v.PLAY_SCREEN.NORMAL,a.createBackground(),a.createBoosterBlock(n,i),a.createRequiredLevelRibbon(),a.createUnlockContainer(),a}(0,s.Z)(t,e);var n=t.prototype;return n.setRequiredLevel=function(e){this.requiredLevelRibbon.setLevel(e)},n.lock=function(){this.isLock=!0,this.boosterBlock.boosterFrame.setFrame(this.frame.BOOSTER.ICON_PLATE_LOCK),this.boosterBlock.boosterIcon.kill(),this.requiredLevelRibbon.revive(),this.countBlock.kill(),this.setDisabled(!0)},n.unlock=function(){this.isLock=!1,this.selected,this.boosterBlock.boosterFrame.setFrame($v.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.boosterBlock.boosterIcon.revive(),this.requiredLevelRibbon.kill(),this.countBlock.revive(),this.setDisabled(!1)},n.setSelected=function(e){this.selected=e,e?(this.countBlock.showIconCheckMark(),this.boosterBlock.boosterFrame.setFrame($v.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN)):(this.boosterBlock.boosterFrame.setFrame($v.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.setAvailableAmount(this.amount))},n.setDifficulty=function(e){var t=jv;switch(e){case Vh.NORMAL:this.frame=$v.PLAY_SCREEN.NORMAL;break;case Vh.HARD:this.frame=$v.PLAY_SCREEN.HARD,t=Xv;break;case Vh.SUPER_HARD:this.frame=$v.PLAY_SCREEN.SUPER_HARD,t=qv}this.boosterBlock.boosterFrame.setFrame(this.isLock?this.frame.BOOSTER.ICON_PLATE_LOCK:$v.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN),this.background.setFrame(this.frame.BOOSTER.ICON_PLATE_OUT),this.requiredLevelRibbon.setFrame(this.frame.BOOSTER.LEVEL_PANEL),this.requiredLevelRibbon.setColor(t)},n.setAvailableAmount=function(e){this.amount=e,0===e?(this.countBlock.updateCount(0),this.countBlock.showIconPlus()):(this.countBlock.updateCount(e),this.countBlock.showCount())},n.updateData=function(e){e&&(this.isLock||(this.setAvailableAmount(e.amount),this.setSelected(e.selected)))},n.createBackground=function(){var e=this.scene.add.image(0,0,Qv,this.frame.BOOSTER.ICON_PLATE_OUT);e.setDefaultWorldSize(),this.add(e),this.background=e},n.createBoosterBlock=function(e,t){var n=new Vv(this.scene);n.boosterIcon.setTexture(e,t),n.boosterIcon.setDefaultWorldSize(),this.add(n),this.boosterBlock=n},n.createRequiredLevelRibbon=function(){var e=new Nv(this.scene,Qv,this.frame.BOOSTER.LEVEL_PANEL);e.setPosition(0,26.75),this.add(e),this.requiredLevelRibbon=e},n.createUnlockContainer=function(){var e=new Wv(this.scene);e.setPosition(29.5,76/3),this.add(e),this.countBlock=e},n.onPointerDown=function(){var e;null==(e=this.upTweens)||e.forEach((function(e){return e.remove()}));var t=1/GameCore.ImageScale;this.downTweens=[this.scene.add.tween({targets:[this.boosterBlock,this.countBlock],scale:.925,duration:100,ease:Phaser.Math.Easing.Back.Out,easeParams:[0]}),this.scene.add.tween({targets:[this.boosterBlock.boosterIcon],scale:t,duration:100,ease:Phaser.Math.Easing.Sine.Out})]},n.onPointerUp=function(){this.animationPointerUp()},n.onCancel=function(){this.animationPointerUp()},n.animationPointerUp=function(){var e;null==(e=this.downTweens)||e.forEach((function(e){return e.remove()}));var t=1/GameCore.ImageScale;this.upTweens=[this.scene.add.tween({targets:[this.boosterBlock,this.countBlock],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]}),this.scene.add.tween({targets:[this.boosterBlock.boosterIcon],scale:t,duration:300,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})],this.isLock||(this.boosterBlock.boosterIconGlow.alpha=0,this.upTweens.push(this.scene.add.tween({targets:[this.boosterBlock.boosterIconGlow],alpha:.2,duration:150,yoyo:!0})))},t}(Kp.Z),ty=ey,ny=function(e){function t(t,n){var i;(i=e.call(this,t)||this).buttonWidth=void 0,i.buttonHeight=void 0,i.buttonInnerWidth=void 0,i.button=void 0,i.background=void 0;var a=n.key,r=n.buttonFrame,s=n.buttonWidth,o=n.buttonHeight,c=n.buttonInnerWidth;return i.buttonWidth=s,i.buttonHeight=o,i.buttonInnerWidth=c||0,i.setSize(i.buttonWidth,i.buttonHeight),i.createButton(a,r),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignBackground=function(e,t){this.background.setPosition(e,t)},n.createButton=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:0==this.buttonInnerWidth?this.width-19/3:this.buttonInnerWidth,height:this.height-23/3});this.button=new Kp.Z(this.scene,n.displayWidth,n.displayHeight,.95),this.add(this.button),this.button.add(n)},n.setDisabled=function(e){this.button.setDisabled(e)},n.addIntoButton=function(e){this.button.add(e)},(0,H.Z)(t,[{key:"onClick",set:function(e){this.button.onClick=e}}]),t}(Phaser.GameObjects.Container),iy=ny,ay=Wi.Z.DASHBOARD,ry=ay.KEY,sy=ay.FRAME,oy=function(e){function t(t){var n;return(n=e.call(this,t,{key:ry,buttonFrame:sy.BUTTON.BUTTON.NEW_GREEN,buttonWidth:436/3,buttonHeight:42,buttonInnerWidth:436/3})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.setSize(n.width,n.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new jp(this.scene,{text:this.scene.lang.Text.play,fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.buttonText=e,this.addIntoButton(this.buttonText),this.buttonText.setPosition(0,-2)},t}(iy),cy=oy,hy=function(e){function t(t,n){var i;i=e.call(this,t)||this;var a=n.key,r=n.frame,s=n.width,o=n.height,c=n.topHeight,h=n.bottomHeight;i.setSize(s,o);var u=i.scene.make.nineslice({key:a,frame:r,height:o,topHeight:c,bottomHeight:h,width:s/2});u.setOrigin(1,.5);var l=i.scene.make.nineslice({key:a,frame:r,height:o,topHeight:c,bottomHeight:h,width:s/2});return l.setOrigin(1,.5),l.scaleX=-l.scaleX,i.add(u),i.add(l),i.scene.add.existing((0,fc.Z)(i)),i}return(0,s.Z)(t,e),t.prototype.setFrame=function(e){this.list.forEach((function(t){t instanceof Phaser.GameObjects.NineSlice&&t.setFrame(e)}))},t}(Phaser.GameObjects.Container),uy=hy,ly=function(e){function t(t,n,i){var a,r=(a=e.call(this,t)||this).scene.add.image(0,0,n,i);r.setOrigin(1,.5),r.setDefaultWorldSize();var s=a.scene.add.image(0,0,n,i);return s.setOrigin(1,.5),s.setDefaultWorldSize(),s.scaleX=-s.scaleX,a.setSize(2*r.displayWidth,2*r.displayHeight),a.add(r),a.add(s),a.scene.add.existing((0,fc.Z)(a)),a}return(0,s.Z)(t,e),t.prototype.setFrame=function(e){this.list.forEach((function(t){t instanceof Phaser.GameObjects.Image&&t.setFrame(e)}))},t}(Phaser.GameObjects.Container),dy=ly,py=Wi.Z.DEFAULT,fy=py.KEY,my=py.FRAME,gy=11167815,vy=13718342,yy=10768064,Ey="Normal Level",Cy="Hard Level",Ay="Super Hard Level",wy={width:326,height:949/3},Sy=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,i,a)||this).scene=void 0,r.levelText=void 0,r.screenKey=void 0,r.frame=void 0,r.sliceButton=void 0,r.stormButton=void 0,r.wildCardButton=void 0,r.closeButton=void 0,r.playButton=void 0,r.bgReward=void 0,r.case=void 0,r.star=void 0,r.star2=void 0,r.star3=void 0,r.xContainer=void 0,r.rewardChestAdd=void 0,r.rewardChestAdd2=void 0,r.topCaseAdd1=void 0,r.topCaseAdd2=void 0,r.topCaseAdd3=void 0,r.topCaseAdd4=void 0,r.boneStar=void 0,r.boneStar2=void 0,r.boneStar3=void 0,r.ribbon=void 0,r.rewardText=void 0,r.background=void 0,r.boosterText=void 0,r.titleDecoration=void 0,r.rewardBackground=void 0,r.scene=t,r.screenKey=n,r.setSize(wy.width,wy.height),r.frame=my.PLAY_SCREEN.NORMAL,r.create(),r.scene.add.existing((0,fc.Z)(r)),r}(0,s.Z)(t,e);var n=t.prototype;return n.updateBoostersWithSettings=function(){var e=this.scene.gameSettings.requiredLevels,t=this.scene.level.getLevel();this.sliceButton.setRequiredLevel(e.boosterSlice),this.stormButton.setRequiredLevel(e.boosterStorm),this.wildCardButton.setRequiredLevel(e.boosterWildCard),t>=e.boosterSlice?this.sliceButton.unlock():this.sliceButton.lock(),t>=e.boosterStorm?this.stormButton.unlock():this.stormButton.lock(),t>=e.boosterWildCard?this.wildCardButton.unlock():this.wildCardButton.lock()},n.setDifficulty=function(e){var t=gy,n=Ey;switch(e){case Vh.NORMAL:this.frame=my.PLAY_SCREEN.NORMAL,t=gy,n=Ey;break;case Vh.HARD:this.frame=my.PLAY_SCREEN.HARD,t=vy,n=Cy;break;case Vh.SUPER_HARD:this.frame=my.PLAY_SCREEN.SUPER_HARD,t=yy,n=Ay}var i=Phaser.Display.Color.IntegerToColor(t),a="rgba("+i.red+", "+i.green+", "+i.blue+", 1)";this.levelText.setColor(a),this.titleDecoration.setFrame(e===Vh.NORMAL?my.COMMON.TITLE_DECOR:this.frame.TITLE_DECOR),this.background.setFrame(this.frame.POPUP_BASE),this.boosterText.setText(n),this.boosterText.setColor(a),this.rewardBackground.setFrame(this.frame.REWARD_CHEST_BG),this.closeButton.button.setFrame(e===Vh.NORMAL?my.COMMON.BTN_CLOSE:this.frame.CLOSE),this.sliceButton.setDifficulty(e),this.stormButton.setDifficulty(e),this.wildCardButton.setDifficulty(e)},n.setButtonsDisable=function(e){this.sliceButton.setDisabled(e),this.stormButton.setDisabled(e),this.wildCardButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setDisabled(e),this.sliceButton.setAlpha(1),this.stormButton.setAlpha(1),this.wildCardButton.setAlpha(1),this.closeButton.setAlpha(1),this.playButton.setAlpha(1)},n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.runEntranceAnimation=function(e){var t=[this.sliceButton,this.stormButton,this.wildCardButton],n=this.scene.tweens.createTimeline({onComplete:e});return t.forEach((function(e,t){e.setScale(0),n.add({targets:[e],scale:{from:.75,to:1},ease:Phaser.Math.Easing.Back.Out,duration:150,delay:0==t?100:0,offset:0==t?0:"-=100"})})),n.playAndWaitForCompletion()},n.setBgRewardBlendModes=function(e){this.rewardChestAdd.setBlendMode(e),this.rewardChestAdd2.setBlendMode(e),this.topCaseAdd1.setBlendMode(e),this.topCaseAdd2.setBlendMode(e),this.topCaseAdd3.setBlendMode(e),this.topCaseAdd4.setBlendMode(e),this.star.setBlendMode(e),this.star2.setBlendMode(e),this.star3.setBlendMode(e)},n.create=function(){this.setSize(wy.width,wy.height),this.createBackground(),this.createBgReward(),this.createCloseButton(),this.createLevelText(),this.createBoostersText(),this.createBoosterButtons(),this.createPlayButton()},n.createBackground=function(){var e=new uy(this.scene,{key:fy,frame:this.frame.POPUP_BASE,topHeight:200/3,bottomHeight:200/3,width:wy.width,height:wy.height});this.add(e),this.background=e},n.createBgReward=function(){this.bgReward=this.scene.add.container(0,-197.5/3),this.add(this.bgReward);var e=new dy(this.scene,fy,this.frame.REWARD_CHEST_BG);e.setY(18.5/3),this.bgReward.add(e),this.rewardBackground=e,this.case=this.scene.add.container(-9.5/3,5/3),this.bgReward.add(this.case);var t=this.scene.add.image(10.625/3,-6.177/3,fy,my.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST);t.setDefaultWorldSize(),this.case.add(t),t.setAlpha(1);var n=this.scene.add.image(46.09/3,-4.087,fy,my.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST_ADD_1);n.setDefaultWorldSize(),n.setAlpha(0),n.setBlendMode(Phaser.BlendModes.ADD),this.case.add(n),this.rewardChestAdd=n;var i=this.scene.add.image(-9.3386/3,-19.057/3,fy,my.PLAY_SCREEN.EFFECTS.NEW_REWARD_CHEST_ADD_2);i.setDefaultWorldSize(),i.setAlpha(0),i.setBlendMode(Phaser.BlendModes.ADD),this.case.add(i),this.rewardChestAdd2=i;var a=this.scene.add.image(-43.292/3,-70.958/3,fy,my.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_1);a.setDefaultWorldSize(),a.setAlpha(0),a.setBlendMode(Phaser.BlendModes.ADD),this.case.add(a),this.topCaseAdd1=a;var r=this.scene.add.image(16.736/3,-78.322/3,fy,my.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_2);r.setDefaultWorldSize(),r.setAlpha(0),r.setBlendMode(Phaser.BlendModes.ADD),this.case.add(r),this.topCaseAdd2=r;var s=this.scene.add.image(23.957/3,-25.727,fy,my.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_3);s.setDefaultWorldSize(),s.setAlpha(0),s.setBlendMode(Phaser.BlendModes.ADD),this.case.add(s),this.topCaseAdd3=s;var o=this.scene.add.image(20.755/3,-83.327/3,fy,my.PLAY_SCREEN.EFFECTS.NEW_TOP_CASE_ADD_4);o.setDefaultWorldSize(),o.setAlpha(0),o.setBlendMode(Phaser.BlendModes.ADD),this.case.add(o),this.topCaseAdd4=o;var c=this.scene.add.container(23,-32.301/3);this.bgReward.add(c),this.boneStar=c,this.star=this.scene.add.image(.8/3,-.3651/3,fy,my.PLAY_SCREEN.EFFECTS.STAR),this.star.setDefaultWorldSize(),this.star.setBlendMode(Phaser.BlendModes.ADD),c.add(this.star);var h=this.scene.add.container(-135.288/3,55.483/3);this.bgReward.add(h),this.boneStar2=h,this.star2=this.scene.add.image(.8/3,-.3651/3,fy,my.PLAY_SCREEN.EFFECTS.STAR),this.star2.setDefaultWorldSize(),this.star2.setBlendMode(Phaser.BlendModes.ADD),h.add(this.star2);var u=this.scene.add.container(59,7);this.bgReward.add(u),this.boneStar3=u,this.star3=this.scene.add.image(.8/3,-.3651/3,fy,my.PLAY_SCREEN.EFFECTS.STAR),this.star3.setDefaultWorldSize(),this.star3.setBlendMode(Phaser.BlendModes.ADD),u.add(this.star3);var l=this.scene.add.container(0,110.5/3);this.bgReward.add(l)},n.createCloseButton=function(){this.xContainer=this.scene.add.container(137,-100),this.add(this.xContainer);var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new iv.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:38/3,height:13,paddingZone:30});i.setName("Close"),this.xContainer.add(i),this.closeButton=i},n.createLevelText=function(){this.levelText=new jp(this.scene,{text:"Level 9999",fontSize:this.scene.fontSize(19),fillColor:gy}),this.add(this.levelText),this.titleDecoration=this.scene.add.image(0,1,fy,my.COMMON.TITLE_DECOR),this.titleDecoration.setDefaultWorldSize(),this.add(this.titleDecoration),this.levelText.setPosition(0,-405.5/3),this.titleDecoration.setPosition(0,-119.5)},n.createBoostersText=function(){var e=new jp(this.scene,{text:this.scene.lang.Text.selectBoosters,fontSize:this.scene.fontSize(15),fillColor:gy});this.add(e),e.setPosition(0,-2),this.boosterText=e},n.createBoosterButtons=function(){var e=new ty(this.scene,fy,my.PLAY_SCREEN.BOOSTER.THREE_SLICE);e.setName("SliceBooster");var t=new ty(this.scene,fy,my.PLAY_SCREEN.BOOSTER.WIND);t.setName("StormBooster");var n=new ty(this.scene,fy,my.PLAY_SCREEN.BOOSTER.GOLD_WILD);n.setName("WildCardBooster"),this.add([e,t,n]),e.setPosition(-261.5/3,160/3),t.setPosition(0,160/3),n.setPosition(261.5/3,160/3),this.sliceButton=e,this.stormButton=t,this.wildCardButton=n},n.createPlayButton=function(){var e=new cy(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e,this.playButton.setPosition(-.5,126)},n.handleBoosterOnClick=function(e,t){var n=t.selected,i=t.amount;if(!t.isLock){if(i<=0)return this.getBuyingBoosterData(e);n?this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.UN_SELECT_BOOSTER):this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.SELECT_BOOSTER),t.setSelected(!n),this.scene.events.emit(Tu.Z.BOOSTER_SELECTED)}},n.getBuyingBoosterData=function(e){var t={title:"",boosterFrame:"",description:"",cost:300,key:Ki.NONE},n={cost:{boosterSlice:Ud.cost.boosterSlice,boosterStorm:Ud.cost.boosterStorm,boosterWildCard:Ud.cost.boosterWildCard}},i=this.scene.level.getLevelData();switch(i&&(n=i.settings.mapProperties),e){case Ki.SLICE:(t=Xi.SLICE).cost=n.cost.boosterSlice;break;case Ki.STORM:(t=Xi.STORM).cost=n.cost.boosterStorm;break;case Ki.WILD_CARD:(t=Xi.WILD_CARD).cost=n.cost.boosterWildCard}return(0,a.Z)({previousScreenKey:this.screenKey},t)},(0,H.Z)(t,[{key:"onBoosterClick",set:function(e){var t=this;this.sliceButton.onClick=function(){var n=t.handleBoosterOnClick(Ki.SLICE,t.sliceButton);e(n)},this.stormButton.onClick=function(){var n=t.handleBoosterOnClick(Ki.STORM,t.stormButton);e(n)},this.wildCardButton.onClick=function(){var n=t.handleBoosterOnClick(Ki.WILD_CARD,t.wildCardButton);e(n)}}}]),t}(Phaser.GameObjects.Container),by=Sy,Ty=Wi.Z.DEFAULT,xy=(Ty.KEY,Ty.FRAME,function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.boostersContainer=void 0,s.handleCancel=function(){s.scene.screen.close(s.name);var e=s.scene.level.getLevel();s.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{level:e})},s.replayGame=function(){var e=s.scene.gameplay,t=s.boostersContainer,n=t.sliceButton,i=t.stormButton,a=t.wildCardButton,r={slice:n.selected,storm:i.selected,wildCard:a.selected};s.setButtonsDisable(!0),e.boosterManager.enableBoosters(r),e.start(),s.scene.screen.close(s.name)},s.onEntranceCompleted=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.scene.handleShowInterstitialAd();case 2:s.runAnimationShowButtons(),s.setButtonsDisable(!1),s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}));case 5:case"end":return e.stop()}}),e)}))),s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s))},s.scene=t,s.create(),s.setButtonsDisable(!0),s.background.setAlpha(ce.MR.ALPHA.COMMON),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.setButtonsDisable(!1),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.scene.gameUI.coinBarButton.setDisabled(!0),this.updateData(t),this.runEntranceAnimation()},n.updateData=function(e){var t,n=this.boostersContainer,i=n.sliceButton,a=n.stormButton,r=n.wildCardButton,s=null==(t=this.data)?void 0:t.list,o=s.level,c=void 0===o?1:o,h=s.difficulty,u=void 0===h?Vh.NORMAL:h,l=e,d=l.slice,p=l.storm,f=l.wildCard;this.boostersContainer.setLevel(c),this.boostersContainer.setDifficulty(u),this.boostersContainer.updateBoostersWithSettings(),i.updateData(d),a.updateData(p),r.updateData(f)},n.create=function(){var e=this,t=new by(this.scene,ce.o4.NO_MORE_MOVES_SCREEN);this.add(t),this.boostersContainer=t;var n=t.closeButton,i=t.playButton;n.onClick=this.handleCancel,i.setText(this.scene.lang.Text.replay),i.setName("Replay"),i.onClick=this.replayGame,t.onBoosterClick=function(t){t&&(e.scene.screen.open(ce.o4.BUYING_BOOSTER_SCREEN,t),e.scene.screen.close(e.name))}},n.setButtonsDisable=function(e){this.boostersContainer.setButtonsDisable(e)},n.close=function(){this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!1),this.runExitAnimation()},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.hideButtons(),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.runEntrancePopup(),this.boostersContainer.runEntranceAnimation(this.onEntranceCompleted);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntrancePopup=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.boostersContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hideButtons=function(){this.boostersContainer.playButton.setAlpha(0)},n.runAnimationShowButtons=function(){var e=this.boostersContainer.playButton;return this.scene.tweens.add({targets:[e],alpha:{from:0,to:1},duration:300}).waitForCompletion()},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.boostersContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen)),Py=xy,ky=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.backgroundChangingAnimation=void 0,n.oldBackgroundMockup=void 0,n.scene=t,n}(0,s.Z)(t,e);var n=t.prototype;return n.skipAnimation=function(){var e,t;null==(e=this.backgroundChangingAnimation)||e.stop(),null==(t=this.oldBackgroundMockup)||t.kill()},n.playAnimation=function(e,t){var n,i=this;void 0===t&&(t=1e3),null!=(n=this.backgroundChangingAnimation)&&n.isPlaying()||(this.updateOldBackgroundMockup(e),this.backgroundChangingAnimation=this.scene.tweens.addCounter({from:255,to:0,duration:t,onUpdate:function(e){var t=e.getValue();i.oldBackgroundMockup.setAlpha(t/255)},onComplete:function(){i.oldBackgroundMockup.kill()}}))},n.updateOldBackgroundMockup=function(e){var t=e.key,n=e.frame,i=e.alpha,a=e.tint,r=e.width,s=e.height,o=e.scale,c=this.scene.background,h=c.x,u=c.y;this.oldBackgroundMockup?this.oldBackgroundMockup.setTexture(t,n):this.oldBackgroundMockup=this.scene.add.image(0,0,t,n),this.oldBackgroundMockup.setAlpha(i),this.oldBackgroundMockup.setTint(a),this.oldBackgroundMockup.setWorldSize(r,s),this.oldBackgroundMockup.setScale(o),this.oldBackgroundMockup.setDepth(this.scene.background.depth+.1),this.oldBackgroundMockup.setPosition(h,u),this.oldBackgroundMockup.revive()},t}(bp),Iy=Wi.Z.DEFAULT,Oy=Iy.KEY,Ry=Iy.FRAME,By=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.boardGame=void 0,i.alignY=-126,i.debugButtons=[],i.isShowDebugButtons=!1,i.scene=t,i.boardGame=n,i.init(),i}(0,s.Z)(t,e);var i=t.prototype;return i.start=function(){e.prototype.start.call(this),this.createNextLevelBtn(),this.createAddCoinsBtn(),this.createWinBtn(),this.createAutoPlayStepBtn(),this.createStormBtn(),this.createSliceBtn(),this.createPlusCardsBtn(),this.createWildCardBtn(),this.createFullScreenBtn(),this.createDevToolsPanel(),this.addKeyboardShortcutForScreenshot(),this.showDebugButtons(this.isShowDebugButtons)},i.showDebugButtons=function(e){this.debugButtons.forEach((function(t){e?t.revive():t.kill()})),this.isShowDebugButtons=e},i.createDevToolsPanel=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(498),n.e(377)]).then(n.bind(n,55));case 2:new(0,e.sent.default)(this.scene);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.draw=function(){var e=this.boardGame.hint,t=this.boardGame.stock,n=this.boardGame.pile,i=(this.scene.gameplay.coinUsingManager,n.getCardsWithType(Qh.KEY)),a=e.getPileMatchableCards();if(i.length>0){var r=i[Phaser.Math.Between(0,i.length-1)];this.boardGame.stateMachine.emit(Jh.DRAW_PILE,r)}else if(a.length>0){var s=e.getCardWithLongestChain(a);s&&this.boardGame.stateMachine.emit(Jh.DRAW_PILE,s)}else n.cards.length>0&&t.cards.length>0?this.boardGame.stateMachine.emit(Jh.DRAW_STOCK):this.boardGame.stateMachine.emit(Jh.REFILL_STOCK)},i.createNextLevelBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Next\nLevel",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("NextLevel"),t.onClick=function(){e.scene.screen.close("DASHBOARD_SCREEN"),e.scene.player.setLevel(e.scene.level.getLevel()+1),e.scene.level.setLevel(e.scene.level.getLevel()+1),e.scene.tweens.killAll(),e.scene.gameplay.start()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createAddCoinsBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Add\nCoins",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("AddCoins"),t.onClick=function(){var t=e.scene.player.getCoins();e.scene.player.setCoins(t+5e4)},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createWinBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Win\nGame",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Win"),t.onClick=function(){e.scene.gameplay.boardGame.win()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createAutoPlayStepBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Auto\nPlay",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("AutoPlay"),t.onClick=function(){e.draw()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createStormBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Storm\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Storm"),t.onClick=function(){e.scene.gameplay.boosterManager.stormBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createSliceBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Slice\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("Slice"),t.onClick=function(){e.scene.gameplay.boosterManager.sliceBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,-0,this.alignY),this.alignY+=25},i.createPlusCardsBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Plus\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("PlusCards"),t.onClick=function(){e.scene.gameplay.boosterManager.plusFiveCardsBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createWildCardBtn=function(){var e=this,t=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(t);var n=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Wild\nCards",origin:{x:.5,y:.5},y:0});n.setCenterAlign(),t.add(n),t.setName("WildCard"),t.onClick=function(){e.scene.gameplay.boosterManager.wildCardBooster.activate()},Phaser.Display.Align.In.LeftCenter(t,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.createFullScreenBtn=function(){var e=new Hc.Z(this.scene,Oy,Ry.BLANK,24,24);this.debugButtons.push(e);var t=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(7),text:"Full\nScreen",origin:{x:.5,y:.5},y:0});t.setCenterAlign(),e.add(t),e.setName("FullScreen"),e.onClick=function(){var e=document.getElementById("app");null==e||e.requestFullscreen()},Phaser.Display.Align.In.LeftCenter(e,this.scene.gameZone,0,this.alignY),this.alignY+=25},i.addKeyboardShortcutForScreenshot=function(){window.addEventListener("keydown",(function(e){"s"==e.key&&requestAnimationFrame((function(){var e=document.getElementsByTagName("canvas")[0].toDataURL("png"),t=document.createElement("a");t.download=document.title.toLocaleLowerCase().replaceAll(" ","_")+"_"+Date.now(),t.href=e,t.dataset.downloadurl=["image/png",t.download,t.href].join(":"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))}))},t}(bp),Dy=By,Ly=function(){function e(e){var t=this;this.scene=void 0,this.fps=void 0,this.avgFps=void 0,this.avgFpsInTime=void 0,this.countTimeToUpdateFps=void 0,this.countTimeToUpdateAvgFPS=void 0,this.countTimeToTrackFPS=void 0,this.reduceCanvasCanvasCount=void 0,this.update=function(e,n){t.countTimeToUpdateFps+=n,t.countTimeToUpdateAvgFPS+=n,t.countTimeToTrackFPS+=n,t.countTimeToUpdateFps<500||(t.countTimeToUpdateFps-=500,t.updateFps(),t.updateAvgFps(),t.updateAvgFpsInTime())},this.tryReduceCanvas=function(){if(!(t.reduceCanvasCanvasCount>=3)){var e=2;e=t.getAvgFpsInTime()>50||t.getAvgFpsInTime()>30?2:1.5;var n=Phaser.Math.Clamp(GameCore.Utils.Device.pixelRatio(),1,e);t.scene.world.resize(n),t.reduceCanvasCanvasCount+=1}},this.scene=e,this.countTimeToUpdateFps=0,this.countTimeToUpdateAvgFPS=this.reduceCanvasCanvasCount=0}var t=e.prototype;return t.getFps=function(){return this.fps},t.getAvgFps=function(){return Math.round(this.avgFps.average)},t.getAvgFpsInTime=function(){return this.avgFpsInTime.average},t.updateFps=function(){this.fps=this.scene.game.loop.actualFps},t.updateAvgFps=function(){this.avgFps.sum+=this.fps,this.avgFps.total+=1,this.avgFps.average=this.avgFps.sum/this.avgFps.total,this.avgFps.min>this.avgFps.average&&(this.avgFps.min=this.avgFps.average),this.avgFps.max<this.avgFps.average&&(this.avgFps.max=this.avgFps.average)},t.updateAvgFpsInTime=function(){this.avgFpsInTime.sum+=this.fps,this.avgFpsInTime.total+=1,this.countTimeToUpdateAvgFPS>4e3&&(this.avgFpsInTime.average=this.avgFpsInTime.sum/(this.avgFpsInTime.total||1),this.avgFpsInTime.sum=0,this.avgFpsInTime.total=0,this.countTimeToUpdateAvgFPS-=4e3,this.avgFpsInTime.min>this.avgFpsInTime.average&&(this.avgFpsInTime.min=this.avgFpsInTime.average),this.avgFpsInTime.max<this.avgFpsInTime.average&&(this.avgFpsInTime.max=this.avgFpsInTime.average))},t.reset=function(){this.fps=0,this.avgFps={sum:0,total:0,average:0,min:120,max:0},this.avgFpsInTime={sum:0,total:0,average:0,min:120,max:0}},t.start=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update),this.reset()},t.stop=function(){this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update)},e}(),_y=Ly,My=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Phaser.Math.Vector2,e.abrupt("return",t.tweens.addCounter((0,a.Z)({},n,{onUpdate:function(e,t,a){n.curve.getPoint(t.value,i),n.target.x=i.x,n.target.y=i.y,n.angularVector&&(n.target.angle+=n.angularVector),n.onUpdate&&n.onUpdate(e,t,a)}})).waitForCompletion());case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ny=My,Gy=function(){function e(e){this.boardGame=void 0,this.cards=[],this.x=void 0,this.y=void 0,this.name=void 0,this.boardGame=e,this.cards=[]}var t=e.prototype;return t.setName=function(e){this.name=e},t.getname=function(){return this.name},t.setPosition=function(e,t){this.x=e,this.y=t},t.addCard=function(e){0==this.cards.includes(e)&&this.cards.push(e)},t.addCardAt=function(e,t){void 0===t&&(t=0),0==this.cards.includes(e)&&this.cards.splice(t,0,e)},t.removeCard=function(e){var t=this.cards.indexOf(e);return t>=0&&(this.cards.splice(t,1),!0)},t.update=function(){},t.getPlacingPosition=function(){return{x:this.x,y:this.y}},t.clear=function(){this.cards=[]},t.isEmpty=function(){return 0===this.cards.length},t.getCardsLength=function(){return this.cards.length},e}(),Zy=function(e){function t(t){var n;return(n=e.call(this,t)||this).maxCardsShow=void 0,n.locked=void 0,n.lockedManual=void 0,n.totalUsedCards=void 0,n.draw=function(){if(!n.locked&&!n.lockedManual){var e=n.cards[n.cards.length-1];if(e){var t=n.boardGame.waste.getOnTopCard();(null==t?void 0:t.behavior.type)!==Qh.JOKER&&(n.totalUsedCards+=1,n.boardGame.mover.moveToWaste({src:(0,fc.Z)(n),card:e,duration:300}),n.boardGame.waste.getCardsLength()>1&&(n.boardGame.mover.increaseMoves(),n.boardGame.onPlayerMove()),e.behavior.type!=Qh.WINDMILL?n.boardGame.checkLose():e.behavior.activate())}}},n.maxCardsShow=16,n.totalUsedCards=0,n.setName(tu.Stock),n.locked=!1,n.lockedManual=!1,n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.totalUsedCards=0},n.lockDrawByTime=function(e){this.setLocked(!0)},n.setLocked=function(e){this.locked=e},n.setLockedManual=function(e){this.lockedManual=e},n.isLocked=function(){return this.isLocked()},n.addCardAt=function(e,t){if(t){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.splice(t,0,e)}else this.addCard(e)},n.addCard=function(e){if(0!=this.cards.includes(e))throw"Invalid operation";this.cards.push(e)},n.align=function(){for(var e=this.cards.length,t=6*(e-1),n=0;n<e;n++){var i=this.cards[n];i.setVisible(n>=e-15);var a=this.x+6*Math.max(n,e-15)-t;i.setPosition(a,this.y)}},n.getPosition=function(e){var t=6*(this.cards.length-1),n=new Phaser.Geom.Point(0,0),i=this.cards.indexOf(e);return i>=0?(n.x=this.x+6*i-t,n.y=this.y):(n.x=this.x,n.y=this.y),n},n.getTotalCardsRemain=function(){return this.cards.length},t}(Gy),Fy=Wi.Z.EFFECTS,Uy=Fy.KEY,Wy=Fy.FRAME,Hy=function(e){function t(t){var n;return(n=e.call(this,t,Uy,Wy.FX_COMET)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setDepth(Fr.Z.PRIORITY+1),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:Wy.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.2*e,end:.4*e},lifespan:{min:200,max:300}})},n.explode=function(e,t,n){this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),Yy=Hy,Ky=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.starsParticle=void 0,n.curveFromStreak=function(){var e=n.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),t=n.scene.gameplay.comboManager.streakBar.getWorldPositionOfCurrentItem();return{start:t,mid:{x:n.scene.world.getWorldSize().width/2+Phaser.Math.RND.between(-50,50),y:t.y-Phaser.Math.RND.between(-35,-5)},end:e,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.curveFromPoint=function(e,t){var i={x:e+Phaser.Math.RND.between(-5,5),y:t+ +Phaser.Math.RND.between(-5,5)},a=n.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),r=new Phaser.Math.Vector2(i.x-a.x,i.y-a.y),s=Phaser.Math.Clamp(r.length()/5,20,30),o=r.clone().scale(.1).negate().add(new Phaser.Math.Vector2(i.x,i.y)),c=Phaser.Math.Vector2.DOWN.clone().scale(Phaser.Math.Between(0,s)).rotate(Phaser.Math.FloatBetween(0,2*Math.PI));return c.add(o),{start:i,mid:c,end:a,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.scene=t,n.createStarsEmitter(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.getChildren().forEach((function(e){e.setVisible(!1),e.setActive(!1)}))},n.runAnimationRewardCoinFromStreak=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.COINS_APPEAR),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON),this.scene.gameUI.coinBarButton.setDisabled(!0),n=[],i=0;i<t;i++)n.push(this.curveFromStreak());return e.next=7,this.runAnimationCoinsFlyingIntoBarAsync(n);case 7:this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runAnimationRewardCoinAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.COINS_APPEAR),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),this.scene.gameUI.coinBarButton.setDisabled(!0),a=[],r=0;r<t;r++)a.push(this.curveFromPoint(n,i));return e.next=7,this.runAnimationCoinsFlyingIntoBarAsync(a);case 7:this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.makeCoinFlyAsync=function(e){var t=e.start,n=e.mid,i=e.end,a=e.duration,r=e.delay,s=void 0===r?0:r,o=this.spawn();o.setScaleByWorld(1.25),o.setPosition(t.x,t.y),o.setAlpha(0);var c=new Phaser.Curves.Spline([t.x,t.y,n.x,n.y,i.x,i.y]),h=(i.y-t.y)*(t.x-n.x)+(t.x-i.x)*(t.y-n.y);return Ny(this.scene,{onStart:function(){o.setAlpha(1)},target:o,delay:s,curve:c,duration:a,rotateToCurve:!0,rotateOffset:0,angularVector:h>0?-15:15,onComplete:function(){o.kill()}})},n.runAnimationCoinsFlyingIntoBarAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.scene.gameUI.coinBarButton.coinBar.getWorldPositionOfCoin(),i=[],a=0;a<t.length;a++)t[a].delay=30*(t.length-a),r=this.makeCoinFlyAsync(t[a]),i.push(r);return this.setDepth(this.scene.gameUI.coinBarButton.depth+2),this.starsParticle.setDepth(this.scene.gameUI.coinBarButton.depth+1),Promise.any(i).then((function(){s.scene.gameUI.onCoinChanged()})),i.forEach((function(e){e.then((function(){s.scene.gameUI.coinBarButton.runBounceCoinButtonAnimation(),s.starsParticle.explode(14,n.x,n.y),s.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.COUNT_COINS,{},!0)}))})),e.abrupt("return",Promise.all(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.spawn=function(){var e=this.getFirstDead();return e||(e=this.addCoin()),e.revive(),e},n.addCoin=function(){var e=Wi.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.IC_COIN);return i.setDefaultWorldSize(),this.add(i),i},n.createStarsEmitter=function(){this.starsParticle=new Yy(this.scene)},t}(Phaser.GameObjects.Group),zy=Ky,Vy=Wi.Z.GAMEPLAY_DEFAULT,jy=Vy.KEY,Xy=Vy.FRAME,qy=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).scene=void 0,a.text=void 0,a.icon=void 0,a.scene=t,a.create(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this.scene.add.image(0,0,jy,Xy.IC_COIN);e.setDefaultWorldSize();var t=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),text:"999",origin:{x:1,y:.55}});this.add([e,t]),this.icon=e,this.text=t},n.setCoin=function(e){this.text.setText(e.toString());var t=this.icon.width+this.text.width;this.text.setX(t/2),this.icon.setX(-t/2+8)},t}(Phaser.GameObjects.Container),Jy=qy,Qy=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.spawn=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=this.getFirstDead();return n||(n=this.addCoin()),n.revive(),n.setPosition(e,t),n.setAlpha(1),this.scene.gameplayLayer.bringToTop(n),n},n.reset=function(){this.getChildren().forEach((function(e){e.kill()}))},n.getChildren=function(){return e.prototype.getChildren.call(this)},n.addCoin=function(){var e=new Jy(this.scene,0,0);return this.add(e),this.scene.gameplayLayer.add(e),e},n.runAnimation=function(e){var t=e.coin,n=e.x,i=e.y,a=e.duration,r=void 0===a?800:a,s=e.offsetY,o=void 0===s?-40:s,c=e.delay,h=void 0===c?0:c,u=e.depth,l=void 0===u?Fr.Z.EFFECT:u,d=this.spawn(n,i);d.setCoin(t),d.setDepth(l);var p=this.scene.tweens.createTimeline();return d.setPosition(n,i),d.setAlpha(0),p.add({targets:d,x:n,y:i+o/2,duration:r/2,delay:h,onStart:function(){d.setAlpha(1)}}),p.add({targets:d,alpha:0,y:i+o,duration:r/2,onComplete:function(){d.kill()}}),p.play(),p},t}(Phaser.GameObjects.Group),$y=Qy,eE=function(e){return e[e.MATCH=0]="MATCH",e[e.COMPLETED_LEVEL=1]="COMPLETED_LEVEL",e}({}),tE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.spawn=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var i=this.getFirstDead();return i||(i=this.addText()),i.setText(e),i.revive(),i.setPosition(t,n),i.setAlpha(1),this.scene.gameplayLayer.bringToTop(i),i},n.reset=function(){this.getChildren().forEach((function(e){e.kill()}))},n.getChildren=function(){return e.prototype.getChildren.call(this)},n.addText=function(){var e=this.scene.add.bitmapText(0,0,Pc.ZP.PRIMARY.KEY,"",this.scene.fontSize(20));return e.setOrigin(.5,.5),e.setDepth(Fr.Z.EFFECT),this.add(e),this.scene.gameplayLayer.add(e),e},n.runFlyUpAndFadeOutAnimation=function(e){var t=e.text,n=e.x,i=e.y,a=e.duration,r=void 0===a?800:a,s=e.offsetY,o=void 0===s?-40:s,c=e.delay,h=void 0===c?0:c,u=e.depth,l=void 0===u?Fr.Z.EFFECT:u,d=this.spawn(t,n,i);d.setDepth(l);var p=this.scene.tweens.createTimeline();return d.setPosition(n,i),d.setAlpha(0),p.add({targets:d,x:n,y:i+o/2,duration:r/2,delay:h,onStart:function(){d.setAlpha(1)}}),p.add({targets:d,alpha:0,y:i+o,duration:r/2,onComplete:function(){d.kill()}}),p.play(),p},t}(Phaser.GameObjects.Group),nE=tE,iE={DIFF_MATCH_COIN:1},aE=(function(e){e.PILE="pile",e.STOCK="stock"}({}),function(){function e(e){this.scene=void 0,this.rewardManager=void 0,this.matchCoins=void 0,this.totalStockCoins=void 0,this.scene=e,this.rewardManager=e.rewardManager,this.init()}var t=e.prototype;return t.init=function(){this.totalStockCoins=0,this.matchCoins=0},t.resetMatchReward=function(){},t.getTotalRewardedValue=function(){return this.matchCoins+this.totalStockCoins},t.matchReward=function(e,t){return 0},t.stockReward=function(e){var t=this.scene.gameSettings.reward.coinsPerStockCard;return this.rewardManager.isSpecialStockCard(e)&&(t*=2),this.totalStockCoins+=t,t},t.undo=function(e){0!=this.matchCoins&&(this.matchCoins-=iE.DIFF_MATCH_COIN)},t.runShowRewardedValueAnimForStock=function(e,t,n){this.scene.rewardManager.coinTextAnimationPool.runAnimation({coin:n,x:e,y:t,duration:370,offsetY:-15})},e}()),rE=aE,sE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.starsParticle=void 0,n.curveFromStreak=function(){var e=n.getTestingDestination(),t=n.scene.gameplay.comboManager.streakBar.getWorldPositionOfCurrentItem();return{start:t,mid:{x:n.scene.world.getWorldSize().width/2+Phaser.Math.RND.between(-50,50),y:t.y-Phaser.Math.RND.between(-35,-5)},end:e,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(1100,1200)}},n.curveFromPoint=function(e,t){var i={x:e,y:t},a=n.scene.gameUI.starBarButton.starBar.getWorldPositionOfStar(),r=new Phaser.Math.Vector2(i.x-a.x,i.y-a.y),s=Phaser.Math.Between(60,100),o=r.clone().scale(.1).negate().add(new Phaser.Math.Vector2(i.x,i.y)),c=Phaser.Math.Vector2.DOWN.clone().scale(Phaser.Math.Between(0,s)).rotate(7*Math.PI/4);return c.add(o),{start:i,mid:c,end:a,delay:Phaser.Math.RND.between(0,600),duration:Phaser.Math.RND.between(600,650)}},n.scene=t,n.createStarsEmitter(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.getChildren().forEach((function(e){e.setVisible(!1),e.setActive(!1)}))},n.runAnimationRewardStarAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.scene.audio.playAudioSprite(Fc.Z.BOOSTERS.KEY,ec.Z.COINS_APPEAR),this.scene.gameUI.starBarButton.setDepth(Fr.Z.PRIORITY),this.scene.gameUI.starBarButton.setDisabled(!0),a=[],r=0;r<t;r++)a.push(this.curveFromPoint(n,i));return e.next=7,this.runAnimationStarsFlyingIntoBarAsync(a);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.makeStarFlyAsync=function(e){var t=e.start,n=e.mid,i=e.end,a=e.duration,r=e.delay,s=void 0===r?0:r,o=this.spawn();o.setScaleByWorld(1.25),o.setPosition(t.x,t.y),o.setAlpha(0);var c=new Phaser.Curves.Spline([t.x,t.y,n.x,n.y,i.x,i.y]),h=(i.y-t.y)*(t.x-n.x)+(t.x-i.x)*(t.y-n.y);return Ny(this.scene,{from:0,to:1,onStart:function(){o.setAlpha(1),o.setScale(1/GameCore.ImageScale),o.setAngle(0)},onUpdate:function(e,t,n){var i=e.getValue(),a=180*(h>0?i:-i),r=1+-.6666666666666667*i;o.setScale(r*(1/GameCore.ImageScale)),o.setAngle(a)},target:o,delay:s,curve:c,duration:a,rotateToCurve:!0,rotateOffset:0,onComplete:function(){o.kill()}})},n.getTestingDestination=function(){return{x:this.scene.gameZone.width-20,y:20}},n.runAnimationStarsFlyingIntoBarAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.scene.gameUI.starBarButton.starBar.getWorldPositionOfStar(),i=[],a=0;a<t.length;a++)t[a].delay=30*(t.length-a),r=this.makeStarFlyAsync(t[a]),i.push(r);return this.setDepth(this.scene.gameUI.starBarButton.depth+2),this.starsParticle.setDepth(this.scene.gameUI.starBarButton.depth+1),Promise.any(i).then((function(){s.scene.gameUI.onStarChanged()})),i.forEach((function(e){e.then((function(){s.scene.gameUI.starBarButton.runBounceStarButtonAnimation(),s.starsParticle.explode(20,n.x,n.y),s.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS,{},!0)}))})),e.abrupt("return",Promise.all(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.spawn=function(){var e=this.getFirstDead();return e||(e=this.addStar()),e.revive(),e},n.addStar=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.STAR);return i.setDefaultWorldSize(),this.add(i),i},n.createStarsEmitter=function(){this.starsParticle=new Yy(this.scene)},t}(Phaser.GameObjects.Group),oE=sE,cE=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isDailyRewarding=void 0,n.rewardBehavior=void 0,n.coinTextAnimationPool=void 0,n.coinAnimationPool=void 0,n.textAnimationPool=void 0,n.starAnimationPool=void 0,n.rewardHeart=function(e,t){if(0!=e){var i=Wi.Z.GAMEPLAY_DEFAULT,a=i.KEY,r=i.FRAME,s=n.scene,o=n.scene.gameUI.lifeBarButton;o.setAutoUpdateHearts(!1),s.life.increaseHeart(e,!1),o.setAutoUpdateHearts(!0);var c=s.add.image(0,0,a,r.IC_HEART);c.setScaleByWorld(2),c.setDepth(Fr.Z.PRIORITY);var h={x:s.world.getWorldSize().width/2,y:s.world.getWorldSize().height/2-20},u={x:h.x-20,y:h.y+20},l=o.lifeBar.getIconHeartPos(),d=new Phaser.Curves.Spline([h.x,h.y,u.x,u.y,l.x,l.y]);c.setPosition(h.x,h.y),Ny(s,{target:c,curve:d,rotateToCurve:!1,rotateOffset:0,duration:1e3,delay:200,onComplete:function(){var e=n.scene.life.getHearts();o.lifeBar.updateHearts(e),t&&t()}}),c.setScale(0),c.setY(h.y+25);var p=s.tweens.createTimeline();p.add({targets:c,scale:1,y:h.y,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),p.add({targets:c,scale:.6,duration:1e3}),p.add({targets:c,alpha:0,scale:.8,duration:200}),p.play()}},n.scene=t,n.createCoinTextPool(),n.createCoinPool(),n.createTextPool(),n.createStarAnimationPool(),n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){var t;e.prototype.init.call(this),this.rewardBehavior=new rE(this.scene),null==(t=this.rewardBehavior)||t.init()},n.rewardCoin=function(e){var t=this.scene.player.getCoins();this.setCoins(t+e,!1)},n.rewardStar=function(e){var t=this.scene.player.getStar();this.setStars(t+e,!1)},n.getTotalRewardCoin=function(){return this.rewardBehavior.getTotalRewardedValue()},n.setCoins=function(e,t){var n=this.scene.gameUI.coinBarButton;0==t&&n.setAutoUpdateCoin(!1),this.scene.player.setCoins(e),n.setAutoUpdateCoin(!0)},n.setStars=function(e,t){var n=this.scene.gameUI.starBarButton;0==t&&n.setAutoUpdateStar(!1),this.scene.player.setStar(e),n.setAutoUpdateStar(!0)},n.undo=function(e){this.rewardBehavior.undo(e)},n.resetMatchReward=function(){this.rewardBehavior.resetMatchReward()},n.reward=function(e,t){var n=t||{},i=n.x,a=void 0===i?0:i,r=n.y,s=void 0===r?0:r,o=0,c=this.scene.player.getCoins();if(e===eE.MATCH)o=this.rewardBehavior.matchReward(a,s);this.scene.player.setCoins(c+o)},n.matchReward=function(e,t){this.rewardBehavior.matchReward(e,t)},n.runStockRewardAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.gameplay.boardGame.stock,n=[].concat(t.cards),i=[],a=1,r=n.length-1;case 5:if(!(r>=0)){e.next=16;break}return s=n[r],this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.COUNT_COINS),this.scene.audio.playAudioSprite(Fc.Z.CARD_COMBO.KEY,"n_card_"+a),a=Math.min(a+1,12),i.push(this.runCardRewardAnim(s)),e.next=13,(0,dl.Z)(this.scene,185);case 13:r--,e.next=5;break;case 16:return e.next=18,Promise.all(i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setRewardBehavior=function(e){this.rewardBehavior=e},n.isSpecialStockCard=function(e){return e.behavior.type==Qh.JOKER||e.behavior.type==Qh.WINDMILL},n.runCardRewardAnim=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.gameplay.boardGame.stock,i=this.scene.tweens.createTimeline(),a=this.rewardBehavior.stockReward(t),r=function(){n.cards.pop(),n.cards.length>=15&&n.animateAlignCards()},i.add({targets:t,y:n.y-50,duration:370,onStart:r,onComplete:function(){var e=t.x,n=t.y;s.rewardBehavior.runShowRewardedValueAnimForStock(e,n-40,a)}}),i.add({targets:t,alpha:0,duration:370}),e.next=8,i.playAndWaitForCompletion();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCoinTextPool=function(){var e=new $y(this.scene);this.coinTextAnimationPool=e},n.createCoinPool=function(){var e=new zy(this.scene);this.coinAnimationPool=e},n.createTextPool=function(){this.textAnimationPool=new nE(this.scene)},n.createStarAnimationPool=function(){this.starAnimationPool=new oE(this.scene)},t}(bp),hE=cE,uE=function(e,t){this.x=void 0,this.y=void 0,this.x=e,this.y=t},lE=function(){function e(e,t){var n=this;this.boardGame=void 0,this.card=void 0,this.facingUp=void 0,this.type=void 0,this.value=void 0,this.suit=void 0,this.random=!0,this.effectedCard=void 0,this.setFacing=function(e){n.facingUp=e},this.boardGame=e,this.card=t,this.type=Qh.UNKNOWN,this.value=-1,this.suit=-1}var t=e.prototype;return t.setValue=function(e,t){this.value=e,this.suit=t,this.type=Qh.VALUE,this.random=!1},t.setFacingWithFlippingAnim=function(e,t){if(this.facingUp!==e){if(e&&this.random&&this.checkCardHasValue()){var n={value:Math.floor(13*Math.random()+1),suit:Math.floor(4*Math.random()+1)};(this.card.beginPlacement==tu.Stock||this.card.beginPlacement==tu.Pile)&&(n=this.boardGame.deck.getRandomValue()),this.value=n.value,this.suit=n.suit,this.random=!1}this.facingUp=e,t&&t()}},t.init=function(){},t.activate=function(e){0==this.facingUp&&this.setFacingWithFlippingAnim(!0),e&&e()},t.undo=function(){},t.onPlayerMove=function(){},t.getPoints=function(e){void 0===e&&(e=!0);var t=[],n=this.card.payload,i=n.x,a=n.y,r=new uE(i,a);e||(r=new uE(this.card.x,this.card.y));var s=new uE(r.x-22.5,r.y-34),o=new uE(r.x+22.5,r.y-34),c=new uE(r.x-22.5,r.y+34),h=new uE(r.x+22.5,r.y+34);t.push.apply(t,[s,o,h,c]);for(var u=0;u<4;u++){var l=this.card.payload.angle*(Math.PI/180),d=Math.cos(l),p=Math.sin(l),f=t[u].x-i,m=t[u].y-a;t[u].x=f*d-m*p+i,t[u].y=f*p+m*d+a}return t},t.isPlusCard=function(){return this.type==Qh.PLUS_ONE||this.type==Qh.PLUS_TWO||this.type==Qh.PLUS_THREE||this.type==Qh.PLUS_FOUR||this.type==Qh.PLUS_FIVE},t.checkCardHasValue=function(){return this.type==Qh.VALUE||this.type==Qh.CHESTNUT||this.type==Qh.BOOM||this.type==Qh.CHANGER||this.type==Qh.CHAIN},t.killItems=function(){},t.reviveItems=function(){},t.revive=function(){},t.kill=function(){},t.hide=function(){this.card.setVisible(!1)},t.show=function(){this.card.setVisible(!0)},t.update=function(e){},t.postUpdate=function(){},e}(),dE=lE,pE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).data=void 0,t}return(0,s.Z)(t,e),t.prototype.setData=function(e){this.data=e,this.value=e.value,this.suit=e.suit,this.random=e.random},t}(dE),fE=pE,mE=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.activate=function(){var e=this.boardGame.pile.handleWithLock(this.card);this.boardGame.mover.moveToWaste({src:this.boardGame.pile,card:this.card,duration:800,lockSegment:e})},t}(fE),gE=mE,vE=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEAR_DANGER=1]="NEAR_DANGER",e[e.DANGER=2]="DANGER",e}(vE||{}),yE=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).state=void 0,i.explodeTime=void 0,-1==n.payload.NumberOfMoves&&(n.payload.NumberOfMoves=Math.floor(11*Math.random()+10)),i.explodeTime=n.payload.NumberOfMoves,i}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.state=vE.NORMAL,this.type=Qh.BOOM,this.setNumberOfMoves(this.explodeTime),e.prototype.init.call(this)},n.setNumberOfMoves=function(e){this.explodeTime=e,4==this.explodeTime&&this.state!=vE.NEAR_DANGER&&(this.state=vE.NEAR_DANGER),this.explodeTime<=3&&this.state!=vE.DANGER&&(this.state=vE.DANGER),this.explodeTime>4&&this.state!=vE.NORMAL&&(this.state=vE.NORMAL)},n.onPlayerMove=function(){this.explodeTime-=1,this.explodeTime<=0&&this.boardGame.lose()},t}(gE),EE=yE,CE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).isRising=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.isRising=1==this.data.CardChangerType,this.type=Qh.CHANGER},n.onPlayerMove=function(){if(e.prototype.onPlayerMove.call(this),this.facingUp){var t=this.value;this.isRising?(t+=1)>gu.KING&&(t=gu.ACE):(t-=1)<gu.ACE&&(t=gu.KING),this.setValue(t,this.suit),this.type=Qh.CHANGER}},t}(gE),AE=CE,wE=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.CHESTNUT,e.prototype.init.call(this)},n.activate=function(){e.prototype.activate.call(this);var t=this.boardGame.pile.cards.filter((function(e){return e.isType(Qh.SQUIRREL)}));if(0!=t.length){var n=this.getNearestSquirrelCard(t);this.effectedCard=n,n.behavior.activate()}},n.getNearestSquirrelCard=function(e){var t=this,n=this.getDistance(e[0],this.card),i=0;return e.forEach((function(e,a){var r=t.getDistance(e,t.card);r<n&&(i=a,n=r)})),e[i]},n.getDistance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},t}(gE),SE=wE,bE=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.KEY,e.prototype.init.call(this)},n.activate=function(){this.boardGame.pile.removeCard(this.card),this.card.kill();var e=this.boardGame.pile.getLockCards();if(0!=e.length){var t=e[Math.floor(Math.random()*e.length)];t.behavior.activate(),this.effectedCard=t}},t}(fE),TE=bE,xE=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.LOCK,e.prototype.init.call(this)},n.activate=function(){var e=this.boardGame.pile;this.kill(),e.removeCard(this.card),e.refresh()},t}(fE),PE=xE,kE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).requiredUnlockNuts=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.SQUIRREL,e.prototype.init.call(this)},n.activate=function(){this.requiredUnlockNuts-=1,this.requiredUnlockNuts<=0&&(this.boardGame.pile.removeCard(this.card),this.card.kill())},n.increaseNuts=function(){this.requiredUnlockNuts+=1},n.setRemainNuts=function(e){this.requiredUnlockNuts=e},t}(fE),IE=kE,OE=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n)||this).plus=void 0,a.cards=void 0,a.plus=i,a}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.cards=[],e.prototype.init.call(this),this.setPlus(this.plus)},n.onPlayerMove=function(){this.addCardToStock(this.plus),this.card.kill();var e=this.boardGame.pile;e.removeCard(this.card),e.refresh(!1)},n.setPlus=function(e){this.plus=e,1==this.plus?this.type=Qh.PLUS_ONE:2==this.plus?this.type=Qh.PLUS_TWO:3==this.plus?this.type=Qh.PLUS_THREE:4==this.plus?this.type=Qh.PLUS_FOUR:5==this.plus&&(this.type=Qh.PLUS_FIVE);for(var t=0;t<this.plus;t++){var n=this.boardGame.deck.getNewStockCard();n.kill(),this.cards.push(n)}},n.addCardToStock=function(e){for(var t=0;t<e;t++){var n=this.boardGame.deck.getNewStockCard();this.boardGame.stock.addCard(n)}},t}(fE),RE=OE,BE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).originalPlacement=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.originalPlacement=tu.None,this.type=Qh.JOKER},n.setOriginalPlacement=function(e){this.originalPlacement=e},n.onPlayerMove=function(){0==this.facingUp&&this.setFacingWithFlippingAnim(!0),this.boardGame.mover.fromPileToWaste(this.card),this.boardGame.pile.refresh(!1)},n.activate=function(){0==this.facingUp&&this.setFacingWithFlippingAnim(!0);var e=this.boardGame.waste;this.originalPlacement==tu.Pile&&this.boardGame.mover.fromPileToWaste(this.card),this.originalPlacement==tu.Joker&&e.addCard(this.card)},t}(dE),DE=BE,LE=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=Qh.WINDMILL},n.onPlayerMove=function(){var e=this.boardGame.pile;e.getFrontCards().forEach((function(t){e.removeCard(t)})),this.boardGame.waste.removeCard(this.card),e.refresh(!0),this.boardGame.checkWin()},t}(fE),_E=LE,ME=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=Qh.MYSTERIOUS,this.setRandomBehavior()},n.setRandomBehavior=function(){var e=[Qh.BOOM,Qh.CHANGER,Qh.JOKER,Qh.PLUS_FIVE,Qh.PLUS_FOUR,Qh.PLUS_THREE,Qh.PLUS_TWO,Qh.PLUS_ONE],t=e[Math.floor(Math.random()*e.length)];this.card.setBehavior(t),this.type=t},t}(fE),NE=ME,GE=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).isAffected=!1,i.connectedCard=void 0,i.setData(n.payload),i.type=Qh.CHAIN,i}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.type=Qh.CHAIN},n.setConnectedCard=function(e){e&&(this.connectedCard=e)},n.activate=function(){e.prototype.activate.call(this),this.checkProcessOnSingle()&&this.boardGame.pile.draw(this.connectedCard)},n.checkProcessOnSingle=function(){return this.isAffected?(this.isAffected=!1,!1):(this.connectedCard.behavior instanceof t&&(this.connectedCard.behavior.isAffected=!0),!0)},t}(gE),ZE=function(){function e(e,t){this.x=void 0,this.y=void 0,this.angle=void 0,this.isInteractive=void 0,this.visible=void 0,this.active=void 0,this.isTint=void 0,e&&t?(this.x=e,this.y=t):(this.x=0,this.y=0),this.angle=0,this.isInteractive=!1,this.isTint=!1,this.visible=!0,this.active=!0}var t=e.prototype;return t.setPosition=function(e,t){this.x=e,this.y=t},t.setAngle=function(e){this.angle=e},t.setVisible=function(e){this.visible=e},t.kill=function(){this.visible=!1,this.active=!1},t.revive=function(){this.visible=!0,this.active=!0},t.setInteractive=function(){this.isInteractive=!0},t.disableInteractive=function(){this.isInteractive=!1},t.setActive=function(e){this.active=e},t.setY=function(e){this.y=e},t.setX=function(e){this.x=e},e}(),FE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).missingMapPieces=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.TREASURE,e.prototype.init.call(this)},n.activate=function(){this.missingMapPieces-=1,this.missingMapPieces<=0&&(this.boardGame.pile.removeCard(this.card),this.card.kill())},n.increaseMissingMapPieces=function(){this.missingMapPieces+=1},n.setMissingMapPieces=function(e){this.missingMapPieces=e},t}(fE),UE=FE,WE=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){this.type=Qh.MAP_PIECE,e.prototype.init.call(this)},n.activate=function(){e.prototype.activate.call(this);var t=this.boardGame.pile.cards.filter((function(e){return e.isType(Qh.TREASURE)}));if(0!=t.length){var n=this.getNearestTreasureMapCard(t);this.effectedCard=n,n.behavior.activate()}},n.getNearestTreasureMapCard=function(e){var t=this,n=this.getDistance(e[0],this.card),i=0;return e.forEach((function(e,a){var r=t.getDistance(e,t.card);r<n&&(i=a,n=r)})),e[i]},n.getDistance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},t}(gE),HE=WE,YE=(Wi.Z.CARD_BACK,Wi.Z.GAMEPLAY),KE=(YE.KEY,YE.FRAME,{id:1,x:100,y:100,angle:0,depth:ru.DEPTH.CARD,type:Qh.VALUE,random:!0,faceUp:!1,modifiers:[],sequence:0,value:0,suit:0,isPosUpdated:!1,NumberOfMoves:0,CardChangerType:0,connectedCardID:-1}),zE=function(e){function t(t,n,i){var r;if((r=e.call(this)||this).id=void 0,r.boardGame=void 0,r.payload=void 0,r.isInteractive=void 0,r.isFlyingToStock=void 0,r.behavior=void 0,r.beginPlacement=void 0,r.boardGame=t,r.isInteractive=!1,r.isFlyingToStock=!1,r.beginPlacement=n,r.payload=(0,a.Z)({},KE,i),1==r.payload.random){var s=Math.floor(52*Math.random()),o=(s+1)%13==0?13:(s+1)%13,c=Math.floor(s/13)+1;r.payload.value=o,r.payload.suit=c}return r.id=GameCore.Utils.String.generateObjectId(),r}(0,s.Z)(t,e);var n=t.prototype;return n.setBehavior=function(e){this.behavior;var t=void 0;e==Qh.LOCK&&(t=new PE(this.boardGame,this)).setData(this.payload),e==Qh.KEY&&(t=new TE(this.boardGame,this)).setData(this.payload),e==Qh.VALUE&&(t=new gE(this.boardGame,this)).setData(this.payload),e==Qh.BOOM&&(t=new EE(this.boardGame,this)).setData(this.payload),e==Qh.SQUIRREL&&(t=new IE(this.boardGame,this)).setData(this.payload),e==Qh.CHESTNUT&&(t=new SE(this.boardGame,this)).setData(this.payload),e==Qh.TREASURE&&(t=new UE(this.boardGame,this)).setData(this.payload),e==Qh.MAP_PIECE&&(t=new HE(this.boardGame,this)).setData(this.payload),e==Qh.PLUS_ONE&&(t=new RE(this.boardGame,this,1)).setData(this.payload),e==Qh.PLUS_TWO&&(t=new RE(this.boardGame,this,2)).setData(this.payload),e==Qh.PLUS_THREE&&(t=new RE(this.boardGame,this,3)).setData(this.payload),e==Qh.PLUS_FOUR&&(t=new RE(this.boardGame,this,4)).setData(this.payload),e==Qh.PLUS_FIVE&&(t=new RE(this.boardGame,this,5)).setData(this.payload),e==Qh.CHANGER&&(t=new AE(this.boardGame,this)).setData(this.payload),e==Qh.JOKER&&(t=new DE(this.boardGame,this)),e==Qh.WINDMILL&&(t=new _E(this.boardGame,this)),e==Qh.MYSTERIOUS&&(t=new NE(this.boardGame,this)),e==Qh.CHAIN&&(t=new GE(this.boardGame,this)),t||(t=new dE(this.boardGame,this)),this.behavior=t,t.init()},n.revive=function(){e.prototype.revive.call(this)},n.isType=function(){if(0==this.active)return!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.behavior.type)},n.kill=function(){e.prototype.kill.call(this),this.behavior.kill()},n.update=function(e){this.behavior.update(e)},t}(ZE),VE=function(){function e(e){this.boardGame=void 0,this.cards=void 0,this.matchRatioCalculator=void 0,this.boardGame=e,this.cards=[],this.matchRatioCalculator=e.solver.scene.gameplay.boardGame.deck.matchRatioCalculator,this.matchRatioCalculator.reset()}var t=e.prototype;return t.getCard=function(e){return this.cards.find((function(t){return t.id==e}))},t.getNewCard=function(e,t){var n=new zE(this.boardGame,e,t);return this.cards.push(n),n},t.getJokerCard=function(){var e=this.getNewCard(tu.None);return e.setBehavior(Qh.JOKER),e},t.getWindmillCard=function(){var e=this.getNewCard(tu.Stock);return e.setBehavior(Qh.WINDMILL),e},t.getNewStockCard=function(){var e=this.getNewCard(tu.Stock);return e.setBehavior(),e},t.getMatchesForPile=function(e,t){var n=function(n){if(!n.behavior.random){var i=n.behavior.value;e.forEach((function(n,a){if(!(n.value<0||n.suit<0)){var r=Math.abs(i-n.value);1!=r&&12!=r||(t.push(n),e[a]={suit:-1,value:-1})}}))}};this.boardGame.pile.getFrontCards().forEach(n);var i=this.boardGame.waste.getOnTopCard();i&&n(i)},t.getRandomValue=function(){for(var e=this.matchRatioCalculator.getMatchRatio(),t=[],n=[],i=[],a=1;a<=4;a++)for(var r=1;r<=13;r++)t.push({suit:a,value:r});if(this.getMatchesForPile(t,n),0==n.length)return{value:Phaser.Math.Between(1,13),suit:Phaser.Math.Between(1,4)};t.forEach((function(e){e.value>0&&e.suit>0&&i.push(e)}));for(var s=i.length-Math.min(Math.round(i.length*(1-e)),2*n.length),o=0;o<s;o++){var c=Phaser.Math.Between(0,i.length-1);if(i.splice(c,1),i.length<1)break}var h=[].concat(n,i),u=[].concat(this.boardGame.pile.getFrontCards()),l=this.boardGame.waste.getOnTopCard();l&&u.push(l);for(var d=h.filter((function(e){var t=e.value,n=e.suit;return!u.some((function(e){return e.behavior.value==t&&e.behavior.suit==n}))})),p=Phaser.Math.Between(0,d.length-1),f=0;f<1;f++){if(!u.some((function(e){return e.behavior.value==d[p].value})))break;p=Phaser.Math.Between(0,d.length-1)}var m=d[p];return n.includes(m)?this.matchRatioCalculator.reset():this.matchRatioCalculator.onRandomCanNotMatch(),m},t.getRandomPileCard=function(){var e=this.getAllCardData(),t=this.boardGame.pile.getFrontCards(),n=e.filter((function(e){var n=e.value,i=e.suit;return!t.some((function(e){return e.behavior.value==n&&e.behavior.suit==i}))}));return n[Phaser.Math.RND.between(0,n.length-1)]},t.getAllCardData=function(){for(var e=[],t=1;t<=4;t++)for(var n=1;n<=13;n++)e.push({suit:t,value:n});return e},t.getMatchesForLock=function(e,t){var n=this.boardGame.pile.getFrontCards(),i=this.boardGame.locks.filter((function(e){return 0==e.isUnLock&&e.active}));if(0!=i.length){var a=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*a.lockSegments.length),s=a.lockSegments[r];n.some((function(e){if(s.canUnlock(e.behavior.value,e.behavior.suit))return!0}))||e.forEach((function(n,i){if(!(n>=52)){var a=(n+1)%13==0?13:(n+1)%13,r=Math.floor(n/13)+1;s.canUnlock(a,r)&&(t.push(n),e[i]=100)}}))}},t.clear=function(){this.cards.forEach((function(e){e.kill()})),this.cards=[],this.matchRatioCalculator.reset()},e}(),jE=VE,XE=function(e,t){this.x=void 0,this.y=void 0,this.x=e,this.y=t},qE=function(e,t,n,i){this.x1=void 0,this.y1=void 0,this.x2=void 0,this.y2=void 0,this.x1=e,this.y1=t,this.x2=n,this.y2=i},JE=function(e){function t(t){var n;return(n=e.call(this,t)||this).draw=function(e,t,i){var a,r,s,o;if(void 0===t&&(t=1200),void 0===i&&(i=!1),e&&!n.checkOverlap(e)&&0!=e.behavior.facingUp&&(null==(a=e.behavior)?void 0:a.type)!==Qh.LOCK&&(null==(r=e.behavior)?void 0:r.type)!==Qh.SQUIRREL&&(null==(s=e.behavior)?void 0:s.type)!==Qh.TREASURE){var c=n.boardGame.waste.getOnTopCard();if((null==(o=e.behavior)?void 0:o.type)===Qh.KEY)return n.boardGame.mover.increaseMoves(),void e.behavior.activate();if(c)(n.isMatch(e,c)||i)&&(n.boardGame.mover.increaseMoves(),n.boardGame.solver.increaseCombo(),e.behavior.activate(),n.boardGame.onPlayerMove(),n.refresh())}},n.setName(tu.Pile),n}(0,s.Z)(t,e);var n=t.prototype;return n.addCard=function(t){e.prototype.addCard.call(this,t),t.setInteractive()},n.align=function(){},n.getCardType=function(e){var t=e.behavior.value;return{type:Math.ceil(t/13),number:t%13==0?13:t%13}},n.getLockCards=function(){return this.cards.filter((function(e){return e.behavior instanceof PE}))},n.handleWithLock=function(e){for(var t=this.boardGame.locks,n=0;n<t.length;n++){var i=t[n];if(0==i.isUnLock&&i.active){var a=i.unlockSegment(e);if(a)return a}}},n.isMatch=function(e,t){var n,i;if((null==(n=e.behavior)?void 0:n.type)==Qh.JOKER||(null==(i=t.behavior)?void 0:i.type)==Qh.JOKER)return!0;if(0==e.behavior.checkCardHasValue())return!1;var a=Math.abs(t.behavior.value-e.behavior.value);return 1==a||12==a},n.getFrontCards=function(){var e=this;return this.cards.filter((function(t){if(t.isInteractive&&t.behavior.checkCardHasValue()&&!e.checkOverlap(t))return t}))},n.getDownCards=function(){var e=this;return this.cards.filter((function(t){if(t.isInteractive&&t.behavior.checkCardHasValue()&&e.checkOverlap(t))return t}))},n.isOverLap=function(e,t){for(var n=e.behavior.getPoints(),i=t.behavior.getPoints(),a=0;a<4;a++)for(var r=3==a?0:a+1,s=new qE(n[a].x,n[a].y,n[r].x,n[r].y),o=0;o<4;o++){var c=3==o?0:o+1,h=new qE(i[o].x,i[o].y,i[c].x,i[c].y);if(this.lineToLine(s,h))return!0}return!1},n.lineToLine=function(e,t){var n=new XE(0,0),i=e.x1,a=e.y1,r=e.x2,s=e.y2,o=t.x1,c=t.y1,h=t.x2,u=t.y2,l=(u-c)*(r-i)-(h-o)*(s-a);if(0===l)return!1;var d=((h-o)*(a-c)-(u-c)*(i-o))/l,p=((r-i)*(a-c)-(s-a)*(i-o))/l;return d>=0&&d<=1&&p>=0&&p<=1&&(n.x=i+d*(r-i),n.y=a+d*(s-a),!0)},n.checkOverlap=function(e){for(var t=this.cards.filter((function(t){return t!==e&&t.active&&t.payload.depth>e.payload.depth})),n=0;n<t.length;n++){if(this.isOverLap(t[n],e))return t[n]}},n.refresh=function(e){var t=this;void 0===e&&(e=!0),this.getCardsWithType(Qh.MYSTERIOUS).forEach((function(e){return e.behavior.activate()})),this.cards.forEach((function(e){t.checkOverlap(e)?0==e.payload.faceUp&&e.behavior.setFacingWithFlippingAnim(!1):e.behavior.setFacingWithFlippingAnim(!0)})),this.boardGame.lockCards(),e&&this.boardGame.checkLose()},n.getCurrentBoomCards=function(){var e=this,t=this.cards.filter((function(e){return e.active&&e.isInteractive&&e.behavior.type===Qh.BOOM})),n=[];return t.forEach((function(t){!e.checkOverlap(t)&&t.behavior.facingUp&&n.push(t)})),n},n.getCardsWithType=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=this.cards.filter((function(e){return e.isType.apply(e,n)&&e.isInteractive})),r=[];return a.forEach((function(t){e.checkOverlap(t)||r.push(t)})),r},t}(Gy),QE=function(e){function t(t){var n;return(n=e.call(this,t)||this).setName(tu.Waste),n}(0,s.Z)(t,e);var n=t.prototype;return n.refresh=function(){this.getOnTopCard()},n.addCard=function(t){e.prototype.addCard.call(this,t),t.disableInteractive()},n.removeCard=function(t){var n=e.prototype.removeCard.call(this,t),i=this.getOnTopCard();return i&&i.behavior.show(),n},n.getOnTopCard=function(){if(0!=this.cards.length){var e=this.cards.length;return this.cards[e-1]}},t}(Gy),$E=function(){function e(e){this.boardGame=void 0,this.moves=void 0,this.boardGame=e,this.moves=0}var t=e.prototype;return t.fromPileToWaste=function(e){var t=this.boardGame.pile,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.fromStockToWaste=function(e){var t=this.boardGame.stock,n=this.boardGame.waste;t.removeCard(e)&&n.addCard(e)},t.moveToWaste=function(e){var t=this.boardGame,n=(t.waste,t.pile),i=e.src,a=e.card;e.duration,e.lockSegment;switch(i.name){case tu.Stock:this.fromStockToWaste(a),a.behavior.setFacingWithFlippingAnim(!0);break;case tu.Pile:this.fromPileToWaste(a),0==n.cards.length&&this.boardGame.checkWin()}},t.getMoves=function(){return this.moves},t.increaseMoves=function(){this.moves+=1},t.setMoves=function(e){this.moves=e},t.clear=function(){this.moves=0},e}(),eC=$E,tC=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,n,i)||this).boardGame=void 0,s.parent=void 0,s.value=void 0,s.parent=a,s.value=r,s.boardGame=t,s}return(0,s.Z)(t,e),t.prototype.canUnlock=function(e,t){var n=this.value;if(n.cardFace>0){if(e==n.cardFace)return!0}else if(n.cardSuit>0){if(t==n.cardSuit)return!0}else if(n.cardColor>0){if(n.cardColor==yu.RED&&(t==vu.HEART||t==vu.DIAMOND))return!0;if(n.cardColor==yu.BLACK&&(t==vu.CLUBS||t==vu.SPADES))return!0}return!1},t}(ZE),nC=tC,iC=function(e){function t(t,n,i,a){var r;return(r=e.call(this,n,i)||this).boardGame=void 0,r.isUnLock=void 0,r.payload=void 0,r.direction=void 0,r.lockSegments=void 0,r.boardGame=t,r.payload=a,r.isUnLock=!1,r.direction=2,r.lockSegments=[],r.createLockSegments(a.balloons),r.alignSegments(),r}(0,s.Z)(t,e);var n=t.prototype;return n.handleCards=function(e){this.direction=this.payload.direction;var t=this.getObjects(),n=t.cards,i=t.locks;e?(n.forEach((function(e){e.disableInteractive()})),i.forEach((function(e){e.setActive(!1)}))):(n.forEach((function(e){e.setInteractive()})),i.forEach((function(e){e.setActive(!0)})),this.isUnLock=!0)},n.getObjects=function(){var e=this,t=this.boardGame.pile.cards,n=this.boardGame.locks,i=[],a=[];return 1==this.direction?(i=t.filter((function(t){return t.payload.x<e.x})),a=n.filter((function(t){return t!=e&&t.x<e.x}))):2==this.direction&&(i=t.filter((function(t){return t.payload.x>=e.x})),a=n.filter((function(t){return t!=e&&t.x>=e.x}))),{cards:i,locks:a}},n.createLockSegments=function(e){var t=this;e.forEach((function(e){t.createSegment(e)}))},n.createSegment=function(e){var t=new nC(this.boardGame,0,0,this,e.cardValues);return t.setPosition(this.x,this.y),this.lockSegments.push(t),t},n.alignSegments=function(){var e=0,t=this.lockSegments.filter((function(e){return e.visible})),n=15*(t.length-1);t.forEach((function(t){t.setY(e-n),e+=35}))},n.unlockSegment=function(e){if(this.active){var t=this.lockSegments.filter((function(t){return t.visible&&t.active&&t.canUnlock(e.behavior.value,e.behavior.suit)}));if(t.length>0){var n=t[Math.floor(Math.random()*t.length)];return n.kill(),0==this.lockSegments.filter((function(e){return e.active&&e.visible})).length&&this.handleCards(!1),n}}},n.killLockSegment=function(e){e.kill()},n.revive=function(){e.prototype.revive.call(this),this.isUnLock=!1},n.reviveLockSegment=function(e){e.revive(),this.alignSegments()},t}(ZE),aC=iC,rC=ru.CARD_VIEW.HEIGHT,sC=function(){function e(e){var t=this;this.solver=void 0,this.stock=void 0,this.deck=void 0,this.pile=void 0,this.waste=void 0,this.mover=void 0,this.locks=void 0,this.canRefillStock=void 0,this.analytics={stockLength:0,plusFiveCards:0},this.win=function(){t.gameOver(!0)},this.lose=function(){t.gameOver(!1)},this.isLose=function(){return 0==t.stock.getTotalCardsRemain()&&(t.analytics.plusFiveCards+=1,t.refillStock(5)),!1},this.solver=e,this.canRefillStock=!0,this.locks=[],this.deck=new jE(this),this.stock=new Zy(this),this.pile=new JE(this),this.waste=new QE(this),this.mover=new eC(this);this.stock.setPosition(-60,0-rC/2-5),this.waste.setPosition(0,0-rC/2-5),this.stock.init()}var t=e.prototype;return t.startGame=function(e){this.clear(),this.initPile(e),this.initStock(e),this.createLocks(e),this.pile.refresh(!0),this.stock.draw()},t.onPlayerMove=function(){var e=this.pile;e.getCardsWithType(Qh.BOOM,Qh.CHANGER).forEach((function(e){e.behavior.onPlayerMove()}));var t=this.waste.getOnTopCard();t&&t.isType(Qh.WINDMILL)&&t.behavior.onPlayerMove();for(var n=e.cards.filter((function(e){return e.behavior.isPlusCard()||e.isType(Qh.JOKER)})),i=0;i<n.length;i++){var a=n[i];this.pile.checkOverlap(a)||(a.behavior.onPlayerMove(),n.splice(i,1),i=-1)}},t.gameOver=function(e){this.locks.forEach((function(e){return e.kill()})),this.locks=[],e&&(this.solver.numberOfWining+=1);var t=this.mover.getMoves();this.solver.totalMoves+=t,this.solver.totalUsedStockCards+=this.stock.totalUsedCards,this.solver.minMoves>t&&(this.solver.minMoves=t),this.solver.timeRunning-=1,this.solver.timeRunning<=0?this.solver.isRunning=!1:(this.clear(),this.solver.solveLevel())},t.clear=function(){this.pile.clear(),this.stock.clear(),this.waste.clear(),this.deck.clear(),this.mover.clear()},t.setCanRefillStock=function(e){this.canRefillStock=e},t.initStock=function(e){var t=e.settings.cardsInStack;this.analytics.stockLength=t.length;for(var n=0;n<t.length;n++){var i=this.deck.getNewCard(tu.Stock);i.setBehavior();var a=t[n],r=a.value,s=a.suit;r&&(-1==r?i.behavior.random=!0:i.behavior.setValue(r,s)),this.stock.addCard(i)}this.stock.init(),this.stock.align()},t.initPile=function(e){var t=this;e.cards.forEach((function(e){var n=t.deck.getNewCard(t.pile.name,e),i=e.x,a=e.y;n.setPosition(i,a),n.setAngle(e.angle),n.setBehavior(e.type),t.pile.addCard(n)})),this.setNutsInSquirrel(),this.connectChainCard()},t.createLocks=function(e){var t=this,n=e.balloonData;0!=n.length&&(n.forEach((function(e){var n=e.position,i=n.x,a=n.y,r=new aC(t,i,a,e);t.locks.push(r)})),this.lockCards())},t.setNutsInSquirrel=function(){var e=this.pile.cards.filter((function(e){return e.isType(Qh.CHESTNUT)})),t=this.pile.cards.filter((function(e){return e.isType(Qh.SQUIRREL)}));if(0!=e.length&&0!=t.length){var n=Math.floor(e.length/t.length),i=e.length;t.forEach((function(e){i-n<=0&&(n=i),i-=n,e.behavior.setRemainNuts(n)}))}},t.connectChainCard=function(){var e=this;this.pile.cards.filter((function(e){return e.isType(Qh.CHAIN)})).forEach((function(t){var n=e.pile.cards.find((function(e){return e.payload.connectedCardID==t.payload.connectedCardID}));t.behavior.setConnectedCard(n)}))},t.checkLose=function(){this.isLose()&&this.canRefillStock&&this.refillStock(5)},t.checkWin=function(){this.isWin()&&this.win()},t.lockCards=function(){this.locks.forEach((function(e){0==e.isUnLock&&e.active&&e.handleCards(!0)}))},t.update=function(e){},t.refillStock=function(e){for(var t=0;t<e;t++){var n=this.deck.getNewCard(tu.Stock);n.setBehavior(),this.stock.addCard(n)}this.stock.align(),this.checkLose()},t.isWin=function(){return 0==this.pile.cards.filter((function(e){return 1==e.visible})).length},e}(),oC=sC,cC=function(){function e(e){this.scene=void 0,this.boardGame=void 0,this.isRunning=void 0,this.numberOfTest=void 0,this.timeRunning=void 0,this.totalMoves=void 0,this.minMoves=void 0,this.totalUsedStockCards=void 0,this.numberOfWining=void 0,this.combo=void 0,this.maxCombo=void 0,this.indexComboType=void 0,this.scene=e,this.boardGame=new oC(this),this.init()}var t=e.prototype;return t.solveLevel=function(e){var t=this.scene.level.getLevelData();t&&(this.isRunning=!0,this.boardGame.startGame(t))},t.init=function(){this.isRunning=!1,this.totalMoves=0,this.minMoves=99999,this.totalUsedStockCards=0,this.numberOfWining=0,this.timeRunning=0,this.numberOfTest=0,this.combo=0,this.maxCombo=4,this.indexComboType=0,this.boardGame.analytics.plusFiveCards=0},t.setNumberOfTest=function(e){this.numberOfTest=e,this.timeRunning=e},t.showResults=function(){this.totalMoves,this.numberOfTest,this.totalUsedStockCards,this.numberOfTest},t.run=function(){for(this.init(),this.setNumberOfTest(100),this.solveLevel(this.scene.level.getLevel());!1!==this.isRunning;)this.draw();var e=this.totalMoves/this.numberOfTest,t=this.totalUsedStockCards/this.numberOfTest,n=this.boardGame.analytics.plusFiveCards/this.numberOfTest,i=this.boardGame.analytics.stockLength;return{numberOfTest:this.numberOfTest,stockLength:i,avgMoves:e,minMoves:this.minMoves,avgUsedStockCards:t,numberOfWining:this.numberOfWining,avgPlusFiveCards:n}},t.getNonVisitedCards=function(e,t){return e.filter((function(e){if(0==t.includes(e))return!0}))},t.getLongestChainLength=function(e,t,n,i,a){var r=this;return t.push(e),a>i&&(i=a),this.getNonVisitedCards(n,t).forEach((function(s){r.boardGame.pile.isMatch(e,s)&&(i=r.getLongestChainLength(s,t,n,i,a+1))})),t.pop(),i},t.getCardWithLongestChain=function(e){for(var t=this.boardGame.pile.getFrontCards(),n=[],i=-1,a=0;a<e.length;a++){var r=e[a],s=this.getLongestChainLength(r,[],t,0,0);i<s&&(i=s),n.push({startCard:r,length:s})}var o=n.filter((function(e){return e.length==i}));return o[Phaser.Math.Between(0,o.length-1)].startCard},t.getPileMatchableCards=function(){var e=this.boardGame.pile,t=this.boardGame.waste.getOnTopCard();return t?e.getFrontCards().filter((function(n){return e.isMatch(n,t)})):[]},t.draw=function(){var e=this.boardGame.stock,t=this.boardGame.pile,n=t.getCardsWithType(Qh.KEY),i=this.getPileMatchableCards();if(0==t.getFrontCards().length&&(this.isRunning=!1),n.length>0){var a=n[Phaser.Math.Between(0,n.length-1)];t.draw(a)}else if(i.length>0){var r=this.getCardWithLongestChain(i);t.draw(r)}else t.cards.length>0&&e.cards.length>0&&e.draw()},t.printOutCardsStat=function(){var e=this,t=this.boardGame.pile.getFrontCards(),n=this.boardGame.stock.cards,i=[],a=[];t.forEach((function(t){var n=t.behavior.value,a=t.behavior.suit,r=e.getCardSuitType(a);i.push({type:r,value:n})}));var r=this.boardGame.waste.getOnTopCard();if(r){r.behavior.value;var s=r.behavior.suit;this.getCardSuitType(s)}n.forEach((function(t){var n=t.behavior.value,i=t.behavior.suit,r=e.getCardSuitType(i);a.push({suitType:r,value:n,type:t.behavior.type})}));var o=this.boardGame.locks;o.length>0&&o.forEach((function(e){0==e.isUnLock&&e.active}))},t.getCardSuitType=function(e){var t="SPADE";return e==vu.HEART&&(t="HEART"),e==vu.DIAMOND&&(t="DIAMOND"),e==vu.CLUBS&&(t="CLUBS"),e==vu.SPADES&&(t="SPADE"),t},t.increaseCombo=function(){},t.handleCombo=function(){switch(this.indexComboType){case 0:this.addWildCardFromCombo();break;case 3:this.addCardFromCombo()}},t.addWildCardFromCombo=function(){var e=this.boardGame.stock,t=this.boardGame.deck.getJokerCard();t.behavior.setOriginalPlacement(tu.Combo);var n=Math.floor(Math.random()*e.cards.length);e.addCardAt(t,n)},t.addCardFromCombo=function(){var e=this.boardGame,t=e.stock,n=e.deck.getNewStockCard(),i=Phaser.Math.Between(0,t.cards.length-1);t.addCardAt(n,i)},e}(),hC=cC,uC=Ap.STATUS,lC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.gameMode=void 0,n.handleGameModeChanged=function(){n.stop(),n.start()},n.scene=t,n.init(),n}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.gameMode=oi.SINGLE,li.instance.on(hi.GAME_MODE_CHANGED,this.handleGameModeChanged)},n.setUpShowUI=function(){this.gameMode=li.instance.getGameMode();var e={};switch(this.gameMode){case oi.SINGLE:case oi.CHALLENGE_FRIENDS:case oi.TOURNAMENT:e={levelTitle:!0,challengeInfo:!1,challengeTitle:!1,weeklyTournamentInfo:!1}}this.scene.gameUI.setUpShowUIPayload(e)},n.start=function(){if(!this.isRunning()){switch(this.setUpShowUI(),this.gameMode=li.instance.getGameMode(),this.gameMode){case oi.SINGLE:this.startSingleMode();break;case oi.TOURNAMENT:this.startTournamentMode();break;case oi.CHALLENGE_FRIENDS:this.startChallengeMode();break;default:this.stopChallengeMode(),this.stopTournamentMode()}this.setState(uC.RUNNING)}},n.stop=function(){switch(this.gameMode){case oi.SINGLE:this.stopSingleMode();break;case oi.TOURNAMENT:this.stopTournamentMode();break;case oi.CHALLENGE_FRIENDS:this.stopChallengeMode()}this.setState(uC.STOPPED)},n.startSingleMode=function(){this.scene.rewardManager.setRewardBehavior(new rE(this.scene))},n.stopSingleMode=function(){},n.startTournamentMode=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.rewardManager.setRewardBehavior(new rE(this.scene));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTournamentInfo=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.stopTournamentMode=function(){},n.startChallengeMode=function(){this.scene.rewardManager.setRewardBehavior(new rE(this.scene))},n.stopChallengeMode=function(){},t}(bp),dC=lC,pC={targets:[],duration:300,ease:n(87).Z,props:{scale:{from:1.2,to:1}}},fC=function(e){function t(t){return e.call(this,pC,t)||this}return(0,s.Z)(t,e),t}(ch.Z),mC=[{id:1,value:{coin:50}},{id:2,value:{coin:75}},{id:3,value:{coin:100}},{id:4,value:{coin:125}},{id:5,value:{coin:150}},{id:6,value:{coin:200}},{id:7,value:{coin:300}}],gC=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mC);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vC={REWARDED:"rewarded",SKIPPED:"skipped",READY:"ready",WAITING:"waiting"},yC=(0,j.P1)([function(e){var t;return null==(t=e[Ys])?void 0:t.rewards}],(function(e){return e})),EC=(0,j.P1)([function(e){var t;return null==(t=e[Ys])?void 0:t.isRequesting}],(function(e){return e})),CC=GameCore.Configs.DailyRewards,AC=function(e){return function(t){var n=window.game.player.getCustomData("dailyRewarded")||{},i=n.logDays,r=void 0===i?[]:i,s=n.lastRewarded,o=void 0===s?0:s,c=new Date,h=new Date(o),u=new Date(h.toDateString()),l=Math.abs(c.valueOf()-u.valueOf()),d=Math.floor(l/864e5)>1,p=CC.CheckInterrupt&&d||r.length>=CC.MaxDays,f=p?[!1]:[].concat(r,[!1]);p&&wC([]);var m=e.map((function(e,t){var n=t<f.length,i=f.length===t+1,r=!1===f[t],s=vC.WAITING;return i?s=vC.READY:p?s=vC.WAITING:n&&r?s=vC.SKIPPED:n&&(s=vC.REWARDED),(0,a.Z)({},e,{status:s})}));t({type:zs,payload:{rewards:m}})}},wC=function(e,t){void 0===t&&(t=!1),window.game.player.setCustomData("dailyRewarded",{logDays:e,lastRewarded:t?0:Date.now()})},SC=n(102),bC=Wi.Z.DEFAULT,TC=bC.KEY,xC=bC.FRAME,PC=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).isDayPassed=void 0,i.getButton=void 0,i.payload=void 0,i.background=void 0,i.blockBg=void 0,i.titleBg=void 0,i.titleText=void 0,i.iconStatus=void 0,i.currencyIcon=void 0,i.starTwinkleUp=void 0,i.pulsateBubbleAnimation=void 0,i.lock=void 0,i.bg=void 0,i.isDayPassed=!1,i.payload=n,i.setName("Day: "+n.day),i.draw(),i.setStatus(),i}(0,s.Z)(t,e);var n=t.prototype;return n.setStatus=function(){switch(this.payload.status){case vC.READY:this.setStatusReady(),this.runAnimations();break;case vC.SKIPPED:this.setStatusSkipped();break;case vC.REWARDED:this.setStatusRewarded();break;default:this.setStatusWaiting()}},n.setStatusReady=function(){this.getButton.setVisible(!0),this.titleText.setColor(3504414),this.updateStatusForDay7(),this.setCurrentIconByDay(this.payload.day)},n.setStatusRewarded=function(){this.iconStatus.setVisible(!0),this.getButton.setVisible(!1),this.titleText.setColor(10959151),this.updateStatusForDay7(),this.setIconStatus(!0),this.setCurrentIconByDay(this.payload.day),this.isDayPassed=!0},n.setStatusSkipped=function(){this.iconStatus.setVisible(!0),this.getButton.setVisible(!1),this.titleText.setColor(10959151),this.updateStatusForDay7(),this.setIconStatus(!1),this.setCurrentIconByDay(this.payload.day),this.isDayPassed=!0},n.setStatusWaiting=function(){this.titleText.setColor(177484871),this.updateStatusForDay7(),this.setCurrentIconByDay(this.payload.day),this.getButton.setVisible(!1)},n.updateStatusForDay7=function(){7===this.payload.day&&this.titleText.setColor(8071345)},n.setIconStatus=function(e){e?(this.iconStatus.setFrame(xC.ICON_CHECK),this.iconStatus.setWorldSize(28.5,22)):this.iconStatus.kill()},n.setCurrentIconByDay=function(e){var t=xC.ICON_REWARD_1;switch(e){case 1:t=xC.ICON_REWARD_1,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 2:t=xC.ICON_REWARD_2,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 3:t=xC.ICON_REWARD_3,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,5);break;case 4:t=xC.ICON_REWARD_4,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,10);break;case 5:t=xC.ICON_REWARD_5,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,0,15);break;case 6:t=xC.ICON_REWARD_6,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this,4,15);break;case 7:t=xC.ICON_REWARD_7,this.currencyIcon.setFrame(t),Phaser.Display.Align.In.Center(this.currencyIcon,this)}this.currencyIcon.setDefaultWorldSize()},n.draw=function(){this.updateBlockSize(),this.createBlockBG(),this.createTitleText(),this.createCurrencyIcon(),this.createIconStatus(),this.createGetButton()},n.createBackground=function(){this.background=this.scene.make.image({key:TC,frame:xC.DAILY_DAY_BG}),this.background.setWorldSize(75,102),this.add(this.background)},n.updateBlockSize=function(){7==this.payload.day?this.setSize(96.5,243):this.setSize(96.5,112)},n.createBlockBG=function(){this.createShadow();var e={width:96.5,height:this.height-31.5},t=this.payload,n=t.status,i=t.day,a=vC.READY,r=vC.REWARDED,s=vC.SKIPPED,o=xC.DAILY_PURPLE_HEADER;if(i<7)switch(n){case a:o=xC.DAILY_GREEN_HEADER;break;case s:case r:o=xC.DAILY_ORANGE_HEADER;break;default:o=xC.DAILY_RED_HEADER}var c=this.scene.add.image(0,0,TC,o);c.setDefaultWorldSize();var h=this.scene.make.nineslice({key:TC,frame:xC.DAILY_BLOCK_BG,leftWidth:24,rightWidth:24,topHeight:24,bottomHeight:24,width:e.width,height:e.height});this.add([h,c]),this.bg=h,Phaser.Display.Align.In.TopCenter(c,this),h.setY((this.displayHeight-h.displayHeight)/2-.5)},n.createShadow=function(){var e=this.scene.make.nineslice({key:TC,frame:xC.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:this.width+21,height:this.height+20});e.setY(10),this.add(e)},n.createTitleBg=function(){this.titleBg=this.scene.make.image({key:TC,frame:xC.DAILY_DAY_TITLE_GREY}),this.titleBg.setWorldSize(68,25),this.add(this.titleBg),Phaser.Display.Align.In.TopCenter(this.titleBg,this,0,-1)},n.createTitleText=function(){var e=this.payload.day;this.titleText=new hv(this.scene),this.titleText.setText("Day "+e),this.titleText.setFontSize(16),this.titleText.setColor(10959151),this.add(this.titleText),Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-5)},n.createCurrencyIcon=function(){this.currencyIcon=this.scene.make.image({key:TC,frame:xC.ICON_REWARD_1}),this.currencyIcon.setDefaultWorldSize(),this.add(this.currencyIcon)},n.createIconStatus=function(){this.iconStatus=this.scene.make.image({key:TC,frame:xC.ICON_DOT}),this.iconStatus.setVisible(!1),this.iconStatus.setWorldSize(20,22),this.add(this.iconStatus)},n.createGetButton=function(){var e=new nv(this.scene,TC,xC.BUTTON.GREEN_40,61.5,35.5);e.setName("Get");var t=this.scene.make.bitmapText({font:Pc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5},text:"Get"});e.add(t),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,e.height/2-7),this.getButton=e},n.createLock=function(){var e=void 0;(e=7==this.payload.day?this.scene.make.image({key:TC,frame:xC.PURPLE_LOCK}):this.scene.make.image({key:TC,frame:xC.LOCK})).setVisible(!1),e.setWorldSize(24.5,33.5),this.add(e),Phaser.Display.Align.In.Center(e,this,0,6),this.lock=e},n.runAnimations=function(){this.runSparksIdle()},n.runSparksIdle=function(){this.starTwinkleUp||(this.starTwinkleUp=new SC.Z(this.scene),this.starTwinkleUp.emitter.setFrequency(100),this.add(this.starTwinkleUp));var e=this.currencyIcon,t=e.x,n=e.y,i=e.width,a=e.height;this.starTwinkleUp.run(1,t,n,i,a)},n.runPulsateBubbleAnimation=function(){this.pulsateBubbleAnimation||(this.pulsateBubbleAnimation=new oh.Z({targets:[this.currencyIcon],props:{scale:"+=0.04"}})),this.pulsateBubbleAnimation.play()},t}(Phaser.GameObjects.Container),kC=PC,IC=Wi.Z.DEFAULT,OC=(IC.KEY,IC.FRAME,GameCore.Configs),RC=(OC.Network,OC.DailyRewards),BC={id:0,value:{coin:0}},DC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).onReward=void 0,s.onSkipAd=void 0,s.onNoAd=void 0,s.scene=void 0,s.isClaimed=void 0,s.logDays=void 0,s.rewardsData=void 0,s.popup=void 0,s.loading=void 0,s.dayBlocks=void 0,s.claimButton2X=void 0,s.claimButton=void 0,s.adsTimer=void 0,s.title=void 0,s.popupExitsAnimation=void 0,s.handleOnClaim=function(e){if(!s.isClaimed){s.isClaimed=!0;var t=s.getCurrentRewardValue(),n=s.dayBlocks.getChildren()[e],i=t.coin;s.claimReward();var a=n.getWorldPosition(),r=a.x,o=a.y;s.scene.rewardManager.rewardCoin(i),s.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,r,o),s.scene.screen.close(s.name),s.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{})}},s.updateRewardsData=(0,r.Z)(c().mark((function e(){var t,n,i,a,o,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.scene,n=t.storage,i=t.player,e.next=3,n.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!EC(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Ks,payload:{}}),e.next=7,gC();case 7:a=e.sent,t(AC(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:if(a=n.getState(),!((null==(o=yC(a)||[])?void 0:o.length)<1)){e.next=7;break}return e.abrupt("return");case 7:s.rewardsData=o,h=i.getCustomData("dailyRewarded"),u=(h||{}).logDays,l=void 0===u?[]:u,s.logDays=[].concat(l);case 11:case"end":return e.stop()}}),e)}))),s.isCanOpen=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 6:if(!(RC.MockTime>0)){e.next=10;break}if(!(Date.now()-t>=1e3*RC.MockTime)){e.next=10;break}return e.abrupt("return",!0);case 10:if(!(0,le.Gm)(t)){e.next=12;break}return e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e)}))),s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s))},s.scene=t,s.rewardsData=[],s.isClaimed=!1,s.createPopupContents(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isCanOpen();case 2:if(t.sent){t.next=6;break}return this.scene.screen.open(ce.o4.DASHBOARD_SCREEN),t.abrupt("return");case 6:return null==(n=this.dayBlocks)||n.destroy(!0,!0),e.prototype.open.call(this),t.next=10,this.updateRewardsData();case 10:this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.createDayBlocks(),this.runOpenAnimation();case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.close=function(){this.runCloseAnimation()},n.claimReward=function(){this.logDays.push(!0),wC(this.logDays),this.scene.audio.playSound(ec.Z.DAILY_REWARD),this.runContentExitsAnimation(0,400)},n.getCurrentRewardValue=function(){var e=this.rewardsData.find((function(e){return e.status===vC.READY}));return(null==e?void 0:e.value)||{coin:0}},n.getRewardByDay=function(e){return this.rewardsData.find((function(t){return t.id===e}))||BC},n.runOpenAnimation=function(){this.setVisible(!0),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(300,250)},n.runPopupEntrancesAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.popup]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runPopupContentEntrancesAnimation=function(e,t){var n=this.dayBlocks.getChildren();n.length<1||[[n[0]],[n[1],n[3]],[n[2],n[4]],[n[5],n[6]]].forEach((function(e,n){new fC({targets:e,duration:t,delay:60*n,props:{alpha:{start:0,from:.3,to:1},scale:{from:.8,to:1}},ease:Phaser.Math.Easing.Back.Out}).play()}))},n.runCloseAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.popup]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.runContentExitsAnimation=function(e,t){this.popupExitsAnimation||(this.popupExitsAnimation=new Iv.Z({targets:[].concat(this.dayBlocks.getChildren(),[this.title]),delay:this.scene.tweens.stagger(30,{start:e}),duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In})),this.popupExitsAnimation.play()},n.createPopupContents=function(){this.createTitle()},n.createTitle=function(){var e=new hv(this.scene);e.setText(this.scene.lang.Text.dailyBonus),e.setColor(7162732),e.setFontSize(30),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-16),this.title=e},n.createDayBlocks=function(){var e,t=this;null==(e=this.dayBlocks)||e.destroy(!0,!0);var n=RC.MaxDays;this.dayBlocks=this.scene.make.group({maxSize:n}),new Array(n).fill(null).forEach((function(e,n){var i=t.createDayBlock(n+1);t.dayBlocks.add(i),i.getButton.onClick=function(){t.handleOnClaim(n)}})),Phaser.Actions.GridAlign(this.dayBlocks.getChildren(),{width:3,height:2,cellWidth:115.5,cellHeight:131,x:-163.75,y:-35});var i=this.dayBlocks.getLast(!0),a=this.dayBlocks.getFirst(!0);i&&a&&i.setPosition(a.x+346.5,a.y+65.5),this.dayBlocks.getChildren().forEach((function(e){e instanceof kC&&e.isDayPassed&&t.moveBelow(e,t.background)}))},n.createDayBlock=function(e){var t=this.getRewardByDay(e),n=t.value,i=t.status,a=void 0===i?"":i,r=new kC(this.scene,{day:e,value:n,status:a});return r.setAlpha(0),this.add(r),r},t}(GameCore.Screen),LC=DC,_C=function(){function e(e){this.scene=void 0,this.list=void 0,this.scene=e,this.list=new Map}var t=e.prototype;return t.backupObject=function(e){var t=this.getProps(e);this.list.set(e,t)},t.backupObjectProp=function(e,t,n){var i={x:t,y:n};this.list.set(e,i)},t.getObjectSaved=function(e){var t=this.list.get(e);return t||this.getProps(e)},t.getProps=function(e){return{x:e.x,y:e.y}},e}(),MC=_C,NC=n(96),GC=function(e){function t(t){return e.call(this,t)||this}return(0,s.Z)(t,e),t.prototype.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),a},t}(Phaser.GameObjects.Particles.Particle),ZC=GC,FC=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,"effects/"+i+"-sparkle")||this).emitter=void 0,a.emitterFrame=void 0,a.scene=t,a.emitterFrame="effects/"+i+"-sparkle",a.setActive(!1),a.setVisible(!1),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:this.emitterFrame,quantity:1,speedX:{min:-5,max:5},speedY:{min:-5,max:-13},lifespan:{min:3e3,max:5e3},alpha:0,scale:{min:.1,max:1/3},angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:300,x:{min:-30,max:25},y:{min:-2,max:-20},blendMode:"Multiply",particleClass:ZC})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},n.setEmitterFrame=function(e){this.emitterFrame=e,this.reset()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),UC=FC,WC=Wi.Z.WEEKLY_TOURNAMENT_CHESTS.KEY,HC=Wi.Z.OFFSHORE_RACE_CHESTS.KEY,YC={gold:{x:5,y:-39},silver:{x:5,y:-30},purple:{x:5,y:-30},bronze:{x:4,y:-26}},KC=function(e){return e.GOLD="gold",e.SILVER="silver",e.PURPLE="purple",e.BRONZE="bronze",e}({}),zC=function(e){return e.WEEKLY_TOURNAMENT="weekly-tournament",e.OFFSHORE_RACE="offshore-race",e}({}),VC=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0)||this).chest=void 0,a.openChestTimeline=void 0,a.glow=void 0,a.chestSparklesFlyUp=void 0,a.chestType=void 0,a.eventType=void 0,a.scene=t,a.chestType=n,a.eventType=i,a.create(),a.scene.add.existing((0,fc.Z)(a)),a.glow.kill(),a.kill(),a}(0,s.Z)(t,e);var n=t.prototype;return n.updateChestFrame=function(e,t){this.chestType=e,this.eventType=t,this.setChestClose(),this.setSize(this.chest.width,this.chest.height),this.glow.setFrame("effects/"+this.chestType+"-glow"),this.glow.setOrigin(.5,1),this.glow.setDefaultWorldSize(),this.chestSparklesFlyUp.setEmitterFrame("effects/"+this.chestType+"-sparkle")},n.setChestClose=function(){this.chest.setFrame(this.eventType+"/"+this.chestType+"-close"),this.chest.setOrigin(.5,1),this.chest.setDefaultWorldSize()},n.setChestOpen=function(){this.chest.setFrame(this.eventType+"/"+this.chestType+"-open"),this.chest.setOrigin(.5,1),this.chest.setDefaultWorldSize()},n.runChestEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),void 0===n&&(n=0),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.CHEST_FLYING,{},!0),i=new NC.Z({targets:[this],duration:500,curve:[[t-100,n+110],[t-66,n+60],[t-33,n+40],[t,n+60]],props:{scale:{from:1.2,start:1.2,to:1},scaleX:{from:.8,start:.8,to:1},scaleY:{from:1.2,start:1.2,to:1},alpha:{from:0,start:0,to:1,duration:200}},onStart:function(){a.revive()}}),(0,dl.Z)(this.scene,130).then((function(){i.play()})),e.next=7,i.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runChestOpenAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),void 0===n&&(n=60),null==(i=this.openChestTimeline)||!i.isPlaying()){e.next=4;break}return e.abrupt("return");case 4:return a=this.y,(r=this.scene.tweens.createTimeline()).add({targets:this,scaleX:"+=0.05",scaleY:"-=0.05",duration:150,yoyo:!0,ease:Phaser.Math.Easing.Sine.Out}),r.add({targets:this,scaleX:"-=0.05",scaleY:"+=0.05",y:a-40,duration:150,ease:Phaser.Math.Easing.Sine.Out}),r.add({targets:this,scaleX:"+=0.05",scaleY:"-=0.05",x:t,y:n+60,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){s.setChestOpen(),s.runChestLightAnimation()}}),r.play(),(0,dl.Z)(this.scene,600).then((function(){s.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.CHEST_OPEN)})),this.openChestTimeline=r,e.next=14,r.waitForCompletion();case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runChestLightAnimation=function(){var e=this,t=YC[this.chestType],n=t.x,i=t.y;this.glow.setPosition(this.chest.x+n,this.chest.y+i),this.scene.tweens.add({targets:this.glow,scaleY:{from:0,start:0,to:1/3},alpha:{from:0,start:0,to:1,duration:150},duration:300,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.glow.revive()}}),this.chestSparklesFlyUp.setPosition(0,this.glow.y),this.chestSparklesFlyUp.start()},n.runChestExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chestSparklesFlyUp.stop(),t=this.scene.tweens.add({targets:[this],alpha:{from:1,start:1,to:0},duration:250,scale:{from:1,start:1,to:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.glow.kill(),n.kill(),n.setScale(1),n.setAlpha(1)}}).waitForCompletion(),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.createChest(),this.createGlow(),this.createChestStarsFlyUp()},n.createChest=function(){var e=this.eventType===zC.WEEKLY_TOURNAMENT?WC:HC,t=this.scene.add.image(0,0,e,this.eventType+"/"+this.chestType+"-close");t.setOrigin(.5,1),t.setDefaultWorldSize(),this.add(t),this.setSize(t.width,t.height),this.chest=t},n.createGlow=function(){var e=this.eventType===zC.WEEKLY_TOURNAMENT?WC:HC,t=this.scene.add.image(0,0,e,"effects/"+this.chestType+"-glow");t.setOrigin(.5,1),t.setDefaultWorldSize(),t.kill(),this.add(t),this.glow=t},n.createChestStarsFlyUp=function(){var e=this.eventType===zC.WEEKLY_TOURNAMENT?WC:HC;this.chestSparklesFlyUp=new UC(this.scene,e,this.chestType),this.add(this.chestSparklesFlyUp)},t}(Phaser.GameObjects.Container),jC=function(){function e(e){this.scene=void 0,this.scene=e}var t=e.prototype;return t.logGetItemByEvent=function(e,t,n){var i=this.getTypeWithItemType(t),a=null;switch(e){case zC.WEEKLY_TOURNAMENT:a=gl.WEEKLY_TOURNAMENT;break;case zC.OFFSHORE_RACE:a=gl.OFFSHORE_RACE;break;default:return}i&&this.logGetItem(i,n,a)},t.logBuyBooster=function(e,t,n){var i=this.getTypeWithItemType(e),a=null;switch(i){case fl.BOOSTER_SLICE:a=gl.BUY_BOOSTER_SLICE;break;case fl.BOOSTER_STORM:a=gl.BUY_BOOSTER_STORM;break;case fl.BOOSTER_WILD_DROP:a=gl.BUY_BOOSTER_WILD_DROP;break;default:return}this.logBuyItemWithCoins(i,t,n,a)},t.logBuyItemWithCoins=function(e,t,n,i){var a=this.scene.player.getLevel(),r={level:a,max_player_level:a,resource_type_1:fl.COIN,resource_change_1:-t,resource_type_2:e.toString(),resource_change_2:n,transaction_type:i.toString(),transaction_count:1};this.logEconomyTransaction(r)},t.logUseItem=function(e,t,n){var i=this.scene.player.getLevel(),a={level:i,max_player_level:i,resource_type_1:e.toString(),resource_change_1:-t,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(a)},t.logGetItem=function(e,t,n){var i=this.scene.player.getLevel(),a={level:i,max_player_level:i,resource_type_1:e.toString(),resource_change_1:t,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(a)},t.logBuyAndUseInstantItem=function(e,t,n){var i=this.scene.player.getLevel(),a={level:i,max_player_level:i,resource_type_1:fl.COIN,resource_change_1:-t,resource_type_2:e.toString(),resource_change_2:1,resource_type_3:e.toString(),resource_change_3:-1,transaction_type:n.toString(),transaction_count:1};this.logEconomyTransaction(a)},t.logWatchAdAndUseInstantItem=function(e,t){var n=this.scene.player.getLevel(),i={level:n,max_player_level:n,resource_type_1:e.toString(),resource_change_1:1,transaction_type:t,transaction_count:1},a={level:n,max_player_level:n,resource_type_1:e.toString(),resource_change_1:-1,transaction_type:t,transaction_count:1};this.logEconomyTransaction(i),this.logEconomyTransaction(a)},t.logEconomyTracking=function(){var e=this.scene.player,t=e.getLevel(),n=e.getCoins(),i=e.getStar(),r=e.getBoosterAmount(Ki.SLICE),s=e.getBoosterAmount(Ki.STORM),o=e.getBoosterAmount(Ki.WILD_CARD),c=e.getPlusFive(),h=e.getUndo(),u=e.getWildCard(),l={level:t,max_player_level:t,resource_type_1:fl.COIN,resource_current_1:n,resource_type_2:fl.STAR,resource_current_2:i,resource_type_3:fl.BOOSTER_SLICE,resource_current_3:r,resource_type_4:fl.BOOSTER_STORM,resource_current_4:s,resource_type_5:fl.BOOSTER_WILD_DROP,resource_current_5:o,resource_type_6:fl.PLUS_FIVE,resource_current_6:c,resource_type_7:fl.UNDO,resource_current_7:h,resource_type_8:fl.WILD_CARD,resource_current_8:u};this.scene.analytics.event(te._.ECONOMY_TRACKING,(0,a.Z)({},l))},t.logCollectUseWildcard=function(){var e=this.scene.player.getLevel(),t={level:e,max_player_level:e,resource_type_1:fl.WILD_CARD,resource_change_1:1,resource_type_2:fl.WILD_CARD,resource_change_2:-1,transaction_type:gl.PLAY_CARD,transaction_count:1};this.logEconomyTransaction(t)},t.getTypeWithItemType=function(e){switch(e){case Ki.SLICE:return fl.BOOSTER_SLICE;case Ki.STORM:return fl.BOOSTER_STORM;case Ki.WILD_CARD:return fl.BOOSTER_WILD_DROP;case qi.PLUS_5_CARDS:case Ki.PLUS_CARD:return fl.PLUS_FIVE;case qi.UNDO:return fl.UNDO;case qi.COIN:return fl.COIN}return fl.UNKNOWN},t.logEconomyTransaction=function(e){this.scene.analytics.event(te._.ECONOMY_TRANSACTION,e)},e}(),XC=jC,qC=function(){function e(e){this.scene=void 0,this.currentMove=0,this.currentMissMove=0,this.scene=e}var t=e.prototype;return t.resetLog=function(){this.currentMove=0,this.currentMissMove=0},t.logClickOnMatchedCard=function(){this.currentMove+=1,this.scene.level.getLevel()>10||this.scene.analytics.event("player_move",{move:this.currentMove,success:!0,level:String(this.scene.level.getLevel()).padStart(3,"0")})},t.logClickOnPileUnmatchedCard=function(){this.currentMissMove+=1,this.scene.level.getLevel()>10||this.scene.analytics.event("player_move",{move:this.currentMissMove,success:!1,level:String(this.scene.level.getLevel()).padStart(3,"0")})},e}(),JC=qC,QC=Wi.Z.DEFAULT,$C=QC.KEY,eA=QC.FRAME,tA=function(e){function t(t,n){var i,a=n.key,r=n.buttonFrame,s=n.width,o=n.height;return(i=e.call(this,t,s,o)||this).coin=void 0,i.cost=void 0,i.background=void 0,i.createBackground(a,r),i.createCoin(),i.createText(),i.alignItems(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.setCost=function(e){this.cost.setText(e)},n.alignItems=function(){this.coin.setPosition(-23.2,-.7),this.cost.setPosition(14.5,-1)},n.createBackground=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.background=n},n.createCoin=function(){var e=this.scene.add.image(0,0,$C,eA.PLAY_SCREEN.BOOSTER.COIN);e.setDefaultWorldSize(),this.add(e),this.coin=e},n.createText=function(){var e=new jp(this.scene,{text:"500",fontSize:this.scene.fontSize(20.2),strokeBlur:2,strokeBlurAlpha:.2,strokeBlurColor:0,fillColor:16776958,letterSpacingExtra:.7});this.add(e),this.cost=e},t}(Kp.Z),nA=tA,iA=Wi.Z.DEFAULT,aA=iA.KEY,rA=iA.FRAME,sA={width:848/3,height:256},oA=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.xContainer=void 0,a.closeButton=void 0,a.titleText=void 0,a.boosterImage=void 0,a.countText=void 0,a.description=void 0,a.booster=void 0,a.buyButton=void 0,a.scene=t,a.setPosition(n,i),a.setSize(sA.width,sA.height),a.create(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.booster,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,a=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:a},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=100"})})),t.play()},n.setTitle=function(e){this.titleText.setText(e)},n.setBooster=function(e){this.boosterImage.setTexture(aA,e)},n.setDescription=function(e){this.description.setText(e)},n.setCost=function(e){this.buyButton.setCost(400..toString())},n.create=function(){this.createBackground(),this.createCloseButton(),this.createTitle(),this.createBooster(),this.createBoosterDescription(),this.createBuyingBoosterButton()},n.createBackground=function(){var e=new uy(this.scene,{key:aA,frame:rA.PLAY_SCREEN.POPUP_BASE,width:sA.width,height:sA.height,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createCloseButton=function(){this.xContainer=this.scene.add.container(116,-68.5),this.add(this.xContainer);var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new iv.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.xContainer.add(i),this.closeButton=i},n.createTitle=function(){this.titleText=new jp(this.scene,{fontSize:this.scene.fontSize(19),text:"Triple Cut",fillColor:10775368,letterSpacingExtra:.1});var e=this.scene.add.image(0,0,aA,rA.COMMON.TITLE_DECOR);e.setDefaultWorldSize(),this.add(this.titleText),this.add(e),this.titleText.setPosition(-1,-103),e.setPosition(-.5,-88.5)},n.createBooster=function(){var e=this.scene.add.image(0,0,aA,rA.REWARDS.SLICE);e.setWorldSize(66,256/3);var t=this.scene.add.image(0,0,aA,rA.PLAY_SCREEN.ICON_RED);t.setDefaultWorldSize();var n=new jp(this.scene,{text:"x1",fontSize:this.scene.fontSize(13),strokeColor:16776958,letterSpacingExtra:.2,strokeBlur:2.5,strokeBlurAlpha:.2,strokeBlurColor:0}),i=this.scene.add.container(0,0);i.setSize(e.width,e.height);var a=this.scene.add.container(0,0);a.setSize(t.width,t.height),a.add([t,n]),i.add([e,a]),this.add(i),this.booster=i,this.boosterImage=e,this.countText=n,n.setPosition(-.5,-1.5),a.setPosition(i.width/2-8,i.height/2-12.5),e.setPosition(0,0),this.booster.setPosition(-4,-26.5)},n.createBoosterDescription=function(){var e=new jp(this.scene,{text:"The Triple Cut booster\nremoves three open cards\nat the beginning of the level.",fontSize:this.scene.fontSize(15),fillColor:10775368,letterSpacingExtra:-.1});e.setPadding(2,2,2,2),e.setCenterAlign(),e.setPosition(1,44),this.add(e),this.description=e},n.createBuyingBoosterButton=function(){var e=Wi.Z.DASHBOARD,t=e.KEY,n=e.FRAME,i=new nA(this.scene,{key:t,buttonFrame:n.BUTTON.BUTTON.NEW_GREEN,width:436/3,height:42});i.setName("BuyBooster"),this.add(i),i.setPosition(0,96),this.buyButton=i},t}(Phaser.GameObjects.Container),cA=oA,hA=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.previousScreenKey=void 0,s.cost=void 0,s.boosterKey=void 0,s.buyingBoosterContainer=void 0,s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s))},s.buy=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.scene.gameplay.boosterManager,!((n=s.scene.player.getCoins())<s.cost)){e.next=4;break}return e.abrupt("return");case 4:return s.setButtonsDisable(!0),s.scene.player.setCoins(n-s.cost),e.next=8,t.increaseBoosterAmount(s.boosterKey,1);case 8:i=s.scene.player.getBoosterAmount(s.boosterKey),a=s.getBoosterButtonData(i),s.scene.screen.open(s.previousScreenKey,a),s.scene.screen.close(s.name),s.scene.logEconomy.logBuyBooster(s.boosterKey,s.cost,1);case 13:case"end":return e.stop()}}),e)}))),s.scene=t,s.previousScreenKey="",s.create(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this,t=new cA(this.scene,0,-17);this.add(t),t.buyButton.onClick=this.buy,t.closeButton.onClick=function(){e.scene.screen.open(e.previousScreenKey,{}),e.scene.screen.close(e.name)},this.buyingBoosterContainer=t},n.open=function(t){e.prototype.open.call(this,t),this.setButtonsDisable(!1),this.updateData(),this.runEntranceAnimation(),this.buyingBoosterContainer.runEntranceAnimation(),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY)},n.setButtonsDisable=function(e){var t=this.buyingBoosterContainer,n=t.buyButton,i=t.closeButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.updateData=function(){var e,t=this.buyingBoosterContainer,n=null==(e=this.data)?void 0:e.list,i=n.title,a=void 0===i?"":i,r=n.boosterFrame,s=void 0===r?"":r,o=n.description,c=void 0===o?"":o,h=n.cost,u=void 0===h?0:h,l=n.key,d=void 0===l?Ki.NONE:l,p=n.previousScreenKey;this.previousScreenKey=p,this.cost=u,this.boosterKey=d;var f=this.scene.lang.getText(a),m=this.scene.lang.getText(c);t.setTitle(f),t.setBooster(s),t.setDescription(m),t.setCost(u),this.scene.player.getCoins()<u&&(t.buyButton.setDisabled(!0),t.buyButton.setAlpha(.5))},n.close=function(){this.setButtonsDisable(!0),this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.buyingBoosterContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.buyingBoosterContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.getBoosterButtonData=function(e){var t={};switch(this.boosterKey){case Ki.SLICE:return t={slice:{selected:!0,amount:e}};case Ki.STORM:return t={storm:{selected:!0,amount:e}};case Ki.WILD_CARD:return t={wildCard:{selected:!0,amount:e}}}return t},t}(GameCore.Screen),uA=hA,lA=109/3,dA=110/3,pA=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).setSize(lA,dA),i.button.kill(),i.icon.setWorldSize(lA,dA),i.scene.add.existing((0,fc.Z)(i)),i}return(0,s.Z)(t,e),t.prototype.updateSize=function(){this.button.setWorldSize(lA,dA),e.prototype.updateSize.call(this)},t}(zg),fA=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).button=void 0,i.label=void 0,i.setSize(lA,dA),i.create(n),i.scene.add.existing((0,fc.Z)(i)),i}return(0,s.Z)(t,e),t.prototype.create=function(e){var t=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(11),text:"",origin:{x:.5,y:.5}});t.setTint(12870461);var n=new pA(this.scene,{enable:e.enable,frameOn:e.frameOn,frameOff:e.frameOff,backgroundOn:e.backgroundOn,backgroundOff:e.backgroundOff});this.add([n,t]),t.setY(28),this.button=n,this.label=t},t}(Phaser.GameObjects.Container),mA=fA,gA=Wi.Z.DEFAULT,vA=gA.KEY,yA=gA.FRAME,EA=770/3,CA=550/3,AA=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).soundSwitchUI=void 0,a.musicSwitchUI=void 0,a.vibrationSwitchUI=void 0,a.endGameButton=void 0,a.closeButton=void 0,a.fanpageBtn=void 0,a.inviteFriendsBtn=void 0,a.title=void 0,a.setPosition(n,i),a.setSize(EA,CA),a.createContent(),a.createCloseButton(),t.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle(),this.createToggleButtons()},n.createTitle=function(){var e=new jp(this.scene,{text:this.scene.lang.Text.settings,fontSize:this.scene.fontSize(18),letterSpacingExtra:.6,fillColor:10775368});e.setPadding(2,2,2,2);var t=this.scene.add.image(0,0,vA,yA.COMMON.TITLE_DECOR);t.setDefaultWorldSize(),this.add([e,t]),Phaser.Display.Align.In.TopCenter(e,this,-1,-12),Phaser.Display.Align.In.TopCenter(t,this,-.5,-34)},n.createToggleButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.createSoundButton(n),c=this.createMusicButton(a),h=this.createVibrationButton(s);this.add([o,c,h]),Phaser.Display.Align.In.Center(c,this,-51,10),Phaser.Display.Align.In.Center(o,this,0,10),Phaser.Display.Align.In.Center(h,this,53,10),av()||(h.kill(),Phaser.Display.Align.In.Center(c,this,-24.2,10),Phaser.Display.Align.In.Center(o,this,24.2,10))},n.createSoundButton=function(e){var t=new mA(this.scene,{enable:e,frameOn:yA.SETTINGS.SOUND_ON,frameOff:yA.SETTINGS.SOUND_OFF,backgroundOn:yA.SETTINGS.SOUND_ON,backgroundOff:yA.SETTINGS.SOUND_OFF});return t.button.setName("SoundSwitch"),t.button.updateStatus(e),this.soundSwitchUI=t,t},n.createMusicButton=function(e){var t=new mA(this.scene,{enable:e,frameOn:yA.SETTINGS.MUSIC_ON,frameOff:yA.SETTINGS.MUSIC_OFF,backgroundOn:yA.SETTINGS.MUSIC_ON,backgroundOff:yA.SETTINGS.MUSIC_OFF});return t.button.setName("MusicSwitch"),t.button.updateStatus(e),this.musicSwitchUI=t,t},n.createVibrationButton=function(e){var t=new mA(this.scene,{enable:e,frameOn:yA.SETTINGS.VIBRATE_ON,frameOff:yA.SETTINGS.VIBRATE_OFF,backgroundOn:yA.SETTINGS.VIBRATE_ON,backgroundOff:yA.SETTINGS.VIBRATE_OFF});return t.button.setName("VibrationSwitch"),t.button.updateStatus(e),this.vibrationSwitchUI=t,t},n.createCloseButton=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new iv.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.add(i),Phaser.Display.Align.In.TopRight(i,this,-19.5,-50.5),this.closeButton=i},t}(Phaser.GameObjects.Container),wA=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.settingsContainer=void 0,r.handleCloseScreen=function(){r.scene.screen.close(r.name)},r.handleSoundChange=function(e){r.scene.player.setSetting("sound",e)},r.handleMusicChanged=function(e){r.scene.player.setSetting("music",e),e?r.scene.resumeMusic():r.scene.audio.pauseAllMusics()},r.handleVibrationChanged=function(e){r.scene.player.setSetting("vibrate",e),e&&r.scene.vibration.performVibrating(50)},r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.setDepth(ce.Ks.POPUP),r.create(),r.background.setInteractive({useHandCursor:!0}),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.settingsContainer=new AA(this.scene,0,1),this.settingsContainer.setInteractive(),this.add(this.settingsContainer);var e=this.settingsContainer,t=e.soundSwitchUI,n=e.musicSwitchUI,i=e.vibrationSwitchUI,a=e.closeButton;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),a.onClick=this.handleCloseScreen},n.open=function(){e.prototype.open.call(this),this.updateData(),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation(),this.background.off(Phaser.Input.Events.POINTER_DOWN)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.settingsContainer,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.updateStatus(n),h.button.updateStatus(a),u&&u.button.updateStatus(s)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.settingsContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.settingsContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen);var SA=function(e){function t(t,n){var i,a=n.text,r=n.width,s=n.height,o=n.key,c=n.frame;return(i=e.call(this,t,r,s)||this).text=void 0,i.background=void 0,i.createBackground(o,c),i.createText(a),i.add([i.background,i.text]),Phaser.Display.Align.In.Center(i.text,(0,fc.Z)(i),0,-1),i}(0,s.Z)(t,e);var n=t.prototype;return n.createBackground=function(e,t){this.background=this.scene.make.nineslice({key:e,frame:t,width:this.width,height:this.height,leftWidth:101/3,rightWidth:101/3})},n.createText=function(e){this.text=new jp(this.scene,{text:e,fontSize:this.scene.fontSize(16.3),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,fillColor:16776958,letterSpacingExtra:.3})},t}(Kp.Z),bA=SA,TA=Wi.Z.DEFAULT,xA=TA.KEY,PA=TA.FRAME,kA=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.xIcon=void 0,a.valueText=void 0,a.scene=t,a.createIcon(n,i),a.createXIcon(),a.createValueText(),a.alignItems(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.setValue=function(e){isNaN(e)||e<0||(this.valueText.setText(e.toString()),this.setVisible(e>0))},n.showXIconAnimation=function(e){void 0===e&&(e=250),this.xIcon.setAlpha(0),this.xIcon.setAngle(-90),this.xIcon.setScale(0),this.scene.tweens.add({targets:this.xIcon,alpha:1,angle:{from:-90,to:0},duration:300,delay:e,ease:Phaser.Math.Easing.Cubic.Out}),this.scene.tweens.add({targets:this.xIcon,scale:{from:0,to:1/3},duration:300,delay:e,ease:Phaser.Math.Easing.Back.Out,easeParams:[3]})},n.hide=function(){this.setVisible(!1)},n.show=function(){this.setVisible(!0)},n.setLossIconVisible=function(e){this.setVisible(e),e?this.showXIconAnimation():this.hide()},n.alignItems=function(){Phaser.Display.Align.In.BottomRight(this.xIcon,this),Phaser.Display.Align.In.BottomCenter(this.valueText,this,0,19)},n.createIcon=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.setSize(n.width,45)},n.createXIcon=function(){var e=this.scene.add.image(0,0,xA,PA.EXIT_GAME_SCREEN.BUTTON_CLOSE);e.setDefaultWorldSize(),this.add(e),this.xIcon=e},n.createValueText=function(){var e=new jp(this.scene,{fontSize:this.scene.fontSize(15),text:"21",fillColor:10775368});e.setCenterAlign(),this.add(e),this.valueText=e},t}(Phaser.GameObjects.Container),IA=kA,OA=Wi.Z.DEFAULT,RA=OA.KEY,BA=OA.FRAME,DA={width:949/3,height:230},LA={width:DA.width-50,height:74},_A={WIDTH:107,HEIGHT:42},MA=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.titleText=void 0,a.content=void 0,a.message=void 0,a.playOnButton=void 0,a.endGameButton=void 0,a.gloveIcon=void 0,a.cupIcon=void 0,a.boatIcon=void 0,a.titleDecor=void 0,a.scene=t,a.setSize(DA.width,DA.height),a.create(),a.setPosition(n,i),a.alignItems(),a.setInteractive(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.message,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,a=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:a},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.updateTitle=function(e){this.titleText.setText(e)},n.updateMessage=function(e){this.message.setText(e)},n.updateEventItems=function(e){var t=e.boxingDuel,n=e.weeklyTournament,i=e.offshoreRace;this.gloveIcon.setValue(t),this.cupIcon.setValue(n),this.boatIcon.setValue(i);var a=[t,n,i].some((function(e){return e>0}));this.gloveIcon.setLossIconVisible(t>0),this.cupIcon.setLossIconVisible(n>0),this.boatIcon.setLossIconVisible(i>0);var r=a?0:40;this.content.setSizeByWorld(LA.width,LA.height+r),this.alignItems()},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,-1.3,-32),Phaser.Display.Align.To.BottomCenter(this.titleDecor,this.titleText,1.3,0),this.content.setPosition(0,-this.height/2+this.content.displayHeight/2+52),Phaser.Display.Align.In.BottomCenter(this.endGameButton,this,-55,8),Phaser.Display.Align.In.BottomCenter(this.playOnButton,this,56,8);var e=[this.gloveIcon,this.cupIcon,this.boatIcon].filter((function(e){return e.visible}));if(e.length>0){Phaser.Display.Align.In.TopCenter(this.message,this,-1,-148);var t=80*(e.length-1);e.forEach((function(e,n){e.setPosition(-t/2+80*n,-35)}))}else this.message.setY(this.content.y)},n.create=function(){this.createBackground(),this.createContentBackground(),this.createTitleText(),this.createTitleDecor(),this.createMessage(),this.createIcons(),this.createPlayOnButton(),this.createEndGameButton()},n.createBackground=function(){var e=new uy(this.scene,{key:RA,frame:BA.EXIT_GAME_SCREEN.POP_UP_BASE,width:DA.width,height:DA.height,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createContentBackground=function(){var e=this.scene.make.nineslice({key:RA,frame:BA.COMMON.POPUP_CONTENT_FULL,leftWidth:30,rightWidth:30,topHeight:65/3,bottomHeight:65/3,width:LA.width,height:LA.height});this.add(e),this.content=e},n.createTitleText=function(){this.titleText=new jp(this.scene,{fontSize:this.scene.fontSize(18.46),text:this.scene.lang.Text.exitGame,fillColor:10775368,letterSpacingExtra:.6}),this.add([this.titleText])},n.createTitleDecor=function(){var e=this.scene.add.image(0,0,RA,BA.COMMON.TITLE_DECOR);e.setDefaultWorldSize(),this.add(e),this.titleDecor=e},n.createMessage=function(){var e=new jp(this.scene,{text:this.scene.lang.Text.quitLevel,fontSize:this.scene.fontSize(14.9),fillColor:10775368,letterSpacingExtra:.04});e.setPadding(2,2,2,2),e.setCenterAlign(),this.add(e),this.message=e},n.createIcons=function(){this.gloveIcon=new IA(this.scene,RA,BA.EXIT_GAME_SCREEN.ICON_GLOVE),this.cupIcon=new IA(this.scene,RA,BA.EXIT_GAME_SCREEN.ICON_CUP),this.boatIcon=new IA(this.scene,RA,BA.EXIT_GAME_SCREEN.ICON_BOAT),this.add(this.gloveIcon),this.add(this.cupIcon),this.add(this.boatIcon)},n.createPlayOnButton=function(){var e=new bA(this.scene,{text:"Play On",key:Wi.Z.DASHBOARD.KEY,frame:Wi.Z.DASHBOARD.FRAME.BUTTON.BUTTON.GREEN_3,width:_A.WIDTH,height:_A.HEIGHT});this.add(e),e.setPosition(100,93),this.playOnButton=e},n.createEndGameButton=function(){var e=new bA(this.scene,{text:"End Game",key:Wi.Z.DASHBOARD.KEY,frame:Wi.Z.DASHBOARD.FRAME.BUTTON.BUTTON.RED,width:_A.WIDTH,height:_A.HEIGHT});this.add(e),e.setPosition(100,93),this.endGameButton=e},t}(Phaser.GameObjects.Container),NA=MA,GA=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.exitGameContainer=void 0,r.scene=t,r.create(),r.background.setInteractive({useHandCursor:!0}),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.listenEvents(),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this,t=this.exitGameContainer,n=t.endGameButton,i=t.playOnButton;n.onClick=function(){var t,n=null==(t=e.data)?void 0:t.list;n&&(e.scene.gameUI.hideUI(),n.exitCallback())},i.onClick=function(){var t,n=null==(t=e.data)?void 0:t.list;n&&n.playOnCallback()}},n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.scene.gameUI,r=t.eventItems,s=void 0===r?{boxingDuel:0,weeklyTournament:0,offshoreRace:0}:r;this.scene.children.sendToBack(i.coinBarButton),this.exitGameContainer.updateEventItems(s),function(e){var t=e.screen,n=e.mainContainer,i=e.onComplete,r=t.scene;r.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),r.tweens.timeline({tweens:[(0,a.Z)({targets:[n]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[t]},Cv.tweenConfigs.screen.configOpen)],onComplete:i})}({screen:this,mainContainer:this.exitGameContainer,onComplete:function(){n.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){var e,t=null==(e=n.data)?void 0:e.list;t&&t.playOnCallback()}))}}),this.exitGameContainer.runEntranceAnimation()},n.close=function(){var t=this;!function(e){var t=e.screen,n=e.mainContainer,i=e.onComplete,r=t.scene;r.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),r.tweens.timeline({tweens:[(0,a.Z)({targets:[n]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[t]},Cv.tweenConfigs.screen.configClose)],onComplete:i})}({screen:this,mainContainer:this.exitGameContainer,onComplete:function(){e.prototype.close.call(t)}}),this.background.off(Phaser.Input.Events.POINTER_DOWN)},n.create=function(){this.exitGameContainer=new NA(this.scene,0,-18),this.add(this.exitGameContainer)},t}(GameCore.Screen),ZA=Wi.Z.DEFAULT,FA=ZA.KEY,UA=ZA.FRAME,WA={width:326,height:823/3},HA=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.levelDecoration=void 0,n.xContainer=void 0,n.description=void 0,n.closeButton=void 0,n.getNowButton=void 0,n.illustration=void 0,n.background=void 0,n.scene=t,n.setSize(WA.width,WA.height),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateClaimedCoinText=function(e){this.description.setText("Watch a video to get "+e+" coins")},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-14),Phaser.Display.Align.In.TopCenter(this.levelDecoration,this,0,-35),Phaser.Display.Align.In.TopRight(this.xContainer,this,-19.5,-52.5),Phaser.Display.Align.In.TopCenter(this.illustration,this,0,-45.5),Phaser.Display.Align.In.Center(this.description,this,0,68),Phaser.Display.Align.In.BottomCenter(this.getNowButton,this,0,-11.5)},n.create=function(){this.createBackground(),this.createIllustration(),this.createCloseButton(),this.createTitleText(),this.createDescription(),this.createGetNowButton()},n.createBackground=function(){var e=new uy(this.scene,{key:FA,frame:UA.COMMON.NEW_POPUP_BASE,width:WA.width,height:WA.height,topHeight:200/3,bottomHeight:200/3});this.add(e),this.background=e},n.createIllustration=function(){var e=this.scene.add.image(0,0,FA,UA.GET_MORE_COIN_SCREEN.ILLUSTRATION);e.setDefaultWorldSize(),this.add(e),this.illustration=e},n.createCloseButton=function(){this.xContainer=this.scene.add.container(0,0),this.add(this.xContainer);var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new iv.Z(this.scene,{key:t,frame:n.COMMON.BTN_CLOSE,width:40/3,height:14,paddingZone:30});i.setName("Close"),this.xContainer.setSize(40/3,14),this.xContainer.add(i),this.closeButton=i},n.createTitleText=function(){this.titleText=new jp(this.scene,{text:this.scene.lang.Text.earnExtraCoins,fontSize:this.scene.fontSize(18),fillColor:11167815}),this.titleText.setCenterAlign(),this.add(this.titleText),this.levelDecoration=this.scene.add.image(0,1,FA,UA.COMMON.TITLE_DECOR),this.levelDecoration.setDefaultWorldSize(),this.add(this.levelDecoration)},n.createDescription=function(){var e=new jp(this.scene,{text:"Watch a video to get 300 coins",fontSize:this.scene.fontSize(15),fillColor:11167815});e.setCenterAlign(),this.add(e),this.description=e},n.createGetNowButton=function(){var e=new iy(this.scene,{key:Wi.Z.DASHBOARD.KEY,buttonFrame:Wi.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_GREEN,buttonWidth:436/3,buttonHeight:42,buttonInnerWidth:436/3});this.add(e),e.setPosition(100,93),this.getNowButton=e,this.getNowButton.button.setName("GetNow");var t=this.scene.add.image(0,0,FA,UA.GET_MORE_COIN_SCREEN.NEW_ICON_AD);t.setDefaultWorldSize(),t.setPosition(-38,-1),this.getNowButton.addIntoButton(t);var n=new jp(this.scene,{text:this.scene.lang.Text.getNow,fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(17,-1),this.getNowButton.addIntoButton(n)},t}(Phaser.GameObjects.Container),YA=HA,KA=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.getCoinsContainer=void 0,s.previousScreen=void 0,s.claimedCoin=void 0,s.isOpening=void 0,s.handleClose=function(){s.scene.screen.close(s.name)},s.handleGetNow=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.scene.showRewardedVideoAsync();case 2:if(!e.sent){e.next=14;break}if(s.scene.tweens.add({targets:s.getCoinsContainer,alpha:0,scale:.5,duration:300,ease:Phaser.Math.Easing.Back.Out}),t=s.scene.gameUI.isCoinShowing()){e.next=10;break}return s.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),e.next=10,s.scene.gameUI.showCoin();case 10:n=s.getCoinsContainer.illustration.getWorldPosition(),i=n.x,a=n.y,s.scene.rewardManager.rewardCoin(s.claimedCoin),s.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,i,a).then((function(){s.scene.screen.close(s.name),t||(0,dl.Z)(s.scene,1e3).then((function(){s.scene.gameUI.hideCoin()}))})),s.scene.logEconomy.logGetItem(fl.COIN,s.claimedCoin,gl.GET_MORE_COIN_AD);case 14:case"end":return e.stop()}}),e)}))),s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.isOpening=!1,s.getCoinsContainer.setAlpha(1),s.getCoinsContainer.setScale(1),s.previousScreen&&s.scene.screen.open(s.previousScreen)},s.scene=t,s.create(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),s.listenEvents(),s.isOpening=!1,yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.getCoinsContainer,t=e.closeButton,n=e.getNowButton;t.onClick=this.handleClose,n.onClick=this.handleGetNow},n.create=function(){var e=new YA(this.scene);this.add(e),this.getCoinsContainer=e},n.open=function(t){this.isOpening||(this.scene.events.emit(hi.HIDE_GUIDE),this.isOpening=!0,e.prototype.open.call(this,t),this.previousScreen=null==t?void 0:t.previousScreen,this.updateData(),this.setButtonsDisable(!1),this.runEntranceAnimation())},n.updateData=function(){var e,t=(null!=(e=this.data.list)?e:{}).claimedCoin,n=void 0===t?300:t;this.claimedCoin=n,this.getCoinsContainer.updateClaimedCoinText(n)},n.setButtonsDisable=function(e){var t=this.getCoinsContainer,n=t.closeButton,i=t.getNowButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.close=function(){this.background.off(Phaser.Input.Events.POINTER_DOWN),this.setButtonsDisable(!0),this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.getCoinsContainer]},Cv.tweenConfigs.popup.configOpen,{duration:600}),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.getCoinsContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),zA=KA,VA=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.guideContainer=void 0,r.testImage=void 0,r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.setDepth(ce.Ks.POPUP),r.create(),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new fm(this.scene,0,0);this.add(e),Phaser.Display.Align.In.Center(e,this,0,40),this.guideContainer=e},n.open=function(t){e.prototype.open.call(this,t),this.updateData(t),this.runEntranceAnimation()},n.updateData=function(e){var t=Wi.Z.GAMEPLAY_DEFAULT,n=t.KEY,i=t.FRAME,a=e,r=a.x,s=void 0===r?0:r,o=a.y,c=void 0===o?0:o,h=a.background,u=h.scaleX,l=void 0===u?1:u,d=h.scaleY,p=void 0===d?1:d,f=a.textBox,m=f.x,g=void 0===m?0:m,v=f.y,y=void 0===v?0:v,E=f.text,C=void 0===E?"":E,A=f.textAlignType,w=void 0===A?au.CENTER:A,S=a.icon,b=S.x,T=void 0===b?0:b,x=S.y,P=void 0===x?0:x,k=S.key,I=void 0===k?n:k,O=S.frame,R=void 0===O?i.TUTORIAL.ARROW_DOWN:O,B=S.visible,D=void 0===B||B,L=a.backgroundInteractive;void 0===L||L?this.background.setInteractive({useHandCursor:!0}):this.background.disableInteractive();var _=this.guideContainer,M=_.shadow,N=_.bg,G=_.text,Z=_.icon;M.setVisible(!0),N.setVisible(!1),this.guideContainer.setText(C,w),this.guideContainer.setPosition(s,c),this.guideContainer.updateIcon(I,R,D),M.setScaleByWorld(l,p),M.setPosition(g,y+5),G.setPosition(g,y),N.setPosition(g,y),Z.setPosition(T,P)},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),jA=VA,XA=Wi.Z.DASHBOARD,qA=XA.KEY,JA=XA.FRAME,QA=290,$A=190,ew={width:QA-38,height:80},tw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.content=void 0,n.message=void 0,n.playOnButton=void 0,n.endGameButton=void 0,n.titleDecor=void 0,n.scene=t,n.setSize(QA,$A),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.message,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,a=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:a},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-14),Phaser.Display.Align.In.TopCenter(this.titleDecor,this.titleText,0,-22),this.content.setPosition(0,-this.height/2+this.content.displayHeight/2+50),this.message.setY(this.content.y),Phaser.Display.Align.In.BottomCenter(this.endGameButton,this,0,-7)},n.create=function(){this.createBackground(),this.createContentBackground(),this.createTitleText(),this.createMessage(),this.createEndGameButton()},n.createBackground=function(){var e=new uy(this.scene,{key:Wi.Z.DEFAULT.KEY,frame:Wi.Z.DEFAULT.FRAME.COMMON.NEW_POPUP_BASE,width:QA,height:$A,topHeight:200/3,bottomHeight:200/3});this.add(e)},n.createContentBackground=function(){var e=this.scene.make.nineslice({key:Wi.Z.DEFAULT.KEY,frame:Wi.Z.DEFAULT.FRAME.COMMON.POPUP_CONTENT_FULL,leftWidth:65/3,rightWidth:30,topHeight:85/3,bottomHeight:65/3,width:ew.width,height:ew.height});this.add(e),this.content=e},n.createTitleText=function(){this.titleText=new jp(this.scene,{text:this.scene.lang.Text.bombDetonated,fontSize:this.scene.fontSize(16),fillColor:10775368}),this.titleText.setCenterAlign(),this.titleText.setPadding(2,2,2,2),this.titleDecor=this.scene.add.image(0,0,Wi.Z.DEFAULT.KEY,Wi.Z.DEFAULT.FRAME.COMMON.TITLE_DECOR),this.titleDecor.setDefaultWorldSize(),this.add(this.titleText),this.add(this.titleDecor)},n.createMessage=function(){var e=new jp(this.scene,{text:this.scene.lang.Text.tipPlayBomb,fontSize:this.scene.fontSize(17),fillColor:10775368});e.setCenterAlign(),this.add(e),this.message=e},n.createEndGameButton=function(){var e=this,t=new bA(this.scene,{text:this.scene.lang.Text.endGame,key:qA,frame:JA.BUTTON.BUTTON.RED,width:388/3,height:145/3});this.add(t),t.setPosition(100,93),this.endGameButton=t,t.onClick=function(){e.scene.gameplay.boardGame.stateMachine.emit(Jh.LOSE),e.scene.screen.close(ce.o4.NOTIFY_BOMB_SCREEN)}},t}(Phaser.GameObjects.Container),nw=tw,iw=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.notifyBombContainer=void 0,r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.notifyBombContainer=new nw(this.scene),this.add(this.notifyBombContainer)},n.open=function(t){e.prototype.open.call(this,t),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.END_GAME),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.notifyBombContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.notifyBombContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),aw=iw,rw=Wi.Z.DEFAULT,sw=rw.KEY,ow=rw.FRAME,cw=270,hw=266,uw={width:cw+21,height:hw+20},lw=270,dw=46,pw=270,fw=220,mw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.heartContainer=void 0,n.buyHeartButton=void 0,n.closeButton=void 0,n.content=void 0,n.addHeart=function(){var e=n.scene.player.getCoins(),t=Hi.PLUS_A_HEART;n.scene.player.setCoins(e-t),n.scene.tweens.add({targets:(0,fc.Z)(n),alpha:0,scale:0,duration:400,ease:Phaser.Math.Easing.Sine.In}),n.scene.screen.close(ce.o4.OUT_OF_HEARTS_SCREEN),n.scene.rewardManager.rewardHeart(1)},n.scene=t,n.setSize(cw,hw),n.create(),n.createBuyHeartButton(),n.createCloseButton(),n}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createShadow(),this.createHeader(),this.createContent()},n.createShadow=function(){var e=this.scene.make.nineslice({key:sw,frame:ow.NINE_SLICE.POPUP_SHADOW,leftWidth:36,rightWidth:36,topHeight:24,bottomHeight:42,width:uw.width,height:uw.height});e.setY(10),this.add(e)},n.createHeader=function(){var e=this.scene.add.container();e.setSize(lw,dw);var t=this.scene.make.nineslice({key:sw,frame:ow.THREE_SLICE.HEADER,leftWidth:23,rightWidth:23,topHeight:22,bottomHeight:0,width:lw,height:dw}),n=new hv(this.scene);n.setText("Get More Lives!"),n.setColor(7162732),n.setFontSize(20),e.add([t,n]),this.add(e),Phaser.Display.Align.In.TopCenter(e,this)},n.createContent=function(){this.content=this.scene.add.container(),this.content.setSize(pw,fw),this.createBackground(),this.createIcons(),this.add(this.content),Phaser.Display.Align.In.BottomCenter(this.content,this)},n.createBackground=function(){var e=this.scene.add.container();e.setSize(pw,fw);var t=this.scene.make.nineslice({key:sw,frame:ow.NINE_SLICE.POPUP_BG,leftWidth:23,rightWidth:23,topHeight:0,bottomHeight:22,width:pw,height:fw}),n=this.scene.make.nineslice({key:sw,frame:ow.NINE_SLICE.POPUP_CONTENT,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,width:pw-20,height:140});e.add([t,n]),n.setY(-29),this.content.add(e)},n.runEntranceAnimation=function(){var e=[this.buyHeartButton,this.heartContainer],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){e.setScale(0),t.add({targets:[e],scale:{from:0,to:1},duration:300,ease:Phaser.Math.Easing.Back.Out,delay:0==n?250:0,offset:0==n?0:"-=200"})})),t.play()},n.createIcons=function(){var e=Wi.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.container(0,0),a=this.scene.add.image(0,0,t,n.IC_HEART);a.setScaleByWorld(2),i.setSize(a.width,a.height);var r=this.scene.make.bitmapText({font:Pc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(20),origin:{x:.5,y:.5},text:"+1"});i.add([a,r]),this.content.add(i),Phaser.Display.Align.In.Center(r,i,-2,-1),Phaser.Display.Align.In.Center(i,this.content,0,-32),this.heartContainer=i},n.createCloseButton=function(){var e=this,t=Wi.Z.DEFAULT,n=t.KEY,i=t.FRAME,a=new iv.Z(this.scene,{key:n,frame:i.COMMON.BTN_CLOSE,width:15,height:14.5,paddingZone:30});a.setName("Close"),a.onClick=function(){e.setButtonsDisable(!0),e.scene.screen.close(ce.o4.OUT_OF_HEARTS_SCREEN)},this.add(a),this.closeButton=a,Phaser.Display.Align.In.TopRight(a,this,-12,-12)},n.createBuyHeartButton=function(){var e=this,t=new nv(this.scene,sw,ow.BUTTON.GREEN_60,122.5,47.5);t.setName("BuyHeart");var n=this.scene.make.bitmapText({font:Pc.ZP.WHITE_SHADOW.KEY,size:this.scene.fontSize(25),text:Hi.PLUS_A_HEART.toString(),origin:{x:.5,y:.5}}),i=this.scene.add.image(0,0,Wi.Z.DEFAULT.KEY,Wi.Z.DEFAULT.FRAME.COMMON.IC_BIG_COIN);i.setDefaultWorldSize(),t.add([n,i]),t.onClick=function(){e.scene.player.getCoins()>=Hi.PLUS_A_HEART&&(e.setButtonsDisable(!0),e.addHeart())},this.add(t),Phaser.Display.Align.In.Center(i,t,-25),Phaser.Display.Align.In.Center(n,t,15,-1),Phaser.Display.Align.In.BottomCenter(t,this,0,-8),this.buyHeartButton=t},n.setButtonsDisable=function(e){this.buyHeartButton.setDisabled(e),this.closeButton.setDisabled(e),this.buyHeartButton.setAlpha(1),this.closeButton.setAlpha(1)},t}(Phaser.GameObjects.Container),gw=mw,vw=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.outOfHeartsContainer=void 0,r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r)),r.scene.life.getHearts()<r.scene.life.getMaxHearts()&&r.scene.gameUI.lifeBarButton.setDisabled(!1)},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.outOfHeartsContainer=new gw(this.scene),this.add(this.outOfHeartsContainer)},n.open=function(t){e.prototype.open.call(this,t),this.scene.gameUI.lifeBarButton.setDisabled(!0),this.outOfHeartsContainer.setButtonsDisable(!1),this.outOfHeartsContainer.setAlpha(1),this.runEntranceAnimation(),this.outOfHeartsContainer.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.outOfHeartsContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.outOfHeartsContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),yw=vw;function Ew(e){for(var t=e.length-1;t>0;t--){var n=e[t],i=e[t-1];if(n.v!=i.v||"stepped"!==i.curve&&"linear"!==i.curve)break;e.pop()}return e}function Cw(e,t,n,i,a,r){return{curve:i==n?0:(e[4*t+0]-n)/(i-n)||0,c2:r==a?0:(e[4*t+1]-a)/(r-a)||0,c3:i==n?0:(e[4*t+2]-n)/(i-n)||1,c4:r==a?0:(e[4*t+3]-a)/(r-a)||1}}var Aw=function(e){var t=e.target;return(0,a.Z)({},function(e,t){void 0===t&&(t=[]);function n(e){e=e.replace(/^#/,"");var t=parseInt(e,16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:255&t}}for(var i=e.tint||16777215,r=Phaser.Display.Color.ColorToRGBA(i),s=r.r,o=r.g,c=r.b,h=(r.a,e.alpha),u=[],l=[],d=[],p=[],f=0;f<t.length;f++){var m=t[f],g=h,v=s,y=o,E=c;if(m.color){var C=n(m.color);g=C.a/255,v=C.r,y=C.g,E=C.b}var A={curve:"linear",c2:0,c3:1,c4:1},w={curve:"linear",c2:0,c3:1,c4:1},S={curve:"linear",c2:0,c3:1,c4:1},b={curve:"linear",c2:0,c3:1,c4:1};if(m.curve instanceof Array){t.length;var T=t[f+1],x=h,P=s,k=o,I=c;if(T.color){var O=n(T.color);x=O.a/255,P=O.r,k=O.g,I=O.b}var R=m.time||0,B=T.time||1,D=v,L=P,_=y,M=k,N=E,G=I,Z=g,F=x;A=Cw(m.curve,0,R,B,D,L),w=Cw(m.curve,1,R,B,_,M),S=Cw(m.curve,2,R,B,N,G),b=Cw(m.curve,3,R,B,Z,F)}else w=A=(0,a.Z)({},A,m,{curve:void 0===m.curve?A.curve:m.curve}),S=A,b=A;p.push((0,a.Z)({time:0,v:g},m,b)),u.push((0,a.Z)({time:0,v:v},m,A)),l.push((0,a.Z)({time:0,v:y},m,w)),d.push((0,a.Z)({time:0,v:E},m,S))}Ew(p);var U=e.setTint;return U&&"function"===typeof U?{tintR:u,tintG:l,tintB:d,alpha:p}:{tintR:[],tintB:[],tintG:[],alpha:p}}(t,e.color||e.rgba),function(e,t){void 0===t&&(t=[]);for(var n=e.scaleX,i=e.scaleY,r=[],s=[],o=0;o<t.length;o++){var c=t[o],h={curve:"linear",c2:0,c3:1,c4:1},u={curve:"linear",c2:0,c3:1,c4:1};if(c.curve instanceof Array){t.length;var l=t[o+1],d=c.time||0,p=l.time||1,f=c.x||0,m=l.x||0,g=c.y||0,v=l.y||0;h=Cw(c.curve,0,d,p,f,m),u=Cw(c.curve,1,d,p,g,v)}else u=h=(0,a.Z)({},h,c,{curve:void 0===c.curve?h.curve:c.curve});r.push((0,a.Z)({time:0,v:void 0==c.x?n:c.x*n},c,h)),s.push((0,a.Z)({time:0,v:void 0==c.y?i:c.y*i},c,u))}return Ew(r),Ew(s),{scaleX:r,scaleY:s}}(t,e.scale),function(e,t,n){void 0===t&&(t=[]);for(var i=e.x,r=e.y,s=[],o=[],c=(null==n?void 0:n.translate)||"default",h=Hw.WORLD_SCALE,u=0;u<t.length;u++){var l=t[u],d={curve:"linear",c2:0,c3:1,c4:1},p={curve:"linear",c2:0,c3:1,c4:1};if(l.curve instanceof Array){t.length;var f=t[u+1],m=l.time||0,g=f.time||1,v=l.x||0,y=f.x||0,E=l.y||0,C=f.y||0;d=Cw(l.curve,0,m,g,v,y),p=Cw(l.curve,1,m,g,E,C)}else p=d=(0,a.Z)({},d,l,{curve:void 0===l.curve?d.curve:l.curve});switch(c){case"default":s.push((0,a.Z)({time:0,v:void 0==l.x?i:l.x*h+i},l,d)),o.push((0,a.Z)({time:0,v:void 0==l.y?r:-l.y*h+r},l,p));break;case"correctPosition":s.push((0,a.Z)({time:0,v:void 0==l.x?i:l.x},l,d)),o.push((0,a.Z)({time:0,v:void 0==l.y?r:l.y},l,p))}}return Ew(s),Ew(o),{x:s,y:o}}(t,e.translate,e.mode),function(e,t){void 0===t&&(t=[]);for(var n=e.angle,i=[],r=0;r<t.length;r++){var s=t[r],o={curve:"linear",c2:0,c3:1,c4:1};if(s.curve instanceof Array){t.length;var c=t[r+1],h=s.time||0,u=c.time||1,l=s.angle||s.value||0,d=c.angle||c.value||0;o=Cw(s.curve,0,h,u,l,d)}else o=(0,a.Z)({},o,s,{curve:void 0===s.curve?o.curve:s.curve});i.push((0,a.Z)({time:0,v:void 0==s.angle?void 0==s.value?n:-s.value:-s.angle},s,o))}return Ew(i),{angle:i}}(t,e.rotate),function(e,t){void 0===t&&(t=[]);e.angle;var n=[],i=e.spineConfig;if(void 0===i)return{deform:[]};for(var r=i.vertices,s=function(){var e=t[o],i=e.vertices,s=e.offset||0,c={curve:"linear",c2:0,c3:1,c4:1};if(e.curve instanceof Array){t.length;var h=t[o+1],u=e.time||0,l=h.time||1,d=0,p=1;c=Cw(e.curve,0,u,l,d,p)}else c=(0,a.Z)({},c,e,{curve:void 0===e.curve?c.curve:e.curve});n.push((0,a.Z)({time:0,v:void 0==i?r:r.map((function(e,t){return t<s?e:e+(i[t-s]||0)}))},e,c))},o=0;o<t.length;o++)s();return function(e){for(var t=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},n=e.length-1;n>0;n--){var i=e[n],a=e[n-1];if(!t(i.v,a.v)||"stepped"!==a.curve&&"linear"!==a.curve)break;e.pop()}1===e.length&&e.pop()}(n),{deform:n}}(t,e.deform),function(e,t){void 0===t&&(t=[]);for(var n=e.shearX,i=e.shearY,r=[],s=[],o=0;o<t.length;o++){var c=t[o],h={curve:"linear",c2:0,c3:1,c4:1},u={curve:"linear",c2:0,c3:1,c4:1};if(c.curve instanceof Array){t.length;var l=t[o+1],d=c.time||0,p=l.time||1,f=c.x||0,m=l.x||0,g=c.y||0,v=l.y||0;h=Cw(c.curve,0,d,p,f,m),u=Cw(c.curve,1,d,p,g,v)}else u=h=(0,a.Z)({},h,c,{curve:void 0===c.curve?h.curve:c.curve});r.push((0,a.Z)({time:0,v:void 0==c.x?n:c.x},c,h)),s.push((0,a.Z)({time:0,v:void 0==c.y?i:c.y},c,u))}return Ew(r),Ew(s),{shearX:r,shearY:s}}(t,e.shear),function(e,t){void 0===t&&(t=[]);for(var n=0,i=[],r=0;r<t.length;r++){var s=t[r],o={curve:"linear",c2:0,c3:1,c4:1};if(s.curve instanceof Array){t.length;var c=t[r+1],h=s.time||0,u=c.time||1,l=0,d=1;o=Cw(s.curve,0,h,u,l,d)}else o=(0,a.Z)({},o,s,{curve:void 0===s.curve?o.curve:s.curve});i.push((0,a.Z)({time:0,v:void 0==s.position?n:s.position},s,o))}return Ew(i),{position:i}}(0,e.position),function(e,t){void 0===t&&(t=[]);if(e instanceof Phaser.GameObjects.Image){for(var n=e.frame.name,i=Number(n.match(/\d+/))||1,r=[],s=0;s<t.length;s++){var o,c=t[s],h=Number(null==(o=c.name)?void 0:o.match(/\d+/))||i;r.push((0,a.Z)({time:0,v:h},c,{curve:"stepped",c2:0,c3:1,c4:1}))}return Ew(r),{attachment:r}}return{attachment:[]}}(t,e.attachment))},ww=n(33),Sw=n.n(ww);function bw(e,t){return void 0===t&&(t=!1),function(t){var n,i,a=t/1e3;if(a<e[0].time)return e[0].v;for(var r=0;r<e.length-1;r++)if(a>=e[r].time&&a<=e[r+1].time){n=e[r],i=e[r+1];break}if(n&&i){if("stepped"===n.curve)return n.v;var s=(a-n.time)/(i.time-n.time),o="linear"===n.curve?s:Sw()(Phaser.Math.Clamp(n.curve,0,1),n.c2,Phaser.Math.Clamp(n.c3,0,1),n.c4)(s);return n.v+(i.v-n.v)*o}return e[e.length-1].v}}var Tw={tintR:[],tintG:[],tintB:[],alpha:[],scaleX:[],scaleY:[],x:[],y:[],angle:[],deform:[],shearX:[],shearY:[],position:[],attachment:[]},xw=function(){function e(e,t){this.gameObject=void 0,this.tweenAnimationGraph=void 0,this.minTime=void 0,this.maxTime=void 0,this.gameObject=e,this.tweenAnimationGraph=t||Tw}var t=e.prototype;return t.start=function(){},t.update=function(e){},t.complete=function(){},t.applyMinMaxTime=function(e){if(1===e.length)return this.minTime=0,void(this.maxTime=0);for(var t=0;t<e.length;t++){var n=e[t];(void 0===this.minTime||this.minTime>n.time)&&(this.minTime=n.time),(void 0===this.maxTime||this.maxTime<n.time)&&(this.maxTime=n.time)}},e}(),Pw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.alpha),i.applyMinMaxTime(n.alpha),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.alpha=t},t}(xw);function kw(e,t){return void 0===t&&(t=!1),function(t){var n,i,a=t/1e3;if(a<e[0].time)return e[0].v;for(var r=0;r<e.length-1;r++)if(a>=e[r].time&&a<=e[r+1].time){n=e[r],i=e[r+1];break}if(n&&i){if("stepped"===n.curve)return n.v;var s=(a-n.time)/(i.time-n.time),o="linear"===n.curve?s:Sw()(Phaser.Math.Clamp(n.curve,0,1),n.c2,Phaser.Math.Clamp(n.c3,0,1),n.c4)(s),c=i.v,h=n.v,u=c-h;return u<-180?u+=360:u>180&&(u-=360),h+u*o}return e[e.length-1].v}}var Iw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=kw(n.angle),i.applyMinMaxTime(n.angle),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.angle=t},t}(xw),Ow=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.attachment),i.applyMinMaxTime(n.attachment),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=Math.ceil(this.curve(e));if(this.gameObject instanceof Phaser.GameObjects.Image){var n=this.gameObject.frame.name.split("-")[0];this.gameObject.setFrame(n+"-"+t,!1,!1)}},t}(xw);var Rw=function(e){function t(t,n){var i,a,r;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=(a=n.deform,void 0===r&&(r=!1),function(e){var t,n,i=e/1e3;if(i<a[0].time)return a[0].v;for(var r=0;r<a.length-1;r++)if(i>=a[r].time&&i<=a[r+1].time){t=a[r],n=a[r+1];break}if(t&&n){if("stepped"===t.curve)return t.v;for(var s=(i-t.time)/(n.time-t.time),o="linear"===t.curve?s:Sw()(Phaser.Math.Clamp(t.curve,0,1),t.c2,Phaser.Math.Clamp(t.c3,0,1),t.c4)(s),c=[],h=0;h<t.v.length;h++){var u=t.v[h]+(n.v[h]-t.v[h])*o;c.push(u)}return c}return a[a.length-1].v}),i.applyMinMaxTime(n.deform),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.gameObject.setVertices;if(t&&"function"===typeof t){var n=this.curve(e);t.bind(this.gameObject)(n)}},t}(xw),Bw=function(e){function t(t,n){var i;return(i=e.call(this,t.gameObject)||this).lastT=void 0,i.eventKeyFrames=void 0,i.currentIndex=0,i.animation=void 0,i.eventKeyFrames=n,i.animation=t,i.applyMinMaxTimeEvent(n),i}(0,s.Z)(t,e);var n=t.prototype;return n.start=function(){this.lastT=void 0,this.currentIndex=0},n.update=function(e){void 0===this.lastT&&(this.lastT=e,e+=1e-8);for(var t=this.currentIndex;t<this.eventKeyFrames.length;t++){var n=this.eventKeyFrames[t],i=1e3*n.time;this.lastT<=i&&e>i&&(this.animation.events.emit(n.eventName),this.animation.parent&&this.animation.parent.emitEvent(n.eventName),this.currentIndex=t+1)}this.lastT=e},n.complete=function(){if(this.currentIndex<this.eventKeyFrames.length)for(var e=this.currentIndex;e<this.eventKeyFrames.length;e++){var t=this.eventKeyFrames[e];this.animation.events.emit(t.eventName),this.animation.parent&&this.animation.parent.emitEvent(t.eventName),this.currentIndex=e+1}},n.applyMinMaxTimeEvent=function(e){for(var t=0;t<e.length;t++){var n=e[t];(void 0===this.minTime||this.minTime>n.time)&&(this.minTime=n.time),(void 0===this.maxTime||this.maxTime<n.time)&&(this.maxTime=n.time)}},t}(xw),Dw=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n)||this).curve=void 0,a.path=void 0,a.path=i,a.curve=bw(n.position),a.applyMinMaxTime(n.position),a}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=Phaser.Math.Clamp(this.curve(e),0,1),n=this.path.getPoint(t);this.gameObject.x=n.x,this.gameObject.y=n.y},t}(xw),Lw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.scaleX),i.applyMinMaxTime(n.scaleX),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.scaleX=t},t}(xw),_w=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.scaleY),i.applyMinMaxTime(n.scaleY),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.scaleY=t},t}(xw),Mw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=kw(n.shearX),i.applyMinMaxTime(n.shearX),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.shearX=t},t}(xw),Nw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=kw(n.shearY),i.applyMinMaxTime(n.shearY),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.shearY=t},t}(xw),Gw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curveR=void 0,i.curveG=void 0,i.curveB=void 0,i.curveR=bw(n.tintR),i.curveG=bw(n.tintG),i.curveB=bw(n.tintB),i.applyMinMaxTime(n.tintR),i.applyMinMaxTime(n.tintG),i.applyMinMaxTime(n.tintB),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.gameObject.setTint;if(t&&"function"===typeof t){var n=this.curveR(e),i=this.curveG(e),a=this.curveB(e);t.bind(this.gameObject)(Phaser.Display.Color.GetColor(n,i,a))}},t}(xw),Zw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.x),i.applyMinMaxTime(n.x),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.x=t},t}(xw),Fw=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).curve=void 0,i.curve=bw(n.y),i.applyMinMaxTime(n.y),i}return(0,s.Z)(t,e),t.prototype.update=function(e){var t=this.curve(e);this.gameObject.y=t},t}(xw),Uw=function(){function e(e){this.scene=void 0,this.events=void 0,this.parent=void 0,this.gameObject=void 0,this.spineGraph=void 0,this.tweenGraph=void 0,this.updateBehaviours=[],this.tween=void 0,this.duration=0,this.timeScale=1,this.delay=0;var t=e.target;this.events=new Phaser.Events.EventEmitter,this.scene=t.scene,this.gameObject=t,this.spineGraph=e,this.tweenGraph=Aw(e),this.addBehaviours(),this.setDelay(this.spineGraph.delay)}var t=e.prototype;return t.addBehaviours=function(){var e=this.gameObject,t=this.tweenGraph;this.tweenGraph.alpha.length>=1&&this.updateBehaviours.push(new Pw(e,t)),this.tweenGraph.angle.length>=1&&this.updateBehaviours.push(new Iw(e,t)),this.tweenGraph.scaleX.length>=1&&this.updateBehaviours.push(new Lw(e,t)),this.tweenGraph.scaleY.length>=1&&this.updateBehaviours.push(new _w(e,t)),(this.tweenGraph.tintR.length>=1||this.tweenGraph.tintG.length>=1||this.tweenGraph.tintB.length>=1)&&this.updateBehaviours.push(new Gw(e,t)),this.tweenGraph.x.length>=1&&this.updateBehaviours.push(new Zw(e,t)),this.tweenGraph.y.length>=1&&this.updateBehaviours.push(new Fw(e,t)),this.tweenGraph.deform.length>=1&&this.updateBehaviours.push(new Rw(e,t)),this.spineGraph.event&&this.spineGraph.event.length>=1&&this.updateBehaviours.push(new Bw(this,this.spineGraph.event)),this.tweenGraph.shearX.length>=1&&this.updateBehaviours.push(new Mw(e,t)),this.tweenGraph.shearX.length>=1&&this.updateBehaviours.push(new Nw(e,t)),this.tweenGraph.position.length>=1&&this.spineGraph.path&&this.updateBehaviours.push(new Dw(e,t,this.spineGraph.path)),this.tweenGraph.attachment.length>=1&&this.updateBehaviours.push(new Ow(e,t)),this.duration=1e3*Math.max.apply(Math,this.updateBehaviours.map((function(e){return e.maxTime})))},t.start=function(){var e=this;return new Promise((function(t){e.stop();var n=e.delay||0;e.events.emit("start");for(var i=0;i<e.updateBehaviours.length;i++)e.updateBehaviours[i].start(),e.updateBehaviours[i].update(-n);var a=!1,r=e.scene.tweens.addCounter({from:-n,to:e.duration,duration:e.duration+n,onUpdate:function(t){var n=t.getValue();!a&&n>=0&&(e.events.emit("startDelay"),e.parent&&e.parent.emitEvent("startDelay"),a=!0);for(var i=0;i<e.updateBehaviours.length;i++)e.updateBehaviours[i].update(n);e.spineGraph.onUpdate&&e.spineGraph.onUpdate(n)},loop:e.spineGraph.loop,onComplete:function(){e.events.emit("complete"),e.tween=void 0;for(var n=0;n<e.updateBehaviours.length;n++)e.updateBehaviours[n].complete();t()}});r.setTimeScale(e.timeScale),e.tween=r}))},t.stop=function(){this.tween&&(this.events.emit("stop"),this.tween.complete())},t.seek=function(e){for(var t=this.updateBehaviours.filter((function(e){return!(e instanceof Bw)})),n=0;n<t.length;n++)this.updateBehaviours[n].update(e)},t.setTimeScale=function(e){void 0===e&&(e=1),this.timeScale=e},t.setDelay=function(e){this.delay=e||0},(0,H.Z)(e,[{key:"isPlaying",get:function(){return!!this.tween}}]),e}(),Ww=function(){function e(e){this.events=void 0,this.parent=void 0,this.children=[],this.timeScale=1,this.loop=0,this.tweenLoopAnimation=void 0,this.events=new Phaser.Events.EventEmitter,this.createAnimation(e)}var t=e.prototype;return t.createAnimation=function(e){for(var t=0;t<e.length;t++){var n=e[t].target;Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var r=e[t].delay||0;"function"===typeof r&&(r=r(n[i],"",0,i,n.length)),this.addAnimation(new Uw((0,a.Z)({},e[t],{target:n[i],delay:r})))}}},t.addAnimationGraph=function(e){this.createAnimation(e)},t.addAnimation=function(e){var t=this;this.children.push(e),this.children=this.children.filter((function(e,n){return t.children.indexOf(e)===n})),e.parent=this},t.removeAnimation=function(e){this.children=this.children.filter((function(t,n){return t!==e})),e.parent=void 0},t.start=function(){var e,t=this;return null==(e=this.tweenLoopAnimation)||e.complete(),0===this.loop?this.startAnimation():new Promise((function(e){var n=t.children[0].scene;t.tweenLoopAnimation=n.tweens.addCounter({from:0,to:1,duration:t.duration,loop:t.loop,onStart:function(){t.startAnimation()},onLoop:function(){t.startAnimation()},onComplete:function(){e()}})}))},t.startAnimation=function(){var e=this;return 0===this.children.length?Promise.resolve():new Promise((function(t){e.events.emit("start");var n=e.children.map((function(t){return t.setTimeScale(e.timeScale),t.start()}));Promise.all(n).then((function(){e.events.emit("complete"),t()}))}))},t.stop=function(){this.events.emit("stop"),this.children.forEach((function(e){e.stop()}))},t.emitEvent=function(e){for(var t,n,i=arguments.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=arguments[r];((t=this.events).emit.apply(t,[e].concat(a)),this.parent)&&(n=this.parent).emitEvent.apply(n,[e].concat(a))},t.seek=function(e){this.children.forEach((function(t){t.seek(e)}))},t.seekPercent=function(e){var t=this.duration*e;this.seek(t)},t.setTimeScale=function(e){void 0===e&&(e=1),this.timeScale=e},t.setDelay=function(e){this.children.forEach((function(t){t.setDelay(e)}))},t.setLoop=function(e){this.loop=e},(0,H.Z)(e,[{key:"scene",get:function(){return this.children[0].scene}},{key:"duration",get:function(){return Math.max.apply(Math,this.children.map((function(e){return e.duration})))}},{key:"isPlaying",get:function(){return this.children.some((function(e){return e.isPlaying}))}}]),e}();Ww.WORLD_SCALE=1/2.88;var Hw=Ww,Yw=function(e){return e.SLICE="SLICE",e.STORM="STORM",e.WILD_CARD="WILD_CARD",e}({}),Kw=Wi.Z.EVENT_BOARD,zw=Kw.KEY,Vw=Kw.FRAME,jw=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boxerFrame=void 0,i.crown=void 0,i.avatar=void 0,i.showCrownAnimation=void 0,i.borderCover=void 0,i.randomFrame=void 0,i.scene=t,i.isPlayer=n,i.boxerFrame=i.isPlayer?Vw.BOXING_DUEL.PLAYER:Vw.BOXING_DUEL.OPPONENT,i.create(),i.setSize(i.avatar.width,i.avatar.height),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){if(e){this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.photo;this.updateBoxerPhoto(t,n)}else this.setRandomPlayer()},n.updateBoxerPhoto=function(e,t){this.randomFrame.kill(),this.avatar.loadPhoto(e,t,50)},n.setRandomPlayer=function(){this.randomFrame.revive()},n.showCrown=function(e){var t;null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.alignItems=function(){var e=this.isPlayer?-20:20;this.crown.setPosition(e,-30)},n.create=function(){this.createAvatar(),this.createRandomFrame(),this.createAvatarBorderCover(),this.createCrown()},n.createRandomFrame=function(){var e=this.scene.add.image(0,0,zw,this.boxerFrame.AVATAR.RANDOM);e.setDefaultWorldSize(),this.add(e),this.randomFrame=e},n.createAvatar=function(){var e=new Ic(this.scene,{key:zw,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.BACKGROUND,width:67,height:208/3});this.add(e),this.avatar=e},n.createAvatarBorderCover=function(){var e=this.scene.add.image(0,0,zw,this.boxerFrame.AVATAR.BORDER);e.setDefaultWorldSize(),this.add(e),this.borderCover=e,this.borderCover.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,zw,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e},t}(Phaser.GameObjects.Container),Xw=Wi.Z.EVENT_BOARD,qw=Xw.KEY,Jw=Xw.FRAME,Qw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.rope=void 0,n.anchorKnot=void 0,n.ropeAnimation=void 0,n.onClicked=!1,n.board=void 0,n.ropeContainer=void 0,n.ropeImage=void 0,n.handleMouseDown=function(){if(!n.onClicked){n.onClicked=!0;var e=n.ropeAnimation;n.scene.tweens.addCounter({from:0,to:.2,duration:.2*e.duration,onStart:function(){e.stop(),e.seekPercent(0)},onUpdate:function(t){e.seekPercent(t.getValue())},onComplete:function(){e.stop(),e.seekPercent(.2)}})}},n.handleMouseUp=function(){if(n.onClicked){n.onClicked=!1;var e=n.ropeAnimation;n.scene.tweens.addCounter({from:.2,to:1,duration:.8*e.duration,onStart:function(){e.stop(),e.seekPercent(.2)},onUpdate:function(t){e.seekPercent(t.getValue())},onComplete:function(){e.stop(),e.seekPercent(1)}})}},n.scene=t,n.setSize(26/3,101/3),n.create(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createRope(),this.createAnchorKnot(),this.createRopeAnimation()},n.createRope=function(){this.ropeContainer=this.scene.add.container(0,0),this.add(this.ropeContainer),this.ropeContainer.setSize(26/3,101/3),this.rope=this.scene.add.container(0,0),this.ropeContainer.add(this.rope),this.rope.setSize(26/3,101/3);var e=this.scene.add.image(0,0,qw,Jw.ROPE);e.setDefaultWorldSize(),this.rope.add(e),this.ropeImage=e},n.createAnchorKnot=function(){this.anchorKnot=this.scene.add.container(0,0),this.add(this.anchorKnot);var e=this.scene.add.image(0,0,qw,Jw.ANCHOR_KNOT);e.setDefaultWorldSize(),this.anchorKnot.add(e),this.anchorKnot.setSize(e.width,e.height),this.anchorKnot.setX(-.4),this.anchorKnot.setY(this.height/2+this.anchorKnot.height/8)},n.createRopeAnimation=function(){var e=new Hw([{target:this,translate:[{curve:[.017,0,.033,0,0,-4.33,.033,-6.66]},{time:.05,y:-6.66,curve:[.1,0,.15,0,.1,-6.66,.15,6.66]},{time:.2,y:6.66,curve:[.233,0,.267,0,.233,6.66,.267,2.22]},{time:.3}]},{target:this.rope,translate:[{curve:[.017,0,.033,0,.008,-2.59,.033,-4.77]},{time:.05,y:-4.77,curve:[.089,0,.128,0,.089,-4.77,.128,5.96]},{time:.1667,y:5.96,curve:[.211,0,.256,0,.211,5.96,.256,1.99]},{time:.3}],scale:[{curve:[.008,.925,.033,.861,.008,1.071,.033,1.131]},{time:.05,x:.861,y:1.131,curve:[.089,.861,.128,1.095,.089,1.131,.128,.976]},{time:.1667,x:1.095,y:.976,curve:[.211,1.095,.256,1.032,.211,.976,.256,.992]},{time:.3}]}]);this.ropeAnimation=e},t}(Phaser.GameObjects.Container),$w=Qw,eS=1e3,tS=6e4,nS=36e5,iS=864e5;function aS(e){var t=Math.floor(e/iS);e%=iS;var n=Math.floor(e/nS);e%=nS;var i=Math.floor(e/tS);return e%=tS,{days:t,hours:n,minutes:i,seconds:Math.floor(e/eS),milliseconds:e%=eS}}var rS=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=new jp(this.scene,{text:"Completed",fontSize:this.scene.fontSize(12),fillColor:11102533}),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new sS(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),sS=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.rtMs=void 0,this.startTime=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.destroy(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",10),t.countdownTimer.remove();else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),oS=Wi.Z.EVENT_BOARD,cS=oS.KEY,hS=oS.FRAME,uS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.timerText=void 0,n.blueGlove=void 0,n.redGlove=void 0,n.blueText=void 0,n.redText=void 0,n.avatarContainer=void 0,n.leftAvatar=void 0,n.rightAvatar=void 0,n.header=void 0,n.winningSide="draw",n.upTweens=void 0,n.downTweens=void 0,n.timerContainer=void 0,n.scene=t,n.createBoard(),n.createHeader(),n.createAvatars(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){this.leftAvatar.crown.setAlpha(0),this.rightAvatar.crown.setAlpha(0);var e=this.scene.boxingDuel,t=e.getPlayer(),n=e.getOpponent(),i=t.score,a=(null==n?void 0:n.score)||0;this.leftAvatar.updateData(t),this.rightAvatar.updateData(n),this.blueText.setText(i.toString()),this.redText.setText(a.toString()),i>a?this.setLeftWin():i<a?this.setRightWin():this.setDraw();var r=(new Date).getTime(),s=this.scene.boxingDuel.getEndTime()-r;this.timerText.timerLogic.setRemainingTime(s)},n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTweens)||e.forEach((function(e){return e.stop()})),this.downTweens=[this.scene.add.tween({targets:[this.leftAvatar,this.rightAvatar],scale:.75,y:15,duration:100,ease:Phaser.Math.Easing.Sine.Out}),this.scene.add.tween({targets:[this.leftAvatar],x:-16,angle:-8,duration:100,ease:Phaser.Math.Easing.Sine.Out}),this.scene.add.tween({targets:[this.rightAvatar],x:14,angle:8,duration:100,ease:Phaser.Math.Easing.Sine.Out})]},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTweens)||e.forEach((function(e){return e.stop()}));var t="left"===this.winningSide?0:50,n="right"===this.winningSide?0:50;this.upTweens=[this.scene.add.tween({targets:[this.leftAvatar],scale:.8,x:-18,y:12,angle:-10,delay:t,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]}),this.scene.add.tween({targets:[this.rightAvatar],scale:.8,x:16,y:12,angle:10,delay:n,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})]},n.setLeftWin=function(){this.leftAvatar.showCrown(!0),this.rightAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.leftAvatar,this.rightAvatar),this.blueGlove.setVisible(!0),this.redGlove.setVisible(!1),this.winningSide="left"},n.setRightWin=function(){this.rightAvatar.showCrown(!0),this.leftAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.rightAvatar,this.leftAvatar),this.blueGlove.setVisible(!1),this.redGlove.setVisible(!0),this.winningSide="right"},n.setDraw=function(){this.leftAvatar.showCrown(!1),this.rightAvatar.showCrown(!1),this.avatarContainer.moveAbove(this.leftAvatar,this.rightAvatar),this.blueGlove.setVisible(!0),this.redGlove.setVisible(!1),this.winningSide="draw"},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+7),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.timerContainer.setPosition(0,this.height/2-this.timerContainer.height/2)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){var e=this.scene.add.container(0,0);this.addAt(e,1);var t=this.scene.add.image(0,0,cS,hS.HEADER_BOARD);t.setDefaultWorldSize(),e.add(t),this.board=e,this.board.setSize(t.width,t.height),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createHeader=function(){this.createWidgetTopBar(),this.createGloves(),this.createScoreText()},n.createWidgetTopBar=function(){this.header=this.scene.add.container(0,0),this.header.setSize(69,16),this.header.setY(-this.height/2+this.header.height/2+18.25),this.add(this.header);var e=this.scene.make.nineslice({key:cS,frame:hS.BOXING_DUEL.LOADING_BAR.BLUE,width:this.header.width/2,height:this.header.height,leftWidth:22/3,rightWidth:22/3});e.setPosition(-this.header.width/4,0),this.header.add(e);var t=this.scene.make.nineslice({key:cS,frame:hS.BOXING_DUEL.LOADING_BAR.RED,width:this.header.width/2,height:this.header.height,leftWidth:22/3,rightWidth:22/3});t.setPosition(this.header.width/4-1,0),this.header.add(t)},n.createGloves=function(){var e=this.scene.add.image(0,0,cS,hS.BOXING_DUEL.GLOVE.BLUE);e.setDefaultWorldSize(),this.header.add(e);var t=this.scene.add.image(0,0,cS,hS.BOXING_DUEL.GLOVE.RED);t.setDefaultWorldSize(),this.header.add(t),this.blueGlove=e,this.redGlove=t},n.createScoreText=function(){this.redText=new jp(this.scene,{text:"195",fontSize:this.scene.fontSize(11),strokeColor:6358552,strokeThickness:2,strokeOffset:{y:.3},strokeAlpha:.8}),this.header.add(this.redText),this.redText.setPosition(this.board.width/4+this.blueGlove.width/4-7,.5),this.blueText=new jp(this.scene,{text:"169",fontSize:this.scene.fontSize(11),strokeColor:208736,strokeThickness:2,strokeOffset:{y:.3},strokeAlpha:.8}),this.header.add(this.blueText),this.blueText.setPosition(-this.board.width/4-this.blueGlove.width/4+7,.5)},n.createAvatars=function(){var e=this.scene.add.container(0,0);this.add(e);var t=new jw(this.scene,!0);t.setScale(.8,.8),t.setAngle(-10),t.setPosition(-18,12),e.add(t);var n=new jw(this.scene,!1);n.setScale(.8,.8),n.setAngle(10),n.setPosition(16,12),e.add(n),this.avatarContainer=e,this.leftAvatar=t,this.rightAvatar=n},n.createTimer=function(){var e=this.scene.add.container(0,0);e.setSize(208/3,76/3),this.add(e),this.timerContainer=e;var t=this.scene.add.image(0,0,cS,hS.BOXING_DUEL.TIMER_BORDER);t.setDefaultWorldSize(),e.add(t),this.timerText=new rS(this.scene),e.add(this.timerText)},t}($w),lS=uS,dS=Wi.Z.EVENT_BOARD,pS=dS.KEY,fS=dS.FRAME,mS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.gloves=void 0,n.button=void 0,n.scene=t,n.createBoard(),n.createVSIcon(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.gloves],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.gloves],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2-2),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.gloves.setPosition(0,5),this.button.setPosition(0,37)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){var e=this.scene.add.container(0,0);this.addAt(e,1);var t=this.scene.add.image(0,0,pS,fS.BOXING_DUEL.START_CIRCLE);t.setDefaultWorldSize(),e.add(t),this.board=e,this.board.setSize(t.width,t.height),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createVSIcon=function(){this.gloves=this.scene.add.container(0,0),this.add(this.gloves);var e=this.scene.add.image(0,0,pS,fS.BOXING_DUEL.ICON_VS);e.setDefaultWorldSize(),this.gloves.add(e)},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,pS,fS.BOXING_DUEL.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new jp(this.scene,{text:"Start",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}($w),gS=mS,vS=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),yS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.duelStatus=void 0,n.startBoxingDuelBoard=void 0,n.inBoxingDuelBoard=void 0,n.contents=[],n.startBoardWrapper=void 0,n.inBoardWrapper=void 0,n.wrappers=[],n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.contents.forEach((function(e){e.active&&e.handleMouseDownAnim()})))},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.visible&&e.handleMouseUpAnim()})),n.handleButtonClick())},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.handleMouseUpAnim()})))},n.handleButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.screen.close(ce.o4.PLAY_SCREEN),e.next=3,n.scene.requireTextureAsync("BOXING_DUEL");case 3:t=n.scene.boxingDuel,t.isFinished()?n.scene.screen.open(ce.o4.BOXING_DUEL.REWARD_SCREEN):n.scene.screen.open(ce.o4.BOXING_DUEL.MAIN_SCREEN,{previousScreen:ce.o4.PLAY_SCREEN});case 6:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.boxingDuel.isValid()?(this.revive(),this.updateBoxingDuelContent()):this.kill();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxingDuelContent=function(){var e=this.scene.boxingDuel;if(e.isWaiting())this.setDuelState(vS.READY);else{if(e.isFinished())0===e.getPlayerRank()?this.setDuelState(vS.WON):this.setDuelState(vS.LOST);else this.setDuelState(vS.PLAYING);this.inBoxingDuelBoard.updateData()}},n.setDuelState=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.duelStatus=t,this.contents.forEach((function(e){e.kill()})),e.t0=t,e.next=e.t0===vS.READY?5:e.t0===vS.PLAYING||e.t0===vS.WON||e.t0===vS.LOST?8:11;break;case 5:return this.startBoxingDuelBoard.revive(),this.originBoardY=this.startBoardWrapper.y,e.abrupt("break",11);case 8:return this.inBoxingDuelBoard.revive(),this.originBoardY=this.inBoardWrapper.y,e.abrupt("break",11);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.duelStatus===vS.READY?this.startBoxingDuelBoard.rope:this.inBoxingDuelBoard.rope,n=this.duelStatus===vS.READY?this.startBoardWrapper:this.inBoardWrapper;t.setScale(1,1);var i={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},r={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},s=this.scene.tweens.add((0,a.Z)({targets:n},i)),o=this.scene.tweens.add((0,a.Z)({targets:t},r));return this.openTweens.push(s,o),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inBoxingDuelBoard.timerText.timerLogic.stopTimer(),e.next=3,this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createStartBoxingDuelBoard(),this.createInBoxingDuelBoard()},n.createStartBoxingDuelBoard=function(){var e=this.scene.add.container(0,0);this.add(e),this.startBoxingDuelBoard=new gS(this.scene),e.add(this.startBoxingDuelBoard),e.setSize(this.startBoxingDuelBoard.width,this.startBoxingDuelBoard.height),this.startBoardWrapper=e,this.contents.push(this.startBoxingDuelBoard),this.wrappers.push(this.startBoardWrapper)},n.createInBoxingDuelBoard=function(){var e=this.scene.add.container(0,0);this.add(e),this.inBoxingDuelBoard=new lS(this.scene),e.add(this.inBoxingDuelBoard),e.setSize(this.inBoxingDuelBoard.width,this.inBoxingDuelBoard.height),this.inBoardWrapper=e,this.contents.push(this.inBoxingDuelBoard),this.wrappers.push(this.inBoardWrapper)},n.alignContent=function(){var e=this,t=Math.max(this.startBoardWrapper.width,this.inBoardWrapper.width),n=Math.max(this.startBoardWrapper.height,this.inBoardWrapper.height);this.setSize(t,n),this.wrappers.forEach((function(t,i){e.setBoardY(t,e.contents[i].extraHeight,n)}))},n.setBoardY=function(e,t,n){var i=t-Math.abs(n-e.height)/2;e.setY(i)},t}(Phaser.GameObjects.Container),ES=yS,CS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(265/3,416/3),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.close();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new ES(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),AS=CS,wS=Wi.Z.EVENT_BOARD,SS=wS.KEY,bS=wS.FRAME,TS=function(e){function t(t){var n;return(n=e.call(this,t,40,40)||this).scene=void 0,n.background=void 0,n.icon=void 0,n.requiredLevelsText=void 0,n.scene=t,n.create(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setPlaying=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.requiredLevelsText.setX(7),this.requiredLevelsText.setFontSize(this.scene.fontSize(13)),this.requiredLevelsText.setText(""+e),this.icon.revive(),this.background.setSizeByWorld(48,this.background.displayHeight),this.setSize(this.background.displayWidth,this.background.displayHeight)},n.setFinished=function(){this.requiredLevelsText.setX(0),this.requiredLevelsText.setFontSize(this.scene.fontSize(12)),this.requiredLevelsText.setText("Completed"),this.icon.kill(),this.background.setSizeByWorld(75,this.background.displayHeight),this.setSize(this.background.displayWidth,this.background.displayHeight)},n.create=function(){this.createBackground(),this.createIcon(),this.createText()},n.createBackground=function(){var e=this.scene.make.nineslice({key:SS,frame:bS.OFFSHORE_RACE.LEVEL_PANEL,width:48,height:24,leftWidth:10,rightWidth:10});this.add(e),e.setSizeByWorld(48,e.displayHeight),this.background=e,this.setSize(this.background.displayWidth,this.background.displayHeight)},n.createIcon=function(){var e=this.scene.add.image(0,0,SS,bS.OFFSHORE_RACE.TRIANGLE);e.setDefaultWorldSize(),this.add(e),e.setPosition(-7,0),this.icon=e},n.createText=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"15",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setTint(33447),this.add(e),e.setPosition(7,-1),this.requiredLevelsText=e},t}(Phaser.GameObjects.Container),xS=TS,PS=Wi.Z.EVENT_BOARD,kS=PS.KEY,IS=PS.FRAME,OS=function(e){function t(t,n){var i;return(i=e.call(this,t,{key:kS,background:n?IS.OFFSHORE_RACE.PLAYER.AVATAR:IS.OFFSHORE_RACE.OPPONENT.AVATAR,frame:IS.BLANK,width:23,height:23.333333333333332,loadDelay:1e3})||this).avtFrame.kill(),i}(0,s.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){void 0===i&&(i=70),n&&(t===this.payload.id&&n===this.payload.url||e.prototype.loadPhoto.call(this,t,n,i))},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,a=n.height,r=Math.min(i,a);this.photo.setWorldSize(r,r)},n.showDefaultPhoto=function(){this.loadPhoto(ie.Z.AVATAR.KEY,ie.Z.AVATAR.FILE)},t}(Ic),RS=OS,BS=Wi.Z.EVENT_BOARD,DS=BS.KEY,LS=BS.FRAME,_S=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.medal=void 0,i.rankText=void 0,i.isPlayer=void 0,i.scene=t,i.isPlayer=n,i.setSize(32,36),i.createMedal(),i.createRankText(),i}(0,s.Z)(t,e);var n=t.prototype;return n.createMedal=function(){this.medal=this.scene.add.image(0,0,DS,LS.OFFSHORE_RACE.MEDAL.GOLD),this.medal.setDefaultWorldSize(),this.add(this.medal)},n.setRank=function(e){var t=-1===e?"-":e>=100?"99+":(e+1).toString();switch(this.rankText.setText(t),this.rankText.kill(),this.medal.revive(),e){case 0:this.medal.setFrame(LS.OFFSHORE_RACE.MEDAL.GOLD);break;case 1:this.medal.setFrame(LS.OFFSHORE_RACE.MEDAL.SILVER);break;case 2:this.medal.setFrame(LS.OFFSHORE_RACE.MEDAL.BRONZE);break;default:this.rankText.revive(),this.medal.kill()}},n.createRankText=function(){var e=new jp(this.scene,{text:"4",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.rankText=e,this.add(this.rankText)},t}(Phaser.GameObjects.Container),MS=Wi.Z.EVENT_BOARD,NS=MS.KEY,GS=MS.FRAME,ZS=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.blockIndex=void 0,a.frames=void 0,a.rank=void 0,a.isPlayer=void 0,a.racerScore=void 0,a.avatar=void 0,a.scene=t,a.blockIndex=i,a.isPlayer=n,a.frames=n?GS.OFFSHORE_RACE.PLAYER:GS.OFFSHORE_RACE.OPPONENT,a.create(),t.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.racerId,n=e.score,i=e.photo,a=e.rank;i&&this.avatar.loadPhoto(t,i),this.racerScore.setText(n.toString()),this.rank.setRank(a)},n.create=function(){this.createAvatar(),this.createScoreboard(),this.createRank(),this.createScore()},n.createScoreboard=function(){var e=this.scene.add.image(0,0,NS,this.frames.SCOREBOARD);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createAvatar=function(){var e=new RS(this.scene,this.isPlayer);e.showDefaultPhoto(),this.add(e),this.avatar=e,this.avatar.setPosition(-8.2,-.8)},n.createRank=function(){this.rank=new _S(this.scene,this.isPlayer),this.add(this.rank),this.rank.setRank(this.blockIndex+1),this.rank.setPosition(-this.width/2+14,0)},n.createScore=function(){var e=new jp(this.scene,{text:"12",fontSize:this.scene.fontSize(12),strokeColor:12927496,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),t=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"10",origin:{x:.5,y:.5}});t.setTint(33447),this.isPlayer?(e.setVisible(!0),t.setVisible(!1)):(e.setVisible(!1),t.setVisible(!0)),this.racerScore=this.isPlayer?e:t,this.add(this.racerScore),this.racerScore.setPosition(this.width/2-22,-1)},t}(Phaser.GameObjects.Container),FS=ZS,US=Wi.Z.EVENT_BOARD,WS=US.KEY,HS=US.FRAME,YS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.leaderboardBoard=void 0,n.title=void 0,n.racers=void 0,n.leaderboardButton=void 0,n.timerText=void 0,n.timerContainer=void 0,n.handleButtonClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(ce.o4.PLAY_SCREEN),n.scene.openOffshoreRaceMainScreen({previousScreen:ce.o4.PLAY_SCREEN});case 2:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createLeaderboardButton(),n.createRacers(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=this.scene.offshoreRace.getRacers();this.racers.forEach((function(t,n){t.updateData(e[n])})),this.leaderboardButton.setPlaying();var t=this.scene.offshoreRace.getRemainingTime();this.timerText.timerLogic.setRemainingTime(t)},n.handleMouseDownAnim=function(){this.handleMouseDown()},n.handleMouseUpAnim=function(){this.handleMouseUp()},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.timerContainer,this.board,0,-5)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createLeaderboardBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createLeaderboardBoard=function(){var e=this.scene.add.image(0,0,WS,HS.OFFSHORE_RACE.TAG.LEADERBOARD);e.setDefaultWorldSize(),this.board.add(e),this.leaderboardBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createLeaderboardButton=function(){this.leaderboardButton=new xS(this.scene),this.add(this.leaderboardButton),this.leaderboardButton.setPosition(0,-42.5)},n.createRacers=function(){var e=this;this.racers=new Array(5).fill(null).map((function(t,n){return new FS(e.scene,0===n,n)})),this.add(this.racers),this.racers.forEach((function(e,t){e.setPosition(0,31*t-15)}))},n.createTimer=function(){this.timerContainer=this.scene.add.container(0,0),this.add(this.timerContainer);var e=this.scene.add.image(0,0,WS,HS.OFFSHORE_RACE.TIME_PANEL);e.setDefaultWorldSize(),this.timerContainer.add(e),this.timerText=new rS(this.scene),this.timerText.txt.setTintSeparate(33447,33447),this.timerContainer.add(this.timerText)},t}($w),KS=YS,zS=Wi.Z.EVENT_BOARD,VS=zS.KEY,jS=zS.FRAME,XS=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.promotionBoard=void 0,n.title=void 0,n.description=void 0,n.button=void 0,n.handleButtonClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(ce.o4.PLAY_SCREEN),n.scene.offshoreRace.startRace(),n.scene.openOffshoreRaceMainScreen({shouldPlayEntranceAnimation:!0,previousScreen:ce.o4.PLAY_SCREEN});case 3:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createDescription(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.button],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.button],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.button,this.board,0,-16)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createPromotionBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createPromotionBoard=function(){var e=this.scene.add.image(0,0,VS,jS.OFFSHORE_RACE.TAG.PROMOTION);e.setDefaultWorldSize(),this.board.add(e),this.promotionBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"Join race\nand win prizes",origin:{x:.5,y:0}});e.setCenterAlign(),e.setTint(33447),e.setLineHeight(80),this.add(e),e.setPosition(0,-82),this.description=e},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,VS,jS.OFFSHORE_RACE.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new jp(this.scene,{text:"Start",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}($w),qS=XS,JS=Wi.Z.EVENT_BOARD,QS=JS.KEY,$S=JS.FRAME,eb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.downTween=void 0,n.upTween=void 0,n.wonBoard=void 0,n.title=void 0,n.description=void 0,n.chest=void 0,n.button=void 0,n.handleButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.close(ce.o4.PLAY_SCREEN),t=n.scene.offshoreRace.getRewardData(),n.scene.openOffshoreRaceRewardScreen({rewards:t});case 3:case"end":return e.stop()}}),e)}))),n.scene=t,n.createBoard(),n.createTitle(),n.createDescription(),n.createChest(),n.createButton(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.offshoreRace.getPlayerRank(),e.t0=t,e.next=0===e.t0?4:1===e.t0?7:2===e.t0?10:13;break;case 4:return this.description.setText("Well done!\nYou finished\nfirst!"),this.chest.setTexture(QS,$S.OFFSHORE_RACE.CHEST.GOLD),e.abrupt("break",13);case 7:return this.description.setText("Well done!\nYou finished\nsecond!"),this.chest.setTexture(QS,$S.OFFSHORE_RACE.CHEST.SILVER),e.abrupt("break",13);case 10:return this.description.setText("Well done!\nYou finished\nthird!"),this.chest.setTexture(QS,$S.OFFSHORE_RACE.CHEST.BRONZE),e.abrupt("break",13);case 13:this.chest.setDefaultWorldSize(),this.chest.setPosition(0,55);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.button],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.button],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+6.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.board,0,-25),Phaser.Display.Align.In.BottomCenter(this.button,this.board,0,-16)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(117,844/3),this.createWonBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createWonBoard=function(){var e=this.scene.add.image(0,0,QS,$S.OFFSHORE_RACE.TAG.WIN_EMPTY);e.setDefaultWorldSize(),this.board.add(e),this.wonBoard=e},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(16),text:"Offshore\nRacers",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setLetterSpacing(-5),e.setLineHeight(120),this.add(e),this.title=e},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"Well done!\nYou finished\nfirst!",origin:{x:.5,y:0}});e.setCenterAlign(),e.setTint(33447),e.setLineHeight(80),this.add(e),e.setPosition(0,-82),this.description=e},n.createChest=function(){var e=this.scene.add.image(0,0,QS,$S.OFFSHORE_RACE.CHEST.GOLD);e.setOrigin(.5,1),e.setDefaultWorldSize(),this.add(e),e.setPosition(0,55),this.chest=e},n.createButton=function(){var e=this.scene.add.container(0,0);this.add(e),this.button=e;var t=this.scene.add.image(0,0,QS,$S.OFFSHORE_RACE.GREEN_BUTTON);t.setDefaultWorldSize(),this.button.add(t),this.button.setSize(t.width,t.height);var n=new jp(this.scene,{text:"Open",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});n.setPosition(0,-1),this.button.add(n)},t}($w),tb=eb,nb=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),ib=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.raceStatus=void 0,n.racePromotionContent=void 0,n.raceLeaderboardContent=void 0,n.raceWonContent=void 0,n.contents=[],n.racePromotionContentWrapper=void 0,n.raceLeaderboardContentWrapper=void 0,n.raceWonContentWrapper=void 0,n.wrappers=[],n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.contents.forEach((function(e){e.active&&e.handleMouseDownAnim()})))},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.visible&&(e.handleMouseUpAnim(),e.handleButtonClick())})))},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.contents.forEach((function(e){e.active&&e.handleMouseUpAnim()})))},n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.offshoreRace.isValid()?(this.revive(),this.updateOffshoreRaceContent()):this.kill();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateOffshoreRaceContent=function(){var e=this.scene.offshoreRace;if(e.isWaiting())this.setRaceState(nb.READY);else{var t=this.scene.offshoreRace.hasReward();e.isFinished()?t?this.setRaceState(nb.WON):this.setRaceState(nb.LOST):this.setRaceState(nb.PLAYING)}},n.setRaceState=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.raceStatus=t,this.contents.forEach((function(e){e.kill()})),e.t0=t,e.next=e.t0===nb.READY?5:e.t0===nb.PLAYING||e.t0===nb.LOST?8:e.t0===nb.WON?12:16;break;case 5:return this.racePromotionContent.revive(),this.originBoardY=this.racePromotionContentWrapper.y,e.abrupt("break",16);case 8:return this.raceLeaderboardContent.revive(),this.raceLeaderboardContent.updateData(),this.originBoardY=this.raceLeaderboardContentWrapper.y,e.abrupt("break",16);case 12:return this.raceWonContent.revive(),this.raceWonContent.updateData(),this.originBoardY=this.raceWonContentWrapper.y,e.abrupt("break",16);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.racePromotionContent.rope;t.setScale(1,1);var n={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},i={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},r=this.scene.tweens.add((0,a.Z)({targets:this.wrappers},n)),s=this.scene.tweens.add((0,a.Z)({targets:t},i));return this.openTweens.push(r,s),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createRacePromotionContent(),this.createRaceLeaderboardContent(),this.createRaceWonContent()},n.createRacePromotionContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.racePromotionContent=new qS(this.scene),e.add(this.racePromotionContent),e.setSize(this.racePromotionContent.width,this.racePromotionContent.height),this.racePromotionContentWrapper=e,this.contents.push(this.racePromotionContent),this.wrappers.push(this.racePromotionContentWrapper)},n.createRaceLeaderboardContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.raceLeaderboardContent=new KS(this.scene),e.add(this.raceLeaderboardContent),e.setSize(this.raceLeaderboardContent.width,this.raceLeaderboardContent.height),this.raceLeaderboardContentWrapper=e,this.contents.push(this.raceLeaderboardContent),this.wrappers.push(this.raceLeaderboardContentWrapper)},n.createRaceWonContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.raceWonContent=new tb(this.scene),e.add(this.raceWonContent),e.setSize(this.raceWonContent.width,this.raceWonContent.height),this.raceWonContentWrapper=e,this.contents.push(this.raceWonContent),this.wrappers.push(this.raceWonContentWrapper)},n.alignContent=function(){var e=this;this.setSize(this.racePromotionContentWrapper.width,this.racePromotionContentWrapper.height+10),this.wrappers.forEach((function(t){e.setBoardY(t,e.racePromotionContent.extraHeight,e.height-10)}))},n.setBoardY=function(e,t,n){e.setY(t-Math.abs(n-e.height)/2)},t}(Phaser.GameObjects.Container),ab=ib,rb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(117,950/3),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new ab(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),sb=rb,ob=Wi.Z.EVENT_BOARD,cb=ob.KEY,hb=ob.FRAME,ub=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).background=void 0,a.rankText=void 0,a.create(),a}(0,s.Z)(t,e);var n=t.prototype;return n.updateBackgroundToWin=function(e){this.background.setFrame(e?hb.GREEN_CIRCLE:hb.BLUE_CIRCLE),this.background.setDefaultWorldSize()},n.setRank=function(e){this.setVisible(e>0);var t=e<100?""+e:"99+",n=e<100?14:12;this.rankText.setFontSize(this.scene.fontSize(n)),this.rankText.setText(t)},n.create=function(){var e=this.scene.add.image(0,0,cb,hb.BLUE_CIRCLE);e.setDefaultWorldSize(),e.setY(.5),this.setSize(e.width,e.height);var t=new jp(this.scene,{text:"1",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setPosition(0,-1),this.add([e,t]),this.rankText=t,this.background=e},t}(Phaser.GameObjects.Container),lb=ub,db=Wi.Z.EVENT_BOARD,pb=db.KEY,fb=db.FRAME,mb=function(e){return e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}(mb||{}),gb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.extraHeight=0,n.timerText=void 0,n.cup=void 0,n.playingBoard=void 0,n.wonBoard=void 0,n.lostBoard=void 0,n.rankBlock=void 0,n.downTween=void 0,n.upTween=void 0,n.scene=t,n.createBoard(),n.createCup(),n.createTimer(),n.alignItems(),n.calculateTotalHeight(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setContentVisible(mb.LOADING),t=this.scene.weeklyTournament,e.next=4,t.requestPlayerProgress();case 4:n=this.getBoardStatus(),i=t.getRemainingTime(),a=t.getRank(),this.rankBlock.setRank(a),this.timerText.timerLogic.setRemainingTime(i),this.setContentVisible(n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleMouseDownAnim=function(){var e;this.handleMouseDown(),null==(e=this.upTween)||e.stop(),this.downTween=this.scene.add.tween({targets:[this.cup],scale:.93,duration:100,ease:Phaser.Math.Easing.Sine.Out})},n.handleMouseUpAnim=function(){var e;this.handleMouseUp(),null==(e=this.downTween)||e.stop(),this.upTween=this.scene.add.tween({targets:[this.cup],scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[8]})},n.setContentVisible=function(e){switch(this.rankBlock.setVisible(!1),this.timerText.setVisible(!1),this.playingBoard.setVisible(!1),this.wonBoard.setVisible(!1),this.lostBoard.setVisible(!1),e){case mb.LOADING:this.timerText.setVisible(!0),this.timerText.setText("Loading...",11),this.playingBoard.setVisible(!0);break;case mb.READY:this.timerText.setVisible(!0),this.playingBoard.setVisible(!0);break;case mb.PLAYING:this.rankBlock.setVisible(!0),this.timerText.setVisible(!0),this.playingBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!1);break;case mb.WON:this.rankBlock.setVisible(!0),this.wonBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!0);break;case mb.LOST:this.rankBlock.setVisible(!0),this.lostBoard.setVisible(!0),this.rankBlock.updateBackgroundToWin(!1)}},n.getBoardStatus=function(){var e=this.scene.weeklyTournament;return e.isWaiting()?mb.READY:e.isHappening()?mb.PLAYING:e.isFinished()?e.hasReward()?mb.WON:mb.LOST:mb.READY},n.alignItems=function(){this.ropeContainer.setY(-this.height/2-this.ropeContainer.height/2+.5),this.anchorKnot.setY(this.ropeContainer.y+this.ropeContainer.height/2),this.cup.setY(25.8),this.timerText.setPosition(0,this.height/2-this.timerText.height/2-3.5)},n.calculateTotalHeight=function(){var e=this.board.y,t=this.ropeContainer.y,n=this.board.height/2+e,i=t-this.ropeContainer.height/2,a=Math.abs(n)+Math.abs(i),r=this.height;this.setSize(this.width,a),this.extraHeight=(this.height-r)/2},n.createBoard=function(){this.board=this.scene.add.container(0,0),this.addAt(this.board,1),this.board.setSize(257/3,98),this.createPlayingBoard(),this.createWonBoard(),this.createLostBoard(),this.board.setX(-.4),this.setSize(this.board.width,this.board.height)},n.createPlayingBoard=function(){var e=this.scene.add.image(0,0,pb,fb.WEEKLY_TOURNAMENT.PLAYING_BOARD);e.setDefaultWorldSize(),this.board.add(e),this.playingBoard=e},n.createWonBoard=function(){var e=this.scene.add.image(0,0,pb,fb.WEEKLY_TOURNAMENT.WON_BOARD);e.setDefaultWorldSize(),this.board.add(e),this.wonBoard=e},n.createLostBoard=function(){var e=this.scene.add.image(0,0,pb,fb.WEEKLY_TOURNAMENT.LOST_BOARD);e.setDefaultWorldSize(),e.setY(-.5),this.board.add(e),this.lostBoard=e},n.createCup=function(){this.cup=this.scene.add.container(0,0),this.add(this.cup),this.createCupIcon(),this.createRankBlock()},n.createCupIcon=function(){var e=this.scene.add.image(0,0,pb,fb.WEEKLY_TOURNAMENT.CUP_ICON);e.setOrigin(.5,1),e.setDefaultWorldSize(),this.cup.add(e),this.cup.setSize(e.width,e.height)},n.createRankBlock=function(){this.rankBlock=new lb(this.scene),this.cup.add(this.rankBlock),this.rankBlock.setPosition(.5,-28)},n.createTimer=function(){this.timerText=new rS(this.scene),this.add(this.timerText)},t}($w),vb=gb,yb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.onClicked=!1,n.weeklyTournamentContent=void 0,n.openTweens=[],n.closeTweens=[],n.originBoardY=void 0,n.content=void 0,n.handleMouseDown=function(){n.onClicked||(n.onClicked=!0,n.weeklyTournamentContent.handleMouseDownAnim())},n.handleMouseUp=function(){n.onClicked&&(n.onClicked=!1,n.weeklyTournamentContent.handleMouseUpAnim(),n.handleButtonClick())},n.handleMouseOut=function(){n.onClicked&&(n.onClicked=!1,n.weeklyTournamentContent.handleMouseUpAnim())},n.handleButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.scene.screen.close(ce.o4.PLAY_SCREEN),t=n.scene.weeklyTournament,e.next=4,n.scene.requireTextureAsync("WEEKLY_TOURNAMENT");case 4:t.isWaiting()?n.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN,{previousScreen:ce.o4.PLAY_SCREEN}):t.isHappening()?n.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:ce.o4.PLAY_SCREEN}):t.isFinished()&&n.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN);case 5:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(257/3,98),n.create(),n.alignContent(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.weeklyTournament.isValid()){e.next=6;break}return this.revive(),e.next=4,this.weeklyTournamentContent.updateData();case 4:e.next=7;break;case 6:this.kill();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e;null==(e=this.closeTweens)||e.forEach((function(e){return e.stop()})),this.setY(0);var t=this.weeklyTournamentContent.rope;t.setScale(1,1);var n={y:{from:this.originBoardY-100,start:this.originBoardY-100,to:this.originBoardY},duration:400,easeParams:[.1,.7],ease:Phaser.Math.Easing.Elastic.Out},i={scaleX:.9,scaleY:1.5,yoyo:!0,duration:110,ease:Phaser.Math.Easing.Quadratic.InOut},r=this.scene.tweens.add((0,a.Z)({targets:this.content},n)),s=this.scene.tweens.add((0,a.Z)({targets:t},i));return this.openTweens.push(r,s),Promise.all(this.openTweens.map((function(e){return e.waitForCompletion()})))},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.weeklyTournamentContent.timerText.timerLogic.stopTimer(),e.next=3,this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),null==(n=this.openTweens)||n.forEach((function(e){return e.stop()})),this.closeTweens=[this.scene.add.tween({targets:[this],y:-this.scene.gameZone.height,duration:t,ease:Phaser.Math.Easing.Cubic.In})],e.next=5,Promise.all(this.closeTweens.map((function(e){return e.waitForCompletion()})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleMouseDown,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleMouseUp,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handleMouseOut,this)},n.create=function(){this.createWeeklyTournamentContent()},n.createWeeklyTournamentContent=function(){var e=this.scene.add.container(0,0);this.add(e),this.weeklyTournamentContent=new vb(this.scene),e.add(this.weeklyTournamentContent),e.setSize(this.weeklyTournamentContent.width,this.weeklyTournamentContent.height),this.content=e},n.alignContent=function(){this.setSize(this.content.width,this.content.height),this.setBoardY(this.content,this.weeklyTournamentContent.extraHeight,this.content.height),this.originBoardY=this.content.y},n.setBoardY=function(e,t,n){e.setY(t-Math.abs(n-e.height)/2)},t}(Phaser.GameObjects.Container),Eb=yb,Cb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.window=void 0,n.scene=t,n.setSize(265/3,395/3),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.close();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.prepareData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.window){e.next=5;break}return e.next=3,this.scene.requireTextureAsync("EVENT_BOARD",!1);case 3:this.window=new Eb(this.scene),this.add(this.window);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.window.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),Ab=Cb;function wb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Sb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sb(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Sb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var bb=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.weeklyTournamentWindow=void 0,n.boxingDuelWindow=void 0,n.offshoreRaceWindow=void 0,n.leftWindow=[],n.rightWindow=[],n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.weeklyTournamentWindow=new Ab(n.scene),n.offshoreRaceWindow=new sb(n.scene),n.boxingDuelWindow=new AS(n.scene),n.add([n.weeklyTournamentWindow,n.boxingDuelWindow,n.offshoreRaceWindow]),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateWindows();case 2:for(t=wb(this.leftWindow);!(n=t()).done;)n.value.open();for(i=wb(this.rightWindow);!(a=i()).done;)a.value.open();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.leftWindow.map(function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n=this.rightWindow.map(function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all([].concat(t,n));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateWindows=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.leftWindow=[],this.rightWindow=[],!this.scene.offshoreRace.isValid()){e.next=6;break}return e.next=5,this.offshoreRaceWindow.prepareData();case 5:this.leftWindow.push(this.offshoreRaceWindow);case 6:if(!this.scene.weeklyTournament.isValid()){e.next=10;break}return e.next=9,this.weeklyTournamentWindow.prepareData();case 9:this.rightWindow.push(this.weeklyTournamentWindow);case 10:if(!this.scene.boxingDuel.isValid()){e.next=14;break}return e.next=13,this.boxingDuelWindow.prepareData();case 13:this.rightWindow.push(this.boxingDuelWindow);case 14:this.alignLeftWindows(),this.alignRightWindows(),this.leftWindow.forEach(function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateData();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.rightWindow.forEach(function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateData();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignLeftWindows=function(){var e=-this.height/2-8;this.leftWindow.forEach((function(t){t.setPosition(-225.5,e+t.height/2),e=t.y+t.height-8}))},n.alignRightWindows=function(){var e=this,t=-this.height/2-8;this.rightWindow.forEach((function(e){e.setPosition(225.5,t+e.height/2),t=e.y+e.height/2-8}));var n=this.rightWindow[0];this.rightWindow.forEach((function(t){t!==n&&(e.moveBelow(t,n),n=t)}))},t}(Phaser.GameObjects.Container),Tb=bb,xb=function(e){function t(t){var n;return(n=e.call(this,t)||this).boostersContainer=void 0,n.create(),n}(0,s.Z)(t,e);var n=t.prototype;return n.setButtonsDisable=function(e){this.boostersContainer.setButtonsDisable(e)},n.create=function(){this.createBoosterContainer()},n.createBoosterContainer=function(){var e=this,t=new by(this.scene,ce.o4.PLAY_SCREEN);this.add(t),this.boostersContainer=t,t.onBoosterClick=function(t){t&&(e.scene.screen.close(ce.o4.PLAY_SCREEN),e.scene.screen.open(ce.o4.BUYING_BOOSTER_SCREEN,t))}},t}(Phaser.GameObjects.Container),Pb=xb,kb=Wi.Z.DEFAULT,Ib=kb.KEY,Ob=kb.FRAME,Rb=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.playContainer=void 0,s.readyToStartWC=!1,s.eventsWindow=void 0,s.glow2=void 0,s.glow3=void 0,s.boneGlow2=void 0,s.boneGlow3=void 0,s.entranceAnims=void 0,s.exitAnims=void 0,s.idleAnim=void 0,s.previousData=void 0,s.isScreenOpening=void 0,s.handleCancel=function(){s.scene.screen.close(s.name);var e=s.scene.level.getLevel();s.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{level:e}),s.scene.skipBackgroundChangingAnimation(),s.readyToStartWC=!1},s.startGame=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.scene.gameplay,n=s.playContainer.boostersContainer,i=n.sliceButton,a=n.stormButton,r=n.wildCardButton,o={slice:i.selected,storm:a.selected,wildCard:r.selected},s.setButtonsDisable(!0),s.scene.logEconomy.logEconomyTracking(),s.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON),s.scene.offshoreRace.setShouldCheckTime(!1),s.scene.events.emit("refresh-event-toggle",!1),t.boosterManager.enableBoosters(o),s.scene.screen.close(s.name),e.next=12,t.start();case 12:case"end":return e.stop()}}),e)}))),s.onEntranceCompleted=function(){var e,t=(null==(e=s.data)?void 0:e.list).level,n=void 0===t?1:t;s.showGuideAnimation(n),s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.isScreenOpening=!1},s.scene=t,s.create(),s.setDepth(ce.Ks.POPUP),s.background.setAlpha(.88),t.events.on(hi.WC_JOIN_BTN_CLICKED,(function(){s.readyToStartWC=!0})),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpening){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:e.prototype.open.call(this,n),this.isScreenOpening=!0,this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),n=n||this.previousData,this.previousData=n,this.updateData(n),this.runEntranceAnimation(),GameCore.layoutInitializer.isLandscape&&this.eventsWindow.open(),this.setButtonsDisable(!1),this.scene.preloadBackgroundAsync({useGameplayBackground:!0});case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateData=function(e){var t,n=this.playContainer.boostersContainer,i=n.sliceButton,a=n.stormButton,r=n.wildCardButton,s=null==(t=this.data)?void 0:t.list,o=s.level,c=void 0===o?1:o,h=s.difficulty,u=void 0===h?Vh.NORMAL:h,l=e,d=l.slice,p=l.storm,f=l.wildCard;this.checkShowGuides(),n.setLevel(c),n.setDifficulty(u),n.updateBoostersWithSettings(),i.updateData(d),a.updateData(p),r.updateData(f)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setButtonsDisable(!0),this.eventsWindow.close(),null==(t=this.idleAnim)||t.stop(),this.runExitAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkShowGuides=function(){var e=this.scene.gameplay.guideManager;e.guideLayout.isBoosterGuidePlaying()&&e.zone.setVisible(!0)},n.showGuideAnimation=function(e){var t=this.playContainer.boostersContainer,n=this.scene.gameplay.guideManager,i=this.playContainer.boostersContainer.playButton,a=t.sliceButton,r=t.stormButton,s=t.wildCardButton,o=this.scene.gameSettings.requiredLevels,c=o.boosterSlice,h=o.boosterStorm,u=o.boosterWildCard;switch(e){case c:return void n.guideLayout.showBoosterGuide(a,i,Yw.SLICE);case h:return void n.guideLayout.showBoosterGuide(r,i,Yw.STORM);case u:return void n.guideLayout.showBoosterGuide(s,i,Yw.WILD_CARD);default:return}},n.create=function(){this.createPlayContainer(),this.createEventsWindow(),this.createGlow2(),this.createGlow3(),this.playContainer.boostersContainer.closeButton.onClick=this.handleCancel,this.playContainer.boostersContainer.playButton.onClick=this.startGame,this.createIdleAnimation()},n.createPlayContainer=function(){this.playContainer=new Pb(this.scene),this.add(this.playContainer)},n.createEventsWindow=function(){this.eventsWindow=new Tb(this.scene),this.add(this.eventsWindow)},n.createGlow2=function(){var e=this.scene.add.container(26.6359/3,114.394-166.5);this.add(e),this.boneGlow2=e;var t=this.scene.add.image(-1.7267/3,-.1038,Ib,Ob.PLAY_SCREEN.EFFECTS.GLOW);t.setDefaultWorldSize(),t.setAlpha(0),t.setBlendMode(Phaser.BlendModes.ADD),e.add(t),this.glow2=t},n.createGlow3=function(){var e=this.scene.add.container(14.272,390.412/3-166.5);this.add(e),this.boneGlow3=e;var t=this.scene.add.image(-1.7267/3,-.1038,Ib,Ob.PLAY_SCREEN.EFFECTS.GLOW);t.setDefaultWorldSize(),t.setAlpha(0),t.setBlendMode(Phaser.BlendModes.ADD),e.add(t),this.glow3=t},n.setButtonsDisable=function(e){this.playContainer.setButtonsDisable(e)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),null==(t=this.idleAnim)||t.start(),e.next=4,this.playEntranceAnimation();case 4:this.onEntranceCompleted();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),e.next=3,this.playExitAnimation();case 3:this.onExitCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.exitAnims)||t.forEach((function(e){return e.stop()})),this.entranceAnims=[this.scene.add.tween({targets:[this.playContainer],duration:500,scale:{from:.5,to:1},alpha:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}),this.scene.add.tween({targets:[this],duration:150,alpha:{from:0,to:1}}),this.scene.add.tween({targets:[this.playContainer.boostersContainer.bgReward],duration:300,scale:{from:.9,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(){n.playContainer.boostersContainer.setBgRewardBlendModes(Phaser.BlendModes.NORMAL)},onComplete:function(){n.playContainer.boostersContainer.setBgRewardBlendModes(Phaser.BlendModes.ADD)}}),this.scene.add.tween({targets:[this.playContainer.boostersContainer.case],duration:300,scale:{from:.9,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})],e.next=4,Promise.all(this.entranceAnims.map((function(e){return e.waitForCompletion()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.playExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.entranceAnims)||t.forEach((function(e){return e.stop()})),this.exitAnims=[this.scene.add.tween({targets:[this.playContainer],scale:.75,ease:Phaser.Math.Easing.Back.In,duration:150}),this.scene.add.tween({targets:[this],alpha:0,duration:150,onStart:function(){n.scene.gameUI.coinBarButton.setDisabled(!1),n.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON)}})],e.next=4,Promise.all(this.exitAnims.map((function(e){return e.waitForCompletion()})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createIdleAnimation=function(){this.idleAnim=new Hw([{target:this.glow2,rgba:[{color:"ffffff00"},{time:.65,color:"60fff8f3",curve:"stepped"},{time:2.4,color:"60fff8f3"},{time:3.05,color:"ffffff00"}]},{target:this.glow3,rgba:[{time:.6667,color:"ffffff00"},{time:1.1167,color:"60fff8f3",curve:"stepped"},{time:2.3667,color:"60fff8f3"},{time:2.8333,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.rewardChestAdd,rgba:[{color:"ffffff00",curve:[.278,1,.556,1,.278,1,.556,1,.278,1,.556,1,.262,0,.595,.09]},{time:.8333,color:"ffffff18",curve:[1.111,1,1.389,1,1.111,1,1.389,1,1.111,1,1.389,1,1.111,.1,1.389,0]},{time:1.6667,color:"ffffff00",curve:[1.944,1,2.222,1,1.944,1,2.222,1,1.944,1,2.222,1,1.928,0,2.262,.09]},{time:2.5,color:"ffffff18",curve:[2.778,1,3.056,1,2.778,1,3.056,1,2.778,1,3.056,1,2.778,.1,3.056,0]},{time:3.3333,color:"ffffff00",curve:[3.611,1,3.889,1,3.611,1,3.889,1,3.611,1,3.889,1,3.595,0,3.929,.09]},{time:4.1667,color:"ffffff18",curve:[4.444,1,4.722,1,4.444,1,4.722,1,4.444,1,4.722,1,4.444,.1,4.722,0]},{time:5,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.rewardChestAdd2,rgba:[{color:"ffffff10",curve:[.113,1,.223,1,.113,1,.223,1,.113,1,.223,1,.114,.08,.225,.09]},{time:.3333,color:"ffffff18",curve:[.611,1,.889,1,.611,1,.889,1,.611,1,.889,1,.611,.1,.885,0]},{time:1.1667,color:"ffffff00",curve:[1.334,1,1.5,1,1.334,1,1.5,1,1.334,1,1.5,1,1.329,0,1.5,.04]},{time:1.6667,color:"ffffff10",curve:[1.78,1,1.89,1,1.78,1,1.89,1,1.78,1,1.89,1,1.78,.08,1.892,.09]},{time:2,color:"ffffff18",curve:[2.278,1,2.556,1,2.278,1,2.556,1,2.278,1,2.556,1,2.278,.1,2.552,0]},{time:2.8333,color:"ffffff00",curve:[3.001,1,3.167,1,3.001,1,3.167,1,3.001,1,3.167,1,2.995,0,3.167,.04]},{time:3.3333,color:"ffffff10",curve:[3.446,1,3.556,1,3.446,1,3.556,1,3.446,1,3.556,1,3.447,.08,3.559,.09]},{time:3.6667,color:"ffffff18",curve:[3.944,1,4.222,1,3.944,1,4.222,1,3.944,1,4.222,1,3.944,.1,4.218,0]},{time:4.5,color:"ffffff00",curve:[4.668,1,4.835,1,4.668,1,4.835,1,4.668,1,4.835,1,4.662,0,4.832,.03]},{time:5,color:"ffffff10"}]},{target:this.playContainer.boostersContainer.star,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.star2,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.star3,rgba:[{color:"ffffffff"}]},{target:this.playContainer.boostersContainer.topCaseAdd1,rgba:[{time:1.05,color:"ffffff00",curve:[1.384,1,1.716,1,1.384,1,1.716,1,1.384,1,1.716,1,1.187,.05,1.716,.21]},{time:2.05,color:"ffffff37",curve:[2.384,1,2.716,1,2.384,1,2.716,1,2.384,1,2.716,1,2.384,.21,2.716,.05]},{time:3.05,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd2,rgba:[{time:1.6,color:"ffffff00",curve:[1.934,1,2.266,1,1.934,1,2.266,1,1.934,1,2.266,1,1.737,.05,2.266,.21]},{time:2.6,color:"ffffff37",curve:[2.934,1,3.266,1,2.934,1,3.266,1,2.934,1,3.266,1,2.934,.21,3.266,.05]},{time:3.6,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd3,rgba:[{time:2.2,color:"ffffff00",curve:[2.534,1,2.866,1,2.534,1,2.866,1,2.534,1,2.866,1,2.337,.05,2.866,.21]},{time:3.2,color:"ffffff37",curve:[3.556,1,3.911,1,3.556,1,3.911,1,3.556,1,3.911,1,3.556,.21,3.911,.05]},{time:4.2667,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.topCaseAdd4,rgba:[{time:2.8833,color:"ffffff00",curve:[3.217,1,3.549,1,3.217,1,3.549,1,3.217,1,3.549,1,3.021,.05,3.549,.21]},{time:3.8833,color:"ffffff37",curve:[4.256,1,4.627,1,4.256,1,4.627,1,4.256,1,4.627,1,4.256,.21,4.627,.05]},{time:5,color:"ffffff00"}]},{target:this.playContainer.boostersContainer.boneStar,rotate:[{value:-24.94},{time:1,value:-62.8},{time:1.6667,value:-24.94},{time:2.6667,value:-62.8},{time:3.3333,value:-24.94},{time:4.3333,value:-62.8}],scale:[{x:0,y:0,curve:[.032,.593,.335,1,.032,.593,.335,1]},{time:.5,curve:[.701,1,.835,.333,.701,1,.835,.333]},{time:1,x:0,y:0,curve:"stepped"},{time:1.6667,x:0,y:0,curve:[1.699,.593,2.001,1,1.699,.593,2.001,1]},{time:2.1667,curve:[2.368,1,2.501,.333,2.368,1,2.501,.333]},{time:2.6667,x:0,y:0,curve:"stepped"},{time:3.3333,x:0,y:0,curve:[3.366,.593,3.668,1,3.366,.593,3.668,1]},{time:3.8333,curve:[4.034,1,4.168,.333,4.034,1,4.168,.333]},{time:4.3333,x:0,y:0}]},{target:this.playContainer.boostersContainer.boneStar2,rotate:[{value:-24.94,curve:"stepped"},{time:4,value:-24.94},{time:5,value:-62.8}],scale:[{x:0,y:0,curve:"stepped"},{time:.6667,x:0,y:0,curve:[.699,.593,1.001,1,.699,.593,1.001,1]},{time:1.1667,curve:[1.368,1,1.5,0,1.368,1,1.5,0]},{time:1.6667,x:0,y:0,curve:"stepped"},{time:2.3333,x:0,y:0,curve:[2.366,.593,2.668,1,2.366,.593,2.668,1]},{time:2.8333,curve:[3.034,1,3.167,0,3.034,1,3.167,0]},{time:3.3333,x:0,y:0,curve:"stepped"},{time:4,x:0,y:0,curve:[4.032,.593,4.335,1,4.032,.593,4.335,1]},{time:4.5,curve:[4.701,1,4.835,.333,4.701,1,4.835,.333]},{time:5,x:0,y:0}]},{target:this.playContainer.boostersContainer.boneStar3,rotate:[{value:-43.87},{time:.5,value:-62.8},{time:1.1667,value:-24.94},{time:1.6667,value:-43.87},{time:2.1667,value:-62.8},{time:2.8333,value:-24.94},{time:3.3333,value:-43.87},{time:3.8333,value:-62.8},{time:4.5,value:-24.94},{time:5,value:-43.87}],scale:[{curve:[.201,1,.335,.333,.201,1,.335,.333]},{time:.5,x:0,y:0,curve:"stepped"},{time:1.1667,x:0,y:0,curve:[1.199,.593,1.5,1,1.199,.593,1.5,1]},{time:1.6667,curve:[1.868,1,2.001,.333,1.868,1,2.001,.333]},{time:2.1667,x:0,y:0,curve:"stepped"},{time:2.8333,x:0,y:0,curve:[2.866,.593,3.167,1,2.866,.593,3.167,1]},{time:3.3333,curve:[3.534,1,3.668,.333,3.534,1,3.668,.333]},{time:3.8333,x:0,y:0,curve:"stepped"},{time:4.5,x:0,y:0,curve:[4.532,.593,4.835,1,4.532,.593,4.835,1]},{time:5}]},{target:this.boneGlow2,rotate:[{value:10.5}],translate:[{x:-34.46,y:-6.11,curve:[1.015,-34.46,2.035,116.17,1.015,-6.11,2.035,21.12]},{time:3.05,x:116.17,y:21.12}],scale:[{x:.219,y:.024,curve:[.211,.123,.662,.654,.207,.019,.662,.043]},{time:1,x:.654,y:.043,curve:"stepped"},{time:2.05,x:.654,y:.043,curve:[2.388,.654,2.718,.369,2.388,.043,2.718,.03]},{time:3.05,x:.219,y:.024}]},{target:this.boneGlow3,rotate:[{value:10.5}],translate:[{x:-34.46,y:-6.11,curve:"stepped"},{time:.6667,x:-34.46,y:-6.11,curve:[.705,-34.46,2.112,20.77,.705,-6.11,2.112,3.87]},{time:2.8333,x:20.77,y:3.87}],scale:[{x:.219,y:.024,curve:"stepped"},{time:.6667,x:.219,y:.024,curve:[1.265,.23,1.263,.379,1.265,.024,1.263,.043]},{time:1.5667,x:.379,y:.043,curve:"stepped"},{time:2.1167,x:.379,y:.043},{time:2.8333,x:.219,y:.024}]}]),this.idleAnim.setLoop(-1)},t}(GameCore.Screen),Bb=Rb,Db=n(95),Lb=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m,g;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=n||{}).startNumber,r=void 0===a?0:a,s=i.endNumber,o=void 0===s?100:s,h=i.duration,u=void 0===h?1e3:h,l=i.completeDelay,d=void 0===l?0:l,p=i.onUpdate,f=i.onStart,m=i.ease,g=void 0===m?Phaser.Math.Easing.Sine.InOut:m,e.abrupt("return",new Promise((function(e){t.tweens.addCounter({from:r,to:o,duration:u,completeDelay:d,ease:g,onStart:f,onUpdate:p,onComplete:function(){e()}})})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_b=Lb,Mb=Wi.Z.DEFAULT,Nb=Mb.KEY,Gb=Mb.FRAME,Zb=Wi.Z.DASHBOARD,Fb=Zb.KEY,Ub=Zb.FRAME,Wb=310,Hb=305,Yb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.mainIcon=void 0,n.coinValue=void 0,n.noThanksButton=void 0,n.claimButton=void 0,n.claimX3Button=void 0,n.coinText=void 0,n.coinIcon=void 0,n.starEmitter=void 0,n.starEmitZone=void 0,n.scene=t,n.setSize(Wb,Hb),n.create(),n.alignItems(),n.setInteractive(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=[{obj:this.mainIcon,scale:this.mainIcon.scale},{obj:this.coinValue,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,a=e.scale;i.setScale(0),t.add({targets:[i],scale:{start:0,from:0,to:a},ease:Phaser.Math.Easing.Back.Out,duration:250,offset:0==n?0:"-=200"})})),t.play()},n.runClaimedCoinX3IncreaseAnimation=function(e){var t=this,n=3*e;return _b(this.scene,{startNumber:e,endNumber:n,duration:700,onUpdate:function(e){var n=Math.floor(e.getValue());t.updateClaimedCoinText(n)}})},n.runCoinValueBounceAnimation=function(){var e=this.scene.tweens.add({targets:this.coinValue,scale:{from:1,start:1,to:1.2},duration:300,ease:Phaser.Math.Easing.Sine.In}).waitForCompletion(),t=this.scene.tweens.add({targets:this.coinValue,scale:{from:1.2,start:1.2,to:1},duration:200,ease:Phaser.Math.Easing.Back.Out,delay:300}).waitForCompletion();return Promise.all([e,t])},n.runHideButtonAnimation=function(){return this.scene.tweens.add({targets:[this.claimButton],alpha:0,duration:400,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion()},n.updateClaimedCoinText=function(e){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.coinText.setText(""+t),this.coinValue.setSize(this.coinText.width+this.coinIcon.width+6,this.coinIcon.height),Phaser.Display.Align.In.LeftCenter(this.coinIcon,this.coinValue),Phaser.Display.Align.In.RightCenter(this.coinText,this.coinValue,-1.4,.5)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,0),Phaser.Display.Align.In.Center(this.mainIcon,this,.5,-45.7),Phaser.Display.Align.In.Center(this.coinValue,this,0,11.2),Phaser.Display.Align.In.BottomCenter(this.claimButton,this,0,-14);var e=this.mainIcon.getWorldPosition(),t=e.x,n=e.y;this.updateEmittersPosition(t,n)},n.create=function(){this.createTitleText(),this.createMainIcon(),this.createCoinValue(),this.createClaimX3Button(),this.createClaimButton(),this.createStarParticle()},n.createTitleText=function(){this.titleText=new Pf(this.scene),this.titleText.setText("Welcome Back!"),this.titleText.setFontSize(40),this.titleText.setRadius(-1138),this.titleText.setLetterSpacing(.05),this.titleText.setOrigin(.5,.5),this.add(this.titleText)},n.createMainIcon=function(){var e=this.scene.add.image(0,0,Fb,Ub.ICON.NEW_COINS);e.setDefaultWorldSize(),this.add(e),this.mainIcon=e},n.createCoinValue=function(){this.coinValue=this.scene.add.container(),this.add(this.coinValue);var e=new jp(this.scene,{text:"1000",fontSize:this.scene.fontSize(15),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:.15});this.coinValue.add(e);var t=this.scene.add.image(0,0,Fb,Ub.ICON.COIN);t.setWorldSize(25,25),this.coinValue.add(t),this.coinValue.setSize(107,t.height),Phaser.Display.Align.In.LeftCenter(t,this.coinValue),Phaser.Display.Align.In.RightCenter(e,this.coinValue),this.coinText=e,this.coinIcon=t},n.createNoThanksButton=function(){var e=new Kp.Z(this.scene,117,124/3);this.add(e),this.noThanksButton=e,this.noThanksButton.setName("Claim");var t=this.scene.add.image(0,0,Fb,Ub.WELCOME_BACK.NO_THANKS);t.setDefaultWorldSize(),t.setPosition(0,-1.2),this.noThanksButton.add(t)},n.createClaimButton=function(){var e=new iy(this.scene,{key:Wi.Z.DASHBOARD.KEY,buttonFrame:Wi.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_GREEN_SHADOW,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117.5});this.add(e),this.claimButton=e,this.claimButton.button.setName("Claim");var t=new jp(this.scene,{text:"Claim",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2.3,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:-.2});t.setPosition(0,-1.2),this.claimButton.addIntoButton(t),this.claimButton.setScale(.8)},n.createClaimX3Button=function(){var e=new iy(this.scene,{key:Wi.Z.DASHBOARD.KEY,buttonFrame:Wi.Z.DASHBOARD.FRAME.BUTTON.BUTTON.NEW_BLUE,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117.5});this.add(e),this.claimX3Button=e,this.claimX3Button.button.setName("ClaimX3");var t=this.scene.add.image(0,0,Nb,Gb.GET_MORE_COIN_SCREEN.NEW_ICON_AD);t.setDefaultWorldSize(),t.setPosition(-32.9,-.25),this.claimX3Button.addIntoButton(t);var n=new jp(this.scene,{text:"+200%",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2.3,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:-.2});n.setPosition(16,-1.2),this.claimX3Button.addIntoButton(n),this.claimX3Button.setDisabled(!0),this.claimX3Button.setVisible(!1)},n.updateEmittersPosition=function(e,t){this.starEmitZone.setTo(e-96,t+38,e+96,t+38,e,t-50)},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,Nb,Gb.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e),this.starEmitZone=new Phaser.Geom.Triangle;var t=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:Gb.EFFECTS.STAR_2,emitZone:{source:this.starEmitZone,type:"random"},frequency:100,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.InOut},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:t/2,max:1.5*t})},particleClass:Db.Z,quantity:1})},n.runParticle=function(){this.starEmitter.start()},n.stopParticle=function(){this.starEmitter.stop()},t}(Phaser.GameObjects.Container),Kb=Yb,zb=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.welcomeBackContainer=void 0,s.claimedCoinX1=void 0,s.claimedCoinX3=void 0,s.isOpening=void 0,s.handleClaim=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.handleClaimSuccess(s.claimedCoinX1);case 1:case"end":return e.stop()}}),e)}))),s.handleClaimX3=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.scene.showRewardedVideoAsync();case 2:e.sent?s.handleClaimSuccess(s.claimedCoinX3):s.handleClaimSuccess(s.claimedCoinX1);case 4:case"end":return e.stop()}}),e)}))),s.handleClaimSuccess=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(new Date).getTime(),s.scene.player.setLastWelcomeBackRewardTime(n),i=s.welcomeBackContainer.coinValue.getWorldPosition(),a=i.x,r=i.y,o=t/s.claimedCoinX1,h=1===o?14:21,3!==o){e.next=12;break}return s.setButtonsDisable(!0),s.welcomeBackContainer.runHideButtonAnimation(),e.next=10,s.welcomeBackContainer.runClaimedCoinX3IncreaseAnimation(s.claimedCoinX1);case 10:return e.next=12,s.welcomeBackContainer.runCoinValueBounceAnimation();case 12:if(s.scene.tweens.add({targets:s.welcomeBackContainer,alpha:0,duration:500,ease:Phaser.Math.Easing.Back.Out}),s.scene.gameUI.isCoinShowing()){e.next=18;break}return s.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),e.next=18,s.scene.gameUI.showCoin();case 18:s.scene.rewardManager.rewardCoin(t),s.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(h,a,r).then((function(){s.scene.screen.close(s.name)})),u=3===o?gl.WELCOME_BACK_AD:gl.WELCOME_BACK,s.scene.logEconomy.logGetItem(fl.COIN,t,u);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.isOpening=!1,s.welcomeBackContainer.setAlpha(1),s.welcomeBackContainer.setScale(1)},s.scene=t,s.create(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),s.listenEvents(),s.isOpening=!1,yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.welcomeBackContainer,t=e.claimButton;e.claimX3Button;t.onClick=this.handleClaim},n.create=function(){var e=new Kb(this.scene);this.add(e),this.welcomeBackContainer=e},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOpening){t.next=2;break}return t.abrupt("return");case 2:e.prototype.open.call(this,n),this.isOpening=!0,this.updateData(),this.setButtonsDisable(!1),this.runEntranceAnimation(),this.welcomeBackContainer.runEntranceAnimation(),this.welcomeBackContainer.runParticle();case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateData=function(){var e=pf.instance.reward.welcomeBackOffer;this.claimedCoinX1=e,this.claimedCoinX3=3*e,this.welcomeBackContainer.updateClaimedCoinText(e)},n.setButtonsDisable=function(e){var t=this.welcomeBackContainer,n=t.claimButton;t.claimX3Button;n.setDisabled(e),n.setAlpha(1)},n.close=function(){this.background.off(Phaser.Input.Events.POINTER_DOWN),this.setButtonsDisable(!0),this.runExitAnimation(),this.welcomeBackContainer.stopParticle()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.welcomeBackContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),Vb=zb,jb=Wi.Z.WEEKLY_TOURNAMENT,Xb=jb.KEY,qb=jb.FRAME,Jb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.clock=void 0,n.minuteHand=void 0,n.clockHandAnimation=void 0,n.scene=t,n.create(),n.setSize(n.clock.width,n.clock.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.animate=function(){this.createClockHandAnimation()},n.stopAnimation=function(){var e;null==(e=this.clockHandAnimation)||e.stop(),this.minuteHand.setAngle(0)},n.create=function(){this.createClock(),this.createHourHand(),this.createMinuteHand(),this.createRedDot()},n.createClock=function(){var e=this.scene.add.image(0,0,Xb,qb.COMMON.CLOCK);e.setDefaultWorldSize(),this.add(e),this.clock=e},n.createHourHand=function(){var e=this.scene.add.image(0,0,Xb,qb.COMMON.CLOCK_HAND);e.setOrigin(.5,.1),e.setDefaultWorldSize(),e.setY(-.5),e.setAngle(180),this.add(e)},n.createMinuteHand=function(){var e=this.scene.add.image(0,0,Xb,qb.COMMON.CLOCK_HAND);e.setOrigin(.5,.1),e.setDefaultWorldSize(),e.setY(-.5),this.add(e),this.minuteHand=e},n.createRedDot=function(){var e=this.scene.add.image(0,0,Xb,qb.COMMON.RED_DOT);e.setDefaultWorldSize(),e.setScale(1.05*e.scale),e.setY(-.5),this.add(e)},n.createClockHandAnimation=function(){var e;null==(e=this.clockHandAnimation)||e.stop(),this.clockHandAnimation=this.scene.tweens.createTimeline({targets:this.minuteHand,loop:-1}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.add({targets:this.minuteHand,angle:"+=90",duration:200,delay:800,ease:Phaser.Math.Easing.Back.Out,easeParams:[2]}),this.clockHandAnimation.play()},t}(Phaser.GameObjects.Container),Qb=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(229/3,59/3)},n.createText=function(){this.txt=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"23:59:59",origin:{x:.5,y:.5}}),this.txt.setPosition(9,-.5),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new $b(this)},n.setText=function(e){this.txt.setText(e)},t}(Phaser.GameObjects.Container),$b=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.status="Finished",t.countdownTimer.remove(),t.timerPanel.emit("finished");else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")}t.timerPanel.txt.setText(t.status)}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.setTimerStatus=function(e){var t;null==(t=this.countdownTimer)||t.remove(),this.status=e,this.timerPanel.txt.setText(e)},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),eT=function(e){function t(t,n){var i;(i=e.call(this,t)||this).buttonWidth=void 0,i.buttonHeight=void 0,i.buttonInnerWidth=void 0,i.buttonInnerHeight=void 0,i.button=void 0,i.background=void 0;var a=n.key,r=n.backgroundFrame,s=n.buttonFrame,o=n.buttonWidth,c=n.buttonHeight,h=n.buttonInnerWidth,u=n.buttonInnerHeight;return i.buttonWidth=o,i.buttonHeight=c,i.buttonInnerWidth=h||0,i.buttonInnerHeight=u||0,i.setSize(i.buttonWidth,i.buttonHeight),i.createBackground(a,r),i.createButton(a,s),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignBackground=function(e,t){this.background.setPosition(e,t)},n.createBackground=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:this.width,height:this.height});this.add(n),this.background=n},n.createButton=function(e,t){var n=this.scene.make.nineslice({key:e,frame:t,leftWidth:12,rightWidth:12,width:0==this.buttonInnerWidth?this.width-19/3:this.buttonInnerWidth,height:0==this.buttonInnerHeight?this.height-23/3:this.buttonInnerHeight});this.button=new Kp.Z(this.scene,n.displayWidth,n.displayHeight,.95),this.add(this.button),this.button.add(n)},n.setDisabled=function(e){this.button.setDisabled(e)},n.addIntoButton=function(e){this.button.add(e)},(0,H.Z)(t,[{key:"onClick",set:function(e){this.button.onClick=e}}]),t}(Phaser.GameObjects.Container),tT=eT,nT=Wi.Z.WEEKLY_TOURNAMENT,iT=nT.KEY,aT=nT.FRAME,rT=function(e){function t(t){var n;return(n=e.call(this,t,{key:iT,backgroundFrame:aT.INTRODUCTION.BUTTON.BASE,buttonFrame:aT.INTRODUCTION.BUTTON.GREEN,buttonWidth:170,buttonHeight:137/3,buttonInnerWidth:436/3,buttonInnerHeight:41})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.alignBackground(0,-.5),n.setSize(n.width,n.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new jp(this.scene,{text:"Play",fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},t}(tT),sT=rT,oT=Wi.Z.WEEKLY_TOURNAMENT,cT=oT.KEY,hT=oT.FRAME,uT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.header=void 0,i.playButton=void 0,i.timerPanel=void 0,i.closeButton=void 0,i.animateClock=void 0,i.handlePlayButton=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.scene.weeklyTournament,n=i.screen.previousScreen,i.screen.previousScreen=void 0,i.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN),!t.isWaiting()){e.next=11;break}return e.next=7,i.scene.joinTournament(!1,ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 7:"success"==e.sent?i.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:n}):(i.scene.weeklyTournament.setStatus(wo.WAITING),i.scene.screen.open(n||ce.o4.DASHBOARD_SCREEN)),e.next=12;break;case 11:i.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,{previousScreen:n});case 12:case"end":return e.stop()}}),e)}))),i.handleCloseButton=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 1:case"end":return e.stop()}}),e)}))),i.scene=t,i.screen=n,i.setSize(374,277),i.create(),i.alignItems(),i.listenEvents(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setAlpha(1),this.updateData();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){this.playButton.onClick=this.handlePlayButton,this.closeButton.onClick=this.handleCloseButton},n.create=function(){this.createBackground(),this.createCloseButton(),this.createHeader(),this.createPlayButton(),this.createDescription(),this.createTimer()},n.createBackground=function(){var e=new uy(this.scene,{key:cT,frame:hT.INTRODUCTION.POPUP,width:1247/3,height:871/3,topHeight:140/3,bottomHeight:160/3});this.add(e),this.setSize(e.displayWidth,e.displayHeight);var t=this.scene.add.image(0,0,cT,hT.INTRODUCTION.THUMBNAIL);t.setDefaultWorldSize(),this.add(t),t.setY(1.5)},n.createCloseButton=function(){var e=new iv.Z(this.scene,{key:cT,frame:hT.INTRODUCTION.CLOSE,width:40/3,height:14,paddingZone:30});e.setName("Close"),this.add(e),Phaser.Display.Align.In.TopRight(e,this,-18,-26.5),this.closeButton=e},n.createHeader=function(){var e=this.scene.add.container(0,0);e.setSize(896/3,69),this.add(e);var t=this.scene.add.image(0,0,cT,hT.INTRODUCTION.HEADER_BG);t.setWorldSize(989/3,58),e.add(t);var n=new Pf(this.scene);n.setText("Weekly Tournament"),n.setFontSize(22),n.setRadius(-1500),n.setLetterSpacing(-.2),n.setPosition(0,-1.5),e.add(n),this.header=e},n.createPlayButton=function(){var e=new sT(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.createDescription=function(){var e=new jp(this.scene,{text:"Participate in the tournament to win\ngreat rewards!",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setLineSpacing(1.4),e.setCenterAlign(),e.setY(-this.height/2+51),this.add(e)},n.createTimer=function(){this.timerPanel=new Qb(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,cT,hT.INTRODUCTION.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0),this.animateClock=new Jb(this.scene),this.animateClock.setPosition(-29,0),this.timerPanel.addAt(this.animateClock,1),this.timerPanel.setY(this.height/2-47),this.timerPanel.setX(2)},n.alignItems=function(){this.header.setY(-this.height/2-5),this.playButton.setPosition(1,this.height/2-5)},t}(Phaser.GameObjects.Container),lT=uT,dT=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.welcomeWeeklyTournamentContainer=void 0,r.previousScreen=void 0,r.close=function(){r.background.off(Phaser.Input.Events.POINTER_DOWN),r.runExitAnimation()},r.onEntranceCompleted=function(){r.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){r.scene.screen.close(r.name)}))},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r)),r.scene.gameUI.coinBarButton.setDisabled(!1),r.welcomeWeeklyTournamentContainer.animateClock.stopAnimation(),r.previousScreen&&r.scene.screen.open(r.previousScreen)},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWelcomeWeeklyTournamentContainer()},n.createWelcomeWeeklyTournamentContainer=function(){this.welcomeWeeklyTournamentContainer=new lT(this.scene,this),this.welcomeWeeklyTournamentContainer.setInteractive(),this.add(this.welcomeWeeklyTournamentContainer),Phaser.Display.Align.In.Center(this.welcomeWeeklyTournamentContainer,this,0,7)},n.open=function(t){e.prototype.open.call(this,t);var n=(null!=t?t:{previousScreen:ce.o4.DASHBOARD_SCREEN}).previousScreen;this.previousScreen=n,this.welcomeWeeklyTournamentContainer.open(),this.runEntranceAnimation(),this.updateTimer()},n.updateTimer=function(){var e=this.scene.weeklyTournament.getRemainingTime();this.welcomeWeeklyTournamentContainer.timerPanel.timerLogic.setRemainingTime(e),this.welcomeWeeklyTournamentContainer.animateClock.animate()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.welcomeWeeklyTournamentContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.welcomeWeeklyTournamentContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),pT=dT,fT=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t)||this).scene=void 0,r.tutorialImage=void 0,r.tutorialText=void 0,r.scene=t,r.setSize(40,40),r.createTutorialImage(n,i),r.createTutorialText(a),r.alignItems(),t.add.existing((0,fc.Z)(r)),r}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1/GameCore.ImageScale,a=this.scene.tweens.add({targets:this.tutorialImage,delay:t,duration:n,scale:{from:0,start:0,to:i},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){o.revive(),o.tutorialImage.setScale(0),o.tutorialImage.setAlpha(1)}}).waitForCompletion(),r=this.tutorialText.y,s=this.scene.tweens.add({targets:this.tutorialText,delay:t+100,duration:n-100,scale:{from:0,start:0,to:1},y:{from:r-20,start:r-20,to:r+0},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){o.tutorialText.setScale(0),o.tutorialText.setAlpha(1)}}).waitForCompletion(),e.abrupt("return",Promise.all([a,s]));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.tutorialImage.width,t=this.tutorialText.height;this.setSize(e,t),Phaser.Display.Align.In.TopCenter(this.tutorialText,this),this.tutorialImage.setY(this.tutorialText.y-this.tutorialText.height/2-Math.max(this.tutorialImage.height/2,50))},n.createTutorialImage=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setDefaultWorldSize(),this.add(n),this.tutorialImage=n},n.createTutorialText=function(e){var t=new jp(this.scene,{text:e,fontSize:this.scene.fontSize(15),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setOrigin(.5,0),t.setCenterAlign(),this.add(t),this.tutorialText=t},t}(Phaser.GameObjects.Container),mT=fT,gT=function(e){function t(t,n){var i;return void 0===n&&(n=.925),(i=e.call(this,t,t.gameZone.width,t.gameZone.height,n)||this).children=[],i.text=void 0,i.createText(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=new jp(this.scene,{text:"Tap to claim",fontSize:this.scene.fontSize(24),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setAlpha(.5),this.add(e),this.text=e},n.add=function(t){var n;e.prototype.add.call(this,t);var i=Array.isArray(t)?t:[t];return(n=this.children).push.apply(n,i),this},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this.children,scale:this.scaleDown,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this.children,scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(t){e.disable&&(t.remove(),e.setScale(1))},onUpdate:function(t){e.disable&&(t.remove(),e.setScale(1))}})},t}(Kp.Z),vT=gT,yT=Wi.Z.BOXING_DUEL,ET=yT.KEY,CT=yT.FRAME,AT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.Center(this.step1,this,-170,60),Phaser.Display.Align.In.Center(this.step2,this,0,60),Phaser.Display.Align.In.Center(this.step3,this,190,60),Phaser.Display.Align.In.Center(this.arrow1,this,-90,10),Phaser.Display.Align.In.Center(this.arrow2,this,95,10)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[CT.INTRO.ITEM_1,CT.INTRO.ITEM_2,CT.INTRO.ITEM_3],n=["Collect gloves!","Beat your opponent!","Win the match!"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,ET,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,ET,CT.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),wT=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new AT(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),ST=Wi.Z.BOXING_DUEL,bT=ST.KEY,TT=ST.FRAME,xT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-70,-50),Phaser.Display.Align.In.Center(this.step2,this,90,60),Phaser.Display.Align.In.Center(this.step3,this,-80,190),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,110),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height+20;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[TT.INTRO.ITEM_1,TT.INTRO.ITEM_2,TT.INTRO.ITEM_3],n=["Collect gloves!","Beat your opponent!","Win the match!"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,bT,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[TT.INTRO.ARROW_RIGHT,TT.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var a=e.scene.add.image(0,0,bT,t[i]);return a.setDefaultWorldSize(),a}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),PT=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new xT(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),kT=GameCore.layoutInitializer.isLandscape?wT:PT,IT=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=new jp(this.scene,{text:"23:59:59",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeAlpha:.9,fillColor:16777215}),this.txt.setPosition(0,9),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new OT(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),OT=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",11),t.countdownTimer.remove();else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},t.formatUnitTime=function(e){return e<10?"0"+e:e.toString()},e}(),RT=680/3,BT=85/3,DT=Wi.Z.BOXING_DUEL,LT=DT.KEY,_T=DT.FRAME,MT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.minProgressWidth=void 0,n.maxProgressWidth=void 0,n.progressHeight=void 0,n.redProgress=void 0,n.blueProgress=void 0,n.gloves=void 0,n.blueText=void 0,n.redText=void 0,n.redGlove=void 0,n.blueGlove=void 0,n.blueScore=0,n.redScore=0,n.progressAnimation=void 0,n.progressDuration=500,n.gloveDuration=200,n.scoreCounterAnimation=void 0,n.progressBarAnimation=void 0,n.scene=t,n.setSize(RT,BT),n.minProgressWidth=170/3,n.maxProgressWidth=RT-n.minProgressWidth,n.progressHeight=41/3,n.createBackground(),n.createBlueProgress(),n.createRedProgress(),n.createGloves(),n.bringToTop(n.blueText),n.bringToTop(n.redText),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateProgressBar=function(e,t,n){var i,a;null==(i=this.progressAnimation)||i.stop(),null==(a=this.scoreCounterAnimation)||a.stop(),this.progressDuration=n?250:1e3,this.runScoreAnimation(e,t),this.runProgressBarAnimation(e,t)},n.runScoreAnimation=function(e,t){var n=this,i=this.blueScore.valueOf(),a=this.redScore.valueOf();this.scoreCounterAnimation=this.scene.tweens.addCounter({from:0,to:1,ease:Phaser.Math.Easing.Sine.InOut,duration:this.progressDuration,onUpdate:function(r){var s=i+(e-i)*r.getValue(),o=a+(t-a)*r.getValue();n.updateScores(s,o)},onStop:function(){n.updateScores(e,t)}})},n.runProgressBarAnimation=function(e,t){var n=this,i=this.blueProgress.displayWidth,a=this.redProgress.displayWidth,r=this.calculateProgressLengths(e,t),s=r.lengthBlue,o=r.lengthRed;this.progressBarAnimation=this.scene.tweens.addCounter({from:0,to:1,ease:Phaser.Math.Easing.Sine.InOut,duration:this.progressDuration,onStart:function(){i==a&&e!=t&&n.runMergeGlovesAnim(),e>t?(n.updateAlphaGlove([n.blueGlove],1),n.updateAlphaGlove([n.redGlove],0)):e<t?(n.updateAlphaGlove([n.redGlove],1),n.updateAlphaGlove([n.blueGlove],0)):n.updateAlphaGlove([n.blueGlove,n.redGlove],1)},onUpdate:function(e){var t=i+(s-i)*e.getValue(),r=a+(o-a)*e.getValue();n.blueProgress.setSizeByWorld(t,n.progressHeight),n.redProgress.setSizeByWorld(r,n.progressHeight),n.gloves.setX(n.blueProgress.x+n.blueProgress.displayWidth)},onComplete:function(){e==t&&n.runSplitGlovesAnim()},onStop:function(){n.blueProgress.setSizeByWorld(s,n.progressHeight),n.redProgress.setSizeByWorld(o,n.progressHeight),n.blueGlove.setX(n.blueProgress.x+n.blueProgress.displayWidth),n.redGlove.setX(n.redProgress.x-n.redProgress.displayWidth),e==t?(n.blueGlove.setX(-13),n.redGlove.setX(13),n.blueGlove.setAlpha(1),n.redGlove.setAlpha(1)):(n.blueGlove.setAlpha(e>t?1:0),n.redGlove.setAlpha(e<t?1:0))}})},n.updateScores=function(e,t){this.blueScore=e,this.redScore=t,this.blueText.setText(""+Math.round(this.blueScore)),this.redText.setText(""+Math.round(this.redScore));var n=(-87.33333333333333+(-109.33333333333333+this.blueProgress.displayWidth-5))/2;this.blueText.setX(n);var i=(87.33333333333333+(109.33333333333333-this.redProgress.displayWidth+5))/2;this.redText.setX(i)},n.calculateProgressLengths=function(e,t){var n=656/3,i=e+t;if(0==i)return{lengthBlue:n/2,lengthRed:n/2};var a=e/i*n,r=t/i*n;return a<70?r=n-(a=70):r<70&&(a=n-(r=70)),{lengthBlue:a,lengthRed:r}},n.updateAlphaGlove=function(e,t){this.scene.tweens.add({targets:[].concat(e),alpha:t,duration:this.gloveDuration})},n.runMergeGlovesAnim=function(){this.scene.tweens.add({targets:[this.blueGlove,this.redGlove],x:0,duration:this.gloveDuration})},n.runSplitGlovesAnim=function(){this.scene.tweens.add({targets:[this.blueGlove],alpha:1,x:-13,duration:this.gloveDuration}),this.scene.tweens.add({targets:[this.redGlove],alpha:1,x:13,duration:this.gloveDuration})},n.updateProgress=function(){var e=this.blueScore,t=this.redScore,n=(e+20)/(e+t+40)*100;n>100&&(n=100);var i=this.maxProgressWidth-this.minProgressWidth,a=Math.floor(n/100*i),r=Phaser.Math.Clamp(this.minProgressWidth+a,this.minProgressWidth,this.maxProgressWidth),s=Phaser.Math.Clamp(this.minProgressWidth+i-a,this.minProgressWidth,this.maxProgressWidth);this.blueProgress.setSizeByWorld(r,this.progressHeight),this.redProgress.setSizeByWorld(s,this.progressHeight),this.gloves.setX(this.blueProgress.x+r),this.blueText.setX(this.blueProgress.x+14+(r-this.gloves.width/2)/2),this.redText.setX(this.redProgress.x-13-(s-this.gloves.width/2)/2),this.redText.setText(""+Math.round(t)),this.blueText.setText(""+Math.round(e))},n.reset=function(){this.blueScore=0,this.redScore=0,this.updateProgress()},n.createBackground=function(){var e=this.scene.make.nineslice({key:LT,frame:_T.MAIN.LOADING.BASE,width:334/3,height:21,leftWidth:12,rightWidth:12});e.setOrigin(.5,.5),e.setSizeByWorld(RT,BT),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},n.createBlueProgress=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.make.nineslice({key:LT,frame:_T.MAIN.LOADING.BLUE,width:328/3,height:41/3,leftWidth:7,rightWidth:7});t.setOrigin(0,.5);var n=new jp(this.scene,{text:"123",fontSize:this.scene.fontSize(14),strokeColor:3032985,strokeThickness:2,strokeAlpha:.7});n.setY(-2.5),this.add([t,n]),this.blueProgress=t,this.blueText=n,t.setPosition(-t.displayWidth,-2.5)},n.createRedProgress=function(){var e=this.scene.make.nineslice({key:LT,frame:_T.MAIN.LOADING.RED,width:328/3,height:41/3,leftWidth:7,rightWidth:7});e.setOrigin(1,.5);var t=new jp(this.scene,{text:"123",fontSize:this.scene.fontSize(14),strokeColor:9710414,strokeThickness:2,strokeAlpha:.7});t.setY(-2.5),this.add([e,t]),this.redProgress=e,this.redText=t,e.setPosition(e.displayWidth,-2.5)},n.createGloves=function(){var e=this.scene.add.container();e.setSize(28,33),this.add(e);var t=this.scene.add.image(1.5,-2,LT,_T.MAIN.GLOVE.BLUE);t.setDefaultWorldSize(),e.add(t),this.blueGlove=t;var n=this.scene.add.image(-1.5,-2,LT,_T.MAIN.GLOVE.RED);n.setDefaultWorldSize(),e.add(n),this.redGlove=n,this.gloves=e},t}(Phaser.GameObjects.Container),NT=MT,GT=function(e){return e[e.WAITING=0]="WAITING",e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.WON=3]="WON",e[e.LOST=4]="LOST",e}({}),ZT=function(e){function t(t){var n;(n=e.call(this,t)||this).originalScale=void 0;var i=1/GameCore.ImageScale;return n.originalScale=Phaser.Math.FloatBetween(.5*i,i),n}return(0,s.Z)(t,e),t.prototype.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.lifeT<=.2?this.alpha=this.lifeT/.2:this.lifeT<=.6?this.alpha=1:this.alpha=1-(this.lifeT-.6)/.2,this.lifeT<=.2?(this.scaleX=this.originalScale,this.scaleY=this.originalScale):(this.scaleX=this.originalScale-(this.originalScale-.1)*(this.lifeT-.2)/.8,this.scaleY=this.originalScale-(this.originalScale-.1)*(this.lifeT-.2)/.8),a},t}(Phaser.GameObjects.Particles.Particle),FT=ZT,UT=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).emitter=void 0,a.emitterKey=void 0,a.emitterFrame=void 0,a.scene=t,a.emitterKey=n,a.emitterFrame=i,a.setActive(!1),a.setVisible(!1),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,key:this.emitterKey,frame:this.emitterFrame,speedX:{min:0,max:0},speedY:{min:-8,max:-4},lifespan:{min:5e3,max:8e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:300,blendMode:"Multiply",particleClass:FT})},n.run=function(e,t,n,i,a,r){this.reset(),this.revive();var s=n-a/2,o=n+a/2,c=i-r/2,h=i+r/2;this.emitter.setPosition({min:s,max:o},{min:c,max:h}),this.emitter.setQuantity(e),this.emitter.setFrequency(t),this.emitter.start()},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},n.setEmitterTexture=function(e,t){this.emitterKey=e,this.emitterFrame=t,this.reset()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),WT=UT;function HT(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return YT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YT(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var KT=Wi.Z.BOXING_DUEL,zT=KT.KEY,VT=KT.FRAME,jT=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boxerFrame=void 0,i.lightBorder=void 0,i.crown=void 0,i.playerName=void 0,i.avatar=void 0,i.lightCrown=void 0,i.showCrownAnimation=void 0,i.showLightCrownAnimation=void 0,i.vfx=void 0,i.sparklesFlyUp=void 0,i.animatedPhotos=[],i.animatedPhotoHeight=57,i.peekabooContainer=void 0,i.borderCover=void 0,i.peekabooMask=void 0,i.randomOpponents=[],i.animatedPhotoPool=[],i.findingOpponentTween=void 0,i.randomFrame=void 0,i.handleFindOpponentCompleted=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.animatedPhotos.find((function(e){return 0===e.y}))||i.animatedPhotos[0],n=t.getData("info"),i.scene.boxingDuel.startNewMatch(n,""),i.updateBoxerName(n.name),i.updateBoxerPhoto(n.playerId,n.photo),i.reset();case 6:case"end":return e.stop()}}),e)}))),i.scene=t,i.isPlayer=n,i.boxerFrame=i.isPlayer?VT.PLAYER:VT.OPPONENT,i.create(),i.setSize(i.avatar.width,i.avatar.height),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.sparklesFlyUp.stop(),this.borderCover.kill(),this.peekabooContainer.kill(),this.peekabooContainer.setImages([]),this.peekabooContainer.clearMask(!0),this.animatedPhotos=[],this.animatedPhotoPool.forEach((function(e){e.kill()}))},n.updateData=function(e){if(e){this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.name,i=e.photo;this.updateBoxerName(n),this.updateBoxerPhoto(t,i)}else this.setRandomPlayer()},n.updateBoxerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15),this.playerName.setText(t);var n=this.playerName.width>94?.95*this.scene.fontSize(14):this.scene.fontSize(14);this.playerName.setFontSize(n)},n.updateBoxerPhoto=function(e,t){this.randomFrame.kill(),this.avatar.loadPhoto(e,t,50)},n.setWon=function(){this.showLightCrown(!0),this.sparklesFlyUp.run(1,1e3,0,10,60,60),this.vfx.revive()},n.setLost=function(){this.showLightCrown(!1),this.sparklesFlyUp.stop(),this.vfx.kill()},n.setRandomPlayer=function(){this.randomFrame.revive(),this.playerName.setText("...")},n.showCrown=function(e){var t;this.lightCrown.setAlpha(0),null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.showLightCrown=function(e){var t;this.crown.setAlpha(0),null==(t=this.showLightCrownAnimation)||t.remove(),this.showLightCrownAnimation=this.scene.tweens.add({targets:this.lightCrown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.setLightBorder=function(e){e?this.lightBorder.revive():this.lightBorder.kill()},n.alignItems=function(){var e=this.isPlayer?-20:20;this.crown.setPosition(e,-30),this.lightCrown.setPosition(e,-30),this.lightBorder.setPosition(0,-1),this.playerName.setPosition(0,this.avatar.height/2-5)},n.stopFindingOpponentAnimation=function(){var e;this.findingOpponentTween.stop(),null==(e=this.findingOpponentTween)||e.remove(),this.reset()},n.runFindingOpponentAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=5-this.randomOpponents.length,e.next=3,this.loadOpponentData(t);case 3:return this.createPeekabooAvatars(),e.next=6,this.runOpponentAvatarsFinding();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createPeekabooAvatars=function(){var e=this,t=this.randomOpponents.slice(0,2);this.animatedPhotos=t.map((function(t,n){var i=e.getAnimatedPhoto();return i.setTexture(t.playerId),i.setWorldSize(57,57),i.setY(-e.animatedPhotoHeight*n),i.setData("info",t),i})),this.peekabooContainer.revive(),this.peekabooContainer.setImages(this.animatedPhotos),this.createPeekabooMask(),this.borderCover.revive()},n.runOpponentAvatarsFinding=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,3705,this.findingOpponentTween=this.scene.tweens.addCounter({from:0,to:5700,duration:3e3,onUpdate:function(e){n.animatedPhotos.forEach((function(t){if(t.y>=t.height){t.setY(t.y-2*t.height);var i=Phaser.Math.RND.pick(n.randomOpponents);t.setData("info",i),t.setTexture(i.playerId),t.setWorldSize(57,57)}t.y+=e.getValue()-(e.data[0].previous||0),n.setPeekabooMask()})),e.getValue()>=3705&&!t&&(t=!0,n.emit("opponent-found"))},onComplete:this.handleFindOpponentCompleted}),e.next=5,this.findingOpponentTween.waitForCompletion();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAnimatedPhoto=function(){var e=this.animatedPhotoPool.find((function(e){return!e.active}));if(!e){var t=this.scene.make.image({x:0,y:0});return this.add(t),this.animatedPhotoPool.push(t),t}return e.revive(),e},n.loadOpponentData=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<=0)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:n=(0,$i.h)(t),i=HT(n);case 4:if((a=i()).done){e.next=12;break}return r=a.value,e.next=8,this.loadPhoto(r.id,r.photo);case 8:s=e.sent,this.randomOpponents.push({playerId:s.id,name:r.name,photo:s.url,score:0,lastUpdated:0,logStart:!1});case 10:e.next=4;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.loadPhoto=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.scene.load.once("filecomplete-image-"+t,(function(){return e({id:t,url:n})})),i.scene.load.image(t,n),i.scene.load.start()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createVfx(),this.createAvatar(),this.createRandomFrame(),this.createPeekabooContainer(),this.createAvatarBorderCover(),this.createLightBorder(),this.createCrown(),this.createName(),this.createParticle()},n.createVfx=function(){var e=this.scene.add.image(0,0,zT,this.boxerFrame.VFX_AVATAR);e.setWorldSize(667/3,623/3),this.add(e),this.vfx=e,this.vfx.kill()},n.createRandomFrame=function(){var e=this.scene.add.image(0,0,zT,this.boxerFrame.AVATAR.RANDOM);e.setDefaultWorldSize(),this.add(e),this.randomFrame=e},n.createParticle=function(){var e=new WT(this.scene,zT,this.boxerFrame.EFFECT_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createAvatar=function(){var e=new Ic(this.scene,{key:zT,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.BACKGROUND,width:67,height:208/3});this.add(e),this.avatar=e},n.createPeekabooContainer=function(){var e=new Mu(this.scene,57,57,[]);this.peekabooContainer=e,this.peekabooContainer.setY(-1),this.add(e)},n.createPeekabooMask=function(){var e=this.scene.add.graphics();e.setAlpha(0),e.fillRoundedRect(0,0,this.animatedPhotoHeight,this.animatedPhotoHeight,{tl:12,tr:12,bl:12,br:12}),this.addAt(e,2),this.peekabooMask=e,this.setPeekabooMask()},n.setPeekabooMask=function(){this.peekabooContainer.setMask(this.peekabooMask.createGeometryMask());var e=this.peekabooContainer.getWorldPosition();this.peekabooMask.setPosition(e.x-this.peekabooContainer.width/2*this.scaleX,e.y-this.peekabooContainer.height/2*this.scaleY)},n.createAvatarBorderCover=function(){var e=this.scene.add.image(0,0,zT,this.boxerFrame.AVATAR.BORDER);e.setDefaultWorldSize(),this.add(e),this.borderCover=e,this.borderCover.kill()},n.createLightBorder=function(){var e=this.scene.add.image(0,0,zT,this.boxerFrame.AVATAR.LIGHT_BORDER);e.setDefaultWorldSize(),this.add(e),this.lightBorder=e,this.lightBorder.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,zT,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e;var t=this.scene.add.image(0,0,zT,this.boxerFrame.CROWN_LIGHT);t.setDefaultWorldSize(),this.add(t),this.lightCrown=t,this.lightCrown.setAlpha(0)},n.createName=function(){var e=new jp(this.scene,{text:"Player",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?2631810:9504822,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});Phaser.Display.Align.In.BottomCenter(e,this,0,5),this.playerName=e,this.add(e),this.playerName.kill()},t}(Phaser.GameObjects.Container),XT=Wi.Z.BOXING_DUEL,qT=XT.KEY,JT=XT.FRAME,QT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.container=void 0,n.playerAvatar=void 0,n.opponentAvatar=void 0,n.glow=void 0,n.progressBar=void 0,n.glowTween=void 0,n.sparklesFlyUp=void 0,n.vText=void 0,n.sText=void 0,n.overlayBackground=void 0,n.handleOpponentFound=function(){n.scene.tweens.add({targets:[n.playerAvatar,n.opponentAvatar,n.opponentAvatar.peekabooMask],scale:{from:1,start:1,to:1.2},duration:1e3,ease:Phaser.Math.Easing.Sine.In}),n.scene.tweens.add({targets:[n.playerAvatar,n.opponentAvatar,n.opponentAvatar.peekabooMask],scale:{from:1.2,start:1.2,to:1},delay:1e3,duration:200,ease:Phaser.Math.Easing.Back.Out})},n.scene=t,n.create(),n.setSize(300,n.playerAvatar.height),n.alignItems(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.progressBar.reset()},n.close=function(){var e;this.sparklesFlyUp.stop(),null==(e=this.glowTween)||e.remove(),this.playerAvatar.reset(),this.opponentAvatar.emit("find-opponent-stop")},n.updateInfo=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),n=this.scene.boxingDuel.getPlayer(),i=this.scene.boxingDuel.getOpponent(),this.playerAvatar.updateData(n),this.opponentAvatar.updateData(i),e.next=7,this.scene.boxingDuel.updateOpponentScore();case 7:if(a=this.scene.boxingDuel.getPlayerScore(),r=this.scene.boxingDuel.getOpponentScore(),this.progressBar.updateProgressBar(a,r,t),0!==a||0!==r){e.next=14;break}return this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!1),e.abrupt("return");case 14:0===this.scene.boxingDuel.getPlayerRank()?(this.playerAvatar.showCrown(!0),this.opponentAvatar.showCrown(!1)):(this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!0));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateData=function(e){switch(e){case GT.READY:this.playerAvatar.setLightBorder(!1),this.playerAvatar.playerName.kill(),this.opponentAvatar.playerName.kill(),this.setBoxersReadyPosition(),this.playerAvatar.showCrown(!1),this.opponentAvatar.showCrown(!1);break;case GT.PLAYING:this.runBoxersGotoPlayingPositionAnimation(),this.playerAvatar.playerName.revive(),this.opponentAvatar.playerName.revive(),this.playerAvatar.setLightBorder(!1);break;case GT.WON:this.setBoxersPlayingPosition(),this.playerAvatar.setLightBorder(!0),this.playerAvatar.setWon(),this.opponentAvatar.setLost();break;case GT.LOST:this.setBoxersPlayingPosition(),this.playerAvatar.setLightBorder(!0),this.opponentAvatar.setWon(),this.playerAvatar.setLost()}},n.setBoxersReadyPosition=function(){this.playerAvatar.setPosition(-74,-34),this.opponentAvatar.setPosition(74,-34),this.progressBar.setAlpha(0)},n.runBoxersGotoPlayingPositionAnimation=function(){this.scene.tweens.add({targets:this.playerAvatar,x:-120,y:-63,duration:300,ease:Phaser.Math.Easing.Quadratic.Out}),this.scene.tweens.add({targets:this.opponentAvatar,x:120,y:-63,duration:300,ease:Phaser.Math.Easing.Quadratic.Out}),this.progressBar.setPosition(0,-46),this.scene.tweens.add({targets:this.progressBar,alpha:1,delay:100,duration:300,ease:Phaser.Math.Easing.Sine.Out})},n.setBoxersPlayingPosition=function(){this.playerAvatar.setPosition(-120,-63),this.opponentAvatar.setPosition(120,-63),this.progressBar.setPosition(0,-46),this.progressBar.setAlpha(1)},n.findOpponent=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),!t){e.next=6;break}return e.next=4,this.runFindingOpponentAnimation();case 4:e.next=14;break;case 6:return e.next=8,this.scene.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=window.game,i=n.player,a=n.facebook,(r=n.globalScene).screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),s=i.getConnectedPlayerIds(100,0),o="",h="",u=a.contextType,s.length>=1&&(l=Phaser.Math.RND.between(0,s.length-1),o=s[l]),!o||"string"!==typeof o){e.next=12;break}return e.next=11,a.createAsync(o);case 11:h=e.sent;case 12:if(!1!==h&&""!==h){e.next=16;break}return e.next=15,t(yi(void 0,void 0,!1));case 15:return e.abrupt("return");case 16:return d=i.getPlayerId(),e.next=19,a.getContextPlayers(d);case 19:return p=e.sent,f=ae,""===o?1===p.length&&(f=p[0]||ae):f=1===p.length?p[0]||ae:i.getConnectedPlayers()[o]||ae,t(ii()),g=(m=f).name,v=m.photo,y={playerId:o,name:g,photo:v},e.next=27,r.boxingDuel.startNewMatch(y,h);case 27:return di({contextId:h}),t(_t(h,u)),e.abrupt("return",!0);case 32:if(e.prev=32,e.t0=e.catch(0),!(e.t0 instanceof se)){e.next=37;break}return t(gi()),e.abrupt("return");case 37:(0,Y.tO)(e.t0);case 38:return e.prev=38,fi(1e3),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,32,38,41]])})));return function(t){return e.apply(this,arguments)}}());case 8:n=this.scene.boxingDuel.getOpponent(),i=this.scene.boxingDuel.isHappening(),a=this.scene.boxingDuel.isDuelWithFriend(),s=this.scene.boxingDuel.getContextID(),o=GameCore.Configs.BoxingDuel.JustBot,n&&i&&a&&s&&!o&&this.scene.storage.dispatch(yi(s,n.playerId,!1));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runFindingOpponentAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.opponentAvatar.on("opponent-found",this.handleOpponentFound,this),e.next=3,this.opponentAvatar.runFindingOpponentAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showVS=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVSAnimation(0);case 2:return e.next=4,this.hideVSAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleFindOpponentStarted=function(){this.runScaleBoxersAnimation(2e3)},n.handleFindOpponentStop=function(){this.opponentAvatar.stopFindingOpponentAnimation(),this.scene.tweens.killTweensOf([this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask]),this.playerAvatar.setScale(1),this.opponentAvatar.setScale(1)},n.runScaleBoxersAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),(n=this.scene.tweens.createTimeline()).add({targets:[this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask],scale:{from:1,to:1.2},delay:t,duration:1e3,ease:Phaser.Math.Easing.Sine.In}),n.add({targets:[this.playerAvatar,this.opponentAvatar,this.opponentAvatar.peekabooMask],scale:{from:1.2,to:1},duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[7]}),n.play();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideVSAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:[this.vText,this.sText,this.glow],alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.sparklesFlyUp.stop(),t.vText.kill(),t.sText.kill(),t.glow.kill()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showVSAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],i=this.runGlowAnimation(),a=this.runVTextTimeline(),s=this.runSTextTimeline(),n.push(i,a,s),e.next=7,(0,dl.Z)(this.scene,t).then((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.playAndWaitForCompletion()})));case 2:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runGlowAnimation=function(){var e=this,t=1/GameCore.ImageScale,n=this.scene.tweens.createTimeline();return n.add({targets:[this.glow],alpha:{from:0,start:0,to:1,duration:100},onStart:function(){e.glow.revive(),e.sparklesFlyUp.run(1,1e3,0,-15,40,40),e.glow.setScale(3*t),e.runFadeOverlayBackgroundAnimation(0,.4,200)}}),n.add({targets:[this.glow],scale:{from:3*t,start:3*t,to:2*t},delay:750,duration:400,ease:Phaser.Math.Easing.Back.In,easeParams:[4],onStart:function(){(0,dl.Z)(e.scene,550).then((function(){e.runFadeOverlayBackgroundAnimation(.4,0,200)}))}}),n},n.runFadeOverlayBackgroundAnimation=function(e,t,n){this.scene.tweens.add({targets:[this.overlayBackground],alpha:{from:e,to:t},duration:n,ease:Phaser.Math.Easing.Sine.Out})},n.runVTextTimeline=function(){var e=this,t=this.scene.tweens.createTimeline();return t.add({targets:[this.vText],alpha:{from:0,start:0,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},scale:{from:1.5,start:1.5,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},x:{from:-30,start:-30,to:-9,duration:100,ease:Phaser.Math.Easing.Back.Out},delay:100,onStart:function(){e.vText.revive(),e.vText.setAlpha(0)}}),t.add({targets:[this.vText],scale:{from:1,start:1,to:1.2,delay:50,duration:100,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0}}),t},n.runSTextTimeline=function(){var e=this,t=this.scene.tweens.createTimeline();return t.add({targets:[this.sText],alpha:{from:0,start:0,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},scale:{from:1.5,start:1.5,to:1,duration:100,ease:Phaser.Math.Easing.Sine.Out},x:{from:30,start:30,to:9,duration:100,ease:Phaser.Math.Easing.Back.Out},delay:100,onStart:function(){e.sText.revive(),e.sText.setAlpha(0)}}),t.add({targets:[this.sText],scale:{from:1,start:1,to:1.2,delay:50,duration:100,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0}}),t},n.alignItems=function(){Phaser.Display.Align.In.Center(this.glow,this,0,-30)},n.create=function(){this.createOverlayBackground(),this.createGlow(),this.createVS(),this.createParticle(),this.createProgressBar(),this.createBoxers()},n.createOverlayBackground=function(){var e=this.scene.add.image(0,0,qT,JT.BLANK),t=this.scene.gameZone,n=t.width,i=t.height;e.setWorldSize(n,i),this.add(e),e.setTint(0),e.setAlpha(0),this.overlayBackground=e},n.createGlow=function(){var e=this.scene.add.image(0,0,qT,JT.EFFECTS.VFX_VS);e.setDefaultWorldSize(),e.setScale(2*e.scale),e.kill(),this.add(e),this.glow=e},n.createParticle=function(){var e=new WT(this.scene,qT,JT.EFFECTS.VS_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createVS=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"V",origin:{x:.5,y:.5}});e.kill();var t=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"S",origin:{x:.5,y:.5}});t.kill(),this.add(e),this.add(t),this.vText=e,this.sText=t,this.vText.setPosition(-9,-34),this.sText.setPosition(9,-34)},n.createBoxers=function(){this.createLeftBoxer(),this.createRightBoxer()},n.createLeftBoxer=function(){var e=new jT(this.scene,!0);this.add(e),this.playerAvatar=e},n.createRightBoxer=function(){var e=new jT(this.scene,!1);this.add(e),this.opponentAvatar=e},n.createProgressBar=function(){var e=new NT(this.scene);this.add(e),e.setAlpha(0),this.progressBar=e},t}(Phaser.GameObjects.Container),$T=QT,ex=Wi.Z.BOXING_DUEL,tx=ex.KEY,nx=ex.FRAME,ix=function(e){function t(t){var n;return(n=e.call(this,t,{key:tx,backgroundFrame:nx.BUTTON.BASE,buttonFrame:nx.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.buttonType=void 0,n.loading=void 0,n.scene=t,n.createText(),n.createLoading(),n.setSize(n.width,n.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runLoadingAnimation=function(){this.setButtonType(hx.LOADING)},n.stopLoadingAnimation=function(){this.loading.setVisible(!1)},n.setButtonType=function(e){switch(this.buttonType=e,e){case hx.PLAY:this.setText("PLAY"),this.loading.setVisible(!1),this.showText();break;case hx.START:this.setText("START"),this.loading.setVisible(!1),this.showText();break;case hx.LOADING:this.buttonText.kill(),this.loading.setVisible(!0)}},n.showText=function(){var e=this;this.scene.tweens.add({targets:this.buttonText,alpha:1,duration:200,onStart:function(){e.buttonText.revive(),e.buttonText.setAlpha(0)}})},n.getButtonType=function(){return this.buttonType},n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new jp(this.scene,{text:"PLAY",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setWorldSize(27,27),this.loading.setY(-1),this.loading.setVisible(!1),this.addIntoButton(this.loading)},t}(tT),ax=ix,rx=function(e){function t(t,n){var i;return(i=e.call(this,t,Wi.Z.DEFAULT.KEY,Wi.Z.DEFAULT.FRAME.PLAY_SCREEN.BOOSTER.ICON_PLATE_IN,n.width||30,n.height||30)||this).payload=void 0,i.text=void 0,i.button.setTintFill(13421772),i.setAlpha(.5),i.createUI(n.text||""),i.onClick=function(){n.callback&&n.callback()},i}return(0,s.Z)(t,e),t.prototype.createUI=function(e){this.text=new jp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),this.text.setCenterAlign(),this.add(this.text)},t}(Hc.Z),sx=Wi.Z.BOXING_DUEL,ox=sx.KEY,cx=sx.FRAME,hx=function(e){return e.PLAY="play",e.START="start",e.LOADING="loading",e}({}),ux=function(e){function t(t,n){var i;return(i=e.call(this,n.scene)||this).scene=void 0,i.screen=void 0,i.boxersStatus=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.playButton=void 0,i.cup=void 0,i.boxers=void 0,i.closeButton=void 0,i.debugButtons=[],i.scene=t,i.screen=n,i.create(),i.alignItems(),i.boxersStatus=GT.READY,i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.closeContainer=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){1!==this.alpha&&this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.debugButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.setAlpha(1),this.setButtonsDisabled(!0),this.updateBoxerStatus(),this.updateBoxers(),this.updateTime(),this.setButtonsDisabled(!1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.boxers.close()},n.updateBoxerStatus=function(){this.scene.boxingDuel.isHappening()?(this.boxersStatus=GT.PLAYING,this.setPlaying()):(this.boxersStatus=GT.READY,this.setReady())},n.setPlaying=function(){var e=this;this.playButton.setButtonType(hx.PLAY),this.scene.add.tween({targets:this.timerPanel,alpha:1,delay:100,duration:500,ease:Phaser.Math.Easing.Sine.InOut,onStart:function(){e.timerPanel.revive(),e.updateTime()}})},n.setReady=function(){this.playButton.setButtonType(hx.START),this.timerPanel.kill(),this.timerPanel.setAlpha(0)},n.updateTime=function(){var e=this.scene.boxingDuel.getRemainingTime();this.timerPanel.timerLogic.setRemainingTime(e)},n.updateBoxers=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boxers.updateData(this.boxersStatus),this.boxers.updateInfo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.findOpponent=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=!1),this.playButton.runLoadingAnimation(),this.boxers.findOpponent(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.handleFindOpponentCompleted=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxers.updateInfo(),e.next=3,this.boxers.showVS();case 3:this.playButton.stopLoadingAnimation(),this.playButton.setButtonType(hx.PLAY),this.boxersStatus=GT.PLAYING,this.boxers.updateData(this.boxersStatus),this.setPlaying(),this.setButtonsDisabled(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,-2,24),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopCenter(this.boxers,this,0,-110),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,-1,-100),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-26,-20),Phaser.Display.Align.In.TopRight(this.closeButton,this,-21,-22),Phaser.Display.Align.In.BottomCenter(this.cup,this,.5,-23),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,20)},n.create=function(){this.createBackground(),this.createCup(),this.createHeader(),this.createDescription(),this.createTimePanel(),this.createBoxers(),this.createButtons(),this.createDebug()},n.createBackground=function(){var e=this.scene.add.image(0,0,ox,cx.MAIN.POPUP);e.setWorldSize(1123/3,857/3),this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.createCup=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,ox,cx.MAIN.CUP);t.setDefaultWorldSize(),e.add(t),e.setSize(t.width,t.height);var n=this.scene.add.image(0,0,ox,cx.MAIN.TEXT_REWARD_COIN);n.setDefaultWorldSize(),n.setPosition(0,0),e.add(n),this.cup=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,ox,cx.MAIN.HEADER.MAIN);e.setDefaultWorldSize(),this.header.add(e);var t=new Pf(this.scene);t.setText("Boxing Duel"),t.setFontSize(24.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-8),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=new jp(this.scene,{text:"Collect more gloves than your\nopponent to win the prize!",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeOffset:{y:0},strokeAlpha:.5});e.setCenterAlign(),this.add(e),this.description=e},n.createBoxers=function(){var e=new $T(this.scene);this.add(e),this.boxers=e},n.createTimePanel=function(){this.timerPanel=new IT(this.scene),this.add(this.timerPanel),this.timerPanel.kill();var e=this.scene.add.image(0,0,ox,cx.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createPlayButton()},n.createInformationButton=function(){var e=new iv.Z(this.scene,{key:ox,frame:cx.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new iv.Z(this.scene,{key:ox,frame:cx.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createPlayButton=function(){var e=new ax(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.createDebug=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=this.scene.add.container(),n=new rx(this.scene,{text:"end\nall\nduel",callback:function(){e.scene.boxingDuel.endCurrentMatch(),e.playButton.setButtonType(hx.START)}});Phaser.Display.Align.In.TopCenter(n,this,0,0);var i=new rx(this.scene,{text:"up\nplayer\n30-50",callback:function(){var t=e.scene.boxingDuel.getPlayer().score,n=Math.floor(Phaser.Math.Between(30,50));e.scene.boxingDuel.updatePlayerScore(t+n)}});Phaser.Display.Align.In.TopLeft(i,this,0,0),t.add([n,i]),t.setDepth(Fr.Z.POPUP+1),this.add(t),Phaser.Display.Align.In.Center(t,this),this.debugButtons.push(n,i)}},t}(Phaser.GameObjects.Container),lx=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.boxingDuelMainContainer=void 0,s.previousScreen=void 0,s.isScreenOpening=!1,s.handleFindOpponentCompleted=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(400);case 2:s.boxingDuelMainContainer.handleFindOpponentCompleted();case 3:case"end":return e.stop()}}),e)}))),s.handleInformationButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=s.previousScreen===ce.o4.DASHBOARD_SCREEN)&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),e.next=4,s.boxingDuelMainContainer.closeContainer();case 4:return e.next=6,s.scene.screen.openAsync(ce.o4.BOXING_DUEL.INTRO_SCREEN);case 6:t&&s.scene.screen.open(ce.o4.DASHBOARD_SCREEN),s.scene.screen.bringToTop(ce.o4.BOXING_DUEL.MAIN_SCREEN),s.boxingDuelMainContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),s.handleCloseButtonClick=function(){s.scene.screen.close(s.name)},s.handlePlayButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s.boxingDuelMainContainer.playButton.getButtonType(),e.t0=t,e.next=e.t0===hx.START?4:e.t0===hx.PLAY?7:10;break;case 4:return e.next=6,s.handleStartButton();case 6:case 9:case 10:return e.abrupt("break",11);case 7:return e.next=9,s.handlePlayButton();case 11:case"end":return e.stop()}}),e)}))),s.handleStartFindBot=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.boxingDuelMainContainer.findOpponent(!0);case 2:case"end":return e.stop()}}),e)}))),s.close=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.isScreenOpening=!1,s.background.off(Phaser.Input.Events.POINTER_DOWN),s.boxingDuelMainContainer.close(),s.runExitAnimation();case 4:case"end":return e.stop()}}),e)}))),s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.scene.gameUI.coinBarButton.setDisabled(!1),s.previousScreen&&s.scene.screen.open(s.previousScreen)},s.scene=t,s.create(),s.listenEvents(),s.setDepth(ce.Ks.POPUP),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.boxingDuelMainContainer.setAlpha(0),s}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createBoxingDuelMainContainer()},n.listenEvents=function(){this.scene.boxingDuel.events.on(_i,this.handleFindOpponentCompleted),this.scene.boxingDuel.events.on("start-find-bot",this.handleStartFindBot,this);var e=this.boxingDuelMainContainer,t=e.informationButton,n=e.closeButton,i=e.playButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick},n.handleStartButton=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxingDuelMainContainer.setButtonsDisabled(!0),e.next=3,this.boxingDuelMainContainer.findOpponent(GameCore.Configs.BoxingDuel.JustBot);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handlePlayButton=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.scene.boxingDuel.getOpponent()){e.next=7;break}return this.previousScreen="",this.scene.screen.close(ce.o4.BOXING_DUEL.MAIN_SCREEN),this.scene.screen.close(ce.o4.DASHBOARD_SCREEN),this.scene.gameplay.processStartLevel(),e.abrupt("return");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createBoxingDuelMainContainer=function(){this.boxingDuelMainContainer=new ux(this.scene,this),this.boxingDuelMainContainer.setInteractive(),this.add(this.boxingDuelMainContainer),Phaser.Display.Align.In.Center(this.boxingDuelMainContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.isScreenOpening=!0,i=null!=n?n:{previousScreen:ce.o4.DASHBOARD_SCREEN},a=i.previousScreen,this.previousScreen=a,this.runEntranceAnimation(),t.next=7,this.handleFirstTimePlay();case 7:return t.next=9,this.boxingDuelMainContainer.open();case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.boxingDuel.getFirstTimePlay()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.boxingDuel.setFirstTimePlay(!1),e.next=6,(0,le.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.boxingDuelMainContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.previousScreen===ce.o4.DASHBOARD_SCREEN&&this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.boxingDuelMainContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),dx=Wi.Z.BOXING_DUEL,px=dx.KEY,fx=dx.FRAME,mx=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boxerFrame=void 0,i.crown=void 0,i.playerName=void 0,i.avatar=void 0,i.showCrownAnimation=void 0,i.vfx=void 0,i.scorePanel=void 0,i.scorePanelWin=void 0,i.scoreWinText=void 0,i.scoreLoseText=void 0,i.sparklesFlyUp=void 0,i.scene=t,i.isPlayer=n,i.boxerFrame=i.isPlayer?fx.PLAYER:fx.OPPONENT,i.create(),i.setSize(i.avatar.width,i.avatar.height),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){if(e){this.avatar.background.kill(),this.avatar.photo.revive(),this.avatar.avtFrame.revive();var t=e.playerId,n=e.name,i=e.photo;this.updateBoxerName(n),this.updateBoxerPhoto(t,i)}else this.setRandomPlayer()},n.updateBoxerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15),this.playerName.setText(t)},n.updateBoxerPhoto=function(e,t){this.avatar.loadPhoto(e,t,50)},n.setWon=function(){this.setAvatarScale(1.2),this.vfx.revive(),this.scorePanelWin.revive(),this.scoreWinText.revive(),this.scorePanel.kill(),this.scoreLoseText.kill(),this.setPlayerNameFontSize(!0),this.playerName.setY(32),this.showCrown(!0),this.sparklesFlyUp.run(2,500,0,35,90,100)},n.setLost=function(){this.setAvatarScale(1.1),this.vfx.kill(),this.scorePanelWin.kill(),this.scoreWinText.kill(),this.scorePanel.revive(),this.scoreLoseText.revive(),this.setPlayerNameFontSize(!1),this.playerName.setY(30),this.showCrown(!1),this.sparklesFlyUp.stop()},n.updateScore=function(e,t){t?this.scoreWinText.setText(e.toString()):this.scoreLoseText.setText(e.toString())},n.setRandomPlayer=function(){this.avatar.photo.kill(),this.avatar.avtFrame.kill(),this.playerName.setText("...")},n.showCrown=function(e){var t;null==(t=this.showCrownAnimation)||t.remove(),this.showCrownAnimation=this.scene.tweens.add({targets:this.crown,alpha:e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.Out})},n.setPlayerNameFontSize=function(e){var t=this.playerName.text;t=t.length>=15?GameCore.Utils.String.getShortName(t,12)+"...":GameCore.Utils.String.getShortName(t,15);var n=e?14:13,i=this.playerName.width>94?.95*this.scene.fontSize(n):this.scene.fontSize(n);this.playerName.setFontSize(i)},n.alignItems=function(){var e=this.isPlayer?-26:26;this.crown.setPosition(e,-36.5),this.scorePanelWin.setY(53),this.scoreWinText.setY(58),this.scorePanel.setY(48),this.scoreLoseText.setY(49)},n.setAvatarScale=function(e){this.avatar.setScale(e)},n.create=function(){this.createVfx(),this.createScorePanel(),this.createAvatar(),this.createCrown(),this.createScorePanelWin(),this.createName(),this.createScore(),this.createParticle()},n.createVfx=function(){var e=this.scene.add.image(0,0,px,this.boxerFrame.VFX_AVATAR);e.setWorldSize(667/3,623/3),this.add(e),this.vfx=e,this.vfx.kill()},n.createParticle=function(){var e=new WT(this.scene,px,this.boxerFrame.EFFECT_LIGHT);this.add(e),this.sparklesFlyUp=e,this.sparklesFlyUp.stop()},n.createScorePanel=function(){var e=this.scene.add.image(0,0,px,this.boxerFrame.SCORE_PANEL);e.setDefaultWorldSize(),this.add(e),this.scorePanel=e,this.scorePanel.kill()},n.createAvatar=function(){var e=new Ic(this.scene,{key:px,frame:this.boxerFrame.AVATAR.BORDER,background:this.boxerFrame.AVATAR.RANDOM,width:67,height:208/3});this.add(e),this.avatar=e},n.createScorePanelWin=function(){var e=this.scene.add.image(0,0,px,this.boxerFrame.SCORE_PANEL_WIN);e.setDefaultWorldSize(),this.add(e),this.scorePanelWin=e,this.scorePanelWin.kill()},n.createCrown=function(){var e=this.scene.add.image(0,0,px,this.boxerFrame.CROWN);e.setDefaultWorldSize(),this.add(e),this.crown=e},n.createName=function(){var e=new jp(this.scene,{text:"Player",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?2631810:9504822,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});Phaser.Display.Align.In.BottomCenter(e,this,0,5),this.playerName=e,this.add(e)},n.createScore=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(20),text:"999",origin:{x:.5,y:.5}});this.add(e),this.scoreWinText=e;var t=new jp(this.scene,{text:"249",fontSize:this.scene.fontSize(16),strokeColor:this.isPlayer?3807903:10489385,strokeThickness:2,strokeOffset:{y:.6},strokeAlpha:.9});this.add(t),this.scoreLoseText=t;var n=t.context.createLinearGradient(0,0,0,t.height);this.isPlayer?(n.addColorStop(0,"#ffffff"),n.addColorStop(1,"#af97ff")):(n.addColorStop(0,"#ffffff"),n.addColorStop(1,"#ff7690")),t.setFill(n)},t}(Phaser.GameObjects.Container),gx=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.playerAvatar=void 0,n.opponentAvatar=void 0,n.scene=t,n.create(),n.setSize(300,n.playerAvatar.height),n.alignAvatars(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.close=function(){this.playerAvatar.sparklesFlyUp.stop(),this.opponentAvatar.sparklesFlyUp.stop()},n.updateData=function(){this.updatePlayer(),this.updateOpponent(),this.updateScores()},n.updatePlayer=function(){var e=this.scene.boxingDuel.getPlayer();this.playerAvatar.updateData(e)},n.updateOpponent=function(){var e=this.scene.boxingDuel.getOpponent();this.opponentAvatar.updateData(e)},n.updateScores=function(){var e,t=this.scene.boxingDuel.getPlayer().score,n=(null==(e=this.scene.boxingDuel.getOpponent())?void 0:e.score)||0;0===this.scene.boxingDuel.getPlayerRank()?(this.playerAvatar.setWon(),this.opponentAvatar.setLost(),this.playerAvatar.updateScore(t,!0),this.opponentAvatar.updateScore(n,!1)):(this.opponentAvatar.setWon(),this.playerAvatar.setLost(),this.playerAvatar.updateScore(t,!1),this.opponentAvatar.updateScore(n,!0))},n.alignAvatars=function(){this.playerAvatar.setX(-60),this.opponentAvatar.setX(60)},n.create=function(){this.createBoxers()},n.createBoxers=function(){this.createLeftBoxer(),this.createRightBoxer()},n.createLeftBoxer=function(){var e=new mx(this.scene,!0);this.add(e),this.playerAvatar=e},n.createRightBoxer=function(){var e=new mx(this.scene,!1);this.add(e),this.opponentAvatar=e},t}(Phaser.GameObjects.Container),vx=gx,yx=Wi.Z.BOXING_DUEL,Ex=yx.KEY,Cx=yx.FRAME,Ax=function(e){function t(t,n){var i;(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.title=void 0,i.flags=void 0,i.illustrators=void 0,i.tapToClaim=void 0,i.illustratorLeft=void 0,i.illustratorRight=void 0,i.flagLeft=void 0,i.flagRight=void 0,i.boxers=void 0,i.close=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.off(Phaser.Input.Events.POINTER_DOWN),i.screen.handleCloseBoxingDuelOver();case 2:case"end":return e.stop()}}),e)}))),i.scene=t,i.screen=n;var a=i.scene.gameZone,s=a.width,o=a.height;return i.setSize(s,o),i.create(),i.alignItems(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateBoxers(),e.next=3,this.runEntranceAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setAlpha(1),this.revive(),this.runTitleAndClaimTextEntranceAnimation(),this.runIllustratorsEntranceAnimation(),e.next=6,this.runBoxersEntranceAnimation();case 6:this.on(Phaser.Input.Events.POINTER_DOWN,this.close);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,alpha:0,duration:300,onStart:function(){t.boxers.close()},onComplete:function(){t.kill()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleAndClaimTextEntranceAnimation=function(){this.scene.tweens.add({targets:[this.title,this.tapToClaim],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runBoxersEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.boxers,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},scaleX:{from:.7,start:.7,to:1,ease:Phaser.Math.Easing.Back.Out}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxers=function(){this.boxers.updateData()},n.alignItems=function(){this.flagLeft.setPosition(-this.width/2+this.flagLeft.width/2,0),this.flagRight.setPosition(this.width/2-this.flagRight.width/2,0),this.flags.setPosition(0,-this.height/2+this.flags.height/2),this.illustratorLeft.setPosition(-this.width/2+this.illustratorLeft.width/2,0),this.illustratorRight.setPosition(this.width/2-this.illustratorRight.width/2,0),this.illustrators.setPosition(0,this.height/2-this.illustrators.height/2),Phaser.Display.Align.In.TopCenter(this.title,this,0,-70),Phaser.Display.Align.In.BottomCenter(this.tapToClaim,this,0,-10)},n.create=function(){this.createTitle(),this.createFlags(),this.createIllustrators(),this.createTapToClaim(),this.createBoxers()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(33),text:"The Duel is over!",origin:{x:.5,y:.5}});e.setLetterSpacing(-2),this.add(e),this.title=e},n.createFlags=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,Ex,Cx.REWARD.FLAGS);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,Ex,Cx.REWARD.FLAGS);n.setDefaultWorldSize(),n.setScale(-n.scaleX,n.scaleY),e.add(n),e.setSize(this.width,t.displayHeight),this.flags=e,this.flagLeft=t,this.flagRight=n},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,Ex,Cx.REWARD.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,Ex,Cx.REWARD.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),this.illustrators=e,this.illustratorLeft=t,this.illustratorRight=n},n.createTapToClaim=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(16),text:"Tap to claim",origin:{x:.5,y:.5}});e.setAlpha(.7),this.add(e),this.tapToClaim=e},n.createBoxers=function(){var e=new vx(this.scene);this.add(e),this.boxers=e},t}(Phaser.GameObjects.Container),wx=Ax,Sx=Wi.Z.BOXING_DUEL,bx=Sx.KEY,Tx=Sx.FRAME,xx=function(e){function t(t,n){var i;return(i=e.call(this,n.scene)||this).scene=void 0,i.screen=void 0,i.boxersStatus=void 0,i.header=void 0,i.vfxHeader=void 0,i.victoryHeader=void 0,i.defeatHeader=void 0,i.title=void 0,i.description=void 0,i.cup=void 0,i.prizeText=void 0,i.boxers=void 0,i.arrow=void 0,i.arrowAnimation=void 0,i.informationButton=void 0,i.closeButton=void 0,i.claimButton=void 0,i.retryButton=void 0,i.scene=t,i.screen=n,i.create(),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.boxers.reset()},n.closeContainer=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boxers.close(),null==(t=this.arrowAnimation)||t.stop(),e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.revive(),this.openContainer(),this.setButtonsDisabled(!0),this.updateBoxersStatus(),this.updateBoxers(),this.setButtonsDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateBoxersStatus=function(){0===this.scene.boxingDuel.getPlayerRank()?(this.boxersStatus=GT.WON,this.setWin()):(this.boxersStatus=GT.LOST,this.setLose())},n.setWin=function(){this.victoryHeader.revive(),this.defeatHeader.kill(),this.claimButton.revive(),this.retryButton.kill(),this.title.setText("Victory!"),this.description.setText("Claim your prize!"),this.cup.revive(),this.arrow.kill(),this.vfxHeader.revive()},n.setLose=function(){this.victoryHeader.kill(),this.defeatHeader.revive(),this.claimButton.kill(),this.retryButton.revive(),this.title.setText("Defeat"),this.description.setText("Try again to win the prize!"),this.cup.kill(),this.arrow.revive(),this.vfxHeader.kill(),this.runArrowAnimation()},n.updateBoxers=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boxers.updateInfo(!0),this.boxers.updateData(this.boxersStatus);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runArrowAnimation=function(){var e;null==(e=this.arrowAnimation)||e.remove(),this.arrowAnimation=this.scene.tweens.add({targets:this.arrow,y:this.arrow.y+10,duration:500,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut})},n.setButtonsDisabled=function(e){this.claimButton.setDisabled(e),this.retryButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.claimButton.setAlpha(1),this.retryButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1)},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,-2,18),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopCenter(this.boxers,this,0,-110),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-26,-20),Phaser.Display.Align.In.TopRight(this.closeButton,this,-21,-22),Phaser.Display.Align.In.BottomCenter(this.cup,this,.5,-23),Phaser.Display.Align.In.BottomCenter(this.claimButton,this,0,16),Phaser.Display.Align.In.BottomCenter(this.retryButton,this,0,16),Phaser.Display.Align.In.BottomCenter(this.arrow,this,0,-40)},n.create=function(){this.createBackground(),this.createCup(),this.createHeader(),this.createDescription(),this.createBoxers(),this.createButtons(),this.createArrow()},n.createBackground=function(){var e=this.scene.add.image(0,0,bx,Tx.MAIN.POPUP);e.setWorldSize(1123/3,857/3),this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.createCup=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,bx,Tx.MAIN.CUP);t.setDefaultWorldSize(),e.add(t),e.setSize(t.width,t.height);var n=this.scene.add.image(0,0,bx,Tx.MAIN.TEXT_REWARD_COIN);n.setDefaultWorldSize(),n.setPosition(0,0),e.add(n),this.cup=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,bx,Tx.EFFECTS.VFX_HEADER);e.setDefaultWorldSize(),this.header.add(e),e.setPosition(0,-2);var t=this.scene.add.image(0,0,bx,Tx.MAIN.HEADER.VICTORY);t.setDefaultWorldSize(),this.header.add(t);var n=this.scene.add.image(0,0,bx,Tx.MAIN.HEADER.DEFEAT);n.setDefaultWorldSize(),this.header.add(n),n.kill(),this.vfxHeader=e,this.victoryHeader=t,this.defeatHeader=n;var i=new Pf(this.scene);i.setText("Victory!"),i.setFontSize(25),i.setRadius(-800),i.setLetterSpacing(0),i.setPosition(0,-9),this.header.add(i),this.title=i,this.header.setSize(t.width,t.height)},n.createDescription=function(){var e=new jp(this.scene,{text:"Collect more gloves than your\nopponent to win the prize!",fontSize:this.scene.fontSize(13),strokeColor:0,strokeThickness:1,strokeOffset:{y:0},strokeAlpha:.5});e.setCenterAlign(),this.add(e),this.description=e},n.createBoxers=function(){var e=new $T(this.scene);this.add(e),this.boxers=e},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createClaimButton(),this.createRetryButton()},n.createInformationButton=function(){var e=new iv.Z(this.scene,{key:bx,frame:Tx.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new iv.Z(this.scene,{key:bx,frame:Tx.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createClaimButton=function(){var e=new ax(this.scene);e.setText("CLAIM"),e.button.setName("Claim"),this.add(e),this.claimButton=e},n.createRetryButton=function(){var e=new ax(this.scene);e.setText("RETRY"),e.button.setName("Retry"),this.add(e),this.retryButton=e},n.createArrow=function(){var e=this.scene.add.image(0,0,bx,Tx.MAIN.ARROW);e.setDefaultWorldSize(),this.add(e),this.arrow=e},t}(Phaser.GameObjects.Container),Px=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.boxingDuelOverContainer=void 0,s.boxingDuelRewardContainer=void 0,s.amount=void 0,s.previousScreen=void 0,s.handleInformationButtonClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.boxingDuelRewardContainer.closeContainer();case 2:return e.next=4,s.scene.screen.openAsync(ce.o4.BOXING_DUEL.INTRO_SCREEN);case 4:s.scene.screen.bringToTop(ce.o4.BOXING_DUEL.MAIN_SCREEN),s.boxingDuelRewardContainer.openContainer();case 6:case"end":return e.stop()}}),e)}))),s.handleCloseButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s.boxingDuelRewardContainer.boxersStatus,e.t0=t,e.next=e.t0===GT.WON?4:e.t0===GT.LOST?7:10;break;case 4:return e.next=6,s.handlePlayButtonWonClick();case 6:case 9:case 10:return e.abrupt("break",11);case 7:return e.next=9,s.handlePlayButtonLostClick();case 11:case"end":return e.stop()}}),e)}))),s.handlePlayButtonWonClick=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.getWorldPosition(),n=t.x,i=t.y,(a=s.scene.rewardManager).rewardCoin(s.amount),s.scene.logEconomy.logGetItem(fl.COIN,s.amount,gl.BOXING_DUEL),s.boxingDuelRewardContainer.closeContainer(),s.scene.screen.bringToTop(ce.o4.BOXING_DUEL.REWARD_SCREEN),e.next=8,(0,le.qZ)(100);case 8:return e.next=10,a.coinAnimationPool.runAnimationRewardCoinAsync(15,n,i);case 10:return e.next=12,s.scene.boxingDuel.endCurrentMatch();case 12:s.scene.screen.close(ce.o4.BOXING_DUEL.REWARD_SCREEN),(0,dl.Z)(s.scene,100).then((function(){s.boxingDuelRewardContainer.reset()}));case 14:case"end":return e.stop()}}),e)}))),s.handlePlayButtonLostClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.scene.boxingDuel.endCurrentMatch();case 2:s.scene.screen.close(ce.o4.BOXING_DUEL.REWARD_SCREEN),(0,dl.Z)(s.scene,100).then((function(){s.boxingDuelRewardContainer.reset()}));case 4:case"end":return e.stop()}}),e)}))),s.close=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.background.off(Phaser.Input.Events.POINTER_DOWN),e.next=3,s.boxingDuelRewardContainer.closeContainer();case 3:s.runExitAnimation();case 4:case"end":return e.stop()}}),e)}))),s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.scene.gameUI.coinBarButton.setDisabled(!1),s.previousScreen&&s.scene.screen.open(s.previousScreen)},s.scene=t,s.amount=GameCore.Configs.BoxingDuel.RewardCoin,s.create(),s.listenEvents(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.boxingDuelRewardContainer.kill(),s.boxingDuelOverContainer.kill(),s}(0,s.Z)(t,e);var n=t.prototype;return n.handleCloseBoxingDuelOver=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.boxingDuelOverContainer.runExitAnimation();case 2:this.boxingDuelRewardContainer.open();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){var e=this.boxingDuelRewardContainer,t=e.informationButton,n=e.closeButton,i=e.claimButton,a=e.retryButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonWonClick,a.onClick=this.handlePlayButtonLostClick},n.create=function(){this.createDuelOverContainer(),this.createBoxingDuelRewardContainer()},n.createDuelOverContainer=function(){this.boxingDuelOverContainer=new wx(this.scene,this),this.boxingDuelOverContainer.setInteractive(),this.add(this.boxingDuelOverContainer)},n.createBoxingDuelRewardContainer=function(){this.boxingDuelRewardContainer=new xx(this.scene,this),this.boxingDuelRewardContainer.setInteractive(),this.add(this.boxingDuelRewardContainer)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.prototype.open.call(this,n),i=null!=n?n:{previousScreen:ce.o4.DASHBOARD_SCREEN},a=i.previousScreen,this.previousScreen=a,this.runEntranceAnimation(),!this.scene.boxingDuel.isFinished()){t.next=7;break}return t.next=7,this.boxingDuelOverContainer.open();case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),kx=Wi.Z.BOXING_DUEL,Ix=kx.KEY,Ox=kx.FRAME,Rx=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).scene=void 0,i.isPlayer=void 0,i.avatar=void 0,i.scoreText=void 0,i.playerName=void 0,i.crown=void 0,i.scene=t,i.isPlayer=n,i.create(),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){this.avatar.updateData(e),this.playerName.setText(this.avatar.playerName.text)},n.updateScore=function(e){this.scoreText.setText(e.toString())},n.showCrown=function(e){this.crown.setVisible(e)},n.alignItems=function(){var e=this.isPlayer?-92:92;this.avatar.setPosition(e,0);var t=this.isPlayer?25.5:-9;this.scoreText.setPosition(t,7.5);var n=this.isPlayer?25.5:-9;this.playerName.setPosition(n,-11);var i=this.isPlayer?-120:120;this.crown.setPosition(i,-38)},n.create=function(){this.createFrame(),this.createAvatar(),this.createCrown(),this.createPlayerName(),this.createScoreText()},n.createFrame=function(){var e=this.scene.add.image(0,0,Ix,this.isPlayer?Ox.VERSUS.FRAME.BLUE:Ox.VERSUS.FRAME.RED);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createAvatar=function(){var e=new jT(this.scene,this.isPlayer);this.add(e),e.playerName.kill(),e.avatar.setScale(249/201),e.showCrown(!1),this.avatar=e},n.createCrown=function(){var e=this.isPlayer?Ox.PLAYER.CROWN:Ox.OPPONENT.CROWN,t=this.scene.add.image(0,0,Ix,e);t.setDefaultWorldSize(),this.add(t),this.crown=t},n.createPlayerName=function(){var e=new jp(this.scene,{text:"Lilly",fontSize:this.scene.fontSize(14.3),fillColor:this.isPlayer?812793:16195908,strokeColor:16777215,strokeThickness:.1,strokeOffset:{y:.3},strokeAlpha:.5,letterSpacingExtra:.05});e.setCenterAlign(),this.add(e),this.playerName=e},n.createScoreText=function(){var e=new jp(this.scene,{text:"12",fontSize:this.scene.fontSize(14),strokeColor:this.isPlayer?5069721:9583440,strokeThickness:1.5,strokeOffset:{y:0},strokeAlpha:.9});e.setCenterAlign(),this.add(e),this.scoreText=e},t}(Phaser.GameObjects.Container),Bx=Wi.Z.BOXING_DUEL,Dx=Bx.KEY,Lx=Bx.FRAME,_x=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.player=void 0,n.opponent=void 0,n.playerEntranceX=void 0,n.opponentEntranceX=void 0,n.glow=void 0,n.vs=void 0,n.sparklesFlyUp=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.create(),n.reset(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateData();case 2:return e.next=4,(0,le.qZ)(100);case 4:return e.next=6,this.runEntranceAnimation();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.boxingDuel,n=t.getPlayer(),i=t.getOpponent(),this.player.updateData(n),this.opponent.updateData(i),a=n.score,r=(null==i?void 0:i.score)||0,this.player.updateScore(a),this.opponent.updateScore(r),this.player.showCrown(!1),this.opponent.showCrown(!1),a>r?this.player.showCrown(!0):a<r&&this.opponent.showCrown(!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sparklesFlyUp.run(2,500,0,0,40,40),this.playerEntranceX=-30,this.opponentEntranceX=30,t=this.runPlayerAnimation(),n=this.runOpponentAnimation(),i=this.runVersusAnimation(),e.next=8,Promise.all([t,n,i]);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runPlayerAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.scene.tweens.createTimeline()).add({targets:this.player,x:{from:-this.scene.gameZone.width-this.player.width/2,to:this.playerEntranceX},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.player,x:{from:this.playerEntranceX,to:this.scene.gameZone.width+this.player.width/2},duration:500,delay:500,ease:Phaser.Math.Easing.Back.In,easeParams:[.5]}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runOpponentAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.scene.tweens.createTimeline()).add({targets:this.opponent,x:{from:this.scene.gameZone.width+this.opponent.width/2,to:this.opponentEntranceX},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.opponent,x:{from:this.opponentEntranceX,to:-this.scene.gameZone.width-this.opponent.width/2},duration:500,delay:500,ease:Phaser.Math.Easing.Back.In,easeParams:[.5]}),e.abrupt("return",t.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runVersusAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runGlowAnimation(),this.runVsTextAnimation(),this.runSparklesAnimation(),e.abrupt("return",this.scene.tweens.add({targets:[this.glow,this.vs,this.sparklesFlyUp],alpha:{from:0,start:0,to:1,hold:500},yoyo:!0,duration:500,ease:Phaser.Math.Easing.Circular.Out,onComplete:function(){t.sparklesFlyUp.stop()}}).waitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowAnimation=function(){var e=this,t=1/GameCore.ImageScale;this.scene.tweens.add({targets:[this.glow],scale:{from:0,start:0,to:2.5*t,hold:500},angle:{from:0,start:0,to:20,hold:500,yoyo:!0},yoyo:!0,duration:500,ease:Phaser.Math.Easing.Back.Out,onStart:function(){e.glow.revive()},onComplete:function(){e.glow.kill()}})},n.runVsTextAnimation=function(){var e=1/GameCore.ImageScale,t=this.scene.tweens.createTimeline();t.add({targets:this.vs,scale:{from:0,start:0,to:e},duration:500,ease:Phaser.Math.Easing.Back.Out,easeParams:[.5]}),t.add({targets:this.vs,scale:{from:e,start:e,to:2*e},duration:500,delay:500,ease:Phaser.Math.Easing.Circular.In,easeParams:[.5]}),t.play()},n.runSparklesAnimation=function(){var e=this.scene.tweens.createTimeline();e.add({targets:this.sparklesFlyUp,scale:{from:.7,start:.7,to:1},duration:1e3,delay:500,ease:Phaser.Math.Easing.Circular.In,easeParams:[.5]}),e.play()},n.reset=function(){this.player.setX(-this.scene.gameZone.width-this.player.width/2),this.opponent.setX(this.scene.gameZone.width+this.opponent.width/2),this.glow.setAlpha(0),this.vs.setAlpha(0)},n.create=function(){this.createVersusGlow(),this.createVersus(),this.createPlayerVersus(),this.createOpponentVersus(),this.createSparklesFlyUp()},n.createSparklesFlyUp=function(){this.sparklesFlyUp=new WT(this.scene,Dx,Lx.EFFECTS.VS_LIGHT),this.add(this.sparklesFlyUp)},n.createVersusGlow=function(){var e=this.scene.add.image(0,0,Dx,Lx.EFFECTS.VFX_VS);e.setDefaultWorldSize(),e.setScale(2*e.scale),e.kill(),this.add(e),this.glow=e},n.createVersus=function(){var e=this.scene.add.image(0,0,Dx,Lx.MAIN.VS);e.setDefaultWorldSize(),this.add(e),this.vs=e},n.createPlayerVersus=function(){var e=new Rx(this.scene,!0);this.add(e),this.player=e,e.setPosition(-40,-62)},n.createOpponentVersus=function(){var e=new Rx(this.scene,!1);this.add(e),this.opponent=e,e.setPosition(51,62)},t}(Phaser.GameObjects.Container),Mx=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.mainContainer=void 0,r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.mainContainer=new _x(r.scene),r.add(r.mainContainer),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),yp.Z.registerObject(r.background,ce.MR.MULTIPLY_ALPHA),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.mainContainer.open();case 4:this.close();case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),Nx=function(){function e(e){this.scene=void 0,this.journeyScreenData=void 0,this.groupedJourneyScreenData=void 0,this.maxSizePerGroup=void 0,this.scene=e,this.maxSizePerGroup=GameCore.layoutInitializer.isLandscape?3:4,this.updateData()}var t=e.prototype;return t.updateData=function(){this.journeyScreenData=this.getNewJourneyScreenData(),this.groupedJourneyScreenData=this.transformJourneyScreenData(this.journeyScreenData)},t.getNewJourneyScreenData=function(){var e=this,t=this.scene.journey.getAllStages(),n=this.scene.journey.getCurrentStage(),i=t.findIndex((function(e){return e.worldNumber===n.worldNumber})),a=this.scene.player.getJourneyProgress(),r=a.finishedLocationIds,s=a.inProgressLocation;return{blockPayloads:t.map((function(t,i){if(r.length>0&&r.includes(t.worldNumber.toString()))return e.getCompletedMapBlockPayload(t);if(n.worldNumber===t.worldNumber){if(s){var a=s.progress;return e.getPlayingMapBlockPayload(t,a)}return e.getPlayingMapBlockPayload(t,0)}return e.getLockedMapBlockPayload(t)})),currentStageIndex:i}},t.getLockedMapBlockPayload=function(e){var t=this.getBaseMapBlockPayload(e);return(0,a.Z)({},t)},t.getCompletedMapBlockPayload=function(e){var t=this.getBaseMapBlockPayload(e);return(0,a.Z)({},t,{progressBar:{lock:!1,currentProgress:15,maxProgress:15}})},t.getPlayingMapBlockPayload=function(e,t){var n=this.getBaseMapBlockPayload(e);return(0,a.Z)({},n,{progressBar:{lock:!1,currentProgress:t,maxProgress:15}})},t.getBaseMapBlockPayload=function(e){var t=e.worldNumber,n=e.name,i=e.backgroundKey,a=e.backgroundFile;return{worldNumber:t,name:n,thumbnail:{key:this.getThumbnailKey(i),url:this.getThumbnailFile(a)},progressBar:{lock:!0,currentProgress:0,maxProgress:15}}},t.getThumbnailKey=function(e){return"thumbnail"+e},t.getThumbnailFile=function(e){return e.replace("/2x/","/2x/previews/").replace(".jpg",".png")},t.transformJourneyScreenData=function(e){var t=this.chunkArray(e.blockPayloads,this.maxSizePerGroup),n=e.currentStageIndex,i=this.getGroupedElementByFlatIndex(t,n)||0;return(0,a.Z)({},e,{blockPayloads:t,currentGroupIndex:i.groupIndex,currentStageIndex:i.elementIndex})},t.chunkArray=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},t.getGroupedElementByFlatIndex=function(e,t){var n=Math.floor(t/this.maxSizePerGroup),i=t%this.maxSizePerGroup;if(n<0||n>=e.length)return{groupIndex:0,elementIndex:0};var a=e[n];return i<0||i>=a.length?{groupIndex:0,elementIndex:0}:{groupIndex:n,elementIndex:i}},t.getTotalMaps=function(){return this.journeyScreenData.blockPayloads.length},t.getTotalPages=function(){return this.groupedJourneyScreenData.blockPayloads.length},t.getGroupedJourneyScreenData=function(){return this.groupedJourneyScreenData},t.getMaxSizePerGroup=function(){return this.maxSizePerGroup},e}(),Gx=Wi.Z.DASHBOARD,Zx=Gx.KEY,Fx=Gx.FRAME,Ux=function(e){function t(t){var n;return(n=e.call(this,t)||this).minProgressWidth=void 0,n.maxProgressWidth=void 0,n.progressHeight=void 0,n.progress=void 0,n.progressText=void 0,n.timerText=void 0,n.kill(),n.setSize(144,37),n.minProgressWidth=20,n.maxProgressWidth=332/3,n.progressHeight=20,n.createBackground(),n.createProgress(),n.createCoinIcons(),n.createText(),n.createTimer(),n.updateProgress(40),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateProgress=function(e){e>100&&(e=100);var t=Math.floor(e/100*this.maxProgressWidth),n=Phaser.Math.Clamp(t,this.minProgressWidth,this.maxProgressWidth);this.progress.setSizeByWorld(n,this.progressHeight)},n.createBackground=function(){var e=this.scene.add.image(0,0,Zx,Fx.PROGRESS.TRACK);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},n.createProgress=function(){var e=this.scene.make.nineslice({key:Zx,frame:Fx.PROGRESS.FILL,width:418/3,height:62/3,leftWidth:10,rightWidth:10});e.setOrigin(0,.5),this.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-2,-6),this.progress=e},n.createCoinIcons=function(){var e=this.scene.add.image(0,0,Zx,Fx.ICON.COIN);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,Zx,Fx.ICON.COIN);t.setDefaultWorldSize(),this.add([e,t]),Phaser.Display.Align.In.LeftCenter(e,this,14,-6),Phaser.Display.Align.In.RightCenter(t,this,14,-6)},n.createText=function(){var e=new hv(this.scene);e.setText("20 / 50"),e.setFontSize(15),e.setColor(16777215),e.stroke.kill(),e.shadow.kill(),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-6),this.progressText=e},n.createTimer=function(){var e=new hv(this.scene);e.setText("22h 12m"),e.setFontSize(10),e.setColor(16777215),e.stroke.setTint(0),e.stroke.setY(.5),e.shadow.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,0),this.timerText=e},t}(Phaser.GameObjects.Container),Wx=Ux,Hx=function(e,t){this.scene=void 0,this.manager=void 0,this.scene=e},Yx=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).canShowLocationUpgradeGuide=void 0,i.canShowLocationUpgradeGuide=!0,i}(0,s.Z)(t,e);var n=t.prototype;return n.play=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canShowLocationUpgradeGuide){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.showLocationButtonGuide();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.canPlay=function(){var e=this.scene.locationManager.getUnlockableSlots();return this.scene.level.getLevel()>=4&&e.length>0&&!this.scene.locationManager.hasBuiltDecoration()},n.stop=function(){this.scene.screen.get(ce.o4.DASHBOARD_SCREEN).guideContainer.hideGuide()},n.showLocationButtonGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.screen.get(ce.o4.DASHBOARD_SCREEN),n=t.locationButton,i=t.blackBackground,a=t.guideContainer,t.bringToTop(i),t.bringToTop(n),t.bringToTop(a),t.runFadeBackground(0,1,250,0),s=n.x,o=n.y,a.showArrowAnimation(s,o-65),e.next=10,a.showGuide({x:s,y:o,showHighlight:!1,textBox:{textX:s,textY:o-120,text:"Tap here to start \n building your Journey!",textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}});case 10:this.scene.events.once(hi.LOCATION_DECORATION_OPEN,(function(){a.hideGuide(),a.hideArrowAnimation(),t.runFadeBackground(1,0,250,0),h.scene.gameUI.setDisableButtons(!0)})),this.scene.events.once(hi.OPENED_LOCATION_DECORATION,(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.scene.locationManager.setButtonDisabled(!0),h.showLocationUpgradeGuide();case 2:case"end":return e.stop()}}),e)}))));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLocationUpgradeGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(ce.o4.DASHBOARD_SCREEN),n=t.guideContainer,i=this.scene,a=i.locationManager,r=i.gameUI,s=a.getGuidedSlot()){e.next=6;break}return e.abrupt("return");case 6:if(a.isGuided=!0,a.highlightDecorationSlots(),o=!a.hasBuiltDecoration(),t.bringToTop(n),!o){e.next=15;break}return a.runFadeBackground(0,1,250,0),r.runFadeCoinBar(.6,250),e.next=15,n.showGuide({x:0,y:0,showHighlight:!1,textBox:{textX:0,textY:-110,text:"Use the stars you collect \n to build your Journey!",textAlignType:au.CENTER,useBackground:!0,font:Pc.ZP.NORMAL.KEY,tint:11106656,lineHeight:70},icon:{iconVisible:!1}});case 15:a.setButtonDisabled(!1),h=s.x,u=s.y,n.showHandAnimation(h+15,u+10),this.scene.journey.events.once(hi.DECORATION_UPGRADE,(function(){n.hideGuide(),o&&(a.runFadeBackground(1,0,250,0),r.setDisableButtons(!1),r.runFadeCoinBar(1,250))})),this.scene.journey.events.once(hi.DECORATION_UPGRADED,(function(){l.canShowLocationUpgradeGuide&&l.showLocationUpgradeGuide()})),this.scene.events.once(hi.CANNOT_UPGRADE_DECORATION,(function(){var e=l.scene.screen.get(ce.o4.DASHBOARD_SCREEN),t=a.blackBackground;a.bringToTop(t),l.canShowLocationUpgradeGuide=!1,e.guideContainer.hideGuide(),a.runFadeBackground(void 0,0,250,0),l.scene.gameUI.setDisableButtons(!1)}));case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Hx),Kx=Yx,zx=function(){function e(e){this.scene=void 0,this.locationDecorationGuide=void 0,this.scene=e,this.locationDecorationGuide=new Kx(this.scene,this)}var t=e.prototype;return t.canPlayLocationDecorationGuide=function(){return this.locationDecorationGuide.canPlay()},t.playLocationDecorationGuide=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationDecorationGuide.play();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Vx=zx,jx=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e}({}),Xx=function(e){return e[e.LOCATION_BUTTON=0]="LOCATION_BUTTON",e}({}),qx=Wi.Z.GAMEPLAY_DEFAULT,Jx=qx.KEY,Qx=qx.FRAME,$x=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.arrow=void 0,n.highLightCircle=void 0,n.tutorialHand=void 0,n.guideContainer=void 0,n.zone=void 0,n.arrowAnimation=void 0,n.guideAnimation=void 0,n.showHighLightTween=void 0,n.guideManager=void 0,n.updateComponent=function(e,t){n.tutorialHand.update(t)},n.stop=function(){var e,t;n.arrow.kill(),null==(e=n.arrowAnimation)||e.stop(),n.hideHandAnimation(),n.guideContainer.kill(),null==(t=n.showHighLightTween)||t.remove(),n.highLightCircle.kill(),n.highLightCircle.setAlpha(0)},n.scene=t,n.createArrow(),n.createHighLightCircle(),n.createTextBoxContainer(),n.createTutorialHand(),n.createGuideZone(),n.listenEvents(),n.guideManager=new Vx(t),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateComponent),this.scene.events.on(hi.HIDE_GUIDE,this.hideGuide,this)},n.playGuide=function(e){if(e===Xx.LOCATION_BUTTON)this.guideManager.playLocationDecorationGuide()},n.showArrowAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&n&&this.arrow.setPosition(t,n),this.arrow.revive(),null==(i=this.arrowAnimation)||i.stop(),a=this.scene.tweens.createTimeline(),this.arrow.scaleX=1/GameCore.ImageScale+.02,this.arrow.scaleY=1/GameCore.ImageScale-.01,r=350,7,this.arrow.y+=7,a.add({targets:this.arrow,alpha:1,duration:200}),a.add({targets:this.arrow,scaleX:"-=0.02",scaleY:"+=0.01",duration:r/6,offset:0,yoyo:!0,repeat:-1,hold:3500/6,ease:Phaser.Math.Easing.Quadratic.In}),a.add({targets:this.arrow,delay:r/6,y:"-=7",duration:1750/6,offset:0,ease:Phaser.Math.Easing.Quadratic.Out}),a.add({targets:this.arrow,y:"+=7",duration:1750/6,yoyo:!0,repeat:-1,hold:700/6,ease:Phaser.Math.Easing.Quadratic.In}),a.play(),this.arrowAnimation=a;case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.showHandAnimation=function(e,t){this.tutorialHand.revive(),this.tutorialHand.setPosition(e,t),this.tutorialHand.runTap()},n.hideArrowAnimation=function(){var e,t=this;null==(e=this.arrowAnimation)||e.stop();var n=this.scene.tweens.createTimeline();n.add({targets:this.arrow,alpha:0,duration:200,onComplete:function(){t.arrow.kill()}}),n.play(),this.arrowAnimation=n},n.hideHandAnimation=function(){this.tutorialHand.stopTap(),this.tutorialHand.kill()},n.hideGuide=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideHandAnimation(),this.hideHighLightCircle(),null==(t=this.guideAnimation)||t.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:0,duration:300,onComplete:function(){n.guideContainer.kill()}}),e.next=6,this.guideAnimation.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showHighLightCircle=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){var r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=1/GameCore.ImageScale,this.highLightCircle.revive(),this.highLightCircle.setPosition(t,n),null==(r=this.showHighLightTween)||r.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,scaleX:{start:(i+1)*s,from:(i+1)*s,to:s*i,duration:400},scaleY:{start:(a+1)*s,from:(a+1)*s,to:s*a,duration:400},alpha:{start:0,from:0,to:.5},duration:300,ease:Phaser.Math.Easing.Sine.Out}),e.next=7,this.showHighLightTween.waitForCompletion();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.hideHighLightCircle=function(){var e,t=this;this.highLightCircle.visible&&(null==(e=this.showHighLightTween)||e.remove(),this.showHighLightTween=this.scene.tweens.add({targets:this.highLightCircle,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:function(){t.highLightCircle.kill()}}))},n.showGuide=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u,l,d,p,f,m,g,v,y,E,C,A,w,S,b,T,x,P,k,I,O,R,B,D,L,_,M,N,G,Z,F,U,W,H,Y,K,z,V,j,X,q,J,Q,$,ee,te,ne,ie,ae,re,se;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=t||{}).x,r=void 0===a?0:a,s=i.y,o=void 0===s?0:s,h=i.circleScaleX,u=void 0===h?1:h,l=i.circleScaleY,d=void 0===l?1:l,p=i.textBox,f=p.textX,m=void 0===f?0:f,g=p.textY,v=void 0===g?0:g,y=p.text,E=void 0===y?"":y,C=p.textVisible,A=void 0===C||C,w=p.textAlignType,S=void 0===w?au.CENTER:w,b=p.useBackground,T=void 0!==b&&b,x=p.font,P=void 0===x?Pc.ZP.PRIMARY.KEY:x,k=p.fontSize,I=void 0===k?16:k,O=p.tint,R=p.lineHeight,B=void 0===R?56:R,D=p.boxWidth,void 0===D?235:D,L=p.boxHeight,void 0===L?70:L,_=i.icon,M=_.iconX,N=void 0===M?0:M,G=_.iconY,Z=void 0===G?0:G,F=_.iconDirection,U=void 0===F?jx.DOWN:F,W=_.flipX,H=void 0!==W&&W,Y=_.iconVisible,K=void 0===Y||Y,z=i.showHighlight,V=void 0===z||z,this.guideContainer.revive(),j=this.guideContainer,X=j.bg,q=j.icon,J=j.text,Q=j.shadow,$=1/GameCore.ImageScale,this.guideContainer.setText(E,S),Q.setVisible(!T&&!V),J.setVisible(A),J.setFont(P),J.setFontSize(this.scene.fontSize(I)),J.setLineHeight(B),X.setVisible(T),X.setSizeByWorld(this.guideContainer.text.width+20,this.guideContainer.text.height+20),ee=this.scene.gameZone.width,this.guideContainer.setPosition(Phaser.Math.Clamp(m,-ee/2+X.displayWidth/2+5,ee/2-X.displayWidth/2-5),v),te=this.guideContainer.getLocalPoint(N,Z),ne=te.x,ie=te.y,O?J.setTint(O):J.clearTint(),q.setPosition(ne,ie),q.setVisible(K),ae=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_SIDE,re=H,U===jx.UP?ae=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_UP:U===jx.DOWN?ae=Wi.Z.GAMEPLAY_DEFAULT.FRAME.TUTORIAL.ARROW_DOWN:re=U!==jx.LEFT,q.setTexture(Wi.Z.GAMEPLAY_DEFAULT.KEY,ae),q.setDefaultWorldSize(),re&&q.setScale(-1*$,$),se=[],null==(n=this.guideAnimation)||n.remove(),this.guideAnimation=this.scene.tweens.add({targets:this.guideContainer,alpha:1,duration:300}),se.push(this.guideAnimation.waitForCompletion()),V&&se.push(this.showHighLightCircle(r,o,u,d)),this.zone.setVisible(!0),e.next=32,Promise.all(se);case 32:this.zone.setVisible(!1);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createArrow=function(){var e=this.scene.add.image(0,0,Jx,Qx.ARROW_GREEN);e.setDefaultWorldSize(),e.kill(),e.setDepth(Fr.Z.GUIDE),e.setAlpha(0),this.add(e),this.arrow=e},n.createTutorialHand=function(){var e=new bm(this.scene);e.kill(),this.add(e),this.tutorialHand=e},n.createHighLightCircle=function(){var e=new Em(this.scene);e.kill(),e.setAlpha(0),e.setTint(0),this.add(e),this.highLightCircle=e,yp.Z.registerObject(this.highLightCircle)},n.createTextBoxContainer=function(){var e=new fm(this.scene);this.scene.add.existing(e),e.kill(),e.setDepth(Fr.Z.GUIDE),e.setAlpha(0),this.add(e),this.guideContainer=e},n.createGuideZone=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.scene.add.zone(0,0,t,n);i.setVisible(!1),i.setInteractive(),i.setDepth(Fr.Z.GUIDE),Phaser.Display.Align.In.Center(i,this.scene.gameZone),this.zone=i},t}(Phaser.GameObjects.Container),eP=$x,tP=50,nP=32,iP=77/3,aP=77/3,rP=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).setSize(tP,nP),i.button.kill(),i.icon.setWorldSize(iP,aP),i.scene.add.existing((0,fc.Z)(i)),i}return(0,s.Z)(t,e),t.prototype.updateSize=function(){this.button.setWorldSize(tP,nP),e.prototype.updateSize.call(this)},t}(zg),sP=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).button=void 0,i.setSize(tP,nP),i.create(n),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(e){var t=new rP(this.scene,{enable:e.enable,frameOn:e.frameOn,frameOff:e.frameOff,backgroundOn:e.backgroundOn,backgroundOff:e.backgroundOff});this.add([t]),this.button=t},n.setDisabled=function(e){this.button.setDisabled(e)},n.updateStatus=function(e){this.button.updateStatus(e)},t}(Phaser.GameObjects.Container),oP=sP,cP=Wi.Z.DEFAULT.FRAME,hP=function(e){function t(t,n){var i;(i=e.call(this,t,n)||this).icon=void 0;var a=n.key;return i.icon=i.scene.add.image(0,0,a,cP.SETTINGS.GAMEPLAY.SETTINGS_ICON),i.icon.setDefaultWorldSize(),i.add(i.icon),i}(0,s.Z)(t,e);var n=t.prototype;return n.playRotateClockwiseAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1e3),e.next=3,this.scene.tweens.add({targets:this.icon,angle:179.99,duration:t,ease:Phaser.Math.Easing.Quadratic.Out}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playRotateCounterClockwiseAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1e3),e.next=3,this.scene.tweens.add({targets:this.icon,angle:0,duration:t,ease:Phaser.Math.Easing.Quadratic.In}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(iv.Z),uP=hP,lP=Wi.Z.DEFAULT,dP=lP.KEY,pP=lP.FRAME,fP={WIDTH:92/3,HEIGHT:452/3},mP=function(e){function t(t,n,i){var a;return void 0===n&&(n=!1),void 0===i&&(i=!0),(a=e.call(this,t,40,40)||this).scene=void 0,a.buttons=[],a.toggleButtons=[],a.background=void 0,a.exitGameBtn=void 0,a.vibrationSwitchUI=void 0,a.soundSwitchUI=void 0,a.musicSwitchUI=void 0,a.settingButton=void 0,a.buttonsWrapper=void 0,a.backgroundHeight=void 0,a.toggleButtonsPosY=[],a.settingButtonPosY=void 0,a.settingsOpening=void 0,a.settingsPlaying=void 0,a.canHandleSettings=void 0,a.isPopupDirectionDown=void 0,a.useExitGameBtn=void 0,a.handleSettingsOnClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.settingsOpening?a.closeSettings():a.openSettings();case 1:case"end":return e.stop()}}),e)}))),a.openSettings=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=250),a.canHandleSettings){e.next=3;break}return e.abrupt("return");case 3:if(!a.settingsPlaying){e.next=5;break}return e.abrupt("return");case 5:return a.updateData(),a.settingsPlaying=!0,e.next=9,a.open(t);case 9:a.settingsPlaying=!1,a.settingsOpening=!0;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.closeSettings=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=250),a.canHandleSettings){e.next=3;break}return e.abrupt("return");case 3:if(!a.settingsPlaying){e.next=5;break}return e.abrupt("return");case 5:return a.settingsPlaying=!0,e.next=8,a.close(t);case 8:a.settingsPlaying=!1,a.settingsOpening=!1;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleSoundChange=function(e){a.scene.player.setSetting("sound",e)},a.handleMusicChanged=function(e){a.scene.player.setSetting("music",e),e?a.scene.resumeMusic():a.scene.audio.pauseAllMusics()},a.handleVibrationChanged=function(e){a.scene.player.setSetting("vibrate",e),e&&a.scene.vibration.performVibrating(50)},a.handleOpenExitGameScreen=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.canHandleSettings){e.next=2;break}return e.abrupt("return");case 2:a.scene.screen.open(ce.o4.EXIT_GAME_SCREEN,{exitCallback:function(){a.scene.turnOffMusic(Fc.Z.GAMEPLAY_BACKGROUND.KEY),a.scene.screen.close(ce.o4.EXIT_GAME_SCREEN),a.scene.gameplay.boardGame.stateMachine.emit(Jh.EXIT);var e=a.scene.gameplay.boardGame.blackBackground.alpha;a.scene.gameplay.boardGame.runFadeBackground(e,0,250,0)},playOnCallback:function(){a.scene.screen.close(ce.o4.EXIT_GAME_SCREEN)},eventItems:a.scene.gameplay.eventManager.getCurrentEventItems()}),a.handleSettingsOnClick();case 4:case"end":return e.stop()}}),e)}))),a.handleExitGame=function(){a.scene.gameplay.enableCardInput&&a.scene.screen.open(ce.o4.EXIT_GAME_SCREEN,{exitCallback:function(){var e=a.scene.gameplay.boardGame,t=a.scene.world.getWorldSize(),n=t.width,i=t.height;a.scene.screen.close(ce.o4.EXIT_GAME_SCREEN),e.locks.forEach((function(e){e.exit()})),e.blowCardsBehavior.blow(n/2,i/2).then((function(){e.stateMachine.emit(Jh.LOSE)})),a.scene.gameUI.gameUILayout.hidePlusCardsButtons(),a.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.END_GAME),a.scene.analytics.event(te._.LEVEL_GIVE_UP,{level:a.scene.level.getLevel()})},playOnCallback:function(){a.scene.screen.close(ce.o4.EXIT_GAME_SCREEN)}})},a.scene=t,a.isPopupDirectionDown=n,a.useExitGameBtn=i,a.settingsOpening=!1,a.settingsPlaying=!1,a.canHandleSettings=!0,a.create(),a.alignToggleButtons(),a.updateBackgroundSize(),a.bindSettingsEvents(),t.add.existing((0,fc.Z)(a)),a.listenAudioEnabledChange(),a}(0,s.Z)(t,e);var n=t.prototype;return n.listenAudioEnabledChange=function(){var e=this;GameSDK.onAudioEnabledChange((function(t){e.soundSwitchUI.updateStatus(t),e.musicSwitchUI.updateStatus(t),e.soundSwitchUI.setDisabled(!t),e.musicSwitchUI.setDisabled(!t)}))},n.setCanHandleSettings=function(e){this.canHandleSettings=e},n.bindSettingsEvents=function(){var e=this.settingButton,t=this.soundSwitchUI,n=this.musicSwitchUI,i=this.vibrationSwitchUI,a=this.exitGameBtn;t.button.onClick=this.handleSoundChange,n.button.onClick=this.handleMusicChanged,i&&(i.button.onClick=this.handleVibrationChanged),a&&(a.button.onClick=this.handleOpenExitGameScreen),e.onClick=this.handleSettingsOnClick},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.soundSwitchUI,c=this.musicSwitchUI,h=this.vibrationSwitchUI;o.button.updateStatus(n),c.button.updateStatus(a),h&&h.button.updateStatus(s)},n.getBounds=function(){var e=this.background.getBounds();return new Phaser.Geom.Rectangle(e.x,e.y,43,e.height)},n.open=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),n=this.settingButton.y,20,i=n+20*this.buttons.length+2,a=this.scene.tweens.addCounter({from:i,to:this.backgroundHeight,duration:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){return u.background.revive()},onUpdate:function(e){var t=(e.getValue()-i)/(u.backgroundHeight-i);u.background.setSizeByWorld(u.background.displayWidth,e.getValue()),u.background.alpha=t}}).waitForCompletion(),r=this.toggleButtons.map((function(e,n){return e.y=.5*u.toggleButtonsPosY[n],e.alpha=0,u.scene.tweens.add({targets:e,duration:t,y:u.toggleButtonsPosY[n],ease:Phaser.Math.Easing.Back.Out,alpha:1,onStart:function(){return e.revive()}}).waitForCompletion()})),s=this.toggleButtons.map((function(e,n){var i=u.scene.tweens.createTimeline();return e.scaleX=1.05,i.add({delay:.35*t,targets:e,duration:.15*t,ease:Phaser.Math.Easing.Sine.InOut,scaleY:.9}),i.add({targets:e,duration:.45*t,ease:Phaser.Math.Easing.Sine.InOut,scaleX:.98,scaleY:1.1}),i.add({targets:e,duration:.25*t,ease:Phaser.Math.Easing.Quadratic.InOut,scaleX:1,scaleY:1}),i.play(),i.waitForCompletion()})),o=this.settingButton.playRotateClockwiseAnimation(t),(h=[]).push(a),h.push.apply(h,r),h.push.apply(h,s),h.push(o),e.next=15,Promise.all(h);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=250),n=.8,i=this.background.displayWidth,a=this.scene.tweens.addCounter({from:this.backgroundHeight,to:n*this.backgroundHeight,duration:t,ease:Phaser.Math.Easing.Back.In,onUpdate:function(e){var t=e.getValue()/h.backgroundHeight;h.background.setSizeByWorld(i*t,e.getValue()),h.background.alpha=(t-n)/(1-n)},onComplete:function(){h.background.setSizeByWorld(i,h.backgroundHeight),h.background.kill()}}).waitForCompletion(),r=this.toggleButtons.map((function(e,i){return h.scene.tweens.add({targets:e,duration:t,y:h.toggleButtonsPosY[i]*n,scale:n,alpha:0,ease:Phaser.Math.Easing.Back.In,onComplete:function(){e.scale=1,e.kill()}}).waitForCompletion()})),s=this.settingButton.playRotateCounterClockwiseAnimation(t),(o=[]).push(a),o.push.apply(o,r),o.push(s),e.abrupt("return",Promise.all(o));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBackgroundSize=function(){var e=this.settingButton.displayHeight,t=this.buttons[0],n=this.buttons[this.buttons.length-1];this.backgroundHeight=Math.abs(n.y-t.y)+e+3,this.background.setSizeByWorld(this.background.displayWidth,this.backgroundHeight);var i=this.isPopupDirectionDown?(e+2)/2:-(e+2)/2;this.background.setY(this.settingButton.y-i)},n.alignToggleButtons=function(){var e=this,t=GameCore.layoutInitializer.isLandscape?30:-30;this.buttons.forEach((function(n,i){var a=e.isPopupDirectionDown?i*t:-i*t;n.setY(a)})),this.toggleButtons=this.buttons.filter((function(e){return e.active&&e instanceof oP})),this.toggleButtonsPosY=this.toggleButtons.map((function(e){return e.y})),this.settingButtonPosY=this.settingButton.y},n.create=function(){this.createButtonsWrapper(),this.createBackground(),this.createSettingButton(),this.createToggleButtons(),this.createExitGameButton()},n.createButtonsWrapper=function(){var e=this.scene.add.container(0,0);this.add(e),this.buttonsWrapper=e},n.createBackground=function(){var e=this.scene.make.nineslice({key:dP,frame:pP.SETTINGS.GAMEPLAY.BACKGROUND,topHeight:25,bottomHeight:25,leftWidth:10,rightWidth:10,width:fP.WIDTH,height:fP.HEIGHT});e.setOrigin(.5,this.isPopupDirectionDown?0:1),this.buttonsWrapper.add(e),this.background=e},n.createExitGameButton=function(){if(this.useExitGameBtn){var e=new oP(this.scene,{enable:!0,frameOn:pP.SETTINGS.GAMEPLAY.QUIT,frameOff:pP.SETTINGS.GAMEPLAY.QUIT,backgroundOn:pP.SETTINGS.GAMEPLAY.QUIT,backgroundOff:pP.SETTINGS.GAMEPLAY.QUIT});e.button.setName("ExitGameSettings"),this.buttonsWrapper.add(e),this.exitGameBtn=e,this.buttons.push(e)}},n.createToggleButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.createVibrationButton(s),c=this.createSoundButton(n),h=this.createMusicButton(a);this.buttonsWrapper.add([o,c,h]),this.buttons.push(h,c),av()?this.buttons.push(o):o.kill()},n.createVibrationButton=function(e){var t=new oP(this.scene,{enable:e,frameOn:pP.SETTINGS.GAMEPLAY.VIBRATE_ON,frameOff:pP.SETTINGS.GAMEPLAY.VIBRATE_OFF,backgroundOn:pP.SETTINGS.GAMEPLAY.VIBRATE_ON,backgroundOff:pP.SETTINGS.GAMEPLAY.VIBRATE_OFF});return t.button.setName("VibrationSwitch"),t.button.updateStatus(e),this.vibrationSwitchUI=t,t},n.createSoundButton=function(e){var t=new oP(this.scene,{enable:e,frameOn:pP.SETTINGS.GAMEPLAY.SOUND_ON,frameOff:pP.SETTINGS.GAMEPLAY.SOUND_OFF,backgroundOn:pP.SETTINGS.GAMEPLAY.SOUND_ON,backgroundOff:pP.SETTINGS.GAMEPLAY.SOUND_OFF});return t.button.setName("SoundSwitch"),t.button.updateStatus(e),this.soundSwitchUI=t,t},n.createMusicButton=function(e){var t=new oP(this.scene,{enable:e,frameOn:pP.SETTINGS.GAMEPLAY.MUSIC_ON,frameOff:pP.SETTINGS.GAMEPLAY.MUSIC_OFF,backgroundOn:pP.SETTINGS.GAMEPLAY.MUSIC_ON,backgroundOff:pP.SETTINGS.GAMEPLAY.MUSIC_OFF});return t.button.setName("MusicSwitch"),t.button.updateStatus(e),this.musicSwitchUI=t,t},n.createSettingButton=function(){var e=new uP(this.scene,{key:dP,frame:pP.SETTINGS.GAMEPLAY.BLUE,width:77/3,height:77/3,paddingZone:18});e.setName("Settings"),this.add(e),this.settingButton=e,this.buttons.push(e)},t}(Kp.Z),gP=mP,vP=function(e){function t(t){var n;return(n=e.call(this)||this).matrix=void 0,n.config=void 0,n.matrix=new Phaser.GameObjects.Components.TransformMatrix,n.resetFromJSON(t),n}(0,s.Z)(t,e);var n=t.prototype;return n.setStartEndPoint=function(e,t){this.config.startPoint=e,this.config.endPoint=t,this.resetFromJSON(this.config)},n.resetFromJSON=function(e){this.config=(0,a.Z)({},e);var t=e.vertices||[],n=e.isClose||!1,i=e.flipX,r=void 0!==i&&i,s=e.flipY,o=void 0===s||s;if(!(t.length<6)){var c=t.map((function(e,t){return t%2==0?r?-e:e:o?-e:e})),h=c.length,u=[c[2],c[3]],l=[c[h-2-2],c[h-1-2]],d=e.startPoint||u,p=e.endPoint||l,f=Math.sqrt(Math.pow(p[0]-d[0],2)+Math.pow(p[1]-d[1],2)),m=Math.sqrt(Math.pow(l[0]-u[0],2)+Math.pow(l[1]-u[1],2)),g=(d[0],d[1],Phaser.Math.Angle.Between(d[0],d[1],p[0],p[1])-Phaser.Math.Angle.Between(u[0],u[1],l[0],l[1])),v=f/m;this.matrix.applyITRS(d[0],d[1],g,v,v);for(var y=[],E=0;E<h;E+=2){var C=c[E]-u[0],A=c[E+1]-u[1],w=this.matrix.getX(C,A),S=this.matrix.getY(C,A);y.push(w,S)}this.moveTo(d[0],d[1]);for(var b=4;b<h-6;b+=6)this.cubicBezierTo(y[b+4],y[b+5],y[b],y[b+1],y[b+2],y[b+3]);return n&&this.cubicBezierTo(d[0],d[1],y[h-2],y[h-1],y[0],y[1]),this}},n.deform=function(e){var t=this.config.vertices.map((function(t,n){return t+(e[n]||0)}));this.curves=[],this.cacheLengths=[],this.resetFromJSON((0,a.Z)({},this.config,{vertices:t}))},n.setDebug=function(e,t){var n=this;void 0===t&&(t=16711680);var i=e.add.graphics();e.events.on("update",(function(){i.clear(),i.lineStyle(1,t,1);for(var e=0;e<n.curves.length;e++){var a=n.curves[e];a.draw&&a.draw(i)}}))},t}(Phaser.Curves.Path),yP=vP,EP=Wi.Z.DASHBOARD,CP=EP.KEY,AP=EP.FRAME,wP=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).background=void 0,a.rankText=void 0,a.create(),a.setRank(23),a}(0,s.Z)(t,e);var n=t.prototype;return n.updateBackgroundToWin=function(e){this.background.setFrame(e?AP.EVENTS_COMMON.RANK_BLOCK_GREEN:AP.EVENTS_COMMON.RANK_BLOCK_BLUE),this.background.setDefaultWorldSize()},n.setRank=function(e,t){void 0===t&&(t=!1),this.setVisible(e>0);var n=e<100?""+e:"99+",i=e<100?11:9,a=e<100?.25:.5;this.rankText.setFontSize(this.scene.fontSize(i)),this.rankText.setPosition(0,a),this.rankText.setText(n),this.updateBackgroundToWin(t)},n.create=function(){var e=this.scene.add.image(0,0,CP,AP.EVENTS_COMMON.RANK_BLOCK_BLUE);e.setDefaultWorldSize(),e.setY(.5),this.setSize(e.width,e.height);var t=new jp(this.scene,{text:"1",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setPosition(0,.5),this.add([e,t]),this.rankText=t,this.background=e},t}(Phaser.GameObjects.Container),SP=wP,bP=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.countdownTimer=void 0,a.timeText="7d 10h 5m",a.startTime=void 0,a.rtMs=void 0,a.txt=void 0,a.scene=t,a.rtMs=0,a.setSize(n,i),a.createTimeText(),t.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.createTimeText=function(){this.txt=new jp(this.scene,{text:"11",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.add(this.txt)},n.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.countdownTimer.remove();else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.timeText=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.txt.setFontSize(t.scene.fontSize(10)),t.txt.setText(t.timeText)}}})},n.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},n.setText=function(e,t){var n;void 0===t&&(t=10),null==(n=this.countdownTimer)||n.remove(),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),TP=bP,xP=Wi.Z.DASHBOARD,PP=xP.KEY,kP=xP.FRAME,IP=function(e){function t(t){var n;return(n=e.call(this,t)||this).sparksCount=6,n.sparks=[],n.wave=void 0,n.glow=void 0,n.animation=void 0,n.container=void 0,n.container=n.scene.add.container(),n.add(n.container),n.createSparks(),n.createWave(),n.createGlow(),n.createAnimation(),n.setDepth(Fr.Z.ON_TOP),n.kill(),n.container.setPosition(0,0),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.explode=function(){var e,t;null==(e=this.animation)||e.setTimeScale(1),null==(t=this.animation)||t.start()},n.createSparks=function(){for(var e=0;e<this.sparksCount;e++){var t=this.scene.add.image(0,0,PP,kP.EFFECTS.SPARKS).setAlpha(0);t.setDefaultWorldSize(),t.scale*=.53448,this.sparks.push(t)}this.container.add(this.sparks)},n.createWave=function(){this.wave=this.scene.add.image(0,5,PP,kP.EFFECTS.WAVE).setAlpha(0),this.wave.setWorldSize(14,14),this.container.add(this.wave)},n.createGlow=function(){this.glow=this.scene.add.image(0,0,PP,kP.EFFECTS.GLOW).setAlpha(0),this.glow.setDefaultWorldSize(),this.container.add(this.glow)},n.createAnimation=function(){var e=this;this.animation=new Hw([{target:this.glow,color:[{color:"ffffff43",curve:.056,c2:.52,c3:.75},{time:.1,color:"ffffff7f",curve:.25,c3:.988,c4:.59},{time:.2667,color:"ffffff00"}]},{target:this.sparks[0],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[1],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[2],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[3],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[4],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[5],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.wave,color:[{time:.0333,color:"ffffff32"},{time:.1333,color:"ffffff94"},{time:.3,color:"ffffff00"}]},{target:this.glow,translate:[{x:-3.42,y:-2.28},{time:.2667,x:-3.42,y:3.73}],scale:[{x:0,y:0,curve:.128,c2:.73,c3:.75},{time:.2667,x:3.567,y:3.567}]},{target:this.sparks[0],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:42.58,y:42.58}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[1],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:-27.42,y:53.63}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[2],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:-59.65,y:-17.29}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[3],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5333,x:14.95,y:62.84}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.5333,x:0,y:0}],rotate:[{time:.0333},{time:.5333,angle:-102.81}]},{target:this.sparks[4],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:52.71,y:-12.68}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[5],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5,x:4.82,y:-41.23}],scale:[{y:0},{time:.0333,x:4.426,y:4.426,curve:.115,c2:.28,c3:.75},{time:.5,x:0,y:0}],rotate:[{time:.0333},{time:.5,angle:-102.81}]},{target:this.wave,translate:[{time:.0333},{time:.3,x:.98,y:25.4}],scale:[{y:0},{time:.0333,curve:.25,c3:.75},{time:.3,x:5.198,y:5.198}]}]),this.animation.events.on("start",(function(){e.revive()})),this.animation.events.on("complete",(function(){e.kill()}))},t}(Phaser.GameObjects.Container),OP=IP,RP={position:[{time:.5,curve:.25,c3:.75},{time:.6667,position:.4663,curve:.131,c2:.11,c3:.982,c4:.73},{time:.7833,position:1}],color:[{color:"ffffff00",curve:.156,c2:.76,c3:.75},{time:.2333,color:"ffffffff",curve:"stepped"},{time:.7667,color:"ffffffff"}],rotate:[{angle:26.11,curve:0,c2:.6,c3:.682,c4:.83},{time:.4,angle:-8.57,curve:.25,c3:.75},{time:.6667}],scale:[{x:0,y:0,curve:.049,c2:.82,c3:.75},{time:.2333,x:1.497,y:1.497,curve:.241,c2:.02,c4:.86},{time:.5,x:.861,y:.861,curve:.25,c3:.75},{time:.65,x:1.261,y:1.261},{time:.7667,x:.552,y:.552}]},BP=Wi.Z.DASHBOARD,DP=BP.KEY,LP=BP.FRAME,_P=function(e){return e[e.READY=0]="READY",e[e.PLAYING=1]="PLAYING",e[e.WON=2]="WON",e[e.LOST=3]="LOST",e}({}),MP=function(e){function t(t,n,i){var a;return(a=e.call(this,t,52,160/3)||this).scene=void 0,a.smallIcon=void 0,a.plusScoreText=void 0,a.widgetSparks=void 0,a.buttonType=void 0,a.buttonSide=XP.LEFT,a.plusScoreAnimationPromise=void 0,a.buttonStatus=void 0,a.timer=void 0,a.rankText=void 0,a.playingStateFrame=void 0,a.wonStateFrame=void 0,a.lostStateFrame=void 0,a.buttonFrame=void 0,a.rankBlock=void 0,a.redBadge=void 0,a.yellowBadge=void 0,a.scene=t,a.buttonType=i,a.createButtonFrame(DP),a.createRankBlock(),a.createAttentionBadge(),a.createTimer(),a.createSmallIcon(n),a.createStarParticle(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.setType=function(e){this.buttonType=e},n.setSide=function(e){this.buttonSide=e},n.setReadyState=function(e){this.buttonStatus=_P.READY,this.buttonFrame.setFrame(this.playingStateFrame),this.timer.setText(e,9),this.rankBlock.setVisible(!1)},n.setPlayingState=function(e,t){this.buttonStatus=_P.PLAYING,this.buttonFrame.setFrame(this.playingStateFrame),this.rankBlock.setRank(e+1),this.timer.setRemainingTime(t)},n.setFinishedState=function(e,t){this.buttonStatus=t?_P.WON:_P.LOST,this.buttonFrame.setFrame(t?this.wonStateFrame:this.lostStateFrame),this.rankBlock.setRank(e+1,t);var n=t?"Open":"Completed";this.timer.setText(n,8)},n.showAttentionBadge=function(){var e=this.getPluginManager();e&&e.checkNotifyEvent()&&(e.isHappening()?(this.yellowBadge.setVisible(!0),this.redBadge.setVisible(!1)):(this.yellowBadge.setVisible(!1),this.redBadge.setVisible(!0)))},n.hideAttentionBadge=function(){this.redBadge.setVisible(!1),this.yellowBadge.setVisible(!1)},n.updateRankBlockPosition=function(e,t){this.rankBlock.setPosition(e,t)},n.runPlusScoreAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,s,o,h,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=300),this.plusScoreText.setText("+"+t),i=this.smallIcon.x+(this.buttonSide===XP.LEFT?60:-60),s=this.buttonSide===XP.LEFT,o=new yP({vertices:[-211.5,40.29,-186.35,97.94,-156.05,167.39,-78.09,171.9,-28.95,87.7,2.75,33.38],startPoint:[i,this.smallIcon.y],endPoint:[0,0],flipX:s}),this.smallIcon.setScale(1),h=new Hw([(0,a.Z)({},RP,{target:this.smallIcon,delay:n,path:o})]),(0,dl.Z)(this.scene,Math.max(n-100,0)).then((function(){u.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.FULL_PROGRESS)})),h.events.on("complete",(function(){u.runStarExplodeParticle(),u.smallIcon.kill(),u.plusScoreAnimationPromise=void 0,u.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS)})),h.events.on("startDelay",(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.smallIcon.revive();case 1:case"end":return e.stop()}}),e)})))),this.plusScoreAnimationPromise=h.start();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runStarExplodeParticle=function(){this.widgetSparks.setPosition(0,0),this.widgetSparks.explode()},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.add.tween({targets:this,duration:300,props:{scale:{from:.75,start:.75,to:1},alpha:{from:0,start:0,to:1}},ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.add.tween({targets:this,duration:300,props:{scale:{from:this.scale,start:this.scale,to:.75},alpha:{from:this.alpha,start:this.alpha,to:0}},ease:Phaser.Math.Easing.Back.In}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.waitForAnimationCompleted=function(){return this.plusScoreAnimationPromise||Promise.resolve()},n.createButtonFrame=function(e){this.setButtonFrames();var t=this.scene.add.image(0,0,e,this.playingStateFrame);t.setDefaultWorldSize(),this.add(t),this.buttonFrame=t,this.buttonFrame.setY(this.height/2-this.buttonFrame.height/2)},n.createRankBlock=function(){var e=new SP(this.scene);this.add(e),this.rankBlock=e,this.rankBlock.setPosition(0,1)},n.createAttentionBadge=function(){var e=this.scene.add.image(0,0,DP,LP.EVENTS_COMMON.RED_BADGE);e.setDefaultWorldSize(),e.setVisible(!1),this.add(e);var t=this.scene.add.image(0,0,DP,LP.EVENTS_COMMON.YELLOW_BADGE);t.setDefaultWorldSize(),t.setVisible(!1),this.add(t),this.redBadge=e,this.yellowBadge=t,Phaser.Display.Align.In.TopRight(this.redBadge,this,1.5,1.5),Phaser.Display.Align.In.TopRight(this.yellowBadge,this,1.5,1.5)},n.createTimer=function(){this.timer=new TP(this.scene,145/3,47/3),this.add(this.timer),this.timer.setY(this.height/2-this.timer.height/2)},n.createSmallIcon=function(e){var t=this.scene.add.container(0,0);this.add(t);var n=this.scene.add.image(0,0,DP,e);n.setDefaultWorldSize(),t.add(n);var i=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(15),text:"x1",origin:{x:0,y:.5}});t.add(i),t.setSize(n.width,n.height),this.smallIcon=t,this.plusScoreText=i,this.smallIcon.kill()},n.createStarParticle=function(){this.widgetSparks=new OP(this.scene),this.add(this.widgetSparks)},n.setButtonFrames=function(){var e=[LP.WEEKLY_TOURNAMENT,LP.BOXING_DUEL,LP.RACE];switch(this.buttonType){case QP.WEEKLY_TOURNAMENT:this.playingStateFrame=e[0].BUTTON.PLAYING,this.wonStateFrame=e[0].BUTTON.WON,this.lostStateFrame=e[0].BUTTON.LOST;break;case QP.BOXING_DUEL:this.playingStateFrame=e[1].BUTTON.PLAYING,this.wonStateFrame=e[1].BUTTON.WON,this.lostStateFrame=e[1].BUTTON.LOST;break;case QP.OFFSHORE_RACE:this.playingStateFrame=e[2].BUTTON.PLAYING,this.wonStateFrame=e[2].BUTTON.WON,this.lostStateFrame=e[2].BUTTON.LOST}},n.getPluginManager=function(){switch(this.buttonType){case QP.WEEKLY_TOURNAMENT:return this.scene.weeklyTournament;case QP.BOXING_DUEL:return this.scene.boxingDuel;case QP.OFFSHORE_RACE:return this.scene.offshoreRace}},t}(Kp.Z),NP=MP,GP=Wi.Z.DASHBOARD.FRAME,ZP=function(e){function t(t,n){var i;return(i=e.call(this,t,GP.BOXING_DUEL.SMALL_ICON,n)||this).handleOnButtonClicked=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.scene.boxingDuel,i.hideAttentionBadge(),t.setNofityEvent(!1),e.next=5,i.scene.requireTextureAsync("BOXING_DUEL");case 5:t.isFinished()?(i.scene.screen.close(ce.o4.DASHBOARD_SCREEN),i.scene.screen.open(ce.o4.BOXING_DUEL.REWARD_SCREEN)):i.scene.screen.open(ce.o4.BOXING_DUEL.MAIN_SCREEN);case 6:case"end":return e.stop()}}),e)}))),i.scene=t,i.plusScoreText.setPosition(15,5),i.updateData(),i}return(0,s.Z)(t,e),t.prototype.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(t=this.scene.boxingDuel,n=t.isWaiting(),i=t.isHappening(),a=t.isFinished(),!n){e.next=9;break}return this.setReadyState("New Duel"),e.abrupt("return");case 9:if(!i){e.next=14;break}return r=t.getPlayerRank(),s=t.getRemainingTime(),this.setPlayingState(r,s),e.abrupt("return");case 14:if(!a){e.next=18;break}return o=t.getPlayerRank(),this.setFinishedState(o,0===o),e.abrupt("return");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(NP),FP=ZP,UP=Wi.Z.DASHBOARD.FRAME,WP=function(e){function t(t,n){var i;return(i=e.call(this,t,UP.RACE.SMALL_ICON,n)||this).handleOnButtonClicked=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.scene.offshoreRace,i.hideAttentionBadge(),t.setNotifyEvent(!1),t.isWaiting()?i.scene.openOffshoreRaceInvitationScreen():i.scene.openOffshoreRaceMainScreen();case 4:case"end":return e.stop()}}),e)}))),i.scene=t,i.plusScoreText.setPosition(15,5),i}return(0,s.Z)(t,e),t.prototype.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(t=this.scene.offshoreRace,n=t.isWaiting(),i=t.isHappening(),a=t.isFinished(),!n){e.next=9;break}return this.setReadyState("New Race"),e.abrupt("return");case 9:if(!i){e.next=14;break}return r=t.getPlayerRank(),s=t.getRemainingTime(),this.setPlayingState(r,s),e.abrupt("return");case 14:if(!a){e.next=19;break}return o=t.getPlayerRank(),h=t.hasReward(),this.setFinishedState(o,h),e.abrupt("return");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(NP),HP=WP,YP=Wi.Z.DASHBOARD,KP=(YP.KEY,YP.FRAME),zP=function(e){function t(t,n){var i;return(i=e.call(this,t,KP.WEEKLY_TOURNAMENT.SMALL_ICON,n)||this).handleOnButtonClicked=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=i.scene.weeklyTournament).isLoadingTournaments()){e.next=3;break}return e.abrupt("return");case 3:return i.hideAttentionBadge(),t.setNofityEvent(!1),i.scene.weeklyTournament.popupJoinTournament(),e.next=8,i.scene.requireTextureAsync("WEEKLY_TOURNAMENT");case 8:t.isHappening()||t.isFinished()?i.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN):i.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN);case 9:case"end":return e.stop()}}),e)}))),i.scene=t,i.plusScoreText.setPosition(15,5),i.updateRankBlockPosition(0,-9),i}return(0,s.Z)(t,e),t.prototype.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForAnimationCompleted();case 2:if(!(t=this.scene.weeklyTournament).isLoadingTournaments()){e.next=7;break}this.setReadyState("Loading..."),e.next=15;break;case 7:return e.next=9,t.waitForRequestDataStartGameCompleted();case 9:return e.next=11,t.waitForLoadWorldTournamentsCompleted();case 11:n=t.isWaiting(),i=t.isHappening(),a=t.isFinished(),n?this.setReadyState("Join"):i?(r=t.getRank(),s=t.getRemainingTime(),this.setPlayingState(r-1,s)):a&&(o=t.getRank()-1,h=t.hasReward(),this.setFinishedState(o,h));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(NP),VP=zP,jP=Wi.Z.DASHBOARD,XP=(jP.KEY,jP.FRAME,function(e){return e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTH=2]="BOTH",e}({})),qP=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.buttons=[],n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.createButtons(),n}(0,s.Z)(t,e);var n=t.prototype;return n.showWarningBadgeOnEventButtons=function(){this.buttons.filter((function(e){return e.active&&e.visible})).forEach((function(e){e.showAttentionBadge()}))},n.bringButtonToTop=function(e){var t=this.buttons.find((function(t){return t.buttonType===e}));t&&this.bringToTop(t)},n.alignItems=function(){var e=[],t=[];this.buttons.filter((function(e){return e.active&&e.visible})).forEach((function(n){switch(n.buttonSide){case XP.LEFT:e.push(n);break;case XP.RIGHT:t.push(n)}})),this.alignLeftButtons(e),this.alignRightButtons(t)},n.alignLeftButtons=function(e){var t=this,n=GameCore.layoutInitializer.isLandscape?-5:-8,i=GameCore.layoutInitializer.isLandscape?50:60,a=GameCore.layoutInitializer.isLandscape?60:80;e.forEach((function(e,r){Phaser.Display.Align.In.TopLeft(e,t,n,-i-r*a)}))},n.alignRightButtons=function(e){var t=this,n=GameCore.layoutInitializer.isLandscape?-10:-8,i=GameCore.layoutInitializer.isLandscape?50:60,a=GameCore.layoutInitializer.isLandscape?60:80;e.forEach((function(e,r){Phaser.Display.Align.In.TopRight(e,t,n,-i-r*a)}))},n.createButtons=function(){this.createWeeklyTournamentButton(),this.createBoxingDuelButton(),this.createRaceButton()},n.createWeeklyTournamentButton=function(){var e=new VP(this.scene,QP.WEEKLY_TOURNAMENT);e.setSide(XP.LEFT),e.setName("WeeklyTournamentButton"),this.add(e),this.buttons.push(e)},n.createBoxingDuelButton=function(){var e=new FP(this.scene,QP.BOXING_DUEL);e.setSide(XP.LEFT),e.setName("BoxingDuelButton"),this.add(e),this.buttons.push(e)},n.createRaceButton=function(){var e=new HP(this.scene,QP.OFFSHORE_RACE);e.setSide(XP.LEFT),e.setName("OffshoreRaceButton"),this.add(e),this.buttons.push(e)},t}(Phaser.GameObjects.Container),JP=qP,QP=function(e){return e[e.WEEKLY_TOURNAMENT=0]="WEEKLY_TOURNAMENT",e[e.BOXING_DUEL=1]="BOXING_DUEL",e[e.OFFSHORE_RACE=2]="OFFSHORE_RACE",e}({}),$P=function(){function e(e){var t=this;this.scene=void 0,this.dashboardScreen=void 0,this.box=void 0,this.alignButtonsBoxes=function(){t.box.alignItems()},this.dashboardScreen=e,this.scene=e.scene,this.createButtonBox()}var t=e.prototype;return t.createButtonBox=function(){this.box=new JP(this.scene),this.dashboardScreen.add(this.box)},t.getButtonByType=function(e){var t=this.box.buttons.find((function(t){return t.buttonType===e}));if(!t)throw new Error("Button with type "+e+" not found");return t},t.showWarningBadgeOnEventButtons=function(){this.box.showWarningBadgeOnEventButtons()},e}(),ek=n(19),tk=Wi.Z.DASHBOARD,nk=tk.KEY,ik=tk.FRAME,ak=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.progressText=void 0,n.progressBar=void 0,n.progressFill=void 0,n.currentProgress=0,n.maxProgress=0,n.barSize=void 0,n.fillSize=void 0,n.scene=t,n.setSize(176/3,47/3),n.barSize={width:176/3,height:47/3},n.fillSize={width:n.barSize.width-7/3,height:13},n.createProgressBar(),n.createProgressFill(),n.createTitleText(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.currentProgress,this.maxProgress=n,0===t?(this.progressFill.kill(),this.progressFill.setAlpha(0)):this.progressFill.revive(),!i){e.next=9;break}return this.progressFill.setAlpha(0===t?0:1),this.currentProgress=t,this.progressFill.setSizeByWorld((0,ek.Z)(t,0,n,7,this.fillSize.width),this.progressFill.displayHeight),this.progressText.setText(Math.floor(t)+"/"+n),e.abrupt("return",Promise.resolve());case 9:return r=this.scene.tweens.add({targets:this.progressFill,alpha:1,duration:300}).waitForCompletion(),s=this.scene.tweens.addCounter({from:a,to:t,duration:300,onUpdate:function(e){var t=e.getValue(),i=o.progressFill.displayHeight,a=(0,ek.Z)(t,0,n,7,o.fillSize.width);o.progressFill.setSizeByWorld(a,i),o.progressText.setText(Math.floor(t)+"/"+n),o.currentProgress=t}}).waitForCompletion(),e.next=13,Promise.all([r,s]);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.setSizeByWorld=function(e){this.barSize.width=e,this.fillSize.width=e-7/3,this.progressBar.setSizeByWorld(this.barSize.width,this.barSize.height),this.progressFill.setSizeByWorld(this.fillSize.width,this.fillSize.height),this.setSize(this.progressBar.displayWidth,this.progressBar.displayHeight),this.alignProgressFill()},n.isProgressComplete=function(){return this.currentProgress>=this.maxProgress},n.createProgressBar=function(){var e=this.scene.make.nineslice({key:nk,frame:ik.DECOR.LOCATION_PROGRESS.BAR,leftWidth:20,rightWidth:20,width:this.barSize.width,height:this.barSize.height});this.add(e),this.progressBar=e,this.setSize(e.displayWidth,e.displayHeight)},n.createProgressFill=function(){var e=this.scene.make.nineslice({key:nk,frame:ik.DECOR.PROGRESS.FILL,leftWidth:7,rightWidth:7,width:this.fillSize.width,height:this.fillSize.height});e.setOrigin(0,.5),this.add(e),this.progressFill=e,this.alignProgressFill()},n.alignProgressFill=function(){var e=(this.progressBar.displayWidth-this.progressFill.displayWidth)/2;this.progressFill.setX(-this.progressBar.displayWidth/2+e)},n.createTitleText=function(){var e=new jp(this.scene,{text:"3/15",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.add(e),this.progressText=e},t}(Phaser.GameObjects.Container),rk=ak;function sk(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ok(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ok(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ok(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ck=Wi.Z.DASHBOARD,hk=ck.KEY,uk=ck.FRAME,lk=function(e){function t(t){var n;return(n=e.call(this,t,hk,uk.BLANK,118,170/3)||this).scene=void 0,n.progressBar=void 0,n.locationName=void 0,n.buttonImage=void 0,n.counterBadge=void 0,n.counterText=void 0,n.button.kill(),n.scene=t,n.setName("Location"),n.create(),n.alignItems(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateCounterBadge(),e.next=3,this.updateLocationProgress();case 3:this.alignItems();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateCounterBadge=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.player.getStar(),e.next=3,this.scene.journey.getInProgressLocation();case 3:if(n=e.sent,i=n.decorations.map((function(e){return e.level})),!((a=this.countMultiBuildableBuildings(i,t))<=0)){e.next=9;break}return this.counterBadge.kill(),e.abrupt("return");case 9:this.counterBadge.revive(),this.counterText.setText(a.toString());case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.countMultiBuildableBuildings=function(e,t){for(var n,i=[3,4,5],a=[],r=sk(e);!(n=r()).done;){var s=n.value;a.push.apply(a,i.slice(s))}a.sort((function(e,t){return e-t}));for(var o=0,c=0,h=0,u=a;h<u.length;h++){var l=u[h];if(c+l>t)break;c+=l,o++}return o},n.updateLocationProgress=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.journey.getInProgressLocation();case 2:t=e.sent,n=t.id,i=t.name,a=t.progress,r=parseInt(n)+1,this.locationName.setText(r+". "+i),s=Math.max(this.locationName.width,176/3),this.buttonImage.setSizeByWorld(s+59.3333,this.height),this.progressBar.setSizeByWorld(s),this.progressBar.updateProgress(a,3*t.decorations.length,!0),this.setSize(this.buttonImage.displayWidth,this.buttonImage.displayHeight),this.hitZone.setSize(this.width,this.height,!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.progressBar.setPosition(this.width/2-this.progressBar.width/2-11.3333,8),this.locationName.setPosition(this.progressBar.x,-10),this.counterBadge.setPosition(this.width/2-this.counterBadge.width/2+1,-this.height/2+this.counterBadge.height/2-2)},n.create=function(){this.createButtonImage(),this.createLocationName(),this.createLocationButtonProgressBar(),this.createCounterBadge()},n.createButtonImage=function(){var e=this.scene.make.nineslice({key:hk,frame:uk.DECOR.LOCATION_BUTTON,leftWidth:45,rightWidth:20,width:this.width,height:this.height});this.add(e),this.buttonImage=e},n.createLocationName=function(){var e=new jp(this.scene,{text:"1. United States",fontSize:this.scene.fontSize(12),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setCenterAlign(),e.setPosition(0,0),this.add(e),this.locationName=e},n.createLocationButtonProgressBar=function(){var e=new rk(this.scene);this.add(e),this.progressBar=e},n.createCounterBadge=function(){this.counterBadge=this.scene.add.container(),this.add(this.counterBadge);var e=this.scene.add.image(0,0,Wi.Z.DASHBOARD.KEY,Wi.Z.DASHBOARD.FRAME.DECOR.RED_CIRCLE);e.setDefaultWorldSize(),this.counterBadge.add(e),this.counterText=new jp(this.scene,{text:"1",fontSize:this.scene.fontSize(11),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.counterBadge.add(this.counterText),this.counterBadge.setSize(e.width,e.height)},t}(Hc.Z),dk=lk,pk=function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.dashboardScreen=void 0,n.screenQueue=[],n.currentScreenOpenPromise=void 0,n.managerPromise=void 0,n.canRefresh=!1,n.clearQueue=function(){n.screenQueue=[]},n.displayAllEventScreens=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(750);case 2:return n.handleWeeklyTournamentScreen(),n.handleBoxingDuelScreen(),n.handleOffshoreRaceScreen(),e.next=7,n.waitForAllScreensToDisplay();case 7:case"end":return e.stop()}}),e)}))),n.handleWeeklyTournamentScreen=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getWeeklyTournamentScreenKey(),n.pushScreenKeyToQueue(t,0),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.handleBoxingDuelScreen=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getBoxingDuelScreenKey(),n.pushScreenKeyToQueue(t,1),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.handleOffshoreRaceScreen=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.getRaceScreenKey(),n.pushScreenKeyToQueue(t,2),n.processShowScreens();case 3:case"end":return e.stop()}}),e)}))),n.refreshEventData=function(){n.canRefresh&&(n.updateWeeklyTournamentData(),n.updateBoxingDuelData(),n.updateOffshoreRaceData())},n.updateWeeklyTournamentData=function(){var e=n.scene.weeklyTournament;e.isValid()&&(e.update(),n.dashboardScreen.weeklyTournamentButton.updateData())},n.updateBoxingDuelData=function(){var e=n.scene.boxingDuel;e.isValid()&&(e.update(),n.dashboardScreen.boxingDuelButton.updateData())},n.updateOffshoreRaceData=function(){var e=n.scene.offshoreRace;e.isValid()&&(e.update(),n.dashboardScreen.raceButton.updateData())},n.handleShowWeeklyTournamentNotification=function(){n.dashboardScreen.weeklyTournamentButton.showAttentionBadge()},n.handleShowBoxingDuelNotification=function(){n.dashboardScreen.boxingDuelButton.showAttentionBadge()},n.handleShowOffshoreRaceNotification=function(){n.dashboardScreen.raceButton.showAttentionBadge()},n.scene=t.scene,n.dashboardScreen=t,n.registerEventListeners(),n}(0,s.Z)(t,e);var n=t.prototype;return n.registerEventListeners=function(){var e=this;this.scene.events.on("refresh-event-toggle",(function(t){e.canRefresh=t})),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.refreshEventData,this),this.scene.weeklyTournament.events.on(To,this.handleWeeklyTournamentScreen,this),this.scene.boxingDuel.events.on(Li,this.handleBoxingDuelScreen,this),this.scene.offshoreRace.events.on(ia,this.handleOffshoreRaceScreen,this),this.scene.weeklyTournament.events.on(bo,this.handleShowWeeklyTournamentNotification,this),this.scene.boxingDuel.events.on(Di,this.handleShowBoxingDuelNotification,this),this.scene.offshoreRace.events.on(na,this.handleShowOffshoreRaceNotification,this)},n.waitForAllScreensToDisplay=function(){return this.managerPromise},n.processShowScreens=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.screenQueue.length){e.next=3;break}return this.emit("all-screens-displayed"),e.abrupt("return",Promise.resolve());case 3:if(!this.currentScreenOpenPromise){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this.dashboardScreen.isScreenOpen){e.next=7;break}return e.abrupt("return",Promise.resolve());case 7:if(this.managerPromise=new Promise((function(e){a.on("all-screens-displayed",(function(){e()}))})),t=this.screenQueue.sort((function(e,t){return e.priority-t.priority})),!(n=t.shift())){e.next=19;break}return i=n.screenKey,this.currentScreenOpenPromise=this.scene.screen.openAsync(i),e.next=15,this.currentScreenOpenPromise;case 15:return e.next=17,(0,le.qZ)(500);case 17:this.currentScreenOpenPromise=void 0,this.processShowScreens();case 19:return e.abrupt("return",Promise.resolve());case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.pushScreenKeyToQueue=function(e,t){if(e){if(this.screenQueue.find((function(t){return t.screenKey===e})))return;this.screenQueue.push({screenKey:e,priority:t})}},n.getWeeklyTournamentScreenKey=function(){return this.scene.weeklyTournament.isValid(),""},n.getBoxingDuelScreenKey=function(){return this.scene.boxingDuel.isValid(),""},n.getRaceScreenKey=function(){return this.scene.offshoreRace.isValid(),""},t}(Phaser.Events.EventEmitter),fk=pk,mk=Wi.Z.DASHBOARD,gk=mk.KEY,vk=mk.FRAME,yk=1750280,Ek=10620447,Ck=7999138,Ak=function(e){function t(t,n){var i;return void 0===n&&(n=.925),(i=e.call(this,t,66,206/3,n)||this).scene=void 0,i.levelText=void 0,i.button=void 0,i.scene=t,i.setName("Level"),i.create(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.runClaimItemsAnimation=function(){var e=this;this.scene.add.tween({targets:this,duration:75,scale:.925,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS)},onComplete:function(){e.scene.add.tween({targets:e,duration:75,scale:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})}})},n.setLevel=function(e){this.levelText.setText(e.toString())},n.setDifficulty=function(e){var t=vk.LEVEL_BUTTON.NORMAL,n=yk;switch(e){case Vh.NORMAL:t=vk.LEVEL_BUTTON.NORMAL;break;case Vh.HARD:t=vk.LEVEL_BUTTON.HARD,n=Ek;break;case Vh.SUPER_HARD:t=vk.LEVEL_BUTTON.SUPER_HARD,n=Ck}this.button.setFrame(t),this.levelText.setStrokeBlurColor(n)},n.create=function(){this.createButton(),this.createText()},n.createButton=function(){var e=this.scene.add.image(0,0,gk,vk.LEVEL_BUTTON.NORMAL);e.setDefaultWorldSize(),this.add(e),this.button=e},n.createText=function(){var e=new jp(this.scene,{text:"11",fontSize:this.scene.fontSize(20),fillColor:16776957,strokeBlur:2,strokeBlurColor:1750280,strokeBlurAlpha:.7});e.setPosition(-3,.5),this.add(e),this.levelText=e},t}(Kp.Z),wk=Ak,Sk=Wi.Z.DASHBOARD,bk=Sk.KEY,Tk=Sk.FRAME,xk=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).scene=void 0,i.levelButton=void 0,i.journeyButton=void 0,i.challengeButton=void 0,i.weeklyTournamentButton=void 0,i.boxingDuelButton=void 0,i.raceButton=void 0,i.locationButton=void 0,i.eventButtonsManager=void 0,i.eventsManager=void 0,i.title=void 0,i.blackBackground=void 0,i.guideContainer=void 0,i.canOpenResScrnFirstTime=void 0,i.exitAnimation=void 0,i.contentExitAnimation=void 0,i.isScreenOpen=void 0,i.dataBeforeClaimJourney=void 0,i.handleOpenLevelNextStep=void 0,i.isScreenContentOpen=void 0,i.settingsMenu=void 0,i.backToDashboard=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.eventsManager.displayAllEventScreens();case 2:case"end":return e.stop()}}),e)}))),i.updateWeeklyTournamentButtonVisibility=function(){i.scene.weeklyTournament.isValid()?i.weeklyTournamentButton.revive():i.weeklyTournamentButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.updateOffshoreRaceButtonVisibility=function(){i.scene.offshoreRace.isValid()?i.raceButton.revive():i.raceButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.updateBoxingDuelButtonVisibility=function(){i.scene.boxingDuel.isValid()?i.boxingDuelButton.revive():i.boxingDuelButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.handleSettingsMenuAutoClose=function(e){i.settingsMenu.getBounds().contains(e.worldX,e.worldY)||i.settingsMenu.closeSettings()},i.handleOpenLevel=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.scene.locationManager.isOpening){e.next=4;break}return e.next=3,i.scene.locationManager.runExitLocationContentsAnimation();case 3:i.scene.locationManager.isOpening=!1;case 4:i.scene.screen.close(i.name),i.scene.gameplay.processStartLevel();case 6:case"end":return e.stop()}}),e)}))),i.handleOpenShop=function(){},i.handleOpenJourneyScreen=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),i.scene.gameUI.starBarButton.setDepth(Fr.Z.BUTTON),t&&i.scene.screen.close(i.name),i.scene.journeyDataService.updateData(),e.next=6,i.scene.requireTextureAsync("JOURNEY");case 6:i.scene.screen.open(ce.o4.JOURNEY_SCREEN,{shouldCloseAfterComplete:t});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleOpenDecorationScreen=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.setDisableButtons(!0),i.scene.events.emit(hi.LOCATION_DECORATION_OPEN),i.runContentExitAnimation(),e.next=5,i.runEventButtonsExitAnimation();case 5:return i.isScreenContentOpen=!1,i.scene.events.emit("refresh-event-toggle",!1),e.next=9,i.scene.locationManager.open();case 9:case"end":return e.stop()}}),e)}))),i.handleCloseDecorationScreenCompleted=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return i.handleOpenLevel(),i.scene.locationManager.isGuided=!1,i.guideContainer.hideGuide(),e.abrupt("return");case 5:i.updateLocationButton(),i.runContentEntranceAnimation(),i.runEventButtonsEntranceAnimation(),i.isScreenContentOpen=!0,i.scene.events.emit("refresh-event-toggle",!0),i.setDisableButtons(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleOpenChallengeScreen=function(){i.scene.screen.open(ce.o4.CHALLENGE_WELCOME_SCREEN,{header:"1vs1 Challenge",description:"Play with friends to\nearn more coins"})},i.onEntranceCompleted=function(){i.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return i.scene.screen.close(i.name)}))},i.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(i)),i.isScreenOpen=!1},i.scene=t,i.background.kill(),i.dataBeforeClaimJourney=void 0,i.create(),i.scene.events.emit("refresh-event-toggle",!0),i.scene.events.on(hi.OPEN_PLAY_SCREEN_FROM_DASHBOARD,i.handleOpenLevel,(0,fc.Z)(i)),i.zone.disableInteractive(),i.listenEvents(),i.challengeButton.kill(),i}(0,s.Z)(t,e);var n=t.prototype;return n.getCanOpenPrevClgRes=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canOpenResScrnFirstTime){e.next=2;break}return e.abrupt("return",!0);case 2:return t=new Promise((function(e){return setTimeout((function(){return e(!1)}),2e3)})),n=new Promise((function(e){i.scene.events.once(hi.PLAYER_FINISH_CHALLENGE,(function(){return e(!0)}))})),e.abrupt("return",Promise.race([t,n]));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleOpenChallengeResult=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(ce.o4.CHALLENGE_RESULT_SCREEN)){e.next=3;break}return e.abrupt("return");case 3:return this.scene.screen.open(ce.o4.CHALLENGE_RESULT_SCREEN),e.abrupt("return",new Promise((function(e){t.on(GameCore.Screens.Events.CLOSE,(function(){e()}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.eventButtonsManager=new $P(this),this.eventsManager=new fk(this),this.createTitle(),this.createCoinProgress(),this.createTournamentButton(),this.createOffshoreRaceButton(),this.createBoxingDuelButton(),this.createShopButton(),this.createChallengeButton(),this.createLevelButton(),this.createSettingsMenu(),this.createJourneyButton(),this.createLocationMapButton(),this.createBlackBackground(),this.createGuideContainer(),this.alignLocationMapButton(),this.levelButton.onClick=this.handleOpenLevel,this.weeklyTournamentButton.onClick=this.weeklyTournamentButton.handleOnButtonClicked,this.boxingDuelButton.onClick=this.boxingDuelButton.handleOnButtonClicked,this.raceButton.onClick=this.raceButton.handleOnButtonClicked,this.journeyButton.onClick=this.handleOpenJourneyScreen,this.locationButton.onClick=this.handleOpenDecorationScreen,this.challengeButton.onClick=this.handleOpenChallengeScreen},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r,s,o,h,u,l,d,p,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpen){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:return e.prototype.open.call(this,n),this.isScreenOpen=!0,this.scene.offshoreRace.setShouldCheckTime(!0),this.scene.gameUI.starBarButton.setDepth(Fr.Z.BUTTON),this.setDisableButtons(!0),this.scene.setBackgroundWithFadeAnimation(),this.dataBeforeClaimJourney&&(n=this.dataBeforeClaimJourney,this.dataBeforeClaimJourney=void 0),a=null!=(i=n)?i:{},r=a.shouldPlusEventScore,s=void 0!==r&&r,o=a.canShowWelcomeBackScreen,h=void 0!==o&&o,u=a.openLevelNextStep,l=void 0!==u&&u,d=a.reopenLocation,p=void 0!==d&&d,this.handleOpenLevelNextStep=l,this.updateData(),this.updateEventButtonsVisibility(),t.next=15,this.updateLocationButton();case 15:return t.next=17,this.scene.locationManager.updateData();case 17:if(this.handleOpenLevelNextStep||(this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON),this.scene.gameUI.starBarButton.setDisabled(!1)),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.scene.gameUI.showStar(),this.runEntrancesAnimation(),!p){t.next=27;break}return t.next=26,this.handleOpenDecorationScreen();case 26:return t.abrupt("return");case 27:if(this.runContentEntranceAnimation(),this.runEventButtonsEntranceAnimation(),!s){t.next=33;break}return this.scene.showTournamentShareDialog(!1),t.next=33,this.runPlusScoreEvents();case 33:if(this.scene.events.emit("refresh-event-toggle",!0),!h){t.next=39;break}return t.next=37,(0,dl.Z)(this.scene,750);case 37:return t.next=39,this.scene.screen.openAsync(ce.o4.WELCOME_BACK_SCREEN);case 39:if(!(f=this.guideContainer.guideManager).canPlayLocationDecorationGuide()){t.next=46;break}return this.scene.gameUI.setDisableButtons(!0),t.next=44,(0,dl.Z)(this.scene,750);case 44:return t.next=46,f.playLocationDecorationGuide();case 46:if(!this.handleOpenLevelNextStep){t.next=51;break}return t.next=49,(0,dl.Z)(this.scene,750);case 49:this.handleOpenLevel(),this.handleOpenLevelNextStep=!1;case 51:this.scene.turnOnBackgroundMusic(),this.setDisableButtons(!1);case 53:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateEventButtonsVisibility=function(){[this.scene.weeklyTournament.isValid(),this.scene.offshoreRace.isValid(),this.scene.boxingDuel.isValid()].some((function(e){return e}))&&this.scene.requireTextureAsync("EVENT_BOARD",!1),this.updateWeeklyTournamentButtonVisibility(),this.updateOffshoreRaceButtonVisibility(),this.updateBoxingDuelButtonVisibility()},n.runPlusScoreEvents=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.weeklyTournament,i=t.boxingDuel,a=t.offshoreRace,r=[{timeout:function(){return n.isTournamentTimeOut()},update:function(){return h.eventsManager.updateWeeklyTournamentData()},score:function(){return h.scene.gameplay.eventManager.getWeeklyTournamentItemAmount()},button:this.weeklyTournamentButton},{timeout:function(){return i.isTimeout()},update:function(){return h.eventsManager.updateBoxingDuelData()},score:function(){return h.scene.gameplay.eventManager.getBoxingDuelItemAmount()},button:this.boxingDuelButton},{timeout:function(){return a.isTimeout()},update:function(){return h.eventsManager.updateOffshoreRaceData()},score:function(){return h.scene.gameplay.eventManager.getRaceItemAmount()},button:this.raceButton}],s=r.map((function(e){var t=e.timeout,n=e.update,i=e.score,a=e.button;return t()?(n(),null):{score:i(),button:a}})).filter((function(e){return null!==e})),!s.some((function(e){return e&&e.score>0}))){e.next=10;break}return o=500,e.next=8,(0,le.qZ)(300);case 8:this.bringToTop(this.eventButtonsManager.box),s.forEach((function(e){e&&e.score>0&&(h.eventButtonsManager.box.bringButtonToTop(e.button.buttonType),e.button.runPlusScoreAnimation(e.score,o),o+=150)}));case 10:return e.next=12,Promise.all(r.map((function(e){return e.button.plusScoreAnimationPromise})));case 12:r.forEach((function(e){var t=e.score,n=e.button;t()>0&&n.showAttentionBadge()}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.setDisableButtons(!0),this.runCloseAnimation(),this.scene.gameUI.hideLife()},n.updateData=function(){var e,t,n=this.scene.level.getLevel(),i=null!=(e=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty)?e:Vh.NORMAL,a=this.scene.player.getJourneyProgress().inProgressLocation;a&&(a.progress>=2*a.decorations.length&&this.scene.locationManager.preloadNextBackgroundAsync());this.levelButton.setLevel(n),this.levelButton.setDifficulty(i)},n.listenEvents=function(){this.scene.events.on(hi.BACK_TO_DASHBOARD,this.backToDashboard,this),this.scene.weeklyTournament.events.on(xo,this.updateWeeklyTournamentButtonVisibility,this),this.scene.offshoreRace.events.on(aa,this.updateOffshoreRaceButtonVisibility,this),this.scene.boxingDuel.events.on(Mi,this.updateBoxingDuelButtonVisibility,this),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.handleSettingsMenuAutoClose,this)},n.runFadeBackground=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.blackBackground.revive(),this.blackBackground.alpha=t,e.next=4,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:a}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.setDisableButtons=function(e){var t=[this.levelButton,this.settingsMenu,this.challengeButton,this.locationButton,this.journeyButton,this.weeklyTournamentButton,this.raceButton,this.boxingDuelButton],n=t.map((function(e){return e.alpha}));this.levelButton.setDisabled(e),this.settingsMenu.setDisabled(e),this.challengeButton.setDisabled(e),this.locationButton.setDisabled(e),this.journeyButton.setDisabled(e),this.weeklyTournamentButton.setDisabled(e),this.raceButton.setDisabled(e),this.boxingDuelButton.setDisabled(e),t.forEach((function(e,t){e.active&&e.setAlpha(n[t])}))},n.updateLocationButton=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationButton.updateData();case 2:this.alignLocationMapButton();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntrancesAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.exitAnimation)||t.stop(),null==(n=this.contentExitAnimation)||n.stop(),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen),(0,a.Z)({targets:[this.scene.locationManager]},Cv.tweenConfigs.screen.configOpen)]}),this.onEntranceCompleted();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runContentEntranceAnimation=function(){var e=this,t=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsMenu,scale:1},{obj:this.challengeButton,scale:1},{obj:this.locationButton,scale:1}],n=this.scene.tweens.createTimeline({});t.forEach((function(e,t){var i=e.obj,a=e.scale;i.active&&(i.setVisible(!0),i.setScale(.75),n.add({targets:[i],props:{scale:a,alpha:1},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:0==t?0:"-=460"}))})),n.playAndWaitForCompletion().then((function(){e.isScreenContentOpen=!0}))},n.runContentExitAnimation=function(){this.settingsMenu.closeSettings();var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.locationButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsMenu,scale:1},{obj:this.challengeButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj;t.add({targets:[i],props:{scale:.75,alpha:0},duration:500,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460",onComplete:function(){i.setVisible(!1)}})})),t.play(),this.contentExitAnimation=t},n.runEventButtonsEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runEntranceAnimation(),n=this.boxingDuelButton.runEntranceAnimation(),i=this.raceButton.runEntranceAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEventButtonsExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runExitAnimation(),n=this.boxingDuelButton.runExitAnimation(),i=this.raceButton.runExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.exitAnimation=this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose),(0,a.Z)({targets:[this.scene.locationManager]},Cv.tweenConfigs.screen.configClose)]}),this.scene.locationManager.isOpening&&(this.scene.locationManager.runExitLocationContentsAnimation(),this.scene.locationManager.isOpening=!1),!this.isScreenContentOpen){e.next=7;break}return this.runContentExitAnimation(),e.next=6,this.runEventButtonsExitAnimation();case 6:this.isScreenContentOpen=!1;case 7:this.onExitCompleted();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=new hv(this.scene);e.setText("Location Name"),e.setFontSize(32),e.setColor(7162732),e.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-244),this.title=e},n.createCoinProgress=function(){var e=new Wx(this.scene);e.setName("CoinProgress"),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-5)},n.createTournamentButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.WEEKLY_TOURNAMENT);e.kill(),e.setAlpha(0),e.setScale(.75),this.weeklyTournamentButton=e},n.createBoxingDuelButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.BOXING_DUEL);e.kill(),e.setAlpha(0),e.setScale(.75),this.boxingDuelButton=e},n.createOffshoreRaceButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.OFFSHORE_RACE);e.kill(),e.setAlpha(0),e.setScale(.75),this.raceButton=e},n.createShopButton=function(){},n.createChallengeButton=function(){var e=new Hc.Z(this.scene,bk,Tk.ICON.CHALLENGE,70,70);e.setName("Challenge"),this.add(e),Phaser.Display.Align.In.TopLeft(e,this,-8,-180),this.challengeButton=e;var t=new hv(this.scene);t.setText("Challenge"),t.setFontSize(10),t.setCenterAlign(),t.setColor(7162732),t.setY(30),e.add(t)},n.createLevelButton=function(){var e=new wk(this.scene);this.add(e),Phaser.Display.Align.In.BottomRight(e,this,-7,-8),this.levelButton=e,this.levelButton.setVisible(!1)},n.createSettingsMenu=function(){this.settingsMenu=new gP(this.scene,!0,!1),this.settingsMenu.setName("SettingsMenu"),Phaser.Display.Align.In.TopRight(this.settingsMenu,this,-5,0),this.add(this.settingsMenu),this.settingsMenu.close(0)},n.createLocationMapButton=function(){var e=new dk(this.scene);this.add(e),this.locationButton=e,this.locationButton.setVisible(!1)},n.createJourneyButton=function(){var e=new Hc.Z(this.scene,bk,Tk.BUTTON.JOURNEY,200/3,67);e.setName("Journey"),this.add(e),Phaser.Display.Align.In.BottomLeft(e,this,-5,-5),this.journeyButton=e,this.journeyButton.kill()},n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,ie.Z.OVERLAY.KEY),this.blackBackground.setName("Black Background"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),this.add(this.blackBackground),Phaser.Display.Align.In.Center(this.blackBackground,this),yp.Z.registerObject(this.blackBackground,ce.MR.MULTIPLY_ALPHA)},n.createGuideContainer=function(){this.guideContainer=new eP(this.scene),this.guideContainer.setName("GuideContainer"),this.add(this.guideContainer)},n.alignLocationMapButton=function(){var e=-this.width/2+this.locationButton.width/2+6,t=this.journeyButton.y+this.journeyButton.height/2-this.locationButton.height/2-3.2;this.locationButton.setPosition(e,t)},t}(GameCore.Screen),Pk=xk,kk=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).maxValue=void 0,a.key=void 0,a.frames=void 0,a.bar=void 0,a.icon=void 0,a.button=void 0,a.value=void 0,a.key=n,a.frames=i,a.maxValue=1e6,a.setSize(100,28),a.createBar(),a.createValue(),a.createIcon(),a.createButton(),a.scene.add.existing((0,fc.Z)(a)),a.setValue(0),a}(0,s.Z)(t,e);var n=t.prototype;return n.setValue=function(e){var t=GameCore.Utils.Number.formatNumber(e);this.value.setText(t)},n.getValueLength=function(){return this.value.text.length},n.alignObject=function(){this.icon.setX(-this.width/2+10),this.value.setX(-this.width/2+this.bar.displayWidth/2+13),this.button&&Phaser.Display.Align.In.RightCenter(this.button,this.bar),Phaser.Display.Align.In.LeftCenter(this.bar,this)},n.createBar=function(){var e=this.scene.make.nineslice({key:this.key,frame:this.frames.background,width:91,height:25.5,leftWidth:10,rightWidth:10});e.setOrigin(0,.5),this.add(e),this.bar=e},n.createValue=function(){this.value=new jp(this.scene,{text:"",fontSize:this.scene.fontSize(16),strokeColor:0,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),this.add(this.value)},n.createIcon=function(){this.icon=this.scene.add.image(0,0,this.key,this.frames.icon),this.add(this.icon)},n.createButton=function(){this.frames.button&&this.scene.ads.enabled&&(this.button=this.scene.add.image(0,0,this.key,this.frames.button),this.add(this.button))},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(te._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen)return e.getScreenName();e=e.parentContainer}return this.scene.getSceneName()},(0,H.Z)(t,[{key:"onClick",set:function(e){var t=this;this.scene.ads.enabled&&(this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t.logButtonEvent(),e(),t.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.BUTTON_CLICK)})))}}]),t}(Phaser.GameObjects.Container),Ik=kk,Ok=n(18),Rk=Wi.Z.DASHBOARD,Bk=Rk.KEY,Dk=Rk.FRAME,Lk=function(e){function t(t){var n;return(n=e.call(this,t,Bk,{background:Dk.BAR_VALUE.STAR,icon:Dk.ICON.STAR})||this).scene=void 0,n.bounceTween=void 0,n.informationContainer=void 0,n.addIcon=void 0,n.bar.setSizeByWorld(290/3,23),n.scene=t,n.icon.setDefaultWorldSize(),n.value.setTint(16777215),n.value.setFontSize(14),n.setName("ScoreBar"),n.maxValue=1e6,n.align(),n.createInformationContainer(),n}(0,s.Z)(t,e);var n=t.prototype;return n.animateAddIcon=function(e,t){this.scene.add.tween({targets:this.informationContainer,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.setValue=function(e){var t="";t=e>=1e5?(0,Ok.Z)(e):e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),this.value.setText(t)},n.updateBarSize=function(e,t){this.bar.setSizeByWorld(e,t)},n.align=function(){this.alignObject(),this.value.setY(.5),Phaser.Display.Align.In.LeftCenter(this.icon,this.bar,3,0)},n.getIconCoinPosition=function(){var e=this.icon.getWorldPosition();return{x:e.x-2,y:e.y-2.2}},n.getBarSize=function(){var e=this.bar;return{width:e.displayWidth,height:e.displayHeight}},n.getWorldPositionOfStar=function(){return this.icon.getWorldPosition()},n.getStarLabelPosition=function(){return this.value.getWorldPosition()},n.runBounceCoinTextAnimation=function(){var e,t;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this.value,scale:"+=0.2",yoyo:!0,repeat:2,ease:Phaser.Math.Easing.Sine.InOut,duration:180}))},n.createInformationContainer=function(){var e=this.scene.add.container(0,0);this.add(e),this.informationContainer=e,this.createAddIcon(),this.createInformationText(),Phaser.Display.Align.In.BottomRight(this.informationContainer,this.icon,4,1)},n.createAddIcon=function(){var e=this.scene.add.image(0,0,Bk,Dk.ICON.GREEN_CIRCLE);e.setDefaultWorldSize(),this.informationContainer.add(e),this.informationContainer.setSize(e.width,e.height),this.addIcon=e,Phaser.Display.Align.In.Center(e,this.informationContainer)},n.createInformationText=function(){var e=new jp(this.scene,{text:"i",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.informationContainer.add(e),Phaser.Display.Align.In.Center(e,this.informationContainer)},t}(Ik),_k=Lk,Mk=Wi.Z.DASHBOARD,Nk=Mk.KEY,Gk=Mk.FRAME,Zk=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.progressBar=void 0,a.progressBarBackground=void 0,a.progressBarFill=void 0,a.progressBarText=void 0,a.scene=t,a.setSize(n,109/3),a.create(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setProgressBarFill(0,10)},n.setProgressBarFill=function(e,t){var n=this.progressBarFill.displayHeight,i=this.width-11,a=Math.max(0,Math.min(e,t)),r=0===a?21:a===t?i:(0,ek.Z)(a,0,t,24,205);this.progressBarFill.setSizeByWorld(r,n),this.progressBarText.setText(Math.floor(a)+"/"+t)},n.create=function(){var e=this.scene.add.container(0,0);this.progressBarBackground=this.createProgressBarBackground(),this.progressBarFill=this.createProgressBarFill(),this.progressBarText=this.createProgressText(),this.progressBarText.setY(-1),e.add([this.progressBarBackground,this.progressBarFill,this.progressBarText]),this.add(e),this.progressBar=e},n.createProgressBarBackground=function(){return this.scene.make.nineslice({key:Nk,frame:Gk.JOURNEY.PROGRESS_BAR,width:this.width,height:119/3,leftWidth:10,rightWidth:10})},n.createProgressBarFill=function(){var e=this.scene.make.nineslice({key:Nk,frame:Gk.JOURNEY.PROGRESS_FILL,width:this.width-11,height:82/3,leftWidth:10,rightWidth:10});e.setOrigin(0,.5);var t=(this.progressBarBackground.displayWidth-e.displayWidth)/2;return e.setX(-this.progressBarBackground.displayWidth/2+t),e.setY(-1.4),e},n.createProgressText=function(){return new jp(this.scene,{text:"1/10",fontSize:this.scene.fontSize(21),strokeColor:0,strokeThickness:1.5,strokeOffset:{y:.5},strokeAlpha:.5})},t}(Phaser.GameObjects.Container),Fk=Zk,Uk=Wi.Z.DASHBOARD,Wk=Uk.KEY,Hk=Uk.FRAME,Yk=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.thumbnail=void 0,n.lock=void 0,n.overlay=void 0,n.thumbnailKey=void 0,n.previousEventName=void 0,n.loading=void 0,n.border=void 0,n.scene=t,n.create(),n.setSize(n.border.width,n.border.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateThumbnail=function(e,t){var n=this;if(null!==e){this.revive();var i=e.thumbnail,a=i.key,s=i.url,o=i.frame;""!==this.thumbnailKey&&this.thumbnailKey===a||(this.thumbnail.kill(),this.showLoading(!0)),this.thumbnailKey=a,this.scene.load.off(this.previousEventName);var h=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.thumbnail.kill(),n.showLoading(!0),t="filecomplete-image-"+a,!n.scene.textures.exists(a)){e.next=9;break}return n.thumbnail.setTexture(a,o),n.thumbnail.setWorldSize(n.background.width,n.background.height),n.showLoading(!1),n.thumbnail.revive(),e.abrupt("return");case 9:n.scene.load.image(a,s),n.scene.load.start(),n.scene.load.once(t,h),n.previousEventName=t;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();h(),t?(this.lock.revive(),this.overlay.revive()):(this.lock.kill(),this.overlay.kill())}else this.kill()},n.showLoading=function(e){this.loading.setVisible(e)},n.create=function(){this.createBackground(),this.createThumbnail(),this.createOverlay(),this.createLoading(),this.createBorder(),this.createLock()},n.createBackground=function(){var e=this.scene.add.image(0,0,Wk,Hk.JOURNEY.THUMBNAIL_BACKGROUND);e.setDefaultWorldSize(),this.add(e),this.background=e},n.createThumbnail=function(){var e=this.scene.add.image(0,0,Wk,Hk.JOURNEY.THUMBNAIL_BACKGROUND);e.setDefaultWorldSize(),this.add(e),this.thumbnail=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,Wk,Hk.JOURNEY.THUMBNAIL_OVERLAY);e.setDefaultWorldSize(),this.add(e),this.overlay=e},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(40,40),this.loading.setY(0),this.add(this.loading),this.showLoading(!1)},n.createBorder=function(){var e=this.scene.add.image(0,0,Wk,Hk.JOURNEY.THUMBNAIL_BORDER);e.setDefaultWorldSize(),this.add(e),this.border=e},n.createLock=function(){var e=this.scene.add.image(0,0,Wk,Hk.JOURNEY.THUMBNAIL_LOCK);e.setDefaultWorldSize(),this.add(e),this.lock=e},t}(Phaser.GameObjects.Container),Kk=Yk,zk=function(e){function t(t){var n;return(n=e.call(this,t,300,40)||this).scene=void 0,n.progressBar=void 0,n.currentThumbnail=void 0,n.nextThumbnail=void 0,n.scene=t,n.create(),n.alignItems(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.current,n=e.next;this.updateProgressBar(t),this.currentThumbnail.updateThumbnail(t,!1),this.nextThumbnail.updateThumbnail(n,!0),t.progressBar.currentProgress!==t.progressBar.maxProgress||n?this.revive():this.kill()},n.updateProgressBar=function(e){var t=e.progressBar;this.progressBar.setProgressBarFill(t.currentProgress,t.maxProgress)},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.currentThumbnail,this,0,-2),Phaser.Display.Align.In.RightCenter(this.nextThumbnail,this,0,-2)},n.create=function(){this.createCurrentMapThumbnail(),this.createNextMapThumbnail(),this.createProgressBar(),this.add([this.progressBar,this.currentThumbnail,this.nextThumbnail])},n.createProgressBar=function(){this.progressBar=new Fk(this.scene,this.width-this.currentThumbnail.width,this.height)},n.createCurrentMapThumbnail=function(){this.currentThumbnail=new Kk(this.scene)},n.createNextMapThumbnail=function(){this.nextThumbnail=new Kk(this.scene)},t}(Kp.Z),Vk=zk,jk=Wi.Z.DASHBOARD,Xk=jk.KEY,qk=jk.FRAME,Jk=function(e){function t(t){var n;return(n=e.call(this,t,{key:Xk,backgroundFrame:qk.LEVEL_BUTTON.NORMAL,buttonFrame:qk.LEVEL_BUTTON.NORMAL,buttonWidth:200,buttonHeight:71})||this).scene=void 0,n.levelText=void 0,n.widgetSparksPool=[],n.scene=t,n.button.setName("Level"),n.createText(),n.setSize(n.width,n.height),n.alignBackground(0,-1.5),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runClaimItemsAnimation=function(){var e=this;this.scene.add.tween({targets:this,duration:75,scale:.925,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS)},onComplete:function(){e.scene.add.tween({targets:e,duration:75,scale:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[4]})}})},n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.createText=function(){var e=new jp(this.scene,{text:"Level 1",fontSize:this.scene.fontSize(this.scene.lang.getFontSize("playButton")),strokeColor:1075202,strokeThickness:3.5,strokeOffset:{y:.8},strokeAlpha:.9});e.setY(-3),this.levelText=e,this.addIntoButton(e)},n.getWidgetSparks=function(){var e=this.widgetSparksPool.find((function(e){return!e.active}));return e||(e=this.createWidgetSparks(),this.widgetSparksPool.push(e)),e},n.createWidgetSparks=function(){var e=new OP(this.scene);return this.add(e),e},t}(tT),Qk=Jk,$k=Wi.Z.DASHBOARD,eI=$k.KEY,tI=$k.FRAME,nI=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).scene=void 0,i.levelButton=void 0,i.shopButton=void 0,i.settingsButton=void 0,i.journeyButton=void 0,i.challengeButton=void 0,i.weeklyTournamentButton=void 0,i.boxingDuelButton=void 0,i.raceButton=void 0,i.eventButtonsManager=void 0,i.eventsManager=void 0,i.title=void 0,i.canOpenResScrnFirstTime=void 0,i.exitAnimation=void 0,i.contentExitAnimation=void 0,i.screensWillBeShown=void 0,i.isScreenOpen=void 0,i.dataBeforeClaimJourney=void 0,i.handleOpenLevelNextStep=void 0,i.backToDashboard=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.eventsManager.displayAllEventScreens();case 2:case"end":return e.stop()}}),e)}))),i.updateWeeklyTournamentButtonVisibility=function(){i.scene.weeklyTournament.isValid()?i.weeklyTournamentButton.revive():i.weeklyTournamentButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.updateOffshoreRaceButtonVisibility=function(){i.scene.offshoreRace.isValid()?i.raceButton.revive():i.raceButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.updateBoxingDuelButtonVisibility=function(){i.scene.boxingDuel.isValid()?i.boxingDuelButton.revive():i.boxingDuelButton.kill(),i.eventButtonsManager.alignButtonsBoxes()},i.handleOpenLevel=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.scene.gameplay.processStartLevel(),i.scene.screen.close(i.name);case 2:case"end":return e.stop()}}),e)}))),i.handleOpenShop=function(){},i.handleOpenJourneyScreen=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),t&&i.scene.screen.close(i.name),i.scene.journeyDataService.updateData(),e.next=5,i.scene.requireTextureAsync("JOURNEY");case 5:i.scene.screen.open(ce.o4.JOURNEY_SCREEN,{shouldCloseAfterComplete:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleOpenChallengeScreen=function(){i.scene.screen.open(ce.o4.CHALLENGE_WELCOME_SCREEN,{header:"1vs1 Challenge",description:"Play with friends to\nearn more coins"})},i.onEntranceCompleted=function(){i.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){return i.scene.screen.close(i.name)}))},i.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(i)),i.isScreenOpen=!1},i.scene=t,i.background.kill(),i.dataBeforeClaimJourney=void 0,i.create(),i.scene.events.emit("refresh-event-toggle",!0),i.zone.disableInteractive(),i.listenEvents(),i.challengeButton.kill(),i}(0,s.Z)(t,e);var n=t.prototype;return n.getCanOpenPrevClgRes=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canOpenResScrnFirstTime){e.next=2;break}return e.abrupt("return",!0);case 2:return t=new Promise((function(e){return setTimeout((function(){return e(!1)}),2e3)})),n=new Promise((function(e){i.scene.events.once(hi.PLAYER_FINISH_CHALLENGE,(function(){return e(!0)}))})),e.abrupt("return",Promise.race([t,n]));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleOpenChallengeResult=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.screen.get(ce.o4.CHALLENGE_RESULT_SCREEN)){e.next=3;break}return e.abrupt("return");case 3:return this.scene.screen.open(ce.o4.CHALLENGE_RESULT_SCREEN),e.abrupt("return",new Promise((function(e){t.on(GameCore.Screens.Events.CLOSE,(function(){e()}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.create=function(){this.eventButtonsManager=new $P(this),this.createTitle(),this.createCoinProgress(),this.createTournamentButton(),this.createOffshoreRaceButton(),this.createBoxingDuelButton(),this.createShopButton(),this.createChallengeButton(),this.createLevelButton(),this.createSettingsButton(),this.createJourneyButton(),this.createStarBar(),this.levelButton.onClick=this.handleOpenLevel,this.shopButton.onClick=this.handleOpenShop,this.weeklyTournamentButton.onClick=this.weeklyTournamentButton.handleOnButtonClicked,this.boxingDuelButton.onClick=this.boxingDuelButton.handleOnButtonClicked,this.raceButton.onClick=this.raceButton.handleOnButtonClicked,this.challengeButton.onClick=this.handleOpenChallengeScreen,this.journeyButton.onClick=this.handleOpenJourneyScreen},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r,s,o,h,u,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isScreenOpen){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:if(e.prototype.open.call(this,n),this.isScreenOpen=!0,this.scene.offshoreRace.setShouldCheckTime(!0),this.setDisableButtons(!0),this.scene.setBackgroundWithFadeAnimation(),this.dataBeforeClaimJourney&&(n=this.dataBeforeClaimJourney,this.dataBeforeClaimJourney=void 0),a=null!=(i=n)?i:{},r=a.shouldPlusEventScore,s=void 0!==r&&r,o=a.canShowWelcomeBackScreen,h=void 0!==o&&o,u=a.openLevelNextStep,l=void 0!==u&&u,this.handleOpenLevelNextStep=l,this.updateData(),this.updateEventButtonsVisibility(),this.handleOpenLevelNextStep||(this.scene.gameUI.coinBarButton.setDisabled(!1),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.BUTTON)),this.scene.gameUI.hideUI(),this.scene.gameUI.showCoin(),this.scene.gameUI.showLife(),this.runEntrancesAnimation(),this.runContentEntranceAnimation(),!s){t.next=22;break}return this.scene.showTournamentShareDialog(!1),t.next=22,this.runPlusScoreEvents();case 22:if(this.scene.events.emit("refresh-event-toggle",!0),this.eventButtonsManager.showWarningBadgeOnEventButtons(),!h){t.next=29;break}return t.next=27,(0,dl.Z)(this.scene,750);case 27:return t.next=29,this.scene.screen.openAsync(ce.o4.WELCOME_BACK_SCREEN);case 29:if(!this.handleOpenLevelNextStep){t.next=34;break}return t.next=32,(0,dl.Z)(this.scene,750);case 32:this.handleOpenLevel(),this.handleOpenLevelNextStep=!1;case 34:this.scene.turnOnBackgroundMusic(),this.setDisableButtons(!1);case 36:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateEventButtonsVisibility=function(){this.updateWeeklyTournamentButtonVisibility(),this.updateOffshoreRaceButtonVisibility(),this.updateBoxingDuelButtonVisibility()},n.runPlusScoreEvents=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.weeklyTournament,i=t.boxingDuel,a=t.offshoreRace,r=[{timeout:function(){return n.isTournamentTimeOut()},update:function(){return h.eventsManager.updateWeeklyTournamentData()},score:function(){return h.scene.gameplay.eventManager.getWeeklyTournamentItemAmount()},button:this.weeklyTournamentButton},{timeout:function(){return i.isTimeout()},update:function(){return h.eventsManager.updateBoxingDuelData()},score:function(){return h.scene.gameplay.eventManager.getBoxingDuelItemAmount()},button:this.boxingDuelButton},{timeout:function(){return a.isTimeout()},update:function(){return h.eventsManager.updateOffshoreRaceData()},score:function(){return h.scene.gameplay.eventManager.getRaceItemAmount()},button:this.raceButton}],s=r.map((function(e){var t=e.timeout,n=e.update,i=e.score,a=e.button;return t()?(n(),null):{score:i(),button:a}})).filter((function(e){return null!==e})),!s.some((function(e){return e&&e.score>0}))){e.next=10;break}return o=500,e.next=8,(0,le.qZ)(300);case 8:this.bringToTop(this.eventButtonsManager.box),s.forEach((function(e){e&&e.score>0&&(h.eventButtonsManager.box.bringButtonToTop(e.button.buttonType),e.button.runPlusScoreAnimation(e.score,o),o+=150)}));case 10:return e.next=12,Promise.all(r.map((function(e){return e.button.plusScoreAnimationPromise})));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.setDisableButtons(!0),this.runCloseAnimation(),this.scene.gameUI.hideLife()},n.updateData=function(){var e,t,n=this.scene.level.getLevel(),i=(null!=(e=null==(t=this.scene.level.getLevelData())?void 0:t.settings.mapProperties.difficulty)||Difficulty.NORMAL,this.scene.player.getJourneyProgress().inProgressLocation);i&&(i.progress>=2*i.decorations.length&&this.scene.locationManager.preloadNextBackgroundAsync());this.levelButton.setLevel(n)},n.listenEvents=function(){this.scene.events.on(hi.BACK_TO_DASHBOARD,this.backToDashboard,this),this.scene.weeklyTournament.events.on(xo,this.updateWeeklyTournamentButtonVisibility,this),this.scene.offshoreRace.events.on(aa,this.updateOffshoreRaceButtonVisibility,this),this.scene.boxingDuel.events.on(Mi,this.updateBoxingDuelButtonVisibility,this)},n.setDisableButtons=function(e){this.levelButton.setDisabled(e),this.settingsButton.setDisabled(e),this.challengeButton.setDisabled(e),this.journeyButton.setDisabled(e),this.weeklyTournamentButton.setDisabled(e),this.raceButton.setDisabled(e),this.boxingDuelButton.setDisabled(e),this.levelButton.setAlpha(1),this.settingsButton.setAlpha(1),this.challengeButton.setAlpha(1),this.journeyButton.setAlpha(1),this.weeklyTournamentButton.setAlpha(1),this.raceButton.setAlpha(1),this.boxingDuelButton.setAlpha(1)},n.runEntrancesAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this.exitAnimation)||t.stop(),null==(n=this.contentExitAnimation)||n.stop(),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]}),e.next=5,this.runEventButtonsEntranceAnimation();case 5:this.onEntranceCompleted();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runContentEntranceAnimation=function(){var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsButton,scale:1},{obj:this.shopButton,scale:1},{obj:this.challengeButton,scale:1},{obj:this.weeklyTournamentButton,scale:1},{obj:this.raceButton,scale:1},{obj:this.boxingDuelButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj,a=e.scale;i.setScale(.75),t.add({targets:[i],props:{scale:a,alpha:1},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460"})})),t.playAndWaitForCompletion().then((function(){}))},n.runContentExitAnimation=function(){var e=[{obj:this.title,scale:1},{obj:this.journeyButton,scale:1},{obj:this.levelButton,scale:1},{obj:this.settingsButton,scale:1},{obj:this.shopButton,scale:1},{obj:this.challengeButton,scale:1}],t=this.scene.tweens.createTimeline({});e.forEach((function(e,n){var i=e.obj;t.add({targets:[i],props:{scale:.75,alpha:0},duration:500,ease:Phaser.Math.Easing.Back.Out,offset:0==n?0:"-=460"})})),t.play(),this.contentExitAnimation=t},n.runEventButtonsEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runEntranceAnimation(),n=this.boxingDuelButton.runEntranceAnimation(),i=this.raceButton.runEntranceAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEventButtonsExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.weeklyTournamentButton.runExitAnimation(),n=this.boxingDuelButton.runExitAnimation(),i=this.raceButton.runExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.exitAnimation=this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)]}),this.runContentExitAnimation(),e.next=4,this.runEventButtonsExitAnimation();case 4:this.onExitCompleted();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=new hv(this.scene);e.setText("Location Name"),e.setFontSize(32),e.setColor(7162732),e.kill(),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-244),this.title=e},n.createCoinProgress=function(){var e=new Wx(this.scene);e.setName("CoinProgress"),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-5)},n.createTournamentButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.WEEKLY_TOURNAMENT);e.kill(),this.weeklyTournamentButton=e},n.createBoxingDuelButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.BOXING_DUEL);e.kill(),this.boxingDuelButton=e},n.createOffshoreRaceButton=function(){var e=this.eventButtonsManager.getButtonByType(QP.OFFSHORE_RACE);e.kill(),this.raceButton=e},n.createShopButton=function(){},n.createChallengeButton=function(){var e=new Hc.Z(this.scene,eI,tI.ICON.CHALLENGE,70,70);e.setName("Challenge"),this.add(e),Phaser.Display.Align.In.TopLeft(e,this,-8,-180),this.challengeButton=e;var t=new hv(this.scene);t.setText("Challenge"),t.setFontSize(10),t.setCenterAlign(),t.setColor(7162732),t.setY(30),e.add(t)},n.createLevelButton=function(){var e=new Qk(this.scene);this.add(e),Phaser.Display.Align.In.Center(e,this,0,150),this.levelButton=e},n.createSettingsButton=function(){var e=this;this.settingsButton=new iv.Z(this.scene,{key:eI,frame:tI.BUTTON.SETTING,width:100/3,height:104/3,paddingZone:30}),this.settingsButton.setName("DashboardSettings"),this.add(this.settingsButton),Phaser.Display.Align.In.TopRight(this.settingsButton,this,-8,-9),this.settingsButton.onClick=function(){e.scene.screen.open(ce.o4.DASHBOARD_SETTINGS_SCREEN)}},n.createStarBar=function(){var e=new _k(this.scene);this.add(e),Phaser.Display.Align.To.LeftCenter(e,this.settingsButton,-10,0)},n.createJourneyButton=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new Vk(this.scene)).setName("Journey"),this.add(t),Phaser.Display.Align.In.Center(t,this,0,60),this.journeyButton=t;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(GameCore.Screen),iI=nI,aI=GameCore.layoutInitializer.isLandscape?Pk:iI,rI=Wi.Z.DASHBOARD,sI=rI.KEY,oI=rI.FRAME,cI={width:90,height:94/3},hI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.titleText=void 0,n.titleBorder=void 0,n.scene=t,n.setSize(90,94/3),n.createTitleBorder(),n.createTitleText(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateTitle=function(e,t){this.titleText.setText(e+". "+t),this.titleBorder.setSizeByWorld(this.titleText.width+30,cI.height)},n.createTitleBorder=function(){var e=this.scene.make.nineslice({key:sI,frame:oI.DECOR.TITLE_BORDER,leftWidth:20,rightWidth:20,width:cI.width,height:cI.height});this.add(e),this.titleBorder=e,this.setSize(e.displayWidth,e.displayHeight)},n.createTitleText=function(){var e=new jp(this.scene,{text:"Paris",fontSize:this.scene.fontSize(18),fillColor:11102533});e.setY(-1),this.add(e),this.titleText=e},t}(Phaser.GameObjects.Container),uI=hI,lI=Wi.Z.DASHBOARD,dI=lI.KEY,pI=lI.FRAME,fI=function(e){function t(t){var n;return(n=e.call(this,t,118,170/3,.925)||this).scene=void 0,n.text=void 0,n.alert=void 0,n.scene=t,n.setName("NextJourney"),n.create(),n.alignItems(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.text,this,15),Phaser.Display.Align.In.TopRight(this.alert,this,1,1)},n.create=function(){this.createButton(),this.createText(),this.createAlert()},n.createButton=function(){var e=this.scene.make.nineslice({key:dI,frame:pI.DECOR.LOCATION_BUTTON,leftWidth:45,rightWidth:20,width:this.width,height:this.height});this.add(e)},n.createText=function(){var e=new jp(this.scene,{text:"Next\nJourney",fontSize:this.scene.fontSize(14),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setCenterAlign(),e.setPosition(0,0),this.add(e),this.text=e},n.createAlert=function(){var e=this.scene.add.image(0,0,Wi.Z.DASHBOARD.KEY,Wi.Z.DASHBOARD.FRAME.DECOR.ALERT);e.setDefaultWorldSize(),this.add(e),this.alert=e},t}(Kp.Z),mI=fI,gI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.image=void 0,n.imageOriginX=void 0,n.imageOriginY=void 0,n.scene=t,n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.getImageOrigin=function(){return{x:this.imageOriginX,y:this.imageOriginY}},n.getImageWidth=function(){return this.image.width},n.getImageHeight=function(){return this.image.height},n.isImageShow=function(){return this.image.visible&&this.image.active},n.hideImage=function(){this.image.kill(),this.image.setAlpha(0)},n.showImage=function(){this.image.revive(),this.image.setAlpha(1)},n.runHideImage=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this.image,scale:0,duration:300,ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.hideImage()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runShowImage=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=1/GameCore.ImageScale,e.next=4,this.scene.tweens.add({targets:this.image,scale:{from:0,start:0,to:n},duration:300,delay:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){i.showImage()}}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createFrame=function(e,t,n,i){this.image=this.scene.add.image(0,0,e,t);var a=this.scene.textures.getFrame(e,t);this.imageOriginX=n,this.imageOriginY=1-i/(a.height/2),this.image.setOrigin(this.imageOriginX,this.imageOriginY),this.image.setDefaultWorldSize(),this.add(this.image);var r=(0,ek.Z)(this.imageOriginX,0,1,-this.image.width/2,this.image.width/2),s=(0,ek.Z)(this.imageOriginY,0,1,-this.image.height/2,this.image.height/2);this.image.setPosition(r,s),this.hideImage(),this.setSize(this.image.width,this.image.height)},t}(Phaser.GameObjects.Container),vI=gI,yI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.spineTop=void 0,n.key=void 0,n.decorationName=void 0,n.frames=void 0,n.decorationFrames=[],n.loading=void 0,n.scene=t,n.setSize(100,100),n.key="",n.decorationName="",n.create(),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.resetDecorationFrames=function(){this.decorationFrames.forEach((function(e){e.hideImage()})),this.key="",this.decorationName=""},n.hide=function(){this.decorationFrames.forEach((function(e){e.kill()}))},n.showDecorationBuilt=function(e){if(0!==e){var t=e-1;this.reviveWithTween(this.decorationFrames[t])}},n.reviveWithTween=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isImageShow()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.waitForLoadingToFinish();case 4:this.scene.tweens.add({targets:t,alpha:{from:0,start:0,to:1},duration:400,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){t.showImage()}});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateDecoration=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.file,r=n.decorations,s=t.toLowerCase(),i>0&&!this.scene.textures.exists(s)&&(this.setLoadingPosition(n,i),this.animateLoading(!0)),e.next=5,this.scene.requireDecorationTextureAsync(t);case 5:return e.next=7,this.updateDecorationFrames(t,a,r);case 7:this.animateLoading(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.setLoadingPosition=function(e,t){var n=e.decorations[t-1],i=n.x,a=n.y,r=n.width,s=n.height,o=n.offsetX,c=this.calculateLocalPosition(i,a),h=r/GameCore.ImageScale,u=s/GameCore.ImageScale,l=(0,ek.Z)(o,0,1,-h/2,h/2);this.loading.setPosition(c.x+h/2+l,c.y+u/2)},n.updateDecorationFrames=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.key!==t||this.decorationName!==n){e.next=2;break}return e.abrupt("return");case 2:this.key=t,this.decorationName=n,a=n+"-1",r=n+"-2",s=n+"-3",this.frames=[a,r,s],this.decorationFrames.forEach((function(e,t){e.revive();var n=h.frames[t];e.createFrame(h.key,n,i[t].offsetX,i[t].offsetY);var a=h.calculateLocalPosition(i[t].x,i[t].y),r=e.displayWidth/2,s=e.displayHeight/2;e.setPosition(a.x+r,a.y+s)})),o=this.decorationFrames.reduce((function(e,t){return t.displayWidth>e.displayWidth?t:e}),this.decorationFrames[0]),this.setSize(o.displayWidth,o.displayHeight);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.calculateLocalPosition=function(e,t){var n=e/3-(800-this.scene.gameZone.width)/2,i=t/3;return this.parentContainer.getLocalPoint(n,i)},n.updateDepth=function(){var e=this;this.spineTop&&this.spineTop.setDepth(1),this.decorationFrames.forEach((function(t){e.sendToBack(t)}))},n.playUpgradeAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.spineTop){e.next=4;break}return e.next=3,this.scene.requireSpineAsync("CHANGE_VFX_SPINE");case 3:this.createSpineTop();case 4:if(this.scene.vibration.performVibrating(50),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.UPGRADE_DECORATION,{},!0),1!==t){e.next=11;break}return e.next=9,this.playDecorationFrameUpgradeAnimation(void 0,this.decorationFrames[0]);case 9:e.next=19;break;case 11:if(2!==t){e.next=16;break}return e.next=14,this.playDecorationFrameUpgradeAnimation(this.decorationFrames[0],this.decorationFrames[1]);case 14:e.next=19;break;case 16:if(3!==t){e.next=19;break}return e.next=19,this.playDecorationFrameUpgradeAnimation(this.decorationFrames[1],this.decorationFrames[2]);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playDecorationFrameUpgradeAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.gameplay.spineManager,a=(0,ek.Z)(n.getImageOrigin().x,0,1,-n.getImageWidth()/2,n.getImageWidth()/2),this.spineTop.setPosition(n.x-7+a,n.y+n.displayHeight/3),i.playAnimation(this.spineTop,Yu.CHANGE_VFX.CHANGE_TOP),n.hideImage(),r=Promise.resolve(),Promise.resolve(),t&&(r=t.runHideImage()),s=n.runShowImage(t?400:300),e.next=11,Promise.all([r,s]);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.waitForLoadingToFinish=function(){var e=this;return new Promise((function(t){!function n(){e.loading.visible?e.scene.time.delayedCall(50,n,[],e):t()}()}))},n.create=function(){this.createLoading(),this.createDecorationFrame()},n.createSpineTop=function(){var e=this.scene.add.spine(0,0,Wi.Z.CHANGE_VFX_SPINE.DATA_KEY,Wi.Z.CHANGE_VFX_SPINE.ATLAS_KEY),t=1/GameCore.ImageScale;e.setScale(t),this.spineTop=e,this.spineTop.setPosition(-7,50),this.add(e)},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setWorldSize(20,20),this.loading.setVisible(!1),this.add(this.loading)},n.animateLoading=function(e){this.loading.setVisible(e)},n.createDecorationFrame=function(){var e=this;this.decorationFrames=new Array(3).fill(null).map((function(){var t=new vI(e.scene);return e.add(t),t}))},t}(Phaser.GameObjects.Container),EI=yI,CI=Wi.Z.DASHBOARD,AI=CI.KEY,wI=CI.FRAME,SI=function(e){function t(t){var n;return(n=e.call(this,t,0,0,.925)||this).scene=void 0,n.upgradeOffDots=void 0,n.upgradeOnDots=void 0,n.costText=void 0,n.scene=t,n.setName("DecorationUpgrade"),n.createButton(),n.createUpgradeOffDots(),n.createUpgradeOnDots(),n.createStarIcon(),n.createCostText(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateLevel=function(e){this.upgradeOnDots.forEach((function(t,n){var i=n<e;t.setVisible(i)}))},n.setCost=function(e){0!==e&&this.costText.setText(e.toString())},n.createButton=function(){var e=this.scene.add.image(0,0,AI,wI.BAR_VALUE.UPGRADE);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height)},n.createUpgradeOffDots=function(){var e=this,t=new Array(3).fill(0).map((function(t,n){var i=e.scene.add.image(0,0,AI,wI.UPGRADE_OFF);return i.setOrigin(.5,.5),i.setDefaultWorldSize(),e.add(i),i}));t.forEach((function(t,n){var i=8*(n-1);t.setPosition(i,-e.height/2+t.height/2+3.5)})),this.upgradeOffDots=t},n.createUpgradeOnDots=function(){var e=this,t=new Array(3).fill(0).map((function(t,n){var i=e.scene.add.image(0,0,AI,wI.UPGRADE_ON);return i.setOrigin(.5,.5),i.setDefaultWorldSize(),i.setVisible(!1),e.add(i),i}));t.forEach((function(t,n){t.setPosition(e.upgradeOffDots[n].x,e.upgradeOffDots[n].y)})),this.upgradeOnDots=t},n.createStarIcon=function(){var e=this.scene.add.image(0,0,AI,wI.ICON.SMALL_STAR);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.Center(e,this,-6,2.5)},n.createCostText=function(){var e=new jp(this.scene,{text:"2",fontSize:this.scene.fontSize(15),fillColor:11102533});this.add(e),Phaser.Display.Align.In.Center(e,this,10,3),this.costText=e},t}(Kp.Z),bI=SI,TI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.upgradeButton=void 0,n.spineClicked=!1,n.buildingData=void 0,n.decorationId=void 0,n.isDraggable=!1,n.decoration=void 0,n.isDecorationDraggable=!1,n.canUpgrade=void 0,n.handleDecorationUpgradeButtonOnClick=(0,r.Z)(c().mark((function e(){var t,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.spineClicked&&n.canUpgrade){e.next=2;break}return e.abrupt("return");case 2:if(n.spineClicked=!0,t=n.buildingData.level,i=n.scene.player.getStar(),a=n.getNextLevelCost(t),!(i<a)){e.next=11;break}return n.spineClicked=!1,n.scene.events.emit(hi.CANNOT_UPGRADE_DECORATION),n.scene.screen.open(ce.o4.GET_MORE_STARS_SCREEN),e.abrupt("return");case 11:return n.scene.player.setStar(i-a),n.buildingData.level+=1,n.scene.journey.updateDecorationData(n.decorationId,n.buildingData.level),n.scene.journey.events.emit(hi.DECORATION_UPGRADE),n.scene.logEconomy.logUseItem(fl.STAR,a,gl.USE_STORAGE_ITEM),n.updateUpgradeButton(n.buildingData.level),2===t&&n.runDecorationUpgradeButtonExitAnimation(),e.next=20,n.decoration.playUpgradeAnimation(n.buildingData.level);case 20:n.updateUpgradeButtonVisibility(n.buildingData.level),n.scene.journey.events.emit(hi.DECORATION_UPGRADED),n.spineClicked=!1;case 23:case"end":return e.stop()}}),e)}))),n.onDragStart=function(){n.isDraggable=!0},n.onDrag=function(e){if(n.isDraggable){var t=n.scene.locationManager.getLocalPoint(n.scene.input.activePointer.worldX,n.scene.input.activePointer.worldY),i=t.x,a=t.y;n.upgradeButton.setPosition(Math.round(i)-n.x,Math.round(a)-n.y)}},n.onDragEnd=function(){n.isDraggable=!1},n.onDecorationDragStart=function(){n.isDecorationDraggable=!0},n.onDecorationDrag=function(e){if(n.isDecorationDraggable){var t=n.scene.locationManager.getLocalPoint(n.scene.input.activePointer.worldX,n.scene.input.activePointer.worldY),i=t.x,a=t.y;n.decoration.setPosition(Math.round(i)-n.x,Math.round(a)-n.y)}},n.onDecorationDragEnd=function(){n.isDecorationDraggable=!1},n.scene=t,n.setSize(100,100),n.canUpgrade=!1,n.buildingData={name:"",level1Cost:3,level2Cost:4,level3Cost:5,level:0},n.createDecoration(),n.createUpgradeButton(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateUpgradeButton(this.buildingData.level),this.updateUpgradeButtonVisibility(this.buildingData.level),e.next=4,this.runDecorationUpgradeButtonEntranceAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runDecorationUpgradeButtonExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.id,r=n.buttonX,s=n.buttonY,this.decorationId=a,this.buildingData.level=i,this.buildingData.name=n.file,this.setPosition(r,s),e.next=7,this.decoration.updateDecoration(t,n,i);case 7:this.canUpgrade=!0,this.decoration.showDecorationBuilt(i),this.updateDepth();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.hideDecoration=function(){this.decoration.hide()},n.resetDecoration=function(){this.buildingData.level=0,this.decoration.resetDecorationFrames()},n.createDecoration=function(){this.decoration=new EI(this.scene),this.add(this.decoration)},n.createUpgradeButton=function(){this.upgradeButton=new bI(this.scene),this.add(this.upgradeButton),this.updateUpgradeButton(this.buildingData.level),this.setSize(this.upgradeButton.width,this.upgradeButton.height);var e=this.getNextLevelCost(this.buildingData.level);this.upgradeButton.updateLevel(this.buildingData.level),this.upgradeButton.setCost(e)},n.listenEvents=function(){},n.getCurrentCost=function(){var e=this.buildingData,t=e.level,n=e.level1Cost,i=e.level2Cost,a=e.level3Cost;switch(t){case 2:return a;case 1:return i;default:return n}},n.getNextLevelCost=function(e){switch(e){case 0:return this.buildingData.level1Cost;case 1:return this.buildingData.level2Cost;case 2:return this.buildingData.level3Cost;default:return 0}},n.updateUpgradeButton=function(e){this.upgradeButton.setCost(this.getNextLevelCost(e)),this.upgradeButton.updateLevel(e)},n.updateUpgradeButtonVisibility=function(e){this.upgradeButton.setVisible(e<3)},n.updateDepth=function(){this.upgradeButton.setDepth(0),this.decoration.updateDepth()},n.setButtonDisabled=function(e){this.upgradeButton.setDisabled(e),this.upgradeButton.setAlpha(1)},n.runDecorationUpgradeButtonEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buildingData.level>=3)){e.next=2;break}return e.abrupt("return");case 2:return this.setButtonDisabled(!0),e.next=5,this.runEntranceAnimation({targets:this.upgradeButton,onStart:function(){t.upgradeButton.revive()}});case 5:this.setButtonDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runDecorationUpgradeButtonExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.upgradeButton,onComplete:function(){t.upgradeButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,a.Z)({alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:1,ease:Phaser.Math.Easing.Back.Out},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,a.Z)({alpha:{from:1,start:1,to:0},scale:{from:1,start:1,to:.5,ease:Phaser.Math.Easing.Back.In},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),xI=TI,PI="opening",kI="opened",II="closing",OI="closed",RI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.curveTextAnimation=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.createCurveText(),n.scene.add.existing((0,fc.Z)(n)),n.curveTextAnimation.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){},n.processStep=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=II){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.openContainer(),e.abrupt("return",new Promise((function(e){t.on("closed",e)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=PI,this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),e.next=7,this.processStep((function(){return t.runTextEntranceAnim()}));case 7:return this.state=kI,e.next=10,this.processStep((function(){return(0,dl.Z)(t.scene,1e3)}));case 10:return e.next=12,this.processStep((function(){return t.runTextExitAnim()}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnim=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.curveTextAnimation.playEntranceAnimation(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=II,t=this.curveTextAnimation.playExitAnimation(),n=this.scene.tweens.add({targets:[this],alpha:0,duration:500,delay:800}).waitForCompletion(),e.next=5,Promise.all([t,n]);case 5:this.state=OI,this.emit("closed");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurveText=function(){var e=new Lf(this.scene,this.scene.lang.Text.levelComplete),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-2e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(46)),t.setPosition(0,-30.5),this.add(e),this.curveTextAnimation=e},t}(Phaser.GameObjects.Container),BI=Wi.Z.DEFAULT,DI=BI.KEY,LI=BI.FRAME,_I=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.glow=void 0,n.light1=void 0,n.light2=void 0,n.curveTextAnimation=void 0,n.coin=void 0,n.star=void 0,n.coinText=void 0,n.adsIcon=void 0,n.tapToCollectText=void 0,n.tapToCollectButton=void 0,n.popupContents=[],n.starEmitter=void 0,n.sparkEmitter=void 0,n.glowTween=void 0,n.light1Anim=void 0,n.light2Anim=void 0,n.lightEffect=void 0,n.adsButtonEffect=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.create(),n.alignItems(),t.add.existing((0,fc.Z)(n)),n.hideItems(),n}(0,s.Z)(t,e);var n=t.prototype;return n.setTotalCoins=function(e){this.coinText.setText(e.toString())},n.getCoinImage=function(){return this.coin},n.getStarImage=function(){return this.star},n.hideItems=function(){this.curveTextAnimation.setAlpha(0),this.popupContents.forEach((function(e){e.setAlpha(0)})),this.glow.setAlpha(0),this.light1.setAlpha(0),this.light2.setAlpha(0),this.stopAnimation()},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),e.next=5,this.runPopupContentsEntranceAnimation();case 5:this.runGlowRotationAnim(),this.runEffects(),this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.OPEN_WIN_SCREEN);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.hideItems(),this.stopAnimation()},n.runPopupContentsEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.curveTextAnimation.playEntranceAnimation(),this.adsIcon.setVisible(!1),t.push(this.runStarPopupAnimation()),this.popupContents.forEach((function(e,i){var a=e===n.tapToCollectText?.5:1,r=e.scale,s=n.scene.tweens.add({targets:e,alpha:{from:0,start:0,to:a},scale:{from:0,start:0,to:r},delay:50*i,duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();t.push(s)})),e.next=7,Promise.all(t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStarPopupAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[this.star,this.glow],n=[],i=0,a=t;i<a.length;i++)s=(r=a[i]).scale,o=r.angle,r===this.star&&(h=this.scene.tweens.add({targets:r,angle:{from:o-90,start:o-90,to:o},duration:500,ease:Phaser.Math.Easing.Cubic.Out}).waitForCompletion(),n.push(h)),u=this.scene.tweens.add({targets:r,alpha:{value:1,ease:Phaser.Math.Easing.Cubic.Out},scale:{from:0,start:0,to:s},duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion(),n.push(u);return e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEffects=function(){var e,t,n;null==(e=this.starEmitter)||e.start(),null==(t=this.sparkEmitter)||t.start(),null==(n=this.lightEffect)||n.start()},n.stopAnimation=function(){var e,t,n,i,a,r,s,o,c,h,u,l;null==(e=this.starEmitter)||e.stop(),null==(t=this.starEmitter)||t.killAll(),null==(n=this.sparkEmitter)||n.stop(),null==(i=this.sparkEmitter)||i.killAll(),null==(a=this.glowTween)||a.stop(),null==(r=this.glowTween)||r.remove(),null==(s=this.light1Anim)||s.stop(),null==(o=this.light1Anim)||o.remove(),this.light1.setAngle(0),this.light1.setScale(1/GameCore.ImageScale),null==(c=this.light2Anim)||c.stop(),null==(h=this.light2Anim)||h.remove(),this.light2.setAngle(0),this.light2.setScale(1/GameCore.ImageScale),null==(u=this.lightEffect)||u.stop(),null==(l=this.adsButtonEffect)||l.stop()},n.runGlowRotationAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e4,repeat:-1,props:{alpha:{from:1,to:.5,duration:2e3,yoyo:!0},angle:{value:360,ease:Phaser.Math.Easing.Sine.InOut}}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLightRotationAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.light1Anim)||t.remove(),null==(n=this.light2Anim)||n.remove(),i=1/GameCore.ImageScale,this.light1.kill(),this.light2.kill(),this.light1Anim=this.scene.tweens.add({targets:[this.light1],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:360},alpha:{from:.5,to:1,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}}),this.light2Anim=this.scene.tweens.add({targets:[this.light2],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:-360},scale:{from:i,to:1.075*i,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.light1.setPosition(0,65),this.light2.setPosition(0,65),this.coin.setPosition(0,65),this.glow.setPosition(0,-40),this.star.setPosition(0,-40),this.curveTextAnimation.curveText.setPosition(0,-122),this.coinText.setPosition(0,98),Phaser.Display.Align.In.BottomCenter(this.adsIcon,this,190,-20),Phaser.Display.Align.In.BottomCenter(this.tapToCollectText,this,0,-25)},n.create=function(){this.createGlowEffect(),this.createCurveTextAnimation(),this.createStar(),this.createCoin(),this.createStarParticle(),this.createSparkParticle(),this.createCoinText(),this.createTapToCollectButton(),this.createAdsIcon(),this.popupContents.push(this.coin,this.coinText,this.tapToCollectButton,this.adsIcon)},n.createGlowEffect=function(){var e=this.scene.make.image({key:DI,frame:LI.EFFECTS.GLOW_2});e.setDefaultWorldSize(),this.add(e);var t=this.scene.add.image(0,0,DI,LI.EFFECTS.LIGHT_X);t.setDefaultWorldSize(),this.add(t);var n=this.scene.add.image(0,0,DI,LI.EFFECTS.LIGHT_X);n.setDefaultWorldSize(),n.setAngle(90),this.add(n),this.glow=e,this.light1=t,this.light2=n},n.createSparkParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,DI,LI.EFFECTS.SPARK);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(100,220/3),t.setPosition(0-t.width/2,-40-t.height/2);var n=1/GameCore.ImageScale;this.sparkEmitter=e.createEmitter({frame:LI.EFFECTS.SPARK,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:Db.Z,quantity:1})},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,DI,LI.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(200/3,40),t.setPosition(0-t.width/2,65-t.height/2);var n=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:LI.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:Db.Z,quantity:1})},n.createCurveTextAnimation=function(){var e=new Lf(this.scene,this.scene.lang.Text.wellDone2),t=e.curveText;t.setFonts(Pc.ZP.STYLE.KEY),t.setOrigin(.5,.8),t.setRadius(-1e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(40)),this.add(e),this.curveTextAnimation=e},n.createStar=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.STAR);i.setDefaultWorldSize(),this.add(i),this.star=i},n.createCoin=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.COIN);i.setDefaultWorldSize(),this.add(i),this.coin=i},n.createCoinText=function(){var e=new jp(this.scene,{text:"500",fontSize:this.scene.fontSize(15),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2,letterSpacingExtra:.3});this.add(e),this.coinText=e},n.createAdsIcon=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new Kp.Z(this.scene,238/3,217/3);this.add(i);var a=this.scene.add.image(0,0,t,n.ICONS.BONUS);a.setDefaultWorldSize(),i.add(a),this.adsIcon=i},n.createTapToCollectButton=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(18)),e.text.setText("Tap to collect"),e.setName("TapToCollect"),this.add(e),this.tapToCollectButton=e,this.tapToCollectText=this.tapToCollectButton.text},t}(Phaser.GameObjects.Container);function MI(){for(var e=[],t=[10,18,27,14],n=0;n<4;n++)for(var i=0;i<t[n];i++)e.push("confetti/level-complete-screen/"+(n+1)+"_"+i);return e}var NI=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).levelCompleteContainer=void 0,s.wellDoneContainer=void 0,s.confettiEmitter=void 0,s.onClaim=void 0,s.totalClaimedCoins=void 0,s.coinsClaimed=void 0,s.isWatchAdsSuccess=void 0,s.onEntranceCompleted=function(){},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.wellDoneContainer.kill(),s.wellDoneContainer.setAlpha(0),s.wellDoneContainer.setScale(0),s.wellDoneContainer.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.handleClaim();case 2:case"end":return e.stop()}}),e)}))))},s.runAnimationCounter=function(){var e=s.countTotalCoin({startNumber:0,endNumber:s.totalClaimedCoins});return Promise.all([e])},s.handleWatchAdsClaim=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.scene.gameUI.coinBarButton.setDisabled(!0),s.scene.gameUI.starBarButton.setDisabled(!0),s.setButtonsDisable(!0),t=s.totalClaimedCoins,n=1,i=0,e.next=8,s.scene.showRewardedVideoAsync();case 8:return(a=e.sent)&&(i=t*n,s.scene.analytics.event(te._.LUCKY_REWARD,{value:n}),s.isWatchAdsSuccess=!0),s.totalClaimedCoins=t+i,e.next=13,s.handleClaim(a?0:400);case 13:case"end":return e.stop()}}),e)}))),s.handleClaim=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),!s.coinsClaimed){e.next=3;break}return e.abrupt("return");case 3:if(s.coinsClaimed=!0,s.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.BUTTON_CLICK),!(t>0)){e.next=8;break}return e.next=8,(0,le.qZ)(t);case 8:return n=s.scene.gameUI.showCoin(),i=s.scene.gameUI.showStar(),e.next=12,Promise.all([n,i]);case 12:return s.setButtonsDisable(!0),s.scene.gameUI.coinBarButton.setDisabled(!0),s.scene.gameUI.starBarButton.setDisabled(!0),e.next=17,s.claim(s.totalClaimedCoins);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.claim=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.wellDoneContainer.curveTextAnimation.playExitAnimation(),s.scene.tweens.add({targets:[s.wellDoneContainer],alpha:{value:0,duration:300},duration:400,ease:Phaser.Math.Easing.Sine.In}),s.scene.rewardManager.rewardCoin(t),n=s.isWatchAdsSuccess?gl.LEVEL_COMPLETE_AD:gl.LEVEL_COMPLETE,s.scene.logEconomy.logGetItem(fl.COIN,t,n),i=s.wellDoneContainer.getCoinImage().getWorldPosition(),a=i.x,r=i.y,o=s.wellDoneContainer.getStarImage().getWorldPosition(),h=o.x,u=o.y,e.next=9,Promise.all([s.scene.rewardManager.starAnimationPool.runAnimationRewardStarAsync(1,h,u),s.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,a,r)]);case 9:s.scene.gameUI.coinBarButton.setDisabled(!0),s.scene.gameUI.starBarButton.setDisabled(!0),s.wellDoneContainer.runExitAnimation(),s.onClaim();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.totalClaimedCoins=0,s.isWatchAdsSuccess=!1,s.setDepth(ce.Ks.POPUP),s.create(),s.background.setInteractive({useHandCursor:!0}),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.listenEvents(),s.wellDoneContainer.kill(),s.wellDoneContainer.setAlpha(0),s.wellDoneContainer.setScale(0),s}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.wellDoneContainer,t=e.adsIcon,n=e.tapToCollectButton;t.onClick=this.handleWatchAdsClaim,n.onClick=this.handleClaim},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),this.scene.gameUI.starBarButton.setDisabled(!0),this.scene.gameUI.starBarButton.setDepth(Fr.Z.PRIORITY),this.updateVictoryStats(),this.scene.gameUI.hideUI(),this.scene.gameUI.hideLife(),t.next=11,this.runEntranceAnimation();case 11:return this.confettiEmitter.run(20,0,0),t.next=14,this.levelCompleteContainer.runEntranceAnimation();case 14:return this.confettiEmitter.stop(),this.levelCompleteContainer.kill(),t.next=18,this.scene.handleShowInterstitialAd();case 18:return t.next=20,this.wellDoneContainer.runEntranceAnimation();case 20:(0,dl.Z)(this.scene,150).then((function(){i.setButtonsDisable(!1),i.runAnimationCounter()}));case 21:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.gameUI.hideStar();case 2:this.runExitAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list,n=t.levelCollectedCoin,i=void 0===n?0:n,a=t.levelClearedCoin,r=void 0===a?0:a,s=t.onClaim,o=void 0===s?function(){}:s;this.coinsClaimed=!1,this.totalClaimedCoins=i+r,this.onClaim=o,this.wellDoneContainer.setTotalCoins(0)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.countTotalCoin=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onUpdate=function(e){var t=Math.floor(e.getValue());n.wellDoneContainer.setTotalCoins(t)},e.abrupt("return",this.runCountingAnimation(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCountingAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onStart=function(){n.scene.time.addEvent({repeat:4,delay:200,callback:function(){n.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.COUNT_COINS)}})},e.abrupt("return",_b(this.scene,t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setButtonsDisable=function(e){var t=this.wellDoneContainer,n=t.adsIcon,i=t.tapToCollectButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.create=function(){this.createConfettiEmitter(),this.createLevelCompleteContainer(),this.createWellDoneContainer()},n.createConfettiEmitter=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=new Phaser.Geom.Rectangle(-t/2-187.5,-n/2-100,t+360,50),a=MI(),r=1/GameCore.ImageScale;this.confettiEmitter=new tc.Z(this.scene,{rotate:{start:-720,end:0},lifespan:{min:2500,max:3e3},speedY:{min:150,max:250},emitZone:{source:i,type:"random"},scale:{min:.8*r,max:1*r},particleBringToTop:!0,tint:void 0,frame:a}),this.add(this.confettiEmitter)},n.createLevelCompleteContainer=function(){this.levelCompleteContainer=new RI(this.scene),this.add(this.levelCompleteContainer)},n.createWellDoneContainer=function(){this.wellDoneContainer=new _I(this.scene),this.add(this.wellDoneContainer)},t}(GameCore.Screen),GI="opening",ZI="opened",FI="closing",UI="closed",WI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.curveTextAnimation=void 0,n.background=void 0,n.confettiEmitter=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.createBackground(),n.createConfettiEmitter(),n.createCurveText(),n.scene.add.existing((0,fc.Z)(n)),n.curveTextAnimation.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,s.Z)(t,e);var n=t.prototype;return n.processStep=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=FI){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.background.revive(),this.background.setInteractive(),this.setInteractive(),this.runEntranceAnimation(),this.openContainer(),this.confettiEmitter.run(20,0,0),e.abrupt("return",new Promise((function(e){t.on(UI,e)})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=GI,this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),e.next=7,this.processStep((function(){return t.runTextEntranceAnim()}));case 7:return this.state=ZI,e.next=10,this.processStep((function(){return(0,dl.Z)(t.scene,1e3)}));case 10:return this.scene.resumeMusicWithTransition(1200),e.next=13,this.processStep((function(){return t.runTextExitAnim()}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createBackground=function(){this.background=this.scene.add.image(0,0,ie.Z.OVERLAY.KEY),this.background.setName("Black Background"),this.background.setInteractive(),this.background.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.background.kill(),this.add(this.background),yp.Z.registerObject(this.background,ce.MR.MULTIPLY_ALPHA)},n.runTextEntranceAnim=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.curveTextAnimation.playEntranceAnimation(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=FI,t=this.curveTextAnimation.playExitAnimation(),n=this.runExitAnimation(1e3),e.next=5,Promise.all([t,n]);case 5:this.background.disableInteractive(),this.disableInteractive(),this.confettiEmitter.stop(),this.state=UI,this.emit(UI);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurveText=function(){var e=new Lf(this.scene,"Journey Complete!"),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-2e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(46)),t.setPosition(0,-30.5),this.add(e),this.curveTextAnimation=e},n.createConfettiEmitter=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=new Phaser.Geom.Rectangle(-t/2-187.5,-n/2-100,t+360,50),a=MI(),r=1/GameCore.ImageScale;this.confettiEmitter=new tc.Z(this.scene,{rotate:{start:-720,end:0},lifespan:{min:2500,max:3e3},speedY:{min:150,max:250},emitZone:{source:i,type:"random"},scale:{min:.8*r,max:1*r},particleBringToTop:!0,tint:void 0,frame:a}),this.add(this.confettiEmitter)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.background]},Cv.tweenConfigs.screen.configOpen)]}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.background],delay:t},Cv.tweenConfigs.screen.configClose)]}).waitForCompletion());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),HI=Wi.Z.DASHBOARD,YI=HI.KEY,KI=HI.FRAME,zI={width:99,height:47/3},VI={width:290/3,height:13},jI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.progressText=void 0,n.progressBar=void 0,n.progressFill=void 0,n.currentProgress=0,n.maxProgress=0,n.scene=t,n.setSize(99,47/3),n.createProgressBar(),n.createProgressFill(),n.createTitleText(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.currentProgress,this.maxProgress=n,0===t?(this.progressFill.kill(),this.progressFill.setAlpha(0)):this.progressFill.revive(),!i){e.next=9;break}return this.progressFill.setAlpha(0===t?0:1),this.currentProgress=t,this.progressFill.setSizeByWorld((0,ek.Z)(t,0,n,7,VI.width),this.progressFill.displayHeight),this.progressText.setText(Math.floor(t)+"/"+n),e.abrupt("return",Promise.resolve());case 9:return r=this.scene.tweens.add({targets:this.progressFill,alpha:1,duration:100}).waitForCompletion(),s=this.scene.tweens.addCounter({from:a,to:t,duration:300,onUpdate:function(e){var t=e.getValue(),i=o.progressFill.displayHeight,a=(0,ek.Z)(t,0,n,7,VI.width);o.progressFill.setSizeByWorld(a,i),o.progressText.setText(Math.floor(t)+"/"+n),o.currentProgress=t}}).waitForCompletion(),e.next=13,Promise.all([r,s]);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.isProgressComplete=function(){return this.currentProgress>=this.maxProgress},n.createProgressBar=function(){var e=this.scene.make.nineslice({key:YI,frame:KI.DECOR.PROGRESS.BAR,leftWidth:20,rightWidth:20,width:zI.width,height:zI.height});this.add(e),this.progressBar=e,this.setSize(e.displayWidth,e.displayHeight)},n.createProgressFill=function(){var e=this.scene.make.nineslice({key:YI,frame:KI.DECOR.PROGRESS.FILL,leftWidth:7,rightWidth:7,width:VI.width,height:VI.height});e.setOrigin(0,.5),this.add(e);var t=(this.progressBar.displayWidth-e.displayWidth)/2;e.setX(-this.progressBar.displayWidth/2+t),this.progressFill=e},n.createTitleText=function(){var e=new jp(this.scene,{text:"3/15",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.add(e),this.progressText=e},t}(Phaser.GameObjects.Container),XI=jI,qI=Wi.Z.DASHBOARD,JI=qI.KEY,QI=qI.FRAME,$I={width:373/3,height:137/3},eO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.text=void 0,n.locationProgressBar=void 0,n.scene=t,n.setSize(373/3,137/3),n.createLocationProgressBorder(),n.createText(),n.createLocationProgressBar(),n.alignItems(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateProgress=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.journey.getInProgressLocation();case 2:return n=e.sent,i=n.progress,a=void 0===i?0:i,r=n.decorations,e.next=6,this.locationProgressBar.updateProgress(a,3*r.length,t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.text,this,0,-7),Phaser.Display.Align.In.BottomCenter(this.locationProgressBar,this,0,-10)},n.createLocationProgressBorder=function(){var e=this.scene.make.nineslice({key:JI,frame:QI.DECOR.PROGRESS_BORDER,leftWidth:20,rightWidth:20,width:$I.width,height:$I.height});this.add(e),this.setSize(e.displayWidth,e.displayHeight)},n.isProgressCompleted=function(){return this.locationProgressBar.isProgressComplete()},n.createText=function(){var e=new jp(this.scene,{text:"Location Progress",fontSize:this.scene.fontSize(11),fillColor:11102533});this.add(e),this.text=e},n.createLocationProgressBar=function(){var e=new XI(this.scene);this.add(e),this.locationProgressBar=e},t}(Phaser.GameObjects.Container),tO=eO,nO=Wi.Z.EFFECTS,iO=nO.KEY,aO=nO.FRAME,rO=function(e){function t(t){var n;return(n=e.call(this,t,iO,aO.FX_COMET)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:aO.FX_COMET,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},speed:{min:100,max:200},scale:{start:.7*e,end:.4*e},lifespan:{min:300,max:1e3}})},n.explode=function(e,t,n){this.revive(),this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),sO=rO;function oO(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return cO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cO(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var hO=Wi.Z.DASHBOARD,uO=hO.KEY,lO=hO.FRAME,dO=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.isGuided=void 0,n.isOpening=void 0,n.decorationSlots=void 0,n.closeButton=void 0,n.titleLocation=void 0,n.nextButton=void 0,n.locationProgressTracker=void 0,n.starsExplosive=void 0,n.blackBackground=void 0,n.circleVfx=void 0,n.currentBg=void 0,n.nextBg=void 0,n.circleShape=void 0,n.journeyCompleteContainer=void 0,n.gameObjectsSorted=[],n.isJourneyCompletePlaying=void 0,n.clearDecorBtn=void 0,n.resetDefaultBtn=void 0,n.handleCloseButtonOnClick=(0,r.Z)(c().mark((function e(){var t,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.runExitLocationContentsAnimation();case 2:n.isOpening=!1,t=n.scene.screen.get(ce.o4.DASHBOARD_SCREEN),i=n.isGuided,t.handleCloseDecorationScreenCompleted(i);case 6:case"end":return e.stop()}}),e)}))),n.handleNextButtonOnClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.scene.journey.getNextStage()){e.next=3;break}return n.scene.screen.open(ce.o4.NEXT_JOURNEY_SCREEN),e.abrupt("return");case 3:return n.sortLocationGameObjects(),n.runNextButtonExitAnimation(),e.next=7,n.runExitLocationContentsAnimation();case 7:return n.runBackgroundChangeAnimation(),n.scene.journey.updateToNextLocation(),n.scene.setBackgroundWithFadeAnimation(),n.runStarExplosiveEffect(),e.next=13,(0,le.qZ)(2e3).then((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.updateData();case 2:return n.decorationSlots.forEach((function(e){n.moveBelow(n.nextBg,e)})),n.currentBg.kill(),n.nextBg.kill(),e.next=7,n.runEntranceLocationContentsAnimation();case 7:case"end":return e.stop()}}),e)}))));case 13:case"end":return e.stop()}}),e)}))),n.handleDecorationUpgradeButtonOnClick=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.BUTTON_CLICK),!t.spineClicked){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.updateData();case 5:t.handleDecorationUpgradeButtonOnClick();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDecorationUpgraded=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),e.next=3,n.updateProgress(t);case 3:n.isLocationProgressCompleted()&&n.handleLocationProgressComplete();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDecorationUpgrade=function(){n.scene.journey.isCurrentLocationCompleted()&&(n.setButtonDisabled(!0),n.scene.gameUI.setDisableButtons(!0))},n.handleClearDecorationsButtonOnClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(300);case 2:n.scene.journey.clearDecorationData(),n.runNextButtonExitAnimation(),n.decorationSlots.map((function(e){e.resetDecoration()})),n.handleCloseButtonOnClick();case 6:case"end":return e.stop()}}),e)}))),n.handleResetJourneyProgressToDefault=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(300);case 2:n.scene.journey.resetJourneyProgressToDefault(),n.runNextButtonExitAnimation(),n.decorationSlots.map((function(e){e.resetDecoration()})),n.handleCloseButtonOnClick();case 6:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.preloadCurrentBackgroundAsync(),n.create(),n.hideAllContents(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n.updateCurrentBg(),n.createDebugButtons(),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.closeButton.onClick=this.handleCloseButtonOnClick,this.nextButton.onClick=this.handleNextButtonOnClick,this.decorationSlots.map((function(t){t.upgradeButton.onClick=e.handleDecorationUpgradeButtonOnClick.bind(e,t)})),this.scene.journey.events.on(hi.DECORATION_UPGRADE,this.handleDecorationUpgrade,this),this.scene.journey.events.on(hi.DECORATION_UPGRADED,this.handleDecorationUpgraded,this)},n.runFadeBackground=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.blackBackground.revive(),void 0!==t&&this.blackBackground.setAlpha(t),e.next=4,this.scene.tweens.add({targets:this.blackBackground,alpha:n,duration:i,delay:a}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.highlightDecorationSlots=function(){var e=this;this.bringToTop(this.blackBackground),this.decorationSlots.map((function(t){0===t.buildingData.level&&e.bringToTop(t)}))},n.hasBuiltDecoration=function(){return this.scene.player.getJourneyProgress().finishedLocationIds.length>0||this.decorationSlots.some((function(e){return e.buildingData.level>0}))},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sortLocationGameObjects(),e.next=3,this.updateData();case 3:if(!this.isOpening){e.next=5;break}return e.abrupt("return");case 5:return this.isOpening=!0,this.isJourneyCompletePlaying=!1,this.setAlpha(1),t=[],this.isLocationProgressCompleted()&&t.push(this.runNextButtonEntranceAnimation()),t.push(this.runEntranceLocationContentsAnimation()),e.next=13,Promise.all(t);case 13:this.scene.events.emit(hi.OPENED_LOCATION_DECORATION);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateCurrentBg(),t=this.scene.journey.getInProgressLocation(),n=t.id,i=t.name,a=parseInt(n)+1,this.titleLocation.updateTitle(a,i),r=this.scene.journey.getCurrentDecorationLocationConfigs(),s=t.decorations,o=r.decorationKey,h=r.decorationConfigs,this.decorationSlots.map((function(e,t){var n=s.find((function(e){return e.id===t.toString()})),i=h.find((function(e){return e.id===t.toString()}));i&&n&&e.updateData(o,i,n.level)})),this.updateProgress(!0);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getGuidedSlot=function(){for(var e,t=[],n=[],i=this.scene.gameZone.height,a=oO(this.decorationSlots);!(e=a()).done;){var r=e.value;0===r.buildingData.level&&n.push(r)}for(var s=0,o=n;s<o.length;s++){var c=o[s];c.y<i/2-70&&t.push(c)}return 0===t.length?null:t.reduce((function(e,t){return e.buildingData.level<t.buildingData.level?e:t}))},n.getUnlockableSlots=function(){for(var e,t=[],n=oO(this.decorationSlots);!(e=n()).done;){var i=e.value;i.getCurrentCost()<=this.scene.player.getStar()&&t.push(i)}return t},n.runBackgroundChangeAnimation=function(){var e=this;this.currentBg.revive(),this.decorationSlots.forEach((function(t){e.moveAbove(e.nextBg,t)})),this.updateNextBg(),this.runCircleVFXShowAnimation(),this.nextBg.setAlpha(1),this.scene.tweens.add({targets:this.circleShape,scale:{from:0,start:0,to:1},duration:500,onUpdate:function(t){var n=t.getValue(),i=(0,ek.Z)(n,0,1,0,e.scene.gameZone.width/2),a=(0,ek.Z)(n,0,1,0,e.nextBg.height/2);e.circleShape.setX(e.scene.gameZone.width/2-i),e.circleShape.setY(e.nextBg.height/2-a)}}).waitForCompletion().then((function(){e.decorationSlots.map((function(e){e.resetDecoration()}))}))},n.runCircleVFXShowAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=this.scene.gameplay.spineManager,this.circleVfx.animationState.timeScale=.833,e.next=5,(0,le.qZ)(t);case 5:return e.next=7,n.playAnimation(this.circleVfx,Yu.CIRCLE_VFX.SHOW);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runJourneyCompleteAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isJourneyCompletePlaying){e.next=2;break}return e.abrupt("return");case 2:return this.isJourneyCompletePlaying=!0,this.sortLocationGameObjects(),this.journeyCompleteContainer.revive(),e.next=7,(0,dl.Z)(this.scene,100);case 7:return this.scene.gameUI.hideUI(),e.next=10,this.runExitUIAnimation();case 10:return this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.LEVEL_COMPLETED),e.next=13,this.journeyCompleteContainer.open();case 13:return this.scene.gameUI.setDisableButtons(!1),this.scene.gameUI.showCoin(),this.scene.gameUI.showStar(),e.next=18,this.runEntranceUIAnimation();case 18:this.isJourneyCompletePlaying=!1;case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitUIAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationExitAnimation(),n=this.runCloseButtonExitAnimation(),i=this.runLocationProgressTrackerExitAnimation(),a=this.runNextButtonExitAnimation(),e.next=7,Promise.all([t,n,i,a]);case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceUIAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationEntranceAnimation(),n=this.runCloseButtonEntranceAnimation(),i=this.runLocationProgressTrackerEntranceAnimation(),a=this.runNextButtonEntranceAnimation(),e.next=7,Promise.all([t,n,i,a]);case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleLocationProgressComplete=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOpening){e.next=2;break}return e.abrupt("return");case 2:return this.setButtonDisabled(!0),this.scene.pauseMusicWithTransition(300),this.scene.requireSpineAsync("CIRCLE_VFX_SPINE"),e.next=7,this.runJourneyCompleteAnimation();case 7:this.setButtonDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateProgress=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationProgressTracker.updateProgress(t);case 2:n=this.scene.player.getJourneyProgress(),(i=n.inProgressLocation)&&i.progress>=2*i.decorations.length&&this.preloadNextBackgroundAsync();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.isLocationProgressCompleted=function(){return this.locationProgressTracker.isProgressCompleted()&&this.scene.journey.isCurrentLocationCompleted()},n.setButtonDisabled=function(e){this.closeButton.setDisabled(e),this.nextButton.setDisabled(e),this.decorationSlots.map((function(t){t.upgradeButton.setDisabled(e)})),this.closeButton.setAlpha(1),this.nextButton.setAlpha(1),this.decorationSlots.map((function(e){e.upgradeButton.setAlpha(1)}))},n.runEntranceLocationContentsAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationEntranceAnimation(),n=this.runCloseButtonEntranceAnimation(),i=this.runLocationProgressTrackerEntranceAnimation(),a=this.decorationSlots.map((function(e){return e.open()})),e.next=7,Promise.all([t,n,i].concat(a));case 7:this.setButtonDisabled(!1),this.scene.devToolManager.isShowDebugButtons?this.showDebugButtons():this.hideDebugButtons();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitLocationContentsAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonDisabled(!0),t=this.runTitleLocationExitAnimation(),n=this.runCloseButtonExitAnimation(),i=this.runLocationProgressTrackerExitAnimation(),a=this.decorationSlots.map((function(e){return e.close()})),r=this.runNextButtonExitAnimation(),e.next=8,Promise.all([t,n,i].concat(a,[r]));case 8:this.setButtonDisabled(!1),this.hideDebugButtons();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runStarExplosiveEffect=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.starsExplosive.explode(100,0,0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleLocationEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimation({targets:this.titleLocation});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTitleLocationExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.titleLocation});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseButtonEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.closeButton.revive(),e.next=3,this.runEntranceAnimation({targets:this.closeButton});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseButtonExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.closeButton,onComplete:function(){t.closeButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runNextButtonEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextButton.revive(),e.next=3,this.runEntranceAnimation({targets:this.nextButton});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runNextButtonExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.nextButton,onComplete:function(){t.nextButton.kill()}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLocationProgressTrackerEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimation({targets:this.locationProgressTracker});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLocationProgressTrackerExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation({targets:this.locationProgressTracker});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,a.Z)({alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:1,ease:Phaser.Math.Easing.Back.Out},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add((0,a.Z)({alpha:{from:1,start:1,to:0},scale:{from:1,start:1,to:0,ease:Phaser.Math.Easing.Back.In},duration:300},t)).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.titleLocation.setAlpha(0),this.locationProgressTracker.setAlpha(0),this.closeButton.kill(),this.nextButton.kill(),this.decorationSlots.map((function(e){e.upgradeButton.kill(),e.hideDecoration()})),this.hideDebugButtons()},n.updateCurrentBg=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.journey.getCurrentStage(),n=t.backgroundKey,this.scene.textures.exists(n)){e.next=7;break}return this.currentBg.kill(),e.next=5,this.preloadCurrentBackgroundAsync();case 5:return this.updateCurrentBg(),e.abrupt("return");case 7:this.currentBg.setTexture(n),i=this.scene.gameZone.height,a=i*(this.currentBg.frame.width/this.currentBg.frame.height),this.currentBg.setWorldSize(a,i);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateNextBg=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.journey.getNextStage()){e.next=3;break}return e.abrupt("return");case 3:if(n=t.backgroundKey,this.scene.textures.exists(n)){e.next=10;break}return this.nextBg.kill(),e.next=8,this.preloadNextBackgroundAsync();case 8:return this.updateNextBg(),e.abrupt("return");case 10:this.nextBg.setTexture(n),i=this.scene.gameZone.height,a=i*(this.nextBg.frame.width/this.nextBg.frame.height),this.nextBg.setWorldSize(a,i),this.nextBg.revive(),this.nextBg.setAlpha(0),this.createNextBgCircleMask(),this.circleShape.setScale(0);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadCurrentBackgroundAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=t.scene.journey.getCurrentStage();t.scene.load.image(n.backgroundKey,n.backgroundFile),t.scene.load.start(),t.scene.load.once("filecomplete-image-"+n.backgroundKey,(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.preloadNextBackgroundAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.preloadNextBackgroundAsync();var n=t.scene.journey.getNextStage();if(!n)return e();t.scene.load.image(n.backgroundKey,n.backgroundFile),t.scene.load.start(),t.scene.load.once("filecomplete-image-"+n.backgroundKey,(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.sortLocationGameObjects=function(){var e=this;this.gameObjectsSorted.forEach((function(t){e.bringToTop(t)})),this.resetDefaultBtn&&this.bringToTop(this.resetDefaultBtn),this.clearDecorBtn&&this.bringToTop(this.clearDecorBtn)},n.create=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.createCurrentBackground(),this.createCircleShape(),this.createDecorationSlotManager(),this.createNextBackground(),this.createButtons(),this.createTitleLocation(),this.createLocationProgressTracker(),this.createStarsExplosive(),this.createBlackBackground(),this.createJourneyCompleteContainer(),this.createChangeVFXSpine();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createCurrentBackground=function(){this.currentBg=this.scene.add.image(0,0,uO,lO.BLANK),this.currentBg.setName("CurrentBackground"),this.currentBg.setOrigin(.5,.5),this.currentBg.setWorldSize(0,0),this.add(this.currentBg),this.currentBg.kill()},n.createCircleShape=function(){this.circleShape=this.scene.make.graphics({fillStyle:{color:16777215,alpha:1},visible:!0})},n.createDecorationSlotManager=function(){var e=this;this.decorationSlots=new Array(5).fill(null).map((function(t,n){var i=new xI(e.scene);return i.setName("DecorationSlot-"+n),e.add(i),i}))},n.createNextBackground=function(){this.nextBg=this.scene.add.image(0,0,uO,lO.BLANK),this.nextBg.setName("NextBackground"),this.nextBg.setOrigin(.5,.5),this.nextBg.setWorldSize(0,0),this.add(this.nextBg),this.nextBg.kill()},n.createButtons=function(){this.createCloseButton(),this.createNextLocationButton()},n.createCloseButton=function(){this.closeButton=new Hc.Z(this.scene,uO,lO.BUTTON.BACK,43,131/3),this.closeButton.setName("CloseJourney"),this.add(this.closeButton),Phaser.Display.Align.In.BottomLeft(this.closeButton,this,-5,-5)},n.createNextLocationButton=function(){this.nextButton=new mI(this.scene),this.add(this.nextButton),this.nextButton.kill(),Phaser.Display.Align.In.BottomRight(this.nextButton,this,-5,-7)},n.createTitleLocation=function(){this.titleLocation=new uI(this.scene),this.titleLocation.setName("TitleLocation"),this.add(this.titleLocation),Phaser.Display.Align.In.TopCenter(this.titleLocation,this,0,-10)},n.createLocationProgressTracker=function(){this.locationProgressTracker=new tO(this.scene),this.locationProgressTracker.setName("LocationProgressTracker"),this.add(this.locationProgressTracker),Phaser.Display.Align.In.BottomCenter(this.locationProgressTracker,this,0,-7)},n.createStarsExplosive=function(){this.starsExplosive=new sO(this.scene),this.starsExplosive.setName("StarsExplosive"),this.add(this.starsExplosive)},n.createBlackBackground=function(){this.blackBackground=this.scene.add.image(0,0,ie.Z.OVERLAY.KEY),this.blackBackground.setName("BlackBackground"),this.blackBackground.setInteractive(),this.blackBackground.setWorldSize(this.scene.gameZone.width,this.scene.gameZone.height),this.blackBackground.kill(),this.add(this.blackBackground),Phaser.Display.Align.In.Center(this.blackBackground,this),yp.Z.registerObject(this.blackBackground,ce.MR.MULTIPLY_ALPHA)},n.createChangeVFXSpine=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.requireSpineAsync("CIRCLE_VFX_SPINE");case 2:(t=this.scene.add.spine(0,0,Wi.Z.CIRCLE_VFX_SPINE.DATA_KEY,Wi.Z.CIRCLE_VFX_SPINE.ATLAS_KEY)).setName("CircleVFX"),n=1/GameCore.ImageScale,t.setScale(n),this.add(t),t.setPosition(-50.75073/GameCore.ImageScale,-33.92575/GameCore.ImageScale),this.circleVfx=t,this.gameObjectsSorted=[this.currentBg].concat(this.decorationSlots,[this.nextBg,this.closeButton,this.nextButton,this.titleLocation,this.locationProgressTracker,this.starsExplosive,this.blackBackground,this.journeyCompleteContainer,this.circleVfx]);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createJourneyCompleteContainer=function(){var e=new WI(this.scene);e.setName("JourneyCompleteContainer"),this.add(e),this.journeyCompleteContainer=e,this.journeyCompleteContainer.kill()},n.createNextBgCircleMask=function(){this.circleShape.fillCircle(this.scene.gameZone.width/2,this.nextBg.height/2,this.nextBg.width/1.5);var e=this.circleShape.createGeometryMask();this.nextBg.setMask(e)},n.createDebugButtons=function(){this.createClearDecorationsButton(),this.createResetJourneyProgressToDefaultButton(),this.clearDecorBtn.onClick=this.handleClearDecorationsButtonOnClick,this.resetDefaultBtn.onClick=this.handleResetJourneyProgressToDefault,this.hideDebugButtons()},n.createResetJourneyProgressToDefaultButton=function(){this.resetDefaultBtn=new Kp.Z(this.scene,30,30);var e=this.scene.add.image(0,0,uO,lO.BLANK);e.setWorldSize(30,30);var t=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"reset\ndefault",origin:{x:.5,y:.5}});this.resetDefaultBtn.add([e,t]),this.resetDefaultBtn.setName("ResetJourneyProgressToDefault"),this.add(this.resetDefaultBtn),Phaser.Display.Align.In.BottomLeft(this.resetDefaultBtn,this,-75,-7)},n.createClearDecorationsButton=function(){this.clearDecorBtn=new Kp.Z(this.scene,30,30);var e=this.scene.add.image(0,0,uO,lO.BLANK);e.setWorldSize(30,30);var t=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(12),text:"clear\ndata",origin:{x:.5,y:.5}});this.clearDecorBtn.add([e,t]),this.clearDecorBtn.setName("ClearDecorations"),this.add(this.clearDecorBtn),Phaser.Display.Align.In.BottomLeft(this.clearDecorBtn,this,-115,-7)},n.showDebugButtons=function(){this.clearDecorBtn.revive(),this.resetDefaultBtn.revive()},n.hideDebugButtons=function(){this.clearDecorBtn&&this.clearDecorBtn.kill(),this.resetDefaultBtn&&this.resetDefaultBtn.kill()},t}(Phaser.GameObjects.Container),pO=dO,fO=Wi.Z.DEFAULT,mO=fO.KEY,gO=fO.FRAME,vO=Wi.Z.DASHBOARD,yO=vO.KEY,EO=vO.FRAME,CO=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.titleText=void 0,i.descriptionText=void 0,i.parentScreen=void 0,i.arrow=void 0,i.step1=void 0,i.step2=void 0,i.tapToContinueButton=void 0,i.playButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i.listenEvents(),i}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.tapToContinueButton.onClick=function(){e.parentScreen.handleGetMoreStarsContainerClose()},this.playButton.onClick=function(){e.setButtonsDisabled(!0),e.scene.screen.close(ce.o4.GET_MORE_STARS_SCREEN),e.scene.events.emit(hi.OPEN_PLAY_SCREEN_FROM_DASHBOARD)}},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.titleText,this,0,-24),Phaser.Display.Align.In.TopCenter(this.descriptionText,this,0,-74),Phaser.Display.Align.In.Center(this.step1,this,-98,58),Phaser.Display.Align.In.Center(this.step2,this,104.5,50),Phaser.Display.Align.In.Center(this.arrow,this,1,-8),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,-60)},n.create=function(){this.createTitle(),this.createDescription(),this.createTutorialSteps(),this.createArrows(),this.createContinueButton(),this.createPlayButton()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),this.setButtonsDisabled(!0),e.next=5,this.runEntranceAnimation(100);case 5:this.setButtonsDisabled(!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.tapToContinueButton.setDisabled(e)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.runDescriptionEntranceAnimation(200,500),a=this.step1.runEntranceAnimation(200,500),r=this.runArrowEntranceAnimation(this.arrow,400,500),s=this.step2.runEntranceAnimation(600,500),o=this.runPlayButtonEntranceAnimation(800,500),e.next=10,Promise.all([n,i,a,r,s,o]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.titleText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.titleText.setScale(0),i.titleText.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runDescriptionEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.descriptionText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.descriptionText.setScale(0),i.descriptionText.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runPlayButtonEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.playButton,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.playButton.setScale(0),i.playButton.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.titleText.setAlpha(0),this.descriptionText.setAlpha(0),this.step1.kill(),this.step2.kill(),this.arrow.setAlpha(0),this.playButton.setAlpha(0)},n.close=function(){this.setButtonsDisabled(!0)},n.createTitle=function(){this.titleText=new Pf(this.scene),this.titleText.setText(this.scene.lang.Text.getMoreStars),this.titleText.setFontSize(40),this.titleText.setRadius(-1138),this.titleText.setLetterSpacing(.05),this.titleText.setOrigin(.5,.5),this.add(this.titleText)},n.createDescription=function(){var e=new Pf(this.scene);e.setText(this.scene.lang.Text.earnStar),e.setFontSize(15),e.setRadius(-1468),e.setLetterSpacing(0),e.setFonts(Pc.ZP.WHITE_SHADOW.KEY),this.add(e),this.descriptionText=e},n.createTutorialSteps=function(){var e=this,t=[gO.GET_MORE_STARS.LEVEL_ICON,gO.GET_MORE_STARS.STARS_ICON],n=Array.from({length:2},(function(n,i){return new mT(e.scene,mO,t[i],"")}));this.add([].concat(n)),this.step1=n[0],this.step2=n[1]},n.createArrows=function(){var e=this.scene.add.image(0,0,mO,gO.GET_MORE_STARS.ARROW_ICON);e.setDefaultWorldSize(),this.add(e),this.arrow=e},n.createPlayButton=function(){var e=new iy(this.scene,{key:yO,buttonFrame:EO.BUTTON.BUTTON.NEW_GREEN_SHADOW,buttonWidth:117,buttonHeight:124/3,buttonInnerWidth:117}),t=new jp(this.scene,{text:"Play",fontSize:this.scene.fontSize(17),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});t.setText("Play"),t.setY(-1),e.addIntoButton(t),this.add(e),this.playButton=e,this.playButton.button.setName("PlayButton")},n.createContinueButton=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText(""),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e},t}(Phaser.GameObjects.Container),AO=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).getMoreStarsContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(1),r.getMoreStarsContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createGetMoreStarsContainer()},n.handleGetMoreStarsContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getMoreStarsContainer.close(),this.scene.screen.close(this.name);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createGetMoreStarsContainer=function(){this.getMoreStarsContainer=new CO(this.scene,this),this.getMoreStarsContainer.setInteractive({useHandCursor:!0}),this.add(this.getMoreStarsContainer),Phaser.Display.Align.In.Center(this.getMoreStarsContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.scene.events.emit(hi.HIDE_GUIDE),this.runEntranceAnimation(),t.next=5,this.getMoreStarsContainer.open();case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),wO=Wi.Z.JOURNEY,SO=wO.KEY,bO=wO.FRAME,TO=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.progressBar=void 0,a.progressBarBackground=void 0,a.progressBarFill=void 0,a.progressBarText=void 0,a.scene=t,a.create(),a.setSize(n,a.progressBar.height),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setProgressBarFill(0,15)},n.setProgressBarFill=function(e,t){if(this.progressBarText.setText(Math.floor(e)+"/"+t),0!==e){this.progressBarFill.revive();var n=this.progressBarFill.displayHeight,i=(0,ek.Z)(e,0,t,20,407/3);this.progressBarFill.setSizeByWorld(i,n)}else this.progressBarFill.kill()},n.create=function(){var e=this.scene.add.container(0,0);this.progressBarBackground=this.createProgressBarBackground(),this.progressBarFill=this.createProgressBarFill(),this.progressBarText=this.createProgressText(),e.add([this.progressBarBackground,this.progressBarFill,this.progressBarText]),this.add(e),this.progressBar=e},n.createProgressBarBackground=function(){return this.scene.make.nineslice({key:SO,frame:bO.MAP_BLOCK.PROGRESS_BAR.BORDER,width:409/3,height:18,leftWidth:10,rightWidth:10})},n.createProgressBarFill=function(){var e=this.scene.make.nineslice({key:SO,frame:bO.MAP_BLOCK.PROGRESS_BAR.GREEN_PROGRESS,width:407/3,height:25,leftWidth:10,rightWidth:10});e.setOrigin(0,.5);var t=(this.progressBarBackground.displayWidth-e.displayWidth)/2;return e.setX(-this.progressBarBackground.displayWidth/2+t),e},n.createProgressText=function(){return new jp(this.scene,{text:"1/10",fontSize:this.scene.fontSize(13),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2})},t}(Phaser.GameObjects.Container),xO=TO,PO=Wi.Z.JOURNEY,kO=PO.KEY,IO=PO.FRAME,OO=5.5,RO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.lockTop=void 0,n.lockBody=void 0,n.scene=t,n.create(),n.setSize(n.lockBody.width,n.lockTop.height+n.lockBody.height-OO),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this.scene.add.image(0,0,kO,IO.MAP_BLOCK.ICON_LOCK.TOP);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,kO,IO.MAP_BLOCK.ICON_LOCK.BODY);t.setDefaultWorldSize(),this.add(e),this.add(t),e.setPosition(0,-5.5),t.setPosition(0,OO),this.lockTop=e,this.lockBody=t},n.reset=function(){this.lockTop.setVisible(!0),this.lockBody.setVisible(!0),this.lockTop.setPosition(0,-5.5),this.lockBody.setPosition(0,OO),this.lockTop.setAlpha(1),this.lockBody.setAlpha(1),this.lockTop.setRotation(0),this.lockBody.setRotation(0),this.lockTop.setDefaultWorldSize(),this.lockBody.setDefaultWorldSize()},t}(Phaser.GameObjects.Container);function BO(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return DO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DO(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function DO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var LO=Wi.Z.JOURNEY,_O=LO.KEY,MO=LO.FRAME,NO=376/3,GO=335/3,ZO=1.13,FO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.shadow=void 0,n.background=void 0,n.overlay=void 0,n.thumbnail=void 0,n.mapName=void 0,n.progressBar=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.status=void 0,n.thumbnailKey=void 0,n.cardShines=void 0,n.multiplyLabelShine=void 0,n.additiveLabelShine=void 0,n.lock=void 0,n.lockGlow=void 0,n.lockAdd=void 0,n.checkMark=void 0,n.unlockMapAnimation=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.setMapActive(e===ER.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.setMapActive(t===ER.InProgress);var n=e.progressBar,i=n.currentProgress,a=n.maxProgress;this.progressBar.setProgressBarFill(i,a)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===ER.Lock&&t===ER.InProgress,i=e===ER.InProgress&&t===ER.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(a=t===ER.Lock&&n===ER.InProgress,r=t===ER.InProgress&&n===ER.Finished,!a){e.next=11;break}return this.updateVisibility(ER.Lock),this.setMapActive(!1),e.next=10,this.playUnlockMapAnimation(i);case 10:return e.abrupt("return");case 11:if(!r){e.next=16;break}return this.updateVisibility(ER.InProgress),this.setMapActive(!0),e.next=16,this.playFinishedMapAnimation(i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===ER.Lock),this.checkMark.setVisible(e===ER.Finished),this.progressBar.setVisible(e===ER.InProgress),this.overlay.setAlpha(e===ER.Lock?.5:0)},n.setMapActive=function(e){void 0===e&&(e=!0)},n.updateMapName=function(e){this.mapName.setText(e)},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function a(){i.showLoading(!0);var r="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(NO,GO),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(r,a),i.previousEventName=r}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.shadow.setY(2),this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+6),this.loading.setY(this.thumbnail.y),this.mapName.setY(this.thumbnail.y+this.thumbnail.height/2+14),this.progressBar.setY(68),this.lockGlow.setPosition(this.progressBar.x,this.progressBar.y+5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=c().mark((function e(){var i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=r.cardShines[a]).revive(),i.setAlpha(0),s=r.scene.tweens.add({targets:i,alpha:.08,delay:t+150*a,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(s);case 5:case"end":return e.stop()}}),e)})),a=0;case 5:if(!(a<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:a++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playLabelShineAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.multiplyLabelShine.revive(),this.additiveLabelShine.revive(),this.multiplyLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),this.additiveLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),n=800,this.multiplyLabelShine.setAlpha(0),this.additiveLabelShine.setAlpha(0),this.multiplyLabelShine.setScale(1.5,.4),this.additiveLabelShine.setScale(1.5,.4),e.next=12,Promise.all([this.scene.tweens.add({targets:this.additiveLabelShine,alpha:.5,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.multiplyLabelShine,alpha:1,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],x:this.mapName.x+this.mapName.width/2,delay:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],scaleX:2,yoyo:!0,delay:t,duration:400,ease:Phaser.Math.Easing.Cubic.InOut}).waitForCompletion()]);case 12:this.multiplyLabelShine.kill(),this.additiveLabelShine.kill();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(ER.InProgress),this.offsetOriginWrapper.setScale(ZO),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,dl.Z)(this.scene,t+850).then((function(){i.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS)})),e.next=11,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.playCardShineAnimation(t+400)]);case 11:this.alignItems(),this.setMapActive(!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.lockAdd.revive(),this.lockGlow.revive(),this.progressBar.revive(),this.unlockMapAnimation.setDelay(t),this.overlay.setAlpha(.5),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),this.unlockMapAnimation.events.on("startDelay",(function(){(0,dl.Z)(n.scene,550).then((function(){n.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.TWIST_LOCK)}))})),e.next=12,Promise.all([this.unlockMapAnimation.start(),this.playCardShineAnimation(t+1700),this.playLabelShineAnimation(t+1200),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:(1-ZO)*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.overlay,alpha:0,delay:t+1100,duration:180}).waitForCompletion()]);case 12:this.lock.kill(),this.lockAdd.kill(),this.lockGlow.kill(),this.lock.reset(),this.lockAdd.reset(),this.lock.setScale(1),this.lockAdd.setScale(1),this.alignItems(),this.setMapActive(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createShadow(),this.createBackground(),this.createThumbnail(),this.createMapName(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createOverlay(),this.createCardShines(),this.createLabelShine(),this.createLockShines(),this.createUnlockMapAnimation()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createShadow=function(){var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.BACKGROUND_SHADOW);e.setDefaultWorldSize(),this.wrapper.add(e),this.shadow=e},n.createBackground=function(){var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),e.setTint(5450259),e.setAlpha(0),this.wrapper.add(e),this.overlay=e},n.createCardShines=function(){for(var e,t=[],n=BO(MO.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,a=this.scene.add.image(0,0,_O,i);a.setDefaultWorldSize(),a.setBlendMode(Phaser.BlendModes.ADD),a.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),a.kill(),this.wrapper.add(a),t.push(a)}var r=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.CARD_SHINES[0]);r.setDefaultWorldSize(),r.setScale(t[0].scaleX,t[0].scaleY),r.setBlendMode(Phaser.BlendModes.ADD),r.setPosition(-t[0].displayWidth/2+r.displayWidth/2,t[0].displayHeight/2-r.displayHeight/2),this.wrapper.add(r);var s=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.CARD_SHINES[MO.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[r].concat(t,[s]),r.kill(),s.kill()},n.createLabelShine=function(){var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.LABEL_SHINE);e.setDefaultWorldSize(),e.setScale(0,.4),e.setBlendMode(Phaser.BlendModes.MULTIPLY),e.setTint(13332544),e.setAlpha(1),e.kill(),this.wrapper.add(e),this.multiplyLabelShine=e;var t=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.LABEL_SHINE);t.setDefaultWorldSize(),t.setScale(0,.4),t.setBlendMode(Phaser.BlendModes.ADD),t.setAlpha(.3),t.kill(),this.wrapper.add(t),this.additiveLabelShine=t},n.createLockShines=function(){var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.LOCK_SHINE);e.setDefaultWorldSize(),e.setBlendMode(Phaser.BlendModes.ADD),e.setAlpha(1),e.setScale(3/9),e.kill(),this.wrapper.add(e),this.lockGlow=e;var t=new RO(this.scene);this.wrapper.add(t),t.setPosition(0,68),t.kill(),this.lockAdd=t},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(NO,GO);var e=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.THUMBNAIL_BACKGROUND);e.setWorldSize(NO,GO),this.thumbnail.add(e);var t=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.THUMBNAIL);t.setDefaultWorldSize(),this.thumbnail.add(t);var n=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.THUMBNAIL_FOREGROUND);n.setDefaultWorldSize(),this.thumbnail.add(n),this.thumbnailFrame=t},n.createMapName=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.HEADER.KEY,size:this.scene.fontSize(16),text:"Triple Cut",origin:{x:.5,y:.5}});this.wrapper.add(e),this.mapName=e},n.createProgressBar=function(){this.progressBar=new xO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createLock=function(){this.lock=new RO(this.scene),this.wrapper.add(this.lock),this.lock.setPosition(0,68),this.lock.kill()},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,_O,MO.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(68),this.checkMark.kill()},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},n.createUnlockMapAnimation=function(){this.unlockMapAnimation=new Hw([{target:this.offsetOriginWrapper,rotate:[{time:.55,curve:[.583,0,.617,2.62]},{time:.65,value:2.62,curve:[.667,2.62,.683,-2.63]},{time:.7,value:-2.63,curve:[.728,-2.63,.756,4.48]},{time:.7833,value:4.48,curve:[.806,4.48,.828,-3.45]},{time:.85,value:-3.45,curve:[.878,-3.45,.906,3.84]},{time:.9333,value:3.84,curve:[.961,3.84,.989,1.28]},{time:1.0167}],scale:[{time:.1833,curve:[.191,.993,.228,.95,.191,.993,.228,.95]},{time:.25,x:.95,y:.95,curve:[.337,.95,.46,1.157,.337,.95,.46,1.157]},{time:.55,x:1.16,y:1.16,curve:[.728,1.166,.685,.969,.728,1.166,.685,.969]},{time:.7833,x:.942,y:.942,curve:[1.064,.866,.994,1.185,1.064,.866,.994,1.185]},{time:1.1833,x:1.18,y:1.18,curve:[1.279,1.178,1.359,1.114,1.279,1.178,1.359,1.114]},{time:1.45,x:1.11,y:1.11,curve:[1.523,1.107,1.645,1.125,1.523,1.107,1.645,1.125]},{time:1.6667,x:ZO,y:ZO}]},{target:[this.lock,this.lockAdd],scale:[{time:.1667,curve:[.194,1,.222,1.1,.194,1,.222,1.1]},{time:.25,x:1.1,y:1.1,curve:[.311,1.1,.372,.85,.311,1.1,.372,.85]},{time:.4333,x:.85,y:.85},{time:.6667,x:1.429,y:1.429},{time:.8333,x:1.129,y:1.129},{time:1,x:1.25,y:1.25},{time:1.4167,x:1.683,y:1.683}]},{target:[this.lock.lockTop,this.lockAdd.lockTop],rotate:[{time:1,curve:[1.167,0,1.333,-121.38]},{time:1.5,value:-121.38}],translate:[{time:1,curve:[1.071,4.02,1.138,25.65,1.001,12.95,1.03,100.38]},{time:1.1667,x:41.82,y:101.94,curve:[1.192,55.82,1.331,86.21,1.372,104.27,1.418,-140.5]},{time:1.5,x:88.65,y:-299.65}]},{target:[this.lock.lockBody,this.lockAdd.lockBody],rotate:[{time:1,curve:[1.144,0,1.289,-41.15]},{time:1.4333,value:-41.15}],translate:[{time:1,curve:[1.033,8.2,1.072,18.35,1,11.4,1.015,28.43]},{time:1.1333,x:24.72,y:26.74,curve:[1.157,27.2,1.325,30.81,1.254,25.02,1.43,-185.2]},{time:1.4333,x:31.32,y:-250.19}]},{target:this.lockAdd,rgba:[{time:.4333,color:"ffffff00"},{time:.6667,color:"ffffffff",curve:"stepped"},{time:1.4167,color:"ffffffff"},{time:1.4333,color:"ffffff00"}]},{target:this.lockGlow,scale:[{time:.9333,curve:[ZO,1.429,1.037,2.964,ZO,1.429,1.037,2.964]},{time:1.4167,x:5.058,y:5.058}],rgba:[{time:.9333,color:"ffffff00",curve:[.956,1,.978,1,.956,1,.978,1,.956,1,.978,1,.933,.2,.978,.48]},{time:1,color:"ffffff7a"},{time:1.4167,color:"ffffff00"}]}])},t}(Phaser.GameObjects.Container),UO=FO,WO=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.groupSize=void 0,n.scene=t,n.groupSize=n.scene.journeyDataService.getMaxSizePerGroup(),n.create(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.alignMaps(n.length),r=[],s=c().mark((function e(){var s,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=a[o],h=n[o],u=i[o],s.updateMapData(t[o],i[o]),s.shouldPlayUpdateMapDataAnimation(h,u)&&(l=1e3*r.length,r.push((function(){return s.playUpdateMapDataAnimation(h,u,l)})));case 5:case"end":return e.stop()}}),e)})),o=0;case 4:if(!(o<a.length)){e.next=9;break}return e.delegateYield(s(),"t0",6);case 6:o++,e.next=4;break;case 9:if(!(r.length>0)){e.next=15;break}return h=r.map((function(e){return e()})),e.next=13,Promise.all(h);case 13:e.next=17;break;case 15:return e.next=17,(0,le.qZ)(300);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<this.groupSize;e++){var t=new UO(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(this.groupSize)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var a=10*(i-(e-1)/2),r=188*(i-(e-1)/2),s=16*Math.abs(i-n)-15;t.setAngle(a),t.setX(r),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),HO=WO,YO=Wi.Z.JOURNEY,KO=YO.KEY,zO=YO.FRAME,VO=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.circles=void 0,i.currentPageCircle=void 0,i.circleData=void 0,i.curPageIdx=void 0,i.totalPages=void 0,i.selectPageCallback=void 0,i.isAnimating=void 0,i.activeCircleIndex=void 0,i.slidePageQueue=[],i.startIndex=void 0,i.endIndex=void 0,i.slideDuration=void 0,i.selectPageNormal=function(e){i.currentPageCircle.setX(i.circles[e].x),i.curPageIdx=e},i.selectPageSpecial=function(e){if(e!==i.curPageIdx){var t=e>i.curPageIdx?-1:1;i.curPageIdx=e;var n=i.activeCircleIndex-t;i.circleData[n].isActive?(i.activeCircleIndex=n,i.runCurrentCircleAnimation(i.circles[i.activeCircleIndex].x)):i.runSlidePage(t)}},i.scene=t,i.totalPages=n,i.curPageIdx=0,i.createCircles(),i.createCurrentCircle(),i.alignCircles(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.selectPage=function(e,t){var n=Math.abs(e-this.curPageIdx);this.slideDuration=Phaser.Math.Clamp(t-100,0,200);for(var i=e>this.curPageIdx?1:-1,a=this.curPageIdx,r=0;r<n;)a+=i,this.selectPageCallback(a),r++},n.createCircles=function(){this.totalPages<=3?(this.circles=this.createNormalCircles(this.totalPages),this.selectPageCallback=this.selectPageNormal):(this.circles=this.createSpecialCircles(),this.selectPageCallback=this.selectPageSpecial)},n.runCurrentCircleAnimation=function(e){0!=this.slideDuration?this.scene.tweens.add({targets:this.currentPageCircle,x:e,duration:100,ease:Phaser.Math.Easing.Sine.Out}):this.currentPageCircle.setX(e)},n.runSlidePage=function(e){var t=this;this.isAnimating?this.slidePageQueue.push((function(){return t.runSlidePage(e)})):(this.isAnimating=!0,this.startIndex=this.startIndex+e,this.endIndex=this.endIndex+e,this.runSlideCircles(e).then((function(){return t.onSlideComplete(e)})))},n.onSlideComplete=function(e){if(this.reorderCircles(e),this.updateVisibility(),this.isAnimating=!1,this.slidePageQueue.length>0){var t=this.slidePageQueue.shift();t&&t()}},n.reorderCircles=function(e){if(-1===e){var t=this.circles.shift();t&&this.circles.push(t)}else{var n=this.circles.pop();n&&this.circles.unshift(n)}},n.runSlideCircles=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.circles.map((function(e,n){var a=(n+t+i.circles.length)%i.circles.length;return i.runCircleSlideAnimation(e,a)})),e.next=3,Promise.race(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCircleSlideAnimation=function(e,t){var n=this;return new Promise((function(i){n.scene.tweens.add({targets:e,x:n.circleData[t].x,scale:n.circleData[t].scale,alpha:n.circleData[t].alpha,duration:n.slideDuration,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){i()}})}))},n.updateVisibility=function(){var e=this;this.circles.forEach((function(t,n){n>=e.startIndex&&n<=e.endIndex?t.setVisible(!0):t.setVisible(!1)}))},n.alignCircles=function(){var e=this;this.circleData=[],this.circles.forEach((function(t,n){0===n?t.setX(0):t.setX(e.circles[n-1].x+e.circles[n-1].displayWidth/2+e.circles[n].displayWidth/2+4)})),1===this.circles.length?this.setSize(this.circles[0].displayWidth,this.circles[0].displayHeight):this.setSize(this.circles[this.circles.length-1].x-this.circles[0].x+this.circles[0].displayWidth,this.circles[0].displayHeight),this.circles.forEach((function(t){t.x-=e.width/2})),this.circles.forEach((function(t,n){e.circleData.push({x:t.x,scale:t.scale,alpha:t.alpha,isActive:n>2&&n<6})})),this.activeCircleIndex=this.circleData.findIndex((function(e){return e.isActive})),-1!==this.activeCircleIndex&&this.currentPageCircle.setX(this.circles[this.activeCircleIndex].x),this.updateVisibility()},n.createCurrentCircle=function(){var e=this.scene.add.image(0,0,KO,zO.PAGINATION.CURRENT_PAGE_POSITION_CIRCLE);e.setDefaultWorldSize(),e.setY(.8),this.add(e),this.currentPageCircle=e},n.createNormalCircles=function(e){for(var t=[],n=0;n<e;n++){var i=this.scene.add.image(0,0,KO,zO.PAGINATION.PAGE_CIRCLE);i.setDefaultWorldSize(),this.add(i),t.push(i)}return t},n.createSpecialCircles=function(){for(var e=[],t=0;t<9;t++){var n=this.scene.add.image(0,0,KO,zO.PAGINATION.PAGE_CIRCLE);n.setDefaultWorldSize(),0===t||8===t?n.setScale(0):1===t||7===t?n.setScale(1/8):2===t||6===t?n.setScale(.2):n.setScale(1/3),this.add(n),e.push(n)}var i=this.totalPages-1;return this.startIndex=3,this.endIndex=i+3,e},t}(Phaser.GameObjects.Container),jO=Wi.Z.JOURNEY,XO=jO.KEY,qO=jO.FRAME,JO=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.completedRibbon=void 0,a.inProgressRibbon=void 0,a.lockRibbon=void 0,a.nameText=void 0,a.scene=t,a.create(),a.setSize(n,i),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.setMapName=function(e){this.nameText.setText(e);var t=Math.max(10,16-Math.floor(e.length/12*3));this.nameText.setFontSize(this.scene.fontSize(t))},n.create=function(){this.createCompletedRibbon(),this.createInProgressRibbon(),this.createLockRibbon(),this.createText()},n.createCompletedRibbon=function(){this.completedRibbon=this.scene.add.image(0,0,XO,qO.MAP_BLOCK.RIBBON.PINK),this.completedRibbon.setDefaultWorldSize(),this.add(this.completedRibbon),this.completedRibbon.setVisible(!1)},n.createInProgressRibbon=function(){this.inProgressRibbon=this.scene.add.image(0,0,XO,qO.MAP_BLOCK.RIBBON.BLUE),this.inProgressRibbon.setDefaultWorldSize(),this.add(this.inProgressRibbon),this.inProgressRibbon.setVisible(!1)},n.createLockRibbon=function(){this.lockRibbon=this.scene.add.image(0,0,XO,qO.MAP_BLOCK.RIBBON.RED),this.lockRibbon.setDefaultWorldSize(),this.add(this.lockRibbon),this.lockRibbon.setVisible(!1)},n.setLockRibbon=function(e){this.lockRibbon.setVisible(e)},n.setRibbon=function(e){this.completedRibbon.setVisible(e===ER.Finished),this.inProgressRibbon.setVisible(e===ER.InProgress),this.lockRibbon.setVisible(e===ER.Lock)},n.createText=function(){var e=new jp(this.scene,{text:"Map Name",fontSize:this.scene.fontSize(16),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setText("Map Name"),this.nameText=e,this.add(this.nameText),this.nameText.setPosition(0,-4)},t}(Phaser.GameObjects.Container),QO=JO,$O=Wi.Z.JOURNEY,eR=$O.KEY,tR=$O.FRAME,nR=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.leftDecoration=void 0,a.leftLockDecoration=void 0,a.rightDecoration=void 0,a.rightLockDecoration=void 0,a.scene=t,a.create(),a.setSize(n,i),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){},n.create=function(){this.createDecorations()},n.setTint=function(e){this.leftDecoration.setTintFill(e),this.rightDecoration.setTintFill(e)},n.setLockDecoration=function(e){this.leftLockDecoration.setVisible(e),this.rightLockDecoration.setVisible(e)},n.setWidth=function(e){this.setSize(e,this.height),this.leftDecoration.setX(-e/2),this.rightDecoration.setX(e/2),this.leftLockDecoration.setX(this.leftDecoration.x),this.rightLockDecoration.setX(this.rightDecoration.x)},n.createDecorations=function(){this.leftDecoration=this.scene.add.image(-this.width/2,0,eR,tR.MAP_BLOCK.DECORATION),this.leftDecoration.setDefaultWorldSize(),this.add(this.leftDecoration),this.leftLockDecoration=this.scene.add.image(this.leftDecoration.x,0,eR,tR.MAP_BLOCK.LOCK_DECORATION),this.leftLockDecoration.setDefaultWorldSize(),this.add(this.leftLockDecoration);var e=this.width/2-this.leftDecoration.displayHeight/2-2;this.rightDecoration=this.scene.add.image(this.height/2,0,eR,tR.MAP_BLOCK.DECORATION),this.rightDecoration.setDefaultWorldSize(),this.rightDecoration.setFlipX(!0),this.add(this.rightDecoration),this.rightLockDecoration=this.scene.add.image(this.rightDecoration.x,0,eR,tR.MAP_BLOCK.LOCK_DECORATION),this.rightLockDecoration.setDefaultWorldSize(),this.rightLockDecoration.setFlipX(!0),this.add(this.rightLockDecoration),this.leftDecoration.setY(e),this.leftLockDecoration.setY(e),this.rightDecoration.setY(e),this.rightLockDecoration.setY(e)},t}(Phaser.GameObjects.Container),iR=nR;function aR(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rR(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var sR=Wi.Z.JOURNEY,oR=sR.KEY,cR=sR.FRAME,hR=501.5/3,uR=376/3,lR=1.004,dR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.background=void 0,n.lockBackground=void 0,n.thumbnail=void 0,n.progressBar=void 0,n.mapNameRibbon=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.decoration=void 0,n.status=void 0,n.thumbnailKey=void 0,n.thumbnailBorder=void 0,n.cardShines=void 0,n.lock=void 0,n.checkMark=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,fc.Z)(n)),n.setScale(.95),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.updateAlignment(e),this.setMapActive(e===ER.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.updateAlignment(t),this.setMapActive(t===ER.InProgress);var n=e.progressBar,i=n.currentProgress,a=n.maxProgress;this.progressBar.setProgressBarFill(i,a)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===ER.Lock&&t===ER.InProgress,i=e===ER.InProgress&&t===ER.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(a=t===ER.Lock&&n===ER.InProgress,r=t===ER.InProgress&&n===ER.Finished,!a){e.next=12;break}return this.updateVisibility(ER.Lock),this.updateAlignment(ER.Lock),this.setMapActive(!1),e.next=11,this.playUnlockMapAnimation(i);case 11:return e.abrupt("return");case 12:if(!r){e.next=18;break}return this.updateVisibility(ER.InProgress),this.updateAlignment(ER.InProgress),this.setMapActive(!0),e.next=18,this.playFinishedMapAnimation(i);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===ER.Lock),this.checkMark.setVisible(e===ER.Finished),this.progressBar.setVisible(e===ER.InProgress),this.mapNameRibbon.setLockRibbon(e===ER.Lock),this.lockBackground.setVisible(e===ER.Lock),this.decoration.setLockDecoration(e===ER.Lock),this.mapNameRibbon.setRibbon(e),e===ER.Lock?(this.thumbnailFrame.setPipeline("LockEffect"),this.thumbnailBorder.setFrame(cR.MAP_BLOCK.LOCKED_FRAME)):(this.thumbnailFrame.resetPipeline(!0,!0),this.thumbnailBorder.setFrame(cR.MAP_BLOCK.JOURNEY_FRAME))},n.updateAlignment=function(e){this.decoration.setWidth(e===ER.InProgress?this.progressBar.displayWidth-6:27)},n.setMapActive=function(e){void 0===e&&(e=!0);var t=e?lR:1;this.offsetOriginWrapper.setScale(t),this.offsetOriginWrapper.setY((1-t)*this.height/4+40)},n.updateMapName=function(e){this.mapNameRibbon.setMapName(e)},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function a(){i.showLoading(!0);var r="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(hR,uR),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(r,a),i.previousEventName=r}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+18),this.loading.setY(this.thumbnail.y),this.progressBar.setPosition(0,64),this.mapNameRibbon.setPosition(-this.background.width/2+this.mapNameRibbon.displayWidth/2+8.75,-this.background.height/2+18),this.decoration.setY(this.background.height/2-20),this.decoration.setWidth(this.progressBar.displayWidth-5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=c().mark((function e(){var i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=r.cardShines[a]).revive(),i.setAlpha(0),s=r.scene.tweens.add({targets:i,alpha:.08,delay:t+150*a,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(s);case 5:case"end":return e.stop()}}),e)})),a=0;case 5:if(!(a<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:a++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(ER.InProgress),this.updateAlignment(ER.InProgress),this.offsetOriginWrapper.setScale(lR),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,dl.Z)(this.scene,t+500).then((function(){i.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.REWARD_GIFT)})),e.next=12,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.scene.tweens.add({targets:this.decoration,width:27,ease:Phaser.Math.Easing.Elastic.InOut,easeParams:[.1,.6],delay:t+400,duration:n,onUpdate:function(){i.decoration.setWidth(i.decoration.width)}}).waitForCompletion()]);case 12:this.alignItems(),this.updateAlignment(ER.Finished),this.setMapActive(!1);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.progressBar.revive(),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),e.next=7,Promise.all([this.scene.tweens.add({targets:this.lock,scale:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.4],delay:t,duration:1e3}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:-.0040000000000000036*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.decoration,width:135,ease:Phaser.Math.Easing.Sine.InOut,delay:t+1e3,duration:300,onUpdate:function(){n.decoration.setWidth(n.decoration.width)}}).waitForCompletion(),this.scene.tweens.add({targets:this.lockBackground,alpha:0,delay:t+1100,duration:180,onComplete:function(){n.lockBackground.setVisible(!1),n.lockBackground.setAlpha(1)}}).waitForCompletion()]);case 7:this.lock.kill(),this.lock.setScale(1),this.alignItems(),this.setMapActive(!0);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createBackground(),this.createLockBackground(),this.createThumbnail(),this.createDecorations(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createMapNameRibbon(),this.createCardShines()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createBackground=function(){var e=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createLockBackground=function(){var e=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.LOCK_CARD);e.setDefaultWorldSize(),this.wrapper.add(e),this.lockBackground=e},n.createCardShines=function(){for(var e,t=[],n=aR(cR.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,a=this.scene.add.image(0,0,oR,i);a.setDefaultWorldSize(),a.setBlendMode(Phaser.BlendModes.ADD),a.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),a.kill(),this.wrapper.add(a),t.push(a)}var r=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.CARD_SHINES[0]);r.setDefaultWorldSize(),r.setScale(t[0].scaleX,t[0].scaleY),r.setBlendMode(Phaser.BlendModes.ADD),r.setPosition(-t[0].displayWidth/2+r.displayWidth/2,t[0].displayHeight/2-r.displayHeight/2),this.wrapper.add(r);var s=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.CARD_SHINES[cR.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[r].concat(t,[s]),r.kill(),s.kill()},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(hR,uR);var e=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.PLACE_HOLDER);e.setDefaultWorldSize();var t=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.PLACE_HOLDER);t.setDefaultWorldSize();var n=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.JOURNEY_FRAME);n.setDefaultWorldSize(),this.thumbnail.add([e,t,n]),this.thumbnailFrame=t,this.thumbnailBorder=n},n.createProgressBar=function(){this.progressBar=new xO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createMapNameRibbon=function(){var e=new QO(this.scene,this.width,this.height);this.wrapper.add(e),this.mapNameRibbon=e},n.createLock=function(){this.lock=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.NEW_ICON_LOCK),this.lock.setDefaultWorldSize(),this.lock.setY(53.325),this.wrapper.add(this.lock),this.lock.kill()},n.createDecorations=function(){this.decoration=new iR(this.scene,this.width,this.height),this.wrapper.add(this.decoration)},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,oR,cR.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(53.325),this.checkMark.kill()},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(44,44),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},t}(Phaser.GameObjects.Container),pR=dR,fR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.scene=t,n.create(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.alignMaps(n.length),r=[],s=0;s<a.length;s++)a[s].updateMapData(t[s],i[s]);if(!(r.length>0)){e.next=9;break}return o=r.map((function(e){return e()})),e.next=7,Promise.all(o);case 7:e.next=11;break;case 9:return e.next=11,(0,le.qZ)(300);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<3;e++){var t=new pR(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(3)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var a=5.3*(i-(e-1)/2),r=199*(i-(e-1)/2)*t.scale,s=8*Math.abs(i-n)-15;t.setAngle(0===a?-.2:a),t.setX(r),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),mR=fR,gR=Wi.Z.JOURNEY,vR=gR.KEY,yR=gR.FRAME,ER=function(e){return e.Lock="lock",e.InProgress="in_progress",e.Finished="finished",e}({}),CR=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).closeButton=void 0,r.mapGroup=void 0,r.mapGroupPool=void 0,r.scrollEventContainer=void 0,r.lastDragX=void 0,r.firstX=void 0,r.isDraggable=void 0,r.curScrollIdx=void 0,r.mapPayloads=void 0,r.pagination=void 0,r.onDragStart=function(){r.mapGroup.forEach((function(e){r.scene.tweens.killTweensOf(e)})),r.isDraggable||(r.isDraggable=!0,r.lastDragX=r.scene.input.activePointer.worldX,r.firstX=r.lastDragX)},r.onDrag=function(e,t){if(r.isDraggable){var n=r.scene.input.activePointer.worldX;if(!(r.curScrollIdx<=0&&t>0&&r.mapGroup[r.curScrollIdx].x>=0||r.curScrollIdx>=r.mapGroup.length-1&&t<0&&r.mapGroup[r.curScrollIdx].x<=0)){n-r.firstX<=0?(r.hidePage(r.curScrollIdx-1),r.updatePageByScroll(r.curScrollIdx+1)):(r.hidePage(r.curScrollIdx+1),r.updatePageByScroll(r.curScrollIdx-1));var i=n-r.lastDragX;r.mapGroup.forEach((function(e){return e.x+=i})),r.lastDragX=n}}},r.onDragEnd=function(){if(r.isDraggable){r.isDraggable=!1;var e=r.scene.input.activePointer.worldX,t=r.scene.input.activePointer.velocity.x,n=r.mapGroup[r.curScrollIdx],i=e-r.firstX,a=r.curScrollIdx;(i<=-n.width/2||t<-25&&i<-40)&&(a=Phaser.Math.Clamp(a+1,0,r.mapGroup.length-1)),(i>=n.width/2||t>25&&i>40)&&(a=Phaser.Math.Clamp(a-1,0,r.mapGroup.length-1)),r.selectPage(a)}},r.setBackground=function(e){r.background.setTexture(e),r.updateBackgroundSize()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r)),r.mapGroup.forEach((function(e){return e.setVisible(!1)}));var t=r.scene.level.getLevel();r.scene.events.emit(hi.AUTO_SHOWING_JOURNEY,!1),r.scene.gameUI.coinBarButton.setDisabled(!1),r.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{level:t})},r.create(),r.mapGroupPool=[],r.zone.disableInteractive(),yp.Z.registerObject(r.background),r.listenEvents(),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),yp.Z.setColor("121 54 27"),i=n.shouldCloseAfterComplete,a=void 0!==i&&i,this.scrollEventContainer.disableInteractive(),this.isDraggable=!1,this.closeButton.setDisabled(!0),this.closeButton.setAlpha(1),this.runEntranceAnimation(),t.next=10,this.updateData();case 10:a?(0,dl.Z)(this.scene,400).then((function(){r.scene.screen.close(ce.o4.JOURNEY_SCREEN)})):this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.closeButton.setDisabled(!1);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){yp.Z.setColor("0 0 0"),this.runExitAnimation()},n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,this.mapPayloads=n,a=this.getGroupsToUpdate(i),r=0;case 4:if(!(r<a.length)){e.next=17;break}if(s=a[r],!(o=this.prepareMapGroupContainer(s))){e.next=14;break}return this.selectPage(s,0===r?0:300),h=this.mapGroup[s].getData("mapStatus"),u=this.getNewMapStatuses(this.mapPayloads[s]),e.next=13,o.updateMapData(this.mapPayloads[s],h,u);case 13:this.mapGroup[s].setData("mapStatus",u);case 14:r++,e.next=4;break;case 17:return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNewMapStatuses=function(e){return e.map((function(e){var t=e.progressBar;if(!t)return ER.Lock;var n=t.lock,i=void 0===n||n,a=t.currentProgress,r=void 0===a?0:a,s=t.maxProgress,o=void 0===s?15:s;return i?ER.Lock:r===o?ER.Finished:ER.InProgress}))},n.getGroupsToUpdate=function(e){var t=this.mapGroup.map((function(e,t){return{index:t,data:e.getData("mapStatus")}})).filter((function(e){return e.data.some((function(e){return e===ER.InProgress}))})).map((function(e){return e.index}));return t.includes(e)||t.push(e),t},n.updatePageByScroll=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.prepareMapGroupContainer(t))){e.next=6;break}return i=this.mapGroup[t].getData("mapStatus"),a=this.getNewMapStatuses(this.mapPayloads[t]),e.next=6,n.updateMapData(this.mapPayloads[t],i,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.prepareMapGroupContainer=function(e){var t=this.mapGroup[e];return!t||t.visible?null:(t.revive(),this.getMapGroupContainer(t))},n.getMapGroupContainer=function(e){var t=e.getAll().find((function(e){return e instanceof mR}));return t||(t=this.getMapGroupContainerFromPool(e),e.add(t)),t},n.getMapGroupContainerFromPool=function(e){var t=this.mapGroupPool.find((function(e){return!e.active}));t||(t=new mR(this.scene),this.mapGroupPool.push(t));var n=e.getData("mapStatus");return t.reset(n),t.revive(),t},n.hidePage=function(e){var t=this.mapGroup[e];t&&t.visible&&(t.x<-this.scene.gameZone.width||t.x>this.scene.gameZone.width)&&(t.kill(),this.removeMapGroupContainer(t))},n.removeMapGroupContainer=function(e){e.getAll().forEach((function(t){t instanceof HO&&(e.getData("mapStatus").some((function(e){return e===ER.InProgress}))||(t.kill(),e.remove(t)))}))},n.listenEvents=function(){this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd)},n.selectPage=function(e,t){void 0===t&&(t=300),this.createTweenMovePage(e,t)},n.setVisibleListContainer=function(e,t,n){for(var i=t;i<=n;i++){var a=this.mapGroup[i];a&&i!=this.curScrollIdx&&a.setVisible(e)}},n.createTweenMovePage=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===n&&(n=300),this.mapGroup[t].setVisible(!0),i=Math.min(t,this.curScrollIdx),a=Math.max(t,this.curScrollIdx),r=i;r<=a;r++)r!=this.curScrollIdx&&this.mapGroup[r].setVisible(!0);this.curScrollIdx=t,this.mapGroup.forEach((function(e,i){s.scene.tweens.killTweensOf(e),s.scene.tweens.add({targets:e,x:e.x-s.mapGroup[t].x,duration:n,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){s.setVisibleListContainer(!1,0,s.mapGroup.length-1),t!=i&&e instanceof Phaser.GameObjects.Container&&(e.kill(),s.removeMapGroupContainer(e))}})})),this.pagination.selectPage(t,n);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createBackground(),this.createTitle(),this.createMapGroupContainers(),this.createScrollEventContainer(),this.createPagination(),this.createCloseButton()},n.createBackground=function(){this.background=this.scene.add.image(0,0,ie.Z.JOURNEY_BACKGROUND.KEY),this.background.setDefaultWorldSize(),this.add(this.background),this.updateBackgroundSize()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:this.scene.lang.Text.journey,origin:{x:.5,y:.5}});this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-.5)},n.createCloseButton=function(){var e=this;this.closeButton=new iv.Z(this.scene,{key:vR,frame:yR.CLOSE_BUTTON,width:77/3,height:77/3,paddingZone:30}),this.closeButton.setName("Close"),this.add(this.closeButton),Phaser.Display.Align.In.TopRight(this.closeButton,this,-5,-7),this.closeButton.onClick=function(){e.scene.screen.close(e.name),e.closeButton.setDisabled(!0)}},n.createMapGroupContainers=function(){this.curScrollIdx=0,this.mapGroup=[];for(var e=this.scene.journeyDataService.getTotalPages(),t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,a=n.slice(0,i+1),r=0;r<e;r++){var s=this.scene.add.container(0,0);s.setSize(this.width,this.height),s.kill();var o=new Array(3).fill(ER.Lock);r<=a.length-1&&(o=a[r].map((function(e){var t=e.progressBar;return t?t.lock?ER.Lock:t.currentProgress==t.maxProgress?ER.Finished:ER.InProgress:ER.Lock}))),s.setData("mapStatus",o),this.add(s),this.mapGroup.push(s)}this.alignMapGroup()},n.createScrollEventContainer=function(){var e=this.scene.add.container(0,0);this.add(e),e.setSize(this.width,this.height),Phaser.Display.Align.In.Center(this,e),this.scrollEventContainer=e},n.createPagination=function(){var e=this.scene.journeyDataService.getTotalPages(),t=new VO(this.scene,e);this.add(t),Phaser.Display.Align.In.BottomCenter(t,this,0,-13),this.pagination=t},n.alignMapGroup=function(){var e=this;this.mapGroup.forEach((function(t,n){t.setX(n*e.scene.gameZone.width)}))},n.updateBackgroundSize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.scene.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var a=this.background,r=a.scaleX,s=a.scaleY;"height"===i?this.background.setScale(s):this.background.setScale(r)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen);function AR(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wR(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var SR,bR=Wi.Z.JOURNEY,TR=bR.KEY,xR=bR.FRAME,PR=376/3,kR=335/3,IR=1.13,OR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.offsetOriginWrapper=void 0,n.wrapper=void 0,n.shadow=void 0,n.background=void 0,n.overlay=void 0,n.thumbnail=void 0,n.mapName=void 0,n.progressBar=void 0,n.previousEventName="",n.loading=void 0,n.thumbnailFrame=void 0,n.status=void 0,n.thumbnailKey=void 0,n.cardShines=void 0,n.multiplyLabelShine=void 0,n.additiveLabelShine=void 0,n.lock=void 0,n.lockGlow=void 0,n.lockAdd=void 0,n.checkMark=void 0,n.unlockMapAnimation=void 0,n.scene=t,n.thumbnailKey="",n.setSize(141,182),n.create(),n.alignItems(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.progressBar.reset(),this.updateVisibility(e),this.setMapActive(e===NR.InProgress)},n.updateMapData=function(e,t){this.status=t,this.updateMapName(e.name),e.thumbnail&&this.updateThumbnail(e.thumbnail.key,e.thumbnail.url,e.thumbnail.frame),this.updateVisibility(t),this.setMapActive(t===NR.InProgress);var n=e.progressBar,i=n.currentProgress,a=n.maxProgress;this.progressBar.setProgressBarFill(i,a)},n.shouldPlayUpdateMapDataAnimation=function(e,t){var n=e===NR.Lock&&t===NR.InProgress,i=e===NR.InProgress&&t===NR.Finished;return!(!n&&!i)},n.playUpdateMapDataAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=0),this.shouldPlayUpdateMapDataAnimation(t,n)){e.next=3;break}return e.abrupt("return");case 3:if(a=t===NR.Lock&&n===NR.InProgress,r=t===NR.InProgress&&n===NR.Finished,!a){e.next=11;break}return this.updateVisibility(NR.Lock),this.setMapActive(!1),e.next=10,this.playUnlockMapAnimation(i);case 10:return e.abrupt("return");case 11:if(!r){e.next=16;break}return this.updateVisibility(NR.InProgress),this.setMapActive(!0),e.next=16,this.playFinishedMapAnimation(i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.updateVisibility=function(e){this.lock.setVisible(e===NR.Lock),this.checkMark.setVisible(e===NR.Finished),this.progressBar.setVisible(e===NR.InProgress),this.overlay.setAlpha(e===NR.Lock?.5:0)},n.setMapActive=function(e){void 0===e&&(e=!0);var t=e?IR:1;this.offsetOriginWrapper.setScale(t),this.offsetOriginWrapper.setY((1-t)*this.height/4+40)},n.updateMapName=function(e){var t=this.scene.lang.getText(e);this.mapName.setText(t),this.mapName.width>this.background.width-5?this.mapName.setFontSize(this.scene.fontSize(15)):this.mapName.setFontSize(this.scene.fontSize(16))},n.updateThumbnail=function(e,t,n){var i=this;""!==this.thumbnailKey&&this.thumbnailKey===e||this.showLoading(!0),this.thumbnailKey=e,this.scene.load.off(this.previousEventName);!function a(){i.showLoading(!0);var r="filecomplete-image-"+e;if(i.scene.textures.exists(e))return i.thumbnailFrame.setTexture(e,n),i.thumbnailFrame.setWorldSize(PR,kR),void i.showLoading(!1);i.scene.load.image(e,t),i.scene.load.start(),i.scene.load.once(r,a),i.previousEventName=r}()},n.showLoading=function(e){this.thumbnailFrame.setVisible(!e),this.loading.setVisible(e)},n.alignItems=function(){this.shadow.setY(2),this.thumbnail.setY(-this.background.height/2+this.thumbnail.height/2+6),this.loading.setY(this.thumbnail.y),this.mapName.setY(this.thumbnail.y+this.thumbnail.height/2+14),this.progressBar.setY(68),this.lockGlow.setPosition(this.progressBar.x,this.progressBar.y+5),this.wrapper.setPosition(0,-40),this.offsetOriginWrapper.setPosition(0,40)},n.playCardShineAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),300,n=[],i=c().mark((function e(){var i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=r.cardShines[a]).revive(),i.setAlpha(0),s=r.scene.tweens.add({targets:i,alpha:.08,delay:t+150*a,yoyo:!0,duration:300,onComplete:function(){i.kill()}}).waitForCompletion(),n.push(s);case 5:case"end":return e.stop()}}),e)})),a=0;case 5:if(!(a<this.cardShines.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:a++,e.next=5;break;case 10:return e.next=12,Promise.all(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playLabelShineAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.multiplyLabelShine.revive(),this.additiveLabelShine.revive(),this.multiplyLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),this.additiveLabelShine.setPosition(this.mapName.x-this.mapName.width/2,this.mapName.y),n=800,this.multiplyLabelShine.setAlpha(0),this.additiveLabelShine.setAlpha(0),this.multiplyLabelShine.setScale(1.5,.4),this.additiveLabelShine.setScale(1.5,.4),e.next=12,Promise.all([this.scene.tweens.add({targets:this.additiveLabelShine,alpha:.5,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.multiplyLabelShine,alpha:1,yoyo:!0,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],x:this.mapName.x+this.mapName.width/2,delay:t,duration:n,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),this.scene.tweens.add({targets:[this.multiplyLabelShine,this.additiveLabelShine],scaleX:2,yoyo:!0,delay:t,duration:400,ease:Phaser.Math.Easing.Cubic.InOut}).waitForCompletion()]);case 12:this.multiplyLabelShine.kill(),this.additiveLabelShine.kill();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playFinishedMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.progressBar.revive(),n=1e3,this.updateVisibility(NR.InProgress),this.offsetOriginWrapper.setScale(IR),this.checkMark.revive(),this.checkMark.setAlpha(1),this.checkMark.setScale(0),(0,dl.Z)(this.scene,t+500).then((function(){i.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.REWARD_GIFT)})),e.next=11,Promise.all([this.scene.tweens.add({targets:this.checkMark,scale:3/9,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t+900,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,scale:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.4],delay:t,duration:n}).waitForCompletion(),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:40,ease:Phaser.Math.Easing.Sine.Out,delay:t,duration:600}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:0,scaleY:0,ease:Phaser.Math.Easing.Elastic.In,easeParams:[.1,.6],delay:t,duration:n,onComplete:function(){i.progressBar.setScale(1),i.progressBar.kill()}}).waitForCompletion(),this.playCardShineAnimation(t+400)]);case 11:this.alignItems(),this.setMapActive(!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.playUnlockMapAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),this.lock.revive(),this.lockAdd.revive(),this.lockGlow.revive(),this.progressBar.revive(),this.unlockMapAnimation.setDelay(t),this.overlay.setAlpha(.5),this.progressBar.setScale(.3,1),this.progressBar.setAlpha(0),this.unlockMapAnimation.events.on("startDelay",(function(){(0,dl.Z)(n.scene,550).then((function(){n.scene.audio.playAudioSprite(Fc.Z.CARD.KEY,ec.Z.TWIST_LOCK)}))})),e.next=12,Promise.all([this.unlockMapAnimation.start(),this.playCardShineAnimation(t+1700),this.playLabelShineAnimation(t+1200),this.scene.tweens.add({targets:this.offsetOriginWrapper,y:-.1299999999999999*this.height/4+40,ease:Phaser.Math.Easing.Sine.InOut,delay:t,duration:400}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,scaleX:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.6],delay:t+1100,duration:800}).waitForCompletion(),this.scene.tweens.add({targets:this.progressBar,alpha:1,ease:Phaser.Math.Easing.Sine.Out,delay:t+1100,duration:300}).waitForCompletion(),this.scene.tweens.add({targets:this.overlay,alpha:0,delay:t+1100,duration:180}).waitForCompletion()]);case 12:this.lock.kill(),this.lockAdd.kill(),this.lockGlow.kill(),this.lock.reset(),this.lockAdd.reset(),this.lock.setScale(1),this.lockAdd.setScale(1),this.alignItems(),this.setMapActive(!0);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.create=function(){this.createWrapper(),this.createShadow(),this.createBackground(),this.createThumbnail(),this.createMapName(),this.createProgressBar(),this.createLock(),this.createCheckMark(),this.createLoading(),this.createOverlay(),this.createCardShines(),this.createLabelShine(),this.createLockShines(),this.createUnlockMapAnimation()},n.createWrapper=function(){var e=this.scene.add.container(0,0);this.wrapper=e;var t=this.scene.add.container(0,0);t.add(this.wrapper),this.add(t),this.offsetOriginWrapper=t},n.createShadow=function(){var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.BACKGROUND_SHADOW);e.setDefaultWorldSize(),this.wrapper.add(e),this.shadow=e},n.createBackground=function(){var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),this.wrapper.add(e),this.background=e},n.createOverlay=function(){var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.BACKGROUND);e.setDefaultWorldSize(),e.setTint(5450259),e.setAlpha(0),this.wrapper.add(e),this.overlay=e},n.createCardShines=function(){for(var e,t=[],n=AR(xR.MAP_BLOCK.CARD_SHINES.slice(1,-1));!(e=n()).done;){var i=e.value,a=this.scene.add.image(0,0,TR,i);a.setDefaultWorldSize(),a.setBlendMode(Phaser.BlendModes.ADD),a.setDisplaySize(this.background.displayWidth+12,this.background.displayHeight+12),a.kill(),this.wrapper.add(a),t.push(a)}var r=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.CARD_SHINES[0]);r.setDefaultWorldSize(),r.setScale(t[0].scaleX,t[0].scaleY),r.setBlendMode(Phaser.BlendModes.ADD),r.setPosition(-t[0].displayWidth/2+r.displayWidth/2,t[0].displayHeight/2-r.displayHeight/2),this.wrapper.add(r);var s=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.CARD_SHINES[xR.MAP_BLOCK.CARD_SHINES.length-1]);s.setDefaultWorldSize(),s.setScale(t[0].scaleX,t[0].scaleY),s.setBlendMode(Phaser.BlendModes.ADD),s.setPosition(t[0].displayWidth/2-s.displayWidth/2,-t[0].displayHeight/2+s.displayHeight/2),this.wrapper.add(s),this.cardShines=[r].concat(t,[s]),r.kill(),s.kill()},n.createLabelShine=function(){var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.LABEL_SHINE);e.setDefaultWorldSize(),e.setScale(0,.4),e.setBlendMode(Phaser.BlendModes.MULTIPLY),e.setTint(13332544),e.setAlpha(1),e.kill(),this.wrapper.add(e),this.multiplyLabelShine=e;var t=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.LABEL_SHINE);t.setDefaultWorldSize(),t.setScale(0,.4),t.setBlendMode(Phaser.BlendModes.ADD),t.setAlpha(.3),t.kill(),this.wrapper.add(t),this.additiveLabelShine=t},n.createLockShines=function(){var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.LOCK_SHINE);e.setDefaultWorldSize(),e.setBlendMode(Phaser.BlendModes.ADD),e.setAlpha(1),e.setScale(3/9),e.kill(),this.wrapper.add(e),this.lockGlow=e;var t=new RO(this.scene);this.wrapper.add(t),t.setPosition(0,68),t.kill(),this.lockAdd=t},n.createThumbnail=function(){this.thumbnail=this.scene.add.container(0,0),this.wrapper.add(this.thumbnail),this.thumbnail.setSize(PR,kR);var e=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.THUMBNAIL_BACKGROUND);e.setWorldSize(PR,kR),this.thumbnail.add(e);var t=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.THUMBNAIL);t.setDefaultWorldSize(),this.thumbnail.add(t);var n=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.THUMBNAIL_FOREGROUND);n.setDefaultWorldSize(),this.thumbnail.add(n),this.thumbnailFrame=t},n.createMapName=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.HEADER.KEY,size:this.scene.fontSize(16),text:"Triple Cut",origin:{x:.5,y:.5}});this.wrapper.add(e),this.mapName=e},n.createProgressBar=function(){this.progressBar=new xO(this.scene,this.width,this.height),this.wrapper.add(this.progressBar)},n.createLock=function(){this.lock=new RO(this.scene),this.wrapper.add(this.lock),this.lock.setPosition(0,68),this.lock.kill()},n.createCheckMark=function(){this.checkMark=this.scene.add.image(0,0,TR,xR.MAP_BLOCK.ICON_CHECK),this.checkMark.setDefaultWorldSize(),this.wrapper.add(this.checkMark),this.checkMark.setY(68),this.checkMark.kill()},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(-19),this.wrapper.add(this.loading)},n.createUnlockMapAnimation=function(){this.unlockMapAnimation=new Hw([{target:this.offsetOriginWrapper,rotate:[{time:.55,curve:[.583,0,.617,2.62]},{time:.65,value:2.62,curve:[.667,2.62,.683,-2.63]},{time:.7,value:-2.63,curve:[.728,-2.63,.756,4.48]},{time:.7833,value:4.48,curve:[.806,4.48,.828,-3.45]},{time:.85,value:-3.45,curve:[.878,-3.45,.906,3.84]},{time:.9333,value:3.84,curve:[.961,3.84,.989,1.28]},{time:1.0167}],scale:[{time:.1833,curve:[.191,.993,.228,.95,.191,.993,.228,.95]},{time:.25,x:.95,y:.95,curve:[.337,.95,.46,1.157,.337,.95,.46,1.157]},{time:.55,x:1.16,y:1.16,curve:[.728,1.166,.685,.969,.728,1.166,.685,.969]},{time:.7833,x:.942,y:.942,curve:[1.064,.866,.994,1.185,1.064,.866,.994,1.185]},{time:1.1833,x:1.18,y:1.18,curve:[1.279,1.178,1.359,1.114,1.279,1.178,1.359,1.114]},{time:1.45,x:1.11,y:1.11,curve:[1.523,1.107,1.645,1.125,1.523,1.107,1.645,1.125]},{time:1.6667,x:IR,y:IR}]},{target:[this.lock,this.lockAdd],scale:[{time:.1667,curve:[.194,1,.222,1.1,.194,1,.222,1.1]},{time:.25,x:1.1,y:1.1,curve:[.311,1.1,.372,.85,.311,1.1,.372,.85]},{time:.4333,x:.85,y:.85},{time:.6667,x:1.429,y:1.429},{time:.8333,x:1.129,y:1.129},{time:1,x:1.25,y:1.25},{time:1.4167,x:1.683,y:1.683}]},{target:[this.lock.lockTop,this.lockAdd.lockTop],rotate:[{time:1,curve:[1.167,0,1.333,-121.38]},{time:1.5,value:-121.38}],translate:[{time:1,curve:[1.071,4.02,1.138,25.65,1.001,12.95,1.03,100.38]},{time:1.1667,x:41.82,y:101.94,curve:[1.192,55.82,1.331,86.21,1.372,104.27,1.418,-140.5]},{time:1.5,x:88.65,y:-299.65}]},{target:[this.lock.lockBody,this.lockAdd.lockBody],rotate:[{time:1,curve:[1.144,0,1.289,-41.15]},{time:1.4333,value:-41.15}],translate:[{time:1,curve:[1.033,8.2,1.072,18.35,1,11.4,1.015,28.43]},{time:1.1333,x:24.72,y:26.74,curve:[1.157,27.2,1.325,30.81,1.254,25.02,1.43,-185.2]},{time:1.4333,x:31.32,y:-250.19}]},{target:this.lockAdd,rgba:[{time:.4333,color:"ffffff00"},{time:.6667,color:"ffffffff",curve:"stepped"},{time:1.4167,color:"ffffffff"},{time:1.4333,color:"ffffff00"}]},{target:this.lockGlow,scale:[{time:.9333,curve:[IR,1.429,1.037,2.964,IR,1.429,1.037,2.964]},{time:1.4167,x:5.058,y:5.058}],rgba:[{time:.9333,color:"ffffff00",curve:[.956,1,.978,1,.956,1,.978,1,.956,1,.978,1,.933,.2,.978,.48]},{time:1,color:"ffffff7a"},{time:1.4167,color:"ffffff00"}]}])},t}(Phaser.GameObjects.Container),RR=OR,BR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.mapContainers=void 0,n.scene=t,n.create(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(e){this.mapContainers.forEach((function(t,n){t.reset(e[n])}))},n.updateMapData=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.alignMaps(n.length),r=[],s=c().mark((function e(){var s,h,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=a[o],h=n[o],u=i[o],s.updateMapData(t[o],i[o]),s.shouldPlayUpdateMapDataAnimation(h,u)&&(l=1e3*r.length,r.push((function(){return s.playUpdateMapDataAnimation(h,u,l)})));case 5:case"end":return e.stop()}}),e)})),o=0;case 4:if(!(o<a.length)){e.next=9;break}return e.delegateYield(s(),"t0",6);case 6:o++,e.next=4;break;case 9:if(!(r.length>0)){e.next=15;break}return h=r.map((function(e){return e()})),e.next=13,Promise.all(h);case 13:e.next=17;break;case 15:return e.next=17,(0,le.qZ)(300);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.create=function(){this.mapContainers=[];for(var e=0;e<3;e++){var t=new RR(this.scene);this.add(t),this.mapContainers.push(t)}this.alignMaps(3)},n.alignMaps=function(e){this.mapContainers.forEach((function(e){e.kill()}));var t=this.mapContainers.slice(0,e),n=(e-1)/2;return t.forEach((function(t,i){t.revive();var a=10*(i-(e-1)/2),r=188*(i-(e-1)/2),s=16*Math.abs(i-n)-15;t.setAngle(a),t.setX(r),t.setY(s)})),t},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{obj:this,scale:1}],n=this.scene.tweens.createTimeline({}),t.forEach((function(e){var t=e.obj,i=e.scale;t.setScale(0),n.add({targets:[t],scale:{from:0,to:i},duration:300,ease:Phaser.Math.Easing.Back.Out,offset:"-=200"})})),n.play(),e.next=6,n.waitForCompletion();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),DR=BR,LR=Wi.Z.JOURNEY,_R=LR.KEY,MR=LR.FRAME,NR=function(e){return e.Lock="lock",e.InProgress="in_progress",e.Finished="finished",e}({}),GR=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).closeButton=void 0,r.mapGroup=void 0,r.mapGroupPool=void 0,r.scrollEventContainer=void 0,r.lastDragX=void 0,r.firstX=void 0,r.isDraggable=void 0,r.curScrollIdx=void 0,r.mapPayloads=void 0,r.pagination=void 0,r.onDragStart=function(){r.mapGroup.forEach((function(e){r.scene.tweens.killTweensOf(e)})),r.isDraggable||(r.isDraggable=!0,r.lastDragX=r.scene.input.activePointer.worldX,r.firstX=r.lastDragX)},r.onDrag=function(e,t){if(r.isDraggable){var n=r.scene.input.activePointer.worldX;if(!(r.curScrollIdx<=0&&t>0&&r.mapGroup[r.curScrollIdx].x>=0||r.curScrollIdx>=r.mapGroup.length-1&&t<0&&r.mapGroup[r.curScrollIdx].x<=0)){n-r.firstX<=0?(r.hidePage(r.curScrollIdx-1),r.updatePageByScroll(r.curScrollIdx+1)):(r.hidePage(r.curScrollIdx+1),r.updatePageByScroll(r.curScrollIdx-1));var i=n-r.lastDragX;r.mapGroup.forEach((function(e){return e.x+=i})),r.lastDragX=n}}},r.onDragEnd=function(){if(r.isDraggable){r.isDraggable=!1;var e=r.scene.input.activePointer.worldX,t=r.scene.input.activePointer.velocity.x,n=r.mapGroup[r.curScrollIdx],i=e-r.firstX,a=r.curScrollIdx;(i<=-n.width/2||t<-25&&i<-40)&&(a=Phaser.Math.Clamp(a+1,0,r.mapGroup.length-1)),(i>=n.width/2||t>25&&i>40)&&(a=Phaser.Math.Clamp(a-1,0,r.mapGroup.length-1)),r.selectPage(a)}},r.setBackground=function(e){r.background.setTexture(e),r.updateBackgroundSize()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r)),r.mapGroup.forEach((function(e){return e.setVisible(!1)}));var t=r.scene.level.getLevel();r.scene.events.emit(hi.AUTO_SHOWING_JOURNEY,!1),r.scene.gameUI.coinBarButton.setDisabled(!1),r.scene.screen.open(ce.o4.DASHBOARD_SCREEN,{level:t})},r.create(),r.mapGroupPool=[],r.zone.disableInteractive(),yp.Z.registerObject(r.background),r.listenEvents(),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),yp.Z.setColor("121 54 27"),i=n.shouldCloseAfterComplete,a=void 0!==i&&i,this.scrollEventContainer.disableInteractive(),this.isDraggable=!1,this.closeButton.setDisabled(!0),this.closeButton.setAlpha(1),this.runEntranceAnimation(),t.next=10,this.updateData();case 10:a?(0,dl.Z)(this.scene,400).then((function(){r.scene.screen.close(ce.o4.JOURNEY_SCREEN)})):this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.closeButton.setDisabled(!1);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){yp.Z.setColor("0 0 0"),this.runExitAnimation()},n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,this.mapPayloads=n,a=this.getGroupsToUpdate(i),r=0;case 4:if(!(r<a.length)){e.next=17;break}if(s=a[r],!(o=this.prepareMapGroupContainer(s))){e.next=14;break}return this.selectPage(s,0===r?0:300),h=this.mapGroup[s].getData("mapStatus"),u=this.getNewMapStatuses(this.mapPayloads[s]),e.next=13,o.updateMapData(this.mapPayloads[s],h,u);case 13:this.mapGroup[s].setData("mapStatus",u);case 14:r++,e.next=4;break;case 17:return e.abrupt("return",Promise.resolve());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getNewMapStatuses=function(e){return e.map((function(e){var t=e.progressBar;if(!t)return NR.Lock;var n=t.lock,i=void 0===n||n,a=t.currentProgress,r=void 0===a?0:a,s=t.maxProgress,o=void 0===s?15:s;return i?NR.Lock:r===o?NR.Finished:NR.InProgress}))},n.getGroupsToUpdate=function(e){var t=this.mapGroup.map((function(e,t){return{index:t,data:e.getData("mapStatus")}})).filter((function(e){return e.data.some((function(e){return e===NR.InProgress}))})).map((function(e){return e.index}));return t.includes(e)||t.push(e),t},n.updatePageByScroll=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.prepareMapGroupContainer(t))){e.next=6;break}return i=this.mapGroup[t].getData("mapStatus"),a=this.getNewMapStatuses(this.mapPayloads[t]),e.next=6,n.updateMapData(this.mapPayloads[t],i,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.prepareMapGroupContainer=function(e){var t=this.mapGroup[e];return!t||t.visible?null:(t.revive(),this.getMapGroupContainer(t))},n.getMapGroupContainer=function(e){var t=e.getAll().find((function(e){return e instanceof DR}));return t||(t=this.getMapGroupContainerFromPool(e),e.add(t)),t},n.getMapGroupContainerFromPool=function(e){var t=this.mapGroupPool.find((function(e){return!e.active}));t||(t=new DR(this.scene),this.mapGroupPool.push(t));var n=e.getData("mapStatus");return t.reset(n),t.revive(),t},n.hidePage=function(e){var t=this.mapGroup[e];t&&t.visible&&(t.x<-this.scene.gameZone.width||t.x>this.scene.gameZone.width)&&(t.kill(),this.removeMapGroupContainer(t))},n.removeMapGroupContainer=function(e){e.getAll().forEach((function(t){t instanceof HO&&(e.getData("mapStatus").some((function(e){return e===NR.InProgress}))||(t.kill(),e.remove(t)))}))},n.listenEvents=function(){this.scrollEventContainer.setInteractive({draggable:!0,useHandCursor:!0}),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag),this.scrollEventContainer.on(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd)},n.selectPage=function(e,t){void 0===t&&(t=300),this.createTweenMovePage(e,t)},n.setVisibleListContainer=function(e,t,n){for(var i=t;i<=n;i++){var a=this.mapGroup[i];a&&i!=this.curScrollIdx&&a.setVisible(e)}},n.createTweenMovePage=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(void 0===n&&(n=300),this.mapGroup[t].setVisible(!0),i=Math.min(t,this.curScrollIdx),a=Math.max(t,this.curScrollIdx),r=i;r<=a;r++)r!=this.curScrollIdx&&this.mapGroup[r].setVisible(!0);this.curScrollIdx=t,this.mapGroup.forEach((function(e,i){s.scene.tweens.killTweensOf(e),s.scene.tweens.add({targets:e,x:e.x-s.mapGroup[t].x,duration:n,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){s.setVisibleListContainer(!1,0,s.mapGroup.length-1),t!=i&&e instanceof Phaser.GameObjects.Container&&(e.kill(),s.removeMapGroupContainer(e))}})})),this.pagination.selectPage(t,n);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createBackground(),this.createTitle(),this.createMapGroupContainers(),this.createScrollEventContainer(),this.createPagination(),this.createCloseButton()},n.createBackground=function(){this.background=this.scene.add.image(0,0,ie.Z.JOURNEY_BACKGROUND.KEY),this.background.setDefaultWorldSize(),this.add(this.background),this.updateBackgroundSize()},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(38),text:this.scene.lang.Text.journey,origin:{x:.5,y:.5}});this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-2)},n.createCloseButton=function(){var e=this;this.closeButton=new Hc.Z(this.scene,_R,MR.CLOSE_BUTTON,100/3,104/3),this.closeButton.setName("Close"),this.add(this.closeButton),Phaser.Display.Align.In.TopRight(this.closeButton,this,-5,-5),this.closeButton.onClick=function(){e.scene.screen.close(e.name),e.closeButton.setDisabled(!0)}},n.createMapGroupContainers=function(){this.curScrollIdx=0,this.mapGroup=[];for(var e=this.scene.journeyDataService.getTotalPages(),t=this.scene.journeyDataService.getGroupedJourneyScreenData(),n=t.blockPayloads,i=t.currentGroupIndex,a=n.slice(0,i+1),r=0;r<e;r++){var s=this.scene.add.container(0,0);s.setSize(this.width,this.height),s.kill();var o=new Array(3).fill(NR.Lock);r<=a.length-1&&(o=a[r].map((function(e){var t=e.progressBar;return t?t.lock?NR.Lock:t.currentProgress==t.maxProgress?NR.Finished:NR.InProgress:NR.Lock}))),s.setData("mapStatus",o),this.add(s),this.mapGroup.push(s)}this.alignMapGroup()},n.createScrollEventContainer=function(){var e=this.scene.add.container(0,0);this.add(e),e.setSize(this.width,this.height),Phaser.Display.Align.In.Center(this,e),this.scrollEventContainer=e},n.createPagination=function(){var e=this.scene.journeyDataService.getTotalPages(),t=new VO(this.scene,e);this.add(t),Phaser.Display.Align.In.BottomCenter(t,this,0,-15),this.pagination=t},n.alignMapGroup=function(){var e=this;this.mapGroup.forEach((function(t,n){t.setX(n*e.scene.gameZone.width)}))},n.updateBackgroundSize=function(){var e=this.scene.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.scene.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var a=this.background,r=a.scaleX,s=a.scaleY;"height"===i?this.background.setScale(s):this.background.setScale(r)},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),ZR=GameCore.layoutInitializer.isLandscape?CR:GR,FR=n(100),UR=function(e){function t(t){var n;return(n=e.call(this,t)||this).scale=void 0,n.prevRotation=0,n.rotateSpeed=.01,n.angle=0,n.rotateSpeed=.01*Math.random(),n}(0,s.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateScale(),this.updateVelocity(),this.prevRotation+=this.rotateSpeed,this.rotation=this.prevRotation,a},n.setScale=function(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max);var t=Math.random()>.5?1:-1;this.rotateSpeed=.05*this.scale*(Math.random()/2+.5)*t},n.easeInCubic=function(e){return e*e*e},n.updateScale=function(){var e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)},n.updateVelocity=function(){this.velocityX+=Phaser.Math.Between(-1,1)},t}(Phaser.GameObjects.Particles.Particle),WR=UR,HR=Wi.Z.DEFAULT,YR=HR.KEY,KR=HR.FRAME,zR="opening",VR="opened",jR="closing",XR="closed",qR=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.ray=void 0,n.glow=void 0,n.glow2=void 0,n.glowTween=void 0,n.glowTween2=void 0,n.levelCurveTextAnimation=void 0,n.completeCurveTextAnimation=void 0,n.fallingStarSparkle=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.createRayEffect(),n.createGlowEffect(),n.createGlow2Effect(),n.createLevelCurveText(),n.createCompleteCurveText(),n.createParticles(),n.scene.add.existing((0,fc.Z)(n)),n.levelCurveTextAnimation.setAlpha(0),n.completeCurveTextAnimation.setAlpha(0),n.glow.setAlpha(0),n.setInteractive({useHandCursor:!0}),n}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e,t;this.glow.setAlpha(0),this.glow2.setAlpha(0),this.ray.setAlpha(0),null==(e=this.glowTween)||e.remove(),null==(t=this.glowTween2)||t.remove()},n.processStep=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state!=jR){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.openContainer(),e.abrupt("return",new Promise((function(e){t.on("closed",e)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.revive(),this.setAlpha(1),this.setScale(1),this.state=zR,this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.runGlowRotationAnim(),this.fallingStarSparkle.run(2,0,-50,340,120),e.next=9,this.processStep((function(){return t.runTextEntranceAnim()}));case 9:return this.state=VR,e.next=12,this.processStep((function(){return(0,dl.Z)(t.scene,1e3)}));case 12:return e.next=14,this.processStep((function(){return t.runTextExitAnim()}));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnim=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.levelCurveTextAnimation.playEntranceAnimation(!0),e.next=3,(0,dl.Z)(this.scene,250);case 3:return e.next=5,this.completeCurveTextAnimation.playEntranceAnimation(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=jR,t=this.levelCurveTextAnimation.playExitAnimation(),n=this.completeCurveTextAnimation.playExitAnimation(),i=this.scene.tweens.add({targets:[this],alpha:0,duration:500,delay:800,onStart:function(){a.fallingStarSparkle.stop()}}).waitForCompletion(),e.next=6,Promise.all([t,n,i]);case 6:this.state=XR,this.emit("closed");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowRotationAnim=function(){this.scene.tweens.add({targets:[this.glow,this.glow2,this.fallingStarSparkle],duration:1500,alpha:.9}),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:24e3,repeat:-1,props:{angle:360}}),this.glowTween2=this.scene.tweens.add({targets:[this.glow2],duration:8e4,repeat:-1,props:{angle:360}})},n.createRayEffect=function(){var e=this.scene.make.image({key:YR,frame:KR.EFFECTS.LEVEL_COMPLETE.RAY,y:-10});e.setWorldSize(388,356.5),this.add(e),this.ray=e},n.createGlowEffect=function(){var e=this.scene.make.image({key:YR,frame:KR.EFFECTS.LEVEL_COMPLETE.GLOW_1,y:-10});e.setWorldSize(236.5,236),this.add(e),this.glow=e},n.createGlow2Effect=function(){var e=this.scene.make.image({key:YR,frame:KR.EFFECTS.LEVEL_COMPLETE.GLOW_2,y:-10});e.setWorldSize(192.5,190),this.add(e),this.glow2=e},n.createLevelCurveText=function(){var e=new Lf(this.scene,this.scene.lang.Text.level),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-1500),t.setLetterSpacing(-1),t.setFontSize(this.scene.fontSize(60)),this.add(e),this.levelCurveTextAnimation=e,this.levelCurveTextAnimation.curveText.setPosition(0,-30)},n.createCompleteCurveText=function(){var e=new Lf(this.scene,this.scene.lang.Text.complete),t=e.curveText;t.setOrigin(.5,.8),t.setRadius(-1500),t.setLetterSpacing(-1),t.setFontSize(this.scene.fontSize(60)),this.add(e),this.completeCurveTextAnimation=e,this.completeCurveTextAnimation.curveText.setPosition(0,30)},n.createParticles=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new FR.Z(this.scene,t,n.EFFECTS.LEVEL_COMPLETE.STAR,{frame:n.EFFECTS.LEVEL_COMPLETE.STAR,particleClass:WR,lifespan:{min:1200,max:1800},scale:{min:.01,max:.015}});this.add(i),this.fallingStarSparkle=i},t}(Phaser.GameObjects.Container),JR=Wi.Z.DEFAULT,QR=JR.KEY,$R=JR.FRAME,eB=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.glow=void 0,n.light1=void 0,n.light2=void 0,n.curveTextAnimation=void 0,n.levelText=void 0,n.coin=void 0,n.coinText=void 0,n.adsIcon=void 0,n.starContainer=void 0,n.buttonFxImage=void 0,n.tapToCollectText=void 0,n.tapToCollectButton=void 0,n.popupContents=[],n.emitter=void 0,n.glowTween=void 0,n.light1Anim=void 0,n.light2Anim=void 0,n.lightEffect=void 0,n.adsButtonEffect=void 0,n.scene=t;var i=n.scene.gameZone,a=i.width,r=i.height;return n.setSize(a,r),n.create(),n.alignItems(),t.add.existing((0,fc.Z)(n)),n.hideItems(),n}(0,s.Z)(t,e);var n=t.prototype;return n.setLevel=function(e){this.levelText.setText(this.scene.lang.Text.level+" "+e)},n.setTotalCoins=function(e){this.coinText.setText(e.toString())},n.hideItems=function(){this.curveTextAnimation.setAlpha(0),this.popupContents.forEach((function(e){e.setAlpha(0)})),this.starContainer.setAlpha(0),this.buttonFxImage.setAlpha(0),this.glow.setAlpha(0),this.light1.setAlpha(0),this.light2.setAlpha(0),this.stopAnimation()},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.revive(),this.setAlpha(1),this.setScale(1),this.runGlowRotationAnim(),this.runLightRotationAnim(),e.next=8,this.runPopupContentsEntranceAnimation();case 8:this.runEffects(),this.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.OPEN_WIN_SCREEN);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.hideItems(),this.stopAnimation()},n.runPopupContentsEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.curveTextAnimation.playEntranceAnimation(),this.adsIcon.setVisible(!1),this.popupContents.forEach((function(e,i){if(e!=n.glow){var a=e.scale,r=n.scene.tweens.add({targets:e,alpha:{from:0,start:0,to:1},scale:{from:0,start:0,to:a},delay:50*i,duration:500,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();t.push(r)}})),e.next=6,Promise.all(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEffects=function(){var e,t,n;null==(e=this.emitter)||e.start(),this.starContainer.setAlpha(1),null==(t=this.lightEffect)||t.start(),null==(n=this.adsButtonEffect)||n.remove(),this.adsButtonEffect=this.scene.tweens.add({targets:this.buttonFxImage,alpha:{from:0,to:1},duration:1500,repeat:-1,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut})},n.stopAnimation=function(){var e,t,n,i,a,r,s,o,c,h;null==(e=this.emitter)||e.stop(),null==(t=this.emitter)||t.killAll(),null==(n=this.glowTween)||n.stop(),null==(i=this.glowTween)||i.remove(),null==(a=this.light1Anim)||a.stop(),null==(r=this.light1Anim)||r.remove(),this.light1.setAngle(0),this.light1.setScale(1/GameCore.ImageScale),null==(s=this.light2Anim)||s.stop(),null==(o=this.light2Anim)||o.remove(),this.light2.setAngle(0),this.light2.setScale(1/GameCore.ImageScale),null==(c=this.lightEffect)||c.stop(),null==(h=this.adsButtonEffect)||h.stop()},n.runGlowRotationAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glow.setAlpha(.5),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:2e3,repeat:-1,props:{alpha:{from:.5,to:.8,yoyo:!0}}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runLightRotationAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.light1Anim)||t.remove(),null==(n=this.light2Anim)||n.remove(),i=1/GameCore.ImageScale,this.light1.kill(),this.light2.kill(),this.light1Anim=this.scene.tweens.add({targets:[this.light1],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:360},alpha:{from:.5,to:1,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}}),this.light2Anim=this.scene.tweens.add({targets:[this.light2],duration:Phaser.Math.Between(15e3,2e4),repeat:-1,props:{angle:{from:0,start:0,to:-360},scale:{from:i,to:1.075*i,yoyo:!0,duration:800,ease:Phaser.Math.Easing.Sine.InOut}}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){this.glow.setPosition(0,-29),this.light1.setPosition(0,-29),this.light2.setPosition(0,-29),this.coin.setPosition(0,-29),this.curveTextAnimation.curveText.setPosition(0,-160),this.levelText.setPosition(0,-120),this.coinText.setPosition(0,18),this.adsIcon.setPosition(0,100),Phaser.Display.Align.In.BottomCenter(this.tapToCollectText,this,0,-40)},n.create=function(){this.createGlowEffect(),this.createCurveTextAnimation(),this.createLevelText(),this.createCoin(),this.createStarParticle(),this.createCoinText(),this.createTapToCollectButton(),this.createAdsIcon()},n.createGlowEffect=function(){var e=this.scene.make.image({key:QR,frame:$R.EFFECTS.GLOW_2});e.setDefaultWorldSize(),this.add(e);var t=this.scene.add.image(0,0,QR,$R.EFFECTS.LIGHT_X);t.setDefaultWorldSize(),this.add(t);var n=this.scene.add.image(0,0,QR,$R.EFFECTS.LIGHT_X);n.setDefaultWorldSize(),n.setAngle(90),this.add(n),this.glow=e,this.light1=t,this.light2=n},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,QR,$R.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(100,220/3),t.setPosition(0-t.width/2,-29-t.height/2);var n=1/GameCore.ImageScale;this.emitter=e.createEmitter({frame:$R.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1.5*n})},particleClass:Db.Z,quantity:1})},n.createCurveTextAnimation=function(){var e=new Lf(this.scene,this.scene.lang.Text.wellDone2),t=e.curveText;t.setFonts(Pc.ZP.STYLE.KEY),t.setOrigin(.5,.8),t.setRadius(-1e3),t.setLetterSpacing(0),t.setFontSize(this.scene.fontSize(50)),this.add(e),this.curveTextAnimation=e},n.createLevelText=function(){var e=new jp(this.scene,{text:"Level 2048",fontSize:this.scene.fontSize(30),strokeColor:0,strokeThickness:2.7,strokeOffset:{y:.5},letterSpacingExtra:.3,strokeAlpha:.4});this.add(e),this.levelText=e,this.popupContents.push(e)},n.createCoin=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.add.image(0,0,t,n.ICONS.COIN);i.setDefaultWorldSize(),this.add(i),this.coin=i,this.popupContents.push(i,this.glow,this.light1,this.light2)},n.createCoinText=function(){var e=new jp(this.scene,{text:"500",fontSize:this.scene.fontSize(34),strokeColor:0,strokeThickness:2.7,strokeOffset:{y:.5},letterSpacingExtra:.3,strokeAlpha:.4});this.add(e),this.coinText=e,this.popupContents.push(e)},n.createAdsIcon=function(){var e=Wi.Z.DEFAULT,t=e.KEY,n=e.FRAME,i=new Kp.Z(this.scene,238/3,217/3);this.add(i);var a=this.scene.add.image(0,0,t,n.ICONS.BONUS);a.setDefaultWorldSize(),i.add(a),this.adsIcon=i,this.createLightEffect(),this.createButtonEffect(),this.popupContents.push(a)},n.createTapToCollectButton=function(){var e=new vT(this.scene);e.text.setText("Tap to collect"),e.setName("TapToCollect"),this.add(e),this.tapToCollectButton=e,this.tapToCollectText=this.tapToCollectButton.text,this.popupContents.push(this.tapToCollectText)},n.createLightEffect=function(){var e=this.scene.add.container(0,-22);this.adsIcon.add(e),this.starContainer=e;var t=this.scene.add.image(0,0,QR,$R.EFFECTS.BONUS_STAR);t.setDefaultWorldSize(),t.setAlpha(0),e.add(t),this.lightEffect=new Hw([{target:e,rotate:[{value:-24.94},{time:1,value:-62.8},{time:1.6667,value:-24.94},{time:2.6667,value:-62.8},{time:3.3333,value:-24.94},{time:4.3333,value:-62.8}],scale:[{x:0,y:0,curve:[.032,.593,.335,1,.032,.593,.335,1]},{time:.5,curve:[.701,1,.835,.333,.701,1,.835,.333]},{time:1,x:0,y:0,curve:"stepped"},{time:1.6667,x:0,y:0,curve:[1.699,.593,2.001,1,1.699,.593,2.001,1]},{time:2.1667,curve:[2.368,1,2.501,.333,2.368,1,2.501,.333]},{time:2.6667,x:0,y:0,curve:"stepped"},{time:3.3333,x:0,y:0,curve:[3.366,.593,3.668,1,3.366,.593,3.668,1]},{time:3.8333,curve:[4.034,1,4.168,.333,4.034,1,4.168,.333]},{time:4.3333,x:0,y:0}]},{target:t,rgba:[{color:"ffffffff"}]}]),this.lightEffect.setLoop(-1)},n.createButtonEffect=function(){var e=this.scene.add.image(-9,-10,QR,$R.EFFECTS.BONUS_LIGHT);e.setDefaultWorldSize(),e.setAlpha(0),this.adsIcon.add(e),this.buttonFxImage=e},t}(Phaser.GameObjects.Container),tB=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).levelCompleteContainer=void 0,s.wellDoneContainer=void 0,s.onClaim=void 0,s.totalClaimedCoins=void 0,s.coinsClaimed=void 0,s.onEntranceCompleted=function(){},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.wellDoneContainer.kill(),s.wellDoneContainer.setAlpha(0),s.wellDoneContainer.setScale(0),s.wellDoneContainer.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.handleClaim();case 2:case"end":return e.stop()}}),e)}))))},s.runAnimationCounter=function(){var e=s.countTotalCoin({startNumber:0,endNumber:s.totalClaimedCoins});return Promise.all([e])},s.handleWatchAdsClaim=(0,r.Z)(c().mark((function e(){var t,n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.scene.gameUI.coinBarButton.setDisabled(!0),s.setButtonsDisable(!0),t=s.totalClaimedCoins,n=1,i=0,e.next=7,s.scene.showRewardedVideoAsync();case 7:return(a=e.sent)&&(i=t*n,s.scene.analytics.event(te._.LUCKY_REWARD,{value:n})),s.totalClaimedCoins=t+i,e.next=12,s.handleClaim(a?0:400);case 12:case"end":return e.stop()}}),e)}))),s.handleClaim=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),!s.coinsClaimed){e.next=3;break}return e.abrupt("return");case 3:if(s.coinsClaimed=!0,s.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.BUTTON_CLICK),!(t>0)){e.next=8;break}return e.next=8,(0,le.qZ)(t);case 8:return e.next=10,s.scene.gameUI.showCoin();case 10:return s.setButtonsDisable(!0),s.scene.gameUI.coinBarButton.setDisabled(!0),e.next=14,s.claim(s.totalClaimedCoins);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.claim=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.wellDoneContainer.curveTextAnimation.playExitAnimation(),s.scene.tweens.add({targets:[s.wellDoneContainer],alpha:{value:0,duration:300},duration:400,ease:Phaser.Math.Easing.Sine.In}),s.scene.rewardManager.rewardCoin(t),n=s.scene.gameZone,i=n.width,a=n.height,s.scene.rewardManager.coinAnimationPool.runAnimationRewardCoinAsync(14,i/2,a/2).then((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.gameUI.coinBarButton.setDisabled(!0),s.wellDoneContainer.runExitAnimation(),s.onClaim();case 3:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.totalClaimedCoins=0,s.setDepth(ce.Ks.POPUP),s.create(),s.background.setInteractive({useHandCursor:!0}),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.listenEvents(),s.wellDoneContainer.kill(),s.wellDoneContainer.setAlpha(0),s.wellDoneContainer.setScale(0),s}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this.wellDoneContainer,t=e.adsIcon,n=e.tapToCollectButton;t.onClick=this.handleWatchAdsClaim,n.onClick=this.handleClaim},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.setButtonsDisable(!0),this.scene.gameUI.coinBarButton.setDisabled(!0),this.scene.gameUI.coinBarButton.setDepth(Fr.Z.PRIORITY),this.updateVictoryStats(),this.levelCompleteContainer.open(),this.scene.gameUI.hideUI(),this.scene.gameUI.hideLife(),t.next=10,this.runEntranceAnimation();case 10:return t.next=12,this.levelCompleteContainer.runEntranceAnimation();case 12:return this.levelCompleteContainer.kill(),t.next=15,this.scene.handleShowInterstitialAd();case 15:return t.next=17,this.wellDoneContainer.runEntranceAnimation();case 17:(0,dl.Z)(this.scene,150).then((function(){i.setButtonsDisable(!1),i.runAnimationCounter()}));case 18:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.runExitAnimation();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list,n=t.level,i=void 0===n?0:n,a=t.levelCollectedCoin,r=void 0===a?0:a,s=t.levelClearedCoin,o=void 0===s?0:s,c=t.onClaim,h=void 0===c?function(){}:c;this.coinsClaimed=!1,this.totalClaimedCoins=r+o,this.onClaim=h,this.wellDoneContainer.setLevel(i),this.wellDoneContainer.setTotalCoins(0)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted}).waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.countTotalCoin=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onUpdate=function(e){var t=Math.floor(e.getValue());n.wellDoneContainer.setTotalCoins(t)},e.abrupt("return",this.runCountingAnimation(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runCountingAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onStart=function(){n.scene.time.addEvent({repeat:4,delay:200,callback:function(){n.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.COUNT_COINS)}})},e.abrupt("return",_b(this.scene,t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setButtonsDisable=function(e){var t=this.wellDoneContainer,n=t.adsIcon,i=t.tapToCollectButton;n.setDisabled(e),i.setDisabled(e),n.setAlpha(1),i.setAlpha(1)},n.create=function(){this.createLevelCompleteContainer(),this.createWellDoneContainer()},n.createLevelCompleteContainer=function(){this.levelCompleteContainer=new qR(this.scene),this.add(this.levelCompleteContainer)},n.createWellDoneContainer=function(){this.wellDoneContainer=new eB(this.scene),this.add(this.wellDoneContainer)},t}(GameCore.Screen),nB=GameCore.layoutInitializer.isLandscape?NI:tB,iB=Wi.Z.DEFAULT,aB=iB.KEY,rB=iB.FRAME,sB=function(e){function t(t,n,i){var a,r;(r=e.call(this,t,n,i)||this).folderImage=void 0,r.comingSoonText=void 0,r.glow=void 0,r.starEmitter=void 0,r.glowTween=void 0,r.folder=void 0,r.nextJourneyText=void 0;var s=r.scene.gameZone,o=s.width,c=s.height;return r.setSize(o,c),r.create(),null==(a=r.glowTween)||a.remove(),r.align(),r.setHiddenState(),r.setInteractive({useHandCursor:!0}),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runGlowRotationAnim(),null==(t=this.starEmitter)||t.start(),e.next=4,this.runEntranceAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runExitAnimation();case 2:this.setHiddenState();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setHiddenState=function(){var e,t,n;null==(e=this.glowTween)||e.remove(),this.glow.setAlpha(0),this.glow.setScale(0),this.folder.setAlpha(0),this.folder.setScale(0),this.comingSoonText.setAlpha(0),this.comingSoonText.setY(102),this.comingSoonText.setScale(0),null==(t=this.starEmitter)||t.stop(),null==(n=this.starEmitter)||n.killAll()},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setAlpha(1),t=this.runGlowEntranceAnimation(),n=this.runFolderEntranceAnimation(),i=this.runTextEntranceAnimation(),e.next=6,Promise.all([t,n,i]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,n=this.scene.tweens.add({targets:[this.glow],alpha:{from:0,start:0,to:.8,ease:Phaser.Math.Easing.Sine.In,duration:150},scale:{from:t,start:t,to:2*t,duration:500,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}}).waitForCompletion(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFolderEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.tweens.add({targets:[this.folder],alpha:{from:1,start:1,to:1,ease:Phaser.Math.Easing.Sine.In,duration:150},scale:{from:0,start:0,to:1,duration:500,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[1,.5]}}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextEntranceAnimation=function(){var e=1/GameCore.ImageScale;return this.scene.tweens.add({targets:[this.comingSoonText],y:{from:72,start:72,to:102,ease:Phaser.Math.Easing.Expo.Out},alpha:{from:0,start:0,to:1},scale:{from:.8*e,start:.8*e,to:1*e,ease:Phaser.Math.Easing.Expo.Out},duration:200,delay:100}).waitForCompletion()},n.runGlowRotationAnim=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.glowTween)||t.remove(),this.glowTween=this.scene.tweens.add({targets:[this.glow],duration:5e4,repeat:-1,props:{angle:{value:360,ease:Phaser.Math.Easing.Linear}},onStart:function(){n.glow.setAngle(0)}});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.runGlowExitAnimation(),n=this.runFolderExitAnimation(),i=this.runTextExitAnimation(),e.next=5,Promise.all([t,n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runGlowExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,n=this.scene.tweens.add({targets:[this.glow],alpha:{from:.8,start:.8,to:0,duration:150},scale:{from:2*t,start:2*t,to:t,ease:Phaser.Math.Easing.Back.In},duration:300}).waitForCompletion(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFolderExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.tweens.add({targets:[this.folder],alpha:{from:1,start:1,to:0,delay:150},scale:{from:1,start:1,to:0,ease:Phaser.Math.Easing.Back.In,easeParams:[1.5]},duration:300}).waitForCompletion(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runTextExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1/GameCore.ImageScale,102,n=this.scene.tweens.add({targets:[this.comingSoonText],y:{from:102,start:102,to:72,ease:Phaser.Math.Easing.Expo.In},alpha:{from:1,start:1,to:0},scale:{from:t,start:t,to:.8*t,ease:Phaser.Math.Easing.Expo.In},duration:200}).waitForCompletion(),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.align=function(){Phaser.Display.Align.In.Center(this.glow,this,0,0),Phaser.Display.Align.In.Center(this.folder,this,0,-10),Phaser.Display.Align.In.Center(this.comingSoonText,this,-12,102)},n.create=function(){this.createGlow(),this.createFolderImage(),this.createText(),this.createSparkleParticle()},n.createGlow=function(){this.glow=this.scene.add.image(0,0,aB,rB.NEXT_JOURNEY_SCREEN.GLOW),this.glow.setDefaultWorldSize(),this.add(this.glow)},n.createFolderImage=function(){this.folder=this.scene.add.container(),this.add(this.folder),this.folderImage=this.scene.add.image(0,0,aB,rB.NEXT_JOURNEY_SCREEN.PHOTOS),this.folderImage.setDefaultWorldSize(),this.folder.add(this.folderImage),this.nextJourneyText=new jp(this.scene,{text:"Next Journey",fontSize:this.scene.fontSize(17),fillColor:11102533}),this.nextJourneyText.setPosition(3,-57),this.nextJourneyText.setAngle(4),this.folder.add(this.nextJourneyText)},n.createText=function(){this.comingSoonText=this.scene.add.image(0,0,aB,rB.NEXT_JOURNEY_SCREEN.TEXT),this.comingSoonText.setDefaultWorldSize(),this.add(this.comingSoonText)},n.createSparkleParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,aB,rB.NEXT_JOURNEY_SCREEN.SPARKLE);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(300,250),t.setPosition(0-t.width/2,-t.height/2);var n=new Phaser.Geom.Rectangle;n.setSize(230,150),n.setPosition(0-n.width/2,-n.height/2);var i=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:rB.NEXT_JOURNEY_SCREEN.SPARKLE,emitZone:{source:t,type:"random"},deathZone:{source:n,type:"onEnter"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-12,max:-15},lifespan:{min:1e3,max:1500},scale:{min:.03,max:.07},emitCallback:function(e){e.setScale({min:i/2,max:1*i})},particleClass:Db.Z,quantity:5})},t}(Phaser.GameObjects.Container),oB=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).nextJourneyContainer=void 0,s.close=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.nextJourneyContainer.close(),(0,dl.Z)(s.scene,250).then((function(){s.runExitAnimation()}));case 2:case"end":return e.stop()}}),e)}))),s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.nextJourneyContainer.setHiddenState()},s.setDepth(ce.Ks.POPUP),s.createNextJourneyContainer(),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.nextJourneyContainer.open();case 4:this.nextJourneyContainer.once(Phaser.Input.Events.POINTER_DOWN,(function(){return i.close()}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),e.abrupt("return",this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]}).waitForCompletion());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},n.createNextJourneyContainer=function(){this.nextJourneyContainer=new sB(this.scene,0,0),this.add(this.nextJourneyContainer)},t}(GameCore.Screen),cB=Wi.Z.RACE,hB=cB.KEY,uB=cB.FRAME,lB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.Center(this.step1,this,-190,60),Phaser.Display.Align.In.Center(this.step2,this,0,60),Phaser.Display.Align.In.Center(this.step3,this,210,60),Phaser.Display.Align.In.Center(this.arrow1,this,-105,10),Phaser.Display.Align.In.Center(this.arrow2,this,105,10)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[uB.INTRO.ITEM_1,uB.INTRO.ITEM_2,uB.INTRO.ITEM_3],n=["Beat levels!","Move your boat forward!","Get prizes!"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,hB,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,hB,uB.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),dB=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new lB(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),pB=Wi.Z.RACE,fB=pB.KEY,mB=pB.FRAME,gB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-90,-50),Phaser.Display.Align.In.Center(this.step2,this,70,40),Phaser.Display.Align.In.Center(this.step3,this,-80,190),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,110),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[mB.INTRO.ITEM_1,mB.INTRO.ITEM_2,mB.INTRO.ITEM_3],n=["Beat levels!","Move your boat forward!","Get prizes!"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,fB,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[mB.INTRO.ARROW_RIGHT,mB.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var a=e.scene.add.image(0,0,fB,t[i]);return a.setDefaultWorldSize(),a}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),vB=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new gB(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),yB=GameCore.layoutInitializer.isLandscape?dB:vB,EB=function(e){function t(t){var n;return(n=e.call(this,t)||this).txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(84,18)},n.createText=function(){this.txt=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"23:59:59",origin:{x:.5,y:.5}}),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new CB(this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),CB=function(){function e(e){this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.timerPanel=e,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",11),t.countdownTimer.remove();else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),AB=Wi.Z.RACE,wB=AB.KEY,SB=AB.FRAME,bB=function(e){function t(t){var n;return(n=e.call(this,t,{key:wB,backgroundFrame:SB.BUTTON.BASE,buttonFrame:SB.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.scene=t,n.createText(),n.setSize(n.width,n.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createText=function(){var e=new jp(this.scene,{text:"START",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},t}(tT),TB=bB,xB=Wi.Z.RACE,PB=xB.KEY,kB=xB.FRAME,IB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.closeButton=void 0,i.startButton=void 0,i.scene=t,i.screen=n,i.create(),i.alignItems(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.closeContainer=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setAlpha(1),this.updateDescription(),this.updateData();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.updateDescription=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.description.setText("Be the first to beat "+e+" levels!")},n.alignItems=function(){Phaser.Display.Align.In.TopCenter(this.header,this,0,22),Phaser.Display.Align.In.TopCenter(this.description,this,0,-38),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-25,-21),Phaser.Display.Align.In.TopRight(this.closeButton,this,-20,-23),Phaser.Display.Align.In.BottomCenter(this.startButton,this,0,22)},n.create=function(){this.createBackground(),this.createHeader(),this.createDescription(),this.createButtons()},n.createBackground=function(){var e=this.scene.world.getWorldSize().width,t=e>=446?426:e-20,n=this.scene.add.image(0,0,PB,kB.INVITATION.POPUP);n.setDefaultWorldSize(),this.add(n),n.setScale(n.scale*t/426),this.setSize(n.displayWidth,n.displayHeight)},n.createTimePanel=function(){this.timerPanel=new EB(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,PB,kB.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,PB,kB.MAIN.HEADER_BACKGROUND);e.setDefaultWorldSize(),this.header.add(e);var t=new Pf(this.scene);t.setText("Offshore Racers"),t.setFontSize(25.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-2.5),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(15),text:"Be the first to beat 15 levels!",origin:{x:.5,y:.5}});e.setTint(33447),this.add(e),this.description=e},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createStartButton()},n.createInformationButton=function(){var e=new iv.Z(this.scene,{key:PB,frame:kB.INVITATION.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new iv.Z(this.scene,{key:PB,frame:kB.INVITATION.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createStartButton=function(){var e=new TB(this.scene);e.button.setName("Start"),this.add(e),this.startButton=e},t}(Phaser.GameObjects.Container),OB=IB,RB=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.offshoreRaceInvitationContainer=void 0,s.previousScreen=void 0,s.screenOpened=void 0,s.isStartingRace=void 0,s.handleInformationButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=s.previousScreen===ce.o4.DASHBOARD_SCREEN)&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),e.next=4,s.offshoreRaceInvitationContainer.closeContainer();case 4:return e.next=6,s.scene.screen.openAsync(ce.o4.OFFSHORE_RACE.INTRO_SCREEN);case 6:t&&s.scene.screen.open(ce.o4.DASHBOARD_SCREEN),s.scene.screen.bringToTop(ce.o4.OFFSHORE_RACE.INVITATION_SCREEN),s.offshoreRaceInvitationContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),s.handleCloseButtonClick=function(){s.scene.screen.close(s.name)},s.handlePlayButtonClick=function(){s.isStartingRace||(s.isStartingRace=!0,s.previousScreen=void 0,s.scene.screen.close(s.name),s.scene.offshoreRace.startRace(),(0,dl.Z)(s.scene,300).then((function(){s.scene.openOffshoreRaceMainScreen({shouldPlayEntranceAnimation:!0,previousScreen:ce.o4.DASHBOARD_SCREEN}),s.isStartingRace=!1})))},s.close=function(){s.background.off(Phaser.Input.Events.POINTER_DOWN),s.runExitAnimation()},s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.screenOpened=!1,s.scene.gameUI.coinBarButton.setDisabled(!1),s.previousScreen&&s.scene.screen.open(s.previousScreen)},s.scene=t,s.create(),s.listenEvents(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createRaceInvitationContainer()},n.listenEvents=function(){var e=this.offshoreRaceInvitationContainer,t=e.informationButton,n=e.closeButton,i=e.startButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick},n.createRaceInvitationContainer=function(){this.offshoreRaceInvitationContainer=new OB(this.scene,this),this.offshoreRaceInvitationContainer.setInteractive(),this.add(this.offshoreRaceInvitationContainer),Phaser.Display.Align.In.Center(this.offshoreRaceInvitationContainer,this,0,0)},n.open=function(t){if(!this.screenOpened){this.screenOpened=!0,e.prototype.open.call(this,t);var n=(null!=t?t:{previousScreen:ce.o4.DASHBOARD_SCREEN}).previousScreen;this.previousScreen=n,this.offshoreRaceInvitationContainer.open(),this.runEntranceAnimation()}},n.updateTimer=function(){var e=this.scene.offshoreRace,t=e.isFinished();this.offshoreRaceInvitationContainer.timerPanel.timerLogic.setRemainingTime(t?0:e.getRemainingTime())},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.offshoreRaceInvitationContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.offshoreRaceInvitationContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),BB=RB,DB=Wi.Z.RACE,LB=DB.KEY,_B=DB.FRAME,MB=function(e){function t(t,n){var i;return(i=e.call(this,t,{key:LB,background:n?_B.MAIN.PLAYER.AVATAR_BACKGROUND:_B.MAIN.OPPONENT.AVATAR_BACKGROUND,frame:_B.BLANK,width:29.333333333333332,height:29.333333333333332,loadDelay:1e3})||this).avtFrame.kill(),i}(0,s.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){void 0===i&&(i=70),n&&(t===this.payload.id&&n===this.payload.url||e.prototype.loadPhoto.call(this,t,n,i))},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,a=n.height,r=Math.min(i,a);this.photo.setWorldSize(r,r)},n.showDefaultPhoto=function(){this.loadPhoto(ie.Z.AVATAR.KEY,ie.Z.AVATAR.FILE)},t}(Ic),NB=MB,GB=Wi.Z.RACE,ZB=GB.KEY,FB=GB.FRAME,UB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.avatar=void 0,i.avatarBorder=void 0,i.racerName=void 0,i.scene=t,i.isPlayer=n,i.createAvatar(),i.createAvatarBorder(),i.createName(),i.alignItems(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateRacerInfo=function(e,t,n,i){this.setRacerName(n),i&&this.avatar.loadPhoto(t,i)},n.setRacerName=function(e){var t=GameCore.Utils.String.removeDiacritics(e);this.racerName.setText(t);if(this.racerName.width>38)for(var n=1;n<t.length;n++)if(this.racerName.setText(t.substring(0,n)+".."),this.racerName.width>38){this.racerName.setText(t.substring(0,n-1)+"..");break}this.racerName.setX(4+(this.avatarBorder.width/2-this.avatar.displayWidth/2)/2),this.racerName.setY(-.5)},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.avatar,this,-2,-.5)},n.createAvatar=function(){var e=new NB(this.scene,this.isPlayer);e.setSize(88/3,91/3),e.showDefaultPhoto(),this.add(e),this.avatar=e},n.createAvatarBorder=function(){var e=this.isPlayer?FB.MAIN.PLAYER:FB.MAIN.OPPONENT,t=this.scene.add.image(0,0,ZB,e.AVATAR_BORDER);t.setDefaultWorldSize(),this.add(t),this.avatarBorder=t,this.setSize(t.width,t.height)},n.createName=function(){var e=new jp(this.scene,{text:"Player",fontSize:this.scene.fontSize(10),strokeColor:12927496,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9}),t=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(10),text:"Opponent",origin:{x:.5,y:.5}});t.setTint(33447),this.isPlayer?(e.setVisible(!0),t.setVisible(!1)):(e.setVisible(!1),t.setVisible(!0)),this.racerName=this.isPlayer?e:t,this.add(this.racerName);var n=this.isPlayer?"Lilly":"Richard";this.setRacerName(n)},t}(Phaser.GameObjects.Container),WB=UB,HB=Wi.Z.RACE,YB=HB.KEY,KB=HB.FRAME,zB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boat=void 0,i.text=void 0,i.speechBubble=void 0,i.idleAnimation=void 0,i.scene=t,i.isPlayer=n,i.createBoat(),i.createSpeechBubble(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.boat.setAlpha(0),this.speechBubble.setAlpha(0),this.speechBubble.setScale(1),n=this.runBoatEntranceAnimation(t),i=this.runSpeechBubbleEntranceAnimation(t),e.next=7,Promise.all([n,i]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBoatEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.createTimeline(),i=this.boat.scaleY,n.add({targets:this.boat,scaleY:{from:i,start:i,to:.9*i},y:{from:this.boat.y,start:this.boat.y,to:this.boat.y+2},duration:200,delay:200*t,ease:Phaser.Math.Easing.Sine.In,onStart:function(){a.boat.setAlpha(1)}}),n.add({targets:this.boat,scaleY:{from:.9*i,start:.9*i,to:i},y:{from:this.boat.y+2,start:this.boat.y+2,to:this.boat.y},duration:500,ease:Phaser.Math.Easing.Sine.Out}),e.abrupt("return",n.playAndWaitForCompletion());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runSpeechBubbleEntranceAnimation=function(e){var t=this;return this.scene.tweens.add({targets:this.speechBubble,scaleX:{from:.6,start:.6,to:1},alpha:{from:0,start:0,to:1,duration:100},angle:{from:10,start:10,to:0},duration:200,delay:700+200*e,ease:Phaser.Math.Easing.Quadratic.Out,onStart:function(){t.speechBubble.setAlpha(0),t.speechBubble.scaleX=.6,t.speechBubble.setAngle(10)}})},n.runSpeechBubbleExitAnimation=function(e){return void 0===e&&(e=0),this.scene.tweens.add({targets:this.speechBubble,scale:0,delay:e,duration:200,ease:Phaser.Math.Easing.Quadratic.InOut}).waitForCompletion()},n.runRunAnimation=function(){return this.scene.tweens.add({targets:this.boat,y:this.boat.y-1,angle:{from:0,start:0,to:-3},duration:500,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()},n.runClaimAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=0),i=this.boat.x,8,a=this.scene.gameZone.width/2+t.displayWidth/2-8,r=this.scene.tweens.add({targets:this.boat,x:this.boat.x+240,delay:n,duration:600,ease:Phaser.Math.Easing.Quadratic.In,onUpdate:function(){var e=o.boat.getWorldPosition().x-o.boat.displayWidth/2,t=Phaser.Math.Clamp((a-e)/o.boat.scaleX,0,o.boat.frame.width);o.boat.setCrop(0,0,t,o.boat.frame.height)}}).waitForCompletion(),s=this.runSpeechBubbleExitAnimation(n),e.next=8,Promise.all([s,r]);case 8:this.boat.setAlpha(0),this.boat.setPosition(i,this.boat.y),this.boat.setCrop();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.stopIdleAnimation=function(){var e;return null==(e=this.idleAnimation)||e.stop(),0===this.boat.angle?Promise.resolve():this.scene.tweens.add({targets:this.boat,angle:{from:this.boat.angle,start:this.boat.angle,to:0},duration:200,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion()},n.runIdleAnimation=function(){var e;null==(e=this.idleAnimation)||e.remove();var t=Phaser.Math.Between(1500,3e3),n=Phaser.Math.Between(0,1e3);this.idleAnimation=this.scene.tweens.add({targets:this.boat,angle:{from:0,start:0,to:3},duration:t,delay:n,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut})},n.updateProgress=function(e){this.text.setText(""+e)},n.createBoat=function(){var e=this.isPlayer?KB.MAIN.PLAYER.BOAT:KB.MAIN.OPPONENT.BOAT;this.boat=this.scene.add.image(0,0,YB,e),this.boat.setDefaultWorldSize(),this.add(this.boat)},n.createSpeechBubble=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,YB,KB.MAIN.SPEECH_BUBBLE);t.setDefaultWorldSize(),t.setPosition(-28,-9),e.add(t);var n=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(13),text:"12",origin:{x:.5,y:.5}});n.setTint(33447),n.setPosition(t.x-.5,t.y-1),e.add(n),this.text=n,this.speechBubble=e},t}(Phaser.GameObjects.Container),VB=zB,jB=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.scene=t;var i=Phaser.Math.Clamp(n.scene.world.getWorldSize().width-20,340,426),a=GameCore.Utils.Number.normalizeNumber(i,340,426,160,235);return n.setSize(a,35),t.add.existing((0,fc.Z)(n)),n}return(0,s.Z)(t,e),t.prototype.getBoatPosition=function(e){var t=this.scene.offshoreRace.getRequiredLevels();return e===t?this.width/2-3:GameCore.Utils.Number.normalizeNumber(e,0,t,-this.width/2+28,this.width/2-28)},t}(Phaser.GameObjects.Container),XB=jB,qB=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.isPlayer=void 0,i.boat=void 0,i.racetrack=void 0,i.score=void 0,i.isDirty=void 0,i.scene=t,i.isPlayer=n,i.isDirty=!1,i.createRacetrack(),i.createBoat(),t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.runClaimAnimation=function(e,t){return void 0===t&&(t=0),this.boat.runClaimAnimation(e,t)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.boat.runEntranceAnimation(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateBoatBlock=function(e,t,n){if(this.score=t,n)return this.isDirty=!1,void this.boat.kill();this.boat.revive(),this.isDirty=t>e,this.boat.updateProgress(e);var i=this.racetrack.getBoatPosition(e);this.boat.setX(i)},n.animateUpdateBoatBlock=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty){e.next=2;break}return e.abrupt("return");case 2:if(this.isDirty=!1,t=this.racetrack.getBoatPosition(this.score),0!==this.score){e.next=10;break}return this.boat.setX(t),e.next=8,this.boat.stopIdleAnimation();case 8:return this.boat.runIdleAnimation(),e.abrupt("return");case 10:return e.next=12,this.boat.stopIdleAnimation();case 12:return this.boat.updateProgress(this.score),e.next=15,this.runBoatRunAnimation(t);case 15:this.boat.runIdleAnimation();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runBoatRunAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.boat.runRunAnimation(),i=this.scene.tweens.add({targets:this.boat,x:t,duration:1e3,ease:Phaser.Math.Easing.Sine.Out}).waitForCompletion(),e.next=4,Promise.all([n,i]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createRacetrack=function(){this.racetrack=new XB(this.scene),this.add(this.racetrack),this.setSize(this.racetrack.width,this.racetrack.height)},n.createBoat=function(){this.boat=new VB(this.scene,this.isPlayer),this.add(this.boat),this.boat.setY(2);var e=this.racetrack.getBoatPosition(0);this.boat.setX(e)},t}(Phaser.GameObjects.Container),JB=qB,QB=function(e){return e[e.Playing=0]="Playing",e[e.Won=1]="Won",e[e.Finished=2]="Finished",e}(QB||{}),$B=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.container=void 0,a.racerIndex=void 0,a.racerData=void 0,a.isPlayer=void 0,a.info=void 0,a.boatBlock=void 0,a.scene=t,a.container=n,a.racerIndex=i,a.isPlayer=0===i,a.create(),a.setDefaultRaceBlockData(i),a.setSize(355,a.info.height),a.alignItems(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.setDefaultRaceBlockData(this.racerData.racerIndex)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.info.setAlpha(0),n=this.runInfoEntranceAnimation(t),i=this.boatBlock.runEntranceAnimation(t),e.next=5,Promise.all([n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runInfoEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.scene.tweens.createTimeline()).add({targets:this.info,scale:{from:.6,start:.6,to:1.05},y:{from:this.info.y,start:this.info.y,to:this.info.y-2},duration:200,ease:Phaser.Math.Easing.Sine.Out,delay:200*t,onStart:function(){i.info.setAlpha(1),i.info.setScale(.6),i.setAlpha(1)}}),n.add({targets:this.info,scale:{from:1.05,start:1.05,to:1},y:{from:this.info.y-2,start:this.info.y-2,to:this.info.y},duration:350,delay:50,ease:Phaser.Math.Easing.Sine.Out}),e.abrupt("return",n.playAndWaitForCompletion());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateData=function(e){var t=0===this.racerData.racerIndex,n=this.racerData.score;this.racerData=(0,a.Z)({},e,{racerIndex:this.racerIndex,isPlayer:t}),this.info.updateRacerInfo(this.racerData.racerIndex,this.racerData.racerId,this.racerData.name,this.racerData.photo),this.boatBlock.updateBoatBlock(n,this.racerData.score||0,this.racerData.rewardClaimed)},n.playClaimAnimation=function(e){return void 0===e&&(e=0),this.racerData.rewardClaimed?Promise.resolve():(this.scene.offshoreRace.setRacerClaimReward(this.racerData.racerIndex),this.boatBlock.runClaimAnimation(this.container,e))},n.animateUpdateRacerBlock=function(){return this.boatBlock.animateUpdateBoatBlock()},n.alignItems=function(){Phaser.Display.Align.In.LeftCenter(this.info,this,-12,0),Phaser.Display.Align.In.LeftCenter(this.boatBlock,this,-105,0)},n.setDefaultRaceBlockData=function(e){this.racerData={racerIndex:e,racerId:"",name:"",photo:"",score:0,rank:e,rewardClaimed:!1,isPlayer:!1},this.boatBlock.updateBoatBlock(0,this.racerData.score||0,this.racerData.rewardClaimed)},n.create=function(){this.createInfoBlock(),this.createBoatBlock()},n.createInfoBlock=function(){this.info=new WB(this.scene,this.isPlayer),this.add(this.info)},n.createBoatBlock=function(){this.boatBlock=new JB(this.scene,this.isPlayer),this.add(this.boatBlock)},t}(Phaser.GameObjects.Container),eD=$B,tD=Wi.Z.RACE,nD=(tD.KEY,tD.FRAME,Wi.Z.DEFAULT),iD=nD.KEY,aD=nD.FRAME,rD=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.itemType=void 0,n.item=void 0,n.itemAmount=void 0,n.amount=void 0,n.scene=t,n.createItem(),n.createItemAmount(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setItemType=function(e){switch(this.itemType=e,e){case qi.COIN:this.setItemFrame(aD.REWARDS.COIN);break;case qi.UNDO:this.setItemFrame(aD.REWARDS.UNDO);break;case qi.PLUS_5_CARDS:this.setItemFrame(aD.REWARDS.PLUS_5_CARDS);break;case Ki.STORM:this.setItemFrame(aD.REWARDS.STORM);break;case Ki.SLICE:this.setItemFrame(aD.REWARDS.SLICE);break;case Ki.WILD_CARD:this.setItemFrame(aD.REWARDS.WILD_CARD)}},n.setItemAmount=function(e){if(this.amount=e,this.itemType===qi.COIN){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.itemAmount.setText(""+t),this.itemAmount.x=0}else this.itemAmount.setText("x"+e),this.itemAmount.x=this.width/2-this.itemAmount.width/2;this.itemAmount.y=this.height/2-5},n.setItemFrame=function(e){this.item.setFrame(e),this.item.setDefaultWorldSize(),this.setSize(this.item.width,this.item.height)},n.createItem=function(){var e=this.scene.add.image(0,0,iD,aD.REWARDS.COIN);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height),this.item=e},n.createItemAmount=function(){var e=new jp(this.scene,{text:"Start",fontSize:this.scene.fontSize(30),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.8});this.add(e),this.itemAmount=e},t}(Phaser.GameObjects.Container),sD=Wi.Z.DEFAULT,oD=sD.KEY,cD=sD.FRAME,hD=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.top=void 0,n.bottom=void 0,n.popupItems=[],n.itemPool=[],n.plusPool=[],n.plusTexts=[],n.isOpening=void 0,n.popupWrapper=void 0,n.scene=t,n.isOpening=!1,n.create(),n.setScale(0),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runPopupOpen=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isOpening=!0,this.setPosition(n,i),this.popupItems=this.spawnItems(t),this.alignItems(),a?this.popupWrapper.setX(-this.popupWrapper.displayWidth/2):this.popupWrapper.setX(this.popupWrapper.displayWidth/2),this.popupWrapper.setInteractive({hitArea:this.popupWrapper.getBounds()}),e.next=8,this.runEntranceAnimation();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isOpening=!1,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.setVisible(!0),this.setScale(0),e.next=5,this.scene.tweens.add({targets:this,scale:1,duration:t,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 5:return e.next=7,(0,le.qZ)(1e3);case 7:if(this.isOpening){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return e.next=11,this.runExitAnimation();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),e.next=3,this.scene.tweens.add({targets:this,scale:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.setVisible(!1),n.popupItems.forEach((function(e){e.kill()})),n.plusTexts.forEach((function(e){e.kill()})),n.popupItems=[],n.plusTexts=[],n.isOpening=!1}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.popupItems;if(0!==this.popupItems.length){var t=Math.ceil(e.length/4),n=[],i=[],a=[],r=[];if(1===t)n=e,a=this.spawnPlusTexts(n.length-1),this.placeItemsAndPlusTexts(n,a,35,0,-7);else if(t>=1){var s=Math.ceil(e.length/2);n=e.slice(0,s),i=e.slice(s),a=this.spawnPlusTexts(n.length-1),r=this.spawnPlusTexts(i.length-1),this.placeItemsAndPlusTexts(n,a,35,-17.5,-24.5),this.placeItemsAndPlusTexts(i,r,35,12.5,5.5)}var o=e.reduce((function(e,t){return e.x<t.x?e:t})),c=e.reduce((function(e,t){return e.x>t.x?e:t})),h=e.reduce((function(e,t){return e.y<t.y?e:t})),u=e.reduce((function(e,t){return e.y>t.y?e:t})),l=c.x+c.displayWidth/2-(o.x-o.displayWidth/2)+39.519999999999996,d=u.y+u.displayHeight/2-(h.y-h.displayHeight/2)+27.52;this.updatePopupSize(l,d),this.plusTexts=[].concat(a,r),this.popupWrapper.setSize(this.width,this.height)}},n.placeItemsAndPlusTexts=function(e,t,n,i,a){e.forEach((function(t,a){var r=(a-(e.length-1)/2)*n;t.setPosition(r-5,i)})),t.forEach((function(e,i){var r=(i-(t.length-1)/2)*n;e.setPosition(r-8,a)}))},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItems();return n.setItemType(e.type),n.setItemAmount(e.amount),n.revive(),n.setScale(.36),t.bringToTop(n),n}))},n.getItems=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new rD(this.scene),this.itemPool.push(e),this.popupWrapper.add(e)),e},n.spawnPlusTexts=function(e){var t=this;return Array.from({length:e},(function(){var e=t.getPlusText();return e.revive(),e}))},n.getPlusText=function(){var e=this.plusPool.find((function(e){return!e.active}));return e||((e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"+"})).setTint(13790009),this.plusPool.push(e),this.popupWrapper.add(e)),e},n.create=function(){this.popupWrapper=this.scene.add.container(0,0),this.add(this.popupWrapper);var e=this.scene.make.nineslice({key:oD,frame:cD.REWARDS.HALF_TOP,width:196/3,height:59,leftWidth:15,rightWidth:24,topHeight:15,bottomHeight:11}),t=this.scene.make.nineslice({key:oD,frame:cD.REWARDS.HALF_BOTTOM,width:196/3,height:59,leftWidth:15,rightWidth:24,topHeight:11,bottomHeight:15});this.popupWrapper.add([e,t]),this.top=e,this.bottom=t,this.updatePopupSize(100,100)},n.updatePopupSize=function(e,t){var n=t/2;this.top.setSizeByWorld(e,n),this.bottom.setSizeByWorld(e,n),this.setSize(e,this.top.displayHeight+this.bottom.displayHeight),this.top.setY(-this.top.displayHeight/2),this.bottom.setY(this.bottom.displayHeight/2)},t}(Phaser.GameObjects.Container),uD=hD,lD=Wi.Z.DEFAULT,dD=lD.KEY,pD=lD.FRAME,fD=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.left=void 0,n.right=void 0,n.popupItems=[],n.itemPool=[],n.plusPool=[],n.plusTexts=[],n.isOpening=void 0,n.popupWrapper=void 0,n.scene=t,n.isOpening=!1,n.create(),n.setScale(0),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runPopupOpen=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isOpening=!0,this.setPosition(n,i),this.popupItems=this.spawnItems(t),this.alignItems(),a?this.popupWrapper.setY(-this.popupWrapper.displayHeight/2):this.popupWrapper.setY(this.popupWrapper.displayHeight/2),this.popupWrapper.setInteractive({hitArea:this.popupWrapper.getBounds()}),e.next=8,this.runEntranceAnimation();case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isOpening=!1,this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.setVisible(!0),this.setScale(0),e.next=5,this.scene.tweens.add({targets:this,scale:1,duration:t,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 5:return e.next=7,(0,le.qZ)(500);case 7:if(this.isOpening){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return e.next=11,this.runExitAnimation();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),e.next=3,this.scene.tweens.add({targets:this,scale:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.setVisible(!1),n.popupItems.forEach((function(e){e.kill()})),n.plusTexts.forEach((function(e){e.kill()})),n.popupItems=[],n.plusTexts=[],n.isOpening=!1}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this.popupItems;if(0!==this.popupItems.length){this.plusTexts=this.spawnPlusTexts(e.length-1),this.placeItemsAndPlusTexts(e,this.plusTexts,35,-7,-12);var t=e.reduce((function(e,t){return e.x<t.x?e:t})),n=e.reduce((function(e,t){return e.x>t.x?e:t})),i=n.x+n.displayWidth/2-(t.x-t.displayWidth/2)+30,a=e.reduce((function(e,t){return e.displayHeight>t.displayHeight?e:t})).displayHeight+30;this.updatePopupSize(i,a),this.popupWrapper.setSize(this.width,this.height)}},n.placeItemsAndPlusTexts=function(e,t,n,i,a){e.forEach((function(t,a){var r=(a-(e.length-1)/2)*n;t.setPosition(r,i)})),t.forEach((function(e,i){var r=(i-(t.length-1)/2)*n;e.setPosition(r-3,a)}))},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItems();return n.setItemType(e.type),n.setItemAmount(e.amount),n.revive(),n.setScale(.36),t.bringToTop(n),n}))},n.getItems=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new rD(this.scene),this.itemPool.push(e),this.popupWrapper.add(e)),e},n.spawnPlusTexts=function(e){var t=this;return Array.from({length:e},(function(){var e=t.getPlusText();return e.revive(),e}))},n.getPlusText=function(){var e=this.plusPool.find((function(e){return!e.active}));return e||((e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(12),text:"+"})).setTint(13790009),this.plusPool.push(e),this.popupWrapper.add(e)),e},n.create=function(){this.popupWrapper=this.scene.add.container(0,0),this.add(this.popupWrapper);var e=this.scene.make.nineslice({key:dD,frame:pD.REWARDS.HALF_LEFT,width:196/3,height:59,leftWidth:17,rightWidth:12,topHeight:15,bottomHeight:25}),t=this.scene.make.nineslice({key:dD,frame:pD.REWARDS.HALF_LEFT,width:196/3,height:59,leftWidth:17,rightWidth:12,topHeight:15,bottomHeight:25}),n=t.scale;t.setScale(-1*n,n),this.popupWrapper.add([e,t]),this.left=e,this.right=t,this.updatePopupSize(100,100)},n.updatePopupSize=function(e,t){var n=e/2;this.left.setSizeByWorld(n,t),this.right.setSizeByWorld(n,t),this.setSize(this.left.displayWidth+Math.abs(this.right.displayWidth),t),this.left.setX(-this.width/2+this.left.displayWidth/2),this.right.setX(this.width/2+this.right.displayWidth/2)},t}(Phaser.GameObjects.Container),mD=fD,gD=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0,n.maxScale=void 0;var i=1/GameCore.ImageScale;return n.maxScale=Phaser.Math.FloatBetween(.35*i,.7*i),n}return(0,s.Z)(t,e),t.prototype.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.scaleX=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.scaleY=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),a},t}(Phaser.GameObjects.Particles.Particle),vD=gD,yD=Wi.Z.RACE,ED=yD.KEY,CD=yD.FRAME,AD=function(e){function t(t){var n;return(n=e.call(this,t,ED,CD.MAIN.TWINKLE)||this).emitter=void 0,n.scene=t,n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:CD.MAIN.TWINKLE,quantity:2,lifespan:{min:2e3,max:4e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:1500,x:{min:-13,max:13},y:{min:-30,max:-5},blendMode:"Multiply",particleClass:vD})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),wD=AD,SD=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).isClicked=!1,a.parentName=void 0,a.disable=void 0,a.image=void 0,a.imageScaleX=void 0,a.imageScaleY=void 0,a.handlePointerDown=function(){a.isClicked||(a.isClicked=!0,a.onPointerDown())},a.handleOnClick=function(e){return function(){a.isClicked&&(a.isClicked=!1,a.onPointerUp(),a.logButtonEvent(),a.addDebugData(),e())}},a.handlePointerOut=function(){a.isClicked&&(a.isClicked=!1,a.onCancel())},a.createImage(n,i),a.listenEvents(),a.scene.add.existing((0,fc.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.createImage=function(e,t){var n=this.scene.add.image(0,0,e,t);n.setOrigin(.5,1),n.setDefaultWorldSize(),this.add(n),n.setY(n.height/2),this.setSize(n.width,n.height),this.image=n,this.imageScaleX=n.scaleX,this.imageScaleY=n.scaleY},n.listenEvents=function(){this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)},n.onPointerDown=function(){this.animButtonDown()},n.onPointerUp=function(){this.animButtonUp()},n.onCancel=function(){this.animButtonUp()},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this.image,scaleX:this.imageScaleX+.02,scaleY:this.imageScaleY-.02,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this.image,scaleX:this.imageScaleX,scaleY:this.imageScaleY,duration:100,ease:Phaser.Math.Easing.Sine.In,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.setDisabled=function(e){this.disable!=e&&(this.disable=e,e?this.disableInteractive():this.setInteractive({useHandCursor:!0}))},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,Y.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(te._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,H.Z)(t,[{key:"onClick",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e))}}]),t}(Phaser.GameObjects.Container),bD=SD,TD=Wi.Z.RACE,xD=TD.KEY,PD=TD.FRAME,kD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.island=void 0,i.gold=void 0,i.silver=void 0,i.bronze=void 0,i.goldMedal=void 0,i.silverMedal=void 0,i.bronzeMedal=void 0,i.chestTwinkle=void 0,i.rank=void 0,i.chestStatus=void 0,i.imageScale=void 0,i.chestPopup=void 0,i.isChestClaimed=void 0,i.container=void 0,i.isOpening=void 0,i.handleGoldChestClicked=function(){var e=Qi[0].items;i.isOpening||(i.isOpening=!0,i.container.emit("chest-popup",e,(0,fc.Z)(i)))},i.scene=t,i.container=n,i.imageScale=1/GameCore.ImageScale,i.create(),i.setSize(i.island.width,i.island.height),i.alignItems(),i.chestStatus=BD.IDLE,i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.isChestClaimed=!1,this.chestStatus=BD.IDLE},n.runIdleChestAnimation=function(){this.setChestStatus(this.rank,this.isChestClaimed)},n.runChangeChestAnimation=function(e){var t=this;void 0===e&&(e=300);var n=this.scene.tweens.createTimeline();return n.add({targets:[this.gold,this.silver,this.bronze],scale:0,duration:e,ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.setChestsScale(0),t.island.setVisible(!0)}}),n.add({targets:[this.gold,this.silver,this.bronze],scale:1,duration:e,ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.updateChestsVisibility(),t.setChestsScale(0),t.island.setVisible(!0)},onComplete:function(){t.chestTwinkle.start()}}),n.playAndWaitForCompletion()},n.runHideChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=300),this.chestTwinkle.stop(),n=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],scale:0,delay:0,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){a.setChestsVisibility(!1),a.setChestsScale(0)}}).waitForCompletion(),i=this.scene.tweens.add({targets:this.island,scale:0,delay:0===t?0:200,duration:t,ease:Phaser.Math.Easing.Back.In,onComplete:function(){a.island.setVisible(!1),a.island.setScale(0)}}).waitForCompletion(),e.next=6,Promise.all([n,i]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runShowChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),n=this.scene.tweens.add({targets:this.island,scale:this.imageScale,delay:t,duration:300,ease:Phaser.Math.Easing.Back.Out,onStart:function(){a.island.setVisible(!0),a.island.setScale(0)}}).waitForCompletion(),i=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],scale:1,delay:200+t,duration:300,ease:Phaser.Math.Easing.Back.Out,onStart:function(){a.updateChestsVisibility(),a.setChestsScale(0)},onComplete:function(){a.chestTwinkle.start()}}).waitForCompletion(),e.next=5,Promise.all([n,i]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimPlayerChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=0),this.chestTwinkle.stop(),i=this.gold.x,a=this.gold.y,r=this.getLocalPoint(t.x+37,t.y),700,s=[this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],y:"-=40",scaleX:1.8,scaleY:1.8,delay:n,duration:350,ease:Phaser.Math.Easing.Cubic.Out}).waitForCompletion(),this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],y:r.y,scaleX:1,scaleY:1,delay:350+n,duration:350,ease:Phaser.Math.Easing.Quartic.In}).waitForCompletion()],o=this.scene.tweens.add({targets:[this.gold,this.silver,this.bronze],x:r.x,delay:n+140,duration:560,ease:Phaser.Math.Easing.Sine.In}).waitForCompletion(),h=this.scene.tweens.add({targets:this.island,scale:0,delay:n,duration:350,ease:Phaser.Math.Easing.Back.In}).waitForCompletion(),u=this.scene.tweens.add({targets:[this.goldMedal,this.silverMedal,this.bronzeMedal],scale:3/9,delay:560,duration:140,ease:Phaser.Math.Easing.Back.Out,onStart:function(){l.updateMedalsVisibility(),l.setMedalsScale(0)}}).waitForCompletion(),e.next=12,Promise.all([o].concat(s,[h,u]));case 12:this.setChestsVisibility(!1),this.setChestsScale(1),this.gold.setPosition(i,a),this.silver.setPosition(i,a),this.bronze.setPosition(i,a),this.island.setVisible(!1),this.island.setScale(this.imageScale),this.isChestClaimed=!0;case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runClaimOtherChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=300),!this.isChestClaimed){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.next=5,this.runHideChestAnimation(t);case 5:return e.next=7,this.scene.tweens.add({targets:[this.goldMedal,this.silverMedal,this.bronzeMedal],scale:3/9,delay:0===t?0:200,duration:t,ease:Phaser.Math.Easing.Back.Out,onStart:function(){n.updateMedalsVisibility(),n.setMedalsScale(0)}}).waitForCompletion();case 7:this.isChestClaimed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setChestStatus=function(e,t){this.chestStatus=BD.IDLE,this.rank=e,this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.island.setVisible(!1),this.isChestClaimed=t,t?this.updateMedalsVisibility():(this.updateChestsVisibility(),this.updateIslandVisibility())},n.setChestsVisibility=function(e){this.gold.setVisible(e),this.silver.setVisible(e),this.bronze.setVisible(e)},n.setMedalsVisibility=function(e){this.goldMedal.setVisible(e),this.silverMedal.setVisible(e),this.bronzeMedal.setVisible(e)},n.updateChestsVisibility=function(){this.gold.setVisible(0===this.rank),this.silver.setVisible(1===this.rank),this.bronze.setVisible(2===this.rank)},n.updateMedalsVisibility=function(){this.goldMedal.setVisible(0===this.rank),this.silverMedal.setVisible(1===this.rank),this.bronzeMedal.setVisible(2===this.rank)},n.updateIslandVisibility=function(){this.island.setVisible(this.rank<=2)},n.setChestsScale=function(e){this.gold.setScale(e),this.silver.setScale(e),this.bronze.setScale(e)},n.setMedalsScale=function(e){this.goldMedal.setScale(e),this.silverMedal.setScale(e),this.bronzeMedal.setScale(e)},n.updateChestStatusWithRank=function(e){this.isChestClaimed?this.updateChestStatus(BD.CLAIMED,e):this.rank!==e?this.rank<=2?this.updateChestStatus(e<=2?BD.CHANGE:BD.HIDE,e):this.updateChestStatus(e<=2?BD.SHOW:BD.IDLE,e):this.updateChestStatus(BD.IDLE,e)},n.updateChestStatus=function(e,t){this.chestStatus=e,this.rank=t},n.setDefault=function(e){this.updateChestStatus(BD.IDLE,e),this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.updateChestsVisibility(),this.updateIslandVisibility()},n.hide=function(){this.setChestsVisibility(!1),this.setMedalsVisibility(!1),this.island.setVisible(!1),this.chestTwinkle.stop()},n.alignItems=function(){Phaser.Display.Align.In.BottomCenter(this.island,this),Phaser.Display.Align.In.BottomCenter(this.gold,this,0,-14),Phaser.Display.Align.In.BottomCenter(this.silver,this,0,-14),Phaser.Display.Align.In.BottomCenter(this.bronze,this,0,-14)},n.runShowChestPopup=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.chestPopup.isOpening){e.next=2;break}return e.abrupt("return");case 2:this.chestPopup.runPopupOpen(t,this.x,this.y,!0);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runHideChestPopup=function(){this.chestPopup.isOpening&&this.chestPopup.close()},n.create=function(){this.createIsland(),this.createChests(),this.createMedals(),this.createChestTwinkle(),this.createChestPopup()},n.createIsland=function(){this.island=this.scene.add.image(0,0,xD,PD.MAIN.ISLAND),this.island.setDefaultWorldSize(),this.island.setVisible(!1),this.add(this.island)},n.createChests=function(){this.createGoldChest(),this.createSilverChest(),this.createBronzeChest()},n.createMedals=function(){var e=this.scene.add.image(0,-6,xD,PD.MAIN.MEDAL.GOLD);e.setDefaultWorldSize();var t=this.scene.add.image(0,-6,xD,PD.MAIN.MEDAL.SILVER);t.setDefaultWorldSize();var n=this.scene.add.image(0,-6,xD,PD.MAIN.MEDAL.BRONZE);n.setDefaultWorldSize(),this.goldMedal=e,this.silverMedal=t,this.bronzeMedal=n,this.goldMedal.kill(),this.silverMedal.kill(),this.bronzeMedal.kill(),this.add(this.goldMedal),this.add(this.silverMedal),this.add(this.bronzeMedal)},n.createGoldChest=function(){var e=this,t=new bD(this.scene,xD,PD.MAIN.CHEST_ON_ISLAND.GOLD);this.add(t),this.gold=t,t.onClick=function(){var t=Qi[0].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createSilverChest=function(){var e=this,t=new bD(this.scene,xD,PD.MAIN.CHEST_ON_ISLAND.SILVER);this.add(t),this.silver=t,t.onClick=function(){var t=Qi[1].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createBronzeChest=function(){var e=this,t=new bD(this.scene,xD,PD.MAIN.CHEST_ON_ISLAND.BRONZE);this.add(t),this.bronze=t,t.onClick=function(){var t=Qi[2].items;e.isOpening||(e.isOpening=!0,e.container.emit("chest-popup",t,e))}},n.createChestTwinkle=function(){this.chestTwinkle=new wD(this.scene),this.chestTwinkle.stop(),this.add(this.chestTwinkle)},n.createChestPopup=function(){var e=new mD(this.scene);e.setPosition(0,-50),this.add(e),this.chestPopup=e},t}(Phaser.GameObjects.Container),ID=kD;function OD(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return RD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RD(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function RD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var BD=function(e){return e[e.CHANGE=0]="CHANGE",e[e.HIDE=1]="HIDE",e[e.SHOW=2]="SHOW",e[e.IDLE=3]="IDLE",e[e.CLAIMED=4]="CLAIMED",e}({}),DD=(SR={},SR[BD.CLAIMED]=0,SR[BD.CHANGE]=1,SR[BD.HIDE]=2,SR[BD.SHOW]=3,SR[BD.IDLE]=4,SR),LD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.racerPositions=void 0,i.islandChests=void 0,i.currentChestShowingPopup=void 0,i.chestPopupPool=[],i.handleCloseOpeningPopup=function(e){i.currentChestShowingPopup&&i.currentChestShowingPopup!==e&&i.currentChestShowingPopup.runHideChestPopup(),i.currentChestShowingPopup=e},i.runShowChestPopup=function(){var e=(0,r.Z)(c().mark((function e(t,n){var a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.getChestPopup()){e.next=3;break}return e.abrupt("return");case 3:return r=n.getWorldPosition(),s=i.getLocalPoint(r.x,r.y),o=GameCore.layoutInitializer.isLandscape?0:-5,h=GameCore.layoutInitializer.isLandscape?-20:-15,i.bringToTop(a),e.next=10,a.runPopupOpen(t,s.x+o,s.y+h,!0);case 10:a.kill(),n.isOpening=!1;case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i.runHideChestPopup=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.chestPopupPool.find((function(e){return e.active&&e.isOpening}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.runExitAnimation(150);case 5:t.kill();case 6:case"end":return e.stop()}}),e)}))),i.scene=t,i.racerPositions=n,i.create(),i.setSize(i.width,200),i.on("chest-popup",i.runShowChestPopup,(0,fc.Z)(i)),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.getChestPopup=function(){var e,t=this.chestPopupPool.find((function(e){return!e.active}));return t?(t.revive(),t):((e=GameCore.layoutInitializer.isLandscape?new mD(this.scene):new uD(this.scene)).revive(),this.chestPopupPool.push(e),this.add(e),e)},n.isPlayerChestClaimed=function(){return this.islandChests[0].isChestClaimed},n.setupIslandChests=function(e){var t=this;e.forEach((function(e){var n=t.islandChests[e.racerIndex];n.rank=e.rank,n.setChestStatus(e.rank,e.rewardClaimed)}))},n.reset=function(){this.islandChests.forEach((function(e,t){e.reset(),e.setDefault(t)}))},n.getGoldChest=function(){return this.islandChests.find((function(e){return 0===e.rank}))},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.offshoreRace.getRacers().forEach((function(e){n.islandChests[e.racerIndex].rank=e.rank})),t=[].concat(this.islandChests).sort((function(e,t){return e.rank-t.rank})).slice(0,3),e.next=5,Promise.all(t.map((function(e,t){return e.runShowChestAnimation(200*t)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showChestsImmediately=function(){var e=this;this.scene.offshoreRace.getRacers().forEach((function(t){e.islandChests[t.racerIndex].setChestStatus(t.rank,t.rewardClaimed)}))},n.runPlacingTop3=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene.offshoreRace.getRacers().forEach((function(e){o.islandChests[e.racerIndex].updateChestStatusWithRank(e.rank)})),t=[].concat(this.islandChests).sort((function(e,t){return DD[e.chestStatus]-DD[t.chestStatus]})),n=[],i=OD(t);case 5:if((a=i()).done){e.next=26;break}r=a.value,s=void 0,e.t0=r.chestStatus,e.next=e.t0===BD.CLAIMED?11:e.t0===BD.CHANGE?13:e.t0===BD.HIDE?16:e.t0===BD.SHOW?19:e.t0===BD.IDLE?22:24;break;case 11:return r.setChestStatus(r.rank,!0),e.abrupt("break",24);case 13:return s=r.runChangeChestAnimation(),n.push(s),e.abrupt("break",24);case 16:return e.next=18,r.runHideChestAnimation();case 18:return e.abrupt("break",24);case 19:return e.next=21,r.runShowChestAnimation();case 21:return e.abrupt("break",24);case 22:return r.runIdleChestAnimation(),e.abrupt("break",24);case 24:e.next=5;break;case 26:return e.next=28,Promise.all(n);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryPlayerClaimChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.islandChests[t.racerIndex],e.next=3,a.runClaimPlayerChestAnimation(n);case 3:i(t.rank);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.tryOpponentClaimChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.islandChests[t.racerIndex],e.next=3,n.runClaimOtherChestAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setDefault=function(){var e=this;this.islandChests.forEach((function(t,n){t.setPosition(0,e.racerPositions[n]+8),t.setDefault(n)}))},n.hideAllChests=function(){this.islandChests.forEach((function(e){e.hide()}))},n.create=function(){var e=this;this.islandChests=new Array(5).fill(null).map((function(){return new ID(e.scene,e)})),this.add(this.islandChests),this.setSize(this.islandChests[0].width,this.islandChests[0].height),this.setDefault()},t}(Phaser.GameObjects.Container),_D=LD,MD=Wi.Z.RACE,ND=MD.KEY,GD=MD.FRAME,ZD=function(e){function t(t){var n;return(n=e.call(this,t,{key:ND,backgroundFrame:GD.BUTTON.BASE,buttonFrame:GD.BUTTON.PLAY,buttonWidth:425/3,buttonHeight:53})||this).scene=void 0,n.buttonText=void 0,n.buttonStatus=zD.PLAY,n.goldChest=void 0,n.silverChest=void 0,n.bronzeChest=void 0,n.chestTwinkle=void 0,n.scene=t,n.createText(),n.createChest(),n.createChestTwinkle(),n.setSize(n.width,n.height),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.buttonText.setText(e)},n.createChest=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.goldChest=this.scene.add.image(36,-5,Wi.Z.RACE.KEY,Wi.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.GOLD),this.silverChest=this.scene.add.image(36,-3,Wi.Z.RACE.KEY,Wi.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.SILVER),this.bronzeChest=this.scene.add.image(36,-1,Wi.Z.RACE.KEY,Wi.Z.RACE.FRAME.MAIN.CHEST_ON_BUTTON.BRONZE),this.goldChest.setDefaultWorldSize(),this.silverChest.setDefaultWorldSize(),this.bronzeChest.setDefaultWorldSize(),this.goldChest.kill(),this.silverChest.kill(),this.bronzeChest.kill(),this.addIntoButton(this.goldChest),this.addIntoButton(this.silverChest),this.addIntoButton(this.bronzeChest);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createChestTwinkle=function(){this.chestTwinkle=new wD(this.scene),this.chestTwinkle.setPosition(38,0),this.add(this.chestTwinkle)},n.createText=function(){var e=new jp(this.scene,{text:"PLAY",fontSize:this.scene.fontSize(21),strokeColor:877056,strokeThickness:3,strokeOffset:{y:.6},strokeAlpha:.9});e.setY(-1),this.buttonText=e,this.addIntoButton(e)},n.setStatus=function(e){switch(this.buttonStatus=e,e){case zD.PLAY:this.setText("PLAY"),this.buttonText.setCenterAlign(),this.buttonText.setPosition(0,this.buttonText.y),this.hideChests(),this.chestTwinkle.stop();break;case zD.CLAIM:this.setText("CLAIM");break;case zD.CONTINUE:this.setText("OK"),this.buttonText.setCenterAlign(),this.buttonText.setPosition(0,this.buttonText.y),this.hideChests(),this.chestTwinkle.stop()}},n.getChest=function(e){switch(e){case 0:return this.goldChest;case 1:return this.silverChest;case 2:return this.bronzeChest}},n.hideChests=function(){this.goldChest.kill(),this.silverChest.kill(),this.bronzeChest.kill()},n.runClaimAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hideChests(),void 0!==(n=this.getChest(t))){e.next=4;break}return e.abrupt("return");case 4:return n.revive(),e.next=7,this.scene.tweens.add({targets:this,scaleX:1.1,scaleY:.9,y:"+=5",duration:200,yoyo:!0,ease:Phaser.Math.Easing.Quartic.Out,onStart:function(){i.setStatus(zD.CLAIM),i.buttonText.setLeftAlign(),i.buttonText.setPosition(-54,i.buttonText.y)}}).waitForCompletion();case 7:this.chestTwinkle.start();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setChestOnButton=function(e){this.hideChests();var t=this.getChest(e);void 0!==t&&(t.revive(),this.buttonText.setLeftAlign(),this.buttonText.setPosition(-54,this.buttonText.y),this.chestTwinkle.start())},t}(tT),FD=ZD,UD=Wi.Z.RACE,WD=UD.KEY,HD=UD.FRAME,YD=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.screen=void 0,i.timerPanel=void 0,i.header=void 0,i.description=void 0,i.informationButton=void 0,i.closeButton=void 0,i.playButton=void 0,i.racers=void 0,i.islandChestContainer=void 0,i.updateLevelButtons=[],i.devRaceButtons=[],i.shouldRunEntranceAnimation=void 0,i.firstOpenWhenRacing=void 0,i.chestPopupPool=[],i.scene=t,i.screen=n,i.shouldRunEntranceAnimation=!1,i.firstOpenWhenRacing=!0,i.create(),i.alignItems(),i.updateRacers(),i.setupIslandChests(),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.resetRacers=function(){this.racers.forEach((function(e){e.reset()})),this.islandChestContainer.reset()},n.closeContainer=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){1!==this.alpha&&this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In})},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.devRaceButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.updateLevelButtons.forEach((function(e){t.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),this.setButtonsDisabled(!0),this.updateDescription(),this.updatePlayButton(),this.updateRacers(),!this.shouldRunEntranceAnimation){e.next=16;break}return this.shouldRunEntranceAnimation=!1,this.firstOpenWhenRacing=!1,this.islandChestContainer.hideAllChests(),this.runIslandChestsEntranceAnimation(),e.next=13,this.runRacersEntranceAnimation();case 13:(0,dl.Z)(this.scene,500).then((function(){var e=t.islandChestContainer.getGoldChest();e&&e.handleGoldChestClicked()})),e.next=21;break;case 16:return this.islandChestContainer.runPlacingTop3(),e.next=19,this.animateUpdateRacers();case 19:return e.next=21,this.tryRacersClaimChestAnimation();case 21:this.setButtonsDisabled(!1);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateDescription=function(){var e=this.scene.offshoreRace.getRequiredLevels();this.description.setText("Be the first to beat "+e+" levels!")},n.updatePlayButton=function(){var e=this.scene.offshoreRace,t=e.getPlayerRank(),n=e.isFinished(),i=e.hasReward();n?i?(this.playButton.setStatus(zD.CLAIM),this.islandChestContainer.isPlayerChestClaimed()&&this.playButton.setChestOnButton(t)):this.playButton.setStatus(zD.CONTINUE):this.playButton.setStatus(zD.PLAY)},n.updateRacers=function(){for(var e=this.scene.offshoreRace.getRacers(),t=0;t<this.racers.length;t++){var n=e[t];if(n)this.racers[t].updateData(n)}},n.setupIslandChests=function(){var e=this.scene.offshoreRace.getRacers();this.islandChestContainer.setupIslandChests(e)},n.runRacersEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.racers.forEach((function(e){e.setAlpha(0)})),e.next=3,(0,le.qZ)(250);case 3:return t=this.racers.map((function(e,t){return e.runEntranceAnimation(t)})),e.next=6,Promise.all(t);case 6:this.shouldRunEntranceAnimation=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIslandChestsEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(250);case 2:this.islandChestContainer.runEntranceAnimation();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.animateUpdateRacers=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.racers.map((function(e){return e.animateUpdateRacerBlock()})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.tryRacersClaimChestAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.scene.offshoreRace.getRacers(),n=function(e){h.playButton.runClaimAnimation(e)},i=0;case 3:if(!(i<t.length)){e.next=24;break}if(a=t[i],r=this.racers[i],!(s=0===i)||!a.rewardClaimed){e.next=9;break}return e.abrupt("break",24);case 9:if(o=this.scene.offshoreRace.getRequiredLevels(),!(a.score<o)&&sa.includes(a.rank)){e.next=12;break}return e.abrupt("continue",21);case 12:if(this.scene.requireTextureAsync("OFFSHORE_RACE_CHESTS",!1),r.playClaimAnimation(400),!s){e.next=19;break}return e.next=17,this.islandChestContainer.tryPlayerClaimChestAnimation(a,this.playButton.getWorldPosition(),n);case 17:e.next=21;break;case 19:return e.next=21,this.islandChestContainer.tryOpponentClaimChestAnimation(a);case 21:i++,e.next=3;break;case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignItems=function(){var e=this,t=GameCore.Utils.Number.normalizeNumber(Phaser.Math.Clamp(this.scene.world.getWorldSize().width,360,426),360,426,-2,-8);Phaser.Display.Align.In.TopCenter(this.header,this,0,22),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,0,-32),Phaser.Display.Align.In.TopCenter(this.description,this,0,-50),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-25,-21),Phaser.Display.Align.In.TopRight(this.closeButton,this,-20,-23),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,25),Phaser.Display.Align.In.RightCenter(this.islandChestContainer,this,t,25),GameCore.Utils.Valid.isDebugger()&&(this.updateLevelButtons.forEach((function(t,n){var i=e.racers[n];Phaser.Display.Align.To.LeftCenter(t,i,-10,0)})),Phaser.Display.Align.In.TopLeft(this.devRaceButtons[0],this,-25,-42),Phaser.Display.Align.In.TopLeft(this.devRaceButtons[1],this,-55,-42))},n.alignRacers=function(){var e=this;this.racers.forEach((function(t,n){t.setPosition(-e.width/2+t.width/2+8,40*n-55)}))},n.setButtonsDisabled=function(e){this.playButton.setDisabled(e),this.informationButton.setDisabled(e),this.closeButton.setDisabled(e),this.playButton.setAlpha(1),this.informationButton.setAlpha(1),this.closeButton.setAlpha(1),this.disableDevButtons(e)},n.create=function(){this.createBackground(),this.createTimePanel(),this.createHeader(),this.createDescription(),this.createRacers(),this.createButtons(),this.createIslandChestsContainer(),this.createDevButtons()},n.createBackground=function(){var e=this.scene.world.getWorldSize().width,t=e>=446?426:e-20,n=this.scene.add.image(0,0,WD,HD.MAIN.POPUP);n.setDefaultWorldSize(),this.add(n);var i=n.scale*t/426,a=1/GameCore.ImageScale;n.setScale(i,a),this.setSize(n.displayWidth,n.displayHeight)},n.createTimePanel=function(){this.timerPanel=new EB(this.scene),this.add(this.timerPanel);var e=this.scene.add.image(0,0,WD,HD.MAIN.TIME_PANEL);e.setDefaultWorldSize(),this.timerPanel.addAt(e,0)},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,WD,HD.MAIN.HEADER_BACKGROUND);e.setDefaultWorldSize(),this.header.add(e);var t=new Pf(this.scene);t.setText("Offshore Racers"),t.setFontSize(25.3),t.setRadius(-900),t.setLetterSpacing(-.2),t.setPosition(2,-2.5),this.header.add(t),this.header.setSize(e.width,e.height)},n.createDescription=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(15),text:"Be the first to beat 15 levels!",origin:{x:.5,y:.5}});e.setTint(33447),this.add(e),this.description=e},n.createRacers=function(){for(var e=[],t=0;t<5;t++)e.push(new eD(this.scene,this,t));this.racers=e,this.add(this.racers),this.alignRacers()},n.createIslandChestsContainer=function(){var e=this.racers.map((function(e){return e.y-25}));this.islandChestContainer=new _D(this.scene,e),this.add(this.islandChestContainer)},n.createButtons=function(){this.createInformationButton(),this.createCloseButton(),this.createPlayButton()},n.createInformationButton=function(){var e=new iv.Z(this.scene,{key:WD,frame:HD.MAIN.BUTTON.INFORMATION,width:7,height:15,paddingZone:30});e.setName("Information"),this.add(e),this.informationButton=e},n.createCloseButton=function(){var e=new iv.Z(this.scene,{key:WD,frame:HD.MAIN.BUTTON.CLOSE,width:37/3,height:37/3,paddingZone:30});e.setName("Close"),this.add(e),this.closeButton=e},n.createPlayButton=function(){var e=new FD(this.scene);e.button.setName("Play"),this.add(e),this.playButton=e},n.updateWithDebugger=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setButtonsDisabled(!0),this.updatePlayButton(),this.updateRacers(),this.islandChestContainer.runPlacingTop3(),e.next=6,this.animateUpdateRacers();case 6:return e.next=8,this.tryRacersClaimChestAnimation();case 8:this.setButtonsDisabled(!1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createDevButtons=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=this.createDevButton("Reset\nScore");t.onClick=function(){e.scene.screen.close(ce.o4.OFFSHORE_RACE.MAIN_SCREEN),e.shouldRunEntranceAnimation=!0,e.scene.offshoreRace.resetRacersScore(),(0,dl.Z)(e.scene,200).then((function(){return e.scene.openOffshoreRaceMainScreen()}))};var n=this.createDevButton("Erase\nRace");n.onClick=function(){e.scene.offshoreRace.events.emit(ra),e.scene.screen.close(ce.o4.OFFSHORE_RACE.MAIN_SCREEN),e.shouldRunEntranceAnimation=!0,e.updateRacers(),e.setupIslandChests()},this.devRaceButtons.push(t,n);var i=this.createDevButton("Up\nPlayer");i.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(0,t),e.updateWithDebugger()};var a=this.createDevButton("Up\nOp1");a.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(1,t),e.updateWithDebugger()};var r=this.createDevButton("Up\nOp2");r.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(2,t),e.updateWithDebugger()};var s=this.createDevButton("Up\nOp3");s.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(3,t),e.updateWithDebugger()};var o=this.createDevButton("Up\nOp4");o.onClick=function(){var t=Math.floor(Phaser.Math.Between(2,5));e.scene.offshoreRace.updateRacerScore(4,t),e.updateWithDebugger()},this.updateLevelButtons.push(i,a,r,s,o)}},n.disableDevButtons=function(e){this.updateLevelButtons.forEach((function(t){t.setDisabled(e),t.setAlpha(e?.3:.5)})),this.devRaceButtons.forEach((function(t){t.setDisabled(e),t.setAlpha(e?.3:.5)}))},n.createDevButton=function(e){var t=new Kp.Z(this.scene,30,30),n=this.scene.add.image(0,0,Wi.Z.RACE.KEY,Wi.Z.RACE.FRAME.MAIN.OPPONENT.AVATAR_BACKGROUND);n.setDefaultWorldSize(),t.add(n);var i=new jp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});return i.setAlign("center"),t.add(i),this.add(t),t},t}(Phaser.GameObjects.Container),KD=YD,zD=function(e){return e[e.PLAY=0]="PLAY",e[e.CLAIM=1]="CLAIM",e[e.CONTINUE=2]="CONTINUE",e}({}),VD=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.offshoreRaceMainContainer=void 0,s.previousScreen=void 0,s.handleInformationButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=void 0===s.previousScreen)&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),e.next=4,s.offshoreRaceMainContainer.closeContainer();case 4:return e.next=6,s.scene.screen.openAsync(ce.o4.OFFSHORE_RACE.INTRO_SCREEN);case 6:t&&s.scene.screen.open(ce.o4.DASHBOARD_SCREEN),s.scene.screen.bringToTop(ce.o4.OFFSHORE_RACE.MAIN_SCREEN),s.offshoreRaceMainContainer.openContainer();case 9:case"end":return e.stop()}}),e)}))),s.handleCloseButtonClick=function(){var e=s.offshoreRaceMainContainer.playButton.buttonStatus;if(e===zD.CLAIM&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),s.scene.screen.close(s.name),e!==zD.CLAIM)e!==zD.CONTINUE||s.scene.offshoreRace.events.emit(ra);else{var t=s.scene.offshoreRace.getRewardData();s.scene.openOffshoreRaceRewardScreen({rewards:t})}},s.handlePlayButtonClick=function(){var e=s.offshoreRaceMainContainer.playButton.buttonStatus;if(e!==zD.CONTINUE&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),s.scene.screen.close(s.name),e!==zD.PLAY){if(e!==zD.CLAIM)return e===zD.CONTINUE?(s.scene.offshoreRace.events.emit(ra),void(s.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0)):void 0;var t=s.scene.offshoreRace.getRewardData();s.scene.openOffshoreRaceRewardScreen({rewards:t})}else s.scene.gameplay.processStartLevel()},s.close=function(){s.background.off(Phaser.Input.Events.POINTER_DOWN),s.offshoreRaceMainContainer.islandChestContainer.runHideChestPopup(),s.runExitAnimation()},s.onEntranceCompleted=function(){s.background.once(Phaser.Input.Events.POINTER_DOWN,(function(){s.scene.screen.close(s.name)}))},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.scene.gameUI.coinBarButton.setDisabled(!1),s.previousScreen&&s.scene.screen.open(s.previousScreen)},s.scene=t,s.create(),s.listenEvents(),s.setDepth(ce.Ks.POPUP),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.offshoreRaceMainContainer.setAlpha(0),s}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.createRaceMainContainer();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.listenEvents=function(){var e=this.offshoreRaceMainContainer,t=e.informationButton,n=e.closeButton,i=e.playButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,i.onClick=this.handlePlayButtonClick,this.scene.offshoreRace.events.on(ra,this.endRace,this)},n.endRace=function(){var e=this;(0,dl.Z)(this.scene,100).then((function(){e.offshoreRaceMainContainer.resetRacers()})),this.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0},n.createRaceMainContainer=function(){this.offshoreRaceMainContainer=new KD(this.scene,this),this.offshoreRaceMainContainer.setInteractive(),this.add(this.offshoreRaceMainContainer),Phaser.Display.Align.In.Center(this.offshoreRaceMainContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),t.prev=1,i=null!=n?n:{previousScreen:ce.o4.DASHBOARD_SCREEN},a=i.previousScreen,r=i.shouldPlayEntranceAnimation,a===ce.o4.DASHBOARD_SCREEN?this.previousScreen=void 0:this.previousScreen=a,this.updateTime(),this.runEntranceAnimation(),t.next=8,this.handleFirstTimePlay();case 8:return this.offshoreRaceMainContainer.openContainer(),!0===r&&(this.offshoreRaceMainContainer.shouldRunEntranceAnimation=!0),t.next=12,this.offshoreRaceMainContainer.open();case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),this.close();case 17:case"end":return t.stop()}}),t,this,[[1,14]])})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.offshoreRace.getIsFirstTimeEvent()){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.offshoreRace.setIsFirstTimeEvent(!1),e.next=6,(0,le.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTime=function(){var e=this.scene.offshoreRace,t=e.isFinished();this.offshoreRaceMainContainer.timerPanel.timerLogic.setRemainingTime(t?0:e.getRemainingTime())},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.offshoreRaceMainContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){void 0===this.previousScreen&&this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.offshoreRaceMainContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),jD=VD,XD=Wi.Z.DASHBOARD,qD=XD.KEY,JD=XD.FRAME,QD=function(e){function t(t){var n;return(n=e.call(this,t)||this).sparksCount=6,n.sparks=[],n.wave=void 0,n.glow=void 0,n.animation=void 0,n.container=void 0,n.container=n.scene.add.container(),n.add(n.container),n.createSparks(),n.createWave(),n.createGlow(),n.createAnimation(),n.setDepth(Fr.Z.ON_TOP),n.setVisible(!1),n.container.setPosition(0,0),t.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.explode=function(){var e,t;null==(e=this.animation)||e.setTimeScale(1),null==(t=this.animation)||t.start()},n.createSparks=function(){for(var e=0;e<this.sparksCount;e++){var t=this.scene.add.image(0,0,qD,JD.EFFECTS.SPARKS).setAlpha(0);t.setDefaultWorldSize(),t.scale*=.53448,this.sparks.push(t)}this.container.add(this.sparks)},n.createWave=function(){this.wave=this.scene.add.image(0,5,qD,JD.EFFECTS.WAVE).setAlpha(0),this.wave.setWorldSize(14,14),this.container.add(this.wave)},n.createGlow=function(){this.glow=this.scene.add.image(0,0,qD,JD.EFFECTS.GLOW).setAlpha(0),this.glow.setDefaultWorldSize(),this.container.add(this.glow)},n.createAnimation=function(){var e=this;this.animation=new Hw([{target:this.glow,color:[{color:"ffffff43",curve:.056,c2:.52,c3:.75},{time:.1,color:"ffffff7f",curve:.25,c3:.988,c4:.59},{time:.2667,color:"ffffff00"}]},{target:this.sparks[0],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[1],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[2],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[3],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[4],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.sparks[5],color:[{color:"ffffff00"},{time:.0333,color:"ffffffff"}]},{target:this.wave,color:[{time:.0333,color:"ffffff32"},{time:.1333,color:"ffffff94"},{time:.3,color:"ffffff00"}]},{target:this.glow,translate:[{x:-3.42,y:-2.28},{time:.2667,x:-3.42,y:3.73}],scale:[{x:0,y:0,curve:.128,c2:.73,c3:.75},{time:.2667,x:2.567,y:2.567}]},{target:this.sparks[0],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:42.58,y:42.58}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[1],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:-27.42,y:53.63}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[2],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.3667,x:-59.65,y:-17.29}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.3667,x:0,y:0}],rotate:[{time:.0333},{time:.3667,angle:-102.81}]},{target:this.sparks[3],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5333,x:14.95,y:62.84}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.5333,x:0,y:0}],rotate:[{time:.0333},{time:.5333,angle:-102.81}]},{target:this.sparks[4],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.4333,x:52.71,y:-12.68}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.4333,x:0,y:0}],rotate:[{time:.0333},{time:.4333,angle:-102.81}]},{target:this.sparks[5],translate:[{time:.0333,x:-9.71,y:-6.72,curve:.062,c2:.51,c3:.75},{time:.5,x:4.82,y:-41.23}],scale:[{y:0},{time:.0333,x:2.426,y:2.426,curve:.115,c2:.28,c3:.75},{time:.5,x:0,y:0}],rotate:[{time:.0333},{time:.5,angle:-102.81}]},{target:this.wave,translate:[{time:.0333},{time:.3,x:.98,y:25.4}],scale:[{y:0},{time:.0333,curve:.25,c3:.75},{time:.3,x:4.198,y:4.198}]}]),this.animation.events.on("start",(function(){e.setVisible(!0)})),this.animation.events.on("complete",(function(){e.setVisible(!1)}))},t}(Phaser.GameObjects.Container),$D=QD,eL=Wi.Z.DEFAULT,tL=eL.KEY,nL=eL.FRAME,iL=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.itemType=void 0,n.item=void 0,n.itemAmount=void 0,n.amount=void 0,n.eventType=void 0,n.starEmitter=void 0,n.widgetSparksPool=[],n.scene=t,n.createItem(),n.createItemAmount(),n.createStarParticle(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.runStarExplodeParticle=function(){var e=this.getWidgetSparks();e.setPosition(0,0),e.explode(),this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.GOAL_PROGRESS)},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r,s){var o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.scene.tweens.add({targets:this,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1,duration:200},x:{from:t,start:t,to:i},y:{from:n,start:n,to:a},duration:r,ease:Phaser.Math.Easing.Back.Out,delay:s,onStart:function(){h.item.setVisible(!0)},onComplete:function(){h.runEffects()}}).waitForCompletion(),e.abrupt("return",o);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r,s){return e.apply(this,arguments)}}(),n.runExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.tweens.add({targets:this,duration:250,scale:{from:this.scale,start:this.scale,to:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){t.kill(),t.scale=1,t.stopAnimation()}}).waitForCompletion();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r){var s,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.scene.tweens.add({targets:this,duration:i,x:t,y:n,ease:Phaser.Math.Easing.Back.In,delay:a,scale:{from:this.scale,start:this.scale,to:.6*this.scale},onComplete:function(){o.item.setVisible(!1),o.scale=1,r(),o.stopAnimation(),o.runStarExplodeParticle()}}).waitForCompletion(),this.claim(),e.abrupt("return",s);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r){return e.apply(this,arguments)}}(),n.runHideItemAmountAnimation=function(e,t){var n=this;return this.scene.tweens.add({targets:this.itemAmount,duration:e,delay:t,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:1,start:1,to:0},onComplete:function(){n.itemAmount.setVisible(!1)}}).waitForCompletion()},n.claim=function(){var e=0,t=Ki.NONE;switch(this.itemType){case qi.UNDO:e=this.scene.player.getUndo(),this.scene.player.setUndo(e+this.amount);break;case qi.PLUS_5_CARDS:e=this.scene.player.getPlusFive(),this.scene.player.setPlusFive(e+this.amount);break;case Ki.STORM:case Ki.SLICE:case Ki.WILD_CARD:t=this.itemType,this.scene.gameplay.boosterManager.increaseBoosterAmount(t,this.amount)}this.scene.logEconomy.logGetItemByEvent(this.eventType,this.itemType,this.amount)},n.setEventType=function(e){this.eventType=e},n.setType=function(e){switch(this.itemType=e,e){case qi.COIN:this.setFrame(nL.REWARDS.COIN);break;case qi.UNDO:this.setFrame(nL.REWARDS.UNDO);break;case qi.PLUS_5_CARDS:this.setFrame(nL.REWARDS.PLUS_5_CARDS);break;case Ki.STORM:this.setFrame(nL.REWARDS.STORM);break;case Ki.SLICE:this.setFrame(nL.REWARDS.SLICE);break;case Ki.WILD_CARD:this.setFrame(nL.REWARDS.WILD_CARD)}},n.setAmount=function(e){if(this.amount=e,this.itemType===qi.COIN){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");this.itemAmount.setText(""+t)}else this.itemAmount.setText("x"+e);this.itemAmount.x=0,this.itemAmount.y=this.height/2+10,this.itemAmount.setVisible(!0),this.itemAmount.setAlpha(1),this.itemAmount.setScale(1)},n.getAmount=function(){return this.amount},n.setFrame=function(e){this.item.setFrame(e),this.item.setDefaultWorldSize(),this.setSize(this.item.width,this.item.height)},n.runEffects=function(){var e;null==(e=this.starEmitter)||e.start()},n.stopAnimation=function(){var e,t;null==(e=this.starEmitter)||e.stop(),null==(t=this.starEmitter)||t.killAll()},n.createItem=function(){var e=this.scene.add.image(0,0,tL,nL.REWARDS.COIN);e.setDefaultWorldSize(),this.add(e),this.setSize(e.width,e.height),this.item=e},n.createItemAmount=function(){var e=new jp(this.scene,{text:"",fontSize:this.scene.fontSize(18),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add(e),this.itemAmount=e},n.createStarParticle=function(){var e=new Phaser.GameObjects.Particles.ParticleEmitterManager(this.scene,tL,nL.EFFECTS.STAR_2);this.scene.add.existing(e),this.add(e);var t=new Phaser.Geom.Rectangle;t.setSize(200/3,40),t.setPosition(0-t.width/2,-t.height/2);var n=1/GameCore.ImageScale;this.starEmitter=e.createEmitter({frame:nL.EFFECTS.STAR_2,emitZone:{source:t,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.02,max:.03},emitCallback:function(e){e.setScale({min:n/2,max:1*n})},particleClass:Db.Z,quantity:1})},n.getWidgetSparks=function(){var e=this.widgetSparksPool.find((function(e){return!e.active}));return e||(e=this.createWidgetSparks(),this.widgetSparksPool.push(e)),e},n.createWidgetSparks=function(){var e=new $D(this.scene);return this.add(e),e},t}(Phaser.GameObjects.Container),aL=Wi.Z.OFFSHORE_RACE_CHESTS,rL=aL.KEY,sL=aL.FRAME,oL=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.chestContainer=void 0,n.title=void 0,n.illustrators=void 0,n.itemPool=[],n.chestItems=[],n.isChestOpened=!1,n.canClaimChestItems=!1,n.tapToOpenButton=void 0,n.tapToClaimButton=void 0,n.openChestPosition=void 0,n.rewardScreen=void 0,n.handleTapToOpen=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isChestOpened){e.next=11;break}return n.isChestOpened=!0,n.tapToOpenButton.setDisabled(!0),n.hideTapToOpenOrClaimButton(n.tapToOpenButton,250),e.next=6,n.chestContainer.runChestOpenAnimation(n.openChestPosition.x,n.openChestPosition.y);case 6:return n.runChangeText(n.title,"Your Rewards",250),e.next=9,n.runPopupItemsFromChest();case 9:n.showTapToOpenOrClaimButton(n.tapToClaimButton,250,250),n.canClaimChestItems=!0;case 11:case"end":return e.stop()}}),e)}))),n.handleTapToClaim=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isChestOpened||!n.canClaimChestItems){e.next=13;break}return n.canClaimChestItems=!1,n.tapToClaimButton.setDisabled(!0),e.next=5,n.runObjectsExitAnimation();case 5:return e.next=7,(0,le.qZ)(100);case 7:return n.scene.screen.open(ce.o4.DASHBOARD_SCREEN),n.scene.screen.bringToTop(ce.o4.OFFSHORE_RACE.REWARD_SCREEN),n.scene.offshoreRace.events.emit(ra),e.next=12,n.claimAllItems();case 12:n.scene.screen.close(ce.o4.OFFSHORE_RACE.REWARD_SCREEN);case 13:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.openChestPosition={x:0,y:60},n.create(),n.listenEvents(),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.tapToOpenButton.onClick=this.handleTapToOpen,this.tapToClaimButton.onClick=this.handleTapToClaim},n.setRewardScreen=function(e){this.rewardScreen=e},n.updateChestData=function(e){var t=e.rewards,n=this.getChestType();this.chestContainer=this.createChestContainer(n,zC.OFFSHORE_RACE),this.chestItems=this.spawnItems(t)},n.getChestType=function(){var e=this.scene.offshoreRace.getPlayerRank();return[KC.GOLD,KC.SILVER,KC.BRONZE][e]},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItemContainer();return n.setEventType(zC.OFFSHORE_RACE),n.setType(e.type),n.setAmount(e.amount),n.revive(),n.setScale(0),t.bringToTop(n),n}))},n.getItemContainer=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new iL(this.scene),this.itemPool.push(e),this.add(e)),e},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.runTitleEntranceAnimation(),this.runIllustratorsEntranceAnimation(),e.next=4,this.chestContainer.runChestEntranceAnimation(0,0);case 4:this.showTapToOpenOrClaimButton(this.tapToOpenButton,250,100);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.isChestOpened=!1,this.canClaimChestItems=!1,this.title.setText("Congratulations!"),this.tapToOpenButton.setDisabled(!1),this.tapToClaimButton.setDisabled(!1)},n.runTitleEntranceAnimation=function(){this.scene.tweens.add({targets:[this.title],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runObjectsExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rewardScreen.runFadeBackground(0);case 2:return t=this.chestContainer.runChestExitAnimation(),n=this.runIllustratorsExitAnimation(),i=this.hideTapToOpenOrClaimButton(this.tapToClaimButton,250),a=this.scene.tweens.add({targets:[this.title],ease:Phaser.Math.Easing.Back.In,duration:250,scale:{from:1,start:1,to:0},alpha:{from:1,start:1,to:0}}).waitForCompletion(),r=[t,i,a,n],e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIllustratorsExitAnimation=function(){var e=this;return this.scene.tweens.add({targets:this.illustrators,duration:150,ease:Phaser.Math.Easing.Sine.In,alpha:{from:1,start:1,to:0},y:{from:this.illustrators.y,start:this.illustrators.y,to:this.illustrators.y+20},onComplete:function(){e.illustrators.setPosition(0,e.height/2-e.illustrators.height/2)}}).waitForCompletion()},n.claimAllItems=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.find((function(e){return e.itemType===qi.COIN})),n=this.chestItems.filter((function(e){return e.itemType!==qi.COIN})),this.runClaimCoin(t),e.next=5,this.runClaimItems(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimCoin=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.runExitAnimation();case 4:return n=t.getWorldPosition(),i=n.x,a=n.y,(r=this.scene.rewardManager).rewardCoin(t.getAmount()),this.scene.logEconomy.logGetItem(fl.COIN,t.getAmount(),gl.OFFSHORE_RACE),e.abrupt("return",r.coinAnimationPool.runAnimationRewardCoinAsync(15,i,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimItems=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLevelButton(),i=this.getLocalPoint(n.getWorldPosition().x,n.getWorldPosition().y),a=i.x,r=i.y,s=0,o=function(){n.runClaimItemsAnimation()},h=t.map((function(e){s+=150;var t=e.runClaimAnimation(a,r,600,s,o);return e.runHideItemAmountAnimation(150,0),t})),e.next=7,Promise.all(h);case 7:return e.next=9,(0,le.qZ)(550);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getLevelButton=function(){return this.scene.screen.get(ce.o4.DASHBOARD_SCREEN).levelButton},n.showTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:0,start:0,to:1},onStart:function(){e.revive(),e.text.setScale(0)}}).waitForCompletion()},n.hideTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:1,start:1,to:0},onComplete:function(){e.kill(),e.text.setScale(0)}}).waitForCompletion()},n.runChangeText=function(e,t,n){this.scene.tweens.add({targets:e,duration:n,ease:Phaser.Math.Easing.Sine.In,yoyo:!0,scale:0,alpha:0,onYoyo:function(){e.setText(t)}})},n.create=function(){this.createTitle(),this.createIllustrators(),this.createTapToOpenButton(),this.createTapToClaimButton()},n.createTitle=function(){var e=GameCore.layoutInitializer.isLandscape?30:26,t=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(e),text:"Congratulations!",origin:{x:.5,y:.5}});this.add(t),this.title=t},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,rL,sL.OFFSHORE_RACE.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,rL,sL.OFFSHORE_RACE.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),t.setPosition(-this.width/2+t.width/2,0),n.setPosition(this.width/2-n.width/2,0),e.setPosition(0,this.height/2-e.height/2),this.illustrators=e},n.createChestContainer=function(e,t){if(this.chestContainer)this.chestContainer.updateChestFrame(e,t);else{var n=new VC(this.scene,e,t);this.add(n),this.chestContainer=n}return this.chestContainer},n.createTapToOpenButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new vT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to open!"),t.setName("TapToOpen"),this.add(t),this.tapToOpenButton=t,t.kill()},n.createTapToClaimButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new vT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to claim!"),t.setName("TapToClaim"),this.add(t),this.tapToClaimButton=t,t.kill()},t}(Phaser.GameObjects.Container),cL=function(e){function t(t){var n;return(n=e.call(this,t)||this).alignUI(),n.openChestPosition={x:0,y:60},n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-20),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-10),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-10)},n.runPopupItemsFromChest=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.calculateRowPositions(this.chestItems),n=this.chestItems.map((function(e,n){var a=i.chestContainer.x,r=i.chestContainer.y-30,s=t[n],o=s.x,c=s.y,h=100*n;return e.runEntranceAnimation(a,r,o,c,400,h)})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.calculateRowPositions=function(e){var t=(e.length-1)/2;return e.map((function(e,n){return{x:70*(n-t),y:16*Math.abs(n-t)-70}}))},t}(oL),hL=function(e){function t(t){var n;return(n=e.call(this,t)||this).alignUI(),n.openChestPosition={x:0,y:110},n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.Center(this.title,this,0,-220),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-30),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-30)},n.runPopupItemsFromChest=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.length>4?3:4,n=Math.ceil(this.chestItems.length/t),i=this.splitItemsIntoRows(this.chestItems,t),a=i.flatMap((function(e,t){var i=100*t;return s.calculateRowPositions(e,n,i)})),r=this.chestItems.map((function(e,t){var n=s.chestContainer.x,i=s.chestContainer.y-30,r=a[t],o=r.x,c=r.y,h=100*t;e.runEntranceAnimation(n,i,o,c,400,h)})),e.next=7,Promise.all(r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.splitItemsIntoRows=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},n.calculateRowPositions=function(e,t,n){var i=t>1?-140:-90,a=(e.length-1)/2;return e.map((function(e,t){return{x:70*(t-a),y:16*Math.abs(t-a)+i+n}}))},t}(oL),uL=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.rewardContainer=void 0,s.onExitCompleted=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.close.call((0,fc.Z)(s)),s.background.setAlpha(1);case 2:case"end":return t.stop()}}),t)}))),s.scene=t,s.rewardContainer=GameCore.layoutInitializer.isLandscape?new cL(s.scene):new hL(s.scene),s.rewardContainer.setRewardScreen((0,fc.Z)(s)),s.add(s.rewardContainer),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this),this.runEntranceAnimation(),this.rewardContainer.updateChestData(t),this.rewardContainer.runEntranceAnimation()},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rewardContainer.close(),this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFadeBackground=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.add({targets:this.background,alpha:{from:this.background.alpha,start:this.background.alpha,to:t},duration:150,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),lL=uL,dL=886/3,pL=502/3,fL=Wi.Z.WEEKLY_TOURNAMENT,mL=fL.KEY,gL=fL.FRAME,vL=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).handleButtonClick=function(){n.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN)},n.setSize(dL,pL),n.create(),n}return(0,s.Z)(t,e),t.prototype.create=function(){var e=new uy(this.scene,{key:mL,frame:gL.FAILED.POPUP,width:886/3,height:502/3,topHeight:140/3,bottomHeight:60});this.add(e);var t=this.scene.add.image(0,0,mL,gL.FAILED.HEADER);t.setDefaultWorldSize(),this.add(t);var n=new Pf(this.scene);n.setText("Weekly Tournament"),n.setFontSize(22),n.setRadius(-800),n.setLetterSpacing(-.2),this.add(n);var i=new jp(this.scene,{text:"You can't join this time,\nplease try again later",fontSize:this.scene.fontSize(15),fillColor:11102533});i.setCenterAlign(),i.setY(-7),this.add(i);var a=new tT(this.scene,{key:mL,backgroundFrame:gL.FAILED.BUTTON.BASE,buttonFrame:gL.FAILED.BUTTON.GREEN,buttonWidth:403/3,buttonHeight:137/3,buttonInnerWidth:338/3,buttonInnerHeight:41});a.alignBackground(0,-.5),a.button.setName("Ok");var r=new jp(this.scene,{text:"Ok",fontSize:this.scene.fontSize(21),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});a.addIntoButton(r),a.onClick=this.handleButtonClick,this.add(a),Phaser.Display.Align.In.TopCenter(t,e,0,30.5),Phaser.Display.Align.In.Center(n,t,0,-1.5),Phaser.Display.Align.In.BottomCenter(a,e,.125,16.5)},t}(Phaser.GameObjects.Container),yL=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).tournamentsFailedContainer=void 0,r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.setDepth(ce.Ks.POPUP),r.tournamentsFailedContainer=new vL(t),r.add(r.tournamentsFailedContainer),r.background.setAlpha(ce.MR.ALPHA.COMMON),r}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.tournamentsFailedContainer.setAlpha(1),this.runEntranceAnimation()},n.close=function(){this.runExitAnimation()},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.tournamentsFailedContainer]},Cv.tweenConfigs.popup.configOpen),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.tournamentsFailedContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),EL=yL,CL=Wi.Z.WEEKLY_TOURNAMENT,AL=CL.KEY,wL=CL.FRAME,SL=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){var e=-this.scene.gameZone.height/2-50;Phaser.Display.Align.In.TopCenter(this.title,this,0,-40),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-27),Phaser.Display.Align.In.TopCenter(this.step1,this,-180,e),Phaser.Display.Align.In.TopCenter(this.step2,this,0,e),Phaser.Display.Align.In.TopCenter(this.step3,this,190,e),Phaser.Display.Align.In.Center(this.arrow1,this,-90,8),Phaser.Display.Align.In.Center(this.arrow2,this,95,8)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(30),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[wL.INTRO.ITEM_1,wL.INTRO.ITEM_2,wL.INTRO.ITEM_3],n=["Beat levels","Get cups for\nwinnings","Get prizes"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,AL,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=Array.from({length:2},(function(t,n){var i=e.scene.add.image(0,0,AL,wL.INTRO.ARROW);return i.setDefaultWorldSize(),i}));this.add([].concat(t)),this.arrow1=t[0],this.arrow2=t[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(16)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),bL=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new SL(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),TL=Wi.Z.WEEKLY_TOURNAMENT,xL=TL.KEY,PL=TL.FRAME,kL=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).scene=void 0,i.title=void 0,i.continueText=void 0,i.parentScreen=void 0,i.arrow1=void 0,i.arrow2=void 0,i.step1=void 0,i.step2=void 0,i.step3=void 0,i.tapToContinueButton=void 0,i.scene=t,i.parentScreen=n,i.setSize(n.width,n.height),i.setDepth(ce.Ks.POPUP),i.create(),i.alignItems(),i}(0,s.Z)(t,e);var n=t.prototype;return n.alignItems=function(){Phaser.Display.Align.In.Center(this.step1,this,-90,-50),Phaser.Display.Align.In.Center(this.step2,this,90,50),Phaser.Display.Align.In.Center(this.step3,this,-90,180),Phaser.Display.Align.In.Center(this.arrow1,this,40,-90),Phaser.Display.Align.In.Center(this.arrow2,this,40,100),Phaser.Display.Align.In.BottomCenter(this.continueText,this,0,-30);var e=-this.height/2+this.title.height/2+10,t=this.step1.y-this.step1.tutorialImage.height-this.title.height;this.title.setPosition(0,(e+t)/2)},n.create=function(){this.createTitle(),this.createTutorialSteps(),this.createArrows(),this.createContinueText()},n.open=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllContents(),this.revive(),e.next=4,this.runEntranceAnimation(100);case 4:return this.tapToContinueButton.setInteractive(),e.abrupt("return",new Promise((function(e){t.tapToContinueButton.onClick=(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.parentScreen.handleWeeklyTournamentIntroContainerClose();case 2:e();case 3:case"end":return n.stop()}}),n)})))})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.qZ)(t);case 2:return n=this.runTitleEntranceAnimation(0,500),i=this.step1.runEntranceAnimation(200,500),a=this.runArrowEntranceAnimation(this.arrow1,400,500),r=this.step2.runEntranceAnimation(600,500),s=this.runArrowEntranceAnimation(this.arrow2,800,500),o=this.step3.runEntranceAnimation(1e3,500),h=this.runTapToContinueEntranceAnimation(1200,500),e.next=11,Promise.all([n,i,a,r,s,o,h]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runTitleEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.title,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.title.setScale(0),i.title.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.runArrowEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1/GameCore.ImageScale,e.next=3,this.scene.tweens.add({targets:t,delay:n,duration:i,scale:{from:0,start:0,to:a},ease:Phaser.Math.Easing.Back.Out,onStart:function(){t.setScale(0),t.setAlpha(1)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.runTapToContinueEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.next=3,this.scene.tweens.add({targets:this.continueText,delay:t,duration:n,scale:{from:0,start:0,to:1},ease:Phaser.Math.Easing.Back.Out,easeParams:[.5],onStart:function(){i.continueText.setScale(0),i.continueText.setAlpha(.5)}}).waitForCompletion();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.hideAllContents=function(){this.title.setAlpha(0),this.step1.kill(),this.step2.kill(),this.step3.kill(),this.arrow1.setAlpha(0),this.arrow2.setAlpha(0),this.continueText.setAlpha(0)},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.kill(),this.hideAllContents(),this.tapToContinueButton.disableInteractive();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createTitle=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(36),text:"How does it work?",origin:{x:.5,y:.5}});this.add(e),this.title=e},n.createTutorialSteps=function(){var e=this,t=[PL.INTRO.ITEM_1,PL.INTRO.ITEM_2,PL.INTRO.ITEM_3],n=["Beat levels!","Collect cups!","Get prizes!"],i=Array.from({length:3},(function(i,a){return new mT(e.scene,xL,t[a],n[a])}));this.add([].concat(i)),this.step1=i[0],this.step2=i[1],this.step3=i[2]},n.createArrows=function(){var e=this,t=[PL.INTRO.ARROW_RIGHT,PL.INTRO.ARROW_LEFT],n=Array.from({length:2},(function(n,i){var a=e.scene.add.image(0,0,xL,t[i]);return a.setDefaultWorldSize(),a}));this.add([].concat(n)),this.arrow1=n[0],this.arrow2=n[1]},n.createContinueText=function(){var e=new vT(this.scene);e.text.setFontSize(this.scene.fontSize(20)),e.text.setText("Tap to continue"),e.setName("TapToContinue"),this.add(e),this.tapToContinueButton=e,this.continueText=e.text},t}(Phaser.GameObjects.Container),IL=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).weeklyTournamentIntroContainer=void 0,r.close=function(){r.runExitAnimation()},r.onEntranceCompleted=function(){},r.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(r))},r.scene=t,r.create(),r.setDepth(ce.Ks.POPUP),r.setAlpha(0),r.background.setAlpha(0),r.weeklyTournamentIntroContainer.close(),r}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentIntroContainer()},n.handleWeeklyTournamentIntroContainerClose=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.weeklyTournamentIntroContainer.close();case 2:this.scene.screen.close(this.name);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createWeeklyTournamentIntroContainer=function(){this.weeklyTournamentIntroContainer=new kL(this.scene,this),this.weeklyTournamentIntroContainer.setInteractive({useHandCursor:!0}),this.add(this.weeklyTournamentIntroContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentIntroContainer,this,0,0)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),this.runEntranceAnimation(),t.next=4,this.weeklyTournamentIntroContainer.open();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),OL=GameCore.layoutInitializer.isLandscape?bL:IL,RL=n(101),BL=function(e){function t(t){var n;(n=e.call(this,t)||this).scaleStart=void 0,n.maxScale=void 0;var i=1/GameCore.ImageScale;return n.maxScale=Phaser.Math.FloatBetween(.35*i,.7*i),n}return(0,s.Z)(t,e),t.prototype.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.scaleX=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.scaleY=this.maxScale*(this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT)),this.alpha=this.lifeT<=.5?2*this.lifeT:2*(1-this.lifeT),a},t}(Phaser.GameObjects.Particles.Particle),DL=BL,LL=Wi.Z.WEEKLY_TOURNAMENT,_L=LL.KEY,ML=LL.FRAME,NL=function(e){function t(t){var n;return(n=e.call(this,t,_L,ML.LEADERBOARD.TWINKLE)||this).emitter=void 0,n.scene=t,n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){this.emitter=this.createEmitter({on:!1,frame:ML.LEADERBOARD.TWINKLE,quantity:1,lifespan:{min:2e3,max:4e3},alpha:0,scale:0,angle:{min:0,max:180},rotate:{start:0,end:360,ease:"Sine.easeIn"},frequency:1500,x:{min:-13,max:13},y:{min:-10,max:10},blendMode:"Multiply",particleClass:DL})},n.start=function(){this.reset(),this.revive(),this.emitter.start()},n.stop=function(){var e,t,n;this.kill(),null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.remove(),null==(n=this.emitter)||n.stop()},n.reset=function(){this.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),GL=NL,ZL=Wi.Z.WEEKLY_TOURNAMENT,FL=ZL.KEY,UL=ZL.FRAME,WL=function(e){function t(t){var n;return(n=e.call(this,t,98/3,82/3)||this).chest=void 0,n.chestTwinkle=void 0,n.rewardIndex=void 0,n.isOpening=void 0,n.rank=void 0,n.scene=t,n.updateSize(),n.createChest(),n.createChestTwinkle(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(42,34)},n.createChest=function(){this.chest=this.scene.add.image(0,0,FL,UL.LEADERBOARD.CHEST.GOLD),this.chest.setDefaultWorldSize(),this.add(this.chest)},n.createChestTwinkle=function(){this.chestTwinkle=new GL(this.scene),this.add(this.chestTwinkle)},n.setRank=function(e){var t=this;if(e<=0)this.setVisible(!1);else{this.setVisible(!0),this.chest.setY(0);var n=this.scene.weeklyTournament.getTopByRank(e);-1===n?(this.rewardIndex=-1,this.setVisible(!1)):n>=1&&n<=4?(this.rewardIndex=e-1,this.chest.setFrame("leaderboard/chest_"+n)):5===n&&(this.rewardIndex=e-1,this.chest.setFrame(UL.LEADERBOARD.COIN_ICON),this.chest.setY(1)),this.chestTwinkle.start(),this.setNameByRank(e),this.onClick=function(){if(-1!==t.rewardIndex&&!t.isOpening){var n=t.scene.weeklyTournament.getRewardData(e);t.isOpening=!0,t.scene.events.emit("chest-popup",n,t)}}}},n.setNameByRank=function(e){0===this.rewardIndex?this.setName("GoldChest"):1===this.rewardIndex?this.setName("SilverChest"):2===this.rewardIndex?this.setName("PurpleChest"):3===this.rewardIndex?this.setName("BronzeChest"):e>=11&&e<=30&&this.setName("Coin")},t}(Kp.Z),HL=Wi.Z.WEEKLY_TOURNAMENT,YL=HL.KEY,KL=HL.FRAME,zL=11102533,VL=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.icon=void 0,n.countText=void 0,n.updateSize(),n.createBackground(),n.createIcon(),n.createCountText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateScore=function(e,t){t?(this.background.setFrame(KL.LEADERBOARD.PLAYER.SCORE_PANEL),this.countText.setText(e.toString()),this.countText.setTintSeparate(4554921,0)):(this.background.setFrame(KL.LEADERBOARD.OPPONENT.SCORE_PANEL),this.countText.setText(e>=0?e.toString():"---"),this.countText.setTintSeparate(zL,0))},n.updateSize=function(){this.setSize(200/3,19)},n.createBackground=function(){this.background=this.scene.make.nineslice({key:YL,frame:KL.LEADERBOARD.PLAYER.SCORE_PANEL,width:this.width,height:this.height,leftWidth:10,rightWidth:10}),this.add(this.background)},n.createIcon=function(){this.icon=this.scene.add.image(0,0,YL,KL.LEADERBOARD.CUP_ICON),this.icon.setDefaultWorldSize(),this.add(this.icon),this.icon.setX(-26)},n.createCountText=function(){var e=new jp(this.scene,{text:"99999",fontSize:this.scene.fontSize(11),fillColor:zL});e.setCenterAlign(),this.add(e),this.countText=e,Phaser.Display.Align.In.RightCenter(this.countText,this,-6,.5)},t}(Phaser.GameObjects.Container),jL=Wi.Z.WEEKLY_TOURNAMENT,XL=jL.KEY,qL=jL.FRAME,JL={width:95/3,height:91/3,loadDelay:100,photoSizeOffset:-2,radius:80,position:{x:0,y:0}},QL=function(e){function t(t,n){var i;return void 0===n&&(n=JL),(i=e.call(this,t,{key:XL,background:qL.LEADERBOARD.PLAYER.AVATAR.BACKGROUND,frame:qL.LEADERBOARD.PLAYER.AVATAR.NO_AVATAR,width:n.width,height:n.height,loadDelay:n.loadDelay})||this).cfg=void 0,i.cfg=n,t.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(t,n,i){if(void 0===i&&(i=this.cfg.radius),this.updatePlayerTheme(t),t===this.payload.id&&n===this.payload.url&&this.payload.url)return this.avtFrame.kill(),void this.photo.revive();this.isNoAvatar(t,n)||e.prototype.loadPhoto.call(this,t,n,i)},n.setPhoto=function(t){e.prototype.setPhoto.call(this,t);var n=this.payload,i=n.width,a=n.height,r=this.cfg.position,s=r.x,o=r.y;this.avtFrame.kill(),this.photo.revive(),this.photo.setWorldSize(i,a),this.photo.setPosition(s,o)},n.isNoAvatar=function(e,t){return!t&&(this.photo.kill(),this.avtFrame.revive(),!0)},n.updatePlayerTheme=function(e){var t=e===this.scene.game.player.getPlayerId(),n=t?qL.LEADERBOARD.PLAYER.AVATAR.BACKGROUND:qL.LEADERBOARD.OPPONENT.AVATAR.BACKGROUND,i=t?qL.LEADERBOARD.PLAYER.AVATAR.NO_AVATAR:qL.LEADERBOARD.OPPONENT.AVATAR.NO_AVATAR;this.background.setFrame(n),this.avtFrame.setFrame(i)},t}(Ic),$L=Wi.Z.WEEKLY_TOURNAMENT,e_=$L.KEY,t_=$L.FRAME,n_=11102533,i_=function(e){function t(t){var n;return(n=e.call(this,t)||this).medal=void 0,n.rankText=void 0,n.updateSize(),n.createMedal(),n.createRankText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createMedal=function(){this.medal=this.scene.add.image(0,0,e_,t_.LEADERBOARD.STAR_1),this.medal.setDefaultWorldSize(),this.add(this.medal),this.medal.setY(-1)},n.setRank=function(e,t){var n=e>=1&&e<=3,i="";this.rankText.setX(0),0===e?i="-":e>=1e3?(i="999+",this.rankText.setX(2)):i=e.toString(),this.rankText.setText(i),n?(this.rankText.kill(),this.medal.revive(),this.medal.setFrame("leaderboard/star"+e)):(this.rankText.revive(),this.medal.kill()),this.rankText.setTintSeparate(t?4554921:n_,0)},n.updateSize=function(){this.setSize(21.5,19)},n.createRankText=function(){this.rankText=new jp(this.scene,{text:"1",fontSize:this.scene.fontSize(14),fillColor:n_}),this.rankText.setCenterAlign(),this.add(this.rankText)},t}(Phaser.GameObjects.Container),a_=Wi.Z.WEEKLY_TOURNAMENT,r_=a_.KEY,s_=a_.FRAME,o_=11102533,c_=function(e){function t(t){var n;return(n=e.call(this,t)||this).payload=void 0,n.background=void 0,n.medal=void 0,n.avatar=void 0,n.cupPanel=void 0,n.coinPanel=void 0,n.claimButton=void 0,n.rank=void 0,n.needUpdateRank=void 0,n.isPlayer=void 0,n.leaderName=void 0,n.isVisibleInLeaderboard=!0,n.updateSize(),n.createAvatar(),n.createBackground(),n.createMedal(),n.createLeaderName(),n.createCoinPanel(),n.createCupPanel(),n.createClaimButton(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){var e=this;this.claimButton.onClick=function(){e.scene.events.emit(m_.CLAIM_REWARD,e.rank)}},n.toggleClaimButtonVisibility=function(e){e?(this.claimButton.revive(),this.coinPanel.setY(-6)):(this.claimButton.kill(),this.coinPanel.setY(-1.5))},n.updateInfo=function(e){this.payload=e;var t=e.playerId,n=e.name,i=e.photo,a=e.score,r=e.rank;this.setAlpha(1),this.isVisibleInLeaderboard=!0,this.isPlayer=this.scene.player.getPlayerId()===t,this.rank=r,this.avatar.loadPhoto(t,i),this.medal.setRank(r,this.isPlayer),this.setUsername(n,this.isPlayer),this.cupPanel.updateScore(a,this.isPlayer),this.coinPanel.setRank(r),this.updatePanelBackground(this.isPlayer)},n.updateRank=function(e){this.medal.setRank(e,this.isPlayer),this.coinPanel.setRank(e),this.rank=e},n.updatePanelBackground=function(e){e?this.background.setFrame(s_.LEADERBOARD.PLAYER.LEADER_BLOCK_BG):this.background.setFrame(s_.LEADERBOARD.OPPONENT.LEADER_BLOCK_BG),this.background.setDefaultWorldSize(),this.setSize(this.background.width,this.background.height)},n.setUsername=function(e,t){var n=GameCore.Utils.String.getShortName(e,12),i=GameCore.Utils.String.removeDiacritics(n);this.leaderName.setText(i),this.leaderName.setTintSeparate(t?4554921:o_,0)},n.runShowUpAnimation=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=200),this.isVisibleInLeaderboard){var n=50*e;this.runShowPopUpAnimation(n,t)}},n.runShowPopUpAnimation=function(e,t){var n=this;this.scene.tweens.killTweensOf(this),this.scene.tweens.add({targets:this,alpha:{start:0,from:0,to:1},scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out},duration:t,delay:e,onStart:function(){n.setScale(.75),n.setAlpha(0),n.revive()}})},n.updateSize=function(){this.setSize(1126/3,125/3)},n.createAvatar=function(){this.avatar=new QL(this.scene),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-40,-.25)},n.createBackground=function(){this.background=this.scene.add.image(0,0,r_,s_.LEADERBOARD.PLAYER.LEADER_BLOCK_BG),this.background.setDefaultWorldSize(),this.add(this.background)},n.createMedal=function(){this.medal=new i_(this.scene),this.add(this.medal),Phaser.Display.Align.In.LeftCenter(this.medal,this,-10,1)},n.createLeaderName=function(){var e=new jp(this.scene,{text:"Amely",fontSize:this.scene.fontSize(14),fillColor:o_});e.setLeftAlign(),this.add(e),this.leaderName=e,Phaser.Display.Align.In.LeftCenter(this.leaderName,this,-84,-1.5)},n.createCoinPanel=function(){this.coinPanel=new WL(this.scene),this.add(this.coinPanel),Phaser.Display.Align.In.RightCenter(this.coinPanel,this,-90,0)},n.createCupPanel=function(){this.cupPanel=new VL(this.scene),this.add(this.cupPanel);this.cupPanel.setX(this.width/2-this.cupPanel.width/2-7)},n.createClaimButton=function(){this.claimButton=new iv.Z(this.scene,{key:r_,frame:s_.LEADERBOARD.BUTTON.CLAIM,width:121/3,height:50/3}),this.claimButton.setName("Claim");var e=new jp(this.scene,{text:"Claim",fontSize:this.scene.fontSize(10),fillColor:16776957,strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});e.setY(0),this.claimButton.add(e),this.add(this.claimButton),this.claimButton.kill(),Phaser.Display.Align.In.RightCenter(this.claimButton,this.coinPanel,1,10.5)},t}(Phaser.GameObjects.Container),h_=function(e){function t(t){var n;return(n=e.call(this,t)||this).panel=void 0,n.txt=void 0,n.timerLogic=void 0,n.updateSize(),n.createText(),n.createTimerLogic(),n}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){this.setSize(220/3,19)},n.createText=function(){this.txt=new jp(this.scene,{text:"Completed",fontSize:this.scene.fontSize(12),fillColor:11102533}),this.txt.setTint(10844770),this.add(this.txt)},n.createTimerLogic=function(){this.timerLogic=new u_(this.scene,this)},n.setText=function(e,t){void 0===t&&(t=12),this.txt.setFontSize(this.scene.fontSize(t)),this.txt.setText(e)},t}(Phaser.GameObjects.Container),u_=function(){function e(e,t){this.scene=void 0,this.timerPanel=void 0,this.countdownTimer=void 0,this.status="7d 10h 5m",this.startTime=void 0,this.rtMs=void 0,this.scene=e,this.timerPanel=t,this.rtMs=0}var t=e.prototype;return t.createCountdownTimer=function(){var e,t=this;null==(e=this.countdownTimer)||e.remove(),this.countdownTimer=this.timerPanel.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:function(){var e=t.rtMs-(window.performance.now()-t.startTime);if(e<0)t.timerPanel.setText("Completed",10),t.scene.weeklyTournament.events.emit(So),t.countdownTimer.remove();else{var n=aS(1e3*Math.ceil(e/1e3)),i=n.days,a=n.hours,r=n.minutes,s=n.seconds;t.status=i>=1?i+"d "+a+"h":a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0"),t.timerPanel.setText(t.status)}}})},t.setRemainingTime=function(e){this.rtMs=e,this.startTime=window.performance.now(),this.createCountdownTimer()},t.stopTimer=function(){var e;null==(e=this.countdownTimer)||e.remove()},e}(),l_=Wi.Z.WEEKLY_TOURNAMENT,d_=l_.KEY,p_=l_.FRAME,f_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leaderBlocks=[],n.animateClock=void 0,n.timerPanel=void 0,n.closeButton=void 0,n.informationButton=void 0,n.bg=void 0,n.loading=void 0,n.chestPopupPool=[],n.debugButtons=[],n.totalLeaders=void 0,n.leaderboardBackground=void 0,n.illustration=void 0,n.header=void 0,n.cupHeader=void 0,n.scroller=void 0,n.playerBlock=void 0,n.leaderBlockYs=[],n.playerIndex=void 0,n.runShowChestPopup=function(){var e=(0,r.Z)(c().mark((function e(t,i){var a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getChestPopup()){e.next=3;break}return e.abrupt("return");case 3:return n.scroller.setEnable(!1),r=i.getWorldPosition(),s=n.getLocalPoint(r.x,r.y),o=GameCore.layoutInitializer.isLandscape?0:-10,h=GameCore.layoutInitializer.isLandscape?-10:0,n.bringToTop(a),e.next=11,a.runPopupOpen(t,s.x+o,s.y+h,!0);case 11:a.kill(),i.isOpening=!1,n.scroller.setEnable(!0);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.runHideChestPopup=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.chestPopupPool.find((function(e){return e.active&&e.isOpening}))){e.next=3;break}return e.abrupt("return");case 3:t.kill();case 4:case"end":return e.stop()}}),e)}))),n.scene=t,n.totalLeaders=n.scene.weeklyTournament.getTotalLeaders(),n.create(),n.alignItems(),n.listenEvents(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on("chest-popup",this.runShowChestPopup,this)},n.closeContainer=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.alpha){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.scene.tweens.add({targets:this,scale:{value:.75,ease:Phaser.Math.Easing.Back.In},alpha:0,duration:150}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openContainer=function(){var e=(0,r.Z)(c().mark((function e(){var t,n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.debugButtons.forEach((function(e){n.scene.devToolManager.isShowDebugButtons?e.revive():e.kill()})),1!==this.alpha){e.next=3;break}return e.abrupt("return");case 3:return this.setButtonsDisabled(!0),t=this.scene.tweens.add({targets:this,scale:{from:.75,to:1,ease:Phaser.Math.Easing.Back.Out,easeParams:[1.5]},alpha:1,duration:250,ease:Phaser.Math.Easing.Sine.In}),e.next=7,t.waitForCompletion();case 7:this.setButtonsDisabled(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideLeaders(),this.showLoading(),e.next=4,this.getLeaderboardData();case 4:return t=e.sent,e.next=7,this.updateLeaders(t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateLeaders=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.scene.player.getPlayerId(),i=[].concat(t).slice(0,Math.min(t.length,10)),this.updatePlayerIndexAndTotalLeaders(n,t,i),this.playerBlock=this.leaderBlocks[this.playerIndex],this.scroller.gotoTop(),this.scroller.removeChildren(),this.leaderBlocks=this.leaderBlocks.slice(0,this.totalLeaders),this.createLeaderBlocks(),a=this.createPlayerData(n),i[this.playerIndex]=a,r=0;case 11:if(!(r<this.totalLeaders)){e.next=20;break}if(s=i[r]){e.next=15;break}return e.abrupt("continue",17);case 15:this.leaderBlocks[r].updateInfo(s);case 17:r++,e.next=11;break;case 20:this.leaderBlocks=this.scroller.getChildren(),this.scroller.setEnable(this.leaderBlocks.length>4),this.scroller.gotoTop(),this.hideLoading(),this.showLeaders();case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updatePlayerIndexAndTotalLeaders=function(e,t,n){this.playerIndex=999;var i=n.findIndex((function(t){return t.playerId===e}));if(-1!==i)this.totalLeaders=n.length,this.playerIndex=i;else if(0===t.length)this.playerIndex=0,this.totalLeaders=1;else{var a=n.length>=10;this.totalLeaders=a?11:n.length,this.playerIndex=this.totalLeaders-1}},n.createPlayerData=function(e){var t=this.scene.profile.getProfile(e)||{},n=this.scene.weeklyTournament.getRank(),i=this.scene.weeklyTournament.getScore();return this.scene.weeklyTournament.oldProgress={rank:n,score:i},{playerId:e,name:"You",photo:t.photo||this.scene.player.getPlayer().photo,score:i,rank:n}},n.getLeaderboardData=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.weeklyTournament,n=[],e.next=4,t.requestLeaderboardData();case 4:return n=t.getLeaderboardData(),e.next=7,t.checkRequestPlayerProgress();case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLoading=function(){var e=this;this.scene.tweens.add({targets:this.loading,alpha:1,duration:300,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){e.loading.setVisible(!0)}})},n.hideLoading=function(){var e=this;this.scene.tweens.add({targets:this.loading,alpha:0,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){e.loading.setVisible(!1)}})},n.hideLeaders=function(){this.leaderBlocks.forEach((function(e){e.setVisible(!1),e.setScale(.75),e.setAlpha(0)}))},n.showLeaders=function(){for(var e=0;e<this.leaderBlocks.length;e++){var t=this.leaderBlocks[e];t&&t.runShowUpAnimation(e,300)}},n.getChestPopup=function(){var e,t=this.chestPopupPool.find((function(e){return!e.active}));return t?(t.revive(),t):((e=GameCore.layoutInitializer.isLandscape?new mD(this.scene):new uD(this.scene)).revive(),this.chestPopupPool.push(e),this.add(e),e)},n.getPlayerBlock=function(){return this.playerBlock},n.setButtonsDisabled=function(e){this.closeButton.setDisabled(e),this.informationButton.setDisabled(e)},n.alignItems=function(){Phaser.Display.Align.In.BottomCenter(this.leaderboardBackground,this,0,-19),Phaser.Display.Align.In.BottomCenter(this.scroller,this,0,-16),Phaser.Display.Align.In.TopLeft(this.informationButton,this,-21,-26),Phaser.Display.Align.In.TopRight(this.closeButton,this,-17,-27),Phaser.Display.Align.In.TopCenter(this.header,this,1,34),Phaser.Display.Align.In.TopCenter(this.illustration,this,0,-10),Phaser.Display.Align.In.TopCenter(this.cupHeader,this,0,-1),Phaser.Display.Align.In.TopCenter(this.timerPanel,this,1,-84)},n.create=function(){this.createLeaderBlocksBackground(),this.createLeaderBlockScroller(),this.createLeaderBlocks(),this.createBackground(),this.createIllustration(),this.createInformationButton(),this.createCloseButton(),this.createHeader(),this.createCupHeader(),this.createTimerPanel(),this.createLoading(),this.createBlockInput(),this.createDevButtons()},n.createLeaderBlocksBackground=function(){var e=this.scene.add.image(0,0,d_,p_.LEADERBOARD.LEADERBOARD_BG);e.setDefaultWorldSize(),this.add(e),e.setScale(1.02*e.scale),this.leaderboardBackground=e},n.createLeaderBlockScroller=function(){var e=125/3;this.scroller=new RL.Z(this.scene,{width:1126/3,height:190,marginTop:0,marginBottom:-3}),this.scroller.createMask(),this.add(this.scroller);var t=-this.scroller.height/2+e/2+6;this.leaderBlockYs=Array.from({length:11},(function(n,i){return t+i*(e+0)}))},n.createLeaderBlocks=function(){for(var e=this,t=0;t<this.totalLeaders;t++){var n=this.leaderBlocks[t];n||(n=new c_(this.scene),this.leaderBlocks.push(n))}this.leaderBlocks.forEach((function(t,n){t.setPosition(0,e.leaderBlockYs[n]),e.scroller.addItem(t)})),this.hideLeaders()},n.createBackground=function(){var e=new uy(this.scene,{key:d_,frame:p_.LEADERBOARD.POPUP,width:1246/3,height:928/3,topHeight:380/3,bottomHeight:170/3});this.add(e),this.setSize(e.displayWidth,e.displayHeight),this.bg=e},n.createInformationButton=function(){var e=Wi.Z.WEEKLY_TOURNAMENT,t=e.KEY,n=e.FRAME;this.informationButton=new iv.Z(this.scene,{key:t,frame:n.LEADERBOARD.BUTTON.INFORMATION,width:19/3,height:14,paddingZone:20}),this.informationButton.setName("Information"),this.add(this.informationButton)},n.createCloseButton=function(){var e=Wi.Z.WEEKLY_TOURNAMENT,t=e.KEY,n=e.FRAME;this.closeButton=new iv.Z(this.scene,{key:t,frame:n.LEADERBOARD.BUTTON.CLOSE,width:40/3,height:14,paddingZone:20}),this.closeButton.setName("Close"),this.add(this.closeButton)},n.createIllustration=function(){var e=this.scene.add.image(0,0,d_,p_.LEADERBOARD.ILLUSTRATION);e.setDefaultWorldSize(),this.add(e),this.illustration=e},n.createHeader=function(){this.header=this.scene.add.container(0,0),this.add(this.header);var e=this.scene.add.image(0,0,d_,p_.LEADERBOARD.HEADER);e.setDefaultWorldSize(),this.header.add(e),this.header.setSize(e.width,e.height);var t=new Pf(this.scene);t.setText("Weekly Tournament"),t.setFontSize(22),t.setRadius(-1500),t.setLetterSpacing(-.2),t.setPosition(0,-1.5),this.header.add(t)},n.createCupHeader=function(){var e=this.scene.add.image(0,0,d_,p_.LEADERBOARD.CUP_HEADER);e.setDefaultWorldSize(),this.add(e),this.cupHeader=e},n.createTimerPanel=function(){this.timerPanel=new h_(this.scene),this.timerPanel.txt.setPosition(9,0),this.timerPanel.txt.clearTint(),this.timerPanel.txt.setFontSize(this.scene.fontSize(10));var e=this.scene.add.image(0,0,d_,p_.LEADERBOARD.TIME_PANEL);e.setDefaultWorldSize(),this.animateClock=new Jb(this.scene),this.animateClock.setPosition(-28,0),this.timerPanel.addAt(e,0),this.timerPanel.addAt(this.animateClock,1),this.add(this.timerPanel)},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setScaleByWorld(.5),this.loading.setWorldSize(64,64),this.loading.setVisible(!1),this.loading.setY(35),this.add(this.loading)},n.createBlockInput=function(){var e=this.scene.add.container(0,0);e.setSize(43,60),this.add(e),e.setPosition(77,-65),e.setInteractive()},n.createDevButtons=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=[this.createRewardButton("Claim\nGold",1),this.createRewardButton("Claim\nSilver",2),this.createRewardButton("Claim\nPurple",3),this.createRewardButton("Claim\nBronze",4),this.createRewardButton("Claim\nCoin",11)];t.forEach((function(t,n){t.setPosition(30*n-170,-70),e.debugButtons.push(t)}));var n=this.createEndTimeButton();n.setPosition(60,-70),this.debugButtons.push(n)}},n.createRewardButton=function(e,t){var n=this,i=this.createDevButton(e);return i.onClick=function(){n.scene.events.emit(m_.CLAIM_REWARD,t)},i},n.createEndTimeButton=function(){var e=this,t=this.createDevButton("End\nTime\nIn 5s");return t.onClick=function(){e.scene.weeklyTournament.updateWeeklyTournament({endTime:(Date.now()+5e3)/1e3}),e.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN)},t},n.createDevButton=function(e){var t=new Kp.Z(this.scene,30,30),n=this.scene.add.image(0,0,Wi.Z.WEEKLY_TOURNAMENT.KEY,Wi.Z.WEEKLY_TOURNAMENT.FRAME.LEADERBOARD.PLAYER.AVATAR.OVERLAY);n.setDefaultWorldSize(),t.add(n);var i=new jp(this.scene,{text:e,fontSize:this.scene.fontSize(8),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});return i.setAlign("center"),t.add(i),this.add(t),t},t}(Phaser.GameObjects.Container),m_={CLAIM_REWARD:"claimReward"},g_=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).leaders=[],s.needRestartTournament=!1,s.previousScreen=void 0,s.weeklyTournamentMainContainer=void 0,s.handleInformationButtonClick=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=s.previousScreen===ce.o4.DASHBOARD_SCREEN)&&s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),e.next=4,s.weeklyTournamentMainContainer.closeContainer();case 4:return e.next=6,s.scene.screen.openAsync(ce.o4.WEEKLY_TOURNAMENT.INTRO_SCREEN);case 6:return t&&s.scene.screen.open(ce.o4.DASHBOARD_SCREEN),s.scene.screen.bringToTop(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN),e.next=10,s.weeklyTournamentMainContainer.openContainer();case 10:case"end":return e.stop()}}),e)}))),s.handleCloseButtonClick=function(){s.scene.screen.close(s.name)},s.handleClaimReward=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.previousScreen=void 0,(n=s.weeklyTournamentMainContainer.getPlayerBlock())&&n.toggleClaimButtonVisibility(!1),s.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN),s.scene.screen.close(ce.o4.DASHBOARD_SCREEN),0!==(i=s.scene.weeklyTournament.getRewardData(t)).length){e.next=8;break}return e.abrupt("return",s.scene.screen.open(ce.o4.DASHBOARD_SCREEN));case 8:s.scene.requireTextureAsync("WEEKLY_TOURNAMENT_CHESTS").then((function(){s.scene.screen.open(ce.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN,{rewards:i,rank:t})}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.close=function(){s.runExitAnimation(),s.weeklyTournamentMainContainer.runHideChestPopup()},s.onEntranceCompleted=function(){},s.onExitCompleted=function(){e.prototype.close.call((0,fc.Z)(s)),s.weeklyTournamentMainContainer.hideLeaders(),s.weeklyTournamentMainContainer.animateClock.stopAnimation(),s.weeklyTournamentMainContainer.setAlpha(0),s.previousScreen&&s.scene.screen.open(s.previousScreen),s.needRestartTournament&&s.scene.weeklyTournament.restartTournament()},s.scene=t,s.create(),s.listenEvents(),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s.weeklyTournamentMainContainer.setAlpha(0),s}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){this.createWeeklyTournamentMainContainer()},n.listenEvents=function(){var e=this.weeklyTournamentMainContainer,t=e.informationButton,n=e.closeButton;t.onClick=this.handleInformationButtonClick,n.onClick=this.handleCloseButtonClick,this.scene.events.on(m_.CLAIM_REWARD,this.handleClaimReward,this),this.scene.weeklyTournament.events.on(So,this.updateTime,this)},n.createWeeklyTournamentMainContainer=function(){this.weeklyTournamentMainContainer=new f_(this.scene),this.weeklyTournamentMainContainer.setInteractive(),this.add(this.weeklyTournamentMainContainer),Phaser.Display.Align.In.Center(this.weeklyTournamentMainContainer,this,0,15)},n.open=function(){var t=(0,r.Z)(c().mark((function t(n){var i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),i=null!=n?n:{previousScreen:ce.o4.DASHBOARD_SCREEN},a=i.previousScreen,this.previousScreen=a,this.runEntranceAnimation(),t.next=6,this.handleFirstTimePlay();case 6:return this.updateTime(),this.weeklyTournamentMainContainer.openContainer(),t.next=10,this.weeklyTournamentMainContainer.updateData();case 10:this.updateShowClaimButton();case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.handleFirstTimePlay=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.weeklyTournament.getPlayerWeeklyTournamentData(),t.firstTimePlay){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return this.scene.weeklyTournament.updateWeeklyTournament({firstTimePlay:!1}),e.next=6,(0,le.qZ)(500);case 6:return e.next=8,this.handleInformationButtonClick();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateTime=function(){var e=this.scene.weeklyTournament;e.isFinished()?(this.weeklyTournamentMainContainer.timerPanel.timerLogic.setRemainingTime(0),this.updateShowClaimButton()):(this.weeklyTournamentMainContainer.timerPanel.timerLogic.setRemainingTime(e.getRemainingTime()),this.weeklyTournamentMainContainer.animateClock.animate())},n.updateShowClaimButton=function(){this.needRestartTournament=!1;var e=this.weeklyTournamentMainContainer.getPlayerBlock(),t=this.scene.weeklyTournament,n=t.isFinished(),i=t.hasReward();e&&(n?(i&&(e.toggleClaimButtonVisibility(i),this.scene.requireTextureAsync("WEEKLY_TOURNAMENT_CHESTS",!1)),this.needRestartTournament=!i):e.toggleClaimButtonVisibility(!1))},n.runEntranceAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_SHOW),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)],onComplete:this.onEntranceCompleted})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.weeklyTournamentMainContainer.closeContainer(),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this.weeklyTournamentMainContainer]},Cv.tweenConfigs.popup.configClose),(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),v_=Wi.Z.WEEKLY_TOURNAMENT_CHESTS,y_=v_.KEY,E_=v_.FRAME,C_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.chestContainer=void 0,n.title=void 0,n.illustrators=void 0,n.itemPool=[],n.chestItems=[],n.isChestOpened=!1,n.canClaimChestItems=!1,n.tapToOpenButton=void 0,n.tapToClaimButton=void 0,n.openChestPosition=void 0,n.rewardScreen=void 0,n.isRewardOnlyCoin=void 0,n.handleTapToOpen=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isChestOpened){e.next=15;break}if(n.isChestOpened=!0,n.tapToOpenButton.setDisabled(!0),n.hideTapToOpenOrClaimButton(n.tapToOpenButton,250),!n.isRewardOnlyCoin){e.next=8;break}n.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.CHEST_OPEN),e.next=11;break;case 8:return e.next=10,n.chestContainer.runChestOpenAnimation(n.openChestPosition.x,n.openChestPosition.y);case 10:n.runChangeText(n.title,"Your Rewards",250);case 11:return e.next=13,n.runPopupItemsFromChest();case 13:n.showTapToOpenOrClaimButton(n.tapToClaimButton,250,250),n.canClaimChestItems=!0;case 15:case"end":return e.stop()}}),e)}))),n.handleTapToClaim=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isChestOpened||!n.canClaimChestItems){e.next=13;break}return n.canClaimChestItems=!1,n.tapToClaimButton.setDisabled(!0),e.next=5,n.runObjectsExitAnimation();case 5:return e.next=7,(0,le.qZ)(100);case 7:return n.scene.screen.open(ce.o4.DASHBOARD_SCREEN),n.scene.screen.bringToTop(ce.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN),n.scene.weeklyTournament.restartTournament(),e.next=12,n.claimAllItems();case 12:n.scene.screen.close(ce.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN);case 13:case"end":return e.stop()}}),e)}))),n.scene=t,n.setSize(n.scene.gameZone.width,n.scene.gameZone.height),n.openChestPosition={x:0,y:60},n.create(),n.listenEvents(),n}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.tapToOpenButton.onClick=this.handleTapToOpen,this.tapToClaimButton.onClick=this.handleTapToClaim},n.setRewardScreen=function(e){this.rewardScreen=e},n.updateChestData=function(e){var t=e.rewards,n=e.rank;this.isRewardOnlyCoin=1===t.length&&t[0].type===qi.COIN;var i=this.getChestType(n);this.chestContainer=this.createChestContainer(i,zC.WEEKLY_TOURNAMENT),this.chestItems=this.spawnItems(t)},n.getChestType=function(e){return[KC.GOLD,KC.SILVER,KC.PURPLE,KC.BRONZE][e>=1&&e<=3?e-1:3]},n.spawnItems=function(e){var t=this;return e.map((function(e){var n=t.getItemContainer();return n.setEventType(zC.WEEKLY_TOURNAMENT),n.setType(e.type),n.setAmount(e.amount),n.revive(),n.setScale(0),t.bringToTop(n),n}))},n.getItemContainer=function(){var e=this.itemPool.find((function(e){return!e.active}));return e||(e=new iL(this.scene),this.itemPool.push(e),this.add(e)),e},n.runEntranceAnimation=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.runIllustratorsEntranceAnimation(),!this.isRewardOnlyCoin){e.next=7;break}this.runTitleEntranceAnimation("Your Rewards"),this.setOffsetYForItemPopup(0),this.handleTapToOpen(),e.next=12;break;case 7:return this.runTitleEntranceAnimation("Congratulations!"),this.setOffsetYForItemPopup(-75),e.next=11,this.chestContainer.runChestEntranceAnimation(0,0);case 11:this.showTapToOpenOrClaimButton(this.tapToOpenButton,250,100);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.isChestOpened=!1,this.canClaimChestItems=!1,this.title.setText("Congratulations!"),this.tapToOpenButton.setDisabled(!1),this.tapToClaimButton.setDisabled(!1)},n.runTitleEntranceAnimation=function(e){void 0===e&&(e="Congratulations!"),this.title.setText(e),this.scene.tweens.add({targets:[this.title],delay:100,ease:Phaser.Math.Easing.Back.Out,duration:250,scale:{from:0,start:0,to:1},alpha:{from:0,start:0,to:1}})},n.runIllustratorsEntranceAnimation=function(){this.scene.tweens.add({targets:this.illustrators,delay:100,duration:150,ease:Phaser.Math.Easing.Sine.Out,alpha:{from:0,start:0,to:1},y:{from:this.illustrators.y+20,start:this.illustrators.y+20,to:this.illustrators.y},scaleX:{from:1.05,start:1.05,to:1}})},n.runObjectsExitAnimation=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rewardScreen.runFadeBackground(0);case 2:return t=this.chestContainer.runChestExitAnimation(),n=this.runIllustratorsExitAnimation(),i=this.hideTapToOpenOrClaimButton(this.tapToClaimButton,250),a=this.scene.tweens.add({targets:[this.title],ease:Phaser.Math.Easing.Back.In,duration:250,scale:{from:1,start:1,to:0},alpha:{from:1,start:1,to:0}}).waitForCompletion(),r=[t,i,a,n],e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runIllustratorsExitAnimation=function(){var e=this;return this.scene.tweens.add({targets:this.illustrators,duration:150,ease:Phaser.Math.Easing.Sine.In,alpha:{from:1,start:1,to:0},y:{from:this.illustrators.y,start:this.illustrators.y,to:this.illustrators.y+20},onComplete:function(){e.illustrators.setPosition(0,e.height/2-e.illustrators.height/2)}}).waitForCompletion()},n.claimAllItems=function(){var e=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.find((function(e){return e.itemType===qi.COIN})),n=this.chestItems.filter((function(e){return e.itemType!==qi.COIN})),this.runClaimCoin(t),e.next=5,this.runClaimItems(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runClaimCoin=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.runExitAnimation();case 4:return n=t.getWorldPosition(),i=n.x,a=n.y,(r=this.scene.rewardManager).rewardCoin(t.getAmount()),this.scene.logEconomy.logGetItem(fl.COIN,t.getAmount(),gl.WEEKLY_TOURNAMENT),e.abrupt("return",r.coinAnimationPool.runAnimationRewardCoinAsync(15,i,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runClaimItems=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLevelButton(),i=this.getLocalPoint(n.getWorldPosition().x,n.getWorldPosition().y),a=i.x,r=i.y,s=0,o=function(){n.runClaimItemsAnimation()},h=t.map((function(e){s+=150;var t=e.runClaimAnimation(a,r,600,s,o);return e.runHideItemAmountAnimation(150,0),t})),e.next=7,Promise.all(h);case 7:return e.next=9,(0,le.qZ)(550);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getLevelButton=function(){return this.scene.screen.get(ce.o4.DASHBOARD_SCREEN).levelButton},n.showTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:0,start:0,to:1},onStart:function(){e.revive(),e.text.setScale(0)}}).waitForCompletion()},n.hideTapToOpenOrClaimButton=function(e,t,n){return void 0===n&&(n=0),this.scene.tweens.add({targets:e.text,duration:t,delay:n,ease:Phaser.Math.Easing.Sine.Out,scale:{from:1,start:1,to:0},onComplete:function(){e.kill(),e.text.setScale(0)}}).waitForCompletion()},n.runChangeText=function(e,t,n){this.scene.tweens.add({targets:e,duration:n,ease:Phaser.Math.Easing.Sine.In,yoyo:!0,scale:0,alpha:0,onYoyo:function(){e.setText(t)}})},n.create=function(){this.createTitle(),this.createIllustrators(),this.createTapToOpenButton(),this.createTapToClaimButton()},n.createTitle=function(){var e=GameCore.layoutInitializer.isLandscape?30:26,t=this.scene.make.bitmapText({font:Pc.ZP.STYLE.KEY,size:this.scene.fontSize(e),text:"Congratulations!",origin:{x:.5,y:.5}});this.add(t),this.title=t},n.createIllustrators=function(){var e=this.scene.add.container(0,0);this.add(e);var t=this.scene.add.image(0,0,y_,E_.WEEKLY_TOURNAMENT.ILLUSTRATOR.LEFT);t.setDefaultWorldSize(),e.add(t);var n=this.scene.add.image(0,0,y_,E_.WEEKLY_TOURNAMENT.ILLUSTRATOR.RIGHT);n.setDefaultWorldSize(),e.add(n),e.setSize(this.width,t.displayHeight),t.setPosition(-this.width/2+t.width/2,0),n.setPosition(this.width/2-n.width/2,0),e.setPosition(0,this.height/2-e.height/2),this.illustrators=e},n.createChestContainer=function(e,t){if(this.chestContainer)this.chestContainer.updateChestFrame(e,t);else{var n=new VC(this.scene,e,t);this.add(n),this.chestContainer=n}return this.chestContainer},n.createTapToOpenButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new vT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to open!"),t.setName("TapToOpen"),this.add(t),this.tapToOpenButton=t,t.kill()},n.createTapToClaimButton=function(){var e=GameCore.layoutInitializer.isLandscape?16:20,t=new vT(this.scene);t.text.setFontSize(this.scene.fontSize(e)),t.text.setText("Tap to claim!"),t.setName("TapToClaim"),this.add(t),this.tapToClaimButton=t,t.kill()},t}(Phaser.GameObjects.Container),A_=function(e){function t(t){var n;return(n=e.call(this,t)||this).offsetY=void 0,n.alignUI(),n.setOffsetYForItemPopup(-70),n.openChestPosition={x:0,y:60},n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-20),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-10),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-10)},n.setOffsetYForItemPopup=function(e){this.offsetY=e},n.runPopupItemsFromChest=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.calculateRowPositions(this.chestItems),n=this.chestItems.map((function(e,n){var a=i.chestContainer.x,r=i.chestContainer.y-30,s=t[n],o=s.x,c=s.y,h=100*n;return e.runEntranceAnimation(a,r,o,c,400,h)})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.calculateRowPositions=function(e){var t=this,n=(e.length-1)/2;return e.map((function(e,i){return{x:70*(i-n),y:16*Math.abs(i-n)+t.offsetY}}))},t}(C_),w_=function(e){function t(t){var n;return(n=e.call(this,t)||this).offsetY=void 0,n.alignUI(),n.openChestPosition={x:0,y:110},n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){Phaser.Display.Align.In.Center(this.title,this,0,-220),Phaser.Display.Align.In.BottomCenter(this.tapToOpenButton.text,this,0,-30),Phaser.Display.Align.In.BottomCenter(this.tapToClaimButton.text,this,0,-30)},n.setOffsetYForItemPopup=function(e){this.offsetY=e},n.runPopupItemsFromChest=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chestItems.length>4?3:4,n=Math.ceil(this.chestItems.length/t),i=this.splitItemsIntoRows(this.chestItems,t),a=i.flatMap((function(e,t){var i=100*t;return s.calculateRowPositions(e,n,i)})),r=this.chestItems.map((function(e,t){var n=s.chestContainer.x,i=s.chestContainer.y-30,r=a[t],o=r.x,c=r.y,h=100*t;e.runEntranceAnimation(n,i,o,c,400,h)})),e.next=7,Promise.all(r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.splitItemsIntoRows=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},n.calculateRowPositions=function(e,t,n){var i=t>1?-140:-90,a=(e.length-1)/2;return e.map((function(e,t){return{x:70*(t-a),y:16*Math.abs(t-a)+i+n}}))},t}(C_),S_=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.rewardContainer=void 0,s.onExitCompleted=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.close.call((0,fc.Z)(s)),s.background.setAlpha(1);case 2:case"end":return t.stop()}}),t)}))),s.scene=t,s.rewardContainer=GameCore.layoutInitializer.isLandscape?new A_(s.scene):new w_(s.scene),s.rewardContainer.setRewardScreen((0,fc.Z)(s)),s.add(s.rewardContainer),s.setDepth(ce.Ks.POPUP),s.setAlpha(0),yp.Z.registerObject(s.background,ce.MR.MULTIPLY_ALPHA),s}(0,s.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this),this.runEntranceAnimation(),this.rewardContainer.updateChestData(t),this.rewardContainer.runEntranceAnimation()},n.close=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rewardContainer.close(),this.runExitAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runFadeBackground=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.tweens.add({targets:this.background,alpha:{from:this.background.alpha,start:this.background.alpha,to:t},duration:150,ease:Phaser.Math.Easing.Sine.InOut}).waitForCompletion(),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configOpen)]})},n.runExitAnimation=function(){this.scene.audio.playAudioSprite(Fc.Z.UI.KEY,ec.Z.POPUP_OFF),this.scene.tweens.timeline({tweens:[(0,a.Z)({targets:[this]},Cv.tweenConfigs.screen.configClose)],onComplete:this.onExitCompleted})},t}(GameCore.Screen),b_=S_,T_=Wi.Z.GAMEPLAY_OBJECTS,x_=T_.KEY,P_=T_.FRAME,k_=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.settingsMenu=void 0,n.settingsOpening=void 0,n.settingsPlaying=void 0,n.canHandleSettings=void 0,n.endGameBtn=void 0,n.openSettings=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=250),n.settingsMenu.openSettings(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.closeSettings=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=250),n.settingsMenu.closeSettings(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSettingsMenuAutoClose=function(e){n.settingsMenu.getBounds().contains(e.worldX,e.worldY)||n.closeSettings()},n.handleSettingsOnClick=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.settingsOpening?n.closeSettings():n.openSettings();case 1:case"end":return e.stop()}}),e)}))),n.handleSoundChange=function(e){n.scene.player.setSetting("sound",e)},n.handleMusicChanged=function(e){n.scene.player.setSetting("music",e),e?n.scene.resumeMusic():n.scene.audio.pauseAllMusics()},n.handleVibrationChanged=function(e){n.scene.player.setSetting("vibrate",e),e&&n.scene.vibration.performVibrating(50)},n.handleOpenExitGameScreen=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.canHandleSettings){e.next=2;break}return e.abrupt("return");case 2:n.scene.screen.open(ce.o4.EXIT_GAME_SCREEN,{exitCallback:function(){n.scene.turnOffMusic(Fc.Z.GAMEPLAY_BACKGROUND.KEY),n.scene.screen.close(ce.o4.EXIT_GAME_SCREEN),n.scene.gameplay.boardGame.stateMachine.emit(Jh.EXIT);var e=n.scene.gameplay.boardGame.blackBackground.alpha;n.scene.gameplay.boardGame.runFadeBackground(e,0,250,0)},playOnCallback:function(){n.scene.screen.close(ce.o4.EXIT_GAME_SCREEN)},eventItems:n.scene.gameplay.eventManager.getCurrentEventItems()}),n.handleSettingsOnClick();case 4:case"end":return e.stop()}}),e)}))),n.handleExitGame=function(){n.endGameBtn.active&&n.scene.gameplay.enableCardInput&&n.scene.screen.open(ce.o4.EXIT_GAME_SCREEN,{exitCallback:function(){var e=n.scene.gameplay.boardGame,t=n.scene.world.getWorldSize(),i=t.width,a=t.height;n.scene.screen.close(ce.o4.EXIT_GAME_SCREEN),e.locks.forEach((function(e){e.exit()})),e.blowCardsBehavior.blow(i/2,a/2).then((function(){e.stateMachine.emit(Jh.LOSE)})),n.scene.gameUI.gameUILayout.hidePlusCardsButtons(),n.scene.audio.playAudioSprite(Fc.Z.CONGRATS_SOUND.KEY,ec.Z.END_GAME),n.scene.analytics.event(te._.LEVEL_GIVE_UP,{level:n.scene.level.getLevel()})},playOnCallback:function(){n.scene.screen.close(ce.o4.EXIT_GAME_SCREEN)}})},n.scene=t;var i=n.scene.gameZone.width;return n.setSize(i,40),n.createButtons(),t.add.existing((0,fc.Z)(n)),n.scene.input.on(Phaser.Input.Events.POINTER_UP,n.handleSettingsMenuAutoClose,(0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createButtons=function(){this.createEndGameBtn(),this.createSettingsBtn()},n.createEndGameBtn=function(){var e=this.scene.add.image(0,0,x_,P_.BTN_END_GAME);e.setDefaultWorldSize();var t=new Kp.Z(this.scene,e.width,e.height);t.add(e),t.setName("EndGame");var n=new jp(this.scene,{text:this.scene.lang.Text.endGame2,fontSize:this.scene.fontSize(13),strokeColor:9111316,strokeThickness:2.5,strokeOffset:{y:.5},strokeAlpha:.9});n.setY(-1),t.add(n),this.endGameBtn=t,this.add(this.endGameBtn),this.endGameBtn.onClick=this.handleExitGame},n.createSettingsBtn=function(){this.settingsMenu=new gP(this.scene),this.settingsMenu.setName("SettingsMenu"),Phaser.Display.Align.In.LeftCenter(this.settingsMenu,this,-2,-4),this.add(this.settingsMenu),this.settingsMenu.close(0)},n.setCanHandleSettings=function(e){this.settingsMenu.setCanHandleSettings(e)},n.updateData=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=void 0===t||t,i=e.music,a=void 0===i||i,r=e.vibrate,s=void 0===r||r,o=this.settingsMenu,c=o.soundSwitchUI,h=o.musicSwitchUI,u=o.vibrationSwitchUI;c.button.updateStatus(n),h.button.updateStatus(a),u&&u.button.updateStatus(s)},t}(Phaser.GameObjects.Container),I_=k_,O_=Wi.Z.GAMEPLAY_DEFAULT,R_=O_.KEY,B_=O_.FRAME,D_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.avatar=void 0,n.scoreText=void 0,n.cupIcon=void 0,n.score=void 0,n.avatarContainer=void 0,n.scene=t,n.setSize(81,25.5),n.createBackground(),n.createAvatar(),n.createText(),n.reset(),n}(0,s.Z)(t,e);var n=t.prototype;return n.reset=function(){this.scoreText.setText("0"),this.score=0},n.alignLeft=function(){this.scoreText.setLeftAlign(),this.scoreText.setOrigin(0,.5),Phaser.Display.Align.In.LeftCenter(this.avatarContainer,this,-6),Phaser.Display.Align.In.LeftCenter(this.scoreText,this,-35)},n.alignRight=function(){this.scoreText.setRightAlign(),this.scoreText.setOrigin(1,.5),Phaser.Display.Align.In.RightCenter(this.avatarContainer,this,-6),Phaser.Display.Align.In.RightCenter(this.scoreText,this,-35)},n.createBackground=function(){var e=this.scene.make.nineslice({key:R_,frame:B_.THREE_SLICES.COIN_PANEL_GRAY,leftWidth:10,rightWidth:10});e.setSizeByWorld(this.width,this.height),this.add(e)},n.createAvatar=function(){var e=this.scene.add.container(0,0),t=this.scene.add.image(0,0,R_,B_.AVATAR_BORDER);t.setScaleByWorld(.4),e.setSize(t.width,t.height),this.avatar=new Ic(this.scene,{width:29,height:29,key:R_,background:"blank"}),this.avatar.background.kill(),this.avatar.loadPhoto(ie.Z.AVATAR.KEY,ie.Z.AVATAR.FILE),e.add([t,this.avatar]),this.add(e),this.avatarContainer=e},n.createIcon=function(){var e=this.scene.add.image(-6,0,R_,B_.IC_CUP);e.setDefaultWorldSize(),this.add([e]),this.cupIcon=e},n.createText=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.NORMAL.KEY,size:this.scene.fontSize(14),text:"0",origin:{x:.5,y:.5}});this.add(e),this.scoreText=e,this.scoreText.setTint(7031916)},n.updateData=function(e){this.scoreText.setText(""+(null!=e?e:"..."))},t}(Phaser.GameObjects.Container),L_=D_,__=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leftBlock=void 0,n.rightBlock=void 0,n.scene=t,n.setSize(375,62),n.createBlocks(),n.createVSText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createBg=function(){var e=this.width,t=this.height,n=new Rv.Z(this.scene,0,0,e,t,0,16579837);this.add(n)},n.createBlocks=function(){this.leftBlock=new L_(this.scene),this.leftBlock.alignRight(),this.rightBlock=new L_(this.scene),this.rightBlock.alignLeft(),this.leftBlock.setX(-60),this.leftBlock.setY(-3),this.rightBlock.setX(60),this.rightBlock.setY(-3),this.add([this.leftBlock,this.rightBlock])},n.createVSText=function(){var e=new hv(this.scene);e.setColor(11106656),e.setFontSize(24),e.setText("VS"),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-3)},n.alignChildren=function(){this.leftBlock.setX(-60),this.rightBlock.setX(60)},t}(Phaser.GameObjects.Container),M_=__,N_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.setSize(375,62),n}return(0,s.Z)(t,e),t.prototype.alignChildren=function(){},t}(Phaser.GameObjects.Container),G_=N_,Z_=function(e){function t(t){var n;return(n=e.call(this,t)||this).label=void 0,n.text=void 0,n.createLabel(),n.createText(),n.alignComponents(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createLabel=function(){this.label=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(20),text:"Label",origin:{x:.5,y:.5}}),this.add(this.label)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(20),text:"999",origin:{x:0,y:.5}}),this.add(this.text)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.label,this),Phaser.Display.Align.To.RightCenter(this.text,this.label,7)},t}(Phaser.GameObjects.Container),F_=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Stars"),n.text.setOrigin(1,.5),Phaser.Display.Align.In.RightCenter(n.text,(0,fc.Z)(n),0),Phaser.Display.Align.To.LeftCenter(n.label,n.text,7),n.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){li.instance.isSingleMode()&&n.label.setX(-35-9*n.text.text.length)})),n}return(0,s.Z)(t,e),t}(Z_),U_=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Score"),n}return(0,s.Z)(t,e),t}(Z_),W_=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.kill(),n.text.setOrigin(.5,.5),Phaser.Display.Align.In.Center(n.text,(0,fc.Z)(n)),n}return(0,s.Z)(t,e),t.prototype.alignComponents=function(){Phaser.Display.Align.In.Center(this.text,this)},t}(Z_),H_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.movesBlock=void 0,n.timeBlock=void 0,n.scoreBlock=void 0,n.scene=t,n.setSize(375,54),n.createContent(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createScore(),this.createTime(),this.createMoves()},n.createMoves=function(){this.movesBlock=new F_(this.scene),this.add(this.movesBlock)},n.createTime=function(){this.timeBlock=new W_(this.scene),this.add(this.timeBlock)},n.createScore=function(){this.scoreBlock=new U_(this.scene),this.add(this.scoreBlock)},n.alignChildren=function(){},t}(Phaser.GameObjects.Container),Y_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n._tournamentTitle=void 0,n.scene=t,n.setSize(375,62),n.createContent(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle()},n.createTitle=function(){this._tournamentTitle=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"Tournament",origin:{x:.5,y:.5},y:-15}),this.add(this._tournamentTitle),Phaser.Display.Align.In.BottomCenter(this._tournamentTitle,this)},(0,H.Z)(t,[{key:"tournamentTitle",get:function(){return this._tournamentTitle}}]),t}(Phaser.GameObjects.Container),K_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n._statBlock=void 0,n._titleBlock=void 0,n.scene=t,n.createContent(),n.setSize(375,n._titleBlock.height+n._statBlock.height),n.alignChildren(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createBg=function(){var e=this.width,t=this.height,n=new Rv.Z(this.scene,0,0,e,t,0,16579837);this.add(n)},n.createContent=function(){this.createTitle(),this.createStat()},n.createTitle=function(){this._titleBlock=new Y_(this.scene),this.add(this._titleBlock)},n.createStat=function(){this._statBlock=new H_(this.scene),this.add(this._statBlock)},n.alignChildren=function(){Phaser.Display.Align.In.TopCenter(this._titleBlock,this),Phaser.Display.Align.In.BottomCenter(this._statBlock,this,0,-5)},(0,H.Z)(t,[{key:"statBlock",get:function(){return this._statBlock}},{key:"titleBlock",get:function(){return this._titleBlock}}]),t}(Phaser.GameObjects.Container),z_=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.singleInfo=void 0,n.challengeInfo=void 0,n.tournamentInfo=void 0,n.scene=t,n.setSize(t.gameZone.width,50),t.add.existing((0,fc.Z)(n)),n.createChallengeInfo(),n.createSingleInfo(),n.createTournamentInfo(),n}(0,s.Z)(t,e);var n=t.prototype;return n.getInfoContainersWithout=function(e){return[this.singleInfo,this.challengeInfo,this.tournamentInfo].filter((function(t){return t!==e}))},n.useChallengeInfo=function(){if(!this.challengeInfo.active){var e=this.getInfoContainersWithout(this.challengeInfo);this.challengeInfo.revive(),this.scene.tweens.add({targets:this.challengeInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){iu(90)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.useSingleInfo=function(){if(!this.singleInfo.active){var e=this.getInfoContainersWithout(this.singleInfo);e.map((function(e){return e.kill()})),this.singleInfo.revive(),this.scene.tweens.add({targets:this.singleInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){iu(70)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.useTournamentInfo=function(){if(!this.tournamentInfo.active){var e=this.getInfoContainersWithout(this.tournamentInfo);this.tournamentInfo.revive(),this.scene.tweens.add({targets:this.tournamentInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){iu(95)}}),this.scene.tweens.add({targets:e,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return e.map((function(e){return e.kill()}))}})}},n.createChallengeInfo=function(){var e=new M_(this.scene);this.challengeInfo=e,this.add(e),this.challengeInfo.kill()},n.createSingleInfo=function(){var e=new G_(this.scene);this.singleInfo=e,this.add(e)},n.createTournamentInfo=function(){var e=new K_(this.scene);this.tournamentInfo=e,this.add(e),this.tournamentInfo.kill()},n.update=function(){var e=this.scene.gameplay,t=e.scoreManager,n=e.comboManager,i=t.getTotalScore(),a=t.getStars();n.getCombo().length;switch(li.instance.getGameMode()){case oi.SINGLE:break;case oi.CHALLENGE_FRIENDS:this.challengeInfo.leftBlock.scoreText.setText(""+i);break;case oi.TOURNAMENT:var r=this.tournamentInfo.statBlock,s=r.movesBlock;r.timeBlock;r.scoreBlock.text.setText(""+i),s.text.setText(""+a)}},n.alignChildren=function(){this.singleInfo.alignChildren(),this.challengeInfo.alignChildren(),this.tournamentInfo.statBlock.alignChildren()},t}(Phaser.GameObjects.Container),V_=z_,j_=68/3,X_=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).scene=void 0,a.levelText=void 0,a.bg=void 0,a.scene=t,a.create(),a.setSize(134/3,j_),a}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=Wi.Z.GAMEPLAY_DEFAULT,t=e.KEY,n=e.FRAME,i=this.scene.make.nineslice({key:t,frame:n.THREE_SLICES.BAR_LEVEL,leftWidth:32/3,rightWidth:32/3,width:134/3,height:j_}),a=new jp(this.scene,{text:this.scene.lang.Text.level,fontSize:this.scene.fontSize(8),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2}),r=this.scene.level.getLevel(),s=new jp(this.scene,{text:""+r,fontSize:this.scene.fontSize(12),strokeBlur:2,strokeBlurColor:0,strokeBlurAlpha:.2});this.add([i,a,s]),Phaser.Display.Align.In.Center(a,this,0,-6),Phaser.Display.Align.In.Center(s,this,0,4),this.bg=i,this.levelText=s},n.update=function(e){this.levelText.setText(e.toString());var t=19+7.7*Math.max(e.toString().length,3);this.bg.setSizeByWorld(t,j_),this.setSize(t,j_)},t}(Phaser.GameObjects.Container),q_=X_,J_=Wi.Z.GAMEPLAY_DEFAULT,Q_=J_.KEY,$_=J_.FRAME,eM=function(e){function t(t){var n,i;return(i=e.call(this,t,Q_,{background:$_.THREE_SLICES.COIN_PANEL_GRAY,icon:$_.IC_HEART,button:$_.IC_PLUS})||this).timeUpdatable=void 0,i.amountHeartsText=void 0,i.value.setTint(7031916),null==(n=i.button)||n.setScaleByWorld(.7),i.icon.setScaleByWorld(1.2),i.setName("LifeBar"),i.setTimeUpdatable(!1),i.createAmountHeartsText(),i.alignObject(),i}(0,s.Z)(t,e);var n=t.prototype;return n.setTimeUpdatable=function(e){this.timeUpdatable=e},n.getIconHeartPos=function(){return this.icon.getWorldPosition()},n.update=function(){if(this.timeUpdatable){var e=this.scene.life.getTimeLeftToReceiveHeart(),t=Math.floor(e/60),n=e%60;this.value.setText(t.toString().padStart(2,"0")+"m:"+n.toString().padStart(2,"0")+"s"),this.alignObject()}},n.updateHearts=function(e){this.amountHeartsText.setText(e.toString()),Phaser.Display.Align.In.Center(this.amountHeartsText,this.icon,-2,1)},n.updateCounter=function(e,t){var n,i;e>=t?(this.setTimeUpdatable(!1),null==(n=this.button)||n.kill(),this.value.setText("Max"),this.bar.setSize(80,25.5)):(this.setTimeUpdatable(!0),null==(i=this.button)||i.revive(),this.bar.setSize(120,25.5));this.alignObject()},n.alignObject=function(){e.prototype.alignObject.call(this),this.value.setY(-1),this.timeUpdatable?(this.value.setX(-this.width/2+this.bar.width/2+2),this.button&&Phaser.Display.Align.In.RightCenter(this.button,this.bar,-3)):this.value.setX(-this.width/2+this.bar.width/2+10)},n.createAmountHeartsText=function(){this.amountHeartsText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),origin:{x:.5,y:.5},text:"0"}),this.add(this.amountHeartsText)},t}(Ik),tM=eM,nM=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateHearts=void 0,n.lifeBar=void 0,n.openBuyHeartScreen=function(){n.scene.life.getHearts()>=n.scene.life.getMaxHearts()||n.scene.rewardManager.isDailyRewarding||n.scene.screen.open(ce.o4.OUT_OF_HEARTS_SCREEN)},n.setName("LifeBar"),n.scene=t,n.create(),n.setAutoUpdateHearts(!0),n.onClick=n.openBuyHeartScreen,n.button.kill(),n.hitZone.setSize(120,28),n}(0,s.Z)(t,e);var n=t.prototype;return n.setAutoUpdateHearts=function(e){this.autoUpdateHearts=e},n.create=function(){var e=new tM(this.scene);this.add(e),this.lifeBar=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1)},n.update=function(){this.lifeBar.update()},t}(Hc.Z),iM=nM,aM=Wi.Z.DASHBOARD,rM=aM.KEY,sM=aM.FRAME,oM=function(e){function t(t){var n;return(n=e.call(this,t,rM,{background:sM.BAR_VALUE.COIN,icon:sM.ICON.COIN})||this).scene=void 0,n.bounceTween=void 0,n.addIcon=void 0,n.bar.setSizeByWorld(290/3,23),n.scene=t,n.icon.setDefaultWorldSize(),n.value.setTint(16777215),n.value.setFontSize(14),n.setName("ScoreBar"),n.maxValue=1e6,n.align(),n.createAddIcon(),n}(0,s.Z)(t,e);var n=t.prototype;return n.animateAddIcon=function(e,t){this.scene.add.tween({targets:this.addIcon,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.setValue=function(e){var t="";t=e>=1e5?(0,Ok.Z)(e):e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),this.value.setText(t)},n.updateBarSize=function(e,t){this.bar.setSizeByWorld(e,t)},n.align=function(){this.alignObject(),this.value.setY(.5),Phaser.Display.Align.In.LeftCenter(this.icon,this.bar,1,0)},n.getIconCoinPosition=function(){var e=this.icon.getWorldPosition();return{x:e.x-2,y:e.y-2.2}},n.getBarSize=function(){var e=this.bar;return{width:e.displayWidth,height:e.displayHeight}},n.getWorldPositionOfCoin=function(){return this.icon.getWorldPosition()},n.getCoinLabelPosition=function(){return this.value.getWorldPosition()},n.runBounceCoinTextAnimation=function(){var e,t;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this.value,scale:"+=0.2",yoyo:!0,repeat:2,ease:Phaser.Math.Easing.Sine.InOut,duration:180}))},n.createAddIcon=function(){var e=this.scene.add.image(0,0,rM,sM.ICON.ADD);e.setDefaultWorldSize(),this.add(e),Phaser.Display.Align.In.BottomRight(e,this.icon,2.5,3),this.addIcon=e,this.addIcon.setVisible(!1)},t}(Ik),cM=oM,hM=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateCoin=void 0,n.coinBar=void 0,n.bounceTween=void 0,n.coinsNumber=void 0,n.barLength=void 0,n.onBuyCoin=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.scene.screen.open(ce.o4.GET_COINS_SCREEN,{claimedCoin:pf.instance.reward.rewardedAdOffer});case 1:case"end":return e.stop()}}),e)}))),n.setName("CoinBar"),n.button.kill(),n.scene=t,n.coinsNumber=-1,n.barLength=0,n.autoUpdateCoin=!0,n.create(),n.setValue(0),n.setDisabled(!0),n}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new cM(this.scene);this.add(e),this.coinBar=e},n.setAutoUpdateCoin=function(e){this.autoUpdateCoin=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1);var n=t?0:1;this.coinBar.animateAddIcon(n,200)},n.updateCoins=function(e){this.runCounter(e)},n.updateHitZoneSize=function(e,t,n){this.hitZone.setSize(e,t);var i=Math.max(0,n-3);this.hitZone.setX(5*i-8)},n.setValue=function(e){var t;if(this.coinsNumber!=e){e<0&&(e=0),this.coinBar.setValue(e),this.coinsNumber=e;var n,i,a=Math.max(this.coinBar.getValueLength(),3),r=37.5+9*a;if(this.barLength!=r&&(this.barLength=r,this.coinBar.updateBarSize(r,25.5)),this.coinBar.align(),this.updateHitZoneSize(r,25.5,a),null!=(t=this.scene.gameUI)&&t.isCoinShowing())null==(n=this.scene.gameUI)||n.alignLevelTitle(),null==(i=this.scene.gameUI)||i.alignStarBarButton()}},n.runCounter=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.coinsNumber,e.abrupt("return",_b(this.scene,{startNumber:n,endNumber:t,onUpdate:function(e){var t=Math.floor(e.getValue());i.setValue(t)}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBounceCoinButtonAnimation=function(){var e,t,n=this;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this,scale:.92,yoyo:!0,duration:50,onComplete:function(){n.scene.tweens.add({targets:n,scale:1,duration:50})}}))},t}(Hc.Z),uM=hM,lM=function(e){this.gameUI=void 0,this.showPlusCardsButtonsPromise=null,this.hidePlusCardsButtonsPromise=null,this.isPlusCardsButtonsShown=!0,this.gameUI=e},dM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t.scene,n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){this.alignCoinBar(),this.alignStarBar(),this.alignLevelTitle(),this.alignStreakBar(),this.alignGameUIFooter(),this.alignWildCard(),this.alignStockAndWaste(),this.alignUndoButton(),this.alignPlusCardsButtons(),this.checkOverlap()},n.alignCoinBar=function(){var e=this.gameUI.coinBarButton;Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-39,-2),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStarBar=function(e){void 0===e&&(e=!0);var t=this.gameUI,n=t.coinBarButton,i=t.starBarButton;this.scene.backupGameObjectSystem.list.delete(i),e&&i.setY(n.y),i.setX(n.x+n.coinBar.getBarSize().width+15),this.scene.backupGameObjectSystem.backupObjectProp(i,i.x,n.y)},n.alignLevelTitle=function(){var e=this.gameUI,t=e.levelTitle,n=e.coinBarButton;this.scene.backupGameObjectSystem.list.delete(t),Phaser.Display.Align.In.Center(t,n,n.coinBar.getBarSize().width-20,0),this.scene.backupGameObjectSystem.backupObject(t)},n.alignStreakBar=function(){var e=this.scene.gameplay.comboManager.streakBar;Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-19,-9),this.scene.backupGameObjectSystem.backupObject(e)},n.alignGameUIFooter=function(){var e=this.gameUI.footer,t=e.settingsMenu,n=e.endGameBtn;Phaser.Display.Align.In.LeftCenter(n,e,-44,1),Phaser.Display.Align.In.BottomCenter(e,this.scene.gameZone,0,-5),this.scene.backupGameObjectSystem.backupObject(t),this.scene.backupGameObjectSystem.backupObject(n)},n.alignWildCard=function(){var e=this.scene.gameplay.coinUsingManager,t=e.wildCardBtn,n=e.wildCardWrapper,i=this.scene.gameZone.width-t.width/2-8,a=this.scene.gameZone.height-n.height/2-6;n.setPosition(i,a),this.scene.backupGameObjectSystem.backupObject(n)},n.alignStockAndWaste=function(){var e=this.scene.gameplay.boardGame,t=e.waste,n=e.stock;t.setPosition(t.x+4,t.y),n.setPosition(n.x+4,n.y)},n.alignUndoButton=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager.undoBtn;t.setPosition(e.x+61,this.scene.gameZone.height-t.height/2-7-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(t)},n.alignPlusCardsButtons=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager,n=t.addCardsBtn,i=t.addCardsByAdsBtn,a=t.addCardsFreeBtn;n.setPosition(e.x-64,this.scene.gameZone.height-n.height/2-6-this.scene.world.getSAB()),a.setPosition(e.x-64,this.scene.gameZone.height-a.height/2-5-this.scene.world.getSAB()),i.setPosition(e.x-158,this.scene.gameZone.height-i.height/2-6-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(a)},n.checkOverlap=function(){var e=this.gameUI.footer.endGameBtn,t=this.scene.gameplay.coinUsingManager,n=t.undoBtn,i=t.addCardsBtn,a=t.addCardsByAdsBtn,r=t.addCardsFreeBtn;this.scene.backupGameObjectSystem.backupObject(e),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(a),this.scene.backupGameObjectSystem.backupObject(r)},n.showEndGame=function(){var e=this.gameUI.footer.endGameBtn;this.gameUI.showElement(e,0)},n.hideEndGame=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.endGameBtn;this.gameUI.hideElement(t,0,200,0,e)},n.showSettingsButton=function(){var e=this.gameUI.footer.settingsMenu;this.gameUI.showElement(e,0)},n.hideSettingsButton=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.settingsMenu;this.gameUI.hideElement(t,-200,100,0,e)},n.showPlusCardsButtons=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.scene.gameplay.coinUsingManager.addCardsBtn,i=[n.x,n.x-78],!this.showPlusCardsButtonsPromise){e.next=4;break}return e.abrupt("return");case 4:if(!this.isPlusCardsButtonsShown){e.next=6;break}return e.abrupt("return");case 6:this.showPlusCardsButtonsPromise=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e,t){var n=i[t],r=a.scene.gameZone.height-e.height/2-6-a.scene.world.getSAB();return e.setPosition(n,r),a.scene.backupGameObjectSystem.backupObject(e),a.gameUI.hideElement(e,0,200,0,0),e.revive(),a.gameUI.showElement(e,0)})),a.isPlusCardsButtonsShown=!0,e.next=4,Promise.all(n);case 4:a.showPlusCardsButtonsPromise=null;case 5:case"end":return e.stop()}}),e)})))();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hidePlusCardsButtons=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=200),!this.hidePlusCardsButtonsPromise){e.next=3;break}return e.abrupt("return");case 3:if(this.isPlusCardsButtonsShown){e.next=5;break}return e.abrupt("return");case 5:return n=this.scene.gameplay.coinUsingManager,i=n.addCardsBtn,a=n.addCardsByAdsBtn,r=n.addCardsFreeBtn,this.hidePlusCardsButtonsPromise=Promise.all([this.gameUI.hideElement(i,0,200,0,t),this.gameUI.hideElement(a,0,200,0,t),this.gameUI.hideElement(r,0,200,0,t)]),this.hideEndGame(),this.isPlusCardsButtonsShown=!1,e.next=11,this.hidePlusCardsButtonsPromise;case 11:i.kill(),a.kill(),r.kill(),this.hidePlusCardsButtonsPromise=null;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(lM),pM=dM,fM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t.scene,n}(0,s.Z)(t,e);var n=t.prototype;return n.alignUI=function(){this.alignCoinBar(),this.alignLevelTitle(),this.alignStreakBar(),this.alignGameUIFooter(),this.alignWildCard(),this.alignStockAndWaste(),this.alignUndoButton(),this.alignPlusCardsButtons()},n.alignCoinBar=function(){var e=this.gameUI.coinBarButton;Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-44,-10),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStarBar=function(){var e=this.gameUI.starBarButton;this.scene.backupGameObjectSystem.list.delete(e),Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-35,-2.5),this.scene.backupGameObjectSystem.backupObject(e)},n.alignLevelTitle=function(){var e=this.gameUI.levelTitle,t=this.gameUI.coinBarButton.coinBar.getBarSize().width;this.scene.backupGameObjectSystem.list.delete(e),Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-t-18,-16.5),this.scene.backupGameObjectSystem.backupObject(e)},n.alignStreakBar=function(){var e=this.scene.gameplay.comboManager.streakBar;Phaser.Display.Align.In.TopRight(e,this.scene.gameZone,-28,-16),this.scene.backupGameObjectSystem.backupObject(e)},n.alignGameUIFooter=function(){var e=this.gameUI.footer,t=e.settingsMenu,n=e.endGameBtn;Phaser.Display.Align.In.RightCenter(n,e,-10,0),Phaser.Display.Align.In.TopCenter(e,this.scene.gameZone,0,-48),this.scene.backupGameObjectSystem.backupObject(t),this.scene.backupGameObjectSystem.backupObject(n)},n.alignWildCard=function(){var e=this.scene.gameplay.coinUsingManager,t=e.wildCardBtn,n=e.wildCardWrapper,i=this.scene.gameZone.width-t.width/2-8,a=this.scene.gameZone.height-n.height/2-15-this.scene.world.getSAB();n.setPosition(i,a),this.scene.backupGameObjectSystem.backupObject(n)},n.alignStockAndWaste=function(){var e=this.scene.gameplay.boardGame,t=e.waste,n=e.stock;t.setPosition(this.scene.gameZone.width/2-3,t.y-10),n.setPosition(t.x-63,n.y-10)},n.alignUndoButton=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager.undoBtn;t.setPosition(e.x+68,this.scene.gameZone.height-t.height/2-15-this.scene.world.getSAB()),this.scene.backupGameObjectSystem.backupObject(t)},n.alignPlusCardsButtons=function(){var e=this.scene.gameplay.boardGame.waste,t=this.scene.gameplay.coinUsingManager,n=t.addCardsBtn,i=t.addCardsByAdsBtn,a=t.addCardsFreeBtn;n.setPosition(e.x-67,this.scene.gameZone.height-n.height/2-15-this.scene.world.getSAB()),a.setPosition(e.x-67,this.scene.gameZone.height-a.height/2-15-this.scene.world.getSAB()),i.setPosition(n.x-80,this.scene.gameZone.height-i.height/2-15-this.scene.world.getSAB());var r=Phaser.Math.Clamp(i.x,45,this.scene.gameZone.width/2);i.setX(r),this.scene.backupGameObjectSystem.backupObject(n),this.scene.backupGameObjectSystem.backupObject(i),this.scene.backupGameObjectSystem.backupObject(a)},n.showEndGame=function(){var e=this.gameUI.footer.endGameBtn;this.gameUI.showElement(e,0)},n.hideEndGame=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.endGameBtn;this.gameUI.hideElement(t,200,0,0,e)},n.showSettingsButton=function(){var e=this.gameUI.footer.settingsMenu;this.gameUI.showElement(e,0)},n.hideSettingsButton=function(e){void 0===e&&(e=200);var t=this.gameUI.footer.settingsMenu;this.gameUI.hideElement(t,-200,0,0,e)},n.showPlusCardsButtons=function(e){var t=this,n=this.scene.gameplay.coinUsingManager,i=n.addCardsBtn,a=n.addCardsByAdsBtn,s=[i.x,a.x];this.showPlusCardsButtonsPromise||this.isPlusCardsButtonsShown||(this.showPlusCardsButtonsPromise=(0,r.Z)(c().mark((function n(){var i;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.map((function(e,n){var i=s[n],a=t.scene.gameZone.height-e.height/2-15-t.scene.world.getSAB();return e.setPosition(i,a),t.scene.backupGameObjectSystem.backupObject(e),t.gameUI.hideElement(e,0,200,0,0),e.revive(),t.gameUI.showElement(e,0)})),t.isPlusCardsButtonsShown=!0,n.next=4,Promise.all(i);case 4:t.showPlusCardsButtonsPromise=null;case 5:case"end":return n.stop()}}),n)})))())},n.hidePlusCardsButtons=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=200),!this.hidePlusCardsButtonsPromise){e.next=3;break}return e.abrupt("return");case 3:if(this.isPlusCardsButtonsShown){e.next=5;break}return e.abrupt("return");case 5:return n=this.scene.gameplay.coinUsingManager,i=n.addCardsBtn,a=n.addCardsByAdsBtn,r=n.addCardsFreeBtn,this.hidePlusCardsButtonsPromise=Promise.all([this.gameUI.hideElement(i,0,200,0,t),this.gameUI.hideElement(a,0,200,0,t),this.gameUI.hideElement(r,0,200,0,t)]),this.hideEndGame(),this.isPlusCardsButtonsShown=!1,e.next=11,this.hidePlusCardsButtonsPromise;case 11:i.kill(),a.kill(),r.kill(),this.hidePlusCardsButtonsPromise=null;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(lM),mM=fM,gM=function(e){function t(t){var n;return(n=e.call(this,t,"","")||this).scene=void 0,n.autoUpdateStar=void 0,n.starBar=void 0,n.bounceTween=void 0,n.starsNumber=void 0,n.barLength=void 0,n.onShowStarInformation=function(){n.setDepth(Fr.Z.BUTTON),n.scene.screen.open(ce.o4.GET_MORE_STARS_SCREEN)},n.setName("StarBar"),n.button.kill(),n.scene=t,n.starsNumber=-1,n.barLength=0,n.autoUpdateStar=!0,n.create(),n.setDisabled(!1),n.onClick=n.onShowStarInformation,n}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(){var e=new _k(this.scene);this.add(e),this.starBar=e},n.setAutoUpdateStar=function(e){this.autoUpdateStar=e},n.setDisabled=function(t){e.prototype.setDisabled.call(this,t),this.setAlpha(1);var n=t?0:1;this.starBar.animateAddIcon(n,200)},n.updateStars=function(e){this.runCounter(e)},n.updateHitZoneSize=function(e,t,n){this.hitZone.setSize(e,t);var i=Math.max(0,n-3);this.hitZone.setX(5*i-8)},n.setValue=function(e){if(this.starsNumber!=e){this.starBar.setValue(e),this.starsNumber=e;var t=Math.max(this.starBar.getValueLength(),3),n=37.5+9*t;this.barLength!=n&&(this.barLength=n,this.starBar.updateBarSize(n,25.5)),this.starBar.align(),this.updateHitZoneSize(n,25.5,t)}},n.runCounter=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.starsNumber,e.abrupt("return",_b(this.scene,{startNumber:n,endNumber:t,onUpdate:function(e){var t=Math.floor(e.getValue());i.setValue(t)}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runBounceStarButtonAnimation=function(){var e,t,n=this;null!=(e=this.bounceTween)&&e.isPlaying()||(null==(t=this.bounceTween)||t.remove(),this.bounceTween=this.scene.tweens.add({targets:this,scale:.92,yoyo:!0,duration:50,onComplete:function(){n.scene.tweens.add({targets:n,scale:1,duration:50})}}))},t}(Hc.Z),vM=gM,yM={coinBarBtn:!0,starBarBtn:!0,levelTitle:!0,settingsBtn:!0,undoBtn:!0,wildCardBtn:!0,streakBar:!0,endGameBtn:!0},EM=function(e){function t(t){var n;return(n=e.call(this,t)||this).levelTitle=void 0,n.lifeBarButton=void 0,n.coinBarButton=void 0,n.starBarButton=void 0,n.header=void 0,n.footer=void 0,n.isGameUIHiddenFirstTime=void 0,n.showUIPayload=void 0,n.coinShowing=void 0,n.starShowing=void 0,n.gameUILayout=void 0,n.onCoinChanged=function(){if(n.scene&&n.coinBarButton.autoUpdateCoin){var e=n.scene.player.getCoins();n.coinBarButton.runCounter(e)}},n.onStarChanged=function(){if(n.scene&&n.starBarButton.autoUpdateStar){var e=n.scene.player.getStar();n.starBarButton.setValue(e)}},n.onHeartChanged=function(){if(n.scene){var e=n.scene.life.getHearts(),t=n.scene.life.getMaxHearts();e>=t?n.lifeBarButton.setDisabled(!0):n.lifeBarButton.setDisabled(!1),n.lifeBarButton.autoUpdateHearts&&n.lifeBarButton.lifeBar.updateHearts(e),n.lifeBarButton.lifeBar.updateCounter(e,t)}},n.scene=t,n.isGameUIHiddenFirstTime=!1,n.starShowing=!0,n.showUIPayload=yM,n.create(),n.scene.add.existing((0,fc.Z)(n)),n.listenEvents(),n.gameUILayout=GameCore.layoutInitializer.isLandscape?new pM((0,fc.Z)(n)):new mM((0,fc.Z)(n)),n.alignGameUI(),n}(0,s.Z)(t,e);var n=t.prototype;return n.alignGameUI=function(){this.gameUILayout.alignUI(),this.gameUILayout.hideEndGame(0),this.gameUILayout.hideSettingsButton(0),this.gameUILayout.hidePlusCardsButtons(0)},n.listenEvents=function(){this.updateCoinsToBar(),this.updateStarsToBar(),this.scene.game.events.on(hi.COIN_CHANGED,this.onCoinChanged),this.scene.game.events.on(hi.STAR_CHANGED,this.onStarChanged)},n.runFadeCoinBar=function(e,t){this.scene.add.tween({targets:this.coinBarButton,alpha:e,duration:t,ease:Phaser.Math.Easing.Cubic.Out})},n.updateCoinsToBar=function(){var e=this.scene.player.getCoins();this.coinBarButton.setValue(e)},n.updateStarsToBar=function(){var e=this.scene.player.getStar();this.starBarButton.setValue(e)},n.setUpShowUIPayload=function(e){this.showUIPayload=(0,a.Z)({},yM,e)},n.setDisableButtons=function(e){this.coinBarButton.setDisabled(e),this.starBarButton.setDisabled(e),this.lifeBarButton.setDisabled(e)},n.updateLevelTitle=function(e){this.levelTitle.update(e)},n.getHideElementAnimationDuration=function(){if(!this.isGameUIHiddenFirstTime)return 0},n.hideUI=function(e){var t=this,n=this.getHideElementAnimationDuration(),i=(0,a.Z)({},yM,e);i.coinBarBtn&&this.hideElement(this.coinBarButton,-50,-20,0,n).then((function(){t.coinShowing=!1})),i.starBarBtn&&this.starShowing&&this.hideElement(this.starBarButton,0,-50,0,n).then((function(){t.starShowing=!1})),i.levelTitle&&this.hideElement(this.levelTitle,0,-40,0,n),i.settingsBtn&&(this.footer.closeSettings(0),this.gameUILayout.hideSettingsButton(n)),i.undoBtn&&this.hideElement(this.scene.gameplay.coinUsingManager.undoBtn,0,40,0,n),i.wildCardBtn&&this.hideElement(this.scene.gameplay.coinUsingManager.wildCardWrapper,0,40,0,n),i.endGameBtn&&this.gameUILayout.hideEndGame(n),i.streakBar&&this.hideElement(this.scene.gameplay.comboManager.streakBar,60,-20,0,n),this.isGameUIHiddenFirstTime||(this.isGameUIHiddenFirstTime=!0)},n.showUI=function(e){var t=this,n=(0,a.Z)({},yM,this.showUIPayload);n.coinBarBtn&&this.showElement(this.coinBarButton,0).then((function(){t.coinShowing=!0,t.alignLevelTitle(),t.alignStarBarButton()})),n.levelTitle&&this.showElement(this.levelTitle,0),n.streakBar&&this.showElement(this.scene.gameplay.comboManager.streakBar,0),n.settingsBtn&&(this.footer.closeSettings(0),this.showElement(this.footer.settingsMenu,200)),n.undoBtn&&this.showElement(this.scene.gameplay.coinUsingManager.undoBtn,200),n.wildCardBtn&&this.showElement(this.scene.gameplay.coinUsingManager.wildCardWrapper,200)},n.showCoin=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showElement(this.coinBarButton,0).then((function(){t.coinShowing=!0}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.isCoinShowing=function(){return this.coinShowing},n.hideCoin=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hideElement(this.coinBarButton,-50,-20,0).then((function(){t.coinShowing=!1}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showStar=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showElement(this.starBarButton,0).then((function(){t.starShowing=!0}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.isStarShowing=function(){return this.starShowing},n.hideStar=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.starBarButton.starBar.getBarSize(),n=t.width,i=this.starBarButton.starBar.width,a=(n-i)/2+8,e.next=5,this.hideElement(this.starBarButton,a,-50,0).then((function(){r.starShowing=!1}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showLife=function(){this.showElement(this.lifeBarButton,0)},n.hideLife=function(){this.hideElement(this.lifeBarButton,-50,-20,0)},n.showSettings=function(){this.showElement(this.footer.settingsMenu,0)},n.showSingleModeComponents=function(){this.showElement(this.levelTitle,0)},n.hideSingleModeComponents=function(){this.hideElement(this.levelTitle,0,-40,0)},n.showEndGame=function(){this.gameUILayout.showEndGame()},n.hideEndGame=function(e){void 0===e&&(e=200),this.gameUILayout.hideEndGame(e)},n.hideElement=function(){var e=(0,r.Z)(c().mark((function e(t,n,i,a,r){var s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=250),s=this.scene.backupGameObjectSystem.getObjectSaved(t)||t,o=s.x,h=s.y,0!=r){e.next=6;break}return t.setPosition(o+n,h+i),t.setAlpha(0),e.abrupt("return");case 6:return this.scene.tweens.killTweensOf(t),e.next=9,this.scene.add.tween({targets:t,x:o+n,y:h+i,alpha:0,scale:.5,duration:r,delay:a,ease:Phaser.Math.Easing.Back.In}).waitForCompletion();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a,r){return e.apply(this,arguments)}}(),n.showElement=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.scene.backupGameObjectSystem.getObjectSaved(t)||t,a=i.x,r=i.y,this.scene.tweens.killTweensOf(t),e.next=4,this.scene.add.tween({targets:t,x:a,y:r,alpha:1,scale:1,duration:250,delay:n,ease:Phaser.Math.Easing.Back.Out}).waitForCompletion();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.create=function(){this.createHeader(),this.createFooter(),this.createCoinBar(),this.createStarBar(),this.createLevelTitle(),this.createLifeBar()},n.createHeader=function(){this.header=new V_(this.scene),Phaser.Display.Align.In.TopCenter(this.header,this.scene.gameZone,0),this.header.alignChildren()},n.createFooter=function(){this.footer=new I_(this.scene),this.footer.setDepth(Fr.Z.POPUP)},n.createCoinBar=function(){var e=new uM(this.scene);this.scene.add.existing(e),this.coinBarButton=e},n.createStarBar=function(){var e,t=new vM(this.scene);this.scene.add.existing(t),this.starBarButton=t,null==(e=this.scene.gameUI)||e.alignStarBarButton()},n.createLifeBar=function(){this.lifeBarButton=new iM(this.scene),this.lifeBarButton.kill(),this.scene.add.existing(this.lifeBarButton),Phaser.Display.Align.In.TopLeft(this.lifeBarButton,this.scene.gameZone,-71,-38),this.scene.backupGameObjectSystem.backupObject(this.lifeBarButton)},n.createLevelTitle=function(){this.levelTitle=new q_(this.scene),this.levelTitle.setDepth(Fr.Z.BUTTON),this.scene.add.existing(this.levelTitle)},n.alignLevelTitle=function(){var e;null==(e=this.gameUILayout)||e.alignLevelTitle()},n.alignStarBarButton=function(){var e;null==(e=this.gameUILayout)||e.alignStarBar(this.isStarShowing())},n.update=function(){this.lifeBarButton.update()},t}(Phaser.GameObjects.Layer),CM=EM,AM=["paris","new-york","venice"],wM={WINDMILL_SPINE:"WINDMILL_SPINE",CARD_SLICE_SPINE:"CARD_SLICE_SPINE",MAP_SPINE:"MAP_SPINE",CODE_BREAK_SPINE:"CODE_BREAK_SPINE",CARD_LOCK_SPINE:"CARD_LOCK_SPINE",CARD_SLICE_FX_SPINE:"CARD_SLICE_FX_SPINE",CIRCLE_VFX_SPINE:"CIRCLE_VFX_SPINE",CHANGE_VFX_SPINE:"CHANGE_VFX_SPINE"},SM=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).gameplay=void 0,t.devToolManager=void 0,t.rewardManager=void 0,t.bgAnimManager=void 0,t.solver=void 0,t.gameUI=void 0,t.locationManager=void 0,t.gameStats=void 0,t.gameModeManager=void 0,t.backupGameObjectSystem=void 0,t.gameplayLayer=void 0,t.gameSettings=void 0,t.journeyDataService=void 0,t.logGameplay=void 0,t.logEconomy=void 0,t.fpsManager=void 0,t.create=(0,r.Z)(c().mark((function n(){var i,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.prototype.create.call((0,fc.Z)(t)),i=t.player.getLevel(),a=i<=3,t.setBackground({useGameplayBackground:a}),t.fpsManager=new _y((0,fc.Z)(t)),t.fpsManager.start(),t.lazyLoadResource(),t.journeyDataService=new Nx((0,fc.Z)(t)),t.gameSettings=pf.instance,t.gameplayLayer=t.add.layer(),t.gameplayLayer.setDepth(Fr.Z.GAMEPLAY),t.gameModeManager=new dC((0,fc.Z)(t)),t.gameplay=new Hg((0,fc.Z)(t)),t.solver=new hC((0,fc.Z)(t)),t.gameUI=new CM((0,fc.Z)(t)),t.locationManager=new pO((0,fc.Z)(t)),Phaser.Display.Align.In.Center(t.locationManager,t.gameZone,0,0),t.rewardManager=new hE((0,fc.Z)(t)),t.bgAnimManager=new ky((0,fc.Z)(t)),t.devToolManager=new Dy((0,fc.Z)(t),t.gameplay.boardGame),t.logGameplay=new JC((0,fc.Z)(t)),t.logEconomy=new XC((0,fc.Z)(t)),GameCore.Utils.Valid.isDebugger()&&t.devToolManager.start(),t.createScreens(),t.ads.preloadInterstitialAdAsync().catch((function(e){})),t.ads.preloadRewardedVideoAsync().catch((function(e){})),t.gameUI.hideUI(),t.checkNewUser(),t.world.getBannerHeight()>0&&t.ads.showBannerAdAsync().catch((function(e){}));case 30:case"end":return n.stop()}}),n)}))),t.run=function(){t.processStartGame();var e=[{selector:Xa,callback:function(){t.events.emit(hi.MAP_PLAYERS_CHANGED)}}];t.handleStateChange(e)},t.handleShowInterstitialAd=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ads.canbeShowInterstitialAd()){e.next=15;break}return t.ads.setAdInProcess(!0),t.audio.muteAll(),t.audio.pauseAllSounds(),t.audio.pauseAllMusics(),e.prev=5,e.next=8,t.ads.showInterstitialAdAsync();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:t.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(t.audio.unmuteAll(),t.audio.resumeAllSounds(),t.resumeMusic()),t.ads.preloadInterstitialAdAsync().catch((function(e){}));case 15:case"end":return e.stop()}}),e,null,[[5,10]])}))),t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){this.backupGameObjectSystem=new MC(this),this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.lazyLoadResource=function(){var e=this;this.loadSounds(),(0,le.qZ)(500).then((function(){e.loadTexture32Bit(Wi.Z.DEFAULT.KEY,Wi.Z.DEFAULT.TEXTURE_32BIT),e.loadTexture32Bit(Wi.Z.GAMEPLAY_DEFAULT.KEY,Wi.Z.GAMEPLAY_DEFAULT.TEXTURE_32BIT),e.loadTexture32Bit(Wi.Z.GAMEPLAY_OBJECTS.KEY,Wi.Z.GAMEPLAY_OBJECTS.TEXTURE_32BIT),e.requireSpineAsync("CHANGE_VFX_SPINE")})),this.requireSpineAsync("CARD_SLICE_FX_SPINE"),this.requireSpineAsync("CARD_SLICE_SPINE"),this.requireSpineAsync("WINDMILL_SPINE"),this.load.start()},n.loadTexture32Bit=function(e,t){var n=this,i=GameCore.Utils.String.generateObjectId();this.load.image(i,t),this.load.start(),this.load.on("filecomplete-image-"+i,(function(t){var i=n.textures.get(t),a=n.textures.get(e);a.source[0].glTexture=i.source[0].glTexture,a.source[0].glIndex=i.source[0].glIndex,a.source[0].glIndexCounter=i.source[0].glIndexCounter}))},n.loadSounds=function(){this.loadSoundEffects(),this.loadBackgroundMusic(),this.loadGameplayMusic()},n.loadSoundEffects=function(){this.load.audioSprite(Fc.Z.UI.KEY,Fc.Z.UI.JSON,Fc.Z.UI.FILE),this.load.audioSprite(Fc.Z.BOOSTERS.KEY,Fc.Z.BOOSTERS.JSON,Fc.Z.BOOSTERS.FILE),this.load.audioSprite(Fc.Z.CARD.KEY,Fc.Z.CARD.JSON,Fc.Z.CARD.FILE),this.load.audioSprite(Fc.Z.CARD_COMBO.KEY,Fc.Z.CARD_COMBO.JSON,Fc.Z.CARD_COMBO.FILE),this.load.audioSprite(Fc.Z.CARD_ROTATE.KEY,Fc.Z.CARD_ROTATE.JSON,Fc.Z.CARD_ROTATE.FILE),this.load.audioSprite(Fc.Z.GAMEPLAY.KEY,Fc.Z.GAMEPLAY.JSON,Fc.Z.GAMEPLAY.FILE),this.load.audioSprite(Fc.Z.CONGRATS_SOUND.KEY,Fc.Z.CONGRATS_SOUND.JSON,Fc.Z.CONGRATS_SOUND.FILE)},n.loadBackgroundMusic=function(){var e=this,t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Fc.Z.BACKGROUND.KEY,(function(){e.audio.getMusicKey()===Fc.Z.BACKGROUND.KEY&&e.turnOnBackgroundMusic()})),this.load.audio(Fc.Z.BACKGROUND.KEY,Fc.Z.BACKGROUND.FILE)},n.loadGameplayMusic=function(){var e=this,t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Fc.Z.GAMEPLAY_BACKGROUND.KEY,(function(){e.audio.getMusicKey()===Fc.Z.GAMEPLAY_BACKGROUND.KEY&&e.turnOnGameplayMusic()})),this.load.audio(Fc.Z.GAMEPLAY_BACKGROUND.KEY,Fc.Z.GAMEPLAY_BACKGROUND.FILE)},n.setBackground=function(e){var t=(void 0===e?{}:e).useGameplayBackground;if(void 0!==t&&t){var n=this.journey.getCurrentStage(),i=n.gameplayBackgroundKey,a=n.gameplayBackgroundFile;this.themeHandler.setBackground(i,a)}else{var r=this.journey.getCurrentStage(),s=r.backgroundKey,o=r.backgroundFile;this.themeHandler.setBackground(s,o)}},n.setBackgroundWithFadeAnimation=function(e){var t=(void 0===e?{}:e).useGameplayBackground;if(void 0!==t&&t){var n=this.journey.getCurrentStage(),i=n.gameplayBackgroundKey,a=n.gameplayBackgroundFile;return this.themeHandler.setBackgroundWithAnimation(i,a)}var r=this.journey.getCurrentStage(),s=r.backgroundKey,o=r.backgroundFile;return this.themeHandler.setBackgroundWithAnimation(s,o)},n.preloadBackgroundAsync=function(e){var t=(void 0===e?{}:e).useGameplayBackground,n=void 0!==t&&t,i=this.journey.getCurrentStage();return n?this.themeHandler.preloadBackgroundAsync(i.gameplayBackgroundKey,i.gameplayBackgroundFile):this.themeHandler.preloadBackgroundAsync(i.backgroundKey,i.backgroundFile)},n.preloadNextBackgroundAsync=function(e){var t=(void 0===e?{}:e).useGameplayBackground,n=void 0!==t&&t,i=this.journey.getNextStage();return i?n?this.themeHandler.preloadBackgroundAsync(i.gameplayBackgroundKey,i.gameplayBackgroundFile):this.themeHandler.preloadBackgroundAsync(i.backgroundKey,i.backgroundFile):Promise.resolve()},n.createScreens=function(){var e=window.game.renderer;e.resize(e.width,e.height),this.screen.add(ce.o4.NO_MORE_MOVES_SCREEN,Py),this.screen.add(ce.o4.SETTINGS_SCREEN,wv),this.screen.add(ce.o4.DASHBOARD_SETTINGS_SCREEN,wA),this.screen.add(ce.o4.NOTIFICATION_SCREEN,_v),this.screen.add(ce.o4.PLAY_SCREEN,Bb),this.screen.add(ce.o4.BUYING_BOOSTER_SCREEN,uA),this.screen.add(ce.o4.GET_COINS_SCREEN,zA),this.screen.add(ce.o4.GET_MORE_STARS_SCREEN,AO),this.screen.add(ce.o4.OUT_OF_HEARTS_SCREEN,yw),this.screen.add(ce.o4.GUIDE_SCREEN,jA),this.screen.add(ce.o4.NOTIFY_BOMB_SCREEN,aw),this.screen.add(ce.o4.DASHBOARD_SCREEN,aI),this.screen.add(ce.o4.EXIT_GAME_SCREEN,GA),this.screen.add(ce.o4.LEVEL_COMPLETE_SCREEN,nB),this.screen.add(ce.o4.NEXT_JOURNEY_SCREEN,oB),this.screen.preAdd(ce.o4.JOURNEY_SCREEN,ZR),this.screen.preAdd(ce.o4.WELCOME_BACK_SCREEN,Vb),this.screen.preAdd(ce.o4.WEEKLY_TOURNAMENT.INTRO_SCREEN,OL),this.screen.preAdd(ce.o4.WEEKLY_TOURNAMENT.INVITATION_SCREEN,pT),this.screen.preAdd(ce.o4.WEEKLY_TOURNAMENT.MAIN_SCREEN,g_),this.screen.preAdd(ce.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN,EL),this.screen.preAdd(ce.o4.WEEKLY_TOURNAMENT.REWARD_SCREEN,b_),this.screen.preAdd(ce.o4.BOXING_DUEL.INTRO_SCREEN,kT),this.screen.preAdd(ce.o4.BOXING_DUEL.MAIN_SCREEN,lx),this.screen.preAdd(ce.o4.BOXING_DUEL.VERSUS_SCREEN,Mx),this.screen.preAdd(ce.o4.BOXING_DUEL.REWARD_SCREEN,Px),this.screen.preAdd(ce.o4.OFFSHORE_RACE.INTRO_SCREEN,yB),this.screen.preAdd(ce.o4.OFFSHORE_RACE.INVITATION_SCREEN,BB),this.screen.preAdd(ce.o4.OFFSHORE_RACE.MAIN_SCREEN,jD),this.screen.preAdd(ce.o4.OFFSHORE_RACE.REWARD_SCREEN,lL),this.createDailyRewardsScreen(),this.leaderboard.refreshFriendsLeaderboard()},n.openOffshoreRaceMainScreen=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTextureAsync("RACE");case 2:this.screen.open(ce.o4.OFFSHORE_RACE.MAIN_SCREEN,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.openOffshoreRaceInvitationScreen=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTextureAsync("RACE");case 2:this.screen.open(ce.o4.OFFSHORE_RACE.INVITATION_SCREEN);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.openOffshoreRaceRewardScreen=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requireTexturesAsync(["RACE","OFFSHORE_RACE_CHESTS"]);case 2:this.screen.open(ce.o4.OFFSHORE_RACE.REWARD_SCREEN,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requireTextureAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n,i){var a,r,s,o,h,u,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),void 0===i&&(i="Loading..."),Wi.Z[t]){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(a=Wi.Z[t],r=a.KEY,s=a.TEXTURE,o=a.JSON,!this.textures.exists(r)){e.next=7;break}return e.abrupt("return",Promise.resolve());case 7:return this.load.atlas({key:r,textureURL:s,atlasURL:o}),h=(0,le.qZ)(1e3),n&&window.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:i,loading:!0,animationFadeOut:!0}),u=new Promise((function(e){var t=Date.now();l.game.analytics.event(te._.LOAD_ASSET_START,{key:r}),l.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+r,(function(){var n=Date.now()-t;l.game.analytics.event(te._.LOAD_ASSET_COMPLETED,{key:r,duration:n}),e(0)})),l.load.start()})),e.next=13,Promise.all([h,u]);case 13:return n&&window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),e.abrupt("return",Promise.resolve());case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),n.requireTexturesAsync=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),0!==(i=t.filter((function(e){return Wi.Z[e]&&!s.textures.exists(Wi.Z[e].KEY)}))).length){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return a=i.map((function(e){var t=Wi.Z[e],n=t.KEY,i=t.TEXTURE,a=t.JSON;return s.load.atlas({key:n,textureURL:i,atlasURL:a}),new Promise((function(e){var t=Date.now();s.game.analytics.event(te._.LOAD_ASSET_START,{key:n}),s.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+n,(function(){var i=Date.now()-t;s.game.analytics.event(te._.LOAD_ASSET_COMPLETED,{key:n,duration:i}),e(0)})),s.load.start()}))})),r=(0,le.qZ)(1e3),n&&window.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:this.lang.Text.loading,loading:!0,animationFadeOut:!0}),e.next=9,Promise.all([r].concat(a));case 9:return n&&window.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),e.abrupt("return",Promise.resolve());case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.requireSpineAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(wM[t]){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=Wi.Z[t],i=n.DATA_KEY,a=n.ATLAS_KEY,r=n.atlasPATH,s=n.skelPATH,o=new Promise((function(e){if(u.cache.binary.exists(i))return e(0);u.load.spineBinary(i,s);u.load.on(Phaser.Loader.Events.FILE_COMPLETE,(function t(n){n.includes(i)&&(e(0),u.load.off(Phaser.Loader.Events.FILE_COMPLETE,t))}))})),h=new Promise((function(e){if(Object.keys(u.textures.list).some((function(e){return e.includes(a)})))return e(0);u.load.spineAtlas(a,r);u.load.on(Phaser.Loader.Events.FILE_COMPLETE,(function t(n){n.includes(a)&&(e(0),u.load.off(Phaser.Loader.Events.FILE_COMPLETE,t))}))})),this.load.start(),e.abrupt("return",Promise.all([o,h]).then((function(){return Promise.resolve()})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requireDecorationTextureAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o,h=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(AM.includes(t)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(n=this.getCurrentLocationSpriteKey(),i=GameCore.ImageScale,a=n.toLowerCase(),r="./assets/textures/"+i+"x/"+n.toLowerCase()+".png",s="./assets/textures/"+i+"x/"+n.toLowerCase()+".json",!this.textures.exists(a)){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:return this.load.atlas({key:a,textureURL:r,atlasURL:s}),o=new Promise((function(e){var t=Date.now();h.game.analytics.event(te._.LOAD_ASSET_START,{key:a}),h.load.once(Phaser.Loader.Events.FILE_KEY_COMPLETE+"json-"+a,(function(){var n=Date.now()-t;h.game.analytics.event(te._.LOAD_ASSET_COMPLETED,{key:a,duration:n}),e(0)})),h.load.start()})),e.abrupt("return",Promise.all([o]).then((function(){return Promise.resolve()})));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getCurrentLocationSpriteKey=function(){var e=this.player.getJourneyProgress().currentLocationIndex;return AM[e]},n.processStartGame=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.level.getLevel()<=3)){e.next=3;break}return this.gameplay.start(),e.abrupt("return");case 3:t=this.canShowWelcomeBackScreen(),this.screen.open(ce.o4.DASHBOARD_SCREEN,{canShowWelcomeBackScreen:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkNewUser=function(){if(this.player.getPlayerIsNew()||GameCore.Configs.Tutorial.ForceUseTutorial){if(this.player.getCoins()>=1e3)return;this.player.setCoins(this.player.getCoins()+1e3),this.logEconomy.logGetItem(fl.COIN,1e3,gl.REWARD_NEW_USER)}},n.canShowWelcomeBackScreen=function(){var e=this.player.getLastWelcomeBackRewardTime();return!(0,le.Gm)(e)},n.joinTournament=function(){var e=(0,r.Z)(c().mark((function e(t,n){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:"Joining tournament...",loading:!0,animationFadeOut:!0}),e.next=3,this.weeklyTournament.join(t,n);case 3:if(i=e.sent,this.game.globalScene.screen.close(ce.o4.NOTIFY_SCREEN),"error"!=i){e.next=8;break}return e.next=8,this.screen.openAsync(ce.o4.WEEKLY_TOURNAMENT.FAILED_SCREEN);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.showTournamentShareDialog=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),this.weeklyTournament.isPlayingTournament()){e.next=3;break}return e.abrupt("return");case 3:return n=this.weeklyTournament.getScore(),e.next=6,this.storage.dispatch(Et(n,t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l,d,p=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Configs.Network,i=this.game.globalScene,a=i.screen,r=i.audio,s=i.time,o=i.ads,h=!1,o.setAdInProcess(!0),r.pauseAllSounds(),r.pauseAllMusics(),r.muteAll(),a.open(ce.o4.NOTIFY_SCREEN,{message:this.lang.Text.loadingAds,duration:0,loading:!0}),e.prev=9,e.next=12,new Promise((function(e,t){u=s.delayedCall(n.Timeout,t),p.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?p.events.once(GameCore.Ads.Events.LOADED,e):p.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 12:return l=setTimeout((function(){a.open(ce.o4.NOTIFY_SCREEN,{message:p.lang.Text.loading,duration:0,loading:!0})}),3e3),e.next=15,this.ads.showRewardedVideoAsync();case 15:a.close(ce.o4.NOTIFY_SCREEN),h=!0,e.next=25;break;case 19:e.prev=19,e.t0=e.catch(9),a.close(ce.o4.NOTIFY_SCREEN),d=this.lang.Text.noAds,e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"USER_INPUT"===e.t0.code&&(d=this.lang.Text.noRewards),a.open(ce.o4.NOTIFY_SCREEN,{message:d,duration:1500,loading:!1,animationFadeOut:!0});case 25:return null==(t=u)||t.remove(),l&&clearTimeout(l),o.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(r.unmuteAll(),r.resumeAllSounds(),r.resumeMusic()),r.resumeMusic(),this.ads.preloadRewardedVideoAsync().catch((function(e){})),e.abrupt("return",h);case 32:case"end":return e.stop()}}),e,this,[[9,19]])})));return function(){return e.apply(this,arguments)}}(),n.emitChallengeFriendsTaskEvent=function(){Xh.emit(Kh.CHALLENGE_FRIENDS.EVENTS.CHALLENGE_FRIENDS,{type:"times",value:1})},n.createDailyRewardsScreen=function(){var e=this,t=this.screen.add(ce.o4.DAILY_REWARDS_SCREEN,LC);t.onNoAd=function(){e.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:e.lang.Text.noAds,duration:1200,loading:!1,animationFadeOut:!0})},t.onSkipAd=function(){e.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:e.lang.Text.noRewards,duration:1500,loading:!1,animationFadeOut:!0})}},n.skipBackgroundChangingAnimation=function(){this.bgAnimManager.skipAnimation()},n.handleBackgroundChange=function(e){this.bgAnimManager.playAnimation(e)},n.turnOnBackgroundMusic=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.turnOffMusic(Fc.Z.GAMEPLAY_BACKGROUND.KEY);case 2:if(!this.audio.isMusicPlaying(Fc.Z.BACKGROUND.KEY)){e.next=4;break}return e.abrupt("return");case 4:if(this.audio.stopMusic(),this.audio.setMusicVolume(0),this.audio.setMusicKey(Fc.Z.BACKGROUND.KEY),this.audio.playMusic(Fc.Z.BACKGROUND.KEY),this.audio.isMusicPlaying(Fc.Z.BACKGROUND.KEY)){e.next=10;break}return e.abrupt("return");case 10:this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.6,duration:1500,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.turnOffMusic=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.audio.isMusicPlaying(t)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=this.tweens.addCounter({from:this.audio.getMusicVolume(),to:0,duration:1200,onUpdate:function(e){i.audio.setMusicVolume(e.getValue())},onComplete:function(){i.audio.stopMusic()}}).waitForCompletion(),e.next=5,n;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.turnOnGameplayMusic=function(){var e=(0,r.Z)(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.turnOffMusic(Fc.Z.BACKGROUND.KEY);case 2:if(!this.audio.isMusicPlaying(Fc.Z.GAMEPLAY_BACKGROUND.KEY)){e.next=4;break}return e.abrupt("return");case 4:if(this.audio.stopMusic(),this.audio.setMusicVolume(0),this.audio.setMusicKey(Fc.Z.GAMEPLAY_BACKGROUND.KEY),this.audio.playMusic(Fc.Z.GAMEPLAY_BACKGROUND.KEY),this.audio.isMusicPlaying(Fc.Z.GAMEPLAY_BACKGROUND.KEY)){e.next=10;break}return e.abrupt("return");case 10:this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.2,duration:2e3,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resumeMusicWithTransition=function(e){var t=this;this.resumeMusic(),this.tweens.addCounter({from:this.audio.getMusicVolume(),to:.6,duration:e,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())}})},n.pauseMusicWithTransition=function(e){var t=this;this.tweens.addCounter({from:this.audio.getMusicVolume(),to:0,duration:e,onUpdate:function(e){t.audio.setMusicVolume(e.getValue())},onComplete:function(){t.audio.pauseMusic()}})},n.resumeMusic=function(){if(this.audio.isMusicEnabled()){this.audio.resumeMusic();var e=this.audio.getMusicKey();this.audio.isMusicPlaying(e)||(e===Fc.Z.BACKGROUND.KEY?this.turnOnBackgroundMusic():e===Fc.Z.GAMEPLAY_BACKGROUND.KEY?this.turnOnGameplayMusic():this.audio.playMusic(e))}},n.update=function(e,t){this.gameplay.update(t),this.gameUI.update()},n.sendTestDailyNotification=function(e){kv.sendTestDailyNotification(e)},t}(qo.Z),bM=SM,TM=n(78),xM=Wi.Z.DEFAULT,PM=xM.KEY,kM=xM.FRAME,IM=function(e){function t(t){var n;return(n=e.call(this,t,PM,kM.BUTTON_YELLOW_CIRCLE)||this).scene=void 0,n.scene=t,n.button.setSize(87,68).setDisplaySize(87,68),n.setName("Home"),n.createIcon(),n}return(0,s.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.add.image(0,0,PM,kM.ICON_FLAT_HOME);e.setSize(43,43).setDisplaySize(43,43),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(Hc.Z),OM=IM,RM=Wi.Z.DEFAULT,BM=RM.KEY,DM=RM.FRAME,LM=function(e){function t(t){var n;return(n=e.call(this,t,BM,DM.BUTTON_GREEN)||this).scene=void 0,n.scene=t,n.button.setWorldSize(170,72),n.setName("PlayWithFriends"),n.createLabel(),n}return(0,s.Z)(t,e),t.prototype.createLabel=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:13,text:"PLAY"}),t=10;Phaser.Display.Align.In.Center(e,this,0,-t);var n=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:9,text:"WITH FRIENDS"});t=12,Phaser.Display.Align.In.Center(n,this,0,t),this.add([e,n])},t}(Hc.Z),_M=LM,MM=Wi.Z.DEFAULT,NM=MM.KEY,GM=MM.FRAME,ZM=function(e){function t(t){var n;return(n=e.call(this,t,NM,GM.BUTTON_YELLOW_CIRCLE)||this).scene=void 0,n.scene=t,n.button.setSize(87,68).setDisplaySize(87,68),n.setName("Share"),n.createIcon(),n}return(0,s.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.add.image(0,0,NM,GM.ICON_FLAT_SHARE);e.setSize(43,43).setDisplaySize(43,43),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(Hc.Z),FM=ZM,UM=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.homeButton=void 0,n.playButton=void 0,n.shareButton=void 0,n.scene=t,n.setName("FooterBar"),n.createButtons(),n.alignButtons(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.alignButtons=function(){Phaser.Display.Align.In.Center(this.homeButton,this,-140),Phaser.Display.Align.In.Center(this.playButton,this,0),Phaser.Display.Align.In.Center(this.shareButton,this,140)},n.createButtons=function(){this.createHomeButton(),this.createPlayButton(),this.createShareButton()},n.createHomeButton=function(){this.homeButton=new OM(this.scene),this.add(this.homeButton)},n.createPlayButton=function(){this.playButton=new _M(this.scene),this.add(this.playButton)},n.createShareButton=function(){this.shareButton=new FM(this.scene),this.add(this.shareButton)},t}(Phaser.GameObjects.Container),WM=UM,HM=n(107),YM=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,s.Z)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,s.Z)(t,e);var n=t.prototype;return n.setMaxValue=function(e){this.maxValue=e},n.setMinValue=function(e){this.minValue=e},n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.setSize=function(t,n){var i,a=n-this.height;return e.prototype.setSize.call(this,t,n),null==(i=this.input)||i.hitArea.setSize(t,n),this.listConfigs&&this.listObjects&&(this.updateMaxHeight(),this.getChildren().forEach((function(e){return e.y-=a/2})),this.value+=a/2,this.onTouchEnd()),this},n.getChildren=function(){return this.listObjects.filter((function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){this.reset(),this.listConfigs=e,this.listObjects=new Array(e.length).fill(void 0),this.addObjectIndex(0,0);var t=this.getEndObjectIndex();this.addObjectIndex(1,t),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var e=this;this.listObjects instanceof Array&&this.listObjects.map((function(t){void 0!==t&&e.objects.killAndHide(t)}))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(e){this.objects.incY(e);var t=this.getStartObjectIndex(),n=this.getEndObjectIndex();t!=this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;if(!this.listObjects[n]){var r=this.objects.getFirstDead(!0),s=r.height,o=s/2+(s+i)*n+this.value-this.height/2;r.setPosition(0,o),this.isObjectOutOfScroller(r)?(r.setVisible(!1),r.setActive(!1)):(r.updateInfo(a[n]),r.setActive(!0),r.setVisible(!0),this.addAt(r),this.listObjects[n]=r)}}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},n.addBackground=function(){var e="scroller-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},(0,H.Z)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxHeight=0:e[0].height}}]),t}(RL.Z)),KM={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},zM=function(e){function t(t){return e.call(this,KM,t)||this}return(0,s.Z)(t,e),t}(ch.Z),VM={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},jM=function(e){function t(t){return e.call(this,VM,t)||this}return(0,s.Z)(t,e),t}(ch.Z),XM=Wi.Z.DEFAULT,qM=XM.KEY,JM=XM.FRAME,QM=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).button=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var e=i.payload.playerId;i.scene.storage.dispatch(vi(e))},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createUsername(),i.createScore(),i.createButton(),n&&i.updateInfo(n),i.scene.add.existing((0,fc.Z)(i)),i}(0,s.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,a.Z)({scoreRight:!0,isHighlight:!1,useChallenge:!1},e),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore(),this.updatePosition()},n.updatePosition=function(){var e=this.payload.scoreRight,t=this.payload.useChallenge;this.button.setVisible(!!t),e?Phaser.Display.Align.To.RightCenter(this.score,this.avatar,120):Phaser.Display.Align.To.RightCenter(this.score,this.avatar,80)},n.createBackground=function(){this.background=this.scene.make.image({key:qM,frame:JM.LEADERBOARD_BG_LIGHT}),this.background.setWorldSize(264,56),this.add(this.background)},n.updateBackground=function(){var e="";e=this.payload.isHighlight?JM.LEADERBOARD_BG_LIGHT:JM.LEADERBOARD_BG_DARK,this.background.setFrame(e),this.background.setWorldSize(264,56)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.createAvatar=function(){this.avatar=new Ic(this.scene,{key:qM,frame:JM.AVATAR_FRAME_YELLOW_SMALL,background:JM.AVATAR_BG_YELLOW_SMALL,width:47.5,height:49.5,radius:40}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-10)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var e=this.payload.rank;this.updateRankIcon(e),this.updateRankText(e)},n.getRankIconFrame=function(e){var t=JM.ICON_FLAG;switch(e){case 1:t=JM.ICON_CUP_GOLD;break;case 2:t=JM.ICON_CUP_SILVER;break;case 3:t=JM.ICON_CUP_COPPER}return t},n.createRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon=this.scene.make.image({key:qM,frame:t}),t!=JM.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27),this.add(this.rankIcon);var n=e<=3?13:16;Phaser.Display.Align.In.Center(this.rankIcon,this.avatar,0,n)},n.updateRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon.setFrame(t),t!=JM.ICON_FLAG?this.rankIcon.setWorldSize(46,30):this.rankIcon.setWorldSize(27,27)},n.createRankText=function(e){this.rankText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(15),text:""+e,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,-2)},n.updateRankText=function(e){this.rankText.setText(""+e)},n.getShortName=function(e){var t=e.substring(0,7);return t.split(" ")[0]||t},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("FRIEND NAME"),style:{fontFamily:(0,Pc.BN)(),fontSize:"15px",fontStyle:"bold"}}),this.username.setTint(10317116),this.username.setHighQuality(),Phaser.Display.Align.In.LeftCenter(this.username,this.avatar,-53),this.add(this.username)},n.updateUsername=function(){var e=this.payload.name;this.username.setText(this.getShortName(e))},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"132500",origin:{x:.5,y:.5}}),this.scoreText.setTint(6565e3);var e=this.scene.make.image({key:qM,frame:JM.ICON_CUP_MINI});e.setWorldSize(17,18),this.score.add([this.scoreText,e]);var t=-20;Phaser.Display.Align.In.LeftCenter(this.scoreText,e,t),this.add(this.score),t=10,Phaser.Display.Align.In.Center(this.score,this,t)},n.updateScore=function(){var e=this.payload.score;this.scoreText.setText(e)},n.createButton=function(){this.button=new Hc.Z(this.scene,qM,JM.BUTTON_GREEN_MINOR_MINI,54,34.5),this.button.setName("ChallengeFriend");var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),text:"PLAY"});Phaser.Display.Align.In.Center(e,this.button,0,-2),this.button.add(e),Phaser.Display.Align.In.RightCenter(this.button,this,-2),this.add(this.button),this.button.onClick=this.handleChallengeFriend},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),this.showPopUp=new jM({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(e,t){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new zM({targets:n,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e){return.8*e.scale},getEnd:function(e){return e.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},t}(Phaser.GameObjects.Container),$M=QM;function eN(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return tN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tN(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var nN=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.currentPlayerId=void 0,n.scroller=void 0,n.scene=t;var i=n.scene.player;return n.currentPlayerId=i.getPlayerId(),n.createReuseScroller(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createReuseScroller=function(){this.scroller=new YM(this.scene,{classType:$M,listConfigs:[],width:280,height:310,padding:10,marginTop:10,marginBottom:10}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(Wi.Z.DEFAULT.KEY,Wi.Z.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,25),this.add(this.scroller)},n.updateData=function(e){var t=Object.values(e)||[];if(t.length<1)return this.scene.isSwitchable=!0,void this.scene.board.showMessage(!0,"Leaderboard is empty!");for(var n,i=[],a=eN(t.sort((function(e,t){return+t.score-+e.score})));!(n=a()).done;){var r=n.value,s=r.playerId,o=r.photo,c=r.score,h=r.name,u=r.rank;if(s){var l=this.currentPlayerId===s,d={playerId:s,photo:o,name:h,rank:u,score:c,scoreRight:this.scene.tabId===Ae,useChallenge:!l&&this.scene.tabId===we,isHighlight:l};i.push(d)}}this.scroller.updateConfig(i),this.showLeaders()},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this,t=this.getLeaders();if(t.length<1)return this.scene.isSwitchable=!0,void this.scene.board.showMessage(!0,"Leaderboard is empty!");for(var n=Math.min(t.length,6),i=0;i<n;i++){var a=t[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var r=300+100*n+250;this.scene.time.delayedCall(r,(function(){e.scene.isSwitchable=!0,e.scroller.setEnable(!0)}))},t}(Phaser.GameObjects.Container),iN=nN,aN=Wi.Z.DEFAULT,rN=aN.KEY,sN=aN.FRAME,oN=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tabWorld=void 0,n.tabFriends=void 0,n.scene=t,n.createTabFriends(),n.createTabWorld(),n}(0,s.Z)(t,e);var n=t.prototype;return n.selectTabFriends=function(){this.tabFriends.button.setFrame(sN.LEADERBOARD_TAB_ON),this.tabWorld.button.setFrame(sN.LEADERBOARD_TAB_OFF)},n.selectTabWorld=function(){this.tabFriends.button.setFrame(sN.LEADERBOARD_TAB_OFF),this.tabWorld.button.setFrame(sN.LEADERBOARD_TAB_ON)},n.createTabFriends=function(){this.tabFriends=new Hc.Z(this.scene,rN,sN.LEADERBOARD_TAB_OFF),this.tabFriends.button.setSize(85,33).setDisplaySize(85,33),this.tabFriends.setName("FriendsTab");var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:9,text:"FRIENDS",origin:{x:.5,y:.55}});this.tabFriends.add(e),Phaser.Display.Align.In.Center(this.tabFriends,this,-55),this.add(this.tabFriends)},n.createTabWorld=function(){this.tabWorld=new Hc.Z(this.scene,rN,sN.LEADERBOARD_TAB_OFF),this.tabWorld.button.setSize(85,33).setDisplaySize(85,33),this.tabWorld.setName("WorldTab");var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:9,text:"WORLD",origin:{x:.5,y:.55}});this.tabWorld.add(e),Phaser.Display.Align.In.Center(this.tabWorld,this,55),this.add(this.tabWorld)},t}(Phaser.GameObjects.Container),cN=oN,hN=Wi.Z.DEFAULT,uN=hN.KEY,lN=hN.FRAME,dN=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.background=void 0,n.tabs=void 0,n.leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.scene=t,n.setSize(310,430),n.createBackground(),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.showLoading=function(e){this.loading.setVisible(e),this.showMessage(!1)},n.showMessage=function(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.messageAnimation.play())},n.createBackground=function(){this.background=new mh(this.scene,0,0,310,430),this.add(this.background)},n.createLoading=function(){this.loading=new $o.Z(this.scene),this.loading.setTint(12237498),this.loading.setWorldSize(113,113),this.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this.background)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this.background)},n.createContents=function(){this.createLeaders(),this.createTitle(),this.createTabs()},n.createLeaders=function(){this.leaders=new iN(this.scene),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this.background,0,0)},n.createTitle=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:uN,frame:lN.RIBBON_SHORT});t.setWorldSize(271,81);var n=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Leaderboards"});Phaser.Display.Align.In.Center(n,t,0,-10),e.add([t,n]),Phaser.Display.Align.In.TopCenter(e,this.background,0,5),this.add(e)},n.createTabs=function(){this.tabs=new cN(this.scene),this.add(this.tabs),Phaser.Display.Align.In.TopCenter(this.tabs,this.background,0,-55)},n.createAnimation=function(){this.messageAnimation=new HM.Z({targets:[this.message],duration:60,repeat:2})},t}(Phaser.GameObjects.Container),pN=dN,fN=GameCore.Configs.LeadersBoard,mN=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).board=void 0,t.footerBar=void 0,t.tabId=void 0,t.offset=void 0,t.isRequesting=void 0,t.isSwitchable=void 0,t.run=function(){t.isRequesting=!1;var e=[{selector:pc,callback:function(e){if(t.isRequesting=e,t.board.showLoading(e),!1===e){var n=t.game.storage.getState(),i=dc(n);t.board.leaders.updateData(i)}}}];t.handleStateChange(e),t.selectFriendTab()},t.handleSelectFriendTab=function(){t.isRequesting||t.isSwitchable&&(t.isSwitchable=!1,t.selectFriendTab())},t.handleSelectWorldTab=function(){t.isRequesting||t.isSwitchable&&(t.isSwitchable=!1,t.selectWorldTab())},t.handlePlayWithFriend=function(){t.storage.dispatch(yi())},t.handleHomeClick=function(){t.scene.switch(oe.C.DASHBOARD_SCENE)},t.handleShareLeaderboard=function(){t.storage.dispatch(Ac())},t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.gameZone.setPosition(0,0),this.createBackground(ie.Z.BACKGROUND.KEY,"0"),this.scene.bringToTop(),this.createBoard(),this.createFooterBar()},n.selectFriendTab=function(){this.tabId=we,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabFriends(),this.storage.dispatch(cc(fN.LeaderboardId,we,fN.Limit,this.offset))},n.selectWorldTab=function(){this.tabId=Ae,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabWorld(),this.storage.dispatch(cc(fN.LeaderboardId,Ae,fN.Limit,this.offset))},n.loadMoreTabFriend=function(){this.isRequesting||(this.offset+=fN.Limit,this.storage.dispatch(cc(fN.LeaderboardId,we,fN.Limit,this.offset)))},n.loadMoreTabWorld=function(){this.isRequesting||(this.offset+=fN.Limit,this.storage.dispatch(cc(fN.LeaderboardId,Ae,fN.Limit,this.offset)))},n.createBoard=function(){this.board=new pN(this),Phaser.Display.Align.In.Center(this.board,this.gameZone,0,-20),this.board.tabs.tabWorld.onClick=this.handleSelectWorldTab,this.board.tabs.tabFriends.onClick=this.handleSelectFriendTab},n.createFooterBar=function(){this.footerBar=new WM(this),Phaser.Display.Align.In.BottomCenter(this.footerBar,this.gameZone,0,-50),this.footerBar.homeButton.onClick=this.handleHomeClick,this.footerBar.playButton.onClick=this.handlePlayWithFriend,this.footerBar.shareButton.onClick=this.handleShareLeaderboard},t}(qo.Z);var gN,vN,yN=mN,EN=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,s.Z)(t,e),t}((0,x.Z)(Error)),CN=Wi.Z.DEFAULT,AN=CN.KEY,wN=CN.FRAME,SN=[{id:"pass-levels",title:"passLevels",require:{level:5},reward:{coins:300},key:AN,frame:wN.MISSION.IC_PASS_LEVEL},{id:"clear-cards",title:"clearCards",require:{cards:60},reward:{coins:200},key:AN,frame:wN.MISSION.IC_CLEAR_CARD},{id:"use-wild-cards",title:"useWildCards",require:{wildCards:5},reward:{coins:300},key:AN,frame:wN.MISSION.IC_USE_WILD_CARD}],bN=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",SN);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),TN=(0,j.P1)([function(e){var t;return null==(t=e[Ns])?void 0:t.tasks}],(function(e){return e})),xN=(0,j.P1)([function(e){var t;return null==(t=e[Ns])?void 0:t.process}],(function(e){return e})),PN=(0,j.P1)([function(e){var t;return null==(t=e[Ns])?void 0:t.isRequesting}],(function(e){return e})),kN=((0,j.P1)([function(e){var t;return null==(t=e[Ns])?void 0:t.isNotice}],(function(e){return e})),GameCore.Configs.DailyTasks,function(e){return function(t){t({type:Zs,payload:{tasks:e}})}}),IN=function(){window.game.player},ON=function(){function e(e,t){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(e){var t=e.type,i=e.value;if(!(i<1)&&(-1!==n.requireTypes.indexOf(t)&&!n.isPassRequiredTarget(t)&&n.processMore(e))){t=e.type,i=e.value;var a=n.getCorrectValue(t,i);n.game.storage.dispatch(function(e,t,n){return function(i){var a=IN();if(GameCore.Utils.Valid.isObject(a)){var r=a;GameCore.Utils.Object.hasOwn(r,e)&&(r[e].rewarded||(r[e][t]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:r}),i({type:Fs,payload:{id:e,type:t,value:n}})))}}}(n.id,t,a)),n.isTaskFinished(t)&&n.game.storage.dispatch(function(e){return function(t){t({type:Us,payload:{id:e}}),Xh.emit(Kh.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=e,this.id=t,this.init()}var t=e.prototype;return t.init=function(){var e=this,t=this.game.storage.getState(),n=TN(t)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:n.find((function(t){return t.id===e.id}));i&&(this.taskData=i,this.requireTypes=Object.keys(this.taskData.require),this.initEvents())}},t.getDataByType=function(e){var t=this.game.storage.getState(),n=xN(t),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,e)){var r=a[e];"number"===typeof r&&(i.value=r)}return i.target=this.taskData.require[e]||0,i},t.getCorrectValue=function(e,t){var n=this.getDataByType(e),i=n.value,a=n.target,r=t;return i+t>a&&(r=a-i),Math.round(r)},t.isPassRequiredTarget=function(e){var t=this.getDataByType(e);return t.value>=t.target},t.isTaskFinished=function(e){var t=this.getDataByType(e);return t.value>=t.target},e}(),RN=ON,BN=Kh.CHALLENGE_FRIENDS,DN=BN.ID,LN=BN.EVENTS,_N=function(e){function t(t){return e.call(this,t,DN)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(LN.CHALLENGE_FRIENDS,this.process),Xh.on(LN.CHALLENGE_FRIENDS,this.process)},n.processMore=function(){return!0},t}(RN),MN=_N,NN=Kh.CLEAR_CARDS,GN=NN.ID,ZN=NN.EVENTS,FN=function(e){function t(t){var n;return(n=e.call(this,t,GN)||this).cards=void 0,n.reset=function(){n.cards=[]},n.reset(),n}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){var e=this;Xh.off(ZN.CLEAR_CARDS,this.process),Xh.on(ZN.CLEAR_CARDS,this.process),Xh.on(ZN.RESET,(function(){return e.reset()}))},n.processMore=function(e){var t=e.card;return!(!t||this.cards.includes(t))&&(this.cards.push(t),!0)},t}(RN),UN=FN,WN=Kh.INVITE_FRIENDS,HN=WN.ID,YN=WN.EVENTS,KN=function(e){function t(t){return e.call(this,t,HN)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(YN.INVITED_FRIEND,this.process),Xh.on(YN.INVITED_FRIEND,this.process)},n.processMore=function(){return!0},t}(RN),zN=KN,VN=Kh.PASS_LEVELS,jN=VN.ID,XN=VN.EVENTS,qN=function(e){function t(t){return e.call(this,t,jN)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(XN.PASS_LEVEL,this.process),Xh.on(XN.PASS_LEVEL,this.process)},n.processMore=function(){return!!li.instance.isSingleMode()},t}(RN),JN=qN,QN=Kh.USE_WILDCARDS,$N=QN.ID,eG=QN.EVENTS,tG=function(e){function t(t){return e.call(this,t,$N)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(eG.USE_WILDCARD,this.process),Xh.on(eG.USE_WILDCARD,this.process)},n.processMore=function(){return!0},t}(RN),nG=tG,iG=function(){function e(e){var t=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.eventsListener={},e.next=3,t.initData();case 3:t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!PN(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Gs,payload:{}}),e.next=7,bN();case 7:a=e.sent,t(kN(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.game=e,this.init()}var t=e.prototype;return t.getEventListener=function(e){return this.eventsListener[e]},t.initEvents=function(){this.eventsListener[Kh.PASS_LEVELS.ID]=new JN(this.game),this.eventsListener[Kh.INVITE_FRIENDS.ID]=new zN(this.game),this.eventsListener[Kh.USE_WILDCARDS.ID]=new nG(this.game),this.eventsListener[Kh.CHALLENGE_FRIENDS.ID]=new MN(this.game),this.eventsListener[Kh.CLEAR_CARDS.ID]=new UN(this.game)},e}(),aG=iG,rG=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],sG=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rG);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oG=(0,j.P1)([function(e){var t;return null==(t=e[Os])?void 0:t.missions}],(function(e){return e})),cG=(0,j.P1)([function(e){var t;return null==(t=e[Os])?void 0:t.isRequesting}],(function(e){return e})),hG=((0,j.P1)([oG,function(e,t){return t.name}],(function(e,t){return e?"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:null:null})),function(e){return{type:Bs,payload:{missions:e}}}),uG=Wi.Z.GAMEPLAY.FRAME,lG=uG.TILE_RED,dG=uG.TILE_BLUE,pG=uG.TILE_PINK,fG=uG.TILE_GREEN,mG=uG.TILE_YELLOW,gG=uG.TILE_FREEZE,vG=uG.TILE_COLORFUL,yG=uG.TILE_COLOR_CHANGE,EG={RED:"red",BLUE:"blue",PINK:"pink",GREEN:"green",YELLOW:"yellow"},CG={FREEZE:"freeze",COLORFUL:"colorful",COLOR_CHANGE:"color_change"},AG=EG.RED,wG=EG.BLUE,SG=EG.PINK,bG=EG.GREEN,TG=EG.YELLOW,xG=CG.FREEZE,PG=CG.COLORFUL,kG=CG.COLOR_CHANGE,IG=((gN={})[AG]="r",gN[wG]="b",gN[SG]="p",gN[bG]="g",gN[TG]="y",gN[xG]="f",gN[PG]="c",gN[kG]="m",gN),OG={SIZE:37,STATUS:{READY:"ready",MOVING:"moving",CAPTURED:"captured"},FRAME:(vN={},vN[AG]=lG,vN[wG]=dG,vN[SG]=pG,vN[bG]=fG,vN[TG]=mG,vN[xG]=gG,vN[PG]=vG,vN[kG]=yG,vN),SETS:{SET_3:"set_3",SET_4:"set_4",SET_5:"set_5",SET_6:"set_6",SET_7:"set_7",SET_8:"set_8",SET_9:"set_9"},COLORS:EG,SPECIALS:CG,HASH:IG},RG={GIFT:{ID:"ItemGift"},PAINT:{ID:"ItemPaint"},HAMMER:{ID:"ItemHammer"},SHUFFLE:{ID:"ItemShuffle"},CHANGE_COLOR:{ID:"ItemChangeColor"}},BG={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"},OBJECTS:(0,a.Z)({},OG.COLORS,OG.SPECIALS,{PAINT:RG.PAINT.ID,HAMMER:RG.HAMMER.ID,SHUFFLE:RG.SHUFFLE.ID})},DG=(0,j.P1)([function(e){var t;return null==(t=e[Os])?void 0:t.mission}],(function(e){return e})),LG=((0,j.P1)([DG],(function(e){return e?e.name:null})),function(){function e(e,t,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(e){var t=e.id,n=e.type,a=e.value;a<1||i.id===t&&i.isTypeRequired(n)&&i.processMore(e)&&(i.game.storage.dispatch(function(e,t,n){return{type:Ds,payload:{name:e,type:t,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(Xh.emit(BG.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(e){return{type:Ls,payload:{name:e}}}(i.name))))},this.id=t,this.name=n,this.game=e}var t=e.prototype;return t.start=function(){var e=this.game.storage.getState(),t=DG(e);t&&t.name===this.name&&(this.reward=t.reward,this.initEvents())},t.getMissionData=function(){var e=this.game.storage.getState(),t=DG(e);return t?t.name!==this.name?null:t:null},t.getDataByType=function(e){var t=this.getMissionData();if(!t)return null;var n=t.require[e];return{value:t.process[e],target:n}},t.isTypeRequired=function(e){var t=this.getDataByType(e);return!!t&&t.target>0},t.isMissionComplete=function(){var e=this.getMissionData();if(!e)return!0;var t=e.require,n=e.process,i=!0;return Object.keys(t).forEach((function(e){if(i){var a=t[e];n[e]<a&&(i=!1)}})),i},e}()),_G=LG,MG=BG.EVENTS,NG=BG.TYPES,GG=function(e){function t(t,n){return e.call(this,t,NG.COLLECT_GEMS,n)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(MG.MISSION_UPDATE,this.process),Xh.on(MG.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},t}(_G),ZG=GG,FG=BG.EVENTS,UG=BG.TYPES,WG=function(e){function t(t,n){return e.call(this,t,UG.COMBO,n)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(FG.MISSION_UPDATE,this.process),Xh.on(FG.MISSION_UPDATE,this.process)},n.processMore=function(e){var t=this.getMissionData();if(!t)return!1;var n=e.type;return e.value>=t.require[n]},t}(_G),HG=WG,YG=BG.EVENTS,KG=BG.TYPES,zG=function(e){function t(t,n){return e.call(this,t,KG.USE_ITEM,n)||this}(0,s.Z)(t,e);var n=t.prototype;return n.initEvents=function(){Xh.off(YG.MISSION_UPDATE,this.process),Xh.on(YG.MISSION_UPDATE,this.process)},n.processMore=function(e){return!0},t}(_G),VG=zG,jG=function(){function e(e){var t=this;this.game=void 0,this.listener=void 0,this.init=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initData();case 2:t.initListeners(),t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!cG(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Rs,payload:{}}),e.next=7,sG();case 7:a=e.sent,t(hG(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.startListener=function(e){t.listener[e]&&t.listener[e].start()},this.game=e,this.init()}var t=e.prototype;return t.initListeners=function(){var e=this;this.listener={};var t=this.game.storage.getState(),n=oG(t);n&&Object.keys(n).forEach((function(t){switch(n[t].id){case BG.TYPES.COLLECT_GEMS:e.listener[t]=new ZG(e.game,t);break;case BG.TYPES.COMBO:e.listener[t]=new HG(e.game,t);break;case BG.TYPES.USE_ITEM:e.listener[t]=new VG(e.game,t)}}))},t.initEvents=function(){Xh.off(BG.EVENTS.MISSION_START,this.startListener),Xh.on(BG.EVENTS.MISSION_START,this.startListener)},e}(),XG=jG,qG=function(){return function(e){try{window.game.facebook.getTournamentAsync().then((function(t){e(mi(t))})).catch((function(e){}))}catch(t){}}},JG=function(){return function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=n(),a=Dt(i),r=window.game,s=r.player,o=r.level,h=s.getPlayer(),u=a.entryPointData,d=(l=u||{}).matchId,p=l.opponentId,f=l.playerId,m=h.playerId===f,o.getLevelData()){e.next=17;break}return e.prev=10,e.next=13,o.preloadLevelDataAsync();case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:t(Ci(d,m?p:f)),e.next=23;break;case 20:throw e.prev=20,e.t1=e.catch(0),new Error("processChallengeFriendMode: "+e.t1);case 23:case"end":return e.stop()}}),e,null,[[0,20],[10,15]])})));return function(t,n){return e.apply(this,arguments)}}()},QG=n(75),$G=GameCore.Configs.Notification.ApiUrl,eZ=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,Ce("players/"+n,t,{},$G,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tZ=GameCore.Configs,nZ=tZ.AppId,iZ=tZ.Notification,aZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).isMusicLoaded=!1,t.handleFBInstantGameStarted=function(){window.__fbGameReady=!0,window.__fbPlatform=FBInstant.getPlatform(),t.player.requestConnectedPlayers(),t.facebook.attemptToAddShortcut()},t.processAfterUpdatePlayerProfile=function(){iZ.Enable&&(t.updatePlayerProfileToNotificationService(),iZ.DisableSendNotification||(kv.sendNewUserNotification(),kv.sendDailyNotification()))},t.startGame=function(){t.analytics.event(te._.APP_READY),t.storage.dispatch((0,QG.I)(oe.C.LOAD_SCENE)),t.storage.dispatch((function(e,t){var n=window.game,i=n.player,a=n.analytics,r=n.globalScene;try{var s=t(),o=Dt(s),c=Lt(s),h=i.getPlayer(),u=(o.entryPointData||{}).type;if(h.isUserNew&&a.event(te._.NEW_USER),c===Bt)return void e(qG());if(c===Ot&&u===je)return void e(JG());e(gi())}catch(l){r.events.emit(oe.K.SWITCH,oe.C.GAME_SCENE),(0,Y.tO)(l)}})),window.GameSDK.gameReady()},t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(te._.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){var t=new EN("Load resources at LoadScene failed.");(0,Y.R0)(t,{file:null==e?void 0:e.url})})),this.addFontToTextStyler(),(0,Pc.QT)(this.lang.getCurrentLanguage());var t=this.addLocaleToFilename(Pc.ZP.FONT_ATLAS.TEXTURE),n=this.addLocaleToFilename(Pc.ZP.FONT_ATLAS.DATA);this.load.atlas(Pc.ZP.FONT_ATLAS.KEY,t,n),this.load.atlas({key:Wi.Z.DEFAULT.KEY,textureURL:Wi.Z.DEFAULT.TEXTURE,atlasURL:Wi.Z.DEFAULT.JSON}),this.load.atlas({key:Wi.Z.GAMEPLAY_DEFAULT.KEY,textureURL:Wi.Z.GAMEPLAY_DEFAULT.TEXTURE,atlasURL:Wi.Z.GAMEPLAY_DEFAULT.JSON}),this.load.atlas({key:Wi.Z.GAMEPLAY_OBJECTS.KEY,textureURL:Wi.Z.GAMEPLAY_OBJECTS.TEXTURE,atlasURL:Wi.Z.GAMEPLAY_OBJECTS.JSON}),this.load.atlas({key:Wi.Z.DASHBOARD.KEY,textureURL:Wi.Z.DASHBOARD.TEXTURE,atlasURL:Wi.Z.DASHBOARD.JSON}),this.load.multiatlas({key:Wi.Z.EFFECTS.KEY,path:Wi.Z.EFFECTS.PATH,atlasURL:Wi.Z.EFFECTS.JSON}),this.load.image(ie.Z.OVERLAY.KEY,ie.Z.OVERLAY.FILE);var i=this.addLocaleToFilename(Pc.ZP.PRIMARY.DATA),a=this.addLocaleToFilename(Pc.ZP.NORMAL.DATA),r=this.addLocaleToFilename(Pc.ZP.NORMAL_1.DATA),s=this.addLocaleToFilename(Pc.ZP.SHADOW.DATA),o=this.addLocaleToFilename(Pc.ZP.STROKE.DATA),c=this.addLocaleToFilename(Pc.ZP.WHITE_SHADOW.DATA),h=this.addLocaleToFilename(Pc.ZP.STYLE.DATA),u=this.addLocaleToFilename(Pc.ZP.HEADER.DATA);[{key:Pc.ZP.PRIMARY.KEY,data:i},{key:Pc.ZP.NORMAL.KEY,data:a},{key:Pc.ZP.NORMAL_1.KEY,data:r},{key:Pc.ZP.SHADOW.KEY,data:s},{key:Pc.ZP.STROKE.KEY,data:o},{key:Pc.ZP.WHITE_SHADOW.KEY,data:c},{key:Pc.ZP.STYLE.KEY,data:h},{key:Pc.ZP.HEADER.KEY,data:u}].forEach((function(t){var n=t.key,i=t.data;e.load.xml(n,i)})),this.player.updateData().then(this.processAfterUpdatePlayerProfile).catch(Y.tO);var l=GameCore.Configs.GameSettingsURL;l&&this.load.json("game-settings",l),this.journey.initData();var d=this.journey.getCurrentStage(),p=d.backgroundKey,f=d.backgroundFile;this.themeHandler.preloadBackgroundAsync(p,f)},n.create=function(){this.audio.initSound(),this.audio.importSoundEffectKeys(Fc.Z.EFFECTS),this.analytics.event(te._.LOAD_COMPLETE),this.parseBitmapFontFromAtlas();var e=this.player.getLevel();this.level.setLevel(e),this.level.setMaxLevel(1e3);var t=this.player.getLifeData();this.life.initData(t.hearts,t.lastTimeReceive),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.weeklyTournament.initData(),this.offshoreRace.initData(),this.boxingDuel.initData(),this.journey.initData(),this.handleShowAdWhenStartGame(),this.startGame()},n.parseBitmapFontFromAtlas=function(){var e=this;Pc.cX.forEach((function(t){var n=t.fontName,i=t.textureKey,a=t.frameKey,r=t.xmlKey;Phaser.GameObjects.BitmapText.ParseFromAtlas(e,n,i,a,r)}))},n.addFontToTextStyler=function(){"en"===this.lang.getCurrentLanguage()?this.textStyler.addFont({type:"local",fontType:"opentype",fontName:"mikado-bold"}):this.textStyler.addFont({type:"local",fontType:"woff",fontName:"DejaVuSans-Bold"})},n.updatePlayerProfileToNotificationService=function(){var e=this.player.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=e.locale,r=e.ASID;eZ({appId:nZ,playerId:t,name:n,photo:i,locale:a,ASID:r})},n.setupGlobalScene=function(){var e=this.scene.get(oe.C.GLOBAL_SCENE);e instanceof TM.Z&&e.setup()},n.initModules=function(){new XG(this.game),new aG(this.game)},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},n.addLocaleToFilename=function(e){return"./assets/fonts/"+this.lang.getCurrentLanguage()+"/"+e},n.handleShowAdWhenStartGame=function(){var e=this;if(GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){var t={en:"Initializing...",ru:"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f...",pt:"Inicializando...",es:"Inicializando...",ar:"\u062a\u0647\u064a\u0626\u0629...",hi:"\u092a\u094d\u0930\u093e\u0930\u0902\u092d \u0915\u0930 \u0930\u0939\u093e \u0939\u0948...",zh:"\u521d\u59cb\u5316\u4e2d...",tr:"Ba\u015flat\u0131l\u0131yor...",ja:"\u521d\u671f\u5316\u4e2d...",fr:"Initialisation en cours...",id:"Menginisialisasi...",de:"Initialisierung...",it:"Inizializzazione..."}[this.lang.getCurrentLanguage()||""]||"",n=document.createElement("div");n.id="wait-ads-mask";var i=document.createElement("div");i.id="wait-ads-content",n.appendChild(i);var a=document.createElement("div");a.id="wait-ads-dual-ring",i.appendChild(a);var s=document.createElement("div");s.id="wait-ads-text",s.innerHTML=t,i.appendChild(s),document.body.appendChild(n),this.audio.muteAll(),setTimeout((0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.ads.setAdInProcess(!0),e.audio.stopMusic(),e.audio.pauseAllSounds(),e.audio.muteAll(),t.next=7,e.ads.preloadInterstitialAdAsync();case 7:return t.next=9,e.ads.showInterstitialAdAsync();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),(0,Y.tO)(t.t0);case 14:return t.prev=14,n.remove(),e.ads.setAdInProcess(!1),GameSDK.isAudioEnabled()&&(e.audio.unmuteAll(),e.audio.playMusic(),e.audio.resumeAllSounds()),t.finish(14);case 19:case"end":return t.stop()}}),t,null,[[0,11,14,19]])}))),0)}},t}(Phaser.Scene),rZ=aZ,sZ=Wi.Z.DEFAULT,oZ=sZ.KEY,cZ=sZ.FRAME,hZ=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.avatar=void 0,n.crown=void 0,n.playerName=void 0,n.playerScore=void 0,n.scene=t,n.createAvatar(),n.updateSize(),n.createWinCrown(),n.createPlayerName(),n.createPlayerScore(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.showCrown=function(e){this.crown.setVisible(e),e?(this.avatar.setFrame(cZ.AVATAR_FRAME_YELLOW_BIG),this.avatar.setBackground(cZ.AVATAR_BG_YELLOW_BIG)):(this.avatar.setFrame(cZ.AVATAR_FRAME_BLUE_BIG),this.avatar.setBackground(cZ.AVATAR_BG_BLUE_BIG))},n.setPlayerName=function(e){this.playerName.setText(e)},n.setPlayerScore=function(e){this.playerScore.setText(""+e)},n.loadPhoto=function(e,t){this.avatar.loadPhoto(e,t,60)},n.updateSize=function(){var e=this.avatar,t=e.width,n=e.height;this.setSize(t,n)},n.createAvatar=function(){this.avatar=new Ic(this.scene,{key:oZ,frame:cZ.AVATAR_FRAME_BLUE_BIG,background:cZ.AVATAR_BG_BLUE_BIG,width:89,height:89}),this.add(this.avatar)},n.createWinCrown=function(){this.crown=this.scene.make.image({key:oZ,frame:cZ.ICON_CROWN}),this.crown.setWorldSize(52,36),Phaser.Display.Align.In.TopCenter(this.crown,this.avatar,0,75),this.add(this.crown)},n.createPlayerName=function(){this.playerName=this.scene.make.text({style:{fontFamily:(0,Pc.BN)(),fontSize:this.scene.fontSize(42)+"px",fontStyle:"bold"},origin:{x:.5,y:.5}}),this.playerName.setTint(11632207),this.playerName.setHighQuality(),Phaser.Display.Align.In.BottomCenter(this.playerName,this.avatar,0,25),this.add(this.playerName)},n.createPlayerScore=function(){this.playerScore=this.scene.make.bitmapText({size:this.scene.fontSize(30),font:Pc.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.playerScore.setTint(6762627),Phaser.Display.Align.In.BottomCenter(this.playerScore,this.playerName,0,25),this.add(this.playerScore)},t}(Phaser.GameObjects.Container),uZ=hZ,lZ=Wi.Z.DEFAULT,dZ=lZ.KEY,pZ=lZ.FRAME,fZ=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.titleText=void 0,n.playerScore=void 0,n.opponentScore=void 0,n.buttonClose=void 0,n.buttonRestart=void 0,n.buttonShare=void 0,n.scene=t,n.createBoard(),n.createTitle(),n.createVSText(),n.createPlayers(),n.createRestartButton(),n.createShareButton(),n.scene.add.existing((0,fc.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createBoard=function(){this.board=new mh(this.scene,0,0,600,340),this.board.setDepth(Fr.Z.BACKGROUND),this.add(this.board),Phaser.Display.Align.In.Center(this.board,this)},n.createTitle=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:dZ,frame:pZ.RIBBON_FULL});t.setWorldSize(340,75),this.titleText=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(32),origin:{x:.5,y:.5}}),Phaser.Display.Align.In.Center(this.titleText,t,0,-10),this.buttonClose=new Hc.Z(this.scene,dZ,pZ.BUTTON_CLOSE,41.8,41.8),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,t,0,-3),e.setDepth(Fr.Z.TILE),e.add([t,this.titleText,this.buttonClose]),this.add(e),Phaser.Display.Align.In.Center(e,this.board,0,-170)},n.createVSText=function(){var e=this.scene.make.bitmapText({font:Pc.ZP.PRIMARY.KEY,size:this.scene.fontSize(70),text:"VS",origin:{x:.5,y:.5}});e.setTint(11632207),e.setDepth(Fr.Z.TEXT),this.add(e),Phaser.Display.Align.In.Center(e,this.board,0,-45)},n.createPlayers=function(){this.playerScore=new uZ(this.scene),this.playerScore.setDepth(Fr.Z.ITEM),this.add(this.playerScore),Phaser.Display.Align.In.Center(this.playerScore,this.board,-100,-50),this.opponentScore=new uZ(this.scene),this.opponentScore.setDepth(Fr.Z.ITEM),this.add(this.opponentScore),Phaser.Display.Align.In.Center(this.opponentScore,this.board,100,-50)},n.createRestartButton=function(){this.buttonRestart=new _h.Z(this.scene,{key:dZ,button:pZ.BUTTON_GREEN,icon:pZ.ICON_RESUME,text:"Restart"},170,72),this.buttonRestart.setName("Restart"),this.buttonRestart.setDepth(Fr.Z.BUTTON),this.add(this.buttonRestart),Phaser.Display.Align.In.Center(this.buttonRestart,this.opponentScore,0,155)},n.createShareButton=function(){this.buttonShare=new _h.Z(this.scene,{key:dZ,button:pZ.BUTTON_BLUE,icon:pZ.ICON_FLAT_SHARE,text:"Share"},153,72),this.buttonShare.setName("Restart"),this.buttonShare.setDepth(Fr.Z.BUTTON),this.add(this.buttonShare),Phaser.Display.Align.In.Center(this.buttonShare,this.playerScore,0,155)},t}(Phaser.GameObjects.Container),mZ=fZ,gZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).main=void 0,t.run=function(){t.getResultInfo()},t.handleClose=function(){t.scene.sleep(oe.C.RESULT_MATCH_SCENE),t.scene.run(oe.C.GAME_OVER_SCENE)},t.handleShareScore=function(){t.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r,s,o,h,u,l,d,p,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,a=i.player,r=i.analytics,s=i.facebook,o=i.globalScene,e.prev=1,o.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),h=n(),e.next=6,bc(h);case 6:return u=e.sent,vc(u),l=a.getPlayer(),d=l.playerId,p=l.name,f=l.photo,e.next=11,s.shareAsync({text:"Pheww, a great match!",intent:"SHARE",image:u||"",data:{playerId:d,playerName:p,playerPhoto:f,type:Ve}});case 11:r.event(te._.SHARE,{share_content_type:"MatchResult",success:!0}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),r.event(te._.SHARE,{share_content_type:"MatchResult",success:!1}),(0,Y.tO)(e.t0);case 18:return e.prev=18,o.screen.close(ce.o4.NOTIFY_SCREEN),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})));return function(t,n){return e.apply(this,arguments)}}())},t.handleRestartMatch=function(){t.storage.dispatch(function(){var e=(0,r.Z)(c().mark((function e(t,n){var i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.game.globalScene.screen.open(ce.o4.NOTIFY_SCREEN,{message:window.game.lang.Text.loading,loading:!0}),i=n(),a=Je(i),[It,Bt].indexOf(a)>=0&&(t(Xn()),t(zn())),r=null,a===Ot&&(r=fn(i),t({type:$t,payload:{}})),t(ii()),e.next=11,t(wi(a,r));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,Y.tO)(e.t0);case 16:return e.prev=16,fi(300),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()),t.scene.sleep(oe.C.RESULT_MATCH_SCENE),t.scene.sleep(oe.C.GAME_OVER_SCENE)},t}(0,s.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this),this.createMask(.8),this.createMain(),this.createInput()},n.getResultInfo=function(){var e=this.storage.getState(),t=En(e),n=Je(e),i=this.player.getPlayer(),a=i.photo,r=i.name,s=i.playerId,o=fn(e),c=o.playerId,h=o.name,u=o.photo,l=(t[s]||{}).score,d=void 0===l?0:l,p=(t[c]||{}).score,f=void 0===p?0:p,m=gn(e,{playerId:s}),g=vn(e,{opponentId:c});n===Rt&&(m=!0,g=!0);var v=m&&g;this.main.playerScore.loadPhoto(s,a),this.main.opponentScore.loadPhoto(c,u),this.main.playerScore.setPlayerName(r),this.main.opponentScore.setPlayerName(h),this.main.playerScore.setPlayerScore(d),this.main.opponentScore.setPlayerScore(f),this.main.playerScore.showCrown(v&&d>f),this.main.opponentScore.showCrown(v&&f>d),m&&g?d===f?this.main.titleText.setText("Draw"):d>f?this.main.titleText.setText("You Win"):d<f&&this.main.titleText.setText("You Lose"):this.main.titleText.setText("Waiting for Opponent"),m&&g&&(d===f||(d>f?this.audio.playSound(ec.Z.YOU_WIN):d<f&&this.audio.playSound(ec.Z.YOU_LOSE)))},n.createMain=function(){this.main=new mZ(this),Phaser.Display.Align.In.Center(this.main,this.gameZone,0,13)},n.createInput=function(){this.main.buttonClose.onClick=this.handleClose,this.main.buttonRestart.onClick=this.handleRestartMatch,this.main.buttonShare.onClick=this.handleShareScore},t}(qo.Z);var vZ=gZ;function yZ(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return EZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EZ(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function EZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var CZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).level=1,t.maxLevel=10,t.challengeLevel=200,t.shouldLoadChallengeLevel=!1,t.promisePreloadLevel={},t.loadedLevel={},t.convertedLevel={},t.width=void 0,t.height=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this)},n.getLevel=function(){return this.level},n.setLevel=function(e){this.level=e,this.maxLevel=Math.max(this.maxLevel,e)},n.setChallengeLevel=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.challengeLevel=t,e.next=3,this.preloadLevelDataAsync(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getMaxLevel=function(){return this.maxLevel},n.setMaxLevel=function(e){this.maxLevel=e},n.setLevelCustom=function(e){this.loadedLevel[this.getKeyLevel(this.level)]=e},n.getLevelByMode=function(){return this.level},n.getRandomChallengeLevel=function(){return Phaser.Math.Between(200,500)},n.processLevelCompleted=function(e,t){var n=window.game.player,i=n.getLevel();this.setLevel(e+1),i<=e&&n.setLevel(e+1),this.preloadLevelDataAsync(e+1)},n.nextLevel=function(){this.level+=1,this.maxLevel=Math.max(this.level,this.maxLevel),this.preloadLevelDataAsync(this.level),this.preloadLevelDataAsync(this.level+1)},n.backLevel=function(){this.level-=1,this.maxLevel=Math.max(this.level,this.maxLevel),this.preloadLevelDataAsync(this.level),this.preloadLevelDataAsync(this.level-1)},n.getKeyLevel=function(e){var t="0001";return GameCore.layoutInitializer.isLandscape?(e>1e3&&(e=501+(e-501)%500),t=GameCore.Utils.Number.padStart(e,4)):(e>1200&&(e=501+(e-501)%700),t=GameCore.Utils.Number.padStart(e,4)),"level_"+t},n.preloadLevelDataAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||this.level,n=this.getKeyLevel(t),(!Object.keys(this.promisePreloadLevel).includes(n)||GameCore.Configs.Level.alwaysLoadNew)&&(this.promisePreloadLevel[n]=this.preloadLevel(t)),e.next=6,this.promisePreloadLevel[n];case 6:if(i=e.sent){e.next=13;break}return delete this.promisePreloadLevel[n],this.promisePreloadLevel[n]=this.preloadLevel(t),e.abrupt("return",this.promisePreloadLevel[n]);case 13:return this.loadedLevel[n]=i,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.preloadLevel=function(){var e=(0,r.Z)(c().mark((function e(t){var n,i,a,r,s,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=GameCore.Configs.Level.url,a=GameCore.Configs.Level.urlPortrait,r=GameCore.layoutInitializer.isLandscape?i:a,s=this.getKeyLevel(t),e.next=7,fetch(""+r+s+".json",{method:"GET"});case 7:return o=e.sent,e.next=10,o.json();case 10:n=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",void 0);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),n.getLevelDataAsync=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.preloadLevelDataAsync(t||this.level);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),n.getLevelData=function(e){e=e||this.level;var t=this.getKeyLevel(e);if(this.loadedLevel[t]){if(this.convertedLevel[t]&&!GameCore.Configs.Level.alwaysLoadNew)return this.convertedLevel[t];var n=this.getNewLevelData(this.loadedLevel[t]);return this.convertedLevel[t]=n,n}},n.getNewLevelData=function(e){var t=this.getLayer("game-board",e),n=this.getLayer("settings",e),i=this.getLayer("code-breakers",e);return{cards:this.getCards(t),settings:this.getSettings(n),balloonData:this.getBalloon(i)}},n.toWorldPosition=function(e,t){return GameCore.layoutInitializer.isLandscape?this.toWorldPositionLandscape(e,t):this.toWorldPositionPortrait(e,t)},n.toWorldPositionLandscape=function(e,t){var n=this.game.world.getWorldSize(),i=360/1080;return{x:e*i+(n.width-640)/2,y:t*i-(360-n.height)/2-this.game.world.getSAB()/2}},n.toWorldPositionPortrait=function(e,t){var n=this.game.world.getWorldSize(),i=640/1920;return{x:e*i+(n.width-360)/2,y:t*i-((667-n.height)/2+5)-this.game.world.getSAB()/2}},n.convertCardType=function(e){if(e.type==zh.MOUSE)return Qh.LOCK;if(e.type==zh.CHEESE)return Qh.KEY;if(e.type==zh.VALUE)return e.addon==$h.BOMB?Qh.BOOM:e.addon==$h.CHESTNUT||e.addon==$h.MAP_PIECE?Qh.MAP_PIECE:e.addon==$h.INCREASE||e.addon==$h.DECREASE?Qh.CHANGER:e.addon==$h.CHAIN?Qh.CHAIN:Qh.VALUE;if(e.type==zh.SQUIRREL)return Qh.TREASURE;if(e.type==zh.TREASURE)return Qh.TREASURE;if(e.type==zh.PLUS){if(1==e.value)return Qh.PLUS_ONE;if(2==e.value)return Qh.PLUS_TWO;if(3==e.value)return Qh.PLUS_THREE;if(4==e.value)return Qh.PLUS_FOUR;if(5==e.value)return Qh.PLUS_FIVE}return e.type==zh.MYSTERIOUS?Qh.MYSTERIOUS:Qh.VALUE},n.getSuit=function(e){return-1==e?-1:[vu.SPADES,vu.CLUBS,vu.DIAMOND,vu.HEART][e-1]},n.getCards=function(e){var t=this;return e.objects.map((function(e,n){var i=e.x,r=e.y,s=e.id,o=e.rotation,c=e.properties,h=void 0===c?[]:c,u=(0,a.Z)({},t.toWorldPosition(i,r),{id:s,depth:n,addon:$h.NONE,addonValue:-1,suit:-1,angle:o,type:zh.VALUE,faceUp:!1,random:!1,value:-1,connectedCardID:-1});return h.forEach((function(e){u[e.name]=e.value})),-1==u.value?-1==u.suit?u.random=!0:u.value=Phaser.Math.Between(1,13):-1==u.suit&&(u.suit=Phaser.Math.Between(1,4)),u.type!=zh.PLUS&&(u.value=u.random?-1:u.value,u.suit=t.getSuit(u.suit)),t.toCardData(u)}))},n.toCardData=function(e){var t=e.id,n=e.x,i=e.y,a=e.angle,r=e.depth,s=e.faceUp,o=e.value,c=e.suit;return{x:n,y:i,id:t,depth:r,angle:a<-180?360+a:a>180?a-360:a,type:this.convertCardType(e),faceUp:s,random:-1==e.value||-1==e.suit,suit:c,value:o,NumberOfMoves:e.addonValue,CardChangerType:e.addon==$h.INCREASE?1:e.addon==$h.DECREASE?2:-1,connectedCardID:e.addonValue}},n.getProps=function(e,t){for(var n,i=yZ(e);!(n=i()).done;){var a=n.value;if(a.name==t)return a.value}},n.findObjectByName=function(e,t){for(var n,i=yZ(e);!(n=i()).done;){var a=n.value;if(a.name==t)return a}},n.getCodeBreakers=function(e){var t=this,n=[];return e.objects.forEach((function(i){if("lock"==i.name){var a="left"==t.getProps(i.properties,"direction")?1:2,r=e.objects.map((function(e){if(t.getProps(e.properties,"lockID")===i.id){var n=t.getProps(e.properties,"cardSuit")||-1;return{cardColor:t.getProps(e.properties,"cardColor")||0,cardSuit:t.getSuit(n),cardFace:t.getProps(e.properties,"cardValue")||0}}})).filter((function(e){return e})),s=i.x,o=i.y;n.push({direction:a,cardValues:r,position:t.toWorldPosition(s,o)})}})),n},n.getBalloon=function(e){var t=this,n=[],i=e.objects.filter((function(e){return"lock"==e.name}));return i?(i.forEach((function(i){var a,r;a="left"==t.getProps(i.properties,"direction")?1:2,r=t.toWorldPosition(i.x,i.y);var s=e.objects.filter((function(e){return t.getProps(e.properties,"lockID")===i.id}));if(0==s.length)return[];var o=s.map((function(e){var n=t.getProps(e.properties,"cardSuit")||-1,i={cardColor:t.getProps(e.properties,"cardColor")||0,cardSuit:t.getSuit(n),cardFace:t.getProps(e.properties,"cardValue")||0};return{position:t.toWorldPosition(e.x,e.y),cardValues:i}}));n.push({direction:a,position:r,balloons:o})})),n):[]},n.getSettings=function(e){var t,n,i,a=this.getCards(e),r=this.getMapProperties(e);return{cardsInStack:a.map((function(e){return{value:e.value,suit:e.suit}})),star_1:(null==(t=e.properties.find((function(e,t){return"star_1"==e.name})))?void 0:t.value)||0,star_2:(null==(n=e.properties.find((function(e,t){return"star_2"==e.name})))?void 0:n.value)||0,star_3:(null==(i=e.properties.find((function(e,t){return"star_3"==e.name})))?void 0:i.value)||0,mapProperties:r}},n.getMapProperties=function(e){for(var t,n=yZ(e.properties);!(t=n()).done;){var i=t.value;if("mapProperties"==i.name){var a=i.value;return this.convertStreakToComboRewards(a),(0,An.TS)(Ud,a)}}return Ud},n.convertStreakToComboRewards=function(e){return[]},n.getLayer=function(e,t){for(var n,i=yZ(t.layers);!(n=i()).done;){var a=n.value;if(a.name==e)return a}return t.layers[0]},n.setGameplayZone=function(e,t){this.width=e,this.height=t},t}(Phaser.Plugins.BasePlugin),AZ=CZ,wZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).hearts=1,t.lastTimeReceive=0,t.maxHearts=void 0,t.maxTimeReceive=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.initData=function(e,t){this.hearts=e,this.lastTimeReceive=t,this.setMaxHearts(5),this.setMaxTimeReceive(1800)},n.setMaxTimeReceive=function(e){this.maxTimeReceive=e},n.setMaxHearts=function(e){this.maxHearts=e},n.getHearts=function(){return this.hearts},n.getTimeReceive=function(){return this.lastTimeReceive},n.getMaxHearts=function(){return this.maxHearts},n.setHearts=function(e){this.hearts>=this.maxHearts&&e<this.maxHearts&&this.resetTime(),this.hearts=e,this.updateLifeData(),this.game.events.emit(hi.HEART_CHANGED)},n.resetTime=function(){this.lastTimeReceive=Date.now(),this.updateLifeData()},n.increaseHeart=function(e,t){var n=this.hearts+e;t&&n>this.maxHearts&&(n=this.maxHearts),this.setHearts(n)},n.decreaseHeart=function(e){var t=this.hearts-e;t<0&&(t=0),this.setHearts(t)},n.getTimeLeftToReceiveHeart=function(){if(0==this.lastTimeReceive)return 0;var e=Date.now()-this.lastTimeReceive;return this.maxTimeReceive-Math.floor(e/1e3)},n.updateTime=function(){if(!(this.hearts>=this.maxHearts)){var e=this.getTimeLeftToReceiveHeart();if(e<=0){var t=Math.abs(Math.ceil(e/this.maxTimeReceive));this.increaseHeart(t,!0),this.resetTime()}}},n.updateLifeData=function(){window.game.player},t}(Phaser.Plugins.BasePlugin),SZ=wZ,bZ=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.performVibrating=function(e){this.game.player.getPlayerSettings().vibrate&&ov(e)},t}(Phaser.Plugins.BasePlugin),TZ=bZ;function xZ(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return PZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PZ(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function PZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var kZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).cache=[],t}(0,s.Z)(t,e);var n=t.prototype;return n.refreshFriendsLeaderboard=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h,u,l,d,p,f,m,g,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.player.getPlayerId(),n=this.game.player.getConnectedPlayerIds(20,0),i=this.game.player.getConnectedPlayers(),a=n.filter((function(e){return e!==t})),r=[],e.prev=5,e.next=8,Ge({playerIds:a,limit:a.length});case 8:s=e.sent,o=xZ(s);case 10:if((h=o()).done){e.next=21;break}if(u=h.value,l=u.playerId,d=u.score,p=u.rank,i[l]){e.next=15;break}return e.abrupt("continue",19);case 15:if(f=i[l],m=f.name,g=f.photo,r.push({playerId:l,name:m,photo:g,score:d,rank:p}),!(r.length>=4)){e.next=19;break}return e.abrupt("break",21);case 19:e.next=10;break;case 21:e.next=25;break;case 23:e.prev=23,e.t0=e.catch(5);case 25:v=this.isLeaderboardDirty(r),this.game.events.emit(hi.LEADERBOARD_UPDATED,v,r),this.cache=r;case 28:case"end":return e.stop()}}),e,this,[[5,23]])})));return function(){return e.apply(this,arguments)}}(),n.isLeaderboardDirty=function(e){if(this.cache.length!==e.length)return!0;for(var t=0;t<e.length;t++)if(this.cache[t].playerId!==e[t].playerId||this.cache[t].photo!==e[t].photo||this.cache[t].score!==e[t].score||this.cache[t].rank!==e[t].rank||this.cache[t].name!==e[t].name)return!0;return!1},t}(Phaser.Plugins.BasePlugin),IZ=kZ,OZ=n(44),RZ=n(45),BZ=function(e){function t(t){var n;return(n=e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n    \n    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);\n    gl_FragColor = texture *  texel;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}",uniforms:["uProjectionMatrix","uMainSampler","gray"]})||this).gray=void 0,n.gray=.8,n}return(0,s.Z)(t,e),t.prototype.onPreRender=function(){this.set1f("gray",this.gray)},t}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline),DZ=BZ,LZ=JSON.parse('[{"id":"0","name":"Paris","decorationKey":"paris","decorationConfigs":[{"id":"0","file":"arc","buttonX":-4,"buttonY":98,"decorations":[{"level":1,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.45,"offsetY":0},{"level":2,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.435,"offsetY":0},{"level":3,"x":1076,"y":441,"width":482,"height":358,"offsetX":0.435,"offsetY":0}]},{"id":"1","file":"artist","buttonX":176,"buttonY":-53,"decorations":[{"level":1,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0},{"level":2,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0},{"level":3,"x":1422,"y":25,"width":403,"height":312,"offsetX":0.5,"offsetY":0}]},{"id":"2","file":"cafe","buttonX":-160,"buttonY":149,"decorations":[{"level":1,"x":519,"y":609,"width":496,"height":335,"offsetX":0.33,"offsetY":0},{"level":2,"x":519,"y":609,"width":496,"height":335,"offsetX":0.417,"offsetY":0},{"level":3,"x":519,"y":609,"width":496,"height":335,"offsetX":0.417,"offsetY":0}]},{"id":"3","file":"eiffel","buttonX":-179,"buttonY":-19,"decorations":[{"level":1,"x":540,"y":8,"width":508,"height":446,"offsetX":0.368,"offsetY":0},{"level":2,"x":540,"y":8,"width":508,"height":446,"offsetX":0.364,"offsetY":0},{"level":3,"x":540,"y":8,"width":508,"height":446,"offsetX":0.364,"offsetY":0}]},{"id":"4","file":"girl","buttonX":184,"buttonY":139,"decorations":[{"level":1,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.396,"offsetY":0},{"level":2,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.39,"offsetY":0},{"level":3,"x":1550,"y":450,"width":507,"height":483,"offsetX":0.398,"offsetY":0}]}]},{"id":"1","name":"New York","decorationKey":"new-york","decorationConfigs":[{"id":"0","file":"taxi","buttonX":-75,"buttonY":-40,"decorations":[{"level":1,"x":991,"y":149,"width":423,"height":309,"offsetX":0.4822695035,"offsetY":0},{"level":2,"x":991,"y":149,"width":423,"height":309,"offsetX":0.4468085106,"offsetY":0},{"level":3,"x":991,"y":149,"width":423,"height":309,"offsetX":0.451536643,"offsetY":0}]},{"id":"1","file":"building","buttonX":88,"buttonY":-105,"decorations":[{"level":1,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0},{"level":2,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0},{"level":3,"x":1421,"y":0,"width":980,"height":617,"offsetX":0.5,"offsetY":0}]},{"id":"2","file":"man","buttonX":-47,"buttonY":62,"decorations":[{"level":1,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.2115384615,"offsetY":0},{"level":2,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.3557692308,"offsetY":0},{"level":3,"x":1115,"y":419,"width":416,"height":463,"offsetX":0.3461538462,"offsetY":0}]},{"id":"3","file":"hotdog","buttonX":-187,"buttonY":127,"decorations":[{"level":1,"x":370,"y":300,"width":554,"height":614,"offsetX":0.463898917,"offsetY":0},{"level":2,"x":370,"y":300,"width":554,"height":614,"offsetX":0.4314079422,"offsetY":0},{"level":3,"x":370,"y":300,"width":554,"height":614,"offsetX":0.5,"offsetY":0}]},{"id":"4","file":"girl","buttonX":186,"buttonY":143,"decorations":[{"level":1,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3639344262,"offsetY":0},{"level":2,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3836065574,"offsetY":0},{"level":3,"x":1784,"y":540,"width":305,"height":429,"offsetX":0.3737704918,"offsetY":0}]}]},{"id":"2","name":"Venice","decorationKey":"venice","decorationConfigs":[{"id":"0","file":"palace","buttonX":202,"buttonY":-61,"decorations":[{"level":1,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0},{"level":2,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0},{"level":3,"x":1255,"y":0,"width":642,"height":380,"offsetX":0.4423676012,"offsetY":0}]},{"id":"1","file":"mask","buttonX":-217,"buttonY":1,"decorations":[{"level":1,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0},{"level":2,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0},{"level":3,"x":479,"y":13,"width":420,"height":527,"offsetX":0.4880952381,"offsetY":0}]},{"id":"2","file":"girl","buttonX":191,"buttonY":119,"decorations":[{"level":1,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0},{"level":2,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0},{"level":3,"x":1595,"y":414,"width":304,"height":517,"offsetX":0.4440789474,"offsetY":0}]},{"id":"3","file":"bridge","buttonX":11,"buttonY":59,"decorations":[{"level":1,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0},{"level":2,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0},{"level":3,"x":838,"y":280,"width":767,"height":492,"offsetX":0.5084745763,"offsetY":0}]},{"id":"4","file":"man","buttonX":-105,"buttonY":149,"decorations":[{"level":1,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0},{"level":2,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0},{"level":3,"x":592,"y":378,"width":596,"height":702,"offsetX":0.4546979866,"offsetY":0}]}]}]'),_Z=JSON.parse('[{"worldNumber":0,"name":"Paris","previewKey":"location-previews","previewFrame":"Paris","backgroundKey":"Paris","backgroundFile":"./assets/images/new-stage/Paris.jpg","decorationKey":"paris","decorationFiles":["arc","artist","cafe","eiffel","girl"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"},{"worldNumber":1,"name":"New York","previewKey":"location-previews","previewFrame":"New York","backgroundKey":"New York","backgroundFile":"./assets/images/new-stage/NewYork.jpg","decorationKey":"new-york","decorationFiles":["building","girl","hotdog","man","taxi"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"},{"worldNumber":2,"name":"Venice","previewKey":"location-previews","previewFrame":"Venice","backgroundKey":"Venice","backgroundFile":"./assets/images/new-stage/Venice.jpg","decorationKey":"venice","decorationFiles":["girl","man","mask","palace","bridge"],"gameplayBackgroundKey":"background-wood","gameplayBackgroundFile":"./assets/images/2x/gameplay-backgrounds/background-wood.jpg"}]'),MZ=LZ,NZ=_Z[0],GZ=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).events=new Phaser.Events.EventEmitter,t.config=GameCore.Configs.GameDecoration,t.stages=void 0,t.currentStage=NZ,t.currentJourneyProgress=void 0,t.defaultInCountryProgress=void 0,t.decorationLocationConfigs=void 0,t}(0,s.Z)(t,e);var n=t.prototype;return n.init=function(){var e=this.config,t=e.Enable,n=e.MaxLocations;t&&(this.stages=_Z.slice(0,n),this.decorationLocationConfigs=MZ,this.initDefaultInProgressLocation())},n.initDefaultInProgressLocation=function(){var e=NZ.decorationFiles.map((function(e,t){return{id:t.toString(),locationId:NZ.worldNumber.toString(),name:e,level:0}})),t={id:NZ.worldNumber.toString(),name:NZ.name,progress:0,decorations:e};this.defaultInCountryProgress=t},n.initData=function(){this.initJourneyProgress()},n.initJourneyProgress=function(){if(this.currentJourneyProgress=this.game.player.getJourneyProgress(),this.currentJourneyProgress||(this.currentJourneyProgress={currentLocationIndex:-1,inProgressLocation:void 0,finishedLocationIds:[]}),!this.currentJourneyProgress.inProgressLocation||this.currentJourneyProgress.currentLocationIndex<0){var e=this.stages[0].decorationFiles.map((function(e,t){return{id:t.toString(),locationId:(0).toString(),name:e,level:0}})),t={id:this.stages[0].worldNumber.toString(),name:this.stages[0].name,progress:0,decorations:e};this.updateJourneyProgress({currentLocationIndex:0,inProgressLocation:t})}this.checkActualProgress()},n.checkActualProgress=function(){if(!this.currentJourneyProgress.inProgressLocation)return 0;var e=this.currentJourneyProgress.inProgressLocation.decorations,t=0;e.forEach((function(e){t+=e.level}));var n=(0,a.Z)({},this.currentJourneyProgress,{inProgressLocation:(0,a.Z)({},this.currentJourneyProgress.inProgressLocation,{progress:t})});return this.updateJourneyProgress(n),t},n.getAllStages=function(){return this.stages},n.getCurrentStage=function(){if(this.currentJourneyProgress){var e=this.currentJourneyProgress,t=e.inProgressLocation,n=e.currentLocationIndex;if(t&&(this.currentStage=this.stages[n],this.currentStage))return this.currentStage}return NZ},n.getNextStage=function(){if(this.currentJourneyProgress){var e=this.currentJourneyProgress.currentLocationIndex+1;if(e<this.stages.length)return this.stages[e]}},n.getInProgressLocation=function(){return this.currentJourneyProgress.inProgressLocation||this.initJourneyProgress(),this.currentJourneyProgress.inProgressLocation?this.currentJourneyProgress.inProgressLocation:this.defaultInCountryProgress},n.getCurrentDecorationLocationConfigs=function(){var e=this.getInProgressLocation(),t=this.decorationLocationConfigs.find((function(t){return t.name===e.name}));return t||this.decorationLocationConfigs[0]},n.updateDecorationData=function(e,t){var n=this.game.player.getJourneyProgress(),i=JSON.parse(JSON.stringify(n)),a=i.inProgressLocation,r=i.currentLocationIndex;if(a){var s=a.decorations.find((function(t){return t.id===e}));s&&(s.level=t),a.progress=a.decorations.reduce((function(e,t){return e+t.level}),0),this.updateJourneyProgress({inProgressLocation:a}),this.game.analytics.event(te._.DECORATION_UPGRADED,{level:this.game.player.getLevel(),name:this.stages[r].name,progress:a.progress})}},n.updateToNextLocation=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)),n=t.inProgressLocation,i=t.currentLocationIndex,a=t.finishedLocationIds;if(n&&this.isCurrentLocationCompleted()){var r=[].concat(a,[n.id]),s=i+1;if(s<this.stages.length){var o=this.stages[s],c=o.decorationFiles.map((function(e,t){return{id:t.toString(),locationId:o.worldNumber.toString(),name:e,level:0}})),h={id:o.worldNumber.toString(),name:o.name,progress:0,decorations:c};this.updateJourneyProgress({currentLocationIndex:s,inProgressLocation:h,finishedLocationIds:r})}else this.updateJourneyProgress({inProgressLocation:void 0,currentLocationIndex:-1,finishedLocationIds:r})}},n.isCurrentLocationCompleted=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)).inProgressLocation;if(!t)return!1;var n=t.progress>=3*t.decorations.length;return n},n.clearDecorationData=function(){var e=this.game.player.getJourneyProgress(),t=JSON.parse(JSON.stringify(e)).inProgressLocation;t&&(t.decorations=t.decorations.map((function(e){return(0,a.Z)({},e,{level:0})})),t.progress=0,this.updateJourneyProgress({inProgressLocation:t}))},n.resetJourneyProgressToDefault=function(){var e=this,t={currentLocationIndex:0,finishedLocationIds:[],inProgressLocation:{id:this.stages[0].worldNumber.toString(),name:this.stages[0].name,progress:0,decorations:this.stages[0].decorationFiles.map((function(t,n){return{id:n.toString(),locationId:e.stages[0].worldNumber.toString(),name:t,level:0}}))}};this.updateJourneyProgress(t)},n.updateJourneyProgress=function(e){var t=this.game.player.getJourneyProgress(),n=(0,a.Z)({},t,e);this.currentJourneyProgress=n,this.game.player.updateJourneyProgress(n)},t}(Phaser.Plugins.BasePlugin),ZZ=function(e){function t(t){var n;return(n=e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\nuniform vec3 blendColor;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main()\n{\n    vec4 texture;\n    vec3 blendRGB = blendColor;\n\n    %forloop%\n    \n    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);\n    gl_FragColor = texture;\n    vec3 baseRGB = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n\n    vec3 baseHSV = rgb2hsv(baseRGB);\n\n    vec3 resultHSV = vec3(blendColor.xy, baseHSV.z * 1.35);\n    vec3 resultRGB = hsv2rgb(resultHSV);\n\n    gl_FragColor = vec4(resultRGB, gl_FragColor.a);\n}",uniforms:["uProjectionMatrix","uMainSampler","gray","blendColor"]})||this).gray=void 0,n.gray=1,n}return(0,s.Z)(t,e),t.prototype.onPreRender=function(){this.set1f("gray",this.gray),this.set3f("blendColor",19/360,.45,.6471)},t}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline),FZ=ZZ,UZ=["Enable"],WZ=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var o=t.prototype;return o.boot=function(){var t=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),t.next=3,this.requestFullscreenAsync();case 3:return this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=8,this.addDevPlugins();case 8:return t.next=10,this.initAdsAsync();case 10:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.initProfilerPlugin(),this.initAdaptivePerformance(),this.initWeeklyTournament(),this.initBoxingDuel(),this.initOffshoreRace();case 27:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.requestFullscreenAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.RequestFullScreenBeforeStart){e.next=7;break}if(!GameCore.Utils.Device.isDesktop()){e.next=3;break}return e.abrupt("return");case 3:return t=document.getElementById("app"),e.next=6,new Promise((function(e){document.addEventListener("click",(function t(){document.removeEventListener("click",t),e(void 0)}))}));case 6:t&&t.requestFullscreen();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o.start=function(){e.prototype.start.call(this)},o.addExtraGameObjectMethods=function(){var e=new y(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetDefaultWorldSize(),e.addSetScaleByWorld(),e.customGameObject(),e.customSpineGameObject(),e.addCustomNineSlice(),e.customTween(),e.customTimeline(),e.customBitmapText()},o.addExtraFBInstantFunctions=function(){var e=new h.Z(this.facebook);this.facebook.getLocale=e.getLocale,this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,e.injectTournament(),this.facebook.progressLoading=new p(this)},o.addPlugins=function(){this.plugins.install("Storage",$s,!0,"storage"),this.plugins.install("Rollbar",Zr,!0,"rollbar"),this.plugins.install("AdsManager",B,!0,"ads"),this.plugins.install("AuthManager",ee,!0,"auth"),this.plugins.install("AudioManager",W,!0,"audio"),this.plugins.install("WorldManager",Mo,!0,"world"),this.plugins.install("PlayerManager",mr,!0,"player"),this.plugins.install("ProfileManager",Pr,!0,"profile"),this.plugins.install("LanguageManager",Ko,!0,"lang"),this.plugins.install("AnalyticsManager",M,!0,"analytics"),this.plugins.install("AdaptivePerformance",pa,!0,"performance"),this.plugins.install("LevelManager",AZ,!0,"level"),this.plugins.install("ThemeManager",po,!0,"theme"),this.plugins.install("VisibilityChangeHandler",vo,!0,"visibility"),this.plugins.install("LifeManager",SZ,!0,"life"),this.plugins.install("JourneyManager",GZ,!0,"journey"),this.plugins.install("VibrationManager",TZ,!0,"vibration"),this.plugins.install("LeaderboardManager",IZ,!0,"leaderboard"),this.plugins.install("ThemeHandler",mo,!0,"themeHandler"),this.plugins.install("WeeklyTournamentManager",Io,!0,"weeklyTournament"),this.plugins.install("BoxingDuel",Gi,!0,"boxingDuel"),this.plugins.install("OffshoreRace",ca,!0,"offshoreRace"),this.plugins.installScenePlugin("textStyler",ao,"textStyler"),this.plugins.installScenePlugin("ScreenManager",jr,"screen"),this.plugins.installScenePlugin("FrameCapture",Ui,"frameCapture"),window.spine&&this.plugins.installScenePlugin("spine.SpinePlugin",window.spine.SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.lang=this.plugins.get("LanguageManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.level=this.plugins.get("LevelManager"),this.vibration=this.plugins.get("VibrationManager"),this.leaderboard=this.plugins.get("LeaderboardManager"),this.weeklyTournament=this.plugins.get("WeeklyTournamentManager"),this.boxingDuel=this.plugins.get("BoxingDuel"),this.offshoreRace=this.plugins.get("OffshoreRace"),this.journey=this.plugins.get("JourneyManager"),this.plugins.install("KawaseBlurFilterPlugin",Uo.Z),this.visibility=this.plugins.get("VisibilityChangeHandler")},o.addDevPlugins=function(){var e=(0,r.Z)(c().mark((function e(){var t,i,a,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(7),n.e(942)]).then(n.bind(n,46));case 4:return t=e.sent.default,e.next=7,Promise.all([n.e(498),n.e(739),n.e(530)]).then(n.bind(n,47));case 7:return i=e.sent.default,e.next=10,n.e(401).then(n.bind(n,48));case 10:return a=e.sent.default,e.next=13,Promise.all([n.e(498),n.e(123)]).then(n.bind(n,49));case 13:return r=e.sent.default,e.next=16,Promise.all([n.e(498),n.e(803)]).then(n.bind(n,50));case 16:s=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("Profiler",r,!0,"profiler"),this.plugins.install("ParticleEditor",s,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.profiler=this.plugins.get("Profiler"),this.particleEditor=this.plugins.get("ParticleEditor");case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.addScenes=function(){this.scene.add(oe.C.BOOT_SCENE,Xo,!0),this.scene.add(oe.C.LOAD_SCENE,rZ,!1),this.scene.add(oe.C.GAME_SCENE,bM,!1),this.scene.add(oe.C.GAME_OVER_SCENE,Yh,!1),this.scene.add(oe.C.DASHBOARD_SCENE,Qo,!1),this.scene.add(oe.C.LEADERBOARD_SCENE,yN,!1),this.scene.add(oe.C.RESULT_MATCH_SCENE,vZ,!1),this.scene.add(oe.C.GLOBAL_SCENE,TM.Z,!1)},o.addDevScenes=function(){var e=(0,r.Z)(c().mark((function e(){var t,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(457).then(n.bind(n,51));case 4:return t=e.sent.default,e.next=7,n.e(270).then(n.bind(n,52));case 7:i=e.sent.default,this.scene.add(oe.C.TEST_SCENE,t,!1),this.scene.add(oe.C.ANIMATIONS_SCENE,i,!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.initAdsAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=GameCore.Configs.Ads,e.next=3,this.getAdServiceInstance();case 3:(n=e.sent).setGame(this),i=(0,a.Z)({},t.InterstitialAdOptions),this.ads.configure(n,{enabled:t.Enabled,calculateSafeAreaBottom:t.CalculateSafeAreaBottom,enableRewardVideoResetInterstitial:t.EnableRewardVideoResetInterstitial,interstitialAdOptions:i,rewardAdOptions:t.RewardAdOptions,bannerAdOptions:t.BannerAdOptions});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getAdServiceInstance=function(){var e=(0,r.Z)(c().mark((function e(){var t,i,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,i=t.AdService,!t.Mockup.Enable){e.next=6;break}return e.next=4,n.e(131).then(n.bind(n,53));case 4:return a=e.sent.default,e.abrupt("return",a);case 6:if("google"!==i){e.next=19;break}return e.prev=7,e.next=10,this.initGoogleAdInstanceAsync();case 10:if(null===(r=e.sent)){e.next=13;break}return e.abrupt("return",r);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(7),e.abrupt("return",OZ.default);case 19:return e.abrupt("return",OZ.default);case 20:case"end":return e.stop()}}),e,this,[[7,15]])})));return function(){return e.apply(this,arguments)}}(),o.initGoogleAdInstanceAsync=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,i,a,r,s,o,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loaded"!==RZ.default.initStatus){e.next=2;break}return e.abrupt("return",RZ.default);case 2:if(t=GameCore.Configs.Ads.AdServiceConfigs.Google){e.next=6;break}return e.abrupt("return",null);case 6:return n=t.DataAdClient,i=t.DataAdChannel,a=t.DataAdBreakTest,r=t.DataAdFrequencyHint,s=t.DataAdHost,o=t.MaxScriptLoadRetryCount,h={dataAdClient:n,dataAdChannel:i,dataAdBreakTest:a,dataAdFrequencyHint:r,dataAdHost:s,maxScriptLoadRetryCount:o},e.prev=8,RZ.default.setGame(this),e.next=12,RZ.default.initGoogleAdsAsync(h);case 12:return e.abrupt("return",RZ.default);case 15:return e.prev=15,e.t0=e.catch(8),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(){return e.apply(this,arguments)}}(),o.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,a=e.PortraitHeight,r=e.LandscapeRatio,s=e.LandscapeWidth,o=e.LandscapeHeight,c=t,h=e.DisableLandscape,u=e.FullSizeOnLandscape,l=n,d=i,p=a,f=r,m=s,g=o;this.world.configure({autoResize:c,portraitRatio:l,portraitWidth:d,portraitHeight:p,landscapeRatio:f,landscapeWidth:m,landscapeHeight:g,disableLandscape:h,fullSizeOnLandscape:u}),this.world.resize(e.ForcePixelRatio)},o.initStorage=function(){var e=new Fo(this);this.storage.setInitiator(e)},o.initLanguage=function(){var e=this.facebook.getLocale();this.lang.configure({locale:e})},o.initVisibilityChangeHandler=function(){this.visibility.configure()},o.initUtils=function(){this.handlePauseAudio(),this.addPipelines(),this.removeUnusedPipelines()},o.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},o.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},o.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},o.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},o.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler.configure())},o.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,i.Z)(e,UZ);if(t){var r=this.world.getPixelRatio();this.performance.configure((0,a.Z)({pixelRatio:r},n)),this.performance.active()}},o.initCanvasRecorderPlugin=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.CanvasRecorder;if(t.Enable){var n=t.Options,i=n.Type,a=n.Quality,s=n.RecordFps,o=n.SyncFps;this.canvasRecorder.configure({type:i,quality:a,syncFps:o,recordFps:s});var h=document.querySelector("canvas");if(h){this.canvasRecorder.setCanvas(h);var u=this.canvasRecorder.getOptions(),l=this.canvasRecorder.waitNextFrame;this.canvasRecorder.waitNextFrame=(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.syncFps){t.next=5;break}return e.loop.sleep(),t.abrupt("return",new Promise((function(t){e.events.once(Phaser.Core.Events.POST_RENDER,t),e.loop.lastTime=1e3/u.recordFps,e.loop.step()})));case 5:return e.loop.wake(),t.abrupt("return",l.call(e.canvasRecorder));case 7:case"end":return t.stop()}}),t)})))}}}},o.initRollbar=function(){GameCore.Configs.Rollbar.Enable&&this.rollbar.setup()},o.initWeeklyTournament=function(){this.weeklyTournament.configure()},o.initOffshoreRace=function(){this.offshoreRace.configure()},o.initBoxingDuel=function(){this.boxingDuel.configure()},o.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.resumeMusic(),e.audio.resumeAllSounds();try{GameCore.Utils.Device.isIOS()&&e.globalScene.input.once(Phaser.Input.Events.POINTER_DOWN,(0,r.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.sound.context.suspend();case 3:return t.next=5,e.sound.context.resume();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))))}catch(t){}})),this.visibility.addEventHidden((function(){e.audio.pauseAllMusics(),e.audio.pauseAllSounds()}))},o.addPipelines=function(){var e=this.renderer;e instanceof Phaser.Renderer.WebGL.WebGLRenderer&&(e.pipelines.add("Grayscale",new DZ(this)),e.pipelines.add("LockEffect",new FZ(this)))},o.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},t}(Phaser.Game),HZ=WZ},,,,,,,,,,,,,,,,function(e,t,n){n.r(t);var i=n(1),a=n(7),r=n(0),s=n.n(r),o=n(60),c=n(78),h=GameCore.Utils.Object,u=GameCore.Ads,l=u.Types,d=u.Status,p="msgames",f=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.step=0,i.adNoFillInstances=void 0,i.isHasTwoManyInstances=void 0,i.instanceLoadFailedQueue=void 0,i.isHasTooManyInstancesError=void 0,i.instance=null,i.adNoFillInstances=[],i.isHasTwoManyInstances=!1,i.placementId=n,i.instanceLoadFailedQueue=[],i.isHasTooManyInstancesError=!1,i}(0,a.Z)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.Z)(s().mark((function e(){var t,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===d.IDLE){e.next=2;break}return e.abrupt("return");case 2:return this.step+=1,e.prev=3,this.status=d.LOADING,e.next=7,this.createInstanceByType(this.type);case 7:if(this.instance=e.sent,null!==this.instance){e.next=10;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 10:return e.next=12,this.instance.loadAsync();case 12:this.status=d.FILLED,t=this.getSceneName(),this.type===l.PRE_ROLL&&self.game.analytics.loadPreRollAd(t,p),this.type===l.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(t,p),this.type===l.REWARDED&&self.game.analytics.loadRewardedVideoAd(t,p),e.next=26;break;case 19:throw e.prev=19,e.t0=e.catch(3),this.status=d.IDLE,this.instance&&this.instanceLoadFailedQueue.push(this.instance),this.instance=null,this.isAdTypeValid(this.type)&&(n=this.getSceneName(),i={type:this.type,placement:n,adService:p},self.game.analytics.loadAdFail(i)),e.t0;case 26:case"end":return e.stop()}}),e,this,[[3,19]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.Z)(s().mark((function e(){var t,n,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,null,e.prev=2,this.status===d.FILLED){e.next=5;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 5:if(this.status=d.SHOWING,null!==this.instance){e.next=8;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 8:return this.isHasTooManyInstancesError&&self.game.analytics.event(o._.MISSING_AD_SHOW,{ad_type:this.type}),e.next=11,this.instance.showAsync();case 11:t=!0,this.status=d.IDLE,this.instance=null,e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(2),e.t0 instanceof Object&&h.hasOwn(e.t0,"code")?("ADS_NOT_LOADED"===e.t0.code?this.status=d.FILLED:(this.status=d.IDLE,this.instance=null),"USER_INPUT"===e.t0.code&&(this.status=d.IDLE,this.instance=null,t=!0)):(this.status=d.IDLE,this.instance=null),e.t0,e.t0;case 21:return e.prev=21,window.focus(),n=this.getSceneName(),t?(this.type===l.PRE_ROLL&&self.game.analytics.showPreRollAd(n,p),this.type===l.INTERSTITIAL&&self.game.analytics.showInterstitialAd(n,p),this.type===l.REWARDED&&self.game.analytics.showRewardedVideoAd(n,p)):this.isAdTypeValid(this.type)&&(i=this.getSceneName(),a={type:this.type,placement:i,adService:p},self.game.analytics.showAdFail(a)),e.finish(21);case 26:case"end":return e.stop()}}),e,this,[[2,16,21,26]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.prev=1,e.t0=t,e.next=e.t0===l.REWARDED?5:e.t0===l.INTERSTITIAL||e.t0===l.PRE_ROLL?8:11;break;case 5:return e.next=7,n.getRewardedVideoAsync(this.placementId);case 7:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,n.getInterstitialAdAsync(this.placementId);case 11:case 20:return e.abrupt("return",null);case 12:e.next=21;break;case 14:if(e.prev=14,e.t1=e.catch(1),!(e.t1 instanceof Object&&h.hasOwn(e.t1,"code"))){e.next=20;break}if("ADS_TOO_MANY_INSTANCES"!==e.t1.code){e.next=20;break}return this.isHasTooManyInstancesError=!0,e.abrupt("return",this.instanceLoadFailedQueue.shift()||null);case 21:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof c.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},n.isAdTypeValid=function(e){return Object.values(l).includes(e)},t}(GameCore.Ads.AdInstance);t.default=f},function(e,t,n){n.r(t);var i,a=n(1),r=n(24),s=n(23),o=n(7),c=n(0),h=n.n(c),u=n(60),l=n(78),d=GameCore,p=d.Utils.Object,f=d.Ads,m=f.Types,g=f.Status,v="not-loaded",y="loading",E="loaded",C="google",A=function(e){function t(n,i){var a;return(a=e.call(this,n)||this).instance=void 0,a.instance=null,a.status=g.IDLE,window.setInterstitialPlacementType=t.setInterstitialPlacementType,window.setRewardedPlacementType=t.setRewardedPlacementType,window.setPreRollPlacementType=t.setPreRollPlacementType,t.childAdInstances.push((0,s.Z)(a)),t.isPreloadConfigReady&&(a.status=g.FILLED),a}(0,o.Z)(t,e),t.initGoogleAdsAsync=function(){var e=(0,a.Z)(h().mark((function e(n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loaded"!==t.initStatus){e.next=3;break}return e.abrupt("return");case 3:t._initStatus=y,t.adsByGoogleConfig=n,t.loadScriptElementAsync(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.configGoogleAdsOnInit=function(){var e=(0,a.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.adsbygoogle=window.adsbygoogle||[],window.adBreak=function(e){adsbygoogle.push(e)},window.adConfig=function(e){adsbygoogle.push(e)},t._initStatus=E,t.runPreloadAdConfig();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.runPreloadAdConfig=function(){var e=(0,a.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preloadPromise=new Promise((function(e,n){window.adConfig({preloadAdBreaks:"on",onReady:function(){t.isPreloadConfigReady=!0,t.handlePostPreloadAdComplete(),e()}}),setTimeout((function(){t.isPreloadConfigReady||n(new Error("Failed to preload ad config in time."))}),1e4)})),e.abrupt("return",t.preloadPromise);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.loadScriptElementAsync=function(e){return new Promise((function(n,i){!function a(r){var s=e.maxScriptLoadRetryCount,o=document.createElement("script");try{t.assignAdsByGoogleScriptProperties(o,e)}catch(h){t._initStatus=v,i(new Error("Invalid adConfig."))}if(o.onload=function(){t.configGoogleAdsOnInit(),n(!0)},o.onerror=function(){r<s?setTimeout((function(){a(r+1)}),12e4):(t._initStatus=v,i(new Error("Failed to load Google Ads script.")))},document.head.appendChild(o),!!!document.getElementById("adsByGoogleFunctionScript")){var c=document.createElement("script");c.text="window.adsbygoogle = window.adsbygoogle || []; var adBreak = adConfig = function(o) {adsbygoogle.push(o);}",c.id="adsByGoogleFunctionScript",document.head.appendChild(c)}}(0)}))},t.assignAdsByGoogleScriptProperties=function(e,t){var n=t.dataAdClient,i=t.dataAdHost,a=t.dataAdChannel,r=t.dataAdBreakTest,s=t.dataAdFrequencyHint;if(!n&&!i)throw new Error("dataAdClient or dataAdHost is required.");e.async=!0,e.setAttribute("data-ad-frequency-hint",s+"s"),n&&e.setAttribute("data-ad-client",n),a&&e.setAttribute("data-ad-channel",a),i&&e.setAttribute("data-ad-host",i),r&&e.setAttribute("data-adbreak-test","on");var o="";if(n||i){o="?";var c=[];n&&c.push("client="+n),i&&c.push("host="+i),o+=c.join("&")}e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"+o,e.crossOrigin="anonymous"};var n=t.prototype;return n.makeAdInstance=function(){var e=this;return{getPlacementID:function(){return""},loadAsync:function(){return e.preloadAdPlacement()},showAsync:function(){return e.createAdPlacement()}}},n.preloadAdPlacement=function(){return t._initStatus!==E?Promise.reject(new Error("Google Ads not initiated.")):t.isPreloadConfigReady?Promise.resolve():t.preloadPromise?t.preloadPromise:t.runPreloadAdConfig()},n.createAdPlacement=function(){switch(this.type){case m.PRE_ROLL:return this.createAdPlacementPreroll();case m.REWARDED:return this.createAdPlacementRewarded();case m.INTERSTITIAL:return this.createAdPlacementInterstitial();default:return Promise.reject(new GameCore.Ads.AdError("UNSUPPORTED_AD_TYPE","Unsupported."))}},n.createAdPlacementPreroll=function(){return new Promise((function(e,n){window.adBreak({type:t.preRollPlacementType,name:"prerollAd",adBreakDone:function(t){switch(t.breakStatus){case"dismissed":case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},n.createAdPlacementInterstitial=function(){return new Promise((function(e,n){window.adBreak({type:t.interstitialPlacementType,name:"interstitialAd",beforeAd:function(){self.game.ads.hideBannerAdAsync()},adBreakDone:function(t){switch(self.game.ads.showBannerAdAsync(),t.breakStatus){case"dismissed":case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},n.createAdPlacementRewarded=function(){return new Promise((function(e,n){window.adBreak({type:t.rewardedPlacementType,name:"rewardedAd",beforeReward:function(e){self.game.ads.hideBannerAdAsync(),e()},adViewed:function(){},adDismissed:function(){},adBreakDone:function(t){switch(self.game.ads.showBannerAdAsync(),t.breakStatus){case"dismissed":return void n(new GameCore.Ads.AdError("USER_INPUT","User dismissed."));case"viewed":return void e();default:return void n(new GameCore.Ads.AdError(t.breakStatus,t.breakType))}}})}))},t.setGame=function(e){self.game=e},n.getStatus=function(){return this.status},n.loadAsync=function(){var e=(0,a.Z)(h().mark((function e(){var n,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.isPreloadConfigReady&&null==this.instance){e.next=3;break}return e.abrupt("return");case 3:if(this.instance=this.makeAdInstance(),null!==this.instance){e.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return e.next=8,this.instance.loadAsync();case 8:n=this.getSceneName(),this.type===m.PRE_ROLL&&self.game.analytics.loadPreRollAd(n,C),this.type===m.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(n,C),this.type===m.REWARDED&&self.game.analytics.loadRewardedVideoAd(n,C),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),this.isAdTypeValid(this.type)&&(i=this.getSceneName(),a={type:this.type,placement:i,adService:C},self.game.analytics.loadAdFail(a)),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,a.Z)(h().mark((function e(){var t,n,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,e.prev=1,this.status===g.FILLED){e.next=4;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 4:if(this.status=g.SHOWING,null!==this.instance){e.next=8;break}return e.next=8,this.loadAsync();case 8:if(null!==this.instance){e.next=10;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 10:return e.next=12,this.instance.showAsync();case 12:t=!0,this.handlePostShowAdStatus(),this.instance=null,e.next=27;break;case 17:if(e.prev=17,e.t0=e.catch(1),!(e.t0 instanceof Object&&p.hasOwn(e.t0,"code"))){e.next=24;break}if("noAdPreloaded"!==e.t0.code){e.next=22;break}return e.abrupt("return");case 22:"USER_INPUT"===e.t0.code&&(t=!0),"frequencyCapped"===e.t0.code&&self.game.analytics.event(u._.MISSING_AD_SHOW,{ad_type:this.type});case 24:throw this.handlePostShowAdStatus(),this.instance=null,e.t0;case 27:return e.prev=27,window.focus(),n=this.getSceneName(),t?(this.type===m.PRE_ROLL&&self.game.analytics.showPreRollAd(n,C),this.type===m.INTERSTITIAL&&self.game.analytics.showInterstitialAd(n,C),this.type===m.REWARDED&&self.game.analytics.showRewardedVideoAd(n,C)):this.isAdTypeValid(this.type)&&(i=this.getSceneName(),a={type:this.type,placement:i,adService:C},self.game.analytics.showAdFail(a)),e.finish(27);case 32:case"end":return e.stop()}}),e,this,[[1,17,27,32]])})));return function(){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof l.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},n.isAdTypeValid=function(e){return Object.values(m).includes(e)},n.handlePostShowAdStatus=function(){t.isPreloadConfigReady?this.status=g.FILLED:this.status=g.IDLE},t.handlePostPreloadAdComplete=function(){t.childAdInstances.forEach((function(e){e.status=g.FILLED}))},(0,r.Z)(t,null,[{key:"initStatus",get:function(){return t._initStatus}}]),t}(GameCore.Ads.AdInstance);i=A,A.childAdInstances=[],A._initStatus=v,A.isPreloadConfigReady=!1,A.adsByGoogleConfig=void 0,A.preloadPromise=void 0,A.preRollPlacementType="preroll",A.interstitialPlacementType="next",A.rewardedPlacementType="reward",A.setInterstitialPlacementType=function(e){i.interstitialPlacementType=e},A.setRewardedPlacementType=function(e){i.rewardedPlacementType=e},A.setPreRollPlacementType=function(e){i.preRollPlacementType=e},t.default=A},,,,,,,,,,,,,function(e,t,n){n.d(t,{J:function(){return P},Z:function(){return I}});var i=n(1),a=n(0),r=n.n(a),s=n(60),o=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-add-shortcut");null==n||n.remove(),e()}},c=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},h=function(){var e=(0,i.Z)(r().mark((function e(t,n){var i,a,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=c('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Add shortcut for this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to add a shortcut.</p>\n        </div>'),a=c('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">No</button>'),s=c('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Yes</button>'),i&&a&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-add-shortcut",i.appendChild(a),i.appendChild(s),document.body.appendChild(i),a.addEventListener("click",o(n)),s.addEventListener("click",o(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canCreateShortcutAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.createShortcutAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){h(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),l=u,d=function(e){return function(t){t.preventDefault();var n=document.getElementById("popup-subscribe-bots");null==n||n.remove(),e()}},p=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},f=function(){var e=(0,i.Z)(r().mark((function e(t,n){var i,a,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=p('<div style="height: 50vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;">\n            <p style="color:white;font-size:40px;text-align:center">Turn on messages from this game</p>\n            <p style="color:white;font-size:20px;text-align:center">This game wants to send messages, announcements and more.</p>\n        </div>'),a=p('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Not Now</button>'),s=p('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Turn On</button>'),i&&a&&s||n({code:"CREATE_POPUP_ERROR",message:"Show popup failed"}),i.id="popup-subscribe-bots",i.appendChild(a),i.appendChild(s),document.body.appendChild(i),a.addEventListener("click",d(n)),s.addEventListener("click",d(t));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){function e(){this.isFirstCall=!0}var t=e.prototype;return t.canSubscribeBotAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFirstCall){e.next=3;break}return this.isFirstCall=!1,e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.subscribeBotAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){f(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),g=m,v=n(62),y=n(59),E=n(7),C=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="TournamentNotFound",i.message=t||"A Tournament with current context was not found",i.payload=n,i.code="TOURNAMENT_NOT_FOUND",i}return(0,E.Z)(t,e),t}((0,n(61).Z)(Error)),A=n(64),w=GameCore.Configs,S=w.Notification,b=w.AddShortcut,T=w.SubscribeBot,x=S.GameTitle,P=(S.GameImage,function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}()),k=function(){function e(e){var t=this;this.facebook=void 0,this.supportedAPIs=[],this.mockSubscribeBot=void 0,this.mockAddShortcut=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.isCanPlayerMatch=null,this.isCanSubscribeBot=null,this.isCanCreateShortcut=null,this.attemptToAddShortcut=(0,i.Z)(r().mark((function e(){var n,i,a,o,c,h;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanCreateShortcut&&(b.UseMock?t.isCanCreateShortcut=!0:t.isCanCreateShortcut=t.isSupportedAPI("canCreateShortcutAsync")),t.isCanCreateShortcut){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:if(n=e.t0,!(i=n.lastCallCreateShortcut||0)||!(0,y.Gm)(+i)){e.next=15;break}return e.abrupt("return",!1);case 15:if(!b.UseMock){e.next=21;break}return e.next=18,t.mockAddShortcut.canCreateShortcutAsync();case 18:e.t1=e.sent,e.next=24;break;case 21:return e.next=23,GameSDK.canCreateShortcutAsync();case 23:e.t1=e.sent;case 24:if(a=e.t1,o=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:o}),!a){e.next=49;break}return c=s._.SHORTCUT_CREATE,h=s._.SHORTCUT_CREATE_POPUP,t.isCalledCreateShortcut=!0,window.game.analytics.event(h),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!b.UseMock){e.next=39;break}return e.next=37,t.mockAddShortcut.createShortcutAsync();case 37:e.next=41;break;case 39:return e.next=41,FBInstant.createShortcutAsync();case 41:return window.game.analytics.event(c,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(c,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:case"end":return e.stop()}}),e,null,[[2,52],[31,45]])}))),this.attemptToSubscribeBot=(0,i.Z)(r().mark((function e(){var n,i,a,o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,null===t.isCanSubscribeBot&&(T.UseMock?t.isCanSubscribeBot=!0:t.isCanSubscribeBot=t.isSupportedAPI("player.canSubscribeBotAsync")),t.isCanSubscribeBot){e.next=6;break}return e.abrupt("return",!1);case 6:if(!T.UseMock){e.next=12;break}return e.next=9,t.mockSubscribeBot.canSubscribeBotAsync();case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,GameSDK.player.canSubscribeBotAsync();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=49;break}return e.next=19,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 19:if(e.t1=e.sent,e.t1){e.next=22;break}e.t1={};case 22:if(n=e.t1,!(i=n.lastCallSubscribeBot)||!(0,y.Gm)(+i)){e.next=26;break}return e.abrupt("return",!1);case 26:return a=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:a}),o=s._.BOT_SUBSCRIBE,c=s._.BOT_SUBSCRIBE_POPUP,t.isCalledSubscribeBot=!0,window.game.analytics.event(c),e.prev=31,e.next=34,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 34:if(!T.UseMock){e.next=39;break}return e.next=37,t.mockSubscribeBot.subscribeBotAsync();case 37:e.next=41;break;case 39:return e.next=41,GameSDK.player.subscribeBotAsync();case 41:return window.game.analytics.event(o,{success:!0}),e.abrupt("return",!0);case 45:return e.prev=45,e.t2=e.catch(31),window.game.analytics.event(o,{success:!1}),e.abrupt("return",!1);case 49:return e.abrupt("return",!1);case 52:return e.prev=52,e.t3=e.catch(2),e.abrupt("return",!1);case 55:case"end":return e.stop()}}),e,null,[[2,52],[31,45]])}))),this.matchPlayerAsync=function(){var e=(0,i.Z)(r().mark((function e(n,i,a){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===t.isCanPlayerMatch&&(t.isCanPlayerMatch=t.isSupportedAPI("checkCanPlayerMatchAsync")),t.isCanPlayerMatch){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,GameSDK.matchPlayerAsync(n,i,a);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),this.getTournamentAsync=(0,i.Z)(r().mark((function e(){var n,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.facebook.tournament.getTournamentsAsync();case 2:if(n=e.sent,i=GameSDK.context.getID(),!(a=n.find((function(e){return e.getContextID()===i})))){e.next=7;break}return e.abrupt("return",Promise.resolve(a));case 7:return e.abrupt("return",Promise.reject(new C(null)));case 8:case"end":return e.stop()}}),e)}))),this.requestTournamentAsync=function(){var e=(0,i.Z)(r().mark((function e(n){var i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=GameSDK.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.isSupportedAPI=function(e){return 0===t.supportedAPIs.length&&(t.supportedAPIs=GameSDK.getSupportedAPIs()),t.supportedAPIs.includes(e)},this.facebook=e,this.mockSubscribeBot=new g,this.mockAddShortcut=new l}var t=e.prototype;return t.switchAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return e.next=4,GameSDK.context.switchAsync(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.chooseAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.Z)(r().mark((function e(t){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var a=e.getName();if(a){var r=e.getPhoto();i.push(new v.Z(n,a,r).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.Z)(r().mark((function e(t){var n,i,a,s,o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,a=t.template,s=t.cta,o=t.text,c={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:o,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,GameSDK.updateAsync(c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return GameSDK.context.getID()},t.setLoadingProgress=function(e){GameSDK.setLoadingProgress(e)},t.getLocale=function(){return GameSDK.getLocale()||"en"},t.injectTournament=function(){var e=(0,i.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=8;break}return e.next=4,n.e(545).then(n.bind(n,54));case 4:t=e.sent.default,this.facebook.tournament=new t,e.next=9;break;case 8:this.facebook.tournament=new P;case 9:this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.Z)(r().mark((function e(t){var n,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.message,i=t.delayTime,a=t.type,e.next=5,FBInstant.scheduleNotificationAsync({title:x,minDelayInSeconds:i,description:n,type:null!=a?a:A.Z.GENERIC_NOTIFICATION});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}(),I=k},function(e,t,n){n.d(t,{F0:function(){return r},Gm:function(){return a},qZ:function(){return i},s:function(){return s}});var i=function(e){return new Promise((function(t){return setTimeout(t,e)}))},a=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},r=function(e,t){void 0===t&&(t=!0);var n=new Date(e).toISOString();return t?n.slice(11,-5):n.slice(14,-5)},s=function(e){var t=Date.now(),n=Math.max(1e3*e-t,0);return{remainingTimeInDays:Math.round(n/864e5),remainingTimeInMs:n}}},function(e,t,n){n.d(t,{_:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_CONTINUE:"level_continue",LEVEL_END:"level_end",LEVEL_GIVE_UP:"level_give_up",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",MISSING_AD_SHOW:"missing_ad_show",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",THEME_CHANGED:"theme_changed",LUCKY_REWARD:"luck_reward",FOLLOW_PAGE:"follow_page",FOLLOW_PAGE_FAILED:"follow_page_failed",GROUP_JOIN:"group_join",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",TOURNAMENT_START:"tournament_start",TOURNAMENT_END:"tournament_end",TOURNAMENT_REFUSE:"tournament_refuse",TOURNAMENT_REJOIN:"tournament_rejoin",TOURNAMENT_JOIN:"tournament_join",DUEL_START:"duel_start",DUEL_END:"duel_end",DUEL_GET_REWARD:"duel_get_reward",RACE_START:"race_start",RACE_END:"race_end",LOAD_ASSET_START:"load_assets_start",LOAD_ASSET_COMPLETED:"load_assets_completed",DECORATION_UPGRADED:"decoration_upgraded",PAGE_VIEW:"page_view",ECONOMY_TRANSACTION:"economy_transaction",ECONOMY_TRACKING:"economy_tracking",VIEW_ITEM_LIST:"view_item_list",SELECT_ITEM:"select_item",VIEW_ITEM:"view_item",BEGIN_CHECKOUT:"begin_checkout",PURCHASE:"purchase",PURCHASE_CANCEL:"purchase_cancel"}},,function(e,t,n){var i=n(63),a=function(){function e(e,t,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.Z.AVATAR.FILE,this.locale=a||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},e}();t.Z=a},function(e,t){var n={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+GameCore.ImageScale+"x/CornField_final.jpg",CONFIG:{}},OVERLAY:{KEY:"overlay",FILE:"./assets/images/others/overlay.png",CONFIG:{}},JOURNEY_BACKGROUND:{KEY:"journey-background",FILE:"./assets/images/2x/journey-background.jpg",CONFIG:{}}};t.Z=n},function(e,t){t.Z={GENERIC_NOTIFICATION:0,NEW_USER_NOTIFICATION:1,MONDAY_NOTIFICATION:2,TUESDAY_NOTIFICATION:3,WEDNESDAY_NOTIFICATION:4,THURSDAY_NOTIFICATION:5,FRIDAY_NOTIFICATION:6,SATURDAY_NOTIFICATION:7,SUNDAY_NOTIFICATION:8}},,,,function(e,t,n){n.d(t,{DW:function(){return c},EH:function(){return r},fJ:function(){return a},kL:function(){return i},qj:function(){return s},rh:function(){return o}});var i="CONTEXT_RECEIVED",a="CONTEXT_PROCESSED",r="CONTEXT_GAME_MODE_DETECTED",s="MESSAGES_SENT_UPDATE",o="MESSAGES_SENT_REMOVE",c="SCENE_KEY_UPDATE"},,function(e,t){t.Z={RESIZE:"resize",CHANGE_LAYOUT:"change-layout"}},function(e,t,n){n.d(t,{Ks:function(){return a},MR:function(){return r},o4:function(){return i}});var i={PAUSE_SCREEN:"PAUSE_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",REWARD_SCREEN:"REWARD_SCREEN",RESCUE_SCREEN:"RESCUE_SCREEN",DASHBOARD_SCREEN:"DASHBOARD_SCREEN",DASHBOARD_SETTINGS_SCREEN:"DASHBOARD_SETTINGS_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",BEST_SCORE_SCREEN:"BEST_SCORE_SCREEN",DAILY_REWARDS_SCREEN:"DAILY_REWARDS_SCREEN",DAILY_MISSIONS_SCREEN:"DAILY_MISSIONS_SCREEN",LUCKY_REWARD_SCREEN:"LUCKY_REWARD_SCREEN",NO_MORE_MOVES_SCREEN:"NO_MORE_MOVES_SCREEN",PLAY_SCREEN:"PLAY_SCREEN",GAME_STATS_SCREEN:"GAME_STATS_SCREEN",THEME_SCREEN:"THEME_SCREEN",HOW_TO_PLAY_SCREEN:"HOW_TO_PLAY_SCREEN",AWESOME_SCREEN:"AWESOME_SCREEN",NOTIFICATION_SCREEN:"NOTIFICATION_SCREEN",TOURNAMENTS_SCREEN:"TOURNAMENTS_SCREEN",PLAY_WITH_FRIEND_GAME_OVER_SCREEN:"PLAY_WITH_FRIEND_GAME_OVER_SCREEN",TOURNAMENTS_RESULT_SCREEN:"TOURNAMENT_RESULT_SCREEN",BUYING_BOOSTER_SCREEN:"BUYING_BOOSTER_SCREEN",GET_COINS_SCREEN:"GET_COINS_SCREEN",GET_MORE_STARS_SCREEN:"GET_MORE_STARS_SCREEN",OUT_OF_HEARTS_SCREEN:"OUT_OF_HEARTS_SCREEN",GUIDE_SCREEN:"GUIDE_SCREEN",NOTIFY_BOMB_SCREEN:"NOTIFY_BOMB_SCREEN",EXIT_GAME_SCREEN:"EXIT_GAME_SCREEN",LEVEL_COMPLETE_SCREEN:"LEVEL_COMPLETE_SCREEN",NEXT_JOURNEY_SCREEN:"NEXT_JOURNEY_SCREEN",JOURNEY_SCREEN:"JOURNEY_SCREEN",JOURNEY_COIN_SCREEN:"JOURNEY_COIN_SCREEN",CHALLENGE_WELCOME_SCREEN:"CHALLENGE_WELCOME_SCREEN",CHALLENGE_RESULT_SCREEN:"CHALLENGE_RESULT_SCREEN",CHALLENGE_REMINDER_SCREEN:"CHALLENGE_REMINDER_SCREEN",LAB_SCREEN:"LAB_SCREEN",WELCOME_BACK_SCREEN:"WELCOME_BACK_SCREEN",OFFSHORE_RACE:{INTRO_SCREEN:"OFFSHORE_RACE_INTRO_SCREEN",INVITATION_SCREEN:"OFFSHORE_RACE_INVITATION_SCREEN",MAIN_SCREEN:"OFFSHORE_RACE_MAIN_SCREEN",REWARD_SCREEN:"OFFSHORE_RACE_REWARD_SCREEN"},WEEKLY_TOURNAMENT:{INTRO_SCREEN:"WEEKLY_TOURNAMENT_INTRO_SCREEN",INVITATION_SCREEN:"WEEKLY_TOURNAMENT_INVITATION_SCREEN",MAIN_SCREEN:"WEEKLY_TOURNAMENT_MAIN_SCREEN",REWARD_SCREEN:"WEEKLY_TOURNAMENT_REWARD_SCREEN",FAILED_SCREEN:"WEEKLY_TOURNAMENT_FAILED_SCREEN"},BOXING_DUEL:{INTRO_SCREEN:"BOXING_DUEL_INTRO_SCREEN",MAIN_SCREEN:"BOXING_DUEL_MAIN_SCREEN",REWARD_SCREEN:"BOXING_DUEL_REWARD_SCREEN",VERSUS_SCREEN:"BOXING_DUEL_VERSUS_SCREEN"}},a={SCREEN:200,POPUP:300,PRIORITY:999},r={COLOR:0,ALPHA:{COMMON:.6,GUIDE:.05},MULTIPLY_ALPHA:.67}},function(e,t,n){n.d(t,{C:function(){return i},K:function(){return a}});var i={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",RESULT_MATCH_SCENE:"RESULT_MATCH_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},a={SWITCH:Symbol("SWITCH")}},function(e,t,n){var i=n(5),a=GameCore.ImageScale,r={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{TIP:"tip",HAND:"hand",BLANK:"blank",AVATAR_CAT:"avatar-cat",POPUP_TALK:"talk-popup",FIRST_MOVE:"first-move",CURRENT_SCORE:"current-score",TARGET_SCORE:"target-score",HAMMER_ITEM:"hammer-item",PAINT_ITEM:"paint-item",SHUFFLE_ITEM:"shuffle-item",COLORFUL_GEM_1:"colorful-gem-1",COLORFUL_GEM_2:"colorful-gem-2"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",TEXTURE_32BIT:"./assets/textures/"+a+"x/default-resources-32bit.png",JSON:"./assets/textures/"+a+"x/default-resources.json",FRAME:{BLANK:"blank",BUTTON:{GREEN_40:"",GREEN_50:"",GREEN_60:"",BLUE_40:"",BLUE_50:"",RED_40:""},COMMON:{BTN_CLOSE:"common/new_btn_close",POPUP_BASE:"common/pop-up-base",NEW_POPUP_BASE:"common/new-pop-up-base",POPUP_CONTENT_FULL:"common/pop-up-content-full",TITLE_DECOR:"common/title-decor",IC_BIG_COIN:"",LUCKY_BAR:"",LUCKY_ARROW:""},DAILY_REWARDS:{COIN_1:"daily-rewards/coin-1",COIN_2:"daily-rewards/coin-2",COIN_3:"daily-rewards/coin-3"},EFFECTS:{BONUS_LIGHT:"effects/bonus-light",BONUS_STAR:"effects/bonus-star",GLOW_2:"effects/glow-2",LIGHT_X:"effects/light-x",STAR_1:"effects/star-1",STAR_2:"effects/star-2",SPARK:"effects/spark",LEVEL_COMPLETE:{RAY:"effects/level-complete/ray",GLOW_1:"effects/level-complete/glow-1",GLOW_2:"effects/level-complete/glow-2",STAR:"effects/level-complete/star"}},EXIT_GAME_SCREEN:{POP_UP_BASE:"exit-game-screen/pop-up-base",BUTTON_CLOSE:"exit-game-screen/\u0445",ICON_GLOVE:"exit-game-screen/icon-glove",ICON_CUP:"exit-game-screen/icon-cup",ICON_BOAT:"exit-game-screen/icon-boat"},NEXT_JOURNEY_SCREEN:{GLOW:"next-journey-screen/glow",PHOTOS:"next-journey-screen/photo",SPARKLE:"next-journey-screen/sparkle",TEXT:"next-journey-screen/text"},GET_MORE_COIN_SCREEN:{ICON_GIFT_AD:"get_more_coin_screen/gift-ad",ILLUSTRATION:"get_more_coin_screen/illustration",NEW_ICON_AD:"get_more_coin_screen/new_ic_ad"},ICONS:{BONUS:"icons/button-bonus",COIN:"icons/coin",STAR:"icons/star"},PLAY_SCREEN:{BOOSTER:{COIN:"play-screen/booster/coin",GOLD_WILD:"play-screen/booster/gold_wild",THREE_SLICE:"play-screen/booster/three-slice",WIND:"play-screen/booster/wind",ICON_PLATE_IN:"play-screen/booster/icon_plate_in"},POPUP_BASE:"play-screen/pop-up-base",NORMAL:{POPUP_BASE:"play-screen/normal/pop-up-base",TITLE_DECOR:"play-screen/normal/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/normal/icon_plate_out",ICON_PLATE_LOCK:"play-screen/normal/icon_plate_lock",LEVEL_PANEL:"play-screen/normal/level-panel"},CLOSE:"play-screen/normal/x",REWARD_CHEST_BG:"play-screen/normal/reward_chest_bg"},HARD:{POPUP_BASE:"play-screen/hard/pop-up-base",TITLE_DECOR:"play-screen/hard/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/hard/icon_plate_out",ICON_PLATE_LOCK:"play-screen/hard/icon_plate_lock",LEVEL_PANEL:"play-screen/hard/level-panel"},CLOSE:"play-screen/hard/x",REWARD_CHEST_BG:"play-screen/hard/reward_chest_bg"},SUPER_HARD:{POPUP_BASE:"play-screen/super-hard/pop-up-base",TITLE_DECOR:"play-screen/super-hard/title-decor",BOOSTER:{ICON_PLATE_OUT:"play-screen/super-hard/icon_plate_out",ICON_PLATE_LOCK:"play-screen/super-hard/icon_plate_lock",LEVEL_PANEL:"play-screen/super-hard/level-panel"},CLOSE:"play-screen/super-hard/x",REWARD_CHEST_BG:"play-screen/super-hard/reward_chest_bg"},ICON_ADD:"play-screen/add",ICON_CHECK_MARK:"play-screen/check-mark",ICON_RED:"play-screen/red",ICON_ORANGE:"play-screen/orange",EFFECTS:{STAR:"play-screen/star",GLOW:"play-screen/glow_2",NEW_REWARD_CHEST:"play-screen/new_reward_chest",NEW_REWARD_CHEST_ADD_1:"play-screen/new_reward_chest_add",NEW_REWARD_CHEST_ADD_2:"play-screen/new_reward_chest_add_2",NEW_TOP_CASE_ADD_1:"play-screen/new_top_case_add_1",NEW_TOP_CASE_ADD_2:"play-screen/new_top_case_add_2",NEW_TOP_CASE_ADD_3:"play-screen/new_top_case_add_3",NEW_TOP_CASE_ADD_4:"play-screen/new_top_case_add_4"}},POPUP_CONTENT:"popup/popup_content",PRELOADER:{LOADING:"preloader/loading",DUAL_RING:"preloader/dual-ring"},REWARDS:{COIN:"rewards/coin",UNDO:"rewards/undo",WILD_CARD:"rewards/wild-card",STORM:"rewards/storm",SLICE:"rewards/slice",PLUS_5_CARDS:"rewards/plus-5-cards",HALF_LEFT:"rewards/half-left",HALF_TOP:"rewards/half-top",HALF_BOTTOM:"rewards/half-bottom"},SETTINGS:{BUTTON:{CHECK:"settings-screen/check-frame"},ICON:{CHECK:"settings-screen/check",FANPAGE:"settings-screen/icon-fanpage",INVITE:"settings-screen/icon-invite",JOIN_GROUP:"settings-screen/icon-joingroup"},MUSIC_ON:"settings-screen/music-on",MUSIC_OFF:"settings-screen/music-off",SOUND_ON:"settings-screen/sound-on",SOUND_OFF:"settings-screen/sound-off",VIBRATE_ON:"settings-screen/vibrate-on",VIBRATE_OFF:"settings-screen/vibrate-off",POPUP_BASE_DESKTOP:"settings-screen/pop-up-base-desktop",POPUP_BASE_MOBILE:"settings-screen/pop-up-base-mobile",GAMEPLAY:{BACKGROUND:"settings-screen/gameplay-settings/background",MUSIC_ON:"settings-screen/gameplay-settings/music-on",MUSIC_OFF:"settings-screen/gameplay-settings/music-off",SOUND_ON:"settings-screen/gameplay-settings/sound-on",SOUND_OFF:"settings-screen/gameplay-settings/sound-off",VIBRATE_ON:"settings-screen/gameplay-settings/vibrate-on",VIBRATE_OFF:"settings-screen/gameplay-settings/vibrate-off",QUIT:"settings-screen/gameplay-settings/quit",SETTINGS_BUTTON:"settings-screen/gameplay-settings/settings",SETTINGS_ICON:"settings-screen/gameplay-settings/settings-icon",BLUE:"settings-screen/gameplay-settings/blue"}},GET_MORE_STARS:{ARROW_ICON:"get-more-stars-screen/arrow-icon",LEVEL_ICON:"get-more-stars-screen/level-icon",STARS_ICON:"get-more-stars-screen/stars-icon"},MISSION:{CLAIM_BUTTON:"",PROGRESS_BAR_BG:"",PROGRESS:"",TASK_PANEL:"",BG_ITEM:"",IC_INVITE_FRIEND:"",IC_PASS_LEVEL:"",IC_CLEAR_CARD:"",IC_USE_WILD_CARD:""},POPUP_TOP_LEFT:"",POPUP_TOP_MID:"",POPUP_TOP_RIGHT:"",POPUP_MID_LEFT:"",POPUP_MID_MID:"",POPUP_MID_RIGHT:"",POPUP_BOTTOM_LEFT:"",POPUP_BOTTOM_MID:"",POPUP_BOTTOM_RIGHT:"",SAD_CAT:"",THE_CAT:"",ICON_DIAMOND:"",BUTTON_BLUE:"",ICON_DAILY:"",ICON_DOT:"",ICON_GIFT:"",ICON_RANK:"",ICON_SETTING:"",BOTTOM_BG:"",BOTTOM_LINE:"",TOP_BG_LONG:"",ICON_PLUS:"",LOGO:"",GEMS:"",BUTTON_BLUE_SHORT:"",BUTTON_GREEN_LONG:"",NINE_SLICE:{POPUP_SHADOW:"",POPUP_BG:"",POPUP_CONTENT:""},ICON_CHECK:"",ICON_REWARD_1:"",ICON_REWARD_2:"",ICON_REWARD_3:"",ICON_REWARD_4:"",ICON_REWARD_5:"",ICON_REWARD_6:"",ICON_REWARD_7:"",DAILY_DAY_BG:"",DAILY_DAY_TITLE_GREY:"",DAILY_BLOCK_BG:"",DAILY_PURPLE_HEADER:"",DAILY_GREEN_HEADER:"",DAILY_ORANGE_HEADER:"",DAILY_RED_HEADER:"",PURPLE_LOCK:"",LOCK:"",AVATAR_FRAME_BLUE:"",AVATAR_BG_BLUE:"",AVATAR_BG_YELLOW:"",AVATAR_FRAME_YELLOW:"",BLOCK_LEADER_YELLOW:"",BLOCK_LEADER_BLUE:"",ICON_FLAG:"",ICON_CUP_GOLD:"",ICON_CUP_SILVER:"",ICON_CUP_BRONZE:"",BUTTON_YELLOW_CIRCLE:"",ICON_FLAT_HOME:"",BUTTON_GREEN_SHORT:"",ICON_FLAT_RANK:"",RIBBON_LONG:"",RIBBON_SMALL:"",BUTTON_CLOSE:"",AVATAR_FRAME_YELLOW_BIG:"",AVATAR_BG_YELLOW_BIG:"",ICON_FLAT_SHARE:"",THREE_SLICE:{HEADER:""},SWITCH_ON:"",SWITCH_OFF:"",TOGGLE_ON_BAR:"",TOGGLE_OFF_BAR:"",LEADERBOARD_BG_DARK:"",LEADERBOARD_BG_LIGHT:"",AVATAR_FRAME_YELLOW_SMALL:"",AVATAR_BG_YELLOW_SMALL:"",ICON_CUP_MINI:"",BUTTON_GREEN_MINOR_MINI:"",BUTTON_GREEN:"",RIBBON_SHORT:"",LEADERBOARD_TAB_ON:"",LEADERBOARD_TAB_OFF:"",AVATAR_FRAME_BLUE_BIG:"",AVATAR_BG_BLUE_BIG:"",ICON_CROWN:"",RIBBON_FULL:"",ICON_RESUME:"",ICON_ADS:"",LOGO_GIFT_ADS:"",BUTTON_BLUE_LONG:"",NO_THANK_TEXT:"",LOGO_GIFT_WHITE:"",LOGO_GIFT:"",ARC_LUCKY_BAR:"",ARC_ARROW:"",HORIZONTAL_LUCKY_BAR:"",HORIZONTAL_ARROW:"",ICON_CUP_COPPER:""}},GAMEPLAY_DEFAULT:{KEY:"gameplay-default",TEXTURE:"./assets/textures/"+a+"x/gameplay-default.png",TEXTURE_32BIT:"./assets/textures/"+a+"x/gameplay-default-32bit.png",JSON:"./assets/textures/"+a+"x/gameplay-default.json",FRAME:{BLANK:"blank",STATS_CROWN:"crown",STATS_STAR:"star",STATS_CUP:"stats_cup",STATS_MEDAL_START:"stats_medal_star",STATS_TIMER:"stats_timer",ARROW:"guide/arrow",ARROW_GREEN:"guide/green_arrow",PARTICLE_LIGHT:"effects/light",PARTICLE_STAR:"effects/star",IC_VIDEO:"icons/video",IC_COIN:"icons/coin-small",IC_PLUS:"icons/ic-plus",IC_INFO:"icons/icon-info",IC_HEART:"icons/ico-heart",IC_CUP:"icons/cup",AVATAR_BORDER:"icons/avatar_border",TUTORIAL:{ARROW_UP:"tutorial/arrow-up",ARROW_DOWN:"tutorial/arrow-down",ARROW_SIDE:"tutorial/arrow-side",TRIPLE_ARROW:"tutorial/triple-arrow",HAND:"tutorial/hand",HIGHLIGHT_CIRCLE:"tutorial/highlight_circle",TEXT_BOX:"tutorial/text_box_guide",BLACK_BG:"tutorial/black_bg"},THREE_SLICES:{COIN_PANEL_BLUE:"three-slices/coin_bar_panel",BAR_LEVEL:"three-slices/bar-level",COIN_PANEL_GRAY:"three-slices/coin-bar"},MENU_STATISTIC:"menu_statistics",CUP:"cup",IC_PLAY:"ic_play",IC_HINT:"ic_hint",IC_UNDO:"ic_undo",IC_SHARE:"ic_share",IC_THEME:"ic_theme",IC_INVITE:"ic_invite",IC_SOUND:"ic_sound",IC_CLOSE:"ic_close_gray",IC_MOVE:"ic_move",IC_STATISTICS:"ic_statistics",IC_NEXT:"ic_next",IC_BOOK:"ic_book",IC_RESTART:"ic_restart",IC_REPLAY:"ic_replay",ADD_SQUARE:"add-square",TIMER:"timer",GOLD:"gold",SILVER:"silver",BRONZE:"bronze",CUSTOM_MEDAL:"custom_medal",TOURNAMENT_TIMER:"tournament_timer",MEDAL_STAR:"medal-star",NO_TOURNAMENT:"no-tournament",IC_BG_OFF:"ic_bg_off",ARROW_SWAP_HORIZONTAL:"arrow-swap-horizontal",AVATAR_CROWN:"avatar_crown",WIN_BANNER:"win_banner",LOSE_BANNER:"lose_banner",BEAM:{AXIS:"beam_axis",LOSE_AXIS:"lose_beam_axis"},FLAG:{LEFT:"flags/left/",RIGHT:"flags/right/"},STRING:{LEFT:"string/left",RIGHT:"string/right"},LIGHTNING:{LEFT:"lightning/left_lightning",MIDDLE:"lightning/middle_lightning",RIGHT:"lightning/right_lightning"},STAR_BAR:{BAR_FILL:"bar-star/bar_fill_0",BAR_FRAME:"bar-star/bar_frame_0",STAR:"bar-star/star_bar_icon",STAR_EMPTY:"bar-star/star_bar_icon_empty"},ARROW_UP:"arrow"}},GAMEPLAY_OBJECTS:{KEY:"gameplay-objects",TEXTURE:"./assets/textures/"+a+"x/gameplay-objects.png",TEXTURE_32BIT:"./assets/textures/"+a+"x/gameplay-objects-32bit.png",JSON:"./assets/textures/"+a+"x/gameplay-objects.json",FRAME:{BLANK:"blank",STATS_CROWN:"crown",STATS_STAR:"star",STATS_CUP:"stats_cup",STATS_MEDAL_START:"stats_medal_star",STATS_TIMER:"stats_timer",BOMB:"bomb/bomb",LINE:"bomb/line",SKULL:"bomb/skull",GLOW_BLACK:"bomb/glow-black",GLOW_RED:"bomb/glow-red",GLOW_RED_FRONT:"bomb/glow-red-front",SPARK_VFX:"bomb/spark_vfx",BTN_PLUS_FIVE_CARDS:"buttons/plus-five-cards",BTN_PLUS_THREE_CARDS:"buttons/plus-three-cards",BTN_SETTINGS:"buttons/btn_settings",BTN_PLUS_COIN:"buttons/button_plus_coin",BTN_END_GAME:"buttons/btn_end_game",BTN_IC_UNDO:"buttons/btn_undo",CARD_BACK:"card/back_backside",GOLD_CARD_BACK:"card/card_back_gold",CARD_BACK_2:"card/back_card_mode_2",CARD_BACK_3:"card/back_card_mode_3",CARD_BACK_4:"card/back_card_mode_4",CHEESE_CARD:"card/cheese-card",MOUSE_CARD:"card/mouse",PLUS_CARD:"card/plus",SQUIRREL_CARD:"card/squirrel",WILD_CARD:"card/wild",MYSTERIOUS_CARD:"card/mysterious",SQUIRREL_BASKET:"card/squirrel-basket",STORM_CARD:"card/card-storm",SLICE_CARD:"card/card-slice",STORM_CARD_BACK:"card/card-storm-back",WILD_CARD_BACK:"card/wild-card-back",BLANK_CARD:"card/card_blank",INCREASE_CARD:"card/arrow-up",BASKET:"squirrel/basket-empty",BASKET_TOP:"squirrel/basket-front",BASKET_ONE_ACORN:"squirrel/basket-1-acorn",BASKET_TWO_ACORN:"squirrel/basket-2-acorns",BASKET_THREE_ACORN:"squirrel/basket-3-acorns",BASKET_FOUR_ACORN:"squirrel/basket-4-acorns",CHESTNUT:"squirrel/acorn",STREAK:{POINT_BLACK:"streak/black",COIN:"streak/coin",POINT_NONE:"streak/color_background",ITEM_BG:"streak/item_background",CARD:"streak/plus_one",POINT_RED:"streak/red",STREAK_FRAME:"streak/streak_frame_",TREASURE:"streak/treasure",WILDCARD:"streak/wild",BAR:"streak/bar"},ROPE:"rope",KNOB:"node",RED_KNOB:"node-red",MAP_PIECE:"map/map-piece",MAP_FILLED_PIECES:"map/map-filled-pieces",MAP_PIECE_NUMBER:"map/tiles/piece",CLOUD_:"cloud-balloon/cloud-",BALLOON:"cloud-balloon/balloon",BALLOON_CLUB:"cloud-balloon/club",BALLOON_DIAMOND:"cloud-balloon/diamond",BALLOON_HEART:"cloud-balloon/heart",BALLOON_SPADE:"cloud-balloon/spade",BALLOON_BLACK:"cloud-balloon/black",BALLOON_BLACK_:"cloud-balloon/black-",BALLOON_RED:"cloud-balloon/red",BALLOON_RED_:"cloud-balloon/red-",BALLOON_NUMBER_:"cloud-balloon/",BLUE_GLOVE:"event-items/blue-glove",CUP:"event-items/cup"}},CARD_BACK:{KEY:"card-back",TEXTURE:"./assets/textures/"+a+"x/card-back.png",JSON:"./assets/textures/"+a+"x/card-back.json"},HOW_TO_PLAY:{KEY:"how-to-play",TEXTURE:"./assets/textures/"+a+"x/how-to-play.jpg",JSON:"./assets/textures/"+a+"x/how-to-play.json"},THEME_PREVIEW:{KEY:"theme-preview",TEXTURE:"./assets/textures/"+a+"x/theme-preview.png",JSON:"./assets/textures/"+a+"x/theme-preview.json"},LOCATION_PREVIEWS:{KEY:"location-previews",TEXTURE:"./assets/textures/"+a+"x/location-previews.png",JSON:"./assets/textures/"+a+"x/location-previews.json"},JOURNEY:{KEY:"journey-resources",TEXTURE:"./assets/textures/"+a+"x/journey-resources.png",TEXTURE_32BIT:"./assets/textures/"+a+"x/journey-resources-32bit.png",JSON:"./assets/textures/"+a+"x/journey-resources.json",FRAME:{BLANK:"blank",BACKGROUND:"bg",TEXT_JOURNEY:"title-journey",CLOSE_BUTTON:"x",MAP_BLOCK:{BACKGROUND:"card",BACKGROUND_SHADOW:"shadow",THUMBNAIL_BACKGROUND:"illustrtation",THUMBNAIL:"frame",PLACE_HOLDER:"place_holder",THUMBNAIL_FOREGROUND:"lock_overlay",LOCKED_THUMBNAIL:"locked",LOCK_CARD:"lock_card",JOURNEY_FRAME:"journey_frame",LOCKED_FRAME:"lock_frame",PROGRESS_BAR:{BORDER:"bar",GREEN_PROGRESS:"full"},ICON_LOCK:{BODY:"lock_body",TOP:"lock_top"},NEW_ICON_LOCK:"lock",ICON_CHECK:"check",CARD_SHINES:["card_add_1","card_add_2","card_add_3","card_add_4","card_add_5","card_add_6"],RIBBON:{BLUE:"ribbon_blue",PINK:"ribbon_pink",RED:"ribbon_red"},LABEL_SHINE:"gradient",LOCK_SHINE:"lock_shine",DECORATION:"decor",LOCK_DECORATION:"lock_decor"},PAGINATION:{CURRENT_PAGE_POSITION_CIRCLE:"on",PAGE_CIRCLE:"off"}}},BOXING_DUEL:{KEY:"boxing-duel-resources",TEXTURE:"./assets/textures/"+a+"x/boxing-duel-resources.png",JSON:"./assets/textures/"+a+"x/boxing-duel-resources.json",FRAME:{BLANK:"blank",BUTTON:{BASE:"button/boxing-duel-base",PLAY:"button/green"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"},EFFECTS:{VFX_HEADER:"effects/vfx-header",VFX_VS:"effects/vfx-vs",VS_LIGHT:"effects/versus-light-blue"},MAIN:{ARROW:"main/arrow",BUTTON:{PLAY:"main/green-button",INFORMATION:"main/information",CLOSE:"main/close"},CUP:"main/cup",GLOVE:{BLUE:"main/blue-glove",RED:"main/red-glove"},HEADER:{MAIN:"main/header",VICTORY:"main/victory-header",DEFEAT:"main/defeat-header"},LOADING:{BASE:"main/loading-base",BLUE:"main/loading-blue",RED:"main/loading-red",CIRCLE:"main/loading-circle"},POPUP:"main/pop-up",BOXING_DUEL_TEXT:"main/text",TIME_PANEL:"main/time-panel",VS:"main/vs",TEXT_REWARD_COIN:"main/text-reward-coin"},REWARD:{FLAGS:"reward/flags",ILLUSTRATOR:{LEFT:"reward/rewards-illustrator-left",RIGHT:"reward/rewards-illustrator-right"}},VERSUS:{FRAME:{BLUE:"versus/blue-frame",RED:"versus/red-frame"}},PLAYER:{EFFECT_LIGHT:"effects/light-blue",VFX_AVATAR:"effects/vfx-avatar-blue",AVATAR:{BACKGROUND:"main/avatar-blue-base",BORDER:"main/avatar-blue",RANDOM:"main/avatar-blue-random",LIGHT_BORDER:"main/avatar-blue-light"},CROWN:"main/crown-left",CROWN_LIGHT:"main/crown-left-light",SCORE_PANEL:"reward/blue-score-panel",SCORE_PANEL_WIN:"reward/blue-score-panel-win"},OPPONENT:{EFFECT_LIGHT:"effects/light-red",VFX_AVATAR:"effects/vfx-avatar-red",AVATAR:{BACKGROUND:"main/avatar-red-base",BORDER:"main/avatar-red",RANDOM:"main/avatar-red-random",LIGHT_BORDER:"main/avatar-red-light"},CROWN:"main/crown-right",CROWN_LIGHT:"main/crown-right-light",SCORE_PANEL:"reward/red-score-panel",SCORE_PANEL_WIN:"reward/red-score-panel-win"}}},WEEKLY_TOURNAMENT:{KEY:"weekly-tournament",TEXTURE:"./assets/textures/"+a+"x/weekly-tournament.png",JSON:"./assets/textures/"+a+"x/weekly-tournament.json",FRAME:{BLANK:"blank",COMMON:{CLOCK:"common/clock",CLOCK_HAND:"common/clock-hand",RED_DOT:"common/red-dot"},FAILED:{POPUP:"failed/popup",HEADER:"failed/header",BUTTON:{BASE:"failed/base-button",GREEN:"failed/green-button"}},INTRODUCTION:{HEADER_BG:"introduction/header",POPUP:"introduction/popup",THUMBNAIL:"introduction/illustration",TIME_PANEL:"introduction/time-panel",CLOSE:"introduction/close",BUTTON:{BASE:"introduction/base-button",GREEN:"introduction/green-button"}},LEADERBOARD:{POPUP:"leaderboard/popup",HEADER:"leaderboard/header",ILLUSTRATION:"leaderboard/illustration",LEADERBOARD_BG:"leaderboard/leader-block-background",CUP_HEADER:"leaderboard/cup-header",CUP_ICON:"leaderboard/cup-icon",COIN_ICON:"leaderboard/coin-icon",PLAYER:{LEADER_BLOCK_BG:"leaderboard/player/player-leader-block",AVATAR:{BACKGROUND:"leaderboard/player/player-avatar-background",OVERLAY:"leaderboard/player/player-avatar-overlay",NO_AVATAR:"leaderboard/player/player-no-avatar"},SCORE_PANEL:"leaderboard/player/player-score-bar"},OPPONENT:{LEADER_BLOCK_BG:"leaderboard/opponent/opponent-leader-block",AVATAR:{BACKGROUND:"leaderboard/opponent/opponent-avatar-background",OVERLAY:"leaderboard/opponent/opponent-avatar-overlay",NO_AVATAR:"leaderboard/opponent/opponent-no-avatar"},SCORE_PANEL:"leaderboard/opponent/opponent-score-bar"},CHEST:{GOLD:"leaderboard/chest_1",SILVER:"leaderboard/chest_2",PURPLE:"leaderboard/chest_3",BRONZE:"leaderboard/chest_4"},BUTTON:{CLAIM:"leaderboard/claim-button",CLOSE:"leaderboard/close",INFORMATION:"leaderboard/information"},STAR_1:"leaderboard/star1",STAR_2:"leaderboard/star2",STAR_3:"leaderboard/star3",TIME_PANEL:"leaderboard/time-panel",TWINKLE:"leaderboard/twinkle"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"}}},RACE:{KEY:"race",TEXTURE:"./assets/textures/"+a+"x/race.png",JSON:"./assets/textures/"+a+"x/race.json",FRAME:{BLANK:"blank",BUTTON:{BASE:"button/race-base",PLAY:"button/green"},INVITATION:{POPUP:"invitation/pop-up",BUTTON:{INFORMATION:"invitation/information",CLOSE:"invitation/close"}},MAIN:{POPUP:"main/pop-up",HEADER_BACKGROUND:"main/header",HEADER_TEXT:"main/text",TIME_PANEL:"main/time-panel",BUTTON:{INFORMATION:"main/information",CLOSE:"main/close"},PLAYER:{AVATAR_BACKGROUND:"main/player-avatar",AVATAR_BORDER:"main/player-avatar-border",BOAT:"main/player-boat"},OPPONENT:{AVATAR_BACKGROUND:"main/opponent-avatar",AVATAR_BORDER:"main/opponent-avatar-border",BOAT:"main/opponent-boat"},CHEST_ON_ISLAND:{GOLD:"main/chest-1",SILVER:"main/chest-2",BRONZE:"main/chest-3"},CHEST_ON_BUTTON:{GOLD:"main/gold-chest",SILVER:"main/silver-chest",BRONZE:"main/bronze-chest"},MEDAL:{GOLD:"main/medal-gold",SILVER:"main/medal-silver",BRONZE:"main/medal-bronze"},ISLAND:"main/island",SPEECH_BUBBLE:"main/speech-bubble",TWINKLE:"main/twinkle"},REWARD:{ILLUSTRATOR_LEFT:"reward/rewards-illustrator-left",ILLUSTRATOR_RIGHT:"reward/rewards-illustrator-right",CHEST_1:"reward/chest-1",CHEST_2:"reward/chest-2",CHEST_3:"reward/chest-3",CHEST_1_OPEN:"reward/chest-1-open",CHEST_2_OPEN:"reward/chest-2-open",CHEST_3_OPEN:"reward/chest-3-open",SPARKLE_CHEST_1:"reward/chest-1-sparkle",SPARKLE_CHEST_2:"reward/chest-2-sparkle",SPARKLE_CHEST_3:"reward/chest-3-sparkle",GLOW_CHEST_1:"reward/chest-1-glow",GLOW_CHEST_2:"reward/chest-2-glow",GLOW_CHEST_3:"reward/chest-3-glow"},INTRO:{ARROW:"intro/arrow",ARROW_LEFT:"intro/arrow-left",ARROW_RIGHT:"intro/arrow-right",HIGHER_BET:"intro/higher-bet",ITEM_1:"intro/item-1",ITEM_2:"intro/item-2",ITEM_3:"intro/item-3",TEXT:"intro/text"}}},OFFSHORE_RACE_CHESTS:{KEY:"offshore-race-chests",TEXTURE:"./assets/textures/"+a+"x/offshore-race-chests.png",JSON:"./assets/textures/"+a+"x/offshore-race-chests.json",FRAME:{BLANK:"blank",OFFSHORE_RACE:{ILLUSTRATOR:{LEFT:"offshore-race/rewards-illustrator-left",RIGHT:"offshore-race/rewards-illustrator-right"},GOLD:{CLOSED:"offshore-race/gold-close",OPEN:"offshore-race/gold-open"},SILVER:{CLOSED:"offshore-race/silver-close",OPEN:"offshore-race/silver-open"},BRONZE:{CLOSED:"offshore-race/bronze-close",OPEN:"offshore-race/bronze-open"}},EFFECTS:{GOLD:{GLOW:"effects/gold-glow",SPARKLE:"effects/gold-sparkle"},SILVER:{GLOW:"effects/silver-glow",SPARKLE:"effects/silver-sparkle"},BRONZE:{GLOW:"effects/bronze-glow",SPARKLE:"effects/bronze-sparkle"}}}},WEEKLY_TOURNAMENT_CHESTS:{KEY:"weekly-tournament-chests",TEXTURE:"./assets/textures/"+a+"x/weekly-tournament-chests.png",JSON:"./assets/textures/"+a+"x/weekly-tournament-chests.json",FRAME:{BLANK:"blank",WEEKLY_TOURNAMENT:{ILLUSTRATOR:{LEFT:"weekly-tournament/rewards-illustrator-left",RIGHT:"weekly-tournament/rewards-illustrator-right"},GOLD:{CLOSED:"weekly-tournament/gold-close",OPEN:"weekly-tournament/gold-open"},SILVER:{CLOSED:"weekly-tournament/silver-close",OPEN:"weekly-tournament/silver-open"},PURPLE:{CLOSED:"weekly-tournament/purple-close",OPEN:"weekly-tournament/purple-open"},BRONZE:{CLOSED:"weekly-tournament/bronze-close",OPEN:"weekly-tournament/bronze-open"}},EFFECTS:{GOLD:{GLOW:"effects/gold-glow",SPARKLE:"effects/gold-sparkle"},SILVER:{GLOW:"effects/silver-glow",SPARKLE:"effects/silver-sparkle"},PURPLE:{GLOW:"effects/purple-glow",SPARKLE:"effects/purple-sparkle"},BRONZE:{GLOW:"effects/bronze-glow",SPARKLE:"effects/bronze-sparkle"}}}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",CARD_BACK:"cards/card-back-0",BIG_TOP:"bg-top",BIG_PLAYER:"bg-player",BIG_CIRCLE:"big-circle",BUTTON_PLUS:"buttons/plus",BUTTON_SETTING:"buttons/setting",AVATAR_BLUE_BG:"avatars/bg-blue-mini",AVATAR_BLUE_FRAME:"avatars/frame-blue-mini",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",ITEM_GIFT:"items/gift",ITEM_PAINT:"items/paint",ITEM_HAMMER:"items/hammer",ITEM_SHUFFLE:"items/shuffle",ITEM_BG_COIN:"items/bg-coin",ITEM_BG_ITEM:"items/bg-item",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",ICON_CLOCK:"icons/clock",ICON_DIAMOND:"icons/diamond",ICON_DIAMOND_SMALL:"icons/diamond-small",ICON_CUP_SUPERMINI:"icons/cup-supermini",TILE_RED:"gems/red",TILE_BLUE:"gems/blue",TILE_PINK:"gems/pink",TILE_GREEN:"gems/green",TILE_YELLOW:"gems/yellow",TILE_FREEZE:"gems/freeze",TILE_COLORFUL:"gems/colorful",TILE_COLOR_CHANGE:"gems/change"}},DASHBOARD:{KEY:"dashboard-resources",TEXTURE:"./assets/textures/"+a+"x/dashboard-resources.png",JSON:"./assets/textures/"+a+"x/dashboard-resources.json",FRAME:{BLANK:"blank",UPGRADE_ON:"upgrade-on",UPGRADE_OFF:"upgrade-off",BUTTON:{SETTING:"setting-button",JOURNEY:"journey-button",BACK:"back-button",BUTTON:{GREEN_2:"buttons/button/green-2",RED:"buttons/button/red",NEW_GREEN:"buttons/button/new-green",NEW_BLUE:"buttons/button/new-blue",NEW_GREEN_SHADOW:"buttons/button/new-green-shadow",GREEN_3:"buttons/button/green-3"},GREEN_40:"",GREEN_50:"",GREEN_60:"",BLUE_40:"",BLUE_50:"",RED_40:""},LEVEL_BUTTON:{NORMAL:"green-level-button",HARD:"red-level-button",SUPER_HARD:"violet-level-button"},EFFECTS:{GLOW:"effects/glow",WAVE:"effects/wave",SPARKS:"effects/spark"},ICON:{ADD:"add-icon",GREEN_CIRCLE:"green-circle-icon",CHALLENGE:"challenge-icon",COIN:"coin-icon",COINS:"coins-icon",NEW_COINS:"new-coins-icon",DAILY_MISSION:"daily-mission-icon",STAR:"star-icon",SMALL_STAR:"small-star-icon"},BAR_VALUE:{COIN:"coin-bar-value",STAR:"star-bar-value",UPGRADE:"upgrade-bar-value"},PROGRESS:{TRACK:"progress-track",FILL:"progress-fill"},JOURNEY:{PROGRESS_BAR:"journey/progress-bar-border",PROGRESS_FILL:"journey/progress-bar-fill",THUMBNAIL_BACKGROUND:"journey/background",THUMBNAIL_BORDER:"journey/border",THUMBNAIL_OVERLAY:"journey/overlay",THUMBNAIL_LOCK:"journey/lock"},WELCOME_BACK:{NO_THANKS:"welcome-back/no-thanks"},BADGE:{WARNING:"",RANK:"",WINNING_RANK:""},EVENTS_COMMON:{RANK_BLOCK_BLUE:"events/common/rank-block-blue",RANK_BLOCK_GREEN:"events/common/rank-block-green",RED_BADGE:"events/common/red-badge",YELLOW_BADGE:"events/common/yellow-badge"},WEEKLY_TOURNAMENT:{SMALL_ICON:"events/weekly-tournament/small-cup",BUTTON:{PLAYING:"events/weekly-tournament/button-playing",WON:"events/weekly-tournament/button-won",LOST:"events/weekly-tournament/button-lost"}},BOXING_DUEL:{SMALL_ICON:"events/boxing-duel/blue-glove",BUTTON:{PLAYING:"events/boxing-duel/button-playing",WON:"events/boxing-duel/button-won",LOST:"events/boxing-duel/button-lost"}},RACE:{SMALL_ICON:"events/race/small-boat",BUTTON:{PLAYING:"events/race/button-playing",WON:"events/race/button-won",LOST:"events/race/button-lost"}},SHOP:"shop-button",DECOR:{ALERT:"decor/alert",RED_CIRCLE:"decor/red-circle",TITLE_BORDER:"decor/title-border",PROGRESS_BORDER:"decor/progress-border",PROGRESS:{BAR:"decor/progress-bar",FILL:"decor/progress-fill"},LOCATION_BUTTON:"decor/location-button",LOCATION_PROGRESS:{BAR:"decor/location-progress-bar",FILL:"decor/location-progress-fill"}}}},EVENT_BOARD:{KEY:"event-board",TEXTURE:"./assets/textures/"+a+"x/event-board.png",JSON:"./assets/textures/"+a+"x/event-board.json",FRAME:{BLANK:"blank",BOXING_DUEL:{START_CIRCLE:"boxing-duel/boxing-circle",ICON_CUP:"boxing-duel/cup-icon",TEXT_REWARD_COIN:"boxing-duel/text-reward-coin",GLOVE:{BLUE:"boxing-duel/glove-blue",RED:"boxing-duel/glove-red"},LOADING_BAR:{BLUE:"boxing-duel/loading-bar-blue",RED:"boxing-duel/loading-bar-red"},ICON_VS:"boxing-duel/vs-icon",TIMER_BORDER:"boxing-duel/timer-border",GREEN_BUTTON:"boxing-duel/green-button",PLAYER:{AVATAR:{BACKGROUND:"boxing-duel/player/avatar-blue-base",BORDER:"boxing-duel/player/avatar-blue",RANDOM:"boxing-duel/player/avatar-blue-random"},CROWN:"boxing-duel/player/crown-left"},OPPONENT:{AVATAR:{BACKGROUND:"boxing-duel/opponent/avatar-red-base",BORDER:"boxing-duel/opponent/avatar-red",RANDOM:"boxing-duel/opponent/avatar-red-random"},CROWN:"boxing-duel/opponent/crown-right"}},OFFSHORE_RACE:{GREEN_BUTTON:"race/green-button",LEVEL_PANEL:"race/level-panel",TRIANGLE:"race/triangle",TIME_PANEL:"race/timer-panel",CHEST:{GOLD:"race/chest-gold",SILVER:"race/chest-silver",BRONZE:"race/chest-bronze"},MEDAL:{GOLD:"race/medal-gold",SILVER:"race/medal-silver",BRONZE:"race/medal-bronze"},TAG:{LEADERBOARD:"race/tag-leaderboard",PROMOTION:"race/tag-promo",WIN_EMPTY:"race/tag-win-empty"},PLAYER:{AVATAR:"race/player-avatar",SCOREBOARD:"race/player-scoreboard"},OPPONENT:{AVATAR:"race/opponent-avatar",SCOREBOARD:"race/opponent-scoreboard"}},WEEKLY_TOURNAMENT:{CUP_ICON:"weekly-tournament/cup-icon",PLAYING_BOARD:"weekly-tournament/playing-board",WON_BOARD:"weekly-tournament/won-board",LOST_BOARD:"weekly-tournament/lost-board"},PLUS_SCORE_EVENT:{BOXING_DUEL:"plus-event-score/blue-glove",RACE:"plus-event-score/boat",WEEKLY_TOURNAMENT:"plus-event-score/cup"},EFFECTS:{GLOW:"effects/glow",WAVE:"effects/wave",SPARKS:"effects/spark"},ANCHOR_KNOT:"anchor-knot",BLUE_CIRCLE:"blue-circle",GREEN_CIRCLE:"green-circle",HEADER_BOARD:"header-board",ROPE:"rope"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",FX_WHITE_BLUR:"circle-blur",FX_COMET:"comet",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_GOLD:"glow-gold",FX_GLOW_LIGHT:"glow-light",FX_LIGHT:"light",FX_SPARK:"spark",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",TEXT_COOL:"texts/cool",TEXT_GOOD:"texts/good",TEXT_GREAT:"texts/great",TEXT_EXCELLENT:"texts/excellent",TEXT_CONGRATULATION:"texts/congratulation",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",FX_HIGHLIGHT:"fx-items/highlight",FX_PAINT_EXPLOSIVE:"fx-items/paint-explosive-",FX_RED_EXPLOSIVE:"fx-gems/red-explosive-",FX_BLUE_EXPLOSIVE:"fx-gems/blue-explosive-",FX_PINK_EXPLOSIVE:"fx-gems/pink-explosive-",FX_GREEN_EXPLOSIVE:"fx-gems/green-explosive-",FX_YELLOW_EXPLOSIVE:"fx-gems/yellow-explosive-",FX_COLORFUL:"fx-gems/colorful-",FX_COLOR_CHANGE:"fx-gems/color-change-",FX_FREEZE_EXPLOSIVE:"fx-gems/freeze-explosive-",FX_COLORFUL_EXPLOSIVE:"fx-gems/colorful-explosive-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},ANIMATION_SCENE:{KEY:"animation-scene-resources-0",PATH:"./assets/textures/"+a+"x/animation-scene-resources-0.png",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",CIRCLE:"circle",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-"}},DEMO_SPINE:{DATA_KEY:"demo-spine-data",ATLAS_KEY:"demo-spine-atlas",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"},CARD_LOCK_SPINE:{DATA_KEY:"card-lock-spine-data",ATLAS_KEY:"card-lock-spine-atlas",skelPATH:"./assets/spines/Card_Lock/Card_Lock.skel",atlasPATH:"./assets/spines/Card_Lock/Card_Lock.atlas"},CODE_BREAK_SPINE:{DATA_KEY:"code-break-spine-data",ATLAS_KEY:"code-break-spine-atlas",atlasPATH:"./assets/spines/Code_Break/Code_Break.atlas",skelPATH:"./assets/spines/Code_Break/Code_Break.skel"},SQUIRREL_SPINE:{DATA_KEY:"squirrel-spine-data",ATLAS_KEY:"squirrel-spine-atlas",jsonPATH:"./assets/spines/Squirrel/Squirrel.json",atlasPATH:"./assets/spines/Squirrel/Squirrel.atlas"},MAP_SPINE:{DATA_KEY:"map-card-data",ATLAS_KEY:"map-card-atlas",skelPATH:"./assets/spines/Map_Card/Map_Card.skel",atlasPATH:"./assets/spines/Map_Card/Map_Card.atlas"},WINDMILL_SPINE:{DATA_KEY:"tornado-card-data",ATLAS_KEY:"tornado-card-atlas",skelPATH:"./assets/spines/Tornado_Card/tornado_card.skel",atlasPATH:"./assets/spines/Tornado_Card/tornado_card.atlas"},CARD_SLICE_SPINE:{DATA_KEY:"booster-slice-spine-data",ATLAS_KEY:"booster-slice-spine-atlas",skelPATH:"./assets/spines/Slice_Card/slice_card.skel",atlasPATH:"./assets/spines/Slice_Card/slice_card.atlas"},CARD_SLICE_FX_SPINE:{DATA_KEY:"booster-slice-fx-spine-data",ATLAS_KEY:"booster-slice-fx-spine-atlas",skelPATH:"./assets/spines/Slice_Card/cut_vfx.skel",atlasPATH:"./assets/spines/Slice_Card/cut_vfx.atlas"},CHANGE_VFX_SPINE:{DATA_KEY:"change-vfx-data",ATLAS_KEY:"change-vfx-atlas",skelPATH:"./assets/spines/Change_VFX/change_vfx_top.skel",atlasPATH:"./assets/spines/Change_VFX/change_vfx_top.atlas"},CIRCLE_VFX_SPINE:{DATA_KEY:"circle-vfx-data",ATLAS_KEY:"circle-vfx-atlas",skelPATH:"./assets/spines/Circle/circle.skel",atlasPATH:"./assets/spines/Circle/circle.atlas"}};GameCore.Utils.Valid.isDebugger()&&(r.EFFECTS.FRAME=(0,i.Z)({},r.ANIMATION_SCENE.FRAME,r.EFFECTS.FRAME)),t.Z=r},function(e,t){t.Z={BACKGROUND:1,FOOTER_LOGO:2,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,GAMEPLAY:21,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,HEADER:33,GUIDE:35,POPUP:40,PRIORITY:80,DEBUG:90,ON_TOP:1e4}},function(e,t,n){n.d(t,{I:function(){return a}});var i=n(68),a=function(e){return{type:i.DW,payload:{sceneKey:e}}}},function(e,t,n){n.d(t,{BN:function(){return o},QT:function(){return s},cX:function(){return a}});var i={PRIMARY:{KEY:"black-stroke",TEXTURE:"black-stroke.png",DATA:"black-stroke.xml"},NORMAL_1:{KEY:"normal-1",TEXTURE:"normal-1.png",DATA:"normal-1.xml"},NORMAL:{KEY:"normal",TEXTURE:"normal.png",DATA:"normal.xml"},SHADOW:{KEY:"shadow",TEXTURE:"shadow.png",DATA:"shadow.xml"},STROKE:{KEY:"stroke",TEXTURE:"stroke.png",DATA:"stroke.xml"},WHITE_SHADOW:{KEY:"white_shadow",TEXTURE:"white_shadow.png",DATA:"white_shadow.xml"},STYLE:{KEY:"style",TEXTURE:"style.png",DATA:"style.xml"},HEADER:{KEY:"header",TEXTURE:"header.png",DATA:"header.xml"},FONT_ATLAS:{KEY:"font-atlas",TEXTURE:"bitmap-fonts-atlas.png",DATA:"bitmap-fonts-atlas.json",FRAME:{PRIMARY:"black-stroke",NORMAL:"normal",NORMAL_1:"normal-1",SHADOW:"shadow",STROKE:"stroke",WHITE_SHADOW:"white_shadow",STYLE:"style",HEADER:"header"}}},a=(i.PRIMARY.KEY,i.PRIMARY.DATA,i.NORMAL.KEY,i.NORMAL.DATA,i.SHADOW.KEY,i.SHADOW.DATA,i.STROKE.KEY,i.STROKE.DATA,i.WHITE_SHADOW.KEY,i.WHITE_SHADOW.DATA,i.NORMAL_1.KEY,i.NORMAL_1.DATA,i.STYLE.KEY,i.STYLE.DATA,i.HEADER.KEY,i.HEADER.DATA,[{fontName:i.PRIMARY.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.PRIMARY,xmlKey:i.PRIMARY.KEY},{fontName:i.NORMAL.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.NORMAL,xmlKey:i.NORMAL.KEY},{fontName:i.NORMAL_1.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.NORMAL_1,xmlKey:i.NORMAL_1.KEY},{fontName:i.SHADOW.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.SHADOW,xmlKey:i.SHADOW.KEY},{fontName:i.STROKE.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.STROKE,xmlKey:i.STROKE.KEY},{fontName:i.WHITE_SHADOW.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.WHITE_SHADOW,xmlKey:i.WHITE_SHADOW.KEY},{fontName:i.STYLE.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.STYLE,xmlKey:i.STYLE.KEY},{fontName:i.HEADER.KEY,textureKey:i.FONT_ATLAS.KEY,frameKey:i.FONT_ATLAS.FRAME.HEADER,xmlKey:i.HEADER.KEY}]);t.ZP=i;var r='mikado-bold ,nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',s=function(e){r="ru"===e?"DejaVuSans-Bold":'mikado-bold ,nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif'},o=function(){return r}},function(e,t){t.Z={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},GAMEPLAY_BACKGROUND:{KEY:"gameplay-background",FILE:"./assets/music/gameplay_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json",PATH:"./assets/sounds/"},UI:{KEY:"ui",FILE:["./assets/sounds/ui.ogg","./assets/sounds/ui.mp3"],JSON:"./assets/sounds/ui.json"},BOOSTERS:{KEY:"boosters",FILE:["./assets/sounds/boosters.ogg","./assets/sounds/boosters.mp3"],JSON:"./assets/sounds/boosters.json"},CARD:{KEY:"card",FILE:["./assets/sounds/card.ogg","./assets/sounds/card.mp3"],JSON:"./assets/sounds/card.json"},CARD_COMBO:{KEY:"card-combo",FILE:["./assets/sounds/card-combo.ogg","./assets/sounds/card-combo.mp3"],JSON:"./assets/sounds/card-combo.json"},CARD_ROTATE:{KEY:"card-rotate",FILE:["./assets/sounds/card-rotate.ogg","./assets/sounds/card-rotate.mp3"],JSON:"./assets/sounds/card-rotate.json"},GAMEPLAY:{KEY:"gameplay",FILE:["./assets/sounds/gameplay.ogg","./assets/sounds/gameplay.mp3"],JSON:"./assets/sounds/gameplay.json"},CONGRATS_SOUND:{KEY:"congrats-sound",FILE:["./assets/sounds/congrats-sound.ogg","./assets/sounds/congrats-sound.mp3"],JSON:"./assets/sounds/congrats-sound.json"}}},function(e,t,n){n.d(t,{Z:function(){return B}});var i=n(24),a=n(7),r=n(82),s=n(83),o=n(73),c=n(72),h=n(71),u=n(75),l=(0,n(69).P1)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),d=n(79),p=n(26),f=n(84),m=n(23),g=n(76),v=n(74),y=o.Z.DEFAULT,E=y.KEY,C=y.FRAME,A=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(v.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:E,frame:C.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:g.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),w=A,S=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(t/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(v.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,m.Z)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:g.ZP.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),b=S,T=n(80),x=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).loadingIcon=void 0,r.messageText=void 0,r.closeTimerEvent=void 0,r.openCloseTween=void 0,r.animationFadeOut=void 0,r.addLoadingIcon(),r.addMessageText(),r.setDepth(h.Ks.PRIORITY),d.Z.registerObject(r.background,h.MR.MULTIPLY_ALPHA),r.setAlpha(0),r}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t);var a=this.getData(["message","duration","loading","animationFadeOut"]),r=a[0],s=void 0===r?"":r,o=a[1],c=void 0===o?0:o,h=a[2],u=void 0!==h&&h,l=a[3],d=void 0!==l&&l;this.animationFadeOut=d,this.setMessage(s),this.showLoading(u),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new T.Z(this.scene),this.add(this.loadingIcon),this.loadingIcon.setVisible(!1),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone),this.loadingIcon.setWorldSize(56.5,56.5)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(15),font:g.ZP.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.changeMessage=function(e){var t=this;this.scene.tweens.add({targets:this.messageText,duration:150,ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0,alpha:0,onYoyo:function(){t.messageText.setText(e)}})},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.loadingIcon.setVisible(e);var t=!1===e?10:40;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,t)},n.runOpenAnimation=function(){var e;null==(e=this.openCloseTween)||e.remove(),this.openCloseTween=this.scene.tweens.add({duration:200,targets:this,alpha:{from:0,to:1}})},n.close=function(){var t,n=this;null==(t=this.closeTimerEvent)||t.remove(),this.animationFadeOut?this.openCloseTween=this.scene.tweens.add({duration:200,targets:this,alpha:0,onComplete:function(){e.prototype.close.call(n)}}):e.prototype.close.call(this),this.setData({animationFadeOut:!1,duration:0,loading:!1,message:""})},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen),P=x,k=o.Z.DEFAULT,I=k.KEY,O=k.FRAME,R=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).mask=void 0,t.fadeInAnim=void 0,t.fadeOutAnim=void 0,t.fpsMeter=void 0,t.memoryMeter=void 0,t.switchScene=function(e){t.currentScene.switch(e)},t.emitGameEventStartScene=function(e){var n=e.scene.key;t.updateSceneState(),t.runMaskFadeOutAnimation(),t.updateActiveSceneKey(n),t.game.events.emit(Phaser.Scenes.Events.START,n),(0,p.sw)("scene","Start scene: "+n)},t.emitGameEventSleepScene=function(e){var n=e.scene.scene.key;n!==c.C.LOAD_SCENE&&(t.runMaskFadeInAnimation(),t.game.events.emit(Phaser.Scenes.Events.SLEEP,n))},t.emitGameEventWakeScene=function(e){var n=e.scene.scene.key;n!==c.C.LOAD_SCENE&&(t.updateSceneState(),t.runMaskFadeOutAnimation(),t.updateActiveSceneKey(n),t.game.events.emit(Phaser.Scenes.Events.WAKE,n))},t.emitGameEventPauseScene=function(e){var n=e.scene.scene.key;t.game.events.emit(Phaser.Scenes.Events.PAUSE,n)},t.emitGameEventResumeScene=function(e){var n=e.scene.key;t.game.events.emit(Phaser.Scenes.Events.RESUME,n)},t.emitGameEventShutdownScene=function(e){var n=e.scene.scene.key;t.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,n)},t}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var e=this.screen.add(h.o4.NOTIFY_SCREEN,P);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:I,frame:O.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(859421),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new w(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new b(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new r.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new s.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(c.K.SWITCH,this.switchScene),this.events.on(Phaser.Scenes.Events.RENDER,d.Z.updateBgMask)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.updateActiveSceneKey=function(e){e!==c.C.GLOBAL_SCENE&&this.storage.dispatch((0,u.I)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.Z)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=l(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(f.Z),B=R},function(e,t){var n;function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var r=function(){function e(){}return e.registerObject=function(t,n){e.objects.some((function(e){return e.object==t}))||e.objects.push({object:t,alpha:n||1})},e.setColor=function(t){e.color=t},e}();n=r,r.objects=[],r.currentAlpha=-1,r.color="0 0 0",r.changeMaskAlpha=function(e){var t=document.getElementById("bottom-overlay");t&&(t.style.background="rgb("+n.color+" / "+e+")")},r.updateBgMask=function(){for(var e,t=1,a=i(n.objects);!(e=a()).done;){var r=e.value,s=r.object.scene;if(!s)return;if(s.scene.isActive(s.scene.key)){for(var o=r.object,c=r.object.alpha,h=r.object.visible;o.parentContainer;)c*=(o=o.parentContainer).alpha,h=h&&o.visible;h&&(t*=1-c*r.alpha)}}var u=1-t;n.currentAlpha!=u&&(n.currentAlpha=u,n.changeMaskAlpha(u))},t.Z=r},function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(23),a=n(7),r=n(73),s=n(81),o={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},c=function(e){function t(t){return e.call(this,o,t)||this}return(0,a.Z)(t,e),t}(s.Z),h=r.Z.DEFAULT,u=h.KEY,l=h.FRAME,d=function(e){function t(t){var n;return(n=e.call(this,t,0,0,u,l.PRELOADER.LOADING)||this).anim=void 0,n.runAnimation(),n.setWorldSize(56.5,56.5),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new c({targets:[this],repeat:-1,duration:1e3,props:{angle:{from:0,to:360,ease:function(e){return Phaser.Math.Easing.Stepped(e,12)}}}}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image)},function(e,t,n){var i=n(1),a=n(0),r=n.n(a),s=n(14),o=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,s.TS)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},t.waitForCompletion=function(){var e=(0,i.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==(t=this.tween)?void 0:t.waitForCompletion());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}();t.Z=o},function(e,t,n){var i=n(7),a=n(81),r={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t,n){var i=n(7),a=n(81),r={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(7),a=n(60),r=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.Z)(t,e),t}(Phaser.GameObjects.Zone),s=n(70),o=function(e){function t(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.currBgCfg=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.handleResize=function(){if(t.background&&t.gameZone){var e=t.world.getResizeEventData(),n=e.width,i=e.height;t.gameZone.setSize(n,i),t.background.setPosition(n/2,i/2),t.background.setDisplaySize(n,i)}},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}(0,i.Z)(t,e);var n=t.prototype;return n.create=function(){this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.world.events.on(s.Z.RESIZE,this.handleResize),this.scaleGame(),this.createGameZone()},n.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;e.setZoom(t),e.centerOn(i/2,a/2)},n.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new r(this,t,n)},n.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},n.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},n.fontSize=function(e){var t=this.getModSizeByLang();return Math.round(e/t)},n.getModSizeByLang=function(){switch(this.lang.getCurrentLanguage()){case"en":return 1.01;case"ru":return 1.25;default:return 1.1}},n.createBackground=function(e,t,n,i){var a,r,s,o;if(!((null==(a=this.currBgCfg)?void 0:a.key)===e&&(null==(r=this.currBgCfg)?void 0:r.frame)===t&&(null==(s=this.currBgCfg)?void 0:s.alpha)===n&&(null==(o=this.currBgCfg)?void 0:o.tint)===i)){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e),this.updateBackgroundSize(),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone);var c={key:e,frame:t,alpha:n,tint:i,width:this.background.width,height:this.background.height,scale:this.background.scale};this.currBgCfg&&this.handleBackgroundChange(this.currBgCfg),this.currBgCfg=c}},n.updateBackgroundSize=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height,i=this.background.width/this.background.height<this.world.getScreenRatio()?"width":"height";this.background.setWorldSize(t,n);var a=this.background,r=a.scaleX,s=a.scaleY;if("height"===i)this.background.setScale(s);else this.background.setScale(r)},n.handleBackgroundChange=function(e){},n.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,a=t.storage.watch(n,i);t.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(a._.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},t}(Phaser.Scene)},function(e,t){t.Z={BUTTON_CLICK:"button_click",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",OPEN_WIN_SCREEN:"level_complete_perfect",LEVEL_COMPLETED:"level_win_jingle_part2",SELECT_BOOSTER:"pre_bstr_shuffling_prebooster_in_hud_off",UN_SELECT_BOOSTER:"pre_bstr_shuffling_prebooster_in_hud_cancel",FILL_PROGRESS:"ui_meta_progress_bar_filling",FULL_PROGRESS:"ui_meta_progress_bar_full",REWARD_GIFT:"reward_collect",OPEN_GIFT:"reward_chest_open",UPDATE_NEW_LOCATION:"metamap_location_unlock",GOAL_PROGRESS:"goal_progress",UPGRADE_DECORATION:"upgrade_decoration",CHEST_FLYING:"chest_flying",CHEST_JUMP:"chest_jump",CHEST_OPEN:"chest_open",CARDS_APPEAR:"level_start",DEAL_CARDS:"deal-cards",CARD_MOVE:"card_move",SHUFFLE:"shuffle",GET_HEAP_COINS:"ui_coins_heap_get",COINS_APPEAR:"winscreen2_coins_flying_to_counter",COUNT_COINS:"ui_coins_counter",DRAW_WILD:"booster_wild_field_take",WILD_CARD_HINT:"booster_wild_hint",SKIP_MOVE:"ui_skip_move",REWARD_STREAK:"gp_streak",REWARD_CARD:"gp_streak_x1",SHOW_COMPLIMENT:"streak_cheering",ADD_FIVE_CARDS:"add-5-cards",TAP_UNDO_STOCK:"ui_undo_card",TAP_UNDO_PILE:"ui_move_redo_tap",TAP_STOCK:"gp_redo_button_touch",RELEASE_UNDO:"gp_redo_button_release",SWOOSH_LONG:"long_whoosh",POP:"pumpkin",OPEN_CARD:"card_open_1",CLOSE_CARD:"gp_card_redo_field",DRAW_CARD:"gp_card_take",MISS_TAP_CARD:"gp_card_misstap",STOCK_CARD_REWARD:"gp_last_card_to_stock",START_MOVE_TO_WASTE:"gp_card_collect_x2",FINISH_MOVE_TO_WASTE:"card_played_off_x2",KEY_ACTIVATE:"mod_key",TWIST_LOCK:"mod_lock_opens",EXPLODE:"bomb_gang",BOMB_TICK:"bomb_counter",FLY_TO_STOCK:"card_plus_flight_to_stock",CARD_PLUS_ACTIVATE:"card_plus_activation",SPAWN_CARD:"card_plus_spawn_card_1",TICK:"count_down_tick",PAPER_FALLS:"paper_falls",HAMMER:"hammer",UNLOCK_LOCK:"unlock_lock",SLICE_CARD:"booster_blade_sweep_3",CUT_CARD:"booster_card_cut_2",WILD_CARD_APPEAR:"booster_wild_level_start_appear",STORM_BOOSTER_APPEAR:"booster_start_fan_appears",END_GAME:"you_lose",DIAMONDS_EAT:"",FIREWORKS_SOAR:"",FIREWORKS_BIG:"",FIREWORKS_SMALL:"",DAILY_REWARD:"",GAME_OVER_SCENE:"",SCORE_COUNTER:"",CONGRATULATION:"",YOU_WIN:"",YOU_LOSE:"",GIFT_CHARGE:"",GIFT_REVEAL:"",GIFT_EXPLODE:""}},function(e,t,n){var i=n(7),a=n(81),r={targets:[],duration:400,ease:n(87).Z,props:{scale:"+=0.1"}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t,n){var i=n(33),a=n.n(i)()(.48,1.57,.6,.83);t.Z=a},function(e,t,n){var i=n(7),a=n(81),r={targets:[],duration:400,ease:n(87).Z,props:{scale:"-=0.1"}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t){t.Z={RETURN_PILE:"return-pile",MOVE_TO_WASTE:"move-to-waste",MOVE_COMPLETED:"move-completed",START_LEVEL:"start-level",BOOSTER_SELECTED:"booster-selected",COLLECT_CARD:"collect-card",UNDO:"undo"}},function(e,t,n){var i=n(1),a=n(0),r=n.n(a),s=function(){var e=(0,i.Z)(r().mark((function e(t,n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.time.delayedCall(n,e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.Z=s},function(e,t,n){var i=n(24),a=n(23),r=n(7),s=n(60),o=n(26),c=function(e){function t(t,n,i,r){var s;return void 0===r&&(r=.925),(s=e.call(this,t)||this).isClicked=!1,s.parentName=void 0,s.disable=void 0,s.scaleDown=void 0,s.handlePointerDown=function(){s.isClicked||(s.isClicked=!0,s.onPointerDown())},s.handleOnClick=function(e){return function(){s.isClicked&&(s.isClicked=!1,s.onPointerUp(),s.logButtonEvent(),s.addDebugData(),e())}},s.handlePointerOut=function(){s.isClicked&&(s.isClicked=!1,s.onCancel())},s.scaleDown=r,s.setSize(n,i),s.listenEvents(),s.scene.add.existing((0,a.Z)(s)),s}(0,r.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)},n.onPointerDown=function(){this.animButtonDown()},n.onPointerUp=function(){this.animButtonUp()},n.onCancel=function(){this.animButtonUp()},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this,scale:this.scaleDown,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this,scale:1,duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],onStart:function(t){e.disable&&(t.remove(),e.setScale(1))},onUpdate:function(t){e.disable&&(t.remove(),e.setScale(1))}})},n.setDisabled=function(e){this.disable!=e&&(this.disable=e,e?this.disableInteractive():this.setInteractive({useHandCursor:!0}))},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,o.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e))}}]),t}(Phaser.GameObjects.Container);t.Z=c},function(e,t,n){var i=n(24),a=n(23),r=n(7),s=n(60),o=n(88),c=n(74),h=n(85),u=n(26),l=n(77),d=function(e){function t(t,n,i,r,s,u){var d;return void 0===u&&(u=!1),(d=e.call(this,t)||this).useSound=!0,d.isClicked=!1,d.scaleUp=-1,d.scaleDown=-1,d.button=void 0,d.upAnimation=void 0,d.downAnimation=void 0,d.isUsePixelPerfect=!1,d.hitArea=void 0,d.hitZone=void 0,d.scaleDownPress=void 0,d.parentName=void 0,d.handelObjectDestroy=function(){d.scene&&d.scene.events.off(Phaser.Scenes.Events.SLEEP,d.handleSceneSleep)},d.handleSceneSleep=function(){d.scene&&d.scene.tweens.killTweensOf((0,a.Z)(d))},d.handlePointerDown=function(){var e;d.isClicked||null!=(e=d.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(d.isClicked=!0,d.runDownAnimation())},d.handleOnClick=function(e){return function(){var t,n;d.isClicked&&(null!=(t=d.upAnimation)&&null!=(t=t.tween)&&t.isPlaying()||(d.isClicked=!1,d.runUpAnimation(),d.processCallback(e),null==(n=d.upAnimation)||null==(n=n.tween)||n.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){d.logButtonEvent(),d.addDebugData()}))))}},d.handlePointerOut=function(){var e;d.isClicked&&(null!=(e=d.upAnimation)&&null!=(e=e.tween)&&e.isPlaying()||(d.isClicked=!1,d.runUpAnimation()))},d.runDownAnimation=function(){var e;-1===d.scaleDown&&(d.scaleUp=d.scale,d.scaleDown=d.scaleDownPress),d.useSound&&d.scene.audio.playAudioSprite(l.Z.UI.KEY,h.Z.BUTTON_CLICK),null==(e=d.downAnimation)||e.remove(),d.downAnimation=new o.Z({targets:[(0,a.Z)(d)],duration:120,props:{scale:d.scaleDown},onUpdate:function(){d.hitZone.scale=1/d.scale}}),d.downAnimation.play()},d.runUpAnimation=function(){var e;-1!==d.scaleUp&&(null==(e=d.upAnimation)||e.remove(),d.upAnimation=new o.Z({targets:[(0,a.Z)(d)],duration:200,ease:Phaser.Math.Easing.Back.Out,easeParams:[4],props:{scale:d.scaleUp},onUpdate:function(){d.hitZone.scale=1/d.scale}}),d.upAnimation.play())},d.isUsePixelPerfect=u,d.setDepth(c.Z.BUTTON),d.createButton(n,i,r,s),d.updateSize(),d.listenEvents(),d.scene.add.existing((0,a.Z)(d)),d}(0,r.Z)(t,e);var n=t.prototype;return n.setScaleAnimation=function(e){return this.scaleUp=e,this.scaleDown=e-.075,this.scaleDownPress=e-.075,this},n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(e){e()},n.onCompletedUpAnimation=function(){var e,t;null==(e=this.upAnimation)||e.stop(),null==(t=this.downAnimation)||t.stop(),-1!==this.scaleUp&&this.setScale(this.scaleUp)},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.075;var a=this.button,r=a.displayWidth,s=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:r,displayHeight:s}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,r=i<10?i:10,s=a<10?a:10;this.setSize(t+r,n+s),this.hitZone.setSize(t+r,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,u.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container);t.Z=d},function(e,t,n){var i=n(7),a=function(e){function t(t,n){var i,a=n.key,r=n.frame,s=n.width,o=n.height,c=n.usePixelPerfect;(i=e.call(this,t,a,r,s,o,c)||this).paddingZone=void 0,i.showDebugZone=void 0,i.debugZone=void 0;var h=n.paddingZone,u=void 0===h?0:h,l=n.showDebugZone,d=void 0!==l&&l;return i.paddingZone=u,i.showDebugZone=d,i}return(0,i.Z)(t,e),t.prototype.updateSize=function(){if(e.prototype.updateSize.call(this),this.paddingZone){var t,n=this.width,i=this.height,a=n+this.paddingZone,r=i+this.paddingZone;if(this.setSize(a,r),this.hitZone.setSize(a,r),this.showDebugZone)null==(t=this.debugZone)||t.destroy(),this.debugZone=this.hitZone.drawDebugBox(10699282,.5),this.add(this.debugZone)}},t}(n(92).Z);t.Z=a},function(e,t,n){var i=n(23),a=n(7),r=n(73),s=n(14),o=r.Z.EFFECTS,c=o.KEY,h=o.FRAME,u=function(e){function t(t,n){var a;return(a=e.call(this,t,c,h.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=h.FX_CONFETTI_SMALL_1,t=h.FX_CONFETTI_SMALL_2,n=h.FX_CONFETTI_SMALL_3,i=h.FX_CONFETTI_SMALL_4,a=1/GameCore.ImageScale,r={on:!1,particleBringToTop:!0,frame:[e,t,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:400,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,s.TS)(r,this.config);this.emitter=this.createEmitter(o)},n.run=function(e,t,n){this.stop(),this.emitter.setQuantity(e),this.emitter.setPosition(t,n),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.createEmitters(),this.emitter.explode(e,t,n)},n.stop=function(){var e;null==(e=this.emitter)||e.stop(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=u},function(e,t,n){var i=n(7),a=function(e){function t(t){var n;return(n=e.call(this,t)||this).scale=void 0,n}(0,i.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateScale(),this.updateVelocity(),a},n.setScale=function(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max)},n.easeInCubic=function(e){return e*e*e},n.updateScale=function(){var e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)},n.updateVelocity=function(){this.velocityX+=Phaser.Math.Between(-1,1)},t}(Phaser.GameObjects.Particles.Particle);t.Z=a},function(e,t,n){var i=n(23),a=n(7),r=n(81),s={targets:[],duration:1e3,ease:Phaser.Math.Easing.Quadratic.InOut,props:{scale:.2}},o=function(e){function t(t){var n,a;(a=e.call(this,s,t)||this).spline=void 0,a.createCounter=function(e,t){var n=a.config.onCurveUpdate,i="function"===typeof n?n:null;t.forEach((function(t,n){if(a.scene){var r=e.data[n],s=r.duration,o=r.delay,c=new Phaser.Math.Vector2;a.scene.tweens.addCounter({delay:o,duration:s,ease:Phaser.Math.Easing.Quadratic.InOut,onUpdate:function(e){a.spline.getPoint(e.getValue(),c),t.x=c.x,t.y=c.y,i&&i(t)}})}}))};var r=a.config.curve;return r?(a.spline=new Phaser.Curves.Spline(r),null==(n=a.tween)||n.on(Phaser.Tweens.Events.TWEEN_START,a.createCounter),a):(0,i.Z)(a)}return(0,a.Z)(t,e),t}(r.Z);t.Z=o},function(e,t,n){var i=n(33),a=n.n(i)()(.55,.47,.43,.91);t.Z=a},function(e,t,n){var i=n(24),a=n(23),r=n(7),s=n(60),o=n(74),c=n(26),h=n(34),u=n(99),l=function(e){function t(t,n,i,r,s){var c;return(c=e.call(this,t)||this).useSound=!0,c.isClicked=!1,c.scaleUp=-1,c.button=void 0,c.buttonDown=void 0,c.hitArea=void 0,c.scaleDownPress=void 0,c.parentName=void 0,c.handelObjectDestroy=function(){c.scene&&c.scene.events.off(Phaser.Scenes.Events.SLEEP,c.handleSceneSleep)},c.handleSceneSleep=function(){c.scene&&c.scene.tweens.killTweensOf((0,a.Z)(c))},c.handlePointerDown=function(){c.isClicked||(c.showButtonDown(),c.isClicked=!0)},c.handleOnClick=function(e){return function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown(),c.logButtonEvent(),c.addDebugData(),c.processCallback(e))}},c.handlePointerOut=function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown())},c.buttonsPulsateAnimation=void 0,c.setDepth(o.Z.BUTTON),c.createButton(n,i,r,s),c.updateSize(),c.listenEvents(),c.scene.add.existing((0,a.Z)(c)),c}(0,r.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.showButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:.4,duration:150,ease:Phaser.Math.Easing.Sine.Out})},n.hideButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:0,duration:150,ease:Phaser.Math.Easing.Sine.In})},n.processCallback=function(e){-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=new h.Z(this.scene,0,0,e,t,n,i),this.buttonDown=new h.Z(this.scene,0,0,e,t,n,13619151),this.buttonDown.setAlpha(0),this.scaleDownPress=this.scale-.1;var a=this.button,r=a.displayWidth,s=a.displayHeight;this.hitArea=this.scene.make.zone({displayWidth:r,displayHeight:s}),this.add([this.button,this.buttonDown,this.hitArea])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,r=i<10?i:10,s=a<10?a:10;this.setSize(t+r,n+s),this.hitArea.setSize(t+r,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,c.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},n.runPulsate=function(){var e,t;null==(e=this.buttonsPulsateAnimation)||e.remove(),this.buttonsPulsateAnimation=new u.Z({targets:[this],props:{scale:{from:1,to:1.05},duration:500}}),null==(t=this.buttonsPulsateAnimation)||t.play()},n.stopPulsate=function(){var e;null==(e=this.buttonsPulsateAnimation)||e.stop(),this.setScale(1)},(0,i.Z)(t,[{key:"onClick",set:function(e){this.hitArea.setInteractive({useHandCursor:!0}),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}}]),t}(Phaser.GameObjects.Container);t.Z=l},function(e,t,n){var i=n(7),a=n(81),r={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n(97).Z,easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t,n){var i=n(5),a=n(23),r=n(7),s=n(73),o=n(95),c=s.Z.EFFECTS,h=c.KEY,u=c.FRAME,l=function(e){function t(t,n,i,r){var s;return(s=e.call(this,t,n||h,i||u.FX_SPARK_YELLOW)||this).emitZone=void 0,s.emitter=void 0,s.configOverwrite=void 0,s.configOverwrite=r||{},s.createEmitZone(),s.createEmitters(),s.scene.add.existing((0,a.Z)(s)),s}(0,r.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.Utils.Image.getImageScale();this.emitter=this.createEmitter((0,i.Z)({on:!1,frame:u.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:7,max:11},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:function(t){t.setScale({min:e/4,max:e})},particleClass:o.Z},this.configOverwrite))},n.run=function(e,t,n,i,a){this.stop(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=l},function(e,t,n){var i=n(5),a=n(24),r=n(23),s=n(7),o=n(74),c=n(20);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=function(e){function t(t,n){var a;(a=e.call(this,t)||this).config=void 0,a.isEnable=void 0,a.minValue=void 0,a.maxValue=void 0,a.maxHeight=void 0,a.isScrolling=void 0,a.boundTop=void 0,a.boundBottom=void 0,a.maskGraphics=void 0,a.objects=void 0,a._value=0,a.velocity=0,a.isScrollingSmooth=void 0,a.lastScrollY=void 0,a.isScrollingBack=void 0,a.scrollingBackTo=void 0,a.lastScrollYCount=0,a.hitArea=void 0,a.onScrollEvents=[],a.update=function(e,t){a.isScrollingSmooth&&a.velocity&&a.scrollingSmooth(t),a.isScrollingBack&&a.scrollingBack(t)},a.checkReachBound=function(){return a.isReachTop()||a.isReachBottom()},a.onMouseScroll=(0,c.D)((function(e,t,n){if(a.isEnable){if(a.isScrolling=!0,a.checkReachBound())return a.lastScrollY=a.lastScrollY.map((function(){return 0})),void(a.isScrolling=!1);a.stopScrollingBack(),a.startScrollSmooth(-n*a.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),a.onTouchScroll=function(e){if(a.isEnable){a.velocity&&a.stopScrollSmooth(),a.stopScrollingBack(),a.isScrolling=!0;var t=a.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,r=(n.y-i.y)/t,s=a.height*a.maxScrollOver,o=1;if(a.lastScrollY[++a.lastScrollYCount%a.lastScrollY.length]=r,a.isReachTop()&&r>=0){var c=(s-(a.value-a.marginTop))/s;o=Math.min(o,c)}if(a.isReachBottom()&&r<=0){var h=(s-(-a.maxHeight-a.value))/s;o=Math.min(o,h)}var u=r*o,l=a.maxScrollOver*a.height;a.value+u>a.marginTop+l?a.value=a.marginTop+l:a.value+u<-a.maxHeight-l?a.value=-a.maxHeight-l:a.value+=u,a.callOnScrollEvents(a.value,u)}},a.onTouchDown=function(){a.isEnable&&(a.velocity&&a.stopScrollSmooth(),a.stopScrollingBack())},a.onTouchEnd=function(){if(a.isReachTop()&&(a.startScrollingBack(a.marginTop),a.stopScrollSmooth()),a.isReachBottom()&&(a.startScrollingBack(-a.maxHeight),a.stopScrollSmooth()),a.isScrolling){var e=a.lastScrollY.reduce((function(e,t){return e+t}))/a.lastScrollY.length;a.startScrollSmooth(e*a.scrollSmooth),a.lastScrollY=a.lastScrollY.map((function(){return 0}))}},a.config=(0,i.Z)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5},n);var s=n.width,o=n.height;return a.isEnable=!1,a.maxHeight=0,a.lastScrollY=new Array(3).fill(0),a.setSize(s,o),a.createGroup(),a.createInput(),a.createEvents(),a.scene.add.existing((0,r.Z)(a)),a}(0,s.Z)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.gotoBottom=function(){this.value=-this.maxHeight},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){this.drawDebugBox(16711680,.8)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y+e.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,t,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=e.map((function(e){return e.y+e.height+t.marginBottom-t.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.removeChildren=function(){this.objects=this.scene.make.group({}),this.reset()},n.getChildren=function(){return this.objects.getChildren().filter((function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(i),this.boundBottom.setTint(i),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(o.Z.PRIORITY),this.boundBottom.setDepth(o.Z.PRIORITY);var a=this.width,r=n,s=this.getWorldPosition(),c=s.x,h=s.y;this.boundTop.setDisplaySize(a,r),this.boundBottom.setDisplaySize(a,r),this.boundTop.setY(-this.displayHeight/2+r/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-r/2+h-this.y+1),this.boundTop.setX(c-this.x),this.boundBottom.setX(c-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(e){var t;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var n=this.width,i=this.height;this.maskGraphics.fillRoundedRect(0-n/2,0-i/2,n,i,e),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var e=this.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];this.isObjectOutOfScroller(n)?n.setVisible(!1):n.setVisible(!0)}},n.isObjectOutOfScroller=function(e){return e.y+e.height<-this.height/2||e.y-e.height>this.height/2},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=h(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.Z)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container);t.Z=l},function(e,t,n){var i=n(23),a=n(7),r=n(73).Z.EFFECTS,s=r.KEY,o=r.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,s,o.FX_COMET)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:o.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500}})},n.run=function(e,t,n,i,a){this.stop(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},function(e,t,n){var i=n(23),a=n(7),r=n(73).Z.EFFECTS,s=r.KEY,o=r.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,s,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.ImageScale;this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(e,t,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},function(e,t,n){var i=n(7),a=n(81),r={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:500,to:0}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},function(e,t,n){var i=n(7),a=n(76),r=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n.key,n.button,i,a)||this).payload=void 0,r.payload=n,r.createIcon(),r.createText(),r}(0,i.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.add.image(0,0,this.payload.key,this.payload.icon);e.setWorldSize(43,43),this.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-25)},n.createText=function(){var e=this.payload.text,t=this.scene.make.bitmapText({font:a.ZP.PRIMARY.KEY,size:this.scene.fontSize(24),text:e,origin:{x:.2,y:.5}});this.add(t)},t}(n(92).Z);t.Z=r},function(e,t,n){var i=n(23),a=n(7),r=n(73).Z.EFFECTS,s=r.KEY,o=r.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t)||this).halo=void 0,n.star=void 0,n.createStar(),n.createHalo(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.run=function(){this.runStarAnimation(),this.runHaloAnimation()},n.createStar=function(){this.star=this.scene.make.image({key:s,frame:o.FX_STAR_YELLOW,visible:!1}),this.star.setWorldSize(35,35),this.add(this.star)},n.createHalo=function(){this.halo=this.scene.make.image({key:s,frame:o.FX_CIRCLE,visible:!1}),this.halo.setWorldSize(162,162),this.add(this.halo)},n.runStarAnimation=function(){var e=this;this.scene.tweens.killTweensOf(this.star),this.star.setVisible(!0);var t=1/GameCore.ImageScale;this.scene.tweens.add({targets:[this.star],duration:400,ease:Phaser.Math.Easing.Quintic.Out,props:{scaleX:{start:16*t,to:0},scaleY:{start:10*t,to:0}},onComplete:function(){e.star.setVisible(!1)}})},n.runHaloAnimation=function(){var e=this;this.scene.tweens.killTweensOf(this.halo),this.halo.setScale(0),this.halo.setVisible(!0),this.scene.tweens.add({targets:[this.halo],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{from:0,to:8},alpha:{from:1,to:0}},onComplete:function(){e.halo.setVisible(!1)}})},t}(Phaser.GameObjects.Container);t.Z=c},function(e,t,n){var i=n(23),a=n(7),r=n(81),s={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(e){function t(t){var n,a,r;return(r=e.call(this,s,t)||this).posX=void 0,r.handleSwitchPosition=function(){var e;r.posX=-r.posX,null==(e=r.tween)||e.updateTo("x",-r.posX)},null!=(n=r.config)&&n.props?(r.posX=r.config.props.x,null==(a=r.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,r.handleSwitchPosition),r):(0,i.Z)(r)}return(0,a.Z)(t,e),t}(r.Z);t.Z=o}])]);